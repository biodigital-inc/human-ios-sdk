!function(){function e(t,n,i){return(e="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=a(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(t,n,i||t)}function t(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&n(e,t)}function n(e,t){return(n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function i(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=a(e);if(t){var r=a(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return o(this,n)}}function o(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?r(e):t}function r(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=g(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,r=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw r}}}}function c(e){return function(e){if(Array.isArray(e))return h(e)}(e)||l(e)||g(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e,t){return f(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],i=!0,o=!1,r=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(c){o=!0,r=c}finally{try{i||null==s.return||s.return()}finally{if(o)throw r}}return n}(e,t)||g(e,t)||d()}function d(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function g(e,t){if(e){if("string"==typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(e,t):void 0}}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function f(e){if(Array.isArray(e))return e}function b(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function v(e,t,n){return t&&b(e.prototype,t),n&&b(e,n),e}function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{0:function(e,t,n){e.exports=n("dwNn")},1:function(e,t){},dwNn:function(n,o,h){"use strict";var b,y,x,k,w;h.r(o);var O,C,S,_,j,P=h("fXoL"),M=function(e){return e.Loft="loft",e.Studio="studio",e.Viewer="viewer",e.All="",e}({}),I=function(e){return e.Bookmark="bookmark",e.Module="module",e.Internal="internal",e}({}),z=function(e){return e.Local="Local",e.QA="QA",e.Staging="Staging",e.Production="Production",e}({}),T=function(e){return e.Web="web",e.SDK="sdk",e}({}),U={production:!0,assetDomain:"assets-human.biodigital.com",supportEmail:"support@biodigital.com",googleAuthKey:"66261904577-061oin26uo7sor0vrqc8dnn105irq82n.apps.googleusercontent.com",facebookAuthKey:"218801781466301",facebookPixelId:"973525219844030",googleAnalyticsId:"UA-1141985-29",linkedinId:"2641938",pendoId:"3a783681-e53b-4ebd-69c0-788bbae48f13",rollbarToken:"dd70f513aa0740668070fa3fd62b33a0",recaptchaKey:"6LdvZvcUAAAAAM0Z1St9WQXwvSYd__hMUY2WZ6um",application:M.Viewer,deploy:z.Production,platform:T.SDK,exportType:I.Bookmark,offline:!1,native:!0,minPasswordLength:8},L=h("jhN1"),D=h("R1ws"),E=h("AcyG"),F=function e(){m(this,e)},A=function(){var e=function e(t,n,i){m(this,e),this.hostingURL=t,this.embedded=n,this.widgetConfig=i};return e.type="[Widget] Setup Widget",e}(),R=function(){var e=function e(t,n){m(this,e),this.interaction=t,this.source=n};return e.type="[Widget] Log Interaction",e}(),V=function(){var e=function e(t,n){m(this,e),this.interaction=t,this.response=n};return e.type="[Widget] Log Interaction Success",e}(),N=function(){var e=function e(t,n){m(this,e),this.interaction=t,this.response=n};return e.type="[Widget] Log Interaction Failure",e}(),B=function(){var e=function e(){m(this,e)};return e.type="[Widget] Auth",e}(),H=function(){var e=function e(t,n){m(this,e),this.userType=t,this.response=n};return e.type="[Widget] Auth Success",e}(),Q=function(){var e=function e(t,n){m(this,e),this.userType=t,this.response=n};return e.type="[Widget] Auth Failure",e}(),q=function(){var e=function e(){m(this,e)};return e.type="[Widget] Reset",e}(),W=((O=function e(t){m(this,e),this.enabled=t}).type="[Widget] Set Input Enabled",O),$=function(){var e=function e(t){m(this,e),this.config=t};return e.type="[Widget] Set API Config",e}(),K=h("tk/3"),G=h("LRne"),Z=h("lJxs"),J=h("JIr8"),X=function(e){return e.InvalidUAID="analytic id does not exist",e.InvalidDeveloperId="Client id invalid",e.InvalidProductKey="app product key",e.MissingUAID="analytic id missing",e.WebOnlyAPI="Api key only compatible with Web Widget",e.AndroidOnlyAPI="Api key only compatible with Mobile Widget SDK for Android",e.IOSOnlyAPI="Api key only compatible with Mobile Widget SDK for iOS",e.MixedAPIKeys="Use of both an app product key and an app api key not allowed",e.ProductKeyNotRegistered='App product key "xxx" has not been registered or is incorrect.  Ensure it has been registered by the system admin',e.ProductKeyInvalidAppBundleID='The app product key "xxx" has not been authorized to be used for app bundle id "yyy".  Confirm the correct values are being used from the system admin',e.ProductKeyBundleIDWhitelist='Use of app product key "xxx" requires the affiliated app bundle id (app_domain) to be white-listed.  Ensure the system admin has white-listed "yyy"',e.ImproperProductKeyUsage='Improper use of app product key "xxx" detected. Contact the system admin if issue continues',e.InvalidPlatformSource="Invalid platform source",e.MissingSource="Missing source",e.MissingPlatform="Missing platform",e.MissingAppDomain="Missing app domain",e.APIKeyMissing="Api key missing",e.APIKeyInvalid="Api key invalid",e.DeveloperDeactivated="Developer account for api key is deactivated",e.BundleIDNotAllowed="App bundle id not allowed",e.BundleIDUnregistered="App bundle id unregistered",e}({}),Y=function e(){m(this,e)},ee=function e(){m(this,e)},te=h("b36G"),ne=function(e){return e.Widget="widget",e.WidgetAPI="widgetapi",e}({}),ie=h("Qyje"),oe={headers:new K.d({"Content-Type":"application/json; charset=utf-8"})},re=((S=function(){function e(t){m(this,e),this.http=t}return v(e,[{key:"getAnalytic",value:function(e){var t=this;return U.offline?(fetch("https://human.biodigital.com/ws/user/analytics?analytic_id="+e,{method:"GET",mode:"no-cors"}),Object(G.a)({success:!0})):this.http.get("/ws/user/analytics?analytic_id="+e).pipe(Object(Z.a)((function(){return{success:!0}})),Object(J.a)((function(e){return Object(G.a)(t.parseError(e))})))}},{key:"sendAnalytic",value:function(e){var t=this;if(U.offline){var n=e instanceof ee?"https://human.biodigital.com/ws/user/analytics":"https://human.biodigital.com/ws/developer/apps/access/key",i=JSON.parse(JSON.stringify(e)),o=Object(ie.stringify)(i);return fetch(n,{headers:{"Content-Type":"application/x-www-form-urlencoded"},method:"POST",mode:"no-cors",body:o}),Object(G.a)({success:!0})}return this.http.post(e instanceof ee?"/ws/user/analytics":"/ws/developer/apps/access/key",e,oe).pipe(Object(Z.a)((function(){return{success:!0}})),Object(J.a)((function(e){return Object(G.a)(t.parseError(e))})))}},{key:"buildDeveloperAnalytic",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ne.Widget,i=arguments.length>3?arguments[3]:void 0,o=e.widgetUrlConfig,r=e.parentUrl,a=e.embedded,s={platform:n,app_activity:t,app_productkey:o["app-productkey"],app_userid:o["app-userid"],app_apikey:o.dk,app_domain:r.full,app_activity_data:i,widget_is_fullscreen:!a};return Object(te.plainToClass)(Y,s)}},{key:"parseError",value:function(e){if(U.offline)return{success:!0,message:"",errorCode:null};var t=e.error.error,n=e.status,i=t&&t.message?t.message:"";return{success:n>=500&&n<=504,message:i,errorCode:Object.values(X).includes(i)?i:null}}}]),e}()).\u0275fac=function(e){return new(e||S)(P.Zb(K.b))},S.\u0275prov=P.Lb({token:S,factory:S.\u0275fac,providedIn:"root"}),S),ae=((C=function(){function e(t){m(this,e),this.analyticsService=t}return v(e,[{key:"authDeveloper",value:function(e){return this.analyticsService.sendAnalytic(e)}},{key:"authUser",value:function(e){return this.analyticsService.getAnalytic(e)}}]),e}()).\u0275fac=function(e){return new(e||C)(P.Zb(re))},C.\u0275prov=P.Lb({token:C,factory:C.\u0275fac,providedIn:"root"}),C),se=h("nYR2"),ce=function e(){m(this,e)},le=function(e){return e[e.User=0]="User",e[e.Developer=1]="Developer",e}({}),ue=function(e){return e.Init="init",e.View="view",e.ChanceInteraction="interactionc",e.FirstInteraction="interactionf",e.Call="call",e}({}),pe=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},de=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},ge={userType:le.User,authenticating:!1,authenticated:!1,widgetUrlConfig:{id:"",type:""},widgetApiConfig:null,parentUrl:{full:"",domain:""},embedded:!1,engineVersion:"",engineAPIVersion:"",inputEnabled:!0},he=((_=function(){function e(t,n){m(this,e),this.authService=t,this.analyticsService=n}return v(e,[{key:"setupWidget",value:function(e,t){var n=t.hostingURL,i=t.embedded,o=t.widgetConfig,r=n.match(/:\/\/(.[^/]+)/);e.patchState({userType:o.uaid?le.User:le.Developer,embedded:i,widgetUrlConfig:o,parentUrl:{full:n,domain:r&&r[1]?r[1]:n}})}},{key:"authWidget",value:function(e,t){var n=e.getState(),i=n.userType,o=n.widgetUrlConfig,r=i===le.User?this.authService.authUser(o.uaid):this.authService.authDeveloper(this.analyticsService.buildDeveloperAnalytic(n,ue.Init,ne.WidgetAPI,this.buildAppActivityData(n)));e.patchState({authenticating:!0}),r.pipe(Object(se.a)((function(){return e.patchState({authenticating:!1})}))).subscribe((function(t){var n=t.success;e.patchState({authenticated:n}),e.dispatch(n?new H(i,t):new Q(i,t))}))}},{key:"logWidgetInteraction",value:function(e,t){var n=t.interaction,i=t.source,o=e.getState(),r=o.userType===le.User?this.buildUserAnalytic(o,n,i):this.analyticsService.buildDeveloperAnalytic(o,n,ne.Widget,this.buildAppActivityData(o));this.analyticsService.sendAnalytic(r).subscribe((function(t){e.dispatch(t.success?new V(n,t):new N(n,t))}))}},{key:"resetWidget",value:function(e,t){e.setState(ge)}},{key:"buildAppActivityData",value:function(e){var t=e.engineVersion,n=e.engineAPIVersion,i=e.widgetUrlConfig,o={engine_version:t,api_version:n};return Object.entries(i).filter((function(e){return"dk"!==p(e,1)[0]})).forEach((function(e){var t=p(e,2),n=t[0],i=t[1];o["url_param_"+n]=i})),Object(te.plainToClass)(ce,o)}},{key:"setInputEnabled",value:function(e,t){e.patchState({inputEnabled:t.enabled})}},{key:"setWidgetApiConfig",value:function(e,t){e.patchState({widgetApiConfig:t.config})}},{key:"buildUserAnalytic",value:function(e,t,n){var i=e.widgetUrlConfig,o=e.parentUrl,r=i.uaid,a=o.domain,s=Object.assign(Object.assign({},this.buildAppActivityData(e)),u({parent_analytic_identifier:r,referer_domain:a},t+"_source",n)),c={analytic_platform:ne.Widget,analytic_type:t,analytic_data:s};return Object(te.plainToClass)(ee,c)}},{key:"ngxsOnInit",value:function(e){e.patchState({engineVersion:Human.VERSION,engineAPIVersion:Human.API_VERSION})}}],[{key:"getWidgetState",value:function(e){return e}},{key:"getUserType",value:function(e){return e.userType}},{key:"getWidgetAuthenticating",value:function(e){return e.authenticating}},{key:"getWidgetAuthenticated",value:function(e){return e.authenticated}},{key:"getInputEnabled",value:function(e){return e.inputEnabled}},{key:"getEmbedded",value:function(e){return e.embedded}},{key:"getParentURL",value:function(e){return e.parentUrl.full}},{key:"getWidgetUrlConfig",value:function(e){return e.widgetUrlConfig}},{key:"getWidgetApiUIConfig",value:function(e){return e.widgetApiConfig}}]),e}()).\u0275fac=function(e){return new(e||_)(P.Zb(ae),P.Zb(re))},_.\u0275prov=P.Lb({token:_,factory:_.\u0275fac}),pe([Object(E.a)(A),de("design:type",Function),de("design:paramtypes",[Object,A]),de("design:returntype",void 0)],_.prototype,"setupWidget",null),pe([Object(E.a)(B),de("design:type",Function),de("design:paramtypes",[Object,B]),de("design:returntype",void 0)],_.prototype,"authWidget",null),pe([Object(E.a)(R),de("design:type",Function),de("design:paramtypes",[Object,R]),de("design:returntype",void 0)],_.prototype,"logWidgetInteraction",null),pe([Object(E.a)(q),de("design:type",Function),de("design:paramtypes",[Object,q]),de("design:returntype",void 0)],_.prototype,"resetWidget",null),pe([Object(E.a)(W),de("design:type",Function),de("design:paramtypes",[Object,W]),de("design:returntype",void 0)],_.prototype,"setInputEnabled",null),pe([Object(E.a)($),de("design:type",Function),de("design:paramtypes",[Object,$]),de("design:returntype",void 0)],_.prototype,"setWidgetApiConfig",null),pe([Object(E.e)(),de("design:type",Function),de("design:paramtypes",[F]),de("design:returntype",void 0)],_,"getWidgetState",null),pe([Object(E.e)(),de("design:type",Function),de("design:paramtypes",[F]),de("design:returntype",void 0)],_,"getUserType",null),pe([Object(E.e)(),de("design:type",Function),de("design:paramtypes",[F]),de("design:returntype",void 0)],_,"getWidgetAuthenticating",null),pe([Object(E.e)(),de("design:type",Function),de("design:paramtypes",[F]),de("design:returntype",void 0)],_,"getWidgetAuthenticated",null),pe([Object(E.e)(),de("design:type",Function),de("design:paramtypes",[F]),de("design:returntype",void 0)],_,"getInputEnabled",null),pe([Object(E.e)(),de("design:type",Function),de("design:paramtypes",[F]),de("design:returntype",void 0)],_,"getEmbedded",null),pe([Object(E.e)(),de("design:type",Function),de("design:paramtypes",[F]),de("design:returntype",void 0)],_,"getParentURL",null),pe([Object(E.e)(),de("design:type",Function),de("design:paramtypes",[F]),de("design:returntype",void 0)],_,"getWidgetUrlConfig",null),pe([Object(E.e)(),de("design:type",Function),de("design:paramtypes",[F]),de("design:returntype",void 0)],_,"getWidgetApiUIConfig",null),_=pe([Object(E.f)({name:"widget",defaults:ge})],_)),fe=h("XNiG"),be=h("HDdC"),ve=h("1G5W"),me=h("pLZG"),ye=function(e){return e[e.Basics=0]="Basics",e[e.All=1]="All",e[e.Shortcuts=2]="Shortcuts",e}({});!function(e){var t=function e(t){m(this,e),this.canHover=t};t.type="[View] Set Can Hover",e.SetCanHover=t;var n=function e(t){m(this,e),this.canTouch=t};n.type="[View] Set Can Touch",e.SetCanTouch=n;var i=function e(t){m(this,e),this.canFullscreen=t};i.type="[View] Set Can Fullscreen",e.SetCanFullscreen=i;var o=function e(t){m(this,e),this.ui=t};o.type="[View] Set UI",e.SetUI=o;var r=function e(t){m(this,e),this.ui=t};r.type="[View] Set Initial UI",e.SetInitialUI=r;var a=function e(t){m(this,e),this.enabled=t};a.type="[View] Set Input Enabled",e.SetInputEnabled=a;var s=function e(t){m(this,e),this.mode=t};s.type="[View] Set Search Display Mode",e.SetSearchDisplayMode=s;var c=function e(t){m(this,e),this.active=t};c.type="[View] Toggle Presentation",e.TogglePresentation=c;var l=function e(t){m(this,e),this.interactType=t};l.type="[View] Set Interact Type",e.SetInteractType=l;var u=function e(t){m(this,e),this.onDemand=t};u.type="[View] Set On Demand",e.SetOnDemand=u;var p=function e(t){m(this,e),this.layout=t};p.type="[View] Set Layout",e.SetLayout=p;var d=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ye.Basics;m(this,e),this.tab=t};d.type="[View] Toggle Help Tab",e.ToggleHelpTab=d;var g=function e(t){m(this,e),this.inputMode=t};g.type="[View] Set Input Mode",e.SetInputMode=g;var h=function e(t){m(this,e),this.tutorial=t};h.type="[View] Set Tutorial",e.SetTutorial=h;var f=function e(t){m(this,e),this.intro=t};f.type="[View] Start Tutorial",e.StartTutorial=f;var b=function e(t){m(this,e),this.seen=t};b.type="[View] Tutorial Seen",e.TutorialSeen=b;var v=function e(){m(this,e)};v.type="[View] Tutorial Next",e.TutorialNext=v;var y=function e(){m(this,e)};y.type="[View] Tutorial Previous",e.TutorialPrevious=y;var x=function e(t){m(this,e),this.show=t};x.type="[View] Toggle Node Info",e.ToggleNodeInfo=x;var k=function e(t){m(this,e),this.enabled=t};k.type="[View] Set multi pick mode enabled",e.SetMultiPickModeEnabled=k;var w=function e(t){m(this,e),this.labelsBreakpoint=t};w.type="[View] Set Label Breakpoint",e.SetLabelBreakpoint=w;var O=function e(t){m(this,e),this.usePrintImage=t};O.type="[View] Set Use Print Image",e.SetUsePrintImage=O;var C=function e(t){m(this,e),this.windows=t};C.type="[View] Set Windows",e.SetWindows=C;var S=function e(t){m(this,e),this.window=t};S.type="[View] Open Window",e.OpenWindow=S;var _=function e(t){m(this,e),this.window=t};_.type="[View] Close Window",e.CloseWindow=_;var j=function e(t,n){m(this,e),this.window=t,this.show=n};j.type="[View] Toggle Window",e.ToggleWindow=j;var P=function e(t){m(this,e),this.open=t};P.type="[View] Toggle Menu",e.ToggleMenu=P;var M=function e(t){m(this,e),this.enabled=t};M.type="[View] Whiteboard Enabled",e.SetWhiteboardEnabled=M;var I=function e(t){m(this,e),this.brushSize=t};I.type="[View] Whiteboard Brush Size",e.SetWhiteboardBrushSize=I;var z=function e(t){m(this,e),this.brushColor=t};z.type="[View] Whiteboard Brush Color",e.SetWhiteboardBrushColor=z;var T=function e(t){m(this,e),this.size=t};T.type="[View] Whiteboard Text Size",e.SetWhiteboardTextSize=T;var U=function e(t){m(this,e),this.eraserSize=t};U.type="[View] Whiteboard Eraser Size",e.SetWhiteboardEraserSize=U;var L=function e(t){m(this,e),this.mode=t};L.type="[View] Whiteboard Annotate Mode",e.SetWhiteboardAnnotateMode=L;var D=function e(t){m(this,e),this.hasPaint=t};D.type="[View] Whiteboard Has Paint",e.SetWhiteboardHasPaint=D;var E=function e(t){m(this,e),this.hasText=t};E.type="[View] Whiteboard Has Text",e.SetWhiteboardHasText=E}(j||(j={}));var xe,ke,we,Oe=h("tyNb"),Ce=(h("mNvP"),h("m+po"),h("Wdmj")),Se=h("LvDl"),_e=function(e){return e.DiscoveredChapterNav="Discovered Chapter Nav",e}({}),je=((xe=function(){function e(t,n){m(this,e),this.config=t,this.router=n,this.appended=!1,this.sessionEvents={},this.pageEvents={},this.initRouteListener()}return v(e,[{key:"appendScript",value:function(){if(this.config.enabled&&!this.appended){var e="\n      (function(apiKey){\n        (function(p,e,n,d,o){var v,w,x,y,z;o=p[d]=p[d]||{};o._q=o._q||[];\n        v=['initialize','identify','updateOptions','pageLoad','track'];for(w=0,x=v.length;w<x;++w)(function(m){\n            o[m]=o[m]||function(){o._q[m===v[0]?'unshift':'push']([m].concat([].slice.call(arguments,0)));};})(v[w]);\n            y=e.createElement(n);y.async=!0;y.src='https://cdn.pendo.io/agent/static/'+apiKey+'/pendo.js';\n            z=e.getElementsByTagName(n)[0];z.parentNode.insertBefore(y,z);})(window,document,'script','pendo');\n      })('".concat(this.config.pendoId,"');\n    "),t=document.createElement("script");t.textContent=e,document.body.appendChild(t),this.appended=!0}}},{key:"initialize",value:function(e){var t,n=Object.assign({},e);if(this.pendoEnabled()){var i=Object(Se.get)(this.config,"idPrefixes[".concat(U.deploy,"]"),"");n.visitor.id="".concat(i).concat(n.visitor.id),n.account.id="".concat(i).concat(null!==(t=n.account.id)&&void 0!==t?t:999999999),pendo.initialize(e)}}},{key:"track",value:function(e,t){this.pendoEnabled()&&pendo.track(e,t)}},{key:"trackOncePerSession",value:function(e,t){this.sessionEvents[e]||this.pendoEnabled()&&(this.track(e,t),this.sessionEvents[e]=!0)}},{key:"trackOncePerPage",value:function(e,t){this.pageEvents[e]||this.pendoEnabled()&&(this.track(e,t),this.pageEvents[e]=!0)}},{key:"initRouteListener",value:function(){var e=this;this.router.events.pipe(Object(me.a)((function(e){return e instanceof Oe.c}))).subscribe((function(){e.pageEvents={}}))}},{key:"pendoEnabled",value:function(){if(!this.config.enabled)return!1;var e=Object(Se.get)(this.config,"whitelist[".concat(U.application,"]"),null);if(!Object(Se.isNil)(e)){var t=new URLSearchParams(window.location.search),n=t.get("id")||t.get("be")||t.get("m");return e.includes(n)}return!0}}]),e}()).\u0275fac=function(e){return new(e||xe)(P.Zb("pendoConfig"),P.Zb(Oe.e))},xe.\u0275prov=P.Lb({token:xe,factory:xe.\u0275fac,providedIn:"root"}),xe),Pe=function(){var e=function e(){m(this,e)};return e.type="[Engine] Load",e}(),Me=function(){var e=function e(t){m(this,e),this.result=t};return e.type="[Engine] Load Success",e}(),Ie=function(){var e=function e(t){m(this,e),this.ready=t};return e.type="[Engine] Set Ready",e}(),ze=function(){var e=function e(t){m(this,e),this.display=t};return e.type="[Engine] Set Display of 3D Scene",e}(),Te=function(){var e=function e(t){m(this,e),this.scrollMode=t};return e.type="[Engine] Set Zoom via scroll Allowed",e}(),Ue=function(){var e=function e(t){m(this,e),this.shown=t};return e.type="[Engine] Set Scroll Alert Shwon",e}(),Le=function(){var e=function e(t){m(this,e),this.visible=t};return e.type="[Engine] Set Visibility of 3D Scene",e}(),De=function(){var e=function e(t,n){m(this,e),this.color=t,this.duration=n};return e.type="[Engine] Fade",e}(),Ee=function(){var e=function e(){m(this,e)};return e.type="[Engine] Fade Complete",e}(),Fe=function(){var e=function e(t){m(this,e),this.graph=t};return e.type="[Engine] Set Graph",e}(),Ae=function(){var e=function e(){m(this,e)};return e.type="[Engine] Clear Graph",e}(),Re=function(){var e=function e(t){m(this,e),this.enabled=t};return e.type="[Engine] Set Xray Mode",e}(),Ve=function(){var e=function e(t){m(this,e),this.chapterId=t};return e.type="[Engine] Set Engine Chapter",e}(),Ne=function(){var e=function e(t){m(this,e),this.chapterInit=t};return e.type="[Eninge] Set Chapter Init",e}(),Be=function(){var e=function e(t,n,i){m(this,e),this.node=t,this.event=n,this.hit=i};return e.type="[Engine] Click Node",e}(),He=function(){var e=function e(t,n){m(this,e),this.node=t,this.hit=n};return e.type="[Engine] Set Contextmenu",e}(),Qe=function(){var e=function e(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2?arguments[2]:void 0;m(this,e),this.objectId=t,this.animate=n,this.animationDuration=i};return e.type="[Engine] Fly To Object",e}(),qe=function(){var e=function e(){m(this,e)};return e.type="[Engine] Center Camera on Visible Nodes",e}(),We=function(){var e=function e(t,n){m(this,e),this.leafVisibilityState=t,this.nodes=n};return e.type="[Engine] Synchronize Visible Nodes On Tree",e}(),$e=function(){var e=function e(t){m(this,e),this.leafRenderableState=t};return e.type="[Engine] Synchronize Renderable State of Nodes On Tree",e}(),Ke=function(){var e=function e(t,n){m(this,e),this.leafPickableState=t,this.nodes=n};return e.type="[Engine] Synchronize Pickable State of Nodes On Tree",e}(),Ge=function(){var e=function e(t){m(this,e),this.show=t};return e.type="[Engine] Toggle Camera Bar",e}(),Ze=function(){var e=function e(t){m(this,e),this.show=t};return e.type="[Engine] Toggle Progress Bar",e}(),Je=function(){var e=function e(t){m(this,e),this.show=t};return e.type="[Engine] Toggle Labels",e}(),Xe=function(){var e=function e(t){m(this,e),this.tool=t};return e.type="[Engine] Set active tool",e}(),Ye=function(){var e=function e(t,n){m(this,e),this.chapter=t,this.pause=n};return e.type="[Engine] Play chapter animation",e}(),et=function(){var e=function e(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];m(this,e),this.play=t};return e.type="[Engine] Play animation",e}(),tt=function(){var e=function e(t){m(this,e),this.playing=t};return e.type="[Engine] Set animation playing",e}(),nt=function(){var e=function e(t){m(this,e),this.speed=t};return e.type="[Engine] Set playback speed",e}(),it=function(){var e=function e(t){m(this,e),this.play=t};return e.type="[Engine] Play audio",e}(),ot=function(){var e=function e(){m(this,e)};return e.type="[Engine] Play chapter from start",e}(),rt=function(){var e=function e(t){m(this,e),this.enable=t};return e.type="[Engine] Set autoplay",e}(),at=function(){var e=function e(t,n){m(this,e),this.nodes=t,this.layer=n};return e.type="[Engine] Set object layer order",e}(),st=function(){var e=function e(t,n){m(this,e),this.nodeId=t,this.displayName=n};return e.type="[Engine] Set object display name",e}(),ct=function(){var e=function e(){m(this,e)};return e.type="[Engine] Auto Sort object layer orders",e}(),lt=function(){var e=function e(){m(this,e)};return e.type="[Engine] Reset object layer orders",e}(),ut=function(){var e=function e(t){m(this,e),this.position=t};return e.type="[Engine] Set Engine Position",e}(),pt=function(){var e=function e(){m(this,e)};return e.type="[Engine] Reset Engine Position",e}(),dt=function(){var e=function e(t){m(this,e),this.effects=t};return e.type="[Engine] Set Post Processing Effects",e}(),gt=function(){var e=function e(t){m(this,e),this.properties=t};return e.type="[Engine] Set Properties",e}(),ht=function(){var e=function e(t){m(this,e),this.mode=t};return e.type="[Engine] Set Transparency Mode",e}(),ft=function(){var e=function e(t){m(this,e),this.node=t};return e.type="[Engine] Expand ViewTree Node",e}(),bt=function(){var e=function e(t){m(this,e),this.node=t};return e.type="[Engine] Collapse ViewTree Node",e}(),vt=function(){var e=function e(t,n){m(this,e),this.node=t,this.hit=n};return e.type="[Engine] Hover Node",e}(),mt=function(){var e=function e(t){m(this,e),this.node=t};return e.type="[Engine] Set Label Edit Node",e}(),yt=function(){var e=function e(t,n){m(this,e),this.node=t,this.description=n};return e.type="[Engine] Set Node Info",e}(),xt=function(){var e=function e(t){m(this,e),this.node=t};return e.type="[Engine] Query Node Info",e}(),kt=function(){var e=function e(t,n){m(this,e),this.node=t,this.description=n};return e.type="[Engine] Query Node Info Success",e}(),wt=function(){var e=function e(t){m(this,e),this.node=t};return e.type="[Engine Nodes] Query Node Info Failure",e}(),Ot=function e(){m(this,e)},Ct=function e(){m(this,e)},St=function e(t){var n=this;m(this,e),this.shown=function(e){return!1},this.selected=function(e){return!1},this.pickable=function(e){return!0},t.forEach((function(e){n[e]=function(e){return!1}}))};!function(e){function t(e,t){e.nodes[t.id]||(e.nodes[t.id]=t)}function n(e,t){return e.nodes[t]||null}function i(e,t){return e.predecessors[t]||null}function o(e,t){return c(e.successors[t]||[])}function r(e){return Object.keys(e.roots)}e.addRootNode=function(e,i){t(e,i);var o=n(e,i.id);e.roots[o.id]=o},e.getNodes=function(e,t){var n=[];return t.forEach((function(t){e.nodes[t]&&n.push(e.nodes[t])})),n},e.getAncestors=function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"ascending",o=n?[t]:[],r=e.predecessors[t];r;)o.push(r),r=e.predecessors[r];return"descending"===i&&o.reverse(),o},e.addNode=t,e.getNode=n,e.getAncestor=i,e.getAllAncestorsFromList=function(e,t){var n,o={};return t.forEach((function(t){(n=i(e,t))&&!o[n]&&(o[n]=!0)})),Object.keys(o)},e.getSuccessors=o,e.getState=function(e,t,i){var o={},r=n(e,t);return Object.entries(r.boolState).forEach((function(e){var t=p(e,2),n=t[0],r=t[1];i&&i.includes(n)&&(o[n]=r)})),Object.entries(r.numState).forEach((function(e){var t=p(e,2),n=t[0],r=t[1];i&&i.includes(n)&&(o[n]=r)})),o},e.isLeaf=function(e,t){return!!e.nodes[t]&&void 0===e.successors[t]},e.isRoot=function(e,t){return e.roots.hasOwnProperty(t)||!1},e.getRoots=r,e.depthFirst=function e(t,n,i){i?(n(i),o(t,i).forEach((function(i){e(t,n,i)}))):r(t).forEach((function(i){n(i),e(t,n,i)}))},e.createGraphFromSrc=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"objectId",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"objects",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o={nodes:{},successors:{},predecessors:{},roots:{}};return e.forEach((function(e){!function e(t,n,i,o,r,a,s){var l={id:i[o],depth:0,boolState:{},numState:{}};l.depth=s,function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"id";Object.entries(n).forEach((function(n){var o,r=p(n,2),a=r[0],s=r[1];"string"==typeof s?o=t[s]:"function"==typeof s&&(o=s(t[i])),"boolean"==typeof o?e.boolState[a]=o:"number"==typeof o?e.numState[a]=o:e[a]=o}))}(l,i,a,o),t.nodes[l.id]=l,n?(t.successors[n]=[].concat(c(t.successors[n]||[]),[l.id]),t.predecessors[l.id]=n):t.roots[l.id]=l,s+=1,(i[r]||[]).forEach((function(n){e(t,l.id,n,o,r,a,s)}))}(o,null,e,t,n,i,0)})),o},e.pruneHiddenObjects=function e(t,n,i){var o,r=[],a=s(t);try{for(a.s();!(o=a.n()).done;){var c=o.value,l=n[c.objectId],u=!0===l||!1!==l&&i,p=e(c.objects||[],n,u);if(u){var d=Object.assign({},c);d.objects=p,r.push(d)}else p.forEach((function(e){return r.push(e)}))}}catch(g){a.e(g)}finally{a.f()}return r}}(ke||(ke={})),function(e){function t(e,t){return e.reduce((function(e,n){return e[n]=t[n]||!1,e}),{})}e.createVoter=t,e.getInitialVoterState=function(e,n){return Object.keys(e).reduce((function(i,o){return i[o]=t(n,e[o]),i}),{})},e.getInitialElectionDepth=function(e,t){return Object.keys(e).reduce((function(e,n){return Math.max(e,ke.getNode(t,n).depth)}),0)-1},e.getEligibleElections=function(e,t,n){return ke.getAllAncestorsFromList(e,t).filter((function(t){return t&&ke.getNode(e,t).depth===n}))};var n={trueWins:function(e){return{result:e.votesFor.length>0,dissenters:c(e.votesAgainst)}},falseWins:function(e){return{result:e.votesAgainst.length>0,dissenters:c(e.votesFor)}},majorityWins:function(e){var t=e.votesFor.length>e.votesAgainst.length;return{result:t,dissenters:c(t?e.votesAgainst:e.votesFor)}}};function i(e,t,i){return Object.keys(t).reduce((function(o,r){var a=t[r],s=i[r]||"majorityWins",l=n[s](a),u=l.result,p=l.dissenters;return o[r]={id:e,result:u,dissenters:p,voters:[].concat(c(a.votesFor),c(a.votesAgainst))},o}),{})}e.buildElectionResult=i,e.getElectionResults=function(e,n,o,r){var a=n,s=Object.keys(r);return{results:o.reduce((function(o,c){var l=ke.getSuccessors(e,c),d=l.map((function(i){return u({},i,n[i]||t(s,ke.getState(e,i,s)))}));l.forEach((function(e){delete a[e]}));var g=i(c,function(e,t){return Object.keys(e).reduce((function(e,n){var i=t.reduce((function(e,t){var i=Object.keys(t)[0];return t[i][n]?e.votesFor.push(i):e.votesAgainst.push(i),e}),{votesFor:[],votesAgainst:[]});return e[n]=i,e}),{})}(r,d),r);return a[c]=Object.entries(g).reduce((function(e,t){var n=p(t,2),i=n[0],o=n[1];return e[i]=o.result,e}),{}),o.results.push(g),o}),{results:[]}).results,remainingVoters:a}}}(we||(we={}));var _t,jt,Pt,Mt,It,zt,Tt,Ut=((_t=function(){function e(){m(this,e)}return v(e,[{key:"serializeNode",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(e){return!0},r={};return r.id=t.id,Object.entries(t.boolState).forEach((function(e){var t=p(e,2),n=t[0],o=t[1];i.hasOwnProperty(n)&&(r[n]=o)})),Object.entries(t.numState).forEach((function(e){var t=p(e,2),n=t[0],o=t[1];i.hasOwnProperty(n)&&(r[n]=o)})),e.successors[t.id]&&(r.children=[],e.successors[t.id].forEach((function(t){o(t)&&r.children.push(n.serializeNode(e,e.nodes[t],i,o))}),this)),r}},{key:"getAllSiblingsFromList",value:function(e,t,n){var i,o=[];for(i=0;i<t.length;i++)this.getSiblings(e,t[i],n).forEach((function(e){o.includes(e)||o.push(e)}));return o}},{key:"getElectionResults",value:function(e,n,o,a){var s,c,l=this,u=function(e){t(o,e);var n=i(o);function o(e,t){var i;return m(this,o),i=n.call(this),Object.entries(e).forEach((function(e){var n=p(e,2),o=n[0];n[1],i[o]={votesFor:[],votesAgainst:[]},Object.entries(t).forEach((function(e){var t=p(e,2),n=t[0];t[1][o]?i[o].votesFor.push(n):i[o].votesAgainst.push(n)}),r(i))}),r(i)),i}return o}(function(){return function e(){m(this,e)}}()),d=Object.keys(a),g=[];return o.forEach((function(t){c={},ke.getSuccessors(e,t).forEach((function(t){c[t]=n[t]||we.createVoter(d,ke.getState(e,t,d)),delete n[t]}),l),s=new u(a,c);var i=we.buildElectionResult(t,s,a);g.push(i);var o={};Object.entries(i).forEach((function(e){var t=p(e,2),n=t[0],i=t[1];o[n]=i.result})),n[t]=o}),this),g}},{key:"updateGraphStateRecord",value:function(e,t,n,i){var o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];n.forEach((function(n){var r=n[i[0]].id,a=ke.getState(e,r,i),s={},c=!1;i.forEach((function(e){(o||n[e].result!==a[e])&&(s[e]=n[e].result,c=!0)})),c&&(t[r]=s)}),this)}},{key:"nodeExists",value:function(e,t){return!!e.nodes[t]}},{key:"getLeaves",value:function(e){var t=[];return Object.entries(e.nodes).forEach((function(n){var i=p(n,2),o=i[0];i[1],e.successors[o]||t.push(o)})),t}},{key:"getDescendants",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=[];return function t(n){ke.getSuccessors(e,n).forEach((function(e){i.push(e),t(e)}))}(t),n&&i.push(t),i}},{key:"getLeafDescendants",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this.getDescendants(e,t,n).filter((function(t){return ke.isLeaf(e,t)}));return(ke.isLeaf(e,t)||n)&&i.push(t),i}},{key:"getAllLeafDescendants",value:function(e,t){var n=this,i=[];return t.forEach((function(t){i=ke.isLeaf(e,t)?[].concat(c(i),[t]):[].concat(c(i),c(n.getLeafDescendants(e,t,!1)))})),i.sort().reduce((function(e,t){return e.indexOf(t)<0&&e.push(t),e}),[])}},{key:"getInverseSelection",value:function(e,t){var n=this.getAllLeafDescendants(e,t);return this.getLeaves(e).filter((function(e){return n.indexOf(e)<0}))}},{key:"getSiblings",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=e.predecessors[t],o=[];if(o=i?ke.getSuccessors(e,i):ke.getRoots(e),!n){var r=o.indexOf(t);r>=0&&o.splice(r,1)}return o}},{key:"getNodes",value:function(e,t){var n=[];return t.forEach((function(t){e.nodes[t]&&n.push(e.nodes[t])})),n}},{key:"setState",value:function(e,t,n){var i=ke.getNode(e,t),o={};return Object.entries(n).forEach((function(e){var t=p(e,2),n=t[0],r=t[1];"boolean"==typeof r&&i.boolState[n]!==r?(i.boolState[n]=r,o[n]=r):"number"==typeof r&&i.numState[n]!==r&&(i.numState[n]=r,o[n]=r)})),o}},{key:"synchronize",value:function(e,t,n){var i=this,o=this.calculateGraphStateMap(e,t,n);return Object.entries(o).forEach((function(t){var n=p(t,2),o=n[0],r=n[1];i.setState(e,o,r)}),this),o}},{key:"calculateGraphStateMap",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:!n,o=[],r={},a=[],s={},c=Object.keys(t),l=0;for(n?Object.entries(n).forEach((function(t){var i=p(t,2),o=i[0];i[1],r[o]=we.createVoter(c,n[o]),s[o]=Object.assign({},r[o]),l=Math.max(l,ke.getNode(e,o).depth)}),this):this.getLeaves(e).forEach((function(t){r[t]=we.createVoter(c,ke.getNode(e,t).boolState),s[t]=Object.assign({},r[t]),l=Math.max(l,ke.getNode(e,t).depth)}),this),l-=1,o=we.getEligibleElections(e,Object.keys(r),l);l>=0;)a=this.getElectionResults(e,r,o,t),this.updateGraphStateRecord(e,s,a,c,i),l-=1,o=we.getEligibleElections(e,Object.keys(r),l);return s}},{key:"filterGraphAccessors",value:function(e,t){var n=this,i=this.getNodes(e,t).sort((function(e,t){return e.depth-t.depth})),o=new Map;return i.filter((function(t){return!o.has(t.id)&&(n.getDescendants(e,t.id,!0).forEach((function(e){return o.set(e,!0)})),!0)})).map((function(e){return e.id}))}},{key:"resetDepth",value:function(e){ke.depthFirst(e,(function(t){var n=0;e.predecessors[t]&&(n=ke.getNode(e,e.predecessors[t]).depth+1),ke.getNode(e,t).depth=n}))}},{key:"deleteNode",value:function(e,t){var n=this,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this.nodeExists(e,t)){delete e.nodes[t];var o=e.predecessors[t];o&&(delete e.predecessors[t],e.successors[o]&&(e.successors[o]=e.successors[o].filter((function(e){return e!==t}))));var r=e.successors[t];r&&(delete e.successors[t],i&&r.forEach((function(t){n.deleteNode(e,t)}),this)),e.roots[t]&&delete e.roots[t]}}},{key:"sanitizeNodeID",value:function(e){var t=new RegExp(/\|/,"gi");return e.replace(t,"_")}},{key:"resetAsLeaf",value:function(e,t){var n=[];return e.nodes[t]&&!ke.isLeaf(e,t)&&(n=this.getDescendants(e,t),delete e.successors[t],n.forEach((function(t){delete e.nodes[t],delete e.successors[t],delete e.predecessors[t]}))),n}}]),e}()).\u0275fac=function(e){return new(e||_t)},_t.\u0275prov=P.Lb({token:_t,factory:_t.\u0275fac,providedIn:"root"}),_t),Lt=function e(){m(this,e)},Dt=function(e){return e.Started="started",e.Loaded="loaded",e.Tick="tick",e.HumanReady="human.ready",e.HumanStarted="started",e.Error="error",e.HumanError="human.error",e.LogDebug="_log.debug",e.LogError="_log.error",e.LogInfo="_log.info",e.LogWarn="_log.warn",e.SceneLoaded="scene.loaded",e.HumanProgress="human.progress",e.AnnotationsCreated="annotations.created",e.AnnotationsDestroyed="annotations.destroyed",e.AnnotationsHidden="annotations.hidden",e.AnnotationsShown="annotations.shown",e.AssetsLoadFinish="assets.load.finish",e.AssetsLoadProgress="assets.load.progress",e.AssetsLoadStart="assets.load.start",e.CameraRested="camera.rested",e.CameraUpdated="camera.updated",e.HotspotsDisplayUpdated="hotspots.displayUpdated",e.HotspotsEntered="hotspots.entered",e.HotspotsLeft="hotspots.left",e.HotspotsPicked="hotspots.picked",e.HotspotsPositionUpdated="hotspots.positionUpdated",e.LabelsCreated="labels.created",e.LabelsUpdated="labels.updated",e.LabelsMoved="labels.moved",e.LabelsDestroyed="labels.destroyed",e.LabelsChapterInfo="labels.chapterInfo",e.LabelsShown="labels.shown",e.LabelsHidden="labels.hidden",e.LabelsEnabled="labels.enabled",e.LabelsDisabled="labels.disabled",e.LabelsEntered="labels.entered",e.LabelsLeft="labels.left",e.LabelsPicked="labels.picked",e.ModuleInteractive="module.interactive",e.ModulesActivateFinish="modules.activate.finish",e.ModulesCreateFinish="modules.create.finish",e.ModulesDestroyFinish="modules.destroy.finish",e.PickPicked="pick.picked",e.QuizEntered="quiz.entered",e.QuizExited="quiz.exited",e.QuizQuestionLoaded="quiz.questionLoaded",e.QuizAnswerSelected="quiz.answerSelected",e.QuizAnswerSubmitted="quiz.answerSubmitted",e.QuizCompleted="quiz.completed",e.SceneMarkersUpdated="scene.markers.updated",e.SceneObjectRenderable="scene.objectRenderable",e.SceneObjectsSelected="scene.objectsSelected",e.SceneObjectsShown="scene.objectsShown",e.ScenePicked="scene.picked",e.SceneRestored="scene.restored",e.SceneXrayEnabled="scene.xrayEnabled",e.SceneXrayDisabled="scene.xrayDisabled",e.SceneReady="scene.ready",e.TimelineChaptersActivated="timeline.chapters.activated",e.TimelineChaptersActivateFinish="timeline.chapters.activate.finish",e.TimelineChaptersActivateStart="timeline.chapters.activate.start",e.TimelineChapterTransition="timeline.chapterTransition",e.TimelinePlaying="timeline.playing",e.TimelineScrubbed="timeline.scrubbed",e.TimelinePlayed="timeline.played",e.TimelineStopped="timeline.stopped",e.TimelinePaused="timeline.paused",e.TimelineUnpaused="timeline.unpaused",e.TimelineCompleted="timeline.completed",e.GraphAssetAttachFinish="graph.assetAttach.finish",e.TweenVisibilityUpdate="TweenVisibilityUpdate",e.NativeDeleteData="native.deleteData",e.NativeUpgrade="native.upgrade",e.NativeRestore="native.restore",e.NativeShare="native.share",e.NativeGoogleSignUp="native.googleSignUp",e.NativeDebugMessage="native.debugMessage",e}({}),Et=function(e){return e.SSAO="sao",e.Blur="blur",e.RadialBlur="radialBlur",e.DOF="dof",e.FXAA="fxaa",e.GroundShadow="groundShadow",e}({}),Ft={shown:"shown",renderable:function(e){return Human.scene.objects[e].isRenderable()},pickable:"pickable",label:function(e){return Human.scene.objects[e].displayName},expanded:function(e){return!1},layer:"layer"},At={shown:"trueWins",renderable:"falseWins",pickable:"trueWins"},Rt={trim:!0},Vt=function e(t){m(this,e),this.trim=t.trim||!1,this.terminal=t.terminal||[],this.root=t.root||{children:[],replace:!1},this.connect=t.connect||{},this.nodes=t.nodes||[]},Nt=((jt=function(){function e(t){var n=this;m(this,e),this.graphService=t,this.objectToNodeMap={},this.nodeToObjectMap={},this.events={},this.events=Object.values(Dt).reduce((function(e,t){return e[t]=n.makeObservable(t),e}),{})}return v(e,[{key:"makeObservable",value:function(e){return new be.a((function(t){Human.events.on(e,(function(e){t.next(e)}))}))}},{key:"getCanvas",value:function(){return Human.renderer.canvas.canvas}},{key:"getEvent",value:function(e){return this.events[e]}},{key:"fireEvent",value:function(e,t){Human.events.fire(e,t)}},{key:"getSceneBoundary",value:function(){return Human.scene.getBoundary()}},{key:"getObjectBoundary",value:function(e){return Human.scene.objects[e].getBoundary()}},{key:"getObjectLoaded",value:function(e){var t=this.getObjectBoundary(e);return!Object(Se.isNil)(t)&&Object.values(t).every((function(e){return isFinite(e)}))}},{key:"pickScene",value:function(e){return Human.renderer.pick.pick(e.x,e.y,{rayPick:e.rayPick})}},{key:"transformObject",value:function(e,t){var n=Human.scene.objects[e];n?n.setTransform(t):console.error("Scene object not found: '".concat(e,"'"))}},{key:"toggleNodes",value:function(e,t){var n=this,i={replace:!1,objects:{},fetchAssets:t};e.forEach((function(e){n.getObjects(e).forEach((function(e){i.objects[e]=t}))})),Human.scene.setEnabledObjects(i)}},{key:"setNodesVisible",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n={replace:t,objects:Object.assign({},e),fetchAssets:!0};Human.scene.setEnabledObjects(n)}},{key:"setNodesPickable",value:function(e){var t=this;Object.keys(e).forEach((function(n){(Human.scene.objects[n].isLeaf()?[n]:t.getLeafObjects(n)).forEach((function(t){Human.scene.objects[t].setPickable(e[n])}))}))}},{key:"filterObjects",value:function(e,t){for(var n=e.length;n--;)switch(!0){case e[n]instanceof Human.scene.Group:e[n].objects=this.filterObjects(e[n].objects,t),0===e[n].objects.length&&e.splice(n,1);break;case e[n]instanceof Human.scene.Object:-1===e[n].displayName.toLowerCase().indexOf(t)&&e.splice(n,1)}return e}},{key:"setObjectLayer",value:function(e,t){var n=Human.scene.objects[e];if(n.layer=t,n.renderables)for(var i=0;i<n.renderables.length;++i)n.renderables[i].setLayer(t);else n.hasOwnProperty("_layerNode")?n._layerNode.setPriority(t):n.hasOwnProperty("_propertiesNode")&&n._propertiesNode.setProperties({layer:t})}},{key:"getObjectLayerValues",value:function(e){var t={},n=Human.scene.getBoundary();return e.forEach((function(e){var i=Human.scene.objects[e],o=i.getBoundary(),r=Math.min(o.xmin-n.xmin,n.xmax-o.xmax),a=2*Math.min(o.ymin-n.ymin,n.ymax-o.ymax),s=Math.min(o.zmin-n.zmin,n.zmax-o.zmax),c=i.layer;t[c]=t[c]||[],t[c].push({nodeId:e,value:Math.min(r,a,s)})})),t}},{key:"getSceneGraph",value:function(e){var t=ke.createGraphFromSrc(e,"objectId","objects",Ft);return this.graphService.synchronize(t,At),t}},{key:"createViewGraph",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=t?ke.pruneHiddenObjects(Human.scene.rootObjects,e):Human.scene.rootObjects,i=n.reduce((function(e,t){var n=t.objectId.includes("-root");return e[t.objectId]=!0!==n,n&&t.objects.forEach((function(t){e[t.objectId]=!0})),e}),{}),o=this.getSceneGraph(ke.pruneHiddenObjects(n,i));return this.graphService.resetDepth(o),o}},{key:"getNode",value:function(e,t){return this.graphService.nodeExists(e,t)?ke.getNode(e,t):this.objectToNodeMap[t]?ke.getNode(e,this.objectToNodeMap[t]):null}},{key:"getChapterGraphConfig",value:function(){var e=Human.timeline.activeRoot._nowBranch;return new Vt(Object.assign(Object.assign({},Rt),e.graph||{}))}},{key:"getRootObjects",value:function(){return Human.scene.rootObjects}},{key:"getAllSceneObjects",value:function(){return Human.scene.objects}},{key:"getObjects",value:function(e){return this.nodeToObjectMap[e]?this.nodeToObjectMap[e]:[Human.scene.objects[e].objectId]||!1}},{key:"getLeafObjects",value:function(e){if(e in this.nodeToObjectMap){var t={};return this.nodeToObjectMap[e].forEach((function(e){Human.scene.objects[e].isLeaf()?t[e]=!0:Human.scene.getLeaves(e).forEach((function(e){t[e]=!0}))})),Object.keys(t)}return e in Human.scene.objects?Human.scene.getLeaves(e):[]}},{key:"getChapter",value:function(e){return Human.timeline.branchTimelines[e]||null}},{key:"getActiveChapters",value:function(){return Human.timeline.activeRoot?Human.timeline.activeRoot._chapters:[]}},{key:"getBoundaryFromObjects",value:function(e){return e=e.filter((function(e){return Human.scene.objects[e].isLeaf()})),Human.scene.getBoundary({objectIds:e,clipped:!0})}},{key:"getLeaves",value:function(e){return Human.scene.getLeaves(e)}},{key:"getVisibleLeaves",value:function(){return Human.scene.getEnabledLeaves()}},{key:"getCameraLookAt",value:function(){return Object(te.plainToClass)(Lt,Human.renderer.camera.getLookAt())}},{key:"barycentricToWorld",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=new Float32Array([0,0,0]);return Human.scene.objects[e].barycentricToWorldSpace(i,t,n,o),isNaN(o[0])?[0,0,0]:c(Array.from(o))}},{key:"setGraphState",value:function(e){Human.scene.setObjectProperties(e)}},{key:"getAssetNamespaces",value:function(){var e={};return Object.keys(Human.assets.loadedAssets).map((function(e){return e.split("/")[0]})).forEach((function(t){e[t]=!0})),Object.keys(e)}},{key:"loadGraphObject",value:function(e){var t=this.getObjects(e).map((function(e){return Human.scene.objects[e]}));return new be.a((function(e){Human.scene.graph.attachAssetSetsToSubtree(t,null,(function(){e.next(!0),e.complete()}))}))}},{key:"setProperties",value:function(e){Human.properties.set(e)}},{key:"setTransparencyMode",value:function(e){Human.renderer.setTransparencyMode(e)}},{key:"setPostProcessingEnabled",value:function(e){e?Human.renderer.postprocess.enable():Human.renderer.postprocess.disable()}},{key:"setPostProcessingFeatures",value:function(e){var t=e.filter((function(e){return e.effect!==Et.GroundShadow}));Human.renderer.postprocess.parse(t);var n=e.find((function(e){return e.effect===Et.GroundShadow}));n?(Human.renderer.groundShadow.init(),Human.renderer.groundShadow.update({blurAmount:n.blur,opacity:n.opacity,translation:[n.xPos,n.yPos,n.zPos],scale:n.size})):Human.renderer.groundShadow.destroy()}},{key:"enableAnimation",value:function(){Human.timeline.enableAnimation()}},{key:"enableRender",value:function(){Human.renderer.enableRender()}},{key:"canIRender",value:function(){return Human.renderer.canIRender()}}]),e}()).\u0275fac=function(e){return new(e||jt)(P.Zb(Ut))},jt.\u0275prov=P.Lb({token:jt,factory:jt.\u0275fac,providedIn:"root"}),jt),Bt=function e(t,n,i,o,r){m(this,e),this.left=t,this.top=n,this.width=i,this.height=o,this.visibility=r},Ht=function(e){return e[e.Hidden=-1]="Hidden",e[e.Shown=1]="Shown",e}({}),Qt=function e(){m(this,e)},qt=function(){var e=function e(t){m(this,e),this.id=t};return e.type="[Engine Camera] Clear Camera",e}(),Wt=function(){var e=function e(t,n){m(this,e),this.id=t,this.camera=n};return e.type="[Engine Camera] Store Camera",e}(),$t=function(){var e=function e(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2?arguments[2]:void 0;m(this,e),this.camera=t,this.animate=n,this.animationDuration=i};return e.type="[Engine Camera] Set Camera",e}(),Kt=function(){var e=function e(){m(this,e)};return e.type="[Engine Camera] Set Camera Success",e}(),Gt=function(){var e=function e(t){m(this,e),this.cameraMotion=t};return e.type="[Engine Camera] Move Camera",e}(),Zt=function(){var e=function e(){m(this,e)};return e.type="[Engine Camera] Reset Camera",e}(),Jt=function(){var e=function e(t){m(this,e),this.value=t};return e.type="[Engine Camera] Zoom Camera",e}(),Xt=function(){var e=function e(t){m(this,e),this.value=t};return e.type="[Engine Camera] Zoom Camera Static",e}(),Yt=function(){var e=function e(t){m(this,e),this.value=t};return e.type="[Engine Camera] Pan Camera X",e}(),en=function(){var e=function e(t){m(this,e),this.value=t};return e.type="[Engine Camera] Pan Camera Y",e}(),tn=function(){var e=function e(t,n,i){m(this,e),this.x=t,this.y=n,this.z=i};return e.type="[Engine Camera] Pan Camera Static",e}(),nn=function(){var e=function e(t){m(this,e),this.value=t};return e.type="[Engine Camera] Rotate Camera X",e}(),on=function(){var e=function e(t){m(this,e),this.value=t};return e.type="[Engine Camera] Rotate Camera Y",e}(),rn=function(){var e=function e(t,n){m(this,e),this.x=t,this.y=n};return e.type="[Engine Camera] Rotate Camera Static",e}(),an=function(){var e=function e(t){m(this,e),this.mode=t};return e.type="[Engine Camera] Set Camera Mode",e}(),sn=function(){var e=function e(t){m(this,e),this.zoomed=t};return e.type="[Engine Camera] Set Zoomed",e}(),cn=function(){var e=function e(t){m(this,e),this.lock=t};return e.type="[Engine Camera] Lock camera",e}(),ln=function(){var e=function e(t){m(this,e),this.camera=t};return e.type="[Engine Camera] Set Camera Fly To",e}(),un=function(){var e=function e(t){m(this,e),this.patches=t};return e.type="[Engine Camera] Patch Camera State",e}(),pn=function(){function e(){m(this,e)}return v(e,null,[{key:"toArray",value:function(e){return[e.x,e.y,e.z]}},{key:"fromArray",value:function(e){return{x:e[0],y:e[1],z:e[2]}}}]),e}(),dn=((Mt=function(){function e(){m(this,e)}return v(e,[{key:"roundModel",value:function(e,t){var n=this,i=Object.assign({},e);return Object.keys(e).filter((function(t){return"number"==typeof e[t]})).forEach((function(o){i[o]=n.roundNumber(e[o],t)})),i}},{key:"roundNumber",value:function(e,t){return Math.round(e*Math.pow(10,t))/Math.pow(10,t)}}]),e}()).\u0275fac=function(e){return new(e||Mt)},Mt.\u0275prov=P.Lb({token:Mt,factory:Mt.\u0275fac,providedIn:"root"}),Mt),gn=((Pt=function(){function e(t){m(this,e),this.numberService=t,this.rotation={vx:0,vy:0},this.pan={x:0,y:0,z:0},this.zoom=0}return v(e,[{key:"getEye",value:function(){return Human.renderer.camera.eye}},{key:"setEye",value:function(e){Human.renderer.camera.setLookAt({eye:e})}},{key:"getCamera",value:function(){return Human.renderer.camera.getLookAt()}},{key:"getLookDirection",value:function(){var e=vec3.create();return Human.renderer.camera.getLookDir(e),e}},{key:"setCamera",value:function(e){return Human.renderer.camera.setLookAt(e)}},{key:"getCameraZoom",value:function(){return Human.renderer.camera.getZoom()}},{key:"captureCamera",value:function(){return{lookAt:Human.renderer.camera.getLookAt(),zoom:Human.renderer.camera.getZoom()}}},{key:"resetCamera",value:function(){return new be.a((function(e){Human.init.resetCamera((function(){e.next(),e.complete()}))}))}},{key:"getDirection",value:function(e){var t=this.getEye(),n=vec3.create();return n[0]=t.x-e.worldPos[0],n[1]=t.y-e.worldPos[1],n[2]=t.z-e.worldPos[2],vec3.normalize(n,n),n}},{key:"rotateCameraStatic",value:function(e,t){Human.renderer.camera.rotateX(e),Human.renderer.camera.rotateY(t)}},{key:"panCameraStatic",value:function(e,t,n){Human.renderer.camera.pan({x:e,y:t,z:n})}},{key:"setHumanZoom",value:function(e){Human.renderer.camera.zoom(e)}},{key:"setHumanZoomFactor",value:function(e){Human.renderer.camera.setZoom(e)}},{key:"setCameraRotation",value:function(e,t){this.rotation.vx=t,this.rotation.vy=-e}},{key:"setCameraPan",value:function(e,t){this.pan.x=e,this.pan.y=t}},{key:"setCameraZoom",value:function(e){this.zoom=.03*e}},{key:"setCameraZoomWithVelocity",value:function(e){var t=this;this.setCameraZoom(e),requestAnimationFrame((function(){e*=.85,Math.abs(e)>1&&t.setCameraZoomWithVelocity(e)}))}},{key:"tickCameraRotation",value:function(){return this.rotation.vx=this.checkEpsilon(this.rotation.vx),this.rotation.vy=this.checkEpsilon(this.rotation.vy),this.rotation}},{key:"tickCameraPan",value:function(){return this.pan.x=this.checkEpsilon(this.pan.x),this.pan.y=this.checkEpsilon(this.pan.y),this.pan.z=this.checkEpsilon(this.pan.z),this.pan}},{key:"tickCameraZoom",value:function(){return this.zoom=this.checkEpsilon(this.zoom),this.zoom}},{key:"areCamerasEqual",value:function(e,t){return this.compareXYZ(e.eye,t.eye)&&this.compareXYZ(e.look,t.look)&&this.compareXYZ(e.up,t.up)}},{key:"compareXYZ",value:function(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z}},{key:"roundCamera",value:function(e,t){var n=e.eye,i=e.look,o=e.up;return{eye:this.numberService.roundModel(n,t),look:this.numberService.roundModel(i,t),up:this.numberService.roundModel(o,t)}}},{key:"cameraAfterFlyTo",value:function(e){var t=this.getCamera(),n=pn.toArray(t.look),i=pn.toArray(t.eye),o=vec3.create();vec3.subtract(o,i,n);var r=vec3.create();vec3.normalize(r,o);var a=Math.abs(vec3.length(r)),s=Human.math.getBoundaryDiag(e),c=Math.abs(s/1.8/Math.tan(27.5))/a*2.5,l=Human.math.getBoundaryCenter(e);vec3.scale(o,r,c);var u=vec3.add(vec3.create(),l,o);return{eye:pn.fromArray(u),look:pn.fromArray(l),up:{x:0,y:1,z:0}}}},{key:"checkEpsilon",value:function(e){return Math.abs(e)<.001?0:e}}]),e}()).\u0275fac=function(e){return new(e||Pt)(P.Zb(dn))},Pt.\u0275prov=P.Lb({token:Pt,factory:Pt.\u0275fac,providedIn:"root"}),Pt),hn=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];m(this,e),this.zoom=t,this.panX=n,this.panY=i,this.rotateX=o,this.rotateY=r,this.applyFriction=a},fn=h("vkgz"),bn=function e(){m(this,e)},vn=function(e){return e.JPEG="image/jpeg",e.PNG="image/png",e}({}),mn=function(){var e=function e(t){m(this,e),this.patches=t};return e.type="[Story Chapter] Apply Patch",e}(),yn=function(){var e=function e(){m(this,e)};return e.type="[Story Chapter] Next Chapter",e}(),xn=function(){var e=function e(){m(this,e)};return e.type="[Story Chapter] Previous Chapter",e}(),kn=function(){var e=function e(){m(this,e)};return e.type="[Story Chapter] First Chapter",e}(),wn=function(){var e=function e(){m(this,e)};return e.type="[Story Chapter] Last Chapter",e}(),On=function(){var e=function e(t){m(this,e),this.chapter=t};return e.type="[Story Chapter] Select Chapter",e}(),Cn=function(){var e=function e(t){m(this,e),this.chapterId=t};return e.type="[Story Chapter] Select Chapter by chapter id",e}(),Sn=function(){var e=function e(t){m(this,e),this.chapters=t};return e.type="[Story Chapter] Set Chapters",e}(),_n=function(){var e=function e(t,n){m(this,e),this.chapterId=t,this.cameraAction=n};return e.type="[Story Chapter] Set Chapter Camera Action",e}(),jn=function(){var e=function e(t,n){m(this,e),this.chapterId=t,this.ui=n};return e.type="[Story Chapter] Set Chapter UI",e}(),Pn=function(){var e=function e(t,n){m(this,e),this.chapterId=t,this.info=n};return e.type="[Story Chapter] Set Chapter Info",e}(),Mn=function(){var e=function e(t,n){m(this,e),this.chapterId=t,this.legend=n};return e.type="[Story Chapter] Set Chapter Legend",e}(),In=function(){var e=function e(t,n){m(this,e),this.chapterId=t,this.legend=n};return e.type="[Story Chapter] Add To Chapter Legend",e}(),zn=function(){var e=function e(t,n){m(this,e),this.previousIndex=t,this.currentIndex=n};return e.type="[Story Chapter] Reorder Chapters",e}(),Tn=function(){var e=function e(t,n){m(this,e),this.chapterId=t,this.readyState=n};return e.type="[Story Chapter] Set Readystate",e}(),Un=function(){var e=function e(t,n,i){m(this,e),this.chapterId=t,this.effects=n,this.properties=i};return e.type="[Story Chapter] Set Chapter PostProcessing",e}(),Ln=function(){var e=function e(t,n,i){m(this,e),this.chapterId=t,this.transition=n,this.key=i};return e.type="[Story Chapter] Set Chapter Transitions",e}(),Dn=function(){var e=function e(t,n){m(this,e),this.chapterId=t,this.transparencyMode=n};return e.type="[Story Chapter] Set Chapter Transparency Mode",e}(),En=function(){var e=function e(t,n,i,o){m(this,e),this.chapterId=t,this.clips=n,this.enabled=i,this.record=o};return e.type="[Story Chapter] Set Chapter Clipping Planes",e}(),Fn=function(){var e=function e(t,n){m(this,e),this.chapterId=t,this.background=n};return e.type="[Story Chapter] Set Chapter Background",e}(),An=function(){var e=function e(t){m(this,e),this.background=t};return e.type="[Story Chapter] Set All Chapters Background",e}(),Rn=function(){var e=function e(){m(this,e)};return e.type="[Story Chapter] Reset Selected Chapter Background",e}(),Vn=function(){var e=function e(t){m(this,e),this.background=t};return e.type="[Story Chapter] Set Selected Chapter Background",e}(),Nn=function(){var e=function e(t,n){m(this,e),this.chapter=t,this.chapterId=n};return e.type="[Story Chapter] Duplicate An Existing Chapter",e}(),Bn=function(){var e=function e(t){m(this,e),this.chapter=t};return e.type="[Story Chapter] Remove Chapter",e}(),Hn=function(){var e=function e(){m(this,e)};return e.type="[Story Chapter] Reset",e}(),Qn=function(){var e=function e(t){m(this,e),this.thumbnails=t};return e.type="[Story Chapters] Register thumbnail URLs from story",e}(),qn=function(){var e=function e(t,n){m(this,e),this.sourceChapter=t,this.targetChapter=n};return e.type="[Story Chapters] Copy Thumbnail From Chapter",e}(),Wn=((It=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:vn.JPEG,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.92,o=arguments.length>3?arguments[3]:void 0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"original",a=arguments.length>5?arguments[5]:void 0,s=arguments.length>6?arguments[6]:void 0,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:[];m(this,e),this.chapterId=t,this.imageType=n,this.imageQuality=i,this.dimensions=o,this.crop=r,this.includeLabels=a,this.includeCopyright=s,this.layers=c}).type="[Story Chapters] Take picture",It),$n=function(){var e=function e(t,n,i){m(this,e),this.chapterId=t,this.blob=n,this.dimensions=i};return e.type="[Story Chapters] Take picture success",e}(),Kn=function(){var e=function e(t,n){m(this,e),this.chapterId=t,this.camera=n};return e.type="[Story Chapters] Record Camera",e}(),Gn=function(){var e=function e(t,n,i,o){m(this,e),this.chapterId=t,this.index=n,this.position=i,this.record=o};return e.type="[Story Chapters] Set the current visibility layers index and position",e}(),Zn=function(){var e=function e(t,n){m(this,e),this.chapterId=t,this.media=n};return e.type="[Story Chapters] Set the media object",e}(),Jn=function(){var e=function e(t,n){m(this,e),this.chapterId=t,this.contentBlocks=n};return e.type="[Story Chapters] Set the content blocks",e}(),Xn=function(e){return e.Default="default",e.Plus="plus",e.Minus="minus",e.PlusMinus="plusMinus",e.Sequential="sequential",e.None="None",e}({}),Yn=function(e){return e.Annotation="annotation",e.Classic="classic",e.StudioNext="studioNext",e.Context="context",e}({}),ei=function(e){return e.Alphabetical="alphabetical",e.Numerical="numerical",e}({}),ti=function e(t){m(this,e),this.pinType=Xn.PlusMinus,this.sequentialType=ei.Alphabetical,this.theme=Yn.StudioNext,this.expandTag=!0,this.showDescription=!0,this.collapseDescription=!1,this.pinGlow=!1,this.hideWire=!1,this.hideTag=!1,this.title=t},ni=function e(){m(this,e)},ii=function e(){m(this,e)},oi=function(e,t){var n=c(e);return t.forEach((function(e){n.push(void 0!==e?Number(e):1)})),n},ri=function(e){var t=/rgba?\((\d{1,3})\,\s*(\d{1,3})\,\s*(\d{1,3})\,?\s*(\d+\.\d{0,5})?\)/g,n=[],i=t.exec(e),o=t.exec(e);return n=oi(n,i.slice(1,5)),n=oi(n,o.slice(1,5))},ai=function(){function e(t,n,i){m(this,e),this.colors=t,this.gradientType=n,this.colorStops=i}return v(e,null,[{key:"equals",value:function(e,t){return e.gradientType===t.gradientType&&e.colors.length===t.colors.length&&e.colors.every((function(e,n){return e===t.colors[n]}))&&e.colorStops.length===t.colorStops.length&&e.colorStops.every((function(e,n){return e===t.colorStops[n]}))}},{key:"deserialize",value:function(t){if(!Object.keys(t).length)return null;var n=[];"string"==typeof t.colors?n=ri(t.colors):Array.isArray(t.colors)&&8===t.colors.length&&(n=t.colors.map((function(e,t){return(t+1)%4&&e<=1?Math.round(255*e):e})));var i=/radial|linear/.test(t.gradientType)?t.gradientType:"radial",o=t.colorStops;return new e(n,i,Array.isArray(o)&&2===o.length?[o[0],o[1]]:[0,100])}},{key:"toCSS",value:function(e){var t=e.colors,n="rgba(".concat(t[0],",").concat(t[1],", ").concat(t[2],", ").concat(t[3],") ").concat(e.colorStops[0],"%"),i="rgba(".concat(t[4],",").concat(t[5],", ").concat(t[6],", ").concat(t[7],") ").concat(e.colorStops[1],"%");return"radial"===e.gradientType?"radial-gradient(circle, ".concat(n,", ").concat(i,")"):"linear-gradient(180deg, ".concat(n,", ").concat(i,")")}},{key:"fromCSS",value:function(t){var n=/radial-gradient/.test(t)?"radial":"linear",i=ri(t),o=/([0-9]+)\%/g,r=[0,100];return r[0]=Number(o.exec(t)[1]),r[1]=Number(o.exec(t)[1]),new e(i,n,r)}},{key:"isTransparent",value:function(e){if(!e||!e.colors)return!1;var t=e.colors,n=t[3];return t.length<=4?0===n:0===n&&0===t[7]}}]),e}(),si=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},ci=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},li=function e(){m(this,e),this[zt]=!0};zt=immer.immerable,si([Object(te.Type)((function(){return ti})),Object(te.Type)((function(){return ni})),Object(te.Type)((function(){return Lt})),Object(te.Type)((function(){return ii})),Object(te.Expose)(),ci("design:type",String)],li.prototype,"id",void 0),si([Object(te.Expose)(),ci("design:type",Object)],li.prototype,"info",void 0),si([Object(te.Expose)(),ci("design:type",Array)],li.prototype,"labels",void 0),si([Object(te.Expose)(),ci("design:type",Object)],li.prototype,"colorRecipeObjects",void 0),si([Object(te.Expose)(),ci("design:type",Array)],li.prototype,"hotspots",void 0),si([Object(te.Expose)(),ci("design:type",ni)],li.prototype,"synchronization",void 0),si([Object(te.Expose)(),ci("design:type",ai)],li.prototype,"background",void 0),si([Object(te.Expose)(),ci("design:type",Object)],li.prototype,"lights",void 0),si([Object(te.Expose)(),ci("design:type",Array)],li.prototype,"timelineMap",void 0),si([Object(te.Expose)(),ci("design:type",Object)],li.prototype,"camera",void 0),si([Object(te.Expose)(),ci("design:type",Object)],li.prototype,"transitions",void 0),si([Object(te.Expose)(),ci("design:type",Object)],li.prototype,"properties",void 0),si([Object(te.Expose)(),ci("design:type",Boolean)],li.prototype,"loop",void 0),si([Object(te.Expose)(),ci("design:type",Object)],li.prototype,"customData",void 0),si([Object(te.Expose)(),ci("design:type",Object)],li.prototype,"clippingPlanes",void 0),si([Object(te.Expose)(),ci("design:type",function(){return function e(){m(this,e)}}())],li.prototype,"ui",void 0),si([Object(te.Expose)(),ci("design:type",ii)],li.prototype,"graph",void 0),si([Object(te.Expose)(),ci("design:type",Object)],li.prototype,"viewModes",void 0),si([Object(te.Expose)(),ci("design:type",Object)],li.prototype,"recipes",void 0),si([Object(te.Expose)(),ci("design:type",String)],li.prototype,"transparencyMode",void 0),si([Object(te.Expose)(),ci("design:type",Object)],li.prototype,"fallbackTransparency",void 0),si([Object(te.Expose)(),ci("design:type",Object)],li.prototype,"effects",void 0),si([Object(te.Expose)(),ci("design:type",Object)],li.prototype,"environment",void 0),si([Object(te.Expose)(),ci("design:type",Object)],li.prototype,"pickThroughObjects",void 0),si([Object(te.Expose)(),ci("design:type",Object)],li.prototype,"showObjects",void 0),si([Object(te.Expose)(),ci("design:type",Object)],li.prototype,"options",void 0),si([Object(te.Expose)(),ci("design:type",Object)],li.prototype,"media",void 0),si([Object(te.Expose)(),ci("design:type",Array)],li.prototype,"legend",void 0),si([Object(te.Expose)(),ci("design:type",function(){return function e(){m(this,e)}}())],li.prototype,"visibilityLayers",void 0),si([Object(te.Expose)(),ci("design:type",Array)],li.prototype,"contentBlocks",void 0),si([Object(te.Expose)(),ci("design:type",Array)],li.prototype,"quizQuestions",void 0),li=si([Object(te.Exclude)()],li),function(e){function t(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}e.getUuid=t,e.idWithPrefix=function(e){return e?"".concat(e,"-").concat(t()):t()}}(Tt||(Tt={}));var ui,pi,di,gi=function e(){m(this,e)},hi=function(e){return e.classicAnnotation="classic-annotation",e.classicHotspot="classic-hotspot",e.studioNext="studio-light",e}({}),fi=function e(){m(this,e),this.title=null,this.description=null,this.errands=[]},bi=function(e){return e.flyToChapter="flyToChapter",e.flyToObject="flyToObject",e.flyToCamera="flyToCamera",e}({}),vi=function e(t){m(this,e),this.type=bi.flyToObject,this.value=t},mi=function e(t){m(this,e),this.type=bi.flyToCamera,this.value=t},yi=function(e){return e.Circle="circle",e.CirclePlus="circle-plus",e.CircleMinus="circle-minus",e.Label="label",e.CircleLabel="circle-label",e}({}),xi=function e(){m(this,e),this.type=bi.flyToChapter,this.value=null},ki={flyToCamera:"flyTo",flyToChapter:"flyTo"},wi=((ui=function(){function e(t){var n=this;m(this,e),this.engineService=t,this.convertActionToErrand=function(e,t,n){var i=new RegExp("^flyTo(Async)?"),o=new RegExp("^flyToObject(Async)?"),r=new RegExp("^flyTo[w.:]+currentChapter.[flyTo|jumpTo]"),a=n.split(":").slice(0,2),s=e,c=a[1];/currentChapter/.test(c)&&(c=c.replace("currentChapter","chapters[".concat(t,"]")));var l=null;return o.test(a[0])?l=new vi(Object(Se.get)(s,c)):i.test(a[0])?l=new mi(Object(Se.get)(s,c)):r.test(a[0])&&(l=new xi),l},this.convertErrandToAction=function(e,t){var i=Tt.idWithPrefix("errand").replace(/\-/g,"_"),o={},r="",a=function(e){return ki[e]||e}(t.type);return t.type===bi.flyToChapter?r="".concat(a,"Async:currentChapter.").concat(n.engineService.getChapter(e.chapterId).camera.action):(r="".concat(a,"Async:currentChapter.customData.").concat(i),o[i]=t.value),{action:r,data:o}}}return v(e,[{key:"filterHotspot",value:function(e,t,n){var i=new RegExp("^(flyTo|flyToObject|hideHotspot|showHotspot|resetHotspots)"),o=this.getHotspotAction(e,n),r=o.filter((function(e){return i.test(e)}));return o.length===r.length}},{key:"deserializeAnnotation",value:function(e,t,n){var i=new ti(e.title||"");return i.id=e.annotationId||Tt.idWithPrefix("label"),i.chapterId=t.id,i.expandTag=!0,i.showDescription=!0,i.collapseDescription=!1,i.pinGlow=!1,i.hideWire=!1,i.hideTag=!1,n===Yn.Annotation?(i.theme=Yn.Annotation,i.pinType=Xn.Default,i.flyTo=!1,i.states=[]):(i.theme=Yn.StudioNext,i.pinType=Xn.PlusMinus,i.flyTo=!0,i.states=[new fi,new fi],i.states[0].errands=[new xi],i.states[1].errands=[new vi(e.objectId)]),i.occludable=!1!==e.occludable,i.renderableIndex=e.renderableIndex||0,e.objectId&&e.hasOwnProperty("barycentric")?(i.objectId=e.objectId,i.primitiveIndex=e.primitiveIndex,i.barycentric=e.barycentric):e.hasOwnProperty("pos")&&(e.hasOwnProperty("objectId")&&(i.objectId=e.objectId),i.pos=e.pos),e.dir&&Array.isArray(e.dir)?i.dir=e.dir:e.dir&&e.dir instanceof Object&&(i.dir=Object.values(e.dir)),i.description=e.description||"",i.offset=e.labelOffset||[40,40],i.shown=!1!==e.shown,i.labelShown=!1!==e.labelShown,i}},{key:"deserializeHotspots",value:function(e,t,n){for(var i=this,o=arguments.length,r=new Array(o>3?o-3:0),a=3;a<o;a++)r[a-3]=arguments[a];var s=r[0],c=r[1],l=new ti(s.title||"");switch(l.id=Tt.idWithPrefix("hotspot"),l.objectId=s.objectId,l.chapterId=t.id,l.description=s.description||"",l.pinType=/plus|minus/.test(s.className)?Xn.PlusMinus:/sequential/.test(s.className)?Xn.Sequential:/none/.test(s.className)?Xn.None:Xn.Default,/alphabetical/.test(s.className)?l.sequentialType=ei.Alphabetical:/numerical/.test(s.className)&&(l.sequentialType=ei.Numerical),l.pinGlow=/pulse/.test(s.className),l.occludable=!0,l.shown=s.shown,l.offset=s.labelOffset?s.labelOffset:[22,-17],(/left/.test(s.className)&&l.offset[0]>0||/right/.test(s.className)&&l.offset[0]<0)&&(l.offset[0]*=-1),s.hasOwnProperty("barycentric")?(l.renderableIndex=s.renderableIndex||0,l.barycentric=s.barycentric,l.primitiveIndex=s.primitiveIndex):l.pos=s.pos,l.dir=s.dir,s.theme=s.theme?s.theme:hi.classicHotspot,s.theme){case hi.classicAnnotation:l.theme=Yn.Annotation,l.showDescription=!0,l.collapseDescription=/collapsible/g.test(s.className),l.expandTag=!0,l.hideTag=!1,l.hideWire=!/leader-line/.test(s.className);break;case hi.classicHotspot:l.theme=Yn.Classic,l.showDescription=/label/.test(s.className),l.expandTag=/label/.test(s.className),l.hideTag=!l.expandTag,l.collapseDescription=!1,l.hideWire=!/leader-line/.test(s.className);break;case hi.studioNext:l.theme=Yn.StudioNext,l.showDescription=this.hasContent(s),l.collapseDescription=/collapsible/g.test(s.className),l.hideTag=!s.title,l.hideWire=!/leader-line/.test(s.className)}l.flyTo=!1,l.flyToTarget=null,l.states=[];var u=this.filterHotspotActions(this.getHotspotAction(e,s)),p=c?this.filterHotspotActions(this.getHotspotAction(e,c)):[],d=new fi,g=new fi;u.length&&(d.errands=u.map((function(t){return i.convertActionToErrand(e,n,t)}))),p.length&&(g.errands=p.map((function(t){return i.convertActionToErrand(e,n,t)}))),l.states=[g,d],d.errands.length>0&&(l.flyTo=!0,l.flyToTarget=d.errands[0].type,d.errands[0].type===bi.flyToCamera&&(l.cameraPosition=d.errands[0].value));var h=s.contentBlocks;return h&&(l.contentBlocks=JSON.parse(JSON.stringify(h))),l}},{key:"makeDefaultStudioLabel",value:function(e){var t=e?Object.assign({},e):new ti("");return t.pinType=Xn.PlusMinus,t.theme=Yn.StudioNext,t.expandTag=!0,t.showDescription=!0,t.collapseDescription=!1,t.pinGlow=!1,t.hideWire=!1,t.hideTag=!1,t.occludable=!0,t.flyTo=!0,t.description="",t.shown=!0,t.states=[new fi,new fi],t}},{key:"makeAnnotationLabel",value:function(e){var t=e?Object.assign({},e):new ti("");return t.pinType=Xn.Default,t.theme=Yn.Annotation,t.expandTag=!0,t.showDescription=!0,t.collapseDescription=!1,t.pinGlow=!1,t.hideWire=!1,t.hideTag=!1,t.states=[],t}},{key:"serializeLabel",value:function(e,t){var n=this,i=new gi,o=Object(te.classToClass)(e),r=["circle","draggable"];i.shown=!0,e.objectId&&(i.objectId=o.objectId);try{e.primitiveIndex&&e.barycentric&&e.objectId?(i.renderableIndex=e.renderableIndex||0,i.primitiveIndex=e.primitiveIndex,i.barycentric=e.barycentric,i.pos=this.engineService.barycentricToWorld(e.objectId,e.primitiveIndex,e.barycentric)):i.pos=o.pos}catch(u){return{data:{},hotspots:[]}}switch(e.dir&&(i.dir=Array.prototype.slice.call(e.dir)),i.labelOffset=e.offset,e.theme){case Yn.Annotation:i.theme=hi.classicAnnotation;break;case Yn.Classic:i.theme=hi.classicHotspot;break;default:i.theme=hi.studioNext}""!==o.title?(i.title=o.title,i.description=o.description,i.type=yi.CircleLabel):i.type=yi.Circle,e.pinGlow&&r.push("pulse"),e.pinType===Xn.PlusMinus&&r.push("plus"),e.pinType===Xn.Sequential&&(r.push("sequential"),r.push(e.sequentialType===ei.Alphabetical?"alphabetical":"numerical")),e.pinType===Xn.None&&r.push("none"),e.hideWire||r.push("leader-line"),e.hideTag||r.push("label"),e.collapseDescription&&r.push("collapsible collapsed"),i.className=r.join(" ");var a={};i.actions=[];var s=[i],c=e.states.length;e.states.forEach((function(t,o){if(o===c-1)s[0].actions.push("resetHotspots"),t.errands.forEach((function(t){var i=n.convertErrandToAction(e,t);s[0].actions.push(i.action),a=Object.assign(Object.assign({},a),i.data)}));else{var r=Object(te.classToClass)(i);r.actions=[],r.className=r.className.replace("plus","minus"),t.errands.forEach((function(t){var i=n.convertErrandToAction(e,t);r.actions.push(i.action),a=Object.assign(Object.assign({},a),i.data)})),s.push(r)}})),2===s.length&&(s[0].actions.push("hideHotspots:currentChapter.hotspots[".concat(t,"]")),s[0].actions.push("showHotspots:currentChapter.hotspots[".concat(t+1,"]")),s[1].actions.push("hideHotspots:currentChapter.hotspots[".concat(t+1,"]")),s[1].actions.push("showHotspots:currentChapter.hotspots[".concat(t,"]")),s[0].shown=!0,s[1].shown=!1),2===s.length&&e.collapseDescription&&(s[1].className+=s[1].className.replace("collapsed","")),s.forEach((function(e){i.labelOffset[0]<0?e.className=e.className.replace("right","")+" left":i.labelOffset[0]>0&&(e.className=e.className.replace("left","")+" right")}));var l=e.contentBlocks;return l&&(i.contentBlocks=JSON.parse(JSON.stringify(l))),{data:a,hotspots:s}}},{key:"setLabelContainer",value:function(e){this._labelContainer=e}},{key:"getLabelContainer",value:function(){return this._labelContainer}},{key:"hasContent",value:function(e){var t=e.description,n=e.contentBlocks;return!!t||!Object(Se.isNil)(n)&&n.length>0}},{key:"getHotspotAction",value:function(e,t){var n=t.actionSrc?Object(Se.get)(e,t.actionSrc):t.actions?t.actions:[];return Array.isArray(n)?n:[]}},{key:"filterHotspotActions",value:function(e){var t=new RegExp("^(flyTo|flyToObject)");return e.filter((function(e){return t.test(e)}))}}]),e}()).\u0275fac=function(e){return new(e||ui)(P.Zb(Nt))},ui.\u0275prov=P.Lb({token:ui,factory:ui.\u0275fac,providedIn:"root"}),ui),Oi=function e(){m(this,e)};function Ci(e,t,n,i){(function e(t,n){var i=n.objects;return 0===i.length?[]:Object(Se.flattenDeep)(i.map((function(n){return[n.objectId].concat(c(e(t,t.scene.objects[n.objectId])))})))})(Human,Human.scene.objects[e]).forEach((function(e){return t[e][n]=i}))}function Si(e,t){if(void 0!==e.activeChapterId&&void 0!==e.nodeState){var n=immer.produceWithPatches(e,(function(e){var n=e.nodeState[e.activeChapterId],i=t.objectIds||Object.keys(n);t.patch?Object.entries(t.patch).forEach((function(e){var t=p(e,2),i=t[0],o=t[1];n[i].shown=o})):i.forEach((function(e){n[e].shown=t.show,n[e].shownSetByTween=t.setByTween,t.objectIds&&(Ci(e,n,"shown",t.show),!0===t.setByTween&&Ci(e,n,"shownSetByTween",t.setByTween))}))})),i=p(n,3),o=i[0],r=i[1],a=i[2];return{finalState:immer.produce(o,(function(e){var t;e.patches=r,(t=e.patchesForChapter[e.activeChapterId]).push.apply(t,c(r))})),patches:r,inversePatches:a}}}!function(e){var t=function e(){m(this,e)};t.type="[Engine Nodes] Reset",e.Reset=t;var n=function e(t){m(this,e),this.nodeState=t};n.type="[Engine Nodes] init nodes",e.InitNodeState=n;var i=function e(t){m(this,e),this.patches=t};i.type="[Engine Nodes] patch nodes",e.ApplyPatch=i;var o=function e(t){m(this,e),this.activeChapterId=t};o.type="[Engine Nodes] set active chapter",e.SetActiveChapter=o;var r=function e(t,n){m(this,e),this.originalChapterId=t,this.copyChapterId=n};r.type="[Engine Nodes] Duplicate node state",e.DuplicateNodeState=r;var a=function e(t,n,i){var o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];m(this,e),this.show=t,this.objectIds=n,this.patch=i,this.record=o,this.setByTween=r};a.type="[Engine Nodes] update nodes shown",e.UpdateNodesShown=a;var s=function e(t){m(this,e),this.objectId=t};s.type="[Engine Nodes] update nodes selected",e.UpdateNodeSelected=s;var c=function e(t,n,i){m(this,e),this.checked=t,this.objectIds=n,this.patch=i};c.type="[Engine Nodes] update nodes checked",e.UpdateNodesChecked=c;var l=function e(t,n,i){m(this,e),this.pickable=t,this.objectIds=n,this.patch=i};l.type="[Engine Nodes] update nodes pickable",e.UpdateNodesPickable=l;var u=function e(t,n,i){var o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];m(this,e),this.recipe=t,this.objectIds=n,this.patch=i,this.record=o};u.type="[Engine Nodes] update nodes paint",e.UpdateNodesPaint=u}(pi||(pi={})),function(e){var t=function e(){m(this,e)};t.type="[Undo] Reset",e.Reset=t;var n=function e(t){m(this,e),this.chapterId=t};n.type="[Undo] Undo",e.Undo=n;var i=function e(t){m(this,e),this.chapterId=t};i.type="[Undo] Undo All",e.UndoAll=i;var o=function e(t){m(this,e),this.chapterId=t};o.type="[Undo] Redo",e.Redo=o;var r=function e(t){m(this,e),this.patches=t};r.type="[Undo] Store Patches",e.SavePatches=r}(di||(di={}));var _i=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{center:[0,0,0],edge:[1,1,1],centerBias:1,edgeBias:0,power:1};m(this,e);var n=t.edge,i=t.center,o=t.centerBias,r=t.edgeBias,a=t.power;this.edge=n,this.center=i,this.centerBias=o,this.edgeBias=r,this.power=a}return v(e,null,[{key:"toEngine",value:function(e){var t=e.center,n=e.edge,i=e.centerBias,o=e.edgeBias,r=e.power;return[c(t),c(n),i,o,r]}}]),e}(),ji=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{center:0,edge:1,centerBias:1,edgeBias:0,power:1};m(this,e);var n=t.edge,i=t.center,o=t.centerBias,r=t.edgeBias,a=t.power;this.edge=n,this.center=i,this.centerBias=o,this.edgeBias=r,this.power=a}return v(e,null,[{key:"toEngine",value:function(e){return[e.center,e.edge,e.centerBias,e.edgeBias,e.power]}}]),e}();function Pi(e,t){switch(!0){case void 0===e[t]:return;case!1===e[t]:return!1;case"number"==typeof e[t]:return 100*e[t];default:return new ji({center:e[t][0],edge:e[t][1],centerBias:e[t][2],edgeBias:e[t][3],power:e[t][4]})}}var Mi,Ii,zi,Ti,Ui,Li=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};m(this,e);var n=t.tintColor,i=t.saturation,o=t.contrast,r=t.brightness,a=t.opacity;this.tintColor=n,this.saturation=i,this.contrast=o,this.brightness=r,this.opacity=a}return v(e,null,[{key:"fromEngine",value:function(t){return new e({tintColor:function(){switch(!0){case void 0===t.tintColor:return;case!1===t.tintColor:return!1;case Array.isArray(t.tintColor):return 3===t.tintColor.length?c(t.tintColor):new _i({center:t.tintColor[0],edge:t.tintColor[1],centerBias:t.tintColor[2],edgeBias:t.tintColor[3],power:t.tintColor[4]})}}(),saturation:Pi(t,"saturation"),brightness:Pi(t,"brightness"),contrast:Pi(t,"contrast"),opacity:Pi(t,"opacity")})}},{key:"toEngine",value:function(e){var t=!1!==e.tintColor&&void 0,n=!1!==e.saturation&&void 0,i=!1!==e.brightness&&void 0,o=!1!==e.contrast&&void 0,r=!1!==e.opacity&&void 0;return Array.isArray(e.tintColor)?t=c(e.tintColor):e.tintColor&&e.tintColor instanceof _i&&(t=_i.toEngine(e.tintColor)),"number"==typeof e.saturation?n=e.saturation/100:e.saturation instanceof ji&&(n=ji.toEngine(e.saturation)),"number"==typeof e.brightness?i=e.brightness/100:e.brightness instanceof ji&&(i=ji.toEngine(e.brightness)),"number"==typeof e.contrast?o=e.contrast/100:e.contrast instanceof ji&&(o=ji.toEngine(e.contrast)),"number"==typeof e.opacity?r=e.opacity/100:e.opacity instanceof ji&&(r=ji.toEngine(e.opacity)),{tintColor:t,saturation:n,brightness:i,contrast:o,opacity:r}}},{key:"mergeRecipes",value:function(e,t){for(var n=Object.assign({},e),i=0,o=Object.entries(t);i<o.length;i++){var r=p(o[i],2),a=r[0],s=r[1];void 0!==s&&(n[a]=s)}return n}}]),e}(),Di=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},Ei=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Fi={activeChapterId:void 0,nodeState:void 0,patches:[],patchesForChapter:{}},Ai=((Ii=Mi=function(){function e(){m(this,e)}return v(e,[{key:"reset",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){e.activeChapterId=void 0,e.nodeState=void 0,e.patches=[],e.patchesForChapter={}})))}},{key:"applyPatch",value:function(e,t){var n=immer.applyPatches(e.getState(),t.patches),i=immer.produce(n,(function(e){var n;(n=e.patchesForChapter[e.activeChapterId]).push.apply(n,c(t.patches)),e.patches=t.patches}));e.patchState(i)}},{key:"initNodeState",value:function(e,t){e.patchState({nodeState:t.nodeState})}},{key:"setActiveChapter",value:function(e,t){var n=e.getState(),i=immer.produce(n,(function(e){e.activeChapterId=t.activeChapterId,e.patchesForChapter[t.activeChapterId]=e.patchesForChapter[t.activeChapterId]||[],e.patches=e.patchesForChapter[t.activeChapterId]}));e.patchState(i)}},{key:"duplicateNodeState",value:function(e,t){var n=e.getState(),i=immer.produce(n,(function(e){e.nodeState[t.copyChapterId]=e.nodeState[t.originalChapterId],e.patchesForChapter[t.copyChapterId]=e.patchesForChapter[t.originalChapterId].map((function(e){return e.path[1]=t.copyChapterId,e}))}));e.patchState(i)}},{key:"updateNodesShown",value:function(e,t){var n=Si(e.getState(),t),i=n.finalState,o=n.patches,r=n.inversePatches;e.patchState(i),t.record&&e.dispatch(new di.SavePatches([{forward:o,inverse:r,patchAction:pi.ApplyPatch}]))}},{key:"updateNodesSelected",value:function(e,t){var n=e.getState(),i=immer.produce(n,(function(e){var n=e.nodeState[e.activeChapterId],i=Object.keys(n);switch(t.objectId){case void 0:i.forEach((function(e){return n[e].selected=!1}));break;default:i.forEach((function(e){return n[e].selected=!1})),n[t.objectId].selected=!0}}));e.patchState(i)}},{key:"updateNodesChecked",value:function(e,t){var n=e.getState(),i=immer.produceWithPatches(n,(function(e){var n=e.nodeState[e.activeChapterId];switch(t.patch){case void 0:(t.objectIds||Object.keys(n)).forEach((function(e){n[e].checked=t.checked,t.objectIds&&Ci(e,n,"checked",t.checked)}));break;default:Object.entries(t.patch).forEach((function(e){var t=p(e,2),i=t[0],o=t[1];return n[i].checked=o}))}})),o=p(i,3),r=o[0],a=o[1],s=(o[2],immer.produce(r,(function(e){e.patches=a})));e.patchState(s)}},{key:"updateNodesPickable",value:function(e,t){var n=e.getState(),i=immer.produceWithPatches(n,(function(e){var n=e.nodeState[e.activeChapterId];t.patch?Object.entries(t.patch).forEach((function(e){var t=p(e,2),i=t[0],o=t[1];return n[i].pickable=o})):(t.objectIds||Object.keys(n)).forEach((function(e){n[e].pickable=t.pickable,t.objectIds&&Ci(e,n,"pickable",t.pickable)}))})),o=p(i,3),r=o[0],a=o[1],s=o[2],l=immer.produce(r,(function(e){var t;e.patches=a,(t=e.patchesForChapter[e.activeChapterId]).push.apply(t,c(a))}));e.patchState(l),e.dispatch(new di.SavePatches([{forward:a,inverse:s,patchAction:pi.ApplyPatch}]))}},{key:"updateNodesPaint",value:function(e,t){var n=e.getState(),i=immer.produceWithPatches(n,(function(e){var n=e.nodeState[e.activeChapterId],i=t.objectIds||Object.keys(n);t.patch?Object.entries(t.patch).forEach((function(e){var t=p(e,2),i=t[0],o=t[1],r=Li.mergeRecipes(n[i].paint,o);n[i].paint=r})):i.forEach((function(e){var i=Li.mergeRecipes(n[e].paint,t.recipe);n[e].paint=i,t.objectIds&&Ci(e,n,"paint",i)}))})),o=p(i,3),r=o[0],a=o[1],s=o[2],l=immer.produce(r,(function(e){var t;e.patches=a,(t=e.patchesForChapter[e.activeChapterId]).push.apply(t,c(a))}));e.patchState(l),t.record&&e.dispatch(new di.SavePatches([{forward:a,inverse:s,patchAction:pi.ApplyPatch}]))}}],[{key:"getAllNodeState",value:function(e){return e.nodeState}},{key:"getActiveChapter",value:function(e){return e.activeChapterId}},{key:"getPatches",value:function(e){return e.patches}},{key:"getNodes",value:function(e){return void 0===e.activeChapterId||void 0===e.nodeState?{}:e.nodeState[e.activeChapterId]||{}}},{key:"getNodePaint",value:function(e){return function(t){return e.nodeState[e.activeChapterId][t].paint}}},{key:"getNodeIds",value:function(e){return Object.keys(Mi.getNodes(e))}},{key:"getCheckedNodeIds",value:function(e){return Object.values(Mi.getNodes(e)).filter((function(e){return e.checked})).map((function(e){return e.objectId}))}},{key:"getCheckedNodes",value:function(e){return Mi.getCheckedNodeIds(e).map((function(t){return e.nodeState[e.activeChapterId][t]}))}},{key:"getUncheckedNodeIds",value:function(e){return Mi.getNodeIds(e).filter((function(t){return!e.nodeState[e.activeChapterId][t].checked}))}},{key:"getSelectedNode",value:function(e){var t=Mi.getNodeIds(e).find((function(t){return e.nodeState[e.activeChapterId][t].selected}));return t?e.nodeState[e.activeChapterId][t]:void 0}}]),e}()).\u0275fac=function(e){return new(e||Ii)},Ii.\u0275prov=P.Lb({token:Ii,factory:Ii.\u0275fac}),Di([Object(E.a)(pi.Reset),Ei("design:type",Function),Ei("design:paramtypes",[Object,pi.Reset]),Ei("design:returntype",void 0)],Ii.prototype,"reset",null),Di([Object(E.a)(pi.ApplyPatch),Ei("design:type",Function),Ei("design:paramtypes",[Object,pi.ApplyPatch]),Ei("design:returntype",void 0)],Ii.prototype,"applyPatch",null),Di([Object(E.a)(pi.InitNodeState),Ei("design:type",Function),Ei("design:paramtypes",[Object,pi.InitNodeState]),Ei("design:returntype",void 0)],Ii.prototype,"initNodeState",null),Di([Object(E.a)(pi.SetActiveChapter),Ei("design:type",Function),Ei("design:paramtypes",[Object,pi.SetActiveChapter]),Ei("design:returntype",void 0)],Ii.prototype,"setActiveChapter",null),Di([Object(E.a)(pi.DuplicateNodeState),Ei("design:type",Function),Ei("design:paramtypes",[Object,pi.DuplicateNodeState]),Ei("design:returntype",void 0)],Ii.prototype,"duplicateNodeState",null),Di([Object(E.a)(pi.UpdateNodesShown),Ei("design:type",Function),Ei("design:paramtypes",[Object,pi.UpdateNodesShown]),Ei("design:returntype",void 0)],Ii.prototype,"updateNodesShown",null),Di([Object(E.a)(pi.UpdateNodeSelected),Ei("design:type",Function),Ei("design:paramtypes",[Object,pi.UpdateNodeSelected]),Ei("design:returntype",void 0)],Ii.prototype,"updateNodesSelected",null),Di([Object(E.a)(pi.UpdateNodesChecked),Ei("design:type",Function),Ei("design:paramtypes",[Object,pi.UpdateNodesChecked]),Ei("design:returntype",void 0)],Ii.prototype,"updateNodesChecked",null),Di([Object(E.a)(pi.UpdateNodesPickable),Ei("design:type",Function),Ei("design:paramtypes",[Object,pi.UpdateNodesPickable]),Ei("design:returntype",void 0)],Ii.prototype,"updateNodesPickable",null),Di([Object(E.a)(pi.UpdateNodesPaint),Ei("design:type",Function),Ei("design:paramtypes",[Object,pi.UpdateNodesPaint]),Ei("design:returntype",void 0)],Ii.prototype,"updateNodesPaint",null),Di([Object(E.e)(),Ei("design:type",Function),Ei("design:paramtypes",[Oi]),Ei("design:returntype",void 0)],Ii,"getAllNodeState",null),Di([Object(E.e)(),Ei("design:type",Function),Ei("design:paramtypes",[Oi]),Ei("design:returntype",void 0)],Ii,"getActiveChapter",null),Di([Object(E.e)(),Ei("design:type",Function),Ei("design:paramtypes",[Oi]),Ei("design:returntype",void 0)],Ii,"getPatches",null),Di([Object(E.e)(),Ei("design:type",Function),Ei("design:paramtypes",[Oi]),Ei("design:returntype",void 0)],Ii,"getNodes",null),Di([Object(E.e)(),Ei("design:type",Function),Ei("design:paramtypes",[Oi]),Ei("design:returntype",void 0)],Ii,"getNodePaint",null),Di([Object(E.e)(),Ei("design:type",Function),Ei("design:paramtypes",[Oi]),Ei("design:returntype",void 0)],Ii,"getNodeIds",null),Di([Object(E.e)(),Ei("design:type",Function),Ei("design:paramtypes",[Oi]),Ei("design:returntype",void 0)],Ii,"getCheckedNodeIds",null),Di([Object(E.e)(),Ei("design:type",Function),Ei("design:paramtypes",[Oi]),Ei("design:returntype",void 0)],Ii,"getCheckedNodes",null),Di([Object(E.e)(),Ei("design:type",Function),Ei("design:paramtypes",[Oi]),Ei("design:returntype",void 0)],Ii,"getUncheckedNodeIds",null),Di([Object(E.e)(),Ei("design:type",Function),Ei("design:paramtypes",[Oi]),Ei("design:returntype",void 0)],Ii,"getSelectedNode",null),Ii=Mi=Di([Object(E.f)({name:"engineNodes",defaults:Fi})],Ii)),Ri=function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"_color",o=arguments.length>3?arguments[3]:void 0;m(this,e),this.label=t,this.recipe=n,this.icon=i,this.group=o},Vi=function(e){return e.Colors="Colors",e.Effects="Effects",e}({}),Ni=function(e){return e.Colors="_color",e.Effects="adjust",e}({}),Bi=new Ri("Original",new Li({tintColor:!1,saturation:!1,contrast:!1,brightness:!1,opacity:!1}),"times-circle",Vi.Colors),Hi=new Ri("Black",{tintColor:[0,0,0],saturation:!1,contrast:!1,brightness:!1,opacity:!1},Ni.Colors,Vi.Colors),Qi=new Ri("Red",{tintColor:[1,0,0],saturation:!1,contrast:!1,brightness:!1,opacity:!1},Ni.Colors,Vi.Colors),qi=new Ri("Yellow",new Li({tintColor:[1,1,0],saturation:!1,contrast:!1,brightness:!1,opacity:!1}),Ni.Colors,Vi.Colors),Wi=new Ri("Green",new Li({tintColor:[0,1,0],saturation:!1,contrast:!1,brightness:!1,opacity:!1}),Ni.Colors,Vi.Colors),$i=new Ri("Cyan",new Li({tintColor:[0,1,1],saturation:!1,contrast:!1,brightness:!1,opacity:!1}),Ni.Colors,Vi.Colors),Ki=new Ri("Blue",new Li({tintColor:[0,0,1],saturation:!1,contrast:!1,brightness:!1,opacity:!1}),Ni.Colors,Vi.Colors),Gi=new Ri("Pink",new Li({tintColor:[1,0,1],saturation:!1,contrast:!1,brightness:!1,opacity:!1}),Ni.Colors,Vi.Colors),Zi=(new Ri("Grayscale",new Li({tintColor:!1,saturation:-100,contrast:!1,brightness:!1,opacity:!1}),Ni.Effects,Vi.Effects),new Ri("Desaturated",new Li({tintColor:!1,saturation:-50,contrast:!1,brightness:!1,opacity:!1}),Ni.Effects,Vi.Effects),new Ri("Fade",new Li({tintColor:[0,0,0],contrast:!1,brightness:55,saturation:-100,opacity:new ji({edge:1,center:0,edgeBias:0,centerBias:1,power:1})}),Ni.Effects,Vi.Effects)),Ji=[Hi,Qi,qi,Wi,$i,Ki,Gi],Xi=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};m(this,e);var n=t.tintColor,i=t.saturation,o=t.contrast,r=t.brightness,a=t.opacity;this.tintColor=n,this.saturation=i,this.contrast=o,this.brightness=r,this.opacity=a}return v(e,null,[{key:"isFresnel",value:function(e){return Array.isArray(e)&&5===e.length}},{key:"isColor",value:function(e){return Array.isArray(e)&&3===e.length}}]),e}();function Yi(e,t,n){var i=ke.getSuccessors(e,t);if(0===i.length)return!1;var o,r=s(i);try{for(r.s();!(o=r.n()).done;){var a=o.value;if(!0===n[a])return!0}}catch(c){r.e(c)}finally{r.f()}return i.some((function(t){return Yi(e,t,n)}))}function eo(e,t,n){switch(n[t]){case!0:return!0;case!1:return!1;case void 0:var i=ke.getAncestor(e,t);return!!i&&eo(e,i,n)}}!function(e){var t=function e(t,n,i){m(this,e),this.particleSystems=t,this.assignedParticles=n,this.tweenParticleLookup=i};t.type="[Engine Particles] Set Particle State",e.SetParticleState=t;var n=function e(t,n){m(this,e),this.particleSystem=t,this.chapterId=n};n.type="[Engine Particles] New Particle System",e.NewParticleSystem=n;var i=function e(t,n){m(this,e),this.id=t,this.targetChapterId=n};i.type="[Engine Particles] Duplicate Particle System",e.DuplicateParticleSystem=i;var o=function e(t,n){m(this,e),this.id=t,this.targetChapterId=n};o.type="[Engine Particles] Duplicate Particle System Success",e.DuplicateParticleSystemSuccess=o;var r=function e(t,n){m(this,e),this.id=t,this.particleSystem=n};r.type="[Engine Particles] Update Particle System",e.UpdateParticleSystem=r;var a=function e(t,n){m(this,e),this.oldId=t,this.newId=n};a.type="[Engine Particles] Set Particle System Id",e.SetParticleSystemId=a;var s=function e(t,n){m(this,e),this.visible=t,this.chapterId=n};s.type="[Engine Particles] Set Particle Systems Visible",e.SetParticleSystemsVisible=s;var c=function e(t,n,i){m(this,e),this.id=t,this.visible=n,this.chapterId=i};c.type="[Engine Particles] Set Particle System Visible",e.SetParticleSystemVisible=c;var l=function e(t,n){m(this,e),this.id=t,this.chapterId=n};l.type="[Engine Particles] Assign Particle",e.AssignParticle=l;var u=function e(t,n){m(this,e),this.id=t,this.chapterId=n};u.type="[Engine Particles] Unassign Particle",e.UnassignParticle=u;var p=function e(t){m(this,e),this.id=t};p.type="[Engine Partiles] Delete Particle System",e.DeleteParticleSystem=p;var d=function e(t){m(this,e),this.id=t};d.type="[Engine Partiles] Select Particle System",e.SelectParticleSystem=d;var g=function e(t){m(this,e),this.index=t};g.type="[Engine Partiles] Select Particle Constraint",e.SelectParticleConstraint=g;var h=function e(t){m(this,e),this.index=t};h.type="[Engine Partiles] Select Particle Creator",e.SelectParticleCreator=h;var f=function e(t){m(this,e),this.index=t};f.type="[Engine Partiles] Select Particle Updater",e.SelectParticleUpdater=f;var b=function e(t){m(this,e),this.chapterMap=t};b.type="[Engine Particles] Update Lookup Chapters",e.UpdateTweenParticleLookupChapters=b;var v=function e(t,n){m(this,e),this.chapterId=t,this.lookup=n};v.type="[Engine Particles] Set Lookup for chapter",e.SetLookupForChapter=v;var y=function e(t){m(this,e),this.chapterId=t};y.type="[Engine Particles] Delete chapter lookup",e.DeleteChapterLookup=y;var x=function e(t){m(this,e),this.patches=t};x.type="[Engine Particles] Apply Patch",e.ApplyPatch=x}(zi||(zi={})),function(e){e.updateChapterIds=function(e,t){return Object.keys(e).reduce((function(n,i){return n[t[i]]=e[i],n}),{})},e.duplicateChapter=function(e,t,n){return Object.assign(Object.assign({},n),u({},t,n[e]))},e.deleteChapter=function(e,t){var n=Object.assign({},t);return delete n[e],n},e.addEntryForChapter=function(e,t,n){return n[e]=Object.assign(Object.assign({},n[e]),t),n},e.refreshEngineLookup=function(e,t){Human.modules.moduleData[e].tweenParticleLookup=t}}(Ti||(Ti={})),function(e){function t(e){return e.split("-")[0].replace(/_particle$/,"")}e.getParticleIdRoot=t,e.generateParticleId=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Tt.getUuid;return"".concat(t(e),"-").concat(n())}}(Ui||(Ui={}));var to,no,io,oo=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},ro=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},ao=((no=to=function(){function e(){m(this,e)}return v(e,[{key:"applyPatch",value:function(e,t){var n=immer.applyPatches(e.getState(),t.patches);e.patchState(n)}},{key:"setParticleState",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){e.particleSystems=t.particleSystems.reduce((function(e,t){return e[t.id]=t,e}),{}),e.assignedParticles=t.assignedParticles,e.tweenParticleLookup=t.tweenParticleLookup,e.visibleParticleSystems={}})))}},{key:"setParticlesVisible",value:function(e,t){var n=t.visible,i=t.chapterId;e.patchState(immer.produce(e.getState(),(function(e){var t=(e.assignedParticles[i]||[]).reduce((function(e,t){return e[t]=n,e}),{});e.visibleParticleSystems=Object.assign(Object.assign({},e.visibleParticleSystems),u({},i,t))})))}},{key:"setParticleVisible",value:function(e,t){var n=t.id,i=t.visible,o=t.chapterId;e.patchState(immer.produce(e.getState(),(function(e){e.visibleParticleSystems[o]=Object.assign(Object.assign({},e.visibleParticleSystems[o]||{}),u({},n,i))})))}},{key:"newParticleSystem",value:function(e,t){var n=t.particleSystem,i=t.chapterId,o=n.id,r=p(immer.produceWithPatches(e.getState(),(function(e){e.particleSystems[o]=n,e.assignedParticles[i]=[].concat(c(e.assignedParticles[i]||[]),[o])})),3),a=r[0];r[1],r[2],e.patchState(a)}},{key:"setParticleSystemId",value:function(e,t){void 0!==e.getState().particleSystems[t.newId]||e.patchState(immer.produce(e.getState(),(function(e){e.particleSelection.selectedParticle=e.particleSelection.selectedParticle===t.oldId?t.newId:e.particleSelection.selectedParticle,e.particleSystems[t.newId]=Object.assign(Object.assign({},e.particleSystems[t.oldId]),{id:t.newId}),delete e.particleSystems[t.oldId],Object.entries(e.assignedParticles).forEach((function(n){var i=p(n,2),o=i[0],r=i[1];e.assignedParticles[o]=r.map((function(e){return e===t.oldId?t.newId:e}))})),Object.entries(e.tweenParticleLookup).forEach((function(n){var i=p(n,2),o=i[0],r=i[1];e.tweenParticleLookup[o]=Object(Se.mapValues)(r,(function(e,n,i){return e===t.oldId?t.newId:e}))}))})))}},{key:"duplicateParticleSystem",value:function(e,t){var n=t.id,i=t.targetChapterId,o=Ui.generateParticleId(n);e.patchState(immer.produce(e.getState(),(function(e){e.particleSystems[o]=JSON.parse(JSON.stringify(e.particleSystems[n])),e.particleSystems[o].id=o,e.assignedParticles[i].push(o);var t=Ui.getParticleIdRoot(n);e.tweenParticleLookup[i]&&e.tweenParticleLookup[i][t]&&(e.tweenParticleLookup=Ti.addEntryForChapter(i,u({},t,o),e.tweenParticleLookup))}))),e.dispatch(new zi.DuplicateParticleSystemSuccess(o,i))}},{key:"updateParticleSystem",value:function(e,t){var n=immer.produce(e.getState(),(function(e){e.particleSystems[t.id]=t.particleSystem}));e.patchState(Object.assign(Object.assign({},n),{particleSystems:Object.assign({},n.particleSystems)}))}},{key:"deleteChapterLookup",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){delete e.tweenParticleLookup[t.chapterId]})))}},{key:"setLookupForChapter",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){e.tweenParticleLookup[t.chapterId]=t.lookup})))}},{key:"assignParticle",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){var n=e.assignedParticles[t.chapterId]||[],i=Ui.getParticleIdRoot(t.id);e.assignedParticles[t.chapterId]=n.concat(t.id),e.tweenParticleLookup=Ti.addEntryForChapter(t.chapterId,u({},i,t.id),e.tweenParticleLookup),e.particleSystems=Object.assign({},e.particleSystems)})))}},{key:"unassignParticle",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){var n=e.assignedParticles[t.chapterId]||[],i=Ui.getParticleIdRoot(t.id);e.assignedParticles[t.chapterId]=n.filter((function(e){return e!==t.id})),e.tweenParticleLookup[t.chapterId]&&delete e.tweenParticleLookup[t.chapterId][i],e.particleSystems=Object.assign({},e.particleSystems)})))}},{key:"deleteParticleSystem",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){delete e.particleSystems[t.id],Object.keys(e.assignedParticles).forEach((function(n){e.assignedParticles[n]=e.assignedParticles[n].filter((function(e){return e!==t.id}))})),Object.keys(e.tweenParticleLookup).forEach((function(n){delete e.tweenParticleLookup[n][Ui.getParticleIdRoot(t.id)]}))})))}},{key:"selectParticleSystem",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){e.particleSelection={selectedParticle:t.id}})))}},{key:"selectParticleConstraint",value:function(e,t){var n=e.getState().particleSelection;e.patchState(immer.produce(e.getState(),(function(e){e.particleSelection=Object.assign(Object.assign({},n),{selectedConstraint:t.index})})))}},{key:"selectParticleCreator",value:function(e,t){var n=e.getState().particleSelection;e.patchState(immer.produce(e.getState(),(function(e){e.particleSelection=Object.assign(Object.assign({},n),{selectedCreator:t.index})})))}},{key:"selectParticleUpdater",value:function(e,t){var n=e.getState().particleSelection;e.patchState(immer.produce(e.getState(),(function(e){e.particleSelection=Object.assign(Object.assign({},n),{selectedUpdater:t.index})})))}},{key:"updateTweenParticleLookupChapters",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){e.tweenParticleLookup=Ti.updateChapterIds(e.tweenParticleLookup,t.chapterMap)})))}}],[{key:"particleSystemIdExists",value:function(e){return Object(E.h)([to],(function(t){return void 0!==t.particleSystems[e]}))}},{key:"particleSystemsForChapter",value:function(e){return Object(E.h)([to],(function(t){return(t.assignedParticles[e]||[]).map((function(e){return t.particleSystems[e]}))}))}},{key:"getVisibleParticleSystesmForChapter",value:function(e){return Object(E.h)([to],(function(t){var n=t.visibleParticleSystems[e]||{};return(t.assignedParticles[e]||[]).filter((function(e){return!1!==n[e]}))}))}},{key:"getTweenParticleLookup",value:function(e){return e.tweenParticleLookup}},{key:"getParticleSystems",value:function(e){return e.particleSystems}},{key:"getVisisbleParticleSystems",value:function(e){return e.visibleParticleSystems}},{key:"getParticleSystemsList",value:function(e){return Object.values(e.particleSystems)}},{key:"getAssignedParticleSystems",value:function(e){return e.assignedParticles}},{key:"getSelectedParticleSystemId",value:function(e){return e.particleSelection.selectedParticle}},{key:"getSelectedParticleSystem",value:function(e){return e.particleSystems[e.particleSelection.selectedParticle]}},{key:"getSelectedParticleConstraintIndex",value:function(e){return e.particleSelection.selectedConstraint}},{key:"getSelectedParticleConstraint",value:function(e){var t=to.getSelectedParticleSystem(e);return t?t.constraints[e.particleSelection.selectedConstraint]:null}},{key:"getSelectedParticleCreatorIndex",value:function(e){return e.particleSelection.selectedCreator}},{key:"getSelectedParticleCreator",value:function(e){var t=to.getSelectedParticleSystem(e);return t?t.creators[e.particleSelection.selectedCreator]:null}},{key:"getSelectedParticleUpdaterIndex",value:function(e){return e.particleSelection.selectedUpdater}},{key:"getSelectedParticleUpdater",value:function(e){var t=to.getSelectedParticleSystem(e);return t?t.updaters[e.particleSelection.selectedUpdater]:null}}]),e}()).\u0275fac=function(e){return new(e||no)},no.\u0275prov=P.Lb({token:no,factory:no.\u0275fac}),oo([Object(E.a)(zi.ApplyPatch),ro("design:type",Function),ro("design:paramtypes",[Object,zi.ApplyPatch]),ro("design:returntype",void 0)],no.prototype,"applyPatch",null),oo([Object(E.a)(zi.SetParticleState),ro("design:type",Function),ro("design:paramtypes",[Object,zi.SetParticleState]),ro("design:returntype",void 0)],no.prototype,"setParticleState",null),oo([Object(E.a)(zi.SetParticleSystemsVisible),ro("design:type",Function),ro("design:paramtypes",[Object,zi.SetParticleSystemsVisible]),ro("design:returntype",void 0)],no.prototype,"setParticlesVisible",null),oo([Object(E.a)(zi.SetParticleSystemVisible),ro("design:type",Function),ro("design:paramtypes",[Object,zi.SetParticleSystemVisible]),ro("design:returntype",void 0)],no.prototype,"setParticleVisible",null),oo([Object(E.a)(zi.NewParticleSystem),ro("design:type",Function),ro("design:paramtypes",[Object,zi.NewParticleSystem]),ro("design:returntype",void 0)],no.prototype,"newParticleSystem",null),oo([Object(E.a)(zi.SetParticleSystemId),ro("design:type",Function),ro("design:paramtypes",[Object,zi.SetParticleSystemId]),ro("design:returntype",void 0)],no.prototype,"setParticleSystemId",null),oo([Object(E.a)(zi.DuplicateParticleSystem),ro("design:type",Function),ro("design:paramtypes",[Object,zi.DuplicateParticleSystem]),ro("design:returntype",void 0)],no.prototype,"duplicateParticleSystem",null),oo([Object(E.a)(zi.UpdateParticleSystem),ro("design:type",Function),ro("design:paramtypes",[Object,zi.UpdateParticleSystem]),ro("design:returntype",void 0)],no.prototype,"updateParticleSystem",null),oo([Object(E.a)(zi.DeleteChapterLookup),ro("design:type",Function),ro("design:paramtypes",[Object,zi.DeleteChapterLookup]),ro("design:returntype",void 0)],no.prototype,"deleteChapterLookup",null),oo([Object(E.a)(zi.SetLookupForChapter),ro("design:type",Function),ro("design:paramtypes",[Object,zi.SetLookupForChapter]),ro("design:returntype",void 0)],no.prototype,"setLookupForChapter",null),oo([Object(E.a)(zi.AssignParticle),ro("design:type",Function),ro("design:paramtypes",[Object,zi.AssignParticle]),ro("design:returntype",void 0)],no.prototype,"assignParticle",null),oo([Object(E.a)(zi.UnassignParticle),ro("design:type",Function),ro("design:paramtypes",[Object,zi.UnassignParticle]),ro("design:returntype",void 0)],no.prototype,"unassignParticle",null),oo([Object(E.a)(zi.DeleteParticleSystem),ro("design:type",Function),ro("design:paramtypes",[Object,zi.DeleteParticleSystem]),ro("design:returntype",void 0)],no.prototype,"deleteParticleSystem",null),oo([Object(E.a)(zi.SelectParticleSystem),ro("design:type",Function),ro("design:paramtypes",[Object,zi.SelectParticleSystem]),ro("design:returntype",void 0)],no.prototype,"selectParticleSystem",null),oo([Object(E.a)(zi.SelectParticleConstraint),ro("design:type",Function),ro("design:paramtypes",[Object,zi.SelectParticleConstraint]),ro("design:returntype",void 0)],no.prototype,"selectParticleConstraint",null),oo([Object(E.a)(zi.SelectParticleCreator),ro("design:type",Function),ro("design:paramtypes",[Object,zi.SelectParticleCreator]),ro("design:returntype",void 0)],no.prototype,"selectParticleCreator",null),oo([Object(E.a)(zi.SelectParticleUpdater),ro("design:type",Function),ro("design:paramtypes",[Object,zi.SelectParticleUpdater]),ro("design:returntype",void 0)],no.prototype,"selectParticleUpdater",null),oo([Object(E.a)(zi.UpdateTweenParticleLookupChapters),ro("design:type",Function),ro("design:paramtypes",[Object,zi.UpdateTweenParticleLookupChapters]),ro("design:returntype",void 0)],no.prototype,"updateTweenParticleLookupChapters",null),oo([Object(E.e)(),ro("design:type",Function),ro("design:paramtypes",[Object]),ro("design:returntype",void 0)],no,"getTweenParticleLookup",null),oo([Object(E.e)(),ro("design:type",Function),ro("design:paramtypes",[Object]),ro("design:returntype",void 0)],no,"getParticleSystems",null),oo([Object(E.e)(),ro("design:type",Function),ro("design:paramtypes",[Object]),ro("design:returntype",void 0)],no,"getVisisbleParticleSystems",null),oo([Object(E.e)(),ro("design:type",Function),ro("design:paramtypes",[Object]),ro("design:returntype",void 0)],no,"getParticleSystemsList",null),oo([Object(E.e)(),ro("design:type",Function),ro("design:paramtypes",[Object]),ro("design:returntype",void 0)],no,"getAssignedParticleSystems",null),oo([Object(E.e)(),ro("design:type",Function),ro("design:paramtypes",[Object]),ro("design:returntype",void 0)],no,"getSelectedParticleSystemId",null),oo([Object(E.e)(),ro("design:type",Function),ro("design:paramtypes",[Object]),ro("design:returntype",void 0)],no,"getSelectedParticleSystem",null),oo([Object(E.e)(),ro("design:type",Function),ro("design:paramtypes",[Object]),ro("design:returntype",void 0)],no,"getSelectedParticleConstraintIndex",null),oo([Object(E.e)(),ro("design:type",Function),ro("design:paramtypes",[Object]),ro("design:returntype",void 0)],no,"getSelectedParticleConstraint",null),oo([Object(E.e)(),ro("design:type",Function),ro("design:paramtypes",[Object]),ro("design:returntype",void 0)],no,"getSelectedParticleCreatorIndex",null),oo([Object(E.e)(),ro("design:type",Function),ro("design:paramtypes",[Object]),ro("design:returntype",void 0)],no,"getSelectedParticleCreator",null),oo([Object(E.e)(),ro("design:type",Function),ro("design:paramtypes",[Object]),ro("design:returntype",void 0)],no,"getSelectedParticleUpdaterIndex",null),oo([Object(E.e)(),ro("design:type",Function),ro("design:paramtypes",[Object]),ro("design:returntype",void 0)],no,"getSelectedParticleUpdater",null),no=to=oo([Object(E.f)({name:"engineParticles",defaults:{particleSelection:{},particleSystems:{},visibleParticleSystems:{},assignedParticles:{},tweenParticleLookup:{}}})],no));!function(e){var t=function e(t){m(this,e),this.quizState=t};t.type="[Quiz] Set Quiz State",e.SetQuizState=t;var n=function e(){m(this,e)};n.type="[Quiz] Reset Quiz State",e.ResetQuizState=n;var i=function e(t){m(this,e),this.quizSettings=t};i.type="[Quiz] Set Quiz Settings",e.SetQuizSettings=i;var o=function e(t){m(this,e),this.active=t};o.type="[Quiz] Set Quiz Active",e.SetQuizActive=o;var r=function e(t){m(this,e),this.enabled=t};r.type="[Quiz] Set Quiz Enabled",e.SetQuizEnabled=r;var a=function e(t){m(this,e),this.locked=t};a.type="[Quiz] Set Quiz Locked",e.SetQuizLocked=a;var s=function e(t){m(this,e),this.mode=t};s.type="[Quiz] Set Quiz Questions Mode",e.SetQuizQuestionsMode=s;var c=function e(t,n){m(this,e),this.sourceChapterId=t,this.targetChapterId=n};c.type="[Quiz] Copy Quiz Questions",e.CopyQuestions=c;var l=function e(t){m(this,e),this.chapterIds=t};l.type="[Quiz] Reoder Quiz Questions",e.ReorderQuestions=l;var u=function e(t){m(this,e),this.question=t};u.type="[Quiz] Add Quiz Question",e.AddQuestion=u;var p=function e(t){m(this,e),this.id=t};p.type="[Quiz] Delete Quiz Question",e.DeleteQuestion=p;var d=function e(t){m(this,e),this.questions=t};d.type="[Quiz] Set Quiz Questions",e.SetQuestions=d;var g=function e(t){m(this,e),this.question=t};g.type="[Quiz] Set Quiz Question",e.SetQuestion=g;var h=function e(t){m(this,e),this.submission=t};h.type="[Quiz] Submit Question Answer",e.SubmitQuestionAnswer=h;var f=function e(){m(this,e)};f.type="[Quiz] Advance Question",e.NextQuestion=f;var b=function e(){m(this,e)};b.type="[Quiz] Previous Question",e.PreviousQuestion=b;var v=function e(){m(this,e)};v.type="[Quiz] Clear Submissions",e.ClearSubmissions=v;var y=function e(t){m(this,e),this.questionId=t};y.type="[Quiz] Set Active Question",e.SetActiveQuestion=y;var x=function e(t){m(this,e),this.pickMode=t};x.type="[Quiz] Set Pick Mode",e.SetQuizPickMode=x;var k=function e(t){m(this,e),this.submission=t};k.type="[Quiz] Set Active QuestionAnswer",e.SetActiveSubmission=k;var w=function e(t){m(this,e),this.lifecycle=t};w.type="[Quiz] Set Quiz Lifecycle",e.SetQuizLifecycle=w}(io||(io={}));var so=function(e){return e.Markdown="markdown",e.Images="images",e.Ticker="ticker",e}({}),co=function(e){return e.MultipleChoice="multiple-choice",e.SelectAnatomy="select-anatomy",e.LabelAnatomy="label-anatomy",e.Instructions="text-only",e}({}),lo=(u(b={},co.MultipleChoice,"Multiple Choice"),u(b,co.SelectAnatomy,"Select Anatomy in 3D"),u(b,co.LabelAnatomy,"Label Anatomy"),u(b,co.Instructions,"Instructions"),b);function uo(e){var t,n=e.map((function(e){return(e.quizQuestions||[]).map((function(t){return Object.assign(Object.assign({},t),{chapterId:t.chapterId||e.id})}))}));return(t=[]).concat.apply(t,c(n))}function po(e,t){var n="string"==typeof e.data.correctAnswer?[e.data.correctAnswer]:e.data.correctAnswer;switch(e.type){case co.LabelAnatomy:return Object(Se.isEqual)(n,t);case co.MultipleChoice:case co.SelectAnatomy:return Object(Se.isEqual)(n.sort(),t.sort())}}function go(e,t){var n=e.filter((function(e){return e.type!==co.Instructions})),i=e.reduce((function(e,n){return e[n.id]=function(e,t){var n=e.find((function(e){return e.questionId===t}));return n?n.answer:void 0}(t,n.id),e}),{}),o=n.filter((function(e){var t=i[e.id];return po(e,void 0===t?[]:"string"==typeof t?[t]:t)})),r=e.length,a=n.length,s=o.length,c=r-s;return{score:r>0?Math.round(s/a*100):0,total:r,scorableTotal:a,correctTotal:s,incorrectTotal:c,questionAnswers:i}}var ho,fo=function(e){return e[e.Question=0]="Question",e[e.Explanation=1]="Explanation",e[e.Review=2]="Review",e}({}),bo=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},vo=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},mo=function(e){return e[e.Learning=0]="Learning",e[e.Assessment=1]="Assessment",e}({}),yo={quizModeActive:!1,quizModeLocked:!1,quizQuestionsMode:"all",launchMode:mo.Learning,questions:[],activeQuestionId:void 0,activeSubmission:void 0,questionSubmissions:[],quizSettings:{enabled:!0,showSummary:!0,showExplanation:!0,showSubmit:!0,showProgress:!0},pickMode:"single",lifecycle:fo.Question};function xo(e,t){return e.filter((function(e){return e.chapterId===t}))}function ko(e,t){var n,i=t.map((function(t){return xo(e,t)}));return(n=[]).concat.apply(n,c(i))}function wo(e){var t=function(e){return c(new Set(e.map((function(e){return e.chapterId}))))}(e);return ko(e,t)}var Oo,Co,So,_o=((Oo=ho=function(){function e(){m(this,e)}return v(e,[{key:"resetQuizState",value:function(e,t){e.setState(Object.assign({},yo))}},{key:"setQuizState",value:function(e,t){var n=t.quizState;e.setState(Object.assign(Object.assign({},yo),n))}},{key:"setQuizSettings",value:function(e,t){var n=t.quizSettings;e.patchState({quizSettings:n})}},{key:"setQuizActive",value:function(e,t){e.patchState({quizModeActive:t.active,activeQuestionId:!1===t.active?void 0:e.getState().activeQuestionId})}},{key:"setQuizEnabled",value:function(e,t){var n=e.getState().quizSettings;e.patchState({quizSettings:Object.assign(Object.assign({},n),{enabled:t.enabled})})}},{key:"setQuizLocked",value:function(e,t){e.patchState({quizModeLocked:t.locked})}},{key:"setQuizQuestionsMode",value:function(e,t){e.patchState({quizQuestionsMode:t.mode})}},{key:"copyQuestions",value:function(e,t){var n=t.sourceChapterId,i=t.targetChapterId,o=e.getState().questions,r=[].concat(c(o),c(xo(e.getState().questions,n).map((function(e){return Object.assign(Object.assign({},JSON.parse(JSON.stringify(e))),{id:Tt.idWithPrefix("question"),chapterId:i})}))));e.patchState({questions:wo(r)})}},{key:"reorderQuestions",value:function(e,t){var n=t.chapterIds;e.patchState({questions:ko(e.getState().questions,n)})}},{key:"addQuestion",value:function(e,t){var n=[].concat(c(e.getState().questions),[t.question]);e.patchState({questions:wo(n)})}},{key:"deleteQuestion",value:function(e,t){var n=e.getState().questions.filter((function(e){return e.id!==t.id}));e.patchState({questions:wo(n)})}},{key:"setQuestions",value:function(e,t){var n=t.questions;e.patchState({questions:wo(n)})}},{key:"setQuestion",value:function(e,t){var n=e.getState().questions.map((function(e){return e.id===t.question.id?t.question:e}));e.patchState({questions:n})}},{key:"submitQuestionAnswer",value:function(e,t){var n=c(e.getState().questionSubmissions),i=n.findIndex((function(e){return e.questionId===t.submission.questionId}));i>-1?n[i]=t.submission:n.push(t.submission),e.patchState({questionSubmissions:n})}},{key:"nextQuestion",value:function(e){var t,n=e.getState(),i=n.questions,o=n.activeQuestionId,r=(null===(t=i[e.getState().questions.findIndex((function(e){return e.id===o}))+1])||void 0===t?void 0:t.id)||void 0;void 0!==r&&e.patchState({activeQuestionId:r})}},{key:"previousQuestion",value:function(e){var t,n=e.getState(),i=n.questions,o=n.activeQuestionId,r=(null===(t=i[e.getState().questions.findIndex((function(e){return e.id===o}))-1])||void 0===t?void 0:t.id)||void 0;void 0!==r&&e.patchState({activeQuestionId:r})}},{key:"clearSubmissions",value:function(e){e.patchState({questionSubmissions:[]})}},{key:"setActiveQuestion",value:function(e,t){e.patchState({activeQuestionId:t.questionId})}},{key:"setQuizPickMode",value:function(e,t){var n=t.pickMode;e.patchState({pickMode:n})}},{key:"setActiveSubmission",value:function(e,t){var n=t.submission;e.patchState({activeSubmission:n})}},{key:"setQuizLifecycle",value:function(e,t){e.patchState({lifecycle:t.lifecycle})}}],[{key:"getQuizQuestionsByChapter",value:function(e){return Object(E.h)([ho],(function(t){return xo(t.questions,e)}))}},{key:"getLifecycle",value:function(e){return e.lifecycle}},{key:"getQuizSettings",value:function(e){return e.quizSettings}},{key:"getQuizModeActive",value:function(e){return e.quizModeActive}},{key:"getQuizModeLocked",value:function(e){return e.quizModeLocked}},{key:"getQuizReviewEnabled",value:function(e){var t=e.quizModeLocked,n=e.quizQuestionsMode,i=e.questions,o=e.quizSettings;return!(t&&!o.showSummary||t&&"restricted"===n&&1===i.length)}},{key:"globalSceneConfig",value:function(e){return e.sceneConfig}},{key:"hasQuiz",value:function(e){return e.questions.length>0}},{key:"getQuizEnabled",value:function(e){return!1!==e.quizSettings.enabled}},{key:"getAllQuestions",value:function(e){return e.questions}},{key:"getAllSubmissions",value:function(e){return e.questionSubmissions}},{key:"getActiveSubmitted",value:function(e){var t=e.questionSubmissions,n=e.activeQuestionId;return t.find((function(e){return e.questionId===n}))}},{key:"getActiveSubmission",value:function(e){return e.activeSubmission}},{key:"getActiveQuestion",value:function(e){return e.questions.find((function(t){return t.id===e.activeQuestionId}))}},{key:"getActiveQuestionId",value:function(e){return e.activeQuestionId}},{key:"getActiveQuestionLabels",value:function(e){var t=e.questions.find((function(t){return t.id===e.activeQuestionId}));return t&&t.type===co.LabelAnatomy?t.data.options:[]}},{key:"getActiveQuestionIndex",value:function(e){return e.questions.findIndex((function(t){return t.id===e.activeQuestionId}))}},{key:"getQuestionIndex",value:function(e,t){return Object(E.h)([ho],(function(n){return ko(n.questions,e).findIndex((function(e){return e.id===t}))}))}},{key:"getQuestionTotal",value:function(e){return e.questions.length}},{key:"getCorrectAnswerTotal",value:function(e){var t=e.questionSubmissions,n=e.questions;return t.filter((function(e){return po(n.find((function(t){return t.id===e.questionId})),e.answer)})).length}},{key:"getQuestionsRemaining",value:function(e){var t=e.questions,n=e.questionSubmissions;return t.length-n.length}},{key:"hasQuestionRemaining",value:function(e){var t=e.questions;return e.questionSubmissions.length<t.length}},{key:"getPickMode",value:function(e){return e.pickMode}}]),e}()).\u0275fac=function(e){return new(e||Oo)},Oo.\u0275prov=P.Lb({token:Oo,factory:Oo.\u0275fac}),bo([Object(E.a)(io.ResetQuizState),vo("design:type",Function),vo("design:paramtypes",[Object,io.ResetQuizState]),vo("design:returntype",void 0)],Oo.prototype,"resetQuizState",null),bo([Object(E.a)(io.SetQuizState),vo("design:type",Function),vo("design:paramtypes",[Object,io.SetQuizState]),vo("design:returntype",void 0)],Oo.prototype,"setQuizState",null),bo([Object(E.a)(io.SetQuizSettings),vo("design:type",Function),vo("design:paramtypes",[Object,io.SetQuizSettings]),vo("design:returntype",void 0)],Oo.prototype,"setQuizSettings",null),bo([Object(E.a)(io.SetQuizActive),vo("design:type",Function),vo("design:paramtypes",[Object,io.SetQuizActive]),vo("design:returntype",void 0)],Oo.prototype,"setQuizActive",null),bo([Object(E.a)(io.SetQuizEnabled),vo("design:type",Function),vo("design:paramtypes",[Object,io.SetQuizEnabled]),vo("design:returntype",void 0)],Oo.prototype,"setQuizEnabled",null),bo([Object(E.a)(io.SetQuizLocked),vo("design:type",Function),vo("design:paramtypes",[Object,io.SetQuizLocked]),vo("design:returntype",void 0)],Oo.prototype,"setQuizLocked",null),bo([Object(E.a)(io.SetQuizQuestionsMode),vo("design:type",Function),vo("design:paramtypes",[Object,io.SetQuizQuestionsMode]),vo("design:returntype",void 0)],Oo.prototype,"setQuizQuestionsMode",null),bo([Object(E.a)(io.CopyQuestions),vo("design:type",Function),vo("design:paramtypes",[Object,io.CopyQuestions]),vo("design:returntype",void 0)],Oo.prototype,"copyQuestions",null),bo([Object(E.a)(io.ReorderQuestions),vo("design:type",Function),vo("design:paramtypes",[Object,io.ReorderQuestions]),vo("design:returntype",void 0)],Oo.prototype,"reorderQuestions",null),bo([Object(E.a)(io.AddQuestion),vo("design:type",Function),vo("design:paramtypes",[Object,io.AddQuestion]),vo("design:returntype",void 0)],Oo.prototype,"addQuestion",null),bo([Object(E.a)(io.DeleteQuestion),vo("design:type",Function),vo("design:paramtypes",[Object,io.DeleteQuestion]),vo("design:returntype",void 0)],Oo.prototype,"deleteQuestion",null),bo([Object(E.a)(io.SetQuestions),vo("design:type",Function),vo("design:paramtypes",[Object,io.SetQuestions]),vo("design:returntype",void 0)],Oo.prototype,"setQuestions",null),bo([Object(E.a)(io.SetQuestion),vo("design:type",Function),vo("design:paramtypes",[Object,io.SetQuestion]),vo("design:returntype",void 0)],Oo.prototype,"setQuestion",null),bo([Object(E.a)(io.SubmitQuestionAnswer),vo("design:type",Function),vo("design:paramtypes",[Object,io.SubmitQuestionAnswer]),vo("design:returntype",void 0)],Oo.prototype,"submitQuestionAnswer",null),bo([Object(E.a)(io.NextQuestion),vo("design:type",Function),vo("design:paramtypes",[Object]),vo("design:returntype",void 0)],Oo.prototype,"nextQuestion",null),bo([Object(E.a)(io.PreviousQuestion),vo("design:type",Function),vo("design:paramtypes",[Object]),vo("design:returntype",void 0)],Oo.prototype,"previousQuestion",null),bo([Object(E.a)(io.ClearSubmissions),vo("design:type",Function),vo("design:paramtypes",[Object]),vo("design:returntype",void 0)],Oo.prototype,"clearSubmissions",null),bo([Object(E.a)(io.SetActiveQuestion),vo("design:type",Function),vo("design:paramtypes",[Object,io.SetActiveQuestion]),vo("design:returntype",void 0)],Oo.prototype,"setActiveQuestion",null),bo([Object(E.a)(io.SetQuizPickMode),vo("design:type",Function),vo("design:paramtypes",[Object,io.SetQuizPickMode]),vo("design:returntype",void 0)],Oo.prototype,"setQuizPickMode",null),bo([Object(E.a)(io.SetActiveSubmission),vo("design:type",Function),vo("design:paramtypes",[Object,io.SetActiveSubmission]),vo("design:returntype",void 0)],Oo.prototype,"setActiveSubmission",null),bo([Object(E.a)(io.SetQuizLifecycle),vo("design:type",Function),vo("design:paramtypes",[Object,io.SetQuizLifecycle]),vo("design:returntype",void 0)],Oo.prototype,"setQuizLifecycle",null),bo([Object(E.e)(),vo("design:type",Function),vo("design:paramtypes",[Object]),vo("design:returntype",void 0)],Oo,"getLifecycle",null),bo([Object(E.e)(),vo("design:type",Function),vo("design:paramtypes",[Object]),vo("design:returntype",Object)],Oo,"getQuizSettings",null),bo([Object(E.e)(),vo("design:type",Function),vo("design:paramtypes",[Object]),vo("design:returntype",void 0)],Oo,"getQuizModeActive",null),bo([Object(E.e)(),vo("design:type",Function),vo("design:paramtypes",[Object]),vo("design:returntype",void 0)],Oo,"getQuizModeLocked",null),bo([Object(E.e)(),vo("design:type",Function),vo("design:paramtypes",[Object]),vo("design:returntype",Boolean)],Oo,"getQuizReviewEnabled",null),bo([Object(E.e)(),vo("design:type",Function),vo("design:paramtypes",[Object]),vo("design:returntype",void 0)],Oo,"globalSceneConfig",null),bo([Object(E.e)(),vo("design:type",Function),vo("design:paramtypes",[Object]),vo("design:returntype",void 0)],Oo,"hasQuiz",null),bo([Object(E.e)(),vo("design:type",Function),vo("design:paramtypes",[Object]),vo("design:returntype",void 0)],Oo,"getQuizEnabled",null),bo([Object(E.e)(),vo("design:type",Function),vo("design:paramtypes",[Object]),vo("design:returntype",void 0)],Oo,"getAllQuestions",null),bo([Object(E.e)(),vo("design:type",Function),vo("design:paramtypes",[Object]),vo("design:returntype",void 0)],Oo,"getAllSubmissions",null),bo([Object(E.e)(),vo("design:type",Function),vo("design:paramtypes",[Object]),vo("design:returntype",void 0)],Oo,"getActiveSubmitted",null),bo([Object(E.e)(),vo("design:type",Function),vo("design:paramtypes",[Object]),vo("design:returntype",void 0)],Oo,"getActiveSubmission",null),bo([Object(E.e)(),vo("design:type",Function),vo("design:paramtypes",[Object]),vo("design:returntype",void 0)],Oo,"getActiveQuestion",null),bo([Object(E.e)(),vo("design:type",Function),vo("design:paramtypes",[Object]),vo("design:returntype",void 0)],Oo,"getActiveQuestionId",null),bo([Object(E.e)(),vo("design:type",Function),vo("design:paramtypes",[Object]),vo("design:returntype",Array)],Oo,"getActiveQuestionLabels",null),bo([Object(E.e)(),vo("design:type",Function),vo("design:paramtypes",[Object]),vo("design:returntype",void 0)],Oo,"getActiveQuestionIndex",null),bo([Object(E.e)(),vo("design:type",Function),vo("design:paramtypes",[Object]),vo("design:returntype",void 0)],Oo,"getQuestionTotal",null),bo([Object(E.e)(),vo("design:type",Function),vo("design:paramtypes",[Object]),vo("design:returntype",void 0)],Oo,"getCorrectAnswerTotal",null),bo([Object(E.e)(),vo("design:type",Function),vo("design:paramtypes",[Object]),vo("design:returntype",void 0)],Oo,"getQuestionsRemaining",null),bo([Object(E.e)(),vo("design:type",Function),vo("design:paramtypes",[Object]),vo("design:returntype",void 0)],Oo,"hasQuestionRemaining",null),bo([Object(E.e)(),vo("design:type",Function),vo("design:paramtypes",[Object]),vo("design:returntype",void 0)],Oo,"getPickMode",null),Oo=ho=bo([Object(E.f)({name:"quiz",defaults:yo})],Oo)),jo=function e(t){var n=this;m(this,e),this.shown="majorityWins",this.selected="majorityWins",this.pickable="majorityWins",t.forEach((function(e){n[e]="majorityWins"}))},Po=((Co=function(){function e(t,n,i){m(this,e),this.store=t,this.labelService=n,this.graphService=i}return v(e,[{key:"getMinimumGraphSync",value:function(e,t,n){var i=this,o=Human.scene.colorRecipes.getRecipes(),r=Object.keys(new St(o)),a=function(e,t,n){var i={},o={};return ke.depthFirst(e,(function(r){o[r]=ke.isRoot(e,r)?Object.assign(Object.assign({},ke.getState(e,r,n)),t[r]||{}):Object.assign(Object.assign({},o[e.predecessors[r]]),t[r]||{}),ke.isLeaf(e,r)&&(i[r]=o[r])})),i}(e,t,r),c=function(e,t,n){var i=Object.keys(t),o=we.getInitialVoterState(n,i),r=we.getInitialElectionDepth(n,e),a=Object(Se.range)(r,-1).reduce((function(n,i){var o=we.getEligibleElections(e,Object.keys(n.remainingVoters),i),r=we.getElectionResults(e,n.remainingVoters,o,t),a=function(e){return e.reduce((function(e,t){var n=Object.keys(t).map((function(e){return function(e,t,n,i){var o=i.reduce((function(t,i){return t[i]=u({},e,!n),t}),{});return o[t]=u({},e,n),o}(e,t[e].id,t[e].result,t[e].dissenters)})).reduce((function(e,t){return Object(Se.merge)(e,t)}),{});return Object.keys(n).forEach((function(t){e[t]=n[t]})),e}),{})}(r.results);return Object.keys(a).forEach((function(e){n.syncGraph[e]=a[e]})),n.remainingVoters=r.remainingVoters,n}),{syncGraph:{},remainingVoters:o}).syncGraph;return function(e,t,n,i){var o,r=t.reduce((function(t,o){var r,a=e[o],c=e[i.predecessors[o]],l=s(n);try{for(l.s();!(r=l.n()).done;){var u=r.value;a[u]===c[u]&&t.push({successorId:o,prop:u})}}catch(p){l.e(p)}finally{l.f()}return t}),[]),a=s(r);try{for(a.s();!(o=a.n()).done;){var c=o.value;delete e[c.successorId][c.prop],0===Object.keys(e[c.successorId]).length&&delete e[c.successorId]}}catch(l){a.e(l)}finally{a.f()}return e}(a,Object.keys(a).filter((function(t){return!e.roots[t]&&!!e.successors[t]})),i,e)}(e,JSON.parse(JSON.stringify(new jo(o))),a);Object.entries(t).forEach((function(e){var t=p(e,2),n=t[0],i=t[1],o=Object(Se.omit)(i,r);Object(Se.isEmpty)(o)||(c[n]=Object.assign(Object.assign({},c[n]||{}),o))}));var l=new Ct;return Object.entries(c).forEach((function(e){var t=p(e,2),o=t[0],r=t[1];l[i.switchNamespace(o,n)]=r}),this),l}},{key:"convertGraphSync",value:function(e){var t=this,n={},i={},o={},r={};return Object.entries(e).forEach((function(e){var a=p(e,2),s=a[0],c=a[1];Object.entries(c).forEach((function(e){var t=p(e,2),a=t[0],c=t[1];"shown"===a?n[s]=c:"selected"===a?i[s]=c:"pickable"===a?o[s]=!c:r[s]=Object.assign(Object.assign({},r[s]||{}),u({},a,c))}),t)}),this),{showObjects:n,selectObjects:i,pickThroughObjects:o,synchronization:r}}},{key:"switchNamespace",value:function(e,t){return t[e]||e}},{key:"serializeTimelineMaps",value:function(e,t){var n=this,i=e.timelineMap;return i.forEach((function(e){e.data.timeline=n.switchNamespace(e.data.timeline,t)})),i}},{key:"serializeProperties",value:function(e){var t=Object.assign({},e.properties),n=Human.properties.properties["annotations.layout.type"];return"draggable"!==n&&(t["annotations.layout.type"]=n),t}},{key:"serializeHotspots",value:function(e,t){var n=this,i=c(e.hotspots),o={};return t.filter((function(t){return t.chapterId===e.id})).forEach((function(e){var t=n.labelService.serializeLabel(e,i.length);i=[].concat(c(i),c(t.hotspots)),o=Object.assign(Object.assign({},o),t.data)})),{customData:o,hotspots:i}}},{key:"serializeMedia",value:function(e){return e.media?Object.entries(e.media).reduce((function(e,t){var n=p(t,2),i=n[0],o=n[1];return e[i]=Object.assign({},o.data),e}),{}):null}},{key:"serializeBackground",value:function(e){return e?Object(te.classToClass)(e):{}}},{key:"serializeUI",value:function(e,t){return Object(Se.isEmpty)(t)?{play:{count:1}}:t}},{key:"calcMinimumPaintState",value:function(e,t){return Object.keys(e.roots).reduce((function(n,i){return Object.assign(Object.assign({},n),function n(i){var o=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=(e.successors[i]||[]).reduce((function(e,o){var r=!Object(Se.isEqual)(t[i],t[o]);return Object.assign(Object.assign({},e),n(o,r))}),{});return o?Object.assign(u({},i,t[i]),r):r}(i))}),{})}},{key:"serializeVisibilityLayers",value:function(e,t){var n=Object.assign({},e);return Array.isArray(e.layers)&&(n.layers=e.layers.map((function(e){return Object.assign(Object.assign({},e),{objectIds:e.objectIds.filter((function(e){return t.nodes.hasOwnProperty(e)}))})})).filter((function(e){return e.objectIds.length>0}))),n}},{key:"serializeChapter",value:function(e,t,n,i,o){var r,a=this.serializeHotspots(t,i),s=this.store.selectSnapshot(ao.particleSystemsForChapter(t.id)),c=Object.assign(Object.assign(Object.assign({},t.customData),a.customData),{particleSystems:s.map((function(e){return e.id}))}),l=this.store.selectSnapshot(_o.getQuizQuestionsByChapter(t.id)).map((function(e){var t=Object.assign({},e);return delete t.chapterId,t})),d=(u(r={id:o[t.id],displayName:t.info.displayName,description:t.info.description},t.camera.action,t.camera.location),u(r,"background",this.serializeBackground(t.background)),u(r,"hotspots",a.hotspots),u(r,"clippingPlanes",{clips:t.clippingPlanes.clips,boundary:t.clippingPlanes.boundary}),u(r,"ui",this.serializeUI(t,t.ui)),u(r,"media",this.serializeMedia(t)),u(r,"graph",t.graph||{}),u(r,"timelineMap",t.timelineMap||[]),u(r,"customData",c),u(r,"viewModes",t.viewModes),u(r,"lights",t.lights),u(r,"recipes",t.recipes||{}),u(r,"transparencyMode",t.transparencyMode||""),u(r,"fallbackTransparency",t.fallbackTransparency||""),u(r,"properties",this.serializeProperties(t)),u(r,"effects",t.effects||{}),u(r,"options",t.options),u(r,"transitions",t.transitions),u(r,"environment",t.environment||{}),u(r,"legend",t.legend||[]),u(r,"visibilityLayers",this.serializeVisibilityLayers(t.visibilityLayers.src,e)),u(r,"colorRecipeObjects",t.colorRecipeObjects),u(r,"contentBlocks",t.contentBlocks||[]),u(r,"quizQuestions",l),r),g=this.store.selectSnapshot(Ai.getAllNodeState)[t.id],h=Object.keys(g).reduce((function(n,i){var o=g[i],r=o.shownSetByTween?eo(e,i,t.showObjects)||Yi(e,i,t.showObjects):o.shown;return n.boolState[i]={shown:r,pickable:o.pickable},n.paintState[i]=Li.toEngine(o.paint),n}),{boolState:{},paintState:{}}),f=this.getMinimumGraphSync(e,h.boolState,n);return Object.entries(this.convertGraphSync(f)).forEach((function(e){var t=p(e,2),n=t[0],i=t[1];d[n]=i})),d.synchronization=this.calcMinimumPaintState(e,h.paintState),d}}]),e}()).\u0275fac=function(e){return new(e||Co)(P.Zb(E.g),P.Zb(wi),P.Zb(Ut))},Co.\u0275prov=P.Lb({token:Co,factory:Co.\u0275fac,providedIn:"root"}),Co);(So||(So={})).makeChapterIdMap=function(e,t){return e.reduce((function(e,n){return e[n.id]=!0===t?Tt.idWithPrefix("chapter"):n.id,e}),{})};var Mo,Io,zo,To,Uo=function(e){return e[e.LeftClip=0]="LeftClip",e[e.RightClip=1]="RightClip",e[e.BottomClip=2]="BottomClip",e[e.TopClip=3]="TopClip",e[e.FrontClip=4]="FrontClip",e[e.BackClip=5]="BackClip",e}({}),Lo={0:"left",1:"right",2:"bottom",3:"top",4:"front",5:"back"},Do={enabled:!1,clips:{left:{clipId:Uo.LeftClip,enabled:!1,fade:!1,fadeDistance:0,progress:0},right:{clipId:Uo.RightClip,enabled:!1,fade:!1,fadeDistance:0,progress:0},back:{clipId:Uo.BackClip,enabled:!1,fade:!1,fadeDistance:0,progress:0},front:{clipId:Uo.FrontClip,enabled:!1,fade:!1,fadeDistance:0,progress:0},top:{clipId:Uo.TopClip,enabled:!1,fade:!1,fadeDistance:0,progress:0},bottom:{clipId:Uo.BottomClip,enabled:!1,fade:!1,fadeDistance:0,progress:0}}},Eo=((Mo=function(){function e(t,n,i){m(this,e),this.engineService=t,this.serializeChapterService=n,this.labelService=i}return v(e,[{key:"addChapterToEngine",value:function(e,t){var n=So.makeChapterIdMap([e],!1),i=ke.createGraphFromSrc(Object.values(Human.scene.rootObjects),"objectId","objects",new St(Human.scene.colorRecipes.getRecipes())),o=this.serializeChapterService.serializeChapter(i,e,{},[],n);o.synchronization=JSON.parse(JSON.stringify(e.synchronization));var r=new Human.timeline.BranchTimeline(o);Human.timeline.activeRoot.addChapter(r,{rebuild:!0,position:t})}},{key:"removeChapterFromEngine",value:function(e){Human.timeline.activeRoot._chapters=Human.timeline.activeRoot._chapters.filter((function(t){return t.id!==e.id})),Human.timeline.activeRoot.build()}},{key:"copyChapter",value:function(e,t){var n=Object(te.classToClass)(e);return n.id=t,n.labels.forEach((function(e){e.id=Tt.idWithPrefix("label"),e.chapterId=n.id})),n.readyState={model:!0,animation:!0},n}},{key:"getCurrentChapterId",value:function(){return Human.timeline.activeRoot._nowBranch.id}},{key:"fromHumanChapter",value:function(e,t,n,i){var o=this,r=Object.assign({},n),a=e.chapters[i];r.environment=Object.assign({},a.environment),r.transitions=Object.assign({},a.transitions),a.transparencyMode&&(r.transparencyMode=a.transparencyMode),r.showObjects=Object.assign({},e.chapters[i].showObjects),r.pickThroughObjects=Object.assign({},e.chapters[i].pickThroughObjects),r.id||(r.id=Tt.idWithPrefix("chapter"));var s=!1;r.timelineMap=Object.values(n.maps).map((function(e){return"dummy"!==e.data.timeline.id&&(s=!0),{start:e.start,end:e.end,data:{timeline:e.data.timeline.id,start:e.data.start,end:e.data.end,fit:e.data.fit||!1,onEnd:e.data.onEnd}}})),delete r.maps;var l=0,u=!!n.animation&&n.animation.loop;s&&u?l=-1:s&&!u&&(l=1),r.ui=n.ui&&!Object(Se.isEmpty)(n.ui)?n.ui:{play:{count:l}};var p=Yn.Annotation,d=c(r.annotations||[]).map((function(e){return o.labelService.deserializeAnnotation(e,r,p)})),g=[],h=this.groupHotspots(c(r.hotspots||[]).filter((function(i){var r=o.labelService.filterHotspot(e,n,i);return r?i.theme||(i.theme="module"===t?hi.studioNext:hi.classicHotspot):g.push(i),r}))).map((function(t){var r;return(r=o.labelService).deserializeHotspots.apply(r,[e,n,i].concat(c(t)))}));r.labels=[].concat(c(d),c(h)),delete r.annotations,r.background=ai.deserialize(n.background);var f=Object(te.plainToClass)(li,r);return f.hotspots=g,f.readyState={model:!1,animation:!1},f.clippingPlanes=Object(Se.isEmpty)(f.clippingPlanes)?Do:this.sanitizeClippingPlanes(f.clippingPlanes),f.legend=c(a.legend||[]),f.visibilityLayers=this.buildVisibilityLayers(a.visibilityLayers,f.showObjects),f.colorRecipeObjects=a.colorRecipeObjects,f.contentBlocks=c(a.contentBlocks||[]),f.quizQuestions=(a.quizQuestions||[]).map((function(e){return Object.assign(Object.assign({},e),{chapterId:r.id})})),f}},{key:"getChapterTweenStates",value:function(e){var t=e.timelineMap.filter((function(e){return"dummy"!==e.data.timeline})).map((function(e){return e.data.timeline}));return Array.from(new Set(t))}},{key:"getChapterLightLibraries",value:function(e){return(e.lights&&e.lights.libraries||[]).filter((function(e){return"default"!==e}))}},{key:"getChapterReflectionLibraries",value:function(e){var t=e.environment&&e.environment.reflectionMap||[],n=function(e){return e.split(".")[0]},i=(e.environment&&e.environment.lightMap||[]).map(n).concat(t.map(n));return Array.from(new Set(i))}},{key:"hasVisibilityLayers",value:function(e){return Array.isArray(e)&&e.length>0}},{key:"buildVisibilityLayers",value:function(e,t){var n={src:{},current:{}};if(e&&this.hasVisibilityLayers(e.layers)){var i=e.initIndex||0,o=this.unpackLayers(e.layers),r=this.buildShownObjectsSet(t),a=this.buildCurrentLayers(o,r);n.src={layers:e.layers,initIndex:i},n.current={layers:a,index:i,position:0}}return n}},{key:"buildShownObjectsSet",value:function(e){var t=this.engineService.getSceneGraph(Human.scene.rootObjects),n=Object.keys(t.nodes).filter((function(n){return eo(t,n,e)||Yi(t,n,e)}));return new Set(n)}},{key:"unpackLayers",value:function(e){var t=[];return e.forEach((function(e){var n=[];e.objectIds.forEach((function(e){var t=Human.scene.objects[e].getLeafObjects();n=n.concat(t.map((function(e){return e.objectId})))})),t.push({name:e.name,objectIds:n})})),t}},{key:"buildCurrentLayers",value:function(e,t){var n=[];return e.forEach((function(i,o){var r=!1;i.objectIds.forEach((function(i){t.has(i)&&(r?n[n.length-1].objectIds.push(i):(n.push({name:e[o].name,objectIds:[i]}),r=!0))}))})),n}},{key:"sanitizeClippingPlanes",value:function(e){var t=Object.values(e.clips).some((function(e){return e.progress>0})),n=Object(Se.mapKeys)(e.clips,(function(e,t){return Lo[t]||t}));return Object.assign(Object.assign({},e),{clips:n,enabled:t})}},{key:"groupHotspots",value:function(e){var t={},n=function(e){return e.primitiveIndex?e.primitiveIndex.toFixed(0):e.pos?e.pos.map((function(e){return e.toFixed(3)})).join(":"):Math.random().toFixed(3)};return e.forEach((function(e){var i,o=[(i=e.type,RegExp("^circle-(plus|minus)").test(i)?"pair":"single"),e.objectId,n(e)].join("|");o in t?t[o].push(e):t[o]=[e]})),Object.values(t)}}]),e}()).\u0275fac=function(e){return new(e||Mo)(P.Zb(Nt),P.Zb(Po),P.Zb(wi))},Mo.\u0275prov=P.Lb({token:Mo,factory:Mo.\u0275fac,providedIn:"root"}),Mo),Fo=function(e){return e.Toggle="toggle",e.None="none",e}({}),Ao=function(){var e=function e(t){m(this,e),this.patches=t};return e.type="[Story Labels] Patch Labels",e}(),Ro=function(){var e=function e(t,n){m(this,e),this.labelId=t,this.offset=n};return e.type="[Story Labels] Set label Offset",e}(),Vo=function(){var e=function e(t){m(this,e),this.labels=t};return e.type="[Story Labels] Set Labels",e}(),No=function(){var e=function e(t){m(this,e),this.label=t};return e.type="[Story Labels] Add Label",e}(),Bo=function(){var e=function e(t){m(this,e),this.label=t};return e.type="[Story Labels] Set Contexdt Label",e}(),Ho=function(){var e=function e(t,n){m(this,e),this.sourceChapter=t,this.targetChapter=n};return e.type="[Story Labels] Copy Labels",e}(),Qo=function(){var e=function e(t){m(this,e),this.label=t};return e.type="[Story Labels] Remove Label",e}(),qo=function(){var e=function e(){m(this,e)};return e.type="[Story Labels] Remove Context Label",e}(),Wo=function(){var e=function e(t){m(this,e),this.chapter=t};return e.type="[Story Labels] Remove All Chapter Labels",e}(),$o=function(){var e=function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];m(this,e),this.label=t,this.record=n};return e.type="[Story Labels] Set Label",e}(),Ko=function(){var e=function e(t,n){m(this,e),this.id=t,this.states=n};return e.type="[Story Labels] Set Label States",e}(),Go=function(){var e=function e(t){m(this,e),this.scale=t};return e.type="[Story Labels] Set Label Scale",e}(),Zo=function(){var e=function e(t){m(this,e),this.label=t};return e.type="[Story Labels] Select Label",e}(),Jo=function(){var e=function e(){m(this,e)};return e.type="[Story Labels] Reset",e}(),Xo=function(){var e=function e(t,n){m(this,e),this.labels=t,this.fields=n};return e.type="[Story Labels] Convert",e}(),Yo=function(){var e=function e(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];m(this,e),this.enable=t,this.enableInfo=n,this.enableActions=i};return e.type="[Story Labels] Enable Context Label",e}(),er=function(){var e=function e(t,n){m(this,e),this.labels=t,this.shown=n};return e.type="[Story Labels] Set Labels Shown",e}(),tr=function(){var e=function e(t){m(this,e),this.show=t};return e.type="[Story Labels] Set All Labels Shown",e}(),nr=((Io=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Fo.None;m(this,e),this.collapsed=t,this.collapsedMode=n}).type="[Story Labels] Set Labels Collapsed",Io),ir=function(){var e=function e(t){m(this,e),this.draggable=t};return e.type="[Story Labels] Set Draggable",e}(),or=h("GyhO"),rr=h("5+tZ"),ar=h("7wxJ"),sr=h("wOnQ"),cr=h.n(sr),lr=(h("INDF"),h("Cfvw")),ur=h("Iab2"),pr=h("VUv2");(To=zo||(zo={})).exportImage=function(e,t,n,i){var o="string"==typeof e?To.base64ToBlob(e,t):e;return i?Object(pr.changeDpiBlob)(o,i).then((function(e){Object(ur.saveAs)(e,n)})):Object(ur.saveAs)(o,n),Object(G.a)(!0)},To.canvasToBlob=function(e,t,n){return new be.a((function(i){e.toBlob((function(e){i.next(e),i.complete()}),t,n)}))},To.fitCanvas=function(e,t){var n=t.width,i=t.height,o=document.createElement("canvas");o.width=n,o.height=i;var r=o.getContext("2d"),a=Math.max(.5*(e.width-o.width/o.height*e.height),0);return new be.a((function(t){r.drawImage(e,a,0,o.width,o.height),t.next(o),t.complete()}))},To.elementToCanvas=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t?{backgroundColor:"transparent"}:{};return Object(lr.a)(cr()(e,Object.assign({scale:1},n)))},To.combineCanvasElements=function(e){var t=Math.max.apply(Math,[0].concat(c(e.map((function(e){return e.width}))))),n=Math.max.apply(Math,[0].concat(c(e.map((function(e){return e.height}))))),i=document.createElement("canvas");i.width=t,i.height=n;var o=i.getContext("2d");return e.forEach((function(e){o.drawImage(e,0,0)})),i},To.base64ToBlob=function(e,t){for(var n=atob(e.split(",")[1]),i=new ArrayBuffer(n.length),o=new Uint8Array(i),r=0;r<n.length;r++)o[r]=n.charCodeAt(r);return new Blob([i],{type:t})},To.blobToBase64=function(e){return new be.a((function(t){var n=new FileReader;n.addEventListener("load",(function(){t.next(n.result),t.complete()})),n.readAsDataURL(e)}))},To.blobToCanvas=function(e,t){var n=t.width,i=t.height;return new be.a((function(t){var o=document.createElement("canvas");o.width=n,o.height=i;var r=o.getContext("2d"),a=new Image;a.addEventListener("load",(function(){r.drawImage(a,0,0),t.next(o),t.complete()})),a.src=URL.createObjectURL(e)}))};var dr,gr,hr=((dr=function(){function e(t,n,i){m(this,e),this.engineService=t,this.labelsService=n,this.store=i}return v(e,[{key:"localResize",value:function(e,t){var n=Human.renderer.canvas.canvas,i=Human.renderer.canvas.annotationCanvas,o=n.parentNode,r=o.clientWidth,a=o.clientHeight;return o.width=e,o.height=t,n.width=e,n.height=t,i.width=e,i.height=t,o.style.width=e+"px",o.style.height=t+"px",Human.renderer.canvas.init(),Human.renderer.viewportDirty=!0,Human.renderer.camera.updateCanvas(),Human.renderer.postprocess.updateCanvas(),Human.renderer.draw.updateCanvas(),Human.renderer.viewportDirty=!0,Human.renderer.prepareFrame(),Human.renderer.forceRenderFrame(),[r,a]}},{key:"canvasToImage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"original",n=e.width/e.height,i=this.engineService.getCanvas(),o=i.width,r=i.height,a=.5*(i.width-o),s=0;switch(t){case"square":r>o?r=o:o=r,a=.5*(i.width-o),s=.5*(i.height-r);break;case"original":o=n*r}return new be.a((function(t){var n=e.getContext("2d");Human.renderer.forceRenderFrame(),n.drawImage(i,a,s,o,r,0,0,e.width,e.height),t.next(),t.complete()}))}},{key:"canvasToImageWithResize",value:function(e){var t=this,n=this.engineService.getCanvas();n.style.opacity="0",this.store.dispatch(new Je(!1));var i=p(this.localResize(e.width,e.height),2),o=i[0],r=i[1],a=e.getContext("2d");return new be.a((function(e){setTimeout((function(){Human.renderer.viewportDirty=!0,Human.renderer.prepareFrame(),Human.renderer.forceRenderFrame(),a.drawImage(n,0,0,n.width,n.height),t.localResize(o,r),document.getElementById("theCanvas").style.opacity="",t.store.dispatch(new Je(!0)),e.next(),e.complete()}),10)}))}},{key:"drawRadialGradient",value:function(e,t){var n=t.colors,i=p(t.colorStops.map((function(t){return n=t,i=e.width,o=e.height,r=[Math.pow(i/2,2),Math.pow(o/2,2)],a=r[0],s=r[1],n/100*Math.pow(a+s,.5);var n,i,o,r,a,s})),2),o=i[0],r=i[1],a=e.getContext("2d"),s=e.width/2,c=e.height/2,l=a.createRadialGradient(s,c,o,s,c,r);l.addColorStop(t.colorStops[0]/100,"rgba(".concat(n.slice(0,4).join(","),")")),l.addColorStop(t.colorStops[1]/100,"rgba(".concat(n.slice(4,8).join(","),")")),a.fillStyle=l,a.fillRect(0,0,e.width,e.height)}},{key:"drawLinearGradient",value:function(e,t){var n=t.colors,i=e.getContext("2d"),o=e.width/2,r=e.height/2,a=i.createLinearGradient(o,r,o,e.height);a.addColorStop(t.colorStops[0]/100,"rgba(".concat(n.slice(0,4).join(","),")")),a.addColorStop(t.colorStops[1]/100,"rgba(".concat(n.slice(4,8).join(","),")")),i.fillStyle=a,i.fillRect(0,0,e.width,e.height)}},{key:"takeSnapshot",value:function(e,t,n,i,o,r){var a=this,s=r.imageType,l=r.imageQuality,u=r.copyrightEnabled,p=r.crop,d=document.createElement("canvas");d.width=e,d.height=t,"radial"===n.gradientType?this.drawRadialGradient(d,n):"linear"===n.gradientType&&this.drawLinearGradient(d,n);var g=this.engineService.getCanvas(),h=[],f=(d.height>g.height||d.width>g.width?this.canvasToImageWithResize(d):this.canvasToImage(d,p)).pipe(Object(Z.a)((function(){return d})));h.push(f);var b=[],v=this.labelsService.getLabelContainer();return o&&v&&b.push(v.nativeElement),b.push.apply(b,c(i)),h.push.apply(h,c(b.map((function(n){return(n instanceof HTMLCanvasElement?Object(G.a)(n):zo.elementToCanvas(n,!0)).pipe(Object(rr.a)((function(n){return zo.fitCanvas(n,{width:e,height:t})})))})))),Object(or.a)(h).pipe(Object(ar.a)(),Object(Z.a)((function(e){return zo.combineCanvasElements(e)})),Object(rr.a)((function(e){return u?a.writeLogoToCanvas(e,r):Object(G.a)(e)})),Object(rr.a)((function(e){return zo.canvasToBlob(e,s,l)})))}},{key:"writeLogoToCanvas",value:function(e,t){var n=this;return this.getLogoImage(t.copyrightImagePath).pipe(Object(Z.a)((function(i){var o=i.width,r=i.height,a=e.width,s=e.height;.1*a>o&&(r=r/o*(o=.1*a));var c=n.getLogoPosition(a,s,o,r,t),l=c.xOffset,u=c.yOffset;return e.getContext("2d").drawImage(i,l,u,o,r),e})),Object(J.a)((function(){return Object(G.a)(e)})))}},{key:"getLogoImage",value:function(e){return new be.a((function(t){var n=new Image;n.onload=function(){t.next(n),t.complete()},n.onerror=function(){return t.error()},n.src=e}))}},{key:"getLogoPosition",value:function(e,t,n,i,o){var r,a,s=o.copyrightPosition,c=o.copyrightOffset;switch(s.x){case"right":r=e-n;break;case"center":r=e/2-n/2;break;default:r=0}switch(s.y){case"bottom":a=t-i;break;case"center":a=t/2-i/2;break;default:a=0}return{xOffset:r+c.x,yOffset:a+c.y}}}]),e}()).\u0275fac=function(e){return new(e||dr)(P.Zb(Nt),P.Zb(wi),P.Zb(E.g))},dr.\u0275prov=P.Lb({token:dr,factory:dr.\u0275fac,providedIn:"root"}),dr),fr=function e(){m(this,e),this[gr]=!0};gr=immer.immerable;var br,vr,mr={colors:[245,245,245,1,245,245,245,1],gradientType:"radial",colorStops:[0,100]},yr={small:{width:256,height:256},medium:{width:512,height:512},large:{width:1024,height:1024}},xr=function e(){m(this,e),this.firstTime=0,this.lastTime=1},kr=((br=function(){function e(){m(this,e)}return v(e,[{key:"getChapterLocalTimerange",value:function(e){var t=Human.timeline.activeRoot._chapters.find((function(t){return t.id===e}));return Object(te.plainToClass)(xr,t.timeRange)}},{key:"mapGlobalTimeToLocal",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Human.timeline.activeRoot.mapGlobalTime(e,t);return n.time<0&&(n.time=0),n}},{key:"mapLocalTimeToGlobal",value:function(e,t){var n=Human.timeline.activeRoot._chapters.find((function(t){return t.id===e}));return Human.timeline.activeRoot.mapBranchTime(n,t)}},{key:"isChapterAnimated",value:function(e){return e.timelineMap.filter((function(e){return"dummy"!==Object(Se.get)(e,"data.timeline")&&"dummy"!==Object(Se.get)(e,"data.timeline.id")&&"dummy"!==Object(Se.get)(e,"data.timeline.id.id")})).length>0}},{key:"isChapterLooped",value:function(e){return!0===Object(Se.get)(e,"loop")||-1===Object(Se.get)(e,"ui.play.count")}},{key:"scrub",value:function(e){Human.timeline.scrub({time:e.time,borderCondition:{which:e.which?e.which:"first",direction:"forward"}})}},{key:"getTimeFrame",value:function(){return Human.timeline.getTimeFrame()}},{key:"getTime",value:function(){return Human.timeline.time}},{key:"isPlaying",value:function(){return Human.timeline.playing}},{key:"hasChapterFinished",value:function(e){var t=this.getChapterLocalTimerange(e);return this.mapGlobalTimeToLocal(Human.timeline.time).time===t.lastTime}},{key:"play",value:function(e){this.playParams=Object.keys(e).reduce((function(e,t){return void 0===e[t]&&delete e[t],e}),Object.assign({},e)),Human.timeline.play(this.playParams)}},{key:"rewind",value:function(e){var t=this.mapLocalTimeToGlobal(e,0);this.scrub({time:t,which:"second"})}},{key:"unpause",value:function(e){this.hasChapterFinished(e)&&this.rewind(e),Human.timeline.unpause()}},{key:"pause",value:function(){Human.timeline.pause()}}]),e}()).\u0275fac=function(e){return new(e||br)},br.\u0275prov=P.Lb({token:br,factory:br.\u0275fac,providedIn:"root"}),br);!function(e){var t=/(\s*[\d\.]+\s*,){2,15}\s*[\d\.]+\s*/g;function n(e){for(var t=0;t<3;t++)if(parseFloat(""+e[t])>1)return!0;return!1}function i(e){var t=document.createElement("div");t.style.backgroundColor=e,document.documentElement.appendChild(t);var n=window.getComputedStyle(t).backgroundColor.replace(/\s/g,"");return window.document.documentElement.removeChild(t),n}function o(e){var t=e.slice(0,4);3===t.length&&t.push(1);for(var n=0;n<4;n++)t[n]=parseFloat(""+t[n]),t[n]<0&&(t[n]=0),t[n]>255&&(t[n]=255);return t[3]>1&&(t[3]=1),t}function r(e){var n;if(Array.isArray(e))n=o(e);else if("string"==typeof e){var r=e.match(t);r?n=o(r[0].split(",")):(r=i(e).match(t))&&(n=o(r[0].split(",")))}return n}function a(e){var t=r(e);if(!t)throw new TypeError("Invalid color input.");var i=s(t);return{1:n(t)?i:t,255:n(t)?t:i}}function s(e){for(var t=n(e),i=[],o=0;o<3;o++){var r=t?e[o]/255:255*e[o];r=t?Math.round(100*r)/100:Math.round(r),i.push(r)}return 4===e.length&&i.push(e[3]),i}function l(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(function(e,t,n,i){return[t,t,n,n,i,i].join("")})).replace(/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,(function(e,t,n,i){return[t,n,i,"ff"].join("")}));var n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e),i=parseInt(n[1],16),o=parseInt(n[2],16),r=parseInt(n[3],16),a=parseInt(n[4],16)/255;if(t){var s=d([i,o,r]);return[s[0],s[1],s[2],a]}return[i,o,r,a]}function u(e){var t=p(e,3),n=t[0],i=t[1],o=t[2];return Math.sqrt(n*n*.299+i*i*.587+o*o*.114)}function d(e){return e.map((function(e){return e/255}))}function g(e){return e.map((function(e){return Math.round(255*e)}))}function h(e){return"#"+e.map((function(e){var t=e.toString(16);return t.length%2?"0"+t:t})).join("")}e.is255=n,e.isLight=function(e,t){return t||(t=c(e)),(u(e)+u(t))/2>140.25},e.getComputedColor=i,e.convertChannels=o,e.convert=r,e.getColor=a,e.getColors=function(e){var n=[];if("string"==typeof e){var i=e.match(t);i&&(e=i.join(",")),e=e.split(",")}if(Array.isArray(e))if(Array.isArray(e[0])&&Array.isArray(e[1]))n=e;else if(e.length<=2)n=1===e.length?e.concat(e):e;else{var o=Math.floor(e.length/2);n=e.length>4?[e.slice(0,o),e.slice(o)]:[e,e]}return n.map((function(e){return a(e)}))},e.scaleColor=s,e.hexToRgba=l,e.hexToRgb=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=l(e,t);return[n[0],n[1],n[2]]},e.rgbToHex=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return h(t?g(e):e)},e.rgbToHSP=u,e.rgbaToHex=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e[0],i=e[1],o=e[2],r=255*e[3];return h(t?[].concat(c(g([n,i,o])),[r]):[n,i,o,r])},e.rgbToDecimal=d,e.rgbFromDecimal=g}(vr||(vr={}));var wr,Or,Cr,Sr,_r,jr,Pr,Mr=h("5+WD"),Ir=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},zr=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Tr={imageType:vn.JPEG,crop:"original",copyrightEnabled:!1,copyrightImagePath:"assets/images/powered-by-biodigital-color.svg",copyrightPosition:{x:"left",y:"bottom"},copyrightOffset:{x:12,y:-12},imageQuality:1},Ur={loading:!1,chapters:[],chaptersViewed:[],selectedChapter:null,isChapterAnimated:!1,thumbnails:new Map,patches:[],inversePatches:[]},Lr=((Or=wr=function(){function e(t,n,i,o,r){m(this,e),this.chapterService=t,this.snapshotService=n,this.store=i,this.animationService=o,this.engineService=r}return v(e,[{key:"setChapters",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){e.chapters=t.chapters})))}},{key:"SetChapterCameraAction",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){e.chapters.find((function(e){return e.id===t.chapterId})).camera.action=t.cameraAction})))}},{key:"setChapterUI",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){e.chapters.find((function(e){return e.id===t.chapterId})).ui=t.ui})))}},{key:"setChapterInfo",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){e.chapters.find((function(e){return e.id===t.chapterId})).info=t.info})))}},{key:"setChapterLegend",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){e.chapters.find((function(e){return e.id===t.chapterId})).legend=t.legend})))}},{key:"addToChapterLegend",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){e.chapters.find((function(e){return e.id===t.chapterId})).legend.push(t.legend)})))}},{key:"ReorderChapters",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){Object(Mr.c)(e.chapters,t.previousIndex,t.currentIndex)})));var n=e.getState().chapters.map((function(e){return e.id}));e.dispatch(new io.ReorderQuestions(n))}},{key:"SetChapterReadyState",value:function(e,t){var n=immer.produce(e.getState(),(function(e){if(t.chapterId){var n=e.chapters.find((function(e){return e.id===t.chapterId}));n&&(n.readyState=Object.assign(Object.assign({},n.readyState),t.readyState))}}));e.patchState(n)}},{key:"SetChapterPostProcessing",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){var n=e.chapters.find((function(e){return e.id===t.chapterId})),i=n.properties||{};n.customData=Object.assign(Object.assign({},n.customData?n.customData:{}),{postprocess:t.effects}),n.properties=Object.assign(Object.assign({},i),t.properties)})))}},{key:"SetChapterTransitions",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){var n=e.chapters.find((function(e){return e.id===t.chapterId}));n.transitions=n.transitions||{},n.transitions[t.key]=t.transition})))}},{key:"SetChapterTransparencyMode",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){e.chapters.find((function(e){return e.id===t.chapterId})).transparencyMode=t.transparencyMode})))}},{key:"applyChapterPatch",value:function(e,t){var n=immer.applyPatches(e.getState(),t.patches);e.patchState(immer.produce(n,(function(e){e.patches=[],e.inversePatches=[]})))}},{key:"setChapterClippingPlane",value:function(e,t){var n=this,i=p(immer.produceWithPatches(e.getState(),(function(e){var i=e.chapters.find((function(e){return e.id===t.chapterId}));i.clippingPlanes.clips=t.clips,i.clippingPlanes.enabled=t.enabled,i.clippingPlanes.boundary=i.clippingPlanes.boundary||JSON.parse(JSON.stringify(n.engineService.getSceneBoundary()))})),3),o=i[0],r=i[1],a=i[2],s=immer.produce(o,(function(e){var t,n;(t=e.patches).push.apply(t,c(r)),(n=e.inversePatches).push.apply(n,c(a))}));t.record&&e.dispatch(new di.SavePatches([{forward:s.patches,inverse:c(s.inversePatches).reverse(),patchAction:mn}])),e.patchState(t.record?immer.produce(s,(function(e){e.patches=[],e.inversePatches=[]})):s)}},{key:"setChapterBackground",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){e.chapters.find((function(e){return e.id===t.chapterId})).background=t.background})))}},{key:"setAllChaptersBackground",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){e.chapters.forEach((function(e){e.background=t.background}))})))}},{key:"resetSelectedChapterBackground",value:function(e,t){var n=e.getState().selectedChapter;this.store.dispatch(new Fn(n,mr))}},{key:"setSelectedChapterBackground",value:function(e,t){var n=t.background,i=e.getState().selectedChapter;this.store.dispatch(new Fn(i,n))}},{key:"selectChapter",value:function(e,t){if(t.chapter){this.store.dispatch([new pi.UpdateNodesChecked(!1),new pi.UpdateNodeSelected]);var n=this.animationService.isChapterAnimated(t.chapter);this.store.dispatch(new Le(!!t.chapter));var i=immer.produce(e.getState(),(function(e){e.chaptersViewed.some((function(e){return t.chapter.id===e}))||e.chaptersViewed.push(t.chapter.id),e.selectedChapter=t.chapter?t.chapter.id:null,e.isChapterAnimated=n}));e.patchState(i)}}},{key:"selectChapterById",value:function(e,t){var n=t.chapterId;this.store.dispatch(new Le(!0)),e.patchState({selectedChapter:n})}},{key:"duplicateChapter",value:function(e,t){var n=t.chapter,i=this.chapterService.copyChapter(n,t.chapterId),o=e.getState().chapters.length;this.chapterService.addChapterToEngine(Object(Se.cloneDeep)(i),o),e.patchState(immer.produce(e.getState(),(function(e){e.chapters.push(i)}))),e.dispatch(new io.CopyQuestions(n.id,i.id)),e.dispatch(new Ho(n,i)),e.dispatch(new qn(n,i))}},{key:"copyThumbnail",value:function(e,t){if(t.sourceChapter){var n=e.getState().thumbnails,i=immer.produce(e.getState(),(function(e){var i=n.get(t.sourceChapter.id),o=new fr;o.storyId=i.storyId,o.chapterId=i.chapterId,o.urls={small:i.urls.small.replace(t.sourceChapter.id,t.targetChapter.id),large:i.urls.large.replace(t.sourceChapter.id,t.targetChapter.id)},o.snapshot=i.snapshot?i.snapshot:i.urls.large,e.thumbnails.set(t.targetChapter.id,o)}));e.patchState(i)}else e.dispatch(new Wn(t.targetChapter.id,vn.JPEG,92,yr.medium,"square"))}},{key:"nextChapter",value:function(e,t){var n=e.getState().chapters,i=this.chapterService.getCurrentChapterId(),o=0;(o=n.findIndex((function(e){return e.id===i})))<n.length-1&&o++,e.dispatch(new On(n[o]))}},{key:"previousChapter",value:function(e,t){var n=e.getState().chapters,i=this.chapterService.getCurrentChapterId(),o=0;(o=n.findIndex((function(e){return e.id===i})))>0&&o--,e.dispatch(new On(n[o]))}},{key:"lastChapter",value:function(e,t){var n=e.getState().chapters;e.dispatch(new On(n[n.length-1]))}},{key:"firstChapter",value:function(e,t){var n=e.getState().chapters;e.dispatch(new On(n[0]))}},{key:"removeChapter",value:function(e,t){var n=e.getState(),i=n.chapters,o=n.selectedChapter;if(1!==i.length){this.chapterService.removeChapterFromEngine(t.chapter);var r=i.findIndex((function(e){return e.id===t.chapter.id}));if(e.patchState(immer.produce(e.getState(),(function(e){e.chapters.splice(r,1)}))),t.chapter.id===o){var a=e.getState().chapters,s=Math.min(r,a.length-1);e.dispatch(new On(a[s]))}e.dispatch(new Wo(t.chapter))}}},{key:"resetStoryChaptersState",value:function(e,t){e.setState(Ur)}},{key:"registerChapterThumbnails",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){e.thumbnails=new Map(t.thumbnails)})))}},{key:"takeChapterPicture",value:function(e,t){var n,i=this,o=t.chapterId,r=t.includeLabels,a=t.includeCopyright,s=t.dimensions,c=t.imageType,l=t.imageQuality,u=t.crop,p=t.layers,d=s||yr.large,g=d.width,h=d.height,f=this.store.selectSnapshot(wr.getSelectedChapterBackground);switch(c){case vn.PNG:n=f||mr;break;case vn.JPEG:default:n=f&&!ai.isTransparent(f)?f:mr}var b=f.colors.slice(0,3),v=vr.isLight(b),m=Object.assign(Object.assign({},Tr),{crop:u,imageType:c,imageQuality:l,copyrightEnabled:a,copyrightImagePath:v?"assets/images/powered-by-biodigital-color.svg":"assets/images/powered-by-biodigital-white.svg"});setTimeout((function(){i.snapshotService.takeSnapshot(g,h,n,p,r,m).subscribe((function(t){e.dispatch(new $n(o,t,d))}))}))}},{key:"takeChapterPictureSuccess",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){var n=e.thumbnails.get(t.chapterId)||new fr;n.snapshot=URL.createObjectURL(t.blob),e.thumbnails.set(t.chapterId,n)})))}},{key:"RecordCamera",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){e.chapters.find((function(e){return e.id===t.chapterId})).camera.location=t.camera})))}},{key:"setChapterCurrentLayersIndexPosition",value:function(e,t){var n=p(immer.produceWithPatches(e.getState(),(function(e){var n=e.chapters.find((function(e){return e.id===t.chapterId})).visibilityLayers.current;n.index=t.index,n.position=t.position})),3),i=n[0],o=n[1],r=n[2],a=immer.produce(i,(function(e){var t,n;(t=e.patches).push.apply(t,c(o)),(n=e.inversePatches).push.apply(n,c(r))}));e.patchState(a),t.record&&e.dispatch(new di.SavePatches([{forward:a.patches,inverse:a.inversePatches,patchAction:mn}]))}},{key:"setChapterMedia",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){e.chapters.find((function(e){return e.id===t.chapterId})).media=t.media})))}},{key:"setChapterContentBlocks",value:function(e,t){t.contentBlocks=[].concat(c(t.contentBlocks.filter((function(e){return e.type===so.Ticker}))),c(t.contentBlocks.filter((function(e){return e.type!==so.Ticker})))),e.patchState(immer.produce(e.getState(),(function(e){e.chapters.find((function(e){return e.id===t.chapterId})).contentBlocks=t.contentBlocks})))}}],[{key:"getStoryChapters",value:function(e){return e.chapters}},{key:"getChaptersViewed",value:function(e){return e.chaptersViewed}},{key:"getChapter",value:function(e){return Object(E.h)([wr],(function(t){return t.chapters.find((function(t){return t.id===e}))}))}},{key:"getSelectedChapterId",value:function(e){return e.selectedChapter}},{key:"getSelectedChapter",value:function(e){return e.chapters.find((function(t){return t.id===e.selectedChapter}))||null}},{key:"getNextChapter",value:function(e){var t=1+wr.getSelectedChapterIndex(e);return e.chapters[t]}},{key:"getPreviousChapter",value:function(e){var t=-1+wr.getSelectedChapterIndex(e);return e.chapters[t]}},{key:"getSelectedChapterIndex",value:function(e){return e.chapters.findIndex((function(t){return t.id===e.selectedChapter}))}},{key:"getSelectedChapterTitle",value:function(e){return e.chapters.find((function(t){return t.id===e.selectedChapter})).info.displayName}},{key:"getChapterCount",value:function(e){return e.chapters.length}},{key:"getRegisteredThumbnails",value:function(e){return e.thumbnails}},{key:"getIsChapterAnimated",value:function(e){return e.isChapterAnimated}},{key:"getSelectedChapterReadyState",value:function(e){var t=e.chapters,n=e.selectedChapter,i=wr.findChapter(t,n);return Object(Se.get)(i,"readyState")}},{key:"getChaptersLoaded",value:function(e){return{count:e.chapters.length,modelChapters:e.chapters.filter((function(e){return e.readyState.model})),animationChapters:e.chapters.filter((function(e){return e.readyState.animation}))}}},{key:"getAllChaptersModelsReady",value:function(e){return e.chapters.length>0&&e.chapters.every((function(e){return e.readyState.model}))}},{key:"getAllChaptersAnimationsReady",value:function(e){return e.chapters.length>0&&e.chapters.every((function(e){return e.readyState.animation}))}},{key:"getSelectedChapterBackground",value:function(e){var t=e.chapters,n=e.selectedChapter,i=wr.findChapter(t,n);return Object(Se.get)(i,"background")||mr}},{key:"getAllChaptersBackground",value:function(e){return e.chapters.map((function(e){return Object(Se.get)(e,"background")}))}},{key:"getSelectedChapterAudio",value:function(e){var t=e.chapters.find((function(t){return t.id===e.selectedChapter}));return t&&t.media?Object.values(t.media).filter((function(e){return"audio"===e.data.streamType}))[0]:null}},{key:"getSelectedChapterLegend",value:function(e){var t=e.chapters,n=e.selectedChapter,i=wr.findChapter(t,n);return Object(Se.get)(i,"legend")||[]}},{key:"getSelectedChapterClippingPlanes",value:function(e){var t=e.chapters,n=e.selectedChapter,i=wr.findChapter(t,n);return Object(Se.get)(i,"clippingPlanes")}},{key:"getChapterCamera",value:function(e){var t=e.chapters,n=e.selectedChapter,i=wr.findChapter(t,n);return Object(Se.get)(i,"camera.location")}},{key:"findChapter",value:function(e,t){return e.find((function(e){return e.id===t}))}},{key:"getAllChaptersCurrentLayers",value:function(e){return e.chapters.map((function(e){return Object(Se.get)(e,"visibilityLayers.current.layers",[])}))}},{key:"getSelectedChapterSrcLayers",value:function(e){var t=e.chapters,n=e.selectedChapter,i=wr.findChapter(t,n);return Object(Se.get)(i,"visibilityLayers.src.layers",[])}},{key:"getSelectedChapterCurrentLayers",value:function(e){var t=e.chapters,n=e.selectedChapter,i=wr.findChapter(t,n);return Object(Se.get)(i,"visibilityLayers.current.layers",[])}},{key:"getSelectedChapterCurrentLayersIndex",value:function(e){var t=e.chapters,n=e.selectedChapter,i=wr.findChapter(t,n);return Object(Se.get)(i,"visibilityLayers.current.index")}},{key:"getSelectedChapterCurrentLayersPosition",value:function(e){var t=e.chapters,n=e.selectedChapter,i=wr.findChapter(t,n);return Object(Se.get)(i,"visibilityLayers.current.position")}},{key:"getSelectedChapterContentBlocks",value:function(e){var t=e.chapters,n=e.selectedChapter,i=wr.findChapter(t,n);return Object(Se.get)(i,"contentBlocks",[])}}]),e}()).\u0275fac=function(e){return new(e||Or)(P.Zb(Eo),P.Zb(hr),P.Zb(E.g),P.Zb(kr),P.Zb(Nt))},Or.\u0275prov=P.Lb({token:Or,factory:Or.\u0275fac}),Ir([Object(E.a)(Sn),zr("design:type",Function),zr("design:paramtypes",[Object,Sn]),zr("design:returntype",void 0)],Or.prototype,"setChapters",null),Ir([Object(E.a)(_n),zr("design:type",Function),zr("design:paramtypes",[Object,_n]),zr("design:returntype",void 0)],Or.prototype,"SetChapterCameraAction",null),Ir([Object(E.a)(jn),zr("design:type",Function),zr("design:paramtypes",[Object,jn]),zr("design:returntype",void 0)],Or.prototype,"setChapterUI",null),Ir([Object(E.a)(Pn),zr("design:type",Function),zr("design:paramtypes",[Object,Pn]),zr("design:returntype",void 0)],Or.prototype,"setChapterInfo",null),Ir([Object(E.a)(Mn),zr("design:type",Function),zr("design:paramtypes",[Object,Mn]),zr("design:returntype",void 0)],Or.prototype,"setChapterLegend",null),Ir([Object(E.a)(In),zr("design:type",Function),zr("design:paramtypes",[Object,In]),zr("design:returntype",void 0)],Or.prototype,"addToChapterLegend",null),Ir([Object(E.a)(zn),zr("design:type",Function),zr("design:paramtypes",[Object,zn]),zr("design:returntype",void 0)],Or.prototype,"ReorderChapters",null),Ir([Object(E.a)(Tn),zr("design:type",Function),zr("design:paramtypes",[Object,Tn]),zr("design:returntype",void 0)],Or.prototype,"SetChapterReadyState",null),Ir([Object(E.a)(Un),zr("design:type",Function),zr("design:paramtypes",[Object,Un]),zr("design:returntype",void 0)],Or.prototype,"SetChapterPostProcessing",null),Ir([Object(E.a)(Ln),zr("design:type",Function),zr("design:paramtypes",[Object,Ln]),zr("design:returntype",void 0)],Or.prototype,"SetChapterTransitions",null),Ir([Object(E.a)(Dn),zr("design:type",Function),zr("design:paramtypes",[Object,Dn]),zr("design:returntype",void 0)],Or.prototype,"SetChapterTransparencyMode",null),Ir([Object(E.a)(mn),zr("design:type",Function),zr("design:paramtypes",[Object,mn]),zr("design:returntype",void 0)],Or.prototype,"applyChapterPatch",null),Ir([Object(E.a)(En),zr("design:type",Function),zr("design:paramtypes",[Object,En]),zr("design:returntype",void 0)],Or.prototype,"setChapterClippingPlane",null),Ir([Object(E.a)(Fn),zr("design:type",Function),zr("design:paramtypes",[Object,Fn]),zr("design:returntype",void 0)],Or.prototype,"setChapterBackground",null),Ir([Object(E.a)(An),zr("design:type",Function),zr("design:paramtypes",[Object,An]),zr("design:returntype",void 0)],Or.prototype,"setAllChaptersBackground",null),Ir([Object(E.a)(Rn),zr("design:type",Function),zr("design:paramtypes",[Object,Rn]),zr("design:returntype",void 0)],Or.prototype,"resetSelectedChapterBackground",null),Ir([Object(E.a)(Vn),zr("design:type",Function),zr("design:paramtypes",[Object,Object]),zr("design:returntype",void 0)],Or.prototype,"setSelectedChapterBackground",null),Ir([Object(E.a)(On),zr("design:type",Function),zr("design:paramtypes",[Object,On]),zr("design:returntype",void 0)],Or.prototype,"selectChapter",null),Ir([Object(E.a)(Cn),zr("design:type",Function),zr("design:paramtypes",[Object,Object]),zr("design:returntype",void 0)],Or.prototype,"selectChapterById",null),Ir([Object(E.a)(Nn),zr("design:type",Function),zr("design:paramtypes",[Object,Nn]),zr("design:returntype",void 0)],Or.prototype,"duplicateChapter",null),Ir([Object(E.a)(qn),zr("design:type",Function),zr("design:paramtypes",[Object,qn]),zr("design:returntype",void 0)],Or.prototype,"copyThumbnail",null),Ir([Object(E.a)(yn),zr("design:type",Function),zr("design:paramtypes",[Object,yn]),zr("design:returntype",void 0)],Or.prototype,"nextChapter",null),Ir([Object(E.a)(xn),zr("design:type",Function),zr("design:paramtypes",[Object,xn]),zr("design:returntype",void 0)],Or.prototype,"previousChapter",null),Ir([Object(E.a)(wn),zr("design:type",Function),zr("design:paramtypes",[Object,wn]),zr("design:returntype",void 0)],Or.prototype,"lastChapter",null),Ir([Object(E.a)(kn),zr("design:type",Function),zr("design:paramtypes",[Object,wn]),zr("design:returntype",void 0)],Or.prototype,"firstChapter",null),Ir([Object(E.a)(Bn),zr("design:type",Function),zr("design:paramtypes",[Object,Bn]),zr("design:returntype",void 0)],Or.prototype,"removeChapter",null),Ir([Object(E.a)(Hn),zr("design:type",Function),zr("design:paramtypes",[Object,Hn]),zr("design:returntype",void 0)],Or.prototype,"resetStoryChaptersState",null),Ir([Object(E.a)(Qn),zr("design:type",Function),zr("design:paramtypes",[Object,Qn]),zr("design:returntype",void 0)],Or.prototype,"registerChapterThumbnails",null),Ir([Object(E.a)(Wn),zr("design:type",Function),zr("design:paramtypes",[Object,Wn]),zr("design:returntype",void 0)],Or.prototype,"takeChapterPicture",null),Ir([Object(E.a)($n),zr("design:type",Function),zr("design:paramtypes",[Object,$n]),zr("design:returntype",void 0)],Or.prototype,"takeChapterPictureSuccess",null),Ir([Object(E.a)(Kn),zr("design:type",Function),zr("design:paramtypes",[Object,Kn]),zr("design:returntype",void 0)],Or.prototype,"RecordCamera",null),Ir([Object(E.a)(Gn),zr("design:type",Function),zr("design:paramtypes",[Object,Gn]),zr("design:returntype",void 0)],Or.prototype,"setChapterCurrentLayersIndexPosition",null),Ir([Object(E.a)(Zn),zr("design:type",Function),zr("design:paramtypes",[Object,Zn]),zr("design:returntype",void 0)],Or.prototype,"setChapterMedia",null),Ir([Object(E.a)(Jn),zr("design:type",Function),zr("design:paramtypes",[Object,Jn]),zr("design:returntype",void 0)],Or.prototype,"setChapterContentBlocks",null),Ir([Object(E.e)(),zr("design:type",Function),zr("design:paramtypes",[bn]),zr("design:returntype",void 0)],Or,"getStoryChapters",null),Ir([Object(E.e)(),zr("design:type",Function),zr("design:paramtypes",[bn]),zr("design:returntype",void 0)],Or,"getChaptersViewed",null),Ir([Object(E.e)(),zr("design:type",Function),zr("design:paramtypes",[bn]),zr("design:returntype",void 0)],Or,"getSelectedChapterId",null),Ir([Object(E.e)(),zr("design:type",Function),zr("design:paramtypes",[bn]),zr("design:returntype",void 0)],Or,"getSelectedChapter",null),Ir([Object(E.e)(),zr("design:type",Function),zr("design:paramtypes",[bn]),zr("design:returntype",void 0)],Or,"getNextChapter",null),Ir([Object(E.e)(),zr("design:type",Function),zr("design:paramtypes",[bn]),zr("design:returntype",void 0)],Or,"getPreviousChapter",null),Ir([Object(E.e)(),zr("design:type",Function),zr("design:paramtypes",[bn]),zr("design:returntype",void 0)],Or,"getSelectedChapterIndex",null),Ir([Object(E.e)(),zr("design:type",Function),zr("design:paramtypes",[bn]),zr("design:returntype",void 0)],Or,"getSelectedChapterTitle",null),Ir([Object(E.e)(),zr("design:type",Function),zr("design:paramtypes",[bn]),zr("design:returntype",void 0)],Or,"getChapterCount",null),Ir([Object(E.e)(),zr("design:type",Function),zr("design:paramtypes",[bn]),zr("design:returntype",void 0)],Or,"getRegisteredThumbnails",null),Ir([Object(E.e)(),zr("design:type",Function),zr("design:paramtypes",[bn]),zr("design:returntype",void 0)],Or,"getIsChapterAnimated",null),Ir([Object(E.e)(),zr("design:type",Function),zr("design:paramtypes",[bn]),zr("design:returntype",void 0)],Or,"getSelectedChapterReadyState",null),Ir([Object(E.e)(),zr("design:type",Function),zr("design:paramtypes",[bn]),zr("design:returntype",void 0)],Or,"getChaptersLoaded",null),Ir([Object(E.e)(),zr("design:type",Function),zr("design:paramtypes",[bn]),zr("design:returntype",void 0)],Or,"getAllChaptersModelsReady",null),Ir([Object(E.e)(),zr("design:type",Function),zr("design:paramtypes",[bn]),zr("design:returntype",void 0)],Or,"getAllChaptersAnimationsReady",null),Ir([Object(E.e)(),zr("design:type",Function),zr("design:paramtypes",[bn]),zr("design:returntype",void 0)],Or,"getSelectedChapterBackground",null),Ir([Object(E.e)(),zr("design:type",Function),zr("design:paramtypes",[bn]),zr("design:returntype",void 0)],Or,"getAllChaptersBackground",null),Ir([Object(E.e)(),zr("design:type",Function),zr("design:paramtypes",[bn]),zr("design:returntype",void 0)],Or,"getSelectedChapterAudio",null),Ir([Object(E.e)(),zr("design:type",Function),zr("design:paramtypes",[bn]),zr("design:returntype",void 0)],Or,"getSelectedChapterLegend",null),Ir([Object(E.e)(),zr("design:type",Function),zr("design:paramtypes",[bn]),zr("design:returntype",void 0)],Or,"getSelectedChapterClippingPlanes",null),Ir([Object(E.e)(),zr("design:type",Function),zr("design:paramtypes",[bn]),zr("design:returntype",void 0)],Or,"getChapterCamera",null),Ir([Object(E.e)(),zr("design:type",Function),zr("design:paramtypes",[bn]),zr("design:returntype",Array)],Or,"getAllChaptersCurrentLayers",null),Ir([Object(E.e)(),zr("design:type",Function),zr("design:paramtypes",[bn]),zr("design:returntype",Array)],Or,"getSelectedChapterSrcLayers",null),Ir([Object(E.e)(),zr("design:type",Function),zr("design:paramtypes",[bn]),zr("design:returntype",Array)],Or,"getSelectedChapterCurrentLayers",null),Ir([Object(E.e)(),zr("design:type",Function),zr("design:paramtypes",[bn]),zr("design:returntype",Number)],Or,"getSelectedChapterCurrentLayersIndex",null),Ir([Object(E.e)(),zr("design:type",Function),zr("design:paramtypes",[bn]),zr("design:returntype",Number)],Or,"getSelectedChapterCurrentLayersPosition",null),Ir([Object(E.e)(),zr("design:type",Function),zr("design:paramtypes",[bn]),zr("design:returntype",Array)],Or,"getSelectedChapterContentBlocks",null),Or=wr=Ir([Object(E.f)({name:"storyChapters",defaults:Ur})],Or)),Dr=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},Er=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Fr={storedCameras:{},cameraMotion:new hn,panMode:"rotate",zoomed:!1,lockCamera:!1,cameraFlyTo:void 0},Ar=((Sr=Cr=function(){function e(t,n){m(this,e),this.cameraService=t,this.store=n}return v(e,[{key:"storeCamera",value:function(e,t){var n=t.camera||this.cameraService.getCamera(),i=e.getState().storedCameras;i[t.id]=Object.assign({},n),e.patchState({storedCameras:Object.assign({},i)})}},{key:"clearCamera",value:function(e,t){var n=e.getState().storedCameras;delete n[t.id],e.patchState({storedCameras:Object.assign({},n)})}},{key:"setCameraFlyTo",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){e.cameraFlyTo=t.camera})))}},{key:"applyCameraPatch",value:function(e,t){var n=immer.applyPatches(e.getState(),t.patches);e.patchState(n);var i=void 0===n.cameraFlyTo?this.store.selectSnapshot(Lr.getChapterCamera):n.cameraFlyTo;e.dispatch(new $t(i,!0,1))}},{key:"moveCamera",value:function(e,t){e.patchState({cameraMotion:Object.assign({},t.cameraMotion)})}},{key:"resetCamera",value:function(e,t){return this.cameraService.resetCamera().pipe(Object(fn.a)((function(){e.patchState({cameraMotion:new hn})})))}},{key:"zoomCamera",value:function(e,t){var n=e.getState().cameraMotion;n.zoom=t.value,e.patchState({cameraMotion:Object.assign({},n)})}},{key:"panCameraX",value:function(e,t){var n=e.getState().cameraMotion;n.panX=t.value,e.patchState({cameraMotion:Object.assign({},n)})}},{key:"panCameraY",value:function(e,t){var n=e.getState().cameraMotion;n.panY=t.value,e.patchState({cameraMotion:Object.assign({},n)})}},{key:"rotateCameraX",value:function(e,t){var n=e.getState().cameraMotion;e.patchState({cameraMotion:Object.assign(Object.assign({},n),{rotateX:t.value})})}},{key:"rotateCameraY",value:function(e,t){var n=e.getState().cameraMotion;n.rotateY=t.value,e.patchState({cameraMotion:Object.assign({},n)})}},{key:"SetCameraMode",value:function(e,t){e.patchState({panMode:t.mode})}},{key:"setZoomed",value:function(e,t){e.patchState({zoomed:t.zoomed})}},{key:"lockCamera",value:function(e,t){e.patchState({lockCamera:t.lock})}}],[{key:"getStoredCamera",value:function(e){return Object(E.h)([Cr],(function(t){return t.storedCameras[e]||null}))}},{key:"getCameraMotion",value:function(e){return e.cameraMotion}},{key:"getPanMode",value:function(e){return e.panMode}},{key:"getZoomed",value:function(e){return e.zoomed}},{key:"getLockCamera",value:function(e){return e.lockCamera}}]),e}()).\u0275fac=function(e){return new(e||Sr)(P.Zb(gn),P.Zb(E.g))},Sr.\u0275prov=P.Lb({token:Sr,factory:Sr.\u0275fac}),Dr([Object(E.a)(Wt),Er("design:type",Function),Er("design:paramtypes",[Object,Wt]),Er("design:returntype",void 0)],Sr.prototype,"storeCamera",null),Dr([Object(E.a)(qt),Er("design:type",Function),Er("design:paramtypes",[Object,qt]),Er("design:returntype",void 0)],Sr.prototype,"clearCamera",null),Dr([Object(E.a)(ln),Er("design:type",Function),Er("design:paramtypes",[Object,ln]),Er("design:returntype",void 0)],Sr.prototype,"setCameraFlyTo",null),Dr([Object(E.a)(un),Er("design:type",Function),Er("design:paramtypes",[Object,un]),Er("design:returntype",void 0)],Sr.prototype,"applyCameraPatch",null),Dr([Object(E.a)(Gt),Er("design:type",Function),Er("design:paramtypes",[Object,Gt]),Er("design:returntype",void 0)],Sr.prototype,"moveCamera",null),Dr([Object(E.a)(Zt),Er("design:type",Function),Er("design:paramtypes",[Object,Zt]),Er("design:returntype",void 0)],Sr.prototype,"resetCamera",null),Dr([Object(E.a)(Jt),Er("design:type",Function),Er("design:paramtypes",[Object,Jt]),Er("design:returntype",void 0)],Sr.prototype,"zoomCamera",null),Dr([Object(E.a)(Yt),Er("design:type",Function),Er("design:paramtypes",[Object,Yt]),Er("design:returntype",void 0)],Sr.prototype,"panCameraX",null),Dr([Object(E.a)(en),Er("design:type",Function),Er("design:paramtypes",[Object,en]),Er("design:returntype",void 0)],Sr.prototype,"panCameraY",null),Dr([Object(E.a)(nn),Er("design:type",Function),Er("design:paramtypes",[Object,nn]),Er("design:returntype",void 0)],Sr.prototype,"rotateCameraX",null),Dr([Object(E.a)(on),Er("design:type",Function),Er("design:paramtypes",[Object,on]),Er("design:returntype",void 0)],Sr.prototype,"rotateCameraY",null),Dr([Object(E.a)(an),Er("design:type",Function),Er("design:paramtypes",[Object,an]),Er("design:returntype",void 0)],Sr.prototype,"SetCameraMode",null),Dr([Object(E.a)(sn),Er("design:type",Function),Er("design:paramtypes",[Object,sn]),Er("design:returntype",void 0)],Sr.prototype,"setZoomed",null),Dr([Object(E.a)(cn),Er("design:type",Function),Er("design:paramtypes",[Object,cn]),Er("design:returntype",void 0)],Sr.prototype,"lockCamera",null),Dr([Object(E.e)(),Er("design:type",Function),Er("design:paramtypes",[Qt]),Er("design:returntype",void 0)],Sr,"getCameraMotion",null),Dr([Object(E.e)(),Er("design:type",Function),Er("design:paramtypes",[Qt]),Er("design:returntype",void 0)],Sr,"getPanMode",null),Dr([Object(E.e)(),Er("design:type",Function),Er("design:paramtypes",[Qt]),Er("design:returntype",void 0)],Sr,"getZoomed",null),Dr([Object(E.e)(),Er("design:type",Function),Er("design:paramtypes",[Qt]),Er("design:returntype",void 0)],Sr,"getLockCamera",null),Sr=Cr=Dr([Object(E.f)({name:"engineCamera",defaults:Fr})],Sr)),Rr=function(e){return e.Select="Select",e.Hide="Hide",e.Paint="Paint",e.Label="Label",e.Isolate="Isolate",e.Fade="Fade",e.Position="Position",e.Quiz="Quiz",e}({}),Vr=function(e){return e.Capture="capture",e.DoNotCaptureShowMessage="do_not_capture_show_message",e.DoNotCapture="do_not_capture",e}({}),Nr=h("z6cu"),Br=((_r=function(){function e(t){m(this,e),this.http=t,this.wikiCache=new Map}return v(e,[{key:"getWikiText",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(n&&this.wikiCache.has(e)){var i=this.wikiCache.get(e);return Object(G.a)(i)}return U.offline?Object(G.a)(""):this.http.get("/search/wiki?name="+e).pipe(Object(Z.a)((function(e){return e.description})),Object(J.a)((function(e){return 404===e.status?Object(G.a)(""):Object(Nr.a)(e)})),Object(fn.a)((function(n){return t.wikiCache.set(e,n)})))}}]),e}()).\u0275fac=function(e){return new(e||_r)(P.Zb(K.b))},_r.\u0275prov=P.Lb({token:_r,factory:_r.\u0275fac,providedIn:"root"}),_r),Hr=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},Qr=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},qr=new Bt(0,0,0,0,Ht.Hidden),Wr=((Pr=jr=function(){function e(t,n,i,o,r){m(this,e),this.store=t,this.graphService=n,this.engineService=i,this.wikiService=o,this.animationService=r}return v(e,[{key:"load",value:function(e,t){e.dispatch(new Me("engine"))}},{key:"loadSuccess",value:function(e,t){(0,e.patchState)({engine:t.result})}},{key:"setReady",value:function(e,t){e.patchState({ready:t.ready})}},{key:"setDisplay",value:function(e,t){e.patchState({display:t.display})}},{key:"setZoomViaScrollAllowed",value:function(e,t){e.patchState({scrollMode:t.scrollMode})}},{key:"setVisible",value:function(e,t){e.patchState({visible:t.visible})}},{key:"setEnginePosition",value:function(e,t){e.patchState({enginePosition:Object.assign(Object.assign({},t.position),{right:t.position.left+t.position.width,bottom:t.position.top+t.position.height})})}},{key:"resetEnginePosition",value:function(e,t){e.patchState({enginePosition:qr})}},{key:"setChapter",value:function(e,t){e.patchState({chapter:t.chapterId})}},{key:"setChapterInit",value:function(e,t){e.patchState({chapterInit:t.chapterInit})}},{key:"setActiveTool",value:function(e,t){e.patchState({activeTool:t.tool})}},{key:"setGraph",value:function(e,t){e.patchState({viewGraph:Object.assign({},t.graph)})}},{key:"clearGraph",value:function(e,t){e.patchState({viewGraph:{nodes:{},successors:{},predecessors:{},roots:{}}})}},{key:"setXrayMode",value:function(e,t){e.patchState({xrayModeEnabled:t.enabled})}},{key:"centerCameraOnVisible",value:function(e,t){var n=this.engineService.getVisibleLeaves(),i=this.engineService.getBoundaryFromObjects(n),o=this.engineService.getCameraLookAt();o.look={x:(i.xmin+i.xmax)/2,y:(i.ymin+i.ymax)/2,z:(i.zmin+i.zmax)/2},Human.renderer.camera.fly.flyTo(o)}},{key:"toggleProgressBar",value:function(e,t){e.patchState({showProgressBar:t.show})}},{key:"toggleCameraBar",value:function(e,t){e.patchState({showCameraBar:t.show})}},{key:"toggleLabels",value:function(e,t){var n=null!=t.show?t.show:!e.getState().showLabels;e.patchState({showLabels:n})}},{key:"synchronizeVisibleNodes",value:function(e,t){var n=this,i=e.getState().viewGraph,o=this.stateMapToNodeIds(i,t.leafVisibilityState),r={};o.forEach((function(e){var i=n.engineService.getLeafObjects(e).reduce((function(e,n){return e||t.nodes[n].shown}),!1);r[e]={shown:i}})),this.graphService.synchronize(Object.assign({},i),{shown:"trueWins"},r),e.patchState({viewGraph:Object.assign({},i)})}},{key:"synchronizeRenderableNodes",value:function(e,t){var n=e.getState().viewGraph,i=this.stateMapToNodeIds(n,t.leafRenderableState),o={};i.forEach((function(e){o[e]={renderable:!0}})),this.graphService.synchronize(n,{renderable:"falseWins"},o)}},{key:"synchronizePickableNodes",value:function(e,t){var n=this,i=e.getState().viewGraph,o=this.stateMapToNodeIds(i,t.leafPickableState),r={};o.forEach((function(e){var t=n.engineService.getLeafObjects(e).reduce((function(e,t){return e||Human.scene.objects[t].pickable}),!1);r[e]={pickable:t}})),this.graphService.synchronize(i,{pickable:"trueWins"},r),e.patchState({viewGraph:Object.assign({},i)})}},{key:"playChapterAnimation",value:function(e,t){var n=this.store.selectSnapshot(Lr.getSelectedChapter),i=Object(Se.get)(n,"ui.play.count",0);this.animationService.play({startChapterId:n.id,loop:-1===i,numChapters:1,queue:!1}),e.getState().animationPlaying||this.animationService.pause()}},{key:"toggleAnimation",value:function(e,t){var n=this.store.selectSnapshot(Lr.getSelectedChapterId);t.play?this.animationService.unpause(n):this.animationService.pause()}},{key:"setAnimationPlaying",value:function(e,t){e.patchState({animationPlaying:t.playing})}},{key:"setPlaybackSpeed",value:function(e,t){e.patchState({playbackSpeed:t.speed})}},{key:"playAudio",value:function(e,t){e.patchState({playAudio:t.play})}},{key:"setAutoplay",value:function(e,t){e.patchState({autoplay:t.enable})}},{key:"setObjectLayerOrder",value:function(e,t){var n=this,i=e.getState().viewGraph,o=isNaN(t.layer)?0:t.layer,r=[];t.nodes.forEach((function(e){var t=n.graphService.getDescendants(i,e.id,!0);r=r.concat(t)})),r.forEach((function(e){n.engineService.setObjectLayer(e,o),n.graphService.setState(i,e,{layer:o})})),e.patchState({viewGraph:Object.assign({},i)})}},{key:"setObjectDisplayName",value:function(e,t){var n=Human.scene.objects[t.nodeId];n&&(n.displayName=t.displayName)}},{key:"autoSortObjectLayers",value:function(e,t){var n=this,i=e.getState().viewGraph,o=0,r=Human.scene.getEnabledLeaves(),a=this.engineService.getObjectLayerValues(r);Object.keys(a).map((function(e){return parseInt(e,10)})).sort((function(e,t){return e-t})).forEach((function(e){a[e].sort((function(e,t){return t.value-e.value})).forEach((function(e){var t=20*o;n.engineService.setObjectLayer(e.nodeId,t),n.graphService.setState(i,e.nodeId,{layer:t}),o++}))})),e.patchState({viewGraph:Object.assign({},i)})}},{key:"resetObjectLayers",value:function(e,t){var n=this,i=e.getState().viewGraph;Human.scene.getEnabledLeaves().forEach((function(e){n.engineService.setObjectLayer(e,0),n.graphService.setState(i,e,{layer:0})})),e.patchState({viewGraph:Object.assign({},i)})}},{key:"setPostProcessingEffects",value:function(e,t){var n=t.effects;this.engineService.setPostProcessingFeatures(n)}},{key:"setProperties",value:function(e,t){var n=t.properties;this.engineService.setProperties(Object.assign({},n))}},{key:"setTransparencyMode",value:function(e,t){var n=t.mode;this.engineService.setTransparencyMode(n)}},{key:"expandNode",value:function(e,t){var n=this.store.selectSnapshot(jr.getViewGraph);ke.getAncestors(n,t.node.id,!0).forEach((function(e){n.nodes[e].boolState.expanded=!0})),this.store.dispatch(new Fe(n))}},{key:"collapseNode",value:function(e,t){var n=this.store.selectSnapshot(jr.getViewGraph);n.nodes[t.node.id].boolState.expanded=!1,this.store.dispatch(new Fe(n))}},{key:"hoverNode",value:function(e,t){e.patchState({hoveredNode:t.node})}},{key:"setLabelEditNode",value:function(e,t){e.patchState({labelEditNode:t.node})}},{key:"queryNodeInfo",value:function(e,t){var n=t.node;e.patchState({queryingWiki:!0}),this.wikiService.getWikiText(n.label).pipe(Object(se.a)((function(){return e.patchState({queryingWiki:!1})}))).subscribe((function(t){return e.dispatch(new kt(n,t))}),(function(){return e.dispatch(new wt(n))}))}},{key:"queryNodeInfoSuccess",value:function(e,t){var n=t.node,i=t.description;e.dispatch(new yt(n,i))}},{key:"setNodeInfo",value:function(e,t){var n=t.node,i=t.description,o=this.store.selectSnapshot(jr.getViewGraph),r=o.nodes[n.id];r&&(r.description=i,this.store.dispatch(new Fe(o)))}},{key:"setContextMenu",value:function(e,t){e.patchState({contextmenu:{node:t.node,hit:t.hit}})}},{key:"stateMapToNodeIds",value:function(e,t){var n=this,i=Object.keys(t).map((function(t){return n.engineService.getNode(e,t)})).filter((function(e){return!!e})).map((function(e){return e.id}));return new Set(i)}}],[{key:"getEngine",value:function(e){return e.engine}},{key:"getReady",value:function(e){return e.ready}},{key:"getDisplay",value:function(e){return e.display}},{key:"getScrollMode",value:function(e){return e.scrollMode}},{key:"getVisible",value:function(e){return e.visible}},{key:"getViewGraph",value:function(e){return e.viewGraph}},{key:"getViewGraphNode",value:function(e){return function(t){return e.viewGraph.nodes[t]}}},{key:"getEnginePosition",value:function(e){return e.enginePosition}},{key:"getChapter",value:function(e){return e.chapter}},{key:"getActiveTool",value:function(e){return e.activeTool}},{key:"getShowCameraBar",value:function(e){return e.showCameraBar}},{key:"getShowProgressBar",value:function(e){return e.showProgressBar}},{key:"getShowLabels",value:function(e){return e.showLabels}},{key:"getChapterInit",value:function(e){return e.chapterInit}},{key:"getAnimationPlaying",value:function(e){return e.animationPlaying}},{key:"getPlayAudio",value:function(e){return e.playAudio}},{key:"getAutoplay",value:function(e){return e.autoplay}},{key:"getXrayModeEnabled",value:function(e){return e.xrayModeEnabled}},{key:"getHoveredNode",value:function(e){return e.hoveredNode}},{key:"getLabelEditNode",value:function(e){return e.labelEditNode}},{key:"getQuerying",value:function(e){return e.queryingWiki}},{key:"getContextmenu",value:function(e){return e.contextmenu}},{key:"getPlaybackSpeed",value:function(e){return e.playbackSpeed}}]),e}()).\u0275fac=function(e){return new(e||Pr)(P.Zb(E.g),P.Zb(Ut),P.Zb(Nt),P.Zb(Br),P.Zb(kr))},Pr.\u0275prov=P.Lb({token:Pr,factory:Pr.\u0275fac}),Hr([Object(E.a)(Pe),Qr("design:type",Function),Qr("design:paramtypes",[Object,Pe]),Qr("design:returntype",void 0)],Pr.prototype,"load",null),Hr([Object(E.a)(Me),Qr("design:type",Function),Qr("design:paramtypes",[Object,Me]),Qr("design:returntype",void 0)],Pr.prototype,"loadSuccess",null),Hr([Object(E.a)(Ie),Qr("design:type",Function),Qr("design:paramtypes",[Object,Ie]),Qr("design:returntype",void 0)],Pr.prototype,"setReady",null),Hr([Object(E.a)(ze),Qr("design:type",Function),Qr("design:paramtypes",[Object,ze]),Qr("design:returntype",void 0)],Pr.prototype,"setDisplay",null),Hr([Object(E.a)(Te),Qr("design:type",Function),Qr("design:paramtypes",[Object,Te]),Qr("design:returntype",void 0)],Pr.prototype,"setZoomViaScrollAllowed",null),Hr([Object(E.a)(Le),Qr("design:type",Function),Qr("design:paramtypes",[Object,Le]),Qr("design:returntype",void 0)],Pr.prototype,"setVisible",null),Hr([Object(E.a)(ut),Qr("design:type",Function),Qr("design:paramtypes",[Object,ut]),Qr("design:returntype",void 0)],Pr.prototype,"setEnginePosition",null),Hr([Object(E.a)(pt),Qr("design:type",Function),Qr("design:paramtypes",[Object,pt]),Qr("design:returntype",void 0)],Pr.prototype,"resetEnginePosition",null),Hr([Object(E.a)(Ve),Qr("design:type",Function),Qr("design:paramtypes",[Object,Ve]),Qr("design:returntype",void 0)],Pr.prototype,"setChapter",null),Hr([Object(E.a)(Ne),Qr("design:type",Function),Qr("design:paramtypes",[Object,Ne]),Qr("design:returntype",void 0)],Pr.prototype,"setChapterInit",null),Hr([Object(E.a)(Xe),Qr("design:type",Function),Qr("design:paramtypes",[Object,Xe]),Qr("design:returntype",void 0)],Pr.prototype,"setActiveTool",null),Hr([Object(E.a)(Fe),Qr("design:type",Function),Qr("design:paramtypes",[Object,Fe]),Qr("design:returntype",void 0)],Pr.prototype,"setGraph",null),Hr([Object(E.a)(Ae),Qr("design:type",Function),Qr("design:paramtypes",[Object,Fe]),Qr("design:returntype",void 0)],Pr.prototype,"clearGraph",null),Hr([Object(E.a)(Re),Qr("design:type",Function),Qr("design:paramtypes",[Object,Re]),Qr("design:returntype",void 0)],Pr.prototype,"setXrayMode",null),Hr([Object(E.a)(qe),Qr("design:type",Function),Qr("design:paramtypes",[Object,qe]),Qr("design:returntype",void 0)],Pr.prototype,"centerCameraOnVisible",null),Hr([Object(E.a)(Ze),Qr("design:type",Function),Qr("design:paramtypes",[Object,Ze]),Qr("design:returntype",void 0)],Pr.prototype,"toggleProgressBar",null),Hr([Object(E.a)(Ge),Qr("design:type",Function),Qr("design:paramtypes",[Object,Ge]),Qr("design:returntype",void 0)],Pr.prototype,"toggleCameraBar",null),Hr([Object(E.a)(Je),Qr("design:type",Function),Qr("design:paramtypes",[Object,Je]),Qr("design:returntype",void 0)],Pr.prototype,"toggleLabels",null),Hr([Object(E.a)(We),Qr("design:type",Function),Qr("design:paramtypes",[Object,We]),Qr("design:returntype",void 0)],Pr.prototype,"synchronizeVisibleNodes",null),Hr([Object(E.a)($e),Qr("design:type",Function),Qr("design:paramtypes",[Object,$e]),Qr("design:returntype",void 0)],Pr.prototype,"synchronizeRenderableNodes",null),Hr([Object(E.a)(Ke),Qr("design:type",Function),Qr("design:paramtypes",[Object,Ke]),Qr("design:returntype",void 0)],Pr.prototype,"synchronizePickableNodes",null),Hr([Object(E.a)(Ye),Qr("design:type",Function),Qr("design:paramtypes",[Object,Ye]),Qr("design:returntype",void 0)],Pr.prototype,"playChapterAnimation",null),Hr([Object(E.a)(et),Qr("design:type",Function),Qr("design:paramtypes",[Object,et]),Qr("design:returntype",void 0)],Pr.prototype,"toggleAnimation",null),Hr([Object(E.a)(tt),Qr("design:type",Function),Qr("design:paramtypes",[Object,tt]),Qr("design:returntype",void 0)],Pr.prototype,"setAnimationPlaying",null),Hr([Object(E.a)(nt),Qr("design:type",Function),Qr("design:paramtypes",[Object,nt]),Qr("design:returntype",void 0)],Pr.prototype,"setPlaybackSpeed",null),Hr([Object(E.a)(it),Qr("design:type",Function),Qr("design:paramtypes",[Object,it]),Qr("design:returntype",void 0)],Pr.prototype,"playAudio",null),Hr([Object(E.a)(rt),Qr("design:type",Function),Qr("design:paramtypes",[Object,rt]),Qr("design:returntype",void 0)],Pr.prototype,"setAutoplay",null),Hr([Object(E.a)(at),Qr("design:type",Function),Qr("design:paramtypes",[Object,at]),Qr("design:returntype",void 0)],Pr.prototype,"setObjectLayerOrder",null),Hr([Object(E.a)(st),Qr("design:type",Function),Qr("design:paramtypes",[Object,st]),Qr("design:returntype",void 0)],Pr.prototype,"setObjectDisplayName",null),Hr([Object(E.a)(ct),Qr("design:type",Function),Qr("design:paramtypes",[Object,ct]),Qr("design:returntype",void 0)],Pr.prototype,"autoSortObjectLayers",null),Hr([Object(E.a)(lt),Qr("design:type",Function),Qr("design:paramtypes",[Object,lt]),Qr("design:returntype",void 0)],Pr.prototype,"resetObjectLayers",null),Hr([Object(E.a)(dt),Qr("design:type",Function),Qr("design:paramtypes",[Object,dt]),Qr("design:returntype",void 0)],Pr.prototype,"setPostProcessingEffects",null),Hr([Object(E.a)(gt),Qr("design:type",Function),Qr("design:paramtypes",[Object,gt]),Qr("design:returntype",void 0)],Pr.prototype,"setProperties",null),Hr([Object(E.a)(ht),Qr("design:type",Function),Qr("design:paramtypes",[Object,ht]),Qr("design:returntype",void 0)],Pr.prototype,"setTransparencyMode",null),Hr([Object(E.a)(ft),Qr("design:type",Function),Qr("design:paramtypes",[Object,ft]),Qr("design:returntype",void 0)],Pr.prototype,"expandNode",null),Hr([Object(E.a)(bt),Qr("design:type",Function),Qr("design:paramtypes",[Object,bt]),Qr("design:returntype",void 0)],Pr.prototype,"collapseNode",null),Hr([Object(E.a)(vt),Qr("design:type",Function),Qr("design:paramtypes",[Object,vt]),Qr("design:returntype",void 0)],Pr.prototype,"hoverNode",null),Hr([Object(E.a)(mt),Qr("design:type",Function),Qr("design:paramtypes",[Object,mt]),Qr("design:returntype",void 0)],Pr.prototype,"setLabelEditNode",null),Hr([Object(E.a)(xt),Qr("design:type",Function),Qr("design:paramtypes",[Object,xt]),Qr("design:returntype",void 0)],Pr.prototype,"queryNodeInfo",null),Hr([Object(E.a)(kt),Qr("design:type",Function),Qr("design:paramtypes",[Object,kt]),Qr("design:returntype",void 0)],Pr.prototype,"queryNodeInfoSuccess",null),Hr([Object(E.a)(yt),Qr("design:type",Function),Qr("design:paramtypes",[Object,yt]),Qr("design:returntype",void 0)],Pr.prototype,"setNodeInfo",null),Hr([Object(E.a)(He),Qr("design:type",Function),Qr("design:paramtypes",[Object,He]),Qr("design:returntype",void 0)],Pr.prototype,"setContextMenu",null),Hr([Object(E.e)(),Qr("design:type",Function),Qr("design:paramtypes",[Ot]),Qr("design:returntype",void 0)],Pr,"getEngine",null),Hr([Object(E.e)(),Qr("design:type",Function),Qr("design:paramtypes",[Ot]),Qr("design:returntype",void 0)],Pr,"getReady",null),Hr([Object(E.e)(),Qr("design:type",Function),Qr("design:paramtypes",[Ot]),Qr("design:returntype",void 0)],Pr,"getDisplay",null),Hr([Object(E.e)(),Qr("design:type",Function),Qr("design:paramtypes",[Ot]),Qr("design:returntype",void 0)],Pr,"getScrollMode",null),Hr([Object(E.e)(),Qr("design:type",Function),Qr("design:paramtypes",[Ot]),Qr("design:returntype",void 0)],Pr,"getVisible",null),Hr([Object(E.e)(),Qr("design:type",Function),Qr("design:paramtypes",[Ot]),Qr("design:returntype",void 0)],Pr,"getViewGraph",null),Hr([Object(E.e)(),Qr("design:type",Function),Qr("design:paramtypes",[Ot]),Qr("design:returntype",void 0)],Pr,"getViewGraphNode",null),Hr([Object(E.e)(),Qr("design:type",Function),Qr("design:paramtypes",[Ot]),Qr("design:returntype",void 0)],Pr,"getEnginePosition",null),Hr([Object(E.e)(),Qr("design:type",Function),Qr("design:paramtypes",[Ot]),Qr("design:returntype",void 0)],Pr,"getChapter",null),Hr([Object(E.e)(),Qr("design:type",Function),Qr("design:paramtypes",[Ot]),Qr("design:returntype",void 0)],Pr,"getActiveTool",null),Hr([Object(E.e)(),Qr("design:type",Function),Qr("design:paramtypes",[Ot]),Qr("design:returntype",void 0)],Pr,"getShowCameraBar",null),Hr([Object(E.e)(),Qr("design:type",Function),Qr("design:paramtypes",[Ot]),Qr("design:returntype",void 0)],Pr,"getShowProgressBar",null),Hr([Object(E.e)(),Qr("design:type",Function),Qr("design:paramtypes",[Ot]),Qr("design:returntype",void 0)],Pr,"getShowLabels",null),Hr([Object(E.e)(),Qr("design:type",Function),Qr("design:paramtypes",[Ot]),Qr("design:returntype",void 0)],Pr,"getChapterInit",null),Hr([Object(E.e)(),Qr("design:type",Function),Qr("design:paramtypes",[Ot]),Qr("design:returntype",void 0)],Pr,"getAnimationPlaying",null),Hr([Object(E.e)(),Qr("design:type",Function),Qr("design:paramtypes",[Ot]),Qr("design:returntype",void 0)],Pr,"getPlayAudio",null),Hr([Object(E.e)(),Qr("design:type",Function),Qr("design:paramtypes",[Ot]),Qr("design:returntype",void 0)],Pr,"getAutoplay",null),Hr([Object(E.e)(),Qr("design:type",Function),Qr("design:paramtypes",[Ot]),Qr("design:returntype",void 0)],Pr,"getXrayModeEnabled",null),Hr([Object(E.e)(),Qr("design:type",Function),Qr("design:paramtypes",[Ot]),Qr("design:returntype",void 0)],Pr,"getHoveredNode",null),Hr([Object(E.e)(),Qr("design:type",Function),Qr("design:paramtypes",[Ot]),Qr("design:returntype",void 0)],Pr,"getLabelEditNode",null),Hr([Object(E.e)(),Qr("design:type",Function),Qr("design:paramtypes",[Ot]),Qr("design:returntype",void 0)],Pr,"getQuerying",null),Hr([Object(E.e)(),Qr("design:type",Function),Qr("design:paramtypes",[Ot]),Qr("design:returntype",void 0)],Pr,"getContextmenu",null),Hr([Object(E.e)(),Qr("design:type",Function),Qr("design:paramtypes",[Ot]),Qr("design:returntype",void 0)],Pr,"getPlaybackSpeed",null),Pr=jr=Hr([Object(E.f)({name:"engine",defaults:{loading:!1,ready:!1,viewGraph:{nodes:{},successors:{},predecessors:{},roots:{}},hoveredNode:void 0,labelEditNode:void 0,queryingWiki:!1,engine:"",chapter:"",chapterInit:{id:"",init:!1,camera:!1,annotations:!1,graph:!1,properties:!1,particles:!1,clips:!1,postprocessing:!1,transparency:!1},showProgressBar:!0,showCameraBar:!0,showLabels:!0,activeTool:Rr.Select,animationPlaying:!0,autoplay:!0,playAudio:!1,display:!0,visible:!0,scrollMode:Vr.Capture,playbackSpeed:1,xrayModeEnabled:!1,contextmenu:{node:null,hit:null}},children:[Ar]})],Pr)),$r=h("2Vo4"),Kr=h("VRyK"),Gr=h("itXk"),Zr=h("xgIS"),Jr=h("Kj3r"),Xr=h("/uUt"),Yr=h("OsX3"),ea=h("3UWI"),ta=h("Zy1z"),na=function e(){m(this,e)},ia=function e(){m(this,e)},oa=function e(){m(this,e)},ra=h("ofXK"),aa=h("2Yyj"),sa=h.n(aa),ca=h("Kd/A"),la=h.n(ca),ua=h("Hfs6"),pa=h.n(ua),da=h("VLs4"),ga=h.n(da),ha=h("1IWC"),fa=h.n(ha),ba=h("Paii"),va=h.n(ba),ma=h("vT00"),ya={title:"English",lang:"en",country:"us",id:"en-US"},xa=[ya,{title:"Espa\xf1ol",lang:"es",country:"es",id:"es-ES"},{title:"\u4e2d\u6587(\u7b80\u4f53)",lang:"zh",country:"cn",id:"zh-CN"},{title:"Fran\xe7ais",lang:"fr",country:"fr",id:"fr-FR"},{title:"Deutsch",lang:"de",country:"de",id:"de-DE"},{title:"Italiano",lang:"it",country:"it",id:"it-IT"},{title:"\u65e5\u672c\u8a9e",lang:"ja",country:"ja",id:"ja"},{title:"Portugu\xeas",lang:"pt",country:"pt",id:"pt-PT"}];function ka(){var e="";try{e=localStorage.getItem("locale")}catch(t){}return(xa.find((function(t){return t.id===e}))||ya).id}[sa.a,la.a,pa.a,ga.a,fa.a,va.a,h.n(ma).a].forEach((function(e){Object(ra.x)(e)}));var wa,Oa,Ca,Sa=((Ca=function(){function e(){m(this,e)}return v(e,null,[{key:"forRoot",value:function(){return{ngModule:e,providers:[{provide:P.w,useFactory:ka}]}}}]),e}()).\u0275mod=P.Nb({type:Ca}),Ca.\u0275inj=P.Mb({factory:function(e){return new(e||Ca)},imports:[[ra.c]]}),Ca),_a=((Oa=function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ya.lang,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];m(this,e),this.id=t,this.type=n,this.lang=i,this.preview=o}).type="[Story] Load Current Story",Oa),ja=function(){var e=function e(t){m(this,e),this.story=t};return e.type="[Story] Replace the Story",e}(),Pa=function(){var e=function e(t){m(this,e),this.id=t};return e.type="[Story] Set the Story ID",e}(),Ma=function(){var e=function e(t){m(this,e),this.displayName=t};return e.type="[Story] Set Story Text",e}(),Ia=function(){var e=function e(t){m(this,e),this.tags=t};return e.type="[Story] Set Story Tags",e}(),za=function(){var e=function e(t,n,i){m(this,e),this.id=t,this.type=n,this.reset=i};return e.type="[Story] Set Incoming Story Id",e}(),Ta=function(){var e=function e(){m(this,e)};return e.type="[Story] Load Story Chunk",e}(),Ua=function(){var e=function e(t){m(this,e),this.chapterId=t};return e.type="[Story] Reorder Load Chunks",e}(),La=function(){var e=function e(t){m(this,e),this.chunk=t};return e.type="[Story] Load Story Chunk Success",e}(),Da=function(){var e=function e(t,n,i,o){m(this,e),this.id=t,this.story=n,this.type=i,this.chapterIdx=o};return e.type="[Story] Build Story In Engine From Story Model",e}(),Ea=function(){var e=function e(t,n,i){m(this,e),this.story=t,this.id=n,this.type=i};return e.type="[Story] Load Success",e}(),Fa=function(){var e=function e(t,n){m(this,e),this.id=t,this.type=n};return e.type="[Story] Load Fail",e}(),Aa=((wa=function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ya.lang;m(this,e),this.id=t,this.type=n,this.lang=i}).type="[Story] Import",wa),Ra=function(){var e=function e(t,n,i){m(this,e),this.story=t,this.id=n,this.type=i};return e.type="[Story] Import Success",e}(),Va=function(){var e=function e(){m(this,e)};return e.type="[Story] Clear",e}(),Na=function(){var e=function e(){m(this,e)};return e.type="[Story] Synchronize Chapters",e}(),Ba=function(){var e=function e(){m(this,e)};return e.type="[Story] Human Ready (Web)",e}(),Ha=function(){var e=function e(){m(this,e)};return e.type="[Story] Human Ready (SDK)",e}(),Qa=h("cp0P"),qa=function e(){m(this,e)};function Wa(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return function(){return new Promise((function(t){e.apply(void 0,n.concat([function(){t()}]))}))}}var $a,Ka,Ga,Za,Ja,Xa=(($a=function(){function e(){m(this,e)}return v(e,[{key:"getOnlyText",value:function(e){return e.map((function(e){switch(e.type){case so.Markdown:return e.markdown}})).join("")}}]),e}()).\u0275fac=function(e){return new(e||$a)},$a.\u0275prov=P.Lb({token:$a,factory:$a.\u0275fac,providedIn:"root"}),$a),Ya=["reflections","lights"],es=["material","geometry","transform"],ts=["tweens","morph"],ns=((Ka=function(){function e(t,n,i,o){m(this,e),this.http=t,this.engineService=n,this.chapterService=i,this.contentBlocksService=o}return v(e,[{key:"getShownObjectsFromChapter",value:function(e){var t=[];return Object.entries(e.synchronization).forEach((function(e){var n=p(e,2),i=n[0];n[1].shown&&t.push(i)})),t}},{key:"getChapterLoadChunks",value:function(e,t,n){var i=this.getShownObjectsFromChapter(t),o=new ia;return o.activate=!1,o.chapterId=t.id,o.objects=i,o.storyId=e,o.assetTypes=[].concat(es,ts,Ya),o.readyState={model:!0,animation:!0},[o]}},{key:"getOnDemandLoadChunks",value:function(e,t){var n=this,i=[];return Human.timeline.rootTimelines[e]._chapters.forEach((function(o){var r=n.getChapterLoadChunks(e,o,t);i=o.id===t.targetChapterId?[].concat(c(r),c(i)):[].concat(c(i),c(r))})),i}},{key:"getChapterIndex",value:function(e,t){return Human.timeline.rootTimelines[e]?Human.timeline.rootTimelines[e]._chapters.findIndex((function(e){return e.id===t})):-1}},{key:"getStory",value:function(e,t){var n,i=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"en",r=t===I.Bookmark?this.getBookmark(e):this.getContent(e);return"en"===o?r:r.pipe(Object(rr.a)((function(r){return n=r,i.getStoryTranslation(e,t,o)}))).pipe(Object(Z.a)((function(e){return i.translateStory(n,e)})),Object(J.a)((function(){return r})))}},{key:"getContentRoot",value:function(){return!0===U.offline?"undefined"==typeof localBaseDirectory?"":localBaseDirectory:"/"}},{key:"getContent",value:function(e){return this.http.get(this.getContentRoot()+"content/modules/".concat(e,".json")).pipe(Object(Z.a)((function(e){return e})))}},{key:"getBookmark",value:function(e){return this.http.get("/search/bookmarks/data",{params:{be:e}}).pipe(Object(Z.a)((function(e){return e.bookmark})))}},{key:"getLoadConfig",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=new oa;return n.chapterAssetBundle=!0,n.targetChapterId=Human.timeline.rootTimelines[e]._chapters[t].id,n.targetChapterConfig={global:{clipping:!0,graph:!0,camera:!0,properties:!0,transparencyMode:!0,postprocess:!0},static:{labels:!0},dynamic:{timeline:!0,particles:!0}},n.sortBy="chapter",n}},{key:"buildStory",value:function(e,t,n){Human.events.fire("modules.fetch.start",e),Human.modules.moduleData[e]=t;var i=Object.assign({},t);return i.moduleId=e,new be.a((function(t){Human.modules.create(e,i,(function(){Human.modules.load(e,Object.values(Human.scene.rootObjects),[].concat(Ya),(function(){Human.modules.activate(e,0,{},(function(){t.next(!0),t.complete()}))}))}))}))}},{key:"getStoryChapters",value:function(e,t){var n=this,i=Human.modules.moduleData[e];return Human.timeline.rootTimelines[e]._chapters.map((function(e,o){return n.chapterService.fromHumanChapter(i,t,e,o)}))}},{key:"getStoryLoadChunks",value:function(e,t){return this.getOnDemandLoadChunks(e,t).map((function(e){return Object.assign(Object.assign({},e),{chunkId:Tt.idWithPrefix("chunk")})}))}},{key:"loadStoryChunk",value:function(e,t){var n=e.objects.map((function(e){return Human.scene.objects[e]}));e.storyId?Human.modules.load(e.storyId,n,e.assetTypes,(function(){t()})):this.engineService.loadGraphObject(e.objects[0]).subscribe((function(){t()}))}},{key:"unloadStory",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=(e?[e]:Object.keys(Human.modules.modules)).map((function(e){return t.hardDeleteStory(e,n)}));return new be.a((function(e){i.length?Object(Qa.a)(i).subscribe((function(){e.next(!0),e.complete()})):(e.next(!0),e.complete())}))}},{key:"createLoadObjectChunk",value:function(e){var t=new ia;return t.assetTypes=[].concat(es,ts),t.objects=[e],t}},{key:"hardDeleteStory",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=(e in Human.modules.modules?Human.modules.modules[e].sceneGraph:[]).map((function(e){return Human.scene.objects[e.objectId]})).filter((function(e){return!!e})),i=Object(Se.flatten)(n.map((function(e){return e.getLeafObjects()}))),o=Wa(Human.modules.deactivate,e,{}),r=Wa(Human.modules.unload,e,i,["geometries","morphs","reflections","tweens","lights","materials","transforms"]),a=Wa(Human.modules.destroy,e);return new be.a((function(n){(Human.timeline.activeRoot&&Human.timeline.activeRoot.id===e?o():Promise.resolve({})).then((function(){return t?r():Promise.resolve({})})).then((function(){return a()})).then((function(){return n.next(),void n.complete()}))}))}},{key:"getStoryTranslation",value:function(e,t,n){return this.http.get(t===I.Bookmark?"/search/bookmarks/tr/".concat(n,"/").concat(e):"/tr/".concat(n,"/").concat(e,".json")).pipe(Object(Z.a)((function(e){return Object(te.plainToClass)(qa,e)})))}},{key:"getStoryType",value:function(e){return e.indexOf("/")>=0?I.Module:I.Bookmark}},{key:"translateStory",value:function(e,t){var n=this,i=e.chapters||[],o=e.sceneGraph||[],r=t.objects||{},a=t.chapters||[];return e.displayName=t.displayName||e.displayName,e.description=t.description||e.description,o.forEach((function(e){(e.objects||[]).forEach((function(e){n.translateObject(e,r)}))})),i.forEach((function(e,t){var i=a[t];if(i){n.translateMetaInfo(e,i);var o=i.annotations||[];(e.annotations||[]).forEach((function(e,t){var i=o[t];i&&n.translateMetaInfo(e,i)}));var r=i.hotspots||[];(e.hotspots||[]).forEach((function(e,t){var i=r[t];i&&n.translateMetaInfo(e,i)}))}})),e}},{key:"translateMetaInfo",value:function(e,t){var n=t.title,i=t.description;e.hasOwnProperty("displayName")&&(e.displayName=n),e.hasOwnProperty("title")&&(e.title=n),e.hasOwnProperty("description")&&(e.description=i)}},{key:"translateObject",value:function(e,t){var n=this,i=t[e.objectId];i&&(e.displayName=i);var o=e.objects;o&&o.forEach((function(e){n.translateObject(e,t)}))}},{key:"exportWrittenContent",value:function(e,t,n){var i=[];return i.push("\n".concat(e.displayName,"\n    ")),t.forEach((function(e,t){i.push("\n---\n\n# Chapter ".concat(t+1,": ").concat(e.info.displayName||"-No Title-","\n\n").concat(e.info.description||"-No Description-","\n      ")),e.legend.length&&(i.push("\n## Legend\n"),e.legend.forEach((function(e){i.push("\n* ".concat(e.label," (").concat(vr.rgbToHex(e.colors,!0),")\n"))})));var o=n.filter((function(t){return t.chapterId===e.id}));o.length&&(i.push("\n## Labels\n"),o.forEach((function(e){i.push("\n* ".concat(e.title,"\n")),e.description&&i.push("\n  > ".concat(e.description,"\n"))})))})),i.join("")}},{key:"exportQuizKey",value:function(e){var t=this,n=[];return e.forEach((function(e,i){switch(n.push("\n# QUESTION ".concat(i+1," (").concat(lo[e.type],")\n\n## PROMPT\n").concat(t.contentBlocksService.getOnlyText(e.questionPrompt),"\n      ")),e.type){case co.MultipleChoice:e.data.options.forEach((function(t,i){n.push("\n## ANSWER ".concat(i+1," ").concat(e.data.correctAnswer===t.value?"- CORRECT":"","\n").concat(t.label,"\n            "))}));break;case co.SelectAnatomy:n.push("\n## ANSWERS\n          "),e.data.correctAnswer.forEach((function(e,t){n.push("\n".concat(e,"\n            "))}));break;case co.LabelAnatomy:e.data.options.forEach((function(e,t){n.push("\n## ANSWER ".concat(t+1,"\n").concat(e.label.title,"\n            "))}))}t.contentBlocksService.getOnlyText(e.explanation).length&&n.push("\n  \n## EXPLANATION\n".concat(t.contentBlocksService.getOnlyText(e.explanation),"\n        ")),n.push("\n\n\n      ")})),n.join("")}}]),e}()).\u0275fac=function(e){return new(e||Ka)(P.Zb(K.b),P.Zb(Nt),P.Zb(Eo),P.Zb(Xa))},Ka.\u0275prov=P.Lb({token:Ka,factory:Ka.\u0275fac,providedIn:"root"}),Ka);function is(e,t,n){var i=function(e,t){var n,i={},o=s(e);try{for(o.s();!(n=o.n()).done;)for(var r=n.value,a=Object.keys(t[r]),c=0,l=a;c<l.length;c++){i[l[c]]=!1}}catch(u){o.e(u)}finally{o.f()}return i}(t,n);return e.map((function(e){return Object.assign(Object.assign({},e),{showObjects:Object.assign(Object.assign({},e.showObjects),i),selectObjects:Object.assign(Object.assign({},e.selectObjects),i),pickThroughObjects:Object.assign(Object.assign({},e.pickThroughObjects),i)})}))}function os(e){return e.split("/").length>1?I.Module:I.Bookmark}function rs(e,t){return e.map((function(e){if(!Object(Se.isEmpty)(e.lights))return e;var n={libraries:c(t),lights:[]};return Object.assign(Object.assign({},e),{lights:n})}))}function as(e){return e.customData&&e.customData.particleSystems?e.customData.particleSystems.reduce((function(e,t){return e[Ui.getParticleIdRoot(t.id)]=t.id,e}),{}):{}}function ss(e,t){return e.customData&&e.customData.particleSystems?e.customData.particleSystems.map((function(e){var n=Ui.getParticleIdRoot(e.id);return Object.assign(Object.assign({},e),{id:t[n]})})):[]}function cs(e,t){return e.map((function(e){return e.customData&&e.customData.particleSystems&&(e.customData.particleSystems=e.customData.particleSystems.map((function(e){return t[Ui.getParticleIdRoot(e)]}))),e}))}function ls(e,t){return e.map((function(e){return e.id})).reduce((function(n,i){return e.some((function(e){return e.id===i&&Object(Se.get)(e,"customData.particleSystems",[]).length>0}))&&(n[i]=t),n}),{})}(Ga||(Ga={})).generateThumbnailUrls=function(e){return e.reduce((function(e,t){var n=t.originalChapterId,i=t.newChapterId,o=t.originalStoryId,r="/thumbs/".concat(I.Bookmark===os(o)?"bookmarks":"modules","/").concat(o.replace(".json","")),a=new fr;return a.storyId=o,a.chapterId=n,a.urls={small:"".concat(r,"/small/chapters/").concat(n,".jpg"),large:"".concat(r,"/large/chapters/").concat(n,".jpg")},e.set(i,a),e}),new Map)};var us=function e(){m(this,e)},ps=function e(){m(this,e)},ds=function e(){m(this,e)};function gs(e,t){return{showObjects:Object(Se.mapKeys)(e.showObjects,(function(e,n){return Ja.renamespaceValue(n,t)})),selectObjects:Object(Se.mapKeys)(e.selectObjects,(function(e,n){return Ja.renamespaceValue(n,t)})),pickThroughObjects:Object(Se.mapKeys)(e.pickThroughObjects,(function(e,n){return Ja.renamespaceValue(n,t)})),synchronization:Object(Se.mapKeys)(e.synchronization,(function(e,n){return Ja.renamespaceValue(n,t)}))}}function hs(e,t){return(e||[]).map((function(e){return Object.assign(Object.assign({},e),{objectId:Ja.renamespaceValue(e.objectId,t),states:e.states.map((function(e){return Object.assign(Object.assign({},e),{errands:(n=e.errands,n.map((function(e){return e.type===bi.flyToChapter||e.type===bi.flyToObject?Object.assign(Object.assign({},e),{value:Ja.renamespaceValue(e.value,t)}):e})))});var n}))})}))}function fs(e,t){return(e||[]).map((function(e){return e.data.timeline=t[e.data.timeline]||e.data.timeline,e}))}function bs(e,t){return(e||[]).map((function(e){return e.objectId&&(e.objectId=Ja.renamespaceValue(e.objectId,t)),e}))}function vs(e,t){return e?{xray:Object(Se.mapKeys)(e.xray,(function(e,n){return Ja.renamespaceValue(n,t)})),highlight:Object(Se.mapKeys)(e.highlight,(function(e,n){return Ja.renamespaceValue(n,t)}))}:{}}function ms(e,t){var n=Object.assign({},e);return Array.isArray(e.layers)&&(n.layers=e.layers.map((function(e){return Object.assign(Object.assign({},e),{objectIds:e.objectIds.map((function(e){return Ja.renamespaceValue(e,t)}))})}))),n}function ys(e,t){var n=function(e,t){return"string"==typeof e?[t[e]||e]:e.map((function(e){return t[e]||e}))}(e.stateId,t),i=e.assetLibraries.tweens.map((function(e){return Ja.renamespaceValue(e,t)})),o=e.assetLibraries.reflections.map((function(e){return Ja.renamespaceValue(e,t)})),r=Object(Se.mapValues)(e.reflections,(function(e,n){return Ja.renamespaceValue(e,t)})),a=function(e,t){return e.map((function(e){return Object.assign(Object.assign(Object.assign({},e),gs(e,t)),{colorRecipeObjects:vs(e.colorRecipeObjects,t),timelineMap:fs(e.timelineMap,t),labels:hs(e.labels,t),hotspots:bs(e.hotspots,t),visibilityLayers:ms(e.visibilityLayers,t)})}))}(e.chapters,t),c=function e(t,n){var i,o=s(t);try{var r=function(){var t=i.value;["objectId","displayName","geometryId","morphId","materialId"].forEach((function(e){t[e]&&(t[e]=Ja.renamespaceValue(t[e],n))})),e(t.objects||[],n)};for(o.s();!(i=o.n()).done;)r()}catch(a){o.e(a)}finally{o.f()}return t}(e.sceneGraph,t);return Object.assign(Object.assign(Object.assign(Object.assign({},e),{stateId:n}),gs(e,t)),{assetLibraries:Object.assign(Object.assign({},e.assetLibraries),{tweens:i,reflections:o}),reflections:r,chapters:a,sceneGraph:c})}!function(e){function t(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;["x","y","z"].forEach((function(n){void 0!==e[n]&&Math.abs(e[n]-t)<1e-4&&delete e[n]}))}function n(e){["translate","rotate","pivot"].forEach((function(n){void 0!==e[n]&&(t(e[n]),0===Object.keys(e[n]).length&&delete e[n])})),void 0!==e.scale&&(t(e.scale,1),0===Object.keys(e.scale).length&&delete e.scale)}function i(e,t){["backfaces","displayName","layer"].forEach((function(n){e[n]&&(t[n]=e[n])}))}function o(e,t){var i=new ps;i.translate=JSON.parse(JSON.stringify(e.translate)),i.rotate=JSON.parse(JSON.stringify(e.rotate)),i.scale=JSON.parse(JSON.stringify(e.scale)),i.pivot=JSON.parse(JSON.stringify(e.pivot)),n(i),Object.entries(i).forEach((function(e){var n=p(e,2),i=n[0],o=n[1];t[i]=JSON.parse(JSON.stringify(o))})),t.transformId&&delete t.transformId}function r(e,t){var n=["geometryId","morphId","materialId"],i=[];return e.renderables&&e.renderables.forEach((function(e){var t=new us;n.forEach((function(n){e[n]&&(t[n]=e[n])})),e.layer&&(t.layer=e.layer),i.push(t)})),1===i.length?t=Object.assign(Object.assign({},t),i[0]):i.length>1&&(t.renderables=i),t}e.filterTransformProperties=n,e.serializeObjectProperties=i,e.serializeTransformData=o,e.serializeRenderables=r,e.serializeHumanObject=function e(t,n){if(n[t.objectId])return null;var a=new ds;return a.objectId=t.objectId,i(t,a),t.transformId?a.transformId=t.transformId:o(t,a),a=r(t,a),t.objects&&t.objects.length&&(a.objects=[]),t.objects.forEach((function(t){var i=e(t,n);null!==i&&a.objects.push(i)}),this),a}}(Za||(Za={})),function(e){function t(e,t){var n=Object.entries(t);return n.sort((function(e,t){return e[0].length===t[0].length?0:e[0].length<t[0].length?1:-1})),n.reduce((function(e,t){var n=p(t,2),i=n[0],o=n[1];if(e.startsWith(i)){var r=new RegExp("^"+i);e=e.replace(r,o)}return e}),e||"")}e.renamespaceValue=t,e.renamespaceKeys=function(e,n){return Object.entries(e).reduce((function(e,i){var o=p(i,2),r=o[0],a=o[1];return e[t(r,n)]=a,e}),{})},e.renamespaceAssetLibrary=function(e,n,i){if(!i)return e;var o=e.tweens.map((function(e){return t(e,n)})),r=e.reflections.map((function(e){return t(e,n)}));return Object.assign(Object.assign({},e),{tweens:o,reflections:r})},e.renamespaceReflections=function(e,n,i){return i?Object(Se.mapValues)(e,(function(e){return t(e,n)})):e}}(Ja||(Ja={}));var xs,ks,ws,Os,Cs,Ss,_s=function e(){m(this,e)},js=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},Ps=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Ms={enableContextLabel:{enable:!0,enableInfo:!0,enableActions:!0},loading:!1,labelsCollapsed:!1,labelsCollapsedMode:Fo.None,labelScale:null,labels:[],contextLabel:null,selectedLabel:null,draggable:{pin:!0,tag:!0}},Is=((ws=xs=function(){function e(t,n){m(this,e),this.store=t,this.labelsService=n}return v(e,[{key:"PatchLabels",value:function(e,t){var n=immer.applyPatches(e.getState(),t.patches);e.patchState(n)}},{key:"setLabelOffset",value:function(e,t){var n=p(immer.produceWithPatches(e.getState(),(function(e){var n=e.labels.find((function(e){return e.id===t.labelId}));n&&(n.offset=t.offset)})),3),i=n[0],o=n[1],r=n[2];e.patchState(i),this.savePatches(o,r)}},{key:"setLabels",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){e.labels=t.labels})))}},{key:"setLabel",value:function(e,t){var n=p(immer.produceWithPatches(e.getState(),(function(e){e.labels=e.labels.map((function(e){return e.id===t.label.id?t.label:e}))})),3),i=n[0],o=n[1],r=n[2];e.patchState(i),t.record&&this.savePatches(o,r)}},{key:"setLabelStates",value:function(e,t){var n=p(immer.produceWithPatches(e.getState(),(function(e){e.labels.find((function(e){return e.id===t.id})).states=t.states})),3),i=n[0],o=n[1],r=n[2];e.patchState(i),this.savePatches(o,r)}},{key:"setLabelScale",value:function(e,t){e.patchState({labelScale:t.scale})}},{key:"addLabel",value:function(e,t){var n=p(immer.produceWithPatches(e.getState(),(function(e){var n=t.label.id||Tt.idWithPrefix("label"),i=Object.assign(Object.assign({},t.label),{id:n});e.labels.push(i)})),3),i=n[0],o=n[1],r=n[2];e.patchState(i),this.savePatches(o,r)}},{key:"addContextLabel",value:function(e,t){var n=immer.produce(e.getState(),(function(e){e.contextLabel=Object.assign(Object.assign({},t.label),{id:"context-label"})}));e.patchState(n)}},{key:"copyLabels",value:function(e,t){var n=e.getState().labels,i=n.filter((function(e){return e.chapterId===t.sourceChapter.id})).map((function(e){return Object.assign(Object.assign({},Object(Se.cloneDeep)(e)),{id:Tt.idWithPrefix("label"),chapterId:t.targetChapter.id})}));e.patchState({labels:[].concat(c(n),c(i))})}},{key:"removeLabel",value:function(e,t){var n=p(immer.produceWithPatches(e.getState(),(function(e){e.labels=e.labels.filter((function(e){return e.id!==t.label.id}))})),3),i=n[0],o=n[1],r=n[2];e.patchState(i),Human.scene.markers.delete(t.label.id),this.savePatches(o,r)}},{key:"removeContextLabel",value:function(e,t){var n=immer.produce(e.getState(),(function(e){e.contextLabel=void 0}));Human.scene.markers.delete("context-label"),e.patchState(n)}},{key:"removeAllChapterLabels",value:function(e,t){var n=immer.produceWithPatches(e.getState(),(function(e){var n=p(Object(Se.partition)(e.labels,(function(e){return e.chapterId!==t.chapter.id})),2),i=n[0];n[1].forEach((function(e){return Human.scene.markers.delete(e.id)})),e.labels=i})),i=p(n,3),o=i[0],r=i[1],a=i[2];e.patchState(o),this.savePatches(r,a)}},{key:"selectLabel",value:function(e,t){e.patchState({selectedLabel:t.label?t.label.id:null})}},{key:"resetLabels",value:function(e,t){var n=e.getState();Human.scene.markers.delete("context-label"),n.labels.forEach((function(e){Human.scene.markers.delete(e.id)})),e.setState(immer.produce(e.getState(),(function(e){})))}},{key:"convertLabels",value:function(e,t){var n=p(immer.produceWithPatches(e.getState(),(function(e){t.labels.forEach((function(n){var i=e.labels.findIndex((function(e){return e.id===n.id}));e.labels[i]=Object.assign(Object.assign({},e.labels[i]),t.fields)}))})),3),i=n[0],o=n[1],r=n[2];e.setState(Object.assign({},i)),this.savePatches(o,r)}},{key:"enableContextLabel",value:function(e,t){e.patchState({enableContextLabel:Object.assign({},t)})}},{key:"setLabelsShown",value:function(e,t){var n=t.labels,i=t.shown,o=e.getState().labels.map((function(e){var t=n.some((function(t){return t.id===e.id}));return Object.assign(Object.assign({},e),{shown:t?i:e.shown})}));e.patchState({labels:c(o)})}},{key:"setAllLabelsShown",value:function(e,t){var n=t.show,i=e.getState().labels;e.dispatch(new er(i,n))}},{key:"setLabelsCollapsed",value:function(e,t){var n=t.collapsed,i=t.collapsedMode;e.patchState({labelsCollapsed:n,labelsCollapsedMode:i})}},{key:"setLabelsDraggable",value:function(e,t){e.patchState({draggable:Object.assign({},t.draggable)})}},{key:"savePatches",value:function(e,t){this.store.dispatch(new di.SavePatches([{forward:e,inverse:t,patchAction:Ao}]))}}],[{key:"getLabels",value:function(e){return e.labels}},{key:"getLabelsCollapsed",value:function(e){return e.labelsCollapsed}},{key:"getLabelsCollapsedMode",value:function(e){return e.labelsCollapsedMode}},{key:"getSelectedLabelId",value:function(e){return e.selectedLabel}},{key:"getSelectedLabel",value:function(e){return e.labels.find((function(t){return t.id===e.selectedLabel}))||null}},{key:"getContextLabel",value:function(e){return e.contextLabel}},{key:"getChapterLabels",value:function(e,t){return e.labels.filter((function(e){return e.chapterId===t.selectedChapter}))}},{key:"getChapterSequentialLabels",value:function(e){return Object(E.h)([xs,Lr],(function(t,n){return t.labels.filter((function(t){return t.chapterId===n.selectedChapter&&t.pinType===Xn.Sequential&&t.sequentialType===e}))}))}},{key:"getLabelSequence",value:function(e){return Object(E.h)([xs,xs.getChapterSequentialLabels(ei.Alphabetical),xs.getChapterSequentialLabels(ei.Numerical)],(function(t,n,i){if(e.pinType!==Xn.Sequential)return null;switch(e.sequentialType){case ei.Alphabetical:var o=n.findIndex((function(t){return t.id===e.id}));return"ABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(o);case ei.Numerical:return i.findIndex((function(t){return t.id===e.id}))+1}}))}},{key:"getEnableContextLabel",value:function(e){return e.enableContextLabel.enable}},{key:"getEnableContextLabelInfo",value:function(e){return e.enableContextLabel.enableInfo}},{key:"getEnableContextLabelActions",value:function(e){return e.enableContextLabel.enableActions}},{key:"getLabelsDraggable",value:function(e){return e.draggable}},{key:"getLabelScale",value:function(e){return e.labelScale}}]),e}()).\u0275fac=function(e){return new(e||ws)(P.Zb(E.g),P.Zb(wi))},ws.\u0275prov=P.Lb({token:ws,factory:ws.\u0275fac}),js([Object(E.a)(Ao),Ps("design:type",Function),Ps("design:paramtypes",[Object,Ao]),Ps("design:returntype",void 0)],ws.prototype,"PatchLabels",null),js([Object(E.a)(Ro),Ps("design:type",Function),Ps("design:paramtypes",[Object,Ro]),Ps("design:returntype",void 0)],ws.prototype,"setLabelOffset",null),js([Object(E.a)(Vo),Ps("design:type",Function),Ps("design:paramtypes",[Object,Vo]),Ps("design:returntype",void 0)],ws.prototype,"setLabels",null),js([Object(E.a)($o),Ps("design:type",Function),Ps("design:paramtypes",[Object,$o]),Ps("design:returntype",void 0)],ws.prototype,"setLabel",null),js([Object(E.a)(Ko),Ps("design:type",Function),Ps("design:paramtypes",[Object,Ko]),Ps("design:returntype",void 0)],ws.prototype,"setLabelStates",null),js([Object(E.a)(Go),Ps("design:type",Function),Ps("design:paramtypes",[Object,Go]),Ps("design:returntype",void 0)],ws.prototype,"setLabelScale",null),js([Object(E.a)(No),Ps("design:type",Function),Ps("design:paramtypes",[Object,No]),Ps("design:returntype",void 0)],ws.prototype,"addLabel",null),js([Object(E.a)(Bo),Ps("design:type",Function),Ps("design:paramtypes",[Object,Bo]),Ps("design:returntype",void 0)],ws.prototype,"addContextLabel",null),js([Object(E.a)(Ho),Ps("design:type",Function),Ps("design:paramtypes",[Object,Ho]),Ps("design:returntype",void 0)],ws.prototype,"copyLabels",null),js([Object(E.a)(Qo),Ps("design:type",Function),Ps("design:paramtypes",[Object,Qo]),Ps("design:returntype",void 0)],ws.prototype,"removeLabel",null),js([Object(E.a)(qo),Ps("design:type",Function),Ps("design:paramtypes",[Object,qo]),Ps("design:returntype",void 0)],ws.prototype,"removeContextLabel",null),js([Object(E.a)(Wo),Ps("design:type",Function),Ps("design:paramtypes",[Object,Wo]),Ps("design:returntype",void 0)],ws.prototype,"removeAllChapterLabels",null),js([Object(E.a)(Zo),Ps("design:type",Function),Ps("design:paramtypes",[Object,Zo]),Ps("design:returntype",void 0)],ws.prototype,"selectLabel",null),js([Object(E.a)(Jo),Ps("design:type",Function),Ps("design:paramtypes",[Object,Jo]),Ps("design:returntype",void 0)],ws.prototype,"resetLabels",null),js([Object(E.a)(Xo),Ps("design:type",Function),Ps("design:paramtypes",[Object,Xo]),Ps("design:returntype",void 0)],ws.prototype,"convertLabels",null),js([Object(E.a)(Yo),Ps("design:type",Function),Ps("design:paramtypes",[Object,Yo]),Ps("design:returntype",void 0)],ws.prototype,"enableContextLabel",null),js([Object(E.a)(er),Ps("design:type",Function),Ps("design:paramtypes",[Object,er]),Ps("design:returntype",void 0)],ws.prototype,"setLabelsShown",null),js([Object(E.a)(tr),Ps("design:type",Function),Ps("design:paramtypes",[Object,tr]),Ps("design:returntype",void 0)],ws.prototype,"setAllLabelsShown",null),js([Object(E.a)(nr),Ps("design:type",Function),Ps("design:paramtypes",[Object,nr]),Ps("design:returntype",void 0)],ws.prototype,"setLabelsCollapsed",null),js([Object(E.a)(ir),Ps("design:type",Function),Ps("design:paramtypes",[Object,ir]),Ps("design:returntype",void 0)],ws.prototype,"setLabelsDraggable",null),js([Object(E.e)(),Ps("design:type",Function),Ps("design:paramtypes",[_s]),Ps("design:returntype",void 0)],ws,"getLabels",null),js([Object(E.e)(),Ps("design:type",Function),Ps("design:paramtypes",[_s]),Ps("design:returntype",void 0)],ws,"getLabelsCollapsed",null),js([Object(E.e)(),Ps("design:type",Function),Ps("design:paramtypes",[_s]),Ps("design:returntype",void 0)],ws,"getLabelsCollapsedMode",null),js([Object(E.e)(),Ps("design:type",Function),Ps("design:paramtypes",[_s]),Ps("design:returntype",void 0)],ws,"getSelectedLabelId",null),js([Object(E.e)(),Ps("design:type",Function),Ps("design:paramtypes",[_s]),Ps("design:returntype",void 0)],ws,"getSelectedLabel",null),js([Object(E.e)(),Ps("design:type",Function),Ps("design:paramtypes",[_s]),Ps("design:returntype",void 0)],ws,"getContextLabel",null),js([Object(E.e)([Lr]),Ps("design:type",Function),Ps("design:paramtypes",[_s,bn]),Ps("design:returntype",void 0)],ws,"getChapterLabels",null),js([Object(E.e)(),Ps("design:type",Function),Ps("design:paramtypes",[_s]),Ps("design:returntype",void 0)],ws,"getEnableContextLabel",null),js([Object(E.e)(),Ps("design:type",Function),Ps("design:paramtypes",[_s]),Ps("design:returntype",void 0)],ws,"getEnableContextLabelInfo",null),js([Object(E.e)(),Ps("design:type",Function),Ps("design:paramtypes",[_s]),Ps("design:returntype",void 0)],ws,"getEnableContextLabelActions",null),js([Object(E.e)(),Ps("design:type",Function),Ps("design:paramtypes",[_s]),Ps("design:returntype",void 0)],ws,"getLabelsDraggable",null),js([Object(E.e)(),Ps("design:type",Function),Ps("design:paramtypes",[_s]),Ps("design:returntype",void 0)],ws,"getLabelScale",null),ws=xs=js([Object(E.f)({name:"labels",defaults:Ms})],ws)),zs=((ks=function(){function e(t,n,i,o,r){m(this,e),this.store=t,this.engineService=n,this.chapterSerializer=i,this.animationService=o,this.chapterService=r}return v(e,[{key:"serializeUI",value:function(e){var t=Object.assign({},e.ui);return e.chapters.length>1&&(t.scrubber=!1,t.playPause=!1,t.tour={chapters:!0}),t}},{key:"serializeAnimation",value:function(e){return this.animationService.isChapterAnimated(e)?{startTime:e.timelineMap[0].start,loop:!1!==e.loop,numChapters:1}:{}}},{key:"getClippedObjects",value:function(){return 0===Human.renderer.clip.getActiveClips().length?{}:Human.scene.getLeaves().reduce((function(e,t){return Human.scene.objects[t].culledByClip&&(e[t]=!0),e}),{})}},{key:"generateTrimObjectMap",value:function(e){var t={};if(e.graph.hidden){var n=this.store.selectSnapshot(Ai.getAllNodeState);Object.values(n).forEach((function(e){Object.entries(e).forEach((function(e){var n=p(e,2),i=n[0],o=n[1];!1!==t[i]&&(t[i]=!(o.shown||o.shownSetByTween))}))}))}var i=e.graph.clipped?this.getClippedObjects():{};return Object.assign(Object.assign({},t),i)}},{key:"serialize",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0,s=Object(Se.cloneDeep)(o),c=this.generateTrimObjectMap(t);s.sceneGraph=function(e,t){var n=[];return Object.entries(e).forEach((function(e){var i=p(e,2),o=(i[0],i[1]),r=Za.serializeHumanObject(o,t);null!==r&&n.push(r)}),this),n}(Human.scene.rootObjects,c);var l=ke.createGraphFromSrc(s.sceneGraph,"objectId","objects",new St(Human.scene.colorRecipes.getRecipes())),u=this.store.selectSnapshot(Is.getLabels);s.chapters=r.map((function(t){return n.chapterSerializer.serializeChapter(l,t,e,u,a)})),s.ui=this.serializeUI(s),s.animation=this.serializeAnimation(r[0]),s.customData=Object.assign(Object.assign({},s.customData),{particleSystems:this.store.selectSnapshot(ao.getParticleSystemsList)});var d=this.store.selectSnapshot(_o.getAllQuestions),g=this.store.selectSnapshot(_o.getQuizSettings);g&&d.length>0?s.quizSettings=g:delete s.quizSettings,s.tweenParticleLookup=this.store.selectSnapshot(ao.getTweenParticleLookup);var h=r.reduce((function(e,t){return e.concat(n.chapterService.getChapterTweenStates(t))}),[]);s.assetLibraries.tweens=s.assetLibraries.tweens.filter((function(e){var t=n.getStateId(e);return h.indexOf(t)>=0}));var f=r.reduce((function(e,t){return e.concat(n.chapterService.getChapterLightLibraries(t))}),[]);s.assetLibraries.lights=Array.from(new Set(f));var b=this.getReflectionLibraries(s.reflections),v=r.reduce((function(e,t){return e.concat(n.chapterService.getChapterReflectionLibraries(t))}),[]);s.assetLibraries.reflections=Array.from(new Set(b.concat(v)));var m=[].concat.apply([],Object.values(s.assetLibraries)),y=this.getSceneGraphStateIds(s.sceneGraph);return s.stateId=Array.from(new Set(m.map(this.getStateId).concat(y))),{story:i?ys(s,e):s}}},{key:"getReflectionLibraries",value:function(e){return e=e||{},Object.values(e).map((function(e){var t=e.split(".");return[t[0],t[1]].join("/")}))}},{key:"getSceneGraphStateIds",value:function(e){return e.map((function(e){return e.objectId.split("-")[0]}))}},{key:"getStateId",value:function(e){return e.split("/")[0]}}]),e}()).\u0275fac=function(e){return new(e||ks)(P.Zb(E.g),P.Zb(Nt),P.Zb(Po),P.Zb(kr),P.Zb(Eo))},ks.\u0275prov=P.Lb({token:ks,factory:ks.\u0275fac,providedIn:"root"}),ks),Ts=function e(){m(this,e),this.graph={hidden:!1,clipped:!1,disabled:!1,transparent:!1}},Us=function(e){t(o,e);var n=i(o);function o(){var e;return m(this,o),(e=n.call(this,"HumanDatabase")).version(1).stores({keyValue:",value"}),e.keyValue=e.table("keyValue"),e}return o}(h("Texg").a),Ls=function(e){return e.WidgetOptions="widgetOptions",e.SnapshotOptions="snapshotOptions",e.Locale="locale",e.GroupRestriction="GroupRestriction",e.UserAppId="userAppId",e.RememberMeEmail="rememberMeEmail",e.LabelConversionSeen="labelConversionSeen",e.DefaultGroupEdit="defaultGroupEdit",e.DefaultCollectionId="defaultCollectionId",e.InternetExplorerWarning="internetExplorerWarning",e.GettingStartedTutorial="gettingStartedTutorial",e.AutoCapture="autoCapture",e.SystemMessage="systemMessage",e.ExploreRedesignMessage="exploreRedesignMessage",e.Iphone12Warning="iphone12Warning",e}({}),Ds=function(e){return e.UserMessagesSeen="userMessagesSeen",e.PreviewSize="previewSize",e}({}),Es=function(e){return e.Preview="preview",e}({}),Fs=function(){function e(){m(this,e),this._data={}}return v(e,[{key:"keys",get:function(){return Object.keys(this._data)}},{key:"length",get:function(){return this.keys.length}},{key:"clear",value:function(){this._data={}}},{key:"getItem",value:function(e){return this._data[e]}},{key:"key",value:function(e){return this.keys[e]}},{key:"removeItem",value:function(e){delete this._data[e]}},{key:"setItem",value:function(e,t){this._data[e]=t}}]),e}(),As=((Os=function(){function e(){m(this,e),this._localStorage=this.getStorage("localStorage"),this._sessionStorage=this.getStorage("sessionStorage"),this._indexedStorage=new Us}return v(e,[{key:"getLocalItem",value:function(e){return this._localStorage.getItem(""+e)}},{key:"getLocalJSON",value:function(e){var t=this.getLocalItem(e);return t?JSON.parse(t):null}},{key:"setLocalItem",value:function(e,t){var n="object"==typeof t?JSON.stringify(t):""+t;try{return this._localStorage.setItem(""+e,n),!0}catch(i){return!1}}},{key:"removeLocalItem",value:function(e){this._localStorage.removeItem(""+e)}},{key:"getSessionItem",value:function(e){var t=this._sessionStorage.getItem(""+e);return t?JSON.parse(t):null}},{key:"setSessionItem",value:function(e,t){var n=JSON.stringify(t);try{return this._sessionStorage.setItem(""+e,n),!0}catch(i){return!1}}},{key:"removeSessionItem",value:function(e){this._sessionStorage.removeItem(""+e)}},{key:"setDatabaseItem",value:function(e,t){return this._indexedStorage.keyValue.put(t,e)}},{key:"getDatabaseItem",value:function(e){return this._indexedStorage.keyValue.get(e)}},{key:"clearStorage",value:function(){this.clearLocalStorage(),this.clearSessionStorage()}},{key:"clearLocalStorage",value:function(){this._localStorage.clear()}},{key:"clearSessionStorage",value:function(){this._sessionStorage.clear()}},{key:"getStorage",value:function(e){try{return window[e]||new Fs}catch(t){return new Fs}}}]),e}()).\u0275fac=function(e){return new(e||Os)},Os.\u0275prov=P.Lb({token:Os,factory:Os.\u0275fac,providedIn:"root"}),Os),Rs=h("3E0/"),Vs=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},Ns=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Bs={loading:!1,incoming:{id:void 0,type:void 0},storyId:void 0,storyType:void 0,loadingChunk:null,loadChunks:[],loadChunksRemaining:[],thumbnailLookup:[]},Hs=((Ss=Cs=function(){function e(t,n,i,o,r){m(this,e),this.store=t,this.storyService=n,this.engineService=i,this.serializeModuleService=o,this.storageService=r}return v(e,[{key:"setStoryText",value:function(e,t){var n=e.getState().story;n&&e.patchState({story:Object.assign(Object.assign({},n),{displayName:t.displayName})})}},{key:"setStoryTags",value:function(e,t){var n=t.tags,i=e.getState().story;i&&e.patchState({story:Object.assign(Object.assign({},i),{tags:n})})}},{key:"setStory",value:function(e,t){e.patchState({story:t.story})}},{key:"SetStoryId",value:function(e,t){e.patchState({storyId:t.id})}},{key:"setIncomingStory",value:function(e,t){var n=e.getState(),i=t.id,o=t.type,r=t.reset;i!==n.storyId||r?e.patchState({incoming:{id:i,type:o}}):r&&e.dispatch(new Da(t.id,n.story,t.type))}},{key:"loadStory",value:function(e,t){(t.preview?Object(lr.a)(this.storageService.getDatabaseItem(Es.Preview)):this.storyService.getStory(t.id,t.type,t.lang)).subscribe((function(n){e.dispatch(new Ea(n,t.id,t.type))}),(function(){e.dispatch(new Fa(t.id,t.type))}))}},{key:"loadStorySuccess",value:function(e,t){this.storyService.unloadStory(null).pipe(Object(Rs.a)(0)).subscribe((function(){e.dispatch(new Da(t.id,t.story,t.type))}))}},{key:"buildStoryWorkflow",value:function(e,t,n,i){var o=this,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:new Map;this.storyService.buildStory(t,n,!0).subscribe((function(s){var l=o.storyService.getStoryChapters(t,i),u=[];l.forEach((function(e){u=[].concat(c(u),c(e.labels))}));var p=o.storyService.getLoadConfig(t,r),d=o.storyService.getStoryLoadChunks(t,p);e.patchState({storyId:t,story:n,loadChunks:d,loadChunksRemaining:d,incoming:{id:void 0,type:void 0}});var g=o.engineService.getSceneGraph(Human.scene.rootObjects),h=l.reduce((function(e,t){return e[t.id]=function(e,t,n,i){return Object.keys(e.nodes).reduce((function(o,r){return o[r]=function(o){var r=eo(e,o,t)||Yi(e,o,t),a=function e(t,n,i){switch(i[n]){case!0:return!1;case!1:return!0;case void 0:var o=ke.getAncestor(t,n);return!o||e(t,o,i)}}(e,o,n);return{objectId:o,checked:!1,selected:!1,paint:function e(t,n,i){if(i[n]&&("tintColor"in(o=i[n])||"opacity"in o||"brightness"in o||"saturation"in o||"contrast"in o))return Li.fromEngine(new Xi(i[n]));var o,r=ke.getAncestor(t,n);return r?e(t,r,i):Bi.recipe}(e,o,i),pickable:a,shown:r,shownSetByTween:!1}}(r),o}),{})}(g,t.showObjects,t.pickThroughObjects,t.synchronization),e}),{});e.dispatch(new pi.InitNodeState(h)),e.dispatch(new pi.SetActiveChapter(l[r].id)),e.dispatch(new Sn(l)),e.dispatch(new Qn(a)),e.dispatch(new Vo(u)),e.dispatch(new On(l[r]));var f=Object(Se.get)(n,"tweenParticleLookup",{}),b=Object(Se.get)(n,"customData.particleSystems",[]),v=l.reduce((function(e,t){return e[t.id]=Object(Se.get)(t,"customData.particleSystems",[]),e}),{});e.dispatch(new zi.SetParticleState(b,v,f)),e.dispatch(new io.ResetQuizState),n.quizSettings&&e.dispatch(new io.SetQuizSettings(n.quizSettings));var m=uo(l);e.dispatch(new io.SetQuestions(m)),e.dispatch(new Ha),e.dispatch(new Ta)}))}},{key:"importStorySuccess",value:function(e,t){var n=this,i=e.getState(),o=i.storyType,r=i.storyId,a=new Ts,l=this.store.selectSnapshot(Cs.getStory),u=this.store.selectSnapshot(Lr.getStoryChapters),d=So.makeChapterIdMap(u,!1),g=this.serializeModuleService.serialize({},a,!1,l,u,d).story,h=function(e,t,n,i){var o,r,a,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:I.Bookmark,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Tt.idWithPrefix,d=function(e,t){var n=function(e){return void 0!==e.objectId},i=p(Object(Se.partition)(e,n),2),o=i[0],r=i[1],a=p(Object(Se.partition)(t,n),2),l=a[0],u=function(e,t){return t.reduce((function(t,n){var i,o=s(e);try{for(o.s();!(i=o.n()).done;){var r=i.value;Object(Se.isEqual)(r,n)||t.push(n)}}catch(a){o.e(a)}finally{o.f()}return t}),e)}(r,a[1]),d=function(e,t){var n=e.reduce((function(e,t){return e[t.objectId]=t,e}),{}),i=t.reduce((function(e,t){if(void 0===e.nodes[t.objectId])return e.nodes[t.objectId]=t,e;if(!Object(Se.isEqual)(t,e.nodes[t.objectId])){var n=function(e,t){var n={},i={};return{root:function e(t,o){if(t.objectId!==o.objectId)return n[o.objectId]=!0,[t,o];if(void 0===t.objects&&o.objects){var r,a=s(o.objects);try{for(a.s();!(r=a.n()).done;){var c=r.value;n[c.objectId]=!0}}catch(x){a.e(x)}finally{a.f()}return[Object.assign({},o)]}if(t.objects&&void 0===o.objects){var l,u=s(t.objects);try{for(u.s();!(l=u.n()).done;){var p=l.value;i[p.objectId]=!0}}catch(x){u.e(x)}finally{u.f()}return[Object.assign({},t)]}if(void 0===t.objects&&void 0===o.objects)return[Object.assign({},t)];var d,g=[],h=s(t.objects);try{var f=function(){var t=d.value,n=o.objects.find((function(e){return e.objectId===t.objectId}));n?g.push(e(t,n)):(i[t.objectId]=!0,g.push(t))};for(h.s();!(d=h.n()).done;)f()}catch(x){h.e(x)}finally{h.f()}var b,v=s(o.objects);try{var m=function(){var e=b.value;t.objects.find((function(t){return t.objectId===e.objectId}))||(n[e.objectId]=!0,g.push(e))};for(v.s();!(b=v.n()).done;)m()}catch(x){v.e(x)}finally{v.f()}var y=Object.assign({},t);return y.objects=Object(Se.flatten)(g),[y]}(e,t),objectIdsUniqueToNew:n,objectIdsUniqueToOriginal:i}}(e.nodes[t.objectId],t);e.nodes[t.objectId]=n.root[0],e.graphsMerged.push(t.objectId),e.objectIdsUniqueToNew[t.objectId]=n.objectIdsUniqueToNew,e.objectIdsUniqueToOriginal[t.objectId]=n.objectIdsUniqueToOriginal}return e}),{nodes:n,graphsMerged:[],objectIdsUniqueToNew:{},objectIdsUniqueToOriginal:{}});return{newSceneGraph:Object.keys(i.nodes).reduce((function(e,t){return e.push(i.nodes[t]),e}),[]),graphsMerged:i.graphsMerged,objectIdsUniqueToNew:i.objectIdsUniqueToNew,objectIdsUniqueToOriginal:i.objectIdsUniqueToOriginal}}(o,l),g=d.newSceneGraph,h=d.graphsMerged,f=d.objectIdsUniqueToNew,b=d.objectIdsUniqueToOriginal;return{sceneGraph:[].concat(c(u),c(g)),graphsMerged:h,objectIdsUniqueToNew:f,objectIdsUniqueToOriginal:b}}(e.sceneGraph,n.sceneGraph),g=d.sceneGraph,h=d.graphsMerged,f=d.objectIdsUniqueToNew,b=d.objectIdsUniqueToOriginal,v=(o=e.assetLibraries,r=n.assetLibraries,{lights:(a=function(e,t){return Object(Se.uniq)([].concat(c(e),c(t)))})(o.lights,r.lights),tweens:a(o.tweens,r.tweens),reflections:a(o.reflections,r.reflections)}),m=function(e,t,n,i){e=e||{},t=t||{};var o=function(e,t){return t.includes("/")?t:"".concat(function(e){return os(e)===I.Bookmark?e:e.split("/").pop()}(e),"/").concat(t)};return Object.assign(Object.assign({},Object(Se.mapKeys)(e,(function(e,t){return o(n,t)}))),Object(Se.mapKeys)(t,(function(e,t){return o(i,t)})))}(e.reflections,n.reflections,t,i),y=function(e,t,n){e=e||{},t=t||{};var i=Object.keys(t).reduce((function(e,i){var o=n("color-recipe-"+i);return e.newColorRecipeIds[i]=o,e.colorRecipes[o]=t[i],e}),{colorRecipes:{},newColorRecipeIds:{}});return{colorRecipes:Object.assign(Object.assign({},e),i.colorRecipes),newColorRecipeIds:i.newColorRecipeIds}}(e.colorRecipes,n.colorRecipes,u),x=y.colorRecipes,k=y.newColorRecipeIds,w=rs(e.chapters,e.assetLibraries.lights),O=rs(n.chapters,n.assetLibraries.lights),C=function(e,t,n,i,o){var r=as(e),a=Object.values(r),s=as(t);for(var l in s)if(s.hasOwnProperty(l)&&a.includes(s[l])){var u=Ui.generateParticleId(l,o);s[l]=u}var p=[].concat(c(ss(e,r)),c(ss(t,s))),d=cs(n,r),g=cs(i,s),h=Object.assign(Object.assign({},ls(d,r)),ls(g,s));return{mergedParticles:p,currentChapters:d,importedChapters:g,tweenParticleLookup:Object(Se.pickBy)(h,(function(e,t){return!Object(Se.isEmpty)(e)}))}}(e,n,is(w,h,f),is(O,h,b).map((function(e){return Object.assign(Object.assign({},e),{id:u("chapter")})})),u),S=function(e,t){return e.map((function(e){if(Object(Se.isEmpty)(e.colorRecipeObjects))return e;var n=Object.keys(e.colorRecipeObjects).reduce((function(n,i){return n[t[i]]=e.colorRecipeObjects[i],n}),{});return e.colorRecipeObjects=n,e}))}(C.importedChapters,k),_=[].concat(c(C.currentChapters),c(S)),j=Object.assign(Object.assign({},e.customData),{particleSystems:C.mergedParticles}),P="module"===l?e.tags:[];return Object.assign(Object.assign({},e),{assetLibraries:v,chapters:_,sceneGraph:g,customData:j,tags:P,reflections:m,colorRecipes:x,stateId:Object(Se.uniq)([].concat(c(e.stateId),c(n.stateId))),tweenParticleLookup:C.tweenParticleLookup})}(g,r,t.story,t.id,U.exportType),f=g.chapters.map((function(e,t){return{newChapterId:e.id,originalChapterId:e.id,originalStoryId:r}})),b=(i.thumbnailLookup||[]).concat(t.story.chapters.map((function(e,n){return{newChapterId:h.chapters[g.chapters.length+n].id,originalChapterId:e.id,originalStoryId:t.id}})));e.patchState({thumbnailLookup:b});var v=Ga.generateThumbnailUrls([].concat(c(f),c(b))),m=this.store.selectSnapshot(Lr.getRegisteredThumbnails),y=new Map(c(m).filter((function(e){return e[1].snapshot}))),x=new Map([].concat(c(v),c(y)));this.storyService.unloadStory(null,!0).subscribe((function(){n.buildStoryWorkflow(e,r,h,o,h.chapters.length-1,x)}))}},{key:"buildStory",value:function(e,t){var n=t.story.chapters.map((function(e,n){return{newChapterId:e.id,originalChapterId:e.id,originalStoryId:t.id}})),i=Ga.generateThumbnailUrls(n);this.buildStoryWorkflow(e,t.id,t.story,t.type,t.chapterIdx||0,i)}},{key:"loadStoryChunk",value:function(e){var t=e.getState().loadChunksRemaining[0];t&&(e.patchState({loadingChunk:t}),this.storyService.loadStoryChunk(t,(function(){e.dispatch([new La(t),new Ta])})))}},{key:"reorderLoadChunks",value:function(e,t){var n=e.getState().loadChunksRemaining,i=p(Object(Se.partition)(n,(function(e){return e.chapterId===t.chapterId})),2),o=i[0],r=i[1];e.patchState({loadChunksRemaining:[].concat(c(o),c(r))})}},{key:"loadStoryChunkSuccess",value:function(e,t){var n=e.getState().loadChunksRemaining.filter((function(e){return e.chunkId!==t.chunk.chunkId}));e.patchState({loadingChunk:null,loadChunksRemaining:n}),e.dispatch(new Tn(t.chunk.chapterId,t.chunk.readyState))}},{key:"synchronizeChapters",value:function(e){var t=this.store.selectSnapshot(Lr.getStoryChapters),n=e.getState().story;e.patchState({story:Object.assign(Object.assign({},n),{chapters:c(t)})})}},{key:"importStory",value:function(e,t){this.storyService.getStory(t.id,t.type,t.lang).subscribe((function(n){e.dispatch(new Ra(n,t.id,t.type))}))}},{key:"resetStory",value:function(e){e.setState(Bs)}}],[{key:"getStory",value:function(e){return e.story}},{key:"getStoryId",value:function(e){return e.storyId}},{key:"getLoadingChunk",value:function(e){return e.loadingChunk}},{key:"getLoadChunks",value:function(e){return e.loadChunks}},{key:"getLoadChunksRemaining",value:function(e){return e.loadChunksRemaining}},{key:"getStoryInfo",value:function(e){return{id:e.storyId,type:e.storyType}}},{key:"getIncomingStoryInfo",value:function(e){return e.incoming}},{key:"getStoryTags",value:function(e){return Object(Se.get)(e,"story.tags",[])}}]),e}()).\u0275fac=function(e){return new(e||Ss)(P.Zb(E.g),P.Zb(ns),P.Zb(Nt),P.Zb(zs),P.Zb(As))},Ss.\u0275prov=P.Lb({token:Ss,factory:Ss.\u0275fac}),Vs([Object(E.a)(Ma),Ns("design:type",Function),Ns("design:paramtypes",[Object,Ma]),Ns("design:returntype",void 0)],Ss.prototype,"setStoryText",null),Vs([Object(E.a)(Ia),Ns("design:type",Function),Ns("design:paramtypes",[Object,Ia]),Ns("design:returntype",void 0)],Ss.prototype,"setStoryTags",null),Vs([Object(E.a)(ja),Ns("design:type",Function),Ns("design:paramtypes",[Object,ja]),Ns("design:returntype",void 0)],Ss.prototype,"setStory",null),Vs([Object(E.a)(Pa),Ns("design:type",Function),Ns("design:paramtypes",[Object,Pa]),Ns("design:returntype",void 0)],Ss.prototype,"SetStoryId",null),Vs([Object(E.a)(za),Ns("design:type",Function),Ns("design:paramtypes",[Object,za]),Ns("design:returntype",void 0)],Ss.prototype,"setIncomingStory",null),Vs([Object(E.a)(_a),Ns("design:type",Function),Ns("design:paramtypes",[Object,_a]),Ns("design:returntype",void 0)],Ss.prototype,"loadStory",null),Vs([Object(E.a)(Ea),Ns("design:type",Function),Ns("design:paramtypes",[Object,Ea]),Ns("design:returntype",void 0)],Ss.prototype,"loadStorySuccess",null),Vs([Object(E.a)(Ra),Ns("design:type",Function),Ns("design:paramtypes",[Object,Ra]),Ns("design:returntype",void 0)],Ss.prototype,"importStorySuccess",null),Vs([Object(E.a)(Da),Ns("design:type",Function),Ns("design:paramtypes",[Object,Da]),Ns("design:returntype",void 0)],Ss.prototype,"buildStory",null),Vs([Object(E.a)(Ta),Ns("design:type",Function),Ns("design:paramtypes",[Object]),Ns("design:returntype",void 0)],Ss.prototype,"loadStoryChunk",null),Vs([Object(E.a)(Ua),Ns("design:type",Function),Ns("design:paramtypes",[Object,Ua]),Ns("design:returntype",void 0)],Ss.prototype,"reorderLoadChunks",null),Vs([Object(E.a)(La),Ns("design:type",Function),Ns("design:paramtypes",[Object,La]),Ns("design:returntype",void 0)],Ss.prototype,"loadStoryChunkSuccess",null),Vs([Object(E.a)(Na),Ns("design:type",Function),Ns("design:paramtypes",[Object]),Ns("design:returntype",void 0)],Ss.prototype,"synchronizeChapters",null),Vs([Object(E.a)(Aa),Ns("design:type",Function),Ns("design:paramtypes",[Object,Aa]),Ns("design:returntype",void 0)],Ss.prototype,"importStory",null),Vs([Object(E.a)(Va),Ns("design:type",Function),Ns("design:paramtypes",[Object]),Ns("design:returntype",void 0)],Ss.prototype,"resetStory",null),Vs([Object(E.e)(),Ns("design:type",Function),Ns("design:paramtypes",[na]),Ns("design:returntype",void 0)],Ss,"getStory",null),Vs([Object(E.e)(),Ns("design:type",Function),Ns("design:paramtypes",[na]),Ns("design:returntype",void 0)],Ss,"getStoryId",null),Vs([Object(E.e)(),Ns("design:type",Function),Ns("design:paramtypes",[na]),Ns("design:returntype",void 0)],Ss,"getLoadingChunk",null),Vs([Object(E.e)(),Ns("design:type",Function),Ns("design:paramtypes",[na]),Ns("design:returntype",void 0)],Ss,"getLoadChunks",null),Vs([Object(E.e)(),Ns("design:type",Function),Ns("design:paramtypes",[na]),Ns("design:returntype",void 0)],Ss,"getLoadChunksRemaining",null),Vs([Object(E.e)(),Ns("design:type",Function),Ns("design:paramtypes",[na]),Ns("design:returntype",void 0)],Ss,"getStoryInfo",null),Vs([Object(E.e)(),Ns("design:type",Function),Ns("design:paramtypes",[na]),Ns("design:returntype",void 0)],Ss,"getIncomingStoryInfo",null),Vs([Object(E.e)(),Ns("design:type",Function),Ns("design:paramtypes",[na]),Ns("design:returntype",void 0)],Ss,"getStoryTags",null),Ss=Cs=Vs([Object(E.f)({name:"story",defaults:Bs})],Ss)),Qs=function(){var e=function e(t,n){m(this,e),this.storyLoadProgress=t,this.chunkLoadProgress=n};return e.type="[Engine Progress] Set Progress",e}(),qs=function(){var e=function e(){m(this,e)};return e.type="[Engine Progress] Reset Progress",e}();function Ws(e,t){return e.dispatch(new Re(!1)),t.fireEvent(Dt.SceneXrayDisabled,void 0),!0}var $s,Ks=h("yLV6"),Gs=function(){function e(t){m(this,e),this.ngUnsubsribe=new fe.a,this.store=t,this.listenForParticleChanges(),this.listenForLookupChanges()}return v(e,[{key:"destroy",value:function(){this.ngUnsubsribe.next(),this.ngUnsubsribe.complete()}},{key:"listenForLookupChanges",value:function(){var e=this;this.store.select(ao.getTweenParticleLookup).pipe(Object(ve.a)(this.ngUnsubsribe)).subscribe((function(t){Object(Se.isEmpty)(t)||Ti.refreshEngineLookup(e.store.selectSnapshot(Hs.getStoryId),t)}))}},{key:"listenForParticleChanges",value:function(){var e=this,t=this.store.select(ao.getParticleSystems),n=this.store.select(ao.getVisisbleParticleSystems);Object(Kr.a)(t,n).pipe(Object(ve.a)(this.ngUnsubsribe)).subscribe((function(){var t=e.store.selectSnapshot(Lr.getSelectedChapterId),n=e.store.selectSnapshot(ao.particleSystemsForChapter(t)),i=e.store.selectSnapshot(ao.getVisibleParticleSystesmForChapter(t)),o=n.filter((function(e){return i.includes(e.id)}));e.setEngineParticles(o)}))}},{key:"setEngineParticles",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];Human.particles.disableAll(),Human.particles.resetAll();var t=JSON.parse(JSON.stringify(e));Human.particles.parse(t,(function(){e.forEach((function(e){Human.particles.enable(e.id)})),null!=Human.timeline.activeRoot&&(Human.timeline.activeRoot._nowBranch.particleSystems=e.map((function(e){return e.id})))}))}}]),e}();($s||($s={})).getColorRecipe=function(e,t){var n=e.scene.objects[t];if(n instanceof e.scene.Object){var i=n.getProperties();return{tintColor:Object(Se.get)(i,"tintColor")?i.tintColor:[1,1,1],brightness:i.brightness,saturation:i.saturation,contrast:i.contrast,opacity:i.opacity}}return null};var Zs,Js,Xs,Ys,ec=((Zs=function(){function e(t,n,i){m(this,e),this.store=t,this.graphService=n,this.engineService=i,this.highlightDisabled=!1}return v(e,[{key:"colorObject",value:function(e,t){var n=t.tintColor,i=t.saturation,o=t.brightness,r=t.contrast,a=t.opacity,s=Human.scene.objects[e];s instanceof Human.scene.Object&&(Object(Se.isNil)(n)||s.setTintColor(n),Object(Se.isNil)(i)||s.setSaturation(i),Object(Se.isNil)(o)||s.setBrightness(o),Object(Se.isNil)(r)||s.setContrast(r),Object(Se.isNil)(a)||s.setOpacity(a))}},{key:"getColor",value:function(e){return $s.getColorRecipe(Human,e)}},{key:"uncolorObject",value:function(e){var t=Human.scene.objects[e];t instanceof Human.scene.Object&&(t.clearColorModifiers(),t.clearOpacityModifiers())}},{key:"unpaint",value:function(e){var t=this,n=this.store.selectSnapshot(Wr.getViewGraph);this.graphService.getLeafDescendants(n,e.id).forEach((function(e){t.engineService.getObjects(e).forEach((function(e){var t=Human.scene.objects[e];t instanceof Human.scene.Object&&(t.clearColorModProperties(),t.clearOpacityModProperties())}))}))}},{key:"paint",value:function(e,t){var n=this,i=this.store.selectSnapshot(Wr.getViewGraph),o=Li.toEngine(t);this.graphService.getLeafDescendants(i,e).forEach((function(e){n.engineService.getObjects(e).forEach((function(e){n.colorObject(e,o)}))}))}},{key:"highlight",value:function(e,t){var n=this;if(!1===this.highlightDisabled||!1===t){var i=this.store.selectSnapshot(Wr.getViewGraph);this.graphService.getLeafDescendants(i,e).forEach((function(e){n.engineService.getObjects(e).forEach((function(e){var n=Human.scene.objects[e];n instanceof Human.scene.Object&&n.setHighlight(t)}))}))}}},{key:"xRay",value:function(e,t){Human.scene.objects[e.id].setXRay(t)}},{key:"paintAll",value:function(e,t){var n=this;e.forEach((function(e){return n.paint(e,t)}))}},{key:"unpaintAll",value:function(e){var t=this;e.forEach((function(e){t.unpaint(e)}))}},{key:"highlightAll",value:function(e,t){var n=this;e.forEach((function(e){return n.highlight(e,t)}))}},{key:"disableHighlight",value:function(){this.highlightDisabled=!0}},{key:"enableHighlight",value:function(){this.highlightDisabled=!1}},{key:"setHighlightColor",value:function(e){Human.renderer.highlightColor=c(e)}}]),e}()).\u0275fac=function(e){return new(e||Zs)(P.Zb(E.g),P.Zb(Ut),P.Zb(Nt))},Zs.\u0275prov=P.Lb({token:Zs,factory:Zs.\u0275fac,providedIn:"root"}),Zs),tc=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},nc=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},ic=((Js=function(){function e(t){m(this,e),this.store=t,this.currentLayers=[],this.nodesLayerIndex=0,this.objectsLayerIndex=0,this.nodeChapterOpacities={}}return v(e,[{key:"initObservables",value:function(){var e=this;this.selectedChapterId$.pipe(Object(me.a)((function(e){return!Object(Se.isNil)(e)}))).subscribe((function(t){e.selectedChapterId=t,e.updateNodeChapterOpacities()})),this.selectedChapterCurrentLayers$.subscribe((function(t){e.currentLayers=t,e.nodesLayerIndex=e.objectsLayerIndex=e.store.selectSnapshot(Lr.getSelectedChapterCurrentLayersIndex)})),Object(Gr.b)(this.selectedChapterCurrentLayersIndex$,this.selectedChapterCurrentLayersPosition$).pipe(Object(me.a)((function(e){var t=p(e,2),n=t[0],i=t[1];return!Object(Se.isNil)(n)&&!Object(Se.isNil)(i)}))).subscribe((function(t){var n=p(t,2),i=n[0],o=n[1];e.synchronizeScene(i,o,!0)}))}},{key:"recordLayerIndexPosition",value:function(e,t){this.store.dispatch(new Gn(this.selectedChapterId,e,t,!0))}},{key:"synchronizeScene",value:function(e,t,n){this.updateLayerIndex(e,this.currentLayers,n),this.updateLayerPosition(t,this.currentLayers,n)}},{key:"fractionToIndex",value:function(e){var t=this.getThreshold(),n=Math.floor(e/t);return Math.min(this.currentLayers.length-2,n)}},{key:"fractionToPosition",value:function(e,t){var n=this.getThreshold();return Math.max(0,Math.min((e-n*t)/n,1))}},{key:"indexPositionToFraction",value:function(e,t){var n=this.getThreshold();return e*n+t*n}},{key:"getThreshold",value:function(){return this.currentLayers.length>1?1/(this.currentLayers.length-1):1}},{key:"getCurrentLayerIndexProp",value:function(e){return e?"nodesLayerIndex":"objectsLayerIndex"}},{key:"updateLayerIndex",value:function(e,t,n){var i=this.getCurrentLayerIndexProp(n);e!==this[i]&&(this.restoreLayers(e,this[i],t,n),n&&(this.nodesLayerIndex=e),this.objectsLayerIndex=e)}},{key:"updateLayerPosition",value:function(e,t,n){var i=this.getCurrentLayerIndexProp(n);this.setObjectsOpacity(t[this[i]].objectIds,1-e)}},{key:"restoreLayers",value:function(e,t,n,i){for(var o=(e-t)/Math.abs(e-t),r=[],a=t;a!==e;)r=r.concat(n[a].objectIds),a+=o;var s=-1===o;this.setObjectsOpacity(r,1===o?0:1),i?this.setNodesShown(r,s):this.setObjectsShown(r,s),-1===o&&(i?this.setNodesShown(n[e].objectIds,!0):this.setObjectsShown(n[e].objectIds,!0))}},{key:"setObjectsOpacity",value:function(e,t){for(var n=0;n<e.length;n++){var i=e[n],o=this.nodeChapterOpacities[i],r=void 0;this.isFresnelOpacity(o)?((r=o.slice())[0]=t*o[0],r[1]=t*o[1]):r=t*o,Human.scene.objects[i].setOpacity(r)}}},{key:"updateNodeChapterOpacities",value:function(){var e=this,t=this.store.selectSnapshot(Ai.getAllNodeState)[this.selectedChapterId];this.nodeChapterOpacities={},Object.entries(t).forEach((function(t){var n=p(t,2),i=n[0],o=n[1];if(e.nodeChapterOpacities[i]=1,o.paint&&o.paint.hasOwnProperty("opacity")){var r=Li.toEngine(o.paint);(e.isFresnelOpacity(r.opacity)||e.isScalarOpacity(r.opacity))&&(e.nodeChapterOpacities[i]=r.opacity)}}))}},{key:"isScalarOpacity",value:function(e){return"number"==typeof e}},{key:"isFresnelOpacity",value:function(e){return Array.isArray(e)}},{key:"setObjectsShown",value:function(e,t){for(var n={},i=0;i<e.length;i++)n[e[i]]=t;Human.scene.setEnabledObjects({objects:n})}},{key:"setNodesShown",value:function(e,t){this.store.dispatch(new pi.UpdateNodesShown(t,e,void 0,!1))}}]),e}()).\u0275fac=function(e){return new(e||Js)(P.Zb(E.g))},Js.\u0275prov=P.Lb({token:Js,factory:Js.\u0275fac,providedIn:"root"}),tc([Object(E.d)(Lr.getSelectedChapterCurrentLayers),nc("design:type",be.a)],Js.prototype,"selectedChapterCurrentLayers$",void 0),tc([Object(E.d)(Lr.getSelectedChapterCurrentLayersIndex),nc("design:type",be.a)],Js.prototype,"selectedChapterCurrentLayersIndex$",void 0),tc([Object(E.d)(Lr.getSelectedChapterCurrentLayersPosition),nc("design:type",be.a)],Js.prototype,"selectedChapterCurrentLayersPosition$",void 0),tc([Object(E.d)(Lr.getSelectedChapterId),nc("design:type",be.a)],Js.prototype,"selectedChapterId$",void 0),Js),oc=h("HlzF"),rc=new RegExp("^/media/audio/(.*)/.*$"),ac=((Xs=function(){function e(){m(this,e),this.audioPlayers=new Map}return v(e,[{key:"createAudioUploadEvent",value:function(e){return{type:"uploadFile",url:"/ws/media/audio/upload",method:"POST",file:e}}},{key:"getAudioClip",value:function(e){return Object.entries(e).find((function(e){var t=p(e,2);return t[0],"audio"===t[1].data.streamType}))||[void 0,void 0]}},{key:"createAudioClip",value:function(e,t){var n=Human.timeline.branchTimelines[e.id],i=this.getAudioUUID(t);return[i,{data:{clipId:i,streamType:"audio",alternatives:["m4a"],fullUrl:t,time1:n.timeRange.firstTime,time2:n.timeRange.lastTime}}]}},{key:"getAudioClipUrl",value:function(e){var t=p(this.getAudioClip(e),2),n=(t[0],t[1]);return n?n.data.fullUrl:""}},{key:"getAudioSrc",value:function(e){return e.match("/media/audio")||(e="/content/states/"+e),e}},{key:"getAudioPlayer",value:function(e){return this.audioPlayers.get(e)}},{key:"addAudioPlayer",value:function(e){this.removeAudioPlayer(e),e=this.getAudioSrc(e);var t=new oc.Howl({src:[e]});return this.audioPlayers.set(e,t),t}},{key:"removeAudioPlayer",value:function(e){var t=this.audioPlayers.get(e);t&&(t.unload(),this.audioPlayers.delete(e))}},{key:"stopAudio",value:function(){this.audioPlayers.forEach((function(e){e.stop()}))}},{key:"getAudioUUID",value:function(e){return e.match(rc)[1]}}]),e}()).\u0275fac=function(e){return new(e||Xs)},Xs.\u0275prov=P.Lb({token:Xs,factory:Xs.\u0275fac,providedIn:"root"}),Xs),sc=function(e){return e.Hide="hide",e.Show="show",e.Collapse="collapse",e}({}),cc=function(e){return e.None="none",e.Small="small",e.Full="full",e}({}),lc=function(e){return e.None="none",e.Circle="circle",e.Bar="bar",e}({}),uc=U.application===M.Viewer?lc.Bar:lc.Circle,pc=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:sc.Hide,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];m(this,e),this.status=t,this.enable=n},dc=h("qpAl"),gc=h.n(dc);!function(e){function t(e){o()&&(e||(e=document.body),gc.a.prefixed("requestFullscreen",e)())}function n(){o()&&gc.a.prefixed("exitFullscreen",document)()}function i(){return gc.a.fullscreen&&gc.a.prefixed("fullscreenEnabled",document)}function o(){return!!i()||(console.warn("Fullscreen is not enabled"),!1)}function r(){return gc.a.prefixed("fullscreenElement",document)}e.toggleFullscreen=function(e){null===r()?t(e):n()},e.requestFullscreen=t,e.exitFullscreen=n,e.canFullscreen=i,e.checkFullscreenSupport=o,e.getFullscreenElement=r,e.isFullscreen=function(){return null!=r()},e.onFullscreenChange=function(){var e="mozfullscreenchange webkitfullscreenchange MSFullscreenChange fullscreenchange".split(" ").map((function(e){return Object(Zr.a)(document.body,e)}));return Object(Kr.a).apply(void 0,c(e))}}(Ys||(Ys={}));var hc,fc,bc,vc=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},mc=function(e){return e.Light="light",e.Dark="dark",e.Themed="themed",e}({}),yc=((hc=function(){function e(t,n){m(this,e),this.store=t,this.graphService=n,this.theme=mc.Dark,this.ngUnsubscribe=new fe.a}return v(e,[{key:"ngOnInit",value:function(){var e=this;this.store.select(Ai.getCheckedNodes).pipe(Object(me.a)((function(e){return 1===e.length})),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){setTimeout((function(){e.scrollNodeIntoView(t[0])}))}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"scrollNodeIntoView",value:function(e){var t=this.graphService.sanitizeNodeID(e.objectId),n=document.querySelector("[data-id=".concat(t,"]"));n&&"scrollBehavior"in document.documentElement.style&&n.scrollIntoView({behavior:"smooth",block:"nearest"})}}]),e}()).\u0275fac=function(e){return new(e||hc)(P.Pb(E.g),P.Pb(Ut))},hc.\u0275cmp=P.Jb({type:hc,selectors:[["app-tree"]],inputs:{theme:"theme",searchGraph:"searchGraph"},decls:2,vars:4,consts:[[3,"theme","graph"]],template:function(e,t){1&e&&(P.Qb(0,"app-tree-group",0),P.hc(1,"async")),2&e&&P.lc("theme",t.theme)("graph",t.searchGraph?t.searchGraph:P.ic(1,2,t.viewGraph$))},styles:[""]}),function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);r>3&&a&&Object.defineProperty(t,n,a)}([Object(E.d)(Wr.getViewGraph),vc("design:type",be.a)],hc.prototype,"viewGraph$",void 0),hc),xc=h("C9yA"),kc=h("vxfF"),wc=function e(){m(this,e)},Oc=function(){var e=function e(t){m(this,e),this.view=t};return e.type="[Edit] Set view",e}(),Cc=function(){var e=function e(){m(this,e)};return e.type="[Edit] Next view",e}(),Sc=function(){var e=function e(){m(this,e)};return e.type="[Edit] Previous view",e}(),_c=function(){var e=function e(t){m(this,e),this.show=t};return e.type="[Edit] Show columns",e}(),jc=function(){var e=function e(t,n){m(this,e),this.column=t,this.show=n};return e.type="[Edit] Show column",e}(),Pc=function(){var e=function e(){m(this,e)};return e.type="[Edit] Reset",e}(),Mc=function(){var e=function e(t){m(this,e),this.layerOrderMode=t};return e.type="[Edit] Set Layer Order Mode",e}(),Ic=function(){var e=function e(t){m(this,e),this.show=t};return e.type="[Edit] Show Tree Node Ids",e}(),zc=function(){var e=function e(t){m(this,e),this.size=t};return e.type="[Edit] Set Canvas Size",e}(),Tc=function(){var e=function e(t){m(this,e),this.enable=t};return e.type="[Edit] Auto Capture",e}(),Uc=function(e){return e.Chapter="chapter",e.Label="label",e.Paint="paint",e.Position="position",e.Quiz="quiz",e}({}),Lc=function e(){m(this,e)},Dc=function(){var e=function e(t){m(this,e),this.colorRecipe=t};return e.type="[Edit Paint] Set Color Recipe",e}(),Ec=function(){var e=function e(t){m(this,e),this.brushMode=t};return e.type="[Edit Paint] Set Paint Brush Mode",e}(),Fc=function(){var e=function e(){m(this,e)};return e.type="[Edit Paint] Clear Color Recipe",e}(),Ac=function(){var e=function e(){m(this,e)};return e.type="[Edit Paint] Reset Paint",e}(),Rc=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},Vc=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Nc={colorRecipe:Qi.recipe,brushMode:(fc={},fc[fc.Modify=0]="Modify",fc[fc.Replace=1]="Replace",fc).Modify},Bc=((bc=function(){function e(){m(this,e)}return v(e,[{key:"setColorRecipe",value:function(e,t){var n=t.colorRecipe;e.patchState({colorRecipe:n})}},{key:"setBrushMode",value:function(e,t){e.patchState({brushMode:t.brushMode})}},{key:"clearColorRecipe",value:function(e,t){e.patchState({colorRecipe:null})}},{key:"resetPaint",value:function(e,t){e.setState(Nc)}}],[{key:"getColorRecipe",value:function(e){return e.colorRecipe}},{key:"getPaintBrushMode",value:function(e){return e.brushMode}}]),e}()).\u0275fac=function(e){return new(e||bc)},bc.\u0275prov=P.Lb({token:bc,factory:bc.\u0275fac}),Rc([Object(E.a)(Dc),Vc("design:type",Function),Vc("design:paramtypes",[Object,Dc]),Vc("design:returntype",void 0)],bc.prototype,"setColorRecipe",null),Rc([Object(E.a)(Ec),Vc("design:type",Function),Vc("design:paramtypes",[Object,Ec]),Vc("design:returntype",void 0)],bc.prototype,"setBrushMode",null),Rc([Object(E.a)(Fc),Vc("design:type",Function),Vc("design:paramtypes",[Object,Fc]),Vc("design:returntype",void 0)],bc.prototype,"clearColorRecipe",null),Rc([Object(E.a)(Ac),Vc("design:type",Function),Vc("design:paramtypes",[Object,Ac]),Vc("design:returntype",void 0)],bc.prototype,"resetPaint",null),Rc([Object(E.e)(),Vc("design:type",Function),Vc("design:paramtypes",[Lc]),Vc("design:returntype",void 0)],bc,"getColorRecipe",null),Rc([Object(E.e)(),Vc("design:type",Function),Vc("design:paramtypes",[Lc]),Vc("design:returntype",void 0)],bc,"getPaintBrushMode",null),bc=Rc([Object(E.f)({name:"editPaint",defaults:Nc})],bc)),Hc=function e(t,n,i){m(this,e),this.label=t,this.width=n,this.height=i},Qc=new Hc("Don't Resize",-1,-1);new Hc("Common (Mobile)",360,640),new Hc("Common (Minimum)",300,300),new Hc("Common (Publish Default)",700,550),new Hc("iPhone X",375,812),new Hc("iPad (Portrait)",768,1024),new Hc("iPad (Landscape)",1024,768);var qc,Wc,$c,Kc,Gc,Zc,Jc=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},Xc=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Yc={view:Uc.Chapter,showColumns:!0,showLeftColumn:!0,showRightColumn:!0,showHeader:!0,showFooter:!0,autoCapture:U.application!==M.Loft,record:!0,layerOrderMode:!1,showTreeNodeIds:!1,canvasSize:Qc,canvasSettings:{emulateDrawer:!0,emulateColumn:!0}},el=((Kc=function(){function e(t){m(this,e),this.storageService=t}return v(e,[{key:"SetLayerOrderMode",value:function(e,t){e.patchState({layerOrderMode:t.layerOrderMode})}},{key:"ShowTreeNodeIds",value:function(e,t){var n=null!=t.show?t.show:!e.getState().showTreeNodeIds;e.patchState({showTreeNodeIds:n})}},{key:"setView",value:function(e,t){e.patchState({view:t.view})}},{key:"nextView",value:function(e,t){var n=e.getState().view,i=Object.values(Uc),o=i[i.indexOf(n)+1]||i[0];e.patchState({view:o})}},{key:"previousView",value:function(e,t){var n=e.getState().view,i=Object.values(Uc),o=i[i.indexOf(n)-1]||i[i.length-1];e.patchState({view:o})}},{key:"showColumns",value:function(e,t){e.patchState({showColumns:t.show})}},{key:"showColumn",value:function(e,t){switch(t.column){case"left":e.patchState({showLeftColumn:t.show});break;case"right":e.patchState({showRightColumn:t.show});break;case"header":e.patchState({showHeader:t.show});break;case"footer":e.patchState({showFooter:t.show})}}},{key:"resetEditPage",value:function(e,t){e.setState(Yc),e.dispatch(new Ac)}},{key:"setCanvasSize",value:function(e,t){e.patchState({canvasSize:t.size})}},{key:"autoCapture",value:function(e,t){e.patchState({autoCapture:t.enable}),U.application===M.Studio&&this.storageService.setLocalItem(Ls.AutoCapture,t.enable)}},{key:"ngxsOnInit",value:function(e){var t=this;setTimeout((function(){t.initAutoCapture(e)}))}},{key:"initAutoCapture",value:function(e){if(U.application===M.Studio){var t=this.storageService.getLocalJSON(Ls.AutoCapture);"boolean"==typeof t&&e.patchState({autoCapture:t})}}}],[{key:"getView",value:function(e){return e.view}},{key:"getShowColumns",value:function(e){return e.showColumns}},{key:"getShowLeftColumn",value:function(e){return e.showLeftColumn}},{key:"getShowRightColumn",value:function(e){return e.showRightColumn}},{key:"getShowHeader",value:function(e){return e.showHeader}},{key:"getShowFooter",value:function(e){return e.showFooter}},{key:"getRecord",value:function(e){return e.record}},{key:"getLayerOrderMode",value:function(e){return e.layerOrderMode}},{key:"getShowTreeNodeIds",value:function(e){return e.showTreeNodeIds}},{key:"getCanvasSize",value:function(e){return e.canvasSize}},{key:"getCanvasSettings",value:function(e){return e.canvasSettings}},{key:"getAutoCapture",value:function(e){return e.autoCapture}}]),e}()).\u0275fac=function(e){return new(e||Kc)(P.Zb(As))},Kc.\u0275prov=P.Lb({token:Kc,factory:Kc.\u0275fac}),Jc([Object(E.a)(Mc),Xc("design:type",Function),Xc("design:paramtypes",[Object,Mc]),Xc("design:returntype",void 0)],Kc.prototype,"SetLayerOrderMode",null),Jc([Object(E.a)(Ic),Xc("design:type",Function),Xc("design:paramtypes",[Object,Ic]),Xc("design:returntype",void 0)],Kc.prototype,"ShowTreeNodeIds",null),Jc([Object(E.a)(Oc),Xc("design:type",Function),Xc("design:paramtypes",[Object,Oc]),Xc("design:returntype",void 0)],Kc.prototype,"setView",null),Jc([Object(E.a)(Cc),Xc("design:type",Function),Xc("design:paramtypes",[Object,Cc]),Xc("design:returntype",void 0)],Kc.prototype,"nextView",null),Jc([Object(E.a)(Sc),Xc("design:type",Function),Xc("design:paramtypes",[Object,Cc]),Xc("design:returntype",void 0)],Kc.prototype,"previousView",null),Jc([Object(E.a)(_c),Xc("design:type",Function),Xc("design:paramtypes",[Object,_c]),Xc("design:returntype",void 0)],Kc.prototype,"showColumns",null),Jc([Object(E.a)(jc),Xc("design:type",Function),Xc("design:paramtypes",[Object,jc]),Xc("design:returntype",void 0)],Kc.prototype,"showColumn",null),Jc([Object(E.a)(Pc),Xc("design:type",Function),Xc("design:paramtypes",[Object,Pc]),Xc("design:returntype",void 0)],Kc.prototype,"resetEditPage",null),Jc([Object(E.a)(zc),Xc("design:type",Function),Xc("design:paramtypes",[Object,zc]),Xc("design:returntype",void 0)],Kc.prototype,"setCanvasSize",null),Jc([Object(E.a)(Tc),Xc("design:type",Function),Xc("design:paramtypes",[Object,Tc]),Xc("design:returntype",void 0)],Kc.prototype,"autoCapture",null),Jc([Object(E.e)(),Xc("design:type",Function),Xc("design:paramtypes",[wc]),Xc("design:returntype",void 0)],Kc,"getView",null),Jc([Object(E.e)(),Xc("design:type",Function),Xc("design:paramtypes",[wc]),Xc("design:returntype",void 0)],Kc,"getShowColumns",null),Jc([Object(E.e)(),Xc("design:type",Function),Xc("design:paramtypes",[wc]),Xc("design:returntype",void 0)],Kc,"getShowLeftColumn",null),Jc([Object(E.e)(),Xc("design:type",Function),Xc("design:paramtypes",[wc]),Xc("design:returntype",void 0)],Kc,"getShowRightColumn",null),Jc([Object(E.e)(),Xc("design:type",Function),Xc("design:paramtypes",[wc]),Xc("design:returntype",void 0)],Kc,"getShowHeader",null),Jc([Object(E.e)(),Xc("design:type",Function),Xc("design:paramtypes",[wc]),Xc("design:returntype",void 0)],Kc,"getShowFooter",null),Jc([Object(E.e)(),Xc("design:type",Function),Xc("design:paramtypes",[wc]),Xc("design:returntype",void 0)],Kc,"getRecord",null),Jc([Object(E.e)(),Xc("design:type",Function),Xc("design:paramtypes",[wc]),Xc("design:returntype",void 0)],Kc,"getLayerOrderMode",null),Jc([Object(E.e)(),Xc("design:type",Function),Xc("design:paramtypes",[wc]),Xc("design:returntype",void 0)],Kc,"getShowTreeNodeIds",null),Jc([Object(E.e)(),Xc("design:type",Function),Xc("design:paramtypes",[wc]),Xc("design:returntype",void 0)],Kc,"getCanvasSize",null),Jc([Object(E.e)(),Xc("design:type",Function),Xc("design:paramtypes",[wc]),Xc("design:returntype",void 0)],Kc,"getCanvasSettings",null),Jc([Object(E.e)(),Xc("design:type",Function),Xc("design:paramtypes",[wc]),Xc("design:returntype",void 0)],Kc,"getAutoCapture",null),Kc=Jc([Object(E.f)({name:"edit",defaults:Yc,children:[Bc]})],Kc)),tl=(($c=function(){function e(){m(this,e)}return v(e,[{key:"onClick",value:function(e){e.stopPropagation(),e.stopImmediatePropagation()}}]),e}()).\u0275fac=function(e){return new(e||$c)},$c.\u0275dir=P.Kb({type:$c,selectors:[["","appEventFence",""]],hostBindings:function(e,t){1&e&&P.cc("click",(function(e){return t.onClick(e,e.target)}))}}),$c),nl=((Wc=function(){function e(){m(this,e)}return v(e,[{key:"iconClass",get:function(){var e="fas fa-"+this.icon;return this.size&&(e+=" fa-"+this.size),e}},{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||Wc)},Wc.\u0275cmp=P.Jb({type:Wc,selectors:[["app-icon"]],inputs:{icon:"icon",size:"size"},decls:1,vars:1,consts:[[3,"ngClass"]],template:function(e,t){1&e&&P.Qb(0,"i",0),2&e&&P.lc("ngClass",t.iconClass)},directives:[ra.i],styles:[""],encapsulation:2,changeDetection:0}),Wc),il=((qc=function(){function e(t){m(this,e),this.engineService=t}return v(e,[{key:"getClipboardAPISupport",value:function(){return"clipboard"in navigator}},{key:"getClipboardAPI",value:function(){return navigator.clipboard}},{key:"copyToClipboard",value:function(e,t){var n=this;if(!0===U.native||U.platform===T.SDK)return new be.a((function(i){n.engineService.fireEvent(Dt.NativeShare,{type:t,value:e}),i.next(!0),i.complete()}));if(this.getClipboardAPISupport()){var i=this.getClipboardAPI();return new be.a((function(t){i.writeText(e).then((function(){t.next(!0),t.complete()})).catch((function(e){t.next(!1),t.complete()}))}))}return Object(G.a)(!1)}},{key:"copyInputFieldValue",value:function(e){e.select();var t=!1;try{t=document.execCommand("copy")}catch(n){t=!1}return t}}]),e}()).\u0275fac=function(e){return new(e||qc)(P.Zb(Nt))},qc.\u0275prov=P.Lb({token:qc,factory:qc.\u0275fac,providedIn:"root"}),qc),ol=h("dNgK"),rl=["app-button",""],al=function(e,t,n,i,o,r,a,s,c,l,u,p,d,g,h,f,b,v,m,y,x,k){return{"app-button--xsmall":e,"app-button--small":t,"app-button--medium":n,"app-button--large":i,"app-button--flat":o,"app-button--default":r,"app-button--primary":a,"app-button--info":s,"app-button--outline":c,"app-button--text":l,"app-button--light":u,"app-button--dark":p,"app-button--themed":d,"app-button--circle":g,"app-button--rounded":h,"app-button--square":f,"app-button--selected":b,"app-button--uppercase":v,"app-button--disabled":m,"app-button--no-border":y,"app-button--expanded":x,"app-button--left":k}},sl=["*"],cl=function(e){return e.XSmall="xsmall",e.Small="small",e.Medium="medium",e.Large="large",e}({}),ll=function(e){return e.Default="default",e.Flat="flat",e.Primary="primary",e.Info="info",e.Outline="outline",e.Text="text",e}({}),ul=function(e){return e.Default="default",e.Circle="circle",e.Rounded="rounded",e.Square="square",e}({}),pl=function(e){return e.Dark="dark",e.Light="light",e.Themed="themed",e}({}),dl=function(e){return e.Left="left",e.Center="center",e}({}),gl=((Gc=function(){function e(){m(this,e),this.buttonSize=cl.Medium,this.buttonType=ll.Default,this.buttonTheme=pl.Dark,this.buttonShape=ul.Default,this.buttonAlign=dl.Center,this.uppercase=!0,this.selected=!1,this.expanded=!1,this.bordered=!0}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||Gc)},Gc.\u0275cmp=P.Jb({type:Gc,selectors:[["button","app-button",""],["a","app-button",""]],hostVars:1,hostBindings:function(e,t){2&e&&P.Yb("disabled",t.disabled)},inputs:{buttonSize:"buttonSize",buttonType:"buttonType",buttonTheme:"buttonTheme",buttonShape:"buttonShape",buttonAlign:"buttonAlign",uppercase:"uppercase",selected:"selected",expanded:"expanded",disabled:"disabled",bordered:"bordered"},attrs:rl,ngContentSelectors:sl,decls:3,vars:24,consts:[[1,"app-button",3,"ngClass"],[1,"app-button__container"]],template:function(e,t){1&e&&(P.kc(),P.Vb(0,"div",0),P.Vb(1,"div",1),P.jc(2),P.Ub(),P.Ub()),2&e&&P.lc("ngClass",P.tc(1,al,["xsmall"==t.buttonSize,"small"==t.buttonSize,"medium"==t.buttonSize,"large"==t.buttonSize,"flat"==t.buttonType,"default"==t.buttonType,"primary"==t.buttonType,"info"==t.buttonType,"outline"==t.buttonType,"text"==t.buttonType,"light"==t.buttonTheme,"dark"==t.buttonTheme,"themed"==t.buttonTheme,"circle"==t.buttonShape,"rounded"==t.buttonShape,"square"==t.buttonShape,t.selected,t.uppercase,t.disabled,!t.bordered,t.expanded,"left"===t.buttonAlign]))},directives:[ra.i],styles:['.text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3838}.text-info{color:#0060c4}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}a[app-button],button[app-button]{border-color:transparent;background:none;border-width:0;padding:0;margin:0;outline:0 none}a[app-button]:not([disabled]):hover,button[app-button]:not([disabled]):hover{cursor:pointer}a[app-button]:focus .app-button--themed,button[app-button]:focus .app-button--themed{background:#f1f4fa;outline:none}.app-button{font-size:12px;letter-spacing:.3px;line-height:1.4em;align-items:center;border-radius:4px;display:flex;font-family:Inter UI,sans-serif;justify-content:center;padding:0 16px;position:relative;text-align:center;transition:background-color .12s;width:100%}.app-button:after{content:" ";background-color:#283853;border-radius:4px;display:block;position:absolute;left:0;top:0;bottom:0;right:0;opacity:0;z-index:1;transition:opacity .06s}.app-button:not(.app-button--disabled):hover:after{opacity:.7}.app-button__container{position:relative;z-index:2;width:100%}.app-button--uppercase{text-transform:uppercase}.app-button--expanded{display:flex;flex:1}.app-button--xsmall{height:24px;min-width:24px;padding:0 8px;font-size:10px;letter-spacing:.25px;line-height:1.4em}.app-button--small{height:32px;min-width:32px;padding:0 12px}.app-button--medium,.app-button--small{font-size:12px;letter-spacing:.3px;line-height:1.4em}.app-button--medium{height:36px;min-width:36px;padding:0 16px}.app-button--large{height:48px;min-width:48px;padding:0 16px;font-size:14px;letter-spacing:.35px;line-height:1.4em}.app-button--no-border,.app-button--no-border:after{border-radius:0!important}.app-button--left{text-align:left}.app-button--themed{color:#374a68;color:var(--app-button-color)}.app-button--themed:hover{color:#1c2a3f;color:var(--app-button-color--hover)}.app-button--themed:after{background-color:#d7e0ea;background-color:var(--app-button-bg--hover)}.app-button--dark{color:#d7e0ea}.app-button--dark:hover{color:#fff}.app-button--dark:after{background-color:#283853}.app-button--dark.app-button--flat{background:#374a68}.app-button--dark.app-button--default{background:transparent}.app-button--dark.app-button--outline{background:transparent;border:1px solid #374a68;transition:border-color .12s}.app-button--dark.app-button--outline:hover{border-color:#96a8c0}.app-button--dark.app-button--outline:hover:after{background-color:transparent;display:none}.app-button--dark.app-button--text{background:transparent;color:#d7e0ea}.app-button--dark.app-button--text:hover{color:#fff}.app-button--dark.app-button--text:hover:after{display:none}.app-button--dark.app-button--selected{background-color:#1c5ab9;color:#fff}.app-button--dark.app-button--selected:hover:after{display:none}.app-button--light{color:#283853}.app-button--light:hover{color:#1c2a3f}.app-button--light:after{background-color:#96a8c0}.app-button--light:not(.app-button--disabled):hover:after{opacity:.6}.app-button--light.app-button--flat{background:#d7e0ea;font-weight:500}.app-button--light.app-button--flat.app-button--selected{background-color:#96a8c0}.app-button--light.app-button--default{background:transparent;color:#131c2a}.app-button--light.app-button--default:not(.app-button--disabled):hover:after{opacity:.2}.app-button--light.app-button--outline{background:transparent;border:1px solid #96a8c0;color:#283853;transition:border-color .12s}.app-button--light.app-button--outline:after{display:none}.app-button--light.app-button--outline:hover{background:rgba(55,74,104,.05);border-color:#374a68;color:#1c2a3f}.app-button--light.app-button--outline:hover:after{background-color:transparent}.app-button--light.app-button--selected{background-color:#eaeff5}.app-button--light.app-button--selected:hover:after{display:none}.app-button--light.app-button--text{color:#283853}.app-button--light.app-button--text:hover{color:#1c2a3f}.app-button--light.app-button--text:hover:after{display:none}.app-button.app-button--primary{background:#de3838;color:#fff}.app-button.app-button--primary:after{background:#f9fafd}.app-button.app-button--primary:hover:after{opacity:.1}.app-button.app-button--info{background:#2d72dc;color:#fff}.app-button.app-button--info:after{background:#f9fafd}.app-button.app-button--info:hover:after{opacity:.1}.app-button--selected{background-color:#1c5ab9}.app-button--disabled{opacity:.5}.app-button--circle{border-radius:50%}.app-button--circle.app-button--xsmall{width:24px}.app-button--circle.app-button--small{width:32px;padding:0 6px}.app-button--circle.app-button--medium{width:36px;padding:0 8px}.app-button--circle.app-button--large{width:48px}.app-button--circle:after{border-radius:50%}.app-button--square{padding:0}.app-button--square.app-button--xsmall{width:24px;height:24px}.app-button--square.app-button--small{width:32px;height:32px}.app-button--square.app-button--medium{width:36px;height:36px}.app-button--square.app-button--large{width:48px;height:48px}.app-button--rounded,.app-button--rounded:after{border-radius:18px}'],encapsulation:2,changeDetection:0}),Gc),hl=h("STbY"),fl=function(e){return e.All="all",e.iOS="ios",e.Android="android",e}({}),bl=((Zc=function(){function e(t,n,i){m(this,e),this.templateRef=t,this.viewContainer=n,this.router=i,this._appFlagApplicationMode="include"}return v(e,[{key:"appFlagApplication",get:function(){return this._appFlagApplication},set:function(e){this._appFlagApplication=e}},{key:"appFlagApplicationMode",get:function(){return this._appFlagApplicationMode},set:function(e){this._appFlagApplicationMode=e}},{key:"appFlagApplicationPage",get:function(){return this._appFlagApplicationPage},set:function(e){this._appFlagApplicationPage=e}},{key:"appFlagApplicationPlatform",get:function(){return this._appFlagApplicationPlatform},set:function(e){this._appFlagApplicationPlatform=e}},{key:"appFlagApplicationNative",get:function(){return this._appFlagApplicationNative},set:function(e){this._appFlagApplicationNative=e}},{key:"ngOnInit",value:function(){this.update()}},{key:"update",value:function(){var e,t=!1,n=!1,i=!1,o=!1;if(""===this.appFlagApplication?t=!0:Array.isArray(this.appFlagApplication)?t=this.appFlagApplication.some((function(e){return e===U.application})):"string"==typeof this.appFlagApplication&&(t=this.appFlagApplication===U.application),null==this.appFlagApplicationPage)n=!0;else{var r=this.router.url;Array.isArray(this.appFlagApplicationPage)?n=this.appFlagApplicationPage.some((function(e){return r.indexOf(e)>=0})):"string"==typeof this.appFlagApplicationPage&&(n=r.indexOf(this.appFlagApplicationPage)>=0)}if(null==this.appFlagApplicationPlatform)i=!0;else{var a=U.platform;Array.isArray(this.appFlagApplicationPlatform)?i=this.appFlagApplicationPlatform.some((function(e){return a.indexOf(e)>=0})):"string"==typeof this.appFlagApplicationPlatform&&(i=a.indexOf(this.appFlagApplicationPlatform)>=0)}null==this.appFlagApplicationNative?o=!0:(o=U.native,(Array.isArray(this.appFlagApplicationNative)?this.appFlagApplicationNative:[this.appFlagApplicationNative]).includes(fl.iOS)&&(o=U.native&&void 0!==window.webkit)),(e=t&&n&&i&&o)&&"include"===this.appFlagApplicationMode||!e&&"exclude"===this.appFlagApplicationMode?this.viewContainer.createEmbeddedView(this.templateRef):this.viewContainer.clear()}}]),e}()).\u0275fac=function(e){return new(e||Zc)(P.Pb(P.O),P.Pb(P.S),P.Pb(Oe.e))},Zc.\u0275dir=P.Kb({type:Zc,selectors:[["","appFlagApplication",""]],inputs:{appFlagApplication:"appFlagApplication",appFlagApplicationMode:"appFlagApplicationMode",appFlagApplicationPage:"appFlagApplicationPage",appFlagApplicationPlatform:"appFlagApplicationPlatform",appFlagApplicationNative:"appFlagApplicationNative"}}),Zc),vl=h("f0Cb"),ml=["nodeActionsTrigger"];function yl(e,t){if(1&e&&(P.Tb(0),P.Vb(1,"button",31),P.Mc(2,"Select"),P.Ub(),P.Qb(3,"mat-divider"),P.Sb()),2&e){P.gc();var n=P.vc(21);P.Db(1),P.lc("matMenuTriggerFor",n)}}function xl(e,t){if(1&e){var n=P.Wb();P.Vb(0,"button",32),P.cc("click",(function(){P.zc(n);var e=P.gc();return e.toggleVisible(e.node,!0)})),P.Mc(1,"Show"),P.Ub()}}function kl(e,t){if(1&e){var n=P.Wb();P.Vb(0,"button",33),P.cc("click",(function(){P.zc(n);var e=P.gc();return e.toggleVisible(e.node,!1)})),P.Mc(1,"Hide"),P.Ub()}}function wl(e,t){if(1&e&&(P.Tb(0),P.Qb(1,"mat-divider"),P.Vb(2,"button",34),P.Mc(3,"Pickable / Unpickable"),P.Ub(),P.Sb()),2&e){P.gc();var n=P.vc(40);P.Db(2),P.lc("matMenuTriggerFor",n)}}function Ol(e,t){if(1&e){var n=P.Wb();P.Tb(0),P.Qb(1,"mat-divider"),P.Vb(2,"button",35),P.cc("click",(function(){P.zc(n);var e=P.gc();return e.editNodeLabel(e.node)})),P.Mc(3,"Edit Object Name"),P.Ub(),P.Sb()}}function Cl(e,t){if(1&e&&(P.Tb(0),P.Qb(1,"mat-divider"),P.Vb(2,"button",36),P.Mc(3,"Copy"),P.Ub(),P.Sb()),2&e){P.gc();var n=P.vc(47);P.Db(2),P.lc("matMenuTriggerFor",n)}}function Sl(e,t){if(1&e){var n=P.Wb();P.Vb(0,"button",37),P.cc("click",(function(){P.zc(n);var e=P.gc();return e.toggleVisible(e.node,!0)})),P.Mc(1,"Show This"),P.Ub()}}function _l(e,t){if(1&e){var n=P.Wb();P.Vb(0,"button",38),P.cc("click",(function(){P.zc(n);var e=P.gc();return e.toggleVisible(e.node,!1)})),P.Mc(1,"Hide This"),P.Ub()}}function jl(e,t){if(1&e){var n=P.Wb();P.Vb(0,"button",39),P.cc("click",(function(){P.zc(n);var e=P.gc();return e.togglePickable(e.node,!1)})),P.Mc(1,"Make Unpickable"),P.Ub()}}function Pl(e,t){if(1&e){var n=P.Wb();P.Vb(0,"button",40),P.cc("click",(function(){P.zc(n);var e=P.gc();return e.togglePickable(e.node,!0)})),P.Mc(1,"Make Pickable"),P.Ub()}}var Ml,Il,zl,Tl=((zl=function(){function e(t,n,i,o,r,a,s){m(this,e),this.store=t,this.graphService=n,this.changeDetectorRef=i,this.clipboardService=o,this.snackbar=r,this.cameraService=a,this.engineService=s,this.application=M,this.shortId="",this.theme="dark",this.eventCategory="",this.nodeActionsClosed=new P.p}return v(e,[{key:"node",get:function(){return this._node},set:function(e){this._node=e;var t=this.node.id.split("-");this.shortId=2===t.length?t[1]:t[0]}},{key:"ngOnInit",value:function(){}},{key:"isNodeChecked",value:function(e){return this.store.selectSnapshot(Ai.getNodes)[e].checked}},{key:"isNodeShown",value:function(e){return this.store.selectSnapshot(Ai.getNodes)[e].shown}},{key:"checkNode",value:function(e,t){var n=void 0===t?!this.isNodeChecked(e.id):t;this.store.dispatch(new pi.UpdateNodesChecked(n,[e.id]))}},{key:"checkInverse",value:function(e){this.store.dispatch(new pi.UpdateNodesChecked(!0)),this.store.dispatch(new pi.UpdateNodesChecked(!1,[e.id]))}},{key:"setCheckedNodes",value:function(e,t){this.store.dispatch(new pi.UpdateNodesChecked(!1));var n=void 0===t?!this.isNodeChecked(e.id):t;this.store.dispatch(new pi.UpdateNodesChecked(n,[e.id]))}},{key:"flyToNode",value:function(e){this.store.dispatch(new Qe(e.id))}},{key:"hideNode",value:function(e){this.store.dispatch(new pi.UpdateNodesShown(!1,[e.id]))}},{key:"hideInverse",value:function(e){var t=this.store.selectSnapshot(Wr.getViewGraph),n=this.graphService.getAllLeafDescendants(t,[e.id]),i=this.graphService.getInverseSelection(t,[e.id]),o={};n.forEach((function(e){o[e]=!0})),i.forEach((function(e){o[e]=!1}));var r=new pi.UpdateNodesShown(void 0,void 0,o),a=Si(this.store.selectSnapshot(Ai),r);this.store.dispatch(new pi.ApplyPatch(a.patches));var s,c,l,u=this.engineService.getObjectBoundary(e.id),d=this.cameraService.cameraAfterFlyTo(u),g=new ln(d),h=(s=this.store.selectSnapshot(Ar),c=g,{nextState:(l=p(immer.produceWithPatches(s,(function(e){e.cameraFlyTo=c.camera})),3))[0],patches:l[1],inversePatches:l[2]});this.store.dispatch(new un(h.patches)),this.store.dispatch(new pi.UpdateNodeSelected),this.store.dispatch(new pi.UpdateNodesChecked(!1)),this.store.dispatch(new di.SavePatches([{forward:a.patches,inverse:a.inversePatches,patchAction:pi.ApplyPatch},{forward:h.patches,inverse:h.inversePatches,patchAction:un}]))}},{key:"showNode",value:function(e){this.store.dispatch(new pi.UpdateNodesShown(!0,[e.id])),this.changeDetectorRef.markForCheck()}},{key:"toggleVisible",value:function(e,t){var n=void 0===t?this.isNodeShown(e.id):t;this.store.dispatch(new pi.UpdateNodesShown(n,[e.id])),this.changeDetectorRef.markForCheck()}},{key:"togglePickable",value:function(e,t){this.store.dispatch(new pi.UpdateNodesPickable(t,[e.id])),this.changeDetectorRef.markForCheck()}},{key:"makeEverythingElseUnpickale",value:function(e){this.store.dispatch(new pi.UpdateNodesPickable(!1)),this.store.dispatch(new pi.UpdateNodesPickable(!0,[e.id]))}},{key:"fadeInverseNodes",value:function(e){var t=this.store.selectSnapshot(Wr.getViewGraph),n=this.graphService.getInverseSelection(t,[e.id]),i=this.graphService.getNodes(t,n);this.store.dispatch(new pi.UpdateNodesPaint(Zi.recipe,i.map((function(e){return e.id}))))}},{key:"fadeNode",value:function(e){this.store.dispatch(new pi.UpdateNodesPaint(Zi.recipe,[e.id]))}},{key:"editNodeLabel",value:function(e){this.store.dispatch(new mt(e))}},{key:"copy",value:function(e){var t=this;this.clipboardService.copyToClipboard(e,"text").subscribe((function(){t.snackbar.open("Copied ".concat(e," to clipboard."))}))}},{key:"onMenuClosed",value:function(){this.nodeActionsClosed.emit()}}]),e}()).\u0275fac=function(e){return new(e||zl)(P.Pb(E.g),P.Pb(Ut),P.Pb(P.i),P.Pb(il),P.Pb(ol.b),P.Pb(gn),P.Pb(Nt))},zl.\u0275cmp=P.Jb({type:zl,selectors:[["app-node-actions"]],viewQuery:function(e,t){var n;1&e&&P.Gc(ml,!0),2&e&&P.uc(n=P.dc())&&(t.nodeActionsTrigger=n.first)},inputs:{node:"node",theme:"theme",eventCategory:"eventCategory"},outputs:{nodeActionsClosed:"nodeActionsClosed"},decls:55,vars:21,consts:[[3,"gaCategory"],["app-button","","data-test","nodeActionsTrigger","buttonSize","xsmall",3,"buttonTheme","matMenuTriggerFor","menuClosed"],["nodeActionsTrigger","matMenuTrigger"],["icon","ellipsis-v"],[3,"overlapTrigger"],["nodeActions","matMenu"],[4,"appFlagApplication","appFlagApplicationPage","appFlagApplicationMode"],["gaEvent","","gaAction","Clicked Show","mat-menu-item","","data-test","nodeActionsShow",3,"click",4,"ngIf"],["gaEvent","","gaAction","Clicked Hide","mat-menu-item","","data-test","nodeActionsHide",3,"click",4,"ngIf"],["gaEvent","","gaAction","Clicked Isolate","mat-menu-item","","data-test","nodeActionsIsolate",3,"click"],["data-test","nodeActionsFadeTrigger","mat-menu-item","",3,"matMenuTriggerFor"],[4,"appFlagApplication"],["gaEvent","","gaAction","Clicked Fly To","mat-menu-item","","data-test","nodeActionsFlyTo",3,"click"],["selectActions","matMenu"],["gaEvent","","gaAction","Clicked Select This","mat-menu-item","","data-test","nodeActionsSelectThis",3,"click"],["gaEvent","","gaAction","Clicked Select Everything Else","mat-menu-item","","data-test","nodeActionsSelectEverythingElse",3,"click"],["fadeActions","matMenu"],["gaEvent","","gaAction","Clicked Fade This","mat-menu-item","","data-test","nodeActionsFadeThis",3,"click"],["gaEvent","","gaAction","Clicked Fade Everything Else","mat-menu-item","","data-test","nodeActionsFadeEverythingElse",3,"click"],["showHideActions","matMenu"],["gaEvent","","gaAction","Clicked Show This","mat-menu-item","","data-test","nodeActionsShowThis",3,"click",4,"ngIf"],["gaEvent","","gaAction","Clicked Hide This","mat-menu-item","","data-test","nodeActionsShowEverythingElse",3,"click",4,"ngIf"],["gaEvent","","gaAction","Clicked Hide Everything Else","mat-menu-item","",3,"click"],["pickableActions","matMenu"],["gaEvent","","gaAction","Clicked Make Unpickable","mat-menu-item","","data-test","nodeActionsPickable",3,"click",4,"ngIf"],["gaEvent","","gaAction","Clicked Make Pickable","mat-menu-item","","data-test","nodeActionsUnpickable",3,"click",4,"ngIf"],["gaEvent","","gaAction","Clicked Make Everything Else Unpickable","mat-menu-item","","data-test","nodeActionsEverythingElseUnpickable",3,"click"],["copyActions","matMenu"],["gaEvent","","gaAction","Clicked Copy Short ID","mat-menu-item","","data-test","nodeActionsCopyShortID",3,"click"],["gaEvent","","gaAction","Clicked Copy Full ID","mat-menu-item","","data-test","nodeActionsCopyFullID",3,"click"],["gaEvent","","gaAction","Clicked Copy Display Name","mat-menu-item","","data-test","nodeActionsCopyDisplayName",3,"click"],["mat-menu-item","",3,"matMenuTriggerFor"],["gaEvent","","gaAction","Clicked Show","mat-menu-item","","data-test","nodeActionsShow",3,"click"],["gaEvent","","gaAction","Clicked Hide","mat-menu-item","","data-test","nodeActionsHide",3,"click"],["mat-menu-item","","data-test","nodeActionsPickableTrigger",3,"matMenuTriggerFor"],["gaEvent","","gaAction","Clicked Edit Object Name","mat-menu-item","","data-test","nodeActionsEditName",3,"click"],["mat-menu-item","","data-test","nodeActionsCopyTrigger",3,"matMenuTriggerFor"],["gaEvent","","gaAction","Clicked Show This","mat-menu-item","","data-test","nodeActionsShowThis",3,"click"],["gaEvent","","gaAction","Clicked Hide This","mat-menu-item","","data-test","nodeActionsShowEverythingElse",3,"click"],["gaEvent","","gaAction","Clicked Make Unpickable","mat-menu-item","","data-test","nodeActionsPickable",3,"click"],["gaEvent","","gaAction","Clicked Make Pickable","mat-menu-item","","data-test","nodeActionsUnpickable",3,"click"]],template:function(e,t){if(1&e&&(P.Tb(0,0),P.Vb(1,"button",1,2),P.cc("menuClosed",(function(){return t.onMenuClosed()})),P.Qb(3,"app-icon",3),P.Ub(),P.Vb(4,"mat-menu",4,5),P.Kc(6,yl,4,1,"ng-container",6),P.Kc(7,xl,2,0,"button",7),P.Kc(8,kl,2,0,"button",8),P.Vb(9,"button",9),P.cc("click",(function(){return t.hideInverse(t.node)})),P.Mc(10,"Isolate"),P.Ub(),P.Qb(11,"mat-divider"),P.Vb(12,"button",10),P.Mc(13,"Fade"),P.Ub(),P.Kc(14,wl,4,1,"ng-container",11),P.Qb(15,"mat-divider"),P.Vb(16,"button",12),P.cc("click",(function(){return t.flyToNode(t.node)})),P.Mc(17,"Fly To"),P.Ub(),P.Kc(18,Ol,4,0,"ng-container",6),P.Kc(19,Cl,4,1,"ng-container",6),P.Ub(),P.Vb(20,"mat-menu",null,13),P.Vb(22,"button",14),P.cc("click",(function(){return t.checkNode(t.node,!0)})),P.Mc(23,"Select This"),P.Ub(),P.Vb(24,"button",15),P.cc("click",(function(){return t.checkInverse(t.node)})),P.Mc(25,"Select Everything Else"),P.Ub(),P.Ub(),P.Vb(26,"mat-menu",null,16),P.Vb(28,"button",17),P.cc("click",(function(){return t.fadeNode(t.node)})),P.Mc(29,"Fade This"),P.Ub(),P.Vb(30,"button",18),P.cc("click",(function(){return t.fadeInverseNodes(t.node)})),P.Mc(31,"Fade Everything Else"),P.Ub(),P.Ub(),P.Vb(32,"mat-menu",null,19),P.Kc(34,Sl,2,0,"button",20),P.Kc(35,_l,2,0,"button",21),P.Qb(36,"mat-divider"),P.Vb(37,"button",22),P.cc("click",(function(){return t.hideInverse(t.node)})),P.Mc(38,"Hide Everything Else"),P.Ub(),P.Ub(),P.Vb(39,"mat-menu",null,23),P.Kc(41,jl,2,0,"button",24),P.Kc(42,Pl,2,0,"button",25),P.Qb(43,"mat-divider"),P.Vb(44,"button",26),P.cc("click",(function(){return t.makeEverythingElseUnpickale(t.node)})),P.Mc(45,"Make Everything Else Unpickable"),P.Ub(),P.Ub(),P.Vb(46,"mat-menu",null,27),P.Vb(48,"button",28),P.cc("click",(function(){return t.copy(t.shortId)})),P.Mc(49,"Copy Short ID"),P.Ub(),P.Vb(50,"button",29),P.cc("click",(function(){return t.copy(t.node.id)})),P.Mc(51,"Copy Full ID"),P.Ub(),P.Qb(52,"mat-divider"),P.Vb(53,"button",30),P.cc("click",(function(){return t.copy(t.node.label)})),P.Mc(54,"Copy Display Name"),P.Ub(),P.Ub(),P.Sb()),2&e){var n=P.vc(5),i=P.vc(27);P.lc("gaCategory",t.eventCategory),P.Db(1),P.lc("buttonTheme",t.theme)("matMenuTriggerFor",n),P.Db(3),P.lc("overlapTrigger",!0),P.Db(2),P.lc("appFlagApplication",t.application.All)("appFlagApplicationPage","/edit")("appFlagApplicationMode","include"),P.Db(1),P.lc("ngIf",!t.node.boolState.shown),P.Db(1),P.lc("ngIf",t.node.boolState.shown),P.Db(4),P.lc("matMenuTriggerFor",i),P.Db(2),P.lc("appFlagApplication",t.application.Loft),P.Db(4),P.lc("appFlagApplication",t.application.Loft)("appFlagApplicationPage","/edit")("appFlagApplicationMode","include"),P.Db(1),P.lc("appFlagApplication",t.application.Loft)("appFlagApplicationPage","/edit")("appFlagApplicationMode","include"),P.Db(15),P.lc("ngIf",!t.node.boolState.shown),P.Db(1),P.lc("ngIf",t.node.boolState.shown),P.Db(6),P.lc("ngIf",t.node.boolState.pickable),P.Db(1),P.lc("ngIf",!t.node.boolState.pickable)}},directives:[Ce.a,gl,hl.d,nl,hl.a,bl,ra.l,Ce.b,hl.b,vl.a],styles:[""],changeDetection:0}),zl),Ul=((Il=function(){function e(){m(this,e)}return v(e,[{key:"supportsWebGl",value:function(){var e=document.createElement("canvas"),t=e.getContext("webgl")||e.getContext("experimental-webgl");return t&&t instanceof WebGLRenderingContext}},{key:"isHoverSupported",value:function(){return window.matchMedia("(hover: hover)").matches}}]),e}()).\u0275fac=function(e){return new(e||Il)},Il.\u0275prov=P.Lb({token:Il,factory:Il.\u0275fac,providedIn:"root"}),Il),Ll=((Ml=function(){function e(t,n){m(this,e),this.el=t,this.compatibilityService=n}return v(e,[{key:"ngAfterContentInit",value:function(){var e=this;this.compatibilityService.isHoverSupported()&&setTimeout((function(){e.el.nativeElement.focus()}),0)}}]),e}()).\u0275fac=function(e){return new(e||Ml)(P.Pb(P.m),P.Pb(Ul))},Ml.\u0275dir=P.Kb({type:Ml,selectors:[["input","appAutoFocus",""]]}),Ml),Dl=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},El=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Fl(e,t){if(1&e){var n=P.Wb();P.Vb(0,"div",9),P.cc("click",(function(){P.zc(n);var e=P.gc();return e.handleExpandClick(e.node,e.node.boolState.expanded)})),P.Qb(1,"app-icon",10),P.Ub()}if(2&e){var i=P.gc();P.Hb("tree-node__expand--open",i.node.boolState.expanded)}}function Al(e,t){if(1&e&&(P.Vb(0,"div",15),P.Mc(1),P.Ub()),2&e){var n=P.gc(2);P.Db(1),P.Oc(" ",n.shortId," ")}}var Rl=function(e){return{"tree-node__label--padded":e}};function Vl(e,t){if(1&e){var n=P.Wb();P.Vb(0,"div",11),P.cc("dblclick",(function(){return P.zc(n),P.gc().setEditLabelMode(!0)})),P.Vb(1,"div",12),P.Kc(2,Al,2,1,"div",13),P.hc(3,"async"),P.Vb(4,"div",14),P.Mc(5),P.Ub(),P.Ub(),P.Ub()}if(2&e){var i=P.gc();P.lc("ngClass",P.oc(5,Rl,!i.hasChildren&&i.nested)),P.Db(2),P.lc("ngIf",P.ic(3,3,i.showTreeNodeIds$)),P.Db(3),P.Oc(" ",i.node.label," ")}}function Nl(e,t){if(1&e){var n=P.Wb();P.Vb(0,"input",16),P.cc("blur",(function(e){return P.zc(n),P.gc().handleObjectLabel(e)}))("keyup",(function(e){return P.zc(n),P.gc().handleObjectLabel(e)})),P.Ub()}if(2&e){var i=P.gc();P.lc("value",i.node.label)}}function Bl(e,t){if(1&e){var n=P.Wb();P.Vb(0,"input",17),P.cc("change",(function(e){P.zc(n);var t=P.gc();return t.handleLayerOrder(e,t.node)})),P.Ub()}if(2&e){var i=P.gc();P.lc("value",i.node.numState.layer)}}var Hl,Ql=function(e,t,n,i,o){return{"tree-node--light":e,"tree-node--themed":t,"tree-node--hidden":n,"tree-node--selected":i,"tree-node--unpickable":o}},ql=((Hl=function(){function e(t,n,i,o,r){m(this,e),this.store=t,this.graphService=n,this.engineService=i,this.router=o,this.changeDetection=r,this.treeTheme=mc,this.isLoft="module"===U.exportType,this.nested=!0,this.theme=mc.Dark,this.checked=!1,this.hasChildren=!1,this.editLabelMode=!1,this.sanitizedID="",this.parentId="",this.shortId="",this.ngUnsubscribe=new fe.a}return v(e,[{key:"node",get:function(){return this._node},set:function(e){this._node=e,this.sanitizedID=this.graphService.sanitizeNodeID(this.node.id),this.checked=this.isNodeChecked(this.node.id);var t=this.node.id.split("-");2===t.length?(this.parentId=t[0],this.shortId=t[1]):(this.shortId=t[0],this.parentId=""),this.shortId=this.shortId.replace(/_/g," "),this.nested&&(this.hasChildren=ke.getSuccessors(this.graph,this.node.id).length>0),this.changeDetection.markForCheck()}},{key:"isNodeChecked",value:function(e){return this.store.selectSnapshot(Ai.getNodes)[e].checked}},{key:"isNodeShown",value:function(e){return this.store.selectSnapshot(Ai.getNodes)[e].shown}},{key:"ngOnInit",value:function(){var e=this;this.checkedNodesIds$.pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){e.checked=t.some((function(t){return t===e.node.id})),e.changeDetection.markForCheck()})),this.labelEditNode$.pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){e.editLabelMode=t===e.node})),this.isEditMode=this.router.url.indexOf("/edit")>=0}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"handleExpandClick",value:function(e,t){this.store.dispatch(t?new bt(e):new ft(e))}},{key:"handleNodeClick",value:function(e,t){e.shiftKey?this.checkNode(t):(this.setCheckedNodes(t),this.isFlyToNodeEnabled(t)&&this.store.dispatch(new Qe(t.id)),this.handleExpandClick(t,!t.boolState.expanded))}},{key:"toggleVisible",value:function(e,t){var n=void 0===t?!this.isNodeShown(e.id):t;this.store.dispatch(new pi.UpdateNodesShown(n,[e.id])),this.changeDetection.markForCheck()}},{key:"handleLayerOrder",value:function(e,t){var n=parseInt(e.target.value,10);this.setLayerOrder(t,n)}},{key:"checkNode",value:function(e,t){var n=void 0===t?!this.isNodeChecked(e.id):t;this.store.dispatch(new pi.UpdateNodesChecked(n,[e.id]))}},{key:"setCheckedNodes",value:function(e,t){this.store.dispatch(new pi.UpdateNodesChecked(!1));var n=void 0===t?!this.isNodeChecked(e.id):t;this.store.dispatch(new pi.UpdateNodesChecked(n,[e.id]))}},{key:"setLayerOrder",value:function(e,t){this.store.dispatch(new at([e],t)),this.changeDetection.markForCheck()}},{key:"handleObjectLabel",value:function(e){var t=e.target;e instanceof KeyboardEvent?("enter"===e.key.toLowerCase()&&(this.setLabel(t.value),this.setEditLabelMode(!1)),"escape"===e.key.toLowerCase()&&this.setEditLabelMode(!1)):e instanceof FocusEvent&&"blur"===e.type&&(this.setLabel(t.value),this.setEditLabelMode(!1))}},{key:"setLabel",value:function(e){this.node.label=e,this.store.dispatch(new st(this.node.id,e))}},{key:"setEditLabelMode",value:function(e){U.application===M.Loft&&this.isEditMode&&this.store.dispatch(new mt(e?this.node:null))}},{key:"isFlyToNodeEnabled",value:function(e){return!this.isEditMode&&(e.boolState.shown||this.engineService.getObjectLoaded(e.id))}}]),e}()).\u0275fac=function(e){return new(e||Hl)(P.Pb(E.g),P.Pb(Ut),P.Pb(Nt),P.Pb(Oe.e),P.Pb(P.i))},Hl.\u0275cmp=P.Jb({type:Hl,selectors:[["app-tree-nested-node"]],inputs:{graph:"graph",node:"node",nested:"nested",theme:"theme"},decls:10,vars:17,consts:[["gaCategory","Search Node","data-test","treeNode","tabindex","0",1,"tree-node",3,"ngClass","keyup.enter","click"],["appEventFence","","class","tree-node__expand","data-test","treeNodeExpand",3,"tree-node__expand--open","click",4,"ngIf"],["class","tree-node__label",3,"ngClass","dblclick",4,"ngIf"],["type","text","appEventFence","","appAutoFocus","","data-test","treeNodeEditLabel","class","input",3,"value","blur","keyup",4,"ngIf"],["appEventFence","","type","text","data-test","treeNodeLayerOrder","class","input input--small tree-node__layer-order",3,"value","change",4,"ngIf"],["gaEvent","","gaAction","Clicked Toggle (Eye Icon)","data-test","treeNodeVisible","appEventFence","",1,"tree-node__visible",3,"gaLabel","click"],["icon","eye","data-test","treeNodeVisibleTrue","size","xs",1,"tree-node__eye"],["icon","eye-slash","data-test","treeNodeVisibleFalse","size","xs",1,"tree-node__eye-slash"],["eventCategory","Search Node","appEventFence","",3,"theme","node"],["appEventFence","","data-test","treeNodeExpand",1,"tree-node__expand",3,"click"],["icon","caret-right"],[1,"tree-node__label",3,"ngClass","dblclick"],[1,"flex","flex-column"],["data-test","treeNodeId","class","text-10 text-uppercase","style","opacity: 0.7;",4,"ngIf"],["data-test","treeNodeLabel"],["data-test","treeNodeId",1,"text-10","text-uppercase",2,"opacity","0.7"],["type","text","appEventFence","","appAutoFocus","","data-test","treeNodeEditLabel",1,"input",3,"value","blur","keyup"],["appEventFence","","type","text","data-test","treeNodeLayerOrder",1,"input","input--small","tree-node__layer-order",3,"value","change"]],template:function(e,t){1&e&&(P.Vb(0,"div",0),P.cc("keyup.enter",(function(e){return t.handleNodeClick(e,t.node)}))("click",(function(e){return t.handleNodeClick(e,t.node)})),P.Kc(1,Fl,2,2,"div",1),P.Kc(2,Vl,6,7,"div",2),P.Kc(3,Nl,1,1,"input",3),P.Kc(4,Bl,1,1,"input",4),P.hc(5,"async"),P.Vb(6,"div",5),P.cc("click",(function(){return t.toggleVisible(t.node)})),P.Qb(7,"app-icon",6),P.Qb(8,"app-icon",7),P.Ub(),P.Qb(9,"app-node-actions",8),P.Ub()),2&e&&(P.lc("ngClass",P.sc(11,Ql,t.theme===t.treeTheme.Light,t.theme===t.treeTheme.Themed,!t.node.boolState.shown,t.checked,!t.node.boolState.pickable&&t.isLoft)),P.Eb("data-id",t.sanitizedID),P.Db(1),P.lc("ngIf",t.nested&&t.hasChildren),P.Db(1),P.lc("ngIf",!t.editLabelMode),P.Db(1),P.lc("ngIf",t.editLabelMode),P.Db(1),P.lc("ngIf",P.ic(5,9,t.layerOrderMode$)),P.Db(2),P.lc("gaLabel",t.node.boolState.shown?"Hide":"Show"),P.Db(3),P.lc("theme",t.theme)("node",t.node))},directives:[Ce.a,ra.i,ra.l,Ce.b,tl,nl,Tl,Ll],pipes:[ra.b],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3838}.text-info{color:#0060c4}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}:host{display:block}.tree-node{margin:4px 0;display:flex;align-items:center;height:100%;border-radius:4px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;min-width:200px;transition:background-color .12s}.tree-node--themed{padding-right:12px;border-radius:2px;border-left:var(--tree-node-border)}.tree-node--themed:focus{background:#f1f4fa;outline:none}.tree-node--themed .tree-node__label{color:#131c2a;color:var(--tree-node-color);font-size:13px;letter-spacing:.325px;line-height:1.4em}.tree-node--themed.tree-node--selected{border-left:4px solid #2d72dc;background-color:#f1f5fc;background:var(--tree-node-bg--selected);border-left:var(--tree-node-border--selected)}.tree-node--themed.tree-node--selected .tree-node__actions,.tree-node--themed.tree-node--selected .tree-node__label{color:#131c2a;color:var(--tree-node-color--selected)}.tree-node--themed.tree-node--selected .tree-node__actions,.tree-node--themed.tree-node--selected .tree-node__expand,.tree-node--themed.tree-node--selected .tree-node__visible{background-color:#f1f5fc;color:#131c2a;background-color:var(--tree-node-button-bg--selected);color:var(--tree-node-button-color--selected)}.tree-node--themed.tree-node--unpickable{border:1px dashed #d7e0ea}.tree-node--themed.tree-node--hidden .tree-node__label{color:#96a8c0;color:var(--tree-node-color--hidden)}.tree-node--themed .tree-node__actions,.tree-node--themed .tree-node__expand,.tree-node--themed .tree-node__visible{background-color:transparent;background-color:var(--tree-node-button-bg);color:#96a8c0;color:var(--tree-node-button-color);border-radius:4px}.tree-node--light .tree-node__label{color:#283853;font-weight:400;font-size:14px;line-height:1.33em}.tree-node--light.tree-node--selected .tree-node__actions,.tree-node--light.tree-node--selected .tree-node__expand,.tree-node--light.tree-node--selected .tree-node__label,.tree-node--light.tree-node--selected .tree-node__visible{color:#fff}.tree-node--light.tree-node--unpickable{border:1px dashed #d7e0ea}.tree-node--light.tree-node--hidden .tree-node__label{color:#96a8c0;font-weight:300}.tree-node--light .tree-node__actions,.tree-node--light .tree-node__expand,.tree-node--light .tree-node__visible{color:#6a82a4;border-radius:4px}.tree-node--selected{background-color:#2d72dc}.tree-node--selected .tree-node__label{color:#fff}.tree-node--unpickable{border:1px dashed #6a82a4}.tree-node--hidden .tree-node__actions,.tree-node--hidden .tree-node__expand,.tree-node--hidden .tree-node__label,.tree-node--hidden .tree-node__visible,.tree-node.tree-node--hidden.tree-node--selected .tree-node__actions,.tree-node.tree-node--hidden.tree-node--selected .tree-node__expand,.tree-node.tree-node--hidden.tree-node--selected .tree-node__label,.tree-node.tree-node--hidden.tree-node--selected .tree-node__visible{color:#96a8c0}.tree-node--hidden .tree-node__visible,.tree-node.tree-node--hidden.tree-node--selected .tree-node__visible{visibility:visible}.tree-node__label{font-size:12px;letter-spacing:.3px;line-height:1.4em;letter-spacing:.5px;font-weight:400;line-height:1.3em;color:#d7e0ea;padding:8px 4px 8px 12px;display:flex;align-items:center;flex:1 1 100%;min-height:28px}.tree-node__label--padded{padding-left:32px}.tree-node__expand i{transition:transform .12s}.tree-node__expand--open app-icon{transform:rotate(45deg)}.tree-node .tree-node__expand+.tree-node__label{margin-left:-8px}.tree-node__actions,.tree-node__expand,.tree-node__visible{border-radius:4px;color:#d7e0ea;display:flex;flex:0 0 30px;height:30px;justify-content:center;align-items:center}.tree-node__layer-order{font-size:10px;flex:0 0 56px;min-height:28px;height:28px;padding:4px;margin:2px;text-align:center}.tree-node .tree-node__eye,.tree-node .tree-node__eye-slash{display:none}.tree-node.tree-node--hidden .tree-node__eye-slash,.tree-node:not(.tree-node--hidden) .tree-node__eye{display:inline}@media (hover:hover){.tree-node__actions,.tree-node__visible{visibility:hidden}.tree-node:hover{cursor:pointer}.tree-node:hover .tree-node__actions,.tree-node:hover .tree-node__visible{visibility:visible}.tree-node:hover .tree-node__label{color:#fff}.tree-node--themed:hover{cursor:pointer;background:var(--tree-node-bg--hover)}.tree-node--themed:hover .tree-node__label{color:#131c2a;color:var(--tree-node-color--hover)}.tree-node--themed.tree-node--selected:hover{background-color:#f1f5fc;background-color:var(--tree-node-bg--selected)}.tree-node--themed.tree-node--selected .tree-node__actions:hover,.tree-node--themed.tree-node--selected .tree-node__expand:hover,.tree-node--themed.tree-node--selected .tree-node__visible:hover{background-color:var(--tree-node-button-bg--hover);color:var(--tree-node-button-color--hover)}.tree-node--themed .tree-node__actions:hover,.tree-node--themed .tree-node__expand:hover,.tree-node--themed .tree-node__visible:hover{background-color:transparent;color:inherit;background-color:var(--tree-node-button-bg--hover);color:var(--tree-node-button-color--hover)}.tree-node--light:hover{background:rgba(234,239,245,.5)}.tree-node--light:hover .tree-node__label{color:#131c2a}.tree-node--light.tree-node--selected:hover{background:#2d72dc}.tree-node--light.tree-node--selected .tree-node__actions:hover,.tree-node--light.tree-node--selected .tree-node__expand:hover,.tree-node--light.tree-node--selected .tree-node__visible:hover{color:#f9fafd}.tree-node--light .tree-node__actions:hover,.tree-node--light .tree-node__expand:hover,.tree-node--light .tree-node__visible:hover{background-color:#eaeff5;color:#131c2a}.tree-node__actions:hover,.tree-node__expand:hover,.tree-node__visible:hover{background-color:#1c2a3f;color:#fff;cursor:pointer}.tree-node--selected .tree-node__actions:hover,.tree-node--selected .tree-node__expand:hover,.tree-node--selected .tree-node__visible:hover{background-color:#2d72dc}.tree-node .tree-node__eye,.tree-node .tree-node__eye-slash{display:none}.tree-node.tree-node--hidden .tree-node__eye-slash,.tree-node:hover:not(.tree-node--hidden) .tree-node__eye{display:inline}}"],encapsulation:2,changeDetection:0}),Dl([Object(E.d)(Ai.getCheckedNodeIds),El("design:type",be.a)],Hl.prototype,"checkedNodesIds$",void 0),Dl([Object(E.d)(el.getLayerOrderMode),El("design:type",be.a)],Hl.prototype,"layerOrderMode$",void 0),Dl([Object(E.d)(Wr.getLabelEditNode),El("design:type",be.a)],Hl.prototype,"labelEditNode$",void 0),Dl([Object(E.d)(el.getShowTreeNodeIds),El("design:type",be.a)],Hl.prototype,"showTreeNodeIds$",void 0),Hl);function Wl(e,t){1&e&&(P.Vb(0,"div",4),P.Mc(1," No results "),P.Ub())}function $l(e,t){if(1&e&&(P.Vb(0,"div",5),P.Qb(1,"app-tree",6),P.Ub()),2&e){var n=P.gc();P.Db(1),P.lc("theme",n.theme)("searchGraph",n.searchGraph)}}function Kl(e,t){if(1&e&&(P.Vb(0,"div"),P.Qb(1,"app-tree-nested-node",9),P.Ub()),2&e){var n=t.$implicit,i=P.gc(2);P.Db(1),P.lc("theme",i.theme)("nested",!1)("node",n)("graph",i.prunedViewGraph)}}function Gl(e,t){if(1&e&&(P.Vb(0,"cdk-virtual-scroll-viewport",7),P.Kc(1,Kl,2,4,"div",8),P.Ub()),2&e){var n=P.gc();P.Hc("height",n.searchHeight,"px"),P.lc("itemSize",64),P.Db(1),P.lc("cdkVirtualForOf",n.searchResults)("cdkVirtualForTrackBy",n.trackTreeNode)}}var Zl,Jl,Xl,Yl=function(e){return e[e.List=0]="List",e[e.Tree=1]="Tree",e}({}),eu=((Zl=function(){function e(t,n,i,o,r){m(this,e),this.renderer=t,this.changeDetectorRef=n,this.elementRef=i,this.engineService=o,this.store=r,this._query="",this._displayMode=Yl.List,this.displayModeChange=new P.p,this.theme=mc.Dark,this.treeSearchDisplayMode=Yl,this.searchResults=[],this.searchHeight=0,this.ngUnsubscribe=new fe.a}return v(e,[{key:"query",get:function(){return this._query},set:function(e){this._query=e||"",this.handleQueryChange()}},{key:"displayMode",get:function(){return this._displayMode},set:function(e){null!=e&&(this._displayMode=e,this.handleQueryChange(),this.displayModeChange.emit(this.displayMode))}},{key:"viewGraph",get:function(){return this._viewGraph},set:function(e){this._viewGraph=e,this.leafNodes=this.engineService.getLeaves(),this.buildPrunedViewGraph(this.displayMode),this.handleQueryChange(),this.changeDetectorRef.markForCheck()}},{key:"ngOnInit",value:function(){}},{key:"buildPrunedViewGraph",value:function(e){var t=this.store.selectSnapshot(Lr.getSelectedChapter),n=this.engineService.createViewGraph(t.showObjects,!0);this.prunedViewGraph=n}},{key:"ngAfterViewInit",value:function(){var e=this;this.renderer.listen("window","resize",(function(t){e.resize()}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"handleQueryChange",value:function(){var e=this.search(this._query,this.displayMode===Yl.List?this.prunedViewGraph:this.viewGraph);this.displayMode===Yl.Tree&&(this.searchGraph=function(e,t){return t.reduce((function(t,n){return function e(t,n,i){ke.addNode(t,n);var o=ke.getAncestor(i,n.id);if(o){var r=t.successors[o]||[];return r.push(n.id),t.successors[o]=Object(Se.uniq)(r),t.predecessors[n.id]=o,e(t,ke.getNode(i,o),i)}return ke.addRootNode(t,n),t}(t,n,e)}),{nodes:{},successors:{},predecessors:{},roots:{}})}(this.viewGraph,e)),this.searchResults=e,this.resize()}},{key:"resize",value:function(){var e=this;this.getSearchHeight().pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){e.searchHeight=t,e.changeDetectorRef.markForCheck()}))}},{key:"getSearchHeight",value:function(){var e=this;return new be.a((function(t){setTimeout((function(){var n=e.elementRef.nativeElement.offsetHeight;null!=n&&(t.next(n),t.complete())}))}))}},{key:"search",value:function(e,t){return void 0===t?[]:(e=Object(xc.remove)(e.toLowerCase()),Object.values(t.nodes).filter((function(t){return 0===e.length||Object(xc.remove)(t.label.toLowerCase()).indexOf(e)>=0})).sort((function(e,t){return e.label.localeCompare(t.label)})))}},{key:"trackTreeNode",value:function(e,t){return t.id}}]),e}()).\u0275fac=function(e){return new(e||Zl)(P.Pb(P.H),P.Pb(P.i),P.Pb(P.m),P.Pb(Nt),P.Pb(E.g))},Zl.\u0275cmp=P.Jb({type:Zl,selectors:[["app-tree-search"]],inputs:{query:"query",displayMode:"displayMode",viewGraph:"viewGraph",theme:"theme"},outputs:{displayModeChange:"displayModeChange"},decls:4,vars:3,consts:[[1,"tree-search"],["class","tree-search__empty",4,"ngIf"],["class","pr-3 pv-3",4,"ngIf"],["class","pv-3",3,"itemSize","height",4,"ngIf"],[1,"tree-search__empty"],[1,"pr-3","pv-3"],[1,"tree-search__tree",3,"theme","searchGraph"],[1,"pv-3",3,"itemSize"],[4,"cdkVirtualFor","cdkVirtualForOf","cdkVirtualForTrackBy"],[1,"mr-3",2,"height","64px",3,"theme","nested","node","graph"]],template:function(e,t){1&e&&(P.Vb(0,"div",0),P.Kc(1,Wl,2,0,"div",1),P.Kc(2,$l,2,2,"div",2),P.Kc(3,Gl,2,5,"cdk-virtual-scroll-viewport",3),P.Ub()),2&e&&(P.Db(1),P.lc("ngIf",0===t.searchResults.length),P.Db(1),P.lc("ngIf",t.displayMode===t.treeSearchDisplayMode.Tree),P.Db(1),P.lc("ngIf",t.displayMode===t.treeSearchDisplayMode.List))},directives:[ra.l,yc,kc.e,kc.a,kc.d,ql],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3838}.text-info{color:#0060c4}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.tree-search{display:flex;flex-direction:column;flex:1 1 auto;height:100%}.tree-search__tree{flex-grow:1;width:100%}.tree-search__empty{font-size:14px;letter-spacing:.35px;line-height:1.4em;padding:12px;font-style:italic;margin-top:12px}.tree-search cdk-virtual-scroll-viewport{flex:1 1 auto}.tree-search cdk-virtual-scroll-viewport .cdk-virtual-scroll-content-wrapper{padding-right:12px}"],encapsulation:2,changeDetection:0}),Zl),tu=function(e){return e.Play="play",e.Button="button",e.Hand="hand",e}({}),nu=function(e){return e[e.OnDemand=0]="OnDemand",e[e.Interact=1]="Interact",e[e.Loader=2]="Loader",e[e.Tutorial=3]="Tutorial",e[e.Whiteboard=4]="Whiteboard",e[e.Help=5]="Help",e}({}),iu=function(e){return e[e.Text=0]="Text",e[e.Paint=1]="Paint",e[e.Erase=2]="Erase",e}({}),ou=[4,8,12,16,24,32],ru=function(e){return e.slice(0).reverse().map((function(e){return{label:""+e,size:e}}))},au=ru(ou),su=ru([8,12,16,20,24,32]),cu=ru(ou),lu=[].concat(c(Ji.map((function(e){var t=e.label,n=e.recipe,i=Array.isArray(n.tintColor)?n.tintColor:[1,1,1];return{label:t,color:vr.rgbToHex(i,!0)}}))),[{label:"White",color:"#ffffff"}]),uu=au[4],pu=lu[0],du=su[3],gu=cu[4],hu=function(e){return e.Mouse="mouse",e.Touch="touch",e}({}),fu=function(e){return e[e.Default=0]="Default",e.DrawerOnly="drawer",e}({}),bu=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},vu=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},mu=function e(){m(this,e)},yu={audio:new pc,camera:new pc(sc.Show,!0),chapterList:new pc(sc.Show,!1),column:new pc,description:new pc,drawer:new(function(e){t(o,e);var n=i(o);function o(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return m(this,o),(e=n.call(this)).isExpandedInitially=t,e}return o}(pc)),fullscreen:new pc,help:new pc,labels:new pc,labelInfo:new pc,labelList:new pc(sc.Show,!1),loader:new(function(e){t(o,e);var n=i(o);function o(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:uc;return m(this,o),(e=n.call(this)).template=t,e}return o}(pc)),logo:new(function(e){t(o,e);var n=i(o);function o(){var e,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return m(this,o),(e=n.call(this)).isHyperLink=t,e}return o}(pc)),media:new(function(e){t(o,e);var n=i(o);function o(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:cc.Small;return m(this,o),(e=n.call(this)).template=t,e}return o}(pc)),menu:new pc,nodeInfo:new pc(sc.Hide,!1),pagination:new pc,presenter:new pc(sc.Hide,!1),reset:new pc,search:new pc,quiz:new pc,titleOnly:new pc,toolbar:new pc,tools:new pc,anatomyLabels:new pc,tutorial:new pc(sc.Hide,!1),internetExplorerWarning:new pc,legend:new pc,undo:new pc,whiteboard:new pc,visibilityLayers:new pc,contextActions:new pc,toggleLabels:new pc},xu={canFullscreen:!1,canHover:!1,canTouch:!1,drawerCoversContent:!1,fullscreenActive:!1,help:{tab:ye.Basics},initialUI:yu,inputEnabled:!0,inputMode:hu.Mouse,interactType:tu.Play,onDemand:!1,layout:fu.Default,labelsBreakpoint:480,menuOpen:!1,multiPickModeEnabled:!1,openWindows:[nu.Loader],presentationActive:!1,searchDisplayMode:Yl.Tree,showNodeInfo:!1,tutorial:{pageSize:0,pageIndex:-1},tutorialSeen:!0,ui:yu,usePrintImage:!1,whiteboard:{enabled:!1,hasPaint:!1,hasText:!1,brushSize:uu.size,brushColor:pu.color,textSize:du.size,eraserSize:gu.size,annotateMode:iu.Paint}},ku=((Xl=Jl=function(){function e(t){m(this,e),this.storageService=t}return v(e,[{key:"setUI",value:function(e,t){var n=e.getState().ui;e.patchState({ui:Object.assign(Object.assign({},n),t.ui)})}},{key:"setInitialUI",value:function(e,t){e.patchState({initialUI:t.ui})}},{key:"setInputEnabled",value:function(e,t){e.patchState({inputEnabled:t.enabled})}},{key:"setCanHover",value:function(e,t){e.patchState({canHover:t.canHover})}},{key:"setCanTouch",value:function(e,t){e.patchState({canTouch:t.canTouch})}},{key:"setCanFullscreen",value:function(e,t){e.patchState({canFullscreen:t.canFullscreen})}},{key:"setSearchDisplayMode",value:function(e,t){e.patchState({searchDisplayMode:t.mode})}},{key:"toggleNodeInfo",value:function(e,t){e.patchState({showNodeInfo:t.show})}},{key:"togglePresentation",value:function(e,t){e.patchState({presentationActive:t.active})}},{key:"toggleHelp",value:function(e,t){e.patchState({help:{tab:t.tab}})}},{key:"setLoaderType",value:function(e,t){e.patchState({interactType:t.interactType})}},{key:"setOnDemand",value:function(e,t){e.patchState({onDemand:t.onDemand})}},{key:"setInputMode",value:function(e,t){var n=t.inputMode;e.patchState({inputMode:n})}},{key:"SetLayout",value:function(e,t){e.patchState({layout:t.layout})}},{key:"setTutorial",value:function(e,t){var n=e.getState().tutorial;e.patchState({tutorial:Object.assign(Object.assign({},n),t.tutorial)})}},{key:"startTutorial",value:function(e,t){e.patchState({tutorial:Object.assign(Object.assign({},e.getState().tutorial),{pageIndex:t.intro?-1:0})}),e.dispatch(new j.TutorialSeen(!0))}},{key:"tutorialSeen",value:function(e,t){this.storageService.setLocalItem(Ls.GettingStartedTutorial,t.seen),e.patchState({tutorialSeen:t.seen})}},{key:"tutorialPrevious",value:function(e,t){var n=e.getState().tutorial,i=Math.max(n.pageIndex-1,0);e.dispatch(new j.SetTutorial(Object.assign(Object.assign({},n),{pageIndex:i})))}},{key:"tutorialNext",value:function(e,t){var n=e.getState().tutorial,i=Math.min(n.pageIndex+1,n.pageSize-1);e.dispatch(new j.SetTutorial(Object.assign(Object.assign({},n),{pageIndex:i})))}},{key:"setWhiteboardEnabled",value:function(e,t){var n=t.enabled;e.patchState({whiteboard:Object.assign(Object.assign({},e.getState().whiteboard),{enabled:n})})}},{key:"setWhiteboardBrushSize",value:function(e,t){var n=t.brushSize;e.patchState({whiteboard:Object.assign(Object.assign({},e.getState().whiteboard),{brushSize:n})})}},{key:"setWhiteboardTextSize",value:function(e,t){var n=t.size;e.patchState({whiteboard:Object.assign(Object.assign({},e.getState().whiteboard),{textSize:n})})}},{key:"setWhiteboardEraserSize",value:function(e,t){var n=t.eraserSize;e.patchState({whiteboard:Object.assign(Object.assign({},e.getState().whiteboard),{eraserSize:n})})}},{key:"setWhiteboardAnnotateMode",value:function(e,t){var n=t.mode;e.patchState({whiteboard:Object.assign(Object.assign({},e.getState().whiteboard),{annotateMode:n})})}},{key:"setWhiteboardBrushColor",value:function(e,t){var n=t.brushColor;e.patchState({whiteboard:Object.assign(Object.assign({},e.getState().whiteboard),{brushColor:n})})}},{key:"setWhiteboardHasPaint",value:function(e,t){var n=t.hasPaint;e.patchState({whiteboard:Object.assign(Object.assign({},e.getState().whiteboard),{hasPaint:n})})}},{key:"setWhiteboardHasText",value:function(e,t){var n=t.hasText;e.patchState({whiteboard:Object.assign(Object.assign({},e.getState().whiteboard),{hasText:n})})}},{key:"setMultiPickModeEnabled",value:function(e,t){e.patchState({multiPickModeEnabled:t.enabled})}},{key:"setLabelBreakpoint",value:function(e,t){e.patchState({labelsBreakpoint:t.labelsBreakpoint})}},{key:"setUsePrintImage",value:function(e,t){e.patchState({usePrintImage:t.usePrintImage})}},{key:"setWindows",value:function(e,t){e.patchState({openWindows:t.windows})}},{key:"openWindow",value:function(e,t){var n=e.getState().openWindows;n.indexOf(t.window)<0&&e.patchState({openWindows:[t.window].concat(c(n))})}},{key:"closeWindow",value:function(e,t){var n=e.getState().openWindows;null!=t.window?n=n.filter((function(e){return e!==t.window})):n.shift(),e.patchState({openWindows:c(n)})}},{key:"toggleWindow",value:function(e,t){var n=e.getState().openWindows.indexOf(t.window)>=0;e.dispatch((null!=t.show?t.show:!n)?new j.OpenWindow(t.window):new j.CloseWindow(t.window))}},{key:"toggleMenu",value:function(e,t){e.patchState({menuOpen:t.open})}},{key:"ngxsOnInit",value:function(e){Ys.onFullscreenChange().subscribe((function(t){e.patchState({fullscreenActive:Ys.isFullscreen()})})),e.patchState({tutorialSeen:this.storageService.getLocalJSON(Ls.GettingStartedTutorial)||!1})}}],[{key:"getUI",value:function(e){return e.ui}},{key:"getInitialUI",value:function(e){return e.initialUI}},{key:"getLabelsBreakpoint",value:function(e){return e.labelsBreakpoint}},{key:"getInputEnabled",value:function(e){return e.inputEnabled}},{key:"getFullscreenActive",value:function(e){return e.fullscreenActive}},{key:"getPresentationActive",value:function(e){return e.presentationActive}},{key:"getDrawerCoversContent",value:function(e){return e.drawerCoversContent}},{key:"getShowNodeInfo",value:function(e){return e.showNodeInfo}},{key:"getInteractType",value:function(e){return e.interactType}},{key:"getOnDemand",value:function(e){return e.onDemand}},{key:"getLayout",value:function(e){return e.layout}},{key:"getInputMode",value:function(e){return e.inputMode}},{key:"getShowHelpTab",value:function(e){return e.help.tab}},{key:"getTutorial",value:function(e){return e.tutorial}},{key:"getTutorialSeen",value:function(e){return e.tutorialSeen}},{key:"getWhiteboardEnabled",value:function(e){return e.whiteboard.enabled}},{key:"getWhiteboardBrushSize",value:function(e){return e.whiteboard.brushSize}},{key:"getWhiteboardTextSize",value:function(e){return e.whiteboard.textSize}},{key:"getWhiteboardEraserSize",value:function(e){return e.whiteboard.eraserSize}},{key:"getWhiteboardAnnotateMode",value:function(e){return e.whiteboard.annotateMode}},{key:"getWhiteboardBrushColor",value:function(e){return e.whiteboard.brushColor}},{key:"getWhiteboardHasPaint",value:function(e){return e.whiteboard.hasPaint}},{key:"getWhiteboardHasText",value:function(e){return e.whiteboard.hasText}},{key:"getCanTouch",value:function(e){return e.canTouch}},{key:"getCanHover",value:function(e){return e.canHover}},{key:"getMultiPickModeEnabled",value:function(e){return e.multiPickModeEnabled}},{key:"getSearchDisplayMode",value:function(e){return e.searchDisplayMode}},{key:"getUsePrintImage",value:function(e){return e.usePrintImage}},{key:"getOpenWindow",value:function(e){return e.openWindows.length>0?e.openWindows.sort()[0]:null}},{key:"getMenuOpen",value:function(e){return e.menuOpen}},{key:"shouldWindowOpen",value:function(e){return Object(E.h)([Jl],(function(t){return t.openWindows.indexOf(e)>=0}))}}]),e}()).\u0275fac=function(e){return new(e||Xl)(P.Zb(As))},Xl.\u0275prov=P.Lb({token:Xl,factory:Xl.\u0275fac}),bu([Object(E.a)(j.SetUI),vu("design:type",Function),vu("design:paramtypes",[Object,j.SetUI]),vu("design:returntype",void 0)],Xl.prototype,"setUI",null),bu([Object(E.a)(j.SetInitialUI),vu("design:type",Function),vu("design:paramtypes",[Object,j.SetInitialUI]),vu("design:returntype",void 0)],Xl.prototype,"setInitialUI",null),bu([Object(E.a)(j.SetInputEnabled),vu("design:type",Function),vu("design:paramtypes",[Object,j.SetInputEnabled]),vu("design:returntype",void 0)],Xl.prototype,"setInputEnabled",null),bu([Object(E.a)(j.SetCanHover),vu("design:type",Function),vu("design:paramtypes",[Object,j.SetCanHover]),vu("design:returntype",void 0)],Xl.prototype,"setCanHover",null),bu([Object(E.a)(j.SetCanTouch),vu("design:type",Function),vu("design:paramtypes",[Object,j.SetCanTouch]),vu("design:returntype",void 0)],Xl.prototype,"setCanTouch",null),bu([Object(E.a)(j.SetCanFullscreen),vu("design:type",Function),vu("design:paramtypes",[Object,j.SetCanFullscreen]),vu("design:returntype",void 0)],Xl.prototype,"setCanFullscreen",null),bu([Object(E.a)(j.SetSearchDisplayMode),vu("design:type",Function),vu("design:paramtypes",[Object,j.SetSearchDisplayMode]),vu("design:returntype",void 0)],Xl.prototype,"setSearchDisplayMode",null),bu([Object(E.a)(j.ToggleNodeInfo),vu("design:type",Function),vu("design:paramtypes",[Object,j.ToggleNodeInfo]),vu("design:returntype",void 0)],Xl.prototype,"toggleNodeInfo",null),bu([Object(E.a)(j.TogglePresentation),vu("design:type",Function),vu("design:paramtypes",[Object,j.TogglePresentation]),vu("design:returntype",void 0)],Xl.prototype,"togglePresentation",null),bu([Object(E.a)(j.ToggleHelpTab),vu("design:type",Function),vu("design:paramtypes",[Object,j.ToggleHelpTab]),vu("design:returntype",void 0)],Xl.prototype,"toggleHelp",null),bu([Object(E.a)(j.SetInteractType),vu("design:type",Function),vu("design:paramtypes",[Object,j.SetInteractType]),vu("design:returntype",void 0)],Xl.prototype,"setLoaderType",null),bu([Object(E.a)(j.SetOnDemand),vu("design:type",Function),vu("design:paramtypes",[Object,j.SetOnDemand]),vu("design:returntype",void 0)],Xl.prototype,"setOnDemand",null),bu([Object(E.a)(j.SetInputMode),vu("design:type",Function),vu("design:paramtypes",[Object,j.SetInputMode]),vu("design:returntype",void 0)],Xl.prototype,"setInputMode",null),bu([Object(E.a)(j.SetLayout),vu("design:type",Function),vu("design:paramtypes",[Object,j.SetLayout]),vu("design:returntype",void 0)],Xl.prototype,"SetLayout",null),bu([Object(E.a)(j.SetTutorial),vu("design:type",Function),vu("design:paramtypes",[Object,j.SetTutorial]),vu("design:returntype",void 0)],Xl.prototype,"setTutorial",null),bu([Object(E.a)(j.StartTutorial),vu("design:type",Function),vu("design:paramtypes",[Object,j.StartTutorial]),vu("design:returntype",void 0)],Xl.prototype,"startTutorial",null),bu([Object(E.a)(j.TutorialSeen),vu("design:type",Function),vu("design:paramtypes",[Object,j.TutorialSeen]),vu("design:returntype",void 0)],Xl.prototype,"tutorialSeen",null),bu([Object(E.a)(j.TutorialPrevious),vu("design:type",Function),vu("design:paramtypes",[Object,j.TutorialPrevious]),vu("design:returntype",void 0)],Xl.prototype,"tutorialPrevious",null),bu([Object(E.a)(j.TutorialNext),vu("design:type",Function),vu("design:paramtypes",[Object,j.TutorialNext]),vu("design:returntype",void 0)],Xl.prototype,"tutorialNext",null),bu([Object(E.a)(j.SetWhiteboardEnabled),vu("design:type",Function),vu("design:paramtypes",[Object,j.SetWhiteboardEnabled]),vu("design:returntype",void 0)],Xl.prototype,"setWhiteboardEnabled",null),bu([Object(E.a)(j.SetWhiteboardBrushSize),vu("design:type",Function),vu("design:paramtypes",[Object,j.SetWhiteboardBrushSize]),vu("design:returntype",void 0)],Xl.prototype,"setWhiteboardBrushSize",null),bu([Object(E.a)(j.SetWhiteboardTextSize),vu("design:type",Function),vu("design:paramtypes",[Object,j.SetWhiteboardTextSize]),vu("design:returntype",void 0)],Xl.prototype,"setWhiteboardTextSize",null),bu([Object(E.a)(j.SetWhiteboardEraserSize),vu("design:type",Function),vu("design:paramtypes",[Object,j.SetWhiteboardEraserSize]),vu("design:returntype",void 0)],Xl.prototype,"setWhiteboardEraserSize",null),bu([Object(E.a)(j.SetWhiteboardAnnotateMode),vu("design:type",Function),vu("design:paramtypes",[Object,j.SetWhiteboardAnnotateMode]),vu("design:returntype",void 0)],Xl.prototype,"setWhiteboardAnnotateMode",null),bu([Object(E.a)(j.SetWhiteboardBrushColor),vu("design:type",Function),vu("design:paramtypes",[Object,j.SetWhiteboardBrushColor]),vu("design:returntype",void 0)],Xl.prototype,"setWhiteboardBrushColor",null),bu([Object(E.a)(j.SetWhiteboardHasPaint),vu("design:type",Function),vu("design:paramtypes",[Object,j.SetWhiteboardHasPaint]),vu("design:returntype",void 0)],Xl.prototype,"setWhiteboardHasPaint",null),bu([Object(E.a)(j.SetWhiteboardHasText),vu("design:type",Function),vu("design:paramtypes",[Object,j.SetWhiteboardHasText]),vu("design:returntype",void 0)],Xl.prototype,"setWhiteboardHasText",null),bu([Object(E.a)(j.SetMultiPickModeEnabled),vu("design:type",Function),vu("design:paramtypes",[Object,j.SetMultiPickModeEnabled]),vu("design:returntype",void 0)],Xl.prototype,"setMultiPickModeEnabled",null),bu([Object(E.a)(j.SetLabelBreakpoint),vu("design:type",Function),vu("design:paramtypes",[Object,j.SetLabelBreakpoint]),vu("design:returntype",void 0)],Xl.prototype,"setLabelBreakpoint",null),bu([Object(E.a)(j.SetUsePrintImage),vu("design:type",Function),vu("design:paramtypes",[Object,j.SetUsePrintImage]),vu("design:returntype",void 0)],Xl.prototype,"setUsePrintImage",null),bu([Object(E.a)(j.SetWindows),vu("design:type",Function),vu("design:paramtypes",[Object,j.SetWindows]),vu("design:returntype",void 0)],Xl.prototype,"setWindows",null),bu([Object(E.a)(j.OpenWindow),vu("design:type",Function),vu("design:paramtypes",[Object,j.OpenWindow]),vu("design:returntype",void 0)],Xl.prototype,"openWindow",null),bu([Object(E.a)(j.CloseWindow),vu("design:type",Function),vu("design:paramtypes",[Object,j.CloseWindow]),vu("design:returntype",void 0)],Xl.prototype,"closeWindow",null),bu([Object(E.a)(j.ToggleWindow),vu("design:type",Function),vu("design:paramtypes",[Object,j.ToggleWindow]),vu("design:returntype",void 0)],Xl.prototype,"toggleWindow",null),bu([Object(E.a)(j.ToggleMenu),vu("design:type",Function),vu("design:paramtypes",[Object,j.ToggleMenu]),vu("design:returntype",void 0)],Xl.prototype,"toggleMenu",null),bu([Object(E.e)(),vu("design:type",Function),vu("design:paramtypes",[mu]),vu("design:returntype",void 0)],Xl,"getUI",null),bu([Object(E.e)(),vu("design:type",Function),vu("design:paramtypes",[mu]),vu("design:returntype",void 0)],Xl,"getInitialUI",null),bu([Object(E.e)(),vu("design:type",Function),vu("design:paramtypes",[mu]),vu("design:returntype",void 0)],Xl,"getLabelsBreakpoint",null),bu([Object(E.e)(),vu("design:type",Function),vu("design:paramtypes",[mu]),vu("design:returntype",void 0)],Xl,"getInputEnabled",null),bu([Object(E.e)(),vu("design:type",Function),vu("design:paramtypes",[mu]),vu("design:returntype",void 0)],Xl,"getFullscreenActive",null),bu([Object(E.e)(),vu("design:type",Function),vu("design:paramtypes",[mu]),vu("design:returntype",void 0)],Xl,"getPresentationActive",null),bu([Object(E.e)(),vu("design:type",Function),vu("design:paramtypes",[mu]),vu("design:returntype",void 0)],Xl,"getDrawerCoversContent",null),bu([Object(E.e)(),vu("design:type",Function),vu("design:paramtypes",[mu]),vu("design:returntype",void 0)],Xl,"getShowNodeInfo",null),bu([Object(E.e)(),vu("design:type",Function),vu("design:paramtypes",[mu]),vu("design:returntype",void 0)],Xl,"getInteractType",null),bu([Object(E.e)(),vu("design:type",Function),vu("design:paramtypes",[mu]),vu("design:returntype",void 0)],Xl,"getOnDemand",null),bu([Object(E.e)(),vu("design:type",Function),vu("design:paramtypes",[mu]),vu("design:returntype",void 0)],Xl,"getLayout",null),bu([Object(E.e)(),vu("design:type",Function),vu("design:paramtypes",[mu]),vu("design:returntype",void 0)],Xl,"getInputMode",null),bu([Object(E.e)(),vu("design:type",Function),vu("design:paramtypes",[mu]),vu("design:returntype",void 0)],Xl,"getShowHelpTab",null),bu([Object(E.e)(),vu("design:type",Function),vu("design:paramtypes",[mu]),vu("design:returntype",void 0)],Xl,"getTutorial",null),bu([Object(E.e)(),vu("design:type",Function),vu("design:paramtypes",[mu]),vu("design:returntype",void 0)],Xl,"getTutorialSeen",null),bu([Object(E.e)(),vu("design:type",Function),vu("design:paramtypes",[mu]),vu("design:returntype",void 0)],Xl,"getWhiteboardEnabled",null),bu([Object(E.e)(),vu("design:type",Function),vu("design:paramtypes",[mu]),vu("design:returntype",void 0)],Xl,"getWhiteboardBrushSize",null),bu([Object(E.e)(),vu("design:type",Function),vu("design:paramtypes",[mu]),vu("design:returntype",void 0)],Xl,"getWhiteboardTextSize",null),bu([Object(E.e)(),vu("design:type",Function),vu("design:paramtypes",[mu]),vu("design:returntype",void 0)],Xl,"getWhiteboardEraserSize",null),bu([Object(E.e)(),vu("design:type",Function),vu("design:paramtypes",[mu]),vu("design:returntype",void 0)],Xl,"getWhiteboardAnnotateMode",null),bu([Object(E.e)(),vu("design:type",Function),vu("design:paramtypes",[mu]),vu("design:returntype",void 0)],Xl,"getWhiteboardBrushColor",null),bu([Object(E.e)(),vu("design:type",Function),vu("design:paramtypes",[mu]),vu("design:returntype",void 0)],Xl,"getWhiteboardHasPaint",null),bu([Object(E.e)(),vu("design:type",Function),vu("design:paramtypes",[mu]),vu("design:returntype",void 0)],Xl,"getWhiteboardHasText",null),bu([Object(E.e)(),vu("design:type",Function),vu("design:paramtypes",[mu]),vu("design:returntype",void 0)],Xl,"getCanTouch",null),bu([Object(E.e)(),vu("design:type",Function),vu("design:paramtypes",[mu]),vu("design:returntype",void 0)],Xl,"getCanHover",null),bu([Object(E.e)(),vu("design:type",Function),vu("design:paramtypes",[mu]),vu("design:returntype",void 0)],Xl,"getMultiPickModeEnabled",null),bu([Object(E.e)(),vu("design:type",Function),vu("design:paramtypes",[mu]),vu("design:returntype",void 0)],Xl,"getSearchDisplayMode",null),bu([Object(E.e)(),vu("design:type",Function),vu("design:paramtypes",[mu]),vu("design:returntype",void 0)],Xl,"getUsePrintImage",null),bu([Object(E.e)(),vu("design:type",Function),vu("design:paramtypes",[mu]),vu("design:returntype",void 0)],Xl,"getOpenWindow",null),bu([Object(E.e)(),vu("design:type",Function),vu("design:paramtypes",[mu]),vu("design:returntype",void 0)],Xl,"getMenuOpen",null),Xl=Jl=bu([Object(E.f)({name:"view",defaults:xu})],Xl)),wu=h("R0Ic"),Ou=h("IzEk"),Cu=function(e){return e[e.Content=0]="Content",e[e.Label=1]="Label",e[e.Tools=2]="Tools",e[e.Search=3]="Search",e[e.Help=4]="Help",e[e.NodeInfo=5]="NodeInfo",e[e.LabelInfo=6]="LabelInfo",e}({}),Su=["ui-bd.class","ui-play-pause","ui-camera-mode","ui-center","ui-cross-section","ui-dissect","ui-fs","ui-tools-display","ui-tree","ui-zoom","ui-zoom-in","ui-zoom-out","ui-pan","ui-share","ui-keys","ui-slider","o","background.color-stops","background.gradient-type","dd","dn","image-display","imageDisplay","imageSrc","pre","referrer"];function _u(e){var t=e.id,n=e.s,i=e.m,o=e.be,r=e.b,a="";if(t)a=t;else if(o)a=o;else if(r){var s=parseInt(r,10);a=Number.isNaN(s)?"":function(e){for(var t,n,i=[],o=e;o>0;){var r;n=o,o=(r=p([Math.floor(n/62),n%62],2))[0],t=r[1],i.unshift("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz"[t])}return i.join("")}(s)}else i&&(a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"male";return e.includes("/")?e:"production/".concat(t,"Adult/").concat(e)}(i,"female"===n?"female":"male"));return a.replace(/\.json$/,"")}function ju(e){return _u(e).includes("/")?"module":"bookmark"}var Pu={type:function(e){return ju(e)},id:function(e){return _u(e)},background:function(e){return e.bgstd||e["background.colors"]||e.background}};function Mu(e){return 3===e.length?{x:e[0],y:e[1],z:e[2]}:null}var Iu={camera:function(e){var t=e.split(",").map((function(e){return parseFloat(e)}));if(t.length%3==0&&!t.some((function(e){return Number.isNaN(e)}))){var n=t.slice(0,3),i=t.slice(3,6),o=t.slice(6,9);return{eye:Mu(n),look:Mu(i),up:Mu(o)}}return null},background:function(e){var t=vr.getColors(e);if(t){var n=[].concat(c(t[0][255]),c(t[1][255]));return new ai(n,"radial",[0,100])}return null}};function zu(e){var t,n=function(e){var t=Object.keys(e),n=t.filter((function(e){return Su.includes(e)}));if(n.length>0){var i=['The following URL parameters have been deprecated: "'.concat(n.join('", "'),'"'),"Please contact support@biodigital.com for more information."];console.warn(i.join("\n"))}return t.reduce((function(e,t){return Su.includes(t)&&delete e[t],e}),e)}(e);return function(e){var t=function(e){if(e){var t=e.toLowerCase();if("true"===t)return!0;if("false"===t)return!1;if(!isNaN(Number(t)))return Number(t)}return e};return Object.keys(e).reduce((function(n,i){var o=(Iu[i]||t)(e[i]);return"load-rotate"===i&&isNaN(Number(o))||(n[i]=o),n}),{})}((t=n,Object.keys(Pu).filter((function(e){return void 0===t[e]})).reduce((function(e,n){var i=(0,Pu[n])(t);return void 0!==i&&(e[n]=i),e}),t)))}var Tu,Uu,Lu=((Tu=function(){function e(t){m(this,e),this.store=t}return v(e,[{key:"chapterHasTransition",value:function(e,t){var n=t?"transitions.pre":"transitions.post",i=Object(Se.get)(e,n);return!!i&&(t?i.onPrevious:i.onNext)}},{key:"searchChapterTransitions",value:function(e,t,n){var i=this,o=c(n),r=o.findIndex((function(t){return t.id===e})),a=o.findIndex((function(e){return e.id===t})),s=a<r;if(s&&(r=(o=o.reverse()).findIndex((function(t){return t.id===e})),a=o.findIndex((function(e){return e.id===t}))),r<0||a<0||r===a)return null;var l=o.slice(r,a).find((function(e){return i.chapterHasTransition(e,s)}));return l?s?l.transitions.pre:l.transitions.post:null}}]),e}()).\u0275fac=function(e){return new(e||Tu)(P.Zb(E.g))},Tu.\u0275prov=P.Lb({token:Tu,factory:Tu.\u0275fac,providedIn:"root"}),Tu),Du=function(e){return e.JumpTo="jumpTo",e.FlyTo="flyTo",e}({});!function(e){var t=function e(t){m(this,e),this.breakpoint=t};t.type="[View] Set Breakpoint",e.SetBreakpoint=t}(Uu||(Uu={}));var Eu,Fu,Au,Ru,Vu,Nu=function(e){return e[e.XSmall=0]="XSmall",e[e.Small=1]="Small",e[e.Medium=2]="Medium",e[e.Large=3]="Large",e[e.XLarge=4]="XLarge",e}({}),Bu=h("0MNC"),Hu=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},Qu=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},qu=function e(){m(this,e)},Wu=((Eu=function(){function e(t,n){m(this,e),this.breakpointObserver=t,this.store=n}return v(e,[{key:"setBreakpoint",value:function(e,t){e.patchState({breakpoint:t.breakpoint})}},{key:"ngxsOnInit",value:function(e){var t=this.breakpointObserver.observe(["(max-width: 374px)"]),n=this.breakpointObserver.observe(["(max-width: 599px)"]),i=this.breakpointObserver.observe(["(max-width: 959px)"]),o=this.breakpointObserver.observe(["(max-width: 1439px)"]),r=this.breakpointObserver.observe(["(min-width: 1440px)"]);Object(Gr.b)(t,n,i,o,r).pipe(Object(Z.a)((function(e){var t=p(e,5),n=t[0],i=t[1],o=t[2],r=t[3],a=t[4];return n.matches?Nu.XSmall:i.matches?Nu.Small:o.matches?Nu.Medium:r.matches?Nu.Large:a.matches?Nu.XLarge:null})),Object(Xr.a)(),Object(me.a)((function(e){return null!=e}))).subscribe((function(t){e.dispatch(new Uu.SetBreakpoint(t))}))}}],[{key:"getBreakpoint",value:function(e){return e.breakpoint}},{key:"getBreakpointLabel",value:function(e){return["(max-width: 374px)","(max-width: 599px)","(max-width: 959px)","(max-width: 1439px)","(min-width: 1440px)"][e.breakpoint]}}]),e}()).\u0275fac=function(e){return new(e||Eu)(P.Zb(Bu.a),P.Zb(E.g))},Eu.\u0275prov=P.Lb({token:Eu,factory:Eu.\u0275fac}),Hu([Object(E.a)(Uu.SetBreakpoint),Qu("design:type",Function),Qu("design:paramtypes",[Object,Uu.SetBreakpoint]),Qu("design:returntype",void 0)],Eu.prototype,"setBreakpoint",null),Hu([Object(E.e)(),Qu("design:type",Function),Qu("design:paramtypes",[qu]),Qu("design:returntype",void 0)],Eu,"getBreakpoint",null),Hu([Object(E.e)(),Qu("design:type",Function),Qu("design:paramtypes",[qu]),Qu("design:returntype",void 0)],Eu,"getBreakpointLabel",null),Eu=Hu([Object(E.f)({name:"breakpoint",defaults:{breakpoint:null}})],Eu)),$u=function(e){return e.AnatomyLabels="anatomyLabels",e.Audio="audio",e.Camera="camera",e.Column="column",e.ColumnToggle="column-toggle",e.ContextActions="contextActions",e.Description="description",e.Drawer="drawer",e.Fullscreen="fullscreen",e.Help="help",e.InternetExplorerWarning="internetExplorerWarning",e.LabelList="labelList",e.Labels="labels",e.Layout="layout",e.Legend="legend",e.Loader="loader",e.Logo="logo",e.Media="media",e.Mediabar="mediabar",e.Menu="menu",e.NodeInfo="nodeInfo",e.Pagination="pagination",e.Presenter="presenter",e.Reset="reset",e.Search="search",e.ScrubberButton="scrubberButton",e.ScrubberItem="scrubberItem",e.TitleOnly="title-only",e.ToggleLabels="toggleLabels",e.Toolbar="toolbar",e.Tools="tools",e.Tutorial="tutorial",e.Undo="undo",e.VisibilityLayers="visibilityLayers",e.Whiteboard="whiteboard",e}({}),Ku=function(e){return e.Drawer="drawer",e.Column="column",e}({}),Gu=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},Zu=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Ju={storyLoadProgress:0,chunkLoadProgress:0},Xu=((Ru=function(){function e(){m(this,e)}return v(e,[{key:"setProgress",value:function(e,t){e.patchState({storyLoadProgress:t.storyLoadProgress,chunkLoadProgress:t.chunkLoadProgress})}},{key:"resetProgress",value:function(e,t){e.setState(Object.assign({},Ju))}}],[{key:"getStoryLoadProgress",value:function(e){return e.storyLoadProgress}},{key:"getChunkLoadProgress",value:function(e){return e.chunkLoadProgress}}]),e}()).\u0275fac=function(e){return new(e||Ru)},Ru.\u0275prov=P.Lb({token:Ru,factory:Ru.\u0275fac}),Gu([Object(E.a)(Qs),Zu("design:type",Function),Zu("design:paramtypes",[Object,Qs]),Zu("design:returntype",void 0)],Ru.prototype,"setProgress",null),Gu([Object(E.a)(qs),Zu("design:type",Function),Zu("design:paramtypes",[Object,qs]),Zu("design:returntype",void 0)],Ru.prototype,"resetProgress",null),Gu([Object(E.e)(),Zu("design:type",Function),Zu("design:paramtypes",[Object]),Zu("design:returntype",void 0)],Ru,"getStoryLoadProgress",null),Gu([Object(E.e)(),Zu("design:type",Function),Zu("design:paramtypes",[Object]),Zu("design:returntype",void 0)],Ru,"getChunkLoadProgress",null),Ru=Gu([Object(E.f)({name:"engineProgress",defaults:Ju})],Ru)),Yu=((Au=function(){function e(t,n){m(this,e),this.store=t,this.chapterService=n,this.ui=null,this.breakpoint=null}return v(e,[{key:"getBase",value:function(){return{ui:this.store.selectSnapshot(ku.getUI),layout:this.store.selectSnapshot(ku.getLayout),breakpoint:this.store.selectSnapshot(Wu.getBreakpoint),hideUI:this.isUIHidden()}}},{key:"isUIHidden",value:function(){var e=this.store.selectSnapshot(ku.getOpenWindow),t=this.store.selectSnapshot(Lr.getSelectedChapterIndex),n=this.store.selectSnapshot(ku.getUI),i=e===nu.Loader&&t<=0&&n.loader.template===lc.Circle,o=this.store.selectSnapshot(Xu.getStoryLoadProgress);return i||0===o||e===nu.OnDemand||e===nu.Interact||e===nu.Tutorial||e===nu.Whiteboard}},{key:"isDrawerVisible",value:function(){var e=this.getBase(),t=e.hideUI,n=e.ui,i=e.layout;return!t&&(i===fu.DrawerOnly||this.getLayoutFromWindowSize()===Ku.Drawer)&&(n.drawer.enable&&"none"!==this.getVisibleContent()||n.nodeInfo.status===sc.Show||n.labelInfo.status===sc.Show)}},{key:"isColumnVisible",value:function(){var e=this.getBase(),t=e.hideUI,n=e.layout,i=e.ui;return!t&&n!==fu.DrawerOnly&&i.column.status!==sc.Collapse&&this.getLayoutFromWindowSize()===Ku.Column&&i.column.enable&&"full"===this.getVisibleContent()}},{key:"isColumnToggleVisible",value:function(){var e=this.getBase(),t=e.hideUI,n=e.layout,i=e.ui;if(t)return!1;if(this.store.selectSnapshot(_o.getQuizModeActive))return!1;switch(n){case fu.Default:if(this.getLayoutFromWindowSize()!==Ku.Column)return!1;break;case fu.DrawerOnly:return!1}return i.column.enable&&"full"===this.getVisibleContent()}},{key:"isTitleOnlyVisible",value:function(){var e=this.getBase(),t=e.hideUI,n=e.ui,i=e.breakpoint;return!t&&!(i<Nu.Large)&&n.titleOnly.enable&&"titleOnly"===this.getVisibleContent()}},{key:"isToolsVisible",value:function(){return!this.getBase().hideUI&&this.isUIVisible($u.Tools)}},{key:"isToolbarVisible",value:function(){var e=this.getBase(),t=e.hideUI,n=e.ui;return!t&&n.toolbar.enable}},{key:"isLogoVisible",value:function(){var e=this.getBase().ui;return this.store.selectSnapshot(ku.getOpenWindow)!==nu.OnDemand&&e.logo.enable}},{key:"isCameraVisible",value:function(){var e=this.getBase(),t=e.hideUI,n=e.ui;return!t&&n.camera.enable}},{key:"isPaginationVisible",value:function(){var e=this.getBase(),t=e.hideUI,n=e.ui;return!t&&!(this.store.selectSnapshot(Lr.getChapterCount)<=1)&&n.pagination.enable}},{key:"isMediaVisible",value:function(){var e=this.getBase(),t=e.hideUI,n=e.ui;return!t&&this.store.selectSnapshot(Lr.getIsChapterAnimated)&&n.media.enable}},{key:"isMediabarVisible",value:function(){if(this.getBase().hideUI)return!1;var e=this.isMediaVisible(),t=this.isAudioVisible();return e||t}},{key:"isScrubberVisible",value:function(e){var t=this.getBase(),n=t.hideUI,i=t.ui,o=t.breakpoint;if(n)return!1;var r=this.isMediaVisible&&i.media.template===cc.Full;switch(e){case $u.ScrubberButton:return r&&o>Nu.Small;case $u.ScrubberItem:return r&&o<=Nu.Small}}},{key:"isMenuVisible",value:function(){var e=this.getBase(),t=e.hideUI,n=e.ui;return!t&&(n.fullscreen.enable||n.help.enable||n.search.enable||n.tools.enable||n.whiteboard.enable||n.tutorial.enable)&&n.menu.enable}},{key:"isNodeInfoColumnVisible",value:function(){var e=this.getBase(),t=e.hideUI,n=e.ui,i=e.breakpoint;return!t&&(!!(i>=Nu.Large&&this.isUIVisible($u.NodeInfo))||(i<Nu.Large?!n.drawer.enable&&this.isUIVisible($u.NodeInfo):void 0))}},{key:"isNodeInfoVisible",value:function(e){var t=this.getBase(),n=t.hideUI,i=t.breakpoint;return!n&&(i>=Nu.Large&&e===Ku.Column||i<Nu.Large&&e===Ku.Drawer)&&this.isUIVisible($u.NodeInfo)}},{key:"isAudioVisible",value:function(){var e=this.getBase().ui,t=null!=this.store.selectSnapshot(Lr.getSelectedChapterAudio);return e.audio.enable&&t}},{key:"isSearchColumnVisible",value:function(){return!this.getBase().hideUI&&this.isUIVisible($u.Search)}},{key:"isUndoVisible",value:function(){var e=this.getBase(),t=e.hideUI,n=e.ui;return!t&&n.undo.enable}},{key:"isVisibilityLayersVisible",value:function(){var e=this.getBase(),t=e.hideUI,n=e.ui;if(t)return!1;var i=n.visibilityLayers.enable,o=this.store.selectSnapshot(Lr.getSelectedChapterCurrentLayers);return i&&this.chapterService.hasVisibilityLayers(o)}},{key:"isVisible",value:function(e){switch(e){case $u.Audio:return this.isAudioVisible();case $u.Camera:return this.isCameraVisible();case $u.Column:return this.isColumnVisible();case $u.ColumnToggle:return this.isColumnToggleVisible();case $u.Drawer:return this.isDrawerVisible();case $u.Logo:return this.isLogoVisible();case $u.Media:return this.isMediaVisible();case $u.Mediabar:return this.isMediabarVisible();case $u.Menu:return this.isMenuVisible();case $u.Pagination:return this.isPaginationVisible();case $u.Search:return this.isSearchColumnVisible();case $u.ScrubberButton:return this.isScrubberVisible($u.ScrubberButton);case $u.ScrubberItem:return this.isScrubberVisible($u.ScrubberItem);case $u.TitleOnly:return this.isTitleOnlyVisible();case $u.Tools:return this.isToolsVisible();case $u.Toolbar:return this.isToolbarVisible();case $u.Undo:return this.isUndoVisible();case $u.VisibilityLayers:return this.isVisibilityLayersVisible();default:return this.isUIVisible(e)}}},{key:"isUIVisible",value:function(e){var t=this.getBase(),n=t.hideUI,i=t.ui;return i[e]?!n&&i[e].enable&&i[e].status!==sc.Hide:(console.warn("Attempting to check visibility of a non-existent element: ${element}"),!1)}},{key:"isUIEnabled",value:function(e){return this.getBase().ui[e].enable}},{key:"getVisibleContent",value:function(){var e=this.getBase().ui,t=this.store.selectSnapshot(Is.getChapterLabels),n=this.store.selectSnapshot(Lr.getSelectedChapter),i=Object(Se.get)(n,"info.description"),o=Object(Se.get)(n,"info.displayName"),r=Object(Se.get)(n,"legend",[]),a=Object(Se.get)(n,"contentBlocks",[]).length,s=e.labelList.enable&&t.length>0,c=null!=i&&Object(Se.trim)(i).length>0,l=null!=o&&Object(Se.trim)(o).length>0,u=e.legend.enable&&r.length>0,p=this.store.selectSnapshot(_o.getQuizModeActive);return s||c||u||p||a?"full":l?"titleOnly":"none"}},{key:"getLayoutFromWindowSize",value:function(){var e=document.body.getBoundingClientRect(),t=e.width,n=e.height,i=t/n>=1?"landscape":"portrait",o=this.getBase().breakpoint;return"portrait"===i?Ku.Drawer:o>=Nu.Large||n<=384+(U.application===M.Viewer?0:56)&&t>=708?Ku.Column:Ku.Drawer}}]),e}()).\u0275fac=function(e){return new(e||Au)(P.Zb(E.g),P.Zb(Eo))},Au.\u0275prov=P.Lb({token:Au,factory:Au.\u0275fac,providedIn:"root"}),Au),ep=function(){var e=function e(t){m(this,e),this.query=t};return e.type="[Bookmarks] Load",e}(),tp=function(){var e=function e(t){m(this,e),this.organizationId=t};return e.type="[Bookmarks] Load Organization Bookmarks",e}(),np=function(){var e=function e(t,n){m(this,e),this.organizationId=t,this.collectionId=n};return e.type="[Bookmarks] Load Collection Bookmarks",e}(),ip=function(){var e=function e(t,n){m(this,e),this.id=t,this.type=n};return e.type="[Bookmarks] Select Bookmark",e}(),op=function(){var e=function e(t){m(this,e),this.bookmark=t};return e.type="[Bookmarks] Select Bookmark Success",e}(),rp=function(){var e=function e(t){m(this,e),this.result=t};return e.type="[Bookmarks] Load Success",e}(),ap=function(){var e=function e(t){m(this,e),this.bookmarkId=t};return e.type="[Bookmarks] Delete Bookmark",e}(),sp=function(){var e=function e(t){m(this,e),this.bookmarkId=t};return e.type="[Bookmarks] Bookmark Delete Success",e}(),cp=function(){var e=function e(t,n){m(this,e),this.bookmarkId=t,this.message=n};return e.type="[Bookmarks] Bookmark Delete Fail",e}(),lp=function(){var e=function e(t,n){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];m(this,e),this.bookmarkEntry=t,this.inplace=n,this.includeIndex=i};return e.type="[Bookmarks] Save Bookmark",e}(),up=function(){var e=function e(t,n,i){m(this,e),this.bookmark=t,this.story=n,this.method=i};return e.type="[Bookmarks] Bookmark Saved",e}(),pp=function(){var e=function e(t){m(this,e),this.bookmarkEntry=t};return e.type="[Bookmarks] Bookmark Save Failed",e}(),dp=function(){var e=function e(){m(this,e)};return e.type="[Bookmarks] Cancel Save Bookmark",e}(),gp=function(){var e=function e(t){m(this,e),this.bookmark=t};return e.type="[Bookmarks] Delete Favorite",e}(),hp=function(){var e=function e(t){m(this,e),this.bookmarkId=t};return e.type="[Bookmarks] Delete Favorite Success",e}(),fp=function(){var e=function e(t){m(this,e),this.bookmarkId=t};return e.type="[Bookmarks] Delete Favorite Failed",e}(),bp=function(){var e=function e(t,n,i,o,r){m(this,e),this.method=t,this.bookmarkId=n,this.bookmarkEntry=i,this.thumbnails=o,this.chapterIdMap=r};return e.type="[Bookmarks] Save Bookmark Thumbnails",e}(),vp=function(){var e=function e(){m(this,e)};return e.type="[Bookmarks] Reset",e}(),mp=function(){var e=function e(){m(this,e)};return e.type="[Bookmarks] Clear Bookmarks",e}(),yp=function(){var e=function e(t){m(this,e),this.sort=t};return e.type="[Bookmarks] Sort",e}(),xp=function(){var e=function e(t,n){m(this,e),this.id=t,this.checked=n};return e.type="[Bookmarks] Check Bookmark",e}(),kp=function(){var e=function e(t){m(this,e),this.ids=t};return e.type="[Bookmarks] Set Checked Bookmarks",e}(),wp=function(){var e=function e(t,n,i,o,r,a){m(this,e),this.bookmarks=t,this.widgetURL=n,this.userLanguage=i,this.userApp=o,this.widgetOptions=r,this.offlineEnabled=a};return e.type="[Bookmarks] Export Bookmarks",e}(),Op=function(){var e=function e(t){m(this,e),this.bookmarks=t};return e.type="[Bookmarks] Export Bookmarks Success",e}(),Cp=function(){var e=function e(t){m(this,e),this.bookmarks=t};return e.type="[Bookmarks] Export Bookmarks Error",e}(),Sp=function(){var e=function e(t,n,i){m(this,e),this.bookmark=t,this.addCollection=n,this.removeCollection=i};return e.type="[Bookmarks] Update Bookmark Collection",e}(),_p=function(){var e=function e(t,n,i){m(this,e),this.bookmark=t,this.addCollection=n,this.removeCollection=i};return e.type="[Bookmarks] Update Bookmark Collection Success",e}(),jp=function(){var e=function e(t,n,i){m(this,e),this.bookmark=t,this.addCollection=n,this.removeCollection=i};return e.type="[Bookmarks] Update Bookmark Collection Error",e}(),Pp=function(){var e=function e(t,n){m(this,e),this.bookmark=t,this.collection=n};return e.type="[Bookmarks] Add Bookmark Collection Success",e}(),Mp=function(){var e=function e(t,n){m(this,e),this.bookmark=t,this.collection=n};return e.type="[Bookmarks] Add Bookmark Collection Error",e}(),Ip=function(){var e=function e(t,n){m(this,e),this.bookmark=t,this.collection=n};return e.type="[Bookmarks] Remove Bookmark Collection Success",e}(),zp=function(){var e=function e(t,n){m(this,e),this.bookmark=t,this.collection=n};return e.type="[Bookmarks] Remove Bookmark Collection Error",e}(),Tp=((Fu=function e(t,n,i){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:ya.lang,r=arguments.length>4?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0;m(this,e),this.id=t,this.title=n,this.type=i,this.lang=o,this.groupAccess=r,this.collection=a}).type="[Bookmarks] Copy Bookmark",Fu),Up=function(){var e=function e(t,n,i){m(this,e),this.newId=t,this.sourceId=n,this.newBookmark=i};return e.type="[Bookmarks] Copy Bookmark Success",e}(),Lp=function(){var e=function e(t,n){m(this,e),this.id=t,this.error=n};return e.type="[Bookmarks] Copy Bookmark Failure",e}(),Dp=function(){var e=function e(){m(this,e)};return e.type="[Bookmarks] Cancel Copy Bookmark",e}(),Ep=function(){var e=function e(t){m(this,e),this.title=t};return e.type="[Bookmarks] Set Bookmark Text",e}(),Fp=function(){var e=function e(t){m(this,e),this.category=t};return e.type="[Bookmarks] Set Selected Category",e}();!function(e){var t=function e(t){m(this,e),this.theme=t};t.type="[Layout] Set Theme",e.SetTheme=t;var n=function e(t){m(this,e),this.sidenav=t};n.type="[Layout] Set Sidenav",e.SetSidenav=n;var i=function e(t){m(this,e),this.open=t};i.type="[Layout] Toggle Sidenav",e.ToggleSidenav=i;var o=function e(t){m(this,e),this.siteHeaderType=t};o.type="[Layout] Set Header",e.SetHeader=o;var r=function e(){m(this,e)};r.type="[Layout] Reset",e.ResetLayout=r}(Vu||(Vu={}));var Ap,Rp,Vp=function e(){m(this,e)},Np=function(e){return e.Light="theme-light",e.Dark="theme-dark",e}({}),Bp=function(e){return e[e.Application=0]="Application",e[e.Search=1]="Search",e[e.View=2]="View",e[e.Hide=3]="Hide",e}({}),Hp=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},Qp=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},qp={theme:Np.Light,sidenav:{enabled:!0,open:!1},siteHeader:Bp.Application},Wp=((Ap=function(){function e(){m(this,e)}return v(e,[{key:"setTheme",value:function(e,t){(0,e.patchState)({theme:t.theme})}},{key:"setHeader",value:function(e,t){e.patchState({siteHeader:t.siteHeaderType})}},{key:"setSidenav",value:function(e,t){e.patchState({sidenav:Object.assign({},t.sidenav)})}},{key:"toggleSidenav",value:function(e,t){var n=e.getState().sidenav;e.patchState({sidenav:Object.assign(Object.assign({},n),{open:t.open})})}},{key:"resetLayout",value:function(e,t){e.setState(qp)}}],[{key:"getTheme",value:function(e){return e.theme}},{key:"getSidenav",value:function(e){return e.sidenav}},{key:"getSiteHeader",value:function(e){return e.siteHeader}}]),e}()).\u0275fac=function(e){return new(e||Ap)},Ap.\u0275prov=P.Lb({token:Ap,factory:Ap.\u0275fac}),Hp([Object(E.a)(Vu.SetTheme),Qp("design:type",Function),Qp("design:paramtypes",[Object,Vu.SetTheme]),Qp("design:returntype",void 0)],Ap.prototype,"setTheme",null),Hp([Object(E.a)(Vu.SetHeader),Qp("design:type",Function),Qp("design:paramtypes",[Object,Vu.SetHeader]),Qp("design:returntype",void 0)],Ap.prototype,"setHeader",null),Hp([Object(E.a)(Vu.SetSidenav),Qp("design:type",Function),Qp("design:paramtypes",[Object,Vu.SetSidenav]),Qp("design:returntype",void 0)],Ap.prototype,"setSidenav",null),Hp([Object(E.a)(Vu.ToggleSidenav),Qp("design:type",Function),Qp("design:paramtypes",[Object,Vu.ToggleSidenav]),Qp("design:returntype",void 0)],Ap.prototype,"toggleSidenav",null),Hp([Object(E.a)(Vu.ResetLayout),Qp("design:type",Function),Qp("design:paramtypes",[Object,Vu.ResetLayout]),Qp("design:returntype",void 0)],Ap.prototype,"resetLayout",null),Hp([Object(E.e)(),Qp("design:type",Function),Qp("design:paramtypes",[Vp]),Qp("design:returntype",void 0)],Ap,"getTheme",null),Hp([Object(E.e)(),Qp("design:type",Function),Qp("design:paramtypes",[Vp]),Qp("design:returntype",void 0)],Ap,"getSidenav",null),Hp([Object(E.e)(),Qp("design:type",Function),Qp("design:paramtypes",[Vp]),Qp("design:returntype",void 0)],Ap,"getSiteHeader",null),Ap=Hp([Object(E.f)({name:"layout",defaults:qp})],Ap)),$p=xu.ui,Kp=function e(){m(this,e)},Gp=function(e,t){return void 0===e?t:e};function Zp(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return!!t.some((function(e){return!0===e}))||!t.some((function(e){return!1===e}))&&void 0}function Jp(e,t,n){return Object.values(cc).indexOf(n)>=0?n:!1===e?cc.None:null!=t?t?cc.Full:cc.Small:null}function Xp(e){return Object.values(lc).includes(e)?e:null}!function(e){function t(e){var t;return u(t={},$u.Loader,e?uc:lc.None),u(t,$u.Column,e),u(t,$u.Drawer,e),u(t,$u.Tools,e),u(t,$u.Toolbar,e),u(t,$u.Fullscreen,e),u(t,$u.Help,e),u(t,$u.Camera,e),u(t,$u.Search,e),u(t,$u.Presenter,e),u(t,$u.Menu,e),u(t,$u.Audio,e),u(t,$u.Pagination,e),u(t,$u.NodeInfo,e),u(t,$u.Labels,null),u(t,$u.LabelList,e),u(t,$u.Media,null),u(t,$u.TitleOnly,e),u(t,$u.Undo,e),u(t,"all",e),u(t,"drawerExpandedInitially",null),u(t,"logoIsHyperLink",null),u(t,$u.AnatomyLabels,null),u(t,$u.Logo,!0),u(t,$u.Tutorial,null),u(t,$u.InternetExplorerWarning,!0),u(t,$u.Legend,!0),u(t,$u.Whiteboard,e),u(t,$u.VisibilityLayers,e),u(t,$u.ContextActions,e),u(t,$u.ToggleLabels,!0),t}function n(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return null==t?e:Object(Se.uniq)([].concat(c(Object.keys(e)),c(Object.keys(t)))).reduce((function(i,o){return i[o]=null==e[o]||n&&null!=t[o]?t[o]:e[o],i}),new Kp)}e.convertAPIUIConfigToUIConfig=function(e){var i,o=null!=e.all?t(e.all):new Kp;return n((u(i={all:e.all},$u.Loader,Xp(e.loader)),u(i,$u.Help,Zp(e.help,e.help)),u(i,$u.Tools,Zp(e.tools,e.tools)),u(i,$u.Layout,e.layout),u(i,$u.Toolbar,e.toolbar),u(i,$u.Fullscreen,Zp(e.fullscreen,e.fullscreen)),u(i,$u.Search,Zp(e.objectTree,e.search)),u(i,$u.Audio,e.audio),u(i,$u.Media,Jp(e.playPause,Zp(e.scrubber,e["scrubber.chapters"]),e.media)),u(i,$u.Camera,Zp(e.nav,e.cameraMode,e.center,e.zoomIn,e.zoomOut,e.nav)),u(i,$u.Pagination,Zp(e.tour,e["tour.chapters"])),u(i,$u.Column,Zp(e.info,e.info)),u(i,$u.Drawer,Zp(e.info,e.info)),u(i,$u.TitleOnly,Zp(e.info,e.info)),u(i,$u.LabelList,Zp(e.labelList,e.labelList)),u(i,$u.NodeInfo,e.anatomyDescriptions),u(i,$u.Legend,e.legend),u(i,$u.Menu,e.menu),u(i,$u.InternetExplorerWarning,void 0),u(i,$u.Labels,void 0),u(i,$u.Logo,void 0),u(i,$u.Presenter,void 0),u(i,"logoIsHyperLink",void 0),u(i,"drawerExpandedInitially",void 0),u(i,$u.Tutorial,void 0),u(i,$u.AnatomyLabels,Zp(e.anatomyLabels,e.anatomyLabels)),u(i,$u.Undo,Zp(e.reset,e.undo)),u(i,$u.Whiteboard,e.whiteboard),u(i,$u.VisibilityLayers,e.visibilityLayers),u(i,$u.ContextActions,e.contextActions),u(i,$u.ToggleLabels,void 0),i),o)},e.convertUrlUIConfigToUIConfig=function(e){var i,o=null!=e["ui-all"]?t(e["ui-all"]):new Kp;return n((u(i={},$u.Layout,e["ui-layout"]),u(i,$u.Loader,Xp(e["ui-loader"])),u(i,$u.NodeInfo,e["ui-anatomy-descriptions"]),u(i,$u.Tools,e["ui-tools"]),u(i,$u.Toolbar,e["ui-toolbar"]),u(i,$u.Media,Jp(null,Zp(e["ui-scrubber"],e["ui-scrubber.chapters"],e["ui-scrubber.tour"]),e["ui-media-controls"])),u(i,$u.Audio,e["ui-audio"]),u(i,$u.Fullscreen,e["ui-fullscreen"]),u(i,$u.Help,e["ui-help"]),u(i,$u.Camera,e["ui-nav"]),u(i,$u.Presenter,e["ui-presenter"]),u(i,$u.Menu,e["ui-menu"]),u(i,$u.Pagination,e["ui-tour"]),u(i,$u.Search,Zp(e["ui-search"],e["ui-object-tree"])),u(i,$u.Column,Zp(e["ui-info"],e["ui-panel"])),u(i,$u.Drawer,Zp(e["ui-info"],e["ui-panel"])),u(i,$u.Description,Zp(e["ui-info"])),u(i,$u.TitleOnly,Zp(e["ui-info"])),u(i,$u.Logo,Zp(e["ui-bd"],e["ui-logo"])),u(i,"logoIsHyperLink",Zp(e["ui-bd.link"],e["ui-logo.islink"])),u(i,$u.Labels,e["ui-labels"]),u(i,$u.LabelList,e["ui-label-list"]),u(i,$u.InternetExplorerWarning,e["ie-warning"]),u(i,"all",e["ui-all"]),u(i,"drawerExpandedInitially",e["ui-info-expand"]),u(i,$u.AnatomyLabels,Zp(e["ui-anatomy-labels"])),u(i,$u.Tutorial,Zp(e["ui-tutorial"])),u(i,$u.Legend,Zp(e["ui-legend"])),u(i,$u.Undo,Zp(e["ui-undo"],e["ui-reset"])),u(i,$u.Whiteboard,Zp(e["ui-whiteboard"])),u(i,$u.VisibilityLayers,Zp(e["ui-visibility-layers"],e["ui-layers"])),u(i,$u.ContextActions,Zp(e["ui-context-actions"])),u(i,$u.ToggleLabels,void 0),i),o)},e.chapterUItoUIConfig=function(e){if(!e||!e.config)return null;var t=new Kp;return t[$u.Column]=e.config.info,t[$u.Drawer]=e.config.info,t[$u.Fullscreen]=e.config.fullscreen,t[$u.Search]=e.config.objectTree,t[$u.Camera]=e.config.nav,t[$u.Loader]=Xp(e.config.loader),t[$u.Whiteboard]=e.config.whiteboard,t[$u.VisibilityLayers]=e.config.visibilityLayers,t[$u.ContextActions]=e.config.contextActions,t[$u.Media]=Jp(e.config.playPause,e.config.scrubber,e.config.mediaControls),t},e.generateUIAllConfig=t,e.generateQuizUIConfig=function(){var e=new Kp;return e.search=!1,e.pagination=!1,e.labelList=!1,e.labels=!1,e.anatomyLabels=!1,e.nodeInfo=!1,e.toggleLabels=!1,e.legend=!1,e},e.mergeUIConfigs=n,e.createLayoutFromConfig=function(e,t){var n=JSON.parse(JSON.stringify(e));return n.loader.enable=Gp(t[$u.Loader]!==lc.None,$p.loader.enable),null!=t[$u.Loader]&&(n.loader.template=t[$u.Loader]),n.nodeInfo.enable=Gp(t[$u.NodeInfo],$p.nodeInfo.enable),n.pagination.enable=Gp(t[$u.Pagination],$p.pagination.enable),n.drawer.isExpandedInitially=Gp(t.drawerExpandedInitially,$p.drawer.isExpandedInitially),n.tools.enable=Gp(t[$u.Tools],$p.tools.enable),n.toolbar.enable=Gp(t[$u.Toolbar],$p.toolbar.enable),n.media.enable=Gp(t[$u.Media]!==cc.None,$p.media.enable),n.media.template=t[$u.Media],n.fullscreen.enable=Gp(t[$u.Fullscreen],$p.fullscreen.enable),n.help.enable=Gp(t[$u.Help],$p.help.enable),n.description.enable=Gp(t[$u.Description],$p.description.enable),n.titleOnly.enable=Gp(t[$u.TitleOnly],$p.titleOnly.enable),n.camera.enable=Gp(t[$u.Camera],$p.camera.enable),n.search.enable=Gp(t[$u.Search],$p.search.enable),n.presenter.enable=Gp(t[$u.Presenter],$p.presenter.enable),n.menu.enable=Gp(t[$u.Menu],$p.menu.enable),n.logo.enable=Gp(t[$u.Logo],$p.logo.enable),n.logo.isHyperLink=Gp(t.logoIsHyperLink,$p.logo.isHyperLink),n.internetExplorerWarning.enable=Gp(t.internetExplorerWarning,$p.internetExplorerWarning.enable),n.undo.enable=Gp(t[$u.Undo],$p.undo.enable),n.labels.enable=Gp(t[$u.Labels],$p.labels.enable),n.labelList.enable=Gp(t[$u.LabelList],$p.labelList.enable),n.audio.enable=Gp(t[$u.Audio],$p.audio.enable),n.reset.enable=Gp(t[$u.Reset],$p.reset.enable),n.column.enable=Gp(t[$u.Column],$p.column.enable),n.drawer.enable=Gp(t[$u.Drawer],$p.drawer.enable),n.anatomyLabels.enable=Gp(t[$u.AnatomyLabels],$p.anatomyLabels.enable),n.tutorial.enable=Gp(t[$u.Tutorial],$p.tutorial.enable),n.whiteboard.enable=Gp(t[$u.Whiteboard],$p.whiteboard.enable),n.visibilityLayers.enable=Gp(t[$u.VisibilityLayers],$p.visibilityLayers.enable),n.contextActions.enable=Gp(t[$u.ContextActions],$p.contextActions.enable),n.toggleLabels.enable=Gp(t[$u.ToggleLabels],$p.toggleLabels.enable),n},e.getScrollSetting=function(e){return e["disable-scroll"]?Vr.DoNotCapture:e["disable-scroll.alert"]||e["disable-scroll.overlay"]?Vr.DoNotCaptureShowMessage:Vr.Capture},e.getUsePrintImage=function(e){return!0===e["ui-print-image"]},e.getInteractType=function(e,t,n){var i=e["initial.play"]||e.initial||e["initial.button"]||e["initial.hand"]||e["initial.hand-hint"]||t;return{interactType:function(){switch(!0){case e.initial:case e["initial.button"]:return tu.Button;case e["initial.hand"]:case e["initial.hand-hint"]:return tu.Hand;case e["initial.play"]:return tu.Play;default:return n}}(),isInteractActive:i}},e.getOnDemand=function(e){return!1===e["auto-load"]}}(Rp||(Rp={}));var Yp,ed=function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function a(e){try{c(i.next(e))}catch(t){r(t)}}function s(e){try{c(i.throw(e))}catch(t){r(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))},td=((Yp=function(){function e(t,n,i,o,r,a){m(this,e),this.store=t,this.location=n,this.transitionService=i,this.engineService=o,this.layoutService=r,this.pendoService=a}return v(e,[{key:"initStory",value:function(e,t,n){var i=this;this.store.dispatch(new za(e,t,!0)),U.application!==M.Viewer&&"preview"!==e&&this.store.dispatch(new ip(e,t));var o=this.store.select(Wr.getReady),r=this.store.select(Hs.getIncomingStoryInfo),a="preview"===e;Object(Gr.b)([o,r]).pipe(Object(me.a)((function(e){var t=p(e,2),n=t[0],i=t[1];return n&&!!i.id})),Object(Ou.a)(1)).subscribe((function(){i.store.dispatch(new On),i.store.dispatch(new _a(e,t,n,a))}))}},{key:"nextChapter",value:function(e){var t=this.store.selectSnapshot(Lr.getSelectedChapterIndex),n=this.store.selectSnapshot(Lr.getStoryChapters);this.pendoService.trackOncePerSession(_e.DiscoveredChapterNav,{source:e,breakpoint:this.store.selectSnapshot(Wu.getBreakpointLabel)});var i=n[t+1];i&&this.selectChapter(i)}},{key:"previousChapter",value:function(e){var t=this.store.selectSnapshot(Lr.getSelectedChapterIndex),n=this.store.selectSnapshot(Lr.getStoryChapters);this.pendoService.trackOncePerSession(_e.DiscoveredChapterNav,{source:e,breakpoint:this.store.selectSnapshot(Wu.getBreakpointLabel)});var i=n[t-1];i&&this.selectChapter(i)}},{key:"selectChapter",value:function(e){return ed(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,i,o,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this.store.selectSnapshot(Lr.getSelectedChapterId),i=e.id,o=this.store.selectSnapshot(Lr.getStoryChapters),r=this.transitionService.searchChapterTransitions(n,i,o),this.pendoService.trackOncePerSession(_e.DiscoveredChapterNav,{source:"Chapter List",breakpoint:this.store.selectSnapshot(Wu.getBreakpointLabel)}),t.t0=r,!t.t0){t.next=6;break}return t.next=6,this.chapterTransition(r);case 6:this.store.dispatch([new Ua(e.id),new On(e)]);case 7:case"end":return t.stop()}}),t,this)})))}},{key:"chapterTransition",value:function(e){var t=this;return new Promise((function(n){e.camera&&t.store.dispatch(new $t(e.camera,!0,e.duration)),e.fadeColor&&t.store.dispatch(new De(e.fadeColor,e.duration)),setTimeout((function(){n(!0)}),1e3*e.duration)}))}},{key:"hideSelectedStructures",value:function(){var e=this.store.selectSnapshot(Ai.getCheckedNodeIds);this.store.dispatch(new pi.UpdateNodesShown(!1,e))}},{key:"selectTool",value:function(e){this.store.dispatch(new Xe(e))}},{key:"toggleColumn",value:function(e){var t=this.store.selectSnapshot(ku.getUI);t.column.status=(e=null==e?!(t.column.status===sc.Show):e)?sc.Show:sc.Collapse,this.store.dispatch(new j.SetUI(t))}},{key:"togglePresentation",value:function(){this.store.selectSnapshot(ku.getPresentationActive)?this.stopPresentation():this.startPresentation()}},{key:"startPresentation",value:function(){this.store.dispatch(new j.TogglePresentation(!0))}},{key:"stopPresentation",value:function(){this.store.dispatch(new j.TogglePresentation(!1))}},{key:"toggleHelp",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ye.Basics;this.store.dispatch(new j.ToggleWindow(nu.Help,e)),this.store.dispatch(new j.ToggleHelpTab(t))}},{key:"toggleInteract",value:function(e){this.store.dispatch(new j.ToggleWindow(nu.Interact,e))}},{key:"toggleOnDemand",value:function(e){this.store.dispatch(new j.SetOnDemand(e)),this.store.dispatch(new j.ToggleWindow(nu.OnDemand,e))}},{key:"toggleTutorial",value:function(e){this.store.dispatch(new j.ToggleWindow(nu.Tutorial,e)),e&&this.store.dispatch(new j.StartTutorial(!0))}},{key:"toggleWhiteboard",value:function(e){this.store.dispatch(new j.ToggleWindow(nu.Whiteboard,e)),e&&(this.store.dispatch(new et(!1)),this.store.dispatch(new j.SetWhiteboardEnabled(!0)))}},{key:"toggleLabels",value:function(e){this.store.dispatch(new Je(e))}},{key:"toggleSearch",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Yl.List,t=arguments.length>1?arguments[1]:void 0;this.store.selectSnapshot(Wu.getBreakpoint);var n=this.store.selectSnapshot(ku.getUI);n.search.status=(t=null==t?!(n.search.status===sc.Show):t)?sc.Show:sc.Hide,t&&(n.nodeInfo.status=sc.Hide),this.store.dispatch(new j.SetSearchDisplayMode(e)),this.store.dispatch(new j.SetUI(n))}},{key:"toggleNodeInfo",value:function(e){this.toggleInfoLayout("nodeInfo",e)}},{key:"toggleLabelInfo",value:function(e){this.toggleInfoLayout("labelInfo",e)}},{key:"toggleInfoLayout",value:function(e,t){var n=this.store.selectSnapshot(ku.getUI);(t=null==t?n[e].status===sc.Hide:t)?(n[e].status=sc.Show,["nodeInfo","labelInfo"].filter((function(t){return t!==e})).forEach((function(e){return n[e].status=sc.Hide}))):n[e].status=sc.Hide,this.store.dispatch(new j.SetUI(n))}},{key:"delegateNodeClick",value:function(e,t){if(this.clearSelectedLabel(),e||t.srcEvent.shiftKey)if(t.srcEvent.shiftKey||this.store.selectSnapshot(ku.getMultiPickModeEnabled))this.checkNode(e);else switch(this.store.selectSnapshot(Wr.getActiveTool)){case Rr.Hide:this.hideNode(e);break;case Rr.Select:this.selectNode(e);break;case Rr.Isolate:this.isolateNode(e);break;case Rr.Fade:this.fadeNode(e)}else this.clearSelectedNodes()}},{key:"clearSelectedLabel",value:function(){this.store.dispatch(new Zo)}},{key:"clearSelectedNodes",value:function(){this.store.dispatch(new pi.UpdateNodeSelected),this.store.dispatch(new pi.UpdateNodesChecked(!1))}},{key:"checkNode",value:function(e,t){void 0!==e&&(null==t&&(t=this.store.selectSnapshot(Ai.getNodes)[e.id].checked),this.store.dispatch(new pi.UpdateNodesChecked(!t,[e.id])),this.store.dispatch(new pi.UpdateNodeSelected(e.id)))}},{key:"fadeNode",value:function(e){this.store.dispatch(new pi.UpdateNodesPaint(Zi.recipe,[e.id]))}},{key:"isolateNode",value:function(e){this.store.dispatch(new pi.UpdateNodesShown(!1)),this.store.dispatch(new pi.UpdateNodesShown(!0,[e.id]))}},{key:"selectNode",value:function(e){var t=!this.store.selectSnapshot(Ai.getNodes)[e.id].checked;this.store.dispatch(new pi.UpdateNodesChecked(!1)),t&&(this.store.dispatch(new pi.UpdateNodesChecked(!0,[e.id])),this.store.dispatch(new pi.UpdateNodeSelected(e.id))),this.store.dispatch(new ft(e)),this.store.dispatch(new xt(e))}},{key:"hideNode",value:function(e){this.store.dispatch(new pi.UpdateNodesShown(!1,[e.id])),this.store.dispatch(new pi.UpdateNodesChecked(!1))}},{key:"selectLabel",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.objectId,i=e.states;this.store.dispatch(new Zo(e)),t&&n&&0===i.length&&this.store.dispatch(new Qe(n,!0))}},{key:"initChapter",value:function(e){return ed(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=this.engineService.createViewGraph({},!1),this.store.dispatch(new Fe(n)),this.store.dispatch(new $t(e.camera.location,e.camera.action===Du.FlyTo));case 2:case"end":return t.stop()}}),t,this)})))}},{key:"playChapterFromStart",value:function(){this.store.dispatch(new ot)}},{key:"resetCamera",value:function(){var e=this.store.selectSnapshot(Lr.getSelectedChapter);e&&this.store.dispatch(new $t(e.camera.location))}},{key:"resetChapter",value:function(){this.resetCamera();var e=this.store.selectSnapshot(Lr.getSelectedChapterId);this.store.dispatch(new di.UndoAll(e)),this.store.dispatch(new pi.UpdateNodesChecked(!1)),this.store.dispatch(new qo)}},{key:"resetLayout",value:function(){var e=this.store.selectSnapshot(ku).ui;this.layoutService.isUIHidden()?Object.keys(e).forEach((function(t){e[t].status=sc.Hide})):(Object.keys(e).forEach((function(t){e[t].status=sc.Show})),e.search.status=sc.Hide,e.tools.status=sc.Hide,e.nodeInfo.status=sc.Hide,e.labelInfo.status=sc.Hide,e.media.status=sc.Hide,e.visibilityLayers.status=sc.Hide),this.store.dispatch(new j.SetUI(e))}},{key:"undo",value:function(){this.store.dispatch(new di.Undo(this.store.selectSnapshot(Lr.getSelectedChapterId)))}},{key:"redo",value:function(){this.store.dispatch(new di.Redo(this.store.selectSnapshot(Lr.getSelectedChapterId)))}},{key:"toggleAnimation",value:function(){var e=!this.store.selectSnapshot(Wr.getAnimationPlaying);this.store.dispatch(new et(e))}},{key:"toggleAudio",value:function(){var e=this.store.selectSnapshot(Wr.getPlayAudio);this.store.dispatch(new it(!e))}},{key:"toggleToolbar",value:function(e){var t=this.store.selectSnapshot(ku.getUI);t.media.status=sc.Hide,t.tools.status=sc.Hide,t.toolbar.status=sc.Hide,t.visibilityLayers.status=sc.Hide,t[e].status=sc.Show,this.store.dispatch(new j.SetUI(t))}},{key:"normalizeQueryParams",value:function(e){var t=Object.assign({},e);return{id:_u(t),type:ju(t),lang:e.lang}}},{key:"sanitizeRouteId",value:function(e){return e=e.replace(/\.json$/,""),this.location.replaceState("view","?id="+e),e}},{key:"openInNewTab",value:function(){var e=window.document.location.href;window.open(e)}},{key:"getComputedTransform",value:function(e){var t=getComputedStyle(e).transform.replace("matrix3d","").replace("matrix","").replace("(","").replace(")","").split(",").map((function(e){return e.trim()})).map((function(e){return parseInt(e,10)})),n=16===t.length?t[12]:t[4],i=16===t.length?t[13]:t[5];return Number.isNaN(n)||Number.isNaN(i)?null:{x:n,y:i}}},{key:"getVH",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.store.selectSnapshot(Wp.getSiteHeader);return.01*(window.innerHeight-(e&&t!==Bp.Hide?56:0))}},{key:"inferDrawerMode",value:function(e){var t=Cu.Content;return e.nodeInfo.status===sc.Show?t=Cu.NodeInfo:e.labelInfo.status===sc.Show&&(t=Cu.LabelInfo),t}},{key:"setUI",value:function(e){var t,n=null!==(t=e.baseUIConfig)&&void 0!==t?t:new Kp;n=Rp.mergeUIConfigs(n,e.apiUIConfig),n=Rp.mergeUIConfigs(n,e.urlUIConfig),n=Rp.mergeUIConfigs(n,e.chapterUIConfig),e.quizUIConfig&&(n=Rp.mergeUIConfigs(n,e.quizUIConfig,!0));var i=this.store.selectSnapshot(ku.getUI),o=Rp.createLayoutFromConfig(i,n);this.store.dispatch(new j.SetUI(o))}}]),e}()).\u0275fac=function(e){return new(e||Yp)(P.Zb(E.g),P.Zb(ra.g),P.Zb(Lu),P.Zb(Nt),P.Zb(Yu),P.Zb(je))},Yp.\u0275prov=P.Lb({token:Yp,factory:Yp.\u0275fac,providedIn:"root"}),Yp);function nd(e,t){1&e&&P.Qb(0,"img",9)}function id(e,t){1&e&&P.Qb(0,"img",9)}function od(e,t){1&e&&P.Qb(0,"img",10)}function rd(e,t){1&e&&P.Qb(0,"img",11)}function ad(e,t){if(1&e&&(P.Tb(0),P.Kc(1,nd,1,0,"img",6),P.Kc(2,id,1,0,"img",6),P.Kc(3,od,1,0,"img",7),P.Kc(4,rd,1,0,"img",8),P.Sb()),2&e){var n=P.gc();P.Db(1),P.lc("ngIf",n.label.pinType==n.labelPinType.Default),P.Db(1),P.lc("ngIf",n.label.pinType==n.labelPinType.Sequential),P.Db(1),P.lc("ngIf",n.label.pinType===n.labelPinType.Plus||n.label.pinType===n.labelPinType.PlusMinus&&!n.selected),P.Db(1),P.lc("ngIf",n.label.pinType===n.labelPinType.Minus||n.label.pinType===n.labelPinType.PlusMinus&&n.selected)}}function sd(e,t){1&e&&P.Qb(0,"img",15)}function cd(e,t){1&e&&P.Qb(0,"img",15)}function ld(e,t){1&e&&P.Qb(0,"img",16)}function ud(e,t){1&e&&P.Qb(0,"img",17)}function pd(e,t){if(1&e&&(P.Kc(0,sd,1,0,"img",12),P.Kc(1,cd,1,0,"img",12),P.Kc(2,ld,1,0,"img",13),P.Kc(3,ud,1,0,"img",14)),2&e){var n=P.gc();P.lc("ngIf",n.label.pinType==n.labelPinType.Default),P.Db(1),P.lc("ngIf",n.label.pinType==n.labelPinType.Sequential),P.Db(1),P.lc("ngIf",n.label.pinType===n.labelPinType.Plus||n.label.pinType===n.labelPinType.PlusMinus&&!n.selected),P.Db(1),P.lc("ngIf",n.label.pinType===n.labelPinType.Minus||n.label.pinType===n.labelPinType.PlusMinus&&n.selected)}}var dd=function(e,t){return{"label-pin__text--white":e,"label-pin__text--black":t}};function gd(e,t){if(1&e&&(P.Tb(0),P.Vb(1,"div",18),P.Mc(2),P.Ub(),P.Sb()),2&e){var n=P.gc();P.Db(1),P.lc("ngClass",P.pc(2,dd,n.labelTheme===n.labelThemeEnum.StudioNext,n.labelTheme===n.labelThemeEnum.Annotation)),P.Db(1),P.Oc(" ",n.sequence," ")}}var hd,fd=function(e,t,n,i){return{"label-pin--light":e,"label-pin--dark":t,"label-pin--none":n,"label-pin--selected":i}},bd=((hd=function e(){m(this,e),this.labelPinType=Xn,this.labelThemeEnum=Yn,this.labelTheme=Yn.StudioNext,this.selected=!1}).\u0275fac=function(e){return new(e||hd)},hd.\u0275cmp=P.Jb({type:hd,selectors:[["app-label-pin"]],inputs:{label:"label",labelTheme:"labelTheme",selected:"selected",sequence:"sequence"},decls:7,vars:9,consts:[[1,"label-pin",3,"ngClass"],["pin",""],[4,"ngIf","ngIfElse"],["lightPins",""],[4,"ngIf"],[1,"label__glow"],["draggable","false","alt","","src","./assets/images/labels/circle-dark.svg","class","label-pin__image",4,"ngIf"],["draggable","false","alt","","src","./assets/images/labels/circle-plus-dark.svg","class","label-pin__image",4,"ngIf"],["draggable","false","alt","","src","./assets/images/labels/circle-minus-dark.svg","class","label-pin__image",4,"ngIf"],["draggable","false","alt","","src","./assets/images/labels/circle-dark.svg",1,"label-pin__image"],["draggable","false","alt","","src","./assets/images/labels/circle-plus-dark.svg",1,"label-pin__image"],["draggable","false","alt","","src","./assets/images/labels/circle-minus-dark.svg",1,"label-pin__image"],["draggable","false","alt","","src","./assets/images/labels/circle.svg","class","label-pin__image",4,"ngIf"],["draggable","false","alt","","src","./assets/images/labels/circle-plus.svg","class","label-pin__image",4,"ngIf"],["draggable","false","alt","","src","./assets/images/labels/circle-minus.svg","class","label-pin__image",4,"ngIf"],["draggable","false","alt","","src","./assets/images/labels/circle.svg",1,"label-pin__image"],["draggable","false","alt","","src","./assets/images/labels/circle-plus.svg",1,"label-pin__image"],["draggable","false","alt","","src","./assets/images/labels/circle-minus.svg",1,"label-pin__image"],[1,"label-pin__text",3,"ngClass"]],template:function(e,t){if(1&e&&(P.Vb(0,"div",0,1),P.Kc(2,ad,5,4,"ng-container",2),P.Kc(3,pd,4,4,"ng-template",null,3,P.Lc),P.Kc(5,gd,3,5,"ng-container",4),P.Qb(6,"div",5),P.Ub()),2&e){var n=P.vc(4);P.lc("ngClass",P.rc(4,fd,t.labelTheme===t.labelThemeEnum.StudioNext,t.labelTheme===t.labelThemeEnum.Annotation,t.label.pinType===t.labelPinType.None,t.selected)),P.Db(2),P.lc("ngIf",t.labelTheme===t.labelThemeEnum.Annotation)("ngIfElse",n),P.Db(3),P.lc("ngIf",t.label.pinType===t.labelPinType.Sequential)}},directives:[ra.i,ra.l],styles:['.label-pin[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;position:relative;transition:background-color .12s;z-index:10}.label-pin__text[_ngcontent-%COMP%]{display:flex;z-index:10;justify-content:center;align-items:center;font-size:10px!important;color:#101823}.label-pin[_ngcontent-%COMP%]:before, .label-pin__text[_ngcontent-%COMP%]{position:absolute;left:0;top:0;width:100%;height:100%}.label-pin[_ngcontent-%COMP%]:before{content:" ";background-color:transparent;border:2px solid transparent;border-radius:50%;box-sizing:border-box;display:block;z-index:-2}.label-pin--light.label-pin--selected[_ngcontent-%COMP%]:before{background-color:#fff;border-color:#2d72dc;box-shadow:0 0 0 1px rgba(45,114,220,.7)}.label-pin--light.label-pin[_ngcontent-%COMP%]   .label-pin__text[_ngcontent-%COMP%]{color:#101823}.label-pin--dark.label-pin[_ngcontent-%COMP%]:before{background-color:rgba(0,0,0,.75)}.label-pin--dark.label-pin--selected[_ngcontent-%COMP%]:after, .label-pin--dark.label-pin--selected[_ngcontent-%COMP%]:before{background-color:#2d72dc}.label-pin--dark.label-pin[_ngcontent-%COMP%]   .label-pin__text[_ngcontent-%COMP%]{color:#fff}.label-pin--none.label-pin[_ngcontent-%COMP%]{display:none}'],changeDetection:0}),hd),vd=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},md=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},yd=["labelContainerEl"],xd=["labelEl"],kd=["wire"],wd=["tag"],Od=["pin"],Cd=["title"];function Sd(e,t){1&e&&(P.Vb(0,"div",18),P.Qb(1,"app-icon",19),P.Ub())}var _d=function(e){return{"label__body--collapse":e}};function jd(e,t){if(1&e&&(P.Vb(0,"div",20),P.jc(1,3),P.Ub()),2&e){var n=P.gc();P.lc("ngClass",P.oc(1,_d,n.isCollapsed||n.descriptionCollapsed))}}var Pd,Md=[[["","label-header",""]],[["","label-actions",""]],[["","label-more",""]],[["","label-body",""]]],Id=function(e,t,n,i,o,r,a,s,c,l){return{"label--selected":e,"label--glow":t,"label--annotation":n,"label--classic":i,"label--invert":o,"label--studio":r,"label--context":a,"label--screenshot-mode":s,"label--auto-fit":c,"label--opaque":l}},zd=function(e){return{"label__wire--collapse":e}},Td=function(e,t,n,i){return{"label__tag--collapse":e,"label__tag--collapsible":t,"label__tag--floating":n,"label__tag--draggable":i}},Ud=["[label-header]","[label-actions]","[label-more]","[label-body]"],Ld=((Pd=function(){function e(t,n,i,o,r,a,s){m(this,e),this.renderer=t,this.labelsService=n,this.engineService=i,this.cameraService=o,this.store=r,this.actions=a,this.changeDetection=s,this.labelPinType=Xn,this.labelSequentialType=ei,this.labelUpdated=new P.p,this.offsetUpdated=new P.p,this.pinClicked=new P.p,this.tagClicked=new P.p,this.displayUpdated=new P.p,this.positionUpdated=new P.p,this.hoverStart=new P.p,this.hoverEnd=new P.p,this.labelOffsetUpdated=new P.p,this.fit="fixed",this.opaque=!1,this.fixedScale=0,this.isCollapsed=!1,this.tagCollapsed=!1,this.theme="classic",this.pinDraggable=!0,this.tagDraggable=!0,this.enginePosition=null,this.isBackgroundDark=!1,this.pinDragging=!1,this.screenshotMode=!1,this.hammerManagers=[],this.displayUpdated$=new fe.a,this.positionUpdated$=new fe.a,this.ngUnsubscribe=new fe.a}return v(e,[{key:"label",get:function(){return this._label},set:function(e){var t=Object(Se.isEmpty)(e),n=Object(Se.isEmpty)(this.label);t&&!n?(this._label=Object.assign({},e),this.destroyLabel()):t||(this._label=Object.assign({},e),this.initLabel(this.label))}},{key:"ngOnInit",value:function(){this.initListeners()}},{key:"ngAfterViewInit",value:function(){this.bindTagEvents(),this.bindPinEvents(),this.bindHoverEvents()}},{key:"ngOnDestroy",value:function(){this.destroyLabel(),this.emitDisplayUpdated({id:this.label.id,inView:!1,shown:!1,objectShown:this.objectShown}),this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"destroyLabel",value:function(){this.hammerManagers.forEach((function(e){return e.destroy})),this.hammerManagers=[],this.deleteMarker(this.marker)}},{key:"initListeners",value:function(){var e=this;this.enginePosition$.pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){e.enginePosition=t})),this.engineService.getEvent(Dt.SceneMarkersUpdated).pipe(Object(me.a)((function(){return null!=e.label&&null!=e.enginePosition})),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(){e.setCanvasPos()})),this.displayUpdated$.pipe(Object(Xr.a)((function(e,t){return Object(Se.isEqual)(e,t)})),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){e.displayUpdated.next(t)})),this.positionUpdated$.pipe(Object(Xr.a)((function(e,t){return Object(Se.isEqual)(e,t)})),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){e.positionUpdated.next({positionUpdate:t,onCanvas:e.isOnCanvas()})})),this.background$.pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){var n=t.colors.slice(0,3),i=t.colors.slice(4,7);e.isBackgroundDark=!vr.isLight(n,i),e.changeDetection.markForCheck()})),this.actions.pipe(Object(E.j)(Wn),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(){e.screenshotMode=!0,e.changeDetection.detectChanges()})),this.actions.pipe(Object(E.i)($n),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(){e.screenshotMode=!1,e.changeDetection.markForCheck()}))}},{key:"bindTagEvents",value:function(){var e=this,t=new Ks(this.tagRef.nativeElement,{domEvents:!0});t.get("pan").set({direction:Ks.DIRECTION_ALL,threshold:3}),t.on("pan",(function(t){if(e.tagDraggable){t.srcEvent.stopPropagation(),e.cachedTagOffset||(e.cachedTagOffset=e.label.offset);var n=[e.cachedTagOffset[0]+t.deltaX,e.cachedTagOffset[1]+t.deltaY];e.label.offset=n,t.isFinal&&(e.cachedTagOffset=null,e.offsetUpdated.next({labelId:e.label.id,offset:n}))}})),t.on("tap",(function(t){t.srcEvent.preventDefault(),t.srcEvent.stopPropagation(),e.tagClicked.next(t)})),this.hammerManagers.push(t)}},{key:"bindPinEvents",value:function(){var e=this,t=new Ks(this.pinRef.nativeElement);t.get("pan").set({direction:Ks.DIRECTION_ALL,threshold:4}),t.on("pan",(function(t){if(e.pinDraggable){t.srcEvent.stopPropagation(),e.pinDragging=!0;var n=t.changedPointers[0],i=n.layerX,o=n.layerY;if(i-=16,o-=16,e.marker&&e.deleteMarker(e.marker),e.renderer.setStyle(e.labelContainerRef.nativeElement,"transform","translate(".concat(i,"px, ").concat(o,"px)")),t.isFinal){e.pinDragging=!1;var r=Object.assign({},e.label),a=Human.renderer.pick.pick({canvasPos:[i,o],rayPick:!0}),s="string"==typeof a.objectId;s&&(r.dir=e.cameraService.getDirection(a),r.objectId=a.objectId,r.barycentric=[a.barycentric[0],a.barycentric[1],a.barycentric[2]],r.pos=[a.worldPos[0],a.worldPos[1],a.worldPos[2]],r.primitiveIndex=a.primitiveIndex),e.labelUpdated.next({label:r,shouldPreserve:s})}}})),t.on("tap",(function(t){t.srcEvent.preventDefault(),t.srcEvent.stopImmediatePropagation(),e.pinClicked.next(t)})),this.hammerManagers.push(t)}},{key:"bindHoverEvents",value:function(){var e=this,t=this.labelRef.nativeElement;this.renderer.listen(t,"mouseenter",(function(){e.hoverStart.next({labelId:e.label.id})})),this.renderer.listen(t,"mouseleave",(function(){e.hoverEnd.next({labelId:e.label.id})}))}},{key:"initLabel",value:function(e){this.initMarker(e),this.ensureObjectId(e),this.initObjectSubscription(e)}},{key:"initMarker",value:function(e){this.marker&&this.deleteMarker(this.marker),this.marker=Human.scene.markers.create({id:e.id,pos:e.pos,dir:e.dir,objectId:e.objectId,primitiveIndex:e.primitiveIndex,barycentric:e.barycentric,renderableIndex:e.renderableIndex||0})}},{key:"checkLabelDisplay",value:function(){return{id:this.label.id,shown:this.label.shown,inView:this.isOnCanvas(),objectShown:!0}}},{key:"ensureObjectId",value:function(e){if(!e.objectId){var t=Human.renderer.pick.pick({canvasPos:[this.marker.canvasPos[0],this.marker.canvasPos[1]],rayPick:!0});t.objectId&&(e.objectId=t.objectId,e.states.forEach((function(e){e.errands.forEach((function(e){e.type===bi.flyToObject&&(e.value=t.objectId)}))})),this.labelUpdated.next({label:e,shouldPreserve:void 0}))}}},{key:"initObjectSubscription",value:function(e){var t=this;this.object$&&this.object$.unsubscribe(),e.objectId&&(this.object$=this.store.select(Wr.getViewGraphNode).pipe(Object(Z.a)((function(t){return t(e.objectId)})),Object(me.a)((function(e){return!!e})),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(e){t.objectShown=e.boolState.shown})))}},{key:"deleteMarker",value:function(e){Human.scene.markers.delete(e.id),this.marker=null}},{key:"setCanvasPos",value:function(){if(!this.pinDragging&&this.marker){this.depth=-this.marker.viewPos[2];var e=this.isOccluded(),t=this.isOcclusionIgnored(),n=this.isOnCanvas(),i=e&&!t,o=void 0===this.objectShown?n&&!i:n&&this.objectShown&&!i;o!==this.shown&&(this.shown=o,this.setDisplay(o)),this.setElementPosition(),this.setElementScale(),this.setTagPosition(),this.setWirePosition();var r=this.marker.canvasPos,a=r[0],s=r[1];this.positionUpdated$.next({id:this.label.id,canvasPos:{x:a,y:s},occluded:i})}}},{key:"isOcclusionIgnored",value:function(){return this.selected||!this.label.occludable}},{key:"isOccluded",value:function(){return this.depth<0||this.marker.occluded}},{key:"isOnCanvas",value:function(){var e=this.labelsService.getLabelContainer().nativeElement,t=e.offsetWidth,n=e.offsetHeight,i=p(this.marker.canvasPos,2),o=i[0],r=i[1];return o>0&&r>0&&o<t&&r<n}},{key:"setDisplay",value:function(e){this.renderer.setStyle(this.labelRef.nativeElement,"visibility",e?"visible":"hidden"),this.emitDisplayUpdated({id:this.label.id,inView:this.isOnCanvas(),shown:e,objectShown:this.objectShown})}},{key:"setOpacity",value:function(e){var t=1;e?(this.marker.viewAngle>=80&&(t=Math.max(1-(this.marker.viewAngle-80)/20*1,0)),this.renderer.setStyle(this.labelContainerRef.nativeElement,"opacity",t)):this.renderer.setStyle(this.labelContainerRef.nativeElement,"opacity",1)}},{key:"setElementPosition",value:function(){var e=this.marker.canvasPos;this.renderer.setStyle(this.labelContainerRef.nativeElement,"transform","translate(".concat(e[0],"px, ").concat(e[1],"px)"))}},{key:"setElementScale",value:function(){var e;if(this.fixedScale)e=this.fixedScale;else{var t=this.store.selectSnapshot(Wr.getEnginePosition).width;e=t>1440?t/1440:1}var n=32*e-32;this.renderer.setStyle(this.labelRef.nativeElement,"transform-origin","top left"),this.renderer.setStyle(this.labelRef.nativeElement,"transform","translate(-".concat(n/2,"px, -").concat(n/2,"px) scale(").concat(e,", ").concat(e,")"))}},{key:"setTagPosition",value:function(){var e=this.label.offset,t=this.tagRef.nativeElement.offsetWidth;switch(this.label.offset[0]>0?"left":"right"){case"left":this.renderer.setStyle(this.tagRef.nativeElement,"transform","translate(".concat(16+e[0],"px, ").concat(e[1],"px)"));break;case"right":this.renderer.setStyle(this.tagRef.nativeElement,"transform","translate(".concat(16+e[0]-t,"px, ").concat(e[1],"px)"))}}},{key:"setWirePosition",value:function(){var e=p(this.label.offset,2),t=e[0],n=e[1];switch(this.label.theme){case Yn.Annotation:case Yn.Classic:n+=this.titleRef.nativeElement.offsetHeight-16-2}var i=Math.sqrt(t*t+n*n);this.renderer.setStyle(this.wireRef.nativeElement,"width",i+"px"),this.renderer.setStyle(this.wireRef.nativeElement,"transform","rotate(".concat(Math.atan2(n,t),"rad)"))}},{key:"emitDisplayUpdated",value:function(e){"context-label"!==this.label.id&&null!=e.inView&&null!=e.shown&&this.displayUpdated$.next(e)}}]),e}()).\u0275fac=function(e){return new(e||Pd)(P.Pb(P.H),P.Pb(wi),P.Pb(Nt),P.Pb(gn),P.Pb(E.g),P.Pb(E.b),P.Pb(P.i))},Pd.\u0275cmp=P.Jb({type:Pd,selectors:[["app-generic-label"]],viewQuery:function(e,t){var n;1&e&&(P.Gc(yd,!0),P.Gc(xd,!0),P.Gc(kd,!0),P.Gc(wd,!0),P.Gc(Od,!0),P.Gc(Cd,!0)),2&e&&(P.uc(n=P.dc())&&(t.labelContainerRef=n.first),P.uc(n=P.dc())&&(t.labelRef=n.first),P.uc(n=P.dc())&&(t.wireRef=n.first),P.uc(n=P.dc())&&(t.tagRef=n.first),P.uc(n=P.dc())&&(t.pinRef=n.first),P.uc(n=P.dc())&&(t.titleRef=n.first))},inputs:{fit:"fit",opaque:"opaque",fixedScale:"fixedScale",sequence:"sequence",hasContent:"hasContent",label:"label",isCollapsed:"isCollapsed",descriptionCollapsed:"descriptionCollapsed",tagCollapsed:"tagCollapsed",selected:"selected",theme:"theme",pinDraggable:"pinDraggable",tagDraggable:"tagDraggable"},outputs:{labelUpdated:"labelUpdated",offsetUpdated:"offsetUpdated",pinClicked:"pinClicked",tagClicked:"tagClicked",displayUpdated:"displayUpdated",positionUpdated:"positionUpdated",hoverStart:"hoverStart",hoverEnd:"hoverEnd",labelOffsetUpdated:"labelOffsetUpdated"},ngContentSelectors:Ud,decls:21,vars:27,consts:[["data-test","labelContainer","aria-hidden","true",1,"label-container"],["labelContainerEl",""],["data-test","labelElement",1,"label",3,"ngClass"],["labelEl",""],[1,"label__pin"],["pin",""],[3,"label","labelTheme","selected","sequence"],[1,"label__glow"],[1,"label__wire",3,"ngClass"],["wire",""],[1,"label__tag",3,"ngClass"],["tag",""],[1,"label__header"],["data-test","labelTitle",1,"label__title"],["title",""],["class","label__more",4,"ngIf"],["appEventFence","",1,"label__actions"],["class","label__body",3,"ngClass",4,"ngIf"],[1,"label__more"],["icon","caret-right"],[1,"label__body",3,"ngClass"]],template:function(e,t){1&e&&(P.kc(Md),P.Vb(0,"div",0,1),P.Vb(2,"div",2,3),P.Vb(4,"div",4,5),P.Qb(6,"app-label-pin",6),P.Qb(7,"div",7),P.Ub(),P.Qb(8,"div",8,9),P.Vb(10,"div",10,11),P.Vb(12,"div",12),P.Vb(13,"div",13,14),P.jc(15),P.Ub(),P.Kc(16,Sd,2,0,"div",15),P.Vb(17,"div",16),P.jc(18,1),P.Ub(),P.Ub(),P.Kc(19,jd,2,3,"div",17),P.jc(20,2),P.Ub(),P.Ub(),P.Ub()),2&e&&(P.Db(2),P.lc("ngClass",P.tc(9,Id,[t.selected,t.label.pinGlow,"annotation"===t.label.theme,"classic"===t.label.theme,t.isBackgroundDark,"studioNext"===t.label.theme,"context"===t.label.theme,t.screenshotMode,"auto"===t.fit,t.opaque])),P.Db(4),P.lc("label",t.label)("labelTheme",t.label.theme)("selected",t.selected)("sequence",t.sequence),P.Db(2),P.lc("ngClass",P.oc(20,zd,t.isCollapsed||t.tagCollapsed||t.label.hideWire)),P.Db(2),P.lc("ngClass",P.rc(22,Td,t.isCollapsed||t.tagCollapsed,t.label.collapseDescription,t.label.hideWire,t.tagDraggable)),P.Db(6),P.lc("ngIf",t.hasContent&&t.label.collapseDescription),P.Db(3),P.lc("ngIf",t.hasContent))},directives:[ra.i,bd,ra.l,tl,nl],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3838}.text-info[_ngcontent-%COMP%]{color:#0060c4}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}@-webkit-keyframes fadeIn{0%{display:none;opacity:0}1%{display:block;opacity:0}to{opacity:1;display:block}}@keyframes fadeIn{0%{display:none;opacity:0}1%{display:block;opacity:0}to{opacity:1;display:block}}@-webkit-keyframes fadeOut{0%{display:block;opacity:1}99%{opacity:0}to{opacity:0;display:none}}@keyframes fadeOut{0%{display:block;opacity:1}99%{opacity:0}to{opacity:0;display:none}}@-webkit-keyframes glow{0%{box-shadow:0 0 0 hsla(0,0%,100%,.5)}50%{box-shadow:0 0 8px 2px hsla(0,0%,100%,.5)}to{box-shadow:0 0 0 hsla(0,0%,100%,.5)}}@keyframes glow{0%{box-shadow:0 0 0 hsla(0,0%,100%,.5)}50%{box-shadow:0 0 8px 2px hsla(0,0%,100%,.5)}to{box-shadow:0 0 0 hsla(0,0%,100%,.5)}}@-webkit-keyframes classic-glow{0%{transform:scale(.5)}10%{transform:scale(.5)}50%{transform:scale(1)}90%{transform:scale(.5)}to{transform:scale(.5)}}@keyframes classic-glow{0%{transform:scale(.5)}10%{transform:scale(.5)}50%{transform:scale(1)}90%{transform:scale(.5)}to{transform:scale(.5)}}.label-container[_ngcontent-%COMP%], [_nghost-%COMP%]{display:block;position:absolute;z-index:10;width:160px;pointer-events:all;pointer-events:none}.label-container[_ngcontent-%COMP%]:hover, [_nghost-%COMP%]:hover{z-index:11}.label-container[_ngcontent-%COMP%]{left:-16px;top:-16px}.label[_ngcontent-%COMP%]{display:block;overflow:visible;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;justify-content:center;align-items:center;height:32px}.label--screenshot-mode[_ngcontent-%COMP%]{text-shadow:none!important}.label--screenshot-mode[_ngcontent-%COMP%]   .label__pin[_ngcontent-%COMP%]:after, .label--screenshot-mode[_ngcontent-%COMP%]   .label__pin[_ngcontent-%COMP%]:before{box-shadow:none!important}.label--screenshot-mode[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]{box-shadow:none!important;text-shadow:none!important}.label--screenshot-mode[_ngcontent-%COMP%]   .label__more[_ngcontent-%COMP%]{display:none!important}.label--auto-fit[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]{min-width:-webkit-max-content;min-width:-moz-max-content;min-width:max-content;padding:0!important}.label--auto-fit[_ngcontent-%COMP%]   .label__body[_ngcontent-%COMP%]{padding:0!important}.label__glow[_ngcontent-%COMP%]{display:none;position:absolute;width:32px;height:32px;border-radius:50%;z-index:0;top:0;left:0}.label--selected[_ngcontent-%COMP%]   .label__more[_ngcontent-%COMP%]{transform:rotate(45deg)}.label__more[_ngcontent-%COMP%]{color:#374a68;display:none;flex:0 0 16px;height:16px;transition:transform .15s ease-in-out}.label__more[_ngcontent-%COMP%], .label__pin[_ngcontent-%COMP%]{align-items:center;justify-content:center}.label__pin[_ngcontent-%COMP%]{display:flex;width:32px;height:32px;border-radius:50%;position:absolute;pointer-events:all;transition:background-color .12s;z-index:10}.label__pin[_ngcontent-%COMP%]:hover{cursor:pointer}.label__pin--draggable[_ngcontent-%COMP%]:hover{cursor:-webkit-grab;cursor:grab}.label__pin--draggable[_ngcontent-%COMP%]:active{cursor:-webkit-grabbing;cursor:grabbing}.label__wire[_ngcontent-%COMP%]{position:absolute;top:16px;left:16px;height:0;transform-origin:0 100%;pointer-events:none;z-index:1}.label__wire--collapse[_ngcontent-%COMP%]{display:none}.label__tag[_ngcontent-%COMP%]{display:inline-block;left:16px;top:0;z-index:10;max-width:160px;pointer-events:all}.label__tag[_ngcontent-%COMP%]:hover{cursor:pointer}.label__tag--draggable[_ngcontent-%COMP%]:hover{cursor:-webkit-grab;cursor:grab}.label__tag--draggable[_ngcontent-%COMP%]:active{cursor:-webkit-grabbing;cursor:grabbing}.label__tag--collapse[_ngcontent-%COMP%]{display:none}.label__header[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.label__title[_ngcontent-%COMP%]{line-height:1.4em;line-height:140%;align-self:center}.label__body[_ngcontent-%COMP%], .label__title[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;letter-spacing:0}.label__body[_ngcontent-%COMP%]{line-height:1.4em}.label__body--collapse[_ngcontent-%COMP%]{display:none}.label__icon[_ngcontent-%COMP%]{margin:0 -4px 0 4px}.label__actions[_ngcontent-%COMP%]{padding-left:4px}.label--studio.label--glow[_ngcontent-%COMP%]   .label__glow[_ngcontent-%COMP%]{background-color:hsla(0,0%,100%,.3);display:block;-webkit-animation:classic-glow 4s infinite;animation:classic-glow 4s infinite}.label--studio.label--opaque[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]{background-color:hsla(0,0%,100%,.85)!important}.label--studio.label.label--selected[_ngcontent-%COMP%]   .label__wire[_ngcontent-%COMP%]{border-color:#2d72dc}.label--studio.label.label--selected[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]{background-color:#fff;border-color:#2d72dc;box-shadow:0 0 0 1px rgba(45,114,220,.7)}.label--studio.label.label--selected[_ngcontent-%COMP%]   .label__title[_ngcontent-%COMP%]{font-weight:600}.label--studio.label[_ngcontent-%COMP%]   .label__wire[_ngcontent-%COMP%]{border-top:1px solid rgba(16,24,35,.5)}.label--studio.label[_ngcontent-%COMP%]   .label__wire--collapse[_ngcontent-%COMP%]{display:none}.label--studio.label[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]{background:hsla(0,0%,100%,.55);border:1px solid rgba(16,24,35,.5);box-shadow:0 0 24px rgba(16,24,35,.1);padding:4px 8px;border-radius:4px}.label--studio.label[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]:hover{background:hsla(0,0%,100%,.8)}.label--studio.label[_ngcontent-%COMP%]   .label__title[_ngcontent-%COMP%]{color:#101823;flex:1 1 auto}.label--studio.label[_ngcontent-%COMP%]   .label__body[_ngcontent-%COMP%]{color:#374a68;overflow-x:hidden;padding-top:4px}.label--studio.label[_ngcontent-%COMP%]   .label__body[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-weight:700}.label--studio.label[_ngcontent-%COMP%]   .label__body[_ngcontent-%COMP%]   em[_ngcontent-%COMP%]{font-style:italic}.label--studio.label[_ngcontent-%COMP%]   .label__more[_ngcontent-%COMP%]{display:flex}.label--studio.label.label--invert[_ngcontent-%COMP%]   .label__wire[_ngcontent-%COMP%]{border-color:hsla(0,0%,100%,.5)}.label--annotation.label--glow[_ngcontent-%COMP%]   .label__glow[_ngcontent-%COMP%]{background-color:hsla(0,0%,100%,.25);display:block;-webkit-animation:classic-glow 4s infinite;animation:classic-glow 4s infinite;top:-1px;left:-1px}.label--annotation.label--none[_ngcontent-%COMP%]{display:none}.label--annotation.label[_ngcontent-%COMP%]   .label__wire[_ngcontent-%COMP%]{border-top:1px solid #666}.label--annotation.label[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]{min-width:10px;color:#eee}.label--annotation.label[_ngcontent-%COMP%]   .label__tag--collapsible[_ngcontent-%COMP%]   .label__more[_ngcontent-%COMP%]{display:flex;color:#000}.label--annotation.label[_ngcontent-%COMP%]   .label__tag--floating[_ngcontent-%COMP%]   .label__header[_ngcontent-%COMP%]{border-bottom:none}.label--annotation.label[_ngcontent-%COMP%]   .label__header[_ngcontent-%COMP%]{border-bottom:1px solid #666}.label--annotation.label[_ngcontent-%COMP%]   .label__title[_ngcontent-%COMP%]{font-weight:600;min-height:18px;width:100%;padding-bottom:4px;margin-bottom:-2px;color:#000}.label--annotation.label[_ngcontent-%COMP%]   .label__body[_ngcontent-%COMP%]{padding-top:4px;color:#333}.label--annotation.label.label--invert.label[_ngcontent-%COMP%]   .label__wire[_ngcontent-%COMP%]{border-color:#eee}.label--annotation.label.label--invert.label[_ngcontent-%COMP%]   .label__tag--collapsible[_ngcontent-%COMP%]   .label__more[_ngcontent-%COMP%]{display:flex;color:#fff}.label--annotation.label.label--invert.label[_ngcontent-%COMP%]   .label__title[_ngcontent-%COMP%]{color:#fff}.label--annotation.label.label--invert.label[_ngcontent-%COMP%]   .label__header[_ngcontent-%COMP%]{border-color:#eee}.label--annotation.label.label--invert.label[_ngcontent-%COMP%]   .label__body[_ngcontent-%COMP%]{color:#eee}.label--classic.label--glow[_ngcontent-%COMP%]   .label__glow[_ngcontent-%COMP%]{background-color:rgba(0,0,0,.2);display:block;-webkit-animation:classic-glow 4s infinite;animation:classic-glow 4s infinite}.label--classic.label[_ngcontent-%COMP%]   .label__wire[_ngcontent-%COMP%]{border-top:1px solid #666}.label--classic.label[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]{min-width:10px;color:#eee}.label--classic.label[_ngcontent-%COMP%]   .label__title[_ngcontent-%COMP%]{border-bottom:1px solid #666;min-height:18px;width:100%;padding-bottom:4px;color:#000}.label--classic.label[_ngcontent-%COMP%]   .label__body[_ngcontent-%COMP%]{padding-top:4px;color:#333}.label--context.label[_ngcontent-%COMP%]{pointer-events:none}.label--context.label--glow[_ngcontent-%COMP%]   .label__glow[_ngcontent-%COMP%]{background-color:hsla(0,0%,100%,.3);display:block;-webkit-animation:classic-glow 4s infinite;animation:classic-glow 4s infinite}.label--context.label[_ngcontent-%COMP%]   .label__pin[_ngcontent-%COMP%], .label--context.label[_ngcontent-%COMP%]   .label__wire[_ngcontent-%COMP%]{display:none}.label--context.label[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]{background:hsla(0,0%,100%,.7);border:1px solid rgba(16,24,35,.5);box-shadow:0 0 24px rgba(16,24,35,.1);padding:4px 8px;border-radius:4px}.label--context.label[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]:hover{background:hsla(0,0%,100%,.8);cursor:-webkit-grab;cursor:grab}.label--context.label[_ngcontent-%COMP%]   .label__title[_ngcontent-%COMP%]{font-weight:600;color:#101823}.label--context.label[_ngcontent-%COMP%]   .label__body[_ngcontent-%COMP%]{margin-top:8px;border-top:1px solid #eaeff5;color:#101823;overflow-x:hidden;padding-top:8px}.label--context.label[_ngcontent-%COMP%]   .label__body[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-weight:700}.label--context.label[_ngcontent-%COMP%]   .label__body[_ngcontent-%COMP%]   em[_ngcontent-%COMP%]{font-style:italic}"],changeDetection:0}),vd([Object(E.d)(Wr.getEnginePosition),md("design:type",be.a)],Pd.prototype,"enginePosition$",void 0),vd([Object(E.d)(Lr.getSelectedChapterBackground),md("design:type",be.a)],Pd.prototype,"background$",void 0),Pd),Dd=h("lR5k"),Ed=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Fd(e,t){if(1&e&&P.Qb(0,"app-node-actions",7),2&e){var n=P.gc(2);P.lc("node",n.node)}}function Ad(e,t){if(1&e&&(P.Vb(0,"div",5),P.jc(1),P.Kc(2,Fd,1,1,"app-node-actions",6),P.Ub()),2&e){var n=P.gc();P.Db(2),P.lc("ngIf",n.enableActions)}}function Rd(e,t){if(1&e){var n=P.Wb();P.Vb(0,"a",10),P.cc("click",(function(){return P.zc(n),P.gc(2).handleReadMoreClick()})),P.Mc(1,"Read More..."),P.Ub()}2&e&&P.lc("@show",void 0)}function Vd(e,t){if(1&e&&(P.Tb(0,8),P.Kc(1,Rd,2,1,"a",9),P.Sb()),2&e){var n=P.gc();P.Db(1),P.lc("ngIf",n.node&&n.node.description)}}var Nd,Bd=["*"],Hd=((Nd=function(){function e(t,n,i,o,r){m(this,e),this.store=t,this.actions=n,this.engineService=i,this.viewService=o,this.changeDetectorRef=r,this.ngUnsubscribe=new fe.a}return v(e,[{key:"label",get:function(){return this._label},set:function(e){this._label=e,this.setLabelNode()}},{key:"ngOnInit",value:function(){this.initInfoListeners()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"setLabelNode",value:function(){var e=Object(Se.get)(this.label,"objectId");if(e){var t=this.store.selectSnapshot(Wr.getViewGraph);this.node=this.engineService.getNode(t,e)}else this.node=null;this.changeDetectorRef.markForCheck()}},{key:"initInfoListeners",value:function(){var e=this;this.actions.pipe(Object(E.i)(yt),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(){e.setLabelNode()}))}},{key:"handleReadMoreClick",value:function(){this.node&&this.viewService.toggleNodeInfo(!0)}}]),e}()).\u0275fac=function(e){return new(e||Nd)(P.Pb(E.g),P.Pb(E.b),P.Pb(Nt),P.Pb(td),P.Pb(P.i))},Nd.\u0275cmp=P.Jb({type:Nd,selectors:[["app-context-label"]],inputs:{label:"label",enableInfo:"enableInfo",enableActions:"enableActions"},ngContentSelectors:Bd,decls:6,vars:6,consts:[[1,"context-label",3,"label"],["label-header","",1,"html",3,"innerHTML"],["title",""],["class","context-label__actions","label-actions","",4,"ngIf"],["label-more","",4,"ngIf"],["label-actions","",1,"context-label__actions"],["eventCategory","Context Node","theme","light",3,"node",4,"ngIf"],["eventCategory","Context Node","theme","light",3,"node"],["label-more",""],["class","context-label__more",3,"click",4,"ngIf"],[1,"context-label__more",3,"click"]],template:function(e,t){1&e&&(P.kc(),P.Vb(0,"app-generic-label",0),P.Qb(1,"div",1,2),P.hc(3,"markdown"),P.Kc(4,Ad,3,1,"div",3),P.Kc(5,Vd,2,1,"ng-container",4),P.Ub()),2&e&&(P.lc("label",t.label),P.Db(1),P.lc("innerHTML",P.ic(3,4,t.label.title),P.Ac),P.Db(3),P.lc("ngIf",t.node),P.Db(1),P.lc("ngIf",t.enableInfo))},directives:[Ld,ra.l,Tl],pipes:[Dd.b],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3838}.text-info[_ngcontent-%COMP%]{color:#0060c4}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.context-label__actions[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}.context-label__action[_ngcontent-%COMP%]{cursor:pointer}.context-label__action--selected[_ngcontent-%COMP%]{color:#0060c4}.context-label__more[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em;cursor:pointer;display:block;line-height:24px;overflow:hidden}.context-label__more[_ngcontent-%COMP%]:hover{text-decoration:underline}"],data:{animation:[Object(wu.n)("show",[Object(wu.m)(":enter",[Object(wu.j)([Object(wu.l)({height:"0"}),Object(wu.e)("125ms ease-in-out",Object(wu.l)({height:"*"}))])])])]},changeDetection:0}),function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);r>3&&a&&Object.defineProperty(t,n,a)}([Object(E.d)(Wr.getQuerying),Ed("design:type",be.a)],Nd.prototype,"querying$",void 0),Nd),Qd=function(e){return e.Normal="normal",e.Compact="compact",e}({}),qd=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},Wd=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},$d=["image"],Kd=["imagePre"],Gd=["imagePost"],Zd=["imageContainer"];function Jd(e,t){if(1&e&&(P.Qb(0,"span",8),P.hc(1,"markdown")),2&e){var n=P.gc();P.lc("innerHTML",P.ic(1,1,n.label),P.Ac)}}function Xd(e,t){if(1&e&&P.Qb(0,"img",9,10),2&e){var n=P.gc();P.lc("src",n.imageUrl,P.Cc)}}function Yd(e,t){if(1&e&&P.Qb(0,"img",11,12),2&e){var n=P.gc();P.lc("src",n.imageUrl,P.Cc)}}var eg,tg=((eg=function(){function e(t,n,i){m(this,e),this.renderer=t,this.engineService=n,this.animationService=i,this.ngUnsubscribe=new fe.a,this.loopImage=!1}return v(e,[{key:"ngOnInit",value:function(){this.initChapterListener(),this.initTimelineListener()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initChapterListener",value:function(){var e=this;this.selectedChapterId$.pipe(Object(me.a)((function(e){return null!=e})),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){e.timerange=e.animationService.getChapterLocalTimerange(t)}))}},{key:"initTimelineListener",value:function(){var e=this;Object(Kr.a)(this.engineService.getEvent(Dt.TimelineScrubbed),this.engineService.getEvent(Dt.TimelinePlaying)).pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){var n=e.getChapterPercent(t.time);e.moveImage(n)}))}},{key:"moveImage",value:function(e){var t=this.image.nativeElement.getBoundingClientRect().width;this.renderer.setStyle(this.imageContainer.nativeElement,"transform","translate(".concat(e/100*-t,"px, 0)")),this.loopImage&&(this.renderer.setStyle(this.imagePre.nativeElement,"transform","translate(".concat(-t,"px, 0)")),this.renderer.setStyle(this.imagePost.nativeElement,"transform","translate(".concat(t,"px, 0)")))}},{key:"getChapterPercent",value:function(e){var t=this.timerange,n=t.firstTime,i=t.lastTime,o=this.animationService.mapGlobalTimeToLocal(e).time;return Math.max(n,Math.min(o,i))/i*100}}]),e}()).\u0275fac=function(e){return new(e||eg)(P.Pb(P.H),P.Pb(Nt),P.Pb(kr))},eg.\u0275cmp=P.Jb({type:eg,selectors:[["app-ticker-block-item"]],viewQuery:function(e,t){var n;1&e&&(P.Gc($d,!0),P.Rc(Kd,!0),P.Rc(Gd,!0),P.Gc(Zd,!0)),2&e&&(P.uc(n=P.dc())&&(t.image=n.first),P.uc(n=P.dc())&&(t.imagePre=n.first),P.uc(n=P.dc())&&(t.imagePost=n.first),P.uc(n=P.dc())&&(t.imageContainer=n.first))},inputs:{label:"label",imageUrl:"imageUrl",loopImage:"loopImage"},decls:8,vars:4,consts:[[1,"ticker-block-item"],["class","ticker-block-item__label html",3,"innerHTML",4,"ngIf"],[1,"ticker-block__image-container"],["imageContainer",""],["class","ticker-block-item__image ticker-block-item__image--pre",3,"src",4,"ngIf"],["class","ticker-block-item__image ticker-block-item__image--post",3,"src",4,"ngIf"],[1,"ticker-block-item__image",3,"src"],["image",""],[1,"ticker-block-item__label","html",3,"innerHTML"],[1,"ticker-block-item__image","ticker-block-item__image--pre",3,"src"],["imagePre",""],[1,"ticker-block-item__image","ticker-block-item__image--post",3,"src"],["imagePost",""]],template:function(e,t){1&e&&(P.Vb(0,"div",0),P.Kc(1,Jd,2,3,"span",1),P.Vb(2,"div",2,3),P.Kc(4,Xd,2,1,"img",4),P.Kc(5,Yd,2,1,"img",5),P.Qb(6,"img",6,7),P.Ub(),P.Ub()),2&e&&(P.Db(1),P.lc("ngIf",t.label),P.Db(3),P.lc("ngIf",t.loopImage),P.Db(1),P.lc("ngIf",t.loopImage),P.Db(1),P.lc("src",t.imageUrl,P.Cc))},directives:[ra.l],pipes:[Dd.b],styles:['.ticker-block-item[_ngcontent-%COMP%]{background:#f9fafd;background:linear-gradient(90deg,#f9fafd 20%,hsla(0,0%,100%,0) 40%,#fff 60%,#f9fafd 80%);overflow:hidden;padding-left:50%;position:relative}.ticker-block-item[_ngcontent-%COMP%]:hover   .ticker-block-item__label[_ngcontent-%COMP%]{background:hsla(0,0%,100%,.9)}.ticker-block-item[_ngcontent-%COMP%]:after{content:"";display:block;position:absolute;left:50%;top:0;height:100%;width:1px;background:red;box-shadow:0 0 0 4px rgba(255,0,0,.2);z-index:10}.ticker-block-item__label[_ngcontent-%COMP%]{position:absolute;z-index:10;left:4px;top:4px;border-radius:8px;padding:2px 6px;font-size:12px;border:1px solid rgba(16,24,35,.5);background:hsla(0,0%,100%,.55)}.ticker-block-item__image-container[_ngcontent-%COMP%]{position:relative}.ticker-block-item__image[_ngcontent-%COMP%]{display:block}.ticker-block-item__image--post[_ngcontent-%COMP%], .ticker-block-item__image--pre[_ngcontent-%COMP%]{position:absolute;top:0;left:0}'],changeDetection:0}),qd([Object(E.d)(Wr.getAnimationPlaying),Wd("design:type",be.a)],eg.prototype,"animationPlaying$",void 0),qd([Object(E.d)(Lr.getSelectedChapterId),Wd("design:type",be.a)],eg.prototype,"selectedChapterId$",void 0),eg);function ng(e,t){if(1&e&&P.Qb(0,"app-ticker-block-item",3),2&e){var n=t.$implicit,i=P.gc(2);P.lc("imageUrl",n.urls.default)("label",n.caption)("loopImage",i.tickerBlock.loopImage)}}function ig(e,t){if(1&e&&(P.Vb(0,"div",1),P.Kc(1,ng,1,3,"app-ticker-block-item",2),P.Ub()),2&e){var n=P.gc();P.Db(1),P.lc("ngForOf",n.tickerBlock.images)}}var og,rg,ag,sg=((ag=function(){function e(){m(this,e),this.ngUnsubscribe=new fe.a}return v(e,[{key:"ngOnInit",value:function(){}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}}]),e}()).\u0275fac=function(e){return new(e||ag)},ag.\u0275cmp=P.Jb({type:ag,selectors:[["app-ticker-block"]],inputs:{tickerBlock:"tickerBlock"},decls:1,vars:1,consts:[["class","ticker-block",4,"ngIf"],[1,"ticker-block"],[3,"imageUrl","label","loopImage",4,"ngFor","ngForOf"],[3,"imageUrl","label","loopImage"]],template:function(e,t){1&e&&P.Kc(0,ig,2,1,"div",0),2&e&&P.lc("ngIf",t.tickerBlock)},directives:[ra.l,ra.k,tg],styles:[""],changeDetection:0}),ag),cg=((rg=function(){function e(t,n){m(this,e),this.domSanitizer=t,this.markdownService=n}return v(e,[{key:"html",set:function(e){this.safeHTML=this.domSanitizer.bypassSecurityTrustHtml(e||"")}},{key:"markdownText",set:function(e){this.html=this.markdownService.compile(e,!0)}},{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||rg)(P.Pb(L.b),P.Pb(Dd.c))},rg.\u0275cmp=P.Jb({type:rg,selectors:[["app-html"]],inputs:{html:"html",markdownText:"markdownText"},decls:1,vars:1,consts:[[1,"html",3,"innerHTML"]],template:function(e,t){1&e&&P.Qb(0,"div",0),2&e&&P.lc("innerHTML",t.safeHTML,P.Ac)},styles:[""],encapsulation:2,changeDetection:0}),rg),lg=((og=function(){function e(){m(this,e),this.layout=Qd.Normal}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||og)},og.\u0275cmp=P.Jb({type:og,selectors:[["app-markdown-block"]],inputs:{markdownBlock:"markdownBlock",layout:"layout"},decls:2,vars:1,consts:[[1,"markdown-block"],[3,"markdownText"]],template:function(e,t){1&e&&(P.Vb(0,"div",0),P.Qb(1,"app-html",1),P.Ub()),2&e&&(P.Db(1),P.lc("markdownText",t.markdownBlock.markdown))},directives:[cg],styles:[""],encapsulation:2,changeDetection:0}),og),ug=h("0IaG");function pg(e,t){if(1&e&&P.Qb(0,"app-icon",5),2&e){var n=P.gc();P.lc("icon",n.icon)}}function dg(e,t){if(1&e&&P.Qb(0,"span",6),2&e){var n=P.gc();P.Hc("background-image","url("+n.src+")")}}function gg(e,t){if(1&e&&(P.Vb(0,"div",7),P.Mc(1),P.Ub()),2&e){var n=P.gc();P.Db(1),P.Oc(" ",n.label," ")}}var hg,fg=function(e,t,n,i,o,r,a,s,c,l,u,p,d){return{"pin-button--selected":e,"pin-button--disabled":t,"pin-button--small":n,"pin-button--medium":i,"pin-button--large":o,"pin-button--ghost":r,"pin-button--primary":a,"pin-button--secondary":s,"pin-button--outline":c,"pin-button--floating":l,"pin-button--dark":u,"pin-button--row":p,"pin-button--fill":d}},bg=["*"],vg=((hg=function(){function e(){m(this,e),this.selectable=!1,this.size="medium",this.buttonType="default",this.direction="column",this.fill=!1,this._selected=!1,this.disabled=!1,this.selectedChange=new P.p}return v(e,[{key:"selected",get:function(){return this._selected},set:function(e){this._selected=e,this.selectedChange=new P.p}},{key:"ngOnInit",value:function(){}},{key:"handleClick",value:function(){this.disabled||this.selectable&&(this.selected=!this.selected)}}]),e}()).\u0275fac=function(e){return new(e||hg)},hg.\u0275cmp=P.Jb({type:hg,selectors:[["app-pin-button"],["button","app-pin-button",""]],inputs:{icon:"icon",src:"src",description:"description",label:"label",selectable:"selectable",size:"size",buttonType:"buttonType",direction:"direction",fill:"fill",selected:"selected",disabled:"disabled"},outputs:{selectedChange:"selectedChange"},ngContentSelectors:bg,decls:6,vars:18,consts:[[1,"pin-button",3,"ngClass","click"],[1,"pin-button__pin"],["style","font-size: 14px !important",3,"icon",4,"ngIf"],["class","pin-button__image",3,"backgroundImage",4,"ngIf"],["class","pin-button__label",4,"ngIf"],[2,"font-size","14px !important",3,"icon"],[1,"pin-button__image"],[1,"pin-button__label"]],template:function(e,t){1&e&&(P.kc(),P.Vb(0,"div",0),P.cc("click",(function(){return t.handleClick()})),P.Vb(1,"div",1),P.Kc(2,pg,1,1,"app-icon",2),P.Kc(3,dg,1,2,"span",3),P.jc(4),P.Ub(),P.Kc(5,gg,2,1,"div",4),P.Ub()),2&e&&(P.lc("ngClass",P.tc(4,fg,[t.selected,t.disabled,"small"===t.size,"medium"===t.size,"large"===t.size,"ghost"===t.buttonType,"primary"===t.buttonType,"secondary"===t.buttonType,"outline"===t.buttonType,"floating"===t.buttonType,"dark"===t.buttonType,"row"===t.direction,t.fill])),P.Db(2),P.lc("ngIf",t.icon),P.Db(1),P.lc("ngIf",t.src),P.Db(2),P.lc("ngIf",t.label))},directives:[ra.i,ra.l,nl],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3838}.text-info{color:#0060c4}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}button[app-pin-button]{border-color:transparent;background:none;border-width:0;padding:0;outline:none;margin:0;pointer-events:all}button[app-pin-button]::-moz-focus-inner{border:0}button[app-pin-button]:not([disabled]):hover{cursor:pointer}button[app-pin-button]:focus :not(.pin-button--selected) .pin-button__pin{background:#f1f4fa;outline:none}button[app-pin-button]:focus :not(.pin-button--selected).pin-button--dark .pin-button__pin{background-color:#6a82a4!important}button[app-pin-button][disabled]{pointer-events:none}.pin-button{display:inline-flex;flex-flow:column;align-items:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-tap-highlight-color:rgba(0,0,0,0);-webkit-tap-highlight-color:transparent}.pin-button:hover{cursor:pointer}.pin-button:hover:not(.pin-button--selected):not(.pin-button--disabled) .pin-button__pin{background:rgba(215,224,234,.6);background:var(--pin-button-pin-background--hover)}.pin-button:not(.pin-button--selected):active:hover .pin-button__pin{background:#d7e0ea;background:var(--pin-button-pin-background--active)}.pin-button--selected .pin-button__pin{background-color:#2d72dc;background-color:var(--pin-button-pin-background--selected);color:#fff;color:var(--pin-button-pin-color--selected)}.pin-button--selected .pin-button__label{color:#2d72dc;color:var(--pin-button-label-color--selected);font-weight:600}.pin-button--small .pin-button__pin{border-radius:14px;min-width:28px;height:28px}.pin-button--small .pin-button__label{margin-top:0}.pin-button--large .pin-button__pin{font-size:20px;letter-spacing:.5px;line-height:1.4em}.pin-button--row{flex-direction:row}.pin-button--row .pin-button__label{margin:0 0 0 4px}.pin-button--ghost:not(.pin-button--selected) .pin-button__pin{background:transparent}.pin-button--outline:not(.pin-button--selected) .pin-button__pin{background:transparent;border:var(--pin-button-pin-border)}.pin-button--primary .pin-button__pin{background:var(--pin-button-pin-background--primary);color:var(--pin-button-pin-color--primary)}.pin-button--primary:not(.pin-button--selected):not(.pin-button--disabled) .pin-button__pin{background:#de3838;color:#fff;background:var(--pin-button-pin-background--primary)!important;color:var(--pin-button-pin-color--primary)!important}.pin-button--primary:not(.pin-button--selected):not(.pin-button--disabled):hover .pin-button__pin{background:#e24e4e;background:var(--pin-button-pin-background--primary-hover)!important}.pin-button--secondary .pin-button__pin{background:#0060c4;color:#fff;background:var(--pin-button-pin-background--secondary);color:var(--pin-button-pin-color--secondary)}.pin-button--secondary:not(.pin-button--selected):not(.pin-button--disabled) .pin-button__pin{background:#0060c4;color:#fff;background:var(--pin-button-pin-background--secondary)!important;color:var(--pin-button-pin-color--secondary)!important}.pin-button--secondary:not(.pin-button--selected):not(.pin-button--disabled):hover .pin-button__pin{background:#006cde;background:var(--pin-button-pin-background--secondary-hover)!important}.pin-button--disabled{opacity:.2}.pin-button--disabled:hover{cursor:auto}.pin-button--fill{width:100%;height:100%}.pin-button--fill .pin-button__pin{width:100%;height:100%;border-radius:50%}.pin-button--floating .pin-button__pin{background-color:#fff;background-color:var(--pin-button-pin-background--floating)}.pin-button--dark .pin-button__pin,.pin-button--floating .pin-button__pin{box-shadow:1px -1px 2px 0 rgba(28,42,63,.1),0 1px 2px 0 rgba(28,42,63,.3);box-shadow:var(--pin-button-shadow)}.pin-button--dark .pin-button__pin{color:#f9fafd;color:var(--pin-button-pin-color--dark);background-color:#1c2a3f!important;background-color:var(--pin-button-pin-background--dark)!important}.pin-button__pin{border-radius:20px;display:flex;font-size:12px;float:left;min-width:40px;height:40px;align-items:center;justify-content:center;position:relative;background-color:#eaeff5;color:#1c2a3f;background-color:var(--pin-button-pin-background);color:var(--pin-button-pin-color);transition:background-color 125ms}.pin-button__label{font-size:10px;letter-spacing:.25px;line-height:1.4em;color:#1c2a3f;color:var(--pin-button-label-color);padding:2px 0 4px}.pin-button__image{width:100%;height:100%;background-size:50%;background-repeat:no-repeat;background-position:50%}"],encapsulation:2,changeDetection:0}),hg),mg=h("Qu3c");function yg(e,t){if(1&e&&(P.Vb(0,"div",3),P.Mc(1),P.Ub()),2&e){var n=P.gc();P.Db(1),P.Oc(" ",n.label," ")}}var xg,kg=function(e,t,n){return[e,t,n]},wg=function(e){return e.Small="small",e.Medium="medium",e.Large="large",e.Huge="huge",e}({}),Og=function(e){return e.Horizontal="horizontal",e.Vertical="vertical",e}({}),Cg=function(e){return e.Inline="inline",e.Block="block",e.Fill="fill",e}({}),Sg=((xg=function(){function e(){m(this,e),this.size=wg.Medium,this.label="",this.direction=Og.Horizontal,this.render=Cg.Fill}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||xg)},xg.\u0275cmp=P.Jb({type:xg,selectors:[["app-spinner"]],inputs:{size:"size",label:"label",direction:"direction",render:"render"},decls:3,vars:6,consts:[[1,"spinner","spinner--horizontal",3,"ngClass"],[1,"spinner__circle"],["class","spinner__label",4,"ngIf"],[1,"spinner__label"]],template:function(e,t){1&e&&(P.Vb(0,"div",0),P.Qb(1,"div",1),P.Kc(2,yg,2,1,"div",2),P.Ub()),2&e&&(P.lc("ngClass",P.qc(2,kg,"spinner--"+t.size,"spinner--"+t.render,"spinner--"+t.direction)),P.Db(2),P.lc("ngIf",t.label.length))},directives:[ra.i,ra.l],styles:['@-webkit-keyframes spinner{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}@keyframes spinner{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}.spinner[_ngcontent-%COMP%]{display:inline-flex;justify-content:center;align-items:center}.spinner--small[_ngcontent-%COMP%]   .spinner__circle[_ngcontent-%COMP%], .spinner--small[_ngcontent-%COMP%]   .spinner__circle[_ngcontent-%COMP%]:after{width:11px;height:11px}.spinner--small[_ngcontent-%COMP%]   .spinner__label[_ngcontent-%COMP%]{font-size:10px}.spinner--medium[_ngcontent-%COMP%]   .spinner__circle[_ngcontent-%COMP%], .spinner--medium[_ngcontent-%COMP%]   .spinner__circle[_ngcontent-%COMP%]:after{width:14px;height:14px}.spinner--medium[_ngcontent-%COMP%]   .spinner__label[_ngcontent-%COMP%]{font-size:10px}.spinner--large[_ngcontent-%COMP%]   .spinner__circle[_ngcontent-%COMP%], .spinner--large[_ngcontent-%COMP%]   .spinner__circle[_ngcontent-%COMP%]:after{width:28px;height:28px}.spinner--large[_ngcontent-%COMP%]   .spinner__label[_ngcontent-%COMP%]{font-size:14px}.spinner--huge[_ngcontent-%COMP%]   .spinner__circle[_ngcontent-%COMP%], .spinner--huge[_ngcontent-%COMP%]   .spinner__circle[_ngcontent-%COMP%]:after{width:44px;height:44px}.spinner--huge[_ngcontent-%COMP%]   .spinner__label[_ngcontent-%COMP%]{font-size:16px}.spinner--horizontal[_ngcontent-%COMP%]{flex-direction:row}.spinner--vertical[_ngcontent-%COMP%]{align-items:center;flex-direction:column}.spinner--vertical[_ngcontent-%COMP%]   .spinner__label[_ngcontent-%COMP%]{padding:8px 0 0}.spinner--inline[_ngcontent-%COMP%]{display:inline-flex}.spinner--block[_ngcontent-%COMP%]{display:flex}.spinner--fill[_ngcontent-%COMP%]{display:flex;height:100%}.spinner__circle[_ngcontent-%COMP%]{width:14px;height:14px;border-radius:50%;border:2px solid rgba(16,24,35,.1);position:relative}.spinner__circle[_ngcontent-%COMP%]:after{-webkit-animation:spinner .4s linear infinite;animation:spinner .4s linear infinite;content:" ";border-radius:50%;border-color:hsla(0,0%,100%,.2) rgba(16,24,35,.2) transparent transparent;border-style:solid;border-width:2px;box-sizing:border-box;position:absolute;display:block;width:14px;height:14px;top:-2px;left:-2px}.spinner__label[_ngcontent-%COMP%]{padding-left:8px;font-size:14px;text-transform:uppercase}.theme-dark[_nghost-%COMP%]   .spinner__label[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .spinner__label[_ngcontent-%COMP%]{color:hsla(0,0%,100%,.2)}.theme-light[_nghost-%COMP%]   .spinner__label[_ngcontent-%COMP%], .theme-light   [_nghost-%COMP%]   .spinner__label[_ngcontent-%COMP%]{color:rgba(16,24,35,.2)}'],changeDetection:0}),xg);function _g(e,t){1&e&&(P.Vb(0,"div",4),P.Qb(1,"app-spinner",5),P.Ub())}var jg,Pg,Mg=((jg=function(){function e(t,n,i){m(this,e),this.dialogRef=t,this.data=n,this.changeRef=i,this.config=n}return v(e,[{key:"ngOnInit",value:function(){}},{key:"handleCloseClick",value:function(){this.dialogRef.close()}},{key:"handleImageLoaded",value:function(){this.imageLoaded=!0,this.changeRef.markForCheck()}}]),e}()).\u0275fac=function(e){return new(e||jg)(P.Pb(ug.g),P.Pb(ug.a),P.Pb(P.i))},jg.\u0275cmp=P.Jb({type:jg,selectors:[["app-image-dialog"]],decls:4,vars:4,consts:[[1,"dialog",3,"click"],["class","dialog__loading flex flex-column p-8",4,"ngIf"],[1,"dialog__image",3,"src","title","alt","load"],["app-pin-button","","buttonType","dark","size","large","icon","times","aria-label","Close","matTooltip","Close","matTooltipPosition","left",1,"dialog__close"],[1,"dialog__loading","flex","flex-column","p-8"],["size","huge"]],template:function(e,t){1&e&&(P.Vb(0,"div",0),P.cc("click",(function(){return t.handleCloseClick()})),P.Kc(1,_g,2,0,"div",1),P.Vb(2,"img",2),P.cc("load",(function(){return t.handleImageLoaded()})),P.Ub(),P.Qb(3,"button",3),P.Ub()),2&e&&(P.Db(1),P.lc("ngIf",!t.imageLoaded),P.Db(1),P.lc("src",t.config.src,P.Cc)("title",t.config.title||"")("alt",t.config.alt||""))},directives:[ra.l,vg,mg.c,Sg],styles:[".dialog[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;width:100%}.dialog__loading[_ngcontent-%COMP%]{position:absolute}.dialog__image[_ngcontent-%COMP%]{max-width:100%;max-height:100vh}.dialog__close[_ngcontent-%COMP%]{position:fixed;top:24px;right:24px}"],changeDetection:0}),jg),Ig=function(e){return e.ClipboardDialog="ClipboardDialog",e.WelcomeTourDialog="WelcomeTourDialog",e.JoinDomainDialog="JoinDomainDialog",e.NpsSurveyDialog="NpsSurveyDialog",e.ConfirmDialog="ConfirmDialog",e.LimitDialog="LimitDialog",e.UpgradeDialog="UpgradeDialog",e.BuyDialog="BuyDialog",e.ProfileDialog="ProfileDialog",e.SaveModuleDialog="SaveModuleDialog",e.SaveBookmarkDialog="SaveBookmarkDialog",e.SaveAsBookmarkDialog="SaveAsBookmarkDialog",e.ManageDialog="ManageDialog",e.BookmarkAccessDialog="BookmarkAccessDialog",e.GroupRestrictionDialog="GroupRestrictionDialog",e.PremiumContentDialog="PremiumContentDialog",e.AboutDialog="AboutDialog",e.ImportDialog="ImportDialog",e.AddTeamModelDialog="AddTeamModelDialog",e.ImageDialog="ImageDialog",e.QuizSettingsDialog="QuizSettingsDialog",e.AssignUserRoleDialog="AssignUserRoleDialog",e.TransferUserContentDialog="TransferUserContentDialog",e.RemoveUserDialog="RemoveUserDialog",e}({}),zg=["imageView"],Tg=((Pg=function(){function e(t){m(this,e),this.dialog=t,this.fit="normal",this.fullscreenEnabled=!1}return v(e,[{key:"ngOnInit",value:function(){}},{key:"handleFullscreen",value:function(e){this.dialog.open(Mg,{id:Ig.ImageDialog,backdropClass:"bd-dialog-backdrop",panelClass:"bd-dialog-panel",disableClose:!1,data:{src:this.fullscreenSrc||this.src,alt:this.alt||""}}),e.stopPropagation()}}]),e}()).\u0275fac=function(e){return new(e||Pg)(P.Pb(ug.b))},Pg.\u0275cmp=P.Jb({type:Pg,selectors:[["app-image-view"]],viewQuery:function(e,t){var n;1&e&&P.Gc(zg,!0),2&e&&P.uc(n=P.dc())&&(t.imageView=n.first)},inputs:{fit:"fit",fitSize:"fitSize",src:"src",fullscreenSrc:"fullscreenSrc",alt:"alt"},decls:5,vars:8,consts:[[1,"image-view"],["imageView",""],[1,"image-view__image",3,"src","alt"],["role","button","matTooltip","Expand",1,"image-view__overlay",3,"click"],["icon","expand-alt",1,"image-view__icon"]],template:function(e,t){1&e&&(P.Vb(0,"div",0,1),P.Qb(2,"img",2),P.Vb(3,"div",3),P.cc("click",(function(e){return t.handleFullscreen(e)})),P.Qb(4,"app-icon",4),P.Ub(),P.Ub()),2&e&&(P.Hb("image-view--auto-fit","auto"===t.fit),P.Db(2),P.Hc("max-width","auto"===t.fit&&t.fitSize?t.fitSize+"px":"100%")("max-height","auto"===t.fit&&t.fitSize?t.fitSize+"px":"100%"),P.lc("src",t.src,P.Cc)("alt",t.alt))},directives:[mg.c,nl],styles:[".image-view[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:inherit;position:relative;background-color:#f9fafd}.image-view__image[_ngcontent-%COMP%]{width:auto;height:auto}.image-view--auto-fit[_ngcontent-%COMP%]   .image-view__image[_ngcontent-%COMP%]{max-width:100%;height:auto}.image-view__overlay[_ngcontent-%COMP%]{background:rgba(28,42,63,.3);color:#fff;display:flex;flex-direction:row;align-items:center;justify-content:center;padding:8px;position:absolute;top:0;bottom:0;left:0;right:0;opacity:0;transition:opacity .25s}.image-view__icon[_ngcontent-%COMP%]{text-shadow:0 0 2px rgba(0,0,0,.6)}.image-view[_ngcontent-%COMP%]:hover{cursor:pointer}.image-view[_ngcontent-%COMP%]:hover   .image-view__overlay[_ngcontent-%COMP%]{opacity:1}"],changeDetection:0}),Pg);function Ug(e,t){if(1&e&&(P.Vb(0,"div",6),P.Qb(1,"app-image-view",7),P.Ub()),2&e){var n=P.gc(2);P.Db(1),P.lc("src",n.currentImage.urls.small)("fullscreenSrc",n.currentImage.urls.default)("alt",n.currentImage.alt)("fit",n.fit)("fitSize",n.fitSize)}}function Lg(e,t){if(1&e&&P.Qb(0,"app-html",8),2&e){var n=P.gc(2);P.lc("markdownText",n.currentImage.caption)}}function Dg(e,t){if(1&e){var n=P.Wb();P.Vb(0,"div",9),P.Vb(1,"button",10),P.cc("click",(function(){return P.zc(n),P.gc(2).handlePrevClick()})),P.Ub(),P.Vb(2,"button",11),P.cc("click",(function(){return P.zc(n),P.gc(2).handleNextClick()})),P.Ub(),P.Ub()}}function Eg(e,t){if(1&e&&(P.Vb(0,"div",1),P.Vb(1,"div",2),P.Kc(2,Ug,2,5,"div",3),P.Kc(3,Lg,1,1,"app-html",4),P.Kc(4,Dg,3,0,"div",5),P.Ub(),P.Ub()),2&e){var n=P.gc();P.Hb("images-block--slideshow",n.images&&n.images.length>1),P.Db(2),P.lc("ngIf",n.currentImage.urls),P.Db(1),P.lc("ngIf",n.currentImage.caption),P.Db(1),P.lc("ngIf",n.images.length>1)}}var Fg,Ag=((Fg=function(){function e(){m(this,e),this.layout=Qd.Normal}return v(e,[{key:"imagesBlock",get:function(){return this._imagesBlock},set:function(e){this._imagesBlock=e;var t=Object(Se.get)(e,"images",[]);t.length&&(this.images=t,this.currentImage=this.images[0])}},{key:"fit",get:function(){return"compact"===this.layout?"auto":"normal"}},{key:"fitSize",get:function(){return"compact"===this.layout?100:void 0}},{key:"ngOnInit",value:function(){}},{key:"handlePrevClick",value:function(){var e=this.getCurrentImageIndex();--e<0&&(e=this.images.length-1),this.currentImage=this.images[e]}},{key:"handleNextClick",value:function(){var e=this.getCurrentImageIndex();++e>=this.images.length&&(e=0),this.currentImage=this.images[e]}},{key:"getCurrentImageIndex",value:function(){return this.images.indexOf(this.currentImage)}}]),e}()).\u0275fac=function(e){return new(e||Fg)},Fg.\u0275cmp=P.Jb({type:Fg,selectors:[["app-images-block"]],inputs:{imagesBlock:"imagesBlock",layout:"layout"},decls:1,vars:1,consts:[["class","images-block",3,"images-block--slideshow",4,"ngIf"],[1,"images-block"],[1,"images-block__content"],["class","images-block__image-container",4,"ngIf"],["class","images-block__caption",3,"markdownText",4,"ngIf"],["class","images-block__actions",4,"ngIf"],[1,"images-block__image-container"],[1,"images-block__image-view",3,"src","fullscreenSrc","alt","fit","fitSize"],[1,"images-block__caption",3,"markdownText"],[1,"images-block__actions"],["gaEvent","","gaAction","Clicked Previous Image","app-pin-button","","icon","chevron-left","size","small","buttonType","ghost","matTooltip","Previous Image",3,"click"],["gaEvent","","gaAction","Clicked Next Image","app-pin-button","","icon","chevron-right","size","small","buttonType","ghost","matTooltip","Next Image",3,"click"]],template:function(e,t){1&e&&P.Kc(0,Eg,5,5,"div",0),2&e&&P.lc("ngIf",t.currentImage)},directives:[ra.l,Tg,cg,vg,mg.c],styles:[".images-block__header{display:flex;align-items:center;justify-content:space-between;margin-bottom:16px}.images-block__label{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase;color:var(--view-panel-color);font-weight:600;display:flex;align-items:center;min-height:28px}.images-block__image-container{display:flex;justify-content:center;background-color:#f9fafd;margin-bottom:12px}.images-block__image-view{display:flex;height:100%}.images-block__caption{font-size:12px}.images-block__actions{display:flex;justify-content:flex-end;margin-top:14px}.images-block--slideshow .images-block__image-container{height:200px}"],encapsulation:2,changeDetection:0}),Fg);function Rg(e,t){if(1&e&&P.Qb(0,"app-ticker-block",6),2&e){var n=P.gc().$implicit;P.lc("tickerBlock",n)}}function Vg(e,t){if(1&e&&P.Qb(0,"app-markdown-block",7),2&e){var n=P.gc().$implicit,i=P.gc(2);P.lc("markdownBlock",n)("layout",i.layout)}}function Ng(e,t){if(1&e&&P.Qb(0,"app-images-block",8),2&e){var n=P.gc().$implicit,i=P.gc(2);P.lc("imagesBlock",n)("layout",i.layout)}}function Bg(e,t){if(1&e&&(P.Vb(0,"div"),P.Tb(1,2),P.Kc(2,Rg,1,1,"app-ticker-block",3),P.Kc(3,Vg,1,2,"app-markdown-block",4),P.Kc(4,Ng,1,2,"app-images-block",5),P.Sb(),P.Ub()),2&e){var n=t.$implicit;P.Hb("mv-2",t.index>0),P.Db(1),P.lc("ngSwitch",n.type),P.Db(1),P.lc("ngSwitchCase","ticker"),P.Db(1),P.lc("ngSwitchCase","markdown"),P.Db(1),P.lc("ngSwitchCase","images")}}function Hg(e,t){if(1&e&&(P.Tb(0),P.Kc(1,Bg,5,6,"div",1),P.Sb()),2&e){var n=P.gc();P.Db(1),P.lc("ngForOf",n.contentBlocks)}}var Qg,qg=((Qg=function(){function e(){m(this,e),this._contentBlocks=[],this.layout=Qd.Normal,this.include=[],this.exclude=[]}return v(e,[{key:"contentBlocks",get:function(){var e=this;return this._contentBlocks.filter((function(t){return!e.include.length||e.include.includes(t.type)})).filter((function(t){return!e.exclude.length||!e.exclude.includes(t.type)}))},set:function(e){this._contentBlocks=e}},{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||Qg)},Qg.\u0275cmp=P.Jb({type:Qg,selectors:[["app-content-blocks"]],inputs:{contentBlocks:"contentBlocks",layout:"layout",include:"include",exclude:"exclude"},decls:1,vars:1,consts:[[4,"ngIf"],[3,"mv-2",4,"ngFor","ngForOf"],[3,"ngSwitch"],[3,"tickerBlock",4,"ngSwitchCase"],[3,"markdownBlock","layout",4,"ngSwitchCase"],[3,"imagesBlock","layout",4,"ngSwitchCase"],[3,"tickerBlock"],[3,"markdownBlock","layout"],[3,"imagesBlock","layout"]],template:function(e,t){1&e&&P.Kc(0,Hg,2,1,"ng-container",0),2&e&&P.lc("ngIf",t.contentBlocks.length>0)},directives:[ra.l,ra.k,ra.n,ra.o,sg,lg,Ag],styles:[""],encapsulation:2,changeDetection:0}),Qg),Wg=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},$g=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Kg(e,t){if(1&e&&(P.Vb(0,"div",6),P.Qb(1,"app-content-blocks",7),P.Ub()),2&e){var n=P.gc();P.Db(1),P.lc("contentBlocks",n.label.contentBlocks)("layout","compact")}}function Gg(e,t){if(1&e&&(P.Qb(0,"div",8),P.hc(1,"markdown")),2&e){var n=P.gc();P.lc("innerHTML",P.ic(1,1,n.label.description),P.Ac)}}var Zg,Jg,Xg,Yg=((Zg=function(){function e(t,n,i,o){m(this,e),this.store=t,this.labelsService=n,this.engineService=i,this.changeDetectorRef=o,this.emitEvents=!0,this.collapsedMode=Fo.None,this.collapsed=!1,this.pinDraggable=!1,this.tagDraggable=!1,this.descriptionCollapsed=!1,this.tagCollapsed=!1,this.ngUnsubscribe=new fe.a}return v(e,[{key:"isCollapsed",get:function(){if(this.collapsedMode===Fo.Toggle){var e=this.store.selectSnapshot(Is.getSelectedLabelId)===this.label.id;return this.collapsed&&!e}return this.collapsed}},{key:"hasContent",get:function(){return this.labelsService.hasContent(this.label)}},{key:"ngOnInit",value:function(){var e=this;this.selectedLabel$.pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){return e.handleLabelSelected(t)})),this.store.select(Is.getChapterLabels).pipe(Object(ve.a)(this.ngUnsubscribe),Object(Jr.a)(100)).subscribe((function(){e.sequence=e.store.selectSnapshot(Is.getLabelSequence(e.label)),e.changeDetectorRef.markForCheck()})),this.descriptionCollapsed=this.label.collapseDescription,this.tagCollapsed=this.label.hideTag}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"handleLabelUpdated",value:function(e){var t=e.label,n=e.shouldPreserve;this.store.dispatch(new $o(t,n))}},{key:"handleOffsetUpdated",value:function(e){var t=e.labelId,n=e.offset;this.store.dispatch(new Ro(t,n))}},{key:"handlePinClicked",value:function(e){this.selectLabel()}},{key:"handleTagClicked",value:function(e){this.selectLabel()}},{key:"selectLabel",value:function(){var e=this.store.selectSnapshot(Is.getSelectedLabel);this.store.dispatch(new Zo(e&&e.id===this.label.id?null:this.label)),this.emitEngineEvent(Dt.HotspotsPicked,{id:this.label.id}),this.emitEngineEvent(Dt.LabelsPicked,{labelId:this.label.id})}},{key:"emitEngineEvent",value:function(e,t){this.emitEvents&&this.engineService.fireEvent(e,t)}},{key:"handleDisplayUpdated",value:function(e){this.emitEngineEvent(Dt.HotspotsDisplayUpdated,e)}},{key:"handlePositionUpdated",value:function(e){this.emitEngineEvent(Dt.HotspotsPositionUpdated,e.positionUpdate),this.emitEngineEvent(Dt.LabelsMoved,{labelId:e.positionUpdate.id,canvasPosition:[e.positionUpdate.canvasPos.x,e.positionUpdate.canvasPos.y],occluded:e.positionUpdate.occluded||!e.onCanvas})}},{key:"handleHoverStart",value:function(e){this.emitEngineEvent(Dt.HotspotsEntered,{id:e.labelId}),this.emitEngineEvent(Dt.LabelsEntered,{labelId:e.labelId})}},{key:"handleHoverEnd",value:function(e){this.emitEngineEvent(Dt.HotspotsLeft,{id:e.labelId}),this.emitEngineEvent(Dt.LabelsLeft,{labelId:e.labelId})}},{key:"handleLabelSelected",value:function(e){var t=this,n=e&&e.id===this.label.id,i=Object(Se.get)(e,"states[1].errands"),o=this.store.selectSnapshot(Ar.getLockCamera);n&&i&&!o&&i.forEach((function(e){switch(e.type){case bi.flyToObject:t.store.dispatch(new Qe(e.value));break;case bi.flyToCamera:t.store.dispatch(new $t(e.value))}t.store.dispatch(new sn(!0))})),this.tagCollapsed=!(this.label.title||this.hasContent)||(this.label.expandTag&&this.label.hideTag?!n:this.label.hideTag),this.descriptionCollapsed=this.label.showDescription&&this.label.collapseDescription?!n:this.label.collapseDescription}}]),e}()).\u0275fac=function(e){return new(e||Zg)(P.Pb(E.g),P.Pb(wi),P.Pb(Nt),P.Pb(P.i))},Zg.\u0275cmp=P.Jb({type:Zg,selectors:[["app-story-label"]],inputs:{label:"label",emitEvents:"emitEvents",collapsedMode:"collapsedMode",collapsed:"collapsed",pinDraggable:"pinDraggable",tagDraggable:"tagDraggable"},decls:9,vars:18,consts:[[3,"label","selected","fixedScale","sequence","isCollapsed","tagCollapsed","pinDraggable","tagDraggable","descriptionCollapsed","hasContent","labelUpdated","offsetUpdated","tagClicked","pinClicked","displayUpdated","positionUpdated","hoverStart","hoverEnd"],["label-header","",1,"html",3,"innerHTML"],["title",""],["label-body","",1,"html"],["class","mv-1","appEventFence","",4,"ngIf"],["data-test","labelDescription",3,"innerHTML",4,"ngIf"],["appEventFence","",1,"mv-1"],[3,"contentBlocks","layout"],["data-test","labelDescription",3,"innerHTML"]],template:function(e,t){var n;(1&e&&(P.Vb(0,"app-generic-label",0),P.cc("labelUpdated",(function(e){return t.handleLabelUpdated(e)}))("offsetUpdated",(function(e){return t.handleOffsetUpdated(e)}))("tagClicked",(function(e){return t.handleTagClicked(e)}))("pinClicked",(function(e){return t.handlePinClicked(e)}))("displayUpdated",(function(e){return t.handleDisplayUpdated(e)}))("positionUpdated",(function(e){return t.handlePositionUpdated(e)}))("hoverStart",(function(e){return t.handleHoverStart(e)}))("hoverEnd",(function(e){return t.handleHoverEnd(e)})),P.hc(1,"async"),P.hc(2,"async"),P.Qb(3,"div",1,2),P.hc(5,"markdown"),P.Vb(6,"div",3),P.Kc(7,Kg,2,2,"div",4),P.Kc(8,Gg,2,3,"div",5),P.Ub(),P.Ub()),2&e)&&(P.lc("label",t.label)("selected",(null==(n=P.ic(1,12,t.selectedLabel$))?null:n.id)===t.label.id)("fixedScale",P.ic(2,14,t.labelScale$))("sequence",t.sequence)("isCollapsed",t.isCollapsed)("tagCollapsed",t.tagCollapsed)("pinDraggable",t.pinDraggable)("descriptionCollapsed",t.descriptionCollapsed)("hasContent",t.hasContent),P.Db(3),P.lc("innerHTML",P.ic(5,16,t.label.title),P.Ac),P.Db(4),P.lc("ngIf",t.label.contentBlocks),P.Db(1),P.lc("ngIf",t.label.description))},directives:[Ld,ra.l,tl,qg],pipes:[ra.b,Dd.b],styles:[""],changeDetection:0}),Wg([Object(E.d)(Is.getLabelScale),$g("design:type",be.a)],Zg.prototype,"labelScale$",void 0),Wg([Object(E.d)(Is.getSelectedLabel),$g("design:type",be.a)],Zg.prototype,"selectedLabel$",void 0),Zg),eh=h("3Pt+"),th=((Xg=function(){function e(t){m(this,e),this.controlContainer=t}return v(e,[{key:"control",get:function(){return this.formControl||this.controlContainer.control.get(this.formControlName)}},{key:"registerOnTouched",value:function(e){this.formControlDirective.valueAccessor.registerOnTouched(e)}},{key:"registerOnChange",value:function(e){this.formControlDirective.valueAccessor.registerOnChange(e)}},{key:"writeValue",value:function(e){this.formControlDirective.valueAccessor.writeValue(e)}},{key:"setDisabledState",value:function(e){this.formControlDirective.valueAccessor.setDisabledState(e)}}]),e}()).\u0275fac=function(e){return new(e||Xg)(P.Pb(eh.b))},Xg.\u0275cmp=P.Jb({type:Xg,selectors:[["app-base-accessor-control"]],viewQuery:function(e,t){var n;1&e&&P.Gc(eh.f,!0),2&e&&P.uc(n=P.dc())&&(t.formControlDirective=n.first)},inputs:{formControl:"formControl",formControlName:"formControlName"},decls:0,vars:0,template:function(e,t){},encapsulation:2}),Xg),nh=((Jg=function(){function e(){m(this,e)}return v(e,[{key:"value",get:function(){return this._value},set:function(e){Object(Se.isEqual)(this._value,e)||(this._value=e,this.setFormValues(e),this.onChange(e))}},{key:"onChange",value:function(e){}},{key:"onTouched",value:function(){}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"registerOnChange",value:function(e){this.onChange=e}},{key:"writeValue",value:function(e){this.value=e}},{key:"setDisabledState",value:function(e){this.disabled=e}}]),e}()).\u0275fac=function(e){return new(e||Jg)},Jg.\u0275cmp=P.Jb({type:Jg,selectors:[["app-abstract-input-control"]],inputs:{value:"value",disabled:"disabled"},decls:0,vars:0,template:function(e,t){},encapsulation:2}),Jg);function ih(e,t){if(1&e&&(P.Vb(0,"option",9),P.Mc(1),P.Ub()),2&e){var n=t.$implicit;P.lc("value",n.value),P.Db(1),P.Oc(" ",n.label.title," ")}}function oh(e,t){if(1&e&&(P.Vb(0,"select",6),P.Vb(1,"option",7),P.Mc(2,"Select"),P.Ub(),P.Kc(3,ih,2,2,"option",8),P.Ub()),2&e){var n=P.gc();P.Db(3),P.lc("ngForOf",n.options)}}var rh,ah=((rh=function(n){t(r,n);var o=i(r);function r(e,t){var n;return m(this,r),(n=o.call(this)).formBuilder=e,n.changeRef=t,n.outline=!0,n.valueChange=new P.p,n.ngUnsubscribe=new fe.a,n.form=n.formBuilder.group({value:[""]}),n.valueControl=n.form.get("value"),n}return v(r,[{key:"options",get:function(){return this._options},set:function(e){var t=Object(Se.clone)(e);this._options=t.sort((function(e,t){return e.label.title.localeCompare(t.label.title)})),this.changeRef.markForCheck()}},{key:"ngOnInit",value:function(){this.initFormListeners()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initFormListeners",value:function(){var e=this;this.form.valueChanges.pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){var n=t.value;e.writeValue(n),e.valueChange.next(n)}))}},{key:"setDisabledState",value:function(t){e(a(r.prototype),"setDisabledState",this).call(this,t),t?this.form.disable():this.form.enable(),this.changeRef.markForCheck()}},{key:"setFormValues",value:function(e){this.valueControl.setValue(e),this.changeRef.markForCheck()}},{key:"getSelectedOption",value:function(){var e=this.valueControl.value;return this.options.find((function(t){return t.value===e}))}}]),r}(nh)).\u0275fac=function(e){return new(e||rh)(P.Pb(eh.d),P.Pb(P.i))},rh.\u0275cmp=P.Jb({type:rh,selectors:[["app-quiz-label-anatomy-select"]],inputs:{options:"options",outline:"outline"},outputs:{valueChange:"valueChange"},features:[P.Cb([{provide:eh.k,useExisting:Object(P.W)((function(){return rh})),multi:!0}]),P.Ab],decls:7,vars:5,consts:[[1,"label",3,"formGroup"],[1,"label__select-label","flex","text-12"],[1,"flex","justify-between","p-2",2,"flex","1"],[1,"mr-2"],["icon","caret-down","size","lg"],["class","input label__select","placeholder","Select Option","formControlName","value","data-test","quizLabelSelect",4,"ngIf"],["placeholder","Select Option","formControlName","value","data-test","quizLabelSelect",1,"input","label__select"],["value","","data-test","questionAnswerOption"],["class","label__option","data-test","questionAnswerOption",3,"value",4,"ngFor","ngForOf"],["data-test","questionAnswerOption",1,"label__option",3,"value"]],template:function(e,t){var n;(1&e&&(P.Vb(0,"div",0),P.Vb(1,"label",1),P.Vb(2,"div",2),P.Vb(3,"div",3),P.Mc(4),P.Ub(),P.Qb(5,"app-icon",4),P.Ub(),P.Kc(6,oh,4,1,"select",5),P.Ub(),P.Ub()),2&e)&&(P.Hb("label--empty",""===t.valueControl.value),P.lc("formGroup",t.form),P.Db(4),P.Nc((null==(n=t.getSelectedOption())||null==n.label?null:n.label.title)||"Select"),P.Db(2),P.lc("ngIf",!t.disabled))},directives:[eh.n,eh.h,nl,ra.l,eh.r,eh.m,eh.g,eh.p,eh.s,ra.k],styles:[".label[_ngcontent-%COMP%]{overflow:hidden}.label__select-label[_ngcontent-%COMP%]{color:#101823;position:relative}.label__select[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;opacity:.01}.label--empty[_ngcontent-%COMP%]   .label__select-label[_ngcontent-%COMP%]{color:#96a8c0}"],changeDetection:0}),rh);function sh(e,t){1&e&&P.Qb(0,"app-icon",8)}function ch(e,t){1&e&&P.Qb(0,"app-icon",9)}function lh(e,t){if(1&e&&(P.Vb(0,"div",4),P.Kc(1,sh,1,0,"app-icon",5),P.Kc(2,ch,1,0,"app-icon",6),P.Vb(3,"div",7),P.Mc(4),P.Ub(),P.Ub()),2&e){var n,i=P.gc();P.lc("ngSwitch",i.correct),P.Db(1),P.lc("ngSwitchCase",!0),P.Db(1),P.lc("ngSwitchCase",!1),P.Db(2),P.Oc(" ",null==(n=i.getSelectedLabel(i.options,i.control.value))?null:n.title," ")}}var uh,ph=((uh=function(e){t(o,e);var n=i(o);function o(){var e;return m(this,o),(e=n.apply(this,arguments)).sequence=0,e.labelUpdated=new P.p,e}return v(o,[{key:"ngOnInit",value:function(){}},{key:"handleLabelUpdated",value:function(e){this.labelUpdated.next(e.label)}},{key:"handleOffsetUpdated",value:function(e){this.labelUpdated.next(Object.assign(Object.assign({},this.option.label),{offset:e.offset}))}},{key:"getSelectedLabel",value:function(e,t){var n=this.options.find((function(e){return e.value===t}));return n?n.label:void 0}}]),o}(th)).\u0275fac=function(e){return dh(e||uh)},uh.\u0275cmp=P.Jb({type:uh,selectors:[["app-quiz-label"]],inputs:{sequence:"sequence",collapsed:"collapsed",options:"options",option:"option",correct:"correct",mode:"mode"},outputs:{labelUpdated:"labelUpdated"},features:[P.Cb([{provide:eh.k,useExisting:Object(P.W)((function(){return uh})),multi:!0}]),P.Ab],decls:4,vars:14,consts:[[1,"label","theme-light",3,"label","fit","opaque","pinDraggable","tagDraggable","isCollapsed","descriptionCollapsed","hasContent","sequence","labelUpdated","offsetUpdated"],["label-body","",1,"label__body"],[3,"outline","hidden","options","formControl"],["class","label__summary flex items-start",3,"ngSwitch",4,"ngIf"],[1,"label__summary","flex","items-start",3,"ngSwitch"],["class","label__icon label__icon--correct","style","font-size: 16px","icon","check-circle",4,"ngSwitchCase"],["class","label__icon label__icon--incorrect","style","font-size: 16px","icon","times-circle",4,"ngSwitchCase"],[1,"pl-2","text-12","text-semibold"],["icon","check-circle",1,"label__icon","label__icon--correct",2,"font-size","16px"],["icon","times-circle",1,"label__icon","label__icon--incorrect",2,"font-size","16px"]],template:function(e,t){1&e&&(P.Vb(0,"app-generic-label",0),P.cc("labelUpdated",(function(e){return t.handleLabelUpdated(e)}))("offsetUpdated",(function(e){return t.handleOffsetUpdated(e)})),P.Vb(1,"div",1),P.Qb(2,"app-quiz-label-anatomy-select",2),P.Kc(3,lh,5,4,"div",3),P.Ub(),P.Ub()),2&e&&(P.lc("label",t.option.label)("fit","summary"===t.mode?"fixed":"auto")("opaque",!0)("pinDraggable","edit"===t.mode)("tagDraggable","edit"===t.mode)("isCollapsed",t.collapsed)("descriptionCollapsed",!1)("hasContent",!0)("sequence",t.sequence),P.Db(2),P.lc("outline",!1)("hidden","summary"===t.mode)("options",t.options)("formControl",t.control),P.Db(1),P.lc("ngIf","summary"===t.mode))},directives:[Ld,ah,eh.m,eh.f,ra.l,ra.n,ra.o,nl],styles:[".label__body[_ngcontent-%COMP%]{color:#101823;min-width:160px;max-width:200px}.label__icon[_ngcontent-%COMP%]{position:relative;flex:0 0 20px;justify-content:center}.label__icon--correct[_ngcontent-%COMP%]{color:#73b676}.label__icon--incorrect[_ngcontent-%COMP%]{color:#cb4039}"],changeDetection:0}),uh),dh=P.Xb(ph),gh=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},hh=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function fh(e,t){if(1&e){var n=P.Wb();P.Tb(0),P.Vb(1,"app-quiz-label",3),P.cc("labelUpdated",(function(e){P.zc(n);var i=t.index;return P.gc().handleLabelUpdated(e,i)})),P.hc(2,"async"),P.hc(3,"async"),P.hc(4,"async"),P.hc(5,"async"),P.hc(6,"async"),P.Ub(),P.Sb()}if(2&e){var i=t.$implicit,o=t.index,r=P.gc();P.Db(1),P.lc("mode",r.mode)("formControl",i)("option",P.ic(2,7,r.quizLabels$)[o])("options",P.ic(3,9,r.quizLabels$))("sequence",o+1)("correct",r.isCorrect(P.ic(4,11,r.quizLabels$)[o],P.ic(5,13,r.activeSubmitted$),o))("collapsed",P.ic(6,15,r.labelsCollapsed$))}}var bh,vh=((bh=function(){function e(t,n,i,o){m(this,e),this.store=t,this.formBuilder=n,this.changeRef=i,this.router=o,this.ngUnsubscribe=new fe.a,this.mode="edit",this.form=this.formBuilder.group({options:this.formBuilder.array([])}),this.optionsArray=this.form.get("options")}return v(e,[{key:"ngOnInit",value:function(){this.initFormListeners(),this.initQuizSubmissionListeners()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initFormListeners",value:function(){var e=this;this.quizLabels$.pipe(Object(Xr.a)((function(e,t){var n=e.map((function(e){return e.value})),i=t.map((function(e){return e.value}));return Object(Se.isEqual)(n,i)})),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){var n=e.store.selectSnapshot(_o.getQuizModeActive);e.buildFormOptions(t,n),e.changeRef.markForCheck()})),Object(Gr.b)([this.quizModeActive$,this.quizLabels$]).pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){var n=p(t,1)[0];e.setFormEnabled(n),e.changeRef.markForCheck()}))}},{key:"initQuizSubmissionListeners",value:function(){var e=this;this.activeSubmission$.pipe(Object(me.a)((function(e){return!Object(Se.isNil)(e)&&!Object(Se.isNil)(e.answer)&&Array.isArray(e.answer)})),Object(Xr.a)((function(e,t){return Object(Se.isEqual)(e,t)})),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){var n=e.form.value.options,i=t.answer;Object(Se.isEqual)(n,i)||(e.form.patchValue({options:i},{emitEvent:!1,onlySelf:!0}),e.changeRef.markForCheck())})),this.form.valueChanges.pipe(Object(Xr.a)((function(e,t){return Object(Se.isEqual)(e,t)})),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){var n=e.store.selectSnapshot(_o.getActiveQuestionId),i=e.store.selectSnapshot(_o.getActiveSubmitted),o=e.store.selectSnapshot(_o.getActiveSubmission),r=Object(Se.isNil)(o)?[]:o.answer,a=t.options;Object(Se.isNil)(i)&&(Object(Se.isEqual)(a,r)||e.store.dispatch(new io.SetActiveSubmission({questionId:n,answer:a})),e.changeRef.markForCheck())})),Object(Gr.b)([this.quizModeActive$,this.activeSubmitted$]).subscribe((function(t){var n=p(t,2),i=n[0],o=n[1],r=e.router.url.includes("/edit");e.mode=r?"edit":i&&!Object(Se.isNil)(o)?"summary":"view",e.changeRef.markForCheck()}))}},{key:"isCorrect",value:function(e,t,n){if(!Object(Se.isNil)(t))return t.answer[n]===e.value}},{key:"handleLabelUpdated",value:function(e,t){var n=this.store.selectSnapshot(_o.getActiveQuestion);n.data.options[t].label=e,this.store.dispatch(new io.SetQuestion(n))}},{key:"buildFormOptions",value:function(e,t){var n=this;this.optionsArray.clear(),e.forEach((function(e){n.optionsArray.push(n.formBuilder.control(t?"":e.value))}))}},{key:"setFormEnabled",value:function(e){e?this.optionsArray.enable():this.optionsArray.disable()}}]),e}()).\u0275fac=function(e){return new(e||bh)(P.Pb(E.g),P.Pb(eh.d),P.Pb(P.i),P.Pb(Oe.e))},bh.\u0275cmp=P.Jb({type:bh,selectors:[["app-quiz-labels"]],decls:3,vars:2,consts:[["data-test","quizLabelsElement",3,"formGroup"],["formArrayName","options"],[4,"ngFor","ngForOf"],["data-test","appQuizLabel",3,"mode","formControl","option","options","sequence","correct","collapsed","labelUpdated"]],template:function(e,t){1&e&&(P.Vb(0,"div",0),P.Vb(1,"div",1),P.Kc(2,fh,7,17,"ng-container",2),P.Ub(),P.Ub()),2&e&&(P.lc("formGroup",t.form),P.Db(2),P.lc("ngForOf",t.optionsArray.controls))},directives:[eh.n,eh.h,eh.c,ra.k,ph,eh.m,eh.f],pipes:[ra.b],styles:[""],changeDetection:0}),gh([Object(E.d)(Is.getLabelsCollapsed),hh("design:type",be.a)],bh.prototype,"labelsCollapsed$",void 0),gh([Object(E.d)(_o.getActiveQuestionLabels),hh("design:type",be.a)],bh.prototype,"quizLabels$",void 0),gh([Object(E.d)(_o.getQuizModeActive),hh("design:type",be.a)],bh.prototype,"quizModeActive$",void 0),gh([Object(E.d)(_o.getAllSubmissions),hh("design:type",be.a)],bh.prototype,"allSubmissions$",void 0),gh([Object(E.d)(_o.getActiveSubmission),hh("design:type",be.a)],bh.prototype,"activeSubmission$",void 0),gh([Object(E.d)(_o.getActiveSubmitted),hh("design:type",be.a)],bh.prototype,"activeSubmitted$",void 0),bh),mh=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},yh=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function xh(e,t){if(1&e&&(P.Qb(0,"app-context-label",5),P.hc(1,"async"),P.hc(2,"async"),P.hc(3,"async"),P.hc(4,"async"),P.hc(5,"async")),2&e){var n=P.gc(3),i=null,o=null;P.lc("label",P.ic(1,3,n.contextLabel$))("enableInfo",P.ic(2,5,n.enableContextLabelInfo$)&&(null==(i=P.ic(3,7,n.layout$))?null:i.nodeInfo.enable))("enableActions",P.ic(4,9,n.enableContextLabelActions$)&&(null==(o=P.ic(5,11,n.layout$))?null:o.contextActions.enable))}}function kh(e,t){if(1&e&&(P.Tb(0),P.Qb(1,"app-story-label",6),P.hc(2,"async"),P.hc(3,"async"),P.hc(4,"async"),P.hc(5,"async"),P.Sb()),2&e){var n,i,o=t.$implicit,r=P.gc(3);P.Db(1),P.Hb("labels__label--hidden",!o.shown),P.lc("pinDraggable",null==(n=P.ic(2,7,r.draggable$))?null:n.pin)("tagDraggable",null==(i=P.ic(3,9,r.draggable$))?null:i.tag)("label",o)("collapsed",P.ic(4,11,r.labelsCollapsed$))("collapsedMode",P.ic(5,13,r.labelsCollapsedMode$))}}function wh(e,t){if(1&e&&(P.Tb(0),P.Kc(1,xh,6,13,"app-context-label",3),P.hc(2,"async"),P.hc(3,"async"),P.Kc(4,kh,6,15,"ng-container",4),P.hc(5,"async"),P.Sb()),2&e){var n=P.gc(2);P.Db(1),P.lc("ngIf",P.ic(2,3,n.enableContextLabel$)&&P.ic(3,5,n.contextLabel$)),P.Db(3),P.lc("ngForOf",P.ic(5,7,n.labels$))("ngForTrackBy",n.trackLabel)}}function Oh(e,t){1&e&&(P.Tb(0),P.Qb(1,"app-quiz-labels"),P.Sb())}function Ch(e,t){if(1&e&&(P.Vb(0,"div",1),P.Kc(1,wh,6,9,"ng-container",2),P.Kc(2,Oh,2,0,"ng-container",2),P.Ub()),2&e){var n=P.gc();P.Db(1),P.lc("ngIf",n.showAnatomyLabels),P.Db(1),P.lc("ngIf",n.showQuizLabels)}}var Sh,_h=((Sh=function(){function e(t,n,i,o,r,a,s,c){m(this,e),this.store=t,this.action$=n,this.router=i,this.engineService=o,this.cameraService=r,this.changeDetector=a,this.labelsService=s,this.elRef=c,this.interactive=!1,this.showAnatomyLabels=!1,this.showQuizLabels=!1,this.ngUnsubscribe=new fe.a}return v(e,[{key:"ngOnInit",value:function(){this.bindEngineEvents(),this.bindApplicationEvents(),this.labelsService.setLabelContainer(this.elRef)}},{key:"ngOnDestroy",value:function(){this.labelsService.setLabelContainer(null),this.changeDetector.detach(),this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"bindApplicationEvents",value:function(){var e=this;this.action$.pipe(Object(E.j)(Be),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){e.handleClickNode(t)})),this.labels$.pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){e.changeDetector.markForCheck()})),this.selectedLabel$.pipe(Object(me.a)((function(e){return null==e})),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(){var t=e.store.selectSnapshot(Ar.getZoomed),n=e.store.selectSnapshot(Ar.getLockCamera);t&&!n&&e.resetCamera()}));var t=Object(Gr.b)([this.activeTool$,this.activeQuestion$]).pipe(Object(ve.a)(this.ngUnsubscribe),Object(Z.a)((function(t){var n=p(t,2),i=n[0],o=n[1],r=e.router.url.indexOf("/edit")>=0,a=Object(Se.get)(o,"type")===co.LabelAnatomy;return r?i===Rr.Quiz:a})));Object(Gr.b)([this.showLabels$,t]).pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){var n=p(t,2),i=n[0],o=n[1];e.showQuizLabels=o,e.showAnatomyLabels=!e.showQuizLabels&&i,e.changeDetector.markForCheck()})),this.store.select(Lr.getSelectedChapterReadyState).pipe(Object(me.a)((function(e){return null!=e})),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){e.interactive=t.model,e.changeDetector.markForCheck()}))}},{key:"bindEngineEvents",value:function(){var e=this;this.action$.pipe(Object(E.j)(Je,tr),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){e.engineService.fireEvent(t.show?Dt.LabelsEnabled:Dt.LabelsDisabled,null)})),this.action$.pipe(Object(E.j)(No),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){e.engineService.fireEvent(Dt.LabelsCreated,t.label)})),this.action$.pipe(Object(E.j)($o),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){e.engineService.fireEvent(Dt.LabelsUpdated,t.label)})),this.action$.pipe(Object(E.j)(er),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){t.labels.forEach((function(n){e.engineService.fireEvent(t.shown?Dt.LabelsShown:Dt.LabelsHidden,{labelId:n.id})}))})),this.action$.pipe(Object(E.j)(Qo),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){e.engineService.fireEvent(Dt.LabelsDestroyed,t.label)}))}},{key:"handleClickNode",value:function(e){var t=this,n=this.store.selectSnapshot(Wr.getActiveTool);null!=e.node?n===Rr.Label?this.addLabel(e.hit,e.node):setTimeout((function(){t.toggleContextLabel(e.hit,e.node)})):(this.store.dispatch(new Zo(null)),this.store.dispatch(new qo))}},{key:"addLabel",value:function(e,t){var n=this.cameraService.getDirection(e),i=this.getLabelDefaults(e.objectId),o=i.hideWire?20:32;i.title=t.label,i.offset=[o,0],i.objectId=e.objectId,i.barycentric=[e.barycentric[0],e.barycentric[1],e.barycentric[2]],i.pos=[e.worldPos[0],e.worldPos[1],e.worldPos[2]],i.primitiveIndex=e.primitiveIndex,i.renderableIndex=e.renderableIndex||0,i.dir=n,i.chapterId=this.store.selectSnapshot(Lr.getSelectedChapter).id,i.occludable=!0,i.shown=!0,this.store.dispatch(new No(i)),this.store.dispatch(new Zo(i))}},{key:"toggleContextLabel",value:function(e,t){if(this.store.selectSnapshot(Ai.getCheckedNodeIds).some((function(e){return e===t.id}))){var n=this.cameraService.getDirection(e),i=this.labelsService.makeDefaultStudioLabel();i.theme=Yn.Context,i.title=t.label,i.offset=[32,0],i.objectId=e.objectId,i.barycentric=[e.barycentric[0],e.barycentric[1],e.barycentric[2]],i.pos=[e.worldPos[0],e.worldPos[1],e.worldPos[2]],i.primitiveIndex=e.primitiveIndex,i.dir=n,i.occludable=!1,this.store.dispatch(new Bo(i))}else this.store.dispatch(new qo)}},{key:"getLabelDefaults",value:function(e){var t=this.store.selectSnapshot(Is.getSelectedLabel);if(null==t){var n=this.store.selectSnapshot(Is.getChapterLabels);n&&0!==n.length||(n=this.store.selectSnapshot(Is.getLabels)),n.length&&(t=Object(Se.cloneDeep)(n[n.length-1]))}if(null!=t){var i=this.labelsService.makeDefaultStudioLabel();switch(i.hideWire=t.hideWire,i.pinGlow=t.pinGlow,i.pinType=t.pinType,i.theme=t.theme,i.sequentialType=t.sequentialType,i.states[0].errands[0]=new xi,Object(Se.get)(t,"states[1].errands[0].type")){case bi.flyToObject:case bi.flyToCamera:i.states[1].errands[0]=new vi(e)}return i}var o=this.labelsService.makeDefaultStudioLabel();return o.states[0].errands[0]=new xi,o.states[1].errands[0]=new vi(e),o}},{key:"trackLabel",value:function(e,t){var n=t.id,i=t.shown,o=t.theme;return"".concat(n).concat(i).concat(o)}},{key:"resetCamera",value:function(){var e=this.store.selectSnapshot(Lr.getSelectedChapter);Object(Se.get)(e,"camera.location")&&this.store.dispatch(new $t(e.camera.location))}}]),e}()).\u0275fac=function(e){return new(e||Sh)(P.Pb(E.g),P.Pb(E.b),P.Pb(Oe.e),P.Pb(Nt),P.Pb(gn),P.Pb(P.i),P.Pb(wi),P.Pb(P.m))},Sh.\u0275cmp=P.Jb({type:Sh,selectors:[["app-labels"]],decls:1,vars:1,consts:[["class","labels","data-test","labelsElement",4,"ngIf"],["data-test","labelsElement",1,"labels"],[4,"ngIf"],[3,"label","enableInfo","enableActions",4,"ngIf"],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"label","enableInfo","enableActions"],["data-test","appStoryLabel",1,"labels__label",3,"pinDraggable","tagDraggable","label","collapsed","collapsedMode"]],template:function(e,t){1&e&&P.Kc(0,Ch,3,2,"div",0),2&e&&P.lc("ngIf",t.interactive)},directives:[ra.l,ra.k,Hd,Yg,vh],pipes:[ra.b],styles:["[_nghost-%COMP%]{position:relative}.labels[_ngcontent-%COMP%], [_nghost-%COMP%]{width:100%;height:100%;display:block}.labels[_ngcontent-%COMP%]{position:absolute;left:0;top:0;z-index:2;pointer-events:none}.labels__label--hidden[_ngcontent-%COMP%]{display:none}"],changeDetection:0}),mh([Object(E.d)(ku.getUI),yh("design:type",be.a)],Sh.prototype,"layout$",void 0),mh([Object(E.d)(Is.getChapterLabels),yh("design:type",be.a)],Sh.prototype,"labels$",void 0),mh([Object(E.d)(_o.getQuizModeActive),yh("design:type",be.a)],Sh.prototype,"quizModeActive$",void 0),mh([Object(E.d)(Wr.getActiveTool),yh("design:type",be.a)],Sh.prototype,"activeTool$",void 0),mh([Object(E.d)(_o.getActiveQuestion),yh("design:type",be.a)],Sh.prototype,"activeQuestion$",void 0),mh([Object(E.d)(Lr.getSelectedChapter),yh("design:type",be.a)],Sh.prototype,"selectedChapter$",void 0),mh([Object(E.d)(Is.getSelectedLabel),yh("design:type",be.a)],Sh.prototype,"selectedLabel$",void 0),mh([Object(E.d)(Is.getLabelsCollapsed),yh("design:type",be.a)],Sh.prototype,"labelsCollapsed$",void 0),mh([Object(E.d)(Is.getLabelsCollapsedMode),yh("design:type",be.a)],Sh.prototype,"labelsCollapsedMode$",void 0),mh([Object(E.d)(Is.getContextLabel),yh("design:type",be.a)],Sh.prototype,"contextLabel$",void 0),mh([Object(E.d)(Wr.getShowLabels),yh("design:type",be.a)],Sh.prototype,"showLabels$",void 0),mh([Object(E.d)(Ar.getZoomed),yh("design:type",be.a)],Sh.prototype,"zoomed$",void 0),mh([Object(E.d)(Is.getEnableContextLabel),yh("design:type",be.a)],Sh.prototype,"enableContextLabel$",void 0),mh([Object(E.d)(Is.getEnableContextLabelInfo),yh("design:type",be.a)],Sh.prototype,"enableContextLabelInfo$",void 0),mh([Object(E.d)(Is.getEnableContextLabelActions),yh("design:type",be.a)],Sh.prototype,"enableContextLabelActions$",void 0),mh([Object(E.d)(Is.getLabelsDraggable),yh("design:type",be.a)],Sh.prototype,"draggable$",void 0),Sh);function jh(e,t){if(1&e){var n=P.Wb();P.Vb(0,"div",1),P.cc("@show.done",(function(){return P.zc(n),P.gc().onShowDone()})),P.Vb(1,"div",2),P.Mc(2," Use control + scroll to zoom "),P.Ub(),P.Ub()}2&e&&P.lc("@show",void 0)}var Ph,Mh,Ih,zh,Th,Uh,Lh=((Ph=function(){function e(t,n){m(this,e),this.actions=t,this.changeDetectorRef=n,this.ngUnsubscribe=new fe.a,this.show=!1}return v(e,[{key:"ngOnInit",value:function(){var e=this;this.actions.pipe(Object(E.j)(Ue),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(){e.show=!0,e.changeDetectorRef.markForCheck()}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"onShowDone",value:function(){this.show=!1}}]),e}()).\u0275fac=function(e){return new(e||Ph)(P.Pb(E.b),P.Pb(P.i))},Ph.\u0275cmp=P.Jb({type:Ph,selectors:[["app-engine-scroll"]],decls:1,vars:1,consts:[["class","engine-scroll","data-test","engineScroll",4,"ngIf"],["data-test","engineScroll",1,"engine-scroll"],[1,"engine-scroll__label"]],template:function(e,t){1&e&&P.Kc(0,jh,3,1,"div",0),2&e&&P.lc("ngIf",t.show)},directives:[ra.l],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3838}.text-info[_ngcontent-%COMP%]{color:#0060c4}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.engine-scroll[_ngcontent-%COMP%]{display:flex;position:absolute;justify-content:center;align-items:center;top:0;bottom:0;left:0;right:0;z-index:10000;opacity:0;pointer-events:none}.engine-scroll__label[_ngcontent-%COMP%]{background:rgba(16,24,35,.5);font-size:16px;letter-spacing:.4px;line-height:1.4em;color:#fff;font-weight:600;padding:24px 32px;border-radius:40px}"],data:{animation:[Object(wu.n)("show",[Object(wu.m)(":enter",[Object(wu.j)([Object(wu.l)({opacity:"*"}),Object(wu.e)("500ms ease-in-out",Object(wu.l)({opacity:1})),Object(wu.e)("500ms 2000ms ease-in-out",Object(wu.l)({opacity:0}))])])])]},changeDetection:0}),Ph),Dh=function(e,t){return{backgroundColor:e,duration:t}},Eh=function(e,t){return{value:e,params:t}},Fh=Object(wu.g)([Object(wu.l)({opacity:"0",backgroundColor:"*"}),Object(wu.j)([Object(wu.e)("{{ duration }}ms {{ easing }}",Object(wu.l)({opacity:1,backgroundColor:"{{ backgroundColor }}"})),Object(wu.e)("250ms 500ms ease-in",Object(wu.l)({opacity:0}))])],{params:{duration:2e3,backgroundColor:"#ffffff",easing:"ease-out"}}),Ah=((Ih=function(){function e(t,n,i){m(this,e),this.actions=t,this.changeDetectorRef=n,this.store=i,this.color="#FFFFFF",this.duration=2e3,this.isVisible=!1,this.ngUnsubscribe=new fe.a}return v(e,[{key:"ngOnInit",value:function(){this.initFadeListener()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initFadeListener",value:function(){var e=this;this.actions.pipe(Object(E.j)(De),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){e.fadeIn(t.color,t.duration)}))}},{key:"handleFadeComplete",value:function(){this.store.dispatch(new Ee),this.isVisible=!1,this.changeDetectorRef.markForCheck()}},{key:"fadeIn",value:function(e,t){this.isVisible=!0,this.color=e,this.duration=1e3*t,this.changeDetectorRef.markForCheck()}}]),e}()).\u0275fac=function(e){return new(e||Ih)(P.Pb(E.b),P.Pb(P.i),P.Pb(E.g))},Ih.\u0275cmp=P.Jb({type:Ih,selectors:[["app-engine-fade"]],decls:1,vars:7,consts:[[1,"engine-fade"]],template:function(e,t){1&e&&(P.Vb(0,"div",0),P.cc("@fade.done",(function(){return t.handleFadeComplete()})),P.Ub()),2&e&&P.lc("@fade",P.pc(4,Eh,t.isVisible,P.pc(1,Dh,t.color,t.duration)))},styles:[".engine-fade{pointer-events:none;display:block;position:absolute;left:0;right:0;top:0;bottom:0;z-index:10000}"],encapsulation:2,data:{animation:[Object(wu.n)("fade",[Object(wu.m)("* => true",Object(wu.o)(Fh))])]},changeDetection:0}),Ih),Rh=((Mh=function(){function e(t){m(this,e),this.store=t}return v(e,[{key:"ngOnInit",value:function(){}},{key:"ngAfterViewInit",value:function(){this.nodeActionsComponent.nodeActionsTrigger.openMenu()}},{key:"onNodeActionsClosed",value:function(){this.store.dispatch(new He(null,null))}},{key:"getNodeActionsStyles",value:function(){return{"left.px":this.hit?this.hit.canvasPos[0]:0,"top.px":this.hit?this.hit.canvasPos[1]:0}}}]),e}()).\u0275fac=function(e){return new(e||Mh)(P.Pb(E.g))},Mh.\u0275cmp=P.Jb({type:Mh,selectors:[["app-engine-contextmenu"]],viewQuery:function(e,t){var n;1&e&&P.Gc(Tl,!0),2&e&&P.uc(n=P.dc())&&(t.nodeActionsComponent=n.first)},inputs:{node:"node",hit:"hit"},decls:2,vars:2,consts:[[1,"contextmenu"],["eventCategory","Context Node","theme","light",1,"contextmenu__node-actions",3,"ngStyle","node","nodeActionsClosed"]],template:function(e,t){1&e&&(P.Vb(0,"div",0),P.Vb(1,"app-node-actions",1),P.cc("nodeActionsClosed",(function(){return t.onNodeActionsClosed()})),P.Ub(),P.Ub()),2&e&&(P.Db(1),P.lc("ngStyle",t.getNodeActionsStyles())("node",t.node))},directives:[Tl,ra.m],styles:[".contextmenu[_ngcontent-%COMP%]{left:0;top:0;width:100%;height:100%;display:block;z-index:2}.contextmenu[_ngcontent-%COMP%], .contextmenu__node-actions[_ngcontent-%COMP%]{position:absolute}"]}),Mh),Vh=function(e){return{"progress__bar--complete":e}},Nh=function(e){return{width:e}},Bh=((Uh=function(){function e(t,n){m(this,e),this.router=t,this.changeDetector=n,this.total=100,this._value=0,this.percentWidth=0,this.ngUnsubscribe=new fe.a}return v(e,[{key:"value",get:function(){return this._value},set:function(e){this._value=e,this.percentWidth=this.value/this.total*100,this.changeDetector.markForCheck()}},{key:"ngOnInit",value:function(){var e=this;this.router.events.pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){t instanceof Oe.d&&(e.value=0)}))}},{key:"ngOnDestroy",value:function(){this.changeDetector.detach(),this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}}]),e}()).\u0275fac=function(e){return new(e||Uh)(P.Pb(Oe.e),P.Pb(P.i))},Uh.\u0275cmp=P.Jb({type:Uh,selectors:[["app-progress"]],inputs:{total:"total",value:"value"},decls:2,vars:6,consts:[[1,"progress"],[1,"progress__bar",3,"ngClass","ngStyle"]],template:function(e,t){1&e&&(P.Vb(0,"div",0),P.Qb(1,"div",1),P.Ub()),2&e&&(P.Db(1),P.lc("ngClass",P.oc(2,Vh,100===t.percentWidth))("ngStyle",P.oc(4,Nh,t.percentWidth+"%")))},directives:[ra.i,ra.m],styles:["@-webkit-keyframes progressSuccess{0%{width:100%!important;background:#38de38}50%{opacity:1;background:#38de38}to{opacity:0}}@keyframes progressSuccess{0%{width:100%!important;background:#38de38}50%{opacity:1;background:#38de38}to{opacity:0}}.progress[_ngcontent-%COMP%]{border-radius:0 1px 1px 0;display:flex;align-items:center;height:4px;width:100%}.progress__bar[_ngcontent-%COMP%]{background:#de3838;height:100%;width:0}.progress__bar--complete[_ngcontent-%COMP%]{-webkit-animation:progressSuccess 2s linear forwards;animation:progressSuccess 2s linear forwards}"],changeDetection:0}),Uh),Hh=((Th=function(){function e(t,n){m(this,e),this.store=t,this.changeDetectorRef=n,this.ngUnsubscribe=new fe.a,this.storyLoadProgress=0}return v(e,[{key:"ngOnInit",value:function(){var e=this,t=this.store.select(Xu.getChunkLoadProgress),n=this.store.select(Hs.getLoadingChunk);Object(Gr.b)(t,n).pipe(Object(me.a)((function(){var t=e.store.selectSnapshot(Hs.getLoadChunks);return null!==t&&t.length>0})),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){var n=p(t,2),i=n[0],o=n[1],r=null!==o&&o.chapterId===e.store.selectSnapshot(Lr.getSelectedChapterId);e.storyLoadProgress=r?i:1,e.changeDetectorRef.markForCheck()}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}}]),e}()).\u0275fac=function(e){return new(e||Th)(P.Pb(E.g),P.Pb(P.i))},Th.\u0275cmp=P.Jb({type:Th,selectors:[["app-engine-progress"]],decls:1,vars:2,consts:[["data-test","engineProgress",1,"engine-progress",3,"value","total"]],template:function(e,t){1&e&&P.Qb(0,"app-progress",0),2&e&&P.lc("value",t.storyLoadProgress)("total",1)},directives:[Bh],styles:[".engine-progress[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;z-index:2;pointer-events:none}"],changeDetection:0}),Th),Qh=((zh=function(){function e(t,n){m(this,e),this.engineService=t,this.changeDetectionRef=n,this.camera={x:0,y:0,z:0,dist:0}}return v(e,[{key:"ngOnInit",value:function(){this.initCameraListener()}},{key:"initCameraListener",value:function(){var e=this;this.engineService.getEvent(Dt.CameraUpdated).pipe(Object(ea.a)(50)).subscribe((function(t){e.camera={x:t.eye.x.toFixed(0),y:t.eye.y.toFixed(0),z:t.eye.z.toFixed(0),dist:t.dist.toFixed(0)},e.changeDetectionRef.markForCheck()}))}}]),e}()).\u0275fac=function(e){return new(e||zh)(P.Pb(Nt),P.Pb(P.i))},zh.\u0275cmp=P.Jb({type:zh,selectors:[["app-engine-camera-position"]],decls:2,vars:4,consts:[[1,"engine-camera-position"]],template:function(e,t){1&e&&(P.Vb(0,"div",0),P.Mc(1),P.Ub()),2&e&&(P.Db(1),P.Qc(" X:",null==t.camera?null:t.camera.x," Y:",null==t.camera?null:t.camera.y," Z:",null==t.camera?null:t.camera.z," Dist:",null==t.camera?null:t.camera.dist,"\n"))},styles:[".engine-camera-position[_ngcontent-%COMP%]{position:absolute;top:8px;right:8px;color:#fff;font-size:10px;text-shadow:0 0 2px rgba(0,0,0,.8);z-index:10}"],changeDetection:0}),zh),qh=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},Wh=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},$h=["engine"],Kh=["engineCanvas"],Gh=["engineAnnotations"];function Zh(e,t){if(1&e&&P.Qb(0,"app-engine-contextmenu",10),2&e){var n=P.gc();P.lc("node",n.contextmenuNode)("hit",n.contextmenuHit)}}function Jh(e,t){1&e&&P.Qb(0,"div",11)}function Xh(e,t){1&e&&P.Qb(0,"app-engine-progress",12)}function Yh(e,t){1&e&&(P.Tb(0),P.Qb(1,"app-engine-camera-position"),P.Sb())}var ef,tf,nf,of,rf=function(e){return e[e.Pan=.4]="Pan",e[e.PanSlow=.04]="PanSlow",e[e.Zoom=5]="Zoom",e[e.ZoomSlow=1]="ZoomSlow",e[e.Rotate=.3]="Rotate",e[e.RotateSlow=.03]="RotateSlow",e}({}),af=function(e){return e[e.Rotate=6]="Rotate",e[e.Pan=1.75]="Pan",e[e.Zoom=2.5]="Zoom",e}({}),sf=function(e){return e[e.Zoom=-6]="Zoom",e[e.TrackZoom=.5]="TrackZoom",e[e.Pan=1.25]="Pan",e[e.Rotate=1.5]="Rotate",e[e.Friction=.85]="Friction",e[e.ZoomFriction=.85]="ZoomFriction",e[e.FrictionThreshold=.002]="FrictionThreshold",e}({}),cf=function(e){return e.Hide="engine--cursor-hide",e.Label="engine--cursor-label",e.Paint="engine--cursor-paint",e.Crosshair="engine--cursor-crosshair",e.Default="",e}({}),lf=function(e){return e[e.None=0]="None",e[e.Left=1]="Left",e[e.Right=2]="Right",e[e.LeftAndRight=4]="LeftAndRight",e}({}),uf=((ef=function(){function e(t,n,i,o,r,a,s,c,l,u){m(this,e),this.actions=t,this.cameraService=n,this.chapterService=i,this.changeDetecton=o,this.engineService=r,this.paintService=a,this.visibilityLayersService=s,this.mediaService=c,this.renderer=l,this.store=u,this.flyCamera=!0,this.chapterActivating=!1,this.visible=!1,this.application=M,this.cursorClass=cf.Default,this.ngUnsubscribe=new fe.a,this.display=!1,this.engineVisible=!0,this.background=new $r.a(null),this.ctrlPressed=!1,this.scrollType=null,this.scrollTimeout=null,this.pinchTicks=0,this.progress="0",this.deltaTime=window.performance.now(),this.pinchMode="",this.inputEnabled=!0,U.application===M.Loft&&h.e(6).then(h.t.bind(null,"16wW",7)).then((function(e){window.pako=e}))}return v(e,[{key:"wheel",value:function(e){var t=this.store.selectSnapshot(Wr.getScrollMode),n=e.ctrlKey;t!==Vr.DoNotCaptureShowMessage||n||this.store.dispatch(new Ue(!0)),(t===Vr.Capture||n)&&(e.preventDefault(),this.handleWheel(e))}},{key:"contextmenu",value:function(e){this.handleContextMenu(e)}},{key:"mouseout",value:function(){this.handleMouseOut()}},{key:"convertToLeafStateMap",value:function(e,t){var n={};return Object.entries(t).forEach((function(t){var i=p(t,2),o=i[0],r=i[1];n[o]={},n[o][e]=r})),n}},{key:"ngOnInit",value:function(){this.particleStateListener=new Gs(this.store),this.bindEngineEvents(),this.bindApplicationEvents(),this.bindChapterChangeEvents(),this.bindCameraEvents(),this.bindToolEvents(),this.bindMouseEvents(),this.bindKeyEvents(),this.bindHumanInteractions(),this.initChangeListener(),this.initChapterAudio(),this.initBackgroundListener(),this.initPlaybackSpeedListener(),Human.properties.set({assetDomain:U.assetDomain}),Human.workers.setPath("/engine/studio/workers"),Human.init.init()}},{key:"ngOnDestroy",value:function(){this.changeDetecton.detach(),this.particleStateListener.destroy(),this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initEventListeners",value:function(){}},{key:"bindEngineEvents",value:function(){var e=this;this.engineService.getEvent(Dt.Loaded).pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(){e.store.dispatch(new Ie(!0))})),this.engineService.getEvent(Dt.TimelineChaptersActivateStart).pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(){e.chapterActivating=!0})),this.engineService.getEvent(Dt.TimelineChaptersActivateFinish).pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){e.chapterActivating=!1;var n=Human.timeline.activeRoot._nowBranch,i={id:n.id,init:!0,camera:n.initializedCamera,annotations:n.initializedAnnotations,graph:n.initializedGraph,properties:n.initializedProperties,particles:n.initializedParticles,clips:n.initializedClippingPlanes,postprocessing:n.initializedPostprocess,transparency:n.initializedTransparencyMode};e.store.dispatch(new Ve(t.chapterId)),e.store.dispatch(new Ne(i))})),this.engineService.getEvent(Dt.TimelineChaptersActivated).pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){e.engineService.fireEvent(Dt.LabelsChapterInfo,e.store.selectSnapshot(Is.getChapterLabels))})),Object(Kr.a)(this.engineService.getEvent(Dt.TimelinePlayed),this.engineService.getEvent(Dt.TimelinePaused)).pipe(Object(ve.a)(this.ngUnsubscribe),Object(me.a)((function(){return null!=e.store.selectSnapshot(Lr.getSelectedChapterId)})),Object(Jr.a)(50),Object(Z.a)((function(){return Human.timeline.playing}))).subscribe((function(t){e.store.dispatch(new tt(t))})),this.engineService.getEvent(Dt.Tick).pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(){e.visible&&(e.inputEnabled&&e.handleMouseInputEngineTick(),e.handleCameraTick(),e.deltaTime=window.performance.now())})),this.engineService.getEvent(Dt.TweenVisibilityUpdate).pipe(Object(Xr.a)((function(e,t){return JSON.stringify(e)===JSON.stringify(t)})),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){var n=Object.keys(t).filter((function(e){return!0===t[e]})),i=Object.keys(t).filter((function(e){return!1===t[e]}));n.length>0&&e.store.dispatch(new pi.UpdateNodesShown(!0,n,void 0,!1,!0)),i.length>0&&e.store.dispatch(new pi.UpdateNodesShown(!1,i,void 0,!1,!0))})),this.engineService.getEvent(Dt.SceneObjectRenderable).pipe(Object(Yr.a)(1e3),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){if(t.length){var n={};t.forEach((function(e){n[e.objectId]={renderable:!0}})),e.store.dispatch(new $e(n))}})),this.engineService.getEvent(Dt.AssetsLoadProgress).pipe(Object(ea.a)(33),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){var n=Math.max(1,e.store.selectSnapshot(Hs.getLoadChunks).length),i=e.store.selectSnapshot(Hs.getLoadChunksRemaining).length,o=n-i,r=t.receivedAssets/t.requestedAssets,a=1/n,s=0===i?1:r*a+o*a;e.progress=s.toFixed(2),e.changeDetecton.markForCheck(),e.store.dispatch(new Qs(s,r))})),this.actions.pipe(Object(E.i)(La),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(){0===e.store.selectSnapshot(Hs.getLoadChunksRemaining).length&&(e.store.dispatch(new Qs(1,1)),e.engineService.enableRender())}))}},{key:"bindApplicationEvents",value:function(){var e=this;this.enginePosition$.pipe(Object(me.a)((function(e){return null!=e})),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){e.repositionEngine(t)})),this.store.select(Wr.getXrayModeEnabled).pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){var n=e.store.selectSnapshot(Ai.getCheckedNodes),i=e.store.selectSnapshot(Ai.getNodes);!1===t?(Object.keys(i||[]).forEach((function(t){e.paintService.paint(t,i[t].paint)})),n.forEach((function(t){return e.paintService.highlight(t.objectId,!0)}))):(e.paintService.paintAll(Object.keys(i),Zi.recipe),e.paintService.paintAll(n.map((function(e){return e.objectId})),Bi.recipe))})),this.actions.pipe(Object(E.j)(ot),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(){e.playChapterFromStart()})),this.engineDisplay$.pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){e.display=t,e.changeDetecton.markForCheck()})),this.engineVisible$.pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){e.engineVisible=t,e.changeDetecton.markForCheck()})),this.visibilityLayersService.initObservables(),this.contextmenu$.pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){e.contextmenuNode=t.node,e.contextmenuHit=t.hit,e.changeDetecton.markForCheck()}))}},{key:"bindChapterChangeEvents",value:function(){var e=this;this.selectedChapter$.pipe(Object(me.a)((function(e){return!Object(Se.isNil)(e)})),Object(ta.a)(),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){var n=p(t,2),i=n[0],o=n[1],r=e.chapterService.getCurrentChapterId(),a=o.id;i.id===a&&r===a||(e.store.dispatch(new pi.SetActiveChapter(a)),Ws(e.store,e.engineService),Human.timeline.scrub({chapterId:a}),e.store.dispatch(new ln(void 0)))})),this.clippingPlanes$.pipe(Object(me.a)((function(e){return void 0!==e})),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(e){var t=Object.values(e.clips).filter((function(e){return e.enabled}));Human.renderer.clip.reset(),t.forEach((function(t){return Human.renderer.clip.setClip(Object.assign({boundary:e.boundary},t))}))})),Object(Gr.b)(this.selectedChapterId$,this.readyState$,this.autoplay$).pipe(Object(me.a)((function(e){var t=p(e,3),n=t[0],i=t[1],o=t[2];return!Object(Se.isNil)(n)&&!Object(Se.isNil)(i)&&!Object(Se.isNil)(o)})),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){var n=p(t,3),i=n[1],o=n[2],r=Object(Se.get)(i,"animation",!1),a=e.store.selectSnapshot(Lr.getSelectedChapter),s=Object(Se.get)(a,"ui.play.autoplay",!0),c=r&&o&&s;e.store.dispatch(new Ye(a,!c)),e.store.dispatch(new et(c))}))}},{key:"bindCameraEvents",value:function(){var e=this;this.actions.pipe(Object(E.j)($t),Object(me.a)((function(e){return!Object(Se.isNil)(e.camera)})),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){t.animate?e.flyToPoint(t.camera,t.animationDuration):e.jumpToPoint(t.camera)})),this.actions.pipe(Object(E.j)(tn),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){e.cameraService.panCameraStatic(t.x,t.y,t.z)})),this.actions.pipe(Object(E.j)(rn),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){e.cameraService.rotateCameraStatic(t.x,t.y)})),this.actions.pipe(Object(E.j)(Xt),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){e.cameraService.setHumanZoomFactor(t.value)})),this.actions.pipe(Object(E.j)(Qe),Object(me.a)((function(e){return!!e.objectId})),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){t.animate?e.flyToObject(t.objectId,t.animationDuration):e.jumpToObject(t.objectId)}))}},{key:"bindToolEvents",value:function(){var e=this;this.activeTool$.pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){switch(Object.values(cf).forEach((function(t){t&&e.renderer.removeClass(e.engineElement.nativeElement,t)})),t){case Rr.Hide:e.renderer.addClass(e.engineElement.nativeElement,cf.Hide);break;case Rr.Label:e.renderer.addClass(e.engineElement.nativeElement,cf.Label);break;case Rr.Paint:e.renderer.addClass(e.engineElement.nativeElement,cf.Paint);break;case Rr.Quiz:e.renderer.addClass(e.engineElement.nativeElement,cf.Crosshair)}}))}},{key:"bindMouseEvents",value:function(){var e=this;this.mouseMove$=Object(Zr.a)(this.engineElement.nativeElement,"mousemove"),this.mouseMove$.pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){e.handleMousePan(t)})),this.mouseMove$.pipe(Object(Jr.a)(10),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){e.handleMouseHover(t)})),this.mouseLeave$=Object(Zr.a)(this.engineElement.nativeElement,"mouseleave"),this.mouseLeave$.pipe(Object(Jr.a)(10),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){e.handleMouseLeave()}))}},{key:"bindKeyEvents",value:function(){var e,t=this,n=["w","a","s","d","e","c","=","-","+","_","arrowleft","arrowright","arrowup","arrowdown","shiftKey"].reduce((function(e,t){return e[t]=!1,e}),{}),i=new $r.a(n);this.renderer.listen(window,"keydown",(function(e){var t;if(!(e.repeat||e.metaKey||e.ctrlKey)){var n=e.target.nodeName.toLowerCase();["input","textarea","select","option"].indexOf(n)>=0||i.next(Object.assign(Object.assign({},i.value),(u(t={},e.key.toLowerCase(),!0),u(t,"shiftKey",e.shiftKey),u(t,"hasMomentum",!1),t)))}})),this.renderer.listen(window,"keyup",(function(n){var o,r;n.key&&(1===Object.values(e).filter((function(e){return!0===e})).length?(t.applyMotion(e,!0),i.next(Object.assign(Object.assign({},i.value),(u(o={},n.key.toLowerCase(),!1),u(o,"shiftKey",n.shiftKey),u(o,"hasMomentum",!1===e.shiftKey),o)))):i.next(Object.assign(Object.assign({},i.value),(u(r={},n.key.toLowerCase(),!1),u(r,"shiftKey",n.shiftKey),u(r,"hasMomentum",!1),r))))})),i.pipe(Object(me.a)((function(){return t.inputEnabled})),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(n){e=n,!1===n.hasMomentum&&t.applyMotion(n,!1)})),this.renderer.listen(window,"keydown",(function(e){"Control"===e.key&&(t.ctrlPressed=!0)})),this.renderer.listen(window,"keyup",(function(e){"Control"===e.key&&(t.ctrlPressed=!1)}))}},{key:"applyMotion",value:function(e,t){var n=new hn,i=e.shiftKey?rf.ZoomSlow:rf.Zoom,o=e.shiftKey?rf.PanSlow:rf.Pan,r=e.shiftKey?rf.RotateSlow:rf.Rotate;n.zoom+=e.c||e["-"]||e._?i:0,n.zoom-=e.e||e["="]||e["+"]?i:0,n.panX-=e.d?o:0,n.panX+=e.a?o:0,n.panY+=e.w?o:0,n.panY-=e.s?o:0,n.rotateX-=e.arrowright?r:0,n.rotateX+=e.arrowleft?r:0,n.rotateY+=e.arrowup?r:0,n.rotateY-=e.arrowdown?r:0,n.applyFriction=t,this.store.dispatch(new Gt(n))}},{key:"initChangeListener",value:function(){var e=this;this.store.select(Ai.getPatches).pipe(Object(me.a)((function(e){return e.length>0})),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){var n=t.reduce((function(e,t){var n=t.path[t.path.length-1];return void 0!==e[n]&&e[n].push(t),e}),{shown:[],checked:[],paint:[],pickable:[]}),i=function(e){return n[e].reduce((function(e,t){return e[t.path[2]]=t.value,e}),{})},o=i("checked"),r=i("shown"),a=i("paint"),s=i("pickable");if(!Object(Se.isEmpty)(r)){var c=e.store.selectSnapshot(Ai.getNodes),l=Object.values(c).reduce((function(e,t){return e[t.objectId]=t.shown,e}),{});e.engineService.setNodesVisible(l);var u=e.convertToLeafStateMap("shown",l);e.store.dispatch(new We(u,c))}if(!Object(Se.isEmpty)(o)){e.engineService.fireEvent(Dt.SceneObjectsSelected,{selectedObjectsUpdate:o});var d=e.store.selectSnapshot(Wr.getXrayModeEnabled)?function(t,n){return e.paintService.paint(t,!0===n?Bi.recipe:Zi.recipe)}:function(t,n){return e.paintService.highlight(t,n)};Object.entries(o).forEach((function(e){var t=p(e,2),n=t[0],i=t[1];d(n,i)}))}if(!Object(Se.isEmpty)(a))for(var g=0,h=Object.entries(a);g<h.length;g++){var f=p(h[g],2),b=f[0],v=f[1];e.paintService.colorObject(b,Li.toEngine(v))}if(!Object(Se.isEmpty)(s)){var m=e.store.selectSnapshot(Ai.getNodes),y=Object.values(m).reduce((function(e,t){return e[t.objectId]=t.pickable,e}),{});e.engineService.setNodesPickable(y),e.store.dispatch(new Ke(e.convertToLeafStateMap("pickable",y),m))}}))}},{key:"initChapterAudio",value:function(){var e=this;Object(Gr.b)(this.selectedChapterId$,this.playAudio$).pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){var n=p(t,2),i=(n[0],n[1]);e.playAudio(i)}))}},{key:"initBackgroundListener",value:function(){var e=this;Object(Gr.b)([this.background$,this.engineDisplay$,this.engineVisible$]).pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){var n=p(t,3),i=n[0],o=n[1],r=n[2];e.renderer.setStyle(e.engineElement.nativeElement,"background-image",ai.toCSS(i)),e.isBackgroundCheckered(i)?e.renderer.addClass(e.engineElement.nativeElement,"engine--checkered"):e.renderer.removeClass(e.engineElement.nativeElement,"engine--checkered"),e.renderer.setStyle(e.engineElement.nativeElement,"display",o?"block":"none"),e.renderer.setStyle(e.engineElement.nativeElement,"opacity",r?1:0)}))}},{key:"initPlaybackSpeedListener",value:function(){this.store.select(Wr.getPlaybackSpeed).pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(e){Human.timeline.scale=e}))}},{key:"repositionEngine",value:function(e){this.renderer.setStyle(this.engineElement.nativeElement,"left",e.left+"px"),this.renderer.setStyle(this.engineElement.nativeElement,"top",e.top+"px"),this.renderer.setStyle(this.engineElement.nativeElement,"width",e.width+"px"),this.renderer.setStyle(this.engineElement.nativeElement,"height",e.height+"px"),this.renderer.setStyle(this.engineElement.nativeElement,"zIndex",""+e.visibility),this.renderer.setStyle(this.engineElement.nativeElement,"visibility",e.visibility===Ht.Shown?"visible":"hidden"),this.visible=e.visibility===Ht.Shown,Human.renderer.resize()}},{key:"bindHumanInteractions",value:function(){var e=this,t=new Ks.Manager(this.engineCanvasElement.nativeElement);t.add(new Ks.Tap({event:"doubletap",taps:2,posThreshold:50})),t.add(new Ks.Tap({event:"singletap"})),t.add(new Ks.Pan({event:"pan",pointers:0})),t.add(new Ks.Pinch({event:"pinch"})),t.add(new Ks.Press({time:500})),t.on("singletap",(function(t){e.handleTap(t)})),t.on("doubletap",(function(t){e.handleDoubleTap(t)})),t.on("press",(function(t){t.preventDefault(),t.srcEvent.stopImmediatePropagation(),e.handlePress(t)})),t.on("pan",(function(t){t.preventDefault(),e.handlePan(t)})),t.on("panstart",(function(t){e.handlePanStart(t)})),t.on("panend",(function(t){e.handlePanEnd(t)})),t.on("pinchend",(function(t){e.handlePinchEnd(t)}));var n=0,i=0;t.on("pinchstart",(function(t){n=t.scale,t.deltaX,t.deltaY,e.pinchMode=""})),t.on("pinchmove",(function(t){if(!(e.pinchTicks>0)){var o=Math.abs(t.deltaX)>60||Math.abs(t.deltaY)>60,r=t.scale>1.25||t.scale<.75;e.pinchMode?("pan"===e.pinchMode&&r&&!o&&(e.pinchMode="pinch"),"pinch"===e.pinchMode&&o&&!r&&(e.pinchMode="pan")):e.pinchMode=r?"pinch":"pan";var a=t.scale-n;n=t.scale;var s=i;i=0===a?0:a>0?1:-1,e.cameraService.setCameraPan(t.velocityX*sf.Pan,t.velocityY*sf.Pan),i+s!==0&&e.cameraService.setHumanZoom(a*sf.Zoom)}}))}},{key:"handleMouseHover",value:function(e){if(e.buttons===lf.None){var t=e.offsetX,n=e.offsetY,i=Human.renderer.pick.pick(t,n);if(i.objectId){var o=this.store.selectSnapshot(Wr.getViewGraph),r=this.engineService.getNode(o,i.objectId),a=this.store.selectSnapshot(Wr.getHoveredNode);a&&a.id===r.id||this.store.dispatch(new vt(r,i))}else null!=this.store.selectSnapshot(Wr.getHoveredNode)&&this.store.dispatch(new vt(null))}}},{key:"handleMouseLeave",value:function(){this.store.dispatch(new vt(null))}},{key:"handleMousePan",value:function(e){if(2===e.buttons||4===e.buttons){var t=e.movementX,n=e.movementY;t/=16,n/=16,this.cameraService.setCameraPan(t,n)}}},{key:"handleMouseOut",value:function(){this.store.dispatch(new vt(null))}},{key:"handleWheel",value:function(e){var t=this,n=0;switch(e.deltaMode){case 0:null===this.scrollType&&(this.scrollType=Math.abs(e.deltaY)<10?"trackpad":"wheel"),n="trackpad"===this.scrollType?e.deltaY*sf.TrackZoom:Math.sign(e.deltaY)*af.Zoom;break;default:this.scrollType="wheel",n=e.deltaY*af.Zoom}clearTimeout(this.scrollTimeout),this.scrollTimeout=setTimeout((function(){t.scrollType=null}),500),Math.abs(n)>40&&(n=40*Math.sign(n)),"trackpad"===this.scrollType?this.cameraService.setCameraZoom(n):this.zoomWithVelocity(n)}},{key:"zoomWithVelocity",value:function(e){var t=this;this.cameraService.setCameraZoom(e),requestAnimationFrame((function(){e*=.85,Math.abs(e)>1&&t.zoomWithVelocity(e)}))}},{key:"handleContextMenu",value:function(e){e.preventDefault();var t=e.offsetX,n=e.offsetY,i=this.getHit(t,n),o=this.getNodeFromHit(i);this.store.dispatch(new He(o,i))}},{key:"handlePanStart",value:function(e){}},{key:"handlePanEnd",value:function(e){var t=this.store.selectSnapshot(Ar.getCameraMotion);if(!(this.pinchTicks>0||t.panX===e.velocityX&&t.panY===e.velocityY)){var n=this.store.selectSnapshot(Ar.getPanMode);e.srcEvent.shiftKey||"pan"===n?(t.panX=e.velocityX*sf.Pan,t.panY=e.velocityY*sf.Pan):(t.rotateX=e.velocityX*sf.Rotate,t.rotateY=e.velocityY*sf.Rotate),t.applyFriction=!0,this.store.dispatch(new Gt(t))}}},{key:"handlePinchEnd",value:function(e){var t=this.store.selectSnapshot(Ar.getCameraMotion);if("pan"===this.pinchMode)t.panX=e.velocityX*sf.Pan,t.panY=e.velocityY*sf.Pan;else{var n=e.velocity>0?1:-1;t.zoom=Math.sqrt(e.velocityX*e.velocityX+e.velocityY*e.velocityY)*-n*sf.Zoom}t.applyFriction=!0,this.store.dispatch(new Gt(t)),this.pinchTicks=10}},{key:"handleTap",value:function(e){var t=this.getOffset(e),n=t.offsetX,i=t.offsetY,o=this.getHit(n,i),r=this.getNodeFromHit(o);this.store.dispatch(new Be(r,e,o))}},{key:"handleDoubleTap",value:function(e){var t=this.getOffset(e),n=t.offsetX,i=t.offsetY,o=this.getHit(n,i),r=this.getNodeFromHit(o);r&&this.store.dispatch(new Qe(r.id))}},{key:"handlePress",value:function(e){var t=this.getOffset(e),n=t.offsetX,i=t.offsetY,o=this.getHit(n,i),r=this.getNodeFromHit(o);r&&this.store.dispatch(new Qe(r.id))}},{key:"handlePan",value:function(e){if(!(this.pinchTicks>0)){var t=this.store.selectSnapshot(Ar.getPanMode),n=e.velocityX,i=e.velocityY;e.srcEvent.shiftKey||"pan"===t?this.cameraService.setCameraPan(n*sf.Pan,i*sf.Pan):this.cameraService.setCameraRotation(n*sf.Rotate,i*sf.Rotate)}}},{key:"handleMouseInputEngineTick",value:function(){var e=this.cameraService.tickCameraRotation(),t=this.cameraService.tickCameraPan(),n=this.cameraService.tickCameraZoom(),i=Math.min(15,(window.performance.now()-this.deltaTime)/16.666666666666668);if((e.vx||e.vy)&&this.cameraService.rotateCameraStatic(0!==e.vx?i*e.vx*af.Rotate:0,0!==e.vy?i*e.vy*af.Rotate:0),t.x||t.y){var o=Math.max(Human.renderer.camera.lookDistance/80,.01);this.cameraService.panCameraStatic(i*t.x*o*af.Pan,i*t.y*o*af.Pan,i*t.z*o*af.Pan)}0!==n&&this.cameraService.setHumanZoom(i*n*af.Zoom)}},{key:"handleCameraTick",value:function(){this.pinchTicks>0&&this.pinchTicks--,this.applyFriction();var e=this.store.selectSnapshot(Ar.getCameraMotion);this.cameraService.setCameraPan(e.panX,e.panY),this.cameraService.setCameraRotation(e.rotateX,e.rotateY),this.cameraService.setCameraZoom(e.zoom)}},{key:"getFriction",value:function(e){if(0===e)return 0;var t=(window.performance.now()-this.deltaTime)/16.666666666666668,n=e*Math.max(0,sf.Friction+.1*(1-t));return Math.abs(n)<sf.FrictionThreshold&&(n=0),n}},{key:"applyFriction",value:function(){var e=this.store.selectSnapshot(Ar.getCameraMotion);!0===e.applyFriction&&(e.rotateX=this.getFriction(e.rotateX),e.rotateY=this.getFriction(e.rotateY),e.panX=this.getFriction(e.panX),e.panY=this.getFriction(e.panY),e.zoom=this.getFriction(e.zoom),0===e.rotateX&&0===e.rotateY&&0===e.panX&&0===e.panY&&0===e.zoom&&(e.applyFriction=!1),this.store.dispatch(new Gt(e)))}},{key:"flyToObject",value:function(e,t){Human.renderer.camera.fly.flyTo({objectId:e,animationDuration:t})}},{key:"jumpToObject",value:function(e){Human.renderer.camera.fly.jumpTo({objectId:e})}},{key:"flyToPoint",value:function(e,t){var n=this;Human.renderer.camera.fly.flyTo(Object.assign(Object.assign({},e),{animationDuration:t}),(function(){n.store.dispatch(new Kt)}))}},{key:"jumpToPoint",value:function(e){Human.renderer.camera.fly.jumpTo(e)}},{key:"getNodeFromHit",value:function(e){var t;if(e.objectId){var n=this.store.selectSnapshot(Wr.getViewGraph);t=this.engineService.getNode(n,e.objectId)}return t}},{key:"getHit",value:function(e,t){return Human.renderer.pick.pick(e,t,{rayPick:!0})}},{key:"getOffset",value:function(e){var t=0,n=0;e.center?(t=e.center.x,n=e.center.y):(t=e.clientX,n=e.clientY);var i=this.engineElement.nativeElement.getBoundingClientRect();return{offsetX:t-i.left,offsetY:n-i.top}}},{key:"playAudio",value:function(e){e=Object(Se.isNil)(e)?this.store.selectSnapshot(Wr.getPlayAudio):e,this.mediaService.stopAudio();var t=this.store.selectSnapshot(Lr.getSelectedChapterAudio),n=Object(Se.get)(t,"data.fullUrl");if(n){var i=this.mediaService.getAudioPlayer(n);i||(i=this.mediaService.addAudioPlayer(n)),e?i.play():i.stop()}}},{key:"playChapterFromStart",value:function(){var e=this.store.selectSnapshot(Lr.getSelectedChapter);this.playAudio(),this.store.dispatch(new Ye(e)),this.store.dispatch(new et(!0))}},{key:"isTransparentBackground",value:function(e){return!!e&&ai.isTransparent(this.background.getValue())}},{key:"isBackgroundCheckered",value:function(e){return U.application!==M.Viewer&&this.isTransparentBackground(e)}}]),e}()).\u0275fac=function(e){return new(e||ef)(P.Pb(E.b),P.Pb(gn),P.Pb(Eo),P.Pb(P.i),P.Pb(Nt),P.Pb(ec),P.Pb(ic),P.Pb(ac),P.Pb(P.H),P.Pb(E.g))},ef.\u0275cmp=P.Jb({type:ef,selectors:[["app-engine"]],viewQuery:function(e,t){var n;1&e&&(P.Gc($h,!0),P.Gc(Kh,!0),P.Gc(Gh,!0)),2&e&&(P.uc(n=P.dc())&&(t.engineElement=n.first),P.uc(n=P.dc())&&(t.engineCanvasElement=n.first),P.uc(n=P.dc())&&(t.engineAnnotationsElement=n.first))},hostBindings:function(e,t){1&e&&P.cc("wheel",(function(e){return t.wheel(e)}))("contextmenu",(function(e){return t.contextmenu(e)}))("mouseout",(function(e){return t.mouseout(e)}))},inputs:{inputEnabled:"inputEnabled"},decls:14,vars:7,consts:[["id","container","data-test","engine","role","main",1,"engine"],["engine",""],["id","theCanvas","data-test","engineCanvas",1,"engine__canvas"],["engineCanvas",""],["id","annotationCanvas",1,"engine__annotations"],["engineAnnotations",""],[3,"node","hit",4,"ngIf"],["data-test","engineInputBlocker","class","engine__input-blocking",4,"ngIf"],["data-test","engineProgressBar",4,"ngIf"],[4,"appFlagApplication"],[3,"node","hit"],["data-test","engineInputBlocker",1,"engine__input-blocking"],["data-test","engineProgressBar"]],template:function(e,t){1&e&&(P.Vb(0,"div",0,1),P.Qb(2,"canvas",2,3),P.Qb(4,"canvas",4,5),P.Qb(6,"app-labels"),P.Kc(7,Zh,1,2,"app-engine-contextmenu",6),P.Kc(8,Jh,1,0,"div",7),P.Kc(9,Xh,1,0,"app-engine-progress",8),P.hc(10,"async"),P.Qb(11,"app-engine-scroll"),P.Qb(12,"app-engine-fade"),P.Kc(13,Yh,2,0,"ng-container",9),P.Ub()),2&e&&(P.Eb("data-progress",t.progress),P.Db(7),P.lc("ngIf",t.contextmenuNode),P.Db(1),P.lc("ngIf",!t.inputEnabled),P.Db(1),P.lc("ngIf",P.ic(10,5,t.showProgressBar$)),P.Db(4),P.lc("appFlagApplication",t.application.Loft))},directives:[_h,ra.l,Lh,Ah,bl,Rh,Hh,Qh],pipes:[ra.b],styles:[".engine[_ngcontent-%COMP%]{-webkit-tap-highlight-color:rgba(0,0,0,0);-webkit-tap-highlight-color:transparent;position:fixed;width:100vw;height:100vh;overflow:hidden;visibility:hidden;z-index:-1;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.engine__canvas[_ngcontent-%COMP%]{display:block;position:absolute;width:100%;height:100%;z-index:1}.engine__annotations[_ngcontent-%COMP%]{display:none}.engine--cursor-paint[_ngcontent-%COMP%]:hover{cursor:url(/assets/images/cursor-paint.png) 7 20,pointer}.engine--cursor-hide[_ngcontent-%COMP%]:hover{cursor:url(/assets/images/cursor-hide.png) 7 20,pointer}.engine--cursor-label[_ngcontent-%COMP%]:hover{cursor:url(/assets/images/cursor-label.png) 7 20,pointer}.engine--cursor-crosshair[_ngcontent-%COMP%]:hover{cursor:crosshair}.engine--checkered[_ngcontent-%COMP%]{background-color:#fff;background-size:24px 24px;background-position:0 0,12px 12px;background-image:linear-gradient(45deg,#d7e0ea 25%,transparent 0,transparent 75%,#d7e0ea 0,#d7e0ea),linear-gradient(45deg,#d7e0ea 25%,transparent 0,transparent 75%,#d7e0ea 0,#d7e0ea)}.engine__controls[_ngcontent-%COMP%]{position:absolute;right:16px;bottom:16px;z-index:2}.engine__progress[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;z-index:2}.engine__progress--hide[_ngcontent-%COMP%]{display:none}.engine__input-blocking[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0;z-index:3}@media (max-width:768px){.engine__controls[_ngcontent-%COMP%]{bottom:96px}}"],changeDetection:0}),qh([Object(E.d)(Wr.getReady),Wh("design:type",be.a)],ef.prototype,"ready$",void 0),qh([Object(E.d)(Wr.getViewGraph),Wh("design:type",be.a)],ef.prototype,"viewGraph$",void 0),qh([Object(E.d)(Wr.getEnginePosition),Wh("design:type",be.a)],ef.prototype,"enginePosition$",void 0),qh([Object(E.d)(Wr.getHoveredNode),Wh("design:type",be.a)],ef.prototype,"hoveredNode$",void 0),qh([Object(E.d)(Wr.getChapter),Wh("design:type",be.a)],ef.prototype,"chapter$",void 0),qh([Object(E.d)(Wr.getChapterInit),Wh("design:type",be.a)],ef.prototype,"chapterInit$",void 0),qh([Object(E.d)(Ai.getCheckedNodes),Wh("design:type",be.a)],ef.prototype,"checkedNodes$",void 0),qh([Object(E.d)(Wr.getActiveTool),Wh("design:type",be.a)],ef.prototype,"activeTool$",void 0),qh([Object(E.d)(Wr.getAnimationPlaying),Wh("design:type",be.a)],ef.prototype,"animationPlaying$",void 0),qh([Object(E.d)(Wr.getAutoplay),Wh("design:type",be.a)],ef.prototype,"autoplay$",void 0),qh([Object(E.d)(Wr.getPlayAudio),Wh("design:type",be.a)],ef.prototype,"playAudio$",void 0),qh([Object(E.d)(Wr.getDisplay),Wh("design:type",be.a)],ef.prototype,"engineDisplay$",void 0),qh([Object(E.d)(Wr.getVisible),Wh("design:type",be.a)],ef.prototype,"engineVisible$",void 0),qh([Object(E.d)(Wr.getShowProgressBar),Wh("design:type",be.a)],ef.prototype,"showProgressBar$",void 0),qh([Object(E.d)(Wr.getContextmenu),Wh("design:type",be.a)],ef.prototype,"contextmenu$",void 0),qh([Object(E.d)(Lr.getSelectedChapter),Wh("design:type",be.a)],ef.prototype,"selectedChapter$",void 0),qh([Object(E.d)(Lr.getSelectedChapterId),Wh("design:type",be.a)],ef.prototype,"selectedChapterId$",void 0),qh([Object(E.d)(Lr.getSelectedChapterReadyState),Wh("design:type",be.a)],ef.prototype,"readyState$",void 0),qh([Object(E.d)(Lr.getSelectedChapterClippingPlanes),Wh("design:type",be.a)],ef.prototype,"clippingPlanes$",void 0),qh([Object(E.d)(Ar.getCameraMotion),Wh("design:type",be.a)],ef.prototype,"cameraMotion$",void 0),qh([Object(E.d)(Lr.getSelectedChapterBackground),Wh("design:type",be.a)],ef.prototype,"background$",void 0),ef),pf=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},df=((tf=function(){function e(t,n,i,o){m(this,e),this.store=t,this.router=n,this.ga=i,this.pendoService=o,this.title="Biodigital Human",this.ngUnsubscribe=new fe.a}return v(e,[{key:"ngOnInit",value:function(){this.initPendo(),this.initPageAnalytics(),this.initInputObserver()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initPendo",value:function(){this.pendoService.appendScript(),this.pendoService.initialize({visitor:{id:""},account:{}})}},{key:"initInputObserver",value:function(){var e=this;this.inputEnabled$.pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){e.store.dispatch(new j.SetInputEnabled(t))}))}},{key:"initPageAnalytics",value:function(){var e=this;this.router.events.pipe(Object(me.a)((function(e){return e instanceof Oe.c})),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){e.ga.pageView(t.urlAfterRedirects)}))}}]),e}()).\u0275fac=function(e){return new(e||tf)(P.Pb(E.g),P.Pb(Oe.e),P.Pb(Ce.c),P.Pb(je))},tf.\u0275cmp=P.Jb({type:tf,selectors:[["app-root"]],decls:3,vars:3,consts:[[3,"inputEnabled"]],template:function(e,t){1&e&&(P.Qb(0,"app-engine",0),P.hc(1,"async"),P.Qb(2,"router-outlet")),2&e&&P.lc("inputEnabled",P.ic(1,1,t.inputEnabled$))},directives:[uf,Oe.g],pipes:[ra.b],styles:[""],changeDetection:0}),function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);r>3&&a&&Object.defineProperty(t,n,a)}([Object(E.d)(he.getInputEnabled),pf("design:type",be.a)],tf.prototype,"inputEnabled$",void 0),tf),gf=h("imBb"),hf=h("7sSR"),ff=function(e){return e[e.Main=0]="Main",e[e.Media=1]="Media",e[e.Tools=2]="Tools",e[e.Whiteboard=3]="Whiteboard",e[e.VisibilityLayers=4]="VisibilityLayers",e[e.Empty=5]="Empty",e}({}),bf=((nf=function(){function e(t,n,i){m(this,e),this.store=t,this.engineService=n,this.viewService=i}return v(e,[{key:"startQuiz",value:function(){this.viewService.toggleColumn(!0),this.store.dispatch(new io.SetQuizActive(!0));var e=this.store.selectSnapshot(_o.getAllQuestions)[0].id;this.store.dispatch(new io.SetActiveQuestion(e))}},{key:"resetQuiz",value:function(){this.store.dispatch(new io.SetQuizActive(!1)),this.store.dispatch(new io.SetActiveSubmission(void 0)),this.store.dispatch(new io.ClearSubmissions),this.store.dispatch(new io.SetQuizLifecycle(fo.Question))}},{key:"exitQuiz",value:function(){var e=this;this.resetQuiz(),setTimeout((function(){e.store.dispatch(new $t(e.store.selectSnapshot(Lr.getChapterCamera),!1))}))}},{key:"submitQuestion",value:function(e,t){var n=this.store.selectSnapshot(_o.getAllQuestions).find((function(t){return t.id===e})),i=this.store.selectSnapshot(_o),o=i.launchMode,r=i.quizSettings;this.store.dispatch(new io.SubmitQuestionAnswer({questionId:n.id,answer:t})),this.store.dispatch(new io.SetActiveSubmission({questionId:n.id,answer:t})),this.engineService.fireEvent(Dt.QuizAnswerSubmitted,{questionId:n.id,answer:t}),o===mo.Learning&&n.type!==co.Instructions&&!1!==r.showExplanation?this.store.dispatch(new io.SetQuizLifecycle(fo.Explanation)):this.nextQuestion()}},{key:"nextQuestion",value:function(){this.store.selectSnapshot(_o.hasQuestionRemaining)?(this.store.dispatch(new io.SetQuizLifecycle(fo.Question)),this.store.dispatch(new io.NextQuestion)):(this.store.dispatch(new io.SetQuizLifecycle(fo.Review)),this.engineService.fireEvent(Dt.QuizCompleted,!0))}}]),e}()).\u0275fac=function(e){return new(e||nf)(P.Zb(E.g),P.Zb(Nt),P.Zb(td))},nf.\u0275prov=P.Lb({token:nf,factory:nf.\u0275fac,providedIn:"root"}),nf);function vf(e){if(null==e)return"";var t=new RegExp(/[^a-zA-Z0-9_]/,"gi");return e.replace(t,"_")}!function(e){e.normalize=function(e){return(""+(e||"")).replace(/&#(\d+);/g,(function(e,t){return String.fromCharCode(t)})).replace(/(&.+;)/gi,(function(e,t){return String.fromCharCode(e.charCodeAt(0))}))},e.prettyPrint=function(e){return(""+(e||"")).trim().replace(/([A-Z])/g," $1").replace(/^./,(function(e){return e.toUpperCase()})).trim()},e.parseEmails=function(e){return e.split(",").map((function(e){return e.trim()})).filter((function(e){return!!e}))},e.validateEmail=function(e){return/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/.test(e)}}(of||(of={}));var mf,yf=h("wf0l"),xf=((mf=function(){function e(){m(this,e)}return v(e,[{key:"transform",value:function(e,t){return vf(e)}}]),e}()).\u0275fac=function(e){return new(e||mf)},mf.\u0275pipe=P.Ob({name:"elementID",type:mf,pure:!0}),mf),kf=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},wf=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Of=["chapterList"],Cf=function(e,t){return{"view-chapters__item--viewed":e,"view-chapters__item--selected":t}};function Sf(e,t){if(1&e){var n=P.Wb();P.Vb(0,"li",3),P.cc("click",(function(){P.zc(n);var e=t.$implicit;return P.gc().handleChapterClick(e)}))("keyup.enter",(function(){P.zc(n);var e=t.$implicit;return P.gc().handleChapterClick(e)})),P.hc(1,"async"),P.hc(2,"elementID"),P.hc(3,"async"),P.Vb(4,"div",4),P.Mc(5),P.Ub(),P.Vb(6,"div",5),P.Mc(7),P.Ub(),P.Qb(8,"div",6),P.Ub()}if(2&e){var i,o=t.$implicit,r=t.index,a=P.gc();P.lc("gaLabel","Chapter "+(r+1)+" of "+(null==(i=P.ic(1,8,a.chapters$))?null:i.length))("ngClass",P.pc(14,Cf,a.isViewed(o.id),o.id===P.ic(3,12,a.selectedChapterId$))),P.Eb("aria-label",o.info.displayName)("data-chapter-id",P.ic(2,10,o.id)),P.Db(5),P.Oc("",r+1,"."),P.Db(2),P.Nc(o.info.displayName),P.Db(1),P.lc("defaultImage",a.defaultImage)("lazyLoad",a.getChapterThumb(o.id))}}var _f,jf=((_f=function(){function e(t,n,i){m(this,e),this.store=t,this.viewService=n,this.changeDetectorRef=i,this.defaultImage="/assets/images/view-chapter-thumbnail-placeholder.png",this.autoscroll=!0,this.ngUnsubscribe=new fe.a,this.nextChapter=null}return v(e,[{key:"ngOnInit",value:function(){this.initChaptersObserver()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"ngAfterViewInit",value:function(){this.initScrollObserver()}},{key:"initChaptersObserver",value:function(){var e=this;Object(Gr.b)([this.store.select(Lr.getStoryChapters),this.store.select(Lr.getSelectedChapterIndex)]).pipe(Object(ea.a)(300),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){var n=p(t,2),i=n[0],o=n[1]+1;e.nextChapter=o>=i.length?null:i[o],e.changeDetectorRef.markForCheck()}))}},{key:"initScrollObserver",value:function(){var e=this;this.selectedChapterId$.pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){e.scrollChapterIntoView(t)}))}},{key:"handleChapterClick",value:function(e){this.viewService.selectChapter(e)}},{key:"getChapterThumb",value:function(e){var t=this.store.selectSnapshot(Lr.getRegisteredThumbnails).get(e);return t?t.snapshot||t.urls.small:""}},{key:"scrollChapterIntoView",value:function(e){var t=vf(e);if(t){var n=this.chapterList.nativeElement.querySelector("[data-chapter-id=".concat(t,"]"));n&&this.autoscroll&&"scrollBehavior"in document.documentElement.style&&n.scrollIntoView({behavior:"auto",block:"nearest"})}}},{key:"isViewed",value:function(e){return this.store.selectSnapshot(Lr.getChaptersViewed).some((function(t){return t===e}))}}]),e}()).\u0275fac=function(e){return new(e||_f)(P.Pb(E.g),P.Pb(td),P.Pb(P.i))},_f.\u0275cmp=P.Jb({type:_f,selectors:[["app-view-chapters"]],viewQuery:function(e,t){var n;1&e&&P.Rc(Of,!0),2&e&&P.uc(n=P.dc())&&(t.chapterList=n.first)},inputs:{defaultImage:"defaultImage",autoscroll:"autoscroll"},decls:6,vars:6,consts:[["aria-label","Chapters","role","navigation","gaCategory","View Chapter List",1,"view-chapters",3,"hidden"],["chapterList",""],["gaEvent","","gaAction","Clicked Chapter","role","button","class","view-chapters__item","tabindex","0",3,"gaLabel","ngClass","click","keyup.enter",4,"ngFor","ngForOf"],["gaEvent","","gaAction","Clicked Chapter","role","button","tabindex","0",1,"view-chapters__item",3,"gaLabel","ngClass","click","keyup.enter"],[1,"view-chapters__index"],[1,"view-chapters__title"],[1,"view-chapters__thumb",3,"defaultImage","lazyLoad"]],template:function(e,t){var n;(1&e&&(P.Vb(0,"nav",0,1),P.hc(2,"async"),P.Vb(3,"ol"),P.Kc(4,Sf,9,17,"li",2),P.hc(5,"async"),P.Ub(),P.Ub()),2&e)&&(P.lc("hidden",1===(null==(n=P.ic(2,2,t.chapters$))?null:n.length)),P.Db(4),P.lc("ngForOf",P.ic(5,4,t.chapters$)))},directives:[Ce.a,ra.k,Ce.b,ra.i,yf.a],pipes:[ra.b,xf],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3838}.text-info{color:#0060c4}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.view-chapters{max-height:320px;overflow:auto}.view-chapters__header{border-top:var(--view-chapters-border);display:flex;align-items:center;padding:16px 0;margin-top:16px}.view-chapters__next{font-size:14px;letter-spacing:.35px;line-height:1.4em;font-style:italic;padding:8px;border-radius:4px;flex-grow:1}.view-chapters__next:hover{background:var(--view-chapters-bg--hover);color:var(--view-chapters-color--hover);cursor:pointer}.view-chapters__toggle{justify-content:flex-end;flex-shrink:1;text-align:right;margin-left:4px}.view-chapters__item{font-size:14px;letter-spacing:.35px;line-height:1.4em;display:flex;padding:8px;margin:4px;border-radius:2px;border-left:4px solid transparent;background-color:transparent;color:#131c2a;border-left:var(--view-chapters-border);background-color:var(--view-chapters-bg);color:var(--view-chapters-color);transition:background-color 125ms,color 125ms,border 125ms}.view-chapters__item:hover{cursor:pointer;background:var(--view-chapters-bg--hover)}.view-chapters__item:focus{background:#f1f4fa;outline:none}.view-chapters__item--selected{border-left:4px solid #2d72dc;background-color:#f1f5fc;background:var(--view-chapters-bg--selected);border-left:var(--view-chapters-border--selected)}.view-chapters__index{display:flex;flex:0 0 32px;justify-content:center}.view-chapters__thumb{background-color:#f9fafd;background-color:var(--view-chapters-thumb-bg);border-radius:4px;background-repeat:no-repeat;flex:0 0 56px;height:56px;width:56px;transition:border-color .1s}.view-chapters__title{word-wrap:break-word;overflow-wrap:break-word;display:flex;flex:1 1 auto;padding-right:4px}.view-chapters__thumb{background-size:cover}"],encapsulation:2,changeDetection:0}),kf([Object(E.d)(Lr.getStoryChapters),wf("design:type",be.a)],_f.prototype,"chapters$",void 0),kf([Object(E.d)(Lr.getSelectedChapterId),wf("design:type",be.a)],_f.prototype,"selectedChapterId$",void 0),kf([Object(E.d)(Lr.getSelectedChapterIndex),wf("design:type",be.a)],_f.prototype,"selectedChapterIndex$",void 0),kf([Object(E.d)(Lr.getRegisteredThumbnails),wf("design:type",be.a)],_f.prototype,"thumbnails$",void 0),kf([Object(E.d)(Lr.getChaptersViewed),wf("design:type",be.a)],_f.prototype,"chaptersViewed$",void 0),_f),Pf=h("rDax"),Mf=function(){function e(t,n,i){var o=this;m(this,e),this.overlay=t,this.content=n,this.data=i,this.afterClosed=new fe.a,this.afterClosed$=this.afterClosed.asObservable(),t.backdropClick().subscribe((function(){return o._close("backdropClick",i)}))}return v(e,[{key:"close",value:function(e){this._close("close",e)}},{key:"_close",value:function(e,t){this.overlay.dispose(),this.afterClosed.next({type:e,data:t}),this.afterClosed.complete()}}]),e}(),If=h("+rOU");function zf(e,t){if(1&e&&P.Qb(0,"div",4),2&e){var n=P.gc();P.lc("innerHTML",n.content,P.Ac)}}function Tf(e,t){1&e&&P.Rb(0)}function Uf(e,t){if(1&e&&(P.Tb(0),P.Kc(1,Tf,1,0,"ng-container",5),P.Sb()),2&e){var n=P.gc();P.Db(1),P.lc("ngTemplateOutlet",n.content)("ngTemplateOutletContext",n.context)}}function Lf(e,t){1&e&&P.Rb(0)}function Df(e,t){if(1&e&&(P.Tb(0),P.Kc(1,Lf,1,0,"ng-container",6),P.Sb()),2&e){var n=P.gc();P.Db(1),P.lc("ngComponentOutlet",n.content)}}var Ef,Ff,Af,Rf=((Ef=function(){function e(t){m(this,e),this.popupRef=t,this.renderMethod="component"}return v(e,[{key:"ngOnInit",value:function(){this.content=this.popupRef.content,"string"==typeof this.content?this.renderMethod="text":this.content instanceof P.O&&(this.renderMethod="template",this.context={close:this.popupRef.close.bind(this.popupRef)})}}]),e}()).\u0275fac=function(e){return new(e||Ef)(P.Pb(Mf))},Ef.\u0275cmp=P.Jb({type:Ef,selectors:[["app-popup"]],decls:5,vars:4,consts:[[1,"popup"],[3,"ngSwitch"],[3,"innerHTML",4,"ngSwitchCase"],[4,"ngSwitchCase"],[3,"innerHTML"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[4,"ngComponentOutlet"]],template:function(e,t){1&e&&(P.Vb(0,"div",0),P.Tb(1,1),P.Kc(2,zf,1,1,"div",2),P.Kc(3,Uf,2,2,"ng-container",3),P.Kc(4,Df,2,1,"ng-container",3),P.Sb(),P.Ub()),2&e&&(P.Db(1),P.lc("ngSwitch",t.renderMethod),P.Db(1),P.lc("ngSwitchCase","text"),P.Db(1),P.lc("ngSwitchCase","template"),P.Db(1),P.lc("ngSwitchCase","component"))},directives:[ra.n,ra.o,ra.q,ra.j],styles:["[_nghost-%COMP%]{width:100%;height:100%}.popup[_ngcontent-%COMP%]{background:#fff;border-radius:4px;padding:8px;overflow-y:auto;box-shadow:1px -1px 2px 0 rgba(28,42,63,.1),0 1px 2px 0 rgba(28,42,63,.3)}"],changeDetection:0}),Ef),Vf=function(e){return e.Above="above",e.Below="below",e.Left="left",e.Right="right",e}({}),Nf=(u(y={},Vf.Above,{originX:"center",originY:"top",overlayX:"center",overlayY:"bottom",offsetY:-12}),u(y,Vf.Below,{originX:"center",originY:"bottom",overlayX:"center",overlayY:"top",offsetY:12}),u(y,Vf.Left,{originX:"start",originY:"center",overlayX:"end",overlayY:"center",offsetX:-12}),u(y,Vf.Right,{originX:"end",originY:"center",overlayX:"start",overlayY:"center",offsetX:12}),y),Bf=((Af=function(){function e(t,n){m(this,e),this.overlay=t,this.injector=n}return v(e,[{key:"open",value:function(e){var t=e.origin,n=e.content,i=e.data,o=e.width,r=e.height,a=this.overlay.create(this.getOverlayConfig({origin:t,width:o,height:r})),s=new Mf(a,n,i),c=this.createInjector(s,this.injector);return a.attach(new If.c(Rf,null,c)),s}},{key:"createInjector",value:function(e,t){var n=new WeakMap([[Mf,e]]);return new If.e(t,n)}},{key:"getPositionStrategy",value:function(e,t){return this.overlay.position().flexibleConnectedTo(e).withPositions(this.getPositions(t))}},{key:"getOverlayConfig",value:function(e){var t=e.origin,n=e.width,i=e.height;return new Pf.d({width:n,height:i,hasBackdrop:!0,backdropClass:"popup-scrim",positionStrategy:this.getOverlayPosition(t),scrollStrategy:this.overlay.scrollStrategies.reposition()})}},{key:"getOverlayPosition",value:function(e,t){return t=t||[Vf.Above,Vf.Below,Vf.Left,Vf.Right],this.overlay.position().flexibleConnectedTo(e).withPositions(this.getPositions(t)).withPush(!0)}},{key:"getPositions",value:function(e){return e.map((function(e){return Nf[e]}))}}]),e}()).\u0275fac=function(e){return new(e||Af)(P.Zb(Pf.c),P.Zb(P.t))},Af.\u0275prov=P.Lb({token:Af,factory:Af.\u0275fac,providedIn:"root"}),Af),Hf=((Ff=function(){function e(){m(this,e)}return v(e,[{key:"transform",value:function(e,t){return of.normalize(""+(e||""))}}]),e}()).\u0275fac=function(e){return new(e||Ff)},Ff.\u0275pipe=P.Ob({name:"textNormalize",type:Ff,pure:!0}),Ff),Qf=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},qf=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Wf=["title"],$f=function(e){return{"view-description__story-title--large":e}};function Kf(e,t){if(1&e&&(P.Vb(0,"div",6),P.Mc(1),P.Ub()),2&e){var n=P.gc();P.lc("ngClass",P.oc(2,$f,!n.chapterTitle)),P.Db(1),P.Oc(" ",n.storyTitle," ")}}function Gf(e,t){if(1&e&&(P.Vb(0,"span"),P.Mc(1),P.hc(2,"async"),P.Ub()),2&e){var n=P.gc();P.Db(1),P.Oc("",P.ic(2,1,n.chapterIndex$)+1,".")}}function Zf(e,t){1&e&&P.Qb(0,"app-icon",7)}var Jf,Xf=function(e,t,n){return{"view-title--clickable":e,"view-title--center":t,"view-title--large":n}},Yf=((Jf=function(){function e(t,n,i,o){m(this,e),this.layoutService=t,this.changeDetectorRef=n,this.popupService=i,this.store=o,this._isPopulated=!1,this.isPopulatedChange=new P.p,this._menuEnabled=!0,this.viewLayout=$u,this.ngUnsubscribe=new fe.a,this.storyTitle="",this.chapterTitle=""}return v(e,[{key:"isPopulated",get:function(){return this._isPopulated},set:function(e){this._isPopulated=e,this.isPopulatedChange.emit(this.isPopulated)}},{key:"menuEnabled",get:function(){return this._menuEnabled},set:function(e){this._menuEnabled=e}},{key:"ngOnInit",value:function(){this.initContentListener(),this.initLayoutListener(),this.initChapterListener()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"isEnabled",value:function(e){return this.layoutService.isUIEnabled(e)}},{key:"initContentListener",value:function(){var e=this;Object(Gr.b)(this.story$,this.chapter$).pipe(Object(me.a)((function(e){var t=p(e,2),n=t[0];return null!=t[1]&&null!=n})),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){var n=p(t,2),i=n[0],o=n[1];e.chapterTitle=of.normalize(o.info.displayName),e.storyTitle=U.application!==M.Viewer?of.normalize(i.displayName):"",e.chapterTitle=of.normalize(o.info.displayName),e.isPopulated=!!e.chapterTitle||!!e.storyTitle}))}},{key:"initLayoutListener",value:function(){var e=this;this.layout$.pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){e.changeDetectorRef.markForCheck()}))}},{key:"initChapterListener",value:function(){var e=this;this.store.select(Lr.getSelectedChapterIndex).pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(){e.chaptersPopup&&e.chaptersPopup.close()}))}},{key:"handleTitleClick",value:function(){var e=this;this.menuEnabled&&(this.chaptersPopup?this.chaptersPopup.close():(this.chaptersPopup=this.popupService.open({origin:this.title.nativeElement,content:jf,width:"300px"}),this.chaptersPopup.afterClosed$.pipe(Object(ve.a)(this.ngUnsubscribe),Object(Ou.a)(1)).subscribe((function(t){e.chaptersPopup=null}))))}}]),e}()).\u0275fac=function(e){return new(e||Jf)(P.Pb(Yu),P.Pb(P.i),P.Pb(Bf),P.Pb(E.g))},Jf.\u0275cmp=P.Jb({type:Jf,selectors:[["app-view-title"]],viewQuery:function(e,t){var n;1&e&&P.Rc(Wf,!0),2&e&&P.uc(n=P.dc())&&(t.title=n.first)},inputs:{size:"size",alignTitle:"alignTitle",isPopulated:"isPopulated",menuEnabled:"menuEnabled"},outputs:{isPopulatedChange:"isPopulatedChange"},features:[P.Cb([Bf])],decls:11,vars:17,consts:[[1,"view-title",3,"ngClass","click"],["title",""],["class","view-title__story",3,"ngClass",4,"ngIf"],[1,"view-title__chapter"],[4,"ngIf"],["icon","caret-down",4,"ngIf"],[1,"view-title__story",3,"ngClass"],["icon","caret-down"]],template:function(e,t){1&e&&(P.Vb(0,"header",0,1),P.cc("click",(function(){return t.handleTitleClick()})),P.hc(2,"async"),P.Kc(3,Kf,2,4,"div",2),P.Vb(4,"h1",3),P.Kc(5,Gf,3,3,"span",4),P.hc(6,"async"),P.Mc(7),P.hc(8,"textNormalize"),P.Kc(9,Zf,1,0,"app-icon",5),P.hc(10,"async"),P.Ub(),P.Ub()),2&e&&(P.lc("ngClass",P.qc(13,Xf,P.ic(2,5,t.chapterCount$)>1&&t.menuEnabled,"center"===t.alignTitle,"large"===t.size)),P.Db(3),P.lc("ngIf",t.storyTitle&&t.storyTitle!=t.chapterTitle),P.Db(2),P.lc("ngIf",P.ic(6,7,t.chapterCount$)>1&&t.menuEnabled),P.Db(2),P.Oc(" ",P.ic(8,9,t.chapterTitle)," "),P.Db(2),P.lc("ngIf",P.ic(10,11,t.chapterCount$)>1&&t.menuEnabled))},directives:[ra.i,ra.l,nl],pipes:[ra.b,Hf],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3838}.text-info{color:#0060c4}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.view-title{font-size:14px;letter-spacing:.35px;line-height:1.4em;word-wrap:break-word;overflow-wrap:break-word;border-radius:4px;padding:4px;margin:0 -4px;transition:background-color 125ms}.view-title--center{text-align:center}.view-title--large{font-size:18px;letter-spacing:.45px;line-height:1.4em}.view-title--clickable:hover{background-color:var(--view-title-background--hover);cursor:pointer}.view-title__story{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase;word-wrap:break-word;overflow-wrap:break-word;font-weight:600;color:var(--view-description-secondary-color)}.view-title__chapter{font-weight:600;color:var(--view-title-color)}"],encapsulation:2,changeDetection:0}),Qf([Object(E.d)(Hs.getStory),qf("design:type",be.a)],Jf.prototype,"story$",void 0),Qf([Object(E.d)(Lr.getSelectedChapter),qf("design:type",be.a)],Jf.prototype,"chapter$",void 0),Qf([Object(E.d)(Lr.getChapterCount),qf("design:type",be.a)],Jf.prototype,"chapterCount$",void 0),Qf([Object(E.d)(Lr.getSelectedChapterIndex),qf("design:type",be.a)],Jf.prototype,"chapterIndex$",void 0),Qf([Object(E.d)(ku.getUI),qf("design:type",be.a)],Jf.prototype,"layout$",void 0),Jf);function eb(e,t){if(1&e&&(P.Vb(0,"div",2),P.Vb(1,"div",3),P.Mc(2),P.Ub(),P.jc(3,1,["class","view-panel__actions","actions",""]),P.Ub()),2&e){var n=P.gc();P.Db(2),P.Oc(" ",n.label," ")}}var tb,nb=["*",[["","actions",""]]],ib=function(e,t){return{"view-panel--padding-none":e,"view-panel--padding-dense":t}},ob=["*","[actions]"],rb=((tb=function(){function e(){m(this,e),this.label="",this.showHeader=!0,this.padding="normal"}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||tb)},tb.\u0275cmp=P.Jb({type:tb,selectors:[["app-view-panel"]],inputs:{label:"label",showHeader:"showHeader",padding:"padding"},ngContentSelectors:ob,decls:3,vars:5,consts:[[1,"view-panel",3,"ngClass"],["class","view-panel__header",4,"ngIf"],[1,"view-panel__header"],[1,"view-panel__label"]],template:function(e,t){1&e&&(P.kc(nb),P.Vb(0,"div",0),P.Kc(1,eb,4,1,"div",1),P.jc(2),P.Ub()),2&e&&(P.lc("ngClass",P.pc(2,ib,"none"===t.padding,"dense"===t.padding)),P.Db(1),P.lc("ngIf",t.showHeader))},directives:[ra.i,ra.l],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3838}.text-info{color:#0060c4}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.view-panel{padding:0 0 32px;margin-bottom:16px;border-bottom:var(--view-panel-border)}.view-panel--padding-none{padding:0;margin:0}.view-panel--padding-dense{padding:0 0 8px;margin:0 0 8px}.view-panel__label{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase;color:var(--view-panel-color);font-weight:600;display:flex;align-items:center;min-height:28px}.view-panel__header{display:flex;flex-direction:row;align-items:flex-start;justify-content:space-between;margin-bottom:16px}"],encapsulation:2,changeDetection:0}),tb),ab=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},sb=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function cb(e,t){if(1&e&&(P.Vb(0,"div",3),P.Qb(1,"app-html",4),P.Ub()),2&e){var n=P.gc();P.Db(1),P.lc("markdownText",n.chapterDescription)}}var lb,ub=function(e,t){return{"view-description--layout-column":e,"view-description--layout-drawer":t}},pb=((lb=function(){function e(t,n,i){m(this,e),this.viewService=t,this.layoutService=n,this.changeDetectorRef=i,this.viewLayout=$u,this.ngUnsubscribe=new fe.a,this.storyTitle="",this.chapterTitle="",this.chapterDescription="",this.chapterAudio=null,this.layout=Ku.Drawer,this._isPopulated=!1,this.isPopulatedChange=new P.p}return v(e,[{key:"isPopulated",get:function(){return this._isPopulated},set:function(e){this._isPopulated=e,this.isPopulatedChange.emit(this.isPopulated)}},{key:"ngOnInit",value:function(){this.initContentListener(),this.initLayoutListener()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"isEnabled",value:function(e){return this.layoutService.isUIEnabled(e)}},{key:"initContentListener",value:function(){var e=this;Object(Gr.b)(this.story$,this.chapter$).pipe(Object(me.a)((function(e){var t=p(e,2),n=t[0],i=t[1];return null!=n&&null!=i})),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){var n=p(t,2),i=n[0],o=n[1];e.storyTitle=U.application!==M.Viewer?of.normalize(i.displayName):"",e.chapterTitle=of.normalize(o.info.displayName),e.chapterDescription=Object(Se.trim)(o.info.description),e.isPopulated=""!==e.storyTitle||!!e.chapterTitle||!!e.chapterDescription}))}},{key:"initLayoutListener",value:function(){var e=this;this.layout$.pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){e.changeDetectorRef.markForCheck()}))}}]),e}()).\u0275fac=function(e){return new(e||lb)(P.Pb(td),P.Pb(Yu),P.Pb(P.i))},lb.\u0275cmp=P.Jb({type:lb,selectors:[["app-view-description"]],inputs:{layout:"layout",isPopulated:"isPopulated"},outputs:{isPopulatedChange:"isPopulatedChange"},decls:4,vars:5,consts:[[1,"view-description",3,"ngClass"],[1,"view-description__inner"],["class","view-description__body",4,"ngIf"],[1,"view-description__body"],[3,"markdownText"]],template:function(e,t){1&e&&(P.Vb(0,"div",0),P.Vb(1,"div",1),P.Vb(2,"article"),P.Kc(3,cb,2,1,"div",2),P.Ub(),P.Ub(),P.Ub()),2&e&&(P.lc("ngClass",P.pc(2,ub,"column"===t.layout,"drawer"===t.layout)),P.Db(3),P.lc("ngIf",t.chapterDescription))},directives:[ra.i,ra.l,cg],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3838}.text-info{color:#0060c4}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.view-description{color:var(--view-description-primary-color);display:flex;flex-direction:column;justify-content:left}.view-description--layout-column .view-description__chapter-title{font-size:18px;letter-spacing:.45px;line-height:1.4em}.view-description--layout-column .view-description__body{padding-top:12px}.view-description--layout-drawer .view-description__story-title{text-align:center}.view-description--layout-drawer .view-description__story-title--large{font-size:14px;letter-spacing:.35px;line-height:1.4em}.view-description--layout-drawer .view-description__body{padding-top:4px}.view-description__inner{flex:1 0 auto}.view-description__story-title{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase;word-wrap:break-word;overflow-wrap:break-word;flex-grow:1;font-weight:600;color:var(--view-description-secondary-color)}.view-description__story-title--large{font-size:18px;letter-spacing:.45px;line-height:1.4em;text-transform:none}.view-description__body{font-size:14px;letter-spacing:.35px;line-height:1.4em;word-wrap:break-word;overflow-wrap:break-word;padding-top:8px;color:var(--view-description-secondary-color)}"],encapsulation:2,changeDetection:0}),ab([Object(E.d)(Hs.getStory),sb("design:type",be.a)],lb.prototype,"story$",void 0),ab([Object(E.d)(Lr.getSelectedChapter),sb("design:type",be.a)],lb.prototype,"chapter$",void 0),ab([Object(E.d)(Lr.getSelectedChapterIndex),sb("design:type",be.a)],lb.prototype,"chapterIndex$",void 0),ab([Object(E.d)(Lr.getChapterCount),sb("design:type",be.a)],lb.prototype,"chapterCount$",void 0),ab([Object(E.d)(ku.getUI),sb("design:type",be.a)],lb.prototype,"layout$",void 0),lb);function db(e,t){if(1&e&&(P.Vb(0,"div",6),P.Mc(1),P.Ub()),2&e){var n=P.gc().$implicit;P.Db(1),P.Nc(n.description)}}function gb(e,t){if(1&e&&(P.Vb(0,"li",2),P.Qb(1,"div",3),P.Vb(2,"div",4),P.Vb(3,"div"),P.Mc(4),P.Ub(),P.Kc(5,db,2,1,"div",5),P.Ub(),P.Ub()),2&e){var n=t.$implicit,i=P.gc();P.Db(1),P.Hc("background-color",i.getComputedColor(n.colors)),P.Db(3),P.Nc(n.label),P.Db(1),P.lc("ngIf",n.description)}}var hb,fb=((hb=function(){function e(){m(this,e)}return v(e,[{key:"ngOnInit",value:function(){}},{key:"getComputedColor",value:function(e){return vr.rgbToHex(e,!0)}}]),e}()).\u0275fac=function(e){return new(e||hb)},hb.\u0275cmp=P.Jb({type:hb,selectors:[["app-view-legend"]],inputs:{legend:"legend"},decls:2,vars:1,consts:[["aria-label","Legend",1,"view-legend"],["class","view-legend__item","tabindex","0",4,"ngFor","ngForOf"],["tabindex","0",1,"view-legend__item"],[1,"view-legend__color","mh-2"],[1,"view-legend__content","text-14"],["class","mv-2",4,"ngIf"],[1,"mv-2"]],template:function(e,t){1&e&&(P.Vb(0,"ul",0),P.Kc(1,gb,6,4,"li",1),P.Ub()),2&e&&(P.Db(1),P.lc("ngForOf",t.legend))},directives:[ra.k,ra.l],styles:['.view-legend{display:flex;flex-direction:column}.view-legend__item{padding:8px 0;display:flex;flex-direction:row;justify-content:flex-start;align-items:flex-start}.view-legend__content{display:flex;flex-direction:column}.view-legend__color{content:" ";display:block;flex:0 0 16px;width:16px;height:16px;border-radius:50%}.view-legend__color:after{content:" "}'],encapsulation:2,changeDetection:0}),hb),bb=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},vb=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},mb=function(e){return{"view-labels__item--selected":e}};function yb(e,t){if(1&e){var n=P.Wb();P.Vb(0,"li",2),P.cc("click",(function(){P.zc(n);var e=t.$implicit;return P.gc().handleLabelClick(e)}))("keyup.enter",(function(){P.zc(n);var e=t.$implicit;return P.gc().handleLabelClick(e)})),P.hc(1,"async"),P.Vb(2,"div",3),P.Vb(3,"div",4),P.Qb(4,"app-label-pin",5),P.Ub(),P.Ub(),P.Vb(5,"div",6),P.Qb(6,"div",7),P.hc(7,"markdown"),P.Ub(),P.Ub()}if(2&e){var i,o=t.$implicit,r=P.gc();P.lc("ngClass",P.oc(9,mb,(null==(i=P.ic(1,5,r.selectedLabel$))?null:i.id)===o.id)),P.Eb("aria-label",o.title),P.Db(4),P.lc("label",o)("sequence",r.getLabelSequence(o)),P.Db(2),P.lc("innerHTML",P.ic(7,7,o.title),P.Ac)}}var xb,kb=((xb=function(){function e(t,n){m(this,e),this.viewService=t,this.store=n,this.labelPinType=Xn,this.labelSequentialtype=ei}return v(e,[{key:"ngOnInit",value:function(){}},{key:"getLabelSequence",value:function(e){return this.store.selectSnapshot(Is.getLabelSequence(e))}},{key:"handleLabelClick",value:function(e){this.viewService.selectLabel(e,!0)}}]),e}()).\u0275fac=function(e){return new(e||xb)(P.Pb(td),P.Pb(E.g))},xb.\u0275cmp=P.Jb({type:xb,selectors:[["app-view-labels"]],decls:3,vars:3,consts:[["role","complementary","aria-label","Labels",1,"view-labels"],["role","button","class","view-labels__item","tabindex","0",3,"ngClass","click","keyup.enter",4,"ngFor","ngForOf"],["role","button","tabindex","0",1,"view-labels__item",3,"ngClass","click","keyup.enter"],[1,"view-labels__pre"],[1,"view-labels__pin"],[3,"label","sequence"],[1,"view-labels__body"],[1,"view-labels__title","html",3,"innerHTML"]],template:function(e,t){1&e&&(P.Vb(0,"ul",0),P.Kc(1,yb,8,11,"li",1),P.hc(2,"async"),P.Ub()),2&e&&(P.Db(1),P.lc("ngForOf",P.ic(2,1,t.labels$)))},directives:[ra.k,ra.i,bd],pipes:[ra.b,Dd.b],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3838}.text-info{color:#0060c4}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.view-labels__item{border-left:4px solid transparent;border-left:var(--view-labels-border);border-radius:2px;display:flex;padding:12px 8px;margin-bottom:4px;cursor:pointer;transition:background-color 125ms,color 125ms,border 125ms}.view-labels__item:focus{background:#f1f4fa;outline:none}.view-labels__item:hover{background:#f1f5fc;background:var(--view-labels-bg--hover)}.view-labels__item--selected{background:#f1f5fc;border-left:4px solid #2d72dc;background:var(--view-labels-bg--selected);border-left:var(--view-labels-border--selected)}.view-labels__pre{flex:0 0 32px;display:flex;justify-content:center;position:relative}.view-labels__pin{display:flex;align-items:center;justify-content:center;position:absolute}.view-labels__description,.view-labels__title{font-size:14px;letter-spacing:.35px;line-height:1.4em}.view-labels__description{color:#374a68;color:var(--view-labels-description-color);padding-top:4px}.view-labels__label{position:absolute;font-size:10px;top:3px}"],encapsulation:2,changeDetection:0}),bb([Object(E.d)(Is.getChapterLabels),vb("design:type",be.a)],xb.prototype,"labels$",void 0),bb([Object(E.d)(Is.getSelectedLabel),vb("design:type",be.a)],xb.prototype,"selectedLabel$",void 0),xb),wb=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},Ob=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Cb(e,t){if(1&e&&(P.Vb(0,"div"),P.Qb(1,"app-content-blocks",7),P.hc(2,"async"),P.Ub()),2&e){var n=P.gc(2);P.Db(1),P.lc("contentBlocks",P.ic(2,2,n.contentBlocks$))("include",n.contentBlockTypes.Ticker)}}function Sb(e,t){if(1&e&&(P.Vb(0,"div"),P.Qb(1,"app-content-blocks",8),P.hc(2,"async"),P.Ub()),2&e){var n=P.gc(2);P.Db(1),P.lc("contentBlocks",P.ic(2,2,n.contentBlocks$))("exclude",n.contentBlockTypes.Ticker)}}function _b(e,t){if(1&e){var n=P.Wb();P.Vb(0,"app-view-panel",4),P.Kc(1,Cb,3,4,"div",5),P.hc(2,"async"),P.Vb(3,"app-view-description",6),P.cc("isPopulatedChange",(function(e){return P.zc(n),P.gc().isPopulated=e})),P.Ub(),P.Kc(4,Sb,3,4,"div",5),P.hc(5,"async"),P.Ub()}if(2&e){var i,o,r=P.gc();P.lc("showHeader",!1)("hidden",!r.isPopulated),P.Db(1),P.lc("ngIf",(null==(i=P.ic(2,6,r.contentBlocks$))?null:i.length)>0),P.Db(2),P.lc("isPopulated",r.isPopulated)("layout",r.layout),P.Db(1),P.lc("ngIf",(null==(o=P.ic(5,8,r.contentBlocks$))?null:o.length)>0)}}function jb(e,t){if(1&e&&(P.Vb(0,"app-view-panel",9),P.Qb(1,"app-view-legend",10),P.hc(2,"async"),P.Ub()),2&e){var n=P.gc();P.Db(1),P.lc("legend",P.ic(2,1,n.chapter$).legend)}}function Pb(e,t){if(1&e){var n=P.Wb();P.Vb(0,"div",13),P.Vb(1,"button",14),P.cc("click",(function(){return P.zc(n),P.gc(2).handlePrevClick()})),P.Ub(),P.Vb(2,"button",15),P.cc("click",(function(){return P.zc(n),P.gc(2).handleNextClick()})),P.Ub(),P.Ub()}}function Mb(e,t){if(1&e&&(P.Vb(0,"app-view-panel",11),P.Kc(1,Pb,3,0,"div",12),P.hc(2,"async"),P.Qb(3,"app-view-labels"),P.Ub()),2&e){var n,i=P.gc();P.Db(1),P.lc("ngIf",(null==(n=P.ic(2,1,i.labels$))?null:n.length)>1)}}var Ib,zb=((Ib=function(){function e(t,n,i,o){m(this,e),this.store=t,this.viewService=n,this.layoutService=i,this.changeDetectorRef=o,this.ngUnsubscribe=new fe.a,this.layout=Ku.Column,this.viewLayout=$u,this.isPopulated=!0,this.descriptionVisible=!1,this.legendVisible=!1,this.labelListVisible=!1,this.contentBlockTypes=so}return v(e,[{key:"ngOnInit",value:function(){var e=this;this.store.select(ku.getUI).pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(){e.descriptionVisible=e.isVisible($u.Description),e.legendVisible=e.isVisible($u.Legend),e.labelListVisible=e.isVisible($u.LabelList),e.changeDetectorRef.markForCheck()}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"isVisible",value:function(e){return this.layoutService.isUIVisible(e)}},{key:"isEnabled",value:function(e){return this.layoutService.isUIEnabled(e)}},{key:"handlePrevClick",value:function(){this.selectLabel(-1)}},{key:"handleNextClick",value:function(){this.selectLabel(1)}},{key:"selectLabel",value:function(e){var t=this.store.selectSnapshot(Is.getChapterLabels),n=t.length,i=this.store.selectSnapshot(Is.getSelectedLabelId),o=t.findIndex((function(e){return e.id===i})),r=t[((-1!==o?o+e:0)%n+n)%n];r&&this.viewService.selectLabel(r,!0)}}]),e}()).\u0275fac=function(e){return new(e||Ib)(P.Pb(E.g),P.Pb(td),P.Pb(Yu),P.Pb(P.i))},Ib.\u0275cmp=P.Jb({type:Ib,selectors:[["app-view-content-mode"]],inputs:{layout:"layout"},decls:7,vars:9,consts:[["gaCategory","View Information Panel",1,"view-content-mode"],[3,"showHeader","hidden",4,"ngIf"],["label","Legend",4,"ngIf"],["label","Labels",4,"ngIf"],[3,"showHeader","hidden"],[4,"ngIf"],[3,"isPopulated","layout","isPopulatedChange"],[3,"contentBlocks","include"],[3,"contentBlocks","exclude"],["label","Legend"],[3,"legend"],["label","Labels"],["actions","","class","flex",4,"ngIf"],["actions","",1,"flex"],["gaEvent","","gaAction","Clicked Previous Label","app-pin-button","","icon","chevron-left","size","small","buttonType","ghost","matTooltip","Previous Label",3,"click"],["gaEvent","","gaAction","Clicked Next Label","app-pin-button","","icon","chevron-right","size","small","buttonType","ghost","matTooltip","Next Label",3,"click"]],template:function(e,t){if(1&e&&(P.Vb(0,"div",0),P.Kc(1,_b,6,10,"app-view-panel",1),P.Kc(2,jb,3,3,"app-view-panel",2),P.hc(3,"async"),P.hc(4,"async"),P.Kc(5,Mb,4,3,"app-view-panel",3),P.hc(6,"async"),P.Ub()),2&e){var n,i=null;P.Db(1),P.lc("ngIf",t.descriptionVisible),P.Db(1),P.lc("ngIf",(null==(i=P.ic(3,3,t.chapter$))?null:i.legend)&&(null==(i=P.ic(4,5,t.chapter$))?null:i.legend.length)>0&&t.legendVisible),P.Db(3),P.lc("ngIf",(null==(n=P.ic(6,7,t.labels$))?null:n.length)&&t.labelListVisible)}},directives:[Ce.a,ra.l,rb,pb,qg,fb,kb,vg,Ce.b,mg.c],pipes:[ra.b],styles:[".view-content-mode[_ngcontent-%COMP%]{padding-bottom:24px}"],changeDetection:0}),wb([Object(E.d)(Lr.getStoryChapters),Ob("design:type",be.a)],Ib.prototype,"chapters$",void 0),wb([Object(E.d)(Lr.getSelectedChapter),Ob("design:type",be.a)],Ib.prototype,"chapter$",void 0),wb([Object(E.d)(Lr.getSelectedChapterContentBlocks),Ob("design:type",be.a)],Ib.prototype,"contentBlocks$",void 0),wb([Object(E.d)(Is.getChapterLabels),Ob("design:type",be.a)],Ib.prototype,"labels$",void 0),Ib);function Tb(e,t){if(1&e&&(P.Vb(0,"span"),P.Mc(1),P.Ub()),2&e){var n=P.gc();P.Db(1),P.Oc(" of ",n.total,"")}}var Ub,Lb,Db,Eb=((Ub=function(){function e(){m(this,e),this.index=0,this.total=0}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||Ub)},Ub.\u0275cmp=P.Jb({type:Ub,selectors:[["app-view-quiz-progress"]],inputs:{index:"index",total:"total"},decls:4,vars:2,consts:[["data-test","quizProgress",1,"view-quiz-progress"],[1,"text-semibold"],[4,"ngIf"]],template:function(e,t){1&e&&(P.Vb(0,"div",0),P.Vb(1,"span",1),P.Mc(2),P.Ub(),P.Kc(3,Tb,2,1,"span",2),P.Ub()),2&e&&(P.Db(2),P.Oc("Question ",t.index+1,""),P.Db(1),P.lc("ngIf",t.total>1))},directives:[ra.l],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3838}.text-info[_ngcontent-%COMP%]{color:#0060c4}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.view-quiz-progress[_ngcontent-%COMP%]{color:#374a68;font-size:12px;letter-spacing:.3px;line-height:1.4em}"],changeDetection:0}),Ub),Fb=h("QibW"),Ab=[[["app-list-item"]]],Rb=["app-list-item"],Vb=function(e){return e.Default="default",e.Commafied="commafied",e.flat="flat",e.inline="inline",e}({}),Nb=((Lb=function(){function e(){m(this,e),this.listType=Vb.Default}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||Lb)},Lb.\u0275cmp=P.Jb({type:Lb,selectors:[["app-list"]],inputs:{listType:"listType"},ngContentSelectors:Rb,decls:2,vars:1,consts:[[1,"list",3,"ngClass"]],template:function(e,t){1&e&&(P.kc(Ab),P.Vb(0,"div",0),P.jc(1),P.Ub()),2&e&&P.lc("ngClass","list--"+t.listType)},directives:[ra.i],styles:['.list{display:flex;flex-direction:column}.list--default app-list-item{display:list-item;margin-left:16px;list-style-type:disc}.list--commafied{align-items:center;display:flex;flex-direction:row;flex-wrap:wrap;padding:0 4px 4px 0}.list--commafied app-list-item:not(:last-child):after{content:", ";float:right;padding-right:4px}.list--flat app-list-item:not(:last-child){margin-bottom:4px}.list--inline{display:inline-flex;align-items:center;display:flex;flex-direction:row;flex-wrap:wrap}.list--inline app-list-item{margin:0 8px 4px 0}.list__item{display:block}'],encapsulation:2,changeDetection:0}),Lb),Bb=["*"],Hb=((Db=function(){function e(){m(this,e)}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||Db)},Db.\u0275cmp=P.Jb({type:Db,selectors:[["app-list-item"]],ngContentSelectors:Bb,decls:1,vars:0,template:function(e,t){1&e&&(P.kc(),P.jc(0))},styles:[""],encapsulation:2,changeDetection:0}),Db);function Qb(e,t){if(1&e&&(P.Vb(0,"app-list-item"),P.Vb(1,"div",1),P.Mc(2),P.Ub(),P.Ub()),2&e){var n=t.$implicit;P.Db(1),P.Eb("data-id",n.id),P.Db(1),P.Nc(n.label)}}var qb,Wb,$b=((Wb=function(){function e(t,n,i){m(this,e),this.store=t,this.graphService=n,this.changeRef=i}return v(e,[{key:"objectIds",get:function(){return this._objectIds},set:function(e){this._objectIds=e;var t=this.store.selectSnapshot(Wr.getViewGraph);this.nodes=this.graphService.getNodes(t,e),this.changeRef.markForCheck()}},{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||Wb)(P.Pb(E.g),P.Pb(Ut),P.Pb(P.i))},Wb.\u0275cmp=P.Jb({type:Wb,selectors:[["app-view-quiz-object-tree"]],inputs:{objectIds:"objectIds"},decls:2,vars:1,consts:[[4,"ngFor","ngForOf"],[1,"text-14","text-medium","mv-1"]],template:function(e,t){1&e&&(P.Vb(0,"app-list"),P.Kc(1,Qb,3,2,"app-list-item",0),P.Ub()),2&e&&(P.Db(1),P.lc("ngForOf",t.nodes))},directives:[Nb,ra.k,Hb],styles:[""],changeDetection:0}),Wb),Kb=((qb=function(){function e(){m(this,e)}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||qb)},qb.\u0275cmp=P.Jb({type:qb,selectors:[["app-view-quiz-answer-number"]],inputs:{number:"number"},decls:3,vars:1,consts:[[1,"number","text-10","text-medium"]],template:function(e,t){1&e&&(P.Vb(0,"div",0),P.Vb(1,"div"),P.Mc(2),P.Ub(),P.Ub()),2&e&&(P.Db(2),P.Nc(t.number))},styles:[".number[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:20px;height:20px;color:#131c2a;border:1px solid rgba(55,74,104,.5);border-radius:50%}"],changeDetection:0}),qb),Gb=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Zb(e,t){if(1&e&&(P.Vb(0,"div",3),P.Vb(1,"div",4),P.Qb(2,"app-view-quiz-answer-number",5),P.Ub(),P.Vb(3,"div",6),P.Qb(4,"app-quiz-label-anatomy-select",7),P.Ub(),P.Ub()),2&e){var n=t.index,i=P.gc();P.Db(2),P.lc("number",n+1),P.Db(2),P.lc("options",i.options)("formControlName",n)}}var Jb,Xb=((Jb=function(){function e(t){m(this,e),this.formBuilder=t,this.valueChange=new P.p,this.ngUnsubscribe=new fe.a,this._options=[],this.form=this.formBuilder.group({options:this.formBuilder.array([])}),this.optionsArray=this.form.get("options")}return v(e,[{key:"options",get:function(){return this._options},set:function(e){Object(Se.isEqual)(e,this._options)||(this._options=e,this.buildFormOptions(e))}},{key:"ngOnInit",value:function(){this.initFormListeners(),this.init()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initFormListeners",value:function(){var e=this;this.form.valueChanges.pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){var n=t.options;e.valueChange.next(n)}))}},{key:"init",value:function(){var e=this;this.activeSubmission$.pipe(Object(me.a)((function(e){return!Object(Se.isNil)(e)&&!Object(Se.isNil)(e.answer)})),Object(ta.a)(),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){var n=p(t,2),i=n[0],o=n[1],r=function(e,t,n){var i=t.findIndex((function(t,n){var i=e[n];return!Object(Se.isEqual)(i,t)})),o=t[i];return t.map((function(e,t){return Object(Se.isEqual)(o,e)&&t!==i?"":e}))}(i.answer||[],o.answer||[]);Object(Se.isEqual)(o,r)||e.form.patchValue({options:r||[]})})),this.activeSubmission$.pipe(Object(me.a)((function(e){return!Object(Se.isNil)(e)&&!Object(Se.isNil)(e.answer)&&Array.isArray(e.answer)})),Object(Xr.a)((function(e,t){return Object(Se.isEqual)(e,t)})),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){var n=e.form.value.options,i=t.answer;Object(Se.isEqual)(n,i)||e.form.patchValue({options:i},{emitEvent:!1,onlySelf:!0})}))}},{key:"buildFormOptions",value:function(e){var t=this;this.optionsArray.clear(),e.forEach((function(){t.optionsArray.push(t.formBuilder.control(""))})),this.optionsArray.setValue(e.map((function(){return""})))}}]),e}()).\u0275fac=function(e){return new(e||Jb)(P.Pb(eh.d))},Jb.\u0275cmp=P.Jb({type:Jb,selectors:[["app-view-quiz-label-anatomy"]],inputs:{options:"options"},outputs:{valueChange:"valueChange"},decls:3,vars:2,consts:[[1,"options",3,"formGroup"],["formArrayName","options"],["class","options__item mb-4","data-test","questionAnswer",4,"ngFor","ngForOf"],["data-test","questionAnswer",1,"options__item","mb-4"],[1,"mr-2"],[3,"number"],[1,"options__item-select"],[3,"options","formControlName"]],template:function(e,t){1&e&&(P.Vb(0,"div",0),P.Vb(1,"div",1),P.Kc(2,Zb,5,3,"div",2),P.Ub(),P.Ub()),2&e&&(P.lc("formGroup",t.form),P.Db(2),P.lc("ngForOf",t.options))},directives:[eh.n,eh.h,eh.c,ra.k,Kb,ah,eh.m,eh.g],styles:[".options__item[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}.options__item-select[_ngcontent-%COMP%]{border:1px solid #96a8c0;border-radius:4px;flex:1 1 auto}"],changeDetection:0}),function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);r>3&&a&&Object.defineProperty(t,n,a)}([Object(E.d)(_o.getActiveSubmission),Gb("design:type",be.a)],Jb.prototype,"activeSubmission$",void 0),Jb),Yb=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},ev=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function tv(e,t){if(1&e&&(P.Vb(0,"mat-radio-button",8),P.Mc(1),P.Ub()),2&e){var n=t.$implicit;P.lc("value",n.value),P.Db(1),P.Oc(" ",n.label," ")}}function nv(e,t){if(1&e){var n=P.Wb();P.Vb(0,"div"),P.Vb(1,"mat-radio-group",6),P.cc("change",(function(e){return P.zc(n),P.gc(2).handleMultipleChoiceChange(e)})),P.Kc(2,tv,2,2,"mat-radio-button",7),P.Ub(),P.Ub()}if(2&e){var i=P.gc(2);P.Db(2),P.lc("ngForOf",i.question.data.options)}}function iv(e,t){if(1&e&&(P.Vb(0,"div",10),P.Qb(1,"app-view-quiz-object-tree",11),P.Ub()),2&e){var n=P.gc(3);P.Db(1),P.lc("objectIds",n.question.data.correctAnswer)}}function ov(e,t){if(1&e&&(P.Vb(0,"div"),P.Kc(1,iv,2,1,"div",9),P.Ub()),2&e){var n=P.gc(2);P.Db(1),P.lc("ngIf",n.question.data.showAnswerList)}}function rv(e,t){if(1&e){var n=P.Wb();P.Vb(0,"div"),P.Vb(1,"app-view-quiz-label-anatomy",12),P.cc("valueChange",(function(e){return P.zc(n),P.gc(2).handleLabelAnatomyChanges(e)})),P.Ub(),P.Ub()}if(2&e){var i=P.gc(2);P.Db(1),P.lc("options",i.question.data.options)}}function av(e,t){if(1&e&&(P.Vb(0,"div",1),P.Vb(1,"div",2),P.Qb(2,"app-content-blocks",3),P.Ub(),P.Vb(3,"div",4),P.Kc(4,nv,3,1,"div",5),P.Kc(5,ov,2,1,"div",5),P.Kc(6,rv,2,1,"div",5),P.Ub(),P.Ub()),2&e){var n=P.gc();P.Db(2),P.lc("contentBlocks",n.question.questionPrompt),P.Db(1),P.lc("ngSwitch",n.question.type),P.Db(1),P.lc("ngSwitchCase",n.QuestionType.MultipleChoice),P.Db(1),P.lc("ngSwitchCase",n.QuestionType.SelectAnatomy),P.Db(1),P.lc("ngSwitchCase",n.QuestionType.LabelAnatomy)}}var sv,cv=((sv=function(){function e(t){m(this,e),this.changeRef=t,this.disabled=!1,this.QuestionType=co,this.ngUnsubscribe=new fe.a}return v(e,[{key:"question",get:function(){return this._question},set:function(e){this._question=e,this.initQuestionListeners()}},{key:"value",get:function(){return this._value},set:function(e){this._value=e,this.onChange(e)}},{key:"handleMultipleChoiceChange",value:function(e){this.writeValue(e.value)}},{key:"handleLabelAnatomyChanges",value:function(e){this.writeValue(e)}},{key:"ngOnInit",value:function(){}},{key:"initQuestionListeners",value:function(){switch(this.question.type){case co.SelectAnatomy:this.initSelectAnatomyListeners();break;case co.Instructions:this.initInstructions()}}},{key:"initSelectAnatomyListeners",value:function(){var e=this;this.checkedNodesIds$.pipe(Object(Xr.a)((function(e,t){return Object(Se.isEqual)(e,t)})),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){e.writeValue(t),e.changeRef.markForCheck()}))}},{key:"initInstructions",value:function(){var e=this;setTimeout((function(){e.writeValue("-"),e.changeRef.markForCheck()}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"onChange",value:function(e){}},{key:"onTouched",value:function(){}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"registerOnChange",value:function(e){this.onChange=e}},{key:"writeValue",value:function(e){this.value=e}},{key:"setDisabledState",value:function(e){this.disabled=e}}]),e}()).\u0275fac=function(e){return new(e||sv)(P.Pb(P.i))},sv.\u0275cmp=P.Jb({type:sv,selectors:[["app-view-quiz-question"]],inputs:{question:"question",value:"value"},features:[P.Cb([{provide:eh.k,useExisting:Object(P.W)((function(){return sv})),multi:!0}])],decls:1,vars:1,consts:[["class","view-quiz-question text-14 mb-8","data-test","question",4,"ngIf"],["data-test","question",1,"view-quiz-question","text-14","mb-8"],["data-test","questionPrompt",1,"view-quiz-question__prompt","mb-4"],[3,"contentBlocks"],[3,"ngSwitch"],[4,"ngSwitchCase"],[1,"flex","flex-column",3,"change"],["data-test","questionAnswer","class","view-quiz-question__option",3,"value",4,"ngFor","ngForOf"],["data-test","questionAnswer",1,"view-quiz-question__option",3,"value"],["class","ml-3",4,"ngIf"],[1,"ml-3"],[3,"objectIds"],[3,"options","valueChange"]],template:function(e,t){1&e&&P.Kc(0,av,7,5,"div",0),2&e&&P.lc("ngIf",t.question)},directives:[ra.l,qg,ra.n,ra.o,Fb.b,ra.k,Fb.a,$b,Xb],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3838}.text-info{color:#0060c4}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.view-quiz-question__option{font-size:14px;letter-spacing:.35px;line-height:1.4em;padding:12px 0 12px 12px}.view-quiz-question__option,.view-quiz-question__option>*{white-space:normal!important}.view-quiz-question__option .mat-radio-label{align-items:flex-start!important}.view-quiz-question__option .mat-radio-label-content{padding-left:12px!important}"],encapsulation:2,changeDetection:0}),Yb([Object(E.d)(Ai.getCheckedNodeIds),ev("design:type",be.a)],sv.prototype,"checkedNodesIds$",void 0),Yb([Object(E.d)(_o.getActiveSubmission),ev("design:type",be.a)],sv.prototype,"activeSubmission$",void 0),sv);function lv(e,t){1&e&&P.Qb(0,"app-icon",6)}function uv(e,t){1&e&&P.Qb(0,"app-icon",7)}function pv(e,t){1&e&&(P.Vb(0,"span",8),P.Qb(1,"span",9),P.Ub())}var dv,gv=["*"],hv=((dv=function(){function e(){m(this,e)}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||dv)},dv.\u0275cmp=P.Jb({type:dv,selectors:[["app-view-quiz-answer-option"]],inputs:{correct:"correct"},ngContentSelectors:gv,decls:7,vars:7,consts:[["data-test","answerOptionContainer",1,"option"],[1,"flex","relative",3,"ngSwitch"],["class","option__icon option__icon--correct","style","font-size: 20px","icon","check-circle",4,"ngSwitchCase"],["class","option__icon option__icon--incorrect","style","font-size: 20px","icon","times-circle",4,"ngSwitchCase"],["class","option__icon",4,"ngSwitchDefault"],[1,"pl-2"],["icon","check-circle",1,"option__icon","option__icon--correct",2,"font-size","20px"],["icon","times-circle",1,"option__icon","option__icon--incorrect",2,"font-size","20px"],[1,"option__icon"],[1,"mat-radio-outer-circle"]],template:function(e,t){1&e&&(P.kc(),P.Vb(0,"div",0),P.Vb(1,"div",1),P.Kc(2,lv,1,0,"app-icon",2),P.Kc(3,uv,1,0,"app-icon",3),P.Kc(4,pv,2,0,"span",4),P.Vb(5,"div",5),P.jc(6),P.Ub(),P.Ub(),P.Ub()),2&e&&(P.Hb("option--correct",!0===t.correct)("option--incorrect",!1===t.correct),P.Db(1),P.lc("ngSwitch",t.correct),P.Db(1),P.lc("ngSwitchCase",!0),P.Db(1),P.lc("ngSwitchCase",!1))},directives:[ra.n,ra.o,ra.p,nl],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3838}.text-info[_ngcontent-%COMP%]{color:#0060c4}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.option[_ngcontent-%COMP%]{padding:12px;border-radius:4px;margin-bottom:8px;color:#131c2a}.option--correct[_ngcontent-%COMP%]{border:1px solid #73b676;background-color:#eaf8ec}.option--incorrect[_ngcontent-%COMP%]{border:1px solid #cb4039;background-color:#f6dada}.option__icon[_ngcontent-%COMP%]{position:relative;flex:0 0 20px;justify-content:center}.option__icon--correct[_ngcontent-%COMP%]{color:#73b676}.option__icon--incorrect[_ngcontent-%COMP%]{color:#cb4039}"],changeDetection:0}),dv);function fv(e,t){if(1&e&&(P.Vb(0,"div"),P.Vb(1,"app-view-quiz-answer-option",1),P.Vb(2,"div",2),P.Mc(3),P.Ub(),P.Ub(),P.Ub()),2&e){var n=t.$implicit,i=P.gc();P.Db(1),P.lc("correct",i.isOptionAnswerCorrect(i.question,n.value,i.answer)),P.Db(2),P.Oc(" ",n.label," ")}}var bv,vv=((bv=function(){function e(){m(this,e)}return v(e,[{key:"ngOnInit",value:function(){}},{key:"isOptionAnswerCorrect",value:function(e,t,n){var i=po(e,[t]);return t===n[0]||i?i:void 0}}]),e}()).\u0275fac=function(e){return new(e||bv)},bv.\u0275cmp=P.Jb({type:bv,selectors:[["app-view-quiz-multiple-choice-answer"]],inputs:{question:"question",answer:"answer",summary:"summary"},decls:1,vars:1,consts:[[4,"ngFor","ngForOf"],[3,"correct"],[1,"text-semibold"]],template:function(e,t){1&e&&P.Kc(0,fv,4,2,"div",0),2&e&&P.lc("ngForOf",t.question.data.options)},directives:[ra.k,hv],styles:[""],changeDetection:0}),bv);function mv(e,t){if(1&e){var n=P.Wb();P.Vb(0,"div",7),P.Vb(1,"button",8),P.cc("click",(function(){P.zc(n);var e=P.gc();return e.handleSelectedObjectsClick(e.answer)})),P.Mc(2,"Highlight My Answer"),P.Ub(),P.Vb(3,"button",9),P.cc("click",(function(){P.zc(n);var e=P.gc();return e.handleCorrectObjectsClick(e.question.data.correctAnswer)})),P.Mc(4,"Highlight Correct Answer"),P.Ub(),P.Ub()}}var yv,xv=((yv=function(){function e(t){m(this,e),this.store=t}return v(e,[{key:"isCorrect",get:function(){return po(this.question,this.answer)}},{key:"ngOnInit",value:function(){}},{key:"handleSelectedObjectsClick",value:function(e){this.setSelectedObjects(e)}},{key:"handleCorrectObjectsClick",value:function(e){this.setSelectedObjects(e)}},{key:"setSelectedObjects",value:function(e){var t=e.filter((function(e){return e&&""!==e}));this.store.dispatch(new pi.UpdateNodesChecked(!1)),this.store.dispatch(new pi.UpdateNodesChecked(!0,t))}}]),e}()).\u0275fac=function(e){return new(e||yv)(P.Pb(E.g))},yv.\u0275cmp=P.Jb({type:yv,selectors:[["app-view-quiz-select-anatomy-answer"]],inputs:{question:"question",answer:"answer",summary:"summary"},decls:11,vars:5,consts:[[1,"mb-8","ml-3"],[3,"objectIds"],[3,"correct"],["selectAnatomyAnswer",""],[1,"flex","flex-column","text-semibold"],[1,"mt-2","ml-2"],["class","mt-4",4,"ngIf"],[1,"mt-4"],["buttonType","outline","buttonTheme","light","app-button","","data-test","highlightUserAnswers",1,"w-100","mv-2",3,"click"],["buttonType","outline","buttonTheme","light","app-button","","data-test","highlightCorrectAnswers",1,"w-100","mv-2",3,"click"]],template:function(e,t){if(1&e&&(P.Vb(0,"div"),P.Vb(1,"div",0),P.Qb(2,"app-view-quiz-object-tree",1),P.Ub(),P.Vb(3,"app-view-quiz-answer-option",2,3),P.Vb(5,"div",4),P.Vb(6,"div"),P.Mc(7),P.Ub(),P.Vb(8,"div",5),P.Qb(9,"app-view-quiz-object-tree",1),P.Ub(),P.Ub(),P.Ub(),P.Kc(10,mv,5,0,"div",6),P.Ub()),2&e){var n=P.vc(4);P.Db(2),P.lc("objectIds",t.question.data.correctAnswer),P.Db(1),P.lc("correct",t.isCorrect),P.Db(4),P.Oc(" ",n.correct?"Correct":"Incorrect","! You selected: "),P.Db(2),P.lc("objectIds",t.answer),P.Db(1),P.lc("ngIf",!t.summary&&!t.isCorrect)}},directives:[$b,hv,ra.l,gl],styles:[""],changeDetection:0}),yv);function kv(e,t){if(1&e&&(P.Vb(0,"div",9),P.Mc(1),P.Ub()),2&e){var n=P.gc().$implicit;P.Db(1),P.Oc(" ",n.label.title," ")}}function wv(e,t){if(1&e&&(P.Vb(0,"div"),P.Mc(1," You selected "),P.Vb(2,"em",9),P.Mc(3),P.Ub(),P.Mc(4,". "),P.Ub(),P.Vb(5,"div",10),P.Mc(6," This is the "),P.Vb(7,"em",9),P.Mc(8),P.Ub(),P.Mc(9,". "),P.Ub()),2&e){var n=P.gc(),i=n.index,o=n.$implicit,r=P.gc();P.Db(3),P.Nc(r.getSelectedUserOption(i).label.title),P.Db(5),P.Nc(o.label.title)}}function Ov(e,t){if(1&e&&(P.Vb(0,"div",1),P.Vb(1,"div",2),P.Qb(2,"app-view-quiz-answer-number",3),P.Ub(),P.Vb(3,"div",4),P.Vb(4,"app-view-quiz-answer-option",5,6),P.Kc(6,kv,2,1,"div",7),P.Kc(7,wv,10,2,"ng-template",null,8,P.Lc),P.Ub(),P.Ub(),P.Ub()),2&e){var n=t.index,i=P.vc(5),o=P.vc(8),r=P.gc();P.Db(2),P.lc("number",n+1),P.Db(2),P.lc("correct",r.isOptionAnswerCorrect(n)),P.Db(2),P.lc("ngIf",i.correct)("ngIfElse",o)}}var Cv,Sv=((Cv=function(){function e(){m(this,e)}return v(e,[{key:"ngOnInit",value:function(){}},{key:"isOptionAnswerCorrect",value:function(e){return this.answer[e]===this.question.data.correctAnswer[e]}},{key:"getSelectedUserOption",value:function(e){var t=this.answer[e];return this.question.data.options.find((function(e){return e.value===t}))}}]),e}()).\u0275fac=function(e){return new(e||Cv)},Cv.\u0275cmp=P.Jb({type:Cv,selectors:[["app-view-quiz-label-anatomy-answer"]],inputs:{question:"question",answer:"answer",summary:"summary"},decls:1,vars:1,consts:[["class","answers",4,"ngFor","ngForOf"],[1,"answers"],[1,"mt-2","mr-2"],[3,"number"],[1,"answers__option"],[3,"correct"],["answerOption",""],["class","text-semibold",4,"ngIf","ngIfElse"],["falseBlock",""],[1,"text-semibold"],[1,"mt-1"]],template:function(e,t){1&e&&P.Kc(0,Ov,9,4,"div",0),2&e&&P.lc("ngForOf",t.question.data.options)},directives:[ra.k,Kb,hv,ra.l],styles:[".answers[_ngcontent-%COMP%]{display:flex;flex-direction:row}.answers__option[_ngcontent-%COMP%]{flex:1 1 auto}"],changeDetection:0}),Cv);function _v(e,t){if(1&e&&(P.Vb(0,"div",7),P.Mc(1),P.Ub()),2&e){var n=P.gc();P.Db(1),P.Oc("",n.questionNumber,".")}}function jv(e,t){if(1&e&&(P.Vb(0,"div"),P.Qb(1,"app-view-quiz-multiple-choice-answer",8),P.Ub()),2&e){var n=P.gc();P.Db(1),P.lc("question",n.question)("answer",n.answer)("summary",n.summary)}}function Pv(e,t){if(1&e&&(P.Vb(0,"div"),P.Qb(1,"app-view-quiz-select-anatomy-answer",8),P.Ub()),2&e){var n=P.gc();P.Db(1),P.lc("question",n.question)("answer",n.answer)("summary",n.summary)}}function Mv(e,t){if(1&e&&(P.Vb(0,"div"),P.Qb(1,"app-view-quiz-label-anatomy-answer",8),P.Ub()),2&e){var n=P.gc();P.Db(1),P.lc("question",n.question)("answer",n.answer)("summary",n.summary)}}var Iv,zv,Tv=((Iv=function(){function e(t){m(this,e),this.store=t,this.QuestionType=co}return v(e,[{key:"ngOnInit",value:function(){this.initAnswerConfig()}},{key:"initAnswerConfig",value:function(){var e=this.question.type;this.store.dispatch(new io.SetQuizPickMode(e===co.SelectAnatomy?"none":"single"))}}]),e}()).\u0275fac=function(e){return new(e||Iv)(P.Pb(E.g))},Iv.\u0275cmp=P.Jb({type:Iv,selectors:[["app-view-quiz-answer"]],inputs:{question:"question",questionNumber:"questionNumber",answer:"answer",summary:"summary"},decls:11,vars:7,consts:[["data-test","answer",1,"answer"],[1,"answer__prompt"],["class","mr-1",4,"ngIf"],[3,"contentBlocks"],[3,"ngSwitch"],[4,"ngSwitchCase"],[1,"answer__explanation"],[1,"mr-1"],[3,"question","answer","summary"]],template:function(e,t){1&e&&(P.Vb(0,"div",0),P.Vb(1,"div",1),P.Kc(2,_v,2,1,"div",2),P.Vb(3,"div"),P.Qb(4,"app-content-blocks",3),P.Ub(),P.Ub(),P.Vb(5,"div",4),P.Kc(6,jv,2,3,"div",5),P.Kc(7,Pv,2,3,"div",5),P.Kc(8,Mv,2,3,"div",5),P.Ub(),P.Vb(9,"div",6),P.Qb(10,"app-content-blocks",3),P.Ub(),P.Ub()),2&e&&(P.Db(2),P.lc("ngIf",t.questionNumber),P.Db(2),P.lc("contentBlocks",t.question.questionPrompt),P.Db(1),P.lc("ngSwitch",t.question.type),P.Db(1),P.lc("ngSwitchCase",t.QuestionType.MultipleChoice),P.Db(1),P.lc("ngSwitchCase",t.QuestionType.SelectAnatomy),P.Db(1),P.lc("ngSwitchCase",t.QuestionType.LabelAnatomy),P.Db(2),P.lc("contentBlocks",t.question.explanation))},directives:[ra.l,qg,ra.n,ra.o,vv,xv,Sv],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3838}.text-info[_ngcontent-%COMP%]{color:#0060c4}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.answer[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.answer__prompt[_ngcontent-%COMP%]{display:flex;padding-bottom:16px}.answer__explanation[_ngcontent-%COMP%]{padding-top:24px}"],changeDetection:0}),Iv),Uv=["progressCircle"],Lv=((zv=function(){function e(t,n){m(this,e),this.renderer=t,this.changeRef=n,this._size="medium",this._progress=0,this.strokeWidth=8,this.diameter=120}return v(e,[{key:"size",get:function(){return this._size},set:function(e){this._size=e,this.updateCircle()}},{key:"progress",get:function(){return this._progress},set:function(e){this._progress=e,this.updateCircle()}},{key:"ngOnInit",value:function(){}},{key:"ngAfterViewInit",value:function(){this.updateCircle()}},{key:"updateCircle",value:function(){switch(this.size){case"small":this.strokeWidth=4,this.diameter=60;break;case"medium":this.strokeWidth=8,this.diameter=120;break;case"large":this.strokeWidth=16,this.diameter=240}if(this.progressCircleRef){var e=2*this.progressCircleRef.nativeElement.r.baseVal.value*Math.PI,t=e-this.progress/100*e;this.renderer.setStyle(this.progressCircleRef.nativeElement,"strokeDasharray","".concat(e," ").concat(e)),this.renderer.setStyle(this.progressCircleRef.nativeElement,"strokeDashoffset",""+t)}this.changeRef.markForCheck()}}]),e}()).\u0275fac=function(e){return new(e||zv)(P.Pb(P.H),P.Pb(P.i))},zv.\u0275cmp=P.Jb({type:zv,selectors:[["app-progress-circle"]],viewQuery:function(e,t){var n;1&e&&P.Gc(Uv,!0),2&e&&P.uc(n=P.dc())&&(t.progressCircleRef=n.first)},inputs:{size:"size",progress:"progress"},decls:8,vars:19,consts:[["data-test","progress",1,"progress"],[1,"progress__ring-bg"],["stroke","#F9FAFD","fill","transparent",1,"progress__circle"],[1,"progress__ring"],["stroke","#5BB96F","fill","transparent",1,"progress__circle"],["progressCircle",""],["data-test","progressPercentage",1,"progress__label","text-semibold"]],template:function(e,t){1&e&&(P.Vb(0,"div",0),P.fc(),P.Vb(1,"svg",1),P.Qb(2,"circle",2),P.Ub(),P.Vb(3,"svg",3),P.Qb(4,"circle",4,5),P.Ub(),P.ec(),P.Vb(6,"div",6),P.Mc(7),P.Ub(),P.Ub()),2&e&&(P.Hb("progress--small","small"===t.size)("progress--medium","medium"===t.size)("progress--large","large"===t.size),P.Db(1),P.Eb("width",t.diameter)("height",t.diameter),P.Db(1),P.Eb("stroke-width",t.strokeWidth)("r",t.diameter/2-2*t.strokeWidth)("cx",t.diameter/2)("cy",t.diameter/2),P.Db(1),P.Eb("width",t.diameter)("height",t.diameter),P.Db(1),P.Eb("stroke-width",t.strokeWidth)("r",t.diameter/2-2*t.strokeWidth)("cx",t.diameter/2)("cy",t.diameter/2),P.Db(3),P.Oc(" ",t.progress,"% "))},styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3838}.text-info[_ngcontent-%COMP%]{color:#0060c4}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.progress[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:center}.progress__ring[_ngcontent-%COMP%]{position:absolute;z-index:1}.progress__circle[_ngcontent-%COMP%]{transition:stroke-dashoffset .35s;transform:rotate(-90deg);transform-origin:50% 50%}.progress__label[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);z-index:2}.progress--small[_ngcontent-%COMP%]   .progress__label[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.progress--medium[_ngcontent-%COMP%]   .progress__label[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.progress--large[_ngcontent-%COMP%]   .progress__label[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}"],changeDetection:0}),zv),Dv=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},Ev=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Fv(e,t){if(1&e&&(P.Vb(0,"div",13),P.Qb(1,"app-view-quiz-answer",14),P.Ub()),2&e){var n=t.$implicit,i=t.index,o=P.gc(3);P.Db(1),P.lc("question",n)("questionNumber",i+1)("answer",null==o.quizScore?null:o.quizScore.questionAnswers[n.id])("summary",!0)}}function Av(e,t){if(1&e&&(P.Vb(0,"div",11),P.Kc(1,Fv,2,4,"div",12),P.Ub()),2&e){var n=P.gc(2);P.Db(1),P.lc("ngForOf",n.questions)}}function Rv(e,t){if(1&e&&(P.Tb(0),P.Vb(1,"div",6),P.Qb(2,"app-progress-circle",7),P.Vb(3,"div",8),P.Mc(4," Quiz Complete "),P.Ub(),P.Vb(5,"div",9),P.Mc(6),P.Ub(),P.Ub(),P.Kc(7,Av,2,1,"div",10),P.Sb()),2&e){var n=P.gc();P.Db(2),P.lc("progress",null==n.quizScore?null:n.quizScore.score),P.Db(4),P.Pc(" You answered ",null==n.quizScore?null:n.quizScore.correctTotal," of ",null==n.quizScore?null:n.quizScore.scorableTotal," questions correctly. "),P.Db(1),P.lc("ngIf",n.showExplanationEnabled&&n.showExplanation)}}function Vv(e,t){if(1&e){var n=P.Wb();P.Vb(0,"button",15),P.cc("click",(function(){return P.zc(n),P.gc().handleToggleSummaryClick()})),P.Mc(1),P.Ub()}if(2&e){var i=P.gc();P.Db(1),P.Oc(" ",i.showExplanation?"Hide Summary":"Show Summary"," ")}}function Nv(e,t){if(1&e){var n=P.Wb();P.Vb(0,"button",16),P.cc("click",(function(){return P.zc(n),P.gc().handleRestartClick()})),P.Mc(1," Take Again "),P.Ub()}}function Bv(e,t){if(1&e){var n=P.Wb();P.Vb(0,"button",17),P.cc("click",(function(){return P.zc(n),P.gc().handleExitClick()})),P.Mc(1," Back to View "),P.Ub()}}var Hv,Qv=((Hv=function(){function e(t,n,i){m(this,e),this.store=t,this.changeRef=n,this.quizService=i,this.questions=[],this.showSummaryEnabled=!1,this.showExplanationEnabled=!1,this.showExplanation=!1,this.ngUnsubscribe=new fe.a}return v(e,[{key:"ngOnInit",value:function(){this.initReviewListeners()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initReviewListeners",value:function(){var e=this;Object(Gr.b)([this.questions$,this.submissions$]).pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){var n=p(t,2),i=n[0],o=n[1];e.questions=i,e.quizScore=go(i,o),e.changeRef.markForCheck()})),this.quizSettings$.pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){var n=t.showSummary,i=t.showExplanation;e.showSummaryEnabled=!1!==n,e.showExplanationEnabled=!1!==i,e.changeRef.markForCheck()}))}},{key:"handleToggleSummaryClick",value:function(){this.showExplanation=!this.showExplanation,this.changeRef.markForCheck()}},{key:"handleRestartClick",value:function(){var e=this;this.quizService.resetQuiz(),setTimeout((function(){e.quizService.startQuiz()}))}},{key:"handleExitClick",value:function(){this.quizService.exitQuiz()}}]),e}()).\u0275fac=function(e){return new(e||Hv)(P.Pb(E.g),P.Pb(P.i),P.Pb(bf))},Hv.\u0275cmp=P.Jb({type:Hv,selectors:[["app-view-quiz-review"]],decls:8,vars:8,consts:[["data-test","quizReview",1,"review"],[4,"ngIf"],[1,"review__actions"],["class","w-100","app-button","","buttonType","outline","buttonTheme","light","data-test","quizToggleSummaryButton",3,"click",4,"ngIf"],["class","mt-8 w-100","app-button","","buttonType","info","buttonTheme","light","data-test","quizTakeAgainButton",3,"click",4,"ngIf"],["class","mt-3 w-100","app-button","","buttonType","info","buttonTheme","light","data-test","quizExitButton",3,"click",4,"ngIf"],["data-test","quizSummary",1,"text-center"],["size","medium",3,"progress"],[1,"mt-8","text-18","text-semibold"],[1,"mv-4","text-14","text-medium"],["class","review__summary mb-4","data-test","quizExplanation",4,"ngIf"],["data-test","quizExplanation",1,"review__summary","mb-4"],["class","mv-6",4,"ngFor","ngForOf"],[1,"mv-6"],[3,"question","questionNumber","answer","summary"],["app-button","","buttonType","outline","buttonTheme","light","data-test","quizToggleSummaryButton",1,"w-100",3,"click"],["app-button","","buttonType","info","buttonTheme","light","data-test","quizTakeAgainButton",1,"mt-8","w-100",3,"click"],["app-button","","buttonType","info","buttonTheme","light","data-test","quizExitButton",1,"mt-3","w-100",3,"click"]],template:function(e,t){1&e&&(P.Vb(0,"div",0),P.Kc(1,Rv,8,4,"ng-container",1),P.Vb(2,"div",2),P.Kc(3,Vv,2,1,"button",3),P.Kc(4,Nv,2,0,"button",4),P.hc(5,"async"),P.Kc(6,Bv,2,0,"button",5),P.hc(7,"async"),P.Ub(),P.Ub()),2&e&&(P.Db(1),P.lc("ngIf",t.showSummaryEnabled),P.Db(2),P.lc("ngIf",t.showSummaryEnabled&&t.showExplanationEnabled),P.Db(1),P.lc("ngIf",!P.ic(5,4,t.quizLocked$)),P.Db(2),P.lc("ngIf",!P.ic(7,6,t.quizLocked$)))},directives:[ra.l,Lv,ra.k,Tv,gl],pipes:[ra.b],styles:[".review__summary[_ngcontent-%COMP%]{background-color:#f9fafd;padding:4px 12px}"],changeDetection:0}),Dv([Object(E.d)(_o.getAllQuestions),Ev("design:type",be.a)],Hv.prototype,"questions$",void 0),Dv([Object(E.d)(_o.getAllSubmissions),Ev("design:type",be.a)],Hv.prototype,"submissions$",void 0),Dv([Object(E.d)(_o.getQuizSettings),Ev("design:type",be.a)],Hv.prototype,"quizSettings$",void 0),Dv([Object(E.d)(_o.getQuizModeLocked),Ev("design:type",be.a)],Hv.prototype,"quizLocked$",void 0),Hv),qv=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},Wv=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function $v(e,t){if(1&e){var n=P.Wb();P.Vb(0,"button",10),P.cc("click",(function(){return P.zc(n),P.gc(2).handleExitClick()})),P.Vb(1,"span",11),P.Mc(2,"Exit Quiz"),P.Ub(),P.Ub()}}function Kv(e,t){if(1&e&&(P.Qb(0,"app-view-quiz-progress",12),P.hc(1,"async"),P.hc(2,"async")),2&e){var n=P.gc(2);P.lc("index",P.ic(1,2,n.questionIndex$))("total",P.ic(2,4,n.questionTotal$))}}function Gv(e,t){if(1&e&&(P.Vb(0,"div",5),P.Vb(1,"div",6),P.Vb(2,"h1",7),P.Mc(3,"Quiz"),P.Ub(),P.Kc(4,$v,3,0,"button",8),P.hc(5,"async"),P.Ub(),P.Kc(6,Kv,3,6,"app-view-quiz-progress",9),P.hc(7,"async"),P.hc(8,"async"),P.Ub()),2&e){var n,i=P.gc();P.Db(4),P.lc("ngIf",!P.ic(5,2,i.quizLocked$)),P.Db(2),P.lc("ngIf",(null==(n=P.ic(7,4,i.quizSettings$))?null:n.showProgress)&&P.ic(8,6,i.lifecycle$)!==i.Lifecycle.Review)}}function Zv(e,t){if(1&e&&(P.Qb(0,"app-view-quiz-question",16),P.hc(1,"async")),2&e){var n=P.gc(2);P.lc("question",P.ic(1,1,n.question$))}}function Jv(e,t){if(1&e&&(P.Vb(0,"div"),P.Mc(1),P.hc(2,"async"),P.Ub()),2&e){var n,i=P.gc(3);P.Db(1),P.Oc(" ",(null==(n=P.ic(2,1,i.question$))?null:n.nextLabel)||i.defaultNextButtonNext," ")}}function Xv(e,t){1&e&&(P.Vb(0,"div"),P.Mc(1,"Submit"),P.Ub())}function Yv(e,t){if(1&e&&(P.Vb(0,"button",17),P.Vb(1,"div",18),P.hc(2,"async"),P.Kc(3,Jv,3,3,"div",19),P.Kc(4,Xv,2,0,"div",20),P.Ub(),P.Ub()),2&e){var n,i=P.gc(2);P.lc("disabled",!i.form.valid),P.Db(1),P.lc("ngSwitch",null==(n=P.ic(2,3,i.question$))?null:n.type),P.Db(2),P.lc("ngSwitchCase",i.quizQuestionType.Instructions)}}function em(e,t){if(1&e){var n=P.Wb();P.Vb(0,"form",13),P.cc("submit",(function(){return P.zc(n),P.gc().handleSubmit()})),P.Kc(1,Zv,2,3,"app-view-quiz-question",14),P.hc(2,"async"),P.Kc(3,Yv,5,5,"button",15),P.hc(4,"async"),P.hc(5,"async"),P.Ub()}if(2&e){var i,o=P.gc();P.lc("formGroup",o.form),P.Db(1),P.lc("ngIf",P.ic(2,3,o.question$)),P.Db(2),P.lc("ngIf",(null==(i=P.ic(4,5,o.quizSettings$))?null:i.showSubmit)&&P.ic(5,7,o.lifecycle$)===o.Lifecycle.Question)}}function tm(e,t){if(1&e){var n=P.Wb();P.Vb(0,"button",24),P.cc("click",(function(){return P.zc(n),P.gc(2).nextQuestion()})),P.Mc(1),P.hc(2,"async"),P.Ub()}if(2&e){var i,o=P.gc(2);P.Db(1),P.Oc(" ",(null==(i=P.ic(2,1,o.question$))?null:i.nextLabel)||o.defaultNextButtonNext," ")}}function nm(e,t){if(1&e){var n=P.Wb();P.Vb(0,"button",26),P.cc("click",(function(){return P.zc(n),P.gc(3).handleViewSummaryClick()})),P.Mc(1," See Results "),P.Ub()}}function im(e,t){if(1&e&&(P.Tb(0),P.Kc(1,nm,2,0,"button",25),P.hc(2,"async"),P.Sb()),2&e){var n=P.gc(2);P.Db(1),P.lc("ngIf",P.ic(2,1,n.quizReviewEnabled$))}}function om(e,t){if(1&e&&(P.Tb(0),P.Vb(1,"div",21),P.Qb(2,"app-view-quiz-answer",22),P.hc(3,"async"),P.hc(4,"async"),P.Ub(),P.Tb(5,18),P.hc(6,"async"),P.Kc(7,tm,3,3,"button",23),P.Kc(8,im,3,3,"ng-container",20),P.Sb(),P.Sb()),2&e){var n=P.gc();P.Db(2),P.lc("question",P.ic(3,5,n.question$))("answer",P.ic(4,7,n.submission$).answer)("summary",!1),P.Db(3),P.lc("ngSwitch",P.ic(6,9,n.hasQuestionsRemaining$)),P.Db(2),P.lc("ngSwitchCase",!0)}}function rm(e,t){1&e&&(P.Tb(0),P.Qb(1,"app-view-quiz-review"),P.Sb())}function am(e,t){if(1&e&&(P.Vb(0,"div",27),P.Mc(1),P.hc(2,"async"),P.Ub()),2&e){var n,i=P.gc();P.Db(1),P.Oc(" ",1===(null==(n=P.ic(2,1,i.questions$))?null:n.length)?"Answer":"Answers"," submitted ")}}var sm,cm=((sm=function(){function e(t,n,i,o,r,a,s){m(this,e),this.store=t,this.actions=n,this.formBuilder=i,this.viewService=o,this.engineService=r,this.quizService=a,this.pendoService=s,this.defaultNextButtonNext="Next Question",this.showHeader=!0,this.Lifecycle=fo,this.quizQuestionType=co,this.sceneConfigStash={},this.ngUnsubscribe=new fe.a}return v(e,[{key:"ngOnInit",value:function(){if(!this.store.selectSnapshot(_o.getActiveQuestionId)){var e=this.store.selectSnapshot(_o).questions[0].id;this.store.dispatch(new io.SetActiveQuestion(e))}this.store.dispatch(new io.SetQuizLifecycle(fo.Question)),this.form=this.formBuilder.group({question:new eh.e("",this.getQuizValidation())}),this.initQuestionObserver(),this.initAnswerObserver(),this.initEngineInteractionObserver(),this.engineService.fireEvent(Dt.QuizEntered,!0)}},{key:"ngOnDestroy",value:function(){var e=this;Object.entries(this.sceneConfigStash).forEach((function(t){var n=p(t,2),i=n[0],o=n[1];e.store.dispatch(new Fn(i,o.background))})),this.engineService.fireEvent(Dt.QuizExited,!0),this.viewService.selectTool(Rr.Select),this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"answer",get:function(){var e=this.form.get("question").value;return Array.isArray(e)?e:[e]}},{key:"initQuestionObserver",value:function(){var e=this;this.question$.pipe(Object(ve.a)(this.ngUnsubscribe),Object(me.a)((function(e){return void 0!==e}))).subscribe((function(t){var n=e.store.selectSnapshot(Lr.getSelectedChapterId);t.chapterId!==n&&e.store.dispatch(new Cn(t.chapterId)),e.form.reset(),e.setSceneConfig(t),e.store.dispatch(new io.SetActiveSubmission(void 0)),t.type===co.Instructions&&e.form.get("question").setValue("-"),e.engineService.fireEvent(Dt.QuizQuestionLoaded,t)}))}},{key:"initAnswerObserver",value:function(){var e=this;this.form.get("question").valueChanges.pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){var n=e.store.selectSnapshot(_o.getActiveQuestion),i=e.store.selectSnapshot(_o.getActiveSubmission);void 0!==n&&(e.store.selectSnapshot(_o.getAllSubmissions).some((function(e){return e.questionId===n.id}))||(i&&Object(Se.isEqual)(i.answer,t)||e.store.dispatch(new io.SetActiveSubmission({questionId:n.id,answer:t})),Object(Se.isNil)(t)||e.engineService.fireEvent(Dt.QuizAnswerSelected,{questionId:n.id,answerId:t})))}))}},{key:"initEngineInteractionObserver",value:function(){var e=this;this.viewService.selectTool(Rr.Quiz),this.store.dispatch(new io.SetQuizPickMode("single")),this.actions.pipe(Object(E.j)(Be),Object(me.a)((function(t){var n=t.node,i=t.event;return!Object(Se.isNil)(n)&&e.store.selectSnapshot(Wr.getActiveTool)===Rr.Quiz&&!i.srcEvent.shiftKey}))).pipe(Object(me.a)((function(){return"none"!==e.store.selectSnapshot(_o.getPickMode)})),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){"single"===e.store.selectSnapshot(_o.getPickMode)&&e.viewService.clearSelectedNodes();var n=Object(Se.get)(t,"hit.objectId");if(n){var i=e.store.selectSnapshot(Ai.getCheckedNodeIds).includes(n);e.store.dispatch(new pi.UpdateNodesChecked(!i,[n]))}})),this.question$.pipe(Object(Xr.a)((function(e,t){return Object(Se.get)(e,"id")===Object(Se.get)(t,"id")})),Object(me.a)((function(e){return!Object(Se.isNil)(e)}))).pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){var n=t.type,i=t.data;e.viewService.clearSelectedNodes(),e.store.dispatch(new io.SetQuizPickMode(n===co.SelectAnatomy&&i.correctAnswer.length>1?"multi":"single"))}))}},{key:"handleSubmit",value:function(){var e=this.store.selectSnapshot(_o.getActiveQuestion);(this.form.valid||e.type===co.Instructions)&&this.quizService.submitQuestion(e.id,this.answer)}},{key:"handleViewSummaryClick",value:function(){this.viewSummary()}},{key:"handleExitClick",value:function(){this.quizService.exitQuiz()}},{key:"nextQuestion",value:function(){this.quizService.nextQuestion()}},{key:"viewSummary",value:function(){this.store.dispatch(new io.SetQuizLifecycle(fo.Review)),this.engineService.fireEvent(Dt.QuizCompleted,!0)}},{key:"setSceneConfig",value:function(e){var t=this,n=(null==e?void 0:e.sceneConfig)||{},i=n.camera,o=n.background,r=this.store.selectSnapshot(Lr.getChapter(e.chapterId));i&&(this.setStash(e.chapterId,{camera:r.camera.location}),setTimeout((function(){t.store.dispatch(new $t(i.location,!0,1))}))),o&&(this.setStash(e.chapterId,{background:r.background}),this.store.dispatch(new Fn(e.chapterId,o)))}},{key:"setStash",value:function(e,t){this.sceneConfigStash[e]=Object.assign(Object.assign({},this.sceneConfigStash[e]||{}),t)}},{key:"getQuizValidation",value:function(){var e=this;return function(t){var n=t.value,i=Array.isArray(n)?n:[n],o=function(e){switch(Object(Se.get)(e,"type","")){case co.MultipleChoice:var t=Object(Se.get)(e,"data.correctAnswer","");return t&&""!==t;case co.SelectAnatomy:case co.LabelAnatomy:return Object(Se.get)(e,"data.correctAnswer",[]).length>0;default:return!0}}(e.store.selectSnapshot(_o.getActiveQuestion)),r=i.some((function(e){return Object(Se.isNil)(e)||""===e}));return o&&r?{invalidValues:r}:null}}}]),e}()).\u0275fac=function(e){return new(e||sm)(P.Pb(E.g),P.Pb(E.b),P.Pb(eh.d),P.Pb(td),P.Pb(Nt),P.Pb(bf),P.Pb(je))},sm.\u0275cmp=P.Jb({type:sm,selectors:[["app-view-quiz"]],inputs:{showHeader:"showHeader"},decls:13,vars:19,consts:[["data-test","quiz",1,"view-quiz"],["class","pb-2 mb-4 view-quiz__header",4,"ngIf"],[3,"formGroup","submit",4,"ngIf"],[4,"ngIf"],["class","text-16 text-bold text-center",4,"ngIf"],[1,"pb-2","mb-4","view-quiz__header"],[1,"flex"],[1,"text-20","text-semibold","flex-grow"],["app-pin-button","","icon","times","size","small",3,"click",4,"ngIf"],["class","mt-3",3,"index","total",4,"ngIf"],["app-pin-button","","icon","times","size","small",3,"click"],[1,"visually-hidden"],[1,"mt-3",3,"index","total"],[3,"formGroup","submit"],["formControlName","question",3,"question",4,"ngIf"],["app-button","","class","w-100","buttonType","info","data-test","questionSubmit",3,"disabled",4,"ngIf"],["formControlName","question",3,"question"],["app-button","","buttonType","info","data-test","questionSubmit",1,"w-100",3,"disabled"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"mb-8"],[3,"question","answer","summary"],["app-button","","buttonType","info","class","w-100","data-test","questionNextButton",3,"click",4,"ngSwitchCase"],["app-button","","buttonType","info","data-test","questionNextButton",1,"w-100",3,"click"],["data-test","quizViewSummaryButton","app-button","","buttonType","info","class","w-100",3,"click",4,"ngIf"],["data-test","quizViewSummaryButton","app-button","","buttonType","info",1,"w-100",3,"click"],[1,"text-16","text-bold","text-center"]],template:function(e,t){if(1&e&&(P.Vb(0,"div",0),P.Kc(1,Gv,9,8,"div",1),P.Kc(2,em,6,9,"form",2),P.hc(3,"async"),P.Kc(4,om,9,11,"ng-container",3),P.hc(5,"async"),P.Kc(6,rm,2,0,"ng-container",3),P.hc(7,"async"),P.hc(8,"async"),P.Kc(9,am,3,3,"div",4),P.hc(10,"async"),P.hc(11,"async"),P.hc(12,"async"),P.Ub()),2&e){var n=null;P.Db(1),P.lc("ngIf",t.showHeader),P.Db(1),P.lc("ngIf",P.ic(3,5,t.lifecycle$)===t.Lifecycle.Question),P.Db(2),P.lc("ngIf",P.ic(5,7,t.lifecycle$)===t.Lifecycle.Explanation),P.Db(2),P.lc("ngIf",P.ic(7,9,t.lifecycle$)===t.Lifecycle.Review&&P.ic(8,11,t.quizReviewEnabled$)),P.Db(3),P.lc("ngIf",!(P.ic(10,13,t.hasQuestionsRemaining$)||P.ic(11,15,t.quizReviewEnabled$)||null!=(n=P.ic(12,17,t.quizSettings$))&&n.showExplanation))}},directives:[ra.l,vg,Eb,eh.t,eh.n,eh.h,cv,eh.m,eh.g,gl,ra.n,ra.o,ra.p,Tv,Qv],pipes:[ra.b],styles:[".view-quiz__header[_ngcontent-%COMP%]{border-bottom:1px solid #eaeff5}"],changeDetection:0}),qv([Object(E.d)(_o.getQuizReviewEnabled),Wv("design:type",be.a)],sm.prototype,"quizReviewEnabled$",void 0),qv([Object(E.d)(_o.getActiveQuestion),Wv("design:type",be.a)],sm.prototype,"question$",void 0),qv([Object(E.d)(_o.getAllQuestions),Wv("design:type",be.a)],sm.prototype,"questions$",void 0),qv([Object(E.d)(_o.getActiveQuestionIndex),Wv("design:type",be.a)],sm.prototype,"questionIndex$",void 0),qv([Object(E.d)(_o.getQuestionTotal),Wv("design:type",be.a)],sm.prototype,"questionTotal$",void 0),qv([Object(E.d)(_o.getCorrectAnswerTotal),Wv("design:type",be.a)],sm.prototype,"correctAnswerTotal$",void 0),qv([Object(E.d)(_o.hasQuestionRemaining),Wv("design:type",be.a)],sm.prototype,"hasQuestionsRemaining$",void 0),qv([Object(E.d)(_o.getQuizSettings),Wv("design:type",be.a)],sm.prototype,"quizSettings$",void 0),qv([Object(E.d)(_o.getLifecycle),Wv("design:type",be.a)],sm.prototype,"lifecycle$",void 0),qv([Object(E.d)(_o.getQuizModeLocked),Wv("design:type",be.a)],sm.prototype,"quizLocked$",void 0),qv([Object(E.d)(_o.getActiveSubmission),Wv("design:type",be.a)],sm.prototype,"submission$",void 0),sm),lm=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},um=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},pm=["viewDrawer"],dm=["viewDrawerOuter"];function gm(e,t){1&e&&P.Qb(0,"app-icon",17)}function hm(e,t){1&e&&P.Qb(0,"app-icon",18)}function fm(e,t){if(1&e&&(P.Vb(0,"div",19),P.Qb(1,"app-content-blocks",20),P.hc(2,"async"),P.Ub()),2&e){var n,i=P.gc(2);P.Db(1),P.lc("contentBlocks",null==(n=P.ic(2,2,i.selectedLabel$))?null:n.contentBlocks)("layout","compact")}}function bm(e,t){if(1&e){var n=P.Wb();P.Tb(0),P.Vb(1,"div",6),P.cc("click",(function(){return P.zc(n),P.gc().handleToggleClick()})),P.Vb(2,"div",7),P.cc("click",(function(){return P.zc(n),P.gc().handleLabelBack()})),P.Qb(3,"app-icon",8),P.Ub(),P.Vb(4,"div",9),P.Qb(5,"app-html",10),P.hc(6,"async"),P.Ub(),P.Vb(7,"div",11),P.Kc(8,gm,1,0,"app-icon",12),P.Kc(9,hm,1,0,"app-icon",13),P.Ub(),P.Ub(),P.Kc(10,fm,3,4,"div",14),P.hc(11,"async"),P.Vb(12,"div",15),P.Qb(13,"app-html",16),P.hc(14,"async"),P.Ub(),P.Sb()}if(2&e){var i,o,r,a=P.gc();P.Db(5),P.lc("markdownText",null==(i=P.ic(6,5,a.selectedLabel$))?null:i.title),P.Db(3),P.lc("ngIf",!a.open),P.Db(1),P.lc("ngIf",a.open),P.Db(1),P.lc("ngIf",null==(o=P.ic(11,7,a.selectedLabel$))?null:o.contentBlocks),P.Db(3),P.lc("markdownText",null==(r=P.ic(14,9,a.selectedLabel$))?null:r.description)}}function vm(e,t){1&e&&(P.Tb(0),P.Qb(1,"app-view-title",24),P.Sb()),2&e&&(P.Db(1),P.lc("menuEnabled",!1))}function mm(e,t){if(1&e){var n=P.Wb();P.Vb(0,"div",29),P.cc("click",(function(){return P.zc(n),P.gc(3).handleExitQuiz()})),P.Qb(1,"app-icon",30),P.Ub()}}function ym(e,t){if(1&e&&(P.Vb(0,"span",31),P.Vb(1,"span",32),P.Mc(2),P.hc(3,"async"),P.Ub(),P.Mc(4),P.hc(5,"async"),P.Ub()),2&e){var n=P.gc(3);P.Db(2),P.Oc("Question ",P.ic(3,2,n.activeQuestionIndex$)+1,""),P.Db(2),P.Oc(" of ",P.ic(5,4,n.questionTotal$)," ")}}function xm(e,t){if(1&e&&(P.Tb(0),P.Kc(1,mm,2,0,"div",25),P.hc(2,"async"),P.Vb(3,"div",9),P.Vb(4,"div",26),P.Vb(5,"span",27),P.Mc(6,"Quiz"),P.Ub(),P.Kc(7,ym,6,6,"span",28),P.hc(8,"async"),P.hc(9,"async"),P.Ub(),P.Ub(),P.Sb()),2&e){var n,i=P.gc(2);P.Db(1),P.lc("ngIf",!P.ic(2,2,i.quizLocked$)),P.Db(6),P.lc("ngIf",(null==(n=P.ic(8,4,i.quizSettings$))?null:n.showProgress)&&P.ic(9,6,i.questionRemaining$)>0)}}function km(e,t){1&e&&P.Qb(0,"app-icon",17)}function wm(e,t){1&e&&P.Qb(0,"app-icon",18)}function Om(e,t){if(1&e&&(P.Vb(0,"div",11),P.Kc(1,km,1,0,"app-icon",12),P.Kc(2,wm,1,0,"app-icon",13),P.Ub()),2&e){var n=P.gc(2);P.Db(1),P.lc("ngIf",!n.open),P.Db(1),P.lc("ngIf",n.open)}}function Cm(e,t){1&e&&P.Qb(0,"app-view-content-mode",34)}function Sm(e,t){if(1&e&&(P.Tb(0),P.Kc(1,Cm,1,0,"app-view-content-mode",33),P.Sb()),2&e){var n=P.gc(2);P.Db(1),P.lc("ngIf",n.expandable)}}function _m(e,t){1&e&&P.Qb(0,"app-view-quiz",35),2&e&&P.lc("showHeader",!1)}function jm(e,t){if(1&e){var n=P.Wb();P.Tb(0),P.Vb(1,"div",6),P.cc("click",(function(){return P.zc(n),P.gc().handleToggleClick()})),P.Kc(2,vm,2,1,"ng-container",21),P.hc(3,"async"),P.Kc(4,xm,10,8,"ng-container",21),P.hc(5,"async"),P.Kc(6,Om,3,2,"div",22),P.Ub(),P.Vb(7,"div",15),P.Kc(8,Sm,2,1,"ng-container",21),P.hc(9,"async"),P.Kc(10,_m,1,1,"app-view-quiz",23),P.hc(11,"async"),P.Ub(),P.Sb()}if(2&e){var i=P.gc();P.Db(2),P.lc("ngIf",!P.ic(3,5,i.quizModeActive$)),P.Db(2),P.lc("ngIf",P.ic(5,7,i.quizModeActive$)),P.Db(2),P.lc("ngIf",i.expandable),P.Db(2),P.lc("ngIf",!P.ic(9,9,i.quizModeActive$)),P.Db(2),P.lc("ngIf",P.ic(11,11,i.quizModeActive$))}}var Pm,Mm,Im,zm=function(e,t,n,i){return{"view-drawer--closed":e,"view-drawer--active":t,"view-drawer--scrollable":n,"view-drawer--fixed":i}},Tm=((Pm=function(){function e(t,n,i,o,r,a){m(this,e),this.renderer=t,this.changeDetectorRef=n,this.viewService=i,this.quizService=o,this.store=r,this.layoutService=a,this.offsetYChange=new P.p,this.breakpoints={minimumDrawer:{velocity:1/0,point:0},halfDrawer:{velocity:1,point:0}},this.ngUnsubscribe=new fe.a,this.viewMode=Cu,this.viewToolsMode=ff,this.mode=Cu.Content,this.open=!1}return v(e,[{key:"expandable",get:function(){return"full"===this.layoutService.getVisibleContent()||this.mode===Cu.LabelInfo||this.mode===Cu.NodeInfo||this.open}},{key:"ngOnInit",value:function(){this.initWindowSizeObserver(),this.initLayoutObserver(),this.initQuizObserver()}},{key:"ngAfterViewInit",value:function(){this.refresh(this.store.selectSnapshot(ku.getUI).drawer.isExpandedInitially)}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initWindowSizeObserver",value:function(){var e=this;Object(or.a)(Object(Zr.a)(window,"resize"),Object(Zr.a)(window,"orientationchange")).pipe(Object(Rs.a)(0),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(){e.refresh(!1)}))}},{key:"initLayoutObserver",value:function(){var e=this;this.layout$.pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){e.updateMode(t)}))}},{key:"initQuizObserver",value:function(){var e=this,t=this.selectedChapterReady$.pipe(Object(Z.a)((function(e){return e&&e.model})),Object(me.a)((function(e){return e})),Object(Jr.a)(300));Object(Gr.b)([t,this.quizModeActive$]).pipe(Object(me.a)((function(e){var t=p(e,2),n=t[0],i=t[1];return n&&i})),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(){setTimeout((function(){e.toggleDrawer(!0),e.changeDetectorRef.markForCheck()}))}))}},{key:"updateViewHeight",value:function(){var e=this.viewService.getVH(U.application!==M.Viewer);this.viewDrawer.nativeElement.style.setProperty("--vh",e+"px")}},{key:"updateStops",value:function(){var e=window.innerHeight,t=this.store.selectSnapshot(Wp.getSiteHeader)===Bp.Hide?0:56;this.breakpoints.minimumDrawer.point=-64,this.breakpoints.halfDrawer.point=Math.floor(-.5*(e-t))}},{key:"updateMode",value:function(e){this.mode=this.viewService.inferDrawerMode(e),this.changeDetectorRef.markForCheck()}},{key:"resetDrawerPosition",value:function(e){var t=this;setTimeout((function(){t.slideDrawerToPoint(e?t.breakpoints.halfDrawer.point:t.breakpoints.minimumDrawer.point),t.open=e,t.changeDetectorRef.markForCheck()}))}},{key:"refresh",value:function(e){var t=this;setTimeout((function(){t.updateViewHeight(),t.updateStops(),t.resetDrawerPosition(e)}))}},{key:"handleToggleClick",value:function(){this.expandable&&this.toggleDrawer()}},{key:"handleDrawerKeydown",value:function(e){"ArrowDown"!==e.key&&"ArrowUp"!==e.key||e.stopPropagation()}},{key:"handleLabelBack",value:function(){this.viewService.clearSelectedLabel()}},{key:"toggleDrawer",value:function(e){null==e&&(e=!this.open),this.slideDrawerToPoint((e?this.breakpoints.halfDrawer:this.breakpoints.minimumDrawer).point),this.open=e,this.open?this.viewDrawerOuter.nativeElement.focus():this.viewDrawerOuter.nativeElement.blur()}},{key:"handleExitQuiz",value:function(){this.quizService.exitQuiz()}},{key:"slideDrawerToPoint",value:function(e){this.renderer.setStyle(this.viewDrawer.nativeElement,"transform","translate3d(0, ".concat(e,"px, 0)")),this.offsetYChange.emit(e)}},{key:"getDrawerY",value:function(){if(this.viewDrawer){var e=this.viewService.getComputedTransform(this.viewDrawer.nativeElement);return e?e.y:null}return null}}]),e}()).\u0275fac=function(e){return new(e||Pm)(P.Pb(P.H),P.Pb(P.i),P.Pb(td),P.Pb(bf),P.Pb(E.g),P.Pb(Yu))},Pm.\u0275cmp=P.Jb({type:Pm,selectors:[["app-view-drawer"]],viewQuery:function(e,t){var n;1&e&&(P.Rc(pm,!0),P.Rc(dm,!0)),2&e&&(P.uc(n=P.dc())&&(t.viewDrawer=n.first),P.uc(n=P.dc())&&(t.viewDrawerOuter=n.first))},inputs:{expandable:"expandable"},outputs:{offsetYChange:"offsetYChange"},decls:7,vars:10,consts:[[1,"view-drawer",3,"ngClass"],["viewDrawer",""],["role","region","aria-label","Chapter Description",1,"view-drawer__outer",3,"keydown"],["viewDrawerOuter",""],[1,"view-drawer__inner",3,"ngSwitch"],[4,"ngSwitchCase"],[1,"view-drawer__header",2,"height","64px",3,"click"],[1,"view-drawer__button","view-drawer__button--left",3,"click"],["icon","arrow-left"],[1,"view-drawer__title"],[1,"text-semibold","text-14",3,"markdownText"],[1,"view-drawer__button","view-drawer__button--right"],["icon","caret-up",4,"ngIf"],["icon","caret-down",4,"ngIf"],["class","mv-1","appEventFence","",4,"ngIf"],[1,"view-drawer__content"],[1,"text-14",3,"markdownText"],["icon","caret-up"],["icon","caret-down"],["appEventFence","",1,"mv-1"],[3,"contentBlocks","layout"],[4,"ngIf"],["class","view-drawer__button view-drawer__button--right",4,"ngIf"],[3,"showHeader",4,"ngIf"],["alignTitle","center","size","medium",1,"view-drawer__title",3,"menuEnabled"],["class","view-drawer__button view-drawer__button--left","role","button","appEventFence","",3,"click",4,"ngIf"],[1,"flex","flex-column","text-center"],[1,"text-11","text-semibold","text-uppercase"],["class","text-14",4,"ngIf"],["role","button","appEventFence","",1,"view-drawer__button","view-drawer__button--left",3,"click"],["icon","times"],[1,"text-14"],[1,"text-semibold"],["layout","drawer",4,"ngIf"],["layout","drawer"],[3,"showHeader"]],template:function(e,t){1&e&&(P.Vb(0,"div",0,1),P.Vb(2,"div",2,3),P.cc("keydown",(function(e){return t.handleDrawerKeydown(e)})),P.Vb(4,"div",4),P.Kc(5,bm,15,11,"ng-container",5),P.Kc(6,jm,12,13,"ng-container",5),P.Ub(),P.Ub(),P.Ub()),2&e&&(P.lc("ngClass",P.rc(5,zm,!t.open,t.open,t.open,!t.expandable)),P.Db(2),P.Eb("tabindex",t.open?0:-1),P.Db(2),P.lc("ngSwitch",t.mode),P.Db(1),P.lc("ngSwitchCase",t.viewMode.LabelInfo),P.Db(1),P.lc("ngSwitchCase",t.viewMode.Content))},directives:[ra.i,ra.n,ra.o,nl,cg,ra.l,tl,qg,Yf,zb,cm],pipes:[ra.b],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3838}.text-info{color:#0060c4}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.view-drawer{border-top:rgba(234,239,245,.8);box-shadow:0 -1px 0 0 rgba(28,42,63,.16);background:hsla(0,0%,100%,.8);color:#131c2a;border-top:var(--view-drawer-border);box-shadow:var(--view-drawer-shadow);color:var(--view-drawer-color);left:0;min-height:100vh;right:0;position:absolute;z-index:20;top:100vh;top:calc(var(--vh, 1vh) * 100);transform:translate3d(0,-56px,0);transition:transform .3s}.view-drawer--animate{transition:background-color 1s ease-in-out}.view-drawer--active{background-color:#fff;background-color:var(--view-drawer-background--active)}.view-drawer--closed{background-color:#fff;background-color:var(--view-drawer-background--closed)}.view-drawer--scrollable{min-height:0}.view-drawer--scrollable .view-drawer__outer{height:50vh;height:calc(var(--vh, 1vh) * 50);overflow-y:scroll}.view-drawer--fixed{height:56px;overflow:hidden}.view-drawer--fixed .view-drawer__inner{height:56px;padding:0 16px}.view-drawer--fixed .view-drawer__content{justify-content:center;padding-top:0}.view-drawer__header{position:relative}.view-drawer__header,.view-drawer__title{height:64px;display:flex;justify-content:center;align-items:center}.view-drawer__title{flex-grow:1;margin:0 64px;padding:0 8px}.view-drawer__button{border:1px solid rgba(0,0,0,.1);border-radius:50%;height:40px;width:40px;display:flex;align-items:center;justify-content:center;position:absolute;transition:background-color border-color 125ms 125ms}.view-drawer__button:hover{cursor:pointer;border-color:transparent;background:rgba(215,224,234,.6)}.view-drawer__button--left{border-right:1px solid rgba(0,0,0,.1);left:16px}.view-drawer__button--right{border-left:1px solid rgba(0,0,0,.1);right:16px}.view-drawer__inner{position:relative}.view-drawer__outer{outline:none}.view-drawer__content{display:flex;flex:1 1 100%;flex-direction:column;max-width:600px;min-height:56px;margin:0 auto;padding:8px 16px 48px}"],encapsulation:2,changeDetection:0}),lm([Object(E.d)(ku.getUI),um("design:type",be.a)],Pm.prototype,"layout$",void 0),lm([Object(E.d)(Lr.getSelectedChapterReadyState),um("design:type",be.a)],Pm.prototype,"selectedChapterReady$",void 0),lm([Object(E.d)(Lr.getSelectedChapterIndex),um("design:type",be.a)],Pm.prototype,"chapterIndex$",void 0),lm([Object(E.d)(Lr.getChapterCount),um("design:type",be.a)],Pm.prototype,"chapterCount$",void 0),lm([Object(E.d)(Is.getSelectedLabel),um("design:type",be.a)],Pm.prototype,"selectedLabel$",void 0),lm([Object(E.d)(_o.getQuizModeActive),um("design:type",be.a)],Pm.prototype,"quizModeActive$",void 0),lm([Object(E.d)(_o.getActiveQuestionIndex),um("design:type",be.a)],Pm.prototype,"activeQuestionIndex$",void 0),lm([Object(E.d)(_o.getQuestionTotal),um("design:type",be.a)],Pm.prototype,"questionTotal$",void 0),lm([Object(E.d)(_o.getQuestionsRemaining),um("design:type",be.a)],Pm.prototype,"questionRemaining$",void 0),lm([Object(E.d)(_o.getQuizSettings),um("design:type",be.a)],Pm.prototype,"quizSettings$",void 0),lm([Object(E.d)(_o.getQuizModeLocked),um("design:type",be.a)],Pm.prototype,"quizLocked$",void 0),Pm),Um=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";m(this,e),this.body=t,this.action=n},Lm=["viewColumn"],Dm=[[["","view-column-header",""]],"*"],Em=function(e,t,n){return{"view-column--unpadded":e,"view-column--left":t,"view-column--right":n}},Fm=["[view-column-header]","*"],Am=((Mm=function(){function e(){m(this,e),this.unpadded=!1,this.placement="left"}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||Mm)},Mm.\u0275cmp=P.Jb({type:Mm,selectors:[["app-view-column"]],viewQuery:function(e,t){var n;1&e&&P.Rc(Lm,!0),2&e&&P.uc(n=P.dc())&&(t.viewColumn=n.first)},inputs:{unpadded:"unpadded",placement:"placement"},ngContentSelectors:Fm,decls:7,vars:5,consts:[[1,"view-column",3,"ngClass"],["viewColumn",""],[1,"view-column__inner"],[1,"view-column__header"],[1,"view-column__body"]],template:function(e,t){1&e&&(P.kc(Dm),P.Vb(0,"div",0,1),P.Vb(2,"div",2),P.Vb(3,"div",3),P.jc(4),P.Ub(),P.Vb(5,"div",4),P.jc(6,1),P.Ub(),P.Ub(),P.Ub()),2&e&&P.lc("ngClass",P.qc(1,Em,t.unpadded,"left"===t.placement,"right"===t.placement))},directives:[ra.i],styles:[".view-column[_ngcontent-%COMP%]{pointer-events:auto;background:#fff;box-shadow:1px -1px 2px 0 rgba(28,42,63,.1),0 1px 2px 0 rgba(28,42,63,.3);color:#131c2a;background:var(--view-column-background);box-shadow:var(--view-column-toggle-shadow);color:var(--view-column-color);width:320px;height:100%;position:absolute;z-index:30}.view-column--left[_ngcontent-%COMP%]{left:0}.view-column--right[_ngcontent-%COMP%]{right:0;box-shadow:0 -1px 24px rgba(0,0,0,.4)}.view-column--unpadded[_ngcontent-%COMP%]   .view-column__body[_ngcontent-%COMP%]{padding:0}.view-column__inner[_ngcontent-%COMP%]{background:#fff;border-right:1px solid #eaeff5;background:var(--view-column-background);border-right:var(--view-column-border);display:flex;flex-direction:column;height:100%;width:320px;position:absolute;left:0;z-index:10}.view-column__header[_ngcontent-%COMP%]{flex-shrink:1;background:var(--view-column-background)}.view-column__header[_ngcontent-%COMP%]:empty{display:none}.view-column__body[_ngcontent-%COMP%]{overflow-y:auto;flex-grow:1;height:100%;padding:16px 12px}"],changeDetection:0}),Mm),Rm=["*"],Vm=((Im=function(){function e(){m(this,e)}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||Im)},Im.\u0275cmp=P.Jb({type:Im,selectors:[["app-view-list-container"],["","app-view-list-container",""]],ngContentSelectors:Rm,decls:2,vars:0,consts:[[1,"view-list-container"]],template:function(e,t){1&e&&(P.kc(),P.Vb(0,"div",0),P.jc(1),P.Ub())},styles:[".view-list-container{display:flex;flex-direction:column}"],encapsulation:2,changeDetection:0}),Im),Nm=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},Bm=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Hm=function(e,t,n,i){return{"view-logo--full-color":e,"view-logo--full-white":t,"view-logo--small-color":n,"view-logo--small-white":i}};function Qm(e,t){if(1&e&&(P.Tb(0),P.Qb(1,"a",1),P.Sb()),2&e){var n=P.gc();P.Db(1),P.lc("ngClass",P.rc(1,Hm,"color"===n.logoColor&&"full"===n.logoSize,"white"===n.logoColor&&"full"===n.logoSize,"color"===n.logoColor&&"small"===n.logoSize,"white"===n.logoColor&&"small"===n.logoSize))}}function qm(e,t){if(1&e&&(P.Tb(0),P.Qb(1,"span",2),P.Sb()),2&e){var n=P.gc();P.Db(1),P.lc("ngClass",P.rc(1,Hm,"color"===n.logoColor&&"full"===n.logoSize,"white"===n.logoColor&&"full"===n.logoSize,"color"===n.logoColor&&"small"===n.logoSize,"white"===n.logoColor&&"small"===n.logoSize))}}var Wm,$m,Km=((Wm=function(){function e(){m(this,e),this.logoSize="full",this.logoColor="color",this.isLight=!0,this.breakpoint=Nu,this.ngUnsubscribe=new fe.a}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||Wm)},Wm.\u0275cmp=P.Jb({type:Wm,selectors:[["app-view-logo"]],inputs:{logoSize:"logoSize",logoColor:"logoColor"},decls:4,vars:6,consts:[[4,"ngIf"],["href","https://www.biodigital.com","target","_blank","tabindex","-1","title","Powered by Biodigital",1,"view-logo",3,"ngClass"],[1,"view-logo",3,"ngClass"]],template:function(e,t){var n,i;(1&e&&(P.Kc(0,Qm,2,6,"ng-container",0),P.hc(1,"async"),P.Kc(2,qm,2,6,"ng-container",0),P.hc(3,"async")),2&e)&&(P.lc("ngIf",null==(n=P.ic(1,2,t.layout$))?null:n.logo.isHyperLink),P.Db(2),P.lc("ngIf",!(null!=(i=P.ic(3,4,t.layout$))&&i.logo.isHyperLink)))},directives:[ra.l,ra.i],pipes:[ra.b],styles:["[_nghost-%COMP%]{display:flex;height:52px;align-items:center}.view-logo--small-color[_ngcontent-%COMP%]{width:28px;height:44px;background:url(logo-color.svg) 50% no-repeat}.view-logo--full-color[_ngcontent-%COMP%]{width:120px;height:32px;background:url(powered-by-biodigital-color.svg) 50% no-repeat}.view-logo--small-white[_ngcontent-%COMP%]{width:28px;height:44px;background:url(logo-white.svg) 50% no-repeat}.view-logo--full-white[_ngcontent-%COMP%]{width:120px;height:32px;background:url(powered-by-biodigital-white.svg) 50% no-repeat}.view-logo[_ngcontent-%COMP%]:not([hidden]){display:flex}.view-logo[href][_ngcontent-%COMP%]:hover{cursor:pointer}"],changeDetection:0}),Nm([Object(E.d)(ku.getUI),Bm("design:type",be.a)],Wm.prototype,"layout$",void 0),Nm([Object(E.d)(Lr.getSelectedChapterBackground),Bm("design:type",be.a)],Wm.prototype,"background$",void 0),Nm([Object(E.d)(Wu.getBreakpoint),Bm("design:type",be.a)],Wm.prototype,"breakpoint$",void 0),Wm),Gm=function(e){return{"view-list-item--selected":e}},Zm=["*"],Jm=(($m=function(){function e(){m(this,e),this.selected=!1}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||$m)},$m.\u0275cmp=P.Jb({type:$m,selectors:[["app-view-list-item"],["","app-view-list-item",""]],inputs:{selected:"selected"},ngContentSelectors:Zm,decls:2,vars:3,consts:[[1,"view-list-item",3,"ngClass"]],template:function(e,t){1&e&&(P.kc(),P.Vb(0,"div",0),P.jc(1),P.Ub()),2&e&&P.lc("ngClass",P.oc(1,Gm,t.selected))},directives:[ra.i],styles:['.text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3838}.text-info{color:#0060c4}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.button{font-size:12px;letter-spacing:.3px;line-height:1.4em;align-items:center;background:none;border-color:transparent;border-radius:4px;border-width:0;color:inherit;display:flex;font-family:Inter UI,sans-serif;justify-content:center;margin:0;outline:0 none;padding:0 16px;position:relative;text-align:center;text-decoration:none;transition:background-color .12s;width:100%}.button:not([disabled]):hover{cursor:pointer}.button:focus .button--themed{background:#f1f4fa;outline:none}.button:after{content:" ";background-color:#283853;border-radius:4px;display:block;position:absolute;left:0;top:0;bottom:0;right:0;opacity:0;z-index:1;transition:opacity .06s}.button:not(.button--disabled):hover:after{opacity:.7}.button__container{position:relative;z-index:2;width:100%}.button--uppercase{text-transform:uppercase}.button--expanded{display:flex;flex:1}.button--xsmall{height:24px;min-width:24px;padding:0 8px;font-size:10px;letter-spacing:.25px;line-height:1.4em}.button--small{height:32px;min-width:32px;padding:0 12px}.button--medium,.button--small{font-size:12px;letter-spacing:.3px;line-height:1.4em}.button--medium{height:36px;min-width:36px;padding:0 16px}.button--large{height:48px;min-width:48px;padding:0 16px;font-size:14px;letter-spacing:.35px;line-height:1.4em}.button--no-border,.button--no-border:after{border-radius:0!important}.button--left{text-align:left}.button--themed{color:#374a68;color:var(--button-color)}.button--themed:hover{color:#1c2a3f;color:var(--button-color--hover)}.button--themed:after{background-color:#d7e0ea;background-color:var(--button-bg--hover)}.button--dark{color:#d7e0ea}.button--dark:hover{color:#fff}.button--dark:after{background-color:#283853}.button--dark.button--flat{background:#374a68}.button--dark.button--default{background:transparent}.button--dark.button--outline{background:transparent;border:1px solid #374a68;transition:border-color .12s}.button--dark.button--outline:hover{border-color:#96a8c0}.button--dark.button--outline:hover:after{background-color:transparent;display:none}.button--dark.button--text{background:transparent;color:#d7e0ea}.button--dark.button--text:hover{color:#fff}.button--dark.button--text:hover:after{display:none}.button--dark.button--selected{background-color:#1c5ab9;color:#fff}.button--dark.button--selected:hover:after{display:none}.button--light{color:#283853}.button--light:hover{color:#1c2a3f}.button--light:after{background-color:#96a8c0}.button--light:not(.button--disabled):hover:after{opacity:.6}.button--light.button--flat{background:#d7e0ea;font-weight:500}.button--light.button--flat.button--selected{background-color:#96a8c0}.button--light.button--default{background:transparent;color:#131c2a}.button--light.button--default:not(.button--disabled):hover:after{opacity:.2}.button--light.button--outline{background:transparent;border:1px solid #96a8c0;color:#283853;transition:border-color .12s}.button--light.button--outline:after{display:none}.button--light.button--outline:hover{background:rgba(55,74,104,.05);border-color:#374a68;color:#1c2a3f}.button--light.button--outline:hover:after{background-color:transparent}.button--light.button--selected{background-color:#eaeff5}.button--light.button--selected:hover:after{display:none}.button--light.button--text{color:#283853}.button--light.button--text:hover{color:#1c2a3f}.button--light.button--text:hover:after{display:none}.button--primary{background:#de3838;color:#fff}.button--primary:after{background:#f9fafd}.button--primary:hover:after{opacity:.1}.button--info{background:#3892dc;color:#fff}.button--info:after{background:#f9fafd}.button--info:hover:after{opacity:.1}.button--selected{background-color:#1c5ab9}.button--disabled{opacity:.5}.button--circle{border-radius:50%}.button--circle.button--xsmall{width:24px}.button--circle.button--small{width:32px;padding:0 6px}.button--circle.button--medium{width:36px;padding:0 8px}.button--circle.button--large{width:48px}.button--circle:after{border-radius:50%}.button--rounded,.button--rounded:after{border-radius:18px}[app-view-list-item]{border-color:transparent;background:none;border-width:0;padding:0;outline:none;margin:0;pointer-events:all;display:flex;width:100%}[app-view-list-item]::-moz-focus-inner{border:0}[app-view-list-item]:not([disabled]):hover{cursor:pointer}.view-list-item{font-size:14px;letter-spacing:.35px;line-height:1.4em;display:flex;flex-grow:1;flex-direction:row;padding:12px;border-radius:2px;border-left:4px solid transparent;background-color:transparent;color:#131c2a;border-left:var(--view-chapters-border);background-color:var(--view-chapters-bg);color:var(--view-chapters-color);transition:background-color 125ms,color 125ms,border 125ms}.view-list-item:hover{cursor:pointer;background:var(--view-chapters-bg--hover)}.view-list-item:focus{background:#f1f4fa;outline:none}.view-list-item--selected{border-left:4px solid #2d72dc;background-color:#f1f5fc;background:var(--view-chapters-bg--selected);border-left:var(--view-chapters-border--selected)}.view-list-item__index{display:flex;flex:0 0 32px;justify-content:center}.view-list-item__title{word-wrap:break-word;overflow-wrap:break-word;display:flex;flex:1 1 auto;padding-right:4px}.view-list-item__thumb{background-color:#f9fafd;background-color:var(--view-chapters-thumb-bg);background-size:cover;border-radius:4px;background-repeat:no-repeat;flex:0 0 56px;height:56px;width:56px;transition:border-color .1s}'],encapsulation:2,changeDetection:0}),$m),Xm=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},Ym=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function ey(e,t){if(1&e){var n=P.Wb();P.Vb(0,"div",2),P.cc("click",(function(){return P.zc(n),P.gc().handleCloseClick()})),P.Ub()}}function ty(e,t){1&e&&(P.Vb(0,"span",15),P.Mc(1,"(On)"),P.Ub())}function ny(e,t){1&e&&(P.Vb(0,"span",15),P.Mc(1,"(Off)"),P.Ub())}function iy(e,t){if(1&e){var n=P.Wb();P.Vb(0,"app-view-column",3),P.Vb(1,"nav",4),P.Vb(2,"app-view-panel",5),P.Qb(3,"app-view-logo"),P.Ub(),P.Vb(4,"app-view-panel",5),P.Vb(5,"button",6),P.cc("click",(function(){return P.zc(n),P.gc().handleCloseClick()})),P.Mc(6," Close "),P.Ub(),P.Ub(),P.Vb(7,"app-view-panel",5),P.Vb(8,"button",6),P.cc("click",(function(){return P.zc(n),P.gc().handleToggleToolbar("tools")})),P.Qb(9,"app-icon",7),P.Mc(10," Open Explore Tools "),P.Ub(),P.Vb(11,"button",6),P.cc("click",(function(){return P.zc(n),P.gc().handleToggleToolbar("media")})),P.Qb(12,"app-icon",8),P.Mc(13," Open Media Controls "),P.Ub(),P.Vb(14,"button",6),P.cc("click",(function(){return P.zc(n),P.gc().handleSearchClick()})),P.Qb(15,"app-icon",9),P.Mc(16," Search Anatomy "),P.Ub(),P.Ub(),P.Vb(17,"app-view-panel",5),P.Vb(18,"button",6),P.cc("click",(function(){return P.zc(n),P.gc().handleFullscreenClick()})),P.Qb(19,"app-icon",10),P.Mc(20," Enter Fullscreen "),P.Ub(),P.Ub(),P.Vb(21,"app-view-panel",5),P.Vb(22,"button",6),P.cc("click",(function(){return P.zc(n),P.gc().handleToggleLabelsClick()})),P.Qb(23,"app-icon",11),P.Vb(24,"span",12),P.Mc(25,"Toggle Labels"),P.Ub(),P.Kc(26,ty,2,0,"span",13),P.hc(27,"async"),P.Kc(28,ny,2,0,"span",13),P.hc(29,"async"),P.Ub(),P.Ub(),P.Vb(30,"app-view-panel",5),P.Vb(31,"button",14),P.cc("click",(function(){return P.zc(n),P.gc().handleTutorialClick()})),P.hc(32,"async"),P.Mc(33," Launch Tutorial "),P.Ub(),P.Vb(34,"button",6),P.cc("click",(function(){return P.zc(n),P.gc().handleHelpBasicsClick()})),P.Mc(35,"3D Navigation Basics"),P.Ub(),P.Vb(36,"button",6),P.cc("click",(function(){return P.zc(n),P.gc().handleHelpShortcutsClick()})),P.Mc(37,"Keyboard Shortcuts"),P.Ub(),P.Ub(),P.Ub(),P.Ub()}if(2&e){var i,o=P.gc();P.lc("@slideInOut",void 0),P.Db(2),P.lc("showHeader",!1),P.Db(2),P.lc("showHeader",!1),P.Db(3),P.lc("showHeader",!1),P.Db(10),P.lc("showHeader",!1),P.Db(4),P.lc("showHeader",!1),P.Db(5),P.lc("ngIf",P.ic(27,10,o.showLabels$)),P.Db(2),P.lc("ngIf",!P.ic(29,12,o.showLabels$)),P.Db(2),P.lc("showHeader",!1),P.Db(1),P.lc("disabled",!(null!=(i=P.ic(32,14,o.selectedChapterReady$))&&i.model))}}var oy,ry=((oy=function(){function e(t,n){m(this,e),this.store=t,this.viewService=n}return v(e,[{key:"ngOnInit",value:function(){}},{key:"handleCloseClick",value:function(){this.store.dispatch(new j.ToggleMenu(!1))}},{key:"handleToggleLabelsClick",value:function(){this.viewService.toggleLabels()}},{key:"handleFullscreenClick",value:function(){this.handleCloseClick(),Ys.toggleFullscreen()}},{key:"handleNewTabClick",value:function(){this.handleCloseClick(),this.viewService.openInNewTab()}},{key:"handleSearchClick",value:function(){this.handleCloseClick(),this.viewService.toggleSearch()}},{key:"handleTutorialClick",value:function(){this.handleCloseClick(),this.viewService.toggleTutorial(!0)}},{key:"handleHelpBasicsClick",value:function(){this.handleCloseClick(),this.viewService.toggleHelp(!0,ye.Basics)}},{key:"handleHelpShortcutsClick",value:function(){this.handleCloseClick(),this.viewService.toggleHelp(!0,ye.Shortcuts)}},{key:"handleToggleToolbar",value:function(e){this.handleCloseClick();var t=this.store.selectSnapshot(ku.getUI);t.media.status=sc.Hide,t.tools.status=sc.Hide,t.toolbar.status=sc.Hide,t[e].status=sc.Show,this.store.dispatch(new j.SetUI(t))}}]),e}()).\u0275fac=function(e){return new(e||oy)(P.Pb(E.g),P.Pb(td))},oy.\u0275cmp=P.Jb({type:oy,selectors:[["app-view-menu-column"]],decls:4,vars:6,consts:[["class","view-menu-scrim",3,"click",4,"ngIf"],["placement","right","class","view-menu-column",4,"ngIf"],[1,"view-menu-scrim",3,"click"],["placement","right",1,"view-menu-column"],["app-view-list-container",""],["padding","dense",3,"showHeader"],["app-view-list-item","",3,"click"],["icon","pen",1,"mr-3"],["icon","play",1,"mr-3"],["icon","search",1,"mr-3"],["icon","expand",1,"mr-3"],["icon","tag",1,"mr-3"],[1,"mr-3"],["class","text-dim",4,"ngIf"],["app-view-list-item","",3,"disabled","click"],[1,"text-dim"]],template:function(e,t){1&e&&(P.Kc(0,ey,1,0,"div",0),P.hc(1,"async"),P.Kc(2,iy,38,16,"app-view-column",1),P.hc(3,"async")),2&e&&(P.lc("ngIf",P.ic(1,2,t.menuOpen$)),P.Db(2),P.lc("ngIf",P.ic(3,4,t.menuOpen$)))},directives:[ra.l,Am,Vm,rb,Km,Jm,nl],pipes:[ra.b],styles:[".view-menu-column[_ngcontent-%COMP%]{position:absolute;top:0;right:0;z-index:10000;height:100%}.view-menu-scrim[_ngcontent-%COMP%]{background:rgba(0,0,0,.2);display:flex;position:fixed;justify-content:center;align-items:center;top:0;bottom:0;left:0;right:0;transition:background-color .25s,opacity .25s;z-index:10000}.view-menu-scrim[_ngcontent-%COMP%]:hover{opacity:1;cursor:pointer;background:var(--view-loader-scrim-bg--hover)}"],data:{animation:[Object(wu.n)("slideInOut",[Object(wu.m)(":enter",[Object(wu.l)({transform:"translateX(320px)"}),Object(wu.e)("200ms ease-out",Object(wu.l)({transform:"*"}))]),Object(wu.m)(":leave",[Object(wu.e)("200ms",Object(wu.l)({transform:"translateX(320px)"}))])])]},changeDetection:0}),Xm([Object(E.d)(Lr.getSelectedChapterReadyState),Ym("design:type",be.a)],oy.prototype,"selectedChapterReady$",void 0),Xm([Object(E.d)(ku.getMenuOpen),Ym("design:type",be.a)],oy.prototype,"menuOpen$",void 0),Xm([Object(E.d)(ku.getCanTouch),Ym("design:type",be.a)],oy.prototype,"canTouch$",void 0),Xm([Object(E.d)(Wr.getShowLabels),Ym("design:type",be.a)],oy.prototype,"showLabels$",void 0),oy),ay=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},sy=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function cy(e,t){if(1&e){var n=P.Wb();P.Vb(0,"div",1),P.cc("click",(function(){return P.zc(n),P.gc().handleToggle()}))("keyup.enter",(function(){return P.zc(n),P.gc().handleToggle()})),P.Qb(1,"app-icon",2),P.Ub()}if(2&e){var i=P.gc();P.lc("@show",void 0)("gaLabel",i.isIn?"Show":"Hide"),P.Db(1),P.lc("icon",i.isIn?"caret-right":"caret-left")}}var ly,uy,py,dy=((ly=function(){function e(t,n,i,o){m(this,e),this.viewService=t,this.layoutService=n,this.changeDetectorRef=i,this.store=o,this.ngUnsubscribe=new fe.a,this.isIn=!1,this.columnToggleVisible=!1}return v(e,[{key:"ngOnInit",value:function(){var e=this;Object(Gr.b)(this.chapter$,this.layout$).pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){var n=p(t,2),i=(n[0],n[1]);e.isIn=i.column.status===sc.Collapse,e.columnToggleVisible=e.layoutService.isVisible($u.ColumnToggle),e.changeDetectorRef.markForCheck()}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"isVisible",value:function(){return this.layoutService.isVisible($u.ColumnToggle)}},{key:"handleToggle",value:function(){this.viewService.toggleColumn(),this.viewService.toggleSearch(null,!1),this.viewService.toggleNodeInfo(!1),this.viewService.toggleLabelInfo(!1),this.changeDetectorRef.markForCheck()}}]),e}()).\u0275fac=function(e){return new(e||ly)(P.Pb(td),P.Pb(Yu),P.Pb(P.i),P.Pb(E.g))},ly.\u0275cmp=P.Jb({type:ly,selectors:[["app-view-column-toggle"]],decls:1,vars:1,consts:[["class","view-column-toggle","gaEvent","","gaCategory","View Information Panel","gaAction","Clicked Toggle Column","role","button","aria-label","Toggle Column","tabindex","0","matTooltip","Toggle Column","matTooltipPosition","right",3,"gaLabel","click","keyup.enter",4,"ngIf"],["gaEvent","","gaCategory","View Information Panel","gaAction","Clicked Toggle Column","role","button","aria-label","Toggle Column","tabindex","0","matTooltip","Toggle Column","matTooltipPosition","right",1,"view-column-toggle",3,"gaLabel","click","keyup.enter"],[3,"icon"]],template:function(e,t){1&e&&P.Kc(0,cy,2,3,"div",0),2&e&&P.lc("ngIf",t.columnToggleVisible)},directives:[ra.l,Ce.b,Ce.a,mg.c,nl],styles:[".view-column-toggle{background:#fff;color:#131c2a;box-shadow:1px -1px 2px 0 rgba(28,42,63,.1),0 1px 2px 0 rgba(28,42,63,.3);background:var(--view-column-toggle-background);box-shadow:var(--view-column-toggle-shadow);color:var(--view-column-toggle-color);border-radius:0 4px 4px 0;display:flex;justify-content:center;align-items:center;width:24px;height:48px}.view-column-toggle:hover{background-color:#131c2a;background-color:var(--view-column-toggle-background--hover);cursor:pointer}"],encapsulation:2,data:{animation:[Object(wu.n)("show",[Object(wu.m)(":enter",[Object(wu.l)({opacity:0,transform:"translateX(-32px)"}),Object(wu.e)("300ms ease-in-out",Object(wu.l)({opacity:1,transform:"*"}))]),Object(wu.m)(":leave",[Object(wu.e)("300ms ease-in-out",Object(wu.l)({transform:"translateX(-32px)",opacity:0}))])])]},changeDetection:0}),ay([Object(E.d)(ku.getUI),sy("design:type",be.a)],ly.prototype,"layout$",void 0),ay([Object(E.d)(Lr.getSelectedChapter),sy("design:type",be.a)],ly.prototype,"chapter$",void 0),ly);function gy(e,t){if(1&e&&(P.Vb(0,"div",5),P.Vb(1,"div",6),P.Qb(2,"app-icon",7),P.Ub(),P.Ub()),2&e){var n=P.gc(2);P.Db(2),P.lc("icon",n.icon)}}function hy(e,t){if(1&e){var n=P.Wb();P.Vb(0,"button",8),P.cc("click",(function(){return P.zc(n),P.gc(2).handleDismissClicked()})),P.Qb(1,"app-icon",9),P.Ub()}}function fy(e,t){if(1&e&&(P.Vb(0,"div",1),P.Kc(1,gy,3,1,"div",2),P.Vb(2,"div",3),P.jc(3),P.Ub(),P.Kc(4,hy,2,0,"button",4),P.Ub()),2&e){var n=P.gc();P.Hb("toggle--message","message"===n.type)("toggle--error","error"===n.type)("toggle--notification","notification"===n.type)("toggle--warning","warning"===n.type)("toggle--rounded","rounded"===n.toggleStyle)("toggle--light","light"===n.theme)("toggle--dark","dark"===n.theme),P.lc("@show",void 0),P.Db(1),P.lc("ngIf",n.icon),P.Db(3),P.lc("ngIf",n.dismiss)}}(py=uy||(uy={})).slideTransition=Object(wu.g)([Object(wu.l)({transform:"translateY({{ from }}%)",opacity:0}),Object(wu.e)("{{ duration }}ms ease-out",Object(wu.l)({transform:"translateY({{ to }})",opacity:1}))]),py.fadeIn=Object(wu.g)([Object(wu.l)({opacity:0}),Object(wu.e)("{{ duration }}ms ease-out",Object(wu.l)({opacity:1}))]),py.fadeOut=Object(wu.g)([Object(wu.l)({opacity:"*"}),Object(wu.e)("{{ duration }}ms ease-in",Object(wu.l)({opacity:0}))]);var by,vy=["*"],my=((by=function(){function e(t){m(this,e),this.changeRef=t,this.type="message",this.theme="light",this.showDelay=0,this.hideDelay=5e3,this.dismiss=!1,this.toggleStyle="rounded",this.handleDismiss=new fe.a,this._shown=!0,this.shownSubject=new fe.a,this.ngUnsubscribe=new fe.a}return v(e,[{key:"shown",get:function(){return this._shown},set:function(e){this._shown!==e&&(this._shown=e,this.shownSubject.next(e),this.changeRef.markForCheck())}},{key:"ngOnInit",value:function(){this.initViewShownListeners()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"handleDismissClicked",value:function(){this.handleDismiss.next()}},{key:"initViewShownListeners",value:function(){var e=this;this.shownSubject.pipe(Object(Jr.a)(this.hideDelay),Object(me.a)((function(e){return e})),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(){e._shown=!1,e.changeRef.markForCheck()}))}}]),e}()).\u0275fac=function(e){return new(e||by)(P.Pb(P.i))},by.\u0275cmp=P.Jb({type:by,selectors:[["app-message-toggle"]],inputs:{type:"type",theme:"theme",icon:"icon",showDelay:"showDelay",hideDelay:"hideDelay",dismiss:"dismiss",toggleStyle:"toggleStyle",shown:"shown"},outputs:{handleDismiss:"handleDismiss"},ngContentSelectors:vy,decls:1,vars:1,consts:[["class","toggle flex flex-row items-start",3,"toggle--message","toggle--error","toggle--notification","toggle--warning","toggle--rounded","toggle--light","toggle--dark",4,"ngIf"],[1,"toggle","flex","flex-row","items-start"],["class","mr-3",4,"ngIf"],[1,"toggle__content"],["class","toggle__icon toggle__dismiss",3,"click",4,"ngIf"],[1,"mr-3"],[1,"toggle__icon"],[3,"icon"],[1,"toggle__icon","toggle__dismiss",3,"click"],["icon","times"]],template:function(e,t){1&e&&(P.kc(),P.Kc(0,fy,5,17,"div",0)),2&e&&P.lc("ngIf",t.shown)},directives:[ra.l,nl],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3838}.text-info{color:#0060c4}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}:root{--message-toggle-color:#cadcf7;--message-toggle-background-color:#1c5ab9;--message-toggle-icon-color:#a6c6f8}.toggle{padding:16px;box-sizing:border-box;font-size:13px;letter-spacing:.325px;line-height:1.4em;color:var(--message-toggle-color);background-color:var(--message-toggle-background-color)}.toggle--rounded{border-radius:4px}.toggle__icon{display:flex;flex-direction:column;align-items:center;justify-content:center;color:#fff;font-size:16px;letter-spacing:.4px;line-height:1.4em;background:none;border:none;color:var(--message-toggle-icon-color)}.toggle__content{padding:0 2px;word-break:break-word;flex:1 1 auto}.toggle__dismiss{color:var(--message-toggle-color)}.toggle.toggle--message{--message-toggle-color:#33703c;--message-toggle-background-color:#eaf8ec;--message-toggle-icon-color:#47a75e}.toggle.toggle--notification{--message-toggle-color:#1b355f;--message-toggle-background-color:#d8eefd;--message-toggle-icon-color:blue-60}.toggle.toggle--warning{--message-toggle-color:#8b4e0c;--message-toggle-background-color:#fbf2e4;--message-toggle-icon-color:#eaac1a}.toggle.toggle--error{--message-toggle-color:#7e2525;--message-toggle-background-color:#f6dada;--message-toggle-icon-color:#cb4039}.toggle--dark.toggle--message{--message-toggle-color:#fff;--message-toggle-background-color:#47a75e;--message-toggle-icon-color:#fff}.toggle--dark.toggle--notification{--message-toggle-color:#fff;--message-toggle-background-color:#1c5ab9;--message-toggle-icon-color:#fff}.toggle--dark.toggle--warning{--message-toggle-color:#76430a;--message-toggle-background-color:#f7e7a1;--message-toggle-icon-color:#76430a}.toggle--dark.toggle--error{--message-toggle-color:#fff;--message-toggle-background-color:#cb4039;--message-toggle-icon-color:#fff}"],encapsulation:2,data:{animation:[Object(wu.n)("show",[Object(wu.m)(":enter",[Object(wu.o)(uy.fadeIn,{params:{duration:300}})]),Object(wu.m)(":leave",[Object(wu.o)(uy.fadeOut,{params:{duration:300}})])])]},changeDetection:0}),by);function yy(e,t){if(1&e){var n=P.Wb();P.Vb(0,"div",1),P.Vb(1,"app-message-toggle",2),P.cc("handleDismiss",(function(){return P.zc(n),P.gc().handleDismiss()})),P.Vb(2,"div"),P.Mc(3," This model appears to be performing slowly on your device. For an optimal experience, please switch to a different device or try another model. "),P.Ub(),P.Ub(),P.Ub()}2&e&&(P.Db(1),P.lc("dismiss",!0))}var xy,ky,wy,Oy,Cy,Sy=[],_y=((Oy=function(){function e(t,n){m(this,e),this.storageService=t,this.changeRef=n,this.shown=!1,this.sampling=!1}return v(e,[{key:"ngOnInit",value:function(){this.storageService.getLocalItem(Ls.Iphone12Warning)||this.testDevices()}},{key:"ngOnDestroy",value:function(){this.sampling=!1}},{key:"testDevices",value:function(){var e=window.matchMedia("only screen and (device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3)"),t=window.matchMedia("only screen and (device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3)"),n=window.matchMedia("only screen and (device-width: 820px) and (device-height: 1180px) and (-webkit-device-pixel-ratio: 2)"),i=e.matches||t.matches||n.matches,o=/iPhone|iPad/.test(navigator.userAgent),r=/OS\s14/.test(navigator.userAgent);i&&o&&r&&this.startFrameSampling()}},{key:"startFrameSampling",value:function(){var e=this;this.sampling=!0,xy=0,ky=Date.now(),requestAnimationFrame((function t(){e.frame()?(e.shown=!0,e.changeRef.markForCheck()):e.sampling&&requestAnimationFrame(t)}))}},{key:"frame",value:function(){xy++;var e=Date.now();if(e>=ky+500){var t=Math.floor(500*xy/(e-ky)*2);if(Sy.push(t),Sy.length>3&&Sy.shift(),3===Sy.length&&(Sy[0]+Sy[1]+Sy[2])/3<10)return!0;ky=e,xy=0}}},{key:"handleDismiss",value:function(){this.shown=!1,this.changeRef.markForCheck(),this.storageService.setLocalItem(Ls.Iphone12Warning,!0)}}]),e}()).\u0275fac=function(e){return new(e||Oy)(P.Pb(As),P.Pb(P.i))},Oy.\u0275cmp=P.Jb({type:Oy,selectors:[["app-view-iphone12-warning"]],decls:1,vars:1,consts:[["class","warning",4,"ngIf"],[1,"warning"],["type","warning","toggleStyle","flat","icon","info-circle",3,"dismiss","handleDismiss"]],template:function(e,t){1&e&&P.Kc(0,yy,4,1,"div",0),2&e&&P.lc("ngIf",t.shown)},directives:[ra.l,my],styles:[".warning[_ngcontent-%COMP%]{position:fixed;top:0;left:0;right:0;z-index:1002}.warning__text[_ngcontent-%COMP%]{text-align:center;flex:1}"],changeDetection:0}),Oy),jy=((wy=function(){function e(){m(this,e)}return v(e,[{key:"onClick",value:function(e,t){t.select()}}]),e}()).\u0275fac=function(e){return new(e||wy)},wy.\u0275dir=P.Kb({type:wy,selectors:[["","appSelectOnFocus",""]],hostBindings:function(e,t){1&e&&P.cc("click",(function(e){return t.onClick(e,e.target)}))}}),wy),Py=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},My=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Iy=["searchInput"],zy=function(e){return{"view-search__action--selected":e}},Ty=((Cy=function(){function e(t,n,i){m(this,e),this.viewService=t,this.engineService=n,this.store=i,this.ngUnsubscribe=new fe.a,this.query="",this.treeTheme=mc,this.treeSearchDisplayMode=Yl}return v(e,[{key:"ngOnInit",value:function(){this.initViewGraphSubscription(),this.initDisplayModeSubscription()}},{key:"initViewGraphSubscription",value:function(){var e=this;this.store.select(Lr.getSelectedChapterId).pipe(Object(me.a)((function(e){return null!=e})),Object(Xr.a)(),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(){e.store.dispatch(new Fe(e.engineService.createViewGraph({},!1)))}))}},{key:"initDisplayModeSubscription",value:function(){var e=this;this.searchDisplayMode$.pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){setTimeout((function(){e.searchInput.nativeElement.focus()}))}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"handleSearchKeyup",value:function(e,t){"Escape"===e.key&&(this.handleExitClick(),this.searchInput.nativeElement.blur()),this.query=t}},{key:"handleExitClick",value:function(){this.query="",this.viewService.toggleSearch(null,!1)}},{key:"toggleDisplayMode",value:function(){var e=this.store.selectSnapshot(ku.getSearchDisplayMode);e=e===Yl.List?Yl.Tree:Yl.List,this.setDisplayMode(e)}},{key:"setDisplayMode",value:function(e){this.store.dispatch(new j.SetSearchDisplayMode(e))}},{key:"handleTreeButtonClick",value:function(){this.setDisplayMode(Yl.Tree)}},{key:"handleListButtonClick",value:function(){this.setDisplayMode(Yl.List)}}]),e}()).\u0275fac=function(e){return new(e||Cy)(P.Pb(td),P.Pb(Nt),P.Pb(E.g))},Cy.\u0275cmp=P.Jb({type:Cy,selectors:[["app-view-search"]],viewQuery:function(e,t){var n;1&e&&P.Rc(Iy,!0),2&e&&P.uc(n=P.dc())&&(t.searchInput=n.first)},decls:23,vars:22,consts:[["gaCategory","View Search",1,"view-search"],[1,"view-search__header"],[1,"view-search__actions-row"],[1,"view-search__actions"],["gaEvent","","gaAction","Clicked Anatomy Tree","type","button","aria-label","Switch to Anatomy Tree",1,"view-search__action",3,"ngClass","matTooltip","click"],["aria-hidden","true",1,"view-search__action-icon",3,"icon"],["gaEvent","","gaAction","Clicked Search","type","button","aria-label","Switch to Search",1,"view-search__action",3,"ngClass","matTooltip","click"],["aria-hidden","true","icon","search",1,"view-search__action-icon"],["gaEvent","","gaAction","Clicked Exit","type","button","matTooltip","Close Search","aria-label","Close Search",1,"view-search__exit",3,"click"],["icon","times"],[1,"view-search__input-row"],[1,"view-search__input-container"],["icon","search",1,"view-search__input-icon"],["appAutoFocus","","appSelectOnFocus","","role","search","type","text","aria-label","Search Anatomy","placeholder","Search Anatomy",1,"view-search__input",3,"value","keyup"],["searchInput",""],[1,"view-search__body"],[3,"displayMode","theme","query","viewGraph"]],template:function(e,t){if(1&e){var n=P.Wb();P.Vb(0,"div",0),P.Vb(1,"div",1),P.Vb(2,"div",2),P.Vb(3,"div",3),P.Vb(4,"button",4),P.cc("click",(function(){return t.handleTreeButtonClick()})),P.hc(5,"async"),P.Qb(6,"app-icon",5),P.Mc(7,"Tree "),P.Ub(),P.Vb(8,"button",6),P.cc("click",(function(){return t.handleListButtonClick()})),P.hc(9,"async"),P.Qb(10,"app-icon",7),P.Mc(11,"Search "),P.Ub(),P.Ub(),P.Vb(12,"button",8),P.cc("click",(function(){return t.handleExitClick()})),P.Qb(13,"app-icon",9),P.Ub(),P.Ub(),P.Vb(14,"div",10),P.Vb(15,"div",11),P.Qb(16,"app-icon",12),P.Vb(17,"input",13,14),P.cc("keyup",(function(e){P.zc(n);var i=P.vc(18);return t.handleSearchKeyup(e,i.value)})),P.Ub(),P.Ub(),P.Ub(),P.Ub(),P.Vb(19,"div",15),P.Qb(20,"app-tree-search",16),P.hc(21,"async"),P.hc(22,"async"),P.Ub(),P.Ub()}2&e&&(P.Db(4),P.lc("ngClass",P.oc(18,zy,P.ic(5,10,t.searchDisplayMode$)===t.treeSearchDisplayMode.Tree))("matTooltip","Switch to Anatomy Tree"),P.Db(2),P.lc("icon","sitemap"),P.Db(2),P.lc("ngClass",P.oc(20,zy,P.ic(9,12,t.searchDisplayMode$)===t.treeSearchDisplayMode.List))("matTooltip","Switch to Search"),P.Db(9),P.lc("value",t.query),P.Db(3),P.lc("displayMode",P.ic(21,14,t.searchDisplayMode$))("theme",t.treeTheme.Themed)("query",t.query)("viewGraph",P.ic(22,16,t.viewGraph$)))},directives:[Ce.a,Ce.b,ra.i,mg.c,nl,Ll,jy,eu],pipes:[ra.b],styles:[".view-search{display:flex;flex-direction:column;height:100%}@-webkit-keyframes appear{0%{background-color:transparent}}@keyframes appear{0%{background-color:transparent}}.view-search__header{flex:0 0 auto;flex-direction:column;display:flex;-webkit-animation:appear .25s ease-out;animation:appear .25s ease-out}.view-search__actions-row{flex:0 0 auto;display:flex;padding:0 12px;justify-content:space-between;align-items:center;border-bottom:1px solid var(--view-search-border-color)}.view-search__actions{display:flex;height:56px;flex:1;justify-content:space-between}.view-search__action{text-transform:uppercase;background:transparent;display:flex;align-items:center;justify-content:center;border:0;border-bottom:4px solid transparent;color:#374a68;color:var(--view-search-tab-color);cursor:pointer;width:49%;outline:none;padding-top:4px}.view-search__action:hover:not(.view-search__action--selected){color:#131c2a;border-bottom-color:#d7e0ea;color:var(--view-search-tab-hover-color);border-bottom-color:var(--view-search-tab-hover-border)}.view-search__action--selected{color:#131c2a;border-bottom-color:#2d72dc;color:var(--view-search-tab-active-color);border-bottom-color:var(--view-search-tab-active-border)}.view-search__action-icon{margin-right:8px}.view-search__exit{display:flex;align-items:center;justify-content:center;border:0;border-radius:50%;color:#374a68;background-color:#d7e0ea;color:var(--view-search-exit-color);background-color:var(--view-search-exit-bg);opacity:.8;cursor:pointer;width:28px;height:28px;margin-left:12px;outline:none}.view-search__input-row{flex:0 0 auto;display:flex;padding:12px}.view-search__input-container{background-color:#fff;background-color:var(--view-search-input-bg);border:1px solid var(--view-search-border-color);display:flex;flex-grow:1;border-radius:4px}.view-search__input-icon{background:0 0;display:flex;align-items:center;justify-content:center;color:#96a8c0;color:var(--view-search-inactive-color);width:36px;height:36px;outline:0}.view-search__input{color:#131c2a;color:var(--view-search-active-color);background:transparent;border:1px solid transparent;outline:none;flex:1 0 auto;padding:8px 12px 8px 0;font-size:13px}.view-search__input::-ms-clear{display:none}.view-search__input::-moz-placeholder{color:#96a8c0;color:var(--view-search-inactive-color)}.view-search__input:-ms-input-placeholder{color:#96a8c0;color:var(--view-search-inactive-color)}.view-search__input::placeholder{color:#96a8c0;color:var(--view-search-inactive-color)}.view-search__body{flex:1 1 100%;overflow-y:scroll;padding-left:12px}.view-search__input{font-family:Inter UI,Font Awesome\\ 5 Pro!important}@media not all and (min-resolution:0.001dpcm){@supports (-webkit-appearance:none){.view-search__input{font-size:16px;padding:4px 8px;width:0}}}"],encapsulation:2,changeDetection:0}),Py([Object(E.d)(Wr.getViewGraph),My("design:type",be.a)],Cy.prototype,"viewGraph$",void 0),Py([Object(E.d)(ku.getSearchDisplayMode),My("design:type",be.a)],Cy.prototype,"searchDisplayMode$",void 0),Cy),Uy=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Ly(e,t){if(1&e){var n=P.Wb();P.Vb(0,"button",6),P.cc("click",(function(){return P.zc(n),P.gc().handleCloseClick()})),P.Ub()}}function Dy(e,t){if(1&e&&P.Qb(0,"div",7),2&e){var n=P.gc();P.Hb("text-italic",!(null!=n.node&&n.node.description)),P.lc("innerHTML",n.formatHTML((null==n.node?null:n.node.description)||"No description available"),P.Ac)}}function Ey(e,t){1&e&&(P.Vb(0,"div",8),P.Mc(1," Source: "),P.Vb(2,"span",9),P.Mc(3,"Wikipedia"),P.Ub(),P.Ub())}var Fy,Ay=function(e,t){return{"view-node-description--layout-column":e,"view-node-description--layout-drawer":t}},Ry=((Fy=function(){function e(t,n,i){m(this,e),this.store=t,this.actions=n,this.changeRef=i,this.layout=Ku.Drawer,this.showClose=!0,this.isOpen=!1,this.ngUnsubscribe=new fe.a}return v(e,[{key:"ngOnInit",value:function(){var e=this;this.initInfoListeners(),this.store.select(Ai.getSelectedNode).pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){void 0!==t&&(e.node=e.store.selectSnapshot(Wr.getViewGraphNode)(t.objectId))}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"handleHideClick",value:function(e){this.store.dispatch(new pi.UpdateNodesShown(!1,[e.id]))}},{key:"handleCloseClick",value:function(){var e=this.store.selectSnapshot(ku.getUI);e.nodeInfo.status=sc.Hide,this.store.dispatch(new j.SetUI(e))}},{key:"initInfoListeners",value:function(){var e=this;this.actions.pipe(Object(E.i)(kt,wt,yt),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(){e.isOpen=!0,e.changeRef.markForCheck()}))}},{key:"formatHTML",value:function(e){return e.trim().replace(new RegExp("\r?\n","g"),"<br><br>")}}]),e}()).\u0275fac=function(e){return new(e||Fy)(P.Pb(E.g),P.Pb(E.b),P.Pb(P.i))},Fy.\u0275cmp=P.Jb({type:Fy,selectors:[["app-view-node-description"]],inputs:{layout:"layout",showClose:"showClose"},decls:8,vars:10,consts:[[1,"view-node-description",3,"ngClass"],[1,"view-node-description__header"],["app-pin-button","","size","small","icon","arrow-left","class","mr-1 mt-1",3,"click",4,"ngIf"],[1,"view-node-description__title"],["class","view-node-description__body",3,"text-italic","innerHTML",4,"ngIf"],["class","view-node-description__attribution",4,"ngIf"],["app-pin-button","","size","small","icon","arrow-left",1,"mr-1","mt-1",3,"click"],[1,"view-node-description__body",3,"innerHTML"],[1,"view-node-description__attribution"],[1,"text-italic"]],template:function(e,t){1&e&&(P.Vb(0,"div",0),P.Vb(1,"div",1),P.Kc(2,Ly,1,0,"button",2),P.Vb(3,"div",3),P.Mc(4),P.Ub(),P.Ub(),P.Kc(5,Dy,1,3,"div",4),P.hc(6,"async"),P.Kc(7,Ey,4,0,"div",5),P.Ub()),2&e&&(P.lc("ngClass",P.pc(7,Ay,"column"===t.layout,"drawer"===t.layout)),P.Db(2),P.lc("ngIf",t.showClose),P.Db(2),P.Nc(null==t.node?null:t.node.label),P.Db(1),P.lc("ngIf",!P.ic(6,5,t.querying$)),P.Db(2),P.lc("ngIf",null==t.node?null:t.node.description))},directives:[ra.i,ra.l,vg],pipes:[ra.b],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3838}.text-info{color:#0060c4}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.view-node-description{display:flex;flex-direction:column}.view-node-description--layout-drawer .view-node-description__body{margin-top:8px}.view-node-description--layout-column .view-node-description__body{margin-top:4px}.view-node-description__header{display:flex}.view-node-description__title{font-size:18px;letter-spacing:.45px;line-height:1.4em;flex:1 1 auto;font-weight:600;align-self:center}.view-node-description--layout-drawer .view-node-description__title,.view-node-description__body{font-size:14px;letter-spacing:.35px;line-height:1.4em}.view-node-description__attribution,.view-node-description__body{color:var(--view-description-secondary-color)}.view-node-description__attribution{margin-top:16px;font-size:12px;letter-spacing:.3px;line-height:1.4em}.view-node-description__actions{cursor:pointer;outline:none;border:none;background:transparent;padding:4px 8px}"],encapsulation:2,changeDetection:0}),function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);r>3&&a&&Object.defineProperty(t,n,a)}([Object(E.d)(Wr.getQuerying),Uy("design:type",be.a)],Fy.prototype,"querying$",void 0),Fy),Vy=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},Ny=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function By(e,t){1&e&&(P.Tb(0),P.Qb(1,"app-view-title"),P.Qb(2,"app-view-content-mode",6),P.Sb())}function Hy(e,t){1&e&&P.Qb(0,"app-view-quiz")}function Qy(e,t){if(1&e&&(P.Vb(0,"app-view-column",3),P.Tb(1,4),P.Kc(2,By,3,0,"ng-container",5),P.hc(3,"async"),P.Kc(4,Hy,1,0,"app-view-quiz",5),P.hc(5,"async"),P.Sb(),P.Ub()),2&e){var n=P.gc();P.lc("@slideInOut",void 0),P.Db(2),P.lc("ngIf",!P.ic(3,3,n.quizModeActive$)),P.Db(2),P.lc("ngIf",P.ic(5,5,n.quizModeActive$))}}function qy(e,t){1&e&&(P.Vb(0,"app-view-column",7),P.Qb(1,"app-view-search"),P.Ub()),2&e&&P.lc("unpadded",!0)("@slideInOut",void 0)}function Wy(e,t){1&e&&(P.Vb(0,"app-view-column",3),P.Qb(1,"app-view-node-description",6),P.Ub()),2&e&&P.lc("@slideInOut",void 0)}var $y,Ky=function(){return{"view-column-container--header-offset":!0}},Gy=(($y=function(){function e(t,n,i){m(this,e),this.viewService=t,this.layoutService=n,this.changeDetectorRef=i,this.ngUnsubscribe=new fe.a,this.viewLayout=$u,this.application=M,this.columnVisible=!1,this.searchVisible=!1,this.nodeInfoVisible=!1}return v(e,[{key:"ngOnInit",value:function(){this.initLayoutObserver()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initLayoutObserver",value:function(){var e=this;Object(Gr.b)(this.layout$,this.chapter$).pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){var n;f(n=t)||l(n)||g(n)||d(),e.columnVisible=e.layoutService.isVisible($u.Column),e.searchVisible=e.layoutService.isVisible($u.Search),e.nodeInfoVisible=e.layoutService.isVisible($u.NodeInfo),e.changeDetectorRef.markForCheck()}))}},{key:"handleSearchClick",value:function(){this.viewService.toggleSearch(null,!0)}}]),e}()).\u0275fac=function(e){return new(e||$y)(P.Pb(td),P.Pb(Yu),P.Pb(P.i))},$y.\u0275cmp=P.Jb({type:$y,selectors:[["app-view-column-container"]],decls:4,vars:5,consts:[[1,"view-column-container",3,"ngClass"],["class","view-column-container__inner",4,"ngIf"],["class","view-column-container__inner",3,"unpadded",4,"ngIf"],[1,"view-column-container__inner"],["view-column-body",""],[4,"ngIf"],["layout","column"],[1,"view-column-container__inner",3,"unpadded"]],template:function(e,t){1&e&&(P.Vb(0,"div",0),P.Kc(1,Qy,6,7,"app-view-column",1),P.Kc(2,qy,2,2,"app-view-column",2),P.Kc(3,Wy,2,1,"app-view-column",1),P.Ub()),2&e&&(P.lc("ngClass",P.nc(4,Ky)),P.Db(1),P.lc("ngIf",t.columnVisible),P.Db(1),P.lc("ngIf",t.searchVisible),P.Db(1),P.lc("ngIf",t.nodeInfoVisible))},directives:[ra.i,ra.l,Am,Yf,zb,cm,Ty,Ry],pipes:[ra.b],styles:[".view-column-container{pointer-events:none;height:100%;width:320px;position:absolute;left:0;top:0;z-index:30}.view-column-container app-view-column{position:absolute;left:0;top:0;height:100%;z-index:40}"],encapsulation:2,data:{animation:[Object(wu.n)("slideInOut",[Object(wu.m)(":enter",[Object(wu.l)({transform:"translateX(-320px)"}),Object(wu.e)("300ms ease-in-out",Object(wu.l)({transform:"*"}))]),Object(wu.m)(":leave",[Object(wu.e)("300ms ease-in-out",Object(wu.l)({transform:"translateX(-320px)"}))])])]},changeDetection:0}),Vy([Object(E.d)(Lr.getSelectedChapter),Ny("design:type",be.a)],$y.prototype,"chapter$",void 0),Vy([Object(E.d)(ku.getUI),Ny("design:type",be.a)],$y.prototype,"layout$",void 0),Vy([Object(E.d)(_o.getQuizModeActive),Ny("design:type",be.a)],$y.prototype,"quizModeActive$",void 0),$y);function Zy(e,t){if(1&e){var n=P.Wb();P.Vb(0,"button",7),P.cc("click",(function(){return P.zc(n),P.gc(2).handleActionClick()})),P.Mc(1),P.Ub()}if(2&e){var i=P.gc(2);P.Db(1),P.Oc(" ",i.notification.action," ")}}function Jy(e,t){if(1&e){var n=P.Wb();P.Vb(0,"div",1),P.Vb(1,"div",2),P.Vb(2,"div",3),P.Mc(3),P.Ub(),P.Vb(4,"button",4),P.cc("click",(function(){return P.zc(n),P.gc().handleCloseClick()})),P.Qb(5,"app-icon",5),P.Ub(),P.Ub(),P.Kc(6,Zy,2,1,"button",6),P.Ub()}if(2&e){var i=P.gc();P.lc("@show",void 0),P.Db(3),P.Oc(" ",i.notification.body," "),P.Db(3),P.lc("ngIf",i.notification.action)}}var Xy,Yy,ex,tx=((Xy=function(){function e(){m(this,e),this.closeClick=new P.p}return v(e,[{key:"ngOnInit",value:function(){}},{key:"handleActionClick",value:function(){this.close(this.notification.action)}},{key:"handleCloseClick",value:function(){this.close()}},{key:"close",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.notification=null,this.closeClick.emit({action:e,data:this.notification})}}]),e}()).\u0275fac=function(e){return new(e||Xy)},Xy.\u0275cmp=P.Jb({type:Xy,selectors:[["app-notification"]],inputs:{notification:"notification"},outputs:{closeClick:"closeClick"},decls:1,vars:1,consts:[["class","notification",4,"ngIf"],[1,"notification"],[1,"flex"],[1,"notification__body","flex-grow"],["type","button",1,"notification__button","notification__button--close",3,"click"],["icon","times"],["class","notification__button notification__button--full","type","button",3,"click",4,"ngIf"],["type","button",1,"notification__button","notification__button--full",3,"click"]],template:function(e,t){1&e&&P.Kc(0,Jy,7,3,"div",0),2&e&&P.lc("ngIf",t.notification)},directives:[ra.l,nl],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3838}.text-info{color:#0060c4}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.notification{font-size:12px;letter-spacing:.3px;line-height:1.4em;background:#2d72dc;width:320px;border-radius:4px;box-shadow:0 2px 4px rgba(0,0,0,.08),0 4px 6px rgba(0,0,0,.12)}.notification__body{color:#fff;padding:16px}.notification__button{align-items:center;justify-content:center;background:#2d72dc;border:0;color:#fff;display:flex;font-weight:600;height:36px;font-size:12px;letter-spacing:.3px;line-height:1.4em}.notification__button:hover{background-color:#4381e0;cursor:pointer}.notification__button--close{border-radius:0 4px 0 4px;flex:0 0 36px;height:36px}.notification__button--full{border-radius:0 0 4px 4px;border-top:1px solid hsla(0,0%,100%,.2);justify-content:left;padding:0 16px;text-overflow:ellipsis;white-space:nowrap;width:100%}"],encapsulation:2,data:{animation:[Object(wu.n)("show",[Object(wu.m)(":enter",[Object(wu.o)(uy.fadeIn,{params:{duration:300}})])])]},changeDetection:0}),Xy),nx=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},ix=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},ox={stacksForChapter:{}},rx=((ex=function(){function e(t){m(this,e),this.store=t}return v(e,[{key:"reset",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){e.stacksForChapter={}})))}},{key:"undoAll",value:function(e,t){var n=e.getState();if(void 0!==n.stacksForChapter[t.chapterId]){var i=c(n.stacksForChapter[t.chapterId].undoStack).reverse(),o=i.flat().reduce((function(e,t){return void 0===e[t.patchAction]&&(e[t.patchAction]={action:t.patchAction,patches:[]}),e[t.patchAction].patches=[].concat(c(e[t.patchAction].patches),c(t.inverse)),e}),{});Object.keys(o).forEach((function(t){e.dispatch(new o[t].action(o[t].patches))}));var r=immer.produce(n,(function(e){e.stacksForChapter[t.chapterId].undoStack=[],e.stacksForChapter[t.chapterId].redoStack=i}));e.patchState(r)}}},{key:"preserveState",value:function(e,t){var n=this.store.selectSnapshot(Lr.getSelectedChapterId),i=immer.produce(e.getState(),(function(e){0!==t.patches.length&&(t.patches.some((function(e){return 0===e.forward.length}))&&t.patches.some((function(e){return 0===e.inverse.length}))||(void 0===e.stacksForChapter[n]&&(e.stacksForChapter[n]={redoStack:[],undoStack:[]}),e.stacksForChapter[n].redoStack=[],e.stacksForChapter[n].undoStack.push(t.patches)))}));e.patchState(i)}},{key:"redo",value:function(e,t){var n=e.getState(),i=Object(Se.get)(n.stacksForChapter[t.chapterId],"redoStack",[]);if(0!==i.length){var o=i[i.length-1],r=immer.produce(n,(function(e){e.stacksForChapter[t.chapterId].redoStack.pop(),e.stacksForChapter[t.chapterId].undoStack.push(o)}));e.patchState(r),o.forEach((function(t){e.dispatch(new t.patchAction(t.forward))}))}}},{key:"undo",value:function(e,t){var n=e.getState(),i=Object(Se.get)(n.stacksForChapter[t.chapterId],"undoStack",[]);if(0!==i.length){var o=i[i.length-1],r=immer.produce(n,(function(e){e.stacksForChapter[t.chapterId].undoStack.pop(),e.stacksForChapter[t.chapterId].redoStack.push(o)}));e.patchState(r),o.forEach((function(t){e.dispatch(new t.patchAction(t.inverse))}))}}}],[{key:"canUndo",value:function(e,t){return e.stacksForChapter[t.selectedChapter].undoStack.length>0}},{key:"canRedo",value:function(e,t){return e.stacksForChapter[t.selectedChapter].redoStack.length>0}},{key:"getUndoCount",value:function(e,t){return e.stacksForChapter[t.selectedChapter].undoStack.length||0}}]),e}()).\u0275fac=function(e){return new(e||ex)(P.Zb(E.g))},ex.\u0275prov=P.Lb({token:ex,factory:ex.\u0275fac}),nx([Object(E.a)(di.Reset),ix("design:type",Function),ix("design:paramtypes",[Object,di.Reset]),ix("design:returntype",void 0)],ex.prototype,"reset",null),nx([Object(E.a)(di.UndoAll),ix("design:type",Function),ix("design:paramtypes",[Object,di.UndoAll]),ix("design:returntype",void 0)],ex.prototype,"undoAll",null),nx([Object(E.a)(di.SavePatches),ix("design:type",Function),ix("design:paramtypes",[Object,di.SavePatches]),ix("design:returntype",void 0)],ex.prototype,"preserveState",null),nx([Object(E.a)(di.Redo),ix("design:type",Function),ix("design:paramtypes",[Object,di.Redo]),ix("design:returntype",void 0)],ex.prototype,"redo",null),nx([Object(E.a)(di.Undo),ix("design:type",Function),ix("design:paramtypes",[Object,di.Undo]),ix("design:returntype",void 0)],ex.prototype,"undo",null),nx([Object(E.e)([Lr]),ix("design:type",Function),ix("design:paramtypes",[Object,bn]),ix("design:returntype",Boolean)],ex,"canUndo",null),nx([Object(E.e)([Lr]),ix("design:type",Function),ix("design:paramtypes",[Object,bn]),ix("design:returntype",Boolean)],ex,"canRedo",null),nx([Object(E.e)([Lr]),ix("design:type",Function),ix("design:paramtypes",[Object,bn]),ix("design:returntype",Number)],ex,"getUndoCount",null),ex=nx([Object(E.f)({name:"undo",defaults:ox})],ex)),ax=((Yy=function(){function e(){m(this,e)}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||Yy)},Yy.\u0275cmp=P.Jb({type:Yy,selectors:[["app-pillbox-divider"]],decls:1,vars:0,consts:[[1,"pillbox-divider"]],template:function(e,t){1&e&&P.Qb(0,"div",0)},styles:[".pillbox-divider{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;border-right:1px solid rgba(0,0,0,.1);border-right:var(--pillbox-border);height:18px;margin:0 8px}"],encapsulation:2,changeDetection:0}),Yy);function sx(e,t){if(1&e){var n=P.Wb();P.Tb(0),P.Qb(1,"app-pillbox-divider"),P.Vb(2,"button",2),P.cc("click",(function(){return P.zc(n),P.gc().handleExitClick()})),P.Ub(),P.Sb()}if(2&e){var i=P.gc();P.Db(2),P.lc("gaAction","Clicked Close "+i.name)("matTooltip","Close "+i.name),P.Eb("aria-label","Close "+i.name)}}var cx,lx=function(e,t,n){return{"pillbox--padding-dense":e,"pillbox--padding-none":t,"pillbox--vertical":n}},ux=["*"],px=((cx=function(){function e(){m(this,e),this.canExit=!1,this.padding="normal",this.orientation="horizontal",this.name="",this.eventCategory="",this.exit=new P.p}return v(e,[{key:"ngOnInit",value:function(){}},{key:"handleExitClick",value:function(){this.exit.emit()}}]),e}()).\u0275fac=function(e){return new(e||cx)},cx.\u0275cmp=P.Jb({type:cx,selectors:[["app-pillbox"]],inputs:{canExit:"canExit",padding:"padding",orientation:"orientation",name:"name",eventCategory:"eventCategory"},outputs:{exit:"exit"},ngContentSelectors:ux,decls:3,vars:7,consts:[[1,"pillbox",3,"gaCategory","ngClass"],[4,"ngIf"],["gaEvent","","data-test","closePillboxButton","app-pin-button","","buttonType","ghost","icon","times",3,"gaAction","matTooltip","click"]],template:function(e,t){1&e&&(P.kc(),P.Vb(0,"div",0),P.jc(1),P.Kc(2,sx,3,3,"ng-container",1),P.Ub()),2&e&&(P.lc("gaCategory",t.eventCategory)("ngClass",P.qc(3,lx,"dense"===t.padding,"none"===t.padding,"vertical"===t.orientation)),P.Db(2),P.lc("ngIf",t.canExit))},directives:[Ce.a,ra.i,ra.l,ax,vg,Ce.b,mg.c],styles:[".pillbox{border-radius:32px;background-color:hsla(0,0%,100%,.9);box-shadow:1px -1px 2px 0 rgba(28,42,63,.1),0 1px 2px 0 rgba(28,42,63,.3);color:#131c2a;background-color:var(--pillbox-bg);box-shadow:var(--pillbox-shadow);color:var(--pillbox-color);padding:6px;display:inline-flex;justify-content:center;align-items:center;overflow:hidden;transition:padding .15s}.pillbox--padding-dense{padding:4px}.pillbox--padding-none{padding:0}.pillbox--vertical{flex-direction:column;padding:6px}"],encapsulation:2,changeDetection:0}),cx),dx=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},gx=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function hx(e,t){if(1&e){var n=P.Wb();P.Vb(0,"div",1),P.Vb(1,"app-pillbox",2),P.Vb(2,"button",3),P.cc("click",(function(){return P.zc(n),P.gc().handleUndoClick()})),P.hc(3,"async"),P.hc(4,"async"),P.Ub(),P.Vb(5,"button",4),P.cc("click",(function(){return P.zc(n),P.gc().handleRedoClick()})),P.hc(6,"async"),P.hc(7,"async"),P.Ub(),P.Vb(8,"button",5),P.cc("click",(function(){return P.zc(n),P.gc().handleResetClick()})),P.hc(9,"async"),P.hc(10,"async"),P.Vb(11,"span",6),P.Mc(12,"Reset"),P.Ub(),P.Ub(),P.Ub(),P.Ub()}if(2&e){var i=P.gc();P.lc("@show",void 0),P.Db(2),P.lc("disabled",!P.ic(4,9,i.canUndo$)),P.Eb("aria-disabled",!P.ic(3,7,i.canUndo$)),P.Db(3),P.lc("disabled",!P.ic(7,13,i.canRedo$)),P.Eb("aria-disabled",!P.ic(6,11,i.canRedo$)),P.Db(3),P.lc("disabled",!P.ic(10,17,i.canUndo$)),P.Eb("aria-disabled",!P.ic(9,15,i.canUndo$))}}var fx,bx,vx=((fx=function(){function e(t){m(this,e),this.viewService=t}return v(e,[{key:"ngOnInit",value:function(){}},{key:"handleUndoClick",value:function(){this.viewService.undo()}},{key:"handleRedoClick",value:function(){this.viewService.redo()}},{key:"handleResetClick",value:function(){this.viewService.resetChapter()}}]),e}()).\u0275fac=function(e){return new(e||fx)(P.Pb(td))},fx.\u0275cmp=P.Jb({type:fx,selectors:[["app-view-undo"]],decls:2,vars:3,consts:[["class","view-undo",4,"ngIf"],[1,"view-undo"],["padding","dense"],["app-pin-button","","data-test","undo-btn","buttonType","ghost","icon","undo","aria-label","Undo","matTooltip","Undo",1,"mr-2",3,"disabled","click"],["buttonType","ghost","app-pin-button","","data-test","redo-btn","aria-label","Redo","matTooltip","Redo","icon","redo",1,"mr-2",3,"disabled","click"],["app-pin-button","","buttonType","ghost",3,"disabled","click"],[1,"ph-4","text-bold"]],template:function(e,t){1&e&&(P.Kc(0,hx,13,19,"div",0),P.hc(1,"async")),2&e&&P.lc("ngIf",P.ic(1,1,t.canUndo$))},directives:[ra.l,px,vg,mg.c],pipes:[ra.b],styles:["[_nghost-%COMP%]{display:flex;justify-content:center;width:100%;padding:8px 0;pointer-events:none}"],data:{animation:[Object(wu.n)("show",[Object(wu.m)(":enter",Object(wu.j)([Object(wu.l)({transform:"translateY(-100%)",opacity:0}),Object(wu.e)("150ms ease-in-out",Object(wu.l)({transform:"translateY(0%)",opacity:1}))]))])]},changeDetection:0}),dx([Object(E.d)(rx.canUndo),gx("design:type",be.a)],fx.prototype,"canUndo$",void 0),dx([Object(E.d)(rx.canRedo),gx("design:type",be.a)],fx.prototype,"canRedo$",void 0),dx([Object(E.d)(rx.getUndoCount),gx("design:type",be.a)],fx.prototype,"undoCount$",void 0),fx),mx=h("gcYM"),yx=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},xx=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},kx=["scrubber"],wx=["track"],Ox=["bar"],Cx=["handle"],Sx=function(e){return{"view-scrubber--draggable":e}},_x=function(e,t){return{"view-scrubber__handle--hide":e,"view-scrubber__handle-touch":t}},jx=((bx=function(){function e(t,n,i,o,r,a){m(this,e),this.engineService=t,this.animationService=n,this.renderer=i,this.viewService=o,this.changeDetectorRef=r,this.store=a,this.showHandle=!0,this.ngUnsubscribe=new fe.a,this.trackWidth=0,this.dragPosition={x:16,y:0},this.playing=!0}return v(e,[{key:"ngOnInit",value:function(){this.initChapterListener(),this.initTimelineListener()}},{key:"ngAfterViewInit",value:function(){this.initDragListener()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initChapterListener",value:function(){var e=this;this.selectedChapterId$.pipe(Object(me.a)((function(e){return null!=e})),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){e.timerange=e.animationService.getChapterLocalTimerange(t)}))}},{key:"initTimelineListener",value:function(){var e=this;this.engineService.getEvent(Dt.TimelinePlaying).pipe(Object(mx.a)(20),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){return e.tick(t.time)})),this.engineService.getEvent(Dt.TimelineScrubbed).pipe(Object(mx.a)(20),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){var n=e.calcScrubbedPercent(t.time);e.setScrubberBar(n)}))}},{key:"initDragListener",value:function(){var e=this;this.dragInstance.moved.pipe(Object(ea.a)(20),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){var n=e.calculateHandlePercent();e.scrubToPercent(n)}))}},{key:"handleDragStart",value:function(){this.playing=this.store.selectSnapshot(Wr.getAnimationPlaying),this.store.dispatch(new et(!1))}},{key:"handleDragEnd",value:function(){this.store.dispatch(new et(this.playing))}},{key:"handleTrackClick",value:function(e){if(this.showHandle){var t=e.offsetX/this.track.nativeElement.getBoundingClientRect().width*100;this.playing=this.store.selectSnapshot(Wr.getAnimationPlaying),this.scrubToPercent(t),this.setScrubberBar(t),this.setScrubberHandle(t),this.store.dispatch(new et(this.playing))}}},{key:"tick",value:function(e){if(this.timerange){var t=this.calcScrubbedPercent(e);this.setScrubberBar(t),this.setScrubberHandle(t)}}},{key:"calculateHandlePercent",value:function(){var e=this.scrubber.nativeElement.getBoundingClientRect(),t=e.left,n=e.right-t-this.handle.nativeElement.offsetWidth,i=this.handle.nativeElement.getBoundingClientRect().left;return Math.min(Math.max((i-t)/n*100,0),100)}},{key:"scrubToPercent",value:function(e){var t=e/100*this.timerange.lastTime,n=0===e?"second":"first",i=this.store.selectSnapshot(Lr.getSelectedChapterId),o=this.animationService.mapLocalTimeToGlobal(i,t);this.animationService.scrub({time:o,which:n})}},{key:"handlePlayClick",value:function(){this.viewService.toggleAnimation()}},{key:"setScrubberBar",value:function(e){this.renderer.setStyle(this.bar.nativeElement,"width",e+"%")}},{key:"setScrubberHandle",value:function(e){0===this.trackWidth&&(this.trackWidth=this.track.nativeElement.offsetWidth),this.showHandle&&(this.dragPosition=Object.assign(Object.assign({},this.dragPosition),{x:16+this.trackWidth*(e/100)}),this.changeDetectorRef.markForCheck())}},{key:"calcScrubbedPercent",value:function(e){var t=this.timerange,n=t.firstTime,i=t.lastTime,o=this.animationService.mapGlobalTimeToLocal(e).time,r=Math.max(n,Math.min(o,i));return Math.round(r/i*100)}}]),e}()).\u0275fac=function(e){return new(e||bx)(P.Pb(Nt),P.Pb(kr),P.Pb(P.H),P.Pb(td),P.Pb(P.i),P.Pb(E.g))},bx.\u0275cmp=P.Jb({type:bx,selectors:[["app-view-scrubber"]],viewQuery:function(e,t){var n;1&e&&(P.Gc(kx,!0),P.Gc(wx,!0),P.Gc(Ox,!0),P.Gc(Cx,!0),P.Rc(Mr.a,!0)),2&e&&(P.uc(n=P.dc())&&(t.scrubber=n.first),P.uc(n=P.dc())&&(t.track=n.first),P.uc(n=P.dc())&&(t.bar=n.first),P.uc(n=P.dc())&&(t.handle=n.first),P.uc(n=P.dc())&&(t.dragInstance=n.first))},inputs:{showHandle:"showHandle"},decls:9,vars:10,consts:[["gaCategory","View Media Bar",1,"view-scrubber",3,"ngClass"],["scrubber",""],[1,"view-scrubber__track",3,"click"],["track",""],[1,"view-scrubber__bar"],["bar",""],["gaEvent","","gaAction","Clicked Scrubber","cdkDrag","","cdkDragLockAxis","x","cdkDragBoundary",".view-scrubber",1,"view-scrubber__handle",3,"cdkDragFreeDragPosition","ngClass","cdkDragStarted","cdkDragEnded"],["handle",""]],template:function(e,t){1&e&&(P.Vb(0,"div",0,1),P.Vb(2,"div",2,3),P.cc("click",(function(e){return t.handleTrackClick(e)})),P.Qb(4,"div",4,5),P.Ub(),P.Vb(6,"div",6,7),P.cc("cdkDragStarted",(function(){return t.handleDragStart()}))("cdkDragEnded",(function(){return t.handleDragEnd()})),P.hc(8,"async"),P.Ub(),P.Ub()),2&e&&(P.lc("ngClass",P.oc(5,Sx,t.showHandle)),P.Db(6),P.lc("cdkDragFreeDragPosition",t.dragPosition)("ngClass",P.pc(7,_x,!t.showHandle,P.ic(8,3,t.canTouch$))))},directives:[Ce.a,ra.i,Ce.b,Mr.a],pipes:[ra.b],styles:['.view-scrubber{position:relative;display:flex;justify-content:center;align-items:center;height:40px;width:100%}.view-scrubber:hover .view-scrubber__handle:after{opacity:1}.view-scrubber--draggable .view-scrubber__track{left:16px;right:16px}.view-scrubber__track{background:rgba(150,168,192,.6);background:var(--scrubber-track-bg);z-index:1;right:0}.view-scrubber__bar,.view-scrubber__track{border-radius:2px;position:absolute;height:4px;left:0}.view-scrubber__bar{background:#374a68;background:var(--scrubber-track-color);z-index:2;width:0}.view-scrubber__handle{width:40px;height:40px;margin-left:-16px;left:0;display:flex;align-items:center;justify-content:center;position:absolute;z-index:2}.view-scrubber__handle--hide{display:none}.view-scrubber__handle:after{opacity:1;transition:opacity .25s;content:"";width:8px;height:8px;border-radius:4px;background:var(--scrubber-handle-color);box-shadow:var(--scrubber-handle-shadow)}.view-scrubber__handle:hover:after{background:var(--scrubber-handle-color--hover)}.view-scrubber__handle:hover{cursor:pointer}.view-scrubber__handle-touch:after{opacity:1}'],encapsulation:2,changeDetection:0}),yx([Object(E.d)(Wr.getAnimationPlaying),xx("design:type",be.a)],bx.prototype,"animationPlaying$",void 0),yx([Object(E.d)(Lr.getSelectedChapterId),xx("design:type",be.a)],bx.prototype,"selectedChapterId$",void 0),yx([Object(E.d)(ku.getCanTouch),xx("design:type",be.a)],bx.prototype,"canTouch$",void 0),bx),Px=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},Mx=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Ix(e,t){if(1&e){var n=P.Wb();P.Vb(0,"button",10),P.cc("click",(function(){return P.zc(n),P.gc(2).handlePlayClick()})),P.hc(1,"async"),P.hc(2,"async"),P.hc(3,"async"),P.Ub()}if(2&e){var i=P.gc(2);P.lc("gaLabel",P.ic(1,3,i.animationPlaying$)?"Pause":"Play")("matTooltip",P.ic(2,5,i.animationPlaying$)?"Pause":"Play")("icon",P.ic(3,7,i.animationPlaying$)?"pause":"play")}}function zx(e,t){if(1&e){var n=P.Wb();P.Vb(0,"button",11),P.cc("click",(function(){return P.zc(n),P.gc(2).handlePlayChapterFromStartClick()})),P.Ub()}}function Tx(e,t){1&e&&P.Qb(0,"app-view-scrubber",12)}function Ux(e,t){if(1&e){var n=P.Wb();P.Vb(0,"button",13),P.cc("click",(function(){return P.zc(n),P.gc(2).handleAudioClick()})),P.hc(1,"async"),P.hc(2,"async"),P.hc(3,"async"),P.Ub()}if(2&e){var i=P.gc(2);P.lc("gaLabel",P.ic(1,3,i.playAudio$)?"Mute":"Play")("icon",P.ic(2,5,i.playAudio$)?"volume":"volume-slash")("matTooltip",P.ic(3,7,i.playAudio$)?"Mute Audio":"Play Audio")}}function Lx(e,t){if(1&e&&(P.Vb(0,"div",3),P.Kc(1,Ix,4,9,"button",4),P.Kc(2,zx,1,0,"button",5),P.Kc(3,Tx,1,0,"app-view-scrubber",6),P.Vb(4,"button",7),P.Vb(5,"span",8),P.Mc(6),P.hc(7,"async"),P.Ub(),P.Ub(),P.Kc(8,Ux,4,9,"button",9),P.Ub()),2&e){var n=P.gc(),i=P.vc(2);P.Db(1),P.lc("ngIf",n.showPlayPause),P.Db(1),P.lc("ngIf",n.showPlayPause),P.Db(1),P.lc("ngIf",n.showScrubber),P.Db(1),P.lc("matMenuTriggerFor",i),P.Db(2),P.Oc("",P.ic(7,6,n.playbackSpeed$),"x"),P.Db(2),P.lc("ngIf",n.audioVisible)}}var Dx,Ex,Fx=((Dx=function(){function e(t,n,i,o,r){m(this,e),this.animationService=t,this.viewService=n,this.layoutService=i,this.store=o,this.changeDetectorRef=r,this.viewLayout=$u,this.size="small",this.showPlayPause=!0,this.showScrubber=!0,this.showBar=!0,this.audioVisible=!1,this.ngUnsubscribe=new fe.a}return v(e,[{key:"template",get:function(){return this._template},set:function(e){this._template=e,this.updateLayoutProperties(this.template)}},{key:"ngOnInit",value:function(){this.initChapterListener(),this.initLayoutListener()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initChapterListener",value:function(){var e=this;this.selectedChapterId$.pipe(Object(me.a)((function(e){return null!=e})),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){e.timerange=e.animationService.getChapterLocalTimerange(t)}))}},{key:"initLayoutListener",value:function(){var e=this;this.store.select(ku.getUI).pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(){e.audioVisible=e.layoutService.isVisible($u.Audio),e.changeDetectorRef.markForCheck()}))}},{key:"updateLayoutProperties",value:function(e){this.showBar=e!==cc.None,this.showScrubber=e===cc.Full,this.showPlayPause=e!==cc.None}},{key:"handlePlayClick",value:function(){this.viewService.toggleAnimation()}},{key:"handleAudioClick",value:function(){this.viewService.toggleAudio()}},{key:"handlePlayChapterFromStartClick",value:function(){this.viewService.playChapterFromStart()}},{key:"setPlaybackSpeed",value:function(e){this.store.dispatch(new nt(e))}}]),e}()).\u0275fac=function(e){return new(e||Dx)(P.Pb(kr),P.Pb(td),P.Pb(Yu),P.Pb(E.g),P.Pb(P.i))},Dx.\u0275cmp=P.Jb({type:Dx,selectors:[["app-view-media-bar"]],inputs:{template:"template",size:"size"},decls:11,vars:1,consts:[["gaCategory","View Media Bar","class","view-media-bar",4,"ngIf"],["playbackMenu","matMenu"],["mat-menu-item","",3,"click"],["gaCategory","View Media Bar",1,"view-media-bar"],["gaEvent","","gaAction","Clicked Toggle Animation","app-pin-button","","buttonType","ghost","data-test","Play/Pause__small","matTooltipPosition","above",3,"gaLabel","matTooltip","icon","click",4,"ngIf"],["gaEvent","","gaAction","Clicked Play Chapter From Start","app-pin-button","","buttonType","ghost","matTooltipPosition","above","matTooltip","Play Chapter from Start","icon","step-backward",3,"click",4,"ngIf"],["class","view-media-bar__scrubber","data-test","Scrub__small",4,"ngIf"],["app-pin-button","","buttonType","ghost","matTooltipPosition","above","matTooltip","Playback Speed",3,"matMenuTriggerFor"],[1,"text-semibold"],["gaEvent","","gaAction","Clicked Toggle Audio","app-pin-button","","buttonType","ghost","class","view-tools__item",3,"gaLabel","icon","matTooltip","click",4,"ngIf"],["gaEvent","","gaAction","Clicked Toggle Animation","app-pin-button","","buttonType","ghost","data-test","Play/Pause__small","matTooltipPosition","above",3,"gaLabel","matTooltip","icon","click"],["gaEvent","","gaAction","Clicked Play Chapter From Start","app-pin-button","","buttonType","ghost","matTooltipPosition","above","matTooltip","Play Chapter from Start","icon","step-backward",3,"click"],["data-test","Scrub__small",1,"view-media-bar__scrubber"],["gaEvent","","gaAction","Clicked Toggle Audio","app-pin-button","","buttonType","ghost",1,"view-tools__item",3,"gaLabel","icon","matTooltip","click"]],template:function(e,t){1&e&&(P.Kc(0,Lx,9,8,"div",0),P.Vb(1,"mat-menu",null,1),P.Vb(3,"button",2),P.cc("click",(function(){return t.setPlaybackSpeed(1)})),P.Mc(4,"Normal"),P.Ub(),P.Vb(5,"button",2),P.cc("click",(function(){return t.setPlaybackSpeed(.5)})),P.Mc(6,"0.5"),P.Ub(),P.Vb(7,"button",2),P.cc("click",(function(){return t.setPlaybackSpeed(.25)})),P.Mc(8,"0.25"),P.Ub(),P.Vb(9,"button",2),P.cc("click",(function(){return t.setPlaybackSpeed(.1)})),P.Mc(10,"0.1"),P.Ub(),P.Ub()),2&e&&P.lc("ngIf",t.showBar)},directives:[ra.l,hl.a,hl.b,Ce.a,vg,mg.c,hl.d,Ce.b,jx],pipes:[ra.b],styles:[".view-media-bar{display:flex}.view-media-bar__scrubber{width:120px;display:flex;justify-content:center;align-items:center}"],encapsulation:2,changeDetection:0}),Px([Object(E.d)(Wr.getAnimationPlaying),Mx("design:type",be.a)],Dx.prototype,"animationPlaying$",void 0),Px([Object(E.d)(Lr.getSelectedChapterId),Mx("design:type",be.a)],Dx.prototype,"selectedChapterId$",void 0),Px([Object(E.d)(Wr.getPlayAudio),Mx("design:type",be.a)],Dx.prototype,"playAudio$",void 0),Px([Object(E.d)(Wr.getPlaybackSpeed),Mx("design:type",be.a)],Dx.prototype,"playbackSpeed$",void 0),Dx),Ax=function(){return window.navigator.userAgent.includes("Trident")},Rx=((Ex=function(){function e(t,n){m(this,e),this.el=t,this.renderer=n}return v(e,[{key:"ngOnInit",value:function(){Ax()&&this.renderer.setStyle(this.el.nativeElement,"display","none")}}]),e}()).\u0275fac=function(e){return new(e||Ex)(P.Pb(P.m),P.Pb(P.H))},Ex.\u0275dir=P.Kb({type:Ex,selectors:[["","appHideIE11",""]]}),Ex),Vx=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},Nx=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Bx=["chapterCount"],Hx=["mediaToggle"];function Qx(e,t){if(1&e){var n=P.Wb();P.Vb(0,"div",5),P.Vb(1,"button",6),P.cc("click",(function(){return P.zc(n),P.gc(2).handlePreviousClick()})),P.hc(2,"async"),P.hc(3,"async"),P.hc(4,"async"),P.hc(5,"async"),P.Ub(),P.Vb(6,"button",7),P.cc("click",(function(){return P.zc(n),P.gc(2).handleNextClick()})),P.hc(7,"async"),P.hc(8,"async"),P.hc(9,"async"),P.hc(10,"async"),P.hc(11,"async"),P.hc(12,"async"),P.Ub(),P.Ub()}if(2&e){var i=P.gc(2),o=null,r=null;P.Db(1),P.lc("disabled",0===P.ic(2,6,i.chapterIndex$))("matTooltip",P.ic(4,10,i.previousChapter$)?"Previous: "+(null==(o=P.ic(5,12,i.previousChapter$))?null:o.info.displayName):""),P.Eb("aria-disabled",0===P.ic(3,8,i.chapterIndex$)),P.Db(5),P.lc("disabled",P.ic(9,18,i.chapterIndex$)===P.ic(10,20,i.chapterCount$)-1)("matTooltip",P.ic(11,22,i.nextChapter$)?"Next: "+(null==(r=P.ic(12,24,i.nextChapter$))?null:r.info.displayName):""),P.Eb("aria-disabled",P.ic(7,14,i.chapterIndex$)===P.ic(8,16,i.chapterCount$)-1)}}function qx(e,t){if(1&e){var n=P.Wb();P.Vb(0,"div",5),P.Vb(1,"div",8,9),P.Vb(3,"button",10),P.cc("click",(function(){return P.zc(n),P.gc(2).handleChapterCountClick()})),P.Vb(4,"div",11),P.Mc(5),P.hc(6,"async"),P.hc(7,"async"),P.Qb(8,"app-icon",12),P.Ub(),P.Vb(9,"span",13),P.Mc(10),P.hc(11,"async"),P.hc(12,"async"),P.Ub(),P.Ub(),P.Ub(),P.Ub()}if(2&e){var i=P.gc(2);P.Db(3),P.lc("matTooltip",i.chaptersPopup?"Close Chapter List":"Open Chapter List"),P.Eb("visible",i.breakpoint!==i.breakpointEnum.Small),P.Db(2),P.Pc(" ",P.ic(6,6,i.chapterIndex$)+1," of ",P.ic(7,8,i.chapterCount$)," "),P.Db(5),P.Pc(" Toggle Chapter List, Chapter ",P.ic(11,10,i.chapterIndex$)+1," of ",P.ic(12,12,i.chapterCount$)," ")}}function Wx(e,t){if(1&e){var n=P.Wb();P.Vb(0,"button",17),P.cc("click",(function(){return P.zc(n),P.gc(3).toggleToolbar("media")})),P.Qb(1,"app-view-scrubber",18),P.Ub()}2&e&&(P.Db(1),P.lc("showHandle",!1))}function $x(e,t){if(1&e){var n=P.Wb();P.Vb(0,"button",19),P.cc("click",(function(){return P.zc(n),P.gc(3).handleAudioClick()})),P.hc(1,"async"),P.hc(2,"async"),P.hc(3,"async"),P.Ub()}if(2&e){var i=P.gc(3);P.lc("gaLabel",P.ic(1,3,i.playAudio$)?"Mute":"Unmute")("icon",P.ic(2,5,i.playAudio$)?"volume":"volume-slash")("matTooltip",P.ic(3,7,i.playAudio$)?"Mute Audio":"Play Audio")}}function Kx(e,t){if(1&e){var n=P.Wb();P.Vb(0,"div",5),P.Vb(1,"button",14),P.cc("click",(function(){return P.zc(n),P.gc(2).handlePlayClick()})),P.hc(2,"async"),P.hc(3,"async"),P.hc(4,"async"),P.hc(5,"async"),P.Ub(),P.Kc(6,Wx,2,1,"button",15),P.Kc(7,$x,4,9,"button",16),P.Ub()}if(2&e){var i=P.gc(2);P.Db(1),P.lc("gaLabel",P.ic(2,6,i.animationPlaying$)?"Pause":"Play")("icon",P.ic(3,8,i.animationPlaying$)?"pause":"play")("matTooltip",P.ic(5,12,i.animationPlaying$)?"Pause Animation":"Play Animation"),P.Eb("aria-label",P.ic(4,10,i.animationPlaying$)?"Pause Animation":"Play Animation"),P.Db(5),P.lc("ngIf",i.isVisible(i.viewUI.ScrubberButton)),P.Db(1),P.lc("ngIf",i.audioVisible)}}function Gx(e,t){if(1&e&&(P.Tb(0,3),P.Kc(1,Qx,13,26,"div",4),P.Kc(2,qx,13,14,"div",4),P.Kc(3,Kx,8,14,"div",4),P.Sb()),2&e){var n=P.gc();P.Db(1),P.lc("ngIf",n.paginationVisible),P.Db(1),P.lc("ngIf",n.paginationVisible&&!n.collapsePagination),P.Db(1),P.lc("ngIf",n.mediabarVisible)}}function Zx(e,t){if(1&e){var n=P.Wb();P.Tb(0,20),P.Vb(1,"div",5),P.Vb(2,"div",21),P.Vb(3,"button",22),P.cc("click",(function(){P.zc(n);var e=P.gc();return e.handleSelectTool(e.toolEnum.Select)})),P.hc(4,"async"),P.Ub(),P.Vb(5,"button",23),P.cc("click",(function(){P.zc(n);var e=P.gc();return e.handleSelectTool(e.toolEnum.Hide)})),P.hc(6,"async"),P.Ub(),P.Vb(7,"button",24),P.cc("click",(function(){P.zc(n);var e=P.gc();return e.handleSelectTool(e.toolEnum.Fade)})),P.hc(8,"async"),P.Ub(),P.Ub(),P.Ub(),P.Sb()}if(2&e){var i=P.gc();P.Db(3),P.lc("selected",P.ic(4,3,i.activeTool$)===i.toolEnum.Select),P.Db(2),P.lc("selected",P.ic(6,5,i.activeTool$)===i.toolEnum.Hide),P.Db(2),P.lc("selected",P.ic(8,7,i.activeTool$)===i.toolEnum.Fade)}}var Jx,Xx,Yx,ek=((Jx=function(){function e(t,n,i,o,r,a){m(this,e),this.viewService=t,this.viewUIService=n,this.store=i,this.changeDetectorRef=o,this.popupService=r,this.ga=a,this.viewToolsMode=ff,this.viewUI=$u,this.breakpointEnum=Nu,this.canFullscreen=!0,this.isFullscreen=!1,this.toolEnum=Rr,this.mediaControlsEnum=cc,this.paginationVisible=!1,this.mediabarVisible=!1,this.audioVisible=!1,this.ngUnsubscribe=new fe.a,this.animate=!0,this._mode=ff.Main,this.collapsePagination=!1,this.collapseScrubber=!1,this.modeChange=new P.p}return v(e,[{key:"mode",get:function(){return this._mode},set:function(e){this._mode=e}},{key:"ngOnInit",value:function(){this.canFullscreen=Ys.canFullscreen(),this.initLayoutListener(),this.initBreakpointListener(),this.initChapterListener(),this.initFullscreenListener()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initLayoutListener",value:function(){var e=this;this.store.select(ku.getUI).pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){e.mediaTemplate=t.media.template,e.paginationVisible=e.viewUIService.isVisible($u.Pagination),e.mediabarVisible=e.viewUIService.isVisible($u.Mediabar),e.audioVisible=e.viewUIService.isVisible($u.Audio),e.changeDetectorRef.markForCheck()}))}},{key:"initBreakpointListener",value:function(){var e=this;this.store.select(Wu.getBreakpoint).pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){e.breakpoint=t,e.changeDetectorRef.markForCheck()}))}},{key:"initChapterListener",value:function(){var e=this;this.store.select(Lr.getSelectedChapterIndex).pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(){e.chaptersPopup&&e.chaptersPopup.close()}))}},{key:"initFullscreenListener",value:function(){var e=this;this.fullscreen$=Ys.onFullscreenChange(),this.fullscreen$.pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){e.isFullscreen=Ys.isFullscreen(),e.changeDetectorRef.markForCheck()}))}},{key:"handleSelectTool",value:function(e){var t=this.store.selectSnapshot(Wr.getActiveTool);this.viewService.selectTool(e===t?Rr.Select:e)}},{key:"handlePlayClick",value:function(){this.viewService.toggleAnimation()}},{key:"handleAudioClick",value:function(){this.viewService.toggleAudio()}},{key:"handleMenuClick",value:function(){this.store.dispatch(new j.ToggleMenu(!0))}},{key:"handlePreviousClick",value:function(){this.viewService.previousChapter("Toolbar")}},{key:"handleNextClick",value:function(){this.viewService.nextChapter("Toolbar")}},{key:"handleChapterCountClick",value:function(){this.toggleChaptersPopup()}},{key:"handleMediaClick",value:function(){this.toggleMediaPopup()}},{key:"toggleChaptersPopup",value:function(){var e=this;this.chaptersPopup?this.chaptersPopup.close():(this.chaptersPopup=this.popupService.open({origin:this.chapterCount.nativeElement,content:jf,width:"300px"}),this.chaptersPopup.afterClosed$.pipe(Object(ve.a)(this.ngUnsubscribe),Object(Ou.a)(1)).subscribe((function(t){e.chaptersPopup=null})))}},{key:"toggleMediaPopup",value:function(){var e=this;this.mediaPopup?this.mediaPopup.close():(this.mediaPopup=this.popupService.open({origin:this.mediaToggle.nativeElement,content:Fx,width:"300px"}),this.mediaPopup.afterClosed$.pipe(Object(ve.a)(this.ngUnsubscribe),Object(Ou.a)(1)).subscribe((function(t){e.mediaPopup=null})))}},{key:"toggleToolbar",value:function(e){this.viewService.toggleToolbar(e)}},{key:"isEnabled",value:function(e){return this.viewUIService.isUIEnabled(e)}},{key:"isVisible",value:function(e){return this.viewUIService.isVisible(e)}}]),e}()).\u0275fac=function(e){return new(e||Jx)(P.Pb(td),P.Pb(Yu),P.Pb(E.g),P.Pb(P.i),P.Pb(Bf),P.Pb(Ce.c))},Jx.\u0275cmp=P.Jb({type:Jx,selectors:[["app-view-tools"]],viewQuery:function(e,t){var n;1&e&&(P.Rc(Bx,!0),P.Rc(Hx,!0)),2&e&&(P.uc(n=P.dc())&&(t.chapterCount=n.first),P.uc(n=P.dc())&&(t.mediaToggle=n.first))},inputs:{animate:"animate",mode:"mode",collapsePagination:"collapsePagination",collapseScrubber:"collapseScrubber"},outputs:{modeChange:"modeChange"},features:[P.Cb([Bf])],decls:3,vars:2,consts:[["role","toolbar","aria-label","Tools","data-test","viewTools",1,"view-tools"],["gaCategory","View Toolbar",4,"ngIf"],["gaCategory","View Explore Tools",4,"ngIf"],["gaCategory","View Toolbar"],["class","view-tools__group",4,"ngIf"],[1,"view-tools__group"],["gaEvent","","gaAction","Clicked Previous Chapter","data-test","viewToolsPreviousChapter","aria-label","Previous Chapter","app-pin-button","","buttonType","ghost","icon","chevron-left",1,"view-tools__item",3,"disabled","matTooltip","click"],["gaEvent","","gaAction","Clicked Next Chapter","data-test","viewToolsNextChapter","aria-label","Next Chapter","app-pin-button","","buttonType","ghost","icon","chevron-right",1,"view-tools__item",3,"disabled","matTooltip","click"],["gaEvent","","gaAction","Clicked Open Chapter List",1,"view-tools__item"],["chapterCount",""],["data-test","viewToolsChapterCount","app-pin-button","","buttonType","ghost","aria-label","Toggle Chapter List",3,"matTooltip","click"],["aria-hidden","true",1,"ph-2","text-13","text-semibold",2,"white-space","nowrap"],["icon","caret-up",1,"ml-2"],[1,"visually-hidden"],["gaEvent","","gaAction","Clicked Toggle Animation","data-test","viewToolsPlay","app-pin-button","","buttonType","ghost",1,"view-tools__item",3,"gaLabel","icon","matTooltip","click"],["gaEvent","","gaAction","Clicked Open Media Bar","data-test","viewToolsMedia","app-pin-button","","buttonType","ghost","class","view-tools__item","aria-label","Open Media Bar","matTooltip","Open Media Bar",3,"click",4,"ngIf"],["gaEvent","","gaAction","Clicked Toggle Audio","data-test","viewToolsAudio","app-pin-button","","buttonType","ghost","class","view-tools__item",3,"gaLabel","icon","matTooltip","click",4,"ngIf"],["gaEvent","","gaAction","Clicked Open Media Bar","data-test","viewToolsMedia","app-pin-button","","buttonType","ghost","aria-label","Open Media Bar","matTooltip","Open Media Bar",1,"view-tools__item",3,"click"],[2,"width","32px","margin","0 8px",3,"showHandle"],["gaEvent","","gaAction","Clicked Toggle Audio","data-test","viewToolsAudio","app-pin-button","","buttonType","ghost",1,"view-tools__item",3,"gaLabel","icon","matTooltip","click"],["gaCategory","View Explore Tools"],["role","radiogroup",1,"flex"],["gaEvent","","gaAction","Clicked Select","app-pin-button","","buttonType","ghost","icon","mouse-pointer","aria-label","Select","matTooltip","Select","data-test","viewToolsSelect",1,"view-tools__item",3,"selected","click"],["gaEvent","","gaAction","Clicked Hide","app-pin-button","","buttonType","ghost","icon","eye-slash","aria-label","Hide","matTooltip","Hide","data-test","viewToolsHide",1,"view-tools__item",3,"selected","click"],["gaEvent","","gaAction","Clicked Fade","app-pin-button","","appHideIE11","","buttonType","ghost","aria-label","Fade","matTooltip","Fade","icon","adjust","data-test","viewToolsFade",1,"view-tools__item",3,"selected","click"]],template:function(e,t){1&e&&(P.Vb(0,"div",0),P.Kc(1,Gx,4,3,"ng-container",1),P.Kc(2,Zx,9,9,"ng-container",2),P.Ub()),2&e&&(P.Db(1),P.lc("ngIf",t.mode===t.viewToolsMode.Main),P.Db(1),P.lc("ngIf",t.mode===t.viewToolsMode.Tools))},directives:[ra.l,Ce.a,vg,Ce.b,mg.c,nl,jx,Rx],pipes:[ra.b],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3838}.text-info{color:#0060c4}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.view-tools{display:flex;justify-content:center;overflow:hidden}@-webkit-keyframes viewToolsToggle{0%{opacity:1}50%{opacity:0}to{opacity:1}}@keyframes viewToolsToggle{0%{opacity:1}50%{opacity:0}to{opacity:1}}.view-tools--swap{-webkit-animation:viewToolsToggle .3s ease-in-out;animation:viewToolsToggle .3s ease-in-out}.view-tools--dense .view-tools__divider{margin:4px}.view-tools__inner{display:flex;justify-content:center}.view-tools__group{border-right:var(--view-tools-border);padding:0 8px;display:flex}.view-tools__group:empty{display:none}.view-tools__group:empty:first-of-type+.view-tools__group:not(:empty),.view-tools__group:first-of-type{padding-left:0}.view-tools__group:last-of-type{border-right:none;padding-right:0}.view-tools__item{display:flex;align-items:center}.view-tools__item:not(:last-child){margin-right:4px}.view-tools__divider{border-right:var(--view-tools-border);margin:4px 8px}.view-tools__count{font-size:12px;letter-spacing:.3px;line-height:1.4em;white-space:nowrap}"],encapsulation:2,changeDetection:0}),Vx([Object(E.d)(Lr.getSelectedChapterReadyState),Nx("design:type",be.a)],Jx.prototype,"selectedChapterReady$",void 0),Vx([Object(E.d)(Wr.getActiveTool),Nx("design:type",be.a)],Jx.prototype,"activeTool$",void 0),Vx([Object(E.d)(ku.getPresentationActive),Nx("design:type",be.a)],Jx.prototype,"presentationActive$",void 0),Vx([Object(E.d)(Lr.getIsChapterAnimated),Nx("design:type",be.a)],Jx.prototype,"isChapterAnimated$",void 0),Vx([Object(E.d)(Wr.getShowLabels),Nx("design:type",be.a)],Jx.prototype,"showLabels$",void 0),Vx([Object(E.d)(Wr.getAnimationPlaying),Nx("design:type",be.a)],Jx.prototype,"animationPlaying$",void 0),Vx([Object(E.d)(Wr.getPlayAudio),Nx("design:type",be.a)],Jx.prototype,"playAudio$",void 0),Vx([Object(E.d)(Is.getChapterLabels),Nx("design:type",be.a)],Jx.prototype,"labels$",void 0),Vx([Object(E.d)(Lr.getSelectedChapterTitle),Nx("design:type",be.a)],Jx.prototype,"chapterTitle$",void 0),Vx([Object(E.d)(Lr.getSelectedChapterIndex),Nx("design:type",be.a)],Jx.prototype,"chapterIndex$",void 0),Vx([Object(E.d)(Lr.getNextChapter),Nx("design:type",be.a)],Jx.prototype,"nextChapter$",void 0),Vx([Object(E.d)(Lr.getPreviousChapter),Nx("design:type",be.a)],Jx.prototype,"previousChapter$",void 0),Vx([Object(E.d)(Lr.getChapterCount),Nx("design:type",be.a)],Jx.prototype,"chapterCount$",void 0),Vx([Object(E.d)(Lr.getSelectedChapterAudio),Nx("design:type",be.a)],Jx.prototype,"selectedChapterAudio$",void 0),Vx([Object(E.d)(ku.getCanTouch),Nx("design:type",be.a)],Jx.prototype,"canTouch$",void 0),Jx),tk=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},nk=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},ik=["slider"],ok=["track"],rk=["bar"],ak=["handle"],sk=function(e){return{"view-layers-slider__handle-touch":e}},ck=((Xx=function(){function e(t,n,i){m(this,e),this.renderer=t,this.visibilityLayersService=n,this.changeDetectorRef=i,this.ngUnsubscribe=new fe.a,this.currentLayers=[],this.fullOffset=0,this.dragMove=new fe.a,this.dragPosition={x:0,y:0},this.currentLayerName=""}return v(e,[{key:"ngOnInit",value:function(){this.initLayersObserver(),this.initIndexPositionObserver(),this.initDragMoveObserver()}},{key:"ngAfterViewInit",value:function(){this.fullOffset=this.track.nativeElement.offsetWidth}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initLayersObserver",value:function(){var e=this;this.selectedChapterCurrentLayers$.pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){e.currentLayers=t}))}},{key:"initIndexPositionObserver",value:function(){var e=this;Object(Gr.b)(this.selectedChapterCurrentLayersIndex$,this.selectedChapterCurrentLayersPosition$).pipe(Object(me.a)((function(e){var t=p(e,2),n=t[0],i=t[1];return!Object(Se.isNil)(n)&&!Object(Se.isNil)(i)})),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){var n=p(t,2),i=n[0],o=n[1];e.currentLayerName=e.currentLayers[i].name;var r=e.visibilityLayersService.indexPositionToFraction(i,o);e.setSliderBar(r),e.setSliderHandle(r)}))}},{key:"initDragMoveObserver",value:function(){var e=this;this.dragMove.pipe(Object(ea.a)(20),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(){return e.handleAuditedDrag()}))}},{key:"handleDragEnded",value:function(){var e=this.calculateHandleFraction(),t=this.visibilityLayersService.fractionToIndex(e),n=this.visibilityLayersService.fractionToPosition(e,t);this.visibilityLayersService.recordLayerIndexPosition(t,n)}},{key:"handleDragMoved",value:function(e){this.dragMove.next(e)}},{key:"handleAuditedDrag",value:function(){var e=this.calculateHandleFraction(),t=this.visibilityLayersService.fractionToIndex(e),n=this.visibilityLayersService.fractionToPosition(e,t);this.currentLayerName=this.currentLayers[t].name,this.visibilityLayersService.synchronizeScene(t,n,!1),this.setSliderBar(e)}},{key:"handleTrackClick",value:function(e){var t=e.offsetX/this.fullOffset,n=this.visibilityLayersService.fractionToIndex(t),i=this.visibilityLayersService.fractionToPosition(t,n);this.visibilityLayersService.recordLayerIndexPosition(n,i)}},{key:"calculateHandleFraction",value:function(){var e=this.slider.nativeElement.getBoundingClientRect();return(this.handle.nativeElement.getBoundingClientRect().left-e.left)/this.fullOffset}},{key:"setSliderBar",value:function(e){this.renderer.setStyle(this.bar.nativeElement,"width",100*e+"%")}},{key:"setSliderHandle",value:function(e){this.dragPosition={x:e*this.fullOffset,y:this.dragPosition.y},this.changeDetectorRef.markForCheck()}}]),e}()).\u0275fac=function(e){return new(e||Xx)(P.Pb(P.H),P.Pb(ic),P.Pb(P.i))},Xx.\u0275cmp=P.Jb({type:Xx,selectors:[["app-view-layers-slider"]],viewQuery:function(e,t){var n;1&e&&(P.Gc(ik,!0),P.Gc(ok,!0),P.Gc(rk,!0),P.Gc(ak,!0)),2&e&&(P.uc(n=P.dc())&&(t.slider=n.first),P.uc(n=P.dc())&&(t.track=n.first),P.uc(n=P.dc())&&(t.bar=n.first),P.uc(n=P.dc())&&(t.handle=n.first))},decls:9,vars:7,consts:[[1,"view-layers-slider"],["slider",""],[1,"view-layers-slider__track",3,"click"],["track",""],[1,"view-layers-slider__bar"],["bar",""],["cdkDrag","","cdkDragLockAxis","x","cdkDragBoundary",".view-layers-slider",1,"view-layers-slider__handle",3,"cdkDragFreeDragPosition","ngClass","matTooltip","cdkDragEnded","cdkDragMoved"],["handle",""]],template:function(e,t){1&e&&(P.Vb(0,"div",0,1),P.Vb(2,"div",2,3),P.cc("click",(function(e){return t.handleTrackClick(e)})),P.Qb(4,"div",4,5),P.Ub(),P.Vb(6,"div",6,7),P.cc("cdkDragEnded",(function(){return t.handleDragEnded()}))("cdkDragMoved",(function(e){return t.handleDragMoved(e)})),P.hc(8,"async"),P.Ub(),P.Ub()),2&e&&(P.Db(6),P.mc("matTooltip",t.currentLayerName),P.lc("cdkDragFreeDragPosition",t.dragPosition)("ngClass",P.oc(5,sk,P.ic(8,3,t.canTouch$))))},directives:[Mr.a,ra.i,mg.c],pipes:[ra.b],styles:['.view-layers-slider[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;height:28px;width:100%}.view-layers-slider__track[_ngcontent-%COMP%]{position:absolute;background:rgba(28,42,63,.5);background:var(--scrubber-track-bg);z-index:1;height:5px;border-radius:5px;left:14px;right:14px}.view-layers-slider__bar[_ngcontent-%COMP%]{position:absolute;background:var(--scrubber-track-color);height:5px;border-radius:5px;z-index:2;width:0;left:0;pointer-events:none}.view-layers-slider__handle[_ngcontent-%COMP%]{width:28px;height:28px;margin-left:-14px;left:14px;display:flex;align-items:center;justify-content:center;position:absolute;z-index:2}.view-layers-slider__handle--hide[_ngcontent-%COMP%]{display:none}.view-layers-slider__handle[_ngcontent-%COMP%]:after{content:"";width:12px;height:12px;border-radius:6px;background:var(--scrubber-handle-color);box-shadow:var(--scrubber-handle-shadow)}.view-layers-slider__handle[_ngcontent-%COMP%]:hover:after{background:var(--scrubber-handle-color--hover)}'],changeDetection:0}),tk([Object(E.d)(Lr.getSelectedChapterCurrentLayers),nk("design:type",be.a)],Xx.prototype,"selectedChapterCurrentLayers$",void 0),tk([Object(E.d)(Lr.getSelectedChapterCurrentLayersIndex),nk("design:type",be.a)],Xx.prototype,"selectedChapterCurrentLayersIndex$",void 0),tk([Object(E.d)(Lr.getSelectedChapterCurrentLayersPosition),nk("design:type",be.a)],Xx.prototype,"selectedChapterCurrentLayersPosition$",void 0),tk([Object(E.d)(ku.getCanTouch),nk("design:type",be.a)],Xx.prototype,"canTouch$",void 0),Xx),lk=function(e,t,n){return{"view-layers-bar__slider--large":e,"view-layers-bar__slider--small":t,"view-layers-bar__slider--disabled":n}},uk=((Yx=function(){function e(t,n,i){m(this,e),this.store=t,this.engineService=n,this.changeDetectorRef=i,this.ngUnsubscribe=new fe.a,this.assetsLoading=!1}return v(e,[{key:"ngOnInit",value:function(){var e=this;this.engineService.getEvent(Dt.AssetsLoadProgress).pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){e.assetsLoading=t.requestedAssets!==t.receivedAssets,e.changeDetectorRef.markForCheck()}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"isLarge",value:function(){return this.store.selectSnapshot(Wu.getBreakpoint)>=Nu.Medium}}]),e}()).\u0275fac=function(e){return new(e||Yx)(P.Pb(E.g),P.Pb(Nt),P.Pb(P.i))},Yx.\u0275cmp=P.Jb({type:Yx,selectors:[["app-view-layers-bar"]],decls:2,vars:5,consts:[[1,"view-layers-bar"],[1,"view-layers-bar__slider",3,"ngClass"]],template:function(e,t){1&e&&(P.Vb(0,"div",0),P.Qb(1,"app-view-layers-slider",1),P.Ub()),2&e&&(P.Db(1),P.lc("ngClass",P.qc(1,lk,t.isLarge(),!t.isLarge(),t.assetsLoading)))},directives:[ck,ra.i],styles:[".view-layers-bar[_ngcontent-%COMP%]{display:flex}.view-layers-bar__slider[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;margin-left:4px}.view-layers-bar__slider--large[_ngcontent-%COMP%]{width:300px}.view-layers-bar__slider--small[_ngcontent-%COMP%]{width:180px}.view-layers-bar__slider--disabled[_ngcontent-%COMP%]{opacity:.25;pointer-events:none}"],changeDetection:0}),Yx),pk=["viewToolbar"];function dk(e,t){if(1&e&&(P.Vb(0,"app-pillbox",7),P.Qb(1,"app-view-tools",8),P.Ub()),2&e){var n=P.gc(2);P.Db(1),P.lc("collapsePagination",n.collapsePagination)("collapseScrubber",n.collapseScrubber)("mode",n.viewToolsMode.Main)}}function gk(e,t){if(1&e){var n=P.Wb();P.Vb(0,"div",3),P.Kc(1,dk,2,3,"app-pillbox",4),P.Vb(2,"app-pillbox",5),P.Vb(3,"button",6),P.cc("click",(function(){return P.zc(n),P.gc().handleExploreToolsClick()})),P.Ub(),P.Ub(),P.Ub()}if(2&e){var i=P.gc();P.lc("@inOutAnimation",void 0),P.Db(1),P.lc("ngIf",i.isVisible(i.viewUI.Pagination)||i.isVisible(i.viewUI.Mediabar)),P.Db(2),P.lc("matTooltip","Explore"),P.Eb("aria-label","Explore")}}function hk(e,t){if(1&e){var n=P.Wb();P.Vb(0,"div",3),P.Vb(1,"app-pillbox",9),P.cc("exit",(function(){return P.zc(n),P.gc().handleExitClick()})),P.Qb(2,"app-view-media-bar",10),P.Ub(),P.Ub()}if(2&e){var i=P.gc();P.lc("@inOutAnimation",void 0),P.Db(1),P.lc("canExit",i.canExit),P.Db(1),P.lc("template",i.mediaTemplate)}}function fk(e,t){if(1&e){var n=P.Wb();P.Vb(0,"div",3),P.Vb(1,"app-pillbox",11),P.cc("exit",(function(){return P.zc(n),P.gc().handleExitClick()})),P.Qb(2,"app-view-tools",12),P.Ub(),P.Ub()}if(2&e){var i=P.gc();P.lc("@inOutAnimation",void 0),P.Db(1),P.lc("canExit",i.canExit),P.Db(1),P.lc("mode",i.viewToolsMode.Tools)}}function bk(e,t){if(1&e){var n=P.Wb();P.Vb(0,"div",3),P.Vb(1,"app-pillbox",13),P.cc("exit",(function(){return P.zc(n),P.gc().handleExitClick()})),P.Qb(2,"app-view-layers-bar"),P.Ub(),P.Ub()}if(2&e){var i=P.gc();P.lc("@inOutAnimation",void 0),P.Db(1),P.lc("canExit",i.canExit)}}var vk,mk=((vk=function(){function e(t,n,i,o){m(this,e),this.store=t,this.changeDetectorRef=n,this.viewService=i,this.viewUIService=o,this.viewUI=$u,this.canExit=!0,this.mode=ff.Main,this.lockMode=!1,this.position="center",this.ngUnsubscribe=new fe.a,this.breakpoint=Nu,this.viewToolsMode=ff,this.viewLayout=$u,this.collapsePagination=!1,this.collapseScrubber=!1}return v(e,[{key:"ngOnInit",value:function(){this.initLayoutListener(),this.initBreakpointListener()}},{key:"initLayoutListener",value:function(){var e=this;this.store.select(ku.getUI).pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){e.lockMode||(e.mode=ff.Main,e.viewUIService.isUIVisible($u.Media)&&(e.mediaTemplate=t.media.template,e.mode=ff.Media),e.viewUIService.isToolsVisible()&&(e.mode=ff.Tools),e.viewUIService.isVisibilityLayersVisible()&&e.viewUIService.isUIVisible($u.VisibilityLayers)&&(e.mode=ff.VisibilityLayers),e.changeDetectorRef.markForCheck())}))}},{key:"initBreakpointListener",value:function(){var e=this;this.store.select(Wu.getBreakpoint).pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){var n=t<=Nu.Small;e.collapseScrubber=n,e.collapsePagination=n,e.changeDetectorRef.markForCheck()}))}},{key:"isVisible",value:function(e){return this.viewUIService.isVisible(e)}},{key:"handleExitClick",value:function(){var e=this.store.selectSnapshot(ku.getUI);e.media.status=sc.Hide,e.tools.status=sc.Hide,e.visibilityLayers.status=sc.Hide,this.viewService.selectTool(Rr.Select),this.store.dispatch(new j.SetUI(e))}},{key:"handleExploreToolsClick",value:function(){this.viewService.toggleToolbar("tools")}}]),e}()).\u0275fac=function(e){return new(e||vk)(P.Pb(E.g),P.Pb(P.i),P.Pb(td),P.Pb(Yu))},vk.\u0275cmp=P.Jb({type:vk,selectors:[["app-view-toolbar"]],viewQuery:function(e,t){var n;1&e&&P.Rc(pk,!0),2&e&&P.uc(n=P.dc())&&(t.viewToolbar=n.first)},inputs:{canExit:"canExit",mode:"mode",lockMode:"lockMode",position:"position"},decls:5,vars:4,consts:[["data-test","view-toolbar",3,"ngSwitch"],["class","view-toolbar",4,"ngSwitchDefault"],["class","view-toolbar",4,"ngSwitchCase"],[1,"view-toolbar"],["eventCategory","View Primary Toolbar","name","Primary Toolbar",4,"ngIf"],["name","Explore Toolbar",1,"ml-3"],["data-test","viewExploreToolbar","icon","mouse-pointer","app-pin-button","","buttonType","ghost",3,"matTooltip","click"],["eventCategory","View Primary Toolbar","name","Primary Toolbar"],[3,"collapsePagination","collapseScrubber","mode"],["eventCategory","View Media Bar","name","Media Bar",3,"canExit","exit"],[3,"template"],["eventCategory","View Explore Tools","name","Explore Tools",3,"canExit","exit"],[3,"mode"],["name","Visibility Layers",3,"canExit","exit"]],template:function(e,t){1&e&&(P.Tb(0,0),P.Kc(1,gk,4,4,"div",1),P.Kc(2,hk,3,3,"div",2),P.Kc(3,fk,3,3,"div",2),P.Kc(4,bk,3,2,"div",2),P.Sb()),2&e&&(P.lc("ngSwitch",t.mode),P.Db(2),P.lc("ngSwitchCase",t.viewToolsMode.Media),P.Db(1),P.lc("ngSwitchCase",t.viewToolsMode.Tools),P.Db(1),P.lc("ngSwitchCase",t.viewToolsMode.VisibilityLayers))},directives:[ra.n,ra.p,ra.o,ra.l,px,vg,mg.c,ek,Fx,uk],styles:[".view-toolbar{position:absolute;display:flex;z-index:20;bottom:0;right:0}"],encapsulation:2,data:{animation:[Object(wu.n)("inOutAnimation",[Object(wu.m)(":enter",[Object(wu.l)({opacity:0,transform:"translateY(200px)"}),Object(wu.e)("300ms ease-in-out",Object(wu.l)({opacity:1,transform:"*"}))]),Object(wu.m)(":leave",[Object(wu.e)("300ms ease-in-out",Object(wu.l)({transform:"translateY(200px)",opacity:0}))])])]},changeDetection:0}),vk),yk=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},xk=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function kk(e,t){if(1&e){var n=P.Wb();P.Tb(0),P.Vb(1,"button",17),P.cc("click",(function(){return P.zc(n),P.gc().handleTreeClick()})),P.Qb(2,"app-icon",18),P.Vb(3,"span",19),P.Mc(4,"Anatomy Tree"),P.Ub(),P.Ub(),P.Vb(5,"button",20),P.cc("click",(function(){return P.zc(n),P.gc().handleSearchClick()})),P.Qb(6,"app-icon",21),P.Vb(7,"span",19),P.Mc(8,"Search"),P.Ub(),P.Ub(),P.Qb(9,"mat-divider"),P.Sb()}}function wk(e,t){if(1&e){var n=P.Wb();P.Vb(0,"button",22),P.cc("click",(function(){return P.zc(n),P.gc().toggleToolbar("visibilityLayers")})),P.Qb(1,"app-icon",23),P.Vb(2,"span",19),P.Mc(3,"Layers"),P.Ub(),P.Ub()}}function Ok(e,t){if(1&e){var n=P.Wb();P.Vb(0,"button",24),P.cc("click",(function(){return P.zc(n),P.gc().handleDrawClick()})),P.hc(1,"async"),P.Qb(2,"app-icon",25),P.Vb(3,"span",19),P.Mc(4,"Draw"),P.Ub(),P.Ub()}if(2&e){var i,o=P.gc();P.lc("disabled",!(null!=(i=P.ic(1,1,o.selectedChapterReady$))&&i.model))}}function Ck(e,t){if(1&e){var n=P.Wb();P.Vb(0,"button",26),P.cc("click",(function(){return P.zc(n),P.gc().handleTakeQuizClick()})),P.hc(1,"async"),P.hc(2,"async"),P.Qb(3,"app-icon",27),P.Vb(4,"span",19),P.Mc(5,"Take Quiz"),P.Ub(),P.Ub()}if(2&e){var i,o=P.gc();P.lc("disabled",!(null!=(i=P.ic(1,1,o.selectedChapterReady$))&&i.model)||P.ic(2,3,o.quizActive$))}}function Sk(e,t){if(1&e){var n=P.Wb();P.Vb(0,"button",28),P.cc("click",(function(){return P.zc(n),P.gc().toggleToolbar("media")})),P.Qb(1,"app-icon",29),P.Mc(2," Open Media Bar "),P.Ub()}}function _k(e,t){if(1&e&&(P.Vb(0,"button",30),P.Mc(1," Settings "),P.Ub()),2&e){P.gc();var n=P.vc(15);P.lc("matMenuTriggerFor",n)}}function jk(e,t){if(1&e&&(P.Vb(0,"button",30),P.Mc(1," Help "),P.Ub()),2&e){P.gc();var n=P.vc(19);P.lc("matMenuTriggerFor",n)}}function Pk(e,t){1&e&&(P.Tb(0),P.Mc(1,"Exit Fullscreen"),P.Sb())}function Mk(e,t){1&e&&(P.Tb(0),P.Mc(1,"Enter Fullscreen"),P.Sb())}function Ik(e,t){if(1&e){var n=P.Wb();P.Vb(0,"button",22),P.cc("click",(function(){return P.zc(n),P.gc(2).handleFullscreenClick()})),P.Kc(1,Pk,2,0,"ng-container",3),P.Kc(2,Mk,2,0,"ng-container",3),P.Ub()}if(2&e){var i=P.gc(2);P.Db(1),P.lc("ngIf",i.isFullscreen),P.Db(1),P.lc("ngIf",!i.isFullscreen)}}function zk(e,t){if(1&e){var n=P.Wb();P.Vb(0,"button",22),P.cc("click",(function(){return P.zc(n),P.gc(3).handleNewTabClick()})),P.Mc(1," Open in New Tab "),P.Ub()}}function Tk(e,t){if(1&e&&(P.Tb(0),P.Kc(1,zk,2,0,"button",4),P.Sb()),2&e){var n=P.gc(2);P.Db(1),P.lc("ngIf",!n.canFullscreen)}}function Uk(e,t){if(1&e&&(P.Tb(0),P.Kc(1,Ik,3,2,"button",4),P.Kc(2,Tk,2,1,"ng-container",31),P.Sb()),2&e){var n=P.gc();P.Db(1),P.lc("ngIf",n.canFullscreen),P.Db(1),P.lc("appFlagApplication",n.application.All)("appFlagApplicationMode","exclude")("appFlagApplicationNative",n.nativePlatform.All)}}function Lk(e,t){1&e&&(P.Vb(0,"span",35),P.Mc(1,"(On)"),P.Ub())}function Dk(e,t){1&e&&(P.Vb(0,"span",35),P.Mc(1,"(Off)"),P.Ub())}function Ek(e,t){if(1&e){var n=P.Wb();P.Vb(0,"button",32),P.cc("click",(function(){return P.zc(n),P.gc().handleToggleLabelsClick()})),P.Vb(1,"span",33),P.Mc(2,"Toggle Labels"),P.Ub(),P.Kc(3,Lk,2,0,"span",34),P.hc(4,"async"),P.Kc(5,Dk,2,0,"span",34),P.hc(6,"async"),P.Ub()}if(2&e){var i=P.gc();P.Db(3),P.lc("ngIf",P.ic(4,2,i.showLabels$)),P.Db(2),P.lc("ngIf",!P.ic(6,4,i.showLabels$))}}var Fk,Ak=((Fk=function(){function e(t,n,i,o,r,a){m(this,e),this.viewUIService=t,this.viewService=n,this.quizService=i,this.engineService=o,this.changeDetectorRef=r,this.store=a,this.application=M,this.nativePlatform=fl,this.viewUI=$u,this.isFullscreen=!1,this.canFullscreen=!1,this.ngUnsubscribe=new fe.a,this.visibilityLayersVisible=!1}return v(e,[{key:"ngOnInit",value:function(){this.canFullscreen=Ys.canFullscreen(),this.initFullscreenListener(),this.initLayoutListener()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initFullscreenListener",value:function(){var e=this;this.fullscreen$=Ys.onFullscreenChange(),this.fullscreen$.pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){e.isFullscreen=Ys.isFullscreen(),e.changeDetectorRef.markForCheck()}))}},{key:"initLayoutListener",value:function(){var e=this;this.store.select(ku.getUI).pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(){e.visibilityLayersVisible=e.viewUIService.isVisible($u.VisibilityLayers),e.changeDetectorRef.markForCheck()}))}},{key:"handleToggleLabelsClick",value:function(){this.viewService.toggleLabels()}},{key:"handleFullscreenClick",value:function(){Ys.toggleFullscreen()}},{key:"handleTutorialClick",value:function(){this.viewService.toggleTutorial(!0)}},{key:"handleTakeQuizClick",value:function(){this.quizService.startQuiz()}},{key:"handleHelpBasicsClick",value:function(){this.viewService.toggleHelp(!0,ye.Basics)}},{key:"handleHelpShortcutsClick",value:function(){this.viewService.toggleHelp(!0,ye.Shortcuts)}},{key:"handlePresentClick",value:function(){this.viewService.togglePresentation()}},{key:"handleNewTabClick",value:function(){this.viewService.openInNewTab()}},{key:"handleSearchClick",value:function(){this.viewService.toggleSearch(Yl.List,!0)}},{key:"handleTreeClick",value:function(){this.viewService.toggleSearch(Yl.Tree,!0)}},{key:"handleDrawClick",value:function(){this.viewService.toggleWhiteboard(!0)}},{key:"toggleToolbar",value:function(e){this.viewService.toggleToolbar(e)}},{key:"isEnabled",value:function(e){return this.viewUIService.isUIEnabled(e)}},{key:"isVisible",value:function(e){return this.viewUIService.isVisible(e)}}]),e}()).\u0275fac=function(e){return new(e||Fk)(P.Pb(Yu),P.Pb(td),P.Pb(bf),P.Pb(Nt),P.Pb(P.i),P.Pb(E.g))},Fk.\u0275cmp=P.Jb({type:Fk,selectors:[["app-view-menu"]],decls:27,vars:20,consts:[["gaEvent","","gaAction","Clicked View Menu","data-test","viewMenu","matTooltip","Menu","app-pin-button","","buttonType","secondary","icon","bars","aria-label","View Menu",2,"width","52px","height","52px",3,"matMenuTriggerFor","fill"],["gaCategory","View Menu",1,"view-menu"],["viewMenu","matMenu"],[4,"ngIf"],["mat-menu-item","",3,"click",4,"ngIf"],["gaEvent","","gaAction","Clicked Open Whiteboard","mat-menu-item","","data-test","viewDrawButton",3,"disabled","click",4,"ngIf"],["mat-menu-item","","data-test","viewQuizButton",3,"disabled","click",4,"ngIf"],["mat-menu-item","","data-test","viewMediaBarButton",3,"click",4,"ngIf"],["mat-menu-item","",3,"matMenuTriggerFor",4,"ngIf"],["gaCategory","Settings Menu"],["settingsMenu","matMenu"],["mat-menu-item","","data-test","viewToggleLabels",3,"click",4,"ngIf"],["gaCategory","View Menu"],["helpMenu","matMenu"],["gaEvent","","gaAction","Clicked Launch Tutorial","mat-menu-item","",3,"disabled","click"],["gaEvent","","gaAction","Clicked 3d Navigation Basics","mat-menu-item","",3,"click"],["gaEvent","","gaAction","Clicked Keyboard Shortcuts","mat-menu-item","",3,"click"],["gaEvent","","gaAction","Clicked Open Tree","mat-menu-item","","data-test","viewTreeButton",3,"click"],["icon","sitemap",1,"view-menu__icon"],[1,"ml-2"],["gaEvent","","gaAction","Clicked Open Search","mat-menu-item","","data-test","viewSearchButton",3,"click"],["icon","search",1,"view-menu__icon"],["mat-menu-item","",3,"click"],["icon","layer-group",1,"view-menu__icon"],["gaEvent","","gaAction","Clicked Open Whiteboard","mat-menu-item","","data-test","viewDrawButton",3,"disabled","click"],["icon","signature",1,"view-menu__icon"],["mat-menu-item","","data-test","viewQuizButton",3,"disabled","click"],["icon","check",1,"view-menu__icon"],["mat-menu-item","","data-test","viewMediaBarButton",3,"click"],["icon","play",1,"view-menu__icon"],["mat-menu-item","",3,"matMenuTriggerFor"],[4,"appFlagApplication","appFlagApplicationMode","appFlagApplicationNative"],["mat-menu-item","","data-test","viewToggleLabels",3,"click"],[1,"mr-3"],["class","text-dim",4,"ngIf"],[1,"text-dim"]],template:function(e,t){if(1&e&&(P.Qb(0,"button",0),P.Vb(1,"mat-menu",1,2),P.Kc(3,kk,10,0,"ng-container",3),P.Kc(4,wk,4,0,"button",4),P.Kc(5,Ok,5,3,"button",5),P.Kc(6,Ck,6,5,"button",6),P.hc(7,"async"),P.hc(8,"async"),P.hc(9,"async"),P.Kc(10,Sk,3,0,"button",7),P.Qb(11,"mat-divider"),P.Kc(12,_k,2,1,"button",8),P.Kc(13,jk,2,1,"button",8),P.Ub(),P.Vb(14,"mat-menu",9,10),P.Kc(16,Uk,3,4,"ng-container",3),P.Kc(17,Ek,7,6,"button",11),P.Ub(),P.Vb(18,"mat-menu",12,13),P.Vb(20,"button",14),P.cc("click",(function(){return t.handleTutorialClick()})),P.hc(21,"async"),P.Mc(22," Launch Tutorial "),P.Ub(),P.Vb(23,"button",15),P.cc("click",(function(){return t.handleHelpBasicsClick()})),P.Mc(24,"3D Navigation Basics"),P.Ub(),P.Vb(25,"button",16),P.cc("click",(function(){return t.handleHelpShortcutsClick()})),P.Mc(26,"Keyboard Shortcuts"),P.Ub(),P.Ub()),2&e){var n,i=P.vc(2);P.lc("matMenuTriggerFor",i)("fill",!0),P.Db(3),P.lc("ngIf",t.isEnabled(t.viewUI.Search)),P.Db(1),P.lc("ngIf",t.visibilityLayersVisible),P.Db(1),P.lc("ngIf",t.isEnabled(t.viewUI.Whiteboard)),P.Db(1),P.lc("ngIf",P.ic(7,12,t.hasQuiz$)&&P.ic(8,14,t.quizEnabled$)&&!P.ic(9,16,t.quizLocked$)),P.Db(4),P.lc("ngIf",t.isVisible(t.viewUI.ScrubberItem)),P.Db(2),P.lc("ngIf",t.isEnabled(t.viewUI.Fullscreen)||t.isEnabled(t.viewUI.ToggleLabels)),P.Db(1),P.lc("ngIf",t.isEnabled(t.viewUI.Help)),P.Db(3),P.lc("ngIf",t.isEnabled(t.viewUI.Fullscreen)),P.Db(1),P.lc("ngIf",t.isEnabled(t.viewUI.ToggleLabels)),P.Db(3),P.lc("disabled",!(null!=(n=P.ic(21,18,t.selectedChapterReady$))&&n.model))}},directives:[vg,Ce.b,mg.c,hl.d,hl.a,Ce.a,ra.l,vl.a,hl.b,nl,bl],pipes:[ra.b],styles:[".view-menu__icon[_ngcontent-%COMP%]{display:inline-flex;justify-content:center;width:16px}"],changeDetection:0}),yk([Object(E.d)(Lr.getSelectedChapterReadyState),xk("design:type",be.a)],Fk.prototype,"selectedChapterReady$",void 0),yk([Object(E.d)(_o.hasQuiz),xk("design:type",be.a)],Fk.prototype,"hasQuiz$",void 0),yk([Object(E.d)(_o.getQuizEnabled),xk("design:type",be.a)],Fk.prototype,"quizEnabled$",void 0),yk([Object(E.d)(_o.getQuizModeLocked),xk("design:type",be.a)],Fk.prototype,"quizLocked$",void 0),yk([Object(E.d)(_o.getQuizModeActive),xk("design:type",be.a)],Fk.prototype,"quizActive$",void 0),yk([Object(E.d)(Wr.getShowLabels),xk("design:type",be.a)],Fk.prototype,"showLabels$",void 0),Fk),Rk=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},Vk=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Nk(e,t){if(1&e){var n=P.Wb();P.Vb(0,"button",8),P.cc("touchstart",(function(){return P.zc(n),P.gc(2).setZoom("out")}))("mousedown",(function(){return P.zc(n),P.gc(2).setZoom("out")}))("touchend",(function(){return P.zc(n),P.gc(2).setZoom("")}))("mouseup",(function(){return P.zc(n),P.gc(2).setZoom("")}))("mouseleave",(function(){return P.zc(n),P.gc(2).setZoom("")}))("keyup.enter",(function(){return P.zc(n),P.gc(2).setZoomFixed("out")})),P.Ub()}}function Bk(e,t){if(1&e){var n=P.Wb();P.Vb(0,"button",9),P.cc("touchstart",(function(){return P.zc(n),P.gc(2).setZoom("in")}))("mousedown",(function(){return P.zc(n),P.gc(2).setZoom("in")}))("touchend",(function(){return P.zc(n),P.gc(2).setZoom("")}))("mouseup",(function(){return P.zc(n),P.gc(2).setZoom("")}))("mouseleave",(function(){return P.zc(n),P.gc(2).setZoom("")}))("keyup.enter",(function(){return P.zc(n),P.gc(2).setZoomFixed("in")})),P.Ub()}}function Hk(e,t){if(1&e){var n=P.Wb();P.Vb(0,"button",10),P.cc("click",(function(){return P.zc(n),P.gc(2).returnToChapterCamera()})),P.Ub()}}function Qk(e,t){if(1&e){var n=P.Wb();P.Vb(0,"button",11),P.cc("click",(function(){return P.zc(n),P.gc(2).togglePan()})),P.hc(1,"async"),P.hc(2,"async"),P.hc(3,"async"),P.hc(4,"async"),P.Ub()}if(2&e){var i=P.gc(2);P.lc("gaLabel","pan"===P.ic(1,4,i.panMode$)?"Rotate":"Pan")("selected","pan"===P.ic(2,6,i.panMode$))("matTooltip","pan"===P.ic(4,10,i.panMode$)?"Switch to Rotate Mode":"Switch to Pan Mode"),P.Eb("aria-label","pan"===P.ic(3,8,i.panMode$)?"Switch to Rotate Mode":"Switch to Pan Mode")}}function qk(e,t){if(1&e&&(P.Vb(0,"app-pillbox",2),P.Vb(1,"div",3),P.Kc(2,Nk,1,0,"button",4),P.Kc(3,Bk,1,0,"button",5),P.Kc(4,Hk,1,0,"button",6),P.Kc(5,Qk,5,12,"button",7),P.Ub(),P.Ub()),2&e){var n=P.gc();P.Db(2),P.lc("ngIf",n.showZoom),P.Db(1),P.lc("ngIf",n.showZoom),P.Db(1),P.lc("ngIf",n.showResetPosition),P.Db(1),P.lc("ngIf",n.showPan)}}var Wk,$k=((Wk=function(){function e(t,n){m(this,e),this.store=t,this.cameraService=n,this.showNav=!0,this.showZoom=!0,this.showPan=!0,this.showResetPosition=!0,this.viewLayout=$u,this.toolEnum=Rr,this.expandNav=!1,this.breakpointEnum=Nu,this.padding="none",this.ngUnsubscribe=new fe.a}return v(e,[{key:"ngOnInit",value:function(){}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"setZoom",value:function(e){var t=""===e?0:8;t="in"===e?-t:t,this.store.dispatch(new Jt(t))}},{key:"setZoomFixed",value:function(e){this.cameraService.setCameraZoomWithVelocity("in"===e?-8:8)}},{key:"returnToChapterCamera",value:function(){var e=this.store.selectSnapshot(Lr.getSelectedChapter);this.store.dispatch(new $t(e.camera.location))}},{key:"resetChapter",value:function(){this.returnToChapterCamera();var e=this.store.selectSnapshot(Lr.getSelectedChapterId);this.store.dispatch(new di.UndoAll(e)),this.store.dispatch(new pi.UpdateNodesChecked(!1)),this.store.dispatch(new qo)}},{key:"centerCamera",value:function(){this.store.dispatch(new qe)}},{key:"togglePan",value:function(){var e="pan"===this.store.selectSnapshot(Ar.getPanMode)?"rotate":"pan";this.store.dispatch(new an(e))}},{key:"toggleNav",value:function(){this.expandNav=!this.expandNav}}]),e}()).\u0275fac=function(e){return new(e||Wk)(P.Pb(E.g),P.Pb(gn))},Wk.\u0275cmp=P.Jb({type:Wk,selectors:[["app-engine-camera-bar"]],inputs:{showNav:"showNav",showZoom:"showZoom",showPan:"showPan",showResetPosition:"showResetPosition"},decls:2,vars:1,consts:[["gaCategory","Engine 3D Controls","data-test","cameraBar",1,"camera-bar"],["eventCategory","Engine 3D Controls","orientation","vertical",4,"ngIf"],["eventCategory","Engine 3D Controls","orientation","vertical"],[1,"camera-bar__nav"],["gaEvent","","gaAction","Clicked Zoom Out","app-pin-button","","buttonType","ghost","icon","minus","tabIndex","0","data-test","cameraZoomOut","aria-label","Zoom Out","matTooltip","Zoom Out","matTooltipPosition","left",3,"touchstart","mousedown","touchend","mouseup","mouseleave","keyup.enter",4,"ngIf"],["gaEvent","","gaAction","Clicked Zoom In","app-pin-button","","buttonType","ghost","icon","plus","tabIndex","0","data-test","cameraZoomIn","aria-label","Zoom In","matTooltip","Zoom In","matTooltipPosition","left",3,"touchstart","mousedown","touchend","mouseup","mouseleave","keyup.enter",4,"ngIf"],["gaEvent","","gaAction","Clicked Recenter 3D Model","app-pin-button","","icon","location","buttonType","ghost","tabIndex","0","aria-label","Recenter 3D model","matTooltip","Recenter 3D model","matTooltipPosition","left","data-test","cameraReset",3,"click",4,"ngIf"],["gaEvent","","gaAction","Clicked Switch Mode","app-pin-button","","tabIndex","0","icon","arrows-alt","buttonType","ghost","matTooltipPosition","left","data-test","cameraPan",3,"gaLabel","selected","matTooltip","click",4,"ngIf"],["gaEvent","","gaAction","Clicked Zoom Out","app-pin-button","","buttonType","ghost","icon","minus","tabIndex","0","data-test","cameraZoomOut","aria-label","Zoom Out","matTooltip","Zoom Out","matTooltipPosition","left",3,"touchstart","mousedown","touchend","mouseup","mouseleave","keyup.enter"],["gaEvent","","gaAction","Clicked Zoom In","app-pin-button","","buttonType","ghost","icon","plus","tabIndex","0","data-test","cameraZoomIn","aria-label","Zoom In","matTooltip","Zoom In","matTooltipPosition","left",3,"touchstart","mousedown","touchend","mouseup","mouseleave","keyup.enter"],["gaEvent","","gaAction","Clicked Recenter 3D Model","app-pin-button","","icon","location","buttonType","ghost","tabIndex","0","aria-label","Recenter 3D model","matTooltip","Recenter 3D model","matTooltipPosition","left","data-test","cameraReset",3,"click"],["gaEvent","","gaAction","Clicked Switch Mode","app-pin-button","","tabIndex","0","icon","arrows-alt","buttonType","ghost","matTooltipPosition","left","data-test","cameraPan",3,"gaLabel","selected","matTooltip","click"]],template:function(e,t){1&e&&(P.Vb(0,"div",0),P.Kc(1,qk,6,4,"app-pillbox",1),P.Ub()),2&e&&(P.Db(1),P.lc("ngIf",t.showNav))},directives:[Ce.a,ra.l,px,vg,Ce.b,mg.c],pipes:[ra.b],styles:[":host{position:relative}.camera-bar{display:flex;flex-direction:column;align-items:center}.camera-bar button:not(:first-child){margin-top:4px}.camera-bar__nav{display:flex;flex-direction:column-reverse;overflow:hidden;transition:height .15s ease-in-out;justify-content:space-between}"],encapsulation:2,data:{animation:[Object(wu.n)("expand",[Object(wu.m)(":enter",[Object(wu.j)([Object(wu.l)({height:0}),Object(wu.e)("150ms ease-in-out",Object(wu.l)({height:"*"}))])]),Object(wu.m)(":leave",[Object(wu.j)([Object(wu.e)("150ms ease-in-out",Object(wu.l)({height:"0"}))])])]),Object(wu.n)("show",[Object(wu.m)(":enter",[Object(wu.j)([Object(wu.l)({height:"0"}),Object(wu.e)("125ms ease-in-out",Object(wu.l)({height:"*"}))])]),Object(wu.m)(":leave",[Object(wu.j)([Object(wu.e)("125ms 125ms ease-in-out",Object(wu.l)({height:"0"}))])])])]},changeDetection:0}),Rk([Object(E.d)(Ar.getPanMode),Vk("design:type",be.a)],Wk.prototype,"panMode$",void 0),Rk([Object(E.d)(Wu.getBreakpoint),Vk("design:type",be.a)],Wk.prototype,"breakpoint$",void 0),Wk);function Kk(e,t){if(1&e&&(P.Vb(0,"kbd",10),P.Mc(1),P.Ub()),2&e){var n=t.$implicit;P.Db(1),P.Nc(n)}}function Gk(e,t){if(1&e&&(P.Vb(0,"tr",6),P.Vb(1,"td",7),P.Mc(2),P.Ub(),P.Vb(3,"td",8),P.Kc(4,Kk,2,1,"kbd",9),P.Ub(),P.Ub()),2&e){var n=t.$implicit;P.Db(2),P.Nc(n.label),P.Db(2),P.lc("ngForOf",n.keys)}}function Zk(e,t){if(1&e&&(P.Vb(0,"div",2),P.Vb(1,"h2",3),P.Mc(2),P.Ub(),P.Vb(3,"table",4),P.Vb(4,"tbody"),P.Kc(5,Gk,5,2,"tr",5),P.Ub(),P.Ub(),P.Ub()),2&e){var n=t.$implicit;P.Db(2),P.Nc(n.label),P.Db(3),P.lc("ngForOf",n.shortcuts)}}var Jk,Xk=function(e){return e.Left="\u2190",e.Right="\u2192",e.Up="\u2191",e.Down="\u2193",e.Command="\u2318",e}({}),Yk=((Jk=function(){function e(){m(this,e),this.shortcutGroups=[{label:"Navigation",shortcuts:[{keys:[",","Pg-Up"],label:"Previous chapter"},{keys:[".","Pg-Down"],label:"Next chapter"},{keys:["/"],label:"Open Search"},{keys:["Ctrl + Enter"],label:"Enter Fullscreen"},{keys:["Ctrl/Cmd + ,"],label:"Toggle Description"}]},{label:"Tools",shortcuts:[{keys:["1"],label:'Use "Select" tool'},{keys:["2"],label:'Use "Hide" tool'},{keys:["3"],label:'Use "Fade" tool'},{keys:["del","backspace"],label:"Hide selected structure"},{keys:["Shift + R"],label:"Reset chapter"},{keys:["Ctrl/Cmd + Z"],label:"Undo"},{keys:["Ctrl/Cmd + Shift + Z","Ctrl/Cmd + Y"],label:"Redo"}]},{label:"Pan",shortcuts:[{keys:["W"],label:"Pan up"},{keys:["S"],label:"Pan down"},{keys:["A"],label:"Pan left"},{keys:["D"],label:"Pan right"},{keys:["Shift + W"],label:"Slow pan up"},{keys:["Shift + S"],label:"Slow pan down"},{keys:["Shift + A"],label:"Slow pan left"},{keys:["Shift + D"],label:"Slow pan right"}]},{label:"Rotate",shortcuts:[{keys:[Xk.Up],label:"Rotate up"},{keys:[Xk.Down],label:"Rotate down"},{keys:[Xk.Left],label:"Rotate left"},{keys:[Xk.Right],label:"Rotate right"},{keys:["Shift + "+Xk.Up],label:"Slow rotate up"},{keys:["Shift + "+Xk.Down],label:"Slow rotate down"},{keys:["Shift + "+Xk.Left],label:"Slow rotate left"},{keys:["Shift + "+Xk.Right],label:"Slow rotate right"}]},{label:"Zoom",shortcuts:[{keys:["C","="],label:"Zoom in"},{keys:["E","-"],label:"Zoom out"},{keys:["Shift + C","Shift + ="],label:"Slow zoom in"},{keys:["Shift + E","Shift + -"],label:"Slow zoom out"}]}]}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||Jk)},Jk.\u0275cmp=P.Jb({type:Jk,selectors:[["app-view-shortcuts"]],decls:2,vars:1,consts:[[1,"view-shortcuts"],["class","view-shortcuts__group",4,"ngFor","ngForOf"],[1,"view-shortcuts__group"],[1,"view-shortcuts__label","text-bold"],[1,"view-shortcuts__table"],["class","view-shortcuts__row",4,"ngFor","ngForOf"],[1,"view-shortcuts__row"],[1,"view-shortcuts__cell","view-shortcuts__cell--label"],[1,"view-shortcuts__cell","view-shortcuts__cell--key"],["class","view-shortcuts__key",4,"ngFor","ngForOf"],[1,"view-shortcuts__key"]],template:function(e,t){1&e&&(P.Vb(0,"div",0),P.Kc(1,Zk,6,2,"div",1),P.Ub()),2&e&&(P.Db(1),P.lc("ngForOf",t.shortcutGroups))},directives:[ra.k],styles:[".view-shortcuts[_ngcontent-%COMP%]{display:flex;flex-direction:column}.view-shortcuts__group[_ngcontent-%COMP%]{width:100%;padding-bottom:32px;margin-top:32px}.view-shortcuts__label[_ngcontent-%COMP%]{padding:8px 0 12px}.view-shortcuts__table[_ngcontent-%COMP%]{width:100%}.view-shortcuts__cell[_ngcontent-%COMP%]{padding:8px;border-bottom:1px solid hsla(0,0%,100%,.3);width:50%}.view-shortcuts__key[_ngcontent-%COMP%]{border-radius:4px;display:inline-flex;padding:4px;margin-right:4px;background:#000;color:#fff;justify-content:center;align-items:center;font-family:monospace;font-size:16px}"],changeDetection:0}),Jk),ew=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},tw=["viewHelp"];function nw(e,t){1&e&&(P.Tb(0),P.Vb(1,"div",10),P.Vb(2,"div",11),P.Qb(3,"div",12),P.Vb(4,"div",13),P.Mc(5,"Rotate"),P.Ub(),P.Mc(6," Click and drag or use one finger to change the viewing angle. "),P.Ub(),P.Vb(7,"div",11),P.Qb(8,"div",12),P.Vb(9,"div",13),P.Mc(10,"Pan"),P.Ub(),P.Mc(11," Hold the shift key and drag or use two fingers to move the model's position. "),P.Ub(),P.Vb(12,"div",11),P.Qb(13,"div",12),P.Vb(14,"div",13),P.Mc(15,"Zoom"),P.Ub(),P.Mc(16," Scroll up and down or pinch with two fingers to zoom in or out. "),P.Ub(),P.Vb(17,"div",11),P.Qb(18,"div",12),P.Vb(19,"div",13),P.Mc(20,"Explore the Anatomy"),P.Ub(),P.Mc(21," Click or tap an anatomic structure or label to learn more. "),P.Ub(),P.Ub(),P.Sb()),2&e&&(P.Db(3),P.Hc("background-image","url(assets/images/widget/help-rotate.svg)"),P.Db(5),P.Hc("background-image","url(assets/images/widget/help-pan.svg)"),P.Db(5),P.Hc("background-image","url(assets/images/widget/help-zoom.svg)"),P.Db(5),P.Hc("background-image","url(assets/images/widget/help-learn.svg)"))}function iw(e,t){1&e&&(P.Tb(0),P.Vb(1,"div",14),P.Mc(2," Mouse "),P.Ub(),P.Vb(3,"div",10),P.Vb(4,"div",11),P.Qb(5,"div",12),P.Mc(6," Hold left button to rotate "),P.Ub(),P.Vb(7,"div",11),P.Qb(8,"div",12),P.Mc(9," Hold right button to pan "),P.Ub(),P.Vb(10,"div",11),P.Qb(11,"div",12),P.Mc(12," Single-click left button to select a structure "),P.Ub(),P.Vb(13,"div",11),P.Qb(14,"div",12),P.Mc(15," Double-click left button to auto-focus on a structure "),P.Ub(),P.Vb(16,"div",11),P.Qb(17,"div",12),P.Mc(18," Long-click to fly to a structure "),P.Ub(),P.Ub(),P.Vb(19,"div",14),P.Mc(20," Keyboard "),P.Ub(),P.Vb(21,"div",10),P.Vb(22,"div",11),P.Qb(23,"div",12),P.Mc(24," Rotate with arrows "),P.Ub(),P.Vb(25,"div",11),P.Qb(26,"div",12),P.Mc(27," Pan up (W), left (A), down (S), right(D) "),P.Ub(),P.Vb(28,"div",11),P.Qb(29,"div",12),P.Mc(30," Zoom out (-, C) and zoom in (+, E) "),P.Ub(),P.Vb(31,"div",11),P.Qb(32,"div",12),P.Mc(33," Hold with any previous key to slow down motion "),P.Ub(),P.Ub(),P.Vb(34,"div",14),P.Mc(35," Trackpad "),P.Ub(),P.Vb(36,"div",10),P.Vb(37,"div",11),P.Qb(38,"div",12),P.Mc(39," Single-tap to auto-focus a structure "),P.Ub(),P.Vb(40,"div",11),P.Qb(41,"div",12),P.Mc(42," Double-tap to select a structure "),P.Ub(),P.Vb(43,"div",11),P.Qb(44,"div",12),P.Mc(45," Long-press to fly to a structure "),P.Ub(),P.Vb(46,"div",11),P.Qb(47,"div",12),P.Mc(48," Scroll up and down to zoom "),P.Ub(),P.Ub(),P.Vb(49,"div",14),P.Mc(50," In-App "),P.Ub(),P.Vb(51,"div",10),P.Vb(52,"div",11),P.Qb(53,"app-icon",15),P.Mc(54," Zoom in "),P.Ub(),P.Vb(55,"div",11),P.Qb(56,"app-icon",16),P.Mc(57," Zoom out "),P.Ub(),P.Vb(58,"div",11),P.Qb(59,"app-icon",17),P.Mc(60," Recenter 3D model "),P.Ub(),P.Vb(61,"div",11),P.Qb(62,"app-icon",18),P.Mc(63," Pan "),P.Ub(),P.Ub(),P.Sb()),2&e&&(P.Db(5),P.Hc("background-image","url(assets/images/widget/help-mouse-hold-left.svg)"),P.Db(3),P.Hc("background-image","url(assets/images/widget/help-mouse-hold-right.svg)"),P.Db(3),P.Hc("background-image","url(assets/images/widget/help-mouse-single-click-left.svg)"),P.Db(3),P.Hc("background-image","url(assets/images/widget/help-mouse-double-click-left.svg)"),P.Db(3),P.Hc("background-image","url(assets/images/widget/help-mouse-long-press-left.svg)"),P.Db(6),P.Hc("background-image","url(assets/images/widget/help-keyboard-rotate.svg)"),P.Db(3),P.Hc("background-image","url(assets/images/widget/help-keyboard-pan.svg)"),P.Db(3),P.Hc("background-image","url(assets/images/widget/help-keyboard-zoom.svg)"),P.Db(3),P.Hc("background-image","url(assets/images/widget/help-keyboard-slow-motion.svg)"),P.Db(6),P.Hc("background-image","url(assets/images/widget/help-trackpad-single-tap.svg)"),P.Db(3),P.Hc("background-image","url(assets/images/widget/help-trackpad-double-tap.svg)"),P.Db(3),P.Hc("background-image","url(assets/images/widget/help-trackpad-long-press.svg)"),P.Db(3),P.Hc("background-image","url(assets/images/widget/help-trackpad-scroll.svg)"))}function ow(e,t){1&e&&(P.Tb(0),P.Qb(1,"app-view-shortcuts"),P.Sb())}var rw,aw,sw,cw,lw,uw,pw,dw,gw,hw=function(e){return{"view-help__tab--active":e}},fw=((rw=function(){function e(t,n){m(this,e),this.renderer=t,this.viewService=n,this.helpTypeEnum=ye,this.activeTab=ye.Basics,this.ngUnsubscribe=new fe.a}return v(e,[{key:"ngOnInit",value:function(){this.initWindowSizeObserver()}},{key:"ngAfterViewInit",value:function(){this.updateViewHeight()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initWindowSizeObserver",value:function(){var e=this;this.renderer.listen("window","resize",(function(){e.updateViewHeight()}))}},{key:"updateViewHeight",value:function(){var e=this.viewService.getVH(!1);this.viewHelp.nativeElement.style.setProperty("--vh",e+"px")}},{key:"handleCloseClick",value:function(){this.viewService.toggleHelp(!1)}},{key:"handleTabClick",value:function(e){this.activeTab=e}}]),e}()).\u0275fac=function(e){return new(e||rw)(P.Pb(P.H),P.Pb(td))},rw.\u0275cmp=P.Jb({type:rw,selectors:[["app-view-help"]],viewQuery:function(e,t){var n;1&e&&P.Gc(tw,!0),2&e&&P.uc(n=P.dc())&&(t.viewHelp=n.first)},inputs:{activeTab:"activeTab"},decls:15,vars:13,consts:[["gaCategory","View Help",1,"view-help"],["viewHelp",""],[1,"view-help__inner",3,"ngSwitch"],["gaEvent","","gaAction","Clicked Close Help",1,"view-help__close",3,"click"],["icon","times"],[1,"view-help__tabs"],["gaEvent","","gaAction","Clicked Navigation Basics","role","button",1,"view-help__tab",3,"ngClass","click"],["gaEvent","","gaAction","Clicked All Controls","role","button",1,"view-help__tab",3,"ngClass","click"],["gaEvent","","gaAction","Clicked Keyboard Shortcuts","role","button",1,"view-help__tab",3,"ngClass","click"],[4,"ngSwitchCase"],[1,"view-help__group"],[1,"view-help__item"],[1,"view-help__image"],[1,"view-help__label"],[1,"view-help__header"],["icon","plus",1,"view-help__icon"],["icon","minus",1,"view-help__icon"],["icon","location",1,"view-help__icon"],["icon","arrows",1,"view-help__icon"]],template:function(e,t){1&e&&(P.Vb(0,"div",0,1),P.Vb(2,"div",2),P.Vb(3,"div",3),P.cc("click",(function(){return t.handleCloseClick()})),P.Qb(4,"app-icon",4),P.Ub(),P.Vb(5,"div",5),P.Vb(6,"div",6),P.cc("click",(function(){return t.handleTabClick(t.helpTypeEnum.Basics)})),P.Mc(7," Navigation Basics "),P.Ub(),P.Vb(8,"div",7),P.cc("click",(function(){return t.handleTabClick(t.helpTypeEnum.All)})),P.Mc(9," All Controls "),P.Ub(),P.Vb(10,"div",8),P.cc("click",(function(){return t.handleTabClick(t.helpTypeEnum.Shortcuts)})),P.Mc(11," Keyboard Shortcuts "),P.Ub(),P.Ub(),P.Kc(12,nw,22,8,"ng-container",9),P.Kc(13,iw,64,26,"ng-container",9),P.Kc(14,ow,2,0,"ng-container",9),P.Ub(),P.Ub()),2&e&&(P.Db(2),P.lc("ngSwitch",t.activeTab),P.Db(4),P.lc("ngClass",P.oc(7,hw,t.activeTab===t.helpTypeEnum.Basics)),P.Db(2),P.lc("ngClass",P.oc(9,hw,t.activeTab===t.helpTypeEnum.All)),P.Db(2),P.lc("ngClass",P.oc(11,hw,t.activeTab===t.helpTypeEnum.Shortcuts)),P.Db(2),P.lc("ngSwitchCase",t.helpTypeEnum.Basics),P.Db(1),P.lc("ngSwitchCase",t.helpTypeEnum.All),P.Db(1),P.lc("ngSwitchCase",t.helpTypeEnum.Shortcuts))},directives:[Ce.a,ra.n,Ce.b,nl,ra.i,ra.o,Yk],styles:['.text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3838}.text-info{color:#0060c4}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.view-help{background-color:rgba(16,24,35,.9);color:#fff;background-color:var(--view-help-bg);color:var(--view-help-color);display:flex;align-items:center;flex-direction:column;position:fixed;top:0;left:0;right:0;z-index:10000;height:100vh;height:calc(var(--vh, 1vh) * 100);max-height:100vh;overflow:auto}.view-help__inner{width:100%;max-width:1140px;height:99vh;height:calc(var(--vh, 1vh) * 99);padding:32px;position:relative}.view-help__close{width:40px;height:40px;display:flex;align-items:center;justify-content:center;position:fixed;right:8px;top:8px}.view-help__close:hover{cursor:pointer}.view-help__header{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase;border-bottom:1px solid hsla(0,0%,100%,.3);border-bottom:var(--view-help-border);font-weight:600;padding-bottom:12px;margin-top:32px}.view-help__label{font-size:14px;letter-spacing:.35px;line-height:1.4em;font-weight:600;margin-bottom:12px}.view-help__group{display:flex;justify-content:space-around;flex-wrap:wrap}.view-help__item{font-size:12px;letter-spacing:.3px;line-height:1.4em;display:flex;flex-flow:column;text-align:center;padding:20px;flex:0 1 180px}.view-help__image{margin-bottom:16px;width:160px;height:100px;background-position:50%;background-repeat:no-repeat}.view-help__icon{font-size:24px;margin-bottom:16px}.view-help__tabs{display:flex;justify-content:center;align-items:center}.view-help__tab{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase;border-bottom:2px solid transparent;padding:12px;text-align:center}.view-help__tab:after{content:"";display:block;border-bottom:3px solid #2d72dc;border-bottom:var(--view-help-tab-border);margin-top:4px;width:0;transition:.25s ease}.view-help__tab:hover{cursor:pointer}.view-help__tab--active:after{width:100%}'],encapsulation:2,changeDetection:0}),function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);r>3&&a&&Object.defineProperty(t,n,a)}([Object(E.d)(ku.getCanTouch),ew("design:type",be.a)],rw.prototype,"canTouch$",void 0),rw),bw=h("un/a"),vw=function e(){m(this,e)},mw=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},yw=(aw=function e(){m(this,e),this.type=I.Bookmark,this.favorite=!1,this.unavailable=!1},function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);r>3&&a&&Object.defineProperty(t,n,a)}([Object(te.Type)((function(){return vw})),mw("design:type",Array)],aw.prototype,"group_access",void 0),aw),xw=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},kw=(sw=function e(){m(this,e)},function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);r>3&&a&&Object.defineProperty(t,n,a)}([Object(te.Type)((function(){return ps})),xw("design:type",String)],sw.prototype,"objectId",void 0),sw),ww=function e(){m(this,e)},Ow=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Cw=(cw=function e(){m(this,e)},function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);r>3&&a&&Object.defineProperty(t,n,a)}([Object(te.Type)((function(){return kw})),Object(te.Type)((function(){return Lt})),Object(te.Type)((function(){return ww})),Ow("design:type",String)],cw.prototype,"moduleId",void 0),cw),Sw={main:[{title:"All Models",id:"all",type:"Category",translations:{es:{title:"Todas las Categor\xedas"},zh:{title:"\u6240\u6709\u7c7b\u522b"},fr:{title:"Toutes les cat\xe9gories"},de:{title:"Alle Kategorien"},it:{title:"Tutte le categorie"},ja:{title:"\u3059\u3079\u3066\u306e\u30ab\u30c6\u30b4\u30ea"},pt:{title:"Todas as categorias"}}}],categories:[{title:"Anatomy by Regions",id:"regional",type:"Category",translations:{es:{title:"Anatom\xeda por Regiones"},zh:{title:"\u6309\u5730\u533a\u5212\u5206\u7684\u89e3\u5256\u5b66"},fr:{title:"Anatomie par r\xe9gions"},de:{title:"Anatomie nach Regionen"},it:{title:"Anatomia per regioni"},ja:{title:"\u5730\u57df\u5225\u89e3\u5256\u5b66"},pt:{title:"Anatomia por Regi\xf5es"}}},{title:"Anatomy by Systems",id:"system",type:"Category",translations:{es:{title:"Anatom\xeda por Sistemas"},zh:{title:"\u6309\u7cfb\u7edf\u8fdb\u884c\u89e3\u5256\u5b66"},fr:{title:"Anatomie par syst\xe8mes"},de:{title:"Anatomie nach Systemen"},it:{title:"Anatomia per sistemi"},ja:{title:"\u30b7\u30b9\u30c6\u30e0\u306b\u3088\u308b\u89e3\u5256\u5b66"},pt:{title:"Anatomia por Sistemas"}}},{title:"Complete Anatomy",id:"complete anatomy",type:"Category",translations:{de:{title:"Komplette Anatomie"},es:{title:"Anatom\xeda completa"},fr:{title:"Anatomie compl\xe8te"},it:{title:"Anatomia completa"},ja:{title:"\u5b8c\u5168\u306a\u89e3\u5256\u5b66"},pt:{title:"Anatomia Completa"},zh:{title:"\u5b8c\u6574\u89e3\u5256\u5b66"}}},{title:"Cross Sections & Micro Anatomy",id:"Cross Section and Micro Anatomy",type:"Category",translations:{de:{title:"Querschnitte & Mikro-Anatomie"},es:{title:"Secciones transversales y Micro Anatom\xeda"},fr:{title:"Sections transversales et micro anatomie"},it:{title:"Sezioni trasversali & Micro Anatomia"},ja:{title:"\u65ad\u9762\uff06\u30de\u30a4\u30af\u30ed\u89e3\u5256\u5b66"},pt:{title:"Se\xe7\xf5es Transversais e Micro Anatomia"},zh:{title:"\u622a\u9762\u548c\u5fae\u578b\u89e3\u5256\u5b66"}}}],specialties:[{title:"Allergy & Immunology",id:"Allergy and Immunology",type:"Category",translations:{de:{title:"Allergie und Immunologie"},es:{title:"Alergia e Inmunolog\xeda"},fr:{title:"Allergie et Immunologie"},it:{title:"Allergia e Immunologia"},ja:{title:"\u30a2\u30ec\u30eb\u30ae\u30fc\u3068\u514d\u75ab\u5b66"},pt:{title:"Alergia e Imunologia"},zh:{title:"\u8fc7\u654f\u4e0e\u514d\u75ab\u5b66"}}},{title:"Cardiology",id:"Cardiology",type:"Category",translations:{de:{title:"Kardiologie"},es:{title:"Cardiolog\xeda"},fr:{title:"Cardiologie"},it:{title:"Cardiologia"},ja:{title:"\u5fc3\u81d3\u75c5\u5b66"},pt:{title:"Cardiologia"},zh:{title:"\u5fc3\u810f\u75c5\u5b66"}}},{title:"Dentistry",id:"Dentistry",type:"Category",translations:{de:{title:"Zahnmedizin"},es:{title:"Odontolog\xeda"},fr:{title:"Dentisterie"},it:{title:"Odontoiatria"},ja:{title:"\u6b6f\u79d1"},pt:{title:"Odontologia"},zh:{title:"\u7259\u79d1"}}},{title:"Dermatology",id:"Dermatology",type:"Category",translations:{de:{title:"Dermatologie"},es:{title:"Dermatolog\xeda"},fr:{title:"Dermatologie"},it:{title:"Dermatologia"},ja:{title:"\u76ae\u819a\u79d1"},pt:{title:"Dermatologia"},zh:{title:"\u76ae\u80a4\u79d1"}}},{title:"Endocrinology",id:"Endocrinology",type:"Category",translations:{de:{title:"Endokrinologie"},es:{title:"Endocrinolog\xeda"},fr:{title:"Endocrinologie"},it:{title:"Endocrinologia"},ja:{title:"\u5185\u5206\u6ccc\u5185\u79d1"},pt:{title:"Endocrinologia"},zh:{title:"\u5185\u5206\u6ccc\u5b66"}}},{title:"Gastroenterology",id:"Gastroenterology and Hepatology",type:"Category",translations:{de:{title:"Gastroenterologie"},es:{title:"Gastroenterolog\xeda"},fr:{title:"Gastroent\xe9rologie"},it:{title:"Gastroenterologia"},ja:{title:"\u6d88\u5316\u5668\u5185\u79d1"},pt:{title:"Gastroenterologia"},zh:{title:"\u80c3\u80a0\u75c5\u5b66"}}},{title:"Infectious Disease",id:"Infectious Disease",type:"Category",translations:{de:{title:"Infektionskrankheit"},es:{title:"Enfermedades Infecciosas"},fr:{title:"Maladies infectieuses"},it:{title:"Malattie Infettive"},ja:{title:"\u611f\u67d3\u75c7"},pt:{title:"Doen\xe7a Infecciosa"},zh:{title:"\u4f20\u67d3\u75c5"}}},{title:"Nephrology",id:"Nephrology",type:"Category",translations:{de:{title:"Nephrologie"},es:{title:"Nefrolog\xeda"},fr:{title:"N\xe9phrologie"},it:{title:"Nefrologia"},ja:{title:"\u814e\u5b66"},pt:{title:"Nefrologia"},zh:{title:"\u80be\u810f\u75c5\u5b66"}}},{title:"Neurology & Psychiatry",id:"Neurology and Psychiatry",type:"Category",translations:{de:{title:"Neurologie & Psychiatrie"},es:{title:"Neurolog\xeda y Psiquiatr\xeda"},fr:{title:"Neurologie & Psychiatrie"},it:{title:"Neurologia & Psichiatria"},ja:{title:"\u795e\u7d4c\u5185\u79d1\u30fb\u7cbe\u795e\u79d1"},pt:{title:"Neurologia e Psiquiatria"},zh:{title:"\u795e\u7ecf\u5b66\u548c\u7cbe\u795e\u75c5\u5b66"}}},{title:"Obstetrics & Gynecology",id:"Obstetrics and Gynecology",type:"Category",translations:{de:{title:"Geburtshilfe & Gyn\xe4kologie"},es:{title:"Obstetricia y Ginecolog\xeda"},fr:{title:"Obst\xe9trique et gyn\xe9cologie"},it:{title:"Ostetricia & Ginecologia"},ja:{title:"\u7523\u5a66\u4eba\u79d1"},pt:{title:"Obstetr\xedcia e Ginecologia"},zh:{title:"\u5987\u4ea7\u79d1"}}},{title:"Hematology & Oncology",id:"Oncology and Hematology",type:"Category",translations:{de:{title:"H\xe4matologie/Onkologie"},es:{title:"Hematolog\xeda/Oncolog\xeda"},fr:{title:"H\xe9matologie/Oncologie"},it:{title:"Ematologia/Oncologia"},ja:{title:"\u8840\u6db2\u5b66\u30fb\u816b\u760d\u5b66"},pt:{title:"Hematologia/Oncologia"},zh:{title:"\u8840\u6db2\u5b66/\u80bf\u7624\u5b66"}}},{title:"Ophthalmology",id:"Ophthalmology",type:"Category",translations:{de:{title:"Ophthalmologie"},es:{title:"Oftalmolog\xeda"},fr:{title:"Ophtalmologie"},it:{title:"Oftalmologia"},ja:{title:"\u773c\u79d1\u304b"},pt:{title:"Oftalmologia"},zh:{title:"\u773c\u79d1"}}},{title:"Orthopedics",id:"Orthopedics",type:"Category",translations:{de:{title:"Orthop\xe4die"},es:{title:"Ortopedia"},fr:{title:"Orthop\xe9die"},it:{title:"Ortopedia"},ja:{title:"\u6574\u5f62\u5916\u79d1"},pt:{title:"Ortopedia"},zh:{title:"\u6574\u5f62\u5916\u79d1"}}},{title:"Otolaryngology",id:"Otolaryngology",type:"Category",translations:{de:{title:"HNO-Heilkunde"},es:{title:"Otorrinolaringolog\xeda"},fr:{title:"Otorhinolaryngologie"},it:{title:"Otorinolaringoiatria"},ja:{title:"\u8033\u9f3b\u54bd\u5589\u79d1"},pt:{title:"Otorrinolaringologia"},zh:{title:"\u8033\u9f3b\u5589\u79d1"}}},{title:"Pediatrics",id:"Pediatrics",type:"Category",translations:{de:{title:"P\xe4diatrie"},es:{title:"Pediatr\xeda"},fr:{title:"P\xe9diatrie"},it:{title:"Pediatria"},ja:{title:"\u5c0f\u5150\u79d1"},pt:{title:"Pediatria"},zh:{title:"\u513f\u79d1"}}},{title:"Pulmonology",id:"Pulmonology and Respiratory",type:"Category",translations:{de:{title:"Pulmonologie"},es:{title:"Neumolog\xeda"},fr:{title:"Pneumologie"},it:{title:"Pneumologia"},ja:{title:"\u80ba"},pt:{title:"Pneumologia"},zh:{title:"\u547c\u5438\u5b66"}}},{title:"Rheumatology",id:"Rheumatology",type:"Category",translations:{de:{title:"Rheumatologie"},es:{title:"Reumatolog\xeda"},fr:{title:"Rhumatologie"},it:{title:"Reumatologia"},ja:{title:"\u30ea\u30a6\u30de\u30c1\u79d1"},pt:{title:"Reumatologia"},zh:{title:"\u98ce\u6e7f\u75c5\u5b66"}}},{title:"Urology",id:"Urology",type:"Category",translations:{de:{title:"Urologie"},es:{title:"Urolog\xeda"},fr:{title:"Urologie"},it:{title:"Urologia"},ja:{title:"\u6ccc\u5c3f\u5668\u79d1\u304b"},pt:{title:"Urologia"},zh:{title:"\u6ccc\u5c3f\u5916\u79d1"}}},{title:"Community Bookmarks",id:"public",type:"Community",translations:{de:{title:"Community-Lesezeichen"},es:{title:"Marcadores de la comunidad"},fr:{title:"Signets communautaires"},it:{title:"Segnalibri della community"},ja:{title:"\u30b3\u30df\u30e5\u30cb\u30c6\u30a3\u306e\u30d6\u30c3\u30af\u30de\u30fc\u30af"},pt:{title:"Favoritos da comunidade"},zh:{title:"\u793e\u533a\u4e66\u7b7e"}}}]},_w=["live"],jw=((lw=function(){function e(t){m(this,e),this.http=t}return v(e,[{key:"search",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"en",o=t.split(/[ ]+/).join("+"),r=_w.concat(n).filter((function(e){return""!==e&&null!=e})).map((function(e){return'"'.concat(e,'"')})).join("+");return this.http.get("/search?k=".concat(o,"&t=").concat(r,"&ol=").concat(i,"&odns=true")).pipe(Object(Z.a)((function(t){return e.resultsToBookmarks(t)})))}},{key:"searchInternal",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return this.http.get("/ws/search/internal?k=".concat(t,"&dir=").concat(n)).pipe(Object(Z.a)((function(t){return e.resultsToBookmarks(t)})))}},{key:"getAnatomyCategory",value:function(e,t,n,i){return this.search(e,[t].concat(c(n)),i)}},{key:"getConditionModel",value:function(e){var t=this,n=this.toDatabaseContentId(e);return this.http.get("/search/conditions?q="+n).pipe(Object(Z.a)((function(e){return t.resultsToBookmarks(e)})),Object(Z.a)((function(e){return e[0]})))}},{key:"resultsToBookmarks",value:function(e){var t=this;return e.forEach((function(e){e.id=t.toAppContentId(e.id),e.tour=e.tags.indexOf("tour")>=0})),Object(te.plainToClass)(yw,e)}},{key:"getBookmarkCategory",value:function(e){if(!e.tags)return null;var t=Sw.categories.map((function(e){return e.id.toLocaleLowerCase()}));return e.tags.find((function(e){return t.includes(e.toLocaleLowerCase())}))}},{key:"getStoryCategory",value:function(e){if(!e.tags)return null;var t=[].concat(c(Sw.main),c(Sw.categories),c(Sw.specialties)).map((function(e){return e.id.toLocaleLowerCase()}));return e.tags.find((function(e){return t.includes(e.toLocaleLowerCase())}))}},{key:"toAppContentId",value:function(e){return e.replace("Condition.content.","").replace(".json","").split(".").join("/")}},{key:"toDatabaseContentId",value:function(e){return e.match("Condition.content")?e:"Condition.content.".concat(e.replace(".json","").split("/").join("."),".json")}}]),e}()).\u0275fac=function(e){return new(e||lw)(P.Zb(K.b))},lw.\u0275prov=P.Lb({token:lw,factory:lw.\u0275fac,providedIn:"root"}),lw),Pw=function(e){return e.UserGeneratedTour="user_generated_tour",e.Animated="animated",e.Quiz="quiz",e}({}),Mw={headers:new K.d({"Content-Type":"application/json; charset=utf-8"})},Iw=function(e){return e.Private="private",e.Group="enterprise",e.Public="public",e}({}),zw=((uw=function(){function e(t,n,i,o,r){m(this,e),this.store=t,this.http=n,this.serializeModuleService=i,this.exploreService=o,this.storyService=r}return v(e,[{key:"getBookmarkData",value:function(e){return this.http.get("/search/bookmarks/data?be="+e).pipe(Object(bw.a)(2),Object(Z.a)((function(e){return(e=e.bookmark).moduleId=e.customData?e.customData.moduleId:e.modules.activeModules[0],Object(te.plainToClass)(Cw,e)})))}},{key:"getBookmarkModel",value:function(e){var t=this;return this.http.get("/ws/search/bookmarks?eid="+e).pipe(Object(bw.a)(2),Object(Z.a)((function(e){return Object(te.plainToClass)(yw,e.bookmark_info)})),Object(Z.a)((function(e){return t.normalizeBookmarkModel(e)})))}},{key:"getUserBookmarks",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return this.http.get("/ws/search/bookmarks/".concat(e,"?q=").concat(n)).pipe(Object(bw.a)(2),Object(Z.a)((function(e){return e.map((function(e){return Object(te.plainToClass)(yw,e)})).map((function(e){return t.normalizeBookmarkModel(e)}))})))}},{key:"getUserConditions",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2?arguments[2]:void 0,o="";switch(e){case Iw.Private:o="user";break;case Iw.Group:o="group"}return this.http.get("/ws/search/conditions/private?q="+n).pipe(Object(Z.a)((function(e){return e.filter((function(e){return e.module_accessor_level===o&&(!i||e.module_accessor_id===i)}))})),Object(Z.a)((function(e){return Object(te.plainToClass)(yw,e)})),Object(Z.a)((function(e){return e.map((function(e){return t.normalizeBookmarkModel(e)}))})))}},{key:"getPrivateBookmarks",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.getUserBookmarks(Iw.Private,e).pipe(Object(Z.a)((function(e){return e.filter((function(e){return e.is_owner}))})))}},{key:"getFavorites",value:function(){var e=this;return this.http.get("/ws/user/favorite").pipe(Object(Z.a)((function(t){return Object.values(t).map((function(e){return Object(te.plainToClass)(yw,e)})).map((function(t){return e.normalizeBookmarkModel(t)}))})))}},{key:"deleteFavorite",value:function(e,t){return this.http.delete("/ws/user/favorite?modelId=".concat(e,"&category=").concat(t))}},{key:"getPrivateConditions",value:function(){return this.getUserConditions(Iw.Private)}},{key:"getOrganizationBookmarks",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return this.getUserBookmarks(Iw.Private,t).pipe(Object(Z.a)((function(t){return t.filter((function(e){return e.tags.includes("enterprise")})).filter((function(t){return t.group_access.some((function(t){return t.group_id===e}))}))})))}},{key:"getOrganizationConditions",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return this.getUserConditions(Iw.Group,t,e)}},{key:"getOrganizationContent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return Object(Qa.a)(this.getOrganizationBookmarks(e,t),this.getOrganizationConditions(e,t)).pipe(Object(Z.a)((function(e){var t=p(e,2),n=t[0],i=t[1];return[].concat(c(n),c(i))})))}},{key:"createBookmarkStory",value:function(e){return this.serializeModuleService.serialize({},new Ts,!1,this.store.selectSnapshot(Hs.getStory),this.store.selectSnapshot(Lr.getStoryChapters),e)}},{key:"getPublicBookmarks",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.getUserBookmarks(Iw.Public,e)}},{key:"saveBookmark",value:function(e){var t=this,n=this.getNormalizedBookmarkEntry(e);return this.http.post(e.id?"/ws/user/bookmark/v1/update":"/ws/user/bookmark/v1/save",n,Mw).pipe(Object(rr.a)((function(e){return t.getBookmarkModel(e.id)})))}},{key:"deleteBookmark",value:function(e){return this.http.delete("/ws/user/bookmark/v1/delete?eid="+e).pipe(Object(J.a)((function(e){var t=e.error.error,n=t?t.message:"";return Object(Nr.a)(n)})))}},{key:"copyBookmark",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"en";return t!==I.Module||Object(Se.endsWith)(e,".json")||(e+=".json"),this.http.post("/ws/user/bookmark/v1/copy",{source_content_type:t,source_content_id:e}).pipe(Object(Z.a)((function(e){return e.id})),Object(rr.a)((function(o){return"en"===i?Object(G.a)(o):n.translateBookmark(o,e,t,i)})))}},{key:"atMaxFreeBookmarkCount",value:function(){return this.http.get("/ws/user/content/limit/check").pipe(Object(Z.a)((function(){return!1})),Object(J.a)((function(e){return Object(G.a)(403===e.status)})))}},{key:"saveBookmarkThumbnails",value:function(e,t,n,i){var o=this,r=t.index.chapters.reduce((function(t,r){var a=n.get(i[r.id]),s=Object(Se.get)(a,"snapshot");if(s)t.push(o.postThumbnail(e,r.id,s,!0));else if(r.id!==i[r.id]||a.chapterId!==r.id){var c=Object(Se.get)(a,"urls.large");if(c){var l=c.match(/(bookmarks\/)|(modules\/)/).index,u=c.slice(l);t.push(o.copyThumbnail(e,r.id,u))}}return t}),[]),a=n.get(i[t.index.chapters[0].id]),s=Object(Se.get)(a,"snapshot");if(s)r.push(this.postThumbnail(e,null,s,!0));else{var c=Object(Se.get)(a,"urls.large");c&&r.push(this.copyThumbnail(e,null,c))}return r}},{key:"deleteBookmarkThumbnails",value:function(e,t,n,i){var o=this,r=t.index.chapters.map((function(e){return i[e.id]||e.id}));return Array.from(n.values()).filter((function(e){return r.indexOf(e.chapterId)<0})).map((function(t){return o.deleteThumbnail(e,t.chapterId)}))}},{key:"filterByTags",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e.filter((function(e){return n?t.every((function(t){return e.tags.includes(t)})):t.some((function(t){return e.tags.includes(t)}))}))}},{key:"normalizeBookmarkModel",value:function(e){var t=e.id;return"module"===e.type&&(e.id=this.exploreService.toAppContentId(t)),e.tour=e.tags.includes("tour"),e.animated=e.tags.includes("animated"),e}},{key:"getIndexThumbnail",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"large";return"/thumbs/bookmarks/".concat(e,"/").concat(t,"/index.jpg")}},{key:"translateBookmark",value:function(e,t,n,i){var o=this,r=n===I.Module||n===I.Internal?t.replace(".json",""):t;return Object(Qa.a)(this.storyService.getStory(e,I.Bookmark),this.storyService.getStoryTranslation(r,n,i)).pipe(Object(Z.a)((function(e){var t=p(e,2),n=t[0],i=t[1];return o.storyService.translateStory(n,i)})),Object(rr.a)((function(t){return o.saveBookmark({isOwner:!0,title:t.displayName.substr(0,60),id:e,index:t})})),Object(Z.a)((function(e){return e.id})),Object(J.a)((function(t){return 404===t.status?Object(G.a)(e):Object(Nr.a)(t)})))}},{key:"getNormalizedBookmarkEntry",value:function(e){var t,n,i,o=this,r=e.id,a=e.title,s=e.description,c=e.index,l=e.public_access,u=e.add_group_access,p=e.remove_group_access;if(e.isOwner&&(t=u?this.getGroupAccess(u):[],p&&p.forEach((function(e){var n=o.getNormalizeGroupAccess({group_id:e.group_id,remove:!0});t.push(n)})),n=this.getNormalizedBool(l),c)){i={},c.chapters&&(i[Pw.UserGeneratedTour]=this.getNormalizedBool(c.chapters.length>1));var d=(c.tags||[]).includes("animated");i[Pw.Animated]=this.getNormalizedBool(d);var g=Object(Se.get)(c,"quizSettings.enabled",!1);i[Pw.Quiz]=this.getNormalizedBool(g)}return{eid:r,name:a,description:s,index:c,group_access:t,public_access:n,flags:i}}},{key:"getGroupAccess",value:function(e){var t=this;return e.map((function(e){return t.getNormalizeGroupAccess(e)}))}},{key:"getNormalizeGroupAccess",value:function(e){var t=e.group_id,n=e.group_name,i=e.member_edit,o=e.visible,r=e.remove;return{group_id:t,group_name:n,member_edit:this.getNormalizedBool(i),visibility:this.getNormalizedBool(o),remove:this.getNormalizedBool(r)}}},{key:"getNormalizedBool",value:function(e){return!0===e?"1":!1===e?"0":""}},{key:"postThumbnail",value:function(e,t,n){var i=this,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=new Image;return r.src=n,new be.a((function(n){r.onload=function(){var a=document.createElement("canvas"),s=a.getContext("2d");a.width=r.naturalWidth,a.height=r.naturalHeight,s.drawImage(r,0,0);var c,l=a.toDataURL("image/jpeg",1);c=t?"/ws/thumbs/bookmarks/".concat(e,"/large/chapters/").concat(t,".jpg"):"/ws/thumbs/bookmarks/".concat(e,"/large/index.jpg");var u=(new K.d).set("Content-Type","application/json");i.http.post(c,{image:l,invalidate:o},{headers:u,responseType:"text"}).subscribe((function(e){n.next(),n.complete()}))}}))}},{key:"deleteThumbnail",value:function(e,t){return new be.a((function(n){var i=new Request("/ws/thumbs/bookmarks/".concat(e,"/large/chapters/").concat(t,".jpg"),{method:"DELETE"});fetch(i).then((function(e){n.complete()}))}))}},{key:"copyThumbnail",value:function(e,t,n){var i,o=this,r=n.replace("/thumbs/","");i=t?"bookmarks/".concat(e,"/large/chapters/").concat(t,".jpg"):"bookmarks/".concat(e,"/large/index.jpg");var a=(new K.d).set("Content-Type","application/json");return new be.a((function(e){o.http.post("/ws/thumbs/copy",{src:r,dst:i},{headers:a,responseType:"text"}).subscribe((function(t){e.next(),e.complete()}))}))}}]),e}()).\u0275fac=function(e){return new(e||uw)(P.Zb(E.g),P.Zb(K.b),P.Zb(zs),P.Zb(jw),P.Zb(ns))},uw.\u0275prov=P.Lb({token:uw,factory:uw.\u0275fac,providedIn:"root"}),uw),Tw="/ws/thumbs",Uw={headers:(new K.d).set("Content-Type","application/json"),responseType:"text"},Lw=((gw=function(){function e(t){m(this,e),this.http=t}return v(e,[{key:"getStoryIndexThumbnail",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"large";return"".concat("undefined"==typeof localBaseDirectory?"":localBaseDirectory,"thumbs/modules/").concat(e,"/").concat(t,"/index.jpg")}},{key:"saveStoryThumbnails",value:function(e){var t=this,n=e.storyId,i=e.storyType,o=e.thumbnails,r=e.chapterIdMap,a=e.indexId,s=e.deleteUnused,c=void 0!==s&&s,l=[],u={};return Object.entries(r).forEach((function(e){var r=p(e,2),s=r[0],c=r[1],d=o.get(c);u[c]=!0;var g=t.createThumbnailPath(i,n,s);if(Object(Se.get)(d,"snapshot")){if(l.push(t.postThumbnail(d.snapshot,g)),s===a){var h=t.createThumbnailPath(i,n);l.push(t.postThumbnail(d.snapshot,h))}}else{var f=Object(Se.get)(d,"urls.large");if(f){var b=f.split("/thumbs/")[1];if(l.push(t.copyThumbnail(b,g)),s===a){var v=t.createThumbnailPath(i,n);l.push(t.copyThumbnail(b,v))}}}})),c&&Object.keys(o).filter((function(e){return!(e in u)})).forEach((function(e){var n=o.get(e).urls.large.split("/thumbs/")[1];l.push(t.deleteThumbnail(n))})),l}},{key:"createThumbnailPath",value:function(e,t,n){var i=(t=t.replace(".json",""))+"/large";return n?i="".concat(i,"/chapters/").concat(n,".jpg"):i+="/index.jpg",[e===I.Bookmark?"bookmarks":"modules",i].join("/")}},{key:"postThumbnail",value:function(e,t){var n=this,i=yr.medium,o=i.width,r=i.height,a=new Image,s=document.createElement("canvas");s.width=o,s.height=r;var c=s.getContext("2d");return a.src=e,new be.a((function(e){a.onerror=function(){e.next(),e.complete()},a.onload=function(){c.drawImage(a,0,0);var i=s.toDataURL("image/jpeg",1),o=[Tw,t].join("/");n.http.post(o,{image:i},Uw).subscribe((function(){e.next(),e.complete()}))}}))}},{key:"deleteThumbnail",value:function(e){var t=[Tw,e].join("/");return new be.a((function(e){var n=new Request(t,{method:"DELETE"});fetch(n).finally((function(){e.next(),e.complete()}))}))}},{key:"copyThumbnail",value:function(e,t){var n=this;return new be.a((function(i){n.http.post("/ws/thumbs/copy",{src:e,dst:t},Uw).subscribe((function(e){i.next(),i.complete()}))}))}}]),e}()).\u0275fac=function(e){return new(e||gw)(P.Zb(K.b))},gw.\u0275prov=P.Lb({token:gw,factory:gw.\u0275fac,providedIn:"root"}),gw),Dw=((dw=function(){function e(){m(this,e)}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||dw)},dw.\u0275cmp=P.Jb({type:dw,selectors:[["app-button-loader"]],decls:5,vars:0,consts:[["tabindex","0","type","button","aria-label","Interact in 3D","type","button",1,"button-loader"],[1,"button-loader__button"],["src","assets/images/widget/loading_experience/interact-in-3d-arrow.svg","alt","Interact in 3D",1,"button-loader__3d-arrow"],[1,"button-loader__label"]],template:function(e,t){1&e&&(P.Vb(0,"button",0),P.Vb(1,"div",1),P.Qb(2,"img",2),P.Vb(3,"div",3),P.Mc(4,"Interact in 3D"),P.Ub(),P.Ub(),P.Ub())},styles:[".m-1[_ngcontent-%COMP%]{margin:4px!important}.mv-1[_ngcontent-%COMP%]{margin-top:4px!important;margin-bottom:4px!important}.mh-1[_ngcontent-%COMP%]{margin-left:4px!important;margin-right:4px!important}.mt-1[_ngcontent-%COMP%]{margin-top:4px!important}.mr-1[_ngcontent-%COMP%]{margin-right:4px!important}.mb-1[_ngcontent-%COMP%]{margin-bottom:4px!important}.ml-1[_ngcontent-%COMP%]{margin-left:4px!important}.p-1[_ngcontent-%COMP%]{padding:4px!important}.pv-1[_ngcontent-%COMP%]{padding-top:4px!important;padding-bottom:4px!important}.ph-1[_ngcontent-%COMP%]{padding-left:4px!important;padding-right:4px!important}.pt-1[_ngcontent-%COMP%]{padding-top:4px!important}.pr-1[_ngcontent-%COMP%]{padding-right:4px!important}.pb-1[_ngcontent-%COMP%]{padding-bottom:4px!important}.pl-1[_ngcontent-%COMP%]{padding-left:4px!important}.m-2[_ngcontent-%COMP%]{margin:8px!important}.mv-2[_ngcontent-%COMP%]{margin-top:8px!important;margin-bottom:8px!important}.mh-2[_ngcontent-%COMP%]{margin-left:8px!important;margin-right:8px!important}.mt-2[_ngcontent-%COMP%]{margin-top:8px!important}.mr-2[_ngcontent-%COMP%]{margin-right:8px!important}.mb-2[_ngcontent-%COMP%]{margin-bottom:8px!important}.ml-2[_ngcontent-%COMP%]{margin-left:8px!important}.p-2[_ngcontent-%COMP%]{padding:8px!important}.pv-2[_ngcontent-%COMP%]{padding-top:8px!important;padding-bottom:8px!important}.ph-2[_ngcontent-%COMP%]{padding-left:8px!important;padding-right:8px!important}.pt-2[_ngcontent-%COMP%]{padding-top:8px!important}.pr-2[_ngcontent-%COMP%]{padding-right:8px!important}.pb-2[_ngcontent-%COMP%]{padding-bottom:8px!important}.pl-2[_ngcontent-%COMP%]{padding-left:8px!important}.m-3[_ngcontent-%COMP%]{margin:12px!important}.mv-3[_ngcontent-%COMP%]{margin-top:12px!important;margin-bottom:12px!important}.mh-3[_ngcontent-%COMP%]{margin-left:12px!important;margin-right:12px!important}.mt-3[_ngcontent-%COMP%]{margin-top:12px!important}.mr-3[_ngcontent-%COMP%]{margin-right:12px!important}.mb-3[_ngcontent-%COMP%]{margin-bottom:12px!important}.ml-3[_ngcontent-%COMP%]{margin-left:12px!important}.p-3[_ngcontent-%COMP%]{padding:12px!important}.pv-3[_ngcontent-%COMP%]{padding-top:12px!important;padding-bottom:12px!important}.ph-3[_ngcontent-%COMP%]{padding-left:12px!important;padding-right:12px!important}.pt-3[_ngcontent-%COMP%]{padding-top:12px!important}.pr-3[_ngcontent-%COMP%]{padding-right:12px!important}.pb-3[_ngcontent-%COMP%]{padding-bottom:12px!important}.pl-3[_ngcontent-%COMP%]{padding-left:12px!important}.m-4[_ngcontent-%COMP%]{margin:16px!important}.mv-4[_ngcontent-%COMP%]{margin-top:16px!important;margin-bottom:16px!important}.mh-4[_ngcontent-%COMP%]{margin-left:16px!important;margin-right:16px!important}.mt-4[_ngcontent-%COMP%]{margin-top:16px!important}.mr-4[_ngcontent-%COMP%]{margin-right:16px!important}.mb-4[_ngcontent-%COMP%]{margin-bottom:16px!important}.ml-4[_ngcontent-%COMP%]{margin-left:16px!important}.p-4[_ngcontent-%COMP%]{padding:16px!important}.pv-4[_ngcontent-%COMP%]{padding-top:16px!important;padding-bottom:16px!important}.ph-4[_ngcontent-%COMP%]{padding-left:16px!important;padding-right:16px!important}.pt-4[_ngcontent-%COMP%]{padding-top:16px!important}.pr-4[_ngcontent-%COMP%]{padding-right:16px!important}.pb-4[_ngcontent-%COMP%]{padding-bottom:16px!important}.pl-4[_ngcontent-%COMP%]{padding-left:16px!important}.m-5[_ngcontent-%COMP%]{margin:20px!important}.mv-5[_ngcontent-%COMP%]{margin-top:20px!important;margin-bottom:20px!important}.mh-5[_ngcontent-%COMP%]{margin-left:20px!important;margin-right:20px!important}.mt-5[_ngcontent-%COMP%]{margin-top:20px!important}.mr-5[_ngcontent-%COMP%]{margin-right:20px!important}.mb-5[_ngcontent-%COMP%]{margin-bottom:20px!important}.ml-5[_ngcontent-%COMP%]{margin-left:20px!important}.p-5[_ngcontent-%COMP%]{padding:20px!important}.pv-5[_ngcontent-%COMP%]{padding-top:20px!important;padding-bottom:20px!important}.ph-5[_ngcontent-%COMP%]{padding-left:20px!important;padding-right:20px!important}.pt-5[_ngcontent-%COMP%]{padding-top:20px!important}.pr-5[_ngcontent-%COMP%]{padding-right:20px!important}.pb-5[_ngcontent-%COMP%]{padding-bottom:20px!important}.pl-5[_ngcontent-%COMP%]{padding-left:20px!important}.m-6[_ngcontent-%COMP%]{margin:24px!important}.mv-6[_ngcontent-%COMP%]{margin-top:24px!important;margin-bottom:24px!important}.mh-6[_ngcontent-%COMP%]{margin-left:24px!important;margin-right:24px!important}.mt-6[_ngcontent-%COMP%]{margin-top:24px!important}.mr-6[_ngcontent-%COMP%]{margin-right:24px!important}.mb-6[_ngcontent-%COMP%]{margin-bottom:24px!important}.ml-6[_ngcontent-%COMP%]{margin-left:24px!important}.p-6[_ngcontent-%COMP%]{padding:24px!important}.pv-6[_ngcontent-%COMP%]{padding-top:24px!important;padding-bottom:24px!important}.ph-6[_ngcontent-%COMP%]{padding-left:24px!important;padding-right:24px!important}.pt-6[_ngcontent-%COMP%]{padding-top:24px!important}.pr-6[_ngcontent-%COMP%]{padding-right:24px!important}.pb-6[_ngcontent-%COMP%]{padding-bottom:24px!important}.pl-6[_ngcontent-%COMP%]{padding-left:24px!important}.m-7[_ngcontent-%COMP%]{margin:28px!important}.mv-7[_ngcontent-%COMP%]{margin-top:28px!important;margin-bottom:28px!important}.mh-7[_ngcontent-%COMP%]{margin-left:28px!important;margin-right:28px!important}.mt-7[_ngcontent-%COMP%]{margin-top:28px!important}.mr-7[_ngcontent-%COMP%]{margin-right:28px!important}.mb-7[_ngcontent-%COMP%]{margin-bottom:28px!important}.ml-7[_ngcontent-%COMP%]{margin-left:28px!important}.p-7[_ngcontent-%COMP%]{padding:28px!important}.pv-7[_ngcontent-%COMP%]{padding-top:28px!important;padding-bottom:28px!important}.ph-7[_ngcontent-%COMP%]{padding-left:28px!important;padding-right:28px!important}.pt-7[_ngcontent-%COMP%]{padding-top:28px!important}.pr-7[_ngcontent-%COMP%]{padding-right:28px!important}.pb-7[_ngcontent-%COMP%]{padding-bottom:28px!important}.pl-7[_ngcontent-%COMP%]{padding-left:28px!important}.m-8[_ngcontent-%COMP%]{margin:32px!important}.mv-8[_ngcontent-%COMP%]{margin-top:32px!important;margin-bottom:32px!important}.mh-8[_ngcontent-%COMP%]{margin-left:32px!important;margin-right:32px!important}.mt-8[_ngcontent-%COMP%]{margin-top:32px!important}.mr-8[_ngcontent-%COMP%]{margin-right:32px!important}.mb-8[_ngcontent-%COMP%]{margin-bottom:32px!important}.ml-8[_ngcontent-%COMP%]{margin-left:32px!important}.p-8[_ngcontent-%COMP%]{padding:32px!important}.pv-8[_ngcontent-%COMP%]{padding-top:32px!important;padding-bottom:32px!important}.ph-8[_ngcontent-%COMP%]{padding-left:32px!important;padding-right:32px!important}.pt-8[_ngcontent-%COMP%]{padding-top:32px!important}.pr-8[_ngcontent-%COMP%]{padding-right:32px!important}.pb-8[_ngcontent-%COMP%]{padding-bottom:32px!important}.pl-8[_ngcontent-%COMP%]{padding-left:32px!important}.m-9[_ngcontent-%COMP%]{margin:36px!important}.mv-9[_ngcontent-%COMP%]{margin-top:36px!important;margin-bottom:36px!important}.mh-9[_ngcontent-%COMP%]{margin-left:36px!important;margin-right:36px!important}.mt-9[_ngcontent-%COMP%]{margin-top:36px!important}.mr-9[_ngcontent-%COMP%]{margin-right:36px!important}.mb-9[_ngcontent-%COMP%]{margin-bottom:36px!important}.ml-9[_ngcontent-%COMP%]{margin-left:36px!important}.p-9[_ngcontent-%COMP%]{padding:36px!important}.pv-9[_ngcontent-%COMP%]{padding-top:36px!important;padding-bottom:36px!important}.ph-9[_ngcontent-%COMP%]{padding-left:36px!important;padding-right:36px!important}.pt-9[_ngcontent-%COMP%]{padding-top:36px!important}.pr-9[_ngcontent-%COMP%]{padding-right:36px!important}.pb-9[_ngcontent-%COMP%]{padding-bottom:36px!important}.pl-9[_ngcontent-%COMP%]{padding-left:36px!important}.m-10[_ngcontent-%COMP%]{margin:40px!important}.mv-10[_ngcontent-%COMP%]{margin-top:40px!important;margin-bottom:40px!important}.mh-10[_ngcontent-%COMP%]{margin-left:40px!important;margin-right:40px!important}.mt-10[_ngcontent-%COMP%]{margin-top:40px!important}.mr-10[_ngcontent-%COMP%]{margin-right:40px!important}.mb-10[_ngcontent-%COMP%]{margin-bottom:40px!important}.ml-10[_ngcontent-%COMP%]{margin-left:40px!important}.p-10[_ngcontent-%COMP%]{padding:40px!important}.pv-10[_ngcontent-%COMP%]{padding-top:40px!important;padding-bottom:40px!important}.ph-10[_ngcontent-%COMP%]{padding-left:40px!important;padding-right:40px!important}.pt-10[_ngcontent-%COMP%]{padding-top:40px!important}.pr-10[_ngcontent-%COMP%]{padding-right:40px!important}.pb-10[_ngcontent-%COMP%]{padding-bottom:40px!important}.pl-10[_ngcontent-%COMP%]{padding-left:40px!important}.text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3838}.text-info[_ngcontent-%COMP%]{color:#0060c4}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.button-loader[_ngcontent-%COMP%]{border:0;width:100%;background:rgba(0,0,0,.2);display:flex;position:fixed;justify-content:center;align-items:center;top:0;bottom:0;left:0;right:0;transition:background-color .25s,opacity .25s;z-index:10000}.button-loader[_ngcontent-%COMP%]:hover{opacity:1;cursor:pointer;background:var(--view-loader-scrim-bg--hover)}@media print{.button-loader[_ngcontent-%COMP%]{display:none}}.button-loader[_ngcontent-%COMP%]:focus   .button-loader__button[_ngcontent-%COMP%], .button-loader[_ngcontent-%COMP%]:hover   .button-loader__button[_ngcontent-%COMP%]{background-color:var(--view-loader-icon-color--hover);transform:scale(1.1)}.button-loader[_ngcontent-%COMP%]:focus   .button-loader__3d-arrow[_ngcontent-%COMP%], .button-loader[_ngcontent-%COMP%]:hover   .button-loader__3d-arrow[_ngcontent-%COMP%]{transform:scale(1.2)}.button-loader__button[_ngcontent-%COMP%]{display:flex;padding:12px 28px;border-radius:32px;align-items:center;transition:transform .25s,background-color .25s;background-color:var(--view-loader-button-bg)}.button-loader__3d-arrow[_ngcontent-%COMP%]{transition:transform .25s;margin-right:4px}.button-loader__label[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em;color:#fff;font-weight:600;margin-left:4px}"],changeDetection:0}),dw),Ew=((pw=function(){function e(t,n,i){m(this,e),this.viewService=t,this.modulesThumbnailService=n,this.bookmarksService=i}return v(e,[{key:"ngOnInit",value:function(){}},{key:"handleClick",value:function(){this.viewService.toggleOnDemand(!1)}},{key:"getThumbnailUrl",value:function(){return this.contentType===I.Bookmark?this.bookmarksService.getIndexThumbnail(this.contentId):this.modulesThumbnailService.getStoryIndexThumbnail(this.contentId)}},{key:"getPoweredByUrl",value:function(){return("undefined"==typeof localBaseDirectory?"":localBaseDirectory)+"assets/images/powered-by-biodigital-logo.svg"}}]),e}()).\u0275fac=function(e){return new(e||pw)(P.Pb(td),P.Pb(Lw),P.Pb(zw))},pw.\u0275cmp=P.Jb({type:pw,selectors:[["app-view-ondemand"]],inputs:{contentId:"contentId",contentType:"contentType"},decls:5,vars:2,consts:[[1,"ondemand",3,"click"],[1,"ondemand__image",3,"lazyLoad"],[1,"ondemand__logo"],[3,"src"]],template:function(e,t){1&e&&(P.Vb(0,"div",0),P.cc("click",(function(){return t.handleClick()})),P.Qb(1,"div",1),P.Qb(2,"app-button-loader"),P.Vb(3,"div",2),P.Qb(4,"img",3),P.Ub(),P.Ub()),2&e&&(P.Db(1),P.lc("lazyLoad",t.getThumbnailUrl()),P.Db(3),P.lc("src",t.getPoweredByUrl(),P.Cc))},directives:[yf.a,Dw],styles:[".ondemand__image[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;left:0;right:0;background-size:cover;background-repeat:no-repeat;background-position:50%}.ondemand__logo[_ngcontent-%COMP%]{position:absolute;bottom:40px;justify-content:center;width:100%;z-index:20000;display:flex}"],changeDetection:0}),pw),Fw=["circle"],Aw=["progressCircle"],Rw=["progressContainer"];function Vw(e,t){if(1&e&&(P.fc(),P.ec(),P.Vb(0,"div",9),P.Mc(1),P.Ub()),2&e){var n=P.gc();P.Db(1),P.Oc(" ",n.percent,"% ")}}var Nw,Bw,Hw,Qw,qw=function(e){return{"view-progress--active":e}},Ww=function(e){return{"view-progress__ring--pulse":e}},$w=((Nw=function(){function e(t,n){m(this,e),this.renderer=t,this.changeDetectorRef=n,this.ngUnsubscribe=new fe.a,this.label="Loading...",this._show=!1,this._percent=new $r.a(0)}return v(e,[{key:"show",get:function(){return this._show},set:function(e){var t=this;setTimeout((function(){t._show=e,t.changeDetectorRef.markForCheck()}))}},{key:"percent",get:function(){return Math.floor(this._percent.value)},set:function(e){null!=e&&this._percent.next(e)}},{key:"ngOnInit",value:function(){this.initSizeObserver()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"ngAfterViewInit",value:function(){this.updateDimensions(),this.initPercentObserver()}},{key:"initPercentObserver",value:function(){var e=this;this._percent.pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(){e.label=e.getLoadingLabel(e.percent),e.renderProgress(0===e.percent?100:e.percent),e.changeDetectorRef.markForCheck()}))}},{key:"initSizeObserver",value:function(){var e=this;Object(Zr.a)(window,"resize").pipe(Object(Jr.a)(10),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(){e.updateDimensions()}))}},{key:"calculateRadius",value:function(){return this.getCircleWidth()/2}},{key:"getCircleWidth",value:function(){return this.circleRef.nativeElement.offsetWidth}},{key:"getRadius",value:function(){return this.progressCircleRef.nativeElement.r.baseVal.value}},{key:"getCircumference",value:function(){return 2*this.getRadius()*Math.PI}},{key:"getOffset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,t=this.getCircumference();return t-e/100*t}},{key:"renderProgress",value:function(e){e>=100&&(e=100);var t=this.getCircumference(),n=this.getOffset(e);this.renderer.setStyle(this.progressCircleRef.nativeElement,"strokeDasharray","".concat(t," ").concat(t)),this.renderer.setStyle(this.progressCircleRef.nativeElement,"strokeDashoffset",""+n)}},{key:"getLoadingLabel",value:function(e){return 100===e?"Launching...":"Loading..."}},{key:"updateDimensions",value:function(){var e=this.calculateRadius();this.renderer.setAttribute(this.progressContainerRef.nativeElement,"width",""+2*e),this.renderer.setAttribute(this.progressContainerRef.nativeElement,"height",""+2*e),this.renderer.setAttribute(this.progressCircleRef.nativeElement,"r",""+(e-6)),this.renderer.setAttribute(this.progressCircleRef.nativeElement,"cx",""+e),this.renderer.setAttribute(this.progressCircleRef.nativeElement,"cy",""+e);var t=this.getCircumference();this.renderer.setStyle(this.progressCircleRef.nativeElement,"strokeDasharray","".concat(t," ").concat(t)),this.renderer.setStyle(this.progressCircleRef.nativeElement,"strokeDashoffset",""+t)}}]),e}()).\u0275fac=function(e){return new(e||Nw)(P.Pb(P.H),P.Pb(P.i))},Nw.\u0275cmp=P.Jb({type:Nw,selectors:[["app-view-progress"]],viewQuery:function(e,t){var n;1&e&&(P.Gc(Fw,!0),P.Gc(Aw,!0),P.Gc(Rw,!0)),2&e&&(P.uc(n=P.dc())&&(t.circleRef=n.first),P.uc(n=P.dc())&&(t.progressCircleRef=n.first),P.uc(n=P.dc())&&(t.progressContainerRef=n.first))},inputs:{show:"show",percent:"percent"},decls:10,vars:9,consts:[["data-test","viewProgress",1,"view-progress",3,"ngClass"],[1,"view-progress__circle"],["circle",""],[1,"view-progress__ring",3,"ngClass"],["progressContainer",""],[1,"view-progress__ring-inner"],["progressCircle",""],["class","view-progress__count",4,"ngIf"],[1,"view-progress__label"],[1,"view-progress__count"]],template:function(e,t){1&e&&(P.Vb(0,"div",0),P.Vb(1,"div",1,2),P.fc(),P.Vb(3,"svg",3,4),P.Qb(5,"circle",5,6),P.Ub(),P.Kc(7,Vw,2,1,"div",7),P.ec(),P.Vb(8,"div",8),P.Mc(9),P.Ub(),P.Ub(),P.Ub()),2&e&&(P.lc("ngClass",P.oc(5,qw,t.show)),P.Db(1),P.lc("@isOpen",t.show?"open":"closed"),P.Db(2),P.lc("ngClass",P.oc(7,Ww,0===t.percent||100===t.percent)),P.Db(4),P.lc("ngIf",t.percent>0&&t.percent<100),P.Db(2),P.Oc(" ",t.label," "))},directives:[ra.i,ra.l],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3838}.text-info[_ngcontent-%COMP%]{color:#0060c4}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.view-progress[_ngcontent-%COMP%]{--circleSize:35vw;pointer-events:none;position:absolute;display:flex;justify-content:center;align-items:center;left:0;right:0;top:0;bottom:0;z-index:1000;transition:background-color .15s}@-webkit-keyframes progressPulse{0%{stroke-width:4}50%{stroke-width:1}to{stroke-width:4}}@keyframes progressPulse{0%{stroke-width:4}50%{stroke-width:1}to{stroke-width:4}}.view-progress--active[_ngcontent-%COMP%]{background-color:rgba(0,0,0,.2)}.view-progress__circle[_ngcontent-%COMP%]{transform:scale(0);width:var(--circleSize);height:var(--circleSize);border-radius:50%;background-color:var(--view-progress-bg);display:flex;flex-direction:column;align-items:center;justify-content:center;position:relative}.view-progress__count[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em;color:var(--view-progress-primary-color);font-weight:700}.view-progress__label[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em;color:var(--view-progress-secondary-color)}.view-progress__ring[_ngcontent-%COMP%]{position:absolute;top:0;right:0;bottom:0;left:0;z-index:3;opacity:1;stroke-dashoffset:0;stroke-width:4;stroke:var(--view-progress-secondary-color);fill:transparent;transform:rotate(-90deg)}.view-progress__ring--pulse[_ngcontent-%COMP%]{-webkit-animation:progressPulse 2s ease-in-out infinite;animation:progressPulse 2s ease-in-out infinite}@media (min-width:600px){.view-progress__circle[_ngcontent-%COMP%]{width:160px;height:160px}}"],data:{animation:[Object(wu.n)("isOpen",[Object(wu.k)("open",Object(wu.l)({transform:"scale(1)"})),Object(wu.k)("closed",Object(wu.l)({transform:"scale(0)"})),Object(wu.m)("closed => open",[Object(wu.e)("300ms ease-out")]),Object(wu.m)("open => closed",[Object(wu.e)("150ms ease-in")])])]},changeDetection:0}),Nw),Kw=["viewLoader"],Gw=["*"],Zw=((Bw=function(){function e(t,n,i){m(this,e),this.renderer=t,this.viewService=n,this.actions=i,this.ngUnsubscribe=new fe.a}return v(e,[{key:"handleClick",value:function(){var e=this;this.renderer.addClass(this.viewLoaderRef.nativeElement,"view-loader--disappear"),setTimeout((function(){e.viewService.toggleInteract(!1)}),250)}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}}]),e}()).\u0275fac=function(e){return new(e||Bw)(P.Pb(P.H),P.Pb(td),P.Pb(E.b))},Bw.\u0275cmp=P.Jb({type:Bw,selectors:[["app-view-loader"]],viewQuery:function(e,t){var n;1&e&&P.Gc(Kw,!0),2&e&&P.uc(n=P.dc())&&(t.viewLoaderRef=n.first)},ngContentSelectors:Gw,decls:4,vars:0,consts:[["role","dialog",1,"view-loader"],["viewLoader",""],["role","button",3,"click"]],template:function(e,t){1&e&&(P.kc(),P.Vb(0,"div",0,1),P.Vb(2,"div",2),P.cc("click",(function(){return t.handleClick()})),P.jc(3),P.Ub(),P.Ub())},styles:[""],encapsulation:2,changeDetection:0}),Bw),Jw=["circle"],Xw=["progressCircle"],Yw=["progressContainer"],eO=((Qw=function(){function e(t){m(this,e),this.renderer=t,this.ngUnsubscribe=new fe.a,this._percent=0}return v(e,[{key:"percent",get:function(){return this._percent},set:function(e){null!=e&&(this._percent=e,this.setProgress(this.percent))}},{key:"ngOnInit",value:function(){this.initSizeObserver()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"ngAfterViewInit",value:function(){this.updateDimensions()}},{key:"initSizeObserver",value:function(){var e=this;Object(Zr.a)(window,"resize").pipe(Object(Jr.a)(10),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(){e.updateDimensions()}))}},{key:"calculateRadius",value:function(){return this.getCircleWidth()/2}},{key:"getCircleWidth",value:function(){return this.circleRef.nativeElement.offsetWidth}},{key:"getRadius",value:function(){return this.progressCircleRef.nativeElement.r.baseVal.value}},{key:"getCircumference",value:function(){return 2*this.getRadius()*Math.PI}},{key:"getOffset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,t=this.getCircumference();return t-e/100*t}},{key:"setProgress",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;e>=100&&(e=100);var t=this.getCircumference(),n=this.getOffset(e);this.renderer.setStyle(this.progressCircleRef.nativeElement,"strokeDasharray","".concat(t," ").concat(t)),this.renderer.setStyle(this.progressCircleRef.nativeElement,"strokeDashoffset",""+n)}},{key:"updateDimensions",value:function(){var e=this,t=this.calculateRadius();this.renderer.setAttribute(this.progressContainerRef.nativeElement,"width",""+2*t),this.renderer.setAttribute(this.progressContainerRef.nativeElement,"height",""+2*t),this.renderer.setAttribute(this.progressCircleRef.nativeElement,"r",""+(t-6)),this.renderer.setAttribute(this.progressCircleRef.nativeElement,"cx",""+t),this.renderer.setAttribute(this.progressCircleRef.nativeElement,"cy",""+t);var n=this.getCircumference();this.renderer.setStyle(this.progressCircleRef.nativeElement,"strokeDasharray","".concat(n," ").concat(n)),this.renderer.setStyle(this.progressCircleRef.nativeElement,"strokeDashoffset",""+n),setTimeout((function(){e.renderer.setStyle(e.progressCircleRef.nativeElement,"transition","stroke-dashoffset 300ms")}))}}]),e}()).\u0275fac=function(e){return new(e||Qw)(P.Pb(P.H))},Qw.\u0275cmp=P.Jb({type:Qw,selectors:[["app-play-loader"]],viewQuery:function(e,t){var n;1&e&&(P.Gc(Jw,!0),P.Gc(Xw,!0),P.Gc(Yw,!0)),2&e&&(P.uc(n=P.dc())&&(t.circleRef=n.first),P.uc(n=P.dc())&&(t.progressCircleRef=n.first),P.uc(n=P.dc())&&(t.progressContainerRef=n.first))},inputs:{percent:"percent"},decls:10,vars:0,consts:[["tabindex","0","type","button","aria-label","Interact in 3D",1,"play-loader"],[1,"play-loader__circle"],["circle",""],[1,"play-loader__ring"],["progressContainer",""],[1,"play-loader__ring-inner"],["progressCircle",""],["icon","play",1,"play-loader__icon"],[1,"play-loader__label"]],template:function(e,t){1&e&&(P.Vb(0,"button",0),P.Vb(1,"div",1,2),P.fc(),P.Vb(3,"svg",3,4),P.Qb(5,"circle",5,6),P.Ub(),P.ec(),P.Qb(7,"app-icon",7),P.Vb(8,"div",8),P.Mc(9,"3D"),P.Ub(),P.Ub(),P.Ub())},directives:[nl],styles:[".play-loader[_ngcontent-%COMP%]{--buttonSize:35vw;border:0;width:100%;background:rgba(0,0,0,.2);display:flex;position:fixed;justify-content:center;align-items:center;top:0;bottom:0;left:0;right:0;transition:background-color .25s,opacity .25s;z-index:10000}.play-loader[_ngcontent-%COMP%]:hover{opacity:1;cursor:pointer;background:var(--view-loader-scrim-bg--hover)}.play-loader[_ngcontent-%COMP%]:focus   .play-loader__circle[_ngcontent-%COMP%], .play-loader[_ngcontent-%COMP%]:hover   .play-loader__circle[_ngcontent-%COMP%]{background:var(--view-loader-button-bg--hover);color:var(--view-loader-circle-color--hover);transform:scale(1.1)}.play-loader[_ngcontent-%COMP%]:focus   .play-loader__icon[_ngcontent-%COMP%], .play-loader[_ngcontent-%COMP%]:hover   .play-loader__icon[_ngcontent-%COMP%]{color:var(--view-loader-icon-color--hover);transform:scale(1.2)}.play-loader[_ngcontent-%COMP%]:focus   .play-loader__label[_ngcontent-%COMP%], .play-loader[_ngcontent-%COMP%]:hover   .play-loader__label[_ngcontent-%COMP%]{color:var(--view-loader-label-color--hover)}.play-loader[_ngcontent-%COMP%]:focus   .play-loader__ring[_ngcontent-%COMP%], .play-loader[_ngcontent-%COMP%]:hover   .play-loader__ring[_ngcontent-%COMP%]{stroke:var(--view-loader-progress-color--hover)}.play-loader__circle[_ngcontent-%COMP%]{width:var(--buttonSize);height:var(--buttonSize);border-radius:50%;background-color:var(--view-loader-button-bg);color:var(--view-loader-circle-color);display:flex;align-items:center;justify-content:center;position:relative;transition:background-color .25s,color .25s,transform .25s}.play-loader__icon[_ngcontent-%COMP%]{font-size:calc(var(--buttonSize) / 2);color:var(--view-loader-icon-color);transition:color .25s,transform .25s;margin-right:-10%}.play-loader__label[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;display:flex;justify-content:center;align-items:center;z-index:2;font-weight:600}.play-loader__ring[_ngcontent-%COMP%]{position:absolute;top:0;right:0;bottom:0;left:0;z-index:3;stroke-width:4;stroke:var(--view-loader-progress-color);fill:transparent;transform:rotate(-90deg)}@media (min-width:600px){.play-loader__circle[_ngcontent-%COMP%]{width:160px;height:160px}.play-loader__icon[_ngcontent-%COMP%]{font-size:80px}}"],changeDetection:0}),Qw),tO=((Hw=function(){function e(){m(this,e)}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||Hw)},Hw.\u0275cmp=P.Jb({type:Hw,selectors:[["app-hand-loader"]],decls:6,vars:0,consts:[["tabindex","0","type","button","aria-label","Interact in 3D",1,"hand-loader"],[1,"hand-loader__container"],[1,"hand-loader__circle"],["src","assets/images/widget/loading_experience/interact-in-3d-hand.svg","alt","Interact in 3D",1,"hand-loader__3d-hand"],[1,"hand-loader__label"]],template:function(e,t){1&e&&(P.Vb(0,"button",0),P.Vb(1,"div",1),P.Qb(2,"div",2),P.Qb(3,"img",3),P.Vb(4,"div",4),P.Mc(5,"Interact in 3D"),P.Ub(),P.Ub(),P.Ub())},styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3838}.text-info[_ngcontent-%COMP%]{color:#0060c4}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.hand-loader[_ngcontent-%COMP%]{border:0;width:100%;background:rgba(0,0,0,.2);display:flex;position:fixed;justify-content:center;align-items:center;top:0;bottom:0;left:0;right:0;transition:background-color .25s,opacity .25s;z-index:10000}.hand-loader[_ngcontent-%COMP%]:hover{opacity:1;cursor:pointer;background:var(--view-loader-scrim-bg--hover)}@-webkit-keyframes handKeyframes{0%{transform:scale(1.2)}25%{transform:scale(1)}40%{transform:scale(1)}60%{transform:scale(1.2)}to{transform:scale(1.2)}}@keyframes handKeyframes{0%{transform:scale(1.2)}25%{transform:scale(1)}40%{transform:scale(1)}60%{transform:scale(1.2)}to{transform:scale(1.2)}}@-webkit-keyframes circleKeyframes{0%{transform:scale(0)}20%{transform:scale(0);opacity:1}to{transform:scale(1);opacity:0}}@keyframes circleKeyframes{0%{transform:scale(0)}20%{transform:scale(0);opacity:1}to{transform:scale(1);opacity:0}}.hand-loader[_ngcontent-%COMP%]:focus   .hand-loader__3d-hand[_ngcontent-%COMP%], .hand-loader[_ngcontent-%COMP%]:hover   .hand-loader__3d-hand[_ngcontent-%COMP%]{filter:drop-shadow(0 0 8px #2d72dc)}.hand-loader__container[_ngcontent-%COMP%]{position:relative;width:200px;height:200px}.hand-loader__circle[_ngcontent-%COMP%]{background-color:#fff;position:absolute;left:50%;margin-left:-40.5px;margin-top:-1.5px;width:70px;height:70px;border-radius:50%;-webkit-animation:circleKeyframes 2s infinite;animation:circleKeyframes 2s infinite}.hand-loader__3d-hand[_ngcontent-%COMP%]{-webkit-animation:handKeyframes 2s ease-in-out infinite;animation:handKeyframes 2s ease-in-out infinite;position:absolute;height:96px;width:86px;left:50%;margin-left:-43px;margin-top:27px;transition:filter .3s ease-out}.hand-loader__label[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em;font-weight:600;color:#fff;text-shadow:0 1px 5px #000;bottom:40px;position:absolute;text-align:center;width:100%}"],changeDetection:0}),Hw),nO=["app-view-rounded-button",""];function iO(e,t){if(1&e&&P.Qb(0,"app-icon",3),2&e){var n=P.gc();P.lc("icon",n.icon)}}var oO,rO=((oO=function(){function e(){m(this,e),this.iconPlacement="left",this.compact=!1,this.buttonType="outline"}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||oO)},oO.\u0275cmp=P.Jb({type:oO,selectors:[["button","app-view-rounded-button",""]],inputs:{icon:"icon",iconPlacement:"iconPlacement",label:"label",compact:"compact",buttonType:"buttonType",shadow:"shadow"},attrs:nO,decls:4,vars:12,consts:[[1,"view-rounded-button"],["class","view-rounded-button__icon mh-1",3,"icon",4,"ngIf"],[1,"view-rounded-button__label","mh-1"],[1,"view-rounded-button__icon","mh-1",3,"icon"]],template:function(e,t){1&e&&(P.Vb(0,"div",0),P.Kc(1,iO,1,1,"app-icon",1),P.Vb(2,"div",2),P.Mc(3),P.Ub(),P.Ub()),2&e&&(P.Hb("view-rounded-button--outline","outline"===t.buttonType)("view-rounded-button--solid","solid"===t.buttonType)("view-rounded-button--shadow",t.shadow)("view-rounded-button--compact",t.compact)("view-rounded-button--reverse","right"===t.iconPlacement),P.Db(1),P.lc("ngIf",t.icon),P.Db(2),P.Nc(t.label))},directives:[ra.l,nl],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3838}.text-info{color:#0060c4}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}button[app-view-rounded-button]{border-color:transparent;background:none;border-width:0;padding:0;outline:none;margin:0;pointer-events:all}button[app-view-rounded-button]:focus .view-rounded-button,button[app-view-rounded-button]:hover .view-rounded-button{color:#f9fafd;border-color:#f9fafd;background:rgba(249,250,253,.25)}button[app-view-rounded-button]:focus .view-rounded-button--solid,button[app-view-rounded-button]:hover .view-rounded-button--solid{border-color:rgba(249,250,253,.25)}.view-rounded-button{cursor:pointer;display:flex;flex-direction:row;align-items:center;justify-content:center;padding:12px 16px;border-radius:24px;color:#f9fafd;border:1px solid #f9fafd}.view-rounded-button__label{font-size:16px;letter-spacing:.4px;line-height:1.4em}.view-rounded-button--solid{color:#060502;border-color:#060502;background:#f9fafd}.view-rounded-button--shadow{box-shadow:0 0 8px rgba(0,0,0,.32)}.view-rounded-button--reverse{flex-direction:row-reverse}.view-rounded-button--compact{padding:4px 8px}"],encapsulation:2,changeDetection:0}),oO),aO=function(e){return e.CameraZoom="camera-zoom",e.CameraRotate="camera-rotate",e.CameraPan="camera-pan",e.NodeSelection="node-selection",e}({}),sO=h("JX91"),cO=h("IOcx");function lO(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.001;return dO(e).pipe(Object(sO.a)(t.getCameraZoom()),Object(Z.a)((function(){return t.getCameraZoom()})),Object(ta.a)(),Object(Z.a)((function(e){var t=p(e,2),n=t[0];return t[1]-n})),Object(me.a)((function(e){return Math.abs(e)>i})),Object(Jr.a)(n))}function uO(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:125;return dO(e).pipe(Object(sO.a)(t.getLookDirection()),Object(Z.a)((function(){return t.getLookDirection()})),Object(ta.a)(),Object(Z.a)((function(e){var t=p(e,2);return function(e,t){return cO.a.angle(e,t)>.001}(t[0],t[1])})),Object(me.a)((function(e){return e})),Object(Jr.a)(n))}function pO(e){return{camera:e.getCamera(),zoom:e.getCameraZoom()}}function dO(e){return e.getEvent(Dt.CameraRested)}function gO(e){var t=e.eye,n=e.look,i=cO.a.fromValues(t.x,t.y,t.z),o=cO.a.fromValues(n.x,n.y,n.z),r=cO.a.create();return cO.a.sub(r,i,o),r}var hO=h("vqkR");function fO(e,t){if(1&e&&(P.Vb(0,"h1",6),P.Mc(1),P.Ub()),2&e){var n=P.gc(2);P.Db(1),P.Oc(" ",n.title," ")}}function bO(e,t){if(1&e&&P.Qb(0,"img",7),2&e){var n=P.gc(2);P.lc("src",n.image,P.Cc)}}function vO(e,t){if(1&e&&(P.Vb(0,"div",1),P.Kc(1,fO,2,1,"h1",2),P.Vb(2,"article",3),P.jc(3),P.Ub(),P.Kc(4,bO,1,1,"img",4),P.Vb(5,"div",5),P.jc(6,1),P.Ub(),P.Ub()),2&e){var n=P.gc();P.Hb("slide--expanded","expanded"===n.spacing),P.lc("@refresh",void 0),P.Db(1),P.lc("ngIf",n.title),P.Db(3),P.lc("ngIf",n.image)}}var mO,yO=["*",[["","slide-footer",""]]],xO=["*","[slide-footer]"],kO=((mO=function(){function e(t,n,i,o,r){m(this,e),this.store=t,this.actions=n,this.engineService=i,this.cameraService=o,this.changeRef=r,this.spacing="compact",this.exitEnabled=!0,this.triggerDelay=300,this.triggerComplete=new P.p,this._shown=!1,this.ngUnsubscribe=new fe.a}return v(e,[{key:"shown",get:function(){return this._shown},set:function(e){this._shown=e,this.initTrigger(),this.changeRef.markForCheck()}},{key:"ngOnInit",value:function(){}},{key:"ngAfterViewInit",value:function(){this.initTrigger()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initTrigger",value:function(){var e=this;if(this.ngUnsubscribe.next(),this.shown&&this.trigger){var t=this.resetCamera(),n=this.store.selectSnapshot(ku.getCanTouch);(function(e,t,n,i,o){switch(e){case aO.CameraZoom:return o?lO(n,i):function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.001,o=e.getCanvas(),r=Object(Zr.a)(o,"wheel"),a=Object(Zr.a)(o,"touchmove").pipe(Object(me.a)((function(e){return 2===e.touches.length}))),s=lO(e,t,n,i);return Object(Kr.a)(r,a).pipe(Object(rr.a)((function(){return s})))}(n,i);case aO.CameraPan:return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:125,i=e.getCanvas(),o=Object(Zr.a)(i,"mousemove").pipe(Object(me.a)((function(e){return 1===e.buttons&&e.shiftKey||2===e.buttons||4===e.buttons}))),r=Object(Zr.a)(i,"touchmove").pipe(Object(me.a)((function(e){return 2===e.touches.length}))),a=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:125;return dO(e).pipe(Object(sO.a)(pO(t)),Object(Z.a)((function(){return pO(t)})),Object(Jr.a)(n),Object(ta.a)(),Object(Z.a)((function(e){var t=p(e,2);return function(e,t){var n=gO(e.camera),i=gO(t.camera),o=cO.a.create();cO.a.sub(o,n,i);var r=o.reduce((function(e,t){return e+t})),a=t.zoom-e.zoom;return(0!==a||0!==r)&&Math.abs(r)<1&&Math.abs(a)<.001}(t[0],t[1])})),Object(me.a)((function(e){return e})))}(e,t,n);return Object(Kr.a)(o,r).pipe(Object(rr.a)((function(){return a})))}(n,i);case aO.CameraRotate:return o?uO(n,i):function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e3,o=t.getCanvas(),r=Object(Zr.a)(o,"mousemove").pipe(Object(me.a)((function(e){return 1===e.buttons}))),a=Object(Zr.a)(o,"touchmove").pipe(Object(me.a)((function(e){return 1===e.touches.length}))),s=uO(t,n,i);return Object(Kr.a)(r,a).pipe(Object(rr.a)((function(){return s})),Object(me.a)((function(){return"rotate"===e.selectSnapshot(Ar.getPanMode)})),Object(Jr.a)(125))}(t,n,i);case aO.NodeSelection:return function(e){return e.select(Ai.getCheckedNodes).pipe(Object(ta.a)(),Object(me.a)((function(e){var t=p(e,2);return t[0],t[1].length>0})))}(t)}})(this.trigger,this.store,this.engineService,this.cameraService,n).pipe(Object(hO.a)(t),Object(Rs.a)(this.triggerDelay),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(){e.triggerComplete.next()}))}}},{key:"resetCamera",value:function(){var e=this,t=this.store.selectSnapshot(Lr.getSelectedChapter);return this.store.dispatch(new $t(t.camera.location,!0)).pipe(Object(rr.a)((function(){return e.actions.pipe(Object(E.j)(Kt))})),Object(Ou.a)(1))}}]),e}()).\u0275fac=function(e){return new(e||mO)(P.Pb(E.g),P.Pb(E.b),P.Pb(Nt),P.Pb(gn),P.Pb(P.i))},mO.\u0275cmp=P.Jb({type:mO,selectors:[["app-view-tour-slide"]],inputs:{title:"title",image:"image",spacing:"spacing",shown:"shown",exitEnabled:"exitEnabled",trigger:"trigger",triggerDelay:"triggerDelay"},outputs:{triggerComplete:"triggerComplete"},ngContentSelectors:xO,decls:1,vars:1,consts:[["class","slide",3,"slide--expanded",4,"ngIf"],[1,"slide"],["class","slide__title",4,"ngIf"],[1,"slide__content"],["class","slide__image",3,"src",4,"ngIf"],[1,"slide__footer"],[1,"slide__title"],[1,"slide__image",3,"src"]],template:function(e,t){1&e&&(P.kc(yO),P.Kc(0,vO,7,5,"div",0)),2&e&&P.lc("ngIf",t.shown)},directives:[ra.l],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3838}.text-info[_ngcontent-%COMP%]{color:#0060c4}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.slide[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;max-width:500px}.slide__title[_ngcontent-%COMP%]{font-weight:600;font-size:18px;letter-spacing:.45px}.slide__content[_ngcontent-%COMP%], .slide__title[_ngcontent-%COMP%]{margin-bottom:16px;line-height:1.4em}.slide__content[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.5em;max-width:100%}.slide__image[_ngcontent-%COMP%]{margin:24px auto;max-width:100%;min-height:1px}.slide__footer[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em;font-weight:500;display:flex;flex-direction:row;align-items:center;justify-content:center;max-width:100%}.slide--expanded[_ngcontent-%COMP%]   .slide__title[_ngcontent-%COMP%]{margin:16px}.slide--expanded[_ngcontent-%COMP%]   .slide__content[_ngcontent-%COMP%]{margin:48px}.slide--expanded[_ngcontent-%COMP%]   .slide__image[_ngcontent-%COMP%]{margin:48px auto}@media (max-width:768px){.slide[_ngcontent-%COMP%]{max-width:400px}.slide__image[_ngcontent-%COMP%]{margin:16px}.slide__title[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em;margin-bottom:12px}.slide__content[_ngcontent-%COMP%]{margin-bottom:12px}.slide__content[_ngcontent-%COMP%], .slide__footer[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}}@media (max-width:640px){.slide[_ngcontent-%COMP%]{max-width:320px}}@media (max-width:480px){.slide[_ngcontent-%COMP%]{max-width:240px}.slide__title[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px}.slide__content[_ngcontent-%COMP%], .slide__title[_ngcontent-%COMP%]{line-height:1.4em;margin-bottom:8px}.slide__content[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px}.slide__image[_ngcontent-%COMP%]{margin:4px auto}.slide__footer[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}}@media (max-width:320px){.slide[_ngcontent-%COMP%]{max-width:160px}}"],data:{animation:[Object(wu.n)("refresh",[Object(wu.m)(":enter",[Object(wu.o)(uy.slideTransition,{params:{duration:500,from:100,to:0}})])])]},changeDetection:0}),mO);function wO(e,t){1&e&&(P.Vb(0,"div",1),P.Vb(1,"div",2),P.jc(2),P.Ub(),P.Ub())}var OO,CO=["*"],SO=((OO=function(){function e(t){m(this,e),this.changeRef=t,this.selectedSlideIndex=0,this._shown=!1,this.ngUnsubscribe=new fe.a}return v(e,[{key:"shown",get:function(){return this._shown},set:function(e){this._shown=e,this.setSelectedSlide(0)}},{key:"ngOnInit",value:function(){}},{key:"ngAfterViewInit",value:function(){var e=this;this.initListeners(),setTimeout((function(){e.setSlideShown(e.selectedSlideIndex)}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"goToPrevSlide",value:function(){this.setSelectedSlide(this.selectedSlideIndex-1)}},{key:"goToNextSlide",value:function(){this.setSelectedSlide(this.selectedSlideIndex+1)}},{key:"setSelectedSlide",value:function(e){if(this.selectedSlideIndex=e,this.slides){var t=Math.max(0,Math.min(this.slides.length-1,e));this.selectedSlideIndex=t}this.setSlideShown(this.selectedSlideIndex)}},{key:"initListeners",value:function(){var e=this;Object(Kr.a).apply(void 0,c(this.slides.map((function(e){return e.triggerComplete.asObservable()})))).pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(){e.goToNextSlide()}))}},{key:"setSlideShown",value:function(e){this.slides&&this.slides.forEach((function(t,n){t.shown=n===e})),this.changeRef.markForCheck()}}]),e}()).\u0275fac=function(e){return new(e||OO)(P.Pb(P.i))},OO.\u0275cmp=P.Jb({type:OO,selectors:[["app-view-tour-page"]],contentQueries:function(e,t,n){var i;1&e&&P.Ib(n,kO,!1),2&e&&P.uc(i=P.dc())&&(t.slides=i)},inputs:{shown:"shown"},ngContentSelectors:CO,decls:1,vars:1,consts:[["class","page",4,"ngIf"],[1,"page"],[1,"page__contents"]],template:function(e,t){1&e&&(P.kc(),P.Kc(0,wO,3,0,"div",0)),2&e&&P.lc("ngIf",t.shown)},directives:[ra.l],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3838}.text-info[_ngcontent-%COMP%]{color:#0060c4}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.page[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center}.page__contents[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}@media (max-width:768px){.page__contents[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}}@media (max-width:480px){.page__contents[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}}"],changeDetection:0}),OO),_O=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function jO(e,t){if(1&e){var n=P.Wb();P.Vb(0,"div",5),P.Vb(1,"button",6),P.cc("click",(function(){return P.zc(n),P.gc(2).handlePrevClick()})),P.Ub(),P.Vb(2,"div",7),P.Mc(3),P.Ub(),P.Vb(4,"button",8),P.cc("click",(function(){return P.zc(n),P.gc(2).handleNextClick()})),P.Ub(),P.Ub()}if(2&e){var i=P.gc().$implicit;P.Db(1),P.lc("disabled",i.pageIndex<1),P.Db(2),P.Pc(" ",i.pageIndex+1," / ",i.pageSize," "),P.Db(1),P.lc("disabled",i.pageIndex===i.pageSize-1)}}var PO=function(e){return{"pages--opaquer":e}};function MO(e,t){if(1&e){var n=P.Wb();P.Vb(0,"div",1),P.Vb(1,"button",2),P.cc("click",(function(){return P.zc(n),P.gc().handleExitClick()})),P.Ub(),P.Vb(2,"div",3),P.jc(3),P.Ub(),P.Kc(4,jO,5,4,"div",4),P.Ub()}if(2&e){var i=t.$implicit;P.lc("ngClass",P.oc(2,PO,i.pageIndex==i.pageSize-1)),P.Db(4),P.lc("ngIf",i.pageIndex<i.pageSize-1)}}var IO,zO,TO,UO=["*"],LO=((TO=function(){function e(t,n,i){m(this,e),this.store=t,this.changeRef=n,this.ga=i,this.ngUnsubscribe=new fe.a,this.index=null}return v(e,[{key:"ngOnInit",value:function(){}},{key:"ngAfterViewInit",value:function(){var e=this;this.tutorial$.pipe(Object(ve.a)(this.ngUnsubscribe),Object(me.a)((function(e){return null!=e&&e.pageSize>0}))).subscribe((function(t){e.handleTutorialPages(t)})),this.store.dispatch(new j.SetTutorial({pageSize:this.pages.length,pageIndex:0}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"handlePrevClick",value:function(){this.store.dispatch(new j.TutorialPrevious)}},{key:"handleNextClick",value:function(){this.store.dispatch(new j.TutorialNext)}},{key:"handleExitClick",value:function(){this.store.dispatch(new j.ToggleWindow(nu.Tutorial,!1))}},{key:"handleTutorialPages",value:function(e){this.pages.forEach((function(t,n){t.shown=n===e.pageIndex})),this.ga.event("Viewed Tutorial Step","View Tutorial","Step ".concat(e.pageIndex+1," of ").concat(e.pageSize)),this.changeRef.markForCheck()}}]),e}()).\u0275fac=function(e){return new(e||TO)(P.Pb(E.g),P.Pb(P.i),P.Pb(Ce.c))},TO.\u0275cmp=P.Jb({type:TO,selectors:[["app-view-tour-pages"]],contentQueries:function(e,t,n){var i;1&e&&P.Ib(n,SO,!1),2&e&&P.uc(i=P.dc())&&(t.pages=i)},ngContentSelectors:UO,decls:2,vars:3,consts:[["gaCategory","View Tutorial","class","pages",3,"ngClass",4,"ngIf"],["gaCategory","View Tutorial",1,"pages",3,"ngClass"],["gaEvent","","gaAction","Clicked Exit Tutorial","app-pin-button","","buttonType","dark","size","medium","icon","times","aria-label","Exit Tutorial","matTooltip","Exit Tutorial","matTooltipPosition","right",1,"pages__close",3,"click"],[1,"pages__contents"],["class","pages__footer",4,"ngIf"],[1,"pages__footer"],["gaEvent","","gaAction","Clicked Previous Tutorial Step","app-pin-button","","buttonType","dark","size","large","icon","angle-left","aria-label","Previous Tutorial Step","matTooltip","Previous Tutorial Step","matTooltipPosition","left",1,"pages__nav",3,"disabled","click"],[1,"mh-8"],["gaEvent","","gaAction","Clicked Next Tutorial Step","app-pin-button","","buttonType","dark","size","large","icon","angle-right","aria-label","Next Tutorial Step","matTooltip"," Next Tutorial Step","matTooltipPosition","right",1,"pages__nav",3,"disabled","click"]],template:function(e,t){1&e&&(P.kc(),P.Kc(0,MO,5,4,"div",0),P.hc(1,"async")),2&e&&P.lc("ngIf",P.ic(1,1,t.tutorial$))},directives:[ra.l,Ce.a,ra.i,vg,Ce.b,mg.c],pipes:[ra.b],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3838}.text-info[_ngcontent-%COMP%]{color:#0060c4}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.pages[_ngcontent-%COMP%]{pointer-events:none;display:flex;flex-direction:column;align-items:center;justify-content:center;margin:20px auto 48px;max-width:600px;position:relative;background:rgba(16,24,35,.8);border-radius:16px;padding:24px 28px 20px}.pages--opaquer[_ngcontent-%COMP%]{background:rgba(16,24,35,.9)}.pages__footer[_ngcontent-%COMP%]{flex-direction:row;font-size:16px;letter-spacing:.4px;line-height:1.4em;font-weight:500}.pages__close[_ngcontent-%COMP%], .pages__footer[_ngcontent-%COMP%]{display:flex;align-items:center}.pages__close[_ngcontent-%COMP%]{z-index:1;position:absolute;top:8px;right:8px;align-self:flex-end;justify-content:center}.pages__contents[_ngcontent-%COMP%]{padding:16px 0}@media (max-width:768px){.pages[_ngcontent-%COMP%]{margin:16px 12% 48px;border-radius:10px;padding:18px 22px 14px}.pages__contents[_ngcontent-%COMP%]{padding:24px 0}.pages__footer[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.pages__nav[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}}@media (max-width:480px){.pages[_ngcontent-%COMP%]{margin:12px 10% 48px;border-radius:8px;padding:24px 20px 12px}.pages__footer[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.pages__nav[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}}"],changeDetection:0}),function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);r>3&&a&&Object.defineProperty(t,n,a)}([Object(E.d)(ku.getTutorial),_O("design:type",be.a)],TO.prototype,"tutorial$",void 0),TO),DO=((zO=function(){function e(){m(this,e)}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||zO)},zO.\u0275cmp=P.Jb({type:zO,selectors:[["app-view-tour-success"]],inputs:{inline:"inline"},decls:2,vars:2,consts:[[1,"view-tour-success"],["icon","check",1,"view-tour-success__icon"]],template:function(e,t){1&e&&(P.Vb(0,"div",0),P.Qb(1,"app-icon",1),P.Ub()),2&e&&P.Hb("view-tour-success--inline",t.inline)},directives:[nl],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3838}.text-info{color:#0060c4}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.view-tour-success{width:52px;height:52px;display:flex;background-color:#1bbc66;border-radius:50%;justify-content:center;align-items:center}.view-tour-success__icon{font-size:36px;letter-spacing:.9px;line-height:1.4em;color:#fff}.view-tour-success--inline{display:inline-flex;width:32px;height:32px}.view-tour-success--inline .view-tour-success__icon{font-size:18px;letter-spacing:.45px;line-height:1.4em}@media (max-width:768px){.view-tour-success{width:36px;height:36px}.view-tour-success__icon{font-size:20px;letter-spacing:.5px;line-height:1.4em}.view-tour-success--inline{display:inline-flex;width:24px;height:24px}.view-tour-success--inline .view-tour-success__icon{font-size:12px;letter-spacing:.3px;line-height:1.4em}}"],encapsulation:2,changeDetection:0}),zO),EO=((IO=function(){function e(t){m(this,e),this.viewService=t,this.triggers=aO}return v(e,[{key:"ngOnInit",value:function(){}},{key:"handleStartClick",value:function(){this.viewService.toggleTutorial(!1)}}]),e}()).\u0275fac=function(e){return new(e||IO)(P.Pb(td))},IO.\u0275cmp=P.Jb({type:IO,selectors:[["app-view-tour-mobile"]],decls:31,vars:5,consts:[["gaCategory","View Tutorial"],["title","Rotate",3,"trigger"],["title","Zoom",3,"trigger"],["title","Pan",3,"trigger"],["title","Explore the Anatomy",3,"trigger"],[1,"flex","justify-start","items-center"],[1,"mr-2",3,"inline"],[1,"text-semibold"],["title","Toolbar","image","assets/images/tutorial/tutorial-toolbar@3x.png"],["slide-footer","",1,"flex","flex-column","items-center","justify-center"],["gaEvent","","gaAction","Clicked Start Exploring","app-view-rounded-button","","buttonType","solid","label","Start Exploring!","aria-label","Start Exploring",1,"mt-4",3,"click"]],template:function(e,t){1&e&&(P.Vb(0,"app-view-tour-pages",0),P.Vb(1,"app-view-tour-page"),P.Vb(2,"app-view-tour-slide",1),P.Mc(3," Tap and drag with one finger to change the viewing angle. "),P.Ub(),P.Vb(4,"app-view-tour-slide"),P.Qb(5,"app-view-tour-success"),P.Ub(),P.Ub(),P.Vb(6,"app-view-tour-page"),P.Vb(7,"app-view-tour-slide",2),P.Mc(8," Pinch with two fingers to zoom in or out. "),P.Ub(),P.Vb(9,"app-view-tour-slide"),P.Qb(10,"app-view-tour-success"),P.Ub(),P.Ub(),P.Vb(11,"app-view-tour-page"),P.Vb(12,"app-view-tour-slide",3),P.Mc(13," Use two fingers to adjust the model's position. "),P.Ub(),P.Vb(14,"app-view-tour-slide"),P.Qb(15,"app-view-tour-success"),P.Ub(),P.Ub(),P.Vb(16,"app-view-tour-page"),P.Vb(17,"app-view-tour-slide",4),P.Mc(18," Tap on an individual part of the model to highlight anatomy. "),P.Ub(),P.Vb(19,"app-view-tour-slide"),P.Vb(20,"div",5),P.Vb(21,"div"),P.Qb(22,"app-view-tour-success",6),P.Vb(23,"strong",7),P.Mc(24,"Tip:"),P.Ub(),P.Mc(25," Double-tap to zoom in on specific structures. "),P.Ub(),P.Ub(),P.Ub(),P.Ub(),P.Vb(26,"app-view-tour-page"),P.Vb(27,"app-view-tour-slide",8),P.Mc(28," Use the toolbar to navigate through the 3D experience, launch deeper exploration tools, and relaunch this tutorial. "),P.Vb(29,"div",9),P.Vb(30,"button",10),P.cc("click",(function(){return t.handleStartClick()})),P.Ub(),P.Ub(),P.Ub(),P.Ub(),P.Ub()),2&e&&(P.Db(2),P.lc("trigger","camera-rotate"),P.Db(5),P.lc("trigger",t.triggers.CameraZoom),P.Db(5),P.lc("trigger",t.triggers.CameraPan),P.Db(5),P.lc("trigger",t.triggers.NodeSelection),P.Db(5),P.lc("inline",!0))},directives:[LO,Ce.a,SO,kO,DO,rO,Ce.b],styles:[""],changeDetection:0}),IO);function FO(e,t){if(1&e&&P.Qb(0,"app-icon",5),2&e){var n=P.gc(2);P.lc("icon",n.icon)}}function AO(e,t){if(1&e&&(P.Vb(0,"span",6),P.Mc(1),P.Ub()),2&e){var n=P.gc(2);P.Db(1),P.Nc(n.label)}}function RO(e,t){if(1&e&&(P.Tb(0),P.Kc(1,FO,1,1,"app-icon",3),P.Kc(2,AO,2,1,"span",4),P.Sb()),2&e){var n=P.gc();P.Db(1),P.lc("ngIf",n.icon),P.Db(1),P.lc("ngIf",n.icon)}}function VO(e,t){if(1&e&&(P.Vb(0,"span"),P.Mc(1),P.Ub()),2&e){var n=P.gc();P.Db(1),P.Oc(" ",n.label," ")}}var NO,BO=((NO=function(){function e(){m(this,e)}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||NO)},NO.\u0275cmp=P.Jb({type:NO,selectors:[["app-view-tour-tip-button"]],inputs:{label:"label",icon:"icon"},decls:3,vars:2,consts:[[1,"view-tour-tip-button","mv-1","mh-1",3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"icon",4,"ngIf"],["class","visually-hidden",4,"ngIf"],[3,"icon"],[1,"visually-hidden"]],template:function(e,t){1&e&&(P.Vb(0,"div",0),P.Kc(1,RO,3,2,"ng-container",1),P.Kc(2,VO,2,1,"span",2),P.Ub()),2&e&&(P.lc("ngSwitch",!!t.icon),P.Db(1),P.lc("ngSwitchCase",!0))},directives:[ra.n,ra.o,ra.p,ra.l,nl],styles:[".view-tour-tip-button{display:inline-flex;align-items:center;justify-content:center;vertical-align:middle;color:#131c2a;background-color:#fff;border-radius:2px;font-weight:700;padding:4px;width:24px;height:24px}@media (max-width:768px){.view-tour-tip-button{width:20px;height:20px}}"],encapsulation:2,changeDetection:0}),NO),HO=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function QO(e,t){1&e&&(P.Tb(0),P.Mc(1," Hold the control key and scroll up and down to zoom in or out. "),P.Sb())}function qO(e,t){1&e&&(P.Tb(0),P.Mc(1," Scroll up and down to zoom in or out. "),P.Sb())}var WO,$O=((WO=function(){function e(t){m(this,e),this.viewService=t,this.triggers=aO}return v(e,[{key:"ngOnInit",value:function(){this.captureScroll$=this.scrollMode$.pipe(Object(Z.a)((function(e){return e===Vr.Capture})))}},{key:"handleStartClick",value:function(){this.viewService.toggleTutorial(!1)}}]),e}()).\u0275fac=function(e){return new(e||WO)(P.Pb(td))},WO.\u0275cmp=P.Jb({type:WO,selectors:[["app-view-tour-desktop"]],decls:62,vars:12,consts:[["gaCategory","View Tutorial"],["title","Rotate",3,"trigger"],[1,"flex","justify-start","items-center"],[1,"mr-2",3,"inline"],[1,"text-semibold"],["icon","caret-up","label","up"],["icon","caret-down","label","down"],["icon","caret-left","label","left"],["icon","caret-right","label","right"],["title","Zoom",3,"trigger","ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["label","+"],["label","-"],["title","Pan",3,"trigger"],["label","W"],["label","A"],["label","S"],["label","D"],["title","Explore the Anatomy",3,"trigger"],["image","assets/images/tutorial/tutorial-toolbar@3x.png"],["slide-footer","",1,"flex","flex-column","items-center","justify-center"],["gaEvent","","gaAction","Clicked Start Exploring","app-view-rounded-button","","buttonType","solid","label","Start Exploring!","aria-label","Start Exploring",1,"mt-4",3,"click"]],template:function(e,t){1&e&&(P.Vb(0,"app-view-tour-pages",0),P.Vb(1,"app-view-tour-page"),P.Vb(2,"app-view-tour-slide",1),P.Mc(3," Click and drag the model to change the viewing angle. "),P.Ub(),P.Vb(4,"app-view-tour-slide"),P.Vb(5,"div",2),P.Vb(6,"div"),P.Qb(7,"app-view-tour-success",3),P.Vb(8,"strong",4),P.Mc(9,"Tip:"),P.Ub(),P.Mc(10," You can also use the arrow keys "),P.Qb(11,"app-view-tour-tip-button",5),P.Qb(12,"app-view-tour-tip-button",6),P.Qb(13,"app-view-tour-tip-button",7),P.Qb(14,"app-view-tour-tip-button",8),P.Mc(15," to rotate. "),P.Ub(),P.Ub(),P.Ub(),P.Ub(),P.Vb(16,"app-view-tour-page"),P.Vb(17,"app-view-tour-slide",9),P.hc(18,"async"),P.Kc(19,QO,2,0,"ng-container",10),P.Kc(20,qO,2,0,"ng-container",11),P.Ub(),P.Vb(21,"app-view-tour-slide"),P.Vb(22,"div",2),P.Vb(23,"div"),P.Qb(24,"app-view-tour-success",3),P.Vb(25,"strong",4),P.Mc(26,"Tip:"),P.Ub(),P.Mc(27," You can also use "),P.Qb(28,"app-view-tour-tip-button",12),P.Mc(29," to zoom in and "),P.Qb(30,"app-view-tour-tip-button",13),P.Mc(31," to zoom out. "),P.Ub(),P.Ub(),P.Ub(),P.Ub(),P.Vb(32,"app-view-tour-page"),P.Vb(33,"app-view-tour-slide",14),P.Mc(34," Hold the shift key and drag to move the model's position. "),P.Ub(),P.Vb(35,"app-view-tour-slide"),P.Vb(36,"div",2),P.Vb(37,"div"),P.Qb(38,"app-view-tour-success",3),P.Vb(39,"strong",4),P.Mc(40,"Tip:"),P.Ub(),P.Mc(41," You can also use the "),P.Qb(42,"app-view-tour-tip-button",15),P.Qb(43,"app-view-tour-tip-button",16),P.Qb(44,"app-view-tour-tip-button",17),P.Qb(45,"app-view-tour-tip-button",18),P.Mc(46," keys to pan. "),P.Ub(),P.Ub(),P.Ub(),P.Ub(),P.Vb(47,"app-view-tour-page"),P.Vb(48,"app-view-tour-slide",19),P.Mc(49," Click on an individual part of the model to highlight anatomy. "),P.Ub(),P.Vb(50,"app-view-tour-slide"),P.Vb(51,"div",2),P.Vb(52,"div"),P.Qb(53,"app-view-tour-success",3),P.Vb(54,"strong",4),P.Mc(55,"Tip:"),P.Ub(),P.Mc(56," Double-click to zoom in on specific structures. "),P.Ub(),P.Ub(),P.Ub(),P.Ub(),P.Vb(57,"app-view-tour-page"),P.Vb(58,"app-view-tour-slide",20),P.Mc(59," Use the toolbar to navigate through the 3D experience, launch deeper exploration tools, and relaunch this tutorial. "),P.Vb(60,"div",21),P.Vb(61,"button",22),P.cc("click",(function(){return t.handleStartClick()})),P.Ub(),P.Ub(),P.Ub(),P.Ub(),P.Ub()),2&e&&(P.Db(2),P.lc("trigger",t.triggers.CameraRotate),P.Db(5),P.lc("inline",!0),P.Db(10),P.lc("trigger",t.triggers.CameraZoom)("ngSwitch",P.ic(18,10,t.captureScroll$)),P.Db(2),P.lc("ngSwitchCase",!1),P.Db(5),P.lc("inline",!0),P.Db(9),P.lc("trigger",t.triggers.CameraPan),P.Db(5),P.lc("inline",!0),P.Db(10),P.lc("trigger",t.triggers.NodeSelection),P.Db(5),P.lc("inline",!0))},directives:[LO,Ce.a,SO,kO,DO,BO,ra.n,ra.o,ra.p,rO,Ce.b],pipes:[ra.b],styles:[""],changeDetection:0}),function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);r>3&&a&&Object.defineProperty(t,n,a)}([Object(E.d)(Wr.getScrollMode),HO("design:type",be.a)],WO.prototype,"scrollMode$",void 0),WO),KO=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},GO=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function ZO(e,t){if(1&e){var n=P.Wb();P.Vb(0,"div",3),P.Vb(1,"h1",4),P.Mc(2,"Getting Started"),P.Ub(),P.Vb(3,"p",5),P.Mc(4," Welcome! This tutorial will teach you how to navigate and explore in 3D using your "),P.Qb(5,"button",6),P.hc(6,"async"),P.hc(7,"async"),P.Vb(8,"mat-menu",null,7),P.Vb(10,"button",8),P.cc("click",(function(){P.zc(n);var e=P.gc();return e.handleSelectInputModeClick(e.inputModes.Mouse)})),P.Mc(11),P.Ub(),P.Vb(12,"button",8),P.cc("click",(function(){P.zc(n);var e=P.gc();return e.handleSelectInputModeClick(e.inputModes.Touch)})),P.Mc(13),P.Ub(),P.Ub(),P.Ub(),P.Vb(14,"div",9),P.Vb(15,"button",10),P.cc("click",(function(){return P.zc(n),P.gc().handleExitClick()})),P.Ub(),P.Vb(16,"button",11),P.cc("click",(function(){return P.zc(n),P.gc().handleStartClick()})),P.Ub(),P.Ub(),P.Ub()}if(2&e){var i=P.vc(9),o=P.gc();P.Db(5),P.lc("compact",!0)("label",o.inputModesText[P.ic(6,8,o.inputMode$)])("matMenuTriggerFor",i),P.Eb("aria-label",o.inputModesText[P.ic(7,10,o.inputMode$)]),P.Db(5),P.lc("gaLabel",o.inputModesText[o.inputModes.Mouse]),P.Db(1),P.Oc(" ",o.inputModesText[o.inputModes.Mouse]," "),P.Db(1),P.lc("gaLabel",o.inputModesText[o.inputModes.Touch]),P.Db(1),P.Oc(" ",o.inputModesText[o.inputModes.Touch]," ")}}function JO(e,t){1&e&&P.Qb(0,"app-view-tour-mobile")}function XO(e,t){1&e&&P.Qb(0,"app-view-tour-desktop")}function YO(e,t){if(1&e&&(P.Vb(0,"div",12),P.hc(1,"async"),P.Kc(2,JO,1,0,"app-view-tour-mobile",13),P.Kc(3,XO,1,0,"app-view-tour-desktop",14),P.Ub()),2&e){var n=P.gc();P.lc("ngSwitch",P.ic(1,2,n.inputMode$)),P.Db(2),P.lc("ngSwitchCase",n.inputModes.Touch)}}var eC,tC=(u(x={},hu.Mouse,"mouse, trackpad, or keyboard"),u(x,hu.Touch,"touchscreen"),x),nC=((eC=function(){function e(t,n,i){m(this,e),this.store=t,this.viewService=n,this.storageService=i,this.inputModes=hu,this.inputModesText=tC,this.tourStarted=!1,this.tourEnded=!1,this.ngUnsubscribe=new fe.a}return v(e,[{key:"ngOnInit",value:function(){this.initListeners(),this.store.dispatch(new j.TutorialSeen(!0))}},{key:"ngAfterViewInit",value:function(){}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initListeners",value:function(){var e=this;this.tutorial$.pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){var n=t.pageIndex,i=t.pageSize;e.tourStarted=n>-1,e.tourEnded=n===i-1})),Object(Zr.a)(window,"keyup").pipe(Object(me.a)((function(e){return"Escape"===e.key})),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(){e.exit()}))}},{key:"handleExitClick",value:function(){this.exit()}},{key:"handleStartClick",value:function(){this.store.dispatch(new j.StartTutorial(!1))}},{key:"handleSelectInputModeClick",value:function(e){this.store.dispatch(new j.SetInputMode(e))}},{key:"exit",value:function(){this.viewService.toggleTutorial(!1)}}]),e}()).\u0275fac=function(e){return new(e||eC)(P.Pb(E.g),P.Pb(td),P.Pb(As))},eC.\u0275cmp=P.Jb({type:eC,selectors:[["app-view-tour"]],decls:3,vars:7,consts:[["gaCategory","View Tutorial","role","dialog","aria-label","Getting Started Tutorial",1,"tour"],["class","tour__intro",4,"ngIf"],["class","tour__contents",3,"ngSwitch",4,"ngIf"],[1,"tour__intro"],[1,"tour__title"],[1,"tour__welcome"],["app-view-rounded-button","","buttonType","outline","icon","chevron-down","iconPlacement","right",1,"tour__input-selection","text-small",3,"compact","label","matMenuTriggerFor"],["inputSelectionMenu","matMenu"],["gaEvent","","gaAction","Clicked Input Type","mat-menu-item","",3,"gaLabel","click"],[1,"tour__footer"],["gaEvent","","gaAction","Clicked No Thanks","app-view-rounded-button","","buttonType","outline","label","No, Thanks.","aria-label","Exit Tutorial",1,"mr-3","text-medium",3,"click"],["gaEvent","","gaAction","Clicked Start Tutorial","app-view-rounded-button","","buttonType","solid","label","Start Tutorial","aria-label","Start Tutorial",1,"ml-3","text-medium",3,"click"],[1,"tour__contents",3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"]],template:function(e,t){1&e&&(P.Vb(0,"div",0),P.Kc(1,ZO,17,12,"div",1),P.Kc(2,YO,4,4,"div",2),P.Ub()),2&e&&(P.Hb("tour--started",t.tourStarted)("tour--ended",t.tourEnded),P.lc("@refresh",void 0),P.Db(1),P.lc("ngIf",!t.tourStarted),P.Db(1),P.lc("ngIf",t.tourStarted))},directives:[Ce.a,ra.l,rO,hl.d,hl.a,Ce.b,hl.b,ra.n,ra.o,ra.p,EO,$O],pipes:[ra.b],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3838}.text-info[_ngcontent-%COMP%]{color:#0060c4}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.tour[_ngcontent-%COMP%]{color:#fff;position:absolute;top:0;right:0;bottom:0;left:0;z-index:100;pointer-events:none;display:flex;flex-direction:column;align-items:center;overflow:auto}.tour__title[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.tour__welcome[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em;margin:16px auto 32px}.tour__intro[_ngcontent-%COMP%]{background:rgba(16,24,35,.9);border-radius:16px;margin:auto;padding:28px 32px;text-align:center;max-width:560px}.tour__input-selection[_ngcontent-%COMP%]{vertical-align:middle}.tour__header[_ngcontent-%COMP%]{flex:none;align-self:flex-end;justify-self:flex-start;margin:24px}.tour__contents[_ngcontent-%COMP%]{flex:auto;display:flex;flex-direction:column;justify-content:flex-end;width:100%}.tour__footer[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em;display:flex;flex-direction:row;align-items:center;justify-content:center}.tour__nav-arrow[_ngcontent-%COMP%]{font-size:32px;letter-spacing:.8px;line-height:1.4em;cursor:pointer}.tour--ended[_ngcontent-%COMP%]   .tour__contents[_ngcontent-%COMP%]{justify-content:center}@media (max-width:768px){.tour__intro[_ngcontent-%COMP%]{border-radius:12px;padding:20px 24px;margin:auto 12%;max-width:100%}.tour__intro__title[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.tour__intro__content[_ngcontent-%COMP%]{max-width:80%}.tour__header[_ngcontent-%COMP%], .tour__intro__content[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.tour__header[_ngcontent-%COMP%]{margin:12px}.tour__footer[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.tour__nav-arrow[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}}@media (max-width:480px){.tour__intro[_ngcontent-%COMP%]{border-radius:8px;padding:16px 20px;margin:auto 10%}.tour__intro__title[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.tour__intro__content[_ngcontent-%COMP%]{margin:12px auto 16px}.tour__header[_ngcontent-%COMP%], .tour__intro__content[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.tour__header[_ngcontent-%COMP%]{margin:12px}.tour__footer[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.tour__nav-arrow[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}}"],data:{animation:[Object(wu.n)("refresh",[Object(wu.m)(":enter",[Object(wu.o)(uy.slideTransition,{params:{duration:500,from:100,to:0}})])])]},changeDetection:0}),KO([Object(E.d)(ku.getTutorial),GO("design:type",be.a)],eC.prototype,"tutorial$",void 0),KO([Object(E.d)(ku.getInputMode),GO("design:type",be.a)],eC.prototype,"inputMode$",void 0),eC),iC=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},oC=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},rC=["colorBtn"];function aC(e,t){1&e&&P.Qb(0,"app-icon",19)}function sC(e,t){if(1&e){var n=P.Wb();P.Vb(0,"button",14),P.cc("click",(function(){P.zc(n);var e=t.$implicit;return P.gc().setTextSize(e.size)})),P.Vb(1,"div",15),P.Vb(2,"div",16),P.Kc(3,aC,1,0,"app-icon",17),P.hc(4,"async"),P.Ub(),P.Vb(5,"div",18),P.Vb(6,"span"),P.Mc(7),P.Ub(),P.Ub(),P.Ub(),P.Ub()}if(2&e){var i=t.$implicit,o=P.gc();P.Db(3),P.lc("ngIf",i.size===P.ic(4,2,o.textSize$)),P.Db(4),P.Oc("",i.label,"px")}}function cC(e,t){1&e&&P.Qb(0,"app-icon",19)}function lC(e,t){if(1&e){var n=P.Wb();P.Vb(0,"button",14),P.cc("click",(function(){P.zc(n);var e=t.$implicit;return P.gc().setBrushSize(e.size)})),P.Vb(1,"div",15),P.Vb(2,"div",16),P.Kc(3,cC,1,0,"app-icon",17),P.hc(4,"async"),P.Ub(),P.Vb(5,"div",18),P.Qb(6,"app-icon",20),P.Vb(7,"span"),P.Mc(8),P.Ub(),P.Ub(),P.Ub(),P.Ub()}if(2&e){var i=t.$implicit,o=P.gc();P.Db(3),P.lc("ngIf",i.size===P.ic(4,4,o.brushSize$)),P.Db(3),P.Hc("font-size",i.size,"px"),P.Db(2),P.Nc(i.label)}}function uC(e,t){1&e&&P.Qb(0,"app-icon",19)}function pC(e,t){if(1&e){var n=P.Wb();P.Vb(0,"button",14),P.cc("click",(function(){P.zc(n);var e=t.$implicit;return P.gc().setEraserSize(e.size)})),P.Vb(1,"div",15),P.Vb(2,"div",16),P.Kc(3,uC,1,0,"app-icon",17),P.hc(4,"async"),P.Ub(),P.Vb(5,"div",18),P.Qb(6,"app-icon",20),P.Vb(7,"span"),P.Mc(8),P.Ub(),P.Ub(),P.Ub(),P.Ub()}if(2&e){var i=t.$implicit,o=P.gc();P.Db(3),P.lc("ngIf",i.size===P.ic(4,4,o.eraserSize$)),P.Db(3),P.Hc("font-size",i.size,"px"),P.Db(2),P.Nc(i.label)}}function dC(e,t){1&e&&P.Qb(0,"app-icon",19)}function gC(e,t){if(1&e){var n=P.Wb();P.Vb(0,"button",14),P.cc("click",(function(){P.zc(n);var e=t.$implicit;return P.gc().setBrushColor(e.color)})),P.Vb(1,"div",15),P.Vb(2,"div",16),P.Kc(3,dC,1,0,"app-icon",17),P.hc(4,"async"),P.Ub(),P.Vb(5,"div",18),P.Qb(6,"app-icon",20),P.Vb(7,"span"),P.Mc(8),P.Ub(),P.Ub(),P.Ub(),P.Ub()}if(2&e){var i=t.$implicit,o=P.gc();P.Db(3),P.lc("ngIf",i.color===P.ic(4,6,o.brushColor$)),P.Db(3),P.Hc("font-size",14,"px")("color",i.color),P.Db(2),P.Nc(i.label)}}var hC,fC=((hC=function(){function e(t){m(this,e),this.store=t,this.textSizes=su,this.brushSizes=au,this.brushColors=lu,this.eraserSizes=cu,this.modeEnum=iu,this.downloadClick=new P.p,this.clearClick=new P.p,this.exitClick=new P.p,this.ngUnsubscribe=new fe.a}return v(e,[{key:"ngOnInit",value:function(){}},{key:"ngAfterViewInit",value:function(){var e=this;this.brushColor$.pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){e.colorBtn.nativeElement.style.setProperty("--pin-button-pin-color",t)})),this.hasPaint$.pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){t||e.store.selectSnapshot(ku.getWhiteboardAnnotateMode)!==iu.Erase||e.handleModeSelect(iu.Paint)}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"setBrushSize",value:function(e){this.store.dispatch(new j.SetWhiteboardBrushSize(e))}},{key:"setBrushColor",value:function(e){this.store.dispatch(new j.SetWhiteboardBrushColor(e))}},{key:"setTextSize",value:function(e){this.store.dispatch(new j.SetWhiteboardTextSize(e))}},{key:"handleModeSelect",value:function(e){this.store.dispatch(new j.SetWhiteboardAnnotateMode(e))}},{key:"setEraserSize",value:function(e){this.store.dispatch(new j.SetWhiteboardEraserSize(e))}},{key:"handleDownloadClick",value:function(){this.downloadClick.next()}},{key:"handleClearClick",value:function(){this.clearClick.next()}},{key:"handleExitClick",value:function(){this.exitClick.next()}}]),e}()).\u0275fac=function(e){return new(e||hC)(P.Pb(E.g))},hC.\u0275cmp=P.Jb({type:hC,selectors:[["app-view-annotate-tools"]],viewQuery:function(e,t){var n;1&e&&P.Gc(rC,!0,P.m),2&e&&P.uc(n=P.dc())&&(t.colorBtn=n.first)},outputs:{downloadClick:"downloadClick",clearClick:"clearClick",exitClick:"exitClick"},decls:31,vars:26,consts:[["gaCategory","View Whiteboard Tools",1,"view-annotate-tools"],["eventCategory","View Whiteboard Tools","name","Whiteboard","padding","dense",3,"canExit","exit"],["app-pin-button","","buttonType","ghost","icon","text-size","aria-label","Text","matTooltip","Text",1,"mr-1",3,"matMenuTriggerFor","selected","click"],["app-pin-button","","buttonType","ghost","icon","paint-brush","aria-label","Brush","matTooltip","Brush",1,"mr-1",3,"matMenuTriggerFor","selected","click"],["app-pin-button","","buttonType","ghost","icon","eraser","aria-label","Eraser","matTooltip","Eraser",3,"matMenuTriggerFor","selected","disabled","click"],["app-pin-button","","buttonType","ghost","icon","tint","aria-label","Color","matTooltip","Color",3,"matMenuTriggerFor"],["colorBtn",""],["app-pin-button","","buttonType","ghost","icon","download","aria-label","Download","matTooltip","Download",3,"click"],["app-pin-button","","buttonType","ghost","aria-label","Clear","matTooltip","Clear",3,"disabled","click"],["textSizeMenu","matMenu"],["mat-menu-item","",3,"click",4,"ngFor","ngForOf"],["brushSizeMenu","matMenu"],["eraserSizeMenu","matMenu"],["brushColorMenu","matMenu"],["mat-menu-item","",3,"click"],[1,"flex","flex-row","items-center","justify-end"],[1,"view-annotate-tools__check"],["class","mr-2","icon","check",4,"ngIf"],[1,"view-annotate-tools__label"],["icon","check",1,"mr-2"],["icon","circle",1,"mr-2"]],template:function(e,t){if(1&e&&(P.Vb(0,"div",0),P.Vb(1,"app-pillbox",1),P.cc("exit",(function(){return t.handleExitClick()})),P.Vb(2,"button",2),P.cc("click",(function(){return t.handleModeSelect(t.modeEnum.Text)})),P.hc(3,"async"),P.Ub(),P.Vb(4,"button",3),P.cc("click",(function(){return t.handleModeSelect(t.modeEnum.Paint)})),P.hc(5,"async"),P.Ub(),P.Vb(6,"button",4),P.cc("click",(function(){return t.handleModeSelect(t.modeEnum.Erase)})),P.hc(7,"async"),P.hc(8,"async"),P.Ub(),P.Qb(9,"app-pillbox-divider"),P.Qb(10,"button",5,6),P.Qb(12,"app-pillbox-divider"),P.Vb(13,"button",7),P.cc("click",(function(){return t.handleDownloadClick()})),P.Ub(),P.Qb(14,"app-pillbox-divider"),P.Vb(15,"button",8),P.cc("click",(function(){return t.handleClearClick()})),P.hc(16,"async"),P.hc(17,"async"),P.Mc(18," Clear "),P.Ub(),P.Vb(19,"mat-menu",null,9),P.Kc(21,sC,8,4,"button",10),P.Ub(),P.Vb(22,"mat-menu",null,11),P.Kc(24,lC,9,6,"button",10),P.Ub(),P.Vb(25,"mat-menu",null,12),P.Kc(27,pC,9,6,"button",10),P.Ub(),P.Vb(28,"mat-menu",null,13),P.Kc(30,gC,9,8,"button",10),P.Ub(),P.Ub(),P.Ub()),2&e){var n=P.vc(20),i=P.vc(23),o=P.vc(26),r=P.vc(29);P.Db(1),P.lc("canExit",!0),P.Db(1),P.lc("matMenuTriggerFor",n)("selected",P.ic(3,14,t.mode$)===t.modeEnum.Text),P.Db(2),P.lc("matMenuTriggerFor",i)("selected",P.ic(5,16,t.mode$)===t.modeEnum.Paint),P.Db(2),P.lc("matMenuTriggerFor",o)("selected",P.ic(7,18,t.mode$)===t.modeEnum.Erase)("disabled",!P.ic(8,20,t.hasPaint$)),P.Db(4),P.lc("matMenuTriggerFor",r),P.Db(5),P.lc("disabled",!P.ic(16,22,t.hasPaint$)&&!P.ic(17,24,t.hasText$)),P.Db(6),P.lc("ngForOf",t.textSizes),P.Db(3),P.lc("ngForOf",t.brushSizes),P.Db(3),P.lc("ngForOf",t.eraserSizes),P.Db(3),P.lc("ngForOf",t.brushColors)}},directives:[Ce.a,px,vg,mg.c,hl.d,ax,hl.a,ra.k,hl.b,ra.l,nl],pipes:[ra.b],styles:[".view-annotate-tools__check{flex:2 1 0;color:#0060c4}.view-annotate-tools__label{display:flex;flex:6 1 0}"],encapsulation:2,changeDetection:0}),iC([Object(E.d)(ku.getWhiteboardAnnotateMode),oC("design:type",be.a)],hC.prototype,"mode$",void 0),iC([Object(E.d)(ku.getWhiteboardBrushSize),oC("design:type",be.a)],hC.prototype,"brushSize$",void 0),iC([Object(E.d)(ku.getWhiteboardTextSize),oC("design:type",be.a)],hC.prototype,"textSize$",void 0),iC([Object(E.d)(ku.getWhiteboardBrushColor),oC("design:type",be.a)],hC.prototype,"brushColor$",void 0),iC([Object(E.d)(ku.getWhiteboardEraserSize),oC("design:type",be.a)],hC.prototype,"eraserSize$",void 0),iC([Object(E.d)(ku.getWhiteboardHasPaint),oC("design:type",be.a)],hC.prototype,"hasPaint$",void 0),iC([Object(E.d)(ku.getWhiteboardHasText),oC("design:type",be.a)],hC.prototype,"hasText$",void 0),hC),bC=["textRef"];function vC(e,t){if(1&e){var n=P.Wb();P.Vb(0,"div"),P.Vb(1,"div",4),P.cc("cdkDragMoved",(function(e){return P.zc(n),P.gc().dragMoved(e,"corner1")})),P.Ub(),P.Vb(2,"div",5),P.cc("cdkDragMoved",(function(e){return P.zc(n),P.gc().dragMoved(e,"corner2")})),P.Ub(),P.Vb(3,"div",6),P.cc("cdkDragMoved",(function(e){return P.zc(n),P.gc().dragMoved(e,"corner3")})),P.Ub(),P.Vb(4,"div",7),P.cc("cdkDragMoved",(function(e){return P.zc(n),P.gc().dragMoved(e,"corner4")})),P.Ub(),P.Vb(5,"div",8),P.cc("cdkDragMoved",(function(e){return P.zc(n),P.gc().translateHandleMoved(e)})),P.Ub(),P.Ub()}if(2&e){var i=P.gc();P.Db(1),P.lc("cdkDragFreeDragPosition",i.dragHandles.corner1),P.Db(1),P.lc("cdkDragFreeDragPosition",i.dragHandles.corner2),P.Db(1),P.lc("cdkDragFreeDragPosition",i.dragHandles.corner3),P.Db(1),P.lc("cdkDragFreeDragPosition",i.dragHandles.corner4),P.Db(1),P.lc("cdkDragFreeDragPosition",i.dragHandles.translate)}}var mC,yC=function(e){return{"whiteboard-label__label--active":e}},xC=((mC=function(){function e(t,n){var i=this;m(this,e),this.changeDetectorRef=t,this.renderer=n,this.active=!0,this.initialized=!1,this.labelActive=new P.p,this.labelEmpty=new P.p,this.dragHandles={translate:{x:0,y:0},corner1:{x:0,y:0},corner2:{x:0,y:0},corner3:{x:0,y:0},corner4:{x:0,y:0}},this.handleCoords={translate:{x:0,y:0},corner1:{x:0,y:0},corner2:{x:0,y:0},corner3:{x:0,y:0},corner4:{x:0,y:0}},this.textareaTransform={x:0,y:0,width:110,height:40},this.handleDocumentBackspace=function(e){var t=i.textRef.nativeElement.activeElement;"Backspace"===e.key&&i.active&&!t&&i.deleteLabel()},this.handleTextboxMouseDown=function(e){i.active=!0,i.labelActive.next(i.id),i.refreshHandles()},this.handleDocumentMouseDown=function(e){var t=e.target.className.includes("view-annotate__canvas"),n=e.target.className.includes("whiteboard-label__label"),o=e.target.dataset.id===i.id;i.isLabelEmpty()&&!o&&i.initialized?i.deleteLabel():(t||n&&!o)&&(i.active=!1,i.changeDetectorRef.markForCheck())},this.handleTextKeyDown=function(e){if(e.stopPropagation(),i.isLabelEmpty()&&"Backspace"===e.key)i.deleteLabel();else{var t=i.textRef.nativeElement.scrollHeight,n=i.handleCoords,o=n.corner1,r=n.corner3,a=n.corner4,s=o.y+t;i.handleCoords.corner3=Object.assign(Object.assign({},r),{y:s}),i.handleCoords.corner4=Object.assign(Object.assign({},a),{y:s}),i.dragHandles.corner3=Object.assign({},i.handleCoords.corner3),i.dragHandles.corner4=Object.assign({},i.handleCoords.corner4),i.updateTextarea(),i.changeDetectorRef.markForCheck()}}}return v(e,[{key:"id",get:function(){return this._id},set:function(e){this._id=e,this.initialized=!1}},{key:"color",set:function(e){this.renderer.setStyle(this.textRef.nativeElement,"color",e)}},{key:"exporting",set:function(e){e&&(this.active=!1,this.labelActive.next(void 0))}},{key:"size",set:function(e){this.renderer.setStyle(this.textRef.nativeElement,"font-size",e+"px")}},{key:"ngOnInit",value:function(){var e=this;this.initHandles(),this.initInteractionListeners(),setTimeout((function(){e.textRef.nativeElement.focus(),e.initialized=!0}))}},{key:"ngOnDestroy",value:function(){this.textRef.nativeElement.removeEventListener("keydown",this.handleTextKeyDown),this.textRef.nativeElement.removeEventListener("mousedown",this.handleTextboxMouseDown),this.mouseDownListener(),this.backspaceListener()}},{key:"initHandles",value:function(){this.textareaTransform.x=this.initialPos.x,this.textareaTransform.y=this.initialPos.y;var e=this.textareaTransform,t=e.x,n=e.y,i=e.width,o=e.height;this.dragHandles.corner1={x:t,y:n},this.dragHandles.corner2={x:t+i,y:n},this.dragHandles.corner3={x:t+i,y:n+o},this.dragHandles.corner4={x:t,y:n+o},this.dragHandles.translate={x:t+i/2,y:n+-10},this.handleCoords.corner1=Object.assign({},this.dragHandles.corner1),this.handleCoords.corner2=Object.assign({},this.dragHandles.corner2),this.handleCoords.corner3=Object.assign({},this.dragHandles.corner3),this.handleCoords.corner4=Object.assign({},this.dragHandles.corner4),this.handleCoords.translate=Object.assign({},this.dragHandles.translate),this.updateTextarea()}},{key:"initInteractionListeners",value:function(){this.mouseDownListener=this.renderer.listen("document","mousedown",this.handleDocumentMouseDown),this.backspaceListener=this.renderer.listen("document","keydown",this.handleDocumentBackspace),this.textRef.nativeElement.addEventListener("mousedown",this.handleTextboxMouseDown),this.textRef.nativeElement.addEventListener("keydown",this.handleTextKeyDown)}},{key:"refreshHandles",value:function(){this.dragHandles.corner1=Object.assign({},this.handleCoords.corner1),this.dragHandles.corner2=Object.assign({},this.handleCoords.corner2),this.dragHandles.corner3=Object.assign({},this.handleCoords.corner3),this.dragHandles.corner4=Object.assign({},this.handleCoords.corner4),this.dragHandles.translate=Object.assign({},this.handleCoords.translate),this.changeDetectorRef.markForCheck()}},{key:"isLabelEmpty",value:function(){return""===this.textRef.nativeElement.innerText||"\n"===this.textRef.nativeElement.innerText}},{key:"deleteLabel",value:function(){this.labelEmpty.next(this.id)}},{key:"updateTextarea",value:function(){var e=this.handleCoords,t=e.corner1,n=e.corner2,i=e.corner3;this.textareaTransform.x=t.x,this.textareaTransform.y=t.y,this.textareaTransform.width=n.x-t.x,this.textareaTransform.height=i.y-n.y,this.renderer.setStyle(this.textRef.nativeElement,"transform","translate(".concat(this.textareaTransform.x,"px, ").concat(this.textareaTransform.y,"px)")),this.renderer.setStyle(this.textRef.nativeElement,"width",this.textareaTransform.width+"px"),this.renderer.setStyle(this.textRef.nativeElement,"height",this.textareaTransform.height+"px")}},{key:"updateTranslateHandle",value:function(){var e=this.handleCoords,t=e.corner1,n=e.corner2;this.handleCoords.translate={x:(n.x-t.x)/2+t.x,y:t.y+-10},this.dragHandles.translate=Object.assign({},this.handleCoords.translate)}},{key:"setHandle",value:function(e,t,n){this.handleCoords[e]=Object.assign(Object.assign({},this.handleCoords[e]),u({},t,n[t])),this.dragHandles[e]=Object.assign({},this.handleCoords[e])}},{key:"addDiffToHandle",value:function(e,t){this.handleCoords[e]={x:this.handleCoords[e].x+t.x,y:this.handleCoords[e].y+t.y},this.dragHandles[e]=Object.assign({},this.handleCoords[e])}},{key:"translateHandleMoved",value:function(e){var t=e.source._dragRef.getFreeDragPosition(),n={x:t.x-this.handleCoords.translate.x,y:t.y-this.handleCoords.translate.y};this.handleCoords.translate=Object.assign({},t),this.addDiffToHandle("corner1",n),this.addDiffToHandle("corner2",n),this.addDiffToHandle("corner3",n),this.addDiffToHandle("corner4",n),this.updateTextarea()}},{key:"dragMoved",value:function(e,t){var n=e.source._dragRef.getFreeDragPosition();this.handleCoords[t]=Object.assign({},n),"corner1"===t&&(this.setHandle("corner2","y",n),this.setHandle("corner4","x",n)),"corner2"===t&&(this.setHandle("corner1","y",n),this.setHandle("corner3","x",n)),"corner3"===t&&(this.setHandle("corner2","x",n),this.setHandle("corner4","y",n)),"corner4"===t&&(this.setHandle("corner1","x",n),this.setHandle("corner3","y",n)),this.updateTranslateHandle(),this.updateTextarea()}}]),e}()).\u0275fac=function(e){return new(e||mC)(P.Pb(P.i),P.Pb(P.H))},mC.\u0275cmp=P.Jb({type:mC,selectors:[["app-view-annotate-label"]],viewQuery:function(e,t){var n;1&e&&P.Gc(bC,!0),2&e&&P.uc(n=P.dc())&&(t.textRef=n.first)},inputs:{id:"id",initialPos:"initialPos",color:"color",exporting:"exporting",size:"size"},outputs:{labelActive:"labelActive",labelEmpty:"labelEmpty"},decls:4,vars:5,consts:[[1,"whiteboard-label"],[4,"ngIf"],["contenteditable","true","data-placeholder","Type..",1,"whiteboard-label__label",3,"ngClass"],["textRef",""],["cdkDrag","",1,"whiteboard-label__handle","whiteboard-label__handle--top-left",3,"cdkDragFreeDragPosition","cdkDragMoved"],["cdkDrag","",1,"whiteboard-label__handle","whiteboard-label__handle--top-right",3,"cdkDragFreeDragPosition","cdkDragMoved"],["cdkDrag","",1,"whiteboard-label__handle","whiteboard-label__handle--bottom-right",3,"cdkDragFreeDragPosition","cdkDragMoved"],["cdkDrag","",1,"whiteboard-label__handle","whiteboard-label__handle--bottom-left",3,"cdkDragFreeDragPosition","cdkDragMoved"],["cdkDrag","",1,"whiteboard-label__handle","whiteboard-label__handle--move",3,"cdkDragFreeDragPosition","cdkDragMoved"]],template:function(e,t){1&e&&(P.Vb(0,"div",0),P.Kc(1,vC,6,5,"div",1),P.Qb(2,"div",2,3),P.Ub()),2&e&&(P.Db(1),P.lc("ngIf",!0===t.active),P.Db(1),P.lc("ngClass",P.oc(3,yC,!0===t.active)),P.Eb("data-id",t.id))},directives:[ra.l,ra.i,Mr.a],styles:['.whiteboard-label[_ngcontent-%COMP%]{position:relative;z-index:1000}.whiteboard-label__handle[_ngcontent-%COMP%]{position:fixed;z-index:10;width:32px;height:32px;left:-16px;top:-16px}.whiteboard-label__handle[_ngcontent-%COMP%]:after{content:"";position:absolute;width:12px;height:12px;left:10px;top:10px;border-radius:50%;background-color:#0060c4}.whiteboard-label__handle[_ngcontent-%COMP%]:hover{cursor:pointer}.whiteboard-label__handle--top-left[_ngcontent-%COMP%]:hover{cursor:nw-resize}.whiteboard-label__handle--top-right[_ngcontent-%COMP%]:hover{cursor:ne-resize}.whiteboard-label__handle--bottom-right[_ngcontent-%COMP%]:hover{cursor:se-resize}.whiteboard-label__handle--bottom-left[_ngcontent-%COMP%]:hover{cursor:sw-resize}.whiteboard-label__handle--move[_ngcontent-%COMP%]:hover{cursor:move}.whiteboard-label__label[_ngcontent-%COMP%]{box-sizing:border-box;position:absolute;border:none;padding:5px;overflow-y:hidden}.whiteboard-label__label--active[_ngcontent-%COMP%]{box-shadow:inset 0 0 0 1px #0060c4}.whiteboard-label__label[_ngcontent-%COMP%]:focus{outline:none}.whiteboard-label__label[_ngcontent-%COMP%]:empty:before{content:attr(data-placeholder);color:rgba(55,74,104,.5)}'],changeDetection:0}),mC),kC=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},wC=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},OC=["drawCanvas"],CC=["annotateWrapper"];function SC(e,t){if(1&e){var n=P.Wb();P.Vb(0,"app-view-annotate-label",7),P.cc("labelActive",(function(e){return P.zc(n),P.gc().handleLabelActive(e)}))("labelEmpty",(function(e){return P.zc(n),P.gc().handleLabelEmpty(e)})),P.hc(1,"async"),P.Ub()}if(2&e){var i=t.$implicit,o=P.gc();P.Hb("view-annotate__label--clickthrough",P.ic(1,7,o.annotateMode$)!==o.whiteboardAnnotateMode.Text),P.lc("exporting",o.exporting)("id",i.id)("initialPos",i.pos)("color",i.color)("size",i.size)}}var _C,jC,PC,MC=vn.PNG,IC=((_C=function(){function e(t,n,i,o,r,a){m(this,e),this.store=t,this.actions=n,this.viewService=i,this.clipboardService=o,this.changeRef=r,this.engineService=a,this.whiteboardAnnotateMode=iu,this.labels=[],this.exporting=!1,this.brushSize=0,this.eraserSize=0,this.lineWidth=0,this.ngUnsubscribe=new fe.a}return v(e,[{key:"initTextModeListener",value:function(){var e=this;this.inputManager=new Hammer.Manager(this.drawCanvas.nativeElement),this.inputManager.add(new Hammer.Tap({event:"tap"})),this.inputManager.on("tap",(function(t){if(e.activeLabelId)e.activeLabelId=void 0;else{e.engineService.fireEvent(Dt.NativeDebugMessage,"add label");var n=Object(Se.uniqueId)();e.engineService.fireEvent(Dt.NativeDebugMessage,"labelId "+n);var i=t.center.x,o=t.center.y;void 0!==t.pointers[0].x&&(i=t.pointers[0].x,o=t.pointers[0].y);var r=e.store.selectSnapshot(ku.getWhiteboardBrushColor),a=e.store.selectSnapshot(ku.getWhiteboardTextSize);e.labels.push({id:n,pos:{x:i,y:o},color:r,size:a}),e.activeLabelId=n,e.changeRef.markForCheck(),e.dispatchHasText()}}))}},{key:"handleLabelActive",value:function(e){this.activeLabelId=e;var t=this.labels.find((function(t){return t.id===e}));t&&this.store.dispatch([new j.SetWhiteboardTextSize(t.size),new j.SetWhiteboardBrushColor(t.color)])}},{key:"handleLabelEmpty",value:function(e){this.labels=this.labels.filter((function(t){return t.id!==e})),this.changeRef.markForCheck(),this.dispatchHasText()}},{key:"dispatchHasText",value:function(){this.store.dispatch(new j.SetWhiteboardHasText(this.labels.length>0))}},{key:"ngOnInit",value:function(){var e=this;this.canvasElement=this.drawCanvas.nativeElement,this.canvasContext=this.canvasElement.getContext("2d"),this.siteHeader=this.store.selectSnapshot(Wp.getSiteHeader),this.store.dispatch(new Vu.SetHeader(Bp.Hide)),this.brushColor$.pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){var n=e.labels.find((function(t){return t.id===e.activeLabelId}));n&&(n.color=t,e.changeRef.markForCheck())})),this.textSize$.pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){var n=e.labels.find((function(t){return t.id===e.activeLabelId}));n&&(n.size=t,e.changeRef.markForCheck())})),this.annotateMode$.pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){e.inputManager&&e.inputManager.destroy(),t===iu.Paint?(e.canvasContext.globalCompositeOperation="source-over",e.setLineWidth(e.brushSize),e.initInputListeners()):t===iu.Text?e.initTextModeListener():t===iu.Erase&&(e.canvasContext.globalCompositeOperation="destination-out",e.setLineWidth(e.eraserSize),e.initInputListeners())}))}},{key:"ngAfterViewInit",value:function(){this.initCanvasListeners()}},{key:"ngOnDestroy",value:function(){this.inputManager.destroy(),this.reset(),this.store.dispatch(new Vu.SetHeader(this.siteHeader)),this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initCanvasListeners",value:function(){var e=this;this.brushSize$.pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){e.setBrushSize(t)})),this.brushColor$.pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){e.setBrushColor(t)})),this.eraserSize$.pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){e.setEraserSize(t)})),this.syncCanvas()}},{key:"initInputListeners",value:function(){var e=this;this.inputManager=new Hammer.Manager(this.drawCanvas.nativeElement),this.inputManager.add(new Hammer.Pan({event:"pan",pointers:0})),this.inputManager.add(new Hammer.Tap({event:"tap"}));var t=new Map;this.inputManager.on("tap",(function(t){t.pointers.forEach((function(n){if(void 0!==n.x){var i=n.x,o=n.y;e.drawPoint(i,o)}else{var r=t.center,a=r.x,s=r.y;e.drawPoint(a,s)}e.checkCanvasPaint()}))})),this.inputManager.on("panstart",(function(e){e.pointers.forEach((function(n){if(void 0===n.x)t.set(1,e.center);else{var i=n.x,o=n.y;t.set(n.pointerId,{x:i,y:o})}}))})),this.inputManager.on("pan",(function(n){n.pointers.forEach((function(i){var o=n.center.x,r=n.center.y,a=1;void 0!==i.pointerId&&(o=i.x,r=i.y,a=i.pointerId);var s=t.get(a),c=s.x,l=s.y;e.drawLine(c,l,o,r),e.drawPoint(o,r),t.set(a,{x:o,y:r})}))})),this.inputManager.on("panend",(function(){t.clear(),e.checkCanvasPaint()}))}},{key:"handleResetClick",value:function(){this.reset()}},{key:"handleDownloadClick",value:function(){var e=this;this.exporting=!0,this.changeRef.detectChanges();var t=this.canvasElement,n=t.width,i=t.height,o=this.store.selectSnapshot(Lr.getSelectedChapterId);this.store.dispatch(new Wn(o,MC,100,{width:n,height:i},"original",!0,!0,[this.annotateElement.nativeElement])).pipe(Object(rr.a)((function(){return e.actions.pipe(Object(E.j)($n),Object(Ou.a)(1))})),Object(ve.a)(this.ngUnsubscribe),Object(se.a)((function(){e.exporting=!1,e.changeRef.markForCheck()}))).subscribe((function(t){e.downloadSnapshot(t.blob)}))}},{key:"handleExitClick",value:function(){this.resetCanvas(),this.viewService.toggleWhiteboard(!1)}},{key:"checkCanvasPaint",value:function(){var e=this.canvasContext.getImageData(0,0,this.canvasElement.width,this.canvasElement.height),t=new Uint32Array(e.data.buffer).some((function(e){return 0!==e}));this.store.dispatch(new j.SetWhiteboardHasPaint(t))}},{key:"drawPoint",value:function(e,t){var n=this.lineWidth/2,i=2*Math.PI;this.canvasContext.beginPath(),this.canvasContext.arc(e,t,n,0,i),this.canvasContext.fill()}},{key:"drawLine",value:function(e,t,n,i){this.canvasContext.beginPath(),this.canvasContext.moveTo(e,t),this.canvasContext.lineTo(n,i),this.canvasContext.stroke(),this.canvasContext.closePath()}},{key:"reset",value:function(){this.resetCanvas(),this.labels=[],this.changeRef.markForCheck(),this.dispatchHasText()}},{key:"setBrushSize",value:function(e){this.brushSize=e,this.setLineWidth(e)}},{key:"setBrushColor",value:function(e){this.canvasContext.fillStyle=e,this.canvasContext.strokeStyle=e}},{key:"setEraserSize",value:function(e){this.eraserSize=e,this.setLineWidth(e)}},{key:"setLineWidth",value:function(e){this.canvasContext.lineWidth=e,this.lineWidth=e}},{key:"syncCanvas",value:function(){var e=this.store.selectSnapshot(ku.getWhiteboardBrushSize),t=this.store.selectSnapshot(ku.getWhiteboardBrushColor),n=this.store.selectSnapshot(ku.getWhiteboardEraserSize),i=this.getScreenDimensions(),o=i.width,r=i.height;this.canvasElement.width=o,this.canvasElement.height=r,this.setBrushSize(e),this.setBrushColor(t),this.setEraserSize(n),this.canvasContext.lineJoin="round"}},{key:"resetCanvas",value:function(){var e=this.canvasElement,t=e.width,n=e.height;this.canvasContext.clearRect(0,0,t,n),this.store.dispatch(new j.SetWhiteboardHasPaint(!1))}},{key:"downloadSnapshot",value:function(e){var t=this,n=this.store.selectSnapshot(Hs.getStory).displayName,i="".concat((n||"").replace(/ /g,"_").replace(/\W/g,"").toLowerCase(),"_drawing.").concat(MC===vn.PNG?"png":"jpg");!0===U.native||U.platform===T.SDK?zo.blobToBase64(e).pipe(Object(rr.a)((function(e){return t.clipboardService.copyToClipboard(e,"image")})),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(e){})):zo.exportImage(e,MC,i)}},{key:"getScreenDimensions",value:function(){var e=window;return{width:e.innerWidth,height:e.innerHeight}}}]),e}()).\u0275fac=function(e){return new(e||_C)(P.Pb(E.g),P.Pb(E.b),P.Pb(td),P.Pb(il),P.Pb(P.i),P.Pb(Nt))},_C.\u0275cmp=P.Jb({type:_C,selectors:[["app-view-annotate"]],viewQuery:function(e,t){var n;1&e&&(P.Gc(OC,!0),P.Gc(CC,!0)),2&e&&(P.uc(n=P.dc())&&(t.drawCanvas=n.first),P.uc(n=P.dc())&&(t.annotateElement=n.first))},decls:10,vars:15,consts:[[1,"view-annotate"],["annotateWrapper",""],["class","view-annotate__label",3,"view-annotate__label--clickthrough","exporting","id","initialPos","color","size","labelActive","labelEmpty",4,"ngFor","ngForOf"],["data-test","drawCanvas",1,"view-annotate__canvas"],["drawCanvas",""],[1,"view-annotate__tools"],[3,"clearClick","downloadClick","exitClick"],[1,"view-annotate__label",3,"exporting","id","initialPos","color","size","labelActive","labelEmpty"]],template:function(e,t){1&e&&(P.Vb(0,"div",0,1),P.hc(2,"async"),P.hc(3,"async"),P.hc(4,"async"),P.Kc(5,SC,2,9,"app-view-annotate-label",2),P.Qb(6,"canvas",3,4),P.Vb(8,"div",5),P.Vb(9,"app-view-annotate-tools",6),P.cc("clearClick",(function(){return t.handleResetClick()}))("downloadClick",(function(){return t.handleDownloadClick()}))("exitClick",(function(){return t.handleExitClick()})),P.Ub(),P.Ub(),P.Ub()),2&e&&(P.Hb("view-annotate--exporting",t.exporting)("view-annotate--cursor-paint",P.ic(2,9,t.annotateMode$)===t.whiteboardAnnotateMode.Paint)("view-annotate--cursor-erase",P.ic(3,11,t.annotateMode$)===t.whiteboardAnnotateMode.Erase)("view-annotate--cursor-text",P.ic(4,13,t.annotateMode$)===t.whiteboardAnnotateMode.Text),P.Db(5),P.lc("ngForOf",t.labels))},directives:[ra.k,fC,xC],pipes:[ra.b],styles:[".view-annotate{position:fixed;top:0;left:0;right:0;bottom:0;z-index:20;display:flex;flex-direction:column;align-items:center;justify-content:space-between;box-shadow:inset 0 0 0 4px #38de38;padding:8px;transition:border .3s linear}.view-annotate--exporting{box-shadow:none}.view-annotate--exporting .view-annotate__tools{display:none}.view-annotate--cursor-paint:hover{cursor:url(/assets/images/cursor-whiteboard-paint.svg) 7 20,pointer}.view-annotate--cursor-erase:hover{cursor:url(/assets/images/cursor-whiteboard-erase.svg) 7 20,pointer}.view-annotate--cursor-text:hover{cursor:url(/assets/images/cursor-whiteboard-text.svg) 7 20,pointer}.view-annotate__label{position:absolute;top:0;left:0;z-index:10}.view-annotate__label--clickthrough{pointer-events:none}.view-annotate__canvas{position:fixed;top:0;left:0;right:0;bottom:0;z-index:1}.view-annotate__tools{z-index:1;right:8px;bottom:8px;position:absolute}"],encapsulation:2,changeDetection:0}),kC([Object(E.d)(ku.getWhiteboardAnnotateMode),wC("design:type",be.a)],_C.prototype,"annotateMode$",void 0),kC([Object(E.d)(ku.getWhiteboardBrushSize),wC("design:type",be.a)],_C.prototype,"brushSize$",void 0),kC([Object(E.d)(ku.getWhiteboardBrushColor),wC("design:type",be.a)],_C.prototype,"brushColor$",void 0),kC([Object(E.d)(ku.getWhiteboardTextSize),wC("design:type",be.a)],_C.prototype,"textSize$",void 0),kC([Object(E.d)(ku.getWhiteboardEraserSize),wC("design:type",be.a)],_C.prototype,"eraserSize$",void 0),_C),zC=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},TC=((jC=function(){function e(t,n){m(this,e),this.store=t,this.changeDetectorRef=n,this.ngUnsubscribe=new fe.a,this.visible=!1}return v(e,[{key:"beforePrint",value:function(e){this.visible=!0,this.changeDetectorRef.markForCheck()}},{key:"afterPrint",value:function(e){this.visible=!1,this.changeDetectorRef.markForCheck()}},{key:"ngOnInit",value:function(){this.initImageUrlListener()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initImageUrlListener",value:function(){var e=this;Object(Gr.b)(this.storyChapters$,this.store.select(Lr.getRegisteredThumbnails)).pipe(Object(me.a)((function(e){var t=p(e,2),n=t[0],i=t[1];return n.length>0&&i.size>0})),Object(Z.a)((function(e){var t=p(e,2),n=t[0];return t[1].get(n[0].id).urls.large})),Object(Xr.a)(),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){e.imageUrl=t,e.changeDetectorRef.markForCheck()}))}}]),e}()).\u0275fac=function(e){return new(e||jC)(P.Pb(E.g),P.Pb(P.i))},jC.\u0275cmp=P.Jb({type:jC,selectors:[["app-view-print"]],hostBindings:function(e,t){1&e&&P.cc("beforeprint",(function(){return t.beforePrint()}),!1,P.yc)("afterprint",(function(){return t.afterPrint()}),!1,P.yc)},decls:3,vars:1,consts:[[1,"view-print"],["src","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=",1,"view-print__scrim"],[1,"view-print__image",3,"src"]],template:function(e,t){1&e&&(P.Vb(0,"div",0),P.Qb(1,"img",1),P.Qb(2,"img",2),P.Ub()),2&e&&(P.Db(2),P.lc("src",t.imageUrl,P.Cc))},styles:[".view-print[_ngcontent-%COMP%]{background-color:#fff;display:none;position:absolute;top:0;left:0;width:100%;height:100%;z-index:10000;justify-content:space-around;margin:auto;margin-top:0!important}@media print{.view-print[_ngcontent-%COMP%]{display:flex}}.view-print__scrim[_ngcontent-%COMP%]{display:block;width:100%;height:100%;position:absolute;z-index:-1;top:0;right:0;bottom:0;left:0}.view-print__image[_ngcontent-%COMP%]{display:block;flex:1 1 auto;-o-object-fit:contain;object-fit:contain;margin:0 auto;z-index:1}"],changeDetection:0}),function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);r>3&&a&&Object.defineProperty(t,n,a)}([Object(E.d)(Lr.getStoryChapters),zC("design:type",be.a)],jC.prototype,"storyChapters$",void 0),jC),UC=function e(){m(this,e)},LC={label:"Relevance",fields:[],ascending:!0},DC={label:"Most Recent",fields:["collection_content_createdate","update_date_time","create_date_time"],ascending:!1},EC={label:"Title (A-Z)",fields:["title"],ascending:!0},FC={label:"Title (Z-A)",fields:["title"],ascending:!1},AC={label:"Author (A-Z)",fields:["author"],ascending:!0},RC={label:"Author (Z-A)",fields:["author"],ascending:!1},VC=function(e){return e.Enabled="enabled",e.Disabled="disabled",e.Locked="locked",e}({}),NC=function e(){m(this,e),this.background={colors:null},this.uiAnnotations=!1,this.uiAudio=!1,this.uiInfo=!0,this.uiFullscreen=!0,this.uiScrubber=!1,this.uiHelp=!0,this.uiBd="",this.loadRotate=null,this.initial={button:!1,handHint:!1,play:!1},this.disableScroll={alert:!1,overlay:!1},this.uiQuiz={mode:VC.Enabled,number:void 0},this.autoLoad=!0,this.uiTour=!1,this.uiNav=!0,this.uiSearch=!0,this.uiTools=!0,this.uiUndo=!0,this.uiLabelList=!0,this.uiChapterList=!1,this.all=!1,this.collapseLabel=null,this.uiMenu=!0,this.uiAnatomyDescriptions=!1,this.uiTutorial=!1,this.uiLegend=!0,this.uiLoader=uc,this.uiWhiteboard=!0,this.uiVisibilityLayers=!0,this.uiAnatomyLabels=!0},BC={title:"Desktop",type:"desktop",dimensions:{width:700,height:550},orientation:"vertical"},HC=h("P6Fj"),QC=function(e){return e.Single="share.widget.link",e.Bulk="share.widget.export",e}({}),qC={headers:new K.d({"Content-Type":"application/json; charset=utf-8"})},WC=new NC,$C={id:"embedded-human",dimensions:BC.dimensions,fullScreen:!0},KC=((PC=function(){function e(t,n,i){m(this,e),this.http=t,this.cameraService=n,this.numberService=i}return v(e,[{key:"exportModels",value:function(e,t,n,i,o,r){var a=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=[{label:"Title",field:"title"},{label:"URL",field:"url"},{label:"iFrame",field:"iFrame"},{label:"Author",field:"author"},{label:"Thumbnail URL",field:"thumbnail_url"},{label:"Created Date",field:"create_date_time"},{label:"Updated Date",field:"update_date_time"}];return a&&s.push({label:"Offline Package URL",field:"offline_url"}),this.getExportModels(e,t,n,i,o,r,a).pipe(Object(rr.a)((function(e){return function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=new HC.a,o=[];return n&&o.push(t.map((function(e){return e.label}))),e.forEach((function(e){var n=t.map((function(t){return e[t.field]}));o.push(n)})),new be.a((function(e){var t=i.unparse(o,{quotes:!0,header:!1});e.next(t),e.complete()}))}(e,s)})),Object(Z.a)((function(e){var t="BioDigital-Widgets-".concat((new Date).toISOString().split("T")[0],"-export.csv"),n=new Blob([e],{type:"text/csv;charset=utf-8"});return Object(ur.saveAs)(n,t),!0})))}},{key:"getExportModels",value:function(e,t,n,i,o,r){var a=this,s=arguments.length>6&&void 0!==arguments[6]&&arguments[6],c=r?Object(G.a)(null):this.getUAID(QC.Bulk),l=s?this.getDownloadURLs(e):Object(G.a)([]);return Object(Qa.a)(c,l).pipe(Object(Z.a)((function(s){var c=p(s,2),l=c[0],u=c[1];return e.map((function(e,s){var c=e.title,p=e.author,d=e.thumbnail_url,g=e.create_date_time,h=e.update_date_time,f=a.getWidgetURL(e,t,n,null,l,o,r),b=a.getWidgetEmbed(f,i),v=a.buildThumbnailURL(d),m=u[s]||"";return{title:c,url:f,iFrame:b,author:p,thumbnail_url:v,create_date_time:Object(ra.u)(new Date(g),"shortDate","en"),update_date_time:Object(ra.u)(new Date(h),"shortDate","en"),offline_url:m}}))})))}},{key:"generateWidgetURL",value:function(e,t,n,i,o,r,a){var s=this;return(a||!o?Object(G.a)(null):this.getUAID(o)).pipe(Object(Z.a)((function(o){return s.getWidgetURL(e,t,n,i,o,r,a)})))}},{key:"getWidgetURL",value:function(e,t,n,i,o){var r=this,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"en",s=arguments.length>6?arguments[6]:void 0;n=n||WC;var c="bookmark"===e.type,l={};l[c?"be":"m"]=""+(c?e.id:e.module_name);var u=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},l),this.getParamsForUIOptions(n||WC)),this.getParamsForLoadingExperience(n||WC)),this.getParamsForScrollMode(n||WC)),this.getParamsForLoadRotate(n||WC)),this.getParamsForLabelScale(n||WC)),p=Object(Se.get)(n,"background.colors");if(Array.isArray(p)&&p.length>=3){var d=p.slice(0,4).map((function(e){return r.numberService.roundNumber(e,3)}));u["background.colors"]=""+d}if(i){var g=this.cameraService.roundCamera(i,3),h=g.eye,f=g.look,b=g.up;u.camera=""+[h.x,h.y,h.z,f.x,f.y,f.z,b.x,b.y,b.z]}s?u.dk=s.app_apikey:o&&(u.uaid=o),a&&"en"!==a&&(u.lang=a);var v=this.isCustomWidget(e.embed_url_path)?e.embed_url_path:t;return this.buildWidgetURL(v,u)}},{key:"generateWidgetEmbed",value:function(e,t,n,i,o,r,a,s){var c=this;return this.generateWidgetURL(e,t,n,o,r,a,s).pipe(Object(Z.a)((function(e){return c.getWidgetEmbed(e,i)})))}},{key:"getWidgetEmbed",value:function(e,t){var n=t||$C.dimensions,i=n.width,o=n.height;return'<iframe\n  id="'.concat($C.id,'"\n  frameBorder="0"\n  width="').concat(i,'"\n  height="').concat(o,'"\n  allowFullScreen="').concat($C.fullScreen,'"\n  loading="lazy"\n  src="').concat(e,'">\n</iframe>')}},{key:"getImageEmbed",value:function(e,t,n){var i=("BioDigital Human: "+e).replace(/"/g,"&quot;");return'<a href="'.concat(t,'" target="_blank"><img src="').concat(n,'" alt="').concat(i,'" title="').concat(i,'" /></a>')}},{key:"getUAID",value:function(e){return this.http.post("/ws/user/analytics",{analytic_type:""+e,analytic_platform:"app"},qC).pipe(Object(Z.a)((function(e){return e.id})))}},{key:"getDownloadURLs",value:function(e){var t=this,n=e.filter((function(e){return!e.favorite&&!e.unavailable})).map((function(e){return{type:e.type,id:"module"===e.type?e.module_name:e.id}}));return this.http.post("/ws/download/reserve",{content:n},{headers:{"Content-Type":"application/json"}}).pipe(Object(Z.a)((function(n){var i=n.tokens;return e.map((function(e){var n=e.type,o="module"===e.type?e.module_name:e.id,r=i.find((function(e){return e.type===n&&e.id===o}));return r&&r.token?t.buildDownloadURL(r.token):""}))})),Object(J.a)((function(){return Object(G.a)(e.map((function(){return""})))})))}},{key:"extendWidgetOptions",value:function(e,t){var n=this.expandWidgetOptions(t);return this.deepExtendWidgetOptions(e,n),e}},{key:"getWidgetConfig",value:function(e){var t=this,n={};return Object.keys(e).forEach((function(i){var o=e[i];if(null!==o){var r=t.getConfigName(i);n[r]=o}})),n}},{key:"getConfigName",value:function(e){var t=this.camelToDashCase(e).replace(/^ui-/g,"");return this.dashCaseToCamelCase(t)}},{key:"getParamsForLoadingExperience",value:function(e){return e.autoLoad?e.initial.button?{"initial.button":!0}:e.initial.handHint?{"initial.hand":!0}:e.initial.play?{"initial.play":!0}:{}:{"auto-load":!1}}},{key:"getParamsForScrollMode",value:function(e){return e.disableScroll.alert?{"disable-scroll.alert":!0}:e.disableScroll.overlay?{"disable-scroll":!0}:{"disable-scroll":!1}}},{key:"getParamsForLoadRotate",value:function(e){return"number"==typeof e.loadRotate?{"load-rotate":e.loadRotate}:{}}},{key:"getParamsForLabelScale",value:function(e){return{}}},{key:"getParamsForUIOptions",value:function(e){return Object.assign({"ui-info":e.uiInfo,"ui-search":e.uiSearch,"ui-undo":e.uiUndo,"ui-fullscreen":e.uiFullscreen,"ui-nav":e.uiNav,"ui-tools":e.uiTools,"ui-help":e.uiHelp,"ui-chapter-list":e.uiChapterList,"ui-label-list":e.uiLabelList,"ui-anatomy-descriptions":e.uiAnatomyDescriptions,"ui-tutorial":e.uiTutorial,"ui-loader":e.uiLoader,"ui-whiteboard":e.uiWhiteboard,"ui-layers":e.uiVisibilityLayers,"ui-anatomy-labels":e.uiAnatomyLabels},this.getParamsForUIQuiz(e))}},{key:"getParamsForUIQuiz",value:function(e){var t={},n=Object(Se.get)(e,"uiQuiz.mode"),i=Object(Se.get)(e,"uiQuiz.number");return n===VC.Disabled&&(t["ui-quiz"]=!1),n===VC.Locked&&(t["ui-quiz-locked"]=!0),Object(Se.isNil)(i)||(t["ui-quiz-start"]=i,t["ui-quiz-end"]=i),t}},{key:"camelToDashCase",value:function(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}},{key:"dashCaseToCamelCase",value:function(e){return e.replace(/-([a-z])/g,(function(e){return e[1].toUpperCase()}))}},{key:"isCustomWidget",value:function(e){return/widgets\/([^\/]+)\//.test(e)}},{key:"saveUserImage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"jpeg";return this.http.post("/ws/user/image/v1-0",{image_src:e,image_type:t},qC).pipe(Object(Z.a)((function(e){return e.url})))}},{key:"buildWidgetURL",value:function(e,t){var n=Object.entries(t).map((function(e){var t=p(e,2),n=t[0],i=t[1];return"".concat(n,"=").concat(i)})).join("&"),i=e.replace(/^\/|\/$/g,"");return U.deploy===z.Local?"https://localhost:4202/?"+n:"".concat(window.location.origin,"/").concat(i,"/?").concat(n)}},{key:"buildThumbnailURL",value:function(e){return"".concat(window.location.origin).concat(e)}},{key:"buildDownloadURL",value:function(e){return"".concat(window.location.origin,"/download?t=").concat(e)}},{key:"deepExtendWidgetOptions",value:function(e,t){var n=this;Object.entries(e).forEach((function(i){var o=p(i,2),r=o[0],a=o[1],s=typeof a;[r,n.camelToDashCase(r),n.getConfigName(r)].forEach((function(i){if(t.hasOwnProperty(i)&&null!==t[i]){var o=t[i],c=typeof o;null===a?e[r]=o:s===c&&("object"===s?n.deepExtendWidgetOptions(a,o):e[r]=o)}}))}))}},{key:"expandWidgetOptions",value:function(e){var t={};return Object.entries(e).forEach((function(n){var i=p(n,2),o=i[0],r=i[1],a=o.split(".");if(a.length>1){var s=a[0],c=a.slice(1).join(".");null!==t[s]&&"object"==typeof t[s]||(t[s]={}),t[s][c]=r}else t[o]=e[o]})),t}}]),e}()).\u0275fac=function(e){return new(e||PC)(P.Zb(K.b),P.Zb(gn),P.Zb(dn))},PC.\u0275prov=P.Lb({token:PC,factory:PC.\u0275fac,providedIn:"root"}),PC),GC=function e(){m(this,e)},ZC=function(e){return e.AssignRole="assignRole",e.RemoveUser="removeUser",e.TransferContent="transferContent",e.CreateCollection="createCollection",e.DeleteCollection="deleteCollection",e.EditTeamBookmarks="editTeamBookmarks",e.EditAllTeamBookmarks="editAllTeamBookmarks",e.AddTeamBookmarks="addTeamBookmarks",e.RemoveTeamBookmarks="removeTeamBookmarks",e.EditBookmarks="editBookmarks",e.PublishBookmarks="publishBookmarks",e.SavePrivateBookmarks="savePrivateBookmarks",e.CopyUrl="copyURL",e.ViewBookmarks="viewBookmarks",e.InviteUsers="inviteUsers",e}({}),JC=function(e){return e.Admin="admin",e.Creator="creator",e.Viewer="viewer",e}({}),XC=[ZC.InviteUsers,ZC.ViewBookmarks,ZC.CopyUrl,ZC.SavePrivateBookmarks,ZC.PublishBookmarks],YC=[].concat(XC,[ZC.EditBookmarks,ZC.RemoveTeamBookmarks,ZC.AddTeamBookmarks,ZC.EditTeamBookmarks]),eS=[].concat(c(YC),[ZC.EditAllTeamBookmarks,ZC.CreateCollection,ZC.TransferContent,ZC.RemoveUser,ZC.AssignRole]),tS={role_id:void 0,role_name:JC.Creator,role_display_name:"",role_description:"",permissions:c(YC)},nS=(u(k={},JC.Viewer,XC),u(k,JC.Creator,YC),u(k,JC.Admin,eS),k),iS=(u(w={},JC.Viewer,"Can view team content and edit personal content"),u(w,JC.Creator,"Can edit and view team content"),u(w,JC.Admin,"Can manage team settings and edit all content"),w);function oS(e){var t,n=Object(Se.get)(e,"role_name",tS.role_name),i=Object(Se.get)(e,"role_description",iS[n]),o=Object(Se.get)(e,"permissions",void 0);return Object.assign(Object.assign({},e),{role_description:i,permissions:Object(Se.isNil)(o)?(t=n,nS[t]||[]):o})}var rS,aS="/ws/enterprise/collection",sS=((rS=function(){function e(t,n){m(this,e),this.http=t,this.bookmarkService=n}return v(e,[{key:"getOrganizationUsers",value:function(e){var t=Object.entries(e).filter((function(e){var t=p(e,2),n=(t[0],t[1]);return!Object(Se.isNil)(n)})).map((function(e){var t=p(e,2),n=t[0],i=t[1];return"".concat(n,"=").concat(encodeURIComponent(i))})).join("&");return this.http.get("/ws/enterprise/users?"+t).pipe(Object(Z.a)((function(e){return e.users})),Object(Z.a)((function(e){return e.map((function(e){return Object.assign(Object.assign({},e),{user_role:oS(e.user_role)})}))})))}},{key:"sendOrganizationInvites",value:function(e,t){return this.http.post("/ws/enterprise/invite",{group_eid:e,invite_emails:JSON.stringify(t)}).pipe(Object(Z.a)((function(e){var t=e.results_summary.messages;return JSON.parse(t)})))}},{key:"getCollections",value:function(e){var t=this;return this.http.get("".concat(aS,"?group_id=").concat(e)).pipe(Object(Z.a)((function(e){return Object(te.plainToClass)(GC,e).map((function(e){return t.normalizeCollectionModel(e)}))})))}},{key:"getCollectionsByContent",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3?arguments[3]:void 0;if(i&&!o)throw new Error("collectionId must be included when includeContent is set to true");var r=t.content_type,a=t.content_id,s="".concat(aS,"?group_id=").concat(e,"&content_type=").concat(r,"&content_id=").concat(a,"&include_content=").concat(i?1:0);return i&&(s="".concat(s,"&collection_id=").concat(o)),this.http.get(s).pipe(Object(Z.a)((function(e){return Object(te.plainToClass)(GC,e).map((function(e){return n.normalizeCollectionModel(e)}))})))}},{key:"getCollectionContentId",value:function(e,t){var n=t.content_type,i=t.content_id;return this.getCollectionsByContent(e.group_id,t,!0,e.collection_id).pipe(Object(Z.a)((function(t){return t.find((function(t){return t.collection_id===e.collection_id}))})),Object(Z.a)((function(e){var t;return e&&(t=e.collection_content.find((function(e){return"module"===n?i===e.module_name:i===e.id}))),t?t.collection_content_id:null})))}},{key:"getCollection",value:function(e,t,n){var i=this;return this.http.get("".concat(aS,"?group_id=").concat(e,"&collection_id=").concat(t,"&include_content=").concat(n?1:0)).pipe(Object(Z.a)((function(e){var t=e[0];return t?i.normalizeCollectionModel(t):t})))}},{key:"getCollectionContent",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=n.toLocaleLowerCase().split(" ");return this.getCollection(e,t,!0).pipe(Object(Z.a)((function(e){return e.collection_content.map((function(e){return Object(te.plainToClass)(yw,e)})).filter((function(e){var t=!0;return i.length&&e.title&&i.forEach((function(n){t=t&&e.title.toLocaleLowerCase().indexOf(n)>=0})),t=t&&!0!==e.unavailable}))})))}},{key:"addToCollection",value:function(e,t){var n=this;return this.formPost(aS,{group_id:e.group_id,collection_id:e.collection_id,add_content:t}).pipe(Object(Z.a)((function(e){return e.map((function(e){return n.normalizeCollectionModel(e)}))})))}},{key:"removeFromCollection",value:function(e,t){var n=this;return this.formPost(aS,{group_id:e.group_id,collection_id:e.collection_id,remove_content:t}).pipe(Object(Z.a)((function(e){return e.map((function(e){return n.normalizeCollectionModel(e)}))})))}},{key:"getOrganizationAttribute",value:function(e,t,n){return e.find((function(e){return e.type===t&&e.name===n}))}},{key:"addUserToOrganization",value:function(e){return this.http.post("/ws/enterprise/user/add",{group_eid:e})}},{key:"addUserWithGroupCode",value:function(e){return this.http.post("/ws/enterprise/user/add",{group_code:e}).pipe(Object(Z.a)((function(e){return e.organization_name})))}},{key:"updateUserRoles",value:function(e,t){return this.http.post("/ws/enterprise/users",{group_id:e,update_users:t.map((function(e){return{user_id:e.userId,role_id:e.roleId}}))}).pipe(Object(Z.a)((function(){return!0})))}},{key:"removeUsers",value:function(e,t){var n=this;return this.http.post("/ws/enterprise/users",{group_id:e,remove_users:t.map((function(e){return n.createTransferRequest(e)}))}).pipe(Object(Z.a)((function(){return!0})))}},{key:"transferUserContent",value:function(e,t){var n=this;return this.http.post("/ws/enterprise/bookmark/transfer",{group_id:e,transfer_bookmarks:t.map((function(e){return n.createTransferRequest(e)}))})}},{key:"createTransferRequest",value:function(e){var t=e.sourceUserId,n=e.targetUserId;return"number"==typeof n?{user_id:t,group_bookmarks:{transfer_ownership:1,transfer_user_id:n}}:{user_id:t}}},{key:"normalizeCollectionModel",value:function(e){var t=this;return e.collection_content&&e.collection_content.forEach((function(e){t.bookmarkService.normalizeBookmarkModel(e)})),e}},{key:"formPost",value:function(e,t){var n={headers:new K.d({"Content-Type":"application/x-www-form-urlencoded"})},i=new URLSearchParams;return Object.keys(t).forEach((function(e){var n=t[e],o=""+(n instanceof Object?JSON.stringify(n):n);i.set(e,o)})),this.http.post(""+e,i.toString(),n).pipe(Object(Z.a)((function(e){return e})))}}]),e}()).\u0275fac=function(e){return new(e||rS)(P.Zb(K.b),P.Zb(zw))},rS.\u0275prov=P.Lb({token:rS,factory:rS.\u0275fac,providedIn:"root"}),rS);function cS(e,t,n){var i=t.map((function(t){return e[t]})).filter((function(e){return!Object(Se.isNil)(e)}));return n?i.sort().shift():i.sort().pop()}function lS(e,t,n){if(0===t.length)return e;var i=new Intl.Collator("en-US",{sensitivity:"base"});return e.sort((function(e,o){var r=cS(e,t,n)||"",a=cS(o,t,n)||"";return(n?1:-1)*i.compare(r.toString(),a.toString())}))}var uS,pS=function e(){m(this,e)},dS=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},gS=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},hS=function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function a(e){try{c(i.next(e))}catch(t){r(t)}}function s(e){try{c(i.throw(e))}catch(t){r(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))},fS={loading:!0,exporting:!1,copying:!1,saving:!1,bookmarks:[],selectedBookmark:null,sort:DC,checkedBookmarks:[],selectedCategory:null},bS=((uS=function(){function e(t,n,i,o,r,a,s,c,l){m(this,e),this.store=t,this.actions=n,this.bookmarksService=i,this.storyService=o,this.exploreService=r,this.publishService=a,this.organizationsService=s,this.snackbar=c,this.pendoService=l}return v(e,[{key:"loadBookmarks",value:function(e,t){e.patchState({loading:!0,bookmarks:[],checkedBookmarks:[]}),Object(Qa.a)(this.bookmarksService.getPrivateBookmarks(t.query),this.bookmarksService.getPrivateConditions(t.query),this.bookmarksService.getFavorites()).pipe(Object(se.a)((function(){e.patchState({loading:!1})}))).subscribe((function(t){var n=p(t,3),i=n[0],o=n[1],r=n[2];e.dispatch(new rp([].concat(c(i),c(o),c(r))))}))}},{key:"loadOrganizationBookmarks",value:function(e,t){var n=t.organizationId;e.patchState({loading:!0,bookmarks:[],checkedBookmarks:[]}),this.bookmarksService.getOrganizationContent(n).pipe(Object(se.a)((function(){e.patchState({loading:!1})}))).subscribe((function(t){e.dispatch(new rp(t))}))}},{key:"loadCollectionBookmarks",value:function(e,t){e.patchState({loading:!0,bookmarks:[],checkedBookmarks:[]}),this.organizationsService.getCollectionContent(t.organizationId,t.collectionId).pipe(Object(se.a)((function(){e.patchState({loading:!1})}))).subscribe((function(t){e.dispatch(new rp(t))}))}},{key:"loadSuccess",value:function(e,t){(0,e.patchState)({bookmarks:t.result})}},{key:"loadBookmark",value:function(e,t){var n=t.id;("bookmark"===t.type?this.bookmarksService.getBookmarkModel(n):this.exploreService.getConditionModel(n)).subscribe((function(t){e.dispatch(new op(t))}))}},{key:"selectBookmarkSuccess",value:function(e,t){e.patchState({selectedBookmark:t.bookmark})}},{key:"saveBookmark",value:function(e,t){return hS(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,o,r,a,s,c,l=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i=t.bookmarkEntry,e.patchState({saving:!0}),r=this.store.selectSnapshot(Lr.getStoryChapters),a=!1===t.inplace,s=So.makeChapterIdMap(r,a),n.t0=a,!n.t0){n.next=7;break}return n.next=7,this.store.dispatch(new zi.UpdateTweenParticleLookupChapters(s)).toPromise();case 7:t.includeIndex&&(o=this.bookmarksService.createBookmarkStory(s),i.index=o.story),c=i.id?"update":"save",this.bookmarksService.saveBookmark(i).pipe(Object(se.a)((function(){e.patchState({saving:!1})}))).subscribe((function(n){if(t.includeIndex){var r=l.store.selectSnapshot(Lr.getRegisteredThumbnails);e.dispatch(new bp(c,n.id,i,r,Object(Se.invert)(s)))}var a=o?o.story:null;i.addCollection||i.removeCollection?(e.dispatch(new Sp(n,i.addCollection,i.removeCollection)),l.actions.pipe(Object(E.j)(_p,jp),Object(Ou.a)(1)).subscribe((function(){e.dispatch(new up(n,a,c))}))):e.dispatch(new up(n,a,c))}),(function(t){e.dispatch(new pp(i))})),this.pendoService.track("Bookmark Save - Start");case 10:case"end":return n.stop()}}),n,this)})))}},{key:"saveBookmarkSuccess",value:function(e,t){var n=t.bookmark,i=e.getState().bookmarks,o=i.findIndex((function(e){return e.id===n.id}));-1!==o&&(i[o]=n,e.patchState({bookmarks:c(i)})),"save"===t.method&&e.patchState({selectedBookmark:t.bookmark}),this.pendoService.track("Bookmark Save - Success")}},{key:"saveBookmarkFail",value:function(e,t){this.pendoService.track("Bookmark Save - Failure")}},{key:"deleteBookmark",value:function(e,t){var n=t.bookmarkId;this.bookmarksService.deleteBookmark(n).subscribe((function(){e.dispatch(new sp(n))}),(function(t){e.dispatch(new cp(n,t))}))}},{key:"deleteBookmarkSuccess",value:function(e,t){var n=e.getState().bookmarks.filter((function(e){return e.id!==t.bookmarkId}));e.patchState({bookmarks:c(n)}),this.snackbar.open("Successfully deleted 3D model")}},{key:"deleteFail",value:function(e,t){this.snackbar.open("There was an error deleting the 3D model")}},{key:"deleteFavorite",value:function(e,t){var n=t.bookmark,i=n.id,o=Object(Se.get)(n,"category","bookmark"),r="bookmark"===o?i:this.exploreService.toDatabaseContentId(i);this.bookmarksService.deleteFavorite(r,o).subscribe((function(){e.dispatch(new hp(i))}),(function(t){e.dispatch(new fp(i))}))}},{key:"deleteFavoriteSuccess",value:function(e,t){var n=e.getState().bookmarks.filter((function(e){return e.id!==t.bookmarkId}));e.patchState({bookmarks:c(n)}),this.snackbar.open("Successfully deleted 3D model")}},{key:"sortBookmarks",value:function(e,t){var n=e.getState().bookmarks;e.patchState({sort:t.sort,bookmarks:c(n)})}},{key:"clearBookmarks",value:function(e,t){e.patchState({bookmarks:[],checkedBookmarks:[]})}},{key:"resetBookmarks",value:function(e,t){e.setState(fS)}},{key:"checkBookmark",value:function(e,t){var n=e.getState().checkedBookmarks,i=n.some((function(e){return e===t.id}));t.checked&&!i?n=[].concat(c(n),[t.id]):t.checked||(n=n.filter((function(e){return e!==t.id}))),e.patchState({checkedBookmarks:n})}},{key:"setCheckedBookmarks",value:function(e,t){e.patchState({checkedBookmarks:t.ids})}},{key:"saveBookmarkThumbnails",value:function(e,t){var n=t.chapterIdMap,i=t.thumbnails,o=this.bookmarksService.saveBookmarkThumbnails(t.bookmarkId,t.bookmarkEntry,i,n);if("update"===t.method){var r,a=s(this.bookmarksService.deleteBookmarkThumbnails(t.bookmarkId,t.bookmarkEntry,i,n));try{for(a.s();!(r=a.n()).done;){var c=r.value;o.push(c)}}catch(l){a.e(l)}finally{a.f()}}Object(Qa.a)(o).subscribe((function(n){e.dispatch(new Qn(new Map)).subscribe((function(){e.dispatch(new Qn(t.thumbnails))}))}))}},{key:"exportBookmarks",value:function(e,t){var n=t.bookmarks,i=t.widgetURL,o=t.widgetOptions,r=t.offlineEnabled,a=o||new NC;e.patchState({exporting:!0}),this.publishService.exportModels(n,i,a,null,t.userLanguage,t.userApp,r).pipe(Object(se.a)((function(){e.patchState({exporting:!1})}))).subscribe((function(t){e.dispatch(t?new Op(n):new Cp(n))}))}},{key:"updateBookmarkCollection",value:function(e,t){var n=this,i=t.bookmark,o=t.addCollection,r=t.removeCollection,a={content_type:i.type,content_id:i.id},s=[];r&&s.push(this.organizationsService.getCollectionContentId(r,a).pipe(Object(me.a)((function(e){return!!e})),Object(rr.a)((function(e){return n.organizationsService.removeFromCollection(r,[e])})),Object(fn.a)((function(){return e.dispatch(new Ip(i,r))}),(function(){return e.dispatch(new zp(i,r))})))),o&&s.push(this.organizationsService.addToCollection(o,[a]).pipe(Object(fn.a)((function(){return e.dispatch(new Pp(i,r))}),(function(){return e.dispatch(new Mp(i,r))})))),Object(or.a).apply(void 0,s).subscribe((function(){return e.dispatch(new _p(i,o,r))}),(function(){return e.dispatch(new jp(i,o,r))}))}},{key:"removeBookmarkCollectionSuccess",value:function(e,t){var n=e.getState(),i=n.bookmarks;if("collection"===n.selectedCategory){var o=t.bookmark.id,r=i.filter((function(e){return e.id!==o}));e.patchState({bookmarks:c(r)})}}},{key:"copyBookmark",value:function(e,t){return hS(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,o,r,a,s,c,l,u,d,g,h,f;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=t.groupAccess,o=t.collection,e.patchState({copying:!0,saving:!0}),n.next=4,this.bookmarksService.copyBookmark(t.id,t.type,t.lang).toPromise().catch((function(n){e.dispatch(new Lp(t.id,n))}));case 4:if(a=n.sent){n.next=7;break}return n.abrupt("return",void e.dispatch(new Lp(t.id,null)));case 7:return n.next=9,Promise.all([this.storyService.getStory(t.id,t.type).toPromise(),this.storyService.getStory(a,I.Bookmark).toPromise()]);case 9:return s=n.sent,c=p(s,2),l=c[0],u=c[1],d=l.chapters.map((function(e){return e.id})).reduce((function(e,t,n){return e[t]=u.chapters[n].id,e}),{}),g=Object(Se.mapKeys)(u.tweenParticleLookup,(function(e,t){return d[t]})),u.tweenParticleLookup=g,(h=new pS).title=t.title,h.isOwner=!0,h.id=a,h.index=u,i&&(h.add_group_access=[i]),n.prev=18,n.next=21,this.bookmarksService.saveBookmark(h).toPromise();case 21:r=n.sent,n.next=31;break;case 24:if(n.prev=24,n.t0=n.catch(18),n.t1=403===Object(Se.get)(n.t0,"status"),!n.t1){n.next=31;break}return n.next=30,this.bookmarksService.getBookmarkModel(a).toPromise();case 30:r=n.sent;case 31:if(!i||!o){n.next=35;break}return f=[{content_type:"bookmark",content_id:a}],n.next=35,this.organizationsService.addToCollection(o,f).toPromise();case 35:e.patchState({copying:!1,saving:!1}),e.dispatch(new Up(a,t.id,r));case 36:case"end":return n.stop()}}),n,this,[[18,24]])})))}},{key:"setBookmarkText",value:function(e,t){var n=e.getState().selectedBookmark;e.patchState({selectedBookmark:Object.assign(Object.assign({},n),{title:t.title})})}},{key:"setSelectedCategory",value:function(e,t){var n=t.category;e.patchState({selectedCategory:n||null})}},{key:"cancelSaveBookmark",value:function(e,t){e.patchState({saving:!1})}},{key:"cancelCopyBookmark",value:function(e,t){e.patchState({copying:!1})}}],[{key:"getBookmarks",value:function(e){var t=e.bookmarks,n=e.sort,i=n.ascending;return lS(t,n.fields,i)}},{key:"getCheckedBookmarks",value:function(e){return e.checkedBookmarks}},{key:"getSelectedBookmark",value:function(e){return e.selectedBookmark}},{key:"getLoading",value:function(e){return e.loading}},{key:"getExporting",value:function(e){return e.exporting}},{key:"getSaving",value:function(e){return e.saving}},{key:"getCopying",value:function(e){return e.copying}},{key:"getSort",value:function(e){return e.sort}},{key:"getSelectedCategory",value:function(e){return e.selectedCategory}}]),e}()).\u0275fac=function(e){return new(e||uS)(P.Zb(E.g),P.Zb(E.b),P.Zb(zw),P.Zb(ns),P.Zb(jw),P.Zb(KC),P.Zb(sS),P.Zb(ol.b),P.Zb(je))},uS.\u0275prov=P.Lb({token:uS,factory:uS.\u0275fac}),dS([Object(E.a)(ep),gS("design:type",Function),gS("design:paramtypes",[Object,ep]),gS("design:returntype",void 0)],uS.prototype,"loadBookmarks",null),dS([Object(E.a)(tp),gS("design:type",Function),gS("design:paramtypes",[Object,tp]),gS("design:returntype",void 0)],uS.prototype,"loadOrganizationBookmarks",null),dS([Object(E.a)(np),gS("design:type",Function),gS("design:paramtypes",[Object,np]),gS("design:returntype",void 0)],uS.prototype,"loadCollectionBookmarks",null),dS([Object(E.a)(rp),gS("design:type",Function),gS("design:paramtypes",[Object,rp]),gS("design:returntype",void 0)],uS.prototype,"loadSuccess",null),dS([Object(E.a)(ip),gS("design:type",Function),gS("design:paramtypes",[Object,ip]),gS("design:returntype",void 0)],uS.prototype,"loadBookmark",null),dS([Object(E.a)(op),gS("design:type",Function),gS("design:paramtypes",[Object,op]),gS("design:returntype",void 0)],uS.prototype,"selectBookmarkSuccess",null),dS([Object(E.a)(lp),gS("design:type",Function),gS("design:paramtypes",[Object,lp]),gS("design:returntype",Promise)],uS.prototype,"saveBookmark",null),dS([Object(E.a)(up),gS("design:type",Function),gS("design:paramtypes",[Object,up]),gS("design:returntype",void 0)],uS.prototype,"saveBookmarkSuccess",null),dS([Object(E.a)(pp),gS("design:type",Function),gS("design:paramtypes",[Object,pp]),gS("design:returntype",void 0)],uS.prototype,"saveBookmarkFail",null),dS([Object(E.a)(ap),gS("design:type",Function),gS("design:paramtypes",[Object,ap]),gS("design:returntype",void 0)],uS.prototype,"deleteBookmark",null),dS([Object(E.a)(sp),gS("design:type",Function),gS("design:paramtypes",[Object,sp]),gS("design:returntype",void 0)],uS.prototype,"deleteBookmarkSuccess",null),dS([Object(E.a)([cp,fp]),gS("design:type",Function),gS("design:paramtypes",[Object,Object]),gS("design:returntype",void 0)],uS.prototype,"deleteFail",null),dS([Object(E.a)(gp),gS("design:type",Function),gS("design:paramtypes",[Object,gp]),gS("design:returntype",void 0)],uS.prototype,"deleteFavorite",null),dS([Object(E.a)(hp),gS("design:type",Function),gS("design:paramtypes",[Object,hp]),gS("design:returntype",void 0)],uS.prototype,"deleteFavoriteSuccess",null),dS([Object(E.a)(yp),gS("design:type",Function),gS("design:paramtypes",[Object,yp]),gS("design:returntype",void 0)],uS.prototype,"sortBookmarks",null),dS([Object(E.a)(mp),gS("design:type",Function),gS("design:paramtypes",[Object,mp]),gS("design:returntype",void 0)],uS.prototype,"clearBookmarks",null),dS([Object(E.a)(vp),gS("design:type",Function),gS("design:paramtypes",[Object,vp]),gS("design:returntype",void 0)],uS.prototype,"resetBookmarks",null),dS([Object(E.a)(xp),gS("design:type",Function),gS("design:paramtypes",[Object,xp]),gS("design:returntype",void 0)],uS.prototype,"checkBookmark",null),dS([Object(E.a)(kp),gS("design:type",Function),gS("design:paramtypes",[Object,kp]),gS("design:returntype",void 0)],uS.prototype,"setCheckedBookmarks",null),dS([Object(E.a)(bp),gS("design:type",Function),gS("design:paramtypes",[Object,bp]),gS("design:returntype",void 0)],uS.prototype,"saveBookmarkThumbnails",null),dS([Object(E.a)(wp),gS("design:type",Function),gS("design:paramtypes",[Object,wp]),gS("design:returntype",void 0)],uS.prototype,"exportBookmarks",null),dS([Object(E.a)(Sp),gS("design:type",Function),gS("design:paramtypes",[Object,Sp]),gS("design:returntype",void 0)],uS.prototype,"updateBookmarkCollection",null),dS([Object(E.a)(Ip),gS("design:type",Function),gS("design:paramtypes",[Object,Ip]),gS("design:returntype",void 0)],uS.prototype,"removeBookmarkCollectionSuccess",null),dS([Object(E.a)(Tp),gS("design:type",Function),gS("design:paramtypes",[Object,Tp]),gS("design:returntype",Promise)],uS.prototype,"copyBookmark",null),dS([Object(E.a)(Ep),gS("design:type",Function),gS("design:paramtypes",[Object,Ep]),gS("design:returntype",void 0)],uS.prototype,"setBookmarkText",null),dS([Object(E.a)(Fp),gS("design:type",Function),gS("design:paramtypes",[Object,Fp]),gS("design:returntype",void 0)],uS.prototype,"setSelectedCategory",null),dS([Object(E.a)(dp),gS("design:type",Function),gS("design:paramtypes",[Object,dp]),gS("design:returntype",void 0)],uS.prototype,"cancelSaveBookmark",null),dS([Object(E.a)(Dp),gS("design:type",Function),gS("design:paramtypes",[Object,Dp]),gS("design:returntype",void 0)],uS.prototype,"cancelCopyBookmark",null),dS([Object(E.e)(),gS("design:type",Function),gS("design:paramtypes",[UC]),gS("design:returntype",void 0)],uS,"getBookmarks",null),dS([Object(E.e)(),gS("design:type",Function),gS("design:paramtypes",[UC]),gS("design:returntype",void 0)],uS,"getCheckedBookmarks",null),dS([Object(E.e)(),gS("design:type",Function),gS("design:paramtypes",[UC]),gS("design:returntype",void 0)],uS,"getSelectedBookmark",null),dS([Object(E.e)(),gS("design:type",Function),gS("design:paramtypes",[UC]),gS("design:returntype",void 0)],uS,"getLoading",null),dS([Object(E.e)(),gS("design:type",Function),gS("design:paramtypes",[UC]),gS("design:returntype",void 0)],uS,"getExporting",null),dS([Object(E.e)(),gS("design:type",Function),gS("design:paramtypes",[UC]),gS("design:returntype",void 0)],uS,"getSaving",null),dS([Object(E.e)(),gS("design:type",Function),gS("design:paramtypes",[UC]),gS("design:returntype",void 0)],uS,"getCopying",null),dS([Object(E.e)(),gS("design:type",Function),gS("design:paramtypes",[UC]),gS("design:returntype",void 0)],uS,"getSort",null),dS([Object(E.e)(),gS("design:type",Function),gS("design:paramtypes",[UC]),gS("design:returntype",void 0)],uS,"getSelectedCategory",null),uS=dS([Object(E.f)({name:"bookmarks",defaults:fS})],uS)),vS=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function mS(e,t){if(1&e){var n=P.Wb();P.Vb(0,"div",1),P.Vb(1,"app-message-toggle",2),P.cc("handleDismiss",(function(){return P.zc(n),P.gc().handleDismiss()})),P.Vb(2,"div"),P.Mc(3," This model is not optimized for use on mobile devices. For an optimal experience, please switch to a desktop device or try our Anatomy by Regions. "),P.Ub(),P.Ub(),P.Ub()}2&e&&(P.Db(1),P.lc("dismiss",!0))}var yS,xS=((yS=function(){function e(t){m(this,e),this.changeRef=t,this.shown=!1,this.ngUnsubscribe=new fe.a}return v(e,[{key:"ngOnInit",value:function(){var e=this;this.bookmark$.pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){var n=Object(Se.get)(t,"tags",[]);e.shown=n.includes("complete anatomy"),e.changeRef.markForCheck()}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"handleDismiss",value:function(){this.shown=!1,this.changeRef.markForCheck()}}]),e}()).\u0275fac=function(e){return new(e||yS)(P.Pb(P.i))},yS.\u0275cmp=P.Jb({type:yS,selectors:[["app-view-content-warning"]],decls:2,vars:3,consts:[["class","warning",4,"ngIf"],[1,"warning"],["type","warning","toggleStyle","flat","icon","info-circle",3,"dismiss","handleDismiss"]],template:function(e,t){1&e&&(P.Kc(0,mS,4,1,"div",0),P.hc(1,"async")),2&e&&P.lc("ngIf",P.ic(1,1,t.bookmark$)&&t.shown)},directives:[ra.l,my],pipes:[ra.b],styles:[".warning{position:fixed;top:0;left:0;right:0;z-index:1001}.warning__text{text-align:center;flex:1}"],encapsulation:2,changeDetection:0}),function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);r>3&&a&&Object.defineProperty(t,n,a)}([Object(E.d)(bS.getSelectedBookmark),vS("design:type",be.a)],yS.prototype,"bookmark$",void 0),yS),kS=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},wS=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},OS=["engineContainer"],CS=["viewContainer"],SS=["view"],_S=["viewCameraBar"],jS=["viewLogo"],PS=["viewSceneBase"],MS=["viewToolbar"],IS=["drawer"];function zS(e,t){1&e&&P.Qb(0,"app-view-column-container")}function TS(e,t){1&e&&(P.Vb(0,"div",25),P.Qb(1,"app-view-title",26),P.Ub())}function US(e,t){if(1&e){var n=P.Wb();P.Vb(0,"div",27),P.Vb(1,"app-notification",28),P.cc("closeClick",(function(e){return P.zc(n),P.gc().handleNotificationClose(e)})),P.Ub(),P.Ub()}if(2&e){var i=P.gc();P.Db(1),P.lc("notification",i.notification)}}function LS(e,t){1&e&&(P.Vb(0,"div",29),P.Qb(1,"app-view-undo"),P.Ub())}function DS(e,t){1&e&&P.Qb(0,"app-view-toolbar",30)}function ES(e,t){1&e&&(P.Vb(0,"div",31),P.Qb(1,"app-view-menu",32),P.Ub())}function FS(e,t){if(1&e&&(P.Vb(0,"div",33),P.Qb(1,"app-view-logo",34),P.hc(2,"async"),P.Ub()),2&e){var n=P.gc();P.Db(1),P.lc("logoColor",n.isBackgroundLight?"color":"white")("logoSize",P.ic(2,2,n.breakpoint$)>n.breakpoint.Small?"full":"small")}}function AS(e,t){if(1&e&&P.Qb(0,"app-engine-camera-bar",35),2&e){var n=P.gc();P.lc("showNav",n.cameraVisible)}}function RS(e,t){if(1&e){var n=P.Wb();P.Tb(0),P.Vb(1,"app-view-drawer",36,37),P.cc("offsetYChange",(function(e){return P.zc(n),P.gc().handleDrawerOffsetChange(e)})),P.Ub(),P.Sb()}}function VS(e,t){1&e&&P.Qb(0,"div",38)}function NS(e,t){if(1&e&&(P.Qb(0,"app-view-help",39),P.hc(1,"async")),2&e){var n=P.gc();P.lc("activeTab",P.ic(1,1,n.showHelpTab$))}}function BS(e,t){if(1&e&&P.Qb(0,"app-view-ondemand",40),2&e){var n=P.gc();P.lc("contentId",n.contentId)("contentType",n.contentType)}}function HS(e,t){if(1&e&&(P.Qb(0,"app-view-progress",41),P.hc(1,"async")),2&e){var n=P.gc();P.lc("show",P.ic(1,2,n.viewWindow$)===n.viewWindow.Loader)("percent",n.loadProgress)}}function QS(e,t){if(1&e&&P.Qb(0,"app-play-loader",43),2&e){var n=P.gc(2);P.lc("percent",n.loadProgress)}}function qS(e,t){1&e&&P.Qb(0,"app-button-loader")}function WS(e,t){1&e&&P.Qb(0,"app-hand-loader")}function $S(e,t){if(1&e&&(P.Vb(0,"app-view-loader"),P.Kc(1,QS,1,1,"app-play-loader",42),P.hc(2,"async"),P.Kc(3,qS,1,0,"app-button-loader",3),P.hc(4,"async"),P.Kc(5,WS,1,0,"app-hand-loader",3),P.hc(6,"async"),P.Ub()),2&e){var n=P.gc();P.Db(1),P.lc("ngIf","play"===P.ic(2,3,n.interactType$)),P.Db(2),P.lc("ngIf","button"===P.ic(4,5,n.interactType$)),P.Db(2),P.lc("ngIf","hand"===P.ic(6,7,n.interactType$))}}function KS(e,t){1&e&&P.Qb(0,"app-view-tour")}function GS(e,t){1&e&&P.Qb(0,"app-view-annotate")}function ZS(e,t){1&e&&P.Qb(0,"app-view-print")}function JS(e,t){1&e&&P.Qb(0,"app-view-content-warning")}var XS,YS,e_=function(e,t,n){return{"view-page--column-in":e,"view-page--column-out":t,"view-page--drawer-push":n}},t_=((YS=function(){function e(t,n,i,o,r,a,s,c,l,u,p){m(this,e),this.activatedRoute=t,this.renderer=n,this.store=i,this.viewService=o,this.quizService=r,this.changeDetectorRef=a,this.actions=s,this.layoutService=c,this.engineService=l,this.pendoService=u,this.title=p,this.application=M,this.nativePlatform=fl,this.breakpoint=Nu,this.viewLayoutStatus=sc,this.viewMode=Cu,this.viewUI=$u,this.viewWindow=nu,this.columnLayoutStatus=sc.Hide,this.drawerExpandable=!0,this.drawerOpen=!1,this.drawerY=0,this.loadLabel="",this.loadProgress=0,this.chaptersLoaded=0,this.isBackgroundLight=!0,this.selectedChapterLoading=!1,this.viewToolsMode=ff,this.cameraVisible=!1,this.columnVisible=!1,this.drawerVisible=!1,this.logoVisible=!1,this.menuVisible=!1,this.nodeInfoVisible=!1,this.searchVisible=!1,this.titleOnlyVisible=!1,this.toolbarVisible=!1,this.undoVisible=!1,this.ngUnsubscribe=new fe.a,this.audioListening=new fe.a}return v(e,[{key:"onClick",value:function(e){this.handleFirstClickTracking(e)}},{key:"ngOnInit",value:function(){this.resetScene();var e=this.viewService.normalizeQueryParams(this.activatedRoute.snapshot.queryParams);this.contentId=e.id,this.contentType=e.type,this.contentLang=e.lang}},{key:"ngAfterViewInit",value:function(){this.initOnDemand(),this.store.dispatch(new ir({tag:!0,pin:!1})),this.store.dispatch(new rt(!0));var e=this.store.selectSnapshot(ku.getUI).loader.template;this.store.dispatch(new Ze(e===lc.Bar)),e!==lc.None&&this.store.dispatch(new j.ToggleWindow(nu.Loader,!0)),this.checkCapabilities(),this.initSizeObservers(),this.initHeaderObserver(),this.initLayoutObserver(),this.initBreakpointObservers(),this.initKeyboardObserver(),this.initLoadProgressObserver(),this.initWindowObserver(),this.initBackgroundColorObserver(),this.initResponsiveLabels(),this.initNodeObserver(),this.initChapterObserver(),this.initAudioObserver(),this.initNotifications(),this.initPendoEvents(),this.positionRelativeElements(this.drawerY)}},{key:"ngOnDestroy",value:function(){this.store.dispatch(new ze(!1)),this.store.dispatch(new qs),Ys.isFullscreen()&&Ys.exitFullscreen(),this.quizService.exitQuiz(),this.unbindKeyboard(),this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initOnDemand",value:function(){var e=this;this.onDemand$.pipe(Object(me.a)((function(e){return!e})),Object(Ou.a)(1),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(){e.viewService.initStory(e.contentId,e.contentType,e.contentLang)}))}},{key:"checkCapabilities",value:function(){var e=this,t=this.renderer.listen("window","mouseover",(function(){t(),e.store.dispatch(new j.SetCanHover(!0))})),n="ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0;this.store.dispatch(new j.SetCanTouch(n)),this.store.dispatch(new j.SetCanFullscreen(Ys.canFullscreen())),this.store.dispatch(new j.SetInputMode(n?hu.Touch:hu.Mouse))}},{key:"initBreakpointObservers",value:function(){var e=this;this.breakpoint$.pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(){e.handleResize()}))}},{key:"initResponsiveLabels",value:function(){var e=this,t=Object(Zr.a)(window,"resize").pipe(Object(Jr.a)(100)),n=this.store.select(ku.getLabelsBreakpoint),i=this.store.select(Is.getSelectedLabel),o=this.store.select(Is.getLabelsCollapsed);i.pipe(Object(me.a)((function(){return e.store.selectSnapshot(Is.getLabelsCollapsed)})),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){e.viewService.toggleLabelInfo(!!t)})),o.pipe(Object(me.a)((function(){return!!e.store.selectSnapshot(Is.getSelectedLabel)})),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){e.viewService.toggleLabelInfo(t)})),Object(Gr.b)(t,n).pipe(Object(me.a)((function(e){var t=p(e,2)[1];return!Object(Se.isNil)(t)})),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(){e.checkLabelsCollapsed()})),this.checkLabelsCollapsed()}},{key:"initSizeObservers",value:function(){var e=this,t=hf({strategy:"scroll"});Object(Zr.a)(window,"resize").pipe(Object(Jr.a)(10),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(){e.updateViewHeight(),e.refreshLayout()})),new be.a((function(n){t.listenTo(e.engineContainer.nativeElement,(function(){n.next()}))})).pipe(Object(Jr.a)(10)).subscribe((function(){e.resizeEngineContainer()}))}},{key:"initHeaderObserver",value:function(){var e=this;this.store.select(Wp.getSiteHeader).pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){e.updateViewHeight()}))}},{key:"initLayoutObserver",value:function(){var e=this;this.layout$.pipe(Object(me.a)((function(e){return null!=e})),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){e.refreshLayout()}))}},{key:"initKeyboardObserver",value:function(){var e=this;this.inputEnabled$.pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){t?e.bindKeyboard():e.unbindKeyboard()}))}},{key:"initNodeObserver",value:function(){var e=this;this.actions.pipe(Object(E.j)(Be),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){e.viewService.delegateNodeClick(t.node,t.event)})),this.store.select(Ai.getSelectedNode).pipe(Object(ta.a)(),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){var n=p(t,2),i=n[0],o=n[1],r=Object(Se.get)(i,"objectId",void 0),a=Object(Se.get)(o,"objectId",void 0);void 0!==o&&r===a||e.viewService.toggleNodeInfo(!1)}))}},{key:"initChapterObserver",value:function(){var e=this;this.store.select(Lr.getSelectedChapterId).pipe(Object(me.a)((function(e){return null!=e})),Object(Z.a)((function(){return e.store.selectSnapshot(Lr.getSelectedChapter)})),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){e.viewService.initChapter(t),e.setPageTitle(t),e.refreshLayout()}))}},{key:"initLoadProgressObserver",value:function(){var e=this;this.store.select(Xu.getChunkLoadProgress).pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){e.loadProgress=100*t,e.engineService.fireEvent(Dt.HumanProgress,{progress:e.loadProgress}),e.changeDetectorRef.markForCheck(),e.checkShowLoader()})),this.store.select(Hs.getLoadingChunk).pipe(Object(me.a)((function(){return null!=e.store.selectSnapshot(Lr.getSelectedChapterId)})),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){null!==t&&t.chapterId===e.store.selectSnapshot(Lr.getSelectedChapterId)||U.offline?e.store.dispatch(new j.ToggleWindow(nu.Loader,!0)):(e.engineService.enableRender(),e.store.dispatch(new j.ToggleWindow(nu.Loader,!1)),e.refreshLayout(),setTimeout((function(){e.engineService.enableAnimation()}),500))})),this.actions.pipe(Object(E.i)(La),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(){0===e.store.selectSnapshot(Hs.getLoadChunksRemaining).length&&(e.store.dispatch(new j.ToggleWindow(nu.Loader,!1)),U.offline)&&setTimeout((function(){e.engineService.enableAnimation()}),1750)}))}},{key:"checkShowLoader",value:function(){if(this.store.selectSnapshot(Lr.getSelectedChapterIndex)>0){var e=this.store.selectSnapshot(Lr.getSelectedChapterId),t=this.store.selectSnapshot(Hs.getLoadingChunk);null!==t&&e===t.chapterId&&this.store.dispatch(new j.ToggleWindow(nu.Loader,!0))}}},{key:"initWindowObserver",value:function(){var e=this;this.viewWindow$.pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){e.viewService.resetLayout(),t===nu.Tutorial?(e.viewService.resetChapter(),e.viewService.toggleLabels(!1)):e.viewService.toggleLabels(!0)}))}},{key:"initBackgroundColorObserver",value:function(){var e=this;this.background$.pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){if(t.colors){var n=t.colors.slice(0,3);e.isBackgroundLight=vr.isLight([n[0],n[1],n[2]]),e.changeDetectorRef.markForCheck()}}))}},{key:"initAudioObserver",value:function(){var e=this,t=Object(Kr.a)(this.ngUnsubscribe,this.audioListening),n=this.viewWindow$.pipe(Object(Z.a)((function(e){return e===nu.Tutorial||e===nu.Interact})),Object(me.a)((function(e){return e})),Object(Ou.a)(1));Object(Gr.b)(this.viewWindow$,n,this.audio$).pipe(Object(me.a)((function(e){var t=p(e,1)[0];return Object(Se.isNil)(t)})),Object(ve.a)(t)).subscribe((function(t){var n=p(t,3),i=n[1],o=n[2];i?Object(Se.isNil)(o)||e.playAudio():e.stopAudioListening()}))}},{key:"initNotifications",value:function(){this.notification=new Um("Welcome! Learn how to navigate and interact with this model in 3D.","Launch Tutorial")}},{key:"initPendoEvents",value:function(){var e=this,t=this.store.selectSnapshot(Hs.getStoryId);if("preview"!==t){var n={totalQuestions:0};this.store.select(_o.getQuestionTotal).pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(e){n.totalQuestions=e})),this.store.select(_o.getQuizModeActive).pipe(Object(me.a)((function(){return e.store.selectSnapshot(_o.getQuestionTotal)>0})),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){t&&e.pendoService.track("Quiz - Entered",n)})),this.actions.pipe(Object(E.j)(io.SubmitQuestionAnswer),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(){var t=e.store.selectSnapshot(_o.getActiveQuestionIndex),i=e.store.selectSnapshot(_o.getQuestionsRemaining);0===t&&e.pendoService.track("Quiz - First Question Answered",n),0===i&&e.pendoService.track("Quiz - Completed",n)})),this.actions.pipe(Object(E.i)(La),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(){if(0===e.store.selectSnapshot(Hs.getLoadChunksRemaining).length){var n=e.store.selectSnapshot(Hs.getStory);e.pendoService.trackOncePerPage("View - Loaded",{id:t,chapters:n.chapters.length,tour:n.tags.includes("tour"),animated:n.tags.includes("animated"),quiz:e.store.selectSnapshot(_o.hasQuiz),edit:!1})}}))}}},{key:"handleFirstClickTracking",value:function(e){e.composedPath().some((function(e){return"APP-SITE-HEADER"===e.nodeName}))||1===this.store.selectSnapshot(Xu.getStoryLoadProgress)&&this.pendoService.trackOncePerPage("First Click")}},{key:"handleNotificationClose",value:function(e){var t=e.action;"Launch Tutorial"===t&&this.viewService.toggleTutorial(!0),t||this.store.dispatch(new j.TutorialSeen(!0))}},{key:"stopAudioListening",value:function(){this.audioListening.next(),this.audioListening.complete()}},{key:"playAudio",value:function(){this.store.dispatch(new it(!0)),this.stopAudioListening()}},{key:"handleColumnToggle",value:function(){this.viewService.toggleColumn(),this.changeDetectorRef.markForCheck()}},{key:"handleDrawerOffsetChange",value:function(e){this.drawerY=e,this.drawerOpen=-64!==e,this.positionRelativeElements(this.drawerY)}},{key:"checkLabelsCollapsed",value:function(){var e=this.store.selectSnapshot(Wu.getBreakpoint),t=this.store.selectSnapshot(ku.getLabelsBreakpoint),n=this.isLabelBreaking(t);this.store.dispatch(new nr(n,e>=Nu.Large?Fo.Toggle:Fo.None))}},{key:"isLabelBreaking",value:function(e){return window.innerWidth<e}},{key:"bindKeyboard",value:function(){var e=this;gf.bind("1",(function(){return e.viewService.selectTool(Rr.Select)})),gf.bind("2",(function(){return e.viewService.selectTool(Rr.Hide)})),gf.bind("3",(function(){return e.viewService.selectTool(Rr.Fade)})),gf.bind(["command+,","ctrl+,"],(function(t){t.preventDefault(),e.store.selectSnapshot(Wu.getBreakpoint)>Nu.Medium?e.viewService.toggleColumn():e.drawer.toggleDrawer(),e.changeDetectorRef.markForCheck()})),gf.bind(["command+enter","ctrl+enter","command+p"],(function(e){e.preventDefault(),Ys.toggleFullscreen()})),gf.bind("meta+z",(function(t){t.preventDefault(),e.viewService.undo()})),gf.bind(["meta+y","meta+shift+z"],(function(t){t.preventDefault(),e.viewService.redo()})),gf.bind([".","pagedown"],(function(){return e.viewService.nextChapter("Keyboard")})),gf.bind([",","pageup"],(function(){return e.viewService.previousChapter("Keyboard")})),gf.bind(["del","backspace"],(function(t){t.preventDefault(),e.viewService.hideSelectedStructures()})),gf.bind("R",(function(t){t.preventDefault(),e.viewService.resetChapter()})),gf.bind("/",(function(){return e.viewService.toggleSearch()})),gf.bind("?",(function(){return e.viewService.toggleHelp()})),gf.bind("space",(function(t){t.preventDefault(),e.viewService.toggleAnimation()}))}},{key:"unbindKeyboard",value:function(){gf.reset()}},{key:"resizeEngineContainer",value:function(){var e=this.engineContainer.nativeElement.getBoundingClientRect(),t=e.top,n=e.left,i=e.width,o=e.height,r=new Bt(n,t,i,o,Ht.Shown);this.store.dispatch(new ut(r))}},{key:"updateViewHeight",value:function(){var e=this.viewService.getVH(U.application!==M.Viewer);this.view.nativeElement.style.setProperty("--vh",e+"px")}},{key:"handleResize",value:function(){this.viewService.resetLayout()}},{key:"resetScene",value:function(){var e=this;this.store.dispatch(new ze(!0)),this.store.dispatch(new Le(!1)),this.store.dispatch(new Xe(Rr.Select)),this.store.dispatch(new qs),this.engineService.getEvent(Dt.AssetsLoadProgress).pipe(Object(Ou.a)(1),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(){e.store.dispatch(new Le(!0))}))}},{key:"refreshLayout",value:function(){var e=this,t=this.store.selectSnapshot(ku.getUI);this.columnLayoutStatus=t.column.status,this.cameraVisible=this.layoutService.isVisible($u.Camera),this.columnVisible=this.layoutService.isVisible($u.Column),this.drawerVisible=this.layoutService.isVisible($u.Drawer),this.logoVisible=this.layoutService.isVisible($u.Logo),this.menuVisible=this.layoutService.isVisible($u.Menu),this.nodeInfoVisible=this.layoutService.isVisible($u.NodeInfo),this.searchVisible=this.layoutService.isVisible($u.Search),this.titleOnlyVisible=this.layoutService.isVisible($u.TitleOnly),this.toolbarVisible=this.layoutService.isVisible($u.Toolbar),this.undoVisible=this.layoutService.isVisible($u.Undo),this.updateViewHeight(),this.resizeEngineContainer(),this.store.dispatch(new Yo(!1!==t.anatomyLabels.enable,!1!==t.nodeInfo.enable,!0)),this.store.dispatch(new Je(!1!==t.labels.enable)),setTimeout((function(){e.drawer?e.positionRelativeElements(e.drawerY):e.positionRelativeElements(),e.changeDetectorRef.markForCheck()}))}},{key:"positionRelativeElements",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.store.selectSnapshot(Wu.getBreakpoint),null!=this.viewCameraBar&&this.cameraVisible&&this.renderer.setStyle(this.viewCameraBar.nativeElement,"transform","translate3d(-4px, ".concat(this.menuVisible?-64:0,"px, 0)")),this.renderer.setStyle(this.viewToolbar.nativeElement,"transform","translate3d(-8px, 0, 0)"),this.renderer.setStyle(this.viewSceneBase.nativeElement,"transform","translate3d(0, -8px, 0)"),this.renderer.setStyle(this.view.nativeElement,"padding-bottom",-e+"px")}},{key:"isVisible",value:function(e){return this.layoutService.isVisible(e)}},{key:"isEnabled",value:function(e){return this.layoutService.isUIEnabled(e)}},{key:"setPageTitle",value:function(e){var t=Object(Se.get)(e,"info.displayName");this.title.setTitle((t?t+" | ":"")+"BioDigital Human Platform")}}]),e}()).\u0275fac=function(e){return new(e||YS)(P.Pb(Oe.a),P.Pb(P.H),P.Pb(E.g),P.Pb(td),P.Pb(bf),P.Pb(P.i),P.Pb(E.b),P.Pb(Yu),P.Pb(Nt),P.Pb(je),P.Pb(L.c))},YS.\u0275cmp=P.Jb({type:YS,selectors:[["app-view-page"]],viewQuery:function(e,t){var n;1&e&&(P.Gc(OS,!0),P.Gc(CS,!0),P.Gc(SS,!0),P.Rc(_S,!0),P.Rc(jS,!0),P.Gc(PS,!0),P.Rc(MS,!0),P.Rc(IS,!0,Tm)),2&e&&(P.uc(n=P.dc())&&(t.engineContainer=n.first),P.uc(n=P.dc())&&(t.viewContainer=n.first),P.uc(n=P.dc())&&(t.view=n.first),P.uc(n=P.dc())&&(t.viewCameraBar=n.first),P.uc(n=P.dc())&&(t.viewLogo=n.first),P.uc(n=P.dc())&&(t.viewSceneBase=n.first),P.uc(n=P.dc())&&(t.viewToolbar=n.first),P.uc(n=P.dc())&&(t.drawer=n.first))},hostBindings:function(e,t){1&e&&P.cc("click",(function(e){return t.onClick(e)}),!1,P.xc)},decls:45,vars:47,consts:[["viewContainer",""],[1,"view-page",3,"ngClass"],["view",""],[4,"ngIf"],["class","view-page__title-only",4,"ngIf"],[1,"view-page__engine"],["engineContainer",""],["class","view-page__notifications",4,"ngIf"],["class","view-page__undo",4,"ngIf"],[1,"view-page__column-toggle"],[1,"view-page__scene-base"],["viewSceneBase",""],[1,"view-page__toolbar"],["viewToolbar",""],["position","right",4,"ngIf"],["class","view-page__menu",4,"ngIf"],["class","view-page__logo",4,"ngIf"],[1,"view-page__camera-bar"],["viewCameraBar",""],[3,"showNav",4,"ngIf"],["class","view-block-input",4,"ngIf"],[3,"activeTab",4,"ngIf"],[3,"contentId","contentType",4,"ngIf"],[3,"show","percent",4,"ngIf"],[4,"appFlagApplication","appFlagApplicationMode","appFlagApplicationNative"],[1,"view-page__title-only"],["layout","column"],[1,"view-page__notifications"],[3,"notification","closeClick"],[1,"view-page__undo"],["position","right"],[1,"view-page__menu"],[1,"ml-4"],[1,"view-page__logo"],[3,"logoColor","logoSize"],[3,"showNav"],[3,"offsetYChange"],["drawer",""],[1,"view-block-input"],[3,"activeTab"],[3,"contentId","contentType"],[3,"show","percent"],[3,"percent",4,"ngIf"],[3,"percent"]],template:function(e,t){if(1&e&&(P.Vb(0,"div",null,0),P.Vb(2,"div",1,2),P.Kc(4,zS,1,0,"app-view-column-container",3),P.Qb(5,"app-view-menu-column"),P.Kc(6,TS,2,0,"div",4),P.hc(7,"async"),P.Vb(8,"div",5,6),P.Kc(10,US,2,1,"div",7),P.hc(11,"async"),P.hc(12,"async"),P.Kc(13,LS,2,0,"div",8),P.Vb(14,"div",9),P.Qb(15,"app-view-column-toggle"),P.Ub(),P.Vb(16,"div",10,11),P.Vb(18,"div",12,13),P.Kc(20,DS,1,0,"app-view-toolbar",14),P.Ub(),P.Kc(21,ES,2,0,"div",15),P.Kc(22,FS,3,4,"div",16),P.Vb(23,"div",17,18),P.Kc(25,AS,1,1,"app-engine-camera-bar",19),P.Ub(),P.Ub(),P.Kc(26,RS,3,0,"ng-container",3),P.Ub(),P.Ub(),P.Ub(),P.Kc(27,VS,1,0,"div",20),P.hc(28,"async"),P.Kc(29,NS,2,3,"app-view-help",21),P.hc(30,"async"),P.Kc(31,BS,1,2,"app-view-ondemand",22),P.hc(32,"async"),P.Kc(33,HS,2,4,"app-view-progress",23),P.hc(34,"async"),P.Kc(35,$S,7,9,"app-view-loader",3),P.hc(36,"async"),P.Kc(37,KS,1,0,"app-view-tour",3),P.hc(38,"async"),P.Kc(39,GS,1,0,"app-view-annotate",3),P.hc(40,"async"),P.Kc(41,ZS,1,0,"app-view-print",3),P.hc(42,"async"),P.Kc(43,JS,1,0,"app-view-content-warning",24),P.Qb(44,"app-view-iphone12-warning")),2&e){var n,i,o=null;P.Db(2),P.lc("ngClass",P.qc(43,e_,t.columnVisible,!t.columnVisible,t.drawerVisible)),P.Db(2),P.lc("ngIf",t.columnVisible||t.searchVisible||t.nodeInfoVisible),P.Db(2),P.lc("ngIf",t.titleOnlyVisible&&(null==(o=P.ic(7,21,t.chapter$))?null:o.info.displayName)),P.Db(4),P.lc("ngIf",(null==(n=P.ic(11,23,t.selectedChapterReady$))?null:n.model)&&!P.ic(12,25,t.tutorialSeen$)),P.Db(3),P.lc("ngIf",t.undoVisible),P.Db(7),P.lc("ngIf",t.toolbarVisible),P.Db(1),P.lc("ngIf",t.menuVisible),P.Db(1),P.lc("ngIf",t.logoVisible),P.Db(3),P.lc("ngIf",t.cameraVisible),P.Db(1),P.lc("ngIf",t.drawerVisible),P.Db(1),P.lc("ngIf",!P.ic(28,27,t.inputEnabled$)),P.Db(2),P.lc("ngIf",P.ic(30,29,t.viewWindow$)===t.viewWindow.Help),P.Db(2),P.lc("ngIf",P.ic(32,31,t.viewWindow$)===t.viewWindow.OnDemand),P.Db(2),P.lc("ngIf","circle"===(null==(i=P.ic(34,33,t.layout$))?null:i.loader.template)),P.Db(2),P.lc("ngIf",P.ic(36,35,t.viewWindow$)===t.viewWindow.Interact),P.Db(2),P.lc("ngIf",P.ic(38,37,t.viewWindow$)===t.viewWindow.Tutorial),P.Db(2),P.lc("ngIf",P.ic(40,39,t.viewWindow$)===t.viewWindow.Whiteboard),P.Db(2),P.lc("ngIf",P.ic(42,41,t.usePrintImage$)),P.Db(2),P.lc("appFlagApplication",t.application.All)("appFlagApplicationMode","include")("appFlagApplicationNative",t.nativePlatform.All)}},directives:[ra.i,ra.l,ry,dy,bl,_y,Gy,Yf,tx,vx,mk,Ak,Km,$k,Tm,fw,Ew,$w,Zw,eO,Dw,tO,nC,IC,TC,xS],pipes:[ra.b],styles:[".view-page{border:var(--view-page-border);width:100vw;height:100vh;height:calc(var(--vh, 1vh) * 100);max-height:100vh;overflow:hidden;transition:padding-left .25s,padding-bottom .3s}.view-page--column-in{padding-left:320px}.view-page--column-out{padding-left:0}.view-page--drawer-push{padding-bottom:64px}.view-page__column{height:100%}.view-page__column-toggle{position:absolute;top:50%;margin-top:-18px;left:0;z-index:10}.view-page__engine{width:100%;height:100%;position:relative}.view-page__menu{position:absolute;right:8px;bottom:0;z-index:30}.view-page__camera-bar{position:absolute;bottom:0;right:4px;z-index:20}.view-page__logo{display:inline-block;position:absolute;left:16px;bottom:0;z-index:10}.view-page__media-bar{position:absolute;left:50%;margin-left:-100px;width:200px;bottom:0;z-index:10;justify-content:center}.view-page__media-bar:not([hidden]){display:flex}.view-page__notifications{position:absolute;top:12px;right:12px;z-index:20}.view-page__title-only{position:absolute;top:8px;left:8px;max-width:304px;z-index:10;padding:12px;border-radius:4px;background:hsla(0,0%,100%,.8);box-shadow:1px -1px 2px 0 rgba(28,42,63,.1),0 1px 2px 0 rgba(28,42,63,.3);color:#131c2a;background-color:var(--view-title-background);box-shadow:var(--view-title-shadow)}.view-page__scene-base{position:absolute;left:0;bottom:0;right:0;z-index:10;transition:transform .3s}.view-page__toolbar{position:absolute;display:inline-block;z-index:20;bottom:0;right:64px;transition:transform .25s}.view-page__undo{position:absolute;display:flex;justify-content:center;pointer-events:none;left:0;z-index:10;width:100%}.view-block-input{position:fixed;top:0;bottom:0;left:0;right:0;z-index:10000}"],encapsulation:2,changeDetection:0}),kS([Object(E.d)(ku.getUI),wS("design:type",be.a)],YS.prototype,"layout$",void 0),kS([Object(E.d)(ku.getInputEnabled),wS("design:type",be.a)],YS.prototype,"inputEnabled$",void 0),kS([Object(E.d)(ku.getFullscreenActive),wS("design:type",be.a)],YS.prototype,"fullscreenActive$",void 0),kS([Object(E.d)(ku.getDrawerCoversContent),wS("design:type",be.a)],YS.prototype,"drawerCoversContent$",void 0),kS([Object(E.d)(ku.getInteractType),wS("design:type",be.a)],YS.prototype,"interactType$",void 0),kS([Object(E.d)(ku.getOnDemand),wS("design:type",be.a)],YS.prototype,"onDemand$",void 0),kS([Object(E.d)(ku.getShowHelpTab),wS("design:type",be.a)],YS.prototype,"showHelpTab$",void 0),kS([Object(E.d)(ku.getUsePrintImage),wS("design:type",be.a)],YS.prototype,"usePrintImage$",void 0),kS([Object(E.d)(ku.getOpenWindow),wS("design:type",be.a)],YS.prototype,"viewWindow$",void 0),kS([Object(E.d)(ku.getTutorialSeen),wS("design:type",be.a)],YS.prototype,"tutorialSeen$",void 0),kS([Object(E.d)(Xu.getStoryLoadProgress),wS("design:type",be.a)],YS.prototype,"loadProgress$",void 0),kS([Object(E.d)(Wu.getBreakpoint),wS("design:type",be.a)],YS.prototype,"breakpoint$",void 0),kS([Object(E.d)(Lr.getSelectedChapter),wS("design:type",be.a)],YS.prototype,"chapter$",void 0),kS([Object(E.d)(Lr.getSelectedChapterReadyState),wS("design:type",be.a)],YS.prototype,"selectedChapterReady$",void 0),kS([Object(E.d)(Lr.getChaptersLoaded),wS("design:type",be.a)],YS.prototype,"chaptersLoaded$",void 0),kS([Object(E.d)(Lr.getSelectedChapterBackground),wS("design:type",be.a)],YS.prototype,"background$",void 0),kS([Object(E.d)(Lr.getSelectedChapterAudio),wS("design:type",be.a)],YS.prototype,"audio$",void 0),YS),n_=((XS=function(){function e(){m(this,e)}return v(e,[{key:"resolve",value:function(e){var t=Object.assign({},e.queryParams);return zu(Object.keys(t).reduce((function(e,n){var i=Array.isArray(t[n]);return e[n]=i?Object(Se.last)(t[n]):t[n],e}),{}))}}]),e}()).\u0275fac=function(e){return new(e||XS)},XS.\u0275prov=P.Lb({token:XS,factory:XS.\u0275fac}),XS),i_=h("l5mm"),o_=h("eNwd");function r_(e){var t=e.procName,n=e.actionFn,i=e.aliases,o=void 0===i?[]:i,r=e.mapFnIn,a=e.mapFnOut,s=e.hideDefinition,l=void 0!==s&&s,u=function(e){var t=this,i=r?r(e):e,o=n(i);if(void 0!==o)if(o instanceof be.a)o.subscribe((function(e){var n=a?a(e):e;t.setResult(n)}));else{var s=a?a(o):o;t.setResult(s)}};[t].concat(c(o)).forEach((function(e){var t=function(){return Human.rpc.define(e,u)};l?Human.rpc.hideDefinitions((function(){return t()})):t()}))}var a_=function(e){return e.AnnotationsCreate="annotations.create",e.AnnotationsDestroy="annotations.destroy",e.AnnotationsInfo="annotations.info",e.AnnotationsSetDescription="annotations.setDescription",e.AnnotationsSetLabelsShown="annotations.setLabelsShown",e.AnnotationsSetTitle="annotations.setTitle",e.AnnotationsUpdate="annotations.update",e.AnnotationsSetEnabled="annotations.setEnabled",e.CameraInfo="camera.info",e.CameraOrbit="camera.orbit",e.CameraPan="camera.pan",e.CameraReset="camera.reset",e.CameraSet="camera.set",e.CameraZoom="camera.zoom",e.GetAnnotationInfo="annotations.info",e.HideAnnotations="annotations.hide",e.HotspotsCreate="hotspots.create",e.HotspotsDestroy="hotspots.destroy",e.HotspotsHide="hotspots.hide",e.HotspotsInfo="hotspots.info",e.HotspotsShow="hotspots.show",e.HotspotsTypes="hotspots.types",e.HotspotsUpdate="hotspots.update",e.HumanInfo="human.info",e.InputDisable="input.disable",e.InputEnable="input.enable",e.LabelsCreate="labels.create",e.LabelsDestroy="labels.destroy",e.LabelsInfo="labels.info",e.LabelsHide="labels.hide",e.LabelsSetEnabled="labels.setEnabled",e.LabelsShow="labels.show",e.LabelsUpdate="labels.update",e.LabelsCanvasUpdate="labels.canvasUpdate",e.LabelsSetScale="labels.setScale",e.NativeErrorMessage="native.errorMessage",e.NativeSetSdkOffline="native.setSdkOffline",e.QuizInfo="quiz.info",e.QuizEnter="quiz.enter",e.QuizExit="quiz.exit",e.QuizQuestion="quiz.currentQuestion",e.QuizSubmit="quiz.submit",e.QuizNextQuestion="quiz.next",e.QuizPreviousQuestion="quiz.previous",e.QuizSelectQuestion="quiz.select",e.QuizSet="quiz.set",e.QuizReset="quiz.reset",e.SceneMetaData="scene.metadata",e.SceneSetHighlightColor="scene.setHighlightColor",e.SceneColorObject="scene.colorObject",e.SceneDisableHighlight="scene.disableHighlight",e.SceneEnableHighlight="scene.enableHighlight",e.SceneGetColor="scene.getColor",e.SceneInfo="scene.info",e.SceneLoad="scene.load",e.ScenePick="scene.pick",e.SceneReset="scene.reset",e.SceneSelectObjects="scene.selectObjects",e.SceneShowObjects="scene.showObjects",e.SceneTransformObject="scene.transformObject",e.SceneUncolorObject="scene.uncolorObject",e.SceneSnapshot="scene.snapshot",e.SceneCapture="scene.capture",e.SceneRestore="scene.restore",e.SceneEnableXrayMode="scene.enableXray",e.SceneDisableXrayMode="scene.disableXray",e.SceneSetLayersSliderPosition="scene.setLayersSliderPosition",e.SceneGetLayers="scene.getLayers",e.SceneSetBaseDirectory="scene.setBaseDirectory",e.ShowAnnotations="annotations.show",e.SetAnnotationsShown="annotations.setShown",e.TimelineInfo="timeline.info",e.TimelineQuery="timeline.query",e.TimelineNext="timeline.nextChapter",e.TimelinePause="timeline.pause",e.TimelinePlay="timeline.play",e.TimelinePrev="timeline.previousChapter",e.TimelineSet="timeline.set",e.UIGetBackground="ui.getBackground",e.UIGetDisplay="ui.getDisplay",e.UIGetWorldPosition="ui.getWorldPosition",e.UISetBackground="ui.setBackground",e.UIPresetBackground="ui.presetBackground",e.UISetDisplay="ui.setDisplay",e.UIResetDisplay="ui.resetDisplay",e.UISnapshot="ui.snapshot",e.focusObject="focus.focusObject",e.dissectSetEnabled="dissect.setEnabled",e.pickSingleSetEnabled="pick.single.setEnabled",e.pickMultiSetEnabled="pick.multi.setEnabled",e.getCanvasPos="scene.getCanvasPos",e.sceneSetClickMode="scene.setClickMode",e.sceneGetClickMode="scene.getClickMode",e.IsolateObject="scene.isolateObject",e.setCameraMode="camera.setCameraMode",e.UISetOndemand="ui.setOndemand",e.UISetLoadingExperience="ui.setLoadingExperience",e.UISetScrollCaptureMode="ui.setScrollCaptureMode",e.UISetTutorial="ui.setTutorial",e.UISetQuizLock="ui.setQuizLock",e}({});function s_(e){var t=e.captureCamera();return{position:t.lookAt.eye,target:t.lookAt.look,up:t.lookAt.up,zoom:t.zoom}}var c_,l_,u_=h("SxV6");function p_(e){if(!e)return null;var t=e.objectId,n=e.canvasPos,i=e.worldPos;return{objectId:t||void 0,canvasPosition:n?{x:n[0],y:n[1]}:void 0,mode:"query",position:i?{x:i[0],y:i[1],z:i[2]}:void 0}}function d_(e,t){var n=Human.scene.objects[t].parent;return null!==n&&(e[n.objectId].checked||d_(e,n.objectId))}function g_(e,t){var n=t.includes("/")?I.Module:I.Bookmark;e.dispatch(new _a(t,n))}function h_(e,t){return e.dispatch(new Re(!0)),t.fireEvent(Dt.SceneXrayEnabled,void 0),!0}function f_(e,t,n){Human.rpc.defineEvent(e,{events:t||[e],map:n||function(e){return e}})}(c_||(c_={})).getCanvasPos=function(e,t,n,i,o){n&&cO.a.add(t,n,t);var r=e.renderer.getViewMat(),a=e.renderer.getProjMat(),s=cO.b.create();cO.a.transformMat4(s,t,r),s[3]=1,cO.b.transformMat4(s,s,a);var c=s[1],l=s[3];return[Math.round((1+s[0]/l)*i/2),Math.round((1-c/l)*o/2)]},function(e){e.isLegacyCaptureFormat=function(e){return void 0!==e.engineVersion},e.convertCaptureFormat=function(e){var t=Object.keys(e.objects).reduce((function(e,t){return e.push({objectId:t,selected:!1,hidden:!1}),e}),[]);return{storyId:e.timeline.rootName.replace(".json",""),camera:{lookAt:e.camera,zoom:void 0},labels:[],objects:t,background:[],activeChapterId:e.timeline.scrub?e.timeline.scrub.chapterId:void 0}}}(l_||(l_={}));var b_=h("I65S");function v_(e){return vr.getColors(e).map((function(e){return e[255]}))}function m_(e,t){var n,i=e.selectSnapshot(Lr.getSelectedChapterBackground),o=i.colors,r=i.colorStops,a=i.gradientType,s=t.colors?(n=[]).concat.apply(n,c(t.colors)):o;return new ai(s,t.gradientType||a,t.colorStops||r)}function y_(e){return e.selectSnapshot(Is.getChapterLabels)}function x_(e,t){return function(e,t){return e.find((function(e){return t===e.id}))}(y_(e),t)}function k_(e,t){var n=function(e,t){return e.scene.markers.markers[t]}(e,t.id);return{annotationId:t.id,objectId:t.objectId||null,title:t.title,description:t.description,shown:t.shown,occludable:t.occludable,position:n?{x:n.pos[0],y:n.pos[1],z:n.pos[2]}:null,canvasPosition:n?{x:n.canvasPos[0],y:n.canvasPos[1]}:null}}function w_(e,t){var n=x_(e,t.annotationId);return n?Object.assign(Object.assign({},n),t):null}function O_(e,t){return t&&e.dispatch(new $o(t)),!0}function C_(e,t){return e.dispatch(new tr(t)),!0}function S_(e,t){return e.reduce((function(e,n){return Object.assign(Object.assign({},e),u({},""+n,t))}),{})}function __(e,t){return function(e,n){return Object.entries(e).filter((function(e){var n=p(e,2);n[0];return function(e,n){return n===t}(0,n[1])})).reduce((function(e,t){var n=p(t,2),i=n[0],o=n[1];return Object.assign(Object.assign({},e),u({},""+i,o))}),{})}(e)}function j_(e,t){return Object.keys(__(e,t))}function P_(e,t,n){return function(e,t){return e.filter((function(e){return t.includes(e.id)}))}(e,j_(t,n))}function M_(e,t,n){var i,o=j_(t,n).map((function(t){return function(e){for(var t,n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];var r,a,s=i.map((function(t){return e.filter((function(e){return t===e.objectId}))}));return r=(t=[]).concat.apply(t,c(s)),a=new Set(r),Array.from(a.values())}(e,t)})).map((function(e){return e.map((function(e){return e.id}))}));return S_((i=[]).concat.apply(i,c(o)),n)}var I_={};function z_(e,t){t.hasOwnProperty("data")&&(t[e]=t.data)}var T_={hotspotSeedId:0,hotspotIdMap:new Map,getHotspotMap:function(e){var t=T_.hotspotIdMap,n=T_.createHotspotId;return e.selectSnapshot(Is.getLabels).forEach((function(e){var i=e.id;void 0===t.get(i)&&n(i)})),t},createHotspotId:function(e){return T_.hotspotSeedId++,T_.hotspotIdMap.set(e,T_.hotspotSeedId),T_.hotspotSeedId},getHotspotIdByLabel:function(e,t,n){var i=T_.getHotspotMap,o=T_.createHotspotId,r=i(e).get(t);return n&&void 0===r?o(t):r},getLabelIdByHotspotId:function(e,t){var n=T_.getHotspotMap(e),i=Array.from(n).find((function(e){var n=p(e,2);n[0];return n[1]===t}));return i?i[0]:null}};function U_(e,t){var n=e.selectSnapshot(Is.getLabels);return void 0!==t?n.filter((function(e){return e.chapterId===t})):n}function L_(e,t){var n=U_(e),i=T_.getLabelIdByHotspotId(e,t);return n.find((function(e){return e.id===i}))}function D_(e){return e===yi.CirclePlus?Xn.Plus:e===yi.CircleMinus?Xn.Minus:Xn.Default}function E_(e,t){return T_.getHotspotIdByLabel(e,t)}function F_(e,t){return Object.assign(Object.assign({},t),{id:E_(e,t.id)})}function A_(e,t,n){var i=t.selectSnapshot(Lr.getStoryChapters);return n.map((function(n){return function(e,t,n,i){var o,r=i.id,a=i.chapterId,s=i.title,c=i.objectId,l=n.findIndex((function(e){return a===e.id})),u=T_.getHotspotIdByLabel(t,r,!0),p=function(e,t){return e.scene.markers.markers[t]}(e,r);return{id:u,title:s,objectId:c,position:p?R_(p.pos):null,direction:p?R_(p.dir):null,canvasPosition:p?(o=p.canvasPos,{x:o[0],y:o[1]}):null,chapterScope:l,type:i.pinType===Xn.PlusMinus?yi.CirclePlus:yi.Circle,shown:i.shown,data:I_[i.id]}}(e,t,i,n)}))}function R_(e){return{x:e[0],y:e[1],z:e[2]}}function V_(e){return[e.x,e.y,e.z]}function N_(e,t,n){return e.dispatch(new er(t,n)),!0}function B_(e,t){if("number"==typeof t){var n=L_(e,t);return n?[n]:[]}return U_(e)}function H_(e){return e.selectSnapshot(Is.getChapterLabels)}function Q_(e,t){return e.dispatch(new tr(t)),!0}function q_(e,t){return H_(e).find((function(e){return t===e.id}))}function W_(e,t){return H_(e).filter((function(e){return t.includes(e.id)}))}function $_(e,t,n){return t&&t.objectId?(e.dispatch(n?new No(t):new $o(t)),t):null}function K_(e,t){var n=document.createElement("span");return n.innerHTML=e,Object(Se.trim)(n.textContent).length<=t}function G_(e,t,n){var i=e;return i.title=t.title&&K_(t.title,100)?t.title:i.title,i.description=t.description&&K_(t.description,300)?t.description:i.description,i.theme=t.theme||i.theme,i.pinType=t.pinType||i.pinType,i.sequentialType=t.sequentialType||i.sequentialType,i.offset=function(e,t){return t||[-(e.hideWire?20:32),0]}(i,t.labelOffset),i.pinGlow=void 0!==t.pinGlow?t.pinGlow:i.pinGlow,i.hideWire=void 0!==t.hideWire?t.hideWire:i.hideWire,i.hideTag=void 0!==t.hideTag?t.hideTag:i.hideTag,i.collapseDescription=void 0!==t.collapseDescription?t.collapseDescription:i.collapseDescription,i.occludable=void 0!==t.occludable?t.occludable:i.occludable,i.cameraPosition=t.flyToCamera||i.cameraPosition,i.flyTo=function(e,t){return!1!==t&&(t||e.flyTo)}(i,t.flyTo),i.states=function(e){if(!e.flyTo)return[];var t=[new fi,new fi];t[0].errands=[new xi],t[1].errands=e.cameraPosition?[new mi(e.cameraPosition)]:[new vi(e.objectId)]}(i),i}function Z_(e,t){if(t){var n=e.scene.markers.markers[t.id];return{labelId:t.id,objectId:t.objectId,title:t.title,description:t.description,theme:t.theme,pinType:t.pinType,labelOffset:t.offset,hideWire:t.hideWire,pinGlow:t.pinGlow,occludable:t.occludable,sequentialType:t.sequentialType,shown:t.shown,collapseDescription:t.collapseDescription,hideTag:t.hideTag,flyTo:!0===t.flyTo,flyToCamera:t.cameraPosition,position:n?[n.pos[0],n.pos[1],n.pos[2]]:t.pos,canvasPosition:n?[n.canvasPos[0],n.canvasPos[1]]:[-1,-1],occluded:!n||n.occluded}}return null}function J_(e,t){return t.reduce((function(t,n){return t[n.id]=Z_(e,n),t}),{})}function X_(e){return e.selectSnapshot(_o.getAllQuestions)}function Y_(e){return X_(e).find((function(t){return t.id===oj(e)}))}function ej(e){return{active:e.selectSnapshot(_o.getQuizModeActive),questions:(t=X_(e),i=t.map((function(e){return sj(e)})),void 0!==n?i.filter((function(e){return n.includes(e.questionId)})):i),questionId:oj(e),submissions:tj(e,ij(e))};var t,n,i}function tj(e,t){return t.map((function(t){return nj(e,t)}))}function nj(e,t){var n=Y_(e);return{questionId:t.questionId,answerIds:n.data.correctAnswer,correct:po(n,t.answer)}}function ij(e){return e.selectSnapshot(_o.getAllSubmissions)}function oj(e){return e.selectSnapshot(_o.getActiveQuestionId)}function rj(e){var t=Y_(e),n=function(e){return ij(e).find((function(t){return t.questionId===oj(e)}))}(e);return{question:sj(t),submission:n?nj(e,n):void 0}}function aj(e){return e.map((function(e){return function(e){var t=e.type;switch(t){case so.Markdown:return{type:t,content:e.markdown};case so.Images:return{type:t,content:e.images.map((function(e){return e.urls.default}))};default:return{type:t,content:""}}}(e)}))}function sj(e){var t=[],n="";switch(e.type){case co.MultipleChoice:var i=e.data;t=i.options.map((function(e){return function(e){return{answerId:e.value,displayText:e.label}}(e)})),n=i.correctAnswer;break;case co.SelectAnatomy:t=e.data.correctAnswer.map((function(e){return{answerId:e,displayText:e}})),n="";break;case co.LabelAnatomy:t=e.data.options.map((function(e){return{answerId:e.value,displayText:e.label.title}})),n=""}return{questionId:e.id,questionType:e.type,questionPrompt:aj(e.questionPrompt),answerExplanation:aj(e.explanation),answers:t,answerId:n}}var cj,lj,uj,pj,dj=((cj=function(){function e(t,n,i,o,r,a,s,c,l,u,p,d){m(this,e),this.store=t,this.actions=n,this.cameraService=i,this.engineService=o,this.animationService=r,this.paintService=a,this.labelsService=s,this.graphService=c,this.viewService=l,this.widgetAnalyticsService=u,this.visibilityLayersService=p,this.quizService=d,this.webGLInfo=SceneJS.WEBGL_INFO}return v(e,[{key:"listen",value:function(e){this.initProcedures(),this.initEvents(),e&&this.logAPIUsage()}},{key:"logAPIUsage",value:function(){var e=this;setInterval((function(){var t=Human.rpc.getLog(),n=Object(Se.uniqBy)(t,(function(e){return e.identifier}));if(n.length>0){var i=JSON.stringify(n),o=e.store.selectSnapshot(he.getWidgetState),r=e.widgetAnalyticsService.buildDeveloperAnalytic(o,ue.Call,ne.WidgetAPI,i);e.widgetAnalyticsService.sendAnalytic(r).subscribe({next:function(e){},error:function(e){throw new Error(e)}}),Human.rpc.resetLog()}}),1e4)}},{key:"initEvents",value:function(){var e,t,n;f_(Dt.HumanProgress,void 0,(function(e){return e})),[{eventName:Dt.HumanReady,aliasEvents:[Dt.HumanStarted]},{eventName:Dt.Error,aliasEvents:[Dt.HumanError],mapFn:function(e){return e}}].forEach((function(e){f_(e.eventName,e.aliasEvents,e.mapFn)})),[{eventName:Dt.SceneLoaded,mapFn:function(e){return e}},{eventName:Dt.ScenePicked,aliasEvents:[Dt.PickPicked],mapFn:p_},{eventName:Dt.SceneObjectsSelected,mapFn:function(e){return e.selectedObjectsUpdate}},{eventName:Dt.SceneObjectsShown,mapFn:function(e){return e.enabledObjectsUpdate}},{eventName:Dt.SceneReady,aliasEvents:[Dt.Started]},{eventName:Dt.SceneRestored,mapFn:function(){return!0}},{eventName:Dt.SceneXrayEnabled,mapFn:function(){return!0}},{eventName:Dt.SceneXrayDisabled,mapFn:function(){return!0}},{eventName:Dt.NativeShare,mapFn:function(e){return e}},{eventName:Dt.NativeDebugMessage,mapFn:function(e){return e}}].forEach((function(e){f_(e.eventName,e.aliasEvents,e.mapFn)})),(e=this.cameraService,[{eventName:Dt.CameraUpdated,aliasEvents:[Dt.CameraRested],mapFn:function(){return s_(e)}}]).forEach((function(e){f_(e.eventName,e.aliasEvents,e.mapFn)})),[{eventName:Dt.TimelinePlaying,mapFn:function(e){return e}},{eventName:Dt.TimelineCompleted,mapFn:function(e){return!0}},{eventName:Dt.TimelineChapterTransition,aliasEvents:[Dt.TimelineChaptersActivated],mapFn:function(e){return{previousChapter:e.oldChapterIndex,currentChapter:e.newChapterIndex,time:e.time}}}].forEach((function(e){f_(e.eventName,e.aliasEvents,e.mapFn)})),[].forEach((function(e){f_(e.eventName,e.aliasEvents,e.mapFn)})),[].forEach((function(e){f_(e.eventName,e.aliasEvents,e.mapFn)})),(t=Human,n=this.store,[].concat(c(function(e,t){return[{eventName:Dt.AnnotationsCreated,aliasEvents:[Dt.LabelsCreated],mapFn:function(t){return k_(e,t)}},{eventName:Dt.AnnotationsDestroyed,aliasEvents:[Dt.LabelsDestroyed],mapFn:function(e){return{annotationId:e.id}}},{eventName:Dt.AnnotationsShown,aliasEvents:[Dt.LabelsEnabled],mapFn:function(){return!0}},{eventName:Dt.AnnotationsHidden,aliasEvents:[Dt.LabelsDisabled],mapFn:function(){return!0}}]}(t)),c(function(e,t){return[{eventName:Dt.HotspotsEntered,mapFn:function(e){return F_(t,e)}},{eventName:Dt.HotspotsLeft,mapFn:function(e){return F_(t,e)}},{eventName:Dt.HotspotsPicked,mapFn:function(e){return F_(t,e)}},{eventName:Dt.HotspotsDisplayUpdated,mapFn:function(e){return F_(t,e)}},{eventName:Dt.HotspotsPositionUpdated,mapFn:function(e){return function(e,t){var n=t.id,i=t.canvasPos,o=i.x,r=i.y;return{id:E_(e,n),canvasPosition:{x:o,y:r,0:o,1:r},occluded:t.occluded}}(t,e)}}]}(0,n)),[{eventName:Dt.LabelsChapterInfo,mapFn:function(e){return J_(t,e)}},{eventName:Dt.LabelsCreated,mapFn:function(e){return Z_(t,e)}},{eventName:Dt.LabelsUpdated,mapFn:function(e){return Z_(t,e)}},{eventName:Dt.LabelsDestroyed,mapFn:function(e){return{labelId:e.id}}},{eventName:Dt.LabelsEntered,mapFn:function(e){return e}},{eventName:Dt.LabelsLeft,mapFn:function(e){return e}},{eventName:Dt.LabelsPicked,mapFn:function(e){return e}},{eventName:Dt.LabelsMoved,mapFn:function(e){return e}},{eventName:Dt.LabelsEnabled,mapFn:function(){return!0}},{eventName:Dt.LabelsDisabled,mapFn:function(){return!0}},{eventName:Dt.LabelsShown,mapFn:function(e){return e}},{eventName:Dt.LabelsHidden,mapFn:function(e){return e}}])).forEach((function(e){f_(e.eventName,e.aliasEvents,e.mapFn)})),function(e){return[{eventName:Dt.QuizEntered,mapFn:function(){return ej(e)}},{eventName:Dt.QuizExited,mapFn:function(){return!0}},{eventName:Dt.QuizQuestionLoaded,mapFn:function(e){return e}},{eventName:Dt.QuizAnswerSelected,mapFn:function(e){return e}},{eventName:Dt.QuizAnswerSubmitted,mapFn:function(t){var n=e.selectSnapshot(_o).questions.find((function(e){return e.id===t.questionId}));return{questionId:t.questionId,answerIds:t.answer,correct:po(n,t.answer)}}},{eventName:Dt.QuizCompleted,mapFn:function(){return go(e.selectSnapshot(_o.getAllQuestions),e.selectSnapshot(_o.getAllSubmissions))}}]}(this.store).forEach((function(e){f_(e.eventName,e.aliasEvents,e.mapFn)}))}},{key:"initProcedures",value:function(){var e,t,n,i;(e=Human,t=this.webGLInfo,[{procName:a_.HumanInfo,actionFn:function(){return{version:e.VERSION,webglInfo:t,apiFunctions:e.rpc.getProcedures().sort(),apiEvents:e.rpc.getEvents().sort()}}}]).forEach((function(e){r_(e)})),function(e,t,n,i,o,r,a,l){return[{procName:a_.SceneMetaData,actionFn:function(){var t=e.selectSnapshot(Hs.getStory),n=e.selectSnapshot(Lr.getStoryChapters);return{title:t.displayName,description:t.description,chapters:n.map((function(e){return{id:e.id,title:e.info.displayName,description:e.info.description,isAnimated:r.isChapterAnimated(e),loops:r.isChapterLooped(e),duration:r.getChapterLocalTimerange(e.id)}}))}}},{procName:a_.focusObject,actionFn:function(n){return function(e,t,n){e.select&&e.xray?h_(t,n):Ws(t,n),e.select&&t.dispatch(new pi.UpdateNodesChecked(!0,[e.objectId])),t.dispatch(new Qe(e.objectId,!0,1))}(n,e,t),!0},hideDefinition:!0},{procName:a_.dissectSetEnabled,actionFn:function(t){return e.dispatch(new Xe(t.enable?Rr.Hide:Rr.Select)),!0},hideDefinition:!0},{procName:a_.sceneSetClickMode,actionFn:function(t){return e.dispatch(new Xe("select"===t?Rr.Select:"hide"===t?Rr.Hide:"fade"===t?Rr.Fade:Rr.Select)),!0}},{procName:a_.sceneGetClickMode,actionFn:function(){return e.selectSnapshot(Wr.getActiveTool)}},{procName:a_.pickSingleSetEnabled,actionFn:function(t){var n=function(){switch(t.enable){case void 0:return!e.selectSnapshot(ku.getMultiPickModeEnabled);case!0:return!1;case!1:return!0}}();return e.dispatch(new j.SetMultiPickModeEnabled(n)),!0},hideDefinition:!0},{procName:a_.pickMultiSetEnabled,actionFn:function(t){var n=function(){switch(t.enable){case void 0:return!e.selectSnapshot(ku.getMultiPickModeEnabled);default:return t.enable}}();return e.dispatch(new j.SetMultiPickModeEnabled(n)),!0},hideDefinition:!0},{procName:a_.getCanvasPos,actionFn:function(e){var n=t.getCanvas();return c_.getCanvasPos(Human,e.worldPos,e.offset,n.width,n.height)},hideDefinition:!0},{procName:a_.SceneCapture,actionFn:function(){return function(e,t){var n=t.captureCamera(),i=e.selectSnapshot(Ai.getNodes),o=Object.keys(i).map((function(e){return{objectId:e,selected:i[e].checked||d_(i,e),hidden:!i[e].shown}})),r=e.selectSnapshot(Lr.getStoryChapters).map((function(e){return{chapterId:e.id,background:e.background||mr}})),a=e.selectSnapshot(Hs.getStoryId);return{camera:n,labels:e.selectSnapshot(Is.getLabels),storyId:a,objects:o,background:r,activeChapterId:e.selectSnapshot(Lr.getSelectedChapterId)}}(e,i)}},{procName:a_.SceneRestore,actionFn:function(n){var i=l_.isLegacyCaptureFormat(n);return function(e,t,n,i){return new be.a((function(o){n.getEvent(Dt.HumanStarted).pipe(Object(u_.a)()).subscribe((function(){(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new Promise((function(i){t.selectSnapshot(Wr.getViewGraph);var o=e.objects.filter((function(e){return!0===e.selected})).map((function(e){return e.objectId})),r=n?Human.scene.getLeaves().filter((function(t){return void 0===e.objects.find((function(e){return e.objectId===t}))})):e.objects.filter((function(e){return!0===e.hidden})).map((function(e){return e.objectId})),a=e.background.map((function(e){return new Fn(e.chapterId,e.background)})),s=e.activeChapterId?[new Cn(e.activeChapterId)]:[],l=void 0!==e.camera.zoom?[new Xt(e.camera.zoom)]:[];setTimeout((function(){t.dispatch([new $t(e.camera.lookAt,!1),new Vo(e.labels),new pi.UpdateNodesShown(!1,r),new pi.UpdateNodesChecked(!0,o)].concat(l,s,c(a))),i()}))}))})(e,t,i).then((function(){n.fireEvent(Dt.SceneRestored,void 0),o.next(!0),o.complete()}))})),g_(t,e.storyId)}))}(i?l_.convertCaptureFormat(n):n,e,t,i)}},{procName:a_.SceneEnableXrayMode,actionFn:function(){return h_(e,t)}},{procName:a_.SceneDisableXrayMode,actionFn:function(){return Ws(e,t)}},{procName:a_.SceneLoad,actionFn:function(t){return g_(e,t),!0}},{procName:a_.SceneSetBaseDirectory,actionFn:function(e){return Human.events.fire("scene.setBaseDirectory",e),!0}},{procName:a_.NativeSetSdkOffline,actionFn:function(e){return Human.events.fire("native.setSdkOffline",e),!0}},{procName:a_.SceneReset,actionFn:function(){return a.resetChapter(),!0}},{procName:a_.SceneInfo,actionFn:function(t){var n=t&&t.objectId?[t.objectId]:Object.keys(Human.scene.objects);return function(e,t,n){var i=n.selectSnapshot(Ai.getNodes);return{name:e,objects:t.reduce((function(e,t){return e[t]=function(e){var t=Human.scene.objects[e],n=t.isLeaf()?i[e].checked||d_(i,e):void 0;return{objectId:t.objectId,name:t.displayName,description:t.description||"",shown:t.shown,selected:n,children:t.objects.map((function(e){return e.objectId})),parent:t.parent?t.parent.objectId:null}}(t),e}),{})}}(e.selectSnapshot(Hs.getStory).displayName,n,e)}},{procName:a_.ScenePick,actionFn:function(e){return p_(t.pickScene({x:e.x,y:e.y,rayPick:!0}))}},{procName:a_.SceneSelectObjects,actionFn:function(t){var n=!0===t.replace,i=t;return delete i.replace,n&&e.dispatch(new pi.UpdateNodesChecked(!1)),e.dispatch(new pi.UpdateNodesChecked(!1,[],i)),!0}},{procName:a_.SceneShowObjects,actionFn:function(t){delete t.replace;var n=Object.entries(t).reduce((function(e,n){var i=p(n,2),o=i[0],r=i[1];return Object.assign(Object.assign({},e),function e(n,i){var o,r=Human.scene.objects[n].objects,a=u({},n,i),c=s(r);try{for(c.s();!(o=c.n()).done;){var l=o.value;void 0!==t[l.objectId]||(a[l.objectId]=i,a=Object.assign(Object.assign({},a),e(l.objectId,i)))}}catch(p){c.e(p)}finally{c.f()}return a}(o,r))}),{});return e.dispatch(new pi.UpdateNodesShown(!1,[],n)),!0}},{procName:a_.IsolateObject,actionFn:function(t){var n="string"==typeof t?[t]:t,i=e.selectSnapshot(Wr.getViewGraph),r=o.getInverseSelection(i,n),a=o.getNodes(i,r);return e.dispatch(new pi.UpdateNodesShown(!1,a.map((function(e){return e.id})))),!0}},{procName:a_.SceneTransformObject,actionFn:function(e){return t.transformObject(e.objectId,e),!0}},{procName:a_.SceneColorObject,actionFn:function(t){var n=t.objectId,i=t.tintColor,o=t.saturation,r=t.contrast,a=t.brightness,s=t.opacity;return e.dispatch(new pi.UpdateNodesPaint(Li.fromEngine({tintColor:i,saturation:o,contrast:r,brightness:a,opacity:s}),[n])),!0}},{procName:a_.SceneGetColor,actionFn:function(t){var n=e.selectSnapshot(Ai.getNodePaint)(t.objectId);return Li.toEngine(n)}},{procName:a_.SceneUncolorObject,actionFn:function(t){return e.dispatch(new pi.UpdateNodesPaint(Bi.recipe,[t.objectId])),!0}},{procName:a_.SceneDisableHighlight,actionFn:function(){return n.disableHighlight(),!0}},{procName:a_.SceneEnableHighlight,actionFn:function(){return n.enableHighlight(),!0}},{procName:a_.SceneSetHighlightColor,actionFn:function(e){return n.setHighlightColor(e),!0}},{procName:a_.SceneSetLayersSliderPosition,actionFn:function(e){var t=Math.min(1,Math.max(e.position,0)),n=l.fractionToIndex(t),i=l.fractionToPosition(t,n);return e.record?l.recordLayerIndexPosition(n,i):l.synchronizeScene(n,i,!1),!0}},{procName:a_.SceneGetLayers,actionFn:function(){return e.selectSnapshot(Lr.getAllChaptersCurrentLayers)}}]}(this.store,this.engineService,this.paintService,this.cameraService,this.graphService,this.animationService,this.viewService,this.visibilityLayersService).forEach((function(e){r_(e)})),(n=this.store,i=this.cameraService,[{procName:a_.CameraInfo,actionFn:function(){return s_(i)}},{procName:a_.CameraOrbit,actionFn:function(e){return n.dispatch(new rn(void 0===e.pitch?0:e.pitch,void 0===e.yaw?0:e.yaw)),!0}},{procName:a_.CameraPan,actionFn:function(e){return n.dispatch(new tn(void 0===e.x?0:e.x,void 0===e.y?0:e.y,void 0===e.z?0:e.z)),!0}},{procName:a_.CameraReset,actionFn:function(){return n.dispatch(new Zt)}},{procName:a_.CameraSet,actionFn:function(e){var t=e.animate||!1;if(e.objectId)return n.dispatch(new Qe(e.objectId,t,e.animationDuration)),!0;var o=s_(i);return n.dispatch(new $t({eye:e.position||o.position,look:e.target||o.target,up:e.up||o.up},t)),!0}},{procName:a_.CameraZoom,actionFn:function(e){return n.dispatch(new Xt(e||0)),!0}},{procName:a_.setCameraMode,actionFn:function(e){return n.dispatch(new an("pan"===e?"pan":"rotate")),!0}}]).forEach((function(e){r_(e)})),function(e,t,n,i){return[{procName:a_.TimelineQuery,actionFn:function(){return{chapters:e.selectSnapshot(Lr.getStoryChapters).map((function(e){var t=e.info;return{description:t.description,displayName:t.displayName,annotations:e.labels.map((function(e){return{title:e.title,description:e.description}}))}}))}},hideDefinition:!0},{procName:a_.TimelineInfo,actionFn:function(){return function(e,t){var n=t.getTimeFrame();return{time:t.getTime(),startTime:n.firstTime,endTime:n.lastTime,chapters:e.selectSnapshot(Lr.getStoryChapters).map((function(e){return e.id})),playing:t.isPlaying()}}(e,n)}},{procName:a_.TimelinePlay,actionFn:function(i){var o=i.loop||!1;if(void 0===i.time&&void 0===i.chapterId){var r=e.selectSnapshot(Lr.getSelectedChapterId);return n.play({numChapters:1,loop:o,queue:!1,startChapterId:r}),!0}var a=Math.max(0,i.time),s=n.getTimeFrame().lastTime,c=Math.min(a,s-.001);return new be.a((function(r){t.pipe(Object(E.i)(Cn),Object(Ou.a)(1)).subscribe((function(){n.play(Object.assign(Object.assign({},{numChapters:1,queue:!1,loop:o}),void 0!==i.time?{startTime:c}:{startChapterId:i.chapterId})),r.next(!0),r.complete()}));var a=i.chapterId?i.chapterId:n.mapGlobalTimeToLocal(c,{tie:"later"}).branch.id;e.dispatch(new Cn(a))}))}},{procName:a_.TimelinePause,actionFn:function(){return n.pause(),!0}},{procName:a_.TimelineSet,actionFn:function(i){if(void 0===i.time&&void 0===i.chapterId)return!0;if(void 0!==i.chapterId)return e.dispatch(new Cn(i.chapterId)),!0;var o=Math.max(0,i.time),r=n.getTimeFrame().lastTime,a=Math.min(o,r);return new be.a((function(i){t.pipe(Object(E.i)(Cn),Object(Ou.a)(1)).subscribe((function(){n.scrub({time:a,which:0===a?"second":"first"}),i.next(!0),i.complete()}));var o=n.mapGlobalTimeToLocal(a,0===a?{tie:"later"}:{});e.dispatch(new Cn(o.branch.id))}))}},{procName:a_.TimelineNext,actionFn:function(){return i.nextChapter("API"),!0}},{procName:a_.TimelinePrev,actionFn:function(){return i.previousChapter("API"),!0}}]}(this.store,this.actions,this.animationService,this.viewService).forEach((function(e){r_(e)})),function(e){return[{procName:a_.InputEnable,actionFn:function(){return e.dispatch(new W(!0)),!0}},{procName:a_.InputDisable,actionFn:function(){return e.dispatch(new W(!1)),!0}}]}(this.store).forEach((function(e){r_(e)})),function(e,t,n,i,o){return[{procName:a_.UIGetBackground,actionFn:function(){return e=t.selectSnapshot(Lr.getSelectedChapterBackground),n=e.colors,i=e.gradientType,o=e.colorStops,{colors:[[n[0],n[1],n[2],n[3]],[n[4],n[5],n[6],n[7]]],gradientType:i,colorStops:o};var e,n,i,o}},{procName:a_.UISetBackground,mapFnIn:function(e){var t=e.colors,n=e.colorStops,i=e.gradientType;return{colors:t?v_(t):t,gradientType:i,colorStops:n}},actionFn:function(e){if(e){var n=m_(t,e);t.dispatch(new Vn(n))}return!0}},{procName:a_.UIPresetBackground,mapFnIn:function(e){var t=e.colors,n=e.colorStops,i=e.gradientType;return{colors:t?v_(t):t,gradientType:i,colorStops:n}},actionFn:function(e){if(e){var i=m_(t,e);n.pipe(Object(E.i)(Sn),Object(Ou.a)(1)).subscribe((function(){t.dispatch(new An(i))}))}return!0}},{procName:a_.UIGetWorldPosition,actionFn:function(t){var n=e.renderer.pick.pick(t.x,t.y,{rayPick:!0}).worldPos;return n?{x:n[0],y:n[1],z:n[2]}:null}},{procName:a_.UISetOndemand,actionFn:function(e){return t.dispatch([new j.ToggleWindow(nu.OnDemand,e.enabled)]),!0}},{procName:a_.UISetLoadingExperience,actionFn:function(e){return Object(Se.isEmpty)(e)?t.dispatch(new j.CloseWindow(nu.Interact)):t.dispatch([new j.SetInteractType(e),new j.OpenWindow(nu.Interact)]),!0}},{procName:a_.UISetScrollCaptureMode,actionFn:function(e){return t.dispatch(new Te(e)),!0}},{procName:a_.UISetTutorial,actionFn:function(e){return t.dispatch([new j.ToggleWindow(nu.Tutorial,e.enabled),new j.StartTutorial(e.enabled)]),!0}},{procName:a_.UIGetDisplay,actionFn:function(){var e=t.selectSnapshot(ku.getUI);return{audio:e.audio.enable,fullscreen:e.fullscreen.enable,help:e.help.enable,nav:e.camera.enable,cameraMode:e.camera.enable,center:e.camera.enable,zoomIn:e.camera.enable,zoomOut:e.camera.enable,info:e.column.enable||e.drawer.enable,playPause:e.media.enable,scrubber:e.media.enable,"scrubber.chapters":e.media.enable,tools:e.tools.enable,"tools-display":e.tools.enable,tour:e.pagination.enable,"tour.chapters":e.pagination.enable,objectTree:e.search.enable,anatomyLabels:e.anatomyLabels.enable,share:!1,dissect:!1,xray:!1,annotations:!1,crossSection:!1,isolate:!1}}},{procName:a_.UISetDisplay,actionFn:function(e){var n=Rp.convertAPIUIConfigToUIConfig(e);return t.dispatch(new $(n)),e}},{procName:a_.UIResetDisplay,actionFn:function(){var e=t.selectSnapshot(ku.getInitialUI);t.dispatch(new j.SetUI(e))}},{procName:a_.UISetQuizLock,actionFn:function(e){return n.pipe(Object(E.j)(Ha),Object(Ou.a)(1)).subscribe((function(){t.dispatch(new io.SetQuizLocked(e)),!0===e&&o.startQuiz()})),!0}},{procName:a_.UISnapshot,aliases:[a_.SceneSnapshot],mapFnIn:function(e){var t=i.getCanvas(),n=t.width,o=t.height;return Object.assign({width:n,height:o,openInTab:!1,fileType:"jpeg",quality:.92},e)},actionFn:function(e){var i=e.width,o=e.height,r=e.openInTab,a=e.fileType,s=t.selectSnapshot(Lr.getSelectedChapterId);return t.dispatch(new Wn(s,"jpeg"===a?vn.JPEG:vn.PNG,.92,{width:i,height:o},"original",!0,!0)).pipe(Object(rr.a)((function(){return n.pipe(Object(E.j)($n),Object(Ou.a)(1))})),Object(rr.a)((function(e){return zo.blobToBase64(e.blob)})),Object(fn.a)((function(e){r&&e&&function(e){var t=window.open("","_blank");if(t){var n=t.document.createElement("img");n.src=e,t.document.body.appendChild(n)}}(e)})),Object(J.a)((function(){return Object(b_.of)(null)})))}}]}(Human,this.store,this.actions,this.engineService,this.quizService).forEach((function(e){r_(e)})),function(e,t,n,i){return[].concat(c(function(e,t,n){return[{procName:a_.AnnotationsInfo,actionFn:function(){return y_(t)},mapFnOut:function(t){return function(e,t){return t.reduce((function(t,n){return t[n.id]=k_(e,n),t}),{})}(e,t)}},{procName:a_.AnnotationsCreate,mapFnIn:function(i){return function(e,t,n,i){var o=t.selectSnapshot(Lr.getSelectedChapter),r={annotationId:i.annotationId,title:i.title,description:i.description,objectId:e.scene.objects[i.objectId]?i.objectId:void 0,pos:i.position,occludable:i.occludable,labelOffset:i.labelOffset,shown:i.shown,labelShown:i.shown};return r.objectId&&void 0===r.pos&&(r.pos=e.scene.objects[r.objectId].center),n.deserializeAnnotation(r,o,Yn.Annotation)}(e,t,n,i)},actionFn:function(e){return function(e,t){return t.objectId||t.pos?(e.dispatch(new No(t)),t):null}(t,e)},mapFnOut:function(t){return t?k_(e,t):null}},{procName:a_.AnnotationsUpdate,mapFnIn:function(e){return w_(t,e)},actionFn:function(e){return O_(t,e)}},{procName:a_.AnnotationsSetTitle,mapFnIn:function(e){return w_(t,e)},actionFn:function(e){return O_(t,e)},hideDefinition:!0},{procName:a_.AnnotationsSetDescription,mapFnIn:function(e){return w_(t,e)},actionFn:function(e){return O_(t,e)},hideDefinition:!0},{procName:a_.AnnotationsDestroy,mapFnIn:function(e){return x_(t,e)},actionFn:function(e){return function(e,t){return t&&e.dispatch(new Qo(t)),!0}(t,e)}},{procName:a_.ShowAnnotations,actionFn:function(){return C_(t,!0)}},{procName:a_.SetAnnotationsShown,actionFn:function(){return C_(t,!0)},hideDefinition:!0},{procName:a_.HideAnnotations,actionFn:function(){return C_(t,!1)}},{procName:a_.AnnotationsSetLabelsShown,mapFnIn:function(e){return function(e,t){var n=t.annotations,i=t.objects,o=t.replace,r=n||{},a=i||{},s=y_(e),c=Object.assign(Object.assign(Object.assign(Object.assign({},__(r,!0)),__(r,!1)),M_(s,a,!0)),M_(s,a,!1));return o?Object.assign(Object.assign({},S_(s.map((function(e){return e.id})),!1)),c):c}(t,e)},actionFn:function(e){return function(e,t){var n=y_(e),i=P_(n,t,!1),o=P_(n,t,!0);e.dispatch(new er(o,!0)),e.dispatch(new er(i,!1))}(t,e)},hideDefinition:!0}]}(e,t,n)),c(function(e,t,n){return[{procName:a_.HotspotsInfo,actionFn:function(n){var i="number"==typeof n?n:void 0;if(void 0!==i){var o=L_(t,i);return A_(e,t,[o])[0]}var r=B_(t,i);return A_(e,t,r)}},{procName:a_.HotspotsTypes,mapFnIn:function(){return Object.values(yi).map((function(e){return""+e}))},actionFn:function(e){return e}},{procName:a_.HotspotsCreate,mapFnIn:function(e){return function(e,t,n){var i=n.title,o=n.objectId,r=n.position,a=n.direction,s=n.chapterScope,c=n.type,l=e.selectSnapshot(Lr.getStoryChapters),u=e.selectSnapshot(Lr.getSelectedChapter),p=e.selectSnapshot(Lr.getSelectedChapterIndex),d="number"==typeof s?s:p,g=l[d]||u,h=!1!==n.shown,f=h&&!!i,b={title:i,type:c||yi.CircleLabel,objectId:o,pos:r?V_(r):null,dir:a?V_(a):null,shown:h,symbol:"",className:""},v=t.deserializeHotspots({},g,d,b);return v.title=i,v.expandTag=!0,v.flyTo=!1,v.flyToTarget=null,v.occludable=!0,v.pinGlow=!1,v.pinType=Xn.PlusMinus,v.shown=h,v.hideTag=!f,v.hideWire=!0,v.theme=Yn.StudioNext,v.pinType=D_(c),z_(v.id,n),v}(t,n,e)},actionFn:function(e){return function(e,t){return t.objectId||t.pos?(e.dispatch(new No(t)),t):null}(t,e)},mapFnOut:function(e){return e?E_(t,e.id):null}},{procName:a_.HotspotsUpdate,mapFnIn:function(e){return function(e,t){var n=L_(e,t.id);return n?function(e,t){var n=e.title,i=e.objectId,o=e.direction,r=e.position,a=e.shown,s=e.type,c=Object.assign(Object.assign({},t),{title:n,objectId:i,shown:a,pos:r?V_(r):null,dir:o?V_(o):null,pinType:s?D_(s):null});return z_(t.id,e),Object.assign(Object.assign({},t),Object(Se.omitBy)(c,Se.isNil))}(t,n):null}(t,e)},actionFn:function(e){return e?function(e,t){return e.dispatch(new $o(t)),t}(t,e):null}},{procName:a_.HotspotsDestroy,mapFnIn:function(e){return L_(t,e)},actionFn:function(e){return e?function(e,t){return e.dispatch(new Qo(t)),t}(t,e):null}},{procName:a_.HotspotsShow,mapFnIn:function(e){return B_(t,e)},actionFn:function(e){return N_(t,e,!0)}},{procName:a_.HotspotsHide,mapFnIn:function(e){return B_(t,e)},actionFn:function(e){return N_(t,e,!1)}}]}(e,t,n)),[{procName:a_.LabelsInfo,actionFn:function(e){return e.length>0?W_(t,e):t.selectSnapshot(Is.getChapterLabels)},mapFnOut:function(t){return J_(e,t)}},{procName:a_.LabelsCreate,mapFnIn:function(e){return e.labelId&&q_(t,e.labelId)?null:e.objectId&&e.position?function(e,t,n,i){var o=n.makeDefaultStudioLabel();o.id=i.labelId||Tt.idWithPrefix("label"),o.objectId=i.objectId,o.pos=i.position,o.renderableIndex=0,o.occludable=!0,o.flyTo=!0,o.description="",o.shown=!0;var r=t.selectSnapshot(Lr.getSelectedChapter);return o.chapterId=r.id,G_(o,i)}(0,t,n,e):(console.log("attempt to create a label with no objectId and position"),null)},actionFn:function(e){return $_(t,e,!0)},mapFnOut:function(t){return Z_(e,t)}},{procName:a_.LabelsUpdate,mapFnIn:function(e){return q_(t,e.labelId)?function(e,t){return G_(q_(e,t.labelId),t,e.selectSnapshot(Lr.getSelectedChapter))}(t,e):null},actionFn:function(e){return $_(t,e,!1)},mapFnOut:function(t){return Z_(e,t)}},{procName:a_.LabelsCanvasUpdate,mapFnIn:function(e){return q_(t,e.labelId)?function(e,t,n){var i=q_(e,n.labelId),o=n.canvasPosition,r=t.pickScene({x:o[0],y:o[1],rayPick:!0});return r&&r.objectId?(i.objectId=r.objectId,i.pos=[r.worldPos[0],r.worldPos[1],r.worldPos[2]],i.offset=[i.hideWire?20:32,0],i.barycentric=[r.barycentric[0],r.barycentric[1],r.barycentric[2]],i.primitiveIndex=r.primitiveIndex,i.renderableIndex=r.renderableIndex||0,i):null}(t,i,e):null},actionFn:function(e){return $_(t,e,!1)},mapFnOut:function(t){return Z_(e,t)}},{procName:a_.LabelsDestroy,mapFnIn:function(e){return q_(t,e)},actionFn:function(e){return e?(t.dispatch(new Qo(e)),{labelId:e.id}):null}},{procName:a_.LabelsShow,actionFn:function(e){return e.length>0?t.dispatch(new er(W_(t,e),!0)):Q_(t,!0),!0}},{procName:a_.LabelsHide,actionFn:function(e){return e.length>0?t.dispatch(new er(W_(t,e),!1)):Q_(t,!1),!0}},{procName:a_.LabelsSetEnabled,aliases:[a_.AnnotationsSetEnabled],actionFn:function(e){t.dispatch(new Je(e.enable))},hideDefinition:!0},{procName:a_.LabelsSetScale,actionFn:function(e){t.dispatch(new Go(e.scale))}}])}(Human,this.store,this.labelsService,this.engineService).forEach((function(e){r_(e)})),function(e,t){function n(t){return e.selectSnapshot(_o.getQuizModeActive)?t():{error:"quiz mode is not active"}}return[{procName:a_.QuizInfo,actionFn:function(){return n((function(){return ej(e)}))}},{procName:a_.QuizSubmit,actionFn:function(i){return n((function(){return t.submitQuestion(i.questionId,i.answerIds),ej(e)}))}},{procName:a_.QuizQuestion,actionFn:function(){return n((function(){return rj(e)}))}},{procName:a_.QuizEnter,actionFn:function(){return e.selectSnapshot(_o.hasQuiz)?(t.startQuiz(),!0):{error:"quiz not found"}}},{procName:a_.QuizExit,actionFn:function(){return t.exitQuiz(),!0}},{procName:a_.QuizSelectQuestion,actionFn:function(t){return n((function(){return e.dispatch(new io.SetActiveQuestion(t)),ej(e)}))}},{procName:a_.QuizNextQuestion,actionFn:function(){return n((function(){return t.nextQuestion(),rj(e)}))}},{procName:a_.QuizPreviousQuestion,actionFn:function(){return n((function(){return e.dispatch(new io.SetQuizLifecycle(fo.Question)),e.dispatch(new io.PreviousQuestion),rj(e)}))}},{procName:a_.QuizReset,actionFn:function(){return t.resetQuiz(),ej(e)}},{procName:a_.QuizSet,actionFn:function(t){var n=t.settings,i=t.startNumber,o=t.endNumber,r=t.locked;if(!Object(Se.isNil)(n)){var a=e.selectSnapshot(_o.getQuizSettings);e.dispatch(new io.SetQuizSettings(Object.assign(Object.assign({},a),n)))}if("number"==typeof i||"number"==typeof o){var s=uo(e.selectSnapshot(Lr.getStoryChapters)),c=s.slice("number"==typeof i?i-1:0,"number"==typeof o?o:s.length);e.dispatch(new io.SetQuestions(c))}return"boolean"==typeof r&&e.dispatch(new io.SetQuizLocked(r)),e.dispatch(new io.SetQuizQuestionsMode("number"==typeof i&&"number"==typeof o?"restricted":"all")),ej(e)}}]}(this.store,this.quizService).forEach((function(e){r_(e)}))}}]),e}()).\u0275fac=function(e){return new(e||cj)(P.Zb(E.g),P.Zb(E.b),P.Zb(gn),P.Zb(Nt),P.Zb(kr),P.Zb(ec),P.Zb(wi),P.Zb(Ut),P.Zb(td),P.Zb(re),P.Zb(ic),P.Zb(bf))},cj.\u0275prov=P.Lb({token:cj,factory:cj.\u0275fac,providedIn:"root"}),cj),gj=function(e){return e.Content="content",e.SceneJS="scenejs",e}({}),hj=function(e){return e.Auth="auth",e}({}),fj=function e(t,n,i){m(this,e),this.category=t,this.message=n,this.log=i},bj=((uj=function(){function e(t){m(this,e),this.http=t,this.log={}}return v(e,[{key:"logError",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n="".concat(e.category).concat(e.message);return t&&this.log[n]?Object(G.a)():(this.log[n]=!0,this.http.post("/ws/human-error",e))}}]),e}()).\u0275fac=function(e){return new(e||uj)(P.Zb(K.b))},uj.\u0275prov=P.Lb({token:uj,factory:uj.\u0275fac,providedIn:"root"}),uj),vj=((lj=function(){function e(t,n,i){m(this,e),this.locationStrategy=t,this.router=n,this.errorLoggingService=i,window.SceneJS_error.setFatalErrorHandler(this.handleSceneJSFatalErrors.bind(this))}return v(e,[{key:"handleSceneJSFatalErrors",value:function(e){var t={log:Human.log.messages.join("\n"),stack:e.stackTrace,webglInfo:window.SceneJS.WEBGL_INFO},n={category:e.errorName,log:JSON.stringify(t),message:e.messageFromCaller};this.errorLoggingService.logError(n,!0).subscribe();var i=btoa(JSON.stringify(e));this.redirectToErrorPage(gj.SceneJS,void 0,i)}},{key:"redirectToErrorPage",value:function(e,t,n){if(!(this.router.url||"").match("/error")){var i=this.locationStrategy.getBaseHref(),o=this.router.createUrlTree([U.application===M.Viewer?i+"/error":i+"/view/error"],{queryParams:{errorType:e,errorCode:t,errorBlob:n,errorUrl:this.router.url}}),r=this.router.serializeUrl(o);window.location.href=r}}}]),e}()).\u0275fac=function(e){return new(e||lj)(P.Zb(ra.h),P.Zb(Oe.e),P.Zb(bj))},lj.\u0275prov=P.Lb({token:lj,factory:lj.\u0275fac,providedIn:"root"}),lj),mj=["*"],yj=((pj=function(){function e(){m(this,e)}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||pj)},pj.\u0275cmp=P.Jb({type:pj,selectors:[["app-warning-message"]],ngContentSelectors:mj,decls:2,vars:0,consts:[[1,"message","p-4","text-12"]],template:function(e,t){1&e&&(P.kc(),P.Vb(0,"div",0),P.jc(1),P.Ub())},styles:[".message{background-color:#0060c4;color:#fff}@media print{.message{display:none}}"],encapsulation:2,changeDetection:0}),pj),xj=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function kj(e,t){if(1&e){var n=P.Wb();P.Vb(0,"app-warning-message"),P.Vb(1,"div",1),P.Vb(2,"div",2),P.Mc(3),P.Ub(),P.Vb(4,"div"),P.Vb(5,"div",3),P.cc("click",(function(){return P.zc(n),P.gc().handleDismissClick()})),P.Qb(6,"app-icon",4),P.Ub(),P.Ub(),P.Ub(),P.Ub()}if(2&e){var i=P.gc();P.Db(3),P.Oc(" ",i.message," ")}}var wj,Oj,Cj=((Oj=function(){function e(t,n){m(this,e),this.changeDetector=t,this.storageService=n,this.show=!1,this.message="For the full interactive 3D experience please try loading this content in Chrome or Firefox.",this.ngUnsubscribe=new fe.a}return v(e,[{key:"ngOnInit",value:function(){this.initLayoutListener()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"handleDismissClick",value:function(){this.show=!1,this.storageService.setLocalItem(Ls.InternetExplorerWarning,!0)}},{key:"shouldShow",value:function(e){var t=this.storageService.getLocalItem(Ls.InternetExplorerWarning);return Ax()&&!t&&e.internetExplorerWarning.enable}},{key:"initLayoutListener",value:function(){var e=this;this.layout$.pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){e.show=e.shouldShow(t),e.changeDetector.markForCheck()}))}}]),e}()).\u0275fac=function(e){return new(e||Oj)(P.Pb(P.i),P.Pb(As))},Oj.\u0275cmp=P.Jb({type:Oj,selectors:[["app-ie-warning"]],decls:1,vars:1,consts:[[4,"ngIf"],[1,"warning"],[1,"warning__text"],[1,"warning__close",3,"click"],["icon","times","size","lg","title","Close"]],template:function(e,t){1&e&&P.Kc(0,kj,7,1,"app-warning-message",0),2&e&&P.lc("ngIf",!0===t.show)},directives:[ra.l,yj,nl],styles:[".warning[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:center}.warning__text[_ngcontent-%COMP%]{text-align:center;flex:1}.warning__close[_ngcontent-%COMP%]{cursor:pointer;align-items:center;justify-content:center;display:flex;width:32px;height:32px}"],changeDetection:0}),function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);r>3&&a&&Object.defineProperty(t,n,a)}([Object(E.d)(ku.getUI),xj("design:type",be.a)],Oj.prototype,"layout$",void 0),Oj),Sj=((wj=function(){function e(t,n){m(this,e),this.el=t,this.renderer=n}return v(e,[{key:"ngOnInit",value:function(){Ax()||this.renderer.setStyle(this.el.nativeElement,"display","none")}}]),e}()).\u0275fac=function(e){return new(e||wj)(P.Pb(P.m),P.Pb(P.H))},wj.\u0275dir=P.Kb({type:wj,selectors:[["","appShowIE11",""]]}),wj);function _j(e,t){1&e&&P.Qb(0,"div",4)}var jj={title:"We're unable to find the model you're looking for.",description:'Please check your URL or visit the <a href="/" target="_blank">BioDigital Human</a> to see what\'s available in our 3D model library.'},Pj={title:"Your BioDigital Human embed requires proper authentication.",description:""},Mj=u({},X.InvalidUAID,{title:"Authentication Issues",description:"Your Human Widget has invalid user credentials.",url:"https://support.biodigital.com"});function Ij(e,t){if(1&e){var n=P.Wb();P.Vb(0,"button",13),P.cc("click",(function(){return P.zc(n),P.gc(2).handleSeeDetailsClick()})),P.Mc(1," See Details "),P.Ub()}}function zj(e,t){if(1&e&&(P.Vb(0,"textarea",14),P.Mc(1,"        "),P.Ub()),2&e){var n=P.gc(2);P.lc("value",n.sceneJSErrorReport)}}function Tj(e,t){if(1&e){var n=P.Wb();P.Vb(0,"div"),P.Vb(1,"h1",3),P.Mc(2," The BioDigital Human encountered an error. "),P.Ub(),P.Vb(3,"h2",4),P.Mc(4," Error: "),P.Vb(5,"span",5),P.Mc(6),P.Ub(),P.Ub(),P.Vb(7,"div",6),P.Mc(8," To receive assistance with this error, please follow these steps: "),P.Ub(),P.Vb(9,"ol",7),P.Vb(10,"li",8),P.Vb(11,"button",9),P.cc("click",(function(){return P.zc(n),P.gc().handleDownloadClick()})),P.Mc(12," Download "),P.Ub(),P.Mc(13," the error report. "),P.Ub(),P.Vb(14,"li",8),P.Vb(15,"button",9),P.cc("click",(function(){P.zc(n);var e=P.gc();return e.handleActionClick(e.supportURL)})),P.Mc(16," Share the report "),P.Ub(),P.Mc(17," with the customer support team. "),P.Ub(),P.Ub(),P.Vb(18,"div",10),P.Kc(19,Ij,2,0,"button",11),P.Vb(20,"div"),P.Kc(21,zj,2,1,"textarea",12),P.Ub(),P.Ub(),P.Ub()}if(2&e){var i=P.gc();P.Db(6),P.Nc(i.sceneJSErrorTeaser),P.Db(13),P.lc("ngIf",!i.viewSceneJSErrorDetails),P.Db(2),P.lc("ngIf",i.viewSceneJSErrorDetails)}}function Uj(e,t){if(1&e){var n=P.Wb();P.Vb(0,"div",3),P.Mc(1),P.Ub(),P.Vb(2,"div",15),P.Tb(3),P.Vb(4,"button",9),P.cc("click",(function(){P.zc(n);var e=P.gc();return e.handleActionClick(e.supportURL)})),P.Mc(5," Contact Support "),P.Ub(),P.Sb(),P.Ub(),P.Qb(6,"div",16)}if(2&e){var i=P.gc();P.Db(1),P.Oc(" ",i.title," "),P.Db(5),P.lc("innerHTML",i.description,P.Ac)}}var Lj,Dj,Ej,Fj,Aj,Rj,Vj=[{path:"",component:(Dj=function(){function e(t,n,i,o,r,a,s,c,l,u,p){m(this,e),this.store=t,this.actions=n,this.activatedRoute=i,this.widgetAPIHandler=o,this.errorService=r,this.engineService=a,this.cameraService=s,this.storageService=c,this.renderer=l,this.viewService=u,this.quizService=p,this.title="Biodigital Human",this.environmentApplication=M,this.environmentPlatform=T,this.ngUnsubscribe=new fe.a}return v(e,[{key:"ngOnInit",value:function(){this.initErrorHandling(),this.initInteractions();var e=this.activatedRoute.snapshot.data.widgetUrlConfig;this.initWidgetBreakpoints(e),this.initWidgetLabelScale(e),this.initWidgetLayout(e),this.initWidgetSetup(e),this.initWidgetAuth(),this.initSceneLoad(),this.initBackgroundFromWidget(e),this.initBackgroundFromChapter(),this.initCamera(e),this.initRotation(e),this.initQuizInteractions(e),this.widgetAPIHandler.listen(U.deploy===z.Production),this.initChaptersReadyListener(),this.initHumanReadyListener(),this.initDynamicLayout()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initWidgetSetup",value:function(e){var t=window!==window.top,n=t?BD_DOCUMENT_REFERRER:window.location.href;this.store.dispatch(new A(n,t,e));var i=this.store.selectSnapshot(ku.getUI),o=Rp.convertUrlUIConfigToUIConfig(e),r=Rp.createLayoutFromConfig(i,o);this.store.dispatch(new j.SetUI(r)),this.store.dispatch(new j.SetInitialUI(r));var a=Rp.getScrollSetting(e);this.store.dispatch(new Te(a));var s=Rp.getUsePrintImage(e),c=Rp.getOnDemand(e),l=Rp.getInteractType(e,this.store.selectSnapshot(ku.shouldWindowOpen(nu.Interact)),this.store.selectSnapshot(ku.getInteractType)),u=l.interactType,p=l.isInteractActive,d=this.storageService.getLocalItem(Ls.GettingStartedTutorial),g=!0===o.tutorial&&"true"!==d;this.store.dispatch([new j.SetOnDemand(c),new j.ToggleWindow(nu.OnDemand,c),new j.SetInteractType(u),new j.ToggleWindow(nu.Interact,p),new j.ToggleWindow(nu.Tutorial,g),new j.StartTutorial(g),new j.SetUsePrintImage(s)])}},{key:"initWidgetAuth",value:function(){this.store.selectSnapshot(he.getEmbedded)&&this.store.dispatch(new B)}},{key:"initViewAnalytics",value:function(){var e=this,t=["loaded","interactive","complete"].includes(document.readyState);(t?Object(G.a)(t):Object(Zr.a)(document,"DOMContentLoaded")).pipe(Object(Ou.a)(1),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(){e.store.dispatch(new R(ue.View))}))}},{key:"initInteractionAnalytics",value:function(){var e=this;Object(Kr.a)(this.interactionChance$,this.firstInteraction$).pipe(Object(Ou.a)(1),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(){e.store.dispatch(new R(ue.ChanceInteraction))})),this.firstInteraction$.pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(){e.store.dispatch(new R(ue.FirstInteraction))}))}},{key:"initSceneLoad",value:function(){var e=this;this.actions.pipe(Object(E.j)(_a),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(){e.initViewAnalytics(),e.initInteractionAnalytics()}))}},{key:"initErrorHandling",value:function(){var e=this;this.actions.pipe(Object(E.j)(Fa),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(){return e.handleContentErrors()})),this.actions.pipe(Object(E.j)(Q),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){return e.handleAuthErrors(t)}))}},{key:"initWidgetBreakpoints",value:function(e){var t=[e["ui-collapse-label"],e["annotation-collapse"]].find((function(e){return!Object(Se.isNil)(e)}));Object(Se.isNil)(t)||this.store.dispatch(new j.SetLabelBreakpoint(t))}},{key:"initWidgetLabelScale",value:function(e){var t=e["label-scale"];Object(Se.isNil)(t)||this.store.dispatch(new Go(t))}},{key:"initWidgetLayout",value:function(e){var t=e["ui-layout"];Object(Se.isNil)(t)||this.store.dispatch(new j.SetLayout(t))}},{key:"initQuizInteractions",value:function(e){var t=this;this.store.select(_o.hasQuiz).pipe(Object(me.a)((function(e){return e})),Object(Ou.a)(1),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(){var n=t.store.selectSnapshot(_o.getAllQuestions);t.store.dispatch(new io.SetQuizEnabled(""+e.uiQuiz!="false"));var i=e["ui-quiz-locked"];t.store.dispatch(new io.SetQuizLocked(""+i=="true"));var o=parseInt(e["ui-quiz-start"],10),r=parseInt(e["ui-quiz-end"],10),a=n.length,s=isNaN(o)?1:o,c=isNaN(r)?a:r;if(1!==s||c!==a){var l=n.filter((function(e,t){var n=t+1;return n>=s&&n<=c}));t.store.dispatch(new io.SetQuestions(l))}var u=isNaN(o)&&isNaN(r)?"all":"restricted";t.store.dispatch(new io.SetQuizQuestionsMode(u)),i&&setTimeout((function(){t.quizService.startQuiz()}))}))}},{key:"initInteractions",value:function(){var e=this.getCanvasInteraction(),t=this.actions.pipe(Object(E.j)(pi.UpdateNodeSelected,pi.UpdateNodesChecked,pi.UpdateNodesShown,pi.UpdateNodesPickable,pi.UpdateNodesPaint));this.interactionReady$=this.store.select(Lr.getSelectedChapter).pipe(Object(me.a)((function(e){return e&&e.readyState.model})),Object(Ou.a)(1));var n=this.engineService.getCanvas();this.interactionChance$=Object(Qa.a)(this.interactionReady$,this.getIntersectionObserver(n,.75)).pipe(Object(Ou.a)(1)),this.firstInteraction$=Object(Kr.a)(e,t).pipe(Object(hO.a)(this.interactionReady$),Object(Ou.a)(1))}},{key:"initBackgroundFromWidget",value:function(e){var t=this,n=e.background;n&&(this.setWidgetTransparent(ai.isTransparent(n)),this.actions.pipe(Object(E.i)(Sn),Object(Ou.a)(1),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(){t.store.dispatch(new An(n))})))}},{key:"initBackgroundFromChapter",value:function(){var e=this;this.store.select(Lr.getSelectedChapter).pipe(Object(me.a)((function(e){return null!=e})),Object(Z.a)((function(e){return ai.isTransparent(e.background)})),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){e.setWidgetTransparent(t)}))}},{key:"initCamera",value:function(e){var t=this,n=e.camera;n&&this.actions.pipe(Object(E.j)(La),Object(Ou.a)(1),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(){t.store.dispatch(new $t(n,!1))}))}},{key:"initRotation",value:function(e){var t=this,n=e["load-rotate"];if(n){var i=performance.now();Object(i_.a)(0,o_.a).pipe(Object(Z.a)((function(){return n*(performance.now()-i)*.001})),Object(fn.a)((function(){return i=performance.now()})),Object(ve.a)(this.firstInteraction$),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(e){t.cameraService.rotateCameraStatic(0,e)})),this.firstInteraction$.pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(){var e=t.store.selectSnapshot(Lr.getSelectedChapter),n=Object(Se.get)(e,"camera.location");n&&t.store.dispatch(new $t(n,!0,2))}))}}},{key:"initHumanReadyListener",value:function(){var e=this;this.actions.pipe(Object(E.j)(U.platform===T.SDK?Ha:Ba)).pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(){e.engineService.fireEvent(Dt.Started,null)}))}},{key:"initChaptersReadyListener",value:function(){var e=this;this.store.select(Lr.getAllChaptersModelsReady).pipe(Object(me.a)((function(e){return!0===e})),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(){e.store.dispatch(new Ba),e.engineService.fireEvent(Dt.TimelineChaptersActivated,{oldChapterIndex:0,newChapterIndex:0,time:0})}))}},{key:"initDynamicLayout",value:function(){var e=this;Object(Gr.b)([this.store.select(he.getWidgetApiUIConfig),this.store.select(he.getWidgetUrlConfig),this.store.select(Lr.getSelectedChapter),this.store.select(_o.getQuizModeActive),this.store.select(_o.getActiveQuestion)]).pipe(Object(me.a)((function(e){var t=p(e,3),n=(t[0],t[1]);return null!=t[2]&&null!=n})),Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){var n=p(t,5),i=n[0],o=n[1],r=n[2],a=n[3],s=(n[4],Rp.convertUrlUIConfigToUIConfig(o)),c=Rp.chapterUItoUIConfig(r.ui),l=Rp.generateQuizUIConfig();e.viewService.setUI({apiUIConfig:i,urlUIConfig:s,chapterUIConfig:c,quizUIConfig:a?l:null})}))}},{key:"handleContentErrors",value:function(){this.store.dispatch(new za(null,null)),this.errorService.redirectToErrorPage(gj.Content)}},{key:"handleAuthErrors",value:function(e){U.deploy!==z.Local&&this.errorService.redirectToErrorPage(hj.Auth,e.response.errorCode)}},{key:"getCanvasInteraction",value:function(){var e,t=this;return new be.a((function(n){var i=t.engineService.getCanvas();(e=new Ks.Manager(i)).add([new Ks.Tap({event:"singletap"}),new Ks.Tap({event:"doubletap",taps:2}),new Ks.Pan({event:"pan",direction:Ks.DIRECTION_ALL,threshold:0})]);var o=(function(){return n.next()}).bind(t);e.on("panstart",o),e.on("singletap",o)})).pipe(Object(se.a)((function(){e&&(e.destroy(),e=null)})),Object(ve.a)(this.ngUnsubscribe))}},{key:"getIntersectionObserver",value:function(e,t){return new be.a((function(n){var i=new IntersectionObserver((function(o){o[0].intersectionRatio>=t&&(n.next(e),n.complete(),i.unobserve(e))}),{root:null,threshold:t});i.observe(e)}))}},{key:"setWidgetTransparent",value:function(e){e?this.renderer.setStyle(document.body,"background","none transparent"):this.renderer.removeStyle(document.body,"background")}}]),e}(),Dj.\u0275fac=function(e){return new(e||Dj)(P.Pb(E.g),P.Pb(E.b),P.Pb(Oe.a),P.Pb(dj),P.Pb(vj),P.Pb(Nt),P.Pb(gn),P.Pb(As),P.Pb(P.H),P.Pb(td),P.Pb(bf))},Dj.\u0275cmp=P.Jb({type:Dj,selectors:[["app-widget-master"]],decls:5,vars:3,consts:[[1,"widget","theme-light"],[1,"widget__messages","pt-2","pr-2","pl-2"],["appShowIE11",""],["class","widget-shell",4,"appFlagApplication","appFlagApplicationPlatform","appFlagApplicationMode"],[1,"widget-shell"]],template:function(e,t){1&e&&(P.Vb(0,"div",0),P.Qb(1,"router-outlet"),P.Vb(2,"div",1),P.Qb(3,"app-ie-warning",2),P.Ub(),P.Ub(),P.Kc(4,_j,1,0,"div",3)),2&e&&(P.Db(4),P.lc("appFlagApplication",t.environmentApplication.All)("appFlagApplicationPlatform",t.environmentPlatform.SDK)("appFlagApplicationMode","exclude"))},directives:[Oe.g,Cj,Sj,bl],styles:[".widget__messages[_ngcontent-%COMP%]{display:flex;flex-direction:column;z-index:101}.widget-shell[_ngcontent-%COMP%], .widget__messages[_ngcontent-%COMP%]{position:fixed;top:0;left:0;right:0}.widget-shell[_ngcontent-%COMP%]{pointer-events:none;bottom:0;z-index:99999;border:var(--widget-shell-border)}"]}),Dj),resolve:{widgetUrlConfig:n_},children:[{path:"",component:t_},{path:"error",component:(Lj=function(){function e(t,n){m(this,e),this.route=t,this.snackBar=n,this.supportURL="https://support.biodigital.com",this.isSceneJSError=!1,this.viewSceneJSErrorDetails=!1}return v(e,[{key:"handleSeeDetailsClick",value:function(){this.viewSceneJSErrorDetails=!0}},{key:"buildSceneJSErrorReport",value:function(e,t){return{contentId:e,error:JSON.parse(atob(t)),webglInfo:window.SceneJS.WEBGL_INFO}}},{key:"title",get:function(){return this.errorConfig.title}},{key:"description",get:function(){return this.errorConfig.description}},{key:"ngOnInit",value:function(){var e=this.route.snapshot.queryParams,t=e.errorType,n=e.errorCode,i=e.errorBlob,o=e.errorUrl;if(t===gj.SceneJS){this.isSceneJSError=!0;var r=this.buildSceneJSErrorReport(o,i);this.sceneJSErrorTeaser=r.error.errorName,this.sceneJSErrorReport=JSON.stringify(r,null,2)}else this.errorConfig=t===gj.Content?jj:Mj[n]||Pj}},{key:"handleDownloadClick",value:function(){Object(ur.saveAs)(new Blob([this.sceneJSErrorReport],{type:"text/plain"}),"BioDigital_Error_Report.txt")}},{key:"handleActionClick",value:function(e){window.open(e)||this.snackBar.open("Unable to open link in new window, please check your pop-up settings.")}}]),e}(),Lj.\u0275fac=function(e){return new(e||Lj)(P.Pb(Oe.a),P.Pb(ol.b))},Lj.\u0275cmp=P.Jb({type:Lj,selectors:[["app-error-page"]],decls:4,vars:2,consts:[[1,"error"],[4,"ngIf","ngIfElse"],["notSceneJSError",""],[1,"text-24","text-bold"],[1,"text-16","mt-4","mb-8"],[1,"text-semibold"],[1,"text-16","mb-4"],[1,"text-16"],[1,"mv-4"],["app-button","","buttonType","outline","buttonTheme","light",3,"click"],[1,"mt-8"],["app-button","","buttonType","outline","buttonTheme","light","buttonSize","xsmall",3,"click",4,"ngIf"],["class","error__details mt-2",3,"value",4,"ngIf"],["app-button","","buttonType","outline","buttonTheme","light","buttonSize","xsmall",3,"click"],[1,"error__details","mt-2",3,"value"],[1,"flex","items-start","mt-10"],[1,"error__description","text-16","mt-8",3,"innerHTML"]],template:function(e,t){if(1&e&&(P.Vb(0,"div",0),P.Kc(1,Tj,22,3,"div",1),P.Kc(2,Uj,7,2,"ng-template",null,2,P.Lc),P.Ub()),2&e){var n=P.vc(3);P.Db(1),P.lc("ngIf",t.isSceneJSError)("ngIfElse",n)}},directives:[ra.l,gl],styles:[".error[_ngcontent-%COMP%]{margin:0 auto;max-width:640px;display:flex;flex-direction:column;padding:40px;color:#283853}.error[_ngcontent-%COMP%]   ol[_ngcontent-%COMP%]{list-style:decimal}.error__details[_ngcontent-%COMP%]{width:100%;height:200px}.error__description[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .error__description[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:visited{color:#283853}"],changeDetection:0}),Lj)}]}],Nj=!0===U.offline?Oe.f.forRoot(Vj,{useHash:!0}):Oe.f.forRoot(Vj),Bj=((Ej=function e(){m(this,e)}).\u0275mod=P.Nb({type:Ej}),Ej.\u0275inj=P.Mb({factory:function(e){return new(e||Ej)},providers:[n_],imports:[[Nj],Oe.f]}),Ej),Hj=h("f6nW"),Qj=h("FvrZ"),qj=h("bSwM"),Wj=h("FKr1"),$j=h("bTqV"),Kj=h("d3UM"),Gj=h("/t3+"),Zj=h("jaxi"),Jj=h("XhcP"),Xj=h("bv9b"),Yj={disabled:!0,animation:{enterDuration:0,exitDuration:0}},eP=Object.assign(Object.assign({},Object(mg.b)()),{touchGestures:"off"}),tP=((Fj=function e(){m(this,e)}).\u0275mod=P.Nb({type:Fj}),Fj.\u0275inj=P.Mb({factory:function(e){return new(e||Fj)},providers:[{provide:ol.a,useValue:{duration:3e3}},{provide:Wj.d,useValue:Yj},{provide:mg.a,useValue:eP}],imports:[[Mr.b,Hj.a,qj.a,qj.a,$j.b,Fb.c,Kj.a,hl.c,Gj.a,Zj.a,ug.f,mg.d,ol.c,vl.b,Jj.a,kc.g,Pf.f,If.f],Mr.b,Hj.a,Qj.a,qj.a,qj.a,$j.b,Fb.c,Kj.a,hl.c,Gj.a,Zj.a,ug.f,mg.d,ol.c,vl.b,Jj.a,kc.g,Pf.f,If.f,Xj.a]}),Fj),nP=h("R9Cn"),iP=((Rj=function e(){m(this,e)}).\u0275mod=P.Nb({type:Rj}),Rj.\u0275inj=P.Mb({factory:function(e){return new(e||Rj)},imports:[[tP,eh.i,ra.c]]}),Rj),oP=((Aj=function e(){m(this,e)}).\u0275mod=P.Nb({type:Aj}),Aj.\u0275inj=P.Mb({factory:function(e){return new(e||Aj)},imports:[[ra.c,eh.i]]}),Aj),rP=function e(){m(this,e)};function aP(){return window}var sP,cP,lP,uP,pP,dP=((cP=function(){function e(t){var n=this;if(m(this,e),!t.accountUrl)throw new Error("Missing accountUrl. Please set in app config via ZendeskWidgetProvider");this.window=aP();var i=this.window;i.zEmbed||function(e,n){var o,r,a,s,c=[],l=document.createElement("iframe");i.zEmbed=function(){c.push(arguments)},i.zE=i.zE||i.zEmbed,l.src="javascript:false",l.title="",l.style.cssText="display: none",(a=(a=document.getElementsByTagName("script"))[a.length-1]).parentNode.insertBefore(l,a),s=l.contentWindow.document;try{r=s}catch(e){o=document.domain,l.src='javascript:var d=document.open();d.domain="'+o+'";void(0);',r=s}r.open()._l=function(){var e=this.createElement("script");o&&(this.domain=o),e.id="js-iframe-async",e.src="https://assets.zendesk.com/embeddable_framework/main.js",this.t=+new Date,this.zendeskHost=t.accountUrl,this.zEQueue=c,this.body.appendChild(e)},r.write('<body onload="document._l();">'),r.close()}(),this.window.zE((function(){t.beforePageLoad(n.window.zE)}))}return v(e,[{key:"setLocale",value:function(e){var t=this;this.window.zE((function(){t.window.zE.setLocale(e)}))}},{key:"identify",value:function(e){var t=this,n={name:this.getUserFullName(e),email:e.email};this.window.zE((function(){t.window.zE.identify(n)}))}},{key:"hide",value:function(){var e=this;this.window.zE((function(){e.window.zE.hide()}))}},{key:"show",value:function(){var e=this;this.window.zE((function(){e.window.zE.show()}))}},{key:"activate",value:function(e){var t=this;this.window.zE((function(){t.window.zE.activate(e)}))}},{key:"setHelpCenterSuggestions",value:function(e){var t=this;this.window.zE((function(){t.window.zE.setHelpCenterSuggestions(e)}))}},{key:"setSettings",value:function(e){this.window.zESettings=e}},{key:"updateFromProfile",value:function(e){var t=[];if(null!=e){var n=e.premium_account,i=e.premium_account_type,o=e.developer_account,r=e.subscription;n?(t.push("premium_account_"+i),r&&t.push("subscription_"+r.subscription_provider)):t.push("free_account"),o&&t.push("developer_account")}var a=Object(Se.get)(e,"premium_account_valid",!1);this.setSettings({webWidget:{position:{horizontal:"right",vertical:"bottom"},offset:{horizontal:"0px",vertical:"0px"},contactForm:{suppress:!a,tags:t,fields:[{id:"name",prefill:{"*":this.getUserFullName(e)}}]}}})}},{key:"getUserFullName",value:function(e){if(e){var t=e.first_name,n=e.last_name;return"".concat(t," ").concat(n)}return""}}]),e}()).\u0275fac=function(e){return new(e||cP)(P.Zb(rP))},cP.\u0275prov=P.Lb({token:cP,factory:cP.\u0275fac,providedIn:"root"}),cP),gP=((sP=function(){function e(){m(this,e)}return v(e,null,[{key:"forRoot",value:function(t){return{ngModule:e,providers:[{provide:t,useClass:t},{provide:dP,useClass:dP,deps:[t]}]}}}]),e}()).\u0275mod=P.Nb({type:sP}),sP.\u0275inj=P.Mb({factory:function(e){return new(e||sP)},imports:[[ra.c]]}),sP),hP=function(e){t(o,e);var n=i(o);function o(){var e;return m(this,o),(e=n.apply(this,arguments)).accountUrl="biodigital.zendesk.com",e}return v(o,[{key:"beforePageLoad",value:function(e){e.setLocale("en"),e.hide()}}]),o}(rP),fP=((pP=function e(){m(this,e)}).\u0275mod=P.Nb({type:pP}),pP.\u0275inj=P.Mb({factory:function(e){return new(e||pP)},imports:[[gP.forRoot(hP)]]}),pP),bP=((uP=function e(){m(this,e)}).\u0275mod=P.Nb({type:uP}),uP.\u0275inj=P.Mb({factory:function(e){return new(e||uP)},imports:[[ra.c]]}),uP),vP=((lP=function e(){m(this,e)}).\u0275mod=P.Nb({type:lP}),lP.\u0275inj=P.Mb({factory:function(e){return new(e||lP)},imports:[[ra.c,bP,tP]]}),lP);function mP(e,t){if(1&e){var n=P.Wb();P.Vb(0,"div",6),P.cc("click",(function(){P.zc(n);var e=P.gc(2).$implicit;return P.gc().handleExpandClick(e,!0)})),P.Ub()}if(2&e){var i=P.gc(2).$implicit;P.lc("title",i.label)}}function yP(e,t){if(1&e&&(P.Vb(0,"div",4),P.Kc(1,mP,1,1,"div",5),P.Qb(2,"app-tree-group",2),P.Ub()),2&e){var n=P.gc().$implicit,i=P.gc();P.Db(1),P.lc("ngIf",i.hasChildren(n)),P.Db(1),P.lc("graph",i.graph)("node",n)("theme",i.theme)}}var xP=function(e,t){return{"tree-group--light":e,"tree-group--themed":t}};function kP(e,t){if(1&e&&(P.Vb(0,"div",1),P.Qb(1,"app-tree-nested-node",2),P.Kc(2,yP,3,4,"div",3),P.Ub()),2&e){var n=t.$implicit,i=P.gc();P.lc("ngClass",P.pc(5,xP,i.theme===i.treeTheme.Light,i.theme===i.treeTheme.Themed)),P.Db(1),P.lc("graph",i.graph)("node",n)("theme",i.theme),P.Db(1),P.lc("ngIf",n.boolState.expanded)}}var wP,OP,CP,SP,_P=((SP=function(){function e(t,n){m(this,e),this.graphService=t,this.store=n,this.treeTheme=mc,this.graphSubject=new $r.a(null),this.theme=mc.Dark,this.nodes=[],this.ngUnsubscribe=new fe.a}return v(e,[{key:"graph",get:function(){return this._graph},set:function(e){e&&(this._graph=e,this.graphSubject.next(e))}},{key:"ngOnInit",value:function(){var e=this;this.graphSubject.pipe(Object(ve.a)(this.ngUnsubscribe)).subscribe((function(t){t&&e.getNodes()}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"getNodes",value:function(){var e=this.node?ke.getSuccessors(this.graph,this.node.id):ke.getRoots(this.graph);this.nodes=this.graphService.getNodes(this.graph,e)}},{key:"countChildren",value:function(e){return ke.getSuccessors(this.graph,e.id).length}},{key:"hasChildren",value:function(e){return this.countChildren(e)>0}},{key:"trackTreeNode",value:function(e,t){return t.id}},{key:"handleExpandClick",value:function(e,t){this.store.dispatch(t?new bt(e):new ft(e))}}]),e}()).\u0275fac=function(e){return new(e||SP)(P.Pb(Ut),P.Pb(E.g))},SP.\u0275cmp=P.Jb({type:SP,selectors:[["app-tree-group"]],inputs:{graph:"graph",theme:"theme",node:"node"},decls:1,vars:2,consts:[["class","tree-group",3,"ngClass",4,"ngFor","ngForOf","ngForTrackBy"],[1,"tree-group",3,"ngClass"],[3,"graph","node","theme"],["class","tree-group__children",4,"ngIf"],[1,"tree-group__children"],["class","tree-group__collapse",3,"title","click",4,"ngIf"],[1,"tree-group__collapse",3,"title","click"]],template:function(e,t){1&e&&P.Kc(0,kP,3,8,"div",0),2&e&&P.lc("ngForOf",t.nodes)("ngForTrackBy",t.trackTreeNode)},directives:[ra.k,ra.i,ql,ra.l,SP],styles:['.text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3838}.text-info[_ngcontent-%COMP%]{color:#0060c4}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.tree-group[_ngcontent-%COMP%]{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.tree-group--themed[_ngcontent-%COMP%]   .tree-group__collapse[_ngcontent-%COMP%]:after{background:var(--tree-node-collapse-color)}.tree-group--themed[_ngcontent-%COMP%]   .tree-group__collapse[_ngcontent-%COMP%]:hover{background:transparent}.tree-group--themed[_ngcontent-%COMP%]   .tree-group__collapse[_ngcontent-%COMP%]:hover:after{background:var(--tree-node-collapse-color--hover)}.tree-group--light[_ngcontent-%COMP%]   .tree-group__collapse[_ngcontent-%COMP%]:after{background:#eaeff5}.tree-group--light[_ngcontent-%COMP%]   .tree-group__collapse[_ngcontent-%COMP%]:hover{background:transparent}.tree-group--light[_ngcontent-%COMP%]   .tree-group__collapse[_ngcontent-%COMP%]:hover:after{background:#d7e0ea}.tree-group__children[_ngcontent-%COMP%]{padding-left:20px;position:relative}.tree-group__collapse[_ngcontent-%COMP%]{position:absolute;left:0;top:0;bottom:0;width:20px;z-index:1}.tree-group__collapse[_ngcontent-%COMP%]:after{content:" ";display:block;position:absolute;width:1px;left:10px;top:0;bottom:0;background:#1c2a3f}.tree-group__collapse[_ngcontent-%COMP%]:hover{cursor:pointer}.tree-group__collapse[_ngcontent-%COMP%]:hover:after{background:#283853}'],changeDetection:0}),SP),jP=((CP=function e(){m(this,e)}).\u0275mod=P.Nb({type:CP}),CP.\u0275inj=P.Mb({factory:function(e){return new(e||CP)},imports:[[ra.c]]}),CP),PP=((OP=function e(){m(this,e)}).\u0275mod=P.Nb({type:OP}),OP.\u0275inj=P.Mb({factory:function(e){return new(e||OP)},imports:[[ra.c,jP,tP,vP,bP,Ce.d]]}),OP),MP=((wP=function e(){m(this,e)}).\u0275mod=P.Nb({type:wP}),wP.\u0275inj=P.Mb({factory:function(e){return new(e||wP)},imports:[[ra.c,bP,tP,PP,jP,Ce.d]]}),wP);P.Dc(yc,[_P],[ra.b]);var IP,zP,TP,UP,LP,DP,EP,FP,AP,RP,VP,NP,BP,HP=((AP=function e(){m(this,e)}).\u0275mod=P.Nb({type:AP}),AP.\u0275inj=P.Mb({factory:function(e){return new(e||AP)},imports:[[ra.c]]}),AP),QP=((FP=function e(){m(this,e)}).\u0275mod=P.Nb({type:FP}),FP.\u0275inj=P.Mb({factory:function(e){return new(e||FP)},imports:[[ra.c,yf.b,tP,HP,jP]]}),FP),qP=((EP=function e(){m(this,e)}).\u0275mod=P.Nb({type:EP}),EP.\u0275inj=P.Mb({factory:function(e){return new(e||EP)},imports:[[ra.c]]}),EP),WP=((DP=function e(){m(this,e)}).\u0275mod=P.Nb({type:DP}),DP.\u0275inj=P.Mb({factory:function(e){return new(e||DP)},imports:[[ra.c]]}),DP),$P=((LP=function e(){m(this,e)}).\u0275mod=P.Nb({type:LP}),LP.\u0275inj=P.Mb({factory:function(e){return new(e||LP)},imports:[[ra.c,vP,tP,Ce.d]]}),LP),KP=((UP=function e(){m(this,e)}).\u0275mod=P.Nb({type:UP}),UP.\u0275inj=P.Mb({factory:function(e){return new(e||UP)},imports:[[ra.c]]}),UP),GP=((TP=function e(){m(this,e)}).\u0275mod=P.Nb({type:TP}),TP.\u0275inj=P.Mb({factory:function(e){return new(e||TP)},imports:[[ra.c,HP]]}),TP),ZP=((zP=function e(){m(this,e)}).\u0275mod=P.Nb({type:zP}),zP.\u0275inj=P.Mb({factory:function(e){return new(e||zP)},imports:[[ra.c,bP]]}),zP),JP=((IP=function e(){m(this,e)}).\u0275mod=P.Nb({type:IP}),IP.\u0275inj=P.Mb({factory:function(e){return new(e||IP)},imports:[[Oe.f,vP,QP,nP.a,GP,ra.c,jP,bP,qP,iP,tP,ZP,PP,$P,WP,HP,eh.q,oP,KP,MP,fP,Dd.a.forChild()],vP,QP,GP,jP,qP,bP,iP,ZP,PP,WP,$P,HP,oP,KP,MP]}),IP),XP=function e(){m(this,e)},YP=function(){var e=function e(t){m(this,e),this.widgetURL=t};return e.type="[Publish] Set Widget URL",e}(),eM=function(){var e=function e(t){m(this,e),this.dimensions=t};return e.type="[Publish] Set Dimensions",e}(),tM=function(){var e=function e(t,n,i){m(this,e),this.model=t,this.widgetOptions=n,this.camera=i};return e.type="[Publish] Get iFrame",e}(),nM=function(){var e=function e(t){m(this,e),this.embed=t};return e.type="[Publish] Get iFrame Success",e}(),iM=function(){var e=function e(){m(this,e)};return e.type="[Publish] Get iFrame Fail",e}(),oM=function(){var e=function e(t,n,i){m(this,e),this.model=t,this.widgetOptions=n,this.camera=i};return e.type="[Publish] Get URL",e}(),rM=function(){var e=function e(t,n){m(this,e),this.model=t,this.url=n};return e.type="[Publish] Get URL Success",e}(),aM=function(){var e=function e(t){m(this,e),this.model=t};return e.type="[Publish] Get URL Fail",e}(),sM=function(){var e=function e(t){m(this,e),this.publishing=t};return e.type="[Publish] Set Publishing",e}(),cM=function(){var e=function e(){m(this,e)};return e.type="[Publish] Reset Publishing",e}(),lM=function(){var e=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"jpeg";m(this,e),this.imageData=t,this.imageType=n};return e.type="[Publish] Save Publish Image",e}(),uM=function(){var e=function e(t){m(this,e),this.imageURL=t};return e.type="[Publish] Save Publish Image Success",e}(),pM=function(){var e=function e(){m(this,e)};return e.type="[Publish] Save Publish Image Fail",e}(),dM=function(){var e=function e(t,n,i,o,r){m(this,e),this.model=t,this.imageData=n,this.fileType=i,this.widgetOptions=o,this.camera=r};return e.type="[Publish] Get Publish Image Code",e}(),gM=function(){var e=function e(t){m(this,e),this.embed=t};return e.type="[Publish] Get Publish Image Code Success",e}(),hM=function(){var e=function e(){m(this,e)};return e.type="[Publish] Get Publish Image Code Fail",e}(),fM=function e(){m(this,e)},bM=function(){var e=function e(){m(this,e)};return e.type="[Auth] Is Logged In",e}(),vM=function(){var e=function e(){m(this,e)};return e.type="[Auth] Is Logged In Success",e}(),mM=function(){var e=function e(){m(this,e)};return e.type="[Auth] Is Logged In Failure",e}(),yM=function(){var e=function e(t){m(this,e),this.login=t};return e.type="[Auth] Login With Biodigital",e}(),xM=function(){var e=function e(t){m(this,e),this.login=t};return e.type="[Auth] Login With Google",e}(),kM=function(){var e=function e(t){m(this,e),this.login=t};return e.type="[Auth] Login With Facebook",e}(),wM=function(){var e=function e(t,n){m(this,e),this.loginType=t,this.response=n};return e.type="[Auth] Login Success",e}(),OM=function(){var e=function e(t,n,i){m(this,e),this.loginType=t,this.error=n,this.login=i};return e.type="[Auth] Login Failure",e}(),CM=function(){var e=function e(){m(this,e)};return e.type="[Auth] Logout",e}(),SM=function(){var e=function e(){m(this,e)};return e.type="[Auth] Logout Success",e}(),_M=function(){var e=function e(){m(this,e)};return e.type="[Auth] Logout Failure",e}(),jM=function(){var e=function e(){m(this,e)};return e.type="[Auth] Get Environment Settings",e}(),PM=function(){var e=function e(t){m(this,e),this.environmentSettings=t};return e.type="[Auth] Get Environment Settings Success",e}(),MM=function(){var e=function e(t){m(this,e),this.error=t};return e.type="[Auth] Get Environment Settings Failure",e}(),IM=function(){var e=function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];m(this,e),this.hardCheck=t};return e.type="[Auth] Get User Profile",e}(),zM=function(){var e=function e(t){m(this,e),this.userProfile=t};return e.type="[Auth] Get User Profile Success",e}(),TM=function(){var e=function e(t){m(this,e),this.error=t};return e.type="[Auth] Get User Profile Failure",e}(),UM=function(){var e=function e(t){m(this,e),this.userProfile=t};return e.type="[Auth] Update User Profile",e}(),LM=function(){var e=function e(t){m(this,e),this.userProfile=t};return e.type="[Auth] Update User Profile Success",e}(),DM=function(){var e=function e(t){m(this,e),this.error=t};return e.type="[Auth] Update User Profile Failure",e}(),EM=function(){var e=function e(){m(this,e)};return e.type="[Auth] Delete User Profile",e}(),FM=function(){var e=function e(t){m(this,e),this.userEmail=t};return e.type="[Auth] Delete User Profile Success",e}(),AM=function(){var e=function e(t){m(this,e),this.error=t};return e.type="[Auth] Delete User Profile Failure",e}(),RM=function(){var e=function e(t){m(this,e),this.email=t};return e.type="[Auth] Check Profile",e}(),VM=function(){var e=function e(t){m(this,e),this.profile=t};return e.type="[Auth] Check Profile Success",e}(),NM=function(){var e=function e(t){m(this,e),this.error=t};return e.type="[Auth] Check Profile Failure",e}(),BM=function(){var e=function e(){m(this,e)};return e.type="[Auth] Get User Roles",e}(),HM=function(){var e=function e(t){m(this,e),this.email=t};return e.type="[Auth] Reset Password",e}(),QM=function(){var e=function e(t){m(this,e),this.email=t};return e.type="[Auth] Reset Password Success",e}(),qM=function(){var e=function e(t){m(this,e),this.error=t};return e.type="[Auth] Reset Password Failure",e}(),WM=function(){var e=function e(t,n,i){m(this,e),this.currentPassword=t,this.newPassword=n,this.confirmNewPassword=i};return e.type="[Auth] Update Password",e}(),$M=function(){var e=function e(){m(this,e)};return e.type="[Auth] Update Password Success",e}(),KM=function(){var e=function e(t){m(this,e),this.error=t};return e.type="[Auth] Update Password Failure",e}(),GM=function(){var e=function e(){m(this,e)};return e.type="[Auth] Check Session",e}(),ZM=function(){var e=function e(t){m(this,e),this.value=t};return e.type="[Auth] Sign Up",e}(),JM=function(){var e=function e(t){m(this,e),this.response=t};return e.type="[Auth] Sign Up Success",e}(),XM=function(){var e=function e(t){m(this,e),this.error=t};return e.type="[Auth] Sign Up Failure",e}(),YM=function(){var e=function e(t){m(this,e),this.locale=t};return e.type="[Auth] Set User Locale",e}(),eI=function(){var e=function e(t){m(this,e),this.locale=t};return e.type="[Auth] Set User Locale Success",e}(),tI=function(){var e=function e(){m(this,e)};return e.type="[Auth] Check Locale",e}(),nI=function(){var e=function e(){m(this,e)};return e.type="[Auth] Get User Apps",e}(),iI=function(){var e=function e(t){m(this,e),this.apps=t};return e.type="[Auth] Set User Apps",e}(),oI=function(){var e=function e(){m(this,e)};return e.type="[Auth] Check Selected App",e}(),rI=function(){var e=function e(t){m(this,e),this.appId=t};return e.type="[Auth] Set Selected User App",e}(),aI=function(){var e=function e(t){m(this,e),this.message=t};return e.type="[Auth] Send User Message",e}(),sI=function(){var e=function e(t){m(this,e),this.message=t};return e.type="[Auth] Send User Message Success",e}(),cI=function(){var e=function e(t){m(this,e),this.err=t};return e.type="[Auth] Send User Message Fail",e}(),lI=function(){var e=function e(t,n){m(this,e),this.type=t,this.mode=n};return e.type="[Auth] Get User Message",e}(),uI=function(){var e=function e(t){m(this,e),this.message=t};return e.type="[Auth] Get User Message Success",e}(),pI=function(){var e=function e(t){m(this,e),this.type=t};return e.type="[Auth] Get User Message Fail",e}(),dI=function(){var e=function e(t){m(this,e),this.messageSeenId=t};return e.type="[Auth] Set Message Viewed",e}(),gI=function(){var e=function e(){m(this,e)};return e.type="[Auth] Set Message Viewed Success",e}(),hI=function(){var e=function e(){m(this,e)};return e.type="[Auth] Set Message Viewed Fail",e}(),fI=function(){var e=function e(){m(this,e)};return e.type="[Auth] Verify Fail",e}(),bI=function(){var e=function e(){m(this,e)};return e.type="[Auth] Reset",e}(),vI=function(){var e=function e(t,n){m(this,e),this.email=t,this.token=n};return e.type="[Auth] Request Verification Code",e}(),mI=function(){var e=function e(t){m(this,e),this.response=t};return e.type="[Auth] Request Verification Code Success",e}(),yI=function(){var e=function e(){m(this,e)};return e.type="[Auth] Request Verification Code Fail",e}(),xI=function(){var e=function e(t,n,i){m(this,e),this.email=t,this.token=n,this.code=i};return e.type="[Auth] Verify Profile",e}(),kI=function(){var e=function e(t){m(this,e),this.response=t};return e.type="[Auth] Verify Profile Success",e}(),wI=function(){var e=function e(){m(this,e)};return e.type="[Auth] Verify Profile Fail",e}(),OI=function e(){m(this,e)},CI=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},SI=(RP=function e(){m(this,e)},function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);r>3&&a&&Object.defineProperty(t,n,a)}([Object(te.Type)((function(){return OI})),CI("design:type",Array)],RP.prototype,"organizations",void 0),RP),_I=h("ahC7"),jI=function(){function e(){m(this,e)}return v(e,null,[{key:"fromJSON",value:function(t){var n=new e;return n.email=t.user_email,n.credentials=t.credentials,n.isUser=t.is_user,n.isThirdParty=t.user_is_third_party,n.thirdPartyProvider=t.user_third_party_provider,n.isDeveloper=t.user_is_developer,n.isDeveloperActive=t.user_is_developer_active,n.isDeveloperVerified=t.user_is_developer_verified,n.firstName=t.user_first_name,n.lastName=t.user_last_name,n.name="".concat(t.firstName," ").concat(t.lastName),n}}]),e}(),PI=function(){function e(){m(this,e)}return v(e,null,[{key:"fromJSON",value:function(t){var n=new e;return n.google=t.google_api_key,n.facebook=t.facebook_api_key,n}}]),e}(),MI=function e(){m(this,e),this.version=3,this.groupInviteMode=0,this.groupCodeMode=0},II=function(e){t(o,e);var n=i(o);function o(){var e;return m(this,o),(e=n.apply(this,arguments)).version=3,e}return v(o,null,[{key:"toJSON",value:function(e){return{version:e.version,email:e.email,password:e.password,first_name:e.firstName,last_name:e.lastName,group_invite_mode:e.groupInviteMode,group_invite_key:e.groupInviteKey,group_code_mode:e.groupCodeMode,group_code:e.groupCode,platform:e.platform,return_to:e.returnTo,brand_id:e.brandId,locale_id:e.localeId,timestamp:e.timestamp,site_verify_response:e.site_verify_response}}}]),o}(MI),zI=function(e){t(o,e);var n=i(o);function o(e){var t;return m(this,o),(t=n.call(this)).token=e,t}return v(o,null,[{key:"toJSON",value:function(e){return{id_token:e.token,version:e.version,group_invite_mode:e.groupInviteMode,group_invite_key:e.groupInviteKey,group_code_mode:e.groupCodeMode,group_code:e.groupCode,platform:e.platform,return_to:e.returnTo,brand_id:e.brandId,locale_id:e.localeId,timestamp:e.timestamp,site_verify_response:e.site_verify_response}}}]),o}(MI),TI=function(e){t(o,e);var n=i(o);function o(e){var t;return m(this,o),(t=n.call(this)).token=e,t}return v(o,null,[{key:"toJSON",value:function(e){return{access_token:e.token,version:e.version,group_invite_mode:e.groupInviteMode,group_invite_key:e.groupInviteKey,group_code_mode:e.groupCodeMode,group_code:e.groupCode,platform:e.platform,return_to:e.returnTo,brand_id:e.brandId,locale_id:e.localeId,timestamp:e.timestamp,site_verify_response:e.site_verify_response}}}]),o}(MI),UI=function(e){t(o,e);var n=i(o);function o(e,t,i){var r;return m(this,o),(r=n.call(this)).email=e,r.password=t,r.rememberMe=i,r}return v(o,null,[{key:"toJSON",value:function(e){return{id_token:e.token,version:e.version,group_invite_mode:e.groupInviteMode,group_invite_key:e.groupInviteKey,group_code_mode:e.groupCodeMode,group_code:e.groupCode,email:e.email,password:e.password,email_remember_me:e.rememberMe,platform:e.platform,return_to:e.returnTo,brand_id:e.brandId,locale_id:e.localeId,timestamp:e.timestamp,site_verify_response:e.site_verify_response}}}]),o}(MI),LI=function(e){return e.Zendesk="zendesk",e}({}),DI=function e(){m(this,e)},EI=function e(){m(this,e)},FI=function e(){m(this,e)},AI=h("jCJ1"),RI=["harvard.edu"],VI=((VP=function(){function e(t,n,i,o){m(this,e),this.http=t,this.router=n,this.socialAuthService=i,this.reCaptchaV3Service=o,this.auth2=new $r.a(null),this.initGoogleAuth2()}return v(e,[{key:"redirectOnLogin",value:function(e){var t=e.redirect_url,n=e.user_email,i=e.verification_required,o=e.verification_jwt;return t?(window.location.href=t,Object(G.a)(!0)):i?Object(lr.a)(this.redirectToVerify(n,o)):Object(G.a)(!1)}},{key:"redirectToVerify",value:function(e,t){return this.router.navigate(["/login/verify-email"],{queryParams:{email:e,token:t}})}},{key:"loginWithBiodigital",value:function(e){return this.http.post("/ws/user/sign/in",UI.toJSON(e))}},{key:"loginWithGoogle",value:function(e){return this.http.post("/ws/user/sign/in/google",zI.toJSON(e))}},{key:"loginWithFacebook",value:function(e){return this.http.post("/ws/user/sign/in/facebook",TI.toJSON(e))}},{key:"logout",value:function(){return this.http.get("/ws/user/sign/out")}},{key:"checkProfile",value:function(e){return this.http.post("/ws/user/profile/check",{version:2,email:e}).pipe(Object(Z.a)((function(e){var t=jI.fromJSON(e);return t.isThirdParty=""!==t.thirdPartyProvider,t})))}},{key:"getUserProfile",value:function(e){return this.http.get(e?"/ws/user/profile?subscription_hard_check=1":"/ws/user/profile").pipe(Object(Z.a)((function(e){"string"==typeof e.organizations&&(e.organizations=JSON.parse(e.organizations));var t=Object(te.plainToClass)(SI,e);return t.organizations.forEach((function(e){var t=Object(Se.get)(e,"user_role",tS);e.user_role=oS(t)})),t})))}},{key:"getUserRoles",value:function(){return this.http.get("/ws/enterprise/user/roles").pipe(Object(Z.a)((function(e){return e.user_roles.map((function(e){return oS(Object(te.plainToClass)(DI,e))}))})))}},{key:"updaterUserProfile",value:function(e){return this.http.post("/ws/user/profile",e)}},{key:"deleteUserProfile",value:function(){return this.http.post("/ws/user/profile/delete",{}).pipe(Object(Z.a)((function(e){return e.deleted_user_email})))}},{key:"getEnvironmentSettings",value:function(){return this.http.get("/ws/environment/settings?version=2").pipe(Object(Z.a)((function(e){return PI.fromJSON(e)})))}},{key:"getUserApps",value:function(){return this.http.get("/ws/developer/apps/profile").pipe(Object(Z.a)((function(e){return e&&e.apps?JSON.parse(e.apps):[]})))}},{key:"getGroupConfigFromRoute",value:function(e){var t=e.queryParams.group||"",n=e.queryParams.group_invite||"";return{group:t,groupCode:e.queryParams.code||"",groupCodeMode:""!==t?1:0,groupInviteMode:""!==n?1:0,groupInviteKey:n}}},{key:"getPlatformConfigFromRoute",value:function(e){var t=e.queryParams,n=t.zendesk_signin,i=t.return_to,o=t.brand_id,r=t.locale_id,a=t.timestamp;return"1"===n?{platform:LI.Zendesk,returnTo:i,brandId:o,localeId:r,timestamp:a}:void 0}},{key:"isLoggedIn",value:function(){return this.http.get("/ws/user/is/signed-in?version=2")}},{key:"getProfileRestrictions",value:function(e){var t=!1,n=!1,i="";return e.organizations.forEach((function(e){t||n||(i=e.name,t=e.user_is_subscribed&&e.email_domain_restriction&&!e.user_has_email_domain_access,n=e.user_is_subscribed&&e.ip_address_restriction&&!e.user_has_domain_access)})),{organizationName:i,email:t,ip:n}}},{key:"resetPassword",value:function(e){return this.http.post("/ws/user/password/forgot",{email:e})}},{key:"updatePassword",value:function(e,t,n){return this.http.post("/ws/user/password/change",{current_password:e,new_password:t,confirm_new_password:n})}},{key:"signUp",value:function(e){return this.http.post("/ws/user/sign/up",II.toJSON(e))}},{key:"authenticateWithFacebook",value:function(){return this.socialAuthService.signIn(_I.a.PROVIDER_ID)}},{key:"verifyToken",value:function(e){return this.http.post("/ws/recaptcha/siteverify",{recaptcha_reponse_token:e,recaptcha_version:"v3"}).pipe(Object(Z.a)((function(e){return e})))}},{key:"isHuman",value:function(e){var t=this;return this.reCaptchaV3Service.execute(e).pipe(Object(rr.b)((function(e){return t.verifyToken(e)})),Object(Z.a)((function(t){return{isHuman:t.action===e&&t.score>.2,verification:t}})))}},{key:"isReCaptchaWhiteListed",value:function(e){return RI.some((function(t){return new RegExp(t+"$","i").test(e)}))}},{key:"requestVerificationCode",value:function(e){return this.http.post("/ws/user/verification/request",e).pipe(Object(Z.a)((function(e){return Object(te.plainToClass)(EI,e)})))}},{key:"verifyProfile",value:function(e){return this.http.post("/ws/user/verification/confirm",e).pipe(Object(Z.a)((function(e){return Object(te.plainToClass)(FI,e)})))}},{key:"initGoogleAuth2",value:function(){var e=this;gapi.load("auth2",(function(){e.auth2.next(gapi.auth2.init({client_id:U.googleAuthKey,scope:"profile"}))}))}}]),e}()).\u0275fac=function(e){return new(e||VP)(P.Zb(K.b),P.Zb(Oe.e),P.Zb(_I.b),P.Zb(AI.a))},VP.\u0275prov=P.Lb({token:VP,factory:VP.\u0275fac,providedIn:"root"}),VP),NI=function(){var e=function e(t){m(this,e),this.organizations=t};return e.type="[Organizations] Set Organizations",e}(),BI=function(){var e=function e(t){m(this,e),this.organization=t};return e.type="[Organizations] Select Organization",e}(),HI=function(){var e=function e(t){m(this,e),this.collection=t};return e.type="[Organizations] Select Collection",e}(),QI=function(){var e=function e(t){m(this,e),this.organizationId=t};return e.type="[Organizations] Get Collections",e}(),qI=function(){var e=function e(t){m(this,e),this.collections=t};return e.type="[Organizations] Get Collections Success",e}(),WI=function(){var e=function e(t){m(this,e),this.organization=t};return e.type="[Organizations] Join Organization",e}(),$I=function(){var e=function e(t){m(this,e),this.organization=t};return e.type="[Organizations] Join Organization Success",e}(),KI=function(){var e=function e(t){m(this,e),this.organization=t};return e.type="[Organizations] Join Organization Fail",e}(),GI=function(){var e=function e(t){m(this,e),this.code=t};return e.type="[Organizations] Join Organization With Code",e}(),ZI=function(){var e=function e(t){m(this,e),this.organizationName=t};return e.type="[Organizations] Join Organization With Code Success",e}(),JI=function(){var e=function e(t){m(this,e),this.error=t};return e.type="[Organizations] Join Organization With Code Fail",e}(),XI=function(){var e=function e(t,n){m(this,e),this.groupEID=t,this.emails=n};return e.type="[Organizations] Send Organization Invite",e}(),YI=function(){var e=function e(t){m(this,e),this.responses=t};return e.type="[Organizations] Send Organization Invite Success",e}(),ez=function(){var e=function e(t){m(this,e),this.error=t};return e.type="[Organizations] Send Organization Invite Fail",e}(),tz=function(){var e=function e(t){m(this,e),this.groupId=t};return e.type="[Organizations] Get Organization Users",e}(),nz=function(){var e=function e(t){m(this,e),this.users=t};return e.type="[Organizations] Get Organization Users Success",e}(),iz=function(){var e=function e(t){m(this,e),this.error=t};return e.type="[Organizations] Get Organization Users Fail",e}(),oz=function(){var e=function e(){m(this,e)};return e.type="[Organizations] Reset",e}(),rz=function(){var e=function e(t,n){m(this,e),this.groupId=t,this.users=n};return e.type="[Organizations] Update User Roles",e}(),az=function(){var e=function e(t,n){m(this,e),this.groupId=t,this.users=n};return e.type="[Organizations] Update User Roles Success",e}(),sz=function(){var e=function e(){m(this,e)};return e.type="[Organizations] Update User Roles Fail",e}(),cz=function(){var e=function e(t,n){m(this,e),this.groupId=t,this.users=n};return e.type="[Organizations] Remove Organization User",e}(),lz=function(){var e=function e(t,n){m(this,e),this.groupId=t,this.users=n};return e.type="[Organizations] Remove Organization User Success",e}(),uz=function(){var e=function e(){m(this,e)};return e.type="[Organizations] Remove Organization User Fail",e}(),pz=function(){var e=function e(t,n){m(this,e),this.groupId=t,this.users=n};return e.type="[Organizations] Transfer Organization Content",e}(),dz=function(){var e=function e(t,n){m(this,e),this.groupId=t,this.users=n};return e.type="[Organizations] Transfer Organization Content Success",e}(),gz=function(){var e=function e(){m(this,e)};return e.type="[Organizations] Transfer Organization Content Fail",e}(),hz=function(e){return e.DomainAlert="join_group_through_domain_alert",e.WelcomeTour="welcome_tour_alert",e.SurveyMonkey="survey_monkey_alert",e.CompleteProfileAlert="complete_profile_alert",e}({}),fz=((NP=function(){function e(t,n){m(this,e),this.http=t,this.storageService=n}return v(e,[{key:"getUserMessage",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=this.getCachedMessage(e);return i&&o?Object(G.a)(o):this.http.get("/ws/user/message?version=2&type=".concat(e,"&mode=").concat(n)).pipe(Object(Z.a)((function(t){var n,i=t.message_seen_id,o=t.show_alert;switch(e){case hz.DomainAlert:n=Object(te.plainToClass)(OI,t.join_organization);break;case hz.WelcomeTour:n=""+t.tour_version;break;case hz.SurveyMonkey:n=""+t.survey_group_name;break;case hz.CompleteProfileAlert:n=!0===t.is_new_user}return{messageSeenId:i,messageType:e,showUserAlert:o,messageData:n}})),Object(fn.a)((function(e){e.showUserAlert||t.addCachedMessage(e)})))}},{key:"setUserMessageViewed",value:function(e){return this.http.post("/ws/user/message",{version:2,message_seen_id:e})}},{key:"sendMessage",value:function(e){return this.http.post("/ws/user/message",e)}},{key:"getCachedMessage",value:function(e){return this.getCachedMessages().find((function(t){return t.messageType===e}))}},{key:"getCachedMessages",value:function(){return this.storageService.getSessionItem(Ds.UserMessagesSeen)||[]}},{key:"addCachedMessage",value:function(e){if(!this.getCachedMessage(e.messageType)){var t=this.getCachedMessages();this.storageService.setSessionItem(Ds.UserMessagesSeen,[].concat(c(t),[e]))}}}]),e}()).\u0275fac=function(e){return new(e||NP)(P.Zb(K.b),P.Zb(As))},NP.\u0275prov=P.Lb({token:NP,factory:NP.\u0275fac,providedIn:"root"}),NP);!function(e){var t=function e(t){m(this,e),this.searchMode=t};t.type="[Gallery] Set Search Mode",e.SetSearchMode=t;var n=function e(t){m(this,e),this.viewMode=t};n.type="[Gallery] Set View Mode",e.SetViewMode=n;var i=function e(t){m(this,e),this.sort=t};i.type="[Gallery] Set Sort",e.SetSort=i;var o=function e(t){m(this,e),this.organizationId=t};o.type="[Gallery] Get Studio Options",e.GetStudioOptions=o;var r=function e(t){m(this,e),this.options=t};r.type="[Gallery] Get Studio Options Success",e.GetStudioOptionsSuccess=r;var a=function e(t){m(this,e),this.config=t};a.type="[Gallery] Search Loft",e.SearchLoft=a;var s=function e(t){m(this,e),this.bookmarks=t};s.type="[Gallery] Search Loft Success",e.SearchLoftSuccess=s;var c=function e(t,n){m(this,e),this.config=t,this.options=n};c.type="[Gallery] Set Search Config",e.SetSearchConfig=c;var l=function e(t){m(this,e),this.options=t};l.type="[Gallery] Set Search Options",e.SetSearchOptions=l;var u=function e(){m(this,e)};u.type="[Gallery] Search Studio",e.SearchStudio=u;var p=function e(t){m(this,e),this.bookmarks=t};p.type="[Gallery] Search Studio Success",e.SearchStudioSuccess=p;var d=function e(t){m(this,e),this.bookmarks=t};d.type="[Gallery] Search Success",e.SearchSuccess=d;var g=function e(t){m(this,e),this.result=t};g.type="[Gallery] Select Bookmark",e.SelectBookmark=g;var h=function e(t){m(this,e),this.sidenav=t};h.type="[Gallery] Set Sidenav",e.SetSidenav=h;var f=function e(t){m(this,e),this.bulkActions=t};f.type="[Gallery] Set Bulk Actions",e.SetBulkActions=f;var b=function e(t){m(this,e),this.cardActions=t};b.type="[Gallery] Set Card Actions",e.SetCardActions=b;var v=function e(){m(this,e)};v.type="[Gallery] Clear Results",e.ClearResults=v;var y=function e(t,n){m(this,e),this.id=t,this.checked=n};y.type="[Gallery] Check Item",e.CheckItem=y;var x=function e(t){m(this,e),this.checked=t};x.type="[Gallery] Check All",e.CheckAll=x;var k=function e(t){m(this,e),this.ids=t};k.type="[Gallery] Set Checked Items",e.SetCheckedItems=k;var w=function e(){m(this,e)};w.type="[Gallery] Reset",e.Reset=w}(BP||(BP={}));var bz,vz,mz,yz,xz,kz,wz,Oz,Cz,Sz,_z,jz,Pz,Mz,Iz,zz,Tz,Uz,Lz,Dz,Ez,Fz,Az,Rz,Vz,Nz,Bz,Hz,Qz,qz,Wz,$z=function(e){return e.Web="web",e.Mobile="mobilesdk",e}({}),Kz=function(){var e=function e(){m(this,e)};return e.type="[Subscription] Reset Subscription State",e}(),Gz={"Sign in":"3971305","Sign up":"3971297"},Zz=((vz=function(){function e(t){m(this,e),this.config=t,this.initialized=!1}return v(e,[{key:"initialize",value:function(){if(this.config.enabled&&!this.initialized){var e='\n      _linkedin_partner_id = "'.concat(this.config.linkedinId,'"; \n      window._linkedin_data_partner_ids = window._linkedin_data_partner_ids || []; \n      window._linkedin_data_partner_ids.push(_linkedin_partner_id);\n      (function(){var s = document.getElementsByTagName("script")[0]; var b = document.createElement("script"); b.type = "text/javascript";b.async = true; b.src = "https://snap.licdn.com/li.lms-analytics/insight.min.js"; s.parentNode.insertBefore(b, s);})();\n    '),t=document.createElement("script");t.textContent=e,document.body.appendChild(t),this.initialized=!0}}},{key:"track",value:function(e){var t=Gz[e];if(t){var n=document.createElement("img");n.height=1,n.width=1,n.style.display="none",n.alt="",n.src="https://px.ads.linkedin.com/collect/?pid=".concat(this.config.linkedinId,"&conversionId=").concat(t,"&fmt=gif"),document.body.appendChild(n)}}}]),e}()).\u0275fac=function(e){return new(e||vz)(P.Zb("linkedinConfig"))},vz.\u0275prov=P.Lb({token:vz,factory:vz.\u0275fac,providedIn:"root"}),vz),Jz=((bz=function(){function e(t){m(this,e),this.config=t,this.initialized=!1}return v(e,[{key:"initialize",value:function(){if(this.config.enabled&&!this.initialized){var e="\n      !function(f,b,e,v,n,t,s)\n      {if(f.fbq)return;n=f.fbq=function(){n.callMethod?\n      n.callMethod.apply(n,arguments):n.queue.push(arguments)};\n      if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';\n      n.queue=[];t=b.createElement(e);t.async=!0;\n      t.src=v;s=b.getElementsByTagName(e)[0];\n      s.parentNode.insertBefore(t,s)}(window,document,'script',\n      'https://connect.facebook.net/en_US/fbevents.js');\n      fbq('init', '".concat(this.config.facebookPixelId,"');\n      fbq('track', 'PageView');\n    "),t=document.createElement("script");t.textContent=e,document.head.appendChild(t),this.initialized=!0}}},{key:"trackCustom",value:function(e){fbq("trackCustom",e)}}]),e}()).\u0275fac=function(e){return new(e||bz)(P.Zb("facebookPixelConfig"))},bz.\u0275prov=P.Lb({token:bz,factory:bz.\u0275fac,providedIn:"root"}),bz),Xz=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},Yz=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},eT=U.application===M.Studio,tT={loading:!1,requestingCode:!1,profileStatus:"ready",loggedIn:null,userLocale:null,userRoles:[]},nT=((mz=function(){function e(t,n,i,o,r,a,s,c,l){m(this,e),this.route=t,this.authService=n,this.userMessageService=i,this.storageService=o,this.localeId=r,this.errorLoggingService=a,this.facebookPixel=s,this.linkedinInsights=c,this.pendoService=l}return v(e,[{key:"isLoggedIn",value:function(e,t){e.patchState({loading:!0}),this.authService.isLoggedIn().pipe(Object(se.a)((function(){return e.patchState({loading:!1})}))).subscribe((function(t){e.dispatch(t.signed_in?new vM:new mM)}))}},{key:"isLoggedInSuccess",value:function(e,t){e.patchState({loggedIn:!0})}},{key:"isLoggedInFailure",value:function(e,t){e.patchState({loggedIn:!1})}},{key:"login",value:function(e,t){var n=this;e.patchState({loading:!0}),this.verify("studio_login",t.login.email,e).pipe(Object(rr.b)((function(e){return n.authService.loginWithBiodigital(Object.assign(Object.assign({},t.login),e?{site_verify_response:e}:null))})),Object(se.a)((function(){return e.patchState({loading:!1})}))).subscribe((function(t){e.dispatch(new wM("biodigital",t))}),(function(i){n.logFailure("LOGIN_FAILURE",i),e.dispatch(new OM("biodigital",i,t.login))}))}},{key:"loginWithGoogle",value:function(e,t){var n=this;e.patchState({loading:!0}),this.authService.loginWithGoogle(t.login).pipe(Object(se.a)((function(){return e.patchState({loading:!1})}))).subscribe((function(t){e.dispatch(new wM("google",t))}),(function(i){1!==t.login.groupCodeMode&&1!==t.login.groupInviteMode||n.logFailure("GOOGLE_SIGNUP_FAILURE",i),e.dispatch(new OM("google",i,t.login))}))}},{key:"loginWithFacebook",value:function(e,t){e.patchState({loading:!0}),this.authService.loginWithFacebook(t.login).pipe(Object(se.a)((function(){return e.patchState({loading:!1})}))).subscribe((function(t){e.dispatch(new wM("facebook",t))}),(function(n){e.dispatch(new OM("facebook",n,t.login))}))}},{key:"loginSuccess",value:function(e,t){eT&&(this.facebookPixel.trackCustom("Sign in"),this.linkedinInsights.track("Sign in"),this.pendoService.track("Sign In - Success",{type:t.loginType})),e.dispatch(new bM),e.dispatch(new tI)}},{key:"loginFailure",value:function(e,t){eT&&this.pendoService.track("Sign In - Failure",{type:t.loginType,error:Object(Se.get)(t,"error.error.error.message")||"There was an error logging in."})}},{key:"logout",value:function(e,t){e.patchState({loading:!0}),this.authService.logout().pipe(Object(se.a)((function(){return e.patchState({loading:!1})}))).subscribe((function(){return e.dispatch(new SM)}),(function(){return e.dispatch(new _M)}))}},{key:"logoutSuccess",value:function(e,t){e.setState(tT),e.dispatch(new bI),e.dispatch(new Kz),e.dispatch(new vp),e.dispatch(new Pc),e.dispatch(new pt),e.dispatch(new Jo),e.dispatch(new Vu.ResetLayout),e.dispatch(new oz),e.dispatch(new Va),e.dispatch(new Hn),e.dispatch(new BP.Reset),this.storageService.clearSessionStorage()}},{key:"checkProfile",value:function(e,t){return e.patchState({loading:!0}),this.authService.checkProfile(t.email).pipe(Object(se.a)((function(){return e.patchState({loading:!1})}))).subscribe((function(t){e.dispatch(new VM(t))}),(function(t){e.dispatch(new NM(t))}))}},{key:"checkProfileSuccess",value:function(e,t){e.patchState({profileCheck:t.profile})}},{key:"getUserProfile",value:function(e,t){var n=t.hardCheck;return e.patchState({loading:!0}),this.authService.getUserProfile(n).pipe(Object(se.a)((function(){return e.patchState({loading:!1})}))).subscribe((function(t){e.dispatch(new zM(t))}),(function(t){e.dispatch(new TM(t))}))}},{key:"getUserProfileSuccess",value:function(e,t){e.patchState({userProfile:t.userProfile}),e.dispatch(new NI(t.userProfile.organizations)),e.dispatch(new nI),e.dispatch(new tI)}},{key:"updateUserProfile",value:function(e,t){var n=t.userProfile;e.patchState({profileStatus:"updating"}),this.authService.updaterUserProfile(n).pipe(Object(se.a)((function(){return e.patchState({profileStatus:"ready"})}))).subscribe((function(){e.dispatch(new LM(n))}),(function(t){e.dispatch(new DM(t))}))}},{key:"deleteUserProfile",value:function(e,t){e.patchState({profileStatus:"deleting"}),this.authService.deleteUserProfile().pipe(Object(se.a)((function(){return e.patchState({profileStatus:"ready"})}))).subscribe((function(t){e.dispatch(new FM(t))}),(function(t){e.dispatch(new AM(t))}))}},{key:"getUserRoles",value:function(e,t){this.authService.getUserRoles().subscribe((function(t){e.patchState({userRoles:t})}))}},{key:"getUserApps",value:function(e,t){this.authService.getUserApps().subscribe((function(t){e.dispatch(new iI(t)),e.dispatch(new oI)}),(function(e){}))}},{key:"setUserApps",value:function(e,t){var n=t.apps;e.patchState({userApps:n})}},{key:"setSelectedUserApp",value:function(e,t){var n=t.appId;e.patchState({selectedAppId:n}),null!==n?this.storageService.setLocalItem(Ls.UserAppId,n):this.storageService.removeLocalItem(Ls.UserAppId)}},{key:"checkSelectedUserApp",value:function(e,t){var n=e.getState().userApps,i=this.storageService.getLocalItem(Ls.UserAppId);if(i){var o=parseInt(i,10);e.dispatch(new rI(o))}else if(n&&n.length){var r=n.find((function(e){return e.app_platform.some((function(e){return e.type===$z.Web}))}));e.dispatch(new rI(r?r.id:void 0))}}},{key:"checkSession",value:function(e,t){e.patchState({loading:!0}),this.authService.isLoggedIn().pipe(Object(se.a)((function(){return e.patchState({loading:!1})}))).subscribe((function(t){t.signed_in?(e.dispatch(new vM),e.dispatch(new IM),e.dispatch(new BM)):e.dispatch(new mM)}))}},{key:"getEnvironmentSettings",value:function(e,t){return e.patchState({loading:!0}),this.authService.getEnvironmentSettings().pipe(Object(se.a)((function(){return e.patchState({loading:!1})}))).subscribe((function(t){e.dispatch(new PM(t))}),(function(t){e.dispatch(new MM(t))}))}},{key:"GetEnvironmentSettingsSuccess",value:function(e,t){e.patchState({environmentSettings:t.environmentSettings})}},{key:"resetPassword",value:function(e,t){e.patchState({loading:!0}),this.authService.resetPassword(t.email).pipe(Object(se.a)((function(){return e.patchState({loading:!1})}))).subscribe((function(){e.dispatch(new QM(t.email))}),(function(t){e.dispatch(new qM(t))}))}},{key:"updatePassword",value:function(e,t){var n=t.currentPassword,i=t.newPassword,o=t.confirmNewPassword;this.authService.updatePassword(n,i,o).subscribe((function(){e.dispatch(new $M)}),(function(t){e.dispatch(new KM(t))}))}},{key:"signUp",value:function(e,t){var n=this;e.patchState({loading:!0}),this.verify("studio_signup",t.value.email,e).pipe(Object(rr.b)((function(e){return n.authService.signUp(Object.assign(Object.assign({},t.value),e?{site_verify_response:e}:null))})),Object(se.a)((function(){return e.patchState({loading:!1})}))).subscribe((function(t){e.dispatch(new JM(t))}),(function(t){e.dispatch(new XM(t))}))}},{key:"signUpSuccess",value:function(e,t){if(eT){var n=this.route.snapshot.queryParams;this.pendoService.track("Sign Up - Success",{referrer:document.referrer,refParam:n.ref||null,groupInvite:n.hasOwnProperty("group_invite"),groupCode:n.hasOwnProperty("group")&&n.hasOwnProperty("code")})}}},{key:"signUpFailure",value:function(e,t){eT&&this.pendoService.track("Sign Up - Failure",{error:Object(Se.get)(t,"error.error.error.message")||"There was an error signing up."}),this.logFailure("BIODIGITAL_SIGNUP_FAILURE",t)}},{key:"setUserLocale",value:function(e,t){var n=t.locale;this.storageService.setLocalItem(Ls.Locale,n.id),e.patchState({userLocale:n}),e.dispatch(new eI(n))}},{key:"checkLocale",value:function(e,t){var n=this,i=xa.find((function(e){return e.id===n.localeId}))||ya;e.dispatch(new YM(i))}},{key:"sendUserMessage",value:function(e,t){var n=t.message;this.userMessageService.sendMessage(n).subscribe((function(){e.dispatch(new sI(n))}),(function(t){e.dispatch(new cI(t))}))}},{key:"getUserMessage",value:function(e,t){var n=t.type,i=t.mode;this.userMessageService.getUserMessage(n,i).subscribe((function(t){e.dispatch(new uI(t))}),(function(){e.dispatch(new pI(n))}))}},{key:"setUserMessageViewed",value:function(e,t){var n=t.messageSeenId;this.userMessageService.setUserMessageViewed(n).subscribe((function(){return e.dispatch(new gI)}),(function(){return e.dispatch(new hI)}))}},{key:"resetAuth",value:function(e,t){e.setState(tT)}},{key:"requestVerificationCode",value:function(e,t){var n=t.email,i=t.token;e.patchState({requestingCode:!0}),this.authService.requestVerificationCode({user_email:n,verification_jwt:i}).pipe(Object(se.a)((function(){return e.patchState({requestingCode:!1})}))).subscribe((function(t){e.dispatch(new mI(t))}),(function(t){e.dispatch(new yI)}))}},{key:"verifyProfile",value:function(e,t){var n=t.email,i=t.token,o=t.code.toUpperCase();e.patchState({profileStatus:"verifying"}),this.authService.verifyProfile({user_email:n,verification_code:o,verification_jwt:i}).pipe(Object(se.a)((function(){return e.patchState({profileStatus:"ready"})}))).subscribe((function(t){e.dispatch(new kI(t)),e.dispatch(new IM)}),(function(t){e.dispatch(new wI)}))}},{key:"logFailure",value:function(e,t){var n=Object(Se.get)(t,"message")||"",i=Object(Se.get)(t,"error.error.message")||"";this.errorLoggingService.logError(new fj(e,n,i)).subscribe()}},{key:"verify",value:function(e,t,n){return this.authService.isReCaptchaWhiteListed(t)?Object(G.a)(null):this.authService.isHuman(e).pipe(Object(fn.a)((function(e){e.isHuman||n.dispatch(new fI)})),Object(me.a)((function(e){return e.isHuman})),Object(Z.a)((function(e){return e.verification})))}},{key:"ngxsOnInit",value:function(e){e.dispatch(new GM),e.dispatch(new tI),e.dispatch(new oI)}}],[{key:"getLoggedIn",value:function(e){return e.loggedIn}},{key:"getEnvironmentSettings",value:function(e){return e.environmentSettings}},{key:"getUserProfile",value:function(e){return e.userProfile}},{key:"getUserRole",value:function(e){if(!Object(Se.isNil)(e.userProfile))return Object(Se.get)(e,"userProfile.organizations[0].user_role",tS)}},{key:"getUserRoles",value:function(e){return e.userRoles}},{key:"getUserAccountSettings",value:function(e){return Object(Se.get)(e,"userProfile.account_settings",[])}},{key:"getProfileCheck",value:function(e){return e.profileCheck}},{key:"getLoading",value:function(e){return e.loading}},{key:"getVerifyingProfile",value:function(e){return"verifying"===e.profileStatus}},{key:"getProfileUpdating",value:function(e){return"updating"===e.profileStatus}},{key:"getProfileDeleting",value:function(e){return"deleting"===e.profileStatus}},{key:"getUserLocale",value:function(e){return e.userLocale}},{key:"getUserLanguage",value:function(e){return Object(Se.get)(e,"userLocale.lang",ya.lang)}},{key:"getUserApps",value:function(e){return Object(Se.get)(e,"userApps",[])}},{key:"getSelectedUserApp",value:function(e){return(e.userApps||[]).find((function(t){return t.id===e.selectedAppId}))}},{key:"isPrivateUser",value:function(e){return!Object(Se.isNil)(e.userProfile)&&0===Object(Se.get)(e,"userProfile.organizations",[]).length}},{key:"isPremiumUser",value:function(e){return!0===Object(Se.get)(e,"userProfile.premium_account_valid")}}]),e}()).\u0275fac=function(e){return new(e||mz)(P.Zb(Oe.a),P.Zb(VI),P.Zb(fz),P.Zb(As),P.Zb(P.w),P.Zb(bj),P.Zb(Jz),P.Zb(Zz),P.Zb(je))},mz.\u0275prov=P.Lb({token:mz,factory:mz.\u0275fac}),Xz([Object(E.a)(bM),Yz("design:type",Function),Yz("design:paramtypes",[Object,bM]),Yz("design:returntype",void 0)],mz.prototype,"isLoggedIn",null),Xz([Object(E.a)(vM),Yz("design:type",Function),Yz("design:paramtypes",[Object,vM]),Yz("design:returntype",void 0)],mz.prototype,"isLoggedInSuccess",null),Xz([Object(E.a)(mM),Yz("design:type",Function),Yz("design:paramtypes",[Object,mM]),Yz("design:returntype",void 0)],mz.prototype,"isLoggedInFailure",null),Xz([Object(E.a)(yM),Yz("design:type",Function),Yz("design:paramtypes",[Object,yM]),Yz("design:returntype",void 0)],mz.prototype,"login",null),Xz([Object(E.a)(xM),Yz("design:type",Function),Yz("design:paramtypes",[Object,xM]),Yz("design:returntype",void 0)],mz.prototype,"loginWithGoogle",null),Xz([Object(E.a)(kM),Yz("design:type",Function),Yz("design:paramtypes",[Object,kM]),Yz("design:returntype",void 0)],mz.prototype,"loginWithFacebook",null),Xz([Object(E.a)(wM),Yz("design:type",Function),Yz("design:paramtypes",[Object,wM]),Yz("design:returntype",void 0)],mz.prototype,"loginSuccess",null),Xz([Object(E.a)(OM),Yz("design:type",Function),Yz("design:paramtypes",[Object,OM]),Yz("design:returntype",void 0)],mz.prototype,"loginFailure",null),Xz([Object(E.a)(CM),Yz("design:type",Function),Yz("design:paramtypes",[Object,CM]),Yz("design:returntype",void 0)],mz.prototype,"logout",null),Xz([Object(E.a)(SM),Yz("design:type",Function),Yz("design:paramtypes",[Object,SM]),Yz("design:returntype",void 0)],mz.prototype,"logoutSuccess",null),Xz([Object(E.a)(RM),Yz("design:type",Function),Yz("design:paramtypes",[Object,RM]),Yz("design:returntype",void 0)],mz.prototype,"checkProfile",null),Xz([Object(E.a)(VM),Yz("design:type",Function),Yz("design:paramtypes",[Object,VM]),Yz("design:returntype",void 0)],mz.prototype,"checkProfileSuccess",null),Xz([Object(E.a)(IM),Yz("design:type",Function),Yz("design:paramtypes",[Object,IM]),Yz("design:returntype",void 0)],mz.prototype,"getUserProfile",null),Xz([Object(E.a)(zM),Yz("design:type",Function),Yz("design:paramtypes",[Object,zM]),Yz("design:returntype",void 0)],mz.prototype,"getUserProfileSuccess",null),Xz([Object(E.a)(UM),Yz("design:type",Function),Yz("design:paramtypes",[Object,UM]),Yz("design:returntype",void 0)],mz.prototype,"updateUserProfile",null),Xz([Object(E.a)(EM),Yz("design:type",Function),Yz("design:paramtypes",[Object,EM]),Yz("design:returntype",void 0)],mz.prototype,"deleteUserProfile",null),Xz([Object(E.a)(BM),Yz("design:type",Function),Yz("design:paramtypes",[Object,BM]),Yz("design:returntype",void 0)],mz.prototype,"getUserRoles",null),Xz([Object(E.a)(nI),Yz("design:type",Function),Yz("design:paramtypes",[Object,nI]),Yz("design:returntype",void 0)],mz.prototype,"getUserApps",null),Xz([Object(E.a)(iI),Yz("design:type",Function),Yz("design:paramtypes",[Object,iI]),Yz("design:returntype",void 0)],mz.prototype,"setUserApps",null),Xz([Object(E.a)(rI),Yz("design:type",Function),Yz("design:paramtypes",[Object,rI]),Yz("design:returntype",void 0)],mz.prototype,"setSelectedUserApp",null),Xz([Object(E.a)(oI),Yz("design:type",Function),Yz("design:paramtypes",[Object,oI]),Yz("design:returntype",void 0)],mz.prototype,"checkSelectedUserApp",null),Xz([Object(E.a)(GM),Yz("design:type",Function),Yz("design:paramtypes",[Object,GM]),Yz("design:returntype",void 0)],mz.prototype,"checkSession",null),Xz([Object(E.a)(jM),Yz("design:type",Function),Yz("design:paramtypes",[Object,jM]),Yz("design:returntype",void 0)],mz.prototype,"getEnvironmentSettings",null),Xz([Object(E.a)(PM),Yz("design:type",Function),Yz("design:paramtypes",[Object,PM]),Yz("design:returntype",void 0)],mz.prototype,"GetEnvironmentSettingsSuccess",null),Xz([Object(E.a)(HM),Yz("design:type",Function),Yz("design:paramtypes",[Object,HM]),Yz("design:returntype",void 0)],mz.prototype,"resetPassword",null),Xz([Object(E.a)(WM),Yz("design:type",Function),Yz("design:paramtypes",[Object,WM]),Yz("design:returntype",void 0)],mz.prototype,"updatePassword",null),Xz([Object(E.a)(ZM),Yz("design:type",Function),Yz("design:paramtypes",[Object,ZM]),Yz("design:returntype",void 0)],mz.prototype,"signUp",null),Xz([Object(E.a)(JM),Yz("design:type",Function),Yz("design:paramtypes",[Object,JM]),Yz("design:returntype",void 0)],mz.prototype,"signUpSuccess",null),Xz([Object(E.a)(XM),Yz("design:type",Function),Yz("design:paramtypes",[Object,XM]),Yz("design:returntype",void 0)],mz.prototype,"signUpFailure",null),Xz([Object(E.a)(YM),Yz("design:type",Function),Yz("design:paramtypes",[Object,YM]),Yz("design:returntype",void 0)],mz.prototype,"setUserLocale",null),Xz([Object(E.a)(tI),Yz("design:type",Function),Yz("design:paramtypes",[Object,tI]),Yz("design:returntype",void 0)],mz.prototype,"checkLocale",null),Xz([Object(E.a)(aI),Yz("design:type",Function),Yz("design:paramtypes",[Object,aI]),Yz("design:returntype",void 0)],mz.prototype,"sendUserMessage",null),Xz([Object(E.a)(lI),Yz("design:type",Function),Yz("design:paramtypes",[Object,lI]),Yz("design:returntype",void 0)],mz.prototype,"getUserMessage",null),Xz([Object(E.a)(dI),Yz("design:type",Function),Yz("design:paramtypes",[Object,dI]),Yz("design:returntype",void 0)],mz.prototype,"setUserMessageViewed",null),Xz([Object(E.a)(bI),Yz("design:type",Function),Yz("design:paramtypes",[Object,bI]),Yz("design:returntype",void 0)],mz.prototype,"resetAuth",null),Xz([Object(E.a)(vI),Yz("design:type",Function),Yz("design:paramtypes",[Object,vI]),Yz("design:returntype",void 0)],mz.prototype,"requestVerificationCode",null),Xz([Object(E.a)(xI),Yz("design:type",Function),Yz("design:paramtypes",[Object,xI]),Yz("design:returntype",void 0)],mz.prototype,"verifyProfile",null),Xz([Object(E.e)(),Yz("design:type",Function),Yz("design:paramtypes",[fM]),Yz("design:returntype",void 0)],mz,"getLoggedIn",null),Xz([Object(E.e)(),Yz("design:type",Function),Yz("design:paramtypes",[fM]),Yz("design:returntype",void 0)],mz,"getEnvironmentSettings",null),Xz([Object(E.e)(),Yz("design:type",Function),Yz("design:paramtypes",[fM]),Yz("design:returntype",void 0)],mz,"getUserProfile",null),Xz([Object(E.e)(),Yz("design:type",Function),Yz("design:paramtypes",[fM]),Yz("design:returntype",DI)],mz,"getUserRole",null),Xz([Object(E.e)(),Yz("design:type",Function),Yz("design:paramtypes",[fM]),Yz("design:returntype",Array)],mz,"getUserRoles",null),Xz([Object(E.e)(),Yz("design:type",Function),Yz("design:paramtypes",[fM]),Yz("design:returntype",Array)],mz,"getUserAccountSettings",null),Xz([Object(E.e)(),Yz("design:type",Function),Yz("design:paramtypes",[fM]),Yz("design:returntype",void 0)],mz,"getProfileCheck",null),Xz([Object(E.e)(),Yz("design:type",Function),Yz("design:paramtypes",[fM]),Yz("design:returntype",void 0)],mz,"getLoading",null),Xz([Object(E.e)(),Yz("design:type",Function),Yz("design:paramtypes",[fM]),Yz("design:returntype",void 0)],mz,"getVerifyingProfile",null),Xz([Object(E.e)(),Yz("design:type",Function),Yz("design:paramtypes",[fM]),Yz("design:returntype",void 0)],mz,"getProfileUpdating",null),Xz([Object(E.e)(),Yz("design:type",Function),Yz("design:paramtypes",[fM]),Yz("design:returntype",void 0)],mz,"getProfileDeleting",null),Xz([Object(E.e)(),Yz("design:type",Function),Yz("design:paramtypes",[fM]),Yz("design:returntype",void 0)],mz,"getUserLocale",null),Xz([Object(E.e)(),Yz("design:type",Function),Yz("design:paramtypes",[fM]),Yz("design:returntype",String)],mz,"getUserLanguage",null),Xz([Object(E.e)(),Yz("design:type",Function),Yz("design:paramtypes",[fM]),Yz("design:returntype",void 0)],mz,"getUserApps",null),Xz([Object(E.e)(),Yz("design:type",Function),Yz("design:paramtypes",[fM]),Yz("design:returntype",void 0)],mz,"getSelectedUserApp",null),Xz([Object(E.e)(),Yz("design:type",Function),Yz("design:paramtypes",[fM]),Yz("design:returntype",void 0)],mz,"isPrivateUser",null),Xz([Object(E.e)(),Yz("design:type",Function),Yz("design:paramtypes",[fM]),Yz("design:returntype",void 0)],mz,"isPremiumUser",null),mz=Xz([Object(E.f)({name:"auth",defaults:tT})],mz)),iT=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},oT=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},rT={publishing:!1,widgetURL:"/viewer",dimensions:BC.dimensions,minDimensions:{width:300,height:400}},aT=((kz=function(){function e(t,n,i){m(this,e),this.publishService=t,this.store=n,this.snackbar=i}return v(e,[{key:"setPublishWidgetURL",value:function(e,t){e.patchState({widgetURL:t.widgetURL||"/viewer"})}},{key:"setPublishDimensions",value:function(e,t){e.patchState({dimensions:t.dimensions})}},{key:"getPublishURL",value:function(e,t){var n=t.model,i=t.camera,o=t.widgetOptions,r=e.getState().widgetURL,a=this.store.selectSnapshot(nT.getUserLanguage),s=this.store.selectSnapshot(nT.getSelectedUserApp);this.publishService.generateWidgetURL(n,r,o,i,QC.Single,a,s).subscribe((function(t){e.dispatch(new rM(n,t))}),(function(){e.dispatch(new aM(n))}))}},{key:"getPublishURLFail",value:function(e,t){this.snackbar.open("Unable to generate URL.")}},{key:"getPublishIFrame",value:function(e,t){var n=t.model,i=t.camera,o=t.widgetOptions,r=e.getState(),a=r.widgetURL,s=r.dimensions,c=this.store.selectSnapshot(nT.getUserLanguage),l=this.store.selectSnapshot(nT.getSelectedUserApp);this.publishService.generateWidgetEmbed(n,a,o,s,i,QC.Single,c,l).subscribe((function(t){e.dispatch(new nM(t))}),(function(){e.dispatch(new iM)}))}},{key:"savePublishImage",value:function(e,t){var n=t.imageData,i=t.imageType;this.publishService.saveUserImage(n,i).subscribe((function(t){e.dispatch(new uM(t))}),(function(){e.dispatch(new pM)}))}},{key:"getPublishImage",value:function(e,t){var n=this,i=t.model,o=t.camera,r=t.widgetOptions,a=t.imageData,s=t.fileType,c=e.getState().widgetURL,l=this.store.selectSnapshot(nT.getUserLanguage),u=this.store.selectSnapshot(nT.getSelectedUserApp);Object(Qa.a)(this.publishService.generateWidgetURL(i,c,r,o,QC.Single,l,u),this.publishService.saveUserImage(a,s)).subscribe((function(t){var o=p(t,2),r=o[0],a=o[1],s=n.publishService.getImageEmbed(i.title,r,a);e.dispatch(new gM(s))}),(function(){e.dispatch(new hM)}))}},{key:"setPublishing",value:function(e,t){var n=t.publishing;e.patchState({publishing:n})}},{key:"resetPublish",value:function(e,t){e.setState(rT)}}],[{key:"getDimensions",value:function(e){return e.dimensions}},{key:"getMinDimensions",value:function(e){return e.minDimensions}},{key:"getWidgetURL",value:function(e){return e.widgetURL}},{key:"getPublishing",value:function(e){return e.publishing}}]),e}()).\u0275fac=function(e){return new(e||kz)(P.Zb(KC),P.Zb(E.g),P.Zb(ol.b))},kz.\u0275prov=P.Lb({token:kz,factory:kz.\u0275fac}),iT([Object(E.a)(YP),oT("design:type",Function),oT("design:paramtypes",[Object,YP]),oT("design:returntype",void 0)],kz.prototype,"setPublishWidgetURL",null),iT([Object(E.a)(eM),oT("design:type",Function),oT("design:paramtypes",[Object,eM]),oT("design:returntype",void 0)],kz.prototype,"setPublishDimensions",null),iT([Object(E.a)(oM),oT("design:type",Function),oT("design:paramtypes",[Object,oM]),oT("design:returntype",void 0)],kz.prototype,"getPublishURL",null),iT([Object(E.a)(aM),oT("design:type",Function),oT("design:paramtypes",[Object,aM]),oT("design:returntype",void 0)],kz.prototype,"getPublishURLFail",null),iT([Object(E.a)(tM),oT("design:type",Function),oT("design:paramtypes",[Object,tM]),oT("design:returntype",void 0)],kz.prototype,"getPublishIFrame",null),iT([Object(E.a)(lM),oT("design:type",Function),oT("design:paramtypes",[Object,lM]),oT("design:returntype",void 0)],kz.prototype,"savePublishImage",null),iT([Object(E.a)(dM),oT("design:type",Function),oT("design:paramtypes",[Object,dM]),oT("design:returntype",void 0)],kz.prototype,"getPublishImage",null),iT([Object(E.a)(sM),oT("design:type",Function),oT("design:paramtypes",[Object,sM]),oT("design:returntype",void 0)],kz.prototype,"setPublishing",null),iT([Object(E.a)(cM),oT("design:type",Function),oT("design:paramtypes",[Object,cM]),oT("design:returntype",void 0)],kz.prototype,"resetPublish",null),iT([Object(E.e)(),oT("design:type",Function),oT("design:paramtypes",[XP]),oT("design:returntype",void 0)],kz,"getDimensions",null),iT([Object(E.e)(),oT("design:type",Function),oT("design:paramtypes",[XP]),oT("design:returntype",void 0)],kz,"getMinDimensions",null),iT([Object(E.e)(),oT("design:type",Function),oT("design:paramtypes",[XP]),oT("design:returntype",void 0)],kz,"getWidgetURL",null),iT([Object(E.e)(),oT("design:type",Function),oT("design:paramtypes",[XP]),oT("design:returntype",void 0)],kz,"getPublishing",null),kz=iT([Object(E.f)({name:"publish",defaults:rT})],kz)),sT=((xz=function e(){m(this,e)}).\u0275mod=P.Nb({type:xz}),xz.\u0275inj=P.Mb({factory:function(e){return new(e||xz)},imports:[[ra.c,tP,eh.q,JP,nP.a,E.c.forFeature([aT])]]}),xz),cT=((yz=function e(){m(this,e)}).\u0275mod=P.Nb({type:yz}),yz.\u0275inj=P.Mb({factory:function(e){return new(e||yz)},imports:[[E.c.forFeature([bS]),ra.c,tP,eh.q,JP,Oe.f,sT,Ce.d]]}),yz),lT=function e(){m(this,e)},uT=function(e){return e[e.Query=0]="Query",e[e.Path=1]="Path",e}({}),pT=function(e){return e[e.List=0]="List",e[e.Card=1]="Card",e}({}),dT=U.application===M.Loft?pT.List:pT.Card,gT=function(e){return e.Success="success",e.Fail="fail",e}({}),hT="cdb/content",fT="cdb/copy/content",bT={headers:new K.d({"Content-Type":"application/json; charset=utf-8"})},vT=["production","client","preview","internal_content","public_preview","demos","social","exports","real_data"],mT=((wz=function(){function e(t,n){m(this,e),this.http=t,this.serializeModuleService=n}return v(e,[{key:"saveModule",value:function(e,t){t=this.formatModulePath(t);var n=[hT,"modules",t].join("/"),i=this.JSONStringify(e);return this.http.put(n,i,bT).pipe(Object(Z.a)((function(){return gT.Success})),Object(J.a)((function(e){var t=e.status;return t>=200&&t<=202?Object(G.a)(gT.Success):Object(G.a)(gT.Fail)})))}},{key:"copyState",value:function(e,t){var n=[fT,"states",t].join("/"),i={headers:new K.d({"Content-Type":"application/json; charset=utf-8","source-state":e})};return this.http.put(n,{},i)}},{key:"listContents",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=this.generateModulePath(e,t||"",n||"");return this.http.get("/cdb/ls/content/modules/"+o).pipe(Object(Z.a)((function(e){return i?e.contents.map((function(e){var t=e.name.replace("/content/modules/","").replace(".json",""),n=e.name.split("/").pop().replace("/content/modules","").replace(".json",""),i=new yw;return i.id=t,i.title=n,i.type=I.Module,i})):e.contents})))}},{key:"getState",value:function(e){return this.http.get("/cdb/ls/content/states/"+e).pipe(Object(Z.a)((function(e){return e.contents})))}},{key:"getClients",value:function(){return this.http.get("/search/client").pipe(Object(Z.a)((function(e){return e.clients})))}},{key:"getUsedStates",value:function(){var e=this,t={};return Object.values(Human.scene.objects).reduce((function(n,i){return["transformId","morphId","geometryId","materialId"].forEach((function(n){var o=e.getPropertyState(i,n);o.length&&(t[o]=!0)})),i.hasOwnProperty("renderables")&&["morphId","geometryId","materialId"].forEach((function(n){i.renderables.forEach((function(i){var o=e.getPropertyState(i,n);o.length&&(t[o]=!0)}))})),n}),{}),Object.keys(t)}},{key:"parseScenePath",value:function(e){var t=e.split("/");return 1===t.length?null:{fullPath:"https://qa.biodigital.com/content/modules/"+e,relativePath:t.slice(0,t.length-1).join("/"),sceneName:t[t.length-1]}}},{key:"formatModulePath",value:function(e){var t=e;return/\.json$/.test(e)||(t+=".json"),t}},{key:"getPrimaryCategories",value:function(){return Object(G.a)(vT)}},{key:"getSecondaryCategories",value:function(e){switch(e){case"production":return Object(G.a)(["maleAdult","femaleAdult"]);case"client":return this.getClients();default:return Object(G.a)([])}}},{key:"generateSaveModule",value:function(e){var t=this.parseScenePath(e),n=t.relativePath.split("/");return{id:e,name:t.sceneName,primaryCategory:n[0]||"",secondaryCategory:n[1]||""}}},{key:"generateModulePath",value:function(e,t,n){var i=[];return e.length&&i.push(e),t.length&&i.push(t),n.length&&(n.indexOf(".json")<0&&(n+=".json"),i.push(n)),i.join("/")}},{key:"getPropertyState",value:function(e,t){return null!=e[t]?e[t].split("/")[0]:""}},{key:"JSONStringify",value:function(e){return JSON.stringify(e).replace(/[\u007f-\uffff]/g,(function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}))}}]),e}()).\u0275fac=function(e){return new(e||wz)(P.Zb(K.b),P.Zb(zs))},wz.\u0275prov=P.Lb({token:wz,factory:wz.\u0275fac,providedIn:"root"}),wz),yT=function(e){return e.Organization="Organization",e.Collection="Collection",e.Private="Private",e.Category="Category",e.Community="Community",e.Internal="Internal",e.Loft="Loft",e}({}),xT=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1?arguments[1]:void 0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:25,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;m(this,e),this.query=t,this.sortBy=n,this.pageSize=i,this.offset=o},kT=function e(){m(this,e)},wT=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},OT=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},CT={loading:!0,searchMode:uT.Query,viewMode:dT,searchResults:{total:0,items:[]},checkedResults:[],searchConfig:null,searchOptions:null,sidenav:{enabled:!0,open:!0},bulkActions:{enabled:!0,items:[]},cardActions:{enabled:!0}},ST=((Iz=function(){function e(t,n,i,o,r){m(this,e),this.organizationsService=t,this.modulesService=n,this.exploreService=i,this.bookmarksService=o,this.store=r}return v(e,[{key:"setSearchMode",value:function(e,t){e.patchState({searchMode:t.searchMode})}},{key:"setViewMode",value:function(e,t){e.patchState({viewMode:t.viewMode})}},{key:"setSearchOptions",value:function(e,t){e.patchState({searchOptions:Object.assign({},t.options)})}},{key:"setSearchConfig",value:function(e,t){var n=t.config||e.getState().searchConfig,i=t.options||e.getState().searchOptions;null!==n&&e.patchState({searchOptions:Object.assign({},i),searchConfig:Object.assign({},n)})}},{key:"searchStudio",value:function(e,t){var n=e.getState(),i=n.searchConfig,o=n.searchOptions,r=new xT("",EC),a=this.store.selectSnapshot(nT.getUserLanguage);e.patchState({loading:!0,searchOptions:Object.assign(Object.assign({},o),{pageSize:r.pageSize,offset:r.offset}),checkedResults:[]});var s=new be.a;switch(i.type){case yT.Category:s=this.exploreService.getAnatomyCategory(i.query,"all"===i.categoryId?"":i.categoryId,i.tags,a);break;case yT.Organization:s=this.bookmarksService.getOrganizationContent(i.organizationId,i.query);break;case yT.Collection:s=this.organizationsService.getCollectionContent(i.organizationId,i.collectionId,i.query);break;case yT.Community:s=this.bookmarksService.getPublicBookmarks(i.query);break;case yT.Private:s=this.bookmarksService.getPrivateBookmarks(i.query);break;case yT.Internal:s=this.exploreService.searchInternal(i.query,i.directory);break;case yT.Loft:var c=i.query.indexOf(".json")>0;s=this.modulesService.listContents(i.primary,i.secondary,c?i.query:"",!0).pipe(Object(Z.a)((function(e){return c?e:e.filter((function(e){return e.title.indexOf(i.query)>=0}))})))}s.pipe(Object(se.a)((function(){return e.patchState({loading:!1})}))).subscribe((function(t){e.dispatch(new BP.SearchSuccess(t))}))}},{key:"searchSuccess",value:function(e,t){e.patchState({searchResults:{items:t.bookmarks,total:t.bookmarks.length}})}},{key:"checkItem",value:function(e,t){var n=e.getState().checkedResults,i=n.some((function(e){return e===t.id}));t.checked&&!i?n=[].concat(c(n),[t.id]):t.checked||(n=n.filter((function(e){return e!==t.id}))),e.patchState({checkedResults:n})}},{key:"checkAll",value:function(e,t){Object(Se.isNil)(t.checked);var n=e.getState().searchResults.items.map((function(e){return e.id}));e.patchState({checkedResults:n})}},{key:"setCheckedItems",value:function(e,t){e.patchState({checkedResults:t.ids})}},{key:"setSidenav",value:function(e,t){e.patchState({sidenav:Object.assign({},t.sidenav)})}},{key:"setCardActions",value:function(e,t){e.patchState({cardActions:Object.assign({},t.cardActions)})}},{key:"setBulkActions",value:function(e,t){e.patchState({bulkActions:Object.assign({},t.bulkActions)})}},{key:"clearResults",value:function(e,t){e.patchState({searchResults:{items:[],total:0}})}},{key:"resetGallery",value:function(e,t){e.patchState(CT)}}],[{key:"getLoading",value:function(e){return e.loading}},{key:"getSearchMode",value:function(e){return e.searchMode}},{key:"getSearchConfig",value:function(e){return e.searchConfig}},{key:"getSearchOptions",value:function(e){return e.searchOptions}},{key:"getSearchType",value:function(e){return e.searchConfig?e.searchConfig.type:null}},{key:"getSearchGroup",value:function(e){var t;switch(null===(t=e.searchConfig)||void 0===t?void 0:t.type){case yT.Category:case yT.Community:case yT.Internal:case yT.Loft:return I.Module;case yT.Collection:case yT.Private:case yT.Organization:return I.Bookmark}}},{key:"getViewMode",value:function(e){return e.viewMode}},{key:"getSort",value:function(e){return e.searchOptions.sortBy}},{key:"getSortOptions",value:function(e){switch(e.searchConfig.type){case yT.Loft:return[EC,FC];case yT.Category:return[LC,DC,EC,FC];default:return[DC,EC,FC,AC,RC]}}},{key:"getSidenav",value:function(e){return e.sidenav}},{key:"getBulkActions",value:function(e){return e.bulkActions}},{key:"getCardActions",value:function(e){return e.cardActions}},{key:"getFilteredResults",value:function(e,t){var n=e.searchResults,i=e.searchOptions,o=i.sortBy,r=o.ascending,a=o.fields,s=lS(n.items,a,r);return!0!==Object(Se.get)(t,"userProfile.premium_account_valid")&&(s=[].concat(c(s.filter((function(e){return!0!==e.premium}))),c(s.filter((function(e){return!0===e.premium}))))),s=s.slice(i.offset,i.offset+i.pageSize),Object.assign(Object.assign({},n),{items:s})}},{key:"getAllResults",value:function(e,t){var n=e.searchResults,i=e.searchOptions.sortBy,o=i.ascending,r=i.fields,a=lS(n.items,r,o);return!0!==Object(Se.get)(t,"userProfile.premium_account_valid")&&(a=[].concat(c(a.filter((function(e){return!0!==e.premium}))),c(a.filter((function(e){return!0===e.premium}))))),{total:n.total,items:a}}},{key:"getCheckedResults",value:function(e){return e.checkedResults}}]),e}()).\u0275fac=function(e){return new(e||Iz)(P.Zb(sS),P.Zb(mT),P.Zb(jw),P.Zb(zw),P.Zb(E.g))},Iz.\u0275prov=P.Lb({token:Iz,factory:Iz.\u0275fac}),wT([Object(E.a)(BP.SetSearchMode),OT("design:type",Function),OT("design:paramtypes",[Object,BP.SetSearchMode]),OT("design:returntype",void 0)],Iz.prototype,"setSearchMode",null),wT([Object(E.a)(BP.SetViewMode),OT("design:type",Function),OT("design:paramtypes",[Object,BP.SetViewMode]),OT("design:returntype",void 0)],Iz.prototype,"setViewMode",null),wT([Object(E.a)(BP.SetSearchOptions),OT("design:type",Function),OT("design:paramtypes",[Object,BP.SetSearchOptions]),OT("design:returntype",void 0)],Iz.prototype,"setSearchOptions",null),wT([Object(E.a)(BP.SetSearchConfig),OT("design:type",Function),OT("design:paramtypes",[Object,BP.SetSearchConfig]),OT("design:returntype",void 0)],Iz.prototype,"setSearchConfig",null),wT([Object(E.a)(BP.SearchStudio),OT("design:type",Function),OT("design:paramtypes",[Object,BP.SearchStudio]),OT("design:returntype",void 0)],Iz.prototype,"searchStudio",null),wT([Object(E.a)(BP.SearchSuccess),OT("design:type",Function),OT("design:paramtypes",[Object,BP.SearchSuccess]),OT("design:returntype",void 0)],Iz.prototype,"searchSuccess",null),wT([Object(E.a)(BP.CheckItem),OT("design:type",Function),OT("design:paramtypes",[Object,BP.CheckItem]),OT("design:returntype",void 0)],Iz.prototype,"checkItem",null),wT([Object(E.a)(BP.CheckAll),OT("design:type",Function),OT("design:paramtypes",[Object,BP.CheckAll]),OT("design:returntype",void 0)],Iz.prototype,"checkAll",null),wT([Object(E.a)(BP.SetCheckedItems),OT("design:type",Function),OT("design:paramtypes",[Object,BP.SetCheckedItems]),OT("design:returntype",void 0)],Iz.prototype,"setCheckedItems",null),wT([Object(E.a)(BP.SetSidenav),OT("design:type",Function),OT("design:paramtypes",[Object,BP.SetSidenav]),OT("design:returntype",void 0)],Iz.prototype,"setSidenav",null),wT([Object(E.a)(BP.SetCardActions),OT("design:type",Function),OT("design:paramtypes",[Object,BP.SetCardActions]),OT("design:returntype",void 0)],Iz.prototype,"setCardActions",null),wT([Object(E.a)(BP.SetBulkActions),OT("design:type",Function),OT("design:paramtypes",[Object,BP.SetBulkActions]),OT("design:returntype",void 0)],Iz.prototype,"setBulkActions",null),wT([Object(E.a)(BP.ClearResults),OT("design:type",Function),OT("design:paramtypes",[Object,BP.ClearResults]),OT("design:returntype",void 0)],Iz.prototype,"clearResults",null),wT([Object(E.a)(BP.Reset),OT("design:type",Function),OT("design:paramtypes",[Object,BP.Reset]),OT("design:returntype",void 0)],Iz.prototype,"resetGallery",null),wT([Object(E.e)(),OT("design:type",Function),OT("design:paramtypes",[lT]),OT("design:returntype",void 0)],Iz,"getLoading",null),wT([Object(E.e)(),OT("design:type",Function),OT("design:paramtypes",[lT]),OT("design:returntype",void 0)],Iz,"getSearchMode",null),wT([Object(E.e)(),OT("design:type",Function),OT("design:paramtypes",[lT]),OT("design:returntype",void 0)],Iz,"getSearchConfig",null),wT([Object(E.e)(),OT("design:type",Function),OT("design:paramtypes",[lT]),OT("design:returntype",void 0)],Iz,"getSearchOptions",null),wT([Object(E.e)(),OT("design:type",Function),OT("design:paramtypes",[lT]),OT("design:returntype",void 0)],Iz,"getSearchType",null),wT([Object(E.e)(),OT("design:type",Function),OT("design:paramtypes",[lT]),OT("design:returntype",void 0)],Iz,"getSearchGroup",null),wT([Object(E.e)(),OT("design:type",Function),OT("design:paramtypes",[lT]),OT("design:returntype",void 0)],Iz,"getViewMode",null),wT([Object(E.e)(),OT("design:type",Function),OT("design:paramtypes",[lT]),OT("design:returntype",void 0)],Iz,"getSort",null),wT([Object(E.e)(),OT("design:type",Function),OT("design:paramtypes",[lT]),OT("design:returntype",void 0)],Iz,"getSortOptions",null),wT([Object(E.e)(),OT("design:type",Function),OT("design:paramtypes",[lT]),OT("design:returntype",void 0)],Iz,"getSidenav",null),wT([Object(E.e)(),OT("design:type",Function),OT("design:paramtypes",[lT]),OT("design:returntype",void 0)],Iz,"getBulkActions",null),wT([Object(E.e)(),OT("design:type",Function),OT("design:paramtypes",[lT]),OT("design:returntype",void 0)],Iz,"getCardActions",null),wT([Object(E.e)([nT]),OT("design:type",Function),OT("design:paramtypes",[lT,fM]),OT("design:returntype",kT)],Iz,"getFilteredResults",null),wT([Object(E.e)(),OT("design:type",Function),OT("design:paramtypes",[lT,fM]),OT("design:returntype",kT)],Iz,"getAllResults",null),wT([Object(E.e)(),OT("design:type",Function),OT("design:paramtypes",[lT]),OT("design:returntype",void 0)],Iz,"getCheckedResults",null),Iz=wT([Object(E.f)({name:"gallery",defaults:CT})],Iz)),_T=((Mz=function e(){m(this,e)}).\u0275mod=P.Nb({type:Mz}),Mz.\u0275inj=P.Mb({factory:function(e){return new(e||Mz)},imports:[[E.c.forFeature([ST]),yf.b,Oe.f,vP,ra.c,eh.q,cT,jP,iP,tP,ZP,HP,JP,qj.a]]}),Mz),jT=((Pz=function e(){m(this,e)}).\u0275mod=P.Nb({type:Pz}),Pz.\u0275inj=P.Mb({factory:function(e){return new(e||Pz)},imports:[[JP,tP,ra.c,Oe.f,ZP,Sa,eh.q,cT,_T,E.c.forFeature([Wp])]]}),Pz),PT=((jz=function e(){m(this,e)}).\u0275mod=P.Nb({type:jz}),jz.\u0275inj=P.Mb({factory:function(e){return new(e||jz)},imports:[[ra.c,Dd.a.forChild()]]}),jz),MT=((_z=function e(){m(this,e)}).\u0275mod=P.Nb({type:_z}),_z.\u0275inj=P.Mb({factory:function(e){return new(e||_z)},imports:[[ra.c,JP,tP,PT]]}),_z),IT=((Sz=function e(){m(this,e)}).\u0275mod=P.Nb({type:Sz}),Sz.\u0275inj=P.Mb({factory:function(e){return new(e||Sz)},imports:[[E.c.forFeature([_o]),ra.c,bP,eh.q]]}),Sz),zT=((Cz=function e(){m(this,e)}).\u0275mod=P.Nb({type:Cz}),Cz.\u0275inj=P.Mb({factory:function(e){return new(e||Cz)},imports:[[E.c.forFeature([Hs,Lr,Is]),ra.c,JP,tP,PP,MT,eh.q,Dd.a.forChild(),IT]]}),Cz),TT=((Oz=function e(){m(this,e)}).\u0275mod=P.Nb({type:Oz}),Oz.\u0275inj=P.Mb({factory:function(e){return new(e||Oz)},imports:[[E.c.forFeature([Wr,Ar,Ai,Xu,ao]),Ce.d,ra.c,jP,tP,eh.i,zT,JP,PP]]}),Oz),UT=function e(){m(this,e)},LT=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},DT=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},ET={joining:!1,inviting:!1,loadingUsers:!1,users:[]},FT=((qz=function(){function e(t,n,i){m(this,e),this.organizationsService=t,this.publishService=n,this.pendoService=i}return v(e,[{key:"selectOrganization",value:function(e,t){var n=t.organization;e.patchState({selectedOrganization:n,selectedCollection:null}),n&&e.dispatch(new QI(n.id))}},{key:"setOrganizations",value:function(e,t){var n,i=t.organizations||[],o=i[0],r=null,a=Object.assign({},e.getState().appFeatures);if(o&&o.group_attributes){var s=o.group_attributes,c=this.organizationsService.getOrganizationAttribute(s,"widget_settings","widget_custom_url_path");c&&c.value&&(n=c.value);var l=this.organizationsService.getOrganizationAttribute(s,"widget_settings","widget_url_params");l&&l.value&&(r=this.publishService.extendWidgetOptions(new NC,l.value));var u=this.organizationsService.getOrganizationAttribute(s,"app_settings","web_app_features");u&&(a=Object.assign(Object.assign({},a),u.value))}e.patchState({organization:o,organizations:i,widgetURL:n,widgetOptions:r,appFeatures:a}),e.dispatch(new YP(n))}},{key:"joinOrganization",value:function(e,t){var n=t.organization;e.patchState({joining:!0}),this.organizationsService.addUserToOrganization(n.eid).pipe(Object(se.a)((function(){return e.patchState({joining:!1})}))).subscribe((function(){return e.dispatch(new $I(n))}),(function(t){return e.dispatch(new KI(n))}))}},{key:"joinOrganizationWithCode",value:function(e,t){var n=t.code;e.patchState({joining:!0}),this.organizationsService.addUserWithGroupCode(n).pipe(Object(se.a)((function(){return e.patchState({joining:!1})}))).subscribe((function(t){return e.dispatch(new ZI(t))}),(function(t){return e.dispatch(new JI(t))}))}},{key:"joinOrganizationWithCodeSuccess",value:function(e){this.pendoService.track("Account Upgrade - Free Individual to Team")}},{key:"sendOrganizationInvite",value:function(e,t){var n=t.groupEID,i=t.emails;e.patchState({inviting:!0}),this.organizationsService.sendOrganizationInvites(n,i).pipe(Object(se.a)((function(){return e.patchState({inviting:!1})}))).subscribe((function(t){return e.dispatch(new YI(t))}),(function(t){return e.dispatch(new ez(t))}))}},{key:"getOrganizationUsers",value:function(e,t){var n=t.groupId;e.patchState({loadingUsers:!0}),this.organizationsService.getOrganizationUsers({group_id:n}).pipe(Object(se.a)((function(){return e.patchState({loadingUsers:!1})}))).subscribe((function(t){return e.dispatch(new nz(t))}),(function(t){return e.dispatch(new iz(t))}))}},{key:"getOrganizationUsersSuccess",value:function(e,t){var n=t.users;e.patchState({users:n})}},{key:"getCollections",value:function(e,t){this.organizationsService.getCollections(t.organizationId).subscribe((function(t){e.dispatch(new qI(t))}))}},{key:"getCollectionsSuccess",value:function(e,t){e.patchState({collections:t.collections})}},{key:"selectCollection",value:function(e,t){var n=e.getState(),i=n.organization,o=n.selectedOrganization;e.patchState({selectedOrganization:o||i,selectedCollection:t.collection})}},{key:"resetOrganizations",value:function(e,t){e.setState(ET)}},{key:"updateUserRoles",value:function(e,t){var n=t.groupId,i=t.users;this.organizationsService.updateUserRoles(n,i).subscribe((function(){return e.dispatch(new az(n,i))}),(function(){return e.dispatch(new sz)}))}},{key:"removeOrganizationUser",value:function(e,t){var n=t.groupId,i=t.users;this.organizationsService.removeUsers(n,i).subscribe((function(){return e.dispatch(new lz(n,i))}),(function(){return e.dispatch(new uz)}))}},{key:"transferOrganizationContent",value:function(e,t){var n=t.groupId,i=t.users;this.organizationsService.transferUserContent(n,i).subscribe((function(){return e.dispatch(new dz(n,i))}),(function(){return e.dispatch(new gz)}))}}],[{key:"getOrganizations",value:function(e){return e.organizations}},{key:"getOrganization",value:function(e){return e.organization}},{key:"getSelectedOrganization",value:function(e){return e.selectedOrganization}},{key:"getUsers",value:function(e){return e.users}},{key:"getCollections",value:function(e){return e.collections}},{key:"getSelectedCollection",value:function(e){return e.selectedCollection}},{key:"getWidgetURL",value:function(e){return e.widgetURL}},{key:"getWidgetOptions",value:function(e){return e.widgetOptions}},{key:"getAppFeatures",value:function(e){return e.appFeatures}},{key:"getJoining",value:function(e){return e.joining}},{key:"getInviting",value:function(e){return e.inviting}},{key:"getUsersLoading",value:function(e){return e.loadingUsers}}]),e}()).\u0275fac=function(e){return new(e||qz)(P.Zb(sS),P.Zb(KC),P.Zb(je))},qz.\u0275prov=P.Lb({token:qz,factory:qz.\u0275fac}),LT([Object(E.a)(BI),DT("design:type",Function),DT("design:paramtypes",[Object,BI]),DT("design:returntype",void 0)],qz.prototype,"selectOrganization",null),LT([Object(E.a)(NI),DT("design:type",Function),DT("design:paramtypes",[Object,NI]),DT("design:returntype",void 0)],qz.prototype,"setOrganizations",null),LT([Object(E.a)(WI),DT("design:type",Function),DT("design:paramtypes",[Object,WI]),DT("design:returntype",void 0)],qz.prototype,"joinOrganization",null),LT([Object(E.a)(GI),DT("design:type",Function),DT("design:paramtypes",[Object,GI]),DT("design:returntype",void 0)],qz.prototype,"joinOrganizationWithCode",null),LT([Object(E.a)(ZI),DT("design:type",Function),DT("design:paramtypes",[Object]),DT("design:returntype",void 0)],qz.prototype,"joinOrganizationWithCodeSuccess",null),LT([Object(E.a)(XI),DT("design:type",Function),DT("design:paramtypes",[Object,XI]),DT("design:returntype",void 0)],qz.prototype,"sendOrganizationInvite",null),LT([Object(E.a)(tz),DT("design:type",Function),DT("design:paramtypes",[Object,tz]),DT("design:returntype",void 0)],qz.prototype,"getOrganizationUsers",null),LT([Object(E.a)(nz),DT("design:type",Function),DT("design:paramtypes",[Object,nz]),DT("design:returntype",void 0)],qz.prototype,"getOrganizationUsersSuccess",null),LT([Object(E.a)(QI),DT("design:type",Function),DT("design:paramtypes",[Object,QI]),DT("design:returntype",void 0)],qz.prototype,"getCollections",null),LT([Object(E.a)(qI),DT("design:type",Function),DT("design:paramtypes",[Object,qI]),DT("design:returntype",void 0)],qz.prototype,"getCollectionsSuccess",null),LT([Object(E.a)(HI),DT("design:type",Function),DT("design:paramtypes",[Object,HI]),DT("design:returntype",void 0)],qz.prototype,"selectCollection",null),LT([Object(E.a)(oz),DT("design:type",Function),DT("design:paramtypes",[Object,oz]),DT("design:returntype",void 0)],qz.prototype,"resetOrganizations",null),LT([Object(E.a)(rz),DT("design:type",Function),DT("design:paramtypes",[Object,rz]),DT("design:returntype",void 0)],qz.prototype,"updateUserRoles",null),LT([Object(E.a)(cz),DT("design:type",Function),DT("design:paramtypes",[Object,cz]),DT("design:returntype",void 0)],qz.prototype,"removeOrganizationUser",null),LT([Object(E.a)(pz),DT("design:type",Function),DT("design:paramtypes",[Object,pz]),DT("design:returntype",void 0)],qz.prototype,"transferOrganizationContent",null),LT([Object(E.e)(),DT("design:type",Function),DT("design:paramtypes",[UT]),DT("design:returntype",void 0)],qz,"getOrganizations",null),LT([Object(E.e)(),DT("design:type",Function),DT("design:paramtypes",[UT]),DT("design:returntype",void 0)],qz,"getOrganization",null),LT([Object(E.e)(),DT("design:type",Function),DT("design:paramtypes",[UT]),DT("design:returntype",void 0)],qz,"getSelectedOrganization",null),LT([Object(E.e)(),DT("design:type",Function),DT("design:paramtypes",[UT]),DT("design:returntype",void 0)],qz,"getUsers",null),LT([Object(E.e)(),DT("design:type",Function),DT("design:paramtypes",[UT]),DT("design:returntype",void 0)],qz,"getCollections",null),LT([Object(E.e)(),DT("design:type",Function),DT("design:paramtypes",[UT]),DT("design:returntype",void 0)],qz,"getSelectedCollection",null),LT([Object(E.e)(),DT("design:type",Function),DT("design:paramtypes",[UT]),DT("design:returntype",void 0)],qz,"getWidgetURL",null),LT([Object(E.e)(),DT("design:type",Function),DT("design:paramtypes",[UT]),DT("design:returntype",void 0)],qz,"getWidgetOptions",null),LT([Object(E.e)(),DT("design:type",Function),DT("design:paramtypes",[UT]),DT("design:returntype",void 0)],qz,"getAppFeatures",null),LT([Object(E.e)(),DT("design:type",Function),DT("design:paramtypes",[UT]),DT("design:returntype",void 0)],qz,"getJoining",null),LT([Object(E.e)(),DT("design:type",Function),DT("design:paramtypes",[UT]),DT("design:returntype",void 0)],qz,"getInviting",null),LT([Object(E.e)(),DT("design:type",Function),DT("design:paramtypes",[UT]),DT("design:returntype",void 0)],qz,"getUsersLoading",null),qz=LT([Object(E.f)({name:"organizations",defaults:ET})],qz)),AT=((Qz=function e(){m(this,e)}).\u0275mod=P.Nb({type:Qz}),Qz.\u0275inj=P.Mb({factory:function(e){return new(e||Qz)},imports:[[ra.c,tP,JP,sT,E.c.forFeature([FT])]]}),Qz),RT=((Hz=function e(){m(this,e)}).\u0275mod=P.Nb({type:Hz}),Hz.\u0275inj=P.Mb({factory:function(e){return new(e||Hz)},imports:[[ra.c,tP,JP]]}),Hz),VT=((Bz=function e(){m(this,e)}).\u0275mod=P.Nb({type:Bz}),Bz.\u0275inj=P.Mb({factory:function(e){return new(e||Bz)},imports:[[ra.c,tP,JP]]}),Bz),NT=((Nz=function e(){m(this,e)}).\u0275mod=P.Nb({type:Nz}),Nz.\u0275inj=P.Mb({factory:function(e){return new(e||Nz)},imports:[[ra.c,tP,JP,eh.q]]}),Nz),BT=((Vz=function e(){m(this,e)}).\u0275mod=P.Nb({type:Vz}),Vz.\u0275inj=P.Mb({factory:function(e){return new(e||Vz)},imports:[[ra.c,tP,JP]]}),Vz),HT=((Rz=function e(){m(this,e)}).\u0275mod=P.Nb({type:Rz}),Rz.\u0275inj=P.Mb({factory:function(e){return new(e||Rz)},imports:[[ra.c,tP,JP]]}),Rz),QT=((Az=function e(){m(this,e)}).\u0275mod=P.Nb({type:Az}),Az.\u0275inj=P.Mb({factory:function(e){return new(e||Az)},imports:[[ra.c,tP,JP]]}),Az),qT=((Fz=function e(){m(this,e)}).\u0275mod=P.Nb({type:Fz}),Fz.\u0275inj=P.Mb({factory:function(e){return new(e||Fz)},imports:[[ra.c,tP,JP]]}),Fz),WT=((Ez=function e(){m(this,e)}).\u0275mod=P.Nb({type:Ez}),Ez.\u0275inj=P.Mb({factory:function(e){return new(e||Ez)},imports:[[ra.c,tP,JP]]}),Ez),$T=((Dz=function e(){m(this,e)}).\u0275mod=P.Nb({type:Dz}),Dz.\u0275inj=P.Mb({factory:function(e){return new(e||Dz)},imports:[[ra.c,tP,vP]]}),Dz),KT=((Lz=function e(){m(this,e)}).\u0275mod=P.Nb({type:Lz}),Lz.\u0275inj=P.Mb({factory:function(e){return new(e||Lz)},imports:[[ra.c,tP,JP]]}),Lz),GT=((Uz=function e(){m(this,e)}).\u0275mod=P.Nb({type:Uz}),Uz.\u0275inj=P.Mb({factory:function(e){return new(e||Uz)},imports:[[ra.c,tP,JP,eh.q]]}),Uz),ZT=((Tz=function e(){m(this,e)}).\u0275mod=P.Nb({type:Tz}),Tz.\u0275inj=P.Mb({factory:function(e){return new(e||Tz)},imports:[[ra.c,tP,JP,eh.q]]}),Tz),JT=((zz=function e(){m(this,e)}).\u0275mod=P.Nb({type:zz}),zz.\u0275inj=P.Mb({factory:function(e){return new(e||zz)},imports:[[ra.c,tP,JP]]}),zz),XT=function e(){m(this,e)};!function(e){var t=function e(){m(this,e)};t.type="[Dialog] Open Limit",e.OpenLimit=t;var n=function e(t){m(this,e),this.upgrade=t};n.type="[Dialog] Close Limit",e.CloseLimit=n;var i=function e(){m(this,e)};i.type="[Dialog] Open Premium Content",e.OpenPremiumContent=i;var o=function e(t){m(this,e),this.confirmed=t};o.type="[Dialog] Close Premium Content",e.ClosePremiumContent=o;var r=function e(){m(this,e)};r.type="[Dialog] Open Upgrade",e.OpenUpgrade=r;var a=function e(){m(this,e)};a.type="[Dialog] Close Upgrade",e.CloseUpgrade=a}(Wz||(Wz={}));var YT,eU=((YT=function(){function e(){m(this,e)}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||YT)},YT.\u0275cmp=P.Jb({type:YT,selectors:[["app-limit-dialog"]],decls:12,vars:2,consts:[["mat-dialog-title",""],["mat-dialog-content","",1,"pt-1","pb-6"],[1,"text-14","pb-3"],[1,"text-14"],["mat-dialog-actions","",1,"pt-2"],["app-button","","buttonTheme","light","cdkFocusInitial","",1,"mr-2",3,"mat-dialog-close"],["app-button","","buttonType","primary",3,"mat-dialog-close"]],template:function(e,t){1&e&&(P.Vb(0,"h1",0),P.Mc(1," New Bookmark Limit Reached\n"),P.Ub(),P.Vb(2,"div",1),P.Vb(3,"div",2),P.Mc(4,"You've reached your limit of 5 3D models in your Library. You can make changes to this model, but you will not be able to save as a new model."),P.Ub(),P.Vb(5,"div",3),P.Mc(6,"Upgrade to a Premium Plan to save unlimited 3D models."),P.Ub(),P.Ub(),P.Vb(7,"div",4),P.Vb(8,"button",5),P.Mc(9,"OK"),P.Ub(),P.Vb(10,"button",6),P.Mc(11,"Go Premium"),P.Ub(),P.Ub()),2&e&&(P.Db(8),P.lc("mat-dialog-close",!1),P.Db(2),P.lc("mat-dialog-close",!0))},directives:[ug.h,ug.e,ug.c,gl,ug.d],styles:[""],changeDetection:0}),YT);function tU(e,t){if(1&e&&P.Qb(0,"iframe",5),2&e){var n=P.gc();P.lc("src",n.src,P.Bc)}}var nU,iU=function(e){return e.UpgradeSubscription="/legacy/upgrade-human.html",e.BuySubscription="/legacy/buy-subscription.html",e.MyProfile="/legacy/user-account.html",e}({}),oU=((nU=function(){function e(t,n,i){m(this,e),this.dialogRef=t,this.data=n,this.sanitizer=i,this.headerOffset=100,this.settings={type:null,dimensions:{width:100,height:100}},this.settings=Object.assign(Object.assign({},this.settings),n);var o=n.dimensions,r=o.width,a=o.height;this.dialogRef.updateSize(r+"px",a+"px")}return v(e,[{key:"height",get:function(){var e=this.settings.dimensions.height;return Math.max(200,e-this.headerOffset)}},{key:"src",get:function(){var e=this.getURL();return e?this.sanitizer.bypassSecurityTrustResourceUrl(e):null}},{key:"ngOnInit",value:function(){}},{key:"closeDialog",value:function(){this.dialogRef.close()}},{key:"getURL",value:function(){var e=""+this.settings.type;if(Object.values(iU).includes(e)){var t=this.getURLParams();return t?"".concat(e,"?").concat(t):e}return""}},{key:"getURLParams",value:function(){var e=this.settings.options;return e?Object.entries(e).map((function(e){var t=p(e,2),n=t[0],i=t[1];return"".concat(n,"=").concat(i)})).join("&"):""}}]),e}()).\u0275fac=function(e){return new(e||nU)(P.Pb(ug.g),P.Pb(ug.a),P.Pb(L.b))},nU.\u0275cmp=P.Jb({type:nU,selectors:[["app-legacy-dialog"]],decls:5,vars:4,consts:[[1,"modal"],["app-button","","buttonType","text","buttonTheme","light","type","button","title","Close",1,"modal__close",3,"click"],["icon","times","size","lg"],[1,"modal__contents"],["class","modal__frame",3,"src",4,"ngIf"],[1,"modal__frame",3,"src"]],template:function(e,t){1&e&&(P.Vb(0,"div",0),P.Vb(1,"button",1),P.cc("click",(function(){return t.closeDialog()})),P.Qb(2,"app-icon",2),P.Ub(),P.Vb(3,"div",3),P.Kc(4,tU,1,1,"iframe",4),P.Ub(),P.Ub()),2&e&&(P.Db(1),P.Eb("aria-label","Close"),P.Db(2),P.Hc("height",t.height+"px"),P.Db(1),P.lc("ngIf",t.src))},directives:[gl,nl,ra.l],styles:[".modal[_ngcontent-%COMP%]{display:flex;flex-direction:column}.modal__close[_ngcontent-%COMP%]{margin-bottom:4px;align-self:flex-end;cursor:pointer}.modal__contents[_ngcontent-%COMP%]{display:flex;flex-flow:column;height:100vh}.modal__frame[_ngcontent-%COMP%]{flex:1 1 auto;display:flex}"],changeDetection:0}),nU);function rU(e,t){if(1&e&&(P.Vb(0,"button",8),P.Mc(1),P.Ub()),2&e){var n=P.gc();P.Db(1),P.Nc(n.settings.miscText)}}function aU(e,t){if(1&e&&(P.Vb(0,"button",9),P.Mc(1),P.Ub()),2&e){var n=P.gc();P.lc("mat-dialog-close",!1),P.Db(1),P.Nc(n.settings.cancelText)}}function sU(e,t){if(1&e&&(P.Vb(0,"button",10),P.Mc(1),P.Ub()),2&e){var n=P.gc();P.lc("mat-dialog-close",!0),P.Db(1),P.Nc(n.settings.confirmText)}}var cU,lU,uU,pU,dU,gU,hU,fU,bU,vU,mU,yU,xU,kU,wU,OU,CU,SU,_U,jU,PU,MU,IU=((cU=function(){function e(t,n){m(this,e),this.dialogRef=t,this.data=n,this.settings={titleText:"Confirm Action",bodyText:"",confirmText:"Confirm",confirmColor:"primary",cancelText:"Cancel",confirmEnabled:!0,cancelEnabled:!0,miscText:""},n&&(this.settings=Object.assign(Object.assign({},this.settings),n))}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||cU)(P.Pb(ug.g),P.Pb(ug.a))},cU.\u0275cmp=P.Jb({type:cU,selectors:[["app-confirm-dialog"]],decls:11,vars:7,consts:[["data-test","confirmDialog"],["mat-dialog-title",""],["mat-dialog-content","",1,"pt-4","pb-6"],[1,"text-14"],["mat-dialog-actions","",1,"dialog__actions","pt-2"],["app-button","","buttonTheme","light",3,"mat-dialog-close",4,"ngIf"],["class","mr-1","app-button","","buttonTheme","light",3,"mat-dialog-close",4,"ngIf"],["app-button","","buttonType","primary","cdkFocusInitial","",3,"mat-dialog-close",4,"ngIf"],["app-button","","buttonTheme","light",3,"mat-dialog-close"],["app-button","","buttonTheme","light",1,"mr-1",3,"mat-dialog-close"],["app-button","","buttonType","primary","cdkFocusInitial","",3,"mat-dialog-close"]],template:function(e,t){1&e&&(P.Vb(0,"div",0),P.Vb(1,"h1",1),P.Mc(2),P.Ub(),P.Vb(3,"div",2),P.Vb(4,"div",3),P.Mc(5),P.Ub(),P.Ub(),P.Vb(6,"div",4),P.Kc(7,rU,2,1,"button",5),P.Vb(8,"div"),P.Kc(9,aU,2,2,"button",6),P.Kc(10,sU,2,2,"button",7),P.Ub(),P.Ub(),P.Ub()),2&e&&(P.Db(2),P.Oc(" ",t.settings.titleText," "),P.Db(3),P.Nc(t.settings.bodyText),P.Db(1),P.Hb("dialog__actions--compact",!t.settings.miscText),P.Db(1),P.lc("ngIf",t.settings.miscText),P.Db(2),P.lc("ngIf",t.settings.cancelEnabled),P.Db(1),P.lc("ngIf",t.settings.confirmEnabled))},directives:[ug.h,ug.e,ug.c,ra.l,gl,ug.d],styles:["[_nghost-%COMP%]{display:block}.dialog__actions[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:center}.dialog__actions--compact[_ngcontent-%COMP%]{justify-content:flex-end}@media (min-width:480px){[_nghost-%COMP%]{min-width:320px}}"],changeDetection:0}),cU),zU=["copyField"],TU=((uU=function(){function e(t,n,i){m(this,e),this.dialogRef=t,this.data=n,this.clipboardService=i,this.settings={title:"Copy to Clipboard",copyText:""},this.settings=Object.assign(Object.assign({},this.settings),n)}return v(e,[{key:"rowCount",get:function(){return this.settings.copyText.split(/\r?\n/).length+1}},{key:"ngOnInit",value:function(){}},{key:"ngAfterViewInit",value:function(){var e=this.copyField.nativeElement;e.focus(),e.select()}},{key:"handleCopyClick",value:function(){var e=this.clipboardService.copyInputFieldValue(this.copyField.nativeElement);this.close(e)}},{key:"handleCancelClick",value:function(){this.close(!1)}},{key:"close",value:function(e){this.dialogRef.close(e)}}]),e}()).\u0275fac=function(e){return new(e||uU)(P.Pb(ug.g),P.Pb(ug.a),P.Pb(il))},uU.\u0275cmp=P.Jb({type:uU,selectors:[["app-clipboard-dialog"]],viewQuery:function(e,t){var n;1&e&&P.Gc(zU,!0),2&e&&P.uc(n=P.dc())&&(t.copyField=n.first)},decls:11,vars:3,consts:[["mat-dialog-title",""],["mat-dialog-content","",1,"copy"],[1,"copy__input",3,"value","rows"],["copyField",""],["mat-dialog-actions",""],["app-button","","buttonTheme","light",3,"click"],["app-button","","buttonType","primary",3,"click"]],template:function(e,t){1&e&&(P.Vb(0,"div",0),P.Mc(1),P.Ub(),P.Vb(2,"div",1),P.Vb(3,"textarea",2,3),P.Mc(5,"  "),P.Ub(),P.Ub(),P.Vb(6,"div",4),P.Vb(7,"button",5),P.cc("click",(function(){return t.handleCancelClick()})),P.Mc(8,"Cancel"),P.Ub(),P.Vb(9,"button",6),P.cc("click",(function(){return t.handleCopyClick()})),P.Mc(10,"Copy to Clipboard"),P.Ub(),P.Ub()),2&e&&(P.Db(1),P.Oc(" ",t.settings.title,"\n"),P.Db(2),P.lc("value",t.settings.copyText)("rows",t.rowCount))},directives:[ug.h,ug.e,ug.c,gl],styles:[".copy[_ngcontent-%COMP%]{min-width:480px;display:flex}.copy__input[_ngcontent-%COMP%]{flex:1}"],changeDetection:0}),uU),UU=((lU=function(){function e(t,n){m(this,e),this.dialog=t,this.engineService=n}return v(e,[{key:"isMobile",get:function(){return window.innerWidth<=959}},{key:"openClipboardDialog",value:function(e,t){var n=Object.assign({data:{id:Ig.ClipboardDialog,copyText:e}},t);return this.dialog.open(TU,n)}},{key:"openConfirmDialog",value:function(e){var t=Object.assign({id:Ig.ConfirmDialog},e);return this.dialog.open(IU,t)}},{key:"openLimitDialog",value:function(){return this.closeAllDialogs(),this.dialog.open(eU,{id:Ig.LimitDialog,width:"480px"})}},{key:"openUpgradeDialog",value:function(e){var t={width:925,height:700},n=Object.assign(Object.assign({id:Ig.UpgradeDialog},{width:t.width+"px",height:t.height+"px",data:{type:iU.UpgradeSubscription,dimensions:t}}),e);return this.closeAllDialogs(),U.native?(this.engineService.fireEvent(Dt.NativeUpgrade,null),Object(G.a)()):this.dialog.open(oU,n).afterClosed()}},{key:"openPremiumContentDialog",value:function(){var e=U.native||!this.isMobile;return this.openConfirmDialog({id:Ig.PremiumContentDialog,data:{titleText:"Premium Content",bodyText:e?"This is premium content. Upgrade to a Premium Plan for unlimited access.":"This is premium content. Visit us on desktop to upgrade to a premium plan.",confirmText:"Go Premium",confirmEnabled:e,cancelText:"OK",confirmColor:"warn"}})}},{key:"closeAllDialogs",value:function(){this.dialog.closeAll()}}]),e}()).\u0275fac=function(e){return new(e||lU)(P.Zb(ug.b),P.Zb(Nt))},lU.\u0275prov=P.Lb({token:lU,factory:lU.\u0275fac,providedIn:"root"}),lU),LU=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},DU=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},EU=((mU=function(){function e(t){m(this,e),this.dialogService=t}return v(e,[{key:"openLimit",value:function(e,t){this.dialogService.openLimitDialog().afterClosed().subscribe((function(t){e.dispatch(new Wz.CloseLimit(t))}))}},{key:"closeLimit",value:function(e,t){t.upgrade&&this.dialogService.openUpgradeDialog()}},{key:"openPremiumContent",value:function(e,t){this.dialogService.openPremiumContentDialog().afterClosed().subscribe((function(t){e.dispatch(new Wz.ClosePremiumContent(t))}))}},{key:"closePremiumContent",value:function(e,t){t.confirmed&&e.dispatch(new Wz.OpenUpgrade)}},{key:"openUpgrade",value:function(e,t){this.dialogService.openUpgradeDialog()}}],[{key:"getOpenDialog",value:function(e){return e.openDialog}}]),e}()).\u0275fac=function(e){return new(e||mU)(P.Zb(UU))},mU.\u0275prov=P.Lb({token:mU,factory:mU.\u0275fac}),LU([Object(E.a)(Wz.OpenLimit),DU("design:type",Function),DU("design:paramtypes",[Object,Wz.OpenLimit]),DU("design:returntype",void 0)],mU.prototype,"openLimit",null),LU([Object(E.a)(Wz.CloseLimit),DU("design:type",Function),DU("design:paramtypes",[Object,Wz.CloseLimit]),DU("design:returntype",void 0)],mU.prototype,"closeLimit",null),LU([Object(E.a)(Wz.OpenPremiumContent),DU("design:type",Function),DU("design:paramtypes",[Object,Wz.OpenPremiumContent]),DU("design:returntype",void 0)],mU.prototype,"openPremiumContent",null),LU([Object(E.a)(Wz.ClosePremiumContent),DU("design:type",Function),DU("design:paramtypes",[Object,Wz.ClosePremiumContent]),DU("design:returntype",void 0)],mU.prototype,"closePremiumContent",null),LU([Object(E.a)(Wz.OpenUpgrade),DU("design:type",Function),DU("design:paramtypes",[Object,Wz.OpenUpgrade]),DU("design:returntype",void 0)],mU.prototype,"openUpgrade",null),LU([Object(E.e)(),DU("design:type",Function),DU("design:paramtypes",[XT]),DU("design:returntype",void 0)],mU,"getOpenDialog",null),mU=LU([Object(E.f)({name:"dialog",defaults:{openDialog:null}})],mU)),FU=((vU=function e(){m(this,e)}).\u0275mod=P.Nb({type:vU}),vU.\u0275inj=P.Mb({factory:function(e){return new(e||vU)},imports:[[ra.c,tP,JP,eh.q]]}),vU),AU=((bU=function e(){m(this,e)}).\u0275mod=P.Nb({type:bU}),bU.\u0275inj=P.Mb({factory:function(e){return new(e||bU)},imports:[[ra.c,tP,JP,eh.q]]}),bU),RU=((fU=function e(){m(this,e)}).\u0275mod=P.Nb({type:fU}),fU.\u0275inj=P.Mb({factory:function(e){return new(e||fU)},imports:[[ra.c,tP,JP,eh.q]]}),fU),VU=((hU=function e(){m(this,e)}).\u0275mod=P.Nb({type:hU}),hU.\u0275inj=P.Mb({factory:function(e){return new(e||hU)},imports:[[ra.c,tP,JP]]}),hU),NU=((gU=function e(){m(this,e)}).\u0275mod=P.Nb({type:gU}),gU.\u0275inj=P.Mb({factory:function(e){return new(e||gU)},imports:[[ra.c,tP,eh.i,eh.q,JP]]}),gU),BU=((dU=function e(){m(this,e)}).\u0275mod=P.Nb({type:dU}),dU.\u0275inj=P.Mb({factory:function(e){return new(e||dU)},imports:[[ra.c,tP,JP,eh.q]]}),dU),HU=((pU=function e(){m(this,e)}).\u0275mod=P.Nb({type:pU}),pU.\u0275inj=P.Mb({factory:function(e){return new(e||pU)},imports:[[E.c.forFeature([EU]),RT,VT,NT,BT,HT,QT,qT,WT,$T,KT,GT,ZT,JT,FU,AU,RU,VU,NU,BU,KP,qP,JP],RT,VT,NT,BT,HT,QT,qT,WT,$T,KT,GT,ZT,JT,FU,AU,RU,VU,NU,BU]}),pU),QU=[],qU=((MU=function e(){m(this,e)}).\u0275mod=P.Nb({type:MU}),MU.\u0275inj=P.Mb({factory:function(e){return new(e||MU)},imports:[[Oe.f.forChild(QU)],Oe.f]}),MU),WU=((PU=function e(){m(this,e)}).\u0275mod=P.Nb({type:PU}),PU.\u0275inj=P.Mb({factory:function(e){return new(e||PU)},imports:[[ra.c]]}),PU),$U=((jU=function e(){m(this,e)}).\u0275mod=P.Nb({type:jU}),jU.\u0275inj=P.Mb({factory:function(e){return new(e||jU)},imports:[[ra.c,bP]]}),jU),KU=((_U=function e(){m(this,e)}).\u0275mod=P.Nb({type:_U}),_U.\u0275inj=P.Mb({factory:function(e){return new(e||_U)},imports:[[ra.c,tP,vP,jP,bP,MT,iP,eh.q,IT,HP]]}),_U),GU=((SU=function e(){m(this,e)}).\u0275mod=P.Nb({type:SU}),SU.\u0275inj=P.Mb({factory:function(e){return new(e||SU)},imports:[[E.c.forFeature([ku]),Dd.a.forChild(),Ce.d,ra.c,TT,qU,tP,eh.q,eh.i,vP,jP,bP,WP,$P,WU,MP,HP,PP,yf.b,cT,zT,MT,JP,$U,IT,KU]]}),SU),ZU=((CU=function(){function e(){m(this,e)}return v(e,[{key:"intercept",value:function(e,t){return t.handle(e).pipe(Object(Z.a)((function(e){return e instanceof K.e&&e.body&&e.body.hasOwnProperty("results")&&(e=e.clone({body:e.body.results})),e})))}}]),e}()).\u0275fac=function(e){return new(e||CU)},CU.\u0275prov=P.Lb({token:CU,factory:CU.\u0275fac}),CU),JU=((OU=function e(){m(this,e)}).\u0275mod=P.Nb({type:OU}),OU.\u0275inj=P.Mb({factory:function(e){return new(e||OU)},providers:[n_],imports:[[E.c.forFeature([he]),ra.c,JP]]}),OU),XU=((wU=function e(){m(this,e)}).\u0275mod=P.Nb({type:wU}),wU.\u0275inj=P.Mb({factory:function(e){return new(e||wU)},imports:[[ra.c,Oe.f,vP,jP,bP]]}),wU),YU=((kU=function(){function e(){m(this,e)}return v(e,[{key:"parse",value:function(e){e=e.replace(/&amp;/g,"&");var t=(new Oe.b).parse(e);return this.ensureQueryParam(t.queryParams,"dk",e),this.ensureQueryParam(t.queryParams,"uaid",e),t}},{key:"serialize",value:function(e){return(new Oe.b).serialize(e).replace(/%2F/g,"/")}},{key:"ensureQueryParam",value:function(e,t,n){if(e.hasOwnProperty(t))return e;var i=this.getParameterByName(t,n);return null!==i&&(e[t]=i),e}},{key:"getParameterByName",value:function(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null}}]),e}()).\u0275fac=function(e){return new(e||kU)},kU.\u0275prov=P.Lb({token:kU,factory:kU.\u0275fac}),kU),eL=((xU=function e(){m(this,e)}).\u0275mod=P.Nb({type:xU}),xU.\u0275inj=P.Mb({factory:function(e){return new(e||xU)},imports:[[E.c.forFeature([Wu]),ra.c]]}),xU),tL=((yU=function e(){m(this,e)}).\u0275mod=P.Nb({type:yU}),yU.\u0275inj=P.Mb({factory:function(e){return new(e||yU)},imports:[[E.c.forFeature([rx]),ra.c]]}),yU),nL=h("OnMO");function iL(){var e=new nL.Renderer;return e.link=function(e,t,n){var i;return'<a href="'.concat((i=e).match(/^(?:(?:(?:ht)tps?):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i)?i:"",'" target="_blank" rel="noreferrer nofollow">').concat(n,"</a>")},e.paragraph=function(e){return"<p>".concat(e,"</p>")},e.image=function(e,t,n){return""},{renderer:e,gfm:!1}}var oL,rL,aL=((rL=function e(){m(this,e)}).\u0275mod=P.Nb({type:rL}),rL.\u0275inj=P.Mb({factory:function(e){return new(e||rL)},imports:[[ra.c,Dd.a.forRoot({markedOptions:{provide:Dd.d,useFactory:iL}})]]}),rL),sL=((oL=function(){function e(){m(this,e)}return v(e,null,[{key:"forRoot",value:function(t){return{ngModule:e,providers:[je,{provide:"pendoConfig",useValue:t}]}}}]),e}()).\u0275mod=P.Nb({type:oL}),oL.\u0275inj=P.Mb({factory:function(e){return new(e||oL)},imports:[[]]}),oL);immer.enableAllPlugins(),immer.enableES5();var cL,lL,uL=[{provide:K.a,useClass:ZU,multi:!0},{provide:Oe.h,useClass:YU},{provide:ra.a,useValue:"./"},{provide:ra.h,useClass:ra.e}],pL=[{provide:K.a,useClass:ZU,multi:!0},{provide:Oe.h,useClass:YU}],dL=((lL=function e(){m(this,e)}).\u0275mod=P.Nb({type:lL,bootstrap:[df]}),lL.\u0275inj=P.Mb({factory:function(e){return new(e||lL)},providers:!0===U.offline?uL:pL,imports:[[E.c.forRoot(),eL,Sa.forRoot(),Ce.d.forRoot(U.googleAnalyticsId),sL.forRoot({enabled:!0,pendoId:U.pendoId,whitelist:u({},M.Viewer,U.deploy===z.Production?["48Ab","3FZO","3FN2","3Hb8","3FQJ","3FQU","38fD","3wgE","3gLk","3vSx","3XdS","3SOp","3Um8","3hOe","3QWH","4C1Q","3WvE","3epq","3Dyq","3O47","3DJ4","3fKF","3gLf","3PVx","3caY","3cTn","3tVK","3Yau","3QSx","3ZY5","3Z6w","3IF5","3fKs","45y8","3fLN","3QpZ","3J6C","3adO","3Z6v","3hjc","3a50","4EBE","44FH","3WlU","3atu","4E2N","4Bma","43bE","3xxi","3CT7","4D5X","3UVi","3T7X","3QT8","3NG8","3gyj","3UWt","3UWc"]:["production/maleAdult/coronavirus_protein_structure","production/maleAdult/eyeAnatomyTour","production/maleAdult/acute_lymphoblastic_leukemia","production/maleAdult/abdominal_aortic_aneurysm"]),idPrefixes:(cL={},u(cL,z.Local,"local-"),u(cL,z.QA,"qa-"),u(cL,z.Staging,"staging-"),u(cL,z.Production,""),cL)}),aL,L.a,D.b,K.c,TT,cT,jT,AT,zT,tL,HU,GU,XU,JU,Bj]]}),lL);U.production&&Object(P.V)(),L.d().bootstrapModule(dL).catch((function(e){return console.error(e)}))},qpAl:function(e,t){!function(t){var n="Modernizr"in t,i=t.Modernizr;!function(e,t,n,i){function o(e,t){return typeof e===t}function r(e,t){return!!~(""+e).indexOf(t)}function a(){return"function"!=typeof n.createElement?n.createElement(arguments[0]):y?n.createElementNS.call(n,"http://www.w3.org/2000/svg",arguments[0]):n.createElement.apply(n,arguments)}function s(e,t,i,o){var r,s,c,l,u="modernizr",p=a("div"),d=function(){var e=n.body;return e||((e=a(y?"svg":"body")).fake=!0),e}();if(parseInt(i,10))for(;i--;)(c=a("div")).id=o?o[i]:u+(i+1),p.appendChild(c);return(r=a("style")).type="text/css",r.id="s"+u,(d.fake?d:p).appendChild(r),d.appendChild(p),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(n.createTextNode(e)),p.id=u,d.fake&&(d.style.background="",d.style.overflow="hidden",l=m.style.overflow,m.style.overflow="hidden",m.appendChild(d)),s=t(p,e),d.fake&&d.parentNode?(d.parentNode.removeChild(d),m.style.overflow=l):p.parentNode.removeChild(p),!!s}function c(e){return e.replace(/([A-Z])/g,(function(e,t){return"-"+t.toLowerCase()})).replace(/^ms-/,"-ms-")}function l(e,n){var o=e.length;if("CSS"in t&&"supports"in t.CSS){for(;o--;)if(t.CSS.supports(c(e[o]),n))return!0;return!1}if("CSSSupportsRule"in t){for(var r=[];o--;)r.push("("+c(e[o])+":"+n+")");return s("@supports ("+(r=r.join(" or "))+") { #modernizr { position: absolute; } }",(function(e){return"absolute"===function(e,n,i){var o;if("getComputedStyle"in t){o=getComputedStyle.call(t,e,null);var r=t.console;null!==o?o=o.getPropertyValue(i):r&&r[r.error?"error":"log"].call(r,"getComputedStyle returning null, its possible modernizr test results are inaccurate")}else o=e.currentStyle&&e.currentStyle[i];return o}(e,0,"position")}))}return i}function u(e){return e.replace(/([a-z])-([a-z])/g,(function(e,t,n){return t+n.toUpperCase()})).replace(/^-/,"")}function p(e,t,n,s){function c(){d&&(delete O.style,delete O.modElem)}if(s=!o(s,"undefined")&&s,!o(n,"undefined")){var p=l(e,n);if(!o(p,"undefined"))return p}for(var d,g,h,f,b,v=["modernizr","tspan","samp"];!O.style&&v.length;)d=!0,O.modElem=a(v.shift()),O.style=O.modElem.style;for(h=e.length,g=0;g<h;g++)if(b=O.style[f=e[g]],r(f,"-")&&(f=u(f)),O.style[f]!==i){if(s||o(n,"undefined"))return c(),"pfx"!==t||f;try{O.style[f]=n}catch(e){}if(O.style[f]!==b)return c(),"pfx"!==t||f}return c(),!1}function d(e,t){return function(){return e.apply(t,arguments)}}function g(e,t,n,i,r){var a=e.charAt(0).toUpperCase()+e.slice(1),s=(e+" "+k.join(a+" ")+a).split(" ");return o(t,"string")||o(t,"undefined")?p(s,t,i,r):function(e,t,n){var i;for(var r in e)if(e[r]in t)return!1===n?e[r]:o(i=t[e[r]],"function")?d(i,n||t):i;return!1}(s=(e+" "+C.join(a+" ")+a).split(" "),t,n)}var h=[],f={_version:"3.11.6",_config:{classPrefix:"",enableClasses:!0,enableJSClass:!0,usePrefixes:!0},_q:[],on:function(e,t){var n=this;setTimeout((function(){t(n[e])}),0)},addTest:function(e,t,n){h.push({name:e,fn:t,options:n})},addAsyncTest:function(e){h.push({name:null,fn:e})}},b=function(){};b.prototype=f,b=new b;var v=[],m=n.documentElement,y="svg"===m.nodeName.toLowerCase(),x="Moz O ms Webkit",k=f._config.usePrefixes?x.split(" "):[];f._cssomPrefixes=k;var w={elem:a("modernizr")};b._q.push((function(){delete w.elem}));var O={style:w.elem.style};b._q.unshift((function(){delete O.style}));var C=f._config.usePrefixes?x.toLowerCase().split(" "):[];f._domPrefixes=C,f.testAllProps=g;var S=function(e){var n,o=prefixes.length,r=t.CSSRule;if(void 0===r)return i;if(!e)return!1;if((n=(e=e.replace(/^@/,"")).replace(/-/g,"_").toUpperCase()+"_RULE")in r)return"@"+e;for(var a=0;a<o;a++){var s=prefixes[a];if(s.toUpperCase()+"_"+n in r)return"@-"+s.toLowerCase()+"-"+e}return!1};f.atRule=S;var _=f.prefixed=function(e,t,n){return 0===e.indexOf("@")?S(e):(-1!==e.indexOf("-")&&(e=u(e)),t?g(e,t,n):g(e,"pfx"))};b.addTest("fullscreen",!(!_("exitFullscreen",n,!1)&&!_("cancelFullScreen",n,!1))),function(){var e,t,n,i,r,a;for(var s in h)if(h.hasOwnProperty(s)){if(e=[],(t=h[s]).name&&(e.push(t.name.toLowerCase()),t.options&&t.options.aliases&&t.options.aliases.length))for(n=0;n<t.options.aliases.length;n++)e.push(t.options.aliases[n].toLowerCase());for(i=o(t.fn,"function")?t.fn():t.fn,r=0;r<e.length;r++)1===(a=e[r].split(".")).length?b[a[0]]=i:(b[a[0]]&&(!b[a[0]]||b[a[0]]instanceof Boolean)||(b[a[0]]=new Boolean(b[a[0]])),b[a[0]][a[1]]=i),v.push((i?"":"no-")+a.join("-"))}}(),function(e){var t=m.className,n=b._config.classPrefix||"";if(y&&(t=t.baseVal),b._config.enableJSClass){var i=new RegExp("(^|\\s)"+n+"no-js(\\s|$)");t=t.replace(i,"$1"+n+"js$2")}b._config.enableClasses&&(e.length>0&&(t+=" "+n+e.join(" "+n)),y?m.className.baseVal=t:m.className=t)}(v),delete f.addTest,delete f.addAsyncTest;for(var j=0;j<b._q.length;j++)b._q[j]();e.Modernizr=b}(t,t,document),e.exports=t.Modernizr,n?t.Modernizr=i:delete t.Modernizr}(window)},zn8P:function(e,t){function n(e){return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}))}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id="zn8P"}},[[0,0,5]]])}();