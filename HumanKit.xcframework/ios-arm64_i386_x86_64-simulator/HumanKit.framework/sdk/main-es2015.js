(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{0:function(e,t,n){e.exports=n("dwNn")},1:function(e,t){},dwNn:function(e,t,n){"use strict";n.r(t);var i=n("fXoL"),o=function(e){return e.Loft="loft",e.Studio="studio",e.Viewer="viewer",e.All="",e}({}),s=function(e){return e.Bookmark="bookmark",e.Module="module",e.Internal="internal",e}({}),r=function(e){return e.Local="Local",e.QA="QA",e.Staging="Staging",e.Production="Production",e}({}),a=function(e){return e.Web="web",e.SDK="sdk",e}({});const c={production:!0,assetDomain:"assets-human.biodigital.com",supportEmail:"support@biodigital.com",googleAuthKey:"66261904577-061oin26uo7sor0vrqc8dnn105irq82n.apps.googleusercontent.com",facebookAuthKey:"218801781466301",facebookPixelId:"973525219844030",googleAnalyticsId:"UA-1141985-29",linkedinId:"2641938",pendoId:"3a783681-e53b-4ebd-69c0-788bbae48f13",rollbarToken:"dd70f513aa0740668070fa3fd62b33a0",recaptchaKey:"6LdvZvcUAAAAAM0Z1St9WQXwvSYd__hMUY2WZ6um",application:o.Viewer,deploy:r.Production,platform:a.SDK,exportType:s.Bookmark,offline:!1,native:!1,minPasswordLength:8};var l=n("jhN1"),p=n("R1ws"),d=n("AcyG");class u{}let g=(()=>{class e{constructor(e,t,n){this.hostingURL=e,this.embedded=t,this.widgetConfig=n}}return e.type="[Widget] Setup Widget",e})(),h=(()=>{class e{constructor(e,t){this.interaction=e,this.source=t}}return e.type="[Widget] Log Interaction",e})(),b=(()=>{class e{constructor(e,t){this.interaction=e,this.response=t}}return e.type="[Widget] Log Interaction Success",e})(),m=(()=>{class e{constructor(e,t){this.interaction=e,this.response=t}}return e.type="[Widget] Log Interaction Failure",e})(),f=(()=>{class e{constructor(){}}return e.type="[Widget] Auth",e})(),y=(()=>{class e{constructor(e,t){this.userType=e,this.response=t}}return e.type="[Widget] Auth Success",e})(),x=(()=>{class e{constructor(e,t){this.userType=e,this.response=t}}return e.type="[Widget] Auth Failure",e})(),v=(()=>{class e{constructor(){}}return e.type="[Widget] Reset",e})(),w=(()=>{class e{constructor(e){this.enabled=e}}return e.type="[Widget] Set Input Enabled",e})(),O=(()=>{class e{constructor(e){this.config=e}}return e.type="[Widget] Set API Config",e})();var C=n("tk/3"),S=n("LRne"),k=n("lJxs"),_=n("JIr8"),j=function(e){return e.InvalidUAID="analytic id does not exist",e.InvalidDeveloperId="Client id invalid",e.InvalidProductKey="app product key",e.MissingUAID="analytic id missing",e.WebOnlyAPI="Api key only compatible with Web Widget",e.AndroidOnlyAPI="Api key only compatible with Mobile Widget SDK for Android",e.IOSOnlyAPI="Api key only compatible with Mobile Widget SDK for iOS",e.MixedAPIKeys="Use of both an app product key and an app api key not allowed",e.ProductKeyNotRegistered='App product key "xxx" has not been registered or is incorrect.  Ensure it has been registered by the system admin',e.ProductKeyInvalidAppBundleID='The app product key "xxx" has not been authorized to be used for app bundle id "yyy".  Confirm the correct values are being used from the system admin',e.ProductKeyBundleIDWhitelist='Use of app product key "xxx" requires the affiliated app bundle id (app_domain) to be white-listed.  Ensure the system admin has white-listed "yyy"',e.ImproperProductKeyUsage='Improper use of app product key "xxx" detected. Contact the system admin if issue continues',e.InvalidPlatformSource="Invalid platform source",e.MissingSource="Missing source",e.MissingPlatform="Missing platform",e.MissingAppDomain="Missing app domain",e.APIKeyMissing="Api key missing",e.APIKeyInvalid="Api key invalid",e.DeveloperDeactivated="Developer account for api key is deactivated",e.BundleIDNotAllowed="App bundle id not allowed",e.BundleIDUnregistered="App bundle id unregistered",e}({});class P{}class M{}var I=n("b36G"),z=function(e){return e.Widget="widget",e.WidgetAPI="widgetapi",e}({}),T=n("Qyje");const U={headers:new C.d({"Content-Type":"application/json; charset=utf-8"})};let L=(()=>{class e{constructor(e){this.http=e}getAnalytic(e){return c.offline?(fetch("https://human.biodigital.com/ws/user/analytics?analytic_id="+e,{method:"GET",mode:"no-cors"}),Object(S.a)({success:!0})):this.http.get("/ws/user/analytics?analytic_id="+e).pipe(Object(k.a)(()=>({success:!0})),Object(_.a)(e=>Object(S.a)(this.parseError(e))))}sendAnalytic(e){if(c.offline){const t=e instanceof M?"https://human.biodigital.com/ws/user/analytics":"https://human.biodigital.com/ws/developer/apps/access/key",n=JSON.parse(JSON.stringify(e)),i=Object(T.stringify)(n);return fetch(t,{headers:{"Content-Type":"application/x-www-form-urlencoded"},method:"POST",mode:"no-cors",body:i}),Object(S.a)({success:!0})}return this.http.post(e instanceof M?"/ws/user/analytics":"/ws/developer/apps/access/key",e,U).pipe(Object(k.a)(()=>({success:!0})),Object(_.a)(e=>Object(S.a)(this.parseError(e))))}buildDeveloperAnalytic(e,t,n=z.Widget,i){const{widgetUrlConfig:o,parentUrl:s,embedded:r}=e,a={platform:n,app_activity:t,app_productkey:o["app-productkey"],app_userid:o["app-userid"],app_apikey:o.dk,app_domain:s.full,app_activity_data:i,widget_is_fullscreen:!r};return Object(I.plainToClass)(P,a)}parseError(e){if(c.offline)return{success:!0,message:"",errorCode:null};const t=e.error.error,n=e.status,i=t&&t.message?t.message:"";return{success:n>=500&&n<=504,message:i,errorCode:Object.values(j).includes(i)?i:null}}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(C.b))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),D=(()=>{class e{constructor(e){this.analyticsService=e}authDeveloper(e){return this.analyticsService.sendAnalytic(e)}authUser(e){return this.analyticsService.getAnalytic(e)}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(L))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var E=n("nYR2");class F{}var A=function(e){return e[e.User=0]="User",e[e.Developer=1]="Developer",e}({}),R=function(e){return e.Init="init",e.View="view",e.ChanceInteraction="interactionc",e.FirstInteraction="interactionf",e.Call="call",e}({}),N=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},V=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const H={userType:A.User,authenticating:!1,authenticated:!1,widgetUrlConfig:{id:"",type:""},widgetApiConfig:null,parentUrl:{full:"",domain:""},embedded:!1,engineVersion:"",engineAPIVersion:"",inputEnabled:!0};let B=(()=>{let e=class{constructor(e,t){this.authService=e,this.analyticsService=t}static getWidgetState(e){return e}static getUserType(e){return e.userType}static getWidgetAuthenticating(e){return e.authenticating}static getWidgetAuthenticated(e){return e.authenticated}static getInputEnabled(e){return e.inputEnabled}static getEmbedded(e){return e.embedded}static getParentURL(e){return e.parentUrl.full}static getWidgetUrlConfig(e){return e.widgetUrlConfig}static getWidgetApiUIConfig(e){return e.widgetApiConfig}setupWidget(e,{hostingURL:t,embedded:n,widgetConfig:i}){const o=t.match(/:\/\/(.[^/]+)/);e.patchState({userType:i.uaid?A.User:A.Developer,embedded:n,widgetUrlConfig:i,parentUrl:{full:t,domain:o&&o[1]?o[1]:t}})}authWidget(e,t){const n=e.getState(),{userType:i,widgetUrlConfig:o}=n,s=i===A.User?this.authService.authUser(o.uaid):this.authService.authDeveloper(this.analyticsService.buildDeveloperAnalytic(n,R.Init,z.WidgetAPI,this.buildAppActivityData(n)));e.patchState({authenticating:!0}),s.pipe(Object(E.a)(()=>e.patchState({authenticating:!1}))).subscribe(t=>{const n=t.success;e.patchState({authenticated:n}),e.dispatch(n?new y(i,t):new x(i,t))})}logWidgetInteraction(e,{interaction:t,source:n}){const i=e.getState(),o=i.userType===A.User?this.buildUserAnalytic(i,t,n):this.analyticsService.buildDeveloperAnalytic(i,t,z.Widget,this.buildAppActivityData(i));this.analyticsService.sendAnalytic(o).subscribe(n=>{e.dispatch(n.success?new b(t,n):new m(t,n))})}resetWidget(e,t){e.setState(H)}buildAppActivityData(e){const{engineVersion:t,engineAPIVersion:n,widgetUrlConfig:i}=e,o={engine_version:t,api_version:n};return Object.entries(i).filter(([e])=>"dk"!==e).forEach(([e,t])=>{o["url_param_"+e]=t}),Object(I.plainToClass)(F,o)}setInputEnabled(e,t){e.patchState({inputEnabled:t.enabled})}setWidgetApiConfig(e,t){e.patchState({widgetApiConfig:t.config})}buildUserAnalytic(e,t,n){const{widgetUrlConfig:i,parentUrl:o}=e,s=i.uaid,r=o.domain,a=Object.assign(Object.assign({},this.buildAppActivityData(e)),{parent_analytic_identifier:s,referer_domain:r,[t+"_source"]:n}),c={analytic_platform:z.Widget,analytic_type:t,analytic_data:a};return Object(I.plainToClass)(M,c)}ngxsOnInit(e){e.patchState({engineVersion:Human.VERSION,engineAPIVersion:Human.API_VERSION})}};return e.\u0275fac=function(t){return new(t||e)(i.Zb(D),i.Zb(L))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac}),N([Object(d.a)(g),V("design:type",Function),V("design:paramtypes",[Object,g]),V("design:returntype",void 0)],e.prototype,"setupWidget",null),N([Object(d.a)(f),V("design:type",Function),V("design:paramtypes",[Object,f]),V("design:returntype",void 0)],e.prototype,"authWidget",null),N([Object(d.a)(h),V("design:type",Function),V("design:paramtypes",[Object,h]),V("design:returntype",void 0)],e.prototype,"logWidgetInteraction",null),N([Object(d.a)(v),V("design:type",Function),V("design:paramtypes",[Object,v]),V("design:returntype",void 0)],e.prototype,"resetWidget",null),N([Object(d.a)(w),V("design:type",Function),V("design:paramtypes",[Object,w]),V("design:returntype",void 0)],e.prototype,"setInputEnabled",null),N([Object(d.a)(O),V("design:type",Function),V("design:paramtypes",[Object,O]),V("design:returntype",void 0)],e.prototype,"setWidgetApiConfig",null),N([Object(d.e)(),V("design:type",Function),V("design:paramtypes",[u]),V("design:returntype",void 0)],e,"getWidgetState",null),N([Object(d.e)(),V("design:type",Function),V("design:paramtypes",[u]),V("design:returntype",void 0)],e,"getUserType",null),N([Object(d.e)(),V("design:type",Function),V("design:paramtypes",[u]),V("design:returntype",void 0)],e,"getWidgetAuthenticating",null),N([Object(d.e)(),V("design:type",Function),V("design:paramtypes",[u]),V("design:returntype",void 0)],e,"getWidgetAuthenticated",null),N([Object(d.e)(),V("design:type",Function),V("design:paramtypes",[u]),V("design:returntype",void 0)],e,"getInputEnabled",null),N([Object(d.e)(),V("design:type",Function),V("design:paramtypes",[u]),V("design:returntype",void 0)],e,"getEmbedded",null),N([Object(d.e)(),V("design:type",Function),V("design:paramtypes",[u]),V("design:returntype",void 0)],e,"getParentURL",null),N([Object(d.e)(),V("design:type",Function),V("design:paramtypes",[u]),V("design:returntype",void 0)],e,"getWidgetUrlConfig",null),N([Object(d.e)(),V("design:type",Function),V("design:paramtypes",[u]),V("design:returntype",void 0)],e,"getWidgetApiUIConfig",null),e=N([Object(d.f)({name:"widget",defaults:H})],e),e})();var Q,$=n("XNiG"),q=n("HDdC"),W=n("1G5W"),K=n("pLZG"),G=function(e){return e[e.Basics=0]="Basics",e[e.All=1]="All",e[e.Shortcuts=2]="Shortcuts",e}({});!function(e){class t{constructor(e){this.canHover=e}}t.type="[View] Set Can Hover",e.SetCanHover=t;class n{constructor(e){this.canTouch=e}}n.type="[View] Set Can Touch",e.SetCanTouch=n;class i{constructor(e){this.canFullscreen=e}}i.type="[View] Set Can Fullscreen",e.SetCanFullscreen=i;class o{constructor(e){this.ui=e}}o.type="[View] Set UI",e.SetUI=o;class s{constructor(e){this.ui=e}}s.type="[View] Set Initial UI",e.SetInitialUI=s;class r{constructor(e){this.enabled=e}}r.type="[View] Set Input Enabled",e.SetInputEnabled=r;class a{constructor(e){this.mode=e}}a.type="[View] Set Search Display Mode",e.SetSearchDisplayMode=a;class c{constructor(e){this.active=e}}c.type="[View] Toggle Presentation",e.TogglePresentation=c;class l{constructor(e){this.interactType=e}}l.type="[View] Set Interact Type",e.SetInteractType=l;class p{constructor(e){this.onDemand=e}}p.type="[View] Set On Demand",e.SetOnDemand=p;class d{constructor(e){this.layout=e}}d.type="[View] Set Layout",e.SetLayout=d;class u{constructor(e=G.Basics){this.tab=e}}u.type="[View] Toggle Help Tab",e.ToggleHelpTab=u;class g{constructor(e){this.inputMode=e}}g.type="[View] Set Input Mode",e.SetInputMode=g;class h{constructor(e){this.tutorial=e}}h.type="[View] Set Tutorial",e.SetTutorial=h;class b{constructor(e){this.intro=e}}b.type="[View] Start Tutorial",e.StartTutorial=b;class m{constructor(e){this.seen=e}}m.type="[View] Tutorial Seen",e.TutorialSeen=m;class f{constructor(){}}f.type="[View] Tutorial Next",e.TutorialNext=f;class y{constructor(){}}y.type="[View] Tutorial Previous",e.TutorialPrevious=y;class x{constructor(e){this.show=e}}x.type="[View] Toggle Node Info",e.ToggleNodeInfo=x;class v{constructor(e){this.enabled=e}}v.type="[View] Set multi pick mode enabled",e.SetMultiPickModeEnabled=v;class w{constructor(e){this.labelsBreakpoint=e}}w.type="[View] Set Label Breakpoint",e.SetLabelBreakpoint=w;class O{constructor(e){this.usePrintImage=e}}O.type="[View] Set Use Print Image",e.SetUsePrintImage=O;class C{constructor(e){this.windows=e}}C.type="[View] Set Windows",e.SetWindows=C;class S{constructor(e){this.window=e}}S.type="[View] Open Window",e.OpenWindow=S;class k{constructor(e){this.window=e}}k.type="[View] Close Window",e.CloseWindow=k;class _{constructor(e,t){this.window=e,this.show=t}}_.type="[View] Toggle Window",e.ToggleWindow=_;class j{constructor(e){this.open=e}}j.type="[View] Toggle Menu",e.ToggleMenu=j;class P{constructor(e){this.enabled=e}}P.type="[View] Whiteboard Enabled",e.SetWhiteboardEnabled=P;class M{constructor(e){this.brushSize=e}}M.type="[View] Whiteboard Brush Size",e.SetWhiteboardBrushSize=M;class I{constructor(e){this.brushColor=e}}I.type="[View] Whiteboard Brush Color",e.SetWhiteboardBrushColor=I;class z{constructor(e){this.size=e}}z.type="[View] Whiteboard Text Size",e.SetWhiteboardTextSize=z;class T{constructor(e){this.eraserSize=e}}T.type="[View] Whiteboard Eraser Size",e.SetWhiteboardEraserSize=T;class U{constructor(e){this.mode=e}}U.type="[View] Whiteboard Annotate Mode",e.SetWhiteboardAnnotateMode=U;class L{constructor(e){this.hasPaint=e}}L.type="[View] Whiteboard Has Paint",e.SetWhiteboardHasPaint=L;class D{constructor(e){this.hasText=e}}D.type="[View] Whiteboard Has Text",e.SetWhiteboardHasText=D}(Q||(Q={}));var Z=n("tyNb"),J=(n("mNvP"),n("m+po"),n("Wdmj")),X=n("LvDl"),Y=function(e){return e.DiscoveredChapterNav="Discovered Chapter Nav",e}({});let ee=(()=>{class e{constructor(e,t){this.config=e,this.router=t,this.appended=!1,this.sessionEvents={},this.pageEvents={},this.initRouteListener()}appendScript(){if(!this.config.enabled||this.appended)return;const e=`\n      (function(apiKey){\n        (function(p,e,n,d,o){var v,w,x,y,z;o=p[d]=p[d]||{};o._q=o._q||[];\n        v=['initialize','identify','updateOptions','pageLoad','track'];for(w=0,x=v.length;w<x;++w)(function(m){\n            o[m]=o[m]||function(){o._q[m===v[0]?'unshift':'push']([m].concat([].slice.call(arguments,0)));};})(v[w]);\n            y=e.createElement(n);y.async=!0;y.src='https://cdn.pendo.io/agent/static/'+apiKey+'/pendo.js';\n            z=e.getElementsByTagName(n)[0];z.parentNode.insertBefore(y,z);})(window,document,'script','pendo');\n      })('${this.config.pendoId}');\n    `,t=document.createElement("script");t.textContent=e,document.body.appendChild(t),this.appended=!0}initialize(e){var t;const n=Object.assign({},e);if(!this.pendoEnabled())return;const i=Object(X.get)(this.config,`idPrefixes[${c.deploy}]`,"");n.visitor.id=`${i}${n.visitor.id}`,n.account.id=`${i}${null!==(t=n.account.id)&&void 0!==t?t:999999999}`,pendo.initialize(e)}track(e,t){this.pendoEnabled()&&pendo.track(e,t)}trackOncePerSession(e,t){this.sessionEvents[e]||this.pendoEnabled()&&(this.track(e,t),this.sessionEvents[e]=!0)}trackOncePerPage(e,t){this.pageEvents[e]||this.pendoEnabled()&&(this.track(e,t),this.pageEvents[e]=!0)}initRouteListener(){this.router.events.pipe(Object(K.a)(e=>e instanceof Z.c)).subscribe(()=>{this.pageEvents={}})}pendoEnabled(){if(!this.config.enabled)return!1;const e=Object(X.get)(this.config,`whitelist[${c.application}]`,null);if(!Object(X.isNil)(e)){const t=new URLSearchParams(window.location.search),n=t.get("id")||t.get("be")||t.get("m");return e.includes(n)}return!0}}return e.\u0275fac=function(t){return new(t||e)(i.Zb("pendoConfig"),i.Zb(Z.e))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),te=(()=>{class e{constructor(){}}return e.type="[Engine] Load",e})(),ne=(()=>{class e{constructor(e){this.result=e}}return e.type="[Engine] Load Success",e})(),ie=(()=>{class e{constructor(e){this.ready=e}}return e.type="[Engine] Set Ready",e})(),oe=(()=>{class e{constructor(e){this.display=e}}return e.type="[Engine] Set Display of 3D Scene",e})(),se=(()=>{class e{constructor(e){this.scrollMode=e}}return e.type="[Engine] Set Zoom via scroll Allowed",e})(),re=(()=>{class e{constructor(e){this.shown=e}}return e.type="[Engine] Set Scroll Alert Shwon",e})(),ae=(()=>{class e{constructor(e){this.visible=e}}return e.type="[Engine] Set Visibility of 3D Scene",e})(),ce=(()=>{class e{constructor(e,t){this.color=e,this.duration=t}}return e.type="[Engine] Fade",e})(),le=(()=>{class e{constructor(){}}return e.type="[Engine] Fade Complete",e})(),pe=(()=>{class e{constructor(e){this.graph=e}}return e.type="[Engine] Set Graph",e})(),de=(()=>{class e{constructor(){}}return e.type="[Engine] Clear Graph",e})(),ue=(()=>{class e{constructor(e){this.enabled=e}}return e.type="[Engine] Set Xray Mode",e})(),ge=(()=>{class e{constructor(e){this.chapterId=e}}return e.type="[Engine] Set Engine Chapter",e})(),he=(()=>{class e{constructor(e){this.chapterInit=e}}return e.type="[Eninge] Set Chapter Init",e})(),be=(()=>{class e{constructor(e,t,n){this.node=e,this.event=t,this.hit=n}}return e.type="[Engine] Click Node",e})(),me=(()=>{class e{constructor(e,t){this.node=e,this.hit=t}}return e.type="[Engine] Set Contextmenu",e})(),fe=(()=>{class e{constructor(e,t=!0,n){this.objectId=e,this.animate=t,this.animationDuration=n}}return e.type="[Engine] Fly To Object",e})(),ye=(()=>{class e{constructor(){}}return e.type="[Engine] Center Camera on Visible Nodes",e})(),xe=(()=>{class e{constructor(e,t){this.leafVisibilityState=e,this.nodes=t}}return e.type="[Engine] Synchronize Visible Nodes On Tree",e})(),ve=(()=>{class e{constructor(e){this.leafRenderableState=e}}return e.type="[Engine] Synchronize Renderable State of Nodes On Tree",e})(),we=(()=>{class e{constructor(e,t){this.leafPickableState=e,this.nodes=t}}return e.type="[Engine] Synchronize Pickable State of Nodes On Tree",e})(),Oe=(()=>{class e{constructor(e){this.show=e}}return e.type="[Engine] Toggle Camera Bar",e})(),Ce=(()=>{class e{constructor(e){this.show=e}}return e.type="[Engine] Toggle Progress Bar",e})(),Se=(()=>{class e{constructor(e){this.show=e}}return e.type="[Engine] Toggle Labels",e})(),ke=(()=>{class e{constructor(e){this.tool=e}}return e.type="[Engine] Set active tool",e})(),_e=(()=>{class e{constructor(e,t){this.chapter=e,this.pause=t}}return e.type="[Engine] Play chapter animation",e})(),je=(()=>{class e{constructor(e=!0){this.play=e}}return e.type="[Engine] Play animation",e})(),Pe=(()=>{class e{constructor(e){this.playing=e}}return e.type="[Engine] Set animation playing",e})(),Me=(()=>{class e{constructor(e){this.speed=e}}return e.type="[Engine] Set playback speed",e})(),Ie=(()=>{class e{constructor(e){this.play=e}}return e.type="[Engine] Play audio",e})(),ze=(()=>{class e{constructor(){}}return e.type="[Engine] Play chapter from start",e})(),Te=(()=>{class e{constructor(e){this.enable=e}}return e.type="[Engine] Set autoplay",e})(),Ue=(()=>{class e{constructor(e,t){this.nodes=e,this.layer=t}}return e.type="[Engine] Set object layer order",e})(),Le=(()=>{class e{constructor(e,t){this.nodeId=e,this.displayName=t}}return e.type="[Engine] Set object display name",e})(),De=(()=>{class e{constructor(){}}return e.type="[Engine] Auto Sort object layer orders",e})(),Ee=(()=>{class e{constructor(){}}return e.type="[Engine] Reset object layer orders",e})(),Fe=(()=>{class e{constructor(e){this.position=e}}return e.type="[Engine] Set Engine Position",e})(),Ae=(()=>{class e{constructor(){}}return e.type="[Engine] Reset Engine Position",e})(),Re=(()=>{class e{constructor(e){this.effects=e}}return e.type="[Engine] Set Post Processing Effects",e})(),Ne=(()=>{class e{constructor(e){this.properties=e}}return e.type="[Engine] Set Properties",e})(),Ve=(()=>{class e{constructor(e){this.mode=e}}return e.type="[Engine] Set Transparency Mode",e})(),He=(()=>{class e{constructor(e){this.node=e}}return e.type="[Engine] Expand ViewTree Node",e})(),Be=(()=>{class e{constructor(e){this.node=e}}return e.type="[Engine] Collapse ViewTree Node",e})(),Qe=(()=>{class e{constructor(e,t){this.node=e,this.hit=t}}return e.type="[Engine] Hover Node",e})(),$e=(()=>{class e{constructor(e){this.node=e}}return e.type="[Engine] Set Label Edit Node",e})(),qe=(()=>{class e{constructor(e,t){this.node=e,this.description=t}}return e.type="[Engine] Set Node Info",e})(),We=(()=>{class e{constructor(e){this.node=e}}return e.type="[Engine] Query Node Info",e})(),Ke=(()=>{class e{constructor(e,t){this.node=e,this.description=t}}return e.type="[Engine] Query Node Info Success",e})(),Ge=(()=>{class e{constructor(e){this.node=e}}return e.type="[Engine Nodes] Query Node Info Failure",e})();class Ze{}class Je{}class Xe{constructor(e){this.shown=e=>!1,this.selected=e=>!1,this.pickable=e=>!0,e.forEach(e=>{this[e]=e=>!1})}}var Ye,et;!function(e){function t(e,t){e.nodes[t.id]||(e.nodes[t.id]=t)}function n(e,t){return e.nodes[t]||null}function i(e,t){return e.predecessors[t]||null}function o(e,t){return[...e.successors[t]||[]]}function s(e){return Object.keys(e.roots)}e.addRootNode=function(e,i){t(e,i);const o=n(e,i.id);e.roots[o.id]=o},e.getNodes=function(e,t){const n=[];return t.forEach(t=>{e.nodes[t]&&n.push(e.nodes[t])}),n},e.getAncestors=function(e,t,n=!1,i="ascending"){const o=n?[t]:[];let s=e.predecessors[t];for(;s;)o.push(s),s=e.predecessors[s];return"descending"===i&&o.reverse(),o},e.addNode=t,e.getNode=n,e.getAncestor=i,e.getAllAncestorsFromList=function(e,t){const n={};let o;return t.forEach(t=>{o=i(e,t),o&&!n[o]&&(n[o]=!0)}),Object.keys(n)},e.getSuccessors=o,e.getState=function(e,t,i){const o={},s=n(e,t);return Object.entries(s.boolState).forEach(([e,t])=>{i&&i.includes(e)&&(o[e]=t)}),Object.entries(s.numState).forEach(([e,t])=>{i&&i.includes(e)&&(o[e]=t)}),o},e.isLeaf=function(e,t){return!!e.nodes[t]&&void 0===e.successors[t]},e.isRoot=function(e,t){return e.roots.hasOwnProperty(t)||!1},e.getRoots=s,e.depthFirst=function e(t,n,i){i?(n(i),o(t,i).forEach(i=>{e(t,n,i)})):s(t).forEach(i=>{n(i),e(t,n,i)})},e.createGraphFromSrc=function(e,t="objectId",n="objects",i={}){const o={nodes:{},successors:{},predecessors:{},roots:{}};return e.forEach(e=>{!function e(t,n,i,o,s,r,a){const c={id:i[o],depth:0,boolState:{},numState:{}};c.depth=a,function(e,t,n,i="id"){Object.entries(n).forEach(([n,o])=>{let s;"string"==typeof o?s=t[o]:"function"==typeof o&&(s=o(t[i])),"boolean"==typeof s?e.boolState[n]=s:"number"==typeof s?e.numState[n]=s:e[n]=s})}(c,i,r,o),t.nodes[c.id]=c,n?(t.successors[n]=[...t.successors[n]||[],c.id],t.predecessors[c.id]=n):t.roots[c.id]=c,a+=1,(i[s]||[]).forEach(n=>{e(t,c.id,n,o,s,r,a)})}(o,null,e,t,n,i,0)}),o},e.pruneHiddenObjects=function e(t,n,i){const o=[];for(const s of t){const t=n[s.objectId],r=!0===t||!1!==t&&i,a=e(s.objects||[],n,r);if(r){const e=Object.assign({},s);e.objects=a,o.push(e)}else a.forEach(e=>o.push(e))}return o}}(Ye||(Ye={})),function(e){function t(e,t){return e.reduce((e,n)=>(e[n]=t[n]||!1,e),{})}e.createVoter=t,e.getInitialVoterState=function(e,n){return Object.keys(e).reduce((i,o)=>(i[o]=t(n,e[o]),i),{})},e.getInitialElectionDepth=function(e,t){return Object.keys(e).reduce((e,n)=>Math.max(e,Ye.getNode(t,n).depth),0)-1},e.getEligibleElections=function(e,t,n){return Ye.getAllAncestorsFromList(e,t).filter(t=>t&&Ye.getNode(e,t).depth===n)};const n={trueWins:e=>({result:e.votesFor.length>0,dissenters:[...e.votesAgainst]}),falseWins:e=>({result:e.votesAgainst.length>0,dissenters:[...e.votesFor]}),majorityWins:e=>{const t=e.votesFor.length>e.votesAgainst.length;return{result:t,dissenters:t?[...e.votesAgainst]:[...e.votesFor]}}};function i(e,t,i){return Object.keys(t).reduce((o,s)=>{const r=t[s],a=i[s]||"majorityWins",{result:c,dissenters:l}=n[a](r);return o[s]={id:e,result:c,dissenters:l,voters:[...r.votesFor,...r.votesAgainst]},o},{})}e.buildElectionResult=i,e.getElectionResults=function(e,n,o,s){const r=n,a=Object.keys(s);return{results:o.reduce((o,c)=>{const l=Ye.getSuccessors(e,c),p=l.map(i=>({[i]:n[i]||t(a,Ye.getState(e,i,a))}));l.forEach(e=>{delete r[e]});const d=i(c,function(e,t){return Object.keys(e).reduce((e,n)=>{const i=t.reduce((e,t)=>{const i=Object.keys(t)[0];return t[i][n]?e.votesFor.push(i):e.votesAgainst.push(i),e},{votesFor:[],votesAgainst:[]});return e[n]=i,e},{})}(s,p),s);return r[c]=Object.entries(d).reduce((e,[t,n])=>(e[t]=n.result,e),{}),o.results.push(d),o},{results:[]}).results,remainingVoters:r}}}(et||(et={}));let tt=(()=>{class e{serializeNode(e,t,n={},i=(e=>!0)){const o={};return o.id=t.id,Object.entries(t.boolState).forEach(([e,t])=>{n.hasOwnProperty(e)&&(o[e]=t)}),Object.entries(t.numState).forEach(([e,t])=>{n.hasOwnProperty(e)&&(o[e]=t)}),e.successors[t.id]&&(o.children=[],e.successors[t.id].forEach(t=>{i(t)&&o.children.push(this.serializeNode(e,e.nodes[t],n,i))},this)),o}getAllSiblingsFromList(e,t,n){const i=[];let o;for(o=0;o<t.length;o++)this.getSiblings(e,t[o],n).forEach(e=>{i.includes(e)||i.push(e)});return i}getElectionResults(e,t,n,i){class o extends class{}{constructor(e,t){super(),Object.entries(e).forEach(([e,n])=>{this[e]={votesFor:[],votesAgainst:[]},Object.entries(t).forEach(([t,n])=>{n[e]?this[e].votesFor.push(t):this[e].votesAgainst.push(t)},this)},this)}}let s,r;const a=Object.keys(i),c=[];return n.forEach(n=>{r={},Ye.getSuccessors(e,n).forEach(n=>{r[n]=t[n]||et.createVoter(a,Ye.getState(e,n,a)),delete t[n]},this),s=new o(i,r);const l=et.buildElectionResult(n,s,i);c.push(l);const p={};Object.entries(l).forEach(([e,t])=>{p[e]=t.result}),t[n]=p},this),c}updateGraphStateRecord(e,t,n,i,o=!0){n.forEach(n=>{const s=n[i[0]].id,r=Ye.getState(e,s,i),a={};let c=!1;i.forEach(e=>{(o||n[e].result!==r[e])&&(a[e]=n[e].result,c=!0)}),c&&(t[s]=a)},this)}nodeExists(e,t){return!!e.nodes[t]}getLeaves(e){const t=[];return Object.entries(e.nodes).forEach(([n,i])=>{e.successors[n]||t.push(n)}),t}getDescendants(e,t,n=!1){const i=[];return function t(n){Ye.getSuccessors(e,n).forEach(e=>{i.push(e),t(e)})}(t),n&&i.push(t),i}getLeafDescendants(e,t,n=!1){const i=this.getDescendants(e,t,n).filter(t=>Ye.isLeaf(e,t));return(Ye.isLeaf(e,t)||n)&&i.push(t),i}getAllLeafDescendants(e,t){let n=[];return t.forEach(t=>{n=Ye.isLeaf(e,t)?[...n,t]:[...n,...this.getLeafDescendants(e,t,!1)]}),n.sort().reduce((e,t)=>(e.indexOf(t)<0&&e.push(t),e),[])}getInverseSelection(e,t){const n=this.getAllLeafDescendants(e,t);return this.getLeaves(e).filter(e=>n.indexOf(e)<0)}getSiblings(e,t,n=!1){const i=e.predecessors[t];let o=[];if(o=i?Ye.getSuccessors(e,i):Ye.getRoots(e),!n){const e=o.indexOf(t);e>=0&&o.splice(e,1)}return o}getNodes(e,t){const n=[];return t.forEach(t=>{e.nodes[t]&&n.push(e.nodes[t])}),n}setState(e,t,n){const i=Ye.getNode(e,t),o={};return Object.entries(n).forEach(([e,t])=>{"boolean"==typeof t&&i.boolState[e]!==t?(i.boolState[e]=t,o[e]=t):"number"==typeof t&&i.numState[e]!==t&&(i.numState[e]=t,o[e]=t)}),o}synchronize(e,t,n){const i=this.calculateGraphStateMap(e,t,n);return Object.entries(i).forEach(([t,n])=>{this.setState(e,t,n)},this),i}calculateGraphStateMap(e,t,n,i=!n){let o=[];const s={};let r=[];const a={},c=Object.keys(t);let l=0;for(n?Object.entries(n).forEach(([t,i])=>{s[t]=et.createVoter(c,n[t]),a[t]=Object.assign({},s[t]),l=Math.max(l,Ye.getNode(e,t).depth)},this):this.getLeaves(e).forEach(t=>{s[t]=et.createVoter(c,Ye.getNode(e,t).boolState),a[t]=Object.assign({},s[t]),l=Math.max(l,Ye.getNode(e,t).depth)},this),l-=1,o=et.getEligibleElections(e,Object.keys(s),l);l>=0;)r=this.getElectionResults(e,s,o,t),this.updateGraphStateRecord(e,a,r,c,i),l-=1,o=et.getEligibleElections(e,Object.keys(s),l);return a}filterGraphAccessors(e,t){const n=this.getNodes(e,t).sort((e,t)=>e.depth-t.depth),i=new Map;return n.filter(t=>!i.has(t.id)&&(this.getDescendants(e,t.id,!0).forEach(e=>i.set(e,!0)),!0)).map(e=>e.id)}resetDepth(e){Ye.depthFirst(e,t=>{let n=0;e.predecessors[t]&&(n=Ye.getNode(e,e.predecessors[t]).depth+1),Ye.getNode(e,t).depth=n})}deleteNode(e,t,n=!0){if(!this.nodeExists(e,t))return;delete e.nodes[t];const i=e.predecessors[t];i&&(delete e.predecessors[t],e.successors[i]&&(e.successors[i]=e.successors[i].filter(e=>e!==t)));const o=e.successors[t];o&&(delete e.successors[t],n&&o.forEach(t=>{this.deleteNode(e,t)},this)),e.roots[t]&&delete e.roots[t]}sanitizeNodeID(e){const t=new RegExp(/\|/,"gi");return e.replace(t,"_")}resetAsLeaf(e,t){let n=[];return e.nodes[t]&&!Ye.isLeaf(e,t)&&(n=this.getDescendants(e,t),delete e.successors[t],n.forEach(t=>{delete e.nodes[t],delete e.successors[t],delete e.predecessors[t]})),n}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();class nt{}var it=function(e){return e.Started="started",e.Loaded="loaded",e.Tick="tick",e.HumanReady="human.ready",e.HumanStarted="started",e.Error="error",e.HumanError="human.error",e.LogDebug="_log.debug",e.LogError="_log.error",e.LogInfo="_log.info",e.LogWarn="_log.warn",e.SceneLoaded="scene.loaded",e.HumanProgress="human.progress",e.AnnotationsCreated="annotations.created",e.AnnotationsDestroyed="annotations.destroyed",e.AnnotationsHidden="annotations.hidden",e.AnnotationsShown="annotations.shown",e.AssetsLoadFinish="assets.load.finish",e.AssetsLoadProgress="assets.load.progress",e.AssetsLoadStart="assets.load.start",e.CameraRested="camera.rested",e.CameraUpdated="camera.updated",e.HotspotsDisplayUpdated="hotspots.displayUpdated",e.HotspotsEntered="hotspots.entered",e.HotspotsLeft="hotspots.left",e.HotspotsPicked="hotspots.picked",e.HotspotsPositionUpdated="hotspots.positionUpdated",e.LabelsCreated="labels.created",e.LabelsUpdated="labels.updated",e.LabelsMoved="labels.moved",e.LabelsDestroyed="labels.destroyed",e.LabelsChapterInfo="labels.chapterInfo",e.LabelsShown="labels.shown",e.LabelsHidden="labels.hidden",e.LabelsEnabled="labels.enabled",e.LabelsDisabled="labels.disabled",e.LabelsEntered="labels.entered",e.LabelsLeft="labels.left",e.LabelsPicked="labels.picked",e.ModuleInteractive="module.interactive",e.ModulesActivateFinish="modules.activate.finish",e.ModulesCreateFinish="modules.create.finish",e.ModulesDestroyFinish="modules.destroy.finish",e.PickPicked="pick.picked",e.QuizEntered="quiz.entered",e.QuizExited="quiz.exited",e.QuizQuestionLoaded="quiz.questionLoaded",e.QuizAnswerSelected="quiz.answerSelected",e.QuizAnswerSubmitted="quiz.answerSubmitted",e.QuizCompleted="quiz.completed",e.SceneMarkersUpdated="scene.markers.updated",e.SceneObjectRenderable="scene.objectRenderable",e.SceneObjectsSelected="scene.objectsSelected",e.SceneObjectsShown="scene.objectsShown",e.ScenePicked="scene.picked",e.SceneRestored="scene.restored",e.SceneXrayEnabled="scene.xrayEnabled",e.SceneXrayDisabled="scene.xrayDisabled",e.SceneReady="scene.ready",e.TimelineChaptersActivated="timeline.chapters.activated",e.TimelineChaptersActivateFinish="timeline.chapters.activate.finish",e.TimelineChaptersActivateStart="timeline.chapters.activate.start",e.TimelineChapterTransition="timeline.chapterTransition",e.TimelinePlaying="timeline.playing",e.TimelineScrubbed="timeline.scrubbed",e.TimelinePlayed="timeline.played",e.TimelineStopped="timeline.stopped",e.TimelinePaused="timeline.paused",e.TimelineUnpaused="timeline.unpaused",e.TimelineCompleted="timeline.completed",e.GraphAssetAttachFinish="graph.assetAttach.finish",e.TweenVisibilityUpdate="TweenVisibilityUpdate",e.NativeDeleteData="native.deleteData",e.NativeUpgrade="native.upgrade",e.NativeRestore="native.restore",e.NativeShare="native.share",e.NativeGoogleSignUp="native.googleSignUp",e.NativeDebugMessage="native.debugMessage",e}({}),ot=function(e){return e.SSAO="sao",e.Blur="blur",e.RadialBlur="radialBlur",e.DOF="dof",e.FXAA="fxaa",e.GroundShadow="groundShadow",e}({});const st={shown:"shown",renderable:e=>Human.scene.objects[e].isRenderable(),pickable:"pickable",label:e=>Human.scene.objects[e].displayName,expanded:e=>!1,layer:"layer"},rt={shown:"trueWins",renderable:"falseWins",pickable:"trueWins"},at={trim:!0};class ct{constructor(e){this.trim=e.trim||!1,this.terminal=e.terminal||[],this.root=e.root||{children:[],replace:!1},this.connect=e.connect||{},this.nodes=e.nodes||[]}}let lt=(()=>{class e{constructor(e){this.graphService=e,this.objectToNodeMap={},this.nodeToObjectMap={},this.events={},this.events=Object.values(it).reduce((e,t)=>(e[t]=this.makeObservable(t),e),{})}makeObservable(e){return new q.a(t=>{Human.events.on(e,e=>{t.next(e)})})}getCanvas(){return Human.renderer.canvas.canvas}getEvent(e){return this.events[e]}fireEvent(e,t){Human.events.fire(e,t)}getSceneBoundary(){return Human.scene.getBoundary()}getObjectBoundary(e){return Human.scene.objects[e].getBoundary()}getObjectLoaded(e){const t=this.getObjectBoundary(e);return!Object(X.isNil)(t)&&Object.values(t).every(e=>isFinite(e))}pickScene(e){return Human.renderer.pick.pick(e.x,e.y,{rayPick:e.rayPick})}transformObject(e,t){const n=Human.scene.objects[e];n?n.setTransform(t):console.error(`Scene object not found: '${e}'`)}toggleNodes(e,t){const n={replace:!1,objects:{},fetchAssets:t};e.forEach(e=>{this.getObjects(e).forEach(e=>{n.objects[e]=t})}),Human.scene.setEnabledObjects(n)}setNodesVisible(e,t=!1){const n={replace:t,objects:Object.assign({},e),fetchAssets:!0};Human.scene.setEnabledObjects(n)}setNodesPickable(e){Object.keys(e).forEach(t=>{(Human.scene.objects[t].isLeaf()?[t]:this.getLeafObjects(t)).forEach(n=>{Human.scene.objects[n].setPickable(e[t])})})}filterObjects(e,t){let n=e.length;for(;n--;)switch(!0){case e[n]instanceof Human.scene.Group:e[n].objects=this.filterObjects(e[n].objects,t),0===e[n].objects.length&&e.splice(n,1);break;case e[n]instanceof Human.scene.Object:-1===e[n].displayName.toLowerCase().indexOf(t)&&e.splice(n,1)}return e}setObjectLayer(e,t){const n=Human.scene.objects[e];if(n.layer=t,n.renderables)for(let i=0;i<n.renderables.length;++i)n.renderables[i].setLayer(t);else n.hasOwnProperty("_layerNode")?n._layerNode.setPriority(t):n.hasOwnProperty("_propertiesNode")&&n._propertiesNode.setProperties({layer:t})}getObjectLayerValues(e){const t={},n=Human.scene.getBoundary();return e.forEach(e=>{const i=Human.scene.objects[e],o=i.getBoundary(),s=Math.min(o.xmin-n.xmin,n.xmax-o.xmax),r=2*Math.min(o.ymin-n.ymin,n.ymax-o.ymax),a=Math.min(o.zmin-n.zmin,n.zmax-o.zmax),c=i.layer;t[c]=t[c]||[],t[c].push({nodeId:e,value:Math.min(s,r,a)})}),t}getSceneGraph(e){const t=Ye.createGraphFromSrc(e,"objectId","objects",st);return this.graphService.synchronize(t,rt),t}createViewGraph(e,t=!0){const n=t?Ye.pruneHiddenObjects(Human.scene.rootObjects,e):Human.scene.rootObjects,i=n.reduce((e,t)=>{const n=t.objectId.includes("-root");return e[t.objectId]=!0!==n,n&&t.objects.forEach(t=>{e[t.objectId]=!0}),e},{}),o=this.getSceneGraph(Ye.pruneHiddenObjects(n,i));return this.graphService.resetDepth(o),o}getNode(e,t){return this.graphService.nodeExists(e,t)?Ye.getNode(e,t):this.objectToNodeMap[t]?Ye.getNode(e,this.objectToNodeMap[t]):null}getChapterGraphConfig(){const e=Human.timeline.activeRoot._nowBranch;return new ct(Object.assign(Object.assign({},at),e.graph||{}))}getRootObjects(){return Human.scene.rootObjects}getAllSceneObjects(){return Human.scene.objects}getObjects(e){return this.nodeToObjectMap[e]?this.nodeToObjectMap[e]:[Human.scene.objects[e].objectId]||!1}getLeafObjects(e){if(e in this.nodeToObjectMap){const t={};return this.nodeToObjectMap[e].forEach(e=>{Human.scene.objects[e].isLeaf()?t[e]=!0:Human.scene.getLeaves(e).forEach(e=>{t[e]=!0})}),Object.keys(t)}return e in Human.scene.objects?Human.scene.getLeaves(e):[]}getChapter(e){return Human.timeline.branchTimelines[e]||null}getActiveChapters(){return Human.timeline.activeRoot?Human.timeline.activeRoot._chapters:[]}getBoundaryFromObjects(e){return e=e.filter(e=>Human.scene.objects[e].isLeaf()),Human.scene.getBoundary({objectIds:e,clipped:!0})}getLeaves(e){return Human.scene.getLeaves(e)}getVisibleLeaves(){return Human.scene.getEnabledLeaves()}getCameraLookAt(){return Object(I.plainToClass)(nt,Human.renderer.camera.getLookAt())}barycentricToWorld(e,t,n,i=0){const o=new Float32Array([0,0,0]);return Human.scene.objects[e].barycentricToWorldSpace(i,t,n,o),isNaN(o[0])?[0,0,0]:[...Array.from(o)]}setGraphState(e){Human.scene.setObjectProperties(e)}getAssetNamespaces(){const e={};return Object.keys(Human.assets.loadedAssets).map(e=>e.split("/")[0]).forEach(t=>{e[t]=!0}),Object.keys(e)}loadGraphObject(e){const t=this.getObjects(e).map(e=>Human.scene.objects[e]);return new q.a(e=>{Human.scene.graph.attachAssetSetsToSubtree(t,null,()=>{e.next(!0),e.complete()})})}setProperties(e){Human.properties.set(e)}setTransparencyMode(e){Human.renderer.setTransparencyMode(e)}setPostProcessingEnabled(e){e?Human.renderer.postprocess.enable():Human.renderer.postprocess.disable()}setPostProcessingFeatures(e){const t=e.filter(e=>e.effect!==ot.GroundShadow);Human.renderer.postprocess.parse(t);const n=e.find(e=>e.effect===ot.GroundShadow);n?(Human.renderer.groundShadow.init(),Human.renderer.groundShadow.update({blurAmount:n.blur,opacity:n.opacity,translation:[n.xPos,n.yPos,n.zPos],scale:n.size})):Human.renderer.groundShadow.destroy()}enableAnimation(){Human.timeline.enableAnimation()}enableRender(){Human.renderer.enableRender()}canIRender(){return Human.renderer.canIRender()}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(tt))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();class pt{constructor(e,t,n,i,o){this.left=e,this.top=t,this.width=n,this.height=i,this.visibility=o}}var dt=function(e){return e[e.Hidden=-1]="Hidden",e[e.Shown=1]="Shown",e}({});class ut{}let gt=(()=>{class e{constructor(e){this.id=e}}return e.type="[Engine Camera] Clear Camera",e})(),ht=(()=>{class e{constructor(e,t){this.id=e,this.camera=t}}return e.type="[Engine Camera] Store Camera",e})(),bt=(()=>{class e{constructor(e,t=!0,n){this.camera=e,this.animate=t,this.animationDuration=n}}return e.type="[Engine Camera] Set Camera",e})(),mt=(()=>{class e{constructor(){}}return e.type="[Engine Camera] Set Camera Success",e})(),ft=(()=>{class e{constructor(e){this.cameraMotion=e}}return e.type="[Engine Camera] Move Camera",e})(),yt=(()=>{class e{constructor(){}}return e.type="[Engine Camera] Reset Camera",e})(),xt=(()=>{class e{constructor(e){this.value=e}}return e.type="[Engine Camera] Zoom Camera",e})(),vt=(()=>{class e{constructor(e){this.value=e}}return e.type="[Engine Camera] Zoom Camera Static",e})(),wt=(()=>{class e{constructor(e){this.value=e}}return e.type="[Engine Camera] Pan Camera X",e})(),Ot=(()=>{class e{constructor(e){this.value=e}}return e.type="[Engine Camera] Pan Camera Y",e})(),Ct=(()=>{class e{constructor(e,t,n){this.x=e,this.y=t,this.z=n}}return e.type="[Engine Camera] Pan Camera Static",e})(),St=(()=>{class e{constructor(e){this.value=e}}return e.type="[Engine Camera] Rotate Camera X",e})(),kt=(()=>{class e{constructor(e){this.value=e}}return e.type="[Engine Camera] Rotate Camera Y",e})(),_t=(()=>{class e{constructor(e,t){this.x=e,this.y=t}}return e.type="[Engine Camera] Rotate Camera Static",e})(),jt=(()=>{class e{constructor(e){this.mode=e}}return e.type="[Engine Camera] Set Camera Mode",e})(),Pt=(()=>{class e{constructor(e){this.zoomed=e}}return e.type="[Engine Camera] Set Zoomed",e})(),Mt=(()=>{class e{constructor(e){this.lock=e}}return e.type="[Engine Camera] Lock camera",e})(),It=(()=>{class e{constructor(e){this.camera=e}}return e.type="[Engine Camera] Set Camera Fly To",e})(),zt=(()=>{class e{constructor(e){this.patches=e}}return e.type="[Engine Camera] Patch Camera State",e})();class Tt{static toArray(e){return[e.x,e.y,e.z]}static fromArray(e){return{x:e[0],y:e[1],z:e[2]}}}let Ut=(()=>{class e{constructor(){}roundModel(e,t){const n=Object.assign({},e);return Object.keys(e).filter(t=>"number"==typeof e[t]).forEach(i=>{n[i]=this.roundNumber(e[i],t)}),n}roundNumber(e,t){return Math.round(e*Math.pow(10,t))/Math.pow(10,t)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),Lt=(()=>{class e{constructor(e){this.numberService=e,this.rotation={vx:0,vy:0},this.pan={x:0,y:0,z:0},this.zoom=0}getEye(){return Human.renderer.camera.eye}setEye(e){Human.renderer.camera.setLookAt({eye:e})}getCamera(){return Human.renderer.camera.getLookAt()}getLookDirection(){const e=vec3.create();return Human.renderer.camera.getLookDir(e),e}setCamera(e){return Human.renderer.camera.setLookAt(e)}getCameraZoom(){return Human.renderer.camera.getZoom()}captureCamera(){return{lookAt:Human.renderer.camera.getLookAt(),zoom:Human.renderer.camera.getZoom()}}resetCamera(){return new q.a(e=>{Human.init.resetCamera(()=>{e.next(),e.complete()})})}getDirection(e){const t=this.getEye(),n=vec3.create();return n[0]=t.x-e.worldPos[0],n[1]=t.y-e.worldPos[1],n[2]=t.z-e.worldPos[2],vec3.normalize(n,n),n}rotateCameraStatic(e,t){Human.renderer.camera.rotateX(e),Human.renderer.camera.rotateY(t)}panCameraStatic(e,t,n){Human.renderer.camera.pan({x:e,y:t,z:n})}setHumanZoom(e){Human.renderer.camera.zoom(e)}setHumanZoomFactor(e){Human.renderer.camera.setZoom(e)}setCameraRotation(e,t){this.rotation.vx=t,this.rotation.vy=-e}setCameraPan(e,t){this.pan.x=e,this.pan.y=t}setCameraZoom(e){this.zoom=.03*e}setCameraZoomWithVelocity(e){this.setCameraZoom(e),requestAnimationFrame(()=>{e*=.85,Math.abs(e)>1&&this.setCameraZoomWithVelocity(e)})}tickCameraRotation(){return this.rotation.vx=this.checkEpsilon(this.rotation.vx),this.rotation.vy=this.checkEpsilon(this.rotation.vy),this.rotation}tickCameraPan(){return this.pan.x=this.checkEpsilon(this.pan.x),this.pan.y=this.checkEpsilon(this.pan.y),this.pan.z=this.checkEpsilon(this.pan.z),this.pan}tickCameraZoom(){return this.zoom=this.checkEpsilon(this.zoom),this.zoom}areCamerasEqual(e,t){return this.compareXYZ(e.eye,t.eye)&&this.compareXYZ(e.look,t.look)&&this.compareXYZ(e.up,t.up)}compareXYZ(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z}roundCamera(e,t){const{eye:n,look:i,up:o}=e;return{eye:this.numberService.roundModel(n,t),look:this.numberService.roundModel(i,t),up:this.numberService.roundModel(o,t)}}cameraAfterFlyTo(e){const t=this.getCamera(),n=Tt.toArray(t.look),i=Tt.toArray(t.eye),o=vec3.create();vec3.subtract(o,i,n);const s=vec3.create();vec3.normalize(s,o);const r=Math.abs(vec3.length(s)),a=Human.math.getBoundaryDiag(e),c=Math.abs(a/1.8/Math.tan(27.5))/r*2.5,l=Human.math.getBoundaryCenter(e);vec3.scale(o,s,c);const p=vec3.add(vec3.create(),l,o);return{eye:Tt.fromArray(p),look:Tt.fromArray(l),up:{x:0,y:1,z:0}}}checkEpsilon(e){return Math.abs(e)<.001?0:e}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(Ut))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();class Dt{constructor(e=0,t=0,n=0,i=0,o=0,s=!1){this.zoom=e,this.panX=t,this.panY=n,this.rotateX=i,this.rotateY=o,this.applyFriction=s}}var Et=n("vkgz");class Ft{}var At=function(e){return e.JPEG="image/jpeg",e.PNG="image/png",e}({});let Rt=(()=>{class e{constructor(e){this.patches=e}}return e.type="[Story Chapter] Apply Patch",e})(),Nt=(()=>{class e{constructor(){}}return e.type="[Story Chapter] Next Chapter",e})(),Vt=(()=>{class e{constructor(){}}return e.type="[Story Chapter] Previous Chapter",e})(),Ht=(()=>{class e{constructor(){}}return e.type="[Story Chapter] First Chapter",e})(),Bt=(()=>{class e{constructor(){}}return e.type="[Story Chapter] Last Chapter",e})(),Qt=(()=>{class e{constructor(e){this.chapter=e}}return e.type="[Story Chapter] Select Chapter",e})(),$t=(()=>{class e{constructor(e){this.chapterId=e}}return e.type="[Story Chapter] Select Chapter by chapter id",e})(),qt=(()=>{class e{constructor(e){this.chapters=e}}return e.type="[Story Chapter] Set Chapters",e})(),Wt=(()=>{class e{constructor(e,t){this.chapterId=e,this.cameraAction=t}}return e.type="[Story Chapter] Set Chapter Camera Action",e})(),Kt=(()=>{class e{constructor(e,t){this.chapterId=e,this.ui=t}}return e.type="[Story Chapter] Set Chapter UI",e})(),Gt=(()=>{class e{constructor(e,t){this.chapterId=e,this.info=t}}return e.type="[Story Chapter] Set Chapter Info",e})(),Zt=(()=>{class e{constructor(e,t){this.chapterId=e,this.legend=t}}return e.type="[Story Chapter] Set Chapter Legend",e})(),Jt=(()=>{class e{constructor(e,t){this.chapterId=e,this.legend=t}}return e.type="[Story Chapter] Add To Chapter Legend",e})(),Xt=(()=>{class e{constructor(e,t){this.previousIndex=e,this.currentIndex=t}}return e.type="[Story Chapter] Reorder Chapters",e})(),Yt=(()=>{class e{constructor(e,t){this.chapterId=e,this.readyState=t}}return e.type="[Story Chapter] Set Readystate",e})(),en=(()=>{class e{constructor(e,t,n){this.chapterId=e,this.effects=t,this.properties=n}}return e.type="[Story Chapter] Set Chapter PostProcessing",e})(),tn=(()=>{class e{constructor(e,t,n){this.chapterId=e,this.transition=t,this.key=n}}return e.type="[Story Chapter] Set Chapter Transitions",e})(),nn=(()=>{class e{constructor(e,t){this.chapterId=e,this.transparencyMode=t}}return e.type="[Story Chapter] Set Chapter Transparency Mode",e})(),on=(()=>{class e{constructor(e,t,n,i){this.chapterId=e,this.clips=t,this.enabled=n,this.record=i}}return e.type="[Story Chapter] Set Chapter Clipping Planes",e})(),sn=(()=>{class e{constructor(e,t){this.chapterId=e,this.background=t}}return e.type="[Story Chapter] Set Chapter Background",e})(),rn=(()=>{class e{constructor(e){this.background=e}}return e.type="[Story Chapter] Set All Chapters Background",e})(),an=(()=>{class e{constructor(){}}return e.type="[Story Chapter] Reset Selected Chapter Background",e})(),cn=(()=>{class e{constructor(e){this.background=e}}return e.type="[Story Chapter] Set Selected Chapter Background",e})(),ln=(()=>{class e{constructor(e,t){this.chapter=e,this.chapterId=t}}return e.type="[Story Chapter] Duplicate An Existing Chapter",e})(),pn=(()=>{class e{constructor(e){this.chapter=e}}return e.type="[Story Chapter] Remove Chapter",e})(),dn=(()=>{class e{constructor(){}}return e.type="[Story Chapter] Reset",e})(),un=(()=>{class e{constructor(e){this.thumbnails=e}}return e.type="[Story Chapters] Register thumbnail URLs from story",e})(),gn=(()=>{class e{constructor(e,t){this.sourceChapter=e,this.targetChapter=t}}return e.type="[Story Chapters] Copy Thumbnail From Chapter",e})(),hn=(()=>{class e{constructor(e,t=At.JPEG,n=.92,i,o="original",s,r,a=[]){this.chapterId=e,this.imageType=t,this.imageQuality=n,this.dimensions=i,this.crop=o,this.includeLabels=s,this.includeCopyright=r,this.layers=a}}return e.type="[Story Chapters] Take picture",e})(),bn=(()=>{class e{constructor(e,t,n){this.chapterId=e,this.blob=t,this.dimensions=n}}return e.type="[Story Chapters] Take picture success",e})(),mn=(()=>{class e{constructor(e,t){this.chapterId=e,this.camera=t}}return e.type="[Story Chapters] Record Camera",e})(),fn=(()=>{class e{constructor(e,t,n,i){this.chapterId=e,this.index=t,this.position=n,this.record=i}}return e.type="[Story Chapters] Set the current visibility layers index and position",e})(),yn=(()=>{class e{constructor(e,t){this.chapterId=e,this.media=t}}return e.type="[Story Chapters] Set the media object",e})(),xn=(()=>{class e{constructor(e,t){this.chapterId=e,this.contentBlocks=t}}return e.type="[Story Chapters] Set the content blocks",e})();var vn=function(e){return e.Default="default",e.Plus="plus",e.Minus="minus",e.PlusMinus="plusMinus",e.Sequential="sequential",e.None="None",e}({}),wn=function(e){return e.Annotation="annotation",e.Classic="classic",e.StudioNext="studioNext",e.Context="context",e}({}),On=function(e){return e.Alphabetical="alphabetical",e.Numerical="numerical",e}({});class Cn{constructor(e){this.pinType=vn.PlusMinus,this.sequentialType=On.Alphabetical,this.theme=wn.StudioNext,this.expandTag=!0,this.showDescription=!0,this.collapseDescription=!1,this.pinGlow=!1,this.hideWire=!1,this.hideTag=!1,this.title=e}}class Sn{}class kn{}const _n=(e,t)=>{const n=[...e];return t.forEach(e=>{n.push(void 0!==e?Number(e):1)}),n},jn=e=>{const t=/rgba?\((\d{1,3})\,\s*(\d{1,3})\,\s*(\d{1,3})\,?\s*(\d+\.\d{0,5})?\)/g;let n=[];const i=t.exec(e),o=t.exec(e);return n=_n(n,i.slice(1,5)),n=_n(n,o.slice(1,5)),n};class Pn{constructor(e,t,n){this.colors=e,this.gradientType=t,this.colorStops=n}static equals(e,t){return e.gradientType===t.gradientType&&e.colors.length===t.colors.length&&e.colors.every((e,n)=>e===t.colors[n])&&e.colorStops.length===t.colorStops.length&&e.colorStops.every((e,n)=>e===t.colorStops[n])}static deserialize(e){if(!Object.keys(e).length)return null;let t=[];"string"==typeof e.colors?t=jn(e.colors):Array.isArray(e.colors)&&8===e.colors.length&&(t=e.colors.map((e,t)=>(t+1)%4&&e<=1?Math.round(255*e):e));const n=/radial|linear/.test(e.gradientType)?e.gradientType:"radial",i=e.colorStops,o=Array.isArray(i)&&2===i.length?[i[0],i[1]]:[0,100];return new Pn(t,n,o)}static toCSS(e){const t=e.colors,n=`rgba(${t[0]},${t[1]}, ${t[2]}, ${t[3]}) ${e.colorStops[0]}%`,i=`rgba(${t[4]},${t[5]}, ${t[6]}, ${t[7]}) ${e.colorStops[1]}%`;return"radial"===e.gradientType?`radial-gradient(circle, ${n}, ${i})`:`linear-gradient(180deg, ${n}, ${i})`}static fromCSS(e){const t=/radial-gradient/.test(e)?"radial":"linear",n=jn(e),i=/([0-9]+)\%/g,o=[0,100];return o[0]=Number(i.exec(e)[1]),o[1]=Number(i.exec(e)[1]),new Pn(n,t,o)}static isTransparent(e){if(!e||!e.colors)return!1;const t=e.colors,n=t[3];return t.length<=4?0===n:0===n&&0===t[7]}}var Mn,In=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},zn=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let Tn=class{constructor(){this[Mn]=!0}};var Un;Mn=immer.immerable,In([Object(I.Type)(()=>Cn),Object(I.Type)(()=>Sn),Object(I.Type)(()=>nt),Object(I.Type)(()=>kn),Object(I.Expose)(),zn("design:type",String)],Tn.prototype,"id",void 0),In([Object(I.Expose)(),zn("design:type",Object)],Tn.prototype,"info",void 0),In([Object(I.Expose)(),zn("design:type",Array)],Tn.prototype,"labels",void 0),In([Object(I.Expose)(),zn("design:type",Object)],Tn.prototype,"colorRecipeObjects",void 0),In([Object(I.Expose)(),zn("design:type",Array)],Tn.prototype,"hotspots",void 0),In([Object(I.Expose)(),zn("design:type",Sn)],Tn.prototype,"synchronization",void 0),In([Object(I.Expose)(),zn("design:type",Pn)],Tn.prototype,"background",void 0),In([Object(I.Expose)(),zn("design:type",Object)],Tn.prototype,"lights",void 0),In([Object(I.Expose)(),zn("design:type",Array)],Tn.prototype,"timelineMap",void 0),In([Object(I.Expose)(),zn("design:type",Object)],Tn.prototype,"camera",void 0),In([Object(I.Expose)(),zn("design:type",Object)],Tn.prototype,"transitions",void 0),In([Object(I.Expose)(),zn("design:type",Object)],Tn.prototype,"properties",void 0),In([Object(I.Expose)(),zn("design:type",Boolean)],Tn.prototype,"loop",void 0),In([Object(I.Expose)(),zn("design:type",Object)],Tn.prototype,"customData",void 0),In([Object(I.Expose)(),zn("design:type",Object)],Tn.prototype,"clippingPlanes",void 0),In([Object(I.Expose)(),zn("design:type",class{})],Tn.prototype,"ui",void 0),In([Object(I.Expose)(),zn("design:type",kn)],Tn.prototype,"graph",void 0),In([Object(I.Expose)(),zn("design:type",Object)],Tn.prototype,"viewModes",void 0),In([Object(I.Expose)(),zn("design:type",Object)],Tn.prototype,"recipes",void 0),In([Object(I.Expose)(),zn("design:type",String)],Tn.prototype,"transparencyMode",void 0),In([Object(I.Expose)(),zn("design:type",Object)],Tn.prototype,"fallbackTransparency",void 0),In([Object(I.Expose)(),zn("design:type",Object)],Tn.prototype,"effects",void 0),In([Object(I.Expose)(),zn("design:type",Object)],Tn.prototype,"environment",void 0),In([Object(I.Expose)(),zn("design:type",Object)],Tn.prototype,"pickThroughObjects",void 0),In([Object(I.Expose)(),zn("design:type",Object)],Tn.prototype,"showObjects",void 0),In([Object(I.Expose)(),zn("design:type",Object)],Tn.prototype,"options",void 0),In([Object(I.Expose)(),zn("design:type",Object)],Tn.prototype,"media",void 0),In([Object(I.Expose)(),zn("design:type",Array)],Tn.prototype,"legend",void 0),In([Object(I.Expose)(),zn("design:type",class{})],Tn.prototype,"visibilityLayers",void 0),In([Object(I.Expose)(),zn("design:type",Array)],Tn.prototype,"contentBlocks",void 0),In([Object(I.Expose)(),zn("design:type",Array)],Tn.prototype,"quizQuestions",void 0),Tn=In([Object(I.Exclude)()],Tn),function(e){function t(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}e.getUuid=t,e.idWithPrefix=function(e){return e?`${e}-${t()}`:t()}}(Un||(Un={}));class Ln{}var Dn=function(e){return e.classicAnnotation="classic-annotation",e.classicHotspot="classic-hotspot",e.studioNext="studio-light",e}({});class En{constructor(){this.title=null,this.description=null,this.errands=[]}}var Fn=function(e){return e.flyToChapter="flyToChapter",e.flyToObject="flyToObject",e.flyToCamera="flyToCamera",e}({});class An{constructor(e){this.type=Fn.flyToObject,this.value=e}}class Rn{constructor(e){this.type=Fn.flyToCamera,this.value=e}}var Nn=function(e){return e.Circle="circle",e.CirclePlus="circle-plus",e.CircleMinus="circle-minus",e.Label="label",e.CircleLabel="circle-label",e}({});class Vn{constructor(){this.type=Fn.flyToChapter,this.value=null}}const Hn={flyToCamera:"flyTo",flyToChapter:"flyTo"};let Bn=(()=>{class e{constructor(e){this.engineService=e,this.convertActionToErrand=(e,t,n)=>{const i=new RegExp("^flyTo(Async)?"),o=new RegExp("^flyToObject(Async)?"),s=new RegExp("^flyTo[w.:]+currentChapter.[flyTo|jumpTo]"),r=n.split(":").slice(0,2),a=e;let c=r[1];/currentChapter/.test(c)&&(c=c.replace("currentChapter",`chapters[${t}]`));let l=null;return o.test(r[0])?l=new An(Object(X.get)(a,c)):i.test(r[0])?l=new Rn(Object(X.get)(a,c)):s.test(r[0])&&(l=new Vn),l},this.convertErrandToAction=(e,t)=>{const n=Un.idWithPrefix("errand").replace(/\-/g,"_"),i={};let o="";const s=function(e){return Hn[e]||e}(t.type);return t.type===Fn.flyToChapter?o=`${s}Async:currentChapter.${this.engineService.getChapter(e.chapterId).camera.action}`:(o=`${s}Async:currentChapter.customData.${n}`,i[n]=t.value),{action:o,data:i}}}filterHotspot(e,t,n){const i=new RegExp("^(flyTo|flyToObject|hideHotspot|showHotspot|resetHotspots)"),o=this.getHotspotAction(e,n),s=o.filter(e=>i.test(e));return o.length===s.length}deserializeAnnotation(e,t,n){const i=new Cn(e.title||"");return i.id=e.annotationId||Un.idWithPrefix("label"),i.chapterId=t.id,i.expandTag=!0,i.showDescription=!0,i.collapseDescription=!1,i.pinGlow=!1,i.hideWire=!1,i.hideTag=!1,n===wn.Annotation?(i.theme=wn.Annotation,i.pinType=vn.Default,i.flyTo=!1,i.states=[]):(i.theme=wn.StudioNext,i.pinType=vn.PlusMinus,i.flyTo=!0,i.states=[new En,new En],i.states[0].errands=[new Vn],i.states[1].errands=[new An(e.objectId)]),i.occludable=!1!==e.occludable,i.renderableIndex=e.renderableIndex||0,e.objectId&&e.hasOwnProperty("barycentric")?(i.objectId=e.objectId,i.primitiveIndex=e.primitiveIndex,i.barycentric=e.barycentric):e.hasOwnProperty("pos")&&(e.hasOwnProperty("objectId")&&(i.objectId=e.objectId),i.pos=e.pos),e.dir&&Array.isArray(e.dir)?i.dir=e.dir:e.dir&&e.dir instanceof Object&&(i.dir=Object.values(e.dir)),i.description=e.description||"",i.offset=e.labelOffset||[40,40],i.shown=!1!==e.shown,i.labelShown=!1!==e.labelShown,i}deserializeHotspots(e,t,n,...i){const[o,s]=i,r=new Cn(o.title||"");switch(r.id=Un.idWithPrefix("hotspot"),r.objectId=o.objectId,r.chapterId=t.id,r.description=o.description||"",r.pinType=/plus|minus/.test(o.className)?vn.PlusMinus:/sequential/.test(o.className)?vn.Sequential:/none/.test(o.className)?vn.None:vn.Default,/alphabetical/.test(o.className)?r.sequentialType=On.Alphabetical:/numerical/.test(o.className)&&(r.sequentialType=On.Numerical),r.pinGlow=/pulse/.test(o.className),r.occludable=!0,r.shown=o.shown,r.offset=o.labelOffset?o.labelOffset:[22,-17],(/left/.test(o.className)&&r.offset[0]>0||/right/.test(o.className)&&r.offset[0]<0)&&(r.offset[0]*=-1),o.hasOwnProperty("barycentric")?(r.renderableIndex=o.renderableIndex||0,r.barycentric=o.barycentric,r.primitiveIndex=o.primitiveIndex):r.pos=o.pos,r.dir=o.dir,o.theme=o.theme?o.theme:Dn.classicHotspot,o.theme){case Dn.classicAnnotation:r.theme=wn.Annotation,r.showDescription=!0,r.collapseDescription=/collapsible/g.test(o.className),r.expandTag=!0,r.hideTag=!1,r.hideWire=!/leader-line/.test(o.className);break;case Dn.classicHotspot:r.theme=wn.Classic,r.showDescription=/label/.test(o.className),r.expandTag=/label/.test(o.className),r.hideTag=!r.expandTag,r.collapseDescription=!1,r.hideWire=!/leader-line/.test(o.className);break;case Dn.studioNext:r.theme=wn.StudioNext,r.showDescription=this.hasContent(o),r.collapseDescription=/collapsible/g.test(o.className),r.hideTag=!o.title,r.hideWire=!/leader-line/.test(o.className)}r.flyTo=!1,r.flyToTarget=null,r.states=[];const a=this.filterHotspotActions(this.getHotspotAction(e,o)),c=s?this.filterHotspotActions(this.getHotspotAction(e,s)):[],l=new En,p=new En;a.length&&(l.errands=a.map(t=>this.convertActionToErrand(e,n,t))),c.length&&(p.errands=c.map(t=>this.convertActionToErrand(e,n,t))),r.states=[p,l],l.errands.length>0&&(r.flyTo=!0,r.flyToTarget=l.errands[0].type,l.errands[0].type===Fn.flyToCamera&&(r.cameraPosition=l.errands[0].value));const d=o.contentBlocks;return d&&(r.contentBlocks=JSON.parse(JSON.stringify(d))),r}makeDefaultStudioLabel(e){const t=e?Object.assign({},e):new Cn("");return t.pinType=vn.PlusMinus,t.theme=wn.StudioNext,t.expandTag=!0,t.showDescription=!0,t.collapseDescription=!1,t.pinGlow=!1,t.hideWire=!1,t.hideTag=!1,t.occludable=!0,t.flyTo=!0,t.description="",t.shown=!0,t.states=[new En,new En],t}makeAnnotationLabel(e){const t=e?Object.assign({},e):new Cn("");return t.pinType=vn.Default,t.theme=wn.Annotation,t.expandTag=!0,t.showDescription=!0,t.collapseDescription=!1,t.pinGlow=!1,t.hideWire=!1,t.hideTag=!1,t.states=[],t}serializeLabel(e,t){const n=new Ln,i=Object(I.classToClass)(e),o=["circle","draggable"];n.shown=!0,e.objectId&&(n.objectId=i.objectId);try{e.primitiveIndex&&e.barycentric&&e.objectId?(n.renderableIndex=e.renderableIndex||0,n.primitiveIndex=e.primitiveIndex,n.barycentric=e.barycentric,n.pos=this.engineService.barycentricToWorld(e.objectId,e.primitiveIndex,e.barycentric)):n.pos=i.pos}catch(l){return{data:{},hotspots:[]}}switch(e.dir&&(n.dir=Array.prototype.slice.call(e.dir)),n.labelOffset=e.offset,e.theme){case wn.Annotation:n.theme=Dn.classicAnnotation;break;case wn.Classic:n.theme=Dn.classicHotspot;break;default:n.theme=Dn.studioNext}""!==i.title?(n.title=i.title,n.description=i.description,n.type=Nn.CircleLabel):n.type=Nn.Circle,e.pinGlow&&o.push("pulse"),e.pinType===vn.PlusMinus&&o.push("plus"),e.pinType===vn.Sequential&&(o.push("sequential"),o.push(e.sequentialType===On.Alphabetical?"alphabetical":"numerical")),e.pinType===vn.None&&o.push("none"),e.hideWire||o.push("leader-line"),e.hideTag||o.push("label"),e.collapseDescription&&o.push("collapsible collapsed"),n.className=o.join(" ");let s={};n.actions=[];const r=[n],a=e.states.length;e.states.forEach((t,i)=>{if(i===a-1)r[0].actions.push("resetHotspots"),t.errands.forEach(t=>{const n=this.convertErrandToAction(e,t);r[0].actions.push(n.action),s=Object.assign(Object.assign({},s),n.data)});else{const i=Object(I.classToClass)(n);i.actions=[],i.className=i.className.replace("plus","minus"),t.errands.forEach(t=>{const n=this.convertErrandToAction(e,t);i.actions.push(n.action),s=Object.assign(Object.assign({},s),n.data)}),r.push(i)}}),2===r.length&&(r[0].actions.push(`hideHotspots:currentChapter.hotspots[${t}]`),r[0].actions.push(`showHotspots:currentChapter.hotspots[${t+1}]`),r[1].actions.push(`hideHotspots:currentChapter.hotspots[${t+1}]`),r[1].actions.push(`showHotspots:currentChapter.hotspots[${t}]`),r[0].shown=!0,r[1].shown=!1),2===r.length&&e.collapseDescription&&(r[1].className+=r[1].className.replace("collapsed","")),r.forEach(e=>{n.labelOffset[0]<0?e.className=e.className.replace("right","")+" left":n.labelOffset[0]>0&&(e.className=e.className.replace("left","")+" right")});const c=e.contentBlocks;return c&&(n.contentBlocks=JSON.parse(JSON.stringify(c))),{data:s,hotspots:r}}setLabelContainer(e){this._labelContainer=e}getLabelContainer(){return this._labelContainer}hasContent(e){const{description:t,contentBlocks:n}=e;return!!t||!Object(X.isNil)(n)&&n.length>0}getHotspotAction(e,t){const n=t.actionSrc?Object(X.get)(e,t.actionSrc):t.actions?t.actions:[];return Array.isArray(n)?n:[]}filterHotspotActions(e){const t=new RegExp("^(flyTo|flyToObject)");return e.filter(e=>t.test(e))}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(lt))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();class Qn{}var $n,qn;function Wn(e,t,n,i){(function e(t,n){const i=n.objects;return 0===i.length?[]:Object(X.flattenDeep)(i.map(n=>[n.objectId,...e(t,t.scene.objects[n.objectId])]))})(Human,Human.scene.objects[e]).forEach(e=>t[e][n]=i)}function Kn(e,t){if(void 0===e.activeChapterId||void 0===e.nodeState)return;const[n,i,o]=immer.produceWithPatches(e,e=>{const n=e.nodeState[e.activeChapterId],i=t.objectIds||Object.keys(n);t.patch?Object.entries(t.patch).forEach(([e,t])=>{n[e].shown=t}):i.forEach(e=>{n[e].shown=t.show,n[e].shownSetByTween=t.setByTween,t.objectIds&&(Wn(e,n,"shown",t.show),!0===t.setByTween&&Wn(e,n,"shownSetByTween",t.setByTween))})});return{finalState:immer.produce(n,e=>{e.patches=i,e.patchesForChapter[e.activeChapterId].push(...i)}),patches:i,inversePatches:o}}!function(e){class t{constructor(){}}t.type="[Engine Nodes] Reset",e.Reset=t;class n{constructor(e){this.nodeState=e}}n.type="[Engine Nodes] init nodes",e.InitNodeState=n;class i{constructor(e){this.patches=e}}i.type="[Engine Nodes] patch nodes",e.ApplyPatch=i;class o{constructor(e){this.activeChapterId=e}}o.type="[Engine Nodes] set active chapter",e.SetActiveChapter=o;class s{constructor(e,t){this.originalChapterId=e,this.copyChapterId=t}}s.type="[Engine Nodes] Duplicate node state",e.DuplicateNodeState=s;class r{constructor(e,t,n,i=!0,o=!1){this.show=e,this.objectIds=t,this.patch=n,this.record=i,this.setByTween=o}}r.type="[Engine Nodes] update nodes shown",e.UpdateNodesShown=r;class a{constructor(e){this.objectId=e}}a.type="[Engine Nodes] update nodes selected",e.UpdateNodeSelected=a;class c{constructor(e,t,n){this.checked=e,this.objectIds=t,this.patch=n}}c.type="[Engine Nodes] update nodes checked",e.UpdateNodesChecked=c;class l{constructor(e,t,n){this.pickable=e,this.objectIds=t,this.patch=n}}l.type="[Engine Nodes] update nodes pickable",e.UpdateNodesPickable=l;class p{constructor(e,t,n,i=!0){this.recipe=e,this.objectIds=t,this.patch=n,this.record=i}}p.type="[Engine Nodes] update nodes paint",e.UpdateNodesPaint=p}($n||($n={})),function(e){class t{constructor(){}}t.type="[Undo] Reset",e.Reset=t;class n{constructor(e){this.chapterId=e}}n.type="[Undo] Undo",e.Undo=n;class i{constructor(e){this.chapterId=e}}i.type="[Undo] Undo All",e.UndoAll=i;class o{constructor(e){this.chapterId=e}}o.type="[Undo] Redo",e.Redo=o;class s{constructor(e){this.patches=e}}s.type="[Undo] Store Patches",e.SavePatches=s}(qn||(qn={}));class Gn{constructor(e={center:[0,0,0],edge:[1,1,1],centerBias:1,edgeBias:0,power:1}){const{edge:t,center:n,centerBias:i,edgeBias:o,power:s}=e;this.edge=t,this.center=n,this.centerBias=i,this.edgeBias=o,this.power=s}static toEngine(e){const{center:t,edge:n,centerBias:i,edgeBias:o,power:s}=e;return[[...t],[...n],i,o,s]}}class Zn{constructor(e={center:0,edge:1,centerBias:1,edgeBias:0,power:1}){const{edge:t,center:n,centerBias:i,edgeBias:o,power:s}=e;this.edge=t,this.center=n,this.centerBias=i,this.edgeBias=o,this.power=s}static toEngine(e){const{center:t,edge:n,centerBias:i,edgeBias:o,power:s}=e;return[t,n,i,o,s]}}function Jn(e,t){switch(!0){case void 0===e[t]:return;case!1===e[t]:return!1;case"number"==typeof e[t]:return 100*e[t];default:return new Zn({center:e[t][0],edge:e[t][1],centerBias:e[t][2],edgeBias:e[t][3],power:e[t][4]})}}class Xn{constructor(e={}){const{tintColor:t,saturation:n,contrast:i,brightness:o,opacity:s}=e;this.tintColor=t,this.saturation=n,this.contrast=i,this.brightness=o,this.opacity=s}static fromEngine(e){const t=(()=>{switch(!0){case void 0===e.tintColor:return;case!1===e.tintColor:return!1;case Array.isArray(e.tintColor):return 3===e.tintColor.length?[...e.tintColor]:new Gn({center:e.tintColor[0],edge:e.tintColor[1],centerBias:e.tintColor[2],edgeBias:e.tintColor[3],power:e.tintColor[4]})}})();return new Xn({tintColor:t,saturation:Jn(e,"saturation"),brightness:Jn(e,"brightness"),contrast:Jn(e,"contrast"),opacity:Jn(e,"opacity")})}static toEngine(e){let t=!1!==e.tintColor&&void 0,n=!1!==e.saturation&&void 0,i=!1!==e.brightness&&void 0,o=!1!==e.contrast&&void 0,s=!1!==e.opacity&&void 0;return Array.isArray(e.tintColor)?t=[...e.tintColor]:e.tintColor&&e.tintColor instanceof Gn&&(t=Gn.toEngine(e.tintColor)),"number"==typeof e.saturation?n=e.saturation/100:e.saturation instanceof Zn&&(n=Zn.toEngine(e.saturation)),"number"==typeof e.brightness?i=e.brightness/100:e.brightness instanceof Zn&&(i=Zn.toEngine(e.brightness)),"number"==typeof e.contrast?o=e.contrast/100:e.contrast instanceof Zn&&(o=Zn.toEngine(e.contrast)),"number"==typeof e.opacity?s=e.opacity/100:e.opacity instanceof Zn&&(s=Zn.toEngine(e.opacity)),{tintColor:t,saturation:n,brightness:i,contrast:o,opacity:s}}static mergeRecipes(e,t){const n=Object.assign({},e);for(const[i,o]of Object.entries(t))void 0!==o&&(n[i]=o);return n}}var Yn,ei=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},ti=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const ni={activeChapterId:void 0,nodeState:void 0,patches:[],patchesForChapter:{}};let ii=(()=>{let e=Yn=class{constructor(){}static getAllNodeState(e){return e.nodeState}static getActiveChapter(e){return e.activeChapterId}static getPatches(e){return e.patches}static getNodes(e){return void 0===e.activeChapterId||void 0===e.nodeState?{}:e.nodeState[e.activeChapterId]||{}}static getNodePaint(e){return t=>e.nodeState[e.activeChapterId][t].paint}static getNodeIds(e){return Object.keys(Yn.getNodes(e))}static getCheckedNodeIds(e){return Object.values(Yn.getNodes(e)).filter(e=>e.checked).map(e=>e.objectId)}static getCheckedNodes(e){return Yn.getCheckedNodeIds(e).map(t=>e.nodeState[e.activeChapterId][t])}static getUncheckedNodeIds(e){return Yn.getNodeIds(e).filter(t=>!e.nodeState[e.activeChapterId][t].checked)}static getSelectedNode(e){const t=Yn.getNodeIds(e).find(t=>e.nodeState[e.activeChapterId][t].selected);return t?e.nodeState[e.activeChapterId][t]:void 0}reset(e,t){e.patchState(immer.produce(e.getState(),e=>{e.activeChapterId=void 0,e.nodeState=void 0,e.patches=[],e.patchesForChapter={}}))}applyPatch(e,t){const n=immer.applyPatches(e.getState(),t.patches),i=immer.produce(n,e=>{e.patchesForChapter[e.activeChapterId].push(...t.patches),e.patches=t.patches});e.patchState(i)}initNodeState(e,t){e.patchState({nodeState:t.nodeState})}setActiveChapter(e,t){const n=e.getState(),i=immer.produce(n,e=>{e.activeChapterId=t.activeChapterId,e.patchesForChapter[t.activeChapterId]=e.patchesForChapter[t.activeChapterId]||[],e.patches=e.patchesForChapter[t.activeChapterId]});e.patchState(i)}duplicateNodeState(e,t){const n=e.getState(),i=immer.produce(n,e=>{e.nodeState[t.copyChapterId]=e.nodeState[t.originalChapterId],e.patchesForChapter[t.copyChapterId]=e.patchesForChapter[t.originalChapterId].map(e=>(e.path[1]=t.copyChapterId,e))});e.patchState(i)}updateNodesShown(e,t){const n=e.getState(),{finalState:i,patches:o,inversePatches:s}=Kn(n,t);e.patchState(i),t.record&&e.dispatch(new qn.SavePatches([{forward:o,inverse:s,patchAction:$n.ApplyPatch}]))}updateNodesSelected(e,t){const n=e.getState(),i=immer.produce(n,e=>{const n=e.nodeState[e.activeChapterId],i=Object.keys(n);switch(t.objectId){case void 0:i.forEach(e=>n[e].selected=!1);break;default:i.forEach(e=>n[e].selected=!1),n[t.objectId].selected=!0}});e.patchState(i)}updateNodesChecked(e,t){const n=e.getState(),[i,o,s]=immer.produceWithPatches(n,e=>{const n=e.nodeState[e.activeChapterId];switch(t.patch){case void 0:(t.objectIds||Object.keys(n)).forEach(e=>{n[e].checked=t.checked,t.objectIds&&Wn(e,n,"checked",t.checked)});break;default:Object.entries(t.patch).forEach(([e,t])=>n[e].checked=t)}}),r=immer.produce(i,e=>{e.patches=o});e.patchState(r)}updateNodesPickable(e,t){const n=e.getState(),[i,o,s]=immer.produceWithPatches(n,e=>{const n=e.nodeState[e.activeChapterId];t.patch?Object.entries(t.patch).forEach(([e,t])=>n[e].pickable=t):(t.objectIds||Object.keys(n)).forEach(e=>{n[e].pickable=t.pickable,t.objectIds&&Wn(e,n,"pickable",t.pickable)})}),r=immer.produce(i,e=>{e.patches=o,e.patchesForChapter[e.activeChapterId].push(...o)});e.patchState(r),e.dispatch(new qn.SavePatches([{forward:o,inverse:s,patchAction:$n.ApplyPatch}]))}updateNodesPaint(e,t){const n=e.getState(),[i,o,s]=immer.produceWithPatches(n,e=>{const n=e.nodeState[e.activeChapterId],i=t.objectIds||Object.keys(n);t.patch?Object.entries(t.patch).forEach(([e,t])=>{const i=Xn.mergeRecipes(n[e].paint,t);n[e].paint=i}):i.forEach(e=>{const i=Xn.mergeRecipes(n[e].paint,t.recipe);n[e].paint=i,t.objectIds&&Wn(e,n,"paint",i)})}),r=immer.produce(i,e=>{e.patches=o,e.patchesForChapter[e.activeChapterId].push(...o)});e.patchState(r),t.record&&e.dispatch(new qn.SavePatches([{forward:o,inverse:s,patchAction:$n.ApplyPatch}]))}};return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac}),ei([Object(d.a)($n.Reset),ti("design:type",Function),ti("design:paramtypes",[Object,$n.Reset]),ti("design:returntype",void 0)],e.prototype,"reset",null),ei([Object(d.a)($n.ApplyPatch),ti("design:type",Function),ti("design:paramtypes",[Object,$n.ApplyPatch]),ti("design:returntype",void 0)],e.prototype,"applyPatch",null),ei([Object(d.a)($n.InitNodeState),ti("design:type",Function),ti("design:paramtypes",[Object,$n.InitNodeState]),ti("design:returntype",void 0)],e.prototype,"initNodeState",null),ei([Object(d.a)($n.SetActiveChapter),ti("design:type",Function),ti("design:paramtypes",[Object,$n.SetActiveChapter]),ti("design:returntype",void 0)],e.prototype,"setActiveChapter",null),ei([Object(d.a)($n.DuplicateNodeState),ti("design:type",Function),ti("design:paramtypes",[Object,$n.DuplicateNodeState]),ti("design:returntype",void 0)],e.prototype,"duplicateNodeState",null),ei([Object(d.a)($n.UpdateNodesShown),ti("design:type",Function),ti("design:paramtypes",[Object,$n.UpdateNodesShown]),ti("design:returntype",void 0)],e.prototype,"updateNodesShown",null),ei([Object(d.a)($n.UpdateNodeSelected),ti("design:type",Function),ti("design:paramtypes",[Object,$n.UpdateNodeSelected]),ti("design:returntype",void 0)],e.prototype,"updateNodesSelected",null),ei([Object(d.a)($n.UpdateNodesChecked),ti("design:type",Function),ti("design:paramtypes",[Object,$n.UpdateNodesChecked]),ti("design:returntype",void 0)],e.prototype,"updateNodesChecked",null),ei([Object(d.a)($n.UpdateNodesPickable),ti("design:type",Function),ti("design:paramtypes",[Object,$n.UpdateNodesPickable]),ti("design:returntype",void 0)],e.prototype,"updateNodesPickable",null),ei([Object(d.a)($n.UpdateNodesPaint),ti("design:type",Function),ti("design:paramtypes",[Object,$n.UpdateNodesPaint]),ti("design:returntype",void 0)],e.prototype,"updateNodesPaint",null),ei([Object(d.e)(),ti("design:type",Function),ti("design:paramtypes",[Qn]),ti("design:returntype",void 0)],e,"getAllNodeState",null),ei([Object(d.e)(),ti("design:type",Function),ti("design:paramtypes",[Qn]),ti("design:returntype",void 0)],e,"getActiveChapter",null),ei([Object(d.e)(),ti("design:type",Function),ti("design:paramtypes",[Qn]),ti("design:returntype",void 0)],e,"getPatches",null),ei([Object(d.e)(),ti("design:type",Function),ti("design:paramtypes",[Qn]),ti("design:returntype",void 0)],e,"getNodes",null),ei([Object(d.e)(),ti("design:type",Function),ti("design:paramtypes",[Qn]),ti("design:returntype",void 0)],e,"getNodePaint",null),ei([Object(d.e)(),ti("design:type",Function),ti("design:paramtypes",[Qn]),ti("design:returntype",void 0)],e,"getNodeIds",null),ei([Object(d.e)(),ti("design:type",Function),ti("design:paramtypes",[Qn]),ti("design:returntype",void 0)],e,"getCheckedNodeIds",null),ei([Object(d.e)(),ti("design:type",Function),ti("design:paramtypes",[Qn]),ti("design:returntype",void 0)],e,"getCheckedNodes",null),ei([Object(d.e)(),ti("design:type",Function),ti("design:paramtypes",[Qn]),ti("design:returntype",void 0)],e,"getUncheckedNodeIds",null),ei([Object(d.e)(),ti("design:type",Function),ti("design:paramtypes",[Qn]),ti("design:returntype",void 0)],e,"getSelectedNode",null),e=Yn=ei([Object(d.f)({name:"engineNodes",defaults:ni})],e),e})();class oi{constructor(e,t,n="_color",i){this.label=e,this.recipe=t,this.icon=n,this.group=i}}var si=function(e){return e.Colors="Colors",e.Effects="Effects",e}({}),ri=function(e){return e.Colors="_color",e.Effects="adjust",e}({});const ai=new oi("Original",new Xn({tintColor:!1,saturation:!1,contrast:!1,brightness:!1,opacity:!1}),"times-circle",si.Colors),ci=new oi("Black",{tintColor:[0,0,0],saturation:!1,contrast:!1,brightness:!1,opacity:!1},ri.Colors,si.Colors),li=new oi("Red",{tintColor:[1,0,0],saturation:!1,contrast:!1,brightness:!1,opacity:!1},ri.Colors,si.Colors),pi=new oi("Yellow",new Xn({tintColor:[1,1,0],saturation:!1,contrast:!1,brightness:!1,opacity:!1}),ri.Colors,si.Colors),di=new oi("Green",new Xn({tintColor:[0,1,0],saturation:!1,contrast:!1,brightness:!1,opacity:!1}),ri.Colors,si.Colors),ui=new oi("Cyan",new Xn({tintColor:[0,1,1],saturation:!1,contrast:!1,brightness:!1,opacity:!1}),ri.Colors,si.Colors),gi=new oi("Blue",new Xn({tintColor:[0,0,1],saturation:!1,contrast:!1,brightness:!1,opacity:!1}),ri.Colors,si.Colors),hi=new oi("Pink",new Xn({tintColor:[1,0,1],saturation:!1,contrast:!1,brightness:!1,opacity:!1}),ri.Colors,si.Colors),bi=(new oi("Grayscale",new Xn({tintColor:!1,saturation:-100,contrast:!1,brightness:!1,opacity:!1}),ri.Effects,si.Effects),new oi("Desaturated",new Xn({tintColor:!1,saturation:-50,contrast:!1,brightness:!1,opacity:!1}),ri.Effects,si.Effects),new oi("Fade",new Xn({tintColor:[0,0,0],contrast:!1,brightness:55,saturation:-100,opacity:new Zn({edge:1,center:0,edgeBias:0,centerBias:1,power:1})}),ri.Effects,si.Effects)),mi=[ci,li,pi,di,ui,gi,hi];class fi{constructor(e={}){const{tintColor:t,saturation:n,contrast:i,brightness:o,opacity:s}=e;this.tintColor=t,this.saturation=n,this.contrast=i,this.brightness=o,this.opacity=s}static isFresnel(e){return Array.isArray(e)&&5===e.length}static isColor(e){return Array.isArray(e)&&3===e.length}}function yi(e,t,n){const i=Ye.getSuccessors(e,t);if(0===i.length)return!1;for(const o of i)if(!0===n[o])return!0;return i.some(t=>yi(e,t,n))}function xi(e,t,n){switch(n[t]){case!0:return!0;case!1:return!1;case void 0:{const i=Ye.getAncestor(e,t);return!!i&&xi(e,i,n)}}}var vi,wi,Oi;!function(e){class t{constructor(e,t,n){this.particleSystems=e,this.assignedParticles=t,this.tweenParticleLookup=n}}t.type="[Engine Particles] Set Particle State",e.SetParticleState=t;class n{constructor(e,t){this.particleSystem=e,this.chapterId=t}}n.type="[Engine Particles] New Particle System",e.NewParticleSystem=n;class i{constructor(e,t){this.id=e,this.targetChapterId=t}}i.type="[Engine Particles] Duplicate Particle System",e.DuplicateParticleSystem=i;class o{constructor(e,t){this.id=e,this.targetChapterId=t}}o.type="[Engine Particles] Duplicate Particle System Success",e.DuplicateParticleSystemSuccess=o;class s{constructor(e,t){this.id=e,this.particleSystem=t}}s.type="[Engine Particles] Update Particle System",e.UpdateParticleSystem=s;class r{constructor(e,t){this.oldId=e,this.newId=t}}r.type="[Engine Particles] Set Particle System Id",e.SetParticleSystemId=r;class a{constructor(e,t){this.visible=e,this.chapterId=t}}a.type="[Engine Particles] Set Particle Systems Visible",e.SetParticleSystemsVisible=a;class c{constructor(e,t,n){this.id=e,this.visible=t,this.chapterId=n}}c.type="[Engine Particles] Set Particle System Visible",e.SetParticleSystemVisible=c;class l{constructor(e,t){this.id=e,this.chapterId=t}}l.type="[Engine Particles] Assign Particle",e.AssignParticle=l;class p{constructor(e,t){this.id=e,this.chapterId=t}}p.type="[Engine Particles] Unassign Particle",e.UnassignParticle=p;class d{constructor(e){this.id=e}}d.type="[Engine Partiles] Delete Particle System",e.DeleteParticleSystem=d;class u{constructor(e){this.id=e}}u.type="[Engine Partiles] Select Particle System",e.SelectParticleSystem=u;class g{constructor(e){this.index=e}}g.type="[Engine Partiles] Select Particle Constraint",e.SelectParticleConstraint=g;class h{constructor(e){this.index=e}}h.type="[Engine Partiles] Select Particle Creator",e.SelectParticleCreator=h;class b{constructor(e){this.index=e}}b.type="[Engine Partiles] Select Particle Updater",e.SelectParticleUpdater=b;class m{constructor(e){this.chapterMap=e}}m.type="[Engine Particles] Update Lookup Chapters",e.UpdateTweenParticleLookupChapters=m;class f{constructor(e,t){this.chapterId=e,this.lookup=t}}f.type="[Engine Particles] Set Lookup for chapter",e.SetLookupForChapter=f;class y{constructor(e){this.chapterId=e}}y.type="[Engine Particles] Delete chapter lookup",e.DeleteChapterLookup=y;class x{constructor(e){this.patches=e}}x.type="[Engine Particles] Apply Patch",e.ApplyPatch=x}(vi||(vi={})),function(e){e.updateChapterIds=function(e,t){return Object.keys(e).reduce((n,i)=>(n[t[i]]=e[i],n),{})},e.duplicateChapter=function(e,t,n){return Object.assign(Object.assign({},n),{[t]:n[e]})},e.deleteChapter=function(e,t){const n=Object.assign({},t);return delete n[e],n},e.addEntryForChapter=function(e,t,n){return n[e]=Object.assign(Object.assign({},n[e]),t),n},e.refreshEngineLookup=function(e,t){Human.modules.moduleData[e].tweenParticleLookup=t}}(wi||(wi={})),function(e){function t(e){return e.split("-")[0].replace(/_particle$/,"")}e.getParticleIdRoot=t,e.generateParticleId=function(e,n=Un.getUuid){return`${t(e)}-${n()}`}}(Oi||(Oi={}));var Ci,Si=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},ki=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let _i=(()=>{let e=Ci=class{constructor(){}static particleSystemIdExists(e){return Object(d.h)([Ci],t=>void 0!==t.particleSystems[e])}static particleSystemsForChapter(e){return Object(d.h)([Ci],t=>(t.assignedParticles[e]||[]).map(e=>t.particleSystems[e]))}static getVisibleParticleSystesmForChapter(e){return Object(d.h)([Ci],t=>{const n=t.visibleParticleSystems[e]||{};return(t.assignedParticles[e]||[]).filter(e=>!1!==n[e])})}static getTweenParticleLookup(e){return e.tweenParticleLookup}static getParticleSystems(e){return e.particleSystems}static getVisisbleParticleSystems(e){return e.visibleParticleSystems}static getParticleSystemsList(e){return Object.values(e.particleSystems)}static getAssignedParticleSystems(e){return e.assignedParticles}static getSelectedParticleSystemId(e){return e.particleSelection.selectedParticle}static getSelectedParticleSystem(e){const{particleSystems:t,particleSelection:n}=e;return t[n.selectedParticle]}static getSelectedParticleConstraintIndex(e){return e.particleSelection.selectedConstraint}static getSelectedParticleConstraint(e){const t=Ci.getSelectedParticleSystem(e);return t?t.constraints[e.particleSelection.selectedConstraint]:null}static getSelectedParticleCreatorIndex(e){return e.particleSelection.selectedCreator}static getSelectedParticleCreator(e){const t=Ci.getSelectedParticleSystem(e);return t?t.creators[e.particleSelection.selectedCreator]:null}static getSelectedParticleUpdaterIndex(e){return e.particleSelection.selectedUpdater}static getSelectedParticleUpdater(e){const t=Ci.getSelectedParticleSystem(e);return t?t.updaters[e.particleSelection.selectedUpdater]:null}applyPatch(e,t){const n=immer.applyPatches(e.getState(),t.patches);e.patchState(n)}setParticleState(e,t){e.patchState(immer.produce(e.getState(),e=>{e.particleSystems=t.particleSystems.reduce((e,t)=>(e[t.id]=t,e),{}),e.assignedParticles=t.assignedParticles,e.tweenParticleLookup=t.tweenParticleLookup,e.visibleParticleSystems={}}))}setParticlesVisible(e,{visible:t,chapterId:n}){e.patchState(immer.produce(e.getState(),e=>{const i=(e.assignedParticles[n]||[]).reduce((e,n)=>(e[n]=t,e),{});e.visibleParticleSystems=Object.assign(Object.assign({},e.visibleParticleSystems),{[n]:i})}))}setParticleVisible(e,{id:t,visible:n,chapterId:i}){e.patchState(immer.produce(e.getState(),e=>{e.visibleParticleSystems[i]=Object.assign(Object.assign({},e.visibleParticleSystems[i]||{}),{[t]:n})}))}newParticleSystem(e,t){const{particleSystem:n,chapterId:i}=t,o=n.id,[s,r,a]=immer.produceWithPatches(e.getState(),e=>{e.particleSystems[o]=n,e.assignedParticles[i]=[...e.assignedParticles[i]||[],o]});e.patchState(s)}setParticleSystemId(e,t){void 0!==e.getState().particleSystems[t.newId]||e.patchState(immer.produce(e.getState(),e=>{e.particleSelection.selectedParticle=e.particleSelection.selectedParticle===t.oldId?t.newId:e.particleSelection.selectedParticle,e.particleSystems[t.newId]=Object.assign(Object.assign({},e.particleSystems[t.oldId]),{id:t.newId}),delete e.particleSystems[t.oldId],Object.entries(e.assignedParticles).forEach(([n,i])=>{e.assignedParticles[n]=i.map(e=>e===t.oldId?t.newId:e)}),Object.entries(e.tweenParticleLookup).forEach(([n,i])=>{e.tweenParticleLookup[n]=Object(X.mapValues)(i,(e,n,i)=>e===t.oldId?t.newId:e)})}))}duplicateParticleSystem(e,t){const{id:n,targetChapterId:i}=t,o=Oi.generateParticleId(n);e.patchState(immer.produce(e.getState(),e=>{e.particleSystems[o]=JSON.parse(JSON.stringify(e.particleSystems[n])),e.particleSystems[o].id=o,e.assignedParticles[i].push(o);const t=Oi.getParticleIdRoot(n);e.tweenParticleLookup[i]&&e.tweenParticleLookup[i][t]&&(e.tweenParticleLookup=wi.addEntryForChapter(i,{[t]:o},e.tweenParticleLookup))})),e.dispatch(new vi.DuplicateParticleSystemSuccess(o,i))}updateParticleSystem(e,t){const n=immer.produce(e.getState(),e=>{e.particleSystems[t.id]=t.particleSystem});e.patchState(Object.assign(Object.assign({},n),{particleSystems:Object.assign({},n.particleSystems)}))}deleteChapterLookup(e,t){e.patchState(immer.produce(e.getState(),e=>{delete e.tweenParticleLookup[t.chapterId]}))}setLookupForChapter(e,t){e.patchState(immer.produce(e.getState(),e=>{e.tweenParticleLookup[t.chapterId]=t.lookup}))}assignParticle(e,t){e.patchState(immer.produce(e.getState(),e=>{const n=e.assignedParticles[t.chapterId]||[],i=Oi.getParticleIdRoot(t.id);e.assignedParticles[t.chapterId]=n.concat(t.id),e.tweenParticleLookup=wi.addEntryForChapter(t.chapterId,{[i]:t.id},e.tweenParticleLookup),e.particleSystems=Object.assign({},e.particleSystems)}))}unassignParticle(e,t){e.patchState(immer.produce(e.getState(),e=>{const n=e.assignedParticles[t.chapterId]||[],i=Oi.getParticleIdRoot(t.id);e.assignedParticles[t.chapterId]=n.filter(e=>e!==t.id),e.tweenParticleLookup[t.chapterId]&&delete e.tweenParticleLookup[t.chapterId][i],e.particleSystems=Object.assign({},e.particleSystems)}))}deleteParticleSystem(e,t){e.patchState(immer.produce(e.getState(),e=>{delete e.particleSystems[t.id],Object.keys(e.assignedParticles).forEach(n=>{e.assignedParticles[n]=e.assignedParticles[n].filter(e=>e!==t.id)}),Object.keys(e.tweenParticleLookup).forEach(n=>{delete e.tweenParticleLookup[n][Oi.getParticleIdRoot(t.id)]})}))}selectParticleSystem(e,t){e.patchState(immer.produce(e.getState(),e=>{e.particleSelection={selectedParticle:t.id}}))}selectParticleConstraint(e,t){const n=e.getState().particleSelection;e.patchState(immer.produce(e.getState(),e=>{e.particleSelection=Object.assign(Object.assign({},n),{selectedConstraint:t.index})}))}selectParticleCreator(e,t){const n=e.getState().particleSelection;e.patchState(immer.produce(e.getState(),e=>{e.particleSelection=Object.assign(Object.assign({},n),{selectedCreator:t.index})}))}selectParticleUpdater(e,t){const n=e.getState().particleSelection;e.patchState(immer.produce(e.getState(),e=>{e.particleSelection=Object.assign(Object.assign({},n),{selectedUpdater:t.index})}))}updateTweenParticleLookupChapters(e,t){e.patchState(immer.produce(e.getState(),e=>{e.tweenParticleLookup=wi.updateChapterIds(e.tweenParticleLookup,t.chapterMap)}))}};return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac}),Si([Object(d.a)(vi.ApplyPatch),ki("design:type",Function),ki("design:paramtypes",[Object,vi.ApplyPatch]),ki("design:returntype",void 0)],e.prototype,"applyPatch",null),Si([Object(d.a)(vi.SetParticleState),ki("design:type",Function),ki("design:paramtypes",[Object,vi.SetParticleState]),ki("design:returntype",void 0)],e.prototype,"setParticleState",null),Si([Object(d.a)(vi.SetParticleSystemsVisible),ki("design:type",Function),ki("design:paramtypes",[Object,vi.SetParticleSystemsVisible]),ki("design:returntype",void 0)],e.prototype,"setParticlesVisible",null),Si([Object(d.a)(vi.SetParticleSystemVisible),ki("design:type",Function),ki("design:paramtypes",[Object,vi.SetParticleSystemVisible]),ki("design:returntype",void 0)],e.prototype,"setParticleVisible",null),Si([Object(d.a)(vi.NewParticleSystem),ki("design:type",Function),ki("design:paramtypes",[Object,vi.NewParticleSystem]),ki("design:returntype",void 0)],e.prototype,"newParticleSystem",null),Si([Object(d.a)(vi.SetParticleSystemId),ki("design:type",Function),ki("design:paramtypes",[Object,vi.SetParticleSystemId]),ki("design:returntype",void 0)],e.prototype,"setParticleSystemId",null),Si([Object(d.a)(vi.DuplicateParticleSystem),ki("design:type",Function),ki("design:paramtypes",[Object,vi.DuplicateParticleSystem]),ki("design:returntype",void 0)],e.prototype,"duplicateParticleSystem",null),Si([Object(d.a)(vi.UpdateParticleSystem),ki("design:type",Function),ki("design:paramtypes",[Object,vi.UpdateParticleSystem]),ki("design:returntype",void 0)],e.prototype,"updateParticleSystem",null),Si([Object(d.a)(vi.DeleteChapterLookup),ki("design:type",Function),ki("design:paramtypes",[Object,vi.DeleteChapterLookup]),ki("design:returntype",void 0)],e.prototype,"deleteChapterLookup",null),Si([Object(d.a)(vi.SetLookupForChapter),ki("design:type",Function),ki("design:paramtypes",[Object,vi.SetLookupForChapter]),ki("design:returntype",void 0)],e.prototype,"setLookupForChapter",null),Si([Object(d.a)(vi.AssignParticle),ki("design:type",Function),ki("design:paramtypes",[Object,vi.AssignParticle]),ki("design:returntype",void 0)],e.prototype,"assignParticle",null),Si([Object(d.a)(vi.UnassignParticle),ki("design:type",Function),ki("design:paramtypes",[Object,vi.UnassignParticle]),ki("design:returntype",void 0)],e.prototype,"unassignParticle",null),Si([Object(d.a)(vi.DeleteParticleSystem),ki("design:type",Function),ki("design:paramtypes",[Object,vi.DeleteParticleSystem]),ki("design:returntype",void 0)],e.prototype,"deleteParticleSystem",null),Si([Object(d.a)(vi.SelectParticleSystem),ki("design:type",Function),ki("design:paramtypes",[Object,vi.SelectParticleSystem]),ki("design:returntype",void 0)],e.prototype,"selectParticleSystem",null),Si([Object(d.a)(vi.SelectParticleConstraint),ki("design:type",Function),ki("design:paramtypes",[Object,vi.SelectParticleConstraint]),ki("design:returntype",void 0)],e.prototype,"selectParticleConstraint",null),Si([Object(d.a)(vi.SelectParticleCreator),ki("design:type",Function),ki("design:paramtypes",[Object,vi.SelectParticleCreator]),ki("design:returntype",void 0)],e.prototype,"selectParticleCreator",null),Si([Object(d.a)(vi.SelectParticleUpdater),ki("design:type",Function),ki("design:paramtypes",[Object,vi.SelectParticleUpdater]),ki("design:returntype",void 0)],e.prototype,"selectParticleUpdater",null),Si([Object(d.a)(vi.UpdateTweenParticleLookupChapters),ki("design:type",Function),ki("design:paramtypes",[Object,vi.UpdateTweenParticleLookupChapters]),ki("design:returntype",void 0)],e.prototype,"updateTweenParticleLookupChapters",null),Si([Object(d.e)(),ki("design:type",Function),ki("design:paramtypes",[Object]),ki("design:returntype",void 0)],e,"getTweenParticleLookup",null),Si([Object(d.e)(),ki("design:type",Function),ki("design:paramtypes",[Object]),ki("design:returntype",void 0)],e,"getParticleSystems",null),Si([Object(d.e)(),ki("design:type",Function),ki("design:paramtypes",[Object]),ki("design:returntype",void 0)],e,"getVisisbleParticleSystems",null),Si([Object(d.e)(),ki("design:type",Function),ki("design:paramtypes",[Object]),ki("design:returntype",void 0)],e,"getParticleSystemsList",null),Si([Object(d.e)(),ki("design:type",Function),ki("design:paramtypes",[Object]),ki("design:returntype",void 0)],e,"getAssignedParticleSystems",null),Si([Object(d.e)(),ki("design:type",Function),ki("design:paramtypes",[Object]),ki("design:returntype",void 0)],e,"getSelectedParticleSystemId",null),Si([Object(d.e)(),ki("design:type",Function),ki("design:paramtypes",[Object]),ki("design:returntype",void 0)],e,"getSelectedParticleSystem",null),Si([Object(d.e)(),ki("design:type",Function),ki("design:paramtypes",[Object]),ki("design:returntype",void 0)],e,"getSelectedParticleConstraintIndex",null),Si([Object(d.e)(),ki("design:type",Function),ki("design:paramtypes",[Object]),ki("design:returntype",void 0)],e,"getSelectedParticleConstraint",null),Si([Object(d.e)(),ki("design:type",Function),ki("design:paramtypes",[Object]),ki("design:returntype",void 0)],e,"getSelectedParticleCreatorIndex",null),Si([Object(d.e)(),ki("design:type",Function),ki("design:paramtypes",[Object]),ki("design:returntype",void 0)],e,"getSelectedParticleCreator",null),Si([Object(d.e)(),ki("design:type",Function),ki("design:paramtypes",[Object]),ki("design:returntype",void 0)],e,"getSelectedParticleUpdaterIndex",null),Si([Object(d.e)(),ki("design:type",Function),ki("design:paramtypes",[Object]),ki("design:returntype",void 0)],e,"getSelectedParticleUpdater",null),e=Ci=Si([Object(d.f)({name:"engineParticles",defaults:{particleSelection:{},particleSystems:{},visibleParticleSystems:{},assignedParticles:{},tweenParticleLookup:{}}})],e),e})();var ji;!function(e){class t{constructor(e){this.quizState=e}}t.type="[Quiz] Set Quiz State",e.SetQuizState=t;class n{constructor(){}}n.type="[Quiz] Reset Quiz State",e.ResetQuizState=n;class i{constructor(e){this.quizSettings=e}}i.type="[Quiz] Set Quiz Settings",e.SetQuizSettings=i;class o{constructor(e){this.active=e}}o.type="[Quiz] Set Quiz Active",e.SetQuizActive=o;class s{constructor(e){this.enabled=e}}s.type="[Quiz] Set Quiz Enabled",e.SetQuizEnabled=s;class r{constructor(e){this.locked=e}}r.type="[Quiz] Set Quiz Locked",e.SetQuizLocked=r;class a{constructor(e){this.mode=e}}a.type="[Quiz] Set Quiz Questions Mode",e.SetQuizQuestionsMode=a;class c{constructor(e,t){this.sourceChapterId=e,this.targetChapterId=t}}c.type="[Quiz] Copy Quiz Questions",e.CopyQuestions=c;class l{constructor(e){this.chapterIds=e}}l.type="[Quiz] Reoder Quiz Questions",e.ReorderQuestions=l;class p{constructor(e){this.question=e}}p.type="[Quiz] Add Quiz Question",e.AddQuestion=p;class d{constructor(e){this.id=e}}d.type="[Quiz] Delete Quiz Question",e.DeleteQuestion=d;class u{constructor(e){this.questions=e}}u.type="[Quiz] Set Quiz Questions",e.SetQuestions=u;class g{constructor(e){this.question=e}}g.type="[Quiz] Set Quiz Question",e.SetQuestion=g;class h{constructor(e){this.submission=e}}h.type="[Quiz] Submit Question Answer",e.SubmitQuestionAnswer=h;class b{constructor(){}}b.type="[Quiz] Advance Question",e.NextQuestion=b;class m{constructor(){}}m.type="[Quiz] Previous Question",e.PreviousQuestion=m;class f{constructor(){}}f.type="[Quiz] Clear Submissions",e.ClearSubmissions=f;class y{constructor(e){this.questionId=e}}y.type="[Quiz] Set Active Question",e.SetActiveQuestion=y;class x{constructor(e){this.pickMode=e}}x.type="[Quiz] Set Pick Mode",e.SetQuizPickMode=x;class v{constructor(e){this.submission=e}}v.type="[Quiz] Set Active QuestionAnswer",e.SetActiveSubmission=v;class w{constructor(e){this.lifecycle=e}}w.type="[Quiz] Set Quiz Lifecycle",e.SetQuizLifecycle=w}(ji||(ji={}));var Pi=function(e){return e.Markdown="markdown",e.Images="images",e.Ticker="ticker",e}({}),Mi=function(e){return e.MultipleChoice="multiple-choice",e.SelectAnatomy="select-anatomy",e.LabelAnatomy="label-anatomy",e.Instructions="text-only",e}({});const Ii={[Mi.MultipleChoice]:"Multiple Choice",[Mi.SelectAnatomy]:"Select Anatomy in 3D",[Mi.LabelAnatomy]:"Label Anatomy",[Mi.Instructions]:"Instructions"};function zi(e){const t=e.map(e=>(e.quizQuestions||[]).map(t=>Object.assign(Object.assign({},t),{chapterId:t.chapterId||e.id})));return[].concat(...t)}function Ti(e,t){const n="string"==typeof e.data.correctAnswer?[e.data.correctAnswer]:e.data.correctAnswer;switch(e.type){case Mi.LabelAnatomy:return Object(X.isEqual)(n,t);case Mi.MultipleChoice:case Mi.SelectAnatomy:return Object(X.isEqual)(n.sort(),t.sort())}}function Ui(e,t){const n=e.filter(e=>e.type!==Mi.Instructions),i=e.reduce((e,n)=>(e[n.id]=function(e,t){const n=e.find(e=>e.questionId===t);return n?n.answer:void 0}(t,n.id),e),{}),o=n.filter(e=>{const t=i[e.id];return Ti(e,void 0===t?[]:"string"==typeof t?[t]:t)}),s=e.length,r=n.length,a=o.length,c=s-a;return{score:s>0?Math.round(a/r*100):0,total:s,scorableTotal:r,correctTotal:a,incorrectTotal:c,questionAnswers:i}}var Li,Di=function(e){return e[e.Question=0]="Question",e[e.Explanation=1]="Explanation",e[e.Review=2]="Review",e}({}),Ei=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},Fi=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Ai=function(e){return e[e.Learning=0]="Learning",e[e.Assessment=1]="Assessment",e}({});const Ri={quizModeActive:!1,quizModeLocked:!1,quizQuestionsMode:"all",launchMode:Ai.Learning,questions:[],activeQuestionId:void 0,activeSubmission:void 0,questionSubmissions:[],quizSettings:{enabled:!0,showSummary:!0,showExplanation:!0,showSubmit:!0,showProgress:!0},pickMode:"single",lifecycle:Di.Question};function Ni(e,t){return e.filter(e=>e.chapterId===t)}function Vi(e,t){const n=t.map(t=>Ni(e,t));return[].concat(...n)}function Hi(e){const t=function(e){return[...new Set(e.map(e=>e.chapterId))]}(e);return Vi(e,t)}let Bi=(()=>{let e=Li=class{static getQuizQuestionsByChapter(e){return Object(d.h)([Li],t=>Ni(t.questions,e))}static getLifecycle(e){return e.lifecycle}static getQuizSettings(e){return e.quizSettings}static getQuizModeActive(e){return e.quizModeActive}static getQuizModeLocked(e){return e.quizModeLocked}static getQuizReviewEnabled(e){const{quizModeLocked:t,quizQuestionsMode:n,questions:i,quizSettings:o}=e;return!(t&&!o.showSummary||t&&"restricted"===n&&1===i.length)}static globalSceneConfig(e){return e.sceneConfig}static hasQuiz(e){return e.questions.length>0}static getQuizEnabled(e){return!1!==e.quizSettings.enabled}static getAllQuestions(e){return e.questions}static getAllSubmissions(e){return e.questionSubmissions}static getActiveSubmitted(e){const{questionSubmissions:t,activeQuestionId:n}=e;return t.find(e=>e.questionId===n)}static getActiveSubmission(e){return e.activeSubmission}static getActiveQuestion(e){return e.questions.find(t=>t.id===e.activeQuestionId)}static getActiveQuestionId(e){return e.activeQuestionId}static getActiveQuestionLabels(e){const t=e.questions.find(t=>t.id===e.activeQuestionId);return t&&t.type===Mi.LabelAnatomy?t.data.options:[]}static getActiveQuestionIndex(e){return e.questions.findIndex(t=>t.id===e.activeQuestionId)}static getQuestionIndex(e){return Object(d.h)([Li],t=>t.questions.findIndex(t=>t.id===e))}static getQuestionTotal(e){return e.questions.length}static getCorrectAnswerTotal(e){const{questionSubmissions:t,questions:n}=e;return t.filter(e=>Ti(n.find(t=>t.id===e.questionId),e.answer)).length}static getQuestionsRemaining(e){const{questions:t,questionSubmissions:n}=e;return t.length-n.length}static hasQuestionRemaining(e){const{questions:t,questionSubmissions:n}=e;return n.length<t.length}static getPickMode(e){return e.pickMode}resetQuizState(e,t){e.setState(Object.assign({},Ri))}setQuizState(e,{quizState:t}){e.setState(Object.assign(Object.assign({},Ri),t))}setQuizSettings(e,{quizSettings:t}){e.patchState({quizSettings:t})}setQuizActive(e,t){e.patchState({quizModeActive:t.active,activeQuestionId:!1===t.active?void 0:e.getState().activeQuestionId})}setQuizEnabled(e,t){const n=e.getState().quizSettings;e.patchState({quizSettings:Object.assign(Object.assign({},n),{enabled:t.enabled})})}setQuizLocked(e,t){e.patchState({quizModeLocked:t.locked})}setQuizQuestionsMode(e,t){e.patchState({quizQuestionsMode:t.mode})}copyQuestions(e,{sourceChapterId:t,targetChapterId:n}){const{questions:i}=e.getState(),o=[...i,...Ni(e.getState().questions,t).map(e=>Object.assign(Object.assign({},JSON.parse(JSON.stringify(e))),{id:Un.idWithPrefix("question"),chapterId:n}))];e.patchState({questions:Hi(o)})}reorderQuestions(e,{chapterIds:t}){e.patchState({questions:Vi(e.getState().questions,t)})}addQuestion(e,t){const n=[...e.getState().questions,t.question];e.patchState({questions:Hi(n)})}deleteQuestion(e,t){const n=e.getState().questions.filter(e=>e.id!==t.id);e.patchState({questions:Hi(n)})}setQuestions(e,{questions:t}){e.patchState({questions:Hi(t)})}setQuestion(e,t){const n=e.getState().questions.map(e=>e.id===t.question.id?t.question:e);e.patchState({questions:n})}submitQuestionAnswer(e,t){const n=[...e.getState().questionSubmissions],i=n.findIndex(e=>e.questionId===t.submission.questionId);i>-1?n[i]=t.submission:n.push(t.submission),e.patchState({questionSubmissions:n})}nextQuestion(e){var t;const{questions:n,activeQuestionId:i}=e.getState(),o=(null===(t=n[e.getState().questions.findIndex(e=>e.id===i)+1])||void 0===t?void 0:t.id)||void 0;void 0!==o&&e.patchState({activeQuestionId:o})}previousQuestion(e){var t;const{questions:n,activeQuestionId:i}=e.getState(),o=(null===(t=n[e.getState().questions.findIndex(e=>e.id===i)-1])||void 0===t?void 0:t.id)||void 0;void 0!==o&&e.patchState({activeQuestionId:o})}clearSubmissions(e){e.patchState({questionSubmissions:[]})}setActiveQuestion(e,t){e.patchState({activeQuestionId:t.questionId})}setQuizPickMode(e,{pickMode:t}){e.patchState({pickMode:t})}setActiveSubmission(e,{submission:t}){e.patchState({activeSubmission:t})}setQuizLifecycle(e,t){e.patchState({lifecycle:t.lifecycle})}};return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac}),Ei([Object(d.a)(ji.ResetQuizState),Fi("design:type",Function),Fi("design:paramtypes",[Object,ji.ResetQuizState]),Fi("design:returntype",void 0)],e.prototype,"resetQuizState",null),Ei([Object(d.a)(ji.SetQuizState),Fi("design:type",Function),Fi("design:paramtypes",[Object,ji.SetQuizState]),Fi("design:returntype",void 0)],e.prototype,"setQuizState",null),Ei([Object(d.a)(ji.SetQuizSettings),Fi("design:type",Function),Fi("design:paramtypes",[Object,ji.SetQuizSettings]),Fi("design:returntype",void 0)],e.prototype,"setQuizSettings",null),Ei([Object(d.a)(ji.SetQuizActive),Fi("design:type",Function),Fi("design:paramtypes",[Object,ji.SetQuizActive]),Fi("design:returntype",void 0)],e.prototype,"setQuizActive",null),Ei([Object(d.a)(ji.SetQuizEnabled),Fi("design:type",Function),Fi("design:paramtypes",[Object,ji.SetQuizEnabled]),Fi("design:returntype",void 0)],e.prototype,"setQuizEnabled",null),Ei([Object(d.a)(ji.SetQuizLocked),Fi("design:type",Function),Fi("design:paramtypes",[Object,ji.SetQuizLocked]),Fi("design:returntype",void 0)],e.prototype,"setQuizLocked",null),Ei([Object(d.a)(ji.SetQuizQuestionsMode),Fi("design:type",Function),Fi("design:paramtypes",[Object,ji.SetQuizQuestionsMode]),Fi("design:returntype",void 0)],e.prototype,"setQuizQuestionsMode",null),Ei([Object(d.a)(ji.CopyQuestions),Fi("design:type",Function),Fi("design:paramtypes",[Object,ji.CopyQuestions]),Fi("design:returntype",void 0)],e.prototype,"copyQuestions",null),Ei([Object(d.a)(ji.ReorderQuestions),Fi("design:type",Function),Fi("design:paramtypes",[Object,ji.ReorderQuestions]),Fi("design:returntype",void 0)],e.prototype,"reorderQuestions",null),Ei([Object(d.a)(ji.AddQuestion),Fi("design:type",Function),Fi("design:paramtypes",[Object,ji.AddQuestion]),Fi("design:returntype",void 0)],e.prototype,"addQuestion",null),Ei([Object(d.a)(ji.DeleteQuestion),Fi("design:type",Function),Fi("design:paramtypes",[Object,ji.DeleteQuestion]),Fi("design:returntype",void 0)],e.prototype,"deleteQuestion",null),Ei([Object(d.a)(ji.SetQuestions),Fi("design:type",Function),Fi("design:paramtypes",[Object,ji.SetQuestions]),Fi("design:returntype",void 0)],e.prototype,"setQuestions",null),Ei([Object(d.a)(ji.SetQuestion),Fi("design:type",Function),Fi("design:paramtypes",[Object,ji.SetQuestion]),Fi("design:returntype",void 0)],e.prototype,"setQuestion",null),Ei([Object(d.a)(ji.SubmitQuestionAnswer),Fi("design:type",Function),Fi("design:paramtypes",[Object,ji.SubmitQuestionAnswer]),Fi("design:returntype",void 0)],e.prototype,"submitQuestionAnswer",null),Ei([Object(d.a)(ji.NextQuestion),Fi("design:type",Function),Fi("design:paramtypes",[Object]),Fi("design:returntype",void 0)],e.prototype,"nextQuestion",null),Ei([Object(d.a)(ji.PreviousQuestion),Fi("design:type",Function),Fi("design:paramtypes",[Object]),Fi("design:returntype",void 0)],e.prototype,"previousQuestion",null),Ei([Object(d.a)(ji.ClearSubmissions),Fi("design:type",Function),Fi("design:paramtypes",[Object]),Fi("design:returntype",void 0)],e.prototype,"clearSubmissions",null),Ei([Object(d.a)(ji.SetActiveQuestion),Fi("design:type",Function),Fi("design:paramtypes",[Object,ji.SetActiveQuestion]),Fi("design:returntype",void 0)],e.prototype,"setActiveQuestion",null),Ei([Object(d.a)(ji.SetQuizPickMode),Fi("design:type",Function),Fi("design:paramtypes",[Object,ji.SetQuizPickMode]),Fi("design:returntype",void 0)],e.prototype,"setQuizPickMode",null),Ei([Object(d.a)(ji.SetActiveSubmission),Fi("design:type",Function),Fi("design:paramtypes",[Object,ji.SetActiveSubmission]),Fi("design:returntype",void 0)],e.prototype,"setActiveSubmission",null),Ei([Object(d.a)(ji.SetQuizLifecycle),Fi("design:type",Function),Fi("design:paramtypes",[Object,ji.SetQuizLifecycle]),Fi("design:returntype",void 0)],e.prototype,"setQuizLifecycle",null),Ei([Object(d.e)(),Fi("design:type",Function),Fi("design:paramtypes",[Object]),Fi("design:returntype",void 0)],e,"getLifecycle",null),Ei([Object(d.e)(),Fi("design:type",Function),Fi("design:paramtypes",[Object]),Fi("design:returntype",Object)],e,"getQuizSettings",null),Ei([Object(d.e)(),Fi("design:type",Function),Fi("design:paramtypes",[Object]),Fi("design:returntype",void 0)],e,"getQuizModeActive",null),Ei([Object(d.e)(),Fi("design:type",Function),Fi("design:paramtypes",[Object]),Fi("design:returntype",void 0)],e,"getQuizModeLocked",null),Ei([Object(d.e)(),Fi("design:type",Function),Fi("design:paramtypes",[Object]),Fi("design:returntype",Boolean)],e,"getQuizReviewEnabled",null),Ei([Object(d.e)(),Fi("design:type",Function),Fi("design:paramtypes",[Object]),Fi("design:returntype",void 0)],e,"globalSceneConfig",null),Ei([Object(d.e)(),Fi("design:type",Function),Fi("design:paramtypes",[Object]),Fi("design:returntype",void 0)],e,"hasQuiz",null),Ei([Object(d.e)(),Fi("design:type",Function),Fi("design:paramtypes",[Object]),Fi("design:returntype",void 0)],e,"getQuizEnabled",null),Ei([Object(d.e)(),Fi("design:type",Function),Fi("design:paramtypes",[Object]),Fi("design:returntype",void 0)],e,"getAllQuestions",null),Ei([Object(d.e)(),Fi("design:type",Function),Fi("design:paramtypes",[Object]),Fi("design:returntype",void 0)],e,"getAllSubmissions",null),Ei([Object(d.e)(),Fi("design:type",Function),Fi("design:paramtypes",[Object]),Fi("design:returntype",void 0)],e,"getActiveSubmitted",null),Ei([Object(d.e)(),Fi("design:type",Function),Fi("design:paramtypes",[Object]),Fi("design:returntype",void 0)],e,"getActiveSubmission",null),Ei([Object(d.e)(),Fi("design:type",Function),Fi("design:paramtypes",[Object]),Fi("design:returntype",void 0)],e,"getActiveQuestion",null),Ei([Object(d.e)(),Fi("design:type",Function),Fi("design:paramtypes",[Object]),Fi("design:returntype",void 0)],e,"getActiveQuestionId",null),Ei([Object(d.e)(),Fi("design:type",Function),Fi("design:paramtypes",[Object]),Fi("design:returntype",Array)],e,"getActiveQuestionLabels",null),Ei([Object(d.e)(),Fi("design:type",Function),Fi("design:paramtypes",[Object]),Fi("design:returntype",void 0)],e,"getActiveQuestionIndex",null),Ei([Object(d.e)(),Fi("design:type",Function),Fi("design:paramtypes",[Object]),Fi("design:returntype",void 0)],e,"getQuestionTotal",null),Ei([Object(d.e)(),Fi("design:type",Function),Fi("design:paramtypes",[Object]),Fi("design:returntype",void 0)],e,"getCorrectAnswerTotal",null),Ei([Object(d.e)(),Fi("design:type",Function),Fi("design:paramtypes",[Object]),Fi("design:returntype",void 0)],e,"getQuestionsRemaining",null),Ei([Object(d.e)(),Fi("design:type",Function),Fi("design:paramtypes",[Object]),Fi("design:returntype",void 0)],e,"hasQuestionRemaining",null),Ei([Object(d.e)(),Fi("design:type",Function),Fi("design:paramtypes",[Object]),Fi("design:returntype",void 0)],e,"getPickMode",null),e=Li=Ei([Object(d.f)({name:"quiz",defaults:Ri})],e),e})();class Qi{constructor(e){this.shown="majorityWins",this.selected="majorityWins",this.pickable="majorityWins",e.forEach(e=>{this[e]="majorityWins"})}}let $i=(()=>{class e{constructor(e,t,n){this.store=e,this.labelService=t,this.graphService=n}getMinimumGraphSync(e,t,n){const i=Human.scene.colorRecipes.getRecipes(),o=Object.keys(new Xe(i)),s=function(e,t,n){const i={},o={};return Ye.depthFirst(e,s=>{o[s]=Ye.isRoot(e,s)?Object.assign(Object.assign({},Ye.getState(e,s,n)),t[s]||{}):Object.assign(Object.assign({},o[e.predecessors[s]]),t[s]||{}),Ye.isLeaf(e,s)&&(i[s]=o[s])}),i}(e,t,o),r=function(e,t,n){const i=Object.keys(t),o=et.getInitialVoterState(n,i),s=et.getInitialElectionDepth(n,e),r=Object(X.range)(s,-1).reduce((n,i)=>{const o=et.getEligibleElections(e,Object.keys(n.remainingVoters),i),s=et.getElectionResults(e,n.remainingVoters,o,t),r=function(e){return e.reduce((e,t)=>{const n=Object.keys(t).map(e=>function(e,t,n,i){const o=i.reduce((t,i)=>(t[i]={[e]:!n},t),{});return o[t]={[e]:n},o}(e,t[e].id,t[e].result,t[e].dissenters)).reduce((e,t)=>Object(X.merge)(e,t),{});return Object.keys(n).forEach(t=>{e[t]=n[t]}),e},{})}(s.results);return Object.keys(r).forEach(e=>{n.syncGraph[e]=r[e]}),n.remainingVoters=s.remainingVoters,n},{syncGraph:{},remainingVoters:o}).syncGraph;return function(e,t,n,i){const o=t.reduce((t,o)=>{const s=e[o],r=e[i.predecessors[o]];for(const e of n)s[e]===r[e]&&t.push({successorId:o,prop:e});return t},[]);for(const s of o)delete e[s.successorId][s.prop],0===Object.keys(e[s.successorId]).length&&delete e[s.successorId];return e}(r,Object.keys(r).filter(t=>!e.roots[t]&&!!e.successors[t]),i,e)}(e,JSON.parse(JSON.stringify(new Qi(i))),s);Object.entries(t).forEach(([e,t])=>{const n=Object(X.omit)(t,o);Object(X.isEmpty)(n)||(r[e]=Object.assign(Object.assign({},r[e]||{}),n))});const a=new Je;return Object.entries(r).forEach(([e,t])=>{a[this.switchNamespace(e,n)]=t},this),a}convertGraphSync(e){const t={},n={},i={},o={};return Object.entries(e).forEach(([e,s])=>{Object.entries(s).forEach(([s,r])=>{"shown"===s?t[e]=r:"selected"===s?n[e]=r:"pickable"===s?i[e]=!r:o[e]=Object.assign(Object.assign({},o[e]||{}),{[s]:r})},this)},this),{showObjects:t,selectObjects:n,pickThroughObjects:i,synchronization:o}}switchNamespace(e,t){return t[e]||e}serializeTimelineMaps(e,t){const n=e.timelineMap;return n.forEach(e=>{e.data.timeline=this.switchNamespace(e.data.timeline,t)}),n}serializeProperties(e){const t=Object.assign({},e.properties),n=Human.properties.properties["annotations.layout.type"];return"draggable"!==n&&(t["annotations.layout.type"]=n),t}serializeHotspots(e,t){let n=[...e.hotspots],i={};return t.filter(t=>t.chapterId===e.id).forEach(e=>{const t=this.labelService.serializeLabel(e,n.length);n=[...n,...t.hotspots],i=Object.assign(Object.assign({},i),t.data)}),{customData:i,hotspots:n}}serializeMedia(e){return e.media?Object.entries(e.media).reduce((e,[t,n])=>(e[t]=Object.assign({},n.data),e),{}):null}serializeBackground(e){return e?Object(I.classToClass)(e):{}}serializeUI(e,t){return Object(X.isEmpty)(t)?{play:{count:1}}:t}calcMinimumPaintState(e,t){return Object.keys(e.roots).reduce((n,i)=>Object.assign(Object.assign({},n),function n(i,o=!0){const s=(e.successors[i]||[]).reduce((e,o)=>{const s=!Object(X.isEqual)(t[i],t[o]);return Object.assign(Object.assign({},e),n(o,s))},{});return o?Object.assign({[i]:t[i]},s):s}(i)),{})}serializeVisibilityLayers(e,t){const n=Object.assign({},e);return Array.isArray(e.layers)&&(n.layers=e.layers.map(e=>Object.assign(Object.assign({},e),{objectIds:e.objectIds.filter(e=>t.nodes.hasOwnProperty(e))})).filter(e=>e.objectIds.length>0)),n}serializeChapter(e,t,n,i,o){const s=this.serializeHotspots(t,i),r=this.store.selectSnapshot(_i.particleSystemsForChapter(t.id)),a=Object.assign(Object.assign(Object.assign({},t.customData),s.customData),{particleSystems:r.map(e=>e.id)}),c=this.store.selectSnapshot(Bi.getQuizQuestionsByChapter(t.id)).map(e=>{const t=Object.assign({},e);return delete t.chapterId,t}),l={id:o[t.id],displayName:t.info.displayName,description:t.info.description,[t.camera.action]:t.camera.location,background:this.serializeBackground(t.background),hotspots:s.hotspots,clippingPlanes:{clips:t.clippingPlanes.clips,boundary:t.clippingPlanes.boundary},ui:this.serializeUI(t,t.ui),media:this.serializeMedia(t),graph:t.graph||{},timelineMap:t.timelineMap||[],customData:a,viewModes:t.viewModes,lights:t.lights,recipes:t.recipes||{},transparencyMode:t.transparencyMode||"",fallbackTransparency:t.fallbackTransparency||"",properties:this.serializeProperties(t),effects:t.effects||{},options:t.options,transitions:t.transitions,environment:t.environment||{},legend:t.legend||[],visibilityLayers:this.serializeVisibilityLayers(t.visibilityLayers.src,e),colorRecipeObjects:t.colorRecipeObjects,contentBlocks:t.contentBlocks||[],quizQuestions:c},p=this.store.selectSnapshot(ii.getAllNodeState)[t.id],d=Object.keys(p).reduce((n,i)=>{const o=p[i],s=o.shownSetByTween?xi(e,i,t.showObjects)||yi(e,i,t.showObjects):o.shown;return n.boolState[i]={shown:s,pickable:o.pickable},n.paintState[i]=Xn.toEngine(o.paint),n},{boolState:{},paintState:{}}),u=this.getMinimumGraphSync(e,d.boolState,n);return Object.entries(this.convertGraphSync(u)).forEach(([e,t])=>{l[e]=t}),l.synchronization=this.calcMinimumPaintState(e,d.paintState),l}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(d.g),i.Zb(Bn),i.Zb(tt))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var qi;(qi||(qi={})).makeChapterIdMap=function(e,t){return e.reduce((e,n)=>(e[n.id]=!0===t?Un.idWithPrefix("chapter"):n.id,e),{})};var Wi=function(e){return e[e.LeftClip=0]="LeftClip",e[e.RightClip=1]="RightClip",e[e.BottomClip=2]="BottomClip",e[e.TopClip=3]="TopClip",e[e.FrontClip=4]="FrontClip",e[e.BackClip=5]="BackClip",e}({});const Ki={0:"left",1:"right",2:"bottom",3:"top",4:"front",5:"back"},Gi={enabled:!1,clips:{left:{clipId:Wi.LeftClip,enabled:!1,fade:!1,fadeDistance:0,progress:0},right:{clipId:Wi.RightClip,enabled:!1,fade:!1,fadeDistance:0,progress:0},back:{clipId:Wi.BackClip,enabled:!1,fade:!1,fadeDistance:0,progress:0},front:{clipId:Wi.FrontClip,enabled:!1,fade:!1,fadeDistance:0,progress:0},top:{clipId:Wi.TopClip,enabled:!1,fade:!1,fadeDistance:0,progress:0},bottom:{clipId:Wi.BottomClip,enabled:!1,fade:!1,fadeDistance:0,progress:0}}};let Zi=(()=>{class e{constructor(e,t,n){this.engineService=e,this.serializeChapterService=t,this.labelService=n}addChapterToEngine(e,t){const n=qi.makeChapterIdMap([e],!1),i=Ye.createGraphFromSrc(Object.values(Human.scene.rootObjects),"objectId","objects",new Xe(Human.scene.colorRecipes.getRecipes())),o=this.serializeChapterService.serializeChapter(i,e,{},[],n);o.synchronization=JSON.parse(JSON.stringify(e.synchronization));const s=new Human.timeline.BranchTimeline(o);Human.timeline.activeRoot.addChapter(s,{rebuild:!0,position:t})}removeChapterFromEngine(e){Human.timeline.activeRoot._chapters=Human.timeline.activeRoot._chapters.filter(t=>t.id!==e.id),Human.timeline.activeRoot.build()}copyChapter(e,t){const n=Object(I.classToClass)(e);return n.id=t,n.labels.forEach(e=>{e.id=Un.idWithPrefix("label"),e.chapterId=n.id}),n.readyState={model:!0,animation:!0},n}getCurrentChapterId(){return Human.timeline.activeRoot._nowBranch.id}fromHumanChapter(e,t,n,i){const o=Object.assign({},n),s=e.chapters[i];o.environment=Object.assign({},s.environment),o.transitions=Object.assign({},s.transitions),s.transparencyMode&&(o.transparencyMode=s.transparencyMode),o.showObjects=Object.assign({},e.chapters[i].showObjects),o.pickThroughObjects=Object.assign({},e.chapters[i].pickThroughObjects),o.id||(o.id=Un.idWithPrefix("chapter"));let r=!1;o.timelineMap=Object.values(n.maps).map(e=>("dummy"!==e.data.timeline.id&&(r=!0),{start:e.start,end:e.end,data:{timeline:e.data.timeline.id,start:e.data.start,end:e.data.end,fit:e.data.fit||!1,onEnd:e.data.onEnd}})),delete o.maps;let a=0;const c=!!n.animation&&n.animation.loop;r&&c?a=-1:r&&!c&&(a=1),o.ui=n.ui&&!Object(X.isEmpty)(n.ui)?n.ui:{play:{count:a}};const l=wn.Annotation,p=[...o.annotations||[]].map(e=>this.labelService.deserializeAnnotation(e,o,l)),d=[],u=this.groupHotspots([...o.hotspots||[]].filter(i=>{const o=this.labelService.filterHotspot(e,n,i);return o?i.theme||(i.theme="module"===t?Dn.studioNext:Dn.classicHotspot):d.push(i),o})).map(t=>this.labelService.deserializeHotspots(e,n,i,...t));o.labels=[...p,...u],delete o.annotations,o.background=Pn.deserialize(n.background);const g=Object(I.plainToClass)(Tn,o);return g.hotspots=d,g.readyState={model:!1,animation:!1},g.clippingPlanes=Object(X.isEmpty)(g.clippingPlanes)?Gi:this.sanitizeClippingPlanes(g.clippingPlanes),g.legend=[...s.legend||[]],g.visibilityLayers=this.buildVisibilityLayers(s.visibilityLayers,g.showObjects),g.colorRecipeObjects=s.colorRecipeObjects,g.contentBlocks=[...s.contentBlocks||[]],g.quizQuestions=(s.quizQuestions||[]).map(e=>Object.assign(Object.assign({},e),{chapterId:o.id})),g}getChapterTweenStates(e){const t=e.timelineMap.filter(e=>"dummy"!==e.data.timeline).map(e=>e.data.timeline);return Array.from(new Set(t))}getChapterLightLibraries(e){return(e.lights&&e.lights.libraries||[]).filter(e=>"default"!==e)}getChapterReflectionLibraries(e){const t=e.environment&&e.environment.reflectionMap||[],n=e=>e.split(".")[0],i=(e.environment&&e.environment.lightMap||[]).map(n).concat(t.map(n));return Array.from(new Set(i))}hasVisibilityLayers(e){return Array.isArray(e)&&e.length>0}buildVisibilityLayers(e,t){const n={src:{},current:{}};if(e&&this.hasVisibilityLayers(e.layers)){const i=e.initIndex||0,o=this.unpackLayers(e.layers),s=this.buildShownObjectsSet(t),r=this.buildCurrentLayers(o,s);n.src={layers:e.layers,initIndex:i},n.current={layers:r,index:i,position:0}}return n}buildShownObjectsSet(e){const t=this.engineService.getSceneGraph(Human.scene.rootObjects),n=Object.keys(t.nodes).filter(n=>xi(t,n,e)||yi(t,n,e));return new Set(n)}unpackLayers(e){const t=[];return e.forEach(e=>{let n=[];e.objectIds.forEach(e=>{const t=Human.scene.objects[e].getLeafObjects();n=n.concat(t.map(e=>e.objectId))}),t.push({name:e.name,objectIds:n})}),t}buildCurrentLayers(e,t){const n=[];return e.forEach((i,o)=>{let s=!1;i.objectIds.forEach(i=>{t.has(i)&&(s?n[n.length-1].objectIds.push(i):(n.push({name:e[o].name,objectIds:[i]}),s=!0))})}),n}sanitizeClippingPlanes(e){const t=Object.values(e.clips).some(e=>e.progress>0),n=Object(X.mapKeys)(e.clips,(e,t)=>Ki[t]||t);return Object.assign(Object.assign({},e),{clips:n,enabled:t})}groupHotspots(e){const t={},n=e=>e.primitiveIndex?e.primitiveIndex.toFixed(0):e.pos?e.pos.map(e=>e.toFixed(3)).join(":"):Math.random().toFixed(3);return e.forEach(e=>{const i=[(o=e.type,RegExp("^circle-(plus|minus)").test(o)?"pair":"single"),e.objectId,n(e)].join("|");var o;i in t?t[i].push(e):t[i]=[e]}),Object.values(t)}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(lt),i.Zb($i),i.Zb(Bn))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var Ji=function(e){return e.Toggle="toggle",e.None="none",e}({});let Xi=(()=>{class e{constructor(e){this.patches=e}}return e.type="[Story Labels] Patch Labels",e})(),Yi=(()=>{class e{constructor(e,t){this.labelId=e,this.offset=t}}return e.type="[Story Labels] Set label Offset",e})(),eo=(()=>{class e{constructor(e){this.labels=e}}return e.type="[Story Labels] Set Labels",e})(),to=(()=>{class e{constructor(e){this.label=e}}return e.type="[Story Labels] Add Label",e})(),no=(()=>{class e{constructor(e){this.label=e}}return e.type="[Story Labels] Set Contexdt Label",e})(),io=(()=>{class e{constructor(e,t){this.sourceChapter=e,this.targetChapter=t}}return e.type="[Story Labels] Copy Labels",e})(),oo=(()=>{class e{constructor(e){this.label=e}}return e.type="[Story Labels] Remove Label",e})(),so=(()=>{class e{constructor(){}}return e.type="[Story Labels] Remove Context Label",e})(),ro=(()=>{class e{constructor(e){this.chapter=e}}return e.type="[Story Labels] Remove All Chapter Labels",e})(),ao=(()=>{class e{constructor(e,t=!1){this.label=e,this.record=t}}return e.type="[Story Labels] Set Label",e})(),co=(()=>{class e{constructor(e,t){this.id=e,this.states=t}}return e.type="[Story Labels] Set Label States",e})(),lo=(()=>{class e{constructor(e){this.scale=e}}return e.type="[Story Labels] Set Label Scale",e})(),po=(()=>{class e{constructor(e){this.label=e}}return e.type="[Story Labels] Select Label",e})(),uo=(()=>{class e{constructor(){}}return e.type="[Story Labels] Reset",e})(),go=(()=>{class e{constructor(e,t){this.labels=e,this.fields=t}}return e.type="[Story Labels] Convert",e})(),ho=(()=>{class e{constructor(e,t=!0,n=!0){this.enable=e,this.enableInfo=t,this.enableActions=n}}return e.type="[Story Labels] Enable Context Label",e})(),bo=(()=>{class e{constructor(e,t){this.labels=e,this.shown=t}}return e.type="[Story Labels] Set Labels Shown",e})(),mo=(()=>{class e{constructor(e){this.show=e}}return e.type="[Story Labels] Set All Labels Shown",e})(),fo=(()=>{class e{constructor(e,t=Ji.None){this.collapsed=e,this.collapsedMode=t}}return e.type="[Story Labels] Set Labels Collapsed",e})(),yo=(()=>{class e{constructor(e){this.draggable=e}}return e.type="[Story Labels] Set Draggable",e})();var xo,vo,wo=n("GyhO"),Oo=n("5+tZ"),Co=n("7wxJ"),So=n("wOnQ"),ko=n.n(So),_o=(n("INDF"),n("Cfvw")),jo=n("Iab2"),Po=n("VUv2");(vo=xo||(xo={})).exportImage=function(e,t,n,i){const o="string"==typeof e?vo.base64ToBlob(e,t):e;return i?Object(Po.changeDpiBlob)(o,i).then((function(e){Object(jo.saveAs)(e,n)})):Object(jo.saveAs)(o,n),Object(S.a)(!0)},vo.canvasToBlob=function(e,t,n){return new q.a(i=>{e.toBlob(e=>{i.next(e),i.complete()},t,n)})},vo.fitCanvas=function(e,{width:t,height:n}){const i=document.createElement("canvas");i.width=t,i.height=n;const o=i.getContext("2d"),s=Math.max(.5*(e.width-i.width/i.height*e.height),0);return new q.a(t=>{o.drawImage(e,s,0,i.width,i.height),t.next(i),t.complete()})},vo.elementToCanvas=function(e,t=!1){const n=t?{backgroundColor:"transparent"}:{};return Object(_o.a)(ko()(e,n))},vo.combineCanvasElements=function(e){const t=Math.max(0,...e.map(e=>e.width)),n=Math.max(0,...e.map(e=>e.height)),i=document.createElement("canvas");i.width=t,i.height=n;const o=i.getContext("2d");return e.forEach(e=>{o.drawImage(e,0,0)}),i},vo.base64ToBlob=function(e,t){const n=atob(e.split(",")[1]),i=new ArrayBuffer(n.length),o=new Uint8Array(i);for(let s=0;s<n.length;s++)o[s]=n.charCodeAt(s);return new Blob([i],{type:t})},vo.blobToBase64=function(e){return new q.a(t=>{const n=new FileReader;n.addEventListener("load",()=>{t.next(n.result),t.complete()}),n.readAsDataURL(e)})},vo.blobToCanvas=function(e,{width:t,height:n}){return new q.a(i=>{const o=document.createElement("canvas");o.width=t,o.height=n;const s=o.getContext("2d"),r=new Image;r.addEventListener("load",()=>{s.drawImage(r,0,0),i.next(o),i.complete()}),r.src=URL.createObjectURL(e)})};let Mo=(()=>{class e{constructor(e,t,n){this.engineService=e,this.labelsService=t,this.store=n}localResize(e,t){const n=Human.renderer.canvas.canvas,i=Human.renderer.canvas.annotationCanvas,o=n.parentNode,s=o.clientWidth,r=o.clientHeight;return o.width=e,o.height=t,n.width=e,n.height=t,i.width=e,i.height=t,o.style.width=e+"px",o.style.height=t+"px",Human.renderer.canvas.init(),Human.renderer.viewportDirty=!0,Human.renderer.camera.updateCanvas(),Human.renderer.postprocess.updateCanvas(),Human.renderer.draw.updateCanvas(),Human.renderer.viewportDirty=!0,Human.renderer.prepareFrame(),Human.renderer.forceRenderFrame(),[s,r]}canvasToImage(e,t="original"){const n=e.width/e.height,i=this.engineService.getCanvas();let{width:o,height:s}=i,r=.5*(i.width-o),a=0;switch(t){case"square":s>o?s=o:o=s,r=.5*(i.width-o),a=.5*(i.height-s);break;case"original":o=n*s}return new q.a(t=>{const n=e.getContext("2d");Human.renderer.forceRenderFrame(),n.drawImage(i,r,a,o,s,0,0,e.width,e.height),t.next(),t.complete()})}canvasToImageWithResize(e){const t=this.engineService.getCanvas();t.style.opacity="0",this.store.dispatch(new Se(!1));const[n,i]=this.localResize(e.width,e.height),o=e.getContext("2d");return new q.a(e=>{setTimeout(()=>{Human.renderer.viewportDirty=!0,Human.renderer.prepareFrame(),Human.renderer.forceRenderFrame(),o.drawImage(t,0,0,t.width,t.height),this.localResize(n,i),document.getElementById("theCanvas").style.opacity="",this.store.dispatch(new Se(!0)),e.next(),e.complete()},10)})}drawRadialGradient(e,t){const n=t.colors,[i,o]=t.colorStops.map(t=>((e,t,n)=>{const[i,o]=[Math.pow(t/2,2),Math.pow(n/2,2)];return e/100*Math.pow(i+o,.5)})(t,e.width,e.height)),s=e.getContext("2d"),[r,a]=[e.width/2,e.height/2],c=s.createRadialGradient(r,a,i,r,a,o);c.addColorStop(t.colorStops[0]/100,`rgba(${n.slice(0,4).join(",")})`),c.addColorStop(t.colorStops[1]/100,`rgba(${n.slice(4,8).join(",")})`),s.fillStyle=c,s.fillRect(0,0,e.width,e.height)}drawLinearGradient(e,t){const n=t.colors,i=e.getContext("2d"),[o,s]=[e.width/2,e.height/2],r=i.createLinearGradient(o,s,o,e.height);r.addColorStop(t.colorStops[0]/100,`rgba(${n.slice(0,4).join(",")})`),r.addColorStop(t.colorStops[1]/100,`rgba(${n.slice(4,8).join(",")})`),i.fillStyle=r,i.fillRect(0,0,e.width,e.height)}takeSnapshot(e,t,n,i,o,s){const{imageType:r,imageQuality:a,copyrightEnabled:c,crop:l}=s,p=document.createElement("canvas");p.width=e,p.height=t,"radial"===n.gradientType?this.drawRadialGradient(p,n):"linear"===n.gradientType&&this.drawLinearGradient(p,n);const d=this.engineService.getCanvas(),u=[],g=(p.height>d.height||p.width>d.width?this.canvasToImageWithResize(p):this.canvasToImage(p,l)).pipe(Object(k.a)(()=>p));u.push(g);const h=[],b=this.labelsService.getLabelContainer();return o&&b&&h.push(b.nativeElement),h.push(...i),u.push(...h.map(n=>(n instanceof HTMLCanvasElement?Object(S.a)(n):xo.elementToCanvas(n,!0)).pipe(Object(Oo.a)(n=>xo.fitCanvas(n,{width:e,height:t}))))),Object(wo.a)(u).pipe(Object(Co.a)(),Object(k.a)(e=>xo.combineCanvasElements(e)),Object(Oo.a)(e=>c?this.writeLogoToCanvas(e,s):Object(S.a)(e)),Object(Oo.a)(e=>xo.canvasToBlob(e,r,a)))}writeLogoToCanvas(e,t){return this.getLogoImage(t.copyrightImagePath).pipe(Object(k.a)(n=>{let{width:i,height:o}=n;const{width:s,height:r}=e;if(.1*s>i){const e=o/i;i=.1*s,o=e*i}const{xOffset:a,yOffset:c}=this.getLogoPosition(s,r,i,o,t);return e.getContext("2d").drawImage(n,a,c,i,o),e}),Object(_.a)(()=>Object(S.a)(e)))}getLogoImage(e){return new q.a(t=>{const n=new Image;n.onload=()=>{t.next(n),t.complete()},n.onerror=()=>t.error(),n.src=e})}getLogoPosition(e,t,n,i,o){const{copyrightPosition:s,copyrightOffset:r}=o;let a,c;switch(s.x){case"right":a=e-n;break;case"center":a=e/2-n/2;break;default:a=0}switch(s.y){case"bottom":c=t-i;break;case"center":c=t/2-i/2;break;default:c=0}return{xOffset:a+r.x,yOffset:c+r.y}}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(lt),i.Zb(Bn),i.Zb(d.g))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var Io;class zo{constructor(){this[Io]=!0}}Io=immer.immerable;const To={colors:[245,245,245,1,245,245,245,1],gradientType:"radial",colorStops:[0,100]},Uo={small:{width:256,height:256},medium:{width:512,height:512},large:{width:1024,height:1024}};class Lo{constructor(){this.firstTime=0,this.lastTime=1}}let Do=(()=>{class e{constructor(){}getChapterLocalTimerange(e){const t=Human.timeline.activeRoot._chapters.find(t=>t.id===e);return Object(I.plainToClass)(Lo,t.timeRange)}mapGlobalTimeToLocal(e,t={}){const n=Human.timeline.activeRoot.mapGlobalTime(e,t);return n.time<0&&(n.time=0),n}mapLocalTimeToGlobal(e,t){const n=Human.timeline.activeRoot._chapters.find(t=>t.id===e);return Human.timeline.activeRoot.mapBranchTime(n,t)}isChapterAnimated(e){return e.timelineMap.filter(e=>"dummy"!==Object(X.get)(e,"data.timeline")&&"dummy"!==Object(X.get)(e,"data.timeline.id")&&"dummy"!==Object(X.get)(e,"data.timeline.id.id")).length>0}isChapterLooped(e){return!0===Object(X.get)(e,"loop")||-1===Object(X.get)(e,"ui.play.count")}scrub(e){Human.timeline.scrub({time:e.time,borderCondition:{which:e.which?e.which:"first",direction:"forward"}})}getTimeFrame(){return Human.timeline.getTimeFrame()}getTime(){return Human.timeline.time}isPlaying(){return Human.timeline.playing}hasChapterFinished(e){const t=this.getChapterLocalTimerange(e);return this.mapGlobalTimeToLocal(Human.timeline.time).time===t.lastTime}play(e){this.playParams=Object.keys(e).reduce((e,t)=>(void 0===e[t]&&delete e[t],e),Object.assign({},e)),Human.timeline.play(this.playParams)}rewind(e){const t=this.mapLocalTimeToGlobal(e,0);this.scrub({time:t,which:"second"})}unpause(e){this.hasChapterFinished(e)&&this.rewind(e),Human.timeline.unpause()}pause(){Human.timeline.pause()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var Eo;!function(e){const t=/(\s*[\d\.]+\s*,){2,15}\s*[\d\.]+\s*/g;function n(e){for(let t=0;t<3;t++)if(parseFloat(""+e[t])>1)return!0;return!1}function i(e){const t=document.createElement("div");t.style.backgroundColor=e,document.documentElement.appendChild(t);const n=window.getComputedStyle(t).backgroundColor.replace(/\s/g,"");return window.document.documentElement.removeChild(t),n}function o(e){const t=e.slice(0,4);3===t.length&&t.push(1);for(let n=0;n<4;n++)t[n]=parseFloat(""+t[n]),t[n]<0&&(t[n]=0),t[n]>255&&(t[n]=255);return t[3]>1&&(t[3]=1),t}function s(e){let n;if(Array.isArray(e))n=o(e);else if("string"==typeof e){let s=e.match(t);s?n=o(s[0].split(",")):(s=i(e).match(t),s&&(n=o(s[0].split(","))))}return n}function r(e){const t=s(e);if(!t)throw new TypeError("Invalid color input.");const i=a(t);return{1:n(t)?i:t,255:n(t)?t:i}}function a(e){const t=n(e),i=[];for(let n=0;n<3;n++){let o=t?e[n]/255:255*e[n];o=t?Math.round(100*o)/100:Math.round(o),i.push(o)}return 4===e.length&&i.push(e[3]),i}function c(e,t=!1){e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(e,t,n,i)=>[t,t,n,n,i,i].join("")).replace(/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,(e,t,n,i)=>[t,n,i,"ff"].join(""));const n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e),i=parseInt(n[1],16),o=parseInt(n[2],16),s=parseInt(n[3],16),r=parseInt(n[4],16)/255;if(t){const e=p([i,o,s]);return[e[0],e[1],e[2],r]}return[i,o,s,r]}function l(e){const[t,n,i]=e;return Math.sqrt(t*t*.299+n*n*.587+i*i*.114)}function p(e){return e.map(e=>e/255)}function d(e){return e.map(e=>Math.round(255*e))}function u(e){return"#"+e.map(e=>{const t=e.toString(16);return t.length%2?"0"+t:t}).join("")}e.is255=n,e.isLight=function(e,t){return t||(t=[...e]),(l(e)+l(t))/2>140.25},e.getComputedColor=i,e.convertChannels=o,e.convert=s,e.getColor=r,e.getColors=function(e){let n=[];if("string"==typeof e){const n=e.match(t);n&&(e=n.join(",")),e=e.split(",")}if(Array.isArray(e))if(Array.isArray(e[0])&&Array.isArray(e[1]))n=e;else if(e.length<=2)n=1===e.length?e.concat(e):e;else{const t=Math.floor(e.length/2);n=e.length>4?[e.slice(0,t),e.slice(t)]:[e,e]}return n.map(e=>r(e))},e.scaleColor=a,e.hexToRgba=c,e.hexToRgb=function(e,t=!1){const n=c(e,t);return[n[0],n[1],n[2]]},e.rgbToHex=function(e,t=!1){return u(t?d(e):e)},e.rgbToHSP=l,e.rgbaToHex=function(e,t=!1){const n=e[0],i=e[1],o=e[2],s=255*e[3];return u(t?[...d([n,i,o]),s]:[n,i,o,s])},e.rgbToDecimal=p,e.rgbFromDecimal=d}(Eo||(Eo={}));var Fo,Ao=n("5+WD"),Ro=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},No=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const Vo={imageType:At.JPEG,crop:"original",copyrightEnabled:!1,copyrightImagePath:"assets/images/powered-by-biodigital-color.svg",copyrightPosition:{x:"left",y:"bottom"},copyrightOffset:{x:12,y:-12},imageQuality:1},Ho={loading:!1,chapters:[],chaptersViewed:[],selectedChapter:null,isChapterAnimated:!1,thumbnails:new Map,patches:[],inversePatches:[]};let Bo=(()=>{let e=Fo=class{constructor(e,t,n,i,o){this.chapterService=e,this.snapshotService=t,this.store=n,this.animationService=i,this.engineService=o}static getStoryChapters(e){return e.chapters}static getChaptersViewed(e){return e.chaptersViewed}static getChapter(e){return Object(d.h)([Fo],t=>t.chapters.find(t=>t.id===e))}static getSelectedChapterId(e){return e.selectedChapter}static getSelectedChapter(e){return e.chapters.find(t=>t.id===e.selectedChapter)||null}static getNextChapter(e){const t=1+Fo.getSelectedChapterIndex(e);return e.chapters[t]}static getPreviousChapter(e){const t=-1+Fo.getSelectedChapterIndex(e);return e.chapters[t]}static getSelectedChapterIndex(e){return e.chapters.findIndex(t=>t.id===e.selectedChapter)}static getSelectedChapterTitle(e){return e.chapters.find(t=>t.id===e.selectedChapter).info.displayName}static getChapterCount(e){return e.chapters.length}static getRegisteredThumbnails(e){return e.thumbnails}static getIsChapterAnimated(e){return e.isChapterAnimated}static getSelectedChapterReadyState(e){const{chapters:t,selectedChapter:n}=e,i=Fo.findChapter(t,n);return Object(X.get)(i,"readyState")}static getChaptersLoaded(e){return{count:e.chapters.length,modelChapters:e.chapters.filter(e=>e.readyState.model),animationChapters:e.chapters.filter(e=>e.readyState.animation)}}static getAllChaptersModelsReady(e){return e.chapters.length>0&&e.chapters.every(e=>e.readyState.model)}static getAllChaptersAnimationsReady(e){return e.chapters.length>0&&e.chapters.every(e=>e.readyState.animation)}static getSelectedChapterBackground(e){const{chapters:t,selectedChapter:n}=e,i=Fo.findChapter(t,n);return Object(X.get)(i,"background")||To}static getAllChaptersBackground(e){return e.chapters.map(e=>Object(X.get)(e,"background"))}static getSelectedChapterAudio(e){const t=e.chapters.find(t=>t.id===e.selectedChapter);return t&&t.media?Object.values(t.media).filter(({data:e})=>"audio"===e.streamType)[0]:null}static getSelectedChapterLegend(e){const{chapters:t,selectedChapter:n}=e,i=Fo.findChapter(t,n);return Object(X.get)(i,"legend")||[]}static getSelectedChapterClippingPlanes(e){const{chapters:t,selectedChapter:n}=e,i=Fo.findChapter(t,n);return Object(X.get)(i,"clippingPlanes")}static getChapterCamera(e){const{chapters:t,selectedChapter:n}=e,i=Fo.findChapter(t,n);return Object(X.get)(i,"camera.location")}static findChapter(e,t){return e.find(e=>e.id===t)}static getAllChaptersCurrentLayers(e){return e.chapters.map(e=>Object(X.get)(e,"visibilityLayers.current.layers",[]))}static getSelectedChapterSrcLayers(e){const{chapters:t,selectedChapter:n}=e,i=Fo.findChapter(t,n);return Object(X.get)(i,"visibilityLayers.src.layers",[])}static getSelectedChapterCurrentLayers(e){const{chapters:t,selectedChapter:n}=e,i=Fo.findChapter(t,n);return Object(X.get)(i,"visibilityLayers.current.layers",[])}static getSelectedChapterCurrentLayersIndex(e){const{chapters:t,selectedChapter:n}=e,i=Fo.findChapter(t,n);return Object(X.get)(i,"visibilityLayers.current.index")}static getSelectedChapterCurrentLayersPosition(e){const{chapters:t,selectedChapter:n}=e,i=Fo.findChapter(t,n);return Object(X.get)(i,"visibilityLayers.current.position")}static getSelectedChapterContentBlocks(e){const{chapters:t,selectedChapter:n}=e,i=Fo.findChapter(t,n);return Object(X.get)(i,"contentBlocks",[])}setChapters(e,t){e.patchState(immer.produce(e.getState(),e=>{e.chapters=t.chapters}))}SetChapterCameraAction(e,t){e.patchState(immer.produce(e.getState(),e=>{e.chapters.find(e=>e.id===t.chapterId).camera.action=t.cameraAction}))}setChapterUI(e,t){e.patchState(immer.produce(e.getState(),e=>{e.chapters.find(e=>e.id===t.chapterId).ui=t.ui}))}setChapterInfo(e,t){e.patchState(immer.produce(e.getState(),e=>{e.chapters.find(e=>e.id===t.chapterId).info=t.info}))}setChapterLegend(e,t){e.patchState(immer.produce(e.getState(),e=>{e.chapters.find(e=>e.id===t.chapterId).legend=t.legend}))}addToChapterLegend(e,t){e.patchState(immer.produce(e.getState(),e=>{e.chapters.find(e=>e.id===t.chapterId).legend.push(t.legend)}))}ReorderChapters(e,t){e.patchState(immer.produce(e.getState(),e=>{Object(Ao.c)(e.chapters,t.previousIndex,t.currentIndex)}));const n=e.getState().chapters.map(e=>e.id);e.dispatch(new ji.ReorderQuestions(n))}SetChapterReadyState(e,t){const n=immer.produce(e.getState(),e=>{if(t.chapterId){const n=e.chapters.find(e=>e.id===t.chapterId);n&&(n.readyState=Object.assign(Object.assign({},n.readyState),t.readyState))}});e.patchState(n)}SetChapterPostProcessing(e,t){e.patchState(immer.produce(e.getState(),e=>{const n=e.chapters.find(e=>e.id===t.chapterId),i=n.properties||{};n.customData=Object.assign(Object.assign({},n.customData?n.customData:{}),{postprocess:t.effects}),n.properties=Object.assign(Object.assign({},i),t.properties)}))}SetChapterTransitions(e,t){e.patchState(immer.produce(e.getState(),e=>{const n=e.chapters.find(e=>e.id===t.chapterId);n.transitions=n.transitions||{},n.transitions[t.key]=t.transition}))}SetChapterTransparencyMode(e,t){e.patchState(immer.produce(e.getState(),e=>{e.chapters.find(e=>e.id===t.chapterId).transparencyMode=t.transparencyMode}))}applyChapterPatch(e,t){const n=immer.applyPatches(e.getState(),t.patches);e.patchState(immer.produce(n,e=>{e.patches=[],e.inversePatches=[]}))}setChapterClippingPlane(e,t){const[n,i,o]=immer.produceWithPatches(e.getState(),e=>{const n=e.chapters.find(e=>e.id===t.chapterId);n.clippingPlanes.clips=t.clips,n.clippingPlanes.enabled=t.enabled,n.clippingPlanes.boundary=n.clippingPlanes.boundary||JSON.parse(JSON.stringify(this.engineService.getSceneBoundary()))}),s=immer.produce(n,e=>{e.patches.push(...i),e.inversePatches.push(...o)});t.record&&e.dispatch(new qn.SavePatches([{forward:s.patches,inverse:[...s.inversePatches].reverse(),patchAction:Rt}])),e.patchState(t.record?immer.produce(s,e=>{e.patches=[],e.inversePatches=[]}):s)}setChapterBackground(e,t){e.patchState(immer.produce(e.getState(),e=>{e.chapters.find(e=>e.id===t.chapterId).background=t.background}))}setAllChaptersBackground(e,t){e.patchState(immer.produce(e.getState(),e=>{e.chapters.forEach(e=>{e.background=t.background})}))}resetSelectedChapterBackground(e,t){const{selectedChapter:n}=e.getState();this.store.dispatch(new sn(n,To))}setSelectedChapterBackground(e,{background:t}){const n=e.getState().selectedChapter;this.store.dispatch(new sn(n,t))}selectChapter(e,t){if(!t.chapter)return;this.store.dispatch([new $n.UpdateNodesChecked(!1),new $n.UpdateNodeSelected]);const n=this.animationService.isChapterAnimated(t.chapter);this.store.dispatch(new ae(!!t.chapter));const i=immer.produce(e.getState(),e=>{e.chaptersViewed.some(e=>t.chapter.id===e)||e.chaptersViewed.push(t.chapter.id),e.selectedChapter=t.chapter?t.chapter.id:null,e.isChapterAnimated=n});e.patchState(i)}selectChapterById(e,{chapterId:t}){this.store.dispatch(new ae(!0)),e.patchState({selectedChapter:t})}duplicateChapter(e,t){const n=t.chapter,i=this.chapterService.copyChapter(n,t.chapterId),o=e.getState().chapters.length;this.chapterService.addChapterToEngine(Object(X.cloneDeep)(i),o),e.patchState(immer.produce(e.getState(),e=>{e.chapters.push(i)})),e.dispatch(new ji.CopyQuestions(n.id,i.id)),e.dispatch(new io(n,i)),e.dispatch(new gn(n,i))}copyThumbnail(e,t){if(t.sourceChapter){const n=e.getState().thumbnails,i=immer.produce(e.getState(),e=>{const i=n.get(t.sourceChapter.id),o=new zo;o.storyId=i.storyId,o.chapterId=i.chapterId,o.urls={small:i.urls.small.replace(t.sourceChapter.id,t.targetChapter.id),large:i.urls.large.replace(t.sourceChapter.id,t.targetChapter.id)},o.snapshot=i.snapshot?i.snapshot:i.urls.large,e.thumbnails.set(t.targetChapter.id,o)});e.patchState(i)}else e.dispatch(new hn(t.targetChapter.id,At.JPEG,92,Uo.medium,"square"))}nextChapter(e,t){const n=e.getState().chapters,i=this.chapterService.getCurrentChapterId();let o=0;o=n.findIndex(e=>e.id===i),o<n.length-1&&o++,e.dispatch(new Qt(n[o]))}previousChapter(e,t){const n=e.getState().chapters,i=this.chapterService.getCurrentChapterId();let o=0;o=n.findIndex(e=>e.id===i),o>0&&o--,e.dispatch(new Qt(n[o]))}lastChapter(e,t){const n=e.getState().chapters;e.dispatch(new Qt(n[n.length-1]))}firstChapter(e,t){const n=e.getState().chapters;e.dispatch(new Qt(n[0]))}removeChapter(e,t){const{chapters:n,selectedChapter:i}=e.getState();if(1===n.length)return;this.chapterService.removeChapterFromEngine(t.chapter);let o=n.findIndex(e=>e.id===t.chapter.id);e.patchState(immer.produce(e.getState(),e=>{e.chapters.splice(o,1)})),t.chapter.id===i&&(o===n.length-1&&o--,e.dispatch(new Qt(n[o]))),e.dispatch(new ro(t.chapter))}resetStoryChaptersState(e,t){e.setState(Ho)}registerChapterThumbnails(e,t){e.patchState(immer.produce(e.getState(),e=>{e.thumbnails=new Map(t.thumbnails)}))}takeChapterPicture(e,t){const{chapterId:n,includeLabels:i,includeCopyright:o,dimensions:s,imageType:r,imageQuality:a,crop:c,layers:l}=t,p=s||Uo.large,{width:d,height:u}=p,g=this.store.selectSnapshot(Fo.getSelectedChapterBackground);let h;switch(r){case At.PNG:h=g||To;break;case At.JPEG:default:h=g&&!Pn.isTransparent(g)?g:To}const b=g.colors.slice(0,3),m=Eo.isLight(b),f=Object.assign(Object.assign({},Vo),{crop:c,imageType:r,imageQuality:a,copyrightEnabled:o,copyrightImagePath:m?"assets/images/powered-by-biodigital-color.svg":"assets/images/powered-by-biodigital-white.svg"});setTimeout(()=>{this.snapshotService.takeSnapshot(d,u,h,l,i,f).subscribe(t=>{e.dispatch(new bn(n,t,p))})})}takeChapterPictureSuccess(e,t){e.patchState(immer.produce(e.getState(),e=>{const n=e.thumbnails.get(t.chapterId)||new zo;n.snapshot=URL.createObjectURL(t.blob),e.thumbnails.set(t.chapterId,n)}))}RecordCamera(e,t){e.patchState(immer.produce(e.getState(),e=>{e.chapters.find(e=>e.id===t.chapterId).camera.location=t.camera}))}setChapterCurrentLayersIndexPosition(e,t){const[n,i,o]=immer.produceWithPatches(e.getState(),e=>{const n=e.chapters.find(e=>e.id===t.chapterId).visibilityLayers.current;n.index=t.index,n.position=t.position}),s=immer.produce(n,e=>{e.patches.push(...i),e.inversePatches.push(...o)});e.patchState(s),t.record&&e.dispatch(new qn.SavePatches([{forward:s.patches,inverse:s.inversePatches,patchAction:Rt}]))}setChapterMedia(e,t){e.patchState(immer.produce(e.getState(),e=>{e.chapters.find(e=>e.id===t.chapterId).media=t.media}))}setChapterContentBlocks(e,t){t.contentBlocks=[...t.contentBlocks.filter(e=>e.type===Pi.Ticker),...t.contentBlocks.filter(e=>e.type!==Pi.Ticker)],e.patchState(immer.produce(e.getState(),e=>{e.chapters.find(e=>e.id===t.chapterId).contentBlocks=t.contentBlocks}))}};return e.\u0275fac=function(t){return new(t||e)(i.Zb(Zi),i.Zb(Mo),i.Zb(d.g),i.Zb(Do),i.Zb(lt))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac}),Ro([Object(d.a)(qt),No("design:type",Function),No("design:paramtypes",[Object,qt]),No("design:returntype",void 0)],e.prototype,"setChapters",null),Ro([Object(d.a)(Wt),No("design:type",Function),No("design:paramtypes",[Object,Wt]),No("design:returntype",void 0)],e.prototype,"SetChapterCameraAction",null),Ro([Object(d.a)(Kt),No("design:type",Function),No("design:paramtypes",[Object,Kt]),No("design:returntype",void 0)],e.prototype,"setChapterUI",null),Ro([Object(d.a)(Gt),No("design:type",Function),No("design:paramtypes",[Object,Gt]),No("design:returntype",void 0)],e.prototype,"setChapterInfo",null),Ro([Object(d.a)(Zt),No("design:type",Function),No("design:paramtypes",[Object,Zt]),No("design:returntype",void 0)],e.prototype,"setChapterLegend",null),Ro([Object(d.a)(Jt),No("design:type",Function),No("design:paramtypes",[Object,Jt]),No("design:returntype",void 0)],e.prototype,"addToChapterLegend",null),Ro([Object(d.a)(Xt),No("design:type",Function),No("design:paramtypes",[Object,Xt]),No("design:returntype",void 0)],e.prototype,"ReorderChapters",null),Ro([Object(d.a)(Yt),No("design:type",Function),No("design:paramtypes",[Object,Yt]),No("design:returntype",void 0)],e.prototype,"SetChapterReadyState",null),Ro([Object(d.a)(en),No("design:type",Function),No("design:paramtypes",[Object,en]),No("design:returntype",void 0)],e.prototype,"SetChapterPostProcessing",null),Ro([Object(d.a)(tn),No("design:type",Function),No("design:paramtypes",[Object,tn]),No("design:returntype",void 0)],e.prototype,"SetChapterTransitions",null),Ro([Object(d.a)(nn),No("design:type",Function),No("design:paramtypes",[Object,nn]),No("design:returntype",void 0)],e.prototype,"SetChapterTransparencyMode",null),Ro([Object(d.a)(Rt),No("design:type",Function),No("design:paramtypes",[Object,Rt]),No("design:returntype",void 0)],e.prototype,"applyChapterPatch",null),Ro([Object(d.a)(on),No("design:type",Function),No("design:paramtypes",[Object,on]),No("design:returntype",void 0)],e.prototype,"setChapterClippingPlane",null),Ro([Object(d.a)(sn),No("design:type",Function),No("design:paramtypes",[Object,sn]),No("design:returntype",void 0)],e.prototype,"setChapterBackground",null),Ro([Object(d.a)(rn),No("design:type",Function),No("design:paramtypes",[Object,rn]),No("design:returntype",void 0)],e.prototype,"setAllChaptersBackground",null),Ro([Object(d.a)(an),No("design:type",Function),No("design:paramtypes",[Object,an]),No("design:returntype",void 0)],e.prototype,"resetSelectedChapterBackground",null),Ro([Object(d.a)(cn),No("design:type",Function),No("design:paramtypes",[Object,Object]),No("design:returntype",void 0)],e.prototype,"setSelectedChapterBackground",null),Ro([Object(d.a)(Qt),No("design:type",Function),No("design:paramtypes",[Object,Qt]),No("design:returntype",void 0)],e.prototype,"selectChapter",null),Ro([Object(d.a)($t),No("design:type",Function),No("design:paramtypes",[Object,Object]),No("design:returntype",void 0)],e.prototype,"selectChapterById",null),Ro([Object(d.a)(ln),No("design:type",Function),No("design:paramtypes",[Object,ln]),No("design:returntype",void 0)],e.prototype,"duplicateChapter",null),Ro([Object(d.a)(gn),No("design:type",Function),No("design:paramtypes",[Object,gn]),No("design:returntype",void 0)],e.prototype,"copyThumbnail",null),Ro([Object(d.a)(Nt),No("design:type",Function),No("design:paramtypes",[Object,Nt]),No("design:returntype",void 0)],e.prototype,"nextChapter",null),Ro([Object(d.a)(Vt),No("design:type",Function),No("design:paramtypes",[Object,Vt]),No("design:returntype",void 0)],e.prototype,"previousChapter",null),Ro([Object(d.a)(Bt),No("design:type",Function),No("design:paramtypes",[Object,Bt]),No("design:returntype",void 0)],e.prototype,"lastChapter",null),Ro([Object(d.a)(Ht),No("design:type",Function),No("design:paramtypes",[Object,Bt]),No("design:returntype",void 0)],e.prototype,"firstChapter",null),Ro([Object(d.a)(pn),No("design:type",Function),No("design:paramtypes",[Object,pn]),No("design:returntype",void 0)],e.prototype,"removeChapter",null),Ro([Object(d.a)(dn),No("design:type",Function),No("design:paramtypes",[Object,dn]),No("design:returntype",void 0)],e.prototype,"resetStoryChaptersState",null),Ro([Object(d.a)(un),No("design:type",Function),No("design:paramtypes",[Object,un]),No("design:returntype",void 0)],e.prototype,"registerChapterThumbnails",null),Ro([Object(d.a)(hn),No("design:type",Function),No("design:paramtypes",[Object,hn]),No("design:returntype",void 0)],e.prototype,"takeChapterPicture",null),Ro([Object(d.a)(bn),No("design:type",Function),No("design:paramtypes",[Object,bn]),No("design:returntype",void 0)],e.prototype,"takeChapterPictureSuccess",null),Ro([Object(d.a)(mn),No("design:type",Function),No("design:paramtypes",[Object,mn]),No("design:returntype",void 0)],e.prototype,"RecordCamera",null),Ro([Object(d.a)(fn),No("design:type",Function),No("design:paramtypes",[Object,fn]),No("design:returntype",void 0)],e.prototype,"setChapterCurrentLayersIndexPosition",null),Ro([Object(d.a)(yn),No("design:type",Function),No("design:paramtypes",[Object,yn]),No("design:returntype",void 0)],e.prototype,"setChapterMedia",null),Ro([Object(d.a)(xn),No("design:type",Function),No("design:paramtypes",[Object,xn]),No("design:returntype",void 0)],e.prototype,"setChapterContentBlocks",null),Ro([Object(d.e)(),No("design:type",Function),No("design:paramtypes",[Ft]),No("design:returntype",void 0)],e,"getStoryChapters",null),Ro([Object(d.e)(),No("design:type",Function),No("design:paramtypes",[Ft]),No("design:returntype",void 0)],e,"getChaptersViewed",null),Ro([Object(d.e)(),No("design:type",Function),No("design:paramtypes",[Ft]),No("design:returntype",void 0)],e,"getSelectedChapterId",null),Ro([Object(d.e)(),No("design:type",Function),No("design:paramtypes",[Ft]),No("design:returntype",void 0)],e,"getSelectedChapter",null),Ro([Object(d.e)(),No("design:type",Function),No("design:paramtypes",[Ft]),No("design:returntype",void 0)],e,"getNextChapter",null),Ro([Object(d.e)(),No("design:type",Function),No("design:paramtypes",[Ft]),No("design:returntype",void 0)],e,"getPreviousChapter",null),Ro([Object(d.e)(),No("design:type",Function),No("design:paramtypes",[Ft]),No("design:returntype",void 0)],e,"getSelectedChapterIndex",null),Ro([Object(d.e)(),No("design:type",Function),No("design:paramtypes",[Ft]),No("design:returntype",void 0)],e,"getSelectedChapterTitle",null),Ro([Object(d.e)(),No("design:type",Function),No("design:paramtypes",[Ft]),No("design:returntype",void 0)],e,"getChapterCount",null),Ro([Object(d.e)(),No("design:type",Function),No("design:paramtypes",[Ft]),No("design:returntype",void 0)],e,"getRegisteredThumbnails",null),Ro([Object(d.e)(),No("design:type",Function),No("design:paramtypes",[Ft]),No("design:returntype",void 0)],e,"getIsChapterAnimated",null),Ro([Object(d.e)(),No("design:type",Function),No("design:paramtypes",[Ft]),No("design:returntype",void 0)],e,"getSelectedChapterReadyState",null),Ro([Object(d.e)(),No("design:type",Function),No("design:paramtypes",[Ft]),No("design:returntype",void 0)],e,"getChaptersLoaded",null),Ro([Object(d.e)(),No("design:type",Function),No("design:paramtypes",[Ft]),No("design:returntype",void 0)],e,"getAllChaptersModelsReady",null),Ro([Object(d.e)(),No("design:type",Function),No("design:paramtypes",[Ft]),No("design:returntype",void 0)],e,"getAllChaptersAnimationsReady",null),Ro([Object(d.e)(),No("design:type",Function),No("design:paramtypes",[Ft]),No("design:returntype",void 0)],e,"getSelectedChapterBackground",null),Ro([Object(d.e)(),No("design:type",Function),No("design:paramtypes",[Ft]),No("design:returntype",void 0)],e,"getAllChaptersBackground",null),Ro([Object(d.e)(),No("design:type",Function),No("design:paramtypes",[Ft]),No("design:returntype",void 0)],e,"getSelectedChapterAudio",null),Ro([Object(d.e)(),No("design:type",Function),No("design:paramtypes",[Ft]),No("design:returntype",void 0)],e,"getSelectedChapterLegend",null),Ro([Object(d.e)(),No("design:type",Function),No("design:paramtypes",[Ft]),No("design:returntype",void 0)],e,"getSelectedChapterClippingPlanes",null),Ro([Object(d.e)(),No("design:type",Function),No("design:paramtypes",[Ft]),No("design:returntype",void 0)],e,"getChapterCamera",null),Ro([Object(d.e)(),No("design:type",Function),No("design:paramtypes",[Ft]),No("design:returntype",Array)],e,"getAllChaptersCurrentLayers",null),Ro([Object(d.e)(),No("design:type",Function),No("design:paramtypes",[Ft]),No("design:returntype",Array)],e,"getSelectedChapterSrcLayers",null),Ro([Object(d.e)(),No("design:type",Function),No("design:paramtypes",[Ft]),No("design:returntype",Array)],e,"getSelectedChapterCurrentLayers",null),Ro([Object(d.e)(),No("design:type",Function),No("design:paramtypes",[Ft]),No("design:returntype",Number)],e,"getSelectedChapterCurrentLayersIndex",null),Ro([Object(d.e)(),No("design:type",Function),No("design:paramtypes",[Ft]),No("design:returntype",Number)],e,"getSelectedChapterCurrentLayersPosition",null),Ro([Object(d.e)(),No("design:type",Function),No("design:paramtypes",[Ft]),No("design:returntype",Array)],e,"getSelectedChapterContentBlocks",null),e=Fo=Ro([Object(d.f)({name:"storyChapters",defaults:Ho})],e),e})();var Qo,$o=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},qo=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const Wo={storedCameras:{},cameraMotion:new Dt,panMode:"rotate",zoomed:!1,lockCamera:!1,cameraFlyTo:void 0};let Ko=(()=>{let e=Qo=class{constructor(e,t){this.cameraService=e,this.store=t}static getStoredCamera(e){return Object(d.h)([Qo],t=>t.storedCameras[e]||null)}static getCameraMotion(e){return e.cameraMotion}static getPanMode(e){return e.panMode}static getZoomed(e){return e.zoomed}static getLockCamera(e){return e.lockCamera}storeCamera(e,t){const n=t.camera||this.cameraService.getCamera(),i=e.getState().storedCameras;i[t.id]=Object.assign({},n),e.patchState({storedCameras:Object.assign({},i)})}clearCamera(e,t){const n=e.getState().storedCameras;delete n[t.id],e.patchState({storedCameras:Object.assign({},n)})}setCameraFlyTo(e,t){e.patchState(immer.produce(e.getState(),e=>{e.cameraFlyTo=t.camera}))}applyCameraPatch(e,t){const n=immer.applyPatches(e.getState(),t.patches);e.patchState(n);const i=void 0===n.cameraFlyTo?this.store.selectSnapshot(Bo.getChapterCamera):n.cameraFlyTo;e.dispatch(new bt(i,!0,1))}moveCamera(e,t){e.patchState({cameraMotion:Object.assign({},t.cameraMotion)})}resetCamera(e,t){return this.cameraService.resetCamera().pipe(Object(Et.a)(()=>{e.patchState({cameraMotion:new Dt})}))}zoomCamera(e,t){const{cameraMotion:n}=e.getState();n.zoom=t.value,e.patchState({cameraMotion:Object.assign({},n)})}panCameraX(e,t){const{cameraMotion:n}=e.getState();n.panX=t.value,e.patchState({cameraMotion:Object.assign({},n)})}panCameraY(e,t){const{cameraMotion:n}=e.getState();n.panY=t.value,e.patchState({cameraMotion:Object.assign({},n)})}rotateCameraX(e,t){const{cameraMotion:n}=e.getState();e.patchState({cameraMotion:Object.assign(Object.assign({},n),{rotateX:t.value})})}rotateCameraY(e,t){const{cameraMotion:n}=e.getState();n.rotateY=t.value,e.patchState({cameraMotion:Object.assign({},n)})}SetCameraMode(e,t){e.patchState({panMode:t.mode})}setZoomed(e,t){e.patchState({zoomed:t.zoomed})}lockCamera(e,t){e.patchState({lockCamera:t.lock})}};return e.\u0275fac=function(t){return new(t||e)(i.Zb(Lt),i.Zb(d.g))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac}),$o([Object(d.a)(ht),qo("design:type",Function),qo("design:paramtypes",[Object,ht]),qo("design:returntype",void 0)],e.prototype,"storeCamera",null),$o([Object(d.a)(gt),qo("design:type",Function),qo("design:paramtypes",[Object,gt]),qo("design:returntype",void 0)],e.prototype,"clearCamera",null),$o([Object(d.a)(It),qo("design:type",Function),qo("design:paramtypes",[Object,It]),qo("design:returntype",void 0)],e.prototype,"setCameraFlyTo",null),$o([Object(d.a)(zt),qo("design:type",Function),qo("design:paramtypes",[Object,zt]),qo("design:returntype",void 0)],e.prototype,"applyCameraPatch",null),$o([Object(d.a)(ft),qo("design:type",Function),qo("design:paramtypes",[Object,ft]),qo("design:returntype",void 0)],e.prototype,"moveCamera",null),$o([Object(d.a)(yt),qo("design:type",Function),qo("design:paramtypes",[Object,yt]),qo("design:returntype",void 0)],e.prototype,"resetCamera",null),$o([Object(d.a)(xt),qo("design:type",Function),qo("design:paramtypes",[Object,xt]),qo("design:returntype",void 0)],e.prototype,"zoomCamera",null),$o([Object(d.a)(wt),qo("design:type",Function),qo("design:paramtypes",[Object,wt]),qo("design:returntype",void 0)],e.prototype,"panCameraX",null),$o([Object(d.a)(Ot),qo("design:type",Function),qo("design:paramtypes",[Object,Ot]),qo("design:returntype",void 0)],e.prototype,"panCameraY",null),$o([Object(d.a)(St),qo("design:type",Function),qo("design:paramtypes",[Object,St]),qo("design:returntype",void 0)],e.prototype,"rotateCameraX",null),$o([Object(d.a)(kt),qo("design:type",Function),qo("design:paramtypes",[Object,kt]),qo("design:returntype",void 0)],e.prototype,"rotateCameraY",null),$o([Object(d.a)(jt),qo("design:type",Function),qo("design:paramtypes",[Object,jt]),qo("design:returntype",void 0)],e.prototype,"SetCameraMode",null),$o([Object(d.a)(Pt),qo("design:type",Function),qo("design:paramtypes",[Object,Pt]),qo("design:returntype",void 0)],e.prototype,"setZoomed",null),$o([Object(d.a)(Mt),qo("design:type",Function),qo("design:paramtypes",[Object,Mt]),qo("design:returntype",void 0)],e.prototype,"lockCamera",null),$o([Object(d.e)(),qo("design:type",Function),qo("design:paramtypes",[ut]),qo("design:returntype",void 0)],e,"getCameraMotion",null),$o([Object(d.e)(),qo("design:type",Function),qo("design:paramtypes",[ut]),qo("design:returntype",void 0)],e,"getPanMode",null),$o([Object(d.e)(),qo("design:type",Function),qo("design:paramtypes",[ut]),qo("design:returntype",void 0)],e,"getZoomed",null),$o([Object(d.e)(),qo("design:type",Function),qo("design:paramtypes",[ut]),qo("design:returntype",void 0)],e,"getLockCamera",null),e=Qo=$o([Object(d.f)({name:"engineCamera",defaults:Wo})],e),e})();var Go=function(e){return e.Select="Select",e.Hide="Hide",e.Paint="Paint",e.Label="Label",e.Isolate="Isolate",e.Fade="Fade",e.Position="Position",e.Quiz="Quiz",e}({}),Zo=function(e){return e.Capture="capture",e.DoNotCaptureShowMessage="do_not_capture_show_message",e.DoNotCapture="do_not_capture",e}({}),Jo=n("z6cu");let Xo=(()=>{class e{constructor(e){this.http=e,this.wikiCache=new Map}getWikiText(e,t=!0){if(t&&this.wikiCache.has(e)){const t=this.wikiCache.get(e);return Object(S.a)(t)}return c.offline?Object(S.a)(""):this.http.get("/search/wiki?name="+e).pipe(Object(k.a)(e=>e.description),Object(_.a)(e=>404===e.status?Object(S.a)(""):Object(Jo.a)(e)),Object(Et.a)(t=>this.wikiCache.set(e,t)))}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(C.b))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var Yo,es=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},ts=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const ns=new pt(0,0,0,0,dt.Hidden);let is=(()=>{let e=Yo=class{constructor(e,t,n,i,o){this.store=e,this.graphService=t,this.engineService=n,this.wikiService=i,this.animationService=o}static getEngine(e){return e.engine}static getReady(e){return e.ready}static getDisplay(e){return e.display}static getScrollMode(e){return e.scrollMode}static getVisible(e){return e.visible}static getViewGraph(e){return e.viewGraph}static getViewGraphNode(e){return t=>e.viewGraph.nodes[t]}static getEnginePosition(e){return e.enginePosition}static getChapter(e){return e.chapter}static getActiveTool(e){return e.activeTool}static getShowCameraBar(e){return e.showCameraBar}static getShowProgressBar(e){return e.showProgressBar}static getShowLabels(e){return e.showLabels}static getChapterInit(e){return e.chapterInit}static getAnimationPlaying(e){return e.animationPlaying}static getPlayAudio(e){return e.playAudio}static getAutoplay(e){return e.autoplay}static getXrayModeEnabled(e){return e.xrayModeEnabled}static getHoveredNode(e){return e.hoveredNode}static getLabelEditNode(e){return e.labelEditNode}static getQuerying(e){return e.queryingWiki}static getContextmenu(e){return e.contextmenu}static getPlaybackSpeed(e){return e.playbackSpeed}load(e,t){e.dispatch(new ne("engine"))}loadSuccess({patchState:e},t){e({engine:t.result})}setReady(e,t){e.patchState({ready:t.ready})}setDisplay(e,t){e.patchState({display:t.display})}setZoomViaScrollAllowed(e,t){e.patchState({scrollMode:t.scrollMode})}setVisible(e,t){e.patchState({visible:t.visible})}setEnginePosition(e,t){e.patchState({enginePosition:Object.assign(Object.assign({},t.position),{right:t.position.left+t.position.width,bottom:t.position.top+t.position.height})})}resetEnginePosition(e,t){e.patchState({enginePosition:ns})}setChapter(e,t){e.patchState({chapter:t.chapterId})}setChapterInit(e,t){e.patchState({chapterInit:t.chapterInit})}setActiveTool(e,t){e.patchState({activeTool:t.tool})}setGraph(e,t){e.patchState({viewGraph:Object.assign({},t.graph)})}clearGraph(e,t){e.patchState({viewGraph:{nodes:{},successors:{},predecessors:{},roots:{}}})}setXrayMode(e,t){e.patchState({xrayModeEnabled:t.enabled})}centerCameraOnVisible(e,t){const n=this.engineService.getVisibleLeaves(),i=this.engineService.getBoundaryFromObjects(n),o=this.engineService.getCameraLookAt();o.look={x:(i.xmin+i.xmax)/2,y:(i.ymin+i.ymax)/2,z:(i.zmin+i.zmax)/2},Human.renderer.camera.fly.flyTo(o)}toggleProgressBar(e,t){e.patchState({showProgressBar:t.show})}toggleCameraBar(e,t){e.patchState({showCameraBar:t.show})}toggleLabels(e,t){const n=null!=t.show?t.show:!e.getState().showLabels;e.patchState({showLabels:n})}synchronizeVisibleNodes(e,t){const n=e.getState().viewGraph,i=this.stateMapToNodeIds(n,t.leafVisibilityState),o={};i.forEach(e=>{const n=this.engineService.getLeafObjects(e).reduce((e,n)=>e||t.nodes[n].shown,!1);o[e]={shown:n}}),this.graphService.synchronize(Object.assign({},n),{shown:"trueWins"},o),e.patchState({viewGraph:Object.assign({},n)})}synchronizeRenderableNodes(e,t){const n=e.getState().viewGraph,i=this.stateMapToNodeIds(n,t.leafRenderableState),o={};i.forEach(e=>{o[e]={renderable:!0}}),this.graphService.synchronize(n,{renderable:"falseWins"},o)}synchronizePickableNodes(e,t){const n=e.getState().viewGraph,i=this.stateMapToNodeIds(n,t.leafPickableState),o={};i.forEach(e=>{const t=this.engineService.getLeafObjects(e).reduce((e,t)=>e||Human.scene.objects[t].pickable,!1);o[e]={pickable:t}}),this.graphService.synchronize(n,{pickable:"trueWins"},o),e.patchState({viewGraph:Object.assign({},n)})}playChapterAnimation(e,t){const n=this.store.selectSnapshot(Bo.getSelectedChapter),i=Object(X.get)(n,"ui.play.count",0);this.animationService.play({startChapterId:n.id,loop:-1===i,numChapters:1,queue:!1}),e.getState().animationPlaying||this.animationService.pause()}toggleAnimation(e,t){const n=this.store.selectSnapshot(Bo.getSelectedChapterId);t.play?this.animationService.unpause(n):this.animationService.pause()}setAnimationPlaying(e,t){e.patchState({animationPlaying:t.playing})}setPlaybackSpeed(e,t){e.patchState({playbackSpeed:t.speed})}playAudio(e,t){e.patchState({playAudio:t.play})}setAutoplay(e,t){e.patchState({autoplay:t.enable})}setObjectLayerOrder(e,t){const n=e.getState().viewGraph,i=isNaN(t.layer)?0:t.layer;let o=[];t.nodes.forEach(e=>{const t=this.graphService.getDescendants(n,e.id,!0);o=o.concat(t)}),o.forEach(e=>{this.engineService.setObjectLayer(e,i),this.graphService.setState(n,e,{layer:i})}),e.patchState({viewGraph:Object.assign({},n)})}setObjectDisplayName(e,t){const n=Human.scene.objects[t.nodeId];n&&(n.displayName=t.displayName)}autoSortObjectLayers(e,t){const n=e.getState().viewGraph;let i=0;const o=Human.scene.getEnabledLeaves(),s=this.engineService.getObjectLayerValues(o);Object.keys(s).map(e=>parseInt(e,10)).sort((e,t)=>e-t).forEach(e=>{s[e].sort((e,t)=>t.value-e.value).forEach(e=>{const t=20*i;this.engineService.setObjectLayer(e.nodeId,t),this.graphService.setState(n,e.nodeId,{layer:t}),i++})}),e.patchState({viewGraph:Object.assign({},n)})}resetObjectLayers(e,t){const n=e.getState().viewGraph;Human.scene.getEnabledLeaves().forEach(e=>{this.engineService.setObjectLayer(e,0),this.graphService.setState(n,e,{layer:0})}),e.patchState({viewGraph:Object.assign({},n)})}setPostProcessingEffects(e,{effects:t}){this.engineService.setPostProcessingFeatures(t)}setProperties(e,{properties:t}){this.engineService.setProperties(Object.assign({},t))}setTransparencyMode(e,{mode:t}){this.engineService.setTransparencyMode(t)}expandNode(e,t){const n=this.store.selectSnapshot(Yo.getViewGraph);Ye.getAncestors(n,t.node.id,!0).forEach(e=>{n.nodes[e].boolState.expanded=!0}),this.store.dispatch(new pe(n))}collapseNode(e,t){const n=this.store.selectSnapshot(Yo.getViewGraph);n.nodes[t.node.id].boolState.expanded=!1,this.store.dispatch(new pe(n))}hoverNode(e,t){e.patchState({hoveredNode:t.node})}setLabelEditNode(e,t){e.patchState({labelEditNode:t.node})}queryNodeInfo(e,{node:t}){e.patchState({queryingWiki:!0}),this.wikiService.getWikiText(t.label).pipe(Object(E.a)(()=>e.patchState({queryingWiki:!1}))).subscribe(n=>e.dispatch(new Ke(t,n)),()=>e.dispatch(new Ge(t)))}queryNodeInfoSuccess(e,{node:t,description:n}){e.dispatch(new qe(t,n))}setNodeInfo(e,{node:t,description:n}){const i=this.store.selectSnapshot(Yo.getViewGraph),o=i.nodes[t.id];o&&(o.description=n,this.store.dispatch(new pe(i)))}setContextMenu(e,t){e.patchState({contextmenu:{node:t.node,hit:t.hit}})}stateMapToNodeIds(e,t){const n=Object.keys(t).map(t=>this.engineService.getNode(e,t)).filter(e=>!!e).map(e=>e.id);return new Set(n)}};return e.\u0275fac=function(t){return new(t||e)(i.Zb(d.g),i.Zb(tt),i.Zb(lt),i.Zb(Xo),i.Zb(Do))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac}),es([Object(d.a)(te),ts("design:type",Function),ts("design:paramtypes",[Object,te]),ts("design:returntype",void 0)],e.prototype,"load",null),es([Object(d.a)(ne),ts("design:type",Function),ts("design:paramtypes",[Object,ne]),ts("design:returntype",void 0)],e.prototype,"loadSuccess",null),es([Object(d.a)(ie),ts("design:type",Function),ts("design:paramtypes",[Object,ie]),ts("design:returntype",void 0)],e.prototype,"setReady",null),es([Object(d.a)(oe),ts("design:type",Function),ts("design:paramtypes",[Object,oe]),ts("design:returntype",void 0)],e.prototype,"setDisplay",null),es([Object(d.a)(se),ts("design:type",Function),ts("design:paramtypes",[Object,se]),ts("design:returntype",void 0)],e.prototype,"setZoomViaScrollAllowed",null),es([Object(d.a)(ae),ts("design:type",Function),ts("design:paramtypes",[Object,ae]),ts("design:returntype",void 0)],e.prototype,"setVisible",null),es([Object(d.a)(Fe),ts("design:type",Function),ts("design:paramtypes",[Object,Fe]),ts("design:returntype",void 0)],e.prototype,"setEnginePosition",null),es([Object(d.a)(Ae),ts("design:type",Function),ts("design:paramtypes",[Object,Ae]),ts("design:returntype",void 0)],e.prototype,"resetEnginePosition",null),es([Object(d.a)(ge),ts("design:type",Function),ts("design:paramtypes",[Object,ge]),ts("design:returntype",void 0)],e.prototype,"setChapter",null),es([Object(d.a)(he),ts("design:type",Function),ts("design:paramtypes",[Object,he]),ts("design:returntype",void 0)],e.prototype,"setChapterInit",null),es([Object(d.a)(ke),ts("design:type",Function),ts("design:paramtypes",[Object,ke]),ts("design:returntype",void 0)],e.prototype,"setActiveTool",null),es([Object(d.a)(pe),ts("design:type",Function),ts("design:paramtypes",[Object,pe]),ts("design:returntype",void 0)],e.prototype,"setGraph",null),es([Object(d.a)(de),ts("design:type",Function),ts("design:paramtypes",[Object,pe]),ts("design:returntype",void 0)],e.prototype,"clearGraph",null),es([Object(d.a)(ue),ts("design:type",Function),ts("design:paramtypes",[Object,ue]),ts("design:returntype",void 0)],e.prototype,"setXrayMode",null),es([Object(d.a)(ye),ts("design:type",Function),ts("design:paramtypes",[Object,ye]),ts("design:returntype",void 0)],e.prototype,"centerCameraOnVisible",null),es([Object(d.a)(Ce),ts("design:type",Function),ts("design:paramtypes",[Object,Ce]),ts("design:returntype",void 0)],e.prototype,"toggleProgressBar",null),es([Object(d.a)(Oe),ts("design:type",Function),ts("design:paramtypes",[Object,Oe]),ts("design:returntype",void 0)],e.prototype,"toggleCameraBar",null),es([Object(d.a)(Se),ts("design:type",Function),ts("design:paramtypes",[Object,Se]),ts("design:returntype",void 0)],e.prototype,"toggleLabels",null),es([Object(d.a)(xe),ts("design:type",Function),ts("design:paramtypes",[Object,xe]),ts("design:returntype",void 0)],e.prototype,"synchronizeVisibleNodes",null),es([Object(d.a)(ve),ts("design:type",Function),ts("design:paramtypes",[Object,ve]),ts("design:returntype",void 0)],e.prototype,"synchronizeRenderableNodes",null),es([Object(d.a)(we),ts("design:type",Function),ts("design:paramtypes",[Object,we]),ts("design:returntype",void 0)],e.prototype,"synchronizePickableNodes",null),es([Object(d.a)(_e),ts("design:type",Function),ts("design:paramtypes",[Object,_e]),ts("design:returntype",void 0)],e.prototype,"playChapterAnimation",null),es([Object(d.a)(je),ts("design:type",Function),ts("design:paramtypes",[Object,je]),ts("design:returntype",void 0)],e.prototype,"toggleAnimation",null),es([Object(d.a)(Pe),ts("design:type",Function),ts("design:paramtypes",[Object,Pe]),ts("design:returntype",void 0)],e.prototype,"setAnimationPlaying",null),es([Object(d.a)(Me),ts("design:type",Function),ts("design:paramtypes",[Object,Me]),ts("design:returntype",void 0)],e.prototype,"setPlaybackSpeed",null),es([Object(d.a)(Ie),ts("design:type",Function),ts("design:paramtypes",[Object,Ie]),ts("design:returntype",void 0)],e.prototype,"playAudio",null),es([Object(d.a)(Te),ts("design:type",Function),ts("design:paramtypes",[Object,Te]),ts("design:returntype",void 0)],e.prototype,"setAutoplay",null),es([Object(d.a)(Ue),ts("design:type",Function),ts("design:paramtypes",[Object,Ue]),ts("design:returntype",void 0)],e.prototype,"setObjectLayerOrder",null),es([Object(d.a)(Le),ts("design:type",Function),ts("design:paramtypes",[Object,Le]),ts("design:returntype",void 0)],e.prototype,"setObjectDisplayName",null),es([Object(d.a)(De),ts("design:type",Function),ts("design:paramtypes",[Object,De]),ts("design:returntype",void 0)],e.prototype,"autoSortObjectLayers",null),es([Object(d.a)(Ee),ts("design:type",Function),ts("design:paramtypes",[Object,Ee]),ts("design:returntype",void 0)],e.prototype,"resetObjectLayers",null),es([Object(d.a)(Re),ts("design:type",Function),ts("design:paramtypes",[Object,Re]),ts("design:returntype",void 0)],e.prototype,"setPostProcessingEffects",null),es([Object(d.a)(Ne),ts("design:type",Function),ts("design:paramtypes",[Object,Ne]),ts("design:returntype",void 0)],e.prototype,"setProperties",null),es([Object(d.a)(Ve),ts("design:type",Function),ts("design:paramtypes",[Object,Ve]),ts("design:returntype",void 0)],e.prototype,"setTransparencyMode",null),es([Object(d.a)(He),ts("design:type",Function),ts("design:paramtypes",[Object,He]),ts("design:returntype",void 0)],e.prototype,"expandNode",null),es([Object(d.a)(Be),ts("design:type",Function),ts("design:paramtypes",[Object,Be]),ts("design:returntype",void 0)],e.prototype,"collapseNode",null),es([Object(d.a)(Qe),ts("design:type",Function),ts("design:paramtypes",[Object,Qe]),ts("design:returntype",void 0)],e.prototype,"hoverNode",null),es([Object(d.a)($e),ts("design:type",Function),ts("design:paramtypes",[Object,$e]),ts("design:returntype",void 0)],e.prototype,"setLabelEditNode",null),es([Object(d.a)(We),ts("design:type",Function),ts("design:paramtypes",[Object,We]),ts("design:returntype",void 0)],e.prototype,"queryNodeInfo",null),es([Object(d.a)(Ke),ts("design:type",Function),ts("design:paramtypes",[Object,Ke]),ts("design:returntype",void 0)],e.prototype,"queryNodeInfoSuccess",null),es([Object(d.a)(qe),ts("design:type",Function),ts("design:paramtypes",[Object,qe]),ts("design:returntype",void 0)],e.prototype,"setNodeInfo",null),es([Object(d.a)(me),ts("design:type",Function),ts("design:paramtypes",[Object,me]),ts("design:returntype",void 0)],e.prototype,"setContextMenu",null),es([Object(d.e)(),ts("design:type",Function),ts("design:paramtypes",[Ze]),ts("design:returntype",void 0)],e,"getEngine",null),es([Object(d.e)(),ts("design:type",Function),ts("design:paramtypes",[Ze]),ts("design:returntype",void 0)],e,"getReady",null),es([Object(d.e)(),ts("design:type",Function),ts("design:paramtypes",[Ze]),ts("design:returntype",void 0)],e,"getDisplay",null),es([Object(d.e)(),ts("design:type",Function),ts("design:paramtypes",[Ze]),ts("design:returntype",void 0)],e,"getScrollMode",null),es([Object(d.e)(),ts("design:type",Function),ts("design:paramtypes",[Ze]),ts("design:returntype",void 0)],e,"getVisible",null),es([Object(d.e)(),ts("design:type",Function),ts("design:paramtypes",[Ze]),ts("design:returntype",void 0)],e,"getViewGraph",null),es([Object(d.e)(),ts("design:type",Function),ts("design:paramtypes",[Ze]),ts("design:returntype",void 0)],e,"getViewGraphNode",null),es([Object(d.e)(),ts("design:type",Function),ts("design:paramtypes",[Ze]),ts("design:returntype",void 0)],e,"getEnginePosition",null),es([Object(d.e)(),ts("design:type",Function),ts("design:paramtypes",[Ze]),ts("design:returntype",void 0)],e,"getChapter",null),es([Object(d.e)(),ts("design:type",Function),ts("design:paramtypes",[Ze]),ts("design:returntype",void 0)],e,"getActiveTool",null),es([Object(d.e)(),ts("design:type",Function),ts("design:paramtypes",[Ze]),ts("design:returntype",void 0)],e,"getShowCameraBar",null),es([Object(d.e)(),ts("design:type",Function),ts("design:paramtypes",[Ze]),ts("design:returntype",void 0)],e,"getShowProgressBar",null),es([Object(d.e)(),ts("design:type",Function),ts("design:paramtypes",[Ze]),ts("design:returntype",void 0)],e,"getShowLabels",null),es([Object(d.e)(),ts("design:type",Function),ts("design:paramtypes",[Ze]),ts("design:returntype",void 0)],e,"getChapterInit",null),es([Object(d.e)(),ts("design:type",Function),ts("design:paramtypes",[Ze]),ts("design:returntype",void 0)],e,"getAnimationPlaying",null),es([Object(d.e)(),ts("design:type",Function),ts("design:paramtypes",[Ze]),ts("design:returntype",void 0)],e,"getPlayAudio",null),es([Object(d.e)(),ts("design:type",Function),ts("design:paramtypes",[Ze]),ts("design:returntype",void 0)],e,"getAutoplay",null),es([Object(d.e)(),ts("design:type",Function),ts("design:paramtypes",[Ze]),ts("design:returntype",void 0)],e,"getXrayModeEnabled",null),es([Object(d.e)(),ts("design:type",Function),ts("design:paramtypes",[Ze]),ts("design:returntype",void 0)],e,"getHoveredNode",null),es([Object(d.e)(),ts("design:type",Function),ts("design:paramtypes",[Ze]),ts("design:returntype",void 0)],e,"getLabelEditNode",null),es([Object(d.e)(),ts("design:type",Function),ts("design:paramtypes",[Ze]),ts("design:returntype",void 0)],e,"getQuerying",null),es([Object(d.e)(),ts("design:type",Function),ts("design:paramtypes",[Ze]),ts("design:returntype",void 0)],e,"getContextmenu",null),es([Object(d.e)(),ts("design:type",Function),ts("design:paramtypes",[Ze]),ts("design:returntype",void 0)],e,"getPlaybackSpeed",null),e=Yo=es([Object(d.f)({name:"engine",defaults:{loading:!1,ready:!1,viewGraph:{nodes:{},successors:{},predecessors:{},roots:{}},hoveredNode:void 0,labelEditNode:void 0,queryingWiki:!1,engine:"",chapter:"",chapterInit:{id:"",init:!1,camera:!1,annotations:!1,graph:!1,properties:!1,particles:!1,clips:!1,postprocessing:!1,transparency:!1},showProgressBar:!0,showCameraBar:!0,showLabels:!0,activeTool:Go.Select,animationPlaying:!0,autoplay:!0,playAudio:!1,display:!0,visible:!0,scrollMode:Zo.Capture,playbackSpeed:1,xrayModeEnabled:!1,contextmenu:{node:null,hit:null}},children:[Ko]})],e),e})();var os=n("2Vo4"),ss=n("VRyK"),rs=n("itXk"),as=n("xgIS"),cs=n("Kj3r"),ls=n("/uUt"),ps=n("OsX3"),ds=n("3UWI"),us=n("Zy1z");class gs{}class hs{}class bs{}var ms=n("ofXK"),fs=n("2Yyj"),ys=n.n(fs),xs=n("Kd/A"),vs=n.n(xs),ws=n("Hfs6"),Os=n.n(ws),Cs=n("VLs4"),Ss=n.n(Cs),ks=n("1IWC"),_s=n.n(ks),js=n("Paii"),Ps=n.n(js),Ms=n("vT00");const Is={title:"English",lang:"en",country:"us",id:"en-US"},zs=[Is,{title:"Espa\xf1ol",lang:"es",country:"es",id:"es-ES"},{title:"\u4e2d\u6587(\u7b80\u4f53)",lang:"zh",country:"cn",id:"zh-CN"},{title:"Fran\xe7ais",lang:"fr",country:"fr",id:"fr-FR"},{title:"Deutsch",lang:"de",country:"de",id:"de-DE"},{title:"Italiano",lang:"it",country:"it",id:"it-IT"},{title:"\u65e5\u672c\u8a9e",lang:"ja",country:"ja",id:"ja"},{title:"Portugu\xeas",lang:"pt",country:"pt",id:"pt-PT"}];function Ts(){let e="";try{e=localStorage.getItem("locale")}catch(t){}return(zs.find(t=>t.id===e)||Is).id}[ys.a,vs.a,Os.a,Ss.a,_s.a,Ps.a,n.n(Ms).a].forEach(e=>{Object(ms.x)(e)});let Us=(()=>{class e{static forRoot(){return{ngModule:e,providers:[{provide:i.w,useFactory:Ts}]}}}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[ms.c]]}),e})(),Ls=(()=>{class e{constructor(e,t,n=Is.lang,i=!1){this.id=e,this.type=t,this.lang=n,this.preview=i}}return e.type="[Story] Load Current Story",e})(),Ds=(()=>{class e{constructor(e){this.story=e}}return e.type="[Story] Replace the Story",e})(),Es=(()=>{class e{constructor(e){this.id=e}}return e.type="[Story] Set the Story ID",e})(),Fs=(()=>{class e{constructor(e){this.displayName=e}}return e.type="[Story] Set Story Text",e})(),As=(()=>{class e{constructor(e){this.tags=e}}return e.type="[Story] Set Story Tags",e})(),Rs=(()=>{class e{constructor(e,t,n){this.id=e,this.type=t,this.reset=n}}return e.type="[Story] Set Incoming Story Id",e})(),Ns=(()=>{class e{constructor(){}}return e.type="[Story] Load Story Chunk",e})(),Vs=(()=>{class e{constructor(e){this.chapterId=e}}return e.type="[Story] Reorder Load Chunks",e})(),Hs=(()=>{class e{constructor(e){this.chunk=e}}return e.type="[Story] Load Story Chunk Success",e})(),Bs=(()=>{class e{constructor(e,t,n,i){this.id=e,this.story=t,this.type=n,this.chapterIdx=i}}return e.type="[Story] Build Story In Engine From Story Model",e})(),Qs=(()=>{class e{constructor(e,t,n){this.story=e,this.id=t,this.type=n}}return e.type="[Story] Load Success",e})(),$s=(()=>{class e{constructor(e,t){this.id=e,this.type=t}}return e.type="[Story] Load Fail",e})(),qs=(()=>{class e{constructor(e,t,n=Is.lang){this.id=e,this.type=t,this.lang=n}}return e.type="[Story] Import",e})(),Ws=(()=>{class e{constructor(e,t,n){this.story=e,this.id=t,this.type=n}}return e.type="[Story] Import Success",e})(),Ks=(()=>{class e{constructor(){}}return e.type="[Story] Clear",e})(),Gs=(()=>{class e{constructor(){}}return e.type="[Story] Synchronize Chapters",e})(),Zs=(()=>{class e{constructor(){}}return e.type="[Story] Human Ready (Web)",e})(),Js=(()=>{class e{constructor(){}}return e.type="[Story] Human Ready (SDK)",e})();var Xs=n("cp0P");class Ys{}function er(e,...t){return()=>new Promise(n=>{e(...t,()=>{n()})})}let tr=(()=>{class e{constructor(){}getOnlyText(e){return e.map(e=>{switch(e.type){case Pi.Markdown:return e.markdown}}).join("")}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const nr=["reflections","lights"],ir=["material","geometry","transform"],or=["tweens","morph"];let sr=(()=>{class e{constructor(e,t,n,i){this.http=e,this.engineService=t,this.chapterService=n,this.contentBlocksService=i}getShownObjectsFromChapter(e){const t=[];return Object.entries(e.synchronization).forEach(([e,n])=>{n.shown&&t.push(e)}),t}getChapterLoadChunks(e,t,n){const i=this.getShownObjectsFromChapter(t),o=new hs;return o.activate=!1,o.chapterId=t.id,o.objects=i,o.storyId=e,o.assetTypes=[...ir,...or,...nr],o.readyState={model:!0,animation:!0},[o]}getOnDemandLoadChunks(e,t){let n=[];return Human.timeline.rootTimelines[e]._chapters.forEach(i=>{const o=this.getChapterLoadChunks(e,i,t);n=i.id===t.targetChapterId?[...o,...n]:[...n,...o]}),n}getChapterIndex(e,t){return Human.timeline.rootTimelines[e]?Human.timeline.rootTimelines[e]._chapters.findIndex(e=>e.id===t):-1}getStory(e,t,n="en"){const i=t===s.Bookmark?this.getBookmark(e):this.getContent(e);if("en"===n)return i;{let o;return i.pipe(Object(Oo.a)(i=>(o=i,this.getStoryTranslation(e,t,n)))).pipe(Object(k.a)(e=>this.translateStory(o,e)),Object(_.a)(()=>i))}}getContentRoot(){return!0===c.offline?"undefined"==typeof localBaseDirectory?"":localBaseDirectory:"/"}getContent(e){return this.http.get(this.getContentRoot()+`content/modules/${e}.json`).pipe(Object(k.a)(e=>e))}getBookmark(e){return this.http.get("/search/bookmarks/data",{params:{be:e}}).pipe(Object(k.a)(e=>e.bookmark))}getLoadConfig(e,t=0){const n=new bs;return n.chapterAssetBundle=!0,n.targetChapterId=Human.timeline.rootTimelines[e]._chapters[t].id,n.targetChapterConfig={global:{clipping:!0,graph:!0,camera:!0,properties:!0,transparencyMode:!0,postprocess:!0},static:{labels:!0},dynamic:{timeline:!0,particles:!0}},n.sortBy="chapter",n}buildStory(e,t,n){Human.events.fire("modules.fetch.start",e),Human.modules.moduleData[e]=t;const i=Object.assign({},t);return i.moduleId=e,new q.a(t=>{Human.modules.create(e,i,()=>{Human.modules.load(e,Object.values(Human.scene.rootObjects),[...nr],()=>{Human.modules.activate(e,0,{},()=>{t.next(!0),t.complete()})})})})}getStoryChapters(e,t){const n=Human.modules.moduleData[e];return Human.timeline.rootTimelines[e]._chapters.map((e,i)=>this.chapterService.fromHumanChapter(n,t,e,i))}getStoryLoadChunks(e,t){let n=[];return n=this.getOnDemandLoadChunks(e,t),n.map(e=>Object.assign(Object.assign({},e),{chunkId:Un.idWithPrefix("chunk")}))}loadStoryChunk(e,t){const n=e.objects.map(e=>Human.scene.objects[e]);e.storyId?Human.modules.load(e.storyId,n,e.assetTypes,()=>{t()}):this.engineService.loadGraphObject(e.objects[0]).subscribe(()=>{t()})}unloadStory(e,t=!0){const n=(e?[e]:Object.keys(Human.modules.modules)).map(e=>this.hardDeleteStory(e,t));return new q.a(e=>{n.length?Object(Xs.a)(n).subscribe(()=>{e.next(!0),e.complete()}):(e.next(!0),e.complete())})}createLoadObjectChunk(e){const t=new hs;return t.assetTypes=[...ir,...or],t.objects=[e],t}hardDeleteStory(e,t=!0){const n=(e in Human.modules.modules?Human.modules.modules[e].sceneGraph:[]).map(e=>Human.scene.objects[e.objectId]).filter(e=>!!e),i=Object(X.flatten)(n.map(e=>e.getLeafObjects())),o=er(Human.modules.deactivate,e,{}),s=er(Human.modules.unload,e,i,["geometries","morphs","reflections","tweens","lights","materials","transforms"]),r=er(Human.modules.destroy,e);return new q.a(n=>{(Human.timeline.activeRoot&&Human.timeline.activeRoot.id===e?o():Promise.resolve({})).then(()=>t?s():Promise.resolve({})).then(()=>r()).then(()=>(n.next(),void n.complete()))})}getStoryTranslation(e,t,n){return this.http.get(t===s.Bookmark?`/search/bookmarks/tr/${n}/${e}`:`/tr/${n}/${e}.json`).pipe(Object(k.a)(e=>Object(I.plainToClass)(Ys,e)))}getStoryType(e){return e.indexOf("/")>=0?s.Module:s.Bookmark}translateStory(e,t){const n=e.chapters||[],i=e.sceneGraph||[],o=t.objects||{},s=t.chapters||[];return e.displayName=t.displayName||e.displayName,e.description=t.description||e.description,i.forEach(e=>{(e.objects||[]).forEach(e=>{this.translateObject(e,o)})}),n.forEach((e,t)=>{const n=s[t];if(n){this.translateMetaInfo(e,n);const t=n.annotations||[];(e.annotations||[]).forEach((e,n)=>{const i=t[n];i&&this.translateMetaInfo(e,i)});const i=n.hotspots||[];(e.hotspots||[]).forEach((e,t)=>{const n=i[t];n&&this.translateMetaInfo(e,n)})}}),e}translateMetaInfo(e,t){const{title:n,description:i}=t;e.hasOwnProperty("displayName")&&(e.displayName=n),e.hasOwnProperty("title")&&(e.title=n),e.hasOwnProperty("description")&&(e.description=i)}translateObject(e,t){const n=t[e.objectId];n&&(e.displayName=n);const i=e.objects;i&&i.forEach(e=>{this.translateObject(e,t)})}exportWrittenContent(e,t,n){const i=[];return i.push(`\n${e.displayName}\n    `),t.forEach((e,t)=>{i.push(`\n---\n\n# Chapter ${t+1}: ${e.info.displayName||"-No Title-"}\n\n${e.info.description||"-No Description-"}\n      `),e.legend.length&&(i.push("\n## Legend\n"),e.legend.forEach(e=>{i.push(`\n* ${e.label} (${Eo.rgbToHex(e.colors,!0)})\n`)}));const o=n.filter(t=>t.chapterId===e.id);o.length&&(i.push("\n## Labels\n"),o.forEach(e=>{i.push(`\n* ${e.title}\n`),e.description&&i.push(`\n  > ${e.description}\n`)}))}),i.join("")}exportQuizKey(e){const t=[];return e.forEach((e,n)=>{switch(t.push(`\n# QUESTION ${n+1} (${Ii[e.type]})\n\n## PROMPT\n${this.contentBlocksService.getOnlyText(e.questionPrompt)}\n      `),e.type){case Mi.MultipleChoice:e.data.options.forEach((n,i)=>{t.push(`\n## ANSWER ${i+1} ${e.data.correctAnswer===n.value?"- CORRECT":""}\n${n.label}\n            `)});break;case Mi.SelectAnatomy:t.push("\n## ANSWERS\n          "),e.data.correctAnswer.forEach((e,n)=>{t.push(`\n${e}\n            `)});break;case Mi.LabelAnatomy:e.data.options.forEach((e,n)=>{t.push(`\n## ANSWER ${n+1}\n${e.label.title}\n            `)})}this.contentBlocksService.getOnlyText(e.explanation).length&&t.push(`\n  \n## EXPLANATION\n${this.contentBlocksService.getOnlyText(e.explanation)}\n        `),t.push("\n\n\n      ")}),t.join("")}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(C.b),i.Zb(lt),i.Zb(Zi),i.Zb(tr))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function rr(e,t,n){const i=function(e,t){const n={};for(const i of e){const e=Object.keys(t[i]);for(const t of e)n[t]=!1}return n}(t,n);return e.map(e=>Object.assign(Object.assign({},e),{showObjects:Object.assign(Object.assign({},e.showObjects),i),selectObjects:Object.assign(Object.assign({},e.selectObjects),i),pickThroughObjects:Object.assign(Object.assign({},e.pickThroughObjects),i)}))}function ar(e){return e.split("/").length>1?s.Module:s.Bookmark}function cr(e,t){return e.map(e=>{if(!Object(X.isEmpty)(e.lights))return e;const n={libraries:[...t],lights:[]};return Object.assign(Object.assign({},e),{lights:n})})}function lr(e){return e.customData&&e.customData.particleSystems?e.customData.particleSystems.reduce((e,t)=>(e[Oi.getParticleIdRoot(t.id)]=t.id,e),{}):{}}function pr(e,t){return e.customData&&e.customData.particleSystems?e.customData.particleSystems.map(e=>{const n=Oi.getParticleIdRoot(e.id);return Object.assign(Object.assign({},e),{id:t[n]})}):[]}function dr(e,t){return e.map(e=>(e.customData&&e.customData.particleSystems&&(e.customData.particleSystems=e.customData.particleSystems.map(e=>t[Oi.getParticleIdRoot(e)])),e))}function ur(e,t){return e.map(e=>e.id).reduce((n,i)=>(e.some(e=>e.id===i&&Object(X.get)(e,"customData.particleSystems",[]).length>0)&&(n[i]=t),n),{})}function gr(e,t,n,i,o=s.Bookmark,r=Un.idWithPrefix){const{sceneGraph:a,graphsMerged:c,objectIdsUniqueToNew:l,objectIdsUniqueToOriginal:p}=function(e,t){const n=e=>void 0!==e.objectId,[i,o]=Object(X.partition)(e,n),[s,r]=Object(X.partition)(t,n),a=function(e,t){return t.reduce((t,n)=>{for(const i of e)Object(X.isEqual)(i,n)||t.push(n);return t},e)}(o,r),{newSceneGraph:c,graphsMerged:l,objectIdsUniqueToNew:p,objectIdsUniqueToOriginal:d}=function(e,t){const n=e.reduce((e,t)=>(e[t.objectId]=t,e),{}),i=t.reduce((e,t)=>{if(void 0===e.nodes[t.objectId])return e.nodes[t.objectId]=t,e;if(!Object(X.isEqual)(t,e.nodes[t.objectId])){const n=function(e,t){const n={},i={};return{root:function e(t,o){if(t.objectId!==o.objectId)return n[o.objectId]=!0,[t,o];if(void 0===t.objects&&o.objects){for(const e of o.objects)n[e.objectId]=!0;return[Object.assign({},o)]}if(t.objects&&void 0===o.objects){for(const e of t.objects)i[e.objectId]=!0;return[Object.assign({},t)]}if(void 0===t.objects&&void 0===o.objects)return[Object.assign({},t)];const s=[];for(const n of t.objects){const t=o.objects.find(e=>e.objectId===n.objectId);t?s.push(e(n,t)):(i[n.objectId]=!0,s.push(n))}for(const i of o.objects)t.objects.find(e=>e.objectId===i.objectId)||(n[i.objectId]=!0,s.push(i));const r=Object.assign({},t);return r.objects=Object(X.flatten)(s),[r]}(e,t),objectIdsUniqueToNew:n,objectIdsUniqueToOriginal:i}}(e.nodes[t.objectId],t);e.nodes[t.objectId]=n.root[0],e.graphsMerged.push(t.objectId),e.objectIdsUniqueToNew[t.objectId]=n.objectIdsUniqueToNew,e.objectIdsUniqueToOriginal[t.objectId]=n.objectIdsUniqueToOriginal}return e},{nodes:n,graphsMerged:[],objectIdsUniqueToNew:{},objectIdsUniqueToOriginal:{}});return{newSceneGraph:Object.keys(i.nodes).reduce((e,t)=>(e.push(i.nodes[t]),e),[]),graphsMerged:i.graphsMerged,objectIdsUniqueToNew:i.objectIdsUniqueToNew,objectIdsUniqueToOriginal:i.objectIdsUniqueToOriginal}}(i,s);return{sceneGraph:[...a,...c],graphsMerged:l,objectIdsUniqueToNew:p,objectIdsUniqueToOriginal:d}}(e.sceneGraph,n.sceneGraph),d=function(e,t){const n=(e,t)=>Object(X.uniq)([...e,...t]);return{lights:n(e.lights,t.lights),tweens:n(e.tweens,t.tweens),reflections:n(e.reflections,t.reflections)}}(e.assetLibraries,n.assetLibraries),u=function(e,t,n,i){e=e||{},t=t||{};const o=(e,t)=>t.includes("/")?t:`${function(e){return ar(e)===s.Bookmark?e:e.split("/").pop()}(e)}/${t}`;return Object.assign(Object.assign({},Object(X.mapKeys)(e,(e,t)=>o(n,t))),Object(X.mapKeys)(t,(e,t)=>o(i,t)))}(e.reflections,n.reflections,t,i),{colorRecipes:g,newColorRecipeIds:h}=function(e,t,n){e=e||{},t=t||{};const i=Object.keys(t).reduce((e,i)=>{const o=n("color-recipe-"+i);return e.newColorRecipeIds[i]=o,e.colorRecipes[o]=t[i],e},{colorRecipes:{},newColorRecipeIds:{}});return{colorRecipes:Object.assign(Object.assign({},e),i.colorRecipes),newColorRecipeIds:i.newColorRecipeIds}}(e.colorRecipes,n.colorRecipes,r),b=cr(e.chapters,e.assetLibraries.lights),m=cr(n.chapters,n.assetLibraries.lights),f=function(e,t,n,i,o){const s=lr(e),r=Object.values(s),a=lr(t);for(const u in a)if(a.hasOwnProperty(u)&&r.includes(a[u])){const e=Oi.generateParticleId(u,o);a[u]=e}const c=[...pr(e,s),...pr(t,a)],l=dr(n,s),p=dr(i,a),d=Object.assign(Object.assign({},ur(l,s)),ur(p,a));return{mergedParticles:c,currentChapters:l,importedChapters:p,tweenParticleLookup:Object(X.pickBy)(d,(e,t)=>!Object(X.isEmpty)(e))}}(e,n,rr(b,c,l),rr(m,c,p).map(e=>Object.assign(Object.assign({},e),{id:r("chapter")})),r),y=function(e,t){return e.map(e=>{if(Object(X.isEmpty)(e.colorRecipeObjects))return e;const n=Object.keys(e.colorRecipeObjects).reduce((n,i)=>(n[t[i]]=e.colorRecipeObjects[i],n),{});return e.colorRecipeObjects=n,e})}(f.importedChapters,h),x=[...f.currentChapters,...y],v=Object.assign(Object.assign({},e.customData),{particleSystems:f.mergedParticles}),w="module"===o?e.tags:[];return Object.assign(Object.assign({},e),{assetLibraries:d,chapters:x,sceneGraph:a,customData:v,tags:w,reflections:u,colorRecipes:g,stateId:Object(X.uniq)([...e.stateId,...n.stateId]),tweenParticleLookup:f.tweenParticleLookup})}var hr,br,mr;(hr||(hr={})).generateThumbnailUrls=function(e){return e.reduce((e,{originalChapterId:t,newChapterId:n,originalStoryId:i})=>{const o=`/thumbs/${s.Bookmark===ar(i)?"bookmarks":"modules"}/${i.replace(".json","")}`,r=new zo;return r.storyId=i,r.chapterId=t,r.urls={small:`${o}/small/chapters/${t}.jpg`,large:`${o}/large/chapters/${t}.jpg`},e.set(n,r),e},new Map)};class fr{}class yr{}class xr{}function vr(e,t){return{showObjects:Object(X.mapKeys)(e.showObjects,(e,n)=>mr.renamespaceValue(n,t)),selectObjects:Object(X.mapKeys)(e.selectObjects,(e,n)=>mr.renamespaceValue(n,t)),pickThroughObjects:Object(X.mapKeys)(e.pickThroughObjects,(e,n)=>mr.renamespaceValue(n,t)),synchronization:Object(X.mapKeys)(e.synchronization,(e,n)=>mr.renamespaceValue(n,t))}}function wr(e,t){return(e||[]).map(e=>Object.assign(Object.assign({},e),{objectId:mr.renamespaceValue(e.objectId,t),states:e.states.map(e=>{return Object.assign(Object.assign({},e),{errands:(n=e.errands,n.map(e=>e.type===Fn.flyToChapter||e.type===Fn.flyToObject?Object.assign(Object.assign({},e),{value:mr.renamespaceValue(e.value,t)}):e))});var n})}))}function Or(e,t){return(e||[]).map(e=>(e.data.timeline=t[e.data.timeline]||e.data.timeline,e))}function Cr(e,t){return(e||[]).map(e=>(e.objectId&&(e.objectId=mr.renamespaceValue(e.objectId,t)),e))}function Sr(e,t){return e?{xray:Object(X.mapKeys)(e.xray,(e,n)=>mr.renamespaceValue(n,t)),highlight:Object(X.mapKeys)(e.highlight,(e,n)=>mr.renamespaceValue(n,t))}:{}}function kr(e,t){const n=Object.assign({},e);return Array.isArray(e.layers)&&(n.layers=e.layers.map(e=>Object.assign(Object.assign({},e),{objectIds:e.objectIds.map(e=>mr.renamespaceValue(e,t))}))),n}function _r(e,t){const n=function(e,t){return"string"==typeof e?[t[e]||e]:e.map(e=>t[e]||e)}(e.stateId,t),i=e.assetLibraries.tweens.map(e=>mr.renamespaceValue(e,t)),o=e.assetLibraries.reflections.map(e=>mr.renamespaceValue(e,t)),s=Object(X.mapValues)(e.reflections,(e,n)=>mr.renamespaceValue(e,t)),r=function(e,t){return e.map(e=>Object.assign(Object.assign(Object.assign({},e),vr(e,t)),{colorRecipeObjects:Sr(e.colorRecipeObjects,t),timelineMap:Or(e.timelineMap,t),labels:wr(e.labels,t),hotspots:Cr(e.hotspots,t),visibilityLayers:kr(e.visibilityLayers,t)}))}(e.chapters,t),a=function e(t,n){for(const i of t)["objectId","displayName","geometryId","morphId","materialId"].forEach(e=>{i[e]&&(i[e]=mr.renamespaceValue(i[e],n))}),e(i.objects||[],n);return t}(e.sceneGraph,t);return Object.assign(Object.assign(Object.assign(Object.assign({},e),{stateId:n}),vr(e,t)),{assetLibraries:Object.assign(Object.assign({},e.assetLibraries),{tweens:i,reflections:o}),reflections:s,chapters:r,sceneGraph:a})}!function(e){function t(e,t=0){["x","y","z"].forEach(n=>{void 0!==e[n]&&Math.abs(e[n]-t)<1e-4&&delete e[n]})}function n(e){["translate","rotate","pivot"].forEach(n=>{void 0!==e[n]&&(t(e[n]),0===Object.keys(e[n]).length&&delete e[n])}),void 0!==e.scale&&(t(e.scale,1),0===Object.keys(e.scale).length&&delete e.scale)}function i(e,t){["backfaces","displayName","layer"].forEach(n=>{e[n]&&(t[n]=e[n])})}function o(e,t){const i=new yr;i.translate=JSON.parse(JSON.stringify(e.translate)),i.rotate=JSON.parse(JSON.stringify(e.rotate)),i.scale=JSON.parse(JSON.stringify(e.scale)),i.pivot=JSON.parse(JSON.stringify(e.pivot)),n(i),Object.entries(i).forEach(([e,n])=>{t[e]=JSON.parse(JSON.stringify(n))}),t.transformId&&delete t.transformId}function s(e,t){const n=["geometryId","morphId","materialId"],i=[];return e.renderables&&e.renderables.forEach(e=>{const t=new fr;n.forEach(n=>{e[n]&&(t[n]=e[n])}),e.layer&&(t.layer=e.layer),i.push(t)}),1===i.length?t=Object.assign(Object.assign({},t),i[0]):i.length>1&&(t.renderables=i),t}e.filterTransformProperties=n,e.serializeObjectProperties=i,e.serializeTransformData=o,e.serializeRenderables=s,e.serializeHumanObject=function e(t,n){if(n[t.objectId])return null;let r=new xr;return r.objectId=t.objectId,i(t,r),t.transformId?r.transformId=t.transformId:o(t,r),r=s(t,r),t.objects&&t.objects.length&&(r.objects=[]),t.objects.forEach(t=>{const i=e(t,n);null!==i&&r.objects.push(i)},this),r}}(br||(br={})),function(e){function t(e,t){const n=Object.entries(t);return n.sort((e,t)=>e[0].length===t[0].length?0:e[0].length<t[0].length?1:-1),n.reduce((e,[t,n])=>{if(e.startsWith(t)){const i=new RegExp("^"+t);e=e.replace(i,n)}return e},e||"")}e.renamespaceValue=t,e.renamespaceKeys=function(e,n){return Object.entries(e).reduce((e,[i,o])=>(e[t(i,n)]=o,e),{})},e.renamespaceAssetLibrary=function(e,n,i){if(!i)return e;const o=e.tweens.map(e=>t(e,n)),s=e.reflections.map(e=>t(e,n));return Object.assign(Object.assign({},e),{tweens:o,reflections:s})},e.renamespaceReflections=function(e,n,i){return i?Object(X.mapValues)(e,e=>t(e,n)):e}}(mr||(mr={}));class jr{}var Pr,Mr=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},Ir=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const zr={enableContextLabel:{enable:!0,enableInfo:!0,enableActions:!0},loading:!1,labelsCollapsed:!1,labelsCollapsedMode:Ji.None,labelScale:null,labels:[],contextLabel:null,selectedLabel:null,draggable:{pin:!0,tag:!0}};let Tr=(()=>{let e=Pr=class{constructor(e,t){this.store=e,this.labelsService=t}static getLabels(e){return e.labels}static getLabelsCollapsed(e){return e.labelsCollapsed}static getLabelsCollapsedMode(e){return e.labelsCollapsedMode}static getSelectedLabelId(e){return e.selectedLabel}static getSelectedLabel(e){return e.labels.find(t=>t.id===e.selectedLabel)||null}static getContextLabel(e){return e.contextLabel}static getChapterLabels(e,t){return e.labels.filter(e=>e.chapterId===t.selectedChapter)}static getChapterSequentialLabels(e){return Object(d.h)([Pr,Bo],(t,n)=>t.labels.filter(t=>t.chapterId===n.selectedChapter&&t.pinType===vn.Sequential&&t.sequentialType===e))}static getLabelSequence(e){return Object(d.h)([Pr,Pr.getChapterSequentialLabels(On.Alphabetical),Pr.getChapterSequentialLabels(On.Numerical)],(t,n,i)=>{if(e.pinType!==vn.Sequential)return null;switch(e.sequentialType){case On.Alphabetical:const t=n.findIndex(t=>t.id===e.id);return"ABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(t);case On.Numerical:return i.findIndex(t=>t.id===e.id)+1}})}static getEnableContextLabel(e){return e.enableContextLabel.enable}static getEnableContextLabelInfo(e){return e.enableContextLabel.enableInfo}static getEnableContextLabelActions(e){return e.enableContextLabel.enableActions}static getLabelsDraggable(e){return e.draggable}static getLabelScale(e){return e.labelScale}PatchLabels(e,t){const n=immer.applyPatches(e.getState(),t.patches);e.patchState(n)}setLabelOffset(e,t){const[n,i,o]=immer.produceWithPatches(e.getState(),e=>{const n=e.labels.find(e=>e.id===t.labelId);n&&(n.offset=t.offset)});e.patchState(n),this.savePatches(i,o)}setLabels(e,t){e.patchState(immer.produce(e.getState(),e=>{e.labels=t.labels}))}setLabel(e,t){const[n,i,o]=immer.produceWithPatches(e.getState(),e=>{e.labels=e.labels.map(e=>e.id===t.label.id?t.label:e)});e.patchState(n),t.record&&this.savePatches(i,o)}setLabelStates(e,t){const[n,i,o]=immer.produceWithPatches(e.getState(),e=>{e.labels.find(e=>e.id===t.id).states=t.states});e.patchState(n),this.savePatches(i,o)}setLabelScale(e,t){e.patchState({labelScale:t.scale})}addLabel(e,t){const[n,i,o]=immer.produceWithPatches(e.getState(),e=>{const n=t.label.id||Un.idWithPrefix("label"),i=Object.assign(Object.assign({},t.label),{id:n});e.labels.push(i)});e.patchState(n),this.savePatches(i,o)}addContextLabel(e,t){const n=immer.produce(e.getState(),e=>{e.contextLabel=Object.assign(Object.assign({},t.label),{id:"context-label"})});e.patchState(n)}copyLabels(e,t){const n=e.getState().labels,i=n.filter(e=>e.chapterId===t.sourceChapter.id).map(e=>Object.assign(Object.assign({},Object(X.cloneDeep)(e)),{id:Un.idWithPrefix("label"),chapterId:t.targetChapter.id}));e.patchState({labels:[...n,...i]})}removeLabel(e,t){const[n,i,o]=immer.produceWithPatches(e.getState(),e=>{e.labels=e.labels.filter(e=>e.id!==t.label.id)});e.patchState(n),Human.scene.markers.delete(t.label.id),this.savePatches(i,o)}removeContextLabel(e,t){const n=immer.produce(e.getState(),e=>{e.contextLabel=void 0});Human.scene.markers.delete("context-label"),e.patchState(n)}removeAllChapterLabels(e,t){const[n,i,o]=immer.produceWithPatches(e.getState(),e=>{const[n,i]=Object(X.partition)(e.labels,e=>e.chapterId!==t.chapter.id);i.forEach(e=>Human.scene.markers.delete(e.id)),e.labels=n});e.patchState(n),this.savePatches(i,o)}selectLabel(e,t){e.patchState({selectedLabel:t.label?t.label.id:null})}resetLabels(e,t){const n=e.getState();Human.scene.markers.delete("context-label"),n.labels.forEach(e=>{Human.scene.markers.delete(e.id)}),e.setState(immer.produce(e.getState(),e=>{}))}convertLabels(e,t){const[n,i,o]=immer.produceWithPatches(e.getState(),e=>{t.labels.forEach(n=>{const i=e.labels.findIndex(e=>e.id===n.id);e.labels[i]=Object.assign(Object.assign({},e.labels[i]),t.fields)})});e.setState(Object.assign({},n)),this.savePatches(i,o)}enableContextLabel(e,t){e.patchState({enableContextLabel:Object.assign({},t)})}setLabelsShown(e,{labels:t,shown:n}){const i=e.getState().labels.map(e=>{const i=t.some(t=>t.id===e.id);return Object.assign(Object.assign({},e),{shown:i?n:e.shown})});e.patchState({labels:[...i]})}setAllLabelsShown(e,{show:t}){const n=e.getState().labels;e.dispatch(new bo(n,t))}setLabelsCollapsed(e,{collapsed:t,collapsedMode:n}){e.patchState({labelsCollapsed:t,labelsCollapsedMode:n})}setLabelsDraggable(e,t){e.patchState({draggable:Object.assign({},t.draggable)})}savePatches(e,t){this.store.dispatch(new qn.SavePatches([{forward:e,inverse:t,patchAction:Xi}]))}};return e.\u0275fac=function(t){return new(t||e)(i.Zb(d.g),i.Zb(Bn))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac}),Mr([Object(d.a)(Xi),Ir("design:type",Function),Ir("design:paramtypes",[Object,Xi]),Ir("design:returntype",void 0)],e.prototype,"PatchLabels",null),Mr([Object(d.a)(Yi),Ir("design:type",Function),Ir("design:paramtypes",[Object,Yi]),Ir("design:returntype",void 0)],e.prototype,"setLabelOffset",null),Mr([Object(d.a)(eo),Ir("design:type",Function),Ir("design:paramtypes",[Object,eo]),Ir("design:returntype",void 0)],e.prototype,"setLabels",null),Mr([Object(d.a)(ao),Ir("design:type",Function),Ir("design:paramtypes",[Object,ao]),Ir("design:returntype",void 0)],e.prototype,"setLabel",null),Mr([Object(d.a)(co),Ir("design:type",Function),Ir("design:paramtypes",[Object,co]),Ir("design:returntype",void 0)],e.prototype,"setLabelStates",null),Mr([Object(d.a)(lo),Ir("design:type",Function),Ir("design:paramtypes",[Object,lo]),Ir("design:returntype",void 0)],e.prototype,"setLabelScale",null),Mr([Object(d.a)(to),Ir("design:type",Function),Ir("design:paramtypes",[Object,to]),Ir("design:returntype",void 0)],e.prototype,"addLabel",null),Mr([Object(d.a)(no),Ir("design:type",Function),Ir("design:paramtypes",[Object,no]),Ir("design:returntype",void 0)],e.prototype,"addContextLabel",null),Mr([Object(d.a)(io),Ir("design:type",Function),Ir("design:paramtypes",[Object,io]),Ir("design:returntype",void 0)],e.prototype,"copyLabels",null),Mr([Object(d.a)(oo),Ir("design:type",Function),Ir("design:paramtypes",[Object,oo]),Ir("design:returntype",void 0)],e.prototype,"removeLabel",null),Mr([Object(d.a)(so),Ir("design:type",Function),Ir("design:paramtypes",[Object,so]),Ir("design:returntype",void 0)],e.prototype,"removeContextLabel",null),Mr([Object(d.a)(ro),Ir("design:type",Function),Ir("design:paramtypes",[Object,ro]),Ir("design:returntype",void 0)],e.prototype,"removeAllChapterLabels",null),Mr([Object(d.a)(po),Ir("design:type",Function),Ir("design:paramtypes",[Object,po]),Ir("design:returntype",void 0)],e.prototype,"selectLabel",null),Mr([Object(d.a)(uo),Ir("design:type",Function),Ir("design:paramtypes",[Object,uo]),Ir("design:returntype",void 0)],e.prototype,"resetLabels",null),Mr([Object(d.a)(go),Ir("design:type",Function),Ir("design:paramtypes",[Object,go]),Ir("design:returntype",void 0)],e.prototype,"convertLabels",null),Mr([Object(d.a)(ho),Ir("design:type",Function),Ir("design:paramtypes",[Object,ho]),Ir("design:returntype",void 0)],e.prototype,"enableContextLabel",null),Mr([Object(d.a)(bo),Ir("design:type",Function),Ir("design:paramtypes",[Object,bo]),Ir("design:returntype",void 0)],e.prototype,"setLabelsShown",null),Mr([Object(d.a)(mo),Ir("design:type",Function),Ir("design:paramtypes",[Object,mo]),Ir("design:returntype",void 0)],e.prototype,"setAllLabelsShown",null),Mr([Object(d.a)(fo),Ir("design:type",Function),Ir("design:paramtypes",[Object,fo]),Ir("design:returntype",void 0)],e.prototype,"setLabelsCollapsed",null),Mr([Object(d.a)(yo),Ir("design:type",Function),Ir("design:paramtypes",[Object,yo]),Ir("design:returntype",void 0)],e.prototype,"setLabelsDraggable",null),Mr([Object(d.e)(),Ir("design:type",Function),Ir("design:paramtypes",[jr]),Ir("design:returntype",void 0)],e,"getLabels",null),Mr([Object(d.e)(),Ir("design:type",Function),Ir("design:paramtypes",[jr]),Ir("design:returntype",void 0)],e,"getLabelsCollapsed",null),Mr([Object(d.e)(),Ir("design:type",Function),Ir("design:paramtypes",[jr]),Ir("design:returntype",void 0)],e,"getLabelsCollapsedMode",null),Mr([Object(d.e)(),Ir("design:type",Function),Ir("design:paramtypes",[jr]),Ir("design:returntype",void 0)],e,"getSelectedLabelId",null),Mr([Object(d.e)(),Ir("design:type",Function),Ir("design:paramtypes",[jr]),Ir("design:returntype",void 0)],e,"getSelectedLabel",null),Mr([Object(d.e)(),Ir("design:type",Function),Ir("design:paramtypes",[jr]),Ir("design:returntype",void 0)],e,"getContextLabel",null),Mr([Object(d.e)([Bo]),Ir("design:type",Function),Ir("design:paramtypes",[jr,Ft]),Ir("design:returntype",void 0)],e,"getChapterLabels",null),Mr([Object(d.e)(),Ir("design:type",Function),Ir("design:paramtypes",[jr]),Ir("design:returntype",void 0)],e,"getEnableContextLabel",null),Mr([Object(d.e)(),Ir("design:type",Function),Ir("design:paramtypes",[jr]),Ir("design:returntype",void 0)],e,"getEnableContextLabelInfo",null),Mr([Object(d.e)(),Ir("design:type",Function),Ir("design:paramtypes",[jr]),Ir("design:returntype",void 0)],e,"getEnableContextLabelActions",null),Mr([Object(d.e)(),Ir("design:type",Function),Ir("design:paramtypes",[jr]),Ir("design:returntype",void 0)],e,"getLabelsDraggable",null),Mr([Object(d.e)(),Ir("design:type",Function),Ir("design:paramtypes",[jr]),Ir("design:returntype",void 0)],e,"getLabelScale",null),e=Pr=Mr([Object(d.f)({name:"labels",defaults:zr})],e),e})(),Ur=(()=>{class e{constructor(e,t,n,i,o){this.store=e,this.engineService=t,this.chapterSerializer=n,this.animationService=i,this.chapterService=o}serializeUI(e){const t=Object.assign({},e.ui);return e.chapters.length>1&&(t.scrubber=!1,t.playPause=!1,t.tour={chapters:!0}),t}serializeAnimation(e){return this.animationService.isChapterAnimated(e)?{startTime:e.timelineMap[0].start,loop:!1!==e.loop,numChapters:1}:{}}getClippedObjects(){return 0===Human.renderer.clip.getActiveClips().length?{}:Human.scene.getLeaves().reduce((e,t)=>(Human.scene.objects[t].culledByClip&&(e[t]=!0),e),{})}generateTrimObjectMap(e){const t={};if(e.graph.hidden){const e=this.store.selectSnapshot(ii.getAllNodeState);Object.values(e).forEach(e=>{Object.entries(e).forEach(([e,n])=>{!1!==t[e]&&(t[e]=!(n.shown||n.shownSetByTween))})})}const n=e.graph.clipped?this.getClippedObjects():{};return Object.assign(Object.assign({},t),n)}serialize(e,t,n=!1,i,o,s){const r=Object(X.cloneDeep)(i),a=this.generateTrimObjectMap(t);r.sceneGraph=function(e,t){const n=[];return Object.entries(e).forEach(([e,i])=>{const o=br.serializeHumanObject(i,t);null!==o&&n.push(o)},this),n}(Human.scene.rootObjects,a);const c=Ye.createGraphFromSrc(r.sceneGraph,"objectId","objects",new Xe(Human.scene.colorRecipes.getRecipes())),l=this.store.selectSnapshot(Tr.getLabels);r.chapters=o.map(t=>this.chapterSerializer.serializeChapter(c,t,e,l,s)),r.ui=this.serializeUI(r),r.animation=this.serializeAnimation(o[0]),r.customData=Object.assign(Object.assign({},r.customData),{particleSystems:this.store.selectSnapshot(_i.getParticleSystemsList)});const p=this.store.selectSnapshot(Bi.getAllQuestions),d=this.store.selectSnapshot(Bi.getQuizSettings);d&&p.length>0?r.quizSettings=d:delete r.quizSettings,r.tweenParticleLookup=this.store.selectSnapshot(_i.getTweenParticleLookup);const u=o.reduce((e,t)=>e.concat(this.chapterService.getChapterTweenStates(t)),[]);r.assetLibraries.tweens=r.assetLibraries.tweens.filter(e=>{const t=this.getStateId(e);return u.indexOf(t)>=0});const g=o.reduce((e,t)=>e.concat(this.chapterService.getChapterLightLibraries(t)),[]);r.assetLibraries.lights=Array.from(new Set(g));const h=this.getReflectionLibraries(r.reflections),b=o.reduce((e,t)=>e.concat(this.chapterService.getChapterReflectionLibraries(t)),[]);r.assetLibraries.reflections=Array.from(new Set(h.concat(b)));const m=[].concat.apply([],Object.values(r.assetLibraries)),f=this.getSceneGraphStateIds(r.sceneGraph);return r.stateId=Array.from(new Set(m.map(this.getStateId).concat(f))),{story:n?_r(r,e):r}}getReflectionLibraries(e){return e=e||{},Object.values(e).map(e=>{const t=e.split(".");return[t[0],t[1]].join("/")})}getSceneGraphStateIds(e){return e.map(e=>e.objectId.split("-")[0])}getStateId(e){return e.split("/")[0]}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(d.g),i.Zb(lt),i.Zb($i),i.Zb(Do),i.Zb(Zi))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();class Lr{constructor(){this.graph={hidden:!1,clipped:!1,disabled:!1,transparent:!1}}}var Dr=function(e){return e.WidgetOptions="widgetOptions",e.SnapshotOptions="snapshotOptions",e.Locale="locale",e.GroupRestriction="GroupRestriction",e.UserAppId="userAppId",e.RememberMeEmail="rememberMeEmail",e.LabelConversionSeen="labelConversionSeen",e.DefaultGroupEdit="defaultGroupEdit",e.DefaultCollectionId="defaultCollectionId",e.InternetExplorerWarning="internetExplorerWarning",e.GettingStartedTutorial="gettingStartedTutorial",e.AutoCapture="autoCapture",e.SystemMessage="systemMessage",e.Preview="preview",e.ExploreRedesignMessage="exploreRedesignMessage",e.Iphone12Warning="iphone12Warning",e}({}),Er=function(e){return e.UserMessagesSeen="userMessagesSeen",e.PreviewSize="previewSize",e}({});class Fr{constructor(){this._data={}}get keys(){return Object.keys(this._data)}get length(){return this.keys.length}clear(){this._data={}}getItem(e){return this._data[e]}key(e){return this.keys[e]}removeItem(e){delete this._data[e]}setItem(e,t){this._data[e]=t}}let Ar=(()=>{class e{constructor(){this._localStorage=this.getStorage("localStorage"),this._sessionStorage=this.getStorage("sessionStorage")}getLocalItem(e){return this._localStorage.getItem(""+e)}getLocalJSON(e){const t=this.getLocalItem(e);return t?JSON.parse(t):null}setLocalItem(e,t){const n="object"==typeof t?JSON.stringify(t):""+t;try{return this._localStorage.setItem(""+e,n),!0}catch(i){return!1}}removeLocalItem(e){this._localStorage.removeItem(""+e)}getSessionItem(e){const t=this._sessionStorage.getItem(""+e);return t?JSON.parse(t):null}setSessionItem(e,t){const n=JSON.stringify(t);try{return this._sessionStorage.setItem(""+e,n),!0}catch(i){return!1}}removeSessionItem(e){this._sessionStorage.removeItem(""+e)}clearStorage(){this.clearLocalStorage(),this.clearSessionStorage()}clearLocalStorage(){this._localStorage.clear()}clearSessionStorage(){this._sessionStorage.clear()}getStorage(e){try{return window[e]||new Fr}catch(t){return new Fr}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var Rr,Nr=n("3E0/"),Vr=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},Hr=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const Br={loading:!1,incoming:{id:void 0,type:void 0},storyId:void 0,storyType:void 0,loadingChunk:null,loadChunks:[],loadChunksRemaining:[],thumbnailLookup:[]};let Qr=(()=>{let e=Rr=class{constructor(e,t,n,i,o){this.store=e,this.storyService=t,this.engineService=n,this.serializeModuleService=i,this.storageService=o}static getStory(e){return e.story}static getStoryId(e){return e.storyId}static getLoadingChunk(e){return e.loadingChunk}static getLoadChunks(e){return e.loadChunks}static getLoadChunksRemaining(e){return e.loadChunksRemaining}static getStoryInfo(e){return{id:e.storyId,type:e.storyType}}static getIncomingStoryInfo(e){return e.incoming}static getStoryTags(e){return Object(X.get)(e,"story.tags",[])}setStoryText(e,t){const n=e.getState().story;n&&e.patchState({story:Object.assign(Object.assign({},n),{displayName:t.displayName})})}setStoryTags(e,{tags:t}){const n=e.getState().story;n&&e.patchState({story:Object.assign(Object.assign({},n),{tags:t})})}setStory(e,t){e.patchState({story:t.story})}SetStoryId(e,t){e.patchState({storyId:t.id})}setIncomingStory(e,t){const n=e.getState(),{id:i,type:o,reset:s}=t;i!==n.storyId||s?e.patchState({incoming:{id:i,type:o}}):s&&e.dispatch(new Bs(t.id,n.story,t.type))}loadStory(e,t){(t.preview?Object(S.a)(this.storageService.getLocalJSON(Dr.Preview)):this.storyService.getStory(t.id,t.type,t.lang)).subscribe(n=>{e.dispatch(new Qs(n,t.id,t.type))},()=>{e.dispatch(new $s(t.id,t.type))})}loadStorySuccess(e,t){this.storyService.unloadStory(null).pipe(Object(Nr.a)(0)).subscribe(()=>{e.dispatch(new Bs(t.id,t.story,t.type))})}buildStoryWorkflow(e,t,n,i,o=0,s=new Map){this.storyService.buildStory(t,n,!0).subscribe(r=>{const a=this.storyService.getStoryChapters(t,i);let c=[];a.forEach(e=>{c=[...c,...e.labels]});const l=this.storyService.getLoadConfig(t,o),p=this.storyService.getStoryLoadChunks(t,l);e.patchState({storyId:t,story:n,loadChunks:p,loadChunksRemaining:p,incoming:{id:void 0,type:void 0}});const d=this.engineService.getSceneGraph(Human.scene.rootObjects),u=a.reduce((e,t)=>(e[t.id]=function(e,t,n,i){return Object.keys(e.nodes).reduce((o,s)=>(o[s]=function(o){const s=xi(e,o,t)||yi(e,o,t),r=function e(t,n,i){switch(i[n]){case!0:return!1;case!1:return!0;case void 0:{const o=Ye.getAncestor(t,n);return!o||e(t,o,i)}}}(e,o,n);return{objectId:o,checked:!1,selected:!1,paint:function e(t,n,i){if(i[n]&&("tintColor"in(o=i[n])||"opacity"in o||"brightness"in o||"saturation"in o||"contrast"in o))return Xn.fromEngine(new fi(i[n]));var o;const s=Ye.getAncestor(t,n);return s?e(t,s,i):ai.recipe}(e,o,i),pickable:r,shown:s,shownSetByTween:!1}}(s),o),{})}(d,t.showObjects,t.pickThroughObjects,t.synchronization),e),{});e.dispatch(new $n.InitNodeState(u)),e.dispatch(new $n.SetActiveChapter(a[o].id)),e.dispatch(new qt(a)),e.dispatch(new un(s)),e.dispatch(new eo(c)),e.dispatch(new Qt(a[o]));const g=Object(X.get)(n,"tweenParticleLookup",{}),h=Object(X.get)(n,"customData.particleSystems",[]),b=a.reduce((e,t)=>(e[t.id]=Object(X.get)(t,"customData.particleSystems",[]),e),{});e.dispatch(new vi.SetParticleState(h,b,g)),e.dispatch(new ji.ResetQuizState),n.quizSettings&&e.dispatch(new ji.SetQuizSettings(n.quizSettings));const m=zi(a);e.dispatch(new ji.SetQuestions(m)),e.dispatch(new Js),e.dispatch(new Ns)})}importStorySuccess(e,t){const n=e.getState(),i=n.storyType,o=n.storyId,s=new Lr,r=this.store.selectSnapshot(Rr.getStory),a=this.store.selectSnapshot(Bo.getStoryChapters),l=qi.makeChapterIdMap(a,!1),p=this.serializeModuleService.serialize({},s,!1,r,a,l).story,d=gr(p,o,t.story,t.id,c.exportType),u=p.chapters.map((e,t)=>({newChapterId:e.id,originalChapterId:e.id,originalStoryId:o})),g=(n.thumbnailLookup||[]).concat(t.story.chapters.map((e,n)=>({newChapterId:d.chapters[p.chapters.length+n].id,originalChapterId:e.id,originalStoryId:t.id})));e.patchState({thumbnailLookup:g});const h=hr.generateThumbnailUrls([...u,...g]),b=this.store.selectSnapshot(Bo.getRegisteredThumbnails),m=new Map([...b].filter(e=>e[1].snapshot)),f=new Map([...h,...m]);this.storyService.unloadStory(null,!0).subscribe(()=>{this.buildStoryWorkflow(e,o,d,i,d.chapters.length-1,f)})}buildStory(e,t){const n=t.story.chapters.map((e,n)=>({newChapterId:e.id,originalChapterId:e.id,originalStoryId:t.id})),i=hr.generateThumbnailUrls(n);this.buildStoryWorkflow(e,t.id,t.story,t.type,t.chapterIdx||0,i)}loadStoryChunk(e){const t=e.getState().loadChunksRemaining[0];t&&(e.patchState({loadingChunk:t}),this.storyService.loadStoryChunk(t,()=>{e.dispatch([new Hs(t),new Ns])}))}reorderLoadChunks(e,t){const{loadChunksRemaining:n}=e.getState(),[i,o]=Object(X.partition)(n,e=>e.chapterId===t.chapterId);e.patchState({loadChunksRemaining:[...i,...o]})}loadStoryChunkSuccess(e,t){const n=e.getState().loadChunksRemaining.filter(e=>e.chunkId!==t.chunk.chunkId);e.patchState({loadingChunk:null,loadChunksRemaining:n}),e.dispatch(new Yt(t.chunk.chapterId,t.chunk.readyState))}synchronizeChapters(e){const t=this.store.selectSnapshot(Bo.getStoryChapters),{story:n}=e.getState();e.patchState({story:Object.assign(Object.assign({},n),{chapters:[...t]})})}importStory(e,t){this.storyService.getStory(t.id,t.type,t.lang).subscribe(n=>{e.dispatch(new Ws(n,t.id,t.type))})}resetStory(e){e.setState(Br)}};return e.\u0275fac=function(t){return new(t||e)(i.Zb(d.g),i.Zb(sr),i.Zb(lt),i.Zb(Ur),i.Zb(Ar))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac}),Vr([Object(d.a)(Fs),Hr("design:type",Function),Hr("design:paramtypes",[Object,Fs]),Hr("design:returntype",void 0)],e.prototype,"setStoryText",null),Vr([Object(d.a)(As),Hr("design:type",Function),Hr("design:paramtypes",[Object,As]),Hr("design:returntype",void 0)],e.prototype,"setStoryTags",null),Vr([Object(d.a)(Ds),Hr("design:type",Function),Hr("design:paramtypes",[Object,Ds]),Hr("design:returntype",void 0)],e.prototype,"setStory",null),Vr([Object(d.a)(Es),Hr("design:type",Function),Hr("design:paramtypes",[Object,Es]),Hr("design:returntype",void 0)],e.prototype,"SetStoryId",null),Vr([Object(d.a)(Rs),Hr("design:type",Function),Hr("design:paramtypes",[Object,Rs]),Hr("design:returntype",void 0)],e.prototype,"setIncomingStory",null),Vr([Object(d.a)(Ls),Hr("design:type",Function),Hr("design:paramtypes",[Object,Ls]),Hr("design:returntype",void 0)],e.prototype,"loadStory",null),Vr([Object(d.a)(Qs),Hr("design:type",Function),Hr("design:paramtypes",[Object,Qs]),Hr("design:returntype",void 0)],e.prototype,"loadStorySuccess",null),Vr([Object(d.a)(Ws),Hr("design:type",Function),Hr("design:paramtypes",[Object,Ws]),Hr("design:returntype",void 0)],e.prototype,"importStorySuccess",null),Vr([Object(d.a)(Bs),Hr("design:type",Function),Hr("design:paramtypes",[Object,Bs]),Hr("design:returntype",void 0)],e.prototype,"buildStory",null),Vr([Object(d.a)(Ns),Hr("design:type",Function),Hr("design:paramtypes",[Object]),Hr("design:returntype",void 0)],e.prototype,"loadStoryChunk",null),Vr([Object(d.a)(Vs),Hr("design:type",Function),Hr("design:paramtypes",[Object,Vs]),Hr("design:returntype",void 0)],e.prototype,"reorderLoadChunks",null),Vr([Object(d.a)(Hs),Hr("design:type",Function),Hr("design:paramtypes",[Object,Hs]),Hr("design:returntype",void 0)],e.prototype,"loadStoryChunkSuccess",null),Vr([Object(d.a)(Gs),Hr("design:type",Function),Hr("design:paramtypes",[Object]),Hr("design:returntype",void 0)],e.prototype,"synchronizeChapters",null),Vr([Object(d.a)(qs),Hr("design:type",Function),Hr("design:paramtypes",[Object,qs]),Hr("design:returntype",void 0)],e.prototype,"importStory",null),Vr([Object(d.a)(Ks),Hr("design:type",Function),Hr("design:paramtypes",[Object]),Hr("design:returntype",void 0)],e.prototype,"resetStory",null),Vr([Object(d.e)(),Hr("design:type",Function),Hr("design:paramtypes",[gs]),Hr("design:returntype",void 0)],e,"getStory",null),Vr([Object(d.e)(),Hr("design:type",Function),Hr("design:paramtypes",[gs]),Hr("design:returntype",void 0)],e,"getStoryId",null),Vr([Object(d.e)(),Hr("design:type",Function),Hr("design:paramtypes",[gs]),Hr("design:returntype",void 0)],e,"getLoadingChunk",null),Vr([Object(d.e)(),Hr("design:type",Function),Hr("design:paramtypes",[gs]),Hr("design:returntype",void 0)],e,"getLoadChunks",null),Vr([Object(d.e)(),Hr("design:type",Function),Hr("design:paramtypes",[gs]),Hr("design:returntype",void 0)],e,"getLoadChunksRemaining",null),Vr([Object(d.e)(),Hr("design:type",Function),Hr("design:paramtypes",[gs]),Hr("design:returntype",void 0)],e,"getStoryInfo",null),Vr([Object(d.e)(),Hr("design:type",Function),Hr("design:paramtypes",[gs]),Hr("design:returntype",void 0)],e,"getIncomingStoryInfo",null),Vr([Object(d.e)(),Hr("design:type",Function),Hr("design:paramtypes",[gs]),Hr("design:returntype",void 0)],e,"getStoryTags",null),e=Rr=Vr([Object(d.f)({name:"story",defaults:Br})],e),e})(),$r=(()=>{class e{constructor(e,t){this.storyLoadProgress=e,this.chunkLoadProgress=t}}return e.type="[Engine Progress] Set Progress",e})(),qr=(()=>{class e{constructor(){}}return e.type="[Engine Progress] Reset Progress",e})();function Wr(e,t){return e.dispatch(new ue(!1)),t.fireEvent(it.SceneXrayDisabled,void 0),!0}var Kr,Gr=n("yLV6");class Zr{constructor(e){this.ngUnsubsribe=new $.a,this.store=e,this.listenForParticleChanges(),this.listenForLookupChanges()}destroy(){this.ngUnsubsribe.next(),this.ngUnsubsribe.complete()}listenForLookupChanges(){this.store.select(_i.getTweenParticleLookup).pipe(Object(W.a)(this.ngUnsubsribe)).subscribe(e=>{Object(X.isEmpty)(e)||wi.refreshEngineLookup(this.store.selectSnapshot(Qr.getStoryId),e)})}listenForParticleChanges(){const e=this.store.select(_i.getParticleSystems),t=this.store.select(_i.getVisisbleParticleSystems);Object(ss.a)(e,t).pipe(Object(W.a)(this.ngUnsubsribe)).subscribe(()=>{const e=this.store.selectSnapshot(Bo.getSelectedChapterId),t=this.store.selectSnapshot(_i.particleSystemsForChapter(e)),n=this.store.selectSnapshot(_i.getVisibleParticleSystesmForChapter(e)),i=t.filter(e=>n.includes(e.id));this.setEngineParticles(i)})}setEngineParticles(e=[]){Human.particles.disableAll(),Human.particles.resetAll();const t=JSON.parse(JSON.stringify(e));Human.particles.parse(t,()=>{e.forEach(e=>{Human.particles.enable(e.id)}),null!=Human.timeline.activeRoot&&(Human.timeline.activeRoot._nowBranch.particleSystems=e.map(e=>e.id))})}}(Kr||(Kr={})).getColorRecipe=function(e,t){const n=e.scene.objects[t];if(n instanceof e.scene.Object){const e=n.getProperties();return{tintColor:Object(X.get)(e,"tintColor")?e.tintColor:[1,1,1],brightness:e.brightness,saturation:e.saturation,contrast:e.contrast,opacity:e.opacity}}return null};let Jr=(()=>{class e{constructor(e,t,n){this.store=e,this.graphService=t,this.engineService=n,this.highlightDisabled=!1}colorObject(e,t){const{tintColor:n,saturation:i,brightness:o,contrast:s,opacity:r}=t,a=Human.scene.objects[e];a instanceof Human.scene.Object&&(Object(X.isNil)(n)||a.setTintColor(n),Object(X.isNil)(i)||a.setSaturation(i),Object(X.isNil)(o)||a.setBrightness(o),Object(X.isNil)(s)||a.setContrast(s),Object(X.isNil)(r)||a.setOpacity(r))}getColor(e){return Kr.getColorRecipe(Human,e)}uncolorObject(e){const t=Human.scene.objects[e];t instanceof Human.scene.Object&&(t.clearColorModifiers(),t.clearOpacityModifiers())}unpaint(e){const t=this.store.selectSnapshot(is.getViewGraph);this.graphService.getLeafDescendants(t,e.id).forEach(e=>{this.engineService.getObjects(e).forEach(e=>{const t=Human.scene.objects[e];t instanceof Human.scene.Object&&(t.clearColorModProperties(),t.clearOpacityModProperties())})})}paint(e,t){const n=this.store.selectSnapshot(is.getViewGraph),i=Xn.toEngine(t);this.graphService.getLeafDescendants(n,e).forEach(e=>{this.engineService.getObjects(e).forEach(e=>{this.colorObject(e,i)})})}highlight(e,t){if(!1===this.highlightDisabled||!1===t){const n=this.store.selectSnapshot(is.getViewGraph);this.graphService.getLeafDescendants(n,e).forEach(e=>{this.engineService.getObjects(e).forEach(e=>{const n=Human.scene.objects[e];n instanceof Human.scene.Object&&n.setHighlight(t)})})}}xRay(e,t){Human.scene.objects[e.id].setXRay(t)}paintAll(e,t){e.forEach(e=>this.paint(e,t))}unpaintAll(e){e.forEach(e=>{this.unpaint(e)})}highlightAll(e,t){e.forEach(e=>this.highlight(e,t))}disableHighlight(){this.highlightDisabled=!0}enableHighlight(){this.highlightDisabled=!1}setHighlightColor(e){Human.renderer.highlightColor=[...e]}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(d.g),i.Zb(tt),i.Zb(lt))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var Xr=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},Yr=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let ea=(()=>{class e{constructor(e){this.store=e,this.currentLayers=[],this.nodesLayerIndex=0,this.objectsLayerIndex=0,this.nodeChapterOpacities={}}initObservables(){this.selectedChapterId$.pipe(Object(K.a)(e=>!Object(X.isNil)(e))).subscribe(e=>{this.selectedChapterId=e,this.updateNodeChapterOpacities()}),this.selectedChapterCurrentLayers$.subscribe(e=>{this.currentLayers=e,this.nodesLayerIndex=this.objectsLayerIndex=this.store.selectSnapshot(Bo.getSelectedChapterCurrentLayersIndex)}),Object(rs.b)(this.selectedChapterCurrentLayersIndex$,this.selectedChapterCurrentLayersPosition$).pipe(Object(K.a)(([e,t])=>!Object(X.isNil)(e)&&!Object(X.isNil)(t))).subscribe(([e,t])=>{this.synchronizeScene(e,t,!0)})}recordLayerIndexPosition(e,t){this.store.dispatch(new fn(this.selectedChapterId,e,t,!0))}synchronizeScene(e,t,n){this.updateLayerIndex(e,this.currentLayers,n),this.updateLayerPosition(t,this.currentLayers,n)}fractionToIndex(e){const t=this.getThreshold(),n=Math.floor(e/t);return Math.min(this.currentLayers.length-2,n)}fractionToPosition(e,t){const n=this.getThreshold();return Math.max(0,Math.min((e-n*t)/n,1))}indexPositionToFraction(e,t){const n=this.getThreshold();return e*n+t*n}getThreshold(){return this.currentLayers.length>1?1/(this.currentLayers.length-1):1}getCurrentLayerIndexProp(e){return e?"nodesLayerIndex":"objectsLayerIndex"}updateLayerIndex(e,t,n){const i=this.getCurrentLayerIndexProp(n);e!==this[i]&&(this.restoreLayers(e,this[i],t,n),n&&(this.nodesLayerIndex=e),this.objectsLayerIndex=e)}updateLayerPosition(e,t,n){const i=this.getCurrentLayerIndexProp(n);this.setObjectsOpacity(t[this[i]].objectIds,1-e)}restoreLayers(e,t,n,i){const o=(e-t)/Math.abs(e-t);let s=[],r=t;for(;r!==e;)s=s.concat(n[r].objectIds),r+=o;const a=-1===o;this.setObjectsOpacity(s,1===o?0:1),i?this.setNodesShown(s,a):this.setObjectsShown(s,a),-1===o&&(i?this.setNodesShown(n[e].objectIds,!0):this.setObjectsShown(n[e].objectIds,!0))}setObjectsOpacity(e,t){for(let n=0;n<e.length;n++){const i=e[n],o=this.nodeChapterOpacities[i];let s;this.isFresnelOpacity(o)?(s=o.slice(),s[0]=t*o[0],s[1]=t*o[1]):s=t*o,Human.scene.objects[i].setOpacity(s)}}updateNodeChapterOpacities(){const e=this.store.selectSnapshot(ii.getAllNodeState)[this.selectedChapterId];this.nodeChapterOpacities={},Object.entries(e).forEach(([e,t])=>{if(this.nodeChapterOpacities[e]=1,t.paint&&t.paint.hasOwnProperty("opacity")){const n=Xn.toEngine(t.paint);(this.isFresnelOpacity(n.opacity)||this.isScalarOpacity(n.opacity))&&(this.nodeChapterOpacities[e]=n.opacity)}})}isScalarOpacity(e){return"number"==typeof e}isFresnelOpacity(e){return Array.isArray(e)}setObjectsShown(e,t){const n={};for(let i=0;i<e.length;i++)n[e[i]]=t;Human.scene.setEnabledObjects({objects:n})}setNodesShown(e,t){this.store.dispatch(new $n.UpdateNodesShown(t,e,void 0,!1))}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(d.g))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),Xr([Object(d.d)(Bo.getSelectedChapterCurrentLayers),Yr("design:type",q.a)],e.prototype,"selectedChapterCurrentLayers$",void 0),Xr([Object(d.d)(Bo.getSelectedChapterCurrentLayersIndex),Yr("design:type",q.a)],e.prototype,"selectedChapterCurrentLayersIndex$",void 0),Xr([Object(d.d)(Bo.getSelectedChapterCurrentLayersPosition),Yr("design:type",q.a)],e.prototype,"selectedChapterCurrentLayersPosition$",void 0),Xr([Object(d.d)(Bo.getSelectedChapterId),Yr("design:type",q.a)],e.prototype,"selectedChapterId$",void 0),e})();var ta=n("HlzF");const na=new RegExp("^/media/audio/(.*)/.*$");let ia=(()=>{class e{constructor(){this.audioPlayers=new Map}createAudioUploadEvent(e){return{type:"uploadFile",url:"/ws/media/audio/upload",method:"POST",file:e}}getAudioClip(e){return Object.entries(e).find(([e,t])=>"audio"===t.data.streamType)||[void 0,void 0]}createAudioClip(e,t){const n=Human.timeline.branchTimelines[e.id],i=this.getAudioUUID(t);return[i,{data:{clipId:i,streamType:"audio",alternatives:["m4a"],fullUrl:t,time1:n.timeRange.firstTime,time2:n.timeRange.lastTime}}]}getAudioClipUrl(e){const[t,n]=this.getAudioClip(e);return n?n.data.fullUrl:""}getAudioSrc(e){return e.match("/media/audio")||(e="/content/states/"+e),e}getAudioPlayer(e){return this.audioPlayers.get(e)}addAudioPlayer(e){this.removeAudioPlayer(e),e=this.getAudioSrc(e);const t=new ta.Howl({src:[e]});return this.audioPlayers.set(e,t),t}removeAudioPlayer(e){const t=this.audioPlayers.get(e);t&&(t.unload(),this.audioPlayers.delete(e))}stopAudio(){this.audioPlayers.forEach(e=>{e.stop()})}getAudioUUID(e){return e.match(na)[1]}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var oa=function(e){return e.Hide="hide",e.Show="show",e.Collapse="collapse",e}({}),sa=function(e){return e.None="none",e.Small="small",e.Full="full",e}({}),ra=function(e){return e.None="none",e.Circle="circle",e.Bar="bar",e}({});const aa=c.application===o.Viewer?ra.Bar:ra.Circle;class ca{constructor(e=oa.Hide,t=!0){this.status=e,this.enable=t}}var la,pa=n("qpAl"),da=n.n(pa);!function(e){function t(e){o()&&(e||(e=document.body),da.a.prefixed("requestFullscreen",e)())}function n(){o()&&da.a.prefixed("exitFullscreen",document)()}function i(){return da.a.fullscreen&&da.a.prefixed("fullscreenEnabled",document)}function o(){return!!i()||(console.warn("Fullscreen is not enabled"),!1)}function s(){return da.a.prefixed("fullscreenElement",document)}e.toggleFullscreen=function(e){null===s()?t(e):n()},e.requestFullscreen=t,e.exitFullscreen=n,e.canFullscreen=i,e.checkFullscreenSupport=o,e.getFullscreenElement=s,e.isFullscreen=function(){return null!=s()},e.onFullscreenChange=function(){const e="mozfullscreenchange webkitfullscreenchange MSFullscreenChange fullscreenchange".split(" ").map(e=>Object(as.a)(document.body,e));return Object(ss.a)(...e)}}(la||(la={}));var ua=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},ga=function(e){return e.Light="light",e.Dark="dark",e.Themed="themed",e}({});let ha=(()=>{class e{constructor(e,t){this.store=e,this.graphService=t,this.theme=ga.Dark,this.ngUnsubscribe=new $.a}ngOnInit(){this.store.select(ii.getCheckedNodes).pipe(Object(K.a)(e=>1===e.length),Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{setTimeout(()=>{this.scrollNodeIntoView(e[0])})})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}scrollNodeIntoView(e){const t=this.graphService.sanitizeNodeID(e.objectId),n=document.querySelector(`[data-id=${t}]`);n&&"scrollBehavior"in document.documentElement.style&&n.scrollIntoView({behavior:"smooth",block:"nearest"})}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.g),i.Pb(tt))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-tree"]],inputs:{theme:"theme",searchGraph:"searchGraph"},decls:2,vars:4,consts:[[3,"theme","graph"]],template:function(e,t){1&e&&(i.Qb(0,"app-tree-group",0),i.hc(1,"async")),2&e&&i.lc("theme",t.theme)("graph",t.searchGraph?t.searchGraph:i.ic(1,2,t.viewGraph$))},styles:[""]}),function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);s>3&&r&&Object.defineProperty(t,n,r)}([Object(d.d)(is.getViewGraph),ua("design:type",q.a)],e.prototype,"viewGraph$",void 0),e})();var ba=n("C9yA"),ma=n("vxfF");class fa{}let ya=(()=>{class e{constructor(e){this.view=e}}return e.type="[Edit] Set view",e})(),xa=(()=>{class e{constructor(){}}return e.type="[Edit] Next view",e})(),va=(()=>{class e{constructor(){}}return e.type="[Edit] Previous view",e})(),wa=(()=>{class e{constructor(e){this.show=e}}return e.type="[Edit] Show columns",e})(),Oa=(()=>{class e{constructor(e,t){this.column=e,this.show=t}}return e.type="[Edit] Show column",e})(),Ca=(()=>{class e{constructor(){}}return e.type="[Edit] Reset",e})(),Sa=(()=>{class e{constructor(e){this.layerOrderMode=e}}return e.type="[Edit] Set Layer Order Mode",e})(),ka=(()=>{class e{constructor(e){this.show=e}}return e.type="[Edit] Show Tree Node Ids",e})(),_a=(()=>{class e{constructor(e){this.size=e}}return e.type="[Edit] Set Canvas Size",e})(),ja=(()=>{class e{constructor(e){this.enable=e}}return e.type="[Edit] Auto Capture",e})();var Pa=function(e){return e.Chapter="chapter",e.Label="label",e.Paint="paint",e.Position="position",e.Quiz="quiz",e}({});class Ma{}let Ia=(()=>{class e{constructor(e){this.colorRecipe=e}}return e.type="[Edit Paint] Set Color Recipe",e})(),za=(()=>{class e{constructor(e){this.brushMode=e}}return e.type="[Edit Paint] Set Paint Brush Mode",e})(),Ta=(()=>{class e{constructor(){}}return e.type="[Edit Paint] Clear Color Recipe",e})(),Ua=(()=>{class e{constructor(){}}return e.type="[Edit Paint] Reset Paint",e})();var La=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},Da=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const Ea={colorRecipe:li.recipe,brushMode:function(e){return e[e.Modify=0]="Modify",e[e.Replace=1]="Replace",e}({}).Modify};let Fa=(()=>{let e=class{constructor(){}static getColorRecipe(e){return e.colorRecipe}static getPaintBrushMode(e){return e.brushMode}setColorRecipe(e,{colorRecipe:t}){e.patchState({colorRecipe:t})}setBrushMode(e,t){e.patchState({brushMode:t.brushMode})}clearColorRecipe(e,t){e.patchState({colorRecipe:null})}resetPaint(e,t){e.setState(Ea)}};return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac}),La([Object(d.a)(Ia),Da("design:type",Function),Da("design:paramtypes",[Object,Ia]),Da("design:returntype",void 0)],e.prototype,"setColorRecipe",null),La([Object(d.a)(za),Da("design:type",Function),Da("design:paramtypes",[Object,za]),Da("design:returntype",void 0)],e.prototype,"setBrushMode",null),La([Object(d.a)(Ta),Da("design:type",Function),Da("design:paramtypes",[Object,Ta]),Da("design:returntype",void 0)],e.prototype,"clearColorRecipe",null),La([Object(d.a)(Ua),Da("design:type",Function),Da("design:paramtypes",[Object,Ua]),Da("design:returntype",void 0)],e.prototype,"resetPaint",null),La([Object(d.e)(),Da("design:type",Function),Da("design:paramtypes",[Ma]),Da("design:returntype",void 0)],e,"getColorRecipe",null),La([Object(d.e)(),Da("design:type",Function),Da("design:paramtypes",[Ma]),Da("design:returntype",void 0)],e,"getPaintBrushMode",null),e=La([Object(d.f)({name:"editPaint",defaults:Ea})],e),e})();class Aa{constructor(e,t,n){this.label=e,this.width=t,this.height=n}}const Ra=new Aa("Don't Resize",-1,-1);new Aa("Common (Mobile)",360,640),new Aa("Common (Minimum)",300,300),new Aa("Common (Publish Default)",700,550),new Aa("iPhone X",375,812),new Aa("iPad (Portrait)",768,1024),new Aa("iPad (Landscape)",1024,768);var Na=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},Va=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const Ha={view:Pa.Chapter,showColumns:!0,showLeftColumn:!0,showRightColumn:!0,showHeader:!0,showFooter:!0,autoCapture:c.application!==o.Loft,record:!0,layerOrderMode:!1,showTreeNodeIds:!1,canvasSize:Ra,canvasSettings:{emulateDrawer:!0,emulateColumn:!0}};let Ba=(()=>{let e=class{constructor(e){this.storageService=e}static getView(e){return e.view}static getShowColumns(e){return e.showColumns}static getShowLeftColumn(e){return e.showLeftColumn}static getShowRightColumn(e){return e.showRightColumn}static getShowHeader(e){return e.showHeader}static getShowFooter(e){return e.showFooter}static getRecord(e){return e.record}static getLayerOrderMode(e){return e.layerOrderMode}static getShowTreeNodeIds(e){return e.showTreeNodeIds}static getCanvasSize(e){return e.canvasSize}static getCanvasSettings(e){return e.canvasSettings}static getAutoCapture(e){return e.autoCapture}SetLayerOrderMode(e,t){e.patchState({layerOrderMode:t.layerOrderMode})}ShowTreeNodeIds(e,t){const n=null!=t.show?t.show:!e.getState().showTreeNodeIds;e.patchState({showTreeNodeIds:n})}setView(e,t){e.patchState({view:t.view})}nextView(e,t){const{view:n}=e.getState(),i=Object.values(Pa),o=i[i.indexOf(n)+1]||i[0];e.patchState({view:o})}previousView(e,t){const{view:n}=e.getState(),i=Object.values(Pa),o=i[i.indexOf(n)-1]||i[i.length-1];e.patchState({view:o})}showColumns(e,t){e.patchState({showColumns:t.show})}showColumn(e,t){switch(t.column){case"left":e.patchState({showLeftColumn:t.show});break;case"right":e.patchState({showRightColumn:t.show});break;case"header":e.patchState({showHeader:t.show});break;case"footer":e.patchState({showFooter:t.show})}}resetEditPage(e,t){e.setState(Ha),e.dispatch(new Ua)}setCanvasSize(e,t){e.patchState({canvasSize:t.size})}autoCapture(e,t){e.patchState({autoCapture:t.enable}),c.application===o.Studio&&this.storageService.setLocalItem(Dr.AutoCapture,t.enable)}ngxsOnInit(e){setTimeout(()=>{this.initAutoCapture(e)})}initAutoCapture(e){if(c.application===o.Studio){const t=this.storageService.getLocalJSON(Dr.AutoCapture);"boolean"==typeof t&&e.patchState({autoCapture:t})}}};return e.\u0275fac=function(t){return new(t||e)(i.Zb(Ar))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac}),Na([Object(d.a)(Sa),Va("design:type",Function),Va("design:paramtypes",[Object,Sa]),Va("design:returntype",void 0)],e.prototype,"SetLayerOrderMode",null),Na([Object(d.a)(ka),Va("design:type",Function),Va("design:paramtypes",[Object,ka]),Va("design:returntype",void 0)],e.prototype,"ShowTreeNodeIds",null),Na([Object(d.a)(ya),Va("design:type",Function),Va("design:paramtypes",[Object,ya]),Va("design:returntype",void 0)],e.prototype,"setView",null),Na([Object(d.a)(xa),Va("design:type",Function),Va("design:paramtypes",[Object,xa]),Va("design:returntype",void 0)],e.prototype,"nextView",null),Na([Object(d.a)(va),Va("design:type",Function),Va("design:paramtypes",[Object,xa]),Va("design:returntype",void 0)],e.prototype,"previousView",null),Na([Object(d.a)(wa),Va("design:type",Function),Va("design:paramtypes",[Object,wa]),Va("design:returntype",void 0)],e.prototype,"showColumns",null),Na([Object(d.a)(Oa),Va("design:type",Function),Va("design:paramtypes",[Object,Oa]),Va("design:returntype",void 0)],e.prototype,"showColumn",null),Na([Object(d.a)(Ca),Va("design:type",Function),Va("design:paramtypes",[Object,Ca]),Va("design:returntype",void 0)],e.prototype,"resetEditPage",null),Na([Object(d.a)(_a),Va("design:type",Function),Va("design:paramtypes",[Object,_a]),Va("design:returntype",void 0)],e.prototype,"setCanvasSize",null),Na([Object(d.a)(ja),Va("design:type",Function),Va("design:paramtypes",[Object,ja]),Va("design:returntype",void 0)],e.prototype,"autoCapture",null),Na([Object(d.e)(),Va("design:type",Function),Va("design:paramtypes",[fa]),Va("design:returntype",void 0)],e,"getView",null),Na([Object(d.e)(),Va("design:type",Function),Va("design:paramtypes",[fa]),Va("design:returntype",void 0)],e,"getShowColumns",null),Na([Object(d.e)(),Va("design:type",Function),Va("design:paramtypes",[fa]),Va("design:returntype",void 0)],e,"getShowLeftColumn",null),Na([Object(d.e)(),Va("design:type",Function),Va("design:paramtypes",[fa]),Va("design:returntype",void 0)],e,"getShowRightColumn",null),Na([Object(d.e)(),Va("design:type",Function),Va("design:paramtypes",[fa]),Va("design:returntype",void 0)],e,"getShowHeader",null),Na([Object(d.e)(),Va("design:type",Function),Va("design:paramtypes",[fa]),Va("design:returntype",void 0)],e,"getShowFooter",null),Na([Object(d.e)(),Va("design:type",Function),Va("design:paramtypes",[fa]),Va("design:returntype",void 0)],e,"getRecord",null),Na([Object(d.e)(),Va("design:type",Function),Va("design:paramtypes",[fa]),Va("design:returntype",void 0)],e,"getLayerOrderMode",null),Na([Object(d.e)(),Va("design:type",Function),Va("design:paramtypes",[fa]),Va("design:returntype",void 0)],e,"getShowTreeNodeIds",null),Na([Object(d.e)(),Va("design:type",Function),Va("design:paramtypes",[fa]),Va("design:returntype",void 0)],e,"getCanvasSize",null),Na([Object(d.e)(),Va("design:type",Function),Va("design:paramtypes",[fa]),Va("design:returntype",void 0)],e,"getCanvasSettings",null),Na([Object(d.e)(),Va("design:type",Function),Va("design:paramtypes",[fa]),Va("design:returntype",void 0)],e,"getAutoCapture",null),e=Na([Object(d.f)({name:"edit",defaults:Ha,children:[Fa]})],e),e})(),Qa=(()=>{class e{constructor(){}onClick(e){e.stopPropagation(),e.stopImmediatePropagation()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=i.Kb({type:e,selectors:[["","appEventFence",""]],hostBindings:function(e,t){1&e&&i.cc("click",(function(e){return t.onClick(e,e.target)}))}}),e})(),$a=(()=>{class e{constructor(){}get iconClass(){let e="fas fa-"+this.icon;return this.size&&(e+=" fa-"+this.size),e}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-icon"]],inputs:{icon:"icon",size:"size"},decls:1,vars:1,consts:[[3,"ngClass"]],template:function(e,t){1&e&&i.Qb(0,"i",0),2&e&&i.lc("ngClass",t.iconClass)},directives:[ms.i],styles:[""],encapsulation:2,changeDetection:0}),e})(),qa=(()=>{class e{constructor(e){this.engineService=e}getClipboardAPISupport(){return"clipboard"in navigator}getClipboardAPI(){return navigator.clipboard}copyToClipboard(e,t){if(!0===c.native||c.platform===a.SDK)return new q.a(n=>{this.engineService.fireEvent(it.NativeShare,{type:t,value:e}),n.next(!0),n.complete()});if(this.getClipboardAPISupport()){const t=this.getClipboardAPI();return new q.a(n=>{t.writeText(e).then(()=>{n.next(!0),n.complete()}).catch(e=>{n.next(!1),n.complete()})})}return Object(S.a)(!1)}copyInputFieldValue(e){e.select();let t=!1;try{t=document.execCommand("copy")}catch(n){t=!1}return t}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(lt))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var Wa=n("dNgK");const Ka=["app-button",""],Ga=function(e,t,n,i,o,s,r,a,c,l,p,d,u,g,h,b,m,f,y,x,v,w){return{"app-button--xsmall":e,"app-button--small":t,"app-button--medium":n,"app-button--large":i,"app-button--flat":o,"app-button--default":s,"app-button--primary":r,"app-button--info":a,"app-button--outline":c,"app-button--text":l,"app-button--light":p,"app-button--dark":d,"app-button--themed":u,"app-button--circle":g,"app-button--rounded":h,"app-button--square":b,"app-button--selected":m,"app-button--uppercase":f,"app-button--disabled":y,"app-button--no-border":x,"app-button--expanded":v,"app-button--left":w}},Za=["*"];var Ja=function(e){return e.XSmall="xsmall",e.Small="small",e.Medium="medium",e.Large="large",e}({}),Xa=function(e){return e.Default="default",e.Flat="flat",e.Primary="primary",e.Info="info",e.Outline="outline",e.Text="text",e}({}),Ya=function(e){return e.Default="default",e.Circle="circle",e.Rounded="rounded",e.Square="square",e}({}),ec=function(e){return e.Dark="dark",e.Light="light",e.Themed="themed",e}({}),tc=function(e){return e.Left="left",e.Center="center",e}({});let nc=(()=>{class e{constructor(){this.buttonSize=Ja.Medium,this.buttonType=Xa.Default,this.buttonTheme=ec.Dark,this.buttonShape=Ya.Default,this.buttonAlign=tc.Center,this.uppercase=!0,this.selected=!1,this.expanded=!1,this.bordered=!0}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["button","app-button",""],["a","app-button",""]],hostVars:1,hostBindings:function(e,t){2&e&&i.Yb("disabled",t.disabled)},inputs:{buttonSize:"buttonSize",buttonType:"buttonType",buttonTheme:"buttonTheme",buttonShape:"buttonShape",buttonAlign:"buttonAlign",uppercase:"uppercase",selected:"selected",expanded:"expanded",disabled:"disabled",bordered:"bordered"},attrs:Ka,ngContentSelectors:Za,decls:3,vars:24,consts:[[1,"app-button",3,"ngClass"],[1,"app-button__container"]],template:function(e,t){1&e&&(i.kc(),i.Vb(0,"div",0),i.Vb(1,"div",1),i.jc(2),i.Ub(),i.Ub()),2&e&&i.lc("ngClass",i.tc(1,Ga,["xsmall"==t.buttonSize,"small"==t.buttonSize,"medium"==t.buttonSize,"large"==t.buttonSize,"flat"==t.buttonType,"default"==t.buttonType,"primary"==t.buttonType,"info"==t.buttonType,"outline"==t.buttonType,"text"==t.buttonType,"light"==t.buttonTheme,"dark"==t.buttonTheme,"themed"==t.buttonTheme,"circle"==t.buttonShape,"rounded"==t.buttonShape,"square"==t.buttonShape,t.selected,t.uppercase,t.disabled,!t.bordered,t.expanded,"left"===t.buttonAlign]))},directives:[ms.i],styles:['.text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3838}.text-info{color:#0060c4}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}a[app-button],button[app-button]{border-color:transparent;background:none;border-width:0;padding:0;margin:0;outline:0 none}a[app-button]:not([disabled]):hover,button[app-button]:not([disabled]):hover{cursor:pointer}a[app-button]:focus .app-button--themed,button[app-button]:focus .app-button--themed{background:#f1f4fa;outline:none}.app-button{font-size:12px;letter-spacing:.3px;line-height:1.4em;align-items:center;border-radius:4px;display:flex;font-family:Inter UI,sans-serif;justify-content:center;padding:0 16px;position:relative;text-align:center;transition:background-color .12s;width:100%}.app-button:after{content:" ";background-color:#283853;border-radius:4px;display:block;position:absolute;left:0;top:0;bottom:0;right:0;opacity:0;z-index:1;transition:opacity .06s}.app-button:not(.app-button--disabled):hover:after{opacity:.7}.app-button__container{position:relative;z-index:2;width:100%}.app-button--uppercase{text-transform:uppercase}.app-button--expanded{display:flex;flex:1}.app-button--xsmall{height:24px;min-width:24px;padding:0 8px;font-size:10px;letter-spacing:.25px;line-height:1.4em}.app-button--small{height:32px;min-width:32px;padding:0 12px}.app-button--medium,.app-button--small{font-size:12px;letter-spacing:.3px;line-height:1.4em}.app-button--medium{height:36px;min-width:36px;padding:0 16px}.app-button--large{height:48px;min-width:48px;padding:0 16px;font-size:14px;letter-spacing:.35px;line-height:1.4em}.app-button--no-border,.app-button--no-border:after{border-radius:0!important}.app-button--left{text-align:left}.app-button--themed{color:#374a68;color:var(--app-button-color)}.app-button--themed:hover{color:#1c2a3f;color:var(--app-button-color--hover)}.app-button--themed:after{background-color:#d7e0ea;background-color:var(--app-button-bg--hover)}.app-button--dark{color:#d7e0ea}.app-button--dark:hover{color:#fff}.app-button--dark:after{background-color:#283853}.app-button--dark.app-button--flat{background:#374a68}.app-button--dark.app-button--default{background:transparent}.app-button--dark.app-button--outline{background:transparent;border:1px solid #374a68;transition:border-color .12s}.app-button--dark.app-button--outline:hover{border-color:#96a8c0}.app-button--dark.app-button--outline:hover:after{background-color:transparent;display:none}.app-button--dark.app-button--text{background:transparent;color:#d7e0ea}.app-button--dark.app-button--text:hover{color:#fff}.app-button--dark.app-button--text:hover:after{display:none}.app-button--dark.app-button--selected{background-color:#1c5ab9;color:#fff}.app-button--dark.app-button--selected:hover:after{display:none}.app-button--light{color:#283853}.app-button--light:hover{color:#1c2a3f}.app-button--light:after{background-color:#96a8c0}.app-button--light:not(.app-button--disabled):hover:after{opacity:.6}.app-button--light.app-button--flat{background:#d7e0ea;font-weight:500}.app-button--light.app-button--flat.app-button--selected{background-color:#96a8c0}.app-button--light.app-button--default{background:transparent;color:#131c2a}.app-button--light.app-button--default:not(.app-button--disabled):hover:after{opacity:.2}.app-button--light.app-button--outline{background:transparent;border:1px solid #96a8c0;color:#283853;transition:border-color .12s}.app-button--light.app-button--outline:after{display:none}.app-button--light.app-button--outline:hover{background:rgba(55,74,104,.05);border-color:#374a68;color:#1c2a3f}.app-button--light.app-button--outline:hover:after{background-color:transparent}.app-button--light.app-button--selected{background-color:#eaeff5}.app-button--light.app-button--selected:hover:after{display:none}.app-button--light.app-button--text{color:#283853}.app-button--light.app-button--text:hover{color:#1c2a3f}.app-button--light.app-button--text:hover:after{display:none}.app-button.app-button--primary{background:#de3838;color:#fff}.app-button.app-button--primary:after{background:#f9fafd}.app-button.app-button--primary:hover:after{opacity:.1}.app-button.app-button--info{background:#2d72dc;color:#fff}.app-button.app-button--info:after{background:#f9fafd}.app-button.app-button--info:hover:after{opacity:.1}.app-button--selected{background-color:#1c5ab9}.app-button--disabled{opacity:.5}.app-button--circle{border-radius:50%}.app-button--circle.app-button--xsmall{width:24px}.app-button--circle.app-button--small{width:32px;padding:0 6px}.app-button--circle.app-button--medium{width:36px;padding:0 8px}.app-button--circle.app-button--large{width:48px}.app-button--circle:after{border-radius:50%}.app-button--square{padding:0}.app-button--square.app-button--xsmall{width:24px;height:24px}.app-button--square.app-button--small{width:32px;height:32px}.app-button--square.app-button--medium{width:36px;height:36px}.app-button--square.app-button--large{width:48px;height:48px}.app-button--rounded,.app-button--rounded:after{border-radius:18px}'],encapsulation:2,changeDetection:0}),e})();var ic=n("STbY"),oc=function(e){return e.All="all",e.iOS="ios",e.Android="android",e}({});let sc=(()=>{class e{constructor(e,t,n){this.templateRef=e,this.viewContainer=t,this.router=n,this._appFlagApplicationMode="include"}get appFlagApplication(){return this._appFlagApplication}set appFlagApplication(e){this._appFlagApplication=e}get appFlagApplicationMode(){return this._appFlagApplicationMode}set appFlagApplicationMode(e){this._appFlagApplicationMode=e}get appFlagApplicationPage(){return this._appFlagApplicationPage}set appFlagApplicationPage(e){this._appFlagApplicationPage=e}get appFlagApplicationPlatform(){return this._appFlagApplicationPlatform}set appFlagApplicationPlatform(e){this._appFlagApplicationPlatform=e}get appFlagApplicationNative(){return this._appFlagApplicationNative}set appFlagApplicationNative(e){this._appFlagApplicationNative=e}ngOnInit(){this.update()}update(){let e=!1,t=!1,n=!1,i=!1,o=!1;if(""===this.appFlagApplication?t=!0:Array.isArray(this.appFlagApplication)?t=this.appFlagApplication.some(e=>e===c.application):"string"==typeof this.appFlagApplication&&(t=this.appFlagApplication===c.application),null==this.appFlagApplicationPage)n=!0;else{const e=this.router.url;Array.isArray(this.appFlagApplicationPage)?n=this.appFlagApplicationPage.some(t=>e.indexOf(t)>=0):"string"==typeof this.appFlagApplicationPage&&(n=e.indexOf(this.appFlagApplicationPage)>=0)}if(null==this.appFlagApplicationPlatform)i=!0;else{const e=c.platform;Array.isArray(this.appFlagApplicationPlatform)?i=this.appFlagApplicationPlatform.some(t=>e.indexOf(t)>=0):"string"==typeof this.appFlagApplicationPlatform&&(i=e.indexOf(this.appFlagApplicationPlatform)>=0)}null==this.appFlagApplicationNative?o=!0:(o=c.native,(Array.isArray(this.appFlagApplicationNative)?this.appFlagApplicationNative:[this.appFlagApplicationNative]).includes(oc.iOS)&&(o=c.native&&void 0!==window.webkit)),e=t&&n&&i&&o,e&&"include"===this.appFlagApplicationMode||!e&&"exclude"===this.appFlagApplicationMode?this.viewContainer.createEmbeddedView(this.templateRef):this.viewContainer.clear()}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(i.O),i.Pb(i.S),i.Pb(Z.e))},e.\u0275dir=i.Kb({type:e,selectors:[["","appFlagApplication",""]],inputs:{appFlagApplication:"appFlagApplication",appFlagApplicationMode:"appFlagApplicationMode",appFlagApplicationPage:"appFlagApplicationPage",appFlagApplicationPlatform:"appFlagApplicationPlatform",appFlagApplicationNative:"appFlagApplicationNative"}}),e})();var rc=n("f0Cb");const ac=["nodeActionsTrigger"];function cc(e,t){if(1&e&&(i.Tb(0),i.Vb(1,"button",31),i.Mc(2,"Select"),i.Ub(),i.Qb(3,"mat-divider"),i.Sb()),2&e){i.gc();const e=i.vc(21);i.Db(1),i.lc("matMenuTriggerFor",e)}}function lc(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",32),i.cc("click",(function(){i.zc(e);const t=i.gc();return t.toggleVisible(t.node,!0)})),i.Mc(1,"Show"),i.Ub()}}function pc(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",33),i.cc("click",(function(){i.zc(e);const t=i.gc();return t.toggleVisible(t.node,!1)})),i.Mc(1,"Hide"),i.Ub()}}function dc(e,t){if(1&e&&(i.Tb(0),i.Qb(1,"mat-divider"),i.Vb(2,"button",34),i.Mc(3,"Pickable / Unpickable"),i.Ub(),i.Sb()),2&e){i.gc();const e=i.vc(40);i.Db(2),i.lc("matMenuTriggerFor",e)}}function uc(e,t){if(1&e){const e=i.Wb();i.Tb(0),i.Qb(1,"mat-divider"),i.Vb(2,"button",35),i.cc("click",(function(){i.zc(e);const t=i.gc();return t.editNodeLabel(t.node)})),i.Mc(3,"Edit Object Name"),i.Ub(),i.Sb()}}function gc(e,t){if(1&e&&(i.Tb(0),i.Qb(1,"mat-divider"),i.Vb(2,"button",36),i.Mc(3,"Copy"),i.Ub(),i.Sb()),2&e){i.gc();const e=i.vc(47);i.Db(2),i.lc("matMenuTriggerFor",e)}}function hc(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",37),i.cc("click",(function(){i.zc(e);const t=i.gc();return t.toggleVisible(t.node,!0)})),i.Mc(1,"Show This"),i.Ub()}}function bc(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",38),i.cc("click",(function(){i.zc(e);const t=i.gc();return t.toggleVisible(t.node,!1)})),i.Mc(1,"Hide This"),i.Ub()}}function mc(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",39),i.cc("click",(function(){i.zc(e);const t=i.gc();return t.togglePickable(t.node,!1)})),i.Mc(1,"Make Unpickable"),i.Ub()}}function fc(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",40),i.cc("click",(function(){i.zc(e);const t=i.gc();return t.togglePickable(t.node,!0)})),i.Mc(1,"Make Pickable"),i.Ub()}}let yc=(()=>{class e{constructor(e,t,n,s,r,a,c){this.store=e,this.graphService=t,this.changeDetectorRef=n,this.clipboardService=s,this.snackbar=r,this.cameraService=a,this.engineService=c,this.application=o,this.shortId="",this.theme="dark",this.eventCategory="",this.nodeActionsClosed=new i.p}get node(){return this._node}set node(e){this._node=e;const t=this.node.id.split("-");this.shortId=2===t.length?t[1]:t[0]}ngOnInit(){}isNodeChecked(e){return this.store.selectSnapshot(ii.getNodes)[e].checked}isNodeShown(e){return this.store.selectSnapshot(ii.getNodes)[e].shown}checkNode(e,t){const n=void 0===t?!this.isNodeChecked(e.id):t;this.store.dispatch(new $n.UpdateNodesChecked(n,[e.id]))}checkInverse(e){this.store.dispatch(new $n.UpdateNodesChecked(!0)),this.store.dispatch(new $n.UpdateNodesChecked(!1,[e.id]))}setCheckedNodes(e,t){this.store.dispatch(new $n.UpdateNodesChecked(!1));const n=void 0===t?!this.isNodeChecked(e.id):t;this.store.dispatch(new $n.UpdateNodesChecked(n,[e.id]))}flyToNode(e){this.store.dispatch(new fe(e.id))}hideNode(e){this.store.dispatch(new $n.UpdateNodesShown(!1,[e.id]))}hideInverse(e){const t=this.store.selectSnapshot(is.getViewGraph),n=this.graphService.getAllLeafDescendants(t,[e.id]),i=this.graphService.getInverseSelection(t,[e.id]),o={};n.forEach(e=>{o[e]=!0}),i.forEach(e=>{o[e]=!1});const s=new $n.UpdateNodesShown(void 0,void 0,o),r=Kn(this.store.selectSnapshot(ii),s);this.store.dispatch(new $n.ApplyPatch(r.patches));const a=this.engineService.getObjectBoundary(e.id),c=this.cameraService.cameraAfterFlyTo(a),l=new It(c),p=function(e,t){const[n,i,o]=immer.produceWithPatches(e,e=>{e.cameraFlyTo=t.camera});return{nextState:n,patches:i,inversePatches:o}}(this.store.selectSnapshot(Ko),l);this.store.dispatch(new zt(p.patches)),this.store.dispatch(new $n.UpdateNodeSelected),this.store.dispatch(new $n.UpdateNodesChecked(!1)),this.store.dispatch(new qn.SavePatches([{forward:r.patches,inverse:r.inversePatches,patchAction:$n.ApplyPatch},{forward:p.patches,inverse:p.inversePatches,patchAction:zt}]))}showNode(e){this.store.dispatch(new $n.UpdateNodesShown(!0,[e.id])),this.changeDetectorRef.markForCheck()}toggleVisible(e,t){const n=void 0===t?this.isNodeShown(e.id):t;this.store.dispatch(new $n.UpdateNodesShown(n,[e.id])),this.changeDetectorRef.markForCheck()}togglePickable(e,t){this.store.dispatch(new $n.UpdateNodesPickable(t,[e.id])),this.changeDetectorRef.markForCheck()}makeEverythingElseUnpickale(e){this.store.dispatch(new $n.UpdateNodesPickable(!1)),this.store.dispatch(new $n.UpdateNodesPickable(!0,[e.id]))}fadeInverseNodes(e){const t=this.store.selectSnapshot(is.getViewGraph),n=this.graphService.getInverseSelection(t,[e.id]),i=this.graphService.getNodes(t,n);this.store.dispatch(new $n.UpdateNodesPaint(bi.recipe,i.map(e=>e.id)))}fadeNode(e){this.store.dispatch(new $n.UpdateNodesPaint(bi.recipe,[e.id]))}editNodeLabel(e){this.store.dispatch(new $e(e))}copy(e){this.clipboardService.copyToClipboard(e,"text").subscribe(()=>{this.snackbar.open(`Copied ${e} to clipboard.`)})}onMenuClosed(){this.nodeActionsClosed.emit()}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.g),i.Pb(tt),i.Pb(i.i),i.Pb(qa),i.Pb(Wa.b),i.Pb(Lt),i.Pb(lt))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-node-actions"]],viewQuery:function(e,t){if(1&e&&i.Gc(ac,!0),2&e){let e;i.uc(e=i.dc())&&(t.nodeActionsTrigger=e.first)}},inputs:{node:"node",theme:"theme",eventCategory:"eventCategory"},outputs:{nodeActionsClosed:"nodeActionsClosed"},decls:55,vars:21,consts:[[3,"gaCategory"],["app-button","","data-test","nodeActionsTrigger","buttonSize","xsmall",3,"buttonTheme","matMenuTriggerFor","menuClosed"],["nodeActionsTrigger","matMenuTrigger"],["icon","ellipsis-v"],[3,"overlapTrigger"],["nodeActions","matMenu"],[4,"appFlagApplication","appFlagApplicationPage","appFlagApplicationMode"],["gaEvent","","gaAction","Clicked Show","mat-menu-item","","data-test","nodeActionsShow",3,"click",4,"ngIf"],["gaEvent","","gaAction","Clicked Hide","mat-menu-item","","data-test","nodeActionsHide",3,"click",4,"ngIf"],["gaEvent","","gaAction","Clicked Isolate","mat-menu-item","","data-test","nodeActionsIsolate",3,"click"],["data-test","nodeActionsFadeTrigger","mat-menu-item","",3,"matMenuTriggerFor"],[4,"appFlagApplication"],["gaEvent","","gaAction","Clicked Fly To","mat-menu-item","","data-test","nodeActionsFlyTo",3,"click"],["selectActions","matMenu"],["gaEvent","","gaAction","Clicked Select This","mat-menu-item","","data-test","nodeActionsSelectThis",3,"click"],["gaEvent","","gaAction","Clicked Select Everything Else","mat-menu-item","","data-test","nodeActionsSelectEverythingElse",3,"click"],["fadeActions","matMenu"],["gaEvent","","gaAction","Clicked Fade This","mat-menu-item","","data-test","nodeActionsFadeThis",3,"click"],["gaEvent","","gaAction","Clicked Fade Everything Else","mat-menu-item","","data-test","nodeActionsFadeEverythingElse",3,"click"],["showHideActions","matMenu"],["gaEvent","","gaAction","Clicked Show This","mat-menu-item","","data-test","nodeActionsShowThis",3,"click",4,"ngIf"],["gaEvent","","gaAction","Clicked Hide This","mat-menu-item","","data-test","nodeActionsShowEverythingElse",3,"click",4,"ngIf"],["gaEvent","","gaAction","Clicked Hide Everything Else","mat-menu-item","",3,"click"],["pickableActions","matMenu"],["gaEvent","","gaAction","Clicked Make Unpickable","mat-menu-item","","data-test","nodeActionsPickable",3,"click",4,"ngIf"],["gaEvent","","gaAction","Clicked Make Pickable","mat-menu-item","","data-test","nodeActionsUnpickable",3,"click",4,"ngIf"],["gaEvent","","gaAction","Clicked Make Everything Else Unpickable","mat-menu-item","","data-test","nodeActionsEverythingElseUnpickable",3,"click"],["copyActions","matMenu"],["gaEvent","","gaAction","Clicked Copy Short ID","mat-menu-item","","data-test","nodeActionsCopyShortID",3,"click"],["gaEvent","","gaAction","Clicked Copy Full ID","mat-menu-item","","data-test","nodeActionsCopyFullID",3,"click"],["gaEvent","","gaAction","Clicked Copy Display Name","mat-menu-item","","data-test","nodeActionsCopyDisplayName",3,"click"],["mat-menu-item","",3,"matMenuTriggerFor"],["gaEvent","","gaAction","Clicked Show","mat-menu-item","","data-test","nodeActionsShow",3,"click"],["gaEvent","","gaAction","Clicked Hide","mat-menu-item","","data-test","nodeActionsHide",3,"click"],["mat-menu-item","","data-test","nodeActionsPickableTrigger",3,"matMenuTriggerFor"],["gaEvent","","gaAction","Clicked Edit Object Name","mat-menu-item","","data-test","nodeActionsEditName",3,"click"],["mat-menu-item","","data-test","nodeActionsCopyTrigger",3,"matMenuTriggerFor"],["gaEvent","","gaAction","Clicked Show This","mat-menu-item","","data-test","nodeActionsShowThis",3,"click"],["gaEvent","","gaAction","Clicked Hide This","mat-menu-item","","data-test","nodeActionsShowEverythingElse",3,"click"],["gaEvent","","gaAction","Clicked Make Unpickable","mat-menu-item","","data-test","nodeActionsPickable",3,"click"],["gaEvent","","gaAction","Clicked Make Pickable","mat-menu-item","","data-test","nodeActionsUnpickable",3,"click"]],template:function(e,t){if(1&e&&(i.Tb(0,0),i.Vb(1,"button",1,2),i.cc("menuClosed",(function(){return t.onMenuClosed()})),i.Qb(3,"app-icon",3),i.Ub(),i.Vb(4,"mat-menu",4,5),i.Kc(6,cc,4,1,"ng-container",6),i.Kc(7,lc,2,0,"button",7),i.Kc(8,pc,2,0,"button",8),i.Vb(9,"button",9),i.cc("click",(function(){return t.hideInverse(t.node)})),i.Mc(10,"Isolate"),i.Ub(),i.Qb(11,"mat-divider"),i.Vb(12,"button",10),i.Mc(13,"Fade"),i.Ub(),i.Kc(14,dc,4,1,"ng-container",11),i.Qb(15,"mat-divider"),i.Vb(16,"button",12),i.cc("click",(function(){return t.flyToNode(t.node)})),i.Mc(17,"Fly To"),i.Ub(),i.Kc(18,uc,4,0,"ng-container",6),i.Kc(19,gc,4,1,"ng-container",6),i.Ub(),i.Vb(20,"mat-menu",null,13),i.Vb(22,"button",14),i.cc("click",(function(){return t.checkNode(t.node,!0)})),i.Mc(23,"Select This"),i.Ub(),i.Vb(24,"button",15),i.cc("click",(function(){return t.checkInverse(t.node)})),i.Mc(25,"Select Everything Else"),i.Ub(),i.Ub(),i.Vb(26,"mat-menu",null,16),i.Vb(28,"button",17),i.cc("click",(function(){return t.fadeNode(t.node)})),i.Mc(29,"Fade This"),i.Ub(),i.Vb(30,"button",18),i.cc("click",(function(){return t.fadeInverseNodes(t.node)})),i.Mc(31,"Fade Everything Else"),i.Ub(),i.Ub(),i.Vb(32,"mat-menu",null,19),i.Kc(34,hc,2,0,"button",20),i.Kc(35,bc,2,0,"button",21),i.Qb(36,"mat-divider"),i.Vb(37,"button",22),i.cc("click",(function(){return t.hideInverse(t.node)})),i.Mc(38,"Hide Everything Else"),i.Ub(),i.Ub(),i.Vb(39,"mat-menu",null,23),i.Kc(41,mc,2,0,"button",24),i.Kc(42,fc,2,0,"button",25),i.Qb(43,"mat-divider"),i.Vb(44,"button",26),i.cc("click",(function(){return t.makeEverythingElseUnpickale(t.node)})),i.Mc(45,"Make Everything Else Unpickable"),i.Ub(),i.Ub(),i.Vb(46,"mat-menu",null,27),i.Vb(48,"button",28),i.cc("click",(function(){return t.copy(t.shortId)})),i.Mc(49,"Copy Short ID"),i.Ub(),i.Vb(50,"button",29),i.cc("click",(function(){return t.copy(t.node.id)})),i.Mc(51,"Copy Full ID"),i.Ub(),i.Qb(52,"mat-divider"),i.Vb(53,"button",30),i.cc("click",(function(){return t.copy(t.node.label)})),i.Mc(54,"Copy Display Name"),i.Ub(),i.Ub(),i.Sb()),2&e){const e=i.vc(5),n=i.vc(27);i.lc("gaCategory",t.eventCategory),i.Db(1),i.lc("buttonTheme",t.theme)("matMenuTriggerFor",e),i.Db(3),i.lc("overlapTrigger",!0),i.Db(2),i.lc("appFlagApplication",t.application.All)("appFlagApplicationPage","/edit")("appFlagApplicationMode","include"),i.Db(1),i.lc("ngIf",!t.node.boolState.shown),i.Db(1),i.lc("ngIf",t.node.boolState.shown),i.Db(4),i.lc("matMenuTriggerFor",n),i.Db(2),i.lc("appFlagApplication",t.application.Loft),i.Db(4),i.lc("appFlagApplication",t.application.Loft)("appFlagApplicationPage","/edit")("appFlagApplicationMode","include"),i.Db(1),i.lc("appFlagApplication",t.application.Loft)("appFlagApplicationPage","/edit")("appFlagApplicationMode","include"),i.Db(15),i.lc("ngIf",!t.node.boolState.shown),i.Db(1),i.lc("ngIf",t.node.boolState.shown),i.Db(6),i.lc("ngIf",t.node.boolState.pickable),i.Db(1),i.lc("ngIf",!t.node.boolState.pickable)}},directives:[J.a,nc,ic.d,$a,ic.a,sc,ms.l,J.b,ic.b,rc.a],styles:[""],changeDetection:0}),e})(),xc=(()=>{class e{constructor(e){this.el=e}ngAfterContentInit(){window.matchMedia("(hover: hover)").matches&&setTimeout(()=>{this.el.nativeElement.focus()},0)}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(i.m))},e.\u0275dir=i.Kb({type:e,selectors:[["input","appAutoFocus",""]]}),e})();var vc=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},wc=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Oc(e,t){if(1&e){const e=i.Wb();i.Vb(0,"div",9),i.cc("click",(function(){i.zc(e);const t=i.gc();return t.handleExpandClick(t.node,t.node.boolState.expanded)})),i.Qb(1,"app-icon",10),i.Ub()}if(2&e){const e=i.gc();i.Hb("tree-node__expand--open",e.node.boolState.expanded)}}function Cc(e,t){if(1&e&&(i.Vb(0,"div",15),i.Mc(1),i.Ub()),2&e){const e=i.gc(2);i.Db(1),i.Oc(" ",e.shortId," ")}}const Sc=function(e){return{"tree-node__label--padded":e}};function kc(e,t){if(1&e){const e=i.Wb();i.Vb(0,"div",11),i.cc("dblclick",(function(){return i.zc(e),i.gc().setEditLabelMode(!0)})),i.Vb(1,"div",12),i.Kc(2,Cc,2,1,"div",13),i.hc(3,"async"),i.Vb(4,"div",14),i.Mc(5),i.Ub(),i.Ub(),i.Ub()}if(2&e){const e=i.gc();i.lc("ngClass",i.oc(5,Sc,!e.hasChildren&&e.nested)),i.Db(2),i.lc("ngIf",i.ic(3,3,e.showTreeNodeIds$)),i.Db(3),i.Oc(" ",e.node.label," ")}}function _c(e,t){if(1&e){const e=i.Wb();i.Vb(0,"input",16),i.cc("blur",(function(t){return i.zc(e),i.gc().handleObjectLabel(t)}))("keyup",(function(t){return i.zc(e),i.gc().handleObjectLabel(t)})),i.Ub()}if(2&e){const e=i.gc();i.lc("value",e.node.label)}}function jc(e,t){if(1&e){const e=i.Wb();i.Vb(0,"input",17),i.cc("change",(function(t){i.zc(e);const n=i.gc();return n.handleLayerOrder(t,n.node)})),i.Ub()}if(2&e){const e=i.gc();i.lc("value",e.node.numState.layer)}}const Pc=function(e,t,n,i,o){return{"tree-node--light":e,"tree-node--themed":t,"tree-node--hidden":n,"tree-node--selected":i,"tree-node--unpickable":o}};let Mc=(()=>{class e{constructor(e,t,n,i,o){this.store=e,this.graphService=t,this.engineService=n,this.router=i,this.changeDetection=o,this.treeTheme=ga,this.isLoft="module"===c.exportType,this.nested=!0,this.theme=ga.Dark,this.checked=!1,this.hasChildren=!1,this.editLabelMode=!1,this.sanitizedID="",this.parentId="",this.shortId="",this.ngUnsubscribe=new $.a}get node(){return this._node}set node(e){this._node=e,this.sanitizedID=this.graphService.sanitizeNodeID(this.node.id),this.checked=this.isNodeChecked(this.node.id);const t=this.node.id.split("-");2===t.length?(this.parentId=t[0],this.shortId=t[1]):(this.shortId=t[0],this.parentId=""),this.shortId=this.shortId.replace(/_/g," "),this.nested&&(this.hasChildren=Ye.getSuccessors(this.graph,this.node.id).length>0),this.changeDetection.markForCheck()}isNodeChecked(e){return this.store.selectSnapshot(ii.getNodes)[e].checked}isNodeShown(e){return this.store.selectSnapshot(ii.getNodes)[e].shown}ngOnInit(){this.checkedNodesIds$.pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.checked=e.some(e=>e===this.node.id),this.changeDetection.markForCheck()}),this.labelEditNode$.pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.editLabelMode=e===this.node}),this.isEditMode=this.router.url.indexOf("/edit")>=0}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}handleExpandClick(e,t){this.store.dispatch(t?new Be(e):new He(e))}handleNodeClick(e,t){e.shiftKey?this.checkNode(t):(this.setCheckedNodes(t),this.isFlyToNodeEnabled(t)&&this.store.dispatch(new fe(t.id)),this.handleExpandClick(t,!t.boolState.expanded))}toggleVisible(e,t){const n=void 0===t?!this.isNodeShown(e.id):t;this.store.dispatch(new $n.UpdateNodesShown(n,[e.id])),this.changeDetection.markForCheck()}handleLayerOrder(e,t){const n=parseInt(e.target.value,10);this.setLayerOrder(t,n)}checkNode(e,t){const n=void 0===t?!this.isNodeChecked(e.id):t;this.store.dispatch(new $n.UpdateNodesChecked(n,[e.id]))}setCheckedNodes(e,t){this.store.dispatch(new $n.UpdateNodesChecked(!1));const n=void 0===t?!this.isNodeChecked(e.id):t;this.store.dispatch(new $n.UpdateNodesChecked(n,[e.id]))}setLayerOrder(e,t){this.store.dispatch(new Ue([e],t)),this.changeDetection.markForCheck()}handleObjectLabel(e){const t=e.target;e instanceof KeyboardEvent?("enter"===e.key.toLowerCase()&&(this.setLabel(t.value),this.setEditLabelMode(!1)),"escape"===e.key.toLowerCase()&&this.setEditLabelMode(!1)):e instanceof FocusEvent&&"blur"===e.type&&(this.setLabel(t.value),this.setEditLabelMode(!1))}setLabel(e){this.node.label=e,this.store.dispatch(new Le(this.node.id,e))}setEditLabelMode(e){c.application===o.Loft&&this.isEditMode&&this.store.dispatch(new $e(e?this.node:null))}isFlyToNodeEnabled(e){return!this.isEditMode&&(e.boolState.shown||this.engineService.getObjectLoaded(e.id))}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.g),i.Pb(tt),i.Pb(lt),i.Pb(Z.e),i.Pb(i.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-tree-nested-node"]],inputs:{graph:"graph",node:"node",nested:"nested",theme:"theme"},decls:10,vars:17,consts:[["gaCategory","Search Node","data-test","treeNode","tabindex","0",1,"tree-node",3,"ngClass","keyup.enter","click"],["appEventFence","","class","tree-node__expand","data-test","treeNodeExpand",3,"tree-node__expand--open","click",4,"ngIf"],["class","tree-node__label",3,"ngClass","dblclick",4,"ngIf"],["type","text","appEventFence","","appAutoFocus","","data-test","treeNodeEditLabel","class","input",3,"value","blur","keyup",4,"ngIf"],["appEventFence","","type","text","data-test","treeNodeLayerOrder","class","input input--small tree-node__layer-order",3,"value","change",4,"ngIf"],["gaEvent","","gaAction","Clicked Toggle (Eye Icon)","data-test","treeNodeVisible","appEventFence","",1,"tree-node__visible",3,"gaLabel","click"],["icon","eye","data-test","treeNodeVisibleTrue","size","xs",1,"tree-node__eye"],["icon","eye-slash","data-test","treeNodeVisibleFalse","size","xs",1,"tree-node__eye-slash"],["eventCategory","Search Node","appEventFence","",3,"theme","node"],["appEventFence","","data-test","treeNodeExpand",1,"tree-node__expand",3,"click"],["icon","caret-right"],[1,"tree-node__label",3,"ngClass","dblclick"],[1,"flex","flex-column"],["data-test","treeNodeId","class","text-10 text-uppercase","style","opacity: 0.7;",4,"ngIf"],["data-test","treeNodeLabel"],["data-test","treeNodeId",1,"text-10","text-uppercase",2,"opacity","0.7"],["type","text","appEventFence","","appAutoFocus","","data-test","treeNodeEditLabel",1,"input",3,"value","blur","keyup"],["appEventFence","","type","text","data-test","treeNodeLayerOrder",1,"input","input--small","tree-node__layer-order",3,"value","change"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.cc("keyup.enter",(function(e){return t.handleNodeClick(e,t.node)}))("click",(function(e){return t.handleNodeClick(e,t.node)})),i.Kc(1,Oc,2,2,"div",1),i.Kc(2,kc,6,7,"div",2),i.Kc(3,_c,1,1,"input",3),i.Kc(4,jc,1,1,"input",4),i.hc(5,"async"),i.Vb(6,"div",5),i.cc("click",(function(){return t.toggleVisible(t.node)})),i.Qb(7,"app-icon",6),i.Qb(8,"app-icon",7),i.Ub(),i.Qb(9,"app-node-actions",8),i.Ub()),2&e&&(i.lc("ngClass",i.sc(11,Pc,t.theme===t.treeTheme.Light,t.theme===t.treeTheme.Themed,!t.node.boolState.shown,t.checked,!t.node.boolState.pickable&&t.isLoft)),i.Eb("data-id",t.sanitizedID),i.Db(1),i.lc("ngIf",t.nested&&t.hasChildren),i.Db(1),i.lc("ngIf",!t.editLabelMode),i.Db(1),i.lc("ngIf",t.editLabelMode),i.Db(1),i.lc("ngIf",i.ic(5,9,t.layerOrderMode$)),i.Db(2),i.lc("gaLabel",t.node.boolState.shown?"Hide":"Show"),i.Db(3),i.lc("theme",t.theme)("node",t.node))},directives:[J.a,ms.i,ms.l,J.b,Qa,$a,yc,xc],pipes:[ms.b],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3838}.text-info{color:#0060c4}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}:host{display:block}.tree-node{margin:4px 0;display:flex;align-items:center;height:100%;border-radius:4px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;min-width:200px;transition:background-color .12s}.tree-node--themed{padding-right:12px;border-radius:2px;border-left:var(--tree-node-border)}.tree-node--themed:focus{background:#f1f4fa;outline:none}.tree-node--themed .tree-node__label{color:#131c2a;color:var(--tree-node-color);font-size:13px;letter-spacing:.325px;line-height:1.4em}.tree-node--themed.tree-node--selected{border-left:4px solid #2d72dc;background-color:#f1f5fc;background:var(--tree-node-bg--selected);border-left:var(--tree-node-border--selected)}.tree-node--themed.tree-node--selected .tree-node__actions,.tree-node--themed.tree-node--selected .tree-node__label{color:#131c2a;color:var(--tree-node-color--selected)}.tree-node--themed.tree-node--selected .tree-node__actions,.tree-node--themed.tree-node--selected .tree-node__expand,.tree-node--themed.tree-node--selected .tree-node__visible{background-color:#f1f5fc;color:#131c2a;background-color:var(--tree-node-button-bg--selected);color:var(--tree-node-button-color--selected)}.tree-node--themed.tree-node--unpickable{border:1px dashed #d7e0ea}.tree-node--themed.tree-node--hidden .tree-node__label{color:#96a8c0;color:var(--tree-node-color--hidden)}.tree-node--themed .tree-node__actions,.tree-node--themed .tree-node__expand,.tree-node--themed .tree-node__visible{background-color:transparent;background-color:var(--tree-node-button-bg);color:#96a8c0;color:var(--tree-node-button-color);border-radius:4px}.tree-node--light .tree-node__label{color:#283853;font-weight:400;font-size:14px;line-height:1.33em}.tree-node--light.tree-node--selected .tree-node__actions,.tree-node--light.tree-node--selected .tree-node__expand,.tree-node--light.tree-node--selected .tree-node__label,.tree-node--light.tree-node--selected .tree-node__visible{color:#fff}.tree-node--light.tree-node--unpickable{border:1px dashed #d7e0ea}.tree-node--light.tree-node--hidden .tree-node__label{color:#96a8c0;font-weight:300}.tree-node--light .tree-node__actions,.tree-node--light .tree-node__expand,.tree-node--light .tree-node__visible{color:#6a82a4;border-radius:4px}.tree-node--selected{background-color:#2d72dc}.tree-node--selected .tree-node__label{color:#fff}.tree-node--unpickable{border:1px dashed #6a82a4}.tree-node--hidden .tree-node__actions,.tree-node--hidden .tree-node__expand,.tree-node--hidden .tree-node__label,.tree-node--hidden .tree-node__visible,.tree-node.tree-node--hidden.tree-node--selected .tree-node__actions,.tree-node.tree-node--hidden.tree-node--selected .tree-node__expand,.tree-node.tree-node--hidden.tree-node--selected .tree-node__label,.tree-node.tree-node--hidden.tree-node--selected .tree-node__visible{color:#96a8c0}.tree-node--hidden .tree-node__visible,.tree-node.tree-node--hidden.tree-node--selected .tree-node__visible{visibility:visible}.tree-node__label{font-size:12px;letter-spacing:.3px;line-height:1.4em;letter-spacing:.5px;font-weight:400;line-height:1.3em;color:#d7e0ea;padding:8px 4px 8px 12px;display:flex;align-items:center;flex:1 1 100%;min-height:28px}.tree-node__label--padded{padding-left:32px}.tree-node__expand i{transition:transform .12s}.tree-node__expand--open app-icon{transform:rotate(45deg)}.tree-node .tree-node__expand+.tree-node__label{margin-left:-8px}.tree-node__actions,.tree-node__expand,.tree-node__visible{border-radius:4px;color:#d7e0ea;display:flex;flex:0 0 30px;height:30px;justify-content:center;align-items:center}.tree-node__layer-order{font-size:10px;flex:0 0 56px;min-height:28px;height:28px;padding:4px;margin:2px;text-align:center}.tree-node .tree-node__eye,.tree-node .tree-node__eye-slash{display:none}.tree-node.tree-node--hidden .tree-node__eye-slash,.tree-node:not(.tree-node--hidden) .tree-node__eye{display:inline}@media (hover:hover){.tree-node__actions,.tree-node__visible{visibility:hidden}.tree-node:hover{cursor:pointer}.tree-node:hover .tree-node__actions,.tree-node:hover .tree-node__visible{visibility:visible}.tree-node:hover .tree-node__label{color:#fff}.tree-node--themed:hover{cursor:pointer;background:var(--tree-node-bg--hover)}.tree-node--themed:hover .tree-node__label{color:#131c2a;color:var(--tree-node-color--hover)}.tree-node--themed.tree-node--selected:hover{background-color:#f1f5fc;background-color:var(--tree-node-bg--selected)}.tree-node--themed.tree-node--selected .tree-node__actions:hover,.tree-node--themed.tree-node--selected .tree-node__expand:hover,.tree-node--themed.tree-node--selected .tree-node__visible:hover{background-color:var(--tree-node-button-bg--hover);color:var(--tree-node-button-color--hover)}.tree-node--themed .tree-node__actions:hover,.tree-node--themed .tree-node__expand:hover,.tree-node--themed .tree-node__visible:hover{background-color:transparent;color:inherit;background-color:var(--tree-node-button-bg--hover);color:var(--tree-node-button-color--hover)}.tree-node--light:hover{background:rgba(234,239,245,.5)}.tree-node--light:hover .tree-node__label{color:#131c2a}.tree-node--light.tree-node--selected:hover{background:#2d72dc}.tree-node--light.tree-node--selected .tree-node__actions:hover,.tree-node--light.tree-node--selected .tree-node__expand:hover,.tree-node--light.tree-node--selected .tree-node__visible:hover{color:#f9fafd}.tree-node--light .tree-node__actions:hover,.tree-node--light .tree-node__expand:hover,.tree-node--light .tree-node__visible:hover{background-color:#eaeff5;color:#131c2a}.tree-node__actions:hover,.tree-node__expand:hover,.tree-node__visible:hover{background-color:#1c2a3f;color:#fff;cursor:pointer}.tree-node--selected .tree-node__actions:hover,.tree-node--selected .tree-node__expand:hover,.tree-node--selected .tree-node__visible:hover{background-color:#2d72dc}.tree-node .tree-node__eye,.tree-node .tree-node__eye-slash{display:none}.tree-node.tree-node--hidden .tree-node__eye-slash,.tree-node:hover:not(.tree-node--hidden) .tree-node__eye{display:inline}}"],encapsulation:2,changeDetection:0}),vc([Object(d.d)(ii.getCheckedNodeIds),wc("design:type",q.a)],e.prototype,"checkedNodesIds$",void 0),vc([Object(d.d)(Ba.getLayerOrderMode),wc("design:type",q.a)],e.prototype,"layerOrderMode$",void 0),vc([Object(d.d)(is.getLabelEditNode),wc("design:type",q.a)],e.prototype,"labelEditNode$",void 0),vc([Object(d.d)(Ba.getShowTreeNodeIds),wc("design:type",q.a)],e.prototype,"showTreeNodeIds$",void 0),e})();function Ic(e,t){1&e&&(i.Vb(0,"div",4),i.Mc(1," No results "),i.Ub())}function zc(e,t){if(1&e&&(i.Vb(0,"div",5),i.Qb(1,"app-tree",6),i.Ub()),2&e){const e=i.gc();i.Db(1),i.lc("theme",e.theme)("searchGraph",e.searchGraph)}}function Tc(e,t){if(1&e&&(i.Vb(0,"div"),i.Qb(1,"app-tree-nested-node",9),i.Ub()),2&e){const e=t.$implicit,n=i.gc(2);i.Db(1),i.lc("theme",n.theme)("nested",!1)("node",e)("graph",n.prunedViewGraph)}}function Uc(e,t){if(1&e&&(i.Vb(0,"cdk-virtual-scroll-viewport",7),i.Kc(1,Tc,2,4,"div",8),i.Ub()),2&e){const e=i.gc();i.Hc("height",e.searchHeight,"px"),i.lc("itemSize",64),i.Db(1),i.lc("cdkVirtualForOf",e.searchResults)("cdkVirtualForTrackBy",e.trackTreeNode)}}var Lc=function(e){return e[e.List=0]="List",e[e.Tree=1]="Tree",e}({});let Dc=(()=>{class e{constructor(e,t,n,o,s){this.renderer=e,this.changeDetectorRef=t,this.elementRef=n,this.engineService=o,this.store=s,this._query="",this._displayMode=Lc.List,this.displayModeChange=new i.p,this.theme=ga.Dark,this.treeSearchDisplayMode=Lc,this.searchResults=[],this.searchHeight=0,this.ngUnsubscribe=new $.a}get query(){return this._query}set query(e){this._query=e||"",this.handleQueryChange()}get displayMode(){return this._displayMode}set displayMode(e){null!=e&&(this._displayMode=e,this.handleQueryChange(),this.displayModeChange.emit(this.displayMode))}get viewGraph(){return this._viewGraph}set viewGraph(e){this._viewGraph=e,this.leafNodes=this.engineService.getLeaves(),this.buildPrunedViewGraph(this.displayMode),this.handleQueryChange(),this.changeDetectorRef.markForCheck()}ngOnInit(){}buildPrunedViewGraph(e){const t=this.store.selectSnapshot(Bo.getSelectedChapter),n=this.engineService.createViewGraph(t.showObjects,!0);this.prunedViewGraph=n}ngAfterViewInit(){this.renderer.listen("window","resize",e=>{this.resize()})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}handleQueryChange(){const e=this.search(this._query,this.displayMode===Lc.List?this.prunedViewGraph:this.viewGraph);this.displayMode===Lc.Tree&&(this.searchGraph=function(e,t){return t.reduce((t,n)=>function e(t,n,i){Ye.addNode(t,n);const o=Ye.getAncestor(i,n.id);if(o){const s=t.successors[o]||[];return s.push(n.id),t.successors[o]=Object(X.uniq)(s),t.predecessors[n.id]=o,e(t,Ye.getNode(i,o),i)}return Ye.addRootNode(t,n),t}(t,n,e),{nodes:{},successors:{},predecessors:{},roots:{}})}(this.viewGraph,e)),this.searchResults=e,this.resize()}resize(){this.getSearchHeight().pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.searchHeight=e,this.changeDetectorRef.markForCheck()})}getSearchHeight(){return new q.a(e=>{setTimeout(()=>{const t=this.elementRef.nativeElement.offsetHeight;null!=t&&(e.next(t),e.complete())})})}search(e,t){return void 0===t?[]:(e=Object(ba.remove)(e.toLowerCase()),Object.values(t.nodes).filter(t=>0===e.length||Object(ba.remove)(t.label.toLowerCase()).indexOf(e)>=0).sort((e,t)=>e.label.localeCompare(t.label)))}trackTreeNode(e,t){return t.id}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(i.H),i.Pb(i.i),i.Pb(i.m),i.Pb(lt),i.Pb(d.g))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-tree-search"]],inputs:{query:"query",displayMode:"displayMode",viewGraph:"viewGraph",theme:"theme"},outputs:{displayModeChange:"displayModeChange"},decls:4,vars:3,consts:[[1,"tree-search"],["class","tree-search__empty",4,"ngIf"],["class","pr-3 pv-3",4,"ngIf"],["class","pv-3",3,"itemSize","height",4,"ngIf"],[1,"tree-search__empty"],[1,"pr-3","pv-3"],[1,"tree-search__tree",3,"theme","searchGraph"],[1,"pv-3",3,"itemSize"],[4,"cdkVirtualFor","cdkVirtualForOf","cdkVirtualForTrackBy"],[1,"mr-3",2,"height","64px",3,"theme","nested","node","graph"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Kc(1,Ic,2,0,"div",1),i.Kc(2,zc,2,2,"div",2),i.Kc(3,Uc,2,5,"cdk-virtual-scroll-viewport",3),i.Ub()),2&e&&(i.Db(1),i.lc("ngIf",0===t.searchResults.length),i.Db(1),i.lc("ngIf",t.displayMode===t.treeSearchDisplayMode.Tree),i.Db(1),i.lc("ngIf",t.displayMode===t.treeSearchDisplayMode.List))},directives:[ms.l,ha,ma.e,ma.a,ma.d,Mc],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3838}.text-info{color:#0060c4}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.tree-search{display:flex;flex-direction:column;flex:1 1 auto;height:100%}.tree-search__tree{flex-grow:1;width:100%}.tree-search__empty{font-size:14px;letter-spacing:.35px;line-height:1.4em;padding:12px;font-style:italic;margin-top:12px}.tree-search cdk-virtual-scroll-viewport{flex:1 1 auto}.tree-search cdk-virtual-scroll-viewport .cdk-virtual-scroll-content-wrapper{padding-right:12px}"],encapsulation:2,changeDetection:0}),e})();var Ec=function(e){return e.Play="play",e.Button="button",e.Hand="hand",e}({}),Fc=function(e){return e[e.OnDemand=0]="OnDemand",e[e.Interact=1]="Interact",e[e.Loader=2]="Loader",e[e.Tutorial=3]="Tutorial",e[e.Whiteboard=4]="Whiteboard",e[e.Help=5]="Help",e}({}),Ac=function(e){return e[e.Text=0]="Text",e[e.Paint=1]="Paint",e[e.Erase=2]="Erase",e}({});const Rc=[4,8,12,16,24,32],Nc=e=>e.slice(0).reverse().map(e=>({label:""+e,size:e})),Vc=Nc(Rc),Hc=Nc([8,12,16,20,24,32]),Bc=Nc(Rc),Qc=[...mi.map(e=>{const{label:t,recipe:n}=e,i=Array.isArray(n.tintColor)?n.tintColor:[1,1,1];return{label:t,color:Eo.rgbToHex(i,!0)}}),{label:"White",color:"#ffffff"}],$c=Vc[4],qc=Qc[0],Wc=Hc[3],Kc=Bc[4];var Gc,Zc=function(e){return e.Mouse="mouse",e.Touch="touch",e}({}),Jc=function(e){return e[e.Default=0]="Default",e.DrawerOnly="drawer",e}({}),Xc=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},Yc=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};class el{}const tl={audio:new ca,camera:new ca(oa.Show,!0),chapterList:new ca(oa.Show,!1),column:new ca,description:new ca,drawer:new class extends ca{constructor(e=!1){super(),this.isExpandedInitially=e}},fullscreen:new ca,help:new ca,labels:new ca,labelInfo:new ca,labelList:new ca(oa.Show,!1),loader:new class extends ca{constructor(e=aa){super(),this.template=e}},logo:new class extends ca{constructor(e=!0){super(),this.isHyperLink=e}},media:new class extends ca{constructor(e=sa.Small){super(),this.template=e}},menu:new ca,nodeInfo:new ca(oa.Hide,!1),pagination:new ca,presenter:new ca(oa.Hide,!1),reset:new ca,search:new ca,quiz:new ca,titleOnly:new ca,toolbar:new ca,tools:new ca,anatomyLabels:new ca,tutorial:new ca(oa.Hide,!1),internetExplorerWarning:new ca,legend:new ca,undo:new ca,whiteboard:new ca,visibilityLayers:new ca,contextActions:new ca,toggleLabels:new ca},nl={canFullscreen:!1,canHover:!1,canTouch:!1,drawerCoversContent:!1,fullscreenActive:!1,help:{tab:G.Basics},initialUI:tl,inputEnabled:!0,inputMode:Zc.Mouse,interactType:Ec.Play,onDemand:!1,layout:Jc.Default,labelsBreakpoint:480,menuOpen:!1,multiPickModeEnabled:!1,openWindows:[Fc.Loader],presentationActive:!1,searchDisplayMode:Lc.Tree,showNodeInfo:!1,tutorial:{pageSize:0,pageIndex:-1},tutorialSeen:!0,ui:tl,usePrintImage:!1,whiteboard:{enabled:!1,hasPaint:!1,hasText:!1,brushSize:$c.size,brushColor:qc.color,textSize:Wc.size,eraserSize:Kc.size,annotateMode:Ac.Paint}};let il=(()=>{let e=Gc=class{constructor(e,t){this.storageService=e,this.engineService=t}static getUI(e){return e.ui}static getInitialUI(e){return e.initialUI}static getLabelsBreakpoint(e){return e.labelsBreakpoint}static getInputEnabled(e){return e.inputEnabled}static getFullscreenActive(e){return e.fullscreenActive}static getPresentationActive(e){return e.presentationActive}static getDrawerCoversContent(e){return e.drawerCoversContent}static getShowNodeInfo(e){return e.showNodeInfo}static getInteractType(e){return e.interactType}static getOnDemand(e){return e.onDemand}static getLayout(e){return e.layout}static getInputMode(e){return e.inputMode}static getShowHelpTab(e){return e.help.tab}static getTutorial(e){return e.tutorial}static getTutorialSeen(e){return e.tutorialSeen}static getWhiteboardEnabled(e){return e.whiteboard.enabled}static getWhiteboardBrushSize(e){return e.whiteboard.brushSize}static getWhiteboardTextSize(e){return e.whiteboard.textSize}static getWhiteboardEraserSize(e){return e.whiteboard.eraserSize}static getWhiteboardAnnotateMode(e){return e.whiteboard.annotateMode}static getWhiteboardBrushColor(e){return e.whiteboard.brushColor}static getWhiteboardHasPaint(e){return e.whiteboard.hasPaint}static getWhiteboardHasText(e){return e.whiteboard.hasText}static getCanTouch(e){return e.canTouch}static getCanHover(e){return e.canHover}static getMultiPickModeEnabled(e){return e.multiPickModeEnabled}static getSearchDisplayMode(e){return e.searchDisplayMode}static getUsePrintImage(e){return e.usePrintImage}static getOpenWindow(e){return e.openWindows.length>0?e.openWindows.sort()[0]:null}static getMenuOpen(e){return e.menuOpen}static shouldWindowOpen(e){return Object(d.h)([Gc],t=>t.openWindows.indexOf(e)>=0)}setUI(e,t){const n=e.getState().ui;e.patchState({ui:Object.assign(Object.assign({},n),t.ui)})}setInitialUI(e,t){e.patchState({initialUI:t.ui})}setInputEnabled(e,t){e.patchState({inputEnabled:t.enabled})}setCanHover(e,t){e.patchState({canHover:t.canHover})}setCanTouch(e,t){e.patchState({canTouch:t.canTouch})}setCanFullscreen(e,t){e.patchState({canFullscreen:t.canFullscreen})}setSearchDisplayMode(e,t){e.patchState({searchDisplayMode:t.mode})}toggleNodeInfo(e,t){e.patchState({showNodeInfo:t.show})}togglePresentation(e,t){e.patchState({presentationActive:t.active})}toggleHelp(e,t){e.patchState({help:{tab:t.tab}})}setLoaderType(e,t){e.patchState({interactType:t.interactType})}setOnDemand(e,t){e.patchState({onDemand:t.onDemand})}setInputMode(e,{inputMode:t}){e.patchState({inputMode:t})}SetLayout(e,t){e.patchState({layout:t.layout})}setTutorial(e,t){const n=e.getState().tutorial;e.patchState({tutorial:Object.assign(Object.assign({},n),t.tutorial)})}startTutorial(e,t){e.patchState({tutorial:Object.assign(Object.assign({},e.getState().tutorial),{pageIndex:t.intro?-1:0})}),e.dispatch(new Q.TutorialSeen(!0))}tutorialSeen(e,t){this.storageService.setLocalItem(Dr.GettingStartedTutorial,t.seen),e.patchState({tutorialSeen:t.seen})}tutorialPrevious(e,t){const n=e.getState().tutorial,i=Math.max(n.pageIndex-1,0);e.dispatch(new Q.SetTutorial(Object.assign(Object.assign({},n),{pageIndex:i})))}tutorialNext(e,t){const n=e.getState().tutorial,i=Math.min(n.pageIndex+1,n.pageSize-1);e.dispatch(new Q.SetTutorial(Object.assign(Object.assign({},n),{pageIndex:i})))}setWhiteboardEnabled(e,{enabled:t}){e.patchState({whiteboard:Object.assign(Object.assign({},e.getState().whiteboard),{enabled:t})})}setWhiteboardBrushSize(e,{brushSize:t}){e.patchState({whiteboard:Object.assign(Object.assign({},e.getState().whiteboard),{brushSize:t})})}setWhiteboardTextSize(e,{size:t}){e.patchState({whiteboard:Object.assign(Object.assign({},e.getState().whiteboard),{textSize:t})})}setWhiteboardEraserSize(e,{eraserSize:t}){e.patchState({whiteboard:Object.assign(Object.assign({},e.getState().whiteboard),{eraserSize:t})})}setWhiteboardAnnotateMode(e,{mode:t}){e.patchState({whiteboard:Object.assign(Object.assign({},e.getState().whiteboard),{annotateMode:t})})}setWhiteboardBrushColor(e,{brushColor:t}){e.patchState({whiteboard:Object.assign(Object.assign({},e.getState().whiteboard),{brushColor:t})})}setWhiteboardHasPaint(e,{hasPaint:t}){e.patchState({whiteboard:Object.assign(Object.assign({},e.getState().whiteboard),{hasPaint:t})})}setWhiteboardHasText(e,{hasText:t}){this.engineService.fireEvent(it.NativeDebugMessage,"SetWhiteboardHasText"),e.patchState({whiteboard:Object.assign(Object.assign({},e.getState().whiteboard),{hasText:t})})}setMultiPickModeEnabled(e,t){e.patchState({multiPickModeEnabled:t.enabled})}setLabelBreakpoint(e,t){e.patchState({labelsBreakpoint:t.labelsBreakpoint})}setUsePrintImage(e,t){e.patchState({usePrintImage:t.usePrintImage})}setWindows(e,t){e.patchState({openWindows:t.windows})}openWindow(e,t){const n=e.getState().openWindows;n.indexOf(t.window)<0&&e.patchState({openWindows:[t.window,...n]})}closeWindow(e,t){let n=e.getState().openWindows;null!=t.window?n=n.filter(e=>e!==t.window):n.shift(),e.patchState({openWindows:[...n]})}toggleWindow(e,t){const n=e.getState().openWindows.indexOf(t.window)>=0;e.dispatch((null!=t.show?t.show:!n)?new Q.OpenWindow(t.window):new Q.CloseWindow(t.window))}toggleMenu(e,t){e.patchState({menuOpen:t.open})}ngxsOnInit(e){la.onFullscreenChange().subscribe(t=>{e.patchState({fullscreenActive:la.isFullscreen()})}),e.patchState({tutorialSeen:this.storageService.getLocalJSON(Dr.GettingStartedTutorial)||!1})}};return e.\u0275fac=function(t){return new(t||e)(i.Zb(Ar),i.Zb(lt))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac}),Xc([Object(d.a)(Q.SetUI),Yc("design:type",Function),Yc("design:paramtypes",[Object,Q.SetUI]),Yc("design:returntype",void 0)],e.prototype,"setUI",null),Xc([Object(d.a)(Q.SetInitialUI),Yc("design:type",Function),Yc("design:paramtypes",[Object,Q.SetInitialUI]),Yc("design:returntype",void 0)],e.prototype,"setInitialUI",null),Xc([Object(d.a)(Q.SetInputEnabled),Yc("design:type",Function),Yc("design:paramtypes",[Object,Q.SetInputEnabled]),Yc("design:returntype",void 0)],e.prototype,"setInputEnabled",null),Xc([Object(d.a)(Q.SetCanHover),Yc("design:type",Function),Yc("design:paramtypes",[Object,Q.SetCanHover]),Yc("design:returntype",void 0)],e.prototype,"setCanHover",null),Xc([Object(d.a)(Q.SetCanTouch),Yc("design:type",Function),Yc("design:paramtypes",[Object,Q.SetCanTouch]),Yc("design:returntype",void 0)],e.prototype,"setCanTouch",null),Xc([Object(d.a)(Q.SetCanFullscreen),Yc("design:type",Function),Yc("design:paramtypes",[Object,Q.SetCanFullscreen]),Yc("design:returntype",void 0)],e.prototype,"setCanFullscreen",null),Xc([Object(d.a)(Q.SetSearchDisplayMode),Yc("design:type",Function),Yc("design:paramtypes",[Object,Q.SetSearchDisplayMode]),Yc("design:returntype",void 0)],e.prototype,"setSearchDisplayMode",null),Xc([Object(d.a)(Q.ToggleNodeInfo),Yc("design:type",Function),Yc("design:paramtypes",[Object,Q.ToggleNodeInfo]),Yc("design:returntype",void 0)],e.prototype,"toggleNodeInfo",null),Xc([Object(d.a)(Q.TogglePresentation),Yc("design:type",Function),Yc("design:paramtypes",[Object,Q.TogglePresentation]),Yc("design:returntype",void 0)],e.prototype,"togglePresentation",null),Xc([Object(d.a)(Q.ToggleHelpTab),Yc("design:type",Function),Yc("design:paramtypes",[Object,Q.ToggleHelpTab]),Yc("design:returntype",void 0)],e.prototype,"toggleHelp",null),Xc([Object(d.a)(Q.SetInteractType),Yc("design:type",Function),Yc("design:paramtypes",[Object,Q.SetInteractType]),Yc("design:returntype",void 0)],e.prototype,"setLoaderType",null),Xc([Object(d.a)(Q.SetOnDemand),Yc("design:type",Function),Yc("design:paramtypes",[Object,Q.SetOnDemand]),Yc("design:returntype",void 0)],e.prototype,"setOnDemand",null),Xc([Object(d.a)(Q.SetInputMode),Yc("design:type",Function),Yc("design:paramtypes",[Object,Q.SetInputMode]),Yc("design:returntype",void 0)],e.prototype,"setInputMode",null),Xc([Object(d.a)(Q.SetLayout),Yc("design:type",Function),Yc("design:paramtypes",[Object,Q.SetLayout]),Yc("design:returntype",void 0)],e.prototype,"SetLayout",null),Xc([Object(d.a)(Q.SetTutorial),Yc("design:type",Function),Yc("design:paramtypes",[Object,Q.SetTutorial]),Yc("design:returntype",void 0)],e.prototype,"setTutorial",null),Xc([Object(d.a)(Q.StartTutorial),Yc("design:type",Function),Yc("design:paramtypes",[Object,Q.StartTutorial]),Yc("design:returntype",void 0)],e.prototype,"startTutorial",null),Xc([Object(d.a)(Q.TutorialSeen),Yc("design:type",Function),Yc("design:paramtypes",[Object,Q.TutorialSeen]),Yc("design:returntype",void 0)],e.prototype,"tutorialSeen",null),Xc([Object(d.a)(Q.TutorialPrevious),Yc("design:type",Function),Yc("design:paramtypes",[Object,Q.TutorialPrevious]),Yc("design:returntype",void 0)],e.prototype,"tutorialPrevious",null),Xc([Object(d.a)(Q.TutorialNext),Yc("design:type",Function),Yc("design:paramtypes",[Object,Q.TutorialNext]),Yc("design:returntype",void 0)],e.prototype,"tutorialNext",null),Xc([Object(d.a)(Q.SetWhiteboardEnabled),Yc("design:type",Function),Yc("design:paramtypes",[Object,Q.SetWhiteboardEnabled]),Yc("design:returntype",void 0)],e.prototype,"setWhiteboardEnabled",null),Xc([Object(d.a)(Q.SetWhiteboardBrushSize),Yc("design:type",Function),Yc("design:paramtypes",[Object,Q.SetWhiteboardBrushSize]),Yc("design:returntype",void 0)],e.prototype,"setWhiteboardBrushSize",null),Xc([Object(d.a)(Q.SetWhiteboardTextSize),Yc("design:type",Function),Yc("design:paramtypes",[Object,Q.SetWhiteboardTextSize]),Yc("design:returntype",void 0)],e.prototype,"setWhiteboardTextSize",null),Xc([Object(d.a)(Q.SetWhiteboardEraserSize),Yc("design:type",Function),Yc("design:paramtypes",[Object,Q.SetWhiteboardEraserSize]),Yc("design:returntype",void 0)],e.prototype,"setWhiteboardEraserSize",null),Xc([Object(d.a)(Q.SetWhiteboardAnnotateMode),Yc("design:type",Function),Yc("design:paramtypes",[Object,Q.SetWhiteboardAnnotateMode]),Yc("design:returntype",void 0)],e.prototype,"setWhiteboardAnnotateMode",null),Xc([Object(d.a)(Q.SetWhiteboardBrushColor),Yc("design:type",Function),Yc("design:paramtypes",[Object,Q.SetWhiteboardBrushColor]),Yc("design:returntype",void 0)],e.prototype,"setWhiteboardBrushColor",null),Xc([Object(d.a)(Q.SetWhiteboardHasPaint),Yc("design:type",Function),Yc("design:paramtypes",[Object,Q.SetWhiteboardHasPaint]),Yc("design:returntype",void 0)],e.prototype,"setWhiteboardHasPaint",null),Xc([Object(d.a)(Q.SetWhiteboardHasText),Yc("design:type",Function),Yc("design:paramtypes",[Object,Q.SetWhiteboardHasText]),Yc("design:returntype",void 0)],e.prototype,"setWhiteboardHasText",null),Xc([Object(d.a)(Q.SetMultiPickModeEnabled),Yc("design:type",Function),Yc("design:paramtypes",[Object,Q.SetMultiPickModeEnabled]),Yc("design:returntype",void 0)],e.prototype,"setMultiPickModeEnabled",null),Xc([Object(d.a)(Q.SetLabelBreakpoint),Yc("design:type",Function),Yc("design:paramtypes",[Object,Q.SetLabelBreakpoint]),Yc("design:returntype",void 0)],e.prototype,"setLabelBreakpoint",null),Xc([Object(d.a)(Q.SetUsePrintImage),Yc("design:type",Function),Yc("design:paramtypes",[Object,Q.SetUsePrintImage]),Yc("design:returntype",void 0)],e.prototype,"setUsePrintImage",null),Xc([Object(d.a)(Q.SetWindows),Yc("design:type",Function),Yc("design:paramtypes",[Object,Q.SetWindows]),Yc("design:returntype",void 0)],e.prototype,"setWindows",null),Xc([Object(d.a)(Q.OpenWindow),Yc("design:type",Function),Yc("design:paramtypes",[Object,Q.OpenWindow]),Yc("design:returntype",void 0)],e.prototype,"openWindow",null),Xc([Object(d.a)(Q.CloseWindow),Yc("design:type",Function),Yc("design:paramtypes",[Object,Q.CloseWindow]),Yc("design:returntype",void 0)],e.prototype,"closeWindow",null),Xc([Object(d.a)(Q.ToggleWindow),Yc("design:type",Function),Yc("design:paramtypes",[Object,Q.ToggleWindow]),Yc("design:returntype",void 0)],e.prototype,"toggleWindow",null),Xc([Object(d.a)(Q.ToggleMenu),Yc("design:type",Function),Yc("design:paramtypes",[Object,Q.ToggleMenu]),Yc("design:returntype",void 0)],e.prototype,"toggleMenu",null),Xc([Object(d.e)(),Yc("design:type",Function),Yc("design:paramtypes",[el]),Yc("design:returntype",void 0)],e,"getUI",null),Xc([Object(d.e)(),Yc("design:type",Function),Yc("design:paramtypes",[el]),Yc("design:returntype",void 0)],e,"getInitialUI",null),Xc([Object(d.e)(),Yc("design:type",Function),Yc("design:paramtypes",[el]),Yc("design:returntype",void 0)],e,"getLabelsBreakpoint",null),Xc([Object(d.e)(),Yc("design:type",Function),Yc("design:paramtypes",[el]),Yc("design:returntype",void 0)],e,"getInputEnabled",null),Xc([Object(d.e)(),Yc("design:type",Function),Yc("design:paramtypes",[el]),Yc("design:returntype",void 0)],e,"getFullscreenActive",null),Xc([Object(d.e)(),Yc("design:type",Function),Yc("design:paramtypes",[el]),Yc("design:returntype",void 0)],e,"getPresentationActive",null),Xc([Object(d.e)(),Yc("design:type",Function),Yc("design:paramtypes",[el]),Yc("design:returntype",void 0)],e,"getDrawerCoversContent",null),Xc([Object(d.e)(),Yc("design:type",Function),Yc("design:paramtypes",[el]),Yc("design:returntype",void 0)],e,"getShowNodeInfo",null),Xc([Object(d.e)(),Yc("design:type",Function),Yc("design:paramtypes",[el]),Yc("design:returntype",void 0)],e,"getInteractType",null),Xc([Object(d.e)(),Yc("design:type",Function),Yc("design:paramtypes",[el]),Yc("design:returntype",void 0)],e,"getOnDemand",null),Xc([Object(d.e)(),Yc("design:type",Function),Yc("design:paramtypes",[el]),Yc("design:returntype",void 0)],e,"getLayout",null),Xc([Object(d.e)(),Yc("design:type",Function),Yc("design:paramtypes",[el]),Yc("design:returntype",void 0)],e,"getInputMode",null),Xc([Object(d.e)(),Yc("design:type",Function),Yc("design:paramtypes",[el]),Yc("design:returntype",void 0)],e,"getShowHelpTab",null),Xc([Object(d.e)(),Yc("design:type",Function),Yc("design:paramtypes",[el]),Yc("design:returntype",void 0)],e,"getTutorial",null),Xc([Object(d.e)(),Yc("design:type",Function),Yc("design:paramtypes",[el]),Yc("design:returntype",void 0)],e,"getTutorialSeen",null),Xc([Object(d.e)(),Yc("design:type",Function),Yc("design:paramtypes",[el]),Yc("design:returntype",void 0)],e,"getWhiteboardEnabled",null),Xc([Object(d.e)(),Yc("design:type",Function),Yc("design:paramtypes",[el]),Yc("design:returntype",void 0)],e,"getWhiteboardBrushSize",null),Xc([Object(d.e)(),Yc("design:type",Function),Yc("design:paramtypes",[el]),Yc("design:returntype",void 0)],e,"getWhiteboardTextSize",null),Xc([Object(d.e)(),Yc("design:type",Function),Yc("design:paramtypes",[el]),Yc("design:returntype",void 0)],e,"getWhiteboardEraserSize",null),Xc([Object(d.e)(),Yc("design:type",Function),Yc("design:paramtypes",[el]),Yc("design:returntype",void 0)],e,"getWhiteboardAnnotateMode",null),Xc([Object(d.e)(),Yc("design:type",Function),Yc("design:paramtypes",[el]),Yc("design:returntype",void 0)],e,"getWhiteboardBrushColor",null),Xc([Object(d.e)(),Yc("design:type",Function),Yc("design:paramtypes",[el]),Yc("design:returntype",void 0)],e,"getWhiteboardHasPaint",null),Xc([Object(d.e)(),Yc("design:type",Function),Yc("design:paramtypes",[el]),Yc("design:returntype",void 0)],e,"getWhiteboardHasText",null),Xc([Object(d.e)(),Yc("design:type",Function),Yc("design:paramtypes",[el]),Yc("design:returntype",void 0)],e,"getCanTouch",null),Xc([Object(d.e)(),Yc("design:type",Function),Yc("design:paramtypes",[el]),Yc("design:returntype",void 0)],e,"getCanHover",null),Xc([Object(d.e)(),Yc("design:type",Function),Yc("design:paramtypes",[el]),Yc("design:returntype",void 0)],e,"getMultiPickModeEnabled",null),Xc([Object(d.e)(),Yc("design:type",Function),Yc("design:paramtypes",[el]),Yc("design:returntype",void 0)],e,"getSearchDisplayMode",null),Xc([Object(d.e)(),Yc("design:type",Function),Yc("design:paramtypes",[el]),Yc("design:returntype",void 0)],e,"getUsePrintImage",null),Xc([Object(d.e)(),Yc("design:type",Function),Yc("design:paramtypes",[el]),Yc("design:returntype",void 0)],e,"getOpenWindow",null),Xc([Object(d.e)(),Yc("design:type",Function),Yc("design:paramtypes",[el]),Yc("design:returntype",void 0)],e,"getMenuOpen",null),e=Gc=Xc([Object(d.f)({name:"view",defaults:nl})],e),e})();var ol=n("R0Ic"),sl=n("IzEk"),rl=function(e){return e[e.Content=0]="Content",e[e.Label=1]="Label",e[e.Tools=2]="Tools",e[e.Search=3]="Search",e[e.Help=4]="Help",e[e.NodeInfo=5]="NodeInfo",e[e.LabelInfo=6]="LabelInfo",e}({});const al=["ui-bd.class","ui-play-pause","ui-camera-mode","ui-center","ui-cross-section","ui-dissect","ui-fs","ui-tools-display","ui-tree","ui-zoom","ui-zoom-in","ui-zoom-out","ui-pan","ui-share","ui-keys","ui-slider","o","background.color-stops","background.gradient-type","dd","dn","image-display","imageDisplay","imageSrc","pre","referrer"];function cl(e){const{id:t,s:n,m:i,be:o,b:s}=e;let r="";if(t)r=t;else if(o)r=o;else if(s){const e=parseInt(s,10);r=Number.isNaN(e)?"":function(e){const t=[];let n,i=e;for(;i>0;)[i,n]=(o=i,62,[Math.floor(o/62),o%62]),t.unshift("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz"[n]);var o;return t.join("")}(e)}else i&&(r=function(e,t="male"){return e.includes("/")?e:`production/${t}Adult/${e}`}(i,"female"===n?"female":"male"));return r.replace(/\.json$/,"")}function ll(e){return cl(e).includes("/")?"module":"bookmark"}const pl={type:e=>ll(e),id:e=>cl(e),background:e=>e.bgstd||e["background.colors"]||e.background};function dl(e){if(3===e.length){const{0:t,1:n,2:i}=e;return{x:t,y:n,z:i}}return null}const ul={camera:function(e){const t=e.split(",").map(e=>parseFloat(e));if(t.length%3==0&&!t.some(e=>Number.isNaN(e))){const e=t.slice(0,3),n=t.slice(3,6),i=t.slice(6,9);return{eye:dl(e),look:dl(n),up:dl(i)}}return null},background:function(e){const t=Eo.getColors(e);if(t){const e=[...t[0][255],...t[1][255]];return new Pn(e,"radial",[0,100])}return null}};function gl(e){const t=function(e){const t=Object.keys(e),n=t.filter(e=>al.includes(e));if(n.length>0){const e=[`The following URL parameters have been deprecated: "${n.join('", "')}"`,"Please contact support@biodigital.com for more information."];console.warn(e.join("\n"))}return t.reduce((e,t)=>(al.includes(t)&&delete e[t],e),e)}(e);var n;return function(e){const t=e=>{if(e){const t=e.toLowerCase();if("true"===t)return!0;if("false"===t)return!1;if(!isNaN(Number(t)))return Number(t)}return e};return Object.keys(e).reduce((n,i)=>{const o=(ul[i]||t)(e[i]);return"load-rotate"===i&&isNaN(Number(o))||(n[i]=o),n},{})}((n=t,Object.keys(pl).filter(e=>void 0===n[e]).reduce((e,t)=>{const i=(0,pl[t])(n);return void 0!==i&&(e[t]=i),e},n)))}let hl=(()=>{class e{constructor(e){this.store=e}chapterHasTransition(e,t){const n=t?"transitions.pre":"transitions.post",i=Object(X.get)(e,n);return!!i&&(t?i.onPrevious:i.onNext)}searchChapterTransitions(e,t,n){let i=[...n],o=i.findIndex(t=>t.id===e),s=i.findIndex(e=>e.id===t);const r=s<o;if(r&&(i=i.reverse(),o=i.findIndex(t=>t.id===e),s=i.findIndex(e=>e.id===t)),o<0||s<0||o===s)return null;const a=i.slice(o,s).find(e=>this.chapterHasTransition(e,r));return a?r?a.transitions.pre:a.transitions.post:null}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(d.g))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var bl,ml=function(e){return e.JumpTo="jumpTo",e.FlyTo="flyTo",e}({});!function(e){class t{constructor(e){this.breakpoint=e}}t.type="[View] Set Breakpoint",e.SetBreakpoint=t}(bl||(bl={}));var fl=function(e){return e[e.XSmall=0]="XSmall",e[e.Small=1]="Small",e[e.Medium=2]="Medium",e[e.Large=3]="Large",e[e.XLarge=4]="XLarge",e}({}),yl=n("0MNC"),xl=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},vl=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};class wl{}let Ol=(()=>{let e=class{constructor(e,t){this.breakpointObserver=e,this.store=t}static getBreakpoint(e){return e.breakpoint}static getBreakpointLabel(e){return["(max-width: 374px)","(max-width: 599px)","(max-width: 959px)","(max-width: 1439px)","(min-width: 1440px)"][e.breakpoint]}setBreakpoint(e,t){e.patchState({breakpoint:t.breakpoint})}ngxsOnInit(e){const t=this.breakpointObserver.observe(["(max-width: 374px)"]),n=this.breakpointObserver.observe(["(max-width: 599px)"]),i=this.breakpointObserver.observe(["(max-width: 959px)"]),o=this.breakpointObserver.observe(["(max-width: 1439px)"]),s=this.breakpointObserver.observe(["(min-width: 1440px)"]);Object(rs.b)(t,n,i,o,s).pipe(Object(k.a)(([e,t,n,i,o])=>e.matches?fl.XSmall:t.matches?fl.Small:n.matches?fl.Medium:i.matches?fl.Large:o.matches?fl.XLarge:null),Object(ls.a)(),Object(K.a)(e=>null!=e)).subscribe(t=>{e.dispatch(new bl.SetBreakpoint(t))})}};return e.\u0275fac=function(t){return new(t||e)(i.Zb(yl.a),i.Zb(d.g))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac}),xl([Object(d.a)(bl.SetBreakpoint),vl("design:type",Function),vl("design:paramtypes",[Object,bl.SetBreakpoint]),vl("design:returntype",void 0)],e.prototype,"setBreakpoint",null),xl([Object(d.e)(),vl("design:type",Function),vl("design:paramtypes",[wl]),vl("design:returntype",void 0)],e,"getBreakpoint",null),xl([Object(d.e)(),vl("design:type",Function),vl("design:paramtypes",[wl]),vl("design:returntype",void 0)],e,"getBreakpointLabel",null),e=xl([Object(d.f)({name:"breakpoint",defaults:{breakpoint:null}})],e),e})();var Cl=function(e){return e.Column="column",e.ColumnToggle="column-toggle",e.Drawer="drawer",e.TitleOnly="title-only",e.Tools="tools",e.Toolbar="toolbar",e.Camera="camera",e.Media="media",e.Mediabar="mediabar",e.Reset="reset",e.Audio="audio",e.Menu="menu",e.Pagination="pagination",e.Fullscreen="fullscreen",e.Help="help",e.Description="description",e.NodeInfo="nodeInfo",e.Search="search",e.Presenter="presenter",e.Logo="logo",e.LabelList="labelList",e.ChapterList="chapterList",e.AnatomyLabels="anatomyLabels",e.Labels="labels",e.Tutorial="tutorial",e.InternetExplorerWarning="internetExplorerWarning",e.Layout="layout",e.Legend="legend",e.Loader="loader",e.Undo="undo",e.Whiteboard="whiteboard",e.VisibilityLayers="visibilityLayers",e.ContextActions="contextActions",e.ToggleLabels="toggleLabels",e}({}),Sl=function(e){return e.Drawer="drawer",e.Column="column",e}({}),kl=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},_l=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const jl={storyLoadProgress:0,chunkLoadProgress:0};let Pl=(()=>{let e=class{constructor(){}static getStoryLoadProgress(e){return e.storyLoadProgress}static getChunkLoadProgress(e){return e.chunkLoadProgress}setProgress(e,t){e.patchState({storyLoadProgress:t.storyLoadProgress,chunkLoadProgress:t.chunkLoadProgress})}resetProgress(e,t){e.setState(Object.assign({},jl))}};return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac}),kl([Object(d.a)($r),_l("design:type",Function),_l("design:paramtypes",[Object,$r]),_l("design:returntype",void 0)],e.prototype,"setProgress",null),kl([Object(d.a)(qr),_l("design:type",Function),_l("design:paramtypes",[Object,qr]),_l("design:returntype",void 0)],e.prototype,"resetProgress",null),kl([Object(d.e)(),_l("design:type",Function),_l("design:paramtypes",[Object]),_l("design:returntype",void 0)],e,"getStoryLoadProgress",null),kl([Object(d.e)(),_l("design:type",Function),_l("design:paramtypes",[Object]),_l("design:returntype",void 0)],e,"getChunkLoadProgress",null),e=kl([Object(d.f)({name:"engineProgress",defaults:jl})],e),e})(),Ml=(()=>{class e{constructor(e,t){this.store=e,this.chapterService=t,this.ui=null,this.breakpoint=null}getBase(){return{ui:this.store.selectSnapshot(il.getUI),layout:this.store.selectSnapshot(il.getLayout),breakpoint:this.store.selectSnapshot(Ol.getBreakpoint),hideUI:this.isUIHidden()}}isUIHidden(){const e=this.store.selectSnapshot(il.getOpenWindow),t=this.store.selectSnapshot(Bo.getSelectedChapterIndex),n=this.store.selectSnapshot(il.getUI),i=e===Fc.Loader&&t<=0&&n.loader.template===ra.Circle,o=this.store.selectSnapshot(Pl.getStoryLoadProgress);return i||0===o||e===Fc.OnDemand||e===Fc.Interact||e===Fc.Tutorial||e===Fc.Whiteboard}isDrawerVisible(){const{hideUI:e,ui:t,layout:n}=this.getBase();return!e&&(n===Jc.DrawerOnly||this.getLayoutFromWindowSize()===Sl.Drawer)&&(t.drawer.enable&&"none"!==this.getVisibleContent()||t.nodeInfo.status===oa.Show||t.labelInfo.status===oa.Show)}isColumnVisible(){const{hideUI:e,layout:t,ui:n}=this.getBase();return!e&&t!==Jc.DrawerOnly&&n.column.status!==oa.Collapse&&this.getLayoutFromWindowSize()===Sl.Column&&n.column.enable&&"full"===this.getVisibleContent()}isColumnToggleVisible(){const{hideUI:e,layout:t,ui:n}=this.getBase();if(e)return!1;if(this.store.selectSnapshot(Bi.getQuizModeActive))return!1;switch(t){case Jc.Default:if(this.getLayoutFromWindowSize()!==Sl.Column)return!1;break;case Jc.DrawerOnly:return!1}return n.column.enable&&"full"===this.getVisibleContent()}isTitleOnlyVisible(){const{hideUI:e,ui:t,breakpoint:n}=this.getBase();return!e&&!(n<fl.Large)&&t.titleOnly.enable&&"titleOnly"===this.getVisibleContent()}isToolsVisible(){const{hideUI:e}=this.getBase();return!e&&this.isUIVisible(Cl.Tools)}isToolbarVisible(){const{hideUI:e,ui:t}=this.getBase();return!e&&t.toolbar.enable}isLogoVisible(){const{ui:e}=this.getBase();return this.store.selectSnapshot(il.getOpenWindow)!==Fc.OnDemand&&e.logo.enable}isCameraVisible(){const{hideUI:e,ui:t}=this.getBase();return!e&&t.camera.enable}isPaginationVisible(){const{hideUI:e,ui:t}=this.getBase();return!e&&!(this.store.selectSnapshot(Bo.getChapterCount)<=1)&&t.pagination.enable}isMediaVisible(){const{hideUI:e,ui:t}=this.getBase();return!e&&this.store.selectSnapshot(Bo.getIsChapterAnimated)&&t.media.enable}isMediabarVisible(){const{hideUI:e}=this.getBase();if(e)return!1;const t=this.isMediaVisible(),n=this.isAudioVisible();return t||n}isMenuVisible(){const{hideUI:e,ui:t}=this.getBase();return!e&&(t.fullscreen.enable||t.help.enable||t.search.enable||t.tools.enable||t.whiteboard.enable||t.tutorial.enable)&&t.menu.enable}isNodeInfoColumnVisible(){const{hideUI:e,ui:t,breakpoint:n}=this.getBase();return!e&&(!!(n>=fl.Large&&this.isUIVisible(Cl.NodeInfo))||(n<fl.Large?!t.drawer.enable&&this.isUIVisible(Cl.NodeInfo):void 0))}isNodeInfoVisible(e){const{hideUI:t,breakpoint:n}=this.getBase();return!t&&(n>=fl.Large&&e===Sl.Column||n<fl.Large&&e===Sl.Drawer)&&this.isUIVisible(Cl.NodeInfo)}isAudioVisible(){const{ui:e}=this.getBase(),t=null!=this.store.selectSnapshot(Bo.getSelectedChapterAudio);return e.audio.enable&&t}isSearchColumnVisible(){const{hideUI:e}=this.getBase();return!e&&this.isUIVisible(Cl.Search)}isUndoVisible(){const{hideUI:e,ui:t}=this.getBase();return!e&&t.undo.enable}isVisibilityLayersVisible(){const{hideUI:e,ui:t}=this.getBase();if(e)return!1;const n=t.visibilityLayers.enable,i=this.store.selectSnapshot(Bo.getSelectedChapterCurrentLayers);return n&&this.chapterService.hasVisibilityLayers(i)}isVisible(e){switch(e){case Cl.Audio:return this.isAudioVisible();case Cl.Camera:return this.isCameraVisible();case Cl.Column:return this.isColumnVisible();case Cl.ColumnToggle:return this.isColumnToggleVisible();case Cl.Drawer:return this.isDrawerVisible();case Cl.Logo:return this.isLogoVisible();case Cl.Media:return this.isMediaVisible();case Cl.Mediabar:return this.isMediabarVisible();case Cl.Menu:return this.isMenuVisible();case Cl.Pagination:return this.isPaginationVisible();case Cl.Search:return this.isSearchColumnVisible();case Cl.TitleOnly:return this.isTitleOnlyVisible();case Cl.Tools:return this.isToolsVisible();case Cl.Toolbar:return this.isToolbarVisible();case Cl.Undo:return this.isUndoVisible();case Cl.VisibilityLayers:return this.isVisibilityLayersVisible();default:return this.isUIVisible(e)}}isUIVisible(e){const{hideUI:t,ui:n}=this.getBase();return n[e]?!t&&n[e].enable&&n[e].status!==oa.Hide:(console.warn("Attempting to check visibility of a non-existent element: ${element}"),!1)}isUIEnabled(e){const{ui:t}=this.getBase();return t[e].enable}getVisibleContent(){const{ui:e}=this.getBase(),t=this.store.selectSnapshot(Tr.getChapterLabels),n=this.store.selectSnapshot(Bo.getSelectedChapter),i=Object(X.get)(n,"info.description"),o=Object(X.get)(n,"info.displayName"),s=Object(X.get)(n,"legend",[]),r=Object(X.get)(n,"contentBlocks",[]).length,a=e.labelList.enable&&t.length>0,c=null!=i&&Object(X.trim)(i).length>0,l=null!=o&&Object(X.trim)(o).length>0,p=e.legend.enable&&s.length>0,d=this.store.selectSnapshot(Bi.getQuizModeActive);return a||c||p||d||r?"full":l?"titleOnly":"none"}getLayoutFromWindowSize(){const{width:e,height:t}=document.body.getBoundingClientRect(),n=e/t>=1?"landscape":"portrait",{breakpoint:i}=this.getBase();return"portrait"===n?Sl.Drawer:i>=fl.Large||t<=384+(c.application===o.Viewer?0:56)&&e>=708?Sl.Column:Sl.Drawer}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(d.g),i.Zb(Zi))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),Il=(()=>{class e{constructor(e){this.query=e}}return e.type="[Bookmarks] Load",e})(),zl=(()=>{class e{constructor(e){this.organizationId=e}}return e.type="[Bookmarks] Load Organization Bookmarks",e})(),Tl=(()=>{class e{constructor(e,t){this.organizationId=e,this.collectionId=t}}return e.type="[Bookmarks] Load Collection Bookmarks",e})(),Ul=(()=>{class e{constructor(e,t){this.id=e,this.type=t}}return e.type="[Bookmarks] Select Bookmark",e})(),Ll=(()=>{class e{constructor(e){this.bookmark=e}}return e.type="[Bookmarks] Select Bookmark Success",e})(),Dl=(()=>{class e{constructor(e){this.result=e}}return e.type="[Bookmarks] Load Success",e})(),El=(()=>{class e{constructor(e){this.bookmarkId=e}}return e.type="[Bookmarks] Delete Bookmark",e})(),Fl=(()=>{class e{constructor(e){this.bookmarkId=e}}return e.type="[Bookmarks] Bookmark Delete Success",e})(),Al=(()=>{class e{constructor(e,t){this.bookmarkId=e,this.message=t}}return e.type="[Bookmarks] Bookmark Delete Fail",e})(),Rl=(()=>{class e{constructor(e,t,n=!0){this.bookmarkEntry=e,this.inplace=t,this.includeIndex=n}}return e.type="[Bookmarks] Save Bookmark",e})(),Nl=(()=>{class e{constructor(e,t,n){this.bookmark=e,this.story=t,this.method=n}}return e.type="[Bookmarks] Bookmark Saved",e})(),Vl=(()=>{class e{constructor(e){this.bookmarkEntry=e}}return e.type="[Bookmarks] Bookmark Save Failed",e})(),Hl=(()=>{class e{constructor(){}}return e.type="[Bookmarks] Cancel Save Bookmark",e})(),Bl=(()=>{class e{constructor(e){this.bookmark=e}}return e.type="[Bookmarks] Delete Favorite",e})(),Ql=(()=>{class e{constructor(e){this.bookmarkId=e}}return e.type="[Bookmarks] Delete Favorite Success",e})(),$l=(()=>{class e{constructor(e){this.bookmarkId=e}}return e.type="[Bookmarks] Delete Favorite Failed",e})(),ql=(()=>{class e{constructor(e,t,n,i,o){this.method=e,this.bookmarkId=t,this.bookmarkEntry=n,this.thumbnails=i,this.chapterIdMap=o}}return e.type="[Bookmarks] Save Bookmark Thumbnails",e})(),Wl=(()=>{class e{constructor(){}}return e.type="[Bookmarks] Reset",e})(),Kl=(()=>{class e{constructor(){}}return e.type="[Bookmarks] Clear Bookmarks",e})(),Gl=(()=>{class e{constructor(e){this.sort=e}}return e.type="[Bookmarks] Sort",e})(),Zl=(()=>{class e{constructor(e,t){this.id=e,this.checked=t}}return e.type="[Bookmarks] Check Bookmark",e})(),Jl=(()=>{class e{constructor(e){this.ids=e}}return e.type="[Bookmarks] Set Checked Bookmarks",e})(),Xl=(()=>{class e{constructor(e,t,n,i,o,s){this.bookmarks=e,this.widgetURL=t,this.userLanguage=n,this.userApp=i,this.widgetOptions=o,this.offlineEnabled=s}}return e.type="[Bookmarks] Export Bookmarks",e})(),Yl=(()=>{class e{constructor(e){this.bookmarks=e}}return e.type="[Bookmarks] Export Bookmarks Success",e})(),ep=(()=>{class e{constructor(e){this.bookmarks=e}}return e.type="[Bookmarks] Export Bookmarks Error",e})(),tp=(()=>{class e{constructor(e,t,n){this.bookmark=e,this.addCollection=t,this.removeCollection=n}}return e.type="[Bookmarks] Update Bookmark Collection",e})(),np=(()=>{class e{constructor(e,t,n){this.bookmark=e,this.addCollection=t,this.removeCollection=n}}return e.type="[Bookmarks] Update Bookmark Collection Success",e})(),ip=(()=>{class e{constructor(e,t,n){this.bookmark=e,this.addCollection=t,this.removeCollection=n}}return e.type="[Bookmarks] Update Bookmark Collection Error",e})(),op=(()=>{class e{constructor(e,t){this.bookmark=e,this.collection=t}}return e.type="[Bookmarks] Add Bookmark Collection Success",e})(),sp=(()=>{class e{constructor(e,t){this.bookmark=e,this.collection=t}}return e.type="[Bookmarks] Add Bookmark Collection Error",e})(),rp=(()=>{class e{constructor(e,t){this.bookmark=e,this.collection=t}}return e.type="[Bookmarks] Remove Bookmark Collection Success",e})(),ap=(()=>{class e{constructor(e,t){this.bookmark=e,this.collection=t}}return e.type="[Bookmarks] Remove Bookmark Collection Error",e})(),cp=(()=>{class e{constructor(e,t,n,i=Is.lang,o,s){this.id=e,this.title=t,this.type=n,this.lang=i,this.groupAccess=o,this.collection=s}}return e.type="[Bookmarks] Copy Bookmark",e})(),lp=(()=>{class e{constructor(e,t,n){this.newId=e,this.sourceId=t,this.newBookmark=n}}return e.type="[Bookmarks] Copy Bookmark Success",e})(),pp=(()=>{class e{constructor(e,t){this.id=e,this.error=t}}return e.type="[Bookmarks] Copy Bookmark Failure",e})(),dp=(()=>{class e{constructor(){}}return e.type="[Bookmarks] Cancel Copy Bookmark",e})(),up=(()=>{class e{constructor(e){this.title=e}}return e.type="[Bookmarks] Set Bookmark Text",e})(),gp=(()=>{class e{constructor(e){this.category=e}}return e.type="[Bookmarks] Set Selected Category",e})();var hp;!function(e){class t{constructor(e){this.theme=e}}t.type="[Layout] Set Theme",e.SetTheme=t;class n{constructor(e){this.sidenav=e}}n.type="[Layout] Set Sidenav",e.SetSidenav=n;class i{constructor(e){this.open=e}}i.type="[Layout] Toggle Sidenav",e.ToggleSidenav=i;class o{constructor(e){this.siteHeaderType=e}}o.type="[Layout] Set Header",e.SetHeader=o;class s{constructor(){}}s.type="[Layout] Reset",e.ResetLayout=s}(hp||(hp={}));class bp{}var mp=function(e){return e.Light="theme-light",e.Dark="theme-dark",e}({}),fp=function(e){return e[e.Application=0]="Application",e[e.Search=1]="Search",e[e.View=2]="View",e[e.Hide=3]="Hide",e}({}),yp=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},xp=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const vp={theme:mp.Light,sidenav:{enabled:!0,open:!1},siteHeader:fp.Application};let wp=(()=>{let e=class{static getTheme(e){return e.theme}static getSidenav(e){return e.sidenav}static getSiteHeader(e){return e.siteHeader}setTheme({patchState:e},{theme:t}){e({theme:t})}setHeader(e,t){e.patchState({siteHeader:t.siteHeaderType})}setSidenav(e,t){e.patchState({sidenav:Object.assign({},t.sidenav)})}toggleSidenav(e,t){const n=e.getState().sidenav;e.patchState({sidenav:Object.assign(Object.assign({},n),{open:t.open})})}resetLayout(e,t){e.setState(vp)}};return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac}),yp([Object(d.a)(hp.SetTheme),xp("design:type",Function),xp("design:paramtypes",[Object,hp.SetTheme]),xp("design:returntype",void 0)],e.prototype,"setTheme",null),yp([Object(d.a)(hp.SetHeader),xp("design:type",Function),xp("design:paramtypes",[Object,hp.SetHeader]),xp("design:returntype",void 0)],e.prototype,"setHeader",null),yp([Object(d.a)(hp.SetSidenav),xp("design:type",Function),xp("design:paramtypes",[Object,hp.SetSidenav]),xp("design:returntype",void 0)],e.prototype,"setSidenav",null),yp([Object(d.a)(hp.ToggleSidenav),xp("design:type",Function),xp("design:paramtypes",[Object,hp.ToggleSidenav]),xp("design:returntype",void 0)],e.prototype,"toggleSidenav",null),yp([Object(d.a)(hp.ResetLayout),xp("design:type",Function),xp("design:paramtypes",[Object,hp.ResetLayout]),xp("design:returntype",void 0)],e.prototype,"resetLayout",null),yp([Object(d.e)(),xp("design:type",Function),xp("design:paramtypes",[bp]),xp("design:returntype",void 0)],e,"getTheme",null),yp([Object(d.e)(),xp("design:type",Function),xp("design:paramtypes",[bp]),xp("design:returntype",void 0)],e,"getSidenav",null),yp([Object(d.e)(),xp("design:type",Function),xp("design:paramtypes",[bp]),xp("design:returntype",void 0)],e,"getSiteHeader",null),e=yp([Object(d.f)({name:"layout",defaults:vp})],e),e})();const Op=nl.ui;class Cp{}const Sp=(e,t)=>void 0===e?t:e;function kp(...e){return!!e.some(e=>!0===e)||!e.some(e=>!1===e)&&void 0}function _p(e,t,n){return Object.values(sa).indexOf(n)>=0?n:!1===e?sa.None:null!=t?t?sa.Full:sa.Small:null}function jp(e){return Object.values(ra).includes(e)?e:null}var Pp;!function(e){function t(e){return{[Cl.Loader]:e?aa:ra.None,[Cl.Column]:e,[Cl.Drawer]:e,[Cl.Tools]:e,[Cl.Toolbar]:e,[Cl.Fullscreen]:e,[Cl.Help]:e,[Cl.Camera]:e,[Cl.Search]:e,[Cl.Presenter]:e,[Cl.Menu]:e,[Cl.Audio]:e,[Cl.Pagination]:e,[Cl.NodeInfo]:e,[Cl.Labels]:null,[Cl.LabelList]:e,[Cl.ChapterList]:e,[Cl.Media]:null,[Cl.TitleOnly]:e,[Cl.Undo]:e,all:e,drawerExpandedInitially:null,logoIsHyperLink:null,[Cl.AnatomyLabels]:null,[Cl.Logo]:!0,[Cl.Tutorial]:null,[Cl.InternetExplorerWarning]:!0,[Cl.Legend]:!0,[Cl.Whiteboard]:e,[Cl.VisibilityLayers]:e,[Cl.ContextActions]:e,[Cl.ToggleLabels]:!0}}function n(e,t,n=!1){return null==t?e:Object(X.uniq)([...Object.keys(e),...Object.keys(t)]).reduce((i,o)=>(i[o]=null==e[o]||n&&null!=t[o]?t[o]:e[o],i),new Cp)}e.convertAPIUIConfigToUIConfig=function(e){const i=null!=e.all?t(e.all):new Cp;return n({all:e.all,[Cl.Loader]:jp(e.loader),[Cl.Help]:kp(e.help,e.help),[Cl.Tools]:kp(e.tools,e.tools),[Cl.Layout]:e.layout,[Cl.Toolbar]:e.toolbar,[Cl.Fullscreen]:kp(e.fullscreen,e.fullscreen),[Cl.Search]:kp(e.objectTree,e.search),[Cl.Audio]:e.audio,[Cl.Media]:_p(e.playPause,kp(e.scrubber,e["scrubber.chapters"]),e.media),[Cl.Camera]:kp(e.nav,e.cameraMode,e.center,e.zoomIn,e.zoomOut,e.nav),[Cl.Pagination]:kp(e.tour,e["tour.chapters"]),[Cl.Column]:kp(e.info,e.info),[Cl.Drawer]:kp(e.info,e.info),[Cl.TitleOnly]:kp(e.info,e.info),[Cl.LabelList]:e.labelList,[Cl.ChapterList]:e.chapterList,[Cl.NodeInfo]:e.anatomyDescriptions,[Cl.Legend]:e.legend,[Cl.Menu]:e.menu,[Cl.InternetExplorerWarning]:void 0,[Cl.Labels]:void 0,[Cl.Logo]:void 0,[Cl.Presenter]:void 0,logoIsHyperLink:void 0,drawerExpandedInitially:void 0,[Cl.Tutorial]:void 0,[Cl.AnatomyLabels]:kp(e.anatomyLabels,e.anatomyLabels),[Cl.Undo]:kp(e.reset,e.undo),[Cl.Whiteboard]:e.whiteboard,[Cl.VisibilityLayers]:e.visibilityLayers,[Cl.ContextActions]:e.contextActions,[Cl.ToggleLabels]:void 0},i)},e.convertUrlUIConfigToUIConfig=function(e){const i=null!=e["ui-all"]?t(e["ui-all"]):new Cp;return n({[Cl.Layout]:e["ui-layout"],[Cl.Loader]:jp(e["ui-loader"]),[Cl.NodeInfo]:e["ui-anatomy-descriptions"],[Cl.Tools]:e["ui-tools"],[Cl.Toolbar]:e["ui-toolbar"],[Cl.Media]:_p(null,kp(e["ui-scrubber"],e["ui-scrubber.chapters"],e["ui-scrubber.tour"]),e["ui-media-controls"]),[Cl.Audio]:e["ui-audio"],[Cl.Fullscreen]:e["ui-fullscreen"],[Cl.Help]:e["ui-help"],[Cl.Camera]:e["ui-nav"],[Cl.Presenter]:e["ui-presenter"],[Cl.Menu]:e["ui-menu"],[Cl.Pagination]:e["ui-tour"],[Cl.Search]:kp(e["ui-search"],e["ui-object-tree"]),[Cl.Column]:kp(e["ui-info"],e["ui-panel"]),[Cl.Drawer]:kp(e["ui-info"],e["ui-panel"]),[Cl.Description]:kp(e["ui-info"]),[Cl.TitleOnly]:kp(e["ui-info"]),[Cl.Logo]:kp(e["ui-bd"],e["ui-logo"]),logoIsHyperLink:kp(e["ui-bd.link"],e["ui-logo.islink"]),[Cl.Labels]:e["ui-labels"],[Cl.LabelList]:e["ui-label-list"],[Cl.ChapterList]:e["ui-chapter-list"],[Cl.InternetExplorerWarning]:e["ie-warning"],all:e["ui-all"],drawerExpandedInitially:e["ui-info-expand"],[Cl.AnatomyLabels]:kp(e["ui-anatomy-labels"]),[Cl.Tutorial]:kp(e["ui-tutorial"]),[Cl.Legend]:kp(e["ui-legend"]),[Cl.Undo]:kp(e["ui-undo"],e["ui-reset"]),[Cl.Whiteboard]:kp(e["ui-whiteboard"]),[Cl.VisibilityLayers]:kp(e["ui-visibility-layers"],e["ui-layers"]),[Cl.ContextActions]:kp(e["ui-context-actions"]),[Cl.ToggleLabels]:void 0},i)},e.chapterUItoUIConfig=function(e){if(!e||!e.config)return null;const t=new Cp;return t[Cl.Column]=e.config.info,t[Cl.Drawer]=e.config.info,t[Cl.Fullscreen]=e.config.fullscreen,t[Cl.Search]=e.config.objectTree,t[Cl.Camera]=e.config.nav,t[Cl.Loader]=jp(e.config.loader),t[Cl.Whiteboard]=e.config.whiteboard,t[Cl.VisibilityLayers]=e.config.visibilityLayers,t[Cl.ContextActions]=e.config.contextActions,t[Cl.Media]=_p(e.config.playPause,e.config.scrubber,e.config.mediaControls),t},e.generateUIAllConfig=t,e.generateQuizUIConfig=function(){const e=new Cp;return e.search=!1,e.pagination=!1,e.labelList=!1,e.labels=!1,e.anatomyLabels=!1,e.nodeInfo=!1,e.toggleLabels=!1,e.legend=!1,e.chapterList=!1,e},e.mergeUIConfigs=n,e.createLayoutFromConfig=function(e,t){const n=JSON.parse(JSON.stringify(e));return n.loader.enable=Sp(t[Cl.Loader]!==ra.None,Op.loader.enable),null!=t[Cl.Loader]&&(n.loader.template=t[Cl.Loader]),n.nodeInfo.enable=Sp(t[Cl.NodeInfo],Op.nodeInfo.enable),n.pagination.enable=Sp(t[Cl.Pagination],Op.pagination.enable),n.drawer.isExpandedInitially=Sp(t.drawerExpandedInitially,Op.drawer.isExpandedInitially),n.tools.enable=Sp(t[Cl.Tools],Op.tools.enable),n.toolbar.enable=Sp(t[Cl.Toolbar],Op.toolbar.enable),n.media.enable=Sp(t[Cl.Media]!==sa.None,Op.media.enable),n.media.template=t[Cl.Media],n.fullscreen.enable=Sp(t[Cl.Fullscreen],Op.fullscreen.enable),n.help.enable=Sp(t[Cl.Help],Op.help.enable),n.description.enable=Sp(t[Cl.Description],Op.description.enable),n.titleOnly.enable=Sp(t[Cl.TitleOnly],Op.titleOnly.enable),n.camera.enable=Sp(t[Cl.Camera],Op.camera.enable),n.search.enable=Sp(t[Cl.Search],Op.search.enable),n.presenter.enable=Sp(t[Cl.Presenter],Op.presenter.enable),n.menu.enable=Sp(t[Cl.Menu],Op.menu.enable),n.logo.enable=Sp(t[Cl.Logo],Op.logo.enable),n.logo.isHyperLink=Sp(t.logoIsHyperLink,Op.logo.isHyperLink),n.internetExplorerWarning.enable=Sp(t.internetExplorerWarning,Op.internetExplorerWarning.enable),n.undo.enable=Sp(t[Cl.Undo],Op.undo.enable),n.labels.enable=Sp(t[Cl.Labels],Op.labels.enable),n.labelList.enable=Sp(t[Cl.LabelList],Op.labelList.enable),n.chapterList.enable=Sp(t[Cl.ChapterList],Op.chapterList.enable),n.audio.enable=Sp(t[Cl.Audio],Op.audio.enable),n.reset.enable=Sp(t[Cl.Reset],Op.reset.enable),n.column.enable=Sp(t[Cl.Column],Op.column.enable),n.drawer.enable=Sp(t[Cl.Drawer],Op.drawer.enable),n.anatomyLabels.enable=Sp(t[Cl.AnatomyLabels],Op.anatomyLabels.enable),n.tutorial.enable=Sp(t[Cl.Tutorial],Op.tutorial.enable),n.whiteboard.enable=Sp(t[Cl.Whiteboard],Op.whiteboard.enable),n.visibilityLayers.enable=Sp(t[Cl.VisibilityLayers],Op.visibilityLayers.enable),n.contextActions.enable=Sp(t[Cl.ContextActions],Op.contextActions.enable),n.toggleLabels.enable=Sp(t[Cl.ToggleLabels],Op.toggleLabels.enable),n},e.getScrollSetting=function(e){return e["disable-scroll"]?Zo.DoNotCapture:e["disable-scroll.alert"]||e["disable-scroll.overlay"]?Zo.DoNotCaptureShowMessage:Zo.Capture},e.getUsePrintImage=function(e){return!0===e["ui-print-image"]},e.getInteractType=function(e,t,n){const i=e["initial.play"]||e.initial||e["initial.button"]||e["initial.hand"]||e["initial.hand-hint"]||t;return{interactType:(()=>{switch(!0){case e.initial:case e["initial.button"]:return Ec.Button;case e["initial.hand"]:case e["initial.hand-hint"]:return Ec.Hand;case e["initial.play"]:return Ec.Play;default:return n}})(),isInteractActive:i}},e.getOnDemand=function(e){return!1===e["auto-load"]}}(Pp||(Pp={}));var Mp=function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function r(e){try{c(i.next(e))}catch(t){s(t)}}function a(e){try{c(i.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,a)}c((i=i.apply(e,t||[])).next())}))};let Ip=(()=>{class e{constructor(e,t,n,i,o,s){this.store=e,this.location=t,this.transitionService=n,this.engineService=i,this.layoutService=o,this.pendoService=s}initStory(e,t,n){this.store.dispatch(new Rs(e,t,!0)),c.application!==o.Viewer&&"preview"!==e&&this.store.dispatch(new Ul(e,t));const i=this.store.select(is.getReady),s=this.store.select(Qr.getIncomingStoryInfo),r="preview"===e;Object(rs.b)([i,s]).pipe(Object(K.a)(([e,t])=>e&&!!t.id),Object(sl.a)(1)).subscribe(()=>{this.store.dispatch(new Qt),this.store.dispatch(new Ls(e,t,n,r))})}nextChapter(e){const t=this.store.selectSnapshot(Bo.getSelectedChapterIndex),n=this.store.selectSnapshot(Bo.getStoryChapters);this.pendoService.trackOncePerSession(Y.DiscoveredChapterNav,{source:e,breakpoint:this.store.selectSnapshot(Ol.getBreakpointLabel)});const i=n[t+1];i&&this.selectChapter(i)}previousChapter(e){const t=this.store.selectSnapshot(Bo.getSelectedChapterIndex),n=this.store.selectSnapshot(Bo.getStoryChapters);this.pendoService.trackOncePerSession(Y.DiscoveredChapterNav,{source:e,breakpoint:this.store.selectSnapshot(Ol.getBreakpointLabel)});const i=n[t-1];i&&this.selectChapter(i)}selectChapter(e){return Mp(this,void 0,void 0,(function*(){const t=this.store.selectSnapshot(Bo.getSelectedChapterId),n=e.id,i=this.store.selectSnapshot(Bo.getStoryChapters),o=this.transitionService.searchChapterTransitions(t,n,i);this.pendoService.trackOncePerSession(Y.DiscoveredChapterNav,{source:"Chapter List",breakpoint:this.store.selectSnapshot(Ol.getBreakpointLabel)}),o&&(yield this.chapterTransition(o)),this.store.dispatch([new Vs(e.id),new Qt(e)])}))}chapterTransition(e){return new Promise(t=>{e.camera&&this.store.dispatch(new bt(e.camera,!0,e.duration)),e.fadeColor&&this.store.dispatch(new ce(e.fadeColor,e.duration)),setTimeout(()=>{t(!0)},1e3*e.duration)})}hideSelectedStructures(){const e=this.store.selectSnapshot(ii.getCheckedNodeIds);this.store.dispatch(new $n.UpdateNodesShown(!1,e))}selectTool(e){this.store.dispatch(new ke(e))}toggleColumn(e){const t=this.store.selectSnapshot(il.getUI);t.column.status=(e=null==e?!(t.column.status===oa.Show):e)?oa.Show:oa.Collapse,this.store.dispatch(new Q.SetUI(t))}togglePresentation(){this.store.selectSnapshot(il.getPresentationActive)?this.stopPresentation():this.startPresentation()}startPresentation(){this.store.dispatch(new Q.TogglePresentation(!0))}stopPresentation(){this.store.dispatch(new Q.TogglePresentation(!1))}toggleHelp(e,t=G.Basics){this.store.dispatch(new Q.ToggleWindow(Fc.Help,e)),this.store.dispatch(new Q.ToggleHelpTab(t))}toggleInteract(e){this.store.dispatch(new Q.ToggleWindow(Fc.Interact,e))}toggleOnDemand(e){this.store.dispatch(new Q.SetOnDemand(e)),this.store.dispatch(new Q.ToggleWindow(Fc.OnDemand,e))}toggleTutorial(e){this.store.dispatch(new Q.ToggleWindow(Fc.Tutorial,e)),e&&this.store.dispatch(new Q.StartTutorial(!0))}toggleWhiteboard(e){this.store.dispatch(new Q.ToggleWindow(Fc.Whiteboard,e)),e&&(this.store.dispatch(new je(!1)),this.store.dispatch(new Q.SetWhiteboardEnabled(!0)))}toggleLabels(e){this.store.dispatch(new Se(e))}toggleSearch(e){this.store.selectSnapshot(Ol.getBreakpoint);const t=this.store.selectSnapshot(il.getUI);t.search.status=(e=null==e?!(t.search.status===oa.Show):e)?oa.Show:oa.Hide,e&&(t.nodeInfo.status=oa.Hide),this.store.dispatch(new Q.SetUI(t))}toggleNodeInfo(e){this.toggleInfoLayout("nodeInfo",e)}toggleLabelInfo(e){this.toggleInfoLayout("labelInfo",e)}toggleInfoLayout(e,t){const n=this.store.selectSnapshot(il.getUI);(t=null==t?n[e].status===oa.Hide:t)?(n[e].status=oa.Show,["nodeInfo","labelInfo"].filter(t=>t!==e).forEach(e=>n[e].status=oa.Hide)):n[e].status=oa.Hide,this.store.dispatch(new Q.SetUI(n))}delegateNodeClick(e,t){if(this.clearSelectedLabel(),e||t.srcEvent.shiftKey)if(t.srcEvent.shiftKey||this.store.selectSnapshot(il.getMultiPickModeEnabled))this.checkNode(e);else switch(this.store.selectSnapshot(is.getActiveTool)){case Go.Hide:this.hideNode(e);break;case Go.Select:this.selectNode(e);break;case Go.Isolate:this.isolateNode(e);break;case Go.Fade:this.fadeNode(e)}else this.clearSelectedNodes()}clearSelectedLabel(){this.store.dispatch(new po)}clearSelectedNodes(){this.store.dispatch(new $n.UpdateNodeSelected),this.store.dispatch(new $n.UpdateNodesChecked(!1))}checkNode(e,t){void 0!==e&&(null==t&&(t=this.store.selectSnapshot(ii.getNodes)[e.id].checked),this.store.dispatch(new $n.UpdateNodesChecked(!t,[e.id])),this.store.dispatch(new $n.UpdateNodeSelected(e.id)))}fadeNode(e){this.store.dispatch(new $n.UpdateNodesPaint(bi.recipe,[e.id]))}isolateNode(e){this.store.dispatch(new $n.UpdateNodesShown(!1)),this.store.dispatch(new $n.UpdateNodesShown(!0,[e.id]))}selectNode(e){const t=!this.store.selectSnapshot(ii.getNodes)[e.id].checked;this.store.dispatch(new $n.UpdateNodesChecked(!1)),t&&(this.store.dispatch(new $n.UpdateNodesChecked(!0,[e.id])),this.store.dispatch(new $n.UpdateNodeSelected(e.id))),this.store.dispatch(new He(e)),this.store.dispatch(new We(e))}hideNode(e){this.store.dispatch(new $n.UpdateNodesShown(!1,[e.id])),this.store.dispatch(new $n.UpdateNodesChecked(!1))}selectLabel(e,t=!1){const{objectId:n,states:i}=e;this.store.dispatch(new po(e)),t&&n&&0===i.length&&this.store.dispatch(new fe(n,!0))}initChapter(e){return Mp(this,void 0,void 0,(function*(){const t=this.engineService.createViewGraph({},!1);this.store.dispatch(new pe(t)),this.store.dispatch(new bt(e.camera.location,e.camera.action===ml.FlyTo))}))}playChapterFromStart(){this.store.dispatch(new ze)}resetCamera(){const e=this.store.selectSnapshot(Bo.getSelectedChapter);e&&this.store.dispatch(new bt(e.camera.location))}resetChapter(){this.resetCamera();const e=this.store.selectSnapshot(Bo.getSelectedChapterId);this.store.dispatch(new qn.UndoAll(e)),this.store.dispatch(new $n.UpdateNodesChecked(!1)),this.store.dispatch(new so)}resetLayout(){const{ui:e}=this.store.selectSnapshot(il);this.layoutService.isUIHidden()?Object.keys(e).forEach(t=>{e[t].status=oa.Hide}):(Object.keys(e).forEach(t=>{e[t].status=oa.Show}),e.search.status=oa.Hide,e.tools.status=oa.Hide,e.nodeInfo.status=oa.Hide,e.labelInfo.status=oa.Hide,e.media.status=oa.Hide,e.visibilityLayers.status=oa.Hide),this.store.dispatch(new Q.SetUI(e))}undo(){this.store.dispatch(new qn.Undo(this.store.selectSnapshot(Bo.getSelectedChapterId)))}redo(){this.store.dispatch(new qn.Redo(this.store.selectSnapshot(Bo.getSelectedChapterId)))}toggleAnimation(){const e=!this.store.selectSnapshot(is.getAnimationPlaying);this.store.dispatch(new je(e))}toggleAudio(){const e=this.store.selectSnapshot(is.getPlayAudio);this.store.dispatch(new Ie(!e))}toggleToolbar(e){const t=this.store.selectSnapshot(il.getUI);t.media.status=oa.Hide,t.tools.status=oa.Hide,t.toolbar.status=oa.Hide,t.visibilityLayers.status=oa.Hide,t[e].status=oa.Show,this.store.dispatch(new Q.SetUI(t))}normalizeQueryParams(e){const t=Object.assign({},e);return{id:cl(t),type:ll(t),lang:e.lang}}sanitizeRouteId(e){return e=e.replace(/\.json$/,""),this.location.replaceState("view","?id="+e),e}openInNewTab(){const e=window.document.location.href;window.open(e)}getComputedTransform(e){const t=getComputedStyle(e).transform.replace("matrix3d","").replace("matrix","").replace("(","").replace(")","").split(",").map(e=>e.trim()).map(e=>parseInt(e,10)),n=16===t.length?t[12]:t[4],i=16===t.length?t[13]:t[5];return Number.isNaN(n)||Number.isNaN(i)?null:{x:n,y:i}}getVH(e=!0){const t=this.store.selectSnapshot(wp.getSiteHeader);return.01*(window.innerHeight-(e&&t!==fp.Hide?56:0))}inferDrawerMode(e){let t=rl.Content;return e.nodeInfo.status===oa.Show?t=rl.NodeInfo:e.labelInfo.status===oa.Show&&(t=rl.LabelInfo),t}setUI(e){var t;let n=null!==(t=e.baseUIConfig)&&void 0!==t?t:new Cp;n=Pp.mergeUIConfigs(n,e.apiUIConfig),n=Pp.mergeUIConfigs(n,e.urlUIConfig),n=Pp.mergeUIConfigs(n,e.chapterUIConfig),e.quizUIConfig&&(n=Pp.mergeUIConfigs(n,e.quizUIConfig,!0));const i=this.store.selectSnapshot(il.getUI),o=Pp.createLayoutFromConfig(i,n);this.store.dispatch(new Q.SetUI(o))}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(d.g),i.Zb(ms.g),i.Zb(hl),i.Zb(lt),i.Zb(Ml),i.Zb(ee))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function zp(e,t){1&e&&i.Qb(0,"img",9)}function Tp(e,t){1&e&&i.Qb(0,"img",9)}function Up(e,t){1&e&&i.Qb(0,"img",10)}function Lp(e,t){1&e&&i.Qb(0,"img",11)}function Dp(e,t){if(1&e&&(i.Tb(0),i.Kc(1,zp,1,0,"img",6),i.Kc(2,Tp,1,0,"img",6),i.Kc(3,Up,1,0,"img",7),i.Kc(4,Lp,1,0,"img",8),i.Sb()),2&e){const e=i.gc();i.Db(1),i.lc("ngIf",e.label.pinType==e.labelPinType.Default),i.Db(1),i.lc("ngIf",e.label.pinType==e.labelPinType.Sequential),i.Db(1),i.lc("ngIf",e.label.pinType===e.labelPinType.Plus||e.label.pinType===e.labelPinType.PlusMinus&&!e.selected),i.Db(1),i.lc("ngIf",e.label.pinType===e.labelPinType.Minus||e.label.pinType===e.labelPinType.PlusMinus&&e.selected)}}function Ep(e,t){1&e&&i.Qb(0,"img",15)}function Fp(e,t){1&e&&i.Qb(0,"img",15)}function Ap(e,t){1&e&&i.Qb(0,"img",16)}function Rp(e,t){1&e&&i.Qb(0,"img",17)}function Np(e,t){if(1&e&&(i.Kc(0,Ep,1,0,"img",12),i.Kc(1,Fp,1,0,"img",12),i.Kc(2,Ap,1,0,"img",13),i.Kc(3,Rp,1,0,"img",14)),2&e){const e=i.gc();i.lc("ngIf",e.label.pinType==e.labelPinType.Default),i.Db(1),i.lc("ngIf",e.label.pinType==e.labelPinType.Sequential),i.Db(1),i.lc("ngIf",e.label.pinType===e.labelPinType.Plus||e.label.pinType===e.labelPinType.PlusMinus&&!e.selected),i.Db(1),i.lc("ngIf",e.label.pinType===e.labelPinType.Minus||e.label.pinType===e.labelPinType.PlusMinus&&e.selected)}}const Vp=function(e,t){return{"label-pin__text--white":e,"label-pin__text--black":t}};function Hp(e,t){if(1&e&&(i.Tb(0),i.Vb(1,"div",18),i.Mc(2),i.Ub(),i.Sb()),2&e){const e=i.gc();i.Db(1),i.lc("ngClass",i.pc(2,Vp,e.labelTheme===e.labelThemeEnum.StudioNext,e.labelTheme===e.labelThemeEnum.Annotation)),i.Db(1),i.Oc(" ",e.sequence," ")}}const Bp=function(e,t,n,i){return{"label-pin--light":e,"label-pin--dark":t,"label-pin--none":n,"label-pin--selected":i}};let Qp=(()=>{class e{constructor(){this.labelPinType=vn,this.labelThemeEnum=wn,this.labelTheme=wn.StudioNext,this.selected=!1}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-label-pin"]],inputs:{label:"label",labelTheme:"labelTheme",selected:"selected",sequence:"sequence"},decls:7,vars:9,consts:[[1,"label-pin",3,"ngClass"],["pin",""],[4,"ngIf","ngIfElse"],["lightPins",""],[4,"ngIf"],[1,"label__glow"],["draggable","false","alt","","src","./assets/images/labels/circle-dark.svg","class","label-pin__image",4,"ngIf"],["draggable","false","alt","","src","./assets/images/labels/circle-plus-dark.svg","class","label-pin__image",4,"ngIf"],["draggable","false","alt","","src","./assets/images/labels/circle-minus-dark.svg","class","label-pin__image",4,"ngIf"],["draggable","false","alt","","src","./assets/images/labels/circle-dark.svg",1,"label-pin__image"],["draggable","false","alt","","src","./assets/images/labels/circle-plus-dark.svg",1,"label-pin__image"],["draggable","false","alt","","src","./assets/images/labels/circle-minus-dark.svg",1,"label-pin__image"],["draggable","false","alt","","src","./assets/images/labels/circle.svg","class","label-pin__image",4,"ngIf"],["draggable","false","alt","","src","./assets/images/labels/circle-plus.svg","class","label-pin__image",4,"ngIf"],["draggable","false","alt","","src","./assets/images/labels/circle-minus.svg","class","label-pin__image",4,"ngIf"],["draggable","false","alt","","src","./assets/images/labels/circle.svg",1,"label-pin__image"],["draggable","false","alt","","src","./assets/images/labels/circle-plus.svg",1,"label-pin__image"],["draggable","false","alt","","src","./assets/images/labels/circle-minus.svg",1,"label-pin__image"],[1,"label-pin__text",3,"ngClass"]],template:function(e,t){if(1&e&&(i.Vb(0,"div",0,1),i.Kc(2,Dp,5,4,"ng-container",2),i.Kc(3,Np,4,4,"ng-template",null,3,i.Lc),i.Kc(5,Hp,3,5,"ng-container",4),i.Qb(6,"div",5),i.Ub()),2&e){const e=i.vc(4);i.lc("ngClass",i.rc(4,Bp,t.labelTheme===t.labelThemeEnum.StudioNext,t.labelTheme===t.labelThemeEnum.Annotation,t.label.pinType===t.labelPinType.None,t.selected)),i.Db(2),i.lc("ngIf",t.labelTheme===t.labelThemeEnum.Annotation)("ngIfElse",e),i.Db(3),i.lc("ngIf",t.label.pinType===t.labelPinType.Sequential)}},directives:[ms.i,ms.l],styles:['.label-pin[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;position:relative;transition:background-color .12s;z-index:10}.label-pin__text[_ngcontent-%COMP%]{display:flex;z-index:10;justify-content:center;align-items:center;font-size:10px!important;color:#101823}.label-pin[_ngcontent-%COMP%]:before, .label-pin__text[_ngcontent-%COMP%]{position:absolute;left:0;top:0;width:100%;height:100%}.label-pin[_ngcontent-%COMP%]:before{content:" ";background-color:transparent;border:2px solid transparent;border-radius:50%;box-sizing:border-box;display:block;z-index:-2}.label-pin--light.label-pin--selected[_ngcontent-%COMP%]:before{background-color:#fff;border-color:#2d72dc;box-shadow:0 0 0 1px rgba(45,114,220,.7)}.label-pin--light.label-pin[_ngcontent-%COMP%]   .label-pin__text[_ngcontent-%COMP%]{color:#101823}.label-pin--dark.label-pin[_ngcontent-%COMP%]:before{background-color:rgba(0,0,0,.75)}.label-pin--dark.label-pin--selected[_ngcontent-%COMP%]:after, .label-pin--dark.label-pin--selected[_ngcontent-%COMP%]:before{background-color:#2d72dc}.label-pin--dark.label-pin[_ngcontent-%COMP%]   .label-pin__text[_ngcontent-%COMP%]{color:#fff}.label-pin--none.label-pin[_ngcontent-%COMP%]{display:none}'],changeDetection:0}),e})();var $p=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},qp=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const Wp=["labelContainerEl"],Kp=["labelEl"],Gp=["wire"],Zp=["tag"],Jp=["pin"],Xp=["title"];function Yp(e,t){1&e&&(i.Vb(0,"div",18),i.Qb(1,"app-icon",19),i.Ub())}const ed=function(e){return{"label__body--collapse":e}};function td(e,t){if(1&e&&(i.Vb(0,"div",20),i.jc(1,3),i.Ub()),2&e){const e=i.gc();i.lc("ngClass",i.oc(1,ed,e.isCollapsed||e.descriptionCollapsed))}}const nd=[[["","label-header",""]],[["","label-actions",""]],[["","label-more",""]],[["","label-body",""]]],id=function(e,t,n,i,o,s,r,a,c,l){return{"label--selected":e,"label--glow":t,"label--annotation":n,"label--classic":i,"label--invert":o,"label--studio":s,"label--context":r,"label--screenshot-mode":a,"label--auto-fit":c,"label--opaque":l}},od=function(e){return{"label__wire--collapse":e}},sd=function(e,t,n,i){return{"label__tag--collapse":e,"label__tag--collapsible":t,"label__tag--floating":n,"label__tag--draggable":i}},rd=["[label-header]","[label-actions]","[label-more]","[label-body]"];let ad=(()=>{class e{constructor(e,t,n,o,s,r,a){this.renderer=e,this.labelsService=t,this.engineService=n,this.cameraService=o,this.store=s,this.actions=r,this.changeDetection=a,this.labelPinType=vn,this.labelSequentialType=On,this.labelUpdated=new i.p,this.offsetUpdated=new i.p,this.pinClicked=new i.p,this.tagClicked=new i.p,this.displayUpdated=new i.p,this.positionUpdated=new i.p,this.hoverStart=new i.p,this.hoverEnd=new i.p,this.labelOffsetUpdated=new i.p,this.fit="fixed",this.opaque=!1,this.scale=1,this.isCollapsed=!1,this.tagCollapsed=!1,this.theme="classic",this.pinDraggable=!0,this.tagDraggable=!0,this.enginePosition=null,this.isBackgroundDark=!1,this.pinDragging=!1,this.screenshotMode=!1,this.hammerManagers=[],this.displayUpdated$=new $.a,this.positionUpdated$=new $.a,this.ngUnsubscribe=new $.a}get label(){return this._label}set label(e){const t=Object(X.isEmpty)(e),n=Object(X.isEmpty)(this.label);t&&!n?(this._label=Object.assign({},e),this.destroyLabel()):t||(this._label=Object.assign({},e),this.initLabel(this.label))}ngOnInit(){this.initListeners()}ngAfterViewInit(){this.bindTagEvents(),this.bindPinEvents(),this.bindHoverEvents()}ngOnDestroy(){this.destroyLabel(),this.emitDisplayUpdated({id:this.label.id,inView:!1,shown:!1,objectShown:this.objectShown}),this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}destroyLabel(){this.hammerManagers.forEach(e=>e.destroy),this.hammerManagers=[],this.deleteMarker(this.marker)}initListeners(){this.enginePosition$.pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.enginePosition=e}),this.engineService.getEvent(it.SceneMarkersUpdated).pipe(Object(K.a)(()=>null!=this.label&&null!=this.enginePosition),Object(W.a)(this.ngUnsubscribe)).subscribe(()=>{this.setCanvasPos()}),this.displayUpdated$.pipe(Object(ls.a)((e,t)=>Object(X.isEqual)(e,t)),Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.displayUpdated.next(e)}),this.positionUpdated$.pipe(Object(ls.a)((e,t)=>Object(X.isEqual)(e,t)),Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.positionUpdated.next({positionUpdate:e,onCanvas:this.isOnCanvas()})}),this.background$.pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{const t=e.colors.slice(0,3),n=e.colors.slice(4,7);this.isBackgroundDark=!Eo.isLight(t,n),this.changeDetection.markForCheck()}),this.actions.pipe(Object(d.j)(hn),Object(W.a)(this.ngUnsubscribe)).subscribe(()=>{this.screenshotMode=!0,this.changeDetection.detectChanges()}),this.actions.pipe(Object(d.i)(bn),Object(W.a)(this.ngUnsubscribe)).subscribe(()=>{this.screenshotMode=!1,this.changeDetection.markForCheck()})}bindTagEvents(){const e=new Gr(this.tagRef.nativeElement,{domEvents:!0});e.get("pan").set({direction:Gr.DIRECTION_ALL,threshold:3}),e.on("pan",e=>{if(!this.tagDraggable)return;e.srcEvent.stopPropagation(),this.cachedTagOffset||(this.cachedTagOffset=this.label.offset);const t=[this.cachedTagOffset[0]+e.deltaX,this.cachedTagOffset[1]+e.deltaY];this.label.offset=t,e.isFinal&&(this.cachedTagOffset=null,this.offsetUpdated.next({labelId:this.label.id,offset:t}))}),e.on("tap",e=>{e.srcEvent.preventDefault(),e.srcEvent.stopPropagation(),this.tagClicked.next(e)}),this.hammerManagers.push(e)}bindPinEvents(){const e=new Gr(this.pinRef.nativeElement);e.get("pan").set({direction:Gr.DIRECTION_ALL,threshold:4}),e.on("pan",e=>{if(!this.pinDraggable)return;e.srcEvent.stopPropagation(),this.pinDragging=!0;let{layerX:t,layerY:n}=e.changedPointers[0];if(t-=16,n-=16,this.marker&&this.deleteMarker(this.marker),this.renderer.setStyle(this.labelContainerRef.nativeElement,"transform",`translate(${t}px, ${n}px)`),e.isFinal){this.pinDragging=!1;const e=Object.assign({},this.label),i=Human.renderer.pick.pick({canvasPos:[t,n],rayPick:!0}),o="string"==typeof i.objectId;o&&(e.dir=this.cameraService.getDirection(i),e.objectId=i.objectId,e.barycentric=[i.barycentric[0],i.barycentric[1],i.barycentric[2]],e.pos=[i.worldPos[0],i.worldPos[1],i.worldPos[2]],e.primitiveIndex=i.primitiveIndex),this.labelUpdated.next({label:e,shouldPreserve:o})}}),e.on("tap",e=>{e.srcEvent.preventDefault(),e.srcEvent.stopImmediatePropagation(),this.pinClicked.next(e)}),this.hammerManagers.push(e)}bindHoverEvents(){const e=this.labelRef.nativeElement;this.renderer.listen(e,"mouseenter",()=>{this.hoverStart.next({labelId:this.label.id})}),this.renderer.listen(e,"mouseleave",()=>{this.hoverEnd.next({labelId:this.label.id})})}initLabel(e){this.initMarker(e),this.ensureObjectId(e),this.initObjectSubscription(e)}initMarker(e){this.marker&&this.deleteMarker(this.marker),this.marker=Human.scene.markers.create({id:e.id,pos:e.pos,dir:e.dir,objectId:e.objectId,primitiveIndex:e.primitiveIndex,barycentric:e.barycentric,renderableIndex:e.renderableIndex||0})}checkLabelDisplay(){return{id:this.label.id,shown:this.label.shown,inView:this.isOnCanvas(),objectShown:!0}}ensureObjectId(e){if(!e.objectId){const t=Human.renderer.pick.pick({canvasPos:[this.marker.canvasPos[0],this.marker.canvasPos[1]],rayPick:!0});t.objectId&&(e.objectId=t.objectId,e.states.forEach(e=>{e.errands.forEach(e=>{e.type===Fn.flyToObject&&(e.value=t.objectId)})}),this.labelUpdated.next({label:e,shouldPreserve:void 0}))}}initObjectSubscription(e){this.object$&&this.object$.unsubscribe(),e.objectId&&(this.object$=this.store.select(is.getViewGraphNode).pipe(Object(k.a)(t=>t(e.objectId)),Object(K.a)(e=>!!e),Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.objectShown=e.boolState.shown}))}deleteMarker(e){Human.scene.markers.delete(e.id),this.marker=null}setCanvasPos(){if(this.pinDragging||!this.marker)return;this.depth=-this.marker.viewPos[2];const e=this.isOccluded(),t=this.isOcclusionIgnored(),n=this.isOnCanvas(),i=e&&!t,o=void 0===this.objectShown?n&&!i:n&&this.objectShown&&!i;o!==this.shown&&(this.shown=o,this.setDisplay(o)),this.setElementPosition(),this.setElementScale(),this.setTagPosition(),this.setWirePosition();const{0:s,1:r}=this.marker.canvasPos;this.positionUpdated$.next({id:this.label.id,canvasPos:{x:s,y:r},occluded:i})}isOcclusionIgnored(){return this.selected||!this.label.occludable}isOccluded(){return this.depth<0||this.marker.occluded}isOnCanvas(){const{offsetWidth:e,offsetHeight:t}=this.labelsService.getLabelContainer().nativeElement,[n,i]=this.marker.canvasPos;return n>0&&i>0&&n<e&&i<t}setDisplay(e){this.renderer.setStyle(this.labelRef.nativeElement,"visibility",e?"visible":"hidden"),this.emitDisplayUpdated({id:this.label.id,inView:this.isOnCanvas(),shown:e,objectShown:this.objectShown})}setOpacity(e){let t=1;e?(this.marker.viewAngle>=80&&(t=Math.max(1-(this.marker.viewAngle-80)/20*1,0)),this.renderer.setStyle(this.labelContainerRef.nativeElement,"opacity",t)):this.renderer.setStyle(this.labelContainerRef.nativeElement,"opacity",1)}setElementPosition(){const e=this.marker.canvasPos;this.renderer.setStyle(this.labelContainerRef.nativeElement,"transform",`translate(${e[0]}px, ${e[1]}px)`)}setElementScale(){if(!this.scale){const e=this.store.selectSnapshot(is.getEnginePosition).width;this.scale=e>1440?e/1440:1}const e=32*this.scale-32;this.renderer.setStyle(this.labelRef.nativeElement,"transform-origin","top left"),this.renderer.setStyle(this.labelRef.nativeElement,"transform",`translate(-${e/2}px, -${e/2}px) scale(${this.scale}, ${this.scale})`)}setTagPosition(){const e=this.label.offset,t=this.tagRef.nativeElement.offsetWidth;switch(this.label.offset[0]>0?"left":"right"){case"left":this.renderer.setStyle(this.tagRef.nativeElement,"transform",`translate(${16+e[0]}px, ${e[1]}px)`);break;case"right":this.renderer.setStyle(this.tagRef.nativeElement,"transform",`translate(${16+e[0]-t}px, ${e[1]}px)`)}}setWirePosition(){let[e,t]=this.label.offset;switch(this.label.theme){case wn.Annotation:case wn.Classic:t+=this.titleRef.nativeElement.offsetHeight-16-2}const n=Math.sqrt(e*e+t*t);this.renderer.setStyle(this.wireRef.nativeElement,"width",n+"px"),this.renderer.setStyle(this.wireRef.nativeElement,"transform",`rotate(${Math.atan2(t,e)}rad)`)}emitDisplayUpdated(e){"context-label"!==this.label.id&&null!=e.inView&&null!=e.shown&&this.displayUpdated$.next(e)}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(i.H),i.Pb(Bn),i.Pb(lt),i.Pb(Lt),i.Pb(d.g),i.Pb(d.b),i.Pb(i.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-generic-label"]],viewQuery:function(e,t){if(1&e&&(i.Gc(Wp,!0),i.Gc(Kp,!0),i.Gc(Gp,!0),i.Gc(Zp,!0),i.Gc(Jp,!0),i.Gc(Xp,!0)),2&e){let e;i.uc(e=i.dc())&&(t.labelContainerRef=e.first),i.uc(e=i.dc())&&(t.labelRef=e.first),i.uc(e=i.dc())&&(t.wireRef=e.first),i.uc(e=i.dc())&&(t.tagRef=e.first),i.uc(e=i.dc())&&(t.pinRef=e.first),i.uc(e=i.dc())&&(t.titleRef=e.first)}},inputs:{fit:"fit",opaque:"opaque",scale:"scale",sequence:"sequence",hasContent:"hasContent",label:"label",isCollapsed:"isCollapsed",descriptionCollapsed:"descriptionCollapsed",tagCollapsed:"tagCollapsed",selected:"selected",theme:"theme",pinDraggable:"pinDraggable",tagDraggable:"tagDraggable"},outputs:{labelUpdated:"labelUpdated",offsetUpdated:"offsetUpdated",pinClicked:"pinClicked",tagClicked:"tagClicked",displayUpdated:"displayUpdated",positionUpdated:"positionUpdated",hoverStart:"hoverStart",hoverEnd:"hoverEnd",labelOffsetUpdated:"labelOffsetUpdated"},ngContentSelectors:rd,decls:21,vars:27,consts:[["data-test","labelContainer","aria-hidden","true",1,"label-container"],["labelContainerEl",""],["data-test","labelElement",1,"label",3,"ngClass"],["labelEl",""],[1,"label__pin"],["pin",""],[3,"label","labelTheme","selected","sequence"],[1,"label__glow"],[1,"label__wire",3,"ngClass"],["wire",""],[1,"label__tag",3,"ngClass"],["tag",""],[1,"label__header"],["data-test","labelTitle",1,"label__title"],["title",""],["class","label__more",4,"ngIf"],["appEventFence","",1,"label__actions"],["class","label__body",3,"ngClass",4,"ngIf"],[1,"label__more"],["icon","caret-right"],[1,"label__body",3,"ngClass"]],template:function(e,t){1&e&&(i.kc(nd),i.Vb(0,"div",0,1),i.Vb(2,"div",2,3),i.Vb(4,"div",4,5),i.Qb(6,"app-label-pin",6),i.Qb(7,"div",7),i.Ub(),i.Qb(8,"div",8,9),i.Vb(10,"div",10,11),i.Vb(12,"div",12),i.Vb(13,"div",13,14),i.jc(15),i.Ub(),i.Kc(16,Yp,2,0,"div",15),i.Vb(17,"div",16),i.jc(18,1),i.Ub(),i.Ub(),i.Kc(19,td,2,3,"div",17),i.jc(20,2),i.Ub(),i.Ub(),i.Ub()),2&e&&(i.Db(2),i.lc("ngClass",i.tc(9,id,[t.selected,t.label.pinGlow,"annotation"===t.label.theme,"classic"===t.label.theme,t.isBackgroundDark,"studioNext"===t.label.theme,"context"===t.label.theme,t.screenshotMode,"auto"===t.fit,t.opaque])),i.Db(4),i.lc("label",t.label)("labelTheme",t.label.theme)("selected",t.selected)("sequence",t.sequence),i.Db(2),i.lc("ngClass",i.oc(20,od,t.isCollapsed||t.tagCollapsed||t.label.hideWire)),i.Db(2),i.lc("ngClass",i.rc(22,sd,t.isCollapsed||t.tagCollapsed,t.label.collapseDescription,t.label.hideWire,t.tagDraggable)),i.Db(6),i.lc("ngIf",t.hasContent&&t.label.collapseDescription),i.Db(3),i.lc("ngIf",t.hasContent))},directives:[ms.i,Qp,ms.l,Qa,$a],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3838}.text-info[_ngcontent-%COMP%]{color:#0060c4}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}@-webkit-keyframes fadeIn{0%{display:none;opacity:0}1%{display:block;opacity:0}to{opacity:1;display:block}}@keyframes fadeIn{0%{display:none;opacity:0}1%{display:block;opacity:0}to{opacity:1;display:block}}@-webkit-keyframes fadeOut{0%{display:block;opacity:1}99%{opacity:0}to{opacity:0;display:none}}@keyframes fadeOut{0%{display:block;opacity:1}99%{opacity:0}to{opacity:0;display:none}}@-webkit-keyframes glow{0%{box-shadow:0 0 0 hsla(0,0%,100%,.5)}50%{box-shadow:0 0 8px 2px hsla(0,0%,100%,.5)}to{box-shadow:0 0 0 hsla(0,0%,100%,.5)}}@keyframes glow{0%{box-shadow:0 0 0 hsla(0,0%,100%,.5)}50%{box-shadow:0 0 8px 2px hsla(0,0%,100%,.5)}to{box-shadow:0 0 0 hsla(0,0%,100%,.5)}}@-webkit-keyframes classic-glow{0%{transform:scale(.5)}10%{transform:scale(.5)}50%{transform:scale(1)}90%{transform:scale(.5)}to{transform:scale(.5)}}@keyframes classic-glow{0%{transform:scale(.5)}10%{transform:scale(.5)}50%{transform:scale(1)}90%{transform:scale(.5)}to{transform:scale(.5)}}.label-container[_ngcontent-%COMP%], [_nghost-%COMP%]{display:block;position:absolute;z-index:10;width:160px;pointer-events:all;pointer-events:none}.label-container[_ngcontent-%COMP%]:hover, [_nghost-%COMP%]:hover{z-index:11}.label-container[_ngcontent-%COMP%]{left:-16px;top:-16px}.label[_ngcontent-%COMP%]{display:block;overflow:visible;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;justify-content:center;align-items:center;height:32px}.label--screenshot-mode[_ngcontent-%COMP%]   .label__pin[_ngcontent-%COMP%]:after, .label--screenshot-mode[_ngcontent-%COMP%]   .label__pin[_ngcontent-%COMP%]:before, .label--screenshot-mode[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]{box-shadow:none!important}.label--screenshot-mode[_ngcontent-%COMP%]   .label__more[_ngcontent-%COMP%]{display:none!important}.label--auto-fit[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]{min-width:-webkit-max-content;min-width:-moz-max-content;min-width:max-content;padding:0!important}.label--auto-fit[_ngcontent-%COMP%]   .label__body[_ngcontent-%COMP%]{padding:0!important}.label__glow[_ngcontent-%COMP%]{display:none;position:absolute;width:32px;height:32px;border-radius:50%;z-index:0;top:0;left:0}.label--selected[_ngcontent-%COMP%]   .label__more[_ngcontent-%COMP%]{transform:rotate(45deg)}.label__more[_ngcontent-%COMP%]{color:#374a68;display:none;flex:0 0 16px;height:16px;transition:transform .15s ease-in-out}.label__more[_ngcontent-%COMP%], .label__pin[_ngcontent-%COMP%]{align-items:center;justify-content:center}.label__pin[_ngcontent-%COMP%]{display:flex;width:32px;height:32px;border-radius:50%;position:absolute;pointer-events:all;transition:background-color .12s;z-index:10}.label__pin[_ngcontent-%COMP%]:hover{cursor:pointer}.label__pin--draggable[_ngcontent-%COMP%]:hover{cursor:-webkit-grab;cursor:grab}.label__pin--draggable[_ngcontent-%COMP%]:active{cursor:-webkit-grabbing;cursor:grabbing}.label__wire[_ngcontent-%COMP%]{position:absolute;top:16px;left:16px;height:0;transform-origin:0 100%;pointer-events:none;z-index:1}.label__wire--collapse[_ngcontent-%COMP%]{display:none}.label__tag[_ngcontent-%COMP%]{display:inline-block;left:16px;top:0;z-index:10;max-width:160px;pointer-events:all}.label__tag[_ngcontent-%COMP%]:hover{cursor:pointer}.label__tag--draggable[_ngcontent-%COMP%]:hover{cursor:-webkit-grab;cursor:grab}.label__tag--draggable[_ngcontent-%COMP%]:active{cursor:-webkit-grabbing;cursor:grabbing}.label__tag--collapse[_ngcontent-%COMP%]{display:none}.label__header[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.label__title[_ngcontent-%COMP%]{line-height:1.4em;line-height:140%;align-self:center}.label__body[_ngcontent-%COMP%], .label__title[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px}.label__body[_ngcontent-%COMP%]{line-height:1.4em}.label__body--collapse[_ngcontent-%COMP%]{display:none}.label__icon[_ngcontent-%COMP%]{margin:0 -4px 0 4px}.label__actions[_ngcontent-%COMP%]{padding-left:4px}.label--studio.label--glow[_ngcontent-%COMP%]   .label__glow[_ngcontent-%COMP%]{background-color:hsla(0,0%,100%,.3);display:block;-webkit-animation:classic-glow 4s infinite;animation:classic-glow 4s infinite}.label--studio.label--opaque[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]{background-color:hsla(0,0%,100%,.85)!important}.label--studio.label.label--selected[_ngcontent-%COMP%]   .label__wire[_ngcontent-%COMP%]{border-color:#2d72dc}.label--studio.label.label--selected[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]{background-color:#fff;border-color:#2d72dc;box-shadow:0 0 0 1px rgba(45,114,220,.7)}.label--studio.label.label--selected[_ngcontent-%COMP%]   .label__title[_ngcontent-%COMP%]{font-weight:600}.label--studio.label[_ngcontent-%COMP%]   .label__wire[_ngcontent-%COMP%]{border-top:1px solid rgba(16,24,35,.5)}.label--studio.label[_ngcontent-%COMP%]   .label__wire--collapse[_ngcontent-%COMP%]{display:none}.label--studio.label[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]{background:hsla(0,0%,100%,.55);border:1px solid rgba(16,24,35,.5);box-shadow:0 0 24px rgba(16,24,35,.1);padding:4px 8px;border-radius:4px}.label--studio.label[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]:hover{background:hsla(0,0%,100%,.8)}.label--studio.label[_ngcontent-%COMP%]   .label__title[_ngcontent-%COMP%]{color:#101823;flex:1 1 auto}.label--studio.label[_ngcontent-%COMP%]   .label__body[_ngcontent-%COMP%]{color:#374a68;overflow-x:hidden;padding-top:4px}.label--studio.label[_ngcontent-%COMP%]   .label__body[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-weight:700}.label--studio.label[_ngcontent-%COMP%]   .label__body[_ngcontent-%COMP%]   em[_ngcontent-%COMP%]{font-style:italic}.label--studio.label[_ngcontent-%COMP%]   .label__more[_ngcontent-%COMP%]{display:flex}.label--studio.label.label--invert[_ngcontent-%COMP%]   .label__wire[_ngcontent-%COMP%]{border-color:hsla(0,0%,100%,.5)}.label--annotation.label--glow[_ngcontent-%COMP%]   .label__glow[_ngcontent-%COMP%]{background-color:hsla(0,0%,100%,.25);display:block;-webkit-animation:classic-glow 4s infinite;animation:classic-glow 4s infinite;top:-1px;left:-1px}.label--annotation.label--none[_ngcontent-%COMP%]{display:none}.label--annotation.label[_ngcontent-%COMP%]   .label__wire[_ngcontent-%COMP%]{border-top:1px solid #666}.label--annotation.label[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]{text-shadow:0 0 2px hsla(0,0%,100%,.5);min-width:10px;color:#eee}.label--annotation.label[_ngcontent-%COMP%]   .label__tag--collapsible[_ngcontent-%COMP%]   .label__more[_ngcontent-%COMP%]{display:flex;color:#000}.label--annotation.label[_ngcontent-%COMP%]   .label__tag--floating[_ngcontent-%COMP%]   .label__header[_ngcontent-%COMP%]{border-bottom:none}.label--annotation.label[_ngcontent-%COMP%]   .label__header[_ngcontent-%COMP%]{border-bottom:1px solid #666}.label--annotation.label[_ngcontent-%COMP%]   .label__title[_ngcontent-%COMP%]{font-weight:600;min-height:18px;width:100%;padding-bottom:4px;margin-bottom:-2px;color:#000}.label--annotation.label[_ngcontent-%COMP%]   .label__body[_ngcontent-%COMP%]{padding-top:4px;color:#333}.label--annotation.label.label--invert.label[_ngcontent-%COMP%]{text-shadow:0 0 2px rgba(0,0,0,.6)}.label--annotation.label.label--invert.label[_ngcontent-%COMP%]   .label__wire[_ngcontent-%COMP%]{border-color:#eee}.label--annotation.label.label--invert.label[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]{text-shadow:none}.label--annotation.label.label--invert.label[_ngcontent-%COMP%]   .label__tag--collapsible[_ngcontent-%COMP%]   .label__more[_ngcontent-%COMP%]{display:flex;color:#fff}.label--annotation.label.label--invert.label[_ngcontent-%COMP%]   .label__title[_ngcontent-%COMP%]{color:#fff}.label--annotation.label.label--invert.label[_ngcontent-%COMP%]   .label__header[_ngcontent-%COMP%]{border-color:#eee}.label--annotation.label.label--invert.label[_ngcontent-%COMP%]   .label__body[_ngcontent-%COMP%]{color:#eee}.label--classic.label--glow[_ngcontent-%COMP%]   .label__glow[_ngcontent-%COMP%]{background-color:rgba(0,0,0,.2);display:block;-webkit-animation:classic-glow 4s infinite;animation:classic-glow 4s infinite}.label--classic.label[_ngcontent-%COMP%]   .label__wire[_ngcontent-%COMP%]{border-top:1px solid #666}.label--classic.label[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]{min-width:10px;color:#eee}.label--classic.label[_ngcontent-%COMP%]   .label__title[_ngcontent-%COMP%]{border-bottom:1px solid #666;min-height:18px;width:100%;padding-bottom:4px;color:#000}.label--classic.label[_ngcontent-%COMP%]   .label__body[_ngcontent-%COMP%]{padding-top:4px;color:#333}.label--context.label[_ngcontent-%COMP%]{pointer-events:none}.label--context.label--glow[_ngcontent-%COMP%]   .label__glow[_ngcontent-%COMP%]{background-color:hsla(0,0%,100%,.3);display:block;-webkit-animation:classic-glow 4s infinite;animation:classic-glow 4s infinite}.label--context.label[_ngcontent-%COMP%]   .label__pin[_ngcontent-%COMP%], .label--context.label[_ngcontent-%COMP%]   .label__wire[_ngcontent-%COMP%]{display:none}.label--context.label[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]{background:hsla(0,0%,100%,.7);border:1px solid rgba(16,24,35,.5);box-shadow:0 0 24px rgba(16,24,35,.1);padding:4px 8px;border-radius:4px}.label--context.label[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]:hover{background:hsla(0,0%,100%,.8);cursor:-webkit-grab;cursor:grab}.label--context.label[_ngcontent-%COMP%]   .label__title[_ngcontent-%COMP%]{font-weight:600;color:#101823}.label--context.label[_ngcontent-%COMP%]   .label__body[_ngcontent-%COMP%]{margin-top:8px;border-top:1px solid #eaeff5;color:#101823;overflow-x:hidden;padding-top:8px}.label--context.label[_ngcontent-%COMP%]   .label__body[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-weight:700}.label--context.label[_ngcontent-%COMP%]   .label__body[_ngcontent-%COMP%]   em[_ngcontent-%COMP%]{font-style:italic}"],changeDetection:0}),$p([Object(d.d)(is.getEnginePosition),qp("design:type",q.a)],e.prototype,"enginePosition$",void 0),$p([Object(d.d)(Bo.getSelectedChapterBackground),qp("design:type",q.a)],e.prototype,"background$",void 0),e})();var cd=n("lR5k"),ld=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function pd(e,t){if(1&e&&i.Qb(0,"app-node-actions",7),2&e){const e=i.gc(2);i.lc("node",e.node)}}function dd(e,t){if(1&e&&(i.Vb(0,"div",5),i.jc(1),i.Kc(2,pd,1,1,"app-node-actions",6),i.Ub()),2&e){const e=i.gc();i.Db(2),i.lc("ngIf",e.enableActions)}}function ud(e,t){if(1&e){const e=i.Wb();i.Vb(0,"a",10),i.cc("click",(function(){return i.zc(e),i.gc(2).handleReadMoreClick()})),i.Mc(1,"Read More..."),i.Ub()}2&e&&i.lc("@show",void 0)}function gd(e,t){if(1&e&&(i.Tb(0,8),i.Kc(1,ud,2,1,"a",9),i.Sb()),2&e){const e=i.gc();i.Db(1),i.lc("ngIf",e.node&&e.node.description)}}const hd=["*"];let bd=(()=>{class e{constructor(e,t,n,i,o){this.store=e,this.actions=t,this.engineService=n,this.viewService=i,this.changeDetectorRef=o,this.ngUnsubscribe=new $.a}set label(e){this._label=e,this.setLabelNode()}get label(){return this._label}ngOnInit(){this.initInfoListeners()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}setLabelNode(){const e=Object(X.get)(this.label,"objectId");if(e){const t=this.store.selectSnapshot(is.getViewGraph);this.node=this.engineService.getNode(t,e)}else this.node=null;this.changeDetectorRef.markForCheck()}initInfoListeners(){this.actions.pipe(Object(d.i)(qe),Object(W.a)(this.ngUnsubscribe)).subscribe(()=>{this.setLabelNode()})}handleReadMoreClick(){this.node&&this.viewService.toggleNodeInfo(!0)}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.g),i.Pb(d.b),i.Pb(lt),i.Pb(Ip),i.Pb(i.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-context-label"]],inputs:{label:"label",enableInfo:"enableInfo",enableActions:"enableActions"},ngContentSelectors:hd,decls:6,vars:6,consts:[[1,"context-label",3,"label"],["label-header","",1,"html",3,"innerHTML"],["title",""],["class","context-label__actions","label-actions","",4,"ngIf"],["label-more","",4,"ngIf"],["label-actions","",1,"context-label__actions"],["eventCategory","Context Node","theme","light",3,"node",4,"ngIf"],["eventCategory","Context Node","theme","light",3,"node"],["label-more",""],["class","context-label__more",3,"click",4,"ngIf"],[1,"context-label__more",3,"click"]],template:function(e,t){1&e&&(i.kc(),i.Vb(0,"app-generic-label",0),i.Qb(1,"div",1,2),i.hc(3,"markdown"),i.Kc(4,dd,3,1,"div",3),i.Kc(5,gd,2,1,"ng-container",4),i.Ub()),2&e&&(i.lc("label",t.label),i.Db(1),i.lc("innerHTML",i.ic(3,4,t.label.title),i.Ac),i.Db(3),i.lc("ngIf",t.node),i.Db(1),i.lc("ngIf",t.enableInfo))},directives:[ad,ms.l,yc],pipes:[cd.b],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3838}.text-info[_ngcontent-%COMP%]{color:#0060c4}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.context-label__actions[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}.context-label__action[_ngcontent-%COMP%]{cursor:pointer}.context-label__action--selected[_ngcontent-%COMP%]{color:#0060c4}.context-label__more[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em;cursor:pointer;display:block;line-height:24px;overflow:hidden}.context-label__more[_ngcontent-%COMP%]:hover{text-decoration:underline}"],data:{animation:[Object(ol.n)("show",[Object(ol.m)(":enter",[Object(ol.j)([Object(ol.l)({height:"0"}),Object(ol.e)("125ms ease-in-out",Object(ol.l)({height:"*"}))])])])]},changeDetection:0}),function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);s>3&&r&&Object.defineProperty(t,n,r)}([Object(d.d)(is.getQuerying),ld("design:type",q.a)],e.prototype,"querying$",void 0),e})();var md=function(e){return e.Normal="normal",e.Compact="compact",e}({}),fd=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},yd=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const xd=["image"],vd=["imagePre"],wd=["imagePost"],Od=["imageContainer"];function Cd(e,t){if(1&e&&(i.Qb(0,"span",8),i.hc(1,"markdown")),2&e){const e=i.gc();i.lc("innerHTML",i.ic(1,1,e.label),i.Ac)}}function Sd(e,t){if(1&e&&i.Qb(0,"img",9,10),2&e){const e=i.gc();i.lc("src",e.imageUrl,i.Cc)}}function kd(e,t){if(1&e&&i.Qb(0,"img",11,12),2&e){const e=i.gc();i.lc("src",e.imageUrl,i.Cc)}}let _d=(()=>{class e{constructor(e,t,n){this.renderer=e,this.engineService=t,this.animationService=n,this.ngUnsubscribe=new $.a,this.loopImage=!1}ngOnInit(){this.initChapterListener(),this.initTimelineListener()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initChapterListener(){this.selectedChapterId$.pipe(Object(K.a)(e=>null!=e),Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.timerange=this.animationService.getChapterLocalTimerange(e)})}initTimelineListener(){Object(ss.a)(this.engineService.getEvent(it.TimelineScrubbed),this.engineService.getEvent(it.TimelinePlaying)).pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{const t=this.getChapterPercent(e.time);this.moveImage(t)})}moveImage(e){const t=this.image.nativeElement.getBoundingClientRect().width;this.renderer.setStyle(this.imageContainer.nativeElement,"transform",`translate(${e/100*-t}px, 0)`),this.loopImage&&(this.renderer.setStyle(this.imagePre.nativeElement,"transform",`translate(${-t}px, 0)`),this.renderer.setStyle(this.imagePost.nativeElement,"transform",`translate(${t}px, 0)`))}getChapterPercent(e){const{firstTime:t,lastTime:n}=this.timerange,i=this.animationService.mapGlobalTimeToLocal(e).time;return Math.max(t,Math.min(i,n))/n*100}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(i.H),i.Pb(lt),i.Pb(Do))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-ticker-block-item"]],viewQuery:function(e,t){if(1&e&&(i.Gc(xd,!0),i.Rc(vd,!0),i.Rc(wd,!0),i.Gc(Od,!0)),2&e){let e;i.uc(e=i.dc())&&(t.image=e.first),i.uc(e=i.dc())&&(t.imagePre=e.first),i.uc(e=i.dc())&&(t.imagePost=e.first),i.uc(e=i.dc())&&(t.imageContainer=e.first)}},inputs:{label:"label",imageUrl:"imageUrl",loopImage:"loopImage"},decls:8,vars:4,consts:[[1,"ticker-block-item"],["class","ticker-block-item__label html",3,"innerHTML",4,"ngIf"],[1,"ticker-block__image-container"],["imageContainer",""],["class","ticker-block-item__image ticker-block-item__image--pre",3,"src",4,"ngIf"],["class","ticker-block-item__image ticker-block-item__image--post",3,"src",4,"ngIf"],[1,"ticker-block-item__image",3,"src"],["image",""],[1,"ticker-block-item__label","html",3,"innerHTML"],[1,"ticker-block-item__image","ticker-block-item__image--pre",3,"src"],["imagePre",""],[1,"ticker-block-item__image","ticker-block-item__image--post",3,"src"],["imagePost",""]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Kc(1,Cd,2,3,"span",1),i.Vb(2,"div",2,3),i.Kc(4,Sd,2,1,"img",4),i.Kc(5,kd,2,1,"img",5),i.Qb(6,"img",6,7),i.Ub(),i.Ub()),2&e&&(i.Db(1),i.lc("ngIf",t.label),i.Db(3),i.lc("ngIf",t.loopImage),i.Db(1),i.lc("ngIf",t.loopImage),i.Db(1),i.lc("src",t.imageUrl,i.Cc))},directives:[ms.l],pipes:[cd.b],styles:['.ticker-block-item[_ngcontent-%COMP%]{background:#f9fafd;background:linear-gradient(90deg,#f9fafd 20%,hsla(0,0%,100%,0) 40%,#fff 60%,#f9fafd 80%);overflow:hidden;padding-left:50%;position:relative}.ticker-block-item[_ngcontent-%COMP%]:hover   .ticker-block-item__label[_ngcontent-%COMP%]{background:hsla(0,0%,100%,.9)}.ticker-block-item[_ngcontent-%COMP%]:after{content:"";display:block;position:absolute;left:50%;top:0;height:100%;width:1px;background:red;box-shadow:0 0 0 4px rgba(255,0,0,.2);z-index:10}.ticker-block-item__label[_ngcontent-%COMP%]{position:absolute;z-index:10;left:4px;top:4px;border-radius:8px;padding:2px 6px;font-size:12px;border:1px solid rgba(16,24,35,.5);background:hsla(0,0%,100%,.55)}.ticker-block-item__image-container[_ngcontent-%COMP%]{position:relative}.ticker-block-item__image[_ngcontent-%COMP%]{display:block}.ticker-block-item__image--post[_ngcontent-%COMP%], .ticker-block-item__image--pre[_ngcontent-%COMP%]{position:absolute;top:0;left:0}'],changeDetection:0}),fd([Object(d.d)(is.getAnimationPlaying),yd("design:type",q.a)],e.prototype,"animationPlaying$",void 0),fd([Object(d.d)(Bo.getSelectedChapterId),yd("design:type",q.a)],e.prototype,"selectedChapterId$",void 0),e})();function jd(e,t){if(1&e&&i.Qb(0,"app-ticker-block-item",3),2&e){const e=t.$implicit,n=i.gc(2);i.lc("imageUrl",e.urls.default)("label",e.caption)("loopImage",n.tickerBlock.loopImage)}}function Pd(e,t){if(1&e&&(i.Vb(0,"div",1),i.Kc(1,jd,1,3,"app-ticker-block-item",2),i.Ub()),2&e){const e=i.gc();i.Db(1),i.lc("ngForOf",e.tickerBlock.images)}}let Md=(()=>{class e{constructor(){this.ngUnsubscribe=new $.a}ngOnInit(){}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-ticker-block"]],inputs:{tickerBlock:"tickerBlock"},decls:1,vars:1,consts:[["class","ticker-block",4,"ngIf"],[1,"ticker-block"],[3,"imageUrl","label","loopImage",4,"ngFor","ngForOf"],[3,"imageUrl","label","loopImage"]],template:function(e,t){1&e&&i.Kc(0,Pd,2,1,"div",0),2&e&&i.lc("ngIf",t.tickerBlock)},directives:[ms.l,ms.k,_d],styles:[""],changeDetection:0}),e})(),Id=(()=>{class e{constructor(e,t){this.domSanitizer=e,this.markdownService=t}set html(e){this.safeHTML=this.domSanitizer.bypassSecurityTrustHtml(e||"")}set markdownText(e){this.html=this.markdownService.compile(e,!0)}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(l.b),i.Pb(cd.c))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-html"]],inputs:{html:"html",markdownText:"markdownText"},decls:1,vars:1,consts:[[1,"html",3,"innerHTML"]],template:function(e,t){1&e&&i.Qb(0,"div",0),2&e&&i.lc("innerHTML",t.safeHTML,i.Ac)},styles:[""],encapsulation:2,changeDetection:0}),e})(),zd=(()=>{class e{constructor(){this.layout=md.Normal}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-markdown-block"]],inputs:{markdownBlock:"markdownBlock",layout:"layout"},decls:2,vars:1,consts:[[1,"markdown-block"],[3,"markdownText"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Qb(1,"app-html",1),i.Ub()),2&e&&(i.Db(1),i.lc("markdownText",t.markdownBlock.markdown))},directives:[Id],styles:[""],encapsulation:2,changeDetection:0}),e})();var Td=n("0IaG");function Ud(e,t){if(1&e&&i.Qb(0,"app-icon",5),2&e){const e=i.gc();i.lc("icon",e.icon)}}function Ld(e,t){if(1&e&&i.Qb(0,"span",6),2&e){const e=i.gc();i.Hc("background-image","url("+e.src+")")}}function Dd(e,t){if(1&e&&(i.Vb(0,"div",7),i.Mc(1),i.Ub()),2&e){const e=i.gc();i.Db(1),i.Oc(" ",e.label," ")}}const Ed=function(e,t,n,i,o,s,r,a,c,l,p,d,u){return{"pin-button--selected":e,"pin-button--disabled":t,"pin-button--small":n,"pin-button--medium":i,"pin-button--large":o,"pin-button--ghost":s,"pin-button--primary":r,"pin-button--secondary":a,"pin-button--outline":c,"pin-button--floating":l,"pin-button--dark":p,"pin-button--row":d,"pin-button--fill":u}},Fd=["*"];let Ad=(()=>{class e{constructor(){this.selectable=!1,this.size="medium",this.buttonType="default",this.direction="column",this.fill=!1,this._selected=!1,this.disabled=!1,this.selectedChange=new i.p}get selected(){return this._selected}set selected(e){this._selected=e,this.selectedChange=new i.p}ngOnInit(){}handleClick(){this.disabled||this.selectable&&(this.selected=!this.selected)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-pin-button"],["button","app-pin-button",""]],inputs:{icon:"icon",src:"src",description:"description",label:"label",selectable:"selectable",size:"size",buttonType:"buttonType",direction:"direction",fill:"fill",selected:"selected",disabled:"disabled"},outputs:{selectedChange:"selectedChange"},ngContentSelectors:Fd,decls:6,vars:18,consts:[[1,"pin-button",3,"ngClass","click"],[1,"pin-button__pin"],["style","font-size: 14px !important",3,"icon",4,"ngIf"],["class","pin-button__image",3,"backgroundImage",4,"ngIf"],["class","pin-button__label",4,"ngIf"],[2,"font-size","14px !important",3,"icon"],[1,"pin-button__image"],[1,"pin-button__label"]],template:function(e,t){1&e&&(i.kc(),i.Vb(0,"div",0),i.cc("click",(function(){return t.handleClick()})),i.Vb(1,"div",1),i.Kc(2,Ud,1,1,"app-icon",2),i.Kc(3,Ld,1,2,"span",3),i.jc(4),i.Ub(),i.Kc(5,Dd,2,1,"div",4),i.Ub()),2&e&&(i.lc("ngClass",i.tc(4,Ed,[t.selected,t.disabled,"small"===t.size,"medium"===t.size,"large"===t.size,"ghost"===t.buttonType,"primary"===t.buttonType,"secondary"===t.buttonType,"outline"===t.buttonType,"floating"===t.buttonType,"dark"===t.buttonType,"row"===t.direction,t.fill])),i.Db(2),i.lc("ngIf",t.icon),i.Db(1),i.lc("ngIf",t.src),i.Db(2),i.lc("ngIf",t.label))},directives:[ms.i,ms.l,$a],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3838}.text-info{color:#0060c4}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}button[app-pin-button]{border-color:transparent;background:none;border-width:0;padding:0;outline:none;margin:0;pointer-events:all}button[app-pin-button]::-moz-focus-inner{border:0}button[app-pin-button]:not([disabled]):hover{cursor:pointer}button[app-pin-button]:focus :not(.pin-button--selected) .pin-button__pin{background:#f1f4fa;outline:none}button[app-pin-button]:focus :not(.pin-button--selected).pin-button--dark .pin-button__pin{background-color:#6a82a4!important}button[app-pin-button][disabled]{pointer-events:none}.pin-button{display:inline-flex;flex-flow:column;align-items:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-tap-highlight-color:rgba(0,0,0,0);-webkit-tap-highlight-color:transparent}.pin-button:hover{cursor:pointer}.pin-button:hover:not(.pin-button--selected):not(.pin-button--disabled) .pin-button__pin{background:rgba(215,224,234,.6);background:var(--pin-button-pin-background--hover)}.pin-button:not(.pin-button--selected):active:hover .pin-button__pin{background:#d7e0ea;background:var(--pin-button-pin-background--active)}.pin-button--selected .pin-button__pin{background-color:#2d72dc;background-color:var(--pin-button-pin-background--selected);color:#fff;color:var(--pin-button-pin-color--selected)}.pin-button--selected .pin-button__label{color:#2d72dc;color:var(--pin-button-label-color--selected);font-weight:600}.pin-button--small .pin-button__pin{border-radius:14px;min-width:28px;height:28px}.pin-button--small .pin-button__label{margin-top:0}.pin-button--large .pin-button__pin{font-size:20px;letter-spacing:.5px;line-height:1.4em}.pin-button--row{flex-direction:row}.pin-button--row .pin-button__label{margin:0 0 0 4px}.pin-button--ghost:not(.pin-button--selected) .pin-button__pin{background:transparent}.pin-button--outline:not(.pin-button--selected) .pin-button__pin{background:transparent;border:var(--pin-button-pin-border)}.pin-button--primary .pin-button__pin{background:var(--pin-button-pin-background--primary);color:var(--pin-button-pin-color--primary)}.pin-button--primary:not(.pin-button--selected):not(.pin-button--disabled) .pin-button__pin{background:#de3838;color:#fff;background:var(--pin-button-pin-background--primary)!important;color:var(--pin-button-pin-color--primary)!important}.pin-button--primary:not(.pin-button--selected):not(.pin-button--disabled):hover .pin-button__pin{background:#e24e4e;background:var(--pin-button-pin-background--primary-hover)!important}.pin-button--secondary .pin-button__pin{background:#0060c4;color:#fff;background:var(--pin-button-pin-background--secondary);color:var(--pin-button-pin-color--secondary)}.pin-button--secondary:not(.pin-button--selected):not(.pin-button--disabled) .pin-button__pin{background:#0060c4;color:#fff;background:var(--pin-button-pin-background--secondary)!important;color:var(--pin-button-pin-color--secondary)!important}.pin-button--secondary:not(.pin-button--selected):not(.pin-button--disabled):hover .pin-button__pin{background:#006cde;background:var(--pin-button-pin-background--secondary-hover)!important}.pin-button--disabled{opacity:.2}.pin-button--disabled:hover{cursor:auto}.pin-button--fill{width:100%;height:100%}.pin-button--fill .pin-button__pin{width:100%;height:100%;border-radius:50%}.pin-button--floating .pin-button__pin{background-color:#fff;background-color:var(--pin-button-pin-background--floating)}.pin-button--dark .pin-button__pin,.pin-button--floating .pin-button__pin{box-shadow:1px -1px 2px 0 rgba(28,42,63,.1),0 1px 2px 0 rgba(28,42,63,.3);box-shadow:var(--pin-button-shadow)}.pin-button--dark .pin-button__pin{color:#f9fafd;color:var(--pin-button-pin-color--dark);background-color:#1c2a3f!important;background-color:var(--pin-button-pin-background--dark)!important}.pin-button__pin{border-radius:20px;display:flex;font-size:12px;float:left;min-width:40px;height:40px;align-items:center;justify-content:center;position:relative;background-color:#eaeff5;color:#1c2a3f;background-color:var(--pin-button-pin-background);color:var(--pin-button-pin-color);transition:background-color 125ms}.pin-button__label{font-size:10px;letter-spacing:.25px;line-height:1.4em;color:#1c2a3f;color:var(--pin-button-label-color);padding:2px 0 4px}.pin-button__image{width:100%;height:100%;background-size:50%;background-repeat:no-repeat;background-position:50%}"],encapsulation:2,changeDetection:0}),e})();var Rd=n("Qu3c");function Nd(e,t){if(1&e&&(i.Vb(0,"div",3),i.Mc(1),i.Ub()),2&e){const e=i.gc();i.Db(1),i.Oc(" ",e.label," ")}}const Vd=function(e,t,n){return[e,t,n]};var Hd=function(e){return e.Small="small",e.Medium="medium",e.Large="large",e.Huge="huge",e}({}),Bd=function(e){return e.Horizontal="horizontal",e.Vertical="vertical",e}({}),Qd=function(e){return e.Inline="inline",e.Block="block",e.Fill="fill",e}({});let $d=(()=>{class e{constructor(){this.size=Hd.Medium,this.label="",this.direction=Bd.Horizontal,this.render=Qd.Fill}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-spinner"]],inputs:{size:"size",label:"label",direction:"direction",render:"render"},decls:3,vars:6,consts:[[1,"spinner","spinner--horizontal",3,"ngClass"],[1,"spinner__circle"],["class","spinner__label",4,"ngIf"],[1,"spinner__label"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Qb(1,"div",1),i.Kc(2,Nd,2,1,"div",2),i.Ub()),2&e&&(i.lc("ngClass",i.qc(2,Vd,"spinner--"+t.size,"spinner--"+t.render,"spinner--"+t.direction)),i.Db(2),i.lc("ngIf",t.label.length))},directives:[ms.i,ms.l],styles:['@-webkit-keyframes spinner{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}@keyframes spinner{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}.spinner[_ngcontent-%COMP%]{display:inline-flex;justify-content:center;align-items:center}.spinner--small[_ngcontent-%COMP%]   .spinner__circle[_ngcontent-%COMP%], .spinner--small[_ngcontent-%COMP%]   .spinner__circle[_ngcontent-%COMP%]:after{width:11px;height:11px}.spinner--small[_ngcontent-%COMP%]   .spinner__label[_ngcontent-%COMP%]{font-size:10px}.spinner--medium[_ngcontent-%COMP%]   .spinner__circle[_ngcontent-%COMP%], .spinner--medium[_ngcontent-%COMP%]   .spinner__circle[_ngcontent-%COMP%]:after{width:14px;height:14px}.spinner--medium[_ngcontent-%COMP%]   .spinner__label[_ngcontent-%COMP%]{font-size:10px}.spinner--large[_ngcontent-%COMP%]   .spinner__circle[_ngcontent-%COMP%], .spinner--large[_ngcontent-%COMP%]   .spinner__circle[_ngcontent-%COMP%]:after{width:28px;height:28px}.spinner--large[_ngcontent-%COMP%]   .spinner__label[_ngcontent-%COMP%]{font-size:14px}.spinner--huge[_ngcontent-%COMP%]   .spinner__circle[_ngcontent-%COMP%], .spinner--huge[_ngcontent-%COMP%]   .spinner__circle[_ngcontent-%COMP%]:after{width:44px;height:44px}.spinner--huge[_ngcontent-%COMP%]   .spinner__label[_ngcontent-%COMP%]{font-size:16px}.spinner--horizontal[_ngcontent-%COMP%]{flex-direction:row}.spinner--vertical[_ngcontent-%COMP%]{align-items:center;flex-direction:column}.spinner--vertical[_ngcontent-%COMP%]   .spinner__label[_ngcontent-%COMP%]{padding:8px 0 0}.spinner--inline[_ngcontent-%COMP%]{display:inline-flex}.spinner--block[_ngcontent-%COMP%]{display:flex}.spinner--fill[_ngcontent-%COMP%]{display:flex;height:100%}.spinner__circle[_ngcontent-%COMP%]{width:14px;height:14px;border-radius:50%;border:2px solid rgba(16,24,35,.1);position:relative}.spinner__circle[_ngcontent-%COMP%]:after{-webkit-animation:spinner .4s linear infinite;animation:spinner .4s linear infinite;content:" ";border-radius:50%;border-color:hsla(0,0%,100%,.2) rgba(16,24,35,.2) transparent transparent;border-style:solid;border-width:2px;box-sizing:border-box;position:absolute;display:block;width:14px;height:14px;top:-2px;left:-2px}.spinner__label[_ngcontent-%COMP%]{padding-left:8px;font-size:14px;text-transform:uppercase}.theme-dark[_nghost-%COMP%]   .spinner__label[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .spinner__label[_ngcontent-%COMP%]{color:hsla(0,0%,100%,.2)}.theme-light[_nghost-%COMP%]   .spinner__label[_ngcontent-%COMP%], .theme-light   [_nghost-%COMP%]   .spinner__label[_ngcontent-%COMP%]{color:rgba(16,24,35,.2)}'],changeDetection:0}),e})();function qd(e,t){1&e&&(i.Vb(0,"div",4),i.Qb(1,"app-spinner",5),i.Ub())}let Wd=(()=>{class e{constructor(e,t,n){this.dialogRef=e,this.data=t,this.changeRef=n,this.config=t}ngOnInit(){}handleCloseClick(){this.dialogRef.close()}handleImageLoaded(){this.imageLoaded=!0,this.changeRef.markForCheck()}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(Td.g),i.Pb(Td.a),i.Pb(i.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-image-dialog"]],decls:4,vars:4,consts:[[1,"dialog",3,"click"],["class","dialog__loading flex flex-column p-8",4,"ngIf"],[1,"dialog__image",3,"src","title","alt","load"],["app-pin-button","","buttonType","dark","size","large","icon","times","aria-label","Close","matTooltip","Close","matTooltipPosition","left",1,"dialog__close"],[1,"dialog__loading","flex","flex-column","p-8"],["size","huge"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.cc("click",(function(){return t.handleCloseClick()})),i.Kc(1,qd,2,0,"div",1),i.Vb(2,"img",2),i.cc("load",(function(){return t.handleImageLoaded()})),i.Ub(),i.Qb(3,"button",3),i.Ub()),2&e&&(i.Db(1),i.lc("ngIf",!t.imageLoaded),i.Db(1),i.lc("src",t.config.src,i.Cc)("title",t.config.title||"")("alt",t.config.alt||""))},directives:[ms.l,Ad,Rd.c,$d],styles:[".dialog[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;width:100%}.dialog__loading[_ngcontent-%COMP%]{position:absolute}.dialog__image[_ngcontent-%COMP%]{max-width:100%;max-height:100vh}.dialog__close[_ngcontent-%COMP%]{position:fixed;top:24px;right:24px}"],changeDetection:0}),e})();var Kd=function(e){return e.ClipboardDialog="ClipboardDialog",e.WelcomeTourDialog="WelcomeTourDialog",e.JoinDomainDialog="JoinDomainDialog",e.NpsSurveyDialog="NpsSurveyDialog",e.ConfirmDialog="ConfirmDialog",e.LimitDialog="LimitDialog",e.UpgradeDialog="UpgradeDialog",e.BuyDialog="BuyDialog",e.ProfileDialog="ProfileDialog",e.SaveModuleDialog="SaveModuleDialog",e.SaveBookmarkDialog="SaveBookmarkDialog",e.SaveAsBookmarkDialog="SaveAsBookmarkDialog",e.ManageDialog="ManageDialog",e.BookmarkAccessDialog="BookmarkAccessDialog",e.GroupRestrictionDialog="GroupRestrictionDialog",e.PremiumContentDialog="PremiumContentDialog",e.AboutDialog="AboutDialog",e.ImportDialog="ImportDialog",e.AddTeamModelDialog="AddTeamModelDialog",e.ImageDialog="ImageDialog",e.QuizSettingsDialog="QuizSettingsDialog",e.AssignUserRoleDialog="AssignUserRoleDialog",e.TransferUserContentDialog="TransferUserContentDialog",e.RemoveUserDialog="RemoveUserDialog",e}({});const Gd=["imageView"];let Zd=(()=>{class e{constructor(e){this.dialog=e,this.fit="normal",this.fullscreenEnabled=!1}ngOnInit(){}handleFullscreen(e){this.dialog.open(Wd,{id:Kd.ImageDialog,backdropClass:"bd-dialog-backdrop",panelClass:"bd-dialog-panel",disableClose:!1,data:{src:this.fullscreenSrc||this.src,alt:this.alt||""}}),e.stopPropagation()}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(Td.b))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-image-view"]],viewQuery:function(e,t){if(1&e&&i.Gc(Gd,!0),2&e){let e;i.uc(e=i.dc())&&(t.imageView=e.first)}},inputs:{fit:"fit",fitSize:"fitSize",src:"src",fullscreenSrc:"fullscreenSrc",alt:"alt"},decls:5,vars:8,consts:[[1,"image-view"],["imageView",""],[1,"image-view__image",3,"src","alt"],["role","button","matTooltip","Expand",1,"image-view__overlay",3,"click"],["icon","expand-alt",1,"image-view__icon"]],template:function(e,t){1&e&&(i.Vb(0,"div",0,1),i.Qb(2,"img",2),i.Vb(3,"div",3),i.cc("click",(function(e){return t.handleFullscreen(e)})),i.Qb(4,"app-icon",4),i.Ub(),i.Ub()),2&e&&(i.Hb("image-view--auto-fit","auto"===t.fit),i.Db(2),i.Hc("max-width","auto"===t.fit&&t.fitSize?t.fitSize+"px":"100%")("max-height","auto"===t.fit&&t.fitSize?t.fitSize+"px":"100%"),i.lc("src",t.src,i.Cc)("alt",t.alt))},directives:[Rd.c,$a],styles:[".image-view[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:inherit;position:relative;background-color:#f9fafd}.image-view__image[_ngcontent-%COMP%]{width:auto;height:auto}.image-view--auto-fit[_ngcontent-%COMP%]   .image-view__image[_ngcontent-%COMP%]{max-width:100%;height:auto}.image-view__overlay[_ngcontent-%COMP%]{background:rgba(28,42,63,.3);color:#fff;display:flex;flex-direction:row;align-items:center;justify-content:center;padding:8px;position:absolute;top:0;bottom:0;left:0;right:0;opacity:0;transition:opacity .25s}.image-view__icon[_ngcontent-%COMP%]{text-shadow:0 0 2px rgba(0,0,0,.6)}.image-view[_ngcontent-%COMP%]:hover{cursor:pointer}.image-view[_ngcontent-%COMP%]:hover   .image-view__overlay[_ngcontent-%COMP%]{opacity:1}"],changeDetection:0}),e})();function Jd(e,t){if(1&e&&(i.Vb(0,"div",6),i.Qb(1,"app-image-view",7),i.Ub()),2&e){const e=i.gc(2);i.Db(1),i.lc("src",e.currentImage.urls.small)("fullscreenSrc",e.currentImage.urls.default)("alt",e.currentImage.alt)("fit",e.fit)("fitSize",e.fitSize)}}function Xd(e,t){if(1&e&&i.Qb(0,"app-html",8),2&e){const e=i.gc(2);i.lc("markdownText",e.currentImage.caption)}}function Yd(e,t){if(1&e){const e=i.Wb();i.Vb(0,"div",9),i.Vb(1,"button",10),i.cc("click",(function(){return i.zc(e),i.gc(2).handlePrevClick()})),i.Ub(),i.Vb(2,"button",11),i.cc("click",(function(){return i.zc(e),i.gc(2).handleNextClick()})),i.Ub(),i.Ub()}}function eu(e,t){if(1&e&&(i.Vb(0,"div",1),i.Vb(1,"div",2),i.Kc(2,Jd,2,5,"div",3),i.Kc(3,Xd,1,1,"app-html",4),i.Kc(4,Yd,3,0,"div",5),i.Ub(),i.Ub()),2&e){const e=i.gc();i.Hb("images-block--slideshow",e.images&&e.images.length>1),i.Db(2),i.lc("ngIf",e.currentImage.urls),i.Db(1),i.lc("ngIf",e.currentImage.caption),i.Db(1),i.lc("ngIf",e.images.length>1)}}let tu=(()=>{class e{constructor(){this.layout=md.Normal}get imagesBlock(){return this._imagesBlock}set imagesBlock(e){this._imagesBlock=e;const t=Object(X.get)(e,"images",[]);t.length&&(this.images=t,this.currentImage=this.images[0])}get fit(){return"compact"===this.layout?"auto":"normal"}get fitSize(){return"compact"===this.layout?100:void 0}ngOnInit(){}handlePrevClick(){let e=this.getCurrentImageIndex();e--,e<0&&(e=this.images.length-1),this.currentImage=this.images[e]}handleNextClick(){let e=this.getCurrentImageIndex();e++,e>=this.images.length&&(e=0),this.currentImage=this.images[e]}getCurrentImageIndex(){return this.images.indexOf(this.currentImage)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-images-block"]],inputs:{imagesBlock:"imagesBlock",layout:"layout"},decls:1,vars:1,consts:[["class","images-block",3,"images-block--slideshow",4,"ngIf"],[1,"images-block"],[1,"images-block__content"],["class","images-block__image-container",4,"ngIf"],["class","images-block__caption",3,"markdownText",4,"ngIf"],["class","images-block__actions",4,"ngIf"],[1,"images-block__image-container"],[1,"images-block__image-view",3,"src","fullscreenSrc","alt","fit","fitSize"],[1,"images-block__caption",3,"markdownText"],[1,"images-block__actions"],["gaEvent","","gaAction","Clicked Previous Image","app-pin-button","","icon","chevron-left","size","small","buttonType","ghost","matTooltip","Previous Image",3,"click"],["gaEvent","","gaAction","Clicked Next Image","app-pin-button","","icon","chevron-right","size","small","buttonType","ghost","matTooltip","Next Image",3,"click"]],template:function(e,t){1&e&&i.Kc(0,eu,5,5,"div",0),2&e&&i.lc("ngIf",t.currentImage)},directives:[ms.l,Zd,Id,Ad,Rd.c],styles:[".images-block__header{display:flex;align-items:center;justify-content:space-between;margin-bottom:16px}.images-block__label{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase;color:var(--view-panel-color);font-weight:600;display:flex;align-items:center;min-height:28px}.images-block__image-container{display:flex;justify-content:center;background-color:#f9fafd;margin-bottom:12px}.images-block__image-view{display:flex;height:100%}.images-block__caption{font-size:12px}.images-block__actions{display:flex;justify-content:flex-end;margin-top:14px}.images-block--slideshow .images-block__image-container{height:200px}"],encapsulation:2,changeDetection:0}),e})();function nu(e,t){if(1&e&&i.Qb(0,"app-ticker-block",6),2&e){const e=i.gc().$implicit;i.lc("tickerBlock",e)}}function iu(e,t){if(1&e&&i.Qb(0,"app-markdown-block",7),2&e){const e=i.gc().$implicit,t=i.gc(2);i.lc("markdownBlock",e)("layout",t.layout)}}function ou(e,t){if(1&e&&i.Qb(0,"app-images-block",8),2&e){const e=i.gc().$implicit,t=i.gc(2);i.lc("imagesBlock",e)("layout",t.layout)}}function su(e,t){if(1&e&&(i.Vb(0,"div"),i.Tb(1,2),i.Kc(2,nu,1,1,"app-ticker-block",3),i.Kc(3,iu,1,2,"app-markdown-block",4),i.Kc(4,ou,1,2,"app-images-block",5),i.Sb(),i.Ub()),2&e){const e=t.$implicit;i.Hb("mv-2",t.index>0),i.Db(1),i.lc("ngSwitch",e.type),i.Db(1),i.lc("ngSwitchCase","ticker"),i.Db(1),i.lc("ngSwitchCase","markdown"),i.Db(1),i.lc("ngSwitchCase","images")}}function ru(e,t){if(1&e&&(i.Tb(0),i.Kc(1,su,5,6,"div",1),i.Sb()),2&e){const e=i.gc();i.Db(1),i.lc("ngForOf",e.contentBlocks)}}let au=(()=>{class e{constructor(){this._contentBlocks=[],this.layout=md.Normal,this.include=[],this.exclude=[]}get contentBlocks(){return this._contentBlocks.filter(e=>!this.include.length||this.include.includes(e.type)).filter(e=>!this.exclude.length||!this.exclude.includes(e.type))}set contentBlocks(e){this._contentBlocks=e}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-content-blocks"]],inputs:{contentBlocks:"contentBlocks",layout:"layout",include:"include",exclude:"exclude"},decls:1,vars:1,consts:[[4,"ngIf"],[3,"mv-2",4,"ngFor","ngForOf"],[3,"ngSwitch"],[3,"tickerBlock",4,"ngSwitchCase"],[3,"markdownBlock","layout",4,"ngSwitchCase"],[3,"imagesBlock","layout",4,"ngSwitchCase"],[3,"tickerBlock"],[3,"markdownBlock","layout"],[3,"imagesBlock","layout"]],template:function(e,t){1&e&&i.Kc(0,ru,2,1,"ng-container",0),2&e&&i.lc("ngIf",t.contentBlocks.length>0)},directives:[ms.l,ms.k,ms.n,ms.o,Md,zd,tu],styles:[""],encapsulation:2,changeDetection:0}),e})();var cu=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},lu=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function pu(e,t){if(1&e&&(i.Vb(0,"div",6),i.Qb(1,"app-content-blocks",7),i.Ub()),2&e){const e=i.gc();i.Db(1),i.lc("contentBlocks",e.label.contentBlocks)("layout","compact")}}function du(e,t){if(1&e&&(i.Qb(0,"div",8),i.hc(1,"markdown")),2&e){const e=i.gc();i.lc("innerHTML",i.ic(1,1,e.label.description),i.Ac)}}let uu=(()=>{class e{constructor(e,t,n,i){this.store=e,this.labelsService=t,this.engineService=n,this.changeDetectorRef=i,this.emitEvents=!0,this.collapsedMode=Ji.None,this.collapsed=!1,this.pinDraggable=!1,this.tagDraggable=!1,this.descriptionCollapsed=!1,this.tagCollapsed=!1,this.ngUnsubscribe=new $.a}get isCollapsed(){if(this.collapsedMode===Ji.Toggle){const e=this.store.selectSnapshot(Tr.getSelectedLabelId)===this.label.id;return this.collapsed&&!e}return this.collapsed}get hasContent(){return this.labelsService.hasContent(this.label)}ngOnInit(){this.selectedLabel$.pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(e=>this.handleLabelSelected(e)),this.store.select(Tr.getChapterLabels).pipe(Object(W.a)(this.ngUnsubscribe),Object(cs.a)(100)).subscribe(()=>{this.sequence=this.store.selectSnapshot(Tr.getLabelSequence(this.label)),this.changeDetectorRef.markForCheck()}),this.descriptionCollapsed=this.label.collapseDescription,this.tagCollapsed=this.label.hideTag}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}handleLabelUpdated(e){const{label:t,shouldPreserve:n}=e;this.store.dispatch(new ao(t,n))}handleOffsetUpdated(e){const{labelId:t,offset:n}=e;this.store.dispatch(new Yi(t,n))}handlePinClicked(e){this.selectLabel()}handleTagClicked(e){this.selectLabel()}selectLabel(){const e=this.store.selectSnapshot(Tr.getSelectedLabel);this.store.dispatch(new po(e&&e.id===this.label.id?null:this.label)),this.emitEngineEvent(it.HotspotsPicked,{id:this.label.id}),this.emitEngineEvent(it.LabelsPicked,{labelId:this.label.id})}emitEngineEvent(e,t){this.emitEvents&&this.engineService.fireEvent(e,t)}handleDisplayUpdated(e){this.emitEngineEvent(it.HotspotsDisplayUpdated,e)}handlePositionUpdated(e){this.emitEngineEvent(it.HotspotsPositionUpdated,e.positionUpdate),this.emitEngineEvent(it.LabelsMoved,{labelId:e.positionUpdate.id,canvasPosition:[e.positionUpdate.canvasPos.x,e.positionUpdate.canvasPos.y],occluded:e.positionUpdate.occluded||!e.onCanvas})}handleHoverStart(e){this.emitEngineEvent(it.HotspotsEntered,{id:e.labelId}),this.emitEngineEvent(it.LabelsEntered,{labelId:e.labelId})}handleHoverEnd(e){this.emitEngineEvent(it.HotspotsLeft,{id:e.labelId}),this.emitEngineEvent(it.LabelsLeft,{labelId:e.labelId})}handleLabelSelected(e){const t=e&&e.id===this.label.id,n=Object(X.get)(e,"states[1].errands"),i=this.store.selectSnapshot(Ko.getLockCamera);t&&n&&!i&&n.forEach(e=>{switch(e.type){case Fn.flyToObject:this.store.dispatch(new fe(e.value));break;case Fn.flyToCamera:this.store.dispatch(new bt(e.value))}this.store.dispatch(new Pt(!0))}),this.tagCollapsed=!(this.label.title||this.hasContent)||(this.label.expandTag&&this.label.hideTag?!t:this.label.hideTag),this.descriptionCollapsed=this.label.showDescription&&this.label.collapseDescription?!t:this.label.collapseDescription}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.g),i.Pb(Bn),i.Pb(lt),i.Pb(i.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-story-label"]],inputs:{label:"label",emitEvents:"emitEvents",collapsedMode:"collapsedMode",collapsed:"collapsed",pinDraggable:"pinDraggable",tagDraggable:"tagDraggable"},decls:9,vars:18,consts:[[3,"label","selected","scale","sequence","isCollapsed","tagCollapsed","pinDraggable","tagDraggable","descriptionCollapsed","hasContent","labelUpdated","offsetUpdated","tagClicked","pinClicked","displayUpdated","positionUpdated","hoverStart","hoverEnd"],["label-header","",1,"html",3,"innerHTML"],["title",""],["label-body","",1,"html"],["class","mv-1","appEventFence","",4,"ngIf"],["data-test","labelDescription",3,"innerHTML",4,"ngIf"],["appEventFence","",1,"mv-1"],[3,"contentBlocks","layout"],["data-test","labelDescription",3,"innerHTML"]],template:function(e,t){if(1&e&&(i.Vb(0,"app-generic-label",0),i.cc("labelUpdated",(function(e){return t.handleLabelUpdated(e)}))("offsetUpdated",(function(e){return t.handleOffsetUpdated(e)}))("tagClicked",(function(e){return t.handleTagClicked(e)}))("pinClicked",(function(e){return t.handlePinClicked(e)}))("displayUpdated",(function(e){return t.handleDisplayUpdated(e)}))("positionUpdated",(function(e){return t.handlePositionUpdated(e)}))("hoverStart",(function(e){return t.handleHoverStart(e)}))("hoverEnd",(function(e){return t.handleHoverEnd(e)})),i.hc(1,"async"),i.hc(2,"async"),i.Qb(3,"div",1,2),i.hc(5,"markdown"),i.Vb(6,"div",3),i.Kc(7,pu,2,2,"div",4),i.Kc(8,du,2,3,"div",5),i.Ub(),i.Ub()),2&e){let e=null;i.lc("label",t.label)("selected",(null==(e=i.ic(1,12,t.selectedLabel$))?null:e.id)===t.label.id)("scale",i.ic(2,14,t.labelScale$))("sequence",t.sequence)("isCollapsed",t.isCollapsed)("tagCollapsed",t.tagCollapsed)("pinDraggable",t.tagDraggable)("descriptionCollapsed",t.descriptionCollapsed)("hasContent",t.hasContent),i.Db(3),i.lc("innerHTML",i.ic(5,16,t.label.title),i.Ac),i.Db(4),i.lc("ngIf",t.label.contentBlocks),i.Db(1),i.lc("ngIf",t.label.description)}},directives:[ad,ms.l,Qa,au],pipes:[ms.b,cd.b],styles:[""],changeDetection:0}),cu([Object(d.d)(Tr.getLabelScale),lu("design:type",q.a)],e.prototype,"labelScale$",void 0),cu([Object(d.d)(Tr.getSelectedLabel),lu("design:type",q.a)],e.prototype,"selectedLabel$",void 0),e})();var gu=n("3Pt+");let hu=(()=>{class e{constructor(e){this.controlContainer=e}get control(){return this.formControl||this.controlContainer.control.get(this.formControlName)}registerOnTouched(e){this.formControlDirective.valueAccessor.registerOnTouched(e)}registerOnChange(e){this.formControlDirective.valueAccessor.registerOnChange(e)}writeValue(e){this.formControlDirective.valueAccessor.writeValue(e)}setDisabledState(e){this.formControlDirective.valueAccessor.setDisabledState(e)}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(gu.b))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-base-accessor-control"]],viewQuery:function(e,t){if(1&e&&i.Gc(gu.f,!0),2&e){let e;i.uc(e=i.dc())&&(t.formControlDirective=e.first)}},inputs:{formControl:"formControl",formControlName:"formControlName"},decls:0,vars:0,template:function(e,t){},encapsulation:2}),e})(),bu=(()=>{class e{constructor(){}get value(){return this._value}set value(e){Object(X.isEqual)(this._value,e)||(this._value=e,this.setFormValues(e),this.onChange(e))}onChange(e){}onTouched(){}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}writeValue(e){this.value=e}setDisabledState(e){this.disabled=e}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-abstract-input-control"]],inputs:{value:"value",disabled:"disabled"},decls:0,vars:0,template:function(e,t){},encapsulation:2}),e})();function mu(e,t){if(1&e&&(i.Vb(0,"option",9),i.Mc(1),i.Ub()),2&e){const e=t.$implicit;i.lc("value",e.value),i.Db(1),i.Oc(" ",e.label.title," ")}}function fu(e,t){if(1&e&&(i.Vb(0,"select",6),i.Vb(1,"option",7),i.Mc(2,"Select"),i.Ub(),i.Kc(3,mu,2,2,"option",8),i.Ub()),2&e){const e=i.gc();i.Db(3),i.lc("ngForOf",e.options)}}let yu=(()=>{class e extends bu{constructor(e,t){super(),this.formBuilder=e,this.changeRef=t,this.outline=!0,this.valueChange=new i.p,this.ngUnsubscribe=new $.a,this.form=this.formBuilder.group({value:[""]}),this.valueControl=this.form.get("value")}get options(){return this._options}set options(e){const t=Object(X.clone)(e);this._options=t.sort((e,t)=>e.label.title.localeCompare(t.label.title)),this.changeRef.markForCheck()}ngOnInit(){this.initFormListeners()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initFormListeners(){this.form.valueChanges.pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(({value:e})=>{this.writeValue(e),this.valueChange.next(e)})}setDisabledState(e){super.setDisabledState(e),e?this.form.disable():this.form.enable(),this.changeRef.markForCheck()}setFormValues(e){this.valueControl.setValue(e),this.changeRef.markForCheck()}getSelectedOption(){const e=this.valueControl.value;return this.options.find(t=>t.value===e)}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(gu.d),i.Pb(i.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-quiz-label-anatomy-select"]],inputs:{options:"options",outline:"outline"},outputs:{valueChange:"valueChange"},features:[i.Cb([{provide:gu.k,useExisting:Object(i.W)(()=>e),multi:!0}]),i.Ab],decls:7,vars:5,consts:[[1,"label",3,"formGroup"],[1,"label__select-label","flex","text-12"],[1,"flex","justify-between","p-2",2,"flex","1"],[1,"mr-2"],["icon","caret-down","size","lg"],["class","input label__select","placeholder","Select Option","formControlName","value","data-test","quizLabelSelect",4,"ngIf"],["placeholder","Select Option","formControlName","value","data-test","quizLabelSelect",1,"input","label__select"],["value","","data-test","questionAnswerOption"],["class","label__option","data-test","questionAnswerOption",3,"value",4,"ngFor","ngForOf"],["data-test","questionAnswerOption",1,"label__option",3,"value"]],template:function(e,t){if(1&e&&(i.Vb(0,"div",0),i.Vb(1,"label",1),i.Vb(2,"div",2),i.Vb(3,"div",3),i.Mc(4),i.Ub(),i.Qb(5,"app-icon",4),i.Ub(),i.Kc(6,fu,4,1,"select",5),i.Ub(),i.Ub()),2&e){let e=null;i.Hb("label--empty",""===t.valueControl.value),i.lc("formGroup",t.form),i.Db(4),i.Nc((null==(e=t.getSelectedOption())||null==e.label?null:e.label.title)||"Select"),i.Db(2),i.lc("ngIf",!t.disabled)}},directives:[gu.n,gu.h,$a,ms.l,gu.r,gu.m,gu.g,gu.p,gu.s,ms.k],styles:[".label[_ngcontent-%COMP%]{overflow:hidden}.label__select-label[_ngcontent-%COMP%]{color:#101823;position:relative}.label__select[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;opacity:.01}.label--empty[_ngcontent-%COMP%]   .label__select-label[_ngcontent-%COMP%]{color:#96a8c0}"],changeDetection:0}),e})();function xu(e,t){1&e&&i.Qb(0,"app-icon",8)}function vu(e,t){1&e&&i.Qb(0,"app-icon",9)}function wu(e,t){if(1&e&&(i.Vb(0,"div",4),i.Kc(1,xu,1,0,"app-icon",5),i.Kc(2,vu,1,0,"app-icon",6),i.Vb(3,"div",7),i.Mc(4),i.Ub(),i.Ub()),2&e){const e=i.gc();let t=null;i.lc("ngSwitch",e.correct),i.Db(1),i.lc("ngSwitchCase",!0),i.Db(1),i.lc("ngSwitchCase",!1),i.Db(2),i.Oc(" ",null==(t=e.getSelectedLabel(e.options,e.control.value))?null:t.title," ")}}let Ou=(()=>{class e extends hu{constructor(){super(...arguments),this.sequence=0,this.labelUpdated=new i.p}ngOnInit(){}handleLabelUpdated(e){this.labelUpdated.next(e.label)}handleOffsetUpdated(e){this.labelUpdated.next(Object.assign(Object.assign({},this.option.label),{offset:e.offset}))}getSelectedLabel(e,t){const n=this.options.find(e=>e.value===t);return n?n.label:void 0}}return e.\u0275fac=function(t){return Cu(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-quiz-label"]],inputs:{sequence:"sequence",collapsed:"collapsed",options:"options",option:"option",correct:"correct",mode:"mode"},outputs:{labelUpdated:"labelUpdated"},features:[i.Cb([{provide:gu.k,useExisting:Object(i.W)(()=>e),multi:!0}]),i.Ab],decls:4,vars:14,consts:[[1,"label","theme-light",3,"label","fit","opaque","pinDraggable","tagDraggable","isCollapsed","descriptionCollapsed","hasContent","sequence","labelUpdated","offsetUpdated"],["label-body","",1,"label__body"],[3,"outline","hidden","options","formControl"],["class","label__summary flex items-start",3,"ngSwitch",4,"ngIf"],[1,"label__summary","flex","items-start",3,"ngSwitch"],["class","label__icon label__icon--correct","style","font-size: 16px","icon","check-circle",4,"ngSwitchCase"],["class","label__icon label__icon--incorrect","style","font-size: 16px","icon","times-circle",4,"ngSwitchCase"],[1,"pl-2","text-12","text-semibold"],["icon","check-circle",1,"label__icon","label__icon--correct",2,"font-size","16px"],["icon","times-circle",1,"label__icon","label__icon--incorrect",2,"font-size","16px"]],template:function(e,t){1&e&&(i.Vb(0,"app-generic-label",0),i.cc("labelUpdated",(function(e){return t.handleLabelUpdated(e)}))("offsetUpdated",(function(e){return t.handleOffsetUpdated(e)})),i.Vb(1,"div",1),i.Qb(2,"app-quiz-label-anatomy-select",2),i.Kc(3,wu,5,4,"div",3),i.Ub(),i.Ub()),2&e&&(i.lc("label",t.option.label)("fit","summary"===t.mode?"fixed":"auto")("opaque",!0)("pinDraggable","edit"===t.mode)("tagDraggable","edit"===t.mode)("isCollapsed",t.collapsed)("descriptionCollapsed",!1)("hasContent",!0)("sequence",t.sequence),i.Db(2),i.lc("outline",!1)("hidden","summary"===t.mode)("options",t.options)("formControl",t.control),i.Db(1),i.lc("ngIf","summary"===t.mode))},directives:[ad,yu,gu.m,gu.f,ms.l,ms.n,ms.o,$a],styles:[".label__body[_ngcontent-%COMP%]{color:#101823;min-width:160px;max-width:200px}.label__icon[_ngcontent-%COMP%]{position:relative;flex:0 0 20px;justify-content:center}.label__icon--correct[_ngcontent-%COMP%]{color:#73b676}.label__icon--incorrect[_ngcontent-%COMP%]{color:#cb4039}"],changeDetection:0}),e})();const Cu=i.Xb(Ou);var Su=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},ku=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function _u(e,t){if(1&e){const e=i.Wb();i.Tb(0),i.Vb(1,"app-quiz-label",3),i.cc("labelUpdated",(function(n){i.zc(e);const o=t.index;return i.gc().handleLabelUpdated(n,o)})),i.hc(2,"async"),i.hc(3,"async"),i.hc(4,"async"),i.hc(5,"async"),i.hc(6,"async"),i.Ub(),i.Sb()}if(2&e){const e=t.$implicit,n=t.index,o=i.gc();i.Db(1),i.lc("mode",o.mode)("formControl",e)("option",i.ic(2,7,o.quizLabels$)[n])("options",i.ic(3,9,o.quizLabels$))("sequence",n+1)("correct",o.isCorrect(i.ic(4,11,o.quizLabels$)[n],i.ic(5,13,o.activeSubmitted$),n))("collapsed",i.ic(6,15,o.labelsCollapsed$))}}let ju=(()=>{class e{constructor(e,t,n,i){this.store=e,this.formBuilder=t,this.changeRef=n,this.router=i,this.ngUnsubscribe=new $.a,this.mode="edit",this.form=this.formBuilder.group({options:this.formBuilder.array([])}),this.optionsArray=this.form.get("options")}ngOnInit(){this.initFormListeners(),this.initQuizSubmissionListeners()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initFormListeners(){this.quizLabels$.pipe(Object(ls.a)((e,t)=>{const n=e.map(e=>e.value),i=t.map(e=>e.value);return Object(X.isEqual)(n,i)}),Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{const t=this.store.selectSnapshot(Bi.getQuizModeActive);this.buildFormOptions(e,t),this.changeRef.markForCheck()}),Object(rs.b)([this.quizModeActive$,this.quizLabels$]).pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(([e])=>{this.setFormEnabled(e),this.changeRef.markForCheck()})}initQuizSubmissionListeners(){this.activeSubmission$.pipe(Object(K.a)(e=>!Object(X.isNil)(e)&&!Object(X.isNil)(e.answer)&&Array.isArray(e.answer)),Object(ls.a)((e,t)=>Object(X.isEqual)(e,t)),Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{const t=this.form.value.options,n=e.answer;Object(X.isEqual)(t,n)||(this.form.patchValue({options:n},{emitEvent:!1,onlySelf:!0}),this.changeRef.markForCheck())}),this.form.valueChanges.pipe(Object(ls.a)((e,t)=>Object(X.isEqual)(e,t)),Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{const t=this.store.selectSnapshot(Bi.getActiveQuestionId),n=this.store.selectSnapshot(Bi.getActiveSubmitted),i=this.store.selectSnapshot(Bi.getActiveSubmission),o=Object(X.isNil)(i)?[]:i.answer,s=e.options;Object(X.isNil)(n)&&(Object(X.isEqual)(s,o)||this.store.dispatch(new ji.SetActiveSubmission({questionId:t,answer:s})),this.changeRef.markForCheck())}),Object(rs.b)([this.quizModeActive$,this.activeSubmitted$]).subscribe(([e,t])=>{const n=this.router.url.includes("/edit");this.mode=n?"edit":e&&!Object(X.isNil)(t)?"summary":"view",this.changeRef.markForCheck()})}isCorrect(e,t,n){if(!Object(X.isNil)(t))return t.answer[n]===e.value}handleLabelUpdated(e,t){const n=this.store.selectSnapshot(Bi.getActiveQuestion);n.data.options[t].label=e,this.store.dispatch(new ji.SetQuestion(n))}buildFormOptions(e,t){this.optionsArray.clear(),e.forEach(e=>{this.optionsArray.push(this.formBuilder.control(t?"":e.value))})}setFormEnabled(e){e?this.optionsArray.enable():this.optionsArray.disable()}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.g),i.Pb(gu.d),i.Pb(i.i),i.Pb(Z.e))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-quiz-labels"]],decls:3,vars:2,consts:[["data-test","quizLabelsElement",3,"formGroup"],["formArrayName","options"],[4,"ngFor","ngForOf"],["data-test","appQuizLabel",3,"mode","formControl","option","options","sequence","correct","collapsed","labelUpdated"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Vb(1,"div",1),i.Kc(2,_u,7,17,"ng-container",2),i.Ub(),i.Ub()),2&e&&(i.lc("formGroup",t.form),i.Db(2),i.lc("ngForOf",t.optionsArray.controls))},directives:[gu.n,gu.h,gu.c,ms.k,Ou,gu.m,gu.f],pipes:[ms.b],styles:[""],changeDetection:0}),Su([Object(d.d)(Tr.getLabelsCollapsed),ku("design:type",q.a)],e.prototype,"labelsCollapsed$",void 0),Su([Object(d.d)(Bi.getActiveQuestionLabels),ku("design:type",q.a)],e.prototype,"quizLabels$",void 0),Su([Object(d.d)(Bi.getQuizModeActive),ku("design:type",q.a)],e.prototype,"quizModeActive$",void 0),Su([Object(d.d)(Bi.getAllSubmissions),ku("design:type",q.a)],e.prototype,"allSubmissions$",void 0),Su([Object(d.d)(Bi.getActiveSubmission),ku("design:type",q.a)],e.prototype,"activeSubmission$",void 0),Su([Object(d.d)(Bi.getActiveSubmitted),ku("design:type",q.a)],e.prototype,"activeSubmitted$",void 0),e})();var Pu=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},Mu=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Iu(e,t){if(1&e&&(i.Qb(0,"app-context-label",5),i.hc(1,"async"),i.hc(2,"async"),i.hc(3,"async"),i.hc(4,"async"),i.hc(5,"async")),2&e){const e=i.gc(3);let t=null,n=null;i.lc("label",i.ic(1,3,e.contextLabel$))("enableInfo",i.ic(2,5,e.enableContextLabelInfo$)&&(null==(t=i.ic(3,7,e.layout$))?null:t.nodeInfo.enable))("enableActions",i.ic(4,9,e.enableContextLabelActions$)&&(null==(n=i.ic(5,11,e.layout$))?null:n.contextActions.enable))}}function zu(e,t){if(1&e&&(i.Tb(0),i.Qb(1,"app-story-label",6),i.hc(2,"async"),i.hc(3,"async"),i.hc(4,"async"),i.hc(5,"async"),i.Sb()),2&e){const e=t.$implicit,n=i.gc(3);let o=null,s=null;i.Db(1),i.Hb("labels__label--hidden",!e.shown),i.lc("pinDraggable",null==(o=i.ic(2,7,n.draggable$))?null:o.pin)("tagDraggable",null==(s=i.ic(3,9,n.draggable$))?null:s.tag)("label",e)("collapsed",i.ic(4,11,n.labelsCollapsed$))("collapsedMode",i.ic(5,13,n.labelsCollapsedMode$))}}function Tu(e,t){if(1&e&&(i.Tb(0),i.Kc(1,Iu,6,13,"app-context-label",3),i.hc(2,"async"),i.hc(3,"async"),i.Kc(4,zu,6,15,"ng-container",4),i.hc(5,"async"),i.Sb()),2&e){const e=i.gc(2);i.Db(1),i.lc("ngIf",i.ic(2,3,e.enableContextLabel$)&&i.ic(3,5,e.contextLabel$)),i.Db(3),i.lc("ngForOf",i.ic(5,7,e.labels$))("ngForTrackBy",e.trackLabel)}}function Uu(e,t){1&e&&(i.Tb(0),i.Qb(1,"app-quiz-labels"),i.Sb())}function Lu(e,t){if(1&e&&(i.Vb(0,"div",1),i.Kc(1,Tu,6,9,"ng-container",2),i.hc(2,"async"),i.Kc(3,Uu,2,0,"ng-container",2),i.Ub()),2&e){const e=i.gc();i.Db(1),i.lc("ngIf",i.ic(2,2,e.showLabels$)),i.Db(2),i.lc("ngIf",e.showQuizLabels)}}let Du=(()=>{class e{constructor(e,t,n,i,o,s,r,a){this.store=e,this.action$=t,this.router=n,this.engineService=i,this.cameraService=o,this.changeDetector=s,this.labelsService=r,this.elRef=a,this.interactive=!1,this.showQuizLabels=!1,this.ngUnsubscribe=new $.a}ngOnInit(){this.bindEngineEvents(),this.bindApplicationEvents(),this.labelsService.setLabelContainer(this.elRef)}ngOnDestroy(){this.labelsService.setLabelContainer(null),this.changeDetector.detach(),this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}bindApplicationEvents(){this.action$.pipe(Object(d.j)(be),Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.handleClickNode(e)}),this.labels$.pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.changeDetector.markForCheck()}),this.selectedLabel$.pipe(Object(K.a)(e=>null==e),Object(W.a)(this.ngUnsubscribe)).subscribe(()=>{const e=this.store.selectSnapshot(Ko.getZoomed),t=this.store.selectSnapshot(Ko.getLockCamera);e&&!t&&this.resetCamera()}),Object(rs.b)([this.activeTool$,this.activeQuestion$]).pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(([e,t])=>{const n=this.router.url.indexOf("/edit")>=0,i=Object(X.get)(t,"type")===Mi.LabelAnatomy;this.showQuizLabels=n?e===Go.Quiz&&i:i,this.changeDetector.markForCheck()}),this.store.select(Bo.getSelectedChapterReadyState).pipe(Object(K.a)(e=>null!=e),Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.interactive=e.model,this.changeDetector.markForCheck()})}bindEngineEvents(){this.action$.pipe(Object(d.j)(Se,mo),Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.engineService.fireEvent(e.show?it.LabelsEnabled:it.LabelsDisabled,null)}),this.action$.pipe(Object(d.j)(to),Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.engineService.fireEvent(it.LabelsCreated,e.label)}),this.action$.pipe(Object(d.j)(ao),Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.engineService.fireEvent(it.LabelsUpdated,e.label)}),this.action$.pipe(Object(d.j)(bo),Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{e.labels.forEach(t=>{this.engineService.fireEvent(e.shown?it.LabelsShown:it.LabelsHidden,{labelId:t.id})})}),this.action$.pipe(Object(d.j)(oo),Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.engineService.fireEvent(it.LabelsDestroyed,e.label)})}handleClickNode(e){const t=this.store.selectSnapshot(is.getActiveTool);null!=e.node?t===Go.Label?this.addLabel(e.hit,e.node):setTimeout(()=>{this.toggleContextLabel(e.hit,e.node)}):(this.store.dispatch(new po(null)),this.store.dispatch(new so))}addLabel(e,t){const n=this.cameraService.getDirection(e),i=this.getLabelDefaults(e.objectId),o=i.hideWire?20:32;i.title=t.label,i.offset=[o,0],i.objectId=e.objectId,i.barycentric=[e.barycentric[0],e.barycentric[1],e.barycentric[2]],i.pos=[e.worldPos[0],e.worldPos[1],e.worldPos[2]],i.primitiveIndex=e.primitiveIndex,i.renderableIndex=e.renderableIndex||0,i.dir=n,i.chapterId=this.store.selectSnapshot(Bo.getSelectedChapter).id,i.occludable=!0,i.shown=!0,this.store.dispatch(new to(i)),this.store.dispatch(new po(i))}toggleContextLabel(e,t){if(this.store.selectSnapshot(ii.getCheckedNodeIds).some(e=>e===t.id)){const n=this.cameraService.getDirection(e),i=this.labelsService.makeDefaultStudioLabel();i.theme=wn.Context,i.title=t.label,i.offset=[32,0],i.objectId=e.objectId,i.barycentric=[e.barycentric[0],e.barycentric[1],e.barycentric[2]],i.pos=[e.worldPos[0],e.worldPos[1],e.worldPos[2]],i.primitiveIndex=e.primitiveIndex,i.dir=n,i.occludable=!1,this.store.dispatch(new no(i))}else this.store.dispatch(new so)}getLabelDefaults(e){let t=this.store.selectSnapshot(Tr.getSelectedLabel);if(null==t){let e=this.store.selectSnapshot(Tr.getChapterLabels);e&&0!==e.length||(e=this.store.selectSnapshot(Tr.getLabels)),e.length&&(t=Object(X.cloneDeep)(e[e.length-1]))}if(null!=t){const n=this.labelsService.makeDefaultStudioLabel();switch(n.hideWire=t.hideWire,n.pinGlow=t.pinGlow,n.pinType=t.pinType,n.theme=t.theme,n.sequentialType=t.sequentialType,n.states[0].errands[0]=new Vn,Object(X.get)(t,"states[1].errands[0].type")){case Fn.flyToObject:case Fn.flyToCamera:n.states[1].errands[0]=new An(e)}return n}{const t=this.labelsService.makeDefaultStudioLabel();return t.states[0].errands[0]=new Vn,t.states[1].errands[0]=new An(e),t}}trackLabel(e,t){const{id:n,shown:i,theme:o}=t;return`${n}${i}${o}`}resetCamera(){const e=this.store.selectSnapshot(Bo.getSelectedChapter);Object(X.get)(e,"camera.location")&&this.store.dispatch(new bt(e.camera.location))}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.g),i.Pb(d.b),i.Pb(Z.e),i.Pb(lt),i.Pb(Lt),i.Pb(i.i),i.Pb(Bn),i.Pb(i.m))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-labels"]],decls:1,vars:1,consts:[["class","labels","data-test","labelsElement",4,"ngIf"],["data-test","labelsElement",1,"labels"],[4,"ngIf"],[3,"label","enableInfo","enableActions",4,"ngIf"],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"label","enableInfo","enableActions"],["data-test","appStoryLabel",1,"labels__label",3,"pinDraggable","tagDraggable","label","collapsed","collapsedMode"]],template:function(e,t){1&e&&i.Kc(0,Lu,4,4,"div",0),2&e&&i.lc("ngIf",t.interactive)},directives:[ms.l,ms.k,bd,uu,ju],pipes:[ms.b],styles:["[_nghost-%COMP%]{position:relative}.labels[_ngcontent-%COMP%], [_nghost-%COMP%]{width:100%;height:100%;display:block}.labels[_ngcontent-%COMP%]{position:absolute;left:0;top:0;z-index:2;pointer-events:none}.labels__label--hidden[_ngcontent-%COMP%]{display:none}"],changeDetection:0}),Pu([Object(d.d)(il.getUI),Mu("design:type",q.a)],e.prototype,"layout$",void 0),Pu([Object(d.d)(Tr.getChapterLabels),Mu("design:type",q.a)],e.prototype,"labels$",void 0),Pu([Object(d.d)(Bi.getQuizModeActive),Mu("design:type",q.a)],e.prototype,"quizModeActive$",void 0),Pu([Object(d.d)(is.getActiveTool),Mu("design:type",q.a)],e.prototype,"activeTool$",void 0),Pu([Object(d.d)(Bi.getActiveQuestion),Mu("design:type",q.a)],e.prototype,"activeQuestion$",void 0),Pu([Object(d.d)(Bo.getSelectedChapter),Mu("design:type",q.a)],e.prototype,"selectedChapter$",void 0),Pu([Object(d.d)(Tr.getSelectedLabel),Mu("design:type",q.a)],e.prototype,"selectedLabel$",void 0),Pu([Object(d.d)(Tr.getLabelsCollapsed),Mu("design:type",q.a)],e.prototype,"labelsCollapsed$",void 0),Pu([Object(d.d)(Tr.getLabelsCollapsedMode),Mu("design:type",q.a)],e.prototype,"labelsCollapsedMode$",void 0),Pu([Object(d.d)(Tr.getContextLabel),Mu("design:type",q.a)],e.prototype,"contextLabel$",void 0),Pu([Object(d.d)(is.getShowLabels),Mu("design:type",q.a)],e.prototype,"showLabels$",void 0),Pu([Object(d.d)(Ko.getZoomed),Mu("design:type",q.a)],e.prototype,"zoomed$",void 0),Pu([Object(d.d)(Tr.getEnableContextLabel),Mu("design:type",q.a)],e.prototype,"enableContextLabel$",void 0),Pu([Object(d.d)(Tr.getEnableContextLabelInfo),Mu("design:type",q.a)],e.prototype,"enableContextLabelInfo$",void 0),Pu([Object(d.d)(Tr.getEnableContextLabelActions),Mu("design:type",q.a)],e.prototype,"enableContextLabelActions$",void 0),Pu([Object(d.d)(Tr.getLabelsDraggable),Mu("design:type",q.a)],e.prototype,"draggable$",void 0),e})();function Eu(e,t){if(1&e){const e=i.Wb();i.Vb(0,"div",1),i.cc("@show.done",(function(){return i.zc(e),i.gc().onShowDone()})),i.Vb(1,"div",2),i.Mc(2," Use control + scroll to zoom "),i.Ub(),i.Ub()}2&e&&i.lc("@show",void 0)}let Fu=(()=>{class e{constructor(e,t){this.actions=e,this.changeDetectorRef=t,this.ngUnsubscribe=new $.a,this.show=!1}ngOnInit(){this.actions.pipe(Object(d.j)(re),Object(W.a)(this.ngUnsubscribe)).subscribe(()=>{this.show=!0,this.changeDetectorRef.markForCheck()})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}onShowDone(){this.show=!1}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.b),i.Pb(i.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-engine-scroll"]],decls:1,vars:1,consts:[["class","engine-scroll","data-test","engineScroll",4,"ngIf"],["data-test","engineScroll",1,"engine-scroll"],[1,"engine-scroll__label"]],template:function(e,t){1&e&&i.Kc(0,Eu,3,1,"div",0),2&e&&i.lc("ngIf",t.show)},directives:[ms.l],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3838}.text-info[_ngcontent-%COMP%]{color:#0060c4}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.engine-scroll[_ngcontent-%COMP%]{display:flex;position:absolute;justify-content:center;align-items:center;top:0;bottom:0;left:0;right:0;z-index:10000;opacity:0;pointer-events:none}.engine-scroll__label[_ngcontent-%COMP%]{background:rgba(16,24,35,.5);font-size:16px;letter-spacing:.4px;line-height:1.4em;color:#fff;font-weight:600;padding:24px 32px;border-radius:40px}"],data:{animation:[Object(ol.n)("show",[Object(ol.m)(":enter",[Object(ol.j)([Object(ol.l)({opacity:"*"}),Object(ol.e)("500ms ease-in-out",Object(ol.l)({opacity:1})),Object(ol.e)("500ms 2000ms ease-in-out",Object(ol.l)({opacity:0}))])])])]},changeDetection:0}),e})();const Au=function(e,t){return{backgroundColor:e,duration:t}},Ru=function(e,t){return{value:e,params:t}},Nu=Object(ol.g)([Object(ol.l)({opacity:"0",backgroundColor:"*"}),Object(ol.j)([Object(ol.e)("{{ duration }}ms {{ easing }}",Object(ol.l)({opacity:1,backgroundColor:"{{ backgroundColor }}"})),Object(ol.e)("250ms 500ms ease-in",Object(ol.l)({opacity:0}))])],{params:{duration:2e3,backgroundColor:"#ffffff",easing:"ease-out"}});let Vu=(()=>{class e{constructor(e,t,n){this.actions=e,this.changeDetectorRef=t,this.store=n,this.color="#FFFFFF",this.duration=2e3,this.isVisible=!1,this.ngUnsubscribe=new $.a}ngOnInit(){this.initFadeListener()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initFadeListener(){this.actions.pipe(Object(d.j)(ce),Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.fadeIn(e.color,e.duration)})}handleFadeComplete(){this.store.dispatch(new le),this.isVisible=!1,this.changeDetectorRef.markForCheck()}fadeIn(e,t){this.isVisible=!0,this.color=e,this.duration=1e3*t,this.changeDetectorRef.markForCheck()}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.b),i.Pb(i.i),i.Pb(d.g))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-engine-fade"]],decls:1,vars:7,consts:[[1,"engine-fade"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.cc("@fade.done",(function(){return t.handleFadeComplete()})),i.Ub()),2&e&&i.lc("@fade",i.pc(4,Ru,t.isVisible,i.pc(1,Au,t.color,t.duration)))},styles:[".engine-fade{pointer-events:none;display:block;position:absolute;left:0;right:0;top:0;bottom:0;z-index:10000}"],encapsulation:2,data:{animation:[Object(ol.n)("fade",[Object(ol.m)("* => true",Object(ol.o)(Nu))])]},changeDetection:0}),e})(),Hu=(()=>{class e{constructor(e){this.store=e}ngOnInit(){}ngAfterViewInit(){this.nodeActionsComponent.nodeActionsTrigger.openMenu()}onNodeActionsClosed(){this.store.dispatch(new me(null,null))}getNodeActionsStyles(){return{"left.px":this.hit?this.hit.canvasPos[0]:0,"top.px":this.hit?this.hit.canvasPos[1]:0}}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.g))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-engine-contextmenu"]],viewQuery:function(e,t){if(1&e&&i.Gc(yc,!0),2&e){let e;i.uc(e=i.dc())&&(t.nodeActionsComponent=e.first)}},inputs:{node:"node",hit:"hit"},decls:2,vars:2,consts:[[1,"contextmenu"],["eventCategory","Context Node","theme","light",1,"contextmenu__node-actions",3,"ngStyle","node","nodeActionsClosed"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Vb(1,"app-node-actions",1),i.cc("nodeActionsClosed",(function(){return t.onNodeActionsClosed()})),i.Ub(),i.Ub()),2&e&&(i.Db(1),i.lc("ngStyle",t.getNodeActionsStyles())("node",t.node))},directives:[yc,ms.m],styles:[".contextmenu[_ngcontent-%COMP%]{left:0;top:0;width:100%;height:100%;display:block;z-index:2}.contextmenu[_ngcontent-%COMP%], .contextmenu__node-actions[_ngcontent-%COMP%]{position:absolute}"]}),e})();const Bu=function(e){return{"progress__bar--complete":e}},Qu=function(e){return{width:e}};let $u=(()=>{class e{constructor(e,t){this.router=e,this.changeDetector=t,this.total=100,this._value=0,this.percentWidth=0,this.ngUnsubscribe=new $.a}get value(){return this._value}set value(e){this._value=e,this.percentWidth=this.value/this.total*100,this.changeDetector.markForCheck()}ngOnInit(){this.router.events.pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{e instanceof Z.d&&(this.value=0)})}ngOnDestroy(){this.changeDetector.detach(),this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(Z.e),i.Pb(i.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-progress"]],inputs:{total:"total",value:"value"},decls:2,vars:6,consts:[[1,"progress"],[1,"progress__bar",3,"ngClass","ngStyle"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Qb(1,"div",1),i.Ub()),2&e&&(i.Db(1),i.lc("ngClass",i.oc(2,Bu,100===t.percentWidth))("ngStyle",i.oc(4,Qu,t.percentWidth+"%")))},directives:[ms.i,ms.m],styles:["@-webkit-keyframes progressSuccess{0%{width:100%!important;background:#38de38}50%{opacity:1;background:#38de38}to{opacity:0}}@keyframes progressSuccess{0%{width:100%!important;background:#38de38}50%{opacity:1;background:#38de38}to{opacity:0}}.progress[_ngcontent-%COMP%]{border-radius:0 1px 1px 0;display:flex;align-items:center;height:4px;width:100%}.progress__bar[_ngcontent-%COMP%]{background:#de3838;height:100%;width:0}.progress__bar--complete[_ngcontent-%COMP%]{-webkit-animation:progressSuccess 2s linear forwards;animation:progressSuccess 2s linear forwards}"],changeDetection:0}),e})(),qu=(()=>{class e{constructor(e,t){this.store=e,this.changeDetectorRef=t,this.ngUnsubscribe=new $.a,this.storyLoadProgress=0}ngOnInit(){const e=this.store.select(Pl.getChunkLoadProgress),t=this.store.select(Qr.getLoadingChunk);Object(rs.b)(e,t).pipe(Object(K.a)(()=>{const e=this.store.selectSnapshot(Qr.getLoadChunks);return null!==e&&e.length>0}),Object(W.a)(this.ngUnsubscribe)).subscribe(([e,t])=>{const n=null!==t&&t.chapterId===this.store.selectSnapshot(Bo.getSelectedChapterId);this.storyLoadProgress=n?e:1,this.changeDetectorRef.markForCheck()})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.g),i.Pb(i.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-engine-progress"]],decls:1,vars:2,consts:[["data-test","engineProgress",1,"engine-progress",3,"value","total"]],template:function(e,t){1&e&&i.Qb(0,"app-progress",0),2&e&&i.lc("value",t.storyLoadProgress)("total",1)},directives:[$u],styles:[".engine-progress[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;z-index:2;pointer-events:none}"],changeDetection:0}),e})(),Wu=(()=>{class e{constructor(e,t){this.engineService=e,this.changeDetectionRef=t,this.camera={x:0,y:0,z:0,dist:0}}ngOnInit(){this.initCameraListener()}initCameraListener(){this.engineService.getEvent(it.CameraUpdated).pipe(Object(ds.a)(50)).subscribe(e=>{this.camera={x:e.eye.x.toFixed(0),y:e.eye.y.toFixed(0),z:e.eye.z.toFixed(0),dist:e.dist.toFixed(0)},this.changeDetectionRef.markForCheck()})}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(lt),i.Pb(i.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-engine-camera-position"]],decls:2,vars:4,consts:[[1,"engine-camera-position"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Mc(1),i.Ub()),2&e&&(i.Db(1),i.Qc(" X:",null==t.camera?null:t.camera.x," Y:",null==t.camera?null:t.camera.y," Z:",null==t.camera?null:t.camera.z," Dist:",null==t.camera?null:t.camera.dist,"\n"))},styles:[".engine-camera-position[_ngcontent-%COMP%]{position:absolute;top:8px;right:8px;color:#fff;font-size:10px;text-shadow:0 0 2px rgba(0,0,0,.8);z-index:10}"],changeDetection:0}),e})();var Ku=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},Gu=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const Zu=["engine"],Ju=["engineCanvas"],Xu=["engineAnnotations"];function Yu(e,t){if(1&e&&i.Qb(0,"app-engine-contextmenu",10),2&e){const e=i.gc();i.lc("node",e.contextmenuNode)("hit",e.contextmenuHit)}}function eg(e,t){1&e&&i.Qb(0,"div",11)}function tg(e,t){1&e&&i.Qb(0,"app-engine-progress",12)}function ng(e,t){1&e&&(i.Tb(0),i.Qb(1,"app-engine-camera-position"),i.Sb())}var ig=function(e){return e[e.Pan=.4]="Pan",e[e.PanSlow=.04]="PanSlow",e[e.Zoom=5]="Zoom",e[e.ZoomSlow=1]="ZoomSlow",e[e.Rotate=.3]="Rotate",e[e.RotateSlow=.03]="RotateSlow",e}({}),og=function(e){return e[e.Rotate=6]="Rotate",e[e.Pan=1.75]="Pan",e[e.Zoom=2.5]="Zoom",e}({}),sg=function(e){return e[e.Zoom=-6]="Zoom",e[e.TrackZoom=.5]="TrackZoom",e[e.Pan=1.25]="Pan",e[e.Rotate=1.5]="Rotate",e[e.Friction=.85]="Friction",e[e.ZoomFriction=.85]="ZoomFriction",e[e.FrictionThreshold=.002]="FrictionThreshold",e}({}),rg=function(e){return e.Hide="engine--cursor-hide",e.Label="engine--cursor-label",e.Paint="engine--cursor-paint",e.Crosshair="engine--cursor-crosshair",e.Default="",e}({}),ag=function(e){return e[e.None=0]="None",e[e.Left=1]="Left",e[e.Right=2]="Right",e[e.LeftAndRight=4]="LeftAndRight",e}({});let cg=(()=>{class e{constructor(e,t,i,s,r,a,l,p,d){this.actions=e,this.cameraService=t,this.changeDetecton=i,this.engineService=s,this.paintService=r,this.visibilityLayersService=a,this.mediaService=l,this.renderer=p,this.store=d,this.flyCamera=!0,this.chapterActivating=!1,this.visible=!1,this.application=o,this.cursorClass=rg.Default,this.ngUnsubscribe=new $.a,this.display=!1,this.engineVisible=!0,this.background=new os.a(null),this.ctrlPressed=!1,this.scrollType=null,this.scrollTimeout=null,this.pinchTicks=0,this.progress="0",this.deltaTime=window.performance.now(),this.pinchMode="",this.inputEnabled=!0,c.application===o.Loft&&n.e(6).then(n.t.bind(null,"16wW",7)).then(e=>{window.pako=e})}wheel(e){const t=this.store.selectSnapshot(is.getScrollMode),n=this.ctrlPressed;t!==Zo.DoNotCaptureShowMessage||n||this.store.dispatch(new re(!0)),(t===Zo.Capture||n)&&(e.preventDefault(),this.handleWheel(e))}contextmenu(e){this.handleContextMenu(e)}mouseout(){this.handleMouseOut()}convertToLeafStateMap(e,t){const n={};return Object.entries(t).forEach(([t,i])=>{n[t]={},n[t][e]=i}),n}ngOnInit(){this.particleStateListener=new Zr(this.store),this.bindEngineEvents(),this.bindApplicationEvents(),this.bindChapterChangeEvents(),this.bindCameraEvents(),this.bindToolEvents(),this.bindMouseEvents(),this.bindKeyEvents(),this.bindHumanInteractions(),this.initChangeListener(),this.initChapterAudio(),this.initBackgroundListener(),this.initPlaybackSpeedListener(),Human.properties.set({assetDomain:c.assetDomain}),Human.workers.setPath("/engine/studio/workers"),Human.init.init()}ngOnDestroy(){this.changeDetecton.detach(),this.particleStateListener.destroy(),this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initEventListeners(){}bindEngineEvents(){this.engineService.getEvent(it.Loaded).pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(()=>{this.store.dispatch(new ie(!0))}),this.engineService.getEvent(it.TimelineChaptersActivateStart).pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(()=>{this.chapterActivating=!0}),this.engineService.getEvent(it.TimelineChaptersActivateFinish).pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.chapterActivating=!1;const t=Human.timeline.activeRoot._nowBranch,n={id:t.id,init:!0,camera:t.initializedCamera,annotations:t.initializedAnnotations,graph:t.initializedGraph,properties:t.initializedProperties,particles:t.initializedParticles,clips:t.initializedClippingPlanes,postprocessing:t.initializedPostprocess,transparency:t.initializedTransparencyMode};this.store.dispatch(new ge(e.chapterId)),this.store.dispatch(new he(n))}),this.engineService.getEvent(it.TimelineChaptersActivated).pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.engineService.fireEvent(it.LabelsChapterInfo,this.store.selectSnapshot(Tr.getChapterLabels))}),Object(ss.a)(this.engineService.getEvent(it.TimelinePlayed),this.engineService.getEvent(it.TimelinePaused)).pipe(Object(W.a)(this.ngUnsubscribe),Object(K.a)(()=>null!=this.store.selectSnapshot(Bo.getSelectedChapterId)),Object(cs.a)(50),Object(k.a)(()=>Human.timeline.playing)).subscribe(e=>{this.store.dispatch(new Pe(e))}),this.engineService.getEvent(it.Tick).pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(()=>{this.visible&&(this.inputEnabled&&this.handleMouseInputEngineTick(),this.handleCameraTick(),this.deltaTime=window.performance.now())}),this.engineService.getEvent(it.TweenVisibilityUpdate).pipe(Object(ls.a)((e,t)=>JSON.stringify(e)===JSON.stringify(t)),Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{const t=Object.keys(e).filter(t=>!0===e[t]),n=Object.keys(e).filter(t=>!1===e[t]);t.length>0&&this.store.dispatch(new $n.UpdateNodesShown(!0,t,void 0,!1,!0)),n.length>0&&this.store.dispatch(new $n.UpdateNodesShown(!1,n,void 0,!1,!0))}),this.engineService.getEvent(it.SceneObjectRenderable).pipe(Object(ps.a)(1e3),Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{if(e.length){const t={};e.forEach(e=>{t[e.objectId]={renderable:!0}}),this.store.dispatch(new ve(t))}}),this.engineService.getEvent(it.AssetsLoadProgress).pipe(Object(ds.a)(33),Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{const t=Math.max(1,this.store.selectSnapshot(Qr.getLoadChunks).length),n=this.store.selectSnapshot(Qr.getLoadChunksRemaining).length,i=t-n,{receivedAssets:o,requestedAssets:s}=e,r=o/s,a=1/t,c=0===n?1:r*a+i*a;this.progress=c.toFixed(2),this.changeDetecton.markForCheck(),this.store.dispatch(new $r(c,r))}),this.actions.pipe(Object(d.i)(Hs),Object(W.a)(this.ngUnsubscribe)).subscribe(()=>{0===this.store.selectSnapshot(Qr.getLoadChunksRemaining).length&&(this.store.dispatch(new $r(1,1)),this.engineService.enableRender())})}bindApplicationEvents(){this.enginePosition$.pipe(Object(K.a)(e=>null!=e),Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.repositionEngine(e)}),this.store.select(is.getXrayModeEnabled).pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{const t=this.store.selectSnapshot(ii.getCheckedNodes),n=this.store.selectSnapshot(ii.getNodes);!1===e?(Object.keys(n||[]).forEach(e=>{this.paintService.paint(e,n[e].paint)}),t.forEach(e=>this.paintService.highlight(e.objectId,!0))):(this.paintService.paintAll(Object.keys(n),bi.recipe),this.paintService.paintAll(t.map(e=>e.objectId),ai.recipe))}),this.actions.pipe(Object(d.j)(ze),Object(W.a)(this.ngUnsubscribe)).subscribe(()=>{this.playChapterFromStart()}),this.engineDisplay$.pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.display=e,this.changeDetecton.markForCheck()}),this.engineVisible$.pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.engineVisible=e,this.changeDetecton.markForCheck()}),this.visibilityLayersService.initObservables(),this.contextmenu$.pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.contextmenuNode=e.node,this.contextmenuHit=e.hit,this.changeDetecton.markForCheck()})}bindChapterChangeEvents(){this.selectedChapter$.pipe(Object(K.a)(e=>null!=e),Object(us.a)(),Object(W.a)(this.ngUnsubscribe)).subscribe(([e,t])=>{e.id!==t.id&&(this.store.dispatch(new $n.SetActiveChapter(t.id)),Wr(this.store,this.engineService),Human.timeline.scrub({chapterId:t.id}),this.store.dispatch(new It(void 0)))}),this.clippingPlanes$.pipe(Object(K.a)(e=>void 0!==e),Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{const t=Object.values(e.clips).filter(e=>e.enabled);Human.renderer.clip.reset(),t.forEach(t=>Human.renderer.clip.setClip(Object.assign({boundary:e.boundary},t)))}),Object(rs.b)(this.selectedChapterId$,this.readyState$,this.autoplay$).pipe(Object(K.a)(([e,t,n])=>!Object(X.isNil)(e)&&!Object(X.isNil)(t)&&!Object(X.isNil)(n)),Object(W.a)(this.ngUnsubscribe)).subscribe(([,e,t])=>{const n=Object(X.get)(e,"animation",!1),i=this.store.selectSnapshot(Bo.getSelectedChapter),o=Object(X.get)(i,"ui.play.autoplay",!0),s=n&&t&&o;this.store.dispatch(new _e(i,!s)),this.store.dispatch(new je(s))})}bindCameraEvents(){this.actions.pipe(Object(d.j)(bt),Object(K.a)(e=>!Object(X.isNil)(e.camera)),Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{e.animate?this.flyToPoint(e.camera,e.animationDuration):this.jumpToPoint(e.camera)}),this.actions.pipe(Object(d.j)(Ct),Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.cameraService.panCameraStatic(e.x,e.y,e.z)}),this.actions.pipe(Object(d.j)(_t),Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.cameraService.rotateCameraStatic(e.x,e.y)}),this.actions.pipe(Object(d.j)(vt),Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.cameraService.setHumanZoomFactor(e.value)}),this.actions.pipe(Object(d.j)(fe),Object(K.a)(e=>!!e.objectId),Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{e.animate?this.flyToObject(e.objectId,e.animationDuration):this.jumpToObject(e.objectId)})}bindToolEvents(){this.activeTool$.pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{switch(Object.values(rg).forEach(e=>{e&&this.renderer.removeClass(this.engineElement.nativeElement,e)}),e){case Go.Hide:this.renderer.addClass(this.engineElement.nativeElement,rg.Hide);break;case Go.Label:this.renderer.addClass(this.engineElement.nativeElement,rg.Label);break;case Go.Paint:this.renderer.addClass(this.engineElement.nativeElement,rg.Paint);break;case Go.Quiz:this.renderer.addClass(this.engineElement.nativeElement,rg.Crosshair)}})}bindMouseEvents(){this.mouseMove$=Object(as.a)(this.engineElement.nativeElement,"mousemove"),this.mouseMove$.pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.handleMousePan(e)}),this.mouseMove$.pipe(Object(cs.a)(10),Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.handleMouseHover(e)}),this.mouseLeave$=Object(as.a)(this.engineElement.nativeElement,"mouseleave"),this.mouseLeave$.pipe(Object(cs.a)(10),Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.handleMouseLeave()})}bindKeyEvents(){const e=["w","a","s","d","e","c","=","-","+","_","arrowleft","arrowright","arrowup","arrowdown","shiftKey"].reduce((e,t)=>(e[t]=!1,e),{}),t=new os.a(e);let n;this.renderer.listen(window,"keydown",e=>{if(e.repeat||e.metaKey||e.ctrlKey)return;const n=e.target.nodeName.toLowerCase();["input","textarea","select","option"].indexOf(n)>=0||t.next(Object.assign(Object.assign({},t.value),{[e.key.toLowerCase()]:!0,shiftKey:e.shiftKey,hasMomentum:!1}))}),this.renderer.listen(window,"keyup",e=>{e.key&&(1===Object.values(n).filter(e=>!0===e).length?(this.applyMotion(n,!0),t.next(Object.assign(Object.assign({},t.value),{[e.key.toLowerCase()]:!1,shiftKey:e.shiftKey,hasMomentum:!1===n.shiftKey}))):t.next(Object.assign(Object.assign({},t.value),{[e.key.toLowerCase()]:!1,shiftKey:e.shiftKey,hasMomentum:!1})))}),t.pipe(Object(K.a)(()=>this.inputEnabled),Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{n=e,!1===e.hasMomentum&&this.applyMotion(e,!1)}),this.renderer.listen(window,"keydown",e=>{"Control"===e.key&&(this.ctrlPressed=!0)}),this.renderer.listen(window,"keyup",e=>{"Control"===e.key&&(this.ctrlPressed=!1)})}applyMotion(e,t){const n=new Dt,i=e.shiftKey?ig.ZoomSlow:ig.Zoom,o=e.shiftKey?ig.PanSlow:ig.Pan,s=e.shiftKey?ig.RotateSlow:ig.Rotate;n.zoom+=e.c||e["-"]||e._?i:0,n.zoom-=e.e||e["="]||e["+"]?i:0,n.panX-=e.d?o:0,n.panX+=e.a?o:0,n.panY+=e.w?o:0,n.panY-=e.s?o:0,n.rotateX-=e.arrowright?s:0,n.rotateX+=e.arrowleft?s:0,n.rotateY+=e.arrowup?s:0,n.rotateY-=e.arrowdown?s:0,n.applyFriction=t,this.store.dispatch(new ft(n))}initChangeListener(){this.store.select(ii.getPatches).pipe(Object(K.a)(e=>e.length>0),Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{const t=e.reduce((e,t)=>{const n=t.path[t.path.length-1];return void 0!==e[n]&&e[n].push(t),e},{shown:[],checked:[],paint:[],pickable:[]}),n=e=>t[e].reduce((e,t)=>(e[t.path[2]]=t.value,e),{}),i=n("checked"),o=n("shown"),s=n("paint"),r=n("pickable");if(!Object(X.isEmpty)(o)){const e=this.store.selectSnapshot(ii.getNodes),t=Object.values(e).reduce((e,t)=>(e[t.objectId]=t.shown,e),{});this.engineService.setNodesVisible(t);const n=this.convertToLeafStateMap("shown",t);this.store.dispatch(new xe(n,e))}if(!Object(X.isEmpty)(i)){this.engineService.fireEvent(it.SceneObjectsSelected,{selectedObjectsUpdate:i});const e=this.store.selectSnapshot(is.getXrayModeEnabled)?(e,t)=>this.paintService.paint(e,!0===t?ai.recipe:bi.recipe):(e,t)=>this.paintService.highlight(e,t);Object.entries(i).forEach(([t,n])=>{e(t,n)})}if(!Object(X.isEmpty)(s))for(const[a,c]of Object.entries(s))this.paintService.colorObject(a,Xn.toEngine(c));if(!Object(X.isEmpty)(r)){const e=this.store.selectSnapshot(ii.getNodes),t=Object.values(e).reduce((e,t)=>(e[t.objectId]=t.pickable,e),{});this.engineService.setNodesPickable(t),this.store.dispatch(new we(this.convertToLeafStateMap("pickable",t),e))}})}initChapterAudio(){Object(rs.b)(this.selectedChapterId$,this.playAudio$).pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(([e,t])=>{this.playAudio(t)})}initBackgroundListener(){Object(rs.b)([this.background$,this.engineDisplay$,this.engineVisible$]).pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(([e,t,n])=>{this.renderer.setStyle(this.engineElement.nativeElement,"background-image",Pn.toCSS(e)),this.isBackgroundCheckered(e)?this.renderer.addClass(this.engineElement.nativeElement,"engine--checkered"):this.renderer.removeClass(this.engineElement.nativeElement,"engine--checkered"),this.renderer.setStyle(this.engineElement.nativeElement,"display",t?"block":"none"),this.renderer.setStyle(this.engineElement.nativeElement,"opacity",n?1:0)})}initPlaybackSpeedListener(){this.store.select(is.getPlaybackSpeed).pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{Human.timeline.scale=e})}repositionEngine(e){this.renderer.setStyle(this.engineElement.nativeElement,"left",e.left+"px"),this.renderer.setStyle(this.engineElement.nativeElement,"top",e.top+"px"),this.renderer.setStyle(this.engineElement.nativeElement,"width",e.width+"px"),this.renderer.setStyle(this.engineElement.nativeElement,"height",e.height+"px"),this.renderer.setStyle(this.engineElement.nativeElement,"zIndex",""+e.visibility),this.renderer.setStyle(this.engineElement.nativeElement,"visibility",e.visibility===dt.Shown?"visible":"hidden"),this.visible=e.visibility===dt.Shown,Human.renderer.resize()}bindHumanInteractions(){const e=new Gr.Manager(this.engineCanvasElement.nativeElement);e.add(new Gr.Tap({event:"doubletap",taps:2,posThreshold:50})),e.add(new Gr.Tap({event:"singletap"})),e.add(new Gr.Pan({event:"pan",pointers:0})),e.add(new Gr.Pinch({event:"pinch"})),e.add(new Gr.Press({time:500})),e.on("singletap",e=>{this.handleTap(e)}),e.on("doubletap",e=>{this.handleDoubleTap(e)}),e.on("press",e=>{e.preventDefault(),e.srcEvent.stopImmediatePropagation(),this.handlePress(e)}),e.on("pan",e=>{e.preventDefault(),this.handlePan(e)}),e.on("panstart",e=>{this.handlePanStart(e)}),e.on("panend",e=>{this.handlePanEnd(e)}),e.on("pinchend",e=>{this.handlePinchEnd(e)});let t=0,n=0,i=0,o=0;e.on("pinchstart",e=>{t=e.scale,i=e.deltaX,o=e.deltaY,this.pinchMode=""}),e.on("pinchmove",e=>{if(this.pinchTicks>0)return;const i=Math.abs(e.deltaX)>60||Math.abs(e.deltaY)>60,o=e.scale>1.25||e.scale<.75;this.pinchMode?("pan"===this.pinchMode&&o&&!i&&(this.pinchMode="pinch"),"pinch"===this.pinchMode&&i&&!o&&(this.pinchMode="pan")):this.pinchMode=o?"pinch":"pan";const s=e.scale-t;t=e.scale;const r=n;n=0===s?0:s>0?1:-1,this.cameraService.setCameraPan(e.velocityX*sg.Pan,e.velocityY*sg.Pan),n+r!==0&&this.cameraService.setHumanZoom(s*sg.Zoom)})}handleMouseHover(e){if(e.buttons!==ag.None)return;const{offsetX:t,offsetY:n}=e,i=Human.renderer.pick.pick(t,n);if(i.objectId){const e=this.store.selectSnapshot(is.getViewGraph),t=this.engineService.getNode(e,i.objectId),n=this.store.selectSnapshot(is.getHoveredNode);n&&n.id===t.id||this.store.dispatch(new Qe(t,i))}else null!=this.store.selectSnapshot(is.getHoveredNode)&&this.store.dispatch(new Qe(null))}handleMouseLeave(){this.store.dispatch(new Qe(null))}handleMousePan(e){if(2===e.buttons||4===e.buttons){let{movementX:t,movementY:n}=e;t/=16,n/=16,this.cameraService.setCameraPan(t,n)}}handleMouseOut(){this.store.dispatch(new Qe(null))}handleWheel(e){let t=0;switch(e.deltaMode){case 0:null===this.scrollType&&(this.scrollType=Math.abs(e.deltaY)<10?"trackpad":"wheel"),t="trackpad"===this.scrollType?e.deltaY*sg.TrackZoom:Math.sign(e.deltaY)*og.Zoom;break;default:this.scrollType="wheel",t=e.deltaY*og.Zoom}clearTimeout(this.scrollTimeout),this.scrollTimeout=setTimeout(()=>{this.scrollType=null},500),Math.abs(t)>40&&(t=40*Math.sign(t)),"trackpad"===this.scrollType?this.cameraService.setCameraZoom(t):this.zoomWithVelocity(t)}zoomWithVelocity(e){this.cameraService.setCameraZoom(e),requestAnimationFrame(()=>{e*=.85,Math.abs(e)>1&&this.zoomWithVelocity(e)})}handleContextMenu(e){e.preventDefault();const{offsetX:t,offsetY:n}=e,i=this.getHit(t,n),o=this.getNodeFromHit(i);this.store.dispatch(new me(o,i))}handlePanStart(e){}handlePanEnd(e){const t=this.store.selectSnapshot(Ko.getCameraMotion);if(this.pinchTicks>0||t.panX===e.velocityX&&t.panY===e.velocityY)return;const n=this.store.selectSnapshot(Ko.getPanMode);e.srcEvent.shiftKey||"pan"===n?(t.panX=e.velocityX*sg.Pan,t.panY=e.velocityY*sg.Pan):(t.rotateX=e.velocityX*sg.Rotate,t.rotateY=e.velocityY*sg.Rotate),t.applyFriction=!0,this.store.dispatch(new ft(t))}handlePinchEnd(e){const t=this.store.selectSnapshot(Ko.getCameraMotion);if("pan"===this.pinchMode)t.panX=e.velocityX*sg.Pan,t.panY=e.velocityY*sg.Pan;else{const n=e.velocity>0?1:-1;t.zoom=Math.sqrt(e.velocityX*e.velocityX+e.velocityY*e.velocityY)*-n*sg.Zoom}t.applyFriction=!0,this.store.dispatch(new ft(t)),this.pinchTicks=10}handleTap(e){const{offsetX:t,offsetY:n}=this.getOffset(e),i=this.getHit(t,n),o=this.getNodeFromHit(i);this.store.dispatch(new be(o,e,i))}handleDoubleTap(e){const{offsetX:t,offsetY:n}=this.getOffset(e),i=this.getHit(t,n),o=this.getNodeFromHit(i);o&&this.store.dispatch(new fe(o.id))}handlePress(e){const{offsetX:t,offsetY:n}=this.getOffset(e),i=this.getHit(t,n),o=this.getNodeFromHit(i);o&&this.store.dispatch(new fe(o.id))}handlePan(e){if(this.pinchTicks>0)return;const t=this.store.selectSnapshot(Ko.getPanMode),{velocityX:n,velocityY:i}=e;e.srcEvent.shiftKey||"pan"===t?this.cameraService.setCameraPan(n*sg.Pan,i*sg.Pan):this.cameraService.setCameraRotation(n*sg.Rotate,i*sg.Rotate)}handleMouseInputEngineTick(){const e=this.cameraService.tickCameraRotation(),t=this.cameraService.tickCameraPan(),n=this.cameraService.tickCameraZoom(),i=Math.min(15,(window.performance.now()-this.deltaTime)/16.666666666666668);if((e.vx||e.vy)&&this.cameraService.rotateCameraStatic(0!==e.vx?i*e.vx*og.Rotate:0,0!==e.vy?i*e.vy*og.Rotate:0),t.x||t.y){const e=Math.max(Human.renderer.camera.lookDistance/80,.01);this.cameraService.panCameraStatic(i*t.x*e*og.Pan,i*t.y*e*og.Pan,i*t.z*e*og.Pan)}0!==n&&this.cameraService.setHumanZoom(i*n*og.Zoom)}handleCameraTick(){this.pinchTicks>0&&this.pinchTicks--,this.applyFriction();const e=this.store.selectSnapshot(Ko.getCameraMotion);this.cameraService.setCameraPan(e.panX,e.panY),this.cameraService.setCameraRotation(e.rotateX,e.rotateY),this.cameraService.setCameraZoom(e.zoom)}getFriction(e){if(0===e)return 0;const t=(window.performance.now()-this.deltaTime)/16.666666666666668;let n=e*Math.max(0,sg.Friction+.1*(1-t));return Math.abs(n)<sg.FrictionThreshold&&(n=0),n}applyFriction(){const e=this.store.selectSnapshot(Ko.getCameraMotion);!0===e.applyFriction&&(e.rotateX=this.getFriction(e.rotateX),e.rotateY=this.getFriction(e.rotateY),e.panX=this.getFriction(e.panX),e.panY=this.getFriction(e.panY),e.zoom=this.getFriction(e.zoom),0===e.rotateX&&0===e.rotateY&&0===e.panX&&0===e.panY&&0===e.zoom&&(e.applyFriction=!1),this.store.dispatch(new ft(e)))}flyToObject(e,t){Human.renderer.camera.fly.flyTo({objectId:e,animationDuration:t})}jumpToObject(e){Human.renderer.camera.fly.jumpTo({objectId:e})}flyToPoint(e,t){Human.renderer.camera.fly.flyTo(Object.assign(Object.assign({},e),{animationDuration:t}),()=>{this.store.dispatch(new mt)})}jumpToPoint(e){Human.renderer.camera.fly.jumpTo(e)}getNodeFromHit(e){let t;if(e.objectId){const n=this.store.selectSnapshot(is.getViewGraph);t=this.engineService.getNode(n,e.objectId)}return t}getHit(e,t){return Human.renderer.pick.pick(e,t,{rayPick:!0})}getOffset(e){let t=0,n=0;e.center?(t=e.center.x,n=e.center.y):(t=e.clientX,n=e.clientY);const i=this.engineElement.nativeElement.getBoundingClientRect();return{offsetX:t-i.left,offsetY:n-i.top}}playAudio(e){e=Object(X.isNil)(e)?this.store.selectSnapshot(is.getPlayAudio):e,this.mediaService.stopAudio();const t=this.store.selectSnapshot(Bo.getSelectedChapterAudio),n=Object(X.get)(t,"data.fullUrl");if(n){let t=this.mediaService.getAudioPlayer(n);t||(t=this.mediaService.addAudioPlayer(n)),e?t.play():t.stop()}}playChapterFromStart(){const e=this.store.selectSnapshot(Bo.getSelectedChapter);this.playAudio(),this.store.dispatch(new _e(e)),this.store.dispatch(new je(!0))}isTransparentBackground(e){return!!e&&Pn.isTransparent(this.background.getValue())}isBackgroundCheckered(e){return c.application!==o.Viewer&&this.isTransparentBackground(e)}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.b),i.Pb(Lt),i.Pb(i.i),i.Pb(lt),i.Pb(Jr),i.Pb(ea),i.Pb(ia),i.Pb(i.H),i.Pb(d.g))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-engine"]],viewQuery:function(e,t){if(1&e&&(i.Gc(Zu,!0),i.Gc(Ju,!0),i.Gc(Xu,!0)),2&e){let e;i.uc(e=i.dc())&&(t.engineElement=e.first),i.uc(e=i.dc())&&(t.engineCanvasElement=e.first),i.uc(e=i.dc())&&(t.engineAnnotationsElement=e.first)}},hostBindings:function(e,t){1&e&&i.cc("wheel",(function(e){return t.wheel(e)}))("contextmenu",(function(e){return t.contextmenu(e)}))("mouseout",(function(e){return t.mouseout(e)}))},inputs:{inputEnabled:"inputEnabled"},decls:14,vars:7,consts:[["id","container","data-test","engine","role","main",1,"engine"],["engine",""],["id","theCanvas","data-test","engineCanvas",1,"engine__canvas"],["engineCanvas",""],["id","annotationCanvas",1,"engine__annotations"],["engineAnnotations",""],[3,"node","hit",4,"ngIf"],["data-test","engineInputBlocker","class","engine__input-blocking",4,"ngIf"],["data-test","engineProgressBar",4,"ngIf"],[4,"appFlagApplication"],[3,"node","hit"],["data-test","engineInputBlocker",1,"engine__input-blocking"],["data-test","engineProgressBar"]],template:function(e,t){1&e&&(i.Vb(0,"div",0,1),i.Qb(2,"canvas",2,3),i.Qb(4,"canvas",4,5),i.Qb(6,"app-labels"),i.Kc(7,Yu,1,2,"app-engine-contextmenu",6),i.Kc(8,eg,1,0,"div",7),i.Kc(9,tg,1,0,"app-engine-progress",8),i.hc(10,"async"),i.Qb(11,"app-engine-scroll"),i.Qb(12,"app-engine-fade"),i.Kc(13,ng,2,0,"ng-container",9),i.Ub()),2&e&&(i.Eb("data-progress",t.progress),i.Db(7),i.lc("ngIf",t.contextmenuNode),i.Db(1),i.lc("ngIf",!t.inputEnabled),i.Db(1),i.lc("ngIf",i.ic(10,5,t.showProgressBar$)),i.Db(4),i.lc("appFlagApplication",t.application.Loft))},directives:[Du,ms.l,Fu,Vu,sc,Hu,qu,Wu],pipes:[ms.b],styles:[".engine[_ngcontent-%COMP%]{-webkit-tap-highlight-color:rgba(0,0,0,0);-webkit-tap-highlight-color:transparent;position:fixed;width:100vw;height:100vh;overflow:hidden;visibility:hidden;z-index:-1;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.engine__canvas[_ngcontent-%COMP%]{display:block;position:absolute;width:100%;height:100%;z-index:1}.engine__annotations[_ngcontent-%COMP%]{display:none}.engine--cursor-paint[_ngcontent-%COMP%]:hover{cursor:url(/assets/images/cursor-paint.png) 7 20,pointer}.engine--cursor-hide[_ngcontent-%COMP%]:hover{cursor:url(/assets/images/cursor-hide.png) 7 20,pointer}.engine--cursor-label[_ngcontent-%COMP%]:hover{cursor:url(/assets/images/cursor-label.png) 7 20,pointer}.engine--cursor-crosshair[_ngcontent-%COMP%]:hover{cursor:crosshair}.engine--checkered[_ngcontent-%COMP%]{background-color:#fff;background-size:24px 24px;background-position:0 0,12px 12px;background-image:linear-gradient(45deg,#d7e0ea 25%,transparent 0,transparent 75%,#d7e0ea 0,#d7e0ea),linear-gradient(45deg,#d7e0ea 25%,transparent 0,transparent 75%,#d7e0ea 0,#d7e0ea)}.engine__controls[_ngcontent-%COMP%]{position:absolute;right:16px;bottom:16px;z-index:2}.engine__progress[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;z-index:2}.engine__progress--hide[_ngcontent-%COMP%]{display:none}.engine__input-blocking[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0;z-index:3}@media (max-width:768px){.engine__controls[_ngcontent-%COMP%]{bottom:96px}}"],changeDetection:0}),Ku([Object(d.d)(is.getReady),Gu("design:type",q.a)],e.prototype,"ready$",void 0),Ku([Object(d.d)(is.getViewGraph),Gu("design:type",q.a)],e.prototype,"viewGraph$",void 0),Ku([Object(d.d)(is.getEnginePosition),Gu("design:type",q.a)],e.prototype,"enginePosition$",void 0),Ku([Object(d.d)(is.getHoveredNode),Gu("design:type",q.a)],e.prototype,"hoveredNode$",void 0),Ku([Object(d.d)(is.getChapter),Gu("design:type",q.a)],e.prototype,"chapter$",void 0),Ku([Object(d.d)(is.getChapterInit),Gu("design:type",q.a)],e.prototype,"chapterInit$",void 0),Ku([Object(d.d)(ii.getCheckedNodes),Gu("design:type",q.a)],e.prototype,"checkedNodes$",void 0),Ku([Object(d.d)(is.getActiveTool),Gu("design:type",q.a)],e.prototype,"activeTool$",void 0),Ku([Object(d.d)(is.getAnimationPlaying),Gu("design:type",q.a)],e.prototype,"animationPlaying$",void 0),Ku([Object(d.d)(is.getAutoplay),Gu("design:type",q.a)],e.prototype,"autoplay$",void 0),Ku([Object(d.d)(is.getPlayAudio),Gu("design:type",q.a)],e.prototype,"playAudio$",void 0),Ku([Object(d.d)(is.getDisplay),Gu("design:type",q.a)],e.prototype,"engineDisplay$",void 0),Ku([Object(d.d)(is.getVisible),Gu("design:type",q.a)],e.prototype,"engineVisible$",void 0),Ku([Object(d.d)(is.getShowProgressBar),Gu("design:type",q.a)],e.prototype,"showProgressBar$",void 0),Ku([Object(d.d)(is.getContextmenu),Gu("design:type",q.a)],e.prototype,"contextmenu$",void 0),Ku([Object(d.d)(Bo.getSelectedChapter),Gu("design:type",q.a)],e.prototype,"selectedChapter$",void 0),Ku([Object(d.d)(Bo.getSelectedChapterId),Gu("design:type",q.a)],e.prototype,"selectedChapterId$",void 0),Ku([Object(d.d)(Bo.getSelectedChapterReadyState),Gu("design:type",q.a)],e.prototype,"readyState$",void 0),Ku([Object(d.d)(Bo.getSelectedChapterClippingPlanes),Gu("design:type",q.a)],e.prototype,"clippingPlanes$",void 0),Ku([Object(d.d)(Ko.getCameraMotion),Gu("design:type",q.a)],e.prototype,"cameraMotion$",void 0),Ku([Object(d.d)(Bo.getSelectedChapterBackground),Gu("design:type",q.a)],e.prototype,"background$",void 0),e})();var lg=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let pg=(()=>{class e{constructor(e,t,n,i){this.store=e,this.router=t,this.ga=n,this.pendoService=i,this.title="Biodigital Human",this.ngUnsubscribe=new $.a}ngOnInit(){this.initPendo(),this.initPageAnalytics(),this.initInputObserver()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initPendo(){this.pendoService.appendScript(),this.pendoService.initialize({visitor:{id:""},account:{}})}initInputObserver(){this.inputEnabled$.pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.store.dispatch(new Q.SetInputEnabled(e))})}initPageAnalytics(){this.router.events.pipe(Object(K.a)(e=>e instanceof Z.c),Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.ga.pageView(e.urlAfterRedirects)})}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.g),i.Pb(Z.e),i.Pb(J.c),i.Pb(ee))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-root"]],decls:3,vars:3,consts:[[3,"inputEnabled"]],template:function(e,t){1&e&&(i.Qb(0,"app-engine",0),i.hc(1,"async"),i.Qb(2,"router-outlet")),2&e&&i.lc("inputEnabled",i.ic(1,1,t.inputEnabled$))},directives:[cg,Z.g],pipes:[ms.b],styles:[""],changeDetection:0}),function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);s>3&&r&&Object.defineProperty(t,n,r)}([Object(d.d)(B.getInputEnabled),lg("design:type",q.a)],e.prototype,"inputEnabled$",void 0),e})();var dg=n("imBb"),ug=n("7sSR"),gg=function(e){return e[e.Main=0]="Main",e[e.Media=1]="Media",e[e.Tools=2]="Tools",e[e.Whiteboard=3]="Whiteboard",e[e.VisibilityLayers=4]="VisibilityLayers",e[e.Empty=5]="Empty",e}({});let hg=(()=>{class e{constructor(e,t,n){this.store=e,this.engineService=t,this.viewService=n}startQuiz(){this.viewService.toggleColumn(!0),this.store.dispatch(new ji.SetQuizActive(!0));const e=this.store.selectSnapshot(Bi.getAllQuestions)[0].id;this.store.dispatch(new ji.SetActiveQuestion(e))}resetQuiz(){this.store.dispatch(new ji.SetQuizActive(!1)),this.store.dispatch(new ji.SetActiveSubmission(void 0)),this.store.dispatch(new ji.ClearSubmissions),this.store.dispatch(new ji.SetQuizLifecycle(Di.Question))}exitQuiz(){this.resetQuiz(),setTimeout(()=>{this.store.dispatch(new bt(this.store.selectSnapshot(Bo.getChapterCamera),!1))})}submitQuestion(e,t){const n=this.store.selectSnapshot(Bi.getAllQuestions).find(t=>t.id===e),{launchMode:i,quizSettings:o}=this.store.selectSnapshot(Bi);this.store.dispatch(new ji.SubmitQuestionAnswer({questionId:n.id,answer:t})),this.store.dispatch(new ji.SetActiveSubmission({questionId:n.id,answer:t})),this.engineService.fireEvent(it.QuizAnswerSubmitted,{questionId:n.id,answer:t}),i===Ai.Learning&&n.type!==Mi.Instructions&&!1!==o.showExplanation?this.store.dispatch(new ji.SetQuizLifecycle(Di.Explanation)):this.nextQuestion()}nextQuestion(){this.store.selectSnapshot(Bi.hasQuestionRemaining)?(this.store.dispatch(new ji.SetQuizLifecycle(Di.Question)),this.store.dispatch(new ji.NextQuestion)):(this.store.dispatch(new ji.SetQuizLifecycle(Di.Review)),this.engineService.fireEvent(it.QuizCompleted,!0))}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(d.g),i.Zb(lt),i.Zb(Ip))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var bg;function mg(e){if(null==e)return"";const t=new RegExp(/[^a-zA-Z0-9_]/,"gi");return e.replace(t,"_")}!function(e){e.normalize=function(e){return(""+(e||"")).replace(/&#(\d+);/g,(e,t)=>String.fromCharCode(t)).replace(/(&.+;)/gi,(e,t)=>String.fromCharCode(e.charCodeAt(0)))},e.prettyPrint=function(e){return(""+(e||"")).trim().replace(/([A-Z])/g," $1").replace(/^./,e=>e.toUpperCase()).trim()},e.parseEmails=function(e){return e.split(",").map(e=>e.trim()).filter(e=>!!e)},e.validateEmail=function(e){return/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/.test(e)}}(bg||(bg={}));var fg=n("wf0l");let yg=(()=>{class e{transform(e,t){return mg(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=i.Ob({name:"elementID",type:e,pure:!0}),e})();var xg=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},vg=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const wg=["chapterList"],Og=function(e,t){return{"view-chapters__item--viewed":e,"view-chapters__item--selected":t}};function Cg(e,t){if(1&e){const e=i.Wb();i.Vb(0,"li",3),i.cc("click",(function(){i.zc(e);const n=t.$implicit;return i.gc().handleChapterClick(n)}))("keyup.enter",(function(){i.zc(e);const n=t.$implicit;return i.gc().handleChapterClick(n)})),i.hc(1,"async"),i.hc(2,"elementID"),i.hc(3,"async"),i.Vb(4,"div",4),i.Mc(5),i.Ub(),i.Vb(6,"div",5),i.Mc(7),i.Ub(),i.Qb(8,"div",6),i.Ub()}if(2&e){const e=t.$implicit,n=t.index,o=i.gc();let s=null;i.lc("gaLabel","Chapter "+(n+1)+" of "+(null==(s=i.ic(1,8,o.chapters$))?null:s.length))("ngClass",i.pc(14,Og,o.isViewed(e.id),e.id===i.ic(3,12,o.selectedChapterId$))),i.Eb("aria-label",e.info.displayName)("data-chapter-id",i.ic(2,10,e.id)),i.Db(5),i.Oc("",n+1,"."),i.Db(2),i.Nc(e.info.displayName),i.Db(1),i.lc("defaultImage",o.defaultImage)("lazyLoad",o.getChapterThumb(e.id))}}let Sg=(()=>{class e{constructor(e,t,n){this.store=e,this.viewService=t,this.changeDetectorRef=n,this.defaultImage="/assets/images/view-chapter-thumbnail-placeholder.png",this.autoscroll=!0,this.ngUnsubscribe=new $.a,this.nextChapter=null}ngOnInit(){this.initChaptersObserver()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}ngAfterViewInit(){this.initScrollObserver()}initChaptersObserver(){Object(rs.b)([this.store.select(Bo.getStoryChapters),this.store.select(Bo.getSelectedChapterIndex)]).pipe(Object(ds.a)(300),Object(W.a)(this.ngUnsubscribe)).subscribe(([e,t])=>{const n=t+1;this.nextChapter=n>=e.length?null:e[n],this.changeDetectorRef.markForCheck()})}initScrollObserver(){this.selectedChapterId$.pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.scrollChapterIntoView(e)})}handleChapterClick(e){this.viewService.selectChapter(e)}getChapterThumb(e){const t=this.store.selectSnapshot(Bo.getRegisteredThumbnails).get(e);return t?t.snapshot||t.urls.small:""}scrollChapterIntoView(e){const t=mg(e);if(!t)return;const n=this.chapterList.nativeElement.querySelector(`[data-chapter-id=${t}]`);n&&this.autoscroll&&"scrollBehavior"in document.documentElement.style&&n.scrollIntoView({behavior:"auto",block:"nearest"})}isViewed(e){return this.store.selectSnapshot(Bo.getChaptersViewed).some(t=>t===e)}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.g),i.Pb(Ip),i.Pb(i.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-chapters"]],viewQuery:function(e,t){if(1&e&&i.Rc(wg,!0),2&e){let e;i.uc(e=i.dc())&&(t.chapterList=e.first)}},inputs:{defaultImage:"defaultImage",autoscroll:"autoscroll"},decls:6,vars:6,consts:[["aria-label","Chapters","role","navigation","gaCategory","View Chapter List",1,"view-chapters",3,"hidden"],["chapterList",""],["gaEvent","","gaAction","Clicked Chapter","role","button","class","view-chapters__item","tabindex","0",3,"gaLabel","ngClass","click","keyup.enter",4,"ngFor","ngForOf"],["gaEvent","","gaAction","Clicked Chapter","role","button","tabindex","0",1,"view-chapters__item",3,"gaLabel","ngClass","click","keyup.enter"],[1,"view-chapters__index"],[1,"view-chapters__title"],[1,"view-chapters__thumb",3,"defaultImage","lazyLoad"]],template:function(e,t){if(1&e&&(i.Vb(0,"nav",0,1),i.hc(2,"async"),i.Vb(3,"ol"),i.Kc(4,Cg,9,17,"li",2),i.hc(5,"async"),i.Ub(),i.Ub()),2&e){let e=null;i.lc("hidden",1===(null==(e=i.ic(2,2,t.chapters$))?null:e.length)),i.Db(4),i.lc("ngForOf",i.ic(5,4,t.chapters$))}},directives:[J.a,ms.k,J.b,ms.i,fg.a],pipes:[ms.b,yg],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3838}.text-info{color:#0060c4}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.view-chapters{max-height:320px;overflow:auto}.view-chapters__header{border-top:var(--view-chapters-border);display:flex;align-items:center;padding:16px 0;margin-top:16px}.view-chapters__next{font-size:14px;letter-spacing:.35px;line-height:1.4em;font-style:italic;padding:8px;border-radius:4px;flex-grow:1}.view-chapters__next:hover{background:var(--view-chapters-bg--hover);color:var(--view-chapters-color--hover);cursor:pointer}.view-chapters__toggle{justify-content:flex-end;flex-shrink:1;text-align:right;margin-left:4px}.view-chapters__item{font-size:14px;letter-spacing:.35px;line-height:1.4em;display:flex;padding:8px;margin:4px;border-radius:2px;border-left:4px solid transparent;background-color:transparent;color:#131c2a;border-left:var(--view-chapters-border);background-color:var(--view-chapters-bg);color:var(--view-chapters-color);transition:background-color 125ms,color 125ms,border 125ms}.view-chapters__item:hover{cursor:pointer;background:var(--view-chapters-bg--hover)}.view-chapters__item:focus{background:#f1f4fa;outline:none}.view-chapters__item--selected{border-left:4px solid #2d72dc;background-color:#f1f5fc;background:var(--view-chapters-bg--selected);border-left:var(--view-chapters-border--selected)}.view-chapters__index{display:flex;flex:0 0 32px;justify-content:center}.view-chapters__thumb{background-color:#f9fafd;background-color:var(--view-chapters-thumb-bg);border-radius:4px;background-repeat:no-repeat;flex:0 0 56px;height:56px;width:56px;transition:border-color .1s}.view-chapters__title{word-wrap:break-word;overflow-wrap:break-word;display:flex;flex:1 1 auto;padding-right:4px}.view-chapters__thumb{background-size:cover}"],encapsulation:2,changeDetection:0}),xg([Object(d.d)(Bo.getStoryChapters),vg("design:type",q.a)],e.prototype,"chapters$",void 0),xg([Object(d.d)(Bo.getSelectedChapterId),vg("design:type",q.a)],e.prototype,"selectedChapterId$",void 0),xg([Object(d.d)(Bo.getSelectedChapterIndex),vg("design:type",q.a)],e.prototype,"selectedChapterIndex$",void 0),xg([Object(d.d)(Bo.getRegisteredThumbnails),vg("design:type",q.a)],e.prototype,"thumbnails$",void 0),xg([Object(d.d)(Bo.getChaptersViewed),vg("design:type",q.a)],e.prototype,"chaptersViewed$",void 0),e})();var kg=n("rDax");class _g{constructor(e,t,n){this.overlay=e,this.content=t,this.data=n,this.afterClosed=new $.a,this.afterClosed$=this.afterClosed.asObservable(),e.backdropClick().subscribe(()=>this._close("backdropClick",n))}close(e){this._close("close",e)}_close(e,t){this.overlay.dispose(),this.afterClosed.next({type:e,data:t}),this.afterClosed.complete()}}var jg=n("+rOU");function Pg(e,t){if(1&e&&i.Qb(0,"div",4),2&e){const e=i.gc();i.lc("innerHTML",e.content,i.Ac)}}function Mg(e,t){1&e&&i.Rb(0)}function Ig(e,t){if(1&e&&(i.Tb(0),i.Kc(1,Mg,1,0,"ng-container",5),i.Sb()),2&e){const e=i.gc();i.Db(1),i.lc("ngTemplateOutlet",e.content)("ngTemplateOutletContext",e.context)}}function zg(e,t){1&e&&i.Rb(0)}function Tg(e,t){if(1&e&&(i.Tb(0),i.Kc(1,zg,1,0,"ng-container",6),i.Sb()),2&e){const e=i.gc();i.Db(1),i.lc("ngComponentOutlet",e.content)}}let Ug=(()=>{class e{constructor(e){this.popupRef=e,this.renderMethod="component"}ngOnInit(){this.content=this.popupRef.content,"string"==typeof this.content?this.renderMethod="text":this.content instanceof i.O&&(this.renderMethod="template",this.context={close:this.popupRef.close.bind(this.popupRef)})}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(_g))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-popup"]],decls:5,vars:4,consts:[[1,"popup"],[3,"ngSwitch"],[3,"innerHTML",4,"ngSwitchCase"],[4,"ngSwitchCase"],[3,"innerHTML"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[4,"ngComponentOutlet"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Tb(1,1),i.Kc(2,Pg,1,1,"div",2),i.Kc(3,Ig,2,2,"ng-container",3),i.Kc(4,Tg,2,1,"ng-container",3),i.Sb(),i.Ub()),2&e&&(i.Db(1),i.lc("ngSwitch",t.renderMethod),i.Db(1),i.lc("ngSwitchCase","text"),i.Db(1),i.lc("ngSwitchCase","template"),i.Db(1),i.lc("ngSwitchCase","component"))},directives:[ms.n,ms.o,ms.q,ms.j],styles:["[_nghost-%COMP%]{width:100%;height:100%}.popup[_ngcontent-%COMP%]{background:#fff;border-radius:4px;padding:8px;overflow-y:auto;box-shadow:1px -1px 2px 0 rgba(28,42,63,.1),0 1px 2px 0 rgba(28,42,63,.3)}"],changeDetection:0}),e})();var Lg=function(e){return e.Above="above",e.Below="below",e.Left="left",e.Right="right",e}({});const Dg={[Lg.Above]:{originX:"center",originY:"top",overlayX:"center",overlayY:"bottom",offsetY:-12},[Lg.Below]:{originX:"center",originY:"bottom",overlayX:"center",overlayY:"top",offsetY:12},[Lg.Left]:{originX:"start",originY:"center",overlayX:"end",overlayY:"center",offsetX:-12},[Lg.Right]:{originX:"end",originY:"center",overlayX:"start",overlayY:"center",offsetX:12}};let Eg=(()=>{class e{constructor(e,t){this.overlay=e,this.injector=t}open({origin:e,content:t,data:n,width:i,height:o}){const s=this.overlay.create(this.getOverlayConfig({origin:e,width:i,height:o})),r=new _g(s,t,n),a=this.createInjector(r,this.injector);return s.attach(new jg.c(Ug,null,a)),r}createInjector(e,t){const n=new WeakMap([[_g,e]]);return new jg.e(t,n)}getPositionStrategy(e,t){return this.overlay.position().flexibleConnectedTo(e).withPositions(this.getPositions(t))}getOverlayConfig({origin:e,width:t,height:n}){return new kg.d({width:t,height:n,hasBackdrop:!0,backdropClass:"popup-scrim",positionStrategy:this.getOverlayPosition(e),scrollStrategy:this.overlay.scrollStrategies.reposition()})}getOverlayPosition(e,t){return t=t||[Lg.Above,Lg.Below,Lg.Left,Lg.Right],this.overlay.position().flexibleConnectedTo(e).withPositions(this.getPositions(t)).withPush(!0)}getPositions(e){return e.map(e=>Dg[e])}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(kg.c),i.Zb(i.t))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),Fg=(()=>{class e{transform(e,t){return bg.normalize(""+(e||""))}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=i.Ob({name:"textNormalize",type:e,pure:!0}),e})();var Ag=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},Rg=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const Ng=["audio"],Vg=["title"],Hg=function(e){return{"view-description__story-title--large":e}};function Bg(e,t){if(1&e&&(i.Vb(0,"div",6),i.Mc(1),i.Ub()),2&e){const e=i.gc();i.lc("ngClass",i.oc(2,Hg,!e.chapterTitle)),i.Db(1),i.Oc(" ",e.storyTitle," ")}}function Qg(e,t){if(1&e&&(i.Vb(0,"span"),i.Mc(1),i.hc(2,"async"),i.Ub()),2&e){const e=i.gc();i.Db(1),i.Oc("",i.ic(2,1,e.chapterIndex$)+1,".")}}function $g(e,t){1&e&&i.Qb(0,"app-icon",7)}const qg=function(e,t,n){return{"view-title--clickable":e,"view-title--center":t,"view-title--large":n}};let Wg=(()=>{class e{constructor(e,t,n,o){this.layoutService=e,this.changeDetectorRef=t,this.popupService=n,this.store=o,this._isPopulated=!1,this.isPopulatedChange=new i.p,this._menuEnabled=!0,this.viewLayout=Cl,this.ngUnsubscribe=new $.a,this.storyTitle="",this.chapterTitle="",this.chapterAudio=null}get isPopulated(){return this._isPopulated}set isPopulated(e){this._isPopulated=e,this.isPopulatedChange.emit(this.isPopulated)}get menuEnabled(){return this._menuEnabled}set menuEnabled(e){this._menuEnabled=e}ngOnInit(){this.initContentListener(),this.initLayoutListener(),this.initChapterListener()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}isEnabled(e){return this.layoutService.isUIEnabled(e)}initContentListener(){Object(rs.b)(this.story$,this.chapter$).pipe(Object(K.a)(([e,t])=>null!=t&&null!=e),Object(W.a)(this.ngUnsubscribe)).subscribe(([e,t])=>{this.chapterTitle=bg.normalize(t.info.displayName),this.storyTitle=c.application!==o.Viewer?bg.normalize(e.displayName):"",this.chapterTitle=bg.normalize(t.info.displayName),this.isPopulated=!!this.chapterTitle||!!this.storyTitle})}initLayoutListener(){this.layout$.pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.changeDetectorRef.markForCheck()})}initChapterListener(){this.store.select(Bo.getSelectedChapterIndex).pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(()=>{this.chaptersPopup&&this.chaptersPopup.close()})}handleAudioPlayClick(){this.audio.playing?this.audio.pause():this.audio.play()}handleTitleClick(){this.menuEnabled&&(this.chaptersPopup?this.chaptersPopup.close():(this.chaptersPopup=this.popupService.open({origin:this.title.nativeElement,content:Sg,width:"300px"}),this.chaptersPopup.afterClosed$.pipe(Object(W.a)(this.ngUnsubscribe),Object(sl.a)(1)).subscribe(e=>{this.chaptersPopup=null})))}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(Ml),i.Pb(i.i),i.Pb(Eg),i.Pb(d.g))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-title"]],viewQuery:function(e,t){if(1&e&&(i.Rc(Ng,!0),i.Rc(Vg,!0)),2&e){let e;i.uc(e=i.dc())&&(t.audio=e.first),i.uc(e=i.dc())&&(t.title=e.first)}},inputs:{size:"size",alignTitle:"alignTitle",isPopulated:"isPopulated",menuEnabled:"menuEnabled"},outputs:{isPopulatedChange:"isPopulatedChange"},features:[i.Cb([Eg])],decls:11,vars:17,consts:[[1,"view-title",3,"ngClass","click"],["title",""],["class","view-title__story",3,"ngClass",4,"ngIf"],[1,"view-title__chapter"],[4,"ngIf"],["icon","caret-down",4,"ngIf"],[1,"view-title__story",3,"ngClass"],["icon","caret-down"]],template:function(e,t){1&e&&(i.Vb(0,"header",0,1),i.cc("click",(function(){return t.handleTitleClick()})),i.hc(2,"async"),i.Kc(3,Bg,2,4,"div",2),i.Vb(4,"h1",3),i.Kc(5,Qg,3,3,"span",4),i.hc(6,"async"),i.Mc(7),i.hc(8,"textNormalize"),i.Kc(9,$g,1,0,"app-icon",5),i.hc(10,"async"),i.Ub(),i.Ub()),2&e&&(i.lc("ngClass",i.qc(13,qg,i.ic(2,5,t.chapterCount$)>1&&t.menuEnabled,"center"===t.alignTitle,"large"===t.size)),i.Db(3),i.lc("ngIf",t.storyTitle&&t.storyTitle!=t.chapterTitle),i.Db(2),i.lc("ngIf",i.ic(6,7,t.chapterCount$)>1&&t.menuEnabled),i.Db(2),i.Oc(" ",i.ic(8,9,t.chapterTitle)," "),i.Db(2),i.lc("ngIf",i.ic(10,11,t.chapterCount$)>1&&t.menuEnabled))},directives:[ms.i,ms.l,$a],pipes:[ms.b,Fg],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3838}.text-info{color:#0060c4}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.view-title{font-size:14px;letter-spacing:.35px;line-height:1.4em;word-wrap:break-word;overflow-wrap:break-word;border-radius:4px;padding:4px;margin:0 -4px;transition:background-color 125ms}.view-title--center{text-align:center}.view-title--large{font-size:18px;letter-spacing:.45px;line-height:1.4em}.view-title--clickable:hover{background-color:var(--view-title-background--hover);cursor:pointer}.view-title__story{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase;word-wrap:break-word;overflow-wrap:break-word;font-weight:600;color:var(--view-description-secondary-color)}.view-title__chapter{font-weight:600;color:var(--view-title-color)}"],encapsulation:2,changeDetection:0}),Ag([Object(d.d)(Qr.getStory),Rg("design:type",q.a)],e.prototype,"story$",void 0),Ag([Object(d.d)(Bo.getSelectedChapter),Rg("design:type",q.a)],e.prototype,"chapter$",void 0),Ag([Object(d.d)(Bo.getChapterCount),Rg("design:type",q.a)],e.prototype,"chapterCount$",void 0),Ag([Object(d.d)(Bo.getSelectedChapterIndex),Rg("design:type",q.a)],e.prototype,"chapterIndex$",void 0),Ag([Object(d.d)(Bo.getSelectedChapterAudio),Rg("design:type",q.a)],e.prototype,"selectedChapterAudio$",void 0),Ag([Object(d.d)(il.getUI),Rg("design:type",q.a)],e.prototype,"layout$",void 0),e})();function Kg(e,t){if(1&e&&(i.Vb(0,"div",2),i.Vb(1,"div",3),i.Mc(2),i.Ub(),i.jc(3,1,["class","view-panel__actions","actions",""]),i.Ub()),2&e){const e=i.gc();i.Db(2),i.Oc(" ",e.label," ")}}const Gg=["*",[["","actions",""]]],Zg=function(e,t){return{"view-panel--padding-none":e,"view-panel--padding-dense":t}},Jg=["*","[actions]"];let Xg=(()=>{class e{constructor(){this.label="",this.showHeader=!0,this.padding="normal"}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-panel"]],inputs:{label:"label",showHeader:"showHeader",padding:"padding"},ngContentSelectors:Jg,decls:3,vars:5,consts:[[1,"view-panel",3,"ngClass"],["class","view-panel__header",4,"ngIf"],[1,"view-panel__header"],[1,"view-panel__label"]],template:function(e,t){1&e&&(i.kc(Gg),i.Vb(0,"div",0),i.Kc(1,Kg,4,1,"div",1),i.jc(2),i.Ub()),2&e&&(i.lc("ngClass",i.pc(2,Zg,"none"===t.padding,"dense"===t.padding)),i.Db(1),i.lc("ngIf",t.showHeader))},directives:[ms.i,ms.l],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3838}.text-info{color:#0060c4}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.view-panel{padding:0 0 32px;margin-bottom:16px;border-bottom:var(--view-panel-border)}.view-panel--padding-none{padding:0;margin:0}.view-panel--padding-dense{padding:0 0 8px;margin:0 0 8px}.view-panel__label{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase;color:var(--view-panel-color);font-weight:600;display:flex;align-items:center;min-height:28px}.view-panel__header{display:flex;flex-direction:row;align-items:flex-start;justify-content:space-between;margin-bottom:16px}"],encapsulation:2,changeDetection:0}),e})();var Yg=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},eh=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const th=["audio"];function nh(e,t){if(1&e&&(i.Vb(0,"div",3),i.Qb(1,"app-html",4),i.Ub()),2&e){const e=i.gc();i.Db(1),i.lc("markdownText",e.chapterDescription)}}const ih=function(e,t){return{"view-description--layout-column":e,"view-description--layout-drawer":t}};let oh=(()=>{class e{constructor(e,t,n){this.viewService=e,this.layoutService=t,this.changeDetectorRef=n,this.viewLayout=Cl,this.ngUnsubscribe=new $.a,this.storyTitle="",this.chapterTitle="",this.chapterDescription="",this.chapterAudio=null,this.layout=Sl.Drawer,this._isPopulated=!1,this.isPopulatedChange=new i.p}get isPopulated(){return this._isPopulated}set isPopulated(e){this._isPopulated=e,this.isPopulatedChange.emit(this.isPopulated)}ngOnInit(){this.initContentListener(),this.initLayoutListener()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}isEnabled(e){return this.layoutService.isUIEnabled(e)}initContentListener(){Object(rs.b)(this.story$,this.chapter$).pipe(Object(K.a)(([e,t])=>null!=e&&null!=t),Object(W.a)(this.ngUnsubscribe)).subscribe(([e,t])=>{this.storyTitle=c.application!==o.Viewer?bg.normalize(e.displayName):"",this.chapterTitle=bg.normalize(t.info.displayName),this.chapterDescription=Object(X.trim)(t.info.description),this.isPopulated=""!==this.storyTitle||!!this.chapterTitle||!!this.chapterDescription})}initLayoutListener(){this.layout$.pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.changeDetectorRef.markForCheck()})}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(Ip),i.Pb(Ml),i.Pb(i.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-description"]],viewQuery:function(e,t){if(1&e&&i.Rc(th,!0),2&e){let e;i.uc(e=i.dc())&&(t.audio=e.first)}},inputs:{layout:"layout",isPopulated:"isPopulated"},outputs:{isPopulatedChange:"isPopulatedChange"},decls:4,vars:5,consts:[[1,"view-description",3,"ngClass"],[1,"view-description__inner"],["class","view-description__body",4,"ngIf"],[1,"view-description__body"],[3,"markdownText"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Vb(1,"div",1),i.Vb(2,"article"),i.Kc(3,nh,2,1,"div",2),i.Ub(),i.Ub(),i.Ub()),2&e&&(i.lc("ngClass",i.pc(2,ih,"column"===t.layout,"drawer"===t.layout)),i.Db(3),i.lc("ngIf",t.chapterDescription))},directives:[ms.i,ms.l,Id],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3838}.text-info{color:#0060c4}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.view-description{color:var(--view-description-primary-color);display:flex;flex-direction:column;justify-content:left}.view-description--layout-column .view-description__chapter-title{font-size:18px;letter-spacing:.45px;line-height:1.4em}.view-description--layout-column .view-description__body{padding-top:12px}.view-description--layout-drawer .view-description__story-title{text-align:center}.view-description--layout-drawer .view-description__story-title--large{font-size:14px;letter-spacing:.35px;line-height:1.4em}.view-description--layout-drawer .view-description__body{padding-top:4px}.view-description__inner{flex:1 0 auto}.view-description__story-title{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase;word-wrap:break-word;overflow-wrap:break-word;flex-grow:1;font-weight:600;color:var(--view-description-secondary-color)}.view-description__story-title--large{font-size:18px;letter-spacing:.45px;line-height:1.4em;text-transform:none}.view-description__body{font-size:14px;letter-spacing:.35px;line-height:1.4em;word-wrap:break-word;overflow-wrap:break-word;padding-top:8px;color:var(--view-description-secondary-color)}"],encapsulation:2,changeDetection:0}),Yg([Object(d.d)(Qr.getStory),eh("design:type",q.a)],e.prototype,"story$",void 0),Yg([Object(d.d)(Bo.getSelectedChapter),eh("design:type",q.a)],e.prototype,"chapter$",void 0),Yg([Object(d.d)(Bo.getSelectedChapterIndex),eh("design:type",q.a)],e.prototype,"chapterIndex$",void 0),Yg([Object(d.d)(Bo.getChapterCount),eh("design:type",q.a)],e.prototype,"chapterCount$",void 0),Yg([Object(d.d)(il.getUI),eh("design:type",q.a)],e.prototype,"layout$",void 0),e})();function sh(e,t){if(1&e&&(i.Vb(0,"div",6),i.Mc(1),i.Ub()),2&e){const e=i.gc().$implicit;i.Db(1),i.Nc(e.description)}}function rh(e,t){if(1&e&&(i.Vb(0,"li",2),i.Qb(1,"div",3),i.Vb(2,"div",4),i.Vb(3,"div"),i.Mc(4),i.Ub(),i.Kc(5,sh,2,1,"div",5),i.Ub(),i.Ub()),2&e){const e=t.$implicit,n=i.gc();i.Db(1),i.Hc("background-color",n.getComputedColor(e.colors)),i.Db(3),i.Nc(e.label),i.Db(1),i.lc("ngIf",e.description)}}let ah=(()=>{class e{constructor(){}ngOnInit(){}getComputedColor(e){return Eo.rgbToHex(e,!0)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-legend"]],inputs:{legend:"legend"},decls:2,vars:1,consts:[["aria-label","Legend",1,"view-legend"],["class","view-legend__item","tabindex","0",4,"ngFor","ngForOf"],["tabindex","0",1,"view-legend__item"],[1,"view-legend__color","mh-2"],[1,"view-legend__content","text-14"],["class","mv-2",4,"ngIf"],[1,"mv-2"]],template:function(e,t){1&e&&(i.Vb(0,"ul",0),i.Kc(1,rh,6,4,"li",1),i.Ub()),2&e&&(i.Db(1),i.lc("ngForOf",t.legend))},directives:[ms.k,ms.l],styles:['.view-legend{display:flex;flex-direction:column}.view-legend__item{padding:8px 0;display:flex;flex-direction:row;justify-content:flex-start;align-items:flex-start}.view-legend__content{display:flex;flex-direction:column}.view-legend__color{content:" ";display:block;flex:0 0 16px;width:16px;height:16px;border-radius:50%}.view-legend__color:after{content:" "}'],encapsulation:2,changeDetection:0}),e})();var ch=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},lh=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const ph=function(e){return{"view-labels__item--selected":e}};function dh(e,t){if(1&e){const e=i.Wb();i.Vb(0,"li",2),i.cc("click",(function(){i.zc(e);const n=t.$implicit;return i.gc().handleLabelClick(n)}))("keyup.enter",(function(){i.zc(e);const n=t.$implicit;return i.gc().handleLabelClick(n)})),i.hc(1,"async"),i.Vb(2,"div",3),i.Vb(3,"div",4),i.Qb(4,"app-label-pin",5),i.Ub(),i.Ub(),i.Vb(5,"div",6),i.Qb(6,"div",7),i.hc(7,"markdown"),i.Ub(),i.Ub()}if(2&e){const e=t.$implicit,n=i.gc();let o=null;i.lc("ngClass",i.oc(9,ph,(null==(o=i.ic(1,5,n.selectedLabel$))?null:o.id)===e.id)),i.Eb("aria-label",e.title),i.Db(4),i.lc("label",e)("sequence",n.getLabelSequence(e)),i.Db(2),i.lc("innerHTML",i.ic(7,7,e.title),i.Ac)}}let uh=(()=>{class e{constructor(e,t){this.viewService=e,this.store=t,this.labelPinType=vn,this.labelSequentialtype=On}ngOnInit(){}getLabelSequence(e){return this.store.selectSnapshot(Tr.getLabelSequence(e))}handleLabelClick(e){this.viewService.selectLabel(e,!0)}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(Ip),i.Pb(d.g))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-labels"]],decls:3,vars:3,consts:[["role","complementary","aria-label","Labels",1,"view-labels"],["role","button","class","view-labels__item","tabindex","0",3,"ngClass","click","keyup.enter",4,"ngFor","ngForOf"],["role","button","tabindex","0",1,"view-labels__item",3,"ngClass","click","keyup.enter"],[1,"view-labels__pre"],[1,"view-labels__pin"],[3,"label","sequence"],[1,"view-labels__body"],[1,"view-labels__title","html",3,"innerHTML"]],template:function(e,t){1&e&&(i.Vb(0,"ul",0),i.Kc(1,dh,8,11,"li",1),i.hc(2,"async"),i.Ub()),2&e&&(i.Db(1),i.lc("ngForOf",i.ic(2,1,t.labels$)))},directives:[ms.k,ms.i,Qp],pipes:[ms.b,cd.b],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3838}.text-info{color:#0060c4}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.view-labels__item{border-left:4px solid transparent;border-left:var(--view-labels-border);border-radius:2px;display:flex;padding:12px 8px;margin-bottom:4px;cursor:pointer;transition:background-color 125ms,color 125ms,border 125ms}.view-labels__item:focus{background:#f1f4fa;outline:none}.view-labels__item:hover{background:#f1f5fc;background:var(--view-labels-bg--hover)}.view-labels__item--selected{background:#f1f5fc;border-left:4px solid #2d72dc;background:var(--view-labels-bg--selected);border-left:var(--view-labels-border--selected)}.view-labels__pre{flex:0 0 32px;display:flex;justify-content:center;position:relative}.view-labels__pin{display:flex;align-items:center;justify-content:center;position:absolute}.view-labels__description,.view-labels__title{font-size:14px;letter-spacing:.35px;line-height:1.4em}.view-labels__description{color:#374a68;color:var(--view-labels-description-color);padding-top:4px}.view-labels__label{position:absolute;font-size:10px;top:3px}"],encapsulation:2,changeDetection:0}),ch([Object(d.d)(Tr.getChapterLabels),lh("design:type",q.a)],e.prototype,"labels$",void 0),ch([Object(d.d)(Tr.getSelectedLabel),lh("design:type",q.a)],e.prototype,"selectedLabel$",void 0),e})();var gh=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},hh=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function bh(e,t){if(1&e&&(i.Vb(0,"div"),i.Qb(1,"app-content-blocks",7),i.hc(2,"async"),i.Ub()),2&e){const e=i.gc(2);i.Db(1),i.lc("contentBlocks",i.ic(2,2,e.contentBlocks$))("include",e.contentBlockTypes.Ticker)}}function mh(e,t){if(1&e&&(i.Vb(0,"div"),i.Qb(1,"app-content-blocks",8),i.hc(2,"async"),i.Ub()),2&e){const e=i.gc(2);i.Db(1),i.lc("contentBlocks",i.ic(2,2,e.contentBlocks$))("exclude",e.contentBlockTypes.Ticker)}}function fh(e,t){if(1&e){const e=i.Wb();i.Vb(0,"app-view-panel",4),i.Kc(1,bh,3,4,"div",5),i.hc(2,"async"),i.Vb(3,"app-view-description",6),i.cc("isPopulatedChange",(function(t){return i.zc(e),i.gc().isPopulated=t})),i.Ub(),i.Kc(4,mh,3,4,"div",5),i.hc(5,"async"),i.Ub()}if(2&e){const e=i.gc();let t=null,n=null;i.lc("showHeader",!1)("hidden",!e.isPopulated),i.Db(1),i.lc("ngIf",(null==(t=i.ic(2,6,e.contentBlocks$))?null:t.length)>0),i.Db(2),i.lc("isPopulated",e.isPopulated)("layout",e.layout),i.Db(1),i.lc("ngIf",(null==(n=i.ic(5,8,e.contentBlocks$))?null:n.length)>0)}}function yh(e,t){if(1&e&&(i.Vb(0,"app-view-panel",9),i.Qb(1,"app-view-legend",10),i.hc(2,"async"),i.Ub()),2&e){const e=i.gc();i.Db(1),i.lc("legend",i.ic(2,1,e.chapter$).legend)}}function xh(e,t){if(1&e){const e=i.Wb();i.Vb(0,"div",13),i.Vb(1,"button",14),i.cc("click",(function(){return i.zc(e),i.gc(2).handlePrevClick()})),i.Ub(),i.Vb(2,"button",15),i.cc("click",(function(){return i.zc(e),i.gc(2).handleNextClick()})),i.Ub(),i.Ub()}}function vh(e,t){if(1&e&&(i.Vb(0,"app-view-panel",11),i.Kc(1,xh,3,0,"div",12),i.hc(2,"async"),i.Qb(3,"app-view-labels"),i.Ub()),2&e){const e=i.gc();let t=null;i.Db(1),i.lc("ngIf",(null==(t=i.ic(2,1,e.labels$))?null:t.length)>1)}}let wh=(()=>{class e{constructor(e,t,n,i){this.store=e,this.viewService=t,this.layoutService=n,this.changeDetectorRef=i,this.ngUnsubscribe=new $.a,this.layout=Sl.Column,this.viewLayout=Cl,this.isPopulated=!0,this.descriptionVisible=!1,this.legendVisible=!1,this.labelListVisible=!1,this.contentBlockTypes=Pi}ngOnInit(){this.store.select(il.getUI).pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(()=>{this.descriptionVisible=this.isVisible(Cl.Description),this.legendVisible=this.isVisible(Cl.Legend),this.labelListVisible=this.isVisible(Cl.LabelList),this.changeDetectorRef.markForCheck()})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}isVisible(e){return this.layoutService.isUIVisible(e)}isEnabled(e){return this.layoutService.isUIEnabled(e)}handlePrevClick(){this.selectLabel(-1)}handleNextClick(){this.selectLabel(1)}selectLabel(e){const t=this.store.selectSnapshot(Tr.getChapterLabels),n=t.length,i=this.store.selectSnapshot(Tr.getSelectedLabelId),o=t.findIndex(e=>e.id===i),s=t[((-1!==o?o+e:0)%n+n)%n];s&&this.viewService.selectLabel(s,!0)}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.g),i.Pb(Ip),i.Pb(Ml),i.Pb(i.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-content-mode"]],inputs:{layout:"layout"},decls:7,vars:9,consts:[["gaCategory","View Information Panel",1,"view-content-mode"],[3,"showHeader","hidden",4,"ngIf"],["label","Legend",4,"ngIf"],["label","Labels",4,"ngIf"],[3,"showHeader","hidden"],[4,"ngIf"],[3,"isPopulated","layout","isPopulatedChange"],[3,"contentBlocks","include"],[3,"contentBlocks","exclude"],["label","Legend"],[3,"legend"],["label","Labels"],["actions","","class","flex",4,"ngIf"],["actions","",1,"flex"],["gaEvent","","gaAction","Clicked Previous Label","app-pin-button","","icon","chevron-left","size","small","buttonType","ghost","matTooltip","Previous Label",3,"click"],["gaEvent","","gaAction","Clicked Next Label","app-pin-button","","icon","chevron-right","size","small","buttonType","ghost","matTooltip","Next Label",3,"click"]],template:function(e,t){if(1&e&&(i.Vb(0,"div",0),i.Kc(1,fh,6,10,"app-view-panel",1),i.Kc(2,yh,3,3,"app-view-panel",2),i.hc(3,"async"),i.hc(4,"async"),i.Kc(5,vh,4,3,"app-view-panel",3),i.hc(6,"async"),i.Ub()),2&e){let e=null,n=null;i.Db(1),i.lc("ngIf",t.descriptionVisible),i.Db(1),i.lc("ngIf",(null==(e=i.ic(3,3,t.chapter$))?null:e.legend)&&(null==(e=i.ic(4,5,t.chapter$))?null:e.legend.length)>0&&t.legendVisible),i.Db(3),i.lc("ngIf",(null==(n=i.ic(6,7,t.labels$))?null:n.length)&&t.labelListVisible)}},directives:[J.a,ms.l,Xg,oh,au,ah,uh,Ad,J.b,Rd.c],pipes:[ms.b],styles:[".view-content-mode[_ngcontent-%COMP%]{padding-bottom:24px}"],changeDetection:0}),gh([Object(d.d)(Bo.getStoryChapters),hh("design:type",q.a)],e.prototype,"chapters$",void 0),gh([Object(d.d)(Bo.getSelectedChapter),hh("design:type",q.a)],e.prototype,"chapter$",void 0),gh([Object(d.d)(Bo.getSelectedChapterContentBlocks),hh("design:type",q.a)],e.prototype,"contentBlocks$",void 0),gh([Object(d.d)(Tr.getChapterLabels),hh("design:type",q.a)],e.prototype,"labels$",void 0),e})();function Oh(e,t){if(1&e&&(i.Vb(0,"span"),i.Mc(1),i.Ub()),2&e){const e=i.gc();i.Db(1),i.Oc(" of ",e.total,"")}}let Ch=(()=>{class e{constructor(){this.index=0,this.total=0}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-quiz-progress"]],inputs:{index:"index",total:"total"},decls:4,vars:2,consts:[["data-test","quizProgress",1,"view-quiz-progress"],[1,"text-semibold"],[4,"ngIf"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Vb(1,"span",1),i.Mc(2),i.Ub(),i.Kc(3,Oh,2,1,"span",2),i.Ub()),2&e&&(i.Db(2),i.Oc("Question ",t.index+1,""),i.Db(1),i.lc("ngIf",t.total>1))},directives:[ms.l],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3838}.text-info[_ngcontent-%COMP%]{color:#0060c4}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.view-quiz-progress[_ngcontent-%COMP%]{color:#374a68;font-size:12px;letter-spacing:.3px;line-height:1.4em}"],changeDetection:0}),e})();var Sh=n("QibW");const kh=[[["app-list-item"]]],_h=["app-list-item"];var jh=function(e){return e.Default="default",e.Commafied="commafied",e.flat="flat",e.inline="inline",e}({});let Ph=(()=>{class e{constructor(){this.listType=jh.Default}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-list"]],inputs:{listType:"listType"},ngContentSelectors:_h,decls:2,vars:1,consts:[[1,"list",3,"ngClass"]],template:function(e,t){1&e&&(i.kc(kh),i.Vb(0,"div",0),i.jc(1),i.Ub()),2&e&&i.lc("ngClass","list--"+t.listType)},directives:[ms.i],styles:['.list{display:flex;flex-direction:column}.list--default app-list-item{display:list-item;margin-left:16px;list-style-type:disc}.list--commafied{align-items:center;display:flex;flex-direction:row;flex-wrap:wrap;padding:0 4px 4px 0}.list--commafied app-list-item:not(:last-child):after{content:", ";float:right;padding-right:4px}.list--flat app-list-item:not(:last-child){margin-bottom:4px}.list--inline{display:inline-flex;align-items:center;display:flex;flex-direction:row;flex-wrap:wrap}.list--inline app-list-item{margin:0 8px 4px 0}.list__item{display:block}'],encapsulation:2,changeDetection:0}),e})();const Mh=["*"];let Ih=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-list-item"]],ngContentSelectors:Mh,decls:1,vars:0,template:function(e,t){1&e&&(i.kc(),i.jc(0))},styles:[""],encapsulation:2,changeDetection:0}),e})();function zh(e,t){if(1&e&&(i.Vb(0,"app-list-item"),i.Vb(1,"div",1),i.Mc(2),i.Ub(),i.Ub()),2&e){const e=t.$implicit;i.Db(1),i.Eb("data-id",e.id),i.Db(1),i.Nc(e.label)}}let Th=(()=>{class e{constructor(e,t,n){this.store=e,this.graphService=t,this.changeRef=n}get objectIds(){return this._objectIds}set objectIds(e){this._objectIds=e;const t=this.store.selectSnapshot(is.getViewGraph);this.nodes=this.graphService.getNodes(t,e),this.changeRef.markForCheck()}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.g),i.Pb(tt),i.Pb(i.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-quiz-object-tree"]],inputs:{objectIds:"objectIds"},decls:2,vars:1,consts:[[4,"ngFor","ngForOf"],[1,"text-14","text-medium","mv-1"]],template:function(e,t){1&e&&(i.Vb(0,"app-list"),i.Kc(1,zh,3,2,"app-list-item",0),i.Ub()),2&e&&(i.Db(1),i.lc("ngForOf",t.nodes))},directives:[Ph,ms.k,Ih],styles:[""],changeDetection:0}),e})(),Uh=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-quiz-answer-number"]],inputs:{number:"number"},decls:3,vars:1,consts:[[1,"number","text-10","text-medium"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Vb(1,"div"),i.Mc(2),i.Ub(),i.Ub()),2&e&&(i.Db(2),i.Nc(t.number))},styles:[".number[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:20px;height:20px;color:#131c2a;border:1px solid rgba(55,74,104,.5);border-radius:50%}"],changeDetection:0}),e})();var Lh=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Dh(e,t){if(1&e&&(i.Vb(0,"div",3),i.Vb(1,"div",4),i.Qb(2,"app-view-quiz-answer-number",5),i.Ub(),i.Vb(3,"div",6),i.Qb(4,"app-quiz-label-anatomy-select",7),i.Ub(),i.Ub()),2&e){const e=t.index,n=i.gc();i.Db(2),i.lc("number",e+1),i.Db(2),i.lc("options",n.options)("formControlName",e)}}let Eh=(()=>{class e{constructor(e){this.formBuilder=e,this.valueChange=new i.p,this.ngUnsubscribe=new $.a,this._options=[],this.form=this.formBuilder.group({options:this.formBuilder.array([])}),this.optionsArray=this.form.get("options")}get options(){return this._options}set options(e){Object(X.isEqual)(e,this._options)||(this._options=e,this.buildFormOptions(e))}ngOnInit(){this.initFormListeners(),this.init()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initFormListeners(){this.form.valueChanges.pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(({options:e})=>{this.valueChange.next(e)})}init(){this.activeSubmission$.pipe(Object(K.a)(e=>!Object(X.isNil)(e)&&!Object(X.isNil)(e.answer)),Object(us.a)(),Object(W.a)(this.ngUnsubscribe)).subscribe(([e,t])=>{const n=function(e,t,n){const i=t.findIndex((t,n)=>{const i=e[n];return!Object(X.isEqual)(i,t)}),o=t[i];return t.map((e,t)=>Object(X.isEqual)(o,e)&&t!==i?"":e)}(e.answer||[],t.answer||[]);Object(X.isEqual)(t,n)||this.form.patchValue({options:n||[]})}),this.activeSubmission$.pipe(Object(K.a)(e=>!Object(X.isNil)(e)&&!Object(X.isNil)(e.answer)&&Array.isArray(e.answer)),Object(ls.a)((e,t)=>Object(X.isEqual)(e,t)),Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{const t=this.form.value.options,n=e.answer;Object(X.isEqual)(t,n)||this.form.patchValue({options:n},{emitEvent:!1,onlySelf:!0})})}buildFormOptions(e){this.optionsArray.clear(),e.forEach(()=>{this.optionsArray.push(this.formBuilder.control(""))}),this.optionsArray.setValue(e.map(()=>""))}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(gu.d))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-quiz-label-anatomy"]],inputs:{options:"options"},outputs:{valueChange:"valueChange"},decls:3,vars:2,consts:[[1,"options",3,"formGroup"],["formArrayName","options"],["class","options__item mb-4","data-test","questionAnswer",4,"ngFor","ngForOf"],["data-test","questionAnswer",1,"options__item","mb-4"],[1,"mr-2"],[3,"number"],[1,"options__item-select"],[3,"options","formControlName"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Vb(1,"div",1),i.Kc(2,Dh,5,3,"div",2),i.Ub(),i.Ub()),2&e&&(i.lc("formGroup",t.form),i.Db(2),i.lc("ngForOf",t.options))},directives:[gu.n,gu.h,gu.c,ms.k,Uh,yu,gu.m,gu.g],styles:[".options__item[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}.options__item-select[_ngcontent-%COMP%]{border:1px solid #96a8c0;border-radius:4px;flex:1 1 auto}"],changeDetection:0}),function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);s>3&&r&&Object.defineProperty(t,n,r)}([Object(d.d)(Bi.getActiveSubmission),Lh("design:type",q.a)],e.prototype,"activeSubmission$",void 0),e})();var Fh=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},Ah=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Rh(e,t){if(1&e&&(i.Vb(0,"mat-radio-button",8),i.Mc(1),i.Ub()),2&e){const e=t.$implicit;i.lc("value",e.value),i.Db(1),i.Oc(" ",e.label," ")}}function Nh(e,t){if(1&e){const e=i.Wb();i.Vb(0,"div"),i.Vb(1,"mat-radio-group",6),i.cc("change",(function(t){return i.zc(e),i.gc(2).handleMultipleChoiceChange(t)})),i.Kc(2,Rh,2,2,"mat-radio-button",7),i.Ub(),i.Ub()}if(2&e){const e=i.gc(2);i.Db(2),i.lc("ngForOf",e.question.data.options)}}function Vh(e,t){if(1&e&&(i.Vb(0,"div",10),i.Qb(1,"app-view-quiz-object-tree",11),i.Ub()),2&e){const e=i.gc(3);i.Db(1),i.lc("objectIds",e.question.data.correctAnswer)}}function Hh(e,t){if(1&e&&(i.Vb(0,"div"),i.Kc(1,Vh,2,1,"div",9),i.Ub()),2&e){const e=i.gc(2);i.Db(1),i.lc("ngIf",e.question.data.showAnswerList)}}function Bh(e,t){if(1&e){const e=i.Wb();i.Vb(0,"div"),i.Vb(1,"app-view-quiz-label-anatomy",12),i.cc("valueChange",(function(t){return i.zc(e),i.gc(2).handleLabelAnatomyChanges(t)})),i.Ub(),i.Ub()}if(2&e){const e=i.gc(2);i.Db(1),i.lc("options",e.question.data.options)}}function Qh(e,t){if(1&e&&(i.Vb(0,"div",1),i.Vb(1,"div",2),i.Qb(2,"app-content-blocks",3),i.Ub(),i.Vb(3,"div",4),i.Kc(4,Nh,3,1,"div",5),i.Kc(5,Hh,2,1,"div",5),i.Kc(6,Bh,2,1,"div",5),i.Ub(),i.Ub()),2&e){const e=i.gc();i.Db(2),i.lc("contentBlocks",e.question.questionPrompt),i.Db(1),i.lc("ngSwitch",e.question.type),i.Db(1),i.lc("ngSwitchCase",e.QuestionType.MultipleChoice),i.Db(1),i.lc("ngSwitchCase",e.QuestionType.SelectAnatomy),i.Db(1),i.lc("ngSwitchCase",e.QuestionType.LabelAnatomy)}}let $h=(()=>{class e{constructor(e){this.changeRef=e,this.disabled=!1,this.QuestionType=Mi,this.ngUnsubscribe=new $.a}get question(){return this._question}set question(e){this._question=e,this.initQuestionListeners()}get value(){return this._value}set value(e){this._value=e,this.onChange(e)}handleMultipleChoiceChange(e){this.writeValue(e.value)}handleLabelAnatomyChanges(e){this.writeValue(e)}ngOnInit(){}initQuestionListeners(){switch(this.question.type){case Mi.SelectAnatomy:this.initSelectAnatomyListeners();break;case Mi.Instructions:this.initInstructions()}}initSelectAnatomyListeners(){this.checkedNodesIds$.pipe(Object(ls.a)((e,t)=>Object(X.isEqual)(e,t)),Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.writeValue(e),this.changeRef.markForCheck()})}initInstructions(){setTimeout(()=>{this.writeValue("-"),this.changeRef.markForCheck()})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}onChange(e){}onTouched(){}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}writeValue(e){this.value=e}setDisabledState(e){this.disabled=e}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(i.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-quiz-question"]],inputs:{question:"question",value:"value"},features:[i.Cb([{provide:gu.k,useExisting:Object(i.W)(()=>e),multi:!0}])],decls:1,vars:1,consts:[["class","view-quiz-question text-14 mb-8","data-test","question",4,"ngIf"],["data-test","question",1,"view-quiz-question","text-14","mb-8"],["data-test","questionPrompt",1,"view-quiz-question__prompt","mb-4"],[3,"contentBlocks"],[3,"ngSwitch"],[4,"ngSwitchCase"],[1,"flex","flex-column",3,"change"],["data-test","questionAnswer","class","view-quiz-question__option",3,"value",4,"ngFor","ngForOf"],["data-test","questionAnswer",1,"view-quiz-question__option",3,"value"],["class","ml-3",4,"ngIf"],[1,"ml-3"],[3,"objectIds"],[3,"options","valueChange"]],template:function(e,t){1&e&&i.Kc(0,Qh,7,5,"div",0),2&e&&i.lc("ngIf",t.question)},directives:[ms.l,au,ms.n,ms.o,Sh.b,ms.k,Sh.a,Th,Eh],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3838}.text-info{color:#0060c4}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.view-quiz-question__option{font-size:14px;letter-spacing:.35px;line-height:1.4em;padding:12px 0 12px 12px}.view-quiz-question__option,.view-quiz-question__option>*{white-space:normal!important}.view-quiz-question__option .mat-radio-label{align-items:flex-start!important}.view-quiz-question__option .mat-radio-label-content{padding-left:12px!important}"],encapsulation:2,changeDetection:0}),Fh([Object(d.d)(ii.getCheckedNodeIds),Ah("design:type",q.a)],e.prototype,"checkedNodesIds$",void 0),Fh([Object(d.d)(Bi.getActiveSubmission),Ah("design:type",q.a)],e.prototype,"activeSubmission$",void 0),e})();function qh(e,t){1&e&&i.Qb(0,"app-icon",6)}function Wh(e,t){1&e&&i.Qb(0,"app-icon",7)}function Kh(e,t){1&e&&(i.Vb(0,"span",8),i.Qb(1,"span",9),i.Ub())}const Gh=["*"];let Zh=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-quiz-answer-option"]],inputs:{correct:"correct"},ngContentSelectors:Gh,decls:7,vars:7,consts:[["data-test","answerOptionContainer",1,"option"],[1,"flex","relative",3,"ngSwitch"],["class","option__icon option__icon--correct","style","font-size: 20px","icon","check-circle",4,"ngSwitchCase"],["class","option__icon option__icon--incorrect","style","font-size: 20px","icon","times-circle",4,"ngSwitchCase"],["class","option__icon",4,"ngSwitchDefault"],[1,"pl-2"],["icon","check-circle",1,"option__icon","option__icon--correct",2,"font-size","20px"],["icon","times-circle",1,"option__icon","option__icon--incorrect",2,"font-size","20px"],[1,"option__icon"],[1,"mat-radio-outer-circle"]],template:function(e,t){1&e&&(i.kc(),i.Vb(0,"div",0),i.Vb(1,"div",1),i.Kc(2,qh,1,0,"app-icon",2),i.Kc(3,Wh,1,0,"app-icon",3),i.Kc(4,Kh,2,0,"span",4),i.Vb(5,"div",5),i.jc(6),i.Ub(),i.Ub(),i.Ub()),2&e&&(i.Hb("option--correct",!0===t.correct)("option--incorrect",!1===t.correct),i.Db(1),i.lc("ngSwitch",t.correct),i.Db(1),i.lc("ngSwitchCase",!0),i.Db(1),i.lc("ngSwitchCase",!1))},directives:[ms.n,ms.o,ms.p,$a],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3838}.text-info[_ngcontent-%COMP%]{color:#0060c4}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.option[_ngcontent-%COMP%]{padding:12px;border-radius:4px;margin-bottom:8px;color:#131c2a}.option--correct[_ngcontent-%COMP%]{border:1px solid #73b676;background-color:#eaf8ec}.option--incorrect[_ngcontent-%COMP%]{border:1px solid #cb4039;background-color:#f6dada}.option__icon[_ngcontent-%COMP%]{position:relative;flex:0 0 20px;justify-content:center}.option__icon--correct[_ngcontent-%COMP%]{color:#73b676}.option__icon--incorrect[_ngcontent-%COMP%]{color:#cb4039}"],changeDetection:0}),e})();function Jh(e,t){if(1&e&&(i.Vb(0,"div"),i.Vb(1,"app-view-quiz-answer-option",1),i.Vb(2,"div",2),i.Mc(3),i.Ub(),i.Ub(),i.Ub()),2&e){const e=t.$implicit,n=i.gc();i.Db(1),i.lc("correct",n.isOptionAnswerCorrect(n.question,e.value,n.answer)),i.Db(2),i.Oc(" ",e.label," ")}}let Xh=(()=>{class e{constructor(){}ngOnInit(){}isOptionAnswerCorrect(e,t,n){const i=Ti(e,[t]);return t===n[0]||i?i:void 0}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-quiz-multiple-choice-answer"]],inputs:{question:"question",answer:"answer",summary:"summary"},decls:1,vars:1,consts:[[4,"ngFor","ngForOf"],[3,"correct"],[1,"text-semibold"]],template:function(e,t){1&e&&i.Kc(0,Jh,4,2,"div",0),2&e&&i.lc("ngForOf",t.question.data.options)},directives:[ms.k,Zh],styles:[""],changeDetection:0}),e})();function Yh(e,t){if(1&e){const e=i.Wb();i.Vb(0,"div",7),i.Vb(1,"button",8),i.cc("click",(function(){i.zc(e);const t=i.gc();return t.handleSelectedObjectsClick(t.answer)})),i.Mc(2,"Highlight My Answer"),i.Ub(),i.Vb(3,"button",9),i.cc("click",(function(){i.zc(e);const t=i.gc();return t.handleCorrectObjectsClick(t.question.data.correctAnswer)})),i.Mc(4,"Highlight Correct Answer"),i.Ub(),i.Ub()}}let eb=(()=>{class e{constructor(e){this.store=e}get isCorrect(){return Ti(this.question,this.answer)}ngOnInit(){}handleSelectedObjectsClick(e){this.setSelectedObjects(e)}handleCorrectObjectsClick(e){this.setSelectedObjects(e)}setSelectedObjects(e){const t=e.filter(e=>e&&""!==e);this.store.dispatch(new $n.UpdateNodesChecked(!1)),this.store.dispatch(new $n.UpdateNodesChecked(!0,t))}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.g))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-quiz-select-anatomy-answer"]],inputs:{question:"question",answer:"answer",summary:"summary"},decls:11,vars:5,consts:[[1,"mb-8","ml-3"],[3,"objectIds"],[3,"correct"],["selectAnatomyAnswer",""],[1,"flex","flex-column","text-semibold"],[1,"mt-2","ml-2"],["class","mt-4",4,"ngIf"],[1,"mt-4"],["buttonType","outline","buttonTheme","light","app-button","","data-test","highlightUserAnswers",1,"w-100","mv-2",3,"click"],["buttonType","outline","buttonTheme","light","app-button","","data-test","highlightCorrectAnswers",1,"w-100","mv-2",3,"click"]],template:function(e,t){if(1&e&&(i.Vb(0,"div"),i.Vb(1,"div",0),i.Qb(2,"app-view-quiz-object-tree",1),i.Ub(),i.Vb(3,"app-view-quiz-answer-option",2,3),i.Vb(5,"div",4),i.Vb(6,"div"),i.Mc(7),i.Ub(),i.Vb(8,"div",5),i.Qb(9,"app-view-quiz-object-tree",1),i.Ub(),i.Ub(),i.Ub(),i.Kc(10,Yh,5,0,"div",6),i.Ub()),2&e){const e=i.vc(4);i.Db(2),i.lc("objectIds",t.question.data.correctAnswer),i.Db(1),i.lc("correct",t.isCorrect),i.Db(4),i.Oc(" ",e.correct?"Correct":"Incorrect","! You selected: "),i.Db(2),i.lc("objectIds",t.answer),i.Db(1),i.lc("ngIf",!t.summary&&!t.isCorrect)}},directives:[Th,Zh,ms.l,nc],styles:[""],changeDetection:0}),e})();function tb(e,t){if(1&e&&(i.Vb(0,"div",9),i.Mc(1),i.Ub()),2&e){const e=i.gc().$implicit;i.Db(1),i.Oc(" ",e.label.title," ")}}function nb(e,t){if(1&e&&(i.Vb(0,"div"),i.Mc(1," You selected "),i.Vb(2,"em",9),i.Mc(3),i.Ub(),i.Mc(4,". "),i.Ub(),i.Vb(5,"div",10),i.Mc(6," This is the "),i.Vb(7,"em",9),i.Mc(8),i.Ub(),i.Mc(9,". "),i.Ub()),2&e){const e=i.gc(),t=e.index,n=e.$implicit,o=i.gc();i.Db(3),i.Nc(o.getSelectedUserOption(t).label.title),i.Db(5),i.Nc(n.label.title)}}function ib(e,t){if(1&e&&(i.Vb(0,"div",1),i.Vb(1,"div",2),i.Qb(2,"app-view-quiz-answer-number",3),i.Ub(),i.Vb(3,"div",4),i.Vb(4,"app-view-quiz-answer-option",5,6),i.Kc(6,tb,2,1,"div",7),i.Kc(7,nb,10,2,"ng-template",null,8,i.Lc),i.Ub(),i.Ub(),i.Ub()),2&e){const e=t.index,n=i.vc(5),o=i.vc(8),s=i.gc();i.Db(2),i.lc("number",e+1),i.Db(2),i.lc("correct",s.isOptionAnswerCorrect(e)),i.Db(2),i.lc("ngIf",n.correct)("ngIfElse",o)}}let ob=(()=>{class e{constructor(){}ngOnInit(){}isOptionAnswerCorrect(e){return this.answer[e]===this.question.data.correctAnswer[e]}getSelectedUserOption(e){const t=this.answer[e];return this.question.data.options.find(e=>e.value===t)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-quiz-label-anatomy-answer"]],inputs:{question:"question",answer:"answer",summary:"summary"},decls:1,vars:1,consts:[["class","answers",4,"ngFor","ngForOf"],[1,"answers"],[1,"mt-2","mr-2"],[3,"number"],[1,"answers__option"],[3,"correct"],["answerOption",""],["class","text-semibold",4,"ngIf","ngIfElse"],["falseBlock",""],[1,"text-semibold"],[1,"mt-1"]],template:function(e,t){1&e&&i.Kc(0,ib,9,4,"div",0),2&e&&i.lc("ngForOf",t.question.data.options)},directives:[ms.k,Uh,Zh,ms.l],styles:[".answers[_ngcontent-%COMP%]{display:flex;flex-direction:row}.answers__option[_ngcontent-%COMP%]{flex:1 1 auto}"],changeDetection:0}),e})();function sb(e,t){if(1&e&&(i.Vb(0,"div",7),i.Mc(1),i.Ub()),2&e){const e=i.gc();i.Db(1),i.Oc("",e.questionNumber,".")}}function rb(e,t){if(1&e&&(i.Vb(0,"div"),i.Qb(1,"app-view-quiz-multiple-choice-answer",8),i.Ub()),2&e){const e=i.gc();i.Db(1),i.lc("question",e.question)("answer",e.answer)("summary",e.summary)}}function ab(e,t){if(1&e&&(i.Vb(0,"div"),i.Qb(1,"app-view-quiz-select-anatomy-answer",8),i.Ub()),2&e){const e=i.gc();i.Db(1),i.lc("question",e.question)("answer",e.answer)("summary",e.summary)}}function cb(e,t){if(1&e&&(i.Vb(0,"div"),i.Qb(1,"app-view-quiz-label-anatomy-answer",8),i.Ub()),2&e){const e=i.gc();i.Db(1),i.lc("question",e.question)("answer",e.answer)("summary",e.summary)}}let lb=(()=>{class e{constructor(e){this.store=e,this.QuestionType=Mi}ngOnInit(){this.initAnswerConfig()}initAnswerConfig(){const{type:e}=this.question;this.store.dispatch(new ji.SetQuizPickMode(e===Mi.SelectAnatomy?"none":"single"))}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.g))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-quiz-answer"]],inputs:{question:"question",questionNumber:"questionNumber",answer:"answer",summary:"summary"},decls:11,vars:7,consts:[["data-test","answer",1,"answer"],[1,"answer__prompt"],["class","mr-1",4,"ngIf"],[3,"contentBlocks"],[3,"ngSwitch"],[4,"ngSwitchCase"],[1,"answer__explanation"],[1,"mr-1"],[3,"question","answer","summary"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Vb(1,"div",1),i.Kc(2,sb,2,1,"div",2),i.Vb(3,"div"),i.Qb(4,"app-content-blocks",3),i.Ub(),i.Ub(),i.Vb(5,"div",4),i.Kc(6,rb,2,3,"div",5),i.Kc(7,ab,2,3,"div",5),i.Kc(8,cb,2,3,"div",5),i.Ub(),i.Vb(9,"div",6),i.Qb(10,"app-content-blocks",3),i.Ub(),i.Ub()),2&e&&(i.Db(2),i.lc("ngIf",t.questionNumber),i.Db(2),i.lc("contentBlocks",t.question.questionPrompt),i.Db(1),i.lc("ngSwitch",t.question.type),i.Db(1),i.lc("ngSwitchCase",t.QuestionType.MultipleChoice),i.Db(1),i.lc("ngSwitchCase",t.QuestionType.SelectAnatomy),i.Db(1),i.lc("ngSwitchCase",t.QuestionType.LabelAnatomy),i.Db(2),i.lc("contentBlocks",t.question.explanation))},directives:[ms.l,au,ms.n,ms.o,Xh,eb,ob],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3838}.text-info[_ngcontent-%COMP%]{color:#0060c4}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.answer[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.answer__prompt[_ngcontent-%COMP%]{display:flex;padding-bottom:16px}.answer__explanation[_ngcontent-%COMP%]{padding-top:24px}"],changeDetection:0}),e})();const pb=["progressCircle"];let db=(()=>{class e{constructor(e,t){this.renderer=e,this.changeRef=t,this._size="medium",this._progress=0,this.strokeWidth=8,this.diameter=120}get size(){return this._size}set size(e){this._size=e,this.updateCircle()}get progress(){return this._progress}set progress(e){this._progress=e,this.updateCircle()}ngOnInit(){}ngAfterViewInit(){this.updateCircle()}updateCircle(){switch(this.size){case"small":this.strokeWidth=4,this.diameter=60;break;case"medium":this.strokeWidth=8,this.diameter=120;break;case"large":this.strokeWidth=16,this.diameter=240}if(this.progressCircleRef){const e=2*this.progressCircleRef.nativeElement.r.baseVal.value*Math.PI,t=e-this.progress/100*e;this.renderer.setStyle(this.progressCircleRef.nativeElement,"strokeDasharray",`${e} ${e}`),this.renderer.setStyle(this.progressCircleRef.nativeElement,"strokeDashoffset",""+t)}this.changeRef.markForCheck()}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(i.H),i.Pb(i.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-progress-circle"]],viewQuery:function(e,t){if(1&e&&i.Gc(pb,!0),2&e){let e;i.uc(e=i.dc())&&(t.progressCircleRef=e.first)}},inputs:{size:"size",progress:"progress"},decls:8,vars:19,consts:[["data-test","progress",1,"progress"],[1,"progress__ring-bg"],["stroke","#F9FAFD","fill","transparent",1,"progress__circle"],[1,"progress__ring"],["stroke","#5BB96F","fill","transparent",1,"progress__circle"],["progressCircle",""],["data-test","progressPercentage",1,"progress__label","text-semibold"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.fc(),i.Vb(1,"svg",1),i.Qb(2,"circle",2),i.Ub(),i.Vb(3,"svg",3),i.Qb(4,"circle",4,5),i.Ub(),i.ec(),i.Vb(6,"div",6),i.Mc(7),i.Ub(),i.Ub()),2&e&&(i.Hb("progress--small","small"===t.size)("progress--medium","medium"===t.size)("progress--large","large"===t.size),i.Db(1),i.Eb("width",t.diameter)("height",t.diameter),i.Db(1),i.Eb("stroke-width",t.strokeWidth)("r",t.diameter/2-2*t.strokeWidth)("cx",t.diameter/2)("cy",t.diameter/2),i.Db(1),i.Eb("width",t.diameter)("height",t.diameter),i.Db(1),i.Eb("stroke-width",t.strokeWidth)("r",t.diameter/2-2*t.strokeWidth)("cx",t.diameter/2)("cy",t.diameter/2),i.Db(3),i.Oc(" ",t.progress,"% "))},styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3838}.text-info[_ngcontent-%COMP%]{color:#0060c4}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.progress[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:center}.progress__ring[_ngcontent-%COMP%]{position:absolute;z-index:1}.progress__circle[_ngcontent-%COMP%]{transition:stroke-dashoffset .35s;transform:rotate(-90deg);transform-origin:50% 50%}.progress__label[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);z-index:2}.progress--small[_ngcontent-%COMP%]   .progress__label[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.progress--medium[_ngcontent-%COMP%]   .progress__label[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.progress--large[_ngcontent-%COMP%]   .progress__label[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}"],changeDetection:0}),e})();var ub=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},gb=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function hb(e,t){if(1&e&&(i.Vb(0,"div",13),i.Qb(1,"app-view-quiz-answer",14),i.Ub()),2&e){const e=t.$implicit,n=t.index,o=i.gc(3);i.Db(1),i.lc("question",e)("questionNumber",n+1)("answer",null==o.quizScore?null:o.quizScore.questionAnswers[e.id])("summary",!0)}}function bb(e,t){if(1&e&&(i.Vb(0,"div",11),i.Kc(1,hb,2,4,"div",12),i.Ub()),2&e){const e=i.gc(2);i.Db(1),i.lc("ngForOf",e.questions)}}function mb(e,t){if(1&e&&(i.Tb(0),i.Vb(1,"div",6),i.Qb(2,"app-progress-circle",7),i.Vb(3,"div",8),i.Mc(4," Quiz Complete "),i.Ub(),i.Vb(5,"div",9),i.Mc(6),i.Ub(),i.Ub(),i.Kc(7,bb,2,1,"div",10),i.Sb()),2&e){const e=i.gc();i.Db(2),i.lc("progress",null==e.quizScore?null:e.quizScore.score),i.Db(4),i.Pc(" You answered ",null==e.quizScore?null:e.quizScore.correctTotal," of ",null==e.quizScore?null:e.quizScore.scorableTotal," questions correctly. "),i.Db(1),i.lc("ngIf",e.showExplanationEnabled&&e.showExplanation)}}function fb(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",15),i.cc("click",(function(){return i.zc(e),i.gc().handleToggleSummaryClick()})),i.Mc(1),i.Ub()}if(2&e){const e=i.gc();i.Db(1),i.Oc(" ",e.showExplanation?"Hide Summary":"Show Summary"," ")}}function yb(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",16),i.cc("click",(function(){return i.zc(e),i.gc().handleRestartClick()})),i.Mc(1," Take Again "),i.Ub()}}function xb(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",17),i.cc("click",(function(){return i.zc(e),i.gc().handleExitClick()})),i.Mc(1," Back to View "),i.Ub()}}let vb=(()=>{class e{constructor(e,t,n){this.store=e,this.changeRef=t,this.quizService=n,this.questions=[],this.showSummaryEnabled=!1,this.showExplanationEnabled=!1,this.showExplanation=!1,this.ngUnsubscribe=new $.a}ngOnInit(){this.initReviewListeners()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initReviewListeners(){Object(rs.b)([this.questions$,this.submissions$]).pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(([e,t])=>{this.questions=e,this.quizScore=Ui(e,t),this.changeRef.markForCheck()}),this.quizSettings$.pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(({showSummary:e,showExplanation:t})=>{this.showSummaryEnabled=!1!==e,this.showExplanationEnabled=!1!==t,this.changeRef.markForCheck()})}handleToggleSummaryClick(){this.showExplanation=!this.showExplanation,this.changeRef.markForCheck()}handleRestartClick(){this.quizService.resetQuiz(),setTimeout(()=>{this.quizService.startQuiz()})}handleExitClick(){this.quizService.exitQuiz()}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.g),i.Pb(i.i),i.Pb(hg))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-quiz-review"]],decls:8,vars:8,consts:[["data-test","quizReview",1,"review"],[4,"ngIf"],[1,"review__actions"],["class","w-100","app-button","","buttonType","outline","buttonTheme","light","data-test","quizToggleSummaryButton",3,"click",4,"ngIf"],["class","mt-8 w-100","app-button","","buttonType","info","buttonTheme","light","data-test","quizTakeAgainButton",3,"click",4,"ngIf"],["class","mt-3 w-100","app-button","","buttonType","info","buttonTheme","light","data-test","quizExitButton",3,"click",4,"ngIf"],["data-test","quizSummary",1,"text-center"],["size","medium",3,"progress"],[1,"mt-8","text-18","text-semibold"],[1,"mv-4","text-14","text-medium"],["class","review__summary mb-4","data-test","quizExplanation",4,"ngIf"],["data-test","quizExplanation",1,"review__summary","mb-4"],["class","mv-6",4,"ngFor","ngForOf"],[1,"mv-6"],[3,"question","questionNumber","answer","summary"],["app-button","","buttonType","outline","buttonTheme","light","data-test","quizToggleSummaryButton",1,"w-100",3,"click"],["app-button","","buttonType","info","buttonTheme","light","data-test","quizTakeAgainButton",1,"mt-8","w-100",3,"click"],["app-button","","buttonType","info","buttonTheme","light","data-test","quizExitButton",1,"mt-3","w-100",3,"click"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Kc(1,mb,8,4,"ng-container",1),i.Vb(2,"div",2),i.Kc(3,fb,2,1,"button",3),i.Kc(4,yb,2,0,"button",4),i.hc(5,"async"),i.Kc(6,xb,2,0,"button",5),i.hc(7,"async"),i.Ub(),i.Ub()),2&e&&(i.Db(1),i.lc("ngIf",t.showSummaryEnabled),i.Db(2),i.lc("ngIf",t.showSummaryEnabled&&t.showExplanationEnabled),i.Db(1),i.lc("ngIf",!i.ic(5,4,t.quizLocked$)),i.Db(2),i.lc("ngIf",!i.ic(7,6,t.quizLocked$)))},directives:[ms.l,db,ms.k,lb,nc],pipes:[ms.b],styles:[".review__summary[_ngcontent-%COMP%]{background-color:#f9fafd;padding:4px 12px}"],changeDetection:0}),ub([Object(d.d)(Bi.getAllQuestions),gb("design:type",q.a)],e.prototype,"questions$",void 0),ub([Object(d.d)(Bi.getAllSubmissions),gb("design:type",q.a)],e.prototype,"submissions$",void 0),ub([Object(d.d)(Bi.getQuizSettings),gb("design:type",q.a)],e.prototype,"quizSettings$",void 0),ub([Object(d.d)(Bi.getQuizModeLocked),gb("design:type",q.a)],e.prototype,"quizLocked$",void 0),e})();var wb=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},Ob=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Cb(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",10),i.cc("click",(function(){return i.zc(e),i.gc(2).handleExitClick()})),i.Vb(1,"span",11),i.Mc(2,"Exit Quiz"),i.Ub(),i.Ub()}}function Sb(e,t){if(1&e&&(i.Qb(0,"app-view-quiz-progress",12),i.hc(1,"async"),i.hc(2,"async")),2&e){const e=i.gc(2);i.lc("index",i.ic(1,2,e.questionIndex$))("total",i.ic(2,4,e.questionTotal$))}}function kb(e,t){if(1&e&&(i.Vb(0,"div",5),i.Vb(1,"div",6),i.Vb(2,"h1",7),i.Mc(3,"Quiz"),i.Ub(),i.Kc(4,Cb,3,0,"button",8),i.hc(5,"async"),i.Ub(),i.Kc(6,Sb,3,6,"app-view-quiz-progress",9),i.hc(7,"async"),i.hc(8,"async"),i.Ub()),2&e){const e=i.gc();let t=null;i.Db(4),i.lc("ngIf",!i.ic(5,2,e.quizLocked$)),i.Db(2),i.lc("ngIf",(null==(t=i.ic(7,4,e.quizSettings$))?null:t.showProgress)&&i.ic(8,6,e.lifecycle$)!==e.Lifecycle.Review)}}function _b(e,t){if(1&e&&(i.Qb(0,"app-view-quiz-question",16),i.hc(1,"async")),2&e){const e=i.gc(2);i.lc("question",i.ic(1,1,e.question$))}}function jb(e,t){if(1&e&&(i.Vb(0,"div"),i.Mc(1),i.hc(2,"async"),i.Ub()),2&e){const e=i.gc(3);let t=null;i.Db(1),i.Oc(" ",(null==(t=i.ic(2,1,e.question$))?null:t.nextLabel)||e.defaultNextButtonNext," ")}}function Pb(e,t){1&e&&(i.Vb(0,"div"),i.Mc(1,"Submit"),i.Ub())}function Mb(e,t){if(1&e&&(i.Vb(0,"button",17),i.Vb(1,"div",18),i.hc(2,"async"),i.Kc(3,jb,3,3,"div",19),i.Kc(4,Pb,2,0,"div",20),i.Ub(),i.Ub()),2&e){const e=i.gc(2);let t=null;i.lc("disabled",!e.form.valid),i.Db(1),i.lc("ngSwitch",null==(t=i.ic(2,3,e.question$))?null:t.type),i.Db(2),i.lc("ngSwitchCase",e.quizQuestionType.Instructions)}}function Ib(e,t){if(1&e){const e=i.Wb();i.Vb(0,"form",13),i.cc("submit",(function(){return i.zc(e),i.gc().handleSubmit()})),i.Kc(1,_b,2,3,"app-view-quiz-question",14),i.hc(2,"async"),i.Kc(3,Mb,5,5,"button",15),i.hc(4,"async"),i.hc(5,"async"),i.Ub()}if(2&e){const e=i.gc();let t=null;i.lc("formGroup",e.form),i.Db(1),i.lc("ngIf",i.ic(2,3,e.question$)),i.Db(2),i.lc("ngIf",(null==(t=i.ic(4,5,e.quizSettings$))?null:t.showSubmit)&&i.ic(5,7,e.lifecycle$)===e.Lifecycle.Question)}}function zb(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",24),i.cc("click",(function(){return i.zc(e),i.gc(2).nextQuestion()})),i.Mc(1),i.hc(2,"async"),i.Ub()}if(2&e){const e=i.gc(2);let t=null;i.Db(1),i.Oc(" ",(null==(t=i.ic(2,1,e.question$))?null:t.nextLabel)||e.defaultNextButtonNext," ")}}function Tb(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",26),i.cc("click",(function(){return i.zc(e),i.gc(3).handleViewSummaryClick()})),i.Mc(1," See Results "),i.Ub()}}function Ub(e,t){if(1&e&&(i.Tb(0),i.Kc(1,Tb,2,0,"button",25),i.hc(2,"async"),i.Sb()),2&e){const e=i.gc(2);i.Db(1),i.lc("ngIf",i.ic(2,1,e.quizReviewEnabled$))}}function Lb(e,t){if(1&e&&(i.Tb(0),i.Vb(1,"div",21),i.Qb(2,"app-view-quiz-answer",22),i.hc(3,"async"),i.hc(4,"async"),i.Ub(),i.Tb(5,18),i.hc(6,"async"),i.Kc(7,zb,3,3,"button",23),i.Kc(8,Ub,3,3,"ng-container",20),i.Sb(),i.Sb()),2&e){const e=i.gc();i.Db(2),i.lc("question",i.ic(3,5,e.question$))("answer",i.ic(4,7,e.submission$).answer)("summary",!1),i.Db(3),i.lc("ngSwitch",i.ic(6,9,e.hasQuestionsRemaining$)),i.Db(2),i.lc("ngSwitchCase",!0)}}function Db(e,t){1&e&&(i.Tb(0),i.Qb(1,"app-view-quiz-review"),i.Sb())}function Eb(e,t){if(1&e&&(i.Vb(0,"div",27),i.Mc(1),i.hc(2,"async"),i.Ub()),2&e){const e=i.gc();let t=null;i.Db(1),i.Oc(" ",1===(null==(t=i.ic(2,1,e.questions$))?null:t.length)?"Answer":"Answers"," submitted ")}}let Fb=(()=>{class e{constructor(e,t,n,i,o,s,r){this.store=e,this.actions=t,this.formBuilder=n,this.viewService=i,this.engineService=o,this.quizService=s,this.pendoService=r,this.defaultNextButtonNext="Next Question",this.showHeader=!0,this.Lifecycle=Di,this.quizQuestionType=Mi,this.sceneConfigStash={},this.ngUnsubscribe=new $.a}ngOnInit(){if(!this.store.selectSnapshot(Bi.getActiveQuestionId)){const e=this.store.selectSnapshot(Bi).questions[0].id;this.store.dispatch(new ji.SetActiveQuestion(e))}this.store.dispatch(new ji.SetQuizLifecycle(Di.Question)),this.form=this.formBuilder.group({question:new gu.e("",this.getQuizValidation())}),this.initQuestionObserver(),this.initAnswerObserver(),this.initEngineInteractionObserver(),this.engineService.fireEvent(it.QuizEntered,!0)}ngOnDestroy(){Object.entries(this.sceneConfigStash).forEach(([e,t])=>{this.store.dispatch(new sn(e,t.background))}),this.engineService.fireEvent(it.QuizExited,!0),this.viewService.selectTool(Go.Select),this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}get answer(){const e=this.form.get("question").value;return Array.isArray(e)?e:[e]}initQuestionObserver(){this.question$.pipe(Object(W.a)(this.ngUnsubscribe),Object(K.a)(e=>void 0!==e)).subscribe(e=>{const t=this.store.selectSnapshot(Bo.getSelectedChapterId);e.chapterId!==t&&this.store.dispatch(new $t(e.chapterId)),this.form.reset(),this.setSceneConfig(e),this.store.dispatch(new ji.SetActiveSubmission(void 0)),e.type===Mi.Instructions&&this.form.get("question").setValue("-"),this.engineService.fireEvent(it.QuizQuestionLoaded,e)})}initAnswerObserver(){this.form.get("question").valueChanges.pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{const t=this.store.selectSnapshot(Bi.getActiveQuestion),n=this.store.selectSnapshot(Bi.getActiveSubmission);void 0!==t&&(this.store.selectSnapshot(Bi.getAllSubmissions).some(e=>e.questionId===t.id)||(n&&Object(X.isEqual)(n.answer,e)||this.store.dispatch(new ji.SetActiveSubmission({questionId:t.id,answer:e})),Object(X.isNil)(e)||this.engineService.fireEvent(it.QuizAnswerSelected,{questionId:t.id,answerId:e})))})}initEngineInteractionObserver(){this.viewService.selectTool(Go.Quiz),this.store.dispatch(new ji.SetQuizPickMode("single")),this.actions.pipe(Object(d.j)(be),Object(K.a)(e=>{const{node:t,event:n}=e;return!Object(X.isNil)(t)&&this.store.selectSnapshot(is.getActiveTool)===Go.Quiz&&!n.srcEvent.shiftKey})).pipe(Object(K.a)(()=>"none"!==this.store.selectSnapshot(Bi.getPickMode)),Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{"single"===this.store.selectSnapshot(Bi.getPickMode)&&this.viewService.clearSelectedNodes();const t=Object(X.get)(e,"hit.objectId");if(t){const e=this.store.selectSnapshot(ii.getCheckedNodeIds).includes(t);this.store.dispatch(new $n.UpdateNodesChecked(!e,[t]))}}),this.question$.pipe(Object(ls.a)((e,t)=>Object(X.get)(e,"id")===Object(X.get)(t,"id")),Object(K.a)(e=>!Object(X.isNil)(e))).pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{const{type:t,data:n}=e;this.viewService.clearSelectedNodes(),this.store.dispatch(new ji.SetQuizPickMode(t===Mi.SelectAnatomy&&n.correctAnswer.length>1?"multi":"single"))})}handleSubmit(){const e=this.store.selectSnapshot(Bi.getActiveQuestion);(this.form.valid||e.type===Mi.Instructions)&&this.quizService.submitQuestion(e.id,this.answer)}handleViewSummaryClick(){this.viewSummary()}handleExitClick(){this.quizService.exitQuiz()}nextQuestion(){this.quizService.nextQuestion()}viewSummary(){this.store.dispatch(new ji.SetQuizLifecycle(Di.Review)),this.engineService.fireEvent(it.QuizCompleted,!0)}setSceneConfig(e){const{camera:t,background:n}=(null==e?void 0:e.sceneConfig)||{},i=this.store.selectSnapshot(Bo.getChapter(e.chapterId));t&&(this.setStash(e.chapterId,{camera:i.camera.location}),setTimeout(()=>{this.store.dispatch(new bt(t.location,!0,1))})),n&&(this.setStash(e.chapterId,{background:i.background}),this.store.dispatch(new sn(e.chapterId,n)))}setStash(e,t){this.sceneConfigStash[e]=Object.assign(Object.assign({},this.sceneConfigStash[e]||{}),t)}getQuizValidation(){return e=>{const t=e.value,n=Array.isArray(t)?t:[t],i=function(e){switch(Object(X.get)(e,"type","")){case Mi.MultipleChoice:const t=Object(X.get)(e,"data.correctAnswer","");return t&&""!==t;case Mi.SelectAnatomy:case Mi.LabelAnatomy:return Object(X.get)(e,"data.correctAnswer",[]).length>0;default:return!0}}(this.store.selectSnapshot(Bi.getActiveQuestion)),o=n.some(e=>Object(X.isNil)(e)||""===e);return i&&o?{invalidValues:o}:null}}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.g),i.Pb(d.b),i.Pb(gu.d),i.Pb(Ip),i.Pb(lt),i.Pb(hg),i.Pb(ee))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-quiz"]],inputs:{showHeader:"showHeader"},decls:13,vars:19,consts:[["data-test","quiz",1,"view-quiz"],["class","pb-2 mb-4 view-quiz__header",4,"ngIf"],[3,"formGroup","submit",4,"ngIf"],[4,"ngIf"],["class","text-16 text-bold text-center",4,"ngIf"],[1,"pb-2","mb-4","view-quiz__header"],[1,"flex"],[1,"text-20","text-semibold","flex-grow"],["app-pin-button","","icon","times","size","small",3,"click",4,"ngIf"],["class","mt-3",3,"index","total",4,"ngIf"],["app-pin-button","","icon","times","size","small",3,"click"],[1,"visually-hidden"],[1,"mt-3",3,"index","total"],[3,"formGroup","submit"],["formControlName","question",3,"question",4,"ngIf"],["app-button","","class","w-100","buttonType","info","data-test","questionSubmit",3,"disabled",4,"ngIf"],["formControlName","question",3,"question"],["app-button","","buttonType","info","data-test","questionSubmit",1,"w-100",3,"disabled"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"mb-8"],[3,"question","answer","summary"],["app-button","","buttonType","info","class","w-100","data-test","questionNextButton",3,"click",4,"ngSwitchCase"],["app-button","","buttonType","info","data-test","questionNextButton",1,"w-100",3,"click"],["data-test","quizViewSummaryButton","app-button","","buttonType","info","class","w-100",3,"click",4,"ngIf"],["data-test","quizViewSummaryButton","app-button","","buttonType","info",1,"w-100",3,"click"],[1,"text-16","text-bold","text-center"]],template:function(e,t){if(1&e&&(i.Vb(0,"div",0),i.Kc(1,kb,9,8,"div",1),i.Kc(2,Ib,6,9,"form",2),i.hc(3,"async"),i.Kc(4,Lb,9,11,"ng-container",3),i.hc(5,"async"),i.Kc(6,Db,2,0,"ng-container",3),i.hc(7,"async"),i.hc(8,"async"),i.Kc(9,Eb,3,3,"div",4),i.hc(10,"async"),i.hc(11,"async"),i.hc(12,"async"),i.Ub()),2&e){let e=null;i.Db(1),i.lc("ngIf",t.showHeader),i.Db(1),i.lc("ngIf",i.ic(3,5,t.lifecycle$)===t.Lifecycle.Question),i.Db(2),i.lc("ngIf",i.ic(5,7,t.lifecycle$)===t.Lifecycle.Explanation),i.Db(2),i.lc("ngIf",i.ic(7,9,t.lifecycle$)===t.Lifecycle.Review&&i.ic(8,11,t.quizReviewEnabled$)),i.Db(3),i.lc("ngIf",!(i.ic(10,13,t.hasQuestionsRemaining$)||i.ic(11,15,t.quizReviewEnabled$)||null!=(e=i.ic(12,17,t.quizSettings$))&&e.showExplanation))}},directives:[ms.l,Ad,Ch,gu.t,gu.n,gu.h,$h,gu.m,gu.g,nc,ms.n,ms.o,ms.p,lb,vb],pipes:[ms.b],styles:[".view-quiz__header[_ngcontent-%COMP%]{border-bottom:1px solid #eaeff5}"],changeDetection:0}),wb([Object(d.d)(Bi.getQuizReviewEnabled),Ob("design:type",q.a)],e.prototype,"quizReviewEnabled$",void 0),wb([Object(d.d)(Bi.getActiveQuestion),Ob("design:type",q.a)],e.prototype,"question$",void 0),wb([Object(d.d)(Bi.getAllQuestions),Ob("design:type",q.a)],e.prototype,"questions$",void 0),wb([Object(d.d)(Bi.getActiveQuestionIndex),Ob("design:type",q.a)],e.prototype,"questionIndex$",void 0),wb([Object(d.d)(Bi.getQuestionTotal),Ob("design:type",q.a)],e.prototype,"questionTotal$",void 0),wb([Object(d.d)(Bi.getCorrectAnswerTotal),Ob("design:type",q.a)],e.prototype,"correctAnswerTotal$",void 0),wb([Object(d.d)(Bi.hasQuestionRemaining),Ob("design:type",q.a)],e.prototype,"hasQuestionsRemaining$",void 0),wb([Object(d.d)(Bi.getQuizSettings),Ob("design:type",q.a)],e.prototype,"quizSettings$",void 0),wb([Object(d.d)(Bi.getLifecycle),Ob("design:type",q.a)],e.prototype,"lifecycle$",void 0),wb([Object(d.d)(Bi.getQuizModeLocked),Ob("design:type",q.a)],e.prototype,"quizLocked$",void 0),wb([Object(d.d)(Bi.getActiveSubmission),Ob("design:type",q.a)],e.prototype,"submission$",void 0),e})();var Ab=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},Rb=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const Nb=["viewDrawer"],Vb=["viewDrawerOuter"];function Hb(e,t){1&e&&i.Qb(0,"app-icon",17)}function Bb(e,t){1&e&&i.Qb(0,"app-icon",18)}function Qb(e,t){if(1&e&&(i.Vb(0,"div",19),i.Qb(1,"app-content-blocks",20),i.hc(2,"async"),i.Ub()),2&e){const e=i.gc(2);let t=null;i.Db(1),i.lc("contentBlocks",null==(t=i.ic(2,2,e.selectedLabel$))?null:t.contentBlocks)("layout","compact")}}function $b(e,t){if(1&e){const e=i.Wb();i.Tb(0),i.Vb(1,"div",6),i.cc("click",(function(){return i.zc(e),i.gc().handleToggleClick()})),i.Vb(2,"div",7),i.cc("click",(function(){return i.zc(e),i.gc().handleLabelBack()})),i.Qb(3,"app-icon",8),i.Ub(),i.Vb(4,"div",9),i.Qb(5,"app-html",10),i.hc(6,"async"),i.Ub(),i.Vb(7,"div",11),i.Kc(8,Hb,1,0,"app-icon",12),i.Kc(9,Bb,1,0,"app-icon",13),i.Ub(),i.Ub(),i.Kc(10,Qb,3,4,"div",14),i.hc(11,"async"),i.Vb(12,"div",15),i.Qb(13,"app-html",16),i.hc(14,"async"),i.Ub(),i.Sb()}if(2&e){const e=i.gc();let t=null,n=null,o=null;i.Db(5),i.lc("markdownText",null==(t=i.ic(6,5,e.selectedLabel$))?null:t.title),i.Db(3),i.lc("ngIf",!e.open),i.Db(1),i.lc("ngIf",e.open),i.Db(1),i.lc("ngIf",null==(n=i.ic(11,7,e.selectedLabel$))?null:n.contentBlocks),i.Db(3),i.lc("markdownText",null==(o=i.ic(14,9,e.selectedLabel$))?null:o.description)}}function qb(e,t){1&e&&(i.Tb(0),i.Qb(1,"app-view-title",24),i.Sb()),2&e&&(i.Db(1),i.lc("menuEnabled",!1))}function Wb(e,t){if(1&e){const e=i.Wb();i.Vb(0,"div",29),i.cc("click",(function(){return i.zc(e),i.gc(3).handleExitQuiz()})),i.Qb(1,"app-icon",30),i.Ub()}}function Kb(e,t){if(1&e&&(i.Vb(0,"span",31),i.Vb(1,"span",32),i.Mc(2),i.hc(3,"async"),i.Ub(),i.Mc(4),i.hc(5,"async"),i.Ub()),2&e){const e=i.gc(3);i.Db(2),i.Oc("Question ",i.ic(3,2,e.activeQuestionIndex$)+1,""),i.Db(2),i.Oc(" of ",i.ic(5,4,e.questionTotal$)," ")}}function Gb(e,t){if(1&e&&(i.Tb(0),i.Kc(1,Wb,2,0,"div",25),i.hc(2,"async"),i.Vb(3,"div",9),i.Vb(4,"div",26),i.Vb(5,"span",27),i.Mc(6,"Quiz"),i.Ub(),i.Kc(7,Kb,6,6,"span",28),i.hc(8,"async"),i.hc(9,"async"),i.Ub(),i.Ub(),i.Sb()),2&e){const e=i.gc(2);let t=null;i.Db(1),i.lc("ngIf",!i.ic(2,2,e.quizLocked$)),i.Db(6),i.lc("ngIf",(null==(t=i.ic(8,4,e.quizSettings$))?null:t.showProgress)&&i.ic(9,6,e.questionRemaining$)>0)}}function Zb(e,t){1&e&&i.Qb(0,"app-icon",17)}function Jb(e,t){1&e&&i.Qb(0,"app-icon",18)}function Xb(e,t){if(1&e&&(i.Vb(0,"div",11),i.Kc(1,Zb,1,0,"app-icon",12),i.Kc(2,Jb,1,0,"app-icon",13),i.Ub()),2&e){const e=i.gc(2);i.Db(1),i.lc("ngIf",!e.open),i.Db(1),i.lc("ngIf",e.open)}}function Yb(e,t){1&e&&i.Qb(0,"app-view-content-mode",34)}function em(e,t){if(1&e&&(i.Tb(0),i.Kc(1,Yb,1,0,"app-view-content-mode",33),i.Sb()),2&e){const e=i.gc(2);i.Db(1),i.lc("ngIf",e.expandable)}}function tm(e,t){1&e&&i.Qb(0,"app-view-quiz",35),2&e&&i.lc("showHeader",!1)}function nm(e,t){if(1&e){const e=i.Wb();i.Tb(0),i.Vb(1,"div",6),i.cc("click",(function(){return i.zc(e),i.gc().handleToggleClick()})),i.Kc(2,qb,2,1,"ng-container",21),i.hc(3,"async"),i.Kc(4,Gb,10,8,"ng-container",21),i.hc(5,"async"),i.Kc(6,Xb,3,2,"div",22),i.Ub(),i.Vb(7,"div",15),i.Kc(8,em,2,1,"ng-container",21),i.hc(9,"async"),i.Kc(10,tm,1,1,"app-view-quiz",23),i.hc(11,"async"),i.Ub(),i.Sb()}if(2&e){const e=i.gc();i.Db(2),i.lc("ngIf",!i.ic(3,5,e.quizModeActive$)),i.Db(2),i.lc("ngIf",i.ic(5,7,e.quizModeActive$)),i.Db(2),i.lc("ngIf",e.expandable),i.Db(2),i.lc("ngIf",!i.ic(9,9,e.quizModeActive$)),i.Db(2),i.lc("ngIf",i.ic(11,11,e.quizModeActive$))}}const im=function(e,t,n,i){return{"view-drawer--closed":e,"view-drawer--active":t,"view-drawer--scrollable":n,"view-drawer--fixed":i}};let om=(()=>{class e{constructor(e,t,n,o,s,r){this.renderer=e,this.changeDetectorRef=t,this.viewService=n,this.quizService=o,this.store=s,this.layoutService=r,this.offsetYChange=new i.p,this.breakpoints={minimumDrawer:{velocity:1/0,point:0},halfDrawer:{velocity:1,point:0}},this.ngUnsubscribe=new $.a,this.viewMode=rl,this.viewToolsMode=gg,this.mode=rl.Content,this.open=!1}get expandable(){return"full"===this.layoutService.getVisibleContent()||this.mode===rl.LabelInfo||this.mode===rl.NodeInfo||this.open}ngOnInit(){this.initWindowSizeObserver(),this.initLayoutObserver(),this.initQuizObserver()}ngAfterViewInit(){this.refresh(this.store.selectSnapshot(il.getUI).drawer.isExpandedInitially)}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initWindowSizeObserver(){Object(wo.a)(Object(as.a)(window,"resize"),Object(as.a)(window,"orientationchange")).pipe(Object(Nr.a)(0),Object(W.a)(this.ngUnsubscribe)).subscribe(()=>{this.refresh(!1)})}initLayoutObserver(){this.layout$.pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.updateMode(e)})}initQuizObserver(){const e=this.selectedChapterReady$.pipe(Object(k.a)(e=>e&&e.model),Object(K.a)(e=>e),Object(cs.a)(300));Object(rs.b)([e,this.quizModeActive$]).pipe(Object(K.a)(([e,t])=>e&&t),Object(W.a)(this.ngUnsubscribe)).subscribe(()=>{setTimeout(()=>{this.toggleDrawer(!0),this.changeDetectorRef.markForCheck()})})}updateViewHeight(){const e=this.viewService.getVH(c.application!==o.Viewer);this.viewDrawer.nativeElement.style.setProperty("--vh",e+"px")}updateStops(){const e=window.innerHeight,t=this.store.selectSnapshot(wp.getSiteHeader)===fp.Hide?0:56;this.breakpoints.minimumDrawer.point=-64,this.breakpoints.halfDrawer.point=Math.floor(-.5*(e-t))}updateMode(e){this.mode=this.viewService.inferDrawerMode(e),this.changeDetectorRef.markForCheck()}resetDrawerPosition(e){setTimeout(()=>{this.slideDrawerToPoint(e?this.breakpoints.halfDrawer.point:this.breakpoints.minimumDrawer.point),this.open=e,this.changeDetectorRef.markForCheck()})}refresh(e){setTimeout(()=>{this.updateViewHeight(),this.updateStops(),this.resetDrawerPosition(e)})}handleToggleClick(){this.expandable&&this.toggleDrawer()}handleDrawerKeydown(e){"ArrowDown"!==e.key&&"ArrowUp"!==e.key||e.stopPropagation()}handleLabelBack(){this.viewService.clearSelectedLabel()}toggleDrawer(e){null==e&&(e=!this.open),this.slideDrawerToPoint((e?this.breakpoints.halfDrawer:this.breakpoints.minimumDrawer).point),this.open=e,this.open?this.viewDrawerOuter.nativeElement.focus():this.viewDrawerOuter.nativeElement.blur()}handleExitQuiz(){this.quizService.exitQuiz()}slideDrawerToPoint(e){this.renderer.setStyle(this.viewDrawer.nativeElement,"transform",`translate3d(0, ${e}px, 0)`),this.offsetYChange.emit(e)}getDrawerY(){if(this.viewDrawer){const e=this.viewService.getComputedTransform(this.viewDrawer.nativeElement);return e?e.y:null}return null}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(i.H),i.Pb(i.i),i.Pb(Ip),i.Pb(hg),i.Pb(d.g),i.Pb(Ml))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-drawer"]],viewQuery:function(e,t){if(1&e&&(i.Rc(Nb,!0),i.Rc(Vb,!0)),2&e){let e;i.uc(e=i.dc())&&(t.viewDrawer=e.first),i.uc(e=i.dc())&&(t.viewDrawerOuter=e.first)}},inputs:{expandable:"expandable"},outputs:{offsetYChange:"offsetYChange"},decls:7,vars:10,consts:[[1,"view-drawer",3,"ngClass"],["viewDrawer",""],["role","region","aria-label","Chapter Description",1,"view-drawer__outer",3,"keydown"],["viewDrawerOuter",""],[1,"view-drawer__inner",3,"ngSwitch"],[4,"ngSwitchCase"],[1,"view-drawer__header",2,"height","64px",3,"click"],[1,"view-drawer__button","view-drawer__button--left",3,"click"],["icon","arrow-left"],[1,"view-drawer__title"],[1,"text-semibold","text-14",3,"markdownText"],[1,"view-drawer__button","view-drawer__button--right"],["icon","caret-up",4,"ngIf"],["icon","caret-down",4,"ngIf"],["class","mv-1","appEventFence","",4,"ngIf"],[1,"view-drawer__content"],[1,"text-14",3,"markdownText"],["icon","caret-up"],["icon","caret-down"],["appEventFence","",1,"mv-1"],[3,"contentBlocks","layout"],[4,"ngIf"],["class","view-drawer__button view-drawer__button--right",4,"ngIf"],[3,"showHeader",4,"ngIf"],["alignTitle","center","size","medium",1,"view-drawer__title",3,"menuEnabled"],["class","view-drawer__button view-drawer__button--left","role","button","appEventFence","",3,"click",4,"ngIf"],[1,"flex","flex-column","text-center"],[1,"text-11","text-semibold","text-uppercase"],["class","text-14",4,"ngIf"],["role","button","appEventFence","",1,"view-drawer__button","view-drawer__button--left",3,"click"],["icon","times"],[1,"text-14"],[1,"text-semibold"],["layout","drawer",4,"ngIf"],["layout","drawer"],[3,"showHeader"]],template:function(e,t){1&e&&(i.Vb(0,"div",0,1),i.Vb(2,"div",2,3),i.cc("keydown",(function(e){return t.handleDrawerKeydown(e)})),i.Vb(4,"div",4),i.Kc(5,$b,15,11,"ng-container",5),i.Kc(6,nm,12,13,"ng-container",5),i.Ub(),i.Ub(),i.Ub()),2&e&&(i.lc("ngClass",i.rc(5,im,!t.open,t.open,t.open,!t.expandable)),i.Db(2),i.Eb("tabindex",t.open?0:-1),i.Db(2),i.lc("ngSwitch",t.mode),i.Db(1),i.lc("ngSwitchCase",t.viewMode.LabelInfo),i.Db(1),i.lc("ngSwitchCase",t.viewMode.Content))},directives:[ms.i,ms.n,ms.o,$a,Id,ms.l,Qa,au,Wg,wh,Fb],pipes:[ms.b],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3838}.text-info{color:#0060c4}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.view-drawer{border-top:rgba(234,239,245,.8);box-shadow:0 -1px 0 0 rgba(28,42,63,.16);background:hsla(0,0%,100%,.8);color:#131c2a;border-top:var(--view-drawer-border);box-shadow:var(--view-drawer-shadow);color:var(--view-drawer-color);left:0;min-height:100vh;right:0;position:absolute;z-index:20;top:100vh;top:calc(var(--vh, 1vh) * 100);transform:translate3d(0,-56px,0);transition:transform .3s}.view-drawer--animate{transition:background-color 1s ease-in-out}.view-drawer--active{background-color:#fff;background-color:var(--view-drawer-background--active)}.view-drawer--closed{background-color:#fff;background-color:var(--view-drawer-background--closed)}.view-drawer--scrollable{min-height:0}.view-drawer--scrollable .view-drawer__outer{height:50vh;height:calc(var(--vh, 1vh) * 50);overflow-y:scroll}.view-drawer--fixed{height:56px;overflow:hidden}.view-drawer--fixed .view-drawer__inner{height:56px;padding:0 16px}.view-drawer--fixed .view-drawer__content{justify-content:center;padding-top:0}.view-drawer__header{position:relative}.view-drawer__header,.view-drawer__title{height:64px;display:flex;justify-content:center;align-items:center}.view-drawer__title{flex-grow:1;margin:0 64px;padding:0 8px}.view-drawer__button{border:1px solid rgba(0,0,0,.1);border-radius:50%;height:40px;width:40px;display:flex;align-items:center;justify-content:center;position:absolute;transition:background-color border-color 125ms 125ms}.view-drawer__button:hover{cursor:pointer;border-color:transparent;background:rgba(215,224,234,.6)}.view-drawer__button--left{border-right:1px solid rgba(0,0,0,.1);left:16px}.view-drawer__button--right{border-left:1px solid rgba(0,0,0,.1);right:16px}.view-drawer__inner{position:relative}.view-drawer__outer{outline:none}.view-drawer__content{display:flex;flex:1 1 100%;flex-direction:column;max-width:600px;min-height:56px;margin:0 auto;padding:8px 16px 48px}"],encapsulation:2,changeDetection:0}),Ab([Object(d.d)(il.getUI),Rb("design:type",q.a)],e.prototype,"layout$",void 0),Ab([Object(d.d)(Bo.getSelectedChapterReadyState),Rb("design:type",q.a)],e.prototype,"selectedChapterReady$",void 0),Ab([Object(d.d)(Bo.getSelectedChapterIndex),Rb("design:type",q.a)],e.prototype,"chapterIndex$",void 0),Ab([Object(d.d)(Bo.getChapterCount),Rb("design:type",q.a)],e.prototype,"chapterCount$",void 0),Ab([Object(d.d)(Tr.getSelectedLabel),Rb("design:type",q.a)],e.prototype,"selectedLabel$",void 0),Ab([Object(d.d)(Bi.getQuizModeActive),Rb("design:type",q.a)],e.prototype,"quizModeActive$",void 0),Ab([Object(d.d)(Bi.getActiveQuestionIndex),Rb("design:type",q.a)],e.prototype,"activeQuestionIndex$",void 0),Ab([Object(d.d)(Bi.getQuestionTotal),Rb("design:type",q.a)],e.prototype,"questionTotal$",void 0),Ab([Object(d.d)(Bi.getQuestionsRemaining),Rb("design:type",q.a)],e.prototype,"questionRemaining$",void 0),Ab([Object(d.d)(Bi.getQuizSettings),Rb("design:type",q.a)],e.prototype,"quizSettings$",void 0),Ab([Object(d.d)(Bi.getQuizModeLocked),Rb("design:type",q.a)],e.prototype,"quizLocked$",void 0),e})();class sm{constructor(e="",t=""){this.body=e,this.action=t}}const rm=["viewColumn"],am=[[["","view-column-header",""]],"*"],cm=function(e,t,n){return{"view-column--unpadded":e,"view-column--left":t,"view-column--right":n}},lm=["[view-column-header]","*"];let pm=(()=>{class e{constructor(){this.unpadded=!1,this.placement="left"}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-column"]],viewQuery:function(e,t){if(1&e&&i.Rc(rm,!0),2&e){let e;i.uc(e=i.dc())&&(t.viewColumn=e.first)}},inputs:{unpadded:"unpadded",placement:"placement"},ngContentSelectors:lm,decls:7,vars:5,consts:[[1,"view-column",3,"ngClass"],["viewColumn",""],[1,"view-column__inner"],[1,"view-column__header"],[1,"view-column__body"]],template:function(e,t){1&e&&(i.kc(am),i.Vb(0,"div",0,1),i.Vb(2,"div",2),i.Vb(3,"div",3),i.jc(4),i.Ub(),i.Vb(5,"div",4),i.jc(6,1),i.Ub(),i.Ub(),i.Ub()),2&e&&i.lc("ngClass",i.qc(1,cm,t.unpadded,"left"===t.placement,"right"===t.placement))},directives:[ms.i],styles:[".view-column[_ngcontent-%COMP%]{pointer-events:auto;background:#fff;box-shadow:1px -1px 2px 0 rgba(28,42,63,.1),0 1px 2px 0 rgba(28,42,63,.3);color:#131c2a;background:var(--view-column-background);box-shadow:var(--view-column-toggle-shadow);color:var(--view-column-color);width:320px;height:100%;position:absolute;z-index:30}.view-column--left[_ngcontent-%COMP%]{left:0}.view-column--right[_ngcontent-%COMP%]{right:0;box-shadow:0 -1px 24px rgba(0,0,0,.4)}.view-column--unpadded[_ngcontent-%COMP%]   .view-column__body[_ngcontent-%COMP%]{padding:0}.view-column__inner[_ngcontent-%COMP%]{background:#fff;border-right:1px solid #eaeff5;background:var(--view-column-background);border-right:var(--view-column-border);display:flex;flex-direction:column;height:100%;width:320px;position:absolute;left:0;z-index:10}.view-column__header[_ngcontent-%COMP%]{flex-shrink:1;background:var(--view-column-background)}.view-column__header[_ngcontent-%COMP%]:empty{display:none}.view-column__body[_ngcontent-%COMP%]{overflow-y:auto;flex-grow:1;height:100%;padding:16px 12px}"],changeDetection:0}),e})();const dm=["*"];let um=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-list-container"],["","app-view-list-container",""]],ngContentSelectors:dm,decls:2,vars:0,consts:[[1,"view-list-container"]],template:function(e,t){1&e&&(i.kc(),i.Vb(0,"div",0),i.jc(1),i.Ub())},styles:[".view-list-container{display:flex;flex-direction:column}"],encapsulation:2,changeDetection:0}),e})();var gm=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},hm=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const bm=function(e,t,n,i){return{"view-logo--full-color":e,"view-logo--full-white":t,"view-logo--small-color":n,"view-logo--small-white":i}};function mm(e,t){if(1&e&&(i.Tb(0),i.Qb(1,"a",1),i.Sb()),2&e){const e=i.gc();i.Db(1),i.lc("ngClass",i.rc(1,bm,"color"===e.logoColor&&"full"===e.logoSize,"white"===e.logoColor&&"full"===e.logoSize,"color"===e.logoColor&&"small"===e.logoSize,"white"===e.logoColor&&"small"===e.logoSize))}}function fm(e,t){if(1&e&&(i.Tb(0),i.Qb(1,"span",2),i.Sb()),2&e){const e=i.gc();i.Db(1),i.lc("ngClass",i.rc(1,bm,"color"===e.logoColor&&"full"===e.logoSize,"white"===e.logoColor&&"full"===e.logoSize,"color"===e.logoColor&&"small"===e.logoSize,"white"===e.logoColor&&"small"===e.logoSize))}}let ym=(()=>{class e{constructor(){this.logoSize="full",this.logoColor="color",this.isLight=!0,this.breakpoint=fl,this.ngUnsubscribe=new $.a}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-logo"]],inputs:{logoSize:"logoSize",logoColor:"logoColor"},decls:4,vars:6,consts:[[4,"ngIf"],["href","https://www.biodigital.com","target","_blank","tabindex","-1","title","Powered by Biodigital",1,"view-logo",3,"ngClass"],[1,"view-logo",3,"ngClass"]],template:function(e,t){if(1&e&&(i.Kc(0,mm,2,6,"ng-container",0),i.hc(1,"async"),i.Kc(2,fm,2,6,"ng-container",0),i.hc(3,"async")),2&e){let e=null,n=null;i.lc("ngIf",null==(e=i.ic(1,2,t.layout$))?null:e.logo.isHyperLink),i.Db(2),i.lc("ngIf",!(null!=(n=i.ic(3,4,t.layout$))&&n.logo.isHyperLink))}},directives:[ms.l,ms.i],pipes:[ms.b],styles:["[_nghost-%COMP%]{display:flex;height:52px;align-items:center}.view-logo--small-color[_ngcontent-%COMP%]{width:28px;height:44px;background:url(logo-color.svg) 50% no-repeat}.view-logo--full-color[_ngcontent-%COMP%]{width:120px;height:32px;background:url(powered-by-biodigital-color.svg) 50% no-repeat}.view-logo--small-white[_ngcontent-%COMP%]{width:28px;height:44px;background:url(logo-white.svg) 50% no-repeat}.view-logo--full-white[_ngcontent-%COMP%]{width:120px;height:32px;background:url(powered-by-biodigital-white.svg) 50% no-repeat}.view-logo[_ngcontent-%COMP%]:not([hidden]){display:flex}.view-logo[href][_ngcontent-%COMP%]:hover{cursor:pointer}"],changeDetection:0}),gm([Object(d.d)(il.getUI),hm("design:type",q.a)],e.prototype,"layout$",void 0),gm([Object(d.d)(Bo.getSelectedChapterBackground),hm("design:type",q.a)],e.prototype,"background$",void 0),gm([Object(d.d)(Ol.getBreakpoint),hm("design:type",q.a)],e.prototype,"breakpoint$",void 0),e})();const xm=function(e){return{"view-list-item--selected":e}},vm=["*"];let wm=(()=>{class e{constructor(){this.selected=!1}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-list-item"],["","app-view-list-item",""]],inputs:{selected:"selected"},ngContentSelectors:vm,decls:2,vars:3,consts:[[1,"view-list-item",3,"ngClass"]],template:function(e,t){1&e&&(i.kc(),i.Vb(0,"div",0),i.jc(1),i.Ub()),2&e&&i.lc("ngClass",i.oc(1,xm,t.selected))},directives:[ms.i],styles:['.text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3838}.text-info{color:#0060c4}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.button{font-size:12px;letter-spacing:.3px;line-height:1.4em;align-items:center;background:none;border-color:transparent;border-radius:4px;border-width:0;color:inherit;display:flex;font-family:Inter UI,sans-serif;justify-content:center;margin:0;outline:0 none;padding:0 16px;position:relative;text-align:center;text-decoration:none;transition:background-color .12s;width:100%}.button:not([disabled]):hover{cursor:pointer}.button:focus .button--themed{background:#f1f4fa;outline:none}.button:after{content:" ";background-color:#283853;border-radius:4px;display:block;position:absolute;left:0;top:0;bottom:0;right:0;opacity:0;z-index:1;transition:opacity .06s}.button:not(.button--disabled):hover:after{opacity:.7}.button__container{position:relative;z-index:2;width:100%}.button--uppercase{text-transform:uppercase}.button--expanded{display:flex;flex:1}.button--xsmall{height:24px;min-width:24px;padding:0 8px;font-size:10px;letter-spacing:.25px;line-height:1.4em}.button--small{height:32px;min-width:32px;padding:0 12px}.button--medium,.button--small{font-size:12px;letter-spacing:.3px;line-height:1.4em}.button--medium{height:36px;min-width:36px;padding:0 16px}.button--large{height:48px;min-width:48px;padding:0 16px;font-size:14px;letter-spacing:.35px;line-height:1.4em}.button--no-border,.button--no-border:after{border-radius:0!important}.button--left{text-align:left}.button--themed{color:#374a68;color:var(--button-color)}.button--themed:hover{color:#1c2a3f;color:var(--button-color--hover)}.button--themed:after{background-color:#d7e0ea;background-color:var(--button-bg--hover)}.button--dark{color:#d7e0ea}.button--dark:hover{color:#fff}.button--dark:after{background-color:#283853}.button--dark.button--flat{background:#374a68}.button--dark.button--default{background:transparent}.button--dark.button--outline{background:transparent;border:1px solid #374a68;transition:border-color .12s}.button--dark.button--outline:hover{border-color:#96a8c0}.button--dark.button--outline:hover:after{background-color:transparent;display:none}.button--dark.button--text{background:transparent;color:#d7e0ea}.button--dark.button--text:hover{color:#fff}.button--dark.button--text:hover:after{display:none}.button--dark.button--selected{background-color:#1c5ab9;color:#fff}.button--dark.button--selected:hover:after{display:none}.button--light{color:#283853}.button--light:hover{color:#1c2a3f}.button--light:after{background-color:#96a8c0}.button--light:not(.button--disabled):hover:after{opacity:.6}.button--light.button--flat{background:#d7e0ea;font-weight:500}.button--light.button--flat.button--selected{background-color:#96a8c0}.button--light.button--default{background:transparent;color:#131c2a}.button--light.button--default:not(.button--disabled):hover:after{opacity:.2}.button--light.button--outline{background:transparent;border:1px solid #96a8c0;color:#283853;transition:border-color .12s}.button--light.button--outline:after{display:none}.button--light.button--outline:hover{background:rgba(55,74,104,.05);border-color:#374a68;color:#1c2a3f}.button--light.button--outline:hover:after{background-color:transparent}.button--light.button--selected{background-color:#eaeff5}.button--light.button--selected:hover:after{display:none}.button--light.button--text{color:#283853}.button--light.button--text:hover{color:#1c2a3f}.button--light.button--text:hover:after{display:none}.button--primary{background:#de3838;color:#fff}.button--primary:after{background:#f9fafd}.button--primary:hover:after{opacity:.1}.button--info{background:#3892dc;color:#fff}.button--info:after{background:#f9fafd}.button--info:hover:after{opacity:.1}.button--selected{background-color:#1c5ab9}.button--disabled{opacity:.5}.button--circle{border-radius:50%}.button--circle.button--xsmall{width:24px}.button--circle.button--small{width:32px;padding:0 6px}.button--circle.button--medium{width:36px;padding:0 8px}.button--circle.button--large{width:48px}.button--circle:after{border-radius:50%}.button--rounded,.button--rounded:after{border-radius:18px}[app-view-list-item]{border-color:transparent;background:none;border-width:0;padding:0;outline:none;margin:0;pointer-events:all;display:flex;width:100%}[app-view-list-item]::-moz-focus-inner{border:0}[app-view-list-item]:not([disabled]):hover{cursor:pointer}.view-list-item{font-size:14px;letter-spacing:.35px;line-height:1.4em;display:flex;flex-grow:1;flex-direction:row;padding:12px;border-radius:2px;border-left:4px solid transparent;background-color:transparent;color:#131c2a;border-left:var(--view-chapters-border);background-color:var(--view-chapters-bg);color:var(--view-chapters-color);transition:background-color 125ms,color 125ms,border 125ms}.view-list-item:hover{cursor:pointer;background:var(--view-chapters-bg--hover)}.view-list-item:focus{background:#f1f4fa;outline:none}.view-list-item--selected{border-left:4px solid #2d72dc;background-color:#f1f5fc;background:var(--view-chapters-bg--selected);border-left:var(--view-chapters-border--selected)}.view-list-item__index{display:flex;flex:0 0 32px;justify-content:center}.view-list-item__title{word-wrap:break-word;overflow-wrap:break-word;display:flex;flex:1 1 auto;padding-right:4px}.view-list-item__thumb{background-color:#f9fafd;background-color:var(--view-chapters-thumb-bg);background-size:cover;border-radius:4px;background-repeat:no-repeat;flex:0 0 56px;height:56px;width:56px;transition:border-color .1s}'],encapsulation:2,changeDetection:0}),e})();var Om=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},Cm=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Sm(e,t){if(1&e){const e=i.Wb();i.Vb(0,"div",2),i.cc("click",(function(){return i.zc(e),i.gc().handleCloseClick()})),i.Ub()}}function km(e,t){1&e&&(i.Vb(0,"span",15),i.Mc(1,"(On)"),i.Ub())}function _m(e,t){1&e&&(i.Vb(0,"span",15),i.Mc(1,"(Off)"),i.Ub())}function jm(e,t){if(1&e){const e=i.Wb();i.Vb(0,"app-view-column",3),i.Vb(1,"nav",4),i.Vb(2,"app-view-panel",5),i.Qb(3,"app-view-logo"),i.Ub(),i.Vb(4,"app-view-panel",5),i.Vb(5,"button",6),i.cc("click",(function(){return i.zc(e),i.gc().handleCloseClick()})),i.Mc(6," Close "),i.Ub(),i.Ub(),i.Vb(7,"app-view-panel",5),i.Vb(8,"button",6),i.cc("click",(function(){return i.zc(e),i.gc().handleToggleToolbar("tools")})),i.Qb(9,"app-icon",7),i.Mc(10," Open Explore Tools "),i.Ub(),i.Vb(11,"button",6),i.cc("click",(function(){return i.zc(e),i.gc().handleToggleToolbar("media")})),i.Qb(12,"app-icon",8),i.Mc(13," Open Media Controls "),i.Ub(),i.Vb(14,"button",6),i.cc("click",(function(){return i.zc(e),i.gc().handleSearchClick()})),i.Qb(15,"app-icon",9),i.Mc(16," Search Anatomy "),i.Ub(),i.Ub(),i.Vb(17,"app-view-panel",5),i.Vb(18,"button",6),i.cc("click",(function(){return i.zc(e),i.gc().handleFullscreenClick()})),i.Qb(19,"app-icon",10),i.Mc(20," Enter Fullscreen "),i.Ub(),i.Ub(),i.Vb(21,"app-view-panel",5),i.Vb(22,"button",6),i.cc("click",(function(){return i.zc(e),i.gc().handleToggleLabelsClick()})),i.Qb(23,"app-icon",11),i.Vb(24,"span",12),i.Mc(25,"Toggle Labels"),i.Ub(),i.Kc(26,km,2,0,"span",13),i.hc(27,"async"),i.Kc(28,_m,2,0,"span",13),i.hc(29,"async"),i.Ub(),i.Ub(),i.Vb(30,"app-view-panel",5),i.Vb(31,"button",14),i.cc("click",(function(){return i.zc(e),i.gc().handleTutorialClick()})),i.hc(32,"async"),i.Mc(33," Launch Tutorial "),i.Ub(),i.Vb(34,"button",6),i.cc("click",(function(){return i.zc(e),i.gc().handleHelpBasicsClick()})),i.Mc(35,"3D Navigation Basics"),i.Ub(),i.Vb(36,"button",6),i.cc("click",(function(){return i.zc(e),i.gc().handleHelpShortcutsClick()})),i.Mc(37,"Keyboard Shortcuts"),i.Ub(),i.Ub(),i.Ub(),i.Ub()}if(2&e){const e=i.gc();let t=null;i.lc("@slideInOut",void 0),i.Db(2),i.lc("showHeader",!1),i.Db(2),i.lc("showHeader",!1),i.Db(3),i.lc("showHeader",!1),i.Db(10),i.lc("showHeader",!1),i.Db(4),i.lc("showHeader",!1),i.Db(5),i.lc("ngIf",i.ic(27,10,e.showLabels$)),i.Db(2),i.lc("ngIf",!i.ic(29,12,e.showLabels$)),i.Db(2),i.lc("showHeader",!1),i.Db(1),i.lc("disabled",!(null!=(t=i.ic(32,14,e.selectedChapterReady$))&&t.model))}}let Pm=(()=>{class e{constructor(e,t){this.store=e,this.viewService=t}ngOnInit(){}handleCloseClick(){this.store.dispatch(new Q.ToggleMenu(!1))}handleToggleLabelsClick(){this.viewService.toggleLabels()}handleFullscreenClick(){this.handleCloseClick(),la.toggleFullscreen()}handleNewTabClick(){this.handleCloseClick(),this.viewService.openInNewTab()}handleSearchClick(){this.handleCloseClick(),this.viewService.toggleSearch()}handleTutorialClick(){this.handleCloseClick(),this.viewService.toggleTutorial(!0)}handleHelpBasicsClick(){this.handleCloseClick(),this.viewService.toggleHelp(!0,G.Basics)}handleHelpShortcutsClick(){this.handleCloseClick(),this.viewService.toggleHelp(!0,G.Shortcuts)}handleToggleToolbar(e){this.handleCloseClick();const t=this.store.selectSnapshot(il.getUI);t.media.status=oa.Hide,t.tools.status=oa.Hide,t.toolbar.status=oa.Hide,t[e].status=oa.Show,this.store.dispatch(new Q.SetUI(t))}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.g),i.Pb(Ip))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-menu-column"]],decls:4,vars:6,consts:[["class","view-menu-scrim",3,"click",4,"ngIf"],["placement","right","class","view-menu-column",4,"ngIf"],[1,"view-menu-scrim",3,"click"],["placement","right",1,"view-menu-column"],["app-view-list-container",""],["padding","dense",3,"showHeader"],["app-view-list-item","",3,"click"],["icon","pen",1,"mr-3"],["icon","play",1,"mr-3"],["icon","search",1,"mr-3"],["icon","expand",1,"mr-3"],["icon","tag",1,"mr-3"],[1,"mr-3"],["class","text-dim",4,"ngIf"],["app-view-list-item","",3,"disabled","click"],[1,"text-dim"]],template:function(e,t){1&e&&(i.Kc(0,Sm,1,0,"div",0),i.hc(1,"async"),i.Kc(2,jm,38,16,"app-view-column",1),i.hc(3,"async")),2&e&&(i.lc("ngIf",i.ic(1,2,t.menuOpen$)),i.Db(2),i.lc("ngIf",i.ic(3,4,t.menuOpen$)))},directives:[ms.l,pm,um,Xg,ym,wm,$a],pipes:[ms.b],styles:[".view-menu-column[_ngcontent-%COMP%]{position:absolute;top:0;right:0;z-index:10000;height:100%}.view-menu-scrim[_ngcontent-%COMP%]{background:rgba(0,0,0,.2);display:flex;position:fixed;justify-content:center;align-items:center;top:0;bottom:0;left:0;right:0;transition:background-color .25s,opacity .25s;z-index:10000}.view-menu-scrim[_ngcontent-%COMP%]:hover{opacity:1;cursor:pointer;background:var(--view-loader-scrim-bg--hover)}"],data:{animation:[Object(ol.n)("slideInOut",[Object(ol.m)(":enter",[Object(ol.l)({transform:"translateX(320px)"}),Object(ol.e)("200ms ease-out",Object(ol.l)({transform:"*"}))]),Object(ol.m)(":leave",[Object(ol.e)("200ms",Object(ol.l)({transform:"translateX(320px)"}))])])]},changeDetection:0}),Om([Object(d.d)(Bo.getSelectedChapterReadyState),Cm("design:type",q.a)],e.prototype,"selectedChapterReady$",void 0),Om([Object(d.d)(il.getMenuOpen),Cm("design:type",q.a)],e.prototype,"menuOpen$",void 0),Om([Object(d.d)(il.getCanTouch),Cm("design:type",q.a)],e.prototype,"canTouch$",void 0),Om([Object(d.d)(is.getShowLabels),Cm("design:type",q.a)],e.prototype,"showLabels$",void 0),e})();var Mm=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},Im=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function zm(e,t){if(1&e){const e=i.Wb();i.Vb(0,"div",1),i.cc("click",(function(){return i.zc(e),i.gc().handleToggle()}))("keyup.enter",(function(){return i.zc(e),i.gc().handleToggle()})),i.Qb(1,"app-icon",2),i.Ub()}if(2&e){const e=i.gc();i.lc("@show",void 0)("gaLabel",e.isIn?"Show":"Hide"),i.Db(1),i.lc("icon",e.isIn?"caret-right":"caret-left")}}let Tm=(()=>{class e{constructor(e,t,n,i){this.viewService=e,this.layoutService=t,this.changeDetectorRef=n,this.store=i,this.ngUnsubscribe=new $.a,this.isIn=!1,this.columnToggleVisible=!1}ngOnInit(){Object(rs.b)(this.chapter$,this.layout$).pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(([e,t])=>{this.isIn=t.column.status===oa.Collapse,this.columnToggleVisible=this.layoutService.isVisible(Cl.ColumnToggle),this.changeDetectorRef.markForCheck()})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}isVisible(){return this.layoutService.isVisible(Cl.ColumnToggle)}handleToggle(){this.viewService.toggleColumn(),this.viewService.toggleSearch(!1),this.viewService.toggleNodeInfo(!1),this.viewService.toggleLabelInfo(!1),this.changeDetectorRef.markForCheck()}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(Ip),i.Pb(Ml),i.Pb(i.i),i.Pb(d.g))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-column-toggle"]],decls:1,vars:1,consts:[["class","view-column-toggle","gaEvent","","gaCategory","View Information Panel","gaAction","Clicked Toggle Column","role","button","aria-label","Toggle Column","tabindex","0","matTooltip","Toggle Column","matTooltipPosition","right",3,"gaLabel","click","keyup.enter",4,"ngIf"],["gaEvent","","gaCategory","View Information Panel","gaAction","Clicked Toggle Column","role","button","aria-label","Toggle Column","tabindex","0","matTooltip","Toggle Column","matTooltipPosition","right",1,"view-column-toggle",3,"gaLabel","click","keyup.enter"],[3,"icon"]],template:function(e,t){1&e&&i.Kc(0,zm,2,3,"div",0),2&e&&i.lc("ngIf",t.columnToggleVisible)},directives:[ms.l,J.b,J.a,Rd.c,$a],styles:[".view-column-toggle{background:#fff;color:#131c2a;box-shadow:1px -1px 2px 0 rgba(28,42,63,.1),0 1px 2px 0 rgba(28,42,63,.3);background:var(--view-column-toggle-background);box-shadow:var(--view-column-toggle-shadow);color:var(--view-column-toggle-color);border-radius:0 4px 4px 0;display:flex;justify-content:center;align-items:center;width:24px;height:48px}.view-column-toggle:hover{background-color:#131c2a;background-color:var(--view-column-toggle-background--hover);cursor:pointer}"],encapsulation:2,data:{animation:[Object(ol.n)("show",[Object(ol.m)(":enter",[Object(ol.l)({opacity:0,transform:"translateX(-32px)"}),Object(ol.e)("300ms ease-in-out",Object(ol.l)({opacity:1,transform:"*"}))]),Object(ol.m)(":leave",[Object(ol.e)("300ms ease-in-out",Object(ol.l)({transform:"translateX(-32px)",opacity:0}))])])]},changeDetection:0}),Mm([Object(d.d)(il.getUI),Im("design:type",q.a)],e.prototype,"layout$",void 0),Mm([Object(d.d)(Bo.getSelectedChapter),Im("design:type",q.a)],e.prototype,"chapter$",void 0),e})();var Um,Lm;function Dm(e,t){if(1&e&&(i.Vb(0,"div",6),i.Vb(1,"div",7),i.Qb(2,"app-icon",8),i.Ub(),i.Ub()),2&e){const e=i.gc(2);i.Db(2),i.lc("icon",e.icon)}}function Em(e,t){if(1&e){const e=i.Wb();i.Vb(0,"div",1),i.Kc(1,Dm,3,1,"div",2),i.Vb(2,"div",3),i.jc(3),i.Ub(),i.Vb(4,"button",4),i.cc("click",(function(){return i.zc(e),i.gc().handleDismissClicked()})),i.Qb(5,"app-icon",5),i.Ub(),i.Ub()}if(2&e){const e=i.gc();i.Hb("toggle--message","message"===e.type)("toggle--error","error"===e.type)("toggle--notification","notification"===e.type)("toggle--warning","warning"===e.type)("toggle--rounded","rounded"===e.toggleStyle)("toggle--light","light"===e.theme)("toggle--dark","dark"===e.theme),i.lc("@show",void 0),i.Db(1),i.lc("ngIf",e.icon)}}(Lm=Um||(Um={})).slideTransition=Object(ol.g)([Object(ol.l)({transform:"translateY({{ from }}%)",opacity:0}),Object(ol.e)("{{ duration }}ms ease-out",Object(ol.l)({transform:"translateY({{ to }})",opacity:1}))]),Lm.fadeIn=Object(ol.g)([Object(ol.l)({opacity:0}),Object(ol.e)("{{ duration }}ms ease-out",Object(ol.l)({opacity:1}))]),Lm.fadeOut=Object(ol.g)([Object(ol.l)({opacity:"*"}),Object(ol.e)("{{ duration }}ms ease-in",Object(ol.l)({opacity:0}))]);const Fm=["*"];let Am=(()=>{class e{constructor(e){this.changeRef=e,this.type="message",this.theme="light",this.showDelay=0,this.hideDelay=5e3,this.dismiss=!1,this.toggleStyle="rounded",this.handleDismiss=new $.a,this._shown=!0,this.shownSubject=new $.a,this.ngUnsubscribe=new $.a}get shown(){return this._shown}set shown(e){this._shown!==e&&(this._shown=e,this.shownSubject.next(e),this.changeRef.markForCheck())}ngOnInit(){this.initViewShownListeners()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}handleDismissClicked(){this.handleDismiss.next()}initViewShownListeners(){this.shownSubject.pipe(Object(cs.a)(this.hideDelay),Object(K.a)(e=>e),Object(W.a)(this.ngUnsubscribe)).subscribe(()=>{this._shown=!1,this.changeRef.markForCheck()})}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(i.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-message-toggle"]],inputs:{type:"type",theme:"theme",icon:"icon",showDelay:"showDelay",hideDelay:"hideDelay",dismiss:"dismiss",toggleStyle:"toggleStyle",shown:"shown"},outputs:{handleDismiss:"handleDismiss"},ngContentSelectors:Fm,decls:1,vars:1,consts:[["class","toggle flex flex-row items-start",3,"toggle--message","toggle--error","toggle--notification","toggle--warning","toggle--rounded","toggle--light","toggle--dark",4,"ngIf"],[1,"toggle","flex","flex-row","items-start"],["class","mr-3",4,"ngIf"],[1,"toggle__content"],[1,"toggle__icon","toggle__dismiss",3,"click"],["icon","times"],[1,"mr-3"],[1,"toggle__icon"],[3,"icon"]],template:function(e,t){1&e&&(i.kc(),i.Kc(0,Em,6,16,"div",0)),2&e&&i.lc("ngIf",t.shown)},directives:[ms.l,$a],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3838}.text-info{color:#0060c4}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}:root{--message-toggle-color:#cadcf7;--message-toggle-background-color:#1c5ab9;--message-toggle-icon-color:#a6c6f8}.toggle{padding:16px;box-sizing:border-box;font-size:13px;letter-spacing:.325px;line-height:1.4em;color:var(--message-toggle-color);background-color:var(--message-toggle-background-color)}.toggle--rounded{border-radius:4px}.toggle__icon{display:flex;flex-direction:column;align-items:center;justify-content:center;color:#fff;font-size:16px;letter-spacing:.4px;line-height:1.4em;background:none;border:none;color:var(--message-toggle-icon-color)}.toggle__content{padding:0 2px;word-break:break-word;flex:1 1 auto}.toggle__dismiss{color:var(--message-toggle-color)}.toggle.toggle--message{--message-toggle-color:#33703c;--message-toggle-background-color:#eaf8ec;--message-toggle-icon-color:#47a75e}.toggle.toggle--notification{--message-toggle-color:#1b355f;--message-toggle-background-color:#d8eefd;--message-toggle-icon-color:blue-60}.toggle.toggle--warning{--message-toggle-color:#8b4e0c;--message-toggle-background-color:#fbf2e4;--message-toggle-icon-color:#eaac1a}.toggle.toggle--error{--message-toggle-color:#7e2525;--message-toggle-background-color:#f6dada;--message-toggle-icon-color:#cb4039}.toggle--dark.toggle--message{--message-toggle-color:#fff;--message-toggle-background-color:#47a75e;--message-toggle-icon-color:#fff}.toggle--dark.toggle--notification{--message-toggle-color:#fff;--message-toggle-background-color:#1c5ab9;--message-toggle-icon-color:#fff}.toggle--dark.toggle--warning{--message-toggle-color:#76430a;--message-toggle-background-color:#f7e7a1;--message-toggle-icon-color:#76430a}.toggle--dark.toggle--error{--message-toggle-color:#fff;--message-toggle-background-color:#cb4039;--message-toggle-icon-color:#fff}"],encapsulation:2,data:{animation:[Object(ol.n)("show",[Object(ol.m)(":enter",[Object(ol.o)(Um.fadeIn,{params:{duration:300}})]),Object(ol.m)(":leave",[Object(ol.o)(Um.fadeOut,{params:{duration:300}})])])]},changeDetection:0}),e})();function Rm(e,t){if(1&e){const e=i.Wb();i.Vb(0,"div",1),i.Vb(1,"app-message-toggle",2),i.cc("handleDismiss",(function(){return i.zc(e),i.gc().handleDismiss()})),i.Vb(2,"div"),i.Mc(3," This model appears to be performing slowly on your device. For an optimal experience, please switch to a different device or try another model. "),i.Ub(),i.Ub(),i.Ub()}2&e&&(i.Db(1),i.lc("dismiss",!0))}const Nm=[];let Vm,Hm,Bm=(()=>{class e{constructor(e,t){this.storageService=e,this.changeRef=t,this.shown=!1,this.sampling=!1}ngOnInit(){this.storageService.getLocalItem(Dr.Iphone12Warning)||this.testDevices()}ngOnDestroy(){this.sampling=!1}testDevices(){const e=window.matchMedia("only screen and (device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3)"),t=window.matchMedia("only screen and (device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3)"),n=window.matchMedia("only screen and (device-width: 820px) and (device-height: 1180px) and (-webkit-device-pixel-ratio: 2)"),i=e.matches||t.matches||n.matches,o=/iPhone|iPad/.test(navigator.userAgent),s=/OS\s14/.test(navigator.userAgent);i&&o&&s&&this.startFrameSampling()}startFrameSampling(){this.sampling=!0,Vm=0,Hm=Date.now();const e=()=>{this.frame()?(this.shown=!0,this.changeRef.markForCheck()):this.sampling&&requestAnimationFrame(e)};requestAnimationFrame(e)}frame(){Vm++;const e=Date.now();if(e>=Hm+500){const t=Math.floor(500*Vm/(e-Hm)*2);if(Nm.push(t),Nm.length>3&&Nm.shift(),3===Nm.length&&(Nm[0]+Nm[1]+Nm[2])/3<10)return!0;Hm=e,Vm=0}}handleDismiss(){this.shown=!1,this.changeRef.markForCheck(),this.storageService.setLocalItem(Dr.Iphone12Warning,!0)}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(Ar),i.Pb(i.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-iphone12-warning"]],decls:1,vars:1,consts:[["class","warning",4,"ngIf"],[1,"warning"],["type","warning","toggleStyle","flat","icon","info-circle",3,"dismiss","handleDismiss"]],template:function(e,t){1&e&&i.Kc(0,Rm,4,1,"div",0),2&e&&i.lc("ngIf",t.shown)},directives:[ms.l,Am],styles:[".warning[_ngcontent-%COMP%]{position:fixed;top:0;left:0;right:0;z-index:1002}.warning__text[_ngcontent-%COMP%]{text-align:center;flex:1}"],changeDetection:0}),e})(),Qm=(()=>{class e{constructor(){}onClick(e,t){t.select()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=i.Kb({type:e,selectors:[["","appSelectOnFocus",""]],hostBindings:function(e,t){1&e&&i.cc("click",(function(e){return t.onClick(e,e.target)}))}}),e})();var $m=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},qm=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const Wm=["searchInput"],Km=function(e){return{"view-search__action--selected":e}};let Gm=(()=>{class e{constructor(e,t,n){this.viewService=e,this.engineService=t,this.store=n,this.ngUnsubscribe=new $.a,this.query="",this.treeTheme=ga,this.treeSearchDisplayMode=Lc}ngOnInit(){this.initViewGraphSubscription()}initViewGraphSubscription(){this.store.select(Bo.getSelectedChapterId).pipe(Object(K.a)(e=>null!=e),Object(ls.a)(),Object(W.a)(this.ngUnsubscribe)).subscribe(()=>{this.store.dispatch(new pe(this.engineService.createViewGraph({},!1)))})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}handleSearchKeyup(e,t){"Escape"===e.key&&(this.handleExitClick(),this.searchInput.nativeElement.blur()),this.query=t}handleExitClick(){this.query="",this.viewService.toggleSearch(!1)}toggleDisplayMode(){let e=this.store.selectSnapshot(il.getSearchDisplayMode);e=e===Lc.List?Lc.Tree:Lc.List,this.setDisplayMode(e)}setDisplayMode(e){this.store.dispatch(new Q.SetSearchDisplayMode(e))}handleTreeButtonClick(){this.setDisplayMode(Lc.Tree)}handleListButtonClick(){this.setDisplayMode(Lc.List)}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(Ip),i.Pb(lt),i.Pb(d.g))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-search"]],viewQuery:function(e,t){if(1&e&&i.Rc(Wm,!0),2&e){let e;i.uc(e=i.dc())&&(t.searchInput=e.first)}},decls:23,vars:23,consts:[["gaCategory","View Search",1,"view-search"],[1,"view-search__header"],[1,"view-search__actions-row"],[1,"view-search__actions"],["gaEvent","","gaAction","Clicked Anatomy Tree","type","button","aria-label","Switch to Anatomy Tree",1,"view-search__action",3,"ngClass","matTooltip","click"],["aria-hidden","true",1,"view-search__action-icon",3,"icon"],["gaEvent","","gaAction","Clicked Anatomy List","type","button","aria-label","Switch to Anatomy List",1,"view-search__action",3,"ngClass","matTooltip","click"],["gaEvent","","gaAction","Clicked Exit","type","button","matTooltip","Close Search","aria-label","Close Search",1,"view-search__exit",3,"click"],["icon","times"],[1,"view-search__input-row"],[1,"view-search__input-container"],["icon","search",1,"view-search__input-icon"],["appAutoFocus","","appSelectOnFocus","","role","search","type","text","aria-label","Search Anatomy","placeholder","Search Anatomy",1,"view-search__input",3,"value","keyup"],["searchInput",""],[1,"view-search__body"],[3,"displayMode","theme","query","viewGraph"]],template:function(e,t){if(1&e){const e=i.Wb();i.Vb(0,"div",0),i.Vb(1,"div",1),i.Vb(2,"div",2),i.Vb(3,"div",3),i.Vb(4,"button",4),i.cc("click",(function(){return t.handleTreeButtonClick()})),i.hc(5,"async"),i.Qb(6,"app-icon",5),i.Mc(7,"Tree "),i.Ub(),i.Vb(8,"button",6),i.cc("click",(function(){return t.handleListButtonClick()})),i.hc(9,"async"),i.Qb(10,"app-icon",5),i.Mc(11,"List "),i.Ub(),i.Ub(),i.Vb(12,"button",7),i.cc("click",(function(){return t.handleExitClick()})),i.Qb(13,"app-icon",8),i.Ub(),i.Ub(),i.Vb(14,"div",9),i.Vb(15,"div",10),i.Qb(16,"app-icon",11),i.Vb(17,"input",12,13),i.cc("keyup",(function(n){i.zc(e);const o=i.vc(18);return t.handleSearchKeyup(n,o.value)})),i.Ub(),i.Ub(),i.Ub(),i.Ub(),i.Vb(19,"div",14),i.Qb(20,"app-tree-search",15),i.hc(21,"async"),i.hc(22,"async"),i.Ub(),i.Ub()}2&e&&(i.Db(4),i.lc("ngClass",i.oc(19,Km,i.ic(5,11,t.searchDisplayMode$)===t.treeSearchDisplayMode.Tree))("matTooltip","Switch to Anatomy Tree"),i.Db(2),i.lc("icon","sitemap"),i.Db(2),i.lc("ngClass",i.oc(21,Km,i.ic(9,13,t.searchDisplayMode$)===t.treeSearchDisplayMode.List))("matTooltip","Switch to Anatomy List"),i.Db(2),i.lc("icon","list"),i.Db(7),i.lc("value",t.query),i.Db(3),i.lc("displayMode",i.ic(21,15,t.searchDisplayMode$))("theme",t.treeTheme.Themed)("query",t.query)("viewGraph",i.ic(22,17,t.viewGraph$)))},directives:[J.a,J.b,ms.i,Rd.c,$a,xc,Qm,Dc],pipes:[ms.b],styles:[".view-search{display:flex;flex-direction:column;height:100%}@-webkit-keyframes appear{0%{background-color:transparent}}@keyframes appear{0%{background-color:transparent}}.view-search__header{flex:0 0 auto;flex-direction:column;display:flex;-webkit-animation:appear .25s ease-out;animation:appear .25s ease-out}.view-search__actions-row{flex:0 0 auto;display:flex;padding:0 12px;justify-content:space-between;align-items:center;border-bottom:1px solid var(--view-search-border-color)}.view-search__actions{display:flex;height:56px;flex:1;justify-content:space-between}.view-search__action{text-transform:uppercase;background:transparent;display:flex;align-items:center;justify-content:center;border:0;border-bottom:4px solid transparent;color:#374a68;color:var(--view-search-tab-color);cursor:pointer;width:49%;outline:none;padding-top:4px}.view-search__action:hover:not(.view-search__action--selected){color:#131c2a;border-bottom-color:#d7e0ea;color:var(--view-search-tab-hover-color);border-bottom-color:var(--view-search-tab-hover-border)}.view-search__action--selected{color:#131c2a;border-bottom-color:#2d72dc;color:var(--view-search-tab-active-color);border-bottom-color:var(--view-search-tab-active-border)}.view-search__action-icon{margin-right:8px}.view-search__exit{display:flex;align-items:center;justify-content:center;border:0;border-radius:50%;color:#374a68;background-color:#d7e0ea;color:var(--view-search-exit-color);background-color:var(--view-search-exit-bg);opacity:.8;cursor:pointer;width:28px;height:28px;margin-left:12px;outline:none}.view-search__input-row{flex:0 0 auto;display:flex;padding:12px}.view-search__input-container{background-color:#fff;background-color:var(--view-search-input-bg);border:1px solid var(--view-search-border-color);display:flex;flex-grow:1;border-radius:4px}.view-search__input-icon{background:0 0;display:flex;align-items:center;justify-content:center;color:#96a8c0;color:var(--view-search-inactive-color);width:36px;height:36px;outline:0}.view-search__input{color:#131c2a;color:var(--view-search-active-color);background:transparent;border:1px solid transparent;outline:none;flex:1 0 auto;padding:8px 12px 8px 0;font-size:13px}.view-search__input::-ms-clear{display:none}.view-search__input::-moz-placeholder{color:#96a8c0;color:var(--view-search-inactive-color)}.view-search__input:-ms-input-placeholder{color:#96a8c0;color:var(--view-search-inactive-color)}.view-search__input::placeholder{color:#96a8c0;color:var(--view-search-inactive-color)}.view-search__body{flex:1 1 100%;overflow-y:scroll;padding-left:12px}.view-search__input{font-family:Inter UI,Font Awesome\\ 5 Pro!important}@media not all and (min-resolution:0.001dpcm){@supports (-webkit-appearance:none){.view-search__input{font-size:16px;padding:4px 8px;width:0}}}"],encapsulation:2,changeDetection:0}),$m([Object(d.d)(is.getViewGraph),qm("design:type",q.a)],e.prototype,"viewGraph$",void 0),$m([Object(d.d)(il.getSearchDisplayMode),qm("design:type",q.a)],e.prototype,"searchDisplayMode$",void 0),e})();var Zm=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Jm(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",6),i.cc("click",(function(){return i.zc(e),i.gc().handleCloseClick()})),i.Ub()}}function Xm(e,t){if(1&e&&i.Qb(0,"div",7),2&e){const e=i.gc();i.Hb("text-italic",!(null!=e.node&&e.node.description)),i.lc("innerHTML",e.formatHTML((null==e.node?null:e.node.description)||"No description available"),i.Ac)}}function Ym(e,t){1&e&&(i.Vb(0,"div",8),i.Mc(1," Source: "),i.Vb(2,"span",9),i.Mc(3,"Wikipedia"),i.Ub(),i.Ub())}const ef=function(e,t){return{"view-node-description--layout-column":e,"view-node-description--layout-drawer":t}};let tf=(()=>{class e{constructor(e,t,n){this.store=e,this.actions=t,this.changeRef=n,this.layout=Sl.Drawer,this.showClose=!0,this.isOpen=!1,this.ngUnsubscribe=new $.a}ngOnInit(){this.initInfoListeners(),this.store.select(ii.getSelectedNode).pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{void 0!==e&&(this.node=this.store.selectSnapshot(is.getViewGraphNode)(e.objectId))})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}handleHideClick(e){this.store.dispatch(new $n.UpdateNodesShown(!1,[e.id]))}handleCloseClick(){const e=this.store.selectSnapshot(il.getUI);e.nodeInfo.status=oa.Hide,this.store.dispatch(new Q.SetUI(e))}initInfoListeners(){this.actions.pipe(Object(d.i)(Ke,Ge,qe),Object(W.a)(this.ngUnsubscribe)).subscribe(()=>{this.isOpen=!0,this.changeRef.markForCheck()})}formatHTML(e){return e.trim().replace(new RegExp("\r?\n","g"),"<br><br>")}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.g),i.Pb(d.b),i.Pb(i.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-node-description"]],inputs:{layout:"layout",showClose:"showClose"},decls:8,vars:10,consts:[[1,"view-node-description",3,"ngClass"],[1,"view-node-description__header"],["app-pin-button","","size","small","icon","arrow-left","class","mr-1 mt-1",3,"click",4,"ngIf"],[1,"view-node-description__title"],["class","view-node-description__body",3,"text-italic","innerHTML",4,"ngIf"],["class","view-node-description__attribution",4,"ngIf"],["app-pin-button","","size","small","icon","arrow-left",1,"mr-1","mt-1",3,"click"],[1,"view-node-description__body",3,"innerHTML"],[1,"view-node-description__attribution"],[1,"text-italic"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Vb(1,"div",1),i.Kc(2,Jm,1,0,"button",2),i.Vb(3,"div",3),i.Mc(4),i.Ub(),i.Ub(),i.Kc(5,Xm,1,3,"div",4),i.hc(6,"async"),i.Kc(7,Ym,4,0,"div",5),i.Ub()),2&e&&(i.lc("ngClass",i.pc(7,ef,"column"===t.layout,"drawer"===t.layout)),i.Db(2),i.lc("ngIf",t.showClose),i.Db(2),i.Nc(null==t.node?null:t.node.label),i.Db(1),i.lc("ngIf",!i.ic(6,5,t.querying$)),i.Db(2),i.lc("ngIf",null==t.node?null:t.node.description))},directives:[ms.i,ms.l,Ad],pipes:[ms.b],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3838}.text-info{color:#0060c4}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.view-node-description{display:flex;flex-direction:column}.view-node-description--layout-drawer .view-node-description__body{margin-top:8px}.view-node-description--layout-column .view-node-description__body{margin-top:4px}.view-node-description__header{display:flex}.view-node-description__title{font-size:18px;letter-spacing:.45px;line-height:1.4em;flex:1 1 auto;font-weight:600;align-self:center}.view-node-description--layout-drawer .view-node-description__title,.view-node-description__body{font-size:14px;letter-spacing:.35px;line-height:1.4em}.view-node-description__attribution,.view-node-description__body{color:var(--view-description-secondary-color)}.view-node-description__attribution{margin-top:16px;font-size:12px;letter-spacing:.3px;line-height:1.4em}.view-node-description__actions{cursor:pointer;outline:none;border:none;background:transparent;padding:4px 8px}"],encapsulation:2,changeDetection:0}),function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);s>3&&r&&Object.defineProperty(t,n,r)}([Object(d.d)(is.getQuerying),Zm("design:type",q.a)],e.prototype,"querying$",void 0),e})();var nf=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},of=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function sf(e,t){1&e&&(i.Tb(0),i.Qb(1,"app-view-title"),i.Qb(2,"app-view-content-mode",6),i.Sb())}function rf(e,t){1&e&&i.Qb(0,"app-view-quiz")}function af(e,t){if(1&e&&(i.Vb(0,"app-view-column",3),i.Tb(1,4),i.Kc(2,sf,3,0,"ng-container",5),i.hc(3,"async"),i.Kc(4,rf,1,0,"app-view-quiz",5),i.hc(5,"async"),i.Sb(),i.Ub()),2&e){const e=i.gc();i.lc("@slideInOut",void 0),i.Db(2),i.lc("ngIf",!i.ic(3,3,e.quizModeActive$)),i.Db(2),i.lc("ngIf",i.ic(5,5,e.quizModeActive$))}}function cf(e,t){1&e&&(i.Vb(0,"app-view-column",7),i.Qb(1,"app-view-search"),i.Ub()),2&e&&i.lc("unpadded",!0)("@slideInOut",void 0)}function lf(e,t){1&e&&(i.Vb(0,"app-view-column",3),i.Qb(1,"app-view-node-description",6),i.Ub()),2&e&&i.lc("@slideInOut",void 0)}const pf=function(){return{"view-column-container--header-offset":!0}};let df=(()=>{class e{constructor(e,t,n){this.viewService=e,this.layoutService=t,this.changeDetectorRef=n,this.ngUnsubscribe=new $.a,this.viewLayout=Cl,this.application=o,this.columnVisible=!1,this.searchVisible=!1,this.nodeInfoVisible=!1}ngOnInit(){this.initLayoutObserver()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initLayoutObserver(){Object(rs.b)(this.layout$,this.chapter$).pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(([])=>{this.columnVisible=this.layoutService.isVisible(Cl.Column),this.searchVisible=this.layoutService.isVisible(Cl.Search),this.nodeInfoVisible=this.layoutService.isVisible(Cl.NodeInfo),this.changeDetectorRef.markForCheck()})}handleSearchClick(){this.viewService.toggleSearch(!0)}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(Ip),i.Pb(Ml),i.Pb(i.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-column-container"]],decls:4,vars:5,consts:[[1,"view-column-container",3,"ngClass"],["class","view-column-container__inner",4,"ngIf"],["class","view-column-container__inner",3,"unpadded",4,"ngIf"],[1,"view-column-container__inner"],["view-column-body",""],[4,"ngIf"],["layout","column"],[1,"view-column-container__inner",3,"unpadded"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Kc(1,af,6,7,"app-view-column",1),i.Kc(2,cf,2,2,"app-view-column",2),i.Kc(3,lf,2,1,"app-view-column",1),i.Ub()),2&e&&(i.lc("ngClass",i.nc(4,pf)),i.Db(1),i.lc("ngIf",t.columnVisible),i.Db(1),i.lc("ngIf",t.searchVisible),i.Db(1),i.lc("ngIf",t.nodeInfoVisible))},directives:[ms.i,ms.l,pm,Wg,wh,Fb,Gm,tf],pipes:[ms.b],styles:[".view-column-container{pointer-events:none;height:100%;width:320px;position:absolute;left:0;top:0;z-index:30}.view-column-container app-view-column{position:absolute;left:0;top:0;height:100%;z-index:40}"],encapsulation:2,data:{animation:[Object(ol.n)("slideInOut",[Object(ol.m)(":enter",[Object(ol.l)({transform:"translateX(-320px)"}),Object(ol.e)("300ms ease-in-out",Object(ol.l)({transform:"*"}))]),Object(ol.m)(":leave",[Object(ol.e)("300ms ease-in-out",Object(ol.l)({transform:"translateX(-320px)"}))])])]},changeDetection:0}),nf([Object(d.d)(Bo.getSelectedChapter),of("design:type",q.a)],e.prototype,"chapter$",void 0),nf([Object(d.d)(il.getUI),of("design:type",q.a)],e.prototype,"layout$",void 0),nf([Object(d.d)(Bi.getQuizModeActive),of("design:type",q.a)],e.prototype,"quizModeActive$",void 0),e})();function uf(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",7),i.cc("click",(function(){return i.zc(e),i.gc(2).handleActionClick()})),i.Mc(1),i.Ub()}if(2&e){const e=i.gc(2);i.Db(1),i.Oc(" ",e.notification.action," ")}}function gf(e,t){if(1&e){const e=i.Wb();i.Vb(0,"div",1),i.Vb(1,"div",2),i.Vb(2,"div",3),i.Mc(3),i.Ub(),i.Vb(4,"button",4),i.cc("click",(function(){return i.zc(e),i.gc().handleCloseClick()})),i.Qb(5,"app-icon",5),i.Ub(),i.Ub(),i.Kc(6,uf,2,1,"button",6),i.Ub()}if(2&e){const e=i.gc();i.lc("@show",void 0),i.Db(3),i.Oc(" ",e.notification.body," "),i.Db(3),i.lc("ngIf",e.notification.action)}}let hf=(()=>{class e{constructor(){this.closeClick=new i.p}ngOnInit(){}handleActionClick(){this.close(this.notification.action)}handleCloseClick(){this.close()}close(e=""){this.notification=null,this.closeClick.emit({action:e,data:this.notification})}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-notification"]],inputs:{notification:"notification"},outputs:{closeClick:"closeClick"},decls:1,vars:1,consts:[["class","notification",4,"ngIf"],[1,"notification"],[1,"flex"],[1,"notification__body","flex-grow"],["type","button",1,"notification__button","notification__button--close",3,"click"],["icon","times"],["class","notification__button notification__button--full","type","button",3,"click",4,"ngIf"],["type","button",1,"notification__button","notification__button--full",3,"click"]],template:function(e,t){1&e&&i.Kc(0,gf,7,3,"div",0),2&e&&i.lc("ngIf",t.notification)},directives:[ms.l,$a],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3838}.text-info{color:#0060c4}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.notification{font-size:12px;letter-spacing:.3px;line-height:1.4em;background:#2d72dc;width:320px;border-radius:4px;box-shadow:0 2px 4px rgba(0,0,0,.08),0 4px 6px rgba(0,0,0,.12)}.notification__body{color:#fff;padding:16px}.notification__button{align-items:center;justify-content:center;background:#2d72dc;border:0;color:#fff;display:flex;font-weight:600;height:36px;font-size:12px;letter-spacing:.3px;line-height:1.4em}.notification__button:hover{background-color:#4381e0;cursor:pointer}.notification__button--close{border-radius:0 4px 0 4px;flex:0 0 36px;height:36px}.notification__button--full{border-radius:0 0 4px 4px;border-top:1px solid hsla(0,0%,100%,.2);justify-content:left;padding:0 16px;text-overflow:ellipsis;white-space:nowrap;width:100%}"],encapsulation:2,data:{animation:[Object(ol.n)("show",[Object(ol.m)(":enter",[Object(ol.o)(Um.fadeIn,{params:{duration:300}})])])]},changeDetection:0}),e})();var bf=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},mf=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const ff={stacksForChapter:{}};let yf=(()=>{let e=class{constructor(e){this.store=e}static canUndo(e,t){return e.stacksForChapter[t.selectedChapter].undoStack.length>0}static canRedo(e,t){return e.stacksForChapter[t.selectedChapter].redoStack.length>0}static getUndoCount(e,t){return e.stacksForChapter[t.selectedChapter].undoStack.length||0}reset(e,t){e.patchState(immer.produce(e.getState(),e=>{e.stacksForChapter={}}))}undoAll(e,t){const n=e.getState();if(void 0===n.stacksForChapter[t.chapterId])return;const i=[...n.stacksForChapter[t.chapterId].undoStack].reverse(),o=i.flat().reduce((e,t)=>(void 0===e[t.patchAction]&&(e[t.patchAction]={action:t.patchAction,patches:[]}),e[t.patchAction].patches=[...e[t.patchAction].patches,...t.inverse],e),{});Object.keys(o).forEach(t=>{e.dispatch(new o[t].action(o[t].patches))});const s=immer.produce(n,e=>{e.stacksForChapter[t.chapterId].undoStack=[],e.stacksForChapter[t.chapterId].redoStack=i});e.patchState(s)}preserveState(e,t){const n=this.store.selectSnapshot(Bo.getSelectedChapterId),i=immer.produce(e.getState(),e=>{0!==t.patches.length&&(t.patches.some(e=>0===e.forward.length)&&t.patches.some(e=>0===e.inverse.length)||(void 0===e.stacksForChapter[n]&&(e.stacksForChapter[n]={redoStack:[],undoStack:[]}),e.stacksForChapter[n].redoStack=[],e.stacksForChapter[n].undoStack.push(t.patches)))});e.patchState(i)}redo(e,t){const n=e.getState(),i=Object(X.get)(n.stacksForChapter[t.chapterId],"redoStack",[]);if(0===i.length)return;const o=i[i.length-1],s=immer.produce(n,e=>{e.stacksForChapter[t.chapterId].redoStack.pop(),e.stacksForChapter[t.chapterId].undoStack.push(o)});e.patchState(s),o.forEach(t=>{e.dispatch(new t.patchAction(t.forward))})}undo(e,t){const n=e.getState(),i=Object(X.get)(n.stacksForChapter[t.chapterId],"undoStack",[]);if(0===i.length)return;const o=i[i.length-1],s=immer.produce(n,e=>{e.stacksForChapter[t.chapterId].undoStack.pop(),e.stacksForChapter[t.chapterId].redoStack.push(o)});e.patchState(s),o.forEach(t=>{e.dispatch(new t.patchAction(t.inverse))})}};return e.\u0275fac=function(t){return new(t||e)(i.Zb(d.g))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac}),bf([Object(d.a)(qn.Reset),mf("design:type",Function),mf("design:paramtypes",[Object,qn.Reset]),mf("design:returntype",void 0)],e.prototype,"reset",null),bf([Object(d.a)(qn.UndoAll),mf("design:type",Function),mf("design:paramtypes",[Object,qn.UndoAll]),mf("design:returntype",void 0)],e.prototype,"undoAll",null),bf([Object(d.a)(qn.SavePatches),mf("design:type",Function),mf("design:paramtypes",[Object,qn.SavePatches]),mf("design:returntype",void 0)],e.prototype,"preserveState",null),bf([Object(d.a)(qn.Redo),mf("design:type",Function),mf("design:paramtypes",[Object,qn.Redo]),mf("design:returntype",void 0)],e.prototype,"redo",null),bf([Object(d.a)(qn.Undo),mf("design:type",Function),mf("design:paramtypes",[Object,qn.Undo]),mf("design:returntype",void 0)],e.prototype,"undo",null),bf([Object(d.e)([Bo]),mf("design:type",Function),mf("design:paramtypes",[Object,Ft]),mf("design:returntype",Boolean)],e,"canUndo",null),bf([Object(d.e)([Bo]),mf("design:type",Function),mf("design:paramtypes",[Object,Ft]),mf("design:returntype",Boolean)],e,"canRedo",null),bf([Object(d.e)([Bo]),mf("design:type",Function),mf("design:paramtypes",[Object,Ft]),mf("design:returntype",Number)],e,"getUndoCount",null),e=bf([Object(d.f)({name:"undo",defaults:ff})],e),e})(),xf=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-pillbox-divider"]],decls:1,vars:0,consts:[[1,"pillbox-divider"]],template:function(e,t){1&e&&i.Qb(0,"div",0)},styles:[".pillbox-divider{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;border-right:1px solid rgba(0,0,0,.1);border-right:var(--pillbox-border);height:18px;margin:0 8px}"],encapsulation:2,changeDetection:0}),e})();function vf(e,t){if(1&e){const e=i.Wb();i.Tb(0),i.Qb(1,"app-pillbox-divider"),i.Vb(2,"button",2),i.cc("click",(function(){return i.zc(e),i.gc().handleExitClick()})),i.Ub(),i.Sb()}if(2&e){const e=i.gc();i.Db(2),i.lc("gaAction","Clicked Close "+e.name)("matTooltip","Close "+e.name),i.Eb("aria-label","Close "+e.name)}}const wf=function(e,t,n){return{"pillbox--padding-dense":e,"pillbox--padding-none":t,"pillbox--vertical":n}},Of=["*"];let Cf=(()=>{class e{constructor(){this.canExit=!1,this.padding="normal",this.orientation="horizontal",this.name="",this.eventCategory="",this.exit=new i.p}ngOnInit(){}handleExitClick(){this.exit.emit()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-pillbox"]],inputs:{canExit:"canExit",padding:"padding",orientation:"orientation",name:"name",eventCategory:"eventCategory"},outputs:{exit:"exit"},ngContentSelectors:Of,decls:3,vars:7,consts:[[1,"pillbox",3,"gaCategory","ngClass"],[4,"ngIf"],["gaEvent","","data-test","closePillboxButton","app-pin-button","","buttonType","ghost","icon","times",3,"gaAction","matTooltip","click"]],template:function(e,t){1&e&&(i.kc(),i.Vb(0,"div",0),i.jc(1),i.Kc(2,vf,3,3,"ng-container",1),i.Ub()),2&e&&(i.lc("gaCategory",t.eventCategory)("ngClass",i.qc(3,wf,"dense"===t.padding,"none"===t.padding,"vertical"===t.orientation)),i.Db(2),i.lc("ngIf",t.canExit))},directives:[J.a,ms.i,ms.l,xf,Ad,J.b,Rd.c],styles:[".pillbox{border-radius:32px;background-color:hsla(0,0%,100%,.9);box-shadow:1px -1px 2px 0 rgba(28,42,63,.1),0 1px 2px 0 rgba(28,42,63,.3);color:#131c2a;background-color:var(--pillbox-bg);box-shadow:var(--pillbox-shadow);color:var(--pillbox-color);padding:6px;display:inline-flex;justify-content:center;align-items:center;overflow:hidden;transition:padding .15s}.pillbox--padding-dense{padding:4px}.pillbox--padding-none{padding:0}.pillbox--vertical{flex-direction:column;padding:6px}"],encapsulation:2,changeDetection:0}),e})();var Sf=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},kf=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function _f(e,t){if(1&e){const e=i.Wb();i.Vb(0,"div",1),i.Vb(1,"app-pillbox",2),i.Vb(2,"button",3),i.cc("click",(function(){return i.zc(e),i.gc().handleUndoClick()})),i.hc(3,"async"),i.hc(4,"async"),i.Ub(),i.Vb(5,"button",4),i.cc("click",(function(){return i.zc(e),i.gc().handleRedoClick()})),i.hc(6,"async"),i.hc(7,"async"),i.Ub(),i.Vb(8,"button",5),i.cc("click",(function(){return i.zc(e),i.gc().handleResetClick()})),i.hc(9,"async"),i.hc(10,"async"),i.Vb(11,"span",6),i.Mc(12,"Reset"),i.Ub(),i.Ub(),i.Ub(),i.Ub()}if(2&e){const e=i.gc();i.lc("@show",void 0),i.Db(2),i.lc("disabled",!i.ic(4,9,e.canUndo$)),i.Eb("aria-disabled",!i.ic(3,7,e.canUndo$)),i.Db(3),i.lc("disabled",!i.ic(7,13,e.canRedo$)),i.Eb("aria-disabled",!i.ic(6,11,e.canRedo$)),i.Db(3),i.lc("disabled",!i.ic(10,17,e.canUndo$)),i.Eb("aria-disabled",!i.ic(9,15,e.canUndo$))}}let jf=(()=>{class e{constructor(e){this.viewService=e}ngOnInit(){}handleUndoClick(){this.viewService.undo()}handleRedoClick(){this.viewService.redo()}handleResetClick(){this.viewService.resetChapter()}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(Ip))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-undo"]],decls:2,vars:3,consts:[["class","view-undo",4,"ngIf"],[1,"view-undo"],["padding","dense"],["app-pin-button","","data-test","undo-btn","buttonType","ghost","icon","undo","aria-label","Undo","matTooltip","Undo",1,"mr-2",3,"disabled","click"],["buttonType","ghost","app-pin-button","","data-test","redo-btn","aria-label","Redo","matTooltip","Redo","icon","redo",1,"mr-2",3,"disabled","click"],["app-pin-button","","buttonType","ghost",3,"disabled","click"],[1,"ph-4","text-bold"]],template:function(e,t){1&e&&(i.Kc(0,_f,13,19,"div",0),i.hc(1,"async")),2&e&&i.lc("ngIf",i.ic(1,1,t.canUndo$))},directives:[ms.l,Cf,Ad,Rd.c],pipes:[ms.b],styles:["[_nghost-%COMP%]{display:flex;justify-content:center;width:100%;padding:8px 0;pointer-events:none}"],data:{animation:[Object(ol.n)("show",[Object(ol.m)(":enter",Object(ol.j)([Object(ol.l)({transform:"translateY(-100%)",opacity:0}),Object(ol.e)("150ms ease-in-out",Object(ol.l)({transform:"translateY(0%)",opacity:1}))]))])]},changeDetection:0}),Sf([Object(d.d)(yf.canUndo),kf("design:type",q.a)],e.prototype,"canUndo$",void 0),Sf([Object(d.d)(yf.canRedo),kf("design:type",q.a)],e.prototype,"canRedo$",void 0),Sf([Object(d.d)(yf.getUndoCount),kf("design:type",q.a)],e.prototype,"undoCount$",void 0),e})();var Pf=n("gcYM"),Mf=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},If=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const zf=["scrubber"],Tf=["track"],Uf=["bar"],Lf=["handle"],Df=function(e){return{"view-scrubber--draggable":e}},Ef=function(e,t){return{"view-scrubber__handle--hide":e,"view-scrubber__handle-touch":t}};let Ff=(()=>{class e{constructor(e,t,n,i,o,s){this.engineService=e,this.animationService=t,this.renderer=n,this.viewService=i,this.changeDetectorRef=o,this.store=s,this.showHandle=!0,this.ngUnsubscribe=new $.a,this.trackWidth=0,this.dragPosition={x:16,y:0},this.playing=!0}ngOnInit(){this.initChapterListener(),this.initTimelineListener()}ngAfterViewInit(){this.initDragListener()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initChapterListener(){this.selectedChapterId$.pipe(Object(K.a)(e=>null!=e),Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.timerange=this.animationService.getChapterLocalTimerange(e)})}initTimelineListener(){this.engineService.getEvent(it.TimelinePlaying).pipe(Object(Pf.a)(20),Object(W.a)(this.ngUnsubscribe)).subscribe(e=>this.tick(e.time)),this.engineService.getEvent(it.TimelineScrubbed).pipe(Object(Pf.a)(20),Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{const t=this.calcScrubbedPercent(e.time);this.setScrubberBar(t)})}initDragListener(){this.dragInstance.moved.pipe(Object(ds.a)(20),Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{const t=this.calculateHandlePercent();this.scrubToPercent(t)})}handleDragStart(){this.playing=this.store.selectSnapshot(is.getAnimationPlaying),this.store.dispatch(new je(!1))}handleDragEnd(){this.store.dispatch(new je(this.playing))}handleTrackClick(e){if(!this.showHandle)return;const t=e.offsetX/this.track.nativeElement.getBoundingClientRect().width*100;this.playing=this.store.selectSnapshot(is.getAnimationPlaying),this.scrubToPercent(t),this.setScrubberBar(t),this.setScrubberHandle(t),this.store.dispatch(new je(this.playing))}tick(e){if(!this.timerange)return;const t=this.calcScrubbedPercent(e);this.setScrubberBar(t),this.setScrubberHandle(t)}calculateHandlePercent(){const{left:e,right:t}=this.scrubber.nativeElement.getBoundingClientRect(),n=t-e-this.handle.nativeElement.offsetWidth,i=this.handle.nativeElement.getBoundingClientRect().left;return Math.min(Math.max((i-e)/n*100,0),100)}scrubToPercent(e){const t=e/100*this.timerange.lastTime,n=0===e?"second":"first",i=this.store.selectSnapshot(Bo.getSelectedChapterId),o=this.animationService.mapLocalTimeToGlobal(i,t);this.animationService.scrub({time:o,which:n})}handlePlayClick(){this.viewService.toggleAnimation()}setScrubberBar(e){this.renderer.setStyle(this.bar.nativeElement,"width",e+"%")}setScrubberHandle(e){0===this.trackWidth&&(this.trackWidth=this.track.nativeElement.offsetWidth),this.showHandle&&(this.dragPosition=Object.assign(Object.assign({},this.dragPosition),{x:16+this.trackWidth*(e/100)}),this.changeDetectorRef.markForCheck())}calcScrubbedPercent(e){const{firstTime:t,lastTime:n}=this.timerange,i=this.animationService.mapGlobalTimeToLocal(e).time,o=Math.max(t,Math.min(i,n));return Math.round(o/n*100)}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(lt),i.Pb(Do),i.Pb(i.H),i.Pb(Ip),i.Pb(i.i),i.Pb(d.g))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-scrubber"]],viewQuery:function(e,t){if(1&e&&(i.Gc(zf,!0),i.Gc(Tf,!0),i.Gc(Uf,!0),i.Gc(Lf,!0),i.Rc(Ao.a,!0)),2&e){let e;i.uc(e=i.dc())&&(t.scrubber=e.first),i.uc(e=i.dc())&&(t.track=e.first),i.uc(e=i.dc())&&(t.bar=e.first),i.uc(e=i.dc())&&(t.handle=e.first),i.uc(e=i.dc())&&(t.dragInstance=e.first)}},inputs:{showHandle:"showHandle"},decls:9,vars:10,consts:[["gaCategory","View Media Bar",1,"view-scrubber",3,"ngClass"],["scrubber",""],[1,"view-scrubber__track",3,"click"],["track",""],[1,"view-scrubber__bar"],["bar",""],["gaEvent","","gaAction","Clicked Scrubber","cdkDrag","","cdkDragLockAxis","x","cdkDragBoundary",".view-scrubber",1,"view-scrubber__handle",3,"cdkDragFreeDragPosition","ngClass","cdkDragStarted","cdkDragEnded"],["handle",""]],template:function(e,t){1&e&&(i.Vb(0,"div",0,1),i.Vb(2,"div",2,3),i.cc("click",(function(e){return t.handleTrackClick(e)})),i.Qb(4,"div",4,5),i.Ub(),i.Vb(6,"div",6,7),i.cc("cdkDragStarted",(function(){return t.handleDragStart()}))("cdkDragEnded",(function(){return t.handleDragEnd()})),i.hc(8,"async"),i.Ub(),i.Ub()),2&e&&(i.lc("ngClass",i.oc(5,Df,t.showHandle)),i.Db(6),i.lc("cdkDragFreeDragPosition",t.dragPosition)("ngClass",i.pc(7,Ef,!t.showHandle,i.ic(8,3,t.canTouch$))))},directives:[J.a,ms.i,J.b,Ao.a],pipes:[ms.b],styles:['.view-scrubber{position:relative;display:flex;justify-content:center;align-items:center;height:40px;width:100%}.view-scrubber:hover .view-scrubber__handle:after{opacity:1}.view-scrubber--draggable .view-scrubber__track{left:16px;right:16px}.view-scrubber__track{background:rgba(150,168,192,.6);background:var(--scrubber-track-bg);z-index:1;right:0}.view-scrubber__bar,.view-scrubber__track{border-radius:2px;position:absolute;height:4px;left:0}.view-scrubber__bar{background:#374a68;background:var(--scrubber-track-color);z-index:2;width:0}.view-scrubber__handle{width:40px;height:40px;margin-left:-16px;left:0;display:flex;align-items:center;justify-content:center;position:absolute;z-index:2}.view-scrubber__handle--hide{display:none}.view-scrubber__handle:after{opacity:1;transition:opacity .25s;content:"";width:8px;height:8px;border-radius:4px;background:var(--scrubber-handle-color);box-shadow:var(--scrubber-handle-shadow)}.view-scrubber__handle:hover:after{background:var(--scrubber-handle-color--hover)}.view-scrubber__handle:hover{cursor:pointer}.view-scrubber__handle-touch:after{opacity:1}'],encapsulation:2,changeDetection:0}),Mf([Object(d.d)(is.getAnimationPlaying),If("design:type",q.a)],e.prototype,"animationPlaying$",void 0),Mf([Object(d.d)(Bo.getSelectedChapterId),If("design:type",q.a)],e.prototype,"selectedChapterId$",void 0),Mf([Object(d.d)(il.getCanTouch),If("design:type",q.a)],e.prototype,"canTouch$",void 0),e})();var Af=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},Rf=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Nf(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",10),i.cc("click",(function(){return i.zc(e),i.gc(2).handlePlayClick()})),i.hc(1,"async"),i.hc(2,"async"),i.hc(3,"async"),i.Ub()}if(2&e){const e=i.gc(2);i.lc("gaLabel",i.ic(1,3,e.animationPlaying$)?"Pause":"Play")("matTooltip",i.ic(2,5,e.animationPlaying$)?"Pause":"Play")("icon",i.ic(3,7,e.animationPlaying$)?"pause":"play")}}function Vf(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",11),i.cc("click",(function(){return i.zc(e),i.gc(2).handlePlayChapterFromStartClick()})),i.Ub()}}function Hf(e,t){1&e&&i.Qb(0,"app-view-scrubber",12)}function Bf(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",13),i.cc("click",(function(){return i.zc(e),i.gc(2).handleAudioClick()})),i.hc(1,"async"),i.hc(2,"async"),i.hc(3,"async"),i.Ub()}if(2&e){const e=i.gc(2);i.lc("gaLabel",i.ic(1,3,e.playAudio$)?"Mute":"Play")("icon",i.ic(2,5,e.playAudio$)?"volume":"volume-slash")("matTooltip",i.ic(3,7,e.playAudio$)?"Mute Audio":"Play Audio")}}function Qf(e,t){if(1&e&&(i.Vb(0,"div",3),i.Kc(1,Nf,4,9,"button",4),i.Kc(2,Vf,1,0,"button",5),i.Kc(3,Hf,1,0,"app-view-scrubber",6),i.Vb(4,"button",7),i.Vb(5,"span",8),i.Mc(6),i.hc(7,"async"),i.Ub(),i.Ub(),i.Kc(8,Bf,4,9,"button",9),i.Ub()),2&e){const e=i.gc(),t=i.vc(2);i.Db(1),i.lc("ngIf",e.showPlayPause),i.Db(1),i.lc("ngIf",e.showPlayPause),i.Db(1),i.lc("ngIf",e.showScrubber),i.Db(1),i.lc("matMenuTriggerFor",t),i.Db(2),i.Oc("",i.ic(7,6,e.playbackSpeed$),"x"),i.Db(2),i.lc("ngIf",e.audioVisible)}}let $f=(()=>{class e{constructor(e,t,n,i,o){this.animationService=e,this.viewService=t,this.layoutService=n,this.store=i,this.changeDetectorRef=o,this.viewLayout=Cl,this.size="small",this.showPlayPause=!0,this.showScrubber=!0,this.showBar=!0,this.audioVisible=!1,this.ngUnsubscribe=new $.a}get template(){return this._template}set template(e){this._template=e,this.updateLayoutProperties(this.template)}ngOnInit(){this.initChapterListener(),this.initLayoutListener()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initChapterListener(){this.selectedChapterId$.pipe(Object(K.a)(e=>null!=e),Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.timerange=this.animationService.getChapterLocalTimerange(e)})}initLayoutListener(){this.store.select(il.getUI).pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(()=>{this.audioVisible=this.layoutService.isVisible(Cl.Audio),this.changeDetectorRef.markForCheck()})}updateLayoutProperties(e){this.showBar=e!==sa.None,this.showScrubber=e===sa.Full,this.showPlayPause=e!==sa.None}handlePlayClick(){this.viewService.toggleAnimation()}handleAudioClick(){this.viewService.toggleAudio()}handlePlayChapterFromStartClick(){this.viewService.playChapterFromStart()}setPlaybackSpeed(e){this.store.dispatch(new Me(e))}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(Do),i.Pb(Ip),i.Pb(Ml),i.Pb(d.g),i.Pb(i.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-media-bar"]],inputs:{template:"template",size:"size"},decls:11,vars:1,consts:[["gaCategory","View Media Bar","class","view-media-bar",4,"ngIf"],["playbackMenu","matMenu"],["mat-menu-item","",3,"click"],["gaCategory","View Media Bar",1,"view-media-bar"],["gaEvent","","gaAction","Clicked Toggle Animation","app-pin-button","","buttonType","ghost","data-test","Play/Pause__small","matTooltipPosition","above",3,"gaLabel","matTooltip","icon","click",4,"ngIf"],["gaEvent","","gaAction","Clicked Play Chapter From Start","app-pin-button","","buttonType","ghost","matTooltipPosition","above","matTooltip","Play Chapter from Start","icon","step-backward",3,"click",4,"ngIf"],["class","view-media-bar__scrubber","data-test","Scrub__small",4,"ngIf"],["app-pin-button","","buttonType","ghost","matTooltipPosition","above","matTooltip","Playback Speed",3,"matMenuTriggerFor"],[1,"text-semibold"],["gaEvent","","gaAction","Clicked Toggle Audio","app-pin-button","","buttonType","ghost","class","view-tools__item",3,"gaLabel","icon","matTooltip","click",4,"ngIf"],["gaEvent","","gaAction","Clicked Toggle Animation","app-pin-button","","buttonType","ghost","data-test","Play/Pause__small","matTooltipPosition","above",3,"gaLabel","matTooltip","icon","click"],["gaEvent","","gaAction","Clicked Play Chapter From Start","app-pin-button","","buttonType","ghost","matTooltipPosition","above","matTooltip","Play Chapter from Start","icon","step-backward",3,"click"],["data-test","Scrub__small",1,"view-media-bar__scrubber"],["gaEvent","","gaAction","Clicked Toggle Audio","app-pin-button","","buttonType","ghost",1,"view-tools__item",3,"gaLabel","icon","matTooltip","click"]],template:function(e,t){1&e&&(i.Kc(0,Qf,9,8,"div",0),i.Vb(1,"mat-menu",null,1),i.Vb(3,"button",2),i.cc("click",(function(){return t.setPlaybackSpeed(1)})),i.Mc(4,"Normal"),i.Ub(),i.Vb(5,"button",2),i.cc("click",(function(){return t.setPlaybackSpeed(.5)})),i.Mc(6,"0.5"),i.Ub(),i.Vb(7,"button",2),i.cc("click",(function(){return t.setPlaybackSpeed(.25)})),i.Mc(8,"0.25"),i.Ub(),i.Vb(9,"button",2),i.cc("click",(function(){return t.setPlaybackSpeed(.1)})),i.Mc(10,"0.1"),i.Ub(),i.Ub()),2&e&&i.lc("ngIf",t.showBar)},directives:[ms.l,ic.a,ic.b,J.a,Ad,Rd.c,ic.d,J.b,Ff],pipes:[ms.b],styles:[".view-media-bar{display:flex}.view-media-bar__scrubber{width:120px;display:flex;justify-content:center;align-items:center}"],encapsulation:2,changeDetection:0}),Af([Object(d.d)(is.getAnimationPlaying),Rf("design:type",q.a)],e.prototype,"animationPlaying$",void 0),Af([Object(d.d)(Bo.getSelectedChapterId),Rf("design:type",q.a)],e.prototype,"selectedChapterId$",void 0),Af([Object(d.d)(is.getPlayAudio),Rf("design:type",q.a)],e.prototype,"playAudio$",void 0),Af([Object(d.d)(is.getPlaybackSpeed),Rf("design:type",q.a)],e.prototype,"playbackSpeed$",void 0),e})();const qf=()=>window.navigator.userAgent.includes("Trident");let Wf=(()=>{class e{constructor(e,t){this.el=e,this.renderer=t}ngOnInit(){qf()&&this.renderer.setStyle(this.el.nativeElement,"display","none")}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(i.m),i.Pb(i.H))},e.\u0275dir=i.Kb({type:e,selectors:[["","appHideIE11",""]]}),e})();var Kf=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},Gf=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const Zf=["chapterCount"],Jf=["mediaToggle"];function Xf(e,t){if(1&e){const e=i.Wb();i.Vb(0,"div",5),i.Vb(1,"button",6),i.cc("click",(function(){return i.zc(e),i.gc(2).handlePreviousClick()})),i.hc(2,"async"),i.hc(3,"async"),i.hc(4,"async"),i.hc(5,"async"),i.Ub(),i.Vb(6,"button",7),i.cc("click",(function(){return i.zc(e),i.gc(2).handleNextClick()})),i.hc(7,"async"),i.hc(8,"async"),i.hc(9,"async"),i.hc(10,"async"),i.hc(11,"async"),i.hc(12,"async"),i.Ub(),i.Ub()}if(2&e){const e=i.gc(2);let t=null,n=null;i.Db(1),i.lc("disabled",0===i.ic(2,6,e.chapterIndex$))("matTooltip",i.ic(4,10,e.previousChapter$)?"Previous: "+(null==(t=i.ic(5,12,e.previousChapter$))?null:t.info.displayName):""),i.Eb("aria-disabled",0===i.ic(3,8,e.chapterIndex$)),i.Db(5),i.lc("disabled",i.ic(9,18,e.chapterIndex$)===i.ic(10,20,e.chapterCount$)-1)("matTooltip",i.ic(11,22,e.nextChapter$)?"Next: "+(null==(n=i.ic(12,24,e.nextChapter$))?null:n.info.displayName):""),i.Eb("aria-disabled",i.ic(7,14,e.chapterIndex$)===i.ic(8,16,e.chapterCount$)-1)}}function Yf(e,t){if(1&e){const e=i.Wb();i.Vb(0,"div",5),i.Vb(1,"div",8,9),i.Vb(3,"button",10),i.cc("click",(function(){return i.zc(e),i.gc(2).handleChapterCountClick()})),i.Vb(4,"div",11),i.Mc(5),i.hc(6,"async"),i.hc(7,"async"),i.Qb(8,"app-icon",12),i.Ub(),i.Vb(9,"span",13),i.Mc(10),i.hc(11,"async"),i.hc(12,"async"),i.Ub(),i.Ub(),i.Ub(),i.Ub()}if(2&e){const e=i.gc(2);i.Db(3),i.lc("matTooltip",e.chaptersPopup?"Close Chapter List":"Open Chapter List"),i.Eb("visible",e.breakpoint!==e.breakpointEnum.Small),i.Db(2),i.Pc(" ",i.ic(6,6,e.chapterIndex$)+1," of ",i.ic(7,8,e.chapterCount$)," "),i.Db(5),i.Pc(" Toggle Chapter List, Chapter ",i.ic(11,10,e.chapterIndex$)+1," of ",i.ic(12,12,e.chapterCount$)," ")}}function ey(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",17),i.cc("click",(function(){return i.zc(e),i.gc(3).toggleToolbar("media")})),i.Qb(1,"app-view-scrubber",18),i.Ub()}2&e&&(i.Db(1),i.lc("showHandle",!1))}function ty(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",19),i.cc("click",(function(){return i.zc(e),i.gc(3).handleAudioClick()})),i.hc(1,"async"),i.hc(2,"async"),i.hc(3,"async"),i.Ub()}if(2&e){const e=i.gc(3);i.lc("gaLabel",i.ic(1,3,e.playAudio$)?"Mute":"Unmute")("icon",i.ic(2,5,e.playAudio$)?"volume":"volume-slash")("matTooltip",i.ic(3,7,e.playAudio$)?"Mute Audio":"Play Audio")}}function ny(e,t){if(1&e){const e=i.Wb();i.Vb(0,"div",5),i.Vb(1,"button",14),i.cc("click",(function(){return i.zc(e),i.gc(2).handlePlayClick()})),i.hc(2,"async"),i.hc(3,"async"),i.hc(4,"async"),i.hc(5,"async"),i.Ub(),i.Kc(6,ey,2,1,"button",15),i.Kc(7,ty,4,9,"button",16),i.Ub()}if(2&e){const e=i.gc(2);i.Db(1),i.lc("gaLabel",i.ic(2,6,e.animationPlaying$)?"Pause":"Play")("icon",i.ic(3,8,e.animationPlaying$)?"pause":"play")("matTooltip",i.ic(5,12,e.animationPlaying$)?"Pause Animation":"Play Animation"),i.Eb("aria-label",i.ic(4,10,e.animationPlaying$)?"Pause Animation":"Play Animation"),i.Db(5),i.lc("ngIf",e.mediaTemplate===e.mediaControlsEnum.Full),i.Db(1),i.lc("ngIf",e.audioVisible)}}function iy(e,t){if(1&e&&(i.Tb(0,3),i.Kc(1,Xf,13,26,"div",4),i.Kc(2,Yf,13,14,"div",4),i.Kc(3,ny,8,14,"div",4),i.Sb()),2&e){const e=i.gc();i.Db(1),i.lc("ngIf",e.paginationVisible),i.Db(1),i.lc("ngIf",e.paginationVisible&&!e.collapsePagination),i.Db(1),i.lc("ngIf",e.mediabarVisible)}}function oy(e,t){if(1&e){const e=i.Wb();i.Tb(0,20),i.Vb(1,"div",5),i.Vb(2,"div",21),i.Vb(3,"button",22),i.cc("click",(function(){i.zc(e);const t=i.gc();return t.handleSelectTool(t.toolEnum.Select)})),i.hc(4,"async"),i.Ub(),i.Vb(5,"button",23),i.cc("click",(function(){i.zc(e);const t=i.gc();return t.handleSelectTool(t.toolEnum.Hide)})),i.hc(6,"async"),i.Ub(),i.Vb(7,"button",24),i.cc("click",(function(){i.zc(e);const t=i.gc();return t.handleSelectTool(t.toolEnum.Fade)})),i.hc(8,"async"),i.Ub(),i.Ub(),i.Ub(),i.Sb()}if(2&e){const e=i.gc();i.Db(3),i.lc("selected",i.ic(4,3,e.activeTool$)===e.toolEnum.Select),i.Db(2),i.lc("selected",i.ic(6,5,e.activeTool$)===e.toolEnum.Hide),i.Db(2),i.lc("selected",i.ic(8,7,e.activeTool$)===e.toolEnum.Fade)}}let sy=(()=>{class e{constructor(e,t,n,o,s,r){this.viewService=e,this.viewUIService=t,this.store=n,this.changeDetectorRef=o,this.popupService=s,this.ga=r,this.viewToolsMode=gg,this.viewUI=Cl,this.breakpointEnum=fl,this.canFullscreen=!0,this.isFullscreen=!1,this.toolEnum=Go,this.mediaControlsEnum=sa,this.paginationVisible=!1,this.mediabarVisible=!1,this.audioVisible=!1,this.ngUnsubscribe=new $.a,this.animate=!0,this._mode=gg.Main,this.collapsePagination=!1,this.modeChange=new i.p}get mode(){return this._mode}set mode(e){this._mode=e}ngOnInit(){this.canFullscreen=la.canFullscreen(),this.initLayoutListener(),this.initBreakpointListener(),this.initChapterListener(),this.initFullscreenListener()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initLayoutListener(){this.store.select(il.getUI).pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.mediaTemplate=e.media.template,this.paginationVisible=this.viewUIService.isVisible(Cl.Pagination),this.mediabarVisible=this.viewUIService.isVisible(Cl.Mediabar),this.audioVisible=this.viewUIService.isVisible(Cl.Audio),this.changeDetectorRef.markForCheck()})}initBreakpointListener(){this.store.select(Ol.getBreakpoint).pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.breakpoint=e,this.changeDetectorRef.markForCheck()})}initChapterListener(){this.store.select(Bo.getSelectedChapterIndex).pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(()=>{this.chaptersPopup&&this.chaptersPopup.close()})}initFullscreenListener(){this.fullscreen$=la.onFullscreenChange(),this.fullscreen$.pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.isFullscreen=la.isFullscreen(),this.changeDetectorRef.markForCheck()})}handleSelectTool(e){const t=this.store.selectSnapshot(is.getActiveTool);this.viewService.selectTool(e===t?Go.Select:e)}handlePlayClick(){this.viewService.toggleAnimation()}handleAudioClick(){this.viewService.toggleAudio()}handleMenuClick(){this.store.dispatch(new Q.ToggleMenu(!0))}handlePreviousClick(){this.viewService.previousChapter("Toolbar")}handleNextClick(){this.viewService.nextChapter("Toolbar")}handleChapterCountClick(){this.toggleChaptersPopup()}handleMediaClick(){this.toggleMediaPopup()}toggleChaptersPopup(){this.chaptersPopup?this.chaptersPopup.close():(this.chaptersPopup=this.popupService.open({origin:this.chapterCount.nativeElement,content:Sg,width:"300px"}),this.chaptersPopup.afterClosed$.pipe(Object(W.a)(this.ngUnsubscribe),Object(sl.a)(1)).subscribe(e=>{this.chaptersPopup=null}))}toggleMediaPopup(){this.mediaPopup?this.mediaPopup.close():(this.mediaPopup=this.popupService.open({origin:this.mediaToggle.nativeElement,content:$f,width:"300px"}),this.mediaPopup.afterClosed$.pipe(Object(W.a)(this.ngUnsubscribe),Object(sl.a)(1)).subscribe(e=>{this.mediaPopup=null}))}toggleToolbar(e){this.viewService.toggleToolbar(e)}isEnabled(e){return this.viewUIService.isUIEnabled(e)}isVisible(e){return this.viewUIService.isVisible(e)}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(Ip),i.Pb(Ml),i.Pb(d.g),i.Pb(i.i),i.Pb(Eg),i.Pb(J.c))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-tools"]],viewQuery:function(e,t){if(1&e&&(i.Rc(Zf,!0),i.Rc(Jf,!0)),2&e){let e;i.uc(e=i.dc())&&(t.chapterCount=e.first),i.uc(e=i.dc())&&(t.mediaToggle=e.first)}},inputs:{animate:"animate",mode:"mode",collapsePagination:"collapsePagination"},outputs:{modeChange:"modeChange"},features:[i.Cb([Eg])],decls:3,vars:2,consts:[["role","toolbar","aria-label","Tools","data-test","viewTools",1,"view-tools"],["gaCategory","View Toolbar",4,"ngIf"],["gaCategory","View Explore Tools",4,"ngIf"],["gaCategory","View Toolbar"],["class","view-tools__group",4,"ngIf"],[1,"view-tools__group"],["gaEvent","","gaAction","Clicked Previous Chapter","data-test","viewToolsPreviousChapter","aria-label","Previous Chapter","app-pin-button","","buttonType","ghost","icon","chevron-left",1,"view-tools__item",3,"disabled","matTooltip","click"],["gaEvent","","gaAction","Clicked Next Chapter","data-test","viewToolsNextChapter","aria-label","Next Chapter","app-pin-button","","buttonType","ghost","icon","chevron-right",1,"view-tools__item",3,"disabled","matTooltip","click"],["gaEvent","","gaAction","Clicked Open Chapter List",1,"view-tools__item"],["chapterCount",""],["data-test","viewToolsChapterCount","app-pin-button","","buttonType","ghost","aria-label","Toggle Chapter List",3,"matTooltip","click"],["aria-hidden","true",1,"ph-2","text-13","text-semibold",2,"white-space","nowrap"],["icon","caret-up",1,"ml-2"],[1,"visually-hidden"],["gaEvent","","gaAction","Clicked Toggle Animation","data-test","viewToolsPlay","app-pin-button","","buttonType","ghost",1,"view-tools__item",3,"gaLabel","icon","matTooltip","click"],["gaEvent","","gaAction","Clicked Open Media Bar","data-test","viewToolsMedia","app-pin-button","","buttonType","ghost","class","view-tools__item","aria-label","Open Media Bar","matTooltip","Open Media Bar",3,"click",4,"ngIf"],["gaEvent","","gaAction","Clicked Toggle Audio","data-test","viewToolsAudio","app-pin-button","","buttonType","ghost","class","view-tools__item",3,"gaLabel","icon","matTooltip","click",4,"ngIf"],["gaEvent","","gaAction","Clicked Open Media Bar","data-test","viewToolsMedia","app-pin-button","","buttonType","ghost","aria-label","Open Media Bar","matTooltip","Open Media Bar",1,"view-tools__item",3,"click"],[2,"width","32px","margin","0 8px",3,"showHandle"],["gaEvent","","gaAction","Clicked Toggle Audio","data-test","viewToolsAudio","app-pin-button","","buttonType","ghost",1,"view-tools__item",3,"gaLabel","icon","matTooltip","click"],["gaCategory","View Explore Tools"],["role","radiogroup",1,"flex"],["gaEvent","","gaAction","Clicked Select","app-pin-button","","buttonType","ghost","icon","mouse-pointer","aria-label","Select","matTooltip","Select","data-test","viewToolsSelect",1,"view-tools__item",3,"selected","click"],["gaEvent","","gaAction","Clicked Hide","app-pin-button","","buttonType","ghost","icon","eye-slash","aria-label","Hide","matTooltip","Hide","data-test","viewToolsHide",1,"view-tools__item",3,"selected","click"],["gaEvent","","gaAction","Clicked Fade","app-pin-button","","appHideIE11","","buttonType","ghost","aria-label","Fade","matTooltip","Fade","icon","adjust","data-test","viewToolsFade",1,"view-tools__item",3,"selected","click"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Kc(1,iy,4,3,"ng-container",1),i.Kc(2,oy,9,9,"ng-container",2),i.Ub()),2&e&&(i.Db(1),i.lc("ngIf",t.mode===t.viewToolsMode.Main),i.Db(1),i.lc("ngIf",t.mode===t.viewToolsMode.Tools))},directives:[ms.l,J.a,Ad,J.b,Rd.c,$a,Ff,Wf],pipes:[ms.b],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3838}.text-info{color:#0060c4}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.view-tools{display:flex;justify-content:center;overflow:hidden}@-webkit-keyframes viewToolsToggle{0%{opacity:1}50%{opacity:0}to{opacity:1}}@keyframes viewToolsToggle{0%{opacity:1}50%{opacity:0}to{opacity:1}}.view-tools--swap{-webkit-animation:viewToolsToggle .3s ease-in-out;animation:viewToolsToggle .3s ease-in-out}.view-tools--dense .view-tools__divider{margin:4px}.view-tools__inner{display:flex;justify-content:center}.view-tools__group{border-right:var(--view-tools-border);padding:0 8px;display:flex}.view-tools__group:empty{display:none}.view-tools__group:empty:first-of-type+.view-tools__group:not(:empty),.view-tools__group:first-of-type{padding-left:0}.view-tools__group:last-of-type{border-right:none;padding-right:0}.view-tools__item{display:flex;align-items:center}.view-tools__item:not(:last-child){margin-right:4px}.view-tools__divider{border-right:var(--view-tools-border);margin:4px 8px}.view-tools__count{font-size:12px;letter-spacing:.3px;line-height:1.4em;white-space:nowrap}"],encapsulation:2,changeDetection:0}),Kf([Object(d.d)(Bo.getSelectedChapterReadyState),Gf("design:type",q.a)],e.prototype,"selectedChapterReady$",void 0),Kf([Object(d.d)(is.getActiveTool),Gf("design:type",q.a)],e.prototype,"activeTool$",void 0),Kf([Object(d.d)(il.getPresentationActive),Gf("design:type",q.a)],e.prototype,"presentationActive$",void 0),Kf([Object(d.d)(Bo.getIsChapterAnimated),Gf("design:type",q.a)],e.prototype,"isChapterAnimated$",void 0),Kf([Object(d.d)(is.getShowLabels),Gf("design:type",q.a)],e.prototype,"showLabels$",void 0),Kf([Object(d.d)(is.getAnimationPlaying),Gf("design:type",q.a)],e.prototype,"animationPlaying$",void 0),Kf([Object(d.d)(is.getPlayAudio),Gf("design:type",q.a)],e.prototype,"playAudio$",void 0),Kf([Object(d.d)(Tr.getChapterLabels),Gf("design:type",q.a)],e.prototype,"labels$",void 0),Kf([Object(d.d)(Bo.getSelectedChapterTitle),Gf("design:type",q.a)],e.prototype,"chapterTitle$",void 0),Kf([Object(d.d)(Bo.getSelectedChapterIndex),Gf("design:type",q.a)],e.prototype,"chapterIndex$",void 0),Kf([Object(d.d)(Bo.getNextChapter),Gf("design:type",q.a)],e.prototype,"nextChapter$",void 0),Kf([Object(d.d)(Bo.getPreviousChapter),Gf("design:type",q.a)],e.prototype,"previousChapter$",void 0),Kf([Object(d.d)(Bo.getChapterCount),Gf("design:type",q.a)],e.prototype,"chapterCount$",void 0),Kf([Object(d.d)(Bo.getSelectedChapterAudio),Gf("design:type",q.a)],e.prototype,"selectedChapterAudio$",void 0),Kf([Object(d.d)(il.getCanTouch),Gf("design:type",q.a)],e.prototype,"canTouch$",void 0),e})();var ry=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},ay=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const cy=["slider"],ly=["track"],py=["bar"],dy=["handle"],uy=function(e){return{"view-layers-slider__handle-touch":e}};let gy=(()=>{class e{constructor(e,t,n){this.renderer=e,this.visibilityLayersService=t,this.changeDetectorRef=n,this.ngUnsubscribe=new $.a,this.currentLayers=[],this.fullOffset=0,this.dragMove=new $.a,this.dragPosition={x:0,y:0},this.currentLayerName=""}ngOnInit(){this.initLayersObserver(),this.initIndexPositionObserver(),this.initDragMoveObserver()}ngAfterViewInit(){this.fullOffset=this.track.nativeElement.offsetWidth}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initLayersObserver(){this.selectedChapterCurrentLayers$.pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.currentLayers=e})}initIndexPositionObserver(){Object(rs.b)(this.selectedChapterCurrentLayersIndex$,this.selectedChapterCurrentLayersPosition$).pipe(Object(K.a)(([e,t])=>!Object(X.isNil)(e)&&!Object(X.isNil)(t)),Object(W.a)(this.ngUnsubscribe)).subscribe(([e,t])=>{this.currentLayerName=this.currentLayers[e].name;const n=this.visibilityLayersService.indexPositionToFraction(e,t);this.setSliderBar(n),this.setSliderHandle(n)})}initDragMoveObserver(){this.dragMove.pipe(Object(ds.a)(20),Object(W.a)(this.ngUnsubscribe)).subscribe(()=>this.handleAuditedDrag())}handleDragEnded(){const e=this.calculateHandleFraction(),t=this.visibilityLayersService.fractionToIndex(e),n=this.visibilityLayersService.fractionToPosition(e,t);this.visibilityLayersService.recordLayerIndexPosition(t,n)}handleDragMoved(e){this.dragMove.next(e)}handleAuditedDrag(){const e=this.calculateHandleFraction(),t=this.visibilityLayersService.fractionToIndex(e),n=this.visibilityLayersService.fractionToPosition(e,t);this.currentLayerName=this.currentLayers[t].name,this.visibilityLayersService.synchronizeScene(t,n,!1),this.setSliderBar(e)}handleTrackClick(e){const t=e.offsetX/this.fullOffset,n=this.visibilityLayersService.fractionToIndex(t),i=this.visibilityLayersService.fractionToPosition(t,n);this.visibilityLayersService.recordLayerIndexPosition(n,i)}calculateHandleFraction(){const e=this.slider.nativeElement.getBoundingClientRect();return(this.handle.nativeElement.getBoundingClientRect().left-e.left)/this.fullOffset}setSliderBar(e){this.renderer.setStyle(this.bar.nativeElement,"width",100*e+"%")}setSliderHandle(e){this.dragPosition={x:e*this.fullOffset,y:this.dragPosition.y},this.changeDetectorRef.markForCheck()}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(i.H),i.Pb(ea),i.Pb(i.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-layers-slider"]],viewQuery:function(e,t){if(1&e&&(i.Gc(cy,!0),i.Gc(ly,!0),i.Gc(py,!0),i.Gc(dy,!0)),2&e){let e;i.uc(e=i.dc())&&(t.slider=e.first),i.uc(e=i.dc())&&(t.track=e.first),i.uc(e=i.dc())&&(t.bar=e.first),i.uc(e=i.dc())&&(t.handle=e.first)}},decls:9,vars:7,consts:[[1,"view-layers-slider"],["slider",""],[1,"view-layers-slider__track",3,"click"],["track",""],[1,"view-layers-slider__bar"],["bar",""],["cdkDrag","","cdkDragLockAxis","x","cdkDragBoundary",".view-layers-slider",1,"view-layers-slider__handle",3,"cdkDragFreeDragPosition","ngClass","matTooltip","cdkDragEnded","cdkDragMoved"],["handle",""]],template:function(e,t){1&e&&(i.Vb(0,"div",0,1),i.Vb(2,"div",2,3),i.cc("click",(function(e){return t.handleTrackClick(e)})),i.Qb(4,"div",4,5),i.Ub(),i.Vb(6,"div",6,7),i.cc("cdkDragEnded",(function(){return t.handleDragEnded()}))("cdkDragMoved",(function(e){return t.handleDragMoved(e)})),i.hc(8,"async"),i.Ub(),i.Ub()),2&e&&(i.Db(6),i.mc("matTooltip",t.currentLayerName),i.lc("cdkDragFreeDragPosition",t.dragPosition)("ngClass",i.oc(5,uy,i.ic(8,3,t.canTouch$))))},directives:[Ao.a,ms.i,Rd.c],pipes:[ms.b],styles:['.view-layers-slider[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;height:28px;width:100%}.view-layers-slider__track[_ngcontent-%COMP%]{position:absolute;background:rgba(28,42,63,.5);background:var(--scrubber-track-bg);z-index:1;height:5px;border-radius:5px;left:14px;right:14px}.view-layers-slider__bar[_ngcontent-%COMP%]{position:absolute;background:var(--scrubber-track-color);height:5px;border-radius:5px;z-index:2;width:0;left:0;pointer-events:none}.view-layers-slider__handle[_ngcontent-%COMP%]{width:28px;height:28px;margin-left:-14px;left:14px;display:flex;align-items:center;justify-content:center;position:absolute;z-index:2}.view-layers-slider__handle--hide[_ngcontent-%COMP%]{display:none}.view-layers-slider__handle[_ngcontent-%COMP%]:after{content:"";width:12px;height:12px;border-radius:6px;background:var(--scrubber-handle-color);box-shadow:var(--scrubber-handle-shadow)}.view-layers-slider__handle[_ngcontent-%COMP%]:hover:after{background:var(--scrubber-handle-color--hover)}'],changeDetection:0}),ry([Object(d.d)(Bo.getSelectedChapterCurrentLayers),ay("design:type",q.a)],e.prototype,"selectedChapterCurrentLayers$",void 0),ry([Object(d.d)(Bo.getSelectedChapterCurrentLayersIndex),ay("design:type",q.a)],e.prototype,"selectedChapterCurrentLayersIndex$",void 0),ry([Object(d.d)(Bo.getSelectedChapterCurrentLayersPosition),ay("design:type",q.a)],e.prototype,"selectedChapterCurrentLayersPosition$",void 0),ry([Object(d.d)(il.getCanTouch),ay("design:type",q.a)],e.prototype,"canTouch$",void 0),e})();const hy=function(e,t,n){return{"view-layers-bar__slider--large":e,"view-layers-bar__slider--small":t,"view-layers-bar__slider--disabled":n}};let by=(()=>{class e{constructor(e,t,n){this.store=e,this.engineService=t,this.changeDetectorRef=n,this.ngUnsubscribe=new $.a,this.assetsLoading=!1}ngOnInit(){this.engineService.getEvent(it.AssetsLoadProgress).pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.assetsLoading=e.requestedAssets!==e.receivedAssets,this.changeDetectorRef.markForCheck()})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}isLarge(){return this.store.selectSnapshot(Ol.getBreakpoint)>=fl.Medium}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.g),i.Pb(lt),i.Pb(i.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-layers-bar"]],decls:2,vars:5,consts:[[1,"view-layers-bar"],[1,"view-layers-bar__slider",3,"ngClass"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Qb(1,"app-view-layers-slider",1),i.Ub()),2&e&&(i.Db(1),i.lc("ngClass",i.qc(1,hy,t.isLarge(),!t.isLarge(),t.assetsLoading)))},directives:[gy,ms.i],styles:[".view-layers-bar[_ngcontent-%COMP%]{display:flex}.view-layers-bar__slider[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;margin-left:4px}.view-layers-bar__slider--large[_ngcontent-%COMP%]{width:300px}.view-layers-bar__slider--small[_ngcontent-%COMP%]{width:180px}.view-layers-bar__slider--disabled[_ngcontent-%COMP%]{opacity:.25;pointer-events:none}"],changeDetection:0}),e})();const my=["viewToolbar"];function fy(e,t){if(1&e&&(i.Vb(0,"app-pillbox",5),i.Qb(1,"app-view-tools",6),i.Ub()),2&e){const e=i.gc(2);i.Db(1),i.lc("collapsePagination",e.collapsePagination)("mode",e.viewToolsMode.Main)}}function yy(e,t){if(1&e&&(i.Vb(0,"div",3),i.Kc(1,fy,2,2,"app-pillbox",4),i.Ub()),2&e){const e=i.gc();i.lc("@inOutAnimation",void 0),i.Db(1),i.lc("ngIf",e.isVisible(e.viewUI.Pagination)||e.isVisible(e.viewUI.Mediabar))}}function xy(e,t){if(1&e){const e=i.Wb();i.Vb(0,"div",3),i.Vb(1,"app-pillbox",7),i.cc("exit",(function(){return i.zc(e),i.gc().handleExitClick()})),i.Qb(2,"app-view-media-bar",8),i.Ub(),i.Ub()}if(2&e){const e=i.gc();i.lc("@inOutAnimation",void 0),i.Db(1),i.lc("canExit",e.canExit),i.Db(1),i.lc("template",e.mediaTemplate)}}function vy(e,t){if(1&e){const e=i.Wb();i.Vb(0,"div",3),i.Vb(1,"app-pillbox",9),i.cc("exit",(function(){return i.zc(e),i.gc().handleExitClick()})),i.Qb(2,"app-view-tools",10),i.Ub(),i.Ub()}if(2&e){const e=i.gc();i.lc("@inOutAnimation",void 0),i.Db(1),i.lc("canExit",e.canExit),i.Db(1),i.lc("mode",e.viewToolsMode.Tools)}}function wy(e,t){if(1&e){const e=i.Wb();i.Vb(0,"div",3),i.Vb(1,"app-pillbox",11),i.cc("exit",(function(){return i.zc(e),i.gc().handleExitClick()})),i.Qb(2,"app-view-layers-bar"),i.Ub(),i.Ub()}if(2&e){const e=i.gc();i.lc("@inOutAnimation",void 0),i.Db(1),i.lc("canExit",e.canExit)}}let Oy=(()=>{class e{constructor(e,t,n,i,o){this.store=e,this.changeDetectorRef=t,this.layoutService=n,this.viewService=i,this.viewUIService=o,this.viewUI=Cl,this.canExit=!0,this.mode=gg.Main,this.lockMode=!1,this.position="center",this.ngUnsubscribe=new $.a,this.breakpoint=fl,this.viewToolsMode=gg,this.viewLayout=Cl,this.collapsePagination=!1}ngOnInit(){this.initLayoutListener(),this.initBreakpointListener()}initLayoutListener(){this.store.select(il.getUI).pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.lockMode||(this.mode=gg.Main,this.layoutService.isUIVisible(Cl.Media)&&(this.mediaTemplate=e.media.template,this.mode=gg.Media),this.layoutService.isToolsVisible()&&(this.mode=gg.Tools),this.layoutService.isVisibilityLayersVisible()&&this.layoutService.isUIVisible(Cl.VisibilityLayers)&&(this.mode=gg.VisibilityLayers),this.changeDetectorRef.markForCheck())})}initBreakpointListener(){this.store.select(Ol.getBreakpoint).pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.collapsePagination=e<fl.Small,this.changeDetectorRef.markForCheck()})}isVisible(e){return this.viewUIService.isVisible(e)}handleExitClick(){const e=this.store.selectSnapshot(il.getUI);e.media.status=oa.Hide,e.tools.status=oa.Hide,e.visibilityLayers.status=oa.Hide,this.viewService.selectTool(Go.Select),this.store.dispatch(new Q.SetUI(e))}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.g),i.Pb(i.i),i.Pb(Ml),i.Pb(Ip),i.Pb(Ml))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-toolbar"]],viewQuery:function(e,t){if(1&e&&i.Rc(my,!0),2&e){let e;i.uc(e=i.dc())&&(t.viewToolbar=e.first)}},inputs:{canExit:"canExit",mode:"mode",lockMode:"lockMode",position:"position"},decls:5,vars:4,consts:[["data-test","view-toolbar",3,"ngSwitch"],["class","view-toolbar",4,"ngSwitchDefault"],["class","view-toolbar",4,"ngSwitchCase"],[1,"view-toolbar"],["eventCategory","View Primary Toolbar","name","Primary Toolbar",4,"ngIf"],["eventCategory","View Primary Toolbar","name","Primary Toolbar"],[3,"collapsePagination","mode"],["eventCategory","View Media Bar","name","Media Bar",3,"canExit","exit"],[3,"template"],["eventCategory","View Explore Tools","name","Explore Tools",3,"canExit","exit"],[3,"mode"],["name","Visibility Layers",3,"canExit","exit"]],template:function(e,t){1&e&&(i.Tb(0,0),i.Kc(1,yy,2,2,"div",1),i.Kc(2,xy,3,3,"div",2),i.Kc(3,vy,3,3,"div",2),i.Kc(4,wy,3,2,"div",2),i.Sb()),2&e&&(i.lc("ngSwitch",t.mode),i.Db(2),i.lc("ngSwitchCase",t.viewToolsMode.Media),i.Db(1),i.lc("ngSwitchCase",t.viewToolsMode.Tools),i.Db(1),i.lc("ngSwitchCase",t.viewToolsMode.VisibilityLayers))},directives:[ms.n,ms.p,ms.o,ms.l,Cf,sy,$f,by],styles:[".view-toolbar{position:absolute;display:inline-block;z-index:20;bottom:0;right:0}"],encapsulation:2,data:{animation:[Object(ol.n)("inOutAnimation",[Object(ol.m)(":enter",[Object(ol.l)({opacity:0,transform:"translateY(200px)"}),Object(ol.e)("300ms ease-in-out",Object(ol.l)({opacity:1,transform:"*"}))]),Object(ol.m)(":leave",[Object(ol.e)("300ms ease-in-out",Object(ol.l)({transform:"translateY(200px)",opacity:0}))])])]},changeDetection:0}),e})();var Cy=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},Sy=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function ky(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",16),i.cc("click",(function(){return i.zc(e),i.gc().handleSearchClick()})),i.Qb(1,"app-icon",17),i.Vb(2,"span",18),i.Mc(3,"Search"),i.Ub(),i.Ub()}}function _y(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",19),i.cc("click",(function(){return i.zc(e),i.gc().toggleToolbar("visibilityLayers")})),i.Qb(1,"app-icon",20),i.Vb(2,"span",18),i.Mc(3,"Layers"),i.Ub(),i.Ub()}}function jy(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",21),i.cc("click",(function(){return i.zc(e),i.gc().toggleToolbar("tools")})),i.Qb(1,"app-icon",22),i.Vb(2,"span",18),i.Mc(3,"Explore"),i.Ub(),i.Ub()}}function Py(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",23),i.cc("click",(function(){return i.zc(e),i.gc().handleDrawClick()})),i.hc(1,"async"),i.Qb(2,"app-icon",24),i.Vb(3,"span",18),i.Mc(4,"Draw"),i.Ub(),i.Ub()}if(2&e){const e=i.gc();let t=null;i.lc("disabled",!(null!=(t=i.ic(1,1,e.selectedChapterReady$))&&t.model))}}function My(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",25),i.cc("click",(function(){return i.zc(e),i.gc().handleTakeQuizClick()})),i.hc(1,"async"),i.hc(2,"async"),i.Qb(3,"app-icon",26),i.Vb(4,"span",18),i.Mc(5,"Take Quiz"),i.Ub(),i.Ub()}if(2&e){const e=i.gc();let t=null;i.lc("disabled",!(null!=(t=i.ic(1,1,e.selectedChapterReady$))&&t.model)||i.ic(2,3,e.quizActive$))}}function Iy(e,t){1&e&&(i.Tb(0),i.Mc(1,"Exit Fullscreen"),i.Sb())}function zy(e,t){1&e&&(i.Tb(0),i.Mc(1,"Enter Fullscreen"),i.Sb())}function Ty(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",19),i.cc("click",(function(){return i.zc(e),i.gc(2).handleFullscreenClick()})),i.Kc(1,Iy,2,0,"ng-container",8),i.Kc(2,zy,2,0,"ng-container",8),i.Ub()}if(2&e){const e=i.gc(2);i.Db(1),i.lc("ngIf",e.isFullscreen),i.Db(1),i.lc("ngIf",!e.isFullscreen)}}function Uy(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",19),i.cc("click",(function(){return i.zc(e),i.gc(3).handleNewTabClick()})),i.Mc(1," Open in New Tab "),i.Ub()}}function Ly(e,t){if(1&e&&(i.Tb(0),i.Kc(1,Uy,2,0,"button",4),i.Sb()),2&e){const e=i.gc(2);i.Db(1),i.lc("ngIf",!e.canFullscreen)}}function Dy(e,t){if(1&e&&(i.Tb(0),i.Qb(1,"mat-divider"),i.Kc(2,Ty,3,2,"button",4),i.Kc(3,Ly,2,1,"ng-container",27),i.Sb()),2&e){const e=i.gc();i.Db(2),i.lc("ngIf",e.canFullscreen),i.Db(1),i.lc("appFlagApplication",e.application.All)("appFlagApplicationMode","exclude")("appFlagApplicationNative",e.nativePlatform.All)}}function Ey(e,t){1&e&&(i.Vb(0,"span",31),i.Mc(1,"(On)"),i.Ub())}function Fy(e,t){1&e&&(i.Vb(0,"span",31),i.Mc(1,"(Off)"),i.Ub())}function Ay(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",28),i.cc("click",(function(){return i.zc(e),i.gc().handleToggleLabelsClick()})),i.Vb(1,"span",29),i.Mc(2,"Toggle Labels"),i.Ub(),i.Kc(3,Ey,2,0,"span",30),i.hc(4,"async"),i.Kc(5,Fy,2,0,"span",30),i.hc(6,"async"),i.Ub()}if(2&e){const e=i.gc();i.Db(3),i.lc("ngIf",i.ic(4,2,e.showLabels$)),i.Db(2),i.lc("ngIf",!i.ic(6,4,e.showLabels$))}}function Ry(e,t){if(1&e&&(i.Vb(0,"button",32),i.Mc(1," Help "),i.Ub()),2&e){i.gc();const e=i.vc(16);i.lc("matMenuTriggerFor",e)}}let Ny=(()=>{class e{constructor(e,t,n,i,s,r){this.viewUIService=e,this.viewService=t,this.quizService=n,this.engineService=i,this.changeDetectorRef=s,this.store=r,this.application=o,this.nativePlatform=oc,this.viewUI=Cl,this.isFullscreen=!1,this.canFullscreen=!1,this.ngUnsubscribe=new $.a,this.visibilityLayersVisible=!1}ngOnInit(){this.canFullscreen=la.canFullscreen(),this.initFullscreenListener(),this.initLayoutListener()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initFullscreenListener(){this.fullscreen$=la.onFullscreenChange(),this.fullscreen$.pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.isFullscreen=la.isFullscreen(),this.changeDetectorRef.markForCheck()})}initLayoutListener(){this.store.select(il.getUI).pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(()=>{this.visibilityLayersVisible=this.viewUIService.isVisible(Cl.VisibilityLayers),this.changeDetectorRef.markForCheck()})}handleToggleLabelsClick(){this.viewService.toggleLabels()}handleFullscreenClick(){la.toggleFullscreen()}handleTutorialClick(){this.viewService.toggleTutorial(!0)}handleTakeQuizClick(){this.quizService.startQuiz()}handleHelpBasicsClick(){this.viewService.toggleHelp(!0,G.Basics)}handleHelpShortcutsClick(){this.viewService.toggleHelp(!0,G.Shortcuts)}handlePresentClick(){this.viewService.togglePresentation()}handleNewTabClick(){this.viewService.openInNewTab()}handleSearchClick(){this.viewService.toggleSearch()}handleDrawClick(){this.viewService.toggleWhiteboard(!0)}toggleToolbar(e){this.viewService.toggleToolbar(e)}isEnabled(e){return this.viewUIService.isUIEnabled(e)}isVisible(e){return this.viewUIService.isVisible(e)}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(Ml),i.Pb(Ip),i.Pb(hg),i.Pb(lt),i.Pb(i.i),i.Pb(d.g))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-menu"]],decls:24,vars:19,consts:[["gaEvent","","gaAction","Clicked View Menu","data-test","viewMenu","matTooltip","Menu","app-pin-button","","buttonType","secondary","icon","bars","aria-label","View Menu",2,"width","52px","height","52px",3,"matMenuTriggerFor","fill"],["gaCategory","View Menu",1,"view-menu"],["viewMenu","matMenu"],["gaEvent","","gaAction","Clicked Open Search","mat-menu-item","","data-test","viewSearchButton",3,"click",4,"ngIf"],["mat-menu-item","",3,"click",4,"ngIf"],["gaEvent","","gaAction","Clicked Open Explore Tools","mat-menu-item","","data-test","viewToolsButton",3,"click",4,"ngIf"],["gaEvent","","gaAction","Clicked Open Whiteboard","mat-menu-item","","data-test","viewDrawButton",3,"disabled","click",4,"ngIf"],["mat-menu-item","","data-test","viewQuizButton",3,"disabled","click",4,"ngIf"],[4,"ngIf"],["mat-menu-item","","data-test","viewToggleLabels",3,"click",4,"ngIf"],["mat-menu-item","",3,"matMenuTriggerFor",4,"ngIf"],["gaCategory","View Menu"],["helpMenu","matMenu"],["gaEvent","","gaAction","Clicked Launch Tutorial","mat-menu-item","",3,"disabled","click"],["gaEvent","","gaAction","Clicked 3d Navigation Basics","mat-menu-item","",3,"click"],["gaEvent","","gaAction","Clicked Keyboard Shortcuts","mat-menu-item","",3,"click"],["gaEvent","","gaAction","Clicked Open Search","mat-menu-item","","data-test","viewSearchButton",3,"click"],["icon","search",1,"view-menu__icon"],[1,"ml-2"],["mat-menu-item","",3,"click"],["icon","layer-group",1,"view-menu__icon"],["gaEvent","","gaAction","Clicked Open Explore Tools","mat-menu-item","","data-test","viewToolsButton",3,"click"],["icon","mouse-pointer",1,"view-menu__icon"],["gaEvent","","gaAction","Clicked Open Whiteboard","mat-menu-item","","data-test","viewDrawButton",3,"disabled","click"],["icon","signature",1,"view-menu__icon"],["mat-menu-item","","data-test","viewQuizButton",3,"disabled","click"],["icon","check",1,"view-menu__icon"],[4,"appFlagApplication","appFlagApplicationMode","appFlagApplicationNative"],["mat-menu-item","","data-test","viewToggleLabels",3,"click"],[1,"mr-3"],["class","text-dim",4,"ngIf"],[1,"text-dim"],["mat-menu-item","",3,"matMenuTriggerFor"]],template:function(e,t){if(1&e&&(i.Qb(0,"button",0),i.Vb(1,"mat-menu",1,2),i.Kc(3,ky,4,0,"button",3),i.Kc(4,_y,4,0,"button",4),i.Kc(5,jy,4,0,"button",5),i.Kc(6,Py,5,3,"button",6),i.Kc(7,My,6,5,"button",7),i.hc(8,"async"),i.hc(9,"async"),i.hc(10,"async"),i.Kc(11,Dy,4,4,"ng-container",8),i.Kc(12,Ay,7,6,"button",9),i.Qb(13,"mat-divider"),i.Kc(14,Ry,2,1,"button",10),i.Ub(),i.Vb(15,"mat-menu",11,12),i.Vb(17,"button",13),i.cc("click",(function(){return t.handleTutorialClick()})),i.hc(18,"async"),i.Mc(19," Launch Tutorial "),i.Ub(),i.Vb(20,"button",14),i.cc("click",(function(){return t.handleHelpBasicsClick()})),i.Mc(21,"3D Navigation Basics"),i.Ub(),i.Vb(22,"button",15),i.cc("click",(function(){return t.handleHelpShortcutsClick()})),i.Mc(23,"Keyboard Shortcuts"),i.Ub(),i.Ub()),2&e){const e=i.vc(2);let n=null;i.lc("matMenuTriggerFor",e)("fill",!0),i.Db(3),i.lc("ngIf",t.isEnabled(t.viewUI.Search)),i.Db(1),i.lc("ngIf",t.visibilityLayersVisible),i.Db(1),i.lc("ngIf",t.isEnabled(t.viewUI.Tools)),i.Db(1),i.lc("ngIf",t.isEnabled(t.viewUI.Whiteboard)),i.Db(1),i.lc("ngIf",i.ic(8,11,t.hasQuiz$)&&i.ic(9,13,t.quizEnabled$)&&!i.ic(10,15,t.quizLocked$)),i.Db(4),i.lc("ngIf",t.isEnabled(t.viewUI.Fullscreen)),i.Db(1),i.lc("ngIf",t.isEnabled(t.viewUI.ToggleLabels)),i.Db(2),i.lc("ngIf",t.isEnabled(t.viewUI.Help)),i.Db(3),i.lc("disabled",!(null!=(n=i.ic(18,17,t.selectedChapterReady$))&&n.model))}},directives:[Ad,J.b,Rd.c,ic.d,ic.a,J.a,ms.l,rc.a,ic.b,$a,sc],pipes:[ms.b],styles:[".view-menu__icon[_ngcontent-%COMP%]{display:inline-flex;justify-content:center;width:16px}"],changeDetection:0}),Cy([Object(d.d)(Bo.getSelectedChapterReadyState),Sy("design:type",q.a)],e.prototype,"selectedChapterReady$",void 0),Cy([Object(d.d)(Bi.hasQuiz),Sy("design:type",q.a)],e.prototype,"hasQuiz$",void 0),Cy([Object(d.d)(Bi.getQuizEnabled),Sy("design:type",q.a)],e.prototype,"quizEnabled$",void 0),Cy([Object(d.d)(Bi.getQuizModeLocked),Sy("design:type",q.a)],e.prototype,"quizLocked$",void 0),Cy([Object(d.d)(Bi.getQuizModeActive),Sy("design:type",q.a)],e.prototype,"quizActive$",void 0),Cy([Object(d.d)(is.getShowLabels),Sy("design:type",q.a)],e.prototype,"showLabels$",void 0),e})();var Vy=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},Hy=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function By(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",8),i.cc("touchstart",(function(){return i.zc(e),i.gc(2).setZoom("out")}))("mousedown",(function(){return i.zc(e),i.gc(2).setZoom("out")}))("touchend",(function(){return i.zc(e),i.gc(2).setZoom("")}))("mouseup",(function(){return i.zc(e),i.gc(2).setZoom("")}))("mouseleave",(function(){return i.zc(e),i.gc(2).setZoom("")}))("keyup.enter",(function(){return i.zc(e),i.gc(2).setZoomFixed("out")})),i.Ub()}}function Qy(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",9),i.cc("touchstart",(function(){return i.zc(e),i.gc(2).setZoom("in")}))("mousedown",(function(){return i.zc(e),i.gc(2).setZoom("in")}))("touchend",(function(){return i.zc(e),i.gc(2).setZoom("")}))("mouseup",(function(){return i.zc(e),i.gc(2).setZoom("")}))("mouseleave",(function(){return i.zc(e),i.gc(2).setZoom("")}))("keyup.enter",(function(){return i.zc(e),i.gc(2).setZoomFixed("in")})),i.Ub()}}function $y(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",10),i.cc("click",(function(){return i.zc(e),i.gc(2).returnToChapterCamera()})),i.Ub()}}function qy(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",11),i.cc("click",(function(){return i.zc(e),i.gc(2).togglePan()})),i.hc(1,"async"),i.hc(2,"async"),i.hc(3,"async"),i.hc(4,"async"),i.Ub()}if(2&e){const e=i.gc(2);i.lc("gaLabel","pan"===i.ic(1,4,e.panMode$)?"Rotate":"Pan")("selected","pan"===i.ic(2,6,e.panMode$))("matTooltip","pan"===i.ic(4,10,e.panMode$)?"Switch to Rotate Mode":"Switch to Pan Mode"),i.Eb("aria-label","pan"===i.ic(3,8,e.panMode$)?"Switch to Rotate Mode":"Switch to Pan Mode")}}function Wy(e,t){if(1&e&&(i.Vb(0,"app-pillbox",2),i.Vb(1,"div",3),i.Kc(2,By,1,0,"button",4),i.Kc(3,Qy,1,0,"button",5),i.Kc(4,$y,1,0,"button",6),i.Kc(5,qy,5,12,"button",7),i.Ub(),i.Ub()),2&e){const e=i.gc();i.Db(2),i.lc("ngIf",e.showZoom),i.Db(1),i.lc("ngIf",e.showZoom),i.Db(1),i.lc("ngIf",e.showResetPosition),i.Db(1),i.lc("ngIf",e.showPan)}}let Ky=(()=>{class e{constructor(e,t){this.store=e,this.cameraService=t,this.showNav=!0,this.showZoom=!0,this.showPan=!0,this.showResetPosition=!0,this.viewLayout=Cl,this.toolEnum=Go,this.expandNav=!1,this.breakpointEnum=fl,this.padding="none",this.ngUnsubscribe=new $.a}ngOnInit(){}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}setZoom(e){let t=""===e?0:8;t="in"===e?-t:t,this.store.dispatch(new xt(t))}setZoomFixed(e){this.cameraService.setCameraZoomWithVelocity("in"===e?-8:8)}returnToChapterCamera(){const e=this.store.selectSnapshot(Bo.getSelectedChapter);this.store.dispatch(new bt(e.camera.location))}resetChapter(){this.returnToChapterCamera();const e=this.store.selectSnapshot(Bo.getSelectedChapterId);this.store.dispatch(new qn.UndoAll(e)),this.store.dispatch(new $n.UpdateNodesChecked(!1)),this.store.dispatch(new so)}centerCamera(){this.store.dispatch(new ye)}togglePan(){const e="pan"===this.store.selectSnapshot(Ko.getPanMode)?"rotate":"pan";this.store.dispatch(new jt(e))}toggleNav(){this.expandNav=!this.expandNav}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.g),i.Pb(Lt))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-engine-camera-bar"]],inputs:{showNav:"showNav",showZoom:"showZoom",showPan:"showPan",showResetPosition:"showResetPosition"},decls:2,vars:1,consts:[["gaCategory","Engine 3D Controls","data-test","cameraBar",1,"camera-bar"],["eventCategory","Engine 3D Controls","orientation","vertical",4,"ngIf"],["eventCategory","Engine 3D Controls","orientation","vertical"],[1,"camera-bar__nav"],["gaEvent","","gaAction","Clicked Zoom Out","app-pin-button","","buttonType","ghost","icon","minus","tabIndex","0","data-test","cameraZoomOut","aria-label","Zoom Out","matTooltip","Zoom Out","matTooltipPosition","left",3,"touchstart","mousedown","touchend","mouseup","mouseleave","keyup.enter",4,"ngIf"],["gaEvent","","gaAction","Clicked Zoom In","app-pin-button","","buttonType","ghost","icon","plus","tabIndex","0","data-test","cameraZoomIn","aria-label","Zoom In","matTooltip","Zoom In","matTooltipPosition","left",3,"touchstart","mousedown","touchend","mouseup","mouseleave","keyup.enter",4,"ngIf"],["gaEvent","","gaAction","Clicked Recenter 3D Model","app-pin-button","","icon","location","buttonType","ghost","tabIndex","0","aria-label","Recenter 3D model","matTooltip","Recenter 3D model","matTooltipPosition","left","data-test","cameraReset",3,"click",4,"ngIf"],["gaEvent","","gaAction","Clicked Switch Mode","app-pin-button","","tabIndex","0","icon","arrows-alt","buttonType","ghost","matTooltipPosition","left","data-test","cameraPan",3,"gaLabel","selected","matTooltip","click",4,"ngIf"],["gaEvent","","gaAction","Clicked Zoom Out","app-pin-button","","buttonType","ghost","icon","minus","tabIndex","0","data-test","cameraZoomOut","aria-label","Zoom Out","matTooltip","Zoom Out","matTooltipPosition","left",3,"touchstart","mousedown","touchend","mouseup","mouseleave","keyup.enter"],["gaEvent","","gaAction","Clicked Zoom In","app-pin-button","","buttonType","ghost","icon","plus","tabIndex","0","data-test","cameraZoomIn","aria-label","Zoom In","matTooltip","Zoom In","matTooltipPosition","left",3,"touchstart","mousedown","touchend","mouseup","mouseleave","keyup.enter"],["gaEvent","","gaAction","Clicked Recenter 3D Model","app-pin-button","","icon","location","buttonType","ghost","tabIndex","0","aria-label","Recenter 3D model","matTooltip","Recenter 3D model","matTooltipPosition","left","data-test","cameraReset",3,"click"],["gaEvent","","gaAction","Clicked Switch Mode","app-pin-button","","tabIndex","0","icon","arrows-alt","buttonType","ghost","matTooltipPosition","left","data-test","cameraPan",3,"gaLabel","selected","matTooltip","click"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Kc(1,Wy,6,4,"app-pillbox",1),i.Ub()),2&e&&(i.Db(1),i.lc("ngIf",t.showNav))},directives:[J.a,ms.l,Cf,Ad,J.b,Rd.c],pipes:[ms.b],styles:[":host{position:relative}.camera-bar{display:flex;flex-direction:column;align-items:center}.camera-bar button:not(:first-child){margin-top:4px}.camera-bar__nav{display:flex;flex-direction:column-reverse;overflow:hidden;transition:height .15s ease-in-out;justify-content:space-between}"],encapsulation:2,data:{animation:[Object(ol.n)("expand",[Object(ol.m)(":enter",[Object(ol.j)([Object(ol.l)({height:0}),Object(ol.e)("150ms ease-in-out",Object(ol.l)({height:"*"}))])]),Object(ol.m)(":leave",[Object(ol.j)([Object(ol.e)("150ms ease-in-out",Object(ol.l)({height:"0"}))])])]),Object(ol.n)("show",[Object(ol.m)(":enter",[Object(ol.j)([Object(ol.l)({height:"0"}),Object(ol.e)("125ms ease-in-out",Object(ol.l)({height:"*"}))])]),Object(ol.m)(":leave",[Object(ol.j)([Object(ol.e)("125ms 125ms ease-in-out",Object(ol.l)({height:"0"}))])])])]},changeDetection:0}),Vy([Object(d.d)(Ko.getPanMode),Hy("design:type",q.a)],e.prototype,"panMode$",void 0),Vy([Object(d.d)(Ol.getBreakpoint),Hy("design:type",q.a)],e.prototype,"breakpoint$",void 0),e})();function Gy(e,t){if(1&e&&(i.Vb(0,"kbd",10),i.Mc(1),i.Ub()),2&e){const e=t.$implicit;i.Db(1),i.Nc(e)}}function Zy(e,t){if(1&e&&(i.Vb(0,"tr",6),i.Vb(1,"td",7),i.Mc(2),i.Ub(),i.Vb(3,"td",8),i.Kc(4,Gy,2,1,"kbd",9),i.Ub(),i.Ub()),2&e){const e=t.$implicit;i.Db(2),i.Nc(e.label),i.Db(2),i.lc("ngForOf",e.keys)}}function Jy(e,t){if(1&e&&(i.Vb(0,"div",2),i.Vb(1,"h2",3),i.Mc(2),i.Ub(),i.Vb(3,"table",4),i.Vb(4,"tbody"),i.Kc(5,Zy,5,2,"tr",5),i.Ub(),i.Ub(),i.Ub()),2&e){const e=t.$implicit;i.Db(2),i.Nc(e.label),i.Db(3),i.lc("ngForOf",e.shortcuts)}}var Xy=function(e){return e.Left="\u2190",e.Right="\u2192",e.Up="\u2191",e.Down="\u2193",e.Command="\u2318",e}({});let Yy=(()=>{class e{constructor(){this.shortcutGroups=[{label:"Navigation",shortcuts:[{keys:[",","Pg-Up"],label:"Previous chapter"},{keys:[".","Pg-Down"],label:"Next chapter"},{keys:["/"],label:"Open Search"},{keys:["Ctrl + Enter"],label:"Enter Fullscreen"},{keys:["Ctrl/Cmd + ,"],label:"Toggle Description"}]},{label:"Tools",shortcuts:[{keys:["1"],label:'Use "Select" tool'},{keys:["2"],label:'Use "Hide" tool'},{keys:["3"],label:'Use "Fade" tool'},{keys:["del","backspace"],label:"Hide selected structure"},{keys:["Shift + R"],label:"Reset chapter"},{keys:["Ctrl/Cmd + Z"],label:"Undo"},{keys:["Ctrl/Cmd + Shift + Z","Ctrl/Cmd + Y"],label:"Redo"}]},{label:"Pan",shortcuts:[{keys:["W"],label:"Pan up"},{keys:["S"],label:"Pan down"},{keys:["A"],label:"Pan left"},{keys:["D"],label:"Pan right"},{keys:["Shift + W"],label:"Slow pan up"},{keys:["Shift + S"],label:"Slow pan down"},{keys:["Shift + A"],label:"Slow pan left"},{keys:["Shift + D"],label:"Slow pan right"}]},{label:"Rotate",shortcuts:[{keys:[Xy.Up],label:"Rotate up"},{keys:[Xy.Down],label:"Rotate down"},{keys:[Xy.Left],label:"Rotate left"},{keys:[Xy.Right],label:"Rotate right"},{keys:["Shift + "+Xy.Up],label:"Slow rotate up"},{keys:["Shift + "+Xy.Down],label:"Slow rotate down"},{keys:["Shift + "+Xy.Left],label:"Slow rotate left"},{keys:["Shift + "+Xy.Right],label:"Slow rotate right"}]},{label:"Zoom",shortcuts:[{keys:["C","="],label:"Zoom in"},{keys:["E","-"],label:"Zoom out"},{keys:["Shift + C","Shift + ="],label:"Slow zoom in"},{keys:["Shift + E","Shift + -"],label:"Slow zoom out"}]}]}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-shortcuts"]],decls:2,vars:1,consts:[[1,"view-shortcuts"],["class","view-shortcuts__group",4,"ngFor","ngForOf"],[1,"view-shortcuts__group"],[1,"view-shortcuts__label","text-bold"],[1,"view-shortcuts__table"],["class","view-shortcuts__row",4,"ngFor","ngForOf"],[1,"view-shortcuts__row"],[1,"view-shortcuts__cell","view-shortcuts__cell--label"],[1,"view-shortcuts__cell","view-shortcuts__cell--key"],["class","view-shortcuts__key",4,"ngFor","ngForOf"],[1,"view-shortcuts__key"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Kc(1,Jy,6,2,"div",1),i.Ub()),2&e&&(i.Db(1),i.lc("ngForOf",t.shortcutGroups))},directives:[ms.k],styles:[".view-shortcuts[_ngcontent-%COMP%]{display:flex;flex-direction:column}.view-shortcuts__group[_ngcontent-%COMP%]{width:100%;padding-bottom:32px;margin-top:32px}.view-shortcuts__label[_ngcontent-%COMP%]{padding:8px 0 12px}.view-shortcuts__table[_ngcontent-%COMP%]{width:100%}.view-shortcuts__cell[_ngcontent-%COMP%]{padding:8px;border-bottom:1px solid hsla(0,0%,100%,.3);width:50%}.view-shortcuts__key[_ngcontent-%COMP%]{border-radius:4px;display:inline-flex;padding:4px;margin-right:4px;background:#000;color:#fff;justify-content:center;align-items:center;font-family:monospace;font-size:16px}"],changeDetection:0}),e})();var ex=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const tx=["viewHelp"];function nx(e,t){1&e&&(i.Tb(0),i.Vb(1,"div",10),i.Vb(2,"div",11),i.Qb(3,"div",12),i.Vb(4,"div",13),i.Mc(5,"Rotate"),i.Ub(),i.Mc(6," Click and drag or use one finger to change the viewing angle. "),i.Ub(),i.Vb(7,"div",11),i.Qb(8,"div",12),i.Vb(9,"div",13),i.Mc(10,"Pan"),i.Ub(),i.Mc(11," Hold the shift key and drag or use two fingers to move the model's position. "),i.Ub(),i.Vb(12,"div",11),i.Qb(13,"div",12),i.Vb(14,"div",13),i.Mc(15,"Zoom"),i.Ub(),i.Mc(16," Scroll up and down or pinch with two fingers to zoom in or out. "),i.Ub(),i.Vb(17,"div",11),i.Qb(18,"div",12),i.Vb(19,"div",13),i.Mc(20,"Explore the Anatomy"),i.Ub(),i.Mc(21," Click or tap an anatomic structure or label to learn more. "),i.Ub(),i.Ub(),i.Sb()),2&e&&(i.Db(3),i.Hc("background-image","url(assets/images/widget/help-rotate.svg)"),i.Db(5),i.Hc("background-image","url(assets/images/widget/help-pan.svg)"),i.Db(5),i.Hc("background-image","url(assets/images/widget/help-zoom.svg)"),i.Db(5),i.Hc("background-image","url(assets/images/widget/help-learn.svg)"))}function ix(e,t){1&e&&(i.Tb(0),i.Vb(1,"div",14),i.Mc(2," Mouse "),i.Ub(),i.Vb(3,"div",10),i.Vb(4,"div",11),i.Qb(5,"div",12),i.Mc(6," Hold left button to rotate "),i.Ub(),i.Vb(7,"div",11),i.Qb(8,"div",12),i.Mc(9," Hold right button to pan "),i.Ub(),i.Vb(10,"div",11),i.Qb(11,"div",12),i.Mc(12," Single-click left button to select a structure "),i.Ub(),i.Vb(13,"div",11),i.Qb(14,"div",12),i.Mc(15," Double-click left button to auto-focus on a structure "),i.Ub(),i.Vb(16,"div",11),i.Qb(17,"div",12),i.Mc(18," Long-click to fly to a structure "),i.Ub(),i.Ub(),i.Vb(19,"div",14),i.Mc(20," Keyboard "),i.Ub(),i.Vb(21,"div",10),i.Vb(22,"div",11),i.Qb(23,"div",12),i.Mc(24," Rotate with arrows "),i.Ub(),i.Vb(25,"div",11),i.Qb(26,"div",12),i.Mc(27," Pan up (W), left (A), down (S), right(D) "),i.Ub(),i.Vb(28,"div",11),i.Qb(29,"div",12),i.Mc(30," Zoom out (-, C) and zoom in (+, E) "),i.Ub(),i.Vb(31,"div",11),i.Qb(32,"div",12),i.Mc(33," Hold with any previous key to slow down motion "),i.Ub(),i.Ub(),i.Vb(34,"div",14),i.Mc(35," Trackpad "),i.Ub(),i.Vb(36,"div",10),i.Vb(37,"div",11),i.Qb(38,"div",12),i.Mc(39," Single-tap to auto-focus a structure "),i.Ub(),i.Vb(40,"div",11),i.Qb(41,"div",12),i.Mc(42," Double-tap to select a structure "),i.Ub(),i.Vb(43,"div",11),i.Qb(44,"div",12),i.Mc(45," Long-press to fly to a structure "),i.Ub(),i.Vb(46,"div",11),i.Qb(47,"div",12),i.Mc(48," Scroll up and down to zoom "),i.Ub(),i.Ub(),i.Vb(49,"div",14),i.Mc(50," In-App "),i.Ub(),i.Vb(51,"div",10),i.Vb(52,"div",11),i.Qb(53,"app-icon",15),i.Mc(54," Zoom in "),i.Ub(),i.Vb(55,"div",11),i.Qb(56,"app-icon",16),i.Mc(57," Zoom out "),i.Ub(),i.Vb(58,"div",11),i.Qb(59,"app-icon",17),i.Mc(60," Recenter 3D model "),i.Ub(),i.Vb(61,"div",11),i.Qb(62,"app-icon",18),i.Mc(63," Pan "),i.Ub(),i.Ub(),i.Sb()),2&e&&(i.Db(5),i.Hc("background-image","url(assets/images/widget/help-mouse-hold-left.svg)"),i.Db(3),i.Hc("background-image","url(assets/images/widget/help-mouse-hold-right.svg)"),i.Db(3),i.Hc("background-image","url(assets/images/widget/help-mouse-single-click-left.svg)"),i.Db(3),i.Hc("background-image","url(assets/images/widget/help-mouse-double-click-left.svg)"),i.Db(3),i.Hc("background-image","url(assets/images/widget/help-mouse-long-press-left.svg)"),i.Db(6),i.Hc("background-image","url(assets/images/widget/help-keyboard-rotate.svg)"),i.Db(3),i.Hc("background-image","url(assets/images/widget/help-keyboard-pan.svg)"),i.Db(3),i.Hc("background-image","url(assets/images/widget/help-keyboard-zoom.svg)"),i.Db(3),i.Hc("background-image","url(assets/images/widget/help-keyboard-slow-motion.svg)"),i.Db(6),i.Hc("background-image","url(assets/images/widget/help-trackpad-single-tap.svg)"),i.Db(3),i.Hc("background-image","url(assets/images/widget/help-trackpad-double-tap.svg)"),i.Db(3),i.Hc("background-image","url(assets/images/widget/help-trackpad-long-press.svg)"),i.Db(3),i.Hc("background-image","url(assets/images/widget/help-trackpad-scroll.svg)"))}function ox(e,t){1&e&&(i.Tb(0),i.Qb(1,"app-view-shortcuts"),i.Sb())}const sx=function(e){return{"view-help__tab--active":e}};let rx=(()=>{class e{constructor(e,t){this.renderer=e,this.viewService=t,this.helpTypeEnum=G,this.activeTab=G.Basics,this.ngUnsubscribe=new $.a}ngOnInit(){this.initWindowSizeObserver()}ngAfterViewInit(){this.updateViewHeight()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initWindowSizeObserver(){this.renderer.listen("window","resize",()=>{this.updateViewHeight()})}updateViewHeight(){const e=this.viewService.getVH(!1);this.viewHelp.nativeElement.style.setProperty("--vh",e+"px")}handleCloseClick(){this.viewService.toggleHelp(!1)}handleTabClick(e){this.activeTab=e}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(i.H),i.Pb(Ip))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-help"]],viewQuery:function(e,t){if(1&e&&i.Gc(tx,!0),2&e){let e;i.uc(e=i.dc())&&(t.viewHelp=e.first)}},inputs:{activeTab:"activeTab"},decls:15,vars:13,consts:[["gaCategory","View Help",1,"view-help"],["viewHelp",""],[1,"view-help__inner",3,"ngSwitch"],["gaEvent","","gaAction","Clicked Close Help",1,"view-help__close",3,"click"],["icon","times"],[1,"view-help__tabs"],["gaEvent","","gaAction","Clicked Navigation Basics","role","button",1,"view-help__tab",3,"ngClass","click"],["gaEvent","","gaAction","Clicked All Controls","role","button",1,"view-help__tab",3,"ngClass","click"],["gaEvent","","gaAction","Clicked Keyboard Shortcuts","role","button",1,"view-help__tab",3,"ngClass","click"],[4,"ngSwitchCase"],[1,"view-help__group"],[1,"view-help__item"],[1,"view-help__image"],[1,"view-help__label"],[1,"view-help__header"],["icon","plus",1,"view-help__icon"],["icon","minus",1,"view-help__icon"],["icon","location",1,"view-help__icon"],["icon","arrows",1,"view-help__icon"]],template:function(e,t){1&e&&(i.Vb(0,"div",0,1),i.Vb(2,"div",2),i.Vb(3,"div",3),i.cc("click",(function(){return t.handleCloseClick()})),i.Qb(4,"app-icon",4),i.Ub(),i.Vb(5,"div",5),i.Vb(6,"div",6),i.cc("click",(function(){return t.handleTabClick(t.helpTypeEnum.Basics)})),i.Mc(7," Navigation Basics "),i.Ub(),i.Vb(8,"div",7),i.cc("click",(function(){return t.handleTabClick(t.helpTypeEnum.All)})),i.Mc(9," All Controls "),i.Ub(),i.Vb(10,"div",8),i.cc("click",(function(){return t.handleTabClick(t.helpTypeEnum.Shortcuts)})),i.Mc(11," Keyboard Shortcuts "),i.Ub(),i.Ub(),i.Kc(12,nx,22,8,"ng-container",9),i.Kc(13,ix,64,26,"ng-container",9),i.Kc(14,ox,2,0,"ng-container",9),i.Ub(),i.Ub()),2&e&&(i.Db(2),i.lc("ngSwitch",t.activeTab),i.Db(4),i.lc("ngClass",i.oc(7,sx,t.activeTab===t.helpTypeEnum.Basics)),i.Db(2),i.lc("ngClass",i.oc(9,sx,t.activeTab===t.helpTypeEnum.All)),i.Db(2),i.lc("ngClass",i.oc(11,sx,t.activeTab===t.helpTypeEnum.Shortcuts)),i.Db(2),i.lc("ngSwitchCase",t.helpTypeEnum.Basics),i.Db(1),i.lc("ngSwitchCase",t.helpTypeEnum.All),i.Db(1),i.lc("ngSwitchCase",t.helpTypeEnum.Shortcuts))},directives:[J.a,ms.n,J.b,$a,ms.i,ms.o,Yy],styles:['.text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3838}.text-info{color:#0060c4}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.view-help{background-color:rgba(16,24,35,.9);color:#fff;background-color:var(--view-help-bg);color:var(--view-help-color);display:flex;align-items:center;flex-direction:column;position:fixed;top:0;left:0;right:0;z-index:10000;height:100vh;height:calc(var(--vh, 1vh) * 100);max-height:100vh;overflow:auto}.view-help__inner{width:100%;max-width:1140px;height:99vh;height:calc(var(--vh, 1vh) * 99);padding:32px;position:relative}.view-help__close{width:40px;height:40px;display:flex;align-items:center;justify-content:center;position:fixed;right:8px;top:8px}.view-help__close:hover{cursor:pointer}.view-help__header{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase;border-bottom:1px solid hsla(0,0%,100%,.3);border-bottom:var(--view-help-border);font-weight:600;padding-bottom:12px;margin-top:32px}.view-help__label{font-size:14px;letter-spacing:.35px;line-height:1.4em;font-weight:600;margin-bottom:12px}.view-help__group{display:flex;justify-content:space-around;flex-wrap:wrap}.view-help__item{font-size:12px;letter-spacing:.3px;line-height:1.4em;display:flex;flex-flow:column;text-align:center;padding:20px;flex:0 1 180px}.view-help__image{margin-bottom:16px;width:160px;height:100px;background-position:50%;background-repeat:no-repeat}.view-help__icon{font-size:24px;margin-bottom:16px}.view-help__tabs{display:flex;justify-content:center;align-items:center}.view-help__tab{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase;border-bottom:2px solid transparent;padding:12px;text-align:center}.view-help__tab:after{content:"";display:block;border-bottom:3px solid #2d72dc;border-bottom:var(--view-help-tab-border);margin-top:4px;width:0;transition:.25s ease}.view-help__tab:hover{cursor:pointer}.view-help__tab--active:after{width:100%}'],encapsulation:2,changeDetection:0}),function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);s>3&&r&&Object.defineProperty(t,n,r)}([Object(d.d)(il.getCanTouch),ex("design:type",q.a)],e.prototype,"canTouch$",void 0),e})();var ax=n("un/a");class cx{}var lx=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let px=(()=>{class e{constructor(){this.type=s.Bookmark,this.favorite=!1,this.unavailable=!1}}return function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);s>3&&r&&Object.defineProperty(t,n,r)}([Object(I.Type)(()=>cx),lx("design:type",Array)],e.prototype,"group_access",void 0),e})();var dx=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let ux=(()=>{class e{}return function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);s>3&&r&&Object.defineProperty(t,n,r)}([Object(I.Type)(()=>yr),dx("design:type",String)],e.prototype,"objectId",void 0),e})();class gx{}var hx=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let bx=(()=>{class e{}return function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);s>3&&r&&Object.defineProperty(t,n,r)}([Object(I.Type)(()=>ux),Object(I.Type)(()=>nt),Object(I.Type)(()=>gx),hx("design:type",String)],e.prototype,"moduleId",void 0),e})();const mx={main:[{title:"All Models",id:"all",type:"Category",translations:{es:{title:"Todas las Categor\xedas"},zh:{title:"\u6240\u6709\u7c7b\u522b"},fr:{title:"Toutes les cat\xe9gories"},de:{title:"Alle Kategorien"},it:{title:"Tutte le categorie"},ja:{title:"\u3059\u3079\u3066\u306e\u30ab\u30c6\u30b4\u30ea"},pt:{title:"Todas as categorias"}}}],categories:[{title:"Anatomy by Regions",id:"regional",type:"Category",translations:{es:{title:"Anatom\xeda por Regiones"},zh:{title:"\u6309\u5730\u533a\u5212\u5206\u7684\u89e3\u5256\u5b66"},fr:{title:"Anatomie par r\xe9gions"},de:{title:"Anatomie nach Regionen"},it:{title:"Anatomia per regioni"},ja:{title:"\u5730\u57df\u5225\u89e3\u5256\u5b66"},pt:{title:"Anatomia por Regi\xf5es"}}},{title:"Anatomy by Systems",id:"system",type:"Category",translations:{es:{title:"Anatom\xeda por Sistemas"},zh:{title:"\u6309\u7cfb\u7edf\u8fdb\u884c\u89e3\u5256\u5b66"},fr:{title:"Anatomie par syst\xe8mes"},de:{title:"Anatomie nach Systemen"},it:{title:"Anatomia per sistemi"},ja:{title:"\u30b7\u30b9\u30c6\u30e0\u306b\u3088\u308b\u89e3\u5256\u5b66"},pt:{title:"Anatomia por Sistemas"}}},{title:"Complete Anatomy",id:"complete anatomy",type:"Category",translations:{de:{title:"Komplette Anatomie"},es:{title:"Anatom\xeda completa"},fr:{title:"Anatomie compl\xe8te"},it:{title:"Anatomia completa"},ja:{title:"\u5b8c\u5168\u306a\u89e3\u5256\u5b66"},pt:{title:"Anatomia Completa"},zh:{title:"\u5b8c\u6574\u89e3\u5256\u5b66"}}},{title:"Cross Sections & Micro Anatomy",id:"Cross Section and Micro Anatomy",type:"Category",translations:{de:{title:"Querschnitte & Mikro-Anatomie"},es:{title:"Secciones transversales y Micro Anatom\xeda"},fr:{title:"Sections transversales et micro anatomie"},it:{title:"Sezioni trasversali & Micro Anatomia"},ja:{title:"\u65ad\u9762\uff06\u30de\u30a4\u30af\u30ed\u89e3\u5256\u5b66"},pt:{title:"Se\xe7\xf5es Transversais e Micro Anatomia"},zh:{title:"\u622a\u9762\u548c\u5fae\u578b\u89e3\u5256\u5b66"}}}],specialties:[{title:"Allergy & Immunology",id:"Allergy and Immunology",type:"Category",translations:{de:{title:"Allergie und Immunologie"},es:{title:"Alergia e Inmunolog\xeda"},fr:{title:"Allergie et Immunologie"},it:{title:"Allergia e Immunologia"},ja:{title:"\u30a2\u30ec\u30eb\u30ae\u30fc\u3068\u514d\u75ab\u5b66"},pt:{title:"Alergia e Imunologia"},zh:{title:"\u8fc7\u654f\u4e0e\u514d\u75ab\u5b66"}}},{title:"Cardiology",id:"Cardiology",type:"Category",translations:{de:{title:"Kardiologie"},es:{title:"Cardiolog\xeda"},fr:{title:"Cardiologie"},it:{title:"Cardiologia"},ja:{title:"\u5fc3\u81d3\u75c5\u5b66"},pt:{title:"Cardiologia"},zh:{title:"\u5fc3\u810f\u75c5\u5b66"}}},{title:"Dentistry",id:"Dentistry",type:"Category",translations:{de:{title:"Zahnmedizin"},es:{title:"Odontolog\xeda"},fr:{title:"Dentisterie"},it:{title:"Odontoiatria"},ja:{title:"\u6b6f\u79d1"},pt:{title:"Odontologia"},zh:{title:"\u7259\u79d1"}}},{title:"Dermatology",id:"Dermatology",type:"Category",translations:{de:{title:"Dermatologie"},es:{title:"Dermatolog\xeda"},fr:{title:"Dermatologie"},it:{title:"Dermatologia"},ja:{title:"\u76ae\u819a\u79d1"},pt:{title:"Dermatologia"},zh:{title:"\u76ae\u80a4\u79d1"}}},{title:"Endocrinology",id:"Endocrinology",type:"Category",translations:{de:{title:"Endokrinologie"},es:{title:"Endocrinolog\xeda"},fr:{title:"Endocrinologie"},it:{title:"Endocrinologia"},ja:{title:"\u5185\u5206\u6ccc\u5185\u79d1"},pt:{title:"Endocrinologia"},zh:{title:"\u5185\u5206\u6ccc\u5b66"}}},{title:"Gastroenterology",id:"Gastroenterology and Hepatology",type:"Category",translations:{de:{title:"Gastroenterologie"},es:{title:"Gastroenterolog\xeda"},fr:{title:"Gastroent\xe9rologie"},it:{title:"Gastroenterologia"},ja:{title:"\u6d88\u5316\u5668\u5185\u79d1"},pt:{title:"Gastroenterologia"},zh:{title:"\u80c3\u80a0\u75c5\u5b66"}}},{title:"Infectious Disease",id:"Infectious Disease",type:"Category",translations:{de:{title:"Infektionskrankheit"},es:{title:"Enfermedades Infecciosas"},fr:{title:"Maladies infectieuses"},it:{title:"Malattie Infettive"},ja:{title:"\u611f\u67d3\u75c7"},pt:{title:"Doen\xe7a Infecciosa"},zh:{title:"\u4f20\u67d3\u75c5"}}},{title:"Nephrology",id:"Nephrology",type:"Category",translations:{de:{title:"Nephrologie"},es:{title:"Nefrolog\xeda"},fr:{title:"N\xe9phrologie"},it:{title:"Nefrologia"},ja:{title:"\u814e\u5b66"},pt:{title:"Nefrologia"},zh:{title:"\u80be\u810f\u75c5\u5b66"}}},{title:"Neurology & Psychiatry",id:"Neurology and Psychiatry",type:"Category",translations:{de:{title:"Neurologie & Psychiatrie"},es:{title:"Neurolog\xeda y Psiquiatr\xeda"},fr:{title:"Neurologie & Psychiatrie"},it:{title:"Neurologia & Psichiatria"},ja:{title:"\u795e\u7d4c\u5185\u79d1\u30fb\u7cbe\u795e\u79d1"},pt:{title:"Neurologia e Psiquiatria"},zh:{title:"\u795e\u7ecf\u5b66\u548c\u7cbe\u795e\u75c5\u5b66"}}},{title:"Obstetrics & Gynecology",id:"Obstetrics and Gynecology",type:"Category",translations:{de:{title:"Geburtshilfe & Gyn\xe4kologie"},es:{title:"Obstetricia y Ginecolog\xeda"},fr:{title:"Obst\xe9trique et gyn\xe9cologie"},it:{title:"Ostetricia & Ginecologia"},ja:{title:"\u7523\u5a66\u4eba\u79d1"},pt:{title:"Obstetr\xedcia e Ginecologia"},zh:{title:"\u5987\u4ea7\u79d1"}}},{title:"Hematology & Oncology",id:"Oncology and Hematology",type:"Category",translations:{de:{title:"H\xe4matologie/Onkologie"},es:{title:"Hematolog\xeda/Oncolog\xeda"},fr:{title:"H\xe9matologie/Oncologie"},it:{title:"Ematologia/Oncologia"},ja:{title:"\u8840\u6db2\u5b66\u30fb\u816b\u760d\u5b66"},pt:{title:"Hematologia/Oncologia"},zh:{title:"\u8840\u6db2\u5b66/\u80bf\u7624\u5b66"}}},{title:"Ophthalmology",id:"Ophthalmology",type:"Category",translations:{de:{title:"Ophthalmologie"},es:{title:"Oftalmolog\xeda"},fr:{title:"Ophtalmologie"},it:{title:"Oftalmologia"},ja:{title:"\u773c\u79d1\u304b"},pt:{title:"Oftalmologia"},zh:{title:"\u773c\u79d1"}}},{title:"Orthopedics",id:"Orthopedics",type:"Category",translations:{de:{title:"Orthop\xe4die"},es:{title:"Ortopedia"},fr:{title:"Orthop\xe9die"},it:{title:"Ortopedia"},ja:{title:"\u6574\u5f62\u5916\u79d1"},pt:{title:"Ortopedia"},zh:{title:"\u6574\u5f62\u5916\u79d1"}}},{title:"Otolaryngology",id:"Otolaryngology",type:"Category",translations:{de:{title:"HNO-Heilkunde"},es:{title:"Otorrinolaringolog\xeda"},fr:{title:"Otorhinolaryngologie"},it:{title:"Otorinolaringoiatria"},ja:{title:"\u8033\u9f3b\u54bd\u5589\u79d1"},pt:{title:"Otorrinolaringologia"},zh:{title:"\u8033\u9f3b\u5589\u79d1"}}},{title:"Pediatrics",id:"Pediatrics",type:"Category",translations:{de:{title:"P\xe4diatrie"},es:{title:"Pediatr\xeda"},fr:{title:"P\xe9diatrie"},it:{title:"Pediatria"},ja:{title:"\u5c0f\u5150\u79d1"},pt:{title:"Pediatria"},zh:{title:"\u513f\u79d1"}}},{title:"Pulmonology",id:"Pulmonology and Respiratory",type:"Category",translations:{de:{title:"Pulmonologie"},es:{title:"Neumolog\xeda"},fr:{title:"Pneumologie"},it:{title:"Pneumologia"},ja:{title:"\u80ba"},pt:{title:"Pneumologia"},zh:{title:"\u547c\u5438\u5b66"}}},{title:"Rheumatology",id:"Rheumatology",type:"Category",translations:{de:{title:"Rheumatologie"},es:{title:"Reumatolog\xeda"},fr:{title:"Rhumatologie"},it:{title:"Reumatologia"},ja:{title:"\u30ea\u30a6\u30de\u30c1\u79d1"},pt:{title:"Reumatologia"},zh:{title:"\u98ce\u6e7f\u75c5\u5b66"}}},{title:"Urology",id:"Urology",type:"Category",translations:{de:{title:"Urologie"},es:{title:"Urolog\xeda"},fr:{title:"Urologie"},it:{title:"Urologia"},ja:{title:"\u6ccc\u5c3f\u5668\u79d1\u304b"},pt:{title:"Urologia"},zh:{title:"\u6ccc\u5c3f\u5916\u79d1"}}},{title:"Community Bookmarks",id:"public",type:"Community",translations:{de:{title:"Community-Lesezeichen"},es:{title:"Marcadores de la comunidad"},fr:{title:"Signets communautaires"},it:{title:"Segnalibri della community"},ja:{title:"\u30b3\u30df\u30e5\u30cb\u30c6\u30a3\u306e\u30d6\u30c3\u30af\u30de\u30fc\u30af"},pt:{title:"Favoritos da comunidade"},zh:{title:"\u793e\u533a\u4e66\u7b7e"}}}]},fx=["live"];let yx=(()=>{class e{constructor(e){this.http=e}search(e="",t=[],n="en"){const i=e.split(/[ ]+/).join("+"),o=fx.concat(t).filter(e=>""!==e&&null!=e).map(e=>`"${e}"`).join("+");return this.http.get(`/search?k=${i}&t=${o}&ol=${n}&odns=true`).pipe(Object(k.a)(e=>this.resultsToBookmarks(e)))}searchInternal(e="",t=""){return this.http.get(`/ws/search/internal?k=${e}&dir=${t}`).pipe(Object(k.a)(e=>this.resultsToBookmarks(e)))}getAnatomyCategory(e,t,n,i){return this.search(e,[t,...n],i)}getConditionModel(e){const t=this.toDatabaseContentId(e);return this.http.get("/search/conditions?q="+t).pipe(Object(k.a)(e=>this.resultsToBookmarks(e)),Object(k.a)(e=>e[0]))}resultsToBookmarks(e){return e.forEach(e=>{e.id=this.toAppContentId(e.id),e.tour=e.tags.indexOf("tour")>=0}),Object(I.plainToClass)(px,e)}getBookmarkCategory(e){if(!e.tags)return null;const t=mx.categories.map(e=>e.id.toLocaleLowerCase());return e.tags.find(e=>t.includes(e.toLocaleLowerCase()))}getStoryCategory(e){if(!e.tags)return null;const t=[...mx.main,...mx.categories,...mx.specialties].map(e=>e.id.toLocaleLowerCase());return e.tags.find(e=>t.includes(e.toLocaleLowerCase()))}toAppContentId(e){return e.replace("Condition.content.","").replace(".json","").split(".").join("/")}toDatabaseContentId(e){return e.match("Condition.content")?e:`Condition.content.${e.replace(".json","").split("/").join(".")}.json`}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(C.b))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var xx=function(e){return e.UserGeneratedTour="user_generated_tour",e.Animated="animated",e.Quiz="quiz",e}({});const vx={headers:new C.d({"Content-Type":"application/json; charset=utf-8"})};var wx=function(e){return e.Private="private",e.Group="enterprise",e.Public="public",e}({});let Ox=(()=>{class e{constructor(e,t,n,i,o){this.store=e,this.http=t,this.serializeModuleService=n,this.exploreService=i,this.storyService=o}getBookmarkData(e){return this.http.get("/search/bookmarks/data?be="+e).pipe(Object(ax.a)(2),Object(k.a)(e=>((e=e.bookmark).moduleId=e.customData?e.customData.moduleId:e.modules.activeModules[0],Object(I.plainToClass)(bx,e))))}getBookmarkModel(e){return this.http.get("/ws/search/bookmarks?eid="+e).pipe(Object(ax.a)(2),Object(k.a)(e=>Object(I.plainToClass)(px,e.bookmark_info)),Object(k.a)(e=>this.normalizeBookmarkModel(e)))}getUserBookmarks(e,t=""){return this.http.get(`/ws/search/bookmarks/${e}?q=${t}`).pipe(Object(ax.a)(2),Object(k.a)(e=>e.map(e=>Object(I.plainToClass)(px,e)).map(e=>this.normalizeBookmarkModel(e))))}getUserConditions(e,t="",n){let i="";switch(e){case wx.Private:i="user";break;case wx.Group:i="group"}return this.http.get("/ws/search/conditions/private?q="+t).pipe(Object(k.a)(e=>e.filter(e=>e.module_accessor_level===i&&(!n||e.module_accessor_id===n))),Object(k.a)(e=>Object(I.plainToClass)(px,e)),Object(k.a)(e=>e.map(e=>this.normalizeBookmarkModel(e))))}getPrivateBookmarks(e=""){return this.getUserBookmarks(wx.Private,e).pipe(Object(k.a)(e=>e.filter(e=>e.is_owner)))}getFavorites(){return this.http.get("/ws/user/favorite").pipe(Object(k.a)(e=>Object.values(e).map(e=>Object(I.plainToClass)(px,e)).map(e=>this.normalizeBookmarkModel(e))))}deleteFavorite(e,t){return this.http.delete(`/ws/user/favorite?modelId=${e}&category=${t}`)}getPrivateConditions(e=""){return this.getUserConditions(wx.Private)}getOrganizationBookmarks(e,t=""){return this.getUserBookmarks(wx.Private,t).pipe(Object(k.a)(t=>t.filter(e=>e.tags.includes("enterprise")).filter(t=>t.group_access.some(t=>t.group_id===e))))}getOrganizationConditions(e,t=""){return this.getUserConditions(wx.Group,t,e)}getOrganizationContent(e,t=""){return Object(Xs.a)(this.getOrganizationBookmarks(e,t),this.getOrganizationConditions(e,t)).pipe(Object(k.a)(([e,t])=>[...e,...t]))}createBookmarkStory(e){return this.serializeModuleService.serialize({},new Lr,!1,this.store.selectSnapshot(Qr.getStory),this.store.selectSnapshot(Bo.getStoryChapters),e)}getPublicBookmarks(e=""){return this.getUserBookmarks(wx.Public,e)}saveBookmark(e){const t=this.getNormalizedBookmarkEntry(e);let n;return n=this.http.post(e.id?"/ws/user/bookmark/v1/update":"/ws/user/bookmark/v1/save",t,vx),n.pipe(Object(Oo.a)(e=>this.getBookmarkModel(e.id)))}deleteBookmark(e){return this.http.delete("/ws/user/bookmark/v1/delete?eid="+e).pipe(Object(_.a)(e=>{const{error:t}=e.error,n=t?t.message:"";return Object(Jo.a)(n)}))}copyBookmark(e,t,n="en"){return t!==s.Module||Object(X.endsWith)(e,".json")||(e+=".json"),this.http.post("/ws/user/bookmark/v1/copy",{source_content_type:t,source_content_id:e}).pipe(Object(k.a)(e=>e.id),Object(Oo.a)(i=>"en"===n?Object(S.a)(i):this.translateBookmark(i,e,t,n)))}atMaxFreeBookmarkCount(){return this.http.get("/ws/user/content/limit/check").pipe(Object(k.a)(()=>!1),Object(_.a)(e=>Object(S.a)(403===e.status)))}saveBookmarkThumbnails(e,t,n,i){const o=t.index.chapters.reduce((t,o)=>{const s=n.get(i[o.id]),r=Object(X.get)(s,"snapshot");if(r)t.push(this.postThumbnail(e,o.id,r,!0));else if(o.id!==i[o.id]||s.chapterId!==o.id){const n=Object(X.get)(s,"urls.large");if(n){const i=n.match(/(bookmarks\/)|(modules\/)/).index,s=n.slice(i);t.push(this.copyThumbnail(e,o.id,s))}}return t},[]),s=n.get(i[t.index.chapters[0].id]),r=Object(X.get)(s,"snapshot");if(r)o.push(this.postThumbnail(e,null,r,!0));else{const t=Object(X.get)(s,"urls.large");t&&o.push(this.copyThumbnail(e,null,t))}return o}deleteBookmarkThumbnails(e,t,n,i){const o=t.index.chapters.map(e=>i[e.id]||e.id);return Array.from(n.values()).filter(e=>o.indexOf(e.chapterId)<0).map(t=>this.deleteThumbnail(e,t.chapterId))}filterByTags(e,t,n=!1){return e.filter(e=>n?t.every(t=>e.tags.includes(t)):t.some(t=>e.tags.includes(t)))}normalizeBookmarkModel(e){const{id:t,type:n}=e;return"module"===n&&(e.id=this.exploreService.toAppContentId(t)),e.tour=e.tags.includes("tour"),e.animated=e.tags.includes("animated"),e}getIndexThumbnail(e,t="large"){return`/thumbs/bookmarks/${e}/${t}/index.jpg`}translateBookmark(e,t,n,i){const o=n===s.Module||n===s.Internal?t.replace(".json",""):t;return Object(Xs.a)(this.storyService.getStory(e,s.Bookmark),this.storyService.getStoryTranslation(o,n,i)).pipe(Object(k.a)(([e,t])=>this.storyService.translateStory(e,t)),Object(Oo.a)(t=>this.saveBookmark({isOwner:!0,title:t.displayName.substr(0,60),id:e,index:t})),Object(k.a)(e=>e.id),Object(_.a)(t=>404===t.status?Object(S.a)(e):Object(Jo.a)(t)))}getNormalizedBookmarkEntry(e){const{id:t,title:n,description:i,index:o,public_access:s,add_group_access:r,remove_group_access:a,isOwner:c}=e;let l,p,d;if(c&&(l=r?this.getGroupAccess(r):[],a&&a.forEach(e=>{const t=this.getNormalizeGroupAccess({group_id:e.group_id,remove:!0});l.push(t)}),p=this.getNormalizedBool(s),o)){d={},o.chapters&&(d[xx.UserGeneratedTour]=this.getNormalizedBool(o.chapters.length>1));const e=(o.tags||[]).includes("animated");d[xx.Animated]=this.getNormalizedBool(e);const t=Object(X.get)(o,"quizSettings.enabled",!1);d[xx.Quiz]=this.getNormalizedBool(t)}return{eid:t,name:n,description:i,index:o,group_access:l,public_access:p,flags:d}}getGroupAccess(e){return e.map(e=>this.getNormalizeGroupAccess(e))}getNormalizeGroupAccess(e){const{group_id:t,group_name:n,member_edit:i,visible:o,remove:s}=e;return{group_id:t,group_name:n,member_edit:this.getNormalizedBool(i),visibility:this.getNormalizedBool(o),remove:this.getNormalizedBool(s)}}getNormalizedBool(e){return!0===e?"1":!1===e?"0":""}postThumbnail(e,t,n,i=!1){const o=new Image;return o.src=n,new q.a(n=>{o.onload=()=>{const s=document.createElement("canvas"),r=s.getContext("2d");s.width=o.naturalWidth,s.height=o.naturalHeight,r.drawImage(o,0,0);const a=s.toDataURL("image/jpeg",1);let c="";c=t?`/ws/thumbs/bookmarks/${e}/large/chapters/${t}.jpg`:`/ws/thumbs/bookmarks/${e}/large/index.jpg`;const l=(new C.d).set("Content-Type","application/json");this.http.post(c,{image:a,invalidate:i},{headers:l,responseType:"text"}).subscribe(e=>{n.next(),n.complete()})}})}deleteThumbnail(e,t){return new q.a(n=>{const i=new Request(`/ws/thumbs/bookmarks/${e}/large/chapters/${t}.jpg`,{method:"DELETE"});fetch(i).then(e=>{n.complete()})})}copyThumbnail(e,t,n){let i="";const o=n.replace("/thumbs/","");i=t?`bookmarks/${e}/large/chapters/${t}.jpg`:`bookmarks/${e}/large/index.jpg`;const s=(new C.d).set("Content-Type","application/json");return new q.a(e=>{this.http.post("/ws/thumbs/copy",{src:o,dst:i},{headers:s,responseType:"text"}).subscribe(t=>{e.next(),e.complete()})})}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(d.g),i.Zb(C.b),i.Zb(Ur),i.Zb(yx),i.Zb(sr))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const Cx="/ws/thumbs",Sx={headers:(new C.d).set("Content-Type","application/json"),responseType:"text"};let kx=(()=>{class e{constructor(e){this.http=e}getStoryIndexThumbnail(e,t="large"){return`${"undefined"==typeof localBaseDirectory?"":localBaseDirectory}thumbs/modules/${e}/${t}/index.jpg`}saveStoryThumbnails({storyId:e,storyType:t,thumbnails:n,chapterIdMap:i,indexId:o,deleteUnused:s=!1}){const r=[],a={};return Object.entries(i).forEach(([i,s])=>{const c=n.get(s);a[s]=!0;const l=this.createThumbnailPath(t,e,i);if(Object(X.get)(c,"snapshot")){if(r.push(this.postThumbnail(c.snapshot,l)),i===o){const n=this.createThumbnailPath(t,e);r.push(this.postThumbnail(c.snapshot,n))}}else{const n=Object(X.get)(c,"urls.large");if(n){const s=n.split("/thumbs/")[1];if(r.push(this.copyThumbnail(s,l)),i===o){const n=this.createThumbnailPath(t,e);r.push(this.copyThumbnail(s,n))}}}}),s&&Object.keys(n).filter(e=>!(e in a)).forEach(e=>{const t=n.get(e).urls.large.split("/thumbs/")[1];r.push(this.deleteThumbnail(t))}),r}createThumbnailPath(e,t,n){let i=(t=t.replace(".json",""))+"/large";return n?i=`${i}/chapters/${n}.jpg`:i+="/index.jpg",[e===s.Bookmark?"bookmarks":"modules",i].join("/")}postThumbnail(e,t){const{width:n,height:i}=Uo.medium,o=new Image,s=document.createElement("canvas");s.width=n,s.height=i;const r=s.getContext("2d");return o.src=e,new q.a(e=>{o.onerror=()=>{e.next(),e.complete()},o.onload=()=>{r.drawImage(o,0,0);const n=s.toDataURL("image/jpeg",1),i=[Cx,t].join("/");this.http.post(i,{image:n},Sx).subscribe(()=>{e.next(),e.complete()})}})}deleteThumbnail(e){const t=[Cx,e].join("/");return new q.a(e=>{const n=new Request(t,{method:"DELETE"});fetch(n).finally(()=>{e.next(),e.complete()})})}copyThumbnail(e,t){return new q.a(n=>{this.http.post("/ws/thumbs/copy",{src:e,dst:t},Sx).subscribe(e=>{n.next(),n.complete()})})}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(C.b))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),_x=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-button-loader"]],decls:5,vars:0,consts:[["tabindex","0","type","button","aria-label","Interact in 3D","type","button",1,"button-loader"],[1,"button-loader__button"],["src","assets/images/widget/loading_experience/interact-in-3d-arrow.svg","alt","Interact in 3D",1,"button-loader__3d-arrow"],[1,"button-loader__label"]],template:function(e,t){1&e&&(i.Vb(0,"button",0),i.Vb(1,"div",1),i.Qb(2,"img",2),i.Vb(3,"div",3),i.Mc(4,"Interact in 3D"),i.Ub(),i.Ub(),i.Ub())},styles:[".m-1[_ngcontent-%COMP%]{margin:4px!important}.mv-1[_ngcontent-%COMP%]{margin-top:4px!important;margin-bottom:4px!important}.mh-1[_ngcontent-%COMP%]{margin-left:4px!important;margin-right:4px!important}.mt-1[_ngcontent-%COMP%]{margin-top:4px!important}.mr-1[_ngcontent-%COMP%]{margin-right:4px!important}.mb-1[_ngcontent-%COMP%]{margin-bottom:4px!important}.ml-1[_ngcontent-%COMP%]{margin-left:4px!important}.p-1[_ngcontent-%COMP%]{padding:4px!important}.pv-1[_ngcontent-%COMP%]{padding-top:4px!important;padding-bottom:4px!important}.ph-1[_ngcontent-%COMP%]{padding-left:4px!important;padding-right:4px!important}.pt-1[_ngcontent-%COMP%]{padding-top:4px!important}.pr-1[_ngcontent-%COMP%]{padding-right:4px!important}.pb-1[_ngcontent-%COMP%]{padding-bottom:4px!important}.pl-1[_ngcontent-%COMP%]{padding-left:4px!important}.m-2[_ngcontent-%COMP%]{margin:8px!important}.mv-2[_ngcontent-%COMP%]{margin-top:8px!important;margin-bottom:8px!important}.mh-2[_ngcontent-%COMP%]{margin-left:8px!important;margin-right:8px!important}.mt-2[_ngcontent-%COMP%]{margin-top:8px!important}.mr-2[_ngcontent-%COMP%]{margin-right:8px!important}.mb-2[_ngcontent-%COMP%]{margin-bottom:8px!important}.ml-2[_ngcontent-%COMP%]{margin-left:8px!important}.p-2[_ngcontent-%COMP%]{padding:8px!important}.pv-2[_ngcontent-%COMP%]{padding-top:8px!important;padding-bottom:8px!important}.ph-2[_ngcontent-%COMP%]{padding-left:8px!important;padding-right:8px!important}.pt-2[_ngcontent-%COMP%]{padding-top:8px!important}.pr-2[_ngcontent-%COMP%]{padding-right:8px!important}.pb-2[_ngcontent-%COMP%]{padding-bottom:8px!important}.pl-2[_ngcontent-%COMP%]{padding-left:8px!important}.m-3[_ngcontent-%COMP%]{margin:12px!important}.mv-3[_ngcontent-%COMP%]{margin-top:12px!important;margin-bottom:12px!important}.mh-3[_ngcontent-%COMP%]{margin-left:12px!important;margin-right:12px!important}.mt-3[_ngcontent-%COMP%]{margin-top:12px!important}.mr-3[_ngcontent-%COMP%]{margin-right:12px!important}.mb-3[_ngcontent-%COMP%]{margin-bottom:12px!important}.ml-3[_ngcontent-%COMP%]{margin-left:12px!important}.p-3[_ngcontent-%COMP%]{padding:12px!important}.pv-3[_ngcontent-%COMP%]{padding-top:12px!important;padding-bottom:12px!important}.ph-3[_ngcontent-%COMP%]{padding-left:12px!important;padding-right:12px!important}.pt-3[_ngcontent-%COMP%]{padding-top:12px!important}.pr-3[_ngcontent-%COMP%]{padding-right:12px!important}.pb-3[_ngcontent-%COMP%]{padding-bottom:12px!important}.pl-3[_ngcontent-%COMP%]{padding-left:12px!important}.m-4[_ngcontent-%COMP%]{margin:16px!important}.mv-4[_ngcontent-%COMP%]{margin-top:16px!important;margin-bottom:16px!important}.mh-4[_ngcontent-%COMP%]{margin-left:16px!important;margin-right:16px!important}.mt-4[_ngcontent-%COMP%]{margin-top:16px!important}.mr-4[_ngcontent-%COMP%]{margin-right:16px!important}.mb-4[_ngcontent-%COMP%]{margin-bottom:16px!important}.ml-4[_ngcontent-%COMP%]{margin-left:16px!important}.p-4[_ngcontent-%COMP%]{padding:16px!important}.pv-4[_ngcontent-%COMP%]{padding-top:16px!important;padding-bottom:16px!important}.ph-4[_ngcontent-%COMP%]{padding-left:16px!important;padding-right:16px!important}.pt-4[_ngcontent-%COMP%]{padding-top:16px!important}.pr-4[_ngcontent-%COMP%]{padding-right:16px!important}.pb-4[_ngcontent-%COMP%]{padding-bottom:16px!important}.pl-4[_ngcontent-%COMP%]{padding-left:16px!important}.m-5[_ngcontent-%COMP%]{margin:20px!important}.mv-5[_ngcontent-%COMP%]{margin-top:20px!important;margin-bottom:20px!important}.mh-5[_ngcontent-%COMP%]{margin-left:20px!important;margin-right:20px!important}.mt-5[_ngcontent-%COMP%]{margin-top:20px!important}.mr-5[_ngcontent-%COMP%]{margin-right:20px!important}.mb-5[_ngcontent-%COMP%]{margin-bottom:20px!important}.ml-5[_ngcontent-%COMP%]{margin-left:20px!important}.p-5[_ngcontent-%COMP%]{padding:20px!important}.pv-5[_ngcontent-%COMP%]{padding-top:20px!important;padding-bottom:20px!important}.ph-5[_ngcontent-%COMP%]{padding-left:20px!important;padding-right:20px!important}.pt-5[_ngcontent-%COMP%]{padding-top:20px!important}.pr-5[_ngcontent-%COMP%]{padding-right:20px!important}.pb-5[_ngcontent-%COMP%]{padding-bottom:20px!important}.pl-5[_ngcontent-%COMP%]{padding-left:20px!important}.m-6[_ngcontent-%COMP%]{margin:24px!important}.mv-6[_ngcontent-%COMP%]{margin-top:24px!important;margin-bottom:24px!important}.mh-6[_ngcontent-%COMP%]{margin-left:24px!important;margin-right:24px!important}.mt-6[_ngcontent-%COMP%]{margin-top:24px!important}.mr-6[_ngcontent-%COMP%]{margin-right:24px!important}.mb-6[_ngcontent-%COMP%]{margin-bottom:24px!important}.ml-6[_ngcontent-%COMP%]{margin-left:24px!important}.p-6[_ngcontent-%COMP%]{padding:24px!important}.pv-6[_ngcontent-%COMP%]{padding-top:24px!important;padding-bottom:24px!important}.ph-6[_ngcontent-%COMP%]{padding-left:24px!important;padding-right:24px!important}.pt-6[_ngcontent-%COMP%]{padding-top:24px!important}.pr-6[_ngcontent-%COMP%]{padding-right:24px!important}.pb-6[_ngcontent-%COMP%]{padding-bottom:24px!important}.pl-6[_ngcontent-%COMP%]{padding-left:24px!important}.m-7[_ngcontent-%COMP%]{margin:28px!important}.mv-7[_ngcontent-%COMP%]{margin-top:28px!important;margin-bottom:28px!important}.mh-7[_ngcontent-%COMP%]{margin-left:28px!important;margin-right:28px!important}.mt-7[_ngcontent-%COMP%]{margin-top:28px!important}.mr-7[_ngcontent-%COMP%]{margin-right:28px!important}.mb-7[_ngcontent-%COMP%]{margin-bottom:28px!important}.ml-7[_ngcontent-%COMP%]{margin-left:28px!important}.p-7[_ngcontent-%COMP%]{padding:28px!important}.pv-7[_ngcontent-%COMP%]{padding-top:28px!important;padding-bottom:28px!important}.ph-7[_ngcontent-%COMP%]{padding-left:28px!important;padding-right:28px!important}.pt-7[_ngcontent-%COMP%]{padding-top:28px!important}.pr-7[_ngcontent-%COMP%]{padding-right:28px!important}.pb-7[_ngcontent-%COMP%]{padding-bottom:28px!important}.pl-7[_ngcontent-%COMP%]{padding-left:28px!important}.m-8[_ngcontent-%COMP%]{margin:32px!important}.mv-8[_ngcontent-%COMP%]{margin-top:32px!important;margin-bottom:32px!important}.mh-8[_ngcontent-%COMP%]{margin-left:32px!important;margin-right:32px!important}.mt-8[_ngcontent-%COMP%]{margin-top:32px!important}.mr-8[_ngcontent-%COMP%]{margin-right:32px!important}.mb-8[_ngcontent-%COMP%]{margin-bottom:32px!important}.ml-8[_ngcontent-%COMP%]{margin-left:32px!important}.p-8[_ngcontent-%COMP%]{padding:32px!important}.pv-8[_ngcontent-%COMP%]{padding-top:32px!important;padding-bottom:32px!important}.ph-8[_ngcontent-%COMP%]{padding-left:32px!important;padding-right:32px!important}.pt-8[_ngcontent-%COMP%]{padding-top:32px!important}.pr-8[_ngcontent-%COMP%]{padding-right:32px!important}.pb-8[_ngcontent-%COMP%]{padding-bottom:32px!important}.pl-8[_ngcontent-%COMP%]{padding-left:32px!important}.m-9[_ngcontent-%COMP%]{margin:36px!important}.mv-9[_ngcontent-%COMP%]{margin-top:36px!important;margin-bottom:36px!important}.mh-9[_ngcontent-%COMP%]{margin-left:36px!important;margin-right:36px!important}.mt-9[_ngcontent-%COMP%]{margin-top:36px!important}.mr-9[_ngcontent-%COMP%]{margin-right:36px!important}.mb-9[_ngcontent-%COMP%]{margin-bottom:36px!important}.ml-9[_ngcontent-%COMP%]{margin-left:36px!important}.p-9[_ngcontent-%COMP%]{padding:36px!important}.pv-9[_ngcontent-%COMP%]{padding-top:36px!important;padding-bottom:36px!important}.ph-9[_ngcontent-%COMP%]{padding-left:36px!important;padding-right:36px!important}.pt-9[_ngcontent-%COMP%]{padding-top:36px!important}.pr-9[_ngcontent-%COMP%]{padding-right:36px!important}.pb-9[_ngcontent-%COMP%]{padding-bottom:36px!important}.pl-9[_ngcontent-%COMP%]{padding-left:36px!important}.m-10[_ngcontent-%COMP%]{margin:40px!important}.mv-10[_ngcontent-%COMP%]{margin-top:40px!important;margin-bottom:40px!important}.mh-10[_ngcontent-%COMP%]{margin-left:40px!important;margin-right:40px!important}.mt-10[_ngcontent-%COMP%]{margin-top:40px!important}.mr-10[_ngcontent-%COMP%]{margin-right:40px!important}.mb-10[_ngcontent-%COMP%]{margin-bottom:40px!important}.ml-10[_ngcontent-%COMP%]{margin-left:40px!important}.p-10[_ngcontent-%COMP%]{padding:40px!important}.pv-10[_ngcontent-%COMP%]{padding-top:40px!important;padding-bottom:40px!important}.ph-10[_ngcontent-%COMP%]{padding-left:40px!important;padding-right:40px!important}.pt-10[_ngcontent-%COMP%]{padding-top:40px!important}.pr-10[_ngcontent-%COMP%]{padding-right:40px!important}.pb-10[_ngcontent-%COMP%]{padding-bottom:40px!important}.pl-10[_ngcontent-%COMP%]{padding-left:40px!important}.text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3838}.text-info[_ngcontent-%COMP%]{color:#0060c4}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.button-loader[_ngcontent-%COMP%]{border:0;width:100%;background:rgba(0,0,0,.2);display:flex;position:fixed;justify-content:center;align-items:center;top:0;bottom:0;left:0;right:0;transition:background-color .25s,opacity .25s;z-index:10000}.button-loader[_ngcontent-%COMP%]:hover{opacity:1;cursor:pointer;background:var(--view-loader-scrim-bg--hover)}@media print{.button-loader[_ngcontent-%COMP%]{display:none}}.button-loader[_ngcontent-%COMP%]:focus   .button-loader__button[_ngcontent-%COMP%], .button-loader[_ngcontent-%COMP%]:hover   .button-loader__button[_ngcontent-%COMP%]{background-color:var(--view-loader-icon-color--hover);transform:scale(1.1)}.button-loader[_ngcontent-%COMP%]:focus   .button-loader__3d-arrow[_ngcontent-%COMP%], .button-loader[_ngcontent-%COMP%]:hover   .button-loader__3d-arrow[_ngcontent-%COMP%]{transform:scale(1.2)}.button-loader__button[_ngcontent-%COMP%]{display:flex;padding:12px 28px;border-radius:32px;align-items:center;transition:transform .25s,background-color .25s;background-color:var(--view-loader-button-bg)}.button-loader__3d-arrow[_ngcontent-%COMP%]{transition:transform .25s;margin-right:4px}.button-loader__label[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em;color:#fff;font-weight:600;margin-left:4px}"],changeDetection:0}),e})(),jx=(()=>{class e{constructor(e,t,n){this.viewService=e,this.modulesThumbnailService=t,this.bookmarksService=n}ngOnInit(){}handleClick(){this.viewService.toggleOnDemand(!1)}getThumbnailUrl(){return this.contentType===s.Bookmark?this.bookmarksService.getIndexThumbnail(this.contentId):this.modulesThumbnailService.getStoryIndexThumbnail(this.contentId)}getPoweredByUrl(){return("undefined"==typeof localBaseDirectory?"":localBaseDirectory)+"assets/images/powered-by-biodigital-logo.svg"}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(Ip),i.Pb(kx),i.Pb(Ox))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-ondemand"]],inputs:{contentId:"contentId",contentType:"contentType"},decls:5,vars:2,consts:[[1,"ondemand",3,"click"],[1,"ondemand__image",3,"lazyLoad"],[1,"ondemand__logo"],[3,"src"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.cc("click",(function(){return t.handleClick()})),i.Qb(1,"div",1),i.Qb(2,"app-button-loader"),i.Vb(3,"div",2),i.Qb(4,"img",3),i.Ub(),i.Ub()),2&e&&(i.Db(1),i.lc("lazyLoad",t.getThumbnailUrl()),i.Db(3),i.lc("src",t.getPoweredByUrl(),i.Cc))},directives:[fg.a,_x],styles:[".ondemand__image[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;left:0;right:0;background-size:cover;background-repeat:no-repeat;background-position:50%}.ondemand__logo[_ngcontent-%COMP%]{position:absolute;bottom:40px;justify-content:center;width:100%;z-index:20000;display:flex}"],changeDetection:0}),e})();const Px=["circle"],Mx=["progressCircle"],Ix=["progressContainer"];function zx(e,t){if(1&e&&(i.fc(),i.ec(),i.Vb(0,"div",9),i.Mc(1),i.Ub()),2&e){const e=i.gc();i.Db(1),i.Oc(" ",e.percent,"% ")}}const Tx=function(e){return{"view-progress--active":e}},Ux=function(e){return{"view-progress__ring--pulse":e}};let Lx=(()=>{class e{constructor(e,t){this.renderer=e,this.changeDetectorRef=t,this.ngUnsubscribe=new $.a,this.label="Loading...",this._show=!1,this._percent=new os.a(0)}get show(){return this._show}set show(e){setTimeout(()=>{this._show=e,this.changeDetectorRef.markForCheck()})}get percent(){return Math.floor(this._percent.value)}set percent(e){null!=e&&this._percent.next(e)}ngOnInit(){this.initSizeObserver()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}ngAfterViewInit(){this.updateDimensions(),this.initPercentObserver()}initPercentObserver(){this._percent.pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(()=>{this.label=this.getLoadingLabel(this.percent),this.renderProgress(0===this.percent?100:this.percent),this.changeDetectorRef.markForCheck()})}initSizeObserver(){Object(as.a)(window,"resize").pipe(Object(cs.a)(10),Object(W.a)(this.ngUnsubscribe)).subscribe(()=>{this.updateDimensions()})}calculateRadius(){return this.getCircleWidth()/2}getCircleWidth(){return this.circleRef.nativeElement.offsetWidth}getRadius(){return this.progressCircleRef.nativeElement.r.baseVal.value}getCircumference(){return 2*this.getRadius()*Math.PI}getOffset(e=100){const t=this.getCircumference();return t-e/100*t}renderProgress(e){e>=100&&(e=100);const t=this.getCircumference(),n=this.getOffset(e);this.renderer.setStyle(this.progressCircleRef.nativeElement,"strokeDasharray",`${t} ${t}`),this.renderer.setStyle(this.progressCircleRef.nativeElement,"strokeDashoffset",""+n)}getLoadingLabel(e){return 100===e?"Launching...":"Loading..."}updateDimensions(){const e=this.calculateRadius();this.renderer.setAttribute(this.progressContainerRef.nativeElement,"width",""+2*e),this.renderer.setAttribute(this.progressContainerRef.nativeElement,"height",""+2*e),this.renderer.setAttribute(this.progressCircleRef.nativeElement,"r",""+(e-6)),this.renderer.setAttribute(this.progressCircleRef.nativeElement,"cx",""+e),this.renderer.setAttribute(this.progressCircleRef.nativeElement,"cy",""+e);const t=this.getCircumference();this.renderer.setStyle(this.progressCircleRef.nativeElement,"strokeDasharray",`${t} ${t}`),this.renderer.setStyle(this.progressCircleRef.nativeElement,"strokeDashoffset",""+t)}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(i.H),i.Pb(i.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-progress"]],viewQuery:function(e,t){if(1&e&&(i.Gc(Px,!0),i.Gc(Mx,!0),i.Gc(Ix,!0)),2&e){let e;i.uc(e=i.dc())&&(t.circleRef=e.first),i.uc(e=i.dc())&&(t.progressCircleRef=e.first),i.uc(e=i.dc())&&(t.progressContainerRef=e.first)}},inputs:{show:"show",percent:"percent"},decls:10,vars:9,consts:[["data-test","viewProgress",1,"view-progress",3,"ngClass"],[1,"view-progress__circle"],["circle",""],[1,"view-progress__ring",3,"ngClass"],["progressContainer",""],[1,"view-progress__ring-inner"],["progressCircle",""],["class","view-progress__count",4,"ngIf"],[1,"view-progress__label"],[1,"view-progress__count"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Vb(1,"div",1,2),i.fc(),i.Vb(3,"svg",3,4),i.Qb(5,"circle",5,6),i.Ub(),i.Kc(7,zx,2,1,"div",7),i.ec(),i.Vb(8,"div",8),i.Mc(9),i.Ub(),i.Ub(),i.Ub()),2&e&&(i.lc("ngClass",i.oc(5,Tx,t.show)),i.Db(1),i.lc("@isOpen",t.show?"open":"closed"),i.Db(2),i.lc("ngClass",i.oc(7,Ux,0===t.percent||100===t.percent)),i.Db(4),i.lc("ngIf",t.percent>0&&t.percent<100),i.Db(2),i.Oc(" ",t.label," "))},directives:[ms.i,ms.l],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3838}.text-info[_ngcontent-%COMP%]{color:#0060c4}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.view-progress[_ngcontent-%COMP%]{--circleSize:35vw;pointer-events:none;position:absolute;display:flex;justify-content:center;align-items:center;left:0;right:0;top:0;bottom:0;z-index:1000;transition:background-color .15s}@-webkit-keyframes progressPulse{0%{stroke-width:4}50%{stroke-width:1}to{stroke-width:4}}@keyframes progressPulse{0%{stroke-width:4}50%{stroke-width:1}to{stroke-width:4}}.view-progress--active[_ngcontent-%COMP%]{background-color:rgba(0,0,0,.2)}.view-progress__circle[_ngcontent-%COMP%]{transform:scale(0);width:var(--circleSize);height:var(--circleSize);border-radius:50%;background-color:var(--view-progress-bg);display:flex;flex-direction:column;align-items:center;justify-content:center;position:relative}.view-progress__count[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em;color:var(--view-progress-primary-color);font-weight:700}.view-progress__label[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em;color:var(--view-progress-secondary-color)}.view-progress__ring[_ngcontent-%COMP%]{position:absolute;top:0;right:0;bottom:0;left:0;z-index:3;opacity:1;stroke-dashoffset:0;stroke-width:4;stroke:var(--view-progress-secondary-color);fill:transparent;transform:rotate(-90deg)}.view-progress__ring--pulse[_ngcontent-%COMP%]{-webkit-animation:progressPulse 2s ease-in-out infinite;animation:progressPulse 2s ease-in-out infinite}@media (min-width:600px){.view-progress__circle[_ngcontent-%COMP%]{width:160px;height:160px}}"],data:{animation:[Object(ol.n)("isOpen",[Object(ol.k)("open",Object(ol.l)({transform:"scale(1)"})),Object(ol.k)("closed",Object(ol.l)({transform:"scale(0)"})),Object(ol.m)("closed => open",[Object(ol.e)("300ms ease-out")]),Object(ol.m)("open => closed",[Object(ol.e)("150ms ease-in")])])]},changeDetection:0}),e})();const Dx=["viewLoader"],Ex=["*"];let Fx=(()=>{class e{constructor(e,t,n){this.renderer=e,this.viewService=t,this.actions=n,this.ngUnsubscribe=new $.a}handleClick(){this.renderer.addClass(this.viewLoaderRef.nativeElement,"view-loader--disappear"),setTimeout(()=>{this.viewService.toggleInteract(!1)},250)}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(i.H),i.Pb(Ip),i.Pb(d.b))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-loader"]],viewQuery:function(e,t){if(1&e&&i.Gc(Dx,!0),2&e){let e;i.uc(e=i.dc())&&(t.viewLoaderRef=e.first)}},ngContentSelectors:Ex,decls:4,vars:0,consts:[["role","dialog",1,"view-loader"],["viewLoader",""],["role","button",3,"click"]],template:function(e,t){1&e&&(i.kc(),i.Vb(0,"div",0,1),i.Vb(2,"div",2),i.cc("click",(function(){return t.handleClick()})),i.jc(3),i.Ub(),i.Ub())},styles:[""],encapsulation:2,changeDetection:0}),e})();const Ax=["circle"],Rx=["progressCircle"],Nx=["progressContainer"];let Vx=(()=>{class e{constructor(e){this.renderer=e,this.ngUnsubscribe=new $.a,this._percent=0}get percent(){return this._percent}set percent(e){null!=e&&(this._percent=e,this.setProgress(this.percent))}ngOnInit(){this.initSizeObserver()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}ngAfterViewInit(){this.updateDimensions()}initSizeObserver(){Object(as.a)(window,"resize").pipe(Object(cs.a)(10),Object(W.a)(this.ngUnsubscribe)).subscribe(()=>{this.updateDimensions()})}calculateRadius(){return this.getCircleWidth()/2}getCircleWidth(){return this.circleRef.nativeElement.offsetWidth}getRadius(){return this.progressCircleRef.nativeElement.r.baseVal.value}getCircumference(){return 2*this.getRadius()*Math.PI}getOffset(e=100){const t=this.getCircumference();return t-e/100*t}setProgress(e=0){e>=100&&(e=100);const t=this.getCircumference(),n=this.getOffset(e);this.renderer.setStyle(this.progressCircleRef.nativeElement,"strokeDasharray",`${t} ${t}`),this.renderer.setStyle(this.progressCircleRef.nativeElement,"strokeDashoffset",""+n)}updateDimensions(){const e=this.calculateRadius();this.renderer.setAttribute(this.progressContainerRef.nativeElement,"width",""+2*e),this.renderer.setAttribute(this.progressContainerRef.nativeElement,"height",""+2*e),this.renderer.setAttribute(this.progressCircleRef.nativeElement,"r",""+(e-6)),this.renderer.setAttribute(this.progressCircleRef.nativeElement,"cx",""+e),this.renderer.setAttribute(this.progressCircleRef.nativeElement,"cy",""+e);const t=this.getCircumference();this.renderer.setStyle(this.progressCircleRef.nativeElement,"strokeDasharray",`${t} ${t}`),this.renderer.setStyle(this.progressCircleRef.nativeElement,"strokeDashoffset",""+t),setTimeout(()=>{this.renderer.setStyle(this.progressCircleRef.nativeElement,"transition","stroke-dashoffset 300ms")})}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(i.H))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-play-loader"]],viewQuery:function(e,t){if(1&e&&(i.Gc(Ax,!0),i.Gc(Rx,!0),i.Gc(Nx,!0)),2&e){let e;i.uc(e=i.dc())&&(t.circleRef=e.first),i.uc(e=i.dc())&&(t.progressCircleRef=e.first),i.uc(e=i.dc())&&(t.progressContainerRef=e.first)}},inputs:{percent:"percent"},decls:10,vars:0,consts:[["tabindex","0","type","button","aria-label","Interact in 3D",1,"play-loader"],[1,"play-loader__circle"],["circle",""],[1,"play-loader__ring"],["progressContainer",""],[1,"play-loader__ring-inner"],["progressCircle",""],["icon","play",1,"play-loader__icon"],[1,"play-loader__label"]],template:function(e,t){1&e&&(i.Vb(0,"button",0),i.Vb(1,"div",1,2),i.fc(),i.Vb(3,"svg",3,4),i.Qb(5,"circle",5,6),i.Ub(),i.ec(),i.Qb(7,"app-icon",7),i.Vb(8,"div",8),i.Mc(9,"3D"),i.Ub(),i.Ub(),i.Ub())},directives:[$a],styles:[".play-loader[_ngcontent-%COMP%]{--buttonSize:35vw;border:0;width:100%;background:rgba(0,0,0,.2);display:flex;position:fixed;justify-content:center;align-items:center;top:0;bottom:0;left:0;right:0;transition:background-color .25s,opacity .25s;z-index:10000}.play-loader[_ngcontent-%COMP%]:hover{opacity:1;cursor:pointer;background:var(--view-loader-scrim-bg--hover)}.play-loader[_ngcontent-%COMP%]:focus   .play-loader__circle[_ngcontent-%COMP%], .play-loader[_ngcontent-%COMP%]:hover   .play-loader__circle[_ngcontent-%COMP%]{background:var(--view-loader-button-bg--hover);color:var(--view-loader-circle-color--hover);transform:scale(1.1)}.play-loader[_ngcontent-%COMP%]:focus   .play-loader__icon[_ngcontent-%COMP%], .play-loader[_ngcontent-%COMP%]:hover   .play-loader__icon[_ngcontent-%COMP%]{color:var(--view-loader-icon-color--hover);transform:scale(1.2)}.play-loader[_ngcontent-%COMP%]:focus   .play-loader__label[_ngcontent-%COMP%], .play-loader[_ngcontent-%COMP%]:hover   .play-loader__label[_ngcontent-%COMP%]{color:var(--view-loader-label-color--hover)}.play-loader[_ngcontent-%COMP%]:focus   .play-loader__ring[_ngcontent-%COMP%], .play-loader[_ngcontent-%COMP%]:hover   .play-loader__ring[_ngcontent-%COMP%]{stroke:var(--view-loader-progress-color--hover)}.play-loader__circle[_ngcontent-%COMP%]{width:var(--buttonSize);height:var(--buttonSize);border-radius:50%;background-color:var(--view-loader-button-bg);color:var(--view-loader-circle-color);display:flex;align-items:center;justify-content:center;position:relative;transition:background-color .25s,color .25s,transform .25s}.play-loader__icon[_ngcontent-%COMP%]{font-size:calc(var(--buttonSize) / 2);color:var(--view-loader-icon-color);transition:color .25s,transform .25s;margin-right:-10%}.play-loader__label[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;display:flex;justify-content:center;align-items:center;z-index:2;font-weight:600}.play-loader__ring[_ngcontent-%COMP%]{position:absolute;top:0;right:0;bottom:0;left:0;z-index:3;stroke-width:4;stroke:var(--view-loader-progress-color);fill:transparent;transform:rotate(-90deg)}@media (min-width:600px){.play-loader__circle[_ngcontent-%COMP%]{width:160px;height:160px}.play-loader__icon[_ngcontent-%COMP%]{font-size:80px}}"],changeDetection:0}),e})(),Hx=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-hand-loader"]],decls:6,vars:0,consts:[["tabindex","0","type","button","aria-label","Interact in 3D",1,"hand-loader"],[1,"hand-loader__container"],[1,"hand-loader__circle"],["src","assets/images/widget/loading_experience/interact-in-3d-hand.svg","alt","Interact in 3D",1,"hand-loader__3d-hand"],[1,"hand-loader__label"]],template:function(e,t){1&e&&(i.Vb(0,"button",0),i.Vb(1,"div",1),i.Qb(2,"div",2),i.Qb(3,"img",3),i.Vb(4,"div",4),i.Mc(5,"Interact in 3D"),i.Ub(),i.Ub(),i.Ub())},styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3838}.text-info[_ngcontent-%COMP%]{color:#0060c4}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.hand-loader[_ngcontent-%COMP%]{border:0;width:100%;background:rgba(0,0,0,.2);display:flex;position:fixed;justify-content:center;align-items:center;top:0;bottom:0;left:0;right:0;transition:background-color .25s,opacity .25s;z-index:10000}.hand-loader[_ngcontent-%COMP%]:hover{opacity:1;cursor:pointer;background:var(--view-loader-scrim-bg--hover)}@-webkit-keyframes handKeyframes{0%{transform:scale(1.2)}25%{transform:scale(1)}40%{transform:scale(1)}60%{transform:scale(1.2)}to{transform:scale(1.2)}}@keyframes handKeyframes{0%{transform:scale(1.2)}25%{transform:scale(1)}40%{transform:scale(1)}60%{transform:scale(1.2)}to{transform:scale(1.2)}}@-webkit-keyframes circleKeyframes{0%{transform:scale(0)}20%{transform:scale(0);opacity:1}to{transform:scale(1);opacity:0}}@keyframes circleKeyframes{0%{transform:scale(0)}20%{transform:scale(0);opacity:1}to{transform:scale(1);opacity:0}}.hand-loader[_ngcontent-%COMP%]:focus   .hand-loader__3d-hand[_ngcontent-%COMP%], .hand-loader[_ngcontent-%COMP%]:hover   .hand-loader__3d-hand[_ngcontent-%COMP%]{filter:drop-shadow(0 0 8px #2d72dc)}.hand-loader__container[_ngcontent-%COMP%]{position:relative;width:200px;height:200px}.hand-loader__circle[_ngcontent-%COMP%]{background-color:#fff;position:absolute;left:50%;margin-left:-40.5px;margin-top:-1.5px;width:70px;height:70px;border-radius:50%;-webkit-animation:circleKeyframes 2s infinite;animation:circleKeyframes 2s infinite}.hand-loader__3d-hand[_ngcontent-%COMP%]{-webkit-animation:handKeyframes 2s ease-in-out infinite;animation:handKeyframes 2s ease-in-out infinite;position:absolute;height:96px;width:86px;left:50%;margin-left:-43px;margin-top:27px;transition:filter .3s ease-out}.hand-loader__label[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em;font-weight:600;color:#fff;text-shadow:0 1px 5px #000;bottom:40px;position:absolute;text-align:center;width:100%}"],changeDetection:0}),e})();const Bx=["app-view-rounded-button",""];function Qx(e,t){if(1&e&&i.Qb(0,"app-icon",3),2&e){const e=i.gc();i.lc("icon",e.icon)}}let $x=(()=>{class e{constructor(){this.iconPlacement="left",this.compact=!1,this.buttonType="outline"}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["button","app-view-rounded-button",""]],inputs:{icon:"icon",iconPlacement:"iconPlacement",label:"label",compact:"compact",buttonType:"buttonType",shadow:"shadow"},attrs:Bx,decls:4,vars:12,consts:[[1,"view-rounded-button"],["class","view-rounded-button__icon mh-1",3,"icon",4,"ngIf"],[1,"view-rounded-button__label","mh-1"],[1,"view-rounded-button__icon","mh-1",3,"icon"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Kc(1,Qx,1,1,"app-icon",1),i.Vb(2,"div",2),i.Mc(3),i.Ub(),i.Ub()),2&e&&(i.Hb("view-rounded-button--outline","outline"===t.buttonType)("view-rounded-button--solid","solid"===t.buttonType)("view-rounded-button--shadow",t.shadow)("view-rounded-button--compact",t.compact)("view-rounded-button--reverse","right"===t.iconPlacement),i.Db(1),i.lc("ngIf",t.icon),i.Db(2),i.Nc(t.label))},directives:[ms.l,$a],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3838}.text-info{color:#0060c4}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}button[app-view-rounded-button]{border-color:transparent;background:none;border-width:0;padding:0;outline:none;margin:0;pointer-events:all}button[app-view-rounded-button]:focus .view-rounded-button,button[app-view-rounded-button]:hover .view-rounded-button{color:#f9fafd;border-color:#f9fafd;background:rgba(249,250,253,.25)}button[app-view-rounded-button]:focus .view-rounded-button--solid,button[app-view-rounded-button]:hover .view-rounded-button--solid{border-color:rgba(249,250,253,.25)}.view-rounded-button{cursor:pointer;display:flex;flex-direction:row;align-items:center;justify-content:center;padding:12px 16px;border-radius:24px;color:#f9fafd;border:1px solid #f9fafd}.view-rounded-button__label{font-size:16px;letter-spacing:.4px;line-height:1.4em}.view-rounded-button--solid{color:#060502;border-color:#060502;background:#f9fafd}.view-rounded-button--shadow{box-shadow:0 0 8px rgba(0,0,0,.32)}.view-rounded-button--reverse{flex-direction:row-reverse}.view-rounded-button--compact{padding:4px 8px}"],encapsulation:2,changeDetection:0}),e})();var qx=function(e){return e.CameraZoom="camera-zoom",e.CameraRotate="camera-rotate",e.CameraPan="camera-pan",e.NodeSelection="node-selection",e}({}),Wx=n("JX91"),Kx=n("IOcx");function Gx(e,t,n=1e3,i=.001){return Xx(e).pipe(Object(Wx.a)(t.getCameraZoom()),Object(k.a)(()=>t.getCameraZoom()),Object(us.a)(),Object(k.a)(([e,t])=>t-e),Object(K.a)(e=>Math.abs(e)>i),Object(cs.a)(n))}function Zx(e,t,n=125){return Xx(e).pipe(Object(Wx.a)(t.getLookDirection()),Object(k.a)(()=>t.getLookDirection()),Object(us.a)(),Object(k.a)(([e,t])=>function(e,t){return Kx.a.angle(e,t)>.001}(e,t)),Object(K.a)(e=>e),Object(cs.a)(n))}function Jx(e){return{camera:e.getCamera(),zoom:e.getCameraZoom()}}function Xx(e){return e.getEvent(it.CameraRested)}function Yx(e){const{eye:t,look:n}=e,i=Kx.a.fromValues(t.x,t.y,t.z),o=Kx.a.fromValues(n.x,n.y,n.z),s=Kx.a.create();return Kx.a.sub(s,i,o),s}var ev=n("vqkR");function tv(e,t){if(1&e&&(i.Vb(0,"h1",6),i.Mc(1),i.Ub()),2&e){const e=i.gc(2);i.Db(1),i.Oc(" ",e.title," ")}}function nv(e,t){if(1&e&&i.Qb(0,"img",7),2&e){const e=i.gc(2);i.lc("src",e.image,i.Cc)}}function iv(e,t){if(1&e&&(i.Vb(0,"div",1),i.Kc(1,tv,2,1,"h1",2),i.Vb(2,"article",3),i.jc(3),i.Ub(),i.Kc(4,nv,1,1,"img",4),i.Vb(5,"div",5),i.jc(6,1),i.Ub(),i.Ub()),2&e){const e=i.gc();i.Hb("slide--expanded","expanded"===e.spacing),i.lc("@refresh",void 0),i.Db(1),i.lc("ngIf",e.title),i.Db(3),i.lc("ngIf",e.image)}}const ov=["*",[["","slide-footer",""]]],sv=["*","[slide-footer]"];let rv=(()=>{class e{constructor(e,t,n,o,s){this.store=e,this.actions=t,this.engineService=n,this.cameraService=o,this.changeRef=s,this.spacing="compact",this.exitEnabled=!0,this.triggerDelay=300,this.triggerComplete=new i.p,this._shown=!1,this.ngUnsubscribe=new $.a}set shown(e){this._shown=e,this.initTrigger(),this.changeRef.markForCheck()}get shown(){return this._shown}ngOnInit(){}ngAfterViewInit(){this.initTrigger()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initTrigger(){if(this.ngUnsubscribe.next(),this.shown&&this.trigger){const e=this.resetCamera(),t=this.store.selectSnapshot(il.getCanTouch);(function(e,t,n,i,o){switch(e){case qx.CameraZoom:return o?Gx(n,i):function(e,t,n=1e3,i=.001){const o=e.getCanvas(),s=Object(as.a)(o,"wheel"),r=Object(as.a)(o,"touchmove").pipe(Object(K.a)(e=>2===e.touches.length)),a=Gx(e,t,n,i);return Object(ss.a)(s,r).pipe(Object(Oo.a)(()=>a))}(n,i);case qx.CameraPan:return function(e,t,n=125){const i=e.getCanvas(),o=Object(as.a)(i,"mousemove").pipe(Object(K.a)(e=>1===e.buttons&&e.shiftKey||2===e.buttons||4===e.buttons)),s=Object(as.a)(i,"touchmove").pipe(Object(K.a)(e=>2===e.touches.length)),r=function(e,t,n=125){return Xx(e).pipe(Object(Wx.a)(Jx(t)),Object(k.a)(()=>Jx(t)),Object(cs.a)(n),Object(us.a)(),Object(k.a)(([e,t])=>function(e,t){const n=Yx(e.camera),i=Yx(t.camera),o=Kx.a.create();Kx.a.sub(o,n,i);const s=o.reduce((e,t)=>e+t),r=t.zoom-e.zoom;return(0!==r||0!==s)&&Math.abs(s)<1&&Math.abs(r)<.001}(e,t)),Object(K.a)(e=>e))}(e,t,n);return Object(ss.a)(o,s).pipe(Object(Oo.a)(()=>r))}(n,i);case qx.CameraRotate:return o?Zx(n,i):function(e,t,n,i=1e3){const o=t.getCanvas(),s=Object(as.a)(o,"mousemove").pipe(Object(K.a)(e=>1===e.buttons)),r=Object(as.a)(o,"touchmove").pipe(Object(K.a)(e=>1===e.touches.length)),a=Zx(t,n,i);return Object(ss.a)(s,r).pipe(Object(Oo.a)(()=>a),Object(K.a)(()=>"rotate"===e.selectSnapshot(Ko.getPanMode)),Object(cs.a)(125))}(t,n,i);case qx.NodeSelection:return function(e){return e.select(ii.getCheckedNodes).pipe(Object(us.a)(),Object(K.a)(([e,t])=>t.length>0))}(t)}})(this.trigger,this.store,this.engineService,this.cameraService,t).pipe(Object(ev.a)(e),Object(Nr.a)(this.triggerDelay),Object(W.a)(this.ngUnsubscribe)).subscribe(()=>{this.triggerComplete.next()})}}resetCamera(){const e=this.store.selectSnapshot(Bo.getSelectedChapter);return this.store.dispatch(new bt(e.camera.location,!0)).pipe(Object(Oo.a)(()=>this.actions.pipe(Object(d.j)(mt))),Object(sl.a)(1))}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.g),i.Pb(d.b),i.Pb(lt),i.Pb(Lt),i.Pb(i.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-tour-slide"]],inputs:{title:"title",image:"image",spacing:"spacing",shown:"shown",exitEnabled:"exitEnabled",trigger:"trigger",triggerDelay:"triggerDelay"},outputs:{triggerComplete:"triggerComplete"},ngContentSelectors:sv,decls:1,vars:1,consts:[["class","slide",3,"slide--expanded",4,"ngIf"],[1,"slide"],["class","slide__title",4,"ngIf"],[1,"slide__content"],["class","slide__image",3,"src",4,"ngIf"],[1,"slide__footer"],[1,"slide__title"],[1,"slide__image",3,"src"]],template:function(e,t){1&e&&(i.kc(ov),i.Kc(0,iv,7,5,"div",0)),2&e&&i.lc("ngIf",t.shown)},directives:[ms.l],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3838}.text-info[_ngcontent-%COMP%]{color:#0060c4}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.slide[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;max-width:500px}.slide__title[_ngcontent-%COMP%]{font-weight:600;font-size:18px;letter-spacing:.45px}.slide__content[_ngcontent-%COMP%], .slide__title[_ngcontent-%COMP%]{margin-bottom:16px;line-height:1.4em}.slide__content[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.5em;max-width:100%}.slide__image[_ngcontent-%COMP%]{margin:24px auto;max-width:100%;min-height:1px}.slide__footer[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em;font-weight:500;display:flex;flex-direction:row;align-items:center;justify-content:center;max-width:100%}.slide--expanded[_ngcontent-%COMP%]   .slide__title[_ngcontent-%COMP%]{margin:16px}.slide--expanded[_ngcontent-%COMP%]   .slide__content[_ngcontent-%COMP%]{margin:48px}.slide--expanded[_ngcontent-%COMP%]   .slide__image[_ngcontent-%COMP%]{margin:48px auto}@media (max-width:768px){.slide[_ngcontent-%COMP%]{max-width:400px}.slide__image[_ngcontent-%COMP%]{margin:16px}.slide__title[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em;margin-bottom:12px}.slide__content[_ngcontent-%COMP%]{margin-bottom:12px}.slide__content[_ngcontent-%COMP%], .slide__footer[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}}@media (max-width:640px){.slide[_ngcontent-%COMP%]{max-width:320px}}@media (max-width:480px){.slide[_ngcontent-%COMP%]{max-width:240px}.slide__title[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px}.slide__content[_ngcontent-%COMP%], .slide__title[_ngcontent-%COMP%]{line-height:1.4em;margin-bottom:8px}.slide__content[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px}.slide__image[_ngcontent-%COMP%]{margin:4px auto}.slide__footer[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}}@media (max-width:320px){.slide[_ngcontent-%COMP%]{max-width:160px}}"],data:{animation:[Object(ol.n)("refresh",[Object(ol.m)(":enter",[Object(ol.o)(Um.slideTransition,{params:{duration:500,from:100,to:0}})])])]},changeDetection:0}),e})();function av(e,t){1&e&&(i.Vb(0,"div",1),i.Vb(1,"div",2),i.jc(2),i.Ub(),i.Ub())}const cv=["*"];let lv=(()=>{class e{constructor(e){this.changeRef=e,this.selectedSlideIndex=0,this._shown=!1,this.ngUnsubscribe=new $.a}set shown(e){this._shown=e,this.setSelectedSlide(0)}get shown(){return this._shown}ngOnInit(){}ngAfterViewInit(){this.initListeners(),setTimeout(()=>{this.setSlideShown(this.selectedSlideIndex)})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}goToPrevSlide(){this.setSelectedSlide(this.selectedSlideIndex-1)}goToNextSlide(){this.setSelectedSlide(this.selectedSlideIndex+1)}setSelectedSlide(e){if(this.selectedSlideIndex=e,this.slides){const t=Math.max(0,Math.min(this.slides.length-1,e));this.selectedSlideIndex=t}this.setSlideShown(this.selectedSlideIndex)}initListeners(){Object(ss.a)(...this.slides.map(e=>e.triggerComplete.asObservable())).pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(()=>{this.goToNextSlide()})}setSlideShown(e){this.slides&&this.slides.forEach((t,n)=>{t.shown=n===e}),this.changeRef.markForCheck()}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(i.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-tour-page"]],contentQueries:function(e,t,n){if(1&e&&i.Ib(n,rv,!1),2&e){let e;i.uc(e=i.dc())&&(t.slides=e)}},inputs:{shown:"shown"},ngContentSelectors:cv,decls:1,vars:1,consts:[["class","page",4,"ngIf"],[1,"page"],[1,"page__contents"]],template:function(e,t){1&e&&(i.kc(),i.Kc(0,av,3,0,"div",0)),2&e&&i.lc("ngIf",t.shown)},directives:[ms.l],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3838}.text-info[_ngcontent-%COMP%]{color:#0060c4}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.page[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center}.page__contents[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}@media (max-width:768px){.page__contents[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}}@media (max-width:480px){.page__contents[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}}"],changeDetection:0}),e})();var pv=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function dv(e,t){if(1&e){const e=i.Wb();i.Vb(0,"div",5),i.Vb(1,"button",6),i.cc("click",(function(){return i.zc(e),i.gc(2).handlePrevClick()})),i.Ub(),i.Vb(2,"div",7),i.Mc(3),i.Ub(),i.Vb(4,"button",8),i.cc("click",(function(){return i.zc(e),i.gc(2).handleNextClick()})),i.Ub(),i.Ub()}if(2&e){const e=i.gc().$implicit;i.Db(1),i.lc("disabled",e.pageIndex<1),i.Db(2),i.Pc(" ",e.pageIndex+1," / ",e.pageSize," "),i.Db(1),i.lc("disabled",e.pageIndex===e.pageSize-1)}}const uv=function(e){return{"pages--opaquer":e}};function gv(e,t){if(1&e){const e=i.Wb();i.Vb(0,"div",1),i.Vb(1,"button",2),i.cc("click",(function(){return i.zc(e),i.gc().handleExitClick()})),i.Ub(),i.Vb(2,"div",3),i.jc(3),i.Ub(),i.Kc(4,dv,5,4,"div",4),i.Ub()}if(2&e){const e=t.$implicit;i.lc("ngClass",i.oc(2,uv,e.pageIndex==e.pageSize-1)),i.Db(4),i.lc("ngIf",e.pageIndex<e.pageSize-1)}}const hv=["*"];let bv=(()=>{class e{constructor(e,t,n){this.store=e,this.changeRef=t,this.ga=n,this.ngUnsubscribe=new $.a,this.index=null}ngOnInit(){}ngAfterViewInit(){this.tutorial$.pipe(Object(W.a)(this.ngUnsubscribe),Object(K.a)(e=>null!=e&&e.pageSize>0)).subscribe(e=>{this.handleTutorialPages(e)}),this.store.dispatch(new Q.SetTutorial({pageSize:this.pages.length,pageIndex:0}))}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}handlePrevClick(){this.store.dispatch(new Q.TutorialPrevious)}handleNextClick(){this.store.dispatch(new Q.TutorialNext)}handleExitClick(){this.store.dispatch(new Q.ToggleWindow(Fc.Tutorial,!1))}handleTutorialPages(e){this.pages.forEach((t,n)=>{t.shown=n===e.pageIndex}),this.ga.event("Viewed Tutorial Step","View Tutorial",`Step ${e.pageIndex+1} of ${e.pageSize}`),this.changeRef.markForCheck()}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.g),i.Pb(i.i),i.Pb(J.c))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-tour-pages"]],contentQueries:function(e,t,n){if(1&e&&i.Ib(n,lv,!1),2&e){let e;i.uc(e=i.dc())&&(t.pages=e)}},ngContentSelectors:hv,decls:2,vars:3,consts:[["gaCategory","View Tutorial","class","pages",3,"ngClass",4,"ngIf"],["gaCategory","View Tutorial",1,"pages",3,"ngClass"],["gaEvent","","gaAction","Clicked Exit Tutorial","app-pin-button","","buttonType","dark","size","medium","icon","times","aria-label","Exit Tutorial","matTooltip","Exit Tutorial","matTooltipPosition","right",1,"pages__close",3,"click"],[1,"pages__contents"],["class","pages__footer",4,"ngIf"],[1,"pages__footer"],["gaEvent","","gaAction","Clicked Previous Tutorial Step","app-pin-button","","buttonType","dark","size","large","icon","angle-left","aria-label","Previous Tutorial Step","matTooltip","Previous Tutorial Step","matTooltipPosition","left",1,"pages__nav",3,"disabled","click"],[1,"mh-8"],["gaEvent","","gaAction","Clicked Next Tutorial Step","app-pin-button","","buttonType","dark","size","large","icon","angle-right","aria-label","Next Tutorial Step","matTooltip"," Next Tutorial Step","matTooltipPosition","right",1,"pages__nav",3,"disabled","click"]],template:function(e,t){1&e&&(i.kc(),i.Kc(0,gv,5,4,"div",0),i.hc(1,"async")),2&e&&i.lc("ngIf",i.ic(1,1,t.tutorial$))},directives:[ms.l,J.a,ms.i,Ad,J.b,Rd.c],pipes:[ms.b],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3838}.text-info[_ngcontent-%COMP%]{color:#0060c4}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.pages[_ngcontent-%COMP%]{pointer-events:none;display:flex;flex-direction:column;align-items:center;justify-content:center;margin:20px auto 48px;max-width:600px;position:relative;background:rgba(16,24,35,.8);border-radius:16px;padding:24px 28px 20px}.pages--opaquer[_ngcontent-%COMP%]{background:rgba(16,24,35,.9)}.pages__footer[_ngcontent-%COMP%]{flex-direction:row;font-size:16px;letter-spacing:.4px;line-height:1.4em;font-weight:500}.pages__close[_ngcontent-%COMP%], .pages__footer[_ngcontent-%COMP%]{display:flex;align-items:center}.pages__close[_ngcontent-%COMP%]{z-index:1;position:absolute;top:8px;right:8px;align-self:flex-end;justify-content:center}.pages__contents[_ngcontent-%COMP%]{padding:16px 0}@media (max-width:768px){.pages[_ngcontent-%COMP%]{margin:16px 12% 48px;border-radius:10px;padding:18px 22px 14px}.pages__contents[_ngcontent-%COMP%]{padding:24px 0}.pages__footer[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.pages__nav[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}}@media (max-width:480px){.pages[_ngcontent-%COMP%]{margin:12px 10% 48px;border-radius:8px;padding:24px 20px 12px}.pages__footer[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.pages__nav[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}}"],changeDetection:0}),function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);s>3&&r&&Object.defineProperty(t,n,r)}([Object(d.d)(il.getTutorial),pv("design:type",q.a)],e.prototype,"tutorial$",void 0),e})(),mv=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-tour-success"]],inputs:{inline:"inline"},decls:2,vars:2,consts:[[1,"view-tour-success"],["icon","check",1,"view-tour-success__icon"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Qb(1,"app-icon",1),i.Ub()),2&e&&i.Hb("view-tour-success--inline",t.inline)},directives:[$a],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3838}.text-info{color:#0060c4}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.view-tour-success{width:52px;height:52px;display:flex;background-color:#1bbc66;border-radius:50%;justify-content:center;align-items:center}.view-tour-success__icon{font-size:36px;letter-spacing:.9px;line-height:1.4em;color:#fff}.view-tour-success--inline{display:inline-flex;width:32px;height:32px}.view-tour-success--inline .view-tour-success__icon{font-size:18px;letter-spacing:.45px;line-height:1.4em}@media (max-width:768px){.view-tour-success{width:36px;height:36px}.view-tour-success__icon{font-size:20px;letter-spacing:.5px;line-height:1.4em}.view-tour-success--inline{display:inline-flex;width:24px;height:24px}.view-tour-success--inline .view-tour-success__icon{font-size:12px;letter-spacing:.3px;line-height:1.4em}}"],encapsulation:2,changeDetection:0}),e})(),fv=(()=>{class e{constructor(e){this.viewService=e,this.triggers=qx}ngOnInit(){}handleStartClick(){this.viewService.toggleTutorial(!1)}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(Ip))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-tour-mobile"]],decls:31,vars:5,consts:[["gaCategory","View Tutorial"],["title","Rotate",3,"trigger"],["title","Zoom",3,"trigger"],["title","Pan",3,"trigger"],["title","Explore the Anatomy",3,"trigger"],[1,"flex","justify-start","items-center"],[1,"mr-2",3,"inline"],[1,"text-semibold"],["title","Toolbar","image","assets/images/tutorial/tutorial-toolbar@3x.png"],["slide-footer","",1,"flex","flex-column","items-center","justify-center"],["gaEvent","","gaAction","Clicked Start Exploring","app-view-rounded-button","","buttonType","solid","label","Start Exploring!","aria-label","Start Exploring",1,"mt-4",3,"click"]],template:function(e,t){1&e&&(i.Vb(0,"app-view-tour-pages",0),i.Vb(1,"app-view-tour-page"),i.Vb(2,"app-view-tour-slide",1),i.Mc(3," Tap and drag with one finger to change the viewing angle. "),i.Ub(),i.Vb(4,"app-view-tour-slide"),i.Qb(5,"app-view-tour-success"),i.Ub(),i.Ub(),i.Vb(6,"app-view-tour-page"),i.Vb(7,"app-view-tour-slide",2),i.Mc(8," Pinch with two fingers to zoom in or out. "),i.Ub(),i.Vb(9,"app-view-tour-slide"),i.Qb(10,"app-view-tour-success"),i.Ub(),i.Ub(),i.Vb(11,"app-view-tour-page"),i.Vb(12,"app-view-tour-slide",3),i.Mc(13," Use two fingers to adjust the model's position. "),i.Ub(),i.Vb(14,"app-view-tour-slide"),i.Qb(15,"app-view-tour-success"),i.Ub(),i.Ub(),i.Vb(16,"app-view-tour-page"),i.Vb(17,"app-view-tour-slide",4),i.Mc(18," Tap on an individual part of the model to highlight anatomy. "),i.Ub(),i.Vb(19,"app-view-tour-slide"),i.Vb(20,"div",5),i.Vb(21,"div"),i.Qb(22,"app-view-tour-success",6),i.Vb(23,"strong",7),i.Mc(24,"Tip:"),i.Ub(),i.Mc(25," Double-tap to zoom in on specific structures. "),i.Ub(),i.Ub(),i.Ub(),i.Ub(),i.Vb(26,"app-view-tour-page"),i.Vb(27,"app-view-tour-slide",8),i.Mc(28," Use the toolbar to navigate through the 3D experience, launch deeper exploration tools, and relaunch this tutorial. "),i.Vb(29,"div",9),i.Vb(30,"button",10),i.cc("click",(function(){return t.handleStartClick()})),i.Ub(),i.Ub(),i.Ub(),i.Ub(),i.Ub()),2&e&&(i.Db(2),i.lc("trigger","camera-rotate"),i.Db(5),i.lc("trigger",t.triggers.CameraZoom),i.Db(5),i.lc("trigger",t.triggers.CameraPan),i.Db(5),i.lc("trigger",t.triggers.NodeSelection),i.Db(5),i.lc("inline",!0))},directives:[bv,J.a,lv,rv,mv,$x,J.b],styles:[""],changeDetection:0}),e})();function yv(e,t){if(1&e&&i.Qb(0,"app-icon",5),2&e){const e=i.gc(2);i.lc("icon",e.icon)}}function xv(e,t){if(1&e&&(i.Vb(0,"span",6),i.Mc(1),i.Ub()),2&e){const e=i.gc(2);i.Db(1),i.Nc(e.label)}}function vv(e,t){if(1&e&&(i.Tb(0),i.Kc(1,yv,1,1,"app-icon",3),i.Kc(2,xv,2,1,"span",4),i.Sb()),2&e){const e=i.gc();i.Db(1),i.lc("ngIf",e.icon),i.Db(1),i.lc("ngIf",e.icon)}}function wv(e,t){if(1&e&&(i.Vb(0,"span"),i.Mc(1),i.Ub()),2&e){const e=i.gc();i.Db(1),i.Oc(" ",e.label," ")}}let Ov=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-tour-tip-button"]],inputs:{label:"label",icon:"icon"},decls:3,vars:2,consts:[[1,"view-tour-tip-button","mv-1","mh-1",3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"icon",4,"ngIf"],["class","visually-hidden",4,"ngIf"],[3,"icon"],[1,"visually-hidden"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Kc(1,vv,3,2,"ng-container",1),i.Kc(2,wv,2,1,"span",2),i.Ub()),2&e&&(i.lc("ngSwitch",!!t.icon),i.Db(1),i.lc("ngSwitchCase",!0))},directives:[ms.n,ms.o,ms.p,ms.l,$a],styles:[".view-tour-tip-button{display:inline-flex;align-items:center;justify-content:center;vertical-align:middle;color:#131c2a;background-color:#fff;border-radius:2px;font-weight:700;padding:4px;width:24px;height:24px}@media (max-width:768px){.view-tour-tip-button{width:20px;height:20px}}"],encapsulation:2,changeDetection:0}),e})();var Cv=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Sv(e,t){1&e&&(i.Tb(0),i.Mc(1," Hold the control key and scroll up and down to zoom in or out. "),i.Sb())}function kv(e,t){1&e&&(i.Tb(0),i.Mc(1," Scroll up and down to zoom in or out. "),i.Sb())}let _v=(()=>{class e{constructor(e){this.viewService=e,this.triggers=qx}ngOnInit(){this.captureScroll$=this.scrollMode$.pipe(Object(k.a)(e=>e===Zo.Capture))}handleStartClick(){this.viewService.toggleTutorial(!1)}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(Ip))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-tour-desktop"]],decls:62,vars:12,consts:[["gaCategory","View Tutorial"],["title","Rotate",3,"trigger"],[1,"flex","justify-start","items-center"],[1,"mr-2",3,"inline"],[1,"text-semibold"],["icon","caret-up","label","up"],["icon","caret-down","label","down"],["icon","caret-left","label","left"],["icon","caret-right","label","right"],["title","Zoom",3,"trigger","ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["label","+"],["label","-"],["title","Pan",3,"trigger"],["label","W"],["label","A"],["label","S"],["label","D"],["title","Explore the Anatomy",3,"trigger"],["image","assets/images/tutorial/tutorial-toolbar@3x.png"],["slide-footer","",1,"flex","flex-column","items-center","justify-center"],["gaEvent","","gaAction","Clicked Start Exploring","app-view-rounded-button","","buttonType","solid","label","Start Exploring!","aria-label","Start Exploring",1,"mt-4",3,"click"]],template:function(e,t){1&e&&(i.Vb(0,"app-view-tour-pages",0),i.Vb(1,"app-view-tour-page"),i.Vb(2,"app-view-tour-slide",1),i.Mc(3," Click and drag the model to change the viewing angle. "),i.Ub(),i.Vb(4,"app-view-tour-slide"),i.Vb(5,"div",2),i.Vb(6,"div"),i.Qb(7,"app-view-tour-success",3),i.Vb(8,"strong",4),i.Mc(9,"Tip:"),i.Ub(),i.Mc(10," You can also use the arrow keys "),i.Qb(11,"app-view-tour-tip-button",5),i.Qb(12,"app-view-tour-tip-button",6),i.Qb(13,"app-view-tour-tip-button",7),i.Qb(14,"app-view-tour-tip-button",8),i.Mc(15," to rotate. "),i.Ub(),i.Ub(),i.Ub(),i.Ub(),i.Vb(16,"app-view-tour-page"),i.Vb(17,"app-view-tour-slide",9),i.hc(18,"async"),i.Kc(19,Sv,2,0,"ng-container",10),i.Kc(20,kv,2,0,"ng-container",11),i.Ub(),i.Vb(21,"app-view-tour-slide"),i.Vb(22,"div",2),i.Vb(23,"div"),i.Qb(24,"app-view-tour-success",3),i.Vb(25,"strong",4),i.Mc(26,"Tip:"),i.Ub(),i.Mc(27," You can also use "),i.Qb(28,"app-view-tour-tip-button",12),i.Mc(29," to zoom in and "),i.Qb(30,"app-view-tour-tip-button",13),i.Mc(31," to zoom out. "),i.Ub(),i.Ub(),i.Ub(),i.Ub(),i.Vb(32,"app-view-tour-page"),i.Vb(33,"app-view-tour-slide",14),i.Mc(34," Hold the shift key and drag to move the model's position. "),i.Ub(),i.Vb(35,"app-view-tour-slide"),i.Vb(36,"div",2),i.Vb(37,"div"),i.Qb(38,"app-view-tour-success",3),i.Vb(39,"strong",4),i.Mc(40,"Tip:"),i.Ub(),i.Mc(41," You can also use the "),i.Qb(42,"app-view-tour-tip-button",15),i.Qb(43,"app-view-tour-tip-button",16),i.Qb(44,"app-view-tour-tip-button",17),i.Qb(45,"app-view-tour-tip-button",18),i.Mc(46," keys to pan. "),i.Ub(),i.Ub(),i.Ub(),i.Ub(),i.Vb(47,"app-view-tour-page"),i.Vb(48,"app-view-tour-slide",19),i.Mc(49," Click on an individual part of the model to highlight anatomy. "),i.Ub(),i.Vb(50,"app-view-tour-slide"),i.Vb(51,"div",2),i.Vb(52,"div"),i.Qb(53,"app-view-tour-success",3),i.Vb(54,"strong",4),i.Mc(55,"Tip:"),i.Ub(),i.Mc(56," Double-click to zoom in on specific structures. "),i.Ub(),i.Ub(),i.Ub(),i.Ub(),i.Vb(57,"app-view-tour-page"),i.Vb(58,"app-view-tour-slide",20),i.Mc(59," Use the toolbar to navigate through the 3D experience, launch deeper exploration tools, and relaunch this tutorial. "),i.Vb(60,"div",21),i.Vb(61,"button",22),i.cc("click",(function(){return t.handleStartClick()})),i.Ub(),i.Ub(),i.Ub(),i.Ub(),i.Ub()),2&e&&(i.Db(2),i.lc("trigger",t.triggers.CameraRotate),i.Db(5),i.lc("inline",!0),i.Db(10),i.lc("trigger",t.triggers.CameraZoom)("ngSwitch",i.ic(18,10,t.captureScroll$)),i.Db(2),i.lc("ngSwitchCase",!1),i.Db(5),i.lc("inline",!0),i.Db(9),i.lc("trigger",t.triggers.CameraPan),i.Db(5),i.lc("inline",!0),i.Db(10),i.lc("trigger",t.triggers.NodeSelection),i.Db(5),i.lc("inline",!0))},directives:[bv,J.a,lv,rv,mv,Ov,ms.n,ms.o,ms.p,$x,J.b],pipes:[ms.b],styles:[""],changeDetection:0}),function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);s>3&&r&&Object.defineProperty(t,n,r)}([Object(d.d)(is.getScrollMode),Cv("design:type",q.a)],e.prototype,"scrollMode$",void 0),e})();var jv=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},Pv=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Mv(e,t){if(1&e){const e=i.Wb();i.Vb(0,"div",3),i.Vb(1,"h1",4),i.Mc(2,"Getting Started"),i.Ub(),i.Vb(3,"p",5),i.Mc(4," Welcome! This tutorial will teach you how to navigate and explore in 3D using your "),i.Qb(5,"button",6),i.hc(6,"async"),i.hc(7,"async"),i.Vb(8,"mat-menu",null,7),i.Vb(10,"button",8),i.cc("click",(function(){i.zc(e);const t=i.gc();return t.handleSelectInputModeClick(t.inputModes.Mouse)})),i.Mc(11),i.Ub(),i.Vb(12,"button",8),i.cc("click",(function(){i.zc(e);const t=i.gc();return t.handleSelectInputModeClick(t.inputModes.Touch)})),i.Mc(13),i.Ub(),i.Ub(),i.Ub(),i.Vb(14,"div",9),i.Vb(15,"button",10),i.cc("click",(function(){return i.zc(e),i.gc().handleExitClick()})),i.Ub(),i.Vb(16,"button",11),i.cc("click",(function(){return i.zc(e),i.gc().handleStartClick()})),i.Ub(),i.Ub(),i.Ub()}if(2&e){const e=i.vc(9),t=i.gc();i.Db(5),i.lc("compact",!0)("label",t.inputModesText[i.ic(6,8,t.inputMode$)])("matMenuTriggerFor",e),i.Eb("aria-label",t.inputModesText[i.ic(7,10,t.inputMode$)]),i.Db(5),i.lc("gaLabel",t.inputModesText[t.inputModes.Mouse]),i.Db(1),i.Oc(" ",t.inputModesText[t.inputModes.Mouse]," "),i.Db(1),i.lc("gaLabel",t.inputModesText[t.inputModes.Touch]),i.Db(1),i.Oc(" ",t.inputModesText[t.inputModes.Touch]," ")}}function Iv(e,t){1&e&&i.Qb(0,"app-view-tour-mobile")}function zv(e,t){1&e&&i.Qb(0,"app-view-tour-desktop")}function Tv(e,t){if(1&e&&(i.Vb(0,"div",12),i.hc(1,"async"),i.Kc(2,Iv,1,0,"app-view-tour-mobile",13),i.Kc(3,zv,1,0,"app-view-tour-desktop",14),i.Ub()),2&e){const e=i.gc();i.lc("ngSwitch",i.ic(1,2,e.inputMode$)),i.Db(2),i.lc("ngSwitchCase",e.inputModes.Touch)}}const Uv={[Zc.Mouse]:"mouse, trackpad, or keyboard",[Zc.Touch]:"touchscreen"};let Lv=(()=>{class e{constructor(e,t,n){this.store=e,this.viewService=t,this.storageService=n,this.inputModes=Zc,this.inputModesText=Uv,this.tourStarted=!1,this.tourEnded=!1,this.ngUnsubscribe=new $.a}ngOnInit(){this.initListeners(),this.store.dispatch(new Q.TutorialSeen(!0))}ngAfterViewInit(){}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initListeners(){this.tutorial$.pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(({pageIndex:e,pageSize:t})=>{this.tourStarted=e>-1,this.tourEnded=e===t-1}),Object(as.a)(window,"keyup").pipe(Object(K.a)(e=>"Escape"===e.key),Object(W.a)(this.ngUnsubscribe)).subscribe(()=>{this.exit()})}handleExitClick(){this.exit()}handleStartClick(){this.store.dispatch(new Q.StartTutorial(!1))}handleSelectInputModeClick(e){this.store.dispatch(new Q.SetInputMode(e))}exit(){this.viewService.toggleTutorial(!1)}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.g),i.Pb(Ip),i.Pb(Ar))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-tour"]],decls:3,vars:7,consts:[["gaCategory","View Tutorial","role","dialog","aria-label","Getting Started Tutorial",1,"tour"],["class","tour__intro",4,"ngIf"],["class","tour__contents",3,"ngSwitch",4,"ngIf"],[1,"tour__intro"],[1,"tour__title"],[1,"tour__welcome"],["app-view-rounded-button","","buttonType","outline","icon","chevron-down","iconPlacement","right",1,"tour__input-selection","text-small",3,"compact","label","matMenuTriggerFor"],["inputSelectionMenu","matMenu"],["gaEvent","","gaAction","Clicked Input Type","mat-menu-item","",3,"gaLabel","click"],[1,"tour__footer"],["gaEvent","","gaAction","Clicked No Thanks","app-view-rounded-button","","buttonType","outline","label","No, Thanks.","aria-label","Exit Tutorial",1,"mr-3","text-medium",3,"click"],["gaEvent","","gaAction","Clicked Start Tutorial","app-view-rounded-button","","buttonType","solid","label","Start Tutorial","aria-label","Start Tutorial",1,"ml-3","text-medium",3,"click"],[1,"tour__contents",3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Kc(1,Mv,17,12,"div",1),i.Kc(2,Tv,4,4,"div",2),i.Ub()),2&e&&(i.Hb("tour--started",t.tourStarted)("tour--ended",t.tourEnded),i.lc("@refresh",void 0),i.Db(1),i.lc("ngIf",!t.tourStarted),i.Db(1),i.lc("ngIf",t.tourStarted))},directives:[J.a,ms.l,$x,ic.d,ic.a,J.b,ic.b,ms.n,ms.o,ms.p,fv,_v],pipes:[ms.b],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3838}.text-info[_ngcontent-%COMP%]{color:#0060c4}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.tour[_ngcontent-%COMP%]{color:#fff;position:absolute;top:0;right:0;bottom:0;left:0;z-index:100;pointer-events:none;display:flex;flex-direction:column;align-items:center;overflow:auto}.tour__title[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.tour__welcome[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em;margin:16px auto 32px}.tour__intro[_ngcontent-%COMP%]{background:rgba(16,24,35,.9);border-radius:16px;margin:auto;padding:28px 32px;text-align:center;max-width:560px}.tour__input-selection[_ngcontent-%COMP%]{vertical-align:middle}.tour__header[_ngcontent-%COMP%]{flex:none;align-self:flex-end;justify-self:flex-start;margin:24px}.tour__contents[_ngcontent-%COMP%]{flex:auto;display:flex;flex-direction:column;justify-content:flex-end;width:100%}.tour__footer[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em;display:flex;flex-direction:row;align-items:center;justify-content:center}.tour__nav-arrow[_ngcontent-%COMP%]{font-size:32px;letter-spacing:.8px;line-height:1.4em;cursor:pointer}.tour--ended[_ngcontent-%COMP%]   .tour__contents[_ngcontent-%COMP%]{justify-content:center}@media (max-width:768px){.tour__intro[_ngcontent-%COMP%]{border-radius:12px;padding:20px 24px;margin:auto 12%;max-width:100%}.tour__intro__title[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.tour__intro__content[_ngcontent-%COMP%]{max-width:80%}.tour__header[_ngcontent-%COMP%], .tour__intro__content[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.tour__header[_ngcontent-%COMP%]{margin:12px}.tour__footer[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.tour__nav-arrow[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}}@media (max-width:480px){.tour__intro[_ngcontent-%COMP%]{border-radius:8px;padding:16px 20px;margin:auto 10%}.tour__intro__title[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.tour__intro__content[_ngcontent-%COMP%]{margin:12px auto 16px}.tour__header[_ngcontent-%COMP%], .tour__intro__content[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.tour__header[_ngcontent-%COMP%]{margin:12px}.tour__footer[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.tour__nav-arrow[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}}"],data:{animation:[Object(ol.n)("refresh",[Object(ol.m)(":enter",[Object(ol.o)(Um.slideTransition,{params:{duration:500,from:100,to:0}})])])]},changeDetection:0}),jv([Object(d.d)(il.getTutorial),Pv("design:type",q.a)],e.prototype,"tutorial$",void 0),jv([Object(d.d)(il.getInputMode),Pv("design:type",q.a)],e.prototype,"inputMode$",void 0),e})();var Dv=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},Ev=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const Fv=["colorBtn"];function Av(e,t){1&e&&i.Qb(0,"app-icon",19)}function Rv(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",14),i.cc("click",(function(){i.zc(e);const n=t.$implicit;return i.gc().setTextSize(n.size)})),i.Vb(1,"div",15),i.Vb(2,"div",16),i.Kc(3,Av,1,0,"app-icon",17),i.hc(4,"async"),i.Ub(),i.Vb(5,"div",18),i.Vb(6,"span"),i.Mc(7),i.Ub(),i.Ub(),i.Ub(),i.Ub()}if(2&e){const e=t.$implicit,n=i.gc();i.Db(3),i.lc("ngIf",e.size===i.ic(4,2,n.textSize$)),i.Db(4),i.Oc("",e.label,"px")}}function Nv(e,t){1&e&&i.Qb(0,"app-icon",19)}function Vv(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",14),i.cc("click",(function(){i.zc(e);const n=t.$implicit;return i.gc().setBrushSize(n.size)})),i.Vb(1,"div",15),i.Vb(2,"div",16),i.Kc(3,Nv,1,0,"app-icon",17),i.hc(4,"async"),i.Ub(),i.Vb(5,"div",18),i.Qb(6,"app-icon",20),i.Vb(7,"span"),i.Mc(8),i.Ub(),i.Ub(),i.Ub(),i.Ub()}if(2&e){const e=t.$implicit,n=i.gc();i.Db(3),i.lc("ngIf",e.size===i.ic(4,4,n.brushSize$)),i.Db(3),i.Hc("font-size",e.size,"px"),i.Db(2),i.Nc(e.label)}}function Hv(e,t){1&e&&i.Qb(0,"app-icon",19)}function Bv(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",14),i.cc("click",(function(){i.zc(e);const n=t.$implicit;return i.gc().setEraserSize(n.size)})),i.Vb(1,"div",15),i.Vb(2,"div",16),i.Kc(3,Hv,1,0,"app-icon",17),i.hc(4,"async"),i.Ub(),i.Vb(5,"div",18),i.Qb(6,"app-icon",20),i.Vb(7,"span"),i.Mc(8),i.Ub(),i.Ub(),i.Ub(),i.Ub()}if(2&e){const e=t.$implicit,n=i.gc();i.Db(3),i.lc("ngIf",e.size===i.ic(4,4,n.eraserSize$)),i.Db(3),i.Hc("font-size",e.size,"px"),i.Db(2),i.Nc(e.label)}}function Qv(e,t){1&e&&i.Qb(0,"app-icon",19)}function $v(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",14),i.cc("click",(function(){i.zc(e);const n=t.$implicit;return i.gc().setBrushColor(n.color)})),i.Vb(1,"div",15),i.Vb(2,"div",16),i.Kc(3,Qv,1,0,"app-icon",17),i.hc(4,"async"),i.Ub(),i.Vb(5,"div",18),i.Qb(6,"app-icon",20),i.Vb(7,"span"),i.Mc(8),i.Ub(),i.Ub(),i.Ub(),i.Ub()}if(2&e){const e=t.$implicit,n=i.gc();i.Db(3),i.lc("ngIf",e.color===i.ic(4,6,n.brushColor$)),i.Db(3),i.Hc("font-size",14,"px")("color",e.color),i.Db(2),i.Nc(e.label)}}let qv=(()=>{class e{constructor(e){this.store=e,this.textSizes=Hc,this.brushSizes=Vc,this.brushColors=Qc,this.eraserSizes=Bc,this.modeEnum=Ac,this.downloadClick=new i.p,this.clearClick=new i.p,this.exitClick=new i.p,this.ngUnsubscribe=new $.a}ngOnInit(){}ngAfterViewInit(){this.brushColor$.pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.colorBtn.nativeElement.style.setProperty("--pin-button-pin-color",e)}),this.hasPaint$.pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{e||this.store.selectSnapshot(il.getWhiteboardAnnotateMode)!==Ac.Erase||this.handleModeSelect(Ac.Paint)})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}setBrushSize(e){this.store.dispatch(new Q.SetWhiteboardBrushSize(e))}setBrushColor(e){this.store.dispatch(new Q.SetWhiteboardBrushColor(e))}setTextSize(e){this.store.dispatch(new Q.SetWhiteboardTextSize(e))}handleModeSelect(e){this.store.dispatch(new Q.SetWhiteboardAnnotateMode(e))}setEraserSize(e){this.store.dispatch(new Q.SetWhiteboardEraserSize(e))}handleDownloadClick(){this.downloadClick.next()}handleClearClick(){this.clearClick.next()}handleExitClick(){this.exitClick.next()}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.g))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-annotate-tools"]],viewQuery:function(e,t){if(1&e&&i.Gc(Fv,!0,i.m),2&e){let e;i.uc(e=i.dc())&&(t.colorBtn=e.first)}},outputs:{downloadClick:"downloadClick",clearClick:"clearClick",exitClick:"exitClick"},decls:31,vars:26,consts:[["gaCategory","View Whiteboard Tools",1,"view-annotate-tools"],["eventCategory","View Whiteboard Tools","name","Whiteboard","padding","dense",3,"canExit","exit"],["app-pin-button","","buttonType","ghost","icon","text-size","aria-label","Text","matTooltip","Text",1,"mr-1",3,"matMenuTriggerFor","selected","click"],["app-pin-button","","buttonType","ghost","icon","paint-brush","aria-label","Brush","matTooltip","Brush",1,"mr-1",3,"matMenuTriggerFor","selected","click"],["app-pin-button","","buttonType","ghost","icon","eraser","aria-label","Eraser","matTooltip","Eraser",3,"matMenuTriggerFor","selected","disabled","click"],["app-pin-button","","buttonType","ghost","icon","tint","aria-label","Color","matTooltip","Color",3,"matMenuTriggerFor"],["colorBtn",""],["app-pin-button","","buttonType","ghost","icon","download","aria-label","Download","matTooltip","Download",3,"click"],["app-pin-button","","buttonType","ghost","aria-label","Clear","matTooltip","Clear",3,"disabled","click"],["textSizeMenu","matMenu"],["mat-menu-item","",3,"click",4,"ngFor","ngForOf"],["brushSizeMenu","matMenu"],["eraserSizeMenu","matMenu"],["brushColorMenu","matMenu"],["mat-menu-item","",3,"click"],[1,"flex","flex-row","items-center","justify-end"],[1,"view-annotate-tools__check"],["class","mr-2","icon","check",4,"ngIf"],[1,"view-annotate-tools__label"],["icon","check",1,"mr-2"],["icon","circle",1,"mr-2"]],template:function(e,t){if(1&e&&(i.Vb(0,"div",0),i.Vb(1,"app-pillbox",1),i.cc("exit",(function(){return t.handleExitClick()})),i.Vb(2,"button",2),i.cc("click",(function(){return t.handleModeSelect(t.modeEnum.Text)})),i.hc(3,"async"),i.Ub(),i.Vb(4,"button",3),i.cc("click",(function(){return t.handleModeSelect(t.modeEnum.Paint)})),i.hc(5,"async"),i.Ub(),i.Vb(6,"button",4),i.cc("click",(function(){return t.handleModeSelect(t.modeEnum.Erase)})),i.hc(7,"async"),i.hc(8,"async"),i.Ub(),i.Qb(9,"app-pillbox-divider"),i.Qb(10,"button",5,6),i.Qb(12,"app-pillbox-divider"),i.Vb(13,"button",7),i.cc("click",(function(){return t.handleDownloadClick()})),i.Ub(),i.Qb(14,"app-pillbox-divider"),i.Vb(15,"button",8),i.cc("click",(function(){return t.handleClearClick()})),i.hc(16,"async"),i.hc(17,"async"),i.Mc(18," Clear "),i.Ub(),i.Vb(19,"mat-menu",null,9),i.Kc(21,Rv,8,4,"button",10),i.Ub(),i.Vb(22,"mat-menu",null,11),i.Kc(24,Vv,9,6,"button",10),i.Ub(),i.Vb(25,"mat-menu",null,12),i.Kc(27,Bv,9,6,"button",10),i.Ub(),i.Vb(28,"mat-menu",null,13),i.Kc(30,$v,9,8,"button",10),i.Ub(),i.Ub(),i.Ub()),2&e){const e=i.vc(20),n=i.vc(23),o=i.vc(26),s=i.vc(29);i.Db(1),i.lc("canExit",!0),i.Db(1),i.lc("matMenuTriggerFor",e)("selected",i.ic(3,14,t.mode$)===t.modeEnum.Text),i.Db(2),i.lc("matMenuTriggerFor",n)("selected",i.ic(5,16,t.mode$)===t.modeEnum.Paint),i.Db(2),i.lc("matMenuTriggerFor",o)("selected",i.ic(7,18,t.mode$)===t.modeEnum.Erase)("disabled",!i.ic(8,20,t.hasPaint$)),i.Db(4),i.lc("matMenuTriggerFor",s),i.Db(5),i.lc("disabled",!i.ic(16,22,t.hasPaint$)&&!i.ic(17,24,t.hasText$)),i.Db(6),i.lc("ngForOf",t.textSizes),i.Db(3),i.lc("ngForOf",t.brushSizes),i.Db(3),i.lc("ngForOf",t.eraserSizes),i.Db(3),i.lc("ngForOf",t.brushColors)}},directives:[J.a,Cf,Ad,Rd.c,ic.d,xf,ic.a,ms.k,ic.b,ms.l,$a],pipes:[ms.b],styles:[".view-annotate-tools__check{flex:2 1 0;color:#0060c4}.view-annotate-tools__label{display:flex;flex:6 1 0}"],encapsulation:2,changeDetection:0}),Dv([Object(d.d)(il.getWhiteboardAnnotateMode),Ev("design:type",q.a)],e.prototype,"mode$",void 0),Dv([Object(d.d)(il.getWhiteboardBrushSize),Ev("design:type",q.a)],e.prototype,"brushSize$",void 0),Dv([Object(d.d)(il.getWhiteboardTextSize),Ev("design:type",q.a)],e.prototype,"textSize$",void 0),Dv([Object(d.d)(il.getWhiteboardBrushColor),Ev("design:type",q.a)],e.prototype,"brushColor$",void 0),Dv([Object(d.d)(il.getWhiteboardEraserSize),Ev("design:type",q.a)],e.prototype,"eraserSize$",void 0),Dv([Object(d.d)(il.getWhiteboardHasPaint),Ev("design:type",q.a)],e.prototype,"hasPaint$",void 0),Dv([Object(d.d)(il.getWhiteboardHasText),Ev("design:type",q.a)],e.prototype,"hasText$",void 0),e})();const Wv=["textRef"];function Kv(e,t){if(1&e){const e=i.Wb();i.Vb(0,"div"),i.Vb(1,"div",4),i.cc("cdkDragMoved",(function(t){return i.zc(e),i.gc().dragMoved(t,"corner1")})),i.Ub(),i.Vb(2,"div",5),i.cc("cdkDragMoved",(function(t){return i.zc(e),i.gc().dragMoved(t,"corner2")})),i.Ub(),i.Vb(3,"div",6),i.cc("cdkDragMoved",(function(t){return i.zc(e),i.gc().dragMoved(t,"corner3")})),i.Ub(),i.Vb(4,"div",7),i.cc("cdkDragMoved",(function(t){return i.zc(e),i.gc().dragMoved(t,"corner4")})),i.Ub(),i.Vb(5,"div",8),i.cc("cdkDragMoved",(function(t){return i.zc(e),i.gc().translateHandleMoved(t)})),i.Ub(),i.Ub()}if(2&e){const e=i.gc();i.Db(1),i.lc("cdkDragFreeDragPosition",e.dragHandles.corner1),i.Db(1),i.lc("cdkDragFreeDragPosition",e.dragHandles.corner2),i.Db(1),i.lc("cdkDragFreeDragPosition",e.dragHandles.corner3),i.Db(1),i.lc("cdkDragFreeDragPosition",e.dragHandles.corner4),i.Db(1),i.lc("cdkDragFreeDragPosition",e.dragHandles.translate)}}const Gv=function(e){return{"whiteboard-label__label--active":e}};let Zv=(()=>{class e{constructor(e,t){this.changeDetectorRef=e,this.renderer=t,this.active=!0,this.initialized=!1,this.labelActive=new i.p,this.labelEmpty=new i.p,this.dragHandles={translate:{x:0,y:0},corner1:{x:0,y:0},corner2:{x:0,y:0},corner3:{x:0,y:0},corner4:{x:0,y:0}},this.handleCoords={translate:{x:0,y:0},corner1:{x:0,y:0},corner2:{x:0,y:0},corner3:{x:0,y:0},corner4:{x:0,y:0}},this.textareaTransform={x:0,y:0,width:110,height:40},this.handleDocumentBackspace=e=>{const{activeElement:t}=this.textRef.nativeElement;"Backspace"===e.key&&this.active&&!t&&this.deleteLabel()},this.handleTextboxMouseDown=e=>{this.active=!0,this.labelActive.next(this.id),this.refreshHandles()},this.handleDocumentMouseDown=e=>{const t=e.target.className.includes("view-annotate__canvas"),n=e.target.className.includes("whiteboard-label__label"),i=e.target.dataset.id===this.id;this.isLabelEmpty()&&!i&&this.initialized?this.deleteLabel():(t||n&&!i)&&(this.active=!1,this.changeDetectorRef.markForCheck())},this.handleTextKeyDown=e=>{if(e.stopPropagation(),this.isLabelEmpty()&&"Backspace"===e.key)return void this.deleteLabel();const t=this.textRef.nativeElement.scrollHeight,{corner1:n,corner3:i,corner4:o}=this.handleCoords,s=n.y+t;this.handleCoords.corner3=Object.assign(Object.assign({},i),{y:s}),this.handleCoords.corner4=Object.assign(Object.assign({},o),{y:s}),this.dragHandles.corner3=Object.assign({},this.handleCoords.corner3),this.dragHandles.corner4=Object.assign({},this.handleCoords.corner4),this.updateTextarea(),this.changeDetectorRef.markForCheck()}}get id(){return this._id}set id(e){this._id=e,this.initialized=!1}set color(e){this.renderer.setStyle(this.textRef.nativeElement,"color",e)}set exporting(e){e&&(this.active=!1,this.labelActive.next(void 0))}set size(e){this.renderer.setStyle(this.textRef.nativeElement,"font-size",e+"px")}ngOnInit(){this.initHandles(),this.initInteractionListeners(),setTimeout(()=>{this.textRef.nativeElement.focus(),this.initialized=!0})}ngOnDestroy(){this.textRef.nativeElement.removeEventListener("keydown",this.handleTextKeyDown),this.textRef.nativeElement.removeEventListener("mousedown",this.handleTextboxMouseDown),this.mouseDownListener(),this.backspaceListener()}initHandles(){this.textareaTransform.x=this.initialPos.x,this.textareaTransform.y=this.initialPos.y;const{x:e,y:t,width:n,height:i}=this.textareaTransform;this.dragHandles.corner1={x:e,y:t},this.dragHandles.corner2={x:e+n,y:t},this.dragHandles.corner3={x:e+n,y:t+i},this.dragHandles.corner4={x:e,y:t+i},this.dragHandles.translate={x:e+n/2,y:t+-10},this.handleCoords.corner1=Object.assign({},this.dragHandles.corner1),this.handleCoords.corner2=Object.assign({},this.dragHandles.corner2),this.handleCoords.corner3=Object.assign({},this.dragHandles.corner3),this.handleCoords.corner4=Object.assign({},this.dragHandles.corner4),this.handleCoords.translate=Object.assign({},this.dragHandles.translate),this.updateTextarea()}initInteractionListeners(){this.mouseDownListener=this.renderer.listen("document","mousedown",this.handleDocumentMouseDown),this.backspaceListener=this.renderer.listen("document","keydown",this.handleDocumentBackspace),this.textRef.nativeElement.addEventListener("mousedown",this.handleTextboxMouseDown),this.textRef.nativeElement.addEventListener("keydown",this.handleTextKeyDown)}refreshHandles(){this.dragHandles.corner1=Object.assign({},this.handleCoords.corner1),this.dragHandles.corner2=Object.assign({},this.handleCoords.corner2),this.dragHandles.corner3=Object.assign({},this.handleCoords.corner3),this.dragHandles.corner4=Object.assign({},this.handleCoords.corner4),this.dragHandles.translate=Object.assign({},this.handleCoords.translate),this.changeDetectorRef.markForCheck()}isLabelEmpty(){return""===this.textRef.nativeElement.innerText||"\n"===this.textRef.nativeElement.innerText}deleteLabel(){this.labelEmpty.next(this.id)}updateTextarea(){const{corner1:e,corner2:t,corner3:n}=this.handleCoords;this.textareaTransform.x=e.x,this.textareaTransform.y=e.y,this.textareaTransform.width=t.x-e.x,this.textareaTransform.height=n.y-t.y,this.renderer.setStyle(this.textRef.nativeElement,"transform",`translate(${this.textareaTransform.x}px, ${this.textareaTransform.y}px)`),this.renderer.setStyle(this.textRef.nativeElement,"width",this.textareaTransform.width+"px"),this.renderer.setStyle(this.textRef.nativeElement,"height",this.textareaTransform.height+"px")}updateTranslateHandle(){const{corner1:e,corner2:t}=this.handleCoords;this.handleCoords.translate={x:(t.x-e.x)/2+e.x,y:e.y+-10},this.dragHandles.translate=Object.assign({},this.handleCoords.translate)}setHandle(e,t,n){this.handleCoords[e]=Object.assign(Object.assign({},this.handleCoords[e]),{[t]:n[t]}),this.dragHandles[e]=Object.assign({},this.handleCoords[e])}addDiffToHandle(e,t){this.handleCoords[e]={x:this.handleCoords[e].x+t.x,y:this.handleCoords[e].y+t.y},this.dragHandles[e]=Object.assign({},this.handleCoords[e])}translateHandleMoved(e){const t=e.source._dragRef.getFreeDragPosition(),n={x:t.x-this.handleCoords.translate.x,y:t.y-this.handleCoords.translate.y};this.handleCoords.translate=Object.assign({},t),this.addDiffToHandle("corner1",n),this.addDiffToHandle("corner2",n),this.addDiffToHandle("corner3",n),this.addDiffToHandle("corner4",n),this.updateTextarea()}dragMoved(e,t){const n=e.source._dragRef.getFreeDragPosition();this.handleCoords[t]=Object.assign({},n),"corner1"===t&&(this.setHandle("corner2","y",n),this.setHandle("corner4","x",n)),"corner2"===t&&(this.setHandle("corner1","y",n),this.setHandle("corner3","x",n)),"corner3"===t&&(this.setHandle("corner2","x",n),this.setHandle("corner4","y",n)),"corner4"===t&&(this.setHandle("corner1","x",n),this.setHandle("corner3","y",n)),this.updateTranslateHandle(),this.updateTextarea()}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(i.i),i.Pb(i.H))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-annotate-label"]],viewQuery:function(e,t){if(1&e&&i.Gc(Wv,!0),2&e){let e;i.uc(e=i.dc())&&(t.textRef=e.first)}},inputs:{id:"id",initialPos:"initialPos",color:"color",exporting:"exporting",size:"size"},outputs:{labelActive:"labelActive",labelEmpty:"labelEmpty"},decls:4,vars:5,consts:[[1,"whiteboard-label"],[4,"ngIf"],["contenteditable","true","data-placeholder","Type..",1,"whiteboard-label__label",3,"ngClass"],["textRef",""],["cdkDrag","",1,"whiteboard-label__handle","whiteboard-label__handle--top-left",3,"cdkDragFreeDragPosition","cdkDragMoved"],["cdkDrag","",1,"whiteboard-label__handle","whiteboard-label__handle--top-right",3,"cdkDragFreeDragPosition","cdkDragMoved"],["cdkDrag","",1,"whiteboard-label__handle","whiteboard-label__handle--bottom-right",3,"cdkDragFreeDragPosition","cdkDragMoved"],["cdkDrag","",1,"whiteboard-label__handle","whiteboard-label__handle--bottom-left",3,"cdkDragFreeDragPosition","cdkDragMoved"],["cdkDrag","",1,"whiteboard-label__handle","whiteboard-label__handle--move",3,"cdkDragFreeDragPosition","cdkDragMoved"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Kc(1,Kv,6,5,"div",1),i.Qb(2,"div",2,3),i.Ub()),2&e&&(i.Db(1),i.lc("ngIf",!0===t.active),i.Db(1),i.lc("ngClass",i.oc(3,Gv,!0===t.active)),i.Eb("data-id",t.id))},directives:[ms.l,ms.i,Ao.a],styles:['.whiteboard-label[_ngcontent-%COMP%]{position:relative;z-index:1000}.whiteboard-label__handle[_ngcontent-%COMP%]{position:fixed;z-index:10;width:32px;height:32px;left:-16px;top:-16px}.whiteboard-label__handle[_ngcontent-%COMP%]:after{content:"";position:absolute;width:12px;height:12px;left:10px;top:10px;border-radius:50%;background-color:#0060c4}.whiteboard-label__handle[_ngcontent-%COMP%]:hover{cursor:pointer}.whiteboard-label__handle--top-left[_ngcontent-%COMP%]:hover{cursor:nw-resize}.whiteboard-label__handle--top-right[_ngcontent-%COMP%]:hover{cursor:ne-resize}.whiteboard-label__handle--bottom-right[_ngcontent-%COMP%]:hover{cursor:se-resize}.whiteboard-label__handle--bottom-left[_ngcontent-%COMP%]:hover{cursor:sw-resize}.whiteboard-label__handle--move[_ngcontent-%COMP%]:hover{cursor:move}.whiteboard-label__label[_ngcontent-%COMP%]{box-sizing:border-box;position:absolute;border:none;padding:5px;overflow-y:hidden}.whiteboard-label__label--active[_ngcontent-%COMP%]{box-shadow:inset 0 0 0 1px #0060c4}.whiteboard-label__label[_ngcontent-%COMP%]:focus{outline:none}.whiteboard-label__label[_ngcontent-%COMP%]:empty:before{content:attr(data-placeholder);color:rgba(55,74,104,.5)}'],changeDetection:0}),e})();var Jv=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},Xv=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const Yv=["drawCanvas"],ew=["annotateWrapper"];function tw(e,t){if(1&e){const e=i.Wb();i.Vb(0,"app-view-annotate-label",7),i.cc("labelActive",(function(t){return i.zc(e),i.gc().handleLabelActive(t)}))("labelEmpty",(function(t){return i.zc(e),i.gc().handleLabelEmpty(t)})),i.hc(1,"async"),i.Ub()}if(2&e){const e=t.$implicit,n=i.gc();i.Hb("view-annotate__label--clickthrough",i.ic(1,7,n.annotateMode$)!==n.whiteboardAnnotateMode.Text),i.lc("exporting",n.exporting)("id",e.id)("initialPos",e.pos)("color",e.color)("size",e.size)}}const nw=At.PNG;let iw=(()=>{class e{constructor(e,t,n,i,o,s){this.store=e,this.actions=t,this.viewService=n,this.clipboardService=i,this.changeRef=o,this.engineService=s,this.whiteboardAnnotateMode=Ac,this.labels=[],this.exporting=!1,this.brushSize=0,this.eraserSize=0,this.lineWidth=0,this.ngUnsubscribe=new $.a}initTextModeListener(){this.inputManager=new Hammer.Manager(this.drawCanvas.nativeElement),this.inputManager.add(new Hammer.Tap({event:"tap"})),this.inputManager.on("tap",e=>{if(this.activeLabelId)return void(this.activeLabelId=void 0);const t=Object(X.uniqueId)();var n=e.center.x,i=e.center.y;void 0!==e.pointers[0].x&&(n=e.pointers[0].x,i=e.pointers[0].y);const o=this.store.selectSnapshot(il.getWhiteboardBrushColor),s=this.store.selectSnapshot(il.getWhiteboardTextSize);this.engineService.fireEvent(it.NativeDebugMessage,"create label "+t),this.labels.push({id:t,pos:{x:n,y:i},color:o,size:s}),this.activeLabelId=t,this.changeRef.markForCheck(),this.dispatchHasText()})}handleLabelActive(e){this.activeLabelId=e;const t=this.labels.find(t=>t.id===e);t&&this.store.dispatch([new Q.SetWhiteboardTextSize(t.size),new Q.SetWhiteboardBrushColor(t.color)])}handleLabelEmpty(e){this.labels=this.labels.filter(t=>t.id!==e),this.changeRef.markForCheck(),this.dispatchHasText()}dispatchHasText(){this.engineService.fireEvent(it.NativeDebugMessage,"dispatch "+this.labels.length),this.store.dispatch(new Q.SetWhiteboardHasText(this.labels.length>0))}ngOnInit(){this.canvasElement=this.drawCanvas.nativeElement,this.canvasContext=this.canvasElement.getContext("2d"),this.siteHeader=this.store.selectSnapshot(wp.getSiteHeader),this.store.dispatch(new hp.SetHeader(fp.Hide)),this.brushColor$.pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{const t=this.labels.find(e=>e.id===this.activeLabelId);t&&(t.color=e,this.changeRef.markForCheck())}),this.textSize$.pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{const t=this.labels.find(e=>e.id===this.activeLabelId);t&&(t.size=e,this.changeRef.markForCheck())}),this.annotateMode$.pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.inputManager&&this.inputManager.destroy(),e===Ac.Paint?(this.canvasContext.globalCompositeOperation="source-over",this.setLineWidth(this.brushSize),this.initInputListeners()):e===Ac.Text?this.initTextModeListener():e===Ac.Erase&&(this.canvasContext.globalCompositeOperation="destination-out",this.setLineWidth(this.eraserSize),this.initInputListeners())})}ngAfterViewInit(){this.initCanvasListeners()}ngOnDestroy(){this.inputManager.destroy(),this.reset(),this.store.dispatch(new hp.SetHeader(this.siteHeader)),this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initCanvasListeners(){this.brushSize$.pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.setBrushSize(e)}),this.brushColor$.pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.setBrushColor(e)}),this.eraserSize$.pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.setEraserSize(e)}),this.syncCanvas()}initInputListeners(){this.inputManager=new Hammer.Manager(this.drawCanvas.nativeElement),this.inputManager.add(new Hammer.Pan({event:"pan",pointers:0})),this.inputManager.add(new Hammer.Tap({event:"tap"}));const e=new Map;this.inputManager.on("tap",e=>{e.pointers.forEach(t=>{if(void 0!==t.x){const{x:e,y:n}=t;this.drawPoint(e,n)}else{const{x:t,y:n}=e.center;this.drawPoint(t,n)}this.checkCanvasPaint()})}),this.inputManager.on("panstart",t=>{t.pointers.forEach(n=>{if(void 0===n.x)e.set(1,t.center);else{const{x:t,y:i}=n;e.set(n.pointerId,{x:t,y:i})}})}),this.inputManager.on("pan",t=>{t.pointers.forEach(n=>{var i=t.center.x,o=t.center.y,s=1;void 0!==n.pointerId&&(i=n.x,o=n.y,s=n.pointerId);const{x:r,y:a}=e.get(s);this.drawLine(r,a,i,o),this.drawPoint(i,o),e.set(s,{x:i,y:o})})}),this.inputManager.on("panend",()=>{e.clear(),this.checkCanvasPaint()})}handleResetClick(){this.reset()}handleDownloadClick(){this.exporting=!0,this.changeRef.detectChanges();const{width:e,height:t}=this.canvasElement,n=this.store.selectSnapshot(Bo.getSelectedChapterId);this.store.dispatch(new hn(n,nw,100,{width:e,height:t},"original",!0,!0,[this.annotateElement.nativeElement])).pipe(Object(Oo.a)(()=>this.actions.pipe(Object(d.j)(bn),Object(sl.a)(1))),Object(W.a)(this.ngUnsubscribe),Object(E.a)(()=>{this.exporting=!1,this.changeRef.markForCheck()})).subscribe(e=>{this.downloadSnapshot(e.blob)})}handleExitClick(){this.resetCanvas(),this.viewService.toggleWhiteboard(!1)}checkCanvasPaint(){const e=this.canvasContext.getImageData(0,0,this.canvasElement.width,this.canvasElement.height),t=new Uint32Array(e.data.buffer).some(e=>0!==e);this.store.dispatch(new Q.SetWhiteboardHasPaint(t))}drawPoint(e,t){const n=this.lineWidth/2,i=2*Math.PI;this.canvasContext.beginPath(),this.canvasContext.arc(e,t,n,0,i),this.canvasContext.fill()}drawLine(e,t,n,i){this.canvasContext.beginPath(),this.canvasContext.moveTo(e,t),this.canvasContext.lineTo(n,i),this.canvasContext.stroke(),this.canvasContext.closePath()}reset(){this.resetCanvas(),this.labels=[],this.changeRef.markForCheck(),this.dispatchHasText()}setBrushSize(e){this.brushSize=e,this.setLineWidth(e)}setBrushColor(e){this.canvasContext.fillStyle=e,this.canvasContext.strokeStyle=e}setEraserSize(e){this.eraserSize=e,this.setLineWidth(e)}setLineWidth(e){this.canvasContext.lineWidth=e,this.lineWidth=e}syncCanvas(){const e=this.store.selectSnapshot(il.getWhiteboardBrushSize),t=this.store.selectSnapshot(il.getWhiteboardBrushColor),n=this.store.selectSnapshot(il.getWhiteboardEraserSize),{width:i,height:o}=this.getScreenDimensions();this.canvasElement.width=i,this.canvasElement.height=o,this.setBrushSize(e),this.setBrushColor(t),this.setEraserSize(n),this.canvasContext.lineJoin="round"}resetCanvas(){const{width:e,height:t}=this.canvasElement;this.canvasContext.clearRect(0,0,e,t),this.store.dispatch(new Q.SetWhiteboardHasPaint(!1))}downloadSnapshot(e){const{displayName:t}=this.store.selectSnapshot(Qr.getStory),n=`${(t||"").replace(/ /g,"_").replace(/\W/g,"").toLowerCase()}_drawing.${nw===At.PNG?"png":"jpg"}`;!0===c.native||c.platform===a.SDK?xo.blobToBase64(e).pipe(Object(Oo.a)(e=>this.clipboardService.copyToClipboard(e,"image")),Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{}):xo.exportImage(e,nw,n)}getScreenDimensions(){const{innerWidth:e,innerHeight:t}=window;return{width:e,height:t}}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.g),i.Pb(d.b),i.Pb(Ip),i.Pb(qa),i.Pb(i.i),i.Pb(lt))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-annotate"]],viewQuery:function(e,t){if(1&e&&(i.Gc(Yv,!0),i.Gc(ew,!0)),2&e){let e;i.uc(e=i.dc())&&(t.drawCanvas=e.first),i.uc(e=i.dc())&&(t.annotateElement=e.first)}},decls:10,vars:15,consts:[[1,"view-annotate"],["annotateWrapper",""],["class","view-annotate__label",3,"view-annotate__label--clickthrough","exporting","id","initialPos","color","size","labelActive","labelEmpty",4,"ngFor","ngForOf"],["data-test","drawCanvas",1,"view-annotate__canvas"],["drawCanvas",""],[1,"view-annotate__tools"],[3,"clearClick","downloadClick","exitClick"],[1,"view-annotate__label",3,"exporting","id","initialPos","color","size","labelActive","labelEmpty"]],template:function(e,t){1&e&&(i.Vb(0,"div",0,1),i.hc(2,"async"),i.hc(3,"async"),i.hc(4,"async"),i.Kc(5,tw,2,9,"app-view-annotate-label",2),i.Qb(6,"canvas",3,4),i.Vb(8,"div",5),i.Vb(9,"app-view-annotate-tools",6),i.cc("clearClick",(function(){return t.handleResetClick()}))("downloadClick",(function(){return t.handleDownloadClick()}))("exitClick",(function(){return t.handleExitClick()})),i.Ub(),i.Ub(),i.Ub()),2&e&&(i.Hb("view-annotate--exporting",t.exporting)("view-annotate--cursor-paint",i.ic(2,9,t.annotateMode$)===t.whiteboardAnnotateMode.Paint)("view-annotate--cursor-erase",i.ic(3,11,t.annotateMode$)===t.whiteboardAnnotateMode.Erase)("view-annotate--cursor-text",i.ic(4,13,t.annotateMode$)===t.whiteboardAnnotateMode.Text),i.Db(5),i.lc("ngForOf",t.labels))},directives:[ms.k,qv,Zv],pipes:[ms.b],styles:[".view-annotate{position:fixed;top:0;left:0;right:0;bottom:0;z-index:20;display:flex;flex-direction:column;align-items:center;justify-content:space-between;box-shadow:inset 0 0 0 4px #38de38;padding:8px;transition:border .3s linear}.view-annotate--exporting{box-shadow:none}.view-annotate--exporting .view-annotate__tools{display:none}.view-annotate--cursor-paint:hover{cursor:url(/assets/images/cursor-whiteboard-paint.svg) 7 20,pointer}.view-annotate--cursor-erase:hover{cursor:url(/assets/images/cursor-whiteboard-erase.svg) 7 20,pointer}.view-annotate--cursor-text:hover{cursor:url(/assets/images/cursor-whiteboard-text.svg) 7 20,pointer}.view-annotate__label{position:absolute;top:0;left:0;z-index:10}.view-annotate__label--clickthrough{pointer-events:none}.view-annotate__canvas{position:fixed;top:0;left:0;right:0;bottom:0;z-index:1}.view-annotate__tools{z-index:1;right:8px;bottom:8px;position:absolute}"],encapsulation:2,changeDetection:0}),Jv([Object(d.d)(il.getWhiteboardAnnotateMode),Xv("design:type",q.a)],e.prototype,"annotateMode$",void 0),Jv([Object(d.d)(il.getWhiteboardBrushSize),Xv("design:type",q.a)],e.prototype,"brushSize$",void 0),Jv([Object(d.d)(il.getWhiteboardBrushColor),Xv("design:type",q.a)],e.prototype,"brushColor$",void 0),Jv([Object(d.d)(il.getWhiteboardTextSize),Xv("design:type",q.a)],e.prototype,"textSize$",void 0),Jv([Object(d.d)(il.getWhiteboardEraserSize),Xv("design:type",q.a)],e.prototype,"eraserSize$",void 0),e})();var ow=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let sw=(()=>{class e{constructor(e,t){this.store=e,this.changeDetectorRef=t,this.ngUnsubscribe=new $.a,this.visible=!1}beforePrint(e){this.visible=!0,this.changeDetectorRef.markForCheck()}afterPrint(e){this.visible=!1,this.changeDetectorRef.markForCheck()}ngOnInit(){this.initImageUrlListener()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initImageUrlListener(){Object(rs.b)(this.storyChapters$,this.store.select(Bo.getRegisteredThumbnails)).pipe(Object(K.a)(([e,t])=>e.length>0&&t.size>0),Object(k.a)(([e,t])=>t.get(e[0].id).urls.large),Object(ls.a)(),Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.imageUrl=e,this.changeDetectorRef.markForCheck()})}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.g),i.Pb(i.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-print"]],hostBindings:function(e,t){1&e&&i.cc("beforeprint",(function(){return t.beforePrint()}),!1,i.yc)("afterprint",(function(){return t.afterPrint()}),!1,i.yc)},decls:3,vars:1,consts:[[1,"view-print"],["src","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=",1,"view-print__scrim"],[1,"view-print__image",3,"src"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Qb(1,"img",1),i.Qb(2,"img",2),i.Ub()),2&e&&(i.Db(2),i.lc("src",t.imageUrl,i.Cc))},styles:[".view-print[_ngcontent-%COMP%]{background-color:#fff;display:none;position:absolute;top:0;left:0;width:100%;height:100%;z-index:10000;justify-content:space-around;margin:auto;margin-top:0!important}@media print{.view-print[_ngcontent-%COMP%]{display:flex}}.view-print__scrim[_ngcontent-%COMP%]{display:block;width:100%;height:100%;position:absolute;z-index:-1;top:0;right:0;bottom:0;left:0}.view-print__image[_ngcontent-%COMP%]{display:block;flex:1 1 auto;-o-object-fit:contain;object-fit:contain;margin:0 auto;z-index:1}"],changeDetection:0}),function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);s>3&&r&&Object.defineProperty(t,n,r)}([Object(d.d)(Bo.getStoryChapters),ow("design:type",q.a)],e.prototype,"storyChapters$",void 0),e})();class rw{}const aw={label:"Relevance",fields:[],ascending:!0},cw={label:"Most Recent",fields:["collection_content_createdate","update_date_time","create_date_time"],ascending:!1},lw={label:"Title (A-Z)",fields:["title"],ascending:!0},pw={label:"Title (Z-A)",fields:["title"],ascending:!1},dw={label:"Author (A-Z)",fields:["author"],ascending:!0},uw={label:"Author (Z-A)",fields:["author"],ascending:!1};var gw=function(e){return e.Enabled="enabled",e.Disabled="disabled",e.Locked="locked",e}({});class hw{constructor(){this.background={colors:null},this.uiAnnotations=!1,this.uiAudio=!1,this.uiInfo=!0,this.uiFullscreen=!0,this.uiScrubber=!1,this.uiHelp=!0,this.uiBd="",this.loadRotate=null,this.initial={button:!1,handHint:!1,play:!1},this.disableScroll={alert:!1,overlay:!1},this.uiQuiz={mode:gw.Enabled,number:void 0},this.autoLoad=!0,this.uiTour=!1,this.uiNav=!0,this.uiSearch=!0,this.uiTools=!0,this.uiUndo=!0,this.uiLabelList=!0,this.uiChapterList=!1,this.all=!1,this.collapseLabel=null,this.uiMenu=!0,this.uiAnatomyDescriptions=!1,this.uiTutorial=!1,this.uiLegend=!0,this.uiLoader=aa,this.uiWhiteboard=!0,this.uiVisibilityLayers=!0,this.uiAnatomyLabels=!0}}const bw={title:"Desktop",type:"desktop",dimensions:{width:700,height:550},orientation:"vertical"};var mw=n("P6Fj"),fw=function(e){return e.Single="share.widget.link",e.Bulk="share.widget.export",e}({});const yw={headers:new C.d({"Content-Type":"application/json; charset=utf-8"})},xw=new hw,vw={id:"embedded-human",dimensions:bw.dimensions,fullScreen:!0};let ww=(()=>{class e{constructor(e,t,n){this.http=e,this.cameraService=t,this.numberService=n}exportModels(e,t,n,i,o,s,r=!1){const a=[{label:"Title",field:"title"},{label:"URL",field:"url"},{label:"iFrame",field:"iFrame"},{label:"Author",field:"author"},{label:"Thumbnail URL",field:"thumbnail_url"},{label:"Created Date",field:"create_date_time"},{label:"Updated Date",field:"update_date_time"}];return r&&a.push({label:"Offline Package URL",field:"offline_url"}),this.getExportModels(e,t,n,i,o,s,r).pipe(Object(Oo.a)(e=>function(e,t,n=!0){const i=new mw.a,o=[];return n&&o.push(t.map(e=>e.label)),e.forEach(e=>{const n=t.map(t=>e[t.field]);o.push(n)}),new q.a(e=>{const t=i.unparse(o,{quotes:!0,header:!1});e.next(t),e.complete()})}(e,a)),Object(k.a)(e=>{const t=`BioDigital-Widgets-${(new Date).toISOString().split("T")[0]}-export.csv`,n=new Blob([e],{type:"text/csv;charset=utf-8"});return Object(jo.saveAs)(n,t),!0}))}getExportModels(e,t,n,i,o,s,r=!1){const a=s?Object(S.a)(null):this.getUAID(fw.Bulk),c=r?this.getDownloadURLs(e):Object(S.a)([]);return Object(Xs.a)(a,c).pipe(Object(k.a)(([r,a])=>e.map((e,c)=>{const{title:l,author:p,thumbnail_url:d,create_date_time:u,update_date_time:g}=e,h=this.getWidgetURL(e,t,n,null,r,o,s),b=this.getWidgetEmbed(h,i),m=this.buildThumbnailURL(d),f=a[c]||"";return{title:l,url:h,iFrame:b,author:p,thumbnail_url:m,create_date_time:Object(ms.u)(new Date(u),"shortDate","en"),update_date_time:Object(ms.u)(new Date(g),"shortDate","en"),offline_url:f}})))}generateWidgetURL(e,t,n,i,o,s,r){return(r||!o?Object(S.a)(null):this.getUAID(o)).pipe(Object(k.a)(o=>this.getWidgetURL(e,t,n,i,o,s,r)))}getWidgetURL(e,t,n,i,o,s="en",r){n=n||xw;const a="bookmark"===e.type,c={};c[a?"be":"m"]=""+(a?e.id:e.module_name);const l=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},c),this.getParamsForUIOptions(n||xw)),this.getParamsForLoadingExperience(n||xw)),this.getParamsForScrollMode(n||xw)),this.getParamsForLoadRotate(n||xw)),this.getParamsForLabelScale(n||xw)),p=Object(X.get)(n,"background.colors");if(Array.isArray(p)&&p.length>=3){const e=p.slice(0,4).map(e=>this.numberService.roundNumber(e,3));l["background.colors"]=""+e}if(i){const{eye:e,look:t,up:n}=this.cameraService.roundCamera(i,3);l.camera=""+[e.x,e.y,e.z,t.x,t.y,t.z,n.x,n.y,n.z]}r?l.dk=r.app_apikey:o&&(l.uaid=o),s&&"en"!==s&&(l.lang=s);const d=this.isCustomWidget(e.embed_url_path)?e.embed_url_path:t;return this.buildWidgetURL(d,l)}generateWidgetEmbed(e,t,n,i,o,s,r,a){return this.generateWidgetURL(e,t,n,o,s,r,a).pipe(Object(k.a)(e=>this.getWidgetEmbed(e,i)))}getWidgetEmbed(e,t){const{width:n,height:i}=t||vw.dimensions;return`<iframe\n  id="${vw.id}"\n  frameBorder="0"\n  width="${n}"\n  height="${i}"\n  allowFullScreen="${vw.fullScreen}"\n  loading="lazy"\n  src="${e}">\n</iframe>`}getImageEmbed(e,t,n){const i=("BioDigital Human: "+e).replace(/"/g,"&quot;");return`<a href="${t}" target="_blank"><img src="${n}" alt="${i}" title="${i}" /></a>`}getUAID(e){return this.http.post("/ws/user/analytics",{analytic_type:""+e,analytic_platform:"app"},yw).pipe(Object(k.a)(e=>e.id))}getDownloadURLs(e){const t=e.filter(e=>!e.favorite&&!e.unavailable).map(e=>({type:e.type,id:"module"===e.type?e.module_name:e.id}));return this.http.post("/ws/download/reserve",{content:t},{headers:{"Content-Type":"application/json"}}).pipe(Object(k.a)(t=>{const n=t.tokens;return e.map(e=>{const t=e.type,i="module"===e.type?e.module_name:e.id,o=n.find(e=>e.type===t&&e.id===i);return o&&o.token?this.buildDownloadURL(o.token):""})}),Object(_.a)(()=>Object(S.a)(e.map(()=>""))))}extendWidgetOptions(e,t){const n=this.expandWidgetOptions(t);return this.deepExtendWidgetOptions(e,n),e}getWidgetConfig(e){const t={};return Object.keys(e).forEach(n=>{const i=e[n];if(null!==i){const e=this.getConfigName(n);t[e]=i}}),t}getConfigName(e){const t=this.camelToDashCase(e).replace(/^ui-/g,"");return this.dashCaseToCamelCase(t)}getParamsForLoadingExperience(e){return e.autoLoad?e.initial.button?{"initial.button":!0}:e.initial.handHint?{"initial.hand":!0}:e.initial.play?{"initial.play":!0}:{}:{"auto-load":!1}}getParamsForScrollMode(e){return e.disableScroll.alert?{"disable-scroll.alert":!0}:e.disableScroll.overlay?{"disable-scroll":!0}:{"disable-scroll":!1}}getParamsForLoadRotate(e){return"number"==typeof e.loadRotate?{"load-rotate":e.loadRotate}:{}}getParamsForLabelScale(e){return{}}getParamsForUIOptions(e){return Object.assign({"ui-info":e.uiInfo,"ui-search":e.uiSearch,"ui-undo":e.uiUndo,"ui-fullscreen":e.uiFullscreen,"ui-nav":e.uiNav,"ui-tools":e.uiTools,"ui-help":e.uiHelp,"ui-chapter-list":e.uiChapterList,"ui-label-list":e.uiLabelList,"ui-anatomy-descriptions":e.uiAnatomyDescriptions,"ui-tutorial":e.uiTutorial,"ui-loader":e.uiLoader,"ui-whiteboard":e.uiWhiteboard,"ui-layers":e.uiVisibilityLayers,"ui-anatomy-labels":e.uiAnatomyLabels},this.getParamsForUIQuiz(e))}getParamsForUIQuiz(e){const t={},n=Object(X.get)(e,"uiQuiz.mode"),i=Object(X.get)(e,"uiQuiz.number");return n===gw.Disabled&&(t["ui-quiz"]=!1),n===gw.Locked&&(t["ui-quiz-locked"]=!0),Object(X.isNil)(i)||(t["ui-quiz-start"]=i,t["ui-quiz-end"]=i),t}camelToDashCase(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}dashCaseToCamelCase(e){return e.replace(/-([a-z])/g,e=>e[1].toUpperCase())}isCustomWidget(e){return/widgets\/([^\/]+)\//.test(e)}saveUserImage(e,t="jpeg"){return this.http.post("/ws/user/image/v1-0",{image_src:e,image_type:t},yw).pipe(Object(k.a)(e=>e.url))}buildWidgetURL(e,t){const n=Object.entries(t).map(([e,t])=>`${e}=${t}`).join("&"),i=e.replace(/^\/|\/$/g,"");return c.deploy===r.Local?"https://localhost:4202/?"+n:`${window.location.origin}/${i}/?${n}`}buildThumbnailURL(e){return`${window.location.origin}${e}`}buildDownloadURL(e){return`${window.location.origin}/download?t=${e}`}deepExtendWidgetOptions(e,t){Object.entries(e).forEach(([n,i])=>{const o=typeof i;[n,this.camelToDashCase(n),this.getConfigName(n)].forEach(s=>{if(t.hasOwnProperty(s)&&null!==t[s]){const r=t[s],a=typeof r;null===i?e[n]=r:o===a&&("object"===o?this.deepExtendWidgetOptions(i,r):e[n]=r)}})})}expandWidgetOptions(e){const t={};return Object.entries(e).forEach(([n,i])=>{const o=n.split(".");if(o.length>1){const e=o[0],n=o.slice(1).join(".");null!==t[e]&&"object"==typeof t[e]||(t[e]={}),t[e][n]=i}else t[n]=e[n]}),t}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(C.b),i.Zb(Lt),i.Zb(Ut))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();class Ow{}var Cw=function(e){return e.AssignRole="assignRole",e.RemoveUser="removeUser",e.TransferContent="transferContent",e.CreateCollection="createCollection",e.DeleteCollection="deleteCollection",e.EditTeamBookmarks="editTeamBookmarks",e.EditAllTeamBookmarks="editAllTeamBookmarks",e.AddTeamBookmarks="addTeamBookmarks",e.RemoveTeamBookmarks="removeTeamBookmarks",e.EditBookmarks="editBookmarks",e.PublishBookmarks="publishBookmarks",e.SavePrivateBookmarks="savePrivateBookmarks",e.CopyUrl="copyURL",e.ViewBookmarks="viewBookmarks",e.InviteUsers="inviteUsers",e}({}),Sw=function(e){return e.Admin="admin",e.Creator="creator",e.Viewer="viewer",e}({});const kw=[Cw.InviteUsers,Cw.ViewBookmarks,Cw.CopyUrl,Cw.SavePrivateBookmarks,Cw.PublishBookmarks],_w=[...kw,Cw.EditBookmarks,Cw.RemoveTeamBookmarks,Cw.AddTeamBookmarks,Cw.EditTeamBookmarks],jw=[..._w,Cw.EditAllTeamBookmarks,Cw.CreateCollection,Cw.TransferContent,Cw.RemoveUser,Cw.AssignRole],Pw={role_id:void 0,role_name:Sw.Creator,role_display_name:"",role_description:"",permissions:[..._w]},Mw={[Sw.Viewer]:kw,[Sw.Creator]:_w,[Sw.Admin]:jw},Iw={[Sw.Viewer]:"Can view team content and edit personal content",[Sw.Creator]:"Can edit and view team content",[Sw.Admin]:"Can manage team settings and edit all content"};function zw(e){const t=Object(X.get)(e,"role_name",Pw.role_name),n=Object(X.get)(e,"role_description",Iw[t]),i=Object(X.get)(e,"permissions",void 0);return Object.assign(Object.assign({},e),{role_description:n,permissions:Object(X.isNil)(i)?(o=t,Mw[o]||[]):i});var o}const Tw="/ws/enterprise/collection";let Uw=(()=>{class e{constructor(e,t){this.http=e,this.bookmarkService=t}getOrganizationUsers(e){const t=Object.entries(e).filter(([e,t])=>!Object(X.isNil)(t)).map(([e,t])=>`${e}=${encodeURIComponent(t)}`).join("&");return this.http.get("/ws/enterprise/users?"+t).pipe(Object(k.a)(e=>e.users),Object(k.a)(e=>e.map(e=>Object.assign(Object.assign({},e),{user_role:zw(e.user_role)}))))}sendOrganizationInvites(e,t){return this.http.post("/ws/enterprise/invite",{group_eid:e,invite_emails:JSON.stringify(t)}).pipe(Object(k.a)(e=>{const{messages:t}=e.results_summary;return JSON.parse(t)}))}getCollections(e){return this.http.get(`${Tw}?group_id=${e}`).pipe(Object(k.a)(e=>Object(I.plainToClass)(Ow,e).map(e=>this.normalizeCollectionModel(e))))}getCollectionsByContent(e,t,n=!1,i){if(n&&!i)throw new Error("collectionId must be included when includeContent is set to true");const{content_type:o,content_id:s}=t;let r=`${Tw}?group_id=${e}&content_type=${o}&content_id=${s}&include_content=${n?1:0}`;return n&&(r=`${r}&collection_id=${i}`),this.http.get(r).pipe(Object(k.a)(e=>Object(I.plainToClass)(Ow,e).map(e=>this.normalizeCollectionModel(e))))}getCollectionContentId(e,t){const{content_type:n,content_id:i}=t;return this.getCollectionsByContent(e.group_id,t,!0,e.collection_id).pipe(Object(k.a)(t=>t.find(t=>t.collection_id===e.collection_id)),Object(k.a)(e=>{let t;return e&&(t=e.collection_content.find(e=>"module"===n?i===e.module_name:i===e.id)),t?t.collection_content_id:null}))}getCollection(e,t,n){return this.http.get(`${Tw}?group_id=${e}&collection_id=${t}&include_content=${n?1:0}`).pipe(Object(k.a)(e=>{const t=e[0];return t?this.normalizeCollectionModel(t):t}))}getCollectionContent(e,t,n=""){const i=n.toLocaleLowerCase().split(" ");return this.getCollection(e,t,!0).pipe(Object(k.a)(e=>e.collection_content.map(e=>Object(I.plainToClass)(px,e)).filter(e=>{let t=!0;return i.length&&e.title&&i.forEach(n=>{t=t&&e.title.toLocaleLowerCase().indexOf(n)>=0}),t=t&&!0!==e.unavailable,t})))}addToCollection(e,t){return this.formPost(Tw,{group_id:e.group_id,collection_id:e.collection_id,add_content:t}).pipe(Object(k.a)(e=>e.map(e=>this.normalizeCollectionModel(e))))}removeFromCollection(e,t){return this.formPost(Tw,{group_id:e.group_id,collection_id:e.collection_id,remove_content:t}).pipe(Object(k.a)(e=>e.map(e=>this.normalizeCollectionModel(e))))}getOrganizationAttribute(e,t,n){return e.find(e=>e.type===t&&e.name===n)}addUserToOrganization(e){return this.http.post("/ws/enterprise/user/add",{group_eid:e})}addUserWithGroupCode(e){return this.http.post("/ws/enterprise/user/add",{group_code:e}).pipe(Object(k.a)(e=>e.organization_name))}updateUserRoles(e,t){return this.http.post("/ws/enterprise/users",{group_id:e,update_users:t.map(e=>({user_id:e.userId,role_id:e.roleId}))}).pipe(Object(k.a)(()=>!0))}removeUsers(e,t){return this.http.post("/ws/enterprise/users",{group_id:e,remove_users:t.map(e=>this.createTransferRequest(e))}).pipe(Object(k.a)(()=>!0))}transferUserContent(e,t){return this.http.post("/ws/enterprise/bookmark/transfer",{group_id:e,transfer_bookmarks:t.map(e=>this.createTransferRequest(e))})}createTransferRequest(e){const{sourceUserId:t,targetUserId:n}=e;return"number"==typeof n?{user_id:t,group_bookmarks:{transfer_ownership:1,transfer_user_id:n}}:{user_id:t}}normalizeCollectionModel(e){return e.collection_content&&e.collection_content.forEach(e=>{this.bookmarkService.normalizeBookmarkModel(e)}),e}formPost(e,t){const n={headers:new C.d({"Content-Type":"application/x-www-form-urlencoded"})},i=new URLSearchParams;return Object.keys(t).forEach(e=>{const n=t[e],o=""+(n instanceof Object?JSON.stringify(n):n);i.set(e,o)}),this.http.post(""+e,i.toString(),n).pipe(Object(k.a)(e=>e))}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(C.b),i.Zb(Ox))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function Lw(e,t,n){const i=t.map(t=>e[t]).filter(e=>!Object(X.isNil)(e));return n?i.sort().shift():i.sort().pop()}function Dw(e,t,n){if(0===t.length)return e;const i=new Intl.Collator("en-US",{sensitivity:"base"});return e.sort((e,o)=>{const s=Lw(e,t,n)||"",r=Lw(o,t,n)||"";return(n?1:-1)*i.compare(s.toString(),r.toString())})}class Ew{}var Fw=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},Aw=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Rw=function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function r(e){try{c(i.next(e))}catch(t){s(t)}}function a(e){try{c(i.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,a)}c((i=i.apply(e,t||[])).next())}))};const Nw={loading:!0,exporting:!1,copying:!1,saving:!1,bookmarks:[],selectedBookmark:null,sort:cw,checkedBookmarks:[],selectedCategory:null};let Vw=(()=>{let e=class{constructor(e,t,n,i,o,s,r,a,c){this.store=e,this.actions=t,this.bookmarksService=n,this.storyService=i,this.exploreService=o,this.publishService=s,this.organizationsService=r,this.snackbar=a,this.pendoService=c}static getBookmarks(e){const{bookmarks:t,sort:n}=e,{ascending:i,fields:o}=n;return Dw(t,o,i)}static getCheckedBookmarks(e){return e.checkedBookmarks}static getSelectedBookmark(e){return e.selectedBookmark}static getLoading(e){return e.loading}static getExporting(e){return e.exporting}static getSaving(e){return e.saving}static getCopying(e){return e.copying}static getSort(e){return e.sort}static getSelectedCategory(e){return e.selectedCategory}loadBookmarks(e,t){e.patchState({loading:!0,bookmarks:[],checkedBookmarks:[]}),Object(Xs.a)(this.bookmarksService.getPrivateBookmarks(t.query),this.bookmarksService.getPrivateConditions(t.query),this.bookmarksService.getFavorites()).pipe(Object(E.a)(()=>{e.patchState({loading:!1})})).subscribe(([t,n,i])=>{e.dispatch(new Dl([...t,...n,...i]))})}loadOrganizationBookmarks(e,{organizationId:t}){e.patchState({loading:!0,bookmarks:[],checkedBookmarks:[]}),this.bookmarksService.getOrganizationContent(t).pipe(Object(E.a)(()=>{e.patchState({loading:!1})})).subscribe(t=>{e.dispatch(new Dl(t))})}loadCollectionBookmarks(e,t){e.patchState({loading:!0,bookmarks:[],checkedBookmarks:[]}),this.organizationsService.getCollectionContent(t.organizationId,t.collectionId).pipe(Object(E.a)(()=>{e.patchState({loading:!1})})).subscribe(t=>{e.dispatch(new Dl(t))})}loadSuccess({patchState:e},t){e({bookmarks:t.result})}loadBookmark(e,t){const{id:n,type:i}=t;("bookmark"===i?this.bookmarksService.getBookmarkModel(n):this.exploreService.getConditionModel(n)).subscribe(t=>{e.dispatch(new Ll(t))})}selectBookmarkSuccess(e,t){e.patchState({selectedBookmark:t.bookmark})}saveBookmark(e,t){return Rw(this,void 0,void 0,(function*(){const n=t.bookmarkEntry;let i;e.patchState({saving:!0});const o=this.store.selectSnapshot(Bo.getStoryChapters),s=!1===t.inplace,r=qi.makeChapterIdMap(o,s);s&&(yield this.store.dispatch(new vi.UpdateTweenParticleLookupChapters(r)).toPromise()),t.includeIndex&&(i=this.bookmarksService.createBookmarkStory(r),n.index=i.story);const a=n.id?"update":"save";this.bookmarksService.saveBookmark(n).pipe(Object(E.a)(()=>{e.patchState({saving:!1})})).subscribe(o=>{if(t.includeIndex){const t=this.store.selectSnapshot(Bo.getRegisteredThumbnails);e.dispatch(new ql(a,o.id,n,t,Object(X.invert)(r)))}const s=i?i.story:null;n.addCollection||n.removeCollection?(e.dispatch(new tp(o,n.addCollection,n.removeCollection)),this.actions.pipe(Object(d.j)(np,ip),Object(sl.a)(1)).subscribe(()=>{e.dispatch(new Nl(o,s,a))})):e.dispatch(new Nl(o,s,a))},t=>{e.dispatch(new Vl(n))}),this.pendoService.track("Bookmark Save - Start")}))}saveBookmarkSuccess(e,t){const n=t.bookmark,i=e.getState().bookmarks,o=i.findIndex(e=>e.id===n.id);-1!==o&&(i[o]=n,e.patchState({bookmarks:[...i]})),"save"===t.method&&e.patchState({selectedBookmark:t.bookmark}),this.pendoService.track("Bookmark Save - Success")}saveBookmarkFail(e,t){this.pendoService.track("Bookmark Save - Failure")}deleteBookmark(e,t){const n=t.bookmarkId;this.bookmarksService.deleteBookmark(n).subscribe(()=>{e.dispatch(new Fl(n))},t=>{e.dispatch(new Al(n,t))})}deleteBookmarkSuccess(e,t){const n=e.getState().bookmarks.filter(e=>e.id!==t.bookmarkId);e.patchState({bookmarks:[...n]}),this.snackbar.open("Successfully deleted 3D model")}deleteFail(e,t){this.snackbar.open("There was an error deleting the 3D model")}deleteFavorite(e,t){const n=t.bookmark,i=n.id,o=Object(X.get)(n,"category","bookmark"),s="bookmark"===o?i:this.exploreService.toDatabaseContentId(i);this.bookmarksService.deleteFavorite(s,o).subscribe(()=>{e.dispatch(new Ql(i))},t=>{e.dispatch(new $l(i))})}deleteFavoriteSuccess(e,t){const n=e.getState().bookmarks.filter(e=>e.id!==t.bookmarkId);e.patchState({bookmarks:[...n]}),this.snackbar.open("Successfully deleted 3D model")}sortBookmarks(e,t){const n=e.getState().bookmarks;e.patchState({sort:t.sort,bookmarks:[...n]})}clearBookmarks(e,t){e.patchState({bookmarks:[],checkedBookmarks:[]})}resetBookmarks(e,t){e.setState(Nw)}checkBookmark(e,t){let n=e.getState().checkedBookmarks;const i=n.some(e=>e===t.id);t.checked&&!i?n=[...n,t.id]:t.checked||(n=n.filter(e=>e!==t.id)),e.patchState({checkedBookmarks:n})}setCheckedBookmarks(e,t){e.patchState({checkedBookmarks:t.ids})}saveBookmarkThumbnails(e,t){const n=t.chapterIdMap,i=t.thumbnails,o=this.bookmarksService.saveBookmarkThumbnails(t.bookmarkId,t.bookmarkEntry,i,n);if("update"===t.method){const e=this.bookmarksService.deleteBookmarkThumbnails(t.bookmarkId,t.bookmarkEntry,i,n);for(const t of e)o.push(t)}Object(Xs.a)(o).subscribe(n=>{e.dispatch(new un(new Map)).subscribe(()=>{e.dispatch(new un(t.thumbnails))})})}exportBookmarks(e,t){const{bookmarks:n,widgetURL:i,widgetOptions:o,offlineEnabled:s}=t,r=o||new hw;e.patchState({exporting:!0}),this.publishService.exportModels(n,i,r,null,t.userLanguage,t.userApp,s).pipe(Object(E.a)(()=>{e.patchState({exporting:!1})})).subscribe(t=>{e.dispatch(t?new Yl(n):new ep(n))})}updateBookmarkCollection(e,t){const{bookmark:n,addCollection:i,removeCollection:o}=t,s={content_type:n.type,content_id:n.id},r=[];o&&r.push(this.organizationsService.getCollectionContentId(o,s).pipe(Object(K.a)(e=>!!e),Object(Oo.a)(e=>this.organizationsService.removeFromCollection(o,[e])),Object(Et.a)(()=>e.dispatch(new rp(n,o)),()=>e.dispatch(new ap(n,o))))),i&&r.push(this.organizationsService.addToCollection(i,[s]).pipe(Object(Et.a)(()=>e.dispatch(new op(n,o)),()=>e.dispatch(new sp(n,o))))),Object(wo.a)(...r).subscribe(()=>e.dispatch(new np(n,i,o)),()=>e.dispatch(new ip(n,i,o)))}removeBookmarkCollectionSuccess(e,t){const{bookmarks:n,selectedCategory:i}=e.getState();if("collection"===i){const i=t.bookmark.id,o=n.filter(e=>e.id!==i);e.patchState({bookmarks:[...o]})}}copyBookmark(e,t){return Rw(this,void 0,void 0,(function*(){const{groupAccess:n,collection:i}=t;let o;e.patchState({copying:!0,saving:!0});const r=yield this.bookmarksService.copyBookmark(t.id,t.type,t.lang).toPromise().catch(n=>{e.dispatch(new pp(t.id,n))});if(!r)return void e.dispatch(new pp(t.id,null));const[a,c]=yield Promise.all([this.storyService.getStory(t.id,t.type).toPromise(),this.storyService.getStory(r,s.Bookmark).toPromise()]),l=a.chapters.map(e=>e.id).reduce((e,t,n)=>(e[t]=c.chapters[n].id,e),{}),p=Object(X.mapKeys)(c.tweenParticleLookup,(e,t)=>l[t]);c.tweenParticleLookup=p;const d=new Ew;d.title=t.title,d.isOwner=!0,d.id=r,d.index=c,n&&(d.add_group_access=[n]);try{o=yield this.bookmarksService.saveBookmark(d).toPromise()}catch(u){403===Object(X.get)(u,"status")&&(o=yield this.bookmarksService.getBookmarkModel(r).toPromise())}if(n&&i){const e=[{content_type:"bookmark",content_id:r}];yield this.organizationsService.addToCollection(i,e).toPromise()}e.patchState({copying:!1,saving:!1}),e.dispatch(new lp(r,t.id,o))}))}setBookmarkText(e,t){const n=e.getState().selectedBookmark;e.patchState({selectedBookmark:Object.assign(Object.assign({},n),{title:t.title})})}setSelectedCategory(e,{category:t}){e.patchState({selectedCategory:t||null})}cancelSaveBookmark(e,t){e.patchState({saving:!1})}cancelCopyBookmark(e,t){e.patchState({copying:!1})}};return e.\u0275fac=function(t){return new(t||e)(i.Zb(d.g),i.Zb(d.b),i.Zb(Ox),i.Zb(sr),i.Zb(yx),i.Zb(ww),i.Zb(Uw),i.Zb(Wa.b),i.Zb(ee))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac}),Fw([Object(d.a)(Il),Aw("design:type",Function),Aw("design:paramtypes",[Object,Il]),Aw("design:returntype",void 0)],e.prototype,"loadBookmarks",null),Fw([Object(d.a)(zl),Aw("design:type",Function),Aw("design:paramtypes",[Object,zl]),Aw("design:returntype",void 0)],e.prototype,"loadOrganizationBookmarks",null),Fw([Object(d.a)(Tl),Aw("design:type",Function),Aw("design:paramtypes",[Object,Tl]),Aw("design:returntype",void 0)],e.prototype,"loadCollectionBookmarks",null),Fw([Object(d.a)(Dl),Aw("design:type",Function),Aw("design:paramtypes",[Object,Dl]),Aw("design:returntype",void 0)],e.prototype,"loadSuccess",null),Fw([Object(d.a)(Ul),Aw("design:type",Function),Aw("design:paramtypes",[Object,Ul]),Aw("design:returntype",void 0)],e.prototype,"loadBookmark",null),Fw([Object(d.a)(Ll),Aw("design:type",Function),Aw("design:paramtypes",[Object,Ll]),Aw("design:returntype",void 0)],e.prototype,"selectBookmarkSuccess",null),Fw([Object(d.a)(Rl),Aw("design:type",Function),Aw("design:paramtypes",[Object,Rl]),Aw("design:returntype",Promise)],e.prototype,"saveBookmark",null),Fw([Object(d.a)(Nl),Aw("design:type",Function),Aw("design:paramtypes",[Object,Nl]),Aw("design:returntype",void 0)],e.prototype,"saveBookmarkSuccess",null),Fw([Object(d.a)(Vl),Aw("design:type",Function),Aw("design:paramtypes",[Object,Vl]),Aw("design:returntype",void 0)],e.prototype,"saveBookmarkFail",null),Fw([Object(d.a)(El),Aw("design:type",Function),Aw("design:paramtypes",[Object,El]),Aw("design:returntype",void 0)],e.prototype,"deleteBookmark",null),Fw([Object(d.a)(Fl),Aw("design:type",Function),Aw("design:paramtypes",[Object,Fl]),Aw("design:returntype",void 0)],e.prototype,"deleteBookmarkSuccess",null),Fw([Object(d.a)([Al,$l]),Aw("design:type",Function),Aw("design:paramtypes",[Object,Object]),Aw("design:returntype",void 0)],e.prototype,"deleteFail",null),Fw([Object(d.a)(Bl),Aw("design:type",Function),Aw("design:paramtypes",[Object,Bl]),Aw("design:returntype",void 0)],e.prototype,"deleteFavorite",null),Fw([Object(d.a)(Ql),Aw("design:type",Function),Aw("design:paramtypes",[Object,Ql]),Aw("design:returntype",void 0)],e.prototype,"deleteFavoriteSuccess",null),Fw([Object(d.a)(Gl),Aw("design:type",Function),Aw("design:paramtypes",[Object,Gl]),Aw("design:returntype",void 0)],e.prototype,"sortBookmarks",null),Fw([Object(d.a)(Kl),Aw("design:type",Function),Aw("design:paramtypes",[Object,Kl]),Aw("design:returntype",void 0)],e.prototype,"clearBookmarks",null),Fw([Object(d.a)(Wl),Aw("design:type",Function),Aw("design:paramtypes",[Object,Wl]),Aw("design:returntype",void 0)],e.prototype,"resetBookmarks",null),Fw([Object(d.a)(Zl),Aw("design:type",Function),Aw("design:paramtypes",[Object,Zl]),Aw("design:returntype",void 0)],e.prototype,"checkBookmark",null),Fw([Object(d.a)(Jl),Aw("design:type",Function),Aw("design:paramtypes",[Object,Jl]),Aw("design:returntype",void 0)],e.prototype,"setCheckedBookmarks",null),Fw([Object(d.a)(ql),Aw("design:type",Function),Aw("design:paramtypes",[Object,ql]),Aw("design:returntype",void 0)],e.prototype,"saveBookmarkThumbnails",null),Fw([Object(d.a)(Xl),Aw("design:type",Function),Aw("design:paramtypes",[Object,Xl]),Aw("design:returntype",void 0)],e.prototype,"exportBookmarks",null),Fw([Object(d.a)(tp),Aw("design:type",Function),Aw("design:paramtypes",[Object,tp]),Aw("design:returntype",void 0)],e.prototype,"updateBookmarkCollection",null),Fw([Object(d.a)(rp),Aw("design:type",Function),Aw("design:paramtypes",[Object,rp]),Aw("design:returntype",void 0)],e.prototype,"removeBookmarkCollectionSuccess",null),Fw([Object(d.a)(cp),Aw("design:type",Function),Aw("design:paramtypes",[Object,cp]),Aw("design:returntype",Promise)],e.prototype,"copyBookmark",null),Fw([Object(d.a)(up),Aw("design:type",Function),Aw("design:paramtypes",[Object,up]),Aw("design:returntype",void 0)],e.prototype,"setBookmarkText",null),Fw([Object(d.a)(gp),Aw("design:type",Function),Aw("design:paramtypes",[Object,gp]),Aw("design:returntype",void 0)],e.prototype,"setSelectedCategory",null),Fw([Object(d.a)(Hl),Aw("design:type",Function),Aw("design:paramtypes",[Object,Hl]),Aw("design:returntype",void 0)],e.prototype,"cancelSaveBookmark",null),Fw([Object(d.a)(dp),Aw("design:type",Function),Aw("design:paramtypes",[Object,dp]),Aw("design:returntype",void 0)],e.prototype,"cancelCopyBookmark",null),Fw([Object(d.e)(),Aw("design:type",Function),Aw("design:paramtypes",[rw]),Aw("design:returntype",void 0)],e,"getBookmarks",null),Fw([Object(d.e)(),Aw("design:type",Function),Aw("design:paramtypes",[rw]),Aw("design:returntype",void 0)],e,"getCheckedBookmarks",null),Fw([Object(d.e)(),Aw("design:type",Function),Aw("design:paramtypes",[rw]),Aw("design:returntype",void 0)],e,"getSelectedBookmark",null),Fw([Object(d.e)(),Aw("design:type",Function),Aw("design:paramtypes",[rw]),Aw("design:returntype",void 0)],e,"getLoading",null),Fw([Object(d.e)(),Aw("design:type",Function),Aw("design:paramtypes",[rw]),Aw("design:returntype",void 0)],e,"getExporting",null),Fw([Object(d.e)(),Aw("design:type",Function),Aw("design:paramtypes",[rw]),Aw("design:returntype",void 0)],e,"getSaving",null),Fw([Object(d.e)(),Aw("design:type",Function),Aw("design:paramtypes",[rw]),Aw("design:returntype",void 0)],e,"getCopying",null),Fw([Object(d.e)(),Aw("design:type",Function),Aw("design:paramtypes",[rw]),Aw("design:returntype",void 0)],e,"getSort",null),Fw([Object(d.e)(),Aw("design:type",Function),Aw("design:paramtypes",[rw]),Aw("design:returntype",void 0)],e,"getSelectedCategory",null),e=Fw([Object(d.f)({name:"bookmarks",defaults:Nw})],e),e})();var Hw=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Bw(e,t){if(1&e){const e=i.Wb();i.Vb(0,"div",1),i.Vb(1,"app-message-toggle",2),i.cc("handleDismiss",(function(){return i.zc(e),i.gc().handleDismiss()})),i.Vb(2,"div"),i.Mc(3," This model is not optimized for use on mobile devices. For an optimal experience, please switch to a desktop device or try our Anatomy by Regions. "),i.Ub(),i.Ub(),i.Ub()}2&e&&(i.Db(1),i.lc("dismiss",!0))}let Qw=(()=>{class e{constructor(e){this.changeRef=e,this.shown=!1,this.ngUnsubscribe=new $.a}ngOnInit(){this.bookmark$.pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{const t=Object(X.get)(e,"tags",[]);this.shown=t.includes("complete anatomy"),this.changeRef.markForCheck()})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}handleDismiss(){this.shown=!1,this.changeRef.markForCheck()}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(i.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-content-warning"]],decls:2,vars:3,consts:[["class","warning",4,"ngIf"],[1,"warning"],["type","warning","toggleStyle","flat","icon","info-circle",3,"dismiss","handleDismiss"]],template:function(e,t){1&e&&(i.Kc(0,Bw,4,1,"div",0),i.hc(1,"async")),2&e&&i.lc("ngIf",i.ic(1,1,t.bookmark$)&&t.shown)},directives:[ms.l,Am],pipes:[ms.b],styles:[".warning{position:fixed;top:0;left:0;right:0;z-index:1001}.warning__text{text-align:center;flex:1}"],encapsulation:2,changeDetection:0}),function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);s>3&&r&&Object.defineProperty(t,n,r)}([Object(d.d)(Vw.getSelectedBookmark),Hw("design:type",q.a)],e.prototype,"bookmark$",void 0),e})();var $w=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},qw=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const Ww=["engineContainer"],Kw=["viewContainer"],Gw=["view"],Zw=["viewCameraBar"],Jw=["viewLogo"],Xw=["viewSceneBase"],Yw=["viewToolbar"],eO=["drawer"];function tO(e,t){1&e&&i.Qb(0,"app-view-column-container")}function nO(e,t){1&e&&(i.Vb(0,"div",25),i.Qb(1,"app-view-title",26),i.Ub())}function iO(e,t){if(1&e){const e=i.Wb();i.Vb(0,"div",27),i.Vb(1,"app-notification",28),i.cc("closeClick",(function(t){return i.zc(e),i.gc().handleNotificationClose(t)})),i.Ub(),i.Ub()}if(2&e){const e=i.gc();i.Db(1),i.lc("notification",e.notification)}}function oO(e,t){1&e&&(i.Vb(0,"div",29),i.Qb(1,"app-view-undo"),i.Ub())}function sO(e,t){1&e&&i.Qb(0,"app-view-toolbar",30)}function rO(e,t){1&e&&(i.Vb(0,"div",31),i.Qb(1,"app-view-menu",32),i.Ub())}function aO(e,t){if(1&e&&(i.Vb(0,"div",33),i.Qb(1,"app-view-logo",34),i.hc(2,"async"),i.Ub()),2&e){const e=i.gc();i.Db(1),i.lc("logoColor",e.isBackgroundLight?"color":"white")("logoSize",i.ic(2,2,e.breakpoint$)>e.breakpoint.Small?"full":"small")}}function cO(e,t){if(1&e&&i.Qb(0,"app-engine-camera-bar",35),2&e){const e=i.gc();i.lc("showNav",e.cameraVisible)}}function lO(e,t){if(1&e){const e=i.Wb();i.Tb(0),i.Vb(1,"app-view-drawer",36,37),i.cc("offsetYChange",(function(t){return i.zc(e),i.gc().handleDrawerOffsetChange(t)})),i.Ub(),i.Sb()}}function pO(e,t){1&e&&i.Qb(0,"div",38)}function dO(e,t){if(1&e&&(i.Qb(0,"app-view-help",39),i.hc(1,"async")),2&e){const e=i.gc();i.lc("activeTab",i.ic(1,1,e.showHelpTab$))}}function uO(e,t){if(1&e&&i.Qb(0,"app-view-ondemand",40),2&e){const e=i.gc();i.lc("contentId",e.contentId)("contentType",e.contentType)}}function gO(e,t){if(1&e&&(i.Qb(0,"app-view-progress",41),i.hc(1,"async")),2&e){const e=i.gc();i.lc("show",i.ic(1,2,e.viewWindow$)===e.viewWindow.Loader)("percent",e.loadProgress)}}function hO(e,t){if(1&e&&i.Qb(0,"app-play-loader",43),2&e){const e=i.gc(2);i.lc("percent",e.loadProgress)}}function bO(e,t){1&e&&i.Qb(0,"app-button-loader")}function mO(e,t){1&e&&i.Qb(0,"app-hand-loader")}function fO(e,t){if(1&e&&(i.Vb(0,"app-view-loader"),i.Kc(1,hO,1,1,"app-play-loader",42),i.hc(2,"async"),i.Kc(3,bO,1,0,"app-button-loader",3),i.hc(4,"async"),i.Kc(5,mO,1,0,"app-hand-loader",3),i.hc(6,"async"),i.Ub()),2&e){const e=i.gc();i.Db(1),i.lc("ngIf","play"===i.ic(2,3,e.interactType$)),i.Db(2),i.lc("ngIf","button"===i.ic(4,5,e.interactType$)),i.Db(2),i.lc("ngIf","hand"===i.ic(6,7,e.interactType$))}}function yO(e,t){1&e&&i.Qb(0,"app-view-tour")}function xO(e,t){1&e&&i.Qb(0,"app-view-annotate")}function vO(e,t){1&e&&i.Qb(0,"app-view-print")}function wO(e,t){1&e&&i.Qb(0,"app-view-content-warning")}const OO=function(e,t,n){return{"view-page--column-in":e,"view-page--column-out":t,"view-page--drawer-push":n}};let CO=(()=>{class e{constructor(e,t,n,i,s,r,a,c,l,p,d){this.activatedRoute=e,this.renderer=t,this.store=n,this.viewService=i,this.quizService=s,this.changeDetectorRef=r,this.actions=a,this.layoutService=c,this.engineService=l,this.pendoService=p,this.title=d,this.application=o,this.nativePlatform=oc,this.breakpoint=fl,this.viewLayoutStatus=oa,this.viewMode=rl,this.viewUI=Cl,this.viewWindow=Fc,this.columnLayoutStatus=oa.Hide,this.drawerExpandable=!0,this.drawerOpen=!1,this.drawerY=0,this.loadLabel="",this.loadProgress=0,this.chaptersLoaded=0,this.isBackgroundLight=!0,this.selectedChapterLoading=!1,this.viewToolsMode=gg,this.cameraVisible=!1,this.columnVisible=!1,this.drawerVisible=!1,this.logoVisible=!1,this.menuVisible=!1,this.nodeInfoVisible=!1,this.searchVisible=!1,this.titleOnlyVisible=!1,this.toolbarVisible=!1,this.undoVisible=!1,this.ngUnsubscribe=new $.a,this.audioListening=new $.a}onClick(e){this.handleFirstClickTracking(e)}ngOnInit(){this.resetScene();const e=this.viewService.normalizeQueryParams(this.activatedRoute.snapshot.queryParams);this.contentId=e.id,this.contentType=e.type,this.contentLang=e.lang}ngAfterViewInit(){this.initOnDemand(),this.store.dispatch(new yo({tag:!0,pin:!1})),this.store.dispatch(new Te(!0));const e=this.store.selectSnapshot(il.getUI).loader.template;this.store.dispatch(new Ce(e===ra.Bar)),e!==ra.None&&this.store.dispatch(new Q.ToggleWindow(Fc.Loader,!0)),this.checkCapabilities(),this.initSizeObservers(),this.initHeaderObserver(),this.initLayoutObserver(),this.initBreakpointObservers(),this.initKeyboardObserver(),this.initLoadProgressObserver(),this.initWindowObserver(),this.initBackgroundColorObserver(),this.initResponsiveLabels(),this.initNodeObserver(),this.initChapterObserver(),this.initAudioObserver(),this.initNotifications(),this.initPendoEvents(),this.positionRelativeElements(this.drawerY)}ngOnDestroy(){this.store.dispatch(new oe(!1)),this.store.dispatch(new qr),la.isFullscreen()&&la.exitFullscreen(),this.quizService.exitQuiz(),this.unbindKeyboard(),this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initOnDemand(){this.onDemand$.pipe(Object(K.a)(e=>!e),Object(sl.a)(1),Object(W.a)(this.ngUnsubscribe)).subscribe(()=>{this.viewService.initStory(this.contentId,this.contentType,this.contentLang)})}checkCapabilities(){const e=this.renderer.listen("window","mouseover",()=>{e(),this.store.dispatch(new Q.SetCanHover(!0))}),t="ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0;this.store.dispatch(new Q.SetCanTouch(t)),this.store.dispatch(new Q.SetCanFullscreen(la.canFullscreen())),this.store.dispatch(new Q.SetInputMode(t?Zc.Touch:Zc.Mouse))}initBreakpointObservers(){this.breakpoint$.pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(()=>{this.handleResize()})}initResponsiveLabels(){const e=Object(as.a)(window,"resize").pipe(Object(cs.a)(100)),t=this.store.select(il.getLabelsBreakpoint),n=this.store.select(Tr.getSelectedLabel),i=this.store.select(Tr.getLabelsCollapsed);n.pipe(Object(K.a)(()=>this.store.selectSnapshot(Tr.getLabelsCollapsed)),Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.viewService.toggleLabelInfo(!!e)}),i.pipe(Object(K.a)(()=>!!this.store.selectSnapshot(Tr.getSelectedLabel)),Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.viewService.toggleLabelInfo(e)}),Object(rs.b)(e,t).pipe(Object(K.a)(([,e])=>!Object(X.isNil)(e)),Object(W.a)(this.ngUnsubscribe)).subscribe(()=>{this.checkLabelsCollapsed()}),this.checkLabelsCollapsed()}initSizeObservers(){const e=ug({strategy:"scroll"});Object(as.a)(window,"resize").pipe(Object(cs.a)(10),Object(W.a)(this.ngUnsubscribe)).subscribe(()=>{this.updateViewHeight(),this.refreshLayout()}),new q.a(t=>{e.listenTo(this.engineContainer.nativeElement,()=>{t.next()})}).pipe(Object(cs.a)(10)).subscribe(()=>{this.resizeEngineContainer()})}initHeaderObserver(){this.store.select(wp.getSiteHeader).pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.updateViewHeight()})}initLayoutObserver(){this.layout$.pipe(Object(K.a)(e=>null!=e),Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.refreshLayout()})}initKeyboardObserver(){this.inputEnabled$.pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{e?this.bindKeyboard():this.unbindKeyboard()})}initNodeObserver(){this.actions.pipe(Object(d.j)(be),Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.viewService.delegateNodeClick(e.node,e.event)}),this.store.select(ii.getSelectedNode).pipe(Object(us.a)(),Object(W.a)(this.ngUnsubscribe)).subscribe(([e,t])=>{const n=Object(X.get)(e,"objectId",void 0),i=Object(X.get)(t,"objectId",void 0);void 0!==t&&n===i||this.viewService.toggleNodeInfo(!1)})}initChapterObserver(){this.store.select(Bo.getSelectedChapterId).pipe(Object(K.a)(e=>null!=e),Object(k.a)(()=>this.store.selectSnapshot(Bo.getSelectedChapter)),Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.viewService.initChapter(e),this.setPageTitle(e),this.refreshLayout()})}initLoadProgressObserver(){this.store.select(Pl.getChunkLoadProgress).pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.loadProgress=100*e,this.engineService.fireEvent(it.HumanProgress,{progress:this.loadProgress}),this.changeDetectorRef.markForCheck(),this.checkShowLoader()}),this.store.select(Qr.getLoadingChunk).pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{null!==e&&e.chapterId===this.store.selectSnapshot(Bo.getSelectedChapterId)||c.offline?this.store.dispatch(new Q.ToggleWindow(Fc.Loader,!0)):(this.engineService.enableRender(),this.store.dispatch(new Q.ToggleWindow(Fc.Loader,!1)),this.refreshLayout(),setTimeout(()=>{this.engineService.enableAnimation()},500))}),this.actions.pipe(Object(d.i)(Hs),Object(W.a)(this.ngUnsubscribe)).subscribe(()=>{0===this.store.selectSnapshot(Qr.getLoadChunksRemaining).length&&(this.store.dispatch(new Q.ToggleWindow(Fc.Loader,!1)),c.offline)&&setTimeout(()=>{this.engineService.enableAnimation()},1750)})}checkShowLoader(){if(this.store.selectSnapshot(Bo.getSelectedChapterIndex)>0){const e=this.store.selectSnapshot(Bo.getSelectedChapterId),t=this.store.selectSnapshot(Qr.getLoadingChunk);null!==t&&e===t.chapterId&&this.store.dispatch(new Q.ToggleWindow(Fc.Loader,!0))}}initWindowObserver(){this.viewWindow$.pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.viewService.resetLayout(),e===Fc.Tutorial?(this.viewService.resetChapter(),this.viewService.toggleLabels(!1)):this.viewService.toggleLabels(!0)})}initBackgroundColorObserver(){this.background$.pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{if(!e.colors)return;const t=e.colors.slice(0,3);this.isBackgroundLight=Eo.isLight([t[0],t[1],t[2]]),this.changeDetectorRef.markForCheck()})}initAudioObserver(){const e=Object(ss.a)(this.ngUnsubscribe,this.audioListening),t=this.viewWindow$.pipe(Object(k.a)(e=>e===Fc.Tutorial||e===Fc.Interact),Object(K.a)(e=>e),Object(sl.a)(1));Object(rs.b)(this.viewWindow$,t,this.audio$).pipe(Object(K.a)(([e])=>Object(X.isNil)(e)),Object(W.a)(e)).subscribe(([,e,t])=>{e?Object(X.isNil)(t)||this.playAudio():this.stopAudioListening()})}initNotifications(){this.notification=new sm("Welcome! Learn how to navigate and interact with this model in 3D.","Launch Tutorial")}initPendoEvents(){const e=this.store.selectSnapshot(Qr.getStoryId);if("preview"===e)return;const t={totalQuestions:0};this.store.select(Bi.getQuestionTotal).pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{t.totalQuestions=e}),this.store.select(Bi.getQuizModeActive).pipe(Object(K.a)(()=>this.store.selectSnapshot(Bi.getQuestionTotal)>0),Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{e&&this.pendoService.track("Quiz - Entered",t)}),this.actions.pipe(Object(d.j)(ji.SubmitQuestionAnswer),Object(W.a)(this.ngUnsubscribe)).subscribe(()=>{const e=this.store.selectSnapshot(Bi.getActiveQuestionIndex),n=this.store.selectSnapshot(Bi.getQuestionsRemaining);0===e&&this.pendoService.track("Quiz - First Question Answered",t),0===n&&this.pendoService.track("Quiz - Completed",t)}),this.actions.pipe(Object(d.i)(Hs),Object(W.a)(this.ngUnsubscribe)).subscribe(()=>{if(0===this.store.selectSnapshot(Qr.getLoadChunksRemaining).length){const t=this.store.selectSnapshot(Qr.getStory);this.pendoService.trackOncePerPage("View - Loaded",{id:e,chapters:t.chapters.length,tour:t.tags.includes("tour"),animated:t.tags.includes("animated"),quiz:this.store.selectSnapshot(Bi.hasQuiz)})}})}handleFirstClickTracking(e){e.composedPath().some(e=>"APP-SITE-HEADER"===e.nodeName)||1===this.store.selectSnapshot(Pl.getStoryLoadProgress)&&this.pendoService.trackOncePerPage("First Click")}handleNotificationClose({action:e}){"Launch Tutorial"===e&&this.viewService.toggleTutorial(!0),e||this.store.dispatch(new Q.TutorialSeen(!0))}stopAudioListening(){this.audioListening.next(),this.audioListening.complete()}playAudio(){this.store.dispatch(new Ie(!0)),this.stopAudioListening()}handleColumnToggle(){this.viewService.toggleColumn(),this.changeDetectorRef.markForCheck()}handleDrawerOffsetChange(e){this.drawerY=e,this.drawerOpen=-64!==e,this.positionRelativeElements(this.drawerY)}checkLabelsCollapsed(){const e=this.store.selectSnapshot(Ol.getBreakpoint),t=this.store.selectSnapshot(il.getLabelsBreakpoint),n=this.isLabelBreaking(t);this.store.dispatch(new fo(n,e>=fl.Large?Ji.Toggle:Ji.None))}isLabelBreaking(e){return window.innerWidth<e}bindKeyboard(){dg.bind("1",()=>this.viewService.selectTool(Go.Select)),dg.bind("2",()=>this.viewService.selectTool(Go.Hide)),dg.bind("3",()=>this.viewService.selectTool(Go.Fade)),dg.bind(["command+,","ctrl+,"],e=>{e.preventDefault(),this.store.selectSnapshot(Ol.getBreakpoint)>fl.Medium?this.viewService.toggleColumn():this.drawer.toggleDrawer(),this.changeDetectorRef.markForCheck()}),dg.bind(["command+enter","ctrl+enter","command+p"],e=>{e.preventDefault(),la.toggleFullscreen()}),dg.bind("meta+z",e=>{e.preventDefault(),this.viewService.undo()}),dg.bind(["meta+y","meta+shift+z"],e=>{e.preventDefault(),this.viewService.redo()}),dg.bind([".","pagedown"],()=>this.viewService.nextChapter("Keyboard")),dg.bind([",","pageup"],()=>this.viewService.previousChapter("Keyboard")),dg.bind(["del","backspace"],e=>{e.preventDefault(),this.viewService.hideSelectedStructures()}),dg.bind("R",e=>{e.preventDefault(),this.viewService.resetChapter()}),dg.bind("/",()=>this.viewService.toggleSearch()),dg.bind("?",()=>this.viewService.toggleHelp()),dg.bind("space",e=>{e.preventDefault(),this.viewService.toggleAnimation()})}unbindKeyboard(){dg.reset()}resizeEngineContainer(){const{top:e,left:t,width:n,height:i}=this.engineContainer.nativeElement.getBoundingClientRect(),o=new pt(t,e,n,i,dt.Shown);this.store.dispatch(new Fe(o))}updateViewHeight(){const e=this.viewService.getVH(c.application!==o.Viewer);this.view.nativeElement.style.setProperty("--vh",e+"px")}handleResize(){this.viewService.resetLayout()}resetScene(){this.store.dispatch(new oe(!0)),this.store.dispatch(new ae(!1)),this.store.dispatch(new ke(Go.Select)),this.store.dispatch(new qr),this.engineService.getEvent(it.AssetsLoadProgress).pipe(Object(sl.a)(1),Object(W.a)(this.ngUnsubscribe)).subscribe(()=>{this.store.dispatch(new ae(!0))})}refreshLayout(){const e=this.store.selectSnapshot(il.getUI);this.columnLayoutStatus=e.column.status,this.cameraVisible=this.layoutService.isVisible(Cl.Camera),this.columnVisible=this.layoutService.isVisible(Cl.Column),this.drawerVisible=this.layoutService.isVisible(Cl.Drawer),this.logoVisible=this.layoutService.isVisible(Cl.Logo),this.menuVisible=this.layoutService.isVisible(Cl.Menu),this.nodeInfoVisible=this.layoutService.isVisible(Cl.NodeInfo),this.searchVisible=this.layoutService.isVisible(Cl.Search),this.titleOnlyVisible=this.layoutService.isVisible(Cl.TitleOnly),this.toolbarVisible=this.layoutService.isVisible(Cl.Toolbar),this.undoVisible=this.layoutService.isVisible(Cl.Undo),this.updateViewHeight(),this.resizeEngineContainer(),this.store.dispatch(new ho(!1!==e.anatomyLabels.enable,!1!==e.nodeInfo.enable,!0)),this.store.dispatch(new Se(!1!==e.labels.enable)),setTimeout(()=>{this.drawer?this.positionRelativeElements(this.drawerY):this.positionRelativeElements(),this.changeDetectorRef.markForCheck()})}positionRelativeElements(e=0){this.store.selectSnapshot(Ol.getBreakpoint),null!=this.viewCameraBar&&this.cameraVisible&&this.renderer.setStyle(this.viewCameraBar.nativeElement,"transform",`translate3d(-4px, ${this.menuVisible?-64:0}px, 0)`),this.renderer.setStyle(this.viewToolbar.nativeElement,"transform","translate3d(-8px, 0, 0)"),this.renderer.setStyle(this.viewSceneBase.nativeElement,"transform","translate3d(0, -8px, 0)"),this.renderer.setStyle(this.view.nativeElement,"padding-bottom",-e+"px")}isVisible(e){return this.layoutService.isVisible(e)}isEnabled(e){return this.layoutService.isUIEnabled(e)}setPageTitle(e){const t=Object(X.get)(e,"info.displayName");this.title.setTitle((t?t+" | ":"")+"BioDigital Human Platform")}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(Z.a),i.Pb(i.H),i.Pb(d.g),i.Pb(Ip),i.Pb(hg),i.Pb(i.i),i.Pb(d.b),i.Pb(Ml),i.Pb(lt),i.Pb(ee),i.Pb(l.c))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-page"]],viewQuery:function(e,t){if(1&e&&(i.Gc(Ww,!0),i.Gc(Kw,!0),i.Gc(Gw,!0),i.Rc(Zw,!0),i.Rc(Jw,!0),i.Gc(Xw,!0),i.Rc(Yw,!0),i.Rc(eO,!0,om)),2&e){let e;i.uc(e=i.dc())&&(t.engineContainer=e.first),i.uc(e=i.dc())&&(t.viewContainer=e.first),i.uc(e=i.dc())&&(t.view=e.first),i.uc(e=i.dc())&&(t.viewCameraBar=e.first),i.uc(e=i.dc())&&(t.viewLogo=e.first),i.uc(e=i.dc())&&(t.viewSceneBase=e.first),i.uc(e=i.dc())&&(t.viewToolbar=e.first),i.uc(e=i.dc())&&(t.drawer=e.first)}},hostBindings:function(e,t){1&e&&i.cc("click",(function(e){return t.onClick(e)}),!1,i.xc)},decls:45,vars:47,consts:[["viewContainer",""],[1,"view-page",3,"ngClass"],["view",""],[4,"ngIf"],["class","view-page__title-only",4,"ngIf"],[1,"view-page__engine"],["engineContainer",""],["class","view-page__notifications",4,"ngIf"],["class","view-page__undo",4,"ngIf"],[1,"view-page__column-toggle"],[1,"view-page__scene-base"],["viewSceneBase",""],[1,"view-page__toolbar"],["viewToolbar",""],["position","right",4,"ngIf"],["class","view-page__menu",4,"ngIf"],["class","view-page__logo",4,"ngIf"],[1,"view-page__camera-bar"],["viewCameraBar",""],[3,"showNav",4,"ngIf"],["class","view-block-input",4,"ngIf"],[3,"activeTab",4,"ngIf"],[3,"contentId","contentType",4,"ngIf"],[3,"show","percent",4,"ngIf"],[4,"appFlagApplication","appFlagApplicationMode","appFlagApplicationNative"],[1,"view-page__title-only"],["layout","column"],[1,"view-page__notifications"],[3,"notification","closeClick"],[1,"view-page__undo"],["position","right"],[1,"view-page__menu"],[1,"ml-4"],[1,"view-page__logo"],[3,"logoColor","logoSize"],[3,"showNav"],[3,"offsetYChange"],["drawer",""],[1,"view-block-input"],[3,"activeTab"],[3,"contentId","contentType"],[3,"show","percent"],[3,"percent",4,"ngIf"],[3,"percent"]],template:function(e,t){if(1&e&&(i.Vb(0,"div",null,0),i.Vb(2,"div",1,2),i.Kc(4,tO,1,0,"app-view-column-container",3),i.Qb(5,"app-view-menu-column"),i.Kc(6,nO,2,0,"div",4),i.hc(7,"async"),i.Vb(8,"div",5,6),i.Kc(10,iO,2,1,"div",7),i.hc(11,"async"),i.hc(12,"async"),i.Kc(13,oO,2,0,"div",8),i.Vb(14,"div",9),i.Qb(15,"app-view-column-toggle"),i.Ub(),i.Vb(16,"div",10,11),i.Vb(18,"div",12,13),i.Kc(20,sO,1,0,"app-view-toolbar",14),i.Ub(),i.Kc(21,rO,2,0,"div",15),i.Kc(22,aO,3,4,"div",16),i.Vb(23,"div",17,18),i.Kc(25,cO,1,1,"app-engine-camera-bar",19),i.Ub(),i.Ub(),i.Kc(26,lO,3,0,"ng-container",3),i.Ub(),i.Ub(),i.Ub(),i.Kc(27,pO,1,0,"div",20),i.hc(28,"async"),i.Kc(29,dO,2,3,"app-view-help",21),i.hc(30,"async"),i.Kc(31,uO,1,2,"app-view-ondemand",22),i.hc(32,"async"),i.Kc(33,gO,2,4,"app-view-progress",23),i.hc(34,"async"),i.Kc(35,fO,7,9,"app-view-loader",3),i.hc(36,"async"),i.Kc(37,yO,1,0,"app-view-tour",3),i.hc(38,"async"),i.Kc(39,xO,1,0,"app-view-annotate",3),i.hc(40,"async"),i.Kc(41,vO,1,0,"app-view-print",3),i.hc(42,"async"),i.Kc(43,wO,1,0,"app-view-content-warning",24),i.Qb(44,"app-view-iphone12-warning")),2&e){let e=null,n=null,o=null;i.Db(2),i.lc("ngClass",i.qc(43,OO,t.columnVisible,!t.columnVisible,t.drawerVisible)),i.Db(2),i.lc("ngIf",t.columnVisible||t.searchVisible||t.nodeInfoVisible),i.Db(2),i.lc("ngIf",t.titleOnlyVisible&&(null==(e=i.ic(7,21,t.chapter$))?null:e.info.displayName)),i.Db(4),i.lc("ngIf",(null==(n=i.ic(11,23,t.selectedChapterReady$))?null:n.model)&&!i.ic(12,25,t.tutorialSeen$)),i.Db(3),i.lc("ngIf",t.undoVisible),i.Db(7),i.lc("ngIf",t.toolbarVisible),i.Db(1),i.lc("ngIf",t.menuVisible),i.Db(1),i.lc("ngIf",t.logoVisible),i.Db(3),i.lc("ngIf",t.cameraVisible),i.Db(1),i.lc("ngIf",t.drawerVisible),i.Db(1),i.lc("ngIf",!i.ic(28,27,t.inputEnabled$)),i.Db(2),i.lc("ngIf",i.ic(30,29,t.viewWindow$)===t.viewWindow.Help),i.Db(2),i.lc("ngIf",i.ic(32,31,t.viewWindow$)===t.viewWindow.OnDemand),i.Db(2),i.lc("ngIf","circle"===(null==(o=i.ic(34,33,t.layout$))?null:o.loader.template)),i.Db(2),i.lc("ngIf",i.ic(36,35,t.viewWindow$)===t.viewWindow.Interact),i.Db(2),i.lc("ngIf",i.ic(38,37,t.viewWindow$)===t.viewWindow.Tutorial),i.Db(2),i.lc("ngIf",i.ic(40,39,t.viewWindow$)===t.viewWindow.Whiteboard),i.Db(2),i.lc("ngIf",i.ic(42,41,t.usePrintImage$)),i.Db(2),i.lc("appFlagApplication",t.application.All)("appFlagApplicationMode","include")("appFlagApplicationNative",t.nativePlatform.All)}},directives:[ms.i,ms.l,Pm,Tm,sc,Bm,df,Wg,hf,jf,Oy,Ny,ym,Ky,om,rx,jx,Lx,Fx,Vx,_x,Hx,Lv,iw,sw,Qw],pipes:[ms.b],styles:[".view-page{border:var(--view-page-border);width:100vw;height:100vh;height:calc(var(--vh, 1vh) * 100);max-height:100vh;overflow:hidden;transition:padding-left .25s,padding-bottom .3s}.view-page--column-in{padding-left:320px}.view-page--column-out{padding-left:0}.view-page--drawer-push{padding-bottom:64px}.view-page__column{height:100%}.view-page__column-toggle{position:absolute;top:50%;margin-top:-18px;left:0;z-index:10}.view-page__engine{width:100%;height:100%;position:relative}.view-page__menu{position:absolute;right:8px;bottom:0;z-index:30}.view-page__camera-bar{position:absolute;bottom:0;right:4px;z-index:20}.view-page__logo{display:inline-block;position:absolute;left:16px;bottom:0;z-index:10}.view-page__media-bar{position:absolute;left:50%;margin-left:-100px;width:200px;bottom:0;z-index:10;justify-content:center}.view-page__media-bar:not([hidden]){display:flex}.view-page__notifications{position:absolute;top:12px;right:12px;z-index:20}.view-page__title-only{position:absolute;top:8px;left:8px;max-width:304px;z-index:10;padding:12px;border-radius:4px;background:hsla(0,0%,100%,.8);box-shadow:1px -1px 2px 0 rgba(28,42,63,.1),0 1px 2px 0 rgba(28,42,63,.3);color:#131c2a;background-color:var(--view-title-background);box-shadow:var(--view-title-shadow)}.view-page__scene-base{position:absolute;left:0;bottom:0;right:0;z-index:10;transition:transform .3s}.view-page__toolbar{position:absolute;display:inline-block;z-index:20;bottom:0;right:64px;transition:transform .25s}.view-page__undo{position:absolute;display:flex;justify-content:center;pointer-events:none;left:0;z-index:10;width:100%}.view-block-input{position:fixed;top:0;bottom:0;left:0;right:0;z-index:10000}"],encapsulation:2,changeDetection:0}),$w([Object(d.d)(il.getUI),qw("design:type",q.a)],e.prototype,"layout$",void 0),$w([Object(d.d)(il.getInputEnabled),qw("design:type",q.a)],e.prototype,"inputEnabled$",void 0),$w([Object(d.d)(il.getFullscreenActive),qw("design:type",q.a)],e.prototype,"fullscreenActive$",void 0),$w([Object(d.d)(il.getDrawerCoversContent),qw("design:type",q.a)],e.prototype,"drawerCoversContent$",void 0),$w([Object(d.d)(il.getInteractType),qw("design:type",q.a)],e.prototype,"interactType$",void 0),$w([Object(d.d)(il.getOnDemand),qw("design:type",q.a)],e.prototype,"onDemand$",void 0),$w([Object(d.d)(il.getShowHelpTab),qw("design:type",q.a)],e.prototype,"showHelpTab$",void 0),$w([Object(d.d)(il.getUsePrintImage),qw("design:type",q.a)],e.prototype,"usePrintImage$",void 0),$w([Object(d.d)(il.getOpenWindow),qw("design:type",q.a)],e.prototype,"viewWindow$",void 0),$w([Object(d.d)(il.getTutorialSeen),qw("design:type",q.a)],e.prototype,"tutorialSeen$",void 0),$w([Object(d.d)(Pl.getStoryLoadProgress),qw("design:type",q.a)],e.prototype,"loadProgress$",void 0),$w([Object(d.d)(Ol.getBreakpoint),qw("design:type",q.a)],e.prototype,"breakpoint$",void 0),$w([Object(d.d)(Bo.getSelectedChapter),qw("design:type",q.a)],e.prototype,"chapter$",void 0),$w([Object(d.d)(Bo.getSelectedChapterReadyState),qw("design:type",q.a)],e.prototype,"selectedChapterReady$",void 0),$w([Object(d.d)(Bo.getChaptersLoaded),qw("design:type",q.a)],e.prototype,"chaptersLoaded$",void 0),$w([Object(d.d)(Bo.getSelectedChapterBackground),qw("design:type",q.a)],e.prototype,"background$",void 0),$w([Object(d.d)(Bo.getSelectedChapterAudio),qw("design:type",q.a)],e.prototype,"audio$",void 0),e})(),SO=(()=>{class e{constructor(){}resolve(e){const t=Object.assign({},e.queryParams);return gl(Object.keys(t).reduce((e,n)=>{const i=Array.isArray(t[n]);return e[n]=i?Object(X.last)(t[n]):t[n],e},{}))}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac}),e})();var kO=n("l5mm"),_O=n("eNwd");function jO(e){const{procName:t,actionFn:n,aliases:i=[],mapFnIn:o,mapFnOut:s,hideDefinition:r=!1}=e,a=function(e){const t=this,i=o?o(e):e,r=n(i);if(void 0!==r)if(r instanceof q.a)r.subscribe(e=>{const n=s?s(e):e;t.setResult(n)});else{const e=s?s(r):r;t.setResult(e)}};[t,...i].forEach(e=>{const t=()=>Human.rpc.define(e,a);r?Human.rpc.hideDefinitions(()=>t()):t()})}var PO=function(e){return e.AnnotationsCreate="annotations.create",e.AnnotationsDestroy="annotations.destroy",e.AnnotationsInfo="annotations.info",e.AnnotationsSetDescription="annotations.setDescription",e.AnnotationsSetLabelsShown="annotations.setLabelsShown",e.AnnotationsSetTitle="annotations.setTitle",e.AnnotationsUpdate="annotations.update",e.AnnotationsSetEnabled="annotations.setEnabled",e.CameraInfo="camera.info",e.CameraOrbit="camera.orbit",e.CameraPan="camera.pan",e.CameraReset="camera.reset",e.CameraSet="camera.set",e.CameraZoom="camera.zoom",e.GetAnnotationInfo="annotations.info",e.HideAnnotations="annotations.hide",e.HotspotsCreate="hotspots.create",e.HotspotsDestroy="hotspots.destroy",e.HotspotsHide="hotspots.hide",e.HotspotsInfo="hotspots.info",e.HotspotsShow="hotspots.show",e.HotspotsTypes="hotspots.types",e.HotspotsUpdate="hotspots.update",e.HumanInfo="human.info",e.InputDisable="input.disable",e.InputEnable="input.enable",e.LabelsCreate="labels.create",e.LabelsDestroy="labels.destroy",e.LabelsInfo="labels.info",e.LabelsHide="labels.hide",e.LabelsSetEnabled="labels.setEnabled",e.LabelsShow="labels.show",e.LabelsUpdate="labels.update",e.LabelsCanvasUpdate="labels.canvasUpdate",e.LabelsSetScale="labels.setScale",e.NativeErrorMessage="native.errorMessage",e.NativeSetSdkOffline="native.setSdkOffline",e.QuizInfo="quiz.info",e.QuizEnter="quiz.enter",e.QuizExit="quiz.exit",e.QuizQuestion="quiz.currentQuestion",e.QuizSubmit="quiz.submit",e.QuizNextQuestion="quiz.next",e.QuizPreviousQuestion="quiz.previous",e.QuizSelectQuestion="quiz.select",e.QuizSet="quiz.set",e.QuizReset="quiz.reset",e.SceneMetaData="scene.metadata",e.SceneSetHighlightColor="scene.setHighlightColor",e.SceneColorObject="scene.colorObject",e.SceneDisableHighlight="scene.disableHighlight",e.SceneEnableHighlight="scene.enableHighlight",e.SceneGetColor="scene.getColor",e.SceneInfo="scene.info",e.SceneLoad="scene.load",e.ScenePick="scene.pick",e.SceneReset="scene.reset",e.SceneSelectObjects="scene.selectObjects",e.SceneShowObjects="scene.showObjects",e.SceneTransformObject="scene.transformObject",e.SceneUncolorObject="scene.uncolorObject",e.SceneSnapshot="scene.snapshot",e.SceneCapture="scene.capture",e.SceneRestore="scene.restore",e.SceneEnableXrayMode="scene.enableXray",e.SceneDisableXrayMode="scene.disableXray",e.SceneSetLayersSliderPosition="scene.setLayersSliderPosition",e.SceneGetLayers="scene.getLayers",e.SceneSetBaseDirectory="scene.setBaseDirectory",e.ShowAnnotations="annotations.show",e.SetAnnotationsShown="annotations.setShown",e.TimelineInfo="timeline.info",e.TimelineQuery="timeline.query",e.TimelineNext="timeline.nextChapter",e.TimelinePause="timeline.pause",e.TimelinePlay="timeline.play",e.TimelinePrev="timeline.previousChapter",e.TimelineSet="timeline.set",e.UIGetBackground="ui.getBackground",e.UIGetDisplay="ui.getDisplay",e.UIGetWorldPosition="ui.getWorldPosition",e.UISetBackground="ui.setBackground",e.UISetDisplay="ui.setDisplay",e.UIResetDisplay="ui.resetDisplay",e.UISnapshot="ui.snapshot",e.focusObject="focus.focusObject",e.dissectSetEnabled="dissect.setEnabled",e.pickSingleSetEnabled="pick.single.setEnabled",e.pickMultiSetEnabled="pick.multi.setEnabled",e.getCanvasPos="scene.getCanvasPos",e.sceneSetClickMode="scene.setClickMode",e.sceneGetClickMode="scene.getClickMode",e.IsolateObject="scene.isolateObject",e.setCameraMode="camera.setCameraMode",e.UISetOndemand="ui.setOndemand",e.UISetLoadingExperience="ui.setLoadingExperience",e.UISetScrollCaptureMode="ui.setScrollCaptureMode",e.UISetTutorial="ui.setTutorial",e}({});function MO(e){const t=e.captureCamera();return{position:t.lookAt.eye,target:t.lookAt.look,up:t.lookAt.up,zoom:t.zoom}}var IO,zO,TO=n("SxV6");function UO(e){if(!e)return null;const{objectId:t,canvasPos:n,worldPos:i}=e;return{objectId:t||void 0,canvasPosition:n?{x:n[0],y:n[1]}:void 0,mode:"query",position:i?{x:i[0],y:i[1],z:i[2]}:void 0}}function LO(e,t){const n=Human.scene.objects[t].parent;return null!==n&&(e[n.objectId].checked||LO(e,n.objectId))}function DO(e,t){const n=t.includes("/")?s.Module:s.Bookmark;e.dispatch(new Ls(t,n))}function EO(e,t){return e.dispatch(new ue(!0)),t.fireEvent(it.SceneXrayEnabled,void 0),!0}function FO(e,t,n){Human.rpc.defineEvent(e,{events:t||[e],map:n||(e=>e)})}(IO||(IO={})).getCanvasPos=function(e,t,n,i,o){n&&Kx.a.add(t,n,t);const s=e.renderer.getViewMat(),r=e.renderer.getProjMat(),a=Kx.b.create();Kx.a.transformMat4(a,t,s),a[3]=1,Kx.b.transformMat4(a,a,r);const c=a[1],l=a[3];return[Math.round((1+a[0]/l)*i/2),Math.round((1-c/l)*o/2)]},function(e){e.isLegacyCaptureFormat=function(e){return void 0!==e.engineVersion},e.convertCaptureFormat=function(e){const t=Object.keys(e.objects).reduce((e,t)=>(e.push({objectId:t,selected:!1,hidden:!1}),e),[]);return{storyId:e.timeline.rootName.replace(".json",""),camera:{lookAt:e.camera,zoom:void 0},labels:[],objects:t,background:[],activeChapterId:e.timeline.scrub?e.timeline.scrub.chapterId:void 0}}}(zO||(zO={}));var AO=n("I65S");function RO(e){return e.selectSnapshot(Tr.getChapterLabels)}function NO(e,t){return function(e,t){return e.find(e=>t===e.id)}(RO(e),t)}function VO(e,t){const n=function(e,t){return e.scene.markers.markers[t]}(e,t.id);return{annotationId:t.id,objectId:t.objectId||null,title:t.title,description:t.description,shown:t.shown,occludable:t.occludable,position:n?{x:n.pos[0],y:n.pos[1],z:n.pos[2]}:null,canvasPosition:n?{x:n.canvasPos[0],y:n.canvasPos[1]}:null}}function HO(e,t){const n=NO(e,t.annotationId);return n?Object.assign(Object.assign({},n),t):null}function BO(e,t){return t&&e.dispatch(new ao(t)),!0}function QO(e,t){return e.dispatch(new mo(t)),!0}function $O(e,t){return e.reduce((e,n)=>Object.assign(Object.assign({},e),{[""+n]:t}),{})}function qO(e,t){return function(e,n){return Object.entries(e).filter(([e,n])=>((e,n)=>n===t)(0,n)).reduce((e,[t,n])=>Object.assign(Object.assign({},e),{[""+t]:n}),{})}(e)}function WO(e,t){return Object.keys(qO(e,t))}function KO(e,t,n){return function(e,t){return e.filter(e=>t.includes(e.id))}(e,WO(t,n))}function GO(e,t,n){const i=WO(t,n).map(t=>function(e,...t){const n=t.map(t=>e.filter(e=>t===e.objectId));return function(e){const t=new Set(e);return Array.from(t.values())}([].concat(...n))}(e,t)).map(e=>e.map(e=>e.id));return $O([].concat(...i),n)}function ZO(e,t){return[{eventName:it.AnnotationsCreated,aliasEvents:[it.LabelsCreated],mapFn:t=>VO(e,t)},{eventName:it.AnnotationsDestroyed,aliasEvents:[it.LabelsDestroyed],mapFn:e=>({annotationId:e.id})},{eventName:it.AnnotationsShown,aliasEvents:[it.LabelsEnabled],mapFn:()=>!0},{eventName:it.AnnotationsHidden,aliasEvents:[it.LabelsDisabled],mapFn:()=>!0}]}function JO(e,t,n){return[{procName:PO.AnnotationsInfo,actionFn:()=>RO(t),mapFnOut:t=>function(e,t){return t.reduce((t,n)=>(t[n.id]=VO(e,n),t),{})}(e,t)},{procName:PO.AnnotationsCreate,mapFnIn:i=>function(e,t,n,i){const o=t.selectSnapshot(Bo.getSelectedChapter),s={annotationId:i.annotationId,title:i.title,description:i.description,objectId:e.scene.objects[i.objectId]?i.objectId:void 0,pos:i.position,occludable:i.occludable,labelOffset:i.labelOffset,shown:i.shown,labelShown:i.shown};return s.objectId&&void 0===s.pos&&(s.pos=e.scene.objects[s.objectId].center),n.deserializeAnnotation(s,o,wn.Annotation)}(e,t,n,i),actionFn:e=>function(e,t){return t.objectId||t.pos?(e.dispatch(new to(t)),t):null}(t,e),mapFnOut:t=>t?VO(e,t):null},{procName:PO.AnnotationsUpdate,mapFnIn:e=>HO(t,e),actionFn:e=>BO(t,e)},{procName:PO.AnnotationsSetTitle,mapFnIn:e=>HO(t,e),actionFn:e=>BO(t,e),hideDefinition:!0},{procName:PO.AnnotationsSetDescription,mapFnIn:e=>HO(t,e),actionFn:e=>BO(t,e),hideDefinition:!0},{procName:PO.AnnotationsDestroy,mapFnIn:e=>NO(t,e),actionFn:e=>function(e,t){return t&&e.dispatch(new oo(t)),!0}(t,e)},{procName:PO.ShowAnnotations,actionFn:()=>QO(t,!0)},{procName:PO.SetAnnotationsShown,actionFn:()=>QO(t,!0),hideDefinition:!0},{procName:PO.HideAnnotations,actionFn:()=>QO(t,!1)},{procName:PO.AnnotationsSetLabelsShown,mapFnIn:e=>function(e,t){const{annotations:n,objects:i,replace:o}=t,s=n||{},r=i||{},a=RO(e),c=Object.assign(Object.assign(Object.assign(Object.assign({},qO(s,!0)),qO(s,!1)),GO(a,r,!0)),GO(a,r,!1));return o?Object.assign(Object.assign({},$O(a.map(e=>e.id),!1)),c):c}(t,e),actionFn:e=>function(e,t){const n=RO(e),i=KO(n,t,!1),o=KO(n,t,!0);e.dispatch(new bo(o,!0)),e.dispatch(new bo(i,!1))}(t,e),hideDefinition:!0}]}const XO={};function YO(e,t){t.hasOwnProperty("data")&&(t[e]=t.data)}const eC={hotspotSeedId:0,hotspotIdMap:new Map,getHotspotMap:e=>{const{hotspotIdMap:t,createHotspotId:n}=eC;return e.selectSnapshot(Tr.getLabels).forEach(e=>{const i=e.id;void 0===t.get(i)&&n(i)}),t},createHotspotId:e=>(eC.hotspotSeedId++,eC.hotspotIdMap.set(e,eC.hotspotSeedId),eC.hotspotSeedId),getHotspotIdByLabel:(e,t,n)=>{const{getHotspotMap:i,createHotspotId:o}=eC,s=i(e).get(t);return n&&void 0===s?o(t):s},getLabelIdByHotspotId:(e,t)=>{const n=eC.getHotspotMap(e),i=Array.from(n).find(([e,n])=>n===t);return i?i[0]:null}};function tC(e,t){const n=e.selectSnapshot(Tr.getLabels);return void 0!==t?n.filter(e=>e.chapterId===t):n}function nC(e,t){const n=tC(e),i=eC.getLabelIdByHotspotId(e,t);return n.find(e=>e.id===i)}function iC(e){return e===Nn.CirclePlus?vn.Plus:e===Nn.CircleMinus?vn.Minus:vn.Default}function oC(e,t){return eC.getHotspotIdByLabel(e,t)}function sC(e,t){return Object.assign(Object.assign({},t),{id:oC(e,t.id)})}function rC(e,t,n){const i=t.selectSnapshot(Bo.getStoryChapters);return n.map(n=>function(e,t,n,i){const{id:o,chapterId:s,title:r,objectId:a}=i,c=n.findIndex(e=>s===e.id),l=eC.getHotspotIdByLabel(t,o,!0),p=function(e,t){return e.scene.markers.markers[t]}(e,o);return{id:l,title:r,objectId:a,position:p?aC(p.pos):null,direction:p?aC(p.dir):null,canvasPosition:p?(d=p.canvasPos,{x:d[0],y:d[1]}):null,chapterScope:c,type:i.pinType===vn.PlusMinus?Nn.CirclePlus:Nn.Circle,shown:i.shown,data:XO[i.id]};var d}(e,t,i,n))}function aC(e){return{x:e[0],y:e[1],z:e[2]}}function cC(e){return[e.x,e.y,e.z]}function lC(e,t,n){return e.dispatch(new bo(t,n)),!0}function pC(e,t){if("number"==typeof t){const n=nC(e,t);return n?[n]:[]}return tC(e)}function dC(e,t){return[{eventName:it.HotspotsEntered,mapFn:e=>sC(t,e)},{eventName:it.HotspotsLeft,mapFn:e=>sC(t,e)},{eventName:it.HotspotsPicked,mapFn:e=>sC(t,e)},{eventName:it.HotspotsDisplayUpdated,mapFn:e=>sC(t,e)},{eventName:it.HotspotsPositionUpdated,mapFn:e=>function(e,t){const{id:n,canvasPos:i}=t,{x:o,y:s}=i;return{id:oC(e,n),canvasPosition:{x:o,y:s,0:o,1:s},occluded:t.occluded}}(t,e)}]}function uC(e,t,n){return[{procName:PO.HotspotsInfo,actionFn:n=>{const i="number"==typeof n?n:void 0;if(void 0!==i){const n=nC(t,i);return rC(e,t,[n])[0]}{const n=pC(t,i);return rC(e,t,n)}}},{procName:PO.HotspotsTypes,mapFnIn:()=>Object.values(Nn).map(e=>""+e),actionFn:e=>e},{procName:PO.HotspotsCreate,mapFnIn:e=>function(e,t,n){const{title:i,objectId:o,position:s,direction:r,chapterScope:a,type:c}=n,l=e.selectSnapshot(Bo.getStoryChapters),p=e.selectSnapshot(Bo.getSelectedChapter),d=e.selectSnapshot(Bo.getSelectedChapterIndex),u="number"==typeof a?a:d,g=l[u]||p,h=!1!==n.shown,b=h&&!!i,m={title:i,type:c||Nn.CircleLabel,objectId:o,pos:s?cC(s):null,dir:r?cC(r):null,shown:h,symbol:"",className:""},f=t.deserializeHotspots({},g,u,m);return f.title=i,f.expandTag=!0,f.flyTo=!1,f.flyToTarget=null,f.occludable=!0,f.pinGlow=!1,f.pinType=vn.PlusMinus,f.shown=h,f.hideTag=!b,f.hideWire=!0,f.theme=wn.StudioNext,f.pinType=iC(c),YO(f.id,n),f}(t,n,e),actionFn:e=>function(e,t){return t.objectId||t.pos?(e.dispatch(new to(t)),t):null}(t,e),mapFnOut:e=>e?oC(t,e.id):null},{procName:PO.HotspotsUpdate,mapFnIn:e=>function(e,t){const n=nC(e,t.id);return n?function(e,t){const{title:n,objectId:i,direction:o,position:s,shown:r,type:a}=e,c=Object.assign(Object.assign({},t),{title:n,objectId:i,shown:r,pos:s?cC(s):null,dir:o?cC(o):null,pinType:a?iC(a):null});return YO(t.id,e),Object.assign(Object.assign({},t),Object(X.omitBy)(c,X.isNil))}(t,n):null}(t,e),actionFn:e=>e?function(e,t){return e.dispatch(new ao(t)),t}(t,e):null},{procName:PO.HotspotsDestroy,mapFnIn:e=>nC(t,e),actionFn:e=>e?function(e,t){return e.dispatch(new oo(t)),t}(t,e):null},{procName:PO.HotspotsShow,mapFnIn:e=>pC(t,e),actionFn:e=>lC(t,e,!0)},{procName:PO.HotspotsHide,mapFnIn:e=>pC(t,e),actionFn:e=>lC(t,e,!1)}]}function gC(e){return e.selectSnapshot(Tr.getChapterLabels)}function hC(e,t){return e.dispatch(new mo(t)),!0}function bC(e,t){return gC(e).find(e=>t===e.id)}function mC(e,t){return gC(e).filter(e=>t.includes(e.id))}function fC(e,t,n){return t&&t.objectId?(e.dispatch(n?new to(t):new ao(t)),t):null}function yC(e,t){const n=document.createElement("span");return n.innerHTML=e,Object(X.trim)(n.textContent).length<=t}function xC(e,t,n){const i=e;return i.title=t.title&&yC(t.title,100)?t.title:i.title,i.description=t.description&&yC(t.description,300)?t.description:i.description,i.theme=t.theme||i.theme,i.pinType=t.pinType||i.pinType,i.sequentialType=t.sequentialType||i.sequentialType,i.offset=function(e,t){return t||[-(e.hideWire?20:32),0]}(i,t.labelOffset),i.pinGlow=void 0!==t.pinGlow?t.pinGlow:i.pinGlow,i.hideWire=void 0!==t.hideWire?t.hideWire:i.hideWire,i.hideTag=void 0!==t.hideTag?t.hideTag:i.hideTag,i.collapseDescription=void 0!==t.collapseDescription?t.collapseDescription:i.collapseDescription,i.occludable=void 0!==t.occludable?t.occludable:i.occludable,i.cameraPosition=t.flyToCamera||i.cameraPosition,i.flyTo=function(e,t){return!1!==t&&(t||e.flyTo)}(i,t.flyTo),i.states=function(e){if(!e.flyTo)return[];const t=[new En,new En];t[0].errands=[new Vn],t[1].errands=e.cameraPosition?[new Rn(e.cameraPosition)]:[new An(e.objectId)]}(i),i}function vC(e,t){if(t){const n=e.scene.markers.markers[t.id];return{labelId:t.id,objectId:t.objectId,title:t.title,description:t.description,theme:t.theme,pinType:t.pinType,labelOffset:t.offset,hideWire:t.hideWire,pinGlow:t.pinGlow,occludable:t.occludable,sequentialType:t.sequentialType,shown:t.shown,collapseDescription:t.collapseDescription,hideTag:t.hideTag,flyTo:!0===t.flyTo,flyToCamera:t.cameraPosition,position:n?[n.pos[0],n.pos[1],n.pos[2]]:t.pos,canvasPosition:n?[n.canvasPos[0],n.canvasPos[1]]:[-1,-1],occluded:!n||n.occluded}}return null}function wC(e,t){return t.reduce((t,n)=>(t[n.id]=vC(e,n),t),{})}function OC(e){return e.selectSnapshot(Bi.getAllQuestions)}function CC(e){return OC(e).find(t=>t.id===PC(e))}function SC(e){return{active:e.selectSnapshot(Bi.getQuizModeActive),questions:TC(OC(e)),questionId:PC(e),submissions:kC(e,jC(e))}}function kC(e,t){return t.map(t=>_C(e,t))}function _C(e,t){const n=CC(e);return{questionId:t.questionId,answerIds:n.data.correctAnswer,correct:Ti(n,t.answer)}}function jC(e){return e.selectSnapshot(Bi.getAllSubmissions)}function PC(e){return e.selectSnapshot(Bi.getActiveQuestionId)}function MC(e){const t=CC(e),n=function(e){return jC(e).find(t=>t.questionId===PC(e))}(e);return{question:zC(t),submission:n?_C(e,n):void 0}}function IC(e){return e.map(e=>function(e){const t=e.type;switch(t){case Pi.Markdown:const{markdown:n}=e;return{type:t,content:n};case Pi.Images:const{images:i}=e;return{type:t,content:i.map(e=>e.urls.default)};default:return{type:t,content:""}}}(e))}function zC(e){let t=[],n="";switch(e.type){case Mi.MultipleChoice:const i=e.data;t=i.options.map(e=>function(e){return{answerId:e.value,displayText:e.label}}(e)),n=i.correctAnswer;break;case Mi.SelectAnatomy:t=e.data.correctAnswer.map(e=>({answerId:e,displayText:e})),n="";break;case Mi.LabelAnatomy:t=e.data.options.map(e=>({answerId:e.value,displayText:e.label.title})),n=""}return{questionId:e.id,questionType:e.type,questionPrompt:IC(e.questionPrompt),answerExplanation:IC(e.explanation),answers:t,answerId:n}}function TC(e,t){const n=e.map(e=>zC(e));return void 0!==t?n.filter(e=>t.includes(e.questionId)):n}let UC=(()=>{class e{constructor(e,t,n,i,o,s,r,a,c,l,p,d){this.store=e,this.actions=t,this.cameraService=n,this.engineService=i,this.animationService=o,this.paintService=s,this.labelsService=r,this.graphService=a,this.viewService=c,this.widgetAnalyticsService=l,this.visibilityLayersService=p,this.quizService=d,this.webGLInfo=SceneJS.WEBGL_INFO}listen(e){this.initProcedures(),this.initEvents(),e&&this.logAPIUsage()}logAPIUsage(){setInterval(()=>{const e=Human.rpc.getLog(),t=Object(X.uniqBy)(e,e=>e.identifier);if(t.length>0){const e=JSON.stringify(t),n=this.store.selectSnapshot(B.getWidgetState),i=this.widgetAnalyticsService.buildDeveloperAnalytic(n,R.Call,z.WidgetAPI,e);this.widgetAnalyticsService.sendAnalytic(i).subscribe({next:e=>{},error:e=>{throw new Error(e)}}),Human.rpc.resetLog()}},1e4)}initEvents(){var e,t,n;FO(it.HumanProgress,void 0,e=>e),[{eventName:it.HumanReady,aliasEvents:[it.HumanStarted]},{eventName:it.Error,aliasEvents:[it.HumanError],mapFn:e=>e}].forEach(e=>{FO(e.eventName,e.aliasEvents,e.mapFn)}),[{eventName:it.SceneLoaded,mapFn:e=>e},{eventName:it.ScenePicked,aliasEvents:[it.PickPicked],mapFn:UO},{eventName:it.SceneObjectsSelected,mapFn:e=>e.selectedObjectsUpdate},{eventName:it.SceneObjectsShown,mapFn:e=>e.enabledObjectsUpdate},{eventName:it.SceneReady,aliasEvents:[it.Started]},{eventName:it.SceneRestored,mapFn:()=>!0},{eventName:it.SceneXrayEnabled,mapFn:()=>!0},{eventName:it.SceneXrayDisabled,mapFn:()=>!0},{eventName:it.NativeShare,mapFn:e=>e},{eventName:it.NativeDebugMessage,mapFn:e=>e}].forEach(e=>{FO(e.eventName,e.aliasEvents,e.mapFn)}),(e=this.cameraService,[{eventName:it.CameraUpdated,aliasEvents:[it.CameraRested],mapFn:()=>MO(e)}]).forEach(e=>{FO(e.eventName,e.aliasEvents,e.mapFn)}),[{eventName:it.TimelinePlaying,mapFn:e=>e},{eventName:it.TimelineCompleted,mapFn:e=>!0},{eventName:it.TimelineChapterTransition,aliasEvents:[it.TimelineChaptersActivated],mapFn:e=>({previousChapter:e.oldChapterIndex,currentChapter:e.newChapterIndex,time:e.time})}].forEach(e=>{FO(e.eventName,e.aliasEvents,e.mapFn)}),[].forEach(e=>{FO(e.eventName,e.aliasEvents,e.mapFn)}),[].forEach(e=>{FO(e.eventName,e.aliasEvents,e.mapFn)}),(t=Human,n=this.store,[...ZO(t),...dC(0,n),{eventName:it.LabelsChapterInfo,mapFn:e=>wC(t,e)},{eventName:it.LabelsCreated,mapFn:e=>vC(t,e)},{eventName:it.LabelsUpdated,mapFn:e=>vC(t,e)},{eventName:it.LabelsDestroyed,mapFn:e=>({labelId:e.id})},{eventName:it.LabelsEntered,mapFn:e=>e},{eventName:it.LabelsLeft,mapFn:e=>e},{eventName:it.LabelsPicked,mapFn:e=>e},{eventName:it.LabelsMoved,mapFn:e=>e},{eventName:it.LabelsEnabled,mapFn:()=>!0},{eventName:it.LabelsDisabled,mapFn:()=>!0},{eventName:it.LabelsShown,mapFn:e=>e},{eventName:it.LabelsHidden,mapFn:e=>e}]).forEach(e=>{FO(e.eventName,e.aliasEvents,e.mapFn)}),function(e){return[{eventName:it.QuizEntered,mapFn:()=>SC(e)},{eventName:it.QuizExited,mapFn:()=>!0},{eventName:it.QuizQuestionLoaded,mapFn:e=>e},{eventName:it.QuizAnswerSelected,mapFn:e=>e},{eventName:it.QuizAnswerSubmitted,mapFn:t=>{const n=e.selectSnapshot(Bi).questions.find(e=>e.id===t.questionId);return{questionId:t.questionId,answerIds:t.answer,correct:Ti(n,t.answer)}}},{eventName:it.QuizCompleted,mapFn:()=>Ui(e.selectSnapshot(Bi.getAllQuestions),e.selectSnapshot(Bi.getAllSubmissions))}]}(this.store).forEach(e=>{FO(e.eventName,e.aliasEvents,e.mapFn)})}initProcedures(){var e,t,n,i;(e=Human,t=this.webGLInfo,[{procName:PO.HumanInfo,actionFn:()=>({version:e.VERSION,webglInfo:t,apiFunctions:e.rpc.getProcedures().sort(),apiEvents:e.rpc.getEvents().sort()})}]).forEach(e=>{jO(e)}),function(e,t,n,i,o,s,r,a){return[{procName:PO.SceneMetaData,actionFn:()=>{const t=e.selectSnapshot(Qr.getStory),n=e.selectSnapshot(Bo.getStoryChapters);return{title:t.displayName,description:t.description,chapters:n.map(e=>({id:e.id,title:e.info.displayName,description:e.info.description,isAnimated:s.isChapterAnimated(e),loops:s.isChapterLooped(e),duration:s.getChapterLocalTimerange(e.id)}))}}},{procName:PO.focusObject,actionFn:n=>(function(e,t,n){e.select&&e.xray?EO(t,n):Wr(t,n),e.select&&t.dispatch(new $n.UpdateNodesChecked(!0,[e.objectId])),t.dispatch(new fe(e.objectId,!0,1))}(n,e,t),!0),hideDefinition:!0},{procName:PO.dissectSetEnabled,actionFn:t=>(e.dispatch(new ke(t.enable?Go.Hide:Go.Select)),!0),hideDefinition:!0},{procName:PO.sceneSetClickMode,actionFn:t=>(e.dispatch(new ke("select"===t?Go.Select:"hide"===t?Go.Hide:"fade"===t?Go.Fade:Go.Select)),!0)},{procName:PO.sceneGetClickMode,actionFn:()=>e.selectSnapshot(is.getActiveTool)},{procName:PO.pickSingleSetEnabled,actionFn:t=>{const n=(()=>{switch(t.enable){case void 0:return!e.selectSnapshot(il.getMultiPickModeEnabled);case!0:return!1;case!1:return!0}})();return e.dispatch(new Q.SetMultiPickModeEnabled(n)),!0},hideDefinition:!0},{procName:PO.pickMultiSetEnabled,actionFn:t=>{const n=(()=>{switch(t.enable){case void 0:return!e.selectSnapshot(il.getMultiPickModeEnabled);default:return t.enable}})();return e.dispatch(new Q.SetMultiPickModeEnabled(n)),!0},hideDefinition:!0},{procName:PO.getCanvasPos,actionFn:e=>{const n=t.getCanvas();return IO.getCanvasPos(Human,e.worldPos,e.offset,n.width,n.height)},hideDefinition:!0},{procName:PO.SceneCapture,actionFn:()=>function(e,t){const n=t.captureCamera(),i=e.selectSnapshot(ii.getNodes),o=Object.keys(i).map(e=>({objectId:e,selected:i[e].checked||LO(i,e),hidden:!i[e].shown})),s=e.selectSnapshot(Bo.getStoryChapters).map(e=>({chapterId:e.id,background:e.background||To})),r=e.selectSnapshot(Qr.getStoryId);return{camera:n,labels:e.selectSnapshot(Tr.getLabels),storyId:r,objects:o,background:s,activeChapterId:e.selectSnapshot(Bo.getSelectedChapterId)}}(e,i)},{procName:PO.SceneRestore,actionFn:n=>{const i=zO.isLegacyCaptureFormat(n);return function(e,t,n,i){return new q.a(o=>{n.getEvent(it.HumanStarted).pipe(Object(TO.a)()).subscribe(()=>{(function(e,t,n=!1){return new Promise(i=>{t.selectSnapshot(is.getViewGraph);const o=e.objects.filter(e=>!0===e.selected).map(e=>e.objectId),s=n?Human.scene.getLeaves().filter(t=>void 0===e.objects.find(e=>e.objectId===t)):e.objects.filter(e=>!0===e.hidden).map(e=>e.objectId),r=e.background.map(e=>new sn(e.chapterId,e.background)),a=e.activeChapterId?[new $t(e.activeChapterId)]:[],c=void 0!==e.camera.zoom?[new vt(e.camera.zoom)]:[];setTimeout(()=>{t.dispatch([new bt(e.camera.lookAt,!1),new eo(e.labels),new $n.UpdateNodesShown(!1,s),new $n.UpdateNodesChecked(!0,o),...c,...a,...r]),i()})})})(e,t,i).then(()=>{n.fireEvent(it.SceneRestored,void 0),o.next(!0),o.complete()})}),DO(t,e.storyId)})}(i?zO.convertCaptureFormat(n):n,e,t,i)}},{procName:PO.SceneEnableXrayMode,actionFn:()=>EO(e,t)},{procName:PO.SceneDisableXrayMode,actionFn:()=>Wr(e,t)},{procName:PO.SceneLoad,actionFn:t=>(DO(e,t),!0)},{procName:PO.SceneSetBaseDirectory,actionFn:e=>(Human.events.fire("scene.setBaseDirectory",e),!0)},{procName:PO.NativeSetSdkOffline,actionFn:e=>(Human.events.fire("native.setSdkOffline",e),!0)},{procName:PO.SceneReset,actionFn:()=>(r.resetChapter(),!0)},{procName:PO.SceneInfo,actionFn:t=>{const n=t&&t.objectId?[t.objectId]:Object.keys(Human.scene.objects);return function(e,t,n){const i=n.selectSnapshot(ii.getNodes);return{name:e,objects:t.reduce((e,t)=>(e[t]=(e=>{const t=Human.scene.objects[e],n=t.isLeaf()?i[e].checked||LO(i,e):void 0;return{objectId:t.objectId,name:t.displayName,description:t.description||"",shown:t.shown,selected:n,children:t.objects.map(e=>e.objectId),parent:t.parent?t.parent.objectId:null}})(t),e),{})}}(e.selectSnapshot(Qr.getStory).displayName,n,e)}},{procName:PO.ScenePick,actionFn:e=>UO(t.pickScene({x:e.x,y:e.y,rayPick:!0}))},{procName:PO.SceneSelectObjects,actionFn:t=>{const n=!0===t.replace,i=t;return delete i.replace,n&&e.dispatch(new $n.UpdateNodesChecked(!1)),e.dispatch(new $n.UpdateNodesChecked(!1,[],i)),!0}},{procName:PO.SceneShowObjects,actionFn:t=>{delete t.replace;const n=(e,i)=>{const o=Human.scene.objects[e].objects;let s={[e]:i};for(const r of o)void 0!==t[r.objectId]||(s[r.objectId]=i,s=Object.assign(Object.assign({},s),n(r.objectId,i)));return s},i=Object.entries(t).reduce((e,[t,i])=>Object.assign(Object.assign({},e),n(t,i)),{});return e.dispatch(new $n.UpdateNodesShown(!1,[],i)),!0}},{procName:PO.IsolateObject,actionFn:t=>{const n="string"==typeof t?[t]:t,i=e.selectSnapshot(is.getViewGraph),s=o.getInverseSelection(i,n),r=o.getNodes(i,s);return e.dispatch(new $n.UpdateNodesShown(!1,r.map(e=>e.id))),!0}},{procName:PO.SceneTransformObject,actionFn:e=>(t.transformObject(e.objectId,e),!0)},{procName:PO.SceneColorObject,actionFn:t=>{const{objectId:n,tintColor:i,saturation:o,contrast:s,brightness:r,opacity:a}=t;return e.dispatch(new $n.UpdateNodesPaint(Xn.fromEngine({tintColor:i,saturation:o,contrast:s,brightness:r,opacity:a}),[n])),!0}},{procName:PO.SceneGetColor,actionFn:t=>{const n=e.selectSnapshot(ii.getNodePaint)(t.objectId);return Xn.toEngine(n)}},{procName:PO.SceneUncolorObject,actionFn:t=>(e.dispatch(new $n.UpdateNodesPaint(ai.recipe,[t.objectId])),!0)},{procName:PO.SceneDisableHighlight,actionFn:()=>(n.disableHighlight(),!0)},{procName:PO.SceneEnableHighlight,actionFn:()=>(n.enableHighlight(),!0)},{procName:PO.SceneSetHighlightColor,actionFn:e=>(n.setHighlightColor(e),!0)},{procName:PO.SceneSetLayersSliderPosition,actionFn:e=>{const t=Math.min(1,Math.max(e.position,0)),n=a.fractionToIndex(t),i=a.fractionToPosition(t,n);return e.record?a.recordLayerIndexPosition(n,i):a.synchronizeScene(n,i,!1),!0}},{procName:PO.SceneGetLayers,actionFn:()=>e.selectSnapshot(Bo.getAllChaptersCurrentLayers)}]}(this.store,this.engineService,this.paintService,this.cameraService,this.graphService,this.animationService,this.viewService,this.visibilityLayersService).forEach(e=>{jO(e)}),(n=this.store,i=this.cameraService,[{procName:PO.CameraInfo,actionFn:()=>MO(i)},{procName:PO.CameraOrbit,actionFn:e=>(n.dispatch(new _t(void 0===e.pitch?0:e.pitch,void 0===e.yaw?0:e.yaw)),!0)},{procName:PO.CameraPan,actionFn:e=>(n.dispatch(new Ct(void 0===e.x?0:e.x,void 0===e.y?0:e.y,void 0===e.z?0:e.z)),!0)},{procName:PO.CameraReset,actionFn:()=>n.dispatch(new yt)},{procName:PO.CameraSet,actionFn:e=>{const t=e.animate||!1;if(e.objectId)return n.dispatch(new fe(e.objectId,t,e.animationDuration)),!0;const o=MO(i);return n.dispatch(new bt({eye:e.position||o.position,look:e.target||o.target,up:e.up||o.up},t)),!0}},{procName:PO.CameraZoom,actionFn:e=>(n.dispatch(new vt(e||0)),!0)},{procName:PO.setCameraMode,actionFn:e=>(n.dispatch(new jt("pan"===e?"pan":"rotate")),!0)}]).forEach(e=>{jO(e)}),function(e,t,n,i){return[{procName:PO.TimelineQuery,actionFn:()=>({chapters:e.selectSnapshot(Bo.getStoryChapters).map(e=>{const{description:t,displayName:n}=e.info;return{description:t,displayName:n,annotations:e.labels.map(e=>({title:e.title,description:e.description}))}})}),hideDefinition:!0},{procName:PO.TimelineInfo,actionFn:()=>function(e,t){const n=t.getTimeFrame();return{time:t.getTime(),startTime:n.firstTime,endTime:n.lastTime,chapters:e.selectSnapshot(Bo.getStoryChapters).map(e=>e.id),playing:t.isPlaying()}}(e,n)},{procName:PO.TimelinePlay,actionFn:i=>{const o=i.loop||!1;if(void 0===i.time&&void 0===i.chapterId){const t=e.selectSnapshot(Bo.getSelectedChapterId);return n.play({numChapters:1,loop:o,queue:!1,startChapterId:t}),!0}const s=Math.max(0,i.time),r=n.getTimeFrame().lastTime,a=Math.min(s,r-.001);return new q.a(s=>{t.pipe(Object(d.i)($t),Object(sl.a)(1)).subscribe(()=>{n.play(Object.assign(Object.assign({},{numChapters:1,queue:!1,loop:o}),void 0!==i.time?{startTime:a}:{startChapterId:i.chapterId})),s.next(!0),s.complete()});const r=i.chapterId?i.chapterId:n.mapGlobalTimeToLocal(a,{tie:"later"}).branch.id;e.dispatch(new $t(r))})}},{procName:PO.TimelinePause,actionFn:()=>(n.pause(),!0)},{procName:PO.TimelineSet,actionFn:i=>{if(void 0===i.time&&void 0===i.chapterId)return!0;if(void 0!==i.chapterId)return e.dispatch(new $t(i.chapterId)),!0;const o=Math.max(0,i.time),s=n.getTimeFrame().lastTime,r=Math.min(o,s);return new q.a(i=>{t.pipe(Object(d.i)($t),Object(sl.a)(1)).subscribe(()=>{n.scrub({time:r,which:0===r?"second":"first"}),i.next(!0),i.complete()});const o=n.mapGlobalTimeToLocal(r,0===r?{tie:"later"}:{});e.dispatch(new $t(o.branch.id))})}},{procName:PO.TimelineNext,actionFn:()=>(i.nextChapter("API"),!0)},{procName:PO.TimelinePrev,actionFn:()=>(i.previousChapter("API"),!0)}]}(this.store,this.actions,this.animationService,this.viewService).forEach(e=>{jO(e)}),function(e){return[{procName:PO.InputEnable,actionFn:()=>(e.dispatch(new w(!0)),!0)},{procName:PO.InputDisable,actionFn:()=>(e.dispatch(new w(!1)),!0)}]}(this.store).forEach(e=>{jO(e)}),function(e,t,n,i){return[{procName:PO.UIGetBackground,actionFn:()=>function(e){const{colors:t,gradientType:n,colorStops:i}=e;return{colors:[[t[0],t[1],t[2],t[3]],[t[4],t[5],t[6],t[7]]],gradientType:n,colorStops:i}}(t.selectSnapshot(Bo.getSelectedChapterBackground))},{procName:PO.UISetBackground,mapFnIn:e=>{const{colors:t,colorStops:n,gradientType:i}=e;return{colors:t?(o=t,Eo.getColors(o).map(e=>e[255])):t,gradientType:i,colorStops:n};var o},actionFn:e=>{if(e){const n=t.selectSnapshot(Bo.getSelectedChapterBackground),{colors:i,colorStops:o,gradientType:s}=n,r=e.colors?[].concat(...e.colors):i,a=new Pn(r,e.gradientType||s,e.colorStops||o);t.dispatch(new cn(a))}return!0}},{procName:PO.UIGetWorldPosition,actionFn:t=>{const{worldPos:n}=e.renderer.pick.pick(t.x,t.y,{rayPick:!0});if(n){const{0:e,1:t,2:i}=n;return{x:e,y:t,z:i}}return null}},{procName:PO.UISetOndemand,actionFn:e=>(t.dispatch([new Q.ToggleWindow(Fc.OnDemand,e.enabled)]),!0)},{procName:PO.UISetLoadingExperience,actionFn:e=>(Object(X.isEmpty)(e)?t.dispatch(new Q.CloseWindow(Fc.Interact)):t.dispatch([new Q.SetInteractType(e),new Q.OpenWindow(Fc.Interact)]),!0)},{procName:PO.UISetScrollCaptureMode,actionFn:e=>(t.dispatch(new se(e)),!0)},{procName:PO.UISetTutorial,actionFn:e=>(t.dispatch([new Q.ToggleWindow(Fc.Tutorial,e.enabled),new Q.StartTutorial(e.enabled)]),!0)},{procName:PO.UIGetDisplay,actionFn:()=>{const e=t.selectSnapshot(il.getUI);return{audio:e.audio.enable,fullscreen:e.fullscreen.enable,help:e.help.enable,nav:e.camera.enable,cameraMode:e.camera.enable,center:e.camera.enable,zoomIn:e.camera.enable,zoomOut:e.camera.enable,info:e.column.enable||e.drawer.enable,playPause:e.media.enable,scrubber:e.media.enable,"scrubber.chapters":e.media.enable,tools:e.tools.enable,"tools-display":e.tools.enable,tour:e.pagination.enable,"tour.chapters":e.pagination.enable,objectTree:e.search.enable,anatomyLabels:e.anatomyLabels.enable,share:!1,dissect:!1,xray:!1,annotations:!1,crossSection:!1,isolate:!1}}},{procName:PO.UISetDisplay,actionFn:e=>{const n=Pp.convertAPIUIConfigToUIConfig(e);return t.dispatch(new O(n)),e}},{procName:PO.UIResetDisplay,actionFn:()=>{const e=t.selectSnapshot(il.getInitialUI);t.dispatch(new Q.SetUI(e))}},{procName:PO.UISnapshot,aliases:[PO.SceneSnapshot],mapFnIn:e=>{const{width:t,height:n}=i.getCanvas();return Object.assign({width:t,height:n,openInTab:!1,fileType:"jpeg",quality:.92},e)},actionFn:e=>{const{width:i,height:o,openInTab:s,fileType:r}=e,a=t.selectSnapshot(Bo.getSelectedChapterId);return t.dispatch(new hn(a,"jpeg"===r?At.JPEG:At.PNG,.92,{width:i,height:o},"original",!0,!0)).pipe(Object(Oo.a)(()=>n.pipe(Object(d.j)(bn),Object(sl.a)(1))),Object(Oo.a)(e=>xo.blobToBase64(e.blob)),Object(Et.a)(e=>{s&&e&&function(e){const t=window.open("","_blank");if(t){const n=t.document.createElement("img");n.src=e,t.document.body.appendChild(n)}}(e)}),Object(_.a)(()=>Object(AO.of)(null)))}}]}(Human,this.store,this.actions,this.engineService).forEach(e=>{jO(e)}),function(e,t,n,i){return[...JO(e,t,n),...uC(e,t,n),{procName:PO.LabelsInfo,actionFn:e=>e.length>0?mC(t,e):t.selectSnapshot(Tr.getChapterLabels),mapFnOut:t=>wC(e,t)},{procName:PO.LabelsCreate,mapFnIn:e=>e.labelId&&bC(t,e.labelId)?null:e.objectId&&e.position?function(e,t,n,i){const o=n.makeDefaultStudioLabel();o.id=i.labelId||Un.idWithPrefix("label"),o.objectId=i.objectId,o.pos=i.position,o.renderableIndex=0,o.occludable=!0,o.flyTo=!0,o.description="",o.shown=!0;const s=t.selectSnapshot(Bo.getSelectedChapter);return o.chapterId=s.id,xC(o,i)}(0,t,n,e):(console.log("attempt to create a label with no objectId and position"),null),actionFn:e=>fC(t,e,!0),mapFnOut:t=>vC(e,t)},{procName:PO.LabelsUpdate,mapFnIn:e=>bC(t,e.labelId)?function(e,t){return xC(bC(e,t.labelId),t,e.selectSnapshot(Bo.getSelectedChapter))}(t,e):null,actionFn:e=>fC(t,e,!1),mapFnOut:t=>vC(e,t)},{procName:PO.LabelsCanvasUpdate,mapFnIn:e=>bC(t,e.labelId)?function(e,t,n){const i=bC(e,n.labelId),o=n.canvasPosition,s=t.pickScene({x:o[0],y:o[1],rayPick:!0});return s&&s.objectId?(i.objectId=s.objectId,i.pos=[s.worldPos[0],s.worldPos[1],s.worldPos[2]],i.offset=[i.hideWire?20:32,0],i.barycentric=[s.barycentric[0],s.barycentric[1],s.barycentric[2]],i.primitiveIndex=s.primitiveIndex,i.renderableIndex=s.renderableIndex||0,i):null}(t,i,e):null,actionFn:e=>fC(t,e,!1),mapFnOut:t=>vC(e,t)},{procName:PO.LabelsDestroy,mapFnIn:e=>bC(t,e),actionFn:e=>e?(t.dispatch(new oo(e)),{labelId:e.id}):null},{procName:PO.LabelsShow,actionFn:e=>(e.length>0?t.dispatch(new bo(mC(t,e),!0)):hC(t,!0),!0)},{procName:PO.LabelsHide,actionFn:e=>(e.length>0?t.dispatch(new bo(mC(t,e),!1)):hC(t,!1),!0)},{procName:PO.LabelsSetEnabled,aliases:[PO.AnnotationsSetEnabled],actionFn:e=>{t.dispatch(new Se(e.enable))},hideDefinition:!0},{procName:PO.LabelsSetScale,actionFn:e=>{t.dispatch(new lo(e.scale))}}]}(Human,this.store,this.labelsService,this.engineService).forEach(e=>{jO(e)}),function(e,t){function n(t){return e.selectSnapshot(Bi.getQuizModeActive)?t():{error:"quiz mode is not active"}}return[{procName:PO.QuizInfo,actionFn:()=>n(()=>SC(e))},{procName:PO.QuizSubmit,actionFn:i=>n(()=>(t.submitQuestion(i.questionId,i.answerIds),SC(e)))},{procName:PO.QuizQuestion,actionFn:()=>n(()=>MC(e))},{procName:PO.QuizEnter,actionFn:()=>e.selectSnapshot(Bi.hasQuiz)?(t.startQuiz(),!0):{error:"quiz not found"}},{procName:PO.QuizExit,actionFn:()=>(t.exitQuiz(),!0)},{procName:PO.QuizSelectQuestion,actionFn:t=>n(()=>(e.dispatch(new ji.SetActiveQuestion(t)),SC(e)))},{procName:PO.QuizNextQuestion,actionFn:()=>n(()=>(t.nextQuestion(),MC(e)))},{procName:PO.QuizPreviousQuestion,actionFn:()=>n(()=>(e.dispatch(new ji.SetQuizLifecycle(Di.Question)),e.dispatch(new ji.PreviousQuestion),MC(e)))},{procName:PO.QuizReset,actionFn:()=>(t.resetQuiz(),SC(e))},{procName:PO.QuizSet,actionFn:t=>{const{settings:n,startNumber:i,endNumber:o,locked:s}=t;if(!Object(X.isNil)(n)){const t=e.selectSnapshot(Bi.getQuizSettings);e.dispatch(new ji.SetQuizSettings(Object.assign(Object.assign({},t),n)))}if("number"==typeof i||"number"==typeof o){const t=zi(e.selectSnapshot(Bo.getStoryChapters)),n=t.slice("number"==typeof i?i-1:0,"number"==typeof o?o:t.length);e.dispatch(new ji.SetQuestions(n))}return"boolean"==typeof s&&e.dispatch(new ji.SetQuizLocked(s)),e.dispatch(new ji.SetQuizQuestionsMode("number"==typeof i&&"number"==typeof o?"restricted":"all")),SC(e)}}]}(this.store,this.quizService).forEach(e=>{jO(e)})}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(d.g),i.Zb(d.b),i.Zb(Lt),i.Zb(lt),i.Zb(Do),i.Zb(Jr),i.Zb(Bn),i.Zb(tt),i.Zb(Ip),i.Zb(L),i.Zb(ea),i.Zb(hg))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var LC=function(e){return e.Content="content",e.SceneJS="scenejs",e}({}),DC=function(e){return e.Auth="auth",e}({});class EC{constructor(e,t,n){this.category=e,this.message=t,this.log=n}}let FC=(()=>{class e{constructor(e){this.http=e,this.log={}}logError(e,t=!1){const n=`${e.category}${e.message}`;return t&&this.log[n]?Object(S.a)():(this.log[n]=!0,this.http.post("/ws/human-error",e))}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(C.b))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),AC=(()=>{class e{constructor(e,t,n){this.locationStrategy=e,this.router=t,this.errorLoggingService=n,window.SceneJS_error.setFatalErrorHandler(this.handleSceneJSFatalErrors.bind(this))}handleSceneJSFatalErrors(e){const t={log:Human.log.messages.join("\n"),stack:e.stackTrace,webglInfo:window.SceneJS.WEBGL_INFO},n={category:e.errorName,log:JSON.stringify(t),message:e.messageFromCaller};this.errorLoggingService.logError(n,!0).subscribe();const i=btoa(JSON.stringify(e));this.redirectToErrorPage(LC.SceneJS,void 0,i)}redirectToErrorPage(e,t,n){if((this.router.url||"").match("/error"))return;const i=this.locationStrategy.getBaseHref(),s=this.router.createUrlTree([c.application===o.Viewer?i+"/error":i+"/view/error"],{queryParams:{errorType:e,errorCode:t,errorBlob:n,errorUrl:this.router.url}}),r=this.router.serializeUrl(s);window.location.href=r}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(ms.h),i.Zb(Z.e),i.Zb(FC))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const RC=["*"];let NC=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-warning-message"]],ngContentSelectors:RC,decls:2,vars:0,consts:[[1,"message","p-4","text-12"]],template:function(e,t){1&e&&(i.kc(),i.Vb(0,"div",0),i.jc(1),i.Ub())},styles:[".message{background-color:#0060c4;color:#fff}@media print{.message{display:none}}"],encapsulation:2,changeDetection:0}),e})();var VC=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function HC(e,t){if(1&e){const e=i.Wb();i.Vb(0,"app-warning-message"),i.Vb(1,"div",1),i.Vb(2,"div",2),i.Mc(3),i.Ub(),i.Vb(4,"div"),i.Vb(5,"div",3),i.cc("click",(function(){return i.zc(e),i.gc().handleDismissClick()})),i.Qb(6,"app-icon",4),i.Ub(),i.Ub(),i.Ub(),i.Ub()}if(2&e){const e=i.gc();i.Db(3),i.Oc(" ",e.message," ")}}let BC=(()=>{class e{constructor(e,t){this.changeDetector=e,this.storageService=t,this.show=!1,this.message="For the full interactive 3D experience please try loading this content in Chrome or Firefox.",this.ngUnsubscribe=new $.a}ngOnInit(){this.initLayoutListener()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}handleDismissClick(){this.show=!1,this.storageService.setLocalItem(Dr.InternetExplorerWarning,!0)}shouldShow(e){const t=this.storageService.getLocalItem(Dr.InternetExplorerWarning);return qf()&&!t&&e.internetExplorerWarning.enable}initLayoutListener(){this.layout$.pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.show=this.shouldShow(e),this.changeDetector.markForCheck()})}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(i.i),i.Pb(Ar))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-ie-warning"]],decls:1,vars:1,consts:[[4,"ngIf"],[1,"warning"],[1,"warning__text"],[1,"warning__close",3,"click"],["icon","times","size","lg","title","Close"]],template:function(e,t){1&e&&i.Kc(0,HC,7,1,"app-warning-message",0),2&e&&i.lc("ngIf",!0===t.show)},directives:[ms.l,NC,$a],styles:[".warning[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:center}.warning__text[_ngcontent-%COMP%]{text-align:center;flex:1}.warning__close[_ngcontent-%COMP%]{cursor:pointer;align-items:center;justify-content:center;display:flex;width:32px;height:32px}"],changeDetection:0}),function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);s>3&&r&&Object.defineProperty(t,n,r)}([Object(d.d)(il.getUI),VC("design:type",q.a)],e.prototype,"layout$",void 0),e})(),QC=(()=>{class e{constructor(e,t){this.el=e,this.renderer=t}ngOnInit(){qf()||this.renderer.setStyle(this.el.nativeElement,"display","none")}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(i.m),i.Pb(i.H))},e.\u0275dir=i.Kb({type:e,selectors:[["","appShowIE11",""]]}),e})();function $C(e,t){1&e&&i.Qb(0,"div",4)}const qC={title:"We're unable to find the model you're looking for.",description:'Please check your URL or visit the <a href="/" target="_blank">BioDigital Human</a> to see what\'s available in our 3D model library.'},WC={title:"Your BioDigital Human embed requires proper authentication.",description:""},KC={[j.InvalidUAID]:{title:"Authentication Issues",description:"Your Human Widget has invalid user credentials.",url:"https://support.biodigital.com"}};function GC(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",13),i.cc("click",(function(){return i.zc(e),i.gc(2).handleSeeDetailsClick()})),i.Mc(1," See Details "),i.Ub()}}function ZC(e,t){if(1&e&&(i.Vb(0,"textarea",14),i.Mc(1,"        "),i.Ub()),2&e){const e=i.gc(2);i.lc("value",e.sceneJSErrorReport)}}function JC(e,t){if(1&e){const e=i.Wb();i.Vb(0,"div"),i.Vb(1,"h1",3),i.Mc(2," The BioDigital Human encountered an error. "),i.Ub(),i.Vb(3,"h2",4),i.Mc(4," Error: "),i.Vb(5,"span",5),i.Mc(6),i.Ub(),i.Ub(),i.Vb(7,"div",6),i.Mc(8," To receive assistance with this error, please follow these steps: "),i.Ub(),i.Vb(9,"ol",7),i.Vb(10,"li",8),i.Vb(11,"button",9),i.cc("click",(function(){return i.zc(e),i.gc().handleDownloadClick()})),i.Mc(12," Download "),i.Ub(),i.Mc(13," the error report. "),i.Ub(),i.Vb(14,"li",8),i.Vb(15,"button",9),i.cc("click",(function(){i.zc(e);const t=i.gc();return t.handleActionClick(t.supportURL)})),i.Mc(16," Share the report "),i.Ub(),i.Mc(17," with the customer support team. "),i.Ub(),i.Ub(),i.Vb(18,"div",10),i.Kc(19,GC,2,0,"button",11),i.Vb(20,"div"),i.Kc(21,ZC,2,1,"textarea",12),i.Ub(),i.Ub(),i.Ub()}if(2&e){const e=i.gc();i.Db(6),i.Nc(e.sceneJSErrorTeaser),i.Db(13),i.lc("ngIf",!e.viewSceneJSErrorDetails),i.Db(2),i.lc("ngIf",e.viewSceneJSErrorDetails)}}function XC(e,t){if(1&e){const e=i.Wb();i.Vb(0,"div",3),i.Mc(1),i.Ub(),i.Vb(2,"div",15),i.Tb(3),i.Vb(4,"button",9),i.cc("click",(function(){i.zc(e);const t=i.gc();return t.handleActionClick(t.supportURL)})),i.Mc(5," Contact Support "),i.Ub(),i.Sb(),i.Ub(),i.Qb(6,"div",16)}if(2&e){const e=i.gc();i.Db(1),i.Oc(" ",e.title," "),i.Db(5),i.lc("innerHTML",e.description,i.Ac)}}const YC=[{path:"",component:(()=>{class e{constructor(e,t,n,i,s,r,c,l,p,d,u){this.store=e,this.actions=t,this.activatedRoute=n,this.widgetAPIHandler=i,this.errorService=s,this.engineService=r,this.cameraService=c,this.storageService=l,this.renderer=p,this.viewService=d,this.quizService=u,this.title="Biodigital Human",this.environmentApplication=o,this.environmentPlatform=a,this.ngUnsubscribe=new $.a}ngOnInit(){this.initErrorHandling(),this.initInteractions();const e=this.activatedRoute.snapshot.data.widgetUrlConfig;this.initWidgetBreakpoints(e),this.initWidgetLabelScale(e),this.initWidgetLayout(e),this.initWidgetSetup(e),this.initWidgetAuth(),this.initSceneLoad(),this.initBackgroundFromWidget(e),this.initBackgroundFromChapter(),this.initCamera(e),this.initRotation(e),this.initQuizInteractions(e),this.widgetAPIHandler.listen(c.deploy===r.Production),this.initChaptersReadyListener(),this.initHumanReadyListener(),this.initDynamicLayout()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initWidgetSetup(e){const t=window!==window.top,n=t?BD_DOCUMENT_REFERRER:window.location.href;this.store.dispatch(new g(n,t,e));const i=this.store.selectSnapshot(il.getUI),o=Pp.convertUrlUIConfigToUIConfig(e),s=Pp.createLayoutFromConfig(i,o);this.store.dispatch(new Q.SetUI(s)),this.store.dispatch(new Q.SetInitialUI(s));const r=Pp.getScrollSetting(e);this.store.dispatch(new se(r));const a=Pp.getUsePrintImage(e),c=Pp.getOnDemand(e),{interactType:l,isInteractActive:p}=Pp.getInteractType(e,this.store.selectSnapshot(il.shouldWindowOpen(Fc.Interact)),this.store.selectSnapshot(il.getInteractType)),d=this.storageService.getLocalItem(Dr.GettingStartedTutorial),u=!0===o.tutorial&&"true"!==d;this.store.dispatch([new Q.SetOnDemand(c),new Q.ToggleWindow(Fc.OnDemand,c),new Q.SetInteractType(l),new Q.ToggleWindow(Fc.Interact,p),new Q.ToggleWindow(Fc.Tutorial,u),new Q.StartTutorial(u),new Q.SetUsePrintImage(a)])}initWidgetAuth(){this.store.selectSnapshot(B.getEmbedded)&&this.store.dispatch(new f)}initViewAnalytics(){const e=["loaded","interactive","complete"].includes(document.readyState);(e?Object(S.a)(e):Object(as.a)(document,"DOMContentLoaded")).pipe(Object(sl.a)(1),Object(W.a)(this.ngUnsubscribe)).subscribe(()=>{this.store.dispatch(new h(R.View))})}initInteractionAnalytics(){Object(ss.a)(this.interactionChance$,this.firstInteraction$).pipe(Object(sl.a)(1),Object(W.a)(this.ngUnsubscribe)).subscribe(()=>{this.store.dispatch(new h(R.ChanceInteraction))}),this.firstInteraction$.pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(()=>{this.store.dispatch(new h(R.FirstInteraction))})}initSceneLoad(){this.actions.pipe(Object(d.j)(Ls),Object(W.a)(this.ngUnsubscribe)).subscribe(()=>{this.initViewAnalytics(),this.initInteractionAnalytics()})}initErrorHandling(){this.actions.pipe(Object(d.j)($s),Object(W.a)(this.ngUnsubscribe)).subscribe(()=>this.handleContentErrors()),this.actions.pipe(Object(d.j)(x),Object(W.a)(this.ngUnsubscribe)).subscribe(e=>this.handleAuthErrors(e))}initWidgetBreakpoints({"ui-collapse-label":e,"annotation-collapse":t}){const n=[e,t].find(e=>!Object(X.isNil)(e));Object(X.isNil)(n)||this.store.dispatch(new Q.SetLabelBreakpoint(n))}initWidgetLabelScale({"label-scale":e}){Object(X.isNil)(e)||this.store.dispatch(new lo(e))}initWidgetLayout({"ui-layout":e}){Object(X.isNil)(e)||this.store.dispatch(new Q.SetLayout(e))}initQuizInteractions(e){this.store.select(Bi.hasQuiz).pipe(Object(K.a)(e=>e),Object(sl.a)(1),Object(W.a)(this.ngUnsubscribe)).subscribe(()=>{const t=this.store.selectSnapshot(Bi.getAllQuestions);this.store.dispatch(new ji.SetQuizEnabled(""+e.uiQuiz!="false"));const n=e["ui-quiz-locked"];this.store.dispatch(new ji.SetQuizLocked(""+n=="true"));const i=parseInt(e["ui-quiz-start"],10),o=parseInt(e["ui-quiz-end"],10),s=t.length,r=isNaN(i)?1:i,a=isNaN(o)?s:o;if(1!==r||a!==s){const e=t.filter((e,t)=>{const n=t+1;return n>=r&&n<=a});this.store.dispatch(new ji.SetQuestions(e))}const c=isNaN(i)&&isNaN(o)?"all":"restricted";this.store.dispatch(new ji.SetQuizQuestionsMode(c)),n&&setTimeout(()=>{this.quizService.startQuiz()})})}initInteractions(){const e=this.getCanvasInteraction(),t=this.actions.pipe(Object(d.j)($n.UpdateNodeSelected,$n.UpdateNodesChecked,$n.UpdateNodesShown,$n.UpdateNodesPickable,$n.UpdateNodesPaint));this.interactionReady$=this.store.select(Bo.getSelectedChapter).pipe(Object(K.a)(e=>e&&e.readyState.model),Object(sl.a)(1));const n=this.engineService.getCanvas();this.interactionChance$=Object(Xs.a)(this.interactionReady$,this.getIntersectionObserver(n,.75)).pipe(Object(sl.a)(1)),this.firstInteraction$=Object(ss.a)(e,t).pipe(Object(ev.a)(this.interactionReady$),Object(sl.a)(1))}initBackgroundFromWidget({background:e}){e&&(this.setWidgetTransparent(Pn.isTransparent(e)),this.actions.pipe(Object(d.i)(qt),Object(sl.a)(1),Object(W.a)(this.ngUnsubscribe)).subscribe(()=>{this.store.dispatch(new rn(e))}))}initBackgroundFromChapter(){this.store.select(Bo.getSelectedChapter).pipe(Object(K.a)(e=>null!=e),Object(k.a)(e=>Pn.isTransparent(e.background)),Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.setWidgetTransparent(e)})}initCamera({camera:e}){e&&this.actions.pipe(Object(d.j)(Hs),Object(sl.a)(1),Object(W.a)(this.ngUnsubscribe)).subscribe(()=>{this.store.dispatch(new bt(e,!1))})}initRotation({"load-rotate":e}){if(e){let t=performance.now();Object(kO.a)(0,_O.a).pipe(Object(k.a)(()=>e*(performance.now()-t)*.001),Object(Et.a)(()=>t=performance.now()),Object(W.a)(this.firstInteraction$),Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{this.cameraService.rotateCameraStatic(0,e)}),this.firstInteraction$.pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(()=>{const e=this.store.selectSnapshot(Bo.getSelectedChapter),t=Object(X.get)(e,"camera.location");t&&this.store.dispatch(new bt(t,!0,2))})}}initHumanReadyListener(){this.actions.pipe(Object(d.j)(c.platform===a.SDK?Js:Zs)).pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(()=>{this.engineService.fireEvent(it.Started,null)})}initChaptersReadyListener(){this.store.select(Bo.getAllChaptersModelsReady).pipe(Object(K.a)(e=>!0===e),Object(W.a)(this.ngUnsubscribe)).subscribe(()=>{this.store.dispatch(new Zs),this.engineService.fireEvent(it.TimelineChaptersActivated,{oldChapterIndex:0,newChapterIndex:0,time:0})})}initDynamicLayout(){Object(rs.b)([this.store.select(B.getWidgetApiUIConfig),this.store.select(B.getWidgetUrlConfig),this.store.select(Bo.getSelectedChapter),this.store.select(Bi.getQuizModeActive),this.store.select(Bi.getActiveQuestion)]).pipe(Object(K.a)(([e,t,n])=>null!=n&&null!=t),Object(W.a)(this.ngUnsubscribe)).subscribe(([e,t,n,i,o])=>{const s=Pp.convertUrlUIConfigToUIConfig(t),r=Pp.chapterUItoUIConfig(n.ui),a=Pp.generateQuizUIConfig();this.viewService.setUI({apiUIConfig:e,urlUIConfig:s,chapterUIConfig:r,quizUIConfig:i?a:null})})}handleContentErrors(){this.store.dispatch(new Rs(null,null)),this.errorService.redirectToErrorPage(LC.Content)}handleAuthErrors(e){c.deploy!==r.Local&&this.errorService.redirectToErrorPage(DC.Auth,e.response.errorCode)}getCanvasInteraction(){let e;return new q.a(t=>{const n=this.engineService.getCanvas();e=new Gr.Manager(n),e.add([new Gr.Tap({event:"singletap"}),new Gr.Tap({event:"doubletap",taps:2}),new Gr.Pan({event:"pan",direction:Gr.DIRECTION_ALL,threshold:0})]);const i=(()=>t.next()).bind(this);e.on("panstart",i),e.on("singletap",i)}).pipe(Object(E.a)(()=>{e&&(e.destroy(),e=null)}),Object(W.a)(this.ngUnsubscribe))}getIntersectionObserver(e,t){return new q.a(n=>{const i=new IntersectionObserver(o=>{o[0].intersectionRatio>=t&&(n.next(e),n.complete(),i.unobserve(e))},{root:null,threshold:t});i.observe(e)})}setWidgetTransparent(e){e?this.renderer.setStyle(document.body,"background","none transparent"):this.renderer.removeStyle(document.body,"background")}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.g),i.Pb(d.b),i.Pb(Z.a),i.Pb(UC),i.Pb(AC),i.Pb(lt),i.Pb(Lt),i.Pb(Ar),i.Pb(i.H),i.Pb(Ip),i.Pb(hg))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-widget-master"]],decls:5,vars:3,consts:[[1,"widget","theme-light"],[1,"widget__messages","pt-2","pr-2","pl-2"],["appShowIE11",""],["class","widget-shell",4,"appFlagApplication","appFlagApplicationPlatform","appFlagApplicationMode"],[1,"widget-shell"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Qb(1,"router-outlet"),i.Vb(2,"div",1),i.Qb(3,"app-ie-warning",2),i.Ub(),i.Ub(),i.Kc(4,$C,1,0,"div",3)),2&e&&(i.Db(4),i.lc("appFlagApplication",t.environmentApplication.All)("appFlagApplicationPlatform",t.environmentPlatform.SDK)("appFlagApplicationMode","exclude"))},directives:[Z.g,BC,QC,sc],styles:[".widget__messages[_ngcontent-%COMP%]{display:flex;flex-direction:column;z-index:101}.widget-shell[_ngcontent-%COMP%], .widget__messages[_ngcontent-%COMP%]{position:fixed;top:0;left:0;right:0}.widget-shell[_ngcontent-%COMP%]{pointer-events:none;bottom:0;z-index:99999;border:var(--widget-shell-border)}"]}),e})(),resolve:{widgetUrlConfig:SO},children:[{path:"",component:CO},{path:"error",component:(()=>{class e{constructor(e,t){this.route=e,this.snackBar=t,this.supportURL="https://support.biodigital.com",this.isSceneJSError=!1,this.viewSceneJSErrorDetails=!1}handleSeeDetailsClick(){this.viewSceneJSErrorDetails=!0}buildSceneJSErrorReport(e,t){return{contentId:e,error:JSON.parse(atob(t)),webglInfo:window.SceneJS.WEBGL_INFO}}get title(){return this.errorConfig.title}get description(){return this.errorConfig.description}ngOnInit(){const{errorType:e,errorCode:t,errorBlob:n,errorUrl:i}=this.route.snapshot.queryParams;if(e===LC.SceneJS){this.isSceneJSError=!0;const e=this.buildSceneJSErrorReport(i,n);this.sceneJSErrorTeaser=e.error.errorName,this.sceneJSErrorReport=JSON.stringify(e,null,2)}else this.errorConfig=e===LC.Content?qC:KC[t]||WC}handleDownloadClick(){Object(jo.saveAs)(new Blob([this.sceneJSErrorReport],{type:"text/plain"}),"BioDigital_Error_Report.txt")}handleActionClick(e){window.open(e)||this.snackBar.open("Unable to open link in new window, please check your pop-up settings.")}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(Z.a),i.Pb(Wa.b))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-error-page"]],decls:4,vars:2,consts:[[1,"error"],[4,"ngIf","ngIfElse"],["notSceneJSError",""],[1,"text-24","text-bold"],[1,"text-16","mt-4","mb-8"],[1,"text-semibold"],[1,"text-16","mb-4"],[1,"text-16"],[1,"mv-4"],["app-button","","buttonType","outline","buttonTheme","light",3,"click"],[1,"mt-8"],["app-button","","buttonType","outline","buttonTheme","light","buttonSize","xsmall",3,"click",4,"ngIf"],["class","error__details mt-2",3,"value",4,"ngIf"],["app-button","","buttonType","outline","buttonTheme","light","buttonSize","xsmall",3,"click"],[1,"error__details","mt-2",3,"value"],[1,"flex","items-start","mt-10"],[1,"error__description","text-16","mt-8",3,"innerHTML"]],template:function(e,t){if(1&e&&(i.Vb(0,"div",0),i.Kc(1,JC,22,3,"div",1),i.Kc(2,XC,7,2,"ng-template",null,2,i.Lc),i.Ub()),2&e){const e=i.vc(3);i.Db(1),i.lc("ngIf",t.isSceneJSError)("ngIfElse",e)}},directives:[ms.l,nc],styles:[".error[_ngcontent-%COMP%]{margin:0 auto;max-width:640px;display:flex;flex-direction:column;padding:40px;color:#283853}.error[_ngcontent-%COMP%]   ol[_ngcontent-%COMP%]{list-style:decimal}.error__details[_ngcontent-%COMP%]{width:100%;height:200px}.error__description[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .error__description[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:visited{color:#283853}"],changeDetection:0}),e})()}]}],eS=!0===c.offline?Z.f.forRoot(YC,{useHash:!0}):Z.f.forRoot(YC);let tS=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},providers:[SO],imports:[[eS],Z.f]}),e})();var nS=n("f6nW"),iS=n("FvrZ"),oS=n("bSwM"),sS=n("FKr1"),rS=n("bTqV"),aS=n("d3UM"),cS=n("/t3+"),lS=n("jaxi"),pS=n("XhcP"),dS=n("bv9b");const uS={disabled:!0,animation:{enterDuration:0,exitDuration:0}},gS=Object.assign(Object.assign({},Object(Rd.b)()),{touchGestures:"off"});let hS=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},providers:[{provide:Wa.a,useValue:{duration:3e3}},{provide:sS.d,useValue:uS},{provide:Rd.a,useValue:gS}],imports:[[Ao.b,nS.a,oS.a,oS.a,rS.b,Sh.c,aS.a,ic.c,cS.a,lS.a,Td.f,Rd.d,Wa.c,rc.b,pS.a,ma.g,kg.f,jg.f],Ao.b,nS.a,iS.a,oS.a,oS.a,rS.b,Sh.c,aS.a,ic.c,cS.a,lS.a,Td.f,Rd.d,Wa.c,rc.b,pS.a,ma.g,kg.f,jg.f,dS.a]}),e})();var bS=n("R9Cn");let mS=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[hS,gu.i,ms.c]]}),e})(),fS=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[ms.c,gu.i]]}),e})();class yS{}function xS(){return window}let vS=(()=>{class e{constructor(e){if(!e.accountUrl)throw new Error("Missing accountUrl. Please set in app config via ZendeskWidgetProvider");this.window=xS();let t=this.window;t.zEmbed||function(n,i){var o,s,r,a,c=[],l=document.createElement("iframe");t.zEmbed=function(){c.push(arguments)},t.zE=t.zE||t.zEmbed,l.src="javascript:false",l.title="",l.style.cssText="display: none",(r=(r=document.getElementsByTagName("script"))[r.length-1]).parentNode.insertBefore(l,r),a=l.contentWindow.document;try{s=a}catch(n){o=document.domain,l.src='javascript:var d=document.open();d.domain="'+o+'";void(0);',s=a}s.open()._l=function(){var t=this.createElement("script");o&&(this.domain=o),t.id="js-iframe-async",t.src="https://assets.zendesk.com/embeddable_framework/main.js",this.t=+new Date,this.zendeskHost=e.accountUrl,this.zEQueue=c,this.body.appendChild(t)},s.write('<body onload="document._l();">'),s.close()}(),this.window.zE(()=>{e.beforePageLoad(this.window.zE)})}setLocale(e){this.window.zE(()=>{this.window.zE.setLocale(e)})}identify(e){const t={name:this.getUserFullName(e),email:e.email};this.window.zE(()=>{this.window.zE.identify(t)})}hide(){this.window.zE(()=>{this.window.zE.hide()})}show(){this.window.zE(()=>{this.window.zE.show()})}activate(e){this.window.zE(()=>{this.window.zE.activate(e)})}setHelpCenterSuggestions(e){this.window.zE(()=>{this.window.zE.setHelpCenterSuggestions(e)})}setSettings(e){this.window.zESettings=e}updateFromProfile(e){const t=[];if(null!=e){const{premium_account:n,premium_account_type:i,developer_account:o,subscription:s}=e;n?(t.push("premium_account_"+i),s&&t.push("subscription_"+s.subscription_provider)):t.push("free_account"),o&&t.push("developer_account")}const n=Object(X.get)(e,"premium_account_valid",!1);this.setSettings({webWidget:{position:{horizontal:"right",vertical:"bottom"},offset:{horizontal:"0px",vertical:"0px"},contactForm:{suppress:!n,tags:t,fields:[{id:"name",prefill:{"*":this.getUserFullName(e)}}]}}})}getUserFullName(e){if(e){const{first_name:t,last_name:n}=e;return`${t} ${n}`}return""}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(yS))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),wS=(()=>{class e{static forRoot(t){return{ngModule:e,providers:[{provide:t,useClass:t},{provide:vS,useClass:vS,deps:[t]}]}}}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[ms.c]]}),e})();class OS extends yS{constructor(){super(...arguments),this.accountUrl="biodigital.zendesk.com"}beforePageLoad(e){e.setLocale("en"),e.hide()}}let CS=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[wS.forRoot(OS)]]}),e})(),SS=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[ms.c]]}),e})(),kS=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[ms.c,SS,hS]]}),e})();function _S(e,t){if(1&e){const e=i.Wb();i.Vb(0,"div",6),i.cc("click",(function(){i.zc(e);const t=i.gc(2).$implicit;return i.gc().handleExpandClick(t,!0)})),i.Ub()}if(2&e){const e=i.gc(2).$implicit;i.lc("title",e.label)}}function jS(e,t){if(1&e&&(i.Vb(0,"div",4),i.Kc(1,_S,1,1,"div",5),i.Qb(2,"app-tree-group",2),i.Ub()),2&e){const e=i.gc().$implicit,t=i.gc();i.Db(1),i.lc("ngIf",t.hasChildren(e)),i.Db(1),i.lc("graph",t.graph)("node",e)("theme",t.theme)}}const PS=function(e,t){return{"tree-group--light":e,"tree-group--themed":t}};function MS(e,t){if(1&e&&(i.Vb(0,"div",1),i.Qb(1,"app-tree-nested-node",2),i.Kc(2,jS,3,4,"div",3),i.Ub()),2&e){const e=t.$implicit,n=i.gc();i.lc("ngClass",i.pc(5,PS,n.theme===n.treeTheme.Light,n.theme===n.treeTheme.Themed)),i.Db(1),i.lc("graph",n.graph)("node",e)("theme",n.theme),i.Db(1),i.lc("ngIf",e.boolState.expanded)}}let IS=(()=>{class e{constructor(e,t){this.graphService=e,this.store=t,this.treeTheme=ga,this.graphSubject=new os.a(null),this.theme=ga.Dark,this.nodes=[],this.ngUnsubscribe=new $.a}get graph(){return this._graph}set graph(e){e&&(this._graph=e,this.graphSubject.next(e))}ngOnInit(){this.graphSubject.pipe(Object(W.a)(this.ngUnsubscribe)).subscribe(e=>{e&&this.getNodes()})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}getNodes(){const e=this.node?Ye.getSuccessors(this.graph,this.node.id):Ye.getRoots(this.graph);this.nodes=this.graphService.getNodes(this.graph,e)}countChildren(e){return Ye.getSuccessors(this.graph,e.id).length}hasChildren(e){return this.countChildren(e)>0}trackTreeNode(e,t){return t.id}handleExpandClick(e,t){this.store.dispatch(t?new Be(e):new He(e))}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(tt),i.Pb(d.g))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-tree-group"]],inputs:{graph:"graph",theme:"theme",node:"node"},decls:1,vars:2,consts:[["class","tree-group",3,"ngClass",4,"ngFor","ngForOf","ngForTrackBy"],[1,"tree-group",3,"ngClass"],[3,"graph","node","theme"],["class","tree-group__children",4,"ngIf"],[1,"tree-group__children"],["class","tree-group__collapse",3,"title","click",4,"ngIf"],[1,"tree-group__collapse",3,"title","click"]],template:function(e,t){1&e&&i.Kc(0,MS,3,8,"div",0),2&e&&i.lc("ngForOf",t.nodes)("ngForTrackBy",t.trackTreeNode)},directives:[ms.k,ms.i,Mc,ms.l,e],styles:['.text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3838}.text-info[_ngcontent-%COMP%]{color:#0060c4}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.tree-group[_ngcontent-%COMP%]{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.tree-group--themed[_ngcontent-%COMP%]   .tree-group__collapse[_ngcontent-%COMP%]:after{background:var(--tree-node-collapse-color)}.tree-group--themed[_ngcontent-%COMP%]   .tree-group__collapse[_ngcontent-%COMP%]:hover{background:transparent}.tree-group--themed[_ngcontent-%COMP%]   .tree-group__collapse[_ngcontent-%COMP%]:hover:after{background:var(--tree-node-collapse-color--hover)}.tree-group--light[_ngcontent-%COMP%]   .tree-group__collapse[_ngcontent-%COMP%]:after{background:#eaeff5}.tree-group--light[_ngcontent-%COMP%]   .tree-group__collapse[_ngcontent-%COMP%]:hover{background:transparent}.tree-group--light[_ngcontent-%COMP%]   .tree-group__collapse[_ngcontent-%COMP%]:hover:after{background:#d7e0ea}.tree-group__children[_ngcontent-%COMP%]{padding-left:20px;position:relative}.tree-group__collapse[_ngcontent-%COMP%]{position:absolute;left:0;top:0;bottom:0;width:20px;z-index:1}.tree-group__collapse[_ngcontent-%COMP%]:after{content:" ";display:block;position:absolute;width:1px;left:10px;top:0;bottom:0;background:#1c2a3f}.tree-group__collapse[_ngcontent-%COMP%]:hover{cursor:pointer}.tree-group__collapse[_ngcontent-%COMP%]:hover:after{background:#283853}'],changeDetection:0}),e})(),zS=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[ms.c]]}),e})(),TS=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[ms.c,zS,hS,kS,SS,J.d]]}),e})(),US=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[ms.c,SS,hS,TS,zS,J.d]]}),e})();i.Dc(ha,[IS],[ms.b]);let LS=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[ms.c]]}),e})(),DS=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[ms.c,fg.b,hS,LS,zS]]}),e})(),ES=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[ms.c]]}),e})(),FS=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[ms.c]]}),e})(),AS=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[ms.c,kS,hS,J.d]]}),e})(),RS=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[ms.c]]}),e})(),NS=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[ms.c,LS]]}),e})(),VS=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[ms.c,SS]]}),e})(),HS=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[Z.f,kS,DS,bS.a,NS,ms.c,zS,SS,ES,mS,hS,VS,TS,AS,FS,LS,gu.q,fS,RS,US,CS,cd.a.forChild()],kS,DS,NS,zS,ES,SS,mS,VS,TS,FS,AS,LS,fS,RS,US]}),e})();class BS{}let QS=(()=>{class e{constructor(e){this.widgetURL=e}}return e.type="[Publish] Set Widget URL",e})(),$S=(()=>{class e{constructor(e){this.dimensions=e}}return e.type="[Publish] Set Dimensions",e})(),qS=(()=>{class e{constructor(e,t,n){this.model=e,this.widgetOptions=t,this.camera=n}}return e.type="[Publish] Get iFrame",e})(),WS=(()=>{class e{constructor(e){this.embed=e}}return e.type="[Publish] Get iFrame Success",e})(),KS=(()=>{class e{constructor(){}}return e.type="[Publish] Get iFrame Fail",e})(),GS=(()=>{class e{constructor(e,t,n){this.model=e,this.widgetOptions=t,this.camera=n}}return e.type="[Publish] Get URL",e})(),ZS=(()=>{class e{constructor(e,t){this.model=e,this.url=t}}return e.type="[Publish] Get URL Success",e})(),JS=(()=>{class e{constructor(e){this.model=e}}return e.type="[Publish] Get URL Fail",e})(),XS=(()=>{class e{constructor(e){this.publishing=e}}return e.type="[Publish] Set Publishing",e})(),YS=(()=>{class e{constructor(){}}return e.type="[Publish] Reset Publishing",e})(),ek=(()=>{class e{constructor(e,t="jpeg"){this.imageData=e,this.imageType=t}}return e.type="[Publish] Save Publish Image",e})(),tk=(()=>{class e{constructor(e){this.imageURL=e}}return e.type="[Publish] Save Publish Image Success",e})(),nk=(()=>{class e{constructor(){}}return e.type="[Publish] Save Publish Image Fail",e})(),ik=(()=>{class e{constructor(e,t,n,i,o){this.model=e,this.imageData=t,this.fileType=n,this.widgetOptions=i,this.camera=o}}return e.type="[Publish] Get Publish Image Code",e})(),ok=(()=>{class e{constructor(e){this.embed=e}}return e.type="[Publish] Get Publish Image Code Success",e})(),sk=(()=>{class e{constructor(){}}return e.type="[Publish] Get Publish Image Code Fail",e})();class rk{}let ak=(()=>{class e{constructor(){}}return e.type="[Auth] Is Logged In",e})(),ck=(()=>{class e{constructor(){}}return e.type="[Auth] Is Logged In Success",e})(),lk=(()=>{class e{constructor(){}}return e.type="[Auth] Is Logged In Failure",e})(),pk=(()=>{class e{constructor(e){this.login=e}}return e.type="[Auth] Login With Biodigital",e})(),dk=(()=>{class e{constructor(e){this.login=e}}return e.type="[Auth] Login With Google",e})(),uk=(()=>{class e{constructor(e){this.login=e}}return e.type="[Auth] Login With Facebook",e})(),gk=(()=>{class e{constructor(e,t){this.loginType=e,this.response=t}}return e.type="[Auth] Login Success",e})(),hk=(()=>{class e{constructor(e,t,n){this.loginType=e,this.error=t,this.login=n}}return e.type="[Auth] Login Failure",e})(),bk=(()=>{class e{constructor(){}}return e.type="[Auth] Logout",e})(),mk=(()=>{class e{constructor(){}}return e.type="[Auth] Logout Success",e})(),fk=(()=>{class e{constructor(){}}return e.type="[Auth] Logout Failure",e})(),yk=(()=>{class e{constructor(){}}return e.type="[Auth] Get Environment Settings",e})(),xk=(()=>{class e{constructor(e){this.environmentSettings=e}}return e.type="[Auth] Get Environment Settings Success",e})(),vk=(()=>{class e{constructor(e){this.error=e}}return e.type="[Auth] Get Environment Settings Failure",e})(),wk=(()=>{class e{constructor(e=!1){this.hardCheck=e}}return e.type="[Auth] Get User Profile",e})(),Ok=(()=>{class e{constructor(e){this.userProfile=e}}return e.type="[Auth] Get User Profile Success",e})(),Ck=(()=>{class e{constructor(e){this.error=e}}return e.type="[Auth] Get User Profile Failure",e})(),Sk=(()=>{class e{constructor(e){this.userProfile=e}}return e.type="[Auth] Update User Profile",e})(),kk=(()=>{class e{constructor(e){this.userProfile=e}}return e.type="[Auth] Update User Profile Success",e})(),_k=(()=>{class e{constructor(e){this.error=e}}return e.type="[Auth] Update User Profile Failure",e})(),jk=(()=>{class e{constructor(){}}return e.type="[Auth] Delete User Profile",e})(),Pk=(()=>{class e{constructor(e){this.userEmail=e}}return e.type="[Auth] Delete User Profile Success",e})(),Mk=(()=>{class e{constructor(e){this.error=e}}return e.type="[Auth] Delete User Profile Failure",e})(),Ik=(()=>{class e{constructor(e){this.email=e}}return e.type="[Auth] Check Profile",e})(),zk=(()=>{class e{constructor(e){this.profile=e}}return e.type="[Auth] Check Profile Success",e})(),Tk=(()=>{class e{constructor(e){this.error=e}}return e.type="[Auth] Check Profile Failure",e})(),Uk=(()=>{class e{constructor(){}}return e.type="[Auth] Get User Roles",e})(),Lk=(()=>{class e{constructor(e){this.email=e}}return e.type="[Auth] Reset Password",e})(),Dk=(()=>{class e{constructor(e){this.email=e}}return e.type="[Auth] Reset Password Success",e})(),Ek=(()=>{class e{constructor(e){this.error=e}}return e.type="[Auth] Reset Password Failure",e})(),Fk=(()=>{class e{constructor(e,t,n){this.currentPassword=e,this.newPassword=t,this.confirmNewPassword=n}}return e.type="[Auth] Update Password",e})(),Ak=(()=>{class e{constructor(){}}return e.type="[Auth] Update Password Success",e})(),Rk=(()=>{class e{constructor(e){this.error=e}}return e.type="[Auth] Update Password Failure",e})(),Nk=(()=>{class e{constructor(){}}return e.type="[Auth] Check Session",e})(),Vk=(()=>{class e{constructor(e){this.value=e}}return e.type="[Auth] Sign Up",e})(),Hk=(()=>{class e{constructor(e){this.response=e}}return e.type="[Auth] Sign Up Success",e})(),Bk=(()=>{class e{constructor(e){this.error=e}}return e.type="[Auth] Sign Up Failure",e})(),Qk=(()=>{class e{constructor(e){this.locale=e}}return e.type="[Auth] Set User Locale",e})(),$k=(()=>{class e{constructor(e){this.locale=e}}return e.type="[Auth] Set User Locale Success",e})(),qk=(()=>{class e{constructor(){}}return e.type="[Auth] Check Locale",e})(),Wk=(()=>{class e{constructor(){}}return e.type="[Auth] Get User Apps",e})(),Kk=(()=>{class e{constructor(e){this.apps=e}}return e.type="[Auth] Set User Apps",e})(),Gk=(()=>{class e{constructor(){}}return e.type="[Auth] Check Selected App",e})(),Zk=(()=>{class e{constructor(e){this.appId=e}}return e.type="[Auth] Set Selected User App",e})(),Jk=(()=>{class e{constructor(e){this.message=e}}return e.type="[Auth] Send User Message",e})(),Xk=(()=>{class e{constructor(e){this.message=e}}return e.type="[Auth] Send User Message Success",e})(),Yk=(()=>{class e{constructor(e){this.err=e}}return e.type="[Auth] Send User Message Fail",e})(),e_=(()=>{class e{constructor(e,t){this.type=e,this.mode=t}}return e.type="[Auth] Get User Message",e})(),t_=(()=>{class e{constructor(e){this.message=e}}return e.type="[Auth] Get User Message Success",e})(),n_=(()=>{class e{constructor(e){this.type=e}}return e.type="[Auth] Get User Message Fail",e})(),i_=(()=>{class e{constructor(e){this.messageSeenId=e}}return e.type="[Auth] Set Message Viewed",e})(),o_=(()=>{class e{constructor(){}}return e.type="[Auth] Set Message Viewed Success",e})(),s_=(()=>{class e{constructor(){}}return e.type="[Auth] Set Message Viewed Fail",e})(),r_=(()=>{class e{constructor(){}}return e.type="[Auth] Verify Fail",e})(),a_=(()=>{class e{constructor(){}}return e.type="[Auth] Reset",e})();class c_{}var l_=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let p_=(()=>{class e{}return function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);s>3&&r&&Object.defineProperty(t,n,r)}([Object(I.Type)(()=>c_),l_("design:type",Array)],e.prototype,"organizations",void 0),e})();var d_=n("ahC7");class u_{static fromJSON(e){const t=new u_;return t.email=e.user_email,t.credentials=e.credentials,t.isUser=e.is_user,t.isThirdParty=e.user_is_third_party,t.thirdPartyProvider=e.user_third_party_provider,t.isDeveloper=e.user_is_developer,t.isDeveloperActive=e.user_is_developer_active,t.isDeveloperVerified=e.user_is_developer_verified,t.firstName=e.user_first_name,t.lastName=e.user_last_name,t.name=`${e.firstName} ${e.lastName}`,t}}class g_{static fromJSON(e){const t=new g_;return t.google=e.google_api_key,t.facebook=e.facebook_api_key,t}}class h_{constructor(){this.version=2,this.groupInviteMode=0,this.groupCodeMode=0}}class b_ extends h_{constructor(){super(...arguments),this.version=2}static toJSON(e){return{version:e.version,email:e.email,password:e.password,first_name:e.firstName,last_name:e.lastName,group_invite_mode:e.groupInviteMode,group_invite_key:e.groupInviteKey,group_code_mode:e.groupCodeMode,group_code:e.groupCode,platform:e.platform,return_to:e.returnTo,brand_id:e.brandId,locale_id:e.localeId,timestamp:e.timestamp,site_verify_response:e.site_verify_response}}}class m_ extends h_{constructor(e){super(),this.token=e}static toJSON(e){return{id_token:e.token,version:e.version,group_invite_mode:e.groupInviteMode,group_invite_key:e.groupInviteKey,group_code_mode:e.groupCodeMode,group_code:e.groupCode,platform:e.platform,return_to:e.returnTo,brand_id:e.brandId,locale_id:e.localeId,timestamp:e.timestamp,site_verify_response:e.site_verify_response}}}class f_ extends h_{constructor(e){super(),this.token=e}static toJSON(e){return{access_token:e.token,version:e.version,group_invite_mode:e.groupInviteMode,group_invite_key:e.groupInviteKey,group_code_mode:e.groupCodeMode,group_code:e.groupCode,platform:e.platform,return_to:e.returnTo,brand_id:e.brandId,locale_id:e.localeId,timestamp:e.timestamp,site_verify_response:e.site_verify_response}}}class y_ extends h_{constructor(e,t,n){super(),this.email=e,this.password=t,this.rememberMe=n}static toJSON(e){return{id_token:e.token,version:e.version,group_invite_mode:e.groupInviteMode,group_invite_key:e.groupInviteKey,group_code_mode:e.groupCodeMode,group_code:e.groupCode,email:e.email,password:e.password,email_remember_me:e.rememberMe,platform:e.platform,return_to:e.returnTo,brand_id:e.brandId,locale_id:e.localeId,timestamp:e.timestamp,site_verify_response:e.site_verify_response}}}var x_=function(e){return e.Zendesk="zendesk",e}({});class v_{}var w_=n("jCJ1");const O_=["harvard.edu"];let C_=(()=>{class e{constructor(e,t,n){this.http=e,this.socialAuthService=t,this.reCaptchaV3Service=n,this.auth2=new os.a(null),this.initGoogleAuth2()}loginWithBiodigital(e){return this.http.post("/ws/user/sign/in",y_.toJSON(e))}loginWithGoogle(e){return this.http.post("/ws/user/sign/in/google",m_.toJSON(e))}loginWithFacebook(e){return this.http.post("/ws/user/sign/in/facebook",f_.toJSON(e))}logout(){return this.http.get("/ws/user/sign/out")}checkProfile(e){return this.http.post("/ws/user/profile/check",{version:2,email:e}).pipe(Object(k.a)(e=>{const t=u_.fromJSON(e);return t.isThirdParty=""!==t.thirdPartyProvider,t}))}getUserProfile(e){return this.http.get(e?"/ws/user/profile?subscription_hard_check=1":"/ws/user/profile").pipe(Object(k.a)(e=>{"string"==typeof e.organizations&&(e.organizations=JSON.parse(e.organizations));const t=Object(I.plainToClass)(p_,e);return t.organizations.forEach(e=>{const t=Object(X.get)(e,"user_role",Pw);e.user_role=zw(t)}),t}))}getUserRoles(){return this.http.get("/ws/enterprise/user/roles").pipe(Object(k.a)(e=>e.user_roles.map(e=>zw(Object(I.plainToClass)(v_,e)))))}updaterUserProfile(e){return this.http.post("/ws/user/profile",e)}deleteUserProfile(){return this.http.post("/ws/user/profile/delete",{}).pipe(Object(k.a)(e=>e.deleted_user_email))}getEnvironmentSettings(){return this.http.get("/ws/environment/settings?version=2").pipe(Object(k.a)(e=>g_.fromJSON(e)))}getUserApps(){return this.http.get("/ws/developer/apps/profile").pipe(Object(k.a)(e=>e&&e.apps?JSON.parse(e.apps):[]))}getGroupConfigFromRoute(e){const t=e.queryParams.group||"",n=e.queryParams.group_invite||"";return{group:t,groupCode:e.queryParams.code||"",groupCodeMode:""!==t?1:0,groupInviteMode:""!==n?1:0,groupInviteKey:n}}getPlatformConfigFromRoute(e){const{zendesk_signin:t,return_to:n,brand_id:i,locale_id:o,timestamp:s}=e.queryParams;return"1"===t?{platform:x_.Zendesk,returnTo:n,brandId:i,localeId:o,timestamp:s}:void 0}isLoggedIn(){return this.http.get("/ws/user/is/signed-in?version=2")}getProfileRestrictions(e){let t=!1,n=!1,i="";return e.organizations.forEach(e=>{t||n||(i=e.name,t=e.user_is_subscribed&&e.email_domain_restriction&&!e.user_has_email_domain_access,n=e.user_is_subscribed&&e.ip_address_restriction&&!e.user_has_domain_access)}),{organizationName:i,email:t,ip:n}}resetPassword(e){return this.http.post("/ws/user/password/forgot",{email:e})}updatePassword(e,t,n){return this.http.post("/ws/user/password/change",{current_password:e,new_password:t,confirm_new_password:n})}signUp(e){return this.http.post("/ws/user/sign/up",b_.toJSON(e))}authenticateWithFacebook(){return this.socialAuthService.signIn(d_.a.PROVIDER_ID)}verifyToken(e){return this.http.post("/ws/recaptcha/siteverify",{recaptcha_reponse_token:e,recaptcha_version:"v3"}).pipe(Object(k.a)(e=>e))}isHuman(e){return this.reCaptchaV3Service.execute(e).pipe(Object(Oo.a)(e=>this.verifyToken(e)),Object(k.a)(t=>({isHuman:t.action===e&&t.score>.2,verification:t})))}isReCaptchaWhiteListed(e){return O_.some(t=>new RegExp(t+"$","i").test(e))}initGoogleAuth2(){gapi.load("auth2",()=>{this.auth2.next(gapi.auth2.init({client_id:c.googleAuthKey,scope:"profile"}))})}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(C.b),i.Zb(d_.b),i.Zb(w_.a))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),S_=(()=>{class e{constructor(e){this.organizations=e}}return e.type="[Organizations] Set Organizations",e})(),k_=(()=>{class e{constructor(e){this.organization=e}}return e.type="[Organizations] Select Organization",e})(),__=(()=>{class e{constructor(e){this.collection=e}}return e.type="[Organizations] Select Collection",e})(),j_=(()=>{class e{constructor(e){this.organizationId=e}}return e.type="[Organizations] Get Collections",e})(),P_=(()=>{class e{constructor(e){this.collections=e}}return e.type="[Organizations] Get Collections Success",e})(),M_=(()=>{class e{constructor(e){this.organization=e}}return e.type="[Organizations] Join Organization",e})(),I_=(()=>{class e{constructor(e){this.organization=e}}return e.type="[Organizations] Join Organization Success",e})(),z_=(()=>{class e{constructor(e){this.organization=e}}return e.type="[Organizations] Join Organization Fail",e})(),T_=(()=>{class e{constructor(e){this.code=e}}return e.type="[Organizations] Join Organization With Code",e})(),U_=(()=>{class e{constructor(e){this.organizationName=e}}return e.type="[Organizations] Join Organization With Code Success",e})(),L_=(()=>{class e{constructor(e){this.error=e}}return e.type="[Organizations] Join Organization With Code Fail",e})(),D_=(()=>{class e{constructor(e,t){this.groupEID=e,this.emails=t}}return e.type="[Organizations] Send Organization Invite",e})(),E_=(()=>{class e{constructor(e){this.responses=e}}return e.type="[Organizations] Send Organization Invite Success",e})(),F_=(()=>{class e{constructor(e){this.error=e}}return e.type="[Organizations] Send Organization Invite Fail",e})(),A_=(()=>{class e{constructor(e){this.groupId=e}}return e.type="[Organizations] Get Organization Users",e})(),R_=(()=>{class e{constructor(e){this.users=e}}return e.type="[Organizations] Get Organization Users Success",e})(),N_=(()=>{class e{constructor(e){this.error=e}}return e.type="[Organizations] Get Organization Users Fail",e})(),V_=(()=>{class e{constructor(){}}return e.type="[Organizations] Reset",e})(),H_=(()=>{class e{constructor(e,t){this.groupId=e,this.users=t}}return e.type="[Organizations] Update User Roles",e})(),B_=(()=>{class e{constructor(e,t){this.groupId=e,this.users=t}}return e.type="[Organizations] Update User Roles Success",e})(),Q_=(()=>{class e{constructor(){}}return e.type="[Organizations] Update User Roles Fail",e})(),$_=(()=>{class e{constructor(e,t){this.groupId=e,this.users=t}}return e.type="[Organizations] Remove Organization User",e})(),q_=(()=>{class e{constructor(e,t){this.groupId=e,this.users=t}}return e.type="[Organizations] Remove Organization User Success",e})(),W_=(()=>{class e{constructor(){}}return e.type="[Organizations] Remove Organization User Fail",e})(),K_=(()=>{class e{constructor(e,t){this.groupId=e,this.users=t}}return e.type="[Organizations] Transfer Organization Content",e})(),G_=(()=>{class e{constructor(e,t){this.groupId=e,this.users=t}}return e.type="[Organizations] Transfer Organization Content Success",e})(),Z_=(()=>{class e{constructor(){}}return e.type="[Organizations] Transfer Organization Content Fail",e})();var J_=function(e){return e.DomainAlert="join_group_through_domain_alert",e.WelcomeTour="welcome_tour_alert",e.SurveyMonkey="survey_monkey_alert",e.CompleteProfileAlert="complete_profile_alert",e}({});let X_=(()=>{class e{constructor(e,t){this.http=e,this.storageService=t}getUserMessage(e,t="",n=!0){const i=this.getCachedMessage(e);return n&&i?Object(S.a)(i):this.http.get(`/ws/user/message?version=2&type=${e}&mode=${t}`).pipe(Object(k.a)(t=>{const{message_seen_id:n,show_alert:i}=t;let o;switch(e){case J_.DomainAlert:o=Object(I.plainToClass)(c_,t.join_organization);break;case J_.WelcomeTour:o=""+t.tour_version;break;case J_.SurveyMonkey:o=""+t.survey_group_name;break;case J_.CompleteProfileAlert:o=!0===t.is_new_user}return{messageSeenId:n,messageType:e,showUserAlert:i,messageData:o}}),Object(Et.a)(e=>{e.showUserAlert||this.addCachedMessage(e)}))}setUserMessageViewed(e){return this.http.post("/ws/user/message",{version:2,message_seen_id:e})}sendMessage(e){return this.http.post("/ws/user/message",e)}getCachedMessage(e){return this.getCachedMessages().find(t=>t.messageType===e)}getCachedMessages(){return this.storageService.getSessionItem(Er.UserMessagesSeen)||[]}addCachedMessage(e){if(!this.getCachedMessage(e.messageType)){const t=this.getCachedMessages();this.storageService.setSessionItem(Er.UserMessagesSeen,[...t,e])}}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(C.b),i.Zb(Ar))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var Y_;!function(e){class t{constructor(e){this.searchMode=e}}t.type="[Gallery] Set Search Mode",e.SetSearchMode=t;class n{constructor(e){this.viewMode=e}}n.type="[Gallery] Set View Mode",e.SetViewMode=n;class i{constructor(e){this.sort=e}}i.type="[Gallery] Set Sort",e.SetSort=i;class o{constructor(e){this.organizationId=e}}o.type="[Gallery] Get Studio Options",e.GetStudioOptions=o;class s{constructor(e){this.options=e}}s.type="[Gallery] Get Studio Options Success",e.GetStudioOptionsSuccess=s;class r{constructor(e){this.config=e}}r.type="[Gallery] Search Loft",e.SearchLoft=r;class a{constructor(e){this.bookmarks=e}}a.type="[Gallery] Search Loft Success",e.SearchLoftSuccess=a;class c{constructor(e,t){this.config=e,this.options=t}}c.type="[Gallery] Set Search Config",e.SetSearchConfig=c;class l{constructor(e){this.options=e}}l.type="[Gallery] Set Search Options",e.SetSearchOptions=l;class p{constructor(){}}p.type="[Gallery] Search Studio",e.SearchStudio=p;class d{constructor(e){this.bookmarks=e}}d.type="[Gallery] Search Studio Success",e.SearchStudioSuccess=d;class u{constructor(e){this.bookmarks=e}}u.type="[Gallery] Search Success",e.SearchSuccess=u;class g{constructor(e){this.result=e}}g.type="[Gallery] Select Bookmark",e.SelectBookmark=g;class h{constructor(e){this.sidenav=e}}h.type="[Gallery] Set Sidenav",e.SetSidenav=h;class b{constructor(e){this.bulkActions=e}}b.type="[Gallery] Set Bulk Actions",e.SetBulkActions=b;class m{constructor(e){this.cardActions=e}}m.type="[Gallery] Set Card Actions",e.SetCardActions=m;class f{constructor(){}}f.type="[Gallery] Clear Results",e.ClearResults=f;class y{constructor(e,t){this.id=e,this.checked=t}}y.type="[Gallery] Check Item",e.CheckItem=y;class x{constructor(e){this.checked=e}}x.type="[Gallery] Check All",e.CheckAll=x;class v{constructor(e){this.ids=e}}v.type="[Gallery] Set Checked Items",e.SetCheckedItems=v;class w{constructor(){}}w.type="[Gallery] Reset",e.Reset=w}(Y_||(Y_={}));var ej=function(e){return e.Web="web",e.Mobile="mobilesdk",e}({});let tj=(()=>{class e{constructor(){}}return e.type="[Subscription] Reset Subscription State",e})();const nj={"Sign in":"3971305","Sign up":"3971297"};let ij=(()=>{class e{constructor(e){this.config=e,this.initialized=!1}initialize(){if(!this.config.enabled||this.initialized)return;const e=`\n      _linkedin_partner_id = "${this.config.linkedinId}"; \n      window._linkedin_data_partner_ids = window._linkedin_data_partner_ids || []; \n      window._linkedin_data_partner_ids.push(_linkedin_partner_id);\n      (function(){var s = document.getElementsByTagName("script")[0]; var b = document.createElement("script"); b.type = "text/javascript";b.async = true; b.src = "https://snap.licdn.com/li.lms-analytics/insight.min.js"; s.parentNode.insertBefore(b, s);})();\n    `,t=document.createElement("script");t.textContent=e,document.body.appendChild(t),this.initialized=!0}track(e){const t=nj[e];if(t){const e=document.createElement("img");e.height=1,e.width=1,e.style.display="none",e.alt="",e.src=`https://px.ads.linkedin.com/collect/?pid=${this.config.linkedinId}&conversionId=${t}&fmt=gif`,document.body.appendChild(e)}}}return e.\u0275fac=function(t){return new(t||e)(i.Zb("linkedinConfig"))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),oj=(()=>{class e{constructor(e){this.config=e,this.initialized=!1}initialize(){if(!this.config.enabled||this.initialized)return;const e=`\n      !function(f,b,e,v,n,t,s)\n      {if(f.fbq)return;n=f.fbq=function(){n.callMethod?\n      n.callMethod.apply(n,arguments):n.queue.push(arguments)};\n      if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';\n      n.queue=[];t=b.createElement(e);t.async=!0;\n      t.src=v;s=b.getElementsByTagName(e)[0];\n      s.parentNode.insertBefore(t,s)}(window,document,'script',\n      'https://connect.facebook.net/en_US/fbevents.js');\n      fbq('init', '${this.config.facebookPixelId}');\n      fbq('track', 'PageView');\n    `,t=document.createElement("script");t.textContent=e,document.head.appendChild(t),this.initialized=!0}trackCustom(e){fbq("trackCustom",e)}}return e.\u0275fac=function(t){return new(t||e)(i.Zb("facebookPixelConfig"))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var sj=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},rj=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const aj=c.application===o.Studio,cj={loading:!1,profileStatus:"ready",loggedIn:null,userLocale:null,userRoles:[]};let lj=(()=>{let e=class{constructor(e,t,n,i,o,s,r,a,c){this.route=e,this.authService=t,this.userMessageService=n,this.storageService=i,this.localeId=o,this.errorLoggingService=s,this.facebookPixel=r,this.linkedinInsights=a,this.pendoService=c}static getLoggedIn(e){return e.loggedIn}static getEnvironmentSettings(e){return e.environmentSettings}static getUserProfile(e){return e.userProfile}static getUserRole(e){if(!Object(X.isNil)(e.userProfile))return Object(X.get)(e,"userProfile.organizations[0].user_role",Pw)}static getUserRoles(e){return e.userRoles}static getUserAccountSettings(e){return Object(X.get)(e,"userProfile.account_settings",[])}static getProfileCheck(e){return e.profileCheck}static getLoading(e){return e.loading}static getProfileUpdating(e){return"updating"===e.profileStatus}static getProfileDeleting(e){return"deleting"===e.profileStatus}static getUserLocale(e){return e.userLocale}static getUserLanguage(e){return Object(X.get)(e,"userLocale.lang",Is.lang)}static getUserApps(e){return Object(X.get)(e,"userApps",[])}static getSelectedUserApp(e){return(e.userApps||[]).find(t=>t.id===e.selectedAppId)}static isPrivateUser(e){return!Object(X.isNil)(e.userProfile)&&0===Object(X.get)(e,"userProfile.organizations",[]).length}static isPremiumUser(e){return!0===Object(X.get)(e,"userProfile.premium_account_valid")}isLoggedIn(e,t){e.patchState({loading:!0}),this.authService.isLoggedIn().pipe(Object(E.a)(()=>e.patchState({loading:!1}))).subscribe(t=>{e.dispatch(t.signed_in?new ck:new lk)})}isLoggedInSuccess(e,t){e.patchState({loggedIn:!0})}isLoggedInFailure(e,t){e.patchState({loggedIn:!1})}login(e,t){e.patchState({loading:!0}),this.verify("studio_login",t.login.email,e).pipe(Object(Oo.b)(e=>this.authService.loginWithBiodigital(Object.assign(Object.assign({},t.login),e?{site_verify_response:e}:null))),Object(E.a)(()=>e.patchState({loading:!1}))).subscribe(t=>{e.dispatch(new gk("biodigital",t))},n=>{this.logFailure("LOGIN_FAILURE",n),e.dispatch(new hk("biodigital",n,t.login))})}loginWithGoogle(e,t){e.patchState({loading:!0}),this.authService.loginWithGoogle(t.login).pipe(Object(E.a)(()=>e.patchState({loading:!1}))).subscribe(t=>{e.dispatch(new gk("google",t))},n=>{1!==t.login.groupCodeMode&&1!==t.login.groupInviteMode||this.logFailure("GOOGLE_SIGNUP_FAILURE",n),e.dispatch(new hk("google",n,t.login))})}loginWithFacebook(e,t){e.patchState({loading:!0}),this.authService.loginWithFacebook(t.login).pipe(Object(E.a)(()=>e.patchState({loading:!1}))).subscribe(t=>{e.dispatch(new gk("facebook",t))},n=>{e.dispatch(new hk("facebook",n,t.login))})}loginSuccess(e,t){aj&&(this.facebookPixel.trackCustom("Sign in"),this.linkedinInsights.track("Sign in"),this.pendoService.track("Sign In - Success",{type:t.loginType})),e.dispatch(new ak),e.dispatch(new qk)}loginFailure(e,t){aj&&this.pendoService.track("Sign In - Failure",{type:t.loginType,error:Object(X.get)(t,"error.error.error.message")||"There was an error logging in."})}logout(e,t){e.patchState({loading:!0}),this.authService.logout().pipe(Object(E.a)(()=>e.patchState({loading:!1}))).subscribe(()=>e.dispatch(new mk),()=>e.dispatch(new fk))}logoutSuccess(e,t){e.setState(cj),e.dispatch(new a_),e.dispatch(new tj),e.dispatch(new Wl),e.dispatch(new Ca),e.dispatch(new Ae),e.dispatch(new uo),e.dispatch(new hp.ResetLayout),e.dispatch(new V_),e.dispatch(new Ks),e.dispatch(new dn),e.dispatch(new Y_.Reset),this.storageService.clearSessionStorage()}checkProfile(e,t){return e.patchState({loading:!0}),this.authService.checkProfile(t.email).pipe(Object(E.a)(()=>e.patchState({loading:!1}))).subscribe(t=>{e.dispatch(new zk(t))},t=>{e.dispatch(new Tk(t))})}checkProfileSuccess(e,t){e.patchState({profileCheck:t.profile})}getUserProfile(e,{hardCheck:t}){return e.patchState({loading:!0}),this.authService.getUserProfile(t).pipe(Object(E.a)(()=>e.patchState({loading:!1}))).subscribe(t=>{e.dispatch(new Ok(t))},t=>{e.dispatch(new Ck(t))})}getUserProfileSuccess(e,t){e.patchState({userProfile:t.userProfile}),e.dispatch(new S_(t.userProfile.organizations)),e.dispatch(new Wk),e.dispatch(new qk)}updateUserProfile(e,{userProfile:t}){e.patchState({profileStatus:"updating"}),this.authService.updaterUserProfile(t).pipe(Object(E.a)(()=>e.patchState({profileStatus:"ready"}))).subscribe(()=>{e.dispatch(new kk(t))},t=>{e.dispatch(new _k(t))})}deleteUserProfile(e,t){e.patchState({profileStatus:"deleting"}),this.authService.deleteUserProfile().pipe(Object(E.a)(()=>e.patchState({profileStatus:"ready"}))).subscribe(t=>{e.dispatch(new Pk(t))},t=>{e.dispatch(new Mk(t))})}getUserRoles(e,t){this.authService.getUserRoles().subscribe(t=>{e.patchState({userRoles:t})})}getUserApps(e,t){this.authService.getUserApps().subscribe(t=>{e.dispatch(new Kk(t)),e.dispatch(new Gk)},e=>{})}setUserApps(e,{apps:t}){e.patchState({userApps:t})}setSelectedUserApp(e,{appId:t}){e.patchState({selectedAppId:t}),null!==t?this.storageService.setLocalItem(Dr.UserAppId,t):this.storageService.removeLocalItem(Dr.UserAppId)}checkSelectedUserApp(e,t){const n=e.getState().userApps,i=this.storageService.getLocalItem(Dr.UserAppId);if(i){const t=parseInt(i,10);e.dispatch(new Zk(t))}else if(n&&n.length){const t=n.find(e=>e.app_platform.some(e=>e.type===ej.Web));e.dispatch(new Zk(t?t.id:void 0))}}checkSession(e,t){e.patchState({loading:!0}),this.authService.isLoggedIn().pipe(Object(E.a)(()=>e.patchState({loading:!1}))).subscribe(t=>{t.signed_in?(e.dispatch(new ck),e.dispatch(new wk),e.dispatch(new Uk)):e.dispatch(new lk)})}getEnvironmentSettings(e,t){return e.patchState({loading:!0}),this.authService.getEnvironmentSettings().pipe(Object(E.a)(()=>e.patchState({loading:!1}))).subscribe(t=>{e.dispatch(new xk(t))},t=>{e.dispatch(new vk(t))})}GetEnvironmentSettingsSuccess(e,t){e.patchState({environmentSettings:t.environmentSettings})}resetPassword(e,t){e.patchState({loading:!0}),this.authService.resetPassword(t.email).pipe(Object(E.a)(()=>e.patchState({loading:!1}))).subscribe(()=>{e.dispatch(new Dk(t.email))},t=>{e.dispatch(new Ek(t))})}updatePassword(e,t){const{currentPassword:n,newPassword:i,confirmNewPassword:o}=t;this.authService.updatePassword(n,i,o).subscribe(()=>{e.dispatch(new Ak)},t=>{e.dispatch(new Rk(t))})}signUp(e,t){e.patchState({loading:!0}),this.verify("studio_signup",t.value.email,e).pipe(Object(Oo.b)(e=>this.authService.signUp(Object.assign(Object.assign({},t.value),e?{site_verify_response:e}:null)))).subscribe(t=>{e.dispatch(new Hk(t))},t=>{e.dispatch(new Bk(t))})}signUpSuccess(e,t){if(aj){const e=this.route.snapshot.queryParams;this.pendoService.track("Sign Up - Success",{referrer:document.referrer,refParam:e.ref||null,groupInvite:e.hasOwnProperty("group_invite"),groupCode:e.hasOwnProperty("group")&&e.hasOwnProperty("code")})}}signUpFailure(e,t){aj&&this.pendoService.track("Sign Up - Failure",{error:Object(X.get)(t,"error.error.error.message")||"There was an error signing up."}),this.logFailure("BIODIGITAL_SIGNUP_FAILURE",t)}setUserLocale(e,{locale:t}){this.storageService.setLocalItem(Dr.Locale,t.id),e.patchState({userLocale:t}),e.dispatch(new $k(t))}checkLocale(e,t){const n=zs.find(e=>e.id===this.localeId)||Is;e.dispatch(new Qk(n))}sendUserMessage(e,{message:t}){this.userMessageService.sendMessage(t).subscribe(()=>{e.dispatch(new Xk(t))},t=>{e.dispatch(new Yk(t))})}getUserMessage(e,{type:t,mode:n}){this.userMessageService.getUserMessage(t,n).subscribe(t=>{e.dispatch(new t_(t))},()=>{e.dispatch(new n_(t))})}setUserMessageViewed(e,{messageSeenId:t}){this.userMessageService.setUserMessageViewed(t).subscribe(()=>e.dispatch(new o_),()=>e.dispatch(new s_))}resetAuth(e,t){e.setState(cj)}logFailure(e,t){const n=Object(X.get)(t,"message")||"",i=Object(X.get)(t,"error.error.message")||"";this.errorLoggingService.logError(new EC(e,n,i)).subscribe()}verify(e,t,n){return this.authService.isReCaptchaWhiteListed(t)||c.deploy===r.Local?Object(S.a)(null):this.authService.isHuman(e).pipe(Object(Et.a)(e=>{e.isHuman||n.dispatch(new r_)}),Object(K.a)(e=>e.isHuman),Object(k.a)(e=>e.verification))}ngxsOnInit(e){e.dispatch(new Nk),e.dispatch(new qk),e.dispatch(new Gk)}};return e.\u0275fac=function(t){return new(t||e)(i.Zb(Z.a),i.Zb(C_),i.Zb(X_),i.Zb(Ar),i.Zb(i.w),i.Zb(FC),i.Zb(oj),i.Zb(ij),i.Zb(ee))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac}),sj([Object(d.a)(ak),rj("design:type",Function),rj("design:paramtypes",[Object,ak]),rj("design:returntype",void 0)],e.prototype,"isLoggedIn",null),sj([Object(d.a)(ck),rj("design:type",Function),rj("design:paramtypes",[Object,ck]),rj("design:returntype",void 0)],e.prototype,"isLoggedInSuccess",null),sj([Object(d.a)(lk),rj("design:type",Function),rj("design:paramtypes",[Object,lk]),rj("design:returntype",void 0)],e.prototype,"isLoggedInFailure",null),sj([Object(d.a)(pk),rj("design:type",Function),rj("design:paramtypes",[Object,pk]),rj("design:returntype",void 0)],e.prototype,"login",null),sj([Object(d.a)(dk),rj("design:type",Function),rj("design:paramtypes",[Object,dk]),rj("design:returntype",void 0)],e.prototype,"loginWithGoogle",null),sj([Object(d.a)(uk),rj("design:type",Function),rj("design:paramtypes",[Object,uk]),rj("design:returntype",void 0)],e.prototype,"loginWithFacebook",null),sj([Object(d.a)(gk),rj("design:type",Function),rj("design:paramtypes",[Object,gk]),rj("design:returntype",void 0)],e.prototype,"loginSuccess",null),sj([Object(d.a)(hk),rj("design:type",Function),rj("design:paramtypes",[Object,hk]),rj("design:returntype",void 0)],e.prototype,"loginFailure",null),sj([Object(d.a)(bk),rj("design:type",Function),rj("design:paramtypes",[Object,bk]),rj("design:returntype",void 0)],e.prototype,"logout",null),sj([Object(d.a)(mk),rj("design:type",Function),rj("design:paramtypes",[Object,mk]),rj("design:returntype",void 0)],e.prototype,"logoutSuccess",null),sj([Object(d.a)(Ik),rj("design:type",Function),rj("design:paramtypes",[Object,Ik]),rj("design:returntype",void 0)],e.prototype,"checkProfile",null),sj([Object(d.a)(zk),rj("design:type",Function),rj("design:paramtypes",[Object,zk]),rj("design:returntype",void 0)],e.prototype,"checkProfileSuccess",null),sj([Object(d.a)(wk),rj("design:type",Function),rj("design:paramtypes",[Object,wk]),rj("design:returntype",void 0)],e.prototype,"getUserProfile",null),sj([Object(d.a)(Ok),rj("design:type",Function),rj("design:paramtypes",[Object,Ok]),rj("design:returntype",void 0)],e.prototype,"getUserProfileSuccess",null),sj([Object(d.a)(Sk),rj("design:type",Function),rj("design:paramtypes",[Object,Sk]),rj("design:returntype",void 0)],e.prototype,"updateUserProfile",null),sj([Object(d.a)(jk),rj("design:type",Function),rj("design:paramtypes",[Object,jk]),rj("design:returntype",void 0)],e.prototype,"deleteUserProfile",null),sj([Object(d.a)(Uk),rj("design:type",Function),rj("design:paramtypes",[Object,Uk]),rj("design:returntype",void 0)],e.prototype,"getUserRoles",null),sj([Object(d.a)(Wk),rj("design:type",Function),rj("design:paramtypes",[Object,Wk]),rj("design:returntype",void 0)],e.prototype,"getUserApps",null),sj([Object(d.a)(Kk),rj("design:type",Function),rj("design:paramtypes",[Object,Kk]),rj("design:returntype",void 0)],e.prototype,"setUserApps",null),sj([Object(d.a)(Zk),rj("design:type",Function),rj("design:paramtypes",[Object,Zk]),rj("design:returntype",void 0)],e.prototype,"setSelectedUserApp",null),sj([Object(d.a)(Gk),rj("design:type",Function),rj("design:paramtypes",[Object,Gk]),rj("design:returntype",void 0)],e.prototype,"checkSelectedUserApp",null),sj([Object(d.a)(Nk),rj("design:type",Function),rj("design:paramtypes",[Object,Nk]),rj("design:returntype",void 0)],e.prototype,"checkSession",null),sj([Object(d.a)(yk),rj("design:type",Function),rj("design:paramtypes",[Object,yk]),rj("design:returntype",void 0)],e.prototype,"getEnvironmentSettings",null),sj([Object(d.a)(xk),rj("design:type",Function),rj("design:paramtypes",[Object,xk]),rj("design:returntype",void 0)],e.prototype,"GetEnvironmentSettingsSuccess",null),sj([Object(d.a)(Lk),rj("design:type",Function),rj("design:paramtypes",[Object,Lk]),rj("design:returntype",void 0)],e.prototype,"resetPassword",null),sj([Object(d.a)(Fk),rj("design:type",Function),rj("design:paramtypes",[Object,Fk]),rj("design:returntype",void 0)],e.prototype,"updatePassword",null),sj([Object(d.a)(Vk),rj("design:type",Function),rj("design:paramtypes",[Object,Vk]),rj("design:returntype",void 0)],e.prototype,"signUp",null),sj([Object(d.a)(Hk),rj("design:type",Function),rj("design:paramtypes",[Object,Hk]),rj("design:returntype",void 0)],e.prototype,"signUpSuccess",null),sj([Object(d.a)(Bk),rj("design:type",Function),rj("design:paramtypes",[Object,Bk]),rj("design:returntype",void 0)],e.prototype,"signUpFailure",null),sj([Object(d.a)(Qk),rj("design:type",Function),rj("design:paramtypes",[Object,Qk]),rj("design:returntype",void 0)],e.prototype,"setUserLocale",null),sj([Object(d.a)(qk),rj("design:type",Function),rj("design:paramtypes",[Object,qk]),rj("design:returntype",void 0)],e.prototype,"checkLocale",null),sj([Object(d.a)(Jk),rj("design:type",Function),rj("design:paramtypes",[Object,Jk]),rj("design:returntype",void 0)],e.prototype,"sendUserMessage",null),sj([Object(d.a)(e_),rj("design:type",Function),rj("design:paramtypes",[Object,e_]),rj("design:returntype",void 0)],e.prototype,"getUserMessage",null),sj([Object(d.a)(i_),rj("design:type",Function),rj("design:paramtypes",[Object,i_]),rj("design:returntype",void 0)],e.prototype,"setUserMessageViewed",null),sj([Object(d.a)(a_),rj("design:type",Function),rj("design:paramtypes",[Object,a_]),rj("design:returntype",void 0)],e.prototype,"resetAuth",null),sj([Object(d.e)(),rj("design:type",Function),rj("design:paramtypes",[rk]),rj("design:returntype",void 0)],e,"getLoggedIn",null),sj([Object(d.e)(),rj("design:type",Function),rj("design:paramtypes",[rk]),rj("design:returntype",void 0)],e,"getEnvironmentSettings",null),sj([Object(d.e)(),rj("design:type",Function),rj("design:paramtypes",[rk]),rj("design:returntype",void 0)],e,"getUserProfile",null),sj([Object(d.e)(),rj("design:type",Function),rj("design:paramtypes",[rk]),rj("design:returntype",v_)],e,"getUserRole",null),sj([Object(d.e)(),rj("design:type",Function),rj("design:paramtypes",[rk]),rj("design:returntype",Array)],e,"getUserRoles",null),sj([Object(d.e)(),rj("design:type",Function),rj("design:paramtypes",[rk]),rj("design:returntype",Array)],e,"getUserAccountSettings",null),sj([Object(d.e)(),rj("design:type",Function),rj("design:paramtypes",[rk]),rj("design:returntype",void 0)],e,"getProfileCheck",null),sj([Object(d.e)(),rj("design:type",Function),rj("design:paramtypes",[rk]),rj("design:returntype",void 0)],e,"getLoading",null),sj([Object(d.e)(),rj("design:type",Function),rj("design:paramtypes",[rk]),rj("design:returntype",void 0)],e,"getProfileUpdating",null),sj([Object(d.e)(),rj("design:type",Function),rj("design:paramtypes",[rk]),rj("design:returntype",void 0)],e,"getProfileDeleting",null),sj([Object(d.e)(),rj("design:type",Function),rj("design:paramtypes",[rk]),rj("design:returntype",void 0)],e,"getUserLocale",null),sj([Object(d.e)(),rj("design:type",Function),rj("design:paramtypes",[rk]),rj("design:returntype",String)],e,"getUserLanguage",null),sj([Object(d.e)(),rj("design:type",Function),rj("design:paramtypes",[rk]),rj("design:returntype",void 0)],e,"getUserApps",null),sj([Object(d.e)(),rj("design:type",Function),rj("design:paramtypes",[rk]),rj("design:returntype",void 0)],e,"getSelectedUserApp",null),sj([Object(d.e)(),rj("design:type",Function),rj("design:paramtypes",[rk]),rj("design:returntype",void 0)],e,"isPrivateUser",null),sj([Object(d.e)(),rj("design:type",Function),rj("design:paramtypes",[rk]),rj("design:returntype",void 0)],e,"isPremiumUser",null),e=sj([Object(d.f)({name:"auth",defaults:cj})],e),e})();var pj=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},dj=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const uj={publishing:!1,widgetURL:"/viewer",dimensions:bw.dimensions,minDimensions:{width:300,height:400}};let gj=(()=>{let e=class{constructor(e,t,n){this.publishService=e,this.store=t,this.snackbar=n}static getDimensions(e){return e.dimensions}static getMinDimensions(e){return e.minDimensions}static getWidgetURL(e){return e.widgetURL}static getPublishing(e){return e.publishing}setPublishWidgetURL(e,t){e.patchState({widgetURL:t.widgetURL||"/viewer"})}setPublishDimensions(e,t){e.patchState({dimensions:t.dimensions})}getPublishURL(e,t){const{model:n,camera:i,widgetOptions:o}=t,{widgetURL:s}=e.getState(),r=this.store.selectSnapshot(lj.getUserLanguage),a=this.store.selectSnapshot(lj.getSelectedUserApp);this.publishService.generateWidgetURL(n,s,o,i,fw.Single,r,a).subscribe(t=>{e.dispatch(new ZS(n,t))},()=>{e.dispatch(new JS(n))})}getPublishURLFail(e,t){this.snackbar.open("Unable to generate URL.")}getPublishIFrame(e,t){const{model:n,camera:i,widgetOptions:o}=t,{widgetURL:s,dimensions:r}=e.getState(),a=this.store.selectSnapshot(lj.getUserLanguage),c=this.store.selectSnapshot(lj.getSelectedUserApp);this.publishService.generateWidgetEmbed(n,s,o,r,i,fw.Single,a,c).subscribe(t=>{e.dispatch(new WS(t))},()=>{e.dispatch(new KS)})}savePublishImage(e,{imageData:t,imageType:n}){this.publishService.saveUserImage(t,n).subscribe(t=>{e.dispatch(new tk(t))},()=>{e.dispatch(new nk)})}getPublishImage(e,t){const{model:n,camera:i,widgetOptions:o,imageData:s,fileType:r}=t,{widgetURL:a}=e.getState(),c=this.store.selectSnapshot(lj.getUserLanguage),l=this.store.selectSnapshot(lj.getSelectedUserApp);Object(Xs.a)(this.publishService.generateWidgetURL(n,a,o,i,fw.Single,c,l),this.publishService.saveUserImage(s,r)).subscribe(([t,i])=>{const o=this.publishService.getImageEmbed(n.title,t,i);e.dispatch(new ok(o))},()=>{e.dispatch(new sk)})}setPublishing(e,{publishing:t}){e.patchState({publishing:t})}resetPublish(e,t){e.setState(uj)}};return e.\u0275fac=function(t){return new(t||e)(i.Zb(ww),i.Zb(d.g),i.Zb(Wa.b))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac}),pj([Object(d.a)(QS),dj("design:type",Function),dj("design:paramtypes",[Object,QS]),dj("design:returntype",void 0)],e.prototype,"setPublishWidgetURL",null),pj([Object(d.a)($S),dj("design:type",Function),dj("design:paramtypes",[Object,$S]),dj("design:returntype",void 0)],e.prototype,"setPublishDimensions",null),pj([Object(d.a)(GS),dj("design:type",Function),dj("design:paramtypes",[Object,GS]),dj("design:returntype",void 0)],e.prototype,"getPublishURL",null),pj([Object(d.a)(JS),dj("design:type",Function),dj("design:paramtypes",[Object,JS]),dj("design:returntype",void 0)],e.prototype,"getPublishURLFail",null),pj([Object(d.a)(qS),dj("design:type",Function),dj("design:paramtypes",[Object,qS]),dj("design:returntype",void 0)],e.prototype,"getPublishIFrame",null),pj([Object(d.a)(ek),dj("design:type",Function),dj("design:paramtypes",[Object,ek]),dj("design:returntype",void 0)],e.prototype,"savePublishImage",null),pj([Object(d.a)(ik),dj("design:type",Function),dj("design:paramtypes",[Object,ik]),dj("design:returntype",void 0)],e.prototype,"getPublishImage",null),pj([Object(d.a)(XS),dj("design:type",Function),dj("design:paramtypes",[Object,XS]),dj("design:returntype",void 0)],e.prototype,"setPublishing",null),pj([Object(d.a)(YS),dj("design:type",Function),dj("design:paramtypes",[Object,YS]),dj("design:returntype",void 0)],e.prototype,"resetPublish",null),pj([Object(d.e)(),dj("design:type",Function),dj("design:paramtypes",[BS]),dj("design:returntype",void 0)],e,"getDimensions",null),pj([Object(d.e)(),dj("design:type",Function),dj("design:paramtypes",[BS]),dj("design:returntype",void 0)],e,"getMinDimensions",null),pj([Object(d.e)(),dj("design:type",Function),dj("design:paramtypes",[BS]),dj("design:returntype",void 0)],e,"getWidgetURL",null),pj([Object(d.e)(),dj("design:type",Function),dj("design:paramtypes",[BS]),dj("design:returntype",void 0)],e,"getPublishing",null),e=pj([Object(d.f)({name:"publish",defaults:uj})],e),e})(),hj=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[ms.c,hS,gu.q,HS,bS.a,d.c.forFeature([gj])]]}),e})(),bj=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[d.c.forFeature([Vw]),ms.c,hS,gu.q,HS,Z.f,hj,J.d]]}),e})();class mj{}var fj=function(e){return e[e.Query=0]="Query",e[e.Path=1]="Path",e}({}),yj=function(e){return e[e.List=0]="List",e[e.Card=1]="Card",e}({});const xj=c.application===o.Loft?yj.List:yj.Card;var vj=function(e){return e.Success="success",e.Fail="fail",e}({});const wj="cdb/content",Oj="cdb/copy/content",Cj={headers:new C.d({"Content-Type":"application/json; charset=utf-8"})},Sj=["production","client","preview","internal_content","public_preview","demos","social","exports","real_data"];let kj=(()=>{class e{constructor(e,t){this.http=e,this.serializeModuleService=t}saveModule(e,t){t=this.formatModulePath(t);const n=[wj,"modules",t].join("/"),i=this.JSONStringify(e);return this.http.put(n,i,Cj).pipe(Object(k.a)(()=>vj.Success),Object(_.a)(({status:e})=>e>=200&&e<=202?Object(S.a)(vj.Success):Object(S.a)(vj.Fail)))}copyState(e,t){const n=[Oj,"states",t].join("/"),i={headers:new C.d({"Content-Type":"application/json; charset=utf-8","source-state":e})};return this.http.put(n,{},i)}listContents(e,t,n,i=!1){const o=this.generateModulePath(e,t||"",n||"");return this.http.get("/cdb/ls/content/modules/"+o).pipe(Object(k.a)(e=>i?e.contents.map(e=>{const t=e.name.replace("/content/modules/","").replace(".json",""),n=e.name.split("/").pop().replace("/content/modules","").replace(".json",""),i=new px;return i.id=t,i.title=n,i.type=s.Module,i}):e.contents))}getState(e){return this.http.get("/cdb/ls/content/states/"+e).pipe(Object(k.a)(e=>e.contents))}getClients(){return this.http.get("/search/client").pipe(Object(k.a)(e=>e.clients))}getUsedStates(){const e={};return Object.values(Human.scene.objects).reduce((t,n)=>(["transformId","morphId","geometryId","materialId"].forEach(t=>{const i=this.getPropertyState(n,t);i.length&&(e[i]=!0)}),n.hasOwnProperty("renderables")&&["morphId","geometryId","materialId"].forEach(t=>{n.renderables.forEach(n=>{const i=this.getPropertyState(n,t);i.length&&(e[i]=!0)})}),t),{}),Object.keys(e)}parseScenePath(e){const t=e.split("/");return 1===t.length?null:{fullPath:"https://qa.biodigital.com/content/modules/"+e,relativePath:t.slice(0,t.length-1).join("/"),sceneName:t[t.length-1]}}formatModulePath(e){let t=e;return/\.json$/.test(e)||(t+=".json"),t}getPrimaryCategories(){return Object(S.a)(Sj)}getSecondaryCategories(e){switch(e){case"production":return Object(S.a)(["maleAdult","femaleAdult"]);case"client":return this.getClients();default:return Object(S.a)([])}}generateSaveModule(e){const t=this.parseScenePath(e),n=t.relativePath.split("/");return{id:e,name:t.sceneName,primaryCategory:n[0]||"",secondaryCategory:n[1]||""}}generateModulePath(e,t,n){const i=[];return e.length&&i.push(e),t.length&&i.push(t),n.length&&(n.indexOf(".json")<0&&(n+=".json"),i.push(n)),i.join("/")}getPropertyState(e,t){return null!=e[t]?e[t].split("/")[0]:""}JSONStringify(e){return JSON.stringify(e).replace(/[\u007f-\uffff]/g,e=>"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4))}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(C.b),i.Zb(Ur))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var _j=function(e){return e.Organization="Organization",e.Collection="Collection",e.Private="Private",e.Category="Category",e.Community="Community",e.Internal="Internal",e.Loft="Loft",e}({});class jj{constructor(e="",t,n=25,i=0){this.query=e,this.sortBy=t,this.pageSize=n,this.offset=i}}class Pj{}var Mj=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},Ij=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const zj={loading:!0,searchMode:fj.Query,viewMode:xj,searchResults:{total:0,items:[]},checkedResults:[],searchConfig:null,searchOptions:null,sidenav:{enabled:!0,open:!0},bulkActions:{enabled:!0,items:[]},cardActions:{enabled:!0}};let Tj=(()=>{let e=class{constructor(e,t,n,i,o){this.organizationsService=e,this.modulesService=t,this.exploreService=n,this.bookmarksService=i,this.store=o}static getLoading(e){return e.loading}static getSearchMode(e){return e.searchMode}static getSearchConfig(e){return e.searchConfig}static getSearchOptions(e){return e.searchOptions}static getSearchType(e){return e.searchConfig?e.searchConfig.type:null}static getSearchGroup(e){var t;switch(null===(t=e.searchConfig)||void 0===t?void 0:t.type){case _j.Category:case _j.Community:case _j.Internal:case _j.Loft:return s.Module;case _j.Collection:case _j.Private:case _j.Organization:return s.Bookmark}}static getViewMode(e){return e.viewMode}static getSort(e){return e.searchOptions.sortBy}static getSortOptions(e){switch(e.searchConfig.type){case _j.Loft:return[lw,pw];case _j.Category:return[aw,cw,lw,pw];default:return[cw,lw,pw,dw,uw]}}static getSidenav(e){return e.sidenav}static getBulkActions(e){return e.bulkActions}static getCardActions(e){return e.cardActions}static getFilteredResults(e,t){const{searchResults:n,searchOptions:i}=e,{ascending:o,fields:s}=i.sortBy;let r=Dw(n.items,s,o);return!0!==Object(X.get)(t,"userProfile.premium_account_valid")&&(r=[...r.filter(e=>!0!==e.premium),...r.filter(e=>!0===e.premium)]),r=r.slice(i.offset,i.offset+i.pageSize),Object.assign(Object.assign({},n),{items:r})}static getAllResults(e,t){const{searchResults:n,searchOptions:i}=e,{ascending:o,fields:s}=i.sortBy;let r=Dw(n.items,s,o);return!0!==Object(X.get)(t,"userProfile.premium_account_valid")&&(r=[...r.filter(e=>!0!==e.premium),...r.filter(e=>!0===e.premium)]),{total:n.total,items:r}}static getCheckedResults(e){return e.checkedResults}setSearchMode(e,t){e.patchState({searchMode:t.searchMode})}setViewMode(e,t){e.patchState({viewMode:t.viewMode})}setSearchOptions(e,t){e.patchState({searchOptions:Object.assign({},t.options)})}setSearchConfig(e,t){const n=t.config||e.getState().searchConfig,i=t.options||e.getState().searchOptions;null!==n&&e.patchState({searchOptions:Object.assign({},i),searchConfig:Object.assign({},n)})}searchStudio(e,t){const{searchConfig:n,searchOptions:i}=e.getState(),o=new jj("",lw),s=this.store.selectSnapshot(lj.getUserLanguage);e.patchState({loading:!0,searchOptions:Object.assign(Object.assign({},i),{pageSize:o.pageSize,offset:o.offset}),checkedResults:[]});let r=new q.a;switch(n.type){case _j.Category:r=this.exploreService.getAnatomyCategory(n.query,"all"===n.categoryId?"":n.categoryId,n.tags,s);break;case _j.Organization:r=this.bookmarksService.getOrganizationContent(n.organizationId,n.query);break;case _j.Collection:r=this.organizationsService.getCollectionContent(n.organizationId,n.collectionId,n.query);break;case _j.Community:r=this.bookmarksService.getPublicBookmarks(n.query);break;case _j.Private:r=this.bookmarksService.getPrivateBookmarks(n.query);break;case _j.Internal:r=this.exploreService.searchInternal(n.query,n.directory);break;case _j.Loft:const e=n.query.indexOf(".json")>0;r=this.modulesService.listContents(n.primary,n.secondary,e?n.query:"",!0).pipe(Object(k.a)(t=>e?t:t.filter(e=>e.title.indexOf(n.query)>=0)))}r.pipe(Object(E.a)(()=>e.patchState({loading:!1}))).subscribe(t=>{e.dispatch(new Y_.SearchSuccess(t))})}searchSuccess(e,t){e.patchState({searchResults:{items:t.bookmarks,total:t.bookmarks.length}})}checkItem(e,t){let n=e.getState().checkedResults;const i=n.some(e=>e===t.id);t.checked&&!i?n=[...n,t.id]:t.checked||(n=n.filter(e=>e!==t.id)),e.patchState({checkedResults:n})}checkAll(e,t){Object(X.isNil)(t.checked);const n=e.getState().searchResults.items.map(e=>e.id);e.patchState({checkedResults:n})}setCheckedItems(e,t){e.patchState({checkedResults:t.ids})}setSidenav(e,t){e.patchState({sidenav:Object.assign({},t.sidenav)})}setCardActions(e,t){e.patchState({cardActions:Object.assign({},t.cardActions)})}setBulkActions(e,t){e.patchState({bulkActions:Object.assign({},t.bulkActions)})}clearResults(e,t){e.patchState({searchResults:{items:[],total:0}})}resetGallery(e,t){e.patchState(zj)}};return e.\u0275fac=function(t){return new(t||e)(i.Zb(Uw),i.Zb(kj),i.Zb(yx),i.Zb(Ox),i.Zb(d.g))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac}),Mj([Object(d.a)(Y_.SetSearchMode),Ij("design:type",Function),Ij("design:paramtypes",[Object,Y_.SetSearchMode]),Ij("design:returntype",void 0)],e.prototype,"setSearchMode",null),Mj([Object(d.a)(Y_.SetViewMode),Ij("design:type",Function),Ij("design:paramtypes",[Object,Y_.SetViewMode]),Ij("design:returntype",void 0)],e.prototype,"setViewMode",null),Mj([Object(d.a)(Y_.SetSearchOptions),Ij("design:type",Function),Ij("design:paramtypes",[Object,Y_.SetSearchOptions]),Ij("design:returntype",void 0)],e.prototype,"setSearchOptions",null),Mj([Object(d.a)(Y_.SetSearchConfig),Ij("design:type",Function),Ij("design:paramtypes",[Object,Y_.SetSearchConfig]),Ij("design:returntype",void 0)],e.prototype,"setSearchConfig",null),Mj([Object(d.a)(Y_.SearchStudio),Ij("design:type",Function),Ij("design:paramtypes",[Object,Y_.SearchStudio]),Ij("design:returntype",void 0)],e.prototype,"searchStudio",null),Mj([Object(d.a)(Y_.SearchSuccess),Ij("design:type",Function),Ij("design:paramtypes",[Object,Y_.SearchSuccess]),Ij("design:returntype",void 0)],e.prototype,"searchSuccess",null),Mj([Object(d.a)(Y_.CheckItem),Ij("design:type",Function),Ij("design:paramtypes",[Object,Y_.CheckItem]),Ij("design:returntype",void 0)],e.prototype,"checkItem",null),Mj([Object(d.a)(Y_.CheckAll),Ij("design:type",Function),Ij("design:paramtypes",[Object,Y_.CheckAll]),Ij("design:returntype",void 0)],e.prototype,"checkAll",null),Mj([Object(d.a)(Y_.SetCheckedItems),Ij("design:type",Function),Ij("design:paramtypes",[Object,Y_.SetCheckedItems]),Ij("design:returntype",void 0)],e.prototype,"setCheckedItems",null),Mj([Object(d.a)(Y_.SetSidenav),Ij("design:type",Function),Ij("design:paramtypes",[Object,Y_.SetSidenav]),Ij("design:returntype",void 0)],e.prototype,"setSidenav",null),Mj([Object(d.a)(Y_.SetCardActions),Ij("design:type",Function),Ij("design:paramtypes",[Object,Y_.SetCardActions]),Ij("design:returntype",void 0)],e.prototype,"setCardActions",null),Mj([Object(d.a)(Y_.SetBulkActions),Ij("design:type",Function),Ij("design:paramtypes",[Object,Y_.SetBulkActions]),Ij("design:returntype",void 0)],e.prototype,"setBulkActions",null),Mj([Object(d.a)(Y_.ClearResults),Ij("design:type",Function),Ij("design:paramtypes",[Object,Y_.ClearResults]),Ij("design:returntype",void 0)],e.prototype,"clearResults",null),Mj([Object(d.a)(Y_.Reset),Ij("design:type",Function),Ij("design:paramtypes",[Object,Y_.Reset]),Ij("design:returntype",void 0)],e.prototype,"resetGallery",null),Mj([Object(d.e)(),Ij("design:type",Function),Ij("design:paramtypes",[mj]),Ij("design:returntype",void 0)],e,"getLoading",null),Mj([Object(d.e)(),Ij("design:type",Function),Ij("design:paramtypes",[mj]),Ij("design:returntype",void 0)],e,"getSearchMode",null),Mj([Object(d.e)(),Ij("design:type",Function),Ij("design:paramtypes",[mj]),Ij("design:returntype",void 0)],e,"getSearchConfig",null),Mj([Object(d.e)(),Ij("design:type",Function),Ij("design:paramtypes",[mj]),Ij("design:returntype",void 0)],e,"getSearchOptions",null),Mj([Object(d.e)(),Ij("design:type",Function),Ij("design:paramtypes",[mj]),Ij("design:returntype",void 0)],e,"getSearchType",null),Mj([Object(d.e)(),Ij("design:type",Function),Ij("design:paramtypes",[mj]),Ij("design:returntype",void 0)],e,"getSearchGroup",null),Mj([Object(d.e)(),Ij("design:type",Function),Ij("design:paramtypes",[mj]),Ij("design:returntype",void 0)],e,"getViewMode",null),Mj([Object(d.e)(),Ij("design:type",Function),Ij("design:paramtypes",[mj]),Ij("design:returntype",void 0)],e,"getSort",null),Mj([Object(d.e)(),Ij("design:type",Function),Ij("design:paramtypes",[mj]),Ij("design:returntype",void 0)],e,"getSortOptions",null),Mj([Object(d.e)(),Ij("design:type",Function),Ij("design:paramtypes",[mj]),Ij("design:returntype",void 0)],e,"getSidenav",null),Mj([Object(d.e)(),Ij("design:type",Function),Ij("design:paramtypes",[mj]),Ij("design:returntype",void 0)],e,"getBulkActions",null),Mj([Object(d.e)(),Ij("design:type",Function),Ij("design:paramtypes",[mj]),Ij("design:returntype",void 0)],e,"getCardActions",null),Mj([Object(d.e)([lj]),Ij("design:type",Function),Ij("design:paramtypes",[mj,rk]),Ij("design:returntype",Pj)],e,"getFilteredResults",null),Mj([Object(d.e)(),Ij("design:type",Function),Ij("design:paramtypes",[mj,rk]),Ij("design:returntype",Pj)],e,"getAllResults",null),Mj([Object(d.e)(),Ij("design:type",Function),Ij("design:paramtypes",[mj]),Ij("design:returntype",void 0)],e,"getCheckedResults",null),e=Mj([Object(d.f)({name:"gallery",defaults:zj})],e),e})(),Uj=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[d.c.forFeature([Tj]),fg.b,Z.f,kS,ms.c,gu.q,bj,zS,mS,hS,VS,LS,HS,oS.a]]}),e})(),Lj=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[HS,hS,ms.c,Z.f,VS,Us,gu.q,bj,Uj,d.c.forFeature([wp])]]}),e})(),Dj=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[ms.c,cd.a.forChild()]]}),e})(),Ej=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[ms.c,HS,hS,Dj]]}),e})(),Fj=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[d.c.forFeature([Bi]),ms.c,SS,gu.q]]}),e})(),Aj=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[d.c.forFeature([Qr,Bo,Tr]),ms.c,HS,hS,TS,Ej,gu.q,cd.a.forChild(),Fj]]}),e})(),Rj=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[d.c.forFeature([is,Ko,ii,Pl,_i]),J.d,ms.c,zS,hS,gu.i,Aj,HS,TS]]}),e})();class Nj{}var Vj=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},Hj=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const Bj={joining:!1,inviting:!1,loadingUsers:!1,users:[]};let Qj=(()=>{let e=class{constructor(e,t,n){this.organizationsService=e,this.publishService=t,this.pendoService=n}static getOrganizations(e){return e.organizations}static getOrganization(e){return e.organization}static getSelectedOrganization(e){return e.selectedOrganization}static getUsers(e){return e.users}static getCollections(e){return e.collections}static getSelectedCollection(e){return e.selectedCollection}static getWidgetURL(e){return e.widgetURL}static getWidgetOptions(e){return e.widgetOptions}static getAppFeatures(e){return e.appFeatures}static getJoining(e){return e.joining}static getInviting(e){return e.inviting}static getUsersLoading(e){return e.loadingUsers}selectOrganization(e,t){const n=t.organization;e.patchState({selectedOrganization:n,selectedCollection:null}),n&&e.dispatch(new j_(n.id))}setOrganizations(e,t){const n=t.organizations||[],i=n[0];let o,s=null,r=Object.assign({},e.getState().appFeatures);if(i&&i.group_attributes){const e=i.group_attributes,t=this.organizationsService.getOrganizationAttribute(e,"widget_settings","widget_custom_url_path");t&&t.value&&(o=t.value);const n=this.organizationsService.getOrganizationAttribute(e,"widget_settings","widget_url_params");n&&n.value&&(s=this.publishService.extendWidgetOptions(new hw,n.value));const a=this.organizationsService.getOrganizationAttribute(e,"app_settings","web_app_features");a&&(r=Object.assign(Object.assign({},r),a.value))}e.patchState({organization:i,organizations:n,widgetURL:o,widgetOptions:s,appFeatures:r}),e.dispatch(new QS(o))}joinOrganization(e,{organization:t}){e.patchState({joining:!0}),this.organizationsService.addUserToOrganization(t.eid).pipe(Object(E.a)(()=>e.patchState({joining:!1}))).subscribe(()=>e.dispatch(new I_(t)),n=>e.dispatch(new z_(t)))}joinOrganizationWithCode(e,{code:t}){e.patchState({joining:!0}),this.organizationsService.addUserWithGroupCode(t).pipe(Object(E.a)(()=>e.patchState({joining:!1}))).subscribe(t=>e.dispatch(new U_(t)),t=>e.dispatch(new L_(t)))}joinOrganizationWithCodeSuccess(e){this.pendoService.track("Account Upgrade - Free Individual to Team")}sendOrganizationInvite(e,{groupEID:t,emails:n}){e.patchState({inviting:!0}),this.organizationsService.sendOrganizationInvites(t,n).pipe(Object(E.a)(()=>e.patchState({inviting:!1}))).subscribe(t=>e.dispatch(new E_(t)),t=>e.dispatch(new F_(t)))}getOrganizationUsers(e,{groupId:t}){e.patchState({loadingUsers:!0}),this.organizationsService.getOrganizationUsers({group_id:t}).pipe(Object(E.a)(()=>e.patchState({loadingUsers:!1}))).subscribe(t=>e.dispatch(new R_(t)),t=>e.dispatch(new N_(t)))}getOrganizationUsersSuccess(e,{users:t}){e.patchState({users:t})}getCollections(e,t){this.organizationsService.getCollections(t.organizationId).subscribe(t=>{e.dispatch(new P_(t))})}getCollectionsSuccess(e,t){e.patchState({collections:t.collections})}selectCollection(e,t){const{organization:n,selectedOrganization:i}=e.getState();e.patchState({selectedOrganization:i||n,selectedCollection:t.collection})}resetOrganizations(e,t){e.setState(Bj)}updateUserRoles(e,{groupId:t,users:n}){this.organizationsService.updateUserRoles(t,n).subscribe(()=>e.dispatch(new B_(t,n)),()=>e.dispatch(new Q_))}removeOrganizationUser(e,{groupId:t,users:n}){this.organizationsService.removeUsers(t,n).subscribe(()=>e.dispatch(new q_(t,n)),()=>e.dispatch(new W_))}transferOrganizationContent(e,{groupId:t,users:n}){this.organizationsService.transferUserContent(t,n).subscribe(()=>e.dispatch(new G_(t,n)),()=>e.dispatch(new Z_))}};return e.\u0275fac=function(t){return new(t||e)(i.Zb(Uw),i.Zb(ww),i.Zb(ee))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac}),Vj([Object(d.a)(k_),Hj("design:type",Function),Hj("design:paramtypes",[Object,k_]),Hj("design:returntype",void 0)],e.prototype,"selectOrganization",null),Vj([Object(d.a)(S_),Hj("design:type",Function),Hj("design:paramtypes",[Object,S_]),Hj("design:returntype",void 0)],e.prototype,"setOrganizations",null),Vj([Object(d.a)(M_),Hj("design:type",Function),Hj("design:paramtypes",[Object,M_]),Hj("design:returntype",void 0)],e.prototype,"joinOrganization",null),Vj([Object(d.a)(T_),Hj("design:type",Function),Hj("design:paramtypes",[Object,T_]),Hj("design:returntype",void 0)],e.prototype,"joinOrganizationWithCode",null),Vj([Object(d.a)(U_),Hj("design:type",Function),Hj("design:paramtypes",[Object]),Hj("design:returntype",void 0)],e.prototype,"joinOrganizationWithCodeSuccess",null),Vj([Object(d.a)(D_),Hj("design:type",Function),Hj("design:paramtypes",[Object,D_]),Hj("design:returntype",void 0)],e.prototype,"sendOrganizationInvite",null),Vj([Object(d.a)(A_),Hj("design:type",Function),Hj("design:paramtypes",[Object,A_]),Hj("design:returntype",void 0)],e.prototype,"getOrganizationUsers",null),Vj([Object(d.a)(R_),Hj("design:type",Function),Hj("design:paramtypes",[Object,R_]),Hj("design:returntype",void 0)],e.prototype,"getOrganizationUsersSuccess",null),Vj([Object(d.a)(j_),Hj("design:type",Function),Hj("design:paramtypes",[Object,j_]),Hj("design:returntype",void 0)],e.prototype,"getCollections",null),Vj([Object(d.a)(P_),Hj("design:type",Function),Hj("design:paramtypes",[Object,P_]),Hj("design:returntype",void 0)],e.prototype,"getCollectionsSuccess",null),Vj([Object(d.a)(__),Hj("design:type",Function),Hj("design:paramtypes",[Object,__]),Hj("design:returntype",void 0)],e.prototype,"selectCollection",null),Vj([Object(d.a)(V_),Hj("design:type",Function),Hj("design:paramtypes",[Object,V_]),Hj("design:returntype",void 0)],e.prototype,"resetOrganizations",null),Vj([Object(d.a)(H_),Hj("design:type",Function),Hj("design:paramtypes",[Object,H_]),Hj("design:returntype",void 0)],e.prototype,"updateUserRoles",null),Vj([Object(d.a)($_),Hj("design:type",Function),Hj("design:paramtypes",[Object,$_]),Hj("design:returntype",void 0)],e.prototype,"removeOrganizationUser",null),Vj([Object(d.a)(K_),Hj("design:type",Function),Hj("design:paramtypes",[Object,K_]),Hj("design:returntype",void 0)],e.prototype,"transferOrganizationContent",null),Vj([Object(d.e)(),Hj("design:type",Function),Hj("design:paramtypes",[Nj]),Hj("design:returntype",void 0)],e,"getOrganizations",null),Vj([Object(d.e)(),Hj("design:type",Function),Hj("design:paramtypes",[Nj]),Hj("design:returntype",void 0)],e,"getOrganization",null),Vj([Object(d.e)(),Hj("design:type",Function),Hj("design:paramtypes",[Nj]),Hj("design:returntype",void 0)],e,"getSelectedOrganization",null),Vj([Object(d.e)(),Hj("design:type",Function),Hj("design:paramtypes",[Nj]),Hj("design:returntype",void 0)],e,"getUsers",null),Vj([Object(d.e)(),Hj("design:type",Function),Hj("design:paramtypes",[Nj]),Hj("design:returntype",void 0)],e,"getCollections",null),Vj([Object(d.e)(),Hj("design:type",Function),Hj("design:paramtypes",[Nj]),Hj("design:returntype",void 0)],e,"getSelectedCollection",null),Vj([Object(d.e)(),Hj("design:type",Function),Hj("design:paramtypes",[Nj]),Hj("design:returntype",void 0)],e,"getWidgetURL",null),Vj([Object(d.e)(),Hj("design:type",Function),Hj("design:paramtypes",[Nj]),Hj("design:returntype",void 0)],e,"getWidgetOptions",null),Vj([Object(d.e)(),Hj("design:type",Function),Hj("design:paramtypes",[Nj]),Hj("design:returntype",void 0)],e,"getAppFeatures",null),Vj([Object(d.e)(),Hj("design:type",Function),Hj("design:paramtypes",[Nj]),Hj("design:returntype",void 0)],e,"getJoining",null),Vj([Object(d.e)(),Hj("design:type",Function),Hj("design:paramtypes",[Nj]),Hj("design:returntype",void 0)],e,"getInviting",null),Vj([Object(d.e)(),Hj("design:type",Function),Hj("design:paramtypes",[Nj]),Hj("design:returntype",void 0)],e,"getUsersLoading",null),e=Vj([Object(d.f)({name:"organizations",defaults:Bj})],e),e})(),$j=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[ms.c,hS,HS,hj,d.c.forFeature([Qj])]]}),e})(),qj=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[ms.c,hS,HS]]}),e})(),Wj=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[ms.c,hS,HS]]}),e})(),Kj=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[ms.c,hS,HS,gu.q]]}),e})(),Gj=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[ms.c,hS,HS]]}),e})(),Zj=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[ms.c,hS,HS]]}),e})(),Jj=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[ms.c,hS,HS]]}),e})(),Xj=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[ms.c,hS,HS]]}),e})(),Yj=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[ms.c,hS,HS]]}),e})(),eP=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[ms.c,hS,kS]]}),e})(),tP=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[ms.c,hS,HS]]}),e})(),nP=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[ms.c,hS,HS,gu.q]]}),e})(),iP=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[ms.c,hS,HS,gu.q]]}),e})(),oP=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[ms.c,hS,HS]]}),e})();class sP{}var rP;!function(e){class t{constructor(){}}t.type="[Dialog] Open Limit",e.OpenLimit=t;class n{constructor(e){this.upgrade=e}}n.type="[Dialog] Close Limit",e.CloseLimit=n;class i{constructor(){}}i.type="[Dialog] Open Premium Content",e.OpenPremiumContent=i;class o{constructor(e){this.confirmed=e}}o.type="[Dialog] Close Premium Content",e.ClosePremiumContent=o;class s{constructor(){}}s.type="[Dialog] Open Upgrade",e.OpenUpgrade=s;class r{constructor(){}}r.type="[Dialog] Close Upgrade",e.CloseUpgrade=r}(rP||(rP={}));let aP=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-limit-dialog"]],decls:12,vars:2,consts:[["mat-dialog-title",""],["mat-dialog-content","",1,"pt-1","pb-6"],[1,"text-14","pb-3"],[1,"text-14"],["mat-dialog-actions","",1,"pt-2"],["app-button","","buttonTheme","light","cdkFocusInitial","",1,"mr-2",3,"mat-dialog-close"],["app-button","","buttonType","primary",3,"mat-dialog-close"]],template:function(e,t){1&e&&(i.Vb(0,"h1",0),i.Mc(1," New Bookmark Limit Reached\n"),i.Ub(),i.Vb(2,"div",1),i.Vb(3,"div",2),i.Mc(4,"You've reached your limit of 5 3D models in your Library. You can make changes to this model, but you will not be able to save as a new model."),i.Ub(),i.Vb(5,"div",3),i.Mc(6,"Upgrade to a Premium Plan to save unlimited 3D models."),i.Ub(),i.Ub(),i.Vb(7,"div",4),i.Vb(8,"button",5),i.Mc(9,"OK"),i.Ub(),i.Vb(10,"button",6),i.Mc(11,"Go Premium"),i.Ub(),i.Ub()),2&e&&(i.Db(8),i.lc("mat-dialog-close",!1),i.Db(2),i.lc("mat-dialog-close",!0))},directives:[Td.h,Td.e,Td.c,nc,Td.d],styles:[""],changeDetection:0}),e})();function cP(e,t){if(1&e&&i.Qb(0,"iframe",5),2&e){const e=i.gc();i.lc("src",e.src,i.Bc)}}var lP=function(e){return e.UpgradeSubscription="/legacy/upgrade-human.html",e.BuySubscription="/legacy/buy-subscription.html",e.MyProfile="/legacy/user-account.html",e}({});let pP=(()=>{class e{constructor(e,t,n){this.dialogRef=e,this.data=t,this.sanitizer=n,this.headerOffset=100,this.settings={type:null,dimensions:{width:100,height:100}},this.settings=Object.assign(Object.assign({},this.settings),t);const{width:i,height:o}=t.dimensions;this.dialogRef.updateSize(i+"px",o+"px")}get height(){const{height:e}=this.settings.dimensions;return Math.max(200,e-this.headerOffset)}get src(){const e=this.getURL();return e?this.sanitizer.bypassSecurityTrustResourceUrl(e):null}ngOnInit(){}closeDialog(){this.dialogRef.close()}getURL(){const e=""+this.settings.type;if(Object.values(lP).includes(e)){const t=this.getURLParams();return t?`${e}?${t}`:e}return""}getURLParams(){const e=this.settings.options;return e?Object.entries(e).map(([e,t])=>`${e}=${t}`).join("&"):""}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(Td.g),i.Pb(Td.a),i.Pb(l.b))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-legacy-dialog"]],decls:5,vars:4,consts:[[1,"modal"],["app-button","","buttonType","text","buttonTheme","light","type","button","title","Close",1,"modal__close",3,"click"],["icon","times","size","lg"],[1,"modal__contents"],["class","modal__frame",3,"src",4,"ngIf"],[1,"modal__frame",3,"src"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Vb(1,"button",1),i.cc("click",(function(){return t.closeDialog()})),i.Qb(2,"app-icon",2),i.Ub(),i.Vb(3,"div",3),i.Kc(4,cP,1,1,"iframe",4),i.Ub(),i.Ub()),2&e&&(i.Db(1),i.Eb("aria-label","Close"),i.Db(2),i.Hc("height",t.height+"px"),i.Db(1),i.lc("ngIf",t.src))},directives:[nc,$a,ms.l],styles:[".modal[_ngcontent-%COMP%]{display:flex;flex-direction:column}.modal__close[_ngcontent-%COMP%]{margin-bottom:4px;align-self:flex-end;cursor:pointer}.modal__contents[_ngcontent-%COMP%]{display:flex;flex-flow:column;height:100vh}.modal__frame[_ngcontent-%COMP%]{flex:1 1 auto;display:flex}"],changeDetection:0}),e})();function dP(e,t){if(1&e&&(i.Vb(0,"button",8),i.Mc(1),i.Ub()),2&e){const e=i.gc();i.Db(1),i.Nc(e.settings.miscText)}}function uP(e,t){if(1&e&&(i.Vb(0,"button",9),i.Mc(1),i.Ub()),2&e){const e=i.gc();i.lc("mat-dialog-close",!1),i.Db(1),i.Nc(e.settings.cancelText)}}function gP(e,t){if(1&e&&(i.Vb(0,"button",10),i.Mc(1),i.Ub()),2&e){const e=i.gc();i.lc("mat-dialog-close",!0),i.Db(1),i.Nc(e.settings.confirmText)}}let hP=(()=>{class e{constructor(e,t){this.dialogRef=e,this.data=t,this.settings={titleText:"Confirm Action",bodyText:"",confirmText:"Confirm",confirmColor:"primary",cancelText:"Cancel",confirmEnabled:!0,cancelEnabled:!0,miscText:""},t&&(this.settings=Object.assign(Object.assign({},this.settings),t))}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(Td.g),i.Pb(Td.a))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-confirm-dialog"]],decls:11,vars:7,consts:[["data-test","confirmDialog"],["mat-dialog-title",""],["mat-dialog-content","",1,"pt-4","pb-6"],[1,"text-14"],["mat-dialog-actions","",1,"dialog__actions","pt-2"],["app-button","","buttonTheme","light",3,"mat-dialog-close",4,"ngIf"],["class","mr-1","app-button","","buttonTheme","light",3,"mat-dialog-close",4,"ngIf"],["app-button","","buttonType","primary","cdkFocusInitial","",3,"mat-dialog-close",4,"ngIf"],["app-button","","buttonTheme","light",3,"mat-dialog-close"],["app-button","","buttonTheme","light",1,"mr-1",3,"mat-dialog-close"],["app-button","","buttonType","primary","cdkFocusInitial","",3,"mat-dialog-close"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Vb(1,"h1",1),i.Mc(2),i.Ub(),i.Vb(3,"div",2),i.Vb(4,"div",3),i.Mc(5),i.Ub(),i.Ub(),i.Vb(6,"div",4),i.Kc(7,dP,2,1,"button",5),i.Vb(8,"div"),i.Kc(9,uP,2,2,"button",6),i.Kc(10,gP,2,2,"button",7),i.Ub(),i.Ub(),i.Ub()),2&e&&(i.Db(2),i.Oc(" ",t.settings.titleText," "),i.Db(3),i.Nc(t.settings.bodyText),i.Db(1),i.Hb("dialog__actions--compact",!t.settings.miscText),i.Db(1),i.lc("ngIf",t.settings.miscText),i.Db(2),i.lc("ngIf",t.settings.cancelEnabled),i.Db(1),i.lc("ngIf",t.settings.confirmEnabled))},directives:[Td.h,Td.e,Td.c,ms.l,nc,Td.d],styles:["[_nghost-%COMP%]{display:block}.dialog__actions[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:center}.dialog__actions--compact[_ngcontent-%COMP%]{justify-content:flex-end}@media (min-width:480px){[_nghost-%COMP%]{min-width:320px}}"],changeDetection:0}),e})();const bP=["copyField"];let mP=(()=>{class e{constructor(e,t,n){this.dialogRef=e,this.data=t,this.clipboardService=n,this.settings={title:"Copy to Clipboard",copyText:""},this.settings=Object.assign(Object.assign({},this.settings),t)}get rowCount(){return this.settings.copyText.split(/\r?\n/).length+1}ngOnInit(){}ngAfterViewInit(){const e=this.copyField.nativeElement;e.focus(),e.select()}handleCopyClick(){const e=this.clipboardService.copyInputFieldValue(this.copyField.nativeElement);this.close(e)}handleCancelClick(){this.close(!1)}close(e){this.dialogRef.close(e)}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(Td.g),i.Pb(Td.a),i.Pb(qa))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-clipboard-dialog"]],viewQuery:function(e,t){if(1&e&&i.Gc(bP,!0),2&e){let e;i.uc(e=i.dc())&&(t.copyField=e.first)}},decls:11,vars:3,consts:[["mat-dialog-title",""],["mat-dialog-content","",1,"copy"],[1,"copy__input",3,"value","rows"],["copyField",""],["mat-dialog-actions",""],["app-button","","buttonTheme","light",3,"click"],["app-button","","buttonType","primary",3,"click"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Mc(1),i.Ub(),i.Vb(2,"div",1),i.Vb(3,"textarea",2,3),i.Mc(5,"  "),i.Ub(),i.Ub(),i.Vb(6,"div",4),i.Vb(7,"button",5),i.cc("click",(function(){return t.handleCancelClick()})),i.Mc(8,"Cancel"),i.Ub(),i.Vb(9,"button",6),i.cc("click",(function(){return t.handleCopyClick()})),i.Mc(10,"Copy to Clipboard"),i.Ub(),i.Ub()),2&e&&(i.Db(1),i.Oc(" ",t.settings.title,"\n"),i.Db(2),i.lc("value",t.settings.copyText)("rows",t.rowCount))},directives:[Td.h,Td.e,Td.c,nc],styles:[".copy[_ngcontent-%COMP%]{min-width:480px;display:flex}.copy__input[_ngcontent-%COMP%]{flex:1}"],changeDetection:0}),e})(),fP=(()=>{class e{constructor(e,t){this.dialog=e,this.engineService=t}get isMobile(){return window.innerWidth<=959}openClipboardDialog(e,t){const n=Object.assign({data:{id:Kd.ClipboardDialog,copyText:e}},t);return this.dialog.open(mP,n)}openConfirmDialog(e){const t=Object.assign({id:Kd.ConfirmDialog},e);return this.dialog.open(hP,t)}openLimitDialog(){return this.closeAllDialogs(),this.dialog.open(aP,{id:Kd.LimitDialog,width:"480px"})}openUpgradeDialog(e){const t={width:925,height:700},n=Object.assign(Object.assign({id:Kd.UpgradeDialog},{width:t.width+"px",height:t.height+"px",data:{type:lP.UpgradeSubscription,dimensions:t}}),e);return this.closeAllDialogs(),c.native?(this.engineService.fireEvent(it.NativeUpgrade,null),Object(S.a)()):this.dialog.open(pP,n).afterClosed()}openPremiumContentDialog(){const e=c.native||!this.isMobile;return this.openConfirmDialog({id:Kd.PremiumContentDialog,data:{titleText:"Premium Content",bodyText:e?"This is premium content. Upgrade to a Premium Plan for unlimited access.":"This is premium content. Visit us on desktop to upgrade to a premium plan.",confirmText:"Go Premium",confirmEnabled:e,cancelText:"OK",confirmColor:"warn"}})}closeAllDialogs(){this.dialog.closeAll()}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(Td.b),i.Zb(lt))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var yP=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},xP=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let vP=(()=>{let e=class{constructor(e){this.dialogService=e}static getOpenDialog(e){return e.openDialog}openLimit(e,t){this.dialogService.openLimitDialog().afterClosed().subscribe(t=>{e.dispatch(new rP.CloseLimit(t))})}closeLimit(e,t){t.upgrade&&this.dialogService.openUpgradeDialog()}openPremiumContent(e,t){this.dialogService.openPremiumContentDialog().afterClosed().subscribe(t=>{e.dispatch(new rP.ClosePremiumContent(t))})}closePremiumContent(e,t){t.confirmed&&e.dispatch(new rP.OpenUpgrade)}openUpgrade(e,t){this.dialogService.openUpgradeDialog()}};return e.\u0275fac=function(t){return new(t||e)(i.Zb(fP))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac}),yP([Object(d.a)(rP.OpenLimit),xP("design:type",Function),xP("design:paramtypes",[Object,rP.OpenLimit]),xP("design:returntype",void 0)],e.prototype,"openLimit",null),yP([Object(d.a)(rP.CloseLimit),xP("design:type",Function),xP("design:paramtypes",[Object,rP.CloseLimit]),xP("design:returntype",void 0)],e.prototype,"closeLimit",null),yP([Object(d.a)(rP.OpenPremiumContent),xP("design:type",Function),xP("design:paramtypes",[Object,rP.OpenPremiumContent]),xP("design:returntype",void 0)],e.prototype,"openPremiumContent",null),yP([Object(d.a)(rP.ClosePremiumContent),xP("design:type",Function),xP("design:paramtypes",[Object,rP.ClosePremiumContent]),xP("design:returntype",void 0)],e.prototype,"closePremiumContent",null),yP([Object(d.a)(rP.OpenUpgrade),xP("design:type",Function),xP("design:paramtypes",[Object,rP.OpenUpgrade]),xP("design:returntype",void 0)],e.prototype,"openUpgrade",null),yP([Object(d.e)(),xP("design:type",Function),xP("design:paramtypes",[sP]),xP("design:returntype",void 0)],e,"getOpenDialog",null),e=yP([Object(d.f)({name:"dialog",defaults:{openDialog:null}})],e),e})(),wP=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[ms.c,hS,HS,gu.q]]}),e})(),OP=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[ms.c,hS,HS,gu.q]]}),e})(),CP=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[ms.c,hS,HS,gu.q]]}),e})(),SP=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[ms.c,hS,HS]]}),e})(),kP=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[ms.c,hS,gu.i,gu.q,HS]]}),e})(),_P=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[ms.c,hS,HS,gu.q]]}),e})(),jP=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[d.c.forFeature([vP]),qj,Wj,Kj,Gj,Zj,Jj,Xj,Yj,eP,tP,nP,iP,oP,wP,OP,CP,SP,kP,_P,RS,ES,HS],qj,Wj,Kj,Gj,Zj,Jj,Xj,Yj,eP,tP,nP,iP,oP,wP,OP,CP,SP,kP,_P]}),e})();const PP=[];let MP=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[Z.f.forChild(PP)],Z.f]}),e})(),IP=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[ms.c]]}),e})(),zP=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[ms.c,SS]]}),e})(),TP=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[ms.c,hS,kS,zS,SS,Ej,mS,gu.q,Fj,LS]]}),e})(),UP=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[d.c.forFeature([il]),cd.a.forChild(),J.d,ms.c,Rj,MP,hS,gu.q,gu.i,kS,zS,SS,FS,AS,IP,US,LS,TS,fg.b,bj,Aj,Ej,HS,zP,Fj,TP]]}),e})(),LP=(()=>{class e{intercept(e,t){return t.handle(e).pipe(Object(k.a)(e=>(e instanceof C.e&&e.body&&e.body.hasOwnProperty("results")&&(e=e.clone({body:e.body.results})),e)))}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac}),e})(),DP=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},providers:[SO],imports:[[d.c.forFeature([B]),ms.c,HS]]}),e})(),EP=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[ms.c,Z.f,kS,zS,SS]]}),e})(),FP=(()=>{class e{parse(e){e=e.replace(/&amp;/g,"&");const t=(new Z.b).parse(e);return this.ensureQueryParam(t.queryParams,"dk",e),this.ensureQueryParam(t.queryParams,"uaid",e),t}serialize(e){return(new Z.b).serialize(e).replace(/%2F/g,"/")}ensureQueryParam(e,t,n){if(e.hasOwnProperty(t))return e;const i=this.getParameterByName(t,n);return null!==i&&(e[t]=i),e}getParameterByName(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");const n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac}),e})(),AP=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[d.c.forFeature([Ol]),ms.c]]}),e})(),RP=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[d.c.forFeature([yf]),ms.c]]}),e})();var NP=n("OnMO");function VP(){const e=new NP.Renderer;return e.link=(e,t,n)=>{var i;return`<a href="${(i=e).match(/^(?:(?:(?:ht)tps?):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i)?i:""}" target="_blank" rel="noreferrer nofollow">${n}</a>`},e.paragraph=e=>`<p>${e}</p>`,e.image=(e,t,n)=>"",{renderer:e,gfm:!1}}let HP=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[ms.c,cd.a.forRoot({markedOptions:{provide:cd.d,useFactory:VP}})]]}),e})(),BP=(()=>{class e{constructor(){}static forRoot(t){return{ngModule:e,providers:[ee,{provide:"pendoConfig",useValue:t}]}}}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[]]}),e})();immer.enableAllPlugins(),immer.enableES5();const QP=[{provide:C.a,useClass:LP,multi:!0},{provide:Z.h,useClass:FP},{provide:ms.a,useValue:"./"},{provide:ms.h,useClass:ms.e}],$P=[{provide:C.a,useClass:LP,multi:!0},{provide:Z.h,useClass:FP}];let qP=(()=>{class e{}return e.\u0275mod=i.Nb({type:e,bootstrap:[pg]}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},providers:!0===c.offline?QP:$P,imports:[[d.c.forRoot(),AP,Us.forRoot(),J.d.forRoot(c.googleAnalyticsId),BP.forRoot({enabled:!0,pendoId:c.pendoId,whitelist:{[o.Viewer]:c.deploy===r.Production?["48Ab","3FZO","3FN2","3Hb8","3FQJ","3FQU","38fD","3wgE","3gLk","3vSx","3XdS","3SOp","3Um8","3hOe","3QWH","4C1Q","3WvE","3epq","3Dyq","3O47","3DJ4","3fKF","3gLf","3PVx","3caY","3cTn","3tVK","3Yau","3QSx","3ZY5","3Z6w","3IF5","3fKs","45y8","3fLN","3QpZ","3J6C","3adO","3Z6v","3hjc","3a50","4EBE","44FH","3WlU","3atu","4E2N","4Bma","43bE","3xxi","3CT7","4D5X","3UVi","3T7X","3QT8","3NG8","3gyj","3UWt","3UWc"]:["production/maleAdult/coronavirus_protein_structure","production/maleAdult/eyeAnatomyTour","production/maleAdult/acute_lymphoblastic_leukemia","production/maleAdult/abdominal_aortic_aneurysm"]},idPrefixes:{[r.Local]:"local-",[r.QA]:"qa-",[r.Staging]:"staging-",[r.Production]:""}}),HP,l.a,p.b,C.c,Rj,bj,Lj,$j,Aj,RP,jP,UP,EP,DP,tS]]}),e})();c.production&&Object(i.V)(),l.d().bootstrapModule(qP).catch(e=>console.error(e))},qpAl:function(e,t){!function(t){var n="Modernizr"in t,i=t.Modernizr;!function(e,t,n,i){function o(e,t){return typeof e===t}function s(e,t){return!!~(""+e).indexOf(t)}function r(){return"function"!=typeof n.createElement?n.createElement(arguments[0]):x?n.createElementNS.call(n,"http://www.w3.org/2000/svg",arguments[0]):n.createElement.apply(n,arguments)}function a(e,t,i,o){var s,a,c,l,p="modernizr",d=r("div"),u=function(){var e=n.body;return e||((e=r(x?"svg":"body")).fake=!0),e}();if(parseInt(i,10))for(;i--;)(c=r("div")).id=o?o[i]:p+(i+1),d.appendChild(c);return(s=r("style")).type="text/css",s.id="s"+p,(u.fake?u:d).appendChild(s),u.appendChild(d),s.styleSheet?s.styleSheet.cssText=e:s.appendChild(n.createTextNode(e)),d.id=p,u.fake&&(u.style.background="",u.style.overflow="hidden",l=y.style.overflow,y.style.overflow="hidden",y.appendChild(u)),a=t(d,e),u.fake&&u.parentNode?(u.parentNode.removeChild(u),y.style.overflow=l):d.parentNode.removeChild(d),!!a}function c(e){return e.replace(/([A-Z])/g,(function(e,t){return"-"+t.toLowerCase()})).replace(/^ms-/,"-ms-")}function l(e,n){var o=e.length;if("CSS"in t&&"supports"in t.CSS){for(;o--;)if(t.CSS.supports(c(e[o]),n))return!0;return!1}if("CSSSupportsRule"in t){for(var s=[];o--;)s.push("("+c(e[o])+":"+n+")");return a("@supports ("+(s=s.join(" or "))+") { #modernizr { position: absolute; } }",(function(e){return"absolute"===function(e,n,i){var o;if("getComputedStyle"in t){o=getComputedStyle.call(t,e,null);var s=t.console;null!==o?o=o.getPropertyValue(i):s&&s[s.error?"error":"log"].call(s,"getComputedStyle returning null, its possible modernizr test results are inaccurate")}else o=e.currentStyle&&e.currentStyle[i];return o}(e,0,"position")}))}return i}function p(e){return e.replace(/([a-z])-([a-z])/g,(function(e,t,n){return t+n.toUpperCase()})).replace(/^-/,"")}function d(e,t,n,a){function c(){u&&(delete C.style,delete C.modElem)}if(a=!o(a,"undefined")&&a,!o(n,"undefined")){var d=l(e,n);if(!o(d,"undefined"))return d}for(var u,g,h,b,m,f=["modernizr","tspan","samp"];!C.style&&f.length;)u=!0,C.modElem=r(f.shift()),C.style=C.modElem.style;for(h=e.length,g=0;g<h;g++)if(m=C.style[b=e[g]],s(b,"-")&&(b=p(b)),C.style[b]!==i){if(a||o(n,"undefined"))return c(),"pfx"!==t||b;try{C.style[b]=n}catch(e){}if(C.style[b]!==m)return c(),"pfx"!==t||b}return c(),!1}function u(e,t){return function(){return e.apply(t,arguments)}}function g(e,t,n,i,s){var r=e.charAt(0).toUpperCase()+e.slice(1),a=(e+" "+w.join(r+" ")+r).split(" ");return o(t,"string")||o(t,"undefined")?d(a,t,i,s):function(e,t,n){var i;for(var s in e)if(e[s]in t)return!1===n?e[s]:o(i=t[e[s]],"function")?u(i,n||t):i;return!1}(a=(e+" "+S.join(r+" ")+r).split(" "),t,n)}var h=[],b={_version:"3.11.6",_config:{classPrefix:"",enableClasses:!0,enableJSClass:!0,usePrefixes:!0},_q:[],on:function(e,t){var n=this;setTimeout((function(){t(n[e])}),0)},addTest:function(e,t,n){h.push({name:e,fn:t,options:n})},addAsyncTest:function(e){h.push({name:null,fn:e})}},m=function(){};m.prototype=b,m=new m;var f=[],y=n.documentElement,x="svg"===y.nodeName.toLowerCase(),v="Moz O ms Webkit",w=b._config.usePrefixes?v.split(" "):[];b._cssomPrefixes=w;var O={elem:r("modernizr")};m._q.push((function(){delete O.elem}));var C={style:O.elem.style};m._q.unshift((function(){delete C.style}));var S=b._config.usePrefixes?v.toLowerCase().split(" "):[];b._domPrefixes=S,b.testAllProps=g;var k=function(e){var n,o=prefixes.length,s=t.CSSRule;if(void 0===s)return i;if(!e)return!1;if((n=(e=e.replace(/^@/,"")).replace(/-/g,"_").toUpperCase()+"_RULE")in s)return"@"+e;for(var r=0;r<o;r++){var a=prefixes[r];if(a.toUpperCase()+"_"+n in s)return"@-"+a.toLowerCase()+"-"+e}return!1};b.atRule=k;var _=b.prefixed=function(e,t,n){return 0===e.indexOf("@")?k(e):(-1!==e.indexOf("-")&&(e=p(e)),t?g(e,t,n):g(e,"pfx"))};m.addTest("fullscreen",!(!_("exitFullscreen",n,!1)&&!_("cancelFullScreen",n,!1))),function(){var e,t,n,i,s,r;for(var a in h)if(h.hasOwnProperty(a)){if(e=[],(t=h[a]).name&&(e.push(t.name.toLowerCase()),t.options&&t.options.aliases&&t.options.aliases.length))for(n=0;n<t.options.aliases.length;n++)e.push(t.options.aliases[n].toLowerCase());for(i=o(t.fn,"function")?t.fn():t.fn,s=0;s<e.length;s++)1===(r=e[s].split(".")).length?m[r[0]]=i:(m[r[0]]&&(!m[r[0]]||m[r[0]]instanceof Boolean)||(m[r[0]]=new Boolean(m[r[0]])),m[r[0]][r[1]]=i),f.push((i?"":"no-")+r.join("-"))}}(),function(e){var t=y.className,n=m._config.classPrefix||"";if(x&&(t=t.baseVal),m._config.enableJSClass){var i=new RegExp("(^|\\s)"+n+"no-js(\\s|$)");t=t.replace(i,"$1"+n+"js$2")}m._config.enableClasses&&(e.length>0&&(t+=" "+n+e.join(" "+n)),x?y.className.baseVal=t:y.className=t)}(f),delete b.addTest,delete b.addAsyncTest;for(var j=0;j<m._q.length;j++)m._q[j]();e.Modernizr=m}(t,t,document),e.exports=t.Modernizr,n?t.Modernizr=i:delete t.Modernizr}(window)},zn8P:function(e,t){function n(e){return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}))}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id="zn8P"}},[[0,0,5]]]);