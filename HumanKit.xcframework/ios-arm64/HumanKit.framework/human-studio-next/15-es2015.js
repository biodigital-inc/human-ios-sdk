(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{5:function(e,t){},j8XN:function(e,t,i){var n;"classList"in document.createElement("_")||function(e){"use strict";if("Element"in e){var t="classList",i="prototype",n=e.Element[i],o=Object,a=String[i].trim||function(){return this.replace(/^\s+|\s+$/g,"")},r=Array[i].indexOf||function(e){for(var t=0,i=this.length;i>t;t++)if(t in this&&this[t]===e)return t;return-1},s=function(e,t){this.name=e,this.code=DOMException[e],this.message=t},c=function(e,t){if(""===t)throw new s("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(t))throw new s("INVALID_CHARACTER_ERR","String contains an invalid character");return r.call(e,t)},l=function(e){for(var t=a.call(e.getAttribute("class")||""),i=t?t.split(/\s+/):[],n=0,o=i.length;o>n;n++)this.push(i[n]);this._updateClassName=function(){e.setAttribute("class",this.toString())}},p=l[i]=[],d=function(){return new l(this)};if(s[i]=Error[i],p.item=function(e){return this[e]||null},p.contains=function(e){return-1!==c(this,e+="")},p.add=function(){var e,t=arguments,i=0,n=t.length,o=!1;do{-1===c(this,e=t[i]+"")&&(this.push(e),o=!0)}while(++i<n);o&&this._updateClassName()},p.remove=function(){var e,t,i=arguments,n=0,o=i.length,a=!1;do{for(t=c(this,e=i[n]+"");-1!==t;)this.splice(t,1),a=!0,t=c(this,e)}while(++n<o);a&&this._updateClassName()},p.toggle=function(e,t){var i=this.contains(e+=""),n=i?!0!==t&&"remove":!1!==t&&"add";return n&&this[n](e),!0===t||!1===t?t:!i},p.toString=function(){return this.join(" ")},o.defineProperty){var u={get:d,enumerable:!0,configurable:!0};try{o.defineProperty(n,t,u)}catch(h){-2146823252===h.number&&(u.enumerable=!1,o.defineProperty(n,t,u))}}else o[i].__defineGetter__&&n.__defineGetter__(t,d)}}(self),function(e){"use strict";if(e.URL=e.URL||e.webkitURL,e.Blob&&e.URL)try{return void new Blob}catch(i){}var t=e.BlobBuilder||e.WebKitBlobBuilder||e.MozBlobBuilder||function(e){var t=function(e){return Object.prototype.toString.call(e).match(/^\[object\s(.*)\]$/)[1]},i=function(){this.data=[]},n=function(e,t,i){this.data=e,this.size=e.length,this.type=t,this.encoding=i},o=i.prototype,a=n.prototype,r=e.FileReaderSync,s=function(e){this.code=this[this.name=e]},c="NOT_FOUND_ERR SECURITY_ERR ABORT_ERR NOT_READABLE_ERR ENCODING_ERR NO_MODIFICATION_ALLOWED_ERR INVALID_STATE_ERR SYNTAX_ERR".split(" "),l=c.length,p=e.URL||e.webkitURL||e,d=p.createObjectURL,u=p.revokeObjectURL,h=p,m=e.btoa,b=e.atob,g=e.ArrayBuffer,f=e.Uint8Array,x=/^[\w-]+:\/*\[?[\w\.:-]+\]?(?::[0-9]+)?/;for(n.fake=a.fake=!0;l--;)s.prototype[c[l]]=l+1;return p.createObjectURL||(h=e.URL=function(e){var t,i=document.createElementNS("http://www.w3.org/1999/xhtml","a");return i.href=e,"origin"in i||("data:"===i.protocol.toLowerCase()?i.origin=null:(t=e.match(x),i.origin=t&&t[1])),i}),h.createObjectURL=function(e){var t,i=e.type;return null===i&&(i="application/octet-stream"),e instanceof n?(t="data:"+i,"base64"===e.encoding?t+";base64,"+e.data:"URI"===e.encoding?t+","+decodeURIComponent(e.data):m?t+";base64,"+m(e.data):t+","+encodeURIComponent(e.data)):d?d.call(p,e):void 0},h.revokeObjectURL=function(e){"data:"!==e.substring(0,5)&&u&&u.call(p,e)},o.append=function(e){var i=this.data;if(f&&(e instanceof g||e instanceof f)){for(var o="",a=new f(e),c=0,l=a.length;l>c;c++)o+=String.fromCharCode(a[c]);i.push(o)}else if("Blob"===t(e)||"File"===t(e)){if(!r)throw new s("NOT_READABLE_ERR");var p=new r;i.push(p.readAsBinaryString(e))}else e instanceof n?"base64"===e.encoding&&b?i.push(b(e.data)):"URI"===e.encoding?i.push(decodeURIComponent(e.data)):"raw"===e.encoding&&i.push(e.data):("string"!=typeof e&&(e+=""),i.push(unescape(encodeURIComponent(e))))},o.getBlob=function(e){return arguments.length||(e=null),new n(this.data.join(""),e,"raw")},o.toString=function(){return"[object BlobBuilder]"},a.slice=function(e,t,i){var o=arguments.length;return 3>o&&(i=null),new n(this.data.slice(e,o>1?t:this.data.length),i,this.encoding)},a.toString=function(){return"[object Blob]"},a.close=function(){this.size=0,delete this.data},i}(e);e.Blob=function(e,i){var n=i&&i.type||"",o=new t;if(e)for(var a=0,r=e.length;r>a;a++)Uint8Array&&e[a]instanceof Uint8Array?o.append(e[a].buffer):o.append(e[a]);var s=o.getBlob(n);return!s.slice&&s.webkitSlice&&(s.slice=s.webkitSlice),s},e.Blob.prototype=(Object.getPrototypeOf||function(e){return e.__proto__})(new e.Blob)}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content||this),function(o,a){"use strict";"undefined"!=typeof process&&process&&process.versions&&process.versions.electron||"object"!=typeof e?void 0===(n=(function(){return a}).call(t,i,t,e))||(e.exports=n):e.exports=a}(0,function(){"use strict";function e(e,t){return this.init(e,t)}return e.extensions={},function(t){function i(e,t){var i,n=Array.prototype.slice.call(arguments,2);t=t||{};for(var o=0;o<n.length;o++){var a=n[o];if(a)for(i in a)a.hasOwnProperty(i)&&void 0!==a[i]&&(e||!1===t.hasOwnProperty(i))&&(t[i]=a[i])}return t}var n=!1;try{var o=document.createElement("div"),a=document.createTextNode(" ");o.appendChild(a),n=o.contains(a)}catch(s){}var r={isIE:"Microsoft Internet Explorer"===navigator.appName||"Netscape"===navigator.appName&&null!==new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})").exec(navigator.userAgent),isEdge:null!==/Edge\/\d+/.exec(navigator.userAgent),isFF:navigator.userAgent.toLowerCase().indexOf("firefox")>-1,isMac:t.navigator.platform.toUpperCase().indexOf("MAC")>=0,keyCode:{BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,SPACE:32,DELETE:46,K:75,M:77,V:86},isMetaCtrlKey:function(e){return!!(r.isMac&&e.metaKey||!r.isMac&&e.ctrlKey)},isKey:function(e,t){var i=r.getKeyCode(e);return!1===Array.isArray(t)?i===t:-1!==t.indexOf(i)},getKeyCode:function(e){var t=e.which;return null===t&&(t=null!==e.charCode?e.charCode:e.keyCode),t},blockContainerElementNames:["p","h1","h2","h3","h4","h5","h6","blockquote","pre","ul","li","ol","address","article","aside","audio","canvas","dd","dl","dt","fieldset","figcaption","figure","footer","form","header","hgroup","main","nav","noscript","output","section","video","table","thead","tbody","tfoot","tr","th","td"],emptyElementNames:["br","col","colgroup","hr","img","input","source","wbr"],extend:function(){var e=[!0].concat(Array.prototype.slice.call(arguments));return i.apply(this,e)},defaults:function(){var e=[!1].concat(Array.prototype.slice.call(arguments));return i.apply(this,e)},createLink:function(e,t,i,n){var o=e.createElement("a");return r.moveTextRangeIntoElement(t[0],t[t.length-1],o),o.setAttribute("href",i),n&&("_blank"===n&&o.setAttribute("rel","noopener noreferrer"),o.setAttribute("target",n)),o},findOrCreateMatchingTextNodes:function(e,t,i){for(var n=e.createTreeWalker(t,NodeFilter.SHOW_ALL,null,!1),o=[],a=0,s=!1,c=null,l=null;null!==(c=n.nextNode());)if(!(c.nodeType>3))if(3===c.nodeType){if(!s&&i.start<a+c.nodeValue.length&&(s=!0,l=r.splitStartNodeIfNeeded(c,i.start,a)),s&&r.splitEndNodeIfNeeded(c,l,i.end,a),s&&a===i.end)break;if(s&&a>i.end+1)throw new Error("PerformLinking overshot the target!");s&&o.push(l||c),a+=c.nodeValue.length,null!==l&&(a+=l.nodeValue.length,n.nextNode()),l=null}else"img"===c.tagName.toLowerCase()&&(!s&&i.start<=a&&(s=!0),s&&o.push(c));return o},splitStartNodeIfNeeded:function(e,t,i){return t!==i?e.splitText(t-i):null},splitEndNodeIfNeeded:function(e,t,i,n){var o,a;a=i-n-(t?e.nodeValue.length:0),(o=n+e.nodeValue.length+(t?t.nodeValue.length:0)-1)>=i&&n!==o&&0!==a&&(t||e).splitText(a)},splitByBlockElements:function(t){if(3!==t.nodeType&&1!==t.nodeType)return[];var i=[],n=e.util.blockContainerElementNames.join(",");if(3===t.nodeType||0===t.querySelectorAll(n).length)return[t];for(var o=0;o<t.childNodes.length;o++){var a=t.childNodes[o];3===a.nodeType?i.push(a):1===a.nodeType&&(0===a.querySelectorAll(n).length?i.push(a):i=i.concat(e.util.splitByBlockElements(a)))}return i},findAdjacentTextNodeWithContent:function(e,t,i){var n,o=!1,a=i.createNodeIterator(e,NodeFilter.SHOW_TEXT,null,!1);for(n=a.nextNode();n;){if(n===t)o=!0;else if(o&&3===n.nodeType&&n.nodeValue&&n.nodeValue.trim().length>0)break;n=a.nextNode()}return n},findPreviousSibling:function(e){if(!e||r.isMediumEditorElement(e))return!1;for(var t=e.previousSibling;!t&&!r.isMediumEditorElement(e.parentNode);)t=(e=e.parentNode).previousSibling;return t},isDescendant:function(e,t,i){if(!e||!t)return!1;if(e===t)return!!i;if(1!==e.nodeType)return!1;if(n||3!==t.nodeType)return e.contains(t);for(var o=t.parentNode;null!==o;){if(o===e)return!0;o=o.parentNode}return!1},isElement:function(e){return!(!e||1!==e.nodeType)},throttle:function(e,t){var i,n,o,a=null,r=0,s=function(){r=Date.now(),a=null,o=e.apply(i,n),a||(i=n=null)};return t||0===t||(t=50),function(){var c=Date.now(),l=t-(c-r);return i=this,n=arguments,0>=l||l>t?(a&&(clearTimeout(a),a=null),r=c,o=e.apply(i,n),a||(i=n=null)):a||(a=setTimeout(s,l)),o}},traverseUp:function(e,t){if(!e)return!1;do{if(1===e.nodeType){if(t(e))return e;if(r.isMediumEditorElement(e))return!1}e=e.parentNode}while(e);return!1},htmlEntities:function(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},insertHTMLCommand:function(t,i){var n,o,a,s,c,l,p=!1,d=["insertHTML",!1,i];if(!e.util.isEdge&&t.queryCommandSupported("insertHTML"))try{return t.execCommand.apply(t,d)}catch(u){}if((n=t.getSelection()).rangeCount){if(o=n.getRangeAt(0),r.isMediumEditorElement(l=o.commonAncestorContainer)&&!l.firstChild)o.selectNode(l.appendChild(t.createTextNode("")));else if(3===l.nodeType&&0===o.startOffset&&o.endOffset===l.nodeValue.length||3!==l.nodeType&&l.innerHTML===o.toString()){for(;!r.isMediumEditorElement(l)&&l.parentNode&&1===l.parentNode.childNodes.length&&!r.isMediumEditorElement(l.parentNode);)l=l.parentNode;o.selectNode(l)}for(o.deleteContents(),(a=t.createElement("div")).innerHTML=i,s=t.createDocumentFragment();a.firstChild;)c=s.appendChild(a.firstChild);o.insertNode(s),c&&((o=o.cloneRange()).setStartAfter(c),o.collapse(!0),e.selection.selectRange(t,o)),p=!0}return t.execCommand.callListeners&&t.execCommand.callListeners(d,p),p},execFormatBlock:function(t,i){var n=r.getTopBlockContainer(e.selection.getSelectionStart(t));if("blockquote"===i){if(n&&Array.prototype.slice.call(n.childNodes).some((function(e){return r.isBlockContainer(e)})))return t.execCommand("outdent",!1,null);if(r.isIE)return t.execCommand("indent",!1,i)}if(n&&i===n.nodeName.toLowerCase()&&(i="p"),r.isIE&&(i="<"+i+">"),n&&"blockquote"===n.nodeName.toLowerCase()){if(r.isIE&&"<p>"===i)return t.execCommand("outdent",!1,i);if((r.isFF||r.isEdge)&&"p"===i)return Array.prototype.slice.call(n.childNodes).some((function(e){return!r.isBlockContainer(e)}))&&t.execCommand("formatBlock",!1,i),t.execCommand("outdent",!1,i)}return t.execCommand("formatBlock",!1,i)},setTargetBlank:function(e,t){var i,n=t||!1;if("a"===e.nodeName.toLowerCase())e.target="_blank",e.rel="noopener noreferrer";else for(e=e.getElementsByTagName("a"),i=0;i<e.length;i+=1)!1!==n&&n!==e[i].attributes.href.value||(e[i].target="_blank",e[i].rel="noopener noreferrer")},removeTargetBlank:function(e,t){var i;if("a"===e.nodeName.toLowerCase())e.removeAttribute("target"),e.removeAttribute("rel");else for(e=e.getElementsByTagName("a"),i=0;i<e.length;i+=1)t===e[i].attributes.href.value&&(e[i].removeAttribute("target"),e[i].removeAttribute("rel"))},addClassToAnchors:function(e,t){var i,n,o=t.split(" ");if("a"===e.nodeName.toLowerCase())for(n=0;n<o.length;n+=1)e.classList.add(o[n]);else{var a=e.getElementsByTagName("a");if(0===a.length){var s=r.getClosestTag(e,"a");e=s?[s]:[]}else e=a;for(i=0;i<e.length;i+=1)for(n=0;n<o.length;n+=1)e[i].classList.add(o[n])}},isListItem:function(e){if(!e)return!1;if("li"===e.nodeName.toLowerCase())return!0;for(var t=e.parentNode,i=t.nodeName.toLowerCase();"li"===i||!r.isBlockContainer(t)&&"div"!==i;){if("li"===i)return!0;if(!(t=t.parentNode))return!1;i=t.nodeName.toLowerCase()}return!1},cleanListDOM:function(t,i){if("li"===i.nodeName.toLowerCase()){var n=i.parentElement;"p"===n.parentElement.nodeName.toLowerCase()&&(r.unwrap(n.parentElement,t),e.selection.moveCursor(t,i.firstChild,i.firstChild.textContent.length))}},splitOffDOMTree:function(e,t,i){for(var n=t,o=null,a=!i;n!==e;){var r,s=n.parentNode,c=s.cloneNode(!1),l=a?n:s.firstChild;for(o&&(a?c.appendChild(o):r=o),o=c;l;){var p=l.nextSibling;l===n?(l.hasChildNodes()?l=l.cloneNode(!1):l.parentNode.removeChild(l),l.textContent&&o.appendChild(l),l=a?p:null):(l.parentNode.removeChild(l),(l.hasChildNodes()||l.textContent)&&o.appendChild(l),l=p)}r&&o.appendChild(r),n=s}return o},moveTextRangeIntoElement:function(e,t,i){if(!e||!t)return!1;var n=r.findCommonRoot(e,t);if(!n)return!1;if(t===e){var o=e.parentNode,a=e.nextSibling;return o.removeChild(e),i.appendChild(e),a?o.insertBefore(i,a):o.appendChild(i),i.hasChildNodes()}for(var s,c,l,p=[],d=0;d<n.childNodes.length;d++)if(l=n.childNodes[d],s){if(r.isDescendant(l,t,!0)){c=l;break}p.push(l)}else r.isDescendant(l,e,!0)&&(s=l);var u=c.nextSibling,h=n.ownerDocument.createDocumentFragment();return s===e?(s.parentNode.removeChild(s),h.appendChild(s)):h.appendChild(r.splitOffDOMTree(s,e)),p.forEach((function(e){e.parentNode.removeChild(e),h.appendChild(e)})),c===t?(c.parentNode.removeChild(c),h.appendChild(c)):h.appendChild(r.splitOffDOMTree(c,t,!0)),i.appendChild(h),c.parentNode===n?n.insertBefore(i,c):u?n.insertBefore(i,u):n.appendChild(i),i.hasChildNodes()},depthOfNode:function(e){for(var t=0,i=e;null!==i.parentNode;)i=i.parentNode,t++;return t},findCommonRoot:function(e,t){for(var i=r.depthOfNode(e),n=r.depthOfNode(t),o=e,a=t;i!==n;)i>n?(o=o.parentNode,i-=1):(a=a.parentNode,n-=1);for(;o!==a;)o=o.parentNode,a=a.parentNode;return o},isElementAtBeginningOfBlock:function(e){for(var t;!r.isBlockContainer(e)&&!r.isMediumEditorElement(e);){for(t=e;t=t.previousSibling;)if((3===t.nodeType?t.nodeValue:t.textContent).length>0)return!1;e=e.parentNode}return!0},isMediumEditorElement:function(e){return e&&e.getAttribute&&!!e.getAttribute("data-medium-editor-element")},getContainerEditorElement:function(e){return r.traverseUp(e,(function(e){return r.isMediumEditorElement(e)}))},isBlockContainer:function(e){return e&&3!==e.nodeType&&-1!==r.blockContainerElementNames.indexOf(e.nodeName.toLowerCase())},getClosestBlockContainer:function(e){return r.traverseUp(e,(function(e){return r.isBlockContainer(e)||r.isMediumEditorElement(e)}))},getTopBlockContainer:function(e){var t=!!r.isBlockContainer(e)&&e;return r.traverseUp(e,(function(e){return r.isBlockContainer(e)&&(t=e),!(t||!r.isMediumEditorElement(e)||(t=e,0))})),t},getFirstSelectableLeafNode:function(e){for(;e&&e.firstChild;)e=e.firstChild;if("table"===(e=r.traverseUp(e,(function(e){return-1===r.emptyElementNames.indexOf(e.nodeName.toLowerCase())}))).nodeName.toLowerCase()){var t=e.querySelector("th, td");t&&(e=t)}return e},getFirstTextNode:function(e){return r.warn("getFirstTextNode is deprecated and will be removed in version 6.0.0"),r._getFirstTextNode(e)},_getFirstTextNode:function(e){if(3===e.nodeType)return e;for(var t=0;t<e.childNodes.length;t++){var i=r._getFirstTextNode(e.childNodes[t]);if(null!==i)return i}return null},ensureUrlHasProtocol:function(e){return-1===e.indexOf("://")?"http://"+e:e},warn:function(){void 0!==t.console&&"function"==typeof t.console.warn&&t.console.warn.apply(t.console,arguments)},deprecated:function(e,t,i){var n=e+" is deprecated, please use "+t+" instead.";i&&(n+=" Will be removed in "+i),r.warn(n)},deprecatedMethod:function(e,t,i,n){r.deprecated(e,t,n),"function"==typeof this[t]&&this[t].apply(this,i)},cleanupAttrs:function(e,t){t.forEach((function(t){e.removeAttribute(t)}))},cleanupTags:function(e,t){-1!==t.indexOf(e.nodeName.toLowerCase())&&e.parentNode.removeChild(e)},unwrapTags:function(t,i){-1!==i.indexOf(t.nodeName.toLowerCase())&&e.util.unwrap(t,document)},getClosestTag:function(e,t){return r.traverseUp(e,(function(e){return e.nodeName.toLowerCase()===t.toLowerCase()}))},unwrap:function(e,t){for(var i=t.createDocumentFragment(),n=Array.prototype.slice.call(e.childNodes),o=0;o<n.length;o++)i.appendChild(n[o]);i.childNodes.length?e.parentNode.replaceChild(i,e):e.parentNode.removeChild(e)},guid:function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}};e.util=r}(window),(t=function(t){e.util.extend(this,t)}).extend=function(t){var i,n=this;i=t&&t.hasOwnProperty("constructor")?t.constructor:function(){return n.apply(this,arguments)},e.util.extend(i,n);var o=function(){this.constructor=i};return o.prototype=n.prototype,i.prototype=new o,t&&e.util.extend(i.prototype,t),i},t.prototype={init:function(){},base:void 0,name:void 0,checkState:void 0,destroy:void 0,queryCommandState:void 0,isActive:void 0,isAlreadyApplied:void 0,setActive:void 0,setInactive:void 0,getInteractionElements:void 0,window:void 0,document:void 0,getEditorElements:function(){return this.base.elements},getEditorId:function(){return this.base.id},getEditorOption:function(e){return this.base.options[e]}},["execAction","on","off","subscribe","trigger"].forEach((function(e){t.prototype[e]=function(){return this.base[e].apply(this.base,arguments)}})),e.Extension=t,function(){function t(t){return e.util.isBlockContainer(t)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}var i={findMatchingSelectionParent:function(t,i){var n,o=i.getSelection();return 0!==o.rangeCount&&(n=o.getRangeAt(0),e.util.traverseUp(n.commonAncestorContainer,t))},getSelectionElement:function(t){return this.findMatchingSelectionParent((function(t){return e.util.isMediumEditorElement(t)}),t)},exportSelection:function(e,t){if(!e)return null;var i=null,n=t.getSelection();if(n.rangeCount>0){var o,a=n.getRangeAt(0),r=a.cloneRange();r.selectNodeContents(e),r.setEnd(a.startContainer,a.startOffset),i={start:o=r.toString().length,end:o+a.toString().length},this.doesRangeStartWithImages(a,t)&&(i.startsWithImage=!0);var s=this.getTrailingImageCount(e,i,a.endContainer,a.endOffset);if(s&&(i.trailingImageCount=s),0!==o){var c=this.getIndexRelativeToAdjacentEmptyBlocks(t,e,a.startContainer,a.startOffset);-1!==c&&(i.emptyBlocksIndex=c)}}return i},importSelection:function(e,t,i,n){if(e&&t){var o=i.createRange();o.setStart(t,0),o.collapse(!0);var a,r=t,s=[],c=0,l=!1,p=!1,d=0,u=!1,h=!1,m=null;for((n||e.startsWithImage||void 0!==e.emptyBlocksIndex)&&(h=!0);!u&&r;)if(r.nodeType>3)r=s.pop();else{if(3!==r.nodeType||p){if(e.trailingImageCount&&p&&("img"===r.nodeName.toLowerCase()&&d++,d===e.trailingImageCount)){for(var b=0;r.parentNode.childNodes[b]!==r;)b++;o.setEnd(r.parentNode,b+1),u=!0}if(!u&&1===r.nodeType)for(var g=r.childNodes.length-1;g>=0;)s.push(r.childNodes[g]),g-=1}else a=c+r.length,!l&&e.start>=c&&e.start<=a&&(h||e.start<a?(o.setStart(r,e.start-c),l=!0):m=r),l&&e.end>=c&&e.end<=a&&(e.trailingImageCount?p=!0:(o.setEnd(r,e.end-c),u=!0)),c=a;u||(r=s.pop())}!l&&m&&(o.setStart(m,m.length),o.setEnd(m,m.length)),void 0!==e.emptyBlocksIndex&&(o=this.importSelectionMoveCursorPastBlocks(i,t,e.emptyBlocksIndex,o)),n&&(o=this.importSelectionMoveCursorPastAnchor(e,o)),this.selectRange(i,o)}},importSelectionMoveCursorPastAnchor:function(t,i){if(t.start===t.end&&3===i.startContainer.nodeType&&i.startOffset===i.startContainer.nodeValue.length&&e.util.traverseUp(i.startContainer,(function(e){return"a"===e.nodeName.toLowerCase()}))){for(var n=i.startContainer,o=i.startContainer.parentNode;null!==o&&"a"!==o.nodeName.toLowerCase();)o.childNodes[o.childNodes.length-1]!==n?o=null:(n=o,o=o.parentNode);if(null!==o&&"a"===o.nodeName.toLowerCase()){for(var a=null,r=0;null===a&&r<o.parentNode.childNodes.length;r++)o.parentNode.childNodes[r]===o&&(a=r);i.setStart(o.parentNode,a+1),i.collapse(!0)}}return i},importSelectionMoveCursorPastBlocks:function(i,n,o,a){var r,s,c=i.createTreeWalker(n,NodeFilter.SHOW_ELEMENT,t,!1),l=a.startContainer,p=0;for(o=o||1,r=3===l.nodeType&&e.util.isBlockContainer(l.previousSibling)?l.previousSibling:e.util.getClosestBlockContainer(l);c.nextNode();)if(s){if(s=c.currentNode,++p===o)break;if(s.textContent.length>0)break}else r===c.currentNode&&(s=c.currentNode);return s||(s=r),a.setStart(e.util.getFirstSelectableLeafNode(s),0),a},getIndexRelativeToAdjacentEmptyBlocks:function(i,n,o,a){if(o.textContent.length>0&&a>0)return-1;var r=o;if(3!==r.nodeType&&(r=o.childNodes[a]),r){if(!e.util.isElementAtBeginningOfBlock(r))return-1;var s=e.util.findPreviousSibling(r);if(!s)return-1;if(s.nodeValue)return-1}for(var c=e.util.getClosestBlockContainer(o),l=i.createTreeWalker(n,NodeFilter.SHOW_ELEMENT,t,!1),p=0;l.nextNode();){var d=""===l.currentNode.textContent;if((d||p>0)&&(p+=1),l.currentNode===c)return p;d||(p=0)}return p},doesRangeStartWithImages:function(e,t){if(0!==e.startOffset||1!==e.startContainer.nodeType)return!1;if("img"===e.startContainer.nodeName.toLowerCase())return!0;var i=e.startContainer.querySelector("img");if(!i)return!1;for(var n=t.createTreeWalker(e.startContainer,NodeFilter.SHOW_ALL,null,!1);n.nextNode();){var o=n.currentNode;if(o===i)break;if(o.nodeValue)return!1}return!0},getTrailingImageCount:function(e,t,i,n){if(0===n||1!==i.nodeType)return 0;if("img"!==i.nodeName.toLowerCase()&&!i.querySelector("img"))return 0;for(var o=i.childNodes[n-1];o.hasChildNodes();)o=o.lastChild;for(var a,r=e,s=[],c=0,l=!1,p=!1,d=!1,u=0;!d&&r;)if(r.nodeType>3)r=s.pop();else{if(3!==r.nodeType||p){if("img"===r.nodeName.toLowerCase()&&u++,r===o)d=!0;else if(1===r.nodeType)for(var h=r.childNodes.length-1;h>=0;)s.push(r.childNodes[h]),h-=1}else u=0,a=c+r.length,!l&&t.start>=c&&t.start<=a&&(l=!0),l&&t.end>=c&&t.end<=a&&(p=!0),c=a;d||(r=s.pop())}return u},selectionContainsContent:function(e){var t=e.getSelection();if(!t||t.isCollapsed||!t.rangeCount)return!1;if(""!==t.toString().trim())return!0;var i=this.getSelectedParentElement(t.getRangeAt(0));return!(!i||!("img"===i.nodeName.toLowerCase()||1===i.nodeType&&i.querySelector("img")))},selectionInContentEditableFalse:function(e){var t,i=this.findMatchingSelectionParent((function(e){var i=e&&e.getAttribute("contenteditable");return"true"===i&&(t=!0),"#text"!==e.nodeName&&"false"===i}),e);return!t&&i},getSelectionHtml:function(e){var t,i,n,o="",a=e.getSelection();if(a.rangeCount){for(n=e.createElement("div"),t=0,i=a.rangeCount;i>t;t+=1)n.appendChild(a.getRangeAt(t).cloneContents());o=n.innerHTML}return o},getCaretOffsets:function(e,t){var i,n;return t||(t=window.getSelection().getRangeAt(0)),i=t.cloneRange(),n=t.cloneRange(),i.selectNodeContents(e),i.setEnd(t.endContainer,t.endOffset),n.selectNodeContents(e),n.setStart(t.endContainer,t.endOffset),{left:i.toString().length,right:n.toString().length}},rangeSelectsSingleNode:function(e){var t=e.startContainer;return t===e.endContainer&&t.hasChildNodes()&&e.endOffset===e.startOffset+1},getSelectedParentElement:function(e){return e?this.rangeSelectsSingleNode(e)&&3!==e.startContainer.childNodes[e.startOffset].nodeType?e.startContainer.childNodes[e.startOffset]:3===e.startContainer.nodeType?e.startContainer.parentNode:e.startContainer:null},getSelectedElements:function(e){var t,i,n,o=e.getSelection();if(!o.rangeCount||o.isCollapsed||!o.getRangeAt(0).commonAncestorContainer)return[];if(3===(t=o.getRangeAt(0)).commonAncestorContainer.nodeType){for(i=[],n=t.commonAncestorContainer;n.parentNode&&1===n.parentNode.childNodes.length;)i.push(n.parentNode),n=n.parentNode;return i}return[].filter.call(t.commonAncestorContainer.getElementsByTagName("*"),(function(e){return"function"!=typeof o.containsNode||o.containsNode(e,!0)}))},selectNode:function(e,t){var i=t.createRange();i.selectNodeContents(e),this.selectRange(t,i)},select:function(e,t,i,n,o){var a=e.createRange();return a.setStart(t,i),n?a.setEnd(n,o):a.collapse(!0),this.selectRange(e,a),a},clearSelection:function(e,t){t?e.getSelection().collapseToStart():e.getSelection().collapseToEnd()},moveCursor:function(e,t,i){this.select(e,t,i)},getSelectionRange:function(e){var t=e.getSelection();return 0===t.rangeCount?null:t.getRangeAt(0)},selectRange:function(e,t){var i=e.getSelection();i.removeAllRanges(),i.addRange(t)},getSelectionStart:function(e){var t=e.getSelection().anchorNode;return t&&3===t.nodeType?t.parentNode:t}};e.selection=i}(),function(){function t(t,i){return!!t&&t.some((function(t){if("function"!=typeof t.getInteractionElements)return!1;var n=t.getInteractionElements();return!!n&&(Array.isArray(n)||(n=[n]),n.some((function(t){return e.util.isDescendant(t,i,!0)})))}))}var i=function(e){this.base=e,this.options=this.base.options,this.events=[],this.disabledEvents={},this.customEvents={},this.listeners={}};i.prototype={InputEventOnContenteditableSupported:!e.util.isIE&&!e.util.isEdge,attachDOMEvent:function(t,i,n,o){var a=this.base.options.contentWindow,r=this.base.options.ownerDocument;t=e.util.isElement(t)||[a,r].indexOf(t)>-1?[t]:t,Array.prototype.forEach.call(t,(function(e){e.addEventListener(i,n,o),this.events.push([e,i,n,o])}).bind(this))},detachDOMEvent:function(t,i,n,o){var a,r,s=this.base.options.contentWindow,c=this.base.options.ownerDocument;t&&(t=e.util.isElement(t)||[s,c].indexOf(t)>-1?[t]:t,Array.prototype.forEach.call(t,(function(e){-1!==(a=this.indexOfListener(e,i,n,o))&&(r=this.events.splice(a,1)[0])[0].removeEventListener(r[1],r[2],r[3])}).bind(this)))},indexOfListener:function(e,t,i,n){var o,a,r;for(o=0,a=this.events.length;a>o;o+=1)if((r=this.events[o])[0]===e&&r[1]===t&&r[2]===i&&r[3]===n)return o;return-1},detachAllDOMEvents:function(){for(var e=this.events.pop();e;)e[0].removeEventListener(e[1],e[2],e[3]),e=this.events.pop()},detachAllEventsFromElement:function(e){for(var t=this.events.filter((function(t){return t&&t[0].getAttribute&&t[0].getAttribute("medium-editor-index")===e.getAttribute("medium-editor-index")})),i=0,n=t.length;n>i;i++){var o=t[i];this.detachDOMEvent(o[0],o[1],o[2],o[3])}},attachAllEventsToElement:function(e){this.listeners.editableInput&&(this.contentCache[e.getAttribute("medium-editor-index")]=e.innerHTML),this.eventsCache&&this.eventsCache.forEach((function(t){this.attachDOMEvent(e,t.name,t.handler.bind(this))}),this)},enableCustomEvent:function(e){void 0!==this.disabledEvents[e]&&delete this.disabledEvents[e]},disableCustomEvent:function(e){this.disabledEvents[e]=!0},attachCustomEvent:function(e,t){this.setupListener(e),this.customEvents[e]||(this.customEvents[e]=[]),this.customEvents[e].push(t)},detachCustomEvent:function(e,t){var i=this.indexOfCustomListener(e,t);-1!==i&&this.customEvents[e].splice(i,1)},indexOfCustomListener:function(e,t){return this.customEvents[e]&&this.customEvents[e].length?this.customEvents[e].indexOf(t):-1},detachAllCustomEvents:function(){this.customEvents={}},triggerCustomEvent:function(e,t,i){this.customEvents[e]&&!this.disabledEvents[e]&&this.customEvents[e].forEach((function(e){e(t,i)}))},destroy:function(){this.detachAllDOMEvents(),this.detachAllCustomEvents(),this.detachExecCommand(),this.base.elements&&this.base.elements.forEach((function(e){e.removeAttribute("data-medium-focused")}))},attachToExecCommand:function(){this.execCommandListener||(this.execCommandListener=(function(e){this.handleDocumentExecCommand(e)}).bind(this),this.wrapExecCommand(),this.options.ownerDocument.execCommand.listeners.push(this.execCommandListener))},detachExecCommand:function(){var e=this.options.ownerDocument;if(this.execCommandListener&&e.execCommand.listeners){var t=e.execCommand.listeners.indexOf(this.execCommandListener);-1!==t&&e.execCommand.listeners.splice(t,1),e.execCommand.listeners.length||this.unwrapExecCommand()}},wrapExecCommand:function(){var e=this.options.ownerDocument;if(!e.execCommand.listeners){var t=function(t,i){e.execCommand.listeners&&e.execCommand.listeners.forEach((function(e){e({command:t[0],value:t[2],args:t,result:i})}))},i=function(){var i=e.execCommand.orig.apply(this,arguments);if(!e.execCommand.listeners)return i;var n=Array.prototype.slice.call(arguments);return t(n,i),i};i.orig=e.execCommand,i.listeners=[],i.callListeners=t,e.execCommand=i}},unwrapExecCommand:function(){var e=this.options.ownerDocument;e.execCommand.orig&&(e.execCommand=e.execCommand.orig)},setupListener:function(e){if(!this.listeners[e]){switch(e){case"externalInteraction":this.attachDOMEvent(this.options.ownerDocument.body,"mousedown",this.handleBodyMousedown.bind(this),!0),this.attachDOMEvent(this.options.ownerDocument.body,"click",this.handleBodyClick.bind(this),!0),this.attachDOMEvent(this.options.ownerDocument.body,"focus",this.handleBodyFocus.bind(this),!0);break;case"blur":case"focus":this.setupListener("externalInteraction");break;case"editableInput":this.contentCache={},this.base.elements.forEach((function(e){this.contentCache[e.getAttribute("medium-editor-index")]=e.innerHTML}),this),this.InputEventOnContenteditableSupported&&this.attachToEachElement("input",this.handleInput),this.InputEventOnContenteditableSupported||(this.setupListener("editableKeypress"),this.keypressUpdateInput=!0,this.attachDOMEvent(document,"selectionchange",this.handleDocumentSelectionChange.bind(this)),this.attachToExecCommand());break;case"editableClick":this.attachToEachElement("click",this.handleClick);break;case"editableBlur":this.attachToEachElement("blur",this.handleBlur);break;case"editableKeypress":this.attachToEachElement("keypress",this.handleKeypress);break;case"editableKeyup":this.attachToEachElement("keyup",this.handleKeyup);break;case"editableKeydown":this.attachToEachElement("keydown",this.handleKeydown);break;case"editableKeydownSpace":case"editableKeydownEnter":case"editableKeydownTab":case"editableKeydownDelete":this.setupListener("editableKeydown");break;case"editableMouseover":this.attachToEachElement("mouseover",this.handleMouseover);break;case"editableDrag":this.attachToEachElement("dragover",this.handleDragging),this.attachToEachElement("dragleave",this.handleDragging);break;case"editableDrop":this.attachToEachElement("drop",this.handleDrop);break;case"editablePaste":this.attachToEachElement("paste",this.handlePaste)}this.listeners[e]=!0}},attachToEachElement:function(e,t){this.eventsCache||(this.eventsCache=[]),this.base.elements.forEach((function(i){this.attachDOMEvent(i,e,t.bind(this))}),this),this.eventsCache.push({name:e,handler:t})},cleanupElement:function(e){var t=e.getAttribute("medium-editor-index");t&&(this.detachAllEventsFromElement(e),this.contentCache&&delete this.contentCache[t])},focusElement:function(e){e.focus(),this.updateFocus(e,{target:e,type:"focus"})},updateFocus:function(i,n){var o,a=this.base.getFocusedElement();a&&"click"===n.type&&this.lastMousedownTarget&&(e.util.isDescendant(a,this.lastMousedownTarget,!0)||t(this.base.extensions,this.lastMousedownTarget))&&(o=a),o||this.base.elements.some((function(t){return!o&&e.util.isDescendant(t,i,!0)&&(o=t),!!o}),this);var r=!e.util.isDescendant(a,i,!0)&&!t(this.base.extensions,i);o!==a&&(a&&r&&(a.removeAttribute("data-medium-focused"),this.triggerCustomEvent("blur",n,a)),o&&(o.setAttribute("data-medium-focused",!0),this.triggerCustomEvent("focus",n,o))),r&&this.triggerCustomEvent("externalInteraction",n)},updateInput:function(e,t){if(this.contentCache){var i=e.getAttribute("medium-editor-index"),n=e.innerHTML;n!==this.contentCache[i]&&this.triggerCustomEvent("editableInput",t,e),this.contentCache[i]=n}},handleDocumentSelectionChange:function(t){if(t.currentTarget&&t.currentTarget.activeElement){var i,n=t.currentTarget.activeElement;this.base.elements.some((function(t){return!!e.util.isDescendant(t,n,!0)&&(i=t,!0)}),this),i&&this.updateInput(i,{target:n,currentTarget:i})}},handleDocumentExecCommand:function(){var e=this.base.getFocusedElement();e&&this.updateInput(e,{target:e,currentTarget:e})},handleBodyClick:function(e){this.updateFocus(e.target,e)},handleBodyFocus:function(e){this.updateFocus(e.target,e)},handleBodyMousedown:function(e){this.lastMousedownTarget=e.target},handleInput:function(e){this.updateInput(e.currentTarget,e)},handleClick:function(e){this.triggerCustomEvent("editableClick",e,e.currentTarget)},handleBlur:function(e){this.triggerCustomEvent("editableBlur",e,e.currentTarget)},handleKeypress:function(e){if(this.triggerCustomEvent("editableKeypress",e,e.currentTarget),this.keypressUpdateInput){var t={target:e.target,currentTarget:e.currentTarget};setTimeout((function(){this.updateInput(t.currentTarget,t)}).bind(this),0)}},handleKeyup:function(e){this.triggerCustomEvent("editableKeyup",e,e.currentTarget)},handleMouseover:function(e){this.triggerCustomEvent("editableMouseover",e,e.currentTarget)},handleDragging:function(e){this.triggerCustomEvent("editableDrag",e,e.currentTarget)},handleDrop:function(e){this.triggerCustomEvent("editableDrop",e,e.currentTarget)},handlePaste:function(e){this.triggerCustomEvent("editablePaste",e,e.currentTarget)},handleKeydown:function(t){return this.triggerCustomEvent("editableKeydown",t,t.currentTarget),e.util.isKey(t,e.util.keyCode.SPACE)?this.triggerCustomEvent("editableKeydownSpace",t,t.currentTarget):e.util.isKey(t,e.util.keyCode.ENTER)||t.ctrlKey&&e.util.isKey(t,e.util.keyCode.M)?this.triggerCustomEvent("editableKeydownEnter",t,t.currentTarget):e.util.isKey(t,e.util.keyCode.TAB)?this.triggerCustomEvent("editableKeydownTab",t,t.currentTarget):e.util.isKey(t,[e.util.keyCode.DELETE,e.util.keyCode.BACKSPACE])?this.triggerCustomEvent("editableKeydownDelete",t,t.currentTarget):void 0}},e.Events=i}(),function(){var t=e.Extension.extend({action:void 0,aria:void 0,tagNames:void 0,style:void 0,useQueryState:void 0,contentDefault:void 0,contentFA:void 0,classList:void 0,attrs:void 0,constructor:function(i){t.isBuiltInButton(i)?e.Extension.call(this,this.defaults[i]):e.Extension.call(this,i)},init:function(){e.Extension.prototype.init.apply(this,arguments),this.button=this.createButton(),this.on(this.button,"click",this.handleClick.bind(this))},getButton:function(){return this.button},getAction:function(){return"function"==typeof this.action?this.action(this.base.options):this.action},getAria:function(){return"function"==typeof this.aria?this.aria(this.base.options):this.aria},getTagNames:function(){return"function"==typeof this.tagNames?this.tagNames(this.base.options):this.tagNames},createButton:function(){var e=this.document.createElement("button"),t=this.contentDefault,i=this.getAria(),n=this.getEditorOption("buttonLabels");return e.classList.add("medium-editor-action"),e.classList.add("medium-editor-action-"+this.name),this.classList&&this.classList.forEach((function(t){e.classList.add(t)})),e.setAttribute("data-action",this.getAction()),i&&(e.setAttribute("title",i),e.setAttribute("aria-label",i)),this.attrs&&Object.keys(this.attrs).forEach((function(t){e.setAttribute(t,this.attrs[t])}),this),"fontawesome"===n&&this.contentFA&&(t=this.contentFA),e.innerHTML=t,e},handleClick:function(e){e.preventDefault(),e.stopPropagation();var t=this.getAction();t&&this.execAction(t)},isActive:function(){return this.button.classList.contains(this.getEditorOption("activeButtonClass"))},setInactive:function(){this.button.classList.remove(this.getEditorOption("activeButtonClass")),delete this.knownState},setActive:function(){this.button.classList.add(this.getEditorOption("activeButtonClass")),delete this.knownState},queryCommandState:function(){var e=null;return this.useQueryState&&(e=this.base.queryCommandState(this.getAction())),e},isAlreadyApplied:function(e){var t,i,n=!1,o=this.getTagNames();return!1===this.knownState||!0===this.knownState?this.knownState:(o&&o.length>0&&(n=-1!==o.indexOf(e.nodeName.toLowerCase())),!n&&this.style&&(t=this.style.value.split("|"),i=this.window.getComputedStyle(e,null).getPropertyValue(this.style.prop),t.forEach((function(e){this.knownState||((n=-1!==i.indexOf(e))||"text-decoration"!==this.style.prop)&&(this.knownState=n)}),this)),n)}});t.isBuiltInButton=function(t){return"string"==typeof t&&e.extensions.button.prototype.defaults.hasOwnProperty(t)},e.extensions.button=t}(),e.extensions.button.prototype.defaults={bold:{name:"bold",action:"bold",aria:"bold",tagNames:["b","strong"],style:{prop:"font-weight",value:"700|bold"},useQueryState:!0,contentDefault:"<b>B</b>",contentFA:'<i class="fa fa-bold"></i>'},italic:{name:"italic",action:"italic",aria:"italic",tagNames:["i","em"],style:{prop:"font-style",value:"italic"},useQueryState:!0,contentDefault:"<b><i>I</i></b>",contentFA:'<i class="fa fa-italic"></i>'},underline:{name:"underline",action:"underline",aria:"underline",tagNames:["u"],style:{prop:"text-decoration",value:"underline"},useQueryState:!0,contentDefault:"<b><u>U</u></b>",contentFA:'<i class="fa fa-underline"></i>'},strikethrough:{name:"strikethrough",action:"strikethrough",aria:"strike through",tagNames:["strike"],style:{prop:"text-decoration",value:"line-through"},useQueryState:!0,contentDefault:"<s>A</s>",contentFA:'<i class="fa fa-strikethrough"></i>'},superscript:{name:"superscript",action:"superscript",aria:"superscript",tagNames:["sup"],contentDefault:"<b>x<sup>1</sup></b>",contentFA:'<i class="fa fa-superscript"></i>'},subscript:{name:"subscript",action:"subscript",aria:"subscript",tagNames:["sub"],contentDefault:"<b>x<sub>1</sub></b>",contentFA:'<i class="fa fa-subscript"></i>'},image:{name:"image",action:"image",aria:"image",tagNames:["img"],contentDefault:"<b>image</b>",contentFA:'<i class="fa fa-picture-o"></i>'},html:{name:"html",action:"html",aria:"evaluate html",tagNames:["iframe","object"],contentDefault:"<b>html</b>",contentFA:'<i class="fa fa-code"></i>'},orderedlist:{name:"orderedlist",action:"insertorderedlist",aria:"ordered list",tagNames:["ol"],useQueryState:!0,contentDefault:"<b>1.</b>",contentFA:'<i class="fa fa-list-ol"></i>'},unorderedlist:{name:"unorderedlist",action:"insertunorderedlist",aria:"unordered list",tagNames:["ul"],useQueryState:!0,contentDefault:"<b>&bull;</b>",contentFA:'<i class="fa fa-list-ul"></i>'},indent:{name:"indent",action:"indent",aria:"indent",tagNames:[],contentDefault:"<b>&rarr;</b>",contentFA:'<i class="fa fa-indent"></i>'},outdent:{name:"outdent",action:"outdent",aria:"outdent",tagNames:[],contentDefault:"<b>&larr;</b>",contentFA:'<i class="fa fa-outdent"></i>'},justifyCenter:{name:"justifyCenter",action:"justifyCenter",aria:"center justify",tagNames:[],style:{prop:"text-align",value:"center"},contentDefault:"<b>C</b>",contentFA:'<i class="fa fa-align-center"></i>'},justifyFull:{name:"justifyFull",action:"justifyFull",aria:"full justify",tagNames:[],style:{prop:"text-align",value:"justify"},contentDefault:"<b>J</b>",contentFA:'<i class="fa fa-align-justify"></i>'},justifyLeft:{name:"justifyLeft",action:"justifyLeft",aria:"left justify",tagNames:[],style:{prop:"text-align",value:"left"},contentDefault:"<b>L</b>",contentFA:'<i class="fa fa-align-left"></i>'},justifyRight:{name:"justifyRight",action:"justifyRight",aria:"right justify",tagNames:[],style:{prop:"text-align",value:"right"},contentDefault:"<b>R</b>",contentFA:'<i class="fa fa-align-right"></i>'},removeFormat:{name:"removeFormat",aria:"remove formatting",action:"removeFormat",contentDefault:"<b>X</b>",contentFA:'<i class="fa fa-eraser"></i>'},quote:{name:"quote",action:"append-blockquote",aria:"blockquote",tagNames:["blockquote"],contentDefault:"<b>&ldquo;</b>",contentFA:'<i class="fa fa-quote-right"></i>'},pre:{name:"pre",action:"append-pre",aria:"preformatted text",tagNames:["pre"],contentDefault:"<b>0101</b>",contentFA:'<i class="fa fa-code fa-lg"></i>'},h1:{name:"h1",action:"append-h1",aria:"header type one",tagNames:["h1"],contentDefault:"<b>H1</b>",contentFA:'<i class="fa fa-header"><sup>1</sup>'},h2:{name:"h2",action:"append-h2",aria:"header type two",tagNames:["h2"],contentDefault:"<b>H2</b>",contentFA:'<i class="fa fa-header"><sup>2</sup>'},h3:{name:"h3",action:"append-h3",aria:"header type three",tagNames:["h3"],contentDefault:"<b>H3</b>",contentFA:'<i class="fa fa-header"><sup>3</sup>'},h4:{name:"h4",action:"append-h4",aria:"header type four",tagNames:["h4"],contentDefault:"<b>H4</b>",contentFA:'<i class="fa fa-header"><sup>4</sup>'},h5:{name:"h5",action:"append-h5",aria:"header type five",tagNames:["h5"],contentDefault:"<b>H5</b>",contentFA:'<i class="fa fa-header"><sup>5</sup>'},h6:{name:"h6",action:"append-h6",aria:"header type six",tagNames:["h6"],contentDefault:"<b>H6</b>",contentFA:'<i class="fa fa-header"><sup>6</sup>'}},function(){var t=e.extensions.button.extend({init:function(){e.extensions.button.prototype.init.apply(this,arguments)},formSaveLabel:"&#10003;",formCloseLabel:"&times;",activeClass:"medium-editor-toolbar-form-active",hasForm:!0,getForm:function(){},isDisplayed:function(){return!!this.hasForm&&this.getForm().classList.contains(this.activeClass)},showForm:function(){this.hasForm&&this.getForm().classList.add(this.activeClass)},hideForm:function(){this.hasForm&&this.getForm().classList.remove(this.activeClass)},showToolbarDefaultActions:function(){var e=this.base.getExtensionByName("toolbar");e&&e.showToolbarDefaultActions()},hideToolbarDefaultActions:function(){var e=this.base.getExtensionByName("toolbar");e&&e.hideToolbarDefaultActions()},setToolbarPosition:function(){var e=this.base.getExtensionByName("toolbar");e&&e.setToolbarPosition()}});e.extensions.form=t}(),function(){var t=e.extensions.form.extend({customClassOption:null,customClassOptionText:"Button",linkValidation:!1,placeholderText:"Paste or type a link",targetCheckbox:!1,targetCheckboxText:"Open in new window",name:"anchor",action:"createLink",aria:"link",tagNames:["a"],contentDefault:"<b>#</b>",contentFA:'<i class="fa fa-link"></i>',init:function(){e.extensions.form.prototype.init.apply(this,arguments),this.subscribe("editableKeydown",this.handleKeydown.bind(this))},handleClick:function(t){t.preventDefault(),t.stopPropagation();var i=e.selection.getSelectionRange(this.document);return"a"===i.startContainer.nodeName.toLowerCase()||"a"===i.endContainer.nodeName.toLowerCase()||e.util.getClosestTag(e.selection.getSelectedParentElement(i),"a")?this.execAction("unlink"):(this.isDisplayed()||this.showForm(),!1)},handleKeydown:function(t){e.util.isKey(t,e.util.keyCode.K)&&e.util.isMetaCtrlKey(t)&&!t.shiftKey&&this.handleClick(t)},getForm:function(){return this.form||(this.form=this.createForm()),this.form},getTemplate:function(){var e=['<input type="text" class="medium-editor-toolbar-input" placeholder="',this.placeholderText,'">'];return e.push('<a href="#" class="medium-editor-toolbar-save">',"fontawesome"===this.getEditorOption("buttonLabels")?'<i class="fa fa-check"></i>':this.formSaveLabel,"</a>"),e.push('<a href="#" class="medium-editor-toolbar-close">',"fontawesome"===this.getEditorOption("buttonLabels")?'<i class="fa fa-times"></i>':this.formCloseLabel,"</a>"),this.targetCheckbox&&e.push('<div class="medium-editor-toolbar-form-row">','<input type="checkbox" class="medium-editor-toolbar-anchor-target" id="medium-editor-toolbar-anchor-target-field-'+this.getEditorId()+'">','<label for="medium-editor-toolbar-anchor-target-field-'+this.getEditorId()+'">',this.targetCheckboxText,"</label>","</div>"),this.customClassOption&&e.push('<div class="medium-editor-toolbar-form-row">','<input type="checkbox" class="medium-editor-toolbar-anchor-button">',"<label>",this.customClassOptionText,"</label>","</div>"),e.join("")},isDisplayed:function(){return e.extensions.form.prototype.isDisplayed.apply(this)},hideForm:function(){e.extensions.form.prototype.hideForm.apply(this),this.getInput().value=""},showForm:function(t){var i=this.getInput(),n=this.getAnchorTargetCheckbox(),o=this.getAnchorButtonCheckbox();if("string"==typeof(t=t||{value:""})&&(t={value:t}),this.base.saveSelection(),this.hideToolbarDefaultActions(),e.extensions.form.prototype.showForm.apply(this),this.setToolbarPosition(),i.value=t.value,i.focus(),n&&(n.checked="_blank"===t.target),o){var a=t.buttonClass?t.buttonClass.split(" "):[];o.checked=-1!==a.indexOf(this.customClassOption)}},destroy:function(){return!!this.form&&(this.form.parentNode&&this.form.parentNode.removeChild(this.form),void delete this.form)},getFormOpts:function(){var e=this.getAnchorTargetCheckbox(),t=this.getAnchorButtonCheckbox(),i={value:this.getInput().value.trim()};return this.linkValidation&&(i.value=this.checkLinkFormat(i.value)),i.target="_self",e&&e.checked&&(i.target="_blank"),t&&t.checked&&(i.buttonClass=this.customClassOption),i},doFormSave:function(){var e=this.getFormOpts();this.completeFormSave(e)},completeFormSave:function(e){this.base.restoreSelection(),this.execAction(this.action,e),this.base.checkSelection()},ensureEncodedUri:function(e){return e===decodeURI(e)?encodeURI(e):e},ensureEncodedUriComponent:function(e){return e===decodeURIComponent(e)?encodeURIComponent(e):e},ensureEncodedParam:function(e){var t=e.split("="),i=t[1];return t[0]+(void 0===i?"":"="+this.ensureEncodedUriComponent(i))},ensureEncodedQuery:function(e){return e.split("&").map(this.ensureEncodedParam.bind(this)).join("&")},checkLinkFormat:function(e){var t=/^([a-z]+:)?\/\/|^(mailto|tel|maps):|^\#/i.test(e),i="",n=e.match(/^(.*?)(?:\?(.*?))?(?:#(.*))?$/),o=n[1],a=n[2],r=n[3];if(/^\+?\s?\(?(?:\d\s?\-?\)?){3,20}$/.test(e))return"tel:"+e;if(!t){var s=o.split("/")[0];(s.match(/.+(\.|:).+/)||"localhost"===s)&&(i="http://")}return i+this.ensureEncodedUri(o)+(void 0===a?"":"?"+this.ensureEncodedQuery(a))+(void 0===r?"":"#"+r)},doFormCancel:function(){this.base.restoreSelection(),this.base.checkSelection()},attachFormEvents:function(e){var t=e.querySelector(".medium-editor-toolbar-close"),i=e.querySelector(".medium-editor-toolbar-save"),n=e.querySelector(".medium-editor-toolbar-input");this.on(e,"click",this.handleFormClick.bind(this)),this.on(n,"keyup",this.handleTextboxKeyup.bind(this)),this.on(t,"click",this.handleCloseClick.bind(this)),this.on(i,"click",this.handleSaveClick.bind(this),!0)},createForm:function(){var e=this.document.createElement("div");return e.className="medium-editor-toolbar-form",e.id="medium-editor-toolbar-form-anchor-"+this.getEditorId(),e.innerHTML=this.getTemplate(),this.attachFormEvents(e),e},getInput:function(){return this.getForm().querySelector("input.medium-editor-toolbar-input")},getAnchorTargetCheckbox:function(){return this.getForm().querySelector(".medium-editor-toolbar-anchor-target")},getAnchorButtonCheckbox:function(){return this.getForm().querySelector(".medium-editor-toolbar-anchor-button")},handleTextboxKeyup:function(t){return t.keyCode===e.util.keyCode.ENTER?(t.preventDefault(),void this.doFormSave()):void(t.keyCode===e.util.keyCode.ESCAPE&&(t.preventDefault(),this.doFormCancel()))},handleFormClick:function(e){e.stopPropagation()},handleSaveClick:function(e){e.preventDefault(),this.doFormSave()},handleCloseClick:function(e){e.preventDefault(),this.doFormCancel()}});e.extensions.anchor=t}(),function(){var t=e.Extension.extend({name:"anchor-preview",hideDelay:500,previewValueSelector:"a",showWhenToolbarIsVisible:!1,showOnEmptyLinks:!0,init:function(){this.anchorPreview=this.createPreview(),this.getEditorOption("elementsContainer").appendChild(this.anchorPreview),this.attachToEditables()},getInteractionElements:function(){return this.getPreviewElement()},getPreviewElement:function(){return this.anchorPreview},createPreview:function(){var e=this.document.createElement("div");return e.id="medium-editor-anchor-preview-"+this.getEditorId(),e.className="medium-editor-anchor-preview",e.innerHTML=this.getTemplate(),this.on(e,"click",this.handleClick.bind(this)),e},getTemplate:function(){return'<div class="medium-editor-toolbar-anchor-preview" id="medium-editor-toolbar-anchor-preview">    <a class="medium-editor-toolbar-anchor-preview-inner"></a></div>'},destroy:function(){this.anchorPreview&&(this.anchorPreview.parentNode&&this.anchorPreview.parentNode.removeChild(this.anchorPreview),delete this.anchorPreview)},hidePreview:function(){this.anchorPreview&&this.anchorPreview.classList.remove("medium-editor-anchor-preview-active"),this.activeAnchor=null},showPreview:function(e){return!(!this.anchorPreview.classList.contains("medium-editor-anchor-preview-active")&&!e.getAttribute("data-disable-preview"))||(this.previewValueSelector&&(this.anchorPreview.querySelector(this.previewValueSelector).textContent=e.attributes.href.value,this.anchorPreview.querySelector(this.previewValueSelector).href=e.attributes.href.value),this.anchorPreview.classList.add("medium-toolbar-arrow-over"),this.anchorPreview.classList.remove("medium-toolbar-arrow-under"),this.anchorPreview.classList.contains("medium-editor-anchor-preview-active")||this.anchorPreview.classList.add("medium-editor-anchor-preview-active"),this.activeAnchor=e,this.positionPreview(),this.attachPreviewHandlers(),this)},positionPreview:function(e){var t,i,n,o,a,r=this.window.innerWidth,s=this.anchorPreview.offsetHeight,c=(e=e||this.activeAnchor).getBoundingClientRect(),l=this.diffLeft,p=this.diffTop,d=this.getEditorOption("elementsContainer"),u=["absolute","fixed"].indexOf(window.getComputedStyle(d).getPropertyValue("position"))>-1,h={};t=this.anchorPreview.offsetWidth/2;var m=this.base.getExtensionByName("toolbar");m&&(l=m.diffLeft,p=m.diffTop),i=l-t,u?(o=d.getBoundingClientRect(),["top","left"].forEach((function(e){h[e]=c[e]-o[e]})),h.width=c.width,h.height=c.height,c=h,r=o.width,a=d.scrollTop):a=this.window.pageYOffset,n=c.left+c.width/2,a+=s+c.top+c.height-p-this.anchorPreview.offsetHeight,this.anchorPreview.style.top=Math.round(a)+"px",this.anchorPreview.style.right="initial",t>n?(this.anchorPreview.style.left=i+t+"px",this.anchorPreview.style.right="initial"):t>r-n?(this.anchorPreview.style.left="auto",this.anchorPreview.style.right=0):(this.anchorPreview.style.left=i+n+"px",this.anchorPreview.style.right="initial")},attachToEditables:function(){this.subscribe("editableMouseover",this.handleEditableMouseover.bind(this)),this.subscribe("positionedToolbar",this.handlePositionedToolbar.bind(this))},handlePositionedToolbar:function(){this.showWhenToolbarIsVisible||this.hidePreview()},handleClick:function(e){var t=this.base.getExtensionByName("anchor"),i=this.activeAnchor;t&&i&&(e.preventDefault(),this.base.selectElement(this.activeAnchor),this.base.delay((function(){if(i){var e={value:i.attributes.href.value,target:i.getAttribute("target"),buttonClass:i.getAttribute("class")};t.showForm(e),i=null}}).bind(this))),this.hidePreview()},handleAnchorMouseout:function(){this.anchorToPreview=null,this.off(this.activeAnchor,"mouseout",this.instanceHandleAnchorMouseout),this.instanceHandleAnchorMouseout=null},handleEditableMouseover:function(t){var i=e.util.getClosestTag(t.target,"a");if(!1!==i){if(!this.showOnEmptyLinks&&(!/href=["']\S+["']/.test(i.outerHTML)||/href=["']#\S+["']/.test(i.outerHTML)))return!0;var n=this.base.getExtensionByName("toolbar");if(!this.showWhenToolbarIsVisible&&n&&n.isDisplayed&&n.isDisplayed())return!0;this.activeAnchor&&this.activeAnchor!==i&&this.detachPreviewHandlers(),this.anchorToPreview=i,this.instanceHandleAnchorMouseout=this.handleAnchorMouseout.bind(this),this.on(this.anchorToPreview,"mouseout",this.instanceHandleAnchorMouseout),this.base.delay((function(){this.anchorToPreview&&this.showPreview(this.anchorToPreview)}).bind(this))}},handlePreviewMouseover:function(){this.lastOver=(new Date).getTime(),this.hovering=!0},handlePreviewMouseout:function(e){e.relatedTarget&&/anchor-preview/.test(e.relatedTarget.className)||(this.hovering=!1)},updatePreview:function(){if(this.hovering)return!0;(new Date).getTime()-this.lastOver>this.hideDelay&&this.detachPreviewHandlers()},detachPreviewHandlers:function(){clearInterval(this.intervalTimer),this.instanceHandlePreviewMouseover&&(this.off(this.anchorPreview,"mouseover",this.instanceHandlePreviewMouseover),this.off(this.anchorPreview,"mouseout",this.instanceHandlePreviewMouseout),this.activeAnchor&&(this.off(this.activeAnchor,"mouseover",this.instanceHandlePreviewMouseover),this.off(this.activeAnchor,"mouseout",this.instanceHandlePreviewMouseout))),this.hidePreview(),this.hovering=this.instanceHandlePreviewMouseover=this.instanceHandlePreviewMouseout=null},attachPreviewHandlers:function(){this.lastOver=(new Date).getTime(),this.hovering=!0,this.instanceHandlePreviewMouseover=this.handlePreviewMouseover.bind(this),this.instanceHandlePreviewMouseout=this.handlePreviewMouseout.bind(this),this.intervalTimer=setInterval(this.updatePreview.bind(this),200),this.on(this.anchorPreview,"mouseover",this.instanceHandlePreviewMouseover),this.on(this.anchorPreview,"mouseout",this.instanceHandlePreviewMouseout),this.on(this.activeAnchor,"mouseover",this.instanceHandlePreviewMouseover),this.on(this.activeAnchor,"mouseout",this.instanceHandlePreviewMouseout)}});e.extensions.anchorPreview=t}(),function(){function t(t){return!e.util.getClosestTag(t,"a")}var i,n,o;i=[" ","\t","\n","\r","\xa0","\u2000","\u2001","\u2002","\u2003","\u2028","\u2029"],n=new RegExp("^(com|net|org|edu|gov|mil|aero|asia|biz|cat|coop|info|int|jobs|mobi|museum|name|post|pro|tel|travel|xxx|ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cs|cu|cv|cx|cy|cz|dd|de|dj|dk|dm|do|dz|ec|ee|eg|eh|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|ja|sk|sl|sm|sn|so|sr|ss|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|yu|za|zm|zw)$","i"),o=new RegExp("(((?:(https?://|ftps?://|nntp://)|www\\d{0,3}[.]|[a-z0-9.\\-]+[.](com|net|org|edu|gov|mil|aero|asia|biz|cat|coop|info|int|jobs|mobi|museum|name|post|pro|tel|travel|xxx|ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cs|cu|cv|cx|cy|cz|dd|de|dj|dk|dm|do|dz|ec|ee|eg|eh|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|ja|sk|sl|sm|sn|so|sr|ss|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|yu|za|zm|zw)\\/)\\S+(?:[^\\s`!\\[\\]{};:'\".,?\xab\xbb\u201c\u201d\u2018\u2019])))|(([a-z0-9\\-]+\\.)?[a-z0-9\\-]+\\.(com|net|org|edu|gov|mil|aero|asia|biz|cat|coop|info|int|jobs|mobi|museum|name|post|pro|tel|travel|xxx|ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cs|cu|cv|cx|cy|cz|dd|de|dj|dk|dm|do|dz|ec|ee|eg|eh|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|ja|sk|sl|sm|sn|so|sr|ss|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|yu|za|zm|zw))","gi");var a=e.Extension.extend({init:function(){e.Extension.prototype.init.apply(this,arguments),this.disableEventHandling=!1,this.subscribe("editableKeypress",this.onKeypress.bind(this)),this.subscribe("editableBlur",this.onBlur.bind(this)),this.document.execCommand("AutoUrlDetect",!1,!1)},isLastInstance:function(){for(var e=0,t=0;t<this.window._mediumEditors.length;t++){var i=this.window._mediumEditors[t];null!==i&&void 0!==i.getExtensionByName("autoLink")&&e++}return 1===e},destroy:function(){this.document.queryCommandSupported("AutoUrlDetect")&&this.isLastInstance()&&this.document.execCommand("AutoUrlDetect",!1,!0)},onBlur:function(e,t){this.performLinking(t)},onKeypress:function(t){this.disableEventHandling||e.util.isKey(t,[e.util.keyCode.SPACE,e.util.keyCode.ENTER])&&(clearTimeout(this.performLinkingTimeout),this.performLinkingTimeout=setTimeout((function(){try{var e=this.base.exportSelection();this.performLinking(t.target)&&this.base.importSelection(e,!0)}catch(i){window.console&&window.console.error("Failed to perform linking",i),this.disableEventHandling=!0}}).bind(this),0))},performLinking:function(t){var i=e.util.splitByBlockElements(t),n=!1;0===i.length&&(i=[t]);for(var o=0;o<i.length;o++)n=this.removeObsoleteAutoLinkSpans(i[o])||n,n=this.performLinkingWithinElement(i[o])||n;return this.base.events.updateInput(t,{target:t,currentTarget:t}),n},removeObsoleteAutoLinkSpans:function(i){if(!i||3===i.nodeType)return!1;for(var n=i.querySelectorAll('span[data-auto-link="true"]'),o=!1,a=0;a<n.length;a++){var r=n[a].textContent;if(-1===r.indexOf("://")&&(r=e.util.ensureUrlHasProtocol(r)),n[a].getAttribute("data-href")!==r&&t(n[a])){o=!0;var s=r.replace(/\s+$/,"");if(n[a].getAttribute("data-href")===s){var c=e.util.splitOffDOMTree(n[a],this.splitTextBeforeEnd(n[a],r.length-s.length));n[a].parentNode.insertBefore(c,n[a].nextSibling)}else e.util.unwrap(n[a],this.document)}}return o},splitTextBeforeEnd:function(e,t){for(var i=this.document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null,!1),n=!0;n;)n=null!==i.lastChild();for(var o,a,r;t>0&&null!==r;)(a=(o=i.currentNode).nodeValue).length>t?(r=o.splitText(a.length-t),t=0):(r=i.previousNode(),t-=a.length);return r},performLinkingWithinElement:function(t){for(var i=this.findLinkableText(t),n=0;n<i.length;n++){var o=e.util.findOrCreateMatchingTextNodes(this.document,t,i[n]);this.shouldNotLink(o)||this.createAutoLink(o,i[n].href)}return!1},shouldNotLink:function(t){for(var i=!1,n=0;n<t.length&&!1===i;n++)i=!!e.util.traverseUp(t[n],(function(e){return"a"===e.nodeName.toLowerCase()||e.getAttribute&&"true"===e.getAttribute("data-auto-link")}));return i},findLinkableText:function(e){for(var t=e.textContent,a=null,r=[];null!==(a=o.exec(t));){var s=a.index+a[0].length;!(0!==a.index&&-1===i.indexOf(t[a.index-1])||s!==t.length&&-1===i.indexOf(t[s]))&&(-1!==a[0].indexOf("/")||n.test(a[0].split(".").pop().split("?").shift()))&&r.push({href:a[0],start:a.index,end:s})}return r},createAutoLink:function(t,i){i=e.util.ensureUrlHasProtocol(i);var n=e.util.createLink(this.document,t,i,this.getEditorOption("targetBlank")?"_blank":null),o=this.document.createElement("span");for(o.setAttribute("data-auto-link","true"),o.setAttribute("data-href",i),n.insertBefore(o,n.firstChild);n.childNodes.length>1;)o.appendChild(n.childNodes[1])}});e.extensions.autoLink=a}(),function(){function t(t){var n=e.util.getContainerEditorElement(t);Array.prototype.slice.call(n.parentElement.querySelectorAll("."+i)).forEach((function(e){e.classList.remove(i)}))}var i="medium-editor-dragover",n=e.Extension.extend({name:"fileDragging",allowedTypes:["image"],init:function(){e.Extension.prototype.init.apply(this,arguments),this.subscribe("editableDrag",this.handleDrag.bind(this)),this.subscribe("editableDrop",this.handleDrop.bind(this))},handleDrag:function(e){e.preventDefault(),e.dataTransfer.dropEffect="copy";var n=e.target.classList?e.target:e.target.parentElement;t(n),"dragover"===e.type&&n.classList.add(i)},handleDrop:function(e){e.preventDefault(),e.stopPropagation(),this.base.selectElement(e.target);var i=this.base.exportSelection();i.start=i.end,this.base.importSelection(i),e.dataTransfer.files&&Array.prototype.slice.call(e.dataTransfer.files).forEach((function(e){this.isAllowedFile(e)&&e.type.match("image")&&this.insertImageFile(e)}),this),t(e.target)},isAllowedFile:function(e){return this.allowedTypes.some((function(t){return!!e.type.match(t)}))},insertImageFile:function(t){if("function"==typeof FileReader){var i=new FileReader;i.readAsDataURL(t),i.addEventListener("load",(function(t){var i=this.document.createElement("img");i.src=t.target.result,e.util.insertHTMLCommand(this.document,i.outerHTML)}).bind(this))}}});e.extensions.fileDragging=n}(),function(){var t=e.Extension.extend({name:"keyboard-commands",commands:[{command:"bold",key:"B",meta:!0,shift:!1,alt:!1},{command:"italic",key:"I",meta:!0,shift:!1,alt:!1},{command:"underline",key:"U",meta:!0,shift:!1,alt:!1}],init:function(){e.Extension.prototype.init.apply(this,arguments),this.subscribe("editableKeydown",this.handleKeydown.bind(this)),this.keys={},this.commands.forEach((function(e){var t=e.key.charCodeAt(0);this.keys[t]||(this.keys[t]=[]),this.keys[t].push(e)}),this)},handleKeydown:function(t){var i=e.util.getKeyCode(t);if(this.keys[i]){var n=e.util.isMetaCtrlKey(t),o=!!t.shiftKey,a=!!t.altKey;this.keys[i].forEach((function(e){e.meta!==n||e.shift!==o||e.alt!==a&&void 0!==e.alt||(t.preventDefault(),t.stopPropagation(),"function"==typeof e.command?e.command.apply(this):!1!==e.command&&this.execAction(e.command))}),this)}}});e.extensions.keyboardCommands=t}(),function(){var t=e.extensions.form.extend({name:"fontname",action:"fontName",aria:"change font name",contentDefault:"&#xB1;",contentFA:'<i class="fa fa-font"></i>',fonts:["","Arial","Verdana","Times New Roman"],init:function(){e.extensions.form.prototype.init.apply(this,arguments)},handleClick:function(e){if(e.preventDefault(),e.stopPropagation(),!this.isDisplayed()){var t=this.document.queryCommandValue("fontName")+"";this.showForm(t)}return!1},getForm:function(){return this.form||(this.form=this.createForm()),this.form},isDisplayed:function(){return"block"===this.getForm().style.display},hideForm:function(){this.getForm().style.display="none",this.getSelect().value=""},showForm:function(e){var t=this.getSelect();this.base.saveSelection(),this.hideToolbarDefaultActions(),this.getForm().style.display="block",this.setToolbarPosition(),t.value=e||"",t.focus()},destroy:function(){return!!this.form&&(this.form.parentNode&&this.form.parentNode.removeChild(this.form),void delete this.form)},doFormSave:function(){this.base.restoreSelection(),this.base.checkSelection()},doFormCancel:function(){this.base.restoreSelection(),this.clearFontName(),this.base.checkSelection()},createForm:function(){var e,t=this.document,i=t.createElement("div"),n=t.createElement("select"),o=t.createElement("a"),a=t.createElement("a");i.className="medium-editor-toolbar-form",i.id="medium-editor-toolbar-form-fontname-"+this.getEditorId(),this.on(i,"click",this.handleFormClick.bind(this));for(var r=0;r<this.fonts.length;r++)(e=t.createElement("option")).innerHTML=this.fonts[r],e.value=this.fonts[r],n.appendChild(e);return n.className="medium-editor-toolbar-select",i.appendChild(n),this.on(n,"change",this.handleFontChange.bind(this)),a.setAttribute("href","#"),a.className="medium-editor-toobar-save",a.innerHTML="fontawesome"===this.getEditorOption("buttonLabels")?'<i class="fa fa-check"></i>':"&#10003;",i.appendChild(a),this.on(a,"click",this.handleSaveClick.bind(this),!0),o.setAttribute("href","#"),o.className="medium-editor-toobar-close",o.innerHTML="fontawesome"===this.getEditorOption("buttonLabels")?'<i class="fa fa-times"></i>':"&times;",i.appendChild(o),this.on(o,"click",this.handleCloseClick.bind(this)),i},getSelect:function(){return this.getForm().querySelector("select.medium-editor-toolbar-select")},clearFontName:function(){e.selection.getSelectedElements(this.document).forEach((function(e){"font"===e.nodeName.toLowerCase()&&e.hasAttribute("face")&&e.removeAttribute("face")}))},handleFontChange:function(){var e=this.getSelect().value;""===e?this.clearFontName():this.execAction("fontName",{value:e})},handleFormClick:function(e){e.stopPropagation()},handleSaveClick:function(e){e.preventDefault(),this.doFormSave()},handleCloseClick:function(e){e.preventDefault(),this.doFormCancel()}});e.extensions.fontName=t}(),function(){var t=e.extensions.form.extend({name:"fontsize",action:"fontSize",aria:"increase/decrease font size",contentDefault:"&#xB1;",contentFA:'<i class="fa fa-text-height"></i>',init:function(){e.extensions.form.prototype.init.apply(this,arguments)},handleClick:function(e){if(e.preventDefault(),e.stopPropagation(),!this.isDisplayed()){var t=this.document.queryCommandValue("fontSize")+"";this.showForm(t)}return!1},getForm:function(){return this.form||(this.form=this.createForm()),this.form},isDisplayed:function(){return"block"===this.getForm().style.display},hideForm:function(){this.getForm().style.display="none",this.getInput().value=""},showForm:function(e){var t=this.getInput();this.base.saveSelection(),this.hideToolbarDefaultActions(),this.getForm().style.display="block",this.setToolbarPosition(),t.value=e||"",t.focus()},destroy:function(){return!!this.form&&(this.form.parentNode&&this.form.parentNode.removeChild(this.form),void delete this.form)},doFormSave:function(){this.base.restoreSelection(),this.base.checkSelection()},doFormCancel:function(){this.base.restoreSelection(),this.clearFontSize(),this.base.checkSelection()},createForm:function(){var e=this.document,t=e.createElement("div"),i=e.createElement("input"),n=e.createElement("a"),o=e.createElement("a");return t.className="medium-editor-toolbar-form",t.id="medium-editor-toolbar-form-fontsize-"+this.getEditorId(),this.on(t,"click",this.handleFormClick.bind(this)),i.setAttribute("type","range"),i.setAttribute("min","1"),i.setAttribute("max","7"),i.className="medium-editor-toolbar-input",t.appendChild(i),this.on(i,"change",this.handleSliderChange.bind(this)),o.setAttribute("href","#"),o.className="medium-editor-toobar-save",o.innerHTML="fontawesome"===this.getEditorOption("buttonLabels")?'<i class="fa fa-check"></i>':"&#10003;",t.appendChild(o),this.on(o,"click",this.handleSaveClick.bind(this),!0),n.setAttribute("href","#"),n.className="medium-editor-toobar-close",n.innerHTML="fontawesome"===this.getEditorOption("buttonLabels")?'<i class="fa fa-times"></i>':"&times;",t.appendChild(n),this.on(n,"click",this.handleCloseClick.bind(this)),t},getInput:function(){return this.getForm().querySelector("input.medium-editor-toolbar-input")},clearFontSize:function(){e.selection.getSelectedElements(this.document).forEach((function(e){"font"===e.nodeName.toLowerCase()&&e.hasAttribute("size")&&e.removeAttribute("size")}))},handleSliderChange:function(){var e=this.getInput().value;"4"===e?this.clearFontSize():this.execAction("fontSize",{value:e})},handleFormClick:function(e){e.stopPropagation()},handleSaveClick:function(e){e.preventDefault(),this.doFormSave()},handleCloseClick:function(e){e.preventDefault(),this.doFormCancel()}});e.extensions.fontSize=t}(),function(){function t(e,t,i){var n=e.clipboardData||t.clipboardData||i.dataTransfer,o={};if(!n)return o;if(n.getData){var a=n.getData("Text");a&&a.length>0&&(o["text/plain"]=a)}if(n.types)for(var r=0;r<n.types.length;r++){var s=n.types[r];o[s]=n.getData(s)}return o}var i="%ME_PASTEBIN%",n=null,o=null,a=function(e){e.stopPropagation()},r=e.Extension.extend({forcePlainText:!0,cleanPastedHTML:!1,preCleanReplacements:[],cleanReplacements:[],cleanAttrs:["class","style","dir"],cleanTags:["meta"],unwrapTags:[],init:function(){e.Extension.prototype.init.apply(this,arguments),(this.forcePlainText||this.cleanPastedHTML)&&(this.subscribe("editableKeydown",this.handleKeydown.bind(this)),this.getEditorElements().forEach((function(e){this.on(e,"paste",this.handlePaste.bind(this))}),this),this.subscribe("addElement",this.handleAddElement.bind(this)))},handleAddElement:function(e,t){this.on(t,"paste",this.handlePaste.bind(this))},destroy:function(){(this.forcePlainText||this.cleanPastedHTML)&&this.removePasteBin()},handlePaste:function(e,i){if(!e.defaultPrevented){var n=t(e,this.window,this.document),o=n["text/html"],a=n["text/plain"];this.window.clipboardData&&void 0===e.clipboardData&&!o&&(o=a),(o||a)&&(e.preventDefault(),this.doPaste(o,a,i))}},doPaste:function(t,i,n){var o,a,r="";if(this.cleanPastedHTML&&t)return this.cleanPaste(t);if(i){if(this.getEditorOption("disableReturn")||n&&n.getAttribute("data-disable-return"))r=e.util.htmlEntities(i);else if((o=i.split(/[\r\n]+/g)).length>1)for(a=0;a<o.length;a+=1)""!==o[a]&&(r+="<p>"+e.util.htmlEntities(o[a])+"</p>");else r=e.util.htmlEntities(o[0]);e.util.insertHTMLCommand(this.document,r)}},handlePasteBinPaste:function(e){if(!e.defaultPrevented){var i=t(e,this.window,this.document),n=i["text/html"],a=i["text/plain"],r=o;return!this.cleanPastedHTML||n?(e.preventDefault(),this.removePasteBin(),this.doPaste(n,a,r),void this.trigger("editablePaste",{currentTarget:r,target:r},r)):void setTimeout((function(){this.cleanPastedHTML&&(n=this.getPasteBinHtml()),this.removePasteBin(),this.doPaste(n,a,r),this.trigger("editablePaste",{currentTarget:r,target:r},r)}).bind(this),0)}this.removePasteBin()},handleKeydown:function(t,i){e.util.isKey(t,e.util.keyCode.V)&&e.util.isMetaCtrlKey(t)&&(t.stopImmediatePropagation(),this.removePasteBin(),this.createPasteBin(i))},createPasteBin:function(t){var r,s=e.selection.getSelectionRange(this.document),c=this.window.pageYOffset;o=t,s&&(c+=(r=s.getClientRects()).length?r[0].top:void 0!==s.startContainer.getBoundingClientRect?s.startContainer.getBoundingClientRect().top:s.getBoundingClientRect().top),n=s;var l=this.document.createElement("div");l.id=this.pasteBinId="medium-editor-pastebin-"+ +Date.now(),l.setAttribute("style","border: 1px red solid; position: absolute; top: "+c+"px; width: 10px; height: 10px; overflow: hidden; opacity: 0"),l.setAttribute("contentEditable",!0),l.innerHTML=i,this.document.body.appendChild(l),this.on(l,"focus",a),this.on(l,"focusin",a),this.on(l,"focusout",a),l.focus(),e.selection.selectNode(l,this.document),this.boundHandlePaste||(this.boundHandlePaste=this.handlePasteBinPaste.bind(this)),this.on(l,"paste",this.boundHandlePaste)},removePasteBin:function(){null!==n&&(e.selection.selectRange(this.document,n),n=null),null!==o&&(o=null);var t=this.getPasteBin();t&&t&&(this.off(t,"focus",a),this.off(t,"focusin",a),this.off(t,"focusout",a),this.off(t,"paste",this.boundHandlePaste),t.parentElement.removeChild(t))},getPasteBin:function(){return this.document.getElementById(this.pasteBinId)},getPasteBinHtml:function(){var e=this.getPasteBin();if(!e)return!1;if(e.firstChild&&"mcepastebin"===e.firstChild.id)return!1;var t=e.innerHTML;return!(!t||t===i)&&t},cleanPaste:function(e){var t,i,n,o,a=/<p|<br|<div/.test(e),r=[].concat(this.preCleanReplacements||[],[[new RegExp(/^[\s\S]*<body[^>]*>\s*|\s*<\/body[^>]*>[\s\S]*$/g),""],[new RegExp(/<!--StartFragment-->|<!--EndFragment-->/g),""],[new RegExp(/<br>$/i),""],[new RegExp(/<[^>]*docs-internal-guid[^>]*>/gi),""],[new RegExp(/<\/b>(<br[^>]*>)?$/gi),""],[new RegExp(/<span class="Apple-converted-space">\s+<\/span>/g)," "],[new RegExp(/<br class="Apple-interchange-newline">/g),"<br>"],[new RegExp(/<span[^>]*(font-style:italic;font-weight:(bold|700)|font-weight:(bold|700);font-style:italic)[^>]*>/gi),'<span class="replace-with italic bold">'],[new RegExp(/<span[^>]*font-style:italic[^>]*>/gi),'<span class="replace-with italic">'],[new RegExp(/<span[^>]*font-weight:(bold|700)[^>]*>/gi),'<span class="replace-with bold">'],[new RegExp(/&lt;(\/?)(i|b|a)&gt;/gi),"<$1$2>"],[new RegExp(/&lt;a(?:(?!href).)+href=(?:&quot;|&rdquo;|&ldquo;|"|\u201c|\u201d)(((?!&quot;|&rdquo;|&ldquo;|"|\u201c|\u201d).)*)(?:&quot;|&rdquo;|&ldquo;|"|\u201c|\u201d)(?:(?!&gt;).)*&gt;/gi),'<a href="$1">'],[new RegExp(/<\/p>\n+/gi),"</p>"],[new RegExp(/\n+<p/gi),"<p"],[new RegExp(/<\/?o:[a-z]*>/gi),""],[new RegExp(/<!\[if !supportLists\]>(((?!<!).)*)<!\[endif]\>/gi),"$1"]],this.cleanReplacements||[]);for(t=0;t<r.length;t+=1)e=e.replace(r[t][0],r[t][1]);if(!a)return this.pasteHTML(e);for((n=this.document.createElement("div")).innerHTML="<p>"+e.split("<br><br>").join("</p><p>")+"</p>",i=n.querySelectorAll("a,p,div,br"),t=0;t<i.length;t+=1)switch(o=i[t],o.innerHTML=o.innerHTML.replace(/\n/gi," "),o.nodeName.toLowerCase()){case"p":case"div":this.filterCommonBlocks(o);break;case"br":this.filterLineBreak(o)}this.pasteHTML(n.innerHTML)},pasteHTML:function(t,i){i=e.util.defaults({},i,{cleanAttrs:this.cleanAttrs,cleanTags:this.cleanTags,unwrapTags:this.unwrapTags});var n,o,a,r,s=this.document.createDocumentFragment();for(s.appendChild(this.document.createElement("body")),(r=s.querySelector("body")).innerHTML=t,this.cleanupSpans(r),n=r.querySelectorAll("*"),a=0;a<n.length;a+=1)"a"===(o=n[a]).nodeName.toLowerCase()&&this.getEditorOption("targetBlank")&&e.util.setTargetBlank(o),e.util.cleanupAttrs(o,i.cleanAttrs),e.util.cleanupTags(o,i.cleanTags),e.util.unwrapTags(o,i.unwrapTags);e.util.insertHTMLCommand(this.document,r.innerHTML.replace(/&nbsp;/g," "))},isCommonBlock:function(e){return e&&("p"===e.nodeName.toLowerCase()||"div"===e.nodeName.toLowerCase())},filterCommonBlocks:function(e){/^\s*$/.test(e.textContent)&&e.parentNode&&e.parentNode.removeChild(e)},filterLineBreak:function(e){this.isCommonBlock(e.previousElementSibling)?this.removeWithParent(e):!this.isCommonBlock(e.parentNode)||e.parentNode.firstChild!==e&&e.parentNode.lastChild!==e?e.parentNode&&1===e.parentNode.childElementCount&&""===e.parentNode.textContent&&this.removeWithParent(e):this.removeWithParent(e)},removeWithParent:function(e){e&&e.parentNode&&(e.parentNode.parentNode&&1===e.parentNode.childElementCount?e.parentNode.parentNode.removeChild(e.parentNode):e.parentNode.removeChild(e))},cleanupSpans:function(t){var i,n,o,a=t.querySelectorAll(".replace-with"),r=function(e){return e&&"#text"!==e.nodeName&&"false"===e.getAttribute("contenteditable")};for(i=0;i<a.length;i+=1)(o=this.document.createElement((n=a[i]).classList.contains("bold")?"b":"i")).innerHTML=n.classList.contains("bold")&&n.classList.contains("italic")?"<i>"+n.innerHTML+"</i>":n.innerHTML,n.parentNode.replaceChild(o,n);for(a=t.querySelectorAll("span"),i=0;i<a.length;i+=1){if(e.util.traverseUp(n=a[i],r))return!1;e.util.unwrap(n,this.document)}}});e.extensions.paste=r}(),function(){var t=e.Extension.extend({name:"placeholder",text:"Type your text",hideOnClick:!0,init:function(){e.Extension.prototype.init.apply(this,arguments),this.initPlaceholders(),this.attachEventHandlers()},initPlaceholders:function(){this.getEditorElements().forEach(this.initElement,this)},handleAddElement:function(e,t){this.initElement(t)},initElement:function(e){e.getAttribute("data-placeholder")||e.setAttribute("data-placeholder",this.text),this.updatePlaceholder(e)},destroy:function(){this.getEditorElements().forEach(this.cleanupElement,this)},handleRemoveElement:function(e,t){this.cleanupElement(t)},cleanupElement:function(e){e.getAttribute("data-placeholder")===this.text&&e.removeAttribute("data-placeholder")},showPlaceholder:function(t){t&&(e.util.isFF&&0===t.childNodes.length?(t.classList.add("medium-editor-placeholder-relative"),t.classList.remove("medium-editor-placeholder")):(t.classList.add("medium-editor-placeholder"),t.classList.remove("medium-editor-placeholder-relative")))},hidePlaceholder:function(e){e&&(e.classList.remove("medium-editor-placeholder"),e.classList.remove("medium-editor-placeholder-relative"))},updatePlaceholder:function(e,t){return e.querySelector("img, blockquote, ul, ol, table")||""!==e.textContent.replace(/^\s+|\s+$/g,"")?this.hidePlaceholder(e):void(t||this.showPlaceholder(e))},attachEventHandlers:function(){this.hideOnClick&&this.subscribe("focus",this.handleFocus.bind(this)),this.subscribe("editableInput",this.handleInput.bind(this)),this.subscribe("blur",this.handleBlur.bind(this)),this.subscribe("addElement",this.handleAddElement.bind(this)),this.subscribe("removeElement",this.handleRemoveElement.bind(this))},handleInput:function(e,t){var i=this.hideOnClick&&t===this.base.getFocusedElement();this.updatePlaceholder(t,i)},handleFocus:function(e,t){this.hidePlaceholder(t)},handleBlur:function(e,t){this.updatePlaceholder(t)}});e.extensions.placeholder=t}(),function(){var t=e.Extension.extend({name:"toolbar",align:"center",allowMultiParagraphSelection:!0,buttons:["bold","italic","underline","anchor","h2","h3","quote"],diffLeft:0,diffTop:-10,firstButtonClass:"medium-editor-button-first",lastButtonClass:"medium-editor-button-last",standardizeSelectionStart:!1,static:!1,sticky:!1,stickyTopOffset:0,updateOnEmptySelection:!1,relativeContainer:null,init:function(){e.Extension.prototype.init.apply(this,arguments),this.initThrottledMethods(),this.relativeContainer?this.relativeContainer.appendChild(this.getToolbarElement()):this.getEditorOption("elementsContainer").appendChild(this.getToolbarElement())},forEachExtension:function(e,t){return this.base.extensions.forEach((function(i){return i!==this?e.apply(t||this,arguments):void 0}),this)},createToolbar:function(){var e=this.document.createElement("div");return e.id="medium-editor-toolbar-"+this.getEditorId(),e.className="medium-editor-toolbar",e.className+=this.static?" static-toolbar":this.relativeContainer?" medium-editor-relative-toolbar":" medium-editor-stalker-toolbar",e.appendChild(this.createToolbarButtons()),this.forEachExtension((function(t){t.hasForm&&e.appendChild(t.getForm())})),this.attachEventHandlers(),e},createToolbarButtons:function(){var t,i,n,o,a,r,s=this.document.createElement("ul");return s.id="medium-editor-toolbar-actions"+this.getEditorId(),s.className="medium-editor-toolbar-actions",s.style.display="block",this.buttons.forEach((function(n){"string"==typeof n?(a=n,r=null):(a=n.name,r=n),(o=this.base.addBuiltInExtension(a,r))&&"function"==typeof o.getButton&&(i=o.getButton(this.base),t=this.document.createElement("li"),e.util.isElement(i)?t.appendChild(i):t.innerHTML=i,s.appendChild(t))}),this),(n=s.querySelectorAll("button")).length>0&&(n[0].classList.add(this.firstButtonClass),n[n.length-1].classList.add(this.lastButtonClass)),s},destroy:function(){this.toolbar&&(this.toolbar.parentNode&&this.toolbar.parentNode.removeChild(this.toolbar),delete this.toolbar)},getInteractionElements:function(){return this.getToolbarElement()},getToolbarElement:function(){return this.toolbar||(this.toolbar=this.createToolbar()),this.toolbar},getToolbarActionsElement:function(){return this.getToolbarElement().querySelector(".medium-editor-toolbar-actions")},initThrottledMethods:function(){this.throttledPositionToolbar=e.util.throttle((function(){this.base.isActive&&this.positionToolbarIfShown()}).bind(this))},attachEventHandlers:function(){this.subscribe("blur",this.handleBlur.bind(this)),this.subscribe("focus",this.handleFocus.bind(this)),this.subscribe("editableClick",this.handleEditableClick.bind(this)),this.subscribe("editableKeyup",this.handleEditableKeyup.bind(this)),this.on(this.document.documentElement,"mouseup",this.handleDocumentMouseup.bind(this)),this.static&&this.sticky&&this.on(this.window,"scroll",this.handleWindowScroll.bind(this),!0),this.on(this.window,"resize",this.handleWindowResize.bind(this))},handleWindowScroll:function(){this.positionToolbarIfShown()},handleWindowResize:function(){this.throttledPositionToolbar()},handleDocumentMouseup:function(t){return!(t&&t.target&&e.util.isDescendant(this.getToolbarElement(),t.target))&&void this.checkState()},handleEditableClick:function(){setTimeout((function(){this.checkState()}).bind(this),0)},handleEditableKeyup:function(){this.checkState()},handleBlur:function(){clearTimeout(this.hideTimeout),clearTimeout(this.delayShowTimeout),this.hideTimeout=setTimeout((function(){this.hideToolbar()}).bind(this),1)},handleFocus:function(){this.checkState()},isDisplayed:function(){return this.getToolbarElement().classList.contains("medium-editor-toolbar-active")},showToolbar:function(){clearTimeout(this.hideTimeout),this.isDisplayed()||(this.getToolbarElement().classList.add("medium-editor-toolbar-active"),this.trigger("showToolbar",{},this.base.getFocusedElement()))},hideToolbar:function(){this.isDisplayed()&&(this.getToolbarElement().classList.remove("medium-editor-toolbar-active"),this.trigger("hideToolbar",{},this.base.getFocusedElement()))},isToolbarDefaultActionsDisplayed:function(){return"block"===this.getToolbarActionsElement().style.display},hideToolbarDefaultActions:function(){this.isToolbarDefaultActionsDisplayed()&&(this.getToolbarActionsElement().style.display="none")},showToolbarDefaultActions:function(){this.hideExtensionForms(),this.isToolbarDefaultActionsDisplayed()||(this.getToolbarActionsElement().style.display="block"),this.delayShowTimeout=this.base.delay((function(){this.showToolbar()}).bind(this))},hideExtensionForms:function(){this.forEachExtension((function(e){e.hasForm&&e.isDisplayed()&&e.hideForm()}))},multipleBlockElementsSelected:function(){var t=new RegExp("<("+e.util.blockContainerElementNames.join("|")+")[^>]*>","g"),i=e.selection.getSelectionHtml(this.document).replace(/<[^\/>][^>]*><\/[^>]+>/gim,"").match(t);return!!i&&i.length>1},modifySelection:function(){var t=this.window.getSelection().getRangeAt(0);if(this.standardizeSelectionStart&&t.startContainer.nodeValue&&t.startOffset===t.startContainer.nodeValue.length){var i=e.util.findAdjacentTextNodeWithContent(e.selection.getSelectionElement(this.window),t.startContainer,this.document);if(i){for(var n=0;0===i.nodeValue.substr(n,1).trim().length;)n+=1;t=e.selection.select(this.document,i,n,t.endContainer,t.endOffset)}}},checkState:function(){if(!this.base.preventSelectionUpdates){if(!this.base.getFocusedElement()||e.selection.selectionInContentEditableFalse(this.window))return this.hideToolbar();var t=e.selection.getSelectionElement(this.window);return!t||-1===this.getEditorElements().indexOf(t)||t.getAttribute("data-disable-toolbar")?this.hideToolbar():this.updateOnEmptySelection&&this.static?this.showAndUpdateToolbar():!e.selection.selectionContainsContent(this.document)||!1===this.allowMultiParagraphSelection&&this.multipleBlockElementsSelected()?this.hideToolbar():void this.showAndUpdateToolbar()}},showAndUpdateToolbar:function(){this.modifySelection(),this.setToolbarButtonStates(),this.trigger("positionToolbar",{},this.base.getFocusedElement()),this.showToolbarDefaultActions(),this.setToolbarPosition()},setToolbarButtonStates:function(){this.forEachExtension((function(e){"function"==typeof e.isActive&&"function"==typeof e.setInactive&&e.setInactive()})),this.checkActiveButtons()},checkActiveButtons:function(){var t,i=[],n=null,o=e.selection.getSelectionRange(this.document),a=function(e){"function"==typeof e.checkState?e.checkState(t):"function"==typeof e.isActive&&"function"==typeof e.isAlreadyApplied&&"function"==typeof e.setActive&&!e.isActive()&&e.isAlreadyApplied(t)&&e.setActive()};if(o&&(this.forEachExtension((function(e){return"function"==typeof e.queryCommandState&&null!==(n=e.queryCommandState())?void(n&&"function"==typeof e.setActive&&e.setActive()):void i.push(e)})),t=e.selection.getSelectedParentElement(o),this.getEditorElements().some((function(i){return e.util.isDescendant(i,t,!0)}))))for(;t&&(i.forEach(a),!e.util.isMediumEditorElement(t));)t=t.parentNode},positionToolbarIfShown:function(){this.isDisplayed()&&this.setToolbarPosition()},setToolbarPosition:function(){var e=this.base.getFocusedElement(),t=this.window.getSelection();return e?void(!this.static&&t.isCollapsed||(this.showToolbar(),this.relativeContainer||(this.static?this.positionStaticToolbar(e):this.positionToolbar(t)),this.trigger("positionedToolbar",{},this.base.getFocusedElement()))):this},positionStaticToolbar:function(e){this.getToolbarElement().style.left="0";var t,i=this.document.documentElement&&this.document.documentElement.scrollTop||this.document.body.scrollTop,n=this.window.innerWidth,o=this.getToolbarElement(),a=e.getBoundingClientRect(),r=a.top+i,s=a.left+a.width/2,c=o.offsetHeight,l=o.offsetWidth,p=l/2;switch(this.sticky?i>r+e.offsetHeight-c-this.stickyTopOffset?(o.style.top=r+e.offsetHeight-c+"px",o.classList.remove("medium-editor-sticky-toolbar")):i>r-c-this.stickyTopOffset?(o.classList.add("medium-editor-sticky-toolbar"),o.style.top=this.stickyTopOffset+"px"):(o.classList.remove("medium-editor-sticky-toolbar"),o.style.top=r-c+"px"):o.style.top=r-c+"px",this.align){case"left":t=a.left;break;case"right":t=a.right-l;break;case"center":t=s-p}0>t?t=0:t+l>n&&(t=n-Math.ceil(l)-1),o.style.left=t+"px"},positionToolbar:function(e){this.getToolbarElement().style.left="0",this.getToolbarElement().style.right="initial";var t=e.getRangeAt(0),i=t.getBoundingClientRect();(!i||0===i.height&&0===i.width&&t.startContainer===t.endContainer)&&(i=1===t.startContainer.nodeType&&t.startContainer.querySelector("img")?t.startContainer.querySelector("img").getBoundingClientRect():t.startContainer.getBoundingClientRect());var n,o,a=this.window.innerWidth,r=this.getToolbarElement(),s=r.offsetHeight,c=r.offsetWidth/2,l=this.diffLeft-c,p=this.getEditorOption("elementsContainer"),d=["absolute","fixed"].indexOf(window.getComputedStyle(p).getPropertyValue("position"))>-1,u={},h={};d?(o=p.getBoundingClientRect(),["top","left"].forEach((function(e){h[e]=i[e]-o[e]})),h.width=i.width,h.height=i.height,i=h,a=o.width,u.top=p.scrollTop):u.top=this.window.pageYOffset,n=i.left+i.width/2,u.top+=i.top-s,i.top<50?(r.classList.add("medium-toolbar-arrow-over"),r.classList.remove("medium-toolbar-arrow-under"),u.top+=50+i.height-this.diffTop):(r.classList.add("medium-toolbar-arrow-under"),r.classList.remove("medium-toolbar-arrow-over"),u.top+=this.diffTop),c>n?(u.left=l+c,u.right="initial"):c>a-n?(u.left="auto",u.right=0):(u.left=l+n,u.right="initial"),["top","left","right"].forEach((function(e){r.style[e]=u[e]+(isNaN(u[e])?"":"px")}))}});e.extensions.toolbar=t}(),function(){var t=e.Extension.extend({init:function(){e.Extension.prototype.init.apply(this,arguments),this.subscribe("editableDrag",this.handleDrag.bind(this)),this.subscribe("editableDrop",this.handleDrop.bind(this))},handleDrag:function(e){var t="medium-editor-dragover";e.preventDefault(),e.dataTransfer.dropEffect="copy","dragover"===e.type?e.target.classList.add(t):"dragleave"===e.type&&e.target.classList.remove(t)},handleDrop:function(t){t.preventDefault(),t.stopPropagation(),t.dataTransfer.files&&Array.prototype.slice.call(t.dataTransfer.files,0).some((function(t){var i,n;t.type.match("image")&&((i=new FileReader).readAsDataURL(t),n="medium-img-"+ +new Date,e.util.insertHTMLCommand(this.document,'<img class="medium-editor-image-loading" id="'+n+'" />'),i.onload=(function(){var e=this.document.getElementById(n);e&&(e.removeAttribute("id"),e.removeAttribute("class"),e.src=i.result)}).bind(this))}).bind(this)),t.target.classList.remove("medium-editor-dragover")}});e.extensions.imageDragging=t}(),function(){function t(t){var i=e.selection.getSelectionStart(this.options.ownerDocument),n=i.textContent,o=e.selection.getCaretOffsets(i);(void 0===n[o.left-1]||""===n[o.left-1].trim()||void 0!==n[o.left]&&""===n[o.left].trim())&&t.preventDefault()}function i(t,i){if(this.options.disableReturn||i.getAttribute("data-disable-return"))t.preventDefault();else if(this.options.disableDoubleReturn||i.getAttribute("data-disable-double-return")){var n=e.selection.getSelectionStart(this.options.ownerDocument);(n&&""===n.textContent.trim()&&"li"!==n.nodeName.toLowerCase()||n.previousElementSibling&&"br"!==n.previousElementSibling.nodeName.toLowerCase()&&""===n.previousElementSibling.textContent.trim())&&t.preventDefault()}}function n(t){var i=e.selection.getSelectionStart(this.options.ownerDocument);"pre"===(i&&i.nodeName.toLowerCase())&&(t.preventDefault(),e.util.insertHTMLCommand(this.options.ownerDocument,"    ")),e.util.isListItem(i)&&(t.preventDefault(),this.options.ownerDocument.execCommand(t.shiftKey?"outdent":"indent",!1,null))}function o(t){var i,n=e.selection.getSelectionStart(this.options.ownerDocument),o=n.nodeName.toLowerCase(),a=/^(\s+|<br\/?>)?$/i,r=/h\d/i;e.util.isKey(t,[e.util.keyCode.BACKSPACE,e.util.keyCode.ENTER])&&n.previousElementSibling&&r.test(o)&&0===e.selection.getCaretOffsets(n).left?e.util.isKey(t,e.util.keyCode.BACKSPACE)&&a.test(n.previousElementSibling.innerHTML)?(n.previousElementSibling.parentNode.removeChild(n.previousElementSibling),t.preventDefault()):!this.options.disableDoubleReturn&&e.util.isKey(t,e.util.keyCode.ENTER)&&((i=this.options.ownerDocument.createElement("p")).innerHTML="<br>",n.previousElementSibling.parentNode.insertBefore(i,n),t.preventDefault()):e.util.isKey(t,e.util.keyCode.DELETE)&&n.nextElementSibling&&n.previousElementSibling&&!r.test(o)&&a.test(n.innerHTML)&&r.test(n.nextElementSibling.nodeName.toLowerCase())?(e.selection.moveCursor(this.options.ownerDocument,n.nextElementSibling),n.previousElementSibling.parentNode.removeChild(n),t.preventDefault()):e.util.isKey(t,e.util.keyCode.BACKSPACE)&&"li"===o&&a.test(n.innerHTML)&&!n.previousElementSibling&&!n.parentElement.previousElementSibling&&n.nextElementSibling&&"li"===n.nextElementSibling.nodeName.toLowerCase()?((i=this.options.ownerDocument.createElement("p")).innerHTML="<br>",n.parentElement.parentElement.insertBefore(i,n.parentElement),e.selection.moveCursor(this.options.ownerDocument,i),n.parentElement.removeChild(n),t.preventDefault()):e.util.isKey(t,e.util.keyCode.BACKSPACE)&&!1!==e.util.getClosestTag(n,"blockquote")&&0===e.selection.getCaretOffsets(n).left?(t.preventDefault(),e.util.execFormatBlock(this.options.ownerDocument,"p")):e.util.isKey(t,e.util.keyCode.ENTER)&&!1!==e.util.getClosestTag(n,"blockquote")&&0===e.selection.getCaretOffsets(n).right?((i=this.options.ownerDocument.createElement("p")).innerHTML="<br>",n.parentElement.insertBefore(i,n.nextSibling),e.selection.moveCursor(this.options.ownerDocument,i),t.preventDefault()):e.util.isKey(t,e.util.keyCode.BACKSPACE)&&e.util.isMediumEditorElement(n.parentElement)&&!n.previousElementSibling&&n.nextElementSibling&&a.test(n.innerHTML)&&(t.preventDefault(),e.selection.moveCursor(this.options.ownerDocument,n.nextSibling),n.parentElement.removeChild(n))}function a(t){var i=e.selection.getSelectionStart(this.options.ownerDocument);i&&(e.util.isMediumEditorElement(i)&&0===i.children.length&&!e.util.isBlockContainer(i)&&this.options.ownerDocument.execCommand("formatBlock",!1,"p"),!e.util.isKey(t,e.util.keyCode.ENTER)||e.util.isListItem(i)||e.util.isBlockContainer(i)||("a"===i.nodeName.toLowerCase()?this.options.ownerDocument.execCommand("unlink",!1,null):t.shiftKey||t.ctrlKey||this.options.ownerDocument.execCommand("formatBlock",!1,"p")))}function r(e,t){var i=t.parentNode.querySelector('textarea[medium-editor-textarea-id="'+t.getAttribute("medium-editor-textarea-id")+'"]');i&&(i.value=t.innerHTML.trim())}function s(e){e._mediumEditors||(e._mediumEditors=[null]),this.id||(this.id=e._mediumEditors.length),e._mediumEditors[this.id]=this}function c(e){e._mediumEditors&&e._mediumEditors[this.id]&&(e._mediumEditors[this.id]=null)}function l(t,i,n){var o=[];if(t||(t=[]),"string"==typeof t&&(t=i.querySelectorAll(t)),e.util.isElement(t)&&(t=[t]),n)for(var a=0;a<t.length;a++){var r=t[a];!e.util.isElement(r)||r.getAttribute("data-medium-editor-element")||r.getAttribute("medium-editor-textarea-id")||o.push(r)}else o=Array.prototype.slice.apply(t);return o}function p(e){var t=e.parentNode.querySelector('textarea[medium-editor-textarea-id="'+e.getAttribute("medium-editor-textarea-id")+'"]');t&&(t.classList.remove("medium-editor-hidden"),t.removeAttribute("medium-editor-textarea-id")),e.parentNode&&e.parentNode.removeChild(e)}function d(e,t,i){return"function"==typeof(e=function(e,t){return Object.keys(t).forEach((function(i){void 0===e[i]&&(e[i]=t[i])})),e}(e,{window:i.options.contentWindow,document:i.options.ownerDocument,base:i})).init&&e.init(),e.name||(e.name=t),e}function u(){return!this.elements.every((function(e){return!!e.getAttribute("data-disable-toolbar")}))&&!1!==this.options.toolbar}function h(){return!!u.call(this)&&!1!==this.options.anchorPreview}function m(){return!1!==this.options.placeholder}function b(){return!1!==this.options.autoLink}function g(){return!1!==this.options.imageDragging}function f(){return!1!==this.options.keyboardCommands}function x(){return!this.options.extensions.imageDragging}function y(e){for(var t=this.options.ownerDocument.createElement("div"),i=Date.now(),n="medium-editor-"+i,o=e.attributes;this.options.ownerDocument.getElementById(n);)i++,n="medium-editor-"+i;t.className=e.className,t.id=n,t.innerHTML=e.value,e.setAttribute("medium-editor-textarea-id",n);for(var a=0,r=o.length;r>a;a++)t.hasAttribute(o[a].nodeName)||t.setAttribute(o[a].nodeName,o[a].value);return e.form&&this.on(e.form,"reset",(function(e){e.defaultPrevented||this.resetContent(this.options.ownerDocument.getElementById(n))}).bind(this)),e.classList.add("medium-editor-hidden"),e.parentNode.insertBefore(t,e),t}function v(t,n){if(!t.getAttribute("data-medium-editor-element")){"textarea"===t.nodeName.toLowerCase()&&(t=y.call(this,t),this.instanceHandleEditableInput||(this.instanceHandleEditableInput=r.bind(this),this.subscribe("editableInput",this.instanceHandleEditableInput))),this.options.disableEditing||t.getAttribute("data-disable-editing")||(t.setAttribute("contentEditable",!0),t.setAttribute("spellcheck",this.options.spellcheck)),this.instanceHandleEditableKeydownEnter||(t.getAttribute("data-disable-return")||t.getAttribute("data-disable-double-return"))&&(this.instanceHandleEditableKeydownEnter=i.bind(this),this.subscribe("editableKeydownEnter",this.instanceHandleEditableKeydownEnter)),this.options.disableReturn||t.getAttribute("data-disable-return")||this.on(t,"keyup",a.bind(this));var o=e.util.guid();t.setAttribute("data-medium-editor-element",!0),t.classList.add("medium-editor-element"),t.setAttribute("role","textbox"),t.setAttribute("aria-multiline",!0),t.setAttribute("data-medium-editor-editor-index",n),t.setAttribute("medium-editor-index",o),S[o]=t.innerHTML,this.events.attachAllEventsToElement(t)}return t}function C(){this.subscribe("editableKeydownTab",n.bind(this)),this.subscribe("editableKeydownDelete",o.bind(this)),this.subscribe("editableKeydownEnter",o.bind(this)),this.options.disableExtraSpaces&&this.subscribe("editableKeydownSpace",t.bind(this)),this.instanceHandleEditableKeydownEnter||(this.options.disableReturn||this.options.disableDoubleReturn)&&(this.instanceHandleEditableKeydownEnter=i.bind(this),this.subscribe("editableKeydownEnter",this.instanceHandleEditableKeydownEnter))}function P(){if(this.extensions=[],Object.keys(this.options.extensions).forEach((function(e){"toolbar"!==e&&this.options.extensions[e]&&this.extensions.push(d(this.options.extensions[e],e,this))}),this),x.call(this)){var t=this.options.fileDragging;t||(t={},g.call(this)||(t.allowedTypes=[])),this.addBuiltInExtension("fileDragging",t)}var i={paste:!0,"anchor-preview":h.call(this),autoLink:b.call(this),keyboardCommands:f.call(this),placeholder:m.call(this)};Object.keys(i).forEach((function(e){i[e]&&this.addBuiltInExtension(e)}),this);var n=this.options.extensions.toolbar;if(!n&&u.call(this)){var o=e.util.extend({},this.options.toolbar,{allowMultiParagraphSelection:this.options.allowMultiParagraphSelection});n=new e.extensions.toolbar(o)}n&&this.extensions.push(d(n,"toolbar",this))}function O(t,i){return i&&[["allowMultiParagraphSelection","toolbar.allowMultiParagraphSelection"]].forEach((function(t){i.hasOwnProperty(t[0])&&void 0!==i[t[0]]&&e.util.deprecated(t[0],t[1],"v6.0.0")})),e.util.defaults({},i,t)}function w(t,i){var n;if(n=/^append-(.+)$/gi.exec(t))return e.util.execFormatBlock(this.options.ownerDocument,n[1]);if("fontSize"===t)return i.size&&e.util.deprecated(".size option for fontSize command",".value","6.0.0"),this.options.ownerDocument.execCommand("fontSize",!1,i.value||i.size);if("fontName"===t)return i.name&&e.util.deprecated(".name option for fontName command",".value","6.0.0"),this.options.ownerDocument.execCommand("fontName",!1,i.value||i.name);if("createLink"===t)return this.createLink(i);if("image"===t){var o=this.options.contentWindow.getSelection().toString().trim();return this.options.ownerDocument.execCommand("insertImage",!1,o)}if("html"===t){var a=this.options.contentWindow.getSelection().toString().trim();return e.util.insertHTMLCommand(this.options.ownerDocument,a)}if(/justify([A-Za-z]*)$/g.exec(t)){var r=this.options.ownerDocument.execCommand(t,!1,null),s=e.selection.getSelectedParentElement(e.selection.getSelectionRange(this.options.ownerDocument));return s&&k.call(this,e.util.getTopBlockContainer(s)),r}return this.options.ownerDocument.execCommand(t,!1,i&&i.value)}function k(t){if(t){var i,n=Array.prototype.slice.call(t.childNodes).filter((function(e){var t="div"===e.nodeName.toLowerCase();return t&&!i&&(i=e.style.textAlign),t}));n.length&&(this.saveSelection(),n.forEach((function(t){if(t.style.textAlign===i){var n=t.lastChild;if(n){e.util.unwrap(t,this.options.ownerDocument);var o=this.options.ownerDocument.createElement("BR");n.parentNode.insertBefore(o,n.nextSibling)}}}),this),t.style.textAlign=i,this.restoreSelection())}}var S={};e.prototype={init:function(e,t){return this.options=O.call(this,this.defaults,t),this.origElements=e,this.options.elementsContainer||(this.options.elementsContainer=this.options.ownerDocument.body),this.setup()},setup:function(){this.isActive||(s.call(this,this.options.contentWindow),this.events=new e.Events(this),this.elements=[],this.addElements(this.origElements),0!==this.elements.length&&(this.isActive=!0,P.call(this),C.call(this)))},destroy:function(){this.isActive&&(this.isActive=!1,this.extensions.forEach((function(e){"function"==typeof e.destroy&&e.destroy()}),this),this.events.destroy(),this.elements.forEach((function(e){this.options.spellcheck&&(e.innerHTML=e.innerHTML),e.removeAttribute("contentEditable"),e.removeAttribute("spellcheck"),e.removeAttribute("data-medium-editor-element"),e.classList.remove("medium-editor-element"),e.removeAttribute("role"),e.removeAttribute("aria-multiline"),e.removeAttribute("medium-editor-index"),e.removeAttribute("data-medium-editor-editor-index"),e.getAttribute("medium-editor-textarea-id")&&p(e)}),this),this.elements=[],this.instanceHandleEditableKeydownEnter=null,this.instanceHandleEditableInput=null,c.call(this,this.options.contentWindow))},on:function(e,t,i,n){return this.events.attachDOMEvent(e,t,i,n),this},off:function(e,t,i,n){return this.events.detachDOMEvent(e,t,i,n),this},subscribe:function(e,t){return this.events.attachCustomEvent(e,t),this},unsubscribe:function(e,t){return this.events.detachCustomEvent(e,t),this},trigger:function(e,t,i){return this.events.triggerCustomEvent(e,t,i),this},delay:function(e){var t=this;return setTimeout((function(){t.isActive&&e()}),this.options.delay)},serialize:function(){var e,t={},i=this.elements.length;for(e=0;i>e;e+=1)t[""!==this.elements[e].id?this.elements[e].id:"element-"+e]={value:this.elements[e].innerHTML.trim()};return t},getExtensionByName:function(e){var t;return this.extensions&&this.extensions.length&&this.extensions.some((function(i){return i.name===e&&(t=i,!0)})),t},addBuiltInExtension:function(t,i){var n,o=this.getExtensionByName(t);if(o)return o;switch(t){case"anchor":n=e.util.extend({},this.options.anchor,i),o=new e.extensions.anchor(n);break;case"anchor-preview":o=new e.extensions.anchorPreview(this.options.anchorPreview);break;case"autoLink":o=new e.extensions.autoLink;break;case"fileDragging":o=new e.extensions.fileDragging(i);break;case"fontname":o=new e.extensions.fontName(this.options.fontName);break;case"fontsize":o=new e.extensions.fontSize(i);break;case"keyboardCommands":o=new e.extensions.keyboardCommands(this.options.keyboardCommands);break;case"paste":o=new e.extensions.paste(this.options.paste);break;case"placeholder":o=new e.extensions.placeholder(this.options.placeholder);break;default:e.extensions.button.isBuiltInButton(t)&&(i?(n=e.util.defaults({},i,e.extensions.button.prototype.defaults[t]),o=new e.extensions.button(n)):o=new e.extensions.button(t))}return o&&this.extensions.push(d(o,t,this)),o},stopSelectionUpdates:function(){this.preventSelectionUpdates=!0},startSelectionUpdates:function(){this.preventSelectionUpdates=!1},checkSelection:function(){var e=this.getExtensionByName("toolbar");return e&&e.checkState(),this},queryCommandState:function(e){var t,i=null;(t=/^full-(.+)$/gi.exec(e))&&(e=t[1]);try{i=this.options.ownerDocument.queryCommandState(e)}catch(o){i=null}return i},execAction:function(t,i){var n,o;return(n=/^full-(.+)$/gi.exec(t))?(this.saveSelection(),this.selectAllContents(),o=w.call(this,n[1],i),this.restoreSelection()):o=w.call(this,t,i),"insertunorderedlist"!==t&&"insertorderedlist"!==t||e.util.cleanListDOM(this.options.ownerDocument,this.getSelectedParentElement()),this.checkSelection(),o},getSelectedParentElement:function(t){return void 0===t&&(t=this.options.contentWindow.getSelection().getRangeAt(0)),e.selection.getSelectedParentElement(t)},selectAllContents:function(){var t=e.selection.getSelectionElement(this.options.contentWindow);if(t){for(;1===t.children.length;)t=t.children[0];this.selectElement(t)}},selectElement:function(t){e.selection.selectNode(t,this.options.ownerDocument);var i=e.selection.getSelectionElement(this.options.contentWindow);i&&this.events.focusElement(i)},getFocusedElement:function(){var e;return this.elements.some((function(t){return!e&&t.getAttribute("data-medium-focused")&&(e=t),!!e}),this),e},exportSelection:function(){var t=e.selection.getSelectionElement(this.options.contentWindow),i=this.elements.indexOf(t),n=null;return i>=0&&(n=e.selection.exportSelection(t,this.options.ownerDocument)),null!==n&&0!==i&&(n.editableElementIndex=i),n},saveSelection:function(){this.selectionState=this.exportSelection()},importSelection:function(t,i){t&&e.selection.importSelection(t,this.elements[t.editableElementIndex||0],this.options.ownerDocument,i)},restoreSelection:function(){this.importSelection(this.selectionState)},createLink:function(t){var i,n=e.selection.getSelectionElement(this.options.contentWindow),o={};if(-1!==this.elements.indexOf(n)){try{if(this.events.disableCustomEvent("editableInput"),t.url&&e.util.deprecated(".url option for createLink",".value","6.0.0"),(i=t.url||t.value)&&i.trim().length>0){var a=this.options.contentWindow.getSelection();if(a){var r,s,c,l,p=a.getRangeAt(0),d=p.commonAncestorContainer;if(3===p.endContainer.nodeType&&3!==p.startContainer.nodeType&&0===p.startOffset&&p.startContainer.firstChild===p.endContainer&&(d=p.endContainer),s=e.util.getClosestBlockContainer(p.startContainer),c=e.util.getClosestBlockContainer(p.endContainer),3!==d.nodeType&&0!==d.textContent.length&&s===c){var u=s||n,h=this.options.ownerDocument.createDocumentFragment();this.execAction("unlink"),r=this.exportSelection(),h.appendChild(u.cloneNode(!0)),n===u?e.selection.select(this.options.ownerDocument,u.firstChild,0,u.lastChild,3===u.lastChild.nodeType?u.lastChild.nodeValue.length:u.lastChild.childNodes.length):e.selection.select(this.options.ownerDocument,u,0,u,u.childNodes.length);var m=this.exportSelection();0===(l=e.util.findOrCreateMatchingTextNodes(this.options.ownerDocument,h,{start:r.start-m.start,end:r.end-m.start,editableElementIndex:r.editableElementIndex})).length&&((h=this.options.ownerDocument.createDocumentFragment()).appendChild(d.cloneNode(!0)),l=[h.firstChild.firstChild,h.firstChild.lastChild]),e.util.createLink(this.options.ownerDocument,l,i.trim());var b=(h.firstChild.innerHTML.match(/^\s+/)||[""])[0].length;e.util.insertHTMLCommand(this.options.ownerDocument,h.firstChild.innerHTML.replace(/^\s+/,"")),r.start-=b,r.end-=b,this.importSelection(r)}else this.options.ownerDocument.execCommand("createLink",!1,i);this.options.targetBlank||"_blank"===t.target?e.util.setTargetBlank(e.selection.getSelectionStart(this.options.ownerDocument),i):e.util.removeTargetBlank(e.selection.getSelectionStart(this.options.ownerDocument),i),t.buttonClass&&e.util.addClassToAnchors(e.selection.getSelectionStart(this.options.ownerDocument),t.buttonClass)}}if(this.options.targetBlank||"_blank"===t.target||t.buttonClass){(o=this.options.ownerDocument.createEvent("HTMLEvents")).initEvent("input",!0,!0,this.options.contentWindow);for(var g=0,f=this.elements.length;f>g;g+=1)this.elements[g].dispatchEvent(o)}}finally{this.events.enableCustomEvent("editableInput")}this.events.triggerCustomEvent("editableInput",o,n)}},cleanPaste:function(e){this.getExtensionByName("paste").cleanPaste(e)},pasteHTML:function(e,t){this.getExtensionByName("paste").pasteHTML(e,t)},setContent:function(e,t){if(this.elements[t=t||0]){var i=this.elements[t];i.innerHTML=e,this.checkContentChanged(i)}},getContent:function(e){return this.elements[e=e||0]?this.elements[e].innerHTML.trim():null},checkContentChanged:function(t){t=t||e.selection.getSelectionElement(this.options.contentWindow),this.events.updateInput(t,{target:t,currentTarget:t})},resetContent:function(e){if(e){var t=this.elements.indexOf(e);-1!==t&&this.setContent(S[e.getAttribute("medium-editor-index")],t)}else this.elements.forEach((function(e,t){this.setContent(S[e.getAttribute("medium-editor-index")],t)}),this)},addElements:function(e){var t=l(e,this.options.ownerDocument,!0);return 0!==t.length&&void t.forEach((function(e){e=v.call(this,e,this.id),this.elements.push(e),this.trigger("addElement",{target:e,currentTarget:e},e)}),this)},removeElements:function(e){var t=l(e,this.options.ownerDocument).map((function(e){return e.getAttribute("medium-editor-textarea-id")&&e.parentNode?e.parentNode.querySelector('div[medium-editor-textarea-id="'+e.getAttribute("medium-editor-textarea-id")+'"]'):e}));this.elements=this.elements.filter((function(e){return-1===t.indexOf(e)||(this.events.cleanupElement(e),e.getAttribute("medium-editor-textarea-id")&&p(e),this.trigger("removeElement",{target:e,currentTarget:e},e),!1)}),this)}},e.getEditorFromElement=function(e){var t=e.getAttribute("data-medium-editor-editor-index"),i=e&&e.ownerDocument&&(e.ownerDocument.defaultView||e.ownerDocument.parentWindow);return i&&i._mediumEditors&&i._mediumEditors[t]?i._mediumEditors[t]:null}}(),e.prototype.defaults={activeButtonClass:"medium-editor-button-active",buttonLabels:!1,delay:0,disableReturn:!1,disableDoubleReturn:!1,disableExtraSpaces:!1,disableEditing:!1,autoLink:!1,elementsContainer:!1,contentWindow:window,ownerDocument:document,targetBlank:!1,extensions:{},spellcheck:!0},e.parseVersionString=function(e){var t=e.split("-"),i=t[0].split("."),n=t.length>1?t[1]:"";return{major:parseInt(i[0],10),minor:parseInt(i[1],10),revision:parseInt(i[2],10),preRelease:n,toString:function(){return[i[0],i[1],i[2]].join(".")+(n?"-"+n:"")}}},e.version=e.parseVersionString.call(this,"5.23.3"),e;var t}())},zFnc:function(e,t,i){"use strict";i.r(t),i.d(t,"EditModule",(function(){return Kh}));var n=i("ofXK"),o=i("tyNb"),a=i("G0Z9"),r=i("AcyG"),s=i("CpGW"),c=i("XNiG"),l=i("LRne"),p=i("xgIS"),d=i("itXk"),u=i("VRyK"),h=i("PqYM"),m=i("HDdC"),b=i("x/dY"),g=i("jjCP"),f=i("iTtc"),x=i("PUI9"),y=i("YpC8"),v=i("5+tZ"),C=i("lJxs"),P=i("1G5W"),O=i("pLZG"),w=i("3E0/"),k=i("IzEk"),S=i("eIep"),_=i("Zy1z"),M=i("zP0r"),U=i("vkgz"),T=i("SxV6"),V=i("Vv7R"),D=i("11Ye"),E=i("H7eZ"),j=i("ZDoJ"),N=i("1a36"),R=i("N0Zw"),A=i("VJvM"),F=i("Mh2x"),I=i("TATr"),z=i("YLgZ"),L=i("Lyqc"),B=i("QtmD"),Q=i("sTHe"),$=i("q8pu"),q=i("ECVi"),G=i("3Pt+"),H=i("0IaG"),W=i("LvDl"),K=i("o6VQ"),J=i("+1W3"),X=i("mtgE"),Z=i("V7wM"),Y=i("1iZL"),ee=i("uDDk"),te=i("GW3K"),ie=i("Lwol"),ne=i("p345"),oe=i("INTG"),ae=i("fXoL"),re=i("qz+p"),se=i("TWoc"),ce=i("eW6i"),le=i("dNgK"),pe=i("IlST"),de=i("Y8QC"),ue=i("oOZS"),he=i("mdhy"),me=i("f0Cb"),be=i("UdTj"),ge=i("bSwM"),fe=i("3UWI"),xe=function(e){return e.Basic="basic",e.Full="full",e}({});function ye(e,t){return Array(t+1).join(e)}var ve=["address","article","aside","audio","blockquote","body","canvas","center","dd","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frameset","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","isindex","li","main","menu","nav","noframes","noscript","ol","output","p","pre","section","table","tbody","td","tfoot","th","thead","tr","ul"];function Ce(e){return-1!==ve.indexOf(e.nodeName.toLowerCase())}var Pe=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"];function Oe(e){return-1!==Pe.indexOf(e.nodeName.toLowerCase())}var we=Pe.join(),ke={};function Se(e){for(var t in this.options=e,this._keep=[],this._remove=[],this.blankRule={replacement:e.blankReplacement},this.keepReplacement=e.keepReplacement,this.defaultRule={replacement:e.defaultReplacement},this.array=[],e.rules)this.array.push(e.rules[t])}function _e(e,t,i){for(var n=0;n<e.length;n++){var o=e[n];if(Me(o,t,i))return o}}function Me(e,t,i){var n=e.filter;if("string"==typeof n){if(n===t.nodeName.toLowerCase())return!0}else if(Array.isArray(n)){if(n.indexOf(t.nodeName.toLowerCase())>-1)return!0}else{if("function"!=typeof n)throw new TypeError("`filter` needs to be a string, array, or function");if(n.call(e,t,i))return!0}}function Ue(e){var t=e.nextSibling||e.parentNode;return e.parentNode.removeChild(e),t}function Te(e,t,i){return e&&e.parentNode===t||i(t)?t.nextSibling||t.parentNode:t.firstChild||t.nextSibling||t.parentNode}ke.paragraph={filter:"p",replacement:function(e){return"\n\n"+e+"\n\n"}},ke.lineBreak={filter:"br",replacement:function(e,t,i){return i.br+"\n"}},ke.heading={filter:["h1","h2","h3","h4","h5","h6"],replacement:function(e,t,i){var n=Number(t.nodeName.charAt(1));return"setext"===i.headingStyle&&n<3?"\n\n"+e+"\n"+ye(1===n?"=":"-",e.length)+"\n\n":"\n\n"+ye("#",n)+" "+e+"\n\n"}},ke.blockquote={filter:"blockquote",replacement:function(e){return"\n\n"+(e=(e=e.replace(/^\n+|\n+$/g,"")).replace(/^/gm,"> "))+"\n\n"}},ke.list={filter:["ul","ol"],replacement:function(e,t){var i=t.parentNode;return"LI"===i.nodeName&&i.lastElementChild===t?"\n"+e:"\n\n"+e+"\n\n"}},ke.listItem={filter:"li",replacement:function(e,t,i){e=e.replace(/^\n+/,"").replace(/\n+$/,"\n").replace(/\n/gm,"\n    ");var n=i.bulletListMarker+"   ",o=t.parentNode;if("OL"===o.nodeName){var a=o.getAttribute("start"),r=Array.prototype.indexOf.call(o.children,t);n=(a?Number(a)+r:r+1)+".  "}return n+e+(t.nextSibling&&!/\n$/.test(e)?"\n":"")}},ke.indentedCodeBlock={filter:function(e,t){return"indented"===t.codeBlockStyle&&"PRE"===e.nodeName&&e.firstChild&&"CODE"===e.firstChild.nodeName},replacement:function(e,t,i){return"\n\n    "+t.firstChild.textContent.replace(/\n/g,"\n    ")+"\n\n"}},ke.fencedCodeBlock={filter:function(e,t){return"fenced"===t.codeBlockStyle&&"PRE"===e.nodeName&&e.firstChild&&"CODE"===e.firstChild.nodeName},replacement:function(e,t,i){for(var n,o=((t.firstChild.className||"").match(/language-(\S+)/)||[null,""])[1],a=t.firstChild.textContent,r=i.fence.charAt(0),s=3,c=new RegExp("^"+r+"{3,}","gm");n=c.exec(a);)n[0].length>=s&&(s=n[0].length+1);var l=ye(r,s);return"\n\n"+l+o+"\n"+a.replace(/\n$/,"")+"\n"+l+"\n\n"}},ke.horizontalRule={filter:"hr",replacement:function(e,t,i){return"\n\n"+i.hr+"\n\n"}},ke.inlineLink={filter:function(e,t){return"inlined"===t.linkStyle&&"A"===e.nodeName&&e.getAttribute("href")},replacement:function(e,t){return"["+e+"]("+t.getAttribute("href")+(t.title?' "'+t.title+'"':"")+")"}},ke.referenceLink={filter:function(e,t){return"referenced"===t.linkStyle&&"A"===e.nodeName&&e.getAttribute("href")},replacement:function(e,t,i){var n,o,a=t.getAttribute("href"),r=t.title?' "'+t.title+'"':"";switch(i.linkReferenceStyle){case"collapsed":n="["+e+"][]",o="["+e+"]: "+a+r;break;case"shortcut":n="["+e+"]",o="["+e+"]: "+a+r;break;default:var s=this.references.length+1;n="["+e+"]["+s+"]",o="["+s+"]: "+a+r}return this.references.push(o),n},references:[],append:function(e){var t="";return this.references.length&&(t="\n\n"+this.references.join("\n")+"\n\n",this.references=[]),t}},ke.emphasis={filter:["em","i"],replacement:function(e,t,i){return e.trim()?i.emDelimiter+e+i.emDelimiter:""}},ke.strong={filter:["strong","b"],replacement:function(e,t,i){return e.trim()?i.strongDelimiter+e+i.strongDelimiter:""}},ke.code={filter:function(e){return"CODE"===e.nodeName&&!("PRE"===e.parentNode.nodeName&&!e.previousSibling&&!e.nextSibling)},replacement:function(e){if(!e.trim())return"";var t="`",i="",n="",o=e.match(/`+/gm);if(o)for(/^`/.test(e)&&(i=" "),/`$/.test(e)&&(n=" ");-1!==o.indexOf(t);)t+="`";return t+i+e+n+t}},ke.image={filter:"img",replacement:function(e,t){var i=t.alt||"",n=t.getAttribute("src")||"",o=t.title||"";return n?"!["+i+"]("+n+(o?' "'+o+'"':"")+")":""}},Se.prototype={add:function(e,t){this.array.unshift(t)},keep:function(e){this._keep.unshift({filter:e,replacement:this.keepReplacement})},remove:function(e){this._remove.unshift({filter:e,replacement:function(){return""}})},forNode:function(e){return e.isBlank?this.blankRule:(t=_e(this.array,e,this.options))||(t=_e(this._keep,e,this.options))||(t=_e(this._remove,e,this.options))?t:this.defaultRule;var t},forEach:function(e){for(var t=0;t<this.array.length;t++)e(this.array[t],t)}};var Ve,De,Ee,je="undefined"!=typeof window?window:{},Ne=function(){var e=je.DOMParser,t=!1;try{(new e).parseFromString("","text/html")&&(t=!0)}catch(i){}return t}()?je.DOMParser:(Ve=function(){},De=i(5).JSDOM,Ve.prototype.parseFromString=function(e){return new De(e).window.document},Ve);function Re(e){var t;return function(e){var t=e.element,i=e.isBlock,n=e.isVoid,o=e.isPre||function(e){return"PRE"===e.nodeName};if(t.firstChild&&!o(t)){for(var a=null,r=!1,s=null,c=Te(s,t,o);c!==t;){if(3===c.nodeType||4===c.nodeType){var l=c.data.replace(/[ \r\n\t]+/g," ");if(a&&!/ $/.test(a.data)||r||" "!==l[0]||(l=l.substr(1)),!l){c=Ue(c);continue}c.data=l,a=c}else{if(1!==c.nodeType){c=Ue(c);continue}i(c)||"BR"===c.nodeName?(a&&(a.data=a.data.replace(/ $/,"")),a=null,r=!1):n(c)&&(a=null,r=!0)}var p=Te(s,c,o);s=c,c=p}a&&(a.data=a.data.replace(/ $/,""),a.data||Ue(a))}}({element:t="string"==typeof e?(Ee=Ee||new Ne).parseFromString('<x-turndown id="turndown-root">'+e+"</x-turndown>","text/html").getElementById("turndown-root"):e.cloneNode(!0),isBlock:Ce,isVoid:Oe}),t}function Ae(e){return e.isBlock=Ce(e),e.isCode="code"===e.nodeName.toLowerCase()||e.parentNode.isCode,e.isBlank=function(e){return-1===["A","TH","TD","IFRAME","SCRIPT","AUDIO","VIDEO"].indexOf(e.nodeName)&&/^\s*$/i.test(e.textContent)&&!Oe(e)&&!function(e){return e.querySelector&&e.querySelector(we)}(e)}(e),e.flankingWhitespace=function(e){var t="",i="";if(!e.isBlock){var n=/^\s/.test(e.textContent),o=/\s$/.test(e.textContent),a=e.isBlank&&n&&o;n&&!Fe("left",e)&&(t=" "),a||!o||Fe("right",e)||(i=" ")}return{leading:t,trailing:i}}(e),e}function Fe(e,t){var i,n,o;return"left"===e?(i=t.previousSibling,n=/ $/):(i=t.nextSibling,n=/^ /),i&&(3===i.nodeType?o=n.test(i.nodeValue):1!==i.nodeType||Ce(i)||(o=n.test(i.textContent))),o}var Ie=Array.prototype.reduce,ze=/^\n*/,Le=/\n*$/,Be=[[/\\/g,"\\\\"],[/\*/g,"\\*"],[/^-/g,"\\-"],[/^\+ /g,"\\+ "],[/^(=+)/g,"\\$1"],[/^(#{1,6}) /g,"\\$1 "],[/`/g,"\\`"],[/^~~~/g,"\\~~~"],[/\[/g,"\\["],[/\]/g,"\\]"],[/^>/g,"\\>"],[/_/g,"\\_"],[/^(\d+)\. /g,"$1\\. "]];function Qe(e){if(!(this instanceof Qe))return new Qe(e);this.options=function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)i.hasOwnProperty(n)&&(e[n]=i[n])}return e}({},{rules:ke,headingStyle:"setext",hr:"* * *",bulletListMarker:"*",codeBlockStyle:"indented",fence:"```",emDelimiter:"_",strongDelimiter:"**",linkStyle:"inlined",linkReferenceStyle:"full",br:"  ",blankReplacement:function(e,t){return t.isBlock?"\n\n":""},keepReplacement:function(e,t){return t.isBlock?"\n\n"+t.outerHTML+"\n\n":t.outerHTML},defaultReplacement:function(e,t){return t.isBlock?"\n\n"+e+"\n\n":e}},e),this.rules=new Se(this.options)}function $e(e){var t=this;return Ie.call(e.childNodes,(function(e,i){var n="";return 3===(i=new Ae(i)).nodeType?n=i.isCode?i.nodeValue:t.escape(i.nodeValue):1===i.nodeType&&(n=Ge.call(t,i)),He(e,n)}),"")}function qe(e){var t=this;return this.rules.forEach((function(i){"function"==typeof i.append&&(e=He(e,i.append(t.options)))})),e.replace(/^[\t\r\n]+/,"").replace(/[\t\r\n\s]+$/,"")}function Ge(e){var t=this.rules.forNode(e),i=$e.call(this,e),n=e.flankingWhitespace;return(n.leading||n.trailing)&&(i=i.trim()),n.leading+t.replacement(i,e,this.options)+n.trailing}function He(e,t){var i,n,o,a=(i=t,(o=(n=[e.match(Le)[0],i.match(ze)[0]].sort())[n.length-1]).length<2?o:"\n\n");return(e=e.replace(Le,""))+a+t.replace(ze,"")}Qe.prototype={turndown:function(e){if(!function(e){return null!=e&&("string"==typeof e||e.nodeType&&(1===e.nodeType||9===e.nodeType||11===e.nodeType))}(e))throw new TypeError(e+" is not a string, or an element/document/fragment node.");if(""===e)return"";var t=$e.call(this,new Re(e));return qe.call(this,t)},use:function(e){if(Array.isArray(e))for(var t=0;t<e.length;t++)this.use(e[t]);else{if("function"!=typeof e)throw new TypeError("plugin must be a Function or an Array of Functions");e(this)}return this},addRule:function(e,t){return this.rules.add(e,t),this},keep:function(e){return this.rules.keep(e),this},remove:function(e){return this.rules.remove(e),this},escape:function(e){return Be.reduce((function(e,t){return e.replace(t[0],t[1])}),e)}};var We=Qe,Ke=i("CL6y");const Je=new We({headingStyle:"atx"}).keep(Ke.b);var Xe=i("j8XN"),Ze=i("lR5k");const Ye=["containerEl"],et=["toolbarEl"],tt=["editEl"],it={[xe.Basic]:["superscript","subscript"],[xe.Full]:["bold","italic","anchor","orderedlist","unorderedlist","superscript","subscript"]};let nt=(()=>{class e{constructor(e,t,i){this.changeRef=e,this.renderer2=t,this.markdownService=i,this.resizeable=!0,this.inline=!0,this.compact=!1,this.mode=xe.Full,this.textMode="textarea",this.textValue="",this.editorFocused=!1,this.valueChanges=new c.a,this.ngUnsubscribe=new c.a,this.plainTextEl=this.renderer2.createElement("div")}get value(){return this._value}set value(e){e!==this.value&&(this._value=e,this.textValue=this.getPlainTextFromMarkdown(e),this.onChange(e),this.valueChanges.next(e))}set rows(e){this._rows=e,this.setRows(e)}get rows(){return this._rows}ngOnInit(){}ngAfterViewInit(){this.initEditor(),this.initListeners(),this.initContentLabel()}ngOnDestroy(){this.editor.destroy(),this.valueChanges.complete(),this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initEditor(){this.editor=new Xe(this.editEl.nativeElement,{toolbar:{relativeContainer:this.inline?this.toolbarEl.nativeElement:null,buttons:it[this.mode]},targetBlank:!0,buttonLabels:"fontawesome",paste:{forcePlainText:this.mode===xe.Basic,cleanPastedHTML:this.mode!==xe.Basic},anchor:{linkValidation:!0},disableReturn:"text"===this.textMode,placeholder:!!this.placeholder&&{text:this.placeholder}}),this.getEditorValueChanges(this.editor).pipe(Object(fe.a)(125),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{const t="number"==typeof this.maxLength,i=this.getPlainTextFromHTML(e);if(t&&i.length>this.maxLength)this.setEditorValue(this.value);else{const t=function(e){return Je.turndown(e)}(e);this.value=t}}),this.getEditorEvent(this.editor,"focus").pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(()=>{this.editorFocused=!0,this.changeRef.markForCheck()}),this.getEditorEvent(this.editor,"blur").pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(()=>{this.editorFocused=!1,this.changeRef.markForCheck()}),this.setEditorValue(this.value),this.setRows(this.rows)}initListeners(){Object(p.a)(this.editEl.nativeElement,"keydown").pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{e.stopPropagation()})}initContentLabel(){const e=this.containerEl.nativeElement.closest("label");if(!Object(W.isNil)(e)){const t=e.getAttribute("aria-label")||"",i="textarea"===this.textMode;this.editEl.nativeElement.setAttribute("aria-label",t),this.editEl.nativeElement.setAttribute("aria-multiline",i.toString())}}getValueChanges(){return this.valueChanges.asObservable()}getEditorValue(e){return e.getContent(0)}getEditorValueChanges(e){return this.getEditorEvent(e,"editableInput").pipe(Object(C.a)(()=>this.getEditorValue(e)))}getEditorEvent(e,t){return new m.a(i=>{e.subscribe(t,e=>{i.next(e)})})}setEditorValue(e){if(this.editor){const t=this.markdownService.compile(e);this.editor.setContent(t)}}setRows(e){this.editEl&&this.editEl.nativeElement&&this.renderer2.setStyle(this.editEl.nativeElement,"height",void 0===e?"auto":16+16*e+"px")}onChange(e){}onTouched(){}writeValue(e){e!==this.value&&(this.value=e,this.setEditorValue(e))}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}setDisabledState(e){this.disabled=e}getPlainTextFromMarkdown(e){const t=this.markdownService.compile(e);return this.getPlainTextFromHTML(t)}getPlainTextFromHTML(e){return this.renderer2.setProperty(this.plainTextEl,"innerHTML",e),Object(W.trim)(this.plainTextEl.textContent)}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(ae.i),ae.Pb(ae.H),ae.Pb(Ze.c))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-rich-text-edit"]],viewQuery:function(e,t){if(1&e&&(ae.Jc(Ye,!0),ae.Jc(et,!0),ae.Jc(tt,!0)),2&e){let e;ae.xc(e=ae.dc())&&(t.containerEl=e.first),ae.xc(e=ae.dc())&&(t.toolbarEl=e.first),ae.xc(e=ae.dc())&&(t.editEl=e.first)}},inputs:{value:"value",rows:"rows",disabled:"disabled",resizeable:"resizeable",inline:"inline",compact:"compact",mode:"mode",textMode:"textMode",maxLength:"maxLength",placeholder:"placeholder"},features:[ae.Cb([{provide:G.p,useExisting:Object(ae.W)(()=>e),multi:!0}])],decls:6,vars:13,consts:[[1,"rich-text-edit"],["containerEl",""],["role","textbox",1,"rich-text-edit__editor","html","input"],["editEl",""],[1,"rich-text-edit__toolbar","medium-editor-toolbar-container"],["toolbarEl",""]],template:function(e,t){1&e&&(ae.Vb(0,"div",0,1),ae.Qb(2,"div",2,3),ae.Qb(4,"div",4,5),ae.Ub()),2&e&&(ae.Hb("rich-text-edit--inline",!0===t.inline)("medium-editor-focused",t.editorFocused)("medium-editor-compact",t.compact),ae.Db(2),ae.Hb("rich-text-edit__editor--text","text"===t.textMode)("rich-text-edit__editor--textarea","textarea"===t.textMode)("rich-text-edit__editor--resizeable",t.resizeable),ae.Eb("data-disable-editing",t.disabled))},styles:[".input,[type=email].input,[type=file].input,[type=number].input,[type=password].input,[type=text].input,[type=url].input,select.input,textarea.input{border:1px solid #1b283c;border-radius:4px;background-color:#101823;color:#fff;display:block;min-height:36px;width:100%;font-size:12px;padding:8px 12px;font-family:Inter UI,sans-serif}@supports (font-variation-settings:normal){.input,[type=email].input,[type=file].input,[type=number].input,[type=password].input,[type=text].input,[type=url].input,select.input,textarea.input{font-family:Inter UI var alt,sans-serif}}.input:focus,[type=email].input:focus,[type=file].input:focus,[type=number].input:focus,[type=password].input:focus,[type=text].input:focus,[type=url].input:focus,select.input:focus,textarea.input:focus{outline:2px solid #2d72dc!important}.input:focus.ng-invalid,[type=email].input:focus.ng-invalid,[type=file].input:focus.ng-invalid,[type=number].input:focus.ng-invalid,[type=password].input:focus.ng-invalid,[type=text].input:focus.ng-invalid,[type=url].input:focus.ng-invalid,select.input:focus.ng-invalid,textarea.input:focus.ng-invalid{outline-color:#ed4758!important;outline-width:1px!important}.input--small,[type=email].input--small,[type=file].input--small,[type=number].input--small,[type=password].input--small,[type=text].input--small,[type=url].input--small,select.input--small,textarea.input--small{font-size:12px;padding:8px;min-height:auto}.input--large,[type=email].input--large,[type=file].input--large,[type=number].input--large,[type=password].input--large,[type=text].input--large,[type=url].input--large,select.input--large,textarea.input--large{font-size:16px;padding:12px}.input--success,[type=email].input--success,[type=file].input--success,[type=number].input--success,[type=password].input--success,[type=text].input--success,[type=url].input--success,select.input--success,textarea.input--success{border-color:#38de38!important}.input:disabled,[type=email].input:disabled,[type=file].input:disabled,[type=number].input:disabled,[type=password].input:disabled,[type=text].input:disabled,[type=url].input:disabled,select.input:disabled,textarea.input:disabled{opacity:.4}.input.ng-dirty.ng-invalid,[type=email].input.ng-dirty.ng-invalid,[type=file].input.ng-dirty.ng-invalid,[type=number].input.ng-dirty.ng-invalid,[type=password].input.ng-dirty.ng-invalid,[type=text].input.ng-dirty.ng-invalid,[type=url].input.ng-dirty.ng-invalid,select.input.ng-dirty.ng-invalid,textarea.input.ng-dirty.ng-invalid{border:1px solid #ed4758}textarea.input--nonresizable{resize:none}select.input{height:36px}.theme-dark .input[type=email],.theme-dark .input[type=file],.theme-dark .input[type=number],.theme-dark .input[type=password],.theme-dark .input[type=text],.theme-dark .input[type=url],.theme-dark select.input,.theme-dark textarea.input,input.theme-dark,select.theme-dark,textarea.theme-dark{background-color:#101823;border:1px solid #374a68;color:#fff}.theme-light .input[type=email],.theme-light .input[type=file],.theme-light .input[type=number],.theme-light .input[type=password],.theme-light .input[type=text],.theme-light .input[type=url],.theme-light select.input,.theme-light textarea.input,input.theme-light,select.theme-light,textarea.theme-light{background-color:#fff;border:1px solid #96a8c0;color:#283853}.theme-light .input[type=email]:focus,.theme-light .input[type=file]:focus,.theme-light .input[type=number]:focus,.theme-light .input[type=password]:focus,.theme-light .input[type=text]:focus,.theme-light .input[type=url]:focus,.theme-light select.input:focus,.theme-light textarea.input:focus,input.theme-light:focus,select.theme-light:focus,textarea.theme-light:focus{background-color:#fff}.theme-light .input[type=email]::-moz-placeholder,.theme-light .input[type=file]::-moz-placeholder,.theme-light .input[type=number]::-moz-placeholder,.theme-light .input[type=password]::-moz-placeholder,.theme-light .input[type=text]::-moz-placeholder,.theme-light .input[type=url]::-moz-placeholder,.theme-light select.input::-moz-placeholder,.theme-light textarea.input::-moz-placeholder,input.theme-light::-moz-placeholder,select.theme-light::-moz-placeholder,textarea.theme-light::-moz-placeholder{color:rgba(55,74,104,.5)}.theme-light .input[type=email]:-ms-input-placeholder,.theme-light .input[type=file]:-ms-input-placeholder,.theme-light .input[type=number]:-ms-input-placeholder,.theme-light .input[type=password]:-ms-input-placeholder,.theme-light .input[type=text]:-ms-input-placeholder,.theme-light .input[type=url]:-ms-input-placeholder,.theme-light select.input:-ms-input-placeholder,.theme-light textarea.input:-ms-input-placeholder,input.theme-light:-ms-input-placeholder,select.theme-light:-ms-input-placeholder,textarea.theme-light:-ms-input-placeholder{color:rgba(55,74,104,.5)}.theme-light .input[type=email]::placeholder,.theme-light .input[type=file]::placeholder,.theme-light .input[type=number]::placeholder,.theme-light .input[type=password]::placeholder,.theme-light .input[type=text]::placeholder,.theme-light .input[type=url]::placeholder,.theme-light select.input::placeholder,.theme-light textarea.input::placeholder,input.theme-light::placeholder,select.theme-light::placeholder,textarea.theme-light::placeholder{color:rgba(55,74,104,.5)}.rich-text-edit{border-radius:4px;padding:0;position:relative}.rich-text-edit__toolbar{display:none;border-top:none;border-bottom-left-radius:4px;border-bottom-right-radius:4px}.rich-text-edit__editor{font-size:12px;border-bottom:none!important}.rich-text-edit__editor--text{border:none!important;box-shadow:none!important;display:inline-block;height:1em}.rich-text-edit__editor--textarea{border:none!important;box-shadow:none!important;overflow:auto}.rich-text-edit__editor--resizeable{resize:vertical}.rich-text-edit--inline{display:flex;flex-direction:column}.rich-text-edit--inline .rich-text-edit__toolbar{display:block}.theme-dark .rich-text-edit,.theme-dark .rich-text-edit__editor--text,.theme-dark .rich-text-edit__editor--textarea{background-color:#101823;border:1px solid #374a68;color:#fff}.theme-light .rich-text-edit{background-color:#fff;border:1px solid #96a8c0;color:#283853}.theme-light .rich-text-edit:focus{background-color:#fff}.theme-light .rich-text-edit::-moz-placeholder{color:rgba(55,74,104,.5)}.theme-light .rich-text-edit:-ms-input-placeholder{color:rgba(55,74,104,.5)}.theme-light .rich-text-edit::placeholder{color:rgba(55,74,104,.5)}.theme-light .rich-text-edit__editor--text,.theme-light .rich-text-edit__editor--textarea{background-color:#fff;border:1px solid #96a8c0;color:#283853}.theme-light .rich-text-edit__editor--text:focus,.theme-light .rich-text-edit__editor--textarea:focus{background-color:#fff}.theme-light .rich-text-edit__editor--text::-moz-placeholder,.theme-light .rich-text-edit__editor--textarea::-moz-placeholder{color:rgba(55,74,104,.5)}.theme-light .rich-text-edit__editor--text:-ms-input-placeholder,.theme-light .rich-text-edit__editor--textarea:-ms-input-placeholder{color:rgba(55,74,104,.5)}.theme-light .rich-text-edit__editor--text::placeholder,.theme-light .rich-text-edit__editor--textarea::placeholder{color:rgba(55,74,104,.5)}",'.medium-editor-anchor-preview,.medium-editor-toolbar{font-family:Helvetica Neue,Helvetica,Arial,sans-serif;font-size:16px;z-index:2000}@keyframes medium-editor-image-loading{0%{transform:scale(0)}to{transform:scale(1)}}@keyframes medium-editor-pop-upwards{0%{opacity:0;transform:matrix(.97,0,0,1,0,12)}20%{opacity:.7;transform:matrix(.99,0,0,1,0,2)}40%{opacity:1;transform:matrix(1,0,0,1,0,-1)}to{transform:matrix(1,0,0,1,0,0)}}.medium-editor-anchor-preview{left:0;line-height:1.4;max-width:280px;position:absolute;text-align:center;top:0;word-break:break-all;word-wrap:break-word;visibility:hidden}.medium-editor-anchor-preview a{color:#fff;display:inline-block;margin:5px 5px 10px}.medium-editor-placeholder-relative:after,.medium-editor-placeholder:after{content:attr(data-placeholder)!important;white-space:pre;padding:inherit;margin:inherit;font-style:italic}.medium-editor-anchor-preview-active{visibility:visible}.medium-editor-dragover{background:#ddd}.medium-editor-image-loading{animation:medium-editor-image-loading 1s ease-in-out infinite;background-color:#333;border-radius:100%;display:inline-block;height:40px;width:40px}.medium-editor-placeholder{position:relative}.medium-editor-placeholder:after{position:absolute;left:0;top:0}.medium-editor-placeholder-relative,.medium-editor-placeholder-relative:after{position:relative}.medium-toolbar-arrow-over:before,.medium-toolbar-arrow-under:after{border-style:solid;content:"";display:block;height:0;left:50%;margin-left:-8px;position:absolute;width:0}.medium-toolbar-arrow-under:after{border-width:8px 8px 0}.medium-toolbar-arrow-over:before{border-width:0 8px 8px;top:-8px}.medium-editor-toolbar{left:0;position:absolute;top:0;visibility:hidden}.medium-editor-toolbar ul{margin:0;padding:0}.medium-editor-toolbar li{float:left;list-style:none;margin:0;padding:0}.medium-editor-toolbar li button{box-sizing:border-box;cursor:pointer;display:block;font-size:14px;line-height:1.33;margin:0;padding:15px;text-decoration:none}.medium-editor-toolbar li button:focus{outline:0}.medium-editor-toolbar li .medium-editor-action-underline{text-decoration:underline}.medium-editor-toolbar li .medium-editor-action-pre{font-family:Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;font-weight:100;padding:15px 0}.medium-editor-toolbar-active{visibility:visible}.medium-editor-sticky-toolbar{position:fixed;top:1px}.medium-editor-relative-toolbar{position:relative}.medium-editor-toolbar-active.medium-editor-stalker-toolbar{animation:medium-editor-pop-upwards .16s linear forwards}.medium-editor-action-bold{font-weight:bolder}.medium-editor-action-italic{font-style:italic}.medium-editor-toolbar-form{display:none}.medium-editor-toolbar-form a,.medium-editor-toolbar-form input{font-family:Helvetica Neue,Helvetica,Arial,sans-serif}.medium-editor-toolbar-form .medium-editor-toolbar-form-row{line-height:14px;margin-left:5px;padding-bottom:5px}.medium-editor-toolbar-form .medium-editor-toolbar-input,.medium-editor-toolbar-form label{border:none;box-sizing:border-box;font-size:14px;margin:0;padding:6px;width:316px;display:inline-block}.medium-editor-toolbar-form .medium-editor-toolbar-input:focus,.medium-editor-toolbar-form label:focus{-webkit-appearance:none;-moz-appearance:none;appearance:none;border:none;box-shadow:none;outline:0}.medium-editor-toolbar-form a{display:inline-block;font-size:24px;font-weight:bolder;margin:0 10px;text-decoration:none}.medium-editor-toolbar-form-active{display:block}.medium-editor-toolbar-actions:after{clear:both;content:"";display:table}.medium-editor-element{word-wrap:break-word;min-height:30px}.medium-editor-element img{max-width:100%}.medium-editor-element sub{vertical-align:sub}.medium-editor-element sup{vertical-align:super}.medium-editor-hidden{display:none}',".input,.medium-editor-toolbar-form :root [type=email].medium-editor-toolbar-input,.medium-editor-toolbar-form :root [type=file].medium-editor-toolbar-input,.medium-editor-toolbar-form :root [type=number].medium-editor-toolbar-input,.medium-editor-toolbar-form :root [type=password].medium-editor-toolbar-input,.medium-editor-toolbar-form :root [type=text].medium-editor-toolbar-input,.medium-editor-toolbar-form :root [type=url].medium-editor-toolbar-input,.medium-editor-toolbar-form :root select.medium-editor-toolbar-input,.medium-editor-toolbar-form :root textarea.medium-editor-toolbar-input,:root .medium-editor-toolbar-form .medium-editor-toolbar-input,[type=email].input,[type=file].input,[type=number].input,[type=password].input,[type=text].input,[type=url].input,select.input,textarea.input{border:1px solid #1b283c;border-radius:4px;background-color:#101823;color:#fff;display:block;min-height:36px;width:100%;font-size:12px;padding:8px 12px;font-family:Inter UI,sans-serif}@supports (font-variation-settings:normal){.input,.medium-editor-toolbar-form :root [type=email].medium-editor-toolbar-input,.medium-editor-toolbar-form :root [type=file].medium-editor-toolbar-input,.medium-editor-toolbar-form :root [type=number].medium-editor-toolbar-input,.medium-editor-toolbar-form :root [type=password].medium-editor-toolbar-input,.medium-editor-toolbar-form :root [type=text].medium-editor-toolbar-input,.medium-editor-toolbar-form :root [type=url].medium-editor-toolbar-input,.medium-editor-toolbar-form :root select.medium-editor-toolbar-input,.medium-editor-toolbar-form :root textarea.medium-editor-toolbar-input,:root .medium-editor-toolbar-form .medium-editor-toolbar-input,[type=email].input,[type=file].input,[type=number].input,[type=password].input,[type=text].input,[type=url].input,select.input,textarea.input{font-family:Inter UI var alt,sans-serif}}.input:focus,.medium-editor-toolbar-form :root .medium-editor-toolbar-input:focus,:root .medium-editor-toolbar-form .medium-editor-toolbar-input:focus,[type=email].input:focus,[type=file].input:focus,[type=number].input:focus,[type=password].input:focus,[type=text].input:focus,[type=url].input:focus,select.input:focus,textarea.input:focus{outline:2px solid #2d72dc!important}.input:focus.ng-invalid,.medium-editor-toolbar-form :root .medium-editor-toolbar-input:focus.ng-invalid,:root .medium-editor-toolbar-form .medium-editor-toolbar-input:focus.ng-invalid,[type=email].input:focus.ng-invalid,[type=file].input:focus.ng-invalid,[type=number].input:focus.ng-invalid,[type=password].input:focus.ng-invalid,[type=text].input:focus.ng-invalid,[type=url].input:focus.ng-invalid,select.input:focus.ng-invalid,textarea.input:focus.ng-invalid{outline-color:#ed4758!important;outline-width:1px!important}.input--small,[type=email].input--small,[type=file].input--small,[type=number].input--small,[type=password].input--small,[type=text].input--small,[type=url].input--small,select.input--small,textarea.input--small{font-size:12px;padding:8px;min-height:auto}.input--large,[type=email].input--large,[type=file].input--large,[type=number].input--large,[type=password].input--large,[type=text].input--large,[type=url].input--large,select.input--large,textarea.input--large{font-size:16px;padding:12px}.input--success,[type=email].input--success,[type=file].input--success,[type=number].input--success,[type=password].input--success,[type=text].input--success,[type=url].input--success,select.input--success,textarea.input--success{border-color:#38de38!important}.input:disabled,.medium-editor-toolbar-form :root .medium-editor-toolbar-input:disabled,:root .medium-editor-toolbar-form .medium-editor-toolbar-input:disabled,[type=email].input:disabled,[type=file].input:disabled,[type=number].input:disabled,[type=password].input:disabled,[type=text].input:disabled,[type=url].input:disabled,select.input:disabled,textarea.input:disabled{opacity:.4}.input.ng-dirty.ng-invalid,.medium-editor-toolbar-form :root .ng-dirty.ng-invalid.medium-editor-toolbar-input,:root .medium-editor-toolbar-form .ng-dirty.ng-invalid.medium-editor-toolbar-input,[type=email].input.ng-dirty.ng-invalid,[type=file].input.ng-dirty.ng-invalid,[type=number].input.ng-dirty.ng-invalid,[type=password].input.ng-dirty.ng-invalid,[type=text].input.ng-dirty.ng-invalid,[type=url].input.ng-dirty.ng-invalid,select.input.ng-dirty.ng-invalid,textarea.input.ng-dirty.ng-invalid{border:1px solid #ed4758}textarea.input--nonresizable{resize:none}.medium-editor-toolbar-form :root select.medium-editor-toolbar-input,:root .medium-editor-toolbar-form select.medium-editor-toolbar-input,select.input{height:36px}.medium-editor-toolbar-form :root .theme-dark [type=email].medium-editor-toolbar-input,.medium-editor-toolbar-form :root .theme-dark [type=file].medium-editor-toolbar-input,.medium-editor-toolbar-form :root .theme-dark [type=number].medium-editor-toolbar-input,.medium-editor-toolbar-form :root .theme-dark [type=password].medium-editor-toolbar-input,.medium-editor-toolbar-form :root .theme-dark [type=text].medium-editor-toolbar-input,.medium-editor-toolbar-form :root .theme-dark [type=url].medium-editor-toolbar-input,.medium-editor-toolbar-form :root .theme-dark select.medium-editor-toolbar-input,.medium-editor-toolbar-form :root .theme-dark textarea.medium-editor-toolbar-input,.theme-dark .input[type=email],.theme-dark .input[type=file],.theme-dark .input[type=number],.theme-dark .input[type=password],.theme-dark .input[type=text],.theme-dark .input[type=url],.theme-dark .medium-editor-toolbar-form :root [type=email].medium-editor-toolbar-input,.theme-dark .medium-editor-toolbar-form :root [type=file].medium-editor-toolbar-input,.theme-dark .medium-editor-toolbar-form :root [type=number].medium-editor-toolbar-input,.theme-dark .medium-editor-toolbar-form :root [type=password].medium-editor-toolbar-input,.theme-dark .medium-editor-toolbar-form :root [type=text].medium-editor-toolbar-input,.theme-dark .medium-editor-toolbar-form :root [type=url].medium-editor-toolbar-input,.theme-dark .medium-editor-toolbar-form :root select.medium-editor-toolbar-input,.theme-dark .medium-editor-toolbar-form :root textarea.medium-editor-toolbar-input,.theme-dark select.input,.theme-dark textarea.input,:root .theme-dark .medium-editor-toolbar-form [type=email].medium-editor-toolbar-input,:root .theme-dark .medium-editor-toolbar-form [type=file].medium-editor-toolbar-input,:root .theme-dark .medium-editor-toolbar-form [type=number].medium-editor-toolbar-input,:root .theme-dark .medium-editor-toolbar-form [type=password].medium-editor-toolbar-input,:root .theme-dark .medium-editor-toolbar-form [type=text].medium-editor-toolbar-input,:root .theme-dark .medium-editor-toolbar-form [type=url].medium-editor-toolbar-input,:root .theme-dark .medium-editor-toolbar-form select.medium-editor-toolbar-input,:root .theme-dark .medium-editor-toolbar-form textarea.medium-editor-toolbar-input,input.theme-dark,select.theme-dark,textarea.theme-dark{background-color:#101823;border:1px solid #374a68;color:#fff}.medium-editor-toolbar-form :root .theme-light [type=email].medium-editor-toolbar-input,.medium-editor-toolbar-form :root .theme-light [type=file].medium-editor-toolbar-input,.medium-editor-toolbar-form :root .theme-light [type=number].medium-editor-toolbar-input,.medium-editor-toolbar-form :root .theme-light [type=password].medium-editor-toolbar-input,.medium-editor-toolbar-form :root .theme-light [type=text].medium-editor-toolbar-input,.medium-editor-toolbar-form :root .theme-light [type=url].medium-editor-toolbar-input,.medium-editor-toolbar-form :root .theme-light select.medium-editor-toolbar-input,.medium-editor-toolbar-form :root .theme-light textarea.medium-editor-toolbar-input,.theme-light .input[type=email],.theme-light .input[type=file],.theme-light .input[type=number],.theme-light .input[type=password],.theme-light .input[type=text],.theme-light .input[type=url],.theme-light .medium-editor-toolbar-form :root [type=email].medium-editor-toolbar-input,.theme-light .medium-editor-toolbar-form :root [type=file].medium-editor-toolbar-input,.theme-light .medium-editor-toolbar-form :root [type=number].medium-editor-toolbar-input,.theme-light .medium-editor-toolbar-form :root [type=password].medium-editor-toolbar-input,.theme-light .medium-editor-toolbar-form :root [type=text].medium-editor-toolbar-input,.theme-light .medium-editor-toolbar-form :root [type=url].medium-editor-toolbar-input,.theme-light .medium-editor-toolbar-form :root select.medium-editor-toolbar-input,.theme-light .medium-editor-toolbar-form :root textarea.medium-editor-toolbar-input,.theme-light select.input,.theme-light textarea.input,:root .theme-light .medium-editor-toolbar-form [type=email].medium-editor-toolbar-input,:root .theme-light .medium-editor-toolbar-form [type=file].medium-editor-toolbar-input,:root .theme-light .medium-editor-toolbar-form [type=number].medium-editor-toolbar-input,:root .theme-light .medium-editor-toolbar-form [type=password].medium-editor-toolbar-input,:root .theme-light .medium-editor-toolbar-form [type=text].medium-editor-toolbar-input,:root .theme-light .medium-editor-toolbar-form [type=url].medium-editor-toolbar-input,:root .theme-light .medium-editor-toolbar-form select.medium-editor-toolbar-input,:root .theme-light .medium-editor-toolbar-form textarea.medium-editor-toolbar-input,input.theme-light,select.theme-light,textarea.theme-light{background-color:#fff;border:1px solid #96a8c0;color:#283853}.medium-editor-toolbar-form :root .theme-light [type=email].medium-editor-toolbar-input:focus,.medium-editor-toolbar-form :root .theme-light [type=file].medium-editor-toolbar-input:focus,.medium-editor-toolbar-form :root .theme-light [type=number].medium-editor-toolbar-input:focus,.medium-editor-toolbar-form :root .theme-light [type=password].medium-editor-toolbar-input:focus,.medium-editor-toolbar-form :root .theme-light [type=text].medium-editor-toolbar-input:focus,.medium-editor-toolbar-form :root .theme-light [type=url].medium-editor-toolbar-input:focus,.medium-editor-toolbar-form :root .theme-light select.medium-editor-toolbar-input:focus,.medium-editor-toolbar-form :root .theme-light textarea.medium-editor-toolbar-input:focus,.theme-light .input[type=email]:focus,.theme-light .input[type=file]:focus,.theme-light .input[type=number]:focus,.theme-light .input[type=password]:focus,.theme-light .input[type=text]:focus,.theme-light .input[type=url]:focus,.theme-light .medium-editor-toolbar-form :root [type=email].medium-editor-toolbar-input:focus,.theme-light .medium-editor-toolbar-form :root [type=file].medium-editor-toolbar-input:focus,.theme-light .medium-editor-toolbar-form :root [type=number].medium-editor-toolbar-input:focus,.theme-light .medium-editor-toolbar-form :root [type=password].medium-editor-toolbar-input:focus,.theme-light .medium-editor-toolbar-form :root [type=text].medium-editor-toolbar-input:focus,.theme-light .medium-editor-toolbar-form :root [type=url].medium-editor-toolbar-input:focus,.theme-light .medium-editor-toolbar-form :root select.medium-editor-toolbar-input:focus,.theme-light .medium-editor-toolbar-form :root textarea.medium-editor-toolbar-input:focus,.theme-light select.input:focus,.theme-light textarea.input:focus,:root .theme-light .medium-editor-toolbar-form [type=email].medium-editor-toolbar-input:focus,:root .theme-light .medium-editor-toolbar-form [type=file].medium-editor-toolbar-input:focus,:root .theme-light .medium-editor-toolbar-form [type=number].medium-editor-toolbar-input:focus,:root .theme-light .medium-editor-toolbar-form [type=password].medium-editor-toolbar-input:focus,:root .theme-light .medium-editor-toolbar-form [type=text].medium-editor-toolbar-input:focus,:root .theme-light .medium-editor-toolbar-form [type=url].medium-editor-toolbar-input:focus,:root .theme-light .medium-editor-toolbar-form select.medium-editor-toolbar-input:focus,:root .theme-light .medium-editor-toolbar-form textarea.medium-editor-toolbar-input:focus,input.theme-light:focus,select.theme-light:focus,textarea.theme-light:focus{background-color:#fff}.medium-editor-toolbar-form :root .theme-light [type=email].medium-editor-toolbar-input::-moz-placeholder,.medium-editor-toolbar-form :root .theme-light [type=file].medium-editor-toolbar-input::-moz-placeholder,.medium-editor-toolbar-form :root .theme-light [type=number].medium-editor-toolbar-input::-moz-placeholder,.medium-editor-toolbar-form :root .theme-light [type=password].medium-editor-toolbar-input::-moz-placeholder,.medium-editor-toolbar-form :root .theme-light [type=text].medium-editor-toolbar-input::-moz-placeholder,.medium-editor-toolbar-form :root .theme-light [type=url].medium-editor-toolbar-input::-moz-placeholder,.medium-editor-toolbar-form :root .theme-light select.medium-editor-toolbar-input::-moz-placeholder,.medium-editor-toolbar-form :root .theme-light textarea.medium-editor-toolbar-input::-moz-placeholder,.theme-light .input[type=email]::-moz-placeholder,.theme-light .input[type=file]::-moz-placeholder,.theme-light .input[type=number]::-moz-placeholder,.theme-light .input[type=password]::-moz-placeholder,.theme-light .input[type=text]::-moz-placeholder,.theme-light .input[type=url]::-moz-placeholder,.theme-light .medium-editor-toolbar-form :root [type=email].medium-editor-toolbar-input::-moz-placeholder,.theme-light .medium-editor-toolbar-form :root [type=file].medium-editor-toolbar-input::-moz-placeholder,.theme-light .medium-editor-toolbar-form :root [type=number].medium-editor-toolbar-input::-moz-placeholder,.theme-light .medium-editor-toolbar-form :root [type=password].medium-editor-toolbar-input::-moz-placeholder,.theme-light .medium-editor-toolbar-form :root [type=text].medium-editor-toolbar-input::-moz-placeholder,.theme-light .medium-editor-toolbar-form :root [type=url].medium-editor-toolbar-input::-moz-placeholder,.theme-light .medium-editor-toolbar-form :root select.medium-editor-toolbar-input::-moz-placeholder,.theme-light .medium-editor-toolbar-form :root textarea.medium-editor-toolbar-input::-moz-placeholder,.theme-light select.input::-moz-placeholder,.theme-light textarea.input::-moz-placeholder,:root .theme-light .medium-editor-toolbar-form [type=email].medium-editor-toolbar-input::-moz-placeholder,:root .theme-light .medium-editor-toolbar-form [type=file].medium-editor-toolbar-input::-moz-placeholder,:root .theme-light .medium-editor-toolbar-form [type=number].medium-editor-toolbar-input::-moz-placeholder,:root .theme-light .medium-editor-toolbar-form [type=password].medium-editor-toolbar-input::-moz-placeholder,:root .theme-light .medium-editor-toolbar-form [type=text].medium-editor-toolbar-input::-moz-placeholder,:root .theme-light .medium-editor-toolbar-form [type=url].medium-editor-toolbar-input::-moz-placeholder,:root .theme-light .medium-editor-toolbar-form select.medium-editor-toolbar-input::-moz-placeholder,:root .theme-light .medium-editor-toolbar-form textarea.medium-editor-toolbar-input::-moz-placeholder,input.theme-light::-moz-placeholder,select.theme-light::-moz-placeholder,textarea.theme-light::-moz-placeholder{color:rgba(55,74,104,.5)}.medium-editor-toolbar-form :root .theme-light [type=email].medium-editor-toolbar-input:-ms-input-placeholder,.medium-editor-toolbar-form :root .theme-light [type=file].medium-editor-toolbar-input:-ms-input-placeholder,.medium-editor-toolbar-form :root .theme-light [type=number].medium-editor-toolbar-input:-ms-input-placeholder,.medium-editor-toolbar-form :root .theme-light [type=password].medium-editor-toolbar-input:-ms-input-placeholder,.medium-editor-toolbar-form :root .theme-light [type=text].medium-editor-toolbar-input:-ms-input-placeholder,.medium-editor-toolbar-form :root .theme-light [type=url].medium-editor-toolbar-input:-ms-input-placeholder,.medium-editor-toolbar-form :root .theme-light select.medium-editor-toolbar-input:-ms-input-placeholder,.medium-editor-toolbar-form :root .theme-light textarea.medium-editor-toolbar-input:-ms-input-placeholder,.theme-light .input[type=email]:-ms-input-placeholder,.theme-light .input[type=file]:-ms-input-placeholder,.theme-light .input[type=number]:-ms-input-placeholder,.theme-light .input[type=password]:-ms-input-placeholder,.theme-light .input[type=text]:-ms-input-placeholder,.theme-light .input[type=url]:-ms-input-placeholder,.theme-light .medium-editor-toolbar-form :root [type=email].medium-editor-toolbar-input:-ms-input-placeholder,.theme-light .medium-editor-toolbar-form :root [type=file].medium-editor-toolbar-input:-ms-input-placeholder,.theme-light .medium-editor-toolbar-form :root [type=number].medium-editor-toolbar-input:-ms-input-placeholder,.theme-light .medium-editor-toolbar-form :root [type=password].medium-editor-toolbar-input:-ms-input-placeholder,.theme-light .medium-editor-toolbar-form :root [type=text].medium-editor-toolbar-input:-ms-input-placeholder,.theme-light .medium-editor-toolbar-form :root [type=url].medium-editor-toolbar-input:-ms-input-placeholder,.theme-light .medium-editor-toolbar-form :root select.medium-editor-toolbar-input:-ms-input-placeholder,.theme-light .medium-editor-toolbar-form :root textarea.medium-editor-toolbar-input:-ms-input-placeholder,.theme-light select.input:-ms-input-placeholder,.theme-light textarea.input:-ms-input-placeholder,:root .theme-light .medium-editor-toolbar-form [type=email].medium-editor-toolbar-input:-ms-input-placeholder,:root .theme-light .medium-editor-toolbar-form [type=file].medium-editor-toolbar-input:-ms-input-placeholder,:root .theme-light .medium-editor-toolbar-form [type=number].medium-editor-toolbar-input:-ms-input-placeholder,:root .theme-light .medium-editor-toolbar-form [type=password].medium-editor-toolbar-input:-ms-input-placeholder,:root .theme-light .medium-editor-toolbar-form [type=text].medium-editor-toolbar-input:-ms-input-placeholder,:root .theme-light .medium-editor-toolbar-form [type=url].medium-editor-toolbar-input:-ms-input-placeholder,:root .theme-light .medium-editor-toolbar-form select.medium-editor-toolbar-input:-ms-input-placeholder,:root .theme-light .medium-editor-toolbar-form textarea.medium-editor-toolbar-input:-ms-input-placeholder,input.theme-light:-ms-input-placeholder,select.theme-light:-ms-input-placeholder,textarea.theme-light:-ms-input-placeholder{color:rgba(55,74,104,.5)}.medium-editor-toolbar-form :root .theme-light [type=email].medium-editor-toolbar-input::placeholder,.medium-editor-toolbar-form :root .theme-light [type=file].medium-editor-toolbar-input::placeholder,.medium-editor-toolbar-form :root .theme-light [type=number].medium-editor-toolbar-input::placeholder,.medium-editor-toolbar-form :root .theme-light [type=password].medium-editor-toolbar-input::placeholder,.medium-editor-toolbar-form :root .theme-light [type=text].medium-editor-toolbar-input::placeholder,.medium-editor-toolbar-form :root .theme-light [type=url].medium-editor-toolbar-input::placeholder,.medium-editor-toolbar-form :root .theme-light select.medium-editor-toolbar-input::placeholder,.medium-editor-toolbar-form :root .theme-light textarea.medium-editor-toolbar-input::placeholder,.theme-light .input[type=email]::placeholder,.theme-light .input[type=file]::placeholder,.theme-light .input[type=number]::placeholder,.theme-light .input[type=password]::placeholder,.theme-light .input[type=text]::placeholder,.theme-light .input[type=url]::placeholder,.theme-light .medium-editor-toolbar-form :root [type=email].medium-editor-toolbar-input::placeholder,.theme-light .medium-editor-toolbar-form :root [type=file].medium-editor-toolbar-input::placeholder,.theme-light .medium-editor-toolbar-form :root [type=number].medium-editor-toolbar-input::placeholder,.theme-light .medium-editor-toolbar-form :root [type=password].medium-editor-toolbar-input::placeholder,.theme-light .medium-editor-toolbar-form :root [type=text].medium-editor-toolbar-input::placeholder,.theme-light .medium-editor-toolbar-form :root [type=url].medium-editor-toolbar-input::placeholder,.theme-light .medium-editor-toolbar-form :root select.medium-editor-toolbar-input::placeholder,.theme-light .medium-editor-toolbar-form :root textarea.medium-editor-toolbar-input::placeholder,.theme-light select.input::placeholder,.theme-light textarea.input::placeholder,:root .theme-light .medium-editor-toolbar-form [type=email].medium-editor-toolbar-input::placeholder,:root .theme-light .medium-editor-toolbar-form [type=file].medium-editor-toolbar-input::placeholder,:root .theme-light .medium-editor-toolbar-form [type=number].medium-editor-toolbar-input::placeholder,:root .theme-light .medium-editor-toolbar-form [type=password].medium-editor-toolbar-input::placeholder,:root .theme-light .medium-editor-toolbar-form [type=text].medium-editor-toolbar-input::placeholder,:root .theme-light .medium-editor-toolbar-form [type=url].medium-editor-toolbar-input::placeholder,:root .theme-light .medium-editor-toolbar-form select.medium-editor-toolbar-input::placeholder,:root .theme-light .medium-editor-toolbar-form textarea.medium-editor-toolbar-input::placeholder,input.theme-light::placeholder,select.theme-light::placeholder,textarea.theme-light::placeholder{color:rgba(55,74,104,.5)}:root{--medium-toolbar-color:#131c2a;--medium-font-color:$gray-60;--medium-hover-font-color:$gray-60;--medium-selected-font-color:$gray-70;--medium-toolbar-border-color:$gray-20}:root .medium-editor-element{min-height:inherit}:root .medium-editor-relative-toolbar.medium-editor-toolbar{visibility:visible!important}:root .medium-toolbar-arrow-under:after{top:36px;border-bottom:0;border-top:8px solid var(--medium-font-color)}:root .medium-toolbar-arrow-over:before,:root .medium-toolbar-arrow-under:after{width:0;height:0;border-left:8px solid transparent;border-right:8px solid transparent}:root .medium-toolbar-arrow-over:before{top:-8px;border-bottom:8px solid var(--medium-font-color);border-top:0}:root .medium-editor-toolbar{background-color:transparent;border-top:1px solid transparent;opacity:.3;z-index:500;margin-top:2px}:root .medium-editor-toolbar.medium-editor-stalker-toolbar{background-color:var(--medium-toolbar-color);border:1px solid var(--medium-toolbar-border-color);border-radius:4px;opacity:1}:root .medium-editor-toolbar li{margin:2px;padding:0}:root .medium-editor-toolbar li button{min-width:32px;height:32px;padding:8px;background-color:transparent;border:0;border-radius:0;color:var(--medium-font-color);transition:background-color .3s ease-in;font-size:12px}:root .medium-editor-action{color:var(--medium-font-color);border-top:1px solid transparent}:root .medium-editor-action:hover{color:var(--medium-hover-font-color);border-radius:4px}:root .medium-editor-action.medium-editor-button-active{color:var(--medium-selected-font-color)}:root .medium-editor-focused .medium-editor-toolbar{background-color:var(--medium-toolbar-color);border-top:1px solid var(--medium-toolbar-border-color);opacity:1}:root .medium-editor-compact .medium-editor-toolbar li{margin:0;padding:0}:root .medium-editor-compact .medium-editor-toolbar li button{min-width:30px;height:30px;padding:4px}:root .medium-editor-toolbar-form{padding:4px;border-radius:4px;color:var(--medium-selected-font-color)}:root .medium-editor-toolbar-form .medium-editor-toolbar-input{flex:1;box-sizing:border-box;color:var(--medium-selected-font-color)!important;background-color:var(--medium-toolbar-color)!important}:root .medium-editor-toolbar-form .medium-editor-toolbar-close,:root .medium-editor-toolbar-form .medium-editor-toolbar-save{margin:8px;padding:0;width:auto;height:auto;font-size:1em}:root .medium-editor-toolbar-form a{color:var(--medium-selected-font-color)}:root .medium-editor-toolbar-form-active{display:flex;flex-direction:row;align-items:center}:root .medium-editor-toolbar-anchor-preview{border-radius:4px;border:1px solid var(--medium-font-color);background-color:var(--medium-toolbar-color);color:var(--medium-font-color);font-size:12}:root .medium-editor-placeholder:after{color:var(--medium-font-color)}.theme-dark{--medium-toolbar-color:#131c2a;--medium-font-color:rgba(150,168,192,0.6);--medium-hover-font-color:rgba(150,168,192,0.8);--medium-selected-font-color:#d7e0ea;--medium-toolbar-border-color:#1c2a3f}.theme-light{--medium-toolbar-color:#f9fafd;--medium-font-color:rgba(40,56,83,0.6);--medium-hover-font-color:rgba(40,56,83,0.8);--medium-selected-font-color:#283853;--medium-toolbar-border-color:#d7e0ea}"],encapsulation:2,changeDetection:0}),e})();var ot=i("5+WD"),at=i("0njA"),rt=i("Fh29"),st=i("Qu3c");function ct(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"div",5),ae.Vb(1,"div",6),ae.Qb(2,"app-icon",7),ae.Ub(),ae.Vb(3,"div",8),ae.Vb(4,"app-form-field",9),ae.Qb(5,"app-content-upload-input",10),ae.Ub(),ae.Vb(6,"div",11),ae.Vb(7,"app-form-field",12),ae.Vb(8,"app-rich-text-edit",13,14),ae.Pc(10,"> "),ae.Ub(),ae.Qb(11,"app-character-counter",15),ae.Ub(),ae.Vb(12,"app-form-field",16),ae.Qb(13,"textarea",17),ae.Ub(),ae.Ub(),ae.Ub(),ae.Vb(14,"div",18),ae.Vb(15,"button",19),ae.cc("click",(function(){ae.Cc(e);const i=t.index;return ae.gc().handleRemoveImage(i)})),ae.Qb(16,"app-icon",20),ae.Ub(),ae.Ub(),ae.Ub()}if(2&e){const e=t.$implicit,i=ae.yc(9);ae.mc("formGroup",e),ae.Db(5),ae.mc("canDelete",!1),ae.Db(3),ae.mc("inline",!0)("compact",!0)("rows",1)("maxLength",100),ae.Db(3),ae.mc("field",i)}}let lt=(()=>{class e{constructor(e,t){this.controlContainer=e,this.formBuilder=t}get imageBlockImages(){return this.controlContainer.control.get("images")}ngOnInit(){}handleAddImage(){const e=new Y.b;this.imageBlockImages.push(this.addImage(e))}addImage(e){return this.formBuilder.group({urls:e.urls,alt:[e.alt,G.C.maxLength(200)],caption:[e.caption,G.C.maxLength(200)]})}handleRemoveImage(e){this.imageBlockImages.removeAt(e)}handleImageDrop(e){const{previousIndex:t,currentIndex:i}=e,n=this.imageBlockImages.at(t);this.imageBlockImages.removeAt(t),this.imageBlockImages.insert(i,n)}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(G.b),ae.Pb(G.f))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-edit-images-block"]],decls:7,vars:3,consts:[[3,"formGroup"],[1,"text-14","text-bold","mb-2"],["cdkDropList","","cdkDropListOrientation","vertical","formArrayName","images",3,"cdkDropListDropped"],["cdkDrag","","class","edit-block theme-light",3,"formGroup",4,"ngFor","ngForOf"],["app-button","","buttonType","outline","buttonTheme","light","type","button",1,"w-25",3,"expanded","click"],["cdkDrag","",1,"edit-block","theme-light",3,"formGroup"],["cdkDragHandle","",1,"edit-block__handle"],["icon","grip-lines"],[1,"edit-block__body","flex"],["label","Image",1,"pr-1",2,"flex","0 0 240px"],["type","image","formControlName","urls",3,"canDelete"],[1,"flex-grow"],["label","Label"],["mode","basic","formControlName","caption",3,"inline","compact","rows","maxLength"],["caption",""],[3,"field"],["label","Alt"],["formControlName","alt",1,"input"],[1,"edit-block__actions"],["app-button","","buttonTheme","light","buttonShape","circle","matTooltip","Remove Image",3,"click"],["icon","times"]],template:function(e,t){1&e&&(ae.Tb(0,0),ae.Vb(1,"div",1),ae.Pc(2,"Images"),ae.Ub(),ae.Vb(3,"div",2),ae.cc("cdkDropListDropped",(function(e){return t.handleImageDrop(e)})),ae.Nc(4,ct,17,7,"div",3),ae.Vb(5,"button",4),ae.cc("click",(function(){return t.handleAddImage()})),ae.Pc(6," Add Image "),ae.Ub(),ae.Ub(),ae.Sb()),2&e&&(ae.mc("formGroup",t.controlContainer.control),ae.Db(4),ae.mc("ngForOf",t.imageBlockImages.controls),ae.Db(1),ae.mc("expanded",!0))},directives:[G.s,G.j,ot.c,G.e,n.o,pe.a,ot.a,ot.b,at.a,de.a,rt.a,G.r,G.i,nt,ue.a,G.c,st.c],styles:[".edit-block[_ngcontent-%COMP%]{background:#f9fafd;padding:8px;margin-bottom:8px;display:flex}.edit-block__handle[_ngcontent-%COMP%]{align-items:flex-start;flex:0 0 40px;display:flex;justify-content:center}.edit-block__handle[_ngcontent-%COMP%]:hover{cursor:-webkit-grab;cursor:grab}.edit-block__actions[_ngcontent-%COMP%]{align-items:flex-start;flex:0 0 40px;display:flex;justify-content:center}.edit-block__body[_ngcontent-%COMP%]{flex:1 0 auto}"],changeDetection:0}),e})();var pt=i("1w2z");function dt(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"div",8),ae.Vb(1,"div",9),ae.Qb(2,"app-icon",10),ae.Ub(),ae.Vb(3,"div",11),ae.Vb(4,"app-form-field",12),ae.Qb(5,"app-content-upload-input",13),ae.Ub(),ae.Vb(6,"app-form-field",14),ae.Vb(7,"app-rich-text-edit",15,16),ae.Pc(9,"> "),ae.Ub(),ae.Qb(10,"app-character-counter",17),ae.Ub(),ae.Ub(),ae.Vb(11,"div",18),ae.Vb(12,"button",19),ae.cc("click",(function(){ae.Cc(e);const i=t.index;return ae.gc().handleRemoveImage(i)})),ae.Qb(13,"app-icon",20),ae.Ub(),ae.Ub(),ae.Ub()}if(2&e){const e=t.$implicit,i=ae.yc(8);ae.mc("formGroup",e),ae.Db(5),ae.mc("canDelete",!1),ae.Db(2),ae.mc("inline",!0)("compact",!0)("rows",1)("maxLength",100),ae.Db(3),ae.mc("field",i)}}let ut=(()=>{class e{constructor(e,t){this.controlContainer=e,this.formBuilder=t}get images(){return this.controlContainer.control.get("images")}ngOnInit(){}handleAddImage(){const e=new ie.b;this.images.push(this.addBlock(e))}addBlock(e){return this.formBuilder.group({urls:e.urls,alt:[e.alt,G.C.maxLength(200)],caption:[e.caption,G.C.maxLength(200)]})}handleRemoveImage(e){this.images.removeAt(e)}handleImageDrop(e){const{previousIndex:t,currentIndex:i}=e,n=this.images.at(t);this.images.removeAt(t),this.images.insert(i,n)}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(G.b),ae.Pb(G.f))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-edit-ticker-block"]],decls:12,vars:3,consts:[[3,"formGroup"],[1,"text-14","text-bold","mb-2"],["label","Loop Image",1,"flex-grow"],["formControlName","loopImage",1,"text-12"],["form-field-help",""],["cdkDropList","","cdkDropListOrientation","vertical","formArrayName","images",3,"cdkDropListDropped"],["cdkDrag","","class","edit-block theme-light",3,"formGroup",4,"ngFor","ngForOf"],["app-button","","buttonType","outline","buttonTheme","light","type","button",1,"w-25",3,"expanded","click"],["cdkDrag","",1,"edit-block","theme-light",3,"formGroup"],["cdkDragHandle","",1,"edit-block__handle"],["icon","grip-lines"],[1,"edit-block__body","flex"],["label","Image",1,"pr-1",2,"flex","0 0 240px"],["type","image","formControlName","urls",3,"canDelete"],["label","Label",1,"flex-grow"],["mode","basic","formControlName","caption",3,"inline","compact","rows","maxLength"],["caption",""],[3,"field"],[1,"edit-block__actions"],["app-button","","buttonTheme","light","buttonShape","circle","matTooltip","Remove Image",3,"click"],["icon","times"]],template:function(e,t){1&e&&(ae.Tb(0,0),ae.Vb(1,"div",1),ae.Pc(2,"Ticker"),ae.Ub(),ae.Vb(3,"app-form-field",2),ae.Vb(4,"mat-checkbox",3),ae.Pc(5,"Loop"),ae.Ub(),ae.Tb(6,4),ae.Pc(7," Creates the appearance of a continuous uninterrupted image "),ae.Sb(),ae.Ub(),ae.Vb(8,"div",5),ae.cc("cdkDropListDropped",(function(e){return t.handleImageDrop(e)})),ae.Nc(9,dt,14,7,"div",6),ae.Vb(10,"button",7),ae.cc("click",(function(){return t.handleAddImage()})),ae.Pc(11," Add Ticker Image "),ae.Ub(),ae.Ub(),ae.Sb()),2&e&&(ae.mc("formGroup",t.controlContainer.control),ae.Db(9),ae.mc("ngForOf",t.images.controls),ae.Db(1),ae.mc("expanded",!0))},directives:[G.s,G.j,de.a,ge.a,G.r,G.i,ot.c,G.e,n.o,pe.a,ot.a,ot.b,at.a,rt.a,nt,ue.a,st.c],styles:[".edit-block[_ngcontent-%COMP%]{background:#f9fafd;padding:8px;margin-bottom:8px;display:flex}.edit-block__handle[_ngcontent-%COMP%]{align-items:flex-start;flex:0 0 40px;display:flex;justify-content:center}.edit-block__handle[_ngcontent-%COMP%]:hover{cursor:-webkit-grab;cursor:grab}.edit-block__actions[_ngcontent-%COMP%]{align-items:flex-start;flex:0 0 40px;display:flex;justify-content:center}.edit-block__body[_ngcontent-%COMP%]{flex:1 0 auto}"],changeDetection:0}),e})();var ht=i("R9Cn");let mt=(()=>{class e{constructor(e){this.changeDetectorRef=e,this.colorPosition="left",this.useRootContainer=!0,this.dataTestAttributeVal="",this.type="hex",this.decimal=!0,this.alpha=!1,this.disabled=!1,this.onChange=()=>{},this.onTouched=()=>{},this.propagateChange=e=>{}}get value(){return this.getColorFromHex(this._value)}set value(e){const t=this.getHexFromColor(e);t!==this._value&&(this._value=t,this.propagateChange(e),this.changeDetectorRef.markForCheck())}get hexValue(){return this._value}ngOnInit(){}handleColorPickerChange(e){this.value=this.getColorFromHex(e),this.changeDetectorRef.markForCheck()}writeValue(e){this.value=e}registerOnChange(e){this.propagateChange=e}registerOnTouched(e){this.onTouched=e}setDisabledState(e){this.disabled=e}getColorFromHex(e){return"rgb"===this.type?Z.a.hexToRgb(e,this.decimal):"rgba"===this.type?Z.a.hexToRgba(e,this.decimal):e}getHexFromColor(e){if(Array.isArray(e)){const[t,i,n,o]=e;return 4===e.length?Z.a.rgbaToHex([t,i,n,o],this.decimal):Z.a.rgbToHex([t,i,n],this.decimal)}return e.toString()}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(ae.i))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-color-picker-input"]],inputs:{value:"value",colorPosition:"colorPosition",useRootContainer:"useRootContainer",dataTestAttributeVal:"dataTestAttributeVal",type:"type",decimal:"decimal",alpha:"alpha"},features:[ae.Cb([{provide:G.p,useExisting:Object(ae.W)(()=>e),multi:!0}])],decls:3,vars:9,consts:[[1,"color-picker-input"],["type","text","cpOutputFormat","hex",1,"input","color-picker-input__input",3,"disabled","value","colorPicker","cpAlphaChannel","cpUseRootViewContainer","cpPosition","colorPickerChange"],[1,"color-picker-input__color"]],template:function(e,t){1&e&&(ae.Vb(0,"div",0),ae.Vb(1,"input",1),ae.cc("colorPickerChange",(function(e){return t.handleColorPickerChange(e)})),ae.Ub(),ae.Qb(2,"div",2),ae.Ub()),2&e&&(ae.Db(1),ae.mc("disabled",t.disabled)("value",t.hexValue)("colorPicker",t.hexValue)("cpAlphaChannel",t.alpha?"always":"disabled")("cpUseRootViewContainer",t.useRootContainer)("cpPosition",t.colorPosition),ae.Eb("data-test",t.dataTestAttributeVal),ae.Db(1),ae.Kc("background",t.hexValue))},directives:[ht.a],styles:[".color-picker-input[_ngcontent-%COMP%]{position:relative}.color-picker-input__input[_ngcontent-%COMP%]{padding-right:36px;width:100%}.color-picker-input__color[_ngcontent-%COMP%]{pointer-events:none;border:1px solid #1b283c;display:block;position:absolute;right:6px;top:6px;z-index:10;height:24px;width:24px;border-radius:50%}.theme-light[_nghost-%COMP%]   .color-picker-input__color[_ngcontent-%COMP%], .theme-light   [_nghost-%COMP%]   .color-picker-input__color[_ngcontent-%COMP%]{border-color:#96a8c0}"],changeDetection:0}),e})();var bt=i("QibW"),gt=i("yIGu"),ft=i("F+jD"),xt=function(e,t,i,n){var o,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,i,r):o(t,i))||r);return a>3&&r&&Object.defineProperty(t,i,r),r},yt=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const vt=["lightLibInput"],Ct=function(e){return{"content__section--selected":e}};function Pt(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"div",7),ae.cc("click",(function(){ae.Cc(e);const i=t.$implicit;return ae.gc().handleChapterClick(i)})),ae.Vb(1,"div",13),ae.Pc(2),ae.Ub(),ae.Vb(3,"div",8),ae.Pc(4),ae.Ub(),ae.Ub()}if(2&e){const e=t.$implicit,i=t.index,n=ae.gc();ae.mc("ngClass",ae.pc(3,Ct,e.id===n.selectedChapterId)),ae.Db(2),ae.Rc("",i+1,"."),ae.Db(2),ae.Rc(" ",e.info.displayName||"-No Title-"," ")}}function Ot(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"button",22),ae.cc("click",(function(){return ae.Cc(e),ae.gc(2).handleClearTagsSelectionClick()})),ae.Pc(1," Clear Tags "),ae.Ub()}}function wt(e,t){if(1&e&&(ae.Vb(0,"div",39),ae.Vb(1,"mat-checkbox",40),ae.Pc(2),ae.Ub(),ae.Ub()),2&e){const e=t.$implicit;ae.mc("formGroupName",t.index),ae.Db(2),ae.Rc(" ",e.get("tag").value," ")}}const kt=function(e){return{"content__check-group--split":e}};function St(e,t){if(1&e&&(ae.Vb(0,"app-panel",36),ae.Vb(1,"div",37),ae.Nc(2,wt,3,2,"div",38),ae.Ub(),ae.Ub()),2&e){const e=t.$implicit;ae.mc("formGroupName",t.index)("label",e.get("title").value)("isCompact",!0),ae.Db(1),ae.mc("ngClass",ae.pc(5,kt,e.get("tags").controls.length>=3)),ae.Db(1),ae.mc("ngForOf",e.get("tags").controls)}}function _t(e,t){if(1&e&&(ae.Vb(0,"div"),ae.Pc(1),ae.Ub()),2&e){const e=t.$implicit;ae.Db(1),ae.Rc(" ",e," ")}}function Mt(e,t){if(1&e){const e=ae.Wb();ae.Tb(0),ae.Vb(1,"div",23),ae.Nc(2,St,3,7,"app-panel",24),ae.Ub(),ae.Qb(3,"mat-divider",25),ae.Vb(4,"div",26),ae.Vb(5,"div",27),ae.Pc(6,"Asset Libraries"),ae.Ub(),ae.Vb(7,"div",28),ae.Pc(8,"Any unused libraries will be removed during save."),ae.Ub(),ae.Vb(9,"app-panel",29),ae.Vb(10,"div",30),ae.Nc(11,_t,2,1,"div",31),ae.hc(12,"async"),ae.Ub(),ae.Vb(13,"div",32),ae.Vb(14,"input",33,34),ae.cc("input",(function(){return ae.Cc(e),ae.gc(2).checkGetLightLib()})),ae.Ub(),ae.Vb(16,"button",35),ae.cc("click",(function(){return ae.Cc(e),ae.gc(2).handleLoadLightsLib()})),ae.Pc(17," Load Library "),ae.Ub(),ae.Ub(),ae.Ub(),ae.Ub(),ae.Sb()}if(2&e){const e=ae.gc(2);ae.Db(2),ae.mc("ngForOf",e.tagCategories.controls),ae.Db(9),ae.mc("ngForOf",ae.ic(12,3,e.story$).assetLibraries.lights),ae.Db(5),ae.mc("disabled",e.disableGetLightLib)}}function Ut(e,t){if(1&e&&(ae.Vb(0,"div",14),ae.Vb(1,"form",15),ae.Vb(2,"app-form-field",16),ae.Qb(3,"input",17,18),ae.Qb(5,"app-character-counter",19),ae.Ub(),ae.Nc(6,Ot,2,0,"button",20),ae.Nc(7,Mt,18,5,"ng-container",21),ae.Ub(),ae.Ub()),2&e){const e=ae.yc(4),t=ae.gc();ae.Db(1),ae.mc("formGroup",t.bookmarkForm),ae.Db(4),ae.mc("field",e)}}function Tt(e,t){if(1&e&&(ae.Tb(0),ae.Qb(1,"app-edit-images-block",41),ae.Qb(2,"mat-divider",47),ae.Sb()),2&e){const e=ae.gc().$implicit;ae.Db(1),ae.mc("formGroup",e)}}function Vt(e,t){if(1&e&&(ae.Tb(0),ae.Qb(1,"app-edit-ticker-block",41),ae.Qb(2,"mat-divider",47),ae.Sb()),2&e){const e=ae.gc(2).$implicit;ae.Db(1),ae.mc("formGroup",e)}}function Dt(e,t){if(1&e&&(ae.Tb(0),ae.Nc(1,Vt,3,1,"ng-container",57),ae.Sb()),2&e){const e=ae.gc(3);ae.Db(1),ae.mc("appFlagApplication",e.environmentApplication.Loft)}}function Et(e,t){1&e&&(ae.Vb(0,"div",55),ae.Nc(1,Tt,3,1,"ng-container",56),ae.Nc(2,Dt,2,1,"ng-container",56),ae.Ub()),2&e&&(ae.mc("ngSwitch",t.$implicit.value.type),ae.Db(1),ae.mc("ngSwitchCase","images"),ae.Db(1),ae.mc("ngSwitchCase","ticker"))}function jt(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"div",58),ae.Qb(1,"app-color-picker-input",59),ae.Qb(2,"input",60),ae.Vb(3,"button",61),ae.cc("click",(function(){ae.Cc(e);const i=t.index;return ae.gc(2).handleRemoveLegendItem(i)})),ae.Qb(4,"app-icon",62),ae.Ub(),ae.Ub()}2&e&&(ae.mc("formGroupName",t.index),ae.Db(1),ae.mc("useRootContainer",!1))}function Nt(e,t){if(1&e&&(ae.Vb(0,"option",83),ae.Pc(1),ae.Ub()),2&e){const e=t.$implicit;ae.mc("value",e.lang),ae.Db(1),ae.Rc(" ",e.title," ")}}function Rt(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"div",78),ae.Vb(1,"div",79),ae.Vb(2,"select",80),ae.cc("change",(function(i){ae.Cc(e);const n=t.index;return ae.gc(3).handleAudioItemChange(i,n)})),ae.Nc(3,Nt,2,2,"option",77),ae.Ub(),ae.Vb(4,"div",25),ae.Vb(5,"app-content-upload-input",81),ae.cc("uploadSuccess",(function(i){ae.Cc(e);const n=t.index;return ae.gc(3).onAudioFileSuccess(i,n)})),ae.Ub(),ae.Ub(),ae.Ub(),ae.Vb(6,"button",82),ae.cc("click",(function(){ae.Cc(e);const i=t.index;return ae.gc(3).handleRemoveAudioItem(i)})),ae.Qb(7,"app-icon",62),ae.Ub(),ae.Ub()}if(2&e){const e=t.index,i=ae.gc(3);ae.mc("formGroupName",e),ae.Db(3),ae.mc("ngForOf",i.locales),ae.Db(2),ae.mc("canDelete",!1)}}function At(e,t){1&e&&ae.Qb(0,"mat-divider",84),2&e&&ae.mc("vertical",!0)}function Ft(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"div",85),ae.Vb(1,"div",27),ae.Pc(2," Animation "),ae.Vb(3,"button",86),ae.cc("click",(function(){return ae.Cc(e),ae.gc(3).applyAnimationsToAll()})),ae.Qb(4,"app-icon",68),ae.Ub(),ae.Ub(),ae.Vb(5,"div",87),ae.Vb(6,"app-form-field",88),ae.Vb(7,"mat-radio-group",89),ae.Vb(8,"app-list",71),ae.Vb(9,"app-list-item"),ae.Vb(10,"mat-radio-button",83),ae.Pc(11,"Play once"),ae.Ub(),ae.Ub(),ae.Vb(12,"app-list-item"),ae.Vb(13,"mat-radio-button",83),ae.Pc(14,"Play indefinitely"),ae.Ub(),ae.Ub(),ae.Ub(),ae.Ub(),ae.Qb(15,"mat-divider",90),ae.Vb(16,"mat-checkbox",91),ae.Pc(17," Autoplay "),ae.Ub(),ae.Ub(),ae.Vb(18,"app-form-field",92),ae.Tb(19,93),ae.Vb(20,"span",94),ae.Pc(21,"Note:"),ae.Ub(),ae.Pc(22," Save to preview changes in Viewer. "),ae.Sb(),ae.Vb(23,"mat-radio-group",95),ae.Vb(24,"app-list",71),ae.Vb(25,"app-list-item"),ae.Vb(26,"mat-radio-button",96),ae.Pc(27,"None"),ae.Ub(),ae.Ub(),ae.Vb(28,"app-list-item"),ae.Vb(29,"mat-radio-button",97),ae.Pc(30,"Play/Pause"),ae.Ub(),ae.Ub(),ae.Vb(31,"app-list-item"),ae.Vb(32,"mat-radio-button",98),ae.Pc(33,"Scrubber"),ae.Ub(),ae.Ub(),ae.Ub(),ae.Ub(),ae.Ub(),ae.Ub(),ae.Ub()}2&e&&(ae.Db(10),ae.mc("value",1),ae.Db(3),ae.mc("value",-1))}function It(e,t){if(1&e&&(ae.Vb(0,"option",83),ae.Pc(1),ae.Ub()),2&e){const e=t.$implicit;ae.mc("value",e),ae.Db(1),ae.Rc(" ",e," ")}}function zt(e,t){if(1&e){const e=ae.Wb();ae.Tb(0),ae.Qb(1,"mat-divider",25),ae.Vb(2,"div",26),ae.Vb(3,"div",27),ae.Pc(4,"Audio"),ae.Ub(),ae.Vb(5,"div",63),ae.Nc(6,Rt,8,3,"div",64),ae.Ub(),ae.Vb(7,"button",54),ae.cc("click",(function(){return ae.Cc(e),ae.gc(2).handleAddAudioItem()})),ae.Pc(8," Add Audio "),ae.Ub(),ae.Ub(),ae.Qb(9,"mat-divider",25),ae.Vb(10,"div",65),ae.Vb(11,"div",66),ae.Vb(12,"div",27),ae.Pc(13," Transitions "),ae.Vb(14,"button",67),ae.cc("click",(function(){return ae.Cc(e),ae.gc(2).applyTransitionsToAll()})),ae.Qb(15,"app-icon",68),ae.Ub(),ae.Ub(),ae.Vb(16,"app-form-field",69),ae.Vb(17,"mat-radio-group",70),ae.Vb(18,"app-list",71),ae.Vb(19,"app-list-item"),ae.Vb(20,"mat-radio-button",72),ae.Pc(21,"Fly To"),ae.Ub(),ae.Ub(),ae.Vb(22,"app-list-item"),ae.Vb(23,"mat-radio-button",73),ae.Pc(24,"Jump To"),ae.Ub(),ae.Ub(),ae.Ub(),ae.Ub(),ae.Ub(),ae.Ub(),ae.Nc(25,At,1,1,"mat-divider",74),ae.Nc(26,Ft,34,2,"div",75),ae.Ub(),ae.Qb(27,"mat-divider",25),ae.Vb(28,"div",26),ae.Vb(29,"div",27),ae.Pc(30,"Lights"),ae.Ub(),ae.Vb(31,"select",76),ae.cc("change",(function(){return ae.Cc(e),ae.gc(2).handleLightsChange()})),ae.Nc(32,It,2,2,"option",77),ae.hc(33,"async"),ae.Ub(),ae.Ub(),ae.Sb()}if(2&e){const e=ae.gc(2);ae.Db(6),ae.mc("ngForOf",e.audio.controls),ae.Db(1),ae.mc("expanded",!0),ae.Db(18),ae.mc("ngIf",e.selectedChapterAnimated),ae.Db(1),ae.mc("ngIf",e.selectedChapterAnimated),ae.Db(6),ae.mc("ngForOf",ae.ic(33,5,e.story$).assetLibraries.lights)}}function Lt(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"div",14),ae.Vb(1,"form",41),ae.Vb(2,"app-form-field",42),ae.Qb(3,"input",43,18),ae.Qb(5,"app-character-counter",19),ae.Ub(),ae.Vb(6,"app-form-field",44),ae.Qb(7,"app-rich-text-edit",45,46),ae.Qb(9,"app-character-counter",19),ae.Ub(),ae.Qb(10,"mat-divider",47),ae.Tb(11,48),ae.Nc(12,Et,3,3,"div",49),ae.Sb(),ae.Vb(13,"div",50),ae.Vb(14,"div",27),ae.Pc(15,"Legend"),ae.Ub(),ae.Vb(16,"app-form-field",51),ae.Vb(17,"div",52),ae.cc("cdkDropListDropped",(function(t){return ae.Cc(e),ae.gc().handleLegendItemDrop(t)})),ae.Nc(18,jt,5,2,"div",53),ae.Ub(),ae.Ub(),ae.Vb(19,"button",54),ae.cc("click",(function(){return ae.Cc(e),ae.gc().handleAddLegendItem()})),ae.Pc(20," Add Legend "),ae.Ub(),ae.Ub(),ae.Nc(21,zt,34,7,"ng-container",21),ae.Ub(),ae.Ub()}if(2&e){const e=ae.yc(4),t=ae.yc(8),i=ae.gc();ae.Db(1),ae.mc("formGroup",i.chapterForm),ae.Db(4),ae.mc("field",e),ae.Db(2),ae.mc("inline",!0)("resizeable",!1)("rows",16)("maxLength",1e4),ae.Db(2),ae.mc("field",t),ae.Db(3),ae.mc("ngForOf",i.contentBlocks.controls),ae.Db(6),ae.mc("ngForOf",i.legend.controls),ae.Db(1),ae.mc("expanded",!0)}}let Bt=(()=>{class e{constructor(e,t,i,n,o,a,r,s){this.formBuilder=e,this.dialogRef=t,this.data=i,this.store=n,this.animationService=o,this.mediaService=a,this.engineService=r,this.snackbar=s,this.environmentApplication=ne.a,this.locales=oe.d,this.ngUnsubscribe=new c.a,this.disableGetLightLib=!0}get tagCategories(){return this.bookmarkForm.get("tagCategories")}get legend(){return this.chapterForm.get("legend")}get audio(){return this.chapterForm.get("audio")}ngOnInit(){this.initBookmarkForm(),this.initChaptersForm()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initBookmarkForm(){this.bookmarkForm=this.formBuilder.group({displayName:["",[G.C.maxLength(60),G.C.required]],tagCategories:new G.d([])});const e=this.store.selectSnapshot(B.a.getSelectedBookmark),t=this.store.selectSnapshot(y.a.getStory);this.setBookmarkFormValues(e,t),this.bookmarkForm.valueChanges.pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(()=>{this.handleBookmarkFormChanges()})}initChaptersForm(){this.chapterForm=this.formBuilder.group({displayName:["",G.C.maxLength(60)],description:["",G.C.maxLength(1e4)],contentBlocks:new G.d([]),cameraAction:[""],playCount:[""],autoplay:[""],mediaControls:[""],legend:new G.d([]),audio:new G.d([]),lights:[""]}),this.chapters=this.store.selectSnapshot(F.a.getStoryChapters),this.selectChapter(this.data.chapterId?this.data.chapterId:this.chapters[0].id),this.chapterForm.valueChanges.pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(()=>{this.handleChapterFormChanges()})}handleModuleClick(){this.selectChapter("")}handleChapterClick(e){this.selectChapter(e.id)}selectChapter(e){this.selectedChapterId=e,this.selectedChapter=this.store.selectSnapshot(F.a.getStoryChapters).find(t=>t.id===e),this.selectedChapterAnimated=this.selectedChapter&&this.animationService.isChapterAnimated(this.selectedChapter),this.selectedChapter&&this.setChapterFormValues(this.selectedChapter)}handleChapterFormChanges(){const e=this.store.selectSnapshot(F.a.getStoryChapters),t=e.findIndex(e=>e.id===this.selectedChapterId),i=e[t],{displayName:n,contentBlocks:o,description:a,cameraAction:r,legend:s}=this.chapterForm.value;this.store.dispatch(new A.x(i.id,{displayName:n,description:a})),this.store.dispatch(new A.v(i.id,this.filterEmptyContentBlocks(o))),this.store.dispatch(new A.t(i.id,r)),this.store.dispatch(new A.G(i.id,this.getFormUIConfig(i))),this.store.dispatch(new A.y(i.id,this.createLegendFromInputs(s)))}handleBookmarkFormChanges(){const e=this.bookmarkForm.get("displayName").value,t=this.bookmarkForm.get("tagCategories").value.reduce((e,t)=>e.concat(this.getSelectedTagsByCategory(t)),[]);this.store.dispatch(new V.r(e)),this.store.dispatch(new L.E(e)),this.store.dispatch(new V.q(t))}setChapterFormValues(e){const{description:t,displayName:i}=e.info,n=e.contentBlocks,o=n.find(e=>e.type===ee.a.Images)||new Y.a,a=n.find(e=>e.type===ee.a.Ticker)||new ie.a,r=[o,a];this.contentBlocks.setControl(0,this.newImagesBlockFormGroup(o)),this.contentBlocks.setControl(1,this.newTickerBlockFormGroup(a));const s=e.camera.action||"flyTo",c=Object(W.get)(e,"ui.play.count",1),l=Object(W.get)(e,"ui.play.autoplay",!0),p=Object(W.get)(e,"ui.config",{mediaControls:X.a.Full}),d=Object(J.g)(p.playPause,p.scrubber,p.mediaControls),u=e.legend||[],h=this.chapterForm.get("legend");h.clear();const m=this.createInputsFromLegend(u);m.forEach(e=>{h.push(this.formBuilder.group(e))});const b=this.chapterForm.get("audio");b.clear();const g=this.createAudioInputs();g.forEach(e=>{b.push(this.formBuilder.group(e))});const f=Object(W.get)(e,"lights.libraries[0]");this.chapterForm.setValue({displayName:i,description:t,contentBlocks:r,cameraAction:s,playCount:c,autoplay:l,mediaControls:d,legend:m,audio:g,lights:f})}setBookmarkFormValues(e,t){const i=e.title,n=t.tags||[],o=this.getTagCategories(n),a=this.createTagCategorySelections(o,n),r=this.bookmarkForm.get("tagCategories");r.clear(),a.forEach(e=>{const t=this.formBuilder.group({title:"",tags:this.formBuilder.array(e.tags.map(e=>this.formBuilder.group(e)))});r.push(t)}),this.bookmarkForm.setValue({displayName:i,tagCategories:a})}closeDialog(){this.dialogRef.close(this.chapters)}applyTransitionsToAll(){const{cameraAction:e}=this.chapterForm.value,t=this.chapters.map(t=>new A.t(t.id,e));this.store.dispatch(t),this.snackbar.open("Transition properties applied to all chapters.")}applyAnimationsToAll(){const e=this.chapters.map(e=>new A.G(e.id,this.getFormUIConfig(e)));this.store.dispatch(e),this.snackbar.open("Animation properties applied to all chapters.")}getFormUIConfig(e){const{playCount:t,autoplay:i,mediaControls:n}=this.chapterForm.value;return{play:{count:t,autoplay:i},config:Object.assign(Object.assign({},e.ui.config),{mediaControls:n})}}handleClearTagsSelectionClick(){this.setAllTagSelections(!1)}setAllTagSelections(e){const t=this.bookmarkForm.get("tagCategories").value,i=Object(W.cloneDeep)(t);i.forEach(t=>{t.tags.forEach(t=>t.checked=e)}),this.bookmarkForm.patchValue({tagCategories:i})}getAllTagsList(e){const t=[...Object.values(K.a).reduce((e,t)=>e.concat(t.tags),[]),...e];return[...new Set(t)].sort()}getTagCategories(e){const t=Object.values(K.a).reduce((e,t)=>[...e,...t.tags],[]),i=e.filter(e=>!t.includes(e));return i.length>0?[...K.a,{title:"Misc",tags:i}]:[...K.a]}getSelectedTagsByCategory(e){return e.tags.filter(e=>e.checked).map(e=>e.tag)}createTagCategorySelections(e,t){return e.map(e=>({title:e.title,tags:e.tags.map(e=>({tag:e,checked:t.includes(e)})).sort((e,t)=>e.tag.toLowerCase()<t.tag.toLowerCase()?-1:1)}))}handleAddLegendItem(){this.store.dispatch(new A.a(this.selectedChapterId,{label:"",colors:[1,0,0]})),this.selectChapter(this.selectedChapterId)}handleRemoveLegendItem(e){const t=[...this.store.selectSnapshot(F.a.getChapter(this.selectedChapterId)).legend]||!1;t.splice(e,1),this.store.dispatch(new A.y(this.selectedChapterId,t)),this.selectChapter(this.selectedChapterId)}handleLegendItemDrop(e){const{previousIndex:t,currentIndex:i}=e,n=this.store.selectSnapshot(F.a.getChapter(this.selectedChapterId)).legend||[],o=Object(te.a)(n,t,i);this.store.dispatch(new A.y(this.selectedChapterId,o)),this.selectChapter(this.selectedChapterId)}createInputsFromLegend(e){return e.map(e=>{const{label:t,colors:i}=e;return{label:t,color:Z.a.rgbToHex(i,!0)}})}createLegendFromInputs(e){return e.map(e=>{const{label:t,color:i}=e;return{label:t,colors:Z.a.hexToRgb(i,!0)}})}createAudioInputs(){return this.mediaService.getAudioClips(this.selectedChapter.media).map(e=>({clipId:e.data.clipId,lang:e.data.lang,fullUrl:e.data.fullUrl}))}handleAddAudioItem(){const e=this.formBuilder.group({clipId:"",lang:"en",fullUrl:""});this.audio.push(e)}onAudioFileSuccess(e,t){const i=this.audio.at(t).value,[n,o]=this.mediaService.createAudioClip(this.selectedChapter,e,i.lang),a=Object.assign({},this.selectedChapter.media);a[n]=o,this.store.dispatch(new A.A(this.selectedChapterId,a)),this.selectChapter(this.selectedChapterId),this.snackbar.open(`Successfully added ${e}.`)}handleAudioItemChange(e,t){const i=this.audio.at(t).value;i.clipId&&this.updateAudioLang(i.clipId,i.lang)}updateAudioLang(e,t){const i=Object.assign({},this.selectedChapter.media);i[e].data.lang=t,this.store.dispatch(new A.A(this.selectedChapterId,i))}handleRemoveAudioItem(e){const t=this.audio.at(e).value;t.clipId?this.deleteAudio(t.clipId):this.audio.removeAt(e)}deleteAudio(e){const t=Object.assign({},this.selectedChapter.media);delete t[e],this.store.dispatch(new A.A(this.selectedChapterId,t)),this.selectChapter(this.selectedChapterId),this.snackbar.open("Successfully deleted audio clip.")}get contentBlocks(){return this.chapterForm.get("contentBlocks")}newImagesBlockFormGroup(e){return this.formBuilder.group({type:"images",images:this.formBuilder.array(e.images.map(e=>this.formBuilder.group({urls:e.urls,alt:[e.alt,G.C.maxLength(200)],caption:[e.caption,G.C.maxLength(200)]})))})}newTickerBlockFormGroup(e){return this.formBuilder.group({type:"ticker",loopImage:!1,images:this.formBuilder.array(e.images.map(e=>this.formBuilder.group({urls:e.urls,alt:[e.alt,G.C.maxLength(200)],caption:[e.caption,G.C.maxLength(200)]})))})}filterEmptyContentBlocks(e){return e.filter(e=>{switch(e.type){case ee.a.Markdown:return e.markdown.length>0;case ee.a.Images:case ee.a.Ticker:return e.images.length>0}})}checkGetLightLib(){this.disableGetLightLib=0===this.lightLibInput.nativeElement.value.length}handleLightsChange(){const e=this.chapterForm.get("lights").value;this.store.dispatch(new A.z(this.selectedChapter.id,e))}handleLoadLightsLib(){const e=this.lightLibInput.nativeElement.value;let t=this.store.selectSnapshot(y.a.getStory).assetLibraries.lights;t.includes(e)?this.snackbar.open(e+" is already loaded."):this.engineService.loadLightLib(e).then(()=>{t=[...t,e],this.store.dispatch(new V.p(t)),this.snackbar.open(`Successfully loaded ${e}.`)},()=>{this.snackbar.open(`Unable to load ${e}.`)}).finally(()=>{this.lightLibInput.nativeElement.value="",this.disableGetLightLib=!0})}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(G.f),ae.Pb(H.g),ae.Pb(H.a),ae.Pb(r.h),ae.Pb(re.a),ae.Pb(se.a),ae.Pb(ce.a),ae.Pb(le.b))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-content-dialog"]],viewQuery:function(e,t){if(1&e&&ae.Vc(vt,!0),2&e){let e;ae.xc(e=ae.dc())&&(t.lightLibInput=e.first)}},decls:23,vars:11,consts:[[1,"content","theme-light"],[1,"content__header"],[1,"text-20","text-semibold"],[1,"content__body"],[1,"content__sections"],[1,"mb-2"],[1,"content__section-label"],[1,"content__section",3,"ngClass","click"],[1,"content__title"],["class","content__section",3,"ngClass","click",4,"ngFor","ngForOf"],["class","content__editor",4,"ngIf"],[1,"content__footer"],["app-button","","buttonType","primary","buttonTheme","light","type","button",3,"mat-dialog-close"],[1,"content__index"],[1,"content__editor"],[1,"theme-light",3,"formGroup"],["label","Model Title"],["type","text","formControlName","displayName","maxlength","60","placeholder","e.g. Human Heart",1,"input"],["displayName",""],[3,"field"],["app-button","","buttonTheme","light","buttonType","outline","buttonSize","small","class","mv-4",3,"click",4,"appFlagInternal"],[4,"appFlagInternal"],["app-button","","buttonTheme","light","buttonType","outline","buttonSize","small",1,"mv-4",3,"click"],["formArrayName","tagCategories"],[3,"formGroupName","label","isCompact",4,"ngFor","ngForOf"],[1,"mv-4"],[1,"text-12","pv-2"],[1,"text-14","text-bold","mb-2"],[1,"text-12","mb-2"],["label","Lights"],[1,"mb-4"],[4,"ngFor","ngForOf"],[1,"flex"],["type","text","placeholder","Enter a library in the form <stateName>/<directoryName>",1,"input",3,"input"],["lightLibInput",""],["app-button","","buttonTheme","light","buttonType","outline","buttonSize","medium",1,"flex-none","ml-3",3,"disabled","click"],[3,"formGroupName","label","isCompact"],["formArrayName","tags",1,"content__check-group",3,"ngClass"],[3,"formGroupName",4,"ngFor","ngForOf"],[3,"formGroupName"],["formControlName","checked"],[3,"formGroup"],["label","Chapter Title"],["type","text","formControlName","displayName","maxlength","60",1,"input","w-100"],["label","Chapter Description"],["formControlName","description",3,"inline","resizeable","rows","maxLength"],["description",""],[1,"mv-8"],["formArrayName","contentBlocks"],[3,"ngSwitch",4,"ngFor","ngForOf"],[1,"text-12"],["formArrayName","legend"],["cdkDropList","","cdkDropListOrientation","vertical",3,"cdkDropListDropped"],["class","flex flex-row mv-1 theme-light items-center","cdkDrag","",3,"formGroupName",4,"ngFor","ngForOf"],["app-button","","buttonType","outline","buttonTheme","light","type","button",1,"w-25",3,"expanded","click"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"appFlagApplication"],["cdkDrag","",1,"flex","flex-row","mv-1","theme-light","items-center",3,"formGroupName"],["formControlName","color",3,"useRootContainer"],["type","text","formControlName","label","placeholder","Legend label",1,"input","ml-2"],["app-button","","buttonType","text","buttonTheme","light","type","button","matTooltip","Remove",1,"mr-2",3,"click"],["icon","times"],["formArrayName","audio"],["class","flex flex-row mv-1 theme-light items-center",3,"formGroupName",4,"ngFor","ngForOf"],[1,"content__properties","text-12","pv-2"],[1,"flex","flex-column"],["app-button","","buttonTheme","light","buttonType","text","matTooltip","Apply transition to all chapters","matTooltipPosition","above","title","Apply transition to all chapters",3,"click"],["icon","copy"],["label","Chapter Transition"],["formControlName","cameraAction",1,"content__group"],["listType","flat"],["value","flyTo"],["value","jumpTo"],[3,"vertical",4,"ngIf"],["class","flex flex-column ml-2",4,"ngIf"],["formControlName","lights",1,"input","w-auto",3,"change"],[3,"value",4,"ngFor","ngForOf"],[1,"flex","flex-row","mv-1","theme-light","items-center",3,"formGroupName"],[1,"flex","flex-column","flex-grow"],["formControlName","lang",1,"input","content__audio-language",3,"change"],["type","audio","formControlName","fullUrl",3,"canDelete","uploadSuccess"],["app-button","","buttonType","text","buttonTheme","light","type","button","matTooltip","Remove Audio",1,"mr-2",3,"click"],[3,"value"],[3,"vertical"],[1,"flex","flex-column","ml-2"],["app-button","","buttonTheme","light","buttonType","text","matTooltip","Apply animation to all chapters","matTooltipPosition","above","title","Apply animation to all chapters",3,"click"],[1,"content__properties"],["label","Looping"],["formControlName","playCount",1,"content__group"],[1,"mv-4","mr-4"],["formControlName","autoplay"],["label","Media Controls"],["form-field-help",""],[1,"text-bold"],["formControlName","mediaControls",1,"content__group"],["value","none"],["value","small"],["value","full"]],template:function(e,t){if(1&e&&(ae.Vb(0,"div",0),ae.Vb(1,"div",1),ae.Vb(2,"div",2),ae.Pc(3,"Content Manager"),ae.Ub(),ae.Ub(),ae.Vb(4,"div",3),ae.Vb(5,"div",4),ae.Vb(6,"div",5),ae.Vb(7,"div",6),ae.Pc(8,"Model"),ae.Ub(),ae.Vb(9,"div",7),ae.cc("click",(function(){return t.handleModuleClick()})),ae.Vb(10,"div",8),ae.Pc(11),ae.hc(12,"async"),ae.Ub(),ae.Ub(),ae.Ub(),ae.Vb(13,"div",5),ae.Vb(14,"div",6),ae.Pc(15,"Chapters"),ae.Ub(),ae.Nc(16,Pt,5,5,"div",9),ae.hc(17,"async"),ae.Ub(),ae.Ub(),ae.Nc(18,Ut,8,2,"div",10),ae.Nc(19,Lt,22,10,"div",10),ae.Ub(),ae.Vb(20,"div",11),ae.Vb(21,"button",12),ae.Pc(22," Done "),ae.Ub(),ae.Ub(),ae.Ub()),2&e){let e=null;ae.Db(9),ae.mc("ngClass",ae.pc(9,Ct,!t.selectedChapterId)),ae.Db(2),ae.Rc(" ",(null==(e=ae.ic(12,5,t.story$))?null:e.displayName)||"-No Title-"," "),ae.Db(5),ae.mc("ngForOf",ae.ic(17,7,t.chapters$)),ae.Db(2),ae.mc("ngIf",!t.selectedChapterId),ae.Db(1),ae.mc("ngIf",t.selectedChapterId)}},directives:[n.m,n.o,n.p,pe.a,H.d,G.E,G.s,G.j,de.a,G.c,G.r,G.i,G.m,ue.a,he.a,G.e,me.a,be.a,G.k,ge.a,nt,ot.c,n.r,n.s,lt,pt.a,ut,ot.a,mt,st.c,at.a,bt.b,gt.a,ft.a,bt.a,G.B,rt.a,G.v,G.D],pipes:[n.b],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.content[_ngcontent-%COMP%]{height:100%;width:100%}.content__header[_ngcontent-%COMP%]{padding-bottom:12px;border-bottom:1px solid #d7e0ea;height:80px;display:flex;justify-content:space-between;align-items:center}.content__body[_ngcontent-%COMP%]{height:calc(90vh - 180px);padding-top:12px;display:flex}.content__footer[_ngcontent-%COMP%]{border-top:1px solid #d7e0ea;height:80px;display:flex;align-items:center;justify-content:flex-end}.content__section-label[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase;color:#96a8c0;margin-bottom:4px}.content__sections[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding:20px 12px 0 0;flex:1 1 35%;overflow:auto}.content__index[_ngcontent-%COMP%]{padding:0 8px}.content__index[_ngcontent-%COMP%], .content__section[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.content__section[_ngcontent-%COMP%]{display:flex;padding:12px;border-left:4px solid transparent;border-radius:4px;margin-bottom:4px;cursor:pointer;transition:background-color .12s}.content__section[_ngcontent-%COMP%]:hover{background:#eaeff5}.content__section--selected[_ngcontent-%COMP%], .content__section--selected[_ngcontent-%COMP%]:hover{background:#eaeff5;color:#101823;border-color:#2d72dc}.content__title[_ngcontent-%COMP%]{word-break:break-word}.content__thumb[_ngcontent-%COMP%]{background:url(/assets/images/logo-dark-transparent.svg) 50% no-repeat;background-size:50%;border-radius:4px;flex:0 0 64px;height:64px;margin-right:12px}.content__editor[_ngcontent-%COMP%]{border-left:1px solid #eaeff5;flex:1 1 75%;padding:16px 24px 48px 16px;overflow:auto}.content__group[_ngcontent-%COMP%]{display:flex;flex-direction:column}.content__check-group[_ngcontent-%COMP%]{grid-template-columns:1fr;display:grid;grid-column-gap:12px;font-size:12px;letter-spacing:.3px;line-height:1.4em}.content__check-group--split[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr}.content__properties[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em;display:grid;grid-template-columns:160px auto auto;grid-column-gap:8px}.content__block[_ngcontent-%COMP%]{display:flex;padding-bottom:16px}.content__block.cdk-drag-preview[_ngcontent-%COMP%] > .content__block-actions[_ngcontent-%COMP%], .content__block.cdk-drag-preview[_ngcontent-%COMP%] > .content__block-text[_ngcontent-%COMP%]{display:none}.content__block-handle[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:flex-start;flex:0 0 36px}.content__block-handle[_ngcontent-%COMP%]:hover{cursor:move}.content__block-image[_ngcontent-%COMP%]{flex:0 0 240px}.content__block-text[_ngcontent-%COMP%]{flex-grow:1;padding:0 8px}.content__block-actions[_ngcontent-%COMP%]{flex:0 0 48px}.content__audio-language[_ngcontent-%COMP%]{width:200px}"],changeDetection:0}),xt([Object(r.e)(y.a.getStory),yt("design:type",m.a)],e.prototype,"story$",void 0),xt([Object(r.e)(F.a.getStoryChapters),yt("design:type",m.a)],e.prototype,"chapters$",void 0),e})();var Qt=i("ZR5G"),$t=i("GMXD");const qt={[Q.a.Select]:"mouse-pointer",[Q.a.Hide]:"eye-slash",[Q.a.Paint]:"fill-drip",[Q.a.Label]:"tag",[Q.a.Isolate]:"hand-point-up",[Q.a.Fade]:"lungs",[Q.a.Position]:"location-arrow",[Q.a.Quiz]:"check"};var Gt=i("imBb"),Ht=i("AytR"),Wt=i("Dyer"),Kt=i("Kn5L"),Jt=i("mdY/"),Xt=i("gm/O"),Zt=i("JaAu"),Yt=i("/75k"),ei=i("Iab2"),ti=i("GmhI"),ii=i("zKvh"),ni=i("t15c"),oi=i("k93M"),ai=i("DTUA"),ri=i("+/zV");class si{constructor(e){this.namespaceMap={},this.duplicate=!1,this.replace=!1,Object.assign(this,e)}}var ci=i("0FUJ"),li=i("3phy"),pi=i("Kj3r"),di=i("MKYd"),ui=i("XoCC"),hi=function(e,t,i,n){var o,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,i,r):o(t,i))||r);return a>3&&r&&Object.defineProperty(t,i,r),r},mi=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function bi(e,t){1&e&&(ae.Vb(0,"div",23),ae.Qb(1,"app-icon",24),ae.Vb(2,"span",25),ae.Pc(3,"The scene graph will be trimmed using the clipping planes of the currently active chapter. Objects shared with other chapters will be lost. A page reload is recommended."),ae.Ub(),ae.Ub())}function gi(e,t){if(1&e&&(ae.Vb(0,"option",26),ae.Pc(1),ae.Ub()),2&e){const e=t.$implicit;ae.mc("value",e),ae.Db(1),ae.Rc(" ",e," ")}}function fi(e,t){if(1&e&&(ae.Vb(0,"option",26),ae.Pc(1),ae.Ub()),2&e){const e=t.$implicit;ae.mc("value",e),ae.Db(1),ae.Rc(" ",e," ")}}function xi(e,t){if(1&e&&(ae.Vb(0,"app-form-field",27),ae.Vb(1,"select",28),ae.Nc(2,fi,2,2,"option",12),ae.hc(3,"async"),ae.Ub(),ae.Ub()),2&e){const e=ae.gc();ae.Db(2),ae.mc("ngForOf",ae.ic(3,1,e.secondaryCategoryOptions$))}}function yi(e,t){if(1&e&&(ae.Vb(0,"div",33),ae.Qb(1,"app-icon",34),ae.Vb(2,"span",35),ae.Pc(3),ae.Ub(),ae.Vb(4,"span",36),ae.Pc(5,"(File exists)"),ae.Ub(),ae.Ub()),2&e){const e=ae.gc(2);ae.Db(3),ae.Qc(e.modulePath)}}function vi(e,t){if(1&e&&(ae.Vb(0,"div",37),ae.Qb(1,"app-icon",24),ae.Vb(2,"span",35),ae.Pc(3),ae.Ub(),ae.Vb(4,"span",36),ae.Pc(5,"(File exists and cannot be overwritten)"),ae.Ub(),ae.Ub()),2&e){const e=ae.gc(2);ae.Db(3),ae.Qc(e.modulePath)}}function Ci(e,t){if(1&e&&(ae.Vb(0,"div",38),ae.Qb(1,"app-icon",39),ae.Vb(2,"span",35),ae.Pc(3),ae.Ub(),ae.Ub()),2&e){const e=ae.gc(2);ae.Db(3),ae.Qc(e.modulePath)}}function Pi(e,t){if(1&e&&(ae.Vb(0,"div",29),ae.Nc(1,yi,6,1,"div",30),ae.Nc(2,vi,6,1,"div",31),ae.Nc(3,Ci,4,1,"div",32),ae.Ub()),2&e){const e=ae.gc();ae.Db(1),ae.mc("ngIf",e.moduleExists&&!e.formDuplicateStates.value),ae.Db(1),ae.mc("ngIf",e.moduleExists&&e.formDuplicateStates.value),ae.Db(1),ae.mc("ngIf",!e.moduleExists)}}function Oi(e,t){1&e&&(ae.Vb(0,"app-form-field",40),ae.Vb(1,"mat-checkbox",41),ae.Vb(2,"span",4),ae.Pc(3,"I intend to save to Production"),ae.Ub(),ae.Ub(),ae.Ub())}function wi(e,t){if(1&e&&(ae.Vb(0,"div",51),ae.Vb(1,"div",52),ae.Vb(2,"div",44),ae.Vb(3,"div",53),ae.Qb(4,"mat-checkbox",54),ae.Ub(),ae.Vb(5,"div",55),ae.Qb(6,"input",56),ae.Qb(7,"input",57),ae.Ub(),ae.Ub(),ae.Ub(),ae.Ub()),2&e){const e=t.index;ae.Db(1),ae.mc("formGroupName",e)}}function ki(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"div"),ae.Qb(1,"mat-divider",42),ae.Vb(2,"app-form-field",43),ae.Vb(3,"div",44),ae.Qb(4,"input",45,46),ae.Vb(6,"button",47),ae.cc("click",(function(){ae.Cc(e);const t=ae.yc(5);return ae.gc().handleReplaceClick(t.value)})),ae.Pc(7," Replace "),ae.Ub(),ae.Vb(8,"button",48),ae.cc("click",(function(){ae.Cc(e);const t=ae.yc(5);return ae.gc().handlePrependClick(t.value)})),ae.Pc(9," Prepend "),ae.Ub(),ae.Ub(),ae.Vb(10,"div",49),ae.Nc(11,wi,8,1,"div",50),ae.Ub(),ae.Ub(),ae.Ub()}if(2&e){const e=ae.gc();ae.Db(11),ae.mc("ngForOf",e.formStates.controls)}}function Si(e,t){1&e&&(ae.Tb(0),ae.Qb(1,"app-spinner",58),ae.Pc(2," Validating "),ae.Sb())}function _i(e,t){1&e&&(ae.Tb(0),ae.Qb(1,"app-spinner",58),ae.Pc(2," Saving "),ae.Sb())}function Mi(e,t){1&e&&(ae.Tb(0),ae.Pc(1," Save Module "),ae.Sb())}const Ui=/^[0-9a-zA-Z_]+$/;let Ti=(()=>{class e{constructor(e,t,i,n,o,a,r,s){this.store=e,this.actions=t,this.formBuilder=i,this.modulesService=n,this.changeDetector=o,this.snackbar=a,this.dialogRef=r,this.data=s,this.saving=!1,this.moduleExists=!1,this.validating=!1,this.ngUnsubscribe=new c.a,this.settings=Object.assign({},s)}get formName(){return this.form.get("name")}get formStates(){return this.form.get("states")}get formPrimaryCategory(){return this.form.get("primaryCategory")}get formSecondaryCategory(){return this.form.get("secondaryCategory")}get formDuplicateStates(){return this.form.get("duplicateStates")}get formTrimHidden(){return this.form.get("trimHidden")}get formTrimClipped(){return this.form.get("trimClipped")}get formConfirmProduction(){return this.form.get("confirmProduction")}ngOnInit(){this.store.dispatch(new Wt.e),this.saveModule=this.generateSaveModule(),this.usedStates=this.modulesService.getUsedStates(),this.initApplicationListeners(),this.initForm(),this.setFormValidators(),this.initFormListeners(),this.setFormValues(this.saveModule),this.populateStateValues()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initApplicationListeners(){this.actions.pipe(Object(r.l)(Wt.h),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.handleSaveSuccess(e.id)}),this.actions.pipe(Object(r.l)(Wt.g),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.handleSaveFail(e.id)})}initFormListeners(){this.formPrimaryCategory.valueChanges.pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.store.dispatch(new Wt.d(e))}),Object(d.b)(this.formPrimaryCategory.valueChanges,this.formSecondaryCategory.valueChanges,this.formName.valueChanges,this.formDuplicateStates.valueChanges).pipe(Object(P.a)(this.ngUnsubscribe),Object(pi.a)(300)).subscribe(([e,t,i,n])=>{this.handleNameChange(e,t,i,n)}),Object(u.a)(this.formDuplicateStates.valueChanges,this.formStates.valueChanges).pipe(Object(U.a)(()=>this.validating=!0),Object(pi.a)(300),Object(S.a)(e=>this.checkStateGroups()),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.validating=!1,this.updateFormStates(e)})}initForm(){this.form=this.formBuilder.group({primaryCategory:["",G.C.required],secondaryCategory:[""],name:["",[G.C.required,G.C.pattern("[0-9a-zA-Z_]*")]],trimHidden:[!1],trimClipped:[!1],duplicateStates:[!1],confirmProduction:[!1,this.validateProductionSave],states:this.formBuilder.array([this.initStateForm("")])},{validators:[this.validateProductionSave]})}initStateForm(e){return this.formBuilder.group({include:[!0],oldState:[e],newState:[e,[G.C.required,G.C.pattern("[0-9a-zA-Z_]*")]]})}handleReplaceClick(e){this.changeStatePrefix(e,"replace")}handlePrependClick(e){this.changeStatePrefix(e,"prepend")}handleSubmit(){this.form.valid&&this.save()}handleSaveSuccess(e){this.dialogRef.close(!0),this.snackbar.open(`"${e}" successfully saved.`)}handleSaveFail(e){this.dialogRef.close(),this.snackbar.open(`There was an error saving "${e}".`)}generateSaveModule(){return this.modulesService.generateSaveModule(this.settings.id)}populateStateValues(){for(;this.formStates.length>0;)this.formStates.removeAt(0);const e=[];this.modulesService.getUsedStates().forEach(t=>{const i={enabled:!0,state:t};this.formStates.push(this.initStateForm(i.state)),e.push(i)}),this.formStates.markAsDirty()}setFormValidators(){this.formPrimaryCategory.valueChanges.pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{switch(e){case"production":case"client":this.formSecondaryCategory.setValidators([G.C.required]);break;default:this.formSecondaryCategory.setValidators(null),this.formSecondaryCategory.setValue("")}})}setFormValues(e){this.form.patchValue({primaryCategory:"exports"===e.primaryCategory?"preview":e.primaryCategory||"preview",secondaryCategory:e.secondaryCategory||"",name:e.name||"",trimHidden:!1,trimClipped:!1,duplicateStates:!1})}save(){const e=this.modulesService.generateModulePath(this.formPrimaryCategory.value,this.formSecondaryCategory.value,this.formName.value),t=new si;this.formDuplicateStates.value&&(t.duplicate=!0,this.formStates.value.map(e=>{e.include&&(t.namespaceMap[e.oldState]=e.newState)}));const i=new ci.a;i.graph.hidden=this.formTrimHidden.value,i.graph.clipped=this.formTrimClipped.value,this.saving=!0,this.store.dispatch(new Wt.f(e,t,i))}handleNameChange(e,t,i,n){if(this.modulePath=this.modulesService.generateModulePath(e,t,i),this.formName.errors){const{pattern:e,required:t}=this.formName.errors;if(e||t)return}this.modulePath&&i.length&&this.modulesService.listContents(e,t,i).subscribe(e=>{this.moduleExists=e.length>0;const t=n&&this.moduleExists,o=!Ui.test(i);this.formName.setErrors(t||o?{invalid:!0}:null),this.formName.markAsDirty(),this.changeDetector.markForCheck()})}validateProductionSave(e){const t=e.get("primaryCategory"),i=e.get("confirmProduction");return t&&i&&"production"===t.value&&!1===i.value?{confirmProduction:!0}:null}checkStateGroups(){const e=this.formStates.controls.map(e=>this.validateStateGroup(e));return e.length>0?Object(d.b)(...e):Object(l.a)([])}validateStateGroup(e){const t=!0===this.formDuplicateStates.value,i=e.get("newState"),n=e.get("include");return t&&!1!==n.value?i.errors||0===i.value.length?Object(l.a)({stateControl:i,valid:!1}):this.modulesService.getState(i.value).pipe(Object(C.a)(e=>{const t=Ui.test(i.value);return{stateControl:i,valid:0===e.length&&t}})):Object(l.a)({stateControl:i,valid:!0})}updateFormStates(e){e.forEach(e=>{e.valid?(e.stateControl.setErrors(null),e.stateControl.markAsDirty()):e.stateControl.setErrors({stateTaken:!0})}),this.changeDetector.markForCheck()}changeStatePrefix(e,t){this.formStates.controls.forEach(i=>{const n=i.get("newState");switch(t){case"prepend":n.setValue(`${e}_${n.value}`);break;case"replace":const t=new RegExp(/[^_]*/),i=n.value.replace(t,e);n.setValue(i)}})}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(r.h),ae.Pb(r.b),ae.Pb(G.f),ae.Pb(di.a),ae.Pb(ae.i),ae.Pb(le.b),ae.Pb(H.g),ae.Pb(H.a))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-save-module-dialog"]],decls:38,vars:15,consts:[["mat-dialog-title",""],["mat-dialog-content","","data-test","saveDialog",1,"theme-light"],[3,"formGroup","submit"],["data-test","duplicateStates","formControlName","duplicateStates"],[1,"text-12"],["form-field-help",""],["data-test","trimHidden","formControlName","trimHidden"],["formControlName","trimClipped",1,"ml-4"],["class","text-danger pt-2",4,"ngIf"],[1,"mb-4"],["label","Primary Category"],["data-test","primaryCategory","formControlName","primaryCategory",1,"input"],[3,"value",4,"ngFor","ngForOf"],["label","Secondary Category",4,"ngIf"],["label","Name"],["data-test","moduleName","type","text","formControlName","name",1,"input","w-100"],["name",""],["class","pt-2 text-12",4,"ngIf"],["label","Production Save",4,"ngIf"],[4,"ngIf"],["mat-dialog-actions",""],["app-button","","buttonTheme","light","type","button",1,"mr-2",3,"mat-dialog-close"],["app-button","","data-test","saveModuleSubmit","buttonTheme","light","buttonType","primary",3,"disabled","click"],[1,"text-danger","pt-2"],["icon","exclamation-circle"],[1,"pl-2","text-12"],[3,"value"],["label","Secondary Category"],["data-test","secondaryCategory","formControlName","secondaryCategory",1,"input"],[1,"pt-2","text-12"],["class","text-info",4,"ngIf"],["class","text-danger",4,"ngIf"],["class","text-success",4,"ngIf"],[1,"text-info"],["icon","exclamation-triangle"],[1,"pl-2"],[1,"pl-2","text-bold"],[1,"text-danger"],[1,"text-success"],["icon","check-circle"],["label","Production Save"],["formControlName","confirmProduction"],[1,"mv-4"],["label","Prefix"],[1,"flex"],["type","text","pattern","[^ ]*",1,"input","flex-25","w-25"],["prefix",""],["data-test","prefixReplace","type","button","app-button","","buttonType","outline","buttonTheme","light",1,"ml-2",3,"click"],["data-test","prefixPrepend","type","button","app-button","","buttonType","outline","buttonTheme","light",1,"ml-2",3,"click"],["formArrayName","states",1,"pv-4","text-12"],["class","mb-2",4,"ngFor","ngForOf"],[1,"mb-2"],[3,"formGroupName"],[1,"flex-shrink","pr-2","pt-2"],["data-test","includeState","formControlName","include","matTooltip","Include State"],[1,"flex-grow"],["data-test","oldState","type","hidden","formControlName","oldState",1,"input"],["data-test","newState","type","text","formControlName","newState",1,"input"],["size","medium","render","inline",1,"ml-2"]],template:function(e,t){if(1&e&&(ae.Vb(0,"h1",0),ae.Pc(1,"Save Module"),ae.Ub(),ae.Vb(2,"div",1),ae.Vb(3,"form",2),ae.cc("submit",(function(){return t.handleSubmit()})),ae.Vb(4,"app-form-field"),ae.Vb(5,"mat-checkbox",3),ae.Vb(6,"span",4),ae.Pc(7,"Duplicate Content States"),ae.Ub(),ae.Ub(),ae.Vb(8,"div",5),ae.Pc(9," This requires that you specify the location for the new module, and new unused names for each of the content states. "),ae.Ub(),ae.Ub(),ae.Vb(10,"app-form-field"),ae.Vb(11,"mat-checkbox",6),ae.Vb(12,"span",4),ae.Pc(13,"Trim Hidden Objects"),ae.Ub(),ae.Ub(),ae.Vb(14,"mat-checkbox",7),ae.Vb(15,"span",4),ae.Pc(16,"Trim Clipped Objects"),ae.Ub(),ae.Ub(),ae.Nc(17,bi,4,0,"div",8),ae.Ub(),ae.Qb(18,"mat-divider",9),ae.Vb(19,"app-form-field",10),ae.Vb(20,"select",11),ae.Nc(21,gi,2,2,"option",12),ae.hc(22,"async"),ae.Ub(),ae.Ub(),ae.Nc(23,xi,4,3,"app-form-field",13),ae.hc(24,"async"),ae.Vb(25,"app-form-field",14),ae.Qb(26,"input",15,16),ae.Nc(28,Pi,4,3,"div",17),ae.Ub(),ae.Nc(29,Oi,4,0,"app-form-field",18),ae.Nc(30,ki,12,1,"div",19),ae.Ub(),ae.Ub(),ae.Vb(31,"div",20),ae.Vb(32,"button",21),ae.Pc(33," Cancel "),ae.Ub(),ae.Vb(34,"button",22),ae.cc("click",(function(){return t.handleSubmit()})),ae.Nc(35,Si,3,0,"ng-container",19),ae.Nc(36,_i,3,0,"ng-container",19),ae.Nc(37,Mi,2,0,"ng-container",19),ae.Ub(),ae.Ub()),2&e){const e=ae.yc(27);let i=null;ae.Db(3),ae.mc("formGroup",t.form),ae.Db(14),ae.mc("ngIf",t.formTrimClipped.value),ae.Db(4),ae.mc("ngForOf",ae.ic(22,11,t.primaryCategoryOptions$)),ae.Db(2),ae.mc("ngIf",null==(i=ae.ic(24,13,t.secondaryCategoryOptions$))?null:i.length),ae.Db(5),ae.mc("ngIf",t.modulePath&&e.value.length),ae.Db(1),ae.mc("ngIf","production"===t.formPrimaryCategory.value),ae.Db(1),ae.mc("ngIf",t.formDuplicateStates.value),ae.Db(4),ae.mc("disabled",t.saving||!t.form.valid||t.validating),ae.Db(1),ae.mc("ngIf",t.validating),ae.Db(1),ae.mc("ngIf",t.saving),ae.Db(1),ae.mc("ngIf",!t.validating&&!t.saving)}},directives:[H.h,H.e,G.E,G.s,G.j,de.a,ge.a,G.r,G.i,n.p,me.a,G.B,n.o,G.c,H.c,pe.a,H.d,at.a,G.v,G.D,G.e,G.k,st.c,ui.a],pipes:[n.b],styles:[""],changeDetection:0}),hi([Object(r.e)(li.a.getSaveModule),mi("design:type",m.a)],e.prototype,"saveModule$",void 0),hi([Object(r.e)(li.a.getPrimaryCategoryOptions("write")),mi("design:type",m.a)],e.prototype,"primaryCategoryOptions$",void 0),hi([Object(r.e)(li.a.getSecondaryCategoryOptions),mi("design:type",m.a)],e.prototype,"secondaryCategoryOptions$",void 0),e})();var Vi=i("5sb6"),Di=i("g408"),Ei=i("Y7Bv"),ji=i("FFWI"),Ni=i("QkH1"),Ri=i("h8op"),Ai=i("Vrox");const Fi=[.1,.25,.5,1,1.5,2];var Ii;!function(e){class t{constructor(e){this.scale=e}}t.type="[Edit Timeline] Set Scale",e.SetScale=t;class i{constructor(e){this.selectedTimelineMapIds=e}}i.type="[Edit Timeline] Set selectedTimelineMapIds",e.SetSelectedTimelineMapIds=i;class n{constructor(e){this.selectedTimelineMapIds=e}}n.type="[Edit Timeline] Add to selectedTimelineMapIds",e.AddToSelectedTimelineMapIds=n;class o{constructor(e){this.selectedTimelineMapIds=e}}o.type="[Edit Timeline] Remove from selectedTimelineMapIds",e.RemoveFromSelectedTimelineMapIds=o;class a{constructor(e){this.overlappingTimelineMapIds=e}}a.type="[Edit Timeline] Set overlappingTimelineMapIds",e.SetOverlappingTimelineMapIds=a;class r{constructor(e){this.copiedTimelineMaps=e}}r.type="[Edit Timeline] Set copiedTimelineMaps",e.SetCopiedTimelineMaps=r}(Ii||(Ii={}));class zi{}var Li=function(e,t,i,n){var o,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,i,r):o(t,i))||r);return a>3&&r&&Object.defineProperty(t,i,r),r},Bi=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const Qi={scale:1,selectedTimelineMapIds:new Set([]),overlappingTimelineMapIds:new Set([]),copiedTimelineMaps:[]};let $i=(()=>{let e=class{static getScale(e){return e.scale}static getSelectedTimelineMapIds(e){return e.selectedTimelineMapIds}static getOverlappingTimelineMapIds(e){return e.overlappingTimelineMapIds}static getCopiedTimelineMaps(e){return e.copiedTimelineMaps}setScale(e,{scale:t}){e.patchState({scale:t})}setSelectedTimelineMapIds(e,{selectedTimelineMapIds:t}){e.patchState({selectedTimelineMapIds:new Set(t)})}addSelectedTimelineMapId(e,t){const i=e.getState().selectedTimelineMapIds;t.selectedTimelineMapIds.forEach(e=>i.add(e)),e.patchState({selectedTimelineMapIds:new Set(Array.from(i))})}removeSelectedTimelineMapId(e,t){const i=e.getState().selectedTimelineMapIds;t.selectedTimelineMapIds.forEach(e=>i.delete(e)),e.patchState({selectedTimelineMapIds:new Set(Array.from(i))})}setOverlappingTimelineMapIds(e,{overlappingTimelineMapIds:t}){e.patchState({overlappingTimelineMapIds:new Set(t)})}setCopiedTimelineMaps(e,{copiedTimelineMaps:t}){e.patchState({copiedTimelineMaps:t})}};return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=ae.Lb({token:e,factory:e.\u0275fac}),Li([Object(r.a)(Ii.SetScale),Bi("design:type",Function),Bi("design:paramtypes",[Object,Ii.SetScale]),Bi("design:returntype",void 0)],e.prototype,"setScale",null),Li([Object(r.a)(Ii.SetSelectedTimelineMapIds),Bi("design:type",Function),Bi("design:paramtypes",[Object,Ii.SetSelectedTimelineMapIds]),Bi("design:returntype",void 0)],e.prototype,"setSelectedTimelineMapIds",null),Li([Object(r.a)(Ii.AddToSelectedTimelineMapIds),Bi("design:type",Function),Bi("design:paramtypes",[Object,Ii.AddToSelectedTimelineMapIds]),Bi("design:returntype",void 0)],e.prototype,"addSelectedTimelineMapId",null),Li([Object(r.a)(Ii.RemoveFromSelectedTimelineMapIds),Bi("design:type",Function),Bi("design:paramtypes",[Object,Ii.RemoveFromSelectedTimelineMapIds]),Bi("design:returntype",void 0)],e.prototype,"removeSelectedTimelineMapId",null),Li([Object(r.a)(Ii.SetOverlappingTimelineMapIds),Bi("design:type",Function),Bi("design:paramtypes",[Object,Ii.SetOverlappingTimelineMapIds]),Bi("design:returntype",void 0)],e.prototype,"setOverlappingTimelineMapIds",null),Li([Object(r.a)(Ii.SetCopiedTimelineMaps),Bi("design:type",Function),Bi("design:paramtypes",[Object,Ii.SetCopiedTimelineMaps]),Bi("design:returntype",void 0)],e.prototype,"setCopiedTimelineMaps",null),Li([Object(r.f)(),Bi("design:type",Function),Bi("design:paramtypes",[zi]),Bi("design:returntype",void 0)],e,"getScale",null),Li([Object(r.f)(),Bi("design:type",Function),Bi("design:paramtypes",[zi]),Bi("design:returntype",void 0)],e,"getSelectedTimelineMapIds",null),Li([Object(r.f)(),Bi("design:type",Function),Bi("design:paramtypes",[zi]),Bi("design:returntype",void 0)],e,"getOverlappingTimelineMapIds",null),Li([Object(r.f)(),Bi("design:type",Function),Bi("design:paramtypes",[zi]),Bi("design:returntype",void 0)],e,"getCopiedTimelineMaps",null),e=Li([Object(r.g)({name:"editTimeline",defaults:Qi})],e),e})();var qi=i("GUwF"),Gi=i("82LM"),Hi=i("0Yvn"),Wi=i("RhC1"),Ki=i("tgUM"),Ji=i("1mir"),Xi=i("ihWl"),Zi=i("Mgbk"),Yi=i("J9/X"),en=i("GCmh"),tn=i("TRdv");let nn=(()=>{class e{constructor(e,t){this.store=e,this.dialogRef=t,this.actionMode=Ji.a.Import,this.application=Ht.a.application,this.contentType=Qt.a.Module,this.ngUnsubscribe=new c.a}ngOnInit(){this.initGallery()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initGallery(){const e=new Xi.e("exports"),t=this.store.selectSnapshot(en.a.getSearchOptions)||new Zi.a("",Ki.f);this.store.dispatch(new Yi.a.SetCardActions({enabled:!1})),this.store.dispatch(new Yi.a.SetBulkActions({enabled:!1,items:[]})),this.store.dispatch(new Yi.a.SetSearchConfig(e)),this.store.dispatch(new Yi.a.SetSearchOptions(t))}handleSelect(e){this.dialogRef.close(e)}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(r.h),ae.Pb(H.g))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-merge-module-dialog"]],decls:5,vars:4,consts:[[1,"merge-module-dialog"],[1,"text-20","merge-module-dialog__header"],[1,"merge-module-dialog__body"],["selectLabel","Import",3,"actionMode","application","contentType","showSourcePicker","selectBookmark"]],template:function(e,t){1&e&&(ae.Vb(0,"div",0),ae.Vb(1,"div",1),ae.Pc(2,"Merge Module"),ae.Ub(),ae.Vb(3,"div",2),ae.Vb(4,"app-gallery-container",3),ae.cc("selectBookmark",(function(e){return t.handleSelect(e)})),ae.Ub(),ae.Ub(),ae.Ub()),2&e&&(ae.Db(4),ae.mc("actionMode",t.actionMode)("application",t.application)("contentType",t.contentType)("showSourcePicker",!1))},directives:[tn.a],styles:["[_nghost-%COMP%]{display:block;height:calc(90vh - 48px);width:calc(90vw - 48px);position:relative;padding:0 0 12px}.merge-module-dialog[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}.merge-module-dialog__header[_ngcontent-%COMP%]{border-bottom:1px solid rgba(0,0,0,.12);padding:8px 20px;display:flex;align-items:center}.merge-module-dialog__body[_ngcontent-%COMP%]{flex:1 0 auto;position:relative}"],changeDetection:0}),e})(),on=(()=>{class e{constructor(e,t){this.dialogRef=e,this.data=t,this.resolve=new G.g("loft")}ngOnInit(){}handleCancelClick(){this.dialogRef.close()}handleResolveClick(){this.dialogRef.close(this.resolve.value)}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(H.g),ae.Pb(H.a))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-merge-conflict-dialog"]],decls:21,vars:3,consts:[[1,"merge-conflict-dialog"],["mat-dialog-title",""],[1,"merge-conflict-dialog__message","mb-4"],["icon","info-circle",1,"merge-conflict-dialog__message-icon","mr-3"],[1,"text-12"],[1,"text-14","mb-3"],[1,"text-12","flex","flex-column",3,"formControl"],["value","loft",1,"mb-2"],["value","bridge"],["mat-dialog-actions","",1,"flex","justify-end"],["app-button","","buttonTheme","light","buttonType","default",1,"mr-4",3,"click"],["app-button","","buttonType","primary",3,"click"]],template:function(e,t){1&e&&(ae.Vb(0,"div",0),ae.Vb(1,"div",1),ae.Vb(2,"h1"),ae.Pc(3,"Resolve Merge Conflicts"),ae.Ub(),ae.Ub(),ae.Vb(4,"div"),ae.Vb(5,"div",2),ae.Qb(6,"app-icon",3),ae.Vb(7,"p",4),ae.Pc(8," There are conflicts with Particle Systems that prevent automatic merging. "),ae.Ub(),ae.Ub(),ae.Vb(9,"div",5),ae.Pc(10,"Choose which changes to accept"),ae.Ub(),ae.Vb(11,"mat-radio-group",6),ae.Vb(12,"mat-radio-button",7),ae.Pc(13),ae.Ub(),ae.Vb(14,"mat-radio-button",8),ae.Pc(15),ae.Ub(),ae.Ub(),ae.Ub(),ae.Vb(16,"div",9),ae.Vb(17,"button",10),ae.cc("click",(function(){return t.handleCancelClick()})),ae.Pc(18," Cancel "),ae.Ub(),ae.Vb(19,"button",11),ae.cc("click",(function(){return t.handleResolveClick()})),ae.Pc(20," Resolve and Merge "),ae.Ub(),ae.Ub(),ae.Ub()),2&e&&(ae.Db(11),ae.mc("formControl",t.resolve),ae.Db(2),ae.Rc("",t.data.loft," (current)"),ae.Db(2),ae.Rc("",t.data.bridge," (incoming)"))},directives:[H.h,at.a,bt.b,G.r,G.h,bt.a,H.c,pe.a],styles:[".merge-conflict-dialog[_ngcontent-%COMP%]{width:400px}.merge-conflict-dialog__message[_ngcontent-%COMP%]{display:flex;padding:12px;align-items:center;justify-content:center;background-color:#ffe2db;border-radius:4px}.merge-conflict-dialog__message-icon[_ngcontent-%COMP%]{color:#de3535}"],changeDetection:0}),e})();var an=i("2Vo4"),rn=i("/MKm"),sn=i("wSC8"),cn=i("jhN1"),ln=i("MKnA");const pn=["previewBody"],dn=["previewIframe"];let un=(()=>{class e{constructor(e,t,i,n,o,a,r){this.dialogRef=e,this.publishService=t,this.changeDetectorRef=i,this.sanitizer=n,this.renderer=o,this.storageService=a,this.ngUnsubscribe=new c.a,this.viewerSize=new an.a({width:0,height:0,scale:1}),this.viewerType="desktop",this.sizes={desktop:{width:null,height:null},tablet:{width:768,height:1024},mobile:{width:360,height:640}},this.data=r}ngOnInit(){const e={id:"preview","ui-loader":"circle"};this.data.quizLocked&&(e["ui-quiz-locked"]=this.data.quizLocked,Object(W.isNil)(this.data.questionNumber)||(e["ui-quiz-start"]=this.data.questionNumber+1,e["ui-quiz-end"]=this.data.questionNumber+1)),this.viewerUrl=this.sanitizer.bypassSecurityTrustResourceUrl(this.publishService.buildWidgetURL("/viewer",e)),Ht.a.deploy===sn.a.Local&&(this.viewerUrl=this.sanitizer.bypassSecurityTrustResourceUrl("/view?id=preview")),this.changeDetectorRef.markForCheck(),this.initSizeListener()}ngAfterViewInit(){var e;const t=this.previewBody.nativeElement.getBoundingClientRect(),i=null!==(e=this.storageService.getSessionItem(ai.c.PreviewSize))&&void 0!==e?e:t;this.viewerWidth=t.width,this.viewerHeight=t.height,this.setSize({width:i.width,height:i.height})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}onWidthChange(e){null!==e&&this.setSize({width:e,height:this.viewerSize.value.height})}onHeightChange(e){null!==e&&this.setSize({width:this.viewerSize.value.width,height:e})}handleCloseClick(){this.dialogRef.close()}handlePublishClick(){this.dialogRef.close("publish")}setSize(e){const t=this.calculateSize(this.viewerWidth,this.viewerHeight,e.width,e.height);this.viewerSize.next(t),this.viewerType="desktop",Object.entries(this.sizes).forEach(([t,i])=>{Object(W.isEqual)(i,e)&&(this.viewerType=t)})}initSizeListener(){this.viewerSize.pipe(Object(P.a)(this.ngUnsubscribe),Object(pi.a)(300)).subscribe(e=>{this.renderer.setStyle(this.previewIframe.nativeElement,"width",e.width+"px"),this.renderer.setStyle(this.previewIframe.nativeElement,"height",e.height+"px"),this.renderer.setStyle(this.previewIframe.nativeElement,"transform","scale("+e.scale),this.renderer.setStyle(this.previewBody.nativeElement,"width",this.viewerWidth+"px"),this.renderer.setStyle(this.previewBody.nativeElement,"height",this.viewerHeight+"px"),this.storageService.setSessionItem(ai.c.PreviewSize,{width:e.width,height:e.height}),this.changeDetectorRef.markForCheck()})}calculateSize(e,t,i,n){let o=1;return n=null===n?t:n,((i=null===i?e:i)>e||n>t)&&(o=i>n?e/i:t/n),{width:Math.floor(i),height:Math.floor(n),scale:o}}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(H.g),ae.Pb(rn.b),ae.Pb(ae.i),ae.Pb(cn.b),ae.Pb(ae.H),ae.Pb(ai.d),ae.Pb(H.a))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-edit-preview-dialog"]],viewQuery:function(e,t){if(1&e&&(ae.Vc(pn,!0),ae.Vc(dn,!0)),2&e){let e;ae.xc(e=ae.dc())&&(t.previewBody=e.first),ae.xc(e=ae.dc())&&(t.previewIframe=e.first)}},decls:25,vars:6,consts:[["data-test","preview",1,"preview"],[1,"preview__header"],[1,"text-20","text-semibold"],[1,"flex","theme-light","items-center"],["data-test","previewDesktopButton","app-button","","buttonTheme","light",1,"mr-1",3,"selected","click"],["icon","desktop"],["data-test","previewTabletButton","app-button","","buttonTheme","light",1,"mr-1",3,"selected","click"],["icon","tablet-alt"],["data-test","previewMobileButton","app-button","","buttonTheme","light",3,"selected","click"],["icon","mobile-alt"],[1,"mh-3"],["isCompact","true","display","inline","label","width",1,"mr-4"],["data-test","previewWidth","type","number","min","1",1,"input",2,"width","80px",3,"ngModel","ngModelChange"],["isCompact","true","display","inline","label","height"],["data-test","previewHeight","type","number","min","1",1,"input",2,"width","80px",3,"ngModel","ngModelChange"],["data-test","previewPublish","app-button","","buttonType","primary","buttonTheme","light",3,"click"],["data-test","previewClose","app-button","","buttonTheme","light",1,"ml-2",3,"click"],["icon","times","size","lg"],[1,"preview__body"],["previewBody",""],["data-test","previewIframe",1,"preview__iframe",3,"src"],["previewIframe",""]],template:function(e,t){1&e&&(ae.Vb(0,"div",0),ae.Vb(1,"div",1),ae.Vb(2,"div",2),ae.Pc(3,"Preview"),ae.Ub(),ae.Vb(4,"div",3),ae.Vb(5,"button",4),ae.cc("click",(function(){return t.setSize(t.sizes.desktop)})),ae.Qb(6,"app-icon",5),ae.Ub(),ae.Vb(7,"button",6),ae.cc("click",(function(){return t.setSize(t.sizes.tablet)})),ae.Qb(8,"app-icon",7),ae.Ub(),ae.Vb(9,"button",8),ae.cc("click",(function(){return t.setSize(t.sizes.mobile)})),ae.Qb(10,"app-icon",9),ae.Ub(),ae.Qb(11,"app-divider",10),ae.Vb(12,"app-form-field",11),ae.Vb(13,"input",12),ae.cc("ngModelChange",(function(e){return t.onWidthChange(e)})),ae.Ub(),ae.Ub(),ae.Vb(14,"app-form-field",13),ae.Vb(15,"input",14),ae.cc("ngModelChange",(function(e){return t.onHeightChange(e)})),ae.Ub(),ae.Ub(),ae.Ub(),ae.Vb(16,"div"),ae.Vb(17,"button",15),ae.cc("click",(function(){return t.handlePublishClick()})),ae.Pc(18," Save & Publish "),ae.Ub(),ae.Vb(19,"button",16),ae.cc("click",(function(){return t.handleCloseClick()})),ae.Qb(20,"app-icon",17),ae.Ub(),ae.Ub(),ae.Ub(),ae.Vb(21,"div",18,19),ae.Qb(23,"iframe",20,21),ae.Ub(),ae.Ub()),2&e&&(ae.Db(5),ae.mc("selected","desktop"===t.viewerType),ae.Db(2),ae.mc("selected","tablet"===t.viewerType),ae.Db(2),ae.mc("selected","mobile"===t.viewerType),ae.Db(4),ae.mc("ngModel",t.viewerSize.value.width),ae.Db(2),ae.mc("ngModel",t.viewerSize.value.height),ae.Db(8),ae.mc("src",t.viewerUrl,ae.Ec))},directives:[pe.a,at.a,ln.a,de.a,G.w,G.c,G.r,G.u],styles:[".preview[_ngcontent-%COMP%]{border-radius:4px;background:#fff;display:flex;flex-direction:column;padding:12px;height:100%}.preview__header[_ngcontent-%COMP%]{flex:0 0 auto;display:flex;align-items:center;justify-content:space-between;padding-bottom:12px}.preview__body[_ngcontent-%COMP%]{flex:1 1 auto;display:flex;justify-content:center;align-items:center;position:relative}.preview__iframe[_ngcontent-%COMP%]{border:1px solid #eaeff5;width:100%;height:100%;position:absolute}"],changeDetection:0}),e})();var hn=i("WkFQ"),mn=i("WUhe"),bn=i("XqAe"),gn=i("PV7u"),fn=i("937/"),xn=i("kTA6"),yn=i("L2KA"),vn=i("J5ja"),Cn=i("MuXT"),Pn=i("6/b0"),On=i("vm16"),wn=i("cQmI"),kn=i("Y+XQ"),Sn=i("STbY");function _n(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"button",5),ae.cc("click",(function(){ae.Cc(e);const i=t.$implicit;return ae.gc().setViewMode(i.key)})),ae.Vb(1,"div",6),ae.Pc(2),ae.Ub(),ae.Vb(3,"div",7),ae.Pc(4),ae.Ub(),ae.Ub()}if(2&e){const e=t.$implicit;ae.Db(2),ae.Qc(e.value.label),ae.Db(2),ae.Qc(e.value.description)}}let Mn=(()=>{class e{constructor(e){this.store=e,this.bookmarkViewMode=wn.a,this.viewLabels={[wn.a.All]:{label:"View & Quiz",color:kn.a.Gray,description:"Enable both View mode and Quiz mode."},[wn.a.Content]:{label:"View only",color:kn.a.Green,description:"Enable View mode only, and disable Quiz mode."},[wn.a.Quiz]:{label:"Quiz only",color:kn.a.Purple,description:"Enable Quiz mode only, and disable View mode."}},this.viewLabel=this.viewLabels[wn.a.All],this._viewMode=wn.a.All}get viewMode(){return this._viewMode}set viewMode(e){var t;null!=e&&(this._viewMode=e,this.viewLabel=null!==(t=this.viewLabels[this.viewMode])&&void 0!==t?t:this.viewLabels[wn.a.All])}ngOnInit(){}setViewMode(e){this.store.dispatch(new L.F(e))}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(r.h))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-edit-bookmark-view-mode"]],inputs:{viewMode:"viewMode"},decls:6,vars:6,consts:[["app-button","","buttonTheme","dark","buttonType","text","data-test","viewModeButton",3,"matMenuTriggerFor"],["icon","caret-down",3,"label","color"],["data-test","viewModeMenu"],["menu","matMenu"],["class","view-mode-item","mat-menu-item","","data-test","viewModeItem",3,"click",4,"ngFor","ngForOf"],["mat-menu-item","","data-test","viewModeItem",1,"view-mode-item",3,"click"],[1,"text-12"],[1,"text-11"]],template:function(e,t){if(1&e&&(ae.Vb(0,"button",0),ae.Qb(1,"app-tag",1),ae.Ub(),ae.Vb(2,"mat-menu",2,3),ae.Nc(4,_n,5,2,"button",4),ae.hc(5,"keyvalue"),ae.Ub()),2&e){const e=ae.yc(3);ae.mc("matMenuTriggerFor",e),ae.Db(1),ae.mc("label",t.viewLabel.label)("color",t.viewLabel.color),ae.Db(3),ae.mc("ngForOf",ae.ic(5,4,t.viewLabels))}},directives:[pe.a,Sn.d,kn.b,Sn.a,n.o,Sn.b],pipes:[n.i],styles:["button.view-mode-item[_ngcontent-%COMP%]{white-space:normal;height:auto;text-overflow:clip;line-height:normal;padding:8px 16px}"],changeDetection:0}),e})();var Un=i("wn8Z"),Tn=i("XqLm"),Vn=i("llWQ"),Dn=i("/uUt"),En=i("5miH"),jn=i("C9yA"),Nn=i("HdmJ");const Rn=[[["","column-group-header",""]],[["","column-group-body",""]]],An=["[column-group-header]","[column-group-body]"];let Fn=(()=>{class e{constructor(e,t){this.renderer=e,this.element=t,this._isActive=!1}get isActive(){return this._isActive}set isActive(e){this._isActive=e,this.show(this.isActive)}ngOnInit(){}show(e){this.renderer.setStyle(this.element.nativeElement,"display",this.isActive?"flex":"none")}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(ae.H),ae.Pb(ae.m))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-column-group"]],inputs:{label:"label",isActive:"isActive"},ngContentSelectors:An,decls:5,vars:0,consts:[[1,"column-group"],[1,"column-group__header"],[1,"column-group__body"]],template:function(e,t){1&e&&(ae.lc(Rn),ae.Vb(0,"div",0),ae.Vb(1,"div",1),ae.kc(2),ae.Ub(),ae.Vb(3,"div",2),ae.kc(4,1),ae.Ub(),ae.Ub())},styles:[".column-group[_ngcontent-%COMP%], [_nghost-%COMP%]{display:flex;flex-direction:column;flex:1 1 auto;overflow:hidden}.column-group[_ngcontent-%COMP%]{height:100%}.theme-light[_nghost-%COMP%]   .column-group__body[_ngcontent-%COMP%], .theme-light   [_nghost-%COMP%]   .column-group__body[_ngcontent-%COMP%]{border-color:transparent}.column-group__header[_ngcontent-%COMP%]{flex:0 1 auto;padding:8px 8px 12px}.column-group__header[_ngcontent-%COMP%]:empty{display:none}.column-group__body[_ngcontent-%COMP%]{border-top:1px solid #283853;display:flex;flex-direction:column;flex:1 1 100%;overflow:scroll;padding:0 12px 0 0}"],changeDetection:0}),e})();function In(e,t){if(1&e&&(ae.Vb(0,"div",4),ae.Qb(1,"app-spinner",5),ae.Vb(2,"div",6),ae.Pc(3),ae.Ub(),ae.Ub()),2&e){const e=ae.gc();ae.Db(3),ae.Qc(e.loadingLabel)}}function zn(e,t){1&e&&(ae.Vb(0,"div",7),ae.Vb(1,"div",8),ae.Vb(2,"div",9),ae.kc(3),ae.Ub(),ae.Vb(4,"div",10),ae.kc(5,1),ae.Ub(),ae.Vb(6,"div",11),ae.kc(7,2),ae.Ub(),ae.Ub(),ae.kc(8,3),ae.Ub())}const Ln=function(e){return{"column__tab--selected":e}};function Bn(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"span",17),ae.cc("click",(function(){ae.Cc(e);const i=t.$implicit;return ae.gc(3).handleColumnGroupSelect(i)})),ae.Vb(1,"div",18),ae.Pc(2),ae.Ub(),ae.Ub()}if(2&e){const e=t.$implicit,i=ae.gc(3);ae.mc("ngClass",ae.pc(3,Ln,i.isColumnGroupSelected(e))),ae.Db(1),ae.Eb("data-test","column"+e.label),ae.Db(1),ae.Rc(" ",e.label," ")}}function Qn(e,t){if(1&e&&(ae.Vb(0,"div",15),ae.Nc(1,Bn,3,5,"span",16),ae.Ub()),2&e){const e=ae.gc(2);ae.Db(1),ae.mc("ngForOf",e.columnGroups)}}function $n(e,t){1&e&&(ae.Vb(0,"div",19),ae.kc(1,5),ae.Ub())}function qn(e,t){if(1&e&&(ae.Tb(0),ae.Nc(1,Qn,2,1,"div",12),ae.Vb(2,"div",13),ae.kc(3,4),ae.Ub(),ae.Nc(4,$n,2,0,"div",14),ae.Sb()),2&e){const e=ae.gc();ae.Db(1),ae.mc("ngIf",e.columnGroups.length>1),ae.Db(3),ae.mc("ngIf",!e.loading)}}const Gn=[[["","column-nav",""]],[["","column-label",""]],[["","column-actions",""]],[["","column-header",""]],[["app-column-group"]],[["","column-footer",""]]],Hn=["[column-nav]","[column-label]","[column-actions]","[column-header]","app-column-group","[column-footer]"];class Wn{constructor(e,t,i){this.index=e,this.label=t,this.component=i}}let Kn=(()=>{class e{constructor(){this.showHeader=!0,this.loading=!1,this.loadingLabel="",this._selectedColumnGroup=new an.a(0),this.selectedColumnGroupChange=new ae.p,this.next=new ae.p,this.previous=new ae.p,this.ngUnsubscribe=new c.a}get selectedColumnGroup(){return this._selectedColumnGroup.value}set selectedColumnGroup(e){null!=e&&e!==this.selectedColumnGroup&&("string"==typeof e&&(e=e.toUpperCase()),this._selectedColumnGroup.next(e),this.selectedColumnGroupChange.emit(e))}ngAfterContentInit(){this.mapContentGroups(),this._selectedColumnGroup.pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.showColumnGroup(e)})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}handleColumnGroupSelect(e){this.selectedColumnGroup=e.label}mapContentGroups(){this.columnGroups=this.columnGroupsQuery.map((e,t)=>new Wn(t,e.label,e))}showColumnGroup(e){this.columnGroups.forEach((t,i)=>{switch(typeof e){case"number":t.component.isActive=e===i;break;case"string":t.component.isActive=e.toString().toUpperCase()===t.label.toUpperCase()}})}isColumnGroupSelected(e){return("string"==typeof this._selectedColumnGroup.value?e.label.toUpperCase():e.index)===this._selectedColumnGroup.value}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-column"]],contentQueries:function(e,t,i){if(1&e&&ae.Ib(i,Fn,!1),2&e){let e;ae.xc(e=ae.dc())&&(t.columnGroupsQuery=e)}},inputs:{label:"label",showHeader:"showHeader",loading:"loading",loadingLabel:"loadingLabel",selectedColumnGroup:"selectedColumnGroup"},outputs:{selectedColumnGroupChange:"selectedColumnGroupChange",next:"next",previous:"previous"},ngContentSelectors:Hn,decls:4,vars:3,consts:[[1,"column"],["class","column__loading",4,"ngIf"],["class","column__header",4,"ngIf"],[4,"ngIf"],[1,"column__loading"],["size","large"],[1,"column__loading-label"],[1,"column__header"],[1,"column__title"],[1,"column__nav"],[1,"column__label"],[1,"column__actions"],["class","column__tabs",4,"ngIf"],[1,"column__group"],["class","column__footer",4,"ngIf"],[1,"column__tabs"],["class","column__tab",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"column__tab",3,"ngClass","click"],[1,"column__tab-label"],[1,"column__footer"]],template:function(e,t){1&e&&(ae.lc(Gn),ae.Vb(0,"div",0),ae.Nc(1,In,4,1,"div",1),ae.Nc(2,zn,9,0,"div",2),ae.Nc(3,qn,5,2,"ng-container",3),ae.Ub()),2&e&&(ae.Db(1),ae.mc("ngIf",t.loading),ae.Db(1),ae.mc("ngIf",t.showHeader&&!t.loading),ae.Db(1),ae.mc("ngIf",!t.loading))},directives:[n.p,ui.a,n.o,n.m],styles:['.text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}[_nghost-%COMP%]{overflow:hidden}.column[_ngcontent-%COMP%], [_nghost-%COMP%]{display:flex;flex-direction:column;height:100%;flex:1 1 auto}.column[_ngcontent-%COMP%]{overflow-y:hidden}.theme-light[_nghost-%COMP%]   .column__tab[_ngcontent-%COMP%], .theme-light   [_nghost-%COMP%]   .column__tab[_ngcontent-%COMP%]{color:#61779e}.theme-light[_nghost-%COMP%]   .column__tab--selected[_ngcontent-%COMP%], .theme-light   [_nghost-%COMP%]   .column__tab--selected[_ngcontent-%COMP%], .theme-light[_nghost-%COMP%]   .column__tab[_ngcontent-%COMP%]:hover, .theme-light   [_nghost-%COMP%]   .column__tab[_ngcontent-%COMP%]:hover{color:#131c2a}.theme-light[_nghost-%COMP%]   .column__footer[_ngcontent-%COMP%], .theme-light   [_nghost-%COMP%]   .column__footer[_ngcontent-%COMP%]{border-color:#f9fafd}.column__loading[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex:1 1 100%;flex-direction:column}.column__loading-label[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase;padding-top:8px;color:hsla(0,0%,100%,.5)}.column__header[_ngcontent-%COMP%]{flex:0 0 auto}.column__tabs[_ngcontent-%COMP%]{display:flex;flex:0 0 auto;padding:8px 12px 0}.column__tab[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase;color:#96a8c0;padding:8px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.column__tab[_ngcontent-%COMP%]:first-child{padding-left:0}.column__tab[_ngcontent-%COMP%]:after{content:"";display:block;border-bottom:3px solid #2d72dc;margin-top:4px;width:0;transition:.25s ease}.column__tab[_ngcontent-%COMP%]:hover{color:#fff;cursor:pointer}.column__tab--selected[_ngcontent-%COMP%]{color:#fff}.column__tab--selected[_ngcontent-%COMP%]:after{width:100%}.column__tab-label[_ngcontent-%COMP%]{padding:0 4px}.column__title[_ngcontent-%COMP%]{align-items:center;flex:1 1 100%;display:flex;min-height:48px;padding:0 8px}.column__arrow[_ngcontent-%COMP%]{flex:0 0 32px;display:flex}.column__nav[_ngcontent-%COMP%]{display:flex}.column__label[_ngcontent-%COMP%]{flex:1 1 auto;display:flex;min-height:28px;align-items:center;padding:0 8px}.column__actions[_ngcontent-%COMP%]{flex:0 1 auto}.column__search[_ngcontent-%COMP%]{padding:0 12px 8px}.column__body[_ngcontent-%COMP%]{height:100%;overflow-y:scroll}.column__footer[_ngcontent-%COMP%]{border-top:1px solid #283853;flex:0 0 auto}.column__group[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex:1 1 100%;height:100%;overflow:hidden}.column__group-header[_ngcontent-%COMP%]{flex:0 1 auto}'],changeDetection:0}),e})();i("nRae"),i("yG3n");var Jn=i("ewuU"),Xn=i("b36G"),Zn=i("ve2m"),Yn=i("4qFM"),eo=i("awCs");let to=(()=>{class e{constructor(e){this.domSanitizer=e,this.size="medium"}get isTransparent(){return this.color&&Jn.a.isTransparent(this.color)}ngOnInit(){}getBackgroundCSS(){if(this.color&&!this.isTransparent){const e=Jn.a.toCSS(this.color);return this.domSanitizer.bypassSecurityTrustStyle(e)}return null}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(cn.b))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-swatch-item"]],inputs:{color:"color",size:"size",selected:"selected"},decls:1,vars:16,consts:[[1,"item"]],template:function(e,t){1&e&&ae.Qb(0,"div",0),2&e&&(ae.Kc("background-image",t.getBackgroundCSS()),ae.Hb("item--x-small","x-small"===t.size)("item--small","small"===t.size)("item--medium","medium"===t.size)("item--large","large"===t.size)("item--x-large","x-large"===t.size)("item--selected",t.selected)("item--transparent",t.isTransparent))},styles:[".item[_ngcontent-%COMP%]{border:1px solid #eaeff5;border-radius:1px;cursor:pointer}.item--small[_ngcontent-%COMP%]{width:12px;height:12px}.item--medium[_ngcontent-%COMP%]{width:24px;height:24px}.item--large[_ngcontent-%COMP%]{width:36px;height:36px}.item--selected[_ngcontent-%COMP%]{border-color:#2d72dc;border-width:2px}.item--transparent[_ngcontent-%COMP%]{background:linear-gradient(45deg,#f9fafd 48%,#de3535 50%,#f9fafd 52%)}"],changeDetection:0}),e})();var io=i("RGY+"),no=i("FYjP"),oo=function(e,t,i,n){var o,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,i,r):o(t,i))||r);return a>3&&r&&Object.defineProperty(t,i,r),r},ao=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const ro=["presetTab"],so=["customTab"];function co(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"app-swatch-item",24),ae.cc("click",(function(){ae.Cc(e);const i=t.$implicit;return ae.gc().handlePresetSelected(i)})),ae.Ub()}if(2&e){const e=t.$implicit,i=ae.gc();ae.mc("color",e)("size","medium")("selected",i.backgroundsEqual(e,i.presetBackground))}}function lo(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"app-swatch-item",25),ae.cc("click",(function(){ae.Cc(e);const i=t.$implicit;return ae.gc().handlePresetSelected(i)})),ae.Ub()}2&e&&ae.mc("color",t.$implicit)("size","medium")}function po(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"div"),ae.Vb(1,"app-form-field",26),ae.Vb(2,"input",27),ae.cc("colorPickerChange",(function(t){return ae.Cc(e),ae.gc().handleFormColorSelected("color1",t)})),ae.Ub(),ae.Ub(),ae.Ub()}if(2&e){const e=ae.gc();ae.Db(2),ae.Kc("background",e.getFormBackgroundHex("color1")),ae.mc("colorPicker",e.getFormBackgroundHex("color1"))("cpOutputFormat","hex")("cpAlphaChannel","disabled")}}function uo(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"div"),ae.Vb(1,"app-form-field",28),ae.Vb(2,"input",27),ae.cc("colorPickerChange",(function(t){return ae.Cc(e),ae.gc().handleFormColorSelected("color1",t)})),ae.Ub(),ae.Ub(),ae.Vb(3,"app-form-field",29),ae.Qb(4,"app-slider",30),ae.Ub(),ae.Vb(5,"app-form-field",31),ae.Vb(6,"input",27),ae.cc("colorPickerChange",(function(t){return ae.Cc(e),ae.gc().handleFormColorSelected("color2",t)})),ae.Ub(),ae.Ub(),ae.Vb(7,"app-form-field",32),ae.Qb(8,"app-slider",33),ae.Ub(),ae.Ub()}if(2&e){const e=ae.gc();ae.Db(2),ae.Kc("background",e.getFormBackgroundHex("color1")),ae.mc("colorPicker",e.getFormBackgroundHex("color1"))("cpOutputFormat","hex")("cpAlphaChannel","disabled"),ae.Db(2),ae.mc("min",0)("max",100),ae.Db(2),ae.Kc("background",e.getFormBackgroundHex("color2")),ae.mc("colorPicker",e.getFormBackgroundHex("color2"))("cpOutputFormat","hex")("cpAlphaChannel","disabled"),ae.Db(2),ae.mc("min",0)("max",100)}}function ho(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"div"),ae.Vb(1,"app-form-field",34),ae.Vb(2,"input",27),ae.cc("colorPickerChange",(function(t){return ae.Cc(e),ae.gc().handleFormColorSelected("color1",t)})),ae.Ub(),ae.Ub(),ae.Vb(3,"app-form-field",35),ae.Qb(4,"app-slider",30),ae.Ub(),ae.Vb(5,"app-form-field",36),ae.Vb(6,"input",27),ae.cc("colorPickerChange",(function(t){return ae.Cc(e),ae.gc().handleFormColorSelected("color2",t)})),ae.Ub(),ae.Ub(),ae.Vb(7,"app-form-field",37),ae.Qb(8,"app-slider",33),ae.Ub(),ae.Ub()}if(2&e){const e=ae.gc();ae.Db(2),ae.Kc("background",e.getFormBackgroundHex("color1")),ae.mc("colorPicker",e.getFormBackgroundHex("color1"))("cpOutputFormat","hex")("cpAlphaChannel","disabled"),ae.Db(2),ae.mc("min",0)("max",100),ae.Db(2),ae.Kc("background",e.getFormBackgroundHex("color2")),ae.mc("colorPicker",e.getFormBackgroundHex("color2"))("cpOutputFormat","hex")("cpAlphaChannel","disabled"),ae.Db(2),ae.mc("min",0)("max",100)}}function mo(e,t){1&e&&(ae.Vb(0,"div"),ae.Vb(1,"app-alert",38),ae.Pc(2," The background of your application will appear behind the 3D model. "),ae.Ub(),ae.Ub())}let bo=(()=>{class e{constructor(e,t,i,n){this.store=e,this.actions=t,this.fb=i,this.snackBar=n,this.presetBackgrounds="module"===Ht.a.exportType?Object(Xn.plainToClass)(Jn.a,Zn.b):Object(Xn.plainToClass)(Jn.a,Zn.c),this.ngUnsubscribe=new c.a}ngOnInit(){this.initPresets(),this.initForm(),this.actions.pipe(Object(r.k)(A.r),Object(P.a)(this.ngUnsubscribe)).subscribe(()=>{this.snackBar.open("Successfully applied color to all chapters.")})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initPresets(){this.presetBackground=this.store.selectSnapshot(F.a.getSelectedChapterBackground),this.background$.pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.presetBackground=e}),this.allChapterBackgrounds$.pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.distinctBackgrounds=e.filter((t,i)=>e.findIndex(e=>this.backgroundsEqual(t,e))===i)})}initForm(){const e=this.store.selectSnapshot(F.a.getSelectedChapterBackground);this.form=this.fb.group({type:["solid",[G.C.required]],color1:["",[G.C.required]],stop1:[0,[G.C.required,G.C.min(0),G.C.max(100)]],color2:["",[G.C.required]],stop2:[100,[G.C.required,G.C.min(0),G.C.max(100)]]}),this.form.valueChanges.pipe(Object(O.a)(()=>this.customTab.isActive),Object(P.a)(this.ngUnsubscribe)).subscribe(()=>{this.applyFromCustom()}),e&&this.setCustomColorForm(e)}handleFormColorSelected(e,t){this.form.get(e).setValue(t)}handlePresetSelected(e){this.presetBackground=e,this.store.dispatch(new A.I(e))}handleResetClick(){this.store.dispatch(new A.n)}handleTabChange(e){this.customTab.isActive&&this.presetBackground&&this.setCustomColorForm(this.presetBackground)}backgroundsEqual(e,t){return Object(W.isEqual)(e,t)}getBackgroundHex(e){const t=e.colors;return Z.a.rgbToHex([t[0],t[1],t[2]])}getFormBackgroundHex(e){return this.form.get(e).value}applyAll(){const e=this.form.value.type;if(this.presetTab.isActive)this.store.dispatch(new A.r(this.presetBackground));else if(this.customTab.isActive){const t=this.formToBackgroundColor(e);t&&this.store.dispatch(new A.r(t))}}applyFromCustom(){const e=this.formToBackgroundColor(this.form.value.type);e&&this.store.dispatch(new A.I(e))}setCustomColorForm(e){let t="solid",i="",n="",o=0,a=100;const{colors:r,gradientType:s,colorStops:c}=e,l=[r[0],r[1],r[2]],p=r.length<8?l:[r[4],r[5],r[6]];i=Z.a.rgbToHex(l,!1),n=Z.a.rgbToHex(p,!1),t=Jn.a.isTransparent(e)?"transparent":Object(W.isEqual)(l,p)?"solid":s,o=c[0],a=c[1],this.form.patchValue({type:t,color1:i,stop1:o,color2:n,stop2:a})}formToBackgroundColor(e){const{color1:t,color2:i,stop1:n,stop2:o}=this.form.value;if("transparent"===e)return Zn.d;if(!this.form.valid)return null;let a;const r=[],s="radial"===e?"radial":"linear";return t&&r.push(...Z.a.hexToRgb(t,!1),1),i&&"solid"!==e?r.push(...Z.a.hexToRgb(i,!1),1):r.push(...r),a=new Jn.a(r,s,[n,o]),a}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(r.h),ae.Pb(r.b),ae.Pb(G.f),ae.Pb(le.b))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-background-color-dialog"]],viewQuery:function(e,t){if(1&e&&(ae.Jc(ro,!0),ae.Jc(so,!0)),2&e){let e;ae.xc(e=ae.dc())&&(t.presetTab=e.first),ae.xc(e=ae.dc())&&(t.customTab=e.first)}},decls:37,vars:9,consts:[["mat-dialog-title",""],[1,"background","theme-light"],["tabSize","medium","tabTheme","light",3,"activeTabChange"],["label","Presets"],["presetTab",""],[1,"background__section","mt-3"],[1,"background__swatches"],["class","m-1",3,"color","size","selected","click",4,"ngFor","ngForOf"],["app-button","","buttonType","outline","buttonTheme","light","buttonSize","small",1,"mb-4",3,"click"],["label","Currently Used"],["class","m-1",3,"color","size","click",4,"ngFor","ngForOf"],["label","Custom"],["customTab",""],[1,"background__section","mt-4",3,"formGroup","ngSwitch"],["label","Type"],["formControlName","type",1,"input"],["value","solid"],["value","radial"],["value","linear"],["value","transparent"],[4,"ngSwitchCase"],["mat-dialog-actions",""],["app-button","","buttonTheme","light",1,"mr-2",3,"click"],["app-button","","buttonType","flat","buttonTheme","light","cdkFocusInitial","",3,"mat-dialog-close"],[1,"m-1",3,"color","size","selected","click"],[1,"m-1",3,"color","size","click"],["label","Color"],["type","text","cpPosition","left",1,"input",3,"colorPicker","cpOutputFormat","cpAlphaChannel","colorPickerChange"],["label","Inner Color"],["label","Inner Radius"],["theme","light","formControlName","stop1",3,"min","max"],["label","Outer Color"],["label","Outer Radius"],["theme","light","formControlName","stop2",3,"min","max"],["label","Starting Color"],["label","Starting Color Stop"],["label","Ending Color"],["label","Ending Color Stop"],["type","info","theme","light"]],template:function(e,t){1&e&&(ae.Vb(0,"h1",0),ae.Pc(1,"Background Color"),ae.Ub(),ae.Vb(2,"div",1),ae.Vb(3,"app-tabs",2),ae.cc("activeTabChange",(function(e){return t.handleTabChange(e)})),ae.Vb(4,"app-tab",3,4),ae.Vb(6,"div",5),ae.Vb(7,"app-form-field"),ae.Vb(8,"div",6),ae.Nc(9,co,1,3,"app-swatch-item",7),ae.Ub(),ae.Ub(),ae.Vb(10,"button",8),ae.cc("click",(function(){return t.handleResetClick()})),ae.Pc(11," Revert to Original "),ae.Ub(),ae.Vb(12,"app-form-field",9),ae.Vb(13,"div",6),ae.Nc(14,lo,1,2,"app-swatch-item",10),ae.Ub(),ae.Ub(),ae.Ub(),ae.Ub(),ae.Vb(15,"app-tab",11,12),ae.Vb(17,"form",13),ae.Vb(18,"app-form-field",14),ae.Vb(19,"select",15),ae.Vb(20,"option",16),ae.Pc(21,"Solid Color"),ae.Ub(),ae.Vb(22,"option",17),ae.Pc(23,"Radial Gradient"),ae.Ub(),ae.Vb(24,"option",18),ae.Pc(25,"Linear Gradient"),ae.Ub(),ae.Vb(26,"option",19),ae.Pc(27,"Transparent"),ae.Ub(),ae.Ub(),ae.Ub(),ae.Nc(28,po,3,5,"div",20),ae.Nc(29,uo,9,14,"div",20),ae.Nc(30,ho,9,14,"div",20),ae.Nc(31,mo,3,0,"div",20),ae.Ub(),ae.Ub(),ae.Ub(),ae.Ub(),ae.Vb(32,"div",21),ae.Vb(33,"button",22),ae.cc("click",(function(){return t.applyAll()})),ae.Pc(34,"Apply to All"),ae.Ub(),ae.Vb(35,"button",23),ae.Pc(36," Done "),ae.Ub(),ae.Ub()),2&e&&(ae.Db(9),ae.mc("ngForOf",t.presetBackgrounds),ae.Db(5),ae.mc("ngForOf",t.distinctBackgrounds),ae.Db(3),ae.mc("formGroup",t.form)("ngSwitch",t.form.get("type").value),ae.Db(11),ae.mc("ngSwitchCase","solid"),ae.Db(1),ae.mc("ngSwitchCase","radial"),ae.Db(1),ae.mc("ngSwitchCase","linear"),ae.Db(1),ae.mc("ngSwitchCase","transparent"),ae.Db(4),ae.mc("mat-dialog-close",!0))},directives:[H.h,Yn.a,eo.a,de.a,n.o,pe.a,G.E,G.s,G.j,n.r,G.B,G.r,G.i,G.v,G.D,n.s,H.c,H.d,to,ht.a,io.a,no.a],styles:[".background[_ngcontent-%COMP%]{width:256px;min-height:280px}.background__section[_ngcontent-%COMP%]{display:flex;flex-direction:column}.background__swatches[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:wrap}"],changeDetection:0}),oo([Object(r.e)(F.a.getSelectedChapterBackground),ao("design:type",m.a)],e.prototype,"background$",void 0),oo([Object(r.e)(F.a.getAllChaptersBackground),ao("design:type",m.a)],e.prototype,"allChapterBackgrounds$",void 0),oo([Object(r.e)(F.a.getSelectedChapterIndex),ao("design:type",m.a)],e.prototype,"selectedChapterIndex$",void 0),e})();var go=i("7b4e"),fo=i("0E12"),xo=i("rGz1");let yo=(()=>{class e{constructor(e){this.store=e}duplicateChapter(e){const t=go.a.idWithPrefix("chapter"),i=this.store.selectSnapshot(xo.a.particleSystemsForChapter(e.id)).map(e=>new fo.a.AssignParticle(e.id,t));this.store.dispatch(i);const n=this.store.selectSnapshot(xo.a.getTweenParticleLookup)[e.id];void 0!==n&&this.store.dispatch(new fo.a.SetLookupForChapter(t,n)),this.store.dispatch([new Xt.a.UpdateNodesChecked(!1),new Xt.a.DuplicateNodeState(e.id,t),new A.d(e,t)])}removeChapter(e){void 0!==this.store.selectSnapshot(xo.a.getTweenParticleLookup)[e.id]&&this.store.dispatch(new fo.a.DeleteChapterLookup(e.id)),this.store.dispatch(new A.j(e))}}return e.\u0275fac=function(t){return new(t||e)(ae.Zb(r.h))},e.\u0275prov=ae.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const vo=function(e){return[e]},Co=["*"];var Po=function(e){return e.Inline="inline",e.Block="block",e}({});let Oo=(()=>{class e{constructor(){this.render=Po.Inline}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-button-group"]],inputs:{render:"render"},ngContentSelectors:Co,decls:2,vars:3,consts:[[1,"app-button-group",3,"ngClass"]],template:function(e,t){1&e&&(ae.lc(),ae.Vb(0,"div",0),ae.kc(1),ae.Ub()),2&e&&ae.mc("ngClass",ae.pc(1,vo,"app-button-group--"+t.render))},directives:[n.m],styles:[".app-button-group{position:relative}.app-button-group,.app-button-group--inline{display:inline-flex}.app-button-group--block{display:flex}.app-button-group--expanded{display:flex;flex:1 1 auto;justify-content:center}.app-button-group button[app-button]{position:relative;z-index:1;display:flex;flex:1}.app-button-group button[app-button]:hover{z-index:2}.app-button-group button[app-button]:first-child .app-button,.app-button-group button[app-button]:first-child .app-button:after{border-top-right-radius:0;border-bottom-right-radius:0}.app-button-group button[app-button]:last-child .app-button,.app-button-group button[app-button]:last-child .app-button:after{border-top-left-radius:0;border-bottom-left-radius:0}.app-button-group button[app-button]:last-child .app-button{margin-left:1px}.app-button-group button[app-button]:last-child .app-button--outline{margin-left:-1px}.app-button-group button[app-button]:not(:first-child):not(:last-child) .app-button,.app-button-group button[app-button]:not(:first-child):not(:last-child) .app-button:after{border-radius:0}.app-button-group button[app-button]:not(:first-child):not(:last-child) .app-button{margin-left:1px}.app-button-group button[app-button]:not(:first-child):not(:last-child) .app-button--outline{margin-left:-1px}"],encapsulation:2,changeDetection:0}),e})();var wo=function(e,t,i,n){var o,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,i,r):o(t,i))||r);return a>3&&r&&Object.defineProperty(t,i,r),r},ko=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const So=function(e){return{hidden:e}};let _o=(()=>{class e{constructor(e,t,i,n,o,a){this.store=e,this.snackbar=t,this.dialog=i,this.cameraService=n,this.dialogService=o,this.editService=a,this.selected=!1}ngOnInit(){}handleCaptureClick(){this.capturePosition(),this.captureThumbnail(),this.snackbar.open("Successfully captured chapter starting position and thumbnail.")}handleCapturePositionClick(){this.capturePosition(),this.snackbar.open("Successfully captured chapter starting position.")}handleCaptureThumbnailClick(){this.captureThumbnail(),this.snackbar.open("Successfully captured chapter thumbnail.")}handleDuplicateClick(){this.duplicateChapter()}handleRemoveClick(){this.removeChapter()}handleContentClick(){this.openChapterContentDialog(this.chapter.id)}handleBackgroundColorClick(){this.dialog.open(bo,{backdropClass:"backdropClass"})}duplicateChapter(){this.editService.duplicateChapter(this.chapter)}removeChapter(){this.dialogService.openConfirmDialog({data:{titleText:"Remove chapter",bodyText:"This cannot be undone.",confirmText:"Remove",confirmColor:"warn"}}).afterClosed().subscribe(e=>{e&&this.editService.removeChapter(this.chapter)})}captureThumbnail(){const e=this.store.selectSnapshot(F.a.getSelectedChapterBackground);this.store.dispatch(new Ri.b(this.chapter.id,e,ii.a.JPEG,92,ni.a.medium,"square",!1,!1))}capturePosition(){const e=this.cameraService.getCamera(),t=e.look,i=this.cameraService.getCameraRotationCenter();let n;this.cameraService.compareXYZ(t,i)||(n=i),this.store.dispatch(new A.i(this.chapter.id,e,n))}openChapterContentDialog(e){this.dialog.open(Bt,{width:"60vw",height:"auto",data:{chapterId:e}})}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(r.h),ae.Pb(le.b),ae.Pb(H.b),ae.Pb(fn.a),ae.Pb(yn.a),ae.Pb(yo))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-chapter-actions"]],inputs:{chapter:"chapter",selected:"selected"},decls:24,vars:22,consts:[[1,"flex"],[1,"mr-2",3,"ngClass"],["app-button","","buttonTheme","dark","buttonType","flat","buttonSize","xsmall","matTooltip","Click to capture your starting position. When viewers enter the chapter, this is what they'll see.","matTooltipPosition","below","data-test","captureThumbnail",3,"click"],["app-button","","buttonTheme","dark","buttonType","flat","buttonSize","xsmall",3,"matMenuTriggerFor"],["icon","caret-down"],["captureMenu","matMenu"],["mat-menu-item","",3,"click"],["app-button","","buttonTheme","dark","buttonType","outline","buttonSize","xsmall","matTooltipPosition","below",1,"mr-1",3,"ngClass","click"],["app-button","","buttonTheme","dark","buttonType","outline","buttonSize","xsmall","matTooltip","Background Color","matTooltipPosition","below",1,"mr-1",3,"ngClass","click"],[3,"color","size"],[3,"ngClass"],["app-button","","buttonTheme","dark","buttonType","outline","buttonSize","xsmall","matTooltipPosition","below","matTooltip","Duplicate This Chapter","data-test","duplicateChapter",3,"click"],["size","sm","icon","clone"],["app-button","","buttonTheme","dark","buttonType","outline","buttonSize","xsmall","matTooltipPosition","below","matTooltip","Remove Chapter",3,"disabled","click"],["size","sm","icon","trash-alt"]],template:function(e,t){if(1&e&&(ae.Vb(0,"div",0),ae.Vb(1,"app-button-group",1),ae.hc(2,"async"),ae.Vb(3,"button",2),ae.cc("click",(function(){return t.handleCaptureClick()})),ae.Pc(4," Capture "),ae.Ub(),ae.Vb(5,"button",3),ae.Qb(6,"app-icon",4),ae.Ub(),ae.Ub(),ae.Vb(7,"mat-menu",null,5),ae.Vb(9,"button",6),ae.cc("click",(function(){return t.handleCapturePositionClick()})),ae.Pc(10,"Capture Position Only"),ae.Ub(),ae.Vb(11,"button",6),ae.cc("click",(function(){return t.handleCaptureThumbnailClick()})),ae.Pc(12,"Capture Thumbnail Only"),ae.Ub(),ae.Ub(),ae.Vb(13,"button",7),ae.cc("click",(function(){return t.handleContentClick()})),ae.Pc(14," Edit Text "),ae.Ub(),ae.Vb(15,"button",8),ae.cc("click",(function(){return t.handleBackgroundColorClick()})),ae.Qb(16,"app-swatch-item",9),ae.hc(17,"async"),ae.Ub(),ae.Vb(18,"app-button-group",10),ae.Vb(19,"button",11),ae.cc("click",(function(){return t.handleDuplicateClick()})),ae.Qb(20,"app-icon",12),ae.Ub(),ae.Vb(21,"button",13),ae.cc("click",(function(){return t.handleRemoveClick()})),ae.hc(22,"async"),ae.Qb(23,"app-icon",14),ae.Ub(),ae.Ub(),ae.Ub()),2&e){const e=ae.yc(8);let i=null;ae.Db(1),ae.mc("ngClass",ae.pc(14,So,!t.selected||ae.ic(2,8,t.autoCapture$))),ae.Db(4),ae.mc("matMenuTriggerFor",e),ae.Db(8),ae.mc("ngClass",ae.pc(16,So,!t.selected)),ae.Db(2),ae.mc("ngClass",ae.pc(18,So,!t.selected)),ae.Db(1),ae.mc("color",ae.ic(17,10,t.background$))("size","small"),ae.Db(2),ae.mc("ngClass",ae.pc(20,So,!t.selected)),ae.Db(3),ae.mc("disabled",1===(null==(i=ae.ic(22,12,t.chapters$))?null:i.length))}},directives:[Oo,n.m,pe.a,st.c,Sn.d,at.a,Sn.a,Sn.b,to],pipes:[n.b],styles:[""],changeDetection:0}),wo([Object(r.e)(F.a.getStoryChapters),ko("design:type",m.a)],e.prototype,"chapters$",void 0),wo([Object(r.e)(Ai.a.getRegisteredThumbnails),ko("design:type",m.a)],e.prototype,"thumbnails$",void 0),wo([Object(r.e)(F.a.getSelectedChapterBackground),ko("design:type",m.a)],e.prototype,"background$",void 0),wo([Object(r.e)(f.a.getAutoCapture),ko("design:type",m.a)],e.prototype,"autoCapture$",void 0),e})();const Mo=["cardThumbnail"];function Uo(e,t){1&e&&(ae.Vb(0,"span",11),ae.Pc(1,"No title"),ae.Ub())}function To(e,t){if(1&e&&(ae.Qb(0,"div",12),ae.hc(1,"markdown")),2&e){const e=ae.gc();ae.mc("innerHTML",ae.ic(1,1,e.shortDescription),ae.Dc)}}function Vo(e,t){1&e&&(ae.Vb(0,"div",13),ae.Vb(1,"span",11),ae.Pc(2,"No description"),ae.Ub(),ae.Ub())}let Do=(()=>{class e{constructor(e){this.renderer=e,this.canRemove=!0,this._snapshot="",this.duplicate=new ae.p,this.remove=new ae.p}get chapter(){return this._chapter}set chapter(e){this._chapter=e}get thumbnail(){return this._thumbnail}set thumbnail(e){e&&e.snapshot!==this._snapshot&&(this._snapshot=e.snapshot,this._thumbnail=e,null!=e?this.setImageStyle(this.thumbnail):this.clearImageStyle())}get shortDescription(){const e=Object(W.get)(this.chapter,"info.description")||"";return e.length<=48?e:e.replace("<br>","").substr(0,45)+"..."}ngOnInit(){}setImageStyle(e){let t=this.thumbnail.snapshot?this.thumbnail.snapshot:this.thumbnail.urls.small;const i=(new Date).valueOf();t.startsWith("blob:")||(t=`${t}?cb=${i}&uncached=true`),this.renderer.setStyle(this.cardThumbnail.nativeElement,"background-size","cover"),this.renderer.setStyle(this.cardThumbnail.nativeElement,"background-image",`url(${t})`)}clearImageStyle(){this.renderer.removeStyle(this.cardThumbnail.nativeElement,"background-size"),this.renderer.removeStyle(this.cardThumbnail.nativeElement,"background-image")}handleDuplicateClick(){this.duplicate.emit(this.chapter)}handleRemoveClick(){this.remove.emit(this.chapter)}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(ae.H))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-chapter-card"]],viewQuery:function(e,t){if(1&e&&ae.Jc(Mo,!0,ae.m),2&e){let e;ae.xc(e=ae.dc())&&(t.cardThumbnail=e.first)}},inputs:{chapter:"chapter",selected:"selected",canRemove:"canRemove",thumbnail:"thumbnail"},outputs:{duplicate:"duplicate",remove:"remove"},decls:12,vars:8,consts:[["data-test","chapterCard",1,"chapter-card"],[1,"chapter-card__content"],[1,"chapter-card__image"],["cardThumbnail",""],[1,"chapter-card__body"],[1,"chapter-card__title"],["class","text-italic text-dim",4,"ngIf"],["class","chapter-card__description html",3,"innerHTML",4,"ngIf"],["class","chapter-card__description",4,"ngIf"],[1,"chapter-card__actions"],[3,"selected","chapter"],[1,"text-italic","text-dim"],[1,"chapter-card__description","html",3,"innerHTML"],[1,"chapter-card__description"]],template:function(e,t){1&e&&(ae.Vb(0,"div",0),ae.Vb(1,"div",1),ae.Qb(2,"div",2,3),ae.Vb(4,"div",4),ae.Vb(5,"div",5),ae.Pc(6),ae.Nc(7,Uo,2,0,"span",6),ae.Ub(),ae.Nc(8,To,2,3,"div",7),ae.Nc(9,Vo,3,0,"div",8),ae.Ub(),ae.Ub(),ae.Vb(10,"div",9),ae.Qb(11,"app-chapter-actions",10),ae.Ub(),ae.Ub()),2&e&&(ae.Hb("chapter-card--selected",t.selected),ae.Db(6),ae.Rc(" ",t.chapter.info.displayName," "),ae.Db(1),ae.mc("ngIf",!t.chapter.info.displayName),ae.Db(1),ae.mc("ngIf",t.shortDescription),ae.Db(1),ae.mc("ngIf",!t.shortDescription),ae.Db(2),ae.mc("selected",t.selected)("chapter",t.chapter))},directives:[n.p,_o],pipes:[Ze.b],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.chapter-card[_ngcontent-%COMP%]{position:relative;border-radius:4px;padding:8px;transition:background-color .12s}.chapter-card[_ngcontent-%COMP%]:active{cursor:-webkit-grabbing;cursor:grabbing}.chapter-card--selected[_ngcontent-%COMP%]:hover, .chapter-card[_ngcontent-%COMP%]:hover{background-color:rgba(40,56,83,.7);cursor:pointer}.chapter-card--selected[_ngcontent-%COMP%]:hover   .chapter-card__title[_ngcontent-%COMP%], .chapter-card[_ngcontent-%COMP%]:hover   .chapter-card__title[_ngcontent-%COMP%]{color:#fff}.chapter-card--loading[_ngcontent-%COMP%]{background:rgba(28,42,63,.8);display:flex;margin:-4px;position:absolute;top:0;left:0;right:0;bottom:0;justify-content:center;align-items:center}.chapter-card--selected[_ngcontent-%COMP%]{background:#1c2a3f}.chapter-card--selected[_ngcontent-%COMP%]   .chapter-card__image[_ngcontent-%COMP%]{border-color:#2d72dc}.chapter-card--selected[_ngcontent-%COMP%]   .chapter-card__description[_ngcontent-%COMP%], .chapter-card--selected[_ngcontent-%COMP%]   .chapter-card__title[_ngcontent-%COMP%]{color:#fff}.chapter-card__content[_ngcontent-%COMP%]{display:flex}.chapter-card__image[_ngcontent-%COMP%]{background:#283853 url(/assets/images/logo-dark-transparent.svg) 50% no-repeat;background-size:25% 25%;border-radius:4px;border:2px solid transparent;flex:0 0 90px;height:90px;position:relative}.chapter-card__body[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex-grow:1;padding:0 0 0 12px;overflow:hidden}.chapter-card__title[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em;font-weight:700;word-break:break-word;color:#d7e0ea;white-space:normal}.chapter-card__description[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em;color:#d7e0ea}.chapter-card__actions[_ngcontent-%COMP%]{margin-top:8px;text-align:right}"],changeDetection:0}),e})();var Eo=i("EETq"),jo=function(e,t,i,n){var o,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,i,r):o(t,i))||r);return a>3&&r&&Object.defineProperty(t,i,r),r},No=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let Ro=(()=>{class e{constructor(e,t,i,n){this.store=e,this.storageService=t,this.dialogRef=i,this.changeDetectorRef=n,this.application=Ht.a.application,this.actionMode=Ji.a.Import,this.contentType=Qt.a.Module,this.ngUnsubscribe=new c.a}ngOnInit(){this.initGallery(),this.observeSearchConfig()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initGallery(){const e=this.getDefaultSearchConfig(),t=this.store.selectSnapshot(en.a.getSearchOptions)||new Zi.a("",Ki.f);this.store.dispatch(new Yi.a.SetCardActions({enabled:!1})),this.store.dispatch(new Yi.a.SetBulkActions({enabled:!1,items:[]})),this.store.dispatch(new Yi.a.SetSearchConfig(e)),this.store.dispatch(new Yi.a.SetSearchOptions(t))}observeSearchConfig(){this.searchConfig$.pipe(Object(Dn.a)((e,t)=>Object(W.isEqual)(e,t)),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.contentType=e.type===Eo.a.Category?Qt.a.Module:Qt.a.Bookmark,e.type===Eo.a.Loft&&this.saveSearchConfig(e),this.changeDetectorRef.markForCheck()})}handleSelect(e){this.store.dispatch(new Yi.a.SelectBookmark(e)),this.dialogRef.close(e)}getDefaultSearchConfig(){if(Ht.a.application===ne.a.Studio)return new Xi.a("all");{const e=this.storageService.getLocalJSON(ai.b.RecentSearchConfig);if((null==e?void 0:e.type)===Eo.a.Loft){const{primary:t,secondary:i}=e;return new Xi.e(t,i)}return new Xi.e("production","maleAdult")}}saveSearchConfig({type:e,primary:t,secondary:i}){this.storageService.setLocalItem(ai.b.RecentSearchConfig,{type:e,primary:t,secondary:i})}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(r.h),ae.Pb(ai.d),ae.Pb(H.g),ae.Pb(ae.i))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-import-model-dialog"]],decls:5,vars:5,consts:[[1,"import"],[1,"text-20","import__header"],[1,"import__body"],["selectLabel","Import",3,"actionMode","actionsEnabled","application","contentType","showSourcePicker","selectBookmark"]],template:function(e,t){1&e&&(ae.Vb(0,"div",0),ae.Vb(1,"div",1),ae.Pc(2,"Import Chapters"),ae.Ub(),ae.Vb(3,"div",2),ae.Vb(4,"app-gallery-container",3),ae.cc("selectBookmark",(function(e){return t.handleSelect(e)})),ae.Ub(),ae.Ub(),ae.Ub()),2&e&&(ae.Db(4),ae.mc("actionMode",t.actionMode)("actionsEnabled",!1)("application",t.application)("contentType",t.contentType)("showSourcePicker",!0))},directives:[tn.a],styles:["[_nghost-%COMP%]{display:block;height:calc(90vh - 48px);width:calc(90vw - 48px);position:relative;padding:0 0 12px}.import[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}.import__header[_ngcontent-%COMP%]{border-bottom:1px solid rgba(0,0,0,.12);padding:8px 20px;display:flex;align-items:center}.import__body[_ngcontent-%COMP%]{flex:1 0 auto;position:relative}"],changeDetection:0}),jo([Object(r.e)(en.a.getViewMode),No("design:type",m.a)],e.prototype,"viewMode$",void 0),jo([Object(r.e)(en.a.getLoading),No("design:type",m.a)],e.prototype,"loading$",void 0),jo([Object(r.e)(en.a.getFilteredResults),No("design:type",m.a)],e.prototype,"results$",void 0),jo([Object(r.e)(en.a.getSearchConfig),No("design:type",m.a)],e.prototype,"searchConfig$",void 0),jo([Object(r.e)(q.a.isPremiumUser),No("design:type",m.a)],e.prototype,"isPremiumUser$",void 0),e})();var Ao=i("hQeY"),Fo=function(e,t,i,n){var o,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,i,r):o(t,i))||r);return a>3&&r&&Object.defineProperty(t,i,r),r},Io=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const zo=["chapterBrowser"];function Lo(e,t){1&e&&(ae.Vb(0,"div",9),ae.Qb(1,"app-spinner",10),ae.Ub())}function Bo(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"div",11),ae.Vb(1,"app-chapter-card",12),ae.cc("click",(function(){ae.Cc(e);const i=t.$implicit;return ae.gc().handleClickChapter(i)}))("remove",(function(t){return ae.Cc(e),ae.gc().handleRemove(t)}))("duplicate",(function(t){return ae.Cc(e),ae.gc().handleDuplicate(t)})),ae.hc(2,"async"),ae.hc(3,"async"),ae.hc(4,"async"),ae.Ub(),ae.Ub()}if(2&e){const e=t.$implicit,i=ae.gc();let n=null,o=null;ae.Db(1),ae.mc("id","chapter-card__"+e.id)("chapter",e)("thumbnail",null==(n=ae.ic(2,5,i.thumbnails$))?null:n.get(e.id))("selected",(null==(o=ae.ic(3,7,i.selectedChapter$))?null:o.id)===e.id)("canRemove",ae.ic(4,9,i.chapters$).length>1)}}let Qo=(()=>{class e{constructor(e,t,i){this.store=e,this.editService=t,this.dialog=i,this.ngUnsubscribe=new c.a,this.currentChapterId=""}ngOnInit(){}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}ngAfterViewInit(){this.selectedChapter$.pipe(Object(O.a)(e=>null!=e),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.currentChapterId=e.id,setTimeout(()=>{this.scrollChapterIntoView(e)})})}handleDrop(e){this.store.dispatch(new A.m(e.previousIndex,e.currentIndex))}handleClickChapter(e){e.id!==this.currentChapterId&&this.store.dispatch(new A.p(e))}handleImportChapters(){this.dialog.open(Ro,{id:Vi.a.ImportDialog,maxWidth:"90vw",width:"90vw",height:"90vh"}).afterClosed().pipe(Object(O.a)(e=>null!=e)).subscribe(e=>{const t=this.store.selectSnapshot(q.a.getUserLanguage);this.store.dispatch(new V.c(e.id,e.type,t))})}handleNextClick(){this.store.dispatch(new A.g)}handlePreviousClick(){this.store.dispatch(new A.h)}handleDuplicate(e){this.duplicateChapter(e)}handleDuplicateSelected(){const e=this.store.selectSnapshot(F.a.getSelectedChapter);this.duplicateChapter(e)}handleRemove(e){this.removeChapter(e)}duplicateChapter(e){this.editService.duplicateChapter(e)}removeChapter(e){this.dialog.open(Ao.a,{data:{titleText:"Remove chapter",bodyText:"This cannot be undone.",confirmText:"Remove",confirmColor:"warn"}}).afterClosed().subscribe(t=>{t&&this.editService.removeChapter(e)})}trackChapter(e,t){return t.id}scrollChapterIntoView(e){const t=document.getElementById("chapter-card__"+e.id);"scrollBehavior"in document.documentElement.style&&t&&t.scrollIntoView({behavior:"smooth",block:"nearest"})}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(r.h),ae.Pb(yo),ae.Pb(H.b))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-chapter-browser"]],viewQuery:function(e,t){if(1&e&&(ae.Jc(zo,!0),ae.Vc(Do,!0)),2&e){let e;ae.xc(e=ae.dc())&&(t.chapterBrowserElement=e.first),ae.xc(e=ae.dc())&&(t.chapterCards=e)}},decls:16,vars:11,consts:[["data-test","chapterBrowser","cdkDropList","","cdkDropListOrientation","vertical",1,"chapter-browser",3,"cdkDropListDropped"],["chapterBrowser",""],["data-test","chapterSpinner","class","chapter-browser__scrim",4,"ngIf"],["class","chapter-browser__item","cdkDrag","",4,"ngFor","ngForOf","ngForTrackBy"],["app-button","","buttonType","outline","data-test","addChapter",1,"chapter-browser__add",3,"matMenuTriggerFor"],["icon","angle-down"],["importMenu","matMenu"],["mat-menu-item","",2,"min-width","240px",3,"click"],["mat-menu-item","","data-test","importChapter",3,"click"],["data-test","chapterSpinner",1,"chapter-browser__scrim"],["size","huge"],["cdkDrag","",1,"chapter-browser__item"],[3,"id","chapter","thumbnail","selected","canRemove","click","remove","duplicate"]],template:function(e,t){if(1&e&&(ae.Vb(0,"div",0,1),ae.cc("cdkDropListDropped",(function(e){return t.handleDrop(e)})),ae.Nc(2,Lo,2,0,"div",2),ae.hc(3,"async"),ae.Nc(4,Bo,5,11,"div",3),ae.hc(5,"async"),ae.Vb(6,"button",4),ae.Pc(7," Add Chapter "),ae.Qb(8,"app-icon",5),ae.Ub(),ae.Ub(),ae.Vb(9,"mat-menu",null,6),ae.Vb(11,"button",7),ae.cc("click",(function(){return t.handleDuplicateSelected()})),ae.Pc(12),ae.hc(13,"async"),ae.Ub(),ae.Vb(14,"button",8),ae.cc("click",(function(){return t.handleImportChapters()})),ae.Pc(15," Import Chapters... "),ae.Ub(),ae.Ub()),2&e){const e=ae.yc(10);let i=null;ae.Db(2),ae.mc("ngIf",!ae.ic(3,5,t.allChaptersLoaded$)),ae.Db(2),ae.mc("ngForOf",ae.ic(5,7,t.chapters$))("ngForTrackBy",t.trackChapter),ae.Db(2),ae.mc("matMenuTriggerFor",e),ae.Db(6),ae.Rc(' Duplicate "',(null==(i=ae.ic(13,9,t.selectedChapter$))?null:i.info.displayName)||"Chapter",'" ')}},directives:[ot.c,n.p,n.o,pe.a,Sn.d,at.a,Sn.a,Sn.b,ui.a,ot.a,Do],pipes:[n.b],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.chapter-browser[_ngcontent-%COMP%]{display:flex;flex-direction:column;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:relative}.chapter-browser__scrim[_ngcontent-%COMP%]{background:rgba(16,24,35,.5);display:flex;justify-content:center;align-items:center;position:absolute;z-index:9;left:0;right:0;top:0;bottom:0}.chapter-browser__item[_ngcontent-%COMP%]{flex:0 0 100%;display:block;padding:8px 0}.chapter-browser__item[_ngcontent-%COMP%]:last-child{border-bottom:0}.chapter-browser__item.cdk-drag-preview[_ngcontent-%COMP%]{box-sizing:border-box;border-radius:4px 4px 0 0;box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12)}.chapter-browser__item.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.chapter-browser__add[_ngcontent-%COMP%]{margin:8px 0 0}.chapter-browser__new[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em;border-radius:4px;color:#374a68;min-height:60px;width:100%;border:1px dashed #374a68;display:flex;justify-content:center;align-items:center;text-align:center;margin:8px 0;padding:12px;transition:border-color .06s,color}.chapter-browser__new[_ngcontent-%COMP%]:hover{border-color:#fff;color:#fff;cursor:pointer}.chapter-browser[_ngcontent-%COMP%]   .cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:.2}.chapter-browser[_ngcontent-%COMP%]   .cdk-drop-list-dragging[_ngcontent-%COMP%]   .chapter-browser__item[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}"],changeDetection:0}),Fo([Object(r.e)(F.a.getStoryChapters),Io("design:type",m.a)],e.prototype,"chapters$",void 0),Fo([Object(r.e)(F.a.getSelectedChapter),Io("design:type",m.a)],e.prototype,"selectedChapter$",void 0),Fo([Object(r.e)(Ai.a.getRegisteredThumbnails),Io("design:type",m.a)],e.prototype,"thumbnails$",void 0),Fo([Object(r.e)(F.a.getAllChaptersModelsReady),Io("design:type",m.a)],e.prototype,"allChaptersLoaded$",void 0),e})();var $o=i("EF3F"),qo=i("7u76"),Go=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Ho(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"button",21),ae.cc("click",(function(){return ae.Cc(e),ae.gc().handleSelectAll()})),ae.Pc(1," Select All Structures\n"),ae.Ub()}}function Wo(e,t){1&e&&(ae.Vb(0,"span"),ae.Pc(1,"structure"),ae.Ub())}function Ko(e,t){1&e&&(ae.Vb(0,"span"),ae.Pc(1,"structures"),ae.Ub())}function Jo(e,t){if(1&e&&(ae.Vb(0,"button",22),ae.Pc(1),ae.hc(2,"number"),ae.Nc(3,Wo,2,0,"span",23),ae.Nc(4,Ko,2,0,"span",23),ae.Pc(5," selected "),ae.Qb(6,"app-icon",24),ae.Ub()),2&e){const e=ae.gc(),t=ae.yc(3);ae.mc("matMenuTriggerFor",t),ae.Db(1),ae.Rc(" ",ae.ic(2,4,e.count)," "),ae.Db(2),ae.mc("ngIf",1===e.count),ae.Db(1),ae.mc("ngIf",e.count>1)}}let Xo=(()=>{class e{constructor(e,t,i){this.store=e,this.changeDetector=t,this.graphService=i,this.leaves=[],this.count=0,this.ngUnsubscribe=new c.a}ngOnInit(){this.checkedNodes$.pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{const t=this.store.selectSnapshot($t.a.getCheckedNodeIds);this.count=t.length,this.changeDetector.markForCheck()})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}handleClearSelection(){this.store.dispatch(new Xt.a.UpdateNodesChecked(!1))}handleBulkShow(){this.store.dispatch(new Xt.a.UpdateNodesShown(!0,this.store.selectSnapshot($t.a.getCheckedNodeIds)))}handleBulkHide(){const e=this.store.selectSnapshot($t.a.getNodes),t=Object.values(e).reduce((e,t)=>(e[t.objectId]=!t.checked&&t.shown,e),{});this.store.dispatch(new Xt.a.UpdateNodesShown(!1,[],t))}handleHideInverse(){const e=this.store.selectSnapshot($t.a.getNodes),t=Object.values(e).reduce((e,t)=>(e[t.objectId]=!!t.checked&&t.shown,e),{});this.store.dispatch(new Xt.a.UpdateNodesShown(!1,[],t))}handleSelectInverse(){const e=this.store.selectSnapshot($t.a.getNodes),t=Object.values(e).reduce((e,t)=>(e[t.objectId]=!t.checked,e),{});this.store.dispatch(new Xt.a.UpdateNodesChecked(!1,[],t))}handleSelectAll(){this.store.dispatch(new Xt.a.UpdateNodesChecked(!0))}handleBulkPickable(e){const t=this.store.selectSnapshot($t.a.getNodes),i=Object.values(t).reduce((t,i)=>(t[i.objectId]=i.checked?e:i.pickable,t),{});this.store.dispatch(new Xt.a.UpdateNodesPickable(!1,[],i))}handleInverseUnpickable(){const e=this.store.selectSnapshot($t.a.getNodes),t=Object.values(e).reduce((e,t)=>(e[t.objectId]=!!t.checked&&t.pickable,e),{});this.store.dispatch(new Xt.a.UpdateNodesPickable(!1,[],t))}handleFadeSelected(){const e=this.store.selectSnapshot($t.a.getCheckedNodeIds);this.store.dispatch(new Xt.a.UpdateNodesPaint($o.b,e))}handleFadeInverse(){const e=this.store.selectSnapshot($t.a.getCheckedNodeIds),t=this.store.selectSnapshot(x.a.getViewGraph),i=this.graphService.getInverseSelection(t,e);this.store.dispatch(new Xt.a.UpdateNodesPaint($o.b,i))}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(r.h),ae.Pb(ae.i),ae.Pb(qo.a))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-checked-nodes"]],decls:43,vars:6,consts:[["app-button","","buttonSize","xsmall","data-test","selectAllStructures",3,"click",4,"ngIf"],["app-button","","buttonSize","xsmall","data-test","selectedNodesMenu",3,"matMenuTriggerFor",4,"ngIf"],["checkAllMenu","matMenu"],["mat-menu-item","","data-test","selectActionsMenu",3,"matMenuTriggerFor"],["mat-menu-item","","data-test","showHideMenu",3,"matMenuTriggerFor"],["data-test","nodeActionsFadeTrigger","mat-menu-item","",3,"matMenuTriggerFor"],["mat-menu-item","","data-test","pickableMenu",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],["selectActions","matMenu"],["mat-menu-item","","data-test","selectEverythingElse",3,"click"],["showHideActions","matMenu"],["mat-menu-item","","data-test","showSelected",3,"click"],["mat-menu-item","","data-test","hideSelected",3,"click"],["mat-menu-item","","data-test","hideEverythingElse",3,"click"],["fadeActions","matMenu"],["mat-menu-item","","data-test","fadeThis",3,"click"],["mat-menu-item","","data-test","fadeEverythingElse",3,"click"],["pickableActions","matMenu"],["mat-menu-item","","data-test","makePickable",3,"click"],["mat-menu-item","","data-test","makeUnpickable",3,"click"],["mat-menu-item","","data-test","makeEverythingElseUnpickable",3,"click"],["app-button","","buttonSize","xsmall","data-test","selectAllStructures",3,"click"],["app-button","","buttonSize","xsmall","data-test","selectedNodesMenu",3,"matMenuTriggerFor"],[4,"ngIf"],["icon","caret-down"]],template:function(e,t){if(1&e&&(ae.Nc(0,Ho,2,0,"button",0),ae.Nc(1,Jo,7,6,"button",1),ae.Vb(2,"mat-menu",null,2),ae.Vb(4,"button",3),ae.Pc(5," Select "),ae.Ub(),ae.Vb(6,"button",4),ae.Pc(7," Show / Hide "),ae.Ub(),ae.Vb(8,"button",5),ae.Pc(9," Fade "),ae.Ub(),ae.Vb(10,"button",6),ae.Pc(11," Selectable / Unselectable "),ae.Ub(),ae.Qb(12,"mat-divider"),ae.Vb(13,"button",7),ae.cc("click",(function(){return t.handleClearSelection()})),ae.Pc(14,"Clear Selection"),ae.Ub(),ae.Ub(),ae.Vb(15,"mat-menu",null,8),ae.Vb(17,"button",9),ae.cc("click",(function(){return t.handleSelectInverse()})),ae.Pc(18," Select Everything Else "),ae.Ub(),ae.Ub(),ae.Vb(19,"mat-menu",null,10),ae.Vb(21,"button",11),ae.cc("click",(function(){return t.handleBulkShow()})),ae.Pc(22,"Show Selected"),ae.Ub(),ae.Vb(23,"button",12),ae.cc("click",(function(){return t.handleBulkHide()})),ae.Pc(24,"Hide Selected"),ae.Ub(),ae.Qb(25,"mat-divider"),ae.Vb(26,"button",13),ae.cc("click",(function(){return t.handleHideInverse()})),ae.Pc(27," Hide Everything Else "),ae.Ub(),ae.Ub(),ae.Vb(28,"mat-menu",null,14),ae.Vb(30,"button",15),ae.cc("click",(function(){return t.handleFadeSelected()})),ae.Pc(31,"Fade Selected"),ae.Ub(),ae.Vb(32,"button",16),ae.cc("click",(function(){return t.handleFadeInverse()})),ae.Pc(33," Fade Everything Else "),ae.Ub(),ae.Ub(),ae.Vb(34,"mat-menu",null,17),ae.Vb(36,"button",18),ae.cc("click",(function(){return t.handleBulkPickable(!0)})),ae.Pc(37," Make Selectable "),ae.Ub(),ae.Vb(38,"button",19),ae.cc("click",(function(){return t.handleBulkPickable(!1)})),ae.Pc(39," Make Unselectable "),ae.Ub(),ae.Qb(40,"mat-divider"),ae.Vb(41,"button",20),ae.cc("click",(function(){return t.handleInverseUnpickable()})),ae.Pc(42," Make Everything Else Unselectable "),ae.Ub(),ae.Ub()),2&e){const e=ae.yc(16),i=ae.yc(20),n=ae.yc(29),o=ae.yc(35);ae.mc("ngIf",0===t.count),ae.Db(1),ae.mc("ngIf",t.count>0),ae.Db(3),ae.mc("matMenuTriggerFor",e),ae.Db(2),ae.mc("matMenuTriggerFor",i),ae.Db(2),ae.mc("matMenuTriggerFor",n),ae.Db(2),ae.mc("matMenuTriggerFor",o)}},directives:[n.p,Sn.a,Sn.b,Sn.d,me.a,pe.a,at.a],pipes:[n.f],styles:[""],changeDetection:0}),function(e,t,i,n){var o,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,i,r):o(t,i))||r);a>3&&r&&Object.defineProperty(t,i,r)}([Object(r.e)($t.a.getCheckedNodes),Go("design:type",m.a)],e.prototype,"checkedNodes$",void 0),e})();var Zo=i("NEgD"),Yo=i("vxfF"),ea=i("rY+M"),ta=function(e,t,i,n){var o,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,i,r):o(t,i))||r);return a>3&&r&&Object.defineProperty(t,i,r),r},ia=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const na=["columnBody"],oa=["columnGroupBody"],aa=["searchInput"];function ra(e,t){if(1&e&&(ae.Vb(0,"button",31),ae.Qb(1,"app-icon",32),ae.Ub()),2&e){ae.gc();const e=ae.yc(11);ae.mc("matMenuTriggerFor",e)}}function sa(e,t){if(1&e){const e=ae.Wb();ae.Tb(0),ae.Qb(1,"mat-divider"),ae.Vb(2,"button",9),ae.cc("click",(function(){return ae.Cc(e),ae.gc().applyCameraClick("single")})),ae.Pc(3," Apply Camera Position to This Chapter "),ae.Ub(),ae.Vb(4,"button",9),ae.cc("click",(function(){return ae.Cc(e),ae.gc().applyCameraClick("all")})),ae.Pc(5," Apply Camera Position to All Chapters "),ae.Ub(),ae.Sb()}if(2&e){const e=ae.gc();ae.Db(2),ae.mc("disabled",!e.storedCamera),ae.Db(2),ae.mc("disabled",!e.storedCamera)}}function ca(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"button",33),ae.cc("click",(function(){return ae.Cc(e),ae.gc().clearQuery()})),ae.Pc(1," Clear "),ae.Ub()}}function la(e,t){if(1&e&&(ae.Vb(0,"button",34),ae.Qb(1,"app-icon",35),ae.Ub()),2&e){ae.gc();const e=ae.yc(37);ae.mc("matMenuTriggerFor",e)}}function pa(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"button",36),ae.cc("click",(function(){return ae.Cc(e),ae.gc().setLayerOrderMode(!1)})),ae.Qb(1,"app-icon",37),ae.Ub()}}function da(e,t){if(1&e&&(ae.Vb(0,"div",38),ae.Qb(1,"app-tree",39),ae.Ub()),2&e){const e=ae.gc();ae.Db(1),ae.mc("theme",e.themeEnum.Dark)}}function ua(e,t){if(1&e&&(ae.Vb(0,"div"),ae.Qb(1,"app-tree-nested-node",42),ae.hc(2,"async"),ae.Ub()),2&e){const e=t.$implicit,i=ae.gc(2);ae.Db(1),ae.mc("theme",i.themeEnum.Dark)("node",e)("graph",ae.ic(2,4,i.viewGraph$))("nested",!1)}}function ha(e,t){if(1&e&&(ae.Vb(0,"cdk-virtual-scroll-viewport",40),ae.Nc(1,ua,3,6,"div",41),ae.Ub()),2&e){const e=ae.gc();ae.Kc("height",e.searchHeight,"px"),ae.mc("itemSize",48),ae.Db(1),ae.mc("cdkVirtualForOf",e.searchResults)("cdkVirtualForTrackBy",e.trackTreeNode)}}let ma=(()=>{class e{constructor(e,t,i,n,o,a){this.store=e,this.renderer=t,this.changeDetector=i,this.engineEventsService=n,this.cameraService=o,this.snackbar=a,this.application=ne.a,this.themeEnum=Nn.a,this.isLoft=Ht.a.application===ne.a.Loft,this._selectedColumnGroup="chapters",this.loadingLabel="",this.interactive=!1,this.searchHeight=0,this.searchControl=new G.g(""),this.searchResults=[],this.query="",this.copies=[],this.storedCamera=null,this.ngUnsubscribe=new c.a}get selectedColumnGroup(){return this._selectedColumnGroup}set selectedColumnGroup(e){this._selectedColumnGroup=e}ngOnInit(){const e=this.store.selectSnapshot(F.a.getSelectedChapter);e&&e.readyState.model&&(this.interactive=!0),this.searchControl.valueChanges.pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.query=e,this.searchResults=this.search(e),this.getSearchHeight().pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.searchHeight=e,this.changeDetector.markForCheck()})}),this.engineEventsService.getEvent(En.a.AssetsLoadProgress).pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{const t=this.store.selectSnapshot(F.a.getChaptersLoaded);let i="";t.count>1&&(i=`Loading Chapter ${t.modelChapters.length+1} of ${t.count}: `),i+=Math.round(e.receivedAssets/e.requestedAssets*100)+"%",this.loadingLabel=i,this.changeDetector.markForCheck()}),this.currentChapter$.pipe(Object(O.a)(e=>null!=e),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.interactive=e.readyState.model}),this.store.select($t.a.getCheckedNodes).pipe(Object(O.a)(e=>e.length>0),Object(Dn.a)(),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.selectedColumnGroup="anatomy",this.changeDetector.markForCheck()})}ngAfterViewInit(){this.renderer.listen("window","resize",e=>{this.getSearchHeight().pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.searchHeight=e,this.changeDetector.markForCheck()})})}ngOnDestroy(){this.changeDetector.detach(),this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}handleKeyup(e){"Escape"===e.key&&(this.clearQuery(),this.searchInput.nativeElement.blur())}handleToggleIds(){this.store.dispatch(new g.m)}handleToggleRootNodes(){const e=this.store.selectSnapshot(f.a.getShowRootNodes);this.store.dispatch(new g.k(!e))}handleAutoCaptureChange(e){this.store.dispatch(new g.a(e.checked))}handleCollapseStructures(){this.store.dispatch(new D.e)}getSearchHeight(){return new m.a(e=>{const t=Object(W.get)(this.columnGroupBody,"nativeElement.parentElement.offsetHeight");null!=t&&(e.next(t),e.complete())})}clearQuery(){this.searchControl.setValue("")}search(e){const t=this.store.selectSnapshot(x.a.getViewGraph);return e=Object(jn.remove)(e.toLowerCase()),Object.values(t.nodes).filter(t=>0===e.length||Object(jn.remove)(t.label.toLowerCase()).indexOf(e)>=0).sort((e,t)=>e.label.localeCompare(t.label)).sort((e,t)=>Math.sign(e.depth-t.depth))}trackTreeNode(e,t){return t.id}setLayerOrderMode(e){this.store.dispatch(new g.g(e))}autoSortLayers(){this.store.dispatch(new D.a),this.setLayerOrderMode(!0)}resetLayers(){this.store.dispatch(new D.v),this.setLayerOrderMode(!0)}copyCameraClick(){this.storedCamera=this.cameraService.getCamera(),this.snackbar.open("Stored camera position")}pasteCameraClick(){this.storedCamera&&this.store.dispatch(new I.l(this.storedCamera))}applyCameraClick(e){const t="single"===e?[this.store.selectSnapshot(F.a.getSelectedChapter)]:this.store.selectSnapshot(F.a.getStoryChapters);this.storedCamera&&t.forEach(e=>{this.store.dispatch(new A.i(e.id,this.storedCamera))}),this.snackbar.open("single"===e?"Applied camera position.":`Applied camera position to ${t.length} chapters.`),this.store.dispatch(new I.l(this.storedCamera))}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(r.h),ae.Pb(ae.H),ae.Pb(ae.i),ae.Pb(ce.a),ae.Pb(fn.a),ae.Pb(le.b))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-navigation-context"]],viewQuery:function(e,t){if(1&e&&(ae.Vc(na,!0),ae.Jc(oa,!0),ae.Jc(aa,!0)),2&e){let e;ae.xc(e=ae.dc())&&(t.columnBody=e.first),ae.xc(e=ae.dc())&&(t.columnGroupBody=e.first),ae.xc(e=ae.dc())&&(t.searchInput=e.first)}},decls:58,vars:23,consts:[[3,"loadingLabel","loading","showHeader","selectedColumnGroup","selectedColumnGroupChange"],["label","Chapters"],["column-group-header",""],[1,"flex","items-center","justify-between","pl-2","pr-1"],["data-test","autoCapture","matTooltip","Automatically capture starting position and thumbnail",3,"checked","change"],[1,"text-12"],["app-button","","buttonSize","small",3,"matMenuTriggerFor",4,"appFlagApplication"],["cameraActions","matMenu"],["mat-menu-item","",3,"click"],["mat-menu-item","",3,"disabled","click"],[4,"appFlagApplication"],["column-group-body",""],[1,"pv-2","pl-2"],["label","Anatomy"],[1,"navigation-context__anatomy-header"],[1,"navigation-context__search"],["type","text","placeholder","Search...",1,"input","navigation-context__input",3,"formControl","keyup"],["searchInput",""],["app-button","","buttonType","text","class","navigation-context__clear",3,"click",4,"ngIf"],[1,"navigation-context__anatomy-subheader"],[1,"navigation-context__selected"],["app-button","","buttonSize","xsmall","matTooltip","Collapse Open Tree Structures",3,"click"],["icon","minus","size","xs"],["app-button","","buttonSize","xsmall","class","ml-1",3,"matMenuTriggerFor",4,"ngIf"],["class","ml-1","app-button","","buttonSize","xsmall","matTooltip","Exit Layer Order Manager",3,"click",4,"ngIf"],["treeActions","matMenu"],["mat-menu-item","",3,"matMenuTriggerFor"],["layerOrderActions","matMenu"],["columnGroupBody",""],["class","pt-2 ph-2",4,"ngIf"],["style","margin-right: -12px",3,"itemSize","height",4,"ngIf"],["app-button","","buttonSize","small",3,"matMenuTriggerFor"],["icon","ellipsis-v"],["app-button","","buttonType","text",1,"navigation-context__clear",3,"click"],["app-button","","buttonSize","xsmall",1,"ml-1",3,"matMenuTriggerFor"],["icon","ellipsis-v","size","xs"],["app-button","","buttonSize","xsmall","matTooltip","Exit Layer Order Manager",1,"ml-1",3,"click"],["icon","times"],[1,"pt-2","ph-2"],[3,"theme"],[2,"margin-right","-12px",3,"itemSize"],[4,"cdkVirtualFor","cdkVirtualForOf","cdkVirtualForTrackBy"],[2,"height","48px",3,"theme","node","graph","nested"]],template:function(e,t){if(1&e&&(ae.Vb(0,"app-column",0),ae.cc("selectedColumnGroupChange",(function(e){return t.selectedColumnGroup=e})),ae.hc(1,"async"),ae.Vb(2,"app-column-group",1),ae.Tb(3,2),ae.Vb(4,"div",3),ae.Vb(5,"mat-checkbox",4),ae.cc("change",(function(e){return t.handleAutoCaptureChange(e)})),ae.hc(6,"async"),ae.Vb(7,"span",5),ae.Pc(8,"Auto-capture starting position"),ae.Ub(),ae.Ub(),ae.Nc(9,ra,2,1,"button",6),ae.Ub(),ae.Vb(10,"mat-menu",null,7),ae.Vb(12,"button",8),ae.cc("click",(function(){return t.copyCameraClick()})),ae.Pc(13,"Copy Camera Position"),ae.Ub(),ae.Vb(14,"button",9),ae.cc("click",(function(){return t.pasteCameraClick()})),ae.Pc(15," Paste Camera Position "),ae.Ub(),ae.Nc(16,sa,6,2,"ng-container",10),ae.Ub(),ae.Sb(),ae.Tb(17,11),ae.Vb(18,"div",12),ae.Qb(19,"app-chapter-browser"),ae.Ub(),ae.Sb(),ae.Ub(),ae.Vb(20,"app-column-group",13),ae.Tb(21,2),ae.Vb(22,"div",14),ae.Vb(23,"div",15),ae.Vb(24,"input",16,17),ae.cc("keyup",(function(e){return t.handleKeyup(e)})),ae.Ub(),ae.Nc(26,ca,2,0,"button",18),ae.Ub(),ae.Vb(27,"div",19),ae.Qb(28,"app-checked-nodes",20),ae.Vb(29,"div"),ae.Vb(30,"button",21),ae.cc("click",(function(){return t.handleCollapseStructures()})),ae.Qb(31,"app-icon",22),ae.Ub(),ae.Nc(32,la,2,1,"button",23),ae.hc(33,"async"),ae.Nc(34,pa,2,0,"button",24),ae.hc(35,"async"),ae.Ub(),ae.Ub(),ae.Vb(36,"mat-menu",null,25),ae.Vb(38,"button",26),ae.Pc(39,"Layer Order"),ae.Ub(),ae.Qb(40,"mat-divider"),ae.Vb(41,"button",8),ae.cc("click",(function(){return t.handleToggleIds()})),ae.Pc(42,"Toggle IDs"),ae.Ub(),ae.Vb(43,"button",8),ae.cc("click",(function(){return t.handleToggleRootNodes()})),ae.Pc(44,"Toggle Root Nodes"),ae.Ub(),ae.Ub(),ae.Vb(45,"mat-menu",null,27),ae.Vb(47,"button",8),ae.cc("click",(function(){return t.setLayerOrderMode(!0)})),ae.Pc(48,"Manage Layer Order"),ae.Ub(),ae.Qb(49,"mat-divider"),ae.Vb(50,"button",8),ae.cc("click",(function(){return t.autoSortLayers()})),ae.Pc(51,"Auto Sort Layer Order"),ae.Ub(),ae.Vb(52,"button",8),ae.cc("click",(function(){return t.resetLayers()})),ae.Pc(53,"Reset Layer Order"),ae.Ub(),ae.Ub(),ae.Ub(),ae.Sb(),ae.Vb(54,"div",11,28),ae.Nc(56,da,2,1,"div",29),ae.Nc(57,ha,2,5,"cdk-virtual-scroll-viewport",30),ae.Ub(),ae.Ub(),ae.Ub()),2&e){const e=ae.yc(46);ae.mc("loadingLabel",t.loadingLabel)("loading",!ae.ic(1,15,t.allChaptersReady$))("showHeader",!1)("selectedColumnGroup",t.selectedColumnGroup),ae.Db(5),ae.mc("checked",ae.ic(6,17,t.autoCapture$)),ae.Db(4),ae.mc("appFlagApplication",t.application.Loft),ae.Db(5),ae.mc("disabled",!t.storedCamera),ae.Db(2),ae.mc("appFlagApplication",t.application.Loft),ae.Db(8),ae.mc("formControl",t.searchControl),ae.Db(2),ae.mc("ngIf",t.query),ae.Db(6),ae.mc("ngIf",t.isLoft&&!ae.ic(33,19,t.layerOrderMode$)),ae.Db(2),ae.mc("ngIf",t.isLoft&&ae.ic(35,21,t.layerOrderMode$)),ae.Db(4),ae.mc("matMenuTriggerFor",e),ae.Db(18),ae.mc("ngIf",!t.query.length),ae.Db(1),ae.mc("ngIf",t.query.length&&t.searchHeight)}},directives:[Kn,Fn,ge.a,st.c,pt.a,Sn.a,Sn.b,Qo,G.c,G.r,G.h,n.p,Xo,pe.a,at.a,Sn.d,me.a,Zo.a,Yo.e,Yo.a,Yo.d,ea.a],pipes:[n.b],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%}.navigation-context__anatomy-subheader[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.navigation-context__loading[_ngcontent-%COMP%]{padding:16px;display:flex;justify-content:center}.navigation-context__search[_ngcontent-%COMP%]{position:relative;margin-bottom:8px}.navigation-context__input[_ngcontent-%COMP%]{padding-right:56px;width:100%}.navigation-context__clear[_ngcontent-%COMP%]{position:absolute;right:0;top:0}.navigation-context__selected[_ngcontent-%COMP%]{display:flex}.navigation-context__actions[_ngcontent-%COMP%]{border-radius:4px;color:#d7e0ea;display:flex;flex:0 0 24px;height:24px;justify-content:center;align-items:center}.navigation-context__actions[_ngcontent-%COMP%]:hover{background-color:#1c2a3f;color:#fff;cursor:pointer}.navigation-context--selected[_ngcontent-%COMP%]   .navigation-context__actions[_ngcontent-%COMP%]:hover{background-color:#2d72dc}"],changeDetection:0}),ta([Object(r.e)(x.a.getViewGraph),ia("design:type",m.a)],e.prototype,"viewGraph$",void 0),ta([Object(r.e)(F.a.getSelectedChapter),ia("design:type",m.a)],e.prototype,"currentChapter$",void 0),ta([Object(r.e)(F.a.getChaptersLoaded),ia("design:type",m.a)],e.prototype,"chaptersLoaded$",void 0),ta([Object(r.e)(F.a.getAllChaptersModelsReady),ia("design:type",m.a)],e.prototype,"allChaptersReady$",void 0),ta([Object(r.e)(f.a.getLayerOrderMode),ia("design:type",m.a)],e.prototype,"layerOrderMode$",void 0),ta([Object(r.e)(f.a.getAutoCapture),ia("design:type",m.a)],e.prototype,"autoCapture$",void 0),ta([Object(r.e)(f.a.getShowRootNodes),ia("design:type",m.a)],e.prototype,"showRootNodes$",void 0),e})();var ba=i("XiU4"),ga=i("nS47"),fa=function(e,t,i,n){var o,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,i,r):o(t,i))||r);return a>3&&r&&Object.defineProperty(t,i,r),r},xa=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function ya(e,t){if(1&e&&(ae.Vb(0,"div",1),ae.Vb(1,"div",2),ae.Pc(2),ae.Ub(),ae.Vb(3,"div",3),ae.Pc(4),ae.Ub(),ae.Ub()),2&e){const e=t.ngIf,i=ae.gc();ae.Db(2),ae.Qc(e.label),ae.Db(2),ae.Rc(" ",i.nodeAncestors," ")}}let va=(()=>{class e{constructor(e,t,i){this.graphService=e,this.store=t,this.changeDetection=i,this.ngUnsubscribe=new c.a}ngOnInit(){this.hoveredNode$.pipe(Object(O.a)(e=>null!=e),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.nodeAncestors=this.getNodeAncestors(e).map(e=>e.label).slice(0,-1).join(" > "),this.nodeAncestors.length>160&&(this.nodeAncestors="..."+this.nodeAncestors.slice(-160)),this.changeDetection.markForCheck()})}ngOnDestroy(){this.changeDetection.detach(),this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}getNodeAncestors(e){const t=this.store.selectSnapshot(x.a.getViewGraph);return ga.a.getAncestors(t,e.id,!0).map(e=>t.nodes[e]).reverse()}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(qo.a),ae.Pb(r.h),ae.Pb(ae.i))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-engine-breadcrumb"]],decls:2,vars:3,consts:[["class","breadcrumb",4,"ngIf"],[1,"breadcrumb"],[1,"breadcrumb__node"],[1,"breadcrumb__ancestors"]],template:function(e,t){1&e&&(ae.Nc(0,ya,5,2,"div",0),ae.hc(1,"async")),2&e&&ae.mc("ngIf",ae.ic(1,1,t.hoveredNode$))},directives:[n.p],pipes:[n.b],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.breadcrumb[_ngcontent-%COMP%]{-webkit-animation:fadeIn .25s ease forwards;animation:fadeIn .25s ease forwards;color:#fff;display:flex;flex-direction:column;justify-content:center;text-align:center}.breadcrumb__node[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em;color:#fff;font-weight:700}.theme-light[_nghost-%COMP%]   .breadcrumb__node[_ngcontent-%COMP%], .theme-light   [_nghost-%COMP%]   .breadcrumb__node[_ngcontent-%COMP%]{color:#1c2a3f}.breadcrumb__ancestors[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase;color:#96a8c0;padding-top:4px}.theme-light[_nghost-%COMP%]   .breadcrumb__ancestors[_ngcontent-%COMP%], .theme-light   [_nghost-%COMP%]   .breadcrumb__ancestors[_ngcontent-%COMP%]{color:#374a68}"],changeDetection:0}),fa([Object(r.e)(x.a.getHoveredNode),xa("design:type",m.a)],e.prototype,"hoveredNode$",void 0),fa([Object(r.e)($t.a.getCheckedNodes),xa("design:type",m.a)],e.prototype,"checkedNodes$",void 0),e})(),Ca=(()=>{class e{constructor(e,t){this.templateRef=e,this.viewContainer=t}ngOnInit(){this.update()}update(){"bookmark"===Ht.a.exportType?this.viewContainer.createEmbeddedView(this.templateRef):this.viewContainer.clear()}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(ae.O),ae.Pb(ae.S))},e.\u0275dir=ae.Kb({type:e,selectors:[["","appFlagExternal",""]]}),e})();var Pa=i("E+WR");let Oa=(()=>{class e{transform(e,t=2){const i=parseInt(e,10);return isNaN(i)?"":(i/1048576).toFixed(t)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=ae.Ob({name:"megabyte",type:e,pure:!0}),e})();var wa=function(e,t,i,n){var o,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,i,r):o(t,i))||r);return a>3&&r&&Object.defineProperty(t,i,r),r},ka=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Sa(e,t){if(1&e&&(ae.Vb(0,"table",3),ae.Vb(1,"tr"),ae.Vb(2,"td",4),ae.Pc(3,"Summary"),ae.Ub(),ae.Qb(4,"td"),ae.Ub(),ae.Vb(5,"tr"),ae.Vb(6,"td",5),ae.Pc(7,"Module Total Memory"),ae.Ub(),ae.Vb(8,"td",6),ae.Pc(9),ae.hc(10,"megabyte"),ae.Ub(),ae.Ub(),ae.Vb(11,"tr"),ae.Vb(12,"td",5),ae.Pc(13,"First Chapter Download"),ae.Ub(),ae.Vb(14,"td",6),ae.Pc(15),ae.hc(16,"megabyte"),ae.hc(17,"async"),ae.Ub(),ae.Ub(),ae.Vb(18,"tr"),ae.Vb(19,"td",5),ae.Pc(20,"Download Size"),ae.Ub(),ae.Vb(21,"td",6),ae.Pc(22),ae.hc(23,"megabyte"),ae.Ub(),ae.Ub(),ae.Vb(24,"tr"),ae.Vb(25,"td",5),ae.Pc(26,"Uncompressed Geos"),ae.Ub(),ae.Vb(27,"td",6),ae.Pc(28),ae.hc(29,"megabyte"),ae.Ub(),ae.Ub(),ae.Vb(30,"tr"),ae.Vb(31,"td",5),ae.Pc(32,"Uncompressed Morphs"),ae.Ub(),ae.Vb(33,"td",6),ae.Pc(34),ae.hc(35,"megabyte"),ae.Ub(),ae.Ub(),ae.Vb(36,"tr"),ae.Vb(37,"td",5),ae.Pc(38,"Uncompressed Textures"),ae.Ub(),ae.Vb(39,"td",6),ae.Pc(40),ae.hc(41,"megabyte"),ae.Ub(),ae.Ub(),ae.Ub()),2&e){const e=ae.gc();ae.Db(9),ae.Rc(" ",ae.ic(10,6,e.globalStats.memory),"MB "),ae.Db(6),ae.Rc(" ",ae.ic(16,8,ae.ic(17,10,e.firstChapterDownloadSize$)),"MB "),ae.Db(7),ae.Rc(" ",ae.ic(23,12,e.globalStats.downloadSize),"MB "),ae.Db(6),ae.Rc(" ",ae.ic(29,14,e.globalStats.uncompressedGeos),"MB "),ae.Db(6),ae.Rc(" ",ae.ic(35,16,e.globalStats.uncompressedMorphs),"MB "),ae.Db(6),ae.Rc(" ",ae.ic(41,18,e.globalStats.uncompressedTextures),"MB ")}}function _a(e,t){if(1&e&&(ae.Tb(0),ae.Pc(1),ae.hc(2,"megabyte"),ae.Sb()),2&e){const e=ae.gc().$implicit;ae.Db(1),ae.Rc("",ae.ic(2,1,e.value),"MB")}}function Ma(e,t){if(1&e&&(ae.Tb(0),ae.Pc(1),ae.hc(2,"number"),ae.Sb()),2&e){const e=ae.gc().$implicit;ae.Db(1),ae.Qc(ae.ic(2,1,e.value))}}function Ua(e,t){if(1&e&&(ae.Tb(0),ae.Pc(1),ae.hc(2,"megabyte"),ae.Sb()),2&e){const e=ae.gc().$implicit;ae.Db(1),ae.Rc("",ae.ic(2,1,e.value),"MB")}}function Ta(e,t){if(1&e&&(ae.Tb(0),ae.Pc(1),ae.hc(2,"number"),ae.Sb()),2&e){const e=ae.gc().$implicit;ae.Db(1),ae.Qc(ae.ic(2,1,e.value))}}function Va(e,t){if(1&e&&(ae.Tb(0),ae.Pc(1),ae.hc(2,"megabyte"),ae.Sb()),2&e){const e=ae.gc().$implicit;ae.Db(1),ae.Rc("",ae.ic(2,1,e.value),"MB")}}function Da(e,t){if(1&e&&(ae.Tb(0),ae.Pc(1),ae.hc(2,"number"),ae.Sb()),2&e){const e=ae.gc().$implicit;ae.Db(1),ae.Qc(ae.ic(2,1,e.value))}}function Ea(e,t){if(1&e&&(ae.Vb(0,"tr"),ae.Vb(1,"td",14),ae.Pc(2),ae.Ub(),ae.Vb(3,"td",15),ae.Tb(4,9),ae.Nc(5,Va,3,3,"ng-container",10),ae.Nc(6,Da,3,3,"ng-container",11),ae.Sb(),ae.Ub(),ae.Ub()),2&e){const e=t.$implicit;ae.Db(2),ae.Rc(" ",e.name," "),ae.Db(2),ae.mc("ngSwitch",e.unit),ae.Db(1),ae.mc("ngSwitchCase","bytes")}}function ja(e,t){if(1&e&&(ae.Tb(0),ae.Vb(1,"tr"),ae.Vb(2,"td",13),ae.Pc(3),ae.Ub(),ae.Vb(4,"td",6),ae.Tb(5,9),ae.Nc(6,Ua,3,3,"ng-container",10),ae.Nc(7,Ta,3,3,"ng-container",11),ae.Sb(),ae.Ub(),ae.Ub(),ae.Nc(8,Ea,7,3,"tr",12),ae.Sb()),2&e){const e=t.$implicit;ae.Db(3),ae.Qc(e.name),ae.Db(2),ae.mc("ngSwitch",e.unit),ae.Db(1),ae.mc("ngSwitchCase","bytes"),ae.Db(2),ae.mc("ngForOf",e.reports)}}function Na(e,t){if(1&e&&(ae.Vb(0,"table",3),ae.Vb(1,"tr"),ae.Vb(2,"td",7),ae.Pc(3),ae.Ub(),ae.Vb(4,"td",8),ae.Tb(5,9),ae.Nc(6,_a,3,3,"ng-container",10),ae.Nc(7,Ma,3,3,"ng-container",11),ae.Sb(),ae.Ub(),ae.Ub(),ae.Nc(8,ja,9,4,"ng-container",12),ae.Ub()),2&e){const e=t.$implicit;ae.Db(3),ae.Rc(" ",e.name," "),ae.Db(2),ae.mc("ngSwitch",e.unit),ae.Db(1),ae.mc("ngSwitchCase","bytes"),ae.Db(2),ae.mc("ngForOf",e.reports)}}let Ra=(()=>{class e{constructor(){this.ngUnsubscribe=new c.a}ngOnInit(){this.memory$.pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.globalStats=e.globalStats,this.stats=[e.morphStatsReport,e.geoStatsReport,e.textureStatsReport,e.downloadReport]})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-memory-details"]],decls:3,vars:2,consts:[[1,"memory-details"],["class","memory-details__group",4,"ngIf"],["class","memory-details__group",4,"ngFor","ngForOf"],[1,"memory-details__group"],[1,"memory-details__cell","memory-details__cell--bold"],[1,"memory-details__cell","memory-details__cell--label"],[1,"memory-details__cell","memory-details__cell--value"],[1,"memory-details__cell","memory-details__cell--label","memory-details__cell--bold"],[1,"memory-details__cell","memory-details__cell--value","memory-details__cell--bold"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[4,"ngFor","ngForOf"],[1,"memory-details__cell"],[1,"memory-details__cell","memory-details__cell--label","memory-details__cell--label","memory-details__cell--indent","memory-details__cell--secondary"],[1,"memory-details__cell","memory-details__cell--value","memory-details__cell--secondary"]],template:function(e,t){1&e&&(ae.Vb(0,"div",0),ae.Nc(1,Sa,42,20,"table",1),ae.Nc(2,Na,9,4,"table",2),ae.Ub()),2&e&&(ae.Db(1),ae.mc("ngIf",t.globalStats),ae.Db(1),ae.mc("ngForOf",t.stats))},directives:[n.p,n.o,n.r,n.s,n.t],pipes:[Oa,n.b,n.f],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.memory-details[_ngcontent-%COMP%]{max-height:600px;overflow-y:auto;padding-right:24px;font-size:12px;letter-spacing:.3px;line-height:1.4em}.memory-details__group[_ngcontent-%COMP%]{margin-bottom:16px;width:100%}.memory-details__cell[_ngcontent-%COMP%]{padding-right:4px}.memory-details__cell--label[_ngcontent-%COMP%]{color:#283853}.memory-details__cell--bold[_ngcontent-%COMP%]{color:#131c2a;font-weight:600}.memory-details__cell--value[_ngcontent-%COMP%]{text-align:right;padding:4px;width:80px}.memory-details__cell--indent[_ngcontent-%COMP%]{padding-left:8px}.memory-details__cell--secondary[_ngcontent-%COMP%]{color:#61779e}"],changeDetection:0}),wa([Object(r.e)(Pa.a),ka("design:type",m.a)],e.prototype,"memory$",void 0),wa([Object(r.e)(Pa.a.getFirstChapterDownloadSize),ka("design:type",m.a)],e.prototype,"firstChapterDownloadSize$",void 0),e})();var Aa=i("JnPr"),Fa=function(e,t,i,n){var o,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,i,r):o(t,i))||r);return a>3&&r&&Object.defineProperty(t,i,r),r},Ia=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const za=["memorySummary"];let La=(()=>{class e{constructor(e){this.popupService=e,this.ngUnsubscribe=new c.a}ngOnInit(){}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}handleClick(){this.togglePopup()}togglePopup(){this.summaryPopup?this.summaryPopup.close():(this.summaryPopup=this.popupService.open({origin:this.memorySummary.nativeElement,content:Ra}),this.summaryPopup.afterClosed$.pipe(Object(P.a)(this.ngUnsubscribe),Object(k.a)(1)).subscribe(()=>{this.summaryPopup=null}))}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(Aa.a))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-memory-summary"]],viewQuery:function(e,t){if(1&e&&ae.Vc(za,!0),2&e){let e;ae.xc(e=ae.dc())&&(t.memorySummary=e.first)}},features:[ae.Cb([Aa.a])],decls:25,vars:23,consts:[[1,"memory-summary",3,"click"],["memorySummary",""],[1,"memory-summary__item"],[1,"memory-summary__label"],[1,"memory-summary__value"]],template:function(e,t){if(1&e&&(ae.Vb(0,"table",0,1),ae.cc("click",(function(){return t.handleClick()})),ae.Vb(2,"tr",2),ae.hc(3,"async"),ae.Vb(4,"td",3),ae.Pc(5,"Memory"),ae.Ub(),ae.Vb(6,"td",4),ae.Pc(7),ae.hc(8,"megabyte"),ae.hc(9,"async"),ae.Ub(),ae.Ub(),ae.Vb(10,"tr",2),ae.Vb(11,"td",3),ae.Pc(12,"All Chap"),ae.Ub(),ae.Vb(13,"td",4),ae.Pc(14),ae.hc(15,"megabyte"),ae.hc(16,"async"),ae.Ub(),ae.Ub(),ae.Vb(17,"tr",2),ae.hc(18,"async"),ae.Vb(19,"td",3),ae.Pc(20,"1st Chap"),ae.Ub(),ae.Vb(21,"td",4),ae.Pc(22),ae.hc(23,"megabyte"),ae.hc(24,"async"),ae.Ub(),ae.Ub(),ae.Ub()),2&e){let e=null,i=null,n=null,o=null;ae.Db(2),ae.Hb("memory-summary__item--alert",(null==(e=ae.ic(3,7,t.globalStats$))?null:e.memory)>104857600),ae.Db(5),ae.Rc("",ae.ic(8,9,null==(i=ae.ic(9,11,t.globalStats$))?null:i.memory),"MB / 100MB"),ae.Db(7),ae.Rc("",ae.ic(15,13,null==(n=ae.ic(16,15,t.globalStats$))?null:n.downloadSize),"MB"),ae.Db(3),ae.Hb("memory-summary__item--alert",(null==(o=ae.ic(18,17,t.globalStats$))?null:o.firstChapterDownloadSize)>12582912),ae.Db(5),ae.Rc(" ",ae.ic(23,19,ae.ic(24,21,t.firstChapterDownloadSize$)),"MB / 12MB ")}},pipes:[n.b,Oa],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.memory-summary[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.memory-summary[_ngcontent-%COMP%]:hover{cursor:pointer}.memory-summary[_ngcontent-%COMP%]:hover   .memory-summary__label[_ngcontent-%COMP%]{color:#fff}.memory-summary__label[_ngcontent-%COMP%]{color:#96a8c0;padding-right:4px}.memory-summary__value[_ngcontent-%COMP%]{text-align:right}.memory-summary__item--alert[_ngcontent-%COMP%]   .memory-summary__label[_ngcontent-%COMP%]{color:#ed4758;font-weight:700}"],changeDetection:0}),Fa([Object(r.e)(Pa.a.getGlobalStats),Ia("design:type",m.a)],e.prototype,"globalStats$",void 0),Fa([Object(r.e)(Pa.a.getFirstChapterDownloadSize),Ia("design:type",m.a)],e.prototype,"firstChapterDownloadSize$",void 0),e})();var Ba=i("7XdW");let Qa=(()=>{class e{constructor(e,t){this.previousRouteService=e,this.router=t,this.url=""}ngOnInit(){this.url=this.previousRouteService.getPreviousUrl()}exit(){switch(!0){case this.url.startsWith("/explore"):case this.url.startsWith("/results/"):case this.url.startsWith("/view"):this.router.navigateByUrl(this.url);break;default:this.router.navigateByUrl("/results/bookmarks")}}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(Ba.a),ae.Pb(o.e))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-edit-exit"]],decls:2,vars:0,consts:[["app-button","","buttonType","outline","type","button",3,"click"]],template:function(e,t){1&e&&(ae.Vb(0,"button",0),ae.cc("click",(function(){return t.exit()})),ae.Pc(1,"Exit"),ae.Ub())},directives:[pe.a],styles:[""],changeDetection:0}),e})();var $a=i("+rOU");function qa(e,t){1&e&&ae.kc(0,0,["*ngIf","!currentPortal"])}function Ga(e,t){}function Ha(e,t){if(1&e&&ae.Nc(0,Ga,0,0,"ng-template",1),2&e){const e=ae.gc();ae.mc("cdkPortalOutlet",e.currentPortal)}}const Wa=["*"];let Ka=(()=>{class e{constructor(e,t){this.changeRef=e,this._viewContainerRef=t,this.portals=[],this.ngUnsubscribe=new c.a,this.portalSubscription=new c.a}get currentPortal(){return this.portals[this.portals.length-1]}ngOnInit(){this.initListeners()}ngOnDestroy(){this.currentPortal&&this.currentPortal.isAttached&&this.currentPortal.detach(),this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initListeners(){this.portalSubscription.asObservable().pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.portals.push(e),this.changeRef.markForCheck()})}loadComponent(e){this.loadPortal(new $a.c(e))}loadTemplate(e){this.loadPortal(new $a.g(e,this._viewContainerRef))}loadPortal(e){this.portalSubscription.next(e)}back(){this.portals.pop(),this.changeRef.markForCheck()}exit(){this.portals.length=0,this.changeRef.markForCheck()}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(ae.i),ae.Pb(ae.S))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-portal"]],ngContentSelectors:Wa,decls:2,vars:2,consts:[[4,"ngIf"],[3,"cdkPortalOutlet"]],template:function(e,t){1&e&&(ae.lc(),ae.Nc(0,qa,1,0,"ng-content",0),ae.Nc(1,Ha,1,1,void 0,0)),2&e&&(ae.mc("ngIf",!t.currentPortal),ae.Db(1),ae.mc("ngIf",t.currentPortal))},directives:[n.p,$a.b],styles:[""],changeDetection:0}),e})();var Ja=function(e){return e.Color="color",e.Alpha="alpha",e.Emit="emit",e}({}),Xa=function(e){return e.DirectionalVelocity="DirectionalVelocity",e.Lifetime="Lifetime",e.PointPosition="PointPosition",e.RandomVelocity="RandomVelocity",e.SpherePosition="SpherePosition",e.CylinderPosition="CylinderPosition",e.CubePosition="CubePosition",e.RandomRotation="RandomRotation",e.RandomRotationSpeed="RandomRotationSpeed",e.RandomScale="RandomScale",e.SpriteAnimationDuration="SpriteAnimationDuration",e}({}),Za=function(e){return e.AgeColorBlend="AgeColorBlend",e.BrownianMotion="BrownianMotion",e.UniformForce="UniformForce",e.RadialForce="RadialForce",e.Friction="Friction",e.Gravity="Gravity",e.Path="Path",e.AxisForce="AxisForce",e.SpriteAnimation="SpriteAnimation",e}({}),Ya=function(e){return e.LifetimeKill="LifetimeKill",e.LifetimeStop="LifetimeStop",e.PathKill="PathKill",e.PathStop="PathStop",e.PathRadius="PathRadius",e.ShapeBounce="ShapeBounce",e.ShapeKill="ShapeKill",e.ShapeStop="ShapeStop",e}({}),er=function(e){return e.Sphere="Sphere",e.Plane="Plane",e.Cube="Cube",e.Cylinder="Cylinder",e}({}),tr=function(e){return e.In="in",e.Out="out",e}({});const ir={type:er.Cube,direction:tr.In,translate:[0,0,0],rotate:[0,0,0],scale:[1,1,1]},nr=[Ya.ShapeBounce,Ya.ShapeKill,Ya.ShapeStop],or={[Ya.LifetimeKill]:{type:Ya.LifetimeKill},[Ya.LifetimeStop]:{type:Ya.LifetimeStop},[Ya.PathKill]:{type:Ya.PathKill},[Ya.PathStop]:{type:Ya.PathStop},[Ya.PathRadius]:{type:Ya.PathRadius},[Ya.ShapeBounce]:{type:Ya.ShapeBounce,trap:!1,shape:Object.assign({},ir)},[Ya.ShapeKill]:{type:Ya.ShapeKill,trap:!1,shape:Object.assign({},ir)},[Ya.ShapeStop]:{type:Ya.ShapeStop,trap:!1,shape:Object.assign({},ir)}},ar={[Xa.DirectionalVelocity]:{type:Xa.DirectionalVelocity,directionAverage:[0,1,0],forceAverage:5,directionVariance:.5,forceVariance:1},[Xa.Lifetime]:{type:Xa.Lifetime,average:2.5,variance:1},[Xa.PointPosition]:{type:Xa.PointPosition,position:[0,0,0]},[Xa.RandomVelocity]:{type:Xa.RandomVelocity,forceAverage:5,forceVariance:0},[Xa.SpherePosition]:{type:Xa.SpherePosition,scale:[1,1,1],rotate:[0,0,0],translate:[0,0,0]},[Xa.CylinderPosition]:{type:Xa.CylinderPosition,scale:[1,1,1],rotate:[0,0,0],translate:[0,0,0]},[Xa.CubePosition]:{type:Xa.CubePosition,scale:[1,1,1],rotate:[0,0,0],translate:[0,0,0]},[Xa.RandomRotation]:{type:Xa.RandomRotation,average:0,variance:0},[Xa.RandomRotationSpeed]:{type:Xa.RandomRotationSpeed,average:0,variance:180},[Xa.RandomScale]:{type:Xa.RandomScale,average:1,variance:0},[Xa.SpriteAnimationDuration]:{type:Xa.SpriteAnimationDuration,average:1,variance:0}},rr={[Za.AgeColorBlend]:{type:Za.AgeColorBlend,colors:[[255,0,0,255],[0,255,0,255],[0,0,0,255]]},[Za.BrownianMotion]:{type:Za.BrownianMotion,frequency:10,forceAverage:5,forceVariance:0},[Za.UniformForce]:{type:Za.UniformForce,directionAverage:[0,1,0],forceAverage:5,directionVariance:0,forceVariance:0},[Za.RadialForce]:{type:Za.RadialForce,position:[0,0,0],forceAverage:5,forceVariance:0},[Za.Friction]:{type:Za.Friction,friction:.1},[Za.Gravity]:{type:Za.Gravity,position:[0,0,0],radius:1,forceAverage:5,forceVariance:0},[Za.Path]:{type:Za.Path,nodes:[{position:[0,0,0],forceAverage:1,radius:1,forceVariance:0}]},[Za.AxisForce]:{type:Za.AxisForce,position:[0,0,0],direction:[1,0,0],forceAverage:5,forceVariance:0},[Za.SpriteAnimation]:{type:Za.SpriteAnimation}},sr={type:er.Sphere,direction:tr.In,translate:[0,0,0],rotate:[0,0,0],scale:[1,1,1]},cr={baseColor:{r:1,g:0,b:0},alpha:1},lr={spriteRows:8,spriteCols:8,spriteStartFrame:0,spriteEndFrame:63},pr={layer:1,depthMask:!1,roundPoints:!0,perspectivePoints:!0,addAlpha:!1},dr={id:"",name:"",numParticles:1e4,pointSize:10,emissionAverage:500,emissionVariance:0,textures:[],properties:Object.assign({},pr),constraints:[or[Ya.LifetimeKill]],creators:[ar[Xa.PointPosition],ar[Xa.RandomVelocity],ar[Xa.Lifetime]],updaters:[rr[Za.AgeColorBlend],rr[Za.Friction]]},ur=Object.assign(Object.assign(Object.assign({},dr),{material:cr}),lr);function hr(){const e=JSON.parse(JSON.stringify(dr)),{constraints:t,creators:i,updaters:n}=e;return Object.assign(Object.assign({},e),{constraints:t.map((e,t)=>Object.assign(Object.assign({},e),{id:go.a.idWithPrefix("constraint")})),creators:i.map((e,t)=>Object.assign(Object.assign({},e),{id:go.a.idWithPrefix("creator")})),updaters:n.map((e,t)=>Object.assign(Object.assign({},e),{id:go.a.idWithPrefix("updater")}))})}function mr(e){return Object.assign({},or[e])}function br(e){return Object.assign({},ar[e])}function gr(e){return Object.assign({},rr[e])}function fr(e){return Object(W.omitBy)(e,W.isNil)}function xr(e){return fr(function(e){return Object.keys(ur).reduce((t,i)=>(t[i]=e[i],t),{})}(e))}function yr(e,t){return fr(function(e,t){const{id:i,name:n,shape:o,trap:a}=t;return nr.includes(e)?{id:i,name:n,type:e,trap:a,shape:o}:{id:i,name:n,type:e}}(e,t))}function vr(e,t){return fr(function(e,t){const{id:i,name:n,directionAverage:o,forceAverage:a,directionVariance:r,forceVariance:s,average:c,variance:l,position:p,scale:d,rotate:u,translate:h}=t;switch(e){case Xa.DirectionalVelocity:return{id:i,name:n,type:e,directionAverage:o,forceAverage:a,directionVariance:r,forceVariance:s};case Xa.Lifetime:return{id:i,name:n,type:e,average:c,variance:l};case Xa.PointPosition:return{id:i,name:n,type:e,position:p};case Xa.RandomVelocity:return{id:i,name:n,type:e,forceAverage:a,forceVariance:s};case Xa.SpherePosition:case Xa.CylinderPosition:case Xa.CubePosition:return{id:i,name:n,type:e,scale:d,rotate:u,translate:h};case Xa.RandomRotation:case Xa.RandomRotationSpeed:case Xa.RandomScale:case Xa.SpriteAnimationDuration:return{id:i,name:n,type:e,average:c,variance:l};default:return}}(e,t))}function Cr(e,t){return fr(function(e,t){const{id:i,name:n,colors:o,position:a,direction:r,friction:s,frequency:c,forceAverage:l,radius:p,forceVariance:d,nodes:u,shape:h,directionAverage:m,directionVariance:b}=t;switch(e){case Za.AgeColorBlend:return{id:i,name:n,type:e,colors:o,shape:h};case Za.BrownianMotion:return{id:i,name:n,type:e,frequency:c,forceAverage:l,forceVariance:d,shape:h};case Za.UniformForce:return{id:i,name:n,type:e,directionAverage:m,forceAverage:l,directionVariance:b,forceVariance:d,shape:h};case Za.RadialForce:return{id:i,name:n,type:e,position:a,forceAverage:l,forceVariance:d,shape:h};case Za.Friction:return{id:i,name:n,type:e,friction:s,shape:h};case Za.Gravity:return{id:i,name:n,type:e,position:a,radius:p,forceAverage:l,forceVariance:d,shape:h};case Za.Path:return{id:i,name:n,type:e,nodes:u,shape:h};case Za.AxisForce:return{id:i,name:n,type:e,position:a,direction:r,forceAverage:l,forceVariance:d,shape:h};case Za.SpriteAnimation:default:return{id:i,name:n,type:e}}}(e,t))}function Pr(e,t){return![Ya.PathKill,Ya.PathRadius,Ya.PathStop].includes(t)||e.updaters.some(e=>e.type===Za.Path)}const Or=[[["","list-actions",""]],"*"],wr=["[list-actions]","*"];let kr=(()=>{class e{constructor(e){this.portalComponent=e,this.navigate=new ae.p}ngOnInit(){}handleNavigateClick(){this.navigate.emit(),this.portalComponent.back()}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(Ka))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-portal-column"]],inputs:{label:"label"},outputs:{navigate:"navigate"},ngContentSelectors:wr,decls:11,vars:1,consts:[["column-label",""],["column-nav",""],["app-button","",3,"click"],["icon","arrow-left","size","lg"],["column-actions",""],["column-group-body",""]],template:function(e,t){1&e&&(ae.lc(Or),ae.Vb(0,"app-column"),ae.Vb(1,"div",0),ae.Pc(2),ae.Ub(),ae.Vb(3,"div",1),ae.Vb(4,"button",2),ae.cc("click",(function(){return t.handleNavigateClick()})),ae.Qb(5,"app-icon",3),ae.Ub(),ae.Ub(),ae.Vb(6,"div",4),ae.kc(7),ae.Ub(),ae.Vb(8,"app-column-group"),ae.Tb(9,5),ae.kc(10,1),ae.Sb(),ae.Ub(),ae.Ub()),2&e&&(ae.Db(2),ae.Rc(" ",t.label," "))},directives:[Kn,pe.a,at.a,Fn],styles:[""],changeDetection:0}),e})();var Sr=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let _r=(()=>{class e{constructor(e,t){this.store=e,this.formBuilder=t,this.ngUnsubscribe=new c.a,this.formGroup=this.formBuilder.group({colorEnabled:[!1],color:[""],alphaEnabled:[!1],alpha:[""],emitEnabled:[!1],emit:[""],spritesEnabled:[!1],spriteRows:[0],spriteCols:[0],spriteStartFrame:[0],spriteEndFrame:[0]}),this.setValues(lr)}ngOnInit(){this.initFormListeners(),this.initParticleSystemListeners()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initFormListeners(){this.formGroup.valueChanges.pipe(Object(pi.a)(125),Object(Dn.a)((e,t)=>{const i=this.createParticleSystem(e),n=this.createParticleSystem(t);return Object(W.isEqual)(i,n)}),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.setParticleSystem(e)})}initParticleSystemListeners(){this.particleSystem$.pipe(Object(Dn.a)((e,t)=>Object(W.isEqual)(e,t)),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.setValues(e)})}handleResetClick(){this.resetFormValues()}setParticleSystem(e){const t=this.createParticleSystem(e);this.store.dispatch(new fo.a.UpdateParticleSystem(t.id,t))}setValues(e){this.setTextureValues(e.textures||[]),this.setSpriteValues(e)}setTextureValues(e){e.forEach(e=>{const{src:t,applyTo:i}=e,n=this.formGroup.get(i),o=this.formGroup.get(i+"Enabled");if(n){const e=!!t;n.setValue(t,{emitEvent:!1}),o.setValue(e,{emitEvent:!1})}})}resetFormValues(){this.formGroup.patchValue(Object.assign({colorEnabled:!1,color:"",alphaEnabled:!1,alpha:"",emitEnabled:!1,emit:"",spritesEnabled:!1},lr))}createParticleSystem(e){const{spritesEnabled:t,spriteRows:i,spriteCols:n,spriteStartFrame:o,spriteEndFrame:a}=e,r=this.store.selectSnapshot(xo.a.getSelectedParticleSystem),s=this.getTextures(e);return xr(Object.assign(Object.assign({},r),{textures:s,spriteRows:t?i:void 0,spriteCols:t?n:void 0,spriteStartFrame:t?o:void 0,spriteEndFrame:t?a:void 0}))}setSpriteValues(e){const{spriteRows:t,spriteCols:i,spriteStartFrame:n,spriteEndFrame:o}=e,a=[t,i,n,o].some(e=>!Object(W.isNil)(e)),r=Object.assign({spritesEnabled:a},xr({spriteRows:t,spriteCols:i,spriteStartFrame:n,spriteEndFrame:o}));this.formGroup.patchValue(r,{emitEvent:!1})}getTextures(e){const{colorEnabled:t,color:i,alphaEnabled:n,alpha:o,emitEnabled:a,emit:r}=e,s=[];return t&&i&&s.push({src:i,applyTo:Ja.Color}),n&&o&&s.push({src:o,applyTo:Ja.Alpha}),a&&r&&s.push({src:r,applyTo:Ja.Emit}),s}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(r.h),ae.Pb(G.f))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-edit-particle-sprites"]],decls:24,vars:11,consts:[["label","Sprites"],["list-actions",""],["app-button","",3,"matMenuTriggerFor"],["icon","ellipsis-v"],[3,"overlapTrigger"],["systemActions","matMenu"],["mat-menu-item","",3,"click"],[3,"formGroup"],["label","Color","toggleType","checkbox","formControlName","colorEnabled"],["type","text","formControlName","color","placeholder","path/of/texture",1,"input"],["label","Alpha","toggleType","checkbox","formControlName","alphaEnabled"],["type","text","formControlName","alpha","placeholder","path/of/texture",1,"input"],["label","Emit","toggleType","checkbox","formControlName","emitEnabled"],["type","text","formControlName","emit","placeholder","path/of/texture",1,"input"],["label","Sprite Sheet","toggleType","checkbox","formControlName","spritesEnabled"],["label","Rows"],["formControlName","spriteRows",3,"min","max"],["label","Columns"],["formControlName","spriteCols",3,"min","max"],["label","Start Frame"],["formControlName","spriteStartFrame",3,"min","max"],["label","End Frame"],["formControlName","spriteEndFrame",3,"min","max"]],template:function(e,t){if(1&e&&(ae.Vb(0,"app-portal-column",0),ae.Vb(1,"div",1),ae.Vb(2,"button",2),ae.Qb(3,"app-icon",3),ae.Ub(),ae.Vb(4,"mat-menu",4,5),ae.Vb(6,"button",6),ae.cc("click",(function(){return t.handleResetClick()})),ae.Pc(7,"Reset to default"),ae.Ub(),ae.Ub(),ae.Ub(),ae.Vb(8,"div",7),ae.Vb(9,"app-panel",8),ae.Qb(10,"input",9),ae.Ub(),ae.Vb(11,"app-panel",10),ae.Qb(12,"input",11),ae.Ub(),ae.Vb(13,"app-panel",12),ae.Qb(14,"input",13),ae.Ub(),ae.Vb(15,"app-panel",14),ae.Vb(16,"app-form-field",15),ae.Qb(17,"app-slider",16),ae.Ub(),ae.Vb(18,"app-form-field",17),ae.Qb(19,"app-slider",18),ae.Ub(),ae.Vb(20,"app-form-field",19),ae.Qb(21,"app-slider",20),ae.Ub(),ae.Vb(22,"app-form-field",21),ae.Qb(23,"app-slider",22),ae.Ub(),ae.Ub(),ae.Ub(),ae.Ub()),2&e){const e=ae.yc(5);ae.Db(2),ae.mc("matMenuTriggerFor",e),ae.Db(2),ae.mc("overlapTrigger",!0),ae.Db(4),ae.mc("formGroup",t.formGroup),ae.Db(9),ae.mc("min",1)("max",16),ae.Db(2),ae.mc("min",0)("max",16),ae.Db(2),ae.mc("min",0)("max",255),ae.Db(2),ae.mc("min",0)("max",255)}},directives:[kr,pe.a,Sn.d,at.a,Sn.a,Sn.b,G.s,G.j,be.a,G.r,G.i,G.c,de.a,io.a],styles:[""],changeDetection:0}),function(e,t,i,n){var o,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,i,r):o(t,i))||r);a>3&&r&&Object.defineProperty(t,i,r)}([Object(r.e)(xo.a.getSelectedParticleSystem),Sr("design:type",m.a)],e.prototype,"particleSystem$",void 0),e})();var Mr=i("JX91");let Ur=(()=>{class e{constructor(e){this.store=e}createParticleSystem(e){this.store.selectSnapshot(xo.a.getParticleSystemsList);const t=Object.assign(Object.assign({},hr()),{id:go.a.idWithPrefix("system")});this.store.dispatch(new fo.a.NewParticleSystem(t,e))}duplicateParticleSystem(e,t){this.store.dispatch(new fo.a.DuplicateParticleSystem(e,t))}resetParticleSystem(e){const t=Object.assign(Object.assign({},hr()),{id:e});this.store.dispatch(new fo.a.UpdateParticleSystem(e,t))}toggleParticleSystemVisible(e,t){const i=this.isParticleSystemVisible(e,t);this.store.dispatch(new fo.a.SetParticleSystemVisible(e,!i,t))}isParticleSystemVisible(e,t){return this.store.selectSnapshot(xo.a.getVisibleParticleSystesmForChapter(t)).includes(e)}addChapterParticleSystem(e,t){this.store.dispatch(new fo.a.AssignParticle(e,t))}removeChapterParticleSystem(e,t){this.store.dispatch(new fo.a.UnassignParticle(e,t))}removeAllChapterParticleSystem(e){this.store.selectSnapshot(xo.a.particleSystemsForChapter(e)).forEach(t=>{this.removeChapterParticleSystem(t.id,e)})}createNewConstraint(e,t){const{id:i,constraints:n}=e;this.store.dispatch(new fo.a.UpdateParticleSystem(i,Object.assign(Object.assign({},e),{constraints:[...n,Object.assign(Object.assign({},mr(t)),{id:go.a.idWithPrefix("constraint")})]})))}duplicateConstraint(e,t){e.constraints=[...e.constraints,Object.assign(Object.assign({},yr(t.type,t)),{id:go.a.idWithPrefix("constraint")})],this.store.dispatch(new fo.a.UpdateParticleSystem(e.id,e)),this.store.dispatch(new fo.a.SelectParticleConstraint(e.constraints.length-1))}resetConstraint(e,t){const i=e.constraints[t],{id:n,type:o}=i;e.constraints[t]=Object.assign(Object.assign({},mr(o)),{id:n}),this.store.dispatch(new fo.a.UpdateParticleSystem(e.id,e))}resetConstraints(e){e.constraints=e.constraints.map(e=>{const{id:t,type:i}=e;return Object.assign(Object.assign({},mr(i)),{id:t})}),this.store.dispatch(new fo.a.UpdateParticleSystem(e.id,e))}removeConstraint(e,t){e.constraints.splice(t,1),this.store.dispatch(new fo.a.UpdateParticleSystem(e.id,e)),this.store.dispatch(new fo.a.SelectParticleConstraint(-1))}createNewCreator(e,t){const{id:i,creators:n}=e;this.store.dispatch(new fo.a.UpdateParticleSystem(i,Object.assign(Object.assign({},e),{creators:[...n,Object.assign(Object.assign({},br(t)),{id:go.a.idWithPrefix("creator")})]})))}duplicateCreator(e,t){e.creators=[...e.creators,Object.assign(Object.assign({},vr(t.type,t)),{id:go.a.idWithPrefix("creator")})],this.store.dispatch(new fo.a.UpdateParticleSystem(e.id,e)),this.store.dispatch(new fo.a.SelectParticleCreator(e.creators.length-1))}resetCreator(e,t){const i=e.creators[t],{id:n,type:o}=i;e.creators[t]=Object.assign(Object.assign({},br(o)),{id:n}),this.store.dispatch(new fo.a.UpdateParticleSystem(e.id,e))}resetCreators(e){e.creators=e.creators.map(e=>{const{id:t,type:i}=e;return Object.assign(Object.assign({},br(i)),{id:t})}),this.store.dispatch(new fo.a.UpdateParticleSystem(e.id,e))}removeCreator(e,t){e.creators.splice(t,1),this.store.dispatch(new fo.a.UpdateParticleSystem(e.id,e)),this.store.dispatch(new fo.a.SelectParticleConstraint(-1))}createNewUpdater(e,t){const{id:i,updaters:n}=e;this.store.dispatch(new fo.a.UpdateParticleSystem(i,Object.assign(Object.assign({},e),{updaters:[...n,Object.assign(Object.assign({},gr(t)),{id:go.a.idWithPrefix("updater")})]})))}duplicateUpdater(e,t){e.updaters=[...e.updaters,Object.assign(Object.assign({},Cr(t.type,t)),{id:go.a.idWithPrefix("updater")})],this.store.dispatch(new fo.a.UpdateParticleSystem(e.id,e)),this.store.dispatch(new fo.a.SelectParticleUpdater(e.updaters.length-1))}resetUpdater(e,t){const i=e.updaters[t],{id:n,type:o}=i;e.updaters[t]=Object.assign(Object.assign({},gr(o)),{id:n}),this.store.dispatch(new fo.a.UpdateParticleSystem(e.id,e))}resetUpdaters(e){e.updaters=e.updaters.map(e=>{const{id:t,type:i}=e;return Object.assign(Object.assign({},gr(i)),{id:t})}),this.store.dispatch(new fo.a.UpdateParticleSystem(e.id,e))}removeUpdater(e,t){e.updaters.splice(t,1),this.store.dispatch(new fo.a.UpdateParticleSystem(e.id,e)),this.store.dispatch(new fo.a.SelectParticleConstraint(-1))}}return e.\u0275fac=function(t){return new(t||e)(ae.Zb(r.h))},e.\u0275prov=ae.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var Tr=i("mWjH");let Vr=(()=>{class e extends Tr.a{constructor(e,t){super(),this.formBuilder=e,this.changeRef=t,this.xmin=0,this.xmax=100,this.ymin=0,this.ymax=100,this.zmin=0,this.zmax=100,this.ngUnsubscribe=new c.a,this.formGroup=this.formBuilder.group({vec:this.formBuilder.array([0,0,0])})}ngOnInit(){this.formGroup.valueChanges.pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.value=e.vec})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}setFormValues(e){this.formGroup.patchValue({vec:e}),this.changeRef.markForCheck()}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(G.f),ae.Pb(ae.i))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-edit-particle-vector"]],inputs:{xmin:"xmin",xmax:"xmax",ymin:"ymin",ymax:"ymax",zmin:"zmin",zmax:"zmax"},features:[ae.Cb([{provide:G.p,useExisting:Object(ae.W)(()=>e),multi:!0}]),ae.Ab],decls:8,vars:13,consts:[[3,"formGroup"],["formArrayName","vec"],["label","X","display","inline"],[3,"min","max","step","formControlName"],["label","Y","display","inline"],["label","Z","display","inline"]],template:function(e,t){1&e&&(ae.Tb(0,0),ae.Tb(1,1),ae.Vb(2,"app-form-field",2),ae.Qb(3,"app-slider",3),ae.Ub(),ae.Vb(4,"app-form-field",4),ae.Qb(5,"app-slider",3),ae.Ub(),ae.Vb(6,"app-form-field",5),ae.Qb(7,"app-slider",3),ae.Ub(),ae.Sb(),ae.Sb()),2&e&&(ae.mc("formGroup",t.formGroup),ae.Db(3),ae.mc("min",t.xmin)("max",t.xmax)("step",.1)("formControlName",0),ae.Db(2),ae.mc("min",t.ymin)("max",t.ymax)("step",.1)("formControlName",1),ae.Db(2),ae.mc("min",t.zmin)("max",t.zmax)("step",.1)("formControlName",2))},directives:[G.s,G.j,G.e,de.a,io.a,G.r,G.i],styles:[""],changeDetection:0}),e})();var Dr=i("ZULQ");let Er=(()=>{class e{transform(e,t){return Dr.a.prettyPrint(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=ae.Ob({name:"prettyPrint",type:e,pure:!0}),e})();var jr=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Nr(e,t){if(1&e&&(ae.Vb(0,"option",17),ae.Pc(1),ae.hc(2,"prettyPrint"),ae.Ub()),2&e){const e=t.$implicit;ae.mc("value",e),ae.Db(1),ae.Rc(" ",ae.ic(2,2,e)," ")}}function Rr(e,t){1&e&&(ae.Tb(0),ae.Vb(1,"app-form-field",18),ae.Qb(2,"app-edit-particle-vector",19),ae.Ub(),ae.Vb(3,"app-form-field",20),ae.Qb(4,"app-slider",21),ae.Ub(),ae.Vb(5,"app-form-field",22),ae.Qb(6,"app-slider",23),ae.Ub(),ae.Vb(7,"app-form-field",24),ae.Qb(8,"app-slider",25),ae.Ub(),ae.Sb()),2&e&&(ae.Db(2),ae.mc("xmin",-10)("xmax",10)("ymin",-10)("ymax",10)("zmin",-10)("zmax",10),ae.Db(2),ae.mc("min",0)("max",10)("step",.1),ae.Db(2),ae.mc("min",0)("max",25),ae.Db(2),ae.mc("min",0)("max",25))}function Ar(e,t){1&e&&(ae.Tb(0),ae.Vb(1,"app-form-field",26),ae.Qb(2,"app-slider",27),ae.Ub(),ae.Vb(3,"app-form-field",28),ae.Qb(4,"app-slider",29),ae.Ub(),ae.Sb()),2&e&&(ae.Db(2),ae.mc("min",0)("max",10),ae.Db(2),ae.mc("min",0)("max",10))}function Fr(e,t){1&e&&(ae.Tb(0),ae.Vb(1,"app-form-field",26),ae.Qb(2,"app-slider",27),ae.Ub(),ae.Vb(3,"app-form-field",28),ae.Qb(4,"app-slider",29),ae.Ub(),ae.Sb()),2&e&&(ae.Db(2),ae.mc("min",-180)("max",180),ae.Db(2),ae.mc("min",-180)("max",180))}function Ir(e,t){1&e&&(ae.Tb(0),ae.Vb(1,"app-form-field",26),ae.Qb(2,"app-slider",27),ae.Ub(),ae.Vb(3,"app-form-field",28),ae.Qb(4,"app-slider",29),ae.Ub(),ae.Sb()),2&e&&(ae.Db(2),ae.mc("min",-720)("max",720),ae.Db(2),ae.mc("min",0)("max",720))}function zr(e,t){1&e&&(ae.Tb(0),ae.Vb(1,"app-form-field",26),ae.Qb(2,"app-slider",27),ae.Ub(),ae.Vb(3,"app-form-field",28),ae.Qb(4,"app-slider",29),ae.Ub(),ae.Sb()),2&e&&(ae.Db(2),ae.mc("min",0)("max",10),ae.Db(2),ae.mc("min",0)("max",10))}function Lr(e,t){1&e&&(ae.Tb(0),ae.Vb(1,"app-form-field",26),ae.Qb(2,"app-slider",27),ae.Ub(),ae.Vb(3,"app-form-field",28),ae.Qb(4,"app-slider",29),ae.Ub(),ae.Sb()),2&e&&(ae.Db(2),ae.mc("min",0)("max",10),ae.Db(2),ae.mc("min",0)("max",10))}function Br(e,t){1&e&&(ae.Tb(0),ae.Vb(1,"app-form-field",30),ae.Qb(2,"app-edit-particle-vector",31),ae.Ub(),ae.Sb()),2&e&&(ae.Db(2),ae.mc("xmin",-10)("xmax",10)("ymin",-10)("ymax",10)("zmin",-10)("zmax",10))}function Qr(e,t){1&e&&(ae.Tb(0),ae.Vb(1,"app-form-field",22),ae.Qb(2,"app-slider",23),ae.Ub(),ae.Vb(3,"app-form-field",24),ae.Qb(4,"app-slider",25),ae.Ub(),ae.Sb()),2&e&&(ae.Db(2),ae.mc("min",0)("max",25),ae.Db(2),ae.mc("min",0)("max",25))}function $r(e,t){1&e&&ae.Rb(0)}function qr(e,t){if(1&e&&(ae.Tb(0),ae.Nc(1,$r,1,0,"ng-container",32),ae.Sb()),2&e){ae.gc();const e=ae.yc(35);ae.Db(1),ae.mc("ngTemplateOutlet",e)}}function Gr(e,t){1&e&&ae.Rb(0)}function Hr(e,t){if(1&e&&(ae.Tb(0),ae.Nc(1,Gr,1,0,"ng-container",32),ae.Sb()),2&e){ae.gc();const e=ae.yc(35);ae.Db(1),ae.mc("ngTemplateOutlet",e)}}function Wr(e,t){1&e&&ae.Rb(0)}function Kr(e,t){if(1&e&&(ae.Tb(0),ae.Nc(1,Wr,1,0,"ng-container",32),ae.Sb()),2&e){ae.gc();const e=ae.yc(35);ae.Db(1),ae.mc("ngTemplateOutlet",e)}}function Jr(e,t){1&e&&(ae.Vb(0,"app-form-field",33),ae.Qb(1,"app-edit-particle-vector",34),ae.Ub(),ae.Vb(2,"app-form-field",35),ae.Qb(3,"app-edit-particle-vector",36),ae.Ub(),ae.Vb(4,"app-form-field",37),ae.Qb(5,"app-edit-particle-vector",38),ae.Ub()),2&e&&(ae.Db(1),ae.mc("xmin",-10)("xmax",10)("ymin",-10)("ymax",10)("zmin",-10)("zmax",10),ae.Db(2),ae.mc("xmin",-180)("xmax",180)("ymin",-180)("ymax",180)("zmin",-180)("zmax",180),ae.Db(2),ae.mc("xmin",0)("xmax",20)("ymin",0)("ymax",20)("zmin",0)("zmax",20))}let Xr=(()=>{class e{constructor(e,t,i,n){this.store=e,this.formBuilder=t,this.portalComponent=i,this.particleSystemsService=n,this.creatorsEnum=Xa,this.creators=Object.values(Xa),this.ngUnsubscribe=new c.a,this.formGroup=this.formBuilder.group({id:[""],name:[""],type:[""],directionAverage:[[0,0,0]],forceAverage:[0],directionVariance:[0],forceVariance:[0],average:[0],variance:[0],position:[[0,0,0]],scale:[[0,0,0]],rotate:[[0,0,0]],translate:[[0,0,0]]})}ngOnInit(){this.initFormListeners(),this.initCreatorListeners()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initFormListeners(){this.formGroup.valueChanges.pipe(Object(pi.a)(125),Object(Dn.a)((e,t)=>Object(W.isEqual)(e,t)),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{const t=vr(e.type,e);this.updateSystem(t)});const e=this.formGroup.get("type");e.valueChanges.pipe(Object(Mr.a)(e.value),Object(_.a)(),Object(P.a)(this.ngUnsubscribe)).subscribe(([e,t])=>{const i=ar[t],n=vr(e,this.formGroup.value),o=vr(t,Object.assign(Object.assign(Object.assign({},i),{position:n.translate,translate:n.position}),n));this.setValues(o,!1)})}initCreatorListeners(){this.particleCreator$.pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.setValues(e,!1)})}setValues(e,t){this.formGroup.patchValue(Object.assign({},e),{emitEvent:t})}handleDuplicateClick(){const e=this.store.selectSnapshot(xo.a.getSelectedParticleSystem),t=this.store.selectSnapshot(xo.a.getSelectedParticleCreator);this.particleSystemsService.duplicateCreator(e,t)}handleResetClick(){const e=this.store.selectSnapshot(xo.a.getSelectedParticleSystem),t=this.store.selectSnapshot(xo.a.getSelectedParticleCreatorIndex);this.particleSystemsService.resetCreator(e,t)}handleRemoveClick(){const e=this.store.selectSnapshot(xo.a.getSelectedParticleSystem),t=this.store.selectSnapshot(xo.a.getSelectedParticleCreatorIndex);this.particleSystemsService.removeCreator(e,t),this.portalComponent.back()}updateSystem(e){const t=this.store.selectSnapshot(xo.a.getSelectedParticleSystem),i=this.store.selectSnapshot(xo.a.getSelectedParticleCreatorIndex);t.creators[i]=e,this.store.dispatch(new fo.a.UpdateParticleSystem(t.id,t))}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(r.h),ae.Pb(G.f),ae.Pb(Ka),ae.Pb(Ur))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-edit-particle-creator"]],decls:36,vars:18,consts:[["label","Creator"],["list-actions",""],["app-button","",3,"matMenuTriggerFor"],["icon","ellipsis-v"],["actionsMenu","matMenu"],["mat-menu-item","",3,"click"],[3,"formGroup"],["label","Name"],["type","text","formControlName","name",1,"input"],["label","ID"],[1,"text-11"],["label","Type"],["formControlName","type",1,"input"],[3,"value",4,"ngFor","ngForOf"],[3,"ngSwitch"],[4,"ngSwitchCase"],["positionGroupTmp",""],[3,"value"],["label","Direction Average"],["formControlName","directionAverage",3,"xmin","xmax","ymin","ymax","zmin","zmax"],["label","Direction Variance"],["formControlName","directionVariance",3,"min","max","step"],["label","Force Average"],["formControlName","forceAverage",3,"min","max"],["label","Force Variance"],["formControlName","forceVariance",3,"min","max"],["label","Average"],["formControlName","average",3,"min","max"],["label","Variance"],["formControlName","variance",3,"min","max"],["label","Position"],["formControlName","position",3,"xmin","xmax","ymin","ymax","zmin","zmax"],[4,"ngTemplateOutlet"],["label","Translate"],["formControlName","translate",3,"xmin","xmax","ymin","ymax","zmin","zmax"],["label","Rotate"],["formControlName","rotate",3,"xmin","xmax","ymin","ymax","zmin","zmax"],["label","Scale"],["formControlName","scale",3,"xmin","xmax","ymin","ymax","zmin","zmax"]],template:function(e,t){if(1&e&&(ae.Vb(0,"app-portal-column",0),ae.Vb(1,"div",1),ae.Vb(2,"button",2),ae.Qb(3,"app-icon",3),ae.Ub(),ae.Vb(4,"mat-menu",null,4),ae.Vb(6,"button",5),ae.cc("click",(function(){return t.handleDuplicateClick()})),ae.Pc(7,"Duplicate"),ae.Ub(),ae.Vb(8,"button",5),ae.cc("click",(function(){return t.handleResetClick()})),ae.Pc(9,"Reset to default"),ae.Ub(),ae.Vb(10,"button",5),ae.cc("click",(function(){return t.handleRemoveClick()})),ae.Pc(11,"Remove"),ae.Ub(),ae.Ub(),ae.Ub(),ae.Vb(12,"app-panel",6),ae.Vb(13,"app-form-field",7),ae.Qb(14,"input",8),ae.Ub(),ae.Vb(15,"app-form-field",9),ae.Vb(16,"span",10),ae.Pc(17),ae.hc(18,"async"),ae.Ub(),ae.Ub(),ae.Vb(19,"app-form-field",11),ae.Vb(20,"select",12),ae.Nc(21,Nr,3,4,"option",13),ae.Ub(),ae.Ub(),ae.Tb(22,14),ae.Nc(23,Rr,9,13,"ng-container",15),ae.Nc(24,Ar,5,4,"ng-container",15),ae.Nc(25,Fr,5,4,"ng-container",15),ae.Nc(26,Ir,5,4,"ng-container",15),ae.Nc(27,zr,5,4,"ng-container",15),ae.Nc(28,Lr,5,4,"ng-container",15),ae.Nc(29,Br,3,6,"ng-container",15),ae.Nc(30,Qr,5,4,"ng-container",15),ae.Nc(31,qr,2,1,"ng-container",15),ae.Nc(32,Hr,2,1,"ng-container",15),ae.Nc(33,Kr,2,1,"ng-container",15),ae.Nc(34,Jr,6,18,"ng-template",null,16,ae.Oc),ae.Sb(),ae.Ub(),ae.Ub()),2&e){const e=ae.yc(5);let i=null;ae.Db(2),ae.mc("matMenuTriggerFor",e),ae.Db(10),ae.mc("formGroup",t.formGroup),ae.Db(5),ae.Qc(null==(i=ae.ic(18,16,t.particleCreator$))?null:i.id),ae.Db(4),ae.mc("ngForOf",t.creators),ae.Db(1),ae.mc("ngSwitch",t.formGroup.get("type").value),ae.Db(1),ae.mc("ngSwitchCase",t.creatorsEnum.DirectionalVelocity),ae.Db(1),ae.mc("ngSwitchCase",t.creatorsEnum.Lifetime),ae.Db(1),ae.mc("ngSwitchCase",t.creatorsEnum.RandomRotation),ae.Db(1),ae.mc("ngSwitchCase",t.creatorsEnum.RandomRotationSpeed),ae.Db(1),ae.mc("ngSwitchCase",t.creatorsEnum.RandomScale),ae.Db(1),ae.mc("ngSwitchCase",t.creatorsEnum.SpriteAnimationDuration),ae.Db(1),ae.mc("ngSwitchCase",t.creatorsEnum.PointPosition),ae.Db(1),ae.mc("ngSwitchCase",t.creatorsEnum.RandomVelocity),ae.Db(1),ae.mc("ngSwitchCase",t.creatorsEnum.SpherePosition),ae.Db(1),ae.mc("ngSwitchCase",t.creatorsEnum.CylinderPosition),ae.Db(1),ae.mc("ngSwitchCase",t.creatorsEnum.CubePosition)}},directives:[kr,pe.a,Sn.d,at.a,Sn.a,Sn.b,be.a,G.s,G.j,de.a,G.c,G.r,G.i,G.B,n.o,n.r,n.s,G.v,G.D,Vr,io.a,n.u],pipes:[n.b,Er],styles:[""],changeDetection:0}),function(e,t,i,n){var o,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,i,r):o(t,i))||r);a>3&&r&&Object.defineProperty(t,i,r)}([Object(r.e)(xo.a.getSelectedParticleCreator),jr("design:type",m.a)],e.prototype,"particleCreator$",void 0),e})(),Zr=(()=>{class e{constructor(e){this.portalComponent=e,this.itemClick=new ae.p}onClick(){this.itemClick.next(this.portalComponent)}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(Ka))},e.\u0275dir=ae.Kb({type:e,selectors:[["","appPortalItem",""]],hostBindings:function(e,t){1&e&&ae.cc("click",(function(){return t.onClick()}))},outputs:{itemClick:"itemClick"}}),e})();const Yr=[[["","item-actions",""]]],es=["[item-actions]"];let ts=(()=>{class e{constructor(){this.active=!0,this.itemClick=new ae.p}ngOnInit(){}handleItemClick(e){this.itemClick.next(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-portal-item"]],inputs:{label:"label",active:"active",hint:"hint"},outputs:{itemClick:"itemClick"},ngContentSelectors:es,decls:4,vars:5,consts:[["appPortalItem","",1,"portal-item",3,"itemClick"],["toggleType","arrow",3,"toggleable","open","active","label","hint"],["panel-actions",""]],template:function(e,t){1&e&&(ae.lc(Yr),ae.Vb(0,"div",0),ae.cc("itemClick",(function(e){return t.handleItemClick(e)})),ae.Vb(1,"app-panel",1),ae.Vb(2,"div",2),ae.kc(3),ae.Ub(),ae.Ub(),ae.Ub()),2&e&&(ae.Db(1),ae.mc("toggleable",!1)("open",!1)("active",t.active)("label",t.label)("hint",t.hint))},directives:[Zr,be.a],styles:[""],changeDetection:0}),e})();function is(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"app-portal-item",17),ae.cc("itemClick",(function(){ae.Cc(e);const i=t.$implicit,n=t.index;return ae.gc(2).handleItemClicked(i,n)})),ae.Vb(1,"div",18),ae.Vb(2,"button",19),ae.Qb(3,"app-icon",3),ae.Ub(),ae.Vb(4,"mat-menu",null,20),ae.Vb(6,"button",6),ae.cc("click",(function(){ae.Cc(e);const i=t.$implicit;return ae.gc(2).handleDuplicateClick(i)})),ae.Pc(7,"Duplicate"),ae.Ub(),ae.Vb(8,"button",6),ae.cc("click",(function(){ae.Cc(e);const i=t.$implicit,n=t.index;return ae.gc(2).handleResetClick(i,n)})),ae.Pc(9,"Reset"),ae.Ub(),ae.Vb(10,"button",6),ae.cc("click",(function(){ae.Cc(e);const i=t.$implicit,n=t.index;return ae.gc(2).handleRemoveClick(i,n)})),ae.Pc(11,"Remove"),ae.Ub(),ae.Ub(),ae.Ub(),ae.Ub()}if(2&e){const e=t.$implicit,i=ae.yc(5),n=ae.gc(2);ae.mc("label",n.getComponentLabel(e))("hint",e.type),ae.Db(2),ae.mc("matMenuTriggerFor",i)}}function ns(e,t){if(1&e&&(ae.Tb(0),ae.Nc(1,is,12,3,"app-portal-item",16),ae.Sb()),2&e){const e=ae.gc();ae.Db(1),ae.mc("ngForOf",e.items)}}function os(e,t){if(1&e&&(ae.Vb(0,"div",21),ae.Pc(1),ae.Ub()),2&e){const e=ae.gc();ae.Db(1),ae.Rc(" There are no ",e.type,"s in this chapter. ")}}function as(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"button",22),ae.cc("click",(function(){ae.Cc(e);const i=t.$implicit;return ae.gc().handleAddClick(i)})),ae.Pc(1),ae.hc(2,"prettyPrint"),ae.Ub()}if(2&e){const e=t.$implicit,i=ae.gc();ae.mc("disabled",!i.isTypeAvailable(e)),ae.Db(1),ae.Rc(" ",ae.ic(2,2,e)," ")}}const rs=()=>!0;let ss=(()=>{class e{constructor(e,t){this.dialogService=e,this.particleSystemsService=t,this.types=[],this.items=[],this.isTypeAvailable=rs,this.itemClick=new ae.p,this.addClick=new ae.p,this.duplicateClick=new ae.p,this.removeClick=new ae.p,this.resetAllClick=new ae.p,this.resetClick=new ae.p,this.removeAllClick=new ae.p,this.ngUnsubscribe=new c.a}ngOnInit(){}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}handleItemClicked(e,t){this.itemClick.next(t)}handleAddClick(e){this.addClick.next(e)}handleDuplicateClick(e){this.duplicateClick.next(e)}handleResetClick(e,t){this.resetClick.next(t)}handleRemoveClick(e,t){this.removeClick.next(t)}handleResetAllClick(){this.dialogService.openConfirmDialog({data:{titleText:`Reset ${this.type}s`,bodyText:`Would you like to reset all ${this.type}s?`}}).afterClosed().pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{e&&this.resetAllClick.next()})}handleRemoveAllClick(){this.dialogService.openConfirmDialog({data:{titleText:`Remove All ${this.type}s`,bodyText:`Would you like to remove all ${this.type}s?`}}).afterClosed().pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{e&&this.removeAllClick.next()})}getComponentLabel(e){let t;return t=e.name?`**${e.name}**\n\n${e.id}`:e.id,t}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(yn.a),ae.Pb(Ur))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-edit-particle-list"]],inputs:{label:"label",type:"type",types:"types",items:"items",isTypeAvailable:"isTypeAvailable"},outputs:{itemClick:"itemClick",addClick:"addClick",duplicateClick:"duplicateClick",removeClick:"removeClick",resetAllClick:"resetAllClick",resetClick:"resetClick",removeAllClick:"removeAllClick"},decls:23,vars:9,consts:[[3,"label"],["list-actions",""],["app-button","",3,"matMenuTriggerFor"],["icon","ellipsis-v"],["actionsMenu","matMenu"],["mat-menu-item","",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],[1,"list"],[1,"list__content"],[4,"ngIf"],[1,"flex","flex-column","items-center","mv-2"],["class","list__message text-12 text-center mv-4",4,"ngIf"],["app-button","","buttonType","outline",3,"matMenuTriggerFor"],["icon","angle-down"],["typesMenu","matMenu"],["mat-menu-item","",3,"disabled","click",4,"ngFor","ngForOf"],[3,"label","hint","itemClick",4,"ngFor","ngForOf"],[3,"label","hint","itemClick"],["item-actions",""],["app-button","","buttonSize","xsmall",3,"matMenuTriggerFor"],["itemActionsMenu","matMenu"],[1,"list__message","text-12","text-center","mv-4"],["mat-menu-item","",3,"disabled","click"]],template:function(e,t){if(1&e&&(ae.Vb(0,"app-portal-column",0),ae.Vb(1,"div",1),ae.Vb(2,"button",2),ae.Qb(3,"app-icon",3),ae.Ub(),ae.Vb(4,"mat-menu",null,4),ae.Vb(6,"button",5),ae.Pc(7,"Add New"),ae.Ub(),ae.Vb(8,"button",6),ae.cc("click",(function(){return t.handleResetAllClick()})),ae.Pc(9,"Reset to defaults"),ae.Ub(),ae.Vb(10,"button",6),ae.cc("click",(function(){return t.handleRemoveAllClick()})),ae.Pc(11),ae.Ub(),ae.Ub(),ae.Ub(),ae.Vb(12,"div",7),ae.Vb(13,"div",8),ae.Nc(14,ns,2,1,"ng-container",9),ae.Vb(15,"div",10),ae.Nc(16,os,2,1,"div",11),ae.Vb(17,"button",12),ae.Pc(18),ae.Qb(19,"app-icon",13),ae.Ub(),ae.Ub(),ae.Vb(20,"mat-menu",null,14),ae.Nc(22,as,3,4,"button",15),ae.Ub(),ae.Ub(),ae.Ub(),ae.Ub()),2&e){const e=ae.yc(5),i=ae.yc(21);ae.mc("label",t.label),ae.Db(2),ae.mc("matMenuTriggerFor",e),ae.Db(4),ae.mc("matMenuTriggerFor",i),ae.Db(5),ae.Rc("Remove all ",t.type,"s"),ae.Db(3),ae.mc("ngIf",t.items.length>0),ae.Db(2),ae.mc("ngIf",0===t.items.length),ae.Db(1),ae.mc("matMenuTriggerFor",i),ae.Db(1),ae.Rc(" Add ",t.type," "),ae.Db(4),ae.mc("ngForOf",t.types)}},directives:[kr,pe.a,Sn.d,at.a,Sn.a,Sn.b,n.p,n.o,ts],pipes:[Er],styles:[".list[_ngcontent-%COMP%]{height:100%}.list__content[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column}.list__message[_ngcontent-%COMP%]{color:#61779e}"],changeDetection:0}),e})();var cs=function(e,t,i,n){var o,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,i,r):o(t,i))||r);return a>3&&r&&Object.defineProperty(t,i,r),r},ls=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const ps=function(){return[]};let ds=(()=>{class e{constructor(e,t,i){this.store=e,this.particleSystemsService=t,this.portalComponent=i,this.creatorTypes=Object.values(Xa),this.ngUnsubscribe=new c.a}ngOnInit(){}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}selectClick(e){this.selectItem(e),e>-1&&this.portalComponent.loadComponent(Xr)}handleAddClick(e){this.createNew(e)}handleDuplicateClick(e){const t=this.store.selectSnapshot(xo.a.getSelectedParticleSystem);this.particleSystemsService.duplicateCreator(t,e)}handleRemoveClick(e){this.delete(e)}handleResetClick(e){this.resetDefault(e)}handleResetAllClick(){this.resetDefaults()}handleRemoveAllClick(){this.deleteAll()}selectItem(e){this.store.dispatch(new fo.a.SelectParticleCreator(e))}createNew(e){const t=this.store.selectSnapshot(xo.a.getSelectedParticleSystem);this.particleSystemsService.createNewCreator(t,e)}resetDefault(e){const t=this.store.selectSnapshot(xo.a.getSelectedParticleSystem);this.particleSystemsService.resetCreator(t,e)}resetDefaults(){const e=this.store.selectSnapshot(xo.a.getSelectedParticleSystem);this.particleSystemsService.resetCreators(e)}delete(e){const t=this.store.selectSnapshot(xo.a.getSelectedParticleSystem);t.creators=t.creators.filter((t,i)=>i!==e),this.store.dispatch(new fo.a.UpdateParticleSystem(t.id,t)),this.selectItem(-1)}deleteAll(){const e=this.store.selectSnapshot(xo.a.getSelectedParticleSystem);this.store.dispatch(new fo.a.UpdateParticleSystem(e.id,Object.assign(Object.assign({},e),{creators:[]})))}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(r.h),ae.Pb(Ur),ae.Pb(Ka))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-edit-particle-creator-list"]],decls:2,vars:5,consts:[["label","Creators","type","creator",3,"types","items","itemClick","addClick","removeClick","duplicateClick","resetClick","resetAllClick","removeAllClick"]],template:function(e,t){if(1&e&&(ae.Vb(0,"app-edit-particle-list",0),ae.cc("itemClick",(function(e){return t.selectClick(e)}))("addClick",(function(e){return t.handleAddClick(e)}))("removeClick",(function(e){return t.handleRemoveClick(e)}))("duplicateClick",(function(e){return t.handleDuplicateClick(e)}))("resetClick",(function(e){return t.handleResetClick(e)}))("resetAllClick",(function(){return t.handleResetAllClick()}))("removeAllClick",(function(){return t.handleRemoveAllClick()})),ae.hc(1,"async"),ae.Ub()),2&e){let e=null;ae.mc("types",t.creatorTypes)("items",(null==(e=ae.ic(1,2,t.particleSystem$))?null:e.creators)||ae.oc(4,ps))}},directives:[ss],pipes:[n.b],styles:[""],changeDetection:0}),cs([Object(r.e)(xo.a.getSelectedParticleSystemId),ls("design:type",m.a)],e.prototype,"particleSystemId$",void 0),cs([Object(r.e)(xo.a.getSelectedParticleSystem),ls("design:type",m.a)],e.prototype,"particleSystem$",void 0),e})(),us=(()=>{class e{constructor(e,t){this.formBuilder=e,this.store=t,this.ngUnsubscribe=new c.a,this.initForm()}ngOnInit(){this.initFormListeners(),this.initParticleSystemListeners()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initForm(){this.formGroup=this.formBuilder.group({layer:[1],depthMask:[!1],roundPoints:[!1],perspectivePoints:[!1],addAlpha:[!1]}),this.setDefaults(!1)}initFormListeners(){this.formGroup.valueChanges.pipe(Object(pi.a)(125),Object(Dn.a)((e,t)=>Object(W.isEqual)(e,t)),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.setParticleSystem(e)})}initParticleSystemListeners(){this.store.select(xo.a.getSelectedParticleSystem).pipe(Object(Dn.a)((e,t)=>Object(W.isEqual)(e,t)),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.setValues(e.properties,!1)})}handleResetClick(){this.setDefaults(!0)}setValues(e,t){this.formGroup.patchValue(Object.assign({},e),{emitEvent:t})}setParticleSystem(e){const t=this.store.selectSnapshot(xo.a.getSelectedParticleSystem),i=Object.assign(Object.assign({},t),{properties:e});this.store.dispatch(new fo.a.UpdateParticleSystem(i.id,i))}setDefaults(e){this.setValues(pr,e)}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(G.f),ae.Pb(r.h))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-edit-particle-properties"]],decls:23,vars:5,consts:[["label","Properties"],["list-actions",""],["app-button","",3,"matMenuTriggerFor"],["icon","ellipsis-v"],[3,"overlapTrigger"],["systemActions","matMenu"],["mat-menu-item","",3,"click"],[1,"text-12",3,"formGroup"],["label","Layer"],["formControlName","layer",3,"min","max"],["formControlName","depthMask"],["formControlName","roundPoints"],["formControlName","perspectivePoints"],["formControlName","addAlpha"]],template:function(e,t){if(1&e&&(ae.Vb(0,"app-portal-column",0),ae.Vb(1,"div",1),ae.Vb(2,"button",2),ae.Qb(3,"app-icon",3),ae.Ub(),ae.Vb(4,"mat-menu",4,5),ae.Vb(6,"button",6),ae.cc("click",(function(){return t.handleResetClick()})),ae.Pc(7,"Reset to default"),ae.Ub(),ae.Ub(),ae.Ub(),ae.Vb(8,"app-panel",7),ae.Vb(9,"app-form-field",8),ae.Qb(10,"app-slider",9),ae.Ub(),ae.Vb(11,"app-form-field"),ae.Vb(12,"mat-checkbox",10),ae.Pc(13,"Depth Mask"),ae.Ub(),ae.Ub(),ae.Vb(14,"app-form-field"),ae.Vb(15,"mat-checkbox",11),ae.Pc(16,"Round Points"),ae.Ub(),ae.Ub(),ae.Vb(17,"app-form-field"),ae.Vb(18,"mat-checkbox",12),ae.Pc(19,"Perspective Points"),ae.Ub(),ae.Ub(),ae.Vb(20,"app-form-field"),ae.Vb(21,"mat-checkbox",13),ae.Pc(22,"Add Alpha"),ae.Ub(),ae.Ub(),ae.Ub(),ae.Ub()),2&e){const e=ae.yc(5);ae.Db(2),ae.mc("matMenuTriggerFor",e),ae.Db(2),ae.mc("overlapTrigger",!0),ae.Db(4),ae.mc("formGroup",t.formGroup),ae.Db(2),ae.mc("min",0)("max",1e3)}},directives:[kr,pe.a,Sn.d,at.a,Sn.a,Sn.b,be.a,G.s,G.j,de.a,io.a,G.r,G.i,ge.a],styles:[""],changeDetection:0}),e})();var hs=i("jaxi");let ms=(()=>{class e extends Tr.b{constructor(){super(...arguments),this.shapeTypesEnum=er}ngOnInit(){}}return e.\u0275fac=function(t){return bs(t||e)},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-edit-particle-shape-selector"]],features:[ae.Cb([{provide:G.p,useExisting:Object(ae.W)(()=>e),multi:!0}]),ae.Ab],decls:9,vars:13,consts:[[3,"formControl"],[3,"value","matTooltip"],["icon","circle"],["icon","diamond"],["icon","cube"],["icon","rectangle-portrait"]],template:function(e,t){1&e&&(ae.Vb(0,"mat-button-toggle-group",0),ae.Vb(1,"mat-button-toggle",1),ae.Qb(2,"app-icon",2),ae.Ub(),ae.Vb(3,"mat-button-toggle",1),ae.Qb(4,"app-icon",3),ae.Ub(),ae.Vb(5,"mat-button-toggle",1),ae.Qb(6,"app-icon",4),ae.Ub(),ae.Vb(7,"mat-button-toggle",1),ae.Qb(8,"app-icon",5),ae.Ub(),ae.Ub()),2&e&&(ae.mc("formControl",t.control),ae.Db(1),ae.mc("value",t.shapeTypesEnum.Sphere)("matTooltip",t.shapeTypesEnum.Sphere),ae.Eb("aria-label",t.shapeTypesEnum.Sphere),ae.Db(2),ae.mc("value",t.shapeTypesEnum.Plane)("matTooltip",t.shapeTypesEnum.Plane),ae.Eb("aria-label",t.shapeTypesEnum.Plane),ae.Db(2),ae.mc("value",t.shapeTypesEnum.Cube)("matTooltip",t.shapeTypesEnum.Cube),ae.Eb("aria-label",t.shapeTypesEnum.Cube),ae.Db(2),ae.mc("value",t.shapeTypesEnum.Cylinder)("matTooltip",t.shapeTypesEnum.Cylinder),ae.Eb("aria-label",t.shapeTypesEnum.Cylinder))},directives:[hs.b,G.r,G.h,hs.a,st.c,at.a],styles:[""],changeDetection:0}),e})();const bs=ae.Xb(ms);let gs=(()=>{class e extends Tr.b{constructor(){super(...arguments),this.shapeDirectionEnum=tr}ngOnInit(){}}return e.\u0275fac=function(t){return fs(t||e)},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-edit-particle-direction-selector"]],features:[ae.Cb([{provide:G.p,useExisting:Object(ae.W)(()=>e),multi:!0}]),ae.Ab],decls:7,vars:7,consts:[[3,"formControl"],[3,"value","matTooltip"],[1,"text-uppercase"]],template:function(e,t){1&e&&(ae.Vb(0,"mat-button-toggle-group",0),ae.Vb(1,"mat-button-toggle",1),ae.Vb(2,"div",2),ae.Pc(3,"In"),ae.Ub(),ae.Ub(),ae.Vb(4,"mat-button-toggle",1),ae.Vb(5,"div",2),ae.Pc(6,"Out"),ae.Ub(),ae.Ub(),ae.Ub()),2&e&&(ae.mc("formControl",t.control),ae.Db(1),ae.mc("value",t.shapeDirectionEnum.In)("matTooltip",t.shapeDirectionEnum.In),ae.Eb("aria-label",t.shapeDirectionEnum.In),ae.Db(3),ae.mc("value",t.shapeDirectionEnum.Out)("matTooltip",t.shapeDirectionEnum.Out),ae.Eb("aria-label",t.shapeDirectionEnum.Out))},directives:[hs.b,G.r,G.h,hs.a,st.c],styles:[""],changeDetection:0}),e})();const fs=ae.Xb(gs);let xs=(()=>{class e extends Tr.a{constructor(e,t){super(),this.formBuilder=e,this.changeRef=t,this.ngUnsubscribe=new c.a,this.formGroup=this.formBuilder.group({type:[er.Cube],scale:[[0,0,0]],rotate:[[0,0,0]],translate:[[0,0,0]],direction:[tr.In]})}ngOnInit(){this.formGroup.valueChanges.pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.value=e})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}setFormValues(e){this.formGroup.patchValue(e),this.changeRef.markForCheck()}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(G.f),ae.Pb(ae.i))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-edit-particle-shape"]],features:[ae.Cb([{provide:G.p,useExisting:Object(ae.W)(()=>e),multi:!0}]),ae.Ab],decls:11,vars:19,consts:[[3,"formGroup"],["label","Shape Type"],["formControlName","type"],["label","Direction Selector"],["formControlName","direction"],["label","Translate"],["formControlName","translate",3,"xmin","xmax","ymin","ymax","zmin","zmax"],["label","Rotate"],["formControlName","rotate",3,"xmin","xmax","ymin","ymax","zmin","zmax"],["label","Scale"],["formControlName","scale",3,"xmin","xmax","ymin","ymax","zmin","zmax"]],template:function(e,t){1&e&&(ae.Tb(0,0),ae.Vb(1,"app-form-field",1),ae.Qb(2,"app-edit-particle-shape-selector",2),ae.Ub(),ae.Vb(3,"app-form-field",3),ae.Qb(4,"app-edit-particle-direction-selector",4),ae.Ub(),ae.Vb(5,"app-form-field",5),ae.Qb(6,"app-edit-particle-vector",6),ae.Ub(),ae.Vb(7,"app-form-field",7),ae.Qb(8,"app-edit-particle-vector",8),ae.Ub(),ae.Vb(9,"app-form-field",9),ae.Qb(10,"app-edit-particle-vector",10),ae.Ub(),ae.Sb()),2&e&&(ae.mc("formGroup",t.formGroup),ae.Db(6),ae.mc("xmin",-10)("xmax",10)("ymin",-10)("ymax",10)("zmin",-10)("zmax",10),ae.Db(2),ae.mc("xmin",-180)("xmax",180)("ymin",-180)("ymax",180)("zmin",-180)("zmax",180),ae.Db(2),ae.mc("xmin",0)("xmax",20)("ymin",0)("ymax",20)("zmin",0)("zmax",20))},directives:[G.s,G.j,de.a,ms,G.r,G.i,gs,Vr],styles:[""],changeDetection:0}),e})();var ys=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function vs(e,t){if(1&e&&(ae.Vb(0,"option",15),ae.Pc(1),ae.hc(2,"prettyPrint"),ae.Ub()),2&e){const e=t.$implicit;ae.mc("value",e),ae.Db(1),ae.Rc(" ",ae.ic(2,2,e)," ")}}function Cs(e,t){1&e&&(ae.Tb(0),ae.Vb(1,"app-form-field",16),ae.Vb(2,"mat-checkbox",17),ae.Pc(3,"Trap Shape"),ae.Ub(),ae.Ub(),ae.Qb(4,"app-edit-particle-shape",18),ae.Sb())}let Ps=(()=>{class e{constructor(e,t,i,n){this.store=e,this.formBuilder=t,this.portalComponent=i,this.particleSystemsService=n,this.constraintsEnum=Ya,this.shapeTypesEnum=er,this.availableConstraints=Object.values(Ya),this.ngUnsubscribe=new c.a,this.formGroup=this.formBuilder.group({id:[""],name:[""],type:[""],trap:[!1],shape:[]})}get isShapeType(){const{type:e}=this.formGroup.value;return nr.includes(e)}ngOnInit(){this.initFormListeners(),this.initConstraintListeners()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initFormListeners(){this.formGroup.valueChanges.pipe(Object(pi.a)(125),Object(Dn.a)((e,t)=>Object(W.isEqual)(e,t)),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{const t=yr(e.type,e);this.updateSystem(t)});const e=this.formGroup.get("type");e.valueChanges.pipe(Object(Mr.a)(e.value),Object(_.a)(),Object(P.a)(this.ngUnsubscribe)).subscribe(([e,t])=>{const i=or[t],n=yr(e,this.formGroup.value),o=yr(t,Object.assign(Object.assign({},i),n));this.setValues(o,!1)})}initConstraintListeners(){this.particleConstraint$.pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{const t=this.store.selectSnapshot(xo.a.getSelectedParticleSystem);this.availableConstraints=Object.values(Ya).filter(e=>Pr(t,e)),this.setValues(e,!1)})}setValues(e,t){this.formGroup.patchValue(Object.assign({},e),{emitEvent:t})}handleDuplicateClick(){const e=this.store.selectSnapshot(xo.a.getSelectedParticleSystem),t=this.store.selectSnapshot(xo.a.getSelectedParticleConstraint);this.particleSystemsService.duplicateConstraint(e,t)}handleResetClick(){const e=this.store.selectSnapshot(xo.a.getSelectedParticleSystem),t=this.store.selectSnapshot(xo.a.getSelectedParticleConstraintIndex);this.particleSystemsService.resetConstraint(e,t)}handleRemoveClick(){const e=this.store.selectSnapshot(xo.a.getSelectedParticleSystem),t=this.store.selectSnapshot(xo.a.getSelectedParticleConstraintIndex);this.particleSystemsService.removeConstraint(e,t),this.portalComponent.back()}updateSystem(e){const t=this.store.selectSnapshot(xo.a.getSelectedParticleSystem),i=this.store.selectSnapshot(xo.a.getSelectedParticleConstraintIndex);t.constraints[i]=e,this.store.dispatch(new fo.a.UpdateParticleSystem(t.id,t))}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(r.h),ae.Pb(G.f),ae.Pb(Ka),ae.Pb(Ur))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-edit-particle-constraint"]],decls:23,vars:7,consts:[["label","Constraint"],["list-actions",""],["app-button","",3,"matMenuTriggerFor"],["icon","ellipsis-v"],["actionsMenu","matMenu"],["mat-menu-item","",3,"click"],[3,"formGroup"],["label","Name"],["type","text","formControlName","name",1,"input"],["label","ID"],[1,"text-11"],["label","Type"],["formControlName","type",1,"input"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"value"],["label","Trap"],["formControlName","trap",1,"text-12"],["formControlName","shape"]],template:function(e,t){if(1&e&&(ae.Vb(0,"app-portal-column",0),ae.Vb(1,"div",1),ae.Vb(2,"button",2),ae.Qb(3,"app-icon",3),ae.Ub(),ae.Vb(4,"mat-menu",null,4),ae.Vb(6,"button",5),ae.cc("click",(function(){return t.handleDuplicateClick()})),ae.Pc(7,"Duplicate"),ae.Ub(),ae.Vb(8,"button",5),ae.cc("click",(function(){return t.handleResetClick()})),ae.Pc(9,"Reset to default"),ae.Ub(),ae.Vb(10,"button",5),ae.cc("click",(function(){return t.handleRemoveClick()})),ae.Pc(11,"Remove"),ae.Ub(),ae.Ub(),ae.Ub(),ae.Vb(12,"app-panel",6),ae.Vb(13,"app-form-field",7),ae.Qb(14,"input",8),ae.Ub(),ae.Vb(15,"app-form-field",9),ae.Vb(16,"span",10),ae.Pc(17),ae.hc(18,"async"),ae.Ub(),ae.Ub(),ae.Vb(19,"app-form-field",11),ae.Vb(20,"select",12),ae.Nc(21,vs,3,4,"option",13),ae.Ub(),ae.Ub(),ae.Nc(22,Cs,5,0,"ng-container",14),ae.Ub(),ae.Ub()),2&e){const e=ae.yc(5);let i=null;ae.Db(2),ae.mc("matMenuTriggerFor",e),ae.Db(10),ae.mc("formGroup",t.formGroup),ae.Db(5),ae.Qc(null==(i=ae.ic(18,5,t.particleConstraint$))?null:i.id),ae.Db(4),ae.mc("ngForOf",t.availableConstraints),ae.Db(1),ae.mc("ngIf",t.isShapeType)}},directives:[kr,pe.a,Sn.d,at.a,Sn.a,Sn.b,be.a,G.s,G.j,de.a,G.c,G.r,G.i,G.B,n.o,n.p,G.v,G.D,ge.a,xs],pipes:[n.b,Er],styles:[""],changeDetection:0}),function(e,t,i,n){var o,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,i,r):o(t,i))||r);a>3&&r&&Object.defineProperty(t,i,r)}([Object(r.e)(xo.a.getSelectedParticleConstraint),ys("design:type",m.a)],e.prototype,"particleConstraint$",void 0),e})();var Os=function(e,t,i,n){var o,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,i,r):o(t,i))||r);return a>3&&r&&Object.defineProperty(t,i,r),r},ws=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const ks=function(){return[]};let Ss=(()=>{class e{constructor(e,t,i){this.store=e,this.particleSystemsService=t,this.portalComponent=i,this.constraintTypes=Object.values(Ya),this.isConstraintAvailable=()=>!0,this.isConstraintAvailable=this.checkConstraintAvailable.bind(this)}ngOnInit(){}selectClick(e){this.selectItem(e)}handleAddClick(e){this.createNew(e)}handleDuplicateClick(e){const t=this.store.selectSnapshot(xo.a.getSelectedParticleSystem);this.particleSystemsService.duplicateConstraint(t,e)}handleRemoveClick(e){this.delete(e)}handleResetClick(e){this.resetDefault(e)}handleResetAllClick(){this.resetDefaults()}handleRemoveAllClick(){this.deleteAll()}checkConstraintAvailable(e){return Pr(this.store.selectSnapshot(xo.a.getSelectedParticleSystem),e)}selectItem(e){this.store.dispatch(new fo.a.SelectParticleConstraint(e)),e>-1&&this.portalComponent.loadComponent(Ps)}createNew(e){const t=this.store.selectSnapshot(xo.a.getSelectedParticleSystem);this.particleSystemsService.createNewConstraint(t,e)}resetDefault(e){const t=this.store.selectSnapshot(xo.a.getSelectedParticleSystem);this.particleSystemsService.resetConstraint(t,e)}resetDefaults(){const e=this.store.selectSnapshot(xo.a.getSelectedParticleSystem);this.particleSystemsService.resetConstraints(e)}delete(e){const t=this.store.selectSnapshot(xo.a.getSelectedParticleSystem);t.constraints=t.constraints.filter((t,i)=>i!==e),this.store.dispatch(new fo.a.UpdateParticleSystem(t.id,t)),this.selectItem(-1)}deleteAll(){const e=this.store.selectSnapshot(xo.a.getSelectedParticleSystem);this.store.dispatch(new fo.a.UpdateParticleSystem(e.id,Object.assign(Object.assign({},e),{constraints:[]})))}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(r.h),ae.Pb(Ur),ae.Pb(Ka))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-edit-particle-constraint-list"]],decls:2,vars:6,consts:[["label","Constraints","type","constraint",3,"types","items","isTypeAvailable","itemClick","addClick","removeClick","duplicateClick","resetClick","resetAllClick","removeAllClick"]],template:function(e,t){if(1&e&&(ae.Vb(0,"app-edit-particle-list",0),ae.cc("itemClick",(function(e){return t.selectClick(e)}))("addClick",(function(e){return t.handleAddClick(e)}))("removeClick",(function(e){return t.handleRemoveClick(e)}))("duplicateClick",(function(e){return t.handleDuplicateClick(e)}))("resetClick",(function(e){return t.handleResetClick(e)}))("resetAllClick",(function(){return t.handleResetAllClick()}))("removeAllClick",(function(){return t.handleRemoveAllClick()})),ae.hc(1,"async"),ae.Ub()),2&e){let e=null;ae.mc("types",t.constraintTypes)("items",(null==(e=ae.ic(1,3,t.particleSystem$))?null:e.constraints)||ae.oc(5,ks))("isTypeAvailable",t.isConstraintAvailable)}},directives:[ss],pipes:[n.b],styles:[""],changeDetection:0}),Os([Object(r.e)(xo.a.getSelectedParticleSystemId),ws("design:type",m.a)],e.prototype,"particleSystemId$",void 0),Os([Object(r.e)(xo.a.getSelectedParticleSystem),ws("design:type",m.a)],e.prototype,"particleSystem$",void 0),e})();var _s=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Ms(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"app-panel",12,13),ae.Vb(2,"div",14),ae.Vb(3,"button",2),ae.Qb(4,"app-icon",3),ae.Ub(),ae.Vb(5,"mat-menu",null,15),ae.Vb(7,"button",5),ae.cc("click",(function(){ae.Cc(e);const i=t.index;return ae.gc().handleRemovePathNodeClick(i)})),ae.Pc(8,"Remove Node"),ae.Ub(),ae.Vb(9,"button",5),ae.cc("click",(function(){ae.Cc(e);const i=t.$implicit;return ae.gc().handleDuplicatePathNodeClick(i)})),ae.Pc(10," Duplicate Node "),ae.Ub(),ae.Ub(),ae.Ub(),ae.Vb(11,"app-form-field",16),ae.Qb(12,"app-edit-particle-vector",17),ae.Ub(),ae.Vb(13,"app-form-field",18),ae.Qb(14,"app-slider",19),ae.Ub(),ae.Vb(15,"app-form-field",20),ae.Qb(16,"app-slider",21),ae.Ub(),ae.Vb(17,"app-form-field",22),ae.Qb(18,"app-slider",23),ae.Ub(),ae.Ub()}if(2&e){const e=t.$implicit,i=t.index,n=ae.yc(1),o=ae.yc(6),a=ae.gc();ae.mc("cdkDragDisabled",n.open)("open",!1)("label","Path Node #"+(i+1))("hint",a.formatNodeHint(e))("isCompact",!0)("formGroupName",i),ae.Db(3),ae.mc("matMenuTriggerFor",o),ae.Db(9),ae.mc("xmin",-10)("xmax",10)("ymin",-10)("ymax",10)("zmin",-10)("zmax",10),ae.Db(2),ae.mc("min",0)("max",25)("step",1),ae.Db(2),ae.mc("min",0)("max",100)("step",1),ae.Db(2),ae.mc("min",0)("max",25)("step",1)}}function Us(e,t){1&e&&(ae.Vb(0,"div",24),ae.Pc(1," There are no Path Nodes in this updater. "),ae.Ub())}const Ts={position:[0,0,0],forceAverage:0,radius:0,forceVariance:0};let Vs=(()=>{class e{constructor(e,t,i){this.formBuilder=e,this.store=t,this.dialogService=i,this.ngUnsubscribe=new c.a,this.formGroup=this.formBuilder.group({nodes:this.formBuilder.array([])}),this.nodesFormArray=this.formGroup.get("nodes")}ngOnInit(){this.initFormListeners(),this.initUpdaterListeners()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initFormListeners(){this.formGroup.valueChanges.pipe(Object(pi.a)(125),Object(Dn.a)((e,t)=>Object(W.isEqual)(e,t)),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{const t=this.createUpdaterFromValues(this.formGroup.value);this.updateSystem(t)})}initUpdaterListeners(){this.particleUpdater$.pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.setValues(e)})}handleAddPathNodeClick(){this.addPathNode()}handleRemoveAllPathNodesClick(){this.dialogService.openConfirmDialog({data:{titleText:"Remove All Path Nodes",bodyText:`Would you like to remove all ${this.nodesFormArray.length} Path Nodes?`}}).afterClosed().pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{if(e){const e=this.createUpdaterFromValues({nodes:[]});this.updateSystem(e)}})}handleRemovePathNodeClick(e){this.nodesFormArray.removeAt(e)}handleDuplicatePathNodeClick(e){const t=this.createPathNodeFormGroup(e.value);this.nodesFormArray.push(t)}handlePathNodeDropped(e){const{previousIndex:t,currentIndex:i}=e,n=this.formGroup.value,{nodes:o}=n,a=Object(te.a)(o,t,i);this.nodesFormArray.clear(),a.forEach(e=>{const t=this.createPathNodeFormGroup(e);this.nodesFormArray.push(t)}),this.formGroup.patchValue({nodes:a})}addPathNode(){const e=this.createPathNodeFormGroup(Ts);this.nodesFormArray.push(e)}createPathNodeFormGroup(e){const{position:t,forceAverage:i,radius:n,forceVariance:o}=e;return this.formBuilder.group({position:[t],forceAverage:[i],radius:[n],forceVariance:[o]})}setValues(e){e.type===Za.Path&&void 0!==e.nodes&&this.nodesFormArray.length!==e.nodes.length&&(this.nodesFormArray.clear(),e.nodes.forEach(()=>{const e=this.createPathNodeFormGroup(Ts);this.nodesFormArray.push(e)})),this.formGroup.patchValue(Object.assign({},e),{emitEvent:!1,onlySelf:!0})}formatNodeHint(e){const t=e.value,{position:i,forceAverage:n,radius:o,forceVariance:a}=t;return`Postition: [${i}], Force Average: ${n}, Radius: ${o}, Force Variance: ${a}`}createUpdaterFromValues(e){const t=this.store.selectSnapshot(xo.a.getSelectedParticleUpdater);return Cr(t.type,Object.assign(Object.assign({},t),e))}updateSystem(e){const t=this.store.selectSnapshot(xo.a.getSelectedParticleSystem),i=this.store.selectSnapshot(xo.a.getSelectedParticleUpdaterIndex);t.updaters[i]=e,this.store.dispatch(new fo.a.UpdateParticleSystem(t.id,t))}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(G.f),ae.Pb(r.h),ae.Pb(yn.a))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-edit-particle-updater-node"]],decls:19,vars:9,consts:[[3,"formGroup","label"],["list-actions",""],["app-button","",3,"matMenuTriggerFor"],["icon","ellipsis-v"],["pathNodeMenu","matMenu"],["mat-menu-item","",3,"click"],["formArrayName","nodes"],["cdkDropList","","cdkDropListOrientation","vertical",3,"cdkDropListDropped"],["cdkDrag","","toggleType","arrow",3,"cdkDragDisabled","open","label","hint","isCompact","formGroupName",4,"ngFor","ngForOf"],[1,"flex","flex-column","items-center","mv-2"],["class","text-12 text-center mv-4",4,"ngIf"],["app-button","","buttonType","outline",3,"click"],["cdkDrag","","toggleType","arrow",3,"cdkDragDisabled","open","label","hint","isCompact","formGroupName"],["nodePanel",""],["panel-actions",""],["nodeActionsMenu","matMenu"],["label","Position"],["formControlName","position",3,"xmin","xmax","ymin","ymax","zmin","zmax"],["label","Force Average"],["formControlName","forceAverage",3,"min","max","step"],["label","Radius"],["formControlName","radius",3,"min","max","step"],["label","Force Variance"],["formControlName","forceVariance",3,"min","max","step"],[1,"text-12","text-center","mv-4"]],template:function(e,t){if(1&e&&(ae.Vb(0,"app-portal-column",0),ae.Vb(1,"div",1),ae.Vb(2,"button",2),ae.Qb(3,"app-icon",3),ae.Ub(),ae.Vb(4,"mat-menu",null,4),ae.Vb(6,"button",5),ae.cc("click",(function(){return t.handleAddPathNodeClick()})),ae.Pc(7,"Add Node"),ae.Ub(),ae.Vb(8,"button",5),ae.cc("click",(function(){return t.handleRemoveAllPathNodesClick()})),ae.Pc(9,"Remove All Nodes"),ae.Ub(),ae.Ub(),ae.Ub(),ae.Tb(10,6),ae.Vb(11,"div",7),ae.cc("cdkDropListDropped",(function(e){return t.handlePathNodeDropped(e)})),ae.Nc(12,Ms,19,22,"app-panel",8),ae.Ub(),ae.Vb(13,"div",9),ae.Nc(14,Us,2,0,"div",10),ae.hc(15,"async"),ae.hc(16,"async"),ae.Vb(17,"button",11),ae.cc("click",(function(){return t.handleAddPathNodeClick()})),ae.Pc(18,"Add Node"),ae.Ub(),ae.Ub(),ae.Sb(),ae.Ub()),2&e){const e=ae.yc(5);let i=null;ae.mc("formGroup",t.formGroup)("label","Path Nodes"),ae.Db(2),ae.mc("matMenuTriggerFor",e),ae.Db(10),ae.mc("ngForOf",t.nodesFormArray.controls),ae.Db(2),ae.mc("ngIf",(null==(i=ae.ic(15,5,t.particleUpdater$))?null:i.nodes)&&0===(null==(i=ae.ic(16,7,t.particleUpdater$))?null:i.nodes.length))}},directives:[kr,G.s,G.j,pe.a,Sn.d,at.a,Sn.a,Sn.b,G.e,ot.c,n.o,n.p,be.a,ot.a,G.k,de.a,Vr,G.r,G.i,io.a],pipes:[n.b],styles:[""],changeDetection:0}),function(e,t,i,n){var o,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,i,r):o(t,i))||r);a>3&&r&&Object.defineProperty(t,i,r)}([Object(r.e)(xo.a.getSelectedParticleUpdater),_s("design:type",m.a)],e.prototype,"particleUpdater$",void 0),e})();var Ds=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Es(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"app-panel",12),ae.Vb(1,"div",13),ae.Vb(2,"button",2),ae.Qb(3,"app-icon",3),ae.Ub(),ae.Vb(4,"mat-menu",null,14),ae.Vb(6,"button",5),ae.cc("click",(function(){ae.Cc(e);const i=t.index;return ae.gc().handleRemovePathColorClick(i)})),ae.Pc(7,"Remove Color"),ae.Ub(),ae.Vb(8,"button",5),ae.cc("click",(function(){ae.Cc(e);const i=t.$implicit;return ae.gc().handleDuplicatePathColorClick(i)})),ae.Pc(9," Duplicate Color "),ae.Ub(),ae.Ub(),ae.Ub(),ae.Qb(10,"app-color-picker-input",15),ae.Ub()}if(2&e){const e=t.index,i=ae.yc(5);ae.mc("toggleable",!1)("label","Color #"+(e+1))("isCompact",!0),ae.Db(2),ae.mc("matMenuTriggerFor",i),ae.Db(8),ae.mc("formControlName",e)("alpha",!0)("decimal",!1)}}function js(e,t){1&e&&(ae.Vb(0,"div",16),ae.Pc(1," There are no colors in this updater. "),ae.Ub())}const Ns=[255,0,0,1];let Rs=(()=>{class e{constructor(e,t,i){this.formBuilder=e,this.store=t,this.dialogService=i,this.ngUnsubscribe=new c.a,this.formGroup=this.formBuilder.group({colors:this.formBuilder.array([[0,0,0,1],[0,0,0,1],[0,0,0,1]])}),this.colorsFormArray=this.formGroup.get("colors")}ngOnInit(){this.initFormListeners(),this.initUpdaterListeners()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initFormListeners(){this.formGroup.valueChanges.pipe(Object(pi.a)(125),Object(Dn.a)((e,t)=>Object(W.isEqual)(e,t)),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{const t=this.createUpdaterFromValues(this.formGroup.value);this.updateSystem(t)})}initUpdaterListeners(){this.particleUpdater$.pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.setValues(e)})}handleAddPathColorClick(){this.addPathColor()}handleRemoveAllPathColorsClick(){this.dialogService.openConfirmDialog({data:{titleText:"Remove All Colors",bodyText:`Would you like to remove all ${this.colorsFormArray.length} colors?`}}).afterClosed().pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{if(e){const e=this.createUpdaterFromValues({colors:[]});this.updateSystem(e)}})}handleRemovePathColorClick(e){this.colorsFormArray.removeAt(e)}handleDuplicatePathColorClick(e){const t=this.createColorControl(e.value);this.colorsFormArray.push(t)}handlePathColorDropped(e){const{previousIndex:t,currentIndex:i}=e,n=this.formGroup.value,{colors:o}=n,a=Object(te.a)(o,t,i);this.colorsFormArray.clear(),a.forEach(e=>{const t=this.createColorControl(e);this.colorsFormArray.push(t)}),this.formGroup.patchValue({colors:a})}addPathColor(){const e=this.createColorControl(Ns);this.colorsFormArray.push(e)}createColorControl(e){const t=this.formBuilder.control([]);return t.setValue(e),t}setValues(e){let t=Object(W.get)(e,"colors",[]);Array.isArray(t)&&Array.isArray(t)&&(t=this.colorModelToFormColor(t)),this.colorsFormArray.length!==t.length&&(this.colorsFormArray.clear(),t.forEach(()=>{const e=this.createColorControl(Ns);this.colorsFormArray.push(e)})),this.formGroup.patchValue({colors:t},{emitEvent:!1,onlySelf:!0})}colorModelToFormColor(e){return e.map(([e,t,i,n])=>[e,t,i,n/255])}formColorToColorModel(e){return e.map(([e,t,i,n])=>[e,t,i,255*n])}createUpdaterFromValues(e){const t=e.colors,i=this.store.selectSnapshot(xo.a.getSelectedParticleUpdater);return Cr(i.type,Object.assign(Object.assign({},i),{colors:this.formColorToColorModel(t)}))}updateSystem(e){const t=this.store.selectSnapshot(xo.a.getSelectedParticleSystem),i=this.store.selectSnapshot(xo.a.getSelectedParticleUpdaterIndex);t.updaters[i]=e,this.store.dispatch(new fo.a.UpdateParticleSystem(t.id,t))}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(G.f),ae.Pb(r.h),ae.Pb(yn.a))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-edit-particle-updater-color"]],decls:19,vars:9,consts:[[3,"formGroup","label"],["list-actions",""],["app-button","",3,"matMenuTriggerFor"],["icon","ellipsis-v"],["colorsMenu","matMenu"],["mat-menu-item","",3,"click"],["formArrayName","colors"],["cdkDropList","","cdkDropListOrientation","vertical",3,"cdkDropListDropped"],["cdkDrag","",3,"toggleable","label","isCompact",4,"ngFor","ngForOf"],[1,"flex","flex-column","items-center","mv-2"],["class","text-12 text-center mv-4",4,"ngIf"],["app-button","","buttonType","outline",3,"click"],["cdkDrag","",3,"toggleable","label","isCompact"],["panel-actions",""],["colorActionsMenu","matMenu"],["type","rgba",3,"formControlName","alpha","decimal"],[1,"text-12","text-center","mv-4"]],template:function(e,t){if(1&e&&(ae.Vb(0,"app-portal-column",0),ae.Vb(1,"div",1),ae.Vb(2,"button",2),ae.Qb(3,"app-icon",3),ae.Ub(),ae.Vb(4,"mat-menu",null,4),ae.Vb(6,"button",5),ae.cc("click",(function(){return t.handleAddPathColorClick()})),ae.Pc(7,"Add Color"),ae.Ub(),ae.Vb(8,"button",5),ae.cc("click",(function(){return t.handleRemoveAllPathColorsClick()})),ae.Pc(9,"Remove All Colors"),ae.Ub(),ae.Ub(),ae.Ub(),ae.Tb(10,6),ae.Vb(11,"div",7),ae.cc("cdkDropListDropped",(function(e){return t.handlePathColorDropped(e)})),ae.Nc(12,Es,11,7,"app-panel",8),ae.Ub(),ae.Vb(13,"div",9),ae.Nc(14,js,2,0,"div",10),ae.hc(15,"async"),ae.hc(16,"async"),ae.Vb(17,"button",11),ae.cc("click",(function(){return t.handleAddPathColorClick()})),ae.Pc(18,"Add Color"),ae.Ub(),ae.Ub(),ae.Sb(),ae.Ub()),2&e){const e=ae.yc(5);let i=null;ae.mc("formGroup",t.formGroup)("label","Colors"),ae.Db(2),ae.mc("matMenuTriggerFor",e),ae.Db(10),ae.mc("ngForOf",t.colorsFormArray.controls),ae.Db(2),ae.mc("ngIf",(null==(i=ae.ic(15,5,t.particleUpdater$))?null:i.colors)&&0===(null==(i=ae.ic(16,7,t.particleUpdater$))?null:i.colors.length))}},directives:[kr,G.s,G.j,pe.a,Sn.d,at.a,Sn.a,Sn.b,G.e,ot.c,n.o,n.p,be.a,ot.a,mt,G.r,G.i],pipes:[n.b],styles:[""],changeDetection:0}),function(e,t,i,n){var o,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,i,r):o(t,i))||r);a>3&&r&&Object.defineProperty(t,i,r)}([Object(r.e)(xo.a.getSelectedParticleUpdater),Ds("design:type",m.a)],e.prototype,"particleUpdater$",void 0),e})();var As=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Fs(e,t){if(1&e&&(ae.Vb(0,"option",16),ae.Pc(1),ae.hc(2,"prettyPrint"),ae.Ub()),2&e){const e=t.$implicit;ae.mc("value",e),ae.Db(1),ae.Rc(" ",ae.ic(2,2,e)," ")}}function Is(e,t){if(1&e){const e=ae.Wb();ae.Tb(0),ae.Vb(1,"app-portal-item",17),ae.cc("itemClick",(function(){return ae.Cc(e),ae.gc().handleColorsClicked()})),ae.Ub(),ae.Vb(2,"app-panel",18),ae.Qb(3,"app-edit-particle-shape",19),ae.Ub(),ae.Sb()}2&e&&(ae.Db(1),ae.mc("label","Colors"))}function zs(e,t){1&e&&(ae.Tb(0),ae.Vb(1,"app-panel"),ae.Vb(2,"app-form-field",20),ae.Qb(3,"app-slider",21),ae.Ub(),ae.Vb(4,"app-form-field",22),ae.Qb(5,"app-slider",23),ae.Ub(),ae.Vb(6,"app-form-field",24),ae.Qb(7,"app-slider",25),ae.Ub(),ae.Ub(),ae.Vb(8,"app-panel",18),ae.Qb(9,"app-edit-particle-shape",19),ae.Ub(),ae.Sb()),2&e&&(ae.Db(3),ae.mc("min",0)("max",100)("step",1),ae.Db(2),ae.mc("min",0)("max",25)("step",1),ae.Db(2),ae.mc("min",0)("max",25)("step",1))}function Ls(e,t){1&e&&(ae.Tb(0),ae.Vb(1,"app-panel"),ae.Vb(2,"app-form-field",26),ae.Qb(3,"app-edit-particle-vector",27),ae.Ub(),ae.Vb(4,"app-form-field",22),ae.Qb(5,"app-slider",23),ae.Ub(),ae.Vb(6,"app-form-field",28),ae.Qb(7,"app-slider",29),ae.Ub(),ae.Vb(8,"app-form-field",24),ae.Qb(9,"app-slider",25),ae.Ub(),ae.Ub(),ae.Vb(10,"app-panel",18),ae.Qb(11,"app-edit-particle-shape",19),ae.Ub(),ae.Sb()),2&e&&(ae.Db(3),ae.mc("xmin",-10)("xmax",10)("ymin",-10)("ymax",10)("zmin",-10)("zmax",10),ae.Db(2),ae.mc("min",0)("max",25)("step",1),ae.Db(2),ae.mc("min",0)("max",25)("step",.5),ae.Db(2),ae.mc("min",0)("max",25)("step",1))}function Bs(e,t){1&e&&(ae.Tb(0),ae.Vb(1,"app-panel"),ae.Vb(2,"app-form-field",30),ae.Qb(3,"app-edit-particle-vector",31),ae.Ub(),ae.Vb(4,"app-form-field",22),ae.Qb(5,"app-slider",23),ae.Ub(),ae.Vb(6,"app-form-field",24),ae.Qb(7,"app-slider",25),ae.Ub(),ae.Ub(),ae.Vb(8,"app-panel",18),ae.Qb(9,"app-edit-particle-shape",19),ae.Ub(),ae.Sb()),2&e&&(ae.Db(3),ae.mc("xmin",-10)("xmax",10)("ymin",-10)("ymax",10)("zmin",-10)("zmax",10),ae.Db(2),ae.mc("min",-25)("max",25)("step",1),ae.Db(2),ae.mc("min",0)("max",25)("step",1))}function Qs(e,t){1&e&&(ae.Tb(0),ae.Vb(1,"app-panel"),ae.Vb(2,"app-form-field",32),ae.Qb(3,"app-slider",33),ae.Ub(),ae.Ub(),ae.Vb(4,"app-panel",18),ae.Qb(5,"app-edit-particle-shape",19),ae.Ub(),ae.Sb()),2&e&&(ae.Db(3),ae.mc("min",0)("max",1)("step",.01))}function $s(e,t){1&e&&(ae.Tb(0),ae.Vb(1,"app-panel"),ae.Vb(2,"app-form-field",30),ae.Qb(3,"app-edit-particle-vector",31),ae.Ub(),ae.Vb(4,"app-form-field",22),ae.Qb(5,"app-slider",23),ae.Ub(),ae.Vb(6,"app-form-field",34),ae.Qb(7,"app-slider",35),ae.Ub(),ae.Vb(8,"app-form-field",24),ae.Qb(9,"app-slider",25),ae.Ub(),ae.Ub(),ae.Vb(10,"app-panel",18),ae.Qb(11,"app-edit-particle-shape",19),ae.Ub(),ae.Sb()),2&e&&(ae.Db(3),ae.mc("xmin",-10)("xmax",10)("ymin",-10)("ymax",10)("zmin",-10)("zmax",10),ae.Db(2),ae.mc("min",-25)("max",25)("step",1),ae.Db(2),ae.mc("min",0)("max",10)("step",1),ae.Db(2),ae.mc("min",0)("max",25)("step",1))}function qs(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"app-portal-item",37),ae.cc("itemClick",(function(){return ae.Cc(e),ae.gc(2).handlePathNodesClicked()})),ae.Ub()}if(2&e){const e=t.$implicit;ae.mc("label","Path Nodes")("hint",(e.nodes?e.nodes.length:0)+" Path Nodes")}}function Gs(e,t){if(1&e&&(ae.Tb(0),ae.Nc(1,qs,1,2,"app-portal-item",36),ae.hc(2,"async"),ae.Vb(3,"app-panel",18),ae.Qb(4,"app-edit-particle-shape",19),ae.Ub(),ae.Sb()),2&e){const e=ae.gc();ae.Db(1),ae.mc("ngIf",ae.ic(2,1,e.particleUpdater$))}}function Hs(e,t){1&e&&(ae.Tb(0),ae.Vb(1,"app-panel"),ae.Vb(2,"app-form-field",30),ae.Qb(3,"app-edit-particle-vector",31),ae.Ub(),ae.Vb(4,"app-form-field",38),ae.Qb(5,"app-edit-particle-vector",39),ae.Ub(),ae.Vb(6,"app-form-field",22),ae.Qb(7,"app-slider",23),ae.Ub(),ae.Vb(8,"app-form-field",24),ae.Qb(9,"app-slider",25),ae.Ub(),ae.Ub(),ae.Vb(10,"app-panel",18),ae.Qb(11,"app-edit-particle-shape",19),ae.Ub(),ae.Sb()),2&e&&(ae.Db(3),ae.mc("xmin",-10)("xmax",10)("ymin",-10)("ymax",10)("zmin",-10)("zmax",10),ae.Db(2),ae.mc("xmin",-10)("xmax",10)("ymin",-10)("ymax",10)("zmin",-10)("zmax",10),ae.Db(2),ae.mc("min",-25)("max",25)("step",1),ae.Db(2),ae.mc("min",0)("max",25)("step",1))}let Ws=(()=>{class e{constructor(e,t,i,n,o){this.store=e,this.formBuilder=t,this.portalComponent=i,this.particleSystemsService=n,this.dialogService=o,this.particleUpdaterEnum=Za,this.updaterTypes=Object.values(Za),this.ngUnsubscribe=new c.a,this.formGroup=this.formBuilder.group({id:[""],type:[""],name:[""],position:[[0,0,0]],direction:[[0,0,0]],friction:0,frequency:0,forceAverage:0,radius:0,forceVariance:0,directionAverage:[[0,0,0]],directionVariance:0,shapeEnabled:[!1],shape:[sr]})}ngOnInit(){this.initFormListeners(),this.initUpdaterListeners()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initFormListeners(){this.formGroup.valueChanges.pipe(Object(pi.a)(125),Object(Dn.a)((e,t)=>Object(W.isEqual)(e,t)),Object(P.a)(this.ngUnsubscribe)).subscribe(()=>{const e=this.createUpdaterFromValues(this.formGroup.value);this.updateSystem(e)})}initUpdaterListeners(){this.particleUpdater$.pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.setValues(e)})}handleDuplicateClick(){const e=this.store.selectSnapshot(xo.a.getSelectedParticleSystem),t=this.store.selectSnapshot(xo.a.getSelectedParticleUpdater);this.particleSystemsService.duplicateUpdater(e,t)}handleResetClick(){const e=this.store.selectSnapshot(xo.a.getSelectedParticleSystem),t=this.store.selectSnapshot(xo.a.getSelectedParticleUpdaterIndex);this.particleSystemsService.resetUpdater(e,t)}handleRemoveClick(){const e=this.store.selectSnapshot(xo.a.getSelectedParticleSystem),t=this.store.selectSnapshot(xo.a.getSelectedParticleUpdaterIndex);this.particleSystemsService.removeUpdater(e,t),this.portalComponent.back()}handlePathNodesClicked(){this.portalComponent.loadComponent(Vs)}handleColorsClicked(){this.portalComponent.loadComponent(Rs)}setValues(e){if(this.formGroup){const t="shape"in e&&!Object(W.isNil)(e.shape);this.formGroup.patchValue(Object.assign(Object.assign({},e),{shapeEnabled:t}),{emitEvent:!1,onlySelf:!0})}}createUpdaterFromValues(e){const{type:t,shapeEnabled:i,shape:n}=e,o=this.store.selectSnapshot(xo.a.getSelectedParticleUpdater);return Cr(t,Object.assign(Object.assign(Object.assign({},o),e),{shape:i?n:void 0}))}updateSystem(e){const t=this.store.selectSnapshot(xo.a.getSelectedParticleSystem),i=this.store.selectSnapshot(xo.a.getSelectedParticleUpdaterIndex);t.updaters[i]=e,this.store.dispatch(new fo.a.UpdateParticleSystem(t.id,t))}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(r.h),ae.Pb(G.f),ae.Pb(Ka),ae.Pb(Ur),ae.Pb(yn.a))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-edit-particle-updater"]],decls:32,vars:15,consts:[["label","Updater"],["list-actions",""],["app-button","",3,"matMenuTriggerFor"],["icon","ellipsis-v"],["actionsMenu","matMenu"],["mat-menu-item","",3,"click"],[3,"formGroup"],["label","Name"],["type","text","formControlName","name",1,"input"],["label","ID"],[1,"text-11"],["label","Type"],["formControlName","type",1,"input"],[3,"value",4,"ngFor","ngForOf"],[3,"ngSwitch"],[4,"ngSwitchCase"],[3,"value"],[3,"label","itemClick"],["label","Shape","toggleType","checkbox","formControlName","shapeEnabled"],["formControlName","shape"],["label","Frequency"],["formControlName","frequency",3,"min","max","step"],["label","Force Average"],["formControlName","forceAverage",3,"min","max","step"],["label","Force Variance"],["formControlName","forceVariance",3,"min","max","step"],["label","Direction Average"],["formControlName","directionAverage",3,"xmin","xmax","ymin","ymax","zmin","zmax"],["label","Direction Variance"],["formControlName","directionVariance",3,"min","max","step"],["label","Position"],["formControlName","position",3,"xmin","xmax","ymin","ymax","zmin","zmax"],["label","friction"],["formControlName","friction",3,"min","max","step"],["label","Radius"],["formControlName","radius",3,"min","max","step"],[3,"label","hint","itemClick",4,"ngIf"],[3,"label","hint","itemClick"],["label","Direction"],["formControlName","direction",3,"xmin","xmax","ymin","ymax","zmin","zmax"]],template:function(e,t){if(1&e&&(ae.Vb(0,"app-portal-column",0),ae.Vb(1,"div",1),ae.Vb(2,"button",2),ae.Qb(3,"app-icon",3),ae.Ub(),ae.Vb(4,"mat-menu",null,4),ae.Vb(6,"button",5),ae.cc("click",(function(){return t.handleDuplicateClick()})),ae.Pc(7,"Duplicate"),ae.Ub(),ae.Vb(8,"button",5),ae.cc("click",(function(){return t.handleResetClick()})),ae.Pc(9,"Reset to default"),ae.Ub(),ae.Vb(10,"button",5),ae.cc("click",(function(){return t.handleRemoveClick()})),ae.Pc(11,"Remove"),ae.Ub(),ae.Ub(),ae.Ub(),ae.Vb(12,"div",6),ae.Vb(13,"app-panel"),ae.Vb(14,"app-form-field",7),ae.Qb(15,"input",8),ae.Ub(),ae.Vb(16,"app-form-field",9),ae.Vb(17,"span",10),ae.Pc(18),ae.hc(19,"async"),ae.Ub(),ae.Ub(),ae.Vb(20,"app-form-field",11),ae.Vb(21,"select",12),ae.Nc(22,Fs,3,4,"option",13),ae.Ub(),ae.Ub(),ae.Ub(),ae.Tb(23,14),ae.Nc(24,Is,4,1,"ng-container",15),ae.Nc(25,zs,10,9,"ng-container",15),ae.Nc(26,Ls,12,15,"ng-container",15),ae.Nc(27,Bs,10,12,"ng-container",15),ae.Nc(28,Qs,6,3,"ng-container",15),ae.Nc(29,$s,12,15,"ng-container",15),ae.Nc(30,Gs,5,3,"ng-container",15),ae.Nc(31,Hs,12,18,"ng-container",15),ae.Sb(),ae.Ub(),ae.Ub()),2&e){const e=ae.yc(5);let i=null;ae.Db(2),ae.mc("matMenuTriggerFor",e),ae.Db(10),ae.mc("formGroup",t.formGroup),ae.Db(6),ae.Qc(null==(i=ae.ic(19,13,t.particleUpdater$))?null:i.id),ae.Db(4),ae.mc("ngForOf",t.updaterTypes),ae.Db(1),ae.mc("ngSwitch",t.formGroup.get("type").value),ae.Db(1),ae.mc("ngSwitchCase",t.particleUpdaterEnum.AgeColorBlend),ae.Db(1),ae.mc("ngSwitchCase",t.particleUpdaterEnum.BrownianMotion),ae.Db(1),ae.mc("ngSwitchCase",t.particleUpdaterEnum.UniformForce),ae.Db(1),ae.mc("ngSwitchCase",t.particleUpdaterEnum.RadialForce),ae.Db(1),ae.mc("ngSwitchCase",t.particleUpdaterEnum.Friction),ae.Db(1),ae.mc("ngSwitchCase",t.particleUpdaterEnum.Gravity),ae.Db(1),ae.mc("ngSwitchCase",t.particleUpdaterEnum.Path),ae.Db(1),ae.mc("ngSwitchCase",t.particleUpdaterEnum.AxisForce)}},directives:[kr,pe.a,Sn.d,at.a,Sn.a,Sn.b,G.s,G.j,be.a,de.a,G.c,G.r,G.i,G.B,n.o,n.r,n.s,G.v,G.D,ts,xs,io.a,Vr,n.p],pipes:[n.b,Er],styles:[""],changeDetection:0}),function(e,t,i,n){var o,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,i,r):o(t,i))||r);a>3&&r&&Object.defineProperty(t,i,r)}([Object(r.e)(xo.a.getSelectedParticleUpdater),As("design:type",m.a)],e.prototype,"particleUpdater$",void 0),e})();var Ks=function(e,t,i,n){var o,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,i,r):o(t,i))||r);return a>3&&r&&Object.defineProperty(t,i,r),r},Js=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const Xs=function(){return[]};let Zs=(()=>{class e{constructor(e,t,i,n){this.store=e,this.dialogService=t,this.particleSystemsService=i,this.portalComponent=n,this.updaterTypes=Object.values(Za),this.ngUnsubscribe=new c.a}ngOnInit(){}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}selectClick(e){this.selectItem(e),e>-1&&this.portalComponent.loadComponent(Ws)}handleRemoveClick(e){this.delete(e)}handleDuplicateClick(e){const t=this.store.selectSnapshot(xo.a.getSelectedParticleSystem);this.particleSystemsService.duplicateUpdater(t,e)}handleAddClick(e){this.createNew(e)}handleResetClick(e){this.resetDefault(e)}handleResetAllClick(){this.resetDefaults()}handleRemoveAllClick(){this.deleteAll()}selectItem(e){this.store.dispatch(new fo.a.SelectParticleUpdater(e))}createNew(e){const t=this.store.selectSnapshot(xo.a.getSelectedParticleSystem);this.particleSystemsService.createNewUpdater(t,e)}resetDefault(e){const t=this.store.selectSnapshot(xo.a.getSelectedParticleSystem);this.particleSystemsService.resetUpdater(t,e)}resetDefaults(){const e=this.store.selectSnapshot(xo.a.getSelectedParticleSystem);this.particleSystemsService.resetUpdaters(e)}delete(e){const t=this.store.selectSnapshot(xo.a.getSelectedParticleSystem);t.updaters=t.updaters.filter((t,i)=>i!==e),this.store.dispatch(new fo.a.UpdateParticleSystem(t.id,t)),this.selectItem(-1)}deleteAll(){const e=this.store.selectSnapshot(xo.a.getSelectedParticleSystem);this.store.dispatch(new fo.a.UpdateParticleSystem(e.id,Object.assign(Object.assign({},e),{updaters:[]})))}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(r.h),ae.Pb(yn.a),ae.Pb(Ur),ae.Pb(Ka))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-edit-particle-updater-list"]],decls:2,vars:5,consts:[["label","Updaters","type","updater",3,"types","items","itemClick","addClick","removeClick","duplicateClick","resetClick","resetAllClick","removeAllClick"]],template:function(e,t){if(1&e&&(ae.Vb(0,"app-edit-particle-list",0),ae.cc("itemClick",(function(e){return t.selectClick(e)}))("addClick",(function(e){return t.handleAddClick(e)}))("removeClick",(function(e){return t.handleRemoveClick(e)}))("duplicateClick",(function(e){return t.handleDuplicateClick(e)}))("resetClick",(function(e){return t.handleResetClick(e)}))("resetAllClick",(function(){return t.handleResetAllClick()}))("removeAllClick",(function(){return t.handleRemoveAllClick()})),ae.hc(1,"async"),ae.Ub()),2&e){let e=null;ae.mc("types",t.updaterTypes)("items",(null==(e=ae.ic(1,2,t.particleSystem$))?null:e.updaters)||ae.oc(4,Xs))}},directives:[ss],pipes:[n.b],styles:[""],changeDetection:0}),Ks([Object(r.e)(xo.a.getSelectedParticleSystemId),Js("design:type",m.a)],e.prototype,"particleSystemId$",void 0),Ks([Object(r.e)(xo.a.getSelectedParticleSystem),Js("design:type",m.a)],e.prototype,"particleSystem$",void 0),e})();var Ys=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let ec=(()=>{class e{constructor(e,t){this.formBuilder=e,this.store=t,this.ngUnsubscribe=new c.a,this.initForm()}ngOnInit(){this.initFormListeners(),this.initParticleSystemListeners()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initForm(){this.form=this.formBuilder.group({numParticles:[0],pointSize:[0],emissionAverage:[0],emissionVariance:[0]}),this.setValues(hr())}initFormListeners(){this.form.valueChanges.pipe(Object(pi.a)(125),Object(Dn.a)((e,t)=>Object(W.isEqual)(e,t)),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.setParticleSystem(e)})}initParticleSystemListeners(){this.particleSystem$.pipe(Object(O.a)(e=>!Object(W.isNil)(e)),Object(Dn.a)((e,t)=>Object(W.isEqual)(e,t)),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.setValues(e)})}handleResetClick(){this.reset()}setParticleSystem(e){const t=this.store.selectSnapshot(xo.a.getSelectedParticleSystem),i=xr(Object.assign(Object.assign({},t),this.getParticleSystemFromForm(e)));this.store.dispatch(new fo.a.UpdateParticleSystem(i.id,i))}setValues(e){this.form&&this.form.patchValue(e,{emitEvent:!1,onlySelf:!0})}reset(){const e=this.store.selectSnapshot(xo.a.getSelectedParticleSystemId);this.setValues(Object.assign(Object.assign({},hr()),{id:e}))}getParticleSystemFromForm(e){const{numParticles:t,pointSize:i,emissionAverage:n,emissionVariance:o}=e;return{numParticles:t,pointSize:i,emissionAverage:n,emissionVariance:o}}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(G.f),ae.Pb(r.h))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-edit-particle-system-basic-form"]],decls:17,vars:11,consts:[[3,"label"],["list-actions",""],["app-button","",3,"matMenuTriggerFor"],["icon","ellipsis-v"],["actionsMenu","matMenu"],["mat-menu-item","",3,"click"],[3,"formGroup"],["label","Number of Particles"],["formControlName","numParticles",3,"min","max"],["label","Point Size"],["formControlName","pointSize",3,"min","max"],["label","Emission Average"],["formControlName","emissionAverage",3,"min","max"],["label","Emission Variance"],["formControlName","emissionVariance",3,"min","max"]],template:function(e,t){if(1&e&&(ae.Vb(0,"app-portal-column",0),ae.Vb(1,"div",1),ae.Vb(2,"button",2),ae.Qb(3,"app-icon",3),ae.Ub(),ae.Vb(4,"mat-menu",null,4),ae.Vb(6,"button",5),ae.cc("click",(function(){return t.handleResetClick()})),ae.Pc(7,"Reset to default"),ae.Ub(),ae.Ub(),ae.Ub(),ae.Vb(8,"app-panel",6),ae.Vb(9,"app-form-field",7),ae.Qb(10,"app-slider",8),ae.Ub(),ae.Vb(11,"app-form-field",9),ae.Qb(12,"app-slider",10),ae.Ub(),ae.Vb(13,"app-form-field",11),ae.Qb(14,"app-slider",12),ae.Ub(),ae.Vb(15,"app-form-field",13),ae.Qb(16,"app-slider",14),ae.Ub(),ae.Ub(),ae.Ub()),2&e){const e=ae.yc(5);ae.mc("label","Quantity"),ae.Db(2),ae.mc("matMenuTriggerFor",e),ae.Db(6),ae.mc("formGroup",t.form),ae.Db(2),ae.mc("min",0)("max",1e4),ae.Db(2),ae.mc("min",0)("max",100),ae.Db(2),ae.mc("min",0)("max",1e4),ae.Db(2),ae.mc("min",0)("max",1e4)}},directives:[kr,pe.a,Sn.d,at.a,Sn.a,Sn.b,be.a,G.s,G.j,de.a,io.a,G.r,G.i],styles:[""],changeDetection:0}),function(e,t,i,n){var o,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,i,r):o(t,i))||r);a>3&&r&&Object.defineProperty(t,i,r)}([Object(r.e)(xo.a.getSelectedParticleSystem),Ys("design:type",m.a)],e.prototype,"particleSystem$",void 0),e})();var tc=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let ic=(()=>{class e{constructor(e,t){this.formBuilder=e,this.store=t,this.ngUnsubscribe=new c.a,this.initForm()}ngOnInit(){this.initFormListeners(),this.initParticleSystemListeners()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initForm(){const{baseColor:e,alpha:t}=cr,{r:i,g:n,b:o}=e;this.form=this.formBuilder.group({material:this.formBuilder.group({enabled:[!1],color:[[i,n,o,t]]})}),this.setValues(hr())}initFormListeners(){this.form.valueChanges.pipe(Object(pi.a)(125),Object(Dn.a)((e,t)=>Object(W.isEqual)(e,t)),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.setParticleSystem(e)})}initParticleSystemListeners(){this.particleSystem$.pipe(Object(O.a)(e=>!Object(W.isNil)(e)),Object(Dn.a)((e,t)=>Object(W.isEqual)(e,t)),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.setValues(e)})}handleResetClick(){this.reset()}setParticleSystem(e){const t=this.store.selectSnapshot(xo.a.getSelectedParticleSystem),i=xr(Object.assign(Object.assign({},t),this.getParticleSystemFromForm(e)));this.store.dispatch(new fo.a.UpdateParticleSystem(i.id,i))}setValues(e){if(this.form){const t=Object.assign(Object.assign({},e),{material:{enabled:!1}});if(e.material){const{baseColor:i}=e.material;let{alpha:n}=e.material;"number"!=typeof n&&(n=cr.alpha);const{r:o,g:a,b:r}=i;t.material={enabled:!0,color:[o,a,r,n]}}this.form.patchValue(t,{emitEvent:!1,onlySelf:!0})}}reset(){const e=this.store.selectSnapshot(xo.a.getSelectedParticleSystemId);this.setValues(Object.assign(Object.assign({},hr()),{id:e}))}getParticleSystemFromForm(e){const{material:t}=e,{enabled:i,color:n}=t,[o,a,r,s]=n;return{material:i?{baseColor:{r:o,g:a,b:r},alpha:s}:void 0}}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(G.f),ae.Pb(r.h))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-edit-particle-system-material-form"]],decls:11,vars:5,consts:[[3,"label","formGroup"],["list-actions",""],["app-button","",3,"matMenuTriggerFor"],["icon","ellipsis-v"],["actionsMenu","matMenu"],["mat-menu-item","",3,"click"],["formGroupName","material"],["label","Enabled","toggleType","checkbox","formControlName","enabled"],["type","rgba","formControlName","color",3,"decimal","alpha"]],template:function(e,t){if(1&e&&(ae.Vb(0,"app-portal-column",0),ae.Vb(1,"div",1),ae.Vb(2,"button",2),ae.Qb(3,"app-icon",3),ae.Ub(),ae.Vb(4,"mat-menu",null,4),ae.Vb(6,"button",5),ae.cc("click",(function(){return t.handleResetClick()})),ae.Pc(7,"Reset to default"),ae.Ub(),ae.Ub(),ae.Ub(),ae.Tb(8,6),ae.Vb(9,"app-panel",7),ae.Qb(10,"app-color-picker-input",8),ae.Ub(),ae.Sb(),ae.Ub()),2&e){const e=ae.yc(5);ae.mc("label","Material")("formGroup",t.form),ae.Db(2),ae.mc("matMenuTriggerFor",e),ae.Db(8),ae.mc("decimal",!0)("alpha",!0)}},directives:[kr,G.s,G.j,pe.a,Sn.d,at.a,Sn.a,Sn.b,G.k,be.a,G.r,G.i,mt],styles:[""],changeDetection:0}),function(e,t,i,n){var o,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,i,r):o(t,i))||r);a>3&&r&&Object.defineProperty(t,i,r)}([Object(r.e)(xo.a.getSelectedParticleSystem),tc("design:type",m.a)],e.prototype,"particleSystem$",void 0),e})();var nc=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function oc(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"app-portal-item",15),ae.cc("itemClick",(function(t){return ae.Cc(e),ae.gc().loadCreators(t)})),ae.Ub()}if(2&e){const e=t.$implicit,i=ae.gc();ae.mc("label","Creators ("+e.length+")")("hint",i.formatHint(e))}}function ac(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"app-portal-item",15),ae.cc("itemClick",(function(t){return ae.Cc(e),ae.gc().loadUpdaters(t)})),ae.Ub()}if(2&e){const e=t.$implicit,i=ae.gc();ae.mc("label","Updaters ("+e.length+")")("hint",i.formatHint(e))}}function rc(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"app-portal-item",15),ae.cc("itemClick",(function(t){return ae.Cc(e),ae.gc().loadConstraints(t)})),ae.Ub()}if(2&e){const e=t.$implicit,i=ae.gc();ae.mc("label","Constraints ("+e.length+")")("hint",i.formatHint(e))}}const sc=function(){return[]};let cc=(()=>{class e{constructor(e,t,i,n,o,a,r){this.formBuilder=e,this.store=t,this.actions=i,this.dialogService=n,this.particleSystemsService=o,this.eumPrintPipe=a,this.portalComponent=r,this.ngUnsubscribe=new c.a,this.initForm()}ngOnInit(){this.initFormListeners(),this.initParticleSystemListeners()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initForm(){this.form=this.formBuilder.group({name:[""]}),this.setValues(hr())}initFormListeners(){this.form.valueChanges.pipe(Object(pi.a)(125),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{const t=this.store.selectSnapshot(xo.a.getSelectedParticleSystem);e.name!==t.name&&(t.name=e.name,this.store.dispatch(new fo.a.UpdateParticleSystem(t.id,t)))})}initParticleSystemListeners(){this.particleSystem$.pipe(Object(O.a)(e=>!Object(W.isNil)(e)),Object(Dn.a)((e,t)=>Object(W.isEqual)(e,t)),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.setValues(e)}),this.actions.pipe(Object(r.l)(fo.a.DuplicateParticleSystemSuccess),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.store.dispatch(new fo.a.SelectParticleSystem(e.id))})}setValues(e){this.form&&this.form.patchValue(e,{emitEvent:!1,onlySelf:!0})}handleDuplicateClick(){this.duplicateParticleSystem()}handleResetClick(){const e=this.store.selectSnapshot(xo.a.getSelectedParticleSystem);this.dialogService.openConfirmDialog({data:{titleText:"Reset Particle System",bodyText:`Would you like to reset Particle System "${e.id}"?`,confirmText:"Remove"}}).afterClosed().pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{e&&this.resetParticleSystem()})}handleRemoveClick(){const e=this.store.selectSnapshot(xo.a.getSelectedParticleSystem);this.dialogService.openConfirmDialog({data:{titleText:"Remove Particle System",bodyText:`Would you like to remove Particle System "${e.id}" from this chapter?`,confirmText:"Remove"}}).afterClosed().pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{e&&this.removeParticleSystem()})}formatHint(e){return e.map(e=>this.eumPrintPipe.transform(e.type)).join(", ")}loadBasic(e){e.loadComponent(ec)}loadMaterial(e){e.loadComponent(ic)}loadSprites(e){e.loadComponent(_r)}loadProperties(e){e.loadComponent(us)}loadCreators(e){e.loadComponent(ds)}loadConstraints(e){e.loadComponent(Ss)}loadUpdaters(e){e.loadComponent(Zs)}duplicateParticleSystem(){const e=this.store.selectSnapshot(xo.a.getSelectedParticleSystemId),t=this.store.selectSnapshot(F.a.getSelectedChapterId);this.particleSystemsService.duplicateParticleSystem(e,t)}resetParticleSystem(){const e=this.store.selectSnapshot(xo.a.getSelectedParticleSystemId);this.particleSystemsService.resetParticleSystem(e)}removeParticleSystem(){const e=this.store.selectSnapshot(xo.a.getSelectedParticleSystemId),t=this.store.selectSnapshot(F.a.getSelectedChapterId);this.particleSystemsService.removeChapterParticleSystem(e,t),this.store.dispatch(new fo.a.SelectParticleSystem(null)),this.portalComponent.back()}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(G.f),ae.Pb(r.h),ae.Pb(r.b),ae.Pb(yn.a),ae.Pb(Ur),ae.Pb(Er),ae.Pb(Ka))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-edit-particle-systems-form"]],features:[ae.Cb([Er])],decls:30,vars:17,consts:[["list-actions",""],["app-button","",3,"matMenuTriggerFor"],["icon","ellipsis-v"],["actionsMenu","matMenu"],["mat-menu-item","",3,"click"],[3,"formGroup"],["label","Name"],["type","text","formControlName","name",1,"input"],["label","ID"],[1,"text-11"],["label","Quantity",3,"itemClick"],["label","Material",3,"itemClick"],["label","Sprites",3,"itemClick"],["label","Properties",3,"itemClick"],[3,"label","hint","itemClick",4,"ngIf"],[3,"label","hint","itemClick"]],template:function(e,t){if(1&e&&(ae.Vb(0,"app-portal-column"),ae.Vb(1,"div",0),ae.Vb(2,"button",1),ae.Qb(3,"app-icon",2),ae.Ub(),ae.Vb(4,"mat-menu",null,3),ae.Vb(6,"button",4),ae.cc("click",(function(){return t.handleDuplicateClick()})),ae.Pc(7,"Duplicate"),ae.Ub(),ae.Vb(8,"button",4),ae.cc("click",(function(){return t.handleResetClick()})),ae.Pc(9,"Reset to default"),ae.Ub(),ae.Vb(10,"button",4),ae.cc("click",(function(){return t.handleRemoveClick()})),ae.Pc(11,"Remove"),ae.Ub(),ae.Ub(),ae.Ub(),ae.Tb(12),ae.Vb(13,"app-panel",5),ae.Vb(14,"app-form-field",6),ae.Qb(15,"input",7),ae.Ub(),ae.Vb(16,"app-form-field",8),ae.Vb(17,"span",9),ae.Pc(18),ae.hc(19,"async"),ae.Ub(),ae.Ub(),ae.Ub(),ae.Vb(20,"app-portal-item",10),ae.cc("itemClick",(function(e){return t.loadBasic(e)})),ae.Ub(),ae.Vb(21,"app-portal-item",11),ae.cc("itemClick",(function(e){return t.loadMaterial(e)})),ae.Ub(),ae.Vb(22,"app-portal-item",12),ae.cc("itemClick",(function(e){return t.loadSprites(e)})),ae.Ub(),ae.Vb(23,"app-portal-item",13),ae.cc("itemClick",(function(e){return t.loadProperties(e)})),ae.Ub(),ae.Nc(24,oc,1,2,"app-portal-item",14),ae.hc(25,"async"),ae.Nc(26,ac,1,2,"app-portal-item",14),ae.hc(27,"async"),ae.Nc(28,rc,1,2,"app-portal-item",14),ae.hc(29,"async"),ae.Sb(),ae.Ub()),2&e){const e=ae.yc(5);let i=null,n=null,o=null,a=null;ae.Db(2),ae.mc("matMenuTriggerFor",e),ae.Db(11),ae.mc("formGroup",t.form),ae.Db(5),ae.Qc(null==(i=ae.ic(19,6,t.particleSystem$))?null:i.id),ae.Db(6),ae.mc("ngIf",(null==(n=ae.ic(25,8,t.particleSystem$))?null:n.creators)||ae.oc(14,sc)),ae.Db(2),ae.mc("ngIf",(null==(o=ae.ic(27,10,t.particleSystem$))?null:o.updaters)||ae.oc(15,sc)),ae.Db(2),ae.mc("ngIf",(null==(a=ae.ic(29,12,t.particleSystem$))?null:a.constraints)||ae.oc(16,sc))}},directives:[kr,pe.a,Sn.d,at.a,Sn.a,Sn.b,be.a,G.s,G.j,de.a,G.c,G.r,G.i,ts,n.p],pipes:[n.b],styles:[""],changeDetection:0}),function(e,t,i,n){var o,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,i,r):o(t,i))||r);a>3&&r&&Object.defineProperty(t,i,r)}([Object(r.e)(xo.a.getSelectedParticleSystem),nc("design:type",m.a)],e.prototype,"particleSystem$",void 0),e})();var lc=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function pc(e,t){if(1&e&&(ae.Vb(0,"button",19),ae.Pc(1," Apply Existing "),ae.Ub()),2&e){ae.gc();const e=ae.yc(26);ae.mc("matMenuTriggerFor",e)}}function dc(e,t){if(1&e&&(ae.Vb(0,"button",19),ae.Pc(1," Duplicate Existing "),ae.Ub()),2&e){ae.gc();const e=ae.yc(29);ae.mc("matMenuTriggerFor",e)}}function uc(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"button",5),ae.cc("click",(function(){return ae.Cc(e),ae.gc().handleRemoveAllAssignClick()})),ae.Pc(1," Remove All "),ae.Ub()}}function hc(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"app-portal-item",21),ae.cc("click",(function(){ae.Cc(e);const i=t.$implicit;return ae.gc(2).handleParticleSystemClick(i)})),ae.Vb(1,"div",22),ae.Vb(2,"button",23),ae.cc("click",(function(){ae.Cc(e);const i=t.$implicit;return ae.gc(2).handleToggleParticleSystemVisible(i)})),ae.Qb(3,"app-icon",24),ae.Ub(),ae.Vb(4,"button",25),ae.Qb(5,"app-icon",3),ae.Ub(),ae.Vb(6,"mat-menu",null,26),ae.Vb(8,"button",5),ae.cc("click",(function(){ae.Cc(e);const i=t.$implicit;return ae.gc(2).handleDuplicateSystemClick(i)})),ae.Pc(9,"Duplicate"),ae.Ub(),ae.Vb(10,"button",5),ae.cc("click",(function(){ae.Cc(e);const i=t.$implicit;return ae.gc(2).handleResetParticleClick(i)})),ae.Pc(11,"Reset"),ae.Ub(),ae.Vb(12,"button",5),ae.cc("click",(function(){ae.Cc(e);const i=t.$implicit;return ae.gc(2).handleRemoveAssignClick(i)})),ae.Pc(13,"Remove"),ae.Ub(),ae.Ub(),ae.Ub(),ae.Ub()}if(2&e){const e=t.$implicit,i=ae.yc(7),n=ae.gc(2);ae.mc("label",n.getSystemLabel(e))("active",n.isSystemVisible(e)),ae.Db(3),ae.mc("icon",n.isSystemVisible(e)?"eye":"eye-slash"),ae.Db(1),ae.mc("matMenuTriggerFor",i)}}function mc(e,t){if(1&e&&(ae.Tb(0),ae.Nc(1,hc,14,4,"app-portal-item",20),ae.Sb()),2&e){const e=ae.gc();ae.Db(1),ae.mc("ngForOf",e.assignedParticleSystem)}}function bc(e,t){1&e&&(ae.Vb(0,"div",27),ae.Pc(1," There are no particle systems in this chapter. "),ae.Ub())}function gc(e,t){if(1&e&&(ae.Vb(0,"button",19),ae.Pc(1," Apply Existing "),ae.Ub()),2&e){ae.gc();const e=ae.yc(26);ae.mc("matMenuTriggerFor",e)}}function fc(e,t){if(1&e&&(ae.Vb(0,"button",19),ae.Pc(1," Duplicate Existing "),ae.Ub()),2&e){ae.gc();const e=ae.yc(29);ae.mc("matMenuTriggerFor",e)}}function xc(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"button",5),ae.cc("click",(function(){ae.Cc(e);const i=t.$implicit;return ae.gc().handleApplyParticleClick(i)})),ae.Pc(1),ae.Ub()}if(2&e){const e=t.$implicit;ae.Db(1),ae.Rc(" ",e.id," ")}}function yc(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"button",5),ae.cc("click",(function(){ae.Cc(e);const i=t.$implicit;return ae.gc().handleDuplicacteParticleClick(i)})),ae.Pc(1),ae.Ub()}if(2&e){const e=t.$implicit;ae.Db(1),ae.Rc(" ",e.id," ")}}let vc=(()=>{class e{constructor(e,t,i,n,o,a){this.store=e,this.actions=t,this.changeRef=i,this.particleSystemsService=n,this.dialogService=o,this.portalComponent=a,this.particleSystems=[],this.assignedParticleSystem=[],this.unassignedParticleSystem=[],this.particleSystemSelected=new ae.p,this.chapterParticles=[],this.ngUnsubscribe=new c.a}ngOnInit(){this.initParticleListListeners()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initParticleListListeners(){const e=this.store.select(xo.a.getParticleSystemsList),t=this.store.select(F.a.getSelectedChapterId),i=this.store.select(xo.a.getAssignedParticleSystems);Object(d.b)(e,i,t).pipe(Object(O.a)(([e,t,i])=>!!i),Object(P.a)(this.ngUnsubscribe)).subscribe(([e,t,i])=>{const n=t[i]||[];this.particleSystems=e,this.assignedParticleSystem=n.map(t=>e.find(e=>e.id===t)),this.unassignedParticleSystem=e.filter(e=>!n.includes(e.id)),this.changeRef.markForCheck()}),this.actions.pipe(Object(r.l)(fo.a.UnassignParticle),Object(P.a)(this.ngUnsubscribe)).subscribe(()=>{const e=this.store.selectSnapshot(xo.a.getParticleSystems),t=this.store.selectSnapshot(xo.a.getAssignedParticleSystems),i=Object.keys(e),n=Object.values(t).reduce((e,t)=>e.concat(t),[]),o=i.filter(e=>!n.includes(e));o.length>0&&(o.forEach(e=>{this.store.dispatch(new fo.a.DeleteParticleSystem(e))}),this.changeRef.markForCheck())})}handleParticleSystemClick(e){this.particleSystemSelected.emit(e),this.store.dispatch(new fo.a.SelectParticleSystem(e.id)),this.portalComponent.loadComponent(cc)}handleDuplicateSystemClick(e){this.duplicateParticleSystem(e)}handleRemoveAllAssignClick(){this.dialogService.openConfirmDialog({data:{titleText:"Remove Particle Systems",bodyText:"Would you like to remove all Particle Systems from this chapter?",confirmText:"Remove All"}}).afterClosed().pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{e&&this.removeAllParticleAssignments()})}handleRemoveAssignClick(e){this.dialogService.openConfirmDialog({data:{titleText:"Remove Particle System",bodyText:`Would you like to remove Particle System "${e.id}" from this chapter?`,confirmText:"Remove"}}).afterClosed().pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(t=>{t&&this.removeChapterParticleSystem(e.id)})}handleCreateParticleClick(){this.createParticleSystem()}handleApplyParticleClick(e){this.addChapterParticleSystem(e.id)}handleDuplicacteParticleClick(e){this.duplicateParticleSystem(e)}handleResetParticleClick(e){this.dialogService.openConfirmDialog({data:{titleText:"Reset Particle System",bodyText:`Would you like to reset Particle System "${e.id}"?`,confirmText:"Reset"}}).afterClosed().pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(t=>{t&&this.resetParticleSystem(e)})}handleToggleParticleSystemVisible(e){this.toggleParticleSystemVisible(e)}isSystemVisible(e){const t=this.store.selectSnapshot(F.a.getSelectedChapterId);return this.particleSystemsService.isParticleSystemVisible(e.id,t)}getSystemLabel(e){let t;return t=e.name?`**${e.name}**\n\n${e.id}`:e.id,t}createParticleSystem(){const e=this.store.selectSnapshot(F.a.getSelectedChapterId);this.particleSystemsService.createParticleSystem(e)}resetParticleSystem(e){this.particleSystemsService.resetParticleSystem(e.id)}removeAllParticleAssignments(){const e=this.store.selectSnapshot(F.a.getSelectedChapterId);this.particleSystemsService.removeAllChapterParticleSystem(e)}addChapterParticleSystem(e){const t=this.store.selectSnapshot(F.a.getSelectedChapterId);this.particleSystemsService.addChapterParticleSystem(e,t)}removeChapterParticleSystem(e){const t=this.store.selectSnapshot(F.a.getSelectedChapterId);this.particleSystemsService.removeChapterParticleSystem(e,t)}duplicateParticleSystem(e){const t=this.store.selectSnapshot(F.a.getSelectedChapterId);this.particleSystemsService.duplicateParticleSystem(e.id,t)}toggleParticleSystemVisible(e){const t=this.store.selectSnapshot(F.a.getSelectedChapterId);this.particleSystemsService.toggleParticleSystemVisible(e.id,t)}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(r.h),ae.Pb(r.b),ae.Pb(ae.i),ae.Pb(Ur),ae.Pb(yn.a),ae.Pb(Ka))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-edit-particle-systems-list"]],outputs:{particleSystemSelected:"particleSystemSelected"},decls:32,vars:13,consts:[["label","Particle Systems"],["list-actions",""],["app-button","",3,"matMenuTriggerFor"],["icon","ellipsis-v"],["particleListSystemsMenu","matMenu"],["mat-menu-item","",3,"click"],["mat-menu-item","",3,"matMenuTriggerFor",4,"ngIf"],["mat-menu-item","",3,"click",4,"ngIf"],[1,"list"],[1,"list__content"],[4,"ngIf"],[1,"flex","flex-column","items-center","mv-2"],["class","list__message text-12 text-center mv-4",4,"ngIf"],["app-button","","buttonType","outline",3,"matMenuTriggerFor"],["icon","angle-down"],["particleCreateSystemsMenu","matMenu"],["applySystemsMenu","matMenu"],["mat-menu-item","",3,"click",4,"ngFor","ngForOf"],["duplicateSystemsMenu","matMenu"],["mat-menu-item","",3,"matMenuTriggerFor"],[3,"label","active","click",4,"ngFor","ngForOf"],[3,"label","active","click"],["item-actions",""],["app-button","","buttonSize","xsmall",3,"click"],[3,"icon"],["app-button","","buttonSize","xsmall",3,"matMenuTriggerFor"],["systemActions","matMenu"],[1,"list__message","text-12","text-center","mv-4"]],template:function(e,t){if(1&e&&(ae.Vb(0,"app-portal-column",0),ae.Vb(1,"div",1),ae.Vb(2,"button",2),ae.Qb(3,"app-icon",3),ae.Ub(),ae.Vb(4,"mat-menu",null,4),ae.Vb(6,"button",5),ae.cc("click",(function(){return t.handleCreateParticleClick()})),ae.Pc(7,"Create new"),ae.Ub(),ae.Nc(8,pc,2,1,"button",6),ae.Nc(9,dc,2,1,"button",6),ae.Nc(10,uc,2,0,"button",7),ae.Ub(),ae.Ub(),ae.Vb(11,"div",8),ae.Vb(12,"div",9),ae.Nc(13,mc,2,1,"ng-container",10),ae.Vb(14,"div",11),ae.Nc(15,bc,2,0,"div",12),ae.Vb(16,"button",13),ae.Pc(17," Add Particle System "),ae.Qb(18,"app-icon",14),ae.Ub(),ae.Vb(19,"mat-menu",null,15),ae.Vb(21,"button",5),ae.cc("click",(function(){return t.handleCreateParticleClick()})),ae.Pc(22,"Create new"),ae.Ub(),ae.Nc(23,gc,2,1,"button",6),ae.Nc(24,fc,2,1,"button",6),ae.Ub(),ae.Ub(),ae.Vb(25,"mat-menu",null,16),ae.Nc(27,xc,2,1,"button",17),ae.Ub(),ae.Vb(28,"mat-menu",null,18),ae.Nc(30,yc,2,1,"button",17),ae.hc(31,"async"),ae.Ub(),ae.Ub(),ae.Ub(),ae.Ub()),2&e){const e=ae.yc(5),i=ae.yc(20);ae.Db(2),ae.mc("matMenuTriggerFor",e),ae.Db(6),ae.mc("ngIf",t.unassignedParticleSystem.length),ae.Db(1),ae.mc("ngIf",t.particleSystems.length),ae.Db(1),ae.mc("ngIf",t.assignedParticleSystem.length>0),ae.Db(3),ae.mc("ngIf",t.assignedParticleSystem.length>0),ae.Db(2),ae.mc("ngIf",0===t.assignedParticleSystem.length),ae.Db(1),ae.mc("matMenuTriggerFor",i),ae.Db(7),ae.mc("ngIf",t.unassignedParticleSystem.length),ae.Db(1),ae.mc("ngIf",t.particleSystems.length),ae.Db(3),ae.mc("ngForOf",t.unassignedParticleSystem),ae.Db(3),ae.mc("ngForOf",ae.ic(31,11,t.particleSystems$))}},directives:[kr,pe.a,Sn.d,at.a,Sn.a,Sn.b,n.p,n.o,ts],pipes:[n.b],styles:[".list[_ngcontent-%COMP%]{height:100%}.list__content[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column}.list__message[_ngcontent-%COMP%]{color:#61779e}"],changeDetection:0}),function(e,t,i,n){var o,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,i,r):o(t,i))||r);a>3&&r&&Object.defineProperty(t,i,r)}([Object(r.e)(xo.a.getParticleSystemsList),lc("design:type",m.a)],e.prototype,"particleSystems$",void 0),e})();class Cc{}function Pc(e,t){1&e&&(ae.Vb(0,"mat-checkbox",6),ae.Pc(1,"Moving Forwards"),ae.Ub())}function Oc(e,t){1&e&&(ae.Vb(0,"mat-checkbox",7),ae.Pc(1,"Moving Backwards"),ae.Ub())}function wc(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"button",18),ae.cc("click",(function(){ae.Cc(e);const t=ae.gc(2);return t.handleShowClick(t.transition)})),ae.Pc(1," Preview "),ae.Ub()}}function kc(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"button",18),ae.cc("click",(function(){return ae.Cc(e),ae.gc(2).handleRemovePositionClick()})),ae.Pc(1," Remove "),ae.Ub()}}function Sc(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"div"),ae.Vb(1,"app-form-field",8),ae.Qb(2,"app-color-picker-input",9),ae.Ub(),ae.Vb(3,"app-form-field",10),ae.Vb(4,"div",11),ae.Qb(5,"input",12),ae.Vb(6,"app-button-group"),ae.Vb(7,"button",13),ae.cc("click",(function(){return ae.Cc(e),ae.gc().handleSecondClick(1)})),ae.Pc(8," 1s "),ae.Ub(),ae.Vb(9,"button",13),ae.cc("click",(function(){return ae.Cc(e),ae.gc().handleSecondClick(2)})),ae.Pc(10," 2s "),ae.Ub(),ae.Vb(11,"button",13),ae.cc("click",(function(){return ae.Cc(e),ae.gc().handleSecondClick(3)})),ae.Pc(12," 3s "),ae.Ub(),ae.Ub(),ae.Ub(),ae.Ub(),ae.Vb(13,"app-form-field",14),ae.Vb(14,"button",15),ae.cc("click",(function(){return ae.Cc(e),ae.gc().handleRecordPositionClick()})),ae.Pc(15," Capture Position "),ae.Ub(),ae.Vb(16,"app-button-group",16),ae.Nc(17,wc,2,0,"button",17),ae.Nc(18,kc,2,0,"button",17),ae.Ub(),ae.Ub(),ae.Ub()}if(2&e){const e=ae.gc();ae.Db(7),ae.mc("uppercase",!1),ae.Db(2),ae.mc("uppercase",!1),ae.Db(2),ae.mc("uppercase",!1),ae.Db(6),ae.mc("ngIf",e.transition.camera),ae.Db(1),ae.mc("ngIf",e.transition.camera)}}let _c=(()=>{class e{constructor(e,t,i,n,o){this.formBuilder=e,this.store=t,this.cameraService=i,this.matSnackBar=n,this.changeDetectorRef=o,this._transition=new Cc,this.transitionChange=new ae.p,this._settings={onNext:!0,onPrevious:!0},this.ngUnsubscribe=new c.a;const a=new Cc;this.form=this.formBuilder.group({fadeColor:"",duration:0,onNext:a.onNext,onPrevious:a.onPrevious})}get transition(){return this._transition}set transition(e){Object(W.isEqual)(e,this._transition)||(this._transition=Object.assign({},e),this.setFormValues(e),this.transitionChange.emit(this.transition),this.changeDetectorRef.markForCheck())}get settings(){return this._settings}set settings(e){Object(W.isEqual)(e,this._settings)||(this._settings=Object.assign(Object.assign({},this._settings),e),this.changeDetectorRef.markForCheck())}ngOnInit(){this.form.valueChanges.pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(e=>this.handleFormChanges(e))}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}handleShowClick(e){this.store.dispatch(new I.l(e.camera,!0,e.duration))}handleRecordPositionClick(){this.transition=Object.assign(Object.assign({},this.transition),{camera:this.cameraService.getCamera()}),this.matSnackBar.open("Position captured")}handleRemovePositionClick(){this.transition=Object.assign(Object.assign({},this.transition),{camera:null}),this.matSnackBar.open("Position removed")}handleFormChanges(e){const t=Object.assign(Object.assign({},this.transition),{fadeColor:e.fadeColor,onNext:e.onNext,onPrevious:e.onPrevious,duration:e.duration});this.transition=t}handleSecondClick(e){this.form.patchValue({duration:e})}setFormValues(e){const t=Object.assign({duration:2,fadeColor:"",onNext:!1,onPrevious:!1},e);this.form.setValue({fadeColor:t.fadeColor,duration:t.duration,onNext:t.onNext,onPrevious:t.onPrevious})}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(G.f),ae.Pb(r.h),ae.Pb(fn.a),ae.Pb(le.b),ae.Pb(ae.i))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-edit-transition-form"]],inputs:{transition:"transition",settings:"settings"},outputs:{transitionChange:"transitionChange"},decls:6,vars:4,consts:[["autocomplete","off",3,"formGroup"],["label","Enable"],[1,"text-12","flex","flex-column"],["formControlName","onNext",4,"ngIf"],["formControlName","onPrevious",4,"ngIf"],[4,"ngIf"],["formControlName","onNext"],["formControlName","onPrevious"],["label","Fade"],["formControlName","fadeColor"],["label","Duration (Seconds)"],[1,"flex"],["type","number","min","0","step",".1","formControlName","duration","required","",1,"input","w-25","mr-2"],["app-button","","buttonType","outline",3,"uppercase","click"],["label","Position"],["app-button","","buttonType","outline","buttonSize","small",1,"w-100","mb-2",3,"click"],["render","block"],["app-button","","buttonType","outline","buttonSize","small","class","w-100",3,"click",4,"ngIf"],["app-button","","buttonType","outline","buttonSize","small",1,"w-100",3,"click"]],template:function(e,t){1&e&&(ae.Vb(0,"form",0),ae.Vb(1,"app-form-field",1),ae.Vb(2,"div",2),ae.Nc(3,Pc,2,0,"mat-checkbox",3),ae.Nc(4,Oc,2,0,"mat-checkbox",4),ae.Ub(),ae.Ub(),ae.Nc(5,Sc,19,5,"div",5),ae.Ub()),2&e&&(ae.mc("formGroup",t.form),ae.Db(3),ae.mc("ngIf",t.settings.onNext),ae.Db(1),ae.mc("ngIf",t.settings.onPrevious),ae.Db(1),ae.mc("ngIf",t.settings.onNext&&t.transition.onNext||t.settings.onPrevious&&t.transition.onPrevious))},directives:[G.E,G.s,G.j,de.a,n.p,ge.a,G.r,G.i,mt,G.w,G.c,G.A,Oo,pe.a],styles:[""],changeDetection:0}),e})();var Mc=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const Uc=function(){return{onNext:!0,onPrevious:!1}},Tc=function(){return{onNext:!1,onPrevious:!0}};function Vc(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"app-tabs",2),ae.Vb(1,"app-tab",3),ae.Vb(2,"div",4),ae.Vb(3,"app-edit-transition-form",5),ae.cc("transitionChange",(function(t){return ae.Cc(e),ae.gc().handleTransitionChange(t,"post")})),ae.Ub(),ae.Ub(),ae.Ub(),ae.Vb(4,"app-tab",6),ae.Vb(5,"div",4),ae.Vb(6,"app-edit-transition-form",5),ae.cc("transitionChange",(function(t){return ae.Cc(e),ae.gc().handleTransitionChange(t,"pre")})),ae.Ub(),ae.Ub(),ae.Ub(),ae.Ub()}if(2&e){const e=ae.gc();ae.Db(3),ae.mc("settings",ae.oc(4,Uc))("transition",e.postTransition),ae.Db(3),ae.mc("settings",ae.oc(5,Tc))("transition",e.preTransition)}}let Dc=(()=>{class e{constructor(e,t){this.changeDetectorRef=e,this.store=t,this.ngUnsubscribe=new c.a}ngOnInit(){this.chapter$.pipe(Object(O.a)(e=>null!=e),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.postTransition=Object(W.get)(e,"transitions.post")||new Cc,this.preTransition=Object(W.get)(e,"transitions.pre")||new Cc,this.changeDetectorRef.markForCheck()})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}handleTransitionChange(e,t){const i=this.store.selectSnapshot(F.a.getSelectedChapter);this.store.dispatch(new A.E(i.id,e,t))}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(ae.i),ae.Pb(r.h))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-edit-transition"]],decls:4,vars:3,consts:[["label","Transitions"],["tabSize","small","tabTheme","dark",4,"ngIf"],["tabSize","small","tabTheme","dark"],["label","Post-Chapter"],[1,"pt-1"],[3,"settings","transition","transitionChange"],["label","Pre-Chapter"]],template:function(e,t){1&e&&(ae.Vb(0,"app-portal-column",0),ae.Vb(1,"app-panel"),ae.Nc(2,Vc,7,6,"app-tabs",1),ae.hc(3,"async"),ae.Ub(),ae.Ub()),2&e&&(ae.Db(2),ae.mc("ngIf",ae.ic(3,1,t.chapter$)))},directives:[kr,be.a,n.p,Yn.a,eo.a,_c],pipes:[n.b],styles:[""],changeDetection:0}),function(e,t,i,n){var o,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,i,r):o(t,i))||r);a>3&&r&&Object.defineProperty(t,i,r)}([Object(r.e)(F.a.getSelectedChapter),Mc("design:type",m.a)],e.prototype,"chapter$",void 0),e})();var Ec=function(e){return e.Alpha="alpha",e.ImprovedAlpha="improvedAlpha",e.AddAlpha="addAlpha",e.AlphaToCoverage="alphaToCoverage",e.WeightedOIT="weightedOIT",e}({});let jc=(()=>{class e{constructor(e,t){this.formBuilder=e,this.store=t,this.transparencyModes=Ec,this.ngUnsubscribe=new c.a,this.form=this.formBuilder.group({mode:[Ec.Alpha]})}ngOnInit(){this.store.select(F.a.getSelectedChapterId).pipe(Object(C.a)(()=>this.store.selectSnapshot(F.a.getSelectedChapter)),Object(O.a)(e=>!Object(W.isNil)(e)),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.setFormValue(e.transparencyMode)}),this.form.valueChanges.pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.setTransparencyMode(e.mode)})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}setFormValue(e){this.form.setValue({mode:e},{emitEvent:!1})}setTransparencyMode(e,t=!0){this.store.dispatch(new D.O(e)),t&&this.setChapterTransparencyMode(e)}setChapterTransparencyMode(e){const t=this.store.selectSnapshot(F.a.getSelectedChapter);this.store.dispatch(new A.F(t.id,e))}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(G.f),ae.Pb(r.h))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-edit-transparency-mode"]],decls:14,vars:7,consts:[["label","Transparency Mode"],[3,"open"],[3,"formGroup"],["formControlName","mode",1,"input"],[3,"ngValue"]],template:function(e,t){1&e&&(ae.Vb(0,"app-portal-column",0),ae.Vb(1,"app-panel",1),ae.Vb(2,"form",2),ae.Vb(3,"select",3),ae.Vb(4,"option",4),ae.Pc(5,"Alpha (Default)"),ae.Ub(),ae.Vb(6,"option",4),ae.Pc(7,"Improved Alpha"),ae.Ub(),ae.Vb(8,"option",4),ae.Pc(9,"Add Alpha"),ae.Ub(),ae.Vb(10,"option",4),ae.Pc(11,"Alpha To Coverage"),ae.Ub(),ae.Vb(12,"option",4),ae.Pc(13,"Weighted OIT"),ae.Ub(),ae.Ub(),ae.Ub(),ae.Ub(),ae.Ub()),2&e&&(ae.Db(1),ae.mc("open",!0),ae.Db(1),ae.mc("formGroup",t.form),ae.Db(2),ae.mc("ngValue",t.transparencyModes.Alpha),ae.Db(2),ae.mc("ngValue",t.transparencyModes.ImprovedAlpha),ae.Db(2),ae.mc("ngValue",t.transparencyModes.AddAlpha),ae.Db(2),ae.mc("ngValue",t.transparencyModes.AlphaToCoverage),ae.Db(2),ae.mc("ngValue",t.transparencyModes.WeightedOIT))},directives:[kr,be.a,G.E,G.s,G.j,G.B,G.r,G.i,G.v,G.D],styles:[""],changeDetection:0}),e})();var Nc=i("ZriC");const Rc={[Nc.a.SSAO]:{effect:Nc.a.SSAO,sampleRadius:1.2,intensity:50,bias:.1,scale:.3,cutoff:0},[Nc.a.Blur]:{effect:Nc.a.Blur,blur:.1},[Nc.a.RadialBlur]:{effect:Nc.a.RadialBlur,radius:.1,center:[0,0],blur:.25},[Nc.a.DOF]:{effect:Nc.a.DOF,focusStart:0,focusEnd:5,blur:.5},[Nc.a.FXAA]:{effect:Nc.a.FXAA},[Nc.a.GroundShadow]:{effect:Nc.a.GroundShadow,blur:.5,opacity:1,xPos:0,yPos:0,zPos:0,size:10}};function Ac(e,t){const i=Rc[e],n=Object.keys(i).reduce((e,i)=>{const n=t[i];return void 0!==n&&(e[i]=n),e},{});return Object.assign(Object.assign({effect:e},i),n)}var Fc=function(e){return e[e.FOG_LINEAR=1]="FOG_LINEAR",e[e.FOG_EXP=2]="FOG_EXP",e[e.FOG_EXP2=3]="FOG_EXP2",e}({});const Ic={"fog.enabled":!1,"fog.density":1,"fog.color":[.96,.96,.96],"fog.start":0,"fog.end":50,"fog.mode":Fc.FOG_LINEAR,"fog.min":0,"fog.max":.75},zc=Z.a.rgbToHex(Ic["fog.color"],!0);let Lc=(()=>{class e{constructor(e,t){this.formBuilder=e,this.store=t,this.fogModes=Fc,this.ngUnsubscribe=new c.a,this._defaultChapterEffects=[],this._defaultChapterProperties={},this.form=this.formBuilder.group({saoEnabled:!1,blurEnabled:!1,radialBlurEnabled:!1,dofEnabled:!1,fogEnabled:!1,groundShadowEnabled:!1,sao:this.formBuilder.group(Object.assign({},Rc.sao)),blur:this.formBuilder.group(Object.assign({},Rc.blur)),radialBlur:this.formBuilder.group(Object.assign(Object.assign({},Rc.radialBlur),{center:this.formBuilder.array([...Rc.radialBlur.center])})),dof:this.formBuilder.group(Object.assign({},Rc.dof)),fog:this.formBuilder.group(Object.assign(Object.assign({},Ic),{"fog.color":zc})),groundShadow:this.formBuilder.group(Object.assign({},Rc.groundShadow))})}ngOnInit(){this.initEvents()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initEvents(){this.store.select(F.a.getSelectedChapterId).pipe(Object(C.a)(()=>this.store.selectSnapshot(F.a.getSelectedChapter)),Object(O.a)(e=>!Object(W.isNil)(e)),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this._defaultChapterEffects=(e.customData||{postprocess:[]}).postprocess||[],this._defaultChapterProperties=e.properties||{},this.setFormValues(this._defaultChapterEffects,this._defaultChapterProperties)}),this.form.valueChanges.pipe(Object(pi.a)(100),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.handleFormChanges(e)})}handleFormChanges(e){const t=this.getEffectFormValues(e),i=this.getFogEffectFormValues(e);this.applyEffects(t,i)}setFormValues(e,t){this.clearEffectsForm(),e.forEach(e=>{this.setEffectFormValues(e,!0)}),this.setFogEffectFormValues(t)}setEffectFormValues(e,t){const i=e.effect;this.form.patchValue({[i+"Enabled"]:t,[i]:e},{emitEvent:!1})}clearEffectsForm(){Object.values(Rc).forEach(e=>{this.setEffectFormValues(e,!1)}),this.setFogEffectFormValues(Object.assign(Object.assign({},Ic),{"fog.enabled":!1}))}getEffectFormValues(e){const t=[],{saoEnabled:i,blurEnabled:n,radialBlurEnabled:o,dofEnabled:a,groundShadowEnabled:r}=e,{sao:s,blur:c,radialBlur:l,dof:p,groundShadow:d}=e;return i&&t.push(Ac(Nc.a.SSAO,s)),n&&t.push(Ac(Nc.a.Blur,c)),o&&t.push(Ac(Nc.a.RadialBlur,l)),a&&t.push(Ac(Nc.a.DOF,p)),r&&t.push(Ac(Nc.a.GroundShadow,d)),t.length>0&&t.push(Rc.fxaa),t}setFogEffectFormValues(e){const t=this.createFogEffect(e),i=t["fog.enabled"],n=Z.a.rgbToHex(t["fog.color"],!0);this.form.patchValue({fogEnabled:i,fog:Object.assign(Object.assign({},t),{"fog.color":n})},{emitEvent:!1})}getFogEffectFormValues(e){const{fogEnabled:t,fog:i}=e;return Object.assign(Object.assign({},this.createFogEffect(i)),{"fog.enabled":t})}applyEffects(e,t){const i=Object.assign({},t);this.store.dispatch(new D.K(e)),this.store.dispatch(new D.L(i));const n=this.store.selectSnapshot(F.a.getSelectedChapter);this.store.dispatch(new A.B(n.id,e,i))}createFogEffect(e){const t=Object.entries(Ic).reduce((t,[i,n])=>{const o=e[i];return Object(W.isNil)(o)||(t[i]=o),t},Object.assign({},Ic)),i=e["fog.color"];return Object(W.isNil)(i)||"string"!=typeof i||(t["fog.color"]=Z.a.hexToRgb(i,!0)),t}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(G.f),ae.Pb(r.h))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-edit-post-processing"]],decls:64,vars:73,consts:[["label","PostProcessing",3,"formGroup"],["label","Ambient Occlusion","toggleType","checkbox","formControlName","saoEnabled","formGroupName","sao"],["label","Sample Radius"],["formControlName","sampleRadius",3,"min","max","step"],["label","Intensity"],["formControlName","intensity",3,"min","max","step"],["label","Bias"],["formControlName","bias",3,"min","max","step"],["label","Scale"],["formControlName","scale",3,"min","max","step"],["label","Cutoff"],["formControlName","cutoff",3,"min","max","step"],["label","Blur","toggleType","checkbox","formControlName","blurEnabled","formGroupName","blur"],["label","Blur"],["formControlName","blur",3,"min","max","step"],["label","Radial Blur","toggleType","checkbox","formControlName","radialBlurEnabled","formGroupName","radialBlur"],["label","Radius"],["formControlName","radius",3,"min","max","step"],["formArrayName","center"],["label","Center X"],["formControlName","0",3,"min","max","step"],["label","Center Y"],["formControlName","1",3,"min","max","step"],["label","Depth of Field","toggleType","checkbox","formControlName","dofEnabled","formGroupName","dof"],["label","Focus Start"],["formControlName","focusStart",3,"min","max","step"],["label","Focus End"],["formControlName","focusEnd",3,"min","max","step"],["label","Fog","toggleType","checkbox","formControlName","fogEnabled","formGroupName","fog","dataTestAttributeVal","fogPanel"],["label","Mode"],["formControlName","fog.mode",1,"input"],[3,"ngValue"],["label","Color"],["formControlName","fog.color","dataTestAttributeVal","fogColor"],["label","Density"],["formControlName","fog.density",3,"min","max","step"],["label","Start"],["formControlName","fog.start",3,"min","max","step"],["label","End"],["formControlName","fog.end",3,"min","max","step"],["label","Min"],["formControlName","fog.min",3,"min","max","step"],["label","Max"],["formControlName","fog.max",3,"min","max","step"],["label","Ground Shadow","toggleType","checkbox","formControlName","groundShadowEnabled","formGroupName","groundShadow"],["label","Blur Intensity"],["label","X Position"],["formControlName","xPos",3,"min","max","step"],["label","Y Position"],["formControlName","yPos",3,"min","max","step"],["label","Z Position"],["formControlName","zPos",3,"min","max","step"],["label","Size"],["formControlName","size",3,"min","max","step"]],template:function(e,t){1&e&&(ae.Vb(0,"app-portal-column",0),ae.Vb(1,"app-panel",1),ae.Vb(2,"app-form-field",2),ae.Qb(3,"app-slider",3),ae.Ub(),ae.Vb(4,"app-form-field",4),ae.Qb(5,"app-slider",5),ae.Ub(),ae.Vb(6,"app-form-field",6),ae.Qb(7,"app-slider",7),ae.Ub(),ae.Vb(8,"app-form-field",8),ae.Qb(9,"app-slider",9),ae.Ub(),ae.Vb(10,"app-form-field",10),ae.Qb(11,"app-slider",11),ae.Ub(),ae.Ub(),ae.Vb(12,"app-panel",12),ae.Vb(13,"app-form-field",13),ae.Qb(14,"app-slider",14),ae.Ub(),ae.Ub(),ae.Vb(15,"app-panel",15),ae.Vb(16,"app-form-field",16),ae.Qb(17,"app-slider",17),ae.Ub(),ae.Vb(18,"div",18),ae.Vb(19,"app-form-field",19),ae.Qb(20,"app-slider",20),ae.Ub(),ae.Vb(21,"app-form-field",21),ae.Qb(22,"app-slider",22),ae.Ub(),ae.Ub(),ae.Vb(23,"app-form-field",13),ae.Qb(24,"app-slider",14),ae.Ub(),ae.Ub(),ae.Vb(25,"app-panel",23),ae.Vb(26,"app-form-field",24),ae.Qb(27,"app-slider",25),ae.Ub(),ae.Vb(28,"app-form-field",26),ae.Qb(29,"app-slider",27),ae.Ub(),ae.Vb(30,"app-form-field",13),ae.Qb(31,"app-slider",14),ae.Ub(),ae.Ub(),ae.Vb(32,"app-panel",28),ae.Vb(33,"app-form-field",29),ae.Vb(34,"select",30),ae.Vb(35,"option",31),ae.Pc(36,"Linear"),ae.Ub(),ae.Vb(37,"option",31),ae.Pc(38,"Exponential (v1)"),ae.Ub(),ae.Vb(39,"option",31),ae.Pc(40,"Exponential (v2)"),ae.Ub(),ae.Ub(),ae.Ub(),ae.Vb(41,"app-form-field",32),ae.Qb(42,"app-color-picker-input",33),ae.Ub(),ae.Vb(43,"app-form-field",34),ae.Qb(44,"app-slider",35),ae.Ub(),ae.Vb(45,"app-form-field",36),ae.Qb(46,"app-slider",37),ae.Ub(),ae.Vb(47,"app-form-field",38),ae.Qb(48,"app-slider",39),ae.Ub(),ae.Vb(49,"app-form-field",40),ae.Qb(50,"app-slider",41),ae.Ub(),ae.Vb(51,"app-form-field",42),ae.Qb(52,"app-slider",43),ae.Ub(),ae.Ub(),ae.Vb(53,"app-panel",44),ae.Vb(54,"app-form-field",45),ae.Qb(55,"app-slider",14),ae.Ub(),ae.Vb(56,"app-form-field",46),ae.Qb(57,"app-slider",47),ae.Ub(),ae.Vb(58,"app-form-field",48),ae.Qb(59,"app-slider",49),ae.Ub(),ae.Vb(60,"app-form-field",50),ae.Qb(61,"app-slider",51),ae.Ub(),ae.Vb(62,"app-form-field",52),ae.Qb(63,"app-slider",53),ae.Ub(),ae.Ub(),ae.Ub()),2&e&&(ae.mc("formGroup",t.form),ae.Db(3),ae.mc("min",0)("max",2)("step",.01),ae.Db(2),ae.mc("min",0)("max",100)("step",1),ae.Db(2),ae.mc("min",0)("max",1)("step",.01),ae.Db(2),ae.mc("min",0)("max",2)("step",.01),ae.Db(2),ae.mc("min",0)("max",1)("step",.01),ae.Db(3),ae.mc("min",0)("max",.25)("step",.01),ae.Db(3),ae.mc("min",0)("max",2)("step",.1),ae.Db(3),ae.mc("min",-1)("max",1)("step",.1),ae.Db(2),ae.mc("min",-1)("max",1)("step",.1),ae.Db(2),ae.mc("min",0)("max",1)("step",.01),ae.Db(3),ae.mc("min",0)("max",100)("step",1),ae.Db(2),ae.mc("min",0)("max",100)("step",1),ae.Db(2),ae.mc("min",0)("max",1)("step",.01),ae.Db(4),ae.mc("ngValue",t.fogModes.FOG_LINEAR),ae.Db(2),ae.mc("ngValue",t.fogModes.FOG_EXP),ae.Db(2),ae.mc("ngValue",t.fogModes.FOG_EXP2),ae.Db(5),ae.mc("min",0)("max",1)("step",.01),ae.Db(2),ae.mc("min",0)("max",100)("step",1),ae.Db(2),ae.mc("min",0)("max",100)("step",1),ae.Db(2),ae.mc("min",0)("max",1)("step",.01),ae.Db(2),ae.mc("min",0)("max",1)("step",.01),ae.Db(3),ae.mc("min",0)("max",1)("step",.1),ae.Db(2),ae.mc("min",-200)("max",200)("step",.1),ae.Db(2),ae.mc("min",-200)("max",200)("step",.1),ae.Db(2),ae.mc("min",-200)("max",200)("step",.1),ae.Db(2),ae.mc("min",0)("max",20)("step",.01))},directives:[kr,G.s,G.j,be.a,G.r,G.i,G.k,de.a,io.a,G.e,G.B,G.v,G.D,mt],styles:[""],changeDetection:0}),e})();var Bc=i("quSY"),Qc=i("SJ0+"),$c=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function qc(e,t){if(1&e){const e=ae.Wb();ae.Tb(0),ae.Vb(1,"app-panel",3),ae.Vb(2,"app-form-field",4),ae.Vb(3,"app-slider",5),ae.cc("mouseUp",(function(){return ae.Cc(e),ae.gc().handleEndInteraction()}))("blurred",(function(){return ae.Cc(e),ae.gc().handleEndInteraction()})),ae.Ub(),ae.Ub(),ae.Vb(4,"app-form-field",6),ae.Vb(5,"app-slider",7),ae.cc("mouseUp",(function(){return ae.Cc(e),ae.gc().handleEndInteraction()}))("blurred",(function(){return ae.Cc(e),ae.gc().handleEndInteraction()})),ae.Ub(),ae.Ub(),ae.Ub(),ae.Sb()}if(2&e){const e=t.$implicit;ae.Db(1),ae.nc("label",e.label),ae.nc("formGroupName",e.formGroupName),ae.Db(2),ae.mc("min",0)("max",1)("step",.01),ae.Db(2),ae.mc("min",0)("max",5)("step",.01)}}let Gc=(()=>{class e{constructor(e,t,i){this.formBuilder=e,this.store=t,this.changeDetectorRef=i,this.ngUnsubscribe=new c.a,this.editorOpen=!1,this.clipDirections=[{label:"Left",formGroupName:"left"},{label:"Right",formGroupName:"right"},{label:"Top",formGroupName:"top"},{label:"Bottom",formGroupName:"bottom"},{label:"Front",formGroupName:"front"},{label:"Back",formGroupName:"back"}],this.formChangeSubscription=new Bc.a}ngOnInit(){this.initForm(),this.formChangeSubscription=this.getFormChangeSubscription(),this.store.select(F.a.getSelectedChapterClippingPlanes).pipe(Object(O.a)(e=>!Object(W.isNil)(e)),Object(_.a)(),Object(O.a)(([e,t])=>JSON.stringify(e)!==JSON.stringify(t)),Object(fe.a)(50),Object(P.a)(this.ngUnsubscribe)).subscribe(([e,t])=>{this.form.setValue(this.buildFormValues(t)),this.changeDetectorRef.markForCheck()})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initForm(){const e=this.store.selectSnapshot(F.a.getSelectedChapterClippingPlanes),t=this.buildFormValues(e),i={};Object.entries(t.clippingPlanes).map(([e,t])=>{i[e]=this.formBuilder.group(t)}),this.form=this.formBuilder.group({clippingPlanesEnabled:t.clippingPlanesEnabled,clippingPlanes:this.formBuilder.group(i)})}handleEndInteraction(){this.handleFormChangeEvent(this.form.value,!0)}getFormChangeSubscription(){return this.form.valueChanges.pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{const t=this.store.selectSnapshot(F.a.getSelectedChapterClippingPlanes);this.handleFormChangeEvent(e,t.enabled!==e.clippingPlanesEnabled)})}handleFormChangeEvent(e,t){const i=this.store.selectSnapshot(F.a.getSelectedChapterId),n=this.buildClipsPayload(e);this.store.dispatch(new A.u(i,n,e.clippingPlanesEnabled,t))}buildFormValues(e){return{clippingPlanesEnabled:e.enabled,clippingPlanes:Object.entries(e.clips).reduce((e,[t,i])=>(e[t]={progress:i.progress,fadeDistance:i.fadeDistance},e),{})}}buildClipsPayload(e){return Object.entries(e.clippingPlanes).reduce((t,[i,n])=>(t[i]=Object.assign(Object.assign({},n),{clipId:Qc.b[i],enabled:e.clippingPlanesEnabled&&n.progress>0,fade:e.clippingPlanesEnabled&&n.fadeDistance>0}),t),{})}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(G.f),ae.Pb(r.h),ae.Pb(ae.i))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-edit-clipping-planes"]],decls:3,vars:2,consts:[["label","Clipping Planes",3,"formGroup"],["label","Enabled","toggleType","checkbox","formControlName","clippingPlanesEnabled","formGroupName","clippingPlanes"],[4,"ngFor","ngForOf"],["toggleType","none",3,"label","formGroupName"],["label","Progress"],["formControlName","progress",3,"min","max","step","mouseUp","blurred"],["label","Fade Distance"],["formControlName","fadeDistance",3,"min","max","step","mouseUp","blurred"]],template:function(e,t){1&e&&(ae.Vb(0,"app-portal-column",0),ae.Vb(1,"app-panel",1),ae.Nc(2,qc,6,8,"ng-container",2),ae.Ub(),ae.Ub()),2&e&&(ae.mc("formGroup",t.form),ae.Db(2),ae.mc("ngForOf",t.clipDirections))},directives:[kr,G.s,G.j,be.a,G.r,G.i,G.k,n.o,de.a,io.a],styles:[""],changeDetection:0}),function(e,t,i,n){var o,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,i,r):o(t,i))||r);a>3&&r&&Object.defineProperty(t,i,r)}([Object(r.e)(F.a.getSelectedChapterClippingPlanes),$c("design:type",m.a)],e.prototype,"clippingPlanes$",void 0),e})();var Hc=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Wc(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"button",7),ae.cc("click",(function(){ae.Cc(e);const i=t.$implicit;return ae.gc().handleResetClick([i])})),ae.Pc(1),ae.Ub()}if(2&e){const e=t.$implicit,i=ae.gc();ae.Db(1),ae.Rc(" ",i.propertyLabels[e]," ")}}function Kc(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"button",7),ae.cc("click",(function(){ae.Cc(e);const i=t.$implicit;return ae.gc().handleApplyAllClick([i])})),ae.Pc(1),ae.Ub()}if(2&e){const e=t.$implicit,i=ae.gc();ae.Db(1),ae.Rc(" ",i.propertyLabels[e]," ")}}function Jc(e,t){if(1&e&&(ae.Vb(0,"app-list-item"),ae.Vb(1,"div",19),ae.Pc(2),ae.Ub(),ae.Vb(3,"div",20),ae.Pc(4),ae.hc(5,"json"),ae.Ub(),ae.Ub()),2&e){const e=t.$implicit;ae.Db(2),ae.Qc(e.key),ae.Db(2),ae.Qc(ae.ic(5,2,e.value))}}const Xc={"camera.optics.fov":"Field of View","camera.zoomLimits":"Zoom Limits","camera.zoomLimits.min":"Zoom Limits (Min)","camera.zoomLimits.max":"Zoom Limits (Max)"};let Zc=(()=>{class e{constructor(e,t,i,n){this.store=e,this.formBuilder=t,this.engineService=i,this.changeRef=n,this.propertyLabels=Xc,this.ngUnsubscribe=new c.a,this.defaultProperties=this.engineService.getDefaultProperties(),this.form=this.formBuilder.group({properties:this.formBuilder.group({"camera.optics.fov":[null],"camera.zoomLimits":this.formBuilder.group({max:[null],min:[null]})})});const o=this.form.get("properties");this.cameraProperties=Object.keys(o.controls),this.form.patchValue({properties:Object.assign({},this.defaultProperties)})}ngOnInit(){this.initFormListeners(),this.initChapterListeners()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initFormListeners(){this.form.valueChanges.pipe(Object(pi.a)(125),Object(P.a)(this.ngUnsubscribe)).subscribe(({properties:e})=>{const t=this.store.selectSnapshot(F.a.getSelectedChapterId);this.engineService.setProperties(e);const i=this.getMinimumProperties(e,this.defaultProperties);this.store.dispatch(new A.C([t],i))})}initChapterListeners(){this.selectedChapter$.pipe(Object(O.a)(e=>!Object(W.isNil)(e)),Object(Dn.a)((e,t)=>Object(W.isEqual)(e.properties,t.properties)),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{var t;const i=null!==(t=e.properties)&&void 0!==t?t:{},n=Object.keys(this.form.value.properties);this.extraProperties=Object(W.pickBy)(i,(e,t)=>!n.includes(t)),this.form.patchValue({properties:i},{emitEvent:!1}),this.changeRef.markForCheck()})}handleEndInteraction(){}handleResetClick(e){const t=this.store.selectSnapshot(F.a.getSelectedChapterId),i=this.getPropertiesBySource(e,this.defaultProperties);this.form.patchValue({properties:i}),this.store.dispatch(new A.k([t],e))}handleApplyAllClick(e){var t;const i=null!==(t=this.store.selectSnapshot(F.a.getSelectedChapter).properties)&&void 0!==t?t:{},n=this.getPropertiesBySource(e,i),o=this.store.selectSnapshot(F.a.getStoryChapters).map(e=>e.id);this.store.dispatch(new A.C(o,n))}getMinimumProperties(e,t){return Object.entries(e).reduce((e,[i,n])=>{const o=t[i];return Object(W.isEqual)(n,o)||(e[i]=n),e},{})}getPropertiesBySource(e,t){return e.reduce((e,i)=>((null==t?void 0:t[i])&&(e[i]=t[i]),e),{})}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(r.h),ae.Pb(G.f),ae.Pb(ce.a),ae.Pb(ae.i))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-edit-chapter-properties"]],decls:32,vars:21,consts:[["label","Properties",3,"formGroup"],["list-actions",""],["app-button","",3,"matMenuTriggerFor"],["icon","ellipsis-v"],["propActionsMenu","matMenu"],["mat-menu-item","",3,"matMenuTriggerFor"],["resetMenu","matMenu"],["mat-menu-item","",3,"click"],["mat-menu-item","",3,"click",4,"ngFor","ngForOf"],["applyMenu","matMenu"],["label","Camera Properties","formGroupName","properties"],[3,"label"],["formControlName","camera.optics.fov",3,"min","max","step","mouseUp","blurred"],["formGroupName","camera.zoomLimits"],["formControlName","min",3,"min","max","step","mouseUp","blurred"],["formControlName","max",3,"min","max","step","mouseUp","blurred"],["label","Additional Properties"],["listType","flat",1,"text-12"],[4,"ngFor","ngForOf"],[1,"text-semibold"],[1,"text-light"]],template:function(e,t){if(1&e&&(ae.Vb(0,"app-portal-column",0),ae.Vb(1,"div",1),ae.Vb(2,"button",2),ae.Qb(3,"app-icon",3),ae.Ub(),ae.Vb(4,"mat-menu",null,4),ae.Vb(6,"button",5),ae.Pc(7,"Reset Defaults"),ae.Ub(),ae.Vb(8,"button",5),ae.Pc(9,"Apply to all chapters"),ae.Ub(),ae.Ub(),ae.Vb(10,"mat-menu",null,6),ae.Vb(12,"button",7),ae.cc("click",(function(){return t.handleResetClick(t.cameraProperties)})),ae.Pc(13," All Camera Properties "),ae.Ub(),ae.Nc(14,Wc,2,1,"button",8),ae.Ub(),ae.Vb(15,"mat-menu",null,9),ae.Vb(17,"button",7),ae.cc("click",(function(){return t.handleApplyAllClick(t.cameraProperties)})),ae.Pc(18," All Camera Properties "),ae.Ub(),ae.Nc(19,Kc,2,1,"button",8),ae.Ub(),ae.Ub(),ae.Vb(20,"app-panel",10),ae.Vb(21,"app-form-field",11),ae.Vb(22,"app-slider",12),ae.cc("mouseUp",(function(){return t.handleEndInteraction()}))("blurred",(function(){return t.handleEndInteraction()})),ae.Ub(),ae.Ub(),ae.Tb(23,13),ae.Vb(24,"app-form-field",11),ae.Vb(25,"app-slider",14),ae.cc("mouseUp",(function(){return t.handleEndInteraction()}))("blurred",(function(){return t.handleEndInteraction()})),ae.Ub(),ae.Ub(),ae.Vb(26,"app-form-field",11),ae.Vb(27,"app-slider",15),ae.cc("mouseUp",(function(){return t.handleEndInteraction()}))("blurred",(function(){return t.handleEndInteraction()})),ae.Ub(),ae.Ub(),ae.Sb(),ae.Ub(),ae.Vb(28,"app-panel",16),ae.Vb(29,"app-list",17),ae.Nc(30,Jc,6,4,"app-list-item",18),ae.hc(31,"keyvalue"),ae.Ub(),ae.Ub(),ae.Ub()),2&e){const e=ae.yc(5),i=ae.yc(11),n=ae.yc(16);ae.mc("formGroup",t.form),ae.Db(2),ae.mc("matMenuTriggerFor",e),ae.Db(4),ae.mc("matMenuTriggerFor",i),ae.Db(2),ae.mc("matMenuTriggerFor",n),ae.Db(6),ae.mc("ngForOf",t.cameraProperties),ae.Db(5),ae.mc("ngForOf",t.cameraProperties),ae.Db(2),ae.mc("label",t.propertyLabels["camera.optics.fov"]),ae.Db(1),ae.mc("min",20)("max",75)("step",5),ae.Db(2),ae.mc("label",t.propertyLabels["camera.zoomLimits.min"]),ae.Db(1),ae.mc("min",5)("max",10)("step",.25),ae.Db(1),ae.mc("label",t.propertyLabels["camera.zoomLimits.max"]),ae.Db(1),ae.mc("min",10)("max",350)("step",10),ae.Db(3),ae.mc("ngForOf",ae.ic(31,19,t.extraProperties))}},directives:[kr,G.s,G.j,pe.a,Sn.d,at.a,Sn.a,Sn.b,n.o,be.a,G.k,de.a,io.a,G.r,G.i,gt.a,ft.a],pipes:[n.i,n.h],styles:[""],changeDetection:0}),function(e,t,i,n){var o,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,i,r):o(t,i))||r);a>3&&r&&Object.defineProperty(t,i,r)}([Object(r.e)(F.a.getSelectedChapter),Hc("design:type",m.a)],e.prototype,"selectedChapter$",void 0),e})();var Yc=function(e,t,i,n){var o,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,i,r):o(t,i))||r);return a>3&&r&&Object.defineProperty(t,i,r),r},el=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function tl(e,t){if(1&e){const e=ae.Wb();ae.Tb(0),ae.Vb(1,"app-portal",null,2),ae.Vb(3,"app-portal-item",3),ae.cc("itemClick",(function(t){return ae.Cc(e),ae.gc().handleTransitionClick(t)})),ae.hc(4,"async"),ae.Ub(),ae.Vb(5,"app-portal-item",4),ae.cc("itemClick",(function(t){return ae.Cc(e),ae.gc().handleTransparencyClick(t)})),ae.hc(6,"prettyPrint"),ae.hc(7,"async"),ae.Ub(),ae.Vb(8,"app-portal-item",5),ae.cc("itemClick",(function(t){return ae.Cc(e),ae.gc().handleEffectsClick(t)})),ae.hc(9,"async"),ae.Ub(),ae.Vb(10,"app-portal-item",6),ae.cc("itemClick",(function(t){return ae.Cc(e),ae.gc().handleClippingPlanesClick(t)})),ae.hc(11,"async"),ae.Ub(),ae.Vb(12,"app-portal-item",7),ae.cc("itemClick",(function(t){return ae.Cc(e),ae.gc().handleParticlesClick(t)})),ae.Ub(),ae.Vb(13,"app-portal-item",8),ae.cc("itemClick",(function(t){return ae.Cc(e),ae.gc().handlePropertiesClick(t)})),ae.hc(14,"async"),ae.Ub(),ae.Ub(),ae.Sb()}if(2&e){const e=ae.gc();let t=null;ae.Db(3),ae.mc("hint",e.getTransitionsHint(ae.ic(4,6,e.selectedChapter$))),ae.Db(2),ae.mc("hint",ae.ic(6,8,null==(t=ae.ic(7,10,e.selectedChapter$))?null:t.transparencyMode)),ae.Db(3),ae.mc("hint",e.getLookEffectsHint(ae.ic(9,12,e.selectedChapter$))),ae.Db(2),ae.mc("hint",e.getClippingPlanesHint(ae.ic(11,14,e.clippingPlanes$))),ae.Db(2),ae.mc("hint",e.getParticlesHint(e.chapterParticleSystems)),ae.Db(1),ae.mc("hint",e.getPropertiesHint(ae.ic(14,16,e.selectedChapter$)))}}function il(e,t){1&e&&(ae.Vb(0,"app-column",9),ae.Vb(1,"app-column-group"),ae.Tb(2,10),ae.Tb(3),ae.Vb(4,"div",11),ae.Qb(5,"img",12),ae.Pc(6," Welcome to Human Studio! "),ae.Qb(7,"br"),ae.Pc(8,"Select a tool to get started. "),ae.Ub(),ae.Sb(),ae.Sb(),ae.Ub(),ae.Ub()),2&e&&ae.mc("showHeader",!1)}let nl=(()=>{class e{constructor(e,t){this.store=e,this.enumPrintPipe=t,this.application=ne.a,this.ngUnsubscribe=new c.a}get chapterParticleSystems(){const e=this.store.selectSnapshot(F.a.getSelectedChapterId);return this.store.selectSnapshot(xo.a.particleSystemsForChapter(e))}ngOnInit(){}ngAfterViewInit(){this.initContentRefresh()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initContentRefresh(){const e=this.portals.first;e&&this.selectedChapterId$.pipe(Object(Dn.a)(),Object(P.a)(this.ngUnsubscribe)).subscribe(()=>{e.exit()})}handleTransitionClick(e){e.loadComponent(Dc)}handleTransparencyClick(e){e.loadComponent(jc)}handleEffectsClick(e){e.loadComponent(Lc)}handleClippingPlanesClick(e){e.loadComponent(Gc)}handleParticlesClick(e){e.loadComponent(vc)}handlePropertiesClick(e){e.loadComponent(Zc)}getTransitionsHint(e){const t=Object(W.get)(e,"transitions.post"),i=[];return Object(W.get)(e,"transitions.pre")&&i.push("Pre Transition"),t&&i.push("Post Transition"),this.formatHint(i)}getLookEffectsHint(e){const t=Object(W.get)(e,"customData.postprocess",[]),i=Object(W.get)(e,"properties",{}),n=t.map(e=>e.effect);return!0===i["fog.enabled"]&&n.push("fog"),this.formatHint(n)}getClippingPlanesHint(e){return this.formatHint(Object.keys((e||{clips:{}}).clips))}getParticlesHint(e){return this.formatHint(e.map(e=>e.id))}getPropertiesHint(e){var t;const i=null!==(t=null==e?void 0:e.properties)&&void 0!==t?t:{};return Object.keys(i).join(", ")}formatHint(e){return e.map(e=>this.enumPrintPipe.transform(e)).join(", ")}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(r.h),ae.Pb(Er))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-edit-document-context"]],viewQuery:function(e,t){if(1&e&&ae.Vc(Ka,!0),2&e){let e;ae.xc(e=ae.dc())&&(t.portals=e)}},features:[ae.Cb([Er])],decls:2,vars:2,consts:[[4,"appFlagApplication"],[3,"showHeader",4,"appFlagApplication"],["portal",""],["label","Transitions",3,"hint","itemClick"],["label","Transparency Mode",3,"hint","itemClick"],["label","Post Processing",3,"hint","itemClick"],["label","Clipping Planes",3,"hint","itemClick"],["label","Particle Systems",3,"hint","itemClick"],["label","Properties",3,"hint","itemClick"],[3,"showHeader"],["column-group-body",""],[1,"context","text-14"],["src","/assets/images/logo-blue.svg",1,"context__logo"]],template:function(e,t){1&e&&(ae.Nc(0,tl,15,18,"ng-container",0),ae.Nc(1,il,9,1,"app-column",1)),2&e&&(ae.mc("appFlagApplication",t.application.Loft),ae.Db(1),ae.mc("appFlagApplication",t.application.Studio))},directives:[pt.a,Ka,ts,Kn,Fn],pipes:[n.b,Er],styles:["a[_ngcontent-%COMP%]{color:rgba(150,168,192,.5)}.column[_ngcontent-%COMP%]{align-items:center}.column[_ngcontent-%COMP%], .context[_ngcontent-%COMP%]{display:flex;justify-content:center;height:100%}.context[_ngcontent-%COMP%]{flex-direction:column;padding:16px;text-align:center;color:rgba(150,168,192,.5)}.context__logo[_ngcontent-%COMP%]{width:40px;display:block;margin:20px auto;opacity:.3}"],changeDetection:0}),Yc([Object(r.e)(F.a.getSelectedChapterId),el("design:type",m.a)],e.prototype,"selectedChapterId$",void 0),Yc([Object(r.e)(F.a.getSelectedChapter),el("design:type",m.a)],e.prototype,"selectedChapter$",void 0),Yc([Object(r.e)(F.a.getSelectedChapterClippingPlanes),el("design:type",m.a)],e.prototype,"clippingPlanes$",void 0),e})();var ol=i("l57l"),al=i("2o60"),rl=i("A+8E"),sl=i("6L7E"),cl=function(e){return e.Object="object",e.Position="position",e}({}),ll=i("XoU3"),pl=i("qplK"),dl=i("WRwD"),ul=i("2he+");function hl(e,t){if(1&e&&(ae.Vb(0,"app-form-field",50),ae.Vb(1,"select",51),ae.Vb(2,"option",29),ae.Pc(3,"Alphabetical"),ae.Ub(),ae.Vb(4,"option",29),ae.Pc(5,"Numerical"),ae.Ub(),ae.Ub(),ae.Ub()),2&e){const e=ae.gc();ae.Db(2),ae.mc("value",e.labelSequentialType.Alphabetical),ae.Db(2),ae.mc("value",e.labelSequentialType.Numerical)}}function ml(e,t){1&e&&(ae.Vb(0,"div"),ae.Vb(1,"mat-checkbox",52),ae.Pc(2,"Show description & image"),ae.Ub(),ae.Ub())}function bl(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"app-form-field"),ae.Vb(1,"button",55),ae.cc("click",(function(){return ae.Cc(e),ae.gc(2).handleRecordPositionClick()})),ae.Pc(2," Mark Position "),ae.Ub(),ae.Ub()}}function gl(e,t){if(1&e&&(ae.Vb(0,"div",53),ae.Vb(1,"app-form-field"),ae.Vb(2,"select",54),ae.Vb(3,"option",29),ae.Pc(4,"Zoom to label structure"),ae.Ub(),ae.Vb(5,"option",29),ae.Pc(6,"Zoom to fixed position"),ae.Ub(),ae.Ub(),ae.Ub(),ae.Nc(7,bl,3,0,"app-form-field",47),ae.Ub()),2&e){const e=ae.gc();ae.Db(3),ae.mc("value",e.labelFlyTo.Object),ae.Db(2),ae.mc("value",e.labelFlyTo.Position),ae.Db(2),ae.mc("ngIf",e._flyToTarget===e.labelFlyTo.Position)}}let fl=(()=>{class e{constructor(e,t,i,n){this.formBuilder=e,this.store=t,this.cameraService=i,this.matSnackBar=n,this.labelTheme=ol.a,this.labelPinType=al.a,this.labelSequentialType=rl.a,this.labelFlyTo=cl,this.ngUnsubscribe=new c.a,this.open=!1,this.opened=new ae.p;const o=new sl.a("");this.form=this.formBuilder.group({title:[o.title],description:[o.description],theme:[o.theme],pinType:[o.pinType,G.C.required],sequentialType:[o.sequentialType,G.C.required],pinGlow:[o.pinGlow],collapseDescription:[o.collapseDescription],hideWire:[o.hideWire],hideTag:[o.hideTag],expandTag:[o.expandTag],showDescription:[o.showDescription],flyTo:[!1],flyToTarget:[""],image:this.formBuilder.group({urls:[],alt:[""]})})}get label(){return this._label}set label(e){JSON.stringify(e)!==JSON.stringify(this._label)&&(this._label=e,this.setFormValues(e))}get _theme(){return this.form.get("theme").value}get _flyTo(){return this.form.get("flyTo").value}get _flyToTarget(){return this.form.get("flyToTarget").value}get _hideWire(){return this.form.get("hideWire").value}ngOnInit(){this.form.valueChanges.pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(e=>this.handleFormChanges(e))}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}handleAlignButton(e,t){this.label.offset=[e,t],this.store.dispatch(new $.m(this.label,!0))}handleRecordPositionClick(){const e=JSON.parse(JSON.stringify(this.label.states)),t=this.prepareLabelStates(e);t[1].errands=[new pl.a(this.cameraService.getCamera())],this.store.dispatch(new $.p(this.label.id,t)),this.matSnackBar.open("Recorded marked position")}handleRemove(){this.store.dispatch(new $.i(this.label))}handleFormChanges(e){const t=Object(W.cloneDeep)(this.label);if(t.title=e.title,t.description=e.description||"",t.theme=e.theme,t.pinType=e.pinType,t.sequentialType=e.sequentialType,t.pinGlow=e.pinGlow,t.collapseDescription=e.collapseDescription,t.hideWire=e.hideWire,t.hideTag=e.hideTag,t.expandTag=e.expandTag,t.showDescription=e.showDescription,e.flyTo)switch(t.states=this.prepareLabelStates(t.states),t.flyTo=e.flyTo,t.flyToTarget=e.flyToTarget,e.flyToTarget){case cl.Object:t.states[1].errands=[new ll.a(t.objectId)];break;case cl.Position:if(!(Object(W.get)(t,"states[1].errands[0]")instanceof pl.a)){const e=this.cameraService.getCamera();t.cameraPosition=e,t.states[1].errands=[new pl.a(e)]}}else t.states&&t.states.length&&t.states[1]&&(t.states[1].errands=[]);t.contentBlocks=this.toContentBlocks(e),this.store.dispatch(new $.m(t,!0))}handleAlignClick(e){const t=Object(W.cloneDeep)(this.label),i=t.hideWire?20:32;switch(e){case"left":t.offset=[-i,0];break;case"right":t.offset=[i,0]}this.store.dispatch(new $.m(t,!0))}handleOpened(e){this.opened.emit({label:this.label,open:e})}prepareLabelStates(e){let t=e?[...e]:[];return t||(t=[]),t[0]||(t[0]=new dl.a,t[0].id=go.a.idWithPrefix("label-state")),t[1]||(t[1]=new dl.a,t[1].id=go.a.idWithPrefix("label-state")),t}setFormValues(e){const t=this.fromContentBlocks(e.contentBlocks||[]),i={title:e.title,description:e.description||"",theme:e.theme,pinType:e.pinType,sequentialType:e.sequentialType,pinGlow:e.pinGlow,collapseDescription:e.collapseDescription,hideWire:e.hideWire,hideTag:e.hideTag,flyTo:null,flyToTarget:cl.Object,expandTag:e.expandTag,showDescription:e.showDescription,image:t},n=Object(W.get)(e,"states[1].errands[0]");if(n)switch(i.flyTo=!0,!0){case n instanceof pl.a:i.flyToTarget=cl.Position;break;case n instanceof ll.a:default:i.flyToTarget=cl.Object}this.form.setValue(i,{emitEvent:!1})}fromContentBlocks(e){const t={urls:null,alt:""},i=e.find(e=>e.type===ee.a.Images),n=Object(W.get)(i,"images[0]",t);return Object.assign(Object.assign({},t),n)}toContentBlocks(e){const{urls:t,alt:i}=e.image;return!Object(W.isNil)(t)||i?[{type:ee.a.Images,images:[{urls:t,alt:i}]}]:[]}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(G.f),ae.Pb(r.h),ae.Pb(fn.a),ae.Pb(le.b))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-label-widget"]],inputs:{label:"label",open:"open"},outputs:{opened:"opened"},decls:74,vars:25,consts:[["toggleType","arrow",3,"label","open","opened"],["panel-prefix",""],[1,"flex","justify-start","items-center",2,"width","36px","height","36px"],[3,"label","labelTheme"],["panel-actions",""],["app-button","","buttonSize","small",3,"matMenuTriggerFor"],["icon","ellipsis-v"],["labelMenu","matMenu"],["mat-menu-item","",3,"click"],["autocomplete","off",3,"formGroup"],["tabSize","small","tabTheme","dark"],["label","Content"],[1,"pt-2","pl-1"],["label","Title",1,"pb-2"],["textMode","text","mode","basic","formControlName","title",3,"inline","compact","maxLength"],["title",""],[3,"field"],["formGroupName","image"],["label","Image",1,"pb-2"],["type","image","formControlName","urls"],["label","Image Alt",1,"pb-2"],["type","text","formControlName","alt",1,"input"],["label","Description",1,"pb-2"],["textMode","textarea","formControlName","description","rows","9",3,"inline","compact","maxLength"],["description",""],["label","Style"],[1,"pt-2","pl-1","text-12"],["label","Label Theme"],["formControlName","theme",1,"input"],[3,"value"],["label","Label Pin"],["formControlName","pinType",1,"input"],["label","Sequence Type",4,"ngIf"],["label","Label Type"],["formControlName","hideWire",1,"input","mr-2",2,"display","inline-block","width","154px"],[3,"ngValue"],[2,"display","inline-block"],["app-button","","buttonType","outline","matTooltip","Align Left",3,"click"],["icon","caret-left"],["app-button","","buttonType","outline","matTooltip","Align Right",3,"click"],["icon","caret-right"],["formControlName","pinGlow"],["label","Actions"],["label","On load"],["listType","flat"],["formControlName","collapseDescription"],["label","On click"],[4,"ngIf"],["formControlName","flyTo"],["class","pl-6 pt-2",4,"ngIf"],["label","Sequence Type"],["formControlName","sequentialType",1,"input"],["formControlName","showDescription"],[1,"pl-6","pt-2"],["formControlName","flyToTarget",1,"input"],["app-button","","buttonType","outline","buttonSize","small",1,"w-100",3,"click"]],template:function(e,t){if(1&e&&(ae.Vb(0,"app-panel",0),ae.cc("opened",(function(e){return t.handleOpened(e)})),ae.Tb(1,1),ae.Vb(2,"div",2),ae.Qb(3,"app-label-pin",3),ae.Ub(),ae.Sb(),ae.Vb(4,"span",4),ae.Vb(5,"button",5),ae.Qb(6,"app-icon",6),ae.Ub(),ae.Vb(7,"mat-menu",null,7),ae.Vb(9,"button",8),ae.cc("click",(function(){return t.handleRemove()})),ae.Pc(10,"Remove"),ae.Ub(),ae.Ub(),ae.Ub(),ae.Vb(11,"form",9),ae.Vb(12,"app-tabs",10),ae.Vb(13,"app-tab",11),ae.Vb(14,"div",12),ae.Vb(15,"app-form-field",13),ae.Qb(16,"app-rich-text-edit",14,15),ae.Qb(18,"app-character-counter",16),ae.Ub(),ae.Tb(19,17),ae.Vb(20,"app-form-field",18),ae.Qb(21,"app-content-upload-input",19),ae.Ub(),ae.Vb(22,"app-form-field",20),ae.Qb(23,"input",21),ae.Ub(),ae.Sb(),ae.Vb(24,"app-form-field",22),ae.Qb(25,"app-rich-text-edit",23,24),ae.Qb(27,"app-character-counter",16),ae.Ub(),ae.Ub(),ae.Ub(),ae.Vb(28,"app-tab",25),ae.Vb(29,"div",26),ae.Vb(30,"app-form-field",27),ae.Vb(31,"select",28),ae.Vb(32,"option",29),ae.Pc(33,"Dark"),ae.Ub(),ae.Vb(34,"option",29),ae.Pc(35,"Light"),ae.Ub(),ae.Ub(),ae.Ub(),ae.Vb(36,"app-form-field",30),ae.Vb(37,"select",31),ae.Vb(38,"option",29),ae.Pc(39,"Circle"),ae.Ub(),ae.Vb(40,"option",29),ae.Pc(41,"Plus / Minus"),ae.Ub(),ae.Vb(42,"option",29),ae.Pc(43,"Sequential"),ae.Ub(),ae.Vb(44,"option",29),ae.Pc(45,"None"),ae.Ub(),ae.Ub(),ae.Ub(),ae.Nc(46,hl,6,2,"app-form-field",32),ae.Vb(47,"app-form-field",33),ae.Vb(48,"select",34),ae.Vb(49,"option",35),ae.Pc(50,"Leader Line"),ae.Ub(),ae.Vb(51,"option",35),ae.Pc(52,"Floating"),ae.Ub(),ae.Ub(),ae.Vb(53,"app-button-group",36),ae.Vb(54,"button",37),ae.cc("click",(function(){return t.handleAlignClick("left")})),ae.Qb(55,"app-icon",38),ae.Ub(),ae.Vb(56,"button",39),ae.cc("click",(function(){return t.handleAlignClick("right")})),ae.Qb(57,"app-icon",40),ae.Ub(),ae.Ub(),ae.Ub(),ae.Vb(58,"app-form-field"),ae.Vb(59,"mat-checkbox",41),ae.Pc(60," Make Pin Glow "),ae.Ub(),ae.Ub(),ae.Ub(),ae.Ub(),ae.Vb(61,"app-tab",42),ae.Vb(62,"div",26),ae.Vb(63,"app-form-field",43),ae.Vb(64,"app-list",44),ae.Vb(65,"app-list-item"),ae.Vb(66,"mat-checkbox",45),ae.Pc(67," Hide description & image "),ae.Ub(),ae.Ub(),ae.Ub(),ae.Ub(),ae.Vb(68,"app-form-field",46),ae.Nc(69,ml,3,0,"div",47),ae.Vb(70,"div"),ae.Vb(71,"mat-checkbox",48),ae.Pc(72,"Zoom label"),ae.Ub(),ae.Nc(73,gl,8,3,"div",49),ae.Ub(),ae.Ub(),ae.Ub(),ae.Ub(),ae.Ub(),ae.Ub(),ae.Ub()),2&e){const e=ae.yc(8),i=ae.yc(17),n=ae.yc(26);ae.mc("label",t.label.title)("open",t.open),ae.Db(3),ae.mc("label",t.label)("labelTheme",t.label.theme),ae.Db(2),ae.mc("matMenuTriggerFor",e),ae.Db(6),ae.mc("formGroup",t.form),ae.Db(5),ae.mc("inline",!0)("compact",!0)("maxLength",100),ae.Db(2),ae.mc("field",i),ae.Db(7),ae.mc("inline",!0)("compact",!0)("maxLength",300),ae.Db(2),ae.mc("field",n),ae.Db(5),ae.mc("value",t.labelTheme.Annotation),ae.Db(2),ae.mc("value",t.labelTheme.StudioNext),ae.Db(4),ae.mc("value",t.labelPinType.Default),ae.Db(2),ae.mc("value",t.labelPinType.PlusMinus),ae.Db(2),ae.mc("value",t.labelPinType.Sequential),ae.Db(2),ae.mc("value",t.labelPinType.None),ae.Db(2),ae.mc("ngIf","sequential"==t.label.pinType),ae.Db(3),ae.mc("ngValue",!1),ae.Db(2),ae.mc("ngValue",!0),ae.Db(18),ae.mc("ngIf",t.label.collapseDescription),ae.Db(4),ae.mc("ngIf",t._flyTo)}},directives:[be.a,ul.a,pe.a,Sn.d,at.a,Sn.a,Sn.b,G.E,G.s,G.j,Yn.a,eo.a,de.a,nt,G.r,G.i,ue.a,G.k,rt.a,G.c,G.B,G.v,G.D,n.p,Oo,st.c,ge.a,gt.a,ft.a],styles:["[_nghost-%COMP%]{display:block}"],changeDetection:0}),e})();var xl=function(e,t,i,n){var o,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,i,r):o(t,i))||r);return a>3&&r&&Object.defineProperty(t,i,r),r},yl=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function vl(e,t){1&e&&(ae.Vb(0,"div",22),ae.Vb(1,"div",23),ae.Pc(2,"Add a label"),ae.Ub(),ae.Vb(3,"div",17),ae.Pc(4,"Click on an object in the 3D scene to start adding labels."),ae.Ub(),ae.Ub())}function Cl(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"div",24),ae.Vb(1,"app-label-widget",25),ae.cc("opened",(function(t){return ae.Cc(e),ae.gc().handleOpened(t)})),ae.hc(2,"async"),ae.Ub(),ae.Vb(3,"div",26),ae.Qb(4,"app-icon",27),ae.Ub(),ae.Ub()}if(2&e){const e=t.$implicit,i=ae.gc();let n=null;ae.Db(1),ae.mc("label",e)("open",(null==(n=ae.ic(2,3,i.selectedLabel$))?null:n.id)===e.id),ae.Eb("data-id",e.id)}}let Pl=(()=>{class e{constructor(e,t){this.store=e,this.formBuilder=t,this.activeToolEnum=Q.a,this.labelTheme=ol.a,this.labelPinType=al.a,this.labelSequentialType=rl.a,this.interactive=!1,this.widgetSubscriptions=[],this.ngUnsubscribe=new c.a,this.labelForm=this.formBuilder.group({title:[""],description:[""]})}ngOnInit(){this.bindApplicationEvents(),this.selectedLabel$.pipe(Object(O.a)(e=>!!e),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{setTimeout(()=>this.scrollLabelIntoView(e))})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}ngAfterViewInit(){this.subscribeToOpen(),this.labelWidgets.changes.subscribe(()=>{this.unsubscribeToOpen(),this.subscribeToOpen()})}bindApplicationEvents(){this.selectedChapter$.pipe(Object(O.a)(e=>null!=e),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.interactive=e.readyState.model})}unsubscribeToOpen(){this.widgetSubscriptions.forEach(e=>e.unsubscribe()),this.widgetSubscriptions=[]}subscribeToOpen(){this.labelWidgets.forEach(e=>{const t=e.opened.pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(t=>{this.openWidget(e,t)});this.widgetSubscriptions.push(t)})}handleOpenWidgets(e){this.toggleWidgets(e)}handleOpened(e){this.store.dispatch(new $.k(e.label))}handleRemoveChapterLabels(){this.store.dispatch(new $.g(this.store.selectSnapshot(F.a.getSelectedChapter)))}handleNext(){this.store.dispatch(new g.b)}handlePrevious(){this.store.dispatch(new g.d)}handleCheckedChange(e){this.store.dispatch(new I.c(e.checked))}toggleWidgets(e){this.labelWidgets.forEach(t=>{t.open=e})}openWidget(e,t){this.toggleWidgets(!1),e.open=t}trackLabel(e,t){return t.id}convertLabels(e,t){const i=this.store.selectSnapshot(t?R.a.getChapterLabels:R.a.getLabels);this.store.dispatch(new $.c(i,e))}scrollLabelIntoView(e){const t=document.querySelector(`[data-id="${e.id}"]`);"scrollBehavior"in document.documentElement.style&&t&&t.scrollIntoView({behavior:"smooth",block:"nearest"})}handleDrop(e){const t=this.store.selectSnapshot(R.a.getChapterLabels);Object(ot.e)(t,e.previousIndex,e.currentIndex);let i=this.store.selectSnapshot(R.a.getLabels).filter(e=>!t.some(t=>t.id===e.id));i=[...i,...t],this.store.dispatch(new $.q(i))}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(r.h),ae.Pb(G.f))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-edit-label-context"]],viewQuery:function(e,t){if(1&e&&ae.Vc(be.a,!0),2&e){let e;ae.xc(e=ae.dc())&&(t.labelWidgets=e)}},decls:54,vars:16,consts:[[3,"loading"],["column-label",""],["column-actions",""],["app-button","",1,"context__actions",3,"matMenuTriggerFor"],["icon","ellipsis-v"],["labelMenu","matMenu"],["mat-menu-item","",3,"click"],["mat-menu-item","",3,"matMenuTriggerFor"],["storyTrigger","matMenuTrigger"],["chapterTrigger","matMenuTrigger"],["convertMenu","matMenu"],["convertThemeMenu","matMenu"],["convertPinsMenu","matMenu"],["label","Label"],["column-group-header",""],[1,"pl-2"],[3,"checked","change"],[1,"text-12"],["column-group-body",""],["class","p-3",4,"ngIf"],["cdkDropList","",1,"labels",3,"cdkDropListDropped"],["class","labels__item","cdkDrag","",4,"ngFor","ngForOf","ngForTrackBy"],[1,"p-3"],[1,"text-12","text-bold"],["cdkDrag","",1,"labels__item"],[1,"flex-grow",3,"label","open","opened"],["cdkDragHandle","",1,"labels__handle"],["icon","grip-lines"]],template:function(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"app-column",0),ae.Vb(1,"div",1),ae.Pc(2,"Labels"),ae.Ub(),ae.Vb(3,"div",2),ae.Vb(4,"button",3),ae.Qb(5,"app-icon",4),ae.Ub(),ae.Vb(6,"mat-menu",null,5),ae.Vb(8,"button",6),ae.cc("click",(function(){return t.handleRemoveChapterLabels()})),ae.Pc(9," Remove this chapter's labels "),ae.Ub(),ae.Qb(10,"mat-divider"),ae.Vb(11,"button",7,8),ae.Pc(13," Convert all labels "),ae.Ub(),ae.Vb(14,"button",7,9),ae.Pc(16," Convert this chapter's labels "),ae.Ub(),ae.Ub(),ae.Vb(17,"mat-menu",null,10),ae.Vb(19,"button",7),ae.Pc(20,"Theme"),ae.Ub(),ae.Vb(21,"button",7),ae.Pc(22,"Pin"),ae.Ub(),ae.Ub(),ae.Vb(23,"mat-menu",null,11),ae.Vb(25,"button",6),ae.cc("click",(function(){ae.Cc(e);const i=ae.yc(15);return t.convertLabels({theme:t.labelTheme.Annotation},i.menuOpen)})),ae.Pc(26," Dark Theme "),ae.Ub(),ae.Vb(27,"button",6),ae.cc("click",(function(){ae.Cc(e);const i=ae.yc(15);return t.convertLabels({theme:t.labelTheme.StudioNext},i.menuOpen)})),ae.Pc(28," Light Theme "),ae.Ub(),ae.Ub(),ae.Vb(29,"mat-menu",null,12),ae.Vb(31,"button",6),ae.cc("click",(function(){ae.Cc(e);const i=ae.yc(15);return t.convertLabels({pinType:t.labelPinType.Default},i.menuOpen)})),ae.Pc(32," Circle "),ae.Ub(),ae.Vb(33,"button",6),ae.cc("click",(function(){ae.Cc(e);const i=ae.yc(15);return t.convertLabels({pinType:t.labelPinType.PlusMinus},i.menuOpen)})),ae.Pc(34," Plus / Minus "),ae.Ub(),ae.Vb(35,"button",6),ae.cc("click",(function(){ae.Cc(e);const i=ae.yc(15);return t.convertLabels({pinType:t.labelPinType.Sequential,sequentialType:t.labelSequentialType.Alphabetical},i.menuOpen)})),ae.Pc(36," Alphabetical "),ae.Ub(),ae.Vb(37,"button",6),ae.cc("click",(function(){ae.Cc(e);const i=ae.yc(15);return t.convertLabels({pinType:t.labelPinType.Sequential,sequentialType:t.labelSequentialType.Numerical},i.menuOpen)})),ae.Pc(38," Numerical "),ae.Ub(),ae.Vb(39,"button",6),ae.cc("click",(function(){ae.Cc(e);const i=ae.yc(15);return t.convertLabels({pinType:t.labelPinType.None},i.menuOpen)})),ae.Pc(40," None "),ae.Ub(),ae.Ub(),ae.Ub(),ae.Vb(41,"app-column-group",13),ae.Tb(42,14),ae.Vb(43,"div",15),ae.Vb(44,"mat-checkbox",16),ae.cc("change",(function(e){return t.handleCheckedChange(e)})),ae.hc(45,"async"),ae.Vb(46,"span",17),ae.Pc(47,"Disable label zoom while editing"),ae.Ub(),ae.Ub(),ae.Ub(),ae.Sb(),ae.Tb(48,18),ae.Nc(49,vl,5,0,"div",19),ae.hc(50,"async"),ae.Vb(51,"div",20),ae.cc("cdkDropListDropped",(function(e){return t.handleDrop(e)})),ae.Nc(52,Cl,5,5,"div",21),ae.hc(53,"async"),ae.Ub(),ae.Sb(),ae.Ub(),ae.Ub()}if(2&e){const e=ae.yc(7),i=ae.yc(18),n=ae.yc(24),o=ae.yc(30);let a=null;ae.mc("loading",!t.interactive),ae.Db(4),ae.mc("matMenuTriggerFor",e),ae.Db(7),ae.mc("matMenuTriggerFor",i),ae.Db(3),ae.mc("matMenuTriggerFor",i),ae.Db(5),ae.mc("matMenuTriggerFor",n),ae.Db(2),ae.mc("matMenuTriggerFor",o),ae.Db(23),ae.mc("checked",ae.ic(45,10,t.lockCamera$)),ae.Db(5),ae.mc("ngIf",!(null!=(a=ae.ic(50,12,t.labels$))&&a.length)),ae.Db(3),ae.mc("ngForOf",ae.ic(53,14,t.labels$))("ngForTrackBy",t.trackLabel)}},directives:[Kn,pe.a,Sn.d,at.a,Sn.a,Sn.b,me.a,Fn,ge.a,n.p,ot.c,n.o,ot.a,fl,ot.b],pipes:[n.b],styles:[".context__actions[_ngcontent-%COMP%]{flex:0 1 auto}.labels__item[_ngcontent-%COMP%]{position:relative}.labels__item[_ngcontent-%COMP%]:hover   .labels__handle[_ngcontent-%COMP%]{opacity:1}.labels__handle[_ngcontent-%COMP%]{border:4px solid transparent;display:flex;align-items:center;justify-content:center;background:#131c2a;width:44px;height:36px;cursor:move;color:#96a8c0;position:absolute;left:4px;top:16px;z-index:10;opacity:0;transition:opacity .15s}.labels[_ngcontent-%COMP%]   .cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:.2}"],changeDetection:0}),xl([Object(r.e)(y.a.getStory),yl("design:type",m.a)],e.prototype,"story$",void 0),xl([Object(r.e)(F.a.getSelectedChapter),yl("design:type",m.a)],e.prototype,"selectedChapter$",void 0),xl([Object(r.e)(R.a.getChapterLabels),yl("design:type",m.a)],e.prototype,"labels$",void 0),xl([Object(r.e)(R.a.getSelectedLabel),yl("design:type",m.a)],e.prototype,"selectedLabel$",void 0),xl([Object(r.e)(x.a.getChapter),yl("design:type",m.a)],e.prototype,"chapter$",void 0),xl([Object(r.e)(x.a.getActiveTool),yl("design:type",m.a)],e.prototype,"activeTool$",void 0),xl([Object(r.e)(z.a.getLockCamera),yl("design:type",m.a)],e.prototype,"lockCamera$",void 0),e})();var Ol=i("xcvO"),wl=i("nclC");class kl{constructor(e){this.label=e||"",this.id=go.a.idWithPrefix("palette"),this.recipes=[],this.open=!0}}function Sl(e,t){1&e&&(ae.Vb(0,"app-alert",15),ae.Pc(1," There was an error importing your palette. "),ae.Ub())}let _l=(()=>{class e{constructor(e,t,i){this.formBuilder=e,this.dialogRef=t,this.changeDetectorRef=i,this.hasError=!1}ngOnInit(){this.initForm()}initForm(){this.form=this.formBuilder.group({import:["",G.C.required]})}handleSubmit(){const e=this.form.get("import").value;this.createPalette(e)}createPalette(e){this.hasError=!1;try{const t=JSON.parse(e),i=Object(Xn.plainToClass)(kl,t);delete i.id,this.dialogRef.close(i)}catch(t){this.hasError=!0,this.changeDetectorRef.markForCheck()}}handleFile(e){var t=new FileReader;t.onload=e=>{this.createPalette(e.target.result)},t.readAsText(e.target.files[0])}onReaderLoad(e){this.createPalette(e.target.result)}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(G.f),ae.Pb(H.g),ae.Pb(ae.i))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-edit-import-palette-dialog"]],decls:18,vars:2,consts:[["data-test","importPaletteDialog",1,"edit-import-palette-dialog","theme-light"],["mat-dialog-title",""],["mat-dialog-content",""],["type","danger","theme","light","class","mb-4 block",4,"ngIf"],["tabTheme","light"],["label","Paste Text"],["data-test","importForm",3,"formGroup","submit"],["label","Palette"],["formControlName","import","rows","6","name","import","data-test","importText",1,"input"],["label","Upload file"],["label","Palette File"],["type","file",1,"input",3,"change"],["mat-dialog-actions",""],["app-button","","buttonTheme","light","type","button",1,"mr-2",3,"mat-dialog-close"],["app-button","","buttonType","primary",3,"click"],["type","danger","theme","light",1,"mb-4","block"]],template:function(e,t){1&e&&(ae.Vb(0,"div",0),ae.Vb(1,"h1",1),ae.Pc(2,"Import Palette"),ae.Ub(),ae.Vb(3,"div",2),ae.Nc(4,Sl,2,0,"app-alert",3),ae.Vb(5,"app-tabs",4),ae.Vb(6,"app-tab",5),ae.Vb(7,"form",6),ae.cc("submit",(function(){return t.handleSubmit()})),ae.Vb(8,"app-form-field",7),ae.Qb(9,"textarea",8),ae.Ub(),ae.Ub(),ae.Ub(),ae.Vb(10,"app-tab",9),ae.Vb(11,"app-form-field",10),ae.Vb(12,"input",11),ae.cc("change",(function(e){return t.handleFile(e)})),ae.Ub(),ae.Ub(),ae.Ub(),ae.Ub(),ae.Ub(),ae.Vb(13,"div",12),ae.Vb(14,"button",13),ae.Pc(15," Cancel "),ae.Ub(),ae.Vb(16,"button",14),ae.cc("click",(function(){return t.handleSubmit()})),ae.Pc(17,"Import"),ae.Ub(),ae.Ub(),ae.Ub()),2&e&&(ae.Db(4),ae.mc("ngIf",t.hasError),ae.Db(3),ae.mc("formGroup",t.form))},directives:[H.h,H.e,n.p,Yn.a,eo.a,G.E,G.s,G.j,de.a,G.c,G.r,G.i,H.c,pe.a,H.d,no.a],styles:[""],changeDetection:0}),e})();function Ml(e){let t="";return"number"==typeof e?t=Math.floor(e).toString():Hi.a.isFresnel(e)?t=`(Center: ${Ml((i=e).center)}, Edge: ${Ml(i.edge)}, Center Bias: ${Ml(i.centerBias)}, Edge Bias: ${Ml(i.edgeBias)}, Power: ${i.power})`:Hi.a.isColor(e)&&(t=Z.a.rgbToHex(Z.a.rgbFromDecimal(e)).toUpperCase()),t;var i}var Ul=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const Tl=["palette"];function Vl(e,t){if(1&e&&(ae.Vb(0,"div",4),ae.Pc(1),ae.Ub()),2&e){const e=ae.gc();ae.Db(1),ae.Rc(" ",e.label,"\n")}}const Dl=function(e,t,i){return{"paint-palette-swatch--slash":e,"paint-palette-swatch--selected":t,"paint-palette-swatch--large":i}};let El=(()=>{class e{constructor(e,t){this.renderer=e,this.changeDetectorRef=t,this.showLabel=!0,this.size="small",this.highlightSelected=!0,this.selected=!1,this.showSlash=!1,this.ngUnsubscribe=new c.a}get engineRecipe(){return this._engineRecipe}set engineRecipe(e){this._engineRecipe=e,this.recipe=Hi.a.fromEngine(this.engineRecipe)}get recipe(){return this._recipe}set recipe(e){this._recipe=e,this.recipe&&(this.updateStyle(this.recipe),this.updateTooltip())}get label(){return this._label}set label(e){this._label=e,this.updateTooltip()}ngOnInit(){this.currentRecipe$.pipe(Object(P.a)(this.ngUnsubscribe),Object(O.a)(()=>this.highlightSelected),Object(O.a)(e=>!Object(W.isNil)(e))).subscribe(e=>{this.selected=this.isSelected(this.recipe,e),this.changeDetectorRef.markForCheck()})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}updateStyle(e){let t=1;if(Hi.a.modifiesOpacity(e)&&(t=Object(W.isNumber)(e.opacity)?e.opacity>1?e.opacity/100:e.opacity:.4),Hi.a.isFresnel(e.tintColor)){const t=Z.a.rgbToHex(Z.a.rgbFromDecimal(e.tintColor.center)),i=Z.a.rgbToHex(Z.a.rgbFromDecimal(e.tintColor.edge));this.renderer.setStyle(this.element.nativeElement,"background",`radial-gradient(${t} 0%, ${i} 60%)`)}else{const i=this.makeColor(e,t);this.renderer.setStyle(this.element.nativeElement,"background",i)}this.showSlash=!1===e.tintColor&&!1===e.brightness&&!1===e.contrast&&!1===e.opacity&&!1===e.saturation}makeColor(e,t=1){const i=e.tintColor;if(!i)return`rgba(255,255,255,${t})`;const[n,o,a]=i;return`rgba(${255*n}, ${255*o}, ${255*a}, ${t})`}updateTooltip(){if(!this.recipe)return;let e=[];this.label&&e.push(this.label);const t=[...e,...[{key:"Color",value:Ml(this.recipe.tintColor)},{key:"Saturation",value:Ml(this.recipe.saturation)},{key:"Contrast",value:Ml(this.recipe.contrast)},{key:"Brightness",value:Ml(this.recipe.brightness)},{key:"Opacity",value:Ml(this.recipe.opacity)}].filter(e=>""!==e.value).map(e=>`${e.key}: ${e.value}`)].join("\n\n");this.tooltip=t}isSelected(e,t){return Object(W.isEqual)(e,t)}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(ae.H),ae.Pb(ae.i))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-paint-swatch"],["button","app-paint-swatch",""]],viewQuery:function(e,t){if(1&e&&ae.Jc(Tl,!0),2&e){let e;ae.xc(e=ae.dc())&&(t.element=e.first)}},inputs:{engineRecipe:"engineRecipe",recipe:"recipe",label:"label",showLabel:"showLabel",size:"size",icon:"icon",highlightSelected:"highlightSelected"},decls:4,vars:7,consts:[["matTooltipClass","text-pre-line","matTooltipPosition","above","data-test","paintPaletteSwatch",1,"paint-palette-swatch",3,"ngClass","matTooltip"],[1,"paint-palette-swatch__style"],["palette",""],["class","paint-palette-swatch__label",4,"ngIf"],[1,"paint-palette-swatch__label"]],template:function(e,t){1&e&&(ae.Vb(0,"div",0),ae.Qb(1,"div",1,2),ae.Ub(),ae.Nc(3,Vl,2,1,"div",3)),2&e&&(ae.mc("ngClass",ae.rc(3,Dl,t.showSlash,t.selected,"large"===t.size))("matTooltip",t.tooltip),ae.Db(3),ae.mc("ngIf",t.showLabel))},directives:[n.m,st.c,n.p],styles:["[app-paint-swatch]{display:inline-flex;justify-content:center;align-items:center;flex-direction:column}button[app-paint-swatch]{cursor:pointer;background:none;border:none;margin:0;padding:0}.paint-palette-swatch__label{display:block;width:48px;height:20px;padding:4px 4px 0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;color:#fff;font-size:9px}.paint-palette-swatch{cursor:pointer;background-color:#fff;background-image:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8' viewBox='0 0 8 8'%3E%3Cg fill='%23CCCCCC' fill-opacity='1'%3E%3Cpath fill-rule='evenodd' d='M0 0h4v4H0V0zm4 4h4v4H4V4z'/%3E%3C/g%3E%3C/svg%3E\");border-radius:50%;display:flex;justify-content:center;align-items:center;width:24px;height:24px;position:relative}.paint-palette-swatch:hover:active{transform:scale(.9)}.paint-palette-swatch--large{width:36px;height:36px}.paint-palette-swatch--selected .paint-palette-swatch__style{box-shadow:0 0 0 2px #7fb6f5}.paint-palette-swatch--slash:after{content:\" \";position:absolute;height:3px;width:100%;background-color:rgba(244,67,54,.8);transform:rotate(135deg)}.paint-palette-swatch__style{position:absolute;width:100%;height:100%;border-radius:50%;box-shadow:0 0 0 1px #374a68}.paint-palette-swatch__icon{text-shadow:0 0 2px rgba(0,0,0,.8)}"],encapsulation:2,changeDetection:0}),function(e,t,i,n){var o,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,i,r):o(t,i))||r);a>3&&r&&Object.defineProperty(t,i,r)}([Object(r.e)(Wi.a.getCurrentRecipe),Ul("design:type",m.a)],e.prototype,"currentRecipe$",void 0),e})();function jl(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"div",12),ae.Qb(1,"app-paint-swatch",13),ae.Qb(2,"input",14),ae.Vb(3,"button",15),ae.cc("click",(function(){ae.Cc(e);const i=t.index;return ae.gc().handleRemove(i)})),ae.Qb(4,"app-icon",16),ae.Ub(),ae.Ub()}if(2&e){const e=t.$implicit,i=t.index,n=ae.gc();ae.mc("formGroup",e),ae.Db(1),ae.mc("recipe",n.palette.recipes[i])("highlightSelected",!1)("showLabel",!1)}}let Nl=(()=>{class e{constructor(e,t,i,n){this.dialogRef=e,this.data=t,this.formBuilder=i,this.store=n,this.form=this.formBuilder.group({label:["",G.C.required],recipes:this.formBuilder.array([])}),this.ngUnsubscribe=new c.a,this.activeRecipeIndex=null,this.showDetails=!1,this.palette=Object(W.cloneDeep)(this.data.palette)}get recipes(){return this.form.get("recipes")}ngOnInit(){this.updateForm(this.palette),this.handleFormChanges()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}updateForm(e){this.form.get("label").setValue(e.label),e.recipes.forEach(e=>{const t=this.formBuilder.group({label:[e.label]});this.recipes.push(t)})}handleFormChanges(){this.form.get("recipes").valueChanges.pipe(Object(P.a)(this.ngUnsubscribe),Object(O.a)(e=>e.length)).subscribe(e=>{this.palette.recipes.forEach((t,i)=>{this.palette.recipes[i].label=e[i].label})})}handleRemoveRecipe(e){this.palette.recipes.splice(e,1),this.store.dispatch(new Gi.n(this.palette))}handleSubmit(){const e=Object(Xn.plainToClass)(kl,Object.assign(Object.assign({},this.palette),{label:this.form.get("label").value}));this.dialogRef.close(e)}handleRecipeDrop(e){const{previousIndex:t,currentIndex:i}=e;this.palette.recipes=Object(te.a)(this.palette.recipes,t,i),this.recipes.controls=Object(te.a)(this.recipes.controls,t,i)}handleRecipeClick(e){this.activeRecipeIndex=e,this.showDetails=!1}handleRemove(e){this.palette.recipes.splice(e,1),this.activeRecipeIndex=null}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(H.g),ae.Pb(H.a),ae.Pb(G.f),ae.Pb(r.h))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-edit-palette-dialog"]],decls:15,vars:2,consts:[["data-test","editPaletteDialog",1,"edit-palette-dialog","theme-light"],["mat-dialog-title",""],["mat-dialog-content",""],["data-test","editPaletteForm",3,"formGroup","submit"],["label","Label"],["type","text","formControlName","label","cdkFocusInitial","","data-test","paletteLabel",1,"input"],["label","Colors","cdkDropList","","cdkDropListOrientation","vertical","formArrayName","recipes",3,"cdkDropListDropped"],[1,"edit-palette-dialog__recipes","theme-light"],["data-test","paletteRecipe","class","edit-palette-dialog__item","cdkDrag","",3,"formGroup",4,"ngFor","ngForOf"],["mat-dialog-actions",""],["app-button","","buttonTheme","light","type","button",1,"mr-2",3,"mat-dialog-close"],["app-button","","buttonType","primary","data-test","paletteSubmit",3,"click"],["data-test","paletteRecipe","cdkDrag","",1,"edit-palette-dialog__item",3,"formGroup"],[1,"mr-2",3,"recipe","highlightSelected","showLabel"],["type","label","placeholder","Label (optional)","formControlName","label","tabindex","0",1,"input","theme-light"],["type","button","app-button","","buttonType","outline","buttonTheme","light","tabindex","-1",1,"ml-2",3,"click"],["icon","times"]],template:function(e,t){1&e&&(ae.Vb(0,"div",0),ae.Vb(1,"h1",1),ae.Pc(2,"Manage Palette"),ae.Ub(),ae.Vb(3,"div",2),ae.Vb(4,"form",3),ae.cc("submit",(function(){return t.handleSubmit()})),ae.Vb(5,"app-form-field",4),ae.Qb(6,"input",5),ae.Ub(),ae.Vb(7,"app-form-field",6),ae.cc("cdkDropListDropped",(function(e){return t.handleRecipeDrop(e)})),ae.Vb(8,"div",7),ae.Nc(9,jl,5,4,"div",8),ae.Ub(),ae.Ub(),ae.Ub(),ae.Ub(),ae.Vb(10,"div",9),ae.Vb(11,"button",10),ae.Pc(12," Cancel "),ae.Ub(),ae.Vb(13,"button",11),ae.cc("click",(function(){return t.handleSubmit()})),ae.Pc(14," Done "),ae.Ub(),ae.Ub(),ae.Ub()),2&e&&(ae.Db(4),ae.mc("formGroup",t.form),ae.Db(5),ae.mc("ngForOf",t.recipes.controls))},directives:[H.h,H.e,G.E,G.s,G.j,de.a,G.c,G.r,G.i,ot.c,G.e,n.o,H.c,pe.a,H.d,ot.a,El,at.a],styles:[".edit-palette-dialog__recipes[_ngcontent-%COMP%]{padding:16px 0;max-height:320px;overflow-y:scroll}.edit-palette-dialog__item[_ngcontent-%COMP%]{border-radius:4px;display:flex;align-items:center;padding:8px}.edit-palette-dialog__item[_ngcontent-%COMP%]:hover{background:#eaeff5}"],changeDetection:0}),e})(),Rl=(()=>{class e{constructor(e,t,i,n,o){this.dialogService=e,this.clipboardService=t,this.snackbar=i,this.store=n,this.dialog=o}selectRecipe(e){this.store.dispatch(new Gi.d),this.store.dispatch(new Gi.h(e)),this.store.dispatch(new D.w(Q.a.Paint))}copyPaletteToClipboard(e){const t=Object(W.cloneDeep)(e);delete t.open;const i=JSON.stringify(t);this.clipboardService.copyToClipboard(i,"text").pipe(Object(k.a)(1)).subscribe(e=>{this.snackbar.open(e?"Successfully copied palette to clipboard.":"Failed to copy palette to clipboard.")})}downloadPalette(e){const t=Object.assign({},e);delete t.id,delete t.open;const i=(e.label.toLocaleLowerCase()||"palette")+".json",n=JSON.stringify(e),o=new Blob([n],{type:"text/plain;charset=utf-8"});Object(ei.saveAs)(o,i)}removePalette(e){this.dialogService.openConfirmDialog({data:{titleText:"Remove Palette",bodyText:`Would you like to remove the '${e.label}' palette?`,confirmText:"Remove Palette"}}).afterClosed().pipe(Object(k.a)(1),Object(O.a)(e=>!0===e)).subscribe(()=>{this.store.dispatch(new Gi.e(e.id))})}openImportPalette(){this.dialog.open(_l,{width:"480px"}).afterClosed().pipe(Object(k.a)(1),Object(O.a)(e=>!Object(W.isNil)(e))).subscribe(e=>{this.dialog.open(Nl,{width:"480px",data:{palette:e}}).afterClosed().pipe(Object(k.a)(1),Object(O.a)(e=>!Object(W.isNil)(e))).subscribe(e=>{this.store.dispatch(new Gi.a(e))})})}}return e.\u0275fac=function(t){return new(t||e)(ae.Zb(yn.a),ae.Zb(wl.a),ae.Zb(le.b),ae.Zb(r.h),ae.Zb(H.b))},e.\u0275prov=ae.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var Al=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Fl(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"button",10),ae.cc("click",(function(){ae.Cc(e);const i=t.$implicit;return ae.gc(2).handleRecipeClick(i)})),ae.Ub()}if(2&e){const e=t.$implicit;ae.mc("recipe",e)("label",e.label)}}function Il(e,t){if(1&e&&(ae.Vb(0,"div",6),ae.Vb(1,"div",7),ae.Pc(2),ae.Ub(),ae.Vb(3,"div",8),ae.Nc(4,Fl,1,2,"button",9),ae.Ub(),ae.Ub()),2&e){const e=t.$implicit;ae.Db(2),ae.Rc(" ",e.label," "),ae.Db(2),ae.mc("ngForOf",e.recipes)}}let zl=(()=>{class e{constructor(e){this.editPaintService=e,this.name="",this.groupedPresets=[{label:"Colors",recipes:$o.e},{label:"Effects",recipes:$o.a}]}ngOnInit(){}handleRecipeClick(e){this.editPaintService.selectRecipe(e)}isSelected(e,t){return JSON.stringify(e)===JSON.stringify(t)}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(Rl))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-paint-presets"]],decls:7,vars:3,consts:[["toggleType","arrow",3,"open","noPadding"],["panel-label","",1,"text-semibold","ph-3","pv-2"],[1,"text-semibold","flex","items-center","ph-",2,"min-height","36px"],[1,"ph-3","pb-2"],[1,"paint-presets"],["class","paint-presets__group",4,"ngFor","ngForOf"],[1,"paint-presets__group"],[1,"text-10","text-uppercase","text-dim","pv-2","pl-1"],[1,"ph-1"],["app-paint-swatch","","class","mr-2 mb-2","data-test","paintPreset",3,"recipe","label","click",4,"ngFor","ngForOf"],["app-paint-swatch","","data-test","paintPreset",1,"mr-2","mb-2",3,"recipe","label","click"]],template:function(e,t){1&e&&(ae.Vb(0,"app-panel",0),ae.Vb(1,"div",1),ae.Vb(2,"div",2),ae.Pc(3,"BioDigital"),ae.Ub(),ae.Ub(),ae.Vb(4,"div",3),ae.Vb(5,"div",4),ae.Nc(6,Il,5,2,"div",5),ae.Ub(),ae.Ub(),ae.Ub()),2&e&&(ae.mc("open",!0)("noPadding",!0),ae.Db(6),ae.mc("ngForOf",t.groupedPresets))},directives:[be.a,n.o,El],styles:[".paint-presets[_ngcontent-%COMP%]{display:flex;flex-flow:column}"],changeDetection:0}),function(e,t,i,n){var o,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,i,r):o(t,i))||r);a>3&&r&&Object.defineProperty(t,i,r)}([Object(r.e)(Wi.a.getCurrentRecipe),Al("design:type",m.a)],e.prototype,"colorRecipe$",void 0),e})();var Ll=i("PmOP"),Bl=function(e,t,i,n){var o,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,i,r):o(t,i))||r);return a>3&&r&&Object.defineProperty(t,i,r),r},Ql=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function $l(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"button",16),ae.cc("click",(function(){ae.Cc(e);const i=t.$implicit;return ae.gc().handleRecipeClick(i)})),ae.Ub()}2&e&&ae.mc("engineRecipe",t.$implicit)}function ql(e,t){1&e&&(ae.Vb(0,"div",17),ae.Vb(1,"span",18),ae.Pc(2,"No Brushes Found"),ae.Ub(),ae.Ub())}function Gl(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"button",16),ae.cc("click",(function(){ae.Cc(e);const i=t.$implicit;return ae.gc().handleRecipeClick(i)})),ae.Ub()}2&e&&ae.mc("engineRecipe",t.$implicit)}function Hl(e,t){1&e&&(ae.Vb(0,"div",17),ae.Vb(1,"span",18),ae.Pc(2,"No Brushes Found"),ae.Ub(),ae.Ub())}function Wl(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"button",16),ae.cc("click",(function(){ae.Cc(e);const i=t.$implicit;return ae.gc().handleRecipeClick(i)})),ae.Ub()}2&e&&ae.mc("engineRecipe",t.$implicit)}function Kl(e,t){1&e&&(ae.Vb(0,"div",17),ae.Vb(1,"span",18),ae.Pc(2,"No Brushes Found"),ae.Ub(),ae.Ub())}let Jl=(()=>{class e{constructor(e,t){this.store=e,this.editPaintService=t,this.ngUnsubscribe=new c.a}ngOnInit(){}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}handleRecipeClick(e){const t=Hi.a.fromEngine(e);this.store.dispatch(new Gi.d),this.store.dispatch(new Gi.h(t)),this.store.dispatch(new D.w(Q.a.Paint))}handleExport(e){const t=this.store.selectSnapshot(y.a.getStory).displayName||"Story Palette",i=this.store.selectSnapshot(Wi.a.getUniqueStoryRecipes).map(e=>Hi.a.fromEngine(e)),n=new kl(t);n.recipes=i,"copy"===e?this.editPaintService.copyPaletteToClipboard(n):this.editPaintService.downloadPalette(n)}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(r.h),ae.Pb(Rl))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-paint-currently-used"]],decls:33,vars:21,consts:[["toggleType","arrow",3,"noPadding","open"],["panel-label","",1,"text-semibold","ph-3","pv-2"],[1,"text-semibold","flex","items-center",2,"min-height","36px"],["panel-actions","","appEventFence","",1,"pv-2"],["app-button","",3,"matMenuTriggerFor"],["icon","ellipsis-v"],[1,"ph-3","pb-2"],["tabSize","small","tabTheme","dark"],["label","This Model"],[1,"paint-currently-used","ph-1"],["app-paint-swatch","","class","mr-2 mb-2",3,"engineRecipe","click",4,"ngFor","ngForOf"],["class","p-2",4,"ngIf"],["label","This Chapter"],["label","Recent"],["menu","matMenu"],["mat-menu-item","",3,"click"],["app-paint-swatch","",1,"mr-2","mb-2",3,"engineRecipe","click"],[1,"p-2"],[1,"text-10","text-dim","text-italic"]],template:function(e,t){if(1&e&&(ae.Vb(0,"app-panel",0),ae.Vb(1,"div",1),ae.Vb(2,"div",2),ae.Pc(3,"Recent"),ae.Ub(),ae.Ub(),ae.Vb(4,"div",3),ae.Vb(5,"button",4),ae.Qb(6,"app-icon",5),ae.Ub(),ae.Ub(),ae.Vb(7,"div",6),ae.Vb(8,"app-tabs",7),ae.Vb(9,"app-tab",8),ae.Vb(10,"div",9),ae.Nc(11,$l,1,1,"button",10),ae.hc(12,"async"),ae.Ub(),ae.Nc(13,ql,3,0,"div",11),ae.hc(14,"async"),ae.Ub(),ae.Vb(15,"app-tab",12),ae.Vb(16,"div",9),ae.Nc(17,Gl,1,1,"button",10),ae.hc(18,"async"),ae.Ub(),ae.Nc(19,Hl,3,0,"div",11),ae.hc(20,"async"),ae.Ub(),ae.Vb(21,"app-tab",13),ae.Vb(22,"div",9),ae.Nc(23,Wl,1,1,"button",10),ae.hc(24,"async"),ae.Ub(),ae.Nc(25,Kl,3,0,"div",11),ae.hc(26,"async"),ae.Ub(),ae.Ub(),ae.Ub(),ae.Ub(),ae.Vb(27,"mat-menu",null,14),ae.Vb(29,"button",15),ae.cc("click",(function(){return t.handleExport("copy")})),ae.Pc(30," Copy this model's palette to clipboard "),ae.Ub(),ae.Vb(31,"button",15),ae.cc("click",(function(){return t.handleExport("download")})),ae.Pc(32,"Download this model's palette"),ae.Ub(),ae.Ub()),2&e){const e=ae.yc(28);let i=null,n=null,o=null;ae.mc("noPadding",!0)("open",!0),ae.Db(5),ae.mc("matMenuTriggerFor",e),ae.Db(6),ae.mc("ngForOf",ae.ic(12,9,t.uniqueStoryRecipes$)),ae.Db(2),ae.mc("ngIf",!(null!=(i=ae.ic(14,11,t.uniqueStoryRecipes$))&&i.length)),ae.Db(4),ae.mc("ngForOf",ae.ic(18,13,t.chapterRecipes$)),ae.Db(2),ae.mc("ngIf",!(null!=(n=ae.ic(20,15,t.chapterRecipes$))&&n.length)),ae.Db(4),ae.mc("ngForOf",ae.ic(24,17,t.recentRecipes$)),ae.Db(2),ae.mc("ngIf",!(null!=(o=ae.ic(26,19,t.recentRecipes$))&&o.length))}},directives:[be.a,Ll.a,pe.a,Sn.d,at.a,Yn.a,eo.a,n.o,n.p,Sn.a,Sn.b,El],pipes:[n.b],styles:[".paint-currently-used[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}"],changeDetection:0}),Bl([Object(r.e)(Wi.a.getRecentRecipes),Ql("design:type",m.a)],e.prototype,"recentRecipes$",void 0),Bl([Object(r.e)(Wi.a.getUniqueStoryRecipes),Ql("design:type",m.a)],e.prototype,"uniqueStoryRecipes$",void 0),Bl([Object(r.e)(Wi.a.getCurrentChapterRecipes),Ql("design:type",m.a)],e.prototype,"chapterRecipes$",void 0),e})();function Xl(e,t){if(1&e&&(ae.Vb(0,"tr"),ae.Vb(1,"td",6),ae.Pc(2),ae.Ub(),ae.Ub()),2&e){const e=ae.gc();ae.Db(2),ae.Qc(e.recipe.label)}}function Zl(e,t){if(1&e&&(ae.Vb(0,"tr"),ae.Vb(1,"td",7),ae.Pc(2),ae.Ub(),ae.Vb(3,"td",8),ae.Pc(4),ae.Ub(),ae.Ub()),2&e){const e=t.$implicit;ae.Db(2),ae.Qc(e.label),ae.Db(2),ae.Qc(e.value)}}let Yl=(()=>{class e{constructor(){this.values=[]}get recipe(){return this._recipe}set recipe(e){this._recipe=e,this.values=this.recipe?this.getValues(this.recipe):[]}ngOnInit(){}getValues(e){return[{label:"Color",value:Ml(e.tintColor)},{label:"Saturation",value:Ml(e.saturation)},{label:"Contrast",value:Ml(e.contrast)},{label:"Brightness",value:Ml(e.brightness)},{label:"Opacity",value:Ml(e.opacity)}].filter(e=>""!=e.value)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-edit-recipe-summary"]],inputs:{recipe:"recipe"},decls:6,vars:4,consts:[[1,"edit-recipe-summary"],["size","large",3,"recipe","highlightSelected"],[1,"edit-recipe-summary__details"],[1,"w-100"],[4,"ngIf"],[4,"ngFor","ngForOf"],["colspan","2",1,"ph-2","pb-1","text-italic"],[1,"ph-2","pb-1","w-50","text-semibold"],[1,"ph-1","pb-1","w-50"]],template:function(e,t){1&e&&(ae.Vb(0,"div",0),ae.Qb(1,"app-paint-swatch",1),ae.Vb(2,"div",2),ae.Vb(3,"table",3),ae.Nc(4,Xl,3,1,"tr",4),ae.Nc(5,Zl,5,2,"tr",5),ae.Ub(),ae.Ub(),ae.Ub()),2&e&&(ae.Db(1),ae.mc("recipe",t.recipe)("highlightSelected",!1),ae.Db(3),ae.mc("ngIf",t.recipe.label),ae.Db(1),ae.mc("ngForOf",t.values))},directives:[El,n.p,n.o],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.edit-recipe-summary[_ngcontent-%COMP%]{color:#fff;display:flex;padding:8px 0;align-items:flex-start;font-size:10px;letter-spacing:.25px;line-height:1.4em}.edit-recipe-summary__details[_ngcontent-%COMP%]{flex-grow:1;max-height:160px;overflow-y:auto}.theme-light[_nghost-%COMP%]   .edit-recipe-summary[_ngcontent-%COMP%], .theme-light   [_nghost-%COMP%]   .edit-recipe-summary[_ngcontent-%COMP%]{color:#101823}"],changeDetection:0}),e})();var ep=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function tp(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"button",10),ae.cc("click",(function(){ae.Cc(e);const i=t.$implicit;return ae.gc().handleAddToPalette(i)})),ae.Pc(1),ae.Ub()}if(2&e){const e=t.$implicit;ae.Db(1),ae.Rc(" Add to ",e.label," ")}}function ip(e,t){1&e&&ae.Qb(0,"mat-divider")}let np=(()=>{class e{constructor(e,t,i,n){this.store=e,this.dialog=t,this.snackbar=i,this.editService=n,this.ngUnsubscribe=new c.a}get recipe(){return this._recipe}set recipe(e){this._recipe=e}ngOnInit(){}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}handleAddToPalette(e){this.store.dispatch(new Gi.c(this.recipe,e.id)),this.store.dispatch(new Gi.m(e.id,!0)),this.snackbar.open(`Successfully added to '${e.label}' palette.`)}handleNewPalette(){const e=new kl;e.recipes.push(this.recipe),this.dialog.open(Nl,{width:"480px",data:{palette:e}}).afterClosed().pipe(Object(P.a)(this.ngUnsubscribe),Object(O.a)(e=>!Object(W.isNil)(e))).subscribe(e=>{this.store.dispatch(new Gi.a(e))})}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(r.h),ae.Pb(H.b),ae.Pb(le.b),ae.Pb(yo))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-edit-paint-panel"]],inputs:{recipe:"recipe"},decls:13,vars:8,consts:[[1,"edit-paint-panel"],[1,"flex-grow",3,"recipe"],[1,"flex","flex-column"],["app-button","","buttonType","outline","buttonSize","small","matTooltip","Add to Palette","matTooltipPosition","above","data-test","addToPaletteButton",1,"pb-2",3,"matMenuTriggerFor"],["icon","plus"],["yPosition","above"],["paletteMenu","matMenu"],["mat-menu-item","","data-test","addToExistingPalette",3,"click",4,"ngFor","ngForOf"],[4,"ngIf"],["mat-menu-item","","data-test","addPaintToNewPaletteButton",3,"click"],["mat-menu-item","","data-test","addToExistingPalette",3,"click"]],template:function(e,t){if(1&e&&(ae.Vb(0,"div",0),ae.Qb(1,"app-edit-recipe-summary",1),ae.Vb(2,"div",2),ae.Vb(3,"button",3),ae.Qb(4,"app-icon",4),ae.Ub(),ae.Ub(),ae.Ub(),ae.Vb(5,"mat-menu",5,6),ae.Nc(7,tp,2,1,"button",7),ae.hc(8,"async"),ae.Nc(9,ip,1,0,"mat-divider",8),ae.hc(10,"async"),ae.Vb(11,"button",9),ae.cc("click",(function(){return t.handleNewPalette()})),ae.Pc(12," Add to New Palette... "),ae.Ub(),ae.Ub()),2&e){const e=ae.yc(6);let i=null;ae.Db(1),ae.mc("recipe",t.recipe),ae.Db(2),ae.mc("matMenuTriggerFor",e),ae.Db(4),ae.mc("ngForOf",ae.ic(8,4,t.palettes$)),ae.Db(2),ae.mc("ngIf",null==(i=ae.ic(10,6,t.palettes$))?null:i.length)}},directives:[Yl,pe.a,st.c,Sn.d,at.a,Sn.a,n.o,n.p,Sn.b,me.a],pipes:[n.b],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.edit-paint-panel[_ngcontent-%COMP%]{color:#fff;display:flex;padding:8px 0;align-items:flex-start}.edit-paint-panel__list[_ngcontent-%COMP%]{flex-grow:1;padding:0 8px;font-size:10px;letter-spacing:.25px;line-height:1.4em;-moz-column-count:2;-moz-column-gap:8px;column-gap:8px;-moz-column-width:50%;columns:50% 2}.edit-paint-panel__item[_ngcontent-%COMP%]{padding-bottom:4px}"],changeDetection:0}),function(e,t,i,n){var o,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,i,r):o(t,i))||r);a>3&&r&&Object.defineProperty(t,i,r)}([Object(r.e)(Wi.a.getPalettes),ep("design:type",m.a)],e.prototype,"palettes$",void 0),e})();function op(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"button",13),ae.cc("click",(function(){ae.Cc(e);const i=t.$implicit;return ae.gc().handleRecipeClick(i)})),ae.Ub()}if(2&e){const e=t.$implicit;ae.mc("label",e.label)("recipe",e)}}let ap=(()=>{class e{constructor(e,t,i){this.dialog=e,this.store=t,this.editPaintService=i,this.ngUnsubscribe=new c.a}get palette(){return this._palette}set palette(e){this._palette=e}ngOnInit(){}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}handleEdit(e){this.dialog.open(Nl,{width:"480px",data:{palette:e}}).afterClosed().pipe(Object(P.a)(this.ngUnsubscribe),Object(O.a)(e=>!Object(W.isNil)(e))).subscribe(e=>{this.store.dispatch(new Gi.n(e))})}handleRemove(e){this.editPaintService.removePalette(e)}handleExport(e){this.editPaintService.copyPaletteToClipboard(e)}handleDownload(e){this.editPaintService.downloadPalette(e)}handlePanelOpened(e,t){const i=this.store.selectSnapshot(Wi.a.getPalettes),n=i.findIndex(e=>e.id===t);n>=0&&(i[n].open=e),this.store.dispatch(new Gi.j(i))}handleRecipeClick(e){this.editPaintService.selectRecipe(e)}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(H.b),ae.Pb(r.h),ae.Pb(Rl))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-edit-palette-panel"]],inputs:{palette:"palette"},decls:20,vars:6,consts:[["toggleType","arrow","data-test","palettePanel",3,"open","noPadding","opened"],["panel-label","",1,"text-semibold","ph-3","pv-2"],["data-test","palettePanelLabel"],["panel-actions","","appEventFence","",1,"pv-2"],["app-button","","data-test","palettePanelMenuButton",3,"matMenuTriggerFor"],["icon","ellipsis-v"],[1,"flex","flex-wrap","ph-3","pb-2"],["app-paint-swatch","","class","mr-2 mb-2",3,"label","recipe","click",4,"ngFor","ngForOf"],["menu","matMenu"],["mat-menu-item","","data-test","palettePanelEditButton",3,"click"],["mat-menu-item","","data-test","palettePanelRemoveButton",3,"click"],["mat-menu-item","","data-test","palettePanelCopyButton",3,"click"],["mat-menu-item","","data-test","palettePanelDownloadButton",3,"click"],["app-paint-swatch","",1,"mr-2","mb-2",3,"label","recipe","click"]],template:function(e,t){if(1&e&&(ae.Vb(0,"app-panel",0),ae.cc("opened",(function(e){return t.handlePanelOpened(e,t.palette.id)})),ae.Vb(1,"div",1),ae.Vb(2,"span",2),ae.Pc(3),ae.Ub(),ae.Ub(),ae.Vb(4,"div",3),ae.Vb(5,"button",4),ae.Qb(6,"app-icon",5),ae.Ub(),ae.Ub(),ae.Vb(7,"div",6),ae.Nc(8,op,1,2,"button",7),ae.Ub(),ae.Ub(),ae.Vb(9,"mat-menu",null,8),ae.Vb(11,"button",9),ae.cc("click",(function(){return t.handleEdit(t.palette)})),ae.Pc(12," Manage Palette... "),ae.Ub(),ae.Vb(13,"button",10),ae.cc("click",(function(){return t.handleRemove(t.palette)})),ae.Pc(14," Remove... "),ae.Ub(),ae.Qb(15,"mat-divider"),ae.Vb(16,"button",11),ae.cc("click",(function(){return t.handleExport(t.palette)})),ae.Pc(17," Copy palette to clipboard "),ae.Ub(),ae.Vb(18,"button",12),ae.cc("click",(function(){return t.handleDownload(t.palette)})),ae.Pc(19," Download palette "),ae.Ub(),ae.Ub()),2&e){const e=ae.yc(10);ae.mc("open",t.palette.open)("noPadding",!0),ae.Eb("data-test-value",t.palette.id),ae.Db(3),ae.Qc(t.palette.label),ae.Db(2),ae.mc("matMenuTriggerFor",e),ae.Db(3),ae.mc("ngForOf",t.palette.recipes)}},directives:[be.a,Ll.a,pe.a,Sn.d,at.a,n.o,Sn.a,Sn.b,me.a,El],styles:[".palette__button[_ngcontent-%COMP%]{cursor:pointer;width:24px;height:24px;display:inline-flex;justify-content:center;align-items:center;background:none;border:none;margin:0;padding:0}"],changeDetection:0}),e})();var rp=i("6eBy"),sp=i("Assa"),cp=i("mXx7");const lp={tintColor:[1,1,1],opacity:100,contrast:0,brightness:0,saturation:0};var pp=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function dp(e,t){1&e&&(ae.Vb(0,"div",10),ae.Vb(1,"span",11),ae.Pc(2,"Note:"),ae.Ub(),ae.Pc(3," The preset you have selected contains some settings that cannot be customized. "),ae.Ub())}function up(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"app-form-field",12),ae.Vb(1,"input",13),ae.cc("colorPickerChange",(function(t){return ae.Cc(e),ae.gc().handleColorPickerChange(t)})),ae.Ub(),ae.Ub()}if(2&e){const e=ae.gc();ae.Db(1),ae.Kc("background",e.colorPickerHex),ae.mc("colorPicker",e.colorPickerHex)("cpOutputFormat","hex")("cpAlphaChannel","disabled")}}function hp(e,t){1&e&&(ae.Vb(0,"app-form-field",14),ae.Qb(1,"app-slider",15),ae.Ub()),2&e&&(ae.Db(1),ae.mc("min",0)("max",100))}let mp=(()=>{class e{constructor(e,t,i){this.formBuilder=e,this.store=t,this.changeDetector=i,this.colorPickerHex="#ffffff",this.fresnelColor=!1,this.fresnelOpacity=!1,this.ngUnsubscribe=new c.a,this.form=this.formBuilder.group({tintColor:[[...lp.tintColor]],saturation:[lp.saturation],contrast:[lp.contrast],brightness:[lp.brightness],opacity:[lp.opacity]})}ngOnInit(){this.colorRecipe$.pipe(Object(O.a)(e=>null!=e&&JSON.stringify(e)!==JSON.stringify(this.colorRecipe),Object(P.a)(this.ngUnsubscribe))).subscribe(e=>{this.colorRecipe=e,this.fresnelColor=e.tintColor instanceof sp.a,this.fresnelOpacity=e.opacity instanceof cp.a,this.setFormValues(e),this.changeDetector.markForCheck()}),this.form.valueChanges.pipe(Object(rp.a)(()=>Object(h.a)(300)),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.handleFormChanges(e)})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}setFormValues(e){let t=lp.tintColor;Array.isArray(e.tintColor)&&(this.colorPickerHex=Z.a.rgbToHex(e.tintColor,!0),t=e.tintColor);let i=lp.opacity;"number"==typeof e.opacity&&(i=e.opacity);let n=lp.contrast;"number"==typeof e.contrast&&(n=e.contrast);let o=lp.brightness;"number"==typeof e.brightness&&(o=e.brightness);let a=lp.saturation;"number"==typeof e.saturation&&(a=e.saturation),this.form.setValue({tintColor:t,saturation:a,contrast:n,brightness:o,opacity:i},{emitEvent:!1,onlySelf:!0})}handleFormChanges(e){const t=Object.assign({},this.colorRecipe);t.saturation=e.saturation,t.brightness=e.brightness,t.contrast=e.contrast,this.fresnelOpacity||(t.opacity=e.opacity),this.fresnelColor||(t.tintColor="string"==typeof e.tintColor?Z.a.hexToRgb(e.tintColor,!0):e.tintColor),this.store.dispatch(new Gi.h(t))}handleColorPickerChange(e){this.colorPickerHex=e,this.form.patchValue({tintColor:Z.a.hexToRgb(e,!0)})}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(G.f),ae.Pb(r.h),ae.Pb(ae.i))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-paint-widget"]],inputs:{label:"label"},decls:10,vars:10,consts:[["autocomplete","off",3,"formGroup"],["class","text-dim text-12 pb-4",4,"ngIf"],["label","Color",4,"ngIf"],["label","Saturation"],["formControlName","saturation",3,"min","max"],["label","Contrast"],["formControlName","contrast",3,"min","max"],["label","Brightness"],["formControlName","brightness",3,"min","max"],["label","Opacity",4,"ngIf"],[1,"text-dim","text-12","pb-4"],[1,"text-bold"],["label","Color"],["type","text","cpPosition","left",1,"input",3,"colorPicker","cpOutputFormat","cpAlphaChannel","colorPickerChange"],["label","Opacity"],["formControlName","opacity",3,"min","max"]],template:function(e,t){1&e&&(ae.Vb(0,"form",0),ae.Nc(1,dp,4,0,"div",1),ae.Nc(2,up,2,5,"app-form-field",2),ae.Vb(3,"app-form-field",3),ae.Qb(4,"app-slider",4),ae.Ub(),ae.Vb(5,"app-form-field",5),ae.Qb(6,"app-slider",6),ae.Ub(),ae.Vb(7,"app-form-field",7),ae.Qb(8,"app-slider",8),ae.Ub(),ae.Nc(9,hp,2,2,"app-form-field",9),ae.Ub()),2&e&&(ae.mc("formGroup",t.form),ae.Db(1),ae.mc("ngIf",t.fresnelColor||t.fresnelOpacity),ae.Db(1),ae.mc("ngIf",!t.fresnelColor),ae.Db(2),ae.mc("min",-100)("max",100),ae.Db(2),ae.mc("min",-100)("max",100),ae.Db(2),ae.mc("min",-100)("max",100),ae.Db(1),ae.mc("ngIf",!t.fresnelOpacity))},directives:[G.E,G.s,G.j,n.p,de.a,io.a,G.r,G.i,ht.a],styles:[""],changeDetection:0}),function(e,t,i,n){var o,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,i,r):o(t,i))||r);a>3&&r&&Object.defineProperty(t,i,r)}([Object(r.e)(Wi.a.getCurrentRecipe),pp("design:type",m.a)],e.prototype,"colorRecipe$",void 0),e})();const bp=["tabsEl"];function gp(e,t){if(1&e&&(ae.Tb(0),ae.Vb(1,"app-form-field",14),ae.Qb(2,"app-slider",15),ae.Ub(),ae.Sb()),2&e){const e=ae.gc();ae.Db(2),ae.mc("min",e.min)("max",e.max)}}function fp(e,t){1&e&&(ae.Tb(0),ae.Vb(1,"app-form-field",16),ae.Qb(2,"app-color-picker-input",17),ae.Ub(),ae.Sb())}function xp(e,t){if(1&e&&(ae.Tb(0),ae.Vb(1,"app-form-field",18),ae.Qb(2,"app-slider",15),ae.Ub(),ae.Vb(3,"app-form-field",19),ae.Qb(4,"app-slider",15),ae.Ub(),ae.Sb()),2&e){const e=ae.gc();ae.Db(2),ae.mc("min",e.fresnelMin)("max",e.fresnelMax),ae.Db(2),ae.mc("min",e.fresnelMin)("max",e.fresnelMax)}}function yp(e,t){1&e&&(ae.Tb(0),ae.Vb(1,"app-form-field",18),ae.Qb(2,"app-color-picker-input",17),ae.Ub(),ae.Vb(3,"app-form-field",19),ae.Qb(4,"app-color-picker-input",17),ae.Ub(),ae.Sb())}let vp=(()=>{class e{constructor(e){this.formBuilder=e,this.min=0,this.max=100,this.fresnelMin=0,this.fresnelMax=100,this._value=null,this.simpleMode="number",this.fresnelMode="scalar",this.valueUpdated=new ae.p,this._colorMode="numeric",this.ngUnsubscribe=new c.a,this.form=this.formBuilder.group({numericValue:[0],hexValue:["#ff0000"],fresnel:this.formBuilder.group({center:this.formBuilder.group({numericValue:[100],hexValue:["#ff0000"]}),edge:this.formBuilder.group({numericValue:[0],hexValue:["#0000ff"]}),centerBias:[100],edgeBias:[0],power:[1]})})}get value(){return this._value}set value(e){Object(W.isEqual)(e,this.value)||(this._value=e,this.setFormValues(e))}get colorMode(){return this._colorMode}set colorMode(e){this._colorMode=e}ngOnInit(){this.form.valueChanges.pipe(Object(pi.a)(300),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.emitCurrentValue()})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}setFormValues(e){"number"==typeof e?(this.setSimpleValues(e),this.colorMode="numeric"):Array.isArray(e)?(this.setRGBValues(e),this.colorMode="numeric"):Hi.a.isFresnel(e)&&(Array.isArray(e.center)?this.setColorFresnesValues(e):this.setScalarFresnesValues(e),this.colorMode="fresnel")}setSimpleValues(e){this.form.patchValue({numericValue:e},{emitEvent:!1,onlySelf:!0})}setRGBValues(e){const t=Z.a.rgbToHex(e,!0);this.form.patchValue({hexValue:t},{emitEvent:!1,onlySelf:!0})}setScalarFresnesValues(e){const{edge:t,center:i,edgeBias:n,centerBias:o,power:a}=e;this.form.patchValue({fresnel:{edge:{numericValue:100*t},center:{numericValue:100*i},edgeBias:100*n,centerBias:100*o,power:a}},{emitEvent:!1,onlySelf:!0})}setColorFresnesValues(e){const{edge:t,center:i,centerBias:n,edgeBias:o,power:a}=e,r=Z.a.rgbToHex(t,!0),s=Z.a.rgbToHex(i,!0);this.form.patchValue({fresnel:{edge:{hexValue:r},center:{hexValue:s},edgeBias:100*o,centerBias:100*n,power:a}},{emitEvent:!1,onlySelf:!0})}setColorMode(e){this.colorMode=0===e?"numeric":"fresnel",this.emitCurrentValue()}emitCurrentValue(){const e=this.getColorValue();this.valueUpdated.emit(e)}getColorValue(){const e=this.form.value;switch(this.colorMode){case"fresnel":return"color"===this.fresnelMode?this.getColorFresnelValue(e):this.getSclarFresnelValue(e);case"numeric":default:return"number"===this.simpleMode?this.getSimpleValue(e):this.getRGBValue(e)}}getSimpleValue(e){const{numericValue:t}=e;return t}getRGBValue(e){const{hexValue:t}=e;return Z.a.hexToRgb(t,!0)}getColorFresnelValue(e){const{fresnel:t}=e,{edge:i,center:n,edgeBias:o,centerBias:a,power:r}=t,s=Z.a.hexToRgb(i.hexValue,!0),c=Z.a.hexToRgb(n.hexValue,!0);return new sp.a({edge:s,center:c,edgeBias:o/100,centerBias:a/100,power:r})}getSclarFresnelValue(e){const{fresnel:t}=e,{edge:i,center:n,centerBias:o,edgeBias:a,power:r}=t;return new cp.a({edge:i.numericValue/100,center:n.numericValue/100,centerBias:o/100,edgeBias:a/100,power:r})}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(G.f))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-paint-recipe"]],viewQuery:function(e,t){if(1&e&&ae.Jc(bp,!0),2&e){let e;ae.xc(e=ae.dc())&&(t.tabs=e.first)}},inputs:{min:"min",max:"max",fresnelMin:"fresnelMin",fresnelMax:"fresnelMax",value:"value",simpleMode:"simpleMode",fresnelMode:"fresnelMode"},outputs:{valueUpdated:"valueUpdated"},decls:17,vars:14,consts:[[1,"recipe",3,"formGroup"],["tabSize","small","tabTheme","dark",3,"activeTab","activeTabChange"],["tabsEl",""],["label","Simple",3,"ngSwitch"],[1,"pt-2","pl-1"],[4,"ngSwitchCase"],["label","Advanced",3,"ngSwitch"],["formGroupName","fresnel",1,"pt-2","pl-1"],["label","Center Bias"],["formControlName","centerBias",3,"min","max"],["label","Edge Bias"],["formControlName","edgeBias",3,"min","max"],["label","Power"],["formControlName","power",3,"min","max"],["label","Value"],["formControlName","numericValue",3,"min","max"],["label","Color"],["formControlName","hexValue"],["label","Center","formGroupName","center"],["label","Edge","formGroupName","edge"]],template:function(e,t){1&e&&(ae.Vb(0,"form",0),ae.Vb(1,"app-tabs",1,2),ae.cc("activeTabChange",(function(e){return t.setColorMode(e)})),ae.Vb(3,"app-tab",3),ae.Vb(4,"div",4),ae.Nc(5,gp,3,2,"ng-container",5),ae.Nc(6,fp,3,0,"ng-container",5),ae.Ub(),ae.Ub(),ae.Vb(7,"app-tab",6),ae.Vb(8,"div",7),ae.Nc(9,xp,5,4,"ng-container",5),ae.Nc(10,yp,5,0,"ng-container",5),ae.Vb(11,"app-form-field",8),ae.Qb(12,"app-slider",9),ae.Ub(),ae.Vb(13,"app-form-field",10),ae.Qb(14,"app-slider",11),ae.Ub(),ae.Vb(15,"app-form-field",12),ae.Qb(16,"app-slider",13),ae.Ub(),ae.Ub(),ae.Ub(),ae.Ub(),ae.Ub()),2&e&&(ae.mc("formGroup",t.form),ae.Db(1),ae.mc("activeTab","numeric"===t.colorMode?0:1),ae.Db(2),ae.mc("ngSwitch",t.simpleMode),ae.Db(2),ae.mc("ngSwitchCase","number"),ae.Db(1),ae.mc("ngSwitchCase","rgb"),ae.Db(1),ae.mc("ngSwitch",t.fresnelMode),ae.Db(2),ae.mc("ngSwitchCase","scalar"),ae.Db(1),ae.mc("ngSwitchCase","color"),ae.Db(2),ae.mc("min",0)("max",100),ae.Db(2),ae.mc("min",0)("max",100),ae.Db(2),ae.mc("min",1)("max",5))},directives:[G.E,G.s,G.j,Yn.a,eo.a,n.r,n.s,G.k,de.a,io.a,G.r,G.i,mt],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.recipe__heading[_ngcontent-%COMP%]{margin-top:4px;margin-bottom:4px;font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase;font-weight:700;color:#96a8c0}.theme-light[_nghost-%COMP%]   .recipe__heading[_ngcontent-%COMP%], .theme-light   [_nghost-%COMP%]   .recipe__heading[_ngcontent-%COMP%]{color:1px solid #374a68}.recipe__group[_ngcontent-%COMP%]{padding-top:4px;padding-bottom:4px;border-top:1px solid #1c2a3f}.theme-light[_nghost-%COMP%]   .recipe__group[_ngcontent-%COMP%], .theme-light   [_nghost-%COMP%]   .recipe__group[_ngcontent-%COMP%]{border-top:1px solid #eaeff5}"],changeDetection:0}),e})();var Cp=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const Pp=["tintColorRef"],Op=["saturationRef"],wp=["contrastRef"],kp=["brightnessRef"],Sp=["opacityRef"];let _p=(()=>{class e{constructor(e,t,i){this.formBuilder=e,this.store=t,this.changeDetector=i,this.colorRecipe=new Hi.a,this.paintBrushMode=Ol.a,this.ngUnsubscribe=new c.a;const{tintColor:n,saturation:o,contrast:a,brightness:r,opacity:s}=this.store.selectSnapshot(Wi.a.getCurrentRecipe),l=this.store.selectSnapshot(Wi.a.getPaintBrushMode);this.form=this.formBuilder.group({tintColorEnabled:this.isColorValueEnabled(n),saturationEnabled:this.isColorValueEnabled(o),contrastEnabled:this.isColorValueEnabled(a),brightnessEnabled:this.isColorValueEnabled(r),opacityEnabled:this.isColorValueEnabled(s),paintBrushMode:l})}ngOnInit(){this.colorRecipe$.pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.colorRecipe=e,this.changeDetector.markForCheck()}),this.form.valueChanges.pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.handleFormChanges(e)})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}handleFormChanges(e){this.handleRecipeUpdates({tintColor:this.tintColorRef.value,saturation:this.saturationRef.value,contrast:this.contrastRef.value,brightness:this.brightnessRef.value,opacity:this.opacityRef.value}),this.store.dispatch(new Gi.i(e.paintBrushMode))}handleTintColorUpdates(e){this.colorRecipe=Object.assign(Object.assign({},this.colorRecipe),{tintColor:e}),this.isFeatureEnabled("tintColor")&&this.handleRecipeUpdates(this.colorRecipe)}handleOpacityUpdates(e){this.colorRecipe=Object.assign(Object.assign({},this.colorRecipe),{opacity:e}),this.isFeatureEnabled("opacity")&&this.handleRecipeUpdates(this.colorRecipe)}handleContrastUpdates(e){this.colorRecipe=Object.assign(Object.assign({},this.colorRecipe),{contrast:e}),this.isFeatureEnabled("contrast")&&this.handleRecipeUpdates(this.colorRecipe)}handleBrightnessUpdates(e){this.colorRecipe=Object.assign(Object.assign({},this.colorRecipe),{brightness:e}),this.isFeatureEnabled("brightness")&&this.handleRecipeUpdates(this.colorRecipe)}handleSaturationUpdates(e){this.colorRecipe=Object.assign(Object.assign({},this.colorRecipe),{saturation:e}),this.isFeatureEnabled("saturation")&&this.handleRecipeUpdates(this.colorRecipe)}handleRecipeUpdates(e){const t=this.store.selectSnapshot(Wi.a.getCurrentRecipe),{tintColor:i,saturation:n,contrast:o,brightness:a,opacity:r}=e,s={tintColor:this.isFeatureEnabled("tintColor")?i||[1,0,0]:void 0,saturation:this.isFeatureEnabled("saturation")?n||0:void 0,contrast:this.isFeatureEnabled("contrast")?o||0:void 0,brightness:this.isFeatureEnabled("brightness")?a||0:void 0,opacity:this.isFeatureEnabled("opacity")?r||100:void 0};Object(W.isEqual)(s,t)||this.store.dispatch(new Gi.h(s))}isFeatureEnabled(e){return!0===this.form.get(e+"Enabled").value}isColorValueEnabled(e){return!Object(W.isNil)(e)&&!1!==e}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(G.f),ae.Pb(r.h),ae.Pb(ae.i))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-paint-widget-advanced"]],viewQuery:function(e,t){if(1&e&&(ae.Jc(Pp,!0),ae.Jc(Op,!0),ae.Jc(wp,!0),ae.Jc(kp,!0),ae.Jc(Sp,!0)),2&e){let e;ae.xc(e=ae.dc())&&(t.tintColorRef=e.first),ae.xc(e=ae.dc())&&(t.saturationRef=e.first),ae.xc(e=ae.dc())&&(t.contrastRef=e.first),ae.xc(e=ae.dc())&&(t.brightnessRef=e.first),ae.xc(e=ae.dc())&&(t.opacityRef=e.first)}},inputs:{label:"label"},decls:16,vars:26,consts:[["autocomplete","off",3,"formGroup"],["label","Color","toggleType","checkbox","formControlName","tintColorEnabled"],["simpleMode","rgb","fresnelMode","color",3,"value","min","max","fresnelMin","fresnelMax","valueUpdated"],["tintColorRef",""],["label","Saturation","toggleType","checkbox","formControlName","saturationEnabled"],[3,"value","min","max","fresnelMin","fresnelMax","valueUpdated"],["saturationRef",""],["label","Contrast","toggleType","checkbox","formControlName","contrastEnabled"],["contrastRef",""],["label","Brightness","toggleType","checkbox","formControlName","brightnessEnabled"],["brightnessRef",""],["label","Opacity","toggleType","checkbox","formControlName","opacityEnabled"],["opacityRef",""]],template:function(e,t){1&e&&(ae.Vb(0,"form",0),ae.Vb(1,"app-panel",1),ae.Vb(2,"app-paint-recipe",2,3),ae.cc("valueUpdated",(function(e){return t.handleTintColorUpdates(e)})),ae.Ub(),ae.Ub(),ae.Vb(4,"app-panel",4),ae.Vb(5,"app-paint-recipe",5,6),ae.cc("valueUpdated",(function(e){return t.handleSaturationUpdates(e)})),ae.Ub(),ae.Ub(),ae.Vb(7,"app-panel",7),ae.Vb(8,"app-paint-recipe",5,8),ae.cc("valueUpdated",(function(e){return t.handleContrastUpdates(e)})),ae.Ub(),ae.Ub(),ae.Vb(10,"app-panel",9),ae.Vb(11,"app-paint-recipe",5,10),ae.cc("valueUpdated",(function(e){return t.handleBrightnessUpdates(e)})),ae.Ub(),ae.Ub(),ae.Vb(13,"app-panel",11),ae.Vb(14,"app-paint-recipe",5,12),ae.cc("valueUpdated",(function(e){return t.handleOpacityUpdates(e)})),ae.Ub(),ae.Ub(),ae.Ub()),2&e&&(ae.mc("formGroup",t.form),ae.Db(2),ae.mc("value",t.colorRecipe.tintColor)("min",0)("max",255)("fresnelMin",0)("fresnelMax",100),ae.Db(3),ae.mc("value",t.colorRecipe.saturation)("min",-100)("max",100)("fresnelMin",-100)("fresnelMax",100),ae.Db(3),ae.mc("value",t.colorRecipe.contrast)("min",-100)("max",100)("fresnelMin",-100)("fresnelMax",100),ae.Db(3),ae.mc("value",t.colorRecipe.brightness)("min",-100)("max",100)("fresnelMin",-100)("fresnelMax",100),ae.Db(3),ae.mc("value",t.colorRecipe.opacity)("min",0)("max",100)("fresnelMin",0)("fresnelMax",100))},directives:[G.E,G.s,G.j,be.a,G.r,G.i,vp],styles:[""],changeDetection:0}),function(e,t,i,n){var o,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,i,r):o(t,i))||r);a>3&&r&&Object.defineProperty(t,i,r)}([Object(r.e)(Wi.a.getCurrentRecipe),Cp("design:type",m.a)],e.prototype,"colorRecipe$",void 0),e})();function Mp(e,t){1&e&&(ae.Vb(0,"span"),ae.Pc(1,"structure"),ae.Ub())}function Up(e,t){1&e&&(ae.Vb(0,"span"),ae.Pc(1,"structures"),ae.Ub())}let Tp=(()=>{class e{constructor(e,t){this.store=e,this.changeDetector=t,this.ngUnsubscribe=new c.a}ngOnInit(){this.store.select($t.a.getCheckedNodeIds).pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.count=e.length,this.changeDetector.markForCheck()})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}handleClearClick(){this.store.dispatch(new Xt.a.UpdateNodesChecked(!1))}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(r.h),ae.Pb(ae.i))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-selected-nodes-panel"]],decls:10,vars:5,consts:[[1,"panel","text-11","text-uppercase"],[1,"panel__count"],[4,"ngIf"],[1,"panel__clear"],["buttonSize","small","app-button","",3,"click"]],template:function(e,t){1&e&&(ae.Vb(0,"div",0),ae.Vb(1,"div",1),ae.Pc(2),ae.hc(3,"number"),ae.Nc(4,Mp,2,0,"span",2),ae.Nc(5,Up,2,0,"span",2),ae.Pc(6," selected "),ae.Ub(),ae.Vb(7,"div",3),ae.Vb(8,"button",4),ae.cc("click",(function(){return t.handleClearClick()})),ae.Pc(9,"Clear"),ae.Ub(),ae.Ub(),ae.Ub()),2&e&&(ae.Db(2),ae.Rc(" ",ae.ic(3,3,t.count)," "),ae.Db(2),ae.mc("ngIf",1===t.count),ae.Db(1),ae.mc("ngIf",t.count>1))},directives:[n.p,pe.a],pipes:[n.f],styles:[".panel[_ngcontent-%COMP%]{color:#fff;display:flex;padding:8px;justify-content:space-between;align-items:center}.panel__count[_ngcontent-%COMP%]{flex:1 0 auto}.panel__clear[_ngcontent-%COMP%]{flex:0 0 auto;opacity:.3}"],changeDetection:0}),e})();var Vp=function(e,t,i,n){var o,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,i,r):o(t,i))||r);return a>3&&r&&Object.defineProperty(t,i,r),r},Dp=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Ep(e,t){1&e&&ae.Qb(0,"app-edit-palette-panel",18),2&e&&ae.mc("palette",t.$implicit)}function jp(e,t){1&e&&ae.Qb(0,"app-paint-widget")}function Np(e,t){if(1&e&&(ae.Vb(0,"app-column-group",19,20),ae.Tb(2,11),ae.Vb(3,"div",21),ae.Nc(4,jp,1,0,"app-paint-widget",17),ae.Ub(),ae.Sb(),ae.Ub()),2&e){const e=ae.yc(1);ae.Db(4),ae.mc("ngIf",e.isActive)}}function Rp(e,t){1&e&&ae.Qb(0,"app-paint-widget-advanced")}function Ap(e,t){if(1&e&&(ae.Vb(0,"app-column-group",19,22),ae.Tb(2,11),ae.Nc(3,Rp,1,0,"app-paint-widget-advanced",17),ae.Sb(),ae.Ub()),2&e){const e=ae.yc(1);ae.Db(3),ae.mc("ngIf",e.isActive)}}function Fp(e,t){if(1&e){const e=ae.Wb();ae.Tb(0),ae.Qb(1,"app-selected-nodes-panel"),ae.Vb(2,"button",23),ae.cc("click",(function(){return ae.Cc(e),ae.gc().handlePaintNodesClick()})),ae.Pc(3," Apply Paint "),ae.Ub(),ae.Sb()}}let Ip=(()=>{class e{constructor(e,t,i,n){this.store=e,this.actions=t,this.changeDetector=i,this.editPaintService=n,this.activeToolEnum=Q.a,this.application=ne.a,this.ngUnsubscribe=new c.a}ngOnInit(){this.initInitialRecipe(),this.bindApplicationEvents()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initInitialRecipe(){null==this.store.selectSnapshot(Wi.a.getCurrentRecipe)&&this.store.dispatch(new Gi.h($o.d))}bindApplicationEvents(){this.actions.pipe(Object(r.l)(D.d),Object(O.a)(()=>{const e=this.store.selectSnapshot(x.a.getActiveTool);return[Q.a.Paint,Q.a.Eyedropper].includes(e)}),Object(O.a)(e=>null!=e.node&&!e.event.srcEvent.shiftKey),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{switch(this.store.selectSnapshot(x.a.getActiveTool)){case Q.a.Eyedropper:this.handleEyeDropperNodeClicked(e);break;case Q.a.Paint:this.handlePaintNodeClicked(e)}}),this.selectedChapter$.pipe(Object(O.a)(e=>null!=e),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.interactive=e.readyState.model,this.changeDetector.markForCheck()})}handleRecipeClick(e){this.editPaintService.selectRecipe(e)}handleClickTool(e){this.store.dispatch(new D.w(e))}handleClearChapterPaint(){const e=this.store.selectSnapshot($t.a.getNodeIds);this.paintNodes(e,$o.c)}handleImportPalette(){this.editPaintService.openImportPalette()}handlePaintNodesClick(){const e=this.store.selectSnapshot(Wi.a.getCurrentRecipe),t=this.store.selectSnapshot($t.a.getNodes),i=Object.values(t).reduce((t,i)=>(t[i.objectId]=i.checked?e:i.paint,t),{}),n=this.sanitizeRecipe(e);this.store.dispatch(new Xt.a.UpdateNodesPaint(n,void 0,i))}handleEyeDropperNodeClicked(e){const t=this.store.selectSnapshot($t.a.getNodePaint)(e.node.id),i=Hi.a.toEngine(t);qi.a.isRealRecipe(i)?this.store.dispatch(new Gi.h(t)):this.store.dispatch(new Gi.h($o.c))}handlePaintNodeClicked(e){const t=this.store.selectSnapshot(Wi.a.getCurrentRecipe);this.paintNodes([e.node.id],t)}paintNodes(e,t){this.store.dispatch(new Xt.a.UpdateNodesPaint(this.sanitizeRecipe(t),e))}sanitizeRecipe(e){const t=this.store.selectSnapshot(Wi.a.getPaintBrushMode),i=Object.assign({},e);return t===Ol.a.Replace&&Object.entries(i).forEach(([e,t])=>{void 0===t&&(i[e]=!1)}),i}handleNext(){this.store.dispatch(new g.b)}handlePrevious(){this.store.dispatch(new g.d)}handleEyedropperClick(){const e=this.store.selectSnapshot(x.a.getActiveTool)===Q.a.Eyedropper?Q.a.Paint:Q.a.Eyedropper;this.store.dispatch(new D.w(e))}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(r.h),ae.Pb(r.b),ae.Pb(ae.i),ae.Pb(Rl))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-edit-paint-context"]],decls:30,vars:16,consts:[[3,"loading"],["column-label",""],["column-actions",""],["app-button","",3,"selected","click"],["icon","eye-dropper"],["app-button","","data-test","paintMenuButton",1,"context__actions",3,"matMenuTriggerFor"],["icon","ellipsis-v"],["paintMenu","matMenu"],["mat-menu-item","",3,"click"],["mat-menu-item","","data-test","importPaletteButton",3,"click"],["label","Paints"],["column-group-body",""],[3,"palette",4,"ngFor","ngForOf"],["label","Customize",4,"appFlagApplication"],["column-footer",""],[1,"ph-4","pb-4"],[3,"recipe"],[4,"ngIf"],[3,"palette"],["label","Customize"],["customColorGroup",""],[1,"p-3"],["advancedColorGroup",""],["buttonType","outline","app-button","","data-test","applyPaintButton",1,"w-100","mt-2",3,"click"]],template:function(e,t){if(1&e&&(ae.Vb(0,"app-column",0),ae.Vb(1,"div",1),ae.Pc(2,"Paint"),ae.Ub(),ae.Vb(3,"div",2),ae.Vb(4,"button",3),ae.cc("click",(function(){return t.handleEyedropperClick()})),ae.hc(5,"async"),ae.Qb(6,"app-icon",4),ae.Ub(),ae.Vb(7,"button",5),ae.Qb(8,"app-icon",6),ae.Ub(),ae.Vb(9,"mat-menu",null,7),ae.Vb(11,"button",8),ae.cc("click",(function(){return t.handleClearChapterPaint()})),ae.Pc(12,"Clear this chapter's paint"),ae.Ub(),ae.Qb(13,"mat-divider"),ae.Vb(14,"button",9),ae.cc("click",(function(){return t.handleImportPalette()})),ae.Pc(15," Import Palette... "),ae.Ub(),ae.Ub(),ae.Ub(),ae.Vb(16,"app-column-group",10),ae.Tb(17,11),ae.Qb(18,"app-paint-presets"),ae.Qb(19,"app-paint-currently-used"),ae.Nc(20,Ep,1,1,"app-edit-palette-panel",12),ae.hc(21,"async"),ae.Sb(),ae.Ub(),ae.Nc(22,Np,5,1,"app-column-group",13),ae.Nc(23,Ap,4,1,"app-column-group",13),ae.Vb(24,"div",14),ae.Vb(25,"div",15),ae.Qb(26,"app-edit-paint-panel",16),ae.hc(27,"async"),ae.Nc(28,Fp,4,0,"ng-container",17),ae.hc(29,"async"),ae.Ub(),ae.Ub(),ae.Ub()),2&e){const e=ae.yc(10);let i=null;ae.mc("loading",!t.interactive),ae.Db(4),ae.mc("selected",ae.ic(5,8,t.activeTool$)===t.activeToolEnum.Eyedropper),ae.Db(3),ae.mc("matMenuTriggerFor",e),ae.Db(13),ae.mc("ngForOf",ae.ic(21,10,t.palettes$)),ae.Db(2),ae.mc("appFlagApplication",t.application.Studio),ae.Db(1),ae.mc("appFlagApplication",t.application.Loft),ae.Db(3),ae.mc("recipe",ae.ic(27,12,t.currentRecipe$)),ae.Db(2),ae.mc("ngIf",null==(i=ae.ic(29,14,t.checkedNodes$))?null:i.length)}},directives:[Kn,pe.a,at.a,Sn.d,Sn.a,Sn.b,me.a,Fn,zl,Jl,n.o,pt.a,np,n.p,ap,mp,_p,Tp],pipes:[n.b],styles:[""],changeDetection:0}),Vp([Object(r.e)(x.a.getActiveTool),Dp("design:type",m.a)],e.prototype,"activeTool$",void 0),Vp([Object(r.e)($t.a.getCheckedNodes),Dp("design:type",m.a)],e.prototype,"checkedNodes$",void 0),Vp([Object(r.e)(Wi.a.getCurrentRecipe),Dp("design:type",m.a)],e.prototype,"currentRecipe$",void 0),Vp([Object(r.e)(Wi.a.getPalettes),Dp("design:type",m.a)],e.prototype,"palettes$",void 0),Vp([Object(r.e)(F.a.getSelectedChapterId),Dp("design:type",m.a)],e.prototype,"selectedChapterId$",void 0),Vp([Object(r.e)(F.a.getSelectedChapter),Dp("design:type",m.a)],e.prototype,"selectedChapter$",void 0),e})();var zp=i("GyhO"),Lp=i("Xk3F"),Bp=i("3fyd"),Qp=i("cAOT"),$p=(i("vCxQ"),i("kmnG"));const qp=function(e){return{"input--success":e}};function Gp(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"div",7),ae.Vb(1,"div",8),ae.Vb(2,"mat-radio-group",9),ae.Qb(3,"mat-radio-button",10),ae.Ub(),ae.Qb(4,"input",11),ae.Vb(5,"button",12),ae.cc("click",(function(){ae.Cc(e);const i=t.index;return ae.gc().handleDeleteOption(i)})),ae.Qb(6,"app-icon",13),ae.Ub(),ae.Ub(),ae.Ub()}if(2&e){const e=t.$implicit,i=t.index,n=ae.gc();ae.Db(1),ae.mc("formGroupName",i),ae.Db(1),ae.mc("formControl",n.correctOptionControl)("name",n.optionGroupName),ae.Db(1),ae.mc("value",e.get("value").value),ae.Db(1),ae.mc("ngClass",ae.pc(6,qp,e.get("value").value==n.correctOptionControl.value)),ae.Db(1),ae.Eb("aria-label","Delete Question")}}function Hp(e,t){1&e&&(ae.Vb(0,"div",14),ae.Vb(1,"mat-error"),ae.Pc(2," Please select an answer. "),ae.Ub(),ae.Ub())}let Wp=(()=>{class e extends Tr.a{constructor(e,t,i,n){super(),this.formBuilder=e,this.changeRef=t,this.store=i,this.actions=n,this.optionGroupName="",this.ngUnsubscribe=new c.a,this.form=this.formBuilder.group({correctAnswer:["",G.C.required],options:this.formBuilder.array([])}),this.optionGroupName=go.a.getUuid()}get optionsControl(){return this.form.get("options")}get correctOptionControl(){return this.form.get("correctAnswer")}ngOnInit(){this.initFormListeners(),this.initNodeListeners()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initFormListeners(){this.form.valueChanges.pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.writeValue(e)}),this.optionsControl.valueChanges.pipe(Object(O.a)(()=>!Object(W.isNil)(this.form.value.correctAnswer)),Object(pi.a)(125),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{e.some(e=>e.value===this.form.value.correctAnswer)||(this.form.patchValue({correctAnswer:e[e.length-1].value}),this.changeRef.markForCheck())})}initNodeListeners(){this.actions.pipe(Object(r.l)(D.d),Object(O.a)(()=>this.store.selectSnapshot(x.a.getActiveTool)===Q.a.Quiz&&this.question.id===this.store.selectSnapshot(ji.b.getActiveQuestionId)),Object(O.a)(e=>{const{node:t,event:i}=e;return!Object(W.isNil)(t)&&!i.srcEvent.shiftKey}),Object(C.a)(e=>Object(W.trim)(Object(W.get)(e,"node.label",""))),Object(O.a)(e=>""!==e),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.createOption(e),this.changeRef.markForCheck()})}handleAddOptionClick(e){this.createOption(),e.preventDefault()}handleDeleteOption(e){this.optionsControl.removeAt(e)}handleDrop(e){const{previousIndex:t,currentIndex:i}=e,{options:n}=this.form.value,o=Object(te.a)(n,t,i);this.optionsControl.clear(),o.forEach(e=>{this.optionsControl.push(this.formBuilder.group(e))}),this.form.patchValue({options:o})}createOption(e){const t=Object(Lp.d)(e);this.optionsControl.push(this.formBuilder.group(t))}setFormValues(e){const{options:t}=e;this.optionsControl.length!==t.length&&(this.optionsControl.clear(),t.forEach(e=>{this.optionsControl.push(this.formBuilder.group(e))})),this.form.patchValue(e),this.changeRef.markForCheck()}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(G.f),ae.Pb(ae.i),ae.Pb(r.h),ae.Pb(r.b))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-edit-quiz-multiple-choice"]],inputs:{question:"question"},features:[ae.Cb([{provide:G.p,useExisting:Object(ae.W)(()=>e),multi:!0}]),ae.Ab],decls:8,vars:3,consts:[["label","Answers",3,"formGroup"],["formArrayName","options","cdkDropList","",3,"cdkDropListDropped"],["class","mb-2","data-test","questionAnswer","cdkDrag","",4,"ngFor","ngForOf"],[1,"flex","flex-row","items-center"],[3,"click"],[1,"text-12","text-dim"],["class","mt-1",4,"ngIf"],["data-test","questionAnswer","cdkDrag","",1,"mb-2"],[1,"flex","flex-row","items-center",3,"formGroupName"],["data-test","questionAnswerCorrect",3,"formControl","name"],[3,"value"],["type","text","formControlName","label","placeholder","Enter a response","data-test","questionAnswerLabel",1,"input",3,"ngClass"],["app-button","","buttonType","text","buttonTheme","dark","buttonSize","small","type","button","title","Delete Question",3,"click"],["icon","times","size","lg"],[1,"mt-1"]],template:function(e,t){1&e&&(ae.Vb(0,"app-form-field",0),ae.Vb(1,"div",1),ae.cc("cdkDropListDropped",(function(e){return t.handleDrop(e)})),ae.Nc(2,Gp,7,8,"div",2),ae.Vb(3,"div",3),ae.Vb(4,"mat-radio-button",4),ae.cc("click",(function(e){return t.handleAddOptionClick(e)})),ae.Vb(5,"span",5),ae.Pc(6,"Add Option"),ae.Ub(),ae.Ub(),ae.Ub(),ae.Ub(),ae.Nc(7,Hp,3,0,"div",6),ae.Ub()),2&e&&(ae.mc("formGroup",t.form),ae.Db(2),ae.mc("ngForOf",t.optionsControl.controls),ae.Db(5),ae.mc("ngIf",t.optionsControl.controls.length>0&&!t.correctOptionControl.valid))},directives:[de.a,G.s,G.j,G.e,ot.c,n.o,bt.a,n.p,ot.a,G.k,bt.b,G.r,G.h,G.c,G.i,n.m,pe.a,at.a,$p.b],styles:[""],changeDetection:0}),e})();var Kp=i("WwWM"),Jp=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Xp(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"div",10),ae.Vb(1,"div",11),ae.Pc(2),ae.Ub(),ae.Vb(3,"button",12),ae.cc("click",(function(){ae.Cc(e);const i=t.$implicit;return ae.gc().handleDeleteSelectionClick(i.id)})),ae.Qb(4,"app-icon",13),ae.Ub(),ae.Ub()}if(2&e){const e=t.$implicit;ae.Db(1),ae.Eb("data-id",e.id),ae.Db(1),ae.Qc(e.label),ae.Db(1),ae.Eb("aria-label","Delete Selection")}}let Zp=(()=>{class e extends Tr.a{constructor(e,t,i,n,o,a){super(),this.store=e,this.actions=t,this.formBuilder=i,this.changeRef=n,this.graphService=o,this.viewService=a,this.ngUnsubscribe=new c.a,this.form=this.formBuilder.group({showAnswerList:[!1],selectType:"all",correctAnswer:this.formBuilder.array([])})}ngOnInit(){this.initFormListeners(),this.initNodeListeners()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initFormListeners(){this.form.valueChanges.pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.writeValue(e);const t=e.correctAnswer,i=this.store.selectSnapshot(x.a.getViewGraph);this.nodes=this.graphService.getNodes(i,t),this.changeRef.markForCheck()})}initNodeListeners(){this.activeQuestion$.pipe(Object(U.a)(()=>{this.viewService.clearSelectedNodes()}),Object(O.a)(()=>this.question.id===this.store.selectSnapshot(ji.b.getActiveQuestionId)),Object(P.a)(this.ngUnsubscribe)).subscribe(()=>{setTimeout(()=>{this.selectNodes(this.value.correctAnswer,!0)})}),this.actions.pipe(Object(r.l)(D.d),Object(O.a)(()=>this.store.selectSnapshot(x.a.getActiveTool)===Q.a.Quiz&&this.question.id===this.store.selectSnapshot(ji.b.getActiveQuestionId)),Object(O.a)(e=>{const{node:t,event:i}=e;return!Object(W.isNil)(t)&&!i.srcEvent.shiftKey}),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{const t=e.hit?e.hit.objectId:"";if(t){const e=this.store.selectSnapshot($t.a.getNodes);this.selectNodes([t],!e[t].checked)}this.changeRef.markForCheck()})}handleDeleteSelectionClick(e){this.selectNodes([e],!1)}setFormValues(e){this.form.setControl("correctAnswer",this.formBuilder.array(e.correctAnswer)),this.form.patchValue(e),this.changeRef.markForCheck()}selectNodes(e,t){this.store.dispatch(new Xt.a.UpdateNodesChecked(t,e));const{showAnswerList:i,selectType:n,correctAnswer:o}=this.form.value;let a=[...o];a=t?[...a,...e.filter(e=>!a.includes(e))]:[...a.filter(t=>!e.includes(t))],this.setFormValues({showAnswerList:i,selectType:n,correctAnswer:a})}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(r.h),ae.Pb(r.b),ae.Pb(G.f),ae.Pb(ae.i),ae.Pb(qo.a),ae.Pb(Kp.a))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-edit-quiz-select-anatomy"]],inputs:{question:"question"},features:[ae.Cb([{provide:G.p,useExisting:Object(ae.W)(()=>e),multi:!0}]),ae.Ab],decls:16,vars:4,consts:[[3,"formGroup"],["label","ANSWERS (Select the anatomy in 3D)",3,"uppercase","isCompact"],[1,"edit-quiz-select-anatomy__group"],["class","flex flex-row items-center justify-between","data-test","questionAnswer",4,"ngFor","ngForOf"],["formControlName","showAnswerList"],[1,"text-11"],["label","CORRECT ANSWER"],["formControlName","selectType"],["value","all",1,"mb-2"],["value","any","data-test","questionSelectAny"],["data-test","questionAnswer",1,"flex","flex-row","items-center","justify-between"],[1,"text-12"],["data-test","questionAnswerRemoveButton","app-button","","buttonType","text","buttonTheme","dark","buttonSize","small","type","button","title","Delete Selection",3,"click"],["icon","times","size","lg"]],template:function(e,t){1&e&&(ae.Tb(0,0),ae.Qb(1,"app-form-field",1),ae.Vb(2,"div",2),ae.Nc(3,Xp,5,3,"div",3),ae.Ub(),ae.Vb(4,"app-form-field"),ae.Vb(5,"mat-checkbox",4),ae.Vb(6,"span",5),ae.Pc(7,"Show answer list in the question text"),ae.Ub(),ae.Ub(),ae.Ub(),ae.Vb(8,"app-form-field",6),ae.Vb(9,"mat-radio-group",7),ae.Vb(10,"mat-radio-button",8),ae.Vb(11,"span",5),ae.Pc(12,"Must select all answers listed"),ae.Ub(),ae.Ub(),ae.Vb(13,"mat-radio-button",9),ae.Vb(14,"span",5),ae.Pc(15,"Can select any of the answers listed"),ae.Ub(),ae.Ub(),ae.Ub(),ae.Ub(),ae.Sb()),2&e&&(ae.mc("formGroup",t.form),ae.Db(1),ae.mc("uppercase",!1)("isCompact",!0),ae.Db(2),ae.mc("ngForOf",t.nodes))},directives:[G.s,G.j,de.a,n.o,ge.a,G.r,G.i,bt.b,bt.a,pe.a,at.a],styles:[".edit-quiz-select-anatomy__group[_ngcontent-%COMP%]{margin-bottom:24px;display:flex;flex-direction:column;row-gap:4px}"],changeDetection:0}),function(e,t,i,n){var o,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,i,r):o(t,i))||r);a>3&&r&&Object.defineProperty(t,i,r)}([Object(r.e)(ji.b.getActiveQuestionId),Jp("design:type",m.a)],e.prototype,"activeQuestion$",void 0),e})();var Yp=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function ed(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"div",5),ae.Vb(1,"div",6),ae.Vb(2,"div",7),ae.Pc(3),ae.Ub(),ae.Vb(4,"div",8),ae.Qb(5,"app-icon",9),ae.Ub(),ae.Ub(),ae.Tb(6,10),ae.Qb(7,"input",11),ae.Sb(),ae.Vb(8,"button",12),ae.cc("click",(function(){ae.Cc(e);const i=t.index;return ae.gc().handleDeleteSelectionClick(i)})),ae.Qb(9,"app-icon",13),ae.Ub(),ae.Ub()}if(2&e){const e=t.index;ae.mc("formGroupName",e),ae.Db(3),ae.Qc(e+1),ae.Db(5),ae.Eb("aria-label","Delete Selection")}}function td(e,t){1&e&&ae.Qb(0,"mat-error")}let id=(()=>{class e extends Tr.a{constructor(e,t,i,n,o,a){super(),this.store=e,this.actions=t,this.formBuilder=i,this.changeRef=n,this.graphService=o,this.cameraService=a,this.ngUnsubscribe=new c.a,this.form=this.formBuilder.group({correctAnswer:this.formBuilder.array([]),options:this.formBuilder.array([],this.getLabelValidators())})}get optionsControl(){return this.form.get("options")}ngOnInit(){this.initFormListeners(),this.initNodeListeners(),this.initLabelListeners()}ngOnDestroy(){this.store.dispatch(new D.Y(!0)),this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initFormListeners(){this.form.valueChanges.pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{const t=e.options,i=this.store.selectSnapshot(ji.b.getActiveQuestionLabels),n={correctAnswer:t.map(e=>e.value),options:t.map(e=>{const{value:t,label:n,model:o}=e,a=i.find(e=>e.value===t);return{value:t,label:Object.assign(Object.assign({},a?a.label:o),n)}})};this.writeValue(n),this.changeRef.markForCheck()})}initNodeListeners(){this.actions.pipe(Object(r.l)(D.d),Object(O.a)(()=>this.store.selectSnapshot(x.a.getActiveTool)===Q.a.Quiz&&this.question.id===this.store.selectSnapshot(ji.b.getActiveQuestionId)),Object(O.a)(e=>{const{node:t,event:i}=e;return!Object(W.isNil)(t)&&!i.srcEvent.shiftKey}),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{const t=e.hit;if(t&&t.objectId){const e=t.objectId,i=this.store.selectSnapshot(x.a.getViewGraph),[n]=this.graphService.getNodes(i,[e]),o=this.cameraService.getDirection(t),a=Object(Lp.c)(n,t,o),r=Object(Lp.a)(a);this.addOption(r)}this.changeRef.markForCheck()})}initLabelListeners(){this.activeQuestion$.pipe(Object(Dn.a)((e,t)=>Object(W.isEqual)(e,t)),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{const t=Object(W.isNil)(e);this.store.dispatch(new D.Y(t))})}handleDeleteSelectionClick(e){this.handleDeleteOption(e)}setFormValues(e){const t=e.options;this.optionsControl.length!==t.length&&this.setFormOptions(t),this.form.patchValue(e),this.changeRef.markForCheck()}handleDeleteOption(e){this.optionsControl.removeAt(e)}handleDrop(e){const{previousIndex:t,currentIndex:i}=e,n=this.form.value.options,o=Object(te.a)(n,t,i);this.setFormOptions(n),this.form.patchValue({options:o})}setFormOptions(e){this.optionsControl.clear(),e.forEach(e=>{this.addOption(e)})}addOption(e){this.optionsControl.push(this.formBuilder.group({value:e.value,label:this.formBuilder.group({title:[e.label.title]}),model:e.label}))}getLabelValidators(){return e=>{const t=e.value.map(e=>e.value),i=Object(W.uniq)(t).length<t.length;return i?{hasDuplicates:i}:null}}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(r.h),ae.Pb(r.b),ae.Pb(G.f),ae.Pb(ae.i),ae.Pb(qo.a),ae.Pb(fn.a))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-edit-quiz-label-anatomy"]],inputs:{question:"question"},features:[ae.Cb([{provide:G.p,useExisting:Object(ae.W)(()=>e),multi:!0}]),ae.Ab],decls:5,vars:4,consts:[["cdkDropList","",1,"label",3,"formGroup","cdkDropListDropped"],["label","ANSWERS (Select the anatomy to be labeled)","formArrayName","options",3,"uppercase"],["class","flex flex-row items-center justify-between mb-2","cdkDrag","",3,"formGroupName",4,"ngFor","ngForOf"],[1,"mt-1"],[4,"ngIf"],["cdkDrag","",1,"flex","flex-row","items-center","justify-between","mb-2",3,"formGroupName"],["cdkDragHandle","","data-test","questionAnswerNumber",1,"label__pin"],[1,"label__label"],[1,"label__drag"],["icon","grip-lines"],["formGroupName","label"],["type","text","formControlName","title","data-test","questionAnswer",1,"input"],["data-test","questionAnswerRemoveButton","app-button","","buttonType","text","buttonTheme","dark","buttonSize","small","type","button","title","Delete Selection",3,"click"],["icon","times","size","lg"]],template:function(e,t){1&e&&(ae.Vb(0,"div",0),ae.cc("cdkDropListDropped",(function(e){return t.handleDrop(e)})),ae.Vb(1,"app-form-field",1),ae.Nc(2,ed,10,3,"div",2),ae.Vb(3,"div",3),ae.Nc(4,td,1,0,"mat-error",4),ae.Ub(),ae.Ub(),ae.Ub()),2&e&&(ae.mc("formGroup",t.form),ae.Db(1),ae.mc("uppercase",!1),ae.Db(1),ae.mc("ngForOf",t.optionsControl.controls),ae.Db(2),ae.mc("ngIf",!t.optionsControl.valid))},directives:[ot.c,G.s,G.j,de.a,G.e,n.o,n.p,ot.a,G.k,ot.b,at.a,G.c,G.r,G.i,pe.a,$p.b],styles:[".label__pin[_ngcontent-%COMP%]{width:40px;height:40px;display:flex;align-items:center;justify-content:center}.label__pin[_ngcontent-%COMP%]:hover{cursor:move}.label__pin[_ngcontent-%COMP%]:hover   .label__label[_ngcontent-%COMP%]{display:none}.label__pin[_ngcontent-%COMP%]:hover   .label__drag[_ngcontent-%COMP%]{display:block}.label__label[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;color:#101823;font-size:10px;width:24px;height:24px;background-image:url(/assets/images/labels/circle.svg);background-repeat:no-repeat;background-position:50%;background-size:auto}.label__drag[_ngcontent-%COMP%]{display:none}"],changeDetection:0}),function(e,t,i,n){var o,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,i,r):o(t,i))||r);a>3&&r&&Object.defineProperty(t,i,r)}([Object(r.e)(ji.b.getActiveQuestionId),Yp("design:type",m.a)],e.prototype,"activeQuestion$",void 0),e})();var nd=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function od(e,t){if(1&e&&ae.Qb(0,"app-edit-quiz-multiple-choice",29),2&e){const e=ae.gc();ae.mc("question",e.question)}}function ad(e,t){if(1&e&&ae.Qb(0,"app-edit-quiz-select-anatomy",29),2&e){const e=ae.gc();ae.mc("question",e.question)}}function rd(e,t){if(1&e&&ae.Qb(0,"app-edit-quiz-label-anatomy",29),2&e){const e=ae.gc();ae.mc("question",e.question)}}function sd(e,t){1&e&&(ae.Vb(0,"div",17),ae.Vb(1,"app-form-field",30),ae.Qb(2,"app-rich-text-edit",31,16),ae.Ub(),ae.Ub()),2&e&&(ae.Db(2),ae.mc("inline",!0)("compact",!0)("resizeable",!0)("rows",6))}function cd(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"div",32),ae.Vb(1,"button",33),ae.cc("click",(function(){return ae.Cc(e),ae.gc().handlePreviewCameraClick()})),ae.Pc(2," Preview "),ae.Ub(),ae.Vb(3,"button",34),ae.cc("click",(function(){return ae.Cc(e),ae.gc().handleRemoveCameraClick()})),ae.Pc(4," Remove "),ae.Ub(),ae.Ub()}}let ld=(()=>{class e{constructor(e,t,i,n){this.formBuilder=e,this.store=t,this.cameraService=i,this.changeDetectorRef=n,this.questionTypesMap=Bp.c,this.questionDescriptionsMap=Bp.b,this.questionTypes=Bp.a,this.defaultNextButtonNext=Lp.f,this.open=!1,this.opened=new ae.p,this.textLabel=" ",this.ngUnsubscribe=new c.a,this.initForm()}get question(){return this._question}set question(e){Object(W.isEqual)(e,this.question)||(this._question=e,this.setFormValues(e),this.textLabel=this.question.type===Bp.a.Instructions?"Text":"Question")}get quizCamera(){return Object(W.get)(this.question,"sceneConfig.camera")}ngOnInit(){this.initFormListeners(),this.initQuestionChangeListeners()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initForm(){this.form=this.formBuilder.group({questionPrompt:this.formBuilder.group({type:"markdown",markdown:""}),data:[],explanation:this.formBuilder.group({type:"markdown",markdown:""}),nextLabel:"",showChapterLabels:!1,camera:[]})}initFormListeners(){this.form.valueChanges.pipe(Object(pi.a)(125),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{const t=Object.assign(Object.assign({},this.question),this.createQuestionFromValues(e));this.store.dispatch(new mn.a.SetQuestion(t))})}initQuestionChangeListeners(){this.questions$.pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{const t=this.getQuestionIndex(this.question.id);this.questionNum=t+1,this.changeDetectorRef.markForCheck()})}handleOpened(e){this.opened.emit({panel:this.panel,opened:e})}handleRemoveQuestionClick(){this.store.dispatch(new mn.a.RemoveQuestions([this.question.id]))}handleCaptureCameraClick(){const e=this.cameraService.getCamera();this.form.patchValue({camera:e})}handlePreviewCameraClick(){const e=this.quizCamera;e&&this.store.dispatch(new I.l(e.location,!0,1))}handleRemoveCameraClick(){this.form.patchValue({camera:void 0})}handlePreviewQuestion(){const e=this.getQuestionIndex(this.question.id);this.store.dispatch(new g.c(!0,e))}setFormValues(e){const{questionPrompt:t,explanation:i,data:n,sceneConfig:o,nextLabel:a,showChapterLabels:r}=e,s=Object(W.get)(o,"camera.location");this.form.patchValue({questionPrompt:t[0],data:n,explanation:i[0],camera:s,nextLabel:a,showChapterLabels:r},{emitEvent:!1,onlySelf:!0})}createQuestionFromValues(e){const{questionPrompt:t,explanation:i,data:n,camera:o,nextLabel:a,showChapterLabels:r}=e,s={};return o&&(s.camera={action:Qp.a.FlyTo,location:o}),{questionPrompt:[t],data:n,explanation:[i],sceneConfig:s,nextLabel:a,showChapterLabels:r}}getQuestionIndex(e){const t=this.store.selectSnapshot(F.a.getStoryChapters).map(e=>e.id);return this.store.selectSnapshot(ji.b.getQuestionIndex(t,e))}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(G.f),ae.Pb(r.h),ae.Pb(fn.a),ae.Pb(ae.i))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-quiz-question-form"]],viewQuery:function(e,t){if(1&e&&ae.Jc(be.a,!0),2&e){let e;ae.xc(e=ae.dc())&&(t.panel=e.first)}},inputs:{label:"label",question:"question",open:"open"},outputs:{opened:"opened"},decls:42,vars:19,consts:[["toggleType","arrow","data-test","questionPanel",3,"label","open","opened"],["panel-prefix",""],["data-test","questionNumText",1,"question__pin"],["panel-actions",""],["app-button","","buttonSize","small",3,"matMenuTriggerFor"],["icon","ellipsis-v"],["questionMenu","matMenu"],["mat-menu-item","",3,"click"],[3,"formGroup"],["tabSize","small","tabTheme","dark"],["label","Content"],[1,"mt-5"],["label","Type","matTooltipPosition","left",3,"matTooltip"],[1,"text-12"],["formGroupName","questionPrompt",3,"label"],["data-test","questionPrompt","formControlName","markdown",3,"inline","compact","resizeable","rows"],["questionPrompt",""],[1,"mt-2"],[3,"ngSwitch"],["formControlName","data",3,"question",4,"ngSwitchCase"],["class","mt-2",4,"ngIf"],["label","Advanced"],[1,"mt-4"],["label","Custom Starting Position","formGroupName","camera"],["buttonType","outline","app-button","","data-test","questionMarkPosition",1,"w-100",3,"click"],["class","flex flex-row justify-between mt-3",4,"ngIf"],["label","Next Button Text"],["type","text","formControlName","nextLabel","data-test","questionNextText",1,"input",3,"placeholder"],["formControlName","showChapterLabels","data-test","questionShowChapterLabels"],["formControlName","data",3,"question"],["label","Answer Explanation","formGroupName","explanation"],["formControlName","markdown","data-test","questionExplanation",3,"inline","compact","resizeable","rows"],[1,"flex","flex-row","justify-between","mt-3"],["buttonType","outline","app-button","","data-test","questionPreviewPosition",1,"w-50","mr-1",3,"click"],["buttonType","outline","app-button","","data-test","questionRemovePosition",1,"w-50","ml-1",3,"click"]],template:function(e,t){if(1&e&&(ae.Vb(0,"app-panel",0),ae.cc("opened",(function(e){return t.handleOpened(e)})),ae.Tb(1,1),ae.Vb(2,"div",2),ae.Pc(3),ae.Ub(),ae.Sb(),ae.Vb(4,"div",3),ae.Vb(5,"button",4),ae.Qb(6,"app-icon",5),ae.Ub(),ae.Vb(7,"mat-menu",null,6),ae.Vb(9,"button",7),ae.cc("click",(function(){return t.handlePreviewQuestion()})),ae.Pc(10,"Preview Question"),ae.Ub(),ae.Qb(11,"mat-divider"),ae.Vb(12,"button",7),ae.cc("click",(function(){return t.handleRemoveQuestionClick()})),ae.Pc(13,"Remove"),ae.Ub(),ae.Ub(),ae.Ub(),ae.Vb(14,"div",8),ae.Vb(15,"app-tabs",9),ae.Vb(16,"app-tab",10),ae.Vb(17,"div",11),ae.Vb(18,"app-form-field",12),ae.Vb(19,"span",13),ae.Pc(20),ae.Ub(),ae.Ub(),ae.Vb(21,"app-form-field",14),ae.Qb(22,"app-rich-text-edit",15,16),ae.Ub(),ae.Ub(),ae.Vb(24,"div",17),ae.Tb(25,18),ae.Nc(26,od,1,1,"app-edit-quiz-multiple-choice",19),ae.Nc(27,ad,1,1,"app-edit-quiz-select-anatomy",19),ae.Nc(28,rd,1,1,"app-edit-quiz-label-anatomy",19),ae.Sb(),ae.Ub(),ae.Nc(29,sd,4,4,"div",20),ae.Ub(),ae.Vb(30,"app-tab",21),ae.Vb(31,"div",22),ae.Vb(32,"app-form-field",23),ae.Vb(33,"button",24),ae.cc("click",(function(){return t.handleCaptureCameraClick()})),ae.Pc(34," Mark Position "),ae.Ub(),ae.Nc(35,cd,5,0,"div",25),ae.Ub(),ae.Vb(36,"app-form-field",26),ae.Qb(37,"input",27),ae.Ub(),ae.Vb(38,"app-form-field"),ae.Vb(39,"mat-checkbox",28),ae.Vb(40,"span",13),ae.Pc(41,"Show chapter's labels"),ae.Ub(),ae.Ub(),ae.Ub(),ae.Ub(),ae.Ub(),ae.Ub(),ae.Ub(),ae.Ub()),2&e){const e=ae.yc(8);ae.mc("label",t.label)("open",t.open),ae.Db(3),ae.Rc(" ",t.questionNum," "),ae.Db(2),ae.mc("matMenuTriggerFor",e),ae.Db(9),ae.mc("formGroup",t.form),ae.Db(4),ae.mc("matTooltip",t.questionDescriptionsMap[t.question.type]),ae.Db(2),ae.Qc(t.questionTypesMap[t.question.type]),ae.Db(1),ae.mc("label",t.textLabel),ae.Db(1),ae.mc("inline",!0)("compact",!0)("resizeable",!0)("rows",6),ae.Db(3),ae.mc("ngSwitch",t.question.type),ae.Db(1),ae.mc("ngSwitchCase",t.questionTypes.MultipleChoice),ae.Db(1),ae.mc("ngSwitchCase",t.questionTypes.SelectAnatomy),ae.Db(1),ae.mc("ngSwitchCase",t.questionTypes.LabelAnatomy),ae.Db(1),ae.mc("ngIf",t.question.type!==t.questionTypes.Instructions),ae.Db(6),ae.mc("ngIf",t.quizCamera),ae.Db(2),ae.mc("placeholder",t.defaultNextButtonNext)}},directives:[be.a,pe.a,Sn.d,at.a,Sn.a,Sn.b,me.a,G.s,G.j,Yn.a,eo.a,de.a,st.c,G.k,nt,G.r,G.i,n.r,n.s,n.p,G.c,ge.a,Wp,Zp,id],styles:[".question__pin[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;color:#101823;font-size:10px;width:24px;height:24px;position:relative;left:-8px;top:4px;background-image:url(/assets/images/labels/circle.svg);background-repeat:no-repeat;background-position:50%;background-size:auto}"],changeDetection:0}),function(e,t,i,n){var o,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,i,r):o(t,i))||r);a>3&&r&&Object.defineProperty(t,i,r)}([Object(r.e)(ji.b.getAllQuestions),nd("design:type",m.a)],e.prototype,"questions$",void 0),e})();var pd=i("qA9Q"),dd=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let ud=(()=>{class e{constructor(e,t,i){this.formBuilder=e,this.store=t,this.dialogRef=i,this.ngUnsubscribe=new c.a;const n=this.store.selectSnapshot(ji.b.getQuizSettings);this.form=this.formBuilder.group(Object.assign({},n))}ngOnInit(){this.initFormListeners(),this.initSettingsListeners()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initFormListeners(){this.form.valueChanges.pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.setQuizSettings(e)})}initSettingsListeners(){this.quizSettings$.pipe(Object(Dn.a)((e,t)=>Object(W.isEqual)(e,t)),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.setQuizForm(e)})}handleDoneClick(){this.dialogRef.close()}setQuizSettings(e){this.store.dispatch(new mn.a.SetQuizSettings(e))}setQuizForm(e){this.form.patchValue(e)}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(G.f),ae.Pb(r.h),ae.Pb(H.g))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-quiz-settings-dialog"]],decls:31,vars:2,consts:[["data-test","quizSettings",1,"dialog"],["mat-dialog-title",""],[1,"flex","flex-row","justify-between"],["app-button","","buttonType","text","buttonTheme","light","type","button","title","Close",3,"click"],["icon","times","size","lg"],["mat-dialog-content","",1,"theme-light","text-12","mt-4",3,"formGroup"],["data-test","enableQuiz","formControlName","enabled","cdkFocusInitial",""],["label","Validation"],["listType","flat"],["formControlName","showSummary"],["formControlName","showExplanation"],["label","UI Elements"],["formControlName","showProgress"],["formControlName","showSubmit"],["mat-dialog-actions","",1,"flex","flex-row","items-end"],["app-button","","buttonTheme","light","buttonType","flat",3,"click"]],template:function(e,t){1&e&&(ae.Vb(0,"div",0),ae.Vb(1,"div",1),ae.Vb(2,"div",2),ae.Vb(3,"h1"),ae.Pc(4,"Quiz Settings"),ae.Ub(),ae.Vb(5,"button",3),ae.cc("click",(function(){return t.handleDoneClick()})),ae.Qb(6,"app-icon",4),ae.Ub(),ae.Ub(),ae.Ub(),ae.Qb(7,"mat-divider"),ae.Vb(8,"div",5),ae.Vb(9,"app-form-field"),ae.Vb(10,"mat-checkbox",6),ae.Pc(11,"Enable Quiz"),ae.Ub(),ae.Ub(),ae.Vb(12,"app-form-field",7),ae.Vb(13,"app-list",8),ae.Vb(14,"app-list-item"),ae.Vb(15,"mat-checkbox",9),ae.Pc(16,"Show summary page"),ae.Ub(),ae.Ub(),ae.Vb(17,"app-list-item"),ae.Vb(18,"mat-checkbox",10),ae.Pc(19,"Show answers and explanations"),ae.Ub(),ae.Ub(),ae.Ub(),ae.Ub(),ae.Vb(20,"app-form-field",11),ae.Vb(21,"app-list",8),ae.Vb(22,"app-list-item"),ae.Vb(23,"mat-checkbox",12),ae.Pc(24,"Progress indicator"),ae.Ub(),ae.Ub(),ae.Vb(25,"app-list-item"),ae.Vb(26,"mat-checkbox",13),ae.Pc(27,"Submit Button"),ae.Ub(),ae.Ub(),ae.Ub(),ae.Ub(),ae.Ub(),ae.Vb(28,"div",14),ae.Vb(29,"button",15),ae.cc("click",(function(){return t.handleDoneClick()})),ae.Pc(30," Done "),ae.Ub(),ae.Ub(),ae.Ub()),2&e&&(ae.Db(5),ae.Eb("aria-label","Close"),ae.Db(3),ae.mc("formGroup",t.form))},directives:[H.h,pe.a,at.a,me.a,H.e,G.s,G.j,de.a,ge.a,G.r,G.i,gt.a,ft.a,H.c],styles:[""],changeDetection:0}),function(e,t,i,n){var o,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,i,r):o(t,i))||r);a>3&&r&&Object.defineProperty(t,i,r)}([Object(r.e)(ji.b.getQuizSettings),dd("design:type",m.a)],e.prototype,"quizSettings$",void 0),e})();var hd=function(e){return e.Green="green",e.Yellow="yellow",e.Red="red",e}({});let md=(()=>{class e{constructor(){this.color=hd.Green,this.label=""}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-status"]],inputs:{color:"color",label:"label"},decls:2,vars:2,consts:[["data-test","status",1,"status",3,"ngClass"]],template:function(e,t){1&e&&(ae.Vb(0,"div",0),ae.Pc(1),ae.Ub()),2&e&&(ae.mc("ngClass","status--"+t.color),ae.Db(1),ae.Rc(" ",t.label,"\n"))},directives:[n.m],styles:['@charset "UTF-8";.text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.status[_ngcontent-%COMP%]{display:inline-flex;align-items:center;padding:4px 8px;--dot-color:#33cd54;--text-color:#fff;color:var(--text-color);font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.status[_ngcontent-%COMP%]:before{content:"\u2022";color:var(--dot-color);display:inline-block;font-size:24px;margin-right:4px}.status--green[_ngcontent-%COMP%]{--dot-color:#33cd54}.status--yellow[_ngcontent-%COMP%]{--dot-color:#ffb92e}.status--red[_ngcontent-%COMP%]{--dot-color:#f44336}.status--theme-dark[_ngcontent-%COMP%]{--text-color:#fff}.status--theme-light[_ngcontent-%COMP%]{--text-color:#101823}'],changeDetection:0}),e})();var bd=i("NVq4"),gd=function(e,t,i,n){var o,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,i,r):o(t,i))||r);return a>3&&r&&Object.defineProperty(t,i,r),r},fd=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const xd=["questionItemElements"];function yd(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"div",20,21),ae.Vb(2,"app-quiz-question-form",22),ae.cc("opened",(function(i){ae.Cc(e);const n=t.$implicit;return ae.gc().handleOpened(n,i)})),ae.hc(3,"ellipsis"),ae.hc(4,"async"),ae.Ub(),ae.Vb(5,"div",23),ae.Qb(6,"app-icon",24),ae.Ub(),ae.Ub()}if(2&e){const e=t.$implicit,i=ae.gc();ae.Db(2),ae.nc("label",ae.jc(3,3,i.getQuestionText(e),80)),ae.mc("question",e)("open",ae.ic(4,6,i.activeQuestionId$)===e.id)}}function vd(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"button",25),ae.cc("click",(function(){ae.Cc(e);const i=t.$implicit;return ae.gc().addQuestion(i)})),ae.Pc(1),ae.Ub()}if(2&e){const e=t.$implicit,i=ae.gc();ae.mc("matTooltip",i.questionDescriptionsMap[e]),ae.Db(1),ae.Rc(" ",i.questionTypesMap[e]," ")}}let Cd=(()=>{class e{constructor(e,t,i,n,o){this.store=e,this.actions=t,this.changeRef=i,this.dialogService=n,this.dialog=o,this.questionTypes=Object.keys(Bp.c),this.questionTypesMap=Bp.c,this.questionDescriptionsMap=Bp.b,this.statusColor=hd,this.selectedChapterQuestions=[],this.ngUnsubscribe=new c.a}ngOnInit(){this.initChapterQuestionListeners(),this.initPanelListeners()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initChapterQuestionListeners(){Object(d.b)([this.chapters$,this.selectedChapterId$,this.allQuestions$]).pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(([e,t,i])=>{this.selectedChapterQuestions=this.store.selectSnapshot(ji.b.getQuizQuestionsByChapter(t)),this.changeRef.markForCheck()}),Object(zp.a)(this.selectedChapterId$,this.actions.pipe(Object(r.k)(mn.a.SetQuestions))).pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(()=>{this.store.dispatch(new mn.a.SetActiveQuestion(void 0))})}initPanelListeners(){this.actions.pipe(Object(r.k)(mn.a.AddQuestion),Object(P.a)(this.ngUnsubscribe)).subscribe(()=>{const e=this.selectedChapterQuestions.length-1;this.store.dispatch(new mn.a.SetActiveQuestion(this.selectedChapterQuestions[e].id));const t=this.questionForms.toArray()[e];t&&this.setActivePanel(t.panel)}),this.activeQuestionId$.pipe(Object(O.a)(e=>!!e),Object(Dn.a)(),Object(w.a)(0),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{const t=this.selectedChapterQuestions.findIndex(t=>t.id===e),i=this.questionItemElements.toArray()[t];i&&i.nativeElement.scrollIntoView({behavior:"smooth"})})}handleOpened(e,t){t.opened&&this.setActivePanel(t.panel),this.store.dispatch(new mn.a.SetActiveQuestion(t.opened?e.id:void 0))}handleQuizSettingsClick(){return this.dialog.open(ud,{id:Vi.a.QuizSettingsDialog,width:"320px"})}handleRemoveChapterQuizClick(){this.dialogService.openConfirmDialog({data:{titleText:"Remove Chapter Questions",bodyText:"Would you like to remove all the questions in this chapter?"}}).afterClosed().pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{if(e){const e=this.store.selectSnapshot(F.a.getSelectedChapterId),t=this.store.selectSnapshot(ji.b.getAllQuestions).filter(t=>t.chapterId===e).map(e=>e.id);this.store.dispatch(new mn.a.RemoveQuestions(t))}})}handleRemoveQuizClick(){this.dialogService.openConfirmDialog({data:{titleText:"Remove All Questions",bodyText:"Would you like to remove all the questions in this quiz?"}}).afterClosed().pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{if(e){const e=this.store.selectSnapshot(ji.b.getAllQuestions).map(e=>e.id);this.store.dispatch(new mn.a.RemoveQuestions(e))}})}getQuestionText(e){const{questionPrompt:t}=e;return Object(pd.b)(t)}addQuestion(e){const t=this.store.selectSnapshot(F.a.getSelectedChapterId),i=Object.assign(Object.assign({},Object(Lp.e)(e)),{chapterId:t});this.store.dispatch(new mn.a.AddQuestion(i))}setActivePanel(e){this.questionForms.toArray().filter(t=>t.panel!==e).forEach(e=>{e.panel.open=!1}),this.changeRef.markForCheck()}trackByKey(e,t){return t.id}handleDrop(e){const t=this.store.selectSnapshot(F.a.getSelectedChapterId),i=this.store.selectSnapshot(ji.b.getQuizQuestionsByChapter(t));Object(ot.e)(i,e.previousIndex,e.currentIndex);let n=this.store.selectSnapshot(ji.b.getAllQuestions).filter(e=>!i.some(t=>t.id===e.id));n=[...n,...i],this.store.dispatch(new mn.a.SetQuestions(n))}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(r.h),ae.Pb(r.b),ae.Pb(ae.i),ae.Pb(yn.a),ae.Pb(H.b))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-edit-quiz-context"]],viewQuery:function(e,t){if(1&e&&(ae.Vc(ld,!0),ae.Vc(xd,!0)),2&e){let e;ae.xc(e=ae.dc())&&(t.questionForms=e),ae.xc(e=ae.dc())&&(t.questionItemElements=e)}},decls:29,vars:12,consts:[[3,"loading"],["column-label",""],[1,"flex","items-center"],[3,"label","color"],["column-actions",""],["app-button","","data-test","quizSettingsButton","matTooltip","Quiz Settings",3,"click"],["icon","cog"],["app-button","","data-test","questionActionsTrigger","matTooltip","Quiz Bulk Actions",3,"matMenuTriggerFor"],["icon","ellipsis-v"],["quizActionsMenu","matMenu"],["mat-menu-item","","data-test","questionRemoveChapterQuestions",3,"click"],["mat-menu-item","","data-test","questionRemoveAllQuestions",3,"click"],["label","Quiz"],["column-group-body",""],["cdkDropList","",1,"pl-2",3,"cdkDropListDropped"],["class","questions__item","cdkDrag","",4,"ngFor","ngForOf","ngForTrackBy"],["app-button","","buttonType","outline",1,"mv-4","w-100",3,"matMenuTriggerFor"],["icon","angle-down"],["addQuestionMenu","matMenu"],["mat-menu-item","","matTooltipPosition","left",3,"matTooltip","click",4,"ngFor","ngForOf"],["cdkDrag","",1,"questions__item"],["questionItemElements",""],[3,"question","label","open","opened"],["cdkDragHandle","",1,"questions__handle"],["icon","grip-lines"],["mat-menu-item","","matTooltipPosition","left",3,"matTooltip","click"]],template:function(e,t){if(1&e&&(ae.Vb(0,"app-column",0),ae.Vb(1,"div",1),ae.Vb(2,"div",2),ae.Vb(3,"span"),ae.Pc(4,"Quiz"),ae.Ub(),ae.Qb(5,"app-status",3),ae.hc(6,"async"),ae.hc(7,"async"),ae.Ub(),ae.Ub(),ae.Vb(8,"div",4),ae.Vb(9,"button",5),ae.cc("click",(function(){return t.handleQuizSettingsClick()})),ae.Qb(10,"app-icon",6),ae.Ub(),ae.Vb(11,"button",7),ae.Qb(12,"app-icon",8),ae.Ub(),ae.Vb(13,"mat-menu",null,9),ae.Vb(15,"button",10),ae.cc("click",(function(){return t.handleRemoveChapterQuizClick()})),ae.Pc(16," Remove this chapter's quiz questions "),ae.Ub(),ae.Vb(17,"button",11),ae.cc("click",(function(){return t.handleRemoveQuizClick()})),ae.Pc(18," Remove quiz "),ae.Ub(),ae.Ub(),ae.Ub(),ae.Vb(19,"app-column-group",12),ae.Tb(20,13),ae.Vb(21,"div",14),ae.cc("cdkDropListDropped",(function(e){return t.handleDrop(e)})),ae.Nc(22,yd,7,8,"div",15),ae.Vb(23,"button",16),ae.Pc(24," Add a Question "),ae.Qb(25,"app-icon",17),ae.Ub(),ae.Vb(26,"mat-menu",null,18),ae.Nc(28,vd,2,2,"button",19),ae.Ub(),ae.Ub(),ae.Sb(),ae.Ub(),ae.Ub()),2&e){const e=ae.yc(14),i=ae.yc(27);ae.mc("loading",!1),ae.Db(5),ae.mc("label",ae.ic(6,8,t.quizEnabled$)?"active":"inactive")("color",ae.ic(7,10,t.quizEnabled$)?"green":"red"),ae.Db(6),ae.mc("matMenuTriggerFor",e),ae.Db(11),ae.mc("ngForOf",t.selectedChapterQuestions)("ngForTrackBy",t.trackByKey),ae.Db(1),ae.mc("matMenuTriggerFor",i),ae.Db(5),ae.mc("ngForOf",t.questionTypes)}},directives:[Kn,md,pe.a,st.c,at.a,Sn.d,Sn.a,Sn.b,Fn,ot.c,n.o,ot.a,ld,ot.b],pipes:[n.b,bd.a],styles:[".questions__item[_ngcontent-%COMP%]{position:relative}.questions__item[_ngcontent-%COMP%]:hover   .questions__handle[_ngcontent-%COMP%]{opacity:1}.questions__handle[_ngcontent-%COMP%]{border:4px solid transparent;display:flex;align-items:center;justify-content:center;background:#131c2a;width:36px;height:36px;cursor:move;color:#96a8c0;position:absolute;left:4px;top:12px;z-index:10;opacity:0}"],changeDetection:0}),gd([Object(r.e)(F.a.getStoryChapters),fd("design:type",m.a)],e.prototype,"chapters$",void 0),gd([Object(r.e)(F.a.getSelectedChapterId),fd("design:type",m.a)],e.prototype,"selectedChapterId$",void 0),gd([Object(r.e)(ji.b.getAllQuestions),fd("design:type",m.a)],e.prototype,"allQuestions$",void 0),gd([Object(r.e)(ji.b.getActiveQuestionId),fd("design:type",m.a)],e.prototype,"activeQuestionId$",void 0),gd([Object(r.e)(ji.b.getQuizEnabled),fd("design:type",m.a)],e.prototype,"quizEnabled$",void 0),e})();var Pd=function(e,t,i,n){var o,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,i,r):o(t,i))||r);return a>3&&r&&Object.defineProperty(t,i,r),r},Od=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function wd(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"div",1),ae.Vb(1,"button",2),ae.cc("click",(function(){return ae.Cc(e),ae.gc().handlePreviousClick()})),ae.Qb(2,"app-icon",3),ae.Ub(),ae.Vb(3,"span",4),ae.Pc(4),ae.hc(5,"async"),ae.Ub(),ae.Vb(6,"button",5),ae.cc("click",(function(){return ae.Cc(e),ae.gc().handleNextClick()})),ae.hc(7,"async"),ae.Qb(8,"app-icon",6),ae.Ub(),ae.Ub()}if(2&e){const e=ae.gc();let t=null,i=null;ae.Db(1),ae.mc("disabled",0===e.chapterIndex),ae.Db(3),ae.Sc(" ",e.chapterIndex+1," / ",null==(t=ae.ic(5,4,e.chapters$))?null:t.length," "),ae.Db(2),ae.mc("disabled",e.chapterIndex===(null==(i=ae.ic(7,6,e.chapters$))?null:i.length)-1)}}let kd=(()=>{class e{constructor(e,t){this.store=e,this.changeDetectorRef=t,this.ngUnsubscribe=new c.a}ngOnInit(){this.selectedChapterIndex$.pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.chapterIndex=e,this.changeDetectorRef.markForCheck()})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}handlePreviousClick(){this.store.dispatch(new A.h)}handleNextClick(){this.store.dispatch(new A.g)}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(r.h),ae.Pb(ae.i))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-edit-chapter-pagination"]],decls:2,vars:3,consts:[["class","chapter-pagination","appEventFence","",4,"ngIf"],["appEventFence","",1,"chapter-pagination"],["type","button",1,"chapter-pagination__button","chapter-pagination__button--back",3,"disabled","click"],["size","lg","icon","angle-left"],[1,"chapter-pagination__count"],["type","button",1,"chapter-pagination__button","chapter-pagination__button--next",3,"disabled","click"],["size","lg","icon","angle-right"]],template:function(e,t){if(1&e&&(ae.Nc(0,wd,9,8,"div",0),ae.hc(1,"async")),2&e){let e=null;ae.mc("ngIf",(null==(e=ae.ic(1,1,t.chapters$))?null:e.length)>1)}},directives:[n.p,Ll.a,at.a],pipes:[n.b],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3535}.text-info{color:#2d72dc}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.chapter-pagination{display:flex;height:56px;align-items:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:relative}.chapter-pagination__button{background:transparent;border:none;color:#d7e0ea;padding:0 20px;flex:1 1 50%;height:100%;outline:none}.chapter-pagination__button:disabled{color:#61779e}.chapter-pagination__button:not(:disabled):hover{color:#fff;cursor:pointer}.chapter-pagination__button .app-button{height:100%}.chapter-pagination__button--back{text-align:left}.chapter-pagination__button--next{text-align:right}.chapter-pagination__count{font-size:12px;letter-spacing:.3px;line-height:1.4em;display:flex;align-items:center;white-space:nowrap;width:100%;height:100%;left:0;top:0;justify-content:center;position:absolute;pointer-events:none;z-index:10}"],encapsulation:2,changeDetection:0}),Pd([Object(r.e)(y.a.getStory),Od("design:type",m.a)],e.prototype,"story$",void 0),Pd([Object(r.e)(F.a.getSelectedChapter),Od("design:type",m.a)],e.prototype,"selectedChapter$",void 0),Pd([Object(r.e)(F.a.getSelectedChapterIndex),Od("design:type",m.a)],e.prototype,"selectedChapterIndex$",void 0),Pd([Object(r.e)(F.a.getStoryChapters),Od("design:type",m.a)],e.prototype,"chapters$",void 0),e})();var Sd=i("gcYM"),_d=i("rvu2"),Md=function(e,t,i,n){var o,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,i,r):o(t,i))||r);return a>3&&r&&Object.defineProperty(t,i,r),r},Ud=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const Td=["scrubber"];function Vd(e,t){1&e&&ae.Qb(0,"app-button-icon",6)}function Dd(e,t){1&e&&ae.Qb(0,"app-button-icon",7)}const Ed=function(e){return{"mr-4":e}};function jd(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"button",3),ae.cc("click",(function(){return ae.Cc(e),ae.gc().handlePlayClick()})),ae.Nc(1,Vd,1,0,"app-button-icon",4),ae.hc(2,"async"),ae.Nc(3,Dd,1,0,"app-button-icon",5),ae.hc(4,"async"),ae.Ub()}if(2&e){const e=ae.gc();ae.mc("buttonTheme",e.theme)("ngClass",ae.pc(8,Ed,e.showScrubber)),ae.Db(1),ae.mc("ngIf",!ae.ic(2,4,e.animationPlaying$)),ae.Db(2),ae.mc("ngIf",ae.ic(4,6,e.animationPlaying$))}}function Nd(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"input",8,9),ae.cc("ngModelChange",(function(t){return ae.Cc(e),ae.gc().percent=t}))("mousedown",(function(){return ae.Cc(e),ae.gc().handleInputMouseDown()}))("mouseup",(function(){return ae.Cc(e),ae.gc().handleInputMouseUp()})),ae.Ub()}if(2&e){const e=ae.gc();ae.mc("ngModel",e.percent)}}let Rd=(()=>{class e{constructor(e,t,i,n){this.changeDetection=e,this.animationService=t,this.store=i,this.engineService=n,this.theme="dark",this.showPlay=!0,this.showScrubber=!0,this.playing=!1,this.wasPlaying=!1,this.ngUnsubscribe=new c.a,this._percent=0,this.scrub$=new an.a(0),this.interactive=!1,this.timeline=new _d.a}get percent(){return this._percent}set percent(e){this._percent=e,this.animationService.isPlaying()||this.scrubPercent(this.percent)}ngOnInit(){this.bindApplicationEvents()}ngOnDestroy(){this.changeDetection.detach(),this.ngUnsubscribe.next(),this.ngUnsubscribe.unsubscribe()}bindApplicationEvents(){this.selectedChapterId$.pipe(Object(O.a)(e=>!!e),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.initScrubber(e)}),this.engineService.getEvent(En.a.TimelinePlaying).pipe(Object(Sd.a)(50),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>this.tick(e.time)),this.engineService.getEvent(En.a.TimelineScrubbed).pipe(Object(Sd.a)(50),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.scrubber.nativeElement.value=this.getPercent(e.time)}),this.engineService.getEvent(En.a.TimelineTimeFrameUpdated).pipe(Object(P.a)(this.ngUnsubscribe),Object(O.a)(()=>null!=Object(W.get)(Human,"timeline.activeRoot._nowBranch.id"))).subscribe(()=>{const e=Human.timeline.activeRoot;e&&(this.timeline=this.animationService.getChapterLocalTimerange(e._nowBranch.id),this.percent=this.getPercent(Human.timeline.time),this.changeDetection.markForCheck())}),this.animationPlaying$.pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(e=>this.playing=e)}handleInputMouseDown(){this.wasPlaying=this.playing,this.store.dispatch(new D.W(!1))}handleInputMouseUp(){this.store.dispatch(new D.W(this.wasPlaying))}handlePlayClick(){this.play()}play(){const e=!this.store.selectSnapshot(x.a.getAnimationPlaying);this.store.dispatch(new D.W(e))}initScrubber(e){this.timeline=this.animationService.getChapterLocalTimerange(e),this.percent=0,this.changeDetection.markForCheck()}tick(e){this.percent=this.getPercent(e),this.changeDetection.markForCheck()}getPercent(e){return this.animationService.getLocalTime(e)/this.timeline.lastTime*100}scrubPercent(e){let t="first";0===e&&(t="second"),100===e&&(t="first");const i=Human.timeline.activeRoot._nowBranch,n=this.animationService.mapLocalTimeToGlobal(i.id,e/100*this.timeline.lastTime);this.animationService.scrub({time:n,which:t})}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(ae.i),ae.Pb(re.a),ae.Pb(r.h),ae.Pb(ce.a))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-engine-scrubber"]],viewQuery:function(e,t){if(1&e&&ae.Vc(Td,!0),2&e){let e;ae.xc(e=ae.dc())&&(t.scrubber=e.first)}},inputs:{theme:"theme",showPlay:"showPlay",showScrubber:"showScrubber"},decls:3,vars:2,consts:[[1,"engine-scrubber"],["app-button","","buttonSize","small","class","engine-scrubber__play",3,"buttonTheme","ngClass","click",4,"ngIf"],["class","engine-scrubber__input","type","range","style","width: 100%","min","0","max","100",3,"ngModel","ngModelChange","mousedown","mouseup",4,"ngIf"],["app-button","","buttonSize","small",1,"engine-scrubber__play",3,"buttonTheme","ngClass","click"],["label","Play","iconPlacement","left","icon","play",4,"ngIf"],["label","Pause","iconPlacement","left","icon","pause",4,"ngIf"],["label","Play","iconPlacement","left","icon","play"],["label","Pause","iconPlacement","left","icon","pause"],["type","range","min","0","max","100",1,"engine-scrubber__input",2,"width","100%",3,"ngModel","ngModelChange","mousedown","mouseup"],["scrubber",""]],template:function(e,t){1&e&&(ae.Vb(0,"div",0),ae.Nc(1,jd,5,10,"button",1),ae.Nc(2,Nd,2,1,"input",2),ae.Ub()),2&e&&(ae.Db(1),ae.mc("ngIf",t.showPlay),ae.Db(1),ae.mc("ngIf",t.showScrubber))},directives:[n.p,pe.a,n.m,Un.a,G.y,G.c,G.r,G.u],pipes:[n.b],styles:["[_nghost-%COMP%]{display:block;width:100%}.engine-scrubber[_ngcontent-%COMP%]{justify-content:center;align-items:center;display:flex;position:relative;width:100%;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.engine-scrubber__input[_ngcontent-%COMP%]{width:100%}.engine-scrubber__play[_ngcontent-%COMP%]{width:80px}"],changeDetection:0}),Md([Object(r.e)(F.a.getSelectedChapterId),Ud("design:type",m.a)],e.prototype,"selectedChapterId$",void 0),Md([Object(r.e)(F.a.getSelectedChapter),Ud("design:type",m.a)],e.prototype,"selectedChapter$",void 0),Md([Object(r.e)(x.a.getAnimationPlaying),Ud("design:type",m.a)],e.prototype,"animationPlaying$",void 0),Md([Object(r.e)(F.a.getSelectedChapterReadyState),Ud("design:type",m.a)],e.prototype,"readyState$",void 0),e})(),Ad=(()=>{class e{constructor(e){this.animationService=e}ngOnInit(){}handleClick(){this.animationService.scrubFrame(this.direction)}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(re.a))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-engine-frame-control"]],inputs:{direction:"direction"},decls:2,vars:1,consts:[["app-button","","buttonShape","square","type","button",3,"click"],["size","lg",3,"icon"]],template:function(e,t){1&e&&(ae.Vb(0,"button",0),ae.cc("click",(function(){return t.handleClick()})),ae.Qb(1,"app-icon",1),ae.Ub()),2&e&&(ae.Db(1),ae.mc("icon","next"===t.direction?"step-forward":"step-backward"))},directives:[pe.a,at.a],styles:[""],changeDetection:0}),e})();var Fd=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const Id=["currentTime"];let zd=(()=>{class e{constructor(e,t,i){this.changeDetection=e,this.engineService=t,this.animationService=i,this.ngUnsubscribe=new c.a,this.currentTimeFocused=!1}ngOnInit(){this.selectedChapterId$.pipe(Object(O.a)(e=>!Object(W.isNil)(e)),Object(P.a)(this.ngUnsubscribe)).subscribe(()=>{this.setChapterTimeFrame(),this.setCurrentTime(this.animationService.getLocalTime(Human.timeline.time)),this.changeDetection.markForCheck()}),Object(u.a)(this.engineService.getEvent(En.a.TimelinePlaying),this.engineService.getEvent(En.a.TimelineScrubbed)).pipe(Object(Sd.a)(20),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.setCurrentTime(this.animationService.getLocalTime(e.time))}),this.engineService.getEvent(En.a.TimelineTimeFrameUpdated).pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(()=>{this.setChapterTimeFrame(),this.changeDetection.markForCheck()})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}handleFocus(){this.currentTimeFocused=!0,this.currentTimeInput.nativeElement.value=""}handleBlur(){this.currentTimeFocused=!1,this.animationService.pause();let e=this.animationService.parseFormattedTime(this.currentTimeInput.nativeElement.value||this.currentTime);e=this.animationService.constrainLocalTime(e);const t=Human.timeline.activeRoot._nowBranch.id,i=this.animationService.mapLocalTimeToGlobal(t,e);this.animationService.scrub({time:i})}setChapterTimeFrame(){const e=Human.timeline.activeRoot._nowBranch.getTimeFrame();this.duration=this.animationService.formatTime(e.lastTime)}setCurrentTime(e){this.currentTime=this.animationService.formatTime(e),this.currentTimeFocused||(this.currentTimeInput.nativeElement.value=this.currentTime)}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(ae.i),ae.Pb(ce.a),ae.Pb(re.a))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-engine-current-time"]],viewQuery:function(e,t){if(1&e&&ae.Jc(Id,!0),2&e){let e;ae.xc(e=ae.dc())&&(t.currentTimeInput=e.first)}},decls:5,vars:1,consts:[[1,"engine-current-time"],["type","text",1,"input","engine-current-time__current-time",3,"focus","blur"],["currentTime",""],[1,"text-12","ml-2"]],template:function(e,t){1&e&&(ae.Vb(0,"div",0),ae.Vb(1,"input",1,2),ae.cc("focus",(function(){return t.handleFocus()}))("blur",(function(){return t.handleBlur()})),ae.Ub(),ae.Vb(3,"span",3),ae.Pc(4),ae.Ub(),ae.Ub()),2&e&&(ae.Db(4),ae.Rc("/ ",t.duration,""))},styles:[".engine-current-time[_ngcontent-%COMP%]{display:flex;align-items:center;color:#d7e0ea}.engine-current-time__current-time[type=text][_ngcontent-%COMP%]{width:100px;color:inherit}"],changeDetection:0}),function(e,t,i,n){var o,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,i,r):o(t,i))||r);a>3&&r&&Object.defineProperty(t,i,r)}([Object(r.e)(F.a.getSelectedChapterId),Fd("design:type",m.a)],e.prototype,"selectedChapterId$",void 0),e})();var Ld=function(e,t,i,n){var o,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,i,r):o(t,i))||r);return a>3&&r&&Object.defineProperty(t,i,r),r},Bd=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Qd(e,t){1&e&&(ae.Vb(0,"div",9),ae.Qb(1,"app-icon",10),ae.Ub())}function $d(e,t){1&e&&(ae.Vb(0,"div",11),ae.Qb(1,"app-icon",12),ae.Ub())}function qd(e,t){1&e&&(ae.Vb(0,"div",13),ae.Qb(1,"app-icon",14),ae.Ub())}const Gd=function(e,t){return{"timeline-map--selected":e,"timeline-map--overlapping":t}},Hd=function(e,t){return{"width.px":e,"left.px":t}};let Wd=(()=>{class e{constructor(e,t){this.animationService=e,this.changeDetectorRef=t,this.ngUnsubscribe=new c.a}ngOnInit(){const e=this.timelineMap.data.timeline,t=this.animationService.getLeafTimelines();this.hasAnimations=Object.keys(t[e].timelineAnimations).length>0,this.stateTimeRange=this.buildStateTimeRange(),this.looping=!this.timelineMap.data.fit&&"loop"===this.timelineMap.data.onEnd,this.initListeners()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}ngOnChanges(){const e=this.timelineMap.end-this.timelineMap.start;this.left=300*this.timelineMap.start*this.scale,this.width=300*e*this.scale}initListeners(){this.selectedTimelineMapIds$.pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.selected=e.has(this.timelineMap.id),this.changeDetectorRef.markForCheck()}),this.overlappingTimelineMapIds$.pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.overlapping=e.has(this.timelineMap.id),this.changeDetectorRef.markForCheck()})}buildStateTimeRange(){const e=this.timelineMap.data.end;return`${this.animationService.formatTime(this.timelineMap.data.start)} - ${this.animationService.formatTime(e)}`}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(re.a),ae.Pb(ae.i))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-timeline-map"]],inputs:{scale:"scale",timelineMap:"timelineMap"},features:[ae.Bb],decls:11,vars:13,consts:[[1,"timeline-map",3,"ngClass","ngStyle"],[1,"timeline-map__top"],[1,"timeline-map__name","text-10"],[1,"timeline-map__middle"],[1,"timeline-map__state-time-range","text-10"],[1,"timeline-map__bottom"],["class","timeline-map__no-animations mr-2",4,"ngIf"],["class","timeline-map__fit mr-2",4,"ngIf"],["class","timeline-map__loop",4,"ngIf"],[1,"timeline-map__no-animations","mr-2"],["icon","exclamation-circle","size","xs","matTooltip","This state has no animations"],[1,"timeline-map__fit","mr-2"],["icon","arrows-alt-h","size","xs"],[1,"timeline-map__loop"],["icon","repeat-alt","size","xs"]],template:function(e,t){1&e&&(ae.Vb(0,"div",0),ae.Vb(1,"div",1),ae.Vb(2,"div",2),ae.Pc(3),ae.Ub(),ae.Ub(),ae.Vb(4,"div",3),ae.Vb(5,"div",4),ae.Pc(6),ae.Ub(),ae.Ub(),ae.Vb(7,"div",5),ae.Nc(8,Qd,2,0,"div",6),ae.Nc(9,$d,2,0,"div",7),ae.Nc(10,qd,2,0,"div",8),ae.Ub(),ae.Ub()),2&e&&(ae.mc("ngClass",ae.qc(7,Gd,t.selected,t.overlapping))("ngStyle",ae.qc(10,Hd,t.width,t.left)),ae.Db(3),ae.Qc(t.timelineMap.name),ae.Db(3),ae.Qc(t.stateTimeRange),ae.Db(2),ae.mc("ngIf",!t.hasAnimations),ae.Db(1),ae.mc("ngIf",t.timelineMap.data.fit),ae.Db(1),ae.mc("ngIf",t.looping))},directives:[n.m,n.q,n.p,at.a,st.c],styles:[".timeline-map[_ngcontent-%COMP%]{position:absolute;height:100%;background-color:#283853;border:2px solid transparent;border-right:1px solid #131c2a;cursor:pointer;display:flex;flex-direction:column;justify-content:space-evenly;min-width:0;padding:0 4px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.timeline-map__bottom[_ngcontent-%COMP%], .timeline-map__middle[_ngcontent-%COMP%], .timeline-map__top[_ngcontent-%COMP%]{display:flex;min-height:33%;flex:0 0 33%;align-items:center}.timeline-map__name[_ngcontent-%COMP%], .timeline-map__state-time-range[_ngcontent-%COMP%]{color:#d7e0ea;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.timeline-map__bottom[_ngcontent-%COMP%]{overflow:hidden}.timeline-map__fit[_ngcontent-%COMP%]{color:#ff0}.timeline-map__loop[_ngcontent-%COMP%]{color:#0ff}.timeline-map--selected[_ngcontent-%COMP%]{border:2px solid #2d72dc;z-index:1}.timeline-map--overlapping[_ngcontent-%COMP%]{background-color:#a81914}"],changeDetection:0}),Ld([Object(r.e)($i.getSelectedTimelineMapIds),Bd("design:type",m.a)],e.prototype,"selectedTimelineMapIds$",void 0),Ld([Object(r.e)($i.getOverlappingTimelineMapIds),Bd("design:type",m.a)],e.prototype,"overlappingTimelineMapIds$",void 0),e})();var Kd=function(e,t,i,n){var o,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,i,r):o(t,i))||r);return a>3&&r&&Object.defineProperty(t,i,r),r},Jd=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const Xd=["leafTimelinesWindow"],Zd=["rulerWindow"],Yd=["tracksWindow"],eu=["timelineRuler"],tu=["currentTimeHead"],iu=["currentTimeLine"],nu=["hoverTimeHead"],ou=["hoverTimeLine"],au=["hoverTimeLabel"],ru=function(e){return{"left.px":e}},su=function(e){return{"edit-timeline__seconds-mark":e}};function cu(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"div",41),ae.cc("mouseenter",(function(){ae.Cc(e);const i=t.index;return ae.gc().handleRulerMarkMouseEnter(i)})),ae.Vb(1,"div",42),ae.cc("click",(function(){ae.Cc(e);const i=t.index;return ae.gc().scrubToRulerMark(i)})),ae.Pc(2),ae.Ub(),ae.Ub()}if(2&e){const e=t.$implicit;ae.mc("ngStyle",ae.pc(3,ru,e.left))("ngClass",ae.pc(5,su,e.seconds)),ae.Db(2),ae.Rc(" ",e.label," ")}}function lu(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"div",43),ae.cc("click",(function(i){ae.Cc(e);const n=t.$implicit;return ae.gc().handleLeafTimelineClick(i,n)})),ae.Vb(1,"div",44),ae.Pc(2),ae.Ub(),ae.Vb(3,"button",45),ae.Qb(4,"app-icon",46),ae.Ub(),ae.Vb(5,"mat-menu",null,47),ae.Vb(7,"button",48),ae.cc("click",(function(){ae.Cc(e);const i=t.$implicit;return ae.gc().addTimelineMap(i)})),ae.Pc(8,"Add Clip"),ae.Ub(),ae.Vb(9,"button",49),ae.cc("click",(function(){ae.Cc(e);const i=t.$implicit;return ae.gc().pasteTimelineMaps(i)})),ae.Pc(10),ae.Ub(),ae.Ub(),ae.Ub()}if(2&e){const e=t.$implicit,i=ae.yc(6),n=ae.gc();ae.Db(2),ae.Rc(" ",e.id," "),ae.Db(1),ae.mc("matMenuTriggerFor",i),ae.Db(6),ae.mc("disabled",!n.hasCopiedTimelineMaps),ae.Db(1),ae.Rc(" ",n.pasteClipsText," ")}}function pu(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"app-timeline-map",52),ae.cc("click",(function(i){ae.Cc(e);const n=t.$implicit;return ae.gc(2).handleTimelineMapClick(i,n)})),ae.Ub()}if(2&e){const e=t.$implicit,i=ae.gc(2);ae.mc("scale",i.scale)("timelineMap",e)}}function du(e,t){if(1&e&&(ae.Vb(0,"div",50),ae.Nc(1,pu,1,2,"app-timeline-map",51),ae.Ub()),2&e){const e=t.$implicit;ae.Db(1),ae.mc("ngForOf",e)}}const uu=function(e){return{"width.px":e}},hu=function(e){return{"edit-timeline__hover-time-head--show":e}},mu=function(e){return{"height.px":e}},bu=function(e){return{"edit-timeline__hover-time-line--show":e}};let gu=(()=>{class e{constructor(e,t,i,n,o){this.store=e,this.animationService=t,this.engineService=i,this.renderer=n,this.changeDetectorRef=o,this.showHoverTimeIndicator=!1,this.ngUnsubscribe=new c.a}ngOnInit(){this.setLeafTimelines(),this.setScrollbarWidth(),this.setLeafTimelinesWindowWidth(),this.initListeners(),this.initEngineEventListeners(),this.initBrowserEventListeners()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initListeners(){this.scale$.pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.setScale(e),this.setCurrentTimeIndicator(this.animationService.getLocalTime(Human.timeline.time)),this.buildRulerMarks(),this.checkOverflowX(),this.changeDetectorRef.markForCheck()}),this.selectedTimelineMapIds$.pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.selectedTimelineMapIds=e,this.changeDetectorRef.markForCheck()}),this.copiedTimelineMaps$.pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.copiedTimelineMaps=e,this.setHasCopiedTimelineMaps(),this.changeDetectorRef.markForCheck()}),this.selectedChapterTimelineMap$.pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.buildChapterLeafTimelinesMaps(e),this.checkTimelineMapOverlaps(),this.changeDetectorRef.markForCheck()}),this.selectedChapterId$.pipe(Object(O.a)(e=>!Object(W.isNil)(e)),Object(P.a)(this.ngUnsubscribe)).subscribe(()=>{this.setChapterTimeFrame(),this.setCurrentTimeIndicator(this.animationService.getLocalTime(Human.timeline.time)),this.store.dispatch(new Ii.SetSelectedTimelineMapIds([])),this.changeDetectorRef.markForCheck()}),this.loadChunksRemaining$.pipe(Object(O.a)(e=>0===e.length),Object(P.a)(this.ngUnsubscribe)).subscribe(()=>{this.setLeafTimelines(),this.setChapterTimeFrame(),this.changeDetectorRef.markForCheck()})}initEngineEventListeners(){Object(u.a)(this.engineService.getEvent(En.a.TimelinePlaying),this.engineService.getEvent(En.a.TimelineScrubbed)).pipe(Object(Sd.a)(20),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.setCurrentTimeIndicator(this.animationService.getLocalTime(e.time))}),this.engineService.getEvent(En.a.TimelineTimeFrameUpdated).pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(()=>{this.setChapterTimeFrame(),this.changeDetectorRef.markForCheck()})}initBrowserEventListeners(){Object(p.a)(window,"resize").pipe(Object(pi.a)(50),Object(P.a)(this.ngUnsubscribe)).subscribe(()=>{this.checkOverflowX(),this.changeDetectorRef.markForCheck()}),Object(p.a)(this.tracksWindow.nativeElement,"scroll").pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(()=>this.handleTracksScroll()),Object(p.a)(this.leafTimelinesWindow.nativeElement,"scroll").pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(()=>this.handleLeafTimelinesScroll())}checkOverflowX(){this.overflowX=this.tracksContainerWidth>this.tracksWindow.nativeElement.clientWidth}handleCTIMouseDown(e){e.preventDefault();const t=Object(p.a)(window,"mousemove"),i=Object(p.a)(window,"mouseup").pipe(Object(T.a)()),n=this.tracksWindow.nativeElement.getBoundingClientRect();this.scrubbing=!0,i.subscribe(()=>{this.scrubbing=!1,this.autoScrolling=!1}),t.pipe(Object(Sd.a)(20),Object(P.a)(i)).subscribe(e=>{const t=e.clientX;if(this.overflowX&&(t>n.right||t<n.left?(this.autoScrollOffset=t>n.right?t-n.right:t-n.left,this.autoScrolling||(this.autoScrolling=!0,this.autoScroll())):this.autoScrolling=!1),!this.autoScrolling){const e=this.timelineRuler.nativeElement.getBoundingClientRect();this.scrubLocalTime((t-e.left)/(300*this.scale))}})}autoScroll(){const e=this.tracksWindow.nativeElement.getBoundingClientRect(),t=()=>{const i=this.tracksWindow.nativeElement.scrollLeft;let n;n=this.autoScrollOffset<0?(i-20)/(300*this.scale):(e.width+i-20)/(300*this.scale),this.scrubLocalTime(n+this.autoScrollOffset/(300*this.scale));const o=(this.autoScrollOffset>0?1:-1)*Math.sqrt(Math.abs(this.autoScrollOffset));this.setTracksScrollLeft(i+o),this.autoScrolling&&requestAnimationFrame(t)};requestAnimationFrame(t)}handleTracksScroll(){this.ignoreScrollEvent?this.ignoreScrollEvent=!1:this.setLeafTimelinesScrollTop(this.tracksWindow.nativeElement.scrollTop),this.setRulerScrollLeft(this.tracksWindow.nativeElement.scrollLeft)}handleLeafTimelinesScroll(){this.ignoreScrollEvent?this.ignoreScrollEvent=!1:this.setTracksScrollTop(this.leafTimelinesWindow.nativeElement.scrollTop)}setRulerScrollLeft(e){this.rulerWindow.nativeElement.scrollLeft=e}setTracksScrollLeft(e){this.tracksWindow.nativeElement.scrollLeft=e}setTracksScrollTop(e){this.ignoreScrollEvent=!0,this.tracksWindow.nativeElement.scrollTop=e}setLeafTimelinesScrollTop(e){this.ignoreScrollEvent=!0,this.leafTimelinesWindow.nativeElement.scrollTop=e}handleRulerMarkMouseEnter(e){if(!this.scrubbing){this.showHoverTimeIndicator=!0;let t=e/this.rulerMarksPerSecond;t=this.animationService.toNearestFrame(t),this.setHoverTimeIndicator(t)}}handleRulerMouseEnter(e){if(!this.scrubbing){this.showHoverTimeIndicator=!0;let t=e.offsetX/(300*this.scale);t=this.animationService.toNearestFrame(t),this.setHoverTimeIndicator(t)}}handleRulerMouseMove(e){if(!this.scrubbing&&e.currentTarget===e.target){let t=e.offsetX/(300*this.scale);t=this.animationService.toNearestFrame(t),this.setHoverTimeIndicator(t)}}handleRulerMouseLeave(){this.showHoverTimeIndicator=!1}handleTimelineMapClick(e,t){e.shiftKey?this.selectedTimelineMapIds.has(t.id)?this.store.dispatch(new Ii.RemoveFromSelectedTimelineMapIds([t.id])):this.store.dispatch(new Ii.AddToSelectedTimelineMapIds([t.id])):this.store.dispatch(new Ii.SetSelectedTimelineMapIds([t.id]))}handleLeafTimelineClick(e,t){const i=this.leafTimelines.indexOf(t),n=this.chapterLeafTimelinesMaps[i].map(e=>e.id);if(e.shiftKey){const e=n.every(e=>this.selectedTimelineMapIds.has(e));this.store.dispatch(e?new Ii.RemoveFromSelectedTimelineMapIds(n):new Ii.AddToSelectedTimelineMapIds(n))}else this.store.dispatch(new Ii.SetSelectedTimelineMapIds(n))}buildChapterLeafTimelinesMaps(e){this.chapterLeafTimelinesMaps=[],this.leafTimelines.forEach(t=>{const i=e.filter(e=>e.data.timeline===t.id);this.chapterLeafTimelinesMaps.push(i)})}checkTimelineMapOverlaps(){const e=new Set;this.chapterLeafTimelinesMaps.forEach(t=>{for(let i=0;i<t.length-1;i++){const n=t[i];for(let o=i+1;o<t.length;o++){const i=t[o];let a;a=n.start<i.start?n.end>i.start:n.start<i.end,a&&e.add(n.id).add(i.id)}}}),this.store.dispatch(new Ii.SetOverlappingTimelineMapIds(Array.from(e)))}pasteTimelineMaps(e){const t=this.copiedTimelineMaps.map(t=>((t=Object(W.cloneDeep)(t)).data.timeline=e.id,t)),i=Human.timeline.activeRoot._nowBranch;t.forEach(e=>{this.animationService.addTimelineMap(i,e)}),this.store.dispatch(new A.b(i.id,t))}setHasCopiedTimelineMaps(){const e=this.copiedTimelineMaps.length;this.hasCopiedTimelineMaps=e>0,this.pasteClipsText=this.hasCopiedTimelineMaps?1===e?"Paste Clip":`Paste ${e} Clips`:"Paste Clips"}addTimelineMap(e){const t=Human.timeline.activeRoot._nowBranch,i=t.getLeafTimelineMaps(e),n=Object.keys(e.timelineAnimations).length>0;let o,a,r,s,c=0;if(i.forEach(e=>{e.end>c&&(c=e.end)}),o=c,n){const t=e.getTimeFrame();a=o+(t.lastTime-t.firstTime),r=t.firstTime,s=t.lastTime}else a=o+2,r=0,s=0;const l={start:o,end:a,name:"",data:{timeline:e.id,start:r,end:s,fit:!1,onEnd:"freeze"}};this.animationService.addTimelineMap(t,l),this.store.dispatch(new A.b(t.id,[l]))}setLeafTimelines(){this.leafTimelines=Object.values(this.animationService.getLeafTimelines())}setChapterTimeFrame(){const e=Human.timeline.activeRoot._nowBranch.getTimeFrame();this.globalStartTime=this.getGlobalTime(e.firstTime),this.globalEndTime=this.getGlobalTime(e.lastTime),this.chapterDuration=e.lastTime,this.setTracksWidths(),this.buildRulerMarks(),this.checkOverflowX()}setScale(e){this.scale=e,this.rulerMarksPerSecond=.1===this.scale?1:.25===this.scale?2:3,this.setTracksWidths()}buildRulerMarks(){const e=Math.floor(this.chapterDuration*this.rulerMarksPerSecond)+1;this.rulerMarks=[];const t=e=>e/this.rulerMarksPerSecond+"s",i=e=>e%this.rulerMarksPerSecond*(this.animationService.fps/this.rulerMarksPerSecond)+"f";for(let n=0;n<e;n++){const e=n%this.rulerMarksPerSecond==0,o=e?t(n):i(n);this.rulerMarks.push({left:n*(300/this.rulerMarksPerSecond)*this.scale,label:o,seconds:e})}}setCurrentTimeIndicator(e){const t=`translate3d(${300*e*this.scale}px, 0px, 0px)`;this.renderer.setStyle(this.currentTimeHead.nativeElement,"transform",t),this.renderer.setStyle(this.currentTimeLine.nativeElement,"transform",t)}setHoverTimeIndicator(e){const t=`translate3d(${300*e*this.scale}px, 0px, 0px)`;this.renderer.setStyle(this.hoverTimeHead.nativeElement,"transform",t),this.renderer.setStyle(this.hoverTimeLine.nativeElement,"transform",t),this.renderer.setStyle(this.hoverTimeLabel.nativeElement,"transform",`translate3d(0px, ${this.tracksWindow.nativeElement.scrollTop}px, 0px)`),this.hoverTimeFormatted=this.animationService.formatTime(e),this.hoverTimeFrames=this.animationService.secondsToFrames(e)+"f",this.hoverTimeSeconds=Math.round(1e4*e)/1e4+"s"}setTracksWidths(){this.chapterWidth=300*this.chapterDuration*this.scale,this.tracksContainerWidth=this.chapterWidth+40}scrubToRulerMark(e){const t=e/this.rulerMarksPerSecond;this.animationService.pause(),this.scrubLocalTime(t)}scrubToRulerPosition(e){let t=e.offsetX/(300*this.scale);t=this.animationService.toNearestFrame(t),this.animationService.pause(),this.scrubLocalTime(t)}getGlobalTime(e){const t=Human.timeline.activeRoot._nowBranch;return this.animationService.mapLocalTimeToGlobal(t.id,e)}setLeafTimelinesWindowWidth(){this.renderer.setStyle(this.leafTimelinesWindow.nativeElement,"width",`calc(100% + ${this.scrollBarWidth}px)`)}setScrollbarWidth(){const e=this.tracksWindow.nativeElement;this.scrollBarWidth=e.offsetWidth-e.clientWidth}scrubLocalTime(e){let t=this.getGlobalTime(e),i="first";t<this.globalStartTime&&(t=this.globalStartTime),t>this.globalEndTime&&(t=this.globalEndTime),t===this.globalStartTime&&(i="second"),this.animationService.scrub({time:t,which:i})}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(r.h),ae.Pb(re.a),ae.Pb(ce.a),ae.Pb(ae.H),ae.Pb(ae.i))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-edit-timeline"]],viewQuery:function(e,t){if(1&e&&(ae.Jc(Xd,!0),ae.Jc(Zd,!0),ae.Jc(Yd,!0),ae.Jc(eu,!0),ae.Jc(tu,!0),ae.Jc(iu,!0),ae.Jc(nu,!0),ae.Jc(ou,!0),ae.Jc(au,!0)),2&e){let e;ae.xc(e=ae.dc())&&(t.leafTimelinesWindow=e.first),ae.xc(e=ae.dc())&&(t.rulerWindow=e.first),ae.xc(e=ae.dc())&&(t.tracksWindow=e.first),ae.xc(e=ae.dc())&&(t.timelineRuler=e.first),ae.xc(e=ae.dc())&&(t.currentTimeHead=e.first),ae.xc(e=ae.dc())&&(t.currentTimeLine=e.first),ae.xc(e=ae.dc())&&(t.hoverTimeHead=e.first),ae.xc(e=ae.dc())&&(t.hoverTimeLine=e.first),ae.xc(e=ae.dc())&&(t.hoverTimeLabel=e.first)}},decls:48,vars:42,consts:[[1,"edit-timeline"],[1,"edit-timeline__header-left"],[1,"edit-timeline__frame-controls"],["direction","previous",1,"ml-2"],["direction","next",1,"mr-2"],[1,"edit-timeline__header"],[1,"edit-timeline__ruler-window"],["rulerWindow",""],[1,"edit-timeline__ruler-container",3,"ngStyle"],[1,"edit-timeline__ruler",3,"ngStyle","mouseenter","mousemove","mouseleave","click"],["timelineRuler",""],["appEventFence","","class","edit-timeline__ruler-mark",3,"ngStyle","ngClass","mouseenter",4,"ngFor","ngForOf"],[1,"edit-timeline__indicator-heads",3,"ngStyle"],[1,"edit-timeline__total-time-head",3,"ngStyle"],[1,"edit-timeline__current-time-head",3,"mousedown"],["currentTimeHead",""],["icon","grip-lines-vertical"],[1,"edit-timeline__hover-time-head",3,"ngClass"],["hoverTimeHead",""],[1,"edit-timeline__header-gutter",3,"ngStyle"],[1,"edit-timeline__body-left"],[1,"edit-timeline__leaf-timelines-window"],["leafTimelinesWindow",""],[1,"edit-timeline__leaf-timelines-container"],[1,"edit-timeline__leaf-timelines"],["class","edit-timeline__leaf-timeline",3,"click",4,"ngFor","ngForOf"],[1,"edit-timeline__body-left-gutter",3,"ngStyle"],[1,"edit-timeline__body"],[1,"edit-timeline__tracks-window"],["tracksWindow",""],[1,"edit-timeline__tracks-container",3,"ngStyle"],[1,"edit-timeline__tracks",3,"ngStyle"],["class","edit-timeline__track",4,"ngFor","ngForOf"],[1,"edit-timeline__indicator-lines",3,"ngStyle"],[1,"edit-timeline__total-time-line",3,"ngStyle"],[1,"edit-timeline__current-time-line"],["currentTimeLine",""],[1,"edit-timeline__hover-time-line",3,"ngClass"],["hoverTimeLine",""],[1,"edit-timeline__hover-time-line-label"],["hoverTimeLabel",""],["appEventFence","",1,"edit-timeline__ruler-mark",3,"ngStyle","ngClass","mouseenter"],[1,"edit-timeline__ruler-mark-label","text-11",3,"click"],[1,"edit-timeline__leaf-timeline",3,"click"],[1,"edit-timeline__leaf-timeline-label","text-12"],["app-button","","appEventFence","",3,"matMenuTriggerFor"],["icon","ellipsis-v"],["leafTimelineActionsMenu","matMenu"],["mat-menu-item","",3,"click"],["mat-menu-item","",3,"disabled","click"],[1,"edit-timeline__track"],[3,"scale","timelineMap","click",4,"ngFor","ngForOf"],[3,"scale","timelineMap","click"]],template:function(e,t){1&e&&(ae.Vb(0,"div",0),ae.Vb(1,"div",1),ae.Vb(2,"div",2),ae.Qb(3,"app-engine-frame-control",3),ae.Qb(4,"app-engine-frame-control",4),ae.Qb(5,"app-engine-current-time"),ae.Ub(),ae.Ub(),ae.Vb(6,"div",5),ae.Vb(7,"div",6,7),ae.Vb(9,"div",8),ae.Vb(10,"div",9,10),ae.cc("mouseenter",(function(e){return t.handleRulerMouseEnter(e)}))("mousemove",(function(e){return t.handleRulerMouseMove(e)}))("mouseleave",(function(){return t.handleRulerMouseLeave()}))("click",(function(e){return t.scrubToRulerPosition(e)})),ae.Nc(12,cu,3,7,"div",11),ae.Ub(),ae.Vb(13,"div",12),ae.Qb(14,"div",13),ae.Vb(15,"div",14,15),ae.cc("mousedown",(function(e){return t.handleCTIMouseDown(e)})),ae.Qb(17,"app-icon",16),ae.Ub(),ae.Qb(18,"div",17,18),ae.Ub(),ae.Ub(),ae.Ub(),ae.Qb(20,"div",19),ae.Ub(),ae.Vb(21,"div",20),ae.Vb(22,"div",21,22),ae.Vb(24,"div",23),ae.Vb(25,"div",24),ae.Nc(26,lu,11,4,"div",25),ae.Ub(),ae.Ub(),ae.Ub(),ae.Qb(27,"div",26),ae.Ub(),ae.Vb(28,"div",27),ae.Vb(29,"div",28,29),ae.Vb(31,"div",30),ae.Vb(32,"div",31),ae.Nc(33,du,2,1,"div",32),ae.Ub(),ae.Vb(34,"div",33),ae.Qb(35,"div",34),ae.Qb(36,"div",35,36),ae.Vb(38,"div",37,38),ae.Vb(40,"div",39,40),ae.Vb(42,"div"),ae.Pc(43),ae.Ub(),ae.Vb(44,"div"),ae.Pc(45),ae.Ub(),ae.Vb(46,"div"),ae.Pc(47),ae.Ub(),ae.Ub(),ae.Ub(),ae.Ub(),ae.Ub(),ae.Ub(),ae.Ub(),ae.Ub()),2&e&&(ae.Db(9),ae.mc("ngStyle",ae.pc(18,uu,t.tracksContainerWidth)),ae.Db(1),ae.mc("ngStyle",ae.pc(20,uu,t.chapterWidth)),ae.Db(2),ae.mc("ngForOf",t.rulerMarks),ae.Db(1),ae.mc("ngStyle",ae.pc(22,uu,t.chapterWidth)),ae.Db(1),ae.mc("ngStyle",ae.pc(24,ru,t.chapterWidth)),ae.Db(4),ae.mc("ngClass",ae.pc(26,hu,t.showHoverTimeIndicator)),ae.Db(2),ae.mc("ngStyle",ae.pc(28,uu,t.scrollBarWidth)),ae.Db(6),ae.mc("ngForOf",t.leafTimelines),ae.Db(1),ae.mc("ngStyle",ae.pc(30,mu,t.scrollBarWidth)),ae.Db(4),ae.mc("ngStyle",ae.pc(32,uu,t.tracksContainerWidth)),ae.Db(1),ae.mc("ngStyle",ae.pc(34,uu,t.chapterWidth)),ae.Db(1),ae.mc("ngForOf",t.chapterLeafTimelinesMaps),ae.Db(1),ae.mc("ngStyle",ae.pc(36,uu,t.chapterWidth)),ae.Db(1),ae.mc("ngStyle",ae.pc(38,ru,t.chapterWidth)),ae.Db(3),ae.mc("ngClass",ae.pc(40,bu,t.showHoverTimeIndicator)),ae.Db(5),ae.Qc(t.hoverTimeFormatted),ae.Db(2),ae.Qc(t.hoverTimeFrames),ae.Db(2),ae.Qc(t.hoverTimeSeconds))},directives:[Ad,zd,n.q,n.o,at.a,n.m,Ll.a,pe.a,Sn.d,Sn.a,Sn.b,Wd],styles:['.edit-timeline[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-webkit-scrollbar{width:12px;height:12px}.edit-timeline[_ngcontent-%COMP%]{display:grid;width:100%;background-color:#101823;grid-template-areas:"header-left header" "body-left body";grid-template-columns:320px 1fr;grid-template-rows:56px 1fr}.edit-timeline__header-left[_ngcontent-%COMP%]{grid-area:header-left;border-bottom:1px solid #283853;border-right:1px solid #283853}.edit-timeline__header[_ngcontent-%COMP%]{grid-area:header;display:flex}.edit-timeline__header-gutter[_ngcontent-%COMP%]{flex-shrink:0;border-left:1px solid #283853;border-bottom:1px solid #283853}.edit-timeline__body-left[_ngcontent-%COMP%]{grid-area:body-left;display:flex;flex-direction:column;border-right:1px solid #283853;overflow:hidden}.edit-timeline__body-left-gutter[_ngcontent-%COMP%]{flex-shrink:0;border-top:1px solid #283853}.edit-timeline__body[_ngcontent-%COMP%]{grid-area:body;overflow:hidden}.edit-timeline__frame-controls[_ngcontent-%COMP%]{display:flex;height:100%;align-items:center}.edit-timeline__ruler-window[_ngcontent-%COMP%]{position:relative;width:100%;height:100%;overflow:hidden}.edit-timeline__ruler-container[_ngcontent-%COMP%]{position:absolute;height:100%;display:flex;justify-content:center}.edit-timeline__ruler[_ngcontent-%COMP%]{position:relative;height:100%}.edit-timeline__ruler-mark[_ngcontent-%COMP%]{position:absolute;height:100%}.edit-timeline__ruler-mark[_ngcontent-%COMP%]:before{content:" ";bottom:0;position:absolute;height:22px;border-left:1px solid #283853}.edit-timeline__ruler-mark-label[_ngcontent-%COMP%]{color:#61779e;position:absolute;bottom:22px;cursor:pointer}.edit-timeline__ruler-mark-label[_ngcontent-%COMP%]:hover{color:#d7e0ea}.edit-timeline__seconds-mark[_ngcontent-%COMP%]:before{height:26px}.edit-timeline__seconds-mark[_ngcontent-%COMP%]   .edit-timeline__ruler-mark-label[_ngcontent-%COMP%]{color:#96a8c0;bottom:26px}.edit-timeline__seconds-mark[_ngcontent-%COMP%]   .edit-timeline__ruler-mark-label[_ngcontent-%COMP%]:hover{color:#d7e0ea}.edit-timeline__indicator-heads[_ngcontent-%COMP%]{position:absolute;pointer-events:none;height:100%;top:0}.edit-timeline__leaf-timelines-window[_ngcontent-%COMP%]{width:100%;height:100%;overflow-y:scroll;position:relative}.edit-timeline__leaf-timelines-container[_ngcontent-%COMP%]{width:100%;min-height:100%;display:flex;position:absolute}.edit-timeline__leaf-timelines[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%;background-color:#131c2a}.edit-timeline__leaf-timeline[_ngcontent-%COMP%]{display:flex;align-items:center;padding:0 8px;height:48px;border-bottom:1px solid #283853;cursor:pointer}.edit-timeline__leaf-timeline-label[_ngcontent-%COMP%]{flex-grow:1;padding:0 8px;word-break:break-all;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;color:#d7e0ea}.edit-timeline__leaf-timeline-label[_ngcontent-%COMP%]:hover{color:#fff}.edit-timeline__tracks-window[_ngcontent-%COMP%]{width:100%;height:100%;position:relative;overflow:scroll;background-color:#101823;scrollbar-color:#283853 transparent}.edit-timeline__tracks-window[_ngcontent-%COMP%]::-webkit-scrollbar:vertical{border-left:1px solid #283853}.edit-timeline__tracks-window[_ngcontent-%COMP%]::-webkit-scrollbar:horizontal{border-top:1px solid #283853}.edit-timeline__tracks-window[_ngcontent-%COMP%]::-webkit-scrollbar-track{background-color:transparent}.edit-timeline__tracks-window[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background-color:#374a68;border-radius:6px}.edit-timeline__tracks-window[_ngcontent-%COMP%]::-webkit-scrollbar-corner{background-color:transparent;border-top:1px solid #283853;border-left:1px solid #283853}.edit-timeline__tracks-container[_ngcontent-%COMP%]{position:absolute;min-height:100%;display:flex;justify-content:center}.edit-timeline__tracks[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;z-index:0}.edit-timeline__track[_ngcontent-%COMP%]{display:flex;position:relative;height:48px;background-color:#131c2a;border-bottom:1px solid #101823}.edit-timeline__indicator-lines[_ngcontent-%COMP%]{position:absolute;height:100%;top:0;pointer-events:none;z-index:1}.edit-timeline__current-time-head[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;left:0;height:50px;width:16px;margin-left:-8px;background-color:#2d72dc;cursor:pointer;color:#61779e;pointer-events:all}.edit-timeline__current-time-head[_ngcontent-%COMP%]:after{content:" ";position:absolute;bottom:-16px;border:8px solid transparent;border-top-color:#2d72dc}.edit-timeline__current-time-line[_ngcontent-%COMP%]{position:absolute;left:0;margin-left:-1px;height:100%;border-right:2px solid #2d72dc}.edit-timeline__total-time-head[_ngcontent-%COMP%]{position:absolute;height:50%;bottom:0;border-right:2px solid #283853}.edit-timeline__total-time-head[_ngcontent-%COMP%]:before{content:" ";position:absolute;height:12px;width:12px;margin-left:-5px;background-color:#283853}.edit-timeline__total-time-head[_ngcontent-%COMP%]:after{content:" ";position:absolute;top:12px;margin-left:-5px;border:6px solid transparent;border-top-color:#283853}.edit-timeline__total-time-line[_ngcontent-%COMP%]{position:absolute;height:100%;border-right:2px solid #283853}.edit-timeline__hover-time-head[_ngcontent-%COMP%]{position:absolute;display:none;height:100%;border-right:1px solid #2d72dc}.edit-timeline__hover-time-head--show[_ngcontent-%COMP%]{display:flex}.edit-timeline__hover-time-line[_ngcontent-%COMP%]{position:absolute;display:none;justify-content:center;height:100%;border-right:1px solid #2d72dc}.edit-timeline__hover-time-line--show[_ngcontent-%COMP%]{display:flex}.edit-timeline__hover-time-line-label[_ngcontent-%COMP%]{position:absolute;top:4px;color:#fff;background:rgba(16,24,35,.8);border-radius:4px;font-size:10px;padding:0 8px}.edit-timeline__hover-time-line-label[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{margin:4px 0}'],changeDetection:0}),Kd([Object(r.e)($i.getScale),Jd("design:type",m.a)],e.prototype,"scale$",void 0),Kd([Object(r.e)($i.getSelectedTimelineMapIds),Jd("design:type",m.a)],e.prototype,"selectedTimelineMapIds$",void 0),Kd([Object(r.e)($i.getCopiedTimelineMaps),Jd("design:type",m.a)],e.prototype,"copiedTimelineMaps$",void 0),Kd([Object(r.e)(y.a.getLoadChunksRemaining),Jd("design:type",m.a)],e.prototype,"loadChunksRemaining$",void 0),Kd([Object(r.e)(F.a.getSelectedChapterId),Jd("design:type",m.a)],e.prototype,"selectedChapterId$",void 0),Kd([Object(r.e)(F.a.getSelectedChapterTimelineMap),Jd("design:type",m.a)],e.prototype,"selectedChapterTimelineMap$",void 0),e})();var fu=function(e,t,i,n){var o,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,i,r):o(t,i))||r);return a>3&&r&&Object.defineProperty(t,i,r),r},xu=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function yu(e,t){if(1&e){const e=ae.Wb();ae.Tb(0),ae.Vb(1,"div"),ae.Pc(2),ae.Ub(),ae.Vb(3,"button",6),ae.Qb(4,"app-icon",7),ae.Ub(),ae.Vb(5,"mat-menu",null,8),ae.Vb(7,"button",9),ae.cc("click",(function(){return ae.Cc(e),ae.gc().copyTimelineMaps()})),ae.Pc(8,"Copy"),ae.Ub(),ae.Vb(9,"button",9),ae.cc("click",(function(){return ae.Cc(e),ae.gc().duplicateTimelineMap()})),ae.Pc(10,"Duplicate"),ae.Ub(),ae.Vb(11,"button",9),ae.cc("click",(function(){return ae.Cc(e),ae.gc().deleteTimelineMaps()})),ae.Pc(12,"Remove"),ae.Ub(),ae.Ub(),ae.Sb()}if(2&e){const e=ae.yc(6),t=ae.gc();ae.Db(2),ae.Qc(t.selectedTimelineMapsLabel),ae.Db(1),ae.mc("matMenuTriggerFor",e)}}function vu(e,t){1&e&&(ae.Vb(0,"div",11),ae.Vb(1,"app-form-field",27),ae.Vb(2,"mat-radio-group",28),ae.Vb(3,"mat-radio-button",29),ae.Pc(4,"Freeze "),ae.Ub(),ae.Vb(5,"mat-radio-button",30),ae.Pc(6,"Loop "),ae.Ub(),ae.Ub(),ae.Ub(),ae.Ub())}function Cu(e,t){if(1&e&&(ae.Tb(0),ae.Vb(1,"form",10),ae.Vb(2,"div",11),ae.Vb(3,"app-form-field",12),ae.Qb(4,"input",13,14),ae.Qb(6,"app-character-counter",15),ae.Ub(),ae.Ub(),ae.Vb(7,"div",11),ae.Vb(8,"app-form-field",16),ae.Qb(9,"input",17),ae.Ub(),ae.Vb(10,"app-form-field",18),ae.Qb(11,"input",19),ae.Ub(),ae.Ub(),ae.Vb(12,"div",11),ae.Vb(13,"app-form-field",20),ae.Qb(14,"input",21),ae.Ub(),ae.Vb(15,"app-form-field",22),ae.Qb(16,"input",23),ae.Ub(),ae.Ub(),ae.Vb(17,"div",11),ae.Vb(18,"mat-checkbox",24),ae.Vb(19,"span",25),ae.Pc(20,"Fit clip to timeline."),ae.Ub(),ae.Ub(),ae.Ub(),ae.Nc(21,vu,7,0,"div",26),ae.Ub(),ae.Sb()),2&e){const e=ae.yc(5),t=ae.gc();ae.Db(1),ae.mc("formGroup",t.form),ae.Db(5),ae.mc("field",e),ae.Db(12),ae.mc("indeterminate",t.indeterminateFit),ae.Db(3),ae.mc("ngIf",t.fitIsFalse)}}function Pu(e,t){1&e&&(ae.Vb(0,"p",31),ae.Pc(1,"Click on a clip in the timeline panel to edit it."),ae.Ub())}const Ou=/(^[+-/*]=)(.+$)/;let wu=(()=>{class e{constructor(e,t,i,n){this.store=e,this.formBuilder=t,this.animationService=i,this.changeDetectorRef=n,this.ngUnsubscribe=new c.a}ngOnInit(){this.form=this.formBuilder.group({name:[null,G.C.maxLength(100)],start:null,end:null,dataStart:null,dataEnd:null,fit:[null,{updateOn:"change"}],onEnd:[null,{updateOn:"change"}]},{updateOn:"blur"}),this.form.valueChanges.pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.handleFormChanges(e)}),this.selectedChapterTimelineMap$.pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.chapterTimelineMaps=e}),this.selectedTimelineMapIds$.pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.selectedTimelineMapIds=Array.from(e),this.buildAggregateTimelineMap(),this.setFormValues(),this.setHasSelectedTimelineMaps(),this.setSelectedTimelineMapsLabel(),this.changeDetectorRef.markForCheck()})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}getSelectedTimelineMaps(){return this.selectedTimelineMapIds.map(e=>this.chapterTimelineMaps.find(t=>e===t.id))}getTimelineMap(e){return this.chapterTimelineMaps.find(t=>e===t.id)}buildAggregateTimelineMap(){const e=[],t=[],i=[],n=[],o=[],a=[],r=[],s=(e,t,i)=>e===i[0],c=(e,t)=>e&&t.length>0?t[0]:null;this.getSelectedTimelineMaps().forEach(s=>{e.push(s.name),t.push(s.start),i.push(s.end),n.push(s.data.start),o.push(s.data.end),a.push(s.data.fit),r.push(s.data.onEnd)});const l=e.every(s),p=t.every(s),d=i.every(s),u=n.every(s),h=o.every(s),m=a.every(s),b=r.every(s);this.aggregateTimelineMap={name:c(l,e),start:c(p,t),end:c(d,i),dataStart:c(u,n),dataEnd:c(h,o),fit:c(m,a),onEnd:c(b,r)}}setFormValues(){let e=this.aggregateTimelineMap.start,t=this.aggregateTimelineMap.end,i=this.aggregateTimelineMap.dataStart,n=this.aggregateTimelineMap.dataEnd;"number"==typeof e&&(e=this.animationService.formatTime(e)),"number"==typeof t&&(t=this.animationService.formatTime(t)),"number"==typeof i&&(i=this.animationService.formatTime(i)),"number"==typeof n&&(n=this.animationService.formatTime(n)),this.form.setValue({name:this.aggregateTimelineMap.name,start:e,end:t,dataStart:i,dataEnd:n,fit:this.aggregateTimelineMap.fit,onEnd:this.aggregateTimelineMap.onEnd},{emitEvent:!1}),this.indeterminateFit=null===this.aggregateTimelineMap.fit,this.fitIsFalse=!1===this.aggregateTimelineMap.fit}parseTimeInput(e){const t=e.match(Ou);if(t){const e=t[1],i=this.animationService.parseFormattedTime(t[2]);return new Function("value",`return value ${e} ${i}`)}return this.animationService.parseFormattedTime(e)}handleFormChanges(e){const t=Object.entries(e).filter(([e,t])=>"name"===e?null!==t:null!==t&&""!==t),i=Object.fromEntries(t);["start","end","dataStart","dataEnd"].forEach(e=>{i.hasOwnProperty(e)&&(i[e]=this.parseTimeInput(i[e]))}),this.updateTimelineMaps(this.buildUpdates(i)),this.buildAggregateTimelineMap(),this.setFormValues()}buildUpdates(e){const t=Array.from(this.store.selectSnapshot($i.getSelectedTimelineMapIds)),i=(e,t)=>{let i="function"==typeof t?t(e):t;return i<0&&(i=e),i};return t.map(t=>{const n={id:t},o=this.getTimelineMap(t);return Object.entries(e).forEach(([e,t])=>{switch(e){case"start":case"end":n[e]=i(o[e],t);break;case"dataStart":n.data=n.data||{},n.data.start=i(o.data.start,t);break;case"dataEnd":n.data=n.data||{},n.data.end=i(o.data.end,t);break;case"fit":n.data=n.data||{},n.data.fit=t;break;case"onEnd":n.data=n.data||{},n.data.onEnd=t;break;default:n[e]=t}}),n})}copyTimelineMaps(){const e=Array.from(this.selectedTimelineMapIds).map(e=>{const t=this.getTimelineMap(e),i=Object(W.cloneDeep)(t);return delete i.id,i});this.store.dispatch(new Ii.SetCopiedTimelineMaps(e))}duplicateTimelineMap(){const e=[],t=Human.timeline.activeRoot._nowBranch,i=this.getSelectionOffset();this.getSelectedTimelineMaps().forEach(t=>{const n=Object(W.cloneDeep)(t),o=n.end-n.start;delete n.id,n.start=n.start+i,n.end=n.start+o,e.push(n)}),e.forEach(e=>{this.animationService.addTimelineMap(t,e)}),this.store.dispatch(new A.b(t.id,e))}updateTimelineMaps(e){const t=Human.timeline.activeRoot._nowBranch;this.animationService.updateTimelineMaps(t,e),this.store.dispatch(new A.J(t.id,e))}deleteTimelineMaps(){const e=Human.timeline.activeRoot._nowBranch,t=Array.from(this.store.selectSnapshot($i.getSelectedTimelineMapIds));this.animationService.deleteTimelineMaps(e,t),this.store.dispatch(new A.l(e.id,t)),this.store.dispatch(new Ii.SetSelectedTimelineMapIds([]))}setSelectedTimelineMapsLabel(){this.selectedTimelineMapsLabel=`${this.selectedTimelineMapIds.length} ${this.selectedTimelineMapIds.length>1?"clips":"clip"} selected`}setHasSelectedTimelineMaps(){this.hasSelectedTimelineMaps=this.selectedTimelineMapIds.length>0}getSelectionOffset(){const e=this.getSelectedTimelineMaps(),t={},i=Human.timeline.activeRoot._nowBranch;e.forEach(e=>{const n=e.data.timeline;if(!t.hasOwnProperty(n)){const e=this.animationService.getLeafTimelines()[n],o=i.getLeafTimelineMaps(e);let a=0;o.forEach(e=>{e.end>a&&(a=e.end)}),t[n]=a}});const n=Object.values(t),o=Math.max(...n);let a=1/0;return e.forEach(e=>{e.start<a&&(a=e.start)}),o-a}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(r.h),ae.Pb(G.f),ae.Pb(re.a),ae.Pb(ae.i))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-edit-timeline-maps"]],decls:7,vars:3,consts:[[1,"edit-timeline-maps"],[1,"edit-timeline-maps__header"],[4,"ngIf"],[1,"edit-timeline-maps__body"],[4,"ngIf","ngIfElse"],["noSelectedTimelineMaps",""],["app-button","",3,"matMenuTriggerFor"],["icon","ellipsis-v"],["timelineMapsActionsMenu","matMenu"],["mat-menu-item","",3,"click"],["autocomplete","off",1,"edit-timeline-maps__form",3,"formGroup"],[1,"edit-timeline-maps__form-row"],["label","Name",1,"flex-grow"],["type","text","maxlength","100","formControlName","name","autocomplete","timelinemap-name",1,"input","w-100"],["name",""],[3,"field"],["label","In Point",1,"mr-2"],["type","text","formControlName","start",1,"input","w-100"],["label","Out Point",1,"ml-2"],["type","text","formControlName","end",1,"input","w-100"],["label","State Start",1,"mr-2"],["type","text","formControlName","dataStart",1,"input","w-100"],["label","State End",1,"ml-2"],["type","text","formControlName","dataEnd",1,"input","w-100"],["formControlName","fit",1,"pb-4",3,"indeterminate"],[1,"text-12"],["class","edit-timeline-maps__form-row",4,"ngIf"],["label","On End",1,"flex-grow"],["formControlName","onEnd",1,"flex"],["value","freeze",1,"flex-grow","text-12"],["value","loop",1,"flex-grow","text-12"],[1,"text-12","pt-2"]],template:function(e,t){if(1&e&&(ae.Vb(0,"div",0),ae.Vb(1,"div",1),ae.Nc(2,yu,13,2,"ng-container",2),ae.Ub(),ae.Vb(3,"div",3),ae.Nc(4,Cu,22,4,"ng-container",4),ae.Nc(5,Pu,2,0,"ng-template",null,5,ae.Oc),ae.Ub(),ae.Ub()),2&e){const e=ae.yc(6);ae.Db(2),ae.mc("ngIf",t.hasSelectedTimelineMaps),ae.Db(2),ae.mc("ngIf",t.hasSelectedTimelineMaps)("ngIfElse",e)}},directives:[n.p,pe.a,Sn.d,at.a,Sn.a,Sn.b,G.E,G.s,G.j,de.a,G.c,G.m,G.r,G.i,ue.a,ge.a,bt.b,bt.a],styles:[".edit-timeline-maps[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}.edit-timeline-maps__header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;height:56px;flex-shrink:0;border-bottom:1px solid #283853;padding:0 16px}.edit-timeline-maps__body[_ngcontent-%COMP%]{flex-grow:1;padding:16px 16px 0}.edit-timeline-maps__form[_ngcontent-%COMP%]{display:flex;flex-direction:column}.edit-timeline-maps__form-row[_ngcontent-%COMP%]{display:flex}"],changeDetection:0}),fu([Object(r.e)(F.a.getSelectedChapterTimelineMap),xu("design:type",m.a)],e.prototype,"selectedChapterTimelineMap$",void 0),fu([Object(r.e)($i.getSelectedTimelineMapIds),xu("design:type",m.a)],e.prototype,"selectedTimelineMapIds$",void 0),e})();var ku=i("Jk2I");let Su=(()=>{class e{constructor(){this._count=0}get count(){return this._count}set count(e){this._count=e}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-edit-reload-countdown"]],inputs:{count:"count"},decls:6,vars:1,consts:[["data-test","reloadCountdown",1,"reload-countdown"],["total","90",3,"value"],[1,"text-16","mt-2"],[1,"text-12"]],template:function(e,t){1&e&&(ae.Vb(0,"div",0),ae.Qb(1,"app-progress",1),ae.Vb(2,"div",2),ae.Pc(3,"Duplicating states on the server."),ae.Ub(),ae.Vb(4,"div",3),ae.Pc(5," This page will automatically reload in 90 seconds. You may reload it sooner at your own risk, however it's possible not all states will have completed duplicating. "),ae.Ub(),ae.Ub()),2&e&&(ae.Db(1),ae.mc("value",t.count))},directives:[ku.a],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}[_nghost-%COMP%]{display:flex;position:absolute;justify-content:center;align-items:center;background:rgba(0,0,0,.5);color:#fff;z-index:10000;top:0;bottom:0;left:0;right:0}.reload-countdown[_ngcontent-%COMP%]{width:400px;height:400px}"],changeDetection:0}),e})();var _u=i("nhKa"),Mu=function(e,t,i,n){var o,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,i,r):o(t,i))||r);return a>3&&r&&Object.defineProperty(t,i,r),r},Uu=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const Tu=["engineContainer"];function Vu(e,t){1&e&&ae.Qb(0,"a",55)}function Du(e,t){1&e&&ae.Qb(0,"a",56)}function Eu(e,t){1&e&&(ae.Tb(0),ae.Pc(1,"* "),ae.Sb())}function ju(e,t){if(1&e&&(ae.Tb(0),ae.Pc(1),ae.hc(2,"async"),ae.hc(3,"async"),ae.Nc(4,Eu,2,0,"ng-container",33),ae.hc(5,"async"),ae.hc(6,"async"),ae.Sb()),2&e){const e=ae.gc(2);let t=null;ae.Db(1),ae.Sc(" ",ae.ic(2,3,e.canvasSize$).width," x ",ae.ic(3,5,e.canvasSize$).height," "),ae.Db(3),ae.mc("ngIf",(null==(t=ae.ic(5,7,e.canvasSettings$))?null:t.emulateDrawer)||(null==(t=ae.ic(6,9,e.canvasSettings$))?null:t.emulateColumn))}}function Nu(e,t){1&e&&(ae.Tb(0),ae.Pc(1," Size "),ae.Sb())}function Ru(e,t){if(1&e&&(ae.Vb(0,"div",63),ae.Pc(1),ae.Ub()),2&e){const e=ae.gc().$implicit;ae.Db(1),ae.Sc("",e.width," x ",e.height,"")}}function Au(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"button",51),ae.cc("click",(function(){ae.Cc(e);const i=t.$implicit;return ae.gc(2).setCanvasSize(i)})),ae.Vb(1,"div",61),ae.Vb(2,"div"),ae.Pc(3),ae.Ub(),ae.Nc(4,Ru,2,2,"div",62),ae.Ub(),ae.Ub()}if(2&e){const e=t.$implicit;ae.Db(3),ae.Qc(e.label),ae.Db(1),ae.mc("ngIf",-1!==e.width)}}function Fu(e,t){if(1&e&&(ae.Vb(0,"div",10),ae.Vb(1,"button",57),ae.Nc(2,ju,7,11,"ng-container",33),ae.hc(3,"async"),ae.Nc(4,Nu,2,0,"ng-container",33),ae.hc(5,"async"),ae.Qb(6,"app-icon",58),ae.Ub(),ae.Vb(7,"mat-menu",null,59),ae.Nc(9,Au,5,2,"button",60),ae.Ub(),ae.Ub()),2&e){const e=ae.yc(8),t=ae.gc();ae.Db(1),ae.mc("matMenuTriggerFor",e)("matTooltip",t.canvasSizeTooltip),ae.Db(1),ae.mc("ngIf",-1!==ae.ic(3,5,t.canvasSize$).width),ae.Db(2),ae.mc("ngIf",-1===ae.ic(5,7,t.canvasSize$).width),ae.Db(5),ae.mc("ngForOf",t.canvasSizes)}}function Iu(e,t){1&e&&ae.Qb(0,"app-memory-summary",24)}function zu(e,t){1&e&&ae.Qb(0,"app-edit-exit")}function Lu(e,t){1&e&&ae.Qb(0,"app-edit-document-context")}function Bu(e,t){1&e&&ae.Qb(0,"app-edit-label-context")}function Qu(e,t){1&e&&ae.Qb(0,"app-edit-paint-context")}function $u(e,t){1&e&&ae.Qb(0,"app-edit-quiz-context")}function qu(e,t){1&e&&ae.Qb(0,"app-edit-chapter-pagination")}function Gu(e,t){1&e&&(ae.Vb(0,"div",64),ae.Qb(1,"app-engine-scrubber",65),ae.Ub())}function Hu(e,t){if(1&e&&(ae.Vb(0,"button",72),ae.Pc(1),ae.hc(2,"async"),ae.Qb(3,"app-icon",58),ae.Ub()),2&e){ae.gc();const e=ae.yc(4),t=ae.gc();ae.mc("matMenuTriggerFor",e),ae.Db(1),ae.Rc(" ",t.formatTimelineScale(ae.ic(2,2,t.timelineScale$))," ")}}function Wu(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"button",51),ae.cc("click",(function(){ae.Cc(e);const i=t.$implicit;return ae.gc(2).setTimelineScale(i)})),ae.Vb(1,"div"),ae.Pc(2),ae.Ub(),ae.Ub()}if(2&e){const e=t.$implicit,i=ae.gc(2);ae.Db(2),ae.Qc(i.formatTimelineScale(e))}}function Ku(e,t){1&e&&ae.Qb(0,"app-icon",73)}function Ju(e,t){1&e&&ae.Qb(0,"app-icon",74)}function Xu(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"div",66),ae.Nc(1,Hu,4,4,"button",67),ae.hc(2,"async"),ae.Vb(3,"mat-menu",null,68),ae.Nc(5,Wu,3,1,"button",60),ae.Ub(),ae.Vb(6,"button",69),ae.cc("click",(function(){return ae.Cc(e),ae.gc().toggleTimelineEditor()})),ae.hc(7,"async"),ae.Nc(8,Ku,1,0,"app-icon",70),ae.hc(9,"async"),ae.Nc(10,Ju,1,0,"app-icon",71),ae.hc(11,"async"),ae.Ub(),ae.Ub()}if(2&e){const e=ae.gc();ae.Db(1),ae.mc("ngIf",ae.ic(2,5,e.showTimelineEditor$)),ae.Db(4),ae.mc("ngForOf",e.timelineScales),ae.Db(1),ae.mc("matTooltip",ae.ic(7,7,e.showTimelineEditor$)?"Close Timeline Editor":"Open Timeline Editor"),ae.Db(2),ae.mc("ngIf",!ae.ic(9,9,e.showTimelineEditor$)),ae.Db(2),ae.mc("ngIf",ae.ic(11,11,e.showTimelineEditor$))}}function Zu(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"app-button-group"),ae.Vb(1,"button",75),ae.cc("click",(function(){return ae.Cc(e),ae.gc().preview("modal")})),ae.hc(2,"async"),ae.Pc(3," Preview "),ae.Ub(),ae.Vb(4,"button",76),ae.hc(5,"async"),ae.Qb(6,"app-icon",77),ae.Ub(),ae.Ub()}if(2&e){const e=ae.gc(),t=ae.yc(107);ae.Db(1),ae.mc("disabled",e.atBookmarkLimit||ae.ic(2,3,e.saving$)),ae.Db(3),ae.mc("matMenuTriggerFor",t)("disabled",ae.ic(5,5,e.saving$))}}function Yu(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"button",75),ae.cc("click",(function(){return ae.Cc(e),ae.gc().preview("modal")})),ae.hc(1,"async"),ae.Pc(2," Preview "),ae.Ub()}if(2&e){const e=ae.gc();ae.mc("disabled",e.atBookmarkLimit||ae.ic(1,1,e.saving$))}}function eh(e,t){1&e&&(ae.Vb(0,"span"),ae.Pc(1,"Upgrade Now"),ae.Ub())}function th(e,t){1&e&&ae.Qb(0,"app-spinner",82)}function ih(e,t){if(1&e&&(ae.Vb(0,"span"),ae.Nc(1,th,1,0,"app-spinner",81),ae.hc(2,"async"),ae.Pc(3," Save "),ae.Ub()),2&e){const e=ae.gc(2);ae.Db(1),ae.mc("ngIf",ae.ic(2,1,e.saving$))}}function nh(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"app-button-group",78),ae.Vb(1,"button",79),ae.cc("click",(function(){return ae.Cc(e),ae.gc().handleSaveBookmark()})),ae.hc(2,"async"),ae.Nc(3,eh,2,0,"span",33),ae.Nc(4,ih,4,3,"span",33),ae.Ub(),ae.Vb(5,"button",80),ae.hc(6,"async"),ae.Qb(7,"app-icon",77),ae.Ub(),ae.Ub()}if(2&e){const e=ae.gc(),t=ae.yc(83);ae.Db(1),ae.mc("disabled",ae.ic(2,5,e.saving$)),ae.Db(2),ae.mc("ngIf",e.atBookmarkLimit),ae.Db(1),ae.mc("ngIf",!e.atBookmarkLimit),ae.Db(1),ae.mc("matMenuTriggerFor",t)("disabled",ae.ic(6,7,e.saving$))}}function oh(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"app-button-group",83),ae.Vb(1,"button",84),ae.cc("click",(function(){return ae.Cc(e),ae.gc().saveModule()})),ae.hc(2,"async"),ae.Pc(3," Save "),ae.Ub(),ae.Vb(4,"button",85),ae.hc(5,"async"),ae.Qb(6,"app-icon",77),ae.Ub(),ae.Ub()}if(2&e){const e=ae.gc(),t=ae.yc(94);ae.Db(1),ae.mc("disabled",ae.ic(2,3,e.saving$)),ae.Db(3),ae.mc("matMenuTriggerFor",t)("disabled",ae.ic(5,5,e.saving$))}}function ah(e,t){1&e&&ae.Qb(0,"app-edit-timeline",86)}function rh(e,t){1&e&&ae.Qb(0,"app-edit-timeline-maps",87)}function sh(e,t){if(1&e){const e=ae.Wb();ae.Tb(0),ae.Vb(1,"button",51),ae.cc("click",(function(){return ae.Cc(e),ae.gc().exportQuizKey()})),ae.Pc(2,"Export Quiz Key"),ae.Ub(),ae.Qb(3,"mat-divider"),ae.Sb()}}function ch(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"button",88),ae.cc("click",(function(){return ae.Cc(e),ae.gc().publishBookmark()})),ae.hc(1,"async"),ae.Pc(2," Publish "),ae.Ub()}if(2&e){const e=ae.gc();ae.mc("disabled",e.atBookmarkLimit||ae.ic(1,1,e.saving$))}}function lh(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"button",89),ae.cc("click",(function(){return ae.Cc(e),ae.gc().upgrade()})),ae.Pc(1," Upgrade Now "),ae.Ub()}}function ph(e,t){if(1&e){const e=ae.Wb();ae.Vb(0,"button",51),ae.cc("click",(function(){return ae.Cc(e),ae.gc().exportQuizKey()})),ae.Pc(1," Export Quiz Key "),ae.Ub()}}function dh(e,t){if(1&e&&ae.Qb(0,"app-edit-reload-countdown",90),2&e){const e=ae.gc();ae.mc("count",e.reloadCount)}}const uh=function(e,t,i,n,o){return{"edit--hide-left-column":e,"edit--hide-right-column":t,"edit--hide-header":i,"edit--hide-footer":n,"edit--show-timeline-editor":o}},hh=function(e){return{"edit__breadcrumb--hide":e}};let mh=(()=>{class e{constructor(e,t,i,n,o,r,s,l,p,d,u,h,m,g,f,x,y,v,C,P,O,w){this.actions=e,this.activatedRoute=t,this.router=i,this.animationService=n,this.bookmarkService=o,this.modulesService=r,this.bookmarkActionsService=s,this.cameraService=l,this.pendoService=p,this.dialog=d,this.dialogService=u,this.storageService=h,this.userAccessService=m,this.location=g,this.snackBar=f,this.store=x,this.storyService=y,this.engineService=v,this.cleanupService=C,this.imageService=P,this.snackbar=O,this.changeDetectorRef=w,this.layoutThemeEnum=a.a,this.editViewEnum=b.a,this.toolEnum=Q.a,this.environmentApplication=ne.a,this.toolIcons=qt,this.exportType=Ht.a.exportType,this.canvasSizes=Jt.b,this.canvasSizeTooltip="Emulate canvas size",this.reloadCount=0,this.showReloadBlocker=!1,this.isStoryDirty=!1,this.timelineScales=Fi,this.ngUnsubscribe=new c.a,this.application=ne.a,this.isAnimated=!1,this.atBookmarkLimit=!1}ngOnInit(){const{id:e}=this.activatedRoute.snapshot.queryParams;this.id=this.sanitizeRouteId(e),this.type=this.storyService.getStoryType(this.id),this.store.dispatch(new j.a.SetTheme(a.a.Dark)),this.store.dispatch(new D.w(Q.a.Select)),this.store.dispatch(new g.e),this.store.dispatch(new D.A(!0)),this.store.dispatch(new D.Y(!0)),this.store.dispatch(new D.Z(!0)),this.store.dispatch(new I.c(!0)),this.store.dispatch(new $.e(!1)),this.store.dispatch(new V.m(this.id,this.type)),this.store.dispatch(new L.C(this.id,this.type)),this.store.dispatch(new $.s({tag:!0,pin:!0})),this.engineService.enableRender(),this.store.dispatch(new D.y(!1)),this.store.dispatch(new D.W(!1)),this.engineService.enableRender(),this.engineService.enableAnimation(),Ht.a.application===ne.a.Loft&&this.store.dispatch(new ti.a.Reset),this.resizeEngineContainer(),this.initListeners(),this.initAuthChecks(),this.initKeyboardListeners(),this.initDirtyCheck(),this.initCaptureListener(),this.initLoadListener(),this.initPendoEvents(),this.prepareThumbnails(this.id),this.initViewGraphListeners(),this.initContentViews(),this.initPaints(),this.initStoryRecipes(),this.initNodePaintListener()}ngAfterViewInit(){setTimeout(()=>this.resizeEngineContainer(),0)}ngOnDestroy(){this.autoCaptureListener$.unsubscribe(),this.store.dispatch(new j.a.SetTheme(a.a.Light)),this.store.dispatch(new D.A(!1)),this.store.dispatch(new $.e(!1)),this.unbindKeyboardListeners(),this.cleanupService.resetScene(),this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}canDeactivate(){if(this.store.selectSnapshot(q.a.getUserProfile)&&this.isStoryDirty&&!this.atBookmarkLimit){const e=this.store.selectSnapshot(B.a.getSelectedBookmark),t=this.store.selectSnapshot(y.a.getStory).displayName,i=this.getBookmarkSaveType(e);return this.confirmSaveDialog(!0).pipe(Object(v.a)(n=>{if(void 0===n)return Object(l.a)(!1);if(!n)return Object(l.a)(!0);switch(Ht.a.application){case ne.a.Studio:return("save"===i?this.saveBookmark(e,!0):this.saveNewBookmarkDialog("Save As",t)).pipe(Object(C.a)(()=>!0));case ne.a.Loft:this.openSaveModuleDialog(this.id).afterClosed().pipe(Object(C.a)(()=>!0))}}),Object(P.a)(this.ngUnsubscribe))}return Object(l.a)(!0)}setCanvasSize(e){this.store.dispatch(new g.f(e)),this.resizeEngineContainer()}resizeEngineContainer(){const{offsetLeft:e,offsetTop:t,offsetWidth:i,offsetHeight:n}=this.engineContainer.nativeElement;let[o,a,r,s]=[e,t,i,n];const c=this.store.selectSnapshot(f.a.getCanvasSize);if(-1!==c.width||-1!==c.height){[r,s]=[c.width,c.height];const l=this.store.selectSnapshot(f.a.getCanvasSettings);if(l.emulateDrawer&&c.width<960&&(s-=64),l.emulateColumn&&c.width>=960&&(r-=320),s>n){const e=n/s;s*=e,r*=e}if(r>i){const e=i/r;s*=e,r*=e}a=t+(n-s)/2,o=e+(i-r)/2}this.canvasSizeTooltip=-1===c.width?"Emulate canvas size":`Canvas size is ${r}px x ${s}px with ${c.width>=960?Ei.a.Column:Ei.a.Drawer}`;const l=new E.a(o,a,r,s,N.a.Shown);this.store.dispatch(new D.D(l))}initListeners(){this.windowResize$=Object(p.a)(window,"resize"),Object(d.b)([this.engineReady$,this.incoming$]).pipe(Object(O.a)(([e,t])=>e&&!!t.id),Object(P.a)(this.ngUnsubscribe)).subscribe(()=>{this.loadStory()}),Object(u.a)(this.showLeftColumn$,this.showRightColumn$,this.showHeader$,this.showFooter$,this.showTimelineEditor$,this.windowResize$).pipe(Object(w.a)(10),Object(P.a)(this.ngUnsubscribe)).subscribe(()=>{this.resizeEngineContainer()}),this.record$.subscribe(e=>{this.record=e}),this.selectedChapterId$.pipe(Object(O.a)(e=>null!=e),Object(C.a)(e=>this.store.selectSnapshot(F.a.getSelectedChapter)),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.handleChapterChange(e)}),this.selectedLabel$.pipe(Object(O.a)(e=>null!=e),Object(P.a)(this.ngUnsubscribe)).subscribe(()=>{this.store.dispatch(new D.w(Q.a.Label)),this.store.dispatch(new g.h(b.a.Label))}),this.actions.pipe(Object(r.l)(D.d),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.handleNodeClick(e.node,e.event)}),this.actions.pipe(Object(r.l)(L.B),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>this.handleSaveBookmarkSuccess(e)),this.actions.pipe(Object(r.l)(L.A),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>this.handleSaveBookmarkFailure(e)),this.actions.pipe(Object(r.l)(Wt.h),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>this.handleSaveModuleSuccess(e)),this.actions.pipe(Object(r.l)(A.d),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{setTimeout(()=>{this.store.dispatch(new A.f),this.snackbar.open(`Duplicated chapter "${e.chapter.info.displayName}"`)})}),this.actions.pipe(Object(r.l)(A.j),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.snackbar.open(`"${e.chapter.info.displayName}" chapter has been removed`)}),this.actions.pipe(Object(r.l)(V.h),Object(P.a)(this.ngUnsubscribe)).subscribe(()=>{this.store.dispatch(new V.m(null,null)),this.router.navigate(["/404"],{queryParams:{errorType:"content",errorUrl:this.router.url},skipLocationChange:!0})}),this.actions.pipe(Object(r.l)(V.d),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.snackbar.open(`Successfully imported ${e.story.displayName}.`)}),this.actions.pipe(Object(r.l)(D.a,D.v),Object(P.a)(this.ngUnsubscribe)).subscribe(()=>{this.snackbar.open("Successfully updated model layers.")}),this.actions.pipe(Object(r.l)(g.c),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.preview("modal",e.quizLocked,e.quizQuestion)}),this.actions.pipe(Object(r.l)(A.b,A.l),Object(P.a)(this.ngUnsubscribe)).subscribe(()=>{const e=this.store.selectSnapshot(F.a.getSelectedChapter);this.isAnimated=this.animationService.isChapterAnimated(e)})}initAuthChecks(){this.selectedBookmark$.pipe(Object(O.a)(e=>"module"===this.type),Object(O.a)(e=>null!=e),Object(k.a)(1),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{const t=this.store.selectSnapshot(q.a.getUserRole);this.type!==Qt.a.Bookmark||Ni.e(t,e)||this.openBookmarkAccessDialog()}),this.selectedBookmark$.pipe(Object(O.a)(e=>!!e),Object(O.a)(e=>!this.isBookmarkEditable(e)),Object(S.a)(()=>this.bookmarkActionsService.checkBookmarkLimit()),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.handleBookmarkLimit(e)})}initContentViews(){Object(d.b)([this.store.select(q.a.isPremiumUser),this.store.select(F.a.getSelectedChapterModelReady),this.store.select(q.a.getContentViews)]).pipe(Object(O.a)(([e,t,i])=>!e&&t&&!i.limit_reached),Object(k.a)(1),Object(P.a)(this.ngUnsubscribe)).subscribe(()=>{this.store.dispatch(new Kt.V(this.id,this.type))})}initStoryRecipes(){this.story$.pipe(Object(O.a)(e=>null!=e),Object(P.a)(this.ngUnsubscribe),Object(k.a)(1)).subscribe(e=>{this.store.dispatch(new Gi.g),e.chapters.forEach(e=>{const t=[];Object(W.isNil)(e.synchronization)||Object.values(e.synchronization).forEach(e=>{const i=new qi.a(e);qi.a.isRealRecipe(i)&&t.push(i)}),this.store.dispatch(new Gi.l(e.id,t))})})}initPaints(){const e=this.storageService.getLocalJSON(ai.b.RecentRecipes);this.store.dispatch(new Gi.k(e));const t=this.storageService.getLocalJSON(ai.b.PaintPalettes);this.store.dispatch(new Gi.j(t))}initNodePaintListener(){this.actions.pipe(Object(r.k)(Xt.a.UpdateNodesPaint),Object(P.a)(this.ngUnsubscribe)).subscribe(()=>{const e=this.store.selectSnapshot(Wi.a.getCurrentRecipeForEngine);qi.a.isRealRecipe(e)&&this.store.dispatch(new Gi.b(e));const t=this.store.selectSnapshot($t.a.getNodes),i=this.buildChapterRecipes(t),n=this.store.selectSnapshot(F.a.getSelectedChapterId);this.store.dispatch(new Gi.l(n,i)),this.changeDetectorRef.markForCheck()})}buildChapterRecipes(e){const t=[];return Object.values(e).forEach(e=>{if(Hi.a.isRealRecipe(e.paint)){const i=Hi.a.toEngine(e.paint);-1===qi.a.recipeIndexOf(t,i)&&t.push(i)}}),t.filter(e=>void 0!==e).sort(qi.a.compare)}initDirtyCheck(){this.actions.pipe(Object(r.l)(V.i,L.B,Wt.h,Kt.J),Object(P.a)(this.ngUnsubscribe)).subscribe(()=>{this.isStoryDirty=!1}),this.actions.pipe(Object(r.l)(Xt.a.UpdateNodesPaint,Xt.a.UpdateNodesPickable,Xt.a.UpdateNodesShown,$.b,$.i,$.d,$.m,$.n,A.d,A.j,V.d,V.j,L.E,V.r,A.s,A.r,A.u,A.F,A.E,A.B,A.m,A.x,A.G,A.t,Ri.b,A.i,mn.a.AddQuestion,mn.a.CopyQuestions,mn.a.ReorderQuestions,mn.a.RemoveQuestions,mn.a.SetQuestion),Object(P.a)(this.ngUnsubscribe)).subscribe(()=>{this.isStoryDirty=!0})}initCaptureListener(){if(Ht.a.application===ne.a.Studio){const e=this.storageService.getLocalJSON(ai.b.AutoCapture);null!==e&&this.store.dispatch(new g.a(e))}const e=Object(h.a)(1e3,1e3).pipe(Object(P.a)(this.ngUnsubscribe),Object(C.a)(()=>this.cameraService.getCamera()),Object(_.a)(),Object(O.a)(([e,t])=>!this.cameraService.areCamerasEqual(e,t))),t=this.actions.pipe(Object(r.l)(g.a),Object(O.a)(e=>e.enable)),i=this.actions.pipe(Object(r.l)(Xt.a.UpdateNodesPaint,Xt.a.UpdateNodesShown,A.s,A.r,Zt.a.Undo,Zt.a.Redo,Zt.a.Reset),Object(P.a)(this.ngUnsubscribe));this.autoCaptureListener$=Object(u.a)(e,i,t).pipe(Object(O.a)(()=>0===this.store.selectSnapshot(y.a.getLoadChunksRemaining).length&&this.store.selectSnapshot(f.a.getAutoCapture)&&!this.animationService.isPlaying()),Object(P.a)(this.ngUnsubscribe)).subscribe(()=>{this.capturePosition()})}initLoadListener(){this.store.select(y.a.getLoadingChunk).pipe(Object(O.a)(()=>null!=this.store.selectSnapshot(F.a.getSelectedChapterId)),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{null!==e&&e.chapterId===this.store.selectSnapshot(F.a.getSelectedChapterId)||this.engineService.enableAnimation()})}initPendoEvents(){this.store.select(F.a.getSelectedChapterModelReady).pipe(Object(O.a)(e=>e),Object(k.a)(1),Object(P.a)(this.ngUnsubscribe)).subscribe(()=>{const e=this.store.selectSnapshot(y.a.getStoryId),t=this.store.selectSnapshot(y.a.getStory);this.pendoService.trackOncePerPage("View - Loaded",{id:e,chapters:t.chapters.length,tour:t.tags.includes("tour"),animated:t.tags.includes("animated"),quiz:this.store.selectSnapshot(ji.b.hasQuiz),edit:!0})})}initViewGraphListeners(){this.store.select(f.a.getShowRootNodes).pipe(Object(M.a)(1),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{const t=this.engineService.createViewGraph({},!1,e);this.store.dispatch(new D.E(t))})}handleBookmarkLimit(e){const{limit_reached:t}=e;this.atBookmarkLimit=t;const i=this.store.selectSnapshot(q.a.getUserProfile),n=this.store.selectSnapshot(B.a.getSelectedBookmark);if(i&&n){const e=i.premium_account_valid,o=this.isBookmarkEditable(n);!t||o||e||this.userAccessService.openBookmarkSaveLimit()}}initKeyboardListeners(){Gt.bind("1",()=>this.handleSelectTool(Q.a.Select)),Gt.bind("2",()=>this.handleSelectTool(Q.a.Hide)),Gt.bind("3",()=>this.handleSelectTool(Q.a.Label)),Gt.bind("4",()=>this.handleSelectTool(Q.a.Paint)),Gt.bind("5",()=>this.handleSelectTool(Q.a.Quiz)),Gt.bind("shift+4",()=>this.handleSelectTool(Q.a.Eyedropper)),Gt.bind("meta+,",e=>{e.preventDefault(),this.showColumn("left")}),Gt.bind("meta+.",e=>{e.preventDefault(),this.showColumn("right")}),Gt.bind("meta+/",e=>{e.preventDefault(),this.showColumn("header")}),Gt.bind("meta+m",e=>{e.preventDefault(),this.showColumn("footer")}),Gt.bind("meta+z",e=>{e.preventDefault(),this.undo()}),Gt.bind(["meta+y","meta+shift+z"],e=>{e.preventDefault(),this.redo()}),Gt.bind([".","pagedown"],()=>this.nextChapter()),Gt.bind([",","pageup"],()=>this.previousChapter()),Gt.bind(["del","backspace"],()=>this.handleDelete()),Gt.bind("meta+a",e=>{e.preventDefault(),this.handleSelectAll()})}unbindKeyboardListeners(){Gt.reset()}handleChapterTitleClick(){this.openChapterContentDialog()}handleChapterChange(e){const{camera:t,transparencyMode:i,customData:n,properties:o}=e,a=n.postprocess||[],{action:r,location:s,rotationCenter:c}=t;this.store.dispatch(new I.l(s,"flyTo"===r,void 0,c)),this.isAnimated=this.animationService.isChapterAnimated(e);const l=this.store.selectSnapshot(f.a.getShowRootNodes),p=this.engineService.createViewGraph({},!1,l);this.store.dispatch(new D.E(p)),this.store.dispatch(new D.O(i)),this.store.dispatch(new D.K(a)),this.store.dispatch(new D.L(o))}handleSelectTool(e){switch(this.store.dispatch(new D.w(e)),e){case Q.a.Paint:case Q.a.Eyedropper:this.store.dispatch(new g.h(b.a.Paint));break;case Q.a.Label:this.store.dispatch(new g.h(b.a.Label));break;case Q.a.Position:this.store.dispatch(new g.h(b.a.Position));break;case Q.a.Quiz:this.store.dispatch(new g.h(b.a.Quiz));break;default:this.store.dispatch(new g.h(b.a.Chapter))}}handleShowColumnClick(e){this.showColumn(e)}handleUndoClick(){this.undo()}handleRedoClick(){this.redo()}handleDelete(){const e=this.store.selectSnapshot(R.a.getSelectedLabel),t=this.store.selectSnapshot($t.a.getCheckedNodeIds);e?this.store.dispatch(new $.i(e)):t.length&&this.store.dispatch(new Xt.a.UpdateNodesShown(!1,t))}handleSelectAll(){this.store.dispatch(new Xt.a.UpdateNodesChecked(!0))}loadStory(){const{id:e,type:t}=this.store.selectSnapshot(y.a.getIncomingStoryInfo),i=this.store.selectSnapshot(q.a.getUserLanguage);this.store.dispatch(new V.e(e,t,i))}handleNodeClick(e,t){const i=this.store.selectSnapshot(x.a.getActiveTool);if(e||t.srcEvent.shiftKey)if(t.srcEvent.shiftKey){const t=this.store.selectSnapshot($t.a.getNodes);this.store.dispatch(new Xt.a.UpdateNodesChecked(!t[e.id].checked,[e.id])),this.store.dispatch(new Xt.a.UpdateNodeSelected(e.id))}else{const t=!this.store.selectSnapshot($t.a.getNodes)[e.id].checked,n=this.store.selectSnapshot($t.a.getNodePaint)(e.id),o=Hi.a.toEngine(n);switch(i){case Q.a.Hide:this.store.dispatch(new Xt.a.UpdateNodesShown(!1,[e.id]));break;case Q.a.Select:case Q.a.Position:this.store.dispatch(new Xt.a.UpdateNodesChecked(!1)),t&&(this.store.dispatch(new Xt.a.UpdateNodesChecked(!0,[e.id])),this.store.dispatch(new Xt.a.UpdateNodeSelected(e.id))),this.store.dispatch(new D.g(e)),qi.a.isRealRecipe(o)?this.store.dispatch(new Gi.h(n)):this.store.dispatch(new Gi.d)}}else this.store.dispatch(new Xt.a.UpdateNodesChecked(!1))}showColumn(e){let t=!0;switch(e){case"left":t=!this.store.selectSnapshot(f.a.getShowLeftColumn);break;case"right":t=!this.store.selectSnapshot(f.a.getShowRightColumn);break;case"header":t=!this.store.selectSnapshot(f.a.getShowHeader);break;case"footer":t=!this.store.selectSnapshot(f.a.getShowFooter)}this.store.dispatch(new g.i(e,t))}toggleTimelineEditor(){const e=!this.store.selectSnapshot(f.a.getShowTimelineEditor);this.store.dispatch(new g.l(e))}setTimelineScale(e){this.store.dispatch(new Ii.SetScale(e))}formatTimelineScale(e){return 100*e+"%"}handleSaveBookmark(){if(this.atBookmarkLimit)this.upgrade();else{const e=this.store.selectSnapshot(B.a.getSelectedBookmark);switch(this.getBookmarkSaveType(e)){case"save":this.saveBookmark(e).pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(()=>{});break;case"saveAs":this.saveBookmarkAs()}}}saveModule(){this.openSaveModuleDialog(this.id)}saveBookmarkAs(){this.bookmarkActionsService.checkBookmarkLimit().pipe(Object(v.b)(e=>{if(e.limit_reached)return this.userAccessService.openBookmarkSaveLimit();{const e="Save As",t=this.store.selectSnapshot(y.a.getStory).displayName;return this.saveNewBookmarkDialog(e,t)}}),Object(P.a)(this.ngUnsubscribe)).subscribe(()=>{})}publishBookmark(){if(this.atBookmarkLimit)return;const e=this.store.selectSnapshot(B.a.getSelectedBookmark),t=this.getBookmarkSaveType(e);if("save"===t&&e)this.isStoryDirty?this.confirmSaveDialog().pipe(Object(v.a)(t=>t?this.saveBookmark(e,!0):Object(l.a)(e)),Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{this.openPublishDialog(e)}):this.openPublishDialog(e);else if("saveAs"===t){const e="Save As",t=this.store.selectSnapshot(y.a.getStory).displayName;this.saveNewBookmarkDialog(e,t,"You must save your changes to publish your model.").pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{e&&this.openPublishDialog(e)})}}isBookmarkEditable(e){if(e){const t=this.store.selectSnapshot(q.a.getUserRole),i=Ni.e(t,e);return e.type===Qt.a.Bookmark&&i}return!1}getBookmarkSaveType(e){return e&&this.isBookmarkEditable(e)?"save":"saveAs"}handleSaveBookmarkSuccess(e){const{bookmark:t,story:i}=e,{id:n,title:o,type:a}=t;if(this.store.dispatch(new L.D(t)),this.location.replaceState("edit","?id="+n),this.snackBar.open(o+" saved to your library."),i){const e=this.store.selectSnapshot(F.a.getSelectedChapterIndex);this.store.dispatch(new V.a(n,i,a,e))}}handleSaveModuleSuccess(e){this.id=this.sanitizeRouteId(e.id);const t=this.store.selectSnapshot(F.a.getSelectedChapterIndex);if(e.statesDuplicated){const e=9e4;this.reloadCount=0,this.showReloadBlocker=!0;const t=setInterval(()=>{this.reloadCount++,this.changeDetectorRef.markForCheck()},1e3);setTimeout(()=>{clearInterval(t),this.showReloadBlocker=!1,this.changeDetectorRef.markForCheck(),window.location.reload()},e)}else this.buildStory(e.id,e.story,t)}handleSaveBookmarkFailure(e){this.snackBar.open(`Unable to save "${e.bookmarkEntry.title}". Please try again.`)}openChapterContentDialog(){this.dialog.open(Bt,{width:"90vw",maxWidth:"1280px",height:"90vh",data:{chapterId:this.store.selectSnapshot(F.a.getSelectedChapterId)}})}buildStory(e,t,i){this.store.dispatch(new V.a(e,t,Qt.a.Module,i))}preview(e,t=!1,i){if(this.bookmarkActionsService.isPremiumRestrictedAction(hn.a.Publish))return void this.userAccessService.openPublishPaywall();Object(W.isNil)(i)||(t=!0);const n=this.store.selectSnapshot(F.a.getStoryChapters),o=Di.a.makeChapterIdMap(n,!1),a=this.bookmarkService.createBookmarkStory(o),r=this.store.selectSnapshot(B.a.getSelectedBookmark);this.storageService.setDatabaseItem(ai.a.PreviewStory,a.story).then(()=>{this.storageService.setDatabaseItem(ai.a.PreviewBookmark,r)}).then(()=>{switch(e){case"modal":this.dialog.open(un,{width:"95vw",height:"95vh",maxWidth:"95w",maxHeight:"95vh",data:{quizLocked:t,questionNumber:i}}).afterClosed().pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{"publish"===e&&this.publishBookmark()});break;case"tab":window.open("/view?id=preview")}})}undo(){this.store.dispatch(new Zt.a.Undo(this.store.selectSnapshot(F.a.getSelectedChapterId)))}redo(){this.store.dispatch(new Zt.a.Redo(this.store.selectSnapshot(F.a.getSelectedChapterId)))}upgrade(){this.dialogService.openUpgradeDialog()}openInSceneEditor(){window.open(`https://scene-editor.biodigital.com/apps/editor/?m=${this.id}.json`)}openInViewer(){window.open(`https://human-qa.biodigital.com/viewer/?id=${this.id}&ui-label-list=true`)}sanitizeRouteId(e){return e=e.replace(/\.json$/,""),this.location.replaceState("edit","?id="+e),e}nextChapter(){this.store.selectSnapshot(F.a.getAllChaptersModelsReady)&&this.store.dispatch(new A.g)}previousChapter(){this.store.selectSnapshot(F.a.getAllChaptersModelsReady)&&this.store.dispatch(new A.h)}capturePosition(){const e=this.store.selectSnapshot(F.a.getSelectedChapterId),t=this.store.selectSnapshot(F.a.getSelectedChapterBackground);this.store.dispatch(new Ri.b(e,t,ii.a.JPEG,92,ni.a.medium,"square",!1,!1));const i=this.cameraService.getCamera();this.store.dispatch(new A.i(e,i))}prepareThumbnails(e){this.allChaptersReady$.pipe(Object(P.a)(this.ngUnsubscribe),Object(O.a)(e=>e),Object(C.a)(()=>this.store.selectSnapshot(y.a.getStory)),Object(k.a)(1)).subscribe(t=>{this.imageService.generateFreshChapterImages(t.chapters,e,Ht.a.application===ne.a.Studio&&this.type===Qt.a.Module).pipe(Object(P.a)(this.ngUnsubscribe)).subscribe(e=>{const t=this.store.selectSnapshot(Ai.a.getRegisteredThumbnails);e.forEach(e=>{t.set(e.chapterId,e)}),this.store.dispatch(new Ri.a(t))})})}exportWrittenContent(){const e=this.storyService.exportWrittenContent(this.store.selectSnapshot(y.a.getStory),this.store.selectSnapshot(F.a.getStoryChapters),this.store.selectSnapshot(R.a.getLabels)),t=(this.store.selectSnapshot(y.a.getStory).displayName||"story")+".md",i=new Blob([e],{type:"text/plain;charset=utf-8"});Object(ei.saveAs)(i,t)}exportQuizKey(){const e=this.storyService.exportQuizKey(this.store.selectSnapshot(ji.b.getAllQuestions)),t=(this.store.selectSnapshot(y.a.getStory).displayName||"story")+".md",i=new Blob([e],{type:"text/plain;charset=utf-8"});Object(ei.saveAs)(i,t)}mergeModule(){let e=null,t=Object(l.a)(!0);this.isStoryDirty&&(t=this.confirmModuleMergeSaveDialog().pipe(Object(P.a)(this.ngUnsubscribe),Object(O.a)(e=>e),Object(v.b)(()=>this.openSaveModuleDialog(this.id).afterClosed()),Object(O.a)(e=>e))),t.pipe(Object(P.a)(this.ngUnsubscribe),Object(v.b)(()=>this.openMergeModuleDialog().afterClosed()),Object(O.a)(e=>null!=e),Object(U.a)(t=>{e=t.id}),Object(v.b)(()=>this.modulesService.mergeModule(this.id,e)),Object(v.b)(t=>t.success?Object(l.a)(t):this.resolveMergeConflict(this.id,e))).subscribe(t=>{this.snackBar.open(`${this.id} was successfully merged with ${e}`),this.store.dispatch(new V.j(t.merged))})}resolveMergeConflict(e,t){return this.openMergeConflictDialog(e,t).afterClosed().pipe(Object(O.a)(e=>null!=e),Object(v.b)(i=>this.modulesService.mergeModule(e,t,i)),Object(O.a)(e=>e.success))}openMergeModuleDialog(){return this.dialog.open(nn,{id:Vi.a.MergeModuleDialog,maxWidth:"90vw",width:"90vw",height:"90vh"})}openMergeConflictDialog(e,t){return this.dialog.open(on,{id:Vi.a.MergeConflictDialog,data:{loft:e,bridge:t}})}confirmModuleMergeSaveDialog(){return this.dialogService.openConfirmDialog({data:{titleText:"Unsaved Changes",bodyText:"You must save before merging files. Continue to save changes.",confirmText:"Continue",cancelText:"Cancel",confirmColor:"warn"}}).afterClosed()}confirmSaveDialog(e){return this.dialogService.openConfirmDialog({data:{titleText:"Save Changes",bodyText:"Would you like to save your changes to your model?",confirmText:"Save",cancelText:"Don't Save",miscText:e?"Cancel":"",confirmColor:"warn"}}).afterClosed()}saveBookmark(e,t=!1){t&&this.snackBar.open(`Saving "${e.title}"...`);const i=this.isBookmarkEditable(e);return this.store.dispatch(new L.z({isOwner:i,id:e.id,title:e.title,viewMode:e.viewMode},!0)).pipe(Object(v.a)(()=>this.actions.pipe(Object(r.l)(L.B,L.A),Object(T.a)())),Object(C.a)(t=>t instanceof L.B?this.store.selectSnapshot(B.a.getSelectedBookmark):e))}saveNewBookmarkDialog(e,t,i){this.dialog.closeAll();const n=this.store.selectSnapshot(B.a.getSelectedBookmarkViewMode);return this.dialog.open(ri.a,{id:Vi.a.SaveBookmarkDialog,data:{mode:ri.b.SaveStory,title:e,bookmarkTitle:t,viewMode:n,message:i}}).afterClosed()}openPublishDialog(e){this.bookmarkActionsService.publish(e)}openSaveModuleDialog(e,t){this.dialog.closeAll();const i=Object.assign(Object.assign({id:Vi.a.SaveModuleDialog},{width:"480px",data:{id:e}}),t);return this.dialog.open(Ti,i)}openBookmarkAccessDialog(){const e=this.store.selectSnapshot(B.a.getSelectedBookmark);if(e){const t={id:Vi.a.BookmarkAccessDialog,width:"480px",data:{model:e}};return this.dialog.closeAll(),this.dialog.open(ri.a,t)}}}return e.\u0275fac=function(t){return new(t||e)(ae.Pb(r.b),ae.Pb(o.a),ae.Pb(o.e),ae.Pb(re.a),ae.Pb(bn.a),ae.Pb(di.a),ae.Pb(gn.a),ae.Pb(fn.a),ae.Pb(xn.b),ae.Pb(H.b),ae.Pb(yn.a),ae.Pb(ai.d),ae.Pb(vn.a),ae.Pb(n.k),ae.Pb(le.b),ae.Pb(r.h),ae.Pb(Cn.a),ae.Pb(ce.a),ae.Pb(Pn.a),ae.Pb(On.a),ae.Pb(le.b),ae.Pb(ae.i))},e.\u0275cmp=ae.Jb({type:e,selectors:[["app-edit"]],viewQuery:function(e,t){if(1&e&&ae.Jc(Tu,!0),2&e){let e;ae.xc(e=ae.dc())&&(t.engineContainer=e.first)}},decls:111,vars:105,consts:[[1,"edit","edit--dark","theme-dark",3,"ngClass"],["routerLink","/","class","edit__logo",4,"appFlagApplication"],["routerLink","/results/modules","class","edit__logo",4,"appFlagApplication"],[1,"edit__header-left"],[1,"edit__title",3,"title","click"],[1,"edit__title-text"],[1,"edit__title-icon"],["icon","pencil"],[3,"viewMode"],[1,"edit__header-bar"],[1,"edit__toolbar-group"],["app-button","","data-test","selectTool",1,"mr-1",3,"selected","click"],["iconPlacement","left",3,"icon","label"],["app-button","",1,"mr-1",3,"selected","click"],["app-button","","data-test","labelTool",1,"mr-1",3,"selected","click"],["app-button","","data-test","paintTool",1,"mr-1",3,"selected","click"],["app-button","","data-test","quizTool",1,"mr-1",3,"selected","click"],["app-button","","matTooltip","Undo",3,"disabled","click"],["icon","undo"],["app-button","","matTooltip","Redo",3,"disabled","click"],["icon","redo"],["class","edit__toolbar-group",4,"appFlagApplication"],[1,"edit__header-right"],["class","mr-2",4,"appFlagApplication"],[1,"mr-2"],[4,"appFlagApplication"],[1,"edit__scene-left"],[1,"edit__scene"],["engineContainer",""],[1,"edit__camera-bar"],[1,"edit__scene-right",3,"ngSwitch"],[4,"ngSwitchCase"],[1,"edit__footer-left"],[4,"ngIf"],[1,"edit__footer-bar"],[1,"edit__breadcrumb",3,"ngClass"],["class","edit__animation pointer-events-none",4,"ngIf"],["class","edit__timeline-options",4,"appFlagApplication"],[1,"edit__footer-right"],["app-button","","buttonType","flat","data-test","previewTrigger",3,"disabled","click",4,"ngIf"],["render","block","class","flex-grow ml-2",4,"appFlagExternal"],["class","w-100 flex-grow ml-2","render","block",4,"appFlagInternal"],[1,"edit__timeline-bar"],["class","edit__timeline",4,"ngIf"],["class","edit__timeline-map",4,"ngIf"],["fileMenuBookmarks","matMenu"],["mat-menu-item","","data-test","publishBookmark",3,"disabled","click",4,"appFlagExternal"],["mat-menu-item","","data-test","upgradeSubscriptionButton",3,"click",4,"ngIf"],["mat-menu-item","","data-test","saveBookmark",3,"disabled","click"],["mat-menu-item","","data-test","saveBookmarkAs",3,"disabled","click"],["fileMenuModules","matMenu"],["mat-menu-item","",3,"click"],["mat-menu-item","",3,"click",4,"ngIf"],["previewMenu","matMenu"],[3,"count",4,"ngIf"],["routerLink","/",1,"edit__logo"],["routerLink","/results/modules",1,"edit__logo"],["app-button","",3,"matMenuTriggerFor","matTooltip"],["icon","angle-down"],["canvasSize","matMenu"],["mat-menu-item","",3,"click",4,"ngFor","ngForOf"],[1,"flex","justify-between"],["class","pl-2",4,"ngIf"],[1,"pl-2"],[1,"edit__animation","pointer-events-none"],[1,"pointer-events-auto",2,"width","400px"],[1,"edit__timeline-options"],["app-button","","matTooltip","Zoom options",3,"matMenuTriggerFor",4,"ngIf"],["timelineScale","matMenu"],["app-button","",3,"matTooltip","click"],["icon","expand-alt",4,"ngIf"],["icon","compress-alt",4,"ngIf"],["app-button","","matTooltip","Zoom options",3,"matMenuTriggerFor"],["icon","expand-alt"],["icon","compress-alt"],["app-button","","buttonType","flat","data-test","previewTrigger",3,"disabled","click"],["app-button","","buttonType","flat","data-test","previewMenu",2,"flex","0 0 40px",3,"matMenuTriggerFor","disabled"],["icon","caret-up"],["render","block",1,"flex-grow","ml-2"],["app-button","","data-test","saveBookmark","buttonType","primary",2,"flex","1 1 100%",3,"disabled","click"],["app-button","","buttonType","primary","data-test","saveBookmarkMenu",2,"flex","0 0 40px",3,"matMenuTriggerFor","disabled"],["render","inline","size","small","class","mr-1",4,"ngIf"],["render","inline","size","small",1,"mr-1"],["render","block",1,"w-100","flex-grow","ml-2"],["app-button","","data-test","saveModuleTrigger","buttonType","primary",1,"flex-grow",3,"disabled","click"],["app-button","","buttonType","primary",2,"flex","0 0 40px",3,"matMenuTriggerFor","disabled"],[1,"edit__timeline"],[1,"edit__timeline-map"],["mat-menu-item","","data-test","publishBookmark",3,"disabled","click"],["mat-menu-item","","data-test","upgradeSubscriptionButton",3,"click"],[3,"count"]],template:function(e,t){if(1&e&&(ae.Vb(0,"div",0),ae.hc(1,"async"),ae.hc(2,"async"),ae.hc(3,"async"),ae.hc(4,"async"),ae.hc(5,"async"),ae.Nc(6,Vu,1,0,"a",1),ae.Nc(7,Du,1,0,"a",2),ae.Vb(8,"div",3),ae.Vb(9,"div",4),ae.cc("click",(function(){return t.handleChapterTitleClick()})),ae.hc(10,"textNormalize"),ae.hc(11,"async"),ae.Vb(12,"span",5),ae.Pc(13),ae.hc(14,"textNormalize"),ae.hc(15,"async"),ae.Ub(),ae.Vb(16,"div",6),ae.Qb(17,"app-icon",7),ae.Ub(),ae.Ub(),ae.Qb(18,"app-edit-bookmark-view-mode",8),ae.hc(19,"async"),ae.Ub(),ae.Vb(20,"div",9),ae.Vb(21,"div",10),ae.Vb(22,"button",11),ae.cc("click",(function(){return t.handleSelectTool(t.toolEnum.Select)})),ae.hc(23,"async"),ae.Qb(24,"app-button-icon",12),ae.Ub(),ae.Vb(25,"button",13),ae.cc("click",(function(){return t.handleSelectTool(t.toolEnum.Hide)})),ae.hc(26,"async"),ae.Qb(27,"app-button-icon",12),ae.Ub(),ae.Vb(28,"button",14),ae.cc("click",(function(){return t.handleSelectTool(t.toolEnum.Label)})),ae.hc(29,"async"),ae.Qb(30,"app-button-icon",12),ae.Ub(),ae.Vb(31,"button",15),ae.cc("click",(function(){return t.handleSelectTool(t.toolEnum.Paint)})),ae.hc(32,"async"),ae.Qb(33,"app-button-icon",12),ae.Ub(),ae.Vb(34,"button",16),ae.cc("click",(function(){return t.handleSelectTool(t.toolEnum.Quiz)})),ae.hc(35,"async"),ae.Qb(36,"app-button-icon",12),ae.Ub(),ae.Ub(),ae.Vb(37,"div",10),ae.Vb(38,"button",17),ae.cc("click",(function(){return t.handleUndoClick()})),ae.hc(39,"async"),ae.Qb(40,"app-icon",18),ae.Ub(),ae.Vb(41,"button",19),ae.cc("click",(function(){return t.handleRedoClick()})),ae.hc(42,"async"),ae.Qb(43,"app-icon",20),ae.Ub(),ae.Ub(),ae.Nc(44,Fu,10,9,"div",21),ae.Ub(),ae.Vb(45,"div",22),ae.Nc(46,Iu,1,0,"app-memory-summary",23),ae.Qb(47,"app-help-menu",24),ae.Qb(48,"app-user-profile-pin",24),ae.Nc(49,zu,1,0,"app-edit-exit",25),ae.Ub(),ae.Vb(50,"div",26),ae.Qb(51,"app-navigation-context"),ae.Ub(),ae.Vb(52,"div",27,28),ae.Qb(54,"app-engine-camera-bar",29),ae.Ub(),ae.Vb(55,"div",30),ae.hc(56,"async"),ae.Nc(57,Lu,1,0,"app-edit-document-context",31),ae.Nc(58,Bu,1,0,"app-edit-label-context",31),ae.Nc(59,Qu,1,0,"app-edit-paint-context",31),ae.Nc(60,$u,1,0,"app-edit-quiz-context",31),ae.Ub(),ae.Vb(61,"div",32),ae.Nc(62,qu,1,0,"app-edit-chapter-pagination",33),ae.hc(63,"async"),ae.Ub(),ae.Vb(64,"div",34),ae.Vb(65,"div",35),ae.hc(66,"async"),ae.Qb(67,"app-engine-breadcrumb"),ae.Ub(),ae.Nc(68,Gu,2,0,"div",36),ae.Nc(69,Xu,12,13,"div",37),ae.Ub(),ae.Vb(70,"div",38),ae.Nc(71,Zu,7,7,"app-button-group",33),ae.hc(72,"async"),ae.Nc(73,Yu,3,3,"button",39),ae.hc(74,"async"),ae.Nc(75,nh,8,9,"app-button-group",40),ae.Nc(76,oh,7,7,"app-button-group",41),ae.Ub(),ae.Vb(77,"div",42),ae.Nc(78,ah,1,0,"app-edit-timeline",43),ae.hc(79,"async"),ae.Nc(80,rh,1,0,"app-edit-timeline-maps",44),ae.hc(81,"async"),ae.Ub(),ae.Ub(),ae.Vb(82,"mat-menu",null,45),ae.Nc(84,sh,4,0,"ng-container",33),ae.hc(85,"async"),ae.Nc(86,ch,3,3,"button",46),ae.Nc(87,lh,2,0,"button",47),ae.Qb(88,"mat-divider"),ae.Vb(89,"button",48),ae.cc("click",(function(){return t.handleSaveBookmark()})),ae.Pc(90," Save "),ae.Ub(),ae.Vb(91,"button",49),ae.cc("click",(function(){return t.saveBookmarkAs()})),ae.Pc(92," Save as ... "),ae.Ub(),ae.Ub(),ae.Vb(93,"mat-menu",null,50),ae.Vb(95,"button",51),ae.cc("click",(function(){return t.openInSceneEditor()})),ae.Pc(96,"Open in Scene Editor..."),ae.Ub(),ae.Vb(97,"button",51),ae.cc("click",(function(){return t.openInViewer()})),ae.Pc(98,"Open in QA Viewer..."),ae.Ub(),ae.Qb(99,"mat-divider"),ae.Vb(100,"button",51),ae.cc("click",(function(){return t.exportWrittenContent()})),ae.Pc(101,"Export Text"),ae.Ub(),ae.Nc(102,ph,2,0,"button",52),ae.hc(103,"async"),ae.Vb(104,"button",51),ae.cc("click",(function(){return t.mergeModule()})),ae.Pc(105,"Merge Module"),ae.Ub(),ae.Ub(),ae.Vb(106,"mat-menu",null,53),ae.Vb(108,"button",51),ae.cc("click",(function(){return t.preview("modal",!0)})),ae.Pc(109,"Preview Quiz"),ae.Ub(),ae.Ub(),ae.Nc(110,dh,1,1,"app-edit-reload-countdown",54)),2&e){let e=null,i=null;ae.mc("ngClass",ae.tc(97,uh,!ae.ic(1,45,t.showLeftColumn$),!ae.ic(2,47,t.showRightColumn$),!ae.ic(3,49,t.showHeader$),!ae.ic(4,51,t.showFooter$),ae.ic(5,53,t.showTimelineEditor$))),ae.Db(6),ae.mc("appFlagApplication",t.environmentApplication.Studio),ae.Db(1),ae.mc("appFlagApplication",t.environmentApplication.Loft),ae.Db(2),ae.mc("title",ae.ic(10,55,null==(e=ae.ic(11,57,t.selectedBookmark$))?null:e.title)),ae.Db(4),ae.Qc(ae.ic(14,59,null==(i=ae.ic(15,61,t.selectedBookmark$))?null:i.title)),ae.Db(5),ae.mc("viewMode",ae.ic(19,63,t.selectedBookmarkViewMode$)),ae.Db(4),ae.mc("selected",ae.ic(23,65,t.activeTool$)==t.toolEnum.Select),ae.Db(2),ae.mc("icon",t.toolIcons[t.toolEnum.Select])("label",t.toolEnum.Select),ae.Db(1),ae.mc("selected",ae.ic(26,67,t.activeTool$)==t.toolEnum.Hide),ae.Db(2),ae.mc("icon",t.toolIcons[t.toolEnum.Hide])("label",t.toolEnum.Hide),ae.Db(1),ae.mc("selected",ae.ic(29,69,t.activeTool$)==t.toolEnum.Label),ae.Db(2),ae.mc("icon",t.toolIcons[t.toolEnum.Label])("label",t.toolEnum.Label),ae.Db(1),ae.mc("selected",ae.ic(32,71,t.activeTool$)==t.toolEnum.Paint),ae.Db(2),ae.mc("icon",t.toolIcons[t.toolEnum.Paint])("label",t.toolEnum.Paint),ae.Db(1),ae.mc("selected",ae.ic(35,73,t.activeTool$)==t.toolEnum.Quiz),ae.Db(2),ae.mc("icon",t.toolIcons[t.toolEnum.Quiz])("label",t.toolEnum.Quiz),ae.Db(2),ae.mc("disabled",!ae.ic(39,75,t.canUndo$)),ae.Db(3),ae.mc("disabled",!ae.ic(42,77,t.canRedo$)),ae.Db(3),ae.mc("appFlagApplication",t.application.Loft),ae.Db(2),ae.mc("appFlagApplication",t.application.Loft),ae.Db(3),ae.mc("appFlagApplication",t.application.Studio),ae.Db(6),ae.mc("ngSwitch",ae.ic(56,79,t.view$)),ae.Db(2),ae.mc("ngSwitchCase",t.editViewEnum.Chapter),ae.Db(1),ae.mc("ngSwitchCase",t.editViewEnum.Label),ae.Db(1),ae.mc("ngSwitchCase",t.editViewEnum.Paint),ae.Db(1),ae.mc("ngSwitchCase",t.editViewEnum.Quiz),ae.Db(2),ae.mc("ngIf",ae.ic(63,81,t.allChaptersReady$)),ae.Db(3),ae.mc("ngClass",ae.pc(103,hh,!ae.ic(66,83,t.hoveredNode$))),ae.Db(3),ae.mc("ngIf",t.isAnimated),ae.Db(1),ae.mc("appFlagApplication",t.environmentApplication.Loft),ae.Db(2),ae.mc("ngIf",ae.ic(72,85,t.questionTotal$)>0),ae.Db(2),ae.mc("ngIf",0==ae.ic(74,87,t.questionTotal$)),ae.Db(5),ae.mc("ngIf",ae.ic(79,89,t.showTimelineEditor$)),ae.Db(2),ae.mc("ngIf",ae.ic(81,91,t.showTimelineEditor$)),ae.Db(4),ae.mc("ngIf",ae.ic(85,93,t.questionTotal$)>0),ae.Db(3),ae.mc("ngIf",t.atBookmarkLimit),ae.Db(2),ae.mc("disabled",t.atBookmarkLimit),ae.Db(2),ae.mc("disabled",t.atBookmarkLimit),ae.Db(11),ae.mc("ngIf",ae.ic(103,95,t.questionTotal$)>0),ae.Db(8),ae.mc("ngIf",t.showReloadBlocker)}},directives:[n.m,pt.a,at.a,Mn,pe.a,Un.a,st.c,Tn.a,Vn.a,ma,ba.a,n.r,n.s,n.p,va,Ca,he.a,Sn.a,me.a,Sn.b,o.h,Sn.d,n.o,La,Qa,nl,Pl,Ip,Cd,kd,Rd,Oo,ui.a,gu,wu,Su],pipes:[n.b,_u.a],styles:['.text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}@-webkit-keyframes fadeIn{0%{opacity:0}to{opacity:1}}@keyframes fadeIn{0%{opacity:0}to{opacity:1}}.edit[_ngcontent-%COMP%]{min-width:1140px;min-height:632px;width:100vw;height:100vh;overflow-y:hidden;overflow-x:auto;position:relative;background:#131c2a;color:#fff;display:grid;grid-template-areas:"logo header-left header-bar header-right" "scene-left scene-left scene scene-right" "footer-left footer-left footer-bar footer-right" "edit-timeline edit-timeline edit-timeline edit-timeline";grid-template-columns:56px 264px auto 280px;grid-template-rows:56px 1fr 56px 0}.edit--hide-columns[_ngcontent-%COMP%]{grid-template-areas:"logo header-left header-bar header-right" "scene scene scene scene" "footer-left footer-left footer-bar footer-right" "edit-timeline edit-timeline edit-timeline edit-timeline"}.edit--hide-columns[_ngcontent-%COMP%]   .edit__scene-left[_ngcontent-%COMP%], .edit--hide-columns[_ngcontent-%COMP%]   .edit__scene-right[_ngcontent-%COMP%]{display:none}.edit--hide-left-column[_ngcontent-%COMP%]{grid-template-areas:"logo header-left header-bar header-right" "scene scene scene scene-right" "footer-left footer-left footer-bar footer-right" "edit-timeline edit-timeline edit-timeline edit-timeline"}.edit--hide-left-column[_ngcontent-%COMP%]   .edit__scene-left[_ngcontent-%COMP%]{display:none}.edit--hide-right-column[_ngcontent-%COMP%]{grid-template-areas:"logo header-left header-bar header-right" "scene-left scene-left scene scene" "footer-left footer-left footer-bar footer-right" "edit-timeline edit-timeline edit-timeline edit-timeline"}.edit--hide-right-column[_ngcontent-%COMP%]   .edit__scene-right[_ngcontent-%COMP%]{display:none}.edit--hide-header[_ngcontent-%COMP%]{grid-template-rows:0 1fr 56px 0}.edit--hide-header[_ngcontent-%COMP%]   .edit__header-bar[_ngcontent-%COMP%], .edit--hide-header[_ngcontent-%COMP%]   .edit__header-left[_ngcontent-%COMP%], .edit--hide-header[_ngcontent-%COMP%]   .edit__header-right[_ngcontent-%COMP%], .edit--hide-header[_ngcontent-%COMP%]   .edit__logo[_ngcontent-%COMP%]{display:none}.edit.edit--hide-header.edit--show-timeline-editor[_ngcontent-%COMP%]{grid-template-rows:0 1fr 56px 388px}.edit--hide-footer[_ngcontent-%COMP%]{grid-template-rows:56px 1fr 0 0}.edit--hide-footer[_ngcontent-%COMP%]   .edit__footer-bar[_ngcontent-%COMP%], .edit--hide-footer[_ngcontent-%COMP%]   .edit__footer-left[_ngcontent-%COMP%], .edit--hide-footer[_ngcontent-%COMP%]   .edit__footer-right[_ngcontent-%COMP%]{display:none}.edit.edit--hide-footer.edit--show-timeline-editor[_ngcontent-%COMP%]{grid-template-rows:56px 1fr 0 388px}.edit--show-timeline-editor[_ngcontent-%COMP%]{grid-template-rows:56px 1fr 56px 388px}.edit--show-timeline-editor[_ngcontent-%COMP%]   .edit__timeline-bar[_ngcontent-%COMP%]{display:flex}.edit.edit--hide-left-column.edit--hide-right-column[_ngcontent-%COMP%]{grid-template-areas:"logo header-left header-bar header-right" "scene scene scene scene" "footer-left footer-left footer-bar footer-right" "edit-timeline edit-timeline edit-timeline edit-timeline"}.edit.edit--hide-left-column.edit--hide-right-column[_ngcontent-%COMP%]   .edit__scene-left[_ngcontent-%COMP%], .edit.edit--hide-left-column.edit--hide-right-column[_ngcontent-%COMP%]   .edit__scene-right[_ngcontent-%COMP%]{display:none}.edit.edit--hide-header.edit--hide-footer[_ngcontent-%COMP%]{grid-template-rows:0 1fr 0 0}.edit.edit--hide-header.edit--hide-footer[_ngcontent-%COMP%]   .edit__footer-bar[_ngcontent-%COMP%], .edit.edit--hide-header.edit--hide-footer[_ngcontent-%COMP%]   .edit__footer-left[_ngcontent-%COMP%], .edit.edit--hide-header.edit--hide-footer[_ngcontent-%COMP%]   .edit__footer-right[_ngcontent-%COMP%], .edit.edit--hide-header.edit--hide-footer[_ngcontent-%COMP%]   .edit__header-bar[_ngcontent-%COMP%], .edit.edit--hide-header.edit--hide-footer[_ngcontent-%COMP%]   .edit__header-left[_ngcontent-%COMP%], .edit.edit--hide-header.edit--hide-footer[_ngcontent-%COMP%]   .edit__header-right[_ngcontent-%COMP%], .edit.edit--hide-header.edit--hide-footer[_ngcontent-%COMP%]   .edit__logo[_ngcontent-%COMP%]{display:none}.edit.edit--hide-header.edit--hide-footer.edit--show-timeline-editor[_ngcontent-%COMP%]{grid-template-rows:0 1fr 0 388px}.edit__logo[_ngcontent-%COMP%]{background:#131c2a url(/assets/images/logo-white.svg) 50% no-repeat;background-size:32px;border-right:1px solid #1c2a3f;border-bottom:1px solid #283853;grid-area:logo;width:56px;height:56px;transition:background-color .25s}.edit__logo[_ngcontent-%COMP%]:hover{background-color:#de3535}.edit__title[_ngcontent-%COMP%]{align-items:center;cursor:pointer;color:#d7e0ea;height:100%;padding-left:12px;letter-spacing:1px;font-weight:300;width:320px;display:flex;justify-content:space-between;font-size:16px;letter-spacing:.4px;line-height:1.4em}.edit__title[_ngcontent-%COMP%]:hover{color:#fff}.edit__title[_ngcontent-%COMP%]:hover   .edit__title-icon[_ngcontent-%COMP%]{visibility:visible;color:#fff}.edit__title-text[_ngcontent-%COMP%]{text-overflow:ellipsis;overflow:hidden;white-space:nowrap;width:120px;padding-right:4px}.edit__title-icon[_ngcontent-%COMP%]{visibility:hidden;color:#d7e0ea;font-size:12px}.edit__camera-bar[_ngcontent-%COMP%]{position:absolute;right:4px;bottom:4px;z-index:10}.edit__header-left[_ngcontent-%COMP%]{align-items:center;justify-content:space-between;grid-area:header-left}.edit__header-bar[_ngcontent-%COMP%], .edit__header-left[_ngcontent-%COMP%]{background:#131c2a;border-bottom:1px solid #283853;display:flex}.edit__header-bar[_ngcontent-%COMP%]{grid-area:header-bar;justify-content:center;padding:4px 0}.edit__header-right[_ngcontent-%COMP%]{background:#131c2a;align-items:center;grid-area:header-right;border-bottom:1px solid #283853;display:flex;justify-content:flex-end;padding-right:12px}.edit__pagination[_ngcontent-%COMP%]{grid-area:pagination;display:flex;border-left:1px solid #1c2a3f;padding-left:8px}.edit__scene-left[_ngcontent-%COMP%]{background:#131c2a;grid-area:scene-left;min-height:0;overflow-y:hidden}.edit__scene[_ngcontent-%COMP%]{box-shadow:0 0 0 4px #fff;margin:4px;background:#f9fafd;grid-area:scene;position:relative}.edit__scene-right[_ngcontent-%COMP%]{background:#131c2a;grid-area:scene-right;min-height:0;overflow-y:auto}.edit__footer-left[_ngcontent-%COMP%]{background-color:#131c2a;grid-area:footer-left;z-index:20}.edit__footer-right[_ngcontent-%COMP%]{padding:0 8px;justify-content:space-between;grid-area:footer-right}.edit__footer-bar[_ngcontent-%COMP%], .edit__footer-right[_ngcontent-%COMP%]{background-color:#131c2a;display:flex;align-items:center;z-index:20}.edit__footer-bar[_ngcontent-%COMP%]{border-top:1px solid #283853;grid-area:footer-bar;position:relative;overflow-x:auto;white-space:nowrap}.edit__timeline-bar[_ngcontent-%COMP%]{background-color:#131c2a;border-top:1px solid #283853;grid-area:edit-timeline;display:none;z-index:20}.edit__timeline[_ngcontent-%COMP%]{display:flex;flex-grow:1}.edit__timeline-map[_ngcontent-%COMP%]{width:280px;flex-shrink:0;border-left:1px solid #283853}.edit__page-actions[_ngcontent-%COMP%]{display:flex;flex:1 1 33%;padding-right:12px;justify-content:flex-end}.edit__page-actions--hidden[_ngcontent-%COMP%]{display:none}.edit__breadcrumb[_ngcontent-%COMP%]{background:#131c2a;padding:8px 0 0;position:absolute;width:100%;height:100%;z-index:2}.edit__breadcrumb[_ngcontent-%COMP%]:after, .edit__breadcrumb[_ngcontent-%COMP%]:before{content:" ";background-color:#131c2a;bottom:0;box-shadow:0 0 16px 4px #131c2a;position:absolute;right:0;top:0;width:4px}.edit__breadcrumb--hide[_ngcontent-%COMP%]{display:none}.edit__progress[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;z-index:3}.edit__animation[_ngcontent-%COMP%]{display:flex;position:absolute;justify-content:center;width:100%;z-index:1}.edit__toolbar-group[_ngcontent-%COMP%]{display:flex;align-items:center;padding:0 8px}.edit__toolbar-group[_ngcontent-%COMP%]:not(:last-child){border-right:1px solid #283853}.edit__toolbar-group[_ngcontent-%COMP%]:first-child{margin-left:0;border-left:0}.edit__timeline-options[_ngcontent-%COMP%]{display:flex;position:absolute;justify-content:flex-end;width:100%;z-index:0}'],changeDetection:0}),Mu([Object(r.e)(s.a.getTheme),Uu("design:type",m.a)],e.prototype,"theme$",void 0),Mu([Object(r.e)(f.a.getView),Uu("design:type",m.a)],e.prototype,"view$",void 0),Mu([Object(r.e)(x.a.getActiveTool),Uu("design:type",m.a)],e.prototype,"activeTool$",void 0),Mu([Object(r.e)(f.a.getShowColumns),Uu("design:type",m.a)],e.prototype,"showColumns$",void 0),Mu([Object(r.e)(f.a.getShowLeftColumn),Uu("design:type",m.a)],e.prototype,"showLeftColumn$",void 0),Mu([Object(r.e)(f.a.getShowRightColumn),Uu("design:type",m.a)],e.prototype,"showRightColumn$",void 0),Mu([Object(r.e)(f.a.getShowHeader),Uu("design:type",m.a)],e.prototype,"showHeader$",void 0),Mu([Object(r.e)(f.a.getShowFooter),Uu("design:type",m.a)],e.prototype,"showFooter$",void 0),Mu([Object(r.e)(f.a.getShowTimelineEditor),Uu("design:type",m.a)],e.prototype,"showTimelineEditor$",void 0),Mu([Object(r.e)(f.a.getRecord),Uu("design:type",m.a)],e.prototype,"record$",void 0),Mu([Object(r.e)(f.a.getCanvasSize),Uu("design:type",m.a)],e.prototype,"canvasSize$",void 0),Mu([Object(r.e)(f.a.getCanvasSettings),Uu("design:type",m.a)],e.prototype,"canvasSettings$",void 0),Mu([Object(r.e)(Yt.a.canUndo),Uu("design:type",m.a)],e.prototype,"canUndo$",void 0),Mu([Object(r.e)(Yt.a.canRedo),Uu("design:type",m.a)],e.prototype,"canRedo$",void 0),Mu([Object(r.e)(x.a.getReady),Uu("design:type",m.a)],e.prototype,"engineReady$",void 0),Mu([Object(r.e)(x.a.getChapter),Uu("design:type",m.a)],e.prototype,"chapter$",void 0),Mu([Object(r.e)($t.a.getNodes),Uu("design:type",m.a)],e.prototype,"nodes$",void 0),Mu([Object(r.e)(x.a.getHoveredNode),Uu("design:type",m.a)],e.prototype,"hoveredNode$",void 0),Mu([Object(r.e)($t.a.getCheckedNodes),Uu("design:type",m.a)],e.prototype,"checkedNodes$",void 0),Mu([Object(r.e)(x.a.getViewGraph),Uu("design:type",m.a)],e.prototype,"viewGraph$",void 0),Mu([Object(r.e)(x.a.getAnimationPlaying),Uu("design:type",m.a)],e.prototype,"animationPlaying$",void 0),Mu([Object(r.e)(oi.a.getStoryLoadProgress),Uu("design:type",m.a)],e.prototype,"loadProgress$",void 0),Mu([Object(r.e)(z.a.getStoredCamera("__copy")),Uu("design:type",m.a)],e.prototype,"cameraCopy$",void 0),Mu([Object(r.e)(y.a.getStory),Uu("design:type",m.a)],e.prototype,"story$",void 0),Mu([Object(r.e)(y.a.getIncomingStoryInfo),Uu("design:type",m.a)],e.prototype,"incoming$",void 0),Mu([Object(r.e)(R.a.getLabels),Uu("design:type",m.a)],e.prototype,"labels$",void 0),Mu([Object(r.e)(R.a.getSelectedLabel),Uu("design:type",m.a)],e.prototype,"selectedLabel$",void 0),Mu([Object(r.e)(F.a.getChaptersLoaded),Uu("design:type",m.a)],e.prototype,"chaptersLoaded$",void 0),Mu([Object(r.e)(F.a.getAllChaptersModelsReady),Uu("design:type",m.a)],e.prototype,"allChaptersReady$",void 0),Mu([Object(r.e)(F.a.getSelectedChapterId),Uu("design:type",m.a)],e.prototype,"selectedChapterId$",void 0),Mu([Object(r.e)(B.a.getSelectedBookmark),Uu("design:type",m.a)],e.prototype,"selectedBookmark$",void 0),Mu([Object(r.e)(B.a.getSelectedBookmarkViewMode),Uu("design:type",m.a)],e.prototype,"selectedBookmarkViewMode$",void 0),Mu([Object(r.e)(B.a.getSaving),Uu("design:type",m.a)],e.prototype,"saving$",void 0),Mu([Object(r.e)(ji.b.getQuestionTotal),Uu("design:type",m.a)],e.prototype,"questionTotal$",void 0),Mu([Object(r.e)(q.a.getUserProfile),Uu("design:type",m.a)],e.prototype,"userProfile$",void 0),Mu([Object(r.e)($i.getScale),Uu("design:type",m.a)],e.prototype,"timelineScale$",void 0),e})();var bh=i("uZ1g"),gh=i("P+IX");let fh=(()=>{class e{constructor(){}canDeactivate(e){return!!e.canDeactivate&&e.canDeactivate()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=ae.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var xh=i("mmXA"),yh=i("WoAB");const vh=[{path:"",component:bh.a,canActivate:[gh.a,(()=>{class e{constructor(e,t,i){this.store=e,this.router=t,this.snackbar=i}canActivate(e,t){return this.store.select(q.a.getUserRole).pipe(Object(O.a)(e=>!Object(W.isNil)(e)),Object(k.a)(1),Object(C.a)(e=>this.canEditBookmarks(e)))}canEditBookmarks(e){return!!Ni.k(e,yh.a.EditBookmarks)||this.bounceUser()}bounceUser(){return this.snackbar.open("You do not have access to edit this bookmark."),this.router.navigate(["/results/bookmarks"]),!1}}return e.\u0275fac=function(t){return new(t||e)(ae.Zb(r.h),ae.Zb(o.e),ae.Zb(le.b))},e.\u0275prov=ae.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()],data:{siteHeaderType:xh.a.Hide,fixedHeight:!0,title:"Studio"},children:[{path:"new",pathMatch:"full",component:mh,canDeactivate:[fh]},{component:mh,path:"**",canDeactivate:[fh]}]}];let Ch=(()=>{class e{}return e.\u0275mod=ae.Nb({type:e}),e.\u0275inj=ae.Mb({factory:function(t){return new(t||e)},imports:[[o.i.forChild(vh)],o.i]}),e})();var Ph=i("vvyD"),Oh=i("PCNd"),wh=i("AIoM"),kh=i("fP/T"),Sh=i("u9Xo"),_h=i("+dkL"),Mh=i("Tx//"),Uh=i("hQIT"),Th=i("YsyH"),Vh=i("o0EK"),Dh=i("Ow1N");let Eh=(()=>{class e{}return e.\u0275mod=ae.Nb({type:e}),e.\u0275inj=ae.Mb({factory:function(t){return new(t||e)},imports:[[n.c,G.z,Ph.a,Ze.a.forChild()]]}),e})();var jh=i("+QY/"),Nh=i("oH02"),Rh=i("1y1q"),Ah=i("D8yp"),Fh=i("Rc+H"),Ih=i("3ros");let zh=(()=>{class e{}return e.\u0275mod=ae.Nb({type:e}),e.\u0275inj=ae.Mb({factory:function(t){return new(t||e)},imports:[[n.c,Ph.a,Oh.a,G.z,Ih.a]]}),e})();var Lh=i("PXMH"),Bh=i("Wqx0");let Qh=(()=>{class e{}return e.\u0275mod=ae.Nb({type:e}),e.\u0275inj=ae.Mb({factory:function(t){return new(t||e)},imports:[[n.c,Ph.a,Oh.a,G.z,ht.b,Lh.a,Bh.a]]}),e})();var $h=i("+pSP"),qh=i("EWj2");let Gh=(()=>{class e{}return e.\u0275mod=ae.Nb({type:e}),e.\u0275inj=ae.Mb({factory:function(t){return new(t||e)},imports:[[n.c,G.z,Lh.a,$h.a,Ah.a,ot.d,Eh,qh.a,Ph.a]]}),e})(),Hh=(()=>{class e{}return e.\u0275mod=ae.Nb({type:e}),e.\u0275inj=ae.Mb({factory:function(t){return new(t||e)},imports:[[n.c,Ph.a,Oh.a,G.z,Ih.a]]}),e})(),Wh=(()=>{class e{}return e.\u0275mod=ae.Nb({type:e}),e.\u0275inj=ae.Mb({factory:function(t){return new(t||e)},imports:[[n.c]]}),e})(),Kh=(()=>{class e{}return e.\u0275mod=ae.Nb({type:e}),e.\u0275inj=ae.Mb({factory:function(t){return new(t||e)},imports:[[r.d.forFeature([f.a,Wi.a,$i]),Qh,n.c,ht.b,Sh.a,Ch,G.z,G.l,wh.a,Ph.a,Oh.a,kh.a,_h.a,Mh.a,Uh.a,Vh.a,Dh.a,Th.a,Wh,Eh,Ze.a.forChild(),jh.a,Nh.a,Ah.a,Rh.c,Fh.a,zh,Hh,Gh],Ch]}),e})()}}]);