(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{RmqX:function(e,t,i){"use strict";i.r(t),i.d(t,"SearchModule",(function(){return Ie}));var s=i("ofXK"),a=i("tyNb"),o=i("AcyG"),n=i("GCmh"),c=i("XNiG"),r=i("itXk"),l=i("HDdC"),b=i("08/d"),h=i("eKhQ"),p=i("EETq"),d=i("ECVi"),u=i("1G5W"),g=i("pLZG"),m=i("/uUt"),f=i("lJxs"),y=i("zP0r"),k=i("IzEk"),O=i("Zy1z"),S=i("LvDl"),v=i("J9/X"),j=i("AytR"),w=i("p345"),C=i("Lyqc"),P=i("ZR5G"),R=i("ft4l"),A=i("l4YF"),U=i("f3gM"),B=i("3Pt+"),I=i("0IaG"),T=i("a0wz"),E=i("QtmD"),L=i("DTUA"),$=i("QkH1"),D=i("WoAB"),V=i("fXoL"),x=i("dNgK"),N=i("IlST"),F=i("Jk2I"),M=i("XoCC"),q=i("Y8QC"),_=i("QibW"),z=function(e,t,i,s){var a,o=arguments.length,n=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var c=e.length-1;c>=0;c--)(a=e[c])&&(n=(o<3?a(n):o>3?a(t,i,n):a(t,i))||n);return o>3&&n&&Object.defineProperty(t,i,n),n},G=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function W(e,t){if(1&e&&(V.Tb(0),V.Qb(1,"app-progress",7),V.Vb(2,"div",8),V.Qb(3,"app-spinner",9),V.Pc(4),V.Ub(),V.Sb()),2&e){const e=V.gc();V.Db(1),V.mc("value",e.copyBookmarkPercent),V.Db(3),V.Sc(" Copying ",e.copyBookmarkNumber," of ",e.settings.bookmarks.length," bookmarks. ")}}function X(e,t){if(1&e&&(V.Vb(0,"option",7),V.Pc(1),V.Ub()),2&e){const e=t.$implicit;V.mc("value",e.collection_id),V.Db(1),V.Rc(" ",e.collection_name," ")}}function Q(e,t){if(1&e&&(V.Vb(0,"app-form-field",15),V.Vb(1,"select",16),V.Vb(2,"option",7),V.Pc(3,"--"),V.Ub(),V.Nc(4,X,2,2,"option",17),V.hc(5,"async"),V.Ub(),V.Ub()),2&e){const e=V.gc(2);V.Db(2),V.mc("value",null),V.Db(2),V.mc("ngForOf",V.ic(5,2,e.collections$))}}function J(e,t){if(1&e&&(V.Tb(0),V.Vb(1,"app-form-field",10),V.Vb(2,"mat-radio-group",11),V.Vb(3,"mat-radio-button",12),V.Pc(4,"Team - View Only"),V.Ub(),V.Vb(5,"mat-radio-button",13),V.Pc(6,"Team - View & Edit"),V.Ub(),V.Ub(),V.Ub(),V.Nc(7,Q,6,4,"app-form-field",14),V.hc(8,"async"),V.Sb()),2&e){const e=V.gc();let t=null;V.Db(7),V.mc("ngIf",null==(t=V.ic(8,1,e.collections$))?null:t.length)}}function Z(e,t){1&e&&(V.Tb(0),V.Qb(1,"app-spinner",9),V.Pc(2," Adding "),V.Sb())}function H(e,t){1&e&&(V.Tb(0),V.Pc(1," Add "),V.Sb())}let K=(()=>{class e{constructor(e,t,i,s,a,o,n,r){this.store=e,this.actions=t,this.formBuilder=i,this.dialogRef=s,this.snackBar=a,this.storageService=o,this.data=n,this.changeRef=r,this.ngUnsubscribe=new c.a,this.newBookmarkIds=[],this.copyBookmarkNumber=0,this.copyBookmarkPercent=0,this.canAddTeamBookmarks=!1,this.settings=Object.assign({},n);const l=this.store.selectSnapshot(h.a.getOrganization);l&&this.store.dispatch(new T.h(l.id))}ngOnInit(){this.initForm(),this.initObservers(),this.initPermissions()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}handleSubmit(){this.form.valid&&(this.bookmarkIterator=[...this.settings.bookmarks],this.copyNextBookmark())}copyNextBookmark(){const e=Object(S.last)(this.bookmarkIterator);this.copyBookmarkNumber=this.settings.bookmarks.length-this.bookmarkIterator.length,this.copyBookmarkPercent=(this.copyBookmarkNumber-1)/this.settings.bookmarks.length*100,setTimeout(()=>{this.addTeamModel(e)})}handleCopySuccess(e){this.bookmarkIterator.pop();const t=Object(S.get)(e,"collection.collection_name","Team Library");this.snackBar.open(`Added ${e.newBookmark.title} to ${t}.`),this.newBookmarkIds.push(e.newBookmark.id),this.bookmarkIterator.length?this.copyNextBookmark():this.dialogRef.close(this.newBookmarkIds)}handleCopyFailure(e){const t=this.settings.bookmarks.find(t=>t.id===e.id);1===this.bookmarkIterator.length?this.snackBar.open(`Adding ${t.title} to your team library has failed. Please try again.`):(this.snackBar.open(`Adding ${t.title} to your team library has failed. Automatically retrying after 2 seconds.`),setTimeout(()=>{this.copyNextBookmark()},2e3))}initForm(){const e="true"===this.storageService.getLocalItem(L.b.DefaultGroupEdit),t=this.storageService.getLocalItem(L.b.DefaultCollectionId);this.form=this.formBuilder.group({groupEditEnabled:[""+e,B.C.required],collectionId:[t]}),this.form.valueChanges.pipe(Object(u.a)(this.ngUnsubscribe)).subscribe(({groupEditEnabled:e,collectionId:t})=>{e?this.storageService.setLocalItem(L.b.DefaultGroupEdit,e):this.storageService.removeLocalItem(L.b.DefaultGroupEdit),t?this.storageService.setLocalItem(L.b.DefaultCollectionId,t):this.storageService.removeLocalItem(L.b.DefaultCollectionId)})}initObservers(){this.actions.pipe(Object(o.l)(C.l),Object(u.a)(this.ngUnsubscribe)).subscribe(e=>{this.handleCopySuccess(e)}),this.actions.pipe(Object(o.l)(C.k),Object(u.a)(this.ngUnsubscribe)).subscribe(e=>{this.handleCopyFailure(e)})}initPermissions(){Object(r.b)([this.userRole$,this.organization$]).pipe(Object(u.a)(this.ngUnsubscribe)).subscribe(([e,t])=>{this.canAddTeamBookmarks=!Object(S.isNil)(t)&&$.k(e,D.a.AddTeamBookmarks),this.changeRef.markForCheck()})}addTeamModel(e){const{groupEditEnabled:t,collectionId:i}=this.form.value,s=this.store.selectSnapshot(h.a.getOrganization),a=this.store.selectSnapshot(h.a.getCollections),o=this.store.selectSnapshot(d.a.getUserLocale).lang,n=this.canAddTeamBookmarks?{group_id:s.id,member_edit:"true"===t,visible:!0}:void 0,c=this.canAddTeamBookmarks?a.filter(({collection_id:e})=>""+e===i):void 0;this.store.dispatch(new C.j(e.id,e.title,e.type,o,n,c))}}return e.\u0275fac=function(t){return new(t||e)(V.Pb(o.h),V.Pb(o.b),V.Pb(B.f),V.Pb(I.g),V.Pb(x.b),V.Pb(L.d),V.Pb(I.a),V.Pb(V.i))},e.\u0275cmp=V.Jb({type:e,selectors:[["app-add-team-model-dialog"]],decls:16,vars:14,consts:[["mat-dialog-title",""],["mat-dialog-content","",1,"dialog"],[3,"formGroup","submit"],[4,"ngIf"],["mat-dialog-actions","",1,"pt-2"],["app-button","","buttonTheme","light","type","button",1,"mr-2",3,"mat-dialog-close"],["app-button","","buttonType","primary","cdkFocusInitial","",3,"disabled","click"],[3,"value"],[1,"text-14","pt-2","pb-4"],["size","small","render","inline",1,"mr-1"],["theme","light","label","Permissions",1,"mt-2","mb-2"],["formControlName","groupEditEnabled",1,"dialog__radio-group","text-12","mt-2"],["value","false",1,"mb-2"],["value","true"],["label","Collection (Optional)","theme","light","class","mb-2",4,"ngIf"],["label","Collection (Optional)","theme","light",1,"mb-2"],["formControlName","collectionId",1,"input"],[3,"value",4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(V.Vb(0,"h1",0),V.Pc(1,"Add to Team Library"),V.Ub(),V.Vb(2,"div",1),V.Vb(3,"form",2),V.cc("submit",(function(){return t.handleSubmit()})),V.Nc(4,W,5,3,"ng-container",3),V.hc(5,"async"),V.Nc(6,J,9,3,"ng-container",3),V.Ub(),V.Ub(),V.Vb(7,"div",4),V.Vb(8,"button",5),V.Pc(9," Cancel "),V.Ub(),V.Vb(10,"button",6),V.cc("click",(function(){return t.handleSubmit()})),V.hc(11,"async"),V.Nc(12,Z,3,0,"ng-container",3),V.hc(13,"async"),V.Nc(14,H,2,0,"ng-container",3),V.hc(15,"async"),V.Ub(),V.Ub()),2&e&&(V.Db(3),V.mc("formGroup",t.form),V.Db(1),V.mc("ngIf",t.settings.bookmarks.length>1&&V.ic(5,6,t.copying$)),V.Db(2),V.mc("ngIf",t.canAddTeamBookmarks),V.Db(4),V.mc("disabled",V.ic(11,8,t.copying$)),V.Db(2),V.mc("ngIf",V.ic(13,10,t.copying$)),V.Db(2),V.mc("ngIf",!V.ic(15,12,t.copying$)))},directives:[I.h,I.e,B.E,B.s,B.j,s.p,I.c,N.a,I.d,F.a,M.a,q.a,_.b,B.r,B.i,_.a,B.B,B.v,B.D,s.o],pipes:[s.b],styles:[".dialog__radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column}@media (min-width:480px){.dialog[_ngcontent-%COMP%]{min-width:380px}}"],changeDetection:0}),z([Object(o.e)(d.a.getUserRole),G("design:type",l.a)],e.prototype,"userRole$",void 0),z([Object(o.e)(h.a.getOrganization),G("design:type",l.a)],e.prototype,"organization$",void 0),z([Object(o.e)(h.a.getCollections),G("design:type",l.a)],e.prototype,"collections$",void 0),z([Object(o.e)(E.a.getCopying),G("design:type",l.a)],e.prototype,"copying$",void 0),e})();var Y=i("5sb6"),ee=i("eqP/"),te=i("+8WF"),ie=i("XqAe"),se=i("PV7u"),ae=i("0MNC"),oe=i("c8sk"),ne=i("tgUM"),ce=i("ihWl"),re=i("Mgbk"),le=i("LRne"),be=i("uAsG"),he=i("Iab2"),pe=i("xo8B"),de=i("PWQe"),ue=i("CSvP");let ge=(()=>{class e{constructor(e,t,i){this.store=e,this.APP_BASE_URL=t,this.VIEWER_BASE_URL=i}getStudioSearchConfigFromEmptyRoute(e){return this.store.select(d.a.getUserProfile).pipe(Object(g.a)(Boolean),Object(k.a)(1),Object(f.a)(t=>{switch(e.data.settings.contentType){case P.a.Module:return new ce.a("all");case P.a.Bookmark:const e=Object(S.get)(t,"organizations[0].id");return e?new ce.f(e):new ce.g;case P.a.Internal:return new ce.d}}))}getStudioSearchConfigFromRoute(e){const t=e.queryParams,i=Object(S.get)(t,"categoryId","all"),s=parseInt(Object(S.get)(t,"organizationId",null),10),a=parseInt(Object(S.get)(t,"collectionId",null),10),o=Object(S.get)(t,"type",p.a.Category),n=Object(S.get)(t,"tags","").split("|"),c=Object(S.get)(t,"query",""),r=Object(S.get)(t,"directory","");switch(o){case p.a.Category:return Object(le.a)(new ce.a(i,n,c));case p.a.Community:return Object(le.a)(new ce.c(c,n));case p.a.Private:return Object(le.a)(new ce.g(c,n));case p.a.Collection:return Object(le.a)(new ce.b(s,a,c,n));case p.a.Organization:return Object(le.a)(new ce.f(s,c,n));case p.a.Internal:return Object(le.a)(new ce.d(c,r,n))}}getSearchOptionsFromRoute(e){const t=e.queryParams,i=e.data.settings,s=Object(S.get)(t,"sort","").split("|"),a="true"===Object(S.get)(t,"asc","true"),o=new re.a("",null);let n=ne.c.find(e=>Object(S.isEqual)(s,e.fields)&&e.ascending===a);return Object(S.isNil)(n)&&(n=i.contentType!==P.a.Module&&i.contentType!==P.a.Internal||j.a.application===w.a.Loft?ne.d:ne.e),Object(S.isNil)(n)||(o.sortBy=n),o}getLoftSearchConfigFromEmptyRoute(){return new ce.e("production","maleAdult","")}getLoftSearchConfigFromRoute(e){const t=e.queryParams,i=Object(S.get)(t,"primary"),s=Object(S.get)(t,"secondary"),a=Object(S.get)(t,"query","");return i?new ce.e(i,s,a):null}exportBookmarksToCSV(){var e;const t=this.getCheckedResults(),i=this.store.selectSnapshot(oe.a.getWidgetURL),s=this.store.selectSnapshot(h.a.getWidgetOptions),a=this.store.selectSnapshot(h.a.getAppFeatures),o=a&&a.offlinePkgGen,n=this.store.selectSnapshot(d.a.getUserLanguage),c=this.store.selectSnapshot(d.a.getSelectedUserApp),r=this.store.selectSnapshot(h.a.getCollections),l=null===(e=this.store.selectSnapshot(h.a.getOrganization))||void 0===e?void 0:e.id,b=this.store.selectSnapshot(h.a.getSelectedOrganizationProductAccountId);this.store.dispatch(new C.p(t,l,r,i,n,c,s,o,b))}exportModulesToCSV(){const e=Object(be.b)(this.store.selectSnapshot(d.a.getUserProfile)),t=this.getCheckedResults().map(t=>Object.assign(Object.assign({title:t.title,specialty:Object(S.get)(Object(pe.c)(t),"title",""),category:Object(S.get)(Object(pe.b)(t),"title",""),viewer:`${this.VIEWER_BASE_URL}/?id=${t.id}`},e?{viewer:`${this.VIEWER_BASE_URL}/?id=${t.id}`}:{}),{app:`${this.APP_BASE_URL}/view?id=${t.id}`,animated:t.animated?"yes":"no",tour:t.tour?"yes":"no",created:t.create_date_time})),i=[{label:"Model Title",field:"title"},{label:"Specialty",field:"specialty"},{label:"Category",field:"category"},...e?[{label:"Human Viewer Link",field:"viewer"}]:[],{label:"Web App Link",field:"app"},{label:"Animated",field:"animated"},{label:"Tour",field:"tour"},{label:"Created Date",field:"created"}];Object(de.a)(t,i).subscribe(e=>{const t=`BioDigital-Library-${(new Date).toISOString().split("T")[0]}.csv`,i=new Blob([e],{type:"text/csv;charset=utf-8"});Object(he.saveAs)(i,t)})}getCheckedResults(){const e=this.store.selectSnapshot(n.a.getAllResults),t=this.store.selectSnapshot(n.a.getCheckedResults);return e.items.filter(e=>t.some(t=>e.id===t))}}return e.\u0275fac=function(t){return new(t||e)(V.Zb(o.h),V.Zb(ue.a),V.Zb(ue.c))},e.\u0275prov=V.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var me=i("u47x"),fe=i("TRdv"),ye=function(e,t,i,s){var a,o=arguments.length,n=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var c=e.length-1;c>=0;c--)(a=e[c])&&(n=(o<3?a(n):o>3?a(t,i,n):a(t,i))||n);return o>3&&n&&Object.defineProperty(t,i,n),n},ke=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let Oe=(()=>{class e{constructor(e,t,i,s,a,o,n,r,l,h,p,d){this.actions=e,this.activatedRoute=t,this.bookmarksService=i,this.bookmarkActionsService=s,this.breakpointObserver=a,this.router=o,this.searchService=n,this.dialog=r,this.store=l,this.location=h,this.urlSerializer=p,this.liveAnnouncer=d,this.categories=b.a.categories,this.application=j.a.application,this.environmentApplication=w.a,this.ngUnsubscribe=new c.a}ngOnInit(){this.searchSettings=this.activatedRoute.snapshot.data.settings,this.activatedRoute.queryParams.pipe(Object(u.a)(this.ngUnsubscribe)).subscribe(()=>{(this.activatedRoute.snapshot.queryParamMap.has("primary")?this.searchLoftFromRoute:this.searchStudioFromRoute).call(this,this.activatedRoute.snapshot)}),this.store.dispatch(new v.a.SetCardActions({enabled:!0})),this.updateSidenavEnabled(this.searchSettings),this.keepRouteUpdated(),this.observeActionResults(),this.keepBulkActionsUpdated(),this.initAccessibilty()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete(),this.store.dispatch(new v.a.Reset)}initAccessibilty(){Object(r.b)([this.store.select(n.a.getFilteredResults),this.store.select(n.a.getSearchConfig),this.store.select(n.a.getLoading),Object(ee.a)(this.store)]).pipe(Object(g.a)(([e,t,i])=>!Object(S.isNil)(e)&&!Object(S.isNil)(t)&&!i),Object(m.a)((e,t)=>Object(S.isEqual)(e[0],t[0])),Object(u.a)(this.ngUnsubscribe)).subscribe(([e,t,i,s])=>{const{total:a,items:o}=e,n=t.query,c=[];c.push(0===a?"No results found":a===o.length?`Showing ${a} results`:`Showing ${o.length} of ${a} results`),c.push(n?`for search, "${n}"`:`for category, "${s}"`);const r=c.join(" ")+".";this.liveAnnouncer.announce(r)}),this.actions.pipe(Object(o.l)(v.a.CheckAll),Object(f.a)(()=>this.store.selectSnapshot(n.a.getCheckedResults)),Object(u.a)(this.ngUnsubscribe)).subscribe(e=>{this.liveAnnouncer.announce(e.length+" models selected.")}),this.actions.pipe(Object(o.l)(v.a.UncheckAll),Object(u.a)(this.ngUnsubscribe)).subscribe(()=>{this.liveAnnouncer.announce("Model selections cleared.")}),this.viewMode$.pipe(Object(m.a)((e,t)=>Object(S.isEqual)(e,t)),Object(y.a)(1),Object(u.a)(this.ngUnsubscribe)).subscribe(e=>{this.liveAnnouncer.announce(`Gallery view mode updated to ${e===te.a.Card?"Card":"List"} View.`)})}searchStudioFromRoute(e){(Object(S.isEmpty)(e.queryParams)?this.searchService.getStudioSearchConfigFromEmptyRoute(e):this.searchService.getStudioSearchConfigFromRoute(e)).pipe(Object(k.a)(1)).subscribe(t=>{const i=this.searchService.getSearchOptionsFromRoute(e);this.store.dispatch(new v.a.SetSearchOptions(i)),t&&this.store.dispatch(new v.a.SetSearchConfig(t))})}searchLoftFromRoute(e){const t=Object(S.isEmpty)(e.queryParams)?this.searchService.getLoftSearchConfigFromEmptyRoute():this.searchService.getLoftSearchConfigFromRoute(e),i=this.searchService.getSearchOptionsFromRoute(e);this.store.dispatch(new v.a.SetSearchOptions(i)),this.store.dispatch(new v.a.SetSearchConfig(t))}updateSidenavEnabled(e){e.application===w.a.Studio&&e.contentType===P.a.Bookmark&&this.store.select(d.a.isPrivateUser).pipe(Object(g.a)(e=>null!==e),Object(u.a)(this.ngUnsubscribe)).subscribe(e=>{const t=this.store.selectSnapshot(n.a.getSidenav);this.store.dispatch(new v.a.SetSidenav(Object.assign(Object.assign({},t),{enabled:!e})))})}keepRouteUpdated(){Object(r.b)(this.store.select(n.a.getSearchConfig),this.store.select(n.a.getSearchOptions)).pipe(Object(g.a)(([e,t])=>!Object(S.isNil)(e)&&!Object(S.isNil)(t)),Object(m.a)((e,t)=>Object(S.isEqual)(e,t)),Object(O.a)(),Object(u.a)(this.ngUnsubscribe)).subscribe(([[e],[t,i]])=>{const s=this.getUrlTree(t,i),a=Object(S.isEqual)(Object(S.omit)(e,["query"]),Object(S.omit)(t,["query"]));this.router.navigateByUrl(this.router.serializeUrl(s),{skipLocationChange:a}),a&&this.replaceLocationState()})}observeActionResults(){this.actions.pipe(Object(o.l)(C.B,C.o,C.e,C.l),Object(u.a)(this.ngUnsubscribe)).subscribe(e=>{this.store.dispatch(new v.a.SearchStudio)})}keepBulkActionsUpdated(){Object(r.b)([this.breakpointObserver.observe("(max-width: 959px)"),this.userProfile$,this.searchConfig$]).pipe(Object(u.a)(this.ngUnsubscribe),Object(g.a)(([,,e])=>!Object(S.isNil)(e))).subscribe(([,,e])=>{e&&this.updateBulkActions(e)})}updateBulkActions(e){const t=new A.a;let i,s,a;switch(t.active=!1,e.type){case p.a.Private:case p.a.Organization:case p.a.Collection:case p.a.Category:i=this.store.selectSnapshot(d.a.getUserRole),s=this.store.selectSnapshot(d.a.isPremiumUser),a=$.g(i,s)?[R.a.ExportCSV]:[],t.enabled=!0,t.items=[...a],e.type===p.a.Category&&"true"===localStorage.getItem("bulkAdd")&&t.items.push(R.a.AddToTeamLibrary),e.type!==p.a.Collection&&e.type!==p.a.Organization&&e.type!==p.a.Private||"true"!==localStorage.getItem("bulkDelete")||t.items.push(R.a.Delete);break;default:t.enabled=!1}(j.a.platform!==U.a.Web||this.breakpointObserver.isMatched("(max-width: 959px)"))&&(t.enabled=!1),this.store.dispatch(new v.a.SetBulkActions(t))}handleBulkAction(e){const{name:t}=e,i=this.store.selectSnapshot(n.a.getSearchConfig);switch(t){case R.a.ExportCSV:i.type===p.a.Category?this.searchService.exportModulesToCSV():this.searchService.exportBookmarksToCSV();break;case R.a.AddToTeamLibrary:if(i.type===p.a.Category){const e=this.store.selectSnapshot(n.a.getAllResults),t=this.store.selectSnapshot(n.a.getCheckedResults).map(t=>e.items.find(e=>e.id===t));this.dialog.open(K,{id:Y.a.AddTeamModelDialog,data:{bookmarks:t}})}break;case R.a.Delete:if(i.type===p.a.Collection||i.type===p.a.Organization||i.type===p.a.Private){const e=this.store.selectSnapshot(n.a.getCheckedResults);this.store.dispatch(new C.c(e));break}}}handleView(e){this.bookmarkActionsService.view(e)}replaceLocationState(){const e=this.store.selectSnapshot(n.a.getSearchConfig),t=this.store.selectSnapshot(n.a.getSearchOptions),i=this.getUrlTree(e,t),s=this.urlSerializer.serialize(i);this.location.replaceState(s)}getUrlTree(e,t){const i=window.location.pathname,s=Object(S.get)(t,"sortBy.fields",[]).join("|"),a=Object(S.get)(t,"sortBy.ascending",!0),o={};s.length&&(o.sort=s,o.asc=a);const n={tags:Object(S.compact)(Object(S.get)(e,"tags",[])).join("|")},c=Object.entries(Object.assign(Object.assign(Object.assign({},e),n),o)).reduce((t,[i,s])=>(null!==s&&""!==s&&(t[i]=s),e.type===p.a.Loft&&(["primary","secondary","query"].includes(i)||delete t[i]),t),{});return this.router.createUrlTree([i],{queryParams:c})}}return e.\u0275fac=function(t){return new(t||e)(V.Pb(o.b),V.Pb(a.a),V.Pb(ie.a),V.Pb(se.a),V.Pb(ae.a),V.Pb(a.e),V.Pb(ge),V.Pb(I.b),V.Pb(o.h),V.Pb(s.k),V.Pb(a.k),V.Pb(me.i))},e.\u0275cmp=V.Jb({type:e,selectors:[["app-search-page"]],decls:2,vars:3,consts:[[1,"search-page"],[3,"application","contentType","showSourcePicker","bulkAction","selectBookmark"]],template:function(e,t){1&e&&(V.Vb(0,"div",0),V.Vb(1,"app-gallery-container",1),V.cc("bulkAction",(function(e){return t.handleBulkAction(e)}))("selectBookmark",(function(e){return t.handleView(e)})),V.Ub(),V.Ub()),2&e&&(V.Db(1),V.mc("application",t.searchSettings.application)("contentType",t.searchSettings.contentType)("showSourcePicker",t.application===t.environmentApplication.Loft))},directives:[fe.a],styles:[".search-page[_ngcontent-%COMP%]{min-height:100%;display:flex}"],changeDetection:0}),ye([Object(o.e)(n.a.getFilteredResults),ke("design:type",l.a)],e.prototype,"results$",void 0),ye([Object(o.e)(n.a.getSearchConfig),ke("design:type",l.a)],e.prototype,"searchConfig$",void 0),ye([Object(o.e)(d.a.getUserProfile),ke("design:type",l.a)],e.prototype,"userProfile$",void 0),ye([Object(o.e)(h.a.getOrganization),ke("design:type",l.a)],e.prototype,"organization$",void 0),ye([Object(o.e)(h.a.getCollections),ke("design:type",l.a)],e.prototype,"collections$",void 0),ye([Object(o.e)(n.a.getViewMode),ke("design:type",l.a)],e.prototype,"viewMode$",void 0),e})();var Se=i("uZ1g"),ve=i("P+IX");let je=(()=>{class e{constructor(){}resolve(e){let t;switch(e.routeConfig.path){case"bookmarks":t=P.a.Bookmark;break;case"modules":t=P.a.Module;break;case"internal":t=P.a.Internal}return{application:j.a.application,contentType:t}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=V.Lb({token:e,factory:e.\u0275fac}),e})();var we=i("mmXA");const Ce=[{path:"",component:Se.a,canActivate:[ve.a],data:{fixedHeight:!0,overflowFix:!0,siteHeaderType:we.a.Search},children:[{path:"modules",resolve:{settings:je},component:Oe,data:{title:"Explore"}},{path:"bookmarks",resolve:{settings:je},component:Oe,data:{title:"My Library"}},{path:"internal",resolve:{settings:je},component:Oe}]}];let Pe=(()=>{class e{}return e.\u0275mod=V.Nb({type:e}),e.\u0275inj=V.Mb({factory:function(t){return new(t||e)},imports:[[a.i.forChild(Ce)],a.i]}),e})();var Re=i("3ros"),Ae=i("Tx//"),Ue=i("vvyD"),Be=i("+dkL");let Ie=(()=>{class e{}return e.\u0275mod=V.Nb({type:e}),e.\u0275inj=V.Mb({factory:function(t){return new(t||e)},providers:[je],imports:[[s.c,Ae.a,Pe,Re.a,Ue.a,Be.a]]}),e})()}}]);