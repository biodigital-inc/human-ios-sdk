!function(){function e(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&t(e,n)}function t(e,n){return(t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,n)}function n(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=o(e);if(t){var r=o(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return i(this,n)}}function i(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function a(e){return function(e){if(Array.isArray(e))return s(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||c(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var i,o,a=[],r=!0,c=!1;try{for(n=n.call(e);!(r=(i=n.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(s){c=!0,o=s}finally{try{r||null==n.return||n.return()}finally{if(c)throw o}}return a}(e,t)||c(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){if(e){if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function u(e,t,n){return t&&p(e.prototype,t),n&&p(e,n),e}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{5:function(e,t){},j8XN:function(e,t,n){var i;"classList"in document.createElement("_")||function(e){"use strict";if("Element"in e){var t="classList",n="prototype",i=e.Element[n],o=Object,a=String[n].trim||function(){return this.replace(/^\s+|\s+$/g,"")},r=Array[n].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1},c=function(e,t){this.name=e,this.code=DOMException[e],this.message=t},s=function(e,t){if(""===t)throw new c("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(t))throw new c("INVALID_CHARACTER_ERR","String contains an invalid character");return r.call(e,t)},l=function(e){for(var t=a.call(e.getAttribute("class")||""),n=t?t.split(/\s+/):[],i=0,o=n.length;o>i;i++)this.push(n[i]);this._updateClassName=function(){e.setAttribute("class",this.toString())}},p=l[n]=[],u=function(){return new l(this)};if(c[n]=Error[n],p.item=function(e){return this[e]||null},p.contains=function(e){return-1!==s(this,e+="")},p.add=function(){var e,t=arguments,n=0,i=t.length,o=!1;do{-1===s(this,e=t[n]+"")&&(this.push(e),o=!0)}while(++n<i);o&&this._updateClassName()},p.remove=function(){var e,t,n=arguments,i=0,o=n.length,a=!1;do{for(t=s(this,e=n[i]+"");-1!==t;)this.splice(t,1),a=!0,t=s(this,e)}while(++i<o);a&&this._updateClassName()},p.toggle=function(e,t){var n=this.contains(e+=""),i=n?!0!==t&&"remove":!1!==t&&"add";return i&&this[i](e),!0===t||!1===t?t:!n},p.toString=function(){return this.join(" ")},o.defineProperty){var d={get:u,enumerable:!0,configurable:!0};try{o.defineProperty(i,t,d)}catch(m){-2146823252===m.number&&(d.enumerable=!1,o.defineProperty(i,t,d))}}else o[n].__defineGetter__&&i.__defineGetter__(t,u)}}(self),function(e){"use strict";if(e.URL=e.URL||e.webkitURL,e.Blob&&e.URL)try{return void new Blob}catch(n){}var t=e.BlobBuilder||e.WebKitBlobBuilder||e.MozBlobBuilder||function(e){var t=function(e){return Object.prototype.toString.call(e).match(/^\[object\s(.*)\]$/)[1]},n=function(){this.data=[]},i=function(e,t,n){this.data=e,this.size=e.length,this.type=t,this.encoding=n},o=n.prototype,a=i.prototype,r=e.FileReaderSync,c=function(e){this.code=this[this.name=e]},s="NOT_FOUND_ERR SECURITY_ERR ABORT_ERR NOT_READABLE_ERR ENCODING_ERR NO_MODIFICATION_ALLOWED_ERR INVALID_STATE_ERR SYNTAX_ERR".split(" "),l=s.length,p=e.URL||e.webkitURL||e,u=p.createObjectURL,d=p.revokeObjectURL,m=p,h=e.btoa,b=e.atob,f=e.ArrayBuffer,g=e.Uint8Array,v=/^[\w-]+:\/*\[?[\w\.:-]+\]?(?::[0-9]+)?/;for(i.fake=a.fake=!0;l--;)c.prototype[s[l]]=l+1;return p.createObjectURL||(m=e.URL=function(e){var t,n=document.createElementNS("http://www.w3.org/1999/xhtml","a");return n.href=e,"origin"in n||("data:"===n.protocol.toLowerCase()?n.origin=null:(t=e.match(v),n.origin=t&&t[1])),n}),m.createObjectURL=function(e){var t,n=e.type;return null===n&&(n="application/octet-stream"),e instanceof i?(t="data:"+n,"base64"===e.encoding?t+";base64,"+e.data:"URI"===e.encoding?t+","+decodeURIComponent(e.data):h?t+";base64,"+h(e.data):t+","+encodeURIComponent(e.data)):u?u.call(p,e):void 0},m.revokeObjectURL=function(e){"data:"!==e.substring(0,5)&&d&&d.call(p,e)},o.append=function(e){var n=this.data;if(g&&(e instanceof f||e instanceof g)){for(var o="",a=new g(e),s=0,l=a.length;l>s;s++)o+=String.fromCharCode(a[s]);n.push(o)}else if("Blob"===t(e)||"File"===t(e)){if(!r)throw new c("NOT_READABLE_ERR");var p=new r;n.push(p.readAsBinaryString(e))}else e instanceof i?"base64"===e.encoding&&b?n.push(b(e.data)):"URI"===e.encoding?n.push(decodeURIComponent(e.data)):"raw"===e.encoding&&n.push(e.data):("string"!=typeof e&&(e+=""),n.push(unescape(encodeURIComponent(e))))},o.getBlob=function(e){return arguments.length||(e=null),new i(this.data.join(""),e,"raw")},o.toString=function(){return"[object BlobBuilder]"},a.slice=function(e,t,n){var o=arguments.length;return 3>o&&(n=null),new i(this.data.slice(e,o>1?t:this.data.length),n,this.encoding)},a.toString=function(){return"[object Blob]"},a.close=function(){this.size=0,delete this.data},n}(e);e.Blob=function(e,n){var i=n&&n.type||"",o=new t;if(e)for(var a=0,r=e.length;r>a;a++)Uint8Array&&e[a]instanceof Uint8Array?o.append(e[a].buffer):o.append(e[a]);var c=o.getBlob(i);return!c.slice&&c.webkitSlice&&(c.slice=c.webkitSlice),c},e.Blob.prototype=(Object.getPrototypeOf||function(e){return e.__proto__})(new e.Blob)}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content||this),function(o,a){"use strict";"undefined"!=typeof process&&process&&process.versions&&process.versions.electron||"object"!=typeof e?void 0===(i=(function(){return a}).call(t,n,t,e))||(e.exports=i):e.exports=a}(0,function(){"use strict";function e(e,t){return this.init(e,t)}return e.extensions={},function(t){function n(e,t){var n,i=Array.prototype.slice.call(arguments,2);t=t||{};for(var o=0;o<i.length;o++){var a=i[o];if(a)for(n in a)a.hasOwnProperty(n)&&void 0!==a[n]&&(e||!1===t.hasOwnProperty(n))&&(t[n]=a[n])}return t}var i=!1;try{var o=document.createElement("div"),a=document.createTextNode(" ");o.appendChild(a),i=o.contains(a)}catch(c){}var r={isIE:"Microsoft Internet Explorer"===navigator.appName||"Netscape"===navigator.appName&&null!==new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})").exec(navigator.userAgent),isEdge:null!==/Edge\/\d+/.exec(navigator.userAgent),isFF:navigator.userAgent.toLowerCase().indexOf("firefox")>-1,isMac:t.navigator.platform.toUpperCase().indexOf("MAC")>=0,keyCode:{BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,SPACE:32,DELETE:46,K:75,M:77,V:86},isMetaCtrlKey:function(e){return!!(r.isMac&&e.metaKey||!r.isMac&&e.ctrlKey)},isKey:function(e,t){var n=r.getKeyCode(e);return!1===Array.isArray(t)?n===t:-1!==t.indexOf(n)},getKeyCode:function(e){var t=e.which;return null===t&&(t=null!==e.charCode?e.charCode:e.keyCode),t},blockContainerElementNames:["p","h1","h2","h3","h4","h5","h6","blockquote","pre","ul","li","ol","address","article","aside","audio","canvas","dd","dl","dt","fieldset","figcaption","figure","footer","form","header","hgroup","main","nav","noscript","output","section","video","table","thead","tbody","tfoot","tr","th","td"],emptyElementNames:["br","col","colgroup","hr","img","input","source","wbr"],extend:function(){var e=[!0].concat(Array.prototype.slice.call(arguments));return n.apply(this,e)},defaults:function(){var e=[!1].concat(Array.prototype.slice.call(arguments));return n.apply(this,e)},createLink:function(e,t,n,i){var o=e.createElement("a");return r.moveTextRangeIntoElement(t[0],t[t.length-1],o),o.setAttribute("href",n),i&&("_blank"===i&&o.setAttribute("rel","noopener noreferrer"),o.setAttribute("target",i)),o},findOrCreateMatchingTextNodes:function(e,t,n){for(var i=e.createTreeWalker(t,NodeFilter.SHOW_ALL,null,!1),o=[],a=0,c=!1,s=null,l=null;null!==(s=i.nextNode());)if(!(s.nodeType>3))if(3===s.nodeType){if(!c&&n.start<a+s.nodeValue.length&&(c=!0,l=r.splitStartNodeIfNeeded(s,n.start,a)),c&&r.splitEndNodeIfNeeded(s,l,n.end,a),c&&a===n.end)break;if(c&&a>n.end+1)throw new Error("PerformLinking overshot the target!");c&&o.push(l||s),a+=s.nodeValue.length,null!==l&&(a+=l.nodeValue.length,i.nextNode()),l=null}else"img"===s.tagName.toLowerCase()&&(!c&&n.start<=a&&(c=!0),c&&o.push(s));return o},splitStartNodeIfNeeded:function(e,t,n){return t!==n?e.splitText(t-n):null},splitEndNodeIfNeeded:function(e,t,n,i){var o,a;a=n-i-(t?e.nodeValue.length:0),(o=i+e.nodeValue.length+(t?t.nodeValue.length:0)-1)>=n&&i!==o&&0!==a&&(t||e).splitText(a)},splitByBlockElements:function(t){if(3!==t.nodeType&&1!==t.nodeType)return[];var n=[],i=e.util.blockContainerElementNames.join(",");if(3===t.nodeType||0===t.querySelectorAll(i).length)return[t];for(var o=0;o<t.childNodes.length;o++){var a=t.childNodes[o];3===a.nodeType?n.push(a):1===a.nodeType&&(0===a.querySelectorAll(i).length?n.push(a):n=n.concat(e.util.splitByBlockElements(a)))}return n},findAdjacentTextNodeWithContent:function(e,t,n){var i,o=!1,a=n.createNodeIterator(e,NodeFilter.SHOW_TEXT,null,!1);for(i=a.nextNode();i;){if(i===t)o=!0;else if(o&&3===i.nodeType&&i.nodeValue&&i.nodeValue.trim().length>0)break;i=a.nextNode()}return i},findPreviousSibling:function(e){if(!e||r.isMediumEditorElement(e))return!1;for(var t=e.previousSibling;!t&&!r.isMediumEditorElement(e.parentNode);)t=(e=e.parentNode).previousSibling;return t},isDescendant:function(e,t,n){if(!e||!t)return!1;if(e===t)return!!n;if(1!==e.nodeType)return!1;if(i||3!==t.nodeType)return e.contains(t);for(var o=t.parentNode;null!==o;){if(o===e)return!0;o=o.parentNode}return!1},isElement:function(e){return!(!e||1!==e.nodeType)},throttle:function(e,t){var n,i,o,a=null,r=0,c=function(){r=Date.now(),a=null,o=e.apply(n,i),a||(n=i=null)};return t||0===t||(t=50),function(){var s=Date.now(),l=t-(s-r);return n=this,i=arguments,0>=l||l>t?(a&&(clearTimeout(a),a=null),r=s,o=e.apply(n,i),a||(n=i=null)):a||(a=setTimeout(c,l)),o}},traverseUp:function(e,t){if(!e)return!1;do{if(1===e.nodeType){if(t(e))return e;if(r.isMediumEditorElement(e))return!1}e=e.parentNode}while(e);return!1},htmlEntities:function(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},insertHTMLCommand:function(t,n){var i,o,a,c,s,l,p=!1,u=["insertHTML",!1,n];if(!e.util.isEdge&&t.queryCommandSupported("insertHTML"))try{return t.execCommand.apply(t,u)}catch(d){}if((i=t.getSelection()).rangeCount){if(o=i.getRangeAt(0),r.isMediumEditorElement(l=o.commonAncestorContainer)&&!l.firstChild)o.selectNode(l.appendChild(t.createTextNode("")));else if(3===l.nodeType&&0===o.startOffset&&o.endOffset===l.nodeValue.length||3!==l.nodeType&&l.innerHTML===o.toString()){for(;!r.isMediumEditorElement(l)&&l.parentNode&&1===l.parentNode.childNodes.length&&!r.isMediumEditorElement(l.parentNode);)l=l.parentNode;o.selectNode(l)}for(o.deleteContents(),(a=t.createElement("div")).innerHTML=n,c=t.createDocumentFragment();a.firstChild;)s=c.appendChild(a.firstChild);o.insertNode(c),s&&((o=o.cloneRange()).setStartAfter(s),o.collapse(!0),e.selection.selectRange(t,o)),p=!0}return t.execCommand.callListeners&&t.execCommand.callListeners(u,p),p},execFormatBlock:function(t,n){var i=r.getTopBlockContainer(e.selection.getSelectionStart(t));if("blockquote"===n){if(i&&Array.prototype.slice.call(i.childNodes).some((function(e){return r.isBlockContainer(e)})))return t.execCommand("outdent",!1,null);if(r.isIE)return t.execCommand("indent",!1,n)}if(i&&n===i.nodeName.toLowerCase()&&(n="p"),r.isIE&&(n="<"+n+">"),i&&"blockquote"===i.nodeName.toLowerCase()){if(r.isIE&&"<p>"===n)return t.execCommand("outdent",!1,n);if((r.isFF||r.isEdge)&&"p"===n)return Array.prototype.slice.call(i.childNodes).some((function(e){return!r.isBlockContainer(e)}))&&t.execCommand("formatBlock",!1,n),t.execCommand("outdent",!1,n)}return t.execCommand("formatBlock",!1,n)},setTargetBlank:function(e,t){var n,i=t||!1;if("a"===e.nodeName.toLowerCase())e.target="_blank",e.rel="noopener noreferrer";else for(e=e.getElementsByTagName("a"),n=0;n<e.length;n+=1)!1!==i&&i!==e[n].attributes.href.value||(e[n].target="_blank",e[n].rel="noopener noreferrer")},removeTargetBlank:function(e,t){var n;if("a"===e.nodeName.toLowerCase())e.removeAttribute("target"),e.removeAttribute("rel");else for(e=e.getElementsByTagName("a"),n=0;n<e.length;n+=1)t===e[n].attributes.href.value&&(e[n].removeAttribute("target"),e[n].removeAttribute("rel"))},addClassToAnchors:function(e,t){var n,i,o=t.split(" ");if("a"===e.nodeName.toLowerCase())for(i=0;i<o.length;i+=1)e.classList.add(o[i]);else{var a=e.getElementsByTagName("a");if(0===a.length){var c=r.getClosestTag(e,"a");e=c?[c]:[]}else e=a;for(n=0;n<e.length;n+=1)for(i=0;i<o.length;i+=1)e[n].classList.add(o[i])}},isListItem:function(e){if(!e)return!1;if("li"===e.nodeName.toLowerCase())return!0;for(var t=e.parentNode,n=t.nodeName.toLowerCase();"li"===n||!r.isBlockContainer(t)&&"div"!==n;){if("li"===n)return!0;if(!(t=t.parentNode))return!1;n=t.nodeName.toLowerCase()}return!1},cleanListDOM:function(t,n){if("li"===n.nodeName.toLowerCase()){var i=n.parentElement;"p"===i.parentElement.nodeName.toLowerCase()&&(r.unwrap(i.parentElement,t),e.selection.moveCursor(t,n.firstChild,n.firstChild.textContent.length))}},splitOffDOMTree:function(e,t,n){for(var i=t,o=null,a=!n;i!==e;){var r,c=i.parentNode,s=c.cloneNode(!1),l=a?i:c.firstChild;for(o&&(a?s.appendChild(o):r=o),o=s;l;){var p=l.nextSibling;l===i?(l.hasChildNodes()?l=l.cloneNode(!1):l.parentNode.removeChild(l),l.textContent&&o.appendChild(l),l=a?p:null):(l.parentNode.removeChild(l),(l.hasChildNodes()||l.textContent)&&o.appendChild(l),l=p)}r&&o.appendChild(r),i=c}return o},moveTextRangeIntoElement:function(e,t,n){if(!e||!t)return!1;var i=r.findCommonRoot(e,t);if(!i)return!1;if(t===e){var o=e.parentNode,a=e.nextSibling;return o.removeChild(e),n.appendChild(e),a?o.insertBefore(n,a):o.appendChild(n),n.hasChildNodes()}for(var c,s,l,p=[],u=0;u<i.childNodes.length;u++)if(l=i.childNodes[u],c){if(r.isDescendant(l,t,!0)){s=l;break}p.push(l)}else r.isDescendant(l,e,!0)&&(c=l);var d=s.nextSibling,m=i.ownerDocument.createDocumentFragment();return c===e?(c.parentNode.removeChild(c),m.appendChild(c)):m.appendChild(r.splitOffDOMTree(c,e)),p.forEach((function(e){e.parentNode.removeChild(e),m.appendChild(e)})),s===t?(s.parentNode.removeChild(s),m.appendChild(s)):m.appendChild(r.splitOffDOMTree(s,t,!0)),n.appendChild(m),s.parentNode===i?i.insertBefore(n,s):d?i.insertBefore(n,d):i.appendChild(n),n.hasChildNodes()},depthOfNode:function(e){for(var t=0,n=e;null!==n.parentNode;)n=n.parentNode,t++;return t},findCommonRoot:function(e,t){for(var n=r.depthOfNode(e),i=r.depthOfNode(t),o=e,a=t;n!==i;)n>i?(o=o.parentNode,n-=1):(a=a.parentNode,i-=1);for(;o!==a;)o=o.parentNode,a=a.parentNode;return o},isElementAtBeginningOfBlock:function(e){for(var t;!r.isBlockContainer(e)&&!r.isMediumEditorElement(e);){for(t=e;t=t.previousSibling;)if((3===t.nodeType?t.nodeValue:t.textContent).length>0)return!1;e=e.parentNode}return!0},isMediumEditorElement:function(e){return e&&e.getAttribute&&!!e.getAttribute("data-medium-editor-element")},getContainerEditorElement:function(e){return r.traverseUp(e,(function(e){return r.isMediumEditorElement(e)}))},isBlockContainer:function(e){return e&&3!==e.nodeType&&-1!==r.blockContainerElementNames.indexOf(e.nodeName.toLowerCase())},getClosestBlockContainer:function(e){return r.traverseUp(e,(function(e){return r.isBlockContainer(e)||r.isMediumEditorElement(e)}))},getTopBlockContainer:function(e){var t=!!r.isBlockContainer(e)&&e;return r.traverseUp(e,(function(e){return r.isBlockContainer(e)&&(t=e),!(t||!r.isMediumEditorElement(e)||(t=e,0))})),t},getFirstSelectableLeafNode:function(e){for(;e&&e.firstChild;)e=e.firstChild;if("table"===(e=r.traverseUp(e,(function(e){return-1===r.emptyElementNames.indexOf(e.nodeName.toLowerCase())}))).nodeName.toLowerCase()){var t=e.querySelector("th, td");t&&(e=t)}return e},getFirstTextNode:function(e){return r.warn("getFirstTextNode is deprecated and will be removed in version 6.0.0"),r._getFirstTextNode(e)},_getFirstTextNode:function(e){if(3===e.nodeType)return e;for(var t=0;t<e.childNodes.length;t++){var n=r._getFirstTextNode(e.childNodes[t]);if(null!==n)return n}return null},ensureUrlHasProtocol:function(e){return-1===e.indexOf("://")?"http://"+e:e},warn:function(){void 0!==t.console&&"function"==typeof t.console.warn&&t.console.warn.apply(t.console,arguments)},deprecated:function(e,t,n){var i=e+" is deprecated, please use "+t+" instead.";n&&(i+=" Will be removed in "+n),r.warn(i)},deprecatedMethod:function(e,t,n,i){r.deprecated(e,t,i),"function"==typeof this[t]&&this[t].apply(this,n)},cleanupAttrs:function(e,t){t.forEach((function(t){e.removeAttribute(t)}))},cleanupTags:function(e,t){-1!==t.indexOf(e.nodeName.toLowerCase())&&e.parentNode.removeChild(e)},unwrapTags:function(t,n){-1!==n.indexOf(t.nodeName.toLowerCase())&&e.util.unwrap(t,document)},getClosestTag:function(e,t){return r.traverseUp(e,(function(e){return e.nodeName.toLowerCase()===t.toLowerCase()}))},unwrap:function(e,t){for(var n=t.createDocumentFragment(),i=Array.prototype.slice.call(e.childNodes),o=0;o<i.length;o++)n.appendChild(i[o]);n.childNodes.length?e.parentNode.replaceChild(n,e):e.parentNode.removeChild(e)},guid:function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}};e.util=r}(window),(t=function(t){e.util.extend(this,t)}).extend=function(t){var n,i=this;n=t&&t.hasOwnProperty("constructor")?t.constructor:function(){return i.apply(this,arguments)},e.util.extend(n,i);var o=function(){this.constructor=n};return o.prototype=i.prototype,n.prototype=new o,t&&e.util.extend(n.prototype,t),n},t.prototype={init:function(){},base:void 0,name:void 0,checkState:void 0,destroy:void 0,queryCommandState:void 0,isActive:void 0,isAlreadyApplied:void 0,setActive:void 0,setInactive:void 0,getInteractionElements:void 0,window:void 0,document:void 0,getEditorElements:function(){return this.base.elements},getEditorId:function(){return this.base.id},getEditorOption:function(e){return this.base.options[e]}},["execAction","on","off","subscribe","trigger"].forEach((function(e){t.prototype[e]=function(){return this.base[e].apply(this.base,arguments)}})),e.Extension=t,function(){function t(t){return e.util.isBlockContainer(t)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}var n={findMatchingSelectionParent:function(t,n){var i,o=n.getSelection();return 0!==o.rangeCount&&(i=o.getRangeAt(0),e.util.traverseUp(i.commonAncestorContainer,t))},getSelectionElement:function(t){return this.findMatchingSelectionParent((function(t){return e.util.isMediumEditorElement(t)}),t)},exportSelection:function(e,t){if(!e)return null;var n=null,i=t.getSelection();if(i.rangeCount>0){var o,a=i.getRangeAt(0),r=a.cloneRange();r.selectNodeContents(e),r.setEnd(a.startContainer,a.startOffset),n={start:o=r.toString().length,end:o+a.toString().length},this.doesRangeStartWithImages(a,t)&&(n.startsWithImage=!0);var c=this.getTrailingImageCount(e,n,a.endContainer,a.endOffset);if(c&&(n.trailingImageCount=c),0!==o){var s=this.getIndexRelativeToAdjacentEmptyBlocks(t,e,a.startContainer,a.startOffset);-1!==s&&(n.emptyBlocksIndex=s)}}return n},importSelection:function(e,t,n,i){if(e&&t){var o=n.createRange();o.setStart(t,0),o.collapse(!0);var a,r=t,c=[],s=0,l=!1,p=!1,u=0,d=!1,m=!1,h=null;for((i||e.startsWithImage||void 0!==e.emptyBlocksIndex)&&(m=!0);!d&&r;)if(r.nodeType>3)r=c.pop();else{if(3!==r.nodeType||p){if(e.trailingImageCount&&p&&("img"===r.nodeName.toLowerCase()&&u++,u===e.trailingImageCount)){for(var b=0;r.parentNode.childNodes[b]!==r;)b++;o.setEnd(r.parentNode,b+1),d=!0}if(!d&&1===r.nodeType)for(var f=r.childNodes.length-1;f>=0;)c.push(r.childNodes[f]),f-=1}else a=s+r.length,!l&&e.start>=s&&e.start<=a&&(m||e.start<a?(o.setStart(r,e.start-s),l=!0):h=r),l&&e.end>=s&&e.end<=a&&(e.trailingImageCount?p=!0:(o.setEnd(r,e.end-s),d=!0)),s=a;d||(r=c.pop())}!l&&h&&(o.setStart(h,h.length),o.setEnd(h,h.length)),void 0!==e.emptyBlocksIndex&&(o=this.importSelectionMoveCursorPastBlocks(n,t,e.emptyBlocksIndex,o)),i&&(o=this.importSelectionMoveCursorPastAnchor(e,o)),this.selectRange(n,o)}},importSelectionMoveCursorPastAnchor:function(t,n){if(t.start===t.end&&3===n.startContainer.nodeType&&n.startOffset===n.startContainer.nodeValue.length&&e.util.traverseUp(n.startContainer,(function(e){return"a"===e.nodeName.toLowerCase()}))){for(var i=n.startContainer,o=n.startContainer.parentNode;null!==o&&"a"!==o.nodeName.toLowerCase();)o.childNodes[o.childNodes.length-1]!==i?o=null:(i=o,o=o.parentNode);if(null!==o&&"a"===o.nodeName.toLowerCase()){for(var a=null,r=0;null===a&&r<o.parentNode.childNodes.length;r++)o.parentNode.childNodes[r]===o&&(a=r);n.setStart(o.parentNode,a+1),n.collapse(!0)}}return n},importSelectionMoveCursorPastBlocks:function(n,i,o,a){var r,c,s=n.createTreeWalker(i,NodeFilter.SHOW_ELEMENT,t,!1),l=a.startContainer,p=0;for(o=o||1,r=3===l.nodeType&&e.util.isBlockContainer(l.previousSibling)?l.previousSibling:e.util.getClosestBlockContainer(l);s.nextNode();)if(c){if(c=s.currentNode,++p===o)break;if(c.textContent.length>0)break}else r===s.currentNode&&(c=s.currentNode);return c||(c=r),a.setStart(e.util.getFirstSelectableLeafNode(c),0),a},getIndexRelativeToAdjacentEmptyBlocks:function(n,i,o,a){if(o.textContent.length>0&&a>0)return-1;var r=o;if(3!==r.nodeType&&(r=o.childNodes[a]),r){if(!e.util.isElementAtBeginningOfBlock(r))return-1;var c=e.util.findPreviousSibling(r);if(!c)return-1;if(c.nodeValue)return-1}for(var s=e.util.getClosestBlockContainer(o),l=n.createTreeWalker(i,NodeFilter.SHOW_ELEMENT,t,!1),p=0;l.nextNode();){var u=""===l.currentNode.textContent;if((u||p>0)&&(p+=1),l.currentNode===s)return p;u||(p=0)}return p},doesRangeStartWithImages:function(e,t){if(0!==e.startOffset||1!==e.startContainer.nodeType)return!1;if("img"===e.startContainer.nodeName.toLowerCase())return!0;var n=e.startContainer.querySelector("img");if(!n)return!1;for(var i=t.createTreeWalker(e.startContainer,NodeFilter.SHOW_ALL,null,!1);i.nextNode();){var o=i.currentNode;if(o===n)break;if(o.nodeValue)return!1}return!0},getTrailingImageCount:function(e,t,n,i){if(0===i||1!==n.nodeType)return 0;if("img"!==n.nodeName.toLowerCase()&&!n.querySelector("img"))return 0;for(var o=n.childNodes[i-1];o.hasChildNodes();)o=o.lastChild;for(var a,r=e,c=[],s=0,l=!1,p=!1,u=!1,d=0;!u&&r;)if(r.nodeType>3)r=c.pop();else{if(3!==r.nodeType||p){if("img"===r.nodeName.toLowerCase()&&d++,r===o)u=!0;else if(1===r.nodeType)for(var m=r.childNodes.length-1;m>=0;)c.push(r.childNodes[m]),m-=1}else d=0,a=s+r.length,!l&&t.start>=s&&t.start<=a&&(l=!0),l&&t.end>=s&&t.end<=a&&(p=!0),s=a;u||(r=c.pop())}return d},selectionContainsContent:function(e){var t=e.getSelection();if(!t||t.isCollapsed||!t.rangeCount)return!1;if(""!==t.toString().trim())return!0;var n=this.getSelectedParentElement(t.getRangeAt(0));return!(!n||!("img"===n.nodeName.toLowerCase()||1===n.nodeType&&n.querySelector("img")))},selectionInContentEditableFalse:function(e){var t,n=this.findMatchingSelectionParent((function(e){var n=e&&e.getAttribute("contenteditable");return"true"===n&&(t=!0),"#text"!==e.nodeName&&"false"===n}),e);return!t&&n},getSelectionHtml:function(e){var t,n,i,o="",a=e.getSelection();if(a.rangeCount){for(i=e.createElement("div"),t=0,n=a.rangeCount;n>t;t+=1)i.appendChild(a.getRangeAt(t).cloneContents());o=i.innerHTML}return o},getCaretOffsets:function(e,t){var n,i;return t||(t=window.getSelection().getRangeAt(0)),n=t.cloneRange(),i=t.cloneRange(),n.selectNodeContents(e),n.setEnd(t.endContainer,t.endOffset),i.selectNodeContents(e),i.setStart(t.endContainer,t.endOffset),{left:n.toString().length,right:i.toString().length}},rangeSelectsSingleNode:function(e){var t=e.startContainer;return t===e.endContainer&&t.hasChildNodes()&&e.endOffset===e.startOffset+1},getSelectedParentElement:function(e){return e?this.rangeSelectsSingleNode(e)&&3!==e.startContainer.childNodes[e.startOffset].nodeType?e.startContainer.childNodes[e.startOffset]:3===e.startContainer.nodeType?e.startContainer.parentNode:e.startContainer:null},getSelectedElements:function(e){var t,n,i,o=e.getSelection();if(!o.rangeCount||o.isCollapsed||!o.getRangeAt(0).commonAncestorContainer)return[];if(3===(t=o.getRangeAt(0)).commonAncestorContainer.nodeType){for(n=[],i=t.commonAncestorContainer;i.parentNode&&1===i.parentNode.childNodes.length;)n.push(i.parentNode),i=i.parentNode;return n}return[].filter.call(t.commonAncestorContainer.getElementsByTagName("*"),(function(e){return"function"!=typeof o.containsNode||o.containsNode(e,!0)}))},selectNode:function(e,t){var n=t.createRange();n.selectNodeContents(e),this.selectRange(t,n)},select:function(e,t,n,i,o){var a=e.createRange();return a.setStart(t,n),i?a.setEnd(i,o):a.collapse(!0),this.selectRange(e,a),a},clearSelection:function(e,t){t?e.getSelection().collapseToStart():e.getSelection().collapseToEnd()},moveCursor:function(e,t,n){this.select(e,t,n)},getSelectionRange:function(e){var t=e.getSelection();return 0===t.rangeCount?null:t.getRangeAt(0)},selectRange:function(e,t){var n=e.getSelection();n.removeAllRanges(),n.addRange(t)},getSelectionStart:function(e){var t=e.getSelection().anchorNode;return t&&3===t.nodeType?t.parentNode:t}};e.selection=n}(),function(){function t(t,n){return!!t&&t.some((function(t){if("function"!=typeof t.getInteractionElements)return!1;var i=t.getInteractionElements();return!!i&&(Array.isArray(i)||(i=[i]),i.some((function(t){return e.util.isDescendant(t,n,!0)})))}))}var n=function(e){this.base=e,this.options=this.base.options,this.events=[],this.disabledEvents={},this.customEvents={},this.listeners={}};n.prototype={InputEventOnContenteditableSupported:!e.util.isIE&&!e.util.isEdge,attachDOMEvent:function(t,n,i,o){var a=this.base.options.contentWindow,r=this.base.options.ownerDocument;t=e.util.isElement(t)||[a,r].indexOf(t)>-1?[t]:t,Array.prototype.forEach.call(t,(function(e){e.addEventListener(n,i,o),this.events.push([e,n,i,o])}).bind(this))},detachDOMEvent:function(t,n,i,o){var a,r,c=this.base.options.contentWindow,s=this.base.options.ownerDocument;t&&(t=e.util.isElement(t)||[c,s].indexOf(t)>-1?[t]:t,Array.prototype.forEach.call(t,(function(e){-1!==(a=this.indexOfListener(e,n,i,o))&&(r=this.events.splice(a,1)[0])[0].removeEventListener(r[1],r[2],r[3])}).bind(this)))},indexOfListener:function(e,t,n,i){var o,a,r;for(o=0,a=this.events.length;a>o;o+=1)if((r=this.events[o])[0]===e&&r[1]===t&&r[2]===n&&r[3]===i)return o;return-1},detachAllDOMEvents:function(){for(var e=this.events.pop();e;)e[0].removeEventListener(e[1],e[2],e[3]),e=this.events.pop()},detachAllEventsFromElement:function(e){for(var t=this.events.filter((function(t){return t&&t[0].getAttribute&&t[0].getAttribute("medium-editor-index")===e.getAttribute("medium-editor-index")})),n=0,i=t.length;i>n;n++){var o=t[n];this.detachDOMEvent(o[0],o[1],o[2],o[3])}},attachAllEventsToElement:function(e){this.listeners.editableInput&&(this.contentCache[e.getAttribute("medium-editor-index")]=e.innerHTML),this.eventsCache&&this.eventsCache.forEach((function(t){this.attachDOMEvent(e,t.name,t.handler.bind(this))}),this)},enableCustomEvent:function(e){void 0!==this.disabledEvents[e]&&delete this.disabledEvents[e]},disableCustomEvent:function(e){this.disabledEvents[e]=!0},attachCustomEvent:function(e,t){this.setupListener(e),this.customEvents[e]||(this.customEvents[e]=[]),this.customEvents[e].push(t)},detachCustomEvent:function(e,t){var n=this.indexOfCustomListener(e,t);-1!==n&&this.customEvents[e].splice(n,1)},indexOfCustomListener:function(e,t){return this.customEvents[e]&&this.customEvents[e].length?this.customEvents[e].indexOf(t):-1},detachAllCustomEvents:function(){this.customEvents={}},triggerCustomEvent:function(e,t,n){this.customEvents[e]&&!this.disabledEvents[e]&&this.customEvents[e].forEach((function(e){e(t,n)}))},destroy:function(){this.detachAllDOMEvents(),this.detachAllCustomEvents(),this.detachExecCommand(),this.base.elements&&this.base.elements.forEach((function(e){e.removeAttribute("data-medium-focused")}))},attachToExecCommand:function(){this.execCommandListener||(this.execCommandListener=(function(e){this.handleDocumentExecCommand(e)}).bind(this),this.wrapExecCommand(),this.options.ownerDocument.execCommand.listeners.push(this.execCommandListener))},detachExecCommand:function(){var e=this.options.ownerDocument;if(this.execCommandListener&&e.execCommand.listeners){var t=e.execCommand.listeners.indexOf(this.execCommandListener);-1!==t&&e.execCommand.listeners.splice(t,1),e.execCommand.listeners.length||this.unwrapExecCommand()}},wrapExecCommand:function(){var e=this.options.ownerDocument;if(!e.execCommand.listeners){var t=function(t,n){e.execCommand.listeners&&e.execCommand.listeners.forEach((function(e){e({command:t[0],value:t[2],args:t,result:n})}))},n=function(){var n=e.execCommand.orig.apply(this,arguments);if(!e.execCommand.listeners)return n;var i=Array.prototype.slice.call(arguments);return t(i,n),n};n.orig=e.execCommand,n.listeners=[],n.callListeners=t,e.execCommand=n}},unwrapExecCommand:function(){var e=this.options.ownerDocument;e.execCommand.orig&&(e.execCommand=e.execCommand.orig)},setupListener:function(e){if(!this.listeners[e]){switch(e){case"externalInteraction":this.attachDOMEvent(this.options.ownerDocument.body,"mousedown",this.handleBodyMousedown.bind(this),!0),this.attachDOMEvent(this.options.ownerDocument.body,"click",this.handleBodyClick.bind(this),!0),this.attachDOMEvent(this.options.ownerDocument.body,"focus",this.handleBodyFocus.bind(this),!0);break;case"blur":case"focus":this.setupListener("externalInteraction");break;case"editableInput":this.contentCache={},this.base.elements.forEach((function(e){this.contentCache[e.getAttribute("medium-editor-index")]=e.innerHTML}),this),this.InputEventOnContenteditableSupported&&this.attachToEachElement("input",this.handleInput),this.InputEventOnContenteditableSupported||(this.setupListener("editableKeypress"),this.keypressUpdateInput=!0,this.attachDOMEvent(document,"selectionchange",this.handleDocumentSelectionChange.bind(this)),this.attachToExecCommand());break;case"editableClick":this.attachToEachElement("click",this.handleClick);break;case"editableBlur":this.attachToEachElement("blur",this.handleBlur);break;case"editableKeypress":this.attachToEachElement("keypress",this.handleKeypress);break;case"editableKeyup":this.attachToEachElement("keyup",this.handleKeyup);break;case"editableKeydown":this.attachToEachElement("keydown",this.handleKeydown);break;case"editableKeydownSpace":case"editableKeydownEnter":case"editableKeydownTab":case"editableKeydownDelete":this.setupListener("editableKeydown");break;case"editableMouseover":this.attachToEachElement("mouseover",this.handleMouseover);break;case"editableDrag":this.attachToEachElement("dragover",this.handleDragging),this.attachToEachElement("dragleave",this.handleDragging);break;case"editableDrop":this.attachToEachElement("drop",this.handleDrop);break;case"editablePaste":this.attachToEachElement("paste",this.handlePaste)}this.listeners[e]=!0}},attachToEachElement:function(e,t){this.eventsCache||(this.eventsCache=[]),this.base.elements.forEach((function(n){this.attachDOMEvent(n,e,t.bind(this))}),this),this.eventsCache.push({name:e,handler:t})},cleanupElement:function(e){var t=e.getAttribute("medium-editor-index");t&&(this.detachAllEventsFromElement(e),this.contentCache&&delete this.contentCache[t])},focusElement:function(e){e.focus(),this.updateFocus(e,{target:e,type:"focus"})},updateFocus:function(n,i){var o,a=this.base.getFocusedElement();a&&"click"===i.type&&this.lastMousedownTarget&&(e.util.isDescendant(a,this.lastMousedownTarget,!0)||t(this.base.extensions,this.lastMousedownTarget))&&(o=a),o||this.base.elements.some((function(t){return!o&&e.util.isDescendant(t,n,!0)&&(o=t),!!o}),this);var r=!e.util.isDescendant(a,n,!0)&&!t(this.base.extensions,n);o!==a&&(a&&r&&(a.removeAttribute("data-medium-focused"),this.triggerCustomEvent("blur",i,a)),o&&(o.setAttribute("data-medium-focused",!0),this.triggerCustomEvent("focus",i,o))),r&&this.triggerCustomEvent("externalInteraction",i)},updateInput:function(e,t){if(this.contentCache){var n=e.getAttribute("medium-editor-index"),i=e.innerHTML;i!==this.contentCache[n]&&this.triggerCustomEvent("editableInput",t,e),this.contentCache[n]=i}},handleDocumentSelectionChange:function(t){if(t.currentTarget&&t.currentTarget.activeElement){var n,i=t.currentTarget.activeElement;this.base.elements.some((function(t){return!!e.util.isDescendant(t,i,!0)&&(n=t,!0)}),this),n&&this.updateInput(n,{target:i,currentTarget:n})}},handleDocumentExecCommand:function(){var e=this.base.getFocusedElement();e&&this.updateInput(e,{target:e,currentTarget:e})},handleBodyClick:function(e){this.updateFocus(e.target,e)},handleBodyFocus:function(e){this.updateFocus(e.target,e)},handleBodyMousedown:function(e){this.lastMousedownTarget=e.target},handleInput:function(e){this.updateInput(e.currentTarget,e)},handleClick:function(e){this.triggerCustomEvent("editableClick",e,e.currentTarget)},handleBlur:function(e){this.triggerCustomEvent("editableBlur",e,e.currentTarget)},handleKeypress:function(e){if(this.triggerCustomEvent("editableKeypress",e,e.currentTarget),this.keypressUpdateInput){var t={target:e.target,currentTarget:e.currentTarget};setTimeout((function(){this.updateInput(t.currentTarget,t)}).bind(this),0)}},handleKeyup:function(e){this.triggerCustomEvent("editableKeyup",e,e.currentTarget)},handleMouseover:function(e){this.triggerCustomEvent("editableMouseover",e,e.currentTarget)},handleDragging:function(e){this.triggerCustomEvent("editableDrag",e,e.currentTarget)},handleDrop:function(e){this.triggerCustomEvent("editableDrop",e,e.currentTarget)},handlePaste:function(e){this.triggerCustomEvent("editablePaste",e,e.currentTarget)},handleKeydown:function(t){return this.triggerCustomEvent("editableKeydown",t,t.currentTarget),e.util.isKey(t,e.util.keyCode.SPACE)?this.triggerCustomEvent("editableKeydownSpace",t,t.currentTarget):e.util.isKey(t,e.util.keyCode.ENTER)||t.ctrlKey&&e.util.isKey(t,e.util.keyCode.M)?this.triggerCustomEvent("editableKeydownEnter",t,t.currentTarget):e.util.isKey(t,e.util.keyCode.TAB)?this.triggerCustomEvent("editableKeydownTab",t,t.currentTarget):e.util.isKey(t,[e.util.keyCode.DELETE,e.util.keyCode.BACKSPACE])?this.triggerCustomEvent("editableKeydownDelete",t,t.currentTarget):void 0}},e.Events=n}(),function(){var t=e.Extension.extend({action:void 0,aria:void 0,tagNames:void 0,style:void 0,useQueryState:void 0,contentDefault:void 0,contentFA:void 0,classList:void 0,attrs:void 0,constructor:function(n){t.isBuiltInButton(n)?e.Extension.call(this,this.defaults[n]):e.Extension.call(this,n)},init:function(){e.Extension.prototype.init.apply(this,arguments),this.button=this.createButton(),this.on(this.button,"click",this.handleClick.bind(this))},getButton:function(){return this.button},getAction:function(){return"function"==typeof this.action?this.action(this.base.options):this.action},getAria:function(){return"function"==typeof this.aria?this.aria(this.base.options):this.aria},getTagNames:function(){return"function"==typeof this.tagNames?this.tagNames(this.base.options):this.tagNames},createButton:function(){var e=this.document.createElement("button"),t=this.contentDefault,n=this.getAria(),i=this.getEditorOption("buttonLabels");return e.classList.add("medium-editor-action"),e.classList.add("medium-editor-action-"+this.name),this.classList&&this.classList.forEach((function(t){e.classList.add(t)})),e.setAttribute("data-action",this.getAction()),n&&(e.setAttribute("title",n),e.setAttribute("aria-label",n)),this.attrs&&Object.keys(this.attrs).forEach((function(t){e.setAttribute(t,this.attrs[t])}),this),"fontawesome"===i&&this.contentFA&&(t=this.contentFA),e.innerHTML=t,e},handleClick:function(e){e.preventDefault(),e.stopPropagation();var t=this.getAction();t&&this.execAction(t)},isActive:function(){return this.button.classList.contains(this.getEditorOption("activeButtonClass"))},setInactive:function(){this.button.classList.remove(this.getEditorOption("activeButtonClass")),delete this.knownState},setActive:function(){this.button.classList.add(this.getEditorOption("activeButtonClass")),delete this.knownState},queryCommandState:function(){var e=null;return this.useQueryState&&(e=this.base.queryCommandState(this.getAction())),e},isAlreadyApplied:function(e){var t,n,i=!1,o=this.getTagNames();return!1===this.knownState||!0===this.knownState?this.knownState:(o&&o.length>0&&(i=-1!==o.indexOf(e.nodeName.toLowerCase())),!i&&this.style&&(t=this.style.value.split("|"),n=this.window.getComputedStyle(e,null).getPropertyValue(this.style.prop),t.forEach((function(e){this.knownState||((i=-1!==n.indexOf(e))||"text-decoration"!==this.style.prop)&&(this.knownState=i)}),this)),i)}});t.isBuiltInButton=function(t){return"string"==typeof t&&e.extensions.button.prototype.defaults.hasOwnProperty(t)},e.extensions.button=t}(),e.extensions.button.prototype.defaults={bold:{name:"bold",action:"bold",aria:"bold",tagNames:["b","strong"],style:{prop:"font-weight",value:"700|bold"},useQueryState:!0,contentDefault:"<b>B</b>",contentFA:'<i class="fa fa-bold"></i>'},italic:{name:"italic",action:"italic",aria:"italic",tagNames:["i","em"],style:{prop:"font-style",value:"italic"},useQueryState:!0,contentDefault:"<b><i>I</i></b>",contentFA:'<i class="fa fa-italic"></i>'},underline:{name:"underline",action:"underline",aria:"underline",tagNames:["u"],style:{prop:"text-decoration",value:"underline"},useQueryState:!0,contentDefault:"<b><u>U</u></b>",contentFA:'<i class="fa fa-underline"></i>'},strikethrough:{name:"strikethrough",action:"strikethrough",aria:"strike through",tagNames:["strike"],style:{prop:"text-decoration",value:"line-through"},useQueryState:!0,contentDefault:"<s>A</s>",contentFA:'<i class="fa fa-strikethrough"></i>'},superscript:{name:"superscript",action:"superscript",aria:"superscript",tagNames:["sup"],contentDefault:"<b>x<sup>1</sup></b>",contentFA:'<i class="fa fa-superscript"></i>'},subscript:{name:"subscript",action:"subscript",aria:"subscript",tagNames:["sub"],contentDefault:"<b>x<sub>1</sub></b>",contentFA:'<i class="fa fa-subscript"></i>'},image:{name:"image",action:"image",aria:"image",tagNames:["img"],contentDefault:"<b>image</b>",contentFA:'<i class="fa fa-picture-o"></i>'},html:{name:"html",action:"html",aria:"evaluate html",tagNames:["iframe","object"],contentDefault:"<b>html</b>",contentFA:'<i class="fa fa-code"></i>'},orderedlist:{name:"orderedlist",action:"insertorderedlist",aria:"ordered list",tagNames:["ol"],useQueryState:!0,contentDefault:"<b>1.</b>",contentFA:'<i class="fa fa-list-ol"></i>'},unorderedlist:{name:"unorderedlist",action:"insertunorderedlist",aria:"unordered list",tagNames:["ul"],useQueryState:!0,contentDefault:"<b>&bull;</b>",contentFA:'<i class="fa fa-list-ul"></i>'},indent:{name:"indent",action:"indent",aria:"indent",tagNames:[],contentDefault:"<b>&rarr;</b>",contentFA:'<i class="fa fa-indent"></i>'},outdent:{name:"outdent",action:"outdent",aria:"outdent",tagNames:[],contentDefault:"<b>&larr;</b>",contentFA:'<i class="fa fa-outdent"></i>'},justifyCenter:{name:"justifyCenter",action:"justifyCenter",aria:"center justify",tagNames:[],style:{prop:"text-align",value:"center"},contentDefault:"<b>C</b>",contentFA:'<i class="fa fa-align-center"></i>'},justifyFull:{name:"justifyFull",action:"justifyFull",aria:"full justify",tagNames:[],style:{prop:"text-align",value:"justify"},contentDefault:"<b>J</b>",contentFA:'<i class="fa fa-align-justify"></i>'},justifyLeft:{name:"justifyLeft",action:"justifyLeft",aria:"left justify",tagNames:[],style:{prop:"text-align",value:"left"},contentDefault:"<b>L</b>",contentFA:'<i class="fa fa-align-left"></i>'},justifyRight:{name:"justifyRight",action:"justifyRight",aria:"right justify",tagNames:[],style:{prop:"text-align",value:"right"},contentDefault:"<b>R</b>",contentFA:'<i class="fa fa-align-right"></i>'},removeFormat:{name:"removeFormat",aria:"remove formatting",action:"removeFormat",contentDefault:"<b>X</b>",contentFA:'<i class="fa fa-eraser"></i>'},quote:{name:"quote",action:"append-blockquote",aria:"blockquote",tagNames:["blockquote"],contentDefault:"<b>&ldquo;</b>",contentFA:'<i class="fa fa-quote-right"></i>'},pre:{name:"pre",action:"append-pre",aria:"preformatted text",tagNames:["pre"],contentDefault:"<b>0101</b>",contentFA:'<i class="fa fa-code fa-lg"></i>'},h1:{name:"h1",action:"append-h1",aria:"header type one",tagNames:["h1"],contentDefault:"<b>H1</b>",contentFA:'<i class="fa fa-header"><sup>1</sup>'},h2:{name:"h2",action:"append-h2",aria:"header type two",tagNames:["h2"],contentDefault:"<b>H2</b>",contentFA:'<i class="fa fa-header"><sup>2</sup>'},h3:{name:"h3",action:"append-h3",aria:"header type three",tagNames:["h3"],contentDefault:"<b>H3</b>",contentFA:'<i class="fa fa-header"><sup>3</sup>'},h4:{name:"h4",action:"append-h4",aria:"header type four",tagNames:["h4"],contentDefault:"<b>H4</b>",contentFA:'<i class="fa fa-header"><sup>4</sup>'},h5:{name:"h5",action:"append-h5",aria:"header type five",tagNames:["h5"],contentDefault:"<b>H5</b>",contentFA:'<i class="fa fa-header"><sup>5</sup>'},h6:{name:"h6",action:"append-h6",aria:"header type six",tagNames:["h6"],contentDefault:"<b>H6</b>",contentFA:'<i class="fa fa-header"><sup>6</sup>'}},function(){var t=e.extensions.button.extend({init:function(){e.extensions.button.prototype.init.apply(this,arguments)},formSaveLabel:"&#10003;",formCloseLabel:"&times;",activeClass:"medium-editor-toolbar-form-active",hasForm:!0,getForm:function(){},isDisplayed:function(){return!!this.hasForm&&this.getForm().classList.contains(this.activeClass)},showForm:function(){this.hasForm&&this.getForm().classList.add(this.activeClass)},hideForm:function(){this.hasForm&&this.getForm().classList.remove(this.activeClass)},showToolbarDefaultActions:function(){var e=this.base.getExtensionByName("toolbar");e&&e.showToolbarDefaultActions()},hideToolbarDefaultActions:function(){var e=this.base.getExtensionByName("toolbar");e&&e.hideToolbarDefaultActions()},setToolbarPosition:function(){var e=this.base.getExtensionByName("toolbar");e&&e.setToolbarPosition()}});e.extensions.form=t}(),function(){var t=e.extensions.form.extend({customClassOption:null,customClassOptionText:"Button",linkValidation:!1,placeholderText:"Paste or type a link",targetCheckbox:!1,targetCheckboxText:"Open in new window",name:"anchor",action:"createLink",aria:"link",tagNames:["a"],contentDefault:"<b>#</b>",contentFA:'<i class="fa fa-link"></i>',init:function(){e.extensions.form.prototype.init.apply(this,arguments),this.subscribe("editableKeydown",this.handleKeydown.bind(this))},handleClick:function(t){t.preventDefault(),t.stopPropagation();var n=e.selection.getSelectionRange(this.document);return"a"===n.startContainer.nodeName.toLowerCase()||"a"===n.endContainer.nodeName.toLowerCase()||e.util.getClosestTag(e.selection.getSelectedParentElement(n),"a")?this.execAction("unlink"):(this.isDisplayed()||this.showForm(),!1)},handleKeydown:function(t){e.util.isKey(t,e.util.keyCode.K)&&e.util.isMetaCtrlKey(t)&&!t.shiftKey&&this.handleClick(t)},getForm:function(){return this.form||(this.form=this.createForm()),this.form},getTemplate:function(){var e=['<input type="text" class="medium-editor-toolbar-input" placeholder="',this.placeholderText,'">'];return e.push('<a href="#" class="medium-editor-toolbar-save">',"fontawesome"===this.getEditorOption("buttonLabels")?'<i class="fa fa-check"></i>':this.formSaveLabel,"</a>"),e.push('<a href="#" class="medium-editor-toolbar-close">',"fontawesome"===this.getEditorOption("buttonLabels")?'<i class="fa fa-times"></i>':this.formCloseLabel,"</a>"),this.targetCheckbox&&e.push('<div class="medium-editor-toolbar-form-row">','<input type="checkbox" class="medium-editor-toolbar-anchor-target" id="medium-editor-toolbar-anchor-target-field-'+this.getEditorId()+'">','<label for="medium-editor-toolbar-anchor-target-field-'+this.getEditorId()+'">',this.targetCheckboxText,"</label>","</div>"),this.customClassOption&&e.push('<div class="medium-editor-toolbar-form-row">','<input type="checkbox" class="medium-editor-toolbar-anchor-button">',"<label>",this.customClassOptionText,"</label>","</div>"),e.join("")},isDisplayed:function(){return e.extensions.form.prototype.isDisplayed.apply(this)},hideForm:function(){e.extensions.form.prototype.hideForm.apply(this),this.getInput().value=""},showForm:function(t){var n=this.getInput(),i=this.getAnchorTargetCheckbox(),o=this.getAnchorButtonCheckbox();if("string"==typeof(t=t||{value:""})&&(t={value:t}),this.base.saveSelection(),this.hideToolbarDefaultActions(),e.extensions.form.prototype.showForm.apply(this),this.setToolbarPosition(),n.value=t.value,n.focus(),i&&(i.checked="_blank"===t.target),o){var a=t.buttonClass?t.buttonClass.split(" "):[];o.checked=-1!==a.indexOf(this.customClassOption)}},destroy:function(){return!!this.form&&(this.form.parentNode&&this.form.parentNode.removeChild(this.form),void delete this.form)},getFormOpts:function(){var e=this.getAnchorTargetCheckbox(),t=this.getAnchorButtonCheckbox(),n={value:this.getInput().value.trim()};return this.linkValidation&&(n.value=this.checkLinkFormat(n.value)),n.target="_self",e&&e.checked&&(n.target="_blank"),t&&t.checked&&(n.buttonClass=this.customClassOption),n},doFormSave:function(){var e=this.getFormOpts();this.completeFormSave(e)},completeFormSave:function(e){this.base.restoreSelection(),this.execAction(this.action,e),this.base.checkSelection()},ensureEncodedUri:function(e){return e===decodeURI(e)?encodeURI(e):e},ensureEncodedUriComponent:function(e){return e===decodeURIComponent(e)?encodeURIComponent(e):e},ensureEncodedParam:function(e){var t=e.split("="),n=t[1];return t[0]+(void 0===n?"":"="+this.ensureEncodedUriComponent(n))},ensureEncodedQuery:function(e){return e.split("&").map(this.ensureEncodedParam.bind(this)).join("&")},checkLinkFormat:function(e){var t=/^([a-z]+:)?\/\/|^(mailto|tel|maps):|^\#/i.test(e),n="",i=e.match(/^(.*?)(?:\?(.*?))?(?:#(.*))?$/),o=i[1],a=i[2],r=i[3];if(/^\+?\s?\(?(?:\d\s?\-?\)?){3,20}$/.test(e))return"tel:"+e;if(!t){var c=o.split("/")[0];(c.match(/.+(\.|:).+/)||"localhost"===c)&&(n="http://")}return n+this.ensureEncodedUri(o)+(void 0===a?"":"?"+this.ensureEncodedQuery(a))+(void 0===r?"":"#"+r)},doFormCancel:function(){this.base.restoreSelection(),this.base.checkSelection()},attachFormEvents:function(e){var t=e.querySelector(".medium-editor-toolbar-close"),n=e.querySelector(".medium-editor-toolbar-save"),i=e.querySelector(".medium-editor-toolbar-input");this.on(e,"click",this.handleFormClick.bind(this)),this.on(i,"keyup",this.handleTextboxKeyup.bind(this)),this.on(t,"click",this.handleCloseClick.bind(this)),this.on(n,"click",this.handleSaveClick.bind(this),!0)},createForm:function(){var e=this.document.createElement("div");return e.className="medium-editor-toolbar-form",e.id="medium-editor-toolbar-form-anchor-"+this.getEditorId(),e.innerHTML=this.getTemplate(),this.attachFormEvents(e),e},getInput:function(){return this.getForm().querySelector("input.medium-editor-toolbar-input")},getAnchorTargetCheckbox:function(){return this.getForm().querySelector(".medium-editor-toolbar-anchor-target")},getAnchorButtonCheckbox:function(){return this.getForm().querySelector(".medium-editor-toolbar-anchor-button")},handleTextboxKeyup:function(t){return t.keyCode===e.util.keyCode.ENTER?(t.preventDefault(),void this.doFormSave()):void(t.keyCode===e.util.keyCode.ESCAPE&&(t.preventDefault(),this.doFormCancel()))},handleFormClick:function(e){e.stopPropagation()},handleSaveClick:function(e){e.preventDefault(),this.doFormSave()},handleCloseClick:function(e){e.preventDefault(),this.doFormCancel()}});e.extensions.anchor=t}(),function(){var t=e.Extension.extend({name:"anchor-preview",hideDelay:500,previewValueSelector:"a",showWhenToolbarIsVisible:!1,showOnEmptyLinks:!0,init:function(){this.anchorPreview=this.createPreview(),this.getEditorOption("elementsContainer").appendChild(this.anchorPreview),this.attachToEditables()},getInteractionElements:function(){return this.getPreviewElement()},getPreviewElement:function(){return this.anchorPreview},createPreview:function(){var e=this.document.createElement("div");return e.id="medium-editor-anchor-preview-"+this.getEditorId(),e.className="medium-editor-anchor-preview",e.innerHTML=this.getTemplate(),this.on(e,"click",this.handleClick.bind(this)),e},getTemplate:function(){return'<div class="medium-editor-toolbar-anchor-preview" id="medium-editor-toolbar-anchor-preview">    <a class="medium-editor-toolbar-anchor-preview-inner"></a></div>'},destroy:function(){this.anchorPreview&&(this.anchorPreview.parentNode&&this.anchorPreview.parentNode.removeChild(this.anchorPreview),delete this.anchorPreview)},hidePreview:function(){this.anchorPreview&&this.anchorPreview.classList.remove("medium-editor-anchor-preview-active"),this.activeAnchor=null},showPreview:function(e){return!(!this.anchorPreview.classList.contains("medium-editor-anchor-preview-active")&&!e.getAttribute("data-disable-preview"))||(this.previewValueSelector&&(this.anchorPreview.querySelector(this.previewValueSelector).textContent=e.attributes.href.value,this.anchorPreview.querySelector(this.previewValueSelector).href=e.attributes.href.value),this.anchorPreview.classList.add("medium-toolbar-arrow-over"),this.anchorPreview.classList.remove("medium-toolbar-arrow-under"),this.anchorPreview.classList.contains("medium-editor-anchor-preview-active")||this.anchorPreview.classList.add("medium-editor-anchor-preview-active"),this.activeAnchor=e,this.positionPreview(),this.attachPreviewHandlers(),this)},positionPreview:function(e){var t,n,i,o,a,r=this.window.innerWidth,c=this.anchorPreview.offsetHeight,s=(e=e||this.activeAnchor).getBoundingClientRect(),l=this.diffLeft,p=this.diffTop,u=this.getEditorOption("elementsContainer"),d=["absolute","fixed"].indexOf(window.getComputedStyle(u).getPropertyValue("position"))>-1,m={};t=this.anchorPreview.offsetWidth/2;var h=this.base.getExtensionByName("toolbar");h&&(l=h.diffLeft,p=h.diffTop),n=l-t,d?(o=u.getBoundingClientRect(),["top","left"].forEach((function(e){m[e]=s[e]-o[e]})),m.width=s.width,m.height=s.height,s=m,r=o.width,a=u.scrollTop):a=this.window.pageYOffset,i=s.left+s.width/2,a+=c+s.top+s.height-p-this.anchorPreview.offsetHeight,this.anchorPreview.style.top=Math.round(a)+"px",this.anchorPreview.style.right="initial",t>i?(this.anchorPreview.style.left=n+t+"px",this.anchorPreview.style.right="initial"):t>r-i?(this.anchorPreview.style.left="auto",this.anchorPreview.style.right=0):(this.anchorPreview.style.left=n+i+"px",this.anchorPreview.style.right="initial")},attachToEditables:function(){this.subscribe("editableMouseover",this.handleEditableMouseover.bind(this)),this.subscribe("positionedToolbar",this.handlePositionedToolbar.bind(this))},handlePositionedToolbar:function(){this.showWhenToolbarIsVisible||this.hidePreview()},handleClick:function(e){var t=this.base.getExtensionByName("anchor"),n=this.activeAnchor;t&&n&&(e.preventDefault(),this.base.selectElement(this.activeAnchor),this.base.delay((function(){if(n){var e={value:n.attributes.href.value,target:n.getAttribute("target"),buttonClass:n.getAttribute("class")};t.showForm(e),n=null}}).bind(this))),this.hidePreview()},handleAnchorMouseout:function(){this.anchorToPreview=null,this.off(this.activeAnchor,"mouseout",this.instanceHandleAnchorMouseout),this.instanceHandleAnchorMouseout=null},handleEditableMouseover:function(t){var n=e.util.getClosestTag(t.target,"a");if(!1!==n){if(!this.showOnEmptyLinks&&(!/href=["']\S+["']/.test(n.outerHTML)||/href=["']#\S+["']/.test(n.outerHTML)))return!0;var i=this.base.getExtensionByName("toolbar");if(!this.showWhenToolbarIsVisible&&i&&i.isDisplayed&&i.isDisplayed())return!0;this.activeAnchor&&this.activeAnchor!==n&&this.detachPreviewHandlers(),this.anchorToPreview=n,this.instanceHandleAnchorMouseout=this.handleAnchorMouseout.bind(this),this.on(this.anchorToPreview,"mouseout",this.instanceHandleAnchorMouseout),this.base.delay((function(){this.anchorToPreview&&this.showPreview(this.anchorToPreview)}).bind(this))}},handlePreviewMouseover:function(){this.lastOver=(new Date).getTime(),this.hovering=!0},handlePreviewMouseout:function(e){e.relatedTarget&&/anchor-preview/.test(e.relatedTarget.className)||(this.hovering=!1)},updatePreview:function(){if(this.hovering)return!0;(new Date).getTime()-this.lastOver>this.hideDelay&&this.detachPreviewHandlers()},detachPreviewHandlers:function(){clearInterval(this.intervalTimer),this.instanceHandlePreviewMouseover&&(this.off(this.anchorPreview,"mouseover",this.instanceHandlePreviewMouseover),this.off(this.anchorPreview,"mouseout",this.instanceHandlePreviewMouseout),this.activeAnchor&&(this.off(this.activeAnchor,"mouseover",this.instanceHandlePreviewMouseover),this.off(this.activeAnchor,"mouseout",this.instanceHandlePreviewMouseout))),this.hidePreview(),this.hovering=this.instanceHandlePreviewMouseover=this.instanceHandlePreviewMouseout=null},attachPreviewHandlers:function(){this.lastOver=(new Date).getTime(),this.hovering=!0,this.instanceHandlePreviewMouseover=this.handlePreviewMouseover.bind(this),this.instanceHandlePreviewMouseout=this.handlePreviewMouseout.bind(this),this.intervalTimer=setInterval(this.updatePreview.bind(this),200),this.on(this.anchorPreview,"mouseover",this.instanceHandlePreviewMouseover),this.on(this.anchorPreview,"mouseout",this.instanceHandlePreviewMouseout),this.on(this.activeAnchor,"mouseover",this.instanceHandlePreviewMouseover),this.on(this.activeAnchor,"mouseout",this.instanceHandlePreviewMouseout)}});e.extensions.anchorPreview=t}(),function(){function t(t){return!e.util.getClosestTag(t,"a")}var n,i,o;n=[" ","\t","\n","\r","\xa0","\u2000","\u2001","\u2002","\u2003","\u2028","\u2029"],i=new RegExp("^(com|net|org|edu|gov|mil|aero|asia|biz|cat|coop|info|int|jobs|mobi|museum|name|post|pro|tel|travel|xxx|ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cs|cu|cv|cx|cy|cz|dd|de|dj|dk|dm|do|dz|ec|ee|eg|eh|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|ja|sk|sl|sm|sn|so|sr|ss|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|yu|za|zm|zw)$","i"),o=new RegExp("(((?:(https?://|ftps?://|nntp://)|www\\d{0,3}[.]|[a-z0-9.\\-]+[.](com|net|org|edu|gov|mil|aero|asia|biz|cat|coop|info|int|jobs|mobi|museum|name|post|pro|tel|travel|xxx|ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cs|cu|cv|cx|cy|cz|dd|de|dj|dk|dm|do|dz|ec|ee|eg|eh|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|ja|sk|sl|sm|sn|so|sr|ss|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|yu|za|zm|zw)\\/)\\S+(?:[^\\s`!\\[\\]{};:'\".,?\xab\xbb\u201c\u201d\u2018\u2019])))|(([a-z0-9\\-]+\\.)?[a-z0-9\\-]+\\.(com|net|org|edu|gov|mil|aero|asia|biz|cat|coop|info|int|jobs|mobi|museum|name|post|pro|tel|travel|xxx|ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cs|cu|cv|cx|cy|cz|dd|de|dj|dk|dm|do|dz|ec|ee|eg|eh|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|ja|sk|sl|sm|sn|so|sr|ss|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|yu|za|zm|zw))","gi");var a=e.Extension.extend({init:function(){e.Extension.prototype.init.apply(this,arguments),this.disableEventHandling=!1,this.subscribe("editableKeypress",this.onKeypress.bind(this)),this.subscribe("editableBlur",this.onBlur.bind(this)),this.document.execCommand("AutoUrlDetect",!1,!1)},isLastInstance:function(){for(var e=0,t=0;t<this.window._mediumEditors.length;t++){var n=this.window._mediumEditors[t];null!==n&&void 0!==n.getExtensionByName("autoLink")&&e++}return 1===e},destroy:function(){this.document.queryCommandSupported("AutoUrlDetect")&&this.isLastInstance()&&this.document.execCommand("AutoUrlDetect",!1,!0)},onBlur:function(e,t){this.performLinking(t)},onKeypress:function(t){this.disableEventHandling||e.util.isKey(t,[e.util.keyCode.SPACE,e.util.keyCode.ENTER])&&(clearTimeout(this.performLinkingTimeout),this.performLinkingTimeout=setTimeout((function(){try{var e=this.base.exportSelection();this.performLinking(t.target)&&this.base.importSelection(e,!0)}catch(n){window.console&&window.console.error("Failed to perform linking",n),this.disableEventHandling=!0}}).bind(this),0))},performLinking:function(t){var n=e.util.splitByBlockElements(t),i=!1;0===n.length&&(n=[t]);for(var o=0;o<n.length;o++)i=this.removeObsoleteAutoLinkSpans(n[o])||i,i=this.performLinkingWithinElement(n[o])||i;return this.base.events.updateInput(t,{target:t,currentTarget:t}),i},removeObsoleteAutoLinkSpans:function(n){if(!n||3===n.nodeType)return!1;for(var i=n.querySelectorAll('span[data-auto-link="true"]'),o=!1,a=0;a<i.length;a++){var r=i[a].textContent;if(-1===r.indexOf("://")&&(r=e.util.ensureUrlHasProtocol(r)),i[a].getAttribute("data-href")!==r&&t(i[a])){o=!0;var c=r.replace(/\s+$/,"");if(i[a].getAttribute("data-href")===c){var s=e.util.splitOffDOMTree(i[a],this.splitTextBeforeEnd(i[a],r.length-c.length));i[a].parentNode.insertBefore(s,i[a].nextSibling)}else e.util.unwrap(i[a],this.document)}}return o},splitTextBeforeEnd:function(e,t){for(var n=this.document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null,!1),i=!0;i;)i=null!==n.lastChild();for(var o,a,r;t>0&&null!==r;)(a=(o=n.currentNode).nodeValue).length>t?(r=o.splitText(a.length-t),t=0):(r=n.previousNode(),t-=a.length);return r},performLinkingWithinElement:function(t){for(var n=this.findLinkableText(t),i=0;i<n.length;i++){var o=e.util.findOrCreateMatchingTextNodes(this.document,t,n[i]);this.shouldNotLink(o)||this.createAutoLink(o,n[i].href)}return!1},shouldNotLink:function(t){for(var n=!1,i=0;i<t.length&&!1===n;i++)n=!!e.util.traverseUp(t[i],(function(e){return"a"===e.nodeName.toLowerCase()||e.getAttribute&&"true"===e.getAttribute("data-auto-link")}));return n},findLinkableText:function(e){for(var t=e.textContent,a=null,r=[];null!==(a=o.exec(t));){var c=a.index+a[0].length;!(0!==a.index&&-1===n.indexOf(t[a.index-1])||c!==t.length&&-1===n.indexOf(t[c]))&&(-1!==a[0].indexOf("/")||i.test(a[0].split(".").pop().split("?").shift()))&&r.push({href:a[0],start:a.index,end:c})}return r},createAutoLink:function(t,n){n=e.util.ensureUrlHasProtocol(n);var i=e.util.createLink(this.document,t,n,this.getEditorOption("targetBlank")?"_blank":null),o=this.document.createElement("span");for(o.setAttribute("data-auto-link","true"),o.setAttribute("data-href",n),i.insertBefore(o,i.firstChild);i.childNodes.length>1;)o.appendChild(i.childNodes[1])}});e.extensions.autoLink=a}(),function(){function t(t){var i=e.util.getContainerEditorElement(t);Array.prototype.slice.call(i.parentElement.querySelectorAll("."+n)).forEach((function(e){e.classList.remove(n)}))}var n="medium-editor-dragover",i=e.Extension.extend({name:"fileDragging",allowedTypes:["image"],init:function(){e.Extension.prototype.init.apply(this,arguments),this.subscribe("editableDrag",this.handleDrag.bind(this)),this.subscribe("editableDrop",this.handleDrop.bind(this))},handleDrag:function(e){e.preventDefault(),e.dataTransfer.dropEffect="copy";var i=e.target.classList?e.target:e.target.parentElement;t(i),"dragover"===e.type&&i.classList.add(n)},handleDrop:function(e){e.preventDefault(),e.stopPropagation(),this.base.selectElement(e.target);var n=this.base.exportSelection();n.start=n.end,this.base.importSelection(n),e.dataTransfer.files&&Array.prototype.slice.call(e.dataTransfer.files).forEach((function(e){this.isAllowedFile(e)&&e.type.match("image")&&this.insertImageFile(e)}),this),t(e.target)},isAllowedFile:function(e){return this.allowedTypes.some((function(t){return!!e.type.match(t)}))},insertImageFile:function(t){if("function"==typeof FileReader){var n=new FileReader;n.readAsDataURL(t),n.addEventListener("load",(function(t){var n=this.document.createElement("img");n.src=t.target.result,e.util.insertHTMLCommand(this.document,n.outerHTML)}).bind(this))}}});e.extensions.fileDragging=i}(),function(){var t=e.Extension.extend({name:"keyboard-commands",commands:[{command:"bold",key:"B",meta:!0,shift:!1,alt:!1},{command:"italic",key:"I",meta:!0,shift:!1,alt:!1},{command:"underline",key:"U",meta:!0,shift:!1,alt:!1}],init:function(){e.Extension.prototype.init.apply(this,arguments),this.subscribe("editableKeydown",this.handleKeydown.bind(this)),this.keys={},this.commands.forEach((function(e){var t=e.key.charCodeAt(0);this.keys[t]||(this.keys[t]=[]),this.keys[t].push(e)}),this)},handleKeydown:function(t){var n=e.util.getKeyCode(t);if(this.keys[n]){var i=e.util.isMetaCtrlKey(t),o=!!t.shiftKey,a=!!t.altKey;this.keys[n].forEach((function(e){e.meta!==i||e.shift!==o||e.alt!==a&&void 0!==e.alt||(t.preventDefault(),t.stopPropagation(),"function"==typeof e.command?e.command.apply(this):!1!==e.command&&this.execAction(e.command))}),this)}}});e.extensions.keyboardCommands=t}(),function(){var t=e.extensions.form.extend({name:"fontname",action:"fontName",aria:"change font name",contentDefault:"&#xB1;",contentFA:'<i class="fa fa-font"></i>',fonts:["","Arial","Verdana","Times New Roman"],init:function(){e.extensions.form.prototype.init.apply(this,arguments)},handleClick:function(e){if(e.preventDefault(),e.stopPropagation(),!this.isDisplayed()){var t=this.document.queryCommandValue("fontName")+"";this.showForm(t)}return!1},getForm:function(){return this.form||(this.form=this.createForm()),this.form},isDisplayed:function(){return"block"===this.getForm().style.display},hideForm:function(){this.getForm().style.display="none",this.getSelect().value=""},showForm:function(e){var t=this.getSelect();this.base.saveSelection(),this.hideToolbarDefaultActions(),this.getForm().style.display="block",this.setToolbarPosition(),t.value=e||"",t.focus()},destroy:function(){return!!this.form&&(this.form.parentNode&&this.form.parentNode.removeChild(this.form),void delete this.form)},doFormSave:function(){this.base.restoreSelection(),this.base.checkSelection()},doFormCancel:function(){this.base.restoreSelection(),this.clearFontName(),this.base.checkSelection()},createForm:function(){var e,t=this.document,n=t.createElement("div"),i=t.createElement("select"),o=t.createElement("a"),a=t.createElement("a");n.className="medium-editor-toolbar-form",n.id="medium-editor-toolbar-form-fontname-"+this.getEditorId(),this.on(n,"click",this.handleFormClick.bind(this));for(var r=0;r<this.fonts.length;r++)(e=t.createElement("option")).innerHTML=this.fonts[r],e.value=this.fonts[r],i.appendChild(e);return i.className="medium-editor-toolbar-select",n.appendChild(i),this.on(i,"change",this.handleFontChange.bind(this)),a.setAttribute("href","#"),a.className="medium-editor-toobar-save",a.innerHTML="fontawesome"===this.getEditorOption("buttonLabels")?'<i class="fa fa-check"></i>':"&#10003;",n.appendChild(a),this.on(a,"click",this.handleSaveClick.bind(this),!0),o.setAttribute("href","#"),o.className="medium-editor-toobar-close",o.innerHTML="fontawesome"===this.getEditorOption("buttonLabels")?'<i class="fa fa-times"></i>':"&times;",n.appendChild(o),this.on(o,"click",this.handleCloseClick.bind(this)),n},getSelect:function(){return this.getForm().querySelector("select.medium-editor-toolbar-select")},clearFontName:function(){e.selection.getSelectedElements(this.document).forEach((function(e){"font"===e.nodeName.toLowerCase()&&e.hasAttribute("face")&&e.removeAttribute("face")}))},handleFontChange:function(){var e=this.getSelect().value;""===e?this.clearFontName():this.execAction("fontName",{value:e})},handleFormClick:function(e){e.stopPropagation()},handleSaveClick:function(e){e.preventDefault(),this.doFormSave()},handleCloseClick:function(e){e.preventDefault(),this.doFormCancel()}});e.extensions.fontName=t}(),function(){var t=e.extensions.form.extend({name:"fontsize",action:"fontSize",aria:"increase/decrease font size",contentDefault:"&#xB1;",contentFA:'<i class="fa fa-text-height"></i>',init:function(){e.extensions.form.prototype.init.apply(this,arguments)},handleClick:function(e){if(e.preventDefault(),e.stopPropagation(),!this.isDisplayed()){var t=this.document.queryCommandValue("fontSize")+"";this.showForm(t)}return!1},getForm:function(){return this.form||(this.form=this.createForm()),this.form},isDisplayed:function(){return"block"===this.getForm().style.display},hideForm:function(){this.getForm().style.display="none",this.getInput().value=""},showForm:function(e){var t=this.getInput();this.base.saveSelection(),this.hideToolbarDefaultActions(),this.getForm().style.display="block",this.setToolbarPosition(),t.value=e||"",t.focus()},destroy:function(){return!!this.form&&(this.form.parentNode&&this.form.parentNode.removeChild(this.form),void delete this.form)},doFormSave:function(){this.base.restoreSelection(),this.base.checkSelection()},doFormCancel:function(){this.base.restoreSelection(),this.clearFontSize(),this.base.checkSelection()},createForm:function(){var e=this.document,t=e.createElement("div"),n=e.createElement("input"),i=e.createElement("a"),o=e.createElement("a");return t.className="medium-editor-toolbar-form",t.id="medium-editor-toolbar-form-fontsize-"+this.getEditorId(),this.on(t,"click",this.handleFormClick.bind(this)),n.setAttribute("type","range"),n.setAttribute("min","1"),n.setAttribute("max","7"),n.className="medium-editor-toolbar-input",t.appendChild(n),this.on(n,"change",this.handleSliderChange.bind(this)),o.setAttribute("href","#"),o.className="medium-editor-toobar-save",o.innerHTML="fontawesome"===this.getEditorOption("buttonLabels")?'<i class="fa fa-check"></i>':"&#10003;",t.appendChild(o),this.on(o,"click",this.handleSaveClick.bind(this),!0),i.setAttribute("href","#"),i.className="medium-editor-toobar-close",i.innerHTML="fontawesome"===this.getEditorOption("buttonLabels")?'<i class="fa fa-times"></i>':"&times;",t.appendChild(i),this.on(i,"click",this.handleCloseClick.bind(this)),t},getInput:function(){return this.getForm().querySelector("input.medium-editor-toolbar-input")},clearFontSize:function(){e.selection.getSelectedElements(this.document).forEach((function(e){"font"===e.nodeName.toLowerCase()&&e.hasAttribute("size")&&e.removeAttribute("size")}))},handleSliderChange:function(){var e=this.getInput().value;"4"===e?this.clearFontSize():this.execAction("fontSize",{value:e})},handleFormClick:function(e){e.stopPropagation()},handleSaveClick:function(e){e.preventDefault(),this.doFormSave()},handleCloseClick:function(e){e.preventDefault(),this.doFormCancel()}});e.extensions.fontSize=t}(),function(){function t(e,t,n){var i=e.clipboardData||t.clipboardData||n.dataTransfer,o={};if(!i)return o;if(i.getData){var a=i.getData("Text");a&&a.length>0&&(o["text/plain"]=a)}if(i.types)for(var r=0;r<i.types.length;r++){var c=i.types[r];o[c]=i.getData(c)}return o}var n="%ME_PASTEBIN%",i=null,o=null,a=function(e){e.stopPropagation()},r=e.Extension.extend({forcePlainText:!0,cleanPastedHTML:!1,preCleanReplacements:[],cleanReplacements:[],cleanAttrs:["class","style","dir"],cleanTags:["meta"],unwrapTags:[],init:function(){e.Extension.prototype.init.apply(this,arguments),(this.forcePlainText||this.cleanPastedHTML)&&(this.subscribe("editableKeydown",this.handleKeydown.bind(this)),this.getEditorElements().forEach((function(e){this.on(e,"paste",this.handlePaste.bind(this))}),this),this.subscribe("addElement",this.handleAddElement.bind(this)))},handleAddElement:function(e,t){this.on(t,"paste",this.handlePaste.bind(this))},destroy:function(){(this.forcePlainText||this.cleanPastedHTML)&&this.removePasteBin()},handlePaste:function(e,n){if(!e.defaultPrevented){var i=t(e,this.window,this.document),o=i["text/html"],a=i["text/plain"];this.window.clipboardData&&void 0===e.clipboardData&&!o&&(o=a),(o||a)&&(e.preventDefault(),this.doPaste(o,a,n))}},doPaste:function(t,n,i){var o,a,r="";if(this.cleanPastedHTML&&t)return this.cleanPaste(t);if(n){if(this.getEditorOption("disableReturn")||i&&i.getAttribute("data-disable-return"))r=e.util.htmlEntities(n);else if((o=n.split(/[\r\n]+/g)).length>1)for(a=0;a<o.length;a+=1)""!==o[a]&&(r+="<p>"+e.util.htmlEntities(o[a])+"</p>");else r=e.util.htmlEntities(o[0]);e.util.insertHTMLCommand(this.document,r)}},handlePasteBinPaste:function(e){if(!e.defaultPrevented){var n=t(e,this.window,this.document),i=n["text/html"],a=n["text/plain"],r=o;return!this.cleanPastedHTML||i?(e.preventDefault(),this.removePasteBin(),this.doPaste(i,a,r),void this.trigger("editablePaste",{currentTarget:r,target:r},r)):void setTimeout((function(){this.cleanPastedHTML&&(i=this.getPasteBinHtml()),this.removePasteBin(),this.doPaste(i,a,r),this.trigger("editablePaste",{currentTarget:r,target:r},r)}).bind(this),0)}this.removePasteBin()},handleKeydown:function(t,n){e.util.isKey(t,e.util.keyCode.V)&&e.util.isMetaCtrlKey(t)&&(t.stopImmediatePropagation(),this.removePasteBin(),this.createPasteBin(n))},createPasteBin:function(t){var r,c=e.selection.getSelectionRange(this.document),s=this.window.pageYOffset;o=t,c&&(s+=(r=c.getClientRects()).length?r[0].top:void 0!==c.startContainer.getBoundingClientRect?c.startContainer.getBoundingClientRect().top:c.getBoundingClientRect().top),i=c;var l=this.document.createElement("div");l.id=this.pasteBinId="medium-editor-pastebin-"+ +Date.now(),l.setAttribute("style","border: 1px red solid; position: absolute; top: "+s+"px; width: 10px; height: 10px; overflow: hidden; opacity: 0"),l.setAttribute("contentEditable",!0),l.innerHTML=n,this.document.body.appendChild(l),this.on(l,"focus",a),this.on(l,"focusin",a),this.on(l,"focusout",a),l.focus(),e.selection.selectNode(l,this.document),this.boundHandlePaste||(this.boundHandlePaste=this.handlePasteBinPaste.bind(this)),this.on(l,"paste",this.boundHandlePaste)},removePasteBin:function(){null!==i&&(e.selection.selectRange(this.document,i),i=null),null!==o&&(o=null);var t=this.getPasteBin();t&&t&&(this.off(t,"focus",a),this.off(t,"focusin",a),this.off(t,"focusout",a),this.off(t,"paste",this.boundHandlePaste),t.parentElement.removeChild(t))},getPasteBin:function(){return this.document.getElementById(this.pasteBinId)},getPasteBinHtml:function(){var e=this.getPasteBin();if(!e)return!1;if(e.firstChild&&"mcepastebin"===e.firstChild.id)return!1;var t=e.innerHTML;return!(!t||t===n)&&t},cleanPaste:function(e){var t,n,i,o,a=/<p|<br|<div/.test(e),r=[].concat(this.preCleanReplacements||[],[[new RegExp(/^[\s\S]*<body[^>]*>\s*|\s*<\/body[^>]*>[\s\S]*$/g),""],[new RegExp(/<!--StartFragment-->|<!--EndFragment-->/g),""],[new RegExp(/<br>$/i),""],[new RegExp(/<[^>]*docs-internal-guid[^>]*>/gi),""],[new RegExp(/<\/b>(<br[^>]*>)?$/gi),""],[new RegExp(/<span class="Apple-converted-space">\s+<\/span>/g)," "],[new RegExp(/<br class="Apple-interchange-newline">/g),"<br>"],[new RegExp(/<span[^>]*(font-style:italic;font-weight:(bold|700)|font-weight:(bold|700);font-style:italic)[^>]*>/gi),'<span class="replace-with italic bold">'],[new RegExp(/<span[^>]*font-style:italic[^>]*>/gi),'<span class="replace-with italic">'],[new RegExp(/<span[^>]*font-weight:(bold|700)[^>]*>/gi),'<span class="replace-with bold">'],[new RegExp(/&lt;(\/?)(i|b|a)&gt;/gi),"<$1$2>"],[new RegExp(/&lt;a(?:(?!href).)+href=(?:&quot;|&rdquo;|&ldquo;|"|\u201c|\u201d)(((?!&quot;|&rdquo;|&ldquo;|"|\u201c|\u201d).)*)(?:&quot;|&rdquo;|&ldquo;|"|\u201c|\u201d)(?:(?!&gt;).)*&gt;/gi),'<a href="$1">'],[new RegExp(/<\/p>\n+/gi),"</p>"],[new RegExp(/\n+<p/gi),"<p"],[new RegExp(/<\/?o:[a-z]*>/gi),""],[new RegExp(/<!\[if !supportLists\]>(((?!<!).)*)<!\[endif]\>/gi),"$1"]],this.cleanReplacements||[]);for(t=0;t<r.length;t+=1)e=e.replace(r[t][0],r[t][1]);if(!a)return this.pasteHTML(e);for((i=this.document.createElement("div")).innerHTML="<p>"+e.split("<br><br>").join("</p><p>")+"</p>",n=i.querySelectorAll("a,p,div,br"),t=0;t<n.length;t+=1)switch((o=n[t]).innerHTML=o.innerHTML.replace(/\n/gi," "),o.nodeName.toLowerCase()){case"p":case"div":this.filterCommonBlocks(o);break;case"br":this.filterLineBreak(o)}this.pasteHTML(i.innerHTML)},pasteHTML:function(t,n){n=e.util.defaults({},n,{cleanAttrs:this.cleanAttrs,cleanTags:this.cleanTags,unwrapTags:this.unwrapTags});var i,o,a,r,c=this.document.createDocumentFragment();for(c.appendChild(this.document.createElement("body")),(r=c.querySelector("body")).innerHTML=t,this.cleanupSpans(r),i=r.querySelectorAll("*"),a=0;a<i.length;a+=1)"a"===(o=i[a]).nodeName.toLowerCase()&&this.getEditorOption("targetBlank")&&e.util.setTargetBlank(o),e.util.cleanupAttrs(o,n.cleanAttrs),e.util.cleanupTags(o,n.cleanTags),e.util.unwrapTags(o,n.unwrapTags);e.util.insertHTMLCommand(this.document,r.innerHTML.replace(/&nbsp;/g," "))},isCommonBlock:function(e){return e&&("p"===e.nodeName.toLowerCase()||"div"===e.nodeName.toLowerCase())},filterCommonBlocks:function(e){/^\s*$/.test(e.textContent)&&e.parentNode&&e.parentNode.removeChild(e)},filterLineBreak:function(e){this.isCommonBlock(e.previousElementSibling)?this.removeWithParent(e):!this.isCommonBlock(e.parentNode)||e.parentNode.firstChild!==e&&e.parentNode.lastChild!==e?e.parentNode&&1===e.parentNode.childElementCount&&""===e.parentNode.textContent&&this.removeWithParent(e):this.removeWithParent(e)},removeWithParent:function(e){e&&e.parentNode&&(e.parentNode.parentNode&&1===e.parentNode.childElementCount?e.parentNode.parentNode.removeChild(e.parentNode):e.parentNode.removeChild(e))},cleanupSpans:function(t){var n,i,o,a=t.querySelectorAll(".replace-with"),r=function(e){return e&&"#text"!==e.nodeName&&"false"===e.getAttribute("contenteditable")};for(n=0;n<a.length;n+=1)(o=this.document.createElement((i=a[n]).classList.contains("bold")?"b":"i")).innerHTML=i.classList.contains("bold")&&i.classList.contains("italic")?"<i>"+i.innerHTML+"</i>":i.innerHTML,i.parentNode.replaceChild(o,i);for(a=t.querySelectorAll("span"),n=0;n<a.length;n+=1){if(e.util.traverseUp(i=a[n],r))return!1;e.util.unwrap(i,this.document)}}});e.extensions.paste=r}(),function(){var t=e.Extension.extend({name:"placeholder",text:"Type your text",hideOnClick:!0,init:function(){e.Extension.prototype.init.apply(this,arguments),this.initPlaceholders(),this.attachEventHandlers()},initPlaceholders:function(){this.getEditorElements().forEach(this.initElement,this)},handleAddElement:function(e,t){this.initElement(t)},initElement:function(e){e.getAttribute("data-placeholder")||e.setAttribute("data-placeholder",this.text),this.updatePlaceholder(e)},destroy:function(){this.getEditorElements().forEach(this.cleanupElement,this)},handleRemoveElement:function(e,t){this.cleanupElement(t)},cleanupElement:function(e){e.getAttribute("data-placeholder")===this.text&&e.removeAttribute("data-placeholder")},showPlaceholder:function(t){t&&(e.util.isFF&&0===t.childNodes.length?(t.classList.add("medium-editor-placeholder-relative"),t.classList.remove("medium-editor-placeholder")):(t.classList.add("medium-editor-placeholder"),t.classList.remove("medium-editor-placeholder-relative")))},hidePlaceholder:function(e){e&&(e.classList.remove("medium-editor-placeholder"),e.classList.remove("medium-editor-placeholder-relative"))},updatePlaceholder:function(e,t){return e.querySelector("img, blockquote, ul, ol, table")||""!==e.textContent.replace(/^\s+|\s+$/g,"")?this.hidePlaceholder(e):void(t||this.showPlaceholder(e))},attachEventHandlers:function(){this.hideOnClick&&this.subscribe("focus",this.handleFocus.bind(this)),this.subscribe("editableInput",this.handleInput.bind(this)),this.subscribe("blur",this.handleBlur.bind(this)),this.subscribe("addElement",this.handleAddElement.bind(this)),this.subscribe("removeElement",this.handleRemoveElement.bind(this))},handleInput:function(e,t){var n=this.hideOnClick&&t===this.base.getFocusedElement();this.updatePlaceholder(t,n)},handleFocus:function(e,t){this.hidePlaceholder(t)},handleBlur:function(e,t){this.updatePlaceholder(t)}});e.extensions.placeholder=t}(),function(){var t=e.Extension.extend({name:"toolbar",align:"center",allowMultiParagraphSelection:!0,buttons:["bold","italic","underline","anchor","h2","h3","quote"],diffLeft:0,diffTop:-10,firstButtonClass:"medium-editor-button-first",lastButtonClass:"medium-editor-button-last",standardizeSelectionStart:!1,static:!1,sticky:!1,stickyTopOffset:0,updateOnEmptySelection:!1,relativeContainer:null,init:function(){e.Extension.prototype.init.apply(this,arguments),this.initThrottledMethods(),this.relativeContainer?this.relativeContainer.appendChild(this.getToolbarElement()):this.getEditorOption("elementsContainer").appendChild(this.getToolbarElement())},forEachExtension:function(e,t){return this.base.extensions.forEach((function(n){return n!==this?e.apply(t||this,arguments):void 0}),this)},createToolbar:function(){var e=this.document.createElement("div");return e.id="medium-editor-toolbar-"+this.getEditorId(),e.className="medium-editor-toolbar",e.className+=this.static?" static-toolbar":this.relativeContainer?" medium-editor-relative-toolbar":" medium-editor-stalker-toolbar",e.appendChild(this.createToolbarButtons()),this.forEachExtension((function(t){t.hasForm&&e.appendChild(t.getForm())})),this.attachEventHandlers(),e},createToolbarButtons:function(){var t,n,i,o,a,r,c=this.document.createElement("ul");return c.id="medium-editor-toolbar-actions"+this.getEditorId(),c.className="medium-editor-toolbar-actions",c.style.display="block",this.buttons.forEach((function(i){"string"==typeof i?(a=i,r=null):(a=i.name,r=i),(o=this.base.addBuiltInExtension(a,r))&&"function"==typeof o.getButton&&(n=o.getButton(this.base),t=this.document.createElement("li"),e.util.isElement(n)?t.appendChild(n):t.innerHTML=n,c.appendChild(t))}),this),(i=c.querySelectorAll("button")).length>0&&(i[0].classList.add(this.firstButtonClass),i[i.length-1].classList.add(this.lastButtonClass)),c},destroy:function(){this.toolbar&&(this.toolbar.parentNode&&this.toolbar.parentNode.removeChild(this.toolbar),delete this.toolbar)},getInteractionElements:function(){return this.getToolbarElement()},getToolbarElement:function(){return this.toolbar||(this.toolbar=this.createToolbar()),this.toolbar},getToolbarActionsElement:function(){return this.getToolbarElement().querySelector(".medium-editor-toolbar-actions")},initThrottledMethods:function(){this.throttledPositionToolbar=e.util.throttle((function(){this.base.isActive&&this.positionToolbarIfShown()}).bind(this))},attachEventHandlers:function(){this.subscribe("blur",this.handleBlur.bind(this)),this.subscribe("focus",this.handleFocus.bind(this)),this.subscribe("editableClick",this.handleEditableClick.bind(this)),this.subscribe("editableKeyup",this.handleEditableKeyup.bind(this)),this.on(this.document.documentElement,"mouseup",this.handleDocumentMouseup.bind(this)),this.static&&this.sticky&&this.on(this.window,"scroll",this.handleWindowScroll.bind(this),!0),this.on(this.window,"resize",this.handleWindowResize.bind(this))},handleWindowScroll:function(){this.positionToolbarIfShown()},handleWindowResize:function(){this.throttledPositionToolbar()},handleDocumentMouseup:function(t){return!(t&&t.target&&e.util.isDescendant(this.getToolbarElement(),t.target))&&void this.checkState()},handleEditableClick:function(){setTimeout((function(){this.checkState()}).bind(this),0)},handleEditableKeyup:function(){this.checkState()},handleBlur:function(){clearTimeout(this.hideTimeout),clearTimeout(this.delayShowTimeout),this.hideTimeout=setTimeout((function(){this.hideToolbar()}).bind(this),1)},handleFocus:function(){this.checkState()},isDisplayed:function(){return this.getToolbarElement().classList.contains("medium-editor-toolbar-active")},showToolbar:function(){clearTimeout(this.hideTimeout),this.isDisplayed()||(this.getToolbarElement().classList.add("medium-editor-toolbar-active"),this.trigger("showToolbar",{},this.base.getFocusedElement()))},hideToolbar:function(){this.isDisplayed()&&(this.getToolbarElement().classList.remove("medium-editor-toolbar-active"),this.trigger("hideToolbar",{},this.base.getFocusedElement()))},isToolbarDefaultActionsDisplayed:function(){return"block"===this.getToolbarActionsElement().style.display},hideToolbarDefaultActions:function(){this.isToolbarDefaultActionsDisplayed()&&(this.getToolbarActionsElement().style.display="none")},showToolbarDefaultActions:function(){this.hideExtensionForms(),this.isToolbarDefaultActionsDisplayed()||(this.getToolbarActionsElement().style.display="block"),this.delayShowTimeout=this.base.delay((function(){this.showToolbar()}).bind(this))},hideExtensionForms:function(){this.forEachExtension((function(e){e.hasForm&&e.isDisplayed()&&e.hideForm()}))},multipleBlockElementsSelected:function(){var t=new RegExp("<("+e.util.blockContainerElementNames.join("|")+")[^>]*>","g"),n=e.selection.getSelectionHtml(this.document).replace(/<[^\/>][^>]*><\/[^>]+>/gim,"").match(t);return!!n&&n.length>1},modifySelection:function(){var t=this.window.getSelection().getRangeAt(0);if(this.standardizeSelectionStart&&t.startContainer.nodeValue&&t.startOffset===t.startContainer.nodeValue.length){var n=e.util.findAdjacentTextNodeWithContent(e.selection.getSelectionElement(this.window),t.startContainer,this.document);if(n){for(var i=0;0===n.nodeValue.substr(i,1).trim().length;)i+=1;t=e.selection.select(this.document,n,i,t.endContainer,t.endOffset)}}},checkState:function(){if(!this.base.preventSelectionUpdates){if(!this.base.getFocusedElement()||e.selection.selectionInContentEditableFalse(this.window))return this.hideToolbar();var t=e.selection.getSelectionElement(this.window);return!t||-1===this.getEditorElements().indexOf(t)||t.getAttribute("data-disable-toolbar")?this.hideToolbar():this.updateOnEmptySelection&&this.static?this.showAndUpdateToolbar():!e.selection.selectionContainsContent(this.document)||!1===this.allowMultiParagraphSelection&&this.multipleBlockElementsSelected()?this.hideToolbar():void this.showAndUpdateToolbar()}},showAndUpdateToolbar:function(){this.modifySelection(),this.setToolbarButtonStates(),this.trigger("positionToolbar",{},this.base.getFocusedElement()),this.showToolbarDefaultActions(),this.setToolbarPosition()},setToolbarButtonStates:function(){this.forEachExtension((function(e){"function"==typeof e.isActive&&"function"==typeof e.setInactive&&e.setInactive()})),this.checkActiveButtons()},checkActiveButtons:function(){var t,n=[],i=null,o=e.selection.getSelectionRange(this.document),a=function(e){"function"==typeof e.checkState?e.checkState(t):"function"==typeof e.isActive&&"function"==typeof e.isAlreadyApplied&&"function"==typeof e.setActive&&!e.isActive()&&e.isAlreadyApplied(t)&&e.setActive()};if(o&&(this.forEachExtension((function(e){return"function"==typeof e.queryCommandState&&null!==(i=e.queryCommandState())?void(i&&"function"==typeof e.setActive&&e.setActive()):void n.push(e)})),t=e.selection.getSelectedParentElement(o),this.getEditorElements().some((function(n){return e.util.isDescendant(n,t,!0)}))))for(;t&&(n.forEach(a),!e.util.isMediumEditorElement(t));)t=t.parentNode},positionToolbarIfShown:function(){this.isDisplayed()&&this.setToolbarPosition()},setToolbarPosition:function(){var e=this.base.getFocusedElement(),t=this.window.getSelection();return e?void(!this.static&&t.isCollapsed||(this.showToolbar(),this.relativeContainer||(this.static?this.positionStaticToolbar(e):this.positionToolbar(t)),this.trigger("positionedToolbar",{},this.base.getFocusedElement()))):this},positionStaticToolbar:function(e){this.getToolbarElement().style.left="0";var t,n=this.document.documentElement&&this.document.documentElement.scrollTop||this.document.body.scrollTop,i=this.window.innerWidth,o=this.getToolbarElement(),a=e.getBoundingClientRect(),r=a.top+n,c=a.left+a.width/2,s=o.offsetHeight,l=o.offsetWidth,p=l/2;switch(this.sticky?n>r+e.offsetHeight-s-this.stickyTopOffset?(o.style.top=r+e.offsetHeight-s+"px",o.classList.remove("medium-editor-sticky-toolbar")):n>r-s-this.stickyTopOffset?(o.classList.add("medium-editor-sticky-toolbar"),o.style.top=this.stickyTopOffset+"px"):(o.classList.remove("medium-editor-sticky-toolbar"),o.style.top=r-s+"px"):o.style.top=r-s+"px",this.align){case"left":t=a.left;break;case"right":t=a.right-l;break;case"center":t=c-p}0>t?t=0:t+l>i&&(t=i-Math.ceil(l)-1),o.style.left=t+"px"},positionToolbar:function(e){this.getToolbarElement().style.left="0",this.getToolbarElement().style.right="initial";var t=e.getRangeAt(0),n=t.getBoundingClientRect();(!n||0===n.height&&0===n.width&&t.startContainer===t.endContainer)&&(n=1===t.startContainer.nodeType&&t.startContainer.querySelector("img")?t.startContainer.querySelector("img").getBoundingClientRect():t.startContainer.getBoundingClientRect());var i,o,a=this.window.innerWidth,r=this.getToolbarElement(),c=r.offsetHeight,s=r.offsetWidth/2,l=this.diffLeft-s,p=this.getEditorOption("elementsContainer"),u=["absolute","fixed"].indexOf(window.getComputedStyle(p).getPropertyValue("position"))>-1,d={},m={};u?(o=p.getBoundingClientRect(),["top","left"].forEach((function(e){m[e]=n[e]-o[e]})),m.width=n.width,m.height=n.height,n=m,a=o.width,d.top=p.scrollTop):d.top=this.window.pageYOffset,i=n.left+n.width/2,d.top+=n.top-c,n.top<50?(r.classList.add("medium-toolbar-arrow-over"),r.classList.remove("medium-toolbar-arrow-under"),d.top+=50+n.height-this.diffTop):(r.classList.add("medium-toolbar-arrow-under"),r.classList.remove("medium-toolbar-arrow-over"),d.top+=this.diffTop),s>i?(d.left=l+s,d.right="initial"):s>a-i?(d.left="auto",d.right=0):(d.left=l+i,d.right="initial"),["top","left","right"].forEach((function(e){r.style[e]=d[e]+(isNaN(d[e])?"":"px")}))}});e.extensions.toolbar=t}(),function(){var t=e.Extension.extend({init:function(){e.Extension.prototype.init.apply(this,arguments),this.subscribe("editableDrag",this.handleDrag.bind(this)),this.subscribe("editableDrop",this.handleDrop.bind(this))},handleDrag:function(e){var t="medium-editor-dragover";e.preventDefault(),e.dataTransfer.dropEffect="copy","dragover"===e.type?e.target.classList.add(t):"dragleave"===e.type&&e.target.classList.remove(t)},handleDrop:function(t){t.preventDefault(),t.stopPropagation(),t.dataTransfer.files&&Array.prototype.slice.call(t.dataTransfer.files,0).some((function(t){var n,i;t.type.match("image")&&((n=new FileReader).readAsDataURL(t),i="medium-img-"+ +new Date,e.util.insertHTMLCommand(this.document,'<img class="medium-editor-image-loading" id="'+i+'" />'),n.onload=(function(){var e=this.document.getElementById(i);e&&(e.removeAttribute("id"),e.removeAttribute("class"),e.src=n.result)}).bind(this))}).bind(this)),t.target.classList.remove("medium-editor-dragover")}});e.extensions.imageDragging=t}(),function(){function t(t){var n=e.selection.getSelectionStart(this.options.ownerDocument),i=n.textContent,o=e.selection.getCaretOffsets(n);(void 0===i[o.left-1]||""===i[o.left-1].trim()||void 0!==i[o.left]&&""===i[o.left].trim())&&t.preventDefault()}function n(t,n){if(this.options.disableReturn||n.getAttribute("data-disable-return"))t.preventDefault();else if(this.options.disableDoubleReturn||n.getAttribute("data-disable-double-return")){var i=e.selection.getSelectionStart(this.options.ownerDocument);(i&&""===i.textContent.trim()&&"li"!==i.nodeName.toLowerCase()||i.previousElementSibling&&"br"!==i.previousElementSibling.nodeName.toLowerCase()&&""===i.previousElementSibling.textContent.trim())&&t.preventDefault()}}function i(t){var n=e.selection.getSelectionStart(this.options.ownerDocument);"pre"===(n&&n.nodeName.toLowerCase())&&(t.preventDefault(),e.util.insertHTMLCommand(this.options.ownerDocument,"    ")),e.util.isListItem(n)&&(t.preventDefault(),this.options.ownerDocument.execCommand(t.shiftKey?"outdent":"indent",!1,null))}function o(t){var n,i=e.selection.getSelectionStart(this.options.ownerDocument),o=i.nodeName.toLowerCase(),a=/^(\s+|<br\/?>)?$/i,r=/h\d/i;e.util.isKey(t,[e.util.keyCode.BACKSPACE,e.util.keyCode.ENTER])&&i.previousElementSibling&&r.test(o)&&0===e.selection.getCaretOffsets(i).left?e.util.isKey(t,e.util.keyCode.BACKSPACE)&&a.test(i.previousElementSibling.innerHTML)?(i.previousElementSibling.parentNode.removeChild(i.previousElementSibling),t.preventDefault()):!this.options.disableDoubleReturn&&e.util.isKey(t,e.util.keyCode.ENTER)&&((n=this.options.ownerDocument.createElement("p")).innerHTML="<br>",i.previousElementSibling.parentNode.insertBefore(n,i),t.preventDefault()):e.util.isKey(t,e.util.keyCode.DELETE)&&i.nextElementSibling&&i.previousElementSibling&&!r.test(o)&&a.test(i.innerHTML)&&r.test(i.nextElementSibling.nodeName.toLowerCase())?(e.selection.moveCursor(this.options.ownerDocument,i.nextElementSibling),i.previousElementSibling.parentNode.removeChild(i),t.preventDefault()):e.util.isKey(t,e.util.keyCode.BACKSPACE)&&"li"===o&&a.test(i.innerHTML)&&!i.previousElementSibling&&!i.parentElement.previousElementSibling&&i.nextElementSibling&&"li"===i.nextElementSibling.nodeName.toLowerCase()?((n=this.options.ownerDocument.createElement("p")).innerHTML="<br>",i.parentElement.parentElement.insertBefore(n,i.parentElement),e.selection.moveCursor(this.options.ownerDocument,n),i.parentElement.removeChild(i),t.preventDefault()):e.util.isKey(t,e.util.keyCode.BACKSPACE)&&!1!==e.util.getClosestTag(i,"blockquote")&&0===e.selection.getCaretOffsets(i).left?(t.preventDefault(),e.util.execFormatBlock(this.options.ownerDocument,"p")):e.util.isKey(t,e.util.keyCode.ENTER)&&!1!==e.util.getClosestTag(i,"blockquote")&&0===e.selection.getCaretOffsets(i).right?((n=this.options.ownerDocument.createElement("p")).innerHTML="<br>",i.parentElement.insertBefore(n,i.nextSibling),e.selection.moveCursor(this.options.ownerDocument,n),t.preventDefault()):e.util.isKey(t,e.util.keyCode.BACKSPACE)&&e.util.isMediumEditorElement(i.parentElement)&&!i.previousElementSibling&&i.nextElementSibling&&a.test(i.innerHTML)&&(t.preventDefault(),e.selection.moveCursor(this.options.ownerDocument,i.nextSibling),i.parentElement.removeChild(i))}function a(t){var n=e.selection.getSelectionStart(this.options.ownerDocument);n&&(e.util.isMediumEditorElement(n)&&0===n.children.length&&!e.util.isBlockContainer(n)&&this.options.ownerDocument.execCommand("formatBlock",!1,"p"),!e.util.isKey(t,e.util.keyCode.ENTER)||e.util.isListItem(n)||e.util.isBlockContainer(n)||("a"===n.nodeName.toLowerCase()?this.options.ownerDocument.execCommand("unlink",!1,null):t.shiftKey||t.ctrlKey||this.options.ownerDocument.execCommand("formatBlock",!1,"p")))}function r(e,t){var n=t.parentNode.querySelector('textarea[medium-editor-textarea-id="'+t.getAttribute("medium-editor-textarea-id")+'"]');n&&(n.value=t.innerHTML.trim())}function c(e){e._mediumEditors||(e._mediumEditors=[null]),this.id||(this.id=e._mediumEditors.length),e._mediumEditors[this.id]=this}function s(e){e._mediumEditors&&e._mediumEditors[this.id]&&(e._mediumEditors[this.id]=null)}function l(t,n,i){var o=[];if(t||(t=[]),"string"==typeof t&&(t=n.querySelectorAll(t)),e.util.isElement(t)&&(t=[t]),i)for(var a=0;a<t.length;a++){var r=t[a];!e.util.isElement(r)||r.getAttribute("data-medium-editor-element")||r.getAttribute("medium-editor-textarea-id")||o.push(r)}else o=Array.prototype.slice.apply(t);return o}function p(e){var t=e.parentNode.querySelector('textarea[medium-editor-textarea-id="'+e.getAttribute("medium-editor-textarea-id")+'"]');t&&(t.classList.remove("medium-editor-hidden"),t.removeAttribute("medium-editor-textarea-id")),e.parentNode&&e.parentNode.removeChild(e)}function u(e,t,n){return"function"==typeof(e=function(e,t){return Object.keys(t).forEach((function(n){void 0===e[n]&&(e[n]=t[n])})),e}(e,{window:n.options.contentWindow,document:n.options.ownerDocument,base:n})).init&&e.init(),e.name||(e.name=t),e}function d(){return!this.elements.every((function(e){return!!e.getAttribute("data-disable-toolbar")}))&&!1!==this.options.toolbar}function m(){return!!d.call(this)&&!1!==this.options.anchorPreview}function h(){return!1!==this.options.placeholder}function b(){return!1!==this.options.autoLink}function f(){return!1!==this.options.imageDragging}function g(){return!1!==this.options.keyboardCommands}function v(){return!this.options.extensions.imageDragging}function y(e){for(var t=this.options.ownerDocument.createElement("div"),n=Date.now(),i="medium-editor-"+n,o=e.attributes;this.options.ownerDocument.getElementById(i);)n++,i="medium-editor-"+n;t.className=e.className,t.id=i,t.innerHTML=e.value,e.setAttribute("medium-editor-textarea-id",i);for(var a=0,r=o.length;r>a;a++)t.hasAttribute(o[a].nodeName)||t.setAttribute(o[a].nodeName,o[a].value);return e.form&&this.on(e.form,"reset",(function(e){e.defaultPrevented||this.resetContent(this.options.ownerDocument.getElementById(i))}).bind(this)),e.classList.add("medium-editor-hidden"),e.parentNode.insertBefore(t,e),t}function x(t,i){if(!t.getAttribute("data-medium-editor-element")){"textarea"===t.nodeName.toLowerCase()&&(t=y.call(this,t),this.instanceHandleEditableInput||(this.instanceHandleEditableInput=r.bind(this),this.subscribe("editableInput",this.instanceHandleEditableInput))),this.options.disableEditing||t.getAttribute("data-disable-editing")||(t.setAttribute("contentEditable",!0),t.setAttribute("spellcheck",this.options.spellcheck)),this.instanceHandleEditableKeydownEnter||(t.getAttribute("data-disable-return")||t.getAttribute("data-disable-double-return"))&&(this.instanceHandleEditableKeydownEnter=n.bind(this),this.subscribe("editableKeydownEnter",this.instanceHandleEditableKeydownEnter)),this.options.disableReturn||t.getAttribute("data-disable-return")||this.on(t,"keyup",a.bind(this));var o=e.util.guid();t.setAttribute("data-medium-editor-element",!0),t.classList.add("medium-editor-element"),t.setAttribute("role","textbox"),t.setAttribute("aria-multiline",!0),t.setAttribute("data-medium-editor-editor-index",i),t.setAttribute("medium-editor-index",o),S[o]=t.innerHTML,this.events.attachAllEventsToElement(t)}return t}function C(){this.subscribe("editableKeydownTab",i.bind(this)),this.subscribe("editableKeydownDelete",o.bind(this)),this.subscribe("editableKeydownEnter",o.bind(this)),this.options.disableExtraSpaces&&this.subscribe("editableKeydownSpace",t.bind(this)),this.instanceHandleEditableKeydownEnter||(this.options.disableReturn||this.options.disableDoubleReturn)&&(this.instanceHandleEditableKeydownEnter=n.bind(this),this.subscribe("editableKeydownEnter",this.instanceHandleEditableKeydownEnter))}function k(){if(this.extensions=[],Object.keys(this.options.extensions).forEach((function(e){"toolbar"!==e&&this.options.extensions[e]&&this.extensions.push(u(this.options.extensions[e],e,this))}),this),v.call(this)){var t=this.options.fileDragging;t||(t={},f.call(this)||(t.allowedTypes=[])),this.addBuiltInExtension("fileDragging",t)}var n={paste:!0,"anchor-preview":m.call(this),autoLink:b.call(this),keyboardCommands:g.call(this),placeholder:h.call(this)};Object.keys(n).forEach((function(e){n[e]&&this.addBuiltInExtension(e)}),this);var i=this.options.extensions.toolbar;if(!i&&d.call(this)){var o=e.util.extend({},this.options.toolbar,{allowMultiParagraphSelection:this.options.allowMultiParagraphSelection});i=new e.extensions.toolbar(o)}i&&this.extensions.push(u(i,"toolbar",this))}function P(t,n){return n&&[["allowMultiParagraphSelection","toolbar.allowMultiParagraphSelection"]].forEach((function(t){n.hasOwnProperty(t[0])&&void 0!==n[t[0]]&&e.util.deprecated(t[0],t[1],"v6.0.0")})),e.util.defaults({},n,t)}function O(t,n){var i;if(i=/^append-(.+)$/gi.exec(t))return e.util.execFormatBlock(this.options.ownerDocument,i[1]);if("fontSize"===t)return n.size&&e.util.deprecated(".size option for fontSize command",".value","6.0.0"),this.options.ownerDocument.execCommand("fontSize",!1,n.value||n.size);if("fontName"===t)return n.name&&e.util.deprecated(".name option for fontName command",".value","6.0.0"),this.options.ownerDocument.execCommand("fontName",!1,n.value||n.name);if("createLink"===t)return this.createLink(n);if("image"===t){var o=this.options.contentWindow.getSelection().toString().trim();return this.options.ownerDocument.execCommand("insertImage",!1,o)}if("html"===t){var a=this.options.contentWindow.getSelection().toString().trim();return e.util.insertHTMLCommand(this.options.ownerDocument,a)}if(/justify([A-Za-z]*)$/g.exec(t)){var r=this.options.ownerDocument.execCommand(t,!1,null),c=e.selection.getSelectedParentElement(e.selection.getSelectionRange(this.options.ownerDocument));return c&&w.call(this,e.util.getTopBlockContainer(c)),r}return this.options.ownerDocument.execCommand(t,!1,n&&n.value)}function w(t){if(t){var n,i=Array.prototype.slice.call(t.childNodes).filter((function(e){var t="div"===e.nodeName.toLowerCase();return t&&!n&&(n=e.style.textAlign),t}));i.length&&(this.saveSelection(),i.forEach((function(t){if(t.style.textAlign===n){var i=t.lastChild;if(i){e.util.unwrap(t,this.options.ownerDocument);var o=this.options.ownerDocument.createElement("BR");i.parentNode.insertBefore(o,i.nextSibling)}}}),this),t.style.textAlign=n,this.restoreSelection())}}var S={};e.prototype={init:function(e,t){return this.options=P.call(this,this.defaults,t),this.origElements=e,this.options.elementsContainer||(this.options.elementsContainer=this.options.ownerDocument.body),this.setup()},setup:function(){this.isActive||(c.call(this,this.options.contentWindow),this.events=new e.Events(this),this.elements=[],this.addElements(this.origElements),0!==this.elements.length&&(this.isActive=!0,k.call(this),C.call(this)))},destroy:function(){this.isActive&&(this.isActive=!1,this.extensions.forEach((function(e){"function"==typeof e.destroy&&e.destroy()}),this),this.events.destroy(),this.elements.forEach((function(e){this.options.spellcheck&&(e.innerHTML=e.innerHTML),e.removeAttribute("contentEditable"),e.removeAttribute("spellcheck"),e.removeAttribute("data-medium-editor-element"),e.classList.remove("medium-editor-element"),e.removeAttribute("role"),e.removeAttribute("aria-multiline"),e.removeAttribute("medium-editor-index"),e.removeAttribute("data-medium-editor-editor-index"),e.getAttribute("medium-editor-textarea-id")&&p(e)}),this),this.elements=[],this.instanceHandleEditableKeydownEnter=null,this.instanceHandleEditableInput=null,s.call(this,this.options.contentWindow))},on:function(e,t,n,i){return this.events.attachDOMEvent(e,t,n,i),this},off:function(e,t,n,i){return this.events.detachDOMEvent(e,t,n,i),this},subscribe:function(e,t){return this.events.attachCustomEvent(e,t),this},unsubscribe:function(e,t){return this.events.detachCustomEvent(e,t),this},trigger:function(e,t,n){return this.events.triggerCustomEvent(e,t,n),this},delay:function(e){var t=this;return setTimeout((function(){t.isActive&&e()}),this.options.delay)},serialize:function(){var e,t={},n=this.elements.length;for(e=0;n>e;e+=1)t[""!==this.elements[e].id?this.elements[e].id:"element-"+e]={value:this.elements[e].innerHTML.trim()};return t},getExtensionByName:function(e){var t;return this.extensions&&this.extensions.length&&this.extensions.some((function(n){return n.name===e&&(t=n,!0)})),t},addBuiltInExtension:function(t,n){var i,o=this.getExtensionByName(t);if(o)return o;switch(t){case"anchor":i=e.util.extend({},this.options.anchor,n),o=new e.extensions.anchor(i);break;case"anchor-preview":o=new e.extensions.anchorPreview(this.options.anchorPreview);break;case"autoLink":o=new e.extensions.autoLink;break;case"fileDragging":o=new e.extensions.fileDragging(n);break;case"fontname":o=new e.extensions.fontName(this.options.fontName);break;case"fontsize":o=new e.extensions.fontSize(n);break;case"keyboardCommands":o=new e.extensions.keyboardCommands(this.options.keyboardCommands);break;case"paste":o=new e.extensions.paste(this.options.paste);break;case"placeholder":o=new e.extensions.placeholder(this.options.placeholder);break;default:e.extensions.button.isBuiltInButton(t)&&(n?(i=e.util.defaults({},n,e.extensions.button.prototype.defaults[t]),o=new e.extensions.button(i)):o=new e.extensions.button(t))}return o&&this.extensions.push(u(o,t,this)),o},stopSelectionUpdates:function(){this.preventSelectionUpdates=!0},startSelectionUpdates:function(){this.preventSelectionUpdates=!1},checkSelection:function(){var e=this.getExtensionByName("toolbar");return e&&e.checkState(),this},queryCommandState:function(e){var t,n=null;(t=/^full-(.+)$/gi.exec(e))&&(e=t[1]);try{n=this.options.ownerDocument.queryCommandState(e)}catch(o){n=null}return n},execAction:function(t,n){var i,o;return(i=/^full-(.+)$/gi.exec(t))?(this.saveSelection(),this.selectAllContents(),o=O.call(this,i[1],n),this.restoreSelection()):o=O.call(this,t,n),"insertunorderedlist"!==t&&"insertorderedlist"!==t||e.util.cleanListDOM(this.options.ownerDocument,this.getSelectedParentElement()),this.checkSelection(),o},getSelectedParentElement:function(t){return void 0===t&&(t=this.options.contentWindow.getSelection().getRangeAt(0)),e.selection.getSelectedParentElement(t)},selectAllContents:function(){var t=e.selection.getSelectionElement(this.options.contentWindow);if(t){for(;1===t.children.length;)t=t.children[0];this.selectElement(t)}},selectElement:function(t){e.selection.selectNode(t,this.options.ownerDocument);var n=e.selection.getSelectionElement(this.options.contentWindow);n&&this.events.focusElement(n)},getFocusedElement:function(){var e;return this.elements.some((function(t){return!e&&t.getAttribute("data-medium-focused")&&(e=t),!!e}),this),e},exportSelection:function(){var t=e.selection.getSelectionElement(this.options.contentWindow),n=this.elements.indexOf(t),i=null;return n>=0&&(i=e.selection.exportSelection(t,this.options.ownerDocument)),null!==i&&0!==n&&(i.editableElementIndex=n),i},saveSelection:function(){this.selectionState=this.exportSelection()},importSelection:function(t,n){t&&e.selection.importSelection(t,this.elements[t.editableElementIndex||0],this.options.ownerDocument,n)},restoreSelection:function(){this.importSelection(this.selectionState)},createLink:function(t){var n,i=e.selection.getSelectionElement(this.options.contentWindow),o={};if(-1!==this.elements.indexOf(i)){try{if(this.events.disableCustomEvent("editableInput"),t.url&&e.util.deprecated(".url option for createLink",".value","6.0.0"),(n=t.url||t.value)&&n.trim().length>0){var a=this.options.contentWindow.getSelection();if(a){var r,c,s,l,p=a.getRangeAt(0),u=p.commonAncestorContainer;if(3===p.endContainer.nodeType&&3!==p.startContainer.nodeType&&0===p.startOffset&&p.startContainer.firstChild===p.endContainer&&(u=p.endContainer),c=e.util.getClosestBlockContainer(p.startContainer),s=e.util.getClosestBlockContainer(p.endContainer),3!==u.nodeType&&0!==u.textContent.length&&c===s){var d=c||i,m=this.options.ownerDocument.createDocumentFragment();this.execAction("unlink"),r=this.exportSelection(),m.appendChild(d.cloneNode(!0)),i===d?e.selection.select(this.options.ownerDocument,d.firstChild,0,d.lastChild,3===d.lastChild.nodeType?d.lastChild.nodeValue.length:d.lastChild.childNodes.length):e.selection.select(this.options.ownerDocument,d,0,d,d.childNodes.length);var h=this.exportSelection();0===(l=e.util.findOrCreateMatchingTextNodes(this.options.ownerDocument,m,{start:r.start-h.start,end:r.end-h.start,editableElementIndex:r.editableElementIndex})).length&&((m=this.options.ownerDocument.createDocumentFragment()).appendChild(u.cloneNode(!0)),l=[m.firstChild.firstChild,m.firstChild.lastChild]),e.util.createLink(this.options.ownerDocument,l,n.trim());var b=(m.firstChild.innerHTML.match(/^\s+/)||[""])[0].length;e.util.insertHTMLCommand(this.options.ownerDocument,m.firstChild.innerHTML.replace(/^\s+/,"")),r.start-=b,r.end-=b,this.importSelection(r)}else this.options.ownerDocument.execCommand("createLink",!1,n);this.options.targetBlank||"_blank"===t.target?e.util.setTargetBlank(e.selection.getSelectionStart(this.options.ownerDocument),n):e.util.removeTargetBlank(e.selection.getSelectionStart(this.options.ownerDocument),n),t.buttonClass&&e.util.addClassToAnchors(e.selection.getSelectionStart(this.options.ownerDocument),t.buttonClass)}}if(this.options.targetBlank||"_blank"===t.target||t.buttonClass){(o=this.options.ownerDocument.createEvent("HTMLEvents")).initEvent("input",!0,!0,this.options.contentWindow);for(var f=0,g=this.elements.length;g>f;f+=1)this.elements[f].dispatchEvent(o)}}finally{this.events.enableCustomEvent("editableInput")}this.events.triggerCustomEvent("editableInput",o,i)}},cleanPaste:function(e){this.getExtensionByName("paste").cleanPaste(e)},pasteHTML:function(e,t){this.getExtensionByName("paste").pasteHTML(e,t)},setContent:function(e,t){if(this.elements[t=t||0]){var n=this.elements[t];n.innerHTML=e,this.checkContentChanged(n)}},getContent:function(e){return this.elements[e=e||0]?this.elements[e].innerHTML.trim():null},checkContentChanged:function(t){t=t||e.selection.getSelectionElement(this.options.contentWindow),this.events.updateInput(t,{target:t,currentTarget:t})},resetContent:function(e){if(e){var t=this.elements.indexOf(e);-1!==t&&this.setContent(S[e.getAttribute("medium-editor-index")],t)}else this.elements.forEach((function(e,t){this.setContent(S[e.getAttribute("medium-editor-index")],t)}),this)},addElements:function(e){var t=l(e,this.options.ownerDocument,!0);return 0!==t.length&&void t.forEach((function(e){e=x.call(this,e,this.id),this.elements.push(e),this.trigger("addElement",{target:e,currentTarget:e},e)}),this)},removeElements:function(e){var t=l(e,this.options.ownerDocument).map((function(e){return e.getAttribute("medium-editor-textarea-id")&&e.parentNode?e.parentNode.querySelector('div[medium-editor-textarea-id="'+e.getAttribute("medium-editor-textarea-id")+'"]'):e}));this.elements=this.elements.filter((function(e){return-1===t.indexOf(e)||(this.events.cleanupElement(e),e.getAttribute("medium-editor-textarea-id")&&p(e),this.trigger("removeElement",{target:e,currentTarget:e},e),!1)}),this)}},e.getEditorFromElement=function(e){var t=e.getAttribute("data-medium-editor-editor-index"),n=e&&e.ownerDocument&&(e.ownerDocument.defaultView||e.ownerDocument.parentWindow);return n&&n._mediumEditors&&n._mediumEditors[t]?n._mediumEditors[t]:null}}(),e.prototype.defaults={activeButtonClass:"medium-editor-button-active",buttonLabels:!1,delay:0,disableReturn:!1,disableDoubleReturn:!1,disableExtraSpaces:!1,disableEditing:!1,autoLink:!1,elementsContainer:!1,contentWindow:window,ownerDocument:document,targetBlank:!1,extensions:{},spellcheck:!0},e.parseVersionString=function(e){var t=e.split("-"),n=t[0].split("."),i=t.length>1?t[1]:"";return{major:parseInt(n[0],10),minor:parseInt(n[1],10),revision:parseInt(n[2],10),preRelease:i,toString:function(){return[n[0],n[1],n[2]].join(".")+(i?"-"+i:"")}}},e.version=e.parseVersionString.call(this,"5.23.3"),e;var t}())},zFnc:function(t,i,o){"use strict";var c,s,p,m,h,b;o.r(i),o.d(i,"EditModule",(function(){return sf}));var f=o("ofXK"),g=o("tyNb"),v=o("G0Z9"),y=o("AcyG"),x=o("CpGW"),C=o("XNiG"),k=o("LRne"),P=o("xgIS"),O=o("itXk"),w=o("VRyK"),S=o("PqYM"),_=o("HDdC"),M=o("x/dY"),U=o("jjCP"),T=o("iTtc"),V=o("PUI9"),D=o("YpC8"),E=o("5+tZ"),j=o("lJxs"),N=o("1G5W"),R=o("pLZG"),A=o("3E0/"),F=o("IzEk"),I=o("eIep"),z=o("Zy1z"),L=o("zP0r"),B=o("vkgz"),Q=o("SxV6"),$=o("Vv7R"),q=o("11Ye"),G=o("H7eZ"),H=o("ZDoJ"),W=o("1a36"),K=o("N0Zw"),J=o("VJvM"),X=o("Mh2x"),Z=o("TATr"),Y=o("YLgZ"),ee=o("Lyqc"),te=o("QtmD"),ne=o("sTHe"),ie=o("q8pu"),oe=o("ECVi"),ae=o("3Pt+"),re=o("0IaG"),ce=o("LvDl"),se=o("o6VQ"),le=o("+1W3"),pe=o("mtgE"),ue=o("V7wM"),de=o("1iZL"),me=o("uDDk"),he=o("GW3K"),be=o("Lwol"),fe=o("p345"),ge=o("INTG"),ve=o("fXoL"),ye=o("qz+p"),xe=o("TWoc"),Ce=o("eW6i"),ke=o("dNgK"),Pe=o("IlST"),Oe=o("Y8QC"),we=o("oOZS"),Se=o("mdhy"),_e=o("f0Cb"),Me=o("UdTj"),Ue=o("bSwM"),Te=o("3UWI"),Ve=function(e){return e.Basic="basic",e.Full="full",e}({});function De(e,t){return Array(t+1).join(e)}var Ee=["address","article","aside","audio","blockquote","body","canvas","center","dd","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frameset","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","isindex","li","main","menu","nav","noframes","noscript","ol","output","p","pre","section","table","tbody","td","tfoot","th","thead","tr","ul"];function je(e){return-1!==Ee.indexOf(e.nodeName.toLowerCase())}var Ne=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"];function Re(e){return-1!==Ne.indexOf(e.nodeName.toLowerCase())}var Ae=Ne.join(),Fe={};function Ie(e){for(var t in this.options=e,this._keep=[],this._remove=[],this.blankRule={replacement:e.blankReplacement},this.keepReplacement=e.keepReplacement,this.defaultRule={replacement:e.defaultReplacement},this.array=[],e.rules)this.array.push(e.rules[t])}function ze(e,t,n){for(var i=0;i<e.length;i++){var o=e[i];if(Le(o,t,n))return o}}function Le(e,t,n){var i=e.filter;if("string"==typeof i){if(i===t.nodeName.toLowerCase())return!0}else if(Array.isArray(i)){if(i.indexOf(t.nodeName.toLowerCase())>-1)return!0}else{if("function"!=typeof i)throw new TypeError("`filter` needs to be a string, array, or function");if(i.call(e,t,n))return!0}}function Be(e){var t=e.nextSibling||e.parentNode;return e.parentNode.removeChild(e),t}function Qe(e,t,n){return e&&e.parentNode===t||n(t)?t.nextSibling||t.parentNode:t.firstChild||t.nextSibling||t.parentNode}Fe.paragraph={filter:"p",replacement:function(e){return"\n\n"+e+"\n\n"}},Fe.lineBreak={filter:"br",replacement:function(e,t,n){return n.br+"\n"}},Fe.heading={filter:["h1","h2","h3","h4","h5","h6"],replacement:function(e,t,n){var i=Number(t.nodeName.charAt(1));return"setext"===n.headingStyle&&i<3?"\n\n"+e+"\n"+De(1===i?"=":"-",e.length)+"\n\n":"\n\n"+De("#",i)+" "+e+"\n\n"}},Fe.blockquote={filter:"blockquote",replacement:function(e){return"\n\n"+(e=(e=e.replace(/^\n+|\n+$/g,"")).replace(/^/gm,"> "))+"\n\n"}},Fe.list={filter:["ul","ol"],replacement:function(e,t){var n=t.parentNode;return"LI"===n.nodeName&&n.lastElementChild===t?"\n"+e:"\n\n"+e+"\n\n"}},Fe.listItem={filter:"li",replacement:function(e,t,n){e=e.replace(/^\n+/,"").replace(/\n+$/,"\n").replace(/\n/gm,"\n    ");var i=n.bulletListMarker+"   ",o=t.parentNode;if("OL"===o.nodeName){var a=o.getAttribute("start"),r=Array.prototype.indexOf.call(o.children,t);i=(a?Number(a)+r:r+1)+".  "}return i+e+(t.nextSibling&&!/\n$/.test(e)?"\n":"")}},Fe.indentedCodeBlock={filter:function(e,t){return"indented"===t.codeBlockStyle&&"PRE"===e.nodeName&&e.firstChild&&"CODE"===e.firstChild.nodeName},replacement:function(e,t,n){return"\n\n    "+t.firstChild.textContent.replace(/\n/g,"\n    ")+"\n\n"}},Fe.fencedCodeBlock={filter:function(e,t){return"fenced"===t.codeBlockStyle&&"PRE"===e.nodeName&&e.firstChild&&"CODE"===e.firstChild.nodeName},replacement:function(e,t,n){for(var i,o=((t.firstChild.className||"").match(/language-(\S+)/)||[null,""])[1],a=t.firstChild.textContent,r=n.fence.charAt(0),c=3,s=new RegExp("^"+r+"{3,}","gm");i=s.exec(a);)i[0].length>=c&&(c=i[0].length+1);var l=De(r,c);return"\n\n"+l+o+"\n"+a.replace(/\n$/,"")+"\n"+l+"\n\n"}},Fe.horizontalRule={filter:"hr",replacement:function(e,t,n){return"\n\n"+n.hr+"\n\n"}},Fe.inlineLink={filter:function(e,t){return"inlined"===t.linkStyle&&"A"===e.nodeName&&e.getAttribute("href")},replacement:function(e,t){return"["+e+"]("+t.getAttribute("href")+(t.title?' "'+t.title+'"':"")+")"}},Fe.referenceLink={filter:function(e,t){return"referenced"===t.linkStyle&&"A"===e.nodeName&&e.getAttribute("href")},replacement:function(e,t,n){var i,o,a=t.getAttribute("href"),r=t.title?' "'+t.title+'"':"";switch(n.linkReferenceStyle){case"collapsed":i="["+e+"][]",o="["+e+"]: "+a+r;break;case"shortcut":i="["+e+"]",o="["+e+"]: "+a+r;break;default:var c=this.references.length+1;i="["+e+"]["+c+"]",o="["+c+"]: "+a+r}return this.references.push(o),i},references:[],append:function(e){var t="";return this.references.length&&(t="\n\n"+this.references.join("\n")+"\n\n",this.references=[]),t}},Fe.emphasis={filter:["em","i"],replacement:function(e,t,n){return e.trim()?n.emDelimiter+e+n.emDelimiter:""}},Fe.strong={filter:["strong","b"],replacement:function(e,t,n){return e.trim()?n.strongDelimiter+e+n.strongDelimiter:""}},Fe.code={filter:function(e){return"CODE"===e.nodeName&&!("PRE"===e.parentNode.nodeName&&!e.previousSibling&&!e.nextSibling)},replacement:function(e){if(!e.trim())return"";var t="`",n="",i="",o=e.match(/`+/gm);if(o)for(/^`/.test(e)&&(n=" "),/`$/.test(e)&&(i=" ");-1!==o.indexOf(t);)t+="`";return t+n+e+i+t}},Fe.image={filter:"img",replacement:function(e,t){var n=t.alt||"",i=t.getAttribute("src")||"",o=t.title||"";return i?"!["+n+"]("+i+(o?' "'+o+'"':"")+")":""}},Ie.prototype={add:function(e,t){this.array.unshift(t)},keep:function(e){this._keep.unshift({filter:e,replacement:this.keepReplacement})},remove:function(e){this._remove.unshift({filter:e,replacement:function(){return""}})},forNode:function(e){return e.isBlank?this.blankRule:(t=ze(this.array,e,this.options))||(t=ze(this._keep,e,this.options))||(t=ze(this._remove,e,this.options))?t:this.defaultRule;var t},forEach:function(e){for(var t=0;t<this.array.length;t++)e(this.array[t],t)}};var $e,qe,Ge,He="undefined"!=typeof window?window:{},We=function(){var e=He.DOMParser,t=!1;try{(new e).parseFromString("","text/html")&&(t=!0)}catch(n){}return t}()?He.DOMParser:($e=function(){},qe=o(5).JSDOM,$e.prototype.parseFromString=function(e){return new qe(e).window.document},$e);function Ke(e){var t;return function(e){var t=e.element,n=e.isBlock,i=e.isVoid,o=e.isPre||function(e){return"PRE"===e.nodeName};if(t.firstChild&&!o(t)){for(var a=null,r=!1,c=null,s=Qe(c,t,o);s!==t;){if(3===s.nodeType||4===s.nodeType){var l=s.data.replace(/[ \r\n\t]+/g," ");if(a&&!/ $/.test(a.data)||r||" "!==l[0]||(l=l.substr(1)),!l){s=Be(s);continue}s.data=l,a=s}else{if(1!==s.nodeType){s=Be(s);continue}n(s)||"BR"===s.nodeName?(a&&(a.data=a.data.replace(/ $/,"")),a=null,r=!1):i(s)&&(a=null,r=!0)}var p=Qe(c,s,o);c=s,s=p}a&&(a.data=a.data.replace(/ $/,""),a.data||Be(a))}}({element:t="string"==typeof e?(Ge=Ge||new We).parseFromString('<x-turndown id="turndown-root">'+e+"</x-turndown>","text/html").getElementById("turndown-root"):e.cloneNode(!0),isBlock:je,isVoid:Re}),t}function Je(e){return e.isBlock=je(e),e.isCode="code"===e.nodeName.toLowerCase()||e.parentNode.isCode,e.isBlank=function(e){return-1===["A","TH","TD","IFRAME","SCRIPT","AUDIO","VIDEO"].indexOf(e.nodeName)&&/^\s*$/i.test(e.textContent)&&!Re(e)&&!function(e){return e.querySelector&&e.querySelector(Ae)}(e)}(e),e.flankingWhitespace=function(e){var t="",n="";if(!e.isBlock){var i=/^\s/.test(e.textContent),o=/\s$/.test(e.textContent),a=e.isBlank&&i&&o;i&&!Xe("left",e)&&(t=" "),a||!o||Xe("right",e)||(n=" ")}return{leading:t,trailing:n}}(e),e}function Xe(e,t){var n,i,o;return"left"===e?(n=t.previousSibling,i=/ $/):(n=t.nextSibling,i=/^ /),n&&(3===n.nodeType?o=i.test(n.nodeValue):1!==n.nodeType||je(n)||(o=i.test(n.textContent))),o}var Ze=Array.prototype.reduce,Ye=/^\n*/,et=/\n*$/,tt=[[/\\/g,"\\\\"],[/\*/g,"\\*"],[/^-/g,"\\-"],[/^\+ /g,"\\+ "],[/^(=+)/g,"\\$1"],[/^(#{1,6}) /g,"\\$1 "],[/`/g,"\\`"],[/^~~~/g,"\\~~~"],[/\[/g,"\\["],[/\]/g,"\\]"],[/^>/g,"\\>"],[/_/g,"\\_"],[/^(\d+)\. /g,"$1\\. "]];function nt(e){if(!(this instanceof nt))return new nt(e);this.options=function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)n.hasOwnProperty(i)&&(e[i]=n[i])}return e}({},{rules:Fe,headingStyle:"setext",hr:"* * *",bulletListMarker:"*",codeBlockStyle:"indented",fence:"```",emDelimiter:"_",strongDelimiter:"**",linkStyle:"inlined",linkReferenceStyle:"full",br:"  ",blankReplacement:function(e,t){return t.isBlock?"\n\n":""},keepReplacement:function(e,t){return t.isBlock?"\n\n"+t.outerHTML+"\n\n":t.outerHTML},defaultReplacement:function(e,t){return t.isBlock?"\n\n"+e+"\n\n":e}},e),this.rules=new Ie(this.options)}function it(e){var t=this;return Ze.call(e.childNodes,(function(e,n){var i="";return 3===(n=new Je(n)).nodeType?i=n.isCode?n.nodeValue:t.escape(n.nodeValue):1===n.nodeType&&(i=at.call(t,n)),rt(e,i)}),"")}function ot(e){var t=this;return this.rules.forEach((function(n){"function"==typeof n.append&&(e=rt(e,n.append(t.options)))})),e.replace(/^[\t\r\n]+/,"").replace(/[\t\r\n\s]+$/,"")}function at(e){var t=this.rules.forNode(e),n=it.call(this,e),i=e.flankingWhitespace;return(i.leading||i.trailing)&&(n=n.trim()),i.leading+t.replacement(n,e,this.options)+i.trailing}function rt(e,t){var n,i,o,a=(n=t,(o=(i=[e.match(et)[0],n.match(Ye)[0]].sort())[i.length-1]).length<2?o:"\n\n");return(e=e.replace(et,""))+a+t.replace(Ye,"")}nt.prototype={turndown:function(e){if(!function(e){return null!=e&&("string"==typeof e||e.nodeType&&(1===e.nodeType||9===e.nodeType||11===e.nodeType))}(e))throw new TypeError(e+" is not a string, or an element/document/fragment node.");if(""===e)return"";var t=it.call(this,new Ke(e));return ot.call(this,t)},use:function(e){if(Array.isArray(e))for(var t=0;t<e.length;t++)this.use(e[t]);else{if("function"!=typeof e)throw new TypeError("plugin must be a Function or an Array of Functions");e(this)}return this},addRule:function(e,t){return this.rules.add(e,t),this},keep:function(e){return this.rules.keep(e),this},remove:function(e){return this.rules.remove(e),this},escape:function(e){return tt.reduce((function(e,t){return e.replace(t[0],t[1])}),e)}};var ct,st=nt,lt=o("CL6y"),pt=new st({headingStyle:"atx"}).keep(lt.b),ut=o("j8XN"),dt=o("lR5k"),mt=["containerEl"],ht=["toolbarEl"],bt=["editEl"],ft=(d(c={},Ve.Basic,["superscript","subscript"]),d(c,Ve.Full,["bold","italic","anchor","orderedlist","unorderedlist","superscript","subscript"]),c),gt=((ct=function(){function e(t,n,i){l(this,e),this.changeRef=t,this.renderer2=n,this.markdownService=i,this.resizeable=!0,this.inline=!0,this.compact=!1,this.mode=Ve.Full,this.textMode="textarea",this.textValue="",this.editorFocused=!1,this.valueChanges=new C.a,this.ngUnsubscribe=new C.a,this.plainTextEl=this.renderer2.createElement("div")}return u(e,[{key:"value",get:function(){return this._value},set:function(e){e!==this.value&&(this._value=e,this.textValue=this.getPlainTextFromMarkdown(e),this.onChange(e),this.valueChanges.next(e))}},{key:"rows",get:function(){return this._rows},set:function(e){this._rows=e,this.setRows(e)}},{key:"ngOnInit",value:function(){}},{key:"ngAfterViewInit",value:function(){this.initEditor(),this.initListeners(),this.initContentLabel()}},{key:"ngOnDestroy",value:function(){this.editor.destroy(),this.valueChanges.complete(),this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initEditor",value:function(){var e=this;this.editor=new ut(this.editEl.nativeElement,{toolbar:{relativeContainer:this.inline?this.toolbarEl.nativeElement:null,buttons:ft[this.mode]},targetBlank:!0,buttonLabels:"fontawesome",paste:{forcePlainText:this.mode===Ve.Basic,cleanPastedHTML:this.mode!==Ve.Basic},anchor:{linkValidation:!0},disableReturn:"text"===this.textMode,placeholder:!!this.placeholder&&{text:this.placeholder}}),this.getEditorValueChanges(this.editor).pipe(Object(Te.a)(125),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){var n="number"==typeof e.maxLength,i=e.getPlainTextFromHTML(t);if(n&&i.length>e.maxLength)e.setEditorValue(e.value);else{var o=function(e){return pt.turndown(e)}(t);e.value=o}})),this.getEditorEvent(this.editor,"focus").pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(){e.editorFocused=!0,e.changeRef.markForCheck()})),this.getEditorEvent(this.editor,"blur").pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(){e.editorFocused=!1,e.changeRef.markForCheck()})),this.setEditorValue(this.value),this.setRows(this.rows)}},{key:"initListeners",value:function(){Object(P.a)(this.editEl.nativeElement,"keydown").pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(e){e.stopPropagation()}))}},{key:"initContentLabel",value:function(){var e=this.containerEl.nativeElement.closest("label");if(!Object(ce.isNil)(e)){var t=e.getAttribute("aria-label")||"",n="textarea"===this.textMode;this.editEl.nativeElement.setAttribute("aria-label",t),this.editEl.nativeElement.setAttribute("aria-multiline",n.toString())}}},{key:"getValueChanges",value:function(){return this.valueChanges.asObservable()}},{key:"getEditorValue",value:function(e){return e.getContent(0)}},{key:"getEditorValueChanges",value:function(e){var t=this;return this.getEditorEvent(e,"editableInput").pipe(Object(j.a)((function(){return t.getEditorValue(e)})))}},{key:"getEditorEvent",value:function(e,t){return new _.a((function(n){e.subscribe(t,(function(e){n.next(e)}))}))}},{key:"setEditorValue",value:function(e){if(this.editor){var t=this.markdownService.compile(e);this.editor.setContent(t)}}},{key:"setRows",value:function(e){this.editEl&&this.editEl.nativeElement&&this.renderer2.setStyle(this.editEl.nativeElement,"height",void 0===e?"auto":16+16*e+"px")}},{key:"onChange",value:function(e){}},{key:"onTouched",value:function(){}},{key:"writeValue",value:function(e){e!==this.value&&(this.value=e,this.setEditorValue(e))}},{key:"registerOnChange",value:function(e){this.onChange=e}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"setDisabledState",value:function(e){this.disabled=e}},{key:"getPlainTextFromMarkdown",value:function(e){var t=this.markdownService.compile(e);return this.getPlainTextFromHTML(t)}},{key:"getPlainTextFromHTML",value:function(e){return this.renderer2.setProperty(this.plainTextEl,"innerHTML",e),Object(ce.trim)(this.plainTextEl.textContent)}}]),e}()).\u0275fac=function(e){return new(e||ct)(ve.Pb(ve.i),ve.Pb(ve.H),ve.Pb(dt.c))},ct.\u0275cmp=ve.Jb({type:ct,selectors:[["app-rich-text-edit"]],viewQuery:function(e,t){var n;1&e&&(ve.Jc(mt,!0),ve.Jc(ht,!0),ve.Jc(bt,!0)),2&e&&(ve.xc(n=ve.dc())&&(t.containerEl=n.first),ve.xc(n=ve.dc())&&(t.toolbarEl=n.first),ve.xc(n=ve.dc())&&(t.editEl=n.first))},inputs:{value:"value",rows:"rows",disabled:"disabled",resizeable:"resizeable",inline:"inline",compact:"compact",mode:"mode",textMode:"textMode",maxLength:"maxLength",placeholder:"placeholder"},features:[ve.Cb([{provide:ae.p,useExisting:Object(ve.W)((function(){return ct})),multi:!0}])],decls:6,vars:13,consts:[[1,"rich-text-edit"],["containerEl",""],["role","textbox",1,"rich-text-edit__editor","html","input"],["editEl",""],[1,"rich-text-edit__toolbar","medium-editor-toolbar-container"],["toolbarEl",""]],template:function(e,t){1&e&&(ve.Vb(0,"div",0,1),ve.Qb(2,"div",2,3),ve.Qb(4,"div",4,5),ve.Ub()),2&e&&(ve.Hb("rich-text-edit--inline",!0===t.inline)("medium-editor-focused",t.editorFocused)("medium-editor-compact",t.compact),ve.Db(2),ve.Hb("rich-text-edit__editor--text","text"===t.textMode)("rich-text-edit__editor--textarea","textarea"===t.textMode)("rich-text-edit__editor--resizeable",t.resizeable),ve.Eb("data-disable-editing",t.disabled))},styles:[".input,[type=email].input,[type=file].input,[type=number].input,[type=password].input,[type=text].input,[type=url].input,select.input,textarea.input{border:1px solid #1b283c;border-radius:4px;background-color:#101823;color:#fff;display:block;min-height:36px;width:100%;font-size:12px;padding:8px 12px;font-family:Inter UI,sans-serif}@supports (font-variation-settings:normal){.input,[type=email].input,[type=file].input,[type=number].input,[type=password].input,[type=text].input,[type=url].input,select.input,textarea.input{font-family:Inter UI var alt,sans-serif}}.input:focus,[type=email].input:focus,[type=file].input:focus,[type=number].input:focus,[type=password].input:focus,[type=text].input:focus,[type=url].input:focus,select.input:focus,textarea.input:focus{outline:2px solid #2d72dc!important}.input:focus.ng-invalid,[type=email].input:focus.ng-invalid,[type=file].input:focus.ng-invalid,[type=number].input:focus.ng-invalid,[type=password].input:focus.ng-invalid,[type=text].input:focus.ng-invalid,[type=url].input:focus.ng-invalid,select.input:focus.ng-invalid,textarea.input:focus.ng-invalid{outline-color:#ed4758!important;outline-width:1px!important}.input--small,[type=email].input--small,[type=file].input--small,[type=number].input--small,[type=password].input--small,[type=text].input--small,[type=url].input--small,select.input--small,textarea.input--small{font-size:12px;padding:8px;min-height:auto}.input--large,[type=email].input--large,[type=file].input--large,[type=number].input--large,[type=password].input--large,[type=text].input--large,[type=url].input--large,select.input--large,textarea.input--large{font-size:16px;padding:12px}.input--success,[type=email].input--success,[type=file].input--success,[type=number].input--success,[type=password].input--success,[type=text].input--success,[type=url].input--success,select.input--success,textarea.input--success{border-color:#38de38!important}.input:disabled,[type=email].input:disabled,[type=file].input:disabled,[type=number].input:disabled,[type=password].input:disabled,[type=text].input:disabled,[type=url].input:disabled,select.input:disabled,textarea.input:disabled{opacity:.4}.input.ng-dirty.ng-invalid,[type=email].input.ng-dirty.ng-invalid,[type=file].input.ng-dirty.ng-invalid,[type=number].input.ng-dirty.ng-invalid,[type=password].input.ng-dirty.ng-invalid,[type=text].input.ng-dirty.ng-invalid,[type=url].input.ng-dirty.ng-invalid,select.input.ng-dirty.ng-invalid,textarea.input.ng-dirty.ng-invalid{border:1px solid #ed4758}textarea.input--nonresizable{resize:none}select.input{height:36px}.theme-dark .input[type=email],.theme-dark .input[type=file],.theme-dark .input[type=number],.theme-dark .input[type=password],.theme-dark .input[type=text],.theme-dark .input[type=url],.theme-dark select.input,.theme-dark textarea.input,input.theme-dark,select.theme-dark,textarea.theme-dark{background-color:#101823;border:1px solid #374a68;color:#fff}.theme-light .input[type=email],.theme-light .input[type=file],.theme-light .input[type=number],.theme-light .input[type=password],.theme-light .input[type=text],.theme-light .input[type=url],.theme-light select.input,.theme-light textarea.input,input.theme-light,select.theme-light,textarea.theme-light{background-color:#fff;border:1px solid #96a8c0;color:#283853}.theme-light .input[type=email]:focus,.theme-light .input[type=file]:focus,.theme-light .input[type=number]:focus,.theme-light .input[type=password]:focus,.theme-light .input[type=text]:focus,.theme-light .input[type=url]:focus,.theme-light select.input:focus,.theme-light textarea.input:focus,input.theme-light:focus,select.theme-light:focus,textarea.theme-light:focus{background-color:#fff}.theme-light .input[type=email]::-moz-placeholder,.theme-light .input[type=file]::-moz-placeholder,.theme-light .input[type=number]::-moz-placeholder,.theme-light .input[type=password]::-moz-placeholder,.theme-light .input[type=text]::-moz-placeholder,.theme-light .input[type=url]::-moz-placeholder,.theme-light select.input::-moz-placeholder,.theme-light textarea.input::-moz-placeholder,input.theme-light::-moz-placeholder,select.theme-light::-moz-placeholder,textarea.theme-light::-moz-placeholder{color:rgba(55,74,104,.5)}.theme-light .input[type=email]:-ms-input-placeholder,.theme-light .input[type=file]:-ms-input-placeholder,.theme-light .input[type=number]:-ms-input-placeholder,.theme-light .input[type=password]:-ms-input-placeholder,.theme-light .input[type=text]:-ms-input-placeholder,.theme-light .input[type=url]:-ms-input-placeholder,.theme-light select.input:-ms-input-placeholder,.theme-light textarea.input:-ms-input-placeholder,input.theme-light:-ms-input-placeholder,select.theme-light:-ms-input-placeholder,textarea.theme-light:-ms-input-placeholder{color:rgba(55,74,104,.5)}.theme-light .input[type=email]::placeholder,.theme-light .input[type=file]::placeholder,.theme-light .input[type=number]::placeholder,.theme-light .input[type=password]::placeholder,.theme-light .input[type=text]::placeholder,.theme-light .input[type=url]::placeholder,.theme-light select.input::placeholder,.theme-light textarea.input::placeholder,input.theme-light::placeholder,select.theme-light::placeholder,textarea.theme-light::placeholder{color:rgba(55,74,104,.5)}.rich-text-edit{border-radius:4px;padding:0;position:relative}.rich-text-edit__toolbar{display:none;border-top:none;border-bottom-left-radius:4px;border-bottom-right-radius:4px}.rich-text-edit__editor{font-size:12px;border-bottom:none!important}.rich-text-edit__editor--text{border:none!important;box-shadow:none!important;display:inline-block;height:1em}.rich-text-edit__editor--textarea{border:none!important;box-shadow:none!important;overflow:auto}.rich-text-edit__editor--resizeable{resize:vertical}.rich-text-edit--inline{display:flex;flex-direction:column}.rich-text-edit--inline .rich-text-edit__toolbar{display:block}.theme-dark .rich-text-edit,.theme-dark .rich-text-edit__editor--text,.theme-dark .rich-text-edit__editor--textarea{background-color:#101823;border:1px solid #374a68;color:#fff}.theme-light .rich-text-edit{background-color:#fff;border:1px solid #96a8c0;color:#283853}.theme-light .rich-text-edit:focus{background-color:#fff}.theme-light .rich-text-edit::-moz-placeholder{color:rgba(55,74,104,.5)}.theme-light .rich-text-edit:-ms-input-placeholder{color:rgba(55,74,104,.5)}.theme-light .rich-text-edit::placeholder{color:rgba(55,74,104,.5)}.theme-light .rich-text-edit__editor--text,.theme-light .rich-text-edit__editor--textarea{background-color:#fff;border:1px solid #96a8c0;color:#283853}.theme-light .rich-text-edit__editor--text:focus,.theme-light .rich-text-edit__editor--textarea:focus{background-color:#fff}.theme-light .rich-text-edit__editor--text::-moz-placeholder,.theme-light .rich-text-edit__editor--textarea::-moz-placeholder{color:rgba(55,74,104,.5)}.theme-light .rich-text-edit__editor--text:-ms-input-placeholder,.theme-light .rich-text-edit__editor--textarea:-ms-input-placeholder{color:rgba(55,74,104,.5)}.theme-light .rich-text-edit__editor--text::placeholder,.theme-light .rich-text-edit__editor--textarea::placeholder{color:rgba(55,74,104,.5)}",'.medium-editor-anchor-preview,.medium-editor-toolbar{font-family:Helvetica Neue,Helvetica,Arial,sans-serif;font-size:16px;z-index:2000}@keyframes medium-editor-image-loading{0%{transform:scale(0)}to{transform:scale(1)}}@keyframes medium-editor-pop-upwards{0%{opacity:0;transform:matrix(.97,0,0,1,0,12)}20%{opacity:.7;transform:matrix(.99,0,0,1,0,2)}40%{opacity:1;transform:matrix(1,0,0,1,0,-1)}to{transform:matrix(1,0,0,1,0,0)}}.medium-editor-anchor-preview{left:0;line-height:1.4;max-width:280px;position:absolute;text-align:center;top:0;word-break:break-all;word-wrap:break-word;visibility:hidden}.medium-editor-anchor-preview a{color:#fff;display:inline-block;margin:5px 5px 10px}.medium-editor-placeholder-relative:after,.medium-editor-placeholder:after{content:attr(data-placeholder)!important;white-space:pre;padding:inherit;margin:inherit;font-style:italic}.medium-editor-anchor-preview-active{visibility:visible}.medium-editor-dragover{background:#ddd}.medium-editor-image-loading{animation:medium-editor-image-loading 1s ease-in-out infinite;background-color:#333;border-radius:100%;display:inline-block;height:40px;width:40px}.medium-editor-placeholder{position:relative}.medium-editor-placeholder:after{position:absolute;left:0;top:0}.medium-editor-placeholder-relative,.medium-editor-placeholder-relative:after{position:relative}.medium-toolbar-arrow-over:before,.medium-toolbar-arrow-under:after{border-style:solid;content:"";display:block;height:0;left:50%;margin-left:-8px;position:absolute;width:0}.medium-toolbar-arrow-under:after{border-width:8px 8px 0}.medium-toolbar-arrow-over:before{border-width:0 8px 8px;top:-8px}.medium-editor-toolbar{left:0;position:absolute;top:0;visibility:hidden}.medium-editor-toolbar ul{margin:0;padding:0}.medium-editor-toolbar li{float:left;list-style:none;margin:0;padding:0}.medium-editor-toolbar li button{box-sizing:border-box;cursor:pointer;display:block;font-size:14px;line-height:1.33;margin:0;padding:15px;text-decoration:none}.medium-editor-toolbar li button:focus{outline:0}.medium-editor-toolbar li .medium-editor-action-underline{text-decoration:underline}.medium-editor-toolbar li .medium-editor-action-pre{font-family:Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;font-weight:100;padding:15px 0}.medium-editor-toolbar-active{visibility:visible}.medium-editor-sticky-toolbar{position:fixed;top:1px}.medium-editor-relative-toolbar{position:relative}.medium-editor-toolbar-active.medium-editor-stalker-toolbar{animation:medium-editor-pop-upwards .16s linear forwards}.medium-editor-action-bold{font-weight:bolder}.medium-editor-action-italic{font-style:italic}.medium-editor-toolbar-form{display:none}.medium-editor-toolbar-form a,.medium-editor-toolbar-form input{font-family:Helvetica Neue,Helvetica,Arial,sans-serif}.medium-editor-toolbar-form .medium-editor-toolbar-form-row{line-height:14px;margin-left:5px;padding-bottom:5px}.medium-editor-toolbar-form .medium-editor-toolbar-input,.medium-editor-toolbar-form label{border:none;box-sizing:border-box;font-size:14px;margin:0;padding:6px;width:316px;display:inline-block}.medium-editor-toolbar-form .medium-editor-toolbar-input:focus,.medium-editor-toolbar-form label:focus{-webkit-appearance:none;-moz-appearance:none;appearance:none;border:none;box-shadow:none;outline:0}.medium-editor-toolbar-form a{display:inline-block;font-size:24px;font-weight:bolder;margin:0 10px;text-decoration:none}.medium-editor-toolbar-form-active{display:block}.medium-editor-toolbar-actions:after{clear:both;content:"";display:table}.medium-editor-element{word-wrap:break-word;min-height:30px}.medium-editor-element img{max-width:100%}.medium-editor-element sub{vertical-align:sub}.medium-editor-element sup{vertical-align:super}.medium-editor-hidden{display:none}',".input,.medium-editor-toolbar-form :root [type=email].medium-editor-toolbar-input,.medium-editor-toolbar-form :root [type=file].medium-editor-toolbar-input,.medium-editor-toolbar-form :root [type=number].medium-editor-toolbar-input,.medium-editor-toolbar-form :root [type=password].medium-editor-toolbar-input,.medium-editor-toolbar-form :root [type=text].medium-editor-toolbar-input,.medium-editor-toolbar-form :root [type=url].medium-editor-toolbar-input,.medium-editor-toolbar-form :root select.medium-editor-toolbar-input,.medium-editor-toolbar-form :root textarea.medium-editor-toolbar-input,:root .medium-editor-toolbar-form .medium-editor-toolbar-input,[type=email].input,[type=file].input,[type=number].input,[type=password].input,[type=text].input,[type=url].input,select.input,textarea.input{border:1px solid #1b283c;border-radius:4px;background-color:#101823;color:#fff;display:block;min-height:36px;width:100%;font-size:12px;padding:8px 12px;font-family:Inter UI,sans-serif}@supports (font-variation-settings:normal){.input,.medium-editor-toolbar-form :root [type=email].medium-editor-toolbar-input,.medium-editor-toolbar-form :root [type=file].medium-editor-toolbar-input,.medium-editor-toolbar-form :root [type=number].medium-editor-toolbar-input,.medium-editor-toolbar-form :root [type=password].medium-editor-toolbar-input,.medium-editor-toolbar-form :root [type=text].medium-editor-toolbar-input,.medium-editor-toolbar-form :root [type=url].medium-editor-toolbar-input,.medium-editor-toolbar-form :root select.medium-editor-toolbar-input,.medium-editor-toolbar-form :root textarea.medium-editor-toolbar-input,:root .medium-editor-toolbar-form .medium-editor-toolbar-input,[type=email].input,[type=file].input,[type=number].input,[type=password].input,[type=text].input,[type=url].input,select.input,textarea.input{font-family:Inter UI var alt,sans-serif}}.input:focus,.medium-editor-toolbar-form :root .medium-editor-toolbar-input:focus,:root .medium-editor-toolbar-form .medium-editor-toolbar-input:focus,[type=email].input:focus,[type=file].input:focus,[type=number].input:focus,[type=password].input:focus,[type=text].input:focus,[type=url].input:focus,select.input:focus,textarea.input:focus{outline:2px solid #2d72dc!important}.input:focus.ng-invalid,.medium-editor-toolbar-form :root .medium-editor-toolbar-input:focus.ng-invalid,:root .medium-editor-toolbar-form .medium-editor-toolbar-input:focus.ng-invalid,[type=email].input:focus.ng-invalid,[type=file].input:focus.ng-invalid,[type=number].input:focus.ng-invalid,[type=password].input:focus.ng-invalid,[type=text].input:focus.ng-invalid,[type=url].input:focus.ng-invalid,select.input:focus.ng-invalid,textarea.input:focus.ng-invalid{outline-color:#ed4758!important;outline-width:1px!important}.input--small,[type=email].input--small,[type=file].input--small,[type=number].input--small,[type=password].input--small,[type=text].input--small,[type=url].input--small,select.input--small,textarea.input--small{font-size:12px;padding:8px;min-height:auto}.input--large,[type=email].input--large,[type=file].input--large,[type=number].input--large,[type=password].input--large,[type=text].input--large,[type=url].input--large,select.input--large,textarea.input--large{font-size:16px;padding:12px}.input--success,[type=email].input--success,[type=file].input--success,[type=number].input--success,[type=password].input--success,[type=text].input--success,[type=url].input--success,select.input--success,textarea.input--success{border-color:#38de38!important}.input:disabled,.medium-editor-toolbar-form :root .medium-editor-toolbar-input:disabled,:root .medium-editor-toolbar-form .medium-editor-toolbar-input:disabled,[type=email].input:disabled,[type=file].input:disabled,[type=number].input:disabled,[type=password].input:disabled,[type=text].input:disabled,[type=url].input:disabled,select.input:disabled,textarea.input:disabled{opacity:.4}.input.ng-dirty.ng-invalid,.medium-editor-toolbar-form :root .ng-dirty.ng-invalid.medium-editor-toolbar-input,:root .medium-editor-toolbar-form .ng-dirty.ng-invalid.medium-editor-toolbar-input,[type=email].input.ng-dirty.ng-invalid,[type=file].input.ng-dirty.ng-invalid,[type=number].input.ng-dirty.ng-invalid,[type=password].input.ng-dirty.ng-invalid,[type=text].input.ng-dirty.ng-invalid,[type=url].input.ng-dirty.ng-invalid,select.input.ng-dirty.ng-invalid,textarea.input.ng-dirty.ng-invalid{border:1px solid #ed4758}textarea.input--nonresizable{resize:none}.medium-editor-toolbar-form :root select.medium-editor-toolbar-input,:root .medium-editor-toolbar-form select.medium-editor-toolbar-input,select.input{height:36px}.medium-editor-toolbar-form :root .theme-dark [type=email].medium-editor-toolbar-input,.medium-editor-toolbar-form :root .theme-dark [type=file].medium-editor-toolbar-input,.medium-editor-toolbar-form :root .theme-dark [type=number].medium-editor-toolbar-input,.medium-editor-toolbar-form :root .theme-dark [type=password].medium-editor-toolbar-input,.medium-editor-toolbar-form :root .theme-dark [type=text].medium-editor-toolbar-input,.medium-editor-toolbar-form :root .theme-dark [type=url].medium-editor-toolbar-input,.medium-editor-toolbar-form :root .theme-dark select.medium-editor-toolbar-input,.medium-editor-toolbar-form :root .theme-dark textarea.medium-editor-toolbar-input,.theme-dark .input[type=email],.theme-dark .input[type=file],.theme-dark .input[type=number],.theme-dark .input[type=password],.theme-dark .input[type=text],.theme-dark .input[type=url],.theme-dark .medium-editor-toolbar-form :root [type=email].medium-editor-toolbar-input,.theme-dark .medium-editor-toolbar-form :root [type=file].medium-editor-toolbar-input,.theme-dark .medium-editor-toolbar-form :root [type=number].medium-editor-toolbar-input,.theme-dark .medium-editor-toolbar-form :root [type=password].medium-editor-toolbar-input,.theme-dark .medium-editor-toolbar-form :root [type=text].medium-editor-toolbar-input,.theme-dark .medium-editor-toolbar-form :root [type=url].medium-editor-toolbar-input,.theme-dark .medium-editor-toolbar-form :root select.medium-editor-toolbar-input,.theme-dark .medium-editor-toolbar-form :root textarea.medium-editor-toolbar-input,.theme-dark select.input,.theme-dark textarea.input,:root .theme-dark .medium-editor-toolbar-form [type=email].medium-editor-toolbar-input,:root .theme-dark .medium-editor-toolbar-form [type=file].medium-editor-toolbar-input,:root .theme-dark .medium-editor-toolbar-form [type=number].medium-editor-toolbar-input,:root .theme-dark .medium-editor-toolbar-form [type=password].medium-editor-toolbar-input,:root .theme-dark .medium-editor-toolbar-form [type=text].medium-editor-toolbar-input,:root .theme-dark .medium-editor-toolbar-form [type=url].medium-editor-toolbar-input,:root .theme-dark .medium-editor-toolbar-form select.medium-editor-toolbar-input,:root .theme-dark .medium-editor-toolbar-form textarea.medium-editor-toolbar-input,input.theme-dark,select.theme-dark,textarea.theme-dark{background-color:#101823;border:1px solid #374a68;color:#fff}.medium-editor-toolbar-form :root .theme-light [type=email].medium-editor-toolbar-input,.medium-editor-toolbar-form :root .theme-light [type=file].medium-editor-toolbar-input,.medium-editor-toolbar-form :root .theme-light [type=number].medium-editor-toolbar-input,.medium-editor-toolbar-form :root .theme-light [type=password].medium-editor-toolbar-input,.medium-editor-toolbar-form :root .theme-light [type=text].medium-editor-toolbar-input,.medium-editor-toolbar-form :root .theme-light [type=url].medium-editor-toolbar-input,.medium-editor-toolbar-form :root .theme-light select.medium-editor-toolbar-input,.medium-editor-toolbar-form :root .theme-light textarea.medium-editor-toolbar-input,.theme-light .input[type=email],.theme-light .input[type=file],.theme-light .input[type=number],.theme-light .input[type=password],.theme-light .input[type=text],.theme-light .input[type=url],.theme-light .medium-editor-toolbar-form :root [type=email].medium-editor-toolbar-input,.theme-light .medium-editor-toolbar-form :root [type=file].medium-editor-toolbar-input,.theme-light .medium-editor-toolbar-form :root [type=number].medium-editor-toolbar-input,.theme-light .medium-editor-toolbar-form :root [type=password].medium-editor-toolbar-input,.theme-light .medium-editor-toolbar-form :root [type=text].medium-editor-toolbar-input,.theme-light .medium-editor-toolbar-form :root [type=url].medium-editor-toolbar-input,.theme-light .medium-editor-toolbar-form :root select.medium-editor-toolbar-input,.theme-light .medium-editor-toolbar-form :root textarea.medium-editor-toolbar-input,.theme-light select.input,.theme-light textarea.input,:root .theme-light .medium-editor-toolbar-form [type=email].medium-editor-toolbar-input,:root .theme-light .medium-editor-toolbar-form [type=file].medium-editor-toolbar-input,:root .theme-light .medium-editor-toolbar-form [type=number].medium-editor-toolbar-input,:root .theme-light .medium-editor-toolbar-form [type=password].medium-editor-toolbar-input,:root .theme-light .medium-editor-toolbar-form [type=text].medium-editor-toolbar-input,:root .theme-light .medium-editor-toolbar-form [type=url].medium-editor-toolbar-input,:root .theme-light .medium-editor-toolbar-form select.medium-editor-toolbar-input,:root .theme-light .medium-editor-toolbar-form textarea.medium-editor-toolbar-input,input.theme-light,select.theme-light,textarea.theme-light{background-color:#fff;border:1px solid #96a8c0;color:#283853}.medium-editor-toolbar-form :root .theme-light [type=email].medium-editor-toolbar-input:focus,.medium-editor-toolbar-form :root .theme-light [type=file].medium-editor-toolbar-input:focus,.medium-editor-toolbar-form :root .theme-light [type=number].medium-editor-toolbar-input:focus,.medium-editor-toolbar-form :root .theme-light [type=password].medium-editor-toolbar-input:focus,.medium-editor-toolbar-form :root .theme-light [type=text].medium-editor-toolbar-input:focus,.medium-editor-toolbar-form :root .theme-light [type=url].medium-editor-toolbar-input:focus,.medium-editor-toolbar-form :root .theme-light select.medium-editor-toolbar-input:focus,.medium-editor-toolbar-form :root .theme-light textarea.medium-editor-toolbar-input:focus,.theme-light .input[type=email]:focus,.theme-light .input[type=file]:focus,.theme-light .input[type=number]:focus,.theme-light .input[type=password]:focus,.theme-light .input[type=text]:focus,.theme-light .input[type=url]:focus,.theme-light .medium-editor-toolbar-form :root [type=email].medium-editor-toolbar-input:focus,.theme-light .medium-editor-toolbar-form :root [type=file].medium-editor-toolbar-input:focus,.theme-light .medium-editor-toolbar-form :root [type=number].medium-editor-toolbar-input:focus,.theme-light .medium-editor-toolbar-form :root [type=password].medium-editor-toolbar-input:focus,.theme-light .medium-editor-toolbar-form :root [type=text].medium-editor-toolbar-input:focus,.theme-light .medium-editor-toolbar-form :root [type=url].medium-editor-toolbar-input:focus,.theme-light .medium-editor-toolbar-form :root select.medium-editor-toolbar-input:focus,.theme-light .medium-editor-toolbar-form :root textarea.medium-editor-toolbar-input:focus,.theme-light select.input:focus,.theme-light textarea.input:focus,:root .theme-light .medium-editor-toolbar-form [type=email].medium-editor-toolbar-input:focus,:root .theme-light .medium-editor-toolbar-form [type=file].medium-editor-toolbar-input:focus,:root .theme-light .medium-editor-toolbar-form [type=number].medium-editor-toolbar-input:focus,:root .theme-light .medium-editor-toolbar-form [type=password].medium-editor-toolbar-input:focus,:root .theme-light .medium-editor-toolbar-form [type=text].medium-editor-toolbar-input:focus,:root .theme-light .medium-editor-toolbar-form [type=url].medium-editor-toolbar-input:focus,:root .theme-light .medium-editor-toolbar-form select.medium-editor-toolbar-input:focus,:root .theme-light .medium-editor-toolbar-form textarea.medium-editor-toolbar-input:focus,input.theme-light:focus,select.theme-light:focus,textarea.theme-light:focus{background-color:#fff}.medium-editor-toolbar-form :root .theme-light [type=email].medium-editor-toolbar-input::-moz-placeholder,.medium-editor-toolbar-form :root .theme-light [type=file].medium-editor-toolbar-input::-moz-placeholder,.medium-editor-toolbar-form :root .theme-light [type=number].medium-editor-toolbar-input::-moz-placeholder,.medium-editor-toolbar-form :root .theme-light [type=password].medium-editor-toolbar-input::-moz-placeholder,.medium-editor-toolbar-form :root .theme-light [type=text].medium-editor-toolbar-input::-moz-placeholder,.medium-editor-toolbar-form :root .theme-light [type=url].medium-editor-toolbar-input::-moz-placeholder,.medium-editor-toolbar-form :root .theme-light select.medium-editor-toolbar-input::-moz-placeholder,.medium-editor-toolbar-form :root .theme-light textarea.medium-editor-toolbar-input::-moz-placeholder,.theme-light .input[type=email]::-moz-placeholder,.theme-light .input[type=file]::-moz-placeholder,.theme-light .input[type=number]::-moz-placeholder,.theme-light .input[type=password]::-moz-placeholder,.theme-light .input[type=text]::-moz-placeholder,.theme-light .input[type=url]::-moz-placeholder,.theme-light .medium-editor-toolbar-form :root [type=email].medium-editor-toolbar-input::-moz-placeholder,.theme-light .medium-editor-toolbar-form :root [type=file].medium-editor-toolbar-input::-moz-placeholder,.theme-light .medium-editor-toolbar-form :root [type=number].medium-editor-toolbar-input::-moz-placeholder,.theme-light .medium-editor-toolbar-form :root [type=password].medium-editor-toolbar-input::-moz-placeholder,.theme-light .medium-editor-toolbar-form :root [type=text].medium-editor-toolbar-input::-moz-placeholder,.theme-light .medium-editor-toolbar-form :root [type=url].medium-editor-toolbar-input::-moz-placeholder,.theme-light .medium-editor-toolbar-form :root select.medium-editor-toolbar-input::-moz-placeholder,.theme-light .medium-editor-toolbar-form :root textarea.medium-editor-toolbar-input::-moz-placeholder,.theme-light select.input::-moz-placeholder,.theme-light textarea.input::-moz-placeholder,:root .theme-light .medium-editor-toolbar-form [type=email].medium-editor-toolbar-input::-moz-placeholder,:root .theme-light .medium-editor-toolbar-form [type=file].medium-editor-toolbar-input::-moz-placeholder,:root .theme-light .medium-editor-toolbar-form [type=number].medium-editor-toolbar-input::-moz-placeholder,:root .theme-light .medium-editor-toolbar-form [type=password].medium-editor-toolbar-input::-moz-placeholder,:root .theme-light .medium-editor-toolbar-form [type=text].medium-editor-toolbar-input::-moz-placeholder,:root .theme-light .medium-editor-toolbar-form [type=url].medium-editor-toolbar-input::-moz-placeholder,:root .theme-light .medium-editor-toolbar-form select.medium-editor-toolbar-input::-moz-placeholder,:root .theme-light .medium-editor-toolbar-form textarea.medium-editor-toolbar-input::-moz-placeholder,input.theme-light::-moz-placeholder,select.theme-light::-moz-placeholder,textarea.theme-light::-moz-placeholder{color:rgba(55,74,104,.5)}.medium-editor-toolbar-form :root .theme-light [type=email].medium-editor-toolbar-input:-ms-input-placeholder,.medium-editor-toolbar-form :root .theme-light [type=file].medium-editor-toolbar-input:-ms-input-placeholder,.medium-editor-toolbar-form :root .theme-light [type=number].medium-editor-toolbar-input:-ms-input-placeholder,.medium-editor-toolbar-form :root .theme-light [type=password].medium-editor-toolbar-input:-ms-input-placeholder,.medium-editor-toolbar-form :root .theme-light [type=text].medium-editor-toolbar-input:-ms-input-placeholder,.medium-editor-toolbar-form :root .theme-light [type=url].medium-editor-toolbar-input:-ms-input-placeholder,.medium-editor-toolbar-form :root .theme-light select.medium-editor-toolbar-input:-ms-input-placeholder,.medium-editor-toolbar-form :root .theme-light textarea.medium-editor-toolbar-input:-ms-input-placeholder,.theme-light .input[type=email]:-ms-input-placeholder,.theme-light .input[type=file]:-ms-input-placeholder,.theme-light .input[type=number]:-ms-input-placeholder,.theme-light .input[type=password]:-ms-input-placeholder,.theme-light .input[type=text]:-ms-input-placeholder,.theme-light .input[type=url]:-ms-input-placeholder,.theme-light .medium-editor-toolbar-form :root [type=email].medium-editor-toolbar-input:-ms-input-placeholder,.theme-light .medium-editor-toolbar-form :root [type=file].medium-editor-toolbar-input:-ms-input-placeholder,.theme-light .medium-editor-toolbar-form :root [type=number].medium-editor-toolbar-input:-ms-input-placeholder,.theme-light .medium-editor-toolbar-form :root [type=password].medium-editor-toolbar-input:-ms-input-placeholder,.theme-light .medium-editor-toolbar-form :root [type=text].medium-editor-toolbar-input:-ms-input-placeholder,.theme-light .medium-editor-toolbar-form :root [type=url].medium-editor-toolbar-input:-ms-input-placeholder,.theme-light .medium-editor-toolbar-form :root select.medium-editor-toolbar-input:-ms-input-placeholder,.theme-light .medium-editor-toolbar-form :root textarea.medium-editor-toolbar-input:-ms-input-placeholder,.theme-light select.input:-ms-input-placeholder,.theme-light textarea.input:-ms-input-placeholder,:root .theme-light .medium-editor-toolbar-form [type=email].medium-editor-toolbar-input:-ms-input-placeholder,:root .theme-light .medium-editor-toolbar-form [type=file].medium-editor-toolbar-input:-ms-input-placeholder,:root .theme-light .medium-editor-toolbar-form [type=number].medium-editor-toolbar-input:-ms-input-placeholder,:root .theme-light .medium-editor-toolbar-form [type=password].medium-editor-toolbar-input:-ms-input-placeholder,:root .theme-light .medium-editor-toolbar-form [type=text].medium-editor-toolbar-input:-ms-input-placeholder,:root .theme-light .medium-editor-toolbar-form [type=url].medium-editor-toolbar-input:-ms-input-placeholder,:root .theme-light .medium-editor-toolbar-form select.medium-editor-toolbar-input:-ms-input-placeholder,:root .theme-light .medium-editor-toolbar-form textarea.medium-editor-toolbar-input:-ms-input-placeholder,input.theme-light:-ms-input-placeholder,select.theme-light:-ms-input-placeholder,textarea.theme-light:-ms-input-placeholder{color:rgba(55,74,104,.5)}.medium-editor-toolbar-form :root .theme-light [type=email].medium-editor-toolbar-input::placeholder,.medium-editor-toolbar-form :root .theme-light [type=file].medium-editor-toolbar-input::placeholder,.medium-editor-toolbar-form :root .theme-light [type=number].medium-editor-toolbar-input::placeholder,.medium-editor-toolbar-form :root .theme-light [type=password].medium-editor-toolbar-input::placeholder,.medium-editor-toolbar-form :root .theme-light [type=text].medium-editor-toolbar-input::placeholder,.medium-editor-toolbar-form :root .theme-light [type=url].medium-editor-toolbar-input::placeholder,.medium-editor-toolbar-form :root .theme-light select.medium-editor-toolbar-input::placeholder,.medium-editor-toolbar-form :root .theme-light textarea.medium-editor-toolbar-input::placeholder,.theme-light .input[type=email]::placeholder,.theme-light .input[type=file]::placeholder,.theme-light .input[type=number]::placeholder,.theme-light .input[type=password]::placeholder,.theme-light .input[type=text]::placeholder,.theme-light .input[type=url]::placeholder,.theme-light .medium-editor-toolbar-form :root [type=email].medium-editor-toolbar-input::placeholder,.theme-light .medium-editor-toolbar-form :root [type=file].medium-editor-toolbar-input::placeholder,.theme-light .medium-editor-toolbar-form :root [type=number].medium-editor-toolbar-input::placeholder,.theme-light .medium-editor-toolbar-form :root [type=password].medium-editor-toolbar-input::placeholder,.theme-light .medium-editor-toolbar-form :root [type=text].medium-editor-toolbar-input::placeholder,.theme-light .medium-editor-toolbar-form :root [type=url].medium-editor-toolbar-input::placeholder,.theme-light .medium-editor-toolbar-form :root select.medium-editor-toolbar-input::placeholder,.theme-light .medium-editor-toolbar-form :root textarea.medium-editor-toolbar-input::placeholder,.theme-light select.input::placeholder,.theme-light textarea.input::placeholder,:root .theme-light .medium-editor-toolbar-form [type=email].medium-editor-toolbar-input::placeholder,:root .theme-light .medium-editor-toolbar-form [type=file].medium-editor-toolbar-input::placeholder,:root .theme-light .medium-editor-toolbar-form [type=number].medium-editor-toolbar-input::placeholder,:root .theme-light .medium-editor-toolbar-form [type=password].medium-editor-toolbar-input::placeholder,:root .theme-light .medium-editor-toolbar-form [type=text].medium-editor-toolbar-input::placeholder,:root .theme-light .medium-editor-toolbar-form [type=url].medium-editor-toolbar-input::placeholder,:root .theme-light .medium-editor-toolbar-form select.medium-editor-toolbar-input::placeholder,:root .theme-light .medium-editor-toolbar-form textarea.medium-editor-toolbar-input::placeholder,input.theme-light::placeholder,select.theme-light::placeholder,textarea.theme-light::placeholder{color:rgba(55,74,104,.5)}:root{--medium-toolbar-color:#131c2a;--medium-font-color:$gray-60;--medium-hover-font-color:$gray-60;--medium-selected-font-color:$gray-70;--medium-toolbar-border-color:$gray-20}:root .medium-editor-element{min-height:inherit}:root .medium-editor-relative-toolbar.medium-editor-toolbar{visibility:visible!important}:root .medium-toolbar-arrow-under:after{top:36px;border-bottom:0;border-top:8px solid var(--medium-font-color)}:root .medium-toolbar-arrow-over:before,:root .medium-toolbar-arrow-under:after{width:0;height:0;border-left:8px solid transparent;border-right:8px solid transparent}:root .medium-toolbar-arrow-over:before{top:-8px;border-bottom:8px solid var(--medium-font-color);border-top:0}:root .medium-editor-toolbar{background-color:transparent;border-top:1px solid transparent;opacity:.3;z-index:500;margin-top:2px}:root .medium-editor-toolbar.medium-editor-stalker-toolbar{background-color:var(--medium-toolbar-color);border:1px solid var(--medium-toolbar-border-color);border-radius:4px;opacity:1}:root .medium-editor-toolbar li{margin:2px;padding:0}:root .medium-editor-toolbar li button{min-width:32px;height:32px;padding:8px;background-color:transparent;border:0;border-radius:0;color:var(--medium-font-color);transition:background-color .3s ease-in;font-size:12px}:root .medium-editor-action{color:var(--medium-font-color);border-top:1px solid transparent}:root .medium-editor-action:hover{color:var(--medium-hover-font-color);border-radius:4px}:root .medium-editor-action.medium-editor-button-active{color:var(--medium-selected-font-color)}:root .medium-editor-focused .medium-editor-toolbar{background-color:var(--medium-toolbar-color);border-top:1px solid var(--medium-toolbar-border-color);opacity:1}:root .medium-editor-compact .medium-editor-toolbar li{margin:0;padding:0}:root .medium-editor-compact .medium-editor-toolbar li button{min-width:30px;height:30px;padding:4px}:root .medium-editor-toolbar-form{padding:4px;border-radius:4px;color:var(--medium-selected-font-color)}:root .medium-editor-toolbar-form .medium-editor-toolbar-input{flex:1;box-sizing:border-box;color:var(--medium-selected-font-color)!important;background-color:var(--medium-toolbar-color)!important}:root .medium-editor-toolbar-form .medium-editor-toolbar-close,:root .medium-editor-toolbar-form .medium-editor-toolbar-save{margin:8px;padding:0;width:auto;height:auto;font-size:1em}:root .medium-editor-toolbar-form a{color:var(--medium-selected-font-color)}:root .medium-editor-toolbar-form-active{display:flex;flex-direction:row;align-items:center}:root .medium-editor-toolbar-anchor-preview{border-radius:4px;border:1px solid var(--medium-font-color);background-color:var(--medium-toolbar-color);color:var(--medium-font-color);font-size:12}:root .medium-editor-placeholder:after{color:var(--medium-font-color)}.theme-dark{--medium-toolbar-color:#131c2a;--medium-font-color:rgba(150,168,192,0.6);--medium-hover-font-color:rgba(150,168,192,0.8);--medium-selected-font-color:#d7e0ea;--medium-toolbar-border-color:#1c2a3f}.theme-light{--medium-toolbar-color:#f9fafd;--medium-font-color:rgba(40,56,83,0.6);--medium-hover-font-color:rgba(40,56,83,0.8);--medium-selected-font-color:#283853;--medium-toolbar-border-color:#d7e0ea}"],encapsulation:2,changeDetection:0}),ct),vt=o("5+WD"),yt=o("0njA"),xt=o("Fh29"),Ct=o("Qu3c");function kt(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"div",5),ve.Vb(1,"div",6),ve.Qb(2,"app-icon",7),ve.Ub(),ve.Vb(3,"div",8),ve.Vb(4,"app-form-field",9),ve.Qb(5,"app-content-upload-input",10),ve.Ub(),ve.Vb(6,"div",11),ve.Vb(7,"app-form-field",12),ve.Vb(8,"app-rich-text-edit",13,14),ve.Pc(10,"> "),ve.Ub(),ve.Qb(11,"app-character-counter",15),ve.Ub(),ve.Vb(12,"app-form-field",16),ve.Qb(13,"textarea",17),ve.Ub(),ve.Ub(),ve.Ub(),ve.Vb(14,"div",18),ve.Vb(15,"button",19),ve.cc("click",(function(){ve.Cc(n);var e=t.index;return ve.gc().handleRemoveImage(e)})),ve.Qb(16,"app-icon",20),ve.Ub(),ve.Ub(),ve.Ub()}if(2&e){var i=t.$implicit,o=ve.yc(9);ve.mc("formGroup",i),ve.Db(5),ve.mc("canDelete",!1),ve.Db(3),ve.mc("inline",!0)("compact",!0)("rows",1)("maxLength",100),ve.Db(3),ve.mc("field",o)}}var Pt,Ot=((Pt=function(){function e(t,n){l(this,e),this.controlContainer=t,this.formBuilder=n}return u(e,[{key:"imageBlockImages",get:function(){return this.controlContainer.control.get("images")}},{key:"ngOnInit",value:function(){}},{key:"handleAddImage",value:function(){var e=new de.b;this.imageBlockImages.push(this.addImage(e))}},{key:"addImage",value:function(e){return this.formBuilder.group({urls:e.urls,alt:[e.alt,ae.C.maxLength(200)],caption:[e.caption,ae.C.maxLength(200)]})}},{key:"handleRemoveImage",value:function(e){this.imageBlockImages.removeAt(e)}},{key:"handleImageDrop",value:function(e){var t=e.previousIndex,n=e.currentIndex,i=this.imageBlockImages.at(t);this.imageBlockImages.removeAt(t),this.imageBlockImages.insert(n,i)}}]),e}()).\u0275fac=function(e){return new(e||Pt)(ve.Pb(ae.b),ve.Pb(ae.f))},Pt.\u0275cmp=ve.Jb({type:Pt,selectors:[["app-edit-images-block"]],decls:7,vars:3,consts:[[3,"formGroup"],[1,"text-14","text-bold","mb-2"],["cdkDropList","","cdkDropListOrientation","vertical","formArrayName","images",3,"cdkDropListDropped"],["cdkDrag","","class","edit-block theme-light",3,"formGroup",4,"ngFor","ngForOf"],["app-button","","buttonType","outline","buttonTheme","light","type","button",1,"w-25",3,"expanded","click"],["cdkDrag","",1,"edit-block","theme-light",3,"formGroup"],["cdkDragHandle","",1,"edit-block__handle"],["icon","grip-lines"],[1,"edit-block__body","flex"],["label","Image",1,"pr-1",2,"flex","0 0 240px"],["type","image","formControlName","urls",3,"canDelete"],[1,"flex-grow"],["label","Label"],["mode","basic","formControlName","caption",3,"inline","compact","rows","maxLength"],["caption",""],[3,"field"],["label","Alt"],["formControlName","alt",1,"input"],[1,"edit-block__actions"],["app-button","","buttonTheme","light","buttonShape","circle","matTooltip","Remove Image",3,"click"],["icon","times"]],template:function(e,t){1&e&&(ve.Tb(0,0),ve.Vb(1,"div",1),ve.Pc(2,"Images"),ve.Ub(),ve.Vb(3,"div",2),ve.cc("cdkDropListDropped",(function(e){return t.handleImageDrop(e)})),ve.Nc(4,kt,17,7,"div",3),ve.Vb(5,"button",4),ve.cc("click",(function(){return t.handleAddImage()})),ve.Pc(6," Add Image "),ve.Ub(),ve.Ub(),ve.Sb()),2&e&&(ve.mc("formGroup",t.controlContainer.control),ve.Db(4),ve.mc("ngForOf",t.imageBlockImages.controls),ve.Db(1),ve.mc("expanded",!0))},directives:[ae.s,ae.j,vt.c,ae.e,f.o,Pe.a,vt.a,vt.b,yt.a,Oe.a,xt.a,ae.r,ae.i,gt,we.a,ae.c,Ct.c],styles:[".edit-block[_ngcontent-%COMP%]{background:#f9fafd;padding:8px;margin-bottom:8px;display:flex}.edit-block__handle[_ngcontent-%COMP%]{align-items:flex-start;flex:0 0 40px;display:flex;justify-content:center}.edit-block__handle[_ngcontent-%COMP%]:hover{cursor:-webkit-grab;cursor:grab}.edit-block__actions[_ngcontent-%COMP%]{align-items:flex-start;flex:0 0 40px;display:flex;justify-content:center}.edit-block__body[_ngcontent-%COMP%]{flex:1 0 auto}"],changeDetection:0}),Pt),wt=o("1w2z");function St(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"div",8),ve.Vb(1,"div",9),ve.Qb(2,"app-icon",10),ve.Ub(),ve.Vb(3,"div",11),ve.Vb(4,"app-form-field",12),ve.Qb(5,"app-content-upload-input",13),ve.Ub(),ve.Vb(6,"app-form-field",14),ve.Vb(7,"app-rich-text-edit",15,16),ve.Pc(9,"> "),ve.Ub(),ve.Qb(10,"app-character-counter",17),ve.Ub(),ve.Ub(),ve.Vb(11,"div",18),ve.Vb(12,"button",19),ve.cc("click",(function(){ve.Cc(n);var e=t.index;return ve.gc().handleRemoveImage(e)})),ve.Qb(13,"app-icon",20),ve.Ub(),ve.Ub(),ve.Ub()}if(2&e){var i=t.$implicit,o=ve.yc(8);ve.mc("formGroup",i),ve.Db(5),ve.mc("canDelete",!1),ve.Db(2),ve.mc("inline",!0)("compact",!0)("rows",1)("maxLength",100),ve.Db(3),ve.mc("field",o)}}var _t,Mt,Ut=((_t=function(){function e(t,n){l(this,e),this.controlContainer=t,this.formBuilder=n}return u(e,[{key:"images",get:function(){return this.controlContainer.control.get("images")}},{key:"ngOnInit",value:function(){}},{key:"handleAddImage",value:function(){var e=new be.b;this.images.push(this.addBlock(e))}},{key:"addBlock",value:function(e){return this.formBuilder.group({urls:e.urls,alt:[e.alt,ae.C.maxLength(200)],caption:[e.caption,ae.C.maxLength(200)]})}},{key:"handleRemoveImage",value:function(e){this.images.removeAt(e)}},{key:"handleImageDrop",value:function(e){var t=e.previousIndex,n=e.currentIndex,i=this.images.at(t);this.images.removeAt(t),this.images.insert(n,i)}}]),e}()).\u0275fac=function(e){return new(e||_t)(ve.Pb(ae.b),ve.Pb(ae.f))},_t.\u0275cmp=ve.Jb({type:_t,selectors:[["app-edit-ticker-block"]],decls:12,vars:3,consts:[[3,"formGroup"],[1,"text-14","text-bold","mb-2"],["label","Loop Image",1,"flex-grow"],["formControlName","loopImage",1,"text-12"],["form-field-help",""],["cdkDropList","","cdkDropListOrientation","vertical","formArrayName","images",3,"cdkDropListDropped"],["cdkDrag","","class","edit-block theme-light",3,"formGroup",4,"ngFor","ngForOf"],["app-button","","buttonType","outline","buttonTheme","light","type","button",1,"w-25",3,"expanded","click"],["cdkDrag","",1,"edit-block","theme-light",3,"formGroup"],["cdkDragHandle","",1,"edit-block__handle"],["icon","grip-lines"],[1,"edit-block__body","flex"],["label","Image",1,"pr-1",2,"flex","0 0 240px"],["type","image","formControlName","urls",3,"canDelete"],["label","Label",1,"flex-grow"],["mode","basic","formControlName","caption",3,"inline","compact","rows","maxLength"],["caption",""],[3,"field"],[1,"edit-block__actions"],["app-button","","buttonTheme","light","buttonShape","circle","matTooltip","Remove Image",3,"click"],["icon","times"]],template:function(e,t){1&e&&(ve.Tb(0,0),ve.Vb(1,"div",1),ve.Pc(2,"Ticker"),ve.Ub(),ve.Vb(3,"app-form-field",2),ve.Vb(4,"mat-checkbox",3),ve.Pc(5,"Loop"),ve.Ub(),ve.Tb(6,4),ve.Pc(7," Creates the appearance of a continuous uninterrupted image "),ve.Sb(),ve.Ub(),ve.Vb(8,"div",5),ve.cc("cdkDropListDropped",(function(e){return t.handleImageDrop(e)})),ve.Nc(9,St,14,7,"div",6),ve.Vb(10,"button",7),ve.cc("click",(function(){return t.handleAddImage()})),ve.Pc(11," Add Ticker Image "),ve.Ub(),ve.Ub(),ve.Sb()),2&e&&(ve.mc("formGroup",t.controlContainer.control),ve.Db(9),ve.mc("ngForOf",t.images.controls),ve.Db(1),ve.mc("expanded",!0))},directives:[ae.s,ae.j,Oe.a,Ue.a,ae.r,ae.i,vt.c,ae.e,f.o,Pe.a,vt.a,vt.b,yt.a,xt.a,gt,we.a,Ct.c],styles:[".edit-block[_ngcontent-%COMP%]{background:#f9fafd;padding:8px;margin-bottom:8px;display:flex}.edit-block__handle[_ngcontent-%COMP%]{align-items:flex-start;flex:0 0 40px;display:flex;justify-content:center}.edit-block__handle[_ngcontent-%COMP%]:hover{cursor:-webkit-grab;cursor:grab}.edit-block__actions[_ngcontent-%COMP%]{align-items:flex-start;flex:0 0 40px;display:flex;justify-content:center}.edit-block__body[_ngcontent-%COMP%]{flex:1 0 auto}"],changeDetection:0}),_t),Tt=o("R9Cn"),Vt=((Mt=function(){function e(t){l(this,e),this.changeDetectorRef=t,this.colorPosition="left",this.useRootContainer=!0,this.dataTestAttributeVal="",this.type="hex",this.decimal=!0,this.alpha=!1,this.disabled=!1,this.onChange=function(){},this.onTouched=function(){},this.propagateChange=function(e){}}return u(e,[{key:"value",get:function(){return this.getColorFromHex(this._value)},set:function(e){var t=this.getHexFromColor(e);t!==this._value&&(this._value=t,this.propagateChange(e),this.changeDetectorRef.markForCheck())}},{key:"hexValue",get:function(){return this._value}},{key:"ngOnInit",value:function(){}},{key:"handleColorPickerChange",value:function(e){this.value=this.getColorFromHex(e),this.changeDetectorRef.markForCheck()}},{key:"writeValue",value:function(e){this.value=e}},{key:"registerOnChange",value:function(e){this.propagateChange=e}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"setDisabledState",value:function(e){this.disabled=e}},{key:"getColorFromHex",value:function(e){return"rgb"===this.type?ue.a.hexToRgb(e,this.decimal):"rgba"===this.type?ue.a.hexToRgba(e,this.decimal):e}},{key:"getHexFromColor",value:function(e){if(Array.isArray(e)){var t=r(e,4),n=t[0],i=t[1],o=t[2],a=t[3];return 4===e.length?ue.a.rgbaToHex([n,i,o,a],this.decimal):ue.a.rgbToHex([n,i,o],this.decimal)}return e.toString()}}]),e}()).\u0275fac=function(e){return new(e||Mt)(ve.Pb(ve.i))},Mt.\u0275cmp=ve.Jb({type:Mt,selectors:[["app-color-picker-input"]],inputs:{value:"value",colorPosition:"colorPosition",useRootContainer:"useRootContainer",dataTestAttributeVal:"dataTestAttributeVal",type:"type",decimal:"decimal",alpha:"alpha"},features:[ve.Cb([{provide:ae.p,useExisting:Object(ve.W)((function(){return Mt})),multi:!0}])],decls:3,vars:9,consts:[[1,"color-picker-input"],["type","text","cpOutputFormat","hex",1,"input","color-picker-input__input",3,"disabled","value","colorPicker","cpAlphaChannel","cpUseRootViewContainer","cpPosition","colorPickerChange"],[1,"color-picker-input__color"]],template:function(e,t){1&e&&(ve.Vb(0,"div",0),ve.Vb(1,"input",1),ve.cc("colorPickerChange",(function(e){return t.handleColorPickerChange(e)})),ve.Ub(),ve.Qb(2,"div",2),ve.Ub()),2&e&&(ve.Db(1),ve.mc("disabled",t.disabled)("value",t.hexValue)("colorPicker",t.hexValue)("cpAlphaChannel",t.alpha?"always":"disabled")("cpUseRootViewContainer",t.useRootContainer)("cpPosition",t.colorPosition),ve.Eb("data-test",t.dataTestAttributeVal),ve.Db(1),ve.Kc("background",t.hexValue))},directives:[Tt.a],styles:[".color-picker-input[_ngcontent-%COMP%]{position:relative}.color-picker-input__input[_ngcontent-%COMP%]{padding-right:36px;width:100%}.color-picker-input__color[_ngcontent-%COMP%]{pointer-events:none;border:1px solid #1b283c;display:block;position:absolute;right:6px;top:6px;z-index:10;height:24px;width:24px;border-radius:50%}.theme-light[_nghost-%COMP%]   .color-picker-input__color[_ngcontent-%COMP%], .theme-light   [_nghost-%COMP%]   .color-picker-input__color[_ngcontent-%COMP%]{border-color:#96a8c0}"],changeDetection:0}),Mt),Dt=o("QibW"),Et=o("yIGu"),jt=o("F+jD"),Nt=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},Rt=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},At=["lightLibInput"],Ft=function(e){return{"content__section--selected":e}};function It(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"div",7),ve.cc("click",(function(){ve.Cc(n);var e=t.$implicit;return ve.gc().handleChapterClick(e)})),ve.Vb(1,"div",13),ve.Pc(2),ve.Ub(),ve.Vb(3,"div",8),ve.Pc(4),ve.Ub(),ve.Ub()}if(2&e){var i=t.$implicit,o=t.index,a=ve.gc();ve.mc("ngClass",ve.pc(3,Ft,i.id===a.selectedChapterId)),ve.Db(2),ve.Rc("",o+1,"."),ve.Db(2),ve.Rc(" ",i.info.displayName||"-No Title-"," ")}}function zt(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"button",22),ve.cc("click",(function(){return ve.Cc(n),ve.gc(2).handleClearTagsSelectionClick()})),ve.Pc(1," Clear Tags "),ve.Ub()}}function Lt(e,t){if(1&e&&(ve.Vb(0,"div",39),ve.Vb(1,"mat-checkbox",40),ve.Pc(2),ve.Ub(),ve.Ub()),2&e){var n=t.$implicit;ve.mc("formGroupName",t.index),ve.Db(2),ve.Rc(" ",n.get("tag").value," ")}}var Bt=function(e){return{"content__check-group--split":e}};function Qt(e,t){if(1&e&&(ve.Vb(0,"app-panel",36),ve.Vb(1,"div",37),ve.Nc(2,Lt,3,2,"div",38),ve.Ub(),ve.Ub()),2&e){var n=t.$implicit;ve.mc("formGroupName",t.index)("label",n.get("title").value)("isCompact",!0),ve.Db(1),ve.mc("ngClass",ve.pc(5,Bt,n.get("tags").controls.length>=3)),ve.Db(1),ve.mc("ngForOf",n.get("tags").controls)}}function $t(e,t){if(1&e&&(ve.Vb(0,"div"),ve.Pc(1),ve.Ub()),2&e){var n=t.$implicit;ve.Db(1),ve.Rc(" ",n," ")}}function qt(e,t){if(1&e){var n=ve.Wb();ve.Tb(0),ve.Vb(1,"div",23),ve.Nc(2,Qt,3,7,"app-panel",24),ve.Ub(),ve.Qb(3,"mat-divider",25),ve.Vb(4,"div",26),ve.Vb(5,"div",27),ve.Pc(6,"Asset Libraries"),ve.Ub(),ve.Vb(7,"div",28),ve.Pc(8,"Any unused libraries will be removed during save."),ve.Ub(),ve.Vb(9,"app-panel",29),ve.Vb(10,"div",30),ve.Nc(11,$t,2,1,"div",31),ve.hc(12,"async"),ve.Ub(),ve.Vb(13,"div",32),ve.Vb(14,"input",33,34),ve.cc("input",(function(){return ve.Cc(n),ve.gc(2).checkGetLightLib()})),ve.Ub(),ve.Vb(16,"button",35),ve.cc("click",(function(){return ve.Cc(n),ve.gc(2).handleLoadLightsLib()})),ve.Pc(17," Load Library "),ve.Ub(),ve.Ub(),ve.Ub(),ve.Ub(),ve.Sb()}if(2&e){var i=ve.gc(2);ve.Db(2),ve.mc("ngForOf",i.tagCategories.controls),ve.Db(9),ve.mc("ngForOf",ve.ic(12,3,i.story$).assetLibraries.lights),ve.Db(5),ve.mc("disabled",i.disableGetLightLib)}}function Gt(e,t){if(1&e&&(ve.Vb(0,"div",14),ve.Vb(1,"form",15),ve.Vb(2,"app-form-field",16),ve.Qb(3,"input",17,18),ve.Qb(5,"app-character-counter",19),ve.Ub(),ve.Nc(6,zt,2,0,"button",20),ve.Nc(7,qt,18,5,"ng-container",21),ve.Ub(),ve.Ub()),2&e){var n=ve.yc(4),i=ve.gc();ve.Db(1),ve.mc("formGroup",i.bookmarkForm),ve.Db(4),ve.mc("field",n)}}function Ht(e,t){if(1&e&&(ve.Tb(0),ve.Qb(1,"app-edit-images-block",41),ve.Qb(2,"mat-divider",47),ve.Sb()),2&e){var n=ve.gc().$implicit;ve.Db(1),ve.mc("formGroup",n)}}function Wt(e,t){if(1&e&&(ve.Tb(0),ve.Qb(1,"app-edit-ticker-block",41),ve.Qb(2,"mat-divider",47),ve.Sb()),2&e){var n=ve.gc(2).$implicit;ve.Db(1),ve.mc("formGroup",n)}}function Kt(e,t){if(1&e&&(ve.Tb(0),ve.Nc(1,Wt,3,1,"ng-container",57),ve.Sb()),2&e){var n=ve.gc(3);ve.Db(1),ve.mc("appFlagApplication",n.environmentApplication.Loft)}}function Jt(e,t){1&e&&(ve.Vb(0,"div",55),ve.Nc(1,Ht,3,1,"ng-container",56),ve.Nc(2,Kt,2,1,"ng-container",56),ve.Ub()),2&e&&(ve.mc("ngSwitch",t.$implicit.value.type),ve.Db(1),ve.mc("ngSwitchCase","images"),ve.Db(1),ve.mc("ngSwitchCase","ticker"))}function Xt(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"div",58),ve.Qb(1,"app-color-picker-input",59),ve.Qb(2,"input",60),ve.Vb(3,"button",61),ve.cc("click",(function(){ve.Cc(n);var e=t.index;return ve.gc(2).handleRemoveLegendItem(e)})),ve.Qb(4,"app-icon",62),ve.Ub(),ve.Ub()}2&e&&(ve.mc("formGroupName",t.index),ve.Db(1),ve.mc("useRootContainer",!1))}function Zt(e,t){if(1&e&&(ve.Vb(0,"option",83),ve.Pc(1),ve.Ub()),2&e){var n=t.$implicit;ve.mc("value",n.lang),ve.Db(1),ve.Rc(" ",n.title," ")}}function Yt(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"div",78),ve.Vb(1,"div",79),ve.Vb(2,"select",80),ve.cc("change",(function(e){ve.Cc(n);var i=t.index;return ve.gc(3).handleAudioItemChange(e,i)})),ve.Nc(3,Zt,2,2,"option",77),ve.Ub(),ve.Vb(4,"div",25),ve.Vb(5,"app-content-upload-input",81),ve.cc("uploadSuccess",(function(e){ve.Cc(n);var i=t.index;return ve.gc(3).onAudioFileSuccess(e,i)})),ve.Ub(),ve.Ub(),ve.Ub(),ve.Vb(6,"button",82),ve.cc("click",(function(){ve.Cc(n);var e=t.index;return ve.gc(3).handleRemoveAudioItem(e)})),ve.Qb(7,"app-icon",62),ve.Ub(),ve.Ub()}if(2&e){var i=t.index,o=ve.gc(3);ve.mc("formGroupName",i),ve.Db(3),ve.mc("ngForOf",o.locales),ve.Db(2),ve.mc("canDelete",!1)}}function en(e,t){1&e&&ve.Qb(0,"mat-divider",84),2&e&&ve.mc("vertical",!0)}function tn(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"div",85),ve.Vb(1,"div",27),ve.Pc(2," Animation "),ve.Vb(3,"button",86),ve.cc("click",(function(){return ve.Cc(n),ve.gc(3).applyAnimationsToAll()})),ve.Qb(4,"app-icon",68),ve.Ub(),ve.Ub(),ve.Vb(5,"div",87),ve.Vb(6,"app-form-field",88),ve.Vb(7,"mat-radio-group",89),ve.Vb(8,"app-list",71),ve.Vb(9,"app-list-item"),ve.Vb(10,"mat-radio-button",83),ve.Pc(11,"Play once"),ve.Ub(),ve.Ub(),ve.Vb(12,"app-list-item"),ve.Vb(13,"mat-radio-button",83),ve.Pc(14,"Play indefinitely"),ve.Ub(),ve.Ub(),ve.Ub(),ve.Ub(),ve.Qb(15,"mat-divider",90),ve.Vb(16,"mat-checkbox",91),ve.Pc(17," Autoplay "),ve.Ub(),ve.Ub(),ve.Vb(18,"app-form-field",92),ve.Tb(19,93),ve.Vb(20,"span",94),ve.Pc(21,"Note:"),ve.Ub(),ve.Pc(22," Save to preview changes in Viewer. "),ve.Sb(),ve.Vb(23,"mat-radio-group",95),ve.Vb(24,"app-list",71),ve.Vb(25,"app-list-item"),ve.Vb(26,"mat-radio-button",96),ve.Pc(27,"None"),ve.Ub(),ve.Ub(),ve.Vb(28,"app-list-item"),ve.Vb(29,"mat-radio-button",97),ve.Pc(30,"Play/Pause"),ve.Ub(),ve.Ub(),ve.Vb(31,"app-list-item"),ve.Vb(32,"mat-radio-button",98),ve.Pc(33,"Scrubber"),ve.Ub(),ve.Ub(),ve.Ub(),ve.Ub(),ve.Ub(),ve.Ub(),ve.Ub()}2&e&&(ve.Db(10),ve.mc("value",1),ve.Db(3),ve.mc("value",-1))}function nn(e,t){if(1&e&&(ve.Vb(0,"option",83),ve.Pc(1),ve.Ub()),2&e){var n=t.$implicit;ve.mc("value",n),ve.Db(1),ve.Rc(" ",n," ")}}function on(e,t){if(1&e){var n=ve.Wb();ve.Tb(0),ve.Qb(1,"mat-divider",25),ve.Vb(2,"div",26),ve.Vb(3,"div",27),ve.Pc(4,"Audio"),ve.Ub(),ve.Vb(5,"div",63),ve.Nc(6,Yt,8,3,"div",64),ve.Ub(),ve.Vb(7,"button",54),ve.cc("click",(function(){return ve.Cc(n),ve.gc(2).handleAddAudioItem()})),ve.Pc(8," Add Audio "),ve.Ub(),ve.Ub(),ve.Qb(9,"mat-divider",25),ve.Vb(10,"div",65),ve.Vb(11,"div",66),ve.Vb(12,"div",27),ve.Pc(13," Transitions "),ve.Vb(14,"button",67),ve.cc("click",(function(){return ve.Cc(n),ve.gc(2).applyTransitionsToAll()})),ve.Qb(15,"app-icon",68),ve.Ub(),ve.Ub(),ve.Vb(16,"app-form-field",69),ve.Vb(17,"mat-radio-group",70),ve.Vb(18,"app-list",71),ve.Vb(19,"app-list-item"),ve.Vb(20,"mat-radio-button",72),ve.Pc(21,"Fly To"),ve.Ub(),ve.Ub(),ve.Vb(22,"app-list-item"),ve.Vb(23,"mat-radio-button",73),ve.Pc(24,"Jump To"),ve.Ub(),ve.Ub(),ve.Ub(),ve.Ub(),ve.Ub(),ve.Ub(),ve.Nc(25,en,1,1,"mat-divider",74),ve.Nc(26,tn,34,2,"div",75),ve.Ub(),ve.Qb(27,"mat-divider",25),ve.Vb(28,"div",26),ve.Vb(29,"div",27),ve.Pc(30,"Lights"),ve.Ub(),ve.Vb(31,"select",76),ve.cc("change",(function(){return ve.Cc(n),ve.gc(2).handleLightsChange()})),ve.Nc(32,nn,2,2,"option",77),ve.hc(33,"async"),ve.Ub(),ve.Ub(),ve.Sb()}if(2&e){var i=ve.gc(2);ve.Db(6),ve.mc("ngForOf",i.audio.controls),ve.Db(1),ve.mc("expanded",!0),ve.Db(18),ve.mc("ngIf",i.selectedChapterAnimated),ve.Db(1),ve.mc("ngIf",i.selectedChapterAnimated),ve.Db(6),ve.mc("ngForOf",ve.ic(33,5,i.story$).assetLibraries.lights)}}function an(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"div",14),ve.Vb(1,"form",41),ve.Vb(2,"app-form-field",42),ve.Qb(3,"input",43,18),ve.Qb(5,"app-character-counter",19),ve.Ub(),ve.Vb(6,"app-form-field",44),ve.Qb(7,"app-rich-text-edit",45,46),ve.Qb(9,"app-character-counter",19),ve.Ub(),ve.Qb(10,"mat-divider",47),ve.Tb(11,48),ve.Nc(12,Jt,3,3,"div",49),ve.Sb(),ve.Vb(13,"div",50),ve.Vb(14,"div",27),ve.Pc(15,"Legend"),ve.Ub(),ve.Vb(16,"app-form-field",51),ve.Vb(17,"div",52),ve.cc("cdkDropListDropped",(function(e){return ve.Cc(n),ve.gc().handleLegendItemDrop(e)})),ve.Nc(18,Xt,5,2,"div",53),ve.Ub(),ve.Ub(),ve.Vb(19,"button",54),ve.cc("click",(function(){return ve.Cc(n),ve.gc().handleAddLegendItem()})),ve.Pc(20," Add Legend "),ve.Ub(),ve.Ub(),ve.Nc(21,on,34,7,"ng-container",21),ve.Ub(),ve.Ub()}if(2&e){var i=ve.yc(4),o=ve.yc(8),a=ve.gc();ve.Db(1),ve.mc("formGroup",a.chapterForm),ve.Db(4),ve.mc("field",i),ve.Db(2),ve.mc("inline",!0)("resizeable",!1)("rows",16)("maxLength",1e4),ve.Db(2),ve.mc("field",o),ve.Db(3),ve.mc("ngForOf",a.contentBlocks.controls),ve.Db(6),ve.mc("ngForOf",a.legend.controls),ve.Db(1),ve.mc("expanded",!0)}}var rn,cn=((rn=function(){function e(t,n,i,o,a,r,c,s){l(this,e),this.formBuilder=t,this.dialogRef=n,this.data=i,this.store=o,this.animationService=a,this.mediaService=r,this.engineService=c,this.snackbar=s,this.environmentApplication=fe.a,this.locales=ge.d,this.ngUnsubscribe=new C.a,this.disableGetLightLib=!0}return u(e,[{key:"tagCategories",get:function(){return this.bookmarkForm.get("tagCategories")}},{key:"legend",get:function(){return this.chapterForm.get("legend")}},{key:"audio",get:function(){return this.chapterForm.get("audio")}},{key:"ngOnInit",value:function(){this.initBookmarkForm(),this.initChaptersForm()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initBookmarkForm",value:function(){var e=this;this.bookmarkForm=this.formBuilder.group({displayName:["",[ae.C.maxLength(60),ae.C.required]],tagCategories:new ae.d([])});var t=this.store.selectSnapshot(te.a.getSelectedBookmark),n=this.store.selectSnapshot(D.a.getStory);this.setBookmarkFormValues(t,n),this.bookmarkForm.valueChanges.pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(){e.handleBookmarkFormChanges()}))}},{key:"initChaptersForm",value:function(){var e=this;this.chapterForm=this.formBuilder.group({displayName:["",ae.C.maxLength(60)],description:["",ae.C.maxLength(1e4)],contentBlocks:new ae.d([]),cameraAction:[""],playCount:[""],autoplay:[""],mediaControls:[""],legend:new ae.d([]),audio:new ae.d([]),lights:[""]}),this.chapters=this.store.selectSnapshot(X.a.getStoryChapters),this.selectChapter(this.data.chapterId?this.data.chapterId:this.chapters[0].id),this.chapterForm.valueChanges.pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(){e.handleChapterFormChanges()}))}},{key:"handleModuleClick",value:function(){this.selectChapter("")}},{key:"handleChapterClick",value:function(e){this.selectChapter(e.id)}},{key:"selectChapter",value:function(e){this.selectedChapterId=e,this.selectedChapter=this.store.selectSnapshot(X.a.getStoryChapters).find((function(t){return t.id===e})),this.selectedChapterAnimated=this.selectedChapter&&this.animationService.isChapterAnimated(this.selectedChapter),this.selectedChapter&&this.setChapterFormValues(this.selectedChapter)}},{key:"handleChapterFormChanges",value:function(){var e=this,t=this.store.selectSnapshot(X.a.getStoryChapters),n=t.findIndex((function(t){return t.id===e.selectedChapterId})),i=t[n],o=this.chapterForm.value,a=o.displayName,r=o.contentBlocks,c=o.description,s=o.cameraAction,l=o.legend;this.store.dispatch(new J.x(i.id,{displayName:a,description:c})),this.store.dispatch(new J.v(i.id,this.filterEmptyContentBlocks(r))),this.store.dispatch(new J.t(i.id,s)),this.store.dispatch(new J.G(i.id,this.getFormUIConfig(i))),this.store.dispatch(new J.y(i.id,this.createLegendFromInputs(l)))}},{key:"handleBookmarkFormChanges",value:function(){var e=this,t=this.bookmarkForm.get("displayName").value,n=this.bookmarkForm.get("tagCategories").value.reduce((function(t,n){return t.concat(e.getSelectedTagsByCategory(n))}),[]);this.store.dispatch(new $.r(t)),this.store.dispatch(new ee.E(t)),this.store.dispatch(new $.q(n))}},{key:"setChapterFormValues",value:function(e){var t=this,n=e.info,i=n.description,o=n.displayName,a=e.contentBlocks,r=a.find((function(e){return e.type===me.a.Images}))||new de.a,c=a.find((function(e){return e.type===me.a.Ticker}))||new be.a,s=[r,c];this.contentBlocks.setControl(0,this.newImagesBlockFormGroup(r)),this.contentBlocks.setControl(1,this.newTickerBlockFormGroup(c));var l=e.camera.action||"flyTo",p=Object(ce.get)(e,"ui.play.count",1),u=Object(ce.get)(e,"ui.play.autoplay",!0),d=Object(ce.get)(e,"ui.config",{mediaControls:pe.a.Full}),m=Object(le.g)(d.playPause,d.scrubber,d.mediaControls),h=e.legend||[],b=this.chapterForm.get("legend");b.clear();var f=this.createInputsFromLegend(h);f.forEach((function(e){b.push(t.formBuilder.group(e))}));var g=this.chapterForm.get("audio");g.clear();var v=this.createAudioInputs();v.forEach((function(e){g.push(t.formBuilder.group(e))}));var y=Object(ce.get)(e,"lights.libraries[0]");this.chapterForm.setValue({displayName:o,description:i,contentBlocks:s,cameraAction:l,playCount:p,autoplay:u,mediaControls:m,legend:f,audio:v,lights:y})}},{key:"setBookmarkFormValues",value:function(e,t){var n=this,i=e.title,o=t.tags||[],a=this.getTagCategories(o),r=this.createTagCategorySelections(a,o),c=this.bookmarkForm.get("tagCategories");c.clear(),r.forEach((function(e){var t=n.formBuilder.group({title:"",tags:n.formBuilder.array(e.tags.map((function(e){return n.formBuilder.group(e)})))});c.push(t)})),this.bookmarkForm.setValue({displayName:i,tagCategories:r})}},{key:"closeDialog",value:function(){this.dialogRef.close(this.chapters)}},{key:"applyTransitionsToAll",value:function(){var e=this.chapterForm.value.cameraAction,t=this.chapters.map((function(t){return new J.t(t.id,e)}));this.store.dispatch(t),this.snackbar.open("Transition properties applied to all chapters.")}},{key:"applyAnimationsToAll",value:function(){var e=this,t=this.chapters.map((function(t){return new J.G(t.id,e.getFormUIConfig(t))}));this.store.dispatch(t),this.snackbar.open("Animation properties applied to all chapters.")}},{key:"getFormUIConfig",value:function(e){var t=this.chapterForm.value,n=t.playCount,i=t.autoplay,o=t.mediaControls;return{play:{count:n,autoplay:i},config:Object.assign(Object.assign({},e.ui.config),{mediaControls:o})}}},{key:"handleClearTagsSelectionClick",value:function(){this.setAllTagSelections(!1)}},{key:"setAllTagSelections",value:function(e){var t=this.bookmarkForm.get("tagCategories").value,n=Object(ce.cloneDeep)(t);n.forEach((function(t){t.tags.forEach((function(t){return t.checked=e}))})),this.bookmarkForm.patchValue({tagCategories:n})}},{key:"getAllTagsList",value:function(e){var t=[].concat(a(Object.values(se.a).reduce((function(e,t){return e.concat(t.tags)}),[])),a(e));return a(new Set(t)).sort()}},{key:"getTagCategories",value:function(e){var t=Object.values(se.a).reduce((function(e,t){return[].concat(a(e),a(t.tags))}),[]),n=e.filter((function(e){return!t.includes(e)}));return n.length>0?[].concat(a(se.a),[{title:"Misc",tags:n}]):a(se.a)}},{key:"getSelectedTagsByCategory",value:function(e){return e.tags.filter((function(e){return e.checked})).map((function(e){return e.tag}))}},{key:"createTagCategorySelections",value:function(e,t){return e.map((function(e){return{title:e.title,tags:e.tags.map((function(e){return{tag:e,checked:t.includes(e)}})).sort((function(e,t){return e.tag.toLowerCase()<t.tag.toLowerCase()?-1:1}))}}))}},{key:"handleAddLegendItem",value:function(){this.store.dispatch(new J.a(this.selectedChapterId,{label:"",colors:[1,0,0]})),this.selectChapter(this.selectedChapterId)}},{key:"handleRemoveLegendItem",value:function(e){var t=a(this.store.selectSnapshot(X.a.getChapter(this.selectedChapterId)).legend)||!1;t.splice(e,1),this.store.dispatch(new J.y(this.selectedChapterId,t)),this.selectChapter(this.selectedChapterId)}},{key:"handleLegendItemDrop",value:function(e){var t=e.previousIndex,n=e.currentIndex,i=this.store.selectSnapshot(X.a.getChapter(this.selectedChapterId)).legend||[],o=Object(he.a)(i,t,n);this.store.dispatch(new J.y(this.selectedChapterId,o)),this.selectChapter(this.selectedChapterId)}},{key:"createInputsFromLegend",value:function(e){return e.map((function(e){var t=e.label,n=e.colors;return{label:t,color:ue.a.rgbToHex(n,!0)}}))}},{key:"createLegendFromInputs",value:function(e){return e.map((function(e){var t=e.label,n=e.color;return{label:t,colors:ue.a.hexToRgb(n,!0)}}))}},{key:"createAudioInputs",value:function(){return this.mediaService.getAudioClips(this.selectedChapter.media).map((function(e){return{clipId:e.data.clipId,lang:e.data.lang,fullUrl:e.data.fullUrl}}))}},{key:"handleAddAudioItem",value:function(){var e=this.formBuilder.group({clipId:"",lang:"en",fullUrl:""});this.audio.push(e)}},{key:"onAudioFileSuccess",value:function(e,t){var n=this.audio.at(t).value,i=r(this.mediaService.createAudioClip(this.selectedChapter,e,n.lang),2),o=i[0],a=i[1],c=Object.assign({},this.selectedChapter.media);c[o]=a,this.store.dispatch(new J.A(this.selectedChapterId,c)),this.selectChapter(this.selectedChapterId),this.snackbar.open("Successfully added ".concat(e,"."))}},{key:"handleAudioItemChange",value:function(e,t){var n=this.audio.at(t).value;n.clipId&&this.updateAudioLang(n.clipId,n.lang)}},{key:"updateAudioLang",value:function(e,t){var n=Object.assign({},this.selectedChapter.media);n[e].data.lang=t,this.store.dispatch(new J.A(this.selectedChapterId,n))}},{key:"handleRemoveAudioItem",value:function(e){var t=this.audio.at(e).value;t.clipId?this.deleteAudio(t.clipId):this.audio.removeAt(e)}},{key:"deleteAudio",value:function(e){var t=Object.assign({},this.selectedChapter.media);delete t[e],this.store.dispatch(new J.A(this.selectedChapterId,t)),this.selectChapter(this.selectedChapterId),this.snackbar.open("Successfully deleted audio clip.")}},{key:"contentBlocks",get:function(){return this.chapterForm.get("contentBlocks")}},{key:"newImagesBlockFormGroup",value:function(e){var t=this;return this.formBuilder.group({type:"images",images:this.formBuilder.array(e.images.map((function(e){return t.formBuilder.group({urls:e.urls,alt:[e.alt,ae.C.maxLength(200)],caption:[e.caption,ae.C.maxLength(200)]})})))})}},{key:"newTickerBlockFormGroup",value:function(e){var t=this;return this.formBuilder.group({type:"ticker",loopImage:!1,images:this.formBuilder.array(e.images.map((function(e){return t.formBuilder.group({urls:e.urls,alt:[e.alt,ae.C.maxLength(200)],caption:[e.caption,ae.C.maxLength(200)]})})))})}},{key:"filterEmptyContentBlocks",value:function(e){return e.filter((function(e){switch(e.type){case me.a.Markdown:return e.markdown.length>0;case me.a.Images:case me.a.Ticker:return e.images.length>0}}))}},{key:"checkGetLightLib",value:function(){this.disableGetLightLib=0===this.lightLibInput.nativeElement.value.length}},{key:"handleLightsChange",value:function(){var e=this.chapterForm.get("lights").value;this.store.dispatch(new J.z(this.selectedChapter.id,e))}},{key:"handleLoadLightsLib",value:function(){var e=this,t=this.lightLibInput.nativeElement.value,n=this.store.selectSnapshot(D.a.getStory).assetLibraries.lights;n.includes(t)?this.snackbar.open(t+" is already loaded."):this.engineService.loadLightLib(t).then((function(){n=[].concat(a(n),[t]),e.store.dispatch(new $.p(n)),e.snackbar.open("Successfully loaded ".concat(t,"."))}),(function(){e.snackbar.open("Unable to load ".concat(t,"."))})).finally((function(){e.lightLibInput.nativeElement.value="",e.disableGetLightLib=!0}))}}]),e}()).\u0275fac=function(e){return new(e||rn)(ve.Pb(ae.f),ve.Pb(re.g),ve.Pb(re.a),ve.Pb(y.h),ve.Pb(ye.a),ve.Pb(xe.a),ve.Pb(Ce.a),ve.Pb(ke.b))},rn.\u0275cmp=ve.Jb({type:rn,selectors:[["app-content-dialog"]],viewQuery:function(e,t){var n;1&e&&ve.Vc(At,!0),2&e&&ve.xc(n=ve.dc())&&(t.lightLibInput=n.first)},decls:23,vars:11,consts:[[1,"content","theme-light"],[1,"content__header"],[1,"text-20","text-semibold"],[1,"content__body"],[1,"content__sections"],[1,"mb-2"],[1,"content__section-label"],[1,"content__section",3,"ngClass","click"],[1,"content__title"],["class","content__section",3,"ngClass","click",4,"ngFor","ngForOf"],["class","content__editor",4,"ngIf"],[1,"content__footer"],["app-button","","buttonType","primary","buttonTheme","light","type","button",3,"mat-dialog-close"],[1,"content__index"],[1,"content__editor"],[1,"theme-light",3,"formGroup"],["label","Model Title"],["type","text","formControlName","displayName","maxlength","60","placeholder","e.g. Human Heart",1,"input"],["displayName",""],[3,"field"],["app-button","","buttonTheme","light","buttonType","outline","buttonSize","small","class","mv-4",3,"click",4,"appFlagInternal"],[4,"appFlagInternal"],["app-button","","buttonTheme","light","buttonType","outline","buttonSize","small",1,"mv-4",3,"click"],["formArrayName","tagCategories"],[3,"formGroupName","label","isCompact",4,"ngFor","ngForOf"],[1,"mv-4"],[1,"text-12","pv-2"],[1,"text-14","text-bold","mb-2"],[1,"text-12","mb-2"],["label","Lights"],[1,"mb-4"],[4,"ngFor","ngForOf"],[1,"flex"],["type","text","placeholder","Enter a library in the form <stateName>/<directoryName>",1,"input",3,"input"],["lightLibInput",""],["app-button","","buttonTheme","light","buttonType","outline","buttonSize","medium",1,"flex-none","ml-3",3,"disabled","click"],[3,"formGroupName","label","isCompact"],["formArrayName","tags",1,"content__check-group",3,"ngClass"],[3,"formGroupName",4,"ngFor","ngForOf"],[3,"formGroupName"],["formControlName","checked"],[3,"formGroup"],["label","Chapter Title"],["type","text","formControlName","displayName","maxlength","60",1,"input","w-100"],["label","Chapter Description"],["formControlName","description",3,"inline","resizeable","rows","maxLength"],["description",""],[1,"mv-8"],["formArrayName","contentBlocks"],[3,"ngSwitch",4,"ngFor","ngForOf"],[1,"text-12"],["formArrayName","legend"],["cdkDropList","","cdkDropListOrientation","vertical",3,"cdkDropListDropped"],["class","flex flex-row mv-1 theme-light items-center","cdkDrag","",3,"formGroupName",4,"ngFor","ngForOf"],["app-button","","buttonType","outline","buttonTheme","light","type","button",1,"w-25",3,"expanded","click"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"appFlagApplication"],["cdkDrag","",1,"flex","flex-row","mv-1","theme-light","items-center",3,"formGroupName"],["formControlName","color",3,"useRootContainer"],["type","text","formControlName","label","placeholder","Legend label",1,"input","ml-2"],["app-button","","buttonType","text","buttonTheme","light","type","button","matTooltip","Remove",1,"mr-2",3,"click"],["icon","times"],["formArrayName","audio"],["class","flex flex-row mv-1 theme-light items-center",3,"formGroupName",4,"ngFor","ngForOf"],[1,"content__properties","text-12","pv-2"],[1,"flex","flex-column"],["app-button","","buttonTheme","light","buttonType","text","matTooltip","Apply transition to all chapters","matTooltipPosition","above","title","Apply transition to all chapters",3,"click"],["icon","copy"],["label","Chapter Transition"],["formControlName","cameraAction",1,"content__group"],["listType","flat"],["value","flyTo"],["value","jumpTo"],[3,"vertical",4,"ngIf"],["class","flex flex-column ml-2",4,"ngIf"],["formControlName","lights",1,"input","w-auto",3,"change"],[3,"value",4,"ngFor","ngForOf"],[1,"flex","flex-row","mv-1","theme-light","items-center",3,"formGroupName"],[1,"flex","flex-column","flex-grow"],["formControlName","lang",1,"input","content__audio-language",3,"change"],["type","audio","formControlName","fullUrl",3,"canDelete","uploadSuccess"],["app-button","","buttonType","text","buttonTheme","light","type","button","matTooltip","Remove Audio",1,"mr-2",3,"click"],[3,"value"],[3,"vertical"],[1,"flex","flex-column","ml-2"],["app-button","","buttonTheme","light","buttonType","text","matTooltip","Apply animation to all chapters","matTooltipPosition","above","title","Apply animation to all chapters",3,"click"],[1,"content__properties"],["label","Looping"],["formControlName","playCount",1,"content__group"],[1,"mv-4","mr-4"],["formControlName","autoplay"],["label","Media Controls"],["form-field-help",""],[1,"text-bold"],["formControlName","mediaControls",1,"content__group"],["value","none"],["value","small"],["value","full"]],template:function(e,t){var n;(1&e&&(ve.Vb(0,"div",0),ve.Vb(1,"div",1),ve.Vb(2,"div",2),ve.Pc(3,"Content Manager"),ve.Ub(),ve.Ub(),ve.Vb(4,"div",3),ve.Vb(5,"div",4),ve.Vb(6,"div",5),ve.Vb(7,"div",6),ve.Pc(8,"Model"),ve.Ub(),ve.Vb(9,"div",7),ve.cc("click",(function(){return t.handleModuleClick()})),ve.Vb(10,"div",8),ve.Pc(11),ve.hc(12,"async"),ve.Ub(),ve.Ub(),ve.Ub(),ve.Vb(13,"div",5),ve.Vb(14,"div",6),ve.Pc(15,"Chapters"),ve.Ub(),ve.Nc(16,It,5,5,"div",9),ve.hc(17,"async"),ve.Ub(),ve.Ub(),ve.Nc(18,Gt,8,2,"div",10),ve.Nc(19,an,22,10,"div",10),ve.Ub(),ve.Vb(20,"div",11),ve.Vb(21,"button",12),ve.Pc(22," Done "),ve.Ub(),ve.Ub(),ve.Ub()),2&e)&&(ve.Db(9),ve.mc("ngClass",ve.pc(9,Ft,!t.selectedChapterId)),ve.Db(2),ve.Rc(" ",(null==(n=ve.ic(12,5,t.story$))?null:n.displayName)||"-No Title-"," "),ve.Db(5),ve.mc("ngForOf",ve.ic(17,7,t.chapters$)),ve.Db(2),ve.mc("ngIf",!t.selectedChapterId),ve.Db(1),ve.mc("ngIf",t.selectedChapterId))},directives:[f.m,f.o,f.p,Pe.a,re.d,ae.E,ae.s,ae.j,Oe.a,ae.c,ae.r,ae.i,ae.m,we.a,Se.a,ae.e,_e.a,Me.a,ae.k,Ue.a,gt,vt.c,f.r,f.s,Ot,wt.a,Ut,vt.a,Vt,Ct.c,yt.a,Dt.b,Et.a,jt.a,Dt.a,ae.B,xt.a,ae.v,ae.D],pipes:[f.b],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.content[_ngcontent-%COMP%]{height:100%;width:100%}.content__header[_ngcontent-%COMP%]{padding-bottom:12px;border-bottom:1px solid #d7e0ea;height:80px;display:flex;justify-content:space-between;align-items:center}.content__body[_ngcontent-%COMP%]{height:calc(90vh - 180px);padding-top:12px;display:flex}.content__footer[_ngcontent-%COMP%]{border-top:1px solid #d7e0ea;height:80px;display:flex;align-items:center;justify-content:flex-end}.content__section-label[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase;color:#96a8c0;margin-bottom:4px}.content__sections[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding:20px 12px 0 0;flex:1 1 35%;overflow:auto}.content__index[_ngcontent-%COMP%]{padding:0 8px}.content__index[_ngcontent-%COMP%], .content__section[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.content__section[_ngcontent-%COMP%]{display:flex;padding:12px;border-left:4px solid transparent;border-radius:4px;margin-bottom:4px;cursor:pointer;transition:background-color .12s}.content__section[_ngcontent-%COMP%]:hover{background:#eaeff5}.content__section--selected[_ngcontent-%COMP%], .content__section--selected[_ngcontent-%COMP%]:hover{background:#eaeff5;color:#101823;border-color:#2d72dc}.content__title[_ngcontent-%COMP%]{word-break:break-word}.content__thumb[_ngcontent-%COMP%]{background:url(/assets/images/logo-dark-transparent.svg) 50% no-repeat;background-size:50%;border-radius:4px;flex:0 0 64px;height:64px;margin-right:12px}.content__editor[_ngcontent-%COMP%]{border-left:1px solid #eaeff5;flex:1 1 75%;padding:16px 24px 48px 16px;overflow:auto}.content__group[_ngcontent-%COMP%]{display:flex;flex-direction:column}.content__check-group[_ngcontent-%COMP%]{grid-template-columns:1fr;display:grid;grid-column-gap:12px;font-size:12px;letter-spacing:.3px;line-height:1.4em}.content__check-group--split[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr}.content__properties[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em;display:grid;grid-template-columns:160px auto auto;grid-column-gap:8px}.content__block[_ngcontent-%COMP%]{display:flex;padding-bottom:16px}.content__block.cdk-drag-preview[_ngcontent-%COMP%] > .content__block-actions[_ngcontent-%COMP%], .content__block.cdk-drag-preview[_ngcontent-%COMP%] > .content__block-text[_ngcontent-%COMP%]{display:none}.content__block-handle[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:flex-start;flex:0 0 36px}.content__block-handle[_ngcontent-%COMP%]:hover{cursor:move}.content__block-image[_ngcontent-%COMP%]{flex:0 0 240px}.content__block-text[_ngcontent-%COMP%]{flex-grow:1;padding:0 8px}.content__block-actions[_ngcontent-%COMP%]{flex:0 0 48px}.content__audio-language[_ngcontent-%COMP%]{width:200px}"],changeDetection:0}),Nt([Object(y.e)(D.a.getStory),Rt("design:type",_.a)],rn.prototype,"story$",void 0),Nt([Object(y.e)(X.a.getStoryChapters),Rt("design:type",_.a)],rn.prototype,"chapters$",void 0),rn),sn=o("ZR5G"),ln=o("GMXD"),pn=(d(s={},ne.a.Select,"mouse-pointer"),d(s,ne.a.Hide,"eye-slash"),d(s,ne.a.Paint,"fill-drip"),d(s,ne.a.Label,"tag"),d(s,ne.a.Isolate,"hand-point-up"),d(s,ne.a.Fade,"lungs"),d(s,ne.a.Position,"location-arrow"),d(s,ne.a.Quiz,"check"),s),un=o("imBb"),dn=o("AytR"),mn=o("Dyer"),hn=o("Kn5L"),bn=o("mdY/"),fn=o("gm/O"),gn=o("JaAu"),vn=o("/75k"),yn=o("Iab2"),xn=o("GmhI"),Cn=o("zKvh"),kn=o("t15c"),Pn=o("k93M"),On=o("DTUA"),wn=o("+/zV"),Sn=function e(t){l(this,e),this.namespaceMap={},this.duplicate=!1,this.replace=!1,Object.assign(this,t)},_n=o("0FUJ"),Mn=o("3phy"),Un=o("Kj3r"),Tn=o("MKYd"),Vn=o("XoCC"),Dn=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},En=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function jn(e,t){1&e&&(ve.Vb(0,"div",23),ve.Qb(1,"app-icon",24),ve.Vb(2,"span",25),ve.Pc(3,"The scene graph will be trimmed using the clipping planes of the currently active chapter. Objects shared with other chapters will be lost. A page reload is recommended."),ve.Ub(),ve.Ub())}function Nn(e,t){if(1&e&&(ve.Vb(0,"option",26),ve.Pc(1),ve.Ub()),2&e){var n=t.$implicit;ve.mc("value",n),ve.Db(1),ve.Rc(" ",n," ")}}function Rn(e,t){if(1&e&&(ve.Vb(0,"option",26),ve.Pc(1),ve.Ub()),2&e){var n=t.$implicit;ve.mc("value",n),ve.Db(1),ve.Rc(" ",n," ")}}function An(e,t){if(1&e&&(ve.Vb(0,"app-form-field",27),ve.Vb(1,"select",28),ve.Nc(2,Rn,2,2,"option",12),ve.hc(3,"async"),ve.Ub(),ve.Ub()),2&e){var n=ve.gc();ve.Db(2),ve.mc("ngForOf",ve.ic(3,1,n.secondaryCategoryOptions$))}}function Fn(e,t){if(1&e&&(ve.Vb(0,"div",33),ve.Qb(1,"app-icon",34),ve.Vb(2,"span",35),ve.Pc(3),ve.Ub(),ve.Vb(4,"span",36),ve.Pc(5,"(File exists)"),ve.Ub(),ve.Ub()),2&e){var n=ve.gc(2);ve.Db(3),ve.Qc(n.modulePath)}}function In(e,t){if(1&e&&(ve.Vb(0,"div",37),ve.Qb(1,"app-icon",24),ve.Vb(2,"span",35),ve.Pc(3),ve.Ub(),ve.Vb(4,"span",36),ve.Pc(5,"(File exists and cannot be overwritten)"),ve.Ub(),ve.Ub()),2&e){var n=ve.gc(2);ve.Db(3),ve.Qc(n.modulePath)}}function zn(e,t){if(1&e&&(ve.Vb(0,"div",38),ve.Qb(1,"app-icon",39),ve.Vb(2,"span",35),ve.Pc(3),ve.Ub(),ve.Ub()),2&e){var n=ve.gc(2);ve.Db(3),ve.Qc(n.modulePath)}}function Ln(e,t){if(1&e&&(ve.Vb(0,"div",29),ve.Nc(1,Fn,6,1,"div",30),ve.Nc(2,In,6,1,"div",31),ve.Nc(3,zn,4,1,"div",32),ve.Ub()),2&e){var n=ve.gc();ve.Db(1),ve.mc("ngIf",n.moduleExists&&!n.formDuplicateStates.value),ve.Db(1),ve.mc("ngIf",n.moduleExists&&n.formDuplicateStates.value),ve.Db(1),ve.mc("ngIf",!n.moduleExists)}}function Bn(e,t){1&e&&(ve.Vb(0,"app-form-field",40),ve.Vb(1,"mat-checkbox",41),ve.Vb(2,"span",4),ve.Pc(3,"I intend to save to Production"),ve.Ub(),ve.Ub(),ve.Ub())}function Qn(e,t){if(1&e&&(ve.Vb(0,"div",51),ve.Vb(1,"div",52),ve.Vb(2,"div",44),ve.Vb(3,"div",53),ve.Qb(4,"mat-checkbox",54),ve.Ub(),ve.Vb(5,"div",55),ve.Qb(6,"input",56),ve.Qb(7,"input",57),ve.Ub(),ve.Ub(),ve.Ub(),ve.Ub()),2&e){var n=t.index;ve.Db(1),ve.mc("formGroupName",n)}}function $n(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"div"),ve.Qb(1,"mat-divider",42),ve.Vb(2,"app-form-field",43),ve.Vb(3,"div",44),ve.Qb(4,"input",45,46),ve.Vb(6,"button",47),ve.cc("click",(function(){ve.Cc(n);var e=ve.yc(5);return ve.gc().handleReplaceClick(e.value)})),ve.Pc(7," Replace "),ve.Ub(),ve.Vb(8,"button",48),ve.cc("click",(function(){ve.Cc(n);var e=ve.yc(5);return ve.gc().handlePrependClick(e.value)})),ve.Pc(9," Prepend "),ve.Ub(),ve.Ub(),ve.Vb(10,"div",49),ve.Nc(11,Qn,8,1,"div",50),ve.Ub(),ve.Ub(),ve.Ub()}if(2&e){var i=ve.gc();ve.Db(11),ve.mc("ngForOf",i.formStates.controls)}}function qn(e,t){1&e&&(ve.Tb(0),ve.Qb(1,"app-spinner",58),ve.Pc(2," Validating "),ve.Sb())}function Gn(e,t){1&e&&(ve.Tb(0),ve.Qb(1,"app-spinner",58),ve.Pc(2," Saving "),ve.Sb())}function Hn(e,t){1&e&&(ve.Tb(0),ve.Pc(1," Save Module "),ve.Sb())}var Wn,Kn,Jn=/^[0-9a-zA-Z_]+$/,Xn=((Wn=function(){function e(t,n,i,o,a,r,c,s){l(this,e),this.store=t,this.actions=n,this.formBuilder=i,this.modulesService=o,this.changeDetector=a,this.snackbar=r,this.dialogRef=c,this.data=s,this.saving=!1,this.moduleExists=!1,this.validating=!1,this.ngUnsubscribe=new C.a,this.settings=Object.assign({},s)}return u(e,[{key:"formName",get:function(){return this.form.get("name")}},{key:"formStates",get:function(){return this.form.get("states")}},{key:"formPrimaryCategory",get:function(){return this.form.get("primaryCategory")}},{key:"formSecondaryCategory",get:function(){return this.form.get("secondaryCategory")}},{key:"formDuplicateStates",get:function(){return this.form.get("duplicateStates")}},{key:"formTrimHidden",get:function(){return this.form.get("trimHidden")}},{key:"formTrimClipped",get:function(){return this.form.get("trimClipped")}},{key:"formConfirmProduction",get:function(){return this.form.get("confirmProduction")}},{key:"ngOnInit",value:function(){this.store.dispatch(new mn.e),this.saveModule=this.generateSaveModule(),this.usedStates=this.modulesService.getUsedStates(),this.initApplicationListeners(),this.initForm(),this.setFormValidators(),this.initFormListeners(),this.setFormValues(this.saveModule),this.populateStateValues()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initApplicationListeners",value:function(){var e=this;this.actions.pipe(Object(y.l)(mn.h),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.handleSaveSuccess(t.id)})),this.actions.pipe(Object(y.l)(mn.g),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.handleSaveFail(t.id)}))}},{key:"initFormListeners",value:function(){var e=this;this.formPrimaryCategory.valueChanges.pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.store.dispatch(new mn.d(t))})),Object(O.b)(this.formPrimaryCategory.valueChanges,this.formSecondaryCategory.valueChanges,this.formName.valueChanges,this.formDuplicateStates.valueChanges).pipe(Object(N.a)(this.ngUnsubscribe),Object(Un.a)(300)).subscribe((function(t){var n=r(t,4),i=n[0],o=n[1],a=n[2],c=n[3];e.handleNameChange(i,o,a,c)})),Object(w.a)(this.formDuplicateStates.valueChanges,this.formStates.valueChanges).pipe(Object(B.a)((function(){return e.validating=!0})),Object(Un.a)(300),Object(I.a)((function(t){return e.checkStateGroups()})),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.validating=!1,e.updateFormStates(t)}))}},{key:"initForm",value:function(){this.form=this.formBuilder.group({primaryCategory:["",ae.C.required],secondaryCategory:[""],name:["",[ae.C.required,ae.C.pattern("[0-9a-zA-Z_]*")]],trimHidden:[!1],trimClipped:[!1],duplicateStates:[!1],confirmProduction:[!1,this.validateProductionSave],states:this.formBuilder.array([this.initStateForm("")])},{validators:[this.validateProductionSave]})}},{key:"initStateForm",value:function(e){return this.formBuilder.group({include:[!0],oldState:[e],newState:[e,[ae.C.required,ae.C.pattern("[0-9a-zA-Z_]*")]]})}},{key:"handleReplaceClick",value:function(e){this.changeStatePrefix(e,"replace")}},{key:"handlePrependClick",value:function(e){this.changeStatePrefix(e,"prepend")}},{key:"handleSubmit",value:function(){this.form.valid&&this.save()}},{key:"handleSaveSuccess",value:function(e){this.dialogRef.close(!0),this.snackbar.open('"'.concat(e,'" successfully saved.'))}},{key:"handleSaveFail",value:function(e){this.dialogRef.close(),this.snackbar.open('There was an error saving "'.concat(e,'".'))}},{key:"generateSaveModule",value:function(){return this.modulesService.generateSaveModule(this.settings.id)}},{key:"populateStateValues",value:function(){for(var e=this;this.formStates.length>0;)this.formStates.removeAt(0);var t=[];this.modulesService.getUsedStates().forEach((function(n){var i={enabled:!0,state:n};e.formStates.push(e.initStateForm(i.state)),t.push(i)})),this.formStates.markAsDirty()}},{key:"setFormValidators",value:function(){var e=this;this.formPrimaryCategory.valueChanges.pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){switch(t){case"production":case"client":e.formSecondaryCategory.setValidators([ae.C.required]);break;default:e.formSecondaryCategory.setValidators(null),e.formSecondaryCategory.setValue("")}}))}},{key:"setFormValues",value:function(e){this.form.patchValue({primaryCategory:"exports"===e.primaryCategory?"preview":e.primaryCategory||"preview",secondaryCategory:e.secondaryCategory||"",name:e.name||"",trimHidden:!1,trimClipped:!1,duplicateStates:!1})}},{key:"save",value:function(){var e=this.modulesService.generateModulePath(this.formPrimaryCategory.value,this.formSecondaryCategory.value,this.formName.value),t=new Sn;this.formDuplicateStates.value&&(t.duplicate=!0,this.formStates.value.map((function(e){e.include&&(t.namespaceMap[e.oldState]=e.newState)})));var n=new _n.a;n.graph.hidden=this.formTrimHidden.value,n.graph.clipped=this.formTrimClipped.value,this.saving=!0,this.store.dispatch(new mn.f(e,t,n))}},{key:"handleNameChange",value:function(e,t,n,i){var o=this;if(this.modulePath=this.modulesService.generateModulePath(e,t,n),this.formName.errors){var a=this.formName.errors,r=a.pattern,c=a.required;if(r||c)return}this.modulePath&&n.length&&this.modulesService.listContents(e,t,n).subscribe((function(e){o.moduleExists=e.length>0;var t=i&&o.moduleExists,a=!Jn.test(n);o.formName.setErrors(t||a?{invalid:!0}:null),o.formName.markAsDirty(),o.changeDetector.markForCheck()}))}},{key:"validateProductionSave",value:function(e){var t=e.get("primaryCategory"),n=e.get("confirmProduction");return t&&n&&"production"===t.value&&!1===n.value?{confirmProduction:!0}:null}},{key:"checkStateGroups",value:function(){var e=this,t=this.formStates.controls.map((function(t){return e.validateStateGroup(t)}));return t.length>0?Object(O.b).apply(void 0,a(t)):Object(k.a)([])}},{key:"validateStateGroup",value:function(e){var t=!0===this.formDuplicateStates.value,n=e.get("newState"),i=e.get("include");return t&&!1!==i.value?n.errors||0===n.value.length?Object(k.a)({stateControl:n,valid:!1}):this.modulesService.getState(n.value).pipe(Object(j.a)((function(e){var t=Jn.test(n.value);return{stateControl:n,valid:0===e.length&&t}}))):Object(k.a)({stateControl:n,valid:!0})}},{key:"updateFormStates",value:function(e){e.forEach((function(e){e.valid?(e.stateControl.setErrors(null),e.stateControl.markAsDirty()):e.stateControl.setErrors({stateTaken:!0})})),this.changeDetector.markForCheck()}},{key:"changeStatePrefix",value:function(e,t){this.formStates.controls.forEach((function(n){var i=n.get("newState");switch(t){case"prepend":i.setValue("".concat(e,"_").concat(i.value));break;case"replace":var o=new RegExp(/[^_]*/),a=i.value.replace(o,e);i.setValue(a)}}))}}]),e}()).\u0275fac=function(e){return new(e||Wn)(ve.Pb(y.h),ve.Pb(y.b),ve.Pb(ae.f),ve.Pb(Tn.a),ve.Pb(ve.i),ve.Pb(ke.b),ve.Pb(re.g),ve.Pb(re.a))},Wn.\u0275cmp=ve.Jb({type:Wn,selectors:[["app-save-module-dialog"]],decls:38,vars:15,consts:[["mat-dialog-title",""],["mat-dialog-content","","data-test","saveDialog",1,"theme-light"],[3,"formGroup","submit"],["data-test","duplicateStates","formControlName","duplicateStates"],[1,"text-12"],["form-field-help",""],["data-test","trimHidden","formControlName","trimHidden"],["formControlName","trimClipped",1,"ml-4"],["class","text-danger pt-2",4,"ngIf"],[1,"mb-4"],["label","Primary Category"],["data-test","primaryCategory","formControlName","primaryCategory",1,"input"],[3,"value",4,"ngFor","ngForOf"],["label","Secondary Category",4,"ngIf"],["label","Name"],["data-test","moduleName","type","text","formControlName","name",1,"input","w-100"],["name",""],["class","pt-2 text-12",4,"ngIf"],["label","Production Save",4,"ngIf"],[4,"ngIf"],["mat-dialog-actions",""],["app-button","","buttonTheme","light","type","button",1,"mr-2",3,"mat-dialog-close"],["app-button","","data-test","saveModuleSubmit","buttonTheme","light","buttonType","primary",3,"disabled","click"],[1,"text-danger","pt-2"],["icon","exclamation-circle"],[1,"pl-2","text-12"],[3,"value"],["label","Secondary Category"],["data-test","secondaryCategory","formControlName","secondaryCategory",1,"input"],[1,"pt-2","text-12"],["class","text-info",4,"ngIf"],["class","text-danger",4,"ngIf"],["class","text-success",4,"ngIf"],[1,"text-info"],["icon","exclamation-triangle"],[1,"pl-2"],[1,"pl-2","text-bold"],[1,"text-danger"],[1,"text-success"],["icon","check-circle"],["label","Production Save"],["formControlName","confirmProduction"],[1,"mv-4"],["label","Prefix"],[1,"flex"],["type","text","pattern","[^ ]*",1,"input","flex-25","w-25"],["prefix",""],["data-test","prefixReplace","type","button","app-button","","buttonType","outline","buttonTheme","light",1,"ml-2",3,"click"],["data-test","prefixPrepend","type","button","app-button","","buttonType","outline","buttonTheme","light",1,"ml-2",3,"click"],["formArrayName","states",1,"pv-4","text-12"],["class","mb-2",4,"ngFor","ngForOf"],[1,"mb-2"],[3,"formGroupName"],[1,"flex-shrink","pr-2","pt-2"],["data-test","includeState","formControlName","include","matTooltip","Include State"],[1,"flex-grow"],["data-test","oldState","type","hidden","formControlName","oldState",1,"input"],["data-test","newState","type","text","formControlName","newState",1,"input"],["size","medium","render","inline",1,"ml-2"]],template:function(e,t){if(1&e&&(ve.Vb(0,"h1",0),ve.Pc(1,"Save Module"),ve.Ub(),ve.Vb(2,"div",1),ve.Vb(3,"form",2),ve.cc("submit",(function(){return t.handleSubmit()})),ve.Vb(4,"app-form-field"),ve.Vb(5,"mat-checkbox",3),ve.Vb(6,"span",4),ve.Pc(7,"Duplicate Content States"),ve.Ub(),ve.Ub(),ve.Vb(8,"div",5),ve.Pc(9," This requires that you specify the location for the new module, and new unused names for each of the content states. "),ve.Ub(),ve.Ub(),ve.Vb(10,"app-form-field"),ve.Vb(11,"mat-checkbox",6),ve.Vb(12,"span",4),ve.Pc(13,"Trim Hidden Objects"),ve.Ub(),ve.Ub(),ve.Vb(14,"mat-checkbox",7),ve.Vb(15,"span",4),ve.Pc(16,"Trim Clipped Objects"),ve.Ub(),ve.Ub(),ve.Nc(17,jn,4,0,"div",8),ve.Ub(),ve.Qb(18,"mat-divider",9),ve.Vb(19,"app-form-field",10),ve.Vb(20,"select",11),ve.Nc(21,Nn,2,2,"option",12),ve.hc(22,"async"),ve.Ub(),ve.Ub(),ve.Nc(23,An,4,3,"app-form-field",13),ve.hc(24,"async"),ve.Vb(25,"app-form-field",14),ve.Qb(26,"input",15,16),ve.Nc(28,Ln,4,3,"div",17),ve.Ub(),ve.Nc(29,Bn,4,0,"app-form-field",18),ve.Nc(30,$n,12,1,"div",19),ve.Ub(),ve.Ub(),ve.Vb(31,"div",20),ve.Vb(32,"button",21),ve.Pc(33," Cancel "),ve.Ub(),ve.Vb(34,"button",22),ve.cc("click",(function(){return t.handleSubmit()})),ve.Nc(35,qn,3,0,"ng-container",19),ve.Nc(36,Gn,3,0,"ng-container",19),ve.Nc(37,Hn,2,0,"ng-container",19),ve.Ub(),ve.Ub()),2&e){var n,i=ve.yc(27);ve.Db(3),ve.mc("formGroup",t.form),ve.Db(14),ve.mc("ngIf",t.formTrimClipped.value),ve.Db(4),ve.mc("ngForOf",ve.ic(22,11,t.primaryCategoryOptions$)),ve.Db(2),ve.mc("ngIf",null==(n=ve.ic(24,13,t.secondaryCategoryOptions$))?null:n.length),ve.Db(5),ve.mc("ngIf",t.modulePath&&i.value.length),ve.Db(1),ve.mc("ngIf","production"===t.formPrimaryCategory.value),ve.Db(1),ve.mc("ngIf",t.formDuplicateStates.value),ve.Db(4),ve.mc("disabled",t.saving||!t.form.valid||t.validating),ve.Db(1),ve.mc("ngIf",t.validating),ve.Db(1),ve.mc("ngIf",t.saving),ve.Db(1),ve.mc("ngIf",!t.validating&&!t.saving)}},directives:[re.h,re.e,ae.E,ae.s,ae.j,Oe.a,Ue.a,ae.r,ae.i,f.p,_e.a,ae.B,f.o,ae.c,re.c,Pe.a,re.d,yt.a,ae.v,ae.D,ae.e,ae.k,Ct.c,Vn.a],pipes:[f.b],styles:[""],changeDetection:0}),Dn([Object(y.e)(Mn.a.getSaveModule),En("design:type",_.a)],Wn.prototype,"saveModule$",void 0),Dn([Object(y.e)(Mn.a.getPrimaryCategoryOptions("write")),En("design:type",_.a)],Wn.prototype,"primaryCategoryOptions$",void 0),Dn([Object(y.e)(Mn.a.getSecondaryCategoryOptions),En("design:type",_.a)],Wn.prototype,"secondaryCategoryOptions$",void 0),Wn),Zn=o("5sb6"),Yn=o("g408"),ei=o("Y7Bv"),ti=o("FFWI"),ni=o("QkH1"),ii=o("h8op"),oi=o("Vrox"),ai=[.1,.25,.5,1,1.5,2];!function(e){var t=function e(t){l(this,e),this.scale=t};t.type="[Edit Timeline] Set Scale",e.SetScale=t;var n=function e(t){l(this,e),this.selectedTimelineMapIds=t};n.type="[Edit Timeline] Set selectedTimelineMapIds",e.SetSelectedTimelineMapIds=n;var i=function e(t){l(this,e),this.selectedTimelineMapIds=t};i.type="[Edit Timeline] Add to selectedTimelineMapIds",e.AddToSelectedTimelineMapIds=i;var o=function e(t){l(this,e),this.selectedTimelineMapIds=t};o.type="[Edit Timeline] Remove from selectedTimelineMapIds",e.RemoveFromSelectedTimelineMapIds=o;var a=function e(t){l(this,e),this.overlappingTimelineMapIds=t};a.type="[Edit Timeline] Set overlappingTimelineMapIds",e.SetOverlappingTimelineMapIds=a;var r=function e(t){l(this,e),this.copiedTimelineMaps=t};r.type="[Edit Timeline] Set copiedTimelineMaps",e.SetCopiedTimelineMaps=r}(Kn||(Kn={}));var ri,ci,si,li,pi=function e(){l(this,e)},ui=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},di=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},mi={scale:1,selectedTimelineMapIds:new Set([]),overlappingTimelineMapIds:new Set([]),copiedTimelineMaps:[]},hi=((ri=function(){function e(){l(this,e)}return u(e,[{key:"setScale",value:function(e,t){var n=t.scale;e.patchState({scale:n})}},{key:"setSelectedTimelineMapIds",value:function(e,t){var n=t.selectedTimelineMapIds;e.patchState({selectedTimelineMapIds:new Set(n)})}},{key:"addSelectedTimelineMapId",value:function(e,t){var n=e.getState().selectedTimelineMapIds;t.selectedTimelineMapIds.forEach((function(e){return n.add(e)})),e.patchState({selectedTimelineMapIds:new Set(Array.from(n))})}},{key:"removeSelectedTimelineMapId",value:function(e,t){var n=e.getState().selectedTimelineMapIds;t.selectedTimelineMapIds.forEach((function(e){return n.delete(e)})),e.patchState({selectedTimelineMapIds:new Set(Array.from(n))})}},{key:"setOverlappingTimelineMapIds",value:function(e,t){var n=t.overlappingTimelineMapIds;e.patchState({overlappingTimelineMapIds:new Set(n)})}},{key:"setCopiedTimelineMaps",value:function(e,t){var n=t.copiedTimelineMaps;e.patchState({copiedTimelineMaps:n})}}],[{key:"getScale",value:function(e){return e.scale}},{key:"getSelectedTimelineMapIds",value:function(e){return e.selectedTimelineMapIds}},{key:"getOverlappingTimelineMapIds",value:function(e){return e.overlappingTimelineMapIds}},{key:"getCopiedTimelineMaps",value:function(e){return e.copiedTimelineMaps}}]),e}()).\u0275fac=function(e){return new(e||ri)},ri.\u0275prov=ve.Lb({token:ri,factory:ri.\u0275fac}),ui([Object(y.a)(Kn.SetScale),di("design:type",Function),di("design:paramtypes",[Object,Kn.SetScale]),di("design:returntype",void 0)],ri.prototype,"setScale",null),ui([Object(y.a)(Kn.SetSelectedTimelineMapIds),di("design:type",Function),di("design:paramtypes",[Object,Kn.SetSelectedTimelineMapIds]),di("design:returntype",void 0)],ri.prototype,"setSelectedTimelineMapIds",null),ui([Object(y.a)(Kn.AddToSelectedTimelineMapIds),di("design:type",Function),di("design:paramtypes",[Object,Kn.AddToSelectedTimelineMapIds]),di("design:returntype",void 0)],ri.prototype,"addSelectedTimelineMapId",null),ui([Object(y.a)(Kn.RemoveFromSelectedTimelineMapIds),di("design:type",Function),di("design:paramtypes",[Object,Kn.RemoveFromSelectedTimelineMapIds]),di("design:returntype",void 0)],ri.prototype,"removeSelectedTimelineMapId",null),ui([Object(y.a)(Kn.SetOverlappingTimelineMapIds),di("design:type",Function),di("design:paramtypes",[Object,Kn.SetOverlappingTimelineMapIds]),di("design:returntype",void 0)],ri.prototype,"setOverlappingTimelineMapIds",null),ui([Object(y.a)(Kn.SetCopiedTimelineMaps),di("design:type",Function),di("design:paramtypes",[Object,Kn.SetCopiedTimelineMaps]),di("design:returntype",void 0)],ri.prototype,"setCopiedTimelineMaps",null),ui([Object(y.f)(),di("design:type",Function),di("design:paramtypes",[pi]),di("design:returntype",void 0)],ri,"getScale",null),ui([Object(y.f)(),di("design:type",Function),di("design:paramtypes",[pi]),di("design:returntype",void 0)],ri,"getSelectedTimelineMapIds",null),ui([Object(y.f)(),di("design:type",Function),di("design:paramtypes",[pi]),di("design:returntype",void 0)],ri,"getOverlappingTimelineMapIds",null),ui([Object(y.f)(),di("design:type",Function),di("design:paramtypes",[pi]),di("design:returntype",void 0)],ri,"getCopiedTimelineMaps",null),ri=ui([Object(y.g)({name:"editTimeline",defaults:mi})],ri)),bi=o("GUwF"),fi=o("82LM"),gi=o("0Yvn"),vi=o("RhC1"),yi=o("tgUM"),xi=o("1mir"),Ci=o("ihWl"),ki=o("Mgbk"),Pi=o("J9/X"),Oi=o("GCmh"),wi=o("TRdv"),Si=((si=function(){function e(t,n){l(this,e),this.store=t,this.dialogRef=n,this.actionMode=xi.a.Import,this.application=dn.a.application,this.contentType=sn.a.Module,this.ngUnsubscribe=new C.a}return u(e,[{key:"ngOnInit",value:function(){this.initGallery()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initGallery",value:function(){var e=new Ci.e("exports"),t=this.store.selectSnapshot(Oi.a.getSearchOptions)||new ki.a("",yi.f);this.store.dispatch(new Pi.a.SetCardActions({enabled:!1})),this.store.dispatch(new Pi.a.SetBulkActions({enabled:!1,items:[]})),this.store.dispatch(new Pi.a.SetSearchConfig(e)),this.store.dispatch(new Pi.a.SetSearchOptions(t))}},{key:"handleSelect",value:function(e){this.dialogRef.close(e)}}]),e}()).\u0275fac=function(e){return new(e||si)(ve.Pb(y.h),ve.Pb(re.g))},si.\u0275cmp=ve.Jb({type:si,selectors:[["app-merge-module-dialog"]],decls:5,vars:4,consts:[[1,"merge-module-dialog"],[1,"text-20","merge-module-dialog__header"],[1,"merge-module-dialog__body"],["selectLabel","Import",3,"actionMode","application","contentType","showSourcePicker","selectBookmark"]],template:function(e,t){1&e&&(ve.Vb(0,"div",0),ve.Vb(1,"div",1),ve.Pc(2,"Merge Module"),ve.Ub(),ve.Vb(3,"div",2),ve.Vb(4,"app-gallery-container",3),ve.cc("selectBookmark",(function(e){return t.handleSelect(e)})),ve.Ub(),ve.Ub(),ve.Ub()),2&e&&(ve.Db(4),ve.mc("actionMode",t.actionMode)("application",t.application)("contentType",t.contentType)("showSourcePicker",!1))},directives:[wi.a],styles:["[_nghost-%COMP%]{display:block;height:calc(90vh - 48px);width:calc(90vw - 48px);position:relative;padding:0 0 12px}.merge-module-dialog[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}.merge-module-dialog__header[_ngcontent-%COMP%]{border-bottom:1px solid rgba(0,0,0,.12);padding:8px 20px;display:flex;align-items:center}.merge-module-dialog__body[_ngcontent-%COMP%]{flex:1 0 auto;position:relative}"],changeDetection:0}),si),_i=((ci=function(){function e(t,n){l(this,e),this.dialogRef=t,this.data=n,this.resolve=new ae.g("loft")}return u(e,[{key:"ngOnInit",value:function(){}},{key:"handleCancelClick",value:function(){this.dialogRef.close()}},{key:"handleResolveClick",value:function(){this.dialogRef.close(this.resolve.value)}}]),e}()).\u0275fac=function(e){return new(e||ci)(ve.Pb(re.g),ve.Pb(re.a))},ci.\u0275cmp=ve.Jb({type:ci,selectors:[["app-merge-conflict-dialog"]],decls:21,vars:3,consts:[[1,"merge-conflict-dialog"],["mat-dialog-title",""],[1,"merge-conflict-dialog__message","mb-4"],["icon","info-circle",1,"merge-conflict-dialog__message-icon","mr-3"],[1,"text-12"],[1,"text-14","mb-3"],[1,"text-12","flex","flex-column",3,"formControl"],["value","loft",1,"mb-2"],["value","bridge"],["mat-dialog-actions","",1,"flex","justify-end"],["app-button","","buttonTheme","light","buttonType","default",1,"mr-4",3,"click"],["app-button","","buttonType","primary",3,"click"]],template:function(e,t){1&e&&(ve.Vb(0,"div",0),ve.Vb(1,"div",1),ve.Vb(2,"h1"),ve.Pc(3,"Resolve Merge Conflicts"),ve.Ub(),ve.Ub(),ve.Vb(4,"div"),ve.Vb(5,"div",2),ve.Qb(6,"app-icon",3),ve.Vb(7,"p",4),ve.Pc(8," There are conflicts with Particle Systems that prevent automatic merging. "),ve.Ub(),ve.Ub(),ve.Vb(9,"div",5),ve.Pc(10,"Choose which changes to accept"),ve.Ub(),ve.Vb(11,"mat-radio-group",6),ve.Vb(12,"mat-radio-button",7),ve.Pc(13),ve.Ub(),ve.Vb(14,"mat-radio-button",8),ve.Pc(15),ve.Ub(),ve.Ub(),ve.Ub(),ve.Vb(16,"div",9),ve.Vb(17,"button",10),ve.cc("click",(function(){return t.handleCancelClick()})),ve.Pc(18," Cancel "),ve.Ub(),ve.Vb(19,"button",11),ve.cc("click",(function(){return t.handleResolveClick()})),ve.Pc(20," Resolve and Merge "),ve.Ub(),ve.Ub(),ve.Ub()),2&e&&(ve.Db(11),ve.mc("formControl",t.resolve),ve.Db(2),ve.Rc("",t.data.loft," (current)"),ve.Db(2),ve.Rc("",t.data.bridge," (incoming)"))},directives:[re.h,yt.a,Dt.b,ae.r,ae.h,Dt.a,re.c,Pe.a],styles:[".merge-conflict-dialog[_ngcontent-%COMP%]{width:400px}.merge-conflict-dialog__message[_ngcontent-%COMP%]{display:flex;padding:12px;align-items:center;justify-content:center;background-color:#ffe2db;border-radius:4px}.merge-conflict-dialog__message-icon[_ngcontent-%COMP%]{color:#de3535}"],changeDetection:0}),ci),Mi=o("2Vo4"),Ui=o("/MKm"),Ti=o("wSC8"),Vi=o("jhN1"),Di=o("MKnA"),Ei=["previewBody"],ji=["previewIframe"],Ni=((li=function(){function e(t,n,i,o,a,r,c){l(this,e),this.dialogRef=t,this.publishService=n,this.changeDetectorRef=i,this.sanitizer=o,this.renderer=a,this.storageService=r,this.ngUnsubscribe=new C.a,this.viewerSize=new Mi.a({width:0,height:0,scale:1}),this.viewerType="desktop",this.sizes={desktop:{width:null,height:null},tablet:{width:768,height:1024},mobile:{width:360,height:640}},this.data=c}return u(e,[{key:"ngOnInit",value:function(){var e={id:"preview","ui-loader":"circle"};this.data.quizLocked&&(e["ui-quiz-locked"]=this.data.quizLocked,Object(ce.isNil)(this.data.questionNumber)||(e["ui-quiz-start"]=this.data.questionNumber+1,e["ui-quiz-end"]=this.data.questionNumber+1)),this.viewerUrl=this.sanitizer.bypassSecurityTrustResourceUrl(this.publishService.buildWidgetURL("/viewer",e)),dn.a.deploy===Ti.a.Local&&(this.viewerUrl=this.sanitizer.bypassSecurityTrustResourceUrl("/view?id=preview")),this.changeDetectorRef.markForCheck(),this.initSizeListener()}},{key:"ngAfterViewInit",value:function(){var e,t=this.previewBody.nativeElement.getBoundingClientRect(),n=null!==(e=this.storageService.getSessionItem(On.c.PreviewSize))&&void 0!==e?e:t;this.viewerWidth=t.width,this.viewerHeight=t.height,this.setSize({width:n.width,height:n.height})}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"onWidthChange",value:function(e){null!==e&&this.setSize({width:e,height:this.viewerSize.value.height})}},{key:"onHeightChange",value:function(e){null!==e&&this.setSize({width:this.viewerSize.value.width,height:e})}},{key:"handleCloseClick",value:function(){this.dialogRef.close()}},{key:"handlePublishClick",value:function(){this.dialogRef.close("publish")}},{key:"setSize",value:function(e){var t=this,n=this.calculateSize(this.viewerWidth,this.viewerHeight,e.width,e.height);this.viewerSize.next(n),this.viewerType="desktop",Object.entries(this.sizes).forEach((function(n){var i=r(n,2),o=i[0],a=i[1];Object(ce.isEqual)(a,e)&&(t.viewerType=o)}))}},{key:"initSizeListener",value:function(){var e=this;this.viewerSize.pipe(Object(N.a)(this.ngUnsubscribe),Object(Un.a)(300)).subscribe((function(t){e.renderer.setStyle(e.previewIframe.nativeElement,"width",t.width+"px"),e.renderer.setStyle(e.previewIframe.nativeElement,"height",t.height+"px"),e.renderer.setStyle(e.previewIframe.nativeElement,"transform","scale("+t.scale),e.renderer.setStyle(e.previewBody.nativeElement,"width",e.viewerWidth+"px"),e.renderer.setStyle(e.previewBody.nativeElement,"height",e.viewerHeight+"px"),e.storageService.setSessionItem(On.c.PreviewSize,{width:t.width,height:t.height}),e.changeDetectorRef.markForCheck()}))}},{key:"calculateSize",value:function(e,t,n,i){var o=1;return i=null===i?t:i,((n=null===n?e:n)>e||i>t)&&(o=n>i?e/n:t/i),{width:Math.floor(n),height:Math.floor(i),scale:o}}}]),e}()).\u0275fac=function(e){return new(e||li)(ve.Pb(re.g),ve.Pb(Ui.b),ve.Pb(ve.i),ve.Pb(Vi.b),ve.Pb(ve.H),ve.Pb(On.d),ve.Pb(re.a))},li.\u0275cmp=ve.Jb({type:li,selectors:[["app-edit-preview-dialog"]],viewQuery:function(e,t){var n;1&e&&(ve.Vc(Ei,!0),ve.Vc(ji,!0)),2&e&&(ve.xc(n=ve.dc())&&(t.previewBody=n.first),ve.xc(n=ve.dc())&&(t.previewIframe=n.first))},decls:25,vars:6,consts:[["data-test","preview",1,"preview"],[1,"preview__header"],[1,"text-20","text-semibold"],[1,"flex","theme-light","items-center"],["data-test","previewDesktopButton","app-button","","buttonTheme","light",1,"mr-1",3,"selected","click"],["icon","desktop"],["data-test","previewTabletButton","app-button","","buttonTheme","light",1,"mr-1",3,"selected","click"],["icon","tablet-alt"],["data-test","previewMobileButton","app-button","","buttonTheme","light",3,"selected","click"],["icon","mobile-alt"],[1,"mh-3"],["isCompact","true","display","inline","label","width",1,"mr-4"],["data-test","previewWidth","type","number","min","1",1,"input",2,"width","80px",3,"ngModel","ngModelChange"],["isCompact","true","display","inline","label","height"],["data-test","previewHeight","type","number","min","1",1,"input",2,"width","80px",3,"ngModel","ngModelChange"],["data-test","previewPublish","app-button","","buttonType","primary","buttonTheme","light",3,"click"],["data-test","previewClose","app-button","","buttonTheme","light",1,"ml-2",3,"click"],["icon","times","size","lg"],[1,"preview__body"],["previewBody",""],["data-test","previewIframe",1,"preview__iframe",3,"src"],["previewIframe",""]],template:function(e,t){1&e&&(ve.Vb(0,"div",0),ve.Vb(1,"div",1),ve.Vb(2,"div",2),ve.Pc(3,"Preview"),ve.Ub(),ve.Vb(4,"div",3),ve.Vb(5,"button",4),ve.cc("click",(function(){return t.setSize(t.sizes.desktop)})),ve.Qb(6,"app-icon",5),ve.Ub(),ve.Vb(7,"button",6),ve.cc("click",(function(){return t.setSize(t.sizes.tablet)})),ve.Qb(8,"app-icon",7),ve.Ub(),ve.Vb(9,"button",8),ve.cc("click",(function(){return t.setSize(t.sizes.mobile)})),ve.Qb(10,"app-icon",9),ve.Ub(),ve.Qb(11,"app-divider",10),ve.Vb(12,"app-form-field",11),ve.Vb(13,"input",12),ve.cc("ngModelChange",(function(e){return t.onWidthChange(e)})),ve.Ub(),ve.Ub(),ve.Vb(14,"app-form-field",13),ve.Vb(15,"input",14),ve.cc("ngModelChange",(function(e){return t.onHeightChange(e)})),ve.Ub(),ve.Ub(),ve.Ub(),ve.Vb(16,"div"),ve.Vb(17,"button",15),ve.cc("click",(function(){return t.handlePublishClick()})),ve.Pc(18," Save & Publish "),ve.Ub(),ve.Vb(19,"button",16),ve.cc("click",(function(){return t.handleCloseClick()})),ve.Qb(20,"app-icon",17),ve.Ub(),ve.Ub(),ve.Ub(),ve.Vb(21,"div",18,19),ve.Qb(23,"iframe",20,21),ve.Ub(),ve.Ub()),2&e&&(ve.Db(5),ve.mc("selected","desktop"===t.viewerType),ve.Db(2),ve.mc("selected","tablet"===t.viewerType),ve.Db(2),ve.mc("selected","mobile"===t.viewerType),ve.Db(4),ve.mc("ngModel",t.viewerSize.value.width),ve.Db(2),ve.mc("ngModel",t.viewerSize.value.height),ve.Db(8),ve.mc("src",t.viewerUrl,ve.Ec))},directives:[Pe.a,yt.a,Di.a,Oe.a,ae.w,ae.c,ae.r,ae.u],styles:[".preview[_ngcontent-%COMP%]{border-radius:4px;background:#fff;display:flex;flex-direction:column;padding:12px;height:100%}.preview__header[_ngcontent-%COMP%]{flex:0 0 auto;display:flex;align-items:center;justify-content:space-between;padding-bottom:12px}.preview__body[_ngcontent-%COMP%]{flex:1 1 auto;display:flex;justify-content:center;align-items:center;position:relative}.preview__iframe[_ngcontent-%COMP%]{border:1px solid #eaeff5;width:100%;height:100%;position:absolute}"],changeDetection:0}),li),Ri=o("WkFQ"),Ai=o("WUhe"),Fi=o("XqAe"),Ii=o("PV7u"),zi=o("937/"),Li=o("kTA6"),Bi=o("L2KA"),Qi=o("J5ja"),$i=o("MuXT"),qi=o("6/b0"),Gi=o("vm16"),Hi=o("cQmI"),Wi=o("Y+XQ"),Ki=o("STbY");function Ji(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"button",5),ve.cc("click",(function(){ve.Cc(n);var e=t.$implicit;return ve.gc().setViewMode(e.key)})),ve.Vb(1,"div",6),ve.Pc(2),ve.Ub(),ve.Vb(3,"div",7),ve.Pc(4),ve.Ub(),ve.Ub()}if(2&e){var i=t.$implicit;ve.Db(2),ve.Qc(i.value.label),ve.Db(2),ve.Qc(i.value.description)}}var Xi,Zi,Yi=((Xi=function(){function e(t){var n;l(this,e),this.store=t,this.bookmarkViewMode=Hi.a,this.viewLabels=(d(n={},Hi.a.All,{label:"View & Quiz",color:Wi.a.Gray,description:"Enable both View mode and Quiz mode."}),d(n,Hi.a.Content,{label:"View only",color:Wi.a.Green,description:"Enable View mode only, and disable Quiz mode."}),d(n,Hi.a.Quiz,{label:"Quiz only",color:Wi.a.Purple,description:"Enable Quiz mode only, and disable View mode."}),n),this.viewLabel=this.viewLabels[Hi.a.All],this._viewMode=Hi.a.All}return u(e,[{key:"viewMode",get:function(){return this._viewMode},set:function(e){var t;null!=e&&(this._viewMode=e,this.viewLabel=null!==(t=this.viewLabels[this.viewMode])&&void 0!==t?t:this.viewLabels[Hi.a.All])}},{key:"ngOnInit",value:function(){}},{key:"setViewMode",value:function(e){this.store.dispatch(new ee.F(e))}}]),e}()).\u0275fac=function(e){return new(e||Xi)(ve.Pb(y.h))},Xi.\u0275cmp=ve.Jb({type:Xi,selectors:[["app-edit-bookmark-view-mode"]],inputs:{viewMode:"viewMode"},decls:6,vars:6,consts:[["app-button","","buttonTheme","dark","buttonType","text","data-test","viewModeButton",3,"matMenuTriggerFor"],["icon","caret-down",3,"label","color"],["data-test","viewModeMenu"],["menu","matMenu"],["class","view-mode-item","mat-menu-item","","data-test","viewModeItem",3,"click",4,"ngFor","ngForOf"],["mat-menu-item","","data-test","viewModeItem",1,"view-mode-item",3,"click"],[1,"text-12"],[1,"text-11"]],template:function(e,t){if(1&e&&(ve.Vb(0,"button",0),ve.Qb(1,"app-tag",1),ve.Ub(),ve.Vb(2,"mat-menu",2,3),ve.Nc(4,Ji,5,2,"button",4),ve.hc(5,"keyvalue"),ve.Ub()),2&e){var n=ve.yc(3);ve.mc("matMenuTriggerFor",n),ve.Db(1),ve.mc("label",t.viewLabel.label)("color",t.viewLabel.color),ve.Db(3),ve.mc("ngForOf",ve.ic(5,4,t.viewLabels))}},directives:[Pe.a,Ki.d,Wi.b,Ki.a,f.o,Ki.b],pipes:[f.i],styles:["button.view-mode-item[_ngcontent-%COMP%]{white-space:normal;height:auto;text-overflow:clip;line-height:normal;padding:8px 16px}"],changeDetection:0}),Xi),eo=o("wn8Z"),to=o("XqLm"),no=o("llWQ"),io=o("/uUt"),oo=o("5miH"),ao=o("C9yA"),ro=o("HdmJ"),co=[[["","column-group-header",""]],[["","column-group-body",""]]],so=["[column-group-header]","[column-group-body]"],lo=((Zi=function(){function e(t,n){l(this,e),this.renderer=t,this.element=n,this._isActive=!1}return u(e,[{key:"isActive",get:function(){return this._isActive},set:function(e){this._isActive=e,this.show(this.isActive)}},{key:"ngOnInit",value:function(){}},{key:"show",value:function(e){this.renderer.setStyle(this.element.nativeElement,"display",this.isActive?"flex":"none")}}]),e}()).\u0275fac=function(e){return new(e||Zi)(ve.Pb(ve.H),ve.Pb(ve.m))},Zi.\u0275cmp=ve.Jb({type:Zi,selectors:[["app-column-group"]],inputs:{label:"label",isActive:"isActive"},ngContentSelectors:so,decls:5,vars:0,consts:[[1,"column-group"],[1,"column-group__header"],[1,"column-group__body"]],template:function(e,t){1&e&&(ve.lc(co),ve.Vb(0,"div",0),ve.Vb(1,"div",1),ve.kc(2),ve.Ub(),ve.Vb(3,"div",2),ve.kc(4,1),ve.Ub(),ve.Ub())},styles:[".column-group[_ngcontent-%COMP%], [_nghost-%COMP%]{display:flex;flex-direction:column;flex:1 1 auto;overflow:hidden}.column-group[_ngcontent-%COMP%]{height:100%}.theme-light[_nghost-%COMP%]   .column-group__body[_ngcontent-%COMP%], .theme-light   [_nghost-%COMP%]   .column-group__body[_ngcontent-%COMP%]{border-color:transparent}.column-group__header[_ngcontent-%COMP%]{flex:0 1 auto;padding:8px 8px 12px}.column-group__header[_ngcontent-%COMP%]:empty{display:none}.column-group__body[_ngcontent-%COMP%]{border-top:1px solid #283853;display:flex;flex-direction:column;flex:1 1 100%;overflow:scroll;padding:0 12px 0 0}"],changeDetection:0}),Zi);function po(e,t){if(1&e&&(ve.Vb(0,"div",4),ve.Qb(1,"app-spinner",5),ve.Vb(2,"div",6),ve.Pc(3),ve.Ub(),ve.Ub()),2&e){var n=ve.gc();ve.Db(3),ve.Qc(n.loadingLabel)}}function uo(e,t){1&e&&(ve.Vb(0,"div",7),ve.Vb(1,"div",8),ve.Vb(2,"div",9),ve.kc(3),ve.Ub(),ve.Vb(4,"div",10),ve.kc(5,1),ve.Ub(),ve.Vb(6,"div",11),ve.kc(7,2),ve.Ub(),ve.Ub(),ve.kc(8,3),ve.Ub())}var mo=function(e){return{"column__tab--selected":e}};function ho(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"span",17),ve.cc("click",(function(){ve.Cc(n);var e=t.$implicit;return ve.gc(3).handleColumnGroupSelect(e)})),ve.Vb(1,"div",18),ve.Pc(2),ve.Ub(),ve.Ub()}if(2&e){var i=t.$implicit,o=ve.gc(3);ve.mc("ngClass",ve.pc(3,mo,o.isColumnGroupSelected(i))),ve.Db(1),ve.Eb("data-test","column"+i.label),ve.Db(1),ve.Rc(" ",i.label," ")}}function bo(e,t){if(1&e&&(ve.Vb(0,"div",15),ve.Nc(1,ho,3,5,"span",16),ve.Ub()),2&e){var n=ve.gc(2);ve.Db(1),ve.mc("ngForOf",n.columnGroups)}}function fo(e,t){1&e&&(ve.Vb(0,"div",19),ve.kc(1,5),ve.Ub())}function go(e,t){if(1&e&&(ve.Tb(0),ve.Nc(1,bo,2,1,"div",12),ve.Vb(2,"div",13),ve.kc(3,4),ve.Ub(),ve.Nc(4,fo,2,0,"div",14),ve.Sb()),2&e){var n=ve.gc();ve.Db(1),ve.mc("ngIf",n.columnGroups.length>1),ve.Db(3),ve.mc("ngIf",!n.loading)}}var vo,yo=[[["","column-nav",""]],[["","column-label",""]],[["","column-actions",""]],[["","column-header",""]],[["app-column-group"]],[["","column-footer",""]]],xo=["[column-nav]","[column-label]","[column-actions]","[column-header]","app-column-group","[column-footer]"],Co=function e(t,n,i){l(this,e),this.index=t,this.label=n,this.component=i},ko=((vo=function(){function e(){l(this,e),this.showHeader=!0,this.loading=!1,this.loadingLabel="",this._selectedColumnGroup=new Mi.a(0),this.selectedColumnGroupChange=new ve.p,this.next=new ve.p,this.previous=new ve.p,this.ngUnsubscribe=new C.a}return u(e,[{key:"selectedColumnGroup",get:function(){return this._selectedColumnGroup.value},set:function(e){null!=e&&e!==this.selectedColumnGroup&&("string"==typeof e&&(e=e.toUpperCase()),this._selectedColumnGroup.next(e),this.selectedColumnGroupChange.emit(e))}},{key:"ngAfterContentInit",value:function(){var e=this;this.mapContentGroups(),this._selectedColumnGroup.pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.showColumnGroup(t)}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"handleColumnGroupSelect",value:function(e){this.selectedColumnGroup=e.label}},{key:"mapContentGroups",value:function(){this.columnGroups=this.columnGroupsQuery.map((function(e,t){return new Co(t,e.label,e)}))}},{key:"showColumnGroup",value:function(e){this.columnGroups.forEach((function(t,n){switch(typeof e){case"number":t.component.isActive=e===n;break;case"string":t.component.isActive=e.toString().toUpperCase()===t.label.toUpperCase()}}))}},{key:"isColumnGroupSelected",value:function(e){return("string"==typeof this._selectedColumnGroup.value?e.label.toUpperCase():e.index)===this._selectedColumnGroup.value}}]),e}()).\u0275fac=function(e){return new(e||vo)},vo.\u0275cmp=ve.Jb({type:vo,selectors:[["app-column"]],contentQueries:function(e,t,n){var i;1&e&&ve.Ib(n,lo,!1),2&e&&ve.xc(i=ve.dc())&&(t.columnGroupsQuery=i)},inputs:{label:"label",showHeader:"showHeader",loading:"loading",loadingLabel:"loadingLabel",selectedColumnGroup:"selectedColumnGroup"},outputs:{selectedColumnGroupChange:"selectedColumnGroupChange",next:"next",previous:"previous"},ngContentSelectors:xo,decls:4,vars:3,consts:[[1,"column"],["class","column__loading",4,"ngIf"],["class","column__header",4,"ngIf"],[4,"ngIf"],[1,"column__loading"],["size","large"],[1,"column__loading-label"],[1,"column__header"],[1,"column__title"],[1,"column__nav"],[1,"column__label"],[1,"column__actions"],["class","column__tabs",4,"ngIf"],[1,"column__group"],["class","column__footer",4,"ngIf"],[1,"column__tabs"],["class","column__tab",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"column__tab",3,"ngClass","click"],[1,"column__tab-label"],[1,"column__footer"]],template:function(e,t){1&e&&(ve.lc(yo),ve.Vb(0,"div",0),ve.Nc(1,po,4,1,"div",1),ve.Nc(2,uo,9,0,"div",2),ve.Nc(3,go,5,2,"ng-container",3),ve.Ub()),2&e&&(ve.Db(1),ve.mc("ngIf",t.loading),ve.Db(1),ve.mc("ngIf",t.showHeader&&!t.loading),ve.Db(1),ve.mc("ngIf",!t.loading))},directives:[f.p,Vn.a,f.o,f.m],styles:['.text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}[_nghost-%COMP%]{overflow:hidden}.column[_ngcontent-%COMP%], [_nghost-%COMP%]{display:flex;flex-direction:column;height:100%;flex:1 1 auto}.column[_ngcontent-%COMP%]{overflow-y:hidden}.theme-light[_nghost-%COMP%]   .column__tab[_ngcontent-%COMP%], .theme-light   [_nghost-%COMP%]   .column__tab[_ngcontent-%COMP%]{color:#61779e}.theme-light[_nghost-%COMP%]   .column__tab--selected[_ngcontent-%COMP%], .theme-light   [_nghost-%COMP%]   .column__tab--selected[_ngcontent-%COMP%], .theme-light[_nghost-%COMP%]   .column__tab[_ngcontent-%COMP%]:hover, .theme-light   [_nghost-%COMP%]   .column__tab[_ngcontent-%COMP%]:hover{color:#131c2a}.theme-light[_nghost-%COMP%]   .column__footer[_ngcontent-%COMP%], .theme-light   [_nghost-%COMP%]   .column__footer[_ngcontent-%COMP%]{border-color:#f9fafd}.column__loading[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex:1 1 100%;flex-direction:column}.column__loading-label[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase;padding-top:8px;color:hsla(0,0%,100%,.5)}.column__header[_ngcontent-%COMP%]{flex:0 0 auto}.column__tabs[_ngcontent-%COMP%]{display:flex;flex:0 0 auto;padding:8px 12px 0}.column__tab[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase;color:#96a8c0;padding:8px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.column__tab[_ngcontent-%COMP%]:first-child{padding-left:0}.column__tab[_ngcontent-%COMP%]:after{content:"";display:block;border-bottom:3px solid #2d72dc;margin-top:4px;width:0;transition:.25s ease}.column__tab[_ngcontent-%COMP%]:hover{color:#fff;cursor:pointer}.column__tab--selected[_ngcontent-%COMP%]{color:#fff}.column__tab--selected[_ngcontent-%COMP%]:after{width:100%}.column__tab-label[_ngcontent-%COMP%]{padding:0 4px}.column__title[_ngcontent-%COMP%]{align-items:center;flex:1 1 100%;display:flex;min-height:48px;padding:0 8px}.column__arrow[_ngcontent-%COMP%]{flex:0 0 32px;display:flex}.column__nav[_ngcontent-%COMP%]{display:flex}.column__label[_ngcontent-%COMP%]{flex:1 1 auto;display:flex;min-height:28px;align-items:center;padding:0 8px}.column__actions[_ngcontent-%COMP%]{flex:0 1 auto}.column__search[_ngcontent-%COMP%]{padding:0 12px 8px}.column__body[_ngcontent-%COMP%]{height:100%;overflow-y:scroll}.column__footer[_ngcontent-%COMP%]{border-top:1px solid #283853;flex:0 0 auto}.column__group[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex:1 1 100%;height:100%;overflow:hidden}.column__group-header[_ngcontent-%COMP%]{flex:0 1 auto}'],changeDetection:0}),vo);o("nRae"),o("yG3n");var Po,Oo=o("ewuU"),wo=o("b36G"),So=o("ve2m"),_o=o("4qFM"),Mo=o("awCs"),Uo=((Po=function(){function e(t){l(this,e),this.domSanitizer=t,this.size="medium"}return u(e,[{key:"isTransparent",get:function(){return this.color&&Oo.a.isTransparent(this.color)}},{key:"ngOnInit",value:function(){}},{key:"getBackgroundCSS",value:function(){if(this.color&&!this.isTransparent){var e=Oo.a.toCSS(this.color);return this.domSanitizer.bypassSecurityTrustStyle(e)}return null}}]),e}()).\u0275fac=function(e){return new(e||Po)(ve.Pb(Vi.b))},Po.\u0275cmp=ve.Jb({type:Po,selectors:[["app-swatch-item"]],inputs:{color:"color",size:"size",selected:"selected"},decls:1,vars:16,consts:[[1,"item"]],template:function(e,t){1&e&&ve.Qb(0,"div",0),2&e&&(ve.Kc("background-image",t.getBackgroundCSS()),ve.Hb("item--x-small","x-small"===t.size)("item--small","small"===t.size)("item--medium","medium"===t.size)("item--large","large"===t.size)("item--x-large","x-large"===t.size)("item--selected",t.selected)("item--transparent",t.isTransparent))},styles:[".item[_ngcontent-%COMP%]{border:1px solid #eaeff5;border-radius:1px;cursor:pointer}.item--small[_ngcontent-%COMP%]{width:12px;height:12px}.item--medium[_ngcontent-%COMP%]{width:24px;height:24px}.item--large[_ngcontent-%COMP%]{width:36px;height:36px}.item--selected[_ngcontent-%COMP%]{border-color:#2d72dc;border-width:2px}.item--transparent[_ngcontent-%COMP%]{background:linear-gradient(45deg,#f9fafd 48%,#de3535 50%,#f9fafd 52%)}"],changeDetection:0}),Po),To=o("RGY+"),Vo=o("FYjP"),Do=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},Eo=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},jo=["presetTab"],No=["customTab"];function Ro(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"app-swatch-item",24),ve.cc("click",(function(){ve.Cc(n);var e=t.$implicit;return ve.gc().handlePresetSelected(e)})),ve.Ub()}if(2&e){var i=t.$implicit,o=ve.gc();ve.mc("color",i)("size","medium")("selected",o.backgroundsEqual(i,o.presetBackground))}}function Ao(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"app-swatch-item",25),ve.cc("click",(function(){ve.Cc(n);var e=t.$implicit;return ve.gc().handlePresetSelected(e)})),ve.Ub()}2&e&&ve.mc("color",t.$implicit)("size","medium")}function Fo(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"div"),ve.Vb(1,"app-form-field",26),ve.Vb(2,"input",27),ve.cc("colorPickerChange",(function(e){return ve.Cc(n),ve.gc().handleFormColorSelected("color1",e)})),ve.Ub(),ve.Ub(),ve.Ub()}if(2&e){var i=ve.gc();ve.Db(2),ve.Kc("background",i.getFormBackgroundHex("color1")),ve.mc("colorPicker",i.getFormBackgroundHex("color1"))("cpOutputFormat","hex")("cpAlphaChannel","disabled")}}function Io(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"div"),ve.Vb(1,"app-form-field",28),ve.Vb(2,"input",27),ve.cc("colorPickerChange",(function(e){return ve.Cc(n),ve.gc().handleFormColorSelected("color1",e)})),ve.Ub(),ve.Ub(),ve.Vb(3,"app-form-field",29),ve.Qb(4,"app-slider",30),ve.Ub(),ve.Vb(5,"app-form-field",31),ve.Vb(6,"input",27),ve.cc("colorPickerChange",(function(e){return ve.Cc(n),ve.gc().handleFormColorSelected("color2",e)})),ve.Ub(),ve.Ub(),ve.Vb(7,"app-form-field",32),ve.Qb(8,"app-slider",33),ve.Ub(),ve.Ub()}if(2&e){var i=ve.gc();ve.Db(2),ve.Kc("background",i.getFormBackgroundHex("color1")),ve.mc("colorPicker",i.getFormBackgroundHex("color1"))("cpOutputFormat","hex")("cpAlphaChannel","disabled"),ve.Db(2),ve.mc("min",0)("max",100),ve.Db(2),ve.Kc("background",i.getFormBackgroundHex("color2")),ve.mc("colorPicker",i.getFormBackgroundHex("color2"))("cpOutputFormat","hex")("cpAlphaChannel","disabled"),ve.Db(2),ve.mc("min",0)("max",100)}}function zo(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"div"),ve.Vb(1,"app-form-field",34),ve.Vb(2,"input",27),ve.cc("colorPickerChange",(function(e){return ve.Cc(n),ve.gc().handleFormColorSelected("color1",e)})),ve.Ub(),ve.Ub(),ve.Vb(3,"app-form-field",35),ve.Qb(4,"app-slider",30),ve.Ub(),ve.Vb(5,"app-form-field",36),ve.Vb(6,"input",27),ve.cc("colorPickerChange",(function(e){return ve.Cc(n),ve.gc().handleFormColorSelected("color2",e)})),ve.Ub(),ve.Ub(),ve.Vb(7,"app-form-field",37),ve.Qb(8,"app-slider",33),ve.Ub(),ve.Ub()}if(2&e){var i=ve.gc();ve.Db(2),ve.Kc("background",i.getFormBackgroundHex("color1")),ve.mc("colorPicker",i.getFormBackgroundHex("color1"))("cpOutputFormat","hex")("cpAlphaChannel","disabled"),ve.Db(2),ve.mc("min",0)("max",100),ve.Db(2),ve.Kc("background",i.getFormBackgroundHex("color2")),ve.mc("colorPicker",i.getFormBackgroundHex("color2"))("cpOutputFormat","hex")("cpAlphaChannel","disabled"),ve.Db(2),ve.mc("min",0)("max",100)}}function Lo(e,t){1&e&&(ve.Vb(0,"div"),ve.Vb(1,"app-alert",38),ve.Pc(2," The background of your application will appear behind the 3D model. "),ve.Ub(),ve.Ub())}var Bo,Qo,$o,qo,Go=((Bo=function(){function e(t,n,i,o){l(this,e),this.store=t,this.actions=n,this.fb=i,this.snackBar=o,this.presetBackgrounds="module"===dn.a.exportType?Object(wo.plainToClass)(Oo.a,So.b):Object(wo.plainToClass)(Oo.a,So.c),this.ngUnsubscribe=new C.a}return u(e,[{key:"ngOnInit",value:function(){var e=this;this.initPresets(),this.initForm(),this.actions.pipe(Object(y.k)(J.r),Object(N.a)(this.ngUnsubscribe)).subscribe((function(){e.snackBar.open("Successfully applied color to all chapters.")}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initPresets",value:function(){var e=this;this.presetBackground=this.store.selectSnapshot(X.a.getSelectedChapterBackground),this.background$.pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.presetBackground=t})),this.allChapterBackgrounds$.pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.distinctBackgrounds=t.filter((function(n,i){return t.findIndex((function(t){return e.backgroundsEqual(n,t)}))===i}))}))}},{key:"initForm",value:function(){var e=this,t=this.store.selectSnapshot(X.a.getSelectedChapterBackground);this.form=this.fb.group({type:["solid",[ae.C.required]],color1:["",[ae.C.required]],stop1:[0,[ae.C.required,ae.C.min(0),ae.C.max(100)]],color2:["",[ae.C.required]],stop2:[100,[ae.C.required,ae.C.min(0),ae.C.max(100)]]}),this.form.valueChanges.pipe(Object(R.a)((function(){return e.customTab.isActive})),Object(N.a)(this.ngUnsubscribe)).subscribe((function(){e.applyFromCustom()})),t&&this.setCustomColorForm(t)}},{key:"handleFormColorSelected",value:function(e,t){this.form.get(e).setValue(t)}},{key:"handlePresetSelected",value:function(e){this.presetBackground=e,this.store.dispatch(new J.I(e))}},{key:"handleResetClick",value:function(){this.store.dispatch(new J.n)}},{key:"handleTabChange",value:function(e){this.customTab.isActive&&this.presetBackground&&this.setCustomColorForm(this.presetBackground)}},{key:"backgroundsEqual",value:function(e,t){return Object(ce.isEqual)(e,t)}},{key:"getBackgroundHex",value:function(e){var t=e.colors;return ue.a.rgbToHex([t[0],t[1],t[2]])}},{key:"getFormBackgroundHex",value:function(e){return this.form.get(e).value}},{key:"applyAll",value:function(){var e=this.form.value.type;if(this.presetTab.isActive)this.store.dispatch(new J.r(this.presetBackground));else if(this.customTab.isActive){var t=this.formToBackgroundColor(e);t&&this.store.dispatch(new J.r(t))}}},{key:"applyFromCustom",value:function(){var e=this.formToBackgroundColor(this.form.value.type);e&&this.store.dispatch(new J.I(e))}},{key:"setCustomColorForm",value:function(e){var t,n,i,o,a,r=e.colors,c=e.gradientType,s=e.colorStops,l=[r[0],r[1],r[2]],p=r.length<8?l:[r[4],r[5],r[6]];n=ue.a.rgbToHex(l,!1),i=ue.a.rgbToHex(p,!1),t=Oo.a.isTransparent(e)?"transparent":Object(ce.isEqual)(l,p)?"solid":c,o=s[0],a=s[1],this.form.patchValue({type:t,color1:n,stop1:o,color2:i,stop2:a})}},{key:"formToBackgroundColor",value:function(e){var t=this.form.value,n=t.color1,i=t.color2,o=t.stop1,r=t.stop2;if("transparent"===e)return So.d;if(!this.form.valid)return null;var c=[],s="radial"===e?"radial":"linear";return n&&c.push.apply(c,a(ue.a.hexToRgb(n,!1)).concat([1])),i&&"solid"!==e?c.push.apply(c,a(ue.a.hexToRgb(i,!1)).concat([1])):c.push.apply(c,c),new Oo.a(c,s,[o,r])}}]),e}()).\u0275fac=function(e){return new(e||Bo)(ve.Pb(y.h),ve.Pb(y.b),ve.Pb(ae.f),ve.Pb(ke.b))},Bo.\u0275cmp=ve.Jb({type:Bo,selectors:[["app-background-color-dialog"]],viewQuery:function(e,t){var n;1&e&&(ve.Jc(jo,!0),ve.Jc(No,!0)),2&e&&(ve.xc(n=ve.dc())&&(t.presetTab=n.first),ve.xc(n=ve.dc())&&(t.customTab=n.first))},decls:37,vars:9,consts:[["mat-dialog-title",""],[1,"background","theme-light"],["tabSize","medium","tabTheme","light",3,"activeTabChange"],["label","Presets"],["presetTab",""],[1,"background__section","mt-3"],[1,"background__swatches"],["class","m-1",3,"color","size","selected","click",4,"ngFor","ngForOf"],["app-button","","buttonType","outline","buttonTheme","light","buttonSize","small",1,"mb-4",3,"click"],["label","Currently Used"],["class","m-1",3,"color","size","click",4,"ngFor","ngForOf"],["label","Custom"],["customTab",""],[1,"background__section","mt-4",3,"formGroup","ngSwitch"],["label","Type"],["formControlName","type",1,"input"],["value","solid"],["value","radial"],["value","linear"],["value","transparent"],[4,"ngSwitchCase"],["mat-dialog-actions",""],["app-button","","buttonTheme","light",1,"mr-2",3,"click"],["app-button","","buttonType","flat","buttonTheme","light","cdkFocusInitial","",3,"mat-dialog-close"],[1,"m-1",3,"color","size","selected","click"],[1,"m-1",3,"color","size","click"],["label","Color"],["type","text","cpPosition","left",1,"input",3,"colorPicker","cpOutputFormat","cpAlphaChannel","colorPickerChange"],["label","Inner Color"],["label","Inner Radius"],["theme","light","formControlName","stop1",3,"min","max"],["label","Outer Color"],["label","Outer Radius"],["theme","light","formControlName","stop2",3,"min","max"],["label","Starting Color"],["label","Starting Color Stop"],["label","Ending Color"],["label","Ending Color Stop"],["type","info","theme","light"]],template:function(e,t){1&e&&(ve.Vb(0,"h1",0),ve.Pc(1,"Background Color"),ve.Ub(),ve.Vb(2,"div",1),ve.Vb(3,"app-tabs",2),ve.cc("activeTabChange",(function(e){return t.handleTabChange(e)})),ve.Vb(4,"app-tab",3,4),ve.Vb(6,"div",5),ve.Vb(7,"app-form-field"),ve.Vb(8,"div",6),ve.Nc(9,Ro,1,3,"app-swatch-item",7),ve.Ub(),ve.Ub(),ve.Vb(10,"button",8),ve.cc("click",(function(){return t.handleResetClick()})),ve.Pc(11," Revert to Original "),ve.Ub(),ve.Vb(12,"app-form-field",9),ve.Vb(13,"div",6),ve.Nc(14,Ao,1,2,"app-swatch-item",10),ve.Ub(),ve.Ub(),ve.Ub(),ve.Ub(),ve.Vb(15,"app-tab",11,12),ve.Vb(17,"form",13),ve.Vb(18,"app-form-field",14),ve.Vb(19,"select",15),ve.Vb(20,"option",16),ve.Pc(21,"Solid Color"),ve.Ub(),ve.Vb(22,"option",17),ve.Pc(23,"Radial Gradient"),ve.Ub(),ve.Vb(24,"option",18),ve.Pc(25,"Linear Gradient"),ve.Ub(),ve.Vb(26,"option",19),ve.Pc(27,"Transparent"),ve.Ub(),ve.Ub(),ve.Ub(),ve.Nc(28,Fo,3,5,"div",20),ve.Nc(29,Io,9,14,"div",20),ve.Nc(30,zo,9,14,"div",20),ve.Nc(31,Lo,3,0,"div",20),ve.Ub(),ve.Ub(),ve.Ub(),ve.Ub(),ve.Vb(32,"div",21),ve.Vb(33,"button",22),ve.cc("click",(function(){return t.applyAll()})),ve.Pc(34,"Apply to All"),ve.Ub(),ve.Vb(35,"button",23),ve.Pc(36," Done "),ve.Ub(),ve.Ub()),2&e&&(ve.Db(9),ve.mc("ngForOf",t.presetBackgrounds),ve.Db(5),ve.mc("ngForOf",t.distinctBackgrounds),ve.Db(3),ve.mc("formGroup",t.form)("ngSwitch",t.form.get("type").value),ve.Db(11),ve.mc("ngSwitchCase","solid"),ve.Db(1),ve.mc("ngSwitchCase","radial"),ve.Db(1),ve.mc("ngSwitchCase","linear"),ve.Db(1),ve.mc("ngSwitchCase","transparent"),ve.Db(4),ve.mc("mat-dialog-close",!0))},directives:[re.h,_o.a,Mo.a,Oe.a,f.o,Pe.a,ae.E,ae.s,ae.j,f.r,ae.B,ae.r,ae.i,ae.v,ae.D,f.s,re.c,re.d,Uo,Tt.a,To.a,Vo.a],styles:[".background[_ngcontent-%COMP%]{width:256px;min-height:280px}.background__section[_ngcontent-%COMP%]{display:flex;flex-direction:column}.background__swatches[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:wrap}"],changeDetection:0}),Do([Object(y.e)(X.a.getSelectedChapterBackground),Eo("design:type",_.a)],Bo.prototype,"background$",void 0),Do([Object(y.e)(X.a.getAllChaptersBackground),Eo("design:type",_.a)],Bo.prototype,"allChapterBackgrounds$",void 0),Do([Object(y.e)(X.a.getSelectedChapterIndex),Eo("design:type",_.a)],Bo.prototype,"selectedChapterIndex$",void 0),Bo),Ho=o("7b4e"),Wo=o("0E12"),Ko=o("rGz1"),Jo=((Qo=function(){function e(t){l(this,e),this.store=t}return u(e,[{key:"duplicateChapter",value:function(e){var t=Ho.a.idWithPrefix("chapter"),n=this.store.selectSnapshot(Ko.a.particleSystemsForChapter(e.id)).map((function(e){return new Wo.a.AssignParticle(e.id,t)}));this.store.dispatch(n);var i=this.store.selectSnapshot(Ko.a.getTweenParticleLookup)[e.id];void 0!==i&&this.store.dispatch(new Wo.a.SetLookupForChapter(t,i)),this.store.dispatch([new fn.a.UpdateNodesChecked(!1),new fn.a.DuplicateNodeState(e.id,t),new J.d(e,t)])}},{key:"removeChapter",value:function(e){void 0!==this.store.selectSnapshot(Ko.a.getTweenParticleLookup)[e.id]&&this.store.dispatch(new Wo.a.DeleteChapterLookup(e.id)),this.store.dispatch(new J.j(e))}}]),e}()).\u0275fac=function(e){return new(e||Qo)(ve.Zb(y.h))},Qo.\u0275prov=ve.Lb({token:Qo,factory:Qo.\u0275fac,providedIn:"root"}),Qo),Xo=function(e){return[e]},Zo=["*"],Yo=function(e){return e.Inline="inline",e.Block="block",e}({}),ea=(($o=function(){function e(){l(this,e),this.render=Yo.Inline}return u(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||$o)},$o.\u0275cmp=ve.Jb({type:$o,selectors:[["app-button-group"]],inputs:{render:"render"},ngContentSelectors:Zo,decls:2,vars:3,consts:[[1,"app-button-group",3,"ngClass"]],template:function(e,t){1&e&&(ve.lc(),ve.Vb(0,"div",0),ve.kc(1),ve.Ub()),2&e&&ve.mc("ngClass",ve.pc(1,Xo,"app-button-group--"+t.render))},directives:[f.m],styles:[".app-button-group{position:relative}.app-button-group,.app-button-group--inline{display:inline-flex}.app-button-group--block{display:flex}.app-button-group--expanded{display:flex;flex:1 1 auto;justify-content:center}.app-button-group button[app-button]{position:relative;z-index:1;display:flex;flex:1}.app-button-group button[app-button]:hover{z-index:2}.app-button-group button[app-button]:first-child .app-button,.app-button-group button[app-button]:first-child .app-button:after{border-top-right-radius:0;border-bottom-right-radius:0}.app-button-group button[app-button]:last-child .app-button,.app-button-group button[app-button]:last-child .app-button:after{border-top-left-radius:0;border-bottom-left-radius:0}.app-button-group button[app-button]:last-child .app-button{margin-left:1px}.app-button-group button[app-button]:last-child .app-button--outline{margin-left:-1px}.app-button-group button[app-button]:not(:first-child):not(:last-child) .app-button,.app-button-group button[app-button]:not(:first-child):not(:last-child) .app-button:after{border-radius:0}.app-button-group button[app-button]:not(:first-child):not(:last-child) .app-button{margin-left:1px}.app-button-group button[app-button]:not(:first-child):not(:last-child) .app-button--outline{margin-left:-1px}"],encapsulation:2,changeDetection:0}),$o),ta=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},na=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},ia=function(e){return{hidden:e}},oa=((qo=function(){function e(t,n,i,o,a,r){l(this,e),this.store=t,this.snackbar=n,this.dialog=i,this.cameraService=o,this.dialogService=a,this.editService=r,this.selected=!1}return u(e,[{key:"ngOnInit",value:function(){}},{key:"handleCaptureClick",value:function(){this.capturePosition(),this.captureThumbnail(),this.snackbar.open("Successfully captured chapter starting position and thumbnail.")}},{key:"handleCapturePositionClick",value:function(){this.capturePosition(),this.snackbar.open("Successfully captured chapter starting position.")}},{key:"handleCaptureThumbnailClick",value:function(){this.captureThumbnail(),this.snackbar.open("Successfully captured chapter thumbnail.")}},{key:"handleDuplicateClick",value:function(){this.duplicateChapter()}},{key:"handleRemoveClick",value:function(){this.removeChapter()}},{key:"handleContentClick",value:function(){this.openChapterContentDialog(this.chapter.id)}},{key:"handleBackgroundColorClick",value:function(){this.dialog.open(Go,{backdropClass:"backdropClass"})}},{key:"duplicateChapter",value:function(){this.editService.duplicateChapter(this.chapter)}},{key:"removeChapter",value:function(){var e=this;this.dialogService.openConfirmDialog({data:{titleText:"Remove chapter",bodyText:"This cannot be undone.",confirmText:"Remove",confirmColor:"warn"}}).afterClosed().subscribe((function(t){t&&e.editService.removeChapter(e.chapter)}))}},{key:"captureThumbnail",value:function(){var e=this.store.selectSnapshot(X.a.getSelectedChapterBackground);this.store.dispatch(new ii.b(this.chapter.id,e,Cn.a.JPEG,92,kn.a.medium,"square",!1,!1))}},{key:"capturePosition",value:function(){var e,t=this.cameraService.getCamera(),n=t.look,i=this.cameraService.getCameraRotationCenter();this.cameraService.compareXYZ(n,i)||(e=i),this.store.dispatch(new J.i(this.chapter.id,t,e))}},{key:"openChapterContentDialog",value:function(e){this.dialog.open(cn,{width:"60vw",height:"auto",data:{chapterId:e}})}}]),e}()).\u0275fac=function(e){return new(e||qo)(ve.Pb(y.h),ve.Pb(ke.b),ve.Pb(re.b),ve.Pb(zi.a),ve.Pb(Bi.a),ve.Pb(Jo))},qo.\u0275cmp=ve.Jb({type:qo,selectors:[["app-chapter-actions"]],inputs:{chapter:"chapter",selected:"selected"},decls:24,vars:22,consts:[[1,"flex"],[1,"mr-2",3,"ngClass"],["app-button","","buttonTheme","dark","buttonType","flat","buttonSize","xsmall","matTooltip","Click to capture your starting position. When viewers enter the chapter, this is what they'll see.","matTooltipPosition","below","data-test","captureThumbnail",3,"click"],["app-button","","buttonTheme","dark","buttonType","flat","buttonSize","xsmall",3,"matMenuTriggerFor"],["icon","caret-down"],["captureMenu","matMenu"],["mat-menu-item","",3,"click"],["app-button","","buttonTheme","dark","buttonType","outline","buttonSize","xsmall","matTooltipPosition","below",1,"mr-1",3,"ngClass","click"],["app-button","","buttonTheme","dark","buttonType","outline","buttonSize","xsmall","matTooltip","Background Color","matTooltipPosition","below",1,"mr-1",3,"ngClass","click"],[3,"color","size"],[3,"ngClass"],["app-button","","buttonTheme","dark","buttonType","outline","buttonSize","xsmall","matTooltipPosition","below","matTooltip","Duplicate This Chapter","data-test","duplicateChapter",3,"click"],["size","sm","icon","clone"],["app-button","","buttonTheme","dark","buttonType","outline","buttonSize","xsmall","matTooltipPosition","below","matTooltip","Remove Chapter",3,"disabled","click"],["size","sm","icon","trash-alt"]],template:function(e,t){if(1&e&&(ve.Vb(0,"div",0),ve.Vb(1,"app-button-group",1),ve.hc(2,"async"),ve.Vb(3,"button",2),ve.cc("click",(function(){return t.handleCaptureClick()})),ve.Pc(4," Capture "),ve.Ub(),ve.Vb(5,"button",3),ve.Qb(6,"app-icon",4),ve.Ub(),ve.Ub(),ve.Vb(7,"mat-menu",null,5),ve.Vb(9,"button",6),ve.cc("click",(function(){return t.handleCapturePositionClick()})),ve.Pc(10,"Capture Position Only"),ve.Ub(),ve.Vb(11,"button",6),ve.cc("click",(function(){return t.handleCaptureThumbnailClick()})),ve.Pc(12,"Capture Thumbnail Only"),ve.Ub(),ve.Ub(),ve.Vb(13,"button",7),ve.cc("click",(function(){return t.handleContentClick()})),ve.Pc(14," Edit Text "),ve.Ub(),ve.Vb(15,"button",8),ve.cc("click",(function(){return t.handleBackgroundColorClick()})),ve.Qb(16,"app-swatch-item",9),ve.hc(17,"async"),ve.Ub(),ve.Vb(18,"app-button-group",10),ve.Vb(19,"button",11),ve.cc("click",(function(){return t.handleDuplicateClick()})),ve.Qb(20,"app-icon",12),ve.Ub(),ve.Vb(21,"button",13),ve.cc("click",(function(){return t.handleRemoveClick()})),ve.hc(22,"async"),ve.Qb(23,"app-icon",14),ve.Ub(),ve.Ub(),ve.Ub()),2&e){var n,i=ve.yc(8);ve.Db(1),ve.mc("ngClass",ve.pc(14,ia,!t.selected||ve.ic(2,8,t.autoCapture$))),ve.Db(4),ve.mc("matMenuTriggerFor",i),ve.Db(8),ve.mc("ngClass",ve.pc(16,ia,!t.selected)),ve.Db(2),ve.mc("ngClass",ve.pc(18,ia,!t.selected)),ve.Db(1),ve.mc("color",ve.ic(17,10,t.background$))("size","small"),ve.Db(2),ve.mc("ngClass",ve.pc(20,ia,!t.selected)),ve.Db(3),ve.mc("disabled",1===(null==(n=ve.ic(22,12,t.chapters$))?null:n.length))}},directives:[ea,f.m,Pe.a,Ct.c,Ki.d,yt.a,Ki.a,Ki.b,Uo],pipes:[f.b],styles:[""],changeDetection:0}),ta([Object(y.e)(X.a.getStoryChapters),na("design:type",_.a)],qo.prototype,"chapters$",void 0),ta([Object(y.e)(oi.a.getRegisteredThumbnails),na("design:type",_.a)],qo.prototype,"thumbnails$",void 0),ta([Object(y.e)(X.a.getSelectedChapterBackground),na("design:type",_.a)],qo.prototype,"background$",void 0),ta([Object(y.e)(T.a.getAutoCapture),na("design:type",_.a)],qo.prototype,"autoCapture$",void 0),qo),aa=["cardThumbnail"];function ra(e,t){1&e&&(ve.Vb(0,"span",11),ve.Pc(1,"No title"),ve.Ub())}function ca(e,t){if(1&e&&(ve.Qb(0,"div",12),ve.hc(1,"markdown")),2&e){var n=ve.gc();ve.mc("innerHTML",ve.ic(1,1,n.shortDescription),ve.Dc)}}function sa(e,t){1&e&&(ve.Vb(0,"div",13),ve.Vb(1,"span",11),ve.Pc(2,"No description"),ve.Ub(),ve.Ub())}var la,pa,ua=((la=function(){function e(t){l(this,e),this.renderer=t,this.canRemove=!0,this._snapshot="",this.duplicate=new ve.p,this.remove=new ve.p}return u(e,[{key:"chapter",get:function(){return this._chapter},set:function(e){this._chapter=e}},{key:"thumbnail",get:function(){return this._thumbnail},set:function(e){e&&e.snapshot!==this._snapshot&&(this._snapshot=e.snapshot,this._thumbnail=e,null!=e?this.setImageStyle(this.thumbnail):this.clearImageStyle())}},{key:"shortDescription",get:function(){var e=Object(ce.get)(this.chapter,"info.description")||"";return e.length<=48?e:e.replace("<br>","").substr(0,45)+"..."}},{key:"ngOnInit",value:function(){}},{key:"setImageStyle",value:function(e){var t=this.thumbnail.snapshot?this.thumbnail.snapshot:this.thumbnail.urls.small,n=(new Date).valueOf();t.startsWith("blob:")||(t="".concat(t,"?cb=").concat(n,"&uncached=true")),this.renderer.setStyle(this.cardThumbnail.nativeElement,"background-size","cover"),this.renderer.setStyle(this.cardThumbnail.nativeElement,"background-image","url(".concat(t,")"))}},{key:"clearImageStyle",value:function(){this.renderer.removeStyle(this.cardThumbnail.nativeElement,"background-size"),this.renderer.removeStyle(this.cardThumbnail.nativeElement,"background-image")}},{key:"handleDuplicateClick",value:function(){this.duplicate.emit(this.chapter)}},{key:"handleRemoveClick",value:function(){this.remove.emit(this.chapter)}}]),e}()).\u0275fac=function(e){return new(e||la)(ve.Pb(ve.H))},la.\u0275cmp=ve.Jb({type:la,selectors:[["app-chapter-card"]],viewQuery:function(e,t){var n;1&e&&ve.Jc(aa,!0,ve.m),2&e&&ve.xc(n=ve.dc())&&(t.cardThumbnail=n.first)},inputs:{chapter:"chapter",selected:"selected",canRemove:"canRemove",thumbnail:"thumbnail"},outputs:{duplicate:"duplicate",remove:"remove"},decls:12,vars:8,consts:[["data-test","chapterCard",1,"chapter-card"],[1,"chapter-card__content"],[1,"chapter-card__image"],["cardThumbnail",""],[1,"chapter-card__body"],[1,"chapter-card__title"],["class","text-italic text-dim",4,"ngIf"],["class","chapter-card__description html",3,"innerHTML",4,"ngIf"],["class","chapter-card__description",4,"ngIf"],[1,"chapter-card__actions"],[3,"selected","chapter"],[1,"text-italic","text-dim"],[1,"chapter-card__description","html",3,"innerHTML"],[1,"chapter-card__description"]],template:function(e,t){1&e&&(ve.Vb(0,"div",0),ve.Vb(1,"div",1),ve.Qb(2,"div",2,3),ve.Vb(4,"div",4),ve.Vb(5,"div",5),ve.Pc(6),ve.Nc(7,ra,2,0,"span",6),ve.Ub(),ve.Nc(8,ca,2,3,"div",7),ve.Nc(9,sa,3,0,"div",8),ve.Ub(),ve.Ub(),ve.Vb(10,"div",9),ve.Qb(11,"app-chapter-actions",10),ve.Ub(),ve.Ub()),2&e&&(ve.Hb("chapter-card--selected",t.selected),ve.Db(6),ve.Rc(" ",t.chapter.info.displayName," "),ve.Db(1),ve.mc("ngIf",!t.chapter.info.displayName),ve.Db(1),ve.mc("ngIf",t.shortDescription),ve.Db(1),ve.mc("ngIf",!t.shortDescription),ve.Db(2),ve.mc("selected",t.selected)("chapter",t.chapter))},directives:[f.p,oa],pipes:[dt.b],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.chapter-card[_ngcontent-%COMP%]{position:relative;border-radius:4px;padding:8px;transition:background-color .12s}.chapter-card[_ngcontent-%COMP%]:active{cursor:-webkit-grabbing;cursor:grabbing}.chapter-card--selected[_ngcontent-%COMP%]:hover, .chapter-card[_ngcontent-%COMP%]:hover{background-color:rgba(40,56,83,.7);cursor:pointer}.chapter-card--selected[_ngcontent-%COMP%]:hover   .chapter-card__title[_ngcontent-%COMP%], .chapter-card[_ngcontent-%COMP%]:hover   .chapter-card__title[_ngcontent-%COMP%]{color:#fff}.chapter-card--loading[_ngcontent-%COMP%]{background:rgba(28,42,63,.8);display:flex;margin:-4px;position:absolute;top:0;left:0;right:0;bottom:0;justify-content:center;align-items:center}.chapter-card--selected[_ngcontent-%COMP%]{background:#1c2a3f}.chapter-card--selected[_ngcontent-%COMP%]   .chapter-card__image[_ngcontent-%COMP%]{border-color:#2d72dc}.chapter-card--selected[_ngcontent-%COMP%]   .chapter-card__description[_ngcontent-%COMP%], .chapter-card--selected[_ngcontent-%COMP%]   .chapter-card__title[_ngcontent-%COMP%]{color:#fff}.chapter-card__content[_ngcontent-%COMP%]{display:flex}.chapter-card__image[_ngcontent-%COMP%]{background:#283853 url(/assets/images/logo-dark-transparent.svg) 50% no-repeat;background-size:25% 25%;border-radius:4px;border:2px solid transparent;flex:0 0 90px;height:90px;position:relative}.chapter-card__body[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex-grow:1;padding:0 0 0 12px;overflow:hidden}.chapter-card__title[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em;font-weight:700;word-break:break-word;color:#d7e0ea;white-space:normal}.chapter-card__description[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em;color:#d7e0ea}.chapter-card__actions[_ngcontent-%COMP%]{margin-top:8px;text-align:right}"],changeDetection:0}),la),da=o("EETq"),ma=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},ha=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},ba=((pa=function(){function e(t,n,i,o){l(this,e),this.store=t,this.storageService=n,this.dialogRef=i,this.changeDetectorRef=o,this.application=dn.a.application,this.actionMode=xi.a.Import,this.contentType=sn.a.Module,this.ngUnsubscribe=new C.a}return u(e,[{key:"ngOnInit",value:function(){this.initGallery(),this.observeSearchConfig()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initGallery",value:function(){var e=this.getDefaultSearchConfig(),t=this.store.selectSnapshot(Oi.a.getSearchOptions)||new ki.a("",yi.f);this.store.dispatch(new Pi.a.SetCardActions({enabled:!1})),this.store.dispatch(new Pi.a.SetBulkActions({enabled:!1,items:[]})),this.store.dispatch(new Pi.a.SetSearchConfig(e)),this.store.dispatch(new Pi.a.SetSearchOptions(t))}},{key:"observeSearchConfig",value:function(){var e=this;this.searchConfig$.pipe(Object(io.a)((function(e,t){return Object(ce.isEqual)(e,t)})),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.contentType=t.type===da.a.Category?sn.a.Module:sn.a.Bookmark,t.type===da.a.Loft&&e.saveSearchConfig(t),e.changeDetectorRef.markForCheck()}))}},{key:"handleSelect",value:function(e){this.store.dispatch(new Pi.a.SelectBookmark(e)),this.dialogRef.close(e)}},{key:"getDefaultSearchConfig",value:function(){if(dn.a.application===fe.a.Studio)return new Ci.a("all");var e=this.storageService.getLocalJSON(On.b.RecentSearchConfig);if((null==e?void 0:e.type)===da.a.Loft){var t=e.primary,n=e.secondary;return new Ci.e(t,n)}return new Ci.e("production","maleAdult")}},{key:"saveSearchConfig",value:function(e){var t=e.type,n=e.primary,i=e.secondary;this.storageService.setLocalItem(On.b.RecentSearchConfig,{type:t,primary:n,secondary:i})}}]),e}()).\u0275fac=function(e){return new(e||pa)(ve.Pb(y.h),ve.Pb(On.d),ve.Pb(re.g),ve.Pb(ve.i))},pa.\u0275cmp=ve.Jb({type:pa,selectors:[["app-import-model-dialog"]],decls:5,vars:5,consts:[[1,"import"],[1,"text-20","import__header"],[1,"import__body"],["selectLabel","Import",3,"actionMode","actionsEnabled","application","contentType","showSourcePicker","selectBookmark"]],template:function(e,t){1&e&&(ve.Vb(0,"div",0),ve.Vb(1,"div",1),ve.Pc(2,"Import Chapters"),ve.Ub(),ve.Vb(3,"div",2),ve.Vb(4,"app-gallery-container",3),ve.cc("selectBookmark",(function(e){return t.handleSelect(e)})),ve.Ub(),ve.Ub(),ve.Ub()),2&e&&(ve.Db(4),ve.mc("actionMode",t.actionMode)("actionsEnabled",!1)("application",t.application)("contentType",t.contentType)("showSourcePicker",!0))},directives:[wi.a],styles:["[_nghost-%COMP%]{display:block;height:calc(90vh - 48px);width:calc(90vw - 48px);position:relative;padding:0 0 12px}.import[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}.import__header[_ngcontent-%COMP%]{border-bottom:1px solid rgba(0,0,0,.12);padding:8px 20px;display:flex;align-items:center}.import__body[_ngcontent-%COMP%]{flex:1 0 auto;position:relative}"],changeDetection:0}),ma([Object(y.e)(Oi.a.getViewMode),ha("design:type",_.a)],pa.prototype,"viewMode$",void 0),ma([Object(y.e)(Oi.a.getLoading),ha("design:type",_.a)],pa.prototype,"loading$",void 0),ma([Object(y.e)(Oi.a.getFilteredResults),ha("design:type",_.a)],pa.prototype,"results$",void 0),ma([Object(y.e)(Oi.a.getSearchConfig),ha("design:type",_.a)],pa.prototype,"searchConfig$",void 0),ma([Object(y.e)(oe.a.isPremiumUser),ha("design:type",_.a)],pa.prototype,"isPremiumUser$",void 0),pa),fa=o("hQeY"),ga=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},va=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},ya=["chapterBrowser"];function xa(e,t){1&e&&(ve.Vb(0,"div",9),ve.Qb(1,"app-spinner",10),ve.Ub())}function Ca(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"div",11),ve.Vb(1,"app-chapter-card",12),ve.cc("click",(function(){ve.Cc(n);var e=t.$implicit;return ve.gc().handleClickChapter(e)}))("remove",(function(e){return ve.Cc(n),ve.gc().handleRemove(e)}))("duplicate",(function(e){return ve.Cc(n),ve.gc().handleDuplicate(e)})),ve.hc(2,"async"),ve.hc(3,"async"),ve.hc(4,"async"),ve.Ub(),ve.Ub()}if(2&e){var i,o=t.$implicit,a=ve.gc(),r=null;ve.Db(1),ve.mc("id","chapter-card__"+o.id)("chapter",o)("thumbnail",null==(r=ve.ic(2,5,a.thumbnails$))?null:r.get(o.id))("selected",(null==(i=ve.ic(3,7,a.selectedChapter$))?null:i.id)===o.id)("canRemove",ve.ic(4,9,a.chapters$).length>1)}}var ka,Pa=((ka=function(){function e(t,n,i){l(this,e),this.store=t,this.editService=n,this.dialog=i,this.ngUnsubscribe=new C.a,this.currentChapterId=""}return u(e,[{key:"ngOnInit",value:function(){}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"ngAfterViewInit",value:function(){var e=this;this.selectedChapter$.pipe(Object(R.a)((function(e){return null!=e})),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.currentChapterId=t.id,setTimeout((function(){e.scrollChapterIntoView(t)}))}))}},{key:"handleDrop",value:function(e){this.store.dispatch(new J.m(e.previousIndex,e.currentIndex))}},{key:"handleClickChapter",value:function(e){e.id!==this.currentChapterId&&this.store.dispatch(new J.p(e))}},{key:"handleImportChapters",value:function(){var e=this;this.dialog.open(ba,{id:Zn.a.ImportDialog,maxWidth:"90vw",width:"90vw",height:"90vh"}).afterClosed().pipe(Object(R.a)((function(e){return null!=e}))).subscribe((function(t){var n=e.store.selectSnapshot(oe.a.getUserLanguage);e.store.dispatch(new $.c(t.id,t.type,n))}))}},{key:"handleNextClick",value:function(){this.store.dispatch(new J.g)}},{key:"handlePreviousClick",value:function(){this.store.dispatch(new J.h)}},{key:"handleDuplicate",value:function(e){this.duplicateChapter(e)}},{key:"handleDuplicateSelected",value:function(){var e=this.store.selectSnapshot(X.a.getSelectedChapter);this.duplicateChapter(e)}},{key:"handleRemove",value:function(e){this.removeChapter(e)}},{key:"duplicateChapter",value:function(e){this.editService.duplicateChapter(e)}},{key:"removeChapter",value:function(e){var t=this;this.dialog.open(fa.a,{data:{titleText:"Remove chapter",bodyText:"This cannot be undone.",confirmText:"Remove",confirmColor:"warn"}}).afterClosed().subscribe((function(n){n&&t.editService.removeChapter(e)}))}},{key:"trackChapter",value:function(e,t){return t.id}},{key:"scrollChapterIntoView",value:function(e){var t=document.getElementById("chapter-card__"+e.id);"scrollBehavior"in document.documentElement.style&&t&&t.scrollIntoView({behavior:"smooth",block:"nearest"})}}]),e}()).\u0275fac=function(e){return new(e||ka)(ve.Pb(y.h),ve.Pb(Jo),ve.Pb(re.b))},ka.\u0275cmp=ve.Jb({type:ka,selectors:[["app-chapter-browser"]],viewQuery:function(e,t){var n;1&e&&(ve.Jc(ya,!0),ve.Vc(ua,!0)),2&e&&(ve.xc(n=ve.dc())&&(t.chapterBrowserElement=n.first),ve.xc(n=ve.dc())&&(t.chapterCards=n))},decls:16,vars:11,consts:[["data-test","chapterBrowser","cdkDropList","","cdkDropListOrientation","vertical",1,"chapter-browser",3,"cdkDropListDropped"],["chapterBrowser",""],["data-test","chapterSpinner","class","chapter-browser__scrim",4,"ngIf"],["class","chapter-browser__item","cdkDrag","",4,"ngFor","ngForOf","ngForTrackBy"],["app-button","","buttonType","outline","data-test","addChapter",1,"chapter-browser__add",3,"matMenuTriggerFor"],["icon","angle-down"],["importMenu","matMenu"],["mat-menu-item","",2,"min-width","240px",3,"click"],["mat-menu-item","","data-test","importChapter",3,"click"],["data-test","chapterSpinner",1,"chapter-browser__scrim"],["size","huge"],["cdkDrag","",1,"chapter-browser__item"],[3,"id","chapter","thumbnail","selected","canRemove","click","remove","duplicate"]],template:function(e,t){if(1&e&&(ve.Vb(0,"div",0,1),ve.cc("cdkDropListDropped",(function(e){return t.handleDrop(e)})),ve.Nc(2,xa,2,0,"div",2),ve.hc(3,"async"),ve.Nc(4,Ca,5,11,"div",3),ve.hc(5,"async"),ve.Vb(6,"button",4),ve.Pc(7," Add Chapter "),ve.Qb(8,"app-icon",5),ve.Ub(),ve.Ub(),ve.Vb(9,"mat-menu",null,6),ve.Vb(11,"button",7),ve.cc("click",(function(){return t.handleDuplicateSelected()})),ve.Pc(12),ve.hc(13,"async"),ve.Ub(),ve.Vb(14,"button",8),ve.cc("click",(function(){return t.handleImportChapters()})),ve.Pc(15," Import Chapters... "),ve.Ub(),ve.Ub()),2&e){var n,i=ve.yc(10);ve.Db(2),ve.mc("ngIf",!ve.ic(3,5,t.allChaptersLoaded$)),ve.Db(2),ve.mc("ngForOf",ve.ic(5,7,t.chapters$))("ngForTrackBy",t.trackChapter),ve.Db(2),ve.mc("matMenuTriggerFor",i),ve.Db(6),ve.Rc(' Duplicate "',(null==(n=ve.ic(13,9,t.selectedChapter$))?null:n.info.displayName)||"Chapter",'" ')}},directives:[vt.c,f.p,f.o,Pe.a,Ki.d,yt.a,Ki.a,Ki.b,Vn.a,vt.a,ua],pipes:[f.b],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.chapter-browser[_ngcontent-%COMP%]{display:flex;flex-direction:column;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:relative}.chapter-browser__scrim[_ngcontent-%COMP%]{background:rgba(16,24,35,.5);display:flex;justify-content:center;align-items:center;position:absolute;z-index:9;left:0;right:0;top:0;bottom:0}.chapter-browser__item[_ngcontent-%COMP%]{flex:0 0 100%;display:block;padding:8px 0}.chapter-browser__item[_ngcontent-%COMP%]:last-child{border-bottom:0}.chapter-browser__item.cdk-drag-preview[_ngcontent-%COMP%]{box-sizing:border-box;border-radius:4px 4px 0 0;box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12)}.chapter-browser__item.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.chapter-browser__add[_ngcontent-%COMP%]{margin:8px 0 0}.chapter-browser__new[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em;border-radius:4px;color:#374a68;min-height:60px;width:100%;border:1px dashed #374a68;display:flex;justify-content:center;align-items:center;text-align:center;margin:8px 0;padding:12px;transition:border-color .06s,color}.chapter-browser__new[_ngcontent-%COMP%]:hover{border-color:#fff;color:#fff;cursor:pointer}.chapter-browser[_ngcontent-%COMP%]   .cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:.2}.chapter-browser[_ngcontent-%COMP%]   .cdk-drop-list-dragging[_ngcontent-%COMP%]   .chapter-browser__item[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}"],changeDetection:0}),ga([Object(y.e)(X.a.getStoryChapters),va("design:type",_.a)],ka.prototype,"chapters$",void 0),ga([Object(y.e)(X.a.getSelectedChapter),va("design:type",_.a)],ka.prototype,"selectedChapter$",void 0),ga([Object(y.e)(oi.a.getRegisteredThumbnails),va("design:type",_.a)],ka.prototype,"thumbnails$",void 0),ga([Object(y.e)(X.a.getAllChaptersModelsReady),va("design:type",_.a)],ka.prototype,"allChaptersLoaded$",void 0),ka),Oa=o("EF3F"),wa=o("7u76"),Sa=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function _a(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"button",21),ve.cc("click",(function(){return ve.Cc(n),ve.gc().handleSelectAll()})),ve.Pc(1," Select All Structures\n"),ve.Ub()}}function Ma(e,t){1&e&&(ve.Vb(0,"span"),ve.Pc(1,"structure"),ve.Ub())}function Ua(e,t){1&e&&(ve.Vb(0,"span"),ve.Pc(1,"structures"),ve.Ub())}function Ta(e,t){if(1&e&&(ve.Vb(0,"button",22),ve.Pc(1),ve.hc(2,"number"),ve.Nc(3,Ma,2,0,"span",23),ve.Nc(4,Ua,2,0,"span",23),ve.Pc(5," selected "),ve.Qb(6,"app-icon",24),ve.Ub()),2&e){var n=ve.gc(),i=ve.yc(3);ve.mc("matMenuTriggerFor",i),ve.Db(1),ve.Rc(" ",ve.ic(2,4,n.count)," "),ve.Db(2),ve.mc("ngIf",1===n.count),ve.Db(1),ve.mc("ngIf",n.count>1)}}var Va,Da=((Va=function(){function e(t,n,i){l(this,e),this.store=t,this.changeDetector=n,this.graphService=i,this.leaves=[],this.count=0,this.ngUnsubscribe=new C.a}return u(e,[{key:"ngOnInit",value:function(){var e=this;this.checkedNodes$.pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){var n=e.store.selectSnapshot(ln.a.getCheckedNodeIds);e.count=n.length,e.changeDetector.markForCheck()}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"handleClearSelection",value:function(){this.store.dispatch(new fn.a.UpdateNodesChecked(!1))}},{key:"handleBulkShow",value:function(){this.store.dispatch(new fn.a.UpdateNodesShown(!0,this.store.selectSnapshot(ln.a.getCheckedNodeIds)))}},{key:"handleBulkHide",value:function(){var e=this.store.selectSnapshot(ln.a.getNodes),t=Object.values(e).reduce((function(e,t){return e[t.objectId]=!t.checked&&t.shown,e}),{});this.store.dispatch(new fn.a.UpdateNodesShown(!1,[],t))}},{key:"handleHideInverse",value:function(){var e=this.store.selectSnapshot(ln.a.getNodes),t=Object.values(e).reduce((function(e,t){return e[t.objectId]=!!t.checked&&t.shown,e}),{});this.store.dispatch(new fn.a.UpdateNodesShown(!1,[],t))}},{key:"handleSelectInverse",value:function(){var e=this.store.selectSnapshot(ln.a.getNodes),t=Object.values(e).reduce((function(e,t){return e[t.objectId]=!t.checked,e}),{});this.store.dispatch(new fn.a.UpdateNodesChecked(!1,[],t))}},{key:"handleSelectAll",value:function(){this.store.dispatch(new fn.a.UpdateNodesChecked(!0))}},{key:"handleBulkPickable",value:function(e){var t=this.store.selectSnapshot(ln.a.getNodes),n=Object.values(t).reduce((function(t,n){return t[n.objectId]=n.checked?e:n.pickable,t}),{});this.store.dispatch(new fn.a.UpdateNodesPickable(!1,[],n))}},{key:"handleInverseUnpickable",value:function(){var e=this.store.selectSnapshot(ln.a.getNodes),t=Object.values(e).reduce((function(e,t){return e[t.objectId]=!!t.checked&&t.pickable,e}),{});this.store.dispatch(new fn.a.UpdateNodesPickable(!1,[],t))}},{key:"handleFadeSelected",value:function(){var e=this.store.selectSnapshot(ln.a.getCheckedNodeIds);this.store.dispatch(new fn.a.UpdateNodesPaint(Oa.b,e))}},{key:"handleFadeInverse",value:function(){var e=this.store.selectSnapshot(ln.a.getCheckedNodeIds),t=this.store.selectSnapshot(V.a.getViewGraph),n=this.graphService.getInverseSelection(t,e);this.store.dispatch(new fn.a.UpdateNodesPaint(Oa.b,n))}}]),e}()).\u0275fac=function(e){return new(e||Va)(ve.Pb(y.h),ve.Pb(ve.i),ve.Pb(wa.a))},Va.\u0275cmp=ve.Jb({type:Va,selectors:[["app-checked-nodes"]],decls:43,vars:6,consts:[["app-button","","buttonSize","xsmall","data-test","selectAllStructures",3,"click",4,"ngIf"],["app-button","","buttonSize","xsmall","data-test","selectedNodesMenu",3,"matMenuTriggerFor",4,"ngIf"],["checkAllMenu","matMenu"],["mat-menu-item","","data-test","selectActionsMenu",3,"matMenuTriggerFor"],["mat-menu-item","","data-test","showHideMenu",3,"matMenuTriggerFor"],["data-test","nodeActionsFadeTrigger","mat-menu-item","",3,"matMenuTriggerFor"],["mat-menu-item","","data-test","pickableMenu",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],["selectActions","matMenu"],["mat-menu-item","","data-test","selectEverythingElse",3,"click"],["showHideActions","matMenu"],["mat-menu-item","","data-test","showSelected",3,"click"],["mat-menu-item","","data-test","hideSelected",3,"click"],["mat-menu-item","","data-test","hideEverythingElse",3,"click"],["fadeActions","matMenu"],["mat-menu-item","","data-test","fadeThis",3,"click"],["mat-menu-item","","data-test","fadeEverythingElse",3,"click"],["pickableActions","matMenu"],["mat-menu-item","","data-test","makePickable",3,"click"],["mat-menu-item","","data-test","makeUnpickable",3,"click"],["mat-menu-item","","data-test","makeEverythingElseUnpickable",3,"click"],["app-button","","buttonSize","xsmall","data-test","selectAllStructures",3,"click"],["app-button","","buttonSize","xsmall","data-test","selectedNodesMenu",3,"matMenuTriggerFor"],[4,"ngIf"],["icon","caret-down"]],template:function(e,t){if(1&e&&(ve.Nc(0,_a,2,0,"button",0),ve.Nc(1,Ta,7,6,"button",1),ve.Vb(2,"mat-menu",null,2),ve.Vb(4,"button",3),ve.Pc(5," Select "),ve.Ub(),ve.Vb(6,"button",4),ve.Pc(7," Show / Hide "),ve.Ub(),ve.Vb(8,"button",5),ve.Pc(9," Fade "),ve.Ub(),ve.Vb(10,"button",6),ve.Pc(11," Selectable / Unselectable "),ve.Ub(),ve.Qb(12,"mat-divider"),ve.Vb(13,"button",7),ve.cc("click",(function(){return t.handleClearSelection()})),ve.Pc(14,"Clear Selection"),ve.Ub(),ve.Ub(),ve.Vb(15,"mat-menu",null,8),ve.Vb(17,"button",9),ve.cc("click",(function(){return t.handleSelectInverse()})),ve.Pc(18," Select Everything Else "),ve.Ub(),ve.Ub(),ve.Vb(19,"mat-menu",null,10),ve.Vb(21,"button",11),ve.cc("click",(function(){return t.handleBulkShow()})),ve.Pc(22,"Show Selected"),ve.Ub(),ve.Vb(23,"button",12),ve.cc("click",(function(){return t.handleBulkHide()})),ve.Pc(24,"Hide Selected"),ve.Ub(),ve.Qb(25,"mat-divider"),ve.Vb(26,"button",13),ve.cc("click",(function(){return t.handleHideInverse()})),ve.Pc(27," Hide Everything Else "),ve.Ub(),ve.Ub(),ve.Vb(28,"mat-menu",null,14),ve.Vb(30,"button",15),ve.cc("click",(function(){return t.handleFadeSelected()})),ve.Pc(31,"Fade Selected"),ve.Ub(),ve.Vb(32,"button",16),ve.cc("click",(function(){return t.handleFadeInverse()})),ve.Pc(33," Fade Everything Else "),ve.Ub(),ve.Ub(),ve.Vb(34,"mat-menu",null,17),ve.Vb(36,"button",18),ve.cc("click",(function(){return t.handleBulkPickable(!0)})),ve.Pc(37," Make Selectable "),ve.Ub(),ve.Vb(38,"button",19),ve.cc("click",(function(){return t.handleBulkPickable(!1)})),ve.Pc(39," Make Unselectable "),ve.Ub(),ve.Qb(40,"mat-divider"),ve.Vb(41,"button",20),ve.cc("click",(function(){return t.handleInverseUnpickable()})),ve.Pc(42," Make Everything Else Unselectable "),ve.Ub(),ve.Ub()),2&e){var n=ve.yc(16),i=ve.yc(20),o=ve.yc(29),a=ve.yc(35);ve.mc("ngIf",0===t.count),ve.Db(1),ve.mc("ngIf",t.count>0),ve.Db(3),ve.mc("matMenuTriggerFor",n),ve.Db(2),ve.mc("matMenuTriggerFor",i),ve.Db(2),ve.mc("matMenuTriggerFor",o),ve.Db(2),ve.mc("matMenuTriggerFor",a)}},directives:[f.p,Ki.a,Ki.b,Ki.d,_e.a,Pe.a,yt.a],pipes:[f.f],styles:[""],changeDetection:0}),function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);a>3&&r&&Object.defineProperty(t,n,r)}([Object(y.e)(ln.a.getCheckedNodes),Sa("design:type",_.a)],Va.prototype,"checkedNodes$",void 0),Va),Ea=o("NEgD"),ja=o("vxfF"),Na=o("rY+M"),Ra=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},Aa=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Fa=["columnBody"],Ia=["columnGroupBody"],za=["searchInput"];function La(e,t){if(1&e&&(ve.Vb(0,"button",31),ve.Qb(1,"app-icon",32),ve.Ub()),2&e){ve.gc();var n=ve.yc(11);ve.mc("matMenuTriggerFor",n)}}function Ba(e,t){if(1&e){var n=ve.Wb();ve.Tb(0),ve.Qb(1,"mat-divider"),ve.Vb(2,"button",9),ve.cc("click",(function(){return ve.Cc(n),ve.gc().applyCameraClick("single")})),ve.Pc(3," Apply Camera Position to This Chapter "),ve.Ub(),ve.Vb(4,"button",9),ve.cc("click",(function(){return ve.Cc(n),ve.gc().applyCameraClick("all")})),ve.Pc(5," Apply Camera Position to All Chapters "),ve.Ub(),ve.Sb()}if(2&e){var i=ve.gc();ve.Db(2),ve.mc("disabled",!i.storedCamera),ve.Db(2),ve.mc("disabled",!i.storedCamera)}}function Qa(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"button",33),ve.cc("click",(function(){return ve.Cc(n),ve.gc().clearQuery()})),ve.Pc(1," Clear "),ve.Ub()}}function $a(e,t){if(1&e&&(ve.Vb(0,"button",34),ve.Qb(1,"app-icon",35),ve.Ub()),2&e){ve.gc();var n=ve.yc(37);ve.mc("matMenuTriggerFor",n)}}function qa(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"button",36),ve.cc("click",(function(){return ve.Cc(n),ve.gc().setLayerOrderMode(!1)})),ve.Qb(1,"app-icon",37),ve.Ub()}}function Ga(e,t){if(1&e&&(ve.Vb(0,"div",38),ve.Qb(1,"app-tree",39),ve.Ub()),2&e){var n=ve.gc();ve.Db(1),ve.mc("theme",n.themeEnum.Dark)}}function Ha(e,t){if(1&e&&(ve.Vb(0,"div"),ve.Qb(1,"app-tree-nested-node",42),ve.hc(2,"async"),ve.Ub()),2&e){var n=t.$implicit,i=ve.gc(2);ve.Db(1),ve.mc("theme",i.themeEnum.Dark)("node",n)("graph",ve.ic(2,4,i.viewGraph$))("nested",!1)}}function Wa(e,t){if(1&e&&(ve.Vb(0,"cdk-virtual-scroll-viewport",40),ve.Nc(1,Ha,3,6,"div",41),ve.Ub()),2&e){var n=ve.gc();ve.Kc("height",n.searchHeight,"px"),ve.mc("itemSize",48),ve.Db(1),ve.mc("cdkVirtualForOf",n.searchResults)("cdkVirtualForTrackBy",n.trackTreeNode)}}var Ka,Ja=((Ka=function(){function e(t,n,i,o,a,r){l(this,e),this.store=t,this.renderer=n,this.changeDetector=i,this.engineEventsService=o,this.cameraService=a,this.snackbar=r,this.application=fe.a,this.themeEnum=ro.a,this.isLoft=dn.a.application===fe.a.Loft,this._selectedColumnGroup="chapters",this.loadingLabel="",this.interactive=!1,this.searchHeight=0,this.searchControl=new ae.g(""),this.searchResults=[],this.query="",this.copies=[],this.storedCamera=null,this.ngUnsubscribe=new C.a}return u(e,[{key:"selectedColumnGroup",get:function(){return this._selectedColumnGroup},set:function(e){this._selectedColumnGroup=e}},{key:"ngOnInit",value:function(){var e=this,t=this.store.selectSnapshot(X.a.getSelectedChapter);t&&t.readyState.model&&(this.interactive=!0),this.searchControl.valueChanges.pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.query=t,e.searchResults=e.search(t),e.getSearchHeight().pipe(Object(N.a)(e.ngUnsubscribe)).subscribe((function(t){e.searchHeight=t,e.changeDetector.markForCheck()}))})),this.engineEventsService.getEvent(oo.a.AssetsLoadProgress).pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){var n=e.store.selectSnapshot(X.a.getChaptersLoaded),i="";n.count>1&&(i="Loading Chapter ".concat(n.modelChapters.length+1," of ").concat(n.count,": ")),i+=Math.round(t.receivedAssets/t.requestedAssets*100)+"%",e.loadingLabel=i,e.changeDetector.markForCheck()})),this.currentChapter$.pipe(Object(R.a)((function(e){return null!=e})),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.interactive=t.readyState.model})),this.store.select(ln.a.getCheckedNodes).pipe(Object(R.a)((function(e){return e.length>0})),Object(io.a)(),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.selectedColumnGroup="anatomy",e.changeDetector.markForCheck()}))}},{key:"ngAfterViewInit",value:function(){var e=this;this.renderer.listen("window","resize",(function(t){e.getSearchHeight().pipe(Object(N.a)(e.ngUnsubscribe)).subscribe((function(t){e.searchHeight=t,e.changeDetector.markForCheck()}))}))}},{key:"ngOnDestroy",value:function(){this.changeDetector.detach(),this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"handleKeyup",value:function(e){"Escape"===e.key&&(this.clearQuery(),this.searchInput.nativeElement.blur())}},{key:"handleToggleIds",value:function(){this.store.dispatch(new U.m)}},{key:"handleToggleRootNodes",value:function(){var e=this.store.selectSnapshot(T.a.getShowRootNodes);this.store.dispatch(new U.k(!e))}},{key:"handleAutoCaptureChange",value:function(e){this.store.dispatch(new U.a(e.checked))}},{key:"handleCollapseStructures",value:function(){this.store.dispatch(new q.e)}},{key:"getSearchHeight",value:function(){var e=this;return new _.a((function(t){var n=Object(ce.get)(e.columnGroupBody,"nativeElement.parentElement.offsetHeight");null!=n&&(t.next(n),t.complete())}))}},{key:"clearQuery",value:function(){this.searchControl.setValue("")}},{key:"search",value:function(e){var t=this.store.selectSnapshot(V.a.getViewGraph);return e=Object(ao.remove)(e.toLowerCase()),Object.values(t.nodes).filter((function(t){return 0===e.length||Object(ao.remove)(t.label.toLowerCase()).indexOf(e)>=0})).sort((function(e,t){return e.label.localeCompare(t.label)})).sort((function(e,t){return Math.sign(e.depth-t.depth)}))}},{key:"trackTreeNode",value:function(e,t){return t.id}},{key:"setLayerOrderMode",value:function(e){this.store.dispatch(new U.g(e))}},{key:"autoSortLayers",value:function(){this.store.dispatch(new q.a),this.setLayerOrderMode(!0)}},{key:"resetLayers",value:function(){this.store.dispatch(new q.v),this.setLayerOrderMode(!0)}},{key:"copyCameraClick",value:function(){this.storedCamera=this.cameraService.getCamera(),this.snackbar.open("Stored camera position")}},{key:"pasteCameraClick",value:function(){this.storedCamera&&this.store.dispatch(new Z.l(this.storedCamera))}},{key:"applyCameraClick",value:function(e){var t=this,n="single"===e?[this.store.selectSnapshot(X.a.getSelectedChapter)]:this.store.selectSnapshot(X.a.getStoryChapters);this.storedCamera&&n.forEach((function(e){t.store.dispatch(new J.i(e.id,t.storedCamera))})),this.snackbar.open("single"===e?"Applied camera position.":"Applied camera position to ".concat(n.length," chapters.")),this.store.dispatch(new Z.l(this.storedCamera))}}]),e}()).\u0275fac=function(e){return new(e||Ka)(ve.Pb(y.h),ve.Pb(ve.H),ve.Pb(ve.i),ve.Pb(Ce.a),ve.Pb(zi.a),ve.Pb(ke.b))},Ka.\u0275cmp=ve.Jb({type:Ka,selectors:[["app-navigation-context"]],viewQuery:function(e,t){var n;1&e&&(ve.Vc(Fa,!0),ve.Jc(Ia,!0),ve.Jc(za,!0)),2&e&&(ve.xc(n=ve.dc())&&(t.columnBody=n.first),ve.xc(n=ve.dc())&&(t.columnGroupBody=n.first),ve.xc(n=ve.dc())&&(t.searchInput=n.first))},decls:58,vars:23,consts:[[3,"loadingLabel","loading","showHeader","selectedColumnGroup","selectedColumnGroupChange"],["label","Chapters"],["column-group-header",""],[1,"flex","items-center","justify-between","pl-2","pr-1"],["data-test","autoCapture","matTooltip","Automatically capture starting position and thumbnail",3,"checked","change"],[1,"text-12"],["app-button","","buttonSize","small",3,"matMenuTriggerFor",4,"appFlagApplication"],["cameraActions","matMenu"],["mat-menu-item","",3,"click"],["mat-menu-item","",3,"disabled","click"],[4,"appFlagApplication"],["column-group-body",""],[1,"pv-2","pl-2"],["label","Anatomy"],[1,"navigation-context__anatomy-header"],[1,"navigation-context__search"],["type","text","placeholder","Search...",1,"input","navigation-context__input",3,"formControl","keyup"],["searchInput",""],["app-button","","buttonType","text","class","navigation-context__clear",3,"click",4,"ngIf"],[1,"navigation-context__anatomy-subheader"],[1,"navigation-context__selected"],["app-button","","buttonSize","xsmall","matTooltip","Collapse Open Tree Structures",3,"click"],["icon","minus","size","xs"],["app-button","","buttonSize","xsmall","class","ml-1",3,"matMenuTriggerFor",4,"ngIf"],["class","ml-1","app-button","","buttonSize","xsmall","matTooltip","Exit Layer Order Manager",3,"click",4,"ngIf"],["treeActions","matMenu"],["mat-menu-item","",3,"matMenuTriggerFor"],["layerOrderActions","matMenu"],["columnGroupBody",""],["class","pt-2 ph-2",4,"ngIf"],["style","margin-right: -12px",3,"itemSize","height",4,"ngIf"],["app-button","","buttonSize","small",3,"matMenuTriggerFor"],["icon","ellipsis-v"],["app-button","","buttonType","text",1,"navigation-context__clear",3,"click"],["app-button","","buttonSize","xsmall",1,"ml-1",3,"matMenuTriggerFor"],["icon","ellipsis-v","size","xs"],["app-button","","buttonSize","xsmall","matTooltip","Exit Layer Order Manager",1,"ml-1",3,"click"],["icon","times"],[1,"pt-2","ph-2"],[3,"theme"],[2,"margin-right","-12px",3,"itemSize"],[4,"cdkVirtualFor","cdkVirtualForOf","cdkVirtualForTrackBy"],[2,"height","48px",3,"theme","node","graph","nested"]],template:function(e,t){if(1&e&&(ve.Vb(0,"app-column",0),ve.cc("selectedColumnGroupChange",(function(e){return t.selectedColumnGroup=e})),ve.hc(1,"async"),ve.Vb(2,"app-column-group",1),ve.Tb(3,2),ve.Vb(4,"div",3),ve.Vb(5,"mat-checkbox",4),ve.cc("change",(function(e){return t.handleAutoCaptureChange(e)})),ve.hc(6,"async"),ve.Vb(7,"span",5),ve.Pc(8,"Auto-capture starting position"),ve.Ub(),ve.Ub(),ve.Nc(9,La,2,1,"button",6),ve.Ub(),ve.Vb(10,"mat-menu",null,7),ve.Vb(12,"button",8),ve.cc("click",(function(){return t.copyCameraClick()})),ve.Pc(13,"Copy Camera Position"),ve.Ub(),ve.Vb(14,"button",9),ve.cc("click",(function(){return t.pasteCameraClick()})),ve.Pc(15," Paste Camera Position "),ve.Ub(),ve.Nc(16,Ba,6,2,"ng-container",10),ve.Ub(),ve.Sb(),ve.Tb(17,11),ve.Vb(18,"div",12),ve.Qb(19,"app-chapter-browser"),ve.Ub(),ve.Sb(),ve.Ub(),ve.Vb(20,"app-column-group",13),ve.Tb(21,2),ve.Vb(22,"div",14),ve.Vb(23,"div",15),ve.Vb(24,"input",16,17),ve.cc("keyup",(function(e){return t.handleKeyup(e)})),ve.Ub(),ve.Nc(26,Qa,2,0,"button",18),ve.Ub(),ve.Vb(27,"div",19),ve.Qb(28,"app-checked-nodes",20),ve.Vb(29,"div"),ve.Vb(30,"button",21),ve.cc("click",(function(){return t.handleCollapseStructures()})),ve.Qb(31,"app-icon",22),ve.Ub(),ve.Nc(32,$a,2,1,"button",23),ve.hc(33,"async"),ve.Nc(34,qa,2,0,"button",24),ve.hc(35,"async"),ve.Ub(),ve.Ub(),ve.Vb(36,"mat-menu",null,25),ve.Vb(38,"button",26),ve.Pc(39,"Layer Order"),ve.Ub(),ve.Qb(40,"mat-divider"),ve.Vb(41,"button",8),ve.cc("click",(function(){return t.handleToggleIds()})),ve.Pc(42,"Toggle IDs"),ve.Ub(),ve.Vb(43,"button",8),ve.cc("click",(function(){return t.handleToggleRootNodes()})),ve.Pc(44,"Toggle Root Nodes"),ve.Ub(),ve.Ub(),ve.Vb(45,"mat-menu",null,27),ve.Vb(47,"button",8),ve.cc("click",(function(){return t.setLayerOrderMode(!0)})),ve.Pc(48,"Manage Layer Order"),ve.Ub(),ve.Qb(49,"mat-divider"),ve.Vb(50,"button",8),ve.cc("click",(function(){return t.autoSortLayers()})),ve.Pc(51,"Auto Sort Layer Order"),ve.Ub(),ve.Vb(52,"button",8),ve.cc("click",(function(){return t.resetLayers()})),ve.Pc(53,"Reset Layer Order"),ve.Ub(),ve.Ub(),ve.Ub(),ve.Sb(),ve.Vb(54,"div",11,28),ve.Nc(56,Ga,2,1,"div",29),ve.Nc(57,Wa,2,5,"cdk-virtual-scroll-viewport",30),ve.Ub(),ve.Ub(),ve.Ub()),2&e){var n=ve.yc(46);ve.mc("loadingLabel",t.loadingLabel)("loading",!ve.ic(1,15,t.allChaptersReady$))("showHeader",!1)("selectedColumnGroup",t.selectedColumnGroup),ve.Db(5),ve.mc("checked",ve.ic(6,17,t.autoCapture$)),ve.Db(4),ve.mc("appFlagApplication",t.application.Loft),ve.Db(5),ve.mc("disabled",!t.storedCamera),ve.Db(2),ve.mc("appFlagApplication",t.application.Loft),ve.Db(8),ve.mc("formControl",t.searchControl),ve.Db(2),ve.mc("ngIf",t.query),ve.Db(6),ve.mc("ngIf",t.isLoft&&!ve.ic(33,19,t.layerOrderMode$)),ve.Db(2),ve.mc("ngIf",t.isLoft&&ve.ic(35,21,t.layerOrderMode$)),ve.Db(4),ve.mc("matMenuTriggerFor",n),ve.Db(18),ve.mc("ngIf",!t.query.length),ve.Db(1),ve.mc("ngIf",t.query.length&&t.searchHeight)}},directives:[ko,lo,Ue.a,Ct.c,wt.a,Ki.a,Ki.b,Pa,ae.c,ae.r,ae.h,f.p,Da,Pe.a,yt.a,Ki.d,_e.a,Ea.a,ja.e,ja.a,ja.d,Na.a],pipes:[f.b],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%}.navigation-context__anatomy-subheader[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.navigation-context__loading[_ngcontent-%COMP%]{padding:16px;display:flex;justify-content:center}.navigation-context__search[_ngcontent-%COMP%]{position:relative;margin-bottom:8px}.navigation-context__input[_ngcontent-%COMP%]{padding-right:56px;width:100%}.navigation-context__clear[_ngcontent-%COMP%]{position:absolute;right:0;top:0}.navigation-context__selected[_ngcontent-%COMP%]{display:flex}.navigation-context__actions[_ngcontent-%COMP%]{border-radius:4px;color:#d7e0ea;display:flex;flex:0 0 24px;height:24px;justify-content:center;align-items:center}.navigation-context__actions[_ngcontent-%COMP%]:hover{background-color:#1c2a3f;color:#fff;cursor:pointer}.navigation-context--selected[_ngcontent-%COMP%]   .navigation-context__actions[_ngcontent-%COMP%]:hover{background-color:#2d72dc}"],changeDetection:0}),Ra([Object(y.e)(V.a.getViewGraph),Aa("design:type",_.a)],Ka.prototype,"viewGraph$",void 0),Ra([Object(y.e)(X.a.getSelectedChapter),Aa("design:type",_.a)],Ka.prototype,"currentChapter$",void 0),Ra([Object(y.e)(X.a.getChaptersLoaded),Aa("design:type",_.a)],Ka.prototype,"chaptersLoaded$",void 0),Ra([Object(y.e)(X.a.getAllChaptersModelsReady),Aa("design:type",_.a)],Ka.prototype,"allChaptersReady$",void 0),Ra([Object(y.e)(T.a.getLayerOrderMode),Aa("design:type",_.a)],Ka.prototype,"layerOrderMode$",void 0),Ra([Object(y.e)(T.a.getAutoCapture),Aa("design:type",_.a)],Ka.prototype,"autoCapture$",void 0),Ra([Object(y.e)(T.a.getShowRootNodes),Aa("design:type",_.a)],Ka.prototype,"showRootNodes$",void 0),Ka),Xa=o("XiU4"),Za=o("nS47"),Ya=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},er=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function tr(e,t){if(1&e&&(ve.Vb(0,"div",1),ve.Vb(1,"div",2),ve.Pc(2),ve.Ub(),ve.Vb(3,"div",3),ve.Pc(4),ve.Ub(),ve.Ub()),2&e){var n=t.ngIf,i=ve.gc();ve.Db(2),ve.Qc(n.label),ve.Db(2),ve.Rc(" ",i.nodeAncestors," ")}}var nr,ir,or,ar=((ir=function(){function e(t,n,i){l(this,e),this.graphService=t,this.store=n,this.changeDetection=i,this.ngUnsubscribe=new C.a}return u(e,[{key:"ngOnInit",value:function(){var e=this;this.hoveredNode$.pipe(Object(R.a)((function(e){return null!=e})),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.nodeAncestors=e.getNodeAncestors(t).map((function(e){return e.label})).slice(0,-1).join(" > "),e.nodeAncestors.length>160&&(e.nodeAncestors="..."+e.nodeAncestors.slice(-160)),e.changeDetection.markForCheck()}))}},{key:"ngOnDestroy",value:function(){this.changeDetection.detach(),this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"getNodeAncestors",value:function(e){var t=this.store.selectSnapshot(V.a.getViewGraph);return Za.a.getAncestors(t,e.id,!0).map((function(e){return t.nodes[e]})).reverse()}}]),e}()).\u0275fac=function(e){return new(e||ir)(ve.Pb(wa.a),ve.Pb(y.h),ve.Pb(ve.i))},ir.\u0275cmp=ve.Jb({type:ir,selectors:[["app-engine-breadcrumb"]],decls:2,vars:3,consts:[["class","breadcrumb",4,"ngIf"],[1,"breadcrumb"],[1,"breadcrumb__node"],[1,"breadcrumb__ancestors"]],template:function(e,t){1&e&&(ve.Nc(0,tr,5,2,"div",0),ve.hc(1,"async")),2&e&&ve.mc("ngIf",ve.ic(1,1,t.hoveredNode$))},directives:[f.p],pipes:[f.b],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.breadcrumb[_ngcontent-%COMP%]{-webkit-animation:fadeIn .25s ease forwards;animation:fadeIn .25s ease forwards;color:#fff;display:flex;flex-direction:column;justify-content:center;text-align:center}.breadcrumb__node[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em;color:#fff;font-weight:700}.theme-light[_nghost-%COMP%]   .breadcrumb__node[_ngcontent-%COMP%], .theme-light   [_nghost-%COMP%]   .breadcrumb__node[_ngcontent-%COMP%]{color:#1c2a3f}.breadcrumb__ancestors[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase;color:#96a8c0;padding-top:4px}.theme-light[_nghost-%COMP%]   .breadcrumb__ancestors[_ngcontent-%COMP%], .theme-light   [_nghost-%COMP%]   .breadcrumb__ancestors[_ngcontent-%COMP%]{color:#374a68}"],changeDetection:0}),Ya([Object(y.e)(V.a.getHoveredNode),er("design:type",_.a)],ir.prototype,"hoveredNode$",void 0),Ya([Object(y.e)(ln.a.getCheckedNodes),er("design:type",_.a)],ir.prototype,"checkedNodes$",void 0),ir),rr=((nr=function(){function e(t,n){l(this,e),this.templateRef=t,this.viewContainer=n}return u(e,[{key:"ngOnInit",value:function(){this.update()}},{key:"update",value:function(){"bookmark"===dn.a.exportType?this.viewContainer.createEmbeddedView(this.templateRef):this.viewContainer.clear()}}]),e}()).\u0275fac=function(e){return new(e||nr)(ve.Pb(ve.O),ve.Pb(ve.S))},nr.\u0275dir=ve.Kb({type:nr,selectors:[["","appFlagExternal",""]]}),nr),cr=o("E+WR"),sr=((or=function(){function e(){l(this,e)}return u(e,[{key:"transform",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n=parseInt(e,10);return isNaN(n)?"":(n/1048576).toFixed(t)}}]),e}()).\u0275fac=function(e){return new(e||or)},or.\u0275pipe=ve.Ob({name:"megabyte",type:or,pure:!0}),or),lr=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},pr=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function ur(e,t){if(1&e&&(ve.Vb(0,"table",3),ve.Vb(1,"tr"),ve.Vb(2,"td",4),ve.Pc(3,"Summary"),ve.Ub(),ve.Qb(4,"td"),ve.Ub(),ve.Vb(5,"tr"),ve.Vb(6,"td",5),ve.Pc(7,"Module Total Memory"),ve.Ub(),ve.Vb(8,"td",6),ve.Pc(9),ve.hc(10,"megabyte"),ve.Ub(),ve.Ub(),ve.Vb(11,"tr"),ve.Vb(12,"td",5),ve.Pc(13,"First Chapter Download"),ve.Ub(),ve.Vb(14,"td",6),ve.Pc(15),ve.hc(16,"megabyte"),ve.hc(17,"async"),ve.Ub(),ve.Ub(),ve.Vb(18,"tr"),ve.Vb(19,"td",5),ve.Pc(20,"Download Size"),ve.Ub(),ve.Vb(21,"td",6),ve.Pc(22),ve.hc(23,"megabyte"),ve.Ub(),ve.Ub(),ve.Vb(24,"tr"),ve.Vb(25,"td",5),ve.Pc(26,"Uncompressed Geos"),ve.Ub(),ve.Vb(27,"td",6),ve.Pc(28),ve.hc(29,"megabyte"),ve.Ub(),ve.Ub(),ve.Vb(30,"tr"),ve.Vb(31,"td",5),ve.Pc(32,"Uncompressed Morphs"),ve.Ub(),ve.Vb(33,"td",6),ve.Pc(34),ve.hc(35,"megabyte"),ve.Ub(),ve.Ub(),ve.Vb(36,"tr"),ve.Vb(37,"td",5),ve.Pc(38,"Uncompressed Textures"),ve.Ub(),ve.Vb(39,"td",6),ve.Pc(40),ve.hc(41,"megabyte"),ve.Ub(),ve.Ub(),ve.Ub()),2&e){var n=ve.gc();ve.Db(9),ve.Rc(" ",ve.ic(10,6,n.globalStats.memory),"MB "),ve.Db(6),ve.Rc(" ",ve.ic(16,8,ve.ic(17,10,n.firstChapterDownloadSize$)),"MB "),ve.Db(7),ve.Rc(" ",ve.ic(23,12,n.globalStats.downloadSize),"MB "),ve.Db(6),ve.Rc(" ",ve.ic(29,14,n.globalStats.uncompressedGeos),"MB "),ve.Db(6),ve.Rc(" ",ve.ic(35,16,n.globalStats.uncompressedMorphs),"MB "),ve.Db(6),ve.Rc(" ",ve.ic(41,18,n.globalStats.uncompressedTextures),"MB ")}}function dr(e,t){if(1&e&&(ve.Tb(0),ve.Pc(1),ve.hc(2,"megabyte"),ve.Sb()),2&e){var n=ve.gc().$implicit;ve.Db(1),ve.Rc("",ve.ic(2,1,n.value),"MB")}}function mr(e,t){if(1&e&&(ve.Tb(0),ve.Pc(1),ve.hc(2,"number"),ve.Sb()),2&e){var n=ve.gc().$implicit;ve.Db(1),ve.Qc(ve.ic(2,1,n.value))}}function hr(e,t){if(1&e&&(ve.Tb(0),ve.Pc(1),ve.hc(2,"megabyte"),ve.Sb()),2&e){var n=ve.gc().$implicit;ve.Db(1),ve.Rc("",ve.ic(2,1,n.value),"MB")}}function br(e,t){if(1&e&&(ve.Tb(0),ve.Pc(1),ve.hc(2,"number"),ve.Sb()),2&e){var n=ve.gc().$implicit;ve.Db(1),ve.Qc(ve.ic(2,1,n.value))}}function fr(e,t){if(1&e&&(ve.Tb(0),ve.Pc(1),ve.hc(2,"megabyte"),ve.Sb()),2&e){var n=ve.gc().$implicit;ve.Db(1),ve.Rc("",ve.ic(2,1,n.value),"MB")}}function gr(e,t){if(1&e&&(ve.Tb(0),ve.Pc(1),ve.hc(2,"number"),ve.Sb()),2&e){var n=ve.gc().$implicit;ve.Db(1),ve.Qc(ve.ic(2,1,n.value))}}function vr(e,t){if(1&e&&(ve.Vb(0,"tr"),ve.Vb(1,"td",14),ve.Pc(2),ve.Ub(),ve.Vb(3,"td",15),ve.Tb(4,9),ve.Nc(5,fr,3,3,"ng-container",10),ve.Nc(6,gr,3,3,"ng-container",11),ve.Sb(),ve.Ub(),ve.Ub()),2&e){var n=t.$implicit;ve.Db(2),ve.Rc(" ",n.name," "),ve.Db(2),ve.mc("ngSwitch",n.unit),ve.Db(1),ve.mc("ngSwitchCase","bytes")}}function yr(e,t){if(1&e&&(ve.Tb(0),ve.Vb(1,"tr"),ve.Vb(2,"td",13),ve.Pc(3),ve.Ub(),ve.Vb(4,"td",6),ve.Tb(5,9),ve.Nc(6,hr,3,3,"ng-container",10),ve.Nc(7,br,3,3,"ng-container",11),ve.Sb(),ve.Ub(),ve.Ub(),ve.Nc(8,vr,7,3,"tr",12),ve.Sb()),2&e){var n=t.$implicit;ve.Db(3),ve.Qc(n.name),ve.Db(2),ve.mc("ngSwitch",n.unit),ve.Db(1),ve.mc("ngSwitchCase","bytes"),ve.Db(2),ve.mc("ngForOf",n.reports)}}function xr(e,t){if(1&e&&(ve.Vb(0,"table",3),ve.Vb(1,"tr"),ve.Vb(2,"td",7),ve.Pc(3),ve.Ub(),ve.Vb(4,"td",8),ve.Tb(5,9),ve.Nc(6,dr,3,3,"ng-container",10),ve.Nc(7,mr,3,3,"ng-container",11),ve.Sb(),ve.Ub(),ve.Ub(),ve.Nc(8,yr,9,4,"ng-container",12),ve.Ub()),2&e){var n=t.$implicit;ve.Db(3),ve.Rc(" ",n.name," "),ve.Db(2),ve.mc("ngSwitch",n.unit),ve.Db(1),ve.mc("ngSwitchCase","bytes"),ve.Db(2),ve.mc("ngForOf",n.reports)}}var Cr,kr,Pr,Or=((Cr=function(){function e(){l(this,e),this.ngUnsubscribe=new C.a}return u(e,[{key:"ngOnInit",value:function(){var e=this;this.memory$.pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.globalStats=t.globalStats,e.stats=[t.morphStatsReport,t.geoStatsReport,t.textureStatsReport,t.downloadReport]}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}}]),e}()).\u0275fac=function(e){return new(e||Cr)},Cr.\u0275cmp=ve.Jb({type:Cr,selectors:[["app-memory-details"]],decls:3,vars:2,consts:[[1,"memory-details"],["class","memory-details__group",4,"ngIf"],["class","memory-details__group",4,"ngFor","ngForOf"],[1,"memory-details__group"],[1,"memory-details__cell","memory-details__cell--bold"],[1,"memory-details__cell","memory-details__cell--label"],[1,"memory-details__cell","memory-details__cell--value"],[1,"memory-details__cell","memory-details__cell--label","memory-details__cell--bold"],[1,"memory-details__cell","memory-details__cell--value","memory-details__cell--bold"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[4,"ngFor","ngForOf"],[1,"memory-details__cell"],[1,"memory-details__cell","memory-details__cell--label","memory-details__cell--label","memory-details__cell--indent","memory-details__cell--secondary"],[1,"memory-details__cell","memory-details__cell--value","memory-details__cell--secondary"]],template:function(e,t){1&e&&(ve.Vb(0,"div",0),ve.Nc(1,ur,42,20,"table",1),ve.Nc(2,xr,9,4,"table",2),ve.Ub()),2&e&&(ve.Db(1),ve.mc("ngIf",t.globalStats),ve.Db(1),ve.mc("ngForOf",t.stats))},directives:[f.p,f.o,f.r,f.s,f.t],pipes:[sr,f.b,f.f],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.memory-details[_ngcontent-%COMP%]{max-height:600px;overflow-y:auto;padding-right:24px;font-size:12px;letter-spacing:.3px;line-height:1.4em}.memory-details__group[_ngcontent-%COMP%]{margin-bottom:16px;width:100%}.memory-details__cell[_ngcontent-%COMP%]{padding-right:4px}.memory-details__cell--label[_ngcontent-%COMP%]{color:#283853}.memory-details__cell--bold[_ngcontent-%COMP%]{color:#131c2a;font-weight:600}.memory-details__cell--value[_ngcontent-%COMP%]{text-align:right;padding:4px;width:80px}.memory-details__cell--indent[_ngcontent-%COMP%]{padding-left:8px}.memory-details__cell--secondary[_ngcontent-%COMP%]{color:#61779e}"],changeDetection:0}),lr([Object(y.e)(cr.a),pr("design:type",_.a)],Cr.prototype,"memory$",void 0),lr([Object(y.e)(cr.a.getFirstChapterDownloadSize),pr("design:type",_.a)],Cr.prototype,"firstChapterDownloadSize$",void 0),Cr),wr=o("JnPr"),Sr=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},_r=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Mr=["memorySummary"],Ur=((kr=function(){function e(t){l(this,e),this.popupService=t,this.ngUnsubscribe=new C.a}return u(e,[{key:"ngOnInit",value:function(){}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"handleClick",value:function(){this.togglePopup()}},{key:"togglePopup",value:function(){var e=this;this.summaryPopup?this.summaryPopup.close():(this.summaryPopup=this.popupService.open({origin:this.memorySummary.nativeElement,content:Or}),this.summaryPopup.afterClosed$.pipe(Object(N.a)(this.ngUnsubscribe),Object(F.a)(1)).subscribe((function(){e.summaryPopup=null})))}}]),e}()).\u0275fac=function(e){return new(e||kr)(ve.Pb(wr.a))},kr.\u0275cmp=ve.Jb({type:kr,selectors:[["app-memory-summary"]],viewQuery:function(e,t){var n;1&e&&ve.Vc(Mr,!0),2&e&&ve.xc(n=ve.dc())&&(t.memorySummary=n.first)},features:[ve.Cb([wr.a])],decls:25,vars:23,consts:[[1,"memory-summary",3,"click"],["memorySummary",""],[1,"memory-summary__item"],[1,"memory-summary__label"],[1,"memory-summary__value"]],template:function(e,t){var n,i,o,a;(1&e&&(ve.Vb(0,"table",0,1),ve.cc("click",(function(){return t.handleClick()})),ve.Vb(2,"tr",2),ve.hc(3,"async"),ve.Vb(4,"td",3),ve.Pc(5,"Memory"),ve.Ub(),ve.Vb(6,"td",4),ve.Pc(7),ve.hc(8,"megabyte"),ve.hc(9,"async"),ve.Ub(),ve.Ub(),ve.Vb(10,"tr",2),ve.Vb(11,"td",3),ve.Pc(12,"All Chap"),ve.Ub(),ve.Vb(13,"td",4),ve.Pc(14),ve.hc(15,"megabyte"),ve.hc(16,"async"),ve.Ub(),ve.Ub(),ve.Vb(17,"tr",2),ve.hc(18,"async"),ve.Vb(19,"td",3),ve.Pc(20,"1st Chap"),ve.Ub(),ve.Vb(21,"td",4),ve.Pc(22),ve.hc(23,"megabyte"),ve.hc(24,"async"),ve.Ub(),ve.Ub(),ve.Ub()),2&e)&&(ve.Db(2),ve.Hb("memory-summary__item--alert",(null==(n=ve.ic(3,7,t.globalStats$))?null:n.memory)>104857600),ve.Db(5),ve.Rc("",ve.ic(8,9,null==(i=ve.ic(9,11,t.globalStats$))?null:i.memory),"MB / 100MB"),ve.Db(7),ve.Rc("",ve.ic(15,13,null==(o=ve.ic(16,15,t.globalStats$))?null:o.downloadSize),"MB"),ve.Db(3),ve.Hb("memory-summary__item--alert",(null==(a=ve.ic(18,17,t.globalStats$))?null:a.firstChapterDownloadSize)>12582912),ve.Db(5),ve.Rc(" ",ve.ic(23,19,ve.ic(24,21,t.firstChapterDownloadSize$)),"MB / 12MB "))},pipes:[f.b,sr],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.memory-summary[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.memory-summary[_ngcontent-%COMP%]:hover{cursor:pointer}.memory-summary[_ngcontent-%COMP%]:hover   .memory-summary__label[_ngcontent-%COMP%]{color:#fff}.memory-summary__label[_ngcontent-%COMP%]{color:#96a8c0;padding-right:4px}.memory-summary__value[_ngcontent-%COMP%]{text-align:right}.memory-summary__item--alert[_ngcontent-%COMP%]   .memory-summary__label[_ngcontent-%COMP%]{color:#ed4758;font-weight:700}"],changeDetection:0}),Sr([Object(y.e)(cr.a.getGlobalStats),_r("design:type",_.a)],kr.prototype,"globalStats$",void 0),Sr([Object(y.e)(cr.a.getFirstChapterDownloadSize),_r("design:type",_.a)],kr.prototype,"firstChapterDownloadSize$",void 0),kr),Tr=o("7XdW"),Vr=((Pr=function(){function e(t,n){l(this,e),this.previousRouteService=t,this.router=n,this.url=""}return u(e,[{key:"ngOnInit",value:function(){this.url=this.previousRouteService.getPreviousUrl()}},{key:"exit",value:function(){switch(!0){case this.url.startsWith("/explore"):case this.url.startsWith("/results/"):case this.url.startsWith("/view"):this.router.navigateByUrl(this.url);break;default:this.router.navigateByUrl("/results/bookmarks")}}}]),e}()).\u0275fac=function(e){return new(e||Pr)(ve.Pb(Tr.a),ve.Pb(g.e))},Pr.\u0275cmp=ve.Jb({type:Pr,selectors:[["app-edit-exit"]],decls:2,vars:0,consts:[["app-button","","buttonType","outline","type","button",3,"click"]],template:function(e,t){1&e&&(ve.Vb(0,"button",0),ve.cc("click",(function(){return t.exit()})),ve.Pc(1,"Exit"),ve.Ub())},directives:[Pe.a],styles:[""],changeDetection:0}),Pr),Dr=o("+rOU");function Er(e,t){1&e&&ve.kc(0,0,["*ngIf","!currentPortal"])}function jr(e,t){}function Nr(e,t){if(1&e&&ve.Nc(0,jr,0,0,"ng-template",1),2&e){var n=ve.gc();ve.mc("cdkPortalOutlet",n.currentPortal)}}var Rr,Ar=["*"],Fr=((Rr=function(){function e(t,n){l(this,e),this.changeRef=t,this._viewContainerRef=n,this.portals=[],this.ngUnsubscribe=new C.a,this.portalSubscription=new C.a}return u(e,[{key:"currentPortal",get:function(){return this.portals[this.portals.length-1]}},{key:"ngOnInit",value:function(){this.initListeners()}},{key:"ngOnDestroy",value:function(){this.currentPortal&&this.currentPortal.isAttached&&this.currentPortal.detach(),this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initListeners",value:function(){var e=this;this.portalSubscription.asObservable().pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.portals.push(t),e.changeRef.markForCheck()}))}},{key:"loadComponent",value:function(e){this.loadPortal(new Dr.c(e))}},{key:"loadTemplate",value:function(e){this.loadPortal(new Dr.g(e,this._viewContainerRef))}},{key:"loadPortal",value:function(e){this.portalSubscription.next(e)}},{key:"back",value:function(){this.portals.pop(),this.changeRef.markForCheck()}},{key:"exit",value:function(){this.portals.length=0,this.changeRef.markForCheck()}}]),e}()).\u0275fac=function(e){return new(e||Rr)(ve.Pb(ve.i),ve.Pb(ve.S))},Rr.\u0275cmp=ve.Jb({type:Rr,selectors:[["app-portal"]],ngContentSelectors:Ar,decls:2,vars:2,consts:[[4,"ngIf"],[3,"cdkPortalOutlet"]],template:function(e,t){1&e&&(ve.lc(),ve.Nc(0,Er,1,0,"ng-content",0),ve.Nc(1,Nr,1,1,void 0,0)),2&e&&(ve.mc("ngIf",!t.currentPortal),ve.Db(1),ve.mc("ngIf",t.currentPortal))},directives:[f.p,Dr.b],styles:[""],changeDetection:0}),Rr),Ir=function(e){return e.Color="color",e.Alpha="alpha",e.Emit="emit",e}({}),zr=function(e){return e.DirectionalVelocity="DirectionalVelocity",e.Lifetime="Lifetime",e.PointPosition="PointPosition",e.RandomVelocity="RandomVelocity",e.SpherePosition="SpherePosition",e.CylinderPosition="CylinderPosition",e.CubePosition="CubePosition",e.RandomRotation="RandomRotation",e.RandomRotationSpeed="RandomRotationSpeed",e.RandomScale="RandomScale",e.SpriteAnimationDuration="SpriteAnimationDuration",e}({}),Lr=function(e){return e.AgeColorBlend="AgeColorBlend",e.BrownianMotion="BrownianMotion",e.UniformForce="UniformForce",e.RadialForce="RadialForce",e.Friction="Friction",e.Gravity="Gravity",e.Path="Path",e.AxisForce="AxisForce",e.SpriteAnimation="SpriteAnimation",e}({}),Br=function(e){return e.LifetimeKill="LifetimeKill",e.LifetimeStop="LifetimeStop",e.PathKill="PathKill",e.PathStop="PathStop",e.PathRadius="PathRadius",e.ShapeBounce="ShapeBounce",e.ShapeKill="ShapeKill",e.ShapeStop="ShapeStop",e}({}),Qr=function(e){return e.Sphere="Sphere",e.Plane="Plane",e.Cube="Cube",e.Cylinder="Cylinder",e}({}),$r=function(e){return e.In="in",e.Out="out",e}({}),qr={type:Qr.Cube,direction:$r.In,translate:[0,0,0],rotate:[0,0,0],scale:[1,1,1]},Gr=[Br.ShapeBounce,Br.ShapeKill,Br.ShapeStop],Hr=(d(p={},Br.LifetimeKill,{type:Br.LifetimeKill}),d(p,Br.LifetimeStop,{type:Br.LifetimeStop}),d(p,Br.PathKill,{type:Br.PathKill}),d(p,Br.PathStop,{type:Br.PathStop}),d(p,Br.PathRadius,{type:Br.PathRadius}),d(p,Br.ShapeBounce,{type:Br.ShapeBounce,trap:!1,shape:Object.assign({},qr)}),d(p,Br.ShapeKill,{type:Br.ShapeKill,trap:!1,shape:Object.assign({},qr)}),d(p,Br.ShapeStop,{type:Br.ShapeStop,trap:!1,shape:Object.assign({},qr)}),p),Wr=(d(m={},zr.DirectionalVelocity,{type:zr.DirectionalVelocity,directionAverage:[0,1,0],forceAverage:5,directionVariance:.5,forceVariance:1}),d(m,zr.Lifetime,{type:zr.Lifetime,average:2.5,variance:1}),d(m,zr.PointPosition,{type:zr.PointPosition,position:[0,0,0]}),d(m,zr.RandomVelocity,{type:zr.RandomVelocity,forceAverage:5,forceVariance:0}),d(m,zr.SpherePosition,{type:zr.SpherePosition,scale:[1,1,1],rotate:[0,0,0],translate:[0,0,0]}),d(m,zr.CylinderPosition,{type:zr.CylinderPosition,scale:[1,1,1],rotate:[0,0,0],translate:[0,0,0]}),d(m,zr.CubePosition,{type:zr.CubePosition,scale:[1,1,1],rotate:[0,0,0],translate:[0,0,0]}),d(m,zr.RandomRotation,{type:zr.RandomRotation,average:0,variance:0}),d(m,zr.RandomRotationSpeed,{type:zr.RandomRotationSpeed,average:0,variance:180}),d(m,zr.RandomScale,{type:zr.RandomScale,average:1,variance:0}),d(m,zr.SpriteAnimationDuration,{type:zr.SpriteAnimationDuration,average:1,variance:0}),m),Kr=(d(h={},Lr.AgeColorBlend,{type:Lr.AgeColorBlend,colors:[[255,0,0,255],[0,255,0,255],[0,0,0,255]]}),d(h,Lr.BrownianMotion,{type:Lr.BrownianMotion,frequency:10,forceAverage:5,forceVariance:0}),d(h,Lr.UniformForce,{type:Lr.UniformForce,directionAverage:[0,1,0],forceAverage:5,directionVariance:0,forceVariance:0}),d(h,Lr.RadialForce,{type:Lr.RadialForce,position:[0,0,0],forceAverage:5,forceVariance:0}),d(h,Lr.Friction,{type:Lr.Friction,friction:.1}),d(h,Lr.Gravity,{type:Lr.Gravity,position:[0,0,0],radius:1,forceAverage:5,forceVariance:0}),d(h,Lr.Path,{type:Lr.Path,nodes:[{position:[0,0,0],forceAverage:1,radius:1,forceVariance:0}]}),d(h,Lr.AxisForce,{type:Lr.AxisForce,position:[0,0,0],direction:[1,0,0],forceAverage:5,forceVariance:0}),d(h,Lr.SpriteAnimation,{type:Lr.SpriteAnimation}),h),Jr={type:Qr.Sphere,direction:$r.In,translate:[0,0,0],rotate:[0,0,0],scale:[1,1,1]},Xr={baseColor:{r:1,g:0,b:0},alpha:1},Zr={spriteRows:8,spriteCols:8,spriteStartFrame:0,spriteEndFrame:63},Yr={layer:1,depthMask:!1,roundPoints:!0,perspectivePoints:!0,addAlpha:!1},ec={id:"",name:"",numParticles:1e4,pointSize:10,emissionAverage:500,emissionVariance:0,textures:[],properties:Object.assign({},Yr),constraints:[Hr[Br.LifetimeKill]],creators:[Wr[zr.PointPosition],Wr[zr.RandomVelocity],Wr[zr.Lifetime]],updaters:[Kr[Lr.AgeColorBlend],Kr[Lr.Friction]]},tc=Object.assign(Object.assign(Object.assign({},ec),{material:Xr}),Zr);function nc(){var e=JSON.parse(JSON.stringify(ec)),t=e.constraints,n=e.creators,i=e.updaters;return Object.assign(Object.assign({},e),{constraints:t.map((function(e,t){return Object.assign(Object.assign({},e),{id:Ho.a.idWithPrefix("constraint")})})),creators:n.map((function(e,t){return Object.assign(Object.assign({},e),{id:Ho.a.idWithPrefix("creator")})})),updaters:i.map((function(e,t){return Object.assign(Object.assign({},e),{id:Ho.a.idWithPrefix("updater")})}))})}function ic(e){return Object.assign({},Hr[e])}function oc(e){return Object.assign({},Wr[e])}function ac(e){return Object.assign({},Kr[e])}function rc(e){return Object(ce.omitBy)(e,ce.isNil)}function cc(e){return rc(function(e){return Object.keys(tc).reduce((function(t,n){return t[n]=e[n],t}),{})}(e))}function sc(e,t){return rc(function(e,t){var n=t.id,i=t.name,o=t.shape,a=t.trap;return Gr.includes(e)?{id:n,name:i,type:e,trap:a,shape:o}:{id:n,name:i,type:e}}(e,t))}function lc(e,t){return rc(function(e,t){var n=t.id,i=t.name,o=t.directionAverage,a=t.forceAverage,r=t.directionVariance,c=t.forceVariance,s=t.average,l=t.variance,p=t.position,u=t.scale,d=t.rotate,m=t.translate;switch(e){case zr.DirectionalVelocity:return{id:n,name:i,type:e,directionAverage:o,forceAverage:a,directionVariance:r,forceVariance:c};case zr.Lifetime:return{id:n,name:i,type:e,average:s,variance:l};case zr.PointPosition:return{id:n,name:i,type:e,position:p};case zr.RandomVelocity:return{id:n,name:i,type:e,forceAverage:a,forceVariance:c};case zr.SpherePosition:case zr.CylinderPosition:case zr.CubePosition:return{id:n,name:i,type:e,scale:u,rotate:d,translate:m};case zr.RandomRotation:case zr.RandomRotationSpeed:case zr.RandomScale:case zr.SpriteAnimationDuration:return{id:n,name:i,type:e,average:s,variance:l};default:return}}(e,t))}function pc(e,t){return rc(function(e,t){var n=t.id,i=t.name,o=t.colors,a=t.position,r=t.direction,c=t.friction,s=t.frequency,l=t.forceAverage,p=t.radius,u=t.forceVariance,d=t.nodes,m=t.shape,h=t.directionAverage,b=t.directionVariance;switch(e){case Lr.AgeColorBlend:return{id:n,name:i,type:e,colors:o,shape:m};case Lr.BrownianMotion:return{id:n,name:i,type:e,frequency:s,forceAverage:l,forceVariance:u,shape:m};case Lr.UniformForce:return{id:n,name:i,type:e,directionAverage:h,forceAverage:l,directionVariance:b,forceVariance:u,shape:m};case Lr.RadialForce:return{id:n,name:i,type:e,position:a,forceAverage:l,forceVariance:u,shape:m};case Lr.Friction:return{id:n,name:i,type:e,friction:c,shape:m};case Lr.Gravity:return{id:n,name:i,type:e,position:a,radius:p,forceAverage:l,forceVariance:u,shape:m};case Lr.Path:return{id:n,name:i,type:e,nodes:d,shape:m};case Lr.AxisForce:return{id:n,name:i,type:e,position:a,direction:r,forceAverage:l,forceVariance:u,shape:m};case Lr.SpriteAnimation:default:return{id:n,name:i,type:e}}}(e,t))}function uc(e,t){return![Br.PathKill,Br.PathRadius,Br.PathStop].includes(t)||e.updaters.some((function(e){return e.type===Lr.Path}))}var dc,mc,hc,bc,fc,gc=[[["","list-actions",""]],"*"],vc=["[list-actions]","*"],yc=((dc=function(){function e(t){l(this,e),this.portalComponent=t,this.navigate=new ve.p}return u(e,[{key:"ngOnInit",value:function(){}},{key:"handleNavigateClick",value:function(){this.navigate.emit(),this.portalComponent.back()}}]),e}()).\u0275fac=function(e){return new(e||dc)(ve.Pb(Fr))},dc.\u0275cmp=ve.Jb({type:dc,selectors:[["app-portal-column"]],inputs:{label:"label"},outputs:{navigate:"navigate"},ngContentSelectors:vc,decls:11,vars:1,consts:[["column-label",""],["column-nav",""],["app-button","",3,"click"],["icon","arrow-left","size","lg"],["column-actions",""],["column-group-body",""]],template:function(e,t){1&e&&(ve.lc(gc),ve.Vb(0,"app-column"),ve.Vb(1,"div",0),ve.Pc(2),ve.Ub(),ve.Vb(3,"div",1),ve.Vb(4,"button",2),ve.cc("click",(function(){return t.handleNavigateClick()})),ve.Qb(5,"app-icon",3),ve.Ub(),ve.Ub(),ve.Vb(6,"div",4),ve.kc(7),ve.Ub(),ve.Vb(8,"app-column-group"),ve.Tb(9,5),ve.kc(10,1),ve.Sb(),ve.Ub(),ve.Ub()),2&e&&(ve.Db(2),ve.Rc(" ",t.label," "))},directives:[ko,Pe.a,yt.a,lo],styles:[""],changeDetection:0}),dc),xc=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Cc=((mc=function(){function e(t,n){l(this,e),this.store=t,this.formBuilder=n,this.ngUnsubscribe=new C.a,this.formGroup=this.formBuilder.group({colorEnabled:[!1],color:[""],alphaEnabled:[!1],alpha:[""],emitEnabled:[!1],emit:[""],spritesEnabled:[!1],spriteRows:[0],spriteCols:[0],spriteStartFrame:[0],spriteEndFrame:[0]}),this.setValues(Zr)}return u(e,[{key:"ngOnInit",value:function(){this.initFormListeners(),this.initParticleSystemListeners()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initFormListeners",value:function(){var e=this;this.formGroup.valueChanges.pipe(Object(Un.a)(125),Object(io.a)((function(t,n){var i=e.createParticleSystem(t),o=e.createParticleSystem(n);return Object(ce.isEqual)(i,o)})),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.setParticleSystem(t)}))}},{key:"initParticleSystemListeners",value:function(){var e=this;this.particleSystem$.pipe(Object(io.a)((function(e,t){return Object(ce.isEqual)(e,t)})),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.setValues(t)}))}},{key:"handleResetClick",value:function(){this.resetFormValues()}},{key:"setParticleSystem",value:function(e){var t=this.createParticleSystem(e);this.store.dispatch(new Wo.a.UpdateParticleSystem(t.id,t))}},{key:"setValues",value:function(e){this.setTextureValues(e.textures||[]),this.setSpriteValues(e)}},{key:"setTextureValues",value:function(e){var t=this;e.forEach((function(e){var n=e.src,i=e.applyTo,o=t.formGroup.get(i),a=t.formGroup.get(i+"Enabled");if(o){var r=!!n;o.setValue(n,{emitEvent:!1}),a.setValue(r,{emitEvent:!1})}}))}},{key:"resetFormValues",value:function(){this.formGroup.patchValue(Object.assign({colorEnabled:!1,color:"",alphaEnabled:!1,alpha:"",emitEnabled:!1,emit:"",spritesEnabled:!1},Zr))}},{key:"createParticleSystem",value:function(e){var t=e.spritesEnabled,n=e.spriteRows,i=e.spriteCols,o=e.spriteStartFrame,a=e.spriteEndFrame,r=this.store.selectSnapshot(Ko.a.getSelectedParticleSystem),c=this.getTextures(e);return cc(Object.assign(Object.assign({},r),{textures:c,spriteRows:t?n:void 0,spriteCols:t?i:void 0,spriteStartFrame:t?o:void 0,spriteEndFrame:t?a:void 0}))}},{key:"setSpriteValues",value:function(e){var t=e.spriteRows,n=e.spriteCols,i=e.spriteStartFrame,o=e.spriteEndFrame,a=[t,n,i,o].some((function(e){return!Object(ce.isNil)(e)})),r=Object.assign({spritesEnabled:a},cc({spriteRows:t,spriteCols:n,spriteStartFrame:i,spriteEndFrame:o}));this.formGroup.patchValue(r,{emitEvent:!1})}},{key:"getTextures",value:function(e){var t=e.colorEnabled,n=e.color,i=e.alphaEnabled,o=e.alpha,a=e.emitEnabled,r=e.emit,c=[];return t&&n&&c.push({src:n,applyTo:Ir.Color}),i&&o&&c.push({src:o,applyTo:Ir.Alpha}),a&&r&&c.push({src:r,applyTo:Ir.Emit}),c}}]),e}()).\u0275fac=function(e){return new(e||mc)(ve.Pb(y.h),ve.Pb(ae.f))},mc.\u0275cmp=ve.Jb({type:mc,selectors:[["app-edit-particle-sprites"]],decls:24,vars:11,consts:[["label","Sprites"],["list-actions",""],["app-button","",3,"matMenuTriggerFor"],["icon","ellipsis-v"],[3,"overlapTrigger"],["systemActions","matMenu"],["mat-menu-item","",3,"click"],[3,"formGroup"],["label","Color","toggleType","checkbox","formControlName","colorEnabled"],["type","text","formControlName","color","placeholder","path/of/texture",1,"input"],["label","Alpha","toggleType","checkbox","formControlName","alphaEnabled"],["type","text","formControlName","alpha","placeholder","path/of/texture",1,"input"],["label","Emit","toggleType","checkbox","formControlName","emitEnabled"],["type","text","formControlName","emit","placeholder","path/of/texture",1,"input"],["label","Sprite Sheet","toggleType","checkbox","formControlName","spritesEnabled"],["label","Rows"],["formControlName","spriteRows",3,"min","max"],["label","Columns"],["formControlName","spriteCols",3,"min","max"],["label","Start Frame"],["formControlName","spriteStartFrame",3,"min","max"],["label","End Frame"],["formControlName","spriteEndFrame",3,"min","max"]],template:function(e,t){if(1&e&&(ve.Vb(0,"app-portal-column",0),ve.Vb(1,"div",1),ve.Vb(2,"button",2),ve.Qb(3,"app-icon",3),ve.Ub(),ve.Vb(4,"mat-menu",4,5),ve.Vb(6,"button",6),ve.cc("click",(function(){return t.handleResetClick()})),ve.Pc(7,"Reset to default"),ve.Ub(),ve.Ub(),ve.Ub(),ve.Vb(8,"div",7),ve.Vb(9,"app-panel",8),ve.Qb(10,"input",9),ve.Ub(),ve.Vb(11,"app-panel",10),ve.Qb(12,"input",11),ve.Ub(),ve.Vb(13,"app-panel",12),ve.Qb(14,"input",13),ve.Ub(),ve.Vb(15,"app-panel",14),ve.Vb(16,"app-form-field",15),ve.Qb(17,"app-slider",16),ve.Ub(),ve.Vb(18,"app-form-field",17),ve.Qb(19,"app-slider",18),ve.Ub(),ve.Vb(20,"app-form-field",19),ve.Qb(21,"app-slider",20),ve.Ub(),ve.Vb(22,"app-form-field",21),ve.Qb(23,"app-slider",22),ve.Ub(),ve.Ub(),ve.Ub(),ve.Ub()),2&e){var n=ve.yc(5);ve.Db(2),ve.mc("matMenuTriggerFor",n),ve.Db(2),ve.mc("overlapTrigger",!0),ve.Db(4),ve.mc("formGroup",t.formGroup),ve.Db(9),ve.mc("min",1)("max",16),ve.Db(2),ve.mc("min",0)("max",16),ve.Db(2),ve.mc("min",0)("max",255),ve.Db(2),ve.mc("min",0)("max",255)}},directives:[yc,Pe.a,Ki.d,yt.a,Ki.a,Ki.b,ae.s,ae.j,Me.a,ae.r,ae.i,ae.c,Oe.a,To.a],styles:[""],changeDetection:0}),function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);a>3&&r&&Object.defineProperty(t,n,r)}([Object(y.e)(Ko.a.getSelectedParticleSystem),xc("design:type",_.a)],mc.prototype,"particleSystem$",void 0),mc),kc=o("JX91"),Pc=((hc=function(){function e(t){l(this,e),this.store=t}return u(e,[{key:"createParticleSystem",value:function(e){this.store.selectSnapshot(Ko.a.getParticleSystemsList);var t=Object.assign(Object.assign({},nc()),{id:Ho.a.idWithPrefix("system")});this.store.dispatch(new Wo.a.NewParticleSystem(t,e))}},{key:"duplicateParticleSystem",value:function(e,t){this.store.dispatch(new Wo.a.DuplicateParticleSystem(e,t))}},{key:"resetParticleSystem",value:function(e){var t=Object.assign(Object.assign({},nc()),{id:e});this.store.dispatch(new Wo.a.UpdateParticleSystem(e,t))}},{key:"toggleParticleSystemVisible",value:function(e,t){var n=this.isParticleSystemVisible(e,t);this.store.dispatch(new Wo.a.SetParticleSystemVisible(e,!n,t))}},{key:"isParticleSystemVisible",value:function(e,t){return this.store.selectSnapshot(Ko.a.getVisibleParticleSystesmForChapter(t)).includes(e)}},{key:"addChapterParticleSystem",value:function(e,t){this.store.dispatch(new Wo.a.AssignParticle(e,t))}},{key:"removeChapterParticleSystem",value:function(e,t){this.store.dispatch(new Wo.a.UnassignParticle(e,t))}},{key:"removeAllChapterParticleSystem",value:function(e){var t=this;this.store.selectSnapshot(Ko.a.particleSystemsForChapter(e)).forEach((function(n){t.removeChapterParticleSystem(n.id,e)}))}},{key:"createNewConstraint",value:function(e,t){var n=e.id,i=e.constraints;this.store.dispatch(new Wo.a.UpdateParticleSystem(n,Object.assign(Object.assign({},e),{constraints:[].concat(a(i),[Object.assign(Object.assign({},ic(t)),{id:Ho.a.idWithPrefix("constraint")})])})))}},{key:"duplicateConstraint",value:function(e,t){e.constraints=[].concat(a(e.constraints),[Object.assign(Object.assign({},sc(t.type,t)),{id:Ho.a.idWithPrefix("constraint")})]),this.store.dispatch(new Wo.a.UpdateParticleSystem(e.id,e)),this.store.dispatch(new Wo.a.SelectParticleConstraint(e.constraints.length-1))}},{key:"resetConstraint",value:function(e,t){var n=e.constraints[t],i=n.id,o=n.type;e.constraints[t]=Object.assign(Object.assign({},ic(o)),{id:i}),this.store.dispatch(new Wo.a.UpdateParticleSystem(e.id,e))}},{key:"resetConstraints",value:function(e){e.constraints=e.constraints.map((function(e){var t=e.id,n=e.type;return Object.assign(Object.assign({},ic(n)),{id:t})})),this.store.dispatch(new Wo.a.UpdateParticleSystem(e.id,e))}},{key:"removeConstraint",value:function(e,t){e.constraints.splice(t,1),this.store.dispatch(new Wo.a.UpdateParticleSystem(e.id,e)),this.store.dispatch(new Wo.a.SelectParticleConstraint(-1))}},{key:"createNewCreator",value:function(e,t){var n=e.id,i=e.creators;this.store.dispatch(new Wo.a.UpdateParticleSystem(n,Object.assign(Object.assign({},e),{creators:[].concat(a(i),[Object.assign(Object.assign({},oc(t)),{id:Ho.a.idWithPrefix("creator")})])})))}},{key:"duplicateCreator",value:function(e,t){e.creators=[].concat(a(e.creators),[Object.assign(Object.assign({},lc(t.type,t)),{id:Ho.a.idWithPrefix("creator")})]),this.store.dispatch(new Wo.a.UpdateParticleSystem(e.id,e)),this.store.dispatch(new Wo.a.SelectParticleCreator(e.creators.length-1))}},{key:"resetCreator",value:function(e,t){var n=e.creators[t],i=n.id,o=n.type;e.creators[t]=Object.assign(Object.assign({},oc(o)),{id:i}),this.store.dispatch(new Wo.a.UpdateParticleSystem(e.id,e))}},{key:"resetCreators",value:function(e){e.creators=e.creators.map((function(e){var t=e.id,n=e.type;return Object.assign(Object.assign({},oc(n)),{id:t})})),this.store.dispatch(new Wo.a.UpdateParticleSystem(e.id,e))}},{key:"removeCreator",value:function(e,t){e.creators.splice(t,1),this.store.dispatch(new Wo.a.UpdateParticleSystem(e.id,e)),this.store.dispatch(new Wo.a.SelectParticleConstraint(-1))}},{key:"createNewUpdater",value:function(e,t){var n=e.id,i=e.updaters;this.store.dispatch(new Wo.a.UpdateParticleSystem(n,Object.assign(Object.assign({},e),{updaters:[].concat(a(i),[Object.assign(Object.assign({},ac(t)),{id:Ho.a.idWithPrefix("updater")})])})))}},{key:"duplicateUpdater",value:function(e,t){e.updaters=[].concat(a(e.updaters),[Object.assign(Object.assign({},pc(t.type,t)),{id:Ho.a.idWithPrefix("updater")})]),this.store.dispatch(new Wo.a.UpdateParticleSystem(e.id,e)),this.store.dispatch(new Wo.a.SelectParticleUpdater(e.updaters.length-1))}},{key:"resetUpdater",value:function(e,t){var n=e.updaters[t],i=n.id,o=n.type;e.updaters[t]=Object.assign(Object.assign({},ac(o)),{id:i}),this.store.dispatch(new Wo.a.UpdateParticleSystem(e.id,e))}},{key:"resetUpdaters",value:function(e){e.updaters=e.updaters.map((function(e){var t=e.id,n=e.type;return Object.assign(Object.assign({},ac(n)),{id:t})})),this.store.dispatch(new Wo.a.UpdateParticleSystem(e.id,e))}},{key:"removeUpdater",value:function(e,t){e.updaters.splice(t,1),this.store.dispatch(new Wo.a.UpdateParticleSystem(e.id,e)),this.store.dispatch(new Wo.a.SelectParticleConstraint(-1))}}]),e}()).\u0275fac=function(e){return new(e||hc)(ve.Zb(y.h))},hc.\u0275prov=ve.Lb({token:hc,factory:hc.\u0275fac,providedIn:"root"}),hc),Oc=o("mWjH"),wc=((bc=function(t){e(o,t);var i=n(o);function o(e,t){var n;return l(this,o),(n=i.call(this)).formBuilder=e,n.changeRef=t,n.xmin=0,n.xmax=100,n.ymin=0,n.ymax=100,n.zmin=0,n.zmax=100,n.ngUnsubscribe=new C.a,n.formGroup=n.formBuilder.group({vec:n.formBuilder.array([0,0,0])}),n}return u(o,[{key:"ngOnInit",value:function(){var e=this;this.formGroup.valueChanges.pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.value=t.vec}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"setFormValues",value:function(e){this.formGroup.patchValue({vec:e}),this.changeRef.markForCheck()}}]),o}(Oc.a)).\u0275fac=function(e){return new(e||bc)(ve.Pb(ae.f),ve.Pb(ve.i))},bc.\u0275cmp=ve.Jb({type:bc,selectors:[["app-edit-particle-vector"]],inputs:{xmin:"xmin",xmax:"xmax",ymin:"ymin",ymax:"ymax",zmin:"zmin",zmax:"zmax"},features:[ve.Cb([{provide:ae.p,useExisting:Object(ve.W)((function(){return bc})),multi:!0}]),ve.Ab],decls:8,vars:13,consts:[[3,"formGroup"],["formArrayName","vec"],["label","X","display","inline"],[3,"min","max","step","formControlName"],["label","Y","display","inline"],["label","Z","display","inline"]],template:function(e,t){1&e&&(ve.Tb(0,0),ve.Tb(1,1),ve.Vb(2,"app-form-field",2),ve.Qb(3,"app-slider",3),ve.Ub(),ve.Vb(4,"app-form-field",4),ve.Qb(5,"app-slider",3),ve.Ub(),ve.Vb(6,"app-form-field",5),ve.Qb(7,"app-slider",3),ve.Ub(),ve.Sb(),ve.Sb()),2&e&&(ve.mc("formGroup",t.formGroup),ve.Db(3),ve.mc("min",t.xmin)("max",t.xmax)("step",.1)("formControlName",0),ve.Db(2),ve.mc("min",t.ymin)("max",t.ymax)("step",.1)("formControlName",1),ve.Db(2),ve.mc("min",t.zmin)("max",t.zmax)("step",.1)("formControlName",2))},directives:[ae.s,ae.j,ae.e,Oe.a,To.a,ae.r,ae.i],styles:[""],changeDetection:0}),bc),Sc=o("ZULQ"),_c=((fc=function(){function e(){l(this,e)}return u(e,[{key:"transform",value:function(e,t){return Sc.a.prettyPrint(e)}}]),e}()).\u0275fac=function(e){return new(e||fc)},fc.\u0275pipe=ve.Ob({name:"prettyPrint",type:fc,pure:!0}),fc),Mc=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Uc(e,t){if(1&e&&(ve.Vb(0,"option",17),ve.Pc(1),ve.hc(2,"prettyPrint"),ve.Ub()),2&e){var n=t.$implicit;ve.mc("value",n),ve.Db(1),ve.Rc(" ",ve.ic(2,2,n)," ")}}function Tc(e,t){1&e&&(ve.Tb(0),ve.Vb(1,"app-form-field",18),ve.Qb(2,"app-edit-particle-vector",19),ve.Ub(),ve.Vb(3,"app-form-field",20),ve.Qb(4,"app-slider",21),ve.Ub(),ve.Vb(5,"app-form-field",22),ve.Qb(6,"app-slider",23),ve.Ub(),ve.Vb(7,"app-form-field",24),ve.Qb(8,"app-slider",25),ve.Ub(),ve.Sb()),2&e&&(ve.Db(2),ve.mc("xmin",-10)("xmax",10)("ymin",-10)("ymax",10)("zmin",-10)("zmax",10),ve.Db(2),ve.mc("min",0)("max",10)("step",.1),ve.Db(2),ve.mc("min",0)("max",25),ve.Db(2),ve.mc("min",0)("max",25))}function Vc(e,t){1&e&&(ve.Tb(0),ve.Vb(1,"app-form-field",26),ve.Qb(2,"app-slider",27),ve.Ub(),ve.Vb(3,"app-form-field",28),ve.Qb(4,"app-slider",29),ve.Ub(),ve.Sb()),2&e&&(ve.Db(2),ve.mc("min",0)("max",10),ve.Db(2),ve.mc("min",0)("max",10))}function Dc(e,t){1&e&&(ve.Tb(0),ve.Vb(1,"app-form-field",26),ve.Qb(2,"app-slider",27),ve.Ub(),ve.Vb(3,"app-form-field",28),ve.Qb(4,"app-slider",29),ve.Ub(),ve.Sb()),2&e&&(ve.Db(2),ve.mc("min",-180)("max",180),ve.Db(2),ve.mc("min",-180)("max",180))}function Ec(e,t){1&e&&(ve.Tb(0),ve.Vb(1,"app-form-field",26),ve.Qb(2,"app-slider",27),ve.Ub(),ve.Vb(3,"app-form-field",28),ve.Qb(4,"app-slider",29),ve.Ub(),ve.Sb()),2&e&&(ve.Db(2),ve.mc("min",-720)("max",720),ve.Db(2),ve.mc("min",0)("max",720))}function jc(e,t){1&e&&(ve.Tb(0),ve.Vb(1,"app-form-field",26),ve.Qb(2,"app-slider",27),ve.Ub(),ve.Vb(3,"app-form-field",28),ve.Qb(4,"app-slider",29),ve.Ub(),ve.Sb()),2&e&&(ve.Db(2),ve.mc("min",0)("max",10),ve.Db(2),ve.mc("min",0)("max",10))}function Nc(e,t){1&e&&(ve.Tb(0),ve.Vb(1,"app-form-field",26),ve.Qb(2,"app-slider",27),ve.Ub(),ve.Vb(3,"app-form-field",28),ve.Qb(4,"app-slider",29),ve.Ub(),ve.Sb()),2&e&&(ve.Db(2),ve.mc("min",0)("max",10),ve.Db(2),ve.mc("min",0)("max",10))}function Rc(e,t){1&e&&(ve.Tb(0),ve.Vb(1,"app-form-field",30),ve.Qb(2,"app-edit-particle-vector",31),ve.Ub(),ve.Sb()),2&e&&(ve.Db(2),ve.mc("xmin",-10)("xmax",10)("ymin",-10)("ymax",10)("zmin",-10)("zmax",10))}function Ac(e,t){1&e&&(ve.Tb(0),ve.Vb(1,"app-form-field",22),ve.Qb(2,"app-slider",23),ve.Ub(),ve.Vb(3,"app-form-field",24),ve.Qb(4,"app-slider",25),ve.Ub(),ve.Sb()),2&e&&(ve.Db(2),ve.mc("min",0)("max",25),ve.Db(2),ve.mc("min",0)("max",25))}function Fc(e,t){1&e&&ve.Rb(0)}function Ic(e,t){if(1&e&&(ve.Tb(0),ve.Nc(1,Fc,1,0,"ng-container",32),ve.Sb()),2&e){ve.gc();var n=ve.yc(35);ve.Db(1),ve.mc("ngTemplateOutlet",n)}}function zc(e,t){1&e&&ve.Rb(0)}function Lc(e,t){if(1&e&&(ve.Tb(0),ve.Nc(1,zc,1,0,"ng-container",32),ve.Sb()),2&e){ve.gc();var n=ve.yc(35);ve.Db(1),ve.mc("ngTemplateOutlet",n)}}function Bc(e,t){1&e&&ve.Rb(0)}function Qc(e,t){if(1&e&&(ve.Tb(0),ve.Nc(1,Bc,1,0,"ng-container",32),ve.Sb()),2&e){ve.gc();var n=ve.yc(35);ve.Db(1),ve.mc("ngTemplateOutlet",n)}}function $c(e,t){1&e&&(ve.Vb(0,"app-form-field",33),ve.Qb(1,"app-edit-particle-vector",34),ve.Ub(),ve.Vb(2,"app-form-field",35),ve.Qb(3,"app-edit-particle-vector",36),ve.Ub(),ve.Vb(4,"app-form-field",37),ve.Qb(5,"app-edit-particle-vector",38),ve.Ub()),2&e&&(ve.Db(1),ve.mc("xmin",-10)("xmax",10)("ymin",-10)("ymax",10)("zmin",-10)("zmax",10),ve.Db(2),ve.mc("xmin",-180)("xmax",180)("ymin",-180)("ymax",180)("zmin",-180)("zmax",180),ve.Db(2),ve.mc("xmin",0)("xmax",20)("ymin",0)("ymax",20)("zmin",0)("zmax",20))}var qc,Gc,Hc,Wc=((Gc=function(){function e(t,n,i,o){l(this,e),this.store=t,this.formBuilder=n,this.portalComponent=i,this.particleSystemsService=o,this.creatorsEnum=zr,this.creators=Object.values(zr),this.ngUnsubscribe=new C.a,this.formGroup=this.formBuilder.group({id:[""],name:[""],type:[""],directionAverage:[[0,0,0]],forceAverage:[0],directionVariance:[0],forceVariance:[0],average:[0],variance:[0],position:[[0,0,0]],scale:[[0,0,0]],rotate:[[0,0,0]],translate:[[0,0,0]]})}return u(e,[{key:"ngOnInit",value:function(){this.initFormListeners(),this.initCreatorListeners()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initFormListeners",value:function(){var e=this;this.formGroup.valueChanges.pipe(Object(Un.a)(125),Object(io.a)((function(e,t){return Object(ce.isEqual)(e,t)})),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){var n=lc(t.type,t);e.updateSystem(n)}));var t=this.formGroup.get("type");t.valueChanges.pipe(Object(kc.a)(t.value),Object(z.a)(),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){var n=r(t,2),i=n[0],o=n[1],a=Wr[o],c=lc(i,e.formGroup.value),s=lc(o,Object.assign(Object.assign(Object.assign({},a),{position:c.translate,translate:c.position}),c));e.setValues(s,!1)}))}},{key:"initCreatorListeners",value:function(){var e=this;this.particleCreator$.pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.setValues(t,!1)}))}},{key:"setValues",value:function(e,t){this.formGroup.patchValue(Object.assign({},e),{emitEvent:t})}},{key:"handleDuplicateClick",value:function(){var e=this.store.selectSnapshot(Ko.a.getSelectedParticleSystem),t=this.store.selectSnapshot(Ko.a.getSelectedParticleCreator);this.particleSystemsService.duplicateCreator(e,t)}},{key:"handleResetClick",value:function(){var e=this.store.selectSnapshot(Ko.a.getSelectedParticleSystem),t=this.store.selectSnapshot(Ko.a.getSelectedParticleCreatorIndex);this.particleSystemsService.resetCreator(e,t)}},{key:"handleRemoveClick",value:function(){var e=this.store.selectSnapshot(Ko.a.getSelectedParticleSystem),t=this.store.selectSnapshot(Ko.a.getSelectedParticleCreatorIndex);this.particleSystemsService.removeCreator(e,t),this.portalComponent.back()}},{key:"updateSystem",value:function(e){var t=this.store.selectSnapshot(Ko.a.getSelectedParticleSystem),n=this.store.selectSnapshot(Ko.a.getSelectedParticleCreatorIndex);t.creators[n]=e,this.store.dispatch(new Wo.a.UpdateParticleSystem(t.id,t))}}]),e}()).\u0275fac=function(e){return new(e||Gc)(ve.Pb(y.h),ve.Pb(ae.f),ve.Pb(Fr),ve.Pb(Pc))},Gc.\u0275cmp=ve.Jb({type:Gc,selectors:[["app-edit-particle-creator"]],decls:36,vars:18,consts:[["label","Creator"],["list-actions",""],["app-button","",3,"matMenuTriggerFor"],["icon","ellipsis-v"],["actionsMenu","matMenu"],["mat-menu-item","",3,"click"],[3,"formGroup"],["label","Name"],["type","text","formControlName","name",1,"input"],["label","ID"],[1,"text-11"],["label","Type"],["formControlName","type",1,"input"],[3,"value",4,"ngFor","ngForOf"],[3,"ngSwitch"],[4,"ngSwitchCase"],["positionGroupTmp",""],[3,"value"],["label","Direction Average"],["formControlName","directionAverage",3,"xmin","xmax","ymin","ymax","zmin","zmax"],["label","Direction Variance"],["formControlName","directionVariance",3,"min","max","step"],["label","Force Average"],["formControlName","forceAverage",3,"min","max"],["label","Force Variance"],["formControlName","forceVariance",3,"min","max"],["label","Average"],["formControlName","average",3,"min","max"],["label","Variance"],["formControlName","variance",3,"min","max"],["label","Position"],["formControlName","position",3,"xmin","xmax","ymin","ymax","zmin","zmax"],[4,"ngTemplateOutlet"],["label","Translate"],["formControlName","translate",3,"xmin","xmax","ymin","ymax","zmin","zmax"],["label","Rotate"],["formControlName","rotate",3,"xmin","xmax","ymin","ymax","zmin","zmax"],["label","Scale"],["formControlName","scale",3,"xmin","xmax","ymin","ymax","zmin","zmax"]],template:function(e,t){if(1&e&&(ve.Vb(0,"app-portal-column",0),ve.Vb(1,"div",1),ve.Vb(2,"button",2),ve.Qb(3,"app-icon",3),ve.Ub(),ve.Vb(4,"mat-menu",null,4),ve.Vb(6,"button",5),ve.cc("click",(function(){return t.handleDuplicateClick()})),ve.Pc(7,"Duplicate"),ve.Ub(),ve.Vb(8,"button",5),ve.cc("click",(function(){return t.handleResetClick()})),ve.Pc(9,"Reset to default"),ve.Ub(),ve.Vb(10,"button",5),ve.cc("click",(function(){return t.handleRemoveClick()})),ve.Pc(11,"Remove"),ve.Ub(),ve.Ub(),ve.Ub(),ve.Vb(12,"app-panel",6),ve.Vb(13,"app-form-field",7),ve.Qb(14,"input",8),ve.Ub(),ve.Vb(15,"app-form-field",9),ve.Vb(16,"span",10),ve.Pc(17),ve.hc(18,"async"),ve.Ub(),ve.Ub(),ve.Vb(19,"app-form-field",11),ve.Vb(20,"select",12),ve.Nc(21,Uc,3,4,"option",13),ve.Ub(),ve.Ub(),ve.Tb(22,14),ve.Nc(23,Tc,9,13,"ng-container",15),ve.Nc(24,Vc,5,4,"ng-container",15),ve.Nc(25,Dc,5,4,"ng-container",15),ve.Nc(26,Ec,5,4,"ng-container",15),ve.Nc(27,jc,5,4,"ng-container",15),ve.Nc(28,Nc,5,4,"ng-container",15),ve.Nc(29,Rc,3,6,"ng-container",15),ve.Nc(30,Ac,5,4,"ng-container",15),ve.Nc(31,Ic,2,1,"ng-container",15),ve.Nc(32,Lc,2,1,"ng-container",15),ve.Nc(33,Qc,2,1,"ng-container",15),ve.Nc(34,$c,6,18,"ng-template",null,16,ve.Oc),ve.Sb(),ve.Ub(),ve.Ub()),2&e){var n,i=ve.yc(5);ve.Db(2),ve.mc("matMenuTriggerFor",i),ve.Db(10),ve.mc("formGroup",t.formGroup),ve.Db(5),ve.Qc(null==(n=ve.ic(18,16,t.particleCreator$))?null:n.id),ve.Db(4),ve.mc("ngForOf",t.creators),ve.Db(1),ve.mc("ngSwitch",t.formGroup.get("type").value),ve.Db(1),ve.mc("ngSwitchCase",t.creatorsEnum.DirectionalVelocity),ve.Db(1),ve.mc("ngSwitchCase",t.creatorsEnum.Lifetime),ve.Db(1),ve.mc("ngSwitchCase",t.creatorsEnum.RandomRotation),ve.Db(1),ve.mc("ngSwitchCase",t.creatorsEnum.RandomRotationSpeed),ve.Db(1),ve.mc("ngSwitchCase",t.creatorsEnum.RandomScale),ve.Db(1),ve.mc("ngSwitchCase",t.creatorsEnum.SpriteAnimationDuration),ve.Db(1),ve.mc("ngSwitchCase",t.creatorsEnum.PointPosition),ve.Db(1),ve.mc("ngSwitchCase",t.creatorsEnum.RandomVelocity),ve.Db(1),ve.mc("ngSwitchCase",t.creatorsEnum.SpherePosition),ve.Db(1),ve.mc("ngSwitchCase",t.creatorsEnum.CylinderPosition),ve.Db(1),ve.mc("ngSwitchCase",t.creatorsEnum.CubePosition)}},directives:[yc,Pe.a,Ki.d,yt.a,Ki.a,Ki.b,Me.a,ae.s,ae.j,Oe.a,ae.c,ae.r,ae.i,ae.B,f.o,f.r,f.s,ae.v,ae.D,wc,To.a,f.u],pipes:[f.b,_c],styles:[""],changeDetection:0}),function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);a>3&&r&&Object.defineProperty(t,n,r)}([Object(y.e)(Ko.a.getSelectedParticleCreator),Mc("design:type",_.a)],Gc.prototype,"particleCreator$",void 0),Gc),Kc=((qc=function(){function e(t){l(this,e),this.portalComponent=t,this.itemClick=new ve.p}return u(e,[{key:"onClick",value:function(){this.itemClick.next(this.portalComponent)}}]),e}()).\u0275fac=function(e){return new(e||qc)(ve.Pb(Fr))},qc.\u0275dir=ve.Kb({type:qc,selectors:[["","appPortalItem",""]],hostBindings:function(e,t){1&e&&ve.cc("click",(function(){return t.onClick()}))},outputs:{itemClick:"itemClick"}}),qc),Jc=[[["","item-actions",""]]],Xc=["[item-actions]"],Zc=((Hc=function(){function e(){l(this,e),this.active=!0,this.itemClick=new ve.p}return u(e,[{key:"ngOnInit",value:function(){}},{key:"handleItemClick",value:function(e){this.itemClick.next(e)}}]),e}()).\u0275fac=function(e){return new(e||Hc)},Hc.\u0275cmp=ve.Jb({type:Hc,selectors:[["app-portal-item"]],inputs:{label:"label",active:"active",hint:"hint"},outputs:{itemClick:"itemClick"},ngContentSelectors:Xc,decls:4,vars:5,consts:[["appPortalItem","",1,"portal-item",3,"itemClick"],["toggleType","arrow",3,"toggleable","open","active","label","hint"],["panel-actions",""]],template:function(e,t){1&e&&(ve.lc(Jc),ve.Vb(0,"div",0),ve.cc("itemClick",(function(e){return t.handleItemClick(e)})),ve.Vb(1,"app-panel",1),ve.Vb(2,"div",2),ve.kc(3),ve.Ub(),ve.Ub(),ve.Ub()),2&e&&(ve.Db(1),ve.mc("toggleable",!1)("open",!1)("active",t.active)("label",t.label)("hint",t.hint))},directives:[Kc,Me.a],styles:[""],changeDetection:0}),Hc);function Yc(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"app-portal-item",17),ve.cc("itemClick",(function(){ve.Cc(n);var e=t.$implicit,i=t.index;return ve.gc(2).handleItemClicked(e,i)})),ve.Vb(1,"div",18),ve.Vb(2,"button",19),ve.Qb(3,"app-icon",3),ve.Ub(),ve.Vb(4,"mat-menu",null,20),ve.Vb(6,"button",6),ve.cc("click",(function(){ve.Cc(n);var e=t.$implicit;return ve.gc(2).handleDuplicateClick(e)})),ve.Pc(7,"Duplicate"),ve.Ub(),ve.Vb(8,"button",6),ve.cc("click",(function(){ve.Cc(n);var e=t.$implicit,i=t.index;return ve.gc(2).handleResetClick(e,i)})),ve.Pc(9,"Reset"),ve.Ub(),ve.Vb(10,"button",6),ve.cc("click",(function(){ve.Cc(n);var e=t.$implicit,i=t.index;return ve.gc(2).handleRemoveClick(e,i)})),ve.Pc(11,"Remove"),ve.Ub(),ve.Ub(),ve.Ub(),ve.Ub()}if(2&e){var i=t.$implicit,o=ve.yc(5),a=ve.gc(2);ve.mc("label",a.getComponentLabel(i))("hint",i.type),ve.Db(2),ve.mc("matMenuTriggerFor",o)}}function es(e,t){if(1&e&&(ve.Tb(0),ve.Nc(1,Yc,12,3,"app-portal-item",16),ve.Sb()),2&e){var n=ve.gc();ve.Db(1),ve.mc("ngForOf",n.items)}}function ts(e,t){if(1&e&&(ve.Vb(0,"div",21),ve.Pc(1),ve.Ub()),2&e){var n=ve.gc();ve.Db(1),ve.Rc(" There are no ",n.type,"s in this chapter. ")}}function ns(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"button",22),ve.cc("click",(function(){ve.Cc(n);var e=t.$implicit;return ve.gc().handleAddClick(e)})),ve.Pc(1),ve.hc(2,"prettyPrint"),ve.Ub()}if(2&e){var i=t.$implicit,o=ve.gc();ve.mc("disabled",!o.isTypeAvailable(i)),ve.Db(1),ve.Rc(" ",ve.ic(2,2,i)," ")}}var is,os,as,rs,cs,ss,ls=function(){return!0},ps=((is=function(){function e(t,n){l(this,e),this.dialogService=t,this.particleSystemsService=n,this.types=[],this.items=[],this.isTypeAvailable=ls,this.itemClick=new ve.p,this.addClick=new ve.p,this.duplicateClick=new ve.p,this.removeClick=new ve.p,this.resetAllClick=new ve.p,this.resetClick=new ve.p,this.removeAllClick=new ve.p,this.ngUnsubscribe=new C.a}return u(e,[{key:"ngOnInit",value:function(){}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"handleItemClicked",value:function(e,t){this.itemClick.next(t)}},{key:"handleAddClick",value:function(e){this.addClick.next(e)}},{key:"handleDuplicateClick",value:function(e){this.duplicateClick.next(e)}},{key:"handleResetClick",value:function(e,t){this.resetClick.next(t)}},{key:"handleRemoveClick",value:function(e,t){this.removeClick.next(t)}},{key:"handleResetAllClick",value:function(){var e=this;this.dialogService.openConfirmDialog({data:{titleText:"Reset ".concat(this.type,"s"),bodyText:"Would you like to reset all ".concat(this.type,"s?")}}).afterClosed().pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){t&&e.resetAllClick.next()}))}},{key:"handleRemoveAllClick",value:function(){var e=this;this.dialogService.openConfirmDialog({data:{titleText:"Remove All ".concat(this.type,"s"),bodyText:"Would you like to remove all ".concat(this.type,"s?")}}).afterClosed().pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){t&&e.removeAllClick.next()}))}},{key:"getComponentLabel",value:function(e){return e.name?"**".concat(e.name,"**\n\n").concat(e.id):e.id}}]),e}()).\u0275fac=function(e){return new(e||is)(ve.Pb(Bi.a),ve.Pb(Pc))},is.\u0275cmp=ve.Jb({type:is,selectors:[["app-edit-particle-list"]],inputs:{label:"label",type:"type",types:"types",items:"items",isTypeAvailable:"isTypeAvailable"},outputs:{itemClick:"itemClick",addClick:"addClick",duplicateClick:"duplicateClick",removeClick:"removeClick",resetAllClick:"resetAllClick",resetClick:"resetClick",removeAllClick:"removeAllClick"},decls:23,vars:9,consts:[[3,"label"],["list-actions",""],["app-button","",3,"matMenuTriggerFor"],["icon","ellipsis-v"],["actionsMenu","matMenu"],["mat-menu-item","",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],[1,"list"],[1,"list__content"],[4,"ngIf"],[1,"flex","flex-column","items-center","mv-2"],["class","list__message text-12 text-center mv-4",4,"ngIf"],["app-button","","buttonType","outline",3,"matMenuTriggerFor"],["icon","angle-down"],["typesMenu","matMenu"],["mat-menu-item","",3,"disabled","click",4,"ngFor","ngForOf"],[3,"label","hint","itemClick",4,"ngFor","ngForOf"],[3,"label","hint","itemClick"],["item-actions",""],["app-button","","buttonSize","xsmall",3,"matMenuTriggerFor"],["itemActionsMenu","matMenu"],[1,"list__message","text-12","text-center","mv-4"],["mat-menu-item","",3,"disabled","click"]],template:function(e,t){if(1&e&&(ve.Vb(0,"app-portal-column",0),ve.Vb(1,"div",1),ve.Vb(2,"button",2),ve.Qb(3,"app-icon",3),ve.Ub(),ve.Vb(4,"mat-menu",null,4),ve.Vb(6,"button",5),ve.Pc(7,"Add New"),ve.Ub(),ve.Vb(8,"button",6),ve.cc("click",(function(){return t.handleResetAllClick()})),ve.Pc(9,"Reset to defaults"),ve.Ub(),ve.Vb(10,"button",6),ve.cc("click",(function(){return t.handleRemoveAllClick()})),ve.Pc(11),ve.Ub(),ve.Ub(),ve.Ub(),ve.Vb(12,"div",7),ve.Vb(13,"div",8),ve.Nc(14,es,2,1,"ng-container",9),ve.Vb(15,"div",10),ve.Nc(16,ts,2,1,"div",11),ve.Vb(17,"button",12),ve.Pc(18),ve.Qb(19,"app-icon",13),ve.Ub(),ve.Ub(),ve.Vb(20,"mat-menu",null,14),ve.Nc(22,ns,3,4,"button",15),ve.Ub(),ve.Ub(),ve.Ub(),ve.Ub()),2&e){var n=ve.yc(5),i=ve.yc(21);ve.mc("label",t.label),ve.Db(2),ve.mc("matMenuTriggerFor",n),ve.Db(4),ve.mc("matMenuTriggerFor",i),ve.Db(5),ve.Rc("Remove all ",t.type,"s"),ve.Db(3),ve.mc("ngIf",t.items.length>0),ve.Db(2),ve.mc("ngIf",0===t.items.length),ve.Db(1),ve.mc("matMenuTriggerFor",i),ve.Db(1),ve.Rc(" Add ",t.type," "),ve.Db(4),ve.mc("ngForOf",t.types)}},directives:[yc,Pe.a,Ki.d,yt.a,Ki.a,Ki.b,f.p,f.o,Zc],pipes:[_c],styles:[".list[_ngcontent-%COMP%]{height:100%}.list__content[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column}.list__message[_ngcontent-%COMP%]{color:#61779e}"],changeDetection:0}),is),us=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},ds=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},ms=function(){return[]},hs=((as=function(){function e(t,n,i){l(this,e),this.store=t,this.particleSystemsService=n,this.portalComponent=i,this.creatorTypes=Object.values(zr),this.ngUnsubscribe=new C.a}return u(e,[{key:"ngOnInit",value:function(){}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"selectClick",value:function(e){this.selectItem(e),e>-1&&this.portalComponent.loadComponent(Wc)}},{key:"handleAddClick",value:function(e){this.createNew(e)}},{key:"handleDuplicateClick",value:function(e){var t=this.store.selectSnapshot(Ko.a.getSelectedParticleSystem);this.particleSystemsService.duplicateCreator(t,e)}},{key:"handleRemoveClick",value:function(e){this.delete(e)}},{key:"handleResetClick",value:function(e){this.resetDefault(e)}},{key:"handleResetAllClick",value:function(){this.resetDefaults()}},{key:"handleRemoveAllClick",value:function(){this.deleteAll()}},{key:"selectItem",value:function(e){this.store.dispatch(new Wo.a.SelectParticleCreator(e))}},{key:"createNew",value:function(e){var t=this.store.selectSnapshot(Ko.a.getSelectedParticleSystem);this.particleSystemsService.createNewCreator(t,e)}},{key:"resetDefault",value:function(e){var t=this.store.selectSnapshot(Ko.a.getSelectedParticleSystem);this.particleSystemsService.resetCreator(t,e)}},{key:"resetDefaults",value:function(){var e=this.store.selectSnapshot(Ko.a.getSelectedParticleSystem);this.particleSystemsService.resetCreators(e)}},{key:"delete",value:function(e){var t=this.store.selectSnapshot(Ko.a.getSelectedParticleSystem);t.creators=t.creators.filter((function(t,n){return n!==e})),this.store.dispatch(new Wo.a.UpdateParticleSystem(t.id,t)),this.selectItem(-1)}},{key:"deleteAll",value:function(){var e=this.store.selectSnapshot(Ko.a.getSelectedParticleSystem);this.store.dispatch(new Wo.a.UpdateParticleSystem(e.id,Object.assign(Object.assign({},e),{creators:[]})))}}]),e}()).\u0275fac=function(e){return new(e||as)(ve.Pb(y.h),ve.Pb(Pc),ve.Pb(Fr))},as.\u0275cmp=ve.Jb({type:as,selectors:[["app-edit-particle-creator-list"]],decls:2,vars:5,consts:[["label","Creators","type","creator",3,"types","items","itemClick","addClick","removeClick","duplicateClick","resetClick","resetAllClick","removeAllClick"]],template:function(e,t){var n;(1&e&&(ve.Vb(0,"app-edit-particle-list",0),ve.cc("itemClick",(function(e){return t.selectClick(e)}))("addClick",(function(e){return t.handleAddClick(e)}))("removeClick",(function(e){return t.handleRemoveClick(e)}))("duplicateClick",(function(e){return t.handleDuplicateClick(e)}))("resetClick",(function(e){return t.handleResetClick(e)}))("resetAllClick",(function(){return t.handleResetAllClick()}))("removeAllClick",(function(){return t.handleRemoveAllClick()})),ve.hc(1,"async"),ve.Ub()),2&e)&&ve.mc("types",t.creatorTypes)("items",(null==(n=ve.ic(1,2,t.particleSystem$))?null:n.creators)||ve.oc(4,ms))},directives:[ps],pipes:[f.b],styles:[""],changeDetection:0}),us([Object(y.e)(Ko.a.getSelectedParticleSystemId),ds("design:type",_.a)],as.prototype,"particleSystemId$",void 0),us([Object(y.e)(Ko.a.getSelectedParticleSystem),ds("design:type",_.a)],as.prototype,"particleSystem$",void 0),as),bs=((os=function(){function e(t,n){l(this,e),this.formBuilder=t,this.store=n,this.ngUnsubscribe=new C.a,this.initForm()}return u(e,[{key:"ngOnInit",value:function(){this.initFormListeners(),this.initParticleSystemListeners()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initForm",value:function(){this.formGroup=this.formBuilder.group({layer:[1],depthMask:[!1],roundPoints:[!1],perspectivePoints:[!1],addAlpha:[!1]}),this.setDefaults(!1)}},{key:"initFormListeners",value:function(){var e=this;this.formGroup.valueChanges.pipe(Object(Un.a)(125),Object(io.a)((function(e,t){return Object(ce.isEqual)(e,t)})),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.setParticleSystem(t)}))}},{key:"initParticleSystemListeners",value:function(){var e=this;this.store.select(Ko.a.getSelectedParticleSystem).pipe(Object(io.a)((function(e,t){return Object(ce.isEqual)(e,t)})),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.setValues(t.properties,!1)}))}},{key:"handleResetClick",value:function(){this.setDefaults(!0)}},{key:"setValues",value:function(e,t){this.formGroup.patchValue(Object.assign({},e),{emitEvent:t})}},{key:"setParticleSystem",value:function(e){var t=this.store.selectSnapshot(Ko.a.getSelectedParticleSystem),n=Object.assign(Object.assign({},t),{properties:e});this.store.dispatch(new Wo.a.UpdateParticleSystem(n.id,n))}},{key:"setDefaults",value:function(e){this.setValues(Yr,e)}}]),e}()).\u0275fac=function(e){return new(e||os)(ve.Pb(ae.f),ve.Pb(y.h))},os.\u0275cmp=ve.Jb({type:os,selectors:[["app-edit-particle-properties"]],decls:23,vars:5,consts:[["label","Properties"],["list-actions",""],["app-button","",3,"matMenuTriggerFor"],["icon","ellipsis-v"],[3,"overlapTrigger"],["systemActions","matMenu"],["mat-menu-item","",3,"click"],[1,"text-12",3,"formGroup"],["label","Layer"],["formControlName","layer",3,"min","max"],["formControlName","depthMask"],["formControlName","roundPoints"],["formControlName","perspectivePoints"],["formControlName","addAlpha"]],template:function(e,t){if(1&e&&(ve.Vb(0,"app-portal-column",0),ve.Vb(1,"div",1),ve.Vb(2,"button",2),ve.Qb(3,"app-icon",3),ve.Ub(),ve.Vb(4,"mat-menu",4,5),ve.Vb(6,"button",6),ve.cc("click",(function(){return t.handleResetClick()})),ve.Pc(7,"Reset to default"),ve.Ub(),ve.Ub(),ve.Ub(),ve.Vb(8,"app-panel",7),ve.Vb(9,"app-form-field",8),ve.Qb(10,"app-slider",9),ve.Ub(),ve.Vb(11,"app-form-field"),ve.Vb(12,"mat-checkbox",10),ve.Pc(13,"Depth Mask"),ve.Ub(),ve.Ub(),ve.Vb(14,"app-form-field"),ve.Vb(15,"mat-checkbox",11),ve.Pc(16,"Round Points"),ve.Ub(),ve.Ub(),ve.Vb(17,"app-form-field"),ve.Vb(18,"mat-checkbox",12),ve.Pc(19,"Perspective Points"),ve.Ub(),ve.Ub(),ve.Vb(20,"app-form-field"),ve.Vb(21,"mat-checkbox",13),ve.Pc(22,"Add Alpha"),ve.Ub(),ve.Ub(),ve.Ub(),ve.Ub()),2&e){var n=ve.yc(5);ve.Db(2),ve.mc("matMenuTriggerFor",n),ve.Db(2),ve.mc("overlapTrigger",!0),ve.Db(4),ve.mc("formGroup",t.formGroup),ve.Db(2),ve.mc("min",0)("max",1e3)}},directives:[yc,Pe.a,Ki.d,yt.a,Ki.a,Ki.b,Me.a,ae.s,ae.j,Oe.a,To.a,ae.r,ae.i,Ue.a],styles:[""],changeDetection:0}),os),fs=o("jaxi"),gs=((rs=function(t){e(o,t);var i=n(o);function o(){var e;return l(this,o),(e=i.apply(this,arguments)).shapeTypesEnum=Qr,e}return u(o,[{key:"ngOnInit",value:function(){}}]),o}(Oc.b)).\u0275fac=function(e){return vs(e||rs)},rs.\u0275cmp=ve.Jb({type:rs,selectors:[["app-edit-particle-shape-selector"]],features:[ve.Cb([{provide:ae.p,useExisting:Object(ve.W)((function(){return rs})),multi:!0}]),ve.Ab],decls:9,vars:13,consts:[[3,"formControl"],[3,"value","matTooltip"],["icon","circle"],["icon","diamond"],["icon","cube"],["icon","rectangle-portrait"]],template:function(e,t){1&e&&(ve.Vb(0,"mat-button-toggle-group",0),ve.Vb(1,"mat-button-toggle",1),ve.Qb(2,"app-icon",2),ve.Ub(),ve.Vb(3,"mat-button-toggle",1),ve.Qb(4,"app-icon",3),ve.Ub(),ve.Vb(5,"mat-button-toggle",1),ve.Qb(6,"app-icon",4),ve.Ub(),ve.Vb(7,"mat-button-toggle",1),ve.Qb(8,"app-icon",5),ve.Ub(),ve.Ub()),2&e&&(ve.mc("formControl",t.control),ve.Db(1),ve.mc("value",t.shapeTypesEnum.Sphere)("matTooltip",t.shapeTypesEnum.Sphere),ve.Eb("aria-label",t.shapeTypesEnum.Sphere),ve.Db(2),ve.mc("value",t.shapeTypesEnum.Plane)("matTooltip",t.shapeTypesEnum.Plane),ve.Eb("aria-label",t.shapeTypesEnum.Plane),ve.Db(2),ve.mc("value",t.shapeTypesEnum.Cube)("matTooltip",t.shapeTypesEnum.Cube),ve.Eb("aria-label",t.shapeTypesEnum.Cube),ve.Db(2),ve.mc("value",t.shapeTypesEnum.Cylinder)("matTooltip",t.shapeTypesEnum.Cylinder),ve.Eb("aria-label",t.shapeTypesEnum.Cylinder))},directives:[fs.b,ae.r,ae.h,fs.a,Ct.c,yt.a],styles:[""],changeDetection:0}),rs),vs=ve.Xb(gs),ys=((cs=function(t){e(o,t);var i=n(o);function o(){var e;return l(this,o),(e=i.apply(this,arguments)).shapeDirectionEnum=$r,e}return u(o,[{key:"ngOnInit",value:function(){}}]),o}(Oc.b)).\u0275fac=function(e){return xs(e||cs)},cs.\u0275cmp=ve.Jb({type:cs,selectors:[["app-edit-particle-direction-selector"]],features:[ve.Cb([{provide:ae.p,useExisting:Object(ve.W)((function(){return cs})),multi:!0}]),ve.Ab],decls:7,vars:7,consts:[[3,"formControl"],[3,"value","matTooltip"],[1,"text-uppercase"]],template:function(e,t){1&e&&(ve.Vb(0,"mat-button-toggle-group",0),ve.Vb(1,"mat-button-toggle",1),ve.Vb(2,"div",2),ve.Pc(3,"In"),ve.Ub(),ve.Ub(),ve.Vb(4,"mat-button-toggle",1),ve.Vb(5,"div",2),ve.Pc(6,"Out"),ve.Ub(),ve.Ub(),ve.Ub()),2&e&&(ve.mc("formControl",t.control),ve.Db(1),ve.mc("value",t.shapeDirectionEnum.In)("matTooltip",t.shapeDirectionEnum.In),ve.Eb("aria-label",t.shapeDirectionEnum.In),ve.Db(3),ve.mc("value",t.shapeDirectionEnum.Out)("matTooltip",t.shapeDirectionEnum.Out),ve.Eb("aria-label",t.shapeDirectionEnum.Out))},directives:[fs.b,ae.r,ae.h,fs.a,Ct.c],styles:[""],changeDetection:0}),cs),xs=ve.Xb(ys),Cs=((ss=function(t){e(o,t);var i=n(o);function o(e,t){var n;return l(this,o),(n=i.call(this)).formBuilder=e,n.changeRef=t,n.ngUnsubscribe=new C.a,n.formGroup=n.formBuilder.group({type:[Qr.Cube],scale:[[0,0,0]],rotate:[[0,0,0]],translate:[[0,0,0]],direction:[$r.In]}),n}return u(o,[{key:"ngOnInit",value:function(){var e=this;this.formGroup.valueChanges.pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.value=t}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"setFormValues",value:function(e){this.formGroup.patchValue(e),this.changeRef.markForCheck()}}]),o}(Oc.a)).\u0275fac=function(e){return new(e||ss)(ve.Pb(ae.f),ve.Pb(ve.i))},ss.\u0275cmp=ve.Jb({type:ss,selectors:[["app-edit-particle-shape"]],features:[ve.Cb([{provide:ae.p,useExisting:Object(ve.W)((function(){return ss})),multi:!0}]),ve.Ab],decls:11,vars:19,consts:[[3,"formGroup"],["label","Shape Type"],["formControlName","type"],["label","Direction Selector"],["formControlName","direction"],["label","Translate"],["formControlName","translate",3,"xmin","xmax","ymin","ymax","zmin","zmax"],["label","Rotate"],["formControlName","rotate",3,"xmin","xmax","ymin","ymax","zmin","zmax"],["label","Scale"],["formControlName","scale",3,"xmin","xmax","ymin","ymax","zmin","zmax"]],template:function(e,t){1&e&&(ve.Tb(0,0),ve.Vb(1,"app-form-field",1),ve.Qb(2,"app-edit-particle-shape-selector",2),ve.Ub(),ve.Vb(3,"app-form-field",3),ve.Qb(4,"app-edit-particle-direction-selector",4),ve.Ub(),ve.Vb(5,"app-form-field",5),ve.Qb(6,"app-edit-particle-vector",6),ve.Ub(),ve.Vb(7,"app-form-field",7),ve.Qb(8,"app-edit-particle-vector",8),ve.Ub(),ve.Vb(9,"app-form-field",9),ve.Qb(10,"app-edit-particle-vector",10),ve.Ub(),ve.Sb()),2&e&&(ve.mc("formGroup",t.formGroup),ve.Db(6),ve.mc("xmin",-10)("xmax",10)("ymin",-10)("ymax",10)("zmin",-10)("zmax",10),ve.Db(2),ve.mc("xmin",-180)("xmax",180)("ymin",-180)("ymax",180)("zmin",-180)("zmax",180),ve.Db(2),ve.mc("xmin",0)("xmax",20)("ymin",0)("ymax",20)("zmin",0)("zmax",20))},directives:[ae.s,ae.j,Oe.a,gs,ae.r,ae.i,ys,wc],styles:[""],changeDetection:0}),ss),ks=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Ps(e,t){if(1&e&&(ve.Vb(0,"option",15),ve.Pc(1),ve.hc(2,"prettyPrint"),ve.Ub()),2&e){var n=t.$implicit;ve.mc("value",n),ve.Db(1),ve.Rc(" ",ve.ic(2,2,n)," ")}}function Os(e,t){1&e&&(ve.Tb(0),ve.Vb(1,"app-form-field",16),ve.Vb(2,"mat-checkbox",17),ve.Pc(3,"Trap Shape"),ve.Ub(),ve.Ub(),ve.Qb(4,"app-edit-particle-shape",18),ve.Sb())}var ws,Ss,_s=((ws=function(){function e(t,n,i,o){l(this,e),this.store=t,this.formBuilder=n,this.portalComponent=i,this.particleSystemsService=o,this.constraintsEnum=Br,this.shapeTypesEnum=Qr,this.availableConstraints=Object.values(Br),this.ngUnsubscribe=new C.a,this.formGroup=this.formBuilder.group({id:[""],name:[""],type:[""],trap:[!1],shape:[]})}return u(e,[{key:"isShapeType",get:function(){var e=this.formGroup.value.type;return Gr.includes(e)}},{key:"ngOnInit",value:function(){this.initFormListeners(),this.initConstraintListeners()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initFormListeners",value:function(){var e=this;this.formGroup.valueChanges.pipe(Object(Un.a)(125),Object(io.a)((function(e,t){return Object(ce.isEqual)(e,t)})),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){var n=sc(t.type,t);e.updateSystem(n)}));var t=this.formGroup.get("type");t.valueChanges.pipe(Object(kc.a)(t.value),Object(z.a)(),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){var n=r(t,2),i=n[0],o=n[1],a=Hr[o],c=sc(i,e.formGroup.value),s=sc(o,Object.assign(Object.assign({},a),c));e.setValues(s,!1)}))}},{key:"initConstraintListeners",value:function(){var e=this;this.particleConstraint$.pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){var n=e.store.selectSnapshot(Ko.a.getSelectedParticleSystem);e.availableConstraints=Object.values(Br).filter((function(e){return uc(n,e)})),e.setValues(t,!1)}))}},{key:"setValues",value:function(e,t){this.formGroup.patchValue(Object.assign({},e),{emitEvent:t})}},{key:"handleDuplicateClick",value:function(){var e=this.store.selectSnapshot(Ko.a.getSelectedParticleSystem),t=this.store.selectSnapshot(Ko.a.getSelectedParticleConstraint);this.particleSystemsService.duplicateConstraint(e,t)}},{key:"handleResetClick",value:function(){var e=this.store.selectSnapshot(Ko.a.getSelectedParticleSystem),t=this.store.selectSnapshot(Ko.a.getSelectedParticleConstraintIndex);this.particleSystemsService.resetConstraint(e,t)}},{key:"handleRemoveClick",value:function(){var e=this.store.selectSnapshot(Ko.a.getSelectedParticleSystem),t=this.store.selectSnapshot(Ko.a.getSelectedParticleConstraintIndex);this.particleSystemsService.removeConstraint(e,t),this.portalComponent.back()}},{key:"updateSystem",value:function(e){var t=this.store.selectSnapshot(Ko.a.getSelectedParticleSystem),n=this.store.selectSnapshot(Ko.a.getSelectedParticleConstraintIndex);t.constraints[n]=e,this.store.dispatch(new Wo.a.UpdateParticleSystem(t.id,t))}}]),e}()).\u0275fac=function(e){return new(e||ws)(ve.Pb(y.h),ve.Pb(ae.f),ve.Pb(Fr),ve.Pb(Pc))},ws.\u0275cmp=ve.Jb({type:ws,selectors:[["app-edit-particle-constraint"]],decls:23,vars:7,consts:[["label","Constraint"],["list-actions",""],["app-button","",3,"matMenuTriggerFor"],["icon","ellipsis-v"],["actionsMenu","matMenu"],["mat-menu-item","",3,"click"],[3,"formGroup"],["label","Name"],["type","text","formControlName","name",1,"input"],["label","ID"],[1,"text-11"],["label","Type"],["formControlName","type",1,"input"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"value"],["label","Trap"],["formControlName","trap",1,"text-12"],["formControlName","shape"]],template:function(e,t){if(1&e&&(ve.Vb(0,"app-portal-column",0),ve.Vb(1,"div",1),ve.Vb(2,"button",2),ve.Qb(3,"app-icon",3),ve.Ub(),ve.Vb(4,"mat-menu",null,4),ve.Vb(6,"button",5),ve.cc("click",(function(){return t.handleDuplicateClick()})),ve.Pc(7,"Duplicate"),ve.Ub(),ve.Vb(8,"button",5),ve.cc("click",(function(){return t.handleResetClick()})),ve.Pc(9,"Reset to default"),ve.Ub(),ve.Vb(10,"button",5),ve.cc("click",(function(){return t.handleRemoveClick()})),ve.Pc(11,"Remove"),ve.Ub(),ve.Ub(),ve.Ub(),ve.Vb(12,"app-panel",6),ve.Vb(13,"app-form-field",7),ve.Qb(14,"input",8),ve.Ub(),ve.Vb(15,"app-form-field",9),ve.Vb(16,"span",10),ve.Pc(17),ve.hc(18,"async"),ve.Ub(),ve.Ub(),ve.Vb(19,"app-form-field",11),ve.Vb(20,"select",12),ve.Nc(21,Ps,3,4,"option",13),ve.Ub(),ve.Ub(),ve.Nc(22,Os,5,0,"ng-container",14),ve.Ub(),ve.Ub()),2&e){var n,i=ve.yc(5);ve.Db(2),ve.mc("matMenuTriggerFor",i),ve.Db(10),ve.mc("formGroup",t.formGroup),ve.Db(5),ve.Qc(null==(n=ve.ic(18,5,t.particleConstraint$))?null:n.id),ve.Db(4),ve.mc("ngForOf",t.availableConstraints),ve.Db(1),ve.mc("ngIf",t.isShapeType)}},directives:[yc,Pe.a,Ki.d,yt.a,Ki.a,Ki.b,Me.a,ae.s,ae.j,Oe.a,ae.c,ae.r,ae.i,ae.B,f.o,f.p,ae.v,ae.D,Ue.a,Cs],pipes:[f.b,_c],styles:[""],changeDetection:0}),function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);a>3&&r&&Object.defineProperty(t,n,r)}([Object(y.e)(Ko.a.getSelectedParticleConstraint),ks("design:type",_.a)],ws.prototype,"particleConstraint$",void 0),ws),Ms=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},Us=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Ts=function(){return[]},Vs=((Ss=function(){function e(t,n,i){l(this,e),this.store=t,this.particleSystemsService=n,this.portalComponent=i,this.constraintTypes=Object.values(Br),this.isConstraintAvailable=function(){return!0},this.isConstraintAvailable=this.checkConstraintAvailable.bind(this)}return u(e,[{key:"ngOnInit",value:function(){}},{key:"selectClick",value:function(e){this.selectItem(e)}},{key:"handleAddClick",value:function(e){this.createNew(e)}},{key:"handleDuplicateClick",value:function(e){var t=this.store.selectSnapshot(Ko.a.getSelectedParticleSystem);this.particleSystemsService.duplicateConstraint(t,e)}},{key:"handleRemoveClick",value:function(e){this.delete(e)}},{key:"handleResetClick",value:function(e){this.resetDefault(e)}},{key:"handleResetAllClick",value:function(){this.resetDefaults()}},{key:"handleRemoveAllClick",value:function(){this.deleteAll()}},{key:"checkConstraintAvailable",value:function(e){return uc(this.store.selectSnapshot(Ko.a.getSelectedParticleSystem),e)}},{key:"selectItem",value:function(e){this.store.dispatch(new Wo.a.SelectParticleConstraint(e)),e>-1&&this.portalComponent.loadComponent(_s)}},{key:"createNew",value:function(e){var t=this.store.selectSnapshot(Ko.a.getSelectedParticleSystem);this.particleSystemsService.createNewConstraint(t,e)}},{key:"resetDefault",value:function(e){var t=this.store.selectSnapshot(Ko.a.getSelectedParticleSystem);this.particleSystemsService.resetConstraint(t,e)}},{key:"resetDefaults",value:function(){var e=this.store.selectSnapshot(Ko.a.getSelectedParticleSystem);this.particleSystemsService.resetConstraints(e)}},{key:"delete",value:function(e){var t=this.store.selectSnapshot(Ko.a.getSelectedParticleSystem);t.constraints=t.constraints.filter((function(t,n){return n!==e})),this.store.dispatch(new Wo.a.UpdateParticleSystem(t.id,t)),this.selectItem(-1)}},{key:"deleteAll",value:function(){var e=this.store.selectSnapshot(Ko.a.getSelectedParticleSystem);this.store.dispatch(new Wo.a.UpdateParticleSystem(e.id,Object.assign(Object.assign({},e),{constraints:[]})))}}]),e}()).\u0275fac=function(e){return new(e||Ss)(ve.Pb(y.h),ve.Pb(Pc),ve.Pb(Fr))},Ss.\u0275cmp=ve.Jb({type:Ss,selectors:[["app-edit-particle-constraint-list"]],decls:2,vars:6,consts:[["label","Constraints","type","constraint",3,"types","items","isTypeAvailable","itemClick","addClick","removeClick","duplicateClick","resetClick","resetAllClick","removeAllClick"]],template:function(e,t){var n;(1&e&&(ve.Vb(0,"app-edit-particle-list",0),ve.cc("itemClick",(function(e){return t.selectClick(e)}))("addClick",(function(e){return t.handleAddClick(e)}))("removeClick",(function(e){return t.handleRemoveClick(e)}))("duplicateClick",(function(e){return t.handleDuplicateClick(e)}))("resetClick",(function(e){return t.handleResetClick(e)}))("resetAllClick",(function(){return t.handleResetAllClick()}))("removeAllClick",(function(){return t.handleRemoveAllClick()})),ve.hc(1,"async"),ve.Ub()),2&e)&&ve.mc("types",t.constraintTypes)("items",(null==(n=ve.ic(1,3,t.particleSystem$))?null:n.constraints)||ve.oc(5,Ts))("isTypeAvailable",t.isConstraintAvailable)},directives:[ps],pipes:[f.b],styles:[""],changeDetection:0}),Ms([Object(y.e)(Ko.a.getSelectedParticleSystemId),Us("design:type",_.a)],Ss.prototype,"particleSystemId$",void 0),Ms([Object(y.e)(Ko.a.getSelectedParticleSystem),Us("design:type",_.a)],Ss.prototype,"particleSystem$",void 0),Ss),Ds=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Es(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"app-panel",12,13),ve.Vb(2,"div",14),ve.Vb(3,"button",2),ve.Qb(4,"app-icon",3),ve.Ub(),ve.Vb(5,"mat-menu",null,15),ve.Vb(7,"button",5),ve.cc("click",(function(){ve.Cc(n);var e=t.index;return ve.gc().handleRemovePathNodeClick(e)})),ve.Pc(8,"Remove Node"),ve.Ub(),ve.Vb(9,"button",5),ve.cc("click",(function(){ve.Cc(n);var e=t.$implicit;return ve.gc().handleDuplicatePathNodeClick(e)})),ve.Pc(10," Duplicate Node "),ve.Ub(),ve.Ub(),ve.Ub(),ve.Vb(11,"app-form-field",16),ve.Qb(12,"app-edit-particle-vector",17),ve.Ub(),ve.Vb(13,"app-form-field",18),ve.Qb(14,"app-slider",19),ve.Ub(),ve.Vb(15,"app-form-field",20),ve.Qb(16,"app-slider",21),ve.Ub(),ve.Vb(17,"app-form-field",22),ve.Qb(18,"app-slider",23),ve.Ub(),ve.Ub()}if(2&e){var i=t.$implicit,o=t.index,a=ve.yc(1),r=ve.yc(6),c=ve.gc();ve.mc("cdkDragDisabled",a.open)("open",!1)("label","Path Node #"+(o+1))("hint",c.formatNodeHint(i))("isCompact",!0)("formGroupName",o),ve.Db(3),ve.mc("matMenuTriggerFor",r),ve.Db(9),ve.mc("xmin",-10)("xmax",10)("ymin",-10)("ymax",10)("zmin",-10)("zmax",10),ve.Db(2),ve.mc("min",0)("max",25)("step",1),ve.Db(2),ve.mc("min",0)("max",100)("step",1),ve.Db(2),ve.mc("min",0)("max",25)("step",1)}}function js(e,t){1&e&&(ve.Vb(0,"div",24),ve.Pc(1," There are no Path Nodes in this updater. "),ve.Ub())}var Ns,Rs={position:[0,0,0],forceAverage:0,radius:0,forceVariance:0},As=((Ns=function(){function e(t,n,i){l(this,e),this.formBuilder=t,this.store=n,this.dialogService=i,this.ngUnsubscribe=new C.a,this.formGroup=this.formBuilder.group({nodes:this.formBuilder.array([])}),this.nodesFormArray=this.formGroup.get("nodes")}return u(e,[{key:"ngOnInit",value:function(){this.initFormListeners(),this.initUpdaterListeners()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initFormListeners",value:function(){var e=this;this.formGroup.valueChanges.pipe(Object(Un.a)(125),Object(io.a)((function(e,t){return Object(ce.isEqual)(e,t)})),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){var n=e.createUpdaterFromValues(e.formGroup.value);e.updateSystem(n)}))}},{key:"initUpdaterListeners",value:function(){var e=this;this.particleUpdater$.pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.setValues(t)}))}},{key:"handleAddPathNodeClick",value:function(){this.addPathNode()}},{key:"handleRemoveAllPathNodesClick",value:function(){var e=this;this.dialogService.openConfirmDialog({data:{titleText:"Remove All Path Nodes",bodyText:"Would you like to remove all ".concat(this.nodesFormArray.length," Path Nodes?")}}).afterClosed().pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){if(t){var n=e.createUpdaterFromValues({nodes:[]});e.updateSystem(n)}}))}},{key:"handleRemovePathNodeClick",value:function(e){this.nodesFormArray.removeAt(e)}},{key:"handleDuplicatePathNodeClick",value:function(e){var t=this.createPathNodeFormGroup(e.value);this.nodesFormArray.push(t)}},{key:"handlePathNodeDropped",value:function(e){var t=this,n=e.previousIndex,i=e.currentIndex,o=this.formGroup.value.nodes,a=Object(he.a)(o,n,i);this.nodesFormArray.clear(),a.forEach((function(e){var n=t.createPathNodeFormGroup(e);t.nodesFormArray.push(n)})),this.formGroup.patchValue({nodes:a})}},{key:"addPathNode",value:function(){var e=this.createPathNodeFormGroup(Rs);this.nodesFormArray.push(e)}},{key:"createPathNodeFormGroup",value:function(e){var t=e.position,n=e.forceAverage,i=e.radius,o=e.forceVariance;return this.formBuilder.group({position:[t],forceAverage:[n],radius:[i],forceVariance:[o]})}},{key:"setValues",value:function(e){var t=this;e.type===Lr.Path&&void 0!==e.nodes&&this.nodesFormArray.length!==e.nodes.length&&(this.nodesFormArray.clear(),e.nodes.forEach((function(){var e=t.createPathNodeFormGroup(Rs);t.nodesFormArray.push(e)}))),this.formGroup.patchValue(Object.assign({},e),{emitEvent:!1,onlySelf:!0})}},{key:"formatNodeHint",value:function(e){var t=e.value,n=t.position,i=t.forceAverage,o=t.radius,a=t.forceVariance;return"Postition: [".concat(n,"], Force Average: ").concat(i,", Radius: ").concat(o,", Force Variance: ").concat(a)}},{key:"createUpdaterFromValues",value:function(e){var t=this.store.selectSnapshot(Ko.a.getSelectedParticleUpdater);return pc(t.type,Object.assign(Object.assign({},t),e))}},{key:"updateSystem",value:function(e){var t=this.store.selectSnapshot(Ko.a.getSelectedParticleSystem),n=this.store.selectSnapshot(Ko.a.getSelectedParticleUpdaterIndex);t.updaters[n]=e,this.store.dispatch(new Wo.a.UpdateParticleSystem(t.id,t))}}]),e}()).\u0275fac=function(e){return new(e||Ns)(ve.Pb(ae.f),ve.Pb(y.h),ve.Pb(Bi.a))},Ns.\u0275cmp=ve.Jb({type:Ns,selectors:[["app-edit-particle-updater-node"]],decls:19,vars:9,consts:[[3,"formGroup","label"],["list-actions",""],["app-button","",3,"matMenuTriggerFor"],["icon","ellipsis-v"],["pathNodeMenu","matMenu"],["mat-menu-item","",3,"click"],["formArrayName","nodes"],["cdkDropList","","cdkDropListOrientation","vertical",3,"cdkDropListDropped"],["cdkDrag","","toggleType","arrow",3,"cdkDragDisabled","open","label","hint","isCompact","formGroupName",4,"ngFor","ngForOf"],[1,"flex","flex-column","items-center","mv-2"],["class","text-12 text-center mv-4",4,"ngIf"],["app-button","","buttonType","outline",3,"click"],["cdkDrag","","toggleType","arrow",3,"cdkDragDisabled","open","label","hint","isCompact","formGroupName"],["nodePanel",""],["panel-actions",""],["nodeActionsMenu","matMenu"],["label","Position"],["formControlName","position",3,"xmin","xmax","ymin","ymax","zmin","zmax"],["label","Force Average"],["formControlName","forceAverage",3,"min","max","step"],["label","Radius"],["formControlName","radius",3,"min","max","step"],["label","Force Variance"],["formControlName","forceVariance",3,"min","max","step"],[1,"text-12","text-center","mv-4"]],template:function(e,t){if(1&e&&(ve.Vb(0,"app-portal-column",0),ve.Vb(1,"div",1),ve.Vb(2,"button",2),ve.Qb(3,"app-icon",3),ve.Ub(),ve.Vb(4,"mat-menu",null,4),ve.Vb(6,"button",5),ve.cc("click",(function(){return t.handleAddPathNodeClick()})),ve.Pc(7,"Add Node"),ve.Ub(),ve.Vb(8,"button",5),ve.cc("click",(function(){return t.handleRemoveAllPathNodesClick()})),ve.Pc(9,"Remove All Nodes"),ve.Ub(),ve.Ub(),ve.Ub(),ve.Tb(10,6),ve.Vb(11,"div",7),ve.cc("cdkDropListDropped",(function(e){return t.handlePathNodeDropped(e)})),ve.Nc(12,Es,19,22,"app-panel",8),ve.Ub(),ve.Vb(13,"div",9),ve.Nc(14,js,2,0,"div",10),ve.hc(15,"async"),ve.hc(16,"async"),ve.Vb(17,"button",11),ve.cc("click",(function(){return t.handleAddPathNodeClick()})),ve.Pc(18,"Add Node"),ve.Ub(),ve.Ub(),ve.Sb(),ve.Ub()),2&e){var n=ve.yc(5),i=null;ve.mc("formGroup",t.formGroup)("label","Path Nodes"),ve.Db(2),ve.mc("matMenuTriggerFor",n),ve.Db(10),ve.mc("ngForOf",t.nodesFormArray.controls),ve.Db(2),ve.mc("ngIf",(null==(i=ve.ic(15,5,t.particleUpdater$))?null:i.nodes)&&0===(null==(i=ve.ic(16,7,t.particleUpdater$))?null:i.nodes.length))}},directives:[yc,ae.s,ae.j,Pe.a,Ki.d,yt.a,Ki.a,Ki.b,ae.e,vt.c,f.o,f.p,Me.a,vt.a,ae.k,Oe.a,wc,ae.r,ae.i,To.a],pipes:[f.b],styles:[""],changeDetection:0}),function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);a>3&&r&&Object.defineProperty(t,n,r)}([Object(y.e)(Ko.a.getSelectedParticleUpdater),Ds("design:type",_.a)],Ns.prototype,"particleUpdater$",void 0),Ns),Fs=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Is(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"app-panel",12),ve.Vb(1,"div",13),ve.Vb(2,"button",2),ve.Qb(3,"app-icon",3),ve.Ub(),ve.Vb(4,"mat-menu",null,14),ve.Vb(6,"button",5),ve.cc("click",(function(){ve.Cc(n);var e=t.index;return ve.gc().handleRemovePathColorClick(e)})),ve.Pc(7,"Remove Color"),ve.Ub(),ve.Vb(8,"button",5),ve.cc("click",(function(){ve.Cc(n);var e=t.$implicit;return ve.gc().handleDuplicatePathColorClick(e)})),ve.Pc(9," Duplicate Color "),ve.Ub(),ve.Ub(),ve.Ub(),ve.Qb(10,"app-color-picker-input",15),ve.Ub()}if(2&e){var i=t.index,o=ve.yc(5);ve.mc("toggleable",!1)("label","Color #"+(i+1))("isCompact",!0),ve.Db(2),ve.mc("matMenuTriggerFor",o),ve.Db(8),ve.mc("formControlName",i)("alpha",!0)("decimal",!1)}}function zs(e,t){1&e&&(ve.Vb(0,"div",16),ve.Pc(1," There are no colors in this updater. "),ve.Ub())}var Ls,Bs=[255,0,0,1],Qs=((Ls=function(){function e(t,n,i){l(this,e),this.formBuilder=t,this.store=n,this.dialogService=i,this.ngUnsubscribe=new C.a,this.formGroup=this.formBuilder.group({colors:this.formBuilder.array([[0,0,0,1],[0,0,0,1],[0,0,0,1]])}),this.colorsFormArray=this.formGroup.get("colors")}return u(e,[{key:"ngOnInit",value:function(){this.initFormListeners(),this.initUpdaterListeners()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initFormListeners",value:function(){var e=this;this.formGroup.valueChanges.pipe(Object(Un.a)(125),Object(io.a)((function(e,t){return Object(ce.isEqual)(e,t)})),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){var n=e.createUpdaterFromValues(e.formGroup.value);e.updateSystem(n)}))}},{key:"initUpdaterListeners",value:function(){var e=this;this.particleUpdater$.pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.setValues(t)}))}},{key:"handleAddPathColorClick",value:function(){this.addPathColor()}},{key:"handleRemoveAllPathColorsClick",value:function(){var e=this;this.dialogService.openConfirmDialog({data:{titleText:"Remove All Colors",bodyText:"Would you like to remove all ".concat(this.colorsFormArray.length," colors?")}}).afterClosed().pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){if(t){var n=e.createUpdaterFromValues({colors:[]});e.updateSystem(n)}}))}},{key:"handleRemovePathColorClick",value:function(e){this.colorsFormArray.removeAt(e)}},{key:"handleDuplicatePathColorClick",value:function(e){var t=this.createColorControl(e.value);this.colorsFormArray.push(t)}},{key:"handlePathColorDropped",value:function(e){var t=this,n=e.previousIndex,i=e.currentIndex,o=this.formGroup.value.colors,a=Object(he.a)(o,n,i);this.colorsFormArray.clear(),a.forEach((function(e){var n=t.createColorControl(e);t.colorsFormArray.push(n)})),this.formGroup.patchValue({colors:a})}},{key:"addPathColor",value:function(){var e=this.createColorControl(Bs);this.colorsFormArray.push(e)}},{key:"createColorControl",value:function(e){var t=this.formBuilder.control([]);return t.setValue(e),t}},{key:"setValues",value:function(e){var t=this,n=Object(ce.get)(e,"colors",[]);Array.isArray(n)&&Array.isArray(n)&&(n=this.colorModelToFormColor(n)),this.colorsFormArray.length!==n.length&&(this.colorsFormArray.clear(),n.forEach((function(){var e=t.createColorControl(Bs);t.colorsFormArray.push(e)}))),this.formGroup.patchValue({colors:n},{emitEvent:!1,onlySelf:!0})}},{key:"colorModelToFormColor",value:function(e){return e.map((function(e){var t=r(e,4);return[t[0],t[1],t[2],t[3]/255]}))}},{key:"formColorToColorModel",value:function(e){return e.map((function(e){var t=r(e,4);return[t[0],t[1],t[2],255*t[3]]}))}},{key:"createUpdaterFromValues",value:function(e){var t=e.colors,n=this.store.selectSnapshot(Ko.a.getSelectedParticleUpdater);return pc(n.type,Object.assign(Object.assign({},n),{colors:this.formColorToColorModel(t)}))}},{key:"updateSystem",value:function(e){var t=this.store.selectSnapshot(Ko.a.getSelectedParticleSystem),n=this.store.selectSnapshot(Ko.a.getSelectedParticleUpdaterIndex);t.updaters[n]=e,this.store.dispatch(new Wo.a.UpdateParticleSystem(t.id,t))}}]),e}()).\u0275fac=function(e){return new(e||Ls)(ve.Pb(ae.f),ve.Pb(y.h),ve.Pb(Bi.a))},Ls.\u0275cmp=ve.Jb({type:Ls,selectors:[["app-edit-particle-updater-color"]],decls:19,vars:9,consts:[[3,"formGroup","label"],["list-actions",""],["app-button","",3,"matMenuTriggerFor"],["icon","ellipsis-v"],["colorsMenu","matMenu"],["mat-menu-item","",3,"click"],["formArrayName","colors"],["cdkDropList","","cdkDropListOrientation","vertical",3,"cdkDropListDropped"],["cdkDrag","",3,"toggleable","label","isCompact",4,"ngFor","ngForOf"],[1,"flex","flex-column","items-center","mv-2"],["class","text-12 text-center mv-4",4,"ngIf"],["app-button","","buttonType","outline",3,"click"],["cdkDrag","",3,"toggleable","label","isCompact"],["panel-actions",""],["colorActionsMenu","matMenu"],["type","rgba",3,"formControlName","alpha","decimal"],[1,"text-12","text-center","mv-4"]],template:function(e,t){if(1&e&&(ve.Vb(0,"app-portal-column",0),ve.Vb(1,"div",1),ve.Vb(2,"button",2),ve.Qb(3,"app-icon",3),ve.Ub(),ve.Vb(4,"mat-menu",null,4),ve.Vb(6,"button",5),ve.cc("click",(function(){return t.handleAddPathColorClick()})),ve.Pc(7,"Add Color"),ve.Ub(),ve.Vb(8,"button",5),ve.cc("click",(function(){return t.handleRemoveAllPathColorsClick()})),ve.Pc(9,"Remove All Colors"),ve.Ub(),ve.Ub(),ve.Ub(),ve.Tb(10,6),ve.Vb(11,"div",7),ve.cc("cdkDropListDropped",(function(e){return t.handlePathColorDropped(e)})),ve.Nc(12,Is,11,7,"app-panel",8),ve.Ub(),ve.Vb(13,"div",9),ve.Nc(14,zs,2,0,"div",10),ve.hc(15,"async"),ve.hc(16,"async"),ve.Vb(17,"button",11),ve.cc("click",(function(){return t.handleAddPathColorClick()})),ve.Pc(18,"Add Color"),ve.Ub(),ve.Ub(),ve.Sb(),ve.Ub()),2&e){var n=ve.yc(5),i=null;ve.mc("formGroup",t.formGroup)("label","Colors"),ve.Db(2),ve.mc("matMenuTriggerFor",n),ve.Db(10),ve.mc("ngForOf",t.colorsFormArray.controls),ve.Db(2),ve.mc("ngIf",(null==(i=ve.ic(15,5,t.particleUpdater$))?null:i.colors)&&0===(null==(i=ve.ic(16,7,t.particleUpdater$))?null:i.colors.length))}},directives:[yc,ae.s,ae.j,Pe.a,Ki.d,yt.a,Ki.a,Ki.b,ae.e,vt.c,f.o,f.p,Me.a,vt.a,Vt,ae.r,ae.i],pipes:[f.b],styles:[""],changeDetection:0}),function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);a>3&&r&&Object.defineProperty(t,n,r)}([Object(y.e)(Ko.a.getSelectedParticleUpdater),Fs("design:type",_.a)],Ls.prototype,"particleUpdater$",void 0),Ls),$s=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function qs(e,t){if(1&e&&(ve.Vb(0,"option",16),ve.Pc(1),ve.hc(2,"prettyPrint"),ve.Ub()),2&e){var n=t.$implicit;ve.mc("value",n),ve.Db(1),ve.Rc(" ",ve.ic(2,2,n)," ")}}function Gs(e,t){if(1&e){var n=ve.Wb();ve.Tb(0),ve.Vb(1,"app-portal-item",17),ve.cc("itemClick",(function(){return ve.Cc(n),ve.gc().handleColorsClicked()})),ve.Ub(),ve.Vb(2,"app-panel",18),ve.Qb(3,"app-edit-particle-shape",19),ve.Ub(),ve.Sb()}2&e&&(ve.Db(1),ve.mc("label","Colors"))}function Hs(e,t){1&e&&(ve.Tb(0),ve.Vb(1,"app-panel"),ve.Vb(2,"app-form-field",20),ve.Qb(3,"app-slider",21),ve.Ub(),ve.Vb(4,"app-form-field",22),ve.Qb(5,"app-slider",23),ve.Ub(),ve.Vb(6,"app-form-field",24),ve.Qb(7,"app-slider",25),ve.Ub(),ve.Ub(),ve.Vb(8,"app-panel",18),ve.Qb(9,"app-edit-particle-shape",19),ve.Ub(),ve.Sb()),2&e&&(ve.Db(3),ve.mc("min",0)("max",100)("step",1),ve.Db(2),ve.mc("min",0)("max",25)("step",1),ve.Db(2),ve.mc("min",0)("max",25)("step",1))}function Ws(e,t){1&e&&(ve.Tb(0),ve.Vb(1,"app-panel"),ve.Vb(2,"app-form-field",26),ve.Qb(3,"app-edit-particle-vector",27),ve.Ub(),ve.Vb(4,"app-form-field",22),ve.Qb(5,"app-slider",23),ve.Ub(),ve.Vb(6,"app-form-field",28),ve.Qb(7,"app-slider",29),ve.Ub(),ve.Vb(8,"app-form-field",24),ve.Qb(9,"app-slider",25),ve.Ub(),ve.Ub(),ve.Vb(10,"app-panel",18),ve.Qb(11,"app-edit-particle-shape",19),ve.Ub(),ve.Sb()),2&e&&(ve.Db(3),ve.mc("xmin",-10)("xmax",10)("ymin",-10)("ymax",10)("zmin",-10)("zmax",10),ve.Db(2),ve.mc("min",0)("max",25)("step",1),ve.Db(2),ve.mc("min",0)("max",25)("step",.5),ve.Db(2),ve.mc("min",0)("max",25)("step",1))}function Ks(e,t){1&e&&(ve.Tb(0),ve.Vb(1,"app-panel"),ve.Vb(2,"app-form-field",30),ve.Qb(3,"app-edit-particle-vector",31),ve.Ub(),ve.Vb(4,"app-form-field",22),ve.Qb(5,"app-slider",23),ve.Ub(),ve.Vb(6,"app-form-field",24),ve.Qb(7,"app-slider",25),ve.Ub(),ve.Ub(),ve.Vb(8,"app-panel",18),ve.Qb(9,"app-edit-particle-shape",19),ve.Ub(),ve.Sb()),2&e&&(ve.Db(3),ve.mc("xmin",-10)("xmax",10)("ymin",-10)("ymax",10)("zmin",-10)("zmax",10),ve.Db(2),ve.mc("min",-25)("max",25)("step",1),ve.Db(2),ve.mc("min",0)("max",25)("step",1))}function Js(e,t){1&e&&(ve.Tb(0),ve.Vb(1,"app-panel"),ve.Vb(2,"app-form-field",32),ve.Qb(3,"app-slider",33),ve.Ub(),ve.Ub(),ve.Vb(4,"app-panel",18),ve.Qb(5,"app-edit-particle-shape",19),ve.Ub(),ve.Sb()),2&e&&(ve.Db(3),ve.mc("min",0)("max",1)("step",.01))}function Xs(e,t){1&e&&(ve.Tb(0),ve.Vb(1,"app-panel"),ve.Vb(2,"app-form-field",30),ve.Qb(3,"app-edit-particle-vector",31),ve.Ub(),ve.Vb(4,"app-form-field",22),ve.Qb(5,"app-slider",23),ve.Ub(),ve.Vb(6,"app-form-field",34),ve.Qb(7,"app-slider",35),ve.Ub(),ve.Vb(8,"app-form-field",24),ve.Qb(9,"app-slider",25),ve.Ub(),ve.Ub(),ve.Vb(10,"app-panel",18),ve.Qb(11,"app-edit-particle-shape",19),ve.Ub(),ve.Sb()),2&e&&(ve.Db(3),ve.mc("xmin",-10)("xmax",10)("ymin",-10)("ymax",10)("zmin",-10)("zmax",10),ve.Db(2),ve.mc("min",-25)("max",25)("step",1),ve.Db(2),ve.mc("min",0)("max",10)("step",1),ve.Db(2),ve.mc("min",0)("max",25)("step",1))}function Zs(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"app-portal-item",37),ve.cc("itemClick",(function(){return ve.Cc(n),ve.gc(2).handlePathNodesClicked()})),ve.Ub()}if(2&e){var i=t.$implicit;ve.mc("label","Path Nodes")("hint",(i.nodes?i.nodes.length:0)+" Path Nodes")}}function Ys(e,t){if(1&e&&(ve.Tb(0),ve.Nc(1,Zs,1,2,"app-portal-item",36),ve.hc(2,"async"),ve.Vb(3,"app-panel",18),ve.Qb(4,"app-edit-particle-shape",19),ve.Ub(),ve.Sb()),2&e){var n=ve.gc();ve.Db(1),ve.mc("ngIf",ve.ic(2,1,n.particleUpdater$))}}function el(e,t){1&e&&(ve.Tb(0),ve.Vb(1,"app-panel"),ve.Vb(2,"app-form-field",30),ve.Qb(3,"app-edit-particle-vector",31),ve.Ub(),ve.Vb(4,"app-form-field",38),ve.Qb(5,"app-edit-particle-vector",39),ve.Ub(),ve.Vb(6,"app-form-field",22),ve.Qb(7,"app-slider",23),ve.Ub(),ve.Vb(8,"app-form-field",24),ve.Qb(9,"app-slider",25),ve.Ub(),ve.Ub(),ve.Vb(10,"app-panel",18),ve.Qb(11,"app-edit-particle-shape",19),ve.Ub(),ve.Sb()),2&e&&(ve.Db(3),ve.mc("xmin",-10)("xmax",10)("ymin",-10)("ymax",10)("zmin",-10)("zmax",10),ve.Db(2),ve.mc("xmin",-10)("xmax",10)("ymin",-10)("ymax",10)("zmin",-10)("zmax",10),ve.Db(2),ve.mc("min",-25)("max",25)("step",1),ve.Db(2),ve.mc("min",0)("max",25)("step",1))}var tl,nl,il,ol,al=((tl=function(){function e(t,n,i,o,a){l(this,e),this.store=t,this.formBuilder=n,this.portalComponent=i,this.particleSystemsService=o,this.dialogService=a,this.particleUpdaterEnum=Lr,this.updaterTypes=Object.values(Lr),this.ngUnsubscribe=new C.a,this.formGroup=this.formBuilder.group({id:[""],type:[""],name:[""],position:[[0,0,0]],direction:[[0,0,0]],friction:0,frequency:0,forceAverage:0,radius:0,forceVariance:0,directionAverage:[[0,0,0]],directionVariance:0,shapeEnabled:[!1],shape:[Jr]})}return u(e,[{key:"ngOnInit",value:function(){this.initFormListeners(),this.initUpdaterListeners()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initFormListeners",value:function(){var e=this;this.formGroup.valueChanges.pipe(Object(Un.a)(125),Object(io.a)((function(e,t){return Object(ce.isEqual)(e,t)})),Object(N.a)(this.ngUnsubscribe)).subscribe((function(){var t=e.createUpdaterFromValues(e.formGroup.value);e.updateSystem(t)}))}},{key:"initUpdaterListeners",value:function(){var e=this;this.particleUpdater$.pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.setValues(t)}))}},{key:"handleDuplicateClick",value:function(){var e=this.store.selectSnapshot(Ko.a.getSelectedParticleSystem),t=this.store.selectSnapshot(Ko.a.getSelectedParticleUpdater);this.particleSystemsService.duplicateUpdater(e,t)}},{key:"handleResetClick",value:function(){var e=this.store.selectSnapshot(Ko.a.getSelectedParticleSystem),t=this.store.selectSnapshot(Ko.a.getSelectedParticleUpdaterIndex);this.particleSystemsService.resetUpdater(e,t)}},{key:"handleRemoveClick",value:function(){var e=this.store.selectSnapshot(Ko.a.getSelectedParticleSystem),t=this.store.selectSnapshot(Ko.a.getSelectedParticleUpdaterIndex);this.particleSystemsService.removeUpdater(e,t),this.portalComponent.back()}},{key:"handlePathNodesClicked",value:function(){this.portalComponent.loadComponent(As)}},{key:"handleColorsClicked",value:function(){this.portalComponent.loadComponent(Qs)}},{key:"setValues",value:function(e){if(this.formGroup){var t="shape"in e&&!Object(ce.isNil)(e.shape);this.formGroup.patchValue(Object.assign(Object.assign({},e),{shapeEnabled:t}),{emitEvent:!1,onlySelf:!0})}}},{key:"createUpdaterFromValues",value:function(e){var t=e.type,n=e.shapeEnabled,i=e.shape,o=this.store.selectSnapshot(Ko.a.getSelectedParticleUpdater);return pc(t,Object.assign(Object.assign(Object.assign({},o),e),{shape:n?i:void 0}))}},{key:"updateSystem",value:function(e){var t=this.store.selectSnapshot(Ko.a.getSelectedParticleSystem),n=this.store.selectSnapshot(Ko.a.getSelectedParticleUpdaterIndex);t.updaters[n]=e,this.store.dispatch(new Wo.a.UpdateParticleSystem(t.id,t))}}]),e}()).\u0275fac=function(e){return new(e||tl)(ve.Pb(y.h),ve.Pb(ae.f),ve.Pb(Fr),ve.Pb(Pc),ve.Pb(Bi.a))},tl.\u0275cmp=ve.Jb({type:tl,selectors:[["app-edit-particle-updater"]],decls:32,vars:15,consts:[["label","Updater"],["list-actions",""],["app-button","",3,"matMenuTriggerFor"],["icon","ellipsis-v"],["actionsMenu","matMenu"],["mat-menu-item","",3,"click"],[3,"formGroup"],["label","Name"],["type","text","formControlName","name",1,"input"],["label","ID"],[1,"text-11"],["label","Type"],["formControlName","type",1,"input"],[3,"value",4,"ngFor","ngForOf"],[3,"ngSwitch"],[4,"ngSwitchCase"],[3,"value"],[3,"label","itemClick"],["label","Shape","toggleType","checkbox","formControlName","shapeEnabled"],["formControlName","shape"],["label","Frequency"],["formControlName","frequency",3,"min","max","step"],["label","Force Average"],["formControlName","forceAverage",3,"min","max","step"],["label","Force Variance"],["formControlName","forceVariance",3,"min","max","step"],["label","Direction Average"],["formControlName","directionAverage",3,"xmin","xmax","ymin","ymax","zmin","zmax"],["label","Direction Variance"],["formControlName","directionVariance",3,"min","max","step"],["label","Position"],["formControlName","position",3,"xmin","xmax","ymin","ymax","zmin","zmax"],["label","friction"],["formControlName","friction",3,"min","max","step"],["label","Radius"],["formControlName","radius",3,"min","max","step"],[3,"label","hint","itemClick",4,"ngIf"],[3,"label","hint","itemClick"],["label","Direction"],["formControlName","direction",3,"xmin","xmax","ymin","ymax","zmin","zmax"]],template:function(e,t){if(1&e&&(ve.Vb(0,"app-portal-column",0),ve.Vb(1,"div",1),ve.Vb(2,"button",2),ve.Qb(3,"app-icon",3),ve.Ub(),ve.Vb(4,"mat-menu",null,4),ve.Vb(6,"button",5),ve.cc("click",(function(){return t.handleDuplicateClick()})),ve.Pc(7,"Duplicate"),ve.Ub(),ve.Vb(8,"button",5),ve.cc("click",(function(){return t.handleResetClick()})),ve.Pc(9,"Reset to default"),ve.Ub(),ve.Vb(10,"button",5),ve.cc("click",(function(){return t.handleRemoveClick()})),ve.Pc(11,"Remove"),ve.Ub(),ve.Ub(),ve.Ub(),ve.Vb(12,"div",6),ve.Vb(13,"app-panel"),ve.Vb(14,"app-form-field",7),ve.Qb(15,"input",8),ve.Ub(),ve.Vb(16,"app-form-field",9),ve.Vb(17,"span",10),ve.Pc(18),ve.hc(19,"async"),ve.Ub(),ve.Ub(),ve.Vb(20,"app-form-field",11),ve.Vb(21,"select",12),ve.Nc(22,qs,3,4,"option",13),ve.Ub(),ve.Ub(),ve.Ub(),ve.Tb(23,14),ve.Nc(24,Gs,4,1,"ng-container",15),ve.Nc(25,Hs,10,9,"ng-container",15),ve.Nc(26,Ws,12,15,"ng-container",15),ve.Nc(27,Ks,10,12,"ng-container",15),ve.Nc(28,Js,6,3,"ng-container",15),ve.Nc(29,Xs,12,15,"ng-container",15),ve.Nc(30,Ys,5,3,"ng-container",15),ve.Nc(31,el,12,18,"ng-container",15),ve.Sb(),ve.Ub(),ve.Ub()),2&e){var n,i=ve.yc(5);ve.Db(2),ve.mc("matMenuTriggerFor",i),ve.Db(10),ve.mc("formGroup",t.formGroup),ve.Db(6),ve.Qc(null==(n=ve.ic(19,13,t.particleUpdater$))?null:n.id),ve.Db(4),ve.mc("ngForOf",t.updaterTypes),ve.Db(1),ve.mc("ngSwitch",t.formGroup.get("type").value),ve.Db(1),ve.mc("ngSwitchCase",t.particleUpdaterEnum.AgeColorBlend),ve.Db(1),ve.mc("ngSwitchCase",t.particleUpdaterEnum.BrownianMotion),ve.Db(1),ve.mc("ngSwitchCase",t.particleUpdaterEnum.UniformForce),ve.Db(1),ve.mc("ngSwitchCase",t.particleUpdaterEnum.RadialForce),ve.Db(1),ve.mc("ngSwitchCase",t.particleUpdaterEnum.Friction),ve.Db(1),ve.mc("ngSwitchCase",t.particleUpdaterEnum.Gravity),ve.Db(1),ve.mc("ngSwitchCase",t.particleUpdaterEnum.Path),ve.Db(1),ve.mc("ngSwitchCase",t.particleUpdaterEnum.AxisForce)}},directives:[yc,Pe.a,Ki.d,yt.a,Ki.a,Ki.b,ae.s,ae.j,Me.a,Oe.a,ae.c,ae.r,ae.i,ae.B,f.o,f.r,f.s,ae.v,ae.D,Zc,Cs,To.a,wc,f.p],pipes:[f.b,_c],styles:[""],changeDetection:0}),function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);a>3&&r&&Object.defineProperty(t,n,r)}([Object(y.e)(Ko.a.getSelectedParticleUpdater),$s("design:type",_.a)],tl.prototype,"particleUpdater$",void 0),tl),rl=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},cl=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},sl=function(){return[]},ll=((nl=function(){function e(t,n,i,o){l(this,e),this.store=t,this.dialogService=n,this.particleSystemsService=i,this.portalComponent=o,this.updaterTypes=Object.values(Lr),this.ngUnsubscribe=new C.a}return u(e,[{key:"ngOnInit",value:function(){}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"selectClick",value:function(e){this.selectItem(e),e>-1&&this.portalComponent.loadComponent(al)}},{key:"handleRemoveClick",value:function(e){this.delete(e)}},{key:"handleDuplicateClick",value:function(e){var t=this.store.selectSnapshot(Ko.a.getSelectedParticleSystem);this.particleSystemsService.duplicateUpdater(t,e)}},{key:"handleAddClick",value:function(e){this.createNew(e)}},{key:"handleResetClick",value:function(e){this.resetDefault(e)}},{key:"handleResetAllClick",value:function(){this.resetDefaults()}},{key:"handleRemoveAllClick",value:function(){this.deleteAll()}},{key:"selectItem",value:function(e){this.store.dispatch(new Wo.a.SelectParticleUpdater(e))}},{key:"createNew",value:function(e){var t=this.store.selectSnapshot(Ko.a.getSelectedParticleSystem);this.particleSystemsService.createNewUpdater(t,e)}},{key:"resetDefault",value:function(e){var t=this.store.selectSnapshot(Ko.a.getSelectedParticleSystem);this.particleSystemsService.resetUpdater(t,e)}},{key:"resetDefaults",value:function(){var e=this.store.selectSnapshot(Ko.a.getSelectedParticleSystem);this.particleSystemsService.resetUpdaters(e)}},{key:"delete",value:function(e){var t=this.store.selectSnapshot(Ko.a.getSelectedParticleSystem);t.updaters=t.updaters.filter((function(t,n){return n!==e})),this.store.dispatch(new Wo.a.UpdateParticleSystem(t.id,t)),this.selectItem(-1)}},{key:"deleteAll",value:function(){var e=this.store.selectSnapshot(Ko.a.getSelectedParticleSystem);this.store.dispatch(new Wo.a.UpdateParticleSystem(e.id,Object.assign(Object.assign({},e),{updaters:[]})))}}]),e}()).\u0275fac=function(e){return new(e||nl)(ve.Pb(y.h),ve.Pb(Bi.a),ve.Pb(Pc),ve.Pb(Fr))},nl.\u0275cmp=ve.Jb({type:nl,selectors:[["app-edit-particle-updater-list"]],decls:2,vars:5,consts:[["label","Updaters","type","updater",3,"types","items","itemClick","addClick","removeClick","duplicateClick","resetClick","resetAllClick","removeAllClick"]],template:function(e,t){var n;(1&e&&(ve.Vb(0,"app-edit-particle-list",0),ve.cc("itemClick",(function(e){return t.selectClick(e)}))("addClick",(function(e){return t.handleAddClick(e)}))("removeClick",(function(e){return t.handleRemoveClick(e)}))("duplicateClick",(function(e){return t.handleDuplicateClick(e)}))("resetClick",(function(e){return t.handleResetClick(e)}))("resetAllClick",(function(){return t.handleResetAllClick()}))("removeAllClick",(function(){return t.handleRemoveAllClick()})),ve.hc(1,"async"),ve.Ub()),2&e)&&ve.mc("types",t.updaterTypes)("items",(null==(n=ve.ic(1,2,t.particleSystem$))?null:n.updaters)||ve.oc(4,sl))},directives:[ps],pipes:[f.b],styles:[""],changeDetection:0}),rl([Object(y.e)(Ko.a.getSelectedParticleSystemId),cl("design:type",_.a)],nl.prototype,"particleSystemId$",void 0),rl([Object(y.e)(Ko.a.getSelectedParticleSystem),cl("design:type",_.a)],nl.prototype,"particleSystem$",void 0),nl),pl=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},ul=((il=function(){function e(t,n){l(this,e),this.formBuilder=t,this.store=n,this.ngUnsubscribe=new C.a,this.initForm()}return u(e,[{key:"ngOnInit",value:function(){this.initFormListeners(),this.initParticleSystemListeners()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initForm",value:function(){this.form=this.formBuilder.group({numParticles:[0],pointSize:[0],emissionAverage:[0],emissionVariance:[0]}),this.setValues(nc())}},{key:"initFormListeners",value:function(){var e=this;this.form.valueChanges.pipe(Object(Un.a)(125),Object(io.a)((function(e,t){return Object(ce.isEqual)(e,t)})),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.setParticleSystem(t)}))}},{key:"initParticleSystemListeners",value:function(){var e=this;this.particleSystem$.pipe(Object(R.a)((function(e){return!Object(ce.isNil)(e)})),Object(io.a)((function(e,t){return Object(ce.isEqual)(e,t)})),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.setValues(t)}))}},{key:"handleResetClick",value:function(){this.reset()}},{key:"setParticleSystem",value:function(e){var t=this.store.selectSnapshot(Ko.a.getSelectedParticleSystem),n=cc(Object.assign(Object.assign({},t),this.getParticleSystemFromForm(e)));this.store.dispatch(new Wo.a.UpdateParticleSystem(n.id,n))}},{key:"setValues",value:function(e){this.form&&this.form.patchValue(e,{emitEvent:!1,onlySelf:!0})}},{key:"reset",value:function(){var e=this.store.selectSnapshot(Ko.a.getSelectedParticleSystemId);this.setValues(Object.assign(Object.assign({},nc()),{id:e}))}},{key:"getParticleSystemFromForm",value:function(e){return{numParticles:e.numParticles,pointSize:e.pointSize,emissionAverage:e.emissionAverage,emissionVariance:e.emissionVariance}}}]),e}()).\u0275fac=function(e){return new(e||il)(ve.Pb(ae.f),ve.Pb(y.h))},il.\u0275cmp=ve.Jb({type:il,selectors:[["app-edit-particle-system-basic-form"]],decls:17,vars:11,consts:[[3,"label"],["list-actions",""],["app-button","",3,"matMenuTriggerFor"],["icon","ellipsis-v"],["actionsMenu","matMenu"],["mat-menu-item","",3,"click"],[3,"formGroup"],["label","Number of Particles"],["formControlName","numParticles",3,"min","max"],["label","Point Size"],["formControlName","pointSize",3,"min","max"],["label","Emission Average"],["formControlName","emissionAverage",3,"min","max"],["label","Emission Variance"],["formControlName","emissionVariance",3,"min","max"]],template:function(e,t){if(1&e&&(ve.Vb(0,"app-portal-column",0),ve.Vb(1,"div",1),ve.Vb(2,"button",2),ve.Qb(3,"app-icon",3),ve.Ub(),ve.Vb(4,"mat-menu",null,4),ve.Vb(6,"button",5),ve.cc("click",(function(){return t.handleResetClick()})),ve.Pc(7,"Reset to default"),ve.Ub(),ve.Ub(),ve.Ub(),ve.Vb(8,"app-panel",6),ve.Vb(9,"app-form-field",7),ve.Qb(10,"app-slider",8),ve.Ub(),ve.Vb(11,"app-form-field",9),ve.Qb(12,"app-slider",10),ve.Ub(),ve.Vb(13,"app-form-field",11),ve.Qb(14,"app-slider",12),ve.Ub(),ve.Vb(15,"app-form-field",13),ve.Qb(16,"app-slider",14),ve.Ub(),ve.Ub(),ve.Ub()),2&e){var n=ve.yc(5);ve.mc("label","Quantity"),ve.Db(2),ve.mc("matMenuTriggerFor",n),ve.Db(6),ve.mc("formGroup",t.form),ve.Db(2),ve.mc("min",0)("max",1e4),ve.Db(2),ve.mc("min",0)("max",100),ve.Db(2),ve.mc("min",0)("max",1e4),ve.Db(2),ve.mc("min",0)("max",1e4)}},directives:[yc,Pe.a,Ki.d,yt.a,Ki.a,Ki.b,Me.a,ae.s,ae.j,Oe.a,To.a,ae.r,ae.i],styles:[""],changeDetection:0}),function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);a>3&&r&&Object.defineProperty(t,n,r)}([Object(y.e)(Ko.a.getSelectedParticleSystem),pl("design:type",_.a)],il.prototype,"particleSystem$",void 0),il),dl=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},ml=((ol=function(){function e(t,n){l(this,e),this.formBuilder=t,this.store=n,this.ngUnsubscribe=new C.a,this.initForm()}return u(e,[{key:"ngOnInit",value:function(){this.initFormListeners(),this.initParticleSystemListeners()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initForm",value:function(){var e=Xr.baseColor,t=Xr.alpha,n=e.r,i=e.g,o=e.b;this.form=this.formBuilder.group({material:this.formBuilder.group({enabled:[!1],color:[[n,i,o,t]]})}),this.setValues(nc())}},{key:"initFormListeners",value:function(){var e=this;this.form.valueChanges.pipe(Object(Un.a)(125),Object(io.a)((function(e,t){return Object(ce.isEqual)(e,t)})),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.setParticleSystem(t)}))}},{key:"initParticleSystemListeners",value:function(){var e=this;this.particleSystem$.pipe(Object(R.a)((function(e){return!Object(ce.isNil)(e)})),Object(io.a)((function(e,t){return Object(ce.isEqual)(e,t)})),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.setValues(t)}))}},{key:"handleResetClick",value:function(){this.reset()}},{key:"setParticleSystem",value:function(e){var t=this.store.selectSnapshot(Ko.a.getSelectedParticleSystem),n=cc(Object.assign(Object.assign({},t),this.getParticleSystemFromForm(e)));this.store.dispatch(new Wo.a.UpdateParticleSystem(n.id,n))}},{key:"setValues",value:function(e){if(this.form){var t=Object.assign(Object.assign({},e),{material:{enabled:!1}});if(e.material){var n=e.material.baseColor,i=e.material.alpha;"number"!=typeof i&&(i=Xr.alpha);var o=n.r,a=n.g,r=n.b;t.material={enabled:!0,color:[o,a,r,i]}}this.form.patchValue(t,{emitEvent:!1,onlySelf:!0})}}},{key:"reset",value:function(){var e=this.store.selectSnapshot(Ko.a.getSelectedParticleSystemId);this.setValues(Object.assign(Object.assign({},nc()),{id:e}))}},{key:"getParticleSystemFromForm",value:function(e){var t=e.material,n=t.enabled,i=r(t.color,4),o=i[0],a=i[1],c=i[2],s=i[3];return{material:n?{baseColor:{r:o,g:a,b:c},alpha:s}:void 0}}}]),e}()).\u0275fac=function(e){return new(e||ol)(ve.Pb(ae.f),ve.Pb(y.h))},ol.\u0275cmp=ve.Jb({type:ol,selectors:[["app-edit-particle-system-material-form"]],decls:11,vars:5,consts:[[3,"label","formGroup"],["list-actions",""],["app-button","",3,"matMenuTriggerFor"],["icon","ellipsis-v"],["actionsMenu","matMenu"],["mat-menu-item","",3,"click"],["formGroupName","material"],["label","Enabled","toggleType","checkbox","formControlName","enabled"],["type","rgba","formControlName","color",3,"decimal","alpha"]],template:function(e,t){if(1&e&&(ve.Vb(0,"app-portal-column",0),ve.Vb(1,"div",1),ve.Vb(2,"button",2),ve.Qb(3,"app-icon",3),ve.Ub(),ve.Vb(4,"mat-menu",null,4),ve.Vb(6,"button",5),ve.cc("click",(function(){return t.handleResetClick()})),ve.Pc(7,"Reset to default"),ve.Ub(),ve.Ub(),ve.Ub(),ve.Tb(8,6),ve.Vb(9,"app-panel",7),ve.Qb(10,"app-color-picker-input",8),ve.Ub(),ve.Sb(),ve.Ub()),2&e){var n=ve.yc(5);ve.mc("label","Material")("formGroup",t.form),ve.Db(2),ve.mc("matMenuTriggerFor",n),ve.Db(8),ve.mc("decimal",!0)("alpha",!0)}},directives:[yc,ae.s,ae.j,Pe.a,Ki.d,yt.a,Ki.a,Ki.b,ae.k,Me.a,ae.r,ae.i,Vt],styles:[""],changeDetection:0}),function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);a>3&&r&&Object.defineProperty(t,n,r)}([Object(y.e)(Ko.a.getSelectedParticleSystem),dl("design:type",_.a)],ol.prototype,"particleSystem$",void 0),ol),hl=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function bl(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"app-portal-item",15),ve.cc("itemClick",(function(e){return ve.Cc(n),ve.gc().loadCreators(e)})),ve.Ub()}if(2&e){var i=t.$implicit,o=ve.gc();ve.mc("label","Creators ("+i.length+")")("hint",o.formatHint(i))}}function fl(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"app-portal-item",15),ve.cc("itemClick",(function(e){return ve.Cc(n),ve.gc().loadUpdaters(e)})),ve.Ub()}if(2&e){var i=t.$implicit,o=ve.gc();ve.mc("label","Updaters ("+i.length+")")("hint",o.formatHint(i))}}function gl(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"app-portal-item",15),ve.cc("itemClick",(function(e){return ve.Cc(n),ve.gc().loadConstraints(e)})),ve.Ub()}if(2&e){var i=t.$implicit,o=ve.gc();ve.mc("label","Constraints ("+i.length+")")("hint",o.formatHint(i))}}var vl,yl=function(){return[]},xl=((vl=function(){function e(t,n,i,o,a,r,c){l(this,e),this.formBuilder=t,this.store=n,this.actions=i,this.dialogService=o,this.particleSystemsService=a,this.eumPrintPipe=r,this.portalComponent=c,this.ngUnsubscribe=new C.a,this.initForm()}return u(e,[{key:"ngOnInit",value:function(){this.initFormListeners(),this.initParticleSystemListeners()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initForm",value:function(){this.form=this.formBuilder.group({name:[""]}),this.setValues(nc())}},{key:"initFormListeners",value:function(){var e=this;this.form.valueChanges.pipe(Object(Un.a)(125),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){var n=e.store.selectSnapshot(Ko.a.getSelectedParticleSystem);t.name!==n.name&&(n.name=t.name,e.store.dispatch(new Wo.a.UpdateParticleSystem(n.id,n)))}))}},{key:"initParticleSystemListeners",value:function(){var e=this;this.particleSystem$.pipe(Object(R.a)((function(e){return!Object(ce.isNil)(e)})),Object(io.a)((function(e,t){return Object(ce.isEqual)(e,t)})),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.setValues(t)})),this.actions.pipe(Object(y.l)(Wo.a.DuplicateParticleSystemSuccess),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.store.dispatch(new Wo.a.SelectParticleSystem(t.id))}))}},{key:"setValues",value:function(e){this.form&&this.form.patchValue(e,{emitEvent:!1,onlySelf:!0})}},{key:"handleDuplicateClick",value:function(){this.duplicateParticleSystem()}},{key:"handleResetClick",value:function(){var e=this,t=this.store.selectSnapshot(Ko.a.getSelectedParticleSystem);this.dialogService.openConfirmDialog({data:{titleText:"Reset Particle System",bodyText:'Would you like to reset Particle System "'.concat(t.id,'"?'),confirmText:"Remove"}}).afterClosed().pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){t&&e.resetParticleSystem()}))}},{key:"handleRemoveClick",value:function(){var e=this,t=this.store.selectSnapshot(Ko.a.getSelectedParticleSystem);this.dialogService.openConfirmDialog({data:{titleText:"Remove Particle System",bodyText:'Would you like to remove Particle System "'.concat(t.id,'" from this chapter?'),confirmText:"Remove"}}).afterClosed().pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){t&&e.removeParticleSystem()}))}},{key:"formatHint",value:function(e){var t=this;return e.map((function(e){return t.eumPrintPipe.transform(e.type)})).join(", ")}},{key:"loadBasic",value:function(e){e.loadComponent(ul)}},{key:"loadMaterial",value:function(e){e.loadComponent(ml)}},{key:"loadSprites",value:function(e){e.loadComponent(Cc)}},{key:"loadProperties",value:function(e){e.loadComponent(bs)}},{key:"loadCreators",value:function(e){e.loadComponent(hs)}},{key:"loadConstraints",value:function(e){e.loadComponent(Vs)}},{key:"loadUpdaters",value:function(e){e.loadComponent(ll)}},{key:"duplicateParticleSystem",value:function(){var e=this.store.selectSnapshot(Ko.a.getSelectedParticleSystemId),t=this.store.selectSnapshot(X.a.getSelectedChapterId);this.particleSystemsService.duplicateParticleSystem(e,t)}},{key:"resetParticleSystem",value:function(){var e=this.store.selectSnapshot(Ko.a.getSelectedParticleSystemId);this.particleSystemsService.resetParticleSystem(e)}},{key:"removeParticleSystem",value:function(){var e=this.store.selectSnapshot(Ko.a.getSelectedParticleSystemId),t=this.store.selectSnapshot(X.a.getSelectedChapterId);this.particleSystemsService.removeChapterParticleSystem(e,t),this.store.dispatch(new Wo.a.SelectParticleSystem(null)),this.portalComponent.back()}}]),e}()).\u0275fac=function(e){return new(e||vl)(ve.Pb(ae.f),ve.Pb(y.h),ve.Pb(y.b),ve.Pb(Bi.a),ve.Pb(Pc),ve.Pb(_c),ve.Pb(Fr))},vl.\u0275cmp=ve.Jb({type:vl,selectors:[["app-edit-particle-systems-form"]],features:[ve.Cb([_c])],decls:30,vars:17,consts:[["list-actions",""],["app-button","",3,"matMenuTriggerFor"],["icon","ellipsis-v"],["actionsMenu","matMenu"],["mat-menu-item","",3,"click"],[3,"formGroup"],["label","Name"],["type","text","formControlName","name",1,"input"],["label","ID"],[1,"text-11"],["label","Quantity",3,"itemClick"],["label","Material",3,"itemClick"],["label","Sprites",3,"itemClick"],["label","Properties",3,"itemClick"],[3,"label","hint","itemClick",4,"ngIf"],[3,"label","hint","itemClick"]],template:function(e,t){if(1&e&&(ve.Vb(0,"app-portal-column"),ve.Vb(1,"div",0),ve.Vb(2,"button",1),ve.Qb(3,"app-icon",2),ve.Ub(),ve.Vb(4,"mat-menu",null,3),ve.Vb(6,"button",4),ve.cc("click",(function(){return t.handleDuplicateClick()})),ve.Pc(7,"Duplicate"),ve.Ub(),ve.Vb(8,"button",4),ve.cc("click",(function(){return t.handleResetClick()})),ve.Pc(9,"Reset to default"),ve.Ub(),ve.Vb(10,"button",4),ve.cc("click",(function(){return t.handleRemoveClick()})),ve.Pc(11,"Remove"),ve.Ub(),ve.Ub(),ve.Ub(),ve.Tb(12),ve.Vb(13,"app-panel",5),ve.Vb(14,"app-form-field",6),ve.Qb(15,"input",7),ve.Ub(),ve.Vb(16,"app-form-field",8),ve.Vb(17,"span",9),ve.Pc(18),ve.hc(19,"async"),ve.Ub(),ve.Ub(),ve.Ub(),ve.Vb(20,"app-portal-item",10),ve.cc("itemClick",(function(e){return t.loadBasic(e)})),ve.Ub(),ve.Vb(21,"app-portal-item",11),ve.cc("itemClick",(function(e){return t.loadMaterial(e)})),ve.Ub(),ve.Vb(22,"app-portal-item",12),ve.cc("itemClick",(function(e){return t.loadSprites(e)})),ve.Ub(),ve.Vb(23,"app-portal-item",13),ve.cc("itemClick",(function(e){return t.loadProperties(e)})),ve.Ub(),ve.Nc(24,bl,1,2,"app-portal-item",14),ve.hc(25,"async"),ve.Nc(26,fl,1,2,"app-portal-item",14),ve.hc(27,"async"),ve.Nc(28,gl,1,2,"app-portal-item",14),ve.hc(29,"async"),ve.Sb(),ve.Ub()),2&e){var n,i,o,a,r=ve.yc(5);ve.Db(2),ve.mc("matMenuTriggerFor",r),ve.Db(11),ve.mc("formGroup",t.form),ve.Db(5),ve.Qc(null==(n=ve.ic(19,6,t.particleSystem$))?null:n.id),ve.Db(6),ve.mc("ngIf",(null==(i=ve.ic(25,8,t.particleSystem$))?null:i.creators)||ve.oc(14,yl)),ve.Db(2),ve.mc("ngIf",(null==(o=ve.ic(27,10,t.particleSystem$))?null:o.updaters)||ve.oc(15,yl)),ve.Db(2),ve.mc("ngIf",(null==(a=ve.ic(29,12,t.particleSystem$))?null:a.constraints)||ve.oc(16,yl))}},directives:[yc,Pe.a,Ki.d,yt.a,Ki.a,Ki.b,Me.a,ae.s,ae.j,Oe.a,ae.c,ae.r,ae.i,Zc,f.p],pipes:[f.b],styles:[""],changeDetection:0}),function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);a>3&&r&&Object.defineProperty(t,n,r)}([Object(y.e)(Ko.a.getSelectedParticleSystem),hl("design:type",_.a)],vl.prototype,"particleSystem$",void 0),vl),Cl=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function kl(e,t){if(1&e&&(ve.Vb(0,"button",19),ve.Pc(1," Apply Existing "),ve.Ub()),2&e){ve.gc();var n=ve.yc(26);ve.mc("matMenuTriggerFor",n)}}function Pl(e,t){if(1&e&&(ve.Vb(0,"button",19),ve.Pc(1," Duplicate Existing "),ve.Ub()),2&e){ve.gc();var n=ve.yc(29);ve.mc("matMenuTriggerFor",n)}}function Ol(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"button",5),ve.cc("click",(function(){return ve.Cc(n),ve.gc().handleRemoveAllAssignClick()})),ve.Pc(1," Remove All "),ve.Ub()}}function wl(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"app-portal-item",21),ve.cc("click",(function(){ve.Cc(n);var e=t.$implicit;return ve.gc(2).handleParticleSystemClick(e)})),ve.Vb(1,"div",22),ve.Vb(2,"button",23),ve.cc("click",(function(){ve.Cc(n);var e=t.$implicit;return ve.gc(2).handleToggleParticleSystemVisible(e)})),ve.Qb(3,"app-icon",24),ve.Ub(),ve.Vb(4,"button",25),ve.Qb(5,"app-icon",3),ve.Ub(),ve.Vb(6,"mat-menu",null,26),ve.Vb(8,"button",5),ve.cc("click",(function(){ve.Cc(n);var e=t.$implicit;return ve.gc(2).handleDuplicateSystemClick(e)})),ve.Pc(9,"Duplicate"),ve.Ub(),ve.Vb(10,"button",5),ve.cc("click",(function(){ve.Cc(n);var e=t.$implicit;return ve.gc(2).handleResetParticleClick(e)})),ve.Pc(11,"Reset"),ve.Ub(),ve.Vb(12,"button",5),ve.cc("click",(function(){ve.Cc(n);var e=t.$implicit;return ve.gc(2).handleRemoveAssignClick(e)})),ve.Pc(13,"Remove"),ve.Ub(),ve.Ub(),ve.Ub(),ve.Ub()}if(2&e){var i=t.$implicit,o=ve.yc(7),a=ve.gc(2);ve.mc("label",a.getSystemLabel(i))("active",a.isSystemVisible(i)),ve.Db(3),ve.mc("icon",a.isSystemVisible(i)?"eye":"eye-slash"),ve.Db(1),ve.mc("matMenuTriggerFor",o)}}function Sl(e,t){if(1&e&&(ve.Tb(0),ve.Nc(1,wl,14,4,"app-portal-item",20),ve.Sb()),2&e){var n=ve.gc();ve.Db(1),ve.mc("ngForOf",n.assignedParticleSystem)}}function _l(e,t){1&e&&(ve.Vb(0,"div",27),ve.Pc(1," There are no particle systems in this chapter. "),ve.Ub())}function Ml(e,t){if(1&e&&(ve.Vb(0,"button",19),ve.Pc(1," Apply Existing "),ve.Ub()),2&e){ve.gc();var n=ve.yc(26);ve.mc("matMenuTriggerFor",n)}}function Ul(e,t){if(1&e&&(ve.Vb(0,"button",19),ve.Pc(1," Duplicate Existing "),ve.Ub()),2&e){ve.gc();var n=ve.yc(29);ve.mc("matMenuTriggerFor",n)}}function Tl(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"button",5),ve.cc("click",(function(){ve.Cc(n);var e=t.$implicit;return ve.gc().handleApplyParticleClick(e)})),ve.Pc(1),ve.Ub()}if(2&e){var i=t.$implicit;ve.Db(1),ve.Rc(" ",i.id," ")}}function Vl(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"button",5),ve.cc("click",(function(){ve.Cc(n);var e=t.$implicit;return ve.gc().handleDuplicacteParticleClick(e)})),ve.Pc(1),ve.Ub()}if(2&e){var i=t.$implicit;ve.Db(1),ve.Rc(" ",i.id," ")}}var Dl,El=((Dl=function(){function e(t,n,i,o,a,r){l(this,e),this.store=t,this.actions=n,this.changeRef=i,this.particleSystemsService=o,this.dialogService=a,this.portalComponent=r,this.particleSystems=[],this.assignedParticleSystem=[],this.unassignedParticleSystem=[],this.particleSystemSelected=new ve.p,this.chapterParticles=[],this.ngUnsubscribe=new C.a}return u(e,[{key:"ngOnInit",value:function(){this.initParticleListListeners()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initParticleListListeners",value:function(){var e=this,t=this.store.select(Ko.a.getParticleSystemsList),n=this.store.select(X.a.getSelectedChapterId),i=this.store.select(Ko.a.getAssignedParticleSystems);Object(O.b)(t,i,n).pipe(Object(R.a)((function(e){var t=r(e,3);return t[0],t[1],!!t[2]})),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){var n=r(t,3),i=n[0],o=n[1][n[2]]||[];e.particleSystems=i,e.assignedParticleSystem=o.map((function(e){return i.find((function(t){return t.id===e}))})),e.unassignedParticleSystem=i.filter((function(e){return!o.includes(e.id)})),e.changeRef.markForCheck()})),this.actions.pipe(Object(y.l)(Wo.a.UnassignParticle),Object(N.a)(this.ngUnsubscribe)).subscribe((function(){var t=e.store.selectSnapshot(Ko.a.getParticleSystems),n=e.store.selectSnapshot(Ko.a.getAssignedParticleSystems),i=Object.keys(t),o=Object.values(n).reduce((function(e,t){return e.concat(t)}),[]),a=i.filter((function(e){return!o.includes(e)}));a.length>0&&(a.forEach((function(t){e.store.dispatch(new Wo.a.DeleteParticleSystem(t))})),e.changeRef.markForCheck())}))}},{key:"handleParticleSystemClick",value:function(e){this.particleSystemSelected.emit(e),this.store.dispatch(new Wo.a.SelectParticleSystem(e.id)),this.portalComponent.loadComponent(xl)}},{key:"handleDuplicateSystemClick",value:function(e){this.duplicateParticleSystem(e)}},{key:"handleRemoveAllAssignClick",value:function(){var e=this;this.dialogService.openConfirmDialog({data:{titleText:"Remove Particle Systems",bodyText:"Would you like to remove all Particle Systems from this chapter?",confirmText:"Remove All"}}).afterClosed().pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){t&&e.removeAllParticleAssignments()}))}},{key:"handleRemoveAssignClick",value:function(e){var t=this;this.dialogService.openConfirmDialog({data:{titleText:"Remove Particle System",bodyText:'Would you like to remove Particle System "'.concat(e.id,'" from this chapter?'),confirmText:"Remove"}}).afterClosed().pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(n){n&&t.removeChapterParticleSystem(e.id)}))}},{key:"handleCreateParticleClick",value:function(){this.createParticleSystem()}},{key:"handleApplyParticleClick",value:function(e){this.addChapterParticleSystem(e.id)}},{key:"handleDuplicacteParticleClick",value:function(e){this.duplicateParticleSystem(e)}},{key:"handleResetParticleClick",value:function(e){var t=this;this.dialogService.openConfirmDialog({data:{titleText:"Reset Particle System",bodyText:'Would you like to reset Particle System "'.concat(e.id,'"?'),confirmText:"Reset"}}).afterClosed().pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(n){n&&t.resetParticleSystem(e)}))}},{key:"handleToggleParticleSystemVisible",value:function(e){this.toggleParticleSystemVisible(e)}},{key:"isSystemVisible",value:function(e){var t=this.store.selectSnapshot(X.a.getSelectedChapterId);return this.particleSystemsService.isParticleSystemVisible(e.id,t)}},{key:"getSystemLabel",value:function(e){return e.name?"**".concat(e.name,"**\n\n").concat(e.id):e.id}},{key:"createParticleSystem",value:function(){var e=this.store.selectSnapshot(X.a.getSelectedChapterId);this.particleSystemsService.createParticleSystem(e)}},{key:"resetParticleSystem",value:function(e){this.particleSystemsService.resetParticleSystem(e.id)}},{key:"removeAllParticleAssignments",value:function(){var e=this.store.selectSnapshot(X.a.getSelectedChapterId);this.particleSystemsService.removeAllChapterParticleSystem(e)}},{key:"addChapterParticleSystem",value:function(e){var t=this.store.selectSnapshot(X.a.getSelectedChapterId);this.particleSystemsService.addChapterParticleSystem(e,t)}},{key:"removeChapterParticleSystem",value:function(e){var t=this.store.selectSnapshot(X.a.getSelectedChapterId);this.particleSystemsService.removeChapterParticleSystem(e,t)}},{key:"duplicateParticleSystem",value:function(e){var t=this.store.selectSnapshot(X.a.getSelectedChapterId);this.particleSystemsService.duplicateParticleSystem(e.id,t)}},{key:"toggleParticleSystemVisible",value:function(e){var t=this.store.selectSnapshot(X.a.getSelectedChapterId);this.particleSystemsService.toggleParticleSystemVisible(e.id,t)}}]),e}()).\u0275fac=function(e){return new(e||Dl)(ve.Pb(y.h),ve.Pb(y.b),ve.Pb(ve.i),ve.Pb(Pc),ve.Pb(Bi.a),ve.Pb(Fr))},Dl.\u0275cmp=ve.Jb({type:Dl,selectors:[["app-edit-particle-systems-list"]],outputs:{particleSystemSelected:"particleSystemSelected"},decls:32,vars:13,consts:[["label","Particle Systems"],["list-actions",""],["app-button","",3,"matMenuTriggerFor"],["icon","ellipsis-v"],["particleListSystemsMenu","matMenu"],["mat-menu-item","",3,"click"],["mat-menu-item","",3,"matMenuTriggerFor",4,"ngIf"],["mat-menu-item","",3,"click",4,"ngIf"],[1,"list"],[1,"list__content"],[4,"ngIf"],[1,"flex","flex-column","items-center","mv-2"],["class","list__message text-12 text-center mv-4",4,"ngIf"],["app-button","","buttonType","outline",3,"matMenuTriggerFor"],["icon","angle-down"],["particleCreateSystemsMenu","matMenu"],["applySystemsMenu","matMenu"],["mat-menu-item","",3,"click",4,"ngFor","ngForOf"],["duplicateSystemsMenu","matMenu"],["mat-menu-item","",3,"matMenuTriggerFor"],[3,"label","active","click",4,"ngFor","ngForOf"],[3,"label","active","click"],["item-actions",""],["app-button","","buttonSize","xsmall",3,"click"],[3,"icon"],["app-button","","buttonSize","xsmall",3,"matMenuTriggerFor"],["systemActions","matMenu"],[1,"list__message","text-12","text-center","mv-4"]],template:function(e,t){if(1&e&&(ve.Vb(0,"app-portal-column",0),ve.Vb(1,"div",1),ve.Vb(2,"button",2),ve.Qb(3,"app-icon",3),ve.Ub(),ve.Vb(4,"mat-menu",null,4),ve.Vb(6,"button",5),ve.cc("click",(function(){return t.handleCreateParticleClick()})),ve.Pc(7,"Create new"),ve.Ub(),ve.Nc(8,kl,2,1,"button",6),ve.Nc(9,Pl,2,1,"button",6),ve.Nc(10,Ol,2,0,"button",7),ve.Ub(),ve.Ub(),ve.Vb(11,"div",8),ve.Vb(12,"div",9),ve.Nc(13,Sl,2,1,"ng-container",10),ve.Vb(14,"div",11),ve.Nc(15,_l,2,0,"div",12),ve.Vb(16,"button",13),ve.Pc(17," Add Particle System "),ve.Qb(18,"app-icon",14),ve.Ub(),ve.Vb(19,"mat-menu",null,15),ve.Vb(21,"button",5),ve.cc("click",(function(){return t.handleCreateParticleClick()})),ve.Pc(22,"Create new"),ve.Ub(),ve.Nc(23,Ml,2,1,"button",6),ve.Nc(24,Ul,2,1,"button",6),ve.Ub(),ve.Ub(),ve.Vb(25,"mat-menu",null,16),ve.Nc(27,Tl,2,1,"button",17),ve.Ub(),ve.Vb(28,"mat-menu",null,18),ve.Nc(30,Vl,2,1,"button",17),ve.hc(31,"async"),ve.Ub(),ve.Ub(),ve.Ub(),ve.Ub()),2&e){var n=ve.yc(5),i=ve.yc(20);ve.Db(2),ve.mc("matMenuTriggerFor",n),ve.Db(6),ve.mc("ngIf",t.unassignedParticleSystem.length),ve.Db(1),ve.mc("ngIf",t.particleSystems.length),ve.Db(1),ve.mc("ngIf",t.assignedParticleSystem.length>0),ve.Db(3),ve.mc("ngIf",t.assignedParticleSystem.length>0),ve.Db(2),ve.mc("ngIf",0===t.assignedParticleSystem.length),ve.Db(1),ve.mc("matMenuTriggerFor",i),ve.Db(7),ve.mc("ngIf",t.unassignedParticleSystem.length),ve.Db(1),ve.mc("ngIf",t.particleSystems.length),ve.Db(3),ve.mc("ngForOf",t.unassignedParticleSystem),ve.Db(3),ve.mc("ngForOf",ve.ic(31,11,t.particleSystems$))}},directives:[yc,Pe.a,Ki.d,yt.a,Ki.a,Ki.b,f.p,f.o,Zc],pipes:[f.b],styles:[".list[_ngcontent-%COMP%]{height:100%}.list__content[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column}.list__message[_ngcontent-%COMP%]{color:#61779e}"],changeDetection:0}),function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);a>3&&r&&Object.defineProperty(t,n,r)}([Object(y.e)(Ko.a.getParticleSystemsList),Cl("design:type",_.a)],Dl.prototype,"particleSystems$",void 0),Dl),jl=function e(){l(this,e)};function Nl(e,t){1&e&&(ve.Vb(0,"mat-checkbox",6),ve.Pc(1,"Moving Forwards"),ve.Ub())}function Rl(e,t){1&e&&(ve.Vb(0,"mat-checkbox",7),ve.Pc(1,"Moving Backwards"),ve.Ub())}function Al(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"button",18),ve.cc("click",(function(){ve.Cc(n);var e=ve.gc(2);return e.handleShowClick(e.transition)})),ve.Pc(1," Preview "),ve.Ub()}}function Fl(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"button",18),ve.cc("click",(function(){return ve.Cc(n),ve.gc(2).handleRemovePositionClick()})),ve.Pc(1," Remove "),ve.Ub()}}function Il(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"div"),ve.Vb(1,"app-form-field",8),ve.Qb(2,"app-color-picker-input",9),ve.Ub(),ve.Vb(3,"app-form-field",10),ve.Vb(4,"div",11),ve.Qb(5,"input",12),ve.Vb(6,"app-button-group"),ve.Vb(7,"button",13),ve.cc("click",(function(){return ve.Cc(n),ve.gc().handleSecondClick(1)})),ve.Pc(8," 1s "),ve.Ub(),ve.Vb(9,"button",13),ve.cc("click",(function(){return ve.Cc(n),ve.gc().handleSecondClick(2)})),ve.Pc(10," 2s "),ve.Ub(),ve.Vb(11,"button",13),ve.cc("click",(function(){return ve.Cc(n),ve.gc().handleSecondClick(3)})),ve.Pc(12," 3s "),ve.Ub(),ve.Ub(),ve.Ub(),ve.Ub(),ve.Vb(13,"app-form-field",14),ve.Vb(14,"button",15),ve.cc("click",(function(){return ve.Cc(n),ve.gc().handleRecordPositionClick()})),ve.Pc(15," Capture Position "),ve.Ub(),ve.Vb(16,"app-button-group",16),ve.Nc(17,Al,2,0,"button",17),ve.Nc(18,Fl,2,0,"button",17),ve.Ub(),ve.Ub(),ve.Ub()}if(2&e){var i=ve.gc();ve.Db(7),ve.mc("uppercase",!1),ve.Db(2),ve.mc("uppercase",!1),ve.Db(2),ve.mc("uppercase",!1),ve.Db(6),ve.mc("ngIf",i.transition.camera),ve.Db(1),ve.mc("ngIf",i.transition.camera)}}var zl,Ll=((zl=function(){function e(t,n,i,o,a){l(this,e),this.formBuilder=t,this.store=n,this.cameraService=i,this.matSnackBar=o,this.changeDetectorRef=a,this._transition=new jl,this.transitionChange=new ve.p,this._settings={onNext:!0,onPrevious:!0},this.ngUnsubscribe=new C.a;var r=new jl;this.form=this.formBuilder.group({fadeColor:"",duration:0,onNext:r.onNext,onPrevious:r.onPrevious})}return u(e,[{key:"transition",get:function(){return this._transition},set:function(e){Object(ce.isEqual)(e,this._transition)||(this._transition=Object.assign({},e),this.setFormValues(e),this.transitionChange.emit(this.transition),this.changeDetectorRef.markForCheck())}},{key:"settings",get:function(){return this._settings},set:function(e){Object(ce.isEqual)(e,this._settings)||(this._settings=Object.assign(Object.assign({},this._settings),e),this.changeDetectorRef.markForCheck())}},{key:"ngOnInit",value:function(){var e=this;this.form.valueChanges.pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){return e.handleFormChanges(t)}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"handleShowClick",value:function(e){this.store.dispatch(new Z.l(e.camera,!0,e.duration))}},{key:"handleRecordPositionClick",value:function(){this.transition=Object.assign(Object.assign({},this.transition),{camera:this.cameraService.getCamera()}),this.matSnackBar.open("Position captured")}},{key:"handleRemovePositionClick",value:function(){this.transition=Object.assign(Object.assign({},this.transition),{camera:null}),this.matSnackBar.open("Position removed")}},{key:"handleFormChanges",value:function(e){var t=Object.assign(Object.assign({},this.transition),{fadeColor:e.fadeColor,onNext:e.onNext,onPrevious:e.onPrevious,duration:e.duration});this.transition=t}},{key:"handleSecondClick",value:function(e){this.form.patchValue({duration:e})}},{key:"setFormValues",value:function(e){var t=Object.assign({duration:2,fadeColor:"",onNext:!1,onPrevious:!1},e);this.form.setValue({fadeColor:t.fadeColor,duration:t.duration,onNext:t.onNext,onPrevious:t.onPrevious})}}]),e}()).\u0275fac=function(e){return new(e||zl)(ve.Pb(ae.f),ve.Pb(y.h),ve.Pb(zi.a),ve.Pb(ke.b),ve.Pb(ve.i))},zl.\u0275cmp=ve.Jb({type:zl,selectors:[["app-edit-transition-form"]],inputs:{transition:"transition",settings:"settings"},outputs:{transitionChange:"transitionChange"},decls:6,vars:4,consts:[["autocomplete","off",3,"formGroup"],["label","Enable"],[1,"text-12","flex","flex-column"],["formControlName","onNext",4,"ngIf"],["formControlName","onPrevious",4,"ngIf"],[4,"ngIf"],["formControlName","onNext"],["formControlName","onPrevious"],["label","Fade"],["formControlName","fadeColor"],["label","Duration (Seconds)"],[1,"flex"],["type","number","min","0","step",".1","formControlName","duration","required","",1,"input","w-25","mr-2"],["app-button","","buttonType","outline",3,"uppercase","click"],["label","Position"],["app-button","","buttonType","outline","buttonSize","small",1,"w-100","mb-2",3,"click"],["render","block"],["app-button","","buttonType","outline","buttonSize","small","class","w-100",3,"click",4,"ngIf"],["app-button","","buttonType","outline","buttonSize","small",1,"w-100",3,"click"]],template:function(e,t){1&e&&(ve.Vb(0,"form",0),ve.Vb(1,"app-form-field",1),ve.Vb(2,"div",2),ve.Nc(3,Nl,2,0,"mat-checkbox",3),ve.Nc(4,Rl,2,0,"mat-checkbox",4),ve.Ub(),ve.Ub(),ve.Nc(5,Il,19,5,"div",5),ve.Ub()),2&e&&(ve.mc("formGroup",t.form),ve.Db(3),ve.mc("ngIf",t.settings.onNext),ve.Db(1),ve.mc("ngIf",t.settings.onPrevious),ve.Db(1),ve.mc("ngIf",t.settings.onNext&&t.transition.onNext||t.settings.onPrevious&&t.transition.onPrevious))},directives:[ae.E,ae.s,ae.j,Oe.a,f.p,Ue.a,ae.r,ae.i,Vt,ae.w,ae.c,ae.A,ea,Pe.a],styles:[""],changeDetection:0}),zl),Bl=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Ql=function(){return{onNext:!0,onPrevious:!1}},$l=function(){return{onNext:!1,onPrevious:!0}};function ql(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"app-tabs",2),ve.Vb(1,"app-tab",3),ve.Vb(2,"div",4),ve.Vb(3,"app-edit-transition-form",5),ve.cc("transitionChange",(function(e){return ve.Cc(n),ve.gc().handleTransitionChange(e,"post")})),ve.Ub(),ve.Ub(),ve.Ub(),ve.Vb(4,"app-tab",6),ve.Vb(5,"div",4),ve.Vb(6,"app-edit-transition-form",5),ve.cc("transitionChange",(function(e){return ve.Cc(n),ve.gc().handleTransitionChange(e,"pre")})),ve.Ub(),ve.Ub(),ve.Ub(),ve.Ub()}if(2&e){var i=ve.gc();ve.Db(3),ve.mc("settings",ve.oc(4,Ql))("transition",i.postTransition),ve.Db(3),ve.mc("settings",ve.oc(5,$l))("transition",i.preTransition)}}var Gl,Hl,Wl=((Gl=function(){function e(t,n){l(this,e),this.changeDetectorRef=t,this.store=n,this.ngUnsubscribe=new C.a}return u(e,[{key:"ngOnInit",value:function(){var e=this;this.chapter$.pipe(Object(R.a)((function(e){return null!=e})),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.postTransition=Object(ce.get)(t,"transitions.post")||new jl,e.preTransition=Object(ce.get)(t,"transitions.pre")||new jl,e.changeDetectorRef.markForCheck()}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"handleTransitionChange",value:function(e,t){var n=this.store.selectSnapshot(X.a.getSelectedChapter);this.store.dispatch(new J.E(n.id,e,t))}}]),e}()).\u0275fac=function(e){return new(e||Gl)(ve.Pb(ve.i),ve.Pb(y.h))},Gl.\u0275cmp=ve.Jb({type:Gl,selectors:[["app-edit-transition"]],decls:4,vars:3,consts:[["label","Transitions"],["tabSize","small","tabTheme","dark",4,"ngIf"],["tabSize","small","tabTheme","dark"],["label","Post-Chapter"],[1,"pt-1"],[3,"settings","transition","transitionChange"],["label","Pre-Chapter"]],template:function(e,t){1&e&&(ve.Vb(0,"app-portal-column",0),ve.Vb(1,"app-panel"),ve.Nc(2,ql,7,6,"app-tabs",1),ve.hc(3,"async"),ve.Ub(),ve.Ub()),2&e&&(ve.Db(2),ve.mc("ngIf",ve.ic(3,1,t.chapter$)))},directives:[yc,Me.a,f.p,_o.a,Mo.a,Ll],pipes:[f.b],styles:[""],changeDetection:0}),function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);a>3&&r&&Object.defineProperty(t,n,r)}([Object(y.e)(X.a.getSelectedChapter),Bl("design:type",_.a)],Gl.prototype,"chapter$",void 0),Gl),Kl=function(e){return e.Alpha="alpha",e.ImprovedAlpha="improvedAlpha",e.AddAlpha="addAlpha",e.AlphaToCoverage="alphaToCoverage",e.WeightedOIT="weightedOIT",e}({}),Jl=((Hl=function(){function e(t,n){l(this,e),this.formBuilder=t,this.store=n,this.transparencyModes=Kl,this.ngUnsubscribe=new C.a,this.form=this.formBuilder.group({mode:[Kl.Alpha]})}return u(e,[{key:"ngOnInit",value:function(){var e=this;this.store.select(X.a.getSelectedChapterId).pipe(Object(j.a)((function(){return e.store.selectSnapshot(X.a.getSelectedChapter)})),Object(R.a)((function(e){return!Object(ce.isNil)(e)})),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.setFormValue(t.transparencyMode)})),this.form.valueChanges.pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.setTransparencyMode(t.mode)}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"setFormValue",value:function(e){this.form.setValue({mode:e},{emitEvent:!1})}},{key:"setTransparencyMode",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.store.dispatch(new q.O(e)),t&&this.setChapterTransparencyMode(e)}},{key:"setChapterTransparencyMode",value:function(e){var t=this.store.selectSnapshot(X.a.getSelectedChapter);this.store.dispatch(new J.F(t.id,e))}}]),e}()).\u0275fac=function(e){return new(e||Hl)(ve.Pb(ae.f),ve.Pb(y.h))},Hl.\u0275cmp=ve.Jb({type:Hl,selectors:[["app-edit-transparency-mode"]],decls:14,vars:7,consts:[["label","Transparency Mode"],[3,"open"],[3,"formGroup"],["formControlName","mode",1,"input"],[3,"ngValue"]],template:function(e,t){1&e&&(ve.Vb(0,"app-portal-column",0),ve.Vb(1,"app-panel",1),ve.Vb(2,"form",2),ve.Vb(3,"select",3),ve.Vb(4,"option",4),ve.Pc(5,"Alpha (Default)"),ve.Ub(),ve.Vb(6,"option",4),ve.Pc(7,"Improved Alpha"),ve.Ub(),ve.Vb(8,"option",4),ve.Pc(9,"Add Alpha"),ve.Ub(),ve.Vb(10,"option",4),ve.Pc(11,"Alpha To Coverage"),ve.Ub(),ve.Vb(12,"option",4),ve.Pc(13,"Weighted OIT"),ve.Ub(),ve.Ub(),ve.Ub(),ve.Ub(),ve.Ub()),2&e&&(ve.Db(1),ve.mc("open",!0),ve.Db(1),ve.mc("formGroup",t.form),ve.Db(2),ve.mc("ngValue",t.transparencyModes.Alpha),ve.Db(2),ve.mc("ngValue",t.transparencyModes.ImprovedAlpha),ve.Db(2),ve.mc("ngValue",t.transparencyModes.AddAlpha),ve.Db(2),ve.mc("ngValue",t.transparencyModes.AlphaToCoverage),ve.Db(2),ve.mc("ngValue",t.transparencyModes.WeightedOIT))},directives:[yc,Me.a,ae.E,ae.s,ae.j,ae.B,ae.r,ae.i,ae.v,ae.D],styles:[""],changeDetection:0}),Hl),Xl=o("ZriC"),Zl=(d(b={},Xl.a.SSAO,{effect:Xl.a.SSAO,sampleRadius:1.2,intensity:50,bias:.1,scale:.3,cutoff:0}),d(b,Xl.a.Blur,{effect:Xl.a.Blur,blur:.1}),d(b,Xl.a.RadialBlur,{effect:Xl.a.RadialBlur,radius:.1,center:[0,0],blur:.25}),d(b,Xl.a.DOF,{effect:Xl.a.DOF,focusStart:0,focusEnd:5,blur:.5}),d(b,Xl.a.FXAA,{effect:Xl.a.FXAA}),d(b,Xl.a.GroundShadow,{effect:Xl.a.GroundShadow,blur:.5,opacity:1,xPos:0,yPos:0,zPos:0,size:10}),b);function Yl(e,t){var n=Zl[e],i=Object.keys(n).reduce((function(e,n){var i=t[n];return void 0!==i&&(e[n]=i),e}),{});return Object.assign(Object.assign({effect:e},n),i)}var ep,tp=function(e){return e[e.FOG_LINEAR=1]="FOG_LINEAR",e[e.FOG_EXP=2]="FOG_EXP",e[e.FOG_EXP2=3]="FOG_EXP2",e}({}),np={"fog.enabled":!1,"fog.density":1,"fog.color":[.96,.96,.96],"fog.start":0,"fog.end":50,"fog.mode":tp.FOG_LINEAR,"fog.min":0,"fog.max":.75},ip=ue.a.rgbToHex(np["fog.color"],!0),op=((ep=function(){function e(t,n){l(this,e),this.formBuilder=t,this.store=n,this.fogModes=tp,this.ngUnsubscribe=new C.a,this._defaultChapterEffects=[],this._defaultChapterProperties={},this.form=this.formBuilder.group({saoEnabled:!1,blurEnabled:!1,radialBlurEnabled:!1,dofEnabled:!1,fogEnabled:!1,groundShadowEnabled:!1,sao:this.formBuilder.group(Object.assign({},Zl.sao)),blur:this.formBuilder.group(Object.assign({},Zl.blur)),radialBlur:this.formBuilder.group(Object.assign(Object.assign({},Zl.radialBlur),{center:this.formBuilder.array(a(Zl.radialBlur.center))})),dof:this.formBuilder.group(Object.assign({},Zl.dof)),fog:this.formBuilder.group(Object.assign(Object.assign({},np),{"fog.color":ip})),groundShadow:this.formBuilder.group(Object.assign({},Zl.groundShadow))})}return u(e,[{key:"ngOnInit",value:function(){this.initEvents()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initEvents",value:function(){var e=this;this.store.select(X.a.getSelectedChapterId).pipe(Object(j.a)((function(){return e.store.selectSnapshot(X.a.getSelectedChapter)})),Object(R.a)((function(e){return!Object(ce.isNil)(e)})),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e._defaultChapterEffects=(t.customData||{postprocess:[]}).postprocess||[],e._defaultChapterProperties=t.properties||{},e.setFormValues(e._defaultChapterEffects,e._defaultChapterProperties)})),this.form.valueChanges.pipe(Object(Un.a)(100),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.handleFormChanges(t)}))}},{key:"handleFormChanges",value:function(e){var t=this.getEffectFormValues(e),n=this.getFogEffectFormValues(e);this.applyEffects(t,n)}},{key:"setFormValues",value:function(e,t){var n=this;this.clearEffectsForm(),e.forEach((function(e){n.setEffectFormValues(e,!0)})),this.setFogEffectFormValues(t)}},{key:"setEffectFormValues",value:function(e,t){var n,i=e.effect;this.form.patchValue((d(n={},i+"Enabled",t),d(n,i,e),n),{emitEvent:!1})}},{key:"clearEffectsForm",value:function(){var e=this;Object.values(Zl).forEach((function(t){e.setEffectFormValues(t,!1)})),this.setFogEffectFormValues(Object.assign(Object.assign({},np),{"fog.enabled":!1}))}},{key:"getEffectFormValues",value:function(e){var t=[],n=e.saoEnabled,i=e.blurEnabled,o=e.radialBlurEnabled,a=e.dofEnabled,r=e.groundShadowEnabled,c=e.sao,s=e.blur,l=e.radialBlur,p=e.dof,u=e.groundShadow;return n&&t.push(Yl(Xl.a.SSAO,c)),i&&t.push(Yl(Xl.a.Blur,s)),o&&t.push(Yl(Xl.a.RadialBlur,l)),a&&t.push(Yl(Xl.a.DOF,p)),r&&t.push(Yl(Xl.a.GroundShadow,u)),t.length>0&&t.push(Zl.fxaa),t}},{key:"setFogEffectFormValues",value:function(e){var t=this.createFogEffect(e),n=t["fog.enabled"],i=ue.a.rgbToHex(t["fog.color"],!0);this.form.patchValue({fogEnabled:n,fog:Object.assign(Object.assign({},t),{"fog.color":i})},{emitEvent:!1})}},{key:"getFogEffectFormValues",value:function(e){var t=e.fogEnabled,n=e.fog;return Object.assign(Object.assign({},this.createFogEffect(n)),{"fog.enabled":t})}},{key:"applyEffects",value:function(e,t){var n=Object.assign({},t);this.store.dispatch(new q.K(e)),this.store.dispatch(new q.L(n));var i=this.store.selectSnapshot(X.a.getSelectedChapter);this.store.dispatch(new J.B(i.id,e,n))}},{key:"createFogEffect",value:function(e){var t=Object.entries(np).reduce((function(t,n){var i=r(n,2),o=i[0],a=(i[1],e[o]);return Object(ce.isNil)(a)||(t[o]=a),t}),Object.assign({},np)),n=e["fog.color"];return Object(ce.isNil)(n)||"string"!=typeof n||(t["fog.color"]=ue.a.hexToRgb(n,!0)),t}}]),e}()).\u0275fac=function(e){return new(e||ep)(ve.Pb(ae.f),ve.Pb(y.h))},ep.\u0275cmp=ve.Jb({type:ep,selectors:[["app-edit-post-processing"]],decls:64,vars:73,consts:[["label","PostProcessing",3,"formGroup"],["label","Ambient Occlusion","toggleType","checkbox","formControlName","saoEnabled","formGroupName","sao"],["label","Sample Radius"],["formControlName","sampleRadius",3,"min","max","step"],["label","Intensity"],["formControlName","intensity",3,"min","max","step"],["label","Bias"],["formControlName","bias",3,"min","max","step"],["label","Scale"],["formControlName","scale",3,"min","max","step"],["label","Cutoff"],["formControlName","cutoff",3,"min","max","step"],["label","Blur","toggleType","checkbox","formControlName","blurEnabled","formGroupName","blur"],["label","Blur"],["formControlName","blur",3,"min","max","step"],["label","Radial Blur","toggleType","checkbox","formControlName","radialBlurEnabled","formGroupName","radialBlur"],["label","Radius"],["formControlName","radius",3,"min","max","step"],["formArrayName","center"],["label","Center X"],["formControlName","0",3,"min","max","step"],["label","Center Y"],["formControlName","1",3,"min","max","step"],["label","Depth of Field","toggleType","checkbox","formControlName","dofEnabled","formGroupName","dof"],["label","Focus Start"],["formControlName","focusStart",3,"min","max","step"],["label","Focus End"],["formControlName","focusEnd",3,"min","max","step"],["label","Fog","toggleType","checkbox","formControlName","fogEnabled","formGroupName","fog","dataTestAttributeVal","fogPanel"],["label","Mode"],["formControlName","fog.mode",1,"input"],[3,"ngValue"],["label","Color"],["formControlName","fog.color","dataTestAttributeVal","fogColor"],["label","Density"],["formControlName","fog.density",3,"min","max","step"],["label","Start"],["formControlName","fog.start",3,"min","max","step"],["label","End"],["formControlName","fog.end",3,"min","max","step"],["label","Min"],["formControlName","fog.min",3,"min","max","step"],["label","Max"],["formControlName","fog.max",3,"min","max","step"],["label","Ground Shadow","toggleType","checkbox","formControlName","groundShadowEnabled","formGroupName","groundShadow"],["label","Blur Intensity"],["label","X Position"],["formControlName","xPos",3,"min","max","step"],["label","Y Position"],["formControlName","yPos",3,"min","max","step"],["label","Z Position"],["formControlName","zPos",3,"min","max","step"],["label","Size"],["formControlName","size",3,"min","max","step"]],template:function(e,t){1&e&&(ve.Vb(0,"app-portal-column",0),ve.Vb(1,"app-panel",1),ve.Vb(2,"app-form-field",2),ve.Qb(3,"app-slider",3),ve.Ub(),ve.Vb(4,"app-form-field",4),ve.Qb(5,"app-slider",5),ve.Ub(),ve.Vb(6,"app-form-field",6),ve.Qb(7,"app-slider",7),ve.Ub(),ve.Vb(8,"app-form-field",8),ve.Qb(9,"app-slider",9),ve.Ub(),ve.Vb(10,"app-form-field",10),ve.Qb(11,"app-slider",11),ve.Ub(),ve.Ub(),ve.Vb(12,"app-panel",12),ve.Vb(13,"app-form-field",13),ve.Qb(14,"app-slider",14),ve.Ub(),ve.Ub(),ve.Vb(15,"app-panel",15),ve.Vb(16,"app-form-field",16),ve.Qb(17,"app-slider",17),ve.Ub(),ve.Vb(18,"div",18),ve.Vb(19,"app-form-field",19),ve.Qb(20,"app-slider",20),ve.Ub(),ve.Vb(21,"app-form-field",21),ve.Qb(22,"app-slider",22),ve.Ub(),ve.Ub(),ve.Vb(23,"app-form-field",13),ve.Qb(24,"app-slider",14),ve.Ub(),ve.Ub(),ve.Vb(25,"app-panel",23),ve.Vb(26,"app-form-field",24),ve.Qb(27,"app-slider",25),ve.Ub(),ve.Vb(28,"app-form-field",26),ve.Qb(29,"app-slider",27),ve.Ub(),ve.Vb(30,"app-form-field",13),ve.Qb(31,"app-slider",14),ve.Ub(),ve.Ub(),ve.Vb(32,"app-panel",28),ve.Vb(33,"app-form-field",29),ve.Vb(34,"select",30),ve.Vb(35,"option",31),ve.Pc(36,"Linear"),ve.Ub(),ve.Vb(37,"option",31),ve.Pc(38,"Exponential (v1)"),ve.Ub(),ve.Vb(39,"option",31),ve.Pc(40,"Exponential (v2)"),ve.Ub(),ve.Ub(),ve.Ub(),ve.Vb(41,"app-form-field",32),ve.Qb(42,"app-color-picker-input",33),ve.Ub(),ve.Vb(43,"app-form-field",34),ve.Qb(44,"app-slider",35),ve.Ub(),ve.Vb(45,"app-form-field",36),ve.Qb(46,"app-slider",37),ve.Ub(),ve.Vb(47,"app-form-field",38),ve.Qb(48,"app-slider",39),ve.Ub(),ve.Vb(49,"app-form-field",40),ve.Qb(50,"app-slider",41),ve.Ub(),ve.Vb(51,"app-form-field",42),ve.Qb(52,"app-slider",43),ve.Ub(),ve.Ub(),ve.Vb(53,"app-panel",44),ve.Vb(54,"app-form-field",45),ve.Qb(55,"app-slider",14),ve.Ub(),ve.Vb(56,"app-form-field",46),ve.Qb(57,"app-slider",47),ve.Ub(),ve.Vb(58,"app-form-field",48),ve.Qb(59,"app-slider",49),ve.Ub(),ve.Vb(60,"app-form-field",50),ve.Qb(61,"app-slider",51),ve.Ub(),ve.Vb(62,"app-form-field",52),ve.Qb(63,"app-slider",53),ve.Ub(),ve.Ub(),ve.Ub()),2&e&&(ve.mc("formGroup",t.form),ve.Db(3),ve.mc("min",0)("max",2)("step",.01),ve.Db(2),ve.mc("min",0)("max",100)("step",1),ve.Db(2),ve.mc("min",0)("max",1)("step",.01),ve.Db(2),ve.mc("min",0)("max",2)("step",.01),ve.Db(2),ve.mc("min",0)("max",1)("step",.01),ve.Db(3),ve.mc("min",0)("max",.25)("step",.01),ve.Db(3),ve.mc("min",0)("max",2)("step",.1),ve.Db(3),ve.mc("min",-1)("max",1)("step",.1),ve.Db(2),ve.mc("min",-1)("max",1)("step",.1),ve.Db(2),ve.mc("min",0)("max",1)("step",.01),ve.Db(3),ve.mc("min",0)("max",100)("step",1),ve.Db(2),ve.mc("min",0)("max",100)("step",1),ve.Db(2),ve.mc("min",0)("max",1)("step",.01),ve.Db(4),ve.mc("ngValue",t.fogModes.FOG_LINEAR),ve.Db(2),ve.mc("ngValue",t.fogModes.FOG_EXP),ve.Db(2),ve.mc("ngValue",t.fogModes.FOG_EXP2),ve.Db(5),ve.mc("min",0)("max",1)("step",.01),ve.Db(2),ve.mc("min",0)("max",100)("step",1),ve.Db(2),ve.mc("min",0)("max",100)("step",1),ve.Db(2),ve.mc("min",0)("max",1)("step",.01),ve.Db(2),ve.mc("min",0)("max",1)("step",.01),ve.Db(3),ve.mc("min",0)("max",1)("step",.1),ve.Db(2),ve.mc("min",-200)("max",200)("step",.1),ve.Db(2),ve.mc("min",-200)("max",200)("step",.1),ve.Db(2),ve.mc("min",-200)("max",200)("step",.1),ve.Db(2),ve.mc("min",0)("max",20)("step",.01))},directives:[yc,ae.s,ae.j,Me.a,ae.r,ae.i,ae.k,Oe.a,To.a,ae.e,ae.B,ae.v,ae.D,Vt],styles:[""],changeDetection:0}),ep),ap=o("quSY"),rp=o("SJ0+"),cp=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function sp(e,t){if(1&e){var n=ve.Wb();ve.Tb(0),ve.Vb(1,"app-panel",3),ve.Vb(2,"app-form-field",4),ve.Vb(3,"app-slider",5),ve.cc("mouseUp",(function(){return ve.Cc(n),ve.gc().handleEndInteraction()}))("blurred",(function(){return ve.Cc(n),ve.gc().handleEndInteraction()})),ve.Ub(),ve.Ub(),ve.Vb(4,"app-form-field",6),ve.Vb(5,"app-slider",7),ve.cc("mouseUp",(function(){return ve.Cc(n),ve.gc().handleEndInteraction()}))("blurred",(function(){return ve.Cc(n),ve.gc().handleEndInteraction()})),ve.Ub(),ve.Ub(),ve.Ub(),ve.Sb()}if(2&e){var i=t.$implicit;ve.Db(1),ve.nc("label",i.label),ve.nc("formGroupName",i.formGroupName),ve.Db(2),ve.mc("min",0)("max",1)("step",.01),ve.Db(2),ve.mc("min",0)("max",5)("step",.01)}}var lp,pp=((lp=function(){function e(t,n,i){l(this,e),this.formBuilder=t,this.store=n,this.changeDetectorRef=i,this.ngUnsubscribe=new C.a,this.editorOpen=!1,this.clipDirections=[{label:"Left",formGroupName:"left"},{label:"Right",formGroupName:"right"},{label:"Top",formGroupName:"top"},{label:"Bottom",formGroupName:"bottom"},{label:"Front",formGroupName:"front"},{label:"Back",formGroupName:"back"}],this.formChangeSubscription=new ap.a}return u(e,[{key:"ngOnInit",value:function(){var e=this;this.initForm(),this.formChangeSubscription=this.getFormChangeSubscription(),this.store.select(X.a.getSelectedChapterClippingPlanes).pipe(Object(R.a)((function(e){return!Object(ce.isNil)(e)})),Object(z.a)(),Object(R.a)((function(e){var t=r(e,2),n=t[0],i=t[1];return JSON.stringify(n)!==JSON.stringify(i)})),Object(Te.a)(50),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){var n=r(t,2),i=(n[0],n[1]);e.form.setValue(e.buildFormValues(i)),e.changeDetectorRef.markForCheck()}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initForm",value:function(){var e=this,t=this.store.selectSnapshot(X.a.getSelectedChapterClippingPlanes),n=this.buildFormValues(t),i={};Object.entries(n.clippingPlanes).map((function(t){var n=r(t,2),o=n[0],a=n[1];i[o]=e.formBuilder.group(a)})),this.form=this.formBuilder.group({clippingPlanesEnabled:n.clippingPlanesEnabled,clippingPlanes:this.formBuilder.group(i)})}},{key:"handleEndInteraction",value:function(){this.handleFormChangeEvent(this.form.value,!0)}},{key:"getFormChangeSubscription",value:function(){var e=this;return this.form.valueChanges.pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){var n=e.store.selectSnapshot(X.a.getSelectedChapterClippingPlanes);e.handleFormChangeEvent(t,n.enabled!==t.clippingPlanesEnabled)}))}},{key:"handleFormChangeEvent",value:function(e,t){var n=this.store.selectSnapshot(X.a.getSelectedChapterId),i=this.buildClipsPayload(e);this.store.dispatch(new J.u(n,i,e.clippingPlanesEnabled,t))}},{key:"buildFormValues",value:function(e){return{clippingPlanesEnabled:e.enabled,clippingPlanes:Object.entries(e.clips).reduce((function(e,t){var n=r(t,2),i=n[0],o=n[1];return e[i]={progress:o.progress,fadeDistance:o.fadeDistance},e}),{})}}},{key:"buildClipsPayload",value:function(e){return Object.entries(e.clippingPlanes).reduce((function(t,n){var i=r(n,2),o=i[0],a=i[1];return t[o]=Object.assign(Object.assign({},a),{clipId:rp.b[o],enabled:e.clippingPlanesEnabled&&a.progress>0,fade:e.clippingPlanesEnabled&&a.fadeDistance>0}),t}),{})}}]),e}()).\u0275fac=function(e){return new(e||lp)(ve.Pb(ae.f),ve.Pb(y.h),ve.Pb(ve.i))},lp.\u0275cmp=ve.Jb({type:lp,selectors:[["app-edit-clipping-planes"]],decls:3,vars:2,consts:[["label","Clipping Planes",3,"formGroup"],["label","Enabled","toggleType","checkbox","formControlName","clippingPlanesEnabled","formGroupName","clippingPlanes"],[4,"ngFor","ngForOf"],["toggleType","none",3,"label","formGroupName"],["label","Progress"],["formControlName","progress",3,"min","max","step","mouseUp","blurred"],["label","Fade Distance"],["formControlName","fadeDistance",3,"min","max","step","mouseUp","blurred"]],template:function(e,t){1&e&&(ve.Vb(0,"app-portal-column",0),ve.Vb(1,"app-panel",1),ve.Nc(2,sp,6,8,"ng-container",2),ve.Ub(),ve.Ub()),2&e&&(ve.mc("formGroup",t.form),ve.Db(2),ve.mc("ngForOf",t.clipDirections))},directives:[yc,ae.s,ae.j,Me.a,ae.r,ae.i,ae.k,f.o,Oe.a,To.a],styles:[""],changeDetection:0}),function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);a>3&&r&&Object.defineProperty(t,n,r)}([Object(y.e)(X.a.getSelectedChapterClippingPlanes),cp("design:type",_.a)],lp.prototype,"clippingPlanes$",void 0),lp),up=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function dp(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"button",7),ve.cc("click",(function(){ve.Cc(n);var e=t.$implicit;return ve.gc().handleResetClick([e])})),ve.Pc(1),ve.Ub()}if(2&e){var i=t.$implicit,o=ve.gc();ve.Db(1),ve.Rc(" ",o.propertyLabels[i]," ")}}function mp(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"button",7),ve.cc("click",(function(){ve.Cc(n);var e=t.$implicit;return ve.gc().handleApplyAllClick([e])})),ve.Pc(1),ve.Ub()}if(2&e){var i=t.$implicit,o=ve.gc();ve.Db(1),ve.Rc(" ",o.propertyLabels[i]," ")}}function hp(e,t){if(1&e&&(ve.Vb(0,"app-list-item"),ve.Vb(1,"div",19),ve.Pc(2),ve.Ub(),ve.Vb(3,"div",20),ve.Pc(4),ve.hc(5,"json"),ve.Ub(),ve.Ub()),2&e){var n=t.$implicit;ve.Db(2),ve.Qc(n.key),ve.Db(2),ve.Qc(ve.ic(5,2,n.value))}}var bp,fp={"camera.optics.fov":"Field of View","camera.zoomLimits":"Zoom Limits","camera.zoomLimits.min":"Zoom Limits (Min)","camera.zoomLimits.max":"Zoom Limits (Max)"},gp=((bp=function(){function e(t,n,i,o){l(this,e),this.store=t,this.formBuilder=n,this.engineService=i,this.changeRef=o,this.propertyLabels=fp,this.ngUnsubscribe=new C.a,this.defaultProperties=this.engineService.getDefaultProperties(),this.form=this.formBuilder.group({properties:this.formBuilder.group({"camera.optics.fov":[null],"camera.zoomLimits":this.formBuilder.group({max:[null],min:[null]})})});var a=this.form.get("properties");this.cameraProperties=Object.keys(a.controls),this.form.patchValue({properties:Object.assign({},this.defaultProperties)})}return u(e,[{key:"ngOnInit",value:function(){this.initFormListeners(),this.initChapterListeners()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initFormListeners",value:function(){var e=this;this.form.valueChanges.pipe(Object(Un.a)(125),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){var n=t.properties,i=e.store.selectSnapshot(X.a.getSelectedChapterId);e.engineService.setProperties(n);var o=e.getMinimumProperties(n,e.defaultProperties);e.store.dispatch(new J.C([i],o))}))}},{key:"initChapterListeners",value:function(){var e=this;this.selectedChapter$.pipe(Object(R.a)((function(e){return!Object(ce.isNil)(e)})),Object(io.a)((function(e,t){return Object(ce.isEqual)(e.properties,t.properties)})),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){var n,i=null!==(n=t.properties)&&void 0!==n?n:{},o=Object.keys(e.form.value.properties);e.extraProperties=Object(ce.pickBy)(i,(function(e,t){return!o.includes(t)})),e.form.patchValue({properties:i},{emitEvent:!1}),e.changeRef.markForCheck()}))}},{key:"handleEndInteraction",value:function(){}},{key:"handleResetClick",value:function(e){var t=this.store.selectSnapshot(X.a.getSelectedChapterId),n=this.getPropertiesBySource(e,this.defaultProperties);this.form.patchValue({properties:n}),this.store.dispatch(new J.k([t],e))}},{key:"handleApplyAllClick",value:function(e){var t,n=null!==(t=this.store.selectSnapshot(X.a.getSelectedChapter).properties)&&void 0!==t?t:{},i=this.getPropertiesBySource(e,n),o=this.store.selectSnapshot(X.a.getStoryChapters).map((function(e){return e.id}));this.store.dispatch(new J.C(o,i))}},{key:"getMinimumProperties",value:function(e,t){return Object.entries(e).reduce((function(e,n){var i=r(n,2),o=i[0],a=i[1],c=t[o];return Object(ce.isEqual)(a,c)||(e[o]=a),e}),{})}},{key:"getPropertiesBySource",value:function(e,t){return e.reduce((function(e,n){return(null==t?void 0:t[n])&&(e[n]=t[n]),e}),{})}}]),e}()).\u0275fac=function(e){return new(e||bp)(ve.Pb(y.h),ve.Pb(ae.f),ve.Pb(Ce.a),ve.Pb(ve.i))},bp.\u0275cmp=ve.Jb({type:bp,selectors:[["app-edit-chapter-properties"]],decls:32,vars:21,consts:[["label","Properties",3,"formGroup"],["list-actions",""],["app-button","",3,"matMenuTriggerFor"],["icon","ellipsis-v"],["propActionsMenu","matMenu"],["mat-menu-item","",3,"matMenuTriggerFor"],["resetMenu","matMenu"],["mat-menu-item","",3,"click"],["mat-menu-item","",3,"click",4,"ngFor","ngForOf"],["applyMenu","matMenu"],["label","Camera Properties","formGroupName","properties"],[3,"label"],["formControlName","camera.optics.fov",3,"min","max","step","mouseUp","blurred"],["formGroupName","camera.zoomLimits"],["formControlName","min",3,"min","max","step","mouseUp","blurred"],["formControlName","max",3,"min","max","step","mouseUp","blurred"],["label","Additional Properties"],["listType","flat",1,"text-12"],[4,"ngFor","ngForOf"],[1,"text-semibold"],[1,"text-light"]],template:function(e,t){if(1&e&&(ve.Vb(0,"app-portal-column",0),ve.Vb(1,"div",1),ve.Vb(2,"button",2),ve.Qb(3,"app-icon",3),ve.Ub(),ve.Vb(4,"mat-menu",null,4),ve.Vb(6,"button",5),ve.Pc(7,"Reset Defaults"),ve.Ub(),ve.Vb(8,"button",5),ve.Pc(9,"Apply to all chapters"),ve.Ub(),ve.Ub(),ve.Vb(10,"mat-menu",null,6),ve.Vb(12,"button",7),ve.cc("click",(function(){return t.handleResetClick(t.cameraProperties)})),ve.Pc(13," All Camera Properties "),ve.Ub(),ve.Nc(14,dp,2,1,"button",8),ve.Ub(),ve.Vb(15,"mat-menu",null,9),ve.Vb(17,"button",7),ve.cc("click",(function(){return t.handleApplyAllClick(t.cameraProperties)})),ve.Pc(18," All Camera Properties "),ve.Ub(),ve.Nc(19,mp,2,1,"button",8),ve.Ub(),ve.Ub(),ve.Vb(20,"app-panel",10),ve.Vb(21,"app-form-field",11),ve.Vb(22,"app-slider",12),ve.cc("mouseUp",(function(){return t.handleEndInteraction()}))("blurred",(function(){return t.handleEndInteraction()})),ve.Ub(),ve.Ub(),ve.Tb(23,13),ve.Vb(24,"app-form-field",11),ve.Vb(25,"app-slider",14),ve.cc("mouseUp",(function(){return t.handleEndInteraction()}))("blurred",(function(){return t.handleEndInteraction()})),ve.Ub(),ve.Ub(),ve.Vb(26,"app-form-field",11),ve.Vb(27,"app-slider",15),ve.cc("mouseUp",(function(){return t.handleEndInteraction()}))("blurred",(function(){return t.handleEndInteraction()})),ve.Ub(),ve.Ub(),ve.Sb(),ve.Ub(),ve.Vb(28,"app-panel",16),ve.Vb(29,"app-list",17),ve.Nc(30,hp,6,4,"app-list-item",18),ve.hc(31,"keyvalue"),ve.Ub(),ve.Ub(),ve.Ub()),2&e){var n=ve.yc(5),i=ve.yc(11),o=ve.yc(16);ve.mc("formGroup",t.form),ve.Db(2),ve.mc("matMenuTriggerFor",n),ve.Db(4),ve.mc("matMenuTriggerFor",i),ve.Db(2),ve.mc("matMenuTriggerFor",o),ve.Db(6),ve.mc("ngForOf",t.cameraProperties),ve.Db(5),ve.mc("ngForOf",t.cameraProperties),ve.Db(2),ve.mc("label",t.propertyLabels["camera.optics.fov"]),ve.Db(1),ve.mc("min",20)("max",75)("step",5),ve.Db(2),ve.mc("label",t.propertyLabels["camera.zoomLimits.min"]),ve.Db(1),ve.mc("min",5)("max",10)("step",.25),ve.Db(1),ve.mc("label",t.propertyLabels["camera.zoomLimits.max"]),ve.Db(1),ve.mc("min",10)("max",350)("step",10),ve.Db(3),ve.mc("ngForOf",ve.ic(31,19,t.extraProperties))}},directives:[yc,ae.s,ae.j,Pe.a,Ki.d,yt.a,Ki.a,Ki.b,f.o,Me.a,ae.k,Oe.a,To.a,ae.r,ae.i,Et.a,jt.a],pipes:[f.i,f.h],styles:[""],changeDetection:0}),function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);a>3&&r&&Object.defineProperty(t,n,r)}([Object(y.e)(X.a.getSelectedChapter),up("design:type",_.a)],bp.prototype,"selectedChapter$",void 0),bp),vp=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},yp=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function xp(e,t){if(1&e){var n=ve.Wb();ve.Tb(0),ve.Vb(1,"app-portal",null,2),ve.Vb(3,"app-portal-item",3),ve.cc("itemClick",(function(e){return ve.Cc(n),ve.gc().handleTransitionClick(e)})),ve.hc(4,"async"),ve.Ub(),ve.Vb(5,"app-portal-item",4),ve.cc("itemClick",(function(e){return ve.Cc(n),ve.gc().handleTransparencyClick(e)})),ve.hc(6,"prettyPrint"),ve.hc(7,"async"),ve.Ub(),ve.Vb(8,"app-portal-item",5),ve.cc("itemClick",(function(e){return ve.Cc(n),ve.gc().handleEffectsClick(e)})),ve.hc(9,"async"),ve.Ub(),ve.Vb(10,"app-portal-item",6),ve.cc("itemClick",(function(e){return ve.Cc(n),ve.gc().handleClippingPlanesClick(e)})),ve.hc(11,"async"),ve.Ub(),ve.Vb(12,"app-portal-item",7),ve.cc("itemClick",(function(e){return ve.Cc(n),ve.gc().handleParticlesClick(e)})),ve.Ub(),ve.Vb(13,"app-portal-item",8),ve.cc("itemClick",(function(e){return ve.Cc(n),ve.gc().handlePropertiesClick(e)})),ve.hc(14,"async"),ve.Ub(),ve.Ub(),ve.Sb()}if(2&e){var i,o=ve.gc();ve.Db(3),ve.mc("hint",o.getTransitionsHint(ve.ic(4,6,o.selectedChapter$))),ve.Db(2),ve.mc("hint",ve.ic(6,8,null==(i=ve.ic(7,10,o.selectedChapter$))?null:i.transparencyMode)),ve.Db(3),ve.mc("hint",o.getLookEffectsHint(ve.ic(9,12,o.selectedChapter$))),ve.Db(2),ve.mc("hint",o.getClippingPlanesHint(ve.ic(11,14,o.clippingPlanes$))),ve.Db(2),ve.mc("hint",o.getParticlesHint(o.chapterParticleSystems)),ve.Db(1),ve.mc("hint",o.getPropertiesHint(ve.ic(14,16,o.selectedChapter$)))}}function Cp(e,t){1&e&&(ve.Vb(0,"app-column",9),ve.Vb(1,"app-column-group"),ve.Tb(2,10),ve.Tb(3),ve.Vb(4,"div",11),ve.Qb(5,"img",12),ve.Pc(6," Welcome to Human Studio! "),ve.Qb(7,"br"),ve.Pc(8,"Select a tool to get started. "),ve.Ub(),ve.Sb(),ve.Sb(),ve.Ub(),ve.Ub()),2&e&&ve.mc("showHeader",!1)}var kp,Pp=((kp=function(){function e(t,n){l(this,e),this.store=t,this.enumPrintPipe=n,this.application=fe.a,this.ngUnsubscribe=new C.a}return u(e,[{key:"chapterParticleSystems",get:function(){var e=this.store.selectSnapshot(X.a.getSelectedChapterId);return this.store.selectSnapshot(Ko.a.particleSystemsForChapter(e))}},{key:"ngOnInit",value:function(){}},{key:"ngAfterViewInit",value:function(){this.initContentRefresh()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initContentRefresh",value:function(){var e=this.portals.first;e&&this.selectedChapterId$.pipe(Object(io.a)(),Object(N.a)(this.ngUnsubscribe)).subscribe((function(){e.exit()}))}},{key:"handleTransitionClick",value:function(e){e.loadComponent(Wl)}},{key:"handleTransparencyClick",value:function(e){e.loadComponent(Jl)}},{key:"handleEffectsClick",value:function(e){e.loadComponent(op)}},{key:"handleClippingPlanesClick",value:function(e){e.loadComponent(pp)}},{key:"handleParticlesClick",value:function(e){e.loadComponent(El)}},{key:"handlePropertiesClick",value:function(e){e.loadComponent(gp)}},{key:"getTransitionsHint",value:function(e){var t=Object(ce.get)(e,"transitions.post"),n=[];return Object(ce.get)(e,"transitions.pre")&&n.push("Pre Transition"),t&&n.push("Post Transition"),this.formatHint(n)}},{key:"getLookEffectsHint",value:function(e){var t=Object(ce.get)(e,"customData.postprocess",[]),n=Object(ce.get)(e,"properties",{}),i=t.map((function(e){return e.effect}));return!0===n["fog.enabled"]&&i.push("fog"),this.formatHint(i)}},{key:"getClippingPlanesHint",value:function(e){return this.formatHint(Object.keys((e||{clips:{}}).clips))}},{key:"getParticlesHint",value:function(e){return this.formatHint(e.map((function(e){return e.id})))}},{key:"getPropertiesHint",value:function(e){var t,n=null!==(t=null==e?void 0:e.properties)&&void 0!==t?t:{};return Object.keys(n).join(", ")}},{key:"formatHint",value:function(e){var t=this;return e.map((function(e){return t.enumPrintPipe.transform(e)})).join(", ")}}]),e}()).\u0275fac=function(e){return new(e||kp)(ve.Pb(y.h),ve.Pb(_c))},kp.\u0275cmp=ve.Jb({type:kp,selectors:[["app-edit-document-context"]],viewQuery:function(e,t){var n;1&e&&ve.Vc(Fr,!0),2&e&&ve.xc(n=ve.dc())&&(t.portals=n)},features:[ve.Cb([_c])],decls:2,vars:2,consts:[[4,"appFlagApplication"],[3,"showHeader",4,"appFlagApplication"],["portal",""],["label","Transitions",3,"hint","itemClick"],["label","Transparency Mode",3,"hint","itemClick"],["label","Post Processing",3,"hint","itemClick"],["label","Clipping Planes",3,"hint","itemClick"],["label","Particle Systems",3,"hint","itemClick"],["label","Properties",3,"hint","itemClick"],[3,"showHeader"],["column-group-body",""],[1,"context","text-14"],["src","/assets/images/logo-blue.svg",1,"context__logo"]],template:function(e,t){1&e&&(ve.Nc(0,xp,15,18,"ng-container",0),ve.Nc(1,Cp,9,1,"app-column",1)),2&e&&(ve.mc("appFlagApplication",t.application.Loft),ve.Db(1),ve.mc("appFlagApplication",t.application.Studio))},directives:[wt.a,Fr,Zc,ko,lo],pipes:[f.b,_c],styles:["a[_ngcontent-%COMP%]{color:rgba(150,168,192,.5)}.column[_ngcontent-%COMP%]{align-items:center}.column[_ngcontent-%COMP%], .context[_ngcontent-%COMP%]{display:flex;justify-content:center;height:100%}.context[_ngcontent-%COMP%]{flex-direction:column;padding:16px;text-align:center;color:rgba(150,168,192,.5)}.context__logo[_ngcontent-%COMP%]{width:40px;display:block;margin:20px auto;opacity:.3}"],changeDetection:0}),vp([Object(y.e)(X.a.getSelectedChapterId),yp("design:type",_.a)],kp.prototype,"selectedChapterId$",void 0),vp([Object(y.e)(X.a.getSelectedChapter),yp("design:type",_.a)],kp.prototype,"selectedChapter$",void 0),vp([Object(y.e)(X.a.getSelectedChapterClippingPlanes),yp("design:type",_.a)],kp.prototype,"clippingPlanes$",void 0),kp),Op=o("l57l"),wp=o("2o60"),Sp=o("A+8E"),_p=o("6L7E"),Mp=function(e){return e.Object="object",e.Position="position",e}({}),Up=o("XoU3"),Tp=o("qplK"),Vp=o("WRwD"),Dp=o("2he+");function Ep(e,t){if(1&e&&(ve.Vb(0,"app-form-field",50),ve.Vb(1,"select",51),ve.Vb(2,"option",29),ve.Pc(3,"Alphabetical"),ve.Ub(),ve.Vb(4,"option",29),ve.Pc(5,"Numerical"),ve.Ub(),ve.Ub(),ve.Ub()),2&e){var n=ve.gc();ve.Db(2),ve.mc("value",n.labelSequentialType.Alphabetical),ve.Db(2),ve.mc("value",n.labelSequentialType.Numerical)}}function jp(e,t){1&e&&(ve.Vb(0,"div"),ve.Vb(1,"mat-checkbox",52),ve.Pc(2,"Show description & image"),ve.Ub(),ve.Ub())}function Np(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"app-form-field"),ve.Vb(1,"button",55),ve.cc("click",(function(){return ve.Cc(n),ve.gc(2).handleRecordPositionClick()})),ve.Pc(2," Mark Position "),ve.Ub(),ve.Ub()}}function Rp(e,t){if(1&e&&(ve.Vb(0,"div",53),ve.Vb(1,"app-form-field"),ve.Vb(2,"select",54),ve.Vb(3,"option",29),ve.Pc(4,"Zoom to label structure"),ve.Ub(),ve.Vb(5,"option",29),ve.Pc(6,"Zoom to fixed position"),ve.Ub(),ve.Ub(),ve.Ub(),ve.Nc(7,Np,3,0,"app-form-field",47),ve.Ub()),2&e){var n=ve.gc();ve.Db(3),ve.mc("value",n.labelFlyTo.Object),ve.Db(2),ve.mc("value",n.labelFlyTo.Position),ve.Db(2),ve.mc("ngIf",n._flyToTarget===n.labelFlyTo.Position)}}var Ap,Fp=((Ap=function(){function e(t,n,i,o){l(this,e),this.formBuilder=t,this.store=n,this.cameraService=i,this.matSnackBar=o,this.labelTheme=Op.a,this.labelPinType=wp.a,this.labelSequentialType=Sp.a,this.labelFlyTo=Mp,this.ngUnsubscribe=new C.a,this.open=!1,this.opened=new ve.p;var a=new _p.a("");this.form=this.formBuilder.group({title:[a.title],description:[a.description],theme:[a.theme],pinType:[a.pinType,ae.C.required],sequentialType:[a.sequentialType,ae.C.required],pinGlow:[a.pinGlow],collapseDescription:[a.collapseDescription],hideWire:[a.hideWire],hideTag:[a.hideTag],expandTag:[a.expandTag],showDescription:[a.showDescription],flyTo:[!1],flyToTarget:[""],image:this.formBuilder.group({urls:[],alt:[""]})})}return u(e,[{key:"label",get:function(){return this._label},set:function(e){JSON.stringify(e)!==JSON.stringify(this._label)&&(this._label=e,this.setFormValues(e))}},{key:"_theme",get:function(){return this.form.get("theme").value}},{key:"_flyTo",get:function(){return this.form.get("flyTo").value}},{key:"_flyToTarget",get:function(){return this.form.get("flyToTarget").value}},{key:"_hideWire",get:function(){return this.form.get("hideWire").value}},{key:"ngOnInit",value:function(){var e=this;this.form.valueChanges.pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){return e.handleFormChanges(t)}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"handleAlignButton",value:function(e,t){this.label.offset=[e,t],this.store.dispatch(new ie.m(this.label,!0))}},{key:"handleRecordPositionClick",value:function(){var e=JSON.parse(JSON.stringify(this.label.states)),t=this.prepareLabelStates(e);t[1].errands=[new Tp.a(this.cameraService.getCamera())],this.store.dispatch(new ie.p(this.label.id,t)),this.matSnackBar.open("Recorded marked position")}},{key:"handleRemove",value:function(){this.store.dispatch(new ie.i(this.label))}},{key:"handleFormChanges",value:function(e){var t=Object(ce.cloneDeep)(this.label);if(t.title=e.title,t.description=e.description||"",t.theme=e.theme,t.pinType=e.pinType,t.sequentialType=e.sequentialType,t.pinGlow=e.pinGlow,t.collapseDescription=e.collapseDescription,t.hideWire=e.hideWire,t.hideTag=e.hideTag,t.expandTag=e.expandTag,t.showDescription=e.showDescription,e.flyTo)switch(t.states=this.prepareLabelStates(t.states),t.flyTo=e.flyTo,t.flyToTarget=e.flyToTarget,e.flyToTarget){case Mp.Object:t.states[1].errands=[new Up.a(t.objectId)];break;case Mp.Position:if(!(Object(ce.get)(t,"states[1].errands[0]")instanceof Tp.a)){var n=this.cameraService.getCamera();t.cameraPosition=n,t.states[1].errands=[new Tp.a(n)]}}else t.states&&t.states.length&&t.states[1]&&(t.states[1].errands=[]);t.contentBlocks=this.toContentBlocks(e),this.store.dispatch(new ie.m(t,!0))}},{key:"handleAlignClick",value:function(e){var t=Object(ce.cloneDeep)(this.label),n=t.hideWire?20:32;switch(e){case"left":t.offset=[-n,0];break;case"right":t.offset=[n,0]}this.store.dispatch(new ie.m(t,!0))}},{key:"handleOpened",value:function(e){this.opened.emit({label:this.label,open:e})}},{key:"prepareLabelStates",value:function(e){var t=e?a(e):[];return t||(t=[]),t[0]||(t[0]=new Vp.a,t[0].id=Ho.a.idWithPrefix("label-state")),t[1]||(t[1]=new Vp.a,t[1].id=Ho.a.idWithPrefix("label-state")),t}},{key:"setFormValues",value:function(e){var t=this.fromContentBlocks(e.contentBlocks||[]),n={title:e.title,description:e.description||"",theme:e.theme,pinType:e.pinType,sequentialType:e.sequentialType,pinGlow:e.pinGlow,collapseDescription:e.collapseDescription,hideWire:e.hideWire,hideTag:e.hideTag,flyTo:null,flyToTarget:Mp.Object,expandTag:e.expandTag,showDescription:e.showDescription,image:t},i=Object(ce.get)(e,"states[1].errands[0]");if(i)switch(n.flyTo=!0,!0){case i instanceof Tp.a:n.flyToTarget=Mp.Position;break;case i instanceof Up.a:default:n.flyToTarget=Mp.Object}this.form.setValue(n,{emitEvent:!1})}},{key:"fromContentBlocks",value:function(e){var t={urls:null,alt:""},n=e.find((function(e){return e.type===me.a.Images})),i=Object(ce.get)(n,"images[0]",t);return Object.assign(Object.assign({},t),i)}},{key:"toContentBlocks",value:function(e){var t=e.image,n=t.urls,i=t.alt;return!Object(ce.isNil)(n)||i?[{type:me.a.Images,images:[{urls:n,alt:i}]}]:[]}}]),e}()).\u0275fac=function(e){return new(e||Ap)(ve.Pb(ae.f),ve.Pb(y.h),ve.Pb(zi.a),ve.Pb(ke.b))},Ap.\u0275cmp=ve.Jb({type:Ap,selectors:[["app-label-widget"]],inputs:{label:"label",open:"open"},outputs:{opened:"opened"},decls:74,vars:25,consts:[["toggleType","arrow",3,"label","open","opened"],["panel-prefix",""],[1,"flex","justify-start","items-center",2,"width","36px","height","36px"],[3,"label","labelTheme"],["panel-actions",""],["app-button","","buttonSize","small",3,"matMenuTriggerFor"],["icon","ellipsis-v"],["labelMenu","matMenu"],["mat-menu-item","",3,"click"],["autocomplete","off",3,"formGroup"],["tabSize","small","tabTheme","dark"],["label","Content"],[1,"pt-2","pl-1"],["label","Title",1,"pb-2"],["textMode","text","mode","basic","formControlName","title",3,"inline","compact","maxLength"],["title",""],[3,"field"],["formGroupName","image"],["label","Image",1,"pb-2"],["type","image","formControlName","urls"],["label","Image Alt",1,"pb-2"],["type","text","formControlName","alt",1,"input"],["label","Description",1,"pb-2"],["textMode","textarea","formControlName","description","rows","9",3,"inline","compact","maxLength"],["description",""],["label","Style"],[1,"pt-2","pl-1","text-12"],["label","Label Theme"],["formControlName","theme",1,"input"],[3,"value"],["label","Label Pin"],["formControlName","pinType",1,"input"],["label","Sequence Type",4,"ngIf"],["label","Label Type"],["formControlName","hideWire",1,"input","mr-2",2,"display","inline-block","width","154px"],[3,"ngValue"],[2,"display","inline-block"],["app-button","","buttonType","outline","matTooltip","Align Left",3,"click"],["icon","caret-left"],["app-button","","buttonType","outline","matTooltip","Align Right",3,"click"],["icon","caret-right"],["formControlName","pinGlow"],["label","Actions"],["label","On load"],["listType","flat"],["formControlName","collapseDescription"],["label","On click"],[4,"ngIf"],["formControlName","flyTo"],["class","pl-6 pt-2",4,"ngIf"],["label","Sequence Type"],["formControlName","sequentialType",1,"input"],["formControlName","showDescription"],[1,"pl-6","pt-2"],["formControlName","flyToTarget",1,"input"],["app-button","","buttonType","outline","buttonSize","small",1,"w-100",3,"click"]],template:function(e,t){if(1&e&&(ve.Vb(0,"app-panel",0),ve.cc("opened",(function(e){return t.handleOpened(e)})),ve.Tb(1,1),ve.Vb(2,"div",2),ve.Qb(3,"app-label-pin",3),ve.Ub(),ve.Sb(),ve.Vb(4,"span",4),ve.Vb(5,"button",5),ve.Qb(6,"app-icon",6),ve.Ub(),ve.Vb(7,"mat-menu",null,7),ve.Vb(9,"button",8),ve.cc("click",(function(){return t.handleRemove()})),ve.Pc(10,"Remove"),ve.Ub(),ve.Ub(),ve.Ub(),ve.Vb(11,"form",9),ve.Vb(12,"app-tabs",10),ve.Vb(13,"app-tab",11),ve.Vb(14,"div",12),ve.Vb(15,"app-form-field",13),ve.Qb(16,"app-rich-text-edit",14,15),ve.Qb(18,"app-character-counter",16),ve.Ub(),ve.Tb(19,17),ve.Vb(20,"app-form-field",18),ve.Qb(21,"app-content-upload-input",19),ve.Ub(),ve.Vb(22,"app-form-field",20),ve.Qb(23,"input",21),ve.Ub(),ve.Sb(),ve.Vb(24,"app-form-field",22),ve.Qb(25,"app-rich-text-edit",23,24),ve.Qb(27,"app-character-counter",16),ve.Ub(),ve.Ub(),ve.Ub(),ve.Vb(28,"app-tab",25),ve.Vb(29,"div",26),ve.Vb(30,"app-form-field",27),ve.Vb(31,"select",28),ve.Vb(32,"option",29),ve.Pc(33,"Dark"),ve.Ub(),ve.Vb(34,"option",29),ve.Pc(35,"Light"),ve.Ub(),ve.Ub(),ve.Ub(),ve.Vb(36,"app-form-field",30),ve.Vb(37,"select",31),ve.Vb(38,"option",29),ve.Pc(39,"Circle"),ve.Ub(),ve.Vb(40,"option",29),ve.Pc(41,"Plus / Minus"),ve.Ub(),ve.Vb(42,"option",29),ve.Pc(43,"Sequential"),ve.Ub(),ve.Vb(44,"option",29),ve.Pc(45,"None"),ve.Ub(),ve.Ub(),ve.Ub(),ve.Nc(46,Ep,6,2,"app-form-field",32),ve.Vb(47,"app-form-field",33),ve.Vb(48,"select",34),ve.Vb(49,"option",35),ve.Pc(50,"Leader Line"),ve.Ub(),ve.Vb(51,"option",35),ve.Pc(52,"Floating"),ve.Ub(),ve.Ub(),ve.Vb(53,"app-button-group",36),ve.Vb(54,"button",37),ve.cc("click",(function(){return t.handleAlignClick("left")})),ve.Qb(55,"app-icon",38),ve.Ub(),ve.Vb(56,"button",39),ve.cc("click",(function(){return t.handleAlignClick("right")})),ve.Qb(57,"app-icon",40),ve.Ub(),ve.Ub(),ve.Ub(),ve.Vb(58,"app-form-field"),ve.Vb(59,"mat-checkbox",41),ve.Pc(60," Make Pin Glow "),ve.Ub(),ve.Ub(),ve.Ub(),ve.Ub(),ve.Vb(61,"app-tab",42),ve.Vb(62,"div",26),ve.Vb(63,"app-form-field",43),ve.Vb(64,"app-list",44),ve.Vb(65,"app-list-item"),ve.Vb(66,"mat-checkbox",45),ve.Pc(67," Hide description & image "),ve.Ub(),ve.Ub(),ve.Ub(),ve.Ub(),ve.Vb(68,"app-form-field",46),ve.Nc(69,jp,3,0,"div",47),ve.Vb(70,"div"),ve.Vb(71,"mat-checkbox",48),ve.Pc(72,"Zoom label"),ve.Ub(),ve.Nc(73,Rp,8,3,"div",49),ve.Ub(),ve.Ub(),ve.Ub(),ve.Ub(),ve.Ub(),ve.Ub(),ve.Ub()),2&e){var n=ve.yc(8),i=ve.yc(17),o=ve.yc(26);ve.mc("label",t.label.title)("open",t.open),ve.Db(3),ve.mc("label",t.label)("labelTheme",t.label.theme),ve.Db(2),ve.mc("matMenuTriggerFor",n),ve.Db(6),ve.mc("formGroup",t.form),ve.Db(5),ve.mc("inline",!0)("compact",!0)("maxLength",100),ve.Db(2),ve.mc("field",i),ve.Db(7),ve.mc("inline",!0)("compact",!0)("maxLength",300),ve.Db(2),ve.mc("field",o),ve.Db(5),ve.mc("value",t.labelTheme.Annotation),ve.Db(2),ve.mc("value",t.labelTheme.StudioNext),ve.Db(4),ve.mc("value",t.labelPinType.Default),ve.Db(2),ve.mc("value",t.labelPinType.PlusMinus),ve.Db(2),ve.mc("value",t.labelPinType.Sequential),ve.Db(2),ve.mc("value",t.labelPinType.None),ve.Db(2),ve.mc("ngIf","sequential"==t.label.pinType),ve.Db(3),ve.mc("ngValue",!1),ve.Db(2),ve.mc("ngValue",!0),ve.Db(18),ve.mc("ngIf",t.label.collapseDescription),ve.Db(4),ve.mc("ngIf",t._flyTo)}},directives:[Me.a,Dp.a,Pe.a,Ki.d,yt.a,Ki.a,Ki.b,ae.E,ae.s,ae.j,_o.a,Mo.a,Oe.a,gt,ae.r,ae.i,we.a,ae.k,xt.a,ae.c,ae.B,ae.v,ae.D,f.p,ea,Ct.c,Ue.a,Et.a,jt.a],styles:["[_nghost-%COMP%]{display:block}"],changeDetection:0}),Ap),Ip=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},zp=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Lp(e,t){1&e&&(ve.Vb(0,"div",22),ve.Vb(1,"div",23),ve.Pc(2,"Add a label"),ve.Ub(),ve.Vb(3,"div",17),ve.Pc(4,"Click on an object in the 3D scene to start adding labels."),ve.Ub(),ve.Ub())}function Bp(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"div",24),ve.Vb(1,"app-label-widget",25),ve.cc("opened",(function(e){return ve.Cc(n),ve.gc().handleOpened(e)})),ve.hc(2,"async"),ve.Ub(),ve.Vb(3,"div",26),ve.Qb(4,"app-icon",27),ve.Ub(),ve.Ub()}if(2&e){var i,o=t.$implicit,a=ve.gc();ve.Db(1),ve.mc("label",o)("open",(null==(i=ve.ic(2,3,a.selectedLabel$))?null:i.id)===o.id),ve.Eb("data-id",o.id)}}var Qp,$p=((Qp=function(){function e(t,n){l(this,e),this.store=t,this.formBuilder=n,this.activeToolEnum=ne.a,this.labelTheme=Op.a,this.labelPinType=wp.a,this.labelSequentialType=Sp.a,this.interactive=!1,this.widgetSubscriptions=[],this.ngUnsubscribe=new C.a,this.labelForm=this.formBuilder.group({title:[""],description:[""]})}return u(e,[{key:"ngOnInit",value:function(){var e=this;this.bindApplicationEvents(),this.selectedLabel$.pipe(Object(R.a)((function(e){return!!e})),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){setTimeout((function(){return e.scrollLabelIntoView(t)}))}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"ngAfterViewInit",value:function(){var e=this;this.subscribeToOpen(),this.labelWidgets.changes.subscribe((function(){e.unsubscribeToOpen(),e.subscribeToOpen()}))}},{key:"bindApplicationEvents",value:function(){var e=this;this.selectedChapter$.pipe(Object(R.a)((function(e){return null!=e})),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.interactive=t.readyState.model}))}},{key:"unsubscribeToOpen",value:function(){this.widgetSubscriptions.forEach((function(e){return e.unsubscribe()})),this.widgetSubscriptions=[]}},{key:"subscribeToOpen",value:function(){var e=this;this.labelWidgets.forEach((function(t){var n=t.opened.pipe(Object(N.a)(e.ngUnsubscribe)).subscribe((function(n){e.openWidget(t,n)}));e.widgetSubscriptions.push(n)}))}},{key:"handleOpenWidgets",value:function(e){this.toggleWidgets(e)}},{key:"handleOpened",value:function(e){this.store.dispatch(new ie.k(e.label))}},{key:"handleRemoveChapterLabels",value:function(){this.store.dispatch(new ie.g(this.store.selectSnapshot(X.a.getSelectedChapter)))}},{key:"handleNext",value:function(){this.store.dispatch(new U.b)}},{key:"handlePrevious",value:function(){this.store.dispatch(new U.d)}},{key:"handleCheckedChange",value:function(e){this.store.dispatch(new Z.c(e.checked))}},{key:"toggleWidgets",value:function(e){this.labelWidgets.forEach((function(t){t.open=e}))}},{key:"openWidget",value:function(e,t){this.toggleWidgets(!1),e.open=t}},{key:"trackLabel",value:function(e,t){return t.id}},{key:"convertLabels",value:function(e,t){var n=this.store.selectSnapshot(t?K.a.getChapterLabels:K.a.getLabels);this.store.dispatch(new ie.c(n,e))}},{key:"scrollLabelIntoView",value:function(e){var t=document.querySelector('[data-id="'.concat(e.id,'"]'));"scrollBehavior"in document.documentElement.style&&t&&t.scrollIntoView({behavior:"smooth",block:"nearest"})}},{key:"handleDrop",value:function(e){var t=this.store.selectSnapshot(K.a.getChapterLabels);Object(vt.e)(t,e.previousIndex,e.currentIndex);var n=this.store.selectSnapshot(K.a.getLabels).filter((function(e){return!t.some((function(t){return t.id===e.id}))}));n=[].concat(a(n),a(t)),this.store.dispatch(new ie.q(n))}}]),e}()).\u0275fac=function(e){return new(e||Qp)(ve.Pb(y.h),ve.Pb(ae.f))},Qp.\u0275cmp=ve.Jb({type:Qp,selectors:[["app-edit-label-context"]],viewQuery:function(e,t){var n;1&e&&ve.Vc(Me.a,!0),2&e&&ve.xc(n=ve.dc())&&(t.labelWidgets=n)},decls:54,vars:16,consts:[[3,"loading"],["column-label",""],["column-actions",""],["app-button","",1,"context__actions",3,"matMenuTriggerFor"],["icon","ellipsis-v"],["labelMenu","matMenu"],["mat-menu-item","",3,"click"],["mat-menu-item","",3,"matMenuTriggerFor"],["storyTrigger","matMenuTrigger"],["chapterTrigger","matMenuTrigger"],["convertMenu","matMenu"],["convertThemeMenu","matMenu"],["convertPinsMenu","matMenu"],["label","Label"],["column-group-header",""],[1,"pl-2"],[3,"checked","change"],[1,"text-12"],["column-group-body",""],["class","p-3",4,"ngIf"],["cdkDropList","",1,"labels",3,"cdkDropListDropped"],["class","labels__item","cdkDrag","",4,"ngFor","ngForOf","ngForTrackBy"],[1,"p-3"],[1,"text-12","text-bold"],["cdkDrag","",1,"labels__item"],[1,"flex-grow",3,"label","open","opened"],["cdkDragHandle","",1,"labels__handle"],["icon","grip-lines"]],template:function(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"app-column",0),ve.Vb(1,"div",1),ve.Pc(2,"Labels"),ve.Ub(),ve.Vb(3,"div",2),ve.Vb(4,"button",3),ve.Qb(5,"app-icon",4),ve.Ub(),ve.Vb(6,"mat-menu",null,5),ve.Vb(8,"button",6),ve.cc("click",(function(){return t.handleRemoveChapterLabels()})),ve.Pc(9," Remove this chapter's labels "),ve.Ub(),ve.Qb(10,"mat-divider"),ve.Vb(11,"button",7,8),ve.Pc(13," Convert all labels "),ve.Ub(),ve.Vb(14,"button",7,9),ve.Pc(16," Convert this chapter's labels "),ve.Ub(),ve.Ub(),ve.Vb(17,"mat-menu",null,10),ve.Vb(19,"button",7),ve.Pc(20,"Theme"),ve.Ub(),ve.Vb(21,"button",7),ve.Pc(22,"Pin"),ve.Ub(),ve.Ub(),ve.Vb(23,"mat-menu",null,11),ve.Vb(25,"button",6),ve.cc("click",(function(){ve.Cc(n);var e=ve.yc(15);return t.convertLabels({theme:t.labelTheme.Annotation},e.menuOpen)})),ve.Pc(26," Dark Theme "),ve.Ub(),ve.Vb(27,"button",6),ve.cc("click",(function(){ve.Cc(n);var e=ve.yc(15);return t.convertLabels({theme:t.labelTheme.StudioNext},e.menuOpen)})),ve.Pc(28," Light Theme "),ve.Ub(),ve.Ub(),ve.Vb(29,"mat-menu",null,12),ve.Vb(31,"button",6),ve.cc("click",(function(){ve.Cc(n);var e=ve.yc(15);return t.convertLabels({pinType:t.labelPinType.Default},e.menuOpen)})),ve.Pc(32," Circle "),ve.Ub(),ve.Vb(33,"button",6),ve.cc("click",(function(){ve.Cc(n);var e=ve.yc(15);return t.convertLabels({pinType:t.labelPinType.PlusMinus},e.menuOpen)})),ve.Pc(34," Plus / Minus "),ve.Ub(),ve.Vb(35,"button",6),ve.cc("click",(function(){ve.Cc(n);var e=ve.yc(15);return t.convertLabels({pinType:t.labelPinType.Sequential,sequentialType:t.labelSequentialType.Alphabetical},e.menuOpen)})),ve.Pc(36," Alphabetical "),ve.Ub(),ve.Vb(37,"button",6),ve.cc("click",(function(){ve.Cc(n);var e=ve.yc(15);return t.convertLabels({pinType:t.labelPinType.Sequential,sequentialType:t.labelSequentialType.Numerical},e.menuOpen)})),ve.Pc(38," Numerical "),ve.Ub(),ve.Vb(39,"button",6),ve.cc("click",(function(){ve.Cc(n);var e=ve.yc(15);return t.convertLabels({pinType:t.labelPinType.None},e.menuOpen)})),ve.Pc(40," None "),ve.Ub(),ve.Ub(),ve.Ub(),ve.Vb(41,"app-column-group",13),ve.Tb(42,14),ve.Vb(43,"div",15),ve.Vb(44,"mat-checkbox",16),ve.cc("change",(function(e){return t.handleCheckedChange(e)})),ve.hc(45,"async"),ve.Vb(46,"span",17),ve.Pc(47,"Disable label zoom while editing"),ve.Ub(),ve.Ub(),ve.Ub(),ve.Sb(),ve.Tb(48,18),ve.Nc(49,Lp,5,0,"div",19),ve.hc(50,"async"),ve.Vb(51,"div",20),ve.cc("cdkDropListDropped",(function(e){return t.handleDrop(e)})),ve.Nc(52,Bp,5,5,"div",21),ve.hc(53,"async"),ve.Ub(),ve.Sb(),ve.Ub(),ve.Ub()}if(2&e){var i,o=ve.yc(7),a=ve.yc(18),r=ve.yc(24),c=ve.yc(30);ve.mc("loading",!t.interactive),ve.Db(4),ve.mc("matMenuTriggerFor",o),ve.Db(7),ve.mc("matMenuTriggerFor",a),ve.Db(3),ve.mc("matMenuTriggerFor",a),ve.Db(5),ve.mc("matMenuTriggerFor",r),ve.Db(2),ve.mc("matMenuTriggerFor",c),ve.Db(23),ve.mc("checked",ve.ic(45,10,t.lockCamera$)),ve.Db(5),ve.mc("ngIf",!(null!=(i=ve.ic(50,12,t.labels$))&&i.length)),ve.Db(3),ve.mc("ngForOf",ve.ic(53,14,t.labels$))("ngForTrackBy",t.trackLabel)}},directives:[ko,Pe.a,Ki.d,yt.a,Ki.a,Ki.b,_e.a,lo,Ue.a,f.p,vt.c,f.o,vt.a,Fp,vt.b],pipes:[f.b],styles:[".context__actions[_ngcontent-%COMP%]{flex:0 1 auto}.labels__item[_ngcontent-%COMP%]{position:relative}.labels__item[_ngcontent-%COMP%]:hover   .labels__handle[_ngcontent-%COMP%]{opacity:1}.labels__handle[_ngcontent-%COMP%]{border:4px solid transparent;display:flex;align-items:center;justify-content:center;background:#131c2a;width:44px;height:36px;cursor:move;color:#96a8c0;position:absolute;left:4px;top:16px;z-index:10;opacity:0;transition:opacity .15s}.labels[_ngcontent-%COMP%]   .cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:.2}"],changeDetection:0}),Ip([Object(y.e)(D.a.getStory),zp("design:type",_.a)],Qp.prototype,"story$",void 0),Ip([Object(y.e)(X.a.getSelectedChapter),zp("design:type",_.a)],Qp.prototype,"selectedChapter$",void 0),Ip([Object(y.e)(K.a.getChapterLabels),zp("design:type",_.a)],Qp.prototype,"labels$",void 0),Ip([Object(y.e)(K.a.getSelectedLabel),zp("design:type",_.a)],Qp.prototype,"selectedLabel$",void 0),Ip([Object(y.e)(V.a.getChapter),zp("design:type",_.a)],Qp.prototype,"chapter$",void 0),Ip([Object(y.e)(V.a.getActiveTool),zp("design:type",_.a)],Qp.prototype,"activeTool$",void 0),Ip([Object(y.e)(Y.a.getLockCamera),zp("design:type",_.a)],Qp.prototype,"lockCamera$",void 0),Qp),qp=o("xcvO"),Gp=o("nclC"),Hp=function e(t){l(this,e),this.label=t||"",this.id=Ho.a.idWithPrefix("palette"),this.recipes=[],this.open=!0};function Wp(e,t){1&e&&(ve.Vb(0,"app-alert",15),ve.Pc(1," There was an error importing your palette. "),ve.Ub())}var Kp,Jp=((Kp=function(){function e(t,n,i){l(this,e),this.formBuilder=t,this.dialogRef=n,this.changeDetectorRef=i,this.hasError=!1}return u(e,[{key:"ngOnInit",value:function(){this.initForm()}},{key:"initForm",value:function(){this.form=this.formBuilder.group({import:["",ae.C.required]})}},{key:"handleSubmit",value:function(){var e=this.form.get("import").value;this.createPalette(e)}},{key:"createPalette",value:function(e){this.hasError=!1;try{var t=JSON.parse(e),n=Object(wo.plainToClass)(Hp,t);delete n.id,this.dialogRef.close(n)}catch(i){this.hasError=!0,this.changeDetectorRef.markForCheck()}}},{key:"handleFile",value:function(e){var t=this,n=new FileReader;n.onload=function(e){t.createPalette(e.target.result)},n.readAsText(e.target.files[0])}},{key:"onReaderLoad",value:function(e){this.createPalette(e.target.result)}}]),e}()).\u0275fac=function(e){return new(e||Kp)(ve.Pb(ae.f),ve.Pb(re.g),ve.Pb(ve.i))},Kp.\u0275cmp=ve.Jb({type:Kp,selectors:[["app-edit-import-palette-dialog"]],decls:18,vars:2,consts:[["data-test","importPaletteDialog",1,"edit-import-palette-dialog","theme-light"],["mat-dialog-title",""],["mat-dialog-content",""],["type","danger","theme","light","class","mb-4 block",4,"ngIf"],["tabTheme","light"],["label","Paste Text"],["data-test","importForm",3,"formGroup","submit"],["label","Palette"],["formControlName","import","rows","6","name","import","data-test","importText",1,"input"],["label","Upload file"],["label","Palette File"],["type","file",1,"input",3,"change"],["mat-dialog-actions",""],["app-button","","buttonTheme","light","type","button",1,"mr-2",3,"mat-dialog-close"],["app-button","","buttonType","primary",3,"click"],["type","danger","theme","light",1,"mb-4","block"]],template:function(e,t){1&e&&(ve.Vb(0,"div",0),ve.Vb(1,"h1",1),ve.Pc(2,"Import Palette"),ve.Ub(),ve.Vb(3,"div",2),ve.Nc(4,Wp,2,0,"app-alert",3),ve.Vb(5,"app-tabs",4),ve.Vb(6,"app-tab",5),ve.Vb(7,"form",6),ve.cc("submit",(function(){return t.handleSubmit()})),ve.Vb(8,"app-form-field",7),ve.Qb(9,"textarea",8),ve.Ub(),ve.Ub(),ve.Ub(),ve.Vb(10,"app-tab",9),ve.Vb(11,"app-form-field",10),ve.Vb(12,"input",11),ve.cc("change",(function(e){return t.handleFile(e)})),ve.Ub(),ve.Ub(),ve.Ub(),ve.Ub(),ve.Ub(),ve.Vb(13,"div",12),ve.Vb(14,"button",13),ve.Pc(15," Cancel "),ve.Ub(),ve.Vb(16,"button",14),ve.cc("click",(function(){return t.handleSubmit()})),ve.Pc(17,"Import"),ve.Ub(),ve.Ub(),ve.Ub()),2&e&&(ve.Db(4),ve.mc("ngIf",t.hasError),ve.Db(3),ve.mc("formGroup",t.form))},directives:[re.h,re.e,f.p,_o.a,Mo.a,ae.E,ae.s,ae.j,Oe.a,ae.c,ae.r,ae.i,re.c,Pe.a,re.d,Vo.a],styles:[""],changeDetection:0}),Kp);function Xp(e){var t,n="";return"number"==typeof e?n=Math.floor(e).toString():gi.a.isFresnel(e)?n="(Center: ".concat(Xp((t=e).center),", Edge: ").concat(Xp(t.edge),", Center Bias: ").concat(Xp(t.centerBias),", Edge Bias: ").concat(Xp(t.edgeBias),", Power: ").concat(t.power,")"):gi.a.isColor(e)&&(n=ue.a.rgbToHex(ue.a.rgbFromDecimal(e)).toUpperCase()),n}var Zp=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Yp=["palette"];function eu(e,t){if(1&e&&(ve.Vb(0,"div",4),ve.Pc(1),ve.Ub()),2&e){var n=ve.gc();ve.Db(1),ve.Rc(" ",n.label,"\n")}}var tu,nu=function(e,t,n){return{"paint-palette-swatch--slash":e,"paint-palette-swatch--selected":t,"paint-palette-swatch--large":n}},iu=((tu=function(){function e(t,n){l(this,e),this.renderer=t,this.changeDetectorRef=n,this.showLabel=!0,this.size="small",this.highlightSelected=!0,this.selected=!1,this.showSlash=!1,this.ngUnsubscribe=new C.a}return u(e,[{key:"engineRecipe",get:function(){return this._engineRecipe},set:function(e){this._engineRecipe=e,this.recipe=gi.a.fromEngine(this.engineRecipe)}},{key:"recipe",get:function(){return this._recipe},set:function(e){this._recipe=e,this.recipe&&(this.updateStyle(this.recipe),this.updateTooltip())}},{key:"label",get:function(){return this._label},set:function(e){this._label=e,this.updateTooltip()}},{key:"ngOnInit",value:function(){var e=this;this.currentRecipe$.pipe(Object(N.a)(this.ngUnsubscribe),Object(R.a)((function(){return e.highlightSelected})),Object(R.a)((function(e){return!Object(ce.isNil)(e)}))).subscribe((function(t){e.selected=e.isSelected(e.recipe,t),e.changeDetectorRef.markForCheck()}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"updateStyle",value:function(e){var t=1;if(gi.a.modifiesOpacity(e)&&(t=Object(ce.isNumber)(e.opacity)?e.opacity>1?e.opacity/100:e.opacity:.4),gi.a.isFresnel(e.tintColor)){var n=ue.a.rgbToHex(ue.a.rgbFromDecimal(e.tintColor.center)),i=ue.a.rgbToHex(ue.a.rgbFromDecimal(e.tintColor.edge));this.renderer.setStyle(this.element.nativeElement,"background","radial-gradient(".concat(n," 0%, ").concat(i," 60%)"))}else{var o=this.makeColor(e,t);this.renderer.setStyle(this.element.nativeElement,"background",o)}this.showSlash=!1===e.tintColor&&!1===e.brightness&&!1===e.contrast&&!1===e.opacity&&!1===e.saturation}},{key:"makeColor",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=e.tintColor;if(!n)return"rgba(255,255,255,".concat(t,")");var i=r(n,3),o=i[0],a=i[1],c=i[2];return"rgba(".concat(255*o,", ").concat(255*a,", ").concat(255*c,", ").concat(t,")")}},{key:"updateTooltip",value:function(){if(this.recipe){var e=[];this.label&&e.push(this.label);var t=[].concat(e,a([{key:"Color",value:Xp(this.recipe.tintColor)},{key:"Saturation",value:Xp(this.recipe.saturation)},{key:"Contrast",value:Xp(this.recipe.contrast)},{key:"Brightness",value:Xp(this.recipe.brightness)},{key:"Opacity",value:Xp(this.recipe.opacity)}].filter((function(e){return""!==e.value})).map((function(e){return"".concat(e.key,": ").concat(e.value)})))).join("\n\n");this.tooltip=t}}},{key:"isSelected",value:function(e,t){return Object(ce.isEqual)(e,t)}}]),e}()).\u0275fac=function(e){return new(e||tu)(ve.Pb(ve.H),ve.Pb(ve.i))},tu.\u0275cmp=ve.Jb({type:tu,selectors:[["app-paint-swatch"],["button","app-paint-swatch",""]],viewQuery:function(e,t){var n;1&e&&ve.Jc(Yp,!0),2&e&&ve.xc(n=ve.dc())&&(t.element=n.first)},inputs:{engineRecipe:"engineRecipe",recipe:"recipe",label:"label",showLabel:"showLabel",size:"size",icon:"icon",highlightSelected:"highlightSelected"},decls:4,vars:7,consts:[["matTooltipClass","text-pre-line","matTooltipPosition","above","data-test","paintPaletteSwatch",1,"paint-palette-swatch",3,"ngClass","matTooltip"],[1,"paint-palette-swatch__style"],["palette",""],["class","paint-palette-swatch__label",4,"ngIf"],[1,"paint-palette-swatch__label"]],template:function(e,t){1&e&&(ve.Vb(0,"div",0),ve.Qb(1,"div",1,2),ve.Ub(),ve.Nc(3,eu,2,1,"div",3)),2&e&&(ve.mc("ngClass",ve.rc(3,nu,t.showSlash,t.selected,"large"===t.size))("matTooltip",t.tooltip),ve.Db(3),ve.mc("ngIf",t.showLabel))},directives:[f.m,Ct.c,f.p],styles:["[app-paint-swatch]{display:inline-flex;justify-content:center;align-items:center;flex-direction:column}button[app-paint-swatch]{cursor:pointer;background:none;border:none;margin:0;padding:0}.paint-palette-swatch__label{display:block;width:48px;height:20px;padding:4px 4px 0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;color:#fff;font-size:9px}.paint-palette-swatch{cursor:pointer;background-color:#fff;background-image:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8' viewBox='0 0 8 8'%3E%3Cg fill='%23CCCCCC' fill-opacity='1'%3E%3Cpath fill-rule='evenodd' d='M0 0h4v4H0V0zm4 4h4v4H4V4z'/%3E%3C/g%3E%3C/svg%3E\");border-radius:50%;display:flex;justify-content:center;align-items:center;width:24px;height:24px;position:relative}.paint-palette-swatch:hover:active{transform:scale(.9)}.paint-palette-swatch--large{width:36px;height:36px}.paint-palette-swatch--selected .paint-palette-swatch__style{box-shadow:0 0 0 2px #7fb6f5}.paint-palette-swatch--slash:after{content:\" \";position:absolute;height:3px;width:100%;background-color:rgba(244,67,54,.8);transform:rotate(135deg)}.paint-palette-swatch__style{position:absolute;width:100%;height:100%;border-radius:50%;box-shadow:0 0 0 1px #374a68}.paint-palette-swatch__icon{text-shadow:0 0 2px rgba(0,0,0,.8)}"],encapsulation:2,changeDetection:0}),function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);a>3&&r&&Object.defineProperty(t,n,r)}([Object(y.e)(vi.a.getCurrentRecipe),Zp("design:type",_.a)],tu.prototype,"currentRecipe$",void 0),tu);function ou(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"div",12),ve.Qb(1,"app-paint-swatch",13),ve.Qb(2,"input",14),ve.Vb(3,"button",15),ve.cc("click",(function(){ve.Cc(n);var e=t.index;return ve.gc().handleRemove(e)})),ve.Qb(4,"app-icon",16),ve.Ub(),ve.Ub()}if(2&e){var i=t.$implicit,o=t.index,a=ve.gc();ve.mc("formGroup",i),ve.Db(1),ve.mc("recipe",a.palette.recipes[o])("highlightSelected",!1)("showLabel",!1)}}var au,ru,cu=((ru=function(){function e(t,n,i,o){l(this,e),this.dialogRef=t,this.data=n,this.formBuilder=i,this.store=o,this.form=this.formBuilder.group({label:["",ae.C.required],recipes:this.formBuilder.array([])}),this.ngUnsubscribe=new C.a,this.activeRecipeIndex=null,this.showDetails=!1,this.palette=Object(ce.cloneDeep)(this.data.palette)}return u(e,[{key:"recipes",get:function(){return this.form.get("recipes")}},{key:"ngOnInit",value:function(){this.updateForm(this.palette),this.handleFormChanges()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"updateForm",value:function(e){var t=this;this.form.get("label").setValue(e.label),e.recipes.forEach((function(e){var n=t.formBuilder.group({label:[e.label]});t.recipes.push(n)}))}},{key:"handleFormChanges",value:function(){var e=this;this.form.get("recipes").valueChanges.pipe(Object(N.a)(this.ngUnsubscribe),Object(R.a)((function(e){return e.length}))).subscribe((function(t){e.palette.recipes.forEach((function(n,i){e.palette.recipes[i].label=t[i].label}))}))}},{key:"handleRemoveRecipe",value:function(e){this.palette.recipes.splice(e,1),this.store.dispatch(new fi.n(this.palette))}},{key:"handleSubmit",value:function(){var e=Object(wo.plainToClass)(Hp,Object.assign(Object.assign({},this.palette),{label:this.form.get("label").value}));this.dialogRef.close(e)}},{key:"handleRecipeDrop",value:function(e){var t=e.previousIndex,n=e.currentIndex;this.palette.recipes=Object(he.a)(this.palette.recipes,t,n),this.recipes.controls=Object(he.a)(this.recipes.controls,t,n)}},{key:"handleRecipeClick",value:function(e){this.activeRecipeIndex=e,this.showDetails=!1}},{key:"handleRemove",value:function(e){this.palette.recipes.splice(e,1),this.activeRecipeIndex=null}}]),e}()).\u0275fac=function(e){return new(e||ru)(ve.Pb(re.g),ve.Pb(re.a),ve.Pb(ae.f),ve.Pb(y.h))},ru.\u0275cmp=ve.Jb({type:ru,selectors:[["app-edit-palette-dialog"]],decls:15,vars:2,consts:[["data-test","editPaletteDialog",1,"edit-palette-dialog","theme-light"],["mat-dialog-title",""],["mat-dialog-content",""],["data-test","editPaletteForm",3,"formGroup","submit"],["label","Label"],["type","text","formControlName","label","cdkFocusInitial","","data-test","paletteLabel",1,"input"],["label","Colors","cdkDropList","","cdkDropListOrientation","vertical","formArrayName","recipes",3,"cdkDropListDropped"],[1,"edit-palette-dialog__recipes","theme-light"],["data-test","paletteRecipe","class","edit-palette-dialog__item","cdkDrag","",3,"formGroup",4,"ngFor","ngForOf"],["mat-dialog-actions",""],["app-button","","buttonTheme","light","type","button",1,"mr-2",3,"mat-dialog-close"],["app-button","","buttonType","primary","data-test","paletteSubmit",3,"click"],["data-test","paletteRecipe","cdkDrag","",1,"edit-palette-dialog__item",3,"formGroup"],[1,"mr-2",3,"recipe","highlightSelected","showLabel"],["type","label","placeholder","Label (optional)","formControlName","label","tabindex","0",1,"input","theme-light"],["type","button","app-button","","buttonType","outline","buttonTheme","light","tabindex","-1",1,"ml-2",3,"click"],["icon","times"]],template:function(e,t){1&e&&(ve.Vb(0,"div",0),ve.Vb(1,"h1",1),ve.Pc(2,"Manage Palette"),ve.Ub(),ve.Vb(3,"div",2),ve.Vb(4,"form",3),ve.cc("submit",(function(){return t.handleSubmit()})),ve.Vb(5,"app-form-field",4),ve.Qb(6,"input",5),ve.Ub(),ve.Vb(7,"app-form-field",6),ve.cc("cdkDropListDropped",(function(e){return t.handleRecipeDrop(e)})),ve.Vb(8,"div",7),ve.Nc(9,ou,5,4,"div",8),ve.Ub(),ve.Ub(),ve.Ub(),ve.Ub(),ve.Vb(10,"div",9),ve.Vb(11,"button",10),ve.Pc(12," Cancel "),ve.Ub(),ve.Vb(13,"button",11),ve.cc("click",(function(){return t.handleSubmit()})),ve.Pc(14," Done "),ve.Ub(),ve.Ub(),ve.Ub()),2&e&&(ve.Db(4),ve.mc("formGroup",t.form),ve.Db(5),ve.mc("ngForOf",t.recipes.controls))},directives:[re.h,re.e,ae.E,ae.s,ae.j,Oe.a,ae.c,ae.r,ae.i,vt.c,ae.e,f.o,re.c,Pe.a,re.d,vt.a,iu,yt.a],styles:[".edit-palette-dialog__recipes[_ngcontent-%COMP%]{padding:16px 0;max-height:320px;overflow-y:scroll}.edit-palette-dialog__item[_ngcontent-%COMP%]{border-radius:4px;display:flex;align-items:center;padding:8px}.edit-palette-dialog__item[_ngcontent-%COMP%]:hover{background:#eaeff5}"],changeDetection:0}),ru),su=((au=function(){function e(t,n,i,o,a){l(this,e),this.dialogService=t,this.clipboardService=n,this.snackbar=i,this.store=o,this.dialog=a}return u(e,[{key:"selectRecipe",value:function(e){this.store.dispatch(new fi.d),this.store.dispatch(new fi.h(e)),this.store.dispatch(new q.w(ne.a.Paint))}},{key:"copyPaletteToClipboard",value:function(e){var t=this,n=Object(ce.cloneDeep)(e);delete n.open;var i=JSON.stringify(n);this.clipboardService.copyToClipboard(i,"text").pipe(Object(F.a)(1)).subscribe((function(e){t.snackbar.open(e?"Successfully copied palette to clipboard.":"Failed to copy palette to clipboard.")}))}},{key:"downloadPalette",value:function(e){var t=Object.assign({},e);delete t.id,delete t.open;var n=(e.label.toLocaleLowerCase()||"palette")+".json",i=JSON.stringify(e),o=new Blob([i],{type:"text/plain;charset=utf-8"});Object(yn.saveAs)(o,n)}},{key:"removePalette",value:function(e){var t=this;this.dialogService.openConfirmDialog({data:{titleText:"Remove Palette",bodyText:"Would you like to remove the '".concat(e.label,"' palette?"),confirmText:"Remove Palette"}}).afterClosed().pipe(Object(F.a)(1),Object(R.a)((function(e){return!0===e}))).subscribe((function(){t.store.dispatch(new fi.e(e.id))}))}},{key:"openImportPalette",value:function(){var e=this;this.dialog.open(Jp,{width:"480px"}).afterClosed().pipe(Object(F.a)(1),Object(R.a)((function(e){return!Object(ce.isNil)(e)}))).subscribe((function(t){e.dialog.open(cu,{width:"480px",data:{palette:t}}).afterClosed().pipe(Object(F.a)(1),Object(R.a)((function(e){return!Object(ce.isNil)(e)}))).subscribe((function(t){e.store.dispatch(new fi.a(t))}))}))}}]),e}()).\u0275fac=function(e){return new(e||au)(ve.Zb(Bi.a),ve.Zb(Gp.a),ve.Zb(ke.b),ve.Zb(y.h),ve.Zb(re.b))},au.\u0275prov=ve.Lb({token:au,factory:au.\u0275fac,providedIn:"root"}),au),lu=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function pu(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"button",10),ve.cc("click",(function(){ve.Cc(n);var e=t.$implicit;return ve.gc(2).handleRecipeClick(e)})),ve.Ub()}if(2&e){var i=t.$implicit;ve.mc("recipe",i)("label",i.label)}}function uu(e,t){if(1&e&&(ve.Vb(0,"div",6),ve.Vb(1,"div",7),ve.Pc(2),ve.Ub(),ve.Vb(3,"div",8),ve.Nc(4,pu,1,2,"button",9),ve.Ub(),ve.Ub()),2&e){var n=t.$implicit;ve.Db(2),ve.Rc(" ",n.label," "),ve.Db(2),ve.mc("ngForOf",n.recipes)}}var du,mu=((du=function(){function e(t){l(this,e),this.editPaintService=t,this.name="",this.groupedPresets=[{label:"Colors",recipes:Oa.e},{label:"Effects",recipes:Oa.a}]}return u(e,[{key:"ngOnInit",value:function(){}},{key:"handleRecipeClick",value:function(e){this.editPaintService.selectRecipe(e)}},{key:"isSelected",value:function(e,t){return JSON.stringify(e)===JSON.stringify(t)}}]),e}()).\u0275fac=function(e){return new(e||du)(ve.Pb(su))},du.\u0275cmp=ve.Jb({type:du,selectors:[["app-paint-presets"]],decls:7,vars:3,consts:[["toggleType","arrow",3,"open","noPadding"],["panel-label","",1,"text-semibold","ph-3","pv-2"],[1,"text-semibold","flex","items-center","ph-",2,"min-height","36px"],[1,"ph-3","pb-2"],[1,"paint-presets"],["class","paint-presets__group",4,"ngFor","ngForOf"],[1,"paint-presets__group"],[1,"text-10","text-uppercase","text-dim","pv-2","pl-1"],[1,"ph-1"],["app-paint-swatch","","class","mr-2 mb-2","data-test","paintPreset",3,"recipe","label","click",4,"ngFor","ngForOf"],["app-paint-swatch","","data-test","paintPreset",1,"mr-2","mb-2",3,"recipe","label","click"]],template:function(e,t){1&e&&(ve.Vb(0,"app-panel",0),ve.Vb(1,"div",1),ve.Vb(2,"div",2),ve.Pc(3,"BioDigital"),ve.Ub(),ve.Ub(),ve.Vb(4,"div",3),ve.Vb(5,"div",4),ve.Nc(6,uu,5,2,"div",5),ve.Ub(),ve.Ub(),ve.Ub()),2&e&&(ve.mc("open",!0)("noPadding",!0),ve.Db(6),ve.mc("ngForOf",t.groupedPresets))},directives:[Me.a,f.o,iu],styles:[".paint-presets[_ngcontent-%COMP%]{display:flex;flex-flow:column}"],changeDetection:0}),function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);a>3&&r&&Object.defineProperty(t,n,r)}([Object(y.e)(vi.a.getCurrentRecipe),lu("design:type",_.a)],du.prototype,"colorRecipe$",void 0),du),hu=o("PmOP"),bu=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},fu=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function gu(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"button",16),ve.cc("click",(function(){ve.Cc(n);var e=t.$implicit;return ve.gc().handleRecipeClick(e)})),ve.Ub()}2&e&&ve.mc("engineRecipe",t.$implicit)}function vu(e,t){1&e&&(ve.Vb(0,"div",17),ve.Vb(1,"span",18),ve.Pc(2,"No Brushes Found"),ve.Ub(),ve.Ub())}function yu(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"button",16),ve.cc("click",(function(){ve.Cc(n);var e=t.$implicit;return ve.gc().handleRecipeClick(e)})),ve.Ub()}2&e&&ve.mc("engineRecipe",t.$implicit)}function xu(e,t){1&e&&(ve.Vb(0,"div",17),ve.Vb(1,"span",18),ve.Pc(2,"No Brushes Found"),ve.Ub(),ve.Ub())}function Cu(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"button",16),ve.cc("click",(function(){ve.Cc(n);var e=t.$implicit;return ve.gc().handleRecipeClick(e)})),ve.Ub()}2&e&&ve.mc("engineRecipe",t.$implicit)}function ku(e,t){1&e&&(ve.Vb(0,"div",17),ve.Vb(1,"span",18),ve.Pc(2,"No Brushes Found"),ve.Ub(),ve.Ub())}var Pu,Ou=((Pu=function(){function e(t,n){l(this,e),this.store=t,this.editPaintService=n,this.ngUnsubscribe=new C.a}return u(e,[{key:"ngOnInit",value:function(){}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"handleRecipeClick",value:function(e){var t=gi.a.fromEngine(e);this.store.dispatch(new fi.d),this.store.dispatch(new fi.h(t)),this.store.dispatch(new q.w(ne.a.Paint))}},{key:"handleExport",value:function(e){var t=this.store.selectSnapshot(D.a.getStory).displayName||"Story Palette",n=this.store.selectSnapshot(vi.a.getUniqueStoryRecipes).map((function(e){return gi.a.fromEngine(e)})),i=new Hp(t);i.recipes=n,"copy"===e?this.editPaintService.copyPaletteToClipboard(i):this.editPaintService.downloadPalette(i)}}]),e}()).\u0275fac=function(e){return new(e||Pu)(ve.Pb(y.h),ve.Pb(su))},Pu.\u0275cmp=ve.Jb({type:Pu,selectors:[["app-paint-currently-used"]],decls:33,vars:21,consts:[["toggleType","arrow",3,"noPadding","open"],["panel-label","",1,"text-semibold","ph-3","pv-2"],[1,"text-semibold","flex","items-center",2,"min-height","36px"],["panel-actions","","appEventFence","",1,"pv-2"],["app-button","",3,"matMenuTriggerFor"],["icon","ellipsis-v"],[1,"ph-3","pb-2"],["tabSize","small","tabTheme","dark"],["label","This Model"],[1,"paint-currently-used","ph-1"],["app-paint-swatch","","class","mr-2 mb-2",3,"engineRecipe","click",4,"ngFor","ngForOf"],["class","p-2",4,"ngIf"],["label","This Chapter"],["label","Recent"],["menu","matMenu"],["mat-menu-item","",3,"click"],["app-paint-swatch","",1,"mr-2","mb-2",3,"engineRecipe","click"],[1,"p-2"],[1,"text-10","text-dim","text-italic"]],template:function(e,t){if(1&e&&(ve.Vb(0,"app-panel",0),ve.Vb(1,"div",1),ve.Vb(2,"div",2),ve.Pc(3,"Recent"),ve.Ub(),ve.Ub(),ve.Vb(4,"div",3),ve.Vb(5,"button",4),ve.Qb(6,"app-icon",5),ve.Ub(),ve.Ub(),ve.Vb(7,"div",6),ve.Vb(8,"app-tabs",7),ve.Vb(9,"app-tab",8),ve.Vb(10,"div",9),ve.Nc(11,gu,1,1,"button",10),ve.hc(12,"async"),ve.Ub(),ve.Nc(13,vu,3,0,"div",11),ve.hc(14,"async"),ve.Ub(),ve.Vb(15,"app-tab",12),ve.Vb(16,"div",9),ve.Nc(17,yu,1,1,"button",10),ve.hc(18,"async"),ve.Ub(),ve.Nc(19,xu,3,0,"div",11),ve.hc(20,"async"),ve.Ub(),ve.Vb(21,"app-tab",13),ve.Vb(22,"div",9),ve.Nc(23,Cu,1,1,"button",10),ve.hc(24,"async"),ve.Ub(),ve.Nc(25,ku,3,0,"div",11),ve.hc(26,"async"),ve.Ub(),ve.Ub(),ve.Ub(),ve.Ub(),ve.Vb(27,"mat-menu",null,14),ve.Vb(29,"button",15),ve.cc("click",(function(){return t.handleExport("copy")})),ve.Pc(30," Copy this model's palette to clipboard "),ve.Ub(),ve.Vb(31,"button",15),ve.cc("click",(function(){return t.handleExport("download")})),ve.Pc(32,"Download this model's palette"),ve.Ub(),ve.Ub()),2&e){var n,i,o,a=ve.yc(28);ve.mc("noPadding",!0)("open",!0),ve.Db(5),ve.mc("matMenuTriggerFor",a),ve.Db(6),ve.mc("ngForOf",ve.ic(12,9,t.uniqueStoryRecipes$)),ve.Db(2),ve.mc("ngIf",!(null!=(n=ve.ic(14,11,t.uniqueStoryRecipes$))&&n.length)),ve.Db(4),ve.mc("ngForOf",ve.ic(18,13,t.chapterRecipes$)),ve.Db(2),ve.mc("ngIf",!(null!=(i=ve.ic(20,15,t.chapterRecipes$))&&i.length)),ve.Db(4),ve.mc("ngForOf",ve.ic(24,17,t.recentRecipes$)),ve.Db(2),ve.mc("ngIf",!(null!=(o=ve.ic(26,19,t.recentRecipes$))&&o.length))}},directives:[Me.a,hu.a,Pe.a,Ki.d,yt.a,_o.a,Mo.a,f.o,f.p,Ki.a,Ki.b,iu],pipes:[f.b],styles:[".paint-currently-used[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}"],changeDetection:0}),bu([Object(y.e)(vi.a.getRecentRecipes),fu("design:type",_.a)],Pu.prototype,"recentRecipes$",void 0),bu([Object(y.e)(vi.a.getUniqueStoryRecipes),fu("design:type",_.a)],Pu.prototype,"uniqueStoryRecipes$",void 0),bu([Object(y.e)(vi.a.getCurrentChapterRecipes),fu("design:type",_.a)],Pu.prototype,"chapterRecipes$",void 0),Pu);function wu(e,t){if(1&e&&(ve.Vb(0,"tr"),ve.Vb(1,"td",6),ve.Pc(2),ve.Ub(),ve.Ub()),2&e){var n=ve.gc();ve.Db(2),ve.Qc(n.recipe.label)}}function Su(e,t){if(1&e&&(ve.Vb(0,"tr"),ve.Vb(1,"td",7),ve.Pc(2),ve.Ub(),ve.Vb(3,"td",8),ve.Pc(4),ve.Ub(),ve.Ub()),2&e){var n=t.$implicit;ve.Db(2),ve.Qc(n.label),ve.Db(2),ve.Qc(n.value)}}var _u,Mu=((_u=function(){function e(){l(this,e),this.values=[]}return u(e,[{key:"recipe",get:function(){return this._recipe},set:function(e){this._recipe=e,this.values=this.recipe?this.getValues(this.recipe):[]}},{key:"ngOnInit",value:function(){}},{key:"getValues",value:function(e){return[{label:"Color",value:Xp(e.tintColor)},{label:"Saturation",value:Xp(e.saturation)},{label:"Contrast",value:Xp(e.contrast)},{label:"Brightness",value:Xp(e.brightness)},{label:"Opacity",value:Xp(e.opacity)}].filter((function(e){return""!=e.value}))}}]),e}()).\u0275fac=function(e){return new(e||_u)},_u.\u0275cmp=ve.Jb({type:_u,selectors:[["app-edit-recipe-summary"]],inputs:{recipe:"recipe"},decls:6,vars:4,consts:[[1,"edit-recipe-summary"],["size","large",3,"recipe","highlightSelected"],[1,"edit-recipe-summary__details"],[1,"w-100"],[4,"ngIf"],[4,"ngFor","ngForOf"],["colspan","2",1,"ph-2","pb-1","text-italic"],[1,"ph-2","pb-1","w-50","text-semibold"],[1,"ph-1","pb-1","w-50"]],template:function(e,t){1&e&&(ve.Vb(0,"div",0),ve.Qb(1,"app-paint-swatch",1),ve.Vb(2,"div",2),ve.Vb(3,"table",3),ve.Nc(4,wu,3,1,"tr",4),ve.Nc(5,Su,5,2,"tr",5),ve.Ub(),ve.Ub(),ve.Ub()),2&e&&(ve.Db(1),ve.mc("recipe",t.recipe)("highlightSelected",!1),ve.Db(3),ve.mc("ngIf",t.recipe.label),ve.Db(1),ve.mc("ngForOf",t.values))},directives:[iu,f.p,f.o],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.edit-recipe-summary[_ngcontent-%COMP%]{color:#fff;display:flex;padding:8px 0;align-items:flex-start;font-size:10px;letter-spacing:.25px;line-height:1.4em}.edit-recipe-summary__details[_ngcontent-%COMP%]{flex-grow:1;max-height:160px;overflow-y:auto}.theme-light[_nghost-%COMP%]   .edit-recipe-summary[_ngcontent-%COMP%], .theme-light   [_nghost-%COMP%]   .edit-recipe-summary[_ngcontent-%COMP%]{color:#101823}"],changeDetection:0}),_u),Uu=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Tu(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"button",10),ve.cc("click",(function(){ve.Cc(n);var e=t.$implicit;return ve.gc().handleAddToPalette(e)})),ve.Pc(1),ve.Ub()}if(2&e){var i=t.$implicit;ve.Db(1),ve.Rc(" Add to ",i.label," ")}}function Vu(e,t){1&e&&ve.Qb(0,"mat-divider")}var Du,Eu=((Du=function(){function e(t,n,i,o){l(this,e),this.store=t,this.dialog=n,this.snackbar=i,this.editService=o,this.ngUnsubscribe=new C.a}return u(e,[{key:"recipe",get:function(){return this._recipe},set:function(e){this._recipe=e}},{key:"ngOnInit",value:function(){}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"handleAddToPalette",value:function(e){this.store.dispatch(new fi.c(this.recipe,e.id)),this.store.dispatch(new fi.m(e.id,!0)),this.snackbar.open("Successfully added to '".concat(e.label,"' palette."))}},{key:"handleNewPalette",value:function(){var e=this,t=new Hp;t.recipes.push(this.recipe),this.dialog.open(cu,{width:"480px",data:{palette:t}}).afterClosed().pipe(Object(N.a)(this.ngUnsubscribe),Object(R.a)((function(e){return!Object(ce.isNil)(e)}))).subscribe((function(t){e.store.dispatch(new fi.a(t))}))}}]),e}()).\u0275fac=function(e){return new(e||Du)(ve.Pb(y.h),ve.Pb(re.b),ve.Pb(ke.b),ve.Pb(Jo))},Du.\u0275cmp=ve.Jb({type:Du,selectors:[["app-edit-paint-panel"]],inputs:{recipe:"recipe"},decls:13,vars:8,consts:[[1,"edit-paint-panel"],[1,"flex-grow",3,"recipe"],[1,"flex","flex-column"],["app-button","","buttonType","outline","buttonSize","small","matTooltip","Add to Palette","matTooltipPosition","above","data-test","addToPaletteButton",1,"pb-2",3,"matMenuTriggerFor"],["icon","plus"],["yPosition","above"],["paletteMenu","matMenu"],["mat-menu-item","","data-test","addToExistingPalette",3,"click",4,"ngFor","ngForOf"],[4,"ngIf"],["mat-menu-item","","data-test","addPaintToNewPaletteButton",3,"click"],["mat-menu-item","","data-test","addToExistingPalette",3,"click"]],template:function(e,t){if(1&e&&(ve.Vb(0,"div",0),ve.Qb(1,"app-edit-recipe-summary",1),ve.Vb(2,"div",2),ve.Vb(3,"button",3),ve.Qb(4,"app-icon",4),ve.Ub(),ve.Ub(),ve.Ub(),ve.Vb(5,"mat-menu",5,6),ve.Nc(7,Tu,2,1,"button",7),ve.hc(8,"async"),ve.Nc(9,Vu,1,0,"mat-divider",8),ve.hc(10,"async"),ve.Vb(11,"button",9),ve.cc("click",(function(){return t.handleNewPalette()})),ve.Pc(12," Add to New Palette... "),ve.Ub(),ve.Ub()),2&e){var n,i=ve.yc(6);ve.Db(1),ve.mc("recipe",t.recipe),ve.Db(2),ve.mc("matMenuTriggerFor",i),ve.Db(4),ve.mc("ngForOf",ve.ic(8,4,t.palettes$)),ve.Db(2),ve.mc("ngIf",null==(n=ve.ic(10,6,t.palettes$))?null:n.length)}},directives:[Mu,Pe.a,Ct.c,Ki.d,yt.a,Ki.a,f.o,f.p,Ki.b,_e.a],pipes:[f.b],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.edit-paint-panel[_ngcontent-%COMP%]{color:#fff;display:flex;padding:8px 0;align-items:flex-start}.edit-paint-panel__list[_ngcontent-%COMP%]{flex-grow:1;padding:0 8px;font-size:10px;letter-spacing:.25px;line-height:1.4em;-moz-column-count:2;-moz-column-gap:8px;column-gap:8px;-moz-column-width:50%;columns:50% 2}.edit-paint-panel__item[_ngcontent-%COMP%]{padding-bottom:4px}"],changeDetection:0}),function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);a>3&&r&&Object.defineProperty(t,n,r)}([Object(y.e)(vi.a.getPalettes),Uu("design:type",_.a)],Du.prototype,"palettes$",void 0),Du);function ju(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"button",13),ve.cc("click",(function(){ve.Cc(n);var e=t.$implicit;return ve.gc().handleRecipeClick(e)})),ve.Ub()}if(2&e){var i=t.$implicit;ve.mc("label",i.label)("recipe",i)}}var Nu,Ru=((Nu=function(){function e(t,n,i){l(this,e),this.dialog=t,this.store=n,this.editPaintService=i,this.ngUnsubscribe=new C.a}return u(e,[{key:"palette",get:function(){return this._palette},set:function(e){this._palette=e}},{key:"ngOnInit",value:function(){}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"handleEdit",value:function(e){var t=this;this.dialog.open(cu,{width:"480px",data:{palette:e}}).afterClosed().pipe(Object(N.a)(this.ngUnsubscribe),Object(R.a)((function(e){return!Object(ce.isNil)(e)}))).subscribe((function(e){t.store.dispatch(new fi.n(e))}))}},{key:"handleRemove",value:function(e){this.editPaintService.removePalette(e)}},{key:"handleExport",value:function(e){this.editPaintService.copyPaletteToClipboard(e)}},{key:"handleDownload",value:function(e){this.editPaintService.downloadPalette(e)}},{key:"handlePanelOpened",value:function(e,t){var n=this.store.selectSnapshot(vi.a.getPalettes),i=n.findIndex((function(e){return e.id===t}));i>=0&&(n[i].open=e),this.store.dispatch(new fi.j(n))}},{key:"handleRecipeClick",value:function(e){this.editPaintService.selectRecipe(e)}}]),e}()).\u0275fac=function(e){return new(e||Nu)(ve.Pb(re.b),ve.Pb(y.h),ve.Pb(su))},Nu.\u0275cmp=ve.Jb({type:Nu,selectors:[["app-edit-palette-panel"]],inputs:{palette:"palette"},decls:20,vars:6,consts:[["toggleType","arrow","data-test","palettePanel",3,"open","noPadding","opened"],["panel-label","",1,"text-semibold","ph-3","pv-2"],["data-test","palettePanelLabel"],["panel-actions","","appEventFence","",1,"pv-2"],["app-button","","data-test","palettePanelMenuButton",3,"matMenuTriggerFor"],["icon","ellipsis-v"],[1,"flex","flex-wrap","ph-3","pb-2"],["app-paint-swatch","","class","mr-2 mb-2",3,"label","recipe","click",4,"ngFor","ngForOf"],["menu","matMenu"],["mat-menu-item","","data-test","palettePanelEditButton",3,"click"],["mat-menu-item","","data-test","palettePanelRemoveButton",3,"click"],["mat-menu-item","","data-test","palettePanelCopyButton",3,"click"],["mat-menu-item","","data-test","palettePanelDownloadButton",3,"click"],["app-paint-swatch","",1,"mr-2","mb-2",3,"label","recipe","click"]],template:function(e,t){if(1&e&&(ve.Vb(0,"app-panel",0),ve.cc("opened",(function(e){return t.handlePanelOpened(e,t.palette.id)})),ve.Vb(1,"div",1),ve.Vb(2,"span",2),ve.Pc(3),ve.Ub(),ve.Ub(),ve.Vb(4,"div",3),ve.Vb(5,"button",4),ve.Qb(6,"app-icon",5),ve.Ub(),ve.Ub(),ve.Vb(7,"div",6),ve.Nc(8,ju,1,2,"button",7),ve.Ub(),ve.Ub(),ve.Vb(9,"mat-menu",null,8),ve.Vb(11,"button",9),ve.cc("click",(function(){return t.handleEdit(t.palette)})),ve.Pc(12," Manage Palette... "),ve.Ub(),ve.Vb(13,"button",10),ve.cc("click",(function(){return t.handleRemove(t.palette)})),ve.Pc(14," Remove... "),ve.Ub(),ve.Qb(15,"mat-divider"),ve.Vb(16,"button",11),ve.cc("click",(function(){return t.handleExport(t.palette)})),ve.Pc(17," Copy palette to clipboard "),ve.Ub(),ve.Vb(18,"button",12),ve.cc("click",(function(){return t.handleDownload(t.palette)})),ve.Pc(19," Download palette "),ve.Ub(),ve.Ub()),2&e){var n=ve.yc(10);ve.mc("open",t.palette.open)("noPadding",!0),ve.Eb("data-test-value",t.palette.id),ve.Db(3),ve.Qc(t.palette.label),ve.Db(2),ve.mc("matMenuTriggerFor",n),ve.Db(3),ve.mc("ngForOf",t.palette.recipes)}},directives:[Me.a,hu.a,Pe.a,Ki.d,yt.a,f.o,Ki.a,Ki.b,_e.a,iu],styles:[".palette__button[_ngcontent-%COMP%]{cursor:pointer;width:24px;height:24px;display:inline-flex;justify-content:center;align-items:center;background:none;border:none;margin:0;padding:0}"],changeDetection:0}),Nu),Au=o("6eBy"),Fu=o("Assa"),Iu=o("mXx7"),zu=[1,1,1],Lu=100,Bu=0,Qu=0,$u=0,qu=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Gu(e,t){1&e&&(ve.Vb(0,"div",10),ve.Vb(1,"span",11),ve.Pc(2,"Note:"),ve.Ub(),ve.Pc(3," The preset you have selected contains some settings that cannot be customized. "),ve.Ub())}function Hu(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"app-form-field",12),ve.Vb(1,"input",13),ve.cc("colorPickerChange",(function(e){return ve.Cc(n),ve.gc().handleColorPickerChange(e)})),ve.Ub(),ve.Ub()}if(2&e){var i=ve.gc();ve.Db(1),ve.Kc("background",i.colorPickerHex),ve.mc("colorPicker",i.colorPickerHex)("cpOutputFormat","hex")("cpAlphaChannel","disabled")}}function Wu(e,t){1&e&&(ve.Vb(0,"app-form-field",14),ve.Qb(1,"app-slider",15),ve.Ub()),2&e&&(ve.Db(1),ve.mc("min",0)("max",100))}var Ku,Ju=((Ku=function(){function e(t,n,i){l(this,e),this.formBuilder=t,this.store=n,this.changeDetector=i,this.colorPickerHex="#ffffff",this.fresnelColor=!1,this.fresnelOpacity=!1,this.ngUnsubscribe=new C.a,this.form=this.formBuilder.group({tintColor:[a(zu)],saturation:[$u],contrast:[Bu],brightness:[Qu],opacity:[Lu]})}return u(e,[{key:"ngOnInit",value:function(){var e=this;this.colorRecipe$.pipe(Object(R.a)((function(t){return null!=t&&JSON.stringify(t)!==JSON.stringify(e.colorRecipe)}),Object(N.a)(this.ngUnsubscribe))).subscribe((function(t){e.colorRecipe=t,e.fresnelColor=t.tintColor instanceof Fu.a,e.fresnelOpacity=t.opacity instanceof Iu.a,e.setFormValues(t),e.changeDetector.markForCheck()})),this.form.valueChanges.pipe(Object(Au.a)((function(){return Object(S.a)(300)})),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.handleFormChanges(t)}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"setFormValues",value:function(e){var t=zu;Array.isArray(e.tintColor)&&(this.colorPickerHex=ue.a.rgbToHex(e.tintColor,!0),t=e.tintColor);var n=Lu;"number"==typeof e.opacity&&(n=e.opacity);var i=Bu;"number"==typeof e.contrast&&(i=e.contrast);var o=Qu;"number"==typeof e.brightness&&(o=e.brightness);var a=$u;"number"==typeof e.saturation&&(a=e.saturation),this.form.setValue({tintColor:t,saturation:a,contrast:i,brightness:o,opacity:n},{emitEvent:!1,onlySelf:!0})}},{key:"handleFormChanges",value:function(e){var t=Object.assign({},this.colorRecipe);t.saturation=e.saturation,t.brightness=e.brightness,t.contrast=e.contrast,this.fresnelOpacity||(t.opacity=e.opacity),this.fresnelColor||(t.tintColor="string"==typeof e.tintColor?ue.a.hexToRgb(e.tintColor,!0):e.tintColor),this.store.dispatch(new fi.h(t))}},{key:"handleColorPickerChange",value:function(e){this.colorPickerHex=e,this.form.patchValue({tintColor:ue.a.hexToRgb(e,!0)})}}]),e}()).\u0275fac=function(e){return new(e||Ku)(ve.Pb(ae.f),ve.Pb(y.h),ve.Pb(ve.i))},Ku.\u0275cmp=ve.Jb({type:Ku,selectors:[["app-paint-widget"]],inputs:{label:"label"},decls:10,vars:10,consts:[["autocomplete","off",3,"formGroup"],["class","text-dim text-12 pb-4",4,"ngIf"],["label","Color",4,"ngIf"],["label","Saturation"],["formControlName","saturation",3,"min","max"],["label","Contrast"],["formControlName","contrast",3,"min","max"],["label","Brightness"],["formControlName","brightness",3,"min","max"],["label","Opacity",4,"ngIf"],[1,"text-dim","text-12","pb-4"],[1,"text-bold"],["label","Color"],["type","text","cpPosition","left",1,"input",3,"colorPicker","cpOutputFormat","cpAlphaChannel","colorPickerChange"],["label","Opacity"],["formControlName","opacity",3,"min","max"]],template:function(e,t){1&e&&(ve.Vb(0,"form",0),ve.Nc(1,Gu,4,0,"div",1),ve.Nc(2,Hu,2,5,"app-form-field",2),ve.Vb(3,"app-form-field",3),ve.Qb(4,"app-slider",4),ve.Ub(),ve.Vb(5,"app-form-field",5),ve.Qb(6,"app-slider",6),ve.Ub(),ve.Vb(7,"app-form-field",7),ve.Qb(8,"app-slider",8),ve.Ub(),ve.Nc(9,Wu,2,2,"app-form-field",9),ve.Ub()),2&e&&(ve.mc("formGroup",t.form),ve.Db(1),ve.mc("ngIf",t.fresnelColor||t.fresnelOpacity),ve.Db(1),ve.mc("ngIf",!t.fresnelColor),ve.Db(2),ve.mc("min",-100)("max",100),ve.Db(2),ve.mc("min",-100)("max",100),ve.Db(2),ve.mc("min",-100)("max",100),ve.Db(1),ve.mc("ngIf",!t.fresnelOpacity))},directives:[ae.E,ae.s,ae.j,f.p,Oe.a,To.a,ae.r,ae.i,Tt.a],styles:[""],changeDetection:0}),function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);a>3&&r&&Object.defineProperty(t,n,r)}([Object(y.e)(vi.a.getCurrentRecipe),qu("design:type",_.a)],Ku.prototype,"colorRecipe$",void 0),Ku),Xu=["tabsEl"];function Zu(e,t){if(1&e&&(ve.Tb(0),ve.Vb(1,"app-form-field",14),ve.Qb(2,"app-slider",15),ve.Ub(),ve.Sb()),2&e){var n=ve.gc();ve.Db(2),ve.mc("min",n.min)("max",n.max)}}function Yu(e,t){1&e&&(ve.Tb(0),ve.Vb(1,"app-form-field",16),ve.Qb(2,"app-color-picker-input",17),ve.Ub(),ve.Sb())}function ed(e,t){if(1&e&&(ve.Tb(0),ve.Vb(1,"app-form-field",18),ve.Qb(2,"app-slider",15),ve.Ub(),ve.Vb(3,"app-form-field",19),ve.Qb(4,"app-slider",15),ve.Ub(),ve.Sb()),2&e){var n=ve.gc();ve.Db(2),ve.mc("min",n.fresnelMin)("max",n.fresnelMax),ve.Db(2),ve.mc("min",n.fresnelMin)("max",n.fresnelMax)}}function td(e,t){1&e&&(ve.Tb(0),ve.Vb(1,"app-form-field",18),ve.Qb(2,"app-color-picker-input",17),ve.Ub(),ve.Vb(3,"app-form-field",19),ve.Qb(4,"app-color-picker-input",17),ve.Ub(),ve.Sb())}var nd,id,od=((nd=function(){function e(t){l(this,e),this.formBuilder=t,this.min=0,this.max=100,this.fresnelMin=0,this.fresnelMax=100,this._value=null,this.simpleMode="number",this.fresnelMode="scalar",this.valueUpdated=new ve.p,this._colorMode="numeric",this.ngUnsubscribe=new C.a,this.form=this.formBuilder.group({numericValue:[0],hexValue:["#ff0000"],fresnel:this.formBuilder.group({center:this.formBuilder.group({numericValue:[100],hexValue:["#ff0000"]}),edge:this.formBuilder.group({numericValue:[0],hexValue:["#0000ff"]}),centerBias:[100],edgeBias:[0],power:[1]})})}return u(e,[{key:"value",get:function(){return this._value},set:function(e){Object(ce.isEqual)(e,this.value)||(this._value=e,this.setFormValues(e))}},{key:"colorMode",get:function(){return this._colorMode},set:function(e){this._colorMode=e}},{key:"ngOnInit",value:function(){var e=this;this.form.valueChanges.pipe(Object(Un.a)(300),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.emitCurrentValue()}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"setFormValues",value:function(e){"number"==typeof e?(this.setSimpleValues(e),this.colorMode="numeric"):Array.isArray(e)?(this.setRGBValues(e),this.colorMode="numeric"):gi.a.isFresnel(e)&&(Array.isArray(e.center)?this.setColorFresnesValues(e):this.setScalarFresnesValues(e),this.colorMode="fresnel")}},{key:"setSimpleValues",value:function(e){this.form.patchValue({numericValue:e},{emitEvent:!1,onlySelf:!0})}},{key:"setRGBValues",value:function(e){var t=ue.a.rgbToHex(e,!0);this.form.patchValue({hexValue:t},{emitEvent:!1,onlySelf:!0})}},{key:"setScalarFresnesValues",value:function(e){var t=e.edge,n=e.center,i=e.edgeBias,o=e.centerBias,a=e.power;this.form.patchValue({fresnel:{edge:{numericValue:100*t},center:{numericValue:100*n},edgeBias:100*i,centerBias:100*o,power:a}},{emitEvent:!1,onlySelf:!0})}},{key:"setColorFresnesValues",value:function(e){var t=e.edge,n=e.center,i=e.centerBias,o=e.edgeBias,a=e.power,r=ue.a.rgbToHex(t,!0),c=ue.a.rgbToHex(n,!0);this.form.patchValue({fresnel:{edge:{hexValue:r},center:{hexValue:c},edgeBias:100*o,centerBias:100*i,power:a}},{emitEvent:!1,onlySelf:!0})}},{key:"setColorMode",value:function(e){this.colorMode=0===e?"numeric":"fresnel",this.emitCurrentValue()}},{key:"emitCurrentValue",value:function(){var e=this.getColorValue();this.valueUpdated.emit(e)}},{key:"getColorValue",value:function(){var e=this.form.value;switch(this.colorMode){case"fresnel":return"color"===this.fresnelMode?this.getColorFresnelValue(e):this.getSclarFresnelValue(e);case"numeric":default:return"number"===this.simpleMode?this.getSimpleValue(e):this.getRGBValue(e)}}},{key:"getSimpleValue",value:function(e){return e.numericValue}},{key:"getRGBValue",value:function(e){var t=e.hexValue;return ue.a.hexToRgb(t,!0)}},{key:"getColorFresnelValue",value:function(e){var t=e.fresnel,n=t.edge,i=t.center,o=t.edgeBias,a=t.centerBias,r=t.power,c=ue.a.hexToRgb(n.hexValue,!0),s=ue.a.hexToRgb(i.hexValue,!0);return new Fu.a({edge:c,center:s,edgeBias:o/100,centerBias:a/100,power:r})}},{key:"getSclarFresnelValue",value:function(e){var t=e.fresnel,n=t.edge,i=t.center,o=t.centerBias,a=t.edgeBias,r=t.power;return new Iu.a({edge:n.numericValue/100,center:i.numericValue/100,centerBias:o/100,edgeBias:a/100,power:r})}}]),e}()).\u0275fac=function(e){return new(e||nd)(ve.Pb(ae.f))},nd.\u0275cmp=ve.Jb({type:nd,selectors:[["app-paint-recipe"]],viewQuery:function(e,t){var n;1&e&&ve.Jc(Xu,!0),2&e&&ve.xc(n=ve.dc())&&(t.tabs=n.first)},inputs:{min:"min",max:"max",fresnelMin:"fresnelMin",fresnelMax:"fresnelMax",value:"value",simpleMode:"simpleMode",fresnelMode:"fresnelMode"},outputs:{valueUpdated:"valueUpdated"},decls:17,vars:14,consts:[[1,"recipe",3,"formGroup"],["tabSize","small","tabTheme","dark",3,"activeTab","activeTabChange"],["tabsEl",""],["label","Simple",3,"ngSwitch"],[1,"pt-2","pl-1"],[4,"ngSwitchCase"],["label","Advanced",3,"ngSwitch"],["formGroupName","fresnel",1,"pt-2","pl-1"],["label","Center Bias"],["formControlName","centerBias",3,"min","max"],["label","Edge Bias"],["formControlName","edgeBias",3,"min","max"],["label","Power"],["formControlName","power",3,"min","max"],["label","Value"],["formControlName","numericValue",3,"min","max"],["label","Color"],["formControlName","hexValue"],["label","Center","formGroupName","center"],["label","Edge","formGroupName","edge"]],template:function(e,t){1&e&&(ve.Vb(0,"form",0),ve.Vb(1,"app-tabs",1,2),ve.cc("activeTabChange",(function(e){return t.setColorMode(e)})),ve.Vb(3,"app-tab",3),ve.Vb(4,"div",4),ve.Nc(5,Zu,3,2,"ng-container",5),ve.Nc(6,Yu,3,0,"ng-container",5),ve.Ub(),ve.Ub(),ve.Vb(7,"app-tab",6),ve.Vb(8,"div",7),ve.Nc(9,ed,5,4,"ng-container",5),ve.Nc(10,td,5,0,"ng-container",5),ve.Vb(11,"app-form-field",8),ve.Qb(12,"app-slider",9),ve.Ub(),ve.Vb(13,"app-form-field",10),ve.Qb(14,"app-slider",11),ve.Ub(),ve.Vb(15,"app-form-field",12),ve.Qb(16,"app-slider",13),ve.Ub(),ve.Ub(),ve.Ub(),ve.Ub(),ve.Ub()),2&e&&(ve.mc("formGroup",t.form),ve.Db(1),ve.mc("activeTab","numeric"===t.colorMode?0:1),ve.Db(2),ve.mc("ngSwitch",t.simpleMode),ve.Db(2),ve.mc("ngSwitchCase","number"),ve.Db(1),ve.mc("ngSwitchCase","rgb"),ve.Db(1),ve.mc("ngSwitch",t.fresnelMode),ve.Db(2),ve.mc("ngSwitchCase","scalar"),ve.Db(1),ve.mc("ngSwitchCase","color"),ve.Db(2),ve.mc("min",0)("max",100),ve.Db(2),ve.mc("min",0)("max",100),ve.Db(2),ve.mc("min",1)("max",5))},directives:[ae.E,ae.s,ae.j,_o.a,Mo.a,f.r,f.s,ae.k,Oe.a,To.a,ae.r,ae.i,Vt],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.recipe__heading[_ngcontent-%COMP%]{margin-top:4px;margin-bottom:4px;font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase;font-weight:700;color:#96a8c0}.theme-light[_nghost-%COMP%]   .recipe__heading[_ngcontent-%COMP%], .theme-light   [_nghost-%COMP%]   .recipe__heading[_ngcontent-%COMP%]{color:1px solid #374a68}.recipe__group[_ngcontent-%COMP%]{padding-top:4px;padding-bottom:4px;border-top:1px solid #1c2a3f}.theme-light[_nghost-%COMP%]   .recipe__group[_ngcontent-%COMP%], .theme-light   [_nghost-%COMP%]   .recipe__group[_ngcontent-%COMP%]{border-top:1px solid #eaeff5}"],changeDetection:0}),nd),ad=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},rd=["tintColorRef"],cd=["saturationRef"],sd=["contrastRef"],ld=["brightnessRef"],pd=["opacityRef"],ud=((id=function(){function e(t,n,i){l(this,e),this.formBuilder=t,this.store=n,this.changeDetector=i,this.colorRecipe=new gi.a,this.paintBrushMode=qp.a,this.ngUnsubscribe=new C.a;var o=this.store.selectSnapshot(vi.a.getCurrentRecipe),a=o.tintColor,r=o.saturation,c=o.contrast,s=o.brightness,p=o.opacity,u=this.store.selectSnapshot(vi.a.getPaintBrushMode);this.form=this.formBuilder.group({tintColorEnabled:this.isColorValueEnabled(a),saturationEnabled:this.isColorValueEnabled(r),contrastEnabled:this.isColorValueEnabled(c),brightnessEnabled:this.isColorValueEnabled(s),opacityEnabled:this.isColorValueEnabled(p),paintBrushMode:u})}return u(e,[{key:"ngOnInit",value:function(){var e=this;this.colorRecipe$.pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.colorRecipe=t,e.changeDetector.markForCheck()})),this.form.valueChanges.pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.handleFormChanges(t)}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"handleFormChanges",value:function(e){this.handleRecipeUpdates({tintColor:this.tintColorRef.value,saturation:this.saturationRef.value,contrast:this.contrastRef.value,brightness:this.brightnessRef.value,opacity:this.opacityRef.value}),this.store.dispatch(new fi.i(e.paintBrushMode))}},{key:"handleTintColorUpdates",value:function(e){this.colorRecipe=Object.assign(Object.assign({},this.colorRecipe),{tintColor:e}),this.isFeatureEnabled("tintColor")&&this.handleRecipeUpdates(this.colorRecipe)}},{key:"handleOpacityUpdates",value:function(e){this.colorRecipe=Object.assign(Object.assign({},this.colorRecipe),{opacity:e}),this.isFeatureEnabled("opacity")&&this.handleRecipeUpdates(this.colorRecipe)}},{key:"handleContrastUpdates",value:function(e){this.colorRecipe=Object.assign(Object.assign({},this.colorRecipe),{contrast:e}),this.isFeatureEnabled("contrast")&&this.handleRecipeUpdates(this.colorRecipe)}},{key:"handleBrightnessUpdates",value:function(e){this.colorRecipe=Object.assign(Object.assign({},this.colorRecipe),{brightness:e}),this.isFeatureEnabled("brightness")&&this.handleRecipeUpdates(this.colorRecipe)}},{key:"handleSaturationUpdates",value:function(e){this.colorRecipe=Object.assign(Object.assign({},this.colorRecipe),{saturation:e}),this.isFeatureEnabled("saturation")&&this.handleRecipeUpdates(this.colorRecipe)}},{key:"handleRecipeUpdates",value:function(e){var t=this.store.selectSnapshot(vi.a.getCurrentRecipe),n=e.tintColor,i=e.saturation,o=e.contrast,a=e.brightness,r=e.opacity,c={tintColor:this.isFeatureEnabled("tintColor")?n||[1,0,0]:void 0,saturation:this.isFeatureEnabled("saturation")?i||0:void 0,contrast:this.isFeatureEnabled("contrast")?o||0:void 0,brightness:this.isFeatureEnabled("brightness")?a||0:void 0,opacity:this.isFeatureEnabled("opacity")?r||100:void 0};Object(ce.isEqual)(c,t)||this.store.dispatch(new fi.h(c))}},{key:"isFeatureEnabled",value:function(e){return!0===this.form.get(e+"Enabled").value}},{key:"isColorValueEnabled",value:function(e){return!Object(ce.isNil)(e)&&!1!==e}}]),e}()).\u0275fac=function(e){return new(e||id)(ve.Pb(ae.f),ve.Pb(y.h),ve.Pb(ve.i))},id.\u0275cmp=ve.Jb({type:id,selectors:[["app-paint-widget-advanced"]],viewQuery:function(e,t){var n;1&e&&(ve.Jc(rd,!0),ve.Jc(cd,!0),ve.Jc(sd,!0),ve.Jc(ld,!0),ve.Jc(pd,!0)),2&e&&(ve.xc(n=ve.dc())&&(t.tintColorRef=n.first),ve.xc(n=ve.dc())&&(t.saturationRef=n.first),ve.xc(n=ve.dc())&&(t.contrastRef=n.first),ve.xc(n=ve.dc())&&(t.brightnessRef=n.first),ve.xc(n=ve.dc())&&(t.opacityRef=n.first))},inputs:{label:"label"},decls:16,vars:26,consts:[["autocomplete","off",3,"formGroup"],["label","Color","toggleType","checkbox","formControlName","tintColorEnabled"],["simpleMode","rgb","fresnelMode","color",3,"value","min","max","fresnelMin","fresnelMax","valueUpdated"],["tintColorRef",""],["label","Saturation","toggleType","checkbox","formControlName","saturationEnabled"],[3,"value","min","max","fresnelMin","fresnelMax","valueUpdated"],["saturationRef",""],["label","Contrast","toggleType","checkbox","formControlName","contrastEnabled"],["contrastRef",""],["label","Brightness","toggleType","checkbox","formControlName","brightnessEnabled"],["brightnessRef",""],["label","Opacity","toggleType","checkbox","formControlName","opacityEnabled"],["opacityRef",""]],template:function(e,t){1&e&&(ve.Vb(0,"form",0),ve.Vb(1,"app-panel",1),ve.Vb(2,"app-paint-recipe",2,3),ve.cc("valueUpdated",(function(e){return t.handleTintColorUpdates(e)})),ve.Ub(),ve.Ub(),ve.Vb(4,"app-panel",4),ve.Vb(5,"app-paint-recipe",5,6),ve.cc("valueUpdated",(function(e){return t.handleSaturationUpdates(e)})),ve.Ub(),ve.Ub(),ve.Vb(7,"app-panel",7),ve.Vb(8,"app-paint-recipe",5,8),ve.cc("valueUpdated",(function(e){return t.handleContrastUpdates(e)})),ve.Ub(),ve.Ub(),ve.Vb(10,"app-panel",9),ve.Vb(11,"app-paint-recipe",5,10),ve.cc("valueUpdated",(function(e){return t.handleBrightnessUpdates(e)})),ve.Ub(),ve.Ub(),ve.Vb(13,"app-panel",11),ve.Vb(14,"app-paint-recipe",5,12),ve.cc("valueUpdated",(function(e){return t.handleOpacityUpdates(e)})),ve.Ub(),ve.Ub(),ve.Ub()),2&e&&(ve.mc("formGroup",t.form),ve.Db(2),ve.mc("value",t.colorRecipe.tintColor)("min",0)("max",255)("fresnelMin",0)("fresnelMax",100),ve.Db(3),ve.mc("value",t.colorRecipe.saturation)("min",-100)("max",100)("fresnelMin",-100)("fresnelMax",100),ve.Db(3),ve.mc("value",t.colorRecipe.contrast)("min",-100)("max",100)("fresnelMin",-100)("fresnelMax",100),ve.Db(3),ve.mc("value",t.colorRecipe.brightness)("min",-100)("max",100)("fresnelMin",-100)("fresnelMax",100),ve.Db(3),ve.mc("value",t.colorRecipe.opacity)("min",0)("max",100)("fresnelMin",0)("fresnelMax",100))},directives:[ae.E,ae.s,ae.j,Me.a,ae.r,ae.i,od],styles:[""],changeDetection:0}),function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);a>3&&r&&Object.defineProperty(t,n,r)}([Object(y.e)(vi.a.getCurrentRecipe),ad("design:type",_.a)],id.prototype,"colorRecipe$",void 0),id);function dd(e,t){1&e&&(ve.Vb(0,"span"),ve.Pc(1,"structure"),ve.Ub())}function md(e,t){1&e&&(ve.Vb(0,"span"),ve.Pc(1,"structures"),ve.Ub())}var hd,bd=((hd=function(){function e(t,n){l(this,e),this.store=t,this.changeDetector=n,this.ngUnsubscribe=new C.a}return u(e,[{key:"ngOnInit",value:function(){var e=this;this.store.select(ln.a.getCheckedNodeIds).pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.count=t.length,e.changeDetector.markForCheck()}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"handleClearClick",value:function(){this.store.dispatch(new fn.a.UpdateNodesChecked(!1))}}]),e}()).\u0275fac=function(e){return new(e||hd)(ve.Pb(y.h),ve.Pb(ve.i))},hd.\u0275cmp=ve.Jb({type:hd,selectors:[["app-selected-nodes-panel"]],decls:10,vars:5,consts:[[1,"panel","text-11","text-uppercase"],[1,"panel__count"],[4,"ngIf"],[1,"panel__clear"],["buttonSize","small","app-button","",3,"click"]],template:function(e,t){1&e&&(ve.Vb(0,"div",0),ve.Vb(1,"div",1),ve.Pc(2),ve.hc(3,"number"),ve.Nc(4,dd,2,0,"span",2),ve.Nc(5,md,2,0,"span",2),ve.Pc(6," selected "),ve.Ub(),ve.Vb(7,"div",3),ve.Vb(8,"button",4),ve.cc("click",(function(){return t.handleClearClick()})),ve.Pc(9,"Clear"),ve.Ub(),ve.Ub(),ve.Ub()),2&e&&(ve.Db(2),ve.Rc(" ",ve.ic(3,3,t.count)," "),ve.Db(2),ve.mc("ngIf",1===t.count),ve.Db(1),ve.mc("ngIf",t.count>1))},directives:[f.p,Pe.a],pipes:[f.f],styles:[".panel[_ngcontent-%COMP%]{color:#fff;display:flex;padding:8px;justify-content:space-between;align-items:center}.panel__count[_ngcontent-%COMP%]{flex:1 0 auto}.panel__clear[_ngcontent-%COMP%]{flex:0 0 auto;opacity:.3}"],changeDetection:0}),hd),fd=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},gd=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function vd(e,t){1&e&&ve.Qb(0,"app-edit-palette-panel",18),2&e&&ve.mc("palette",t.$implicit)}function yd(e,t){1&e&&ve.Qb(0,"app-paint-widget")}function xd(e,t){if(1&e&&(ve.Vb(0,"app-column-group",19,20),ve.Tb(2,11),ve.Vb(3,"div",21),ve.Nc(4,yd,1,0,"app-paint-widget",17),ve.Ub(),ve.Sb(),ve.Ub()),2&e){var n=ve.yc(1);ve.Db(4),ve.mc("ngIf",n.isActive)}}function Cd(e,t){1&e&&ve.Qb(0,"app-paint-widget-advanced")}function kd(e,t){if(1&e&&(ve.Vb(0,"app-column-group",19,22),ve.Tb(2,11),ve.Nc(3,Cd,1,0,"app-paint-widget-advanced",17),ve.Sb(),ve.Ub()),2&e){var n=ve.yc(1);ve.Db(3),ve.mc("ngIf",n.isActive)}}function Pd(e,t){if(1&e){var n=ve.Wb();ve.Tb(0),ve.Qb(1,"app-selected-nodes-panel"),ve.Vb(2,"button",23),ve.cc("click",(function(){return ve.Cc(n),ve.gc().handlePaintNodesClick()})),ve.Pc(3," Apply Paint "),ve.Ub(),ve.Sb()}}var Od,wd=((Od=function(){function e(t,n,i,o){l(this,e),this.store=t,this.actions=n,this.changeDetector=i,this.editPaintService=o,this.activeToolEnum=ne.a,this.application=fe.a,this.ngUnsubscribe=new C.a}return u(e,[{key:"ngOnInit",value:function(){this.initInitialRecipe(),this.bindApplicationEvents()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initInitialRecipe",value:function(){null==this.store.selectSnapshot(vi.a.getCurrentRecipe)&&this.store.dispatch(new fi.h(Oa.d))}},{key:"bindApplicationEvents",value:function(){var e=this;this.actions.pipe(Object(y.l)(q.d),Object(R.a)((function(){var t=e.store.selectSnapshot(V.a.getActiveTool);return[ne.a.Paint,ne.a.Eyedropper].includes(t)})),Object(R.a)((function(e){return null!=e.node&&!e.event.srcEvent.shiftKey})),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){switch(e.store.selectSnapshot(V.a.getActiveTool)){case ne.a.Eyedropper:e.handleEyeDropperNodeClicked(t);break;case ne.a.Paint:e.handlePaintNodeClicked(t)}})),this.selectedChapter$.pipe(Object(R.a)((function(e){return null!=e})),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.interactive=t.readyState.model,e.changeDetector.markForCheck()}))}},{key:"handleRecipeClick",value:function(e){this.editPaintService.selectRecipe(e)}},{key:"handleClickTool",value:function(e){this.store.dispatch(new q.w(e))}},{key:"handleClearChapterPaint",value:function(){var e=this.store.selectSnapshot(ln.a.getNodeIds);this.paintNodes(e,Oa.c)}},{key:"handleImportPalette",value:function(){this.editPaintService.openImportPalette()}},{key:"handlePaintNodesClick",value:function(){var e=this.store.selectSnapshot(vi.a.getCurrentRecipe),t=this.store.selectSnapshot(ln.a.getNodes),n=Object.values(t).reduce((function(t,n){return t[n.objectId]=n.checked?e:n.paint,t}),{}),i=this.sanitizeRecipe(e);this.store.dispatch(new fn.a.UpdateNodesPaint(i,void 0,n))}},{key:"handleEyeDropperNodeClicked",value:function(e){var t=this.store.selectSnapshot(ln.a.getNodePaint)(e.node.id),n=gi.a.toEngine(t);bi.a.isRealRecipe(n)?this.store.dispatch(new fi.h(t)):this.store.dispatch(new fi.h(Oa.c))}},{key:"handlePaintNodeClicked",value:function(e){var t=this.store.selectSnapshot(vi.a.getCurrentRecipe);this.paintNodes([e.node.id],t)}},{key:"paintNodes",value:function(e,t){this.store.dispatch(new fn.a.UpdateNodesPaint(this.sanitizeRecipe(t),e))}},{key:"sanitizeRecipe",value:function(e){var t=this.store.selectSnapshot(vi.a.getPaintBrushMode),n=Object.assign({},e);return t===qp.a.Replace&&Object.entries(n).forEach((function(e){var t=r(e,2),i=t[0];void 0===t[1]&&(n[i]=!1)})),n}},{key:"handleNext",value:function(){this.store.dispatch(new U.b)}},{key:"handlePrevious",value:function(){this.store.dispatch(new U.d)}},{key:"handleEyedropperClick",value:function(){var e=this.store.selectSnapshot(V.a.getActiveTool)===ne.a.Eyedropper?ne.a.Paint:ne.a.Eyedropper;this.store.dispatch(new q.w(e))}}]),e}()).\u0275fac=function(e){return new(e||Od)(ve.Pb(y.h),ve.Pb(y.b),ve.Pb(ve.i),ve.Pb(su))},Od.\u0275cmp=ve.Jb({type:Od,selectors:[["app-edit-paint-context"]],decls:30,vars:16,consts:[[3,"loading"],["column-label",""],["column-actions",""],["app-button","",3,"selected","click"],["icon","eye-dropper"],["app-button","","data-test","paintMenuButton",1,"context__actions",3,"matMenuTriggerFor"],["icon","ellipsis-v"],["paintMenu","matMenu"],["mat-menu-item","",3,"click"],["mat-menu-item","","data-test","importPaletteButton",3,"click"],["label","Paints"],["column-group-body",""],[3,"palette",4,"ngFor","ngForOf"],["label","Customize",4,"appFlagApplication"],["column-footer",""],[1,"ph-4","pb-4"],[3,"recipe"],[4,"ngIf"],[3,"palette"],["label","Customize"],["customColorGroup",""],[1,"p-3"],["advancedColorGroup",""],["buttonType","outline","app-button","","data-test","applyPaintButton",1,"w-100","mt-2",3,"click"]],template:function(e,t){if(1&e&&(ve.Vb(0,"app-column",0),ve.Vb(1,"div",1),ve.Pc(2,"Paint"),ve.Ub(),ve.Vb(3,"div",2),ve.Vb(4,"button",3),ve.cc("click",(function(){return t.handleEyedropperClick()})),ve.hc(5,"async"),ve.Qb(6,"app-icon",4),ve.Ub(),ve.Vb(7,"button",5),ve.Qb(8,"app-icon",6),ve.Ub(),ve.Vb(9,"mat-menu",null,7),ve.Vb(11,"button",8),ve.cc("click",(function(){return t.handleClearChapterPaint()})),ve.Pc(12,"Clear this chapter's paint"),ve.Ub(),ve.Qb(13,"mat-divider"),ve.Vb(14,"button",9),ve.cc("click",(function(){return t.handleImportPalette()})),ve.Pc(15," Import Palette... "),ve.Ub(),ve.Ub(),ve.Ub(),ve.Vb(16,"app-column-group",10),ve.Tb(17,11),ve.Qb(18,"app-paint-presets"),ve.Qb(19,"app-paint-currently-used"),ve.Nc(20,vd,1,1,"app-edit-palette-panel",12),ve.hc(21,"async"),ve.Sb(),ve.Ub(),ve.Nc(22,xd,5,1,"app-column-group",13),ve.Nc(23,kd,4,1,"app-column-group",13),ve.Vb(24,"div",14),ve.Vb(25,"div",15),ve.Qb(26,"app-edit-paint-panel",16),ve.hc(27,"async"),ve.Nc(28,Pd,4,0,"ng-container",17),ve.hc(29,"async"),ve.Ub(),ve.Ub(),ve.Ub()),2&e){var n,i=ve.yc(10);ve.mc("loading",!t.interactive),ve.Db(4),ve.mc("selected",ve.ic(5,8,t.activeTool$)===t.activeToolEnum.Eyedropper),ve.Db(3),ve.mc("matMenuTriggerFor",i),ve.Db(13),ve.mc("ngForOf",ve.ic(21,10,t.palettes$)),ve.Db(2),ve.mc("appFlagApplication",t.application.Studio),ve.Db(1),ve.mc("appFlagApplication",t.application.Loft),ve.Db(3),ve.mc("recipe",ve.ic(27,12,t.currentRecipe$)),ve.Db(2),ve.mc("ngIf",null==(n=ve.ic(29,14,t.checkedNodes$))?null:n.length)}},directives:[ko,Pe.a,yt.a,Ki.d,Ki.a,Ki.b,_e.a,lo,mu,Ou,f.o,wt.a,Eu,f.p,Ru,Ju,ud,bd],pipes:[f.b],styles:[""],changeDetection:0}),fd([Object(y.e)(V.a.getActiveTool),gd("design:type",_.a)],Od.prototype,"activeTool$",void 0),fd([Object(y.e)(ln.a.getCheckedNodes),gd("design:type",_.a)],Od.prototype,"checkedNodes$",void 0),fd([Object(y.e)(vi.a.getCurrentRecipe),gd("design:type",_.a)],Od.prototype,"currentRecipe$",void 0),fd([Object(y.e)(vi.a.getPalettes),gd("design:type",_.a)],Od.prototype,"palettes$",void 0),fd([Object(y.e)(X.a.getSelectedChapterId),gd("design:type",_.a)],Od.prototype,"selectedChapterId$",void 0),fd([Object(y.e)(X.a.getSelectedChapter),gd("design:type",_.a)],Od.prototype,"selectedChapter$",void 0),Od),Sd=o("GyhO"),_d=o("Xk3F"),Md=o("3fyd"),Ud=o("cAOT"),Td=(o("vCxQ"),o("kmnG")),Vd=function(e){return{"input--success":e}};function Dd(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"div",7),ve.Vb(1,"div",8),ve.Vb(2,"mat-radio-group",9),ve.Qb(3,"mat-radio-button",10),ve.Ub(),ve.Qb(4,"input",11),ve.Vb(5,"button",12),ve.cc("click",(function(){ve.Cc(n);var e=t.index;return ve.gc().handleDeleteOption(e)})),ve.Qb(6,"app-icon",13),ve.Ub(),ve.Ub(),ve.Ub()}if(2&e){var i=t.$implicit,o=t.index,a=ve.gc();ve.Db(1),ve.mc("formGroupName",o),ve.Db(1),ve.mc("formControl",a.correctOptionControl)("name",a.optionGroupName),ve.Db(1),ve.mc("value",i.get("value").value),ve.Db(1),ve.mc("ngClass",ve.pc(6,Vd,i.get("value").value==a.correctOptionControl.value)),ve.Db(1),ve.Eb("aria-label","Delete Question")}}function Ed(e,t){1&e&&(ve.Vb(0,"div",14),ve.Vb(1,"mat-error"),ve.Pc(2," Please select an answer. "),ve.Ub(),ve.Ub())}var jd,Nd=((jd=function(t){e(o,t);var i=n(o);function o(e,t,n,a){var r;return l(this,o),(r=i.call(this)).formBuilder=e,r.changeRef=t,r.store=n,r.actions=a,r.optionGroupName="",r.ngUnsubscribe=new C.a,r.form=r.formBuilder.group({correctAnswer:["",ae.C.required],options:r.formBuilder.array([])}),r.optionGroupName=Ho.a.getUuid(),r}return u(o,[{key:"optionsControl",get:function(){return this.form.get("options")}},{key:"correctOptionControl",get:function(){return this.form.get("correctAnswer")}},{key:"ngOnInit",value:function(){this.initFormListeners(),this.initNodeListeners()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initFormListeners",value:function(){var e=this;this.form.valueChanges.pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.writeValue(t)})),this.optionsControl.valueChanges.pipe(Object(R.a)((function(){return!Object(ce.isNil)(e.form.value.correctAnswer)})),Object(Un.a)(125),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){t.some((function(t){return t.value===e.form.value.correctAnswer}))||(e.form.patchValue({correctAnswer:t[t.length-1].value}),e.changeRef.markForCheck())}))}},{key:"initNodeListeners",value:function(){var e=this;this.actions.pipe(Object(y.l)(q.d),Object(R.a)((function(){return e.store.selectSnapshot(V.a.getActiveTool)===ne.a.Quiz&&e.question.id===e.store.selectSnapshot(ti.b.getActiveQuestionId)})),Object(R.a)((function(e){var t=e.node,n=e.event;return!Object(ce.isNil)(t)&&!n.srcEvent.shiftKey})),Object(j.a)((function(e){return Object(ce.trim)(Object(ce.get)(e,"node.label",""))})),Object(R.a)((function(e){return""!==e})),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.createOption(t),e.changeRef.markForCheck()}))}},{key:"handleAddOptionClick",value:function(e){this.createOption(),e.preventDefault()}},{key:"handleDeleteOption",value:function(e){this.optionsControl.removeAt(e)}},{key:"handleDrop",value:function(e){var t=this,n=e.previousIndex,i=e.currentIndex,o=this.form.value.options,a=Object(he.a)(o,n,i);this.optionsControl.clear(),a.forEach((function(e){t.optionsControl.push(t.formBuilder.group(e))})),this.form.patchValue({options:a})}},{key:"createOption",value:function(e){var t=Object(_d.d)(e);this.optionsControl.push(this.formBuilder.group(t))}},{key:"setFormValues",value:function(e){var t=this,n=e.options;this.optionsControl.length!==n.length&&(this.optionsControl.clear(),n.forEach((function(e){t.optionsControl.push(t.formBuilder.group(e))}))),this.form.patchValue(e),this.changeRef.markForCheck()}}]),o}(Oc.a)).\u0275fac=function(e){return new(e||jd)(ve.Pb(ae.f),ve.Pb(ve.i),ve.Pb(y.h),ve.Pb(y.b))},jd.\u0275cmp=ve.Jb({type:jd,selectors:[["app-edit-quiz-multiple-choice"]],inputs:{question:"question"},features:[ve.Cb([{provide:ae.p,useExisting:Object(ve.W)((function(){return jd})),multi:!0}]),ve.Ab],decls:8,vars:3,consts:[["label","Answers",3,"formGroup"],["formArrayName","options","cdkDropList","",3,"cdkDropListDropped"],["class","mb-2","data-test","questionAnswer","cdkDrag","",4,"ngFor","ngForOf"],[1,"flex","flex-row","items-center"],[3,"click"],[1,"text-12","text-dim"],["class","mt-1",4,"ngIf"],["data-test","questionAnswer","cdkDrag","",1,"mb-2"],[1,"flex","flex-row","items-center",3,"formGroupName"],["data-test","questionAnswerCorrect",3,"formControl","name"],[3,"value"],["type","text","formControlName","label","placeholder","Enter a response","data-test","questionAnswerLabel",1,"input",3,"ngClass"],["app-button","","buttonType","text","buttonTheme","dark","buttonSize","small","type","button","title","Delete Question",3,"click"],["icon","times","size","lg"],[1,"mt-1"]],template:function(e,t){1&e&&(ve.Vb(0,"app-form-field",0),ve.Vb(1,"div",1),ve.cc("cdkDropListDropped",(function(e){return t.handleDrop(e)})),ve.Nc(2,Dd,7,8,"div",2),ve.Vb(3,"div",3),ve.Vb(4,"mat-radio-button",4),ve.cc("click",(function(e){return t.handleAddOptionClick(e)})),ve.Vb(5,"span",5),ve.Pc(6,"Add Option"),ve.Ub(),ve.Ub(),ve.Ub(),ve.Ub(),ve.Nc(7,Ed,3,0,"div",6),ve.Ub()),2&e&&(ve.mc("formGroup",t.form),ve.Db(2),ve.mc("ngForOf",t.optionsControl.controls),ve.Db(5),ve.mc("ngIf",t.optionsControl.controls.length>0&&!t.correctOptionControl.valid))},directives:[Oe.a,ae.s,ae.j,ae.e,vt.c,f.o,Dt.a,f.p,vt.a,ae.k,Dt.b,ae.r,ae.h,ae.c,ae.i,f.m,Pe.a,yt.a,Td.b],styles:[""],changeDetection:0}),jd),Rd=o("WwWM"),Ad=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Fd(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"div",10),ve.Vb(1,"div",11),ve.Pc(2),ve.Ub(),ve.Vb(3,"button",12),ve.cc("click",(function(){ve.Cc(n);var e=t.$implicit;return ve.gc().handleDeleteSelectionClick(e.id)})),ve.Qb(4,"app-icon",13),ve.Ub(),ve.Ub()}if(2&e){var i=t.$implicit;ve.Db(1),ve.Eb("data-id",i.id),ve.Db(1),ve.Qc(i.label),ve.Db(1),ve.Eb("aria-label","Delete Selection")}}var Id,zd=((Id=function(t){e(o,t);var i=n(o);function o(e,t,n,a,r,c){var s;return l(this,o),(s=i.call(this)).store=e,s.actions=t,s.formBuilder=n,s.changeRef=a,s.graphService=r,s.viewService=c,s.ngUnsubscribe=new C.a,s.form=s.formBuilder.group({showAnswerList:[!1],selectType:"all",correctAnswer:s.formBuilder.array([])}),s}return u(o,[{key:"ngOnInit",value:function(){this.initFormListeners(),this.initNodeListeners()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initFormListeners",value:function(){var e=this;this.form.valueChanges.pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.writeValue(t);var n=t.correctAnswer,i=e.store.selectSnapshot(V.a.getViewGraph);e.nodes=e.graphService.getNodes(i,n),e.changeRef.markForCheck()}))}},{key:"initNodeListeners",value:function(){var e=this;this.activeQuestion$.pipe(Object(B.a)((function(){e.viewService.clearSelectedNodes()})),Object(R.a)((function(){return e.question.id===e.store.selectSnapshot(ti.b.getActiveQuestionId)})),Object(N.a)(this.ngUnsubscribe)).subscribe((function(){setTimeout((function(){e.selectNodes(e.value.correctAnswer,!0)}))})),this.actions.pipe(Object(y.l)(q.d),Object(R.a)((function(){return e.store.selectSnapshot(V.a.getActiveTool)===ne.a.Quiz&&e.question.id===e.store.selectSnapshot(ti.b.getActiveQuestionId)})),Object(R.a)((function(e){var t=e.node,n=e.event;return!Object(ce.isNil)(t)&&!n.srcEvent.shiftKey})),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){var n=t.hit?t.hit.objectId:"";if(n){var i=e.store.selectSnapshot(ln.a.getNodes);e.selectNodes([n],!i[n].checked)}e.changeRef.markForCheck()}))}},{key:"handleDeleteSelectionClick",value:function(e){this.selectNodes([e],!1)}},{key:"setFormValues",value:function(e){this.form.setControl("correctAnswer",this.formBuilder.array(e.correctAnswer)),this.form.patchValue(e),this.changeRef.markForCheck()}},{key:"selectNodes",value:function(e,t){this.store.dispatch(new fn.a.UpdateNodesChecked(t,e));var n=this.form.value,i=n.showAnswerList,o=n.selectType,r=a(n.correctAnswer);r=t?[].concat(a(r),a(e.filter((function(e){return!r.includes(e)})))):a(r.filter((function(t){return!e.includes(t)}))),this.setFormValues({showAnswerList:i,selectType:o,correctAnswer:r})}}]),o}(Oc.a)).\u0275fac=function(e){return new(e||Id)(ve.Pb(y.h),ve.Pb(y.b),ve.Pb(ae.f),ve.Pb(ve.i),ve.Pb(wa.a),ve.Pb(Rd.a))},Id.\u0275cmp=ve.Jb({type:Id,selectors:[["app-edit-quiz-select-anatomy"]],inputs:{question:"question"},features:[ve.Cb([{provide:ae.p,useExisting:Object(ve.W)((function(){return Id})),multi:!0}]),ve.Ab],decls:16,vars:4,consts:[[3,"formGroup"],["label","ANSWERS (Select the anatomy in 3D)",3,"uppercase","isCompact"],[1,"edit-quiz-select-anatomy__group"],["class","flex flex-row items-center justify-between","data-test","questionAnswer",4,"ngFor","ngForOf"],["formControlName","showAnswerList"],[1,"text-11"],["label","CORRECT ANSWER"],["formControlName","selectType"],["value","all",1,"mb-2"],["value","any","data-test","questionSelectAny"],["data-test","questionAnswer",1,"flex","flex-row","items-center","justify-between"],[1,"text-12"],["data-test","questionAnswerRemoveButton","app-button","","buttonType","text","buttonTheme","dark","buttonSize","small","type","button","title","Delete Selection",3,"click"],["icon","times","size","lg"]],template:function(e,t){1&e&&(ve.Tb(0,0),ve.Qb(1,"app-form-field",1),ve.Vb(2,"div",2),ve.Nc(3,Fd,5,3,"div",3),ve.Ub(),ve.Vb(4,"app-form-field"),ve.Vb(5,"mat-checkbox",4),ve.Vb(6,"span",5),ve.Pc(7,"Show answer list in the question text"),ve.Ub(),ve.Ub(),ve.Ub(),ve.Vb(8,"app-form-field",6),ve.Vb(9,"mat-radio-group",7),ve.Vb(10,"mat-radio-button",8),ve.Vb(11,"span",5),ve.Pc(12,"Must select all answers listed"),ve.Ub(),ve.Ub(),ve.Vb(13,"mat-radio-button",9),ve.Vb(14,"span",5),ve.Pc(15,"Can select any of the answers listed"),ve.Ub(),ve.Ub(),ve.Ub(),ve.Ub(),ve.Sb()),2&e&&(ve.mc("formGroup",t.form),ve.Db(1),ve.mc("uppercase",!1)("isCompact",!0),ve.Db(2),ve.mc("ngForOf",t.nodes))},directives:[ae.s,ae.j,Oe.a,f.o,Ue.a,ae.r,ae.i,Dt.b,Dt.a,Pe.a,yt.a],styles:[".edit-quiz-select-anatomy__group[_ngcontent-%COMP%]{margin-bottom:24px;display:flex;flex-direction:column;row-gap:4px}"],changeDetection:0}),function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);a>3&&r&&Object.defineProperty(t,n,r)}([Object(y.e)(ti.b.getActiveQuestionId),Ad("design:type",_.a)],Id.prototype,"activeQuestion$",void 0),Id),Ld=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Bd(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"div",5),ve.Vb(1,"div",6),ve.Vb(2,"div",7),ve.Pc(3),ve.Ub(),ve.Vb(4,"div",8),ve.Qb(5,"app-icon",9),ve.Ub(),ve.Ub(),ve.Tb(6,10),ve.Qb(7,"input",11),ve.Sb(),ve.Vb(8,"button",12),ve.cc("click",(function(){ve.Cc(n);var e=t.index;return ve.gc().handleDeleteSelectionClick(e)})),ve.Qb(9,"app-icon",13),ve.Ub(),ve.Ub()}if(2&e){var i=t.index;ve.mc("formGroupName",i),ve.Db(3),ve.Qc(i+1),ve.Db(5),ve.Eb("aria-label","Delete Selection")}}function Qd(e,t){1&e&&ve.Qb(0,"mat-error")}var $d,qd=(($d=function(t){e(o,t);var i=n(o);function o(e,t,n,a,r,c){var s;return l(this,o),(s=i.call(this)).store=e,s.actions=t,s.formBuilder=n,s.changeRef=a,s.graphService=r,s.cameraService=c,s.ngUnsubscribe=new C.a,s.form=s.formBuilder.group({correctAnswer:s.formBuilder.array([]),options:s.formBuilder.array([],s.getLabelValidators())}),s}return u(o,[{key:"optionsControl",get:function(){return this.form.get("options")}},{key:"ngOnInit",value:function(){this.initFormListeners(),this.initNodeListeners(),this.initLabelListeners()}},{key:"ngOnDestroy",value:function(){this.store.dispatch(new q.Y(!0)),this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initFormListeners",value:function(){var e=this;this.form.valueChanges.pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){var n=t.options,i=e.store.selectSnapshot(ti.b.getActiveQuestionLabels),o={correctAnswer:n.map((function(e){return e.value})),options:n.map((function(e){var t=e.value,n=e.label,o=e.model,a=i.find((function(e){return e.value===t}));return{value:t,label:Object.assign(Object.assign({},a?a.label:o),n)}}))};e.writeValue(o),e.changeRef.markForCheck()}))}},{key:"initNodeListeners",value:function(){var e=this;this.actions.pipe(Object(y.l)(q.d),Object(R.a)((function(){return e.store.selectSnapshot(V.a.getActiveTool)===ne.a.Quiz&&e.question.id===e.store.selectSnapshot(ti.b.getActiveQuestionId)})),Object(R.a)((function(e){var t=e.node,n=e.event;return!Object(ce.isNil)(t)&&!n.srcEvent.shiftKey})),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){var n=t.hit;if(n&&n.objectId){var i=n.objectId,o=e.store.selectSnapshot(V.a.getViewGraph),a=r(e.graphService.getNodes(o,[i]),1)[0],c=e.cameraService.getDirection(n),s=Object(_d.c)(a,n,c),l=Object(_d.a)(s);e.addOption(l)}e.changeRef.markForCheck()}))}},{key:"initLabelListeners",value:function(){var e=this;this.activeQuestion$.pipe(Object(io.a)((function(e,t){return Object(ce.isEqual)(e,t)})),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){var n=Object(ce.isNil)(t);e.store.dispatch(new q.Y(n))}))}},{key:"handleDeleteSelectionClick",value:function(e){this.handleDeleteOption(e)}},{key:"setFormValues",value:function(e){var t=e.options;this.optionsControl.length!==t.length&&this.setFormOptions(t),this.form.patchValue(e),this.changeRef.markForCheck()}},{key:"handleDeleteOption",value:function(e){this.optionsControl.removeAt(e)}},{key:"handleDrop",value:function(e){var t=e.previousIndex,n=e.currentIndex,i=this.form.value.options,o=Object(he.a)(i,t,n);this.setFormOptions(i),this.form.patchValue({options:o})}},{key:"setFormOptions",value:function(e){var t=this;this.optionsControl.clear(),e.forEach((function(e){t.addOption(e)}))}},{key:"addOption",value:function(e){this.optionsControl.push(this.formBuilder.group({value:e.value,label:this.formBuilder.group({title:[e.label.title]}),model:e.label}))}},{key:"getLabelValidators",value:function(){return function(e){var t=e.value.map((function(e){return e.value})),n=Object(ce.uniq)(t).length<t.length;return n?{hasDuplicates:n}:null}}}]),o}(Oc.a)).\u0275fac=function(e){return new(e||$d)(ve.Pb(y.h),ve.Pb(y.b),ve.Pb(ae.f),ve.Pb(ve.i),ve.Pb(wa.a),ve.Pb(zi.a))},$d.\u0275cmp=ve.Jb({type:$d,selectors:[["app-edit-quiz-label-anatomy"]],inputs:{question:"question"},features:[ve.Cb([{provide:ae.p,useExisting:Object(ve.W)((function(){return $d})),multi:!0}]),ve.Ab],decls:5,vars:4,consts:[["cdkDropList","",1,"label",3,"formGroup","cdkDropListDropped"],["label","ANSWERS (Select the anatomy to be labeled)","formArrayName","options",3,"uppercase"],["class","flex flex-row items-center justify-between mb-2","cdkDrag","",3,"formGroupName",4,"ngFor","ngForOf"],[1,"mt-1"],[4,"ngIf"],["cdkDrag","",1,"flex","flex-row","items-center","justify-between","mb-2",3,"formGroupName"],["cdkDragHandle","","data-test","questionAnswerNumber",1,"label__pin"],[1,"label__label"],[1,"label__drag"],["icon","grip-lines"],["formGroupName","label"],["type","text","formControlName","title","data-test","questionAnswer",1,"input"],["data-test","questionAnswerRemoveButton","app-button","","buttonType","text","buttonTheme","dark","buttonSize","small","type","button","title","Delete Selection",3,"click"],["icon","times","size","lg"]],template:function(e,t){1&e&&(ve.Vb(0,"div",0),ve.cc("cdkDropListDropped",(function(e){return t.handleDrop(e)})),ve.Vb(1,"app-form-field",1),ve.Nc(2,Bd,10,3,"div",2),ve.Vb(3,"div",3),ve.Nc(4,Qd,1,0,"mat-error",4),ve.Ub(),ve.Ub(),ve.Ub()),2&e&&(ve.mc("formGroup",t.form),ve.Db(1),ve.mc("uppercase",!1),ve.Db(1),ve.mc("ngForOf",t.optionsControl.controls),ve.Db(2),ve.mc("ngIf",!t.optionsControl.valid))},directives:[vt.c,ae.s,ae.j,Oe.a,ae.e,f.o,f.p,vt.a,ae.k,vt.b,yt.a,ae.c,ae.r,ae.i,Pe.a,Td.b],styles:[".label__pin[_ngcontent-%COMP%]{width:40px;height:40px;display:flex;align-items:center;justify-content:center}.label__pin[_ngcontent-%COMP%]:hover{cursor:move}.label__pin[_ngcontent-%COMP%]:hover   .label__label[_ngcontent-%COMP%]{display:none}.label__pin[_ngcontent-%COMP%]:hover   .label__drag[_ngcontent-%COMP%]{display:block}.label__label[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;color:#101823;font-size:10px;width:24px;height:24px;background-image:url(/assets/images/labels/circle.svg);background-repeat:no-repeat;background-position:50%;background-size:auto}.label__drag[_ngcontent-%COMP%]{display:none}"],changeDetection:0}),function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);a>3&&r&&Object.defineProperty(t,n,r)}([Object(y.e)(ti.b.getActiveQuestionId),Ld("design:type",_.a)],$d.prototype,"activeQuestion$",void 0),$d),Gd=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Hd(e,t){if(1&e&&ve.Qb(0,"app-edit-quiz-multiple-choice",29),2&e){var n=ve.gc();ve.mc("question",n.question)}}function Wd(e,t){if(1&e&&ve.Qb(0,"app-edit-quiz-select-anatomy",29),2&e){var n=ve.gc();ve.mc("question",n.question)}}function Kd(e,t){if(1&e&&ve.Qb(0,"app-edit-quiz-label-anatomy",29),2&e){var n=ve.gc();ve.mc("question",n.question)}}function Jd(e,t){1&e&&(ve.Vb(0,"div",17),ve.Vb(1,"app-form-field",30),ve.Qb(2,"app-rich-text-edit",31,16),ve.Ub(),ve.Ub()),2&e&&(ve.Db(2),ve.mc("inline",!0)("compact",!0)("resizeable",!0)("rows",6))}function Xd(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"div",32),ve.Vb(1,"button",33),ve.cc("click",(function(){return ve.Cc(n),ve.gc().handlePreviewCameraClick()})),ve.Pc(2," Preview "),ve.Ub(),ve.Vb(3,"button",34),ve.cc("click",(function(){return ve.Cc(n),ve.gc().handleRemoveCameraClick()})),ve.Pc(4," Remove "),ve.Ub(),ve.Ub()}}var Zd,Yd,em,tm=((Zd=function(){function e(t,n,i,o){l(this,e),this.formBuilder=t,this.store=n,this.cameraService=i,this.changeDetectorRef=o,this.questionTypesMap=Md.c,this.questionDescriptionsMap=Md.b,this.questionTypes=Md.a,this.defaultNextButtonNext=_d.f,this.open=!1,this.opened=new ve.p,this.textLabel=" ",this.ngUnsubscribe=new C.a,this.initForm()}return u(e,[{key:"question",get:function(){return this._question},set:function(e){Object(ce.isEqual)(e,this.question)||(this._question=e,this.setFormValues(e),this.textLabel=this.question.type===Md.a.Instructions?"Text":"Question")}},{key:"quizCamera",get:function(){return Object(ce.get)(this.question,"sceneConfig.camera")}},{key:"ngOnInit",value:function(){this.initFormListeners(),this.initQuestionChangeListeners()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initForm",value:function(){this.form=this.formBuilder.group({questionPrompt:this.formBuilder.group({type:"markdown",markdown:""}),data:[],explanation:this.formBuilder.group({type:"markdown",markdown:""}),nextLabel:"",showChapterLabels:!1,camera:[]})}},{key:"initFormListeners",value:function(){var e=this;this.form.valueChanges.pipe(Object(Un.a)(125),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){var n=Object.assign(Object.assign({},e.question),e.createQuestionFromValues(t));e.store.dispatch(new Ai.a.SetQuestion(n))}))}},{key:"initQuestionChangeListeners",value:function(){var e=this;this.questions$.pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){var n=e.getQuestionIndex(e.question.id);e.questionNum=n+1,e.changeDetectorRef.markForCheck()}))}},{key:"handleOpened",value:function(e){this.opened.emit({panel:this.panel,opened:e})}},{key:"handleRemoveQuestionClick",value:function(){this.store.dispatch(new Ai.a.RemoveQuestions([this.question.id]))}},{key:"handleCaptureCameraClick",value:function(){var e=this.cameraService.getCamera();this.form.patchValue({camera:e})}},{key:"handlePreviewCameraClick",value:function(){var e=this.quizCamera;e&&this.store.dispatch(new Z.l(e.location,!0,1))}},{key:"handleRemoveCameraClick",value:function(){this.form.patchValue({camera:void 0})}},{key:"handlePreviewQuestion",value:function(){var e=this.getQuestionIndex(this.question.id);this.store.dispatch(new U.c(!0,e))}},{key:"setFormValues",value:function(e){var t=e.questionPrompt,n=e.explanation,i=e.data,o=e.sceneConfig,a=e.nextLabel,r=e.showChapterLabels,c=Object(ce.get)(o,"camera.location");this.form.patchValue({questionPrompt:t[0],data:i,explanation:n[0],camera:c,nextLabel:a,showChapterLabels:r},{emitEvent:!1,onlySelf:!0})}},{key:"createQuestionFromValues",value:function(e){var t=e.questionPrompt,n=e.explanation,i=e.data,o=e.camera,a=e.nextLabel,r=e.showChapterLabels,c={};return o&&(c.camera={action:Ud.a.FlyTo,location:o}),{questionPrompt:[t],data:i,explanation:[n],sceneConfig:c,nextLabel:a,showChapterLabels:r}}},{key:"getQuestionIndex",value:function(e){var t=this.store.selectSnapshot(X.a.getStoryChapters).map((function(e){return e.id}));return this.store.selectSnapshot(ti.b.getQuestionIndex(t,e))}}]),e}()).\u0275fac=function(e){return new(e||Zd)(ve.Pb(ae.f),ve.Pb(y.h),ve.Pb(zi.a),ve.Pb(ve.i))},Zd.\u0275cmp=ve.Jb({type:Zd,selectors:[["app-quiz-question-form"]],viewQuery:function(e,t){var n;1&e&&ve.Jc(Me.a,!0),2&e&&ve.xc(n=ve.dc())&&(t.panel=n.first)},inputs:{label:"label",question:"question",open:"open"},outputs:{opened:"opened"},decls:42,vars:19,consts:[["toggleType","arrow","data-test","questionPanel",3,"label","open","opened"],["panel-prefix",""],["data-test","questionNumText",1,"question__pin"],["panel-actions",""],["app-button","","buttonSize","small",3,"matMenuTriggerFor"],["icon","ellipsis-v"],["questionMenu","matMenu"],["mat-menu-item","",3,"click"],[3,"formGroup"],["tabSize","small","tabTheme","dark"],["label","Content"],[1,"mt-5"],["label","Type","matTooltipPosition","left",3,"matTooltip"],[1,"text-12"],["formGroupName","questionPrompt",3,"label"],["data-test","questionPrompt","formControlName","markdown",3,"inline","compact","resizeable","rows"],["questionPrompt",""],[1,"mt-2"],[3,"ngSwitch"],["formControlName","data",3,"question",4,"ngSwitchCase"],["class","mt-2",4,"ngIf"],["label","Advanced"],[1,"mt-4"],["label","Custom Starting Position","formGroupName","camera"],["buttonType","outline","app-button","","data-test","questionMarkPosition",1,"w-100",3,"click"],["class","flex flex-row justify-between mt-3",4,"ngIf"],["label","Next Button Text"],["type","text","formControlName","nextLabel","data-test","questionNextText",1,"input",3,"placeholder"],["formControlName","showChapterLabels","data-test","questionShowChapterLabels"],["formControlName","data",3,"question"],["label","Answer Explanation","formGroupName","explanation"],["formControlName","markdown","data-test","questionExplanation",3,"inline","compact","resizeable","rows"],[1,"flex","flex-row","justify-between","mt-3"],["buttonType","outline","app-button","","data-test","questionPreviewPosition",1,"w-50","mr-1",3,"click"],["buttonType","outline","app-button","","data-test","questionRemovePosition",1,"w-50","ml-1",3,"click"]],template:function(e,t){if(1&e&&(ve.Vb(0,"app-panel",0),ve.cc("opened",(function(e){return t.handleOpened(e)})),ve.Tb(1,1),ve.Vb(2,"div",2),ve.Pc(3),ve.Ub(),ve.Sb(),ve.Vb(4,"div",3),ve.Vb(5,"button",4),ve.Qb(6,"app-icon",5),ve.Ub(),ve.Vb(7,"mat-menu",null,6),ve.Vb(9,"button",7),ve.cc("click",(function(){return t.handlePreviewQuestion()})),ve.Pc(10,"Preview Question"),ve.Ub(),ve.Qb(11,"mat-divider"),ve.Vb(12,"button",7),ve.cc("click",(function(){return t.handleRemoveQuestionClick()})),ve.Pc(13,"Remove"),ve.Ub(),ve.Ub(),ve.Ub(),ve.Vb(14,"div",8),ve.Vb(15,"app-tabs",9),ve.Vb(16,"app-tab",10),ve.Vb(17,"div",11),ve.Vb(18,"app-form-field",12),ve.Vb(19,"span",13),ve.Pc(20),ve.Ub(),ve.Ub(),ve.Vb(21,"app-form-field",14),ve.Qb(22,"app-rich-text-edit",15,16),ve.Ub(),ve.Ub(),ve.Vb(24,"div",17),ve.Tb(25,18),ve.Nc(26,Hd,1,1,"app-edit-quiz-multiple-choice",19),ve.Nc(27,Wd,1,1,"app-edit-quiz-select-anatomy",19),ve.Nc(28,Kd,1,1,"app-edit-quiz-label-anatomy",19),ve.Sb(),ve.Ub(),ve.Nc(29,Jd,4,4,"div",20),ve.Ub(),ve.Vb(30,"app-tab",21),ve.Vb(31,"div",22),ve.Vb(32,"app-form-field",23),ve.Vb(33,"button",24),ve.cc("click",(function(){return t.handleCaptureCameraClick()})),ve.Pc(34," Mark Position "),ve.Ub(),ve.Nc(35,Xd,5,0,"div",25),ve.Ub(),ve.Vb(36,"app-form-field",26),ve.Qb(37,"input",27),ve.Ub(),ve.Vb(38,"app-form-field"),ve.Vb(39,"mat-checkbox",28),ve.Vb(40,"span",13),ve.Pc(41,"Show chapter's labels"),ve.Ub(),ve.Ub(),ve.Ub(),ve.Ub(),ve.Ub(),ve.Ub(),ve.Ub(),ve.Ub()),2&e){var n=ve.yc(8);ve.mc("label",t.label)("open",t.open),ve.Db(3),ve.Rc(" ",t.questionNum," "),ve.Db(2),ve.mc("matMenuTriggerFor",n),ve.Db(9),ve.mc("formGroup",t.form),ve.Db(4),ve.mc("matTooltip",t.questionDescriptionsMap[t.question.type]),ve.Db(2),ve.Qc(t.questionTypesMap[t.question.type]),ve.Db(1),ve.mc("label",t.textLabel),ve.Db(1),ve.mc("inline",!0)("compact",!0)("resizeable",!0)("rows",6),ve.Db(3),ve.mc("ngSwitch",t.question.type),ve.Db(1),ve.mc("ngSwitchCase",t.questionTypes.MultipleChoice),ve.Db(1),ve.mc("ngSwitchCase",t.questionTypes.SelectAnatomy),ve.Db(1),ve.mc("ngSwitchCase",t.questionTypes.LabelAnatomy),ve.Db(1),ve.mc("ngIf",t.question.type!==t.questionTypes.Instructions),ve.Db(6),ve.mc("ngIf",t.quizCamera),ve.Db(2),ve.mc("placeholder",t.defaultNextButtonNext)}},directives:[Me.a,Pe.a,Ki.d,yt.a,Ki.a,Ki.b,_e.a,ae.s,ae.j,_o.a,Mo.a,Oe.a,Ct.c,ae.k,gt,ae.r,ae.i,f.r,f.s,f.p,ae.c,Ue.a,Nd,zd,qd],styles:[".question__pin[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;color:#101823;font-size:10px;width:24px;height:24px;position:relative;left:-8px;top:4px;background-image:url(/assets/images/labels/circle.svg);background-repeat:no-repeat;background-position:50%;background-size:auto}"],changeDetection:0}),function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);a>3&&r&&Object.defineProperty(t,n,r)}([Object(y.e)(ti.b.getAllQuestions),Gd("design:type",_.a)],Zd.prototype,"questions$",void 0),Zd),nm=o("qA9Q"),im=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},om=((Yd=function(){function e(t,n,i){l(this,e),this.formBuilder=t,this.store=n,this.dialogRef=i,this.ngUnsubscribe=new C.a;var o=this.store.selectSnapshot(ti.b.getQuizSettings);this.form=this.formBuilder.group(Object.assign({},o))}return u(e,[{key:"ngOnInit",value:function(){this.initFormListeners(),this.initSettingsListeners()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initFormListeners",value:function(){var e=this;this.form.valueChanges.pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.setQuizSettings(t)}))}},{key:"initSettingsListeners",value:function(){var e=this;this.quizSettings$.pipe(Object(io.a)((function(e,t){return Object(ce.isEqual)(e,t)})),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.setQuizForm(t)}))}},{key:"handleDoneClick",value:function(){this.dialogRef.close()}},{key:"setQuizSettings",value:function(e){this.store.dispatch(new Ai.a.SetQuizSettings(e))}},{key:"setQuizForm",value:function(e){this.form.patchValue(e)}}]),e}()).\u0275fac=function(e){return new(e||Yd)(ve.Pb(ae.f),ve.Pb(y.h),ve.Pb(re.g))},Yd.\u0275cmp=ve.Jb({type:Yd,selectors:[["app-quiz-settings-dialog"]],decls:31,vars:2,consts:[["data-test","quizSettings",1,"dialog"],["mat-dialog-title",""],[1,"flex","flex-row","justify-between"],["app-button","","buttonType","text","buttonTheme","light","type","button","title","Close",3,"click"],["icon","times","size","lg"],["mat-dialog-content","",1,"theme-light","text-12","mt-4",3,"formGroup"],["data-test","enableQuiz","formControlName","enabled","cdkFocusInitial",""],["label","Validation"],["listType","flat"],["formControlName","showSummary"],["formControlName","showExplanation"],["label","UI Elements"],["formControlName","showProgress"],["formControlName","showSubmit"],["mat-dialog-actions","",1,"flex","flex-row","items-end"],["app-button","","buttonTheme","light","buttonType","flat",3,"click"]],template:function(e,t){1&e&&(ve.Vb(0,"div",0),ve.Vb(1,"div",1),ve.Vb(2,"div",2),ve.Vb(3,"h1"),ve.Pc(4,"Quiz Settings"),ve.Ub(),ve.Vb(5,"button",3),ve.cc("click",(function(){return t.handleDoneClick()})),ve.Qb(6,"app-icon",4),ve.Ub(),ve.Ub(),ve.Ub(),ve.Qb(7,"mat-divider"),ve.Vb(8,"div",5),ve.Vb(9,"app-form-field"),ve.Vb(10,"mat-checkbox",6),ve.Pc(11,"Enable Quiz"),ve.Ub(),ve.Ub(),ve.Vb(12,"app-form-field",7),ve.Vb(13,"app-list",8),ve.Vb(14,"app-list-item"),ve.Vb(15,"mat-checkbox",9),ve.Pc(16,"Show summary page"),ve.Ub(),ve.Ub(),ve.Vb(17,"app-list-item"),ve.Vb(18,"mat-checkbox",10),ve.Pc(19,"Show answers and explanations"),ve.Ub(),ve.Ub(),ve.Ub(),ve.Ub(),ve.Vb(20,"app-form-field",11),ve.Vb(21,"app-list",8),ve.Vb(22,"app-list-item"),ve.Vb(23,"mat-checkbox",12),ve.Pc(24,"Progress indicator"),ve.Ub(),ve.Ub(),ve.Vb(25,"app-list-item"),ve.Vb(26,"mat-checkbox",13),ve.Pc(27,"Submit Button"),ve.Ub(),ve.Ub(),ve.Ub(),ve.Ub(),ve.Ub(),ve.Vb(28,"div",14),ve.Vb(29,"button",15),ve.cc("click",(function(){return t.handleDoneClick()})),ve.Pc(30," Done "),ve.Ub(),ve.Ub(),ve.Ub()),2&e&&(ve.Db(5),ve.Eb("aria-label","Close"),ve.Db(3),ve.mc("formGroup",t.form))},directives:[re.h,Pe.a,yt.a,_e.a,re.e,ae.s,ae.j,Oe.a,Ue.a,ae.r,ae.i,Et.a,jt.a,re.c],styles:[""],changeDetection:0}),function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);a>3&&r&&Object.defineProperty(t,n,r)}([Object(y.e)(ti.b.getQuizSettings),im("design:type",_.a)],Yd.prototype,"quizSettings$",void 0),Yd),am=function(e){return e.Green="green",e.Yellow="yellow",e.Red="red",e}({}),rm=((em=function(){function e(){l(this,e),this.color=am.Green,this.label=""}return u(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||em)},em.\u0275cmp=ve.Jb({type:em,selectors:[["app-status"]],inputs:{color:"color",label:"label"},decls:2,vars:2,consts:[["data-test","status",1,"status",3,"ngClass"]],template:function(e,t){1&e&&(ve.Vb(0,"div",0),ve.Pc(1),ve.Ub()),2&e&&(ve.mc("ngClass","status--"+t.color),ve.Db(1),ve.Rc(" ",t.label,"\n"))},directives:[f.m],styles:['@charset "UTF-8";.text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.status[_ngcontent-%COMP%]{display:inline-flex;align-items:center;padding:4px 8px;--dot-color:#33cd54;--text-color:#fff;color:var(--text-color);font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.status[_ngcontent-%COMP%]:before{content:"\u2022";color:var(--dot-color);display:inline-block;font-size:24px;margin-right:4px}.status--green[_ngcontent-%COMP%]{--dot-color:#33cd54}.status--yellow[_ngcontent-%COMP%]{--dot-color:#ffb92e}.status--red[_ngcontent-%COMP%]{--dot-color:#f44336}.status--theme-dark[_ngcontent-%COMP%]{--text-color:#fff}.status--theme-light[_ngcontent-%COMP%]{--text-color:#101823}'],changeDetection:0}),em),cm=o("NVq4"),sm=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},lm=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},pm=["questionItemElements"];function um(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"div",20,21),ve.Vb(2,"app-quiz-question-form",22),ve.cc("opened",(function(e){ve.Cc(n);var i=t.$implicit;return ve.gc().handleOpened(i,e)})),ve.hc(3,"ellipsis"),ve.hc(4,"async"),ve.Ub(),ve.Vb(5,"div",23),ve.Qb(6,"app-icon",24),ve.Ub(),ve.Ub()}if(2&e){var i=t.$implicit,o=ve.gc();ve.Db(2),ve.nc("label",ve.jc(3,3,o.getQuestionText(i),80)),ve.mc("question",i)("open",ve.ic(4,6,o.activeQuestionId$)===i.id)}}function dm(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"button",25),ve.cc("click",(function(){ve.Cc(n);var e=t.$implicit;return ve.gc().addQuestion(e)})),ve.Pc(1),ve.Ub()}if(2&e){var i=t.$implicit,o=ve.gc();ve.mc("matTooltip",o.questionDescriptionsMap[i]),ve.Db(1),ve.Rc(" ",o.questionTypesMap[i]," ")}}var mm,hm=((mm=function(){function e(t,n,i,o,a){l(this,e),this.store=t,this.actions=n,this.changeRef=i,this.dialogService=o,this.dialog=a,this.questionTypes=Object.keys(Md.c),this.questionTypesMap=Md.c,this.questionDescriptionsMap=Md.b,this.statusColor=am,this.selectedChapterQuestions=[],this.ngUnsubscribe=new C.a}return u(e,[{key:"ngOnInit",value:function(){this.initChapterQuestionListeners(),this.initPanelListeners()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initChapterQuestionListeners",value:function(){var e=this;Object(O.b)([this.chapters$,this.selectedChapterId$,this.allQuestions$]).pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){var n=r(t,3),i=(n[0],n[1]);n[2],e.selectedChapterQuestions=e.store.selectSnapshot(ti.b.getQuizQuestionsByChapter(i)),e.changeRef.markForCheck()})),Object(Sd.a)(this.selectedChapterId$,this.actions.pipe(Object(y.k)(Ai.a.SetQuestions))).pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(){e.store.dispatch(new Ai.a.SetActiveQuestion(void 0))}))}},{key:"initPanelListeners",value:function(){var e=this;this.actions.pipe(Object(y.k)(Ai.a.AddQuestion),Object(N.a)(this.ngUnsubscribe)).subscribe((function(){var t=e.selectedChapterQuestions.length-1;e.store.dispatch(new Ai.a.SetActiveQuestion(e.selectedChapterQuestions[t].id));var n=e.questionForms.toArray()[t];n&&e.setActivePanel(n.panel)})),this.activeQuestionId$.pipe(Object(R.a)((function(e){return!!e})),Object(io.a)(),Object(A.a)(0),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){var n=e.selectedChapterQuestions.findIndex((function(e){return e.id===t})),i=e.questionItemElements.toArray()[n];i&&i.nativeElement.scrollIntoView({behavior:"smooth"})}))}},{key:"handleOpened",value:function(e,t){t.opened&&this.setActivePanel(t.panel),this.store.dispatch(new Ai.a.SetActiveQuestion(t.opened?e.id:void 0))}},{key:"handleQuizSettingsClick",value:function(){return this.dialog.open(om,{id:Zn.a.QuizSettingsDialog,width:"320px"})}},{key:"handleRemoveChapterQuizClick",value:function(){var e=this;this.dialogService.openConfirmDialog({data:{titleText:"Remove Chapter Questions",bodyText:"Would you like to remove all the questions in this chapter?"}}).afterClosed().pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){if(t){var n=e.store.selectSnapshot(X.a.getSelectedChapterId),i=e.store.selectSnapshot(ti.b.getAllQuestions).filter((function(e){return e.chapterId===n})).map((function(e){return e.id}));e.store.dispatch(new Ai.a.RemoveQuestions(i))}}))}},{key:"handleRemoveQuizClick",value:function(){var e=this;this.dialogService.openConfirmDialog({data:{titleText:"Remove All Questions",bodyText:"Would you like to remove all the questions in this quiz?"}}).afterClosed().pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){if(t){var n=e.store.selectSnapshot(ti.b.getAllQuestions).map((function(e){return e.id}));e.store.dispatch(new Ai.a.RemoveQuestions(n))}}))}},{key:"getQuestionText",value:function(e){var t=e.questionPrompt;return Object(nm.b)(t)}},{key:"addQuestion",value:function(e){var t=this.store.selectSnapshot(X.a.getSelectedChapterId),n=Object.assign(Object.assign({},Object(_d.e)(e)),{chapterId:t});this.store.dispatch(new Ai.a.AddQuestion(n))}},{key:"setActivePanel",value:function(e){this.questionForms.toArray().filter((function(t){return t.panel!==e})).forEach((function(e){e.panel.open=!1})),this.changeRef.markForCheck()}},{key:"trackByKey",value:function(e,t){return t.id}},{key:"handleDrop",value:function(e){var t=this.store.selectSnapshot(X.a.getSelectedChapterId),n=this.store.selectSnapshot(ti.b.getQuizQuestionsByChapter(t));Object(vt.e)(n,e.previousIndex,e.currentIndex);var i=this.store.selectSnapshot(ti.b.getAllQuestions).filter((function(e){return!n.some((function(t){return t.id===e.id}))}));i=[].concat(a(i),a(n)),this.store.dispatch(new Ai.a.SetQuestions(i))}}]),e}()).\u0275fac=function(e){return new(e||mm)(ve.Pb(y.h),ve.Pb(y.b),ve.Pb(ve.i),ve.Pb(Bi.a),ve.Pb(re.b))},mm.\u0275cmp=ve.Jb({type:mm,selectors:[["app-edit-quiz-context"]],viewQuery:function(e,t){var n;1&e&&(ve.Vc(tm,!0),ve.Vc(pm,!0)),2&e&&(ve.xc(n=ve.dc())&&(t.questionForms=n),ve.xc(n=ve.dc())&&(t.questionItemElements=n))},decls:29,vars:12,consts:[[3,"loading"],["column-label",""],[1,"flex","items-center"],[3,"label","color"],["column-actions",""],["app-button","","data-test","quizSettingsButton","matTooltip","Quiz Settings",3,"click"],["icon","cog"],["app-button","","data-test","questionActionsTrigger","matTooltip","Quiz Bulk Actions",3,"matMenuTriggerFor"],["icon","ellipsis-v"],["quizActionsMenu","matMenu"],["mat-menu-item","","data-test","questionRemoveChapterQuestions",3,"click"],["mat-menu-item","","data-test","questionRemoveAllQuestions",3,"click"],["label","Quiz"],["column-group-body",""],["cdkDropList","",1,"pl-2",3,"cdkDropListDropped"],["class","questions__item","cdkDrag","",4,"ngFor","ngForOf","ngForTrackBy"],["app-button","","buttonType","outline",1,"mv-4","w-100",3,"matMenuTriggerFor"],["icon","angle-down"],["addQuestionMenu","matMenu"],["mat-menu-item","","matTooltipPosition","left",3,"matTooltip","click",4,"ngFor","ngForOf"],["cdkDrag","",1,"questions__item"],["questionItemElements",""],[3,"question","label","open","opened"],["cdkDragHandle","",1,"questions__handle"],["icon","grip-lines"],["mat-menu-item","","matTooltipPosition","left",3,"matTooltip","click"]],template:function(e,t){if(1&e&&(ve.Vb(0,"app-column",0),ve.Vb(1,"div",1),ve.Vb(2,"div",2),ve.Vb(3,"span"),ve.Pc(4,"Quiz"),ve.Ub(),ve.Qb(5,"app-status",3),ve.hc(6,"async"),ve.hc(7,"async"),ve.Ub(),ve.Ub(),ve.Vb(8,"div",4),ve.Vb(9,"button",5),ve.cc("click",(function(){return t.handleQuizSettingsClick()})),ve.Qb(10,"app-icon",6),ve.Ub(),ve.Vb(11,"button",7),ve.Qb(12,"app-icon",8),ve.Ub(),ve.Vb(13,"mat-menu",null,9),ve.Vb(15,"button",10),ve.cc("click",(function(){return t.handleRemoveChapterQuizClick()})),ve.Pc(16," Remove this chapter's quiz questions "),ve.Ub(),ve.Vb(17,"button",11),ve.cc("click",(function(){return t.handleRemoveQuizClick()})),ve.Pc(18," Remove quiz "),ve.Ub(),ve.Ub(),ve.Ub(),ve.Vb(19,"app-column-group",12),ve.Tb(20,13),ve.Vb(21,"div",14),ve.cc("cdkDropListDropped",(function(e){return t.handleDrop(e)})),ve.Nc(22,um,7,8,"div",15),ve.Vb(23,"button",16),ve.Pc(24," Add a Question "),ve.Qb(25,"app-icon",17),ve.Ub(),ve.Vb(26,"mat-menu",null,18),ve.Nc(28,dm,2,2,"button",19),ve.Ub(),ve.Ub(),ve.Sb(),ve.Ub(),ve.Ub()),2&e){var n=ve.yc(14),i=ve.yc(27);ve.mc("loading",!1),ve.Db(5),ve.mc("label",ve.ic(6,8,t.quizEnabled$)?"active":"inactive")("color",ve.ic(7,10,t.quizEnabled$)?"green":"red"),ve.Db(6),ve.mc("matMenuTriggerFor",n),ve.Db(11),ve.mc("ngForOf",t.selectedChapterQuestions)("ngForTrackBy",t.trackByKey),ve.Db(1),ve.mc("matMenuTriggerFor",i),ve.Db(5),ve.mc("ngForOf",t.questionTypes)}},directives:[ko,rm,Pe.a,Ct.c,yt.a,Ki.d,Ki.a,Ki.b,lo,vt.c,f.o,vt.a,tm,vt.b],pipes:[f.b,cm.a],styles:[".questions__item[_ngcontent-%COMP%]{position:relative}.questions__item[_ngcontent-%COMP%]:hover   .questions__handle[_ngcontent-%COMP%]{opacity:1}.questions__handle[_ngcontent-%COMP%]{border:4px solid transparent;display:flex;align-items:center;justify-content:center;background:#131c2a;width:36px;height:36px;cursor:move;color:#96a8c0;position:absolute;left:4px;top:12px;z-index:10;opacity:0}"],changeDetection:0}),sm([Object(y.e)(X.a.getStoryChapters),lm("design:type",_.a)],mm.prototype,"chapters$",void 0),sm([Object(y.e)(X.a.getSelectedChapterId),lm("design:type",_.a)],mm.prototype,"selectedChapterId$",void 0),sm([Object(y.e)(ti.b.getAllQuestions),lm("design:type",_.a)],mm.prototype,"allQuestions$",void 0),sm([Object(y.e)(ti.b.getActiveQuestionId),lm("design:type",_.a)],mm.prototype,"activeQuestionId$",void 0),sm([Object(y.e)(ti.b.getQuizEnabled),lm("design:type",_.a)],mm.prototype,"quizEnabled$",void 0),mm),bm=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},fm=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function gm(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"div",1),ve.Vb(1,"button",2),ve.cc("click",(function(){return ve.Cc(n),ve.gc().handlePreviousClick()})),ve.Qb(2,"app-icon",3),ve.Ub(),ve.Vb(3,"span",4),ve.Pc(4),ve.hc(5,"async"),ve.Ub(),ve.Vb(6,"button",5),ve.cc("click",(function(){return ve.Cc(n),ve.gc().handleNextClick()})),ve.hc(7,"async"),ve.Qb(8,"app-icon",6),ve.Ub(),ve.Ub()}if(2&e){var i,o,a=ve.gc();ve.Db(1),ve.mc("disabled",0===a.chapterIndex),ve.Db(3),ve.Sc(" ",a.chapterIndex+1," / ",null==(i=ve.ic(5,4,a.chapters$))?null:i.length," "),ve.Db(2),ve.mc("disabled",a.chapterIndex===(null==(o=ve.ic(7,6,a.chapters$))?null:o.length)-1)}}var vm,ym=((vm=function(){function e(t,n){l(this,e),this.store=t,this.changeDetectorRef=n,this.ngUnsubscribe=new C.a}return u(e,[{key:"ngOnInit",value:function(){var e=this;this.selectedChapterIndex$.pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.chapterIndex=t,e.changeDetectorRef.markForCheck()}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"handlePreviousClick",value:function(){this.store.dispatch(new J.h)}},{key:"handleNextClick",value:function(){this.store.dispatch(new J.g)}}]),e}()).\u0275fac=function(e){return new(e||vm)(ve.Pb(y.h),ve.Pb(ve.i))},vm.\u0275cmp=ve.Jb({type:vm,selectors:[["app-edit-chapter-pagination"]],decls:2,vars:3,consts:[["class","chapter-pagination","appEventFence","",4,"ngIf"],["appEventFence","",1,"chapter-pagination"],["type","button",1,"chapter-pagination__button","chapter-pagination__button--back",3,"disabled","click"],["size","lg","icon","angle-left"],[1,"chapter-pagination__count"],["type","button",1,"chapter-pagination__button","chapter-pagination__button--next",3,"disabled","click"],["size","lg","icon","angle-right"]],template:function(e,t){var n;(1&e&&(ve.Nc(0,gm,9,8,"div",0),ve.hc(1,"async")),2&e)&&ve.mc("ngIf",(null==(n=ve.ic(1,1,t.chapters$))?null:n.length)>1)},directives:[f.p,hu.a,yt.a],pipes:[f.b],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3535}.text-info{color:#2d72dc}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.chapter-pagination{display:flex;height:56px;align-items:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:relative}.chapter-pagination__button{background:transparent;border:none;color:#d7e0ea;padding:0 20px;flex:1 1 50%;height:100%;outline:none}.chapter-pagination__button:disabled{color:#61779e}.chapter-pagination__button:not(:disabled):hover{color:#fff;cursor:pointer}.chapter-pagination__button .app-button{height:100%}.chapter-pagination__button--back{text-align:left}.chapter-pagination__button--next{text-align:right}.chapter-pagination__count{font-size:12px;letter-spacing:.3px;line-height:1.4em;display:flex;align-items:center;white-space:nowrap;width:100%;height:100%;left:0;top:0;justify-content:center;position:absolute;pointer-events:none;z-index:10}"],encapsulation:2,changeDetection:0}),bm([Object(y.e)(D.a.getStory),fm("design:type",_.a)],vm.prototype,"story$",void 0),bm([Object(y.e)(X.a.getSelectedChapter),fm("design:type",_.a)],vm.prototype,"selectedChapter$",void 0),bm([Object(y.e)(X.a.getSelectedChapterIndex),fm("design:type",_.a)],vm.prototype,"selectedChapterIndex$",void 0),bm([Object(y.e)(X.a.getStoryChapters),fm("design:type",_.a)],vm.prototype,"chapters$",void 0),vm),xm=o("gcYM"),Cm=o("rvu2"),km=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},Pm=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Om=["scrubber"];function wm(e,t){1&e&&ve.Qb(0,"app-button-icon",6)}function Sm(e,t){1&e&&ve.Qb(0,"app-button-icon",7)}var _m=function(e){return{"mr-4":e}};function Mm(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"button",3),ve.cc("click",(function(){return ve.Cc(n),ve.gc().handlePlayClick()})),ve.Nc(1,wm,1,0,"app-button-icon",4),ve.hc(2,"async"),ve.Nc(3,Sm,1,0,"app-button-icon",5),ve.hc(4,"async"),ve.Ub()}if(2&e){var i=ve.gc();ve.mc("buttonTheme",i.theme)("ngClass",ve.pc(8,_m,i.showScrubber)),ve.Db(1),ve.mc("ngIf",!ve.ic(2,4,i.animationPlaying$)),ve.Db(2),ve.mc("ngIf",ve.ic(4,6,i.animationPlaying$))}}function Um(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"input",8,9),ve.cc("ngModelChange",(function(e){return ve.Cc(n),ve.gc().percent=e}))("mousedown",(function(){return ve.Cc(n),ve.gc().handleInputMouseDown()}))("mouseup",(function(){return ve.Cc(n),ve.gc().handleInputMouseUp()})),ve.Ub()}if(2&e){var i=ve.gc();ve.mc("ngModel",i.percent)}}var Tm,Vm,Dm,Em=((Vm=function(){function e(t,n,i,o){l(this,e),this.changeDetection=t,this.animationService=n,this.store=i,this.engineService=o,this.theme="dark",this.showPlay=!0,this.showScrubber=!0,this.playing=!1,this.wasPlaying=!1,this.ngUnsubscribe=new C.a,this._percent=0,this.scrub$=new Mi.a(0),this.interactive=!1,this.timeline=new Cm.a}return u(e,[{key:"percent",get:function(){return this._percent},set:function(e){this._percent=e,this.animationService.isPlaying()||this.scrubPercent(this.percent)}},{key:"ngOnInit",value:function(){this.bindApplicationEvents()}},{key:"ngOnDestroy",value:function(){this.changeDetection.detach(),this.ngUnsubscribe.next(),this.ngUnsubscribe.unsubscribe()}},{key:"bindApplicationEvents",value:function(){var e=this;this.selectedChapterId$.pipe(Object(R.a)((function(e){return!!e})),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.initScrubber(t)})),this.engineService.getEvent(oo.a.TimelinePlaying).pipe(Object(xm.a)(50),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){return e.tick(t.time)})),this.engineService.getEvent(oo.a.TimelineScrubbed).pipe(Object(xm.a)(50),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.scrubber.nativeElement.value=e.getPercent(t.time)})),this.engineService.getEvent(oo.a.TimelineTimeFrameUpdated).pipe(Object(N.a)(this.ngUnsubscribe),Object(R.a)((function(){return null!=Object(ce.get)(Human,"timeline.activeRoot._nowBranch.id")}))).subscribe((function(){var t=Human.timeline.activeRoot;t&&(e.timeline=e.animationService.getChapterLocalTimerange(t._nowBranch.id),e.percent=e.getPercent(Human.timeline.time),e.changeDetection.markForCheck())})),this.animationPlaying$.pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){return e.playing=t}))}},{key:"handleInputMouseDown",value:function(){this.wasPlaying=this.playing,this.store.dispatch(new q.W(!1))}},{key:"handleInputMouseUp",value:function(){this.store.dispatch(new q.W(this.wasPlaying))}},{key:"handlePlayClick",value:function(){this.play()}},{key:"play",value:function(){var e=!this.store.selectSnapshot(V.a.getAnimationPlaying);this.store.dispatch(new q.W(e))}},{key:"initScrubber",value:function(e){this.timeline=this.animationService.getChapterLocalTimerange(e),this.percent=0,this.changeDetection.markForCheck()}},{key:"tick",value:function(e){this.percent=this.getPercent(e),this.changeDetection.markForCheck()}},{key:"getPercent",value:function(e){return this.animationService.getLocalTime(e)/this.timeline.lastTime*100}},{key:"scrubPercent",value:function(e){var t="first";0===e&&(t="second"),100===e&&(t="first");var n=Human.timeline.activeRoot._nowBranch,i=this.animationService.mapLocalTimeToGlobal(n.id,e/100*this.timeline.lastTime);this.animationService.scrub({time:i,which:t})}}]),e}()).\u0275fac=function(e){return new(e||Vm)(ve.Pb(ve.i),ve.Pb(ye.a),ve.Pb(y.h),ve.Pb(Ce.a))},Vm.\u0275cmp=ve.Jb({type:Vm,selectors:[["app-engine-scrubber"]],viewQuery:function(e,t){var n;1&e&&ve.Vc(Om,!0),2&e&&ve.xc(n=ve.dc())&&(t.scrubber=n.first)},inputs:{theme:"theme",showPlay:"showPlay",showScrubber:"showScrubber"},decls:3,vars:2,consts:[[1,"engine-scrubber"],["app-button","","buttonSize","small","class","engine-scrubber__play",3,"buttonTheme","ngClass","click",4,"ngIf"],["class","engine-scrubber__input","type","range","style","width: 100%","min","0","max","100",3,"ngModel","ngModelChange","mousedown","mouseup",4,"ngIf"],["app-button","","buttonSize","small",1,"engine-scrubber__play",3,"buttonTheme","ngClass","click"],["label","Play","iconPlacement","left","icon","play",4,"ngIf"],["label","Pause","iconPlacement","left","icon","pause",4,"ngIf"],["label","Play","iconPlacement","left","icon","play"],["label","Pause","iconPlacement","left","icon","pause"],["type","range","min","0","max","100",1,"engine-scrubber__input",2,"width","100%",3,"ngModel","ngModelChange","mousedown","mouseup"],["scrubber",""]],template:function(e,t){1&e&&(ve.Vb(0,"div",0),ve.Nc(1,Mm,5,10,"button",1),ve.Nc(2,Um,2,1,"input",2),ve.Ub()),2&e&&(ve.Db(1),ve.mc("ngIf",t.showPlay),ve.Db(1),ve.mc("ngIf",t.showScrubber))},directives:[f.p,Pe.a,f.m,eo.a,ae.y,ae.c,ae.r,ae.u],pipes:[f.b],styles:["[_nghost-%COMP%]{display:block;width:100%}.engine-scrubber[_ngcontent-%COMP%]{justify-content:center;align-items:center;display:flex;position:relative;width:100%;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.engine-scrubber__input[_ngcontent-%COMP%]{width:100%}.engine-scrubber__play[_ngcontent-%COMP%]{width:80px}"],changeDetection:0}),km([Object(y.e)(X.a.getSelectedChapterId),Pm("design:type",_.a)],Vm.prototype,"selectedChapterId$",void 0),km([Object(y.e)(X.a.getSelectedChapter),Pm("design:type",_.a)],Vm.prototype,"selectedChapter$",void 0),km([Object(y.e)(V.a.getAnimationPlaying),Pm("design:type",_.a)],Vm.prototype,"animationPlaying$",void 0),km([Object(y.e)(X.a.getSelectedChapterReadyState),Pm("design:type",_.a)],Vm.prototype,"readyState$",void 0),Vm),jm=((Tm=function(){function e(t){l(this,e),this.animationService=t}return u(e,[{key:"ngOnInit",value:function(){}},{key:"handleClick",value:function(){this.animationService.scrubFrame(this.direction)}}]),e}()).\u0275fac=function(e){return new(e||Tm)(ve.Pb(ye.a))},Tm.\u0275cmp=ve.Jb({type:Tm,selectors:[["app-engine-frame-control"]],inputs:{direction:"direction"},decls:2,vars:1,consts:[["app-button","","buttonShape","square","type","button",3,"click"],["size","lg",3,"icon"]],template:function(e,t){1&e&&(ve.Vb(0,"button",0),ve.cc("click",(function(){return t.handleClick()})),ve.Qb(1,"app-icon",1),ve.Ub()),2&e&&(ve.Db(1),ve.mc("icon","next"===t.direction?"step-forward":"step-backward"))},directives:[Pe.a,yt.a],styles:[""],changeDetection:0}),Tm),Nm=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Rm=["currentTime"],Am=((Dm=function(){function e(t,n,i){l(this,e),this.changeDetection=t,this.engineService=n,this.animationService=i,this.ngUnsubscribe=new C.a,this.currentTimeFocused=!1}return u(e,[{key:"ngOnInit",value:function(){var e=this;this.selectedChapterId$.pipe(Object(R.a)((function(e){return!Object(ce.isNil)(e)})),Object(N.a)(this.ngUnsubscribe)).subscribe((function(){e.setChapterTimeFrame(),e.setCurrentTime(e.animationService.getLocalTime(Human.timeline.time)),e.changeDetection.markForCheck()})),Object(w.a)(this.engineService.getEvent(oo.a.TimelinePlaying),this.engineService.getEvent(oo.a.TimelineScrubbed)).pipe(Object(xm.a)(20),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.setCurrentTime(e.animationService.getLocalTime(t.time))})),this.engineService.getEvent(oo.a.TimelineTimeFrameUpdated).pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(){e.setChapterTimeFrame(),e.changeDetection.markForCheck()}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"handleFocus",value:function(){this.currentTimeFocused=!0,this.currentTimeInput.nativeElement.value=""}},{key:"handleBlur",value:function(){this.currentTimeFocused=!1,this.animationService.pause();var e=this.animationService.parseFormattedTime(this.currentTimeInput.nativeElement.value||this.currentTime);e=this.animationService.constrainLocalTime(e);var t=Human.timeline.activeRoot._nowBranch.id,n=this.animationService.mapLocalTimeToGlobal(t,e);this.animationService.scrub({time:n})}},{key:"setChapterTimeFrame",value:function(){var e=Human.timeline.activeRoot._nowBranch.getTimeFrame();this.duration=this.animationService.formatTime(e.lastTime)}},{key:"setCurrentTime",value:function(e){this.currentTime=this.animationService.formatTime(e),this.currentTimeFocused||(this.currentTimeInput.nativeElement.value=this.currentTime)}}]),e}()).\u0275fac=function(e){return new(e||Dm)(ve.Pb(ve.i),ve.Pb(Ce.a),ve.Pb(ye.a))},Dm.\u0275cmp=ve.Jb({type:Dm,selectors:[["app-engine-current-time"]],viewQuery:function(e,t){var n;1&e&&ve.Jc(Rm,!0),2&e&&ve.xc(n=ve.dc())&&(t.currentTimeInput=n.first)},decls:5,vars:1,consts:[[1,"engine-current-time"],["type","text",1,"input","engine-current-time__current-time",3,"focus","blur"],["currentTime",""],[1,"text-12","ml-2"]],template:function(e,t){1&e&&(ve.Vb(0,"div",0),ve.Vb(1,"input",1,2),ve.cc("focus",(function(){return t.handleFocus()}))("blur",(function(){return t.handleBlur()})),ve.Ub(),ve.Vb(3,"span",3),ve.Pc(4),ve.Ub(),ve.Ub()),2&e&&(ve.Db(4),ve.Rc("/ ",t.duration,""))},styles:[".engine-current-time[_ngcontent-%COMP%]{display:flex;align-items:center;color:#d7e0ea}.engine-current-time__current-time[type=text][_ngcontent-%COMP%]{width:100px;color:inherit}"],changeDetection:0}),function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);a>3&&r&&Object.defineProperty(t,n,r)}([Object(y.e)(X.a.getSelectedChapterId),Nm("design:type",_.a)],Dm.prototype,"selectedChapterId$",void 0),Dm),Fm=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},Im=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function zm(e,t){1&e&&(ve.Vb(0,"div",9),ve.Qb(1,"app-icon",10),ve.Ub())}function Lm(e,t){1&e&&(ve.Vb(0,"div",11),ve.Qb(1,"app-icon",12),ve.Ub())}function Bm(e,t){1&e&&(ve.Vb(0,"div",13),ve.Qb(1,"app-icon",14),ve.Ub())}var Qm,$m=function(e,t){return{"timeline-map--selected":e,"timeline-map--overlapping":t}},qm=function(e,t){return{"width.px":e,"left.px":t}},Gm=((Qm=function(){function e(t,n){l(this,e),this.animationService=t,this.changeDetectorRef=n,this.ngUnsubscribe=new C.a}return u(e,[{key:"ngOnInit",value:function(){var e=this.timelineMap.data.timeline,t=this.animationService.getLeafTimelines();this.hasAnimations=Object.keys(t[e].timelineAnimations).length>0,this.stateTimeRange=this.buildStateTimeRange(),this.looping=!this.timelineMap.data.fit&&"loop"===this.timelineMap.data.onEnd,this.initListeners()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"ngOnChanges",value:function(){var e=this.timelineMap.end-this.timelineMap.start;this.left=300*this.timelineMap.start*this.scale,this.width=300*e*this.scale}},{key:"initListeners",value:function(){var e=this;this.selectedTimelineMapIds$.pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.selected=t.has(e.timelineMap.id),e.changeDetectorRef.markForCheck()})),this.overlappingTimelineMapIds$.pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.overlapping=t.has(e.timelineMap.id),e.changeDetectorRef.markForCheck()}))}},{key:"buildStateTimeRange",value:function(){var e=this.timelineMap.data.end;return"".concat(this.animationService.formatTime(this.timelineMap.data.start)," - ").concat(this.animationService.formatTime(e))}}]),e}()).\u0275fac=function(e){return new(e||Qm)(ve.Pb(ye.a),ve.Pb(ve.i))},Qm.\u0275cmp=ve.Jb({type:Qm,selectors:[["app-timeline-map"]],inputs:{scale:"scale",timelineMap:"timelineMap"},features:[ve.Bb],decls:11,vars:13,consts:[[1,"timeline-map",3,"ngClass","ngStyle"],[1,"timeline-map__top"],[1,"timeline-map__name","text-10"],[1,"timeline-map__middle"],[1,"timeline-map__state-time-range","text-10"],[1,"timeline-map__bottom"],["class","timeline-map__no-animations mr-2",4,"ngIf"],["class","timeline-map__fit mr-2",4,"ngIf"],["class","timeline-map__loop",4,"ngIf"],[1,"timeline-map__no-animations","mr-2"],["icon","exclamation-circle","size","xs","matTooltip","This state has no animations"],[1,"timeline-map__fit","mr-2"],["icon","arrows-alt-h","size","xs"],[1,"timeline-map__loop"],["icon","repeat-alt","size","xs"]],template:function(e,t){1&e&&(ve.Vb(0,"div",0),ve.Vb(1,"div",1),ve.Vb(2,"div",2),ve.Pc(3),ve.Ub(),ve.Ub(),ve.Vb(4,"div",3),ve.Vb(5,"div",4),ve.Pc(6),ve.Ub(),ve.Ub(),ve.Vb(7,"div",5),ve.Nc(8,zm,2,0,"div",6),ve.Nc(9,Lm,2,0,"div",7),ve.Nc(10,Bm,2,0,"div",8),ve.Ub(),ve.Ub()),2&e&&(ve.mc("ngClass",ve.qc(7,$m,t.selected,t.overlapping))("ngStyle",ve.qc(10,qm,t.width,t.left)),ve.Db(3),ve.Qc(t.timelineMap.name),ve.Db(3),ve.Qc(t.stateTimeRange),ve.Db(2),ve.mc("ngIf",!t.hasAnimations),ve.Db(1),ve.mc("ngIf",t.timelineMap.data.fit),ve.Db(1),ve.mc("ngIf",t.looping))},directives:[f.m,f.q,f.p,yt.a,Ct.c],styles:[".timeline-map[_ngcontent-%COMP%]{position:absolute;height:100%;background-color:#283853;border:2px solid transparent;border-right:1px solid #131c2a;cursor:pointer;display:flex;flex-direction:column;justify-content:space-evenly;min-width:0;padding:0 4px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.timeline-map__bottom[_ngcontent-%COMP%], .timeline-map__middle[_ngcontent-%COMP%], .timeline-map__top[_ngcontent-%COMP%]{display:flex;min-height:33%;flex:0 0 33%;align-items:center}.timeline-map__name[_ngcontent-%COMP%], .timeline-map__state-time-range[_ngcontent-%COMP%]{color:#d7e0ea;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.timeline-map__bottom[_ngcontent-%COMP%]{overflow:hidden}.timeline-map__fit[_ngcontent-%COMP%]{color:#ff0}.timeline-map__loop[_ngcontent-%COMP%]{color:#0ff}.timeline-map--selected[_ngcontent-%COMP%]{border:2px solid #2d72dc;z-index:1}.timeline-map--overlapping[_ngcontent-%COMP%]{background-color:#a81914}"],changeDetection:0}),Fm([Object(y.e)(hi.getSelectedTimelineMapIds),Im("design:type",_.a)],Qm.prototype,"selectedTimelineMapIds$",void 0),Fm([Object(y.e)(hi.getOverlappingTimelineMapIds),Im("design:type",_.a)],Qm.prototype,"overlappingTimelineMapIds$",void 0),Qm),Hm=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},Wm=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Km=["leafTimelinesWindow"],Jm=["rulerWindow"],Xm=["tracksWindow"],Zm=["timelineRuler"],Ym=["currentTimeHead"],eh=["currentTimeLine"],th=["hoverTimeHead"],nh=["hoverTimeLine"],ih=["hoverTimeLabel"],oh=function(e){return{"left.px":e}},ah=function(e){return{"edit-timeline__seconds-mark":e}};function rh(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"div",41),ve.cc("mouseenter",(function(){ve.Cc(n);var e=t.index;return ve.gc().handleRulerMarkMouseEnter(e)})),ve.Vb(1,"div",42),ve.cc("click",(function(){ve.Cc(n);var e=t.index;return ve.gc().scrubToRulerMark(e)})),ve.Pc(2),ve.Ub(),ve.Ub()}if(2&e){var i=t.$implicit;ve.mc("ngStyle",ve.pc(3,oh,i.left))("ngClass",ve.pc(5,ah,i.seconds)),ve.Db(2),ve.Rc(" ",i.label," ")}}function ch(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"div",43),ve.cc("click",(function(e){ve.Cc(n);var i=t.$implicit;return ve.gc().handleLeafTimelineClick(e,i)})),ve.Vb(1,"div",44),ve.Pc(2),ve.Ub(),ve.Vb(3,"button",45),ve.Qb(4,"app-icon",46),ve.Ub(),ve.Vb(5,"mat-menu",null,47),ve.Vb(7,"button",48),ve.cc("click",(function(){ve.Cc(n);var e=t.$implicit;return ve.gc().addTimelineMap(e)})),ve.Pc(8,"Add Clip"),ve.Ub(),ve.Vb(9,"button",49),ve.cc("click",(function(){ve.Cc(n);var e=t.$implicit;return ve.gc().pasteTimelineMaps(e)})),ve.Pc(10),ve.Ub(),ve.Ub(),ve.Ub()}if(2&e){var i=t.$implicit,o=ve.yc(6),a=ve.gc();ve.Db(2),ve.Rc(" ",i.id," "),ve.Db(1),ve.mc("matMenuTriggerFor",o),ve.Db(6),ve.mc("disabled",!a.hasCopiedTimelineMaps),ve.Db(1),ve.Rc(" ",a.pasteClipsText," ")}}function sh(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"app-timeline-map",52),ve.cc("click",(function(e){ve.Cc(n);var i=t.$implicit;return ve.gc(2).handleTimelineMapClick(e,i)})),ve.Ub()}if(2&e){var i=t.$implicit,o=ve.gc(2);ve.mc("scale",o.scale)("timelineMap",i)}}function lh(e,t){if(1&e&&(ve.Vb(0,"div",50),ve.Nc(1,sh,1,2,"app-timeline-map",51),ve.Ub()),2&e){var n=t.$implicit;ve.Db(1),ve.mc("ngForOf",n)}}var ph,uh=function(e){return{"width.px":e}},dh=function(e){return{"edit-timeline__hover-time-head--show":e}},mh=function(e){return{"height.px":e}},hh=function(e){return{"edit-timeline__hover-time-line--show":e}},bh=((ph=function(){function e(t,n,i,o,a){l(this,e),this.store=t,this.animationService=n,this.engineService=i,this.renderer=o,this.changeDetectorRef=a,this.showHoverTimeIndicator=!1,this.ngUnsubscribe=new C.a}return u(e,[{key:"ngOnInit",value:function(){this.setLeafTimelines(),this.setScrollbarWidth(),this.setLeafTimelinesWindowWidth(),this.initListeners(),this.initEngineEventListeners(),this.initBrowserEventListeners()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initListeners",value:function(){var e=this;this.scale$.pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.setScale(t),e.setCurrentTimeIndicator(e.animationService.getLocalTime(Human.timeline.time)),e.buildRulerMarks(),e.checkOverflowX(),e.changeDetectorRef.markForCheck()})),this.selectedTimelineMapIds$.pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.selectedTimelineMapIds=t,e.changeDetectorRef.markForCheck()})),this.copiedTimelineMaps$.pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.copiedTimelineMaps=t,e.setHasCopiedTimelineMaps(),e.changeDetectorRef.markForCheck()})),this.selectedChapterTimelineMap$.pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.buildChapterLeafTimelinesMaps(t),e.checkTimelineMapOverlaps(),e.changeDetectorRef.markForCheck()})),this.selectedChapterId$.pipe(Object(R.a)((function(e){return!Object(ce.isNil)(e)})),Object(N.a)(this.ngUnsubscribe)).subscribe((function(){e.setChapterTimeFrame(),e.setCurrentTimeIndicator(e.animationService.getLocalTime(Human.timeline.time)),e.store.dispatch(new Kn.SetSelectedTimelineMapIds([])),e.changeDetectorRef.markForCheck()})),this.loadChunksRemaining$.pipe(Object(R.a)((function(e){return 0===e.length})),Object(N.a)(this.ngUnsubscribe)).subscribe((function(){e.setLeafTimelines(),e.setChapterTimeFrame(),e.changeDetectorRef.markForCheck()}))}},{key:"initEngineEventListeners",value:function(){var e=this;Object(w.a)(this.engineService.getEvent(oo.a.TimelinePlaying),this.engineService.getEvent(oo.a.TimelineScrubbed)).pipe(Object(xm.a)(20),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.setCurrentTimeIndicator(e.animationService.getLocalTime(t.time))})),this.engineService.getEvent(oo.a.TimelineTimeFrameUpdated).pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(){e.setChapterTimeFrame(),e.changeDetectorRef.markForCheck()}))}},{key:"initBrowserEventListeners",value:function(){var e=this;Object(P.a)(window,"resize").pipe(Object(Un.a)(50),Object(N.a)(this.ngUnsubscribe)).subscribe((function(){e.checkOverflowX(),e.changeDetectorRef.markForCheck()})),Object(P.a)(this.tracksWindow.nativeElement,"scroll").pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(){return e.handleTracksScroll()})),Object(P.a)(this.leafTimelinesWindow.nativeElement,"scroll").pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(){return e.handleLeafTimelinesScroll()}))}},{key:"checkOverflowX",value:function(){this.overflowX=this.tracksContainerWidth>this.tracksWindow.nativeElement.clientWidth}},{key:"handleCTIMouseDown",value:function(e){var t=this;e.preventDefault();var n=Object(P.a)(window,"mousemove"),i=Object(P.a)(window,"mouseup").pipe(Object(Q.a)()),o=this.tracksWindow.nativeElement.getBoundingClientRect();this.scrubbing=!0,i.subscribe((function(){t.scrubbing=!1,t.autoScrolling=!1})),n.pipe(Object(xm.a)(20),Object(N.a)(i)).subscribe((function(e){var n=e.clientX;if(t.overflowX&&(n>o.right||n<o.left?(t.autoScrollOffset=n>o.right?n-o.right:n-o.left,t.autoScrolling||(t.autoScrolling=!0,t.autoScroll())):t.autoScrolling=!1),!t.autoScrolling){var i=t.timelineRuler.nativeElement.getBoundingClientRect();t.scrubLocalTime((n-i.left)/(300*t.scale))}}))}},{key:"autoScroll",value:function(){var e=this,t=this.tracksWindow.nativeElement.getBoundingClientRect();requestAnimationFrame((function n(){var i,o=e.tracksWindow.nativeElement.scrollLeft;i=e.autoScrollOffset<0?(o-20)/(300*e.scale):(t.width+o-20)/(300*e.scale),e.scrubLocalTime(i+e.autoScrollOffset/(300*e.scale));var a=(e.autoScrollOffset>0?1:-1)*Math.sqrt(Math.abs(e.autoScrollOffset));e.setTracksScrollLeft(o+a),e.autoScrolling&&requestAnimationFrame(n)}))}},{key:"handleTracksScroll",value:function(){this.ignoreScrollEvent?this.ignoreScrollEvent=!1:this.setLeafTimelinesScrollTop(this.tracksWindow.nativeElement.scrollTop),this.setRulerScrollLeft(this.tracksWindow.nativeElement.scrollLeft)}},{key:"handleLeafTimelinesScroll",value:function(){this.ignoreScrollEvent?this.ignoreScrollEvent=!1:this.setTracksScrollTop(this.leafTimelinesWindow.nativeElement.scrollTop)}},{key:"setRulerScrollLeft",value:function(e){this.rulerWindow.nativeElement.scrollLeft=e}},{key:"setTracksScrollLeft",value:function(e){this.tracksWindow.nativeElement.scrollLeft=e}},{key:"setTracksScrollTop",value:function(e){this.ignoreScrollEvent=!0,this.tracksWindow.nativeElement.scrollTop=e}},{key:"setLeafTimelinesScrollTop",value:function(e){this.ignoreScrollEvent=!0,this.leafTimelinesWindow.nativeElement.scrollTop=e}},{key:"handleRulerMarkMouseEnter",value:function(e){if(!this.scrubbing){this.showHoverTimeIndicator=!0;var t=e/this.rulerMarksPerSecond;t=this.animationService.toNearestFrame(t),this.setHoverTimeIndicator(t)}}},{key:"handleRulerMouseEnter",value:function(e){if(!this.scrubbing){this.showHoverTimeIndicator=!0;var t=e.offsetX/(300*this.scale);t=this.animationService.toNearestFrame(t),this.setHoverTimeIndicator(t)}}},{key:"handleRulerMouseMove",value:function(e){if(!this.scrubbing&&e.currentTarget===e.target){var t=e.offsetX/(300*this.scale);t=this.animationService.toNearestFrame(t),this.setHoverTimeIndicator(t)}}},{key:"handleRulerMouseLeave",value:function(){this.showHoverTimeIndicator=!1}},{key:"handleTimelineMapClick",value:function(e,t){e.shiftKey?this.selectedTimelineMapIds.has(t.id)?this.store.dispatch(new Kn.RemoveFromSelectedTimelineMapIds([t.id])):this.store.dispatch(new Kn.AddToSelectedTimelineMapIds([t.id])):this.store.dispatch(new Kn.SetSelectedTimelineMapIds([t.id]))}},{key:"handleLeafTimelineClick",value:function(e,t){var n=this,i=this.leafTimelines.indexOf(t),o=this.chapterLeafTimelinesMaps[i].map((function(e){return e.id}));if(e.shiftKey){var a=o.every((function(e){return n.selectedTimelineMapIds.has(e)}));this.store.dispatch(a?new Kn.RemoveFromSelectedTimelineMapIds(o):new Kn.AddToSelectedTimelineMapIds(o))}else this.store.dispatch(new Kn.SetSelectedTimelineMapIds(o))}},{key:"buildChapterLeafTimelinesMaps",value:function(e){var t=this;this.chapterLeafTimelinesMaps=[],this.leafTimelines.forEach((function(n){var i=e.filter((function(e){return e.data.timeline===n.id}));t.chapterLeafTimelinesMaps.push(i)}))}},{key:"checkTimelineMapOverlaps",value:function(){var e=new Set;this.chapterLeafTimelinesMaps.forEach((function(t){for(var n=0;n<t.length-1;n++)for(var i=t[n],o=n+1;o<t.length;o++){var a=t[o];(i.start<a.start?i.end>a.start:i.start<a.end)&&e.add(i.id).add(a.id)}})),this.store.dispatch(new Kn.SetOverlappingTimelineMapIds(Array.from(e)))}},{key:"pasteTimelineMaps",value:function(e){var t=this,n=this.copiedTimelineMaps.map((function(t){return(t=Object(ce.cloneDeep)(t)).data.timeline=e.id,t})),i=Human.timeline.activeRoot._nowBranch;n.forEach((function(e){t.animationService.addTimelineMap(i,e)})),this.store.dispatch(new J.b(i.id,n))}},{key:"setHasCopiedTimelineMaps",value:function(){var e=this.copiedTimelineMaps.length;this.hasCopiedTimelineMaps=e>0,this.pasteClipsText=this.hasCopiedTimelineMaps?1===e?"Paste Clip":"Paste ".concat(e," Clips"):"Paste Clips"}},{key:"addTimelineMap",value:function(e){var t,n,i,o,a=Human.timeline.activeRoot._nowBranch,r=a.getLeafTimelineMaps(e),c=Object.keys(e.timelineAnimations).length>0,s=0;if(r.forEach((function(e){e.end>s&&(s=e.end)})),t=s,c){var l=e.getTimeFrame();n=t+(l.lastTime-l.firstTime),i=l.firstTime,o=l.lastTime}else n=t+2,i=0,o=0;var p={start:t,end:n,name:"",data:{timeline:e.id,start:i,end:o,fit:!1,onEnd:"freeze"}};this.animationService.addTimelineMap(a,p),this.store.dispatch(new J.b(a.id,[p]))}},{key:"setLeafTimelines",value:function(){this.leafTimelines=Object.values(this.animationService.getLeafTimelines())}},{key:"setChapterTimeFrame",value:function(){var e=Human.timeline.activeRoot._nowBranch.getTimeFrame();this.globalStartTime=this.getGlobalTime(e.firstTime),this.globalEndTime=this.getGlobalTime(e.lastTime),this.chapterDuration=e.lastTime,this.setTracksWidths(),this.buildRulerMarks(),this.checkOverflowX()}},{key:"setScale",value:function(e){this.scale=e,this.rulerMarksPerSecond=.1===this.scale?1:.25===this.scale?2:3,this.setTracksWidths()}},{key:"buildRulerMarks",value:function(){var e=this,t=Math.floor(this.chapterDuration*this.rulerMarksPerSecond)+1;this.rulerMarks=[];for(var n=function(t){return t%e.rulerMarksPerSecond*(e.animationService.fps/e.rulerMarksPerSecond)+"f"},i=0;i<t;i++){var o=i%this.rulerMarksPerSecond==0,a=o?i/e.rulerMarksPerSecond+"s":n(i);this.rulerMarks.push({left:i*(300/this.rulerMarksPerSecond)*this.scale,label:a,seconds:o})}}},{key:"setCurrentTimeIndicator",value:function(e){var t="translate3d(".concat(300*e*this.scale,"px, 0px, 0px)");this.renderer.setStyle(this.currentTimeHead.nativeElement,"transform",t),this.renderer.setStyle(this.currentTimeLine.nativeElement,"transform",t)}},{key:"setHoverTimeIndicator",value:function(e){var t="translate3d(".concat(300*e*this.scale,"px, 0px, 0px)");this.renderer.setStyle(this.hoverTimeHead.nativeElement,"transform",t),this.renderer.setStyle(this.hoverTimeLine.nativeElement,"transform",t),this.renderer.setStyle(this.hoverTimeLabel.nativeElement,"transform","translate3d(0px, ".concat(this.tracksWindow.nativeElement.scrollTop,"px, 0px)")),this.hoverTimeFormatted=this.animationService.formatTime(e),this.hoverTimeFrames=this.animationService.secondsToFrames(e)+"f",this.hoverTimeSeconds=Math.round(1e4*e)/1e4+"s"}},{key:"setTracksWidths",value:function(){this.chapterWidth=300*this.chapterDuration*this.scale,this.tracksContainerWidth=this.chapterWidth+40}},{key:"scrubToRulerMark",value:function(e){var t=e/this.rulerMarksPerSecond;this.animationService.pause(),this.scrubLocalTime(t)}},{key:"scrubToRulerPosition",value:function(e){var t=e.offsetX/(300*this.scale);t=this.animationService.toNearestFrame(t),this.animationService.pause(),this.scrubLocalTime(t)}},{key:"getGlobalTime",value:function(e){var t=Human.timeline.activeRoot._nowBranch;return this.animationService.mapLocalTimeToGlobal(t.id,e)}},{key:"setLeafTimelinesWindowWidth",value:function(){this.renderer.setStyle(this.leafTimelinesWindow.nativeElement,"width","calc(100% + ".concat(this.scrollBarWidth,"px)"))}},{key:"setScrollbarWidth",value:function(){var e=this.tracksWindow.nativeElement;this.scrollBarWidth=e.offsetWidth-e.clientWidth}},{key:"scrubLocalTime",value:function(e){var t=this.getGlobalTime(e),n="first";t<this.globalStartTime&&(t=this.globalStartTime),t>this.globalEndTime&&(t=this.globalEndTime),t===this.globalStartTime&&(n="second"),this.animationService.scrub({time:t,which:n})}}]),e}()).\u0275fac=function(e){return new(e||ph)(ve.Pb(y.h),ve.Pb(ye.a),ve.Pb(Ce.a),ve.Pb(ve.H),ve.Pb(ve.i))},ph.\u0275cmp=ve.Jb({type:ph,selectors:[["app-edit-timeline"]],viewQuery:function(e,t){var n;1&e&&(ve.Jc(Km,!0),ve.Jc(Jm,!0),ve.Jc(Xm,!0),ve.Jc(Zm,!0),ve.Jc(Ym,!0),ve.Jc(eh,!0),ve.Jc(th,!0),ve.Jc(nh,!0),ve.Jc(ih,!0)),2&e&&(ve.xc(n=ve.dc())&&(t.leafTimelinesWindow=n.first),ve.xc(n=ve.dc())&&(t.rulerWindow=n.first),ve.xc(n=ve.dc())&&(t.tracksWindow=n.first),ve.xc(n=ve.dc())&&(t.timelineRuler=n.first),ve.xc(n=ve.dc())&&(t.currentTimeHead=n.first),ve.xc(n=ve.dc())&&(t.currentTimeLine=n.first),ve.xc(n=ve.dc())&&(t.hoverTimeHead=n.first),ve.xc(n=ve.dc())&&(t.hoverTimeLine=n.first),ve.xc(n=ve.dc())&&(t.hoverTimeLabel=n.first))},decls:48,vars:42,consts:[[1,"edit-timeline"],[1,"edit-timeline__header-left"],[1,"edit-timeline__frame-controls"],["direction","previous",1,"ml-2"],["direction","next",1,"mr-2"],[1,"edit-timeline__header"],[1,"edit-timeline__ruler-window"],["rulerWindow",""],[1,"edit-timeline__ruler-container",3,"ngStyle"],[1,"edit-timeline__ruler",3,"ngStyle","mouseenter","mousemove","mouseleave","click"],["timelineRuler",""],["appEventFence","","class","edit-timeline__ruler-mark",3,"ngStyle","ngClass","mouseenter",4,"ngFor","ngForOf"],[1,"edit-timeline__indicator-heads",3,"ngStyle"],[1,"edit-timeline__total-time-head",3,"ngStyle"],[1,"edit-timeline__current-time-head",3,"mousedown"],["currentTimeHead",""],["icon","grip-lines-vertical"],[1,"edit-timeline__hover-time-head",3,"ngClass"],["hoverTimeHead",""],[1,"edit-timeline__header-gutter",3,"ngStyle"],[1,"edit-timeline__body-left"],[1,"edit-timeline__leaf-timelines-window"],["leafTimelinesWindow",""],[1,"edit-timeline__leaf-timelines-container"],[1,"edit-timeline__leaf-timelines"],["class","edit-timeline__leaf-timeline",3,"click",4,"ngFor","ngForOf"],[1,"edit-timeline__body-left-gutter",3,"ngStyle"],[1,"edit-timeline__body"],[1,"edit-timeline__tracks-window"],["tracksWindow",""],[1,"edit-timeline__tracks-container",3,"ngStyle"],[1,"edit-timeline__tracks",3,"ngStyle"],["class","edit-timeline__track",4,"ngFor","ngForOf"],[1,"edit-timeline__indicator-lines",3,"ngStyle"],[1,"edit-timeline__total-time-line",3,"ngStyle"],[1,"edit-timeline__current-time-line"],["currentTimeLine",""],[1,"edit-timeline__hover-time-line",3,"ngClass"],["hoverTimeLine",""],[1,"edit-timeline__hover-time-line-label"],["hoverTimeLabel",""],["appEventFence","",1,"edit-timeline__ruler-mark",3,"ngStyle","ngClass","mouseenter"],[1,"edit-timeline__ruler-mark-label","text-11",3,"click"],[1,"edit-timeline__leaf-timeline",3,"click"],[1,"edit-timeline__leaf-timeline-label","text-12"],["app-button","","appEventFence","",3,"matMenuTriggerFor"],["icon","ellipsis-v"],["leafTimelineActionsMenu","matMenu"],["mat-menu-item","",3,"click"],["mat-menu-item","",3,"disabled","click"],[1,"edit-timeline__track"],[3,"scale","timelineMap","click",4,"ngFor","ngForOf"],[3,"scale","timelineMap","click"]],template:function(e,t){1&e&&(ve.Vb(0,"div",0),ve.Vb(1,"div",1),ve.Vb(2,"div",2),ve.Qb(3,"app-engine-frame-control",3),ve.Qb(4,"app-engine-frame-control",4),ve.Qb(5,"app-engine-current-time"),ve.Ub(),ve.Ub(),ve.Vb(6,"div",5),ve.Vb(7,"div",6,7),ve.Vb(9,"div",8),ve.Vb(10,"div",9,10),ve.cc("mouseenter",(function(e){return t.handleRulerMouseEnter(e)}))("mousemove",(function(e){return t.handleRulerMouseMove(e)}))("mouseleave",(function(){return t.handleRulerMouseLeave()}))("click",(function(e){return t.scrubToRulerPosition(e)})),ve.Nc(12,rh,3,7,"div",11),ve.Ub(),ve.Vb(13,"div",12),ve.Qb(14,"div",13),ve.Vb(15,"div",14,15),ve.cc("mousedown",(function(e){return t.handleCTIMouseDown(e)})),ve.Qb(17,"app-icon",16),ve.Ub(),ve.Qb(18,"div",17,18),ve.Ub(),ve.Ub(),ve.Ub(),ve.Qb(20,"div",19),ve.Ub(),ve.Vb(21,"div",20),ve.Vb(22,"div",21,22),ve.Vb(24,"div",23),ve.Vb(25,"div",24),ve.Nc(26,ch,11,4,"div",25),ve.Ub(),ve.Ub(),ve.Ub(),ve.Qb(27,"div",26),ve.Ub(),ve.Vb(28,"div",27),ve.Vb(29,"div",28,29),ve.Vb(31,"div",30),ve.Vb(32,"div",31),ve.Nc(33,lh,2,1,"div",32),ve.Ub(),ve.Vb(34,"div",33),ve.Qb(35,"div",34),ve.Qb(36,"div",35,36),ve.Vb(38,"div",37,38),ve.Vb(40,"div",39,40),ve.Vb(42,"div"),ve.Pc(43),ve.Ub(),ve.Vb(44,"div"),ve.Pc(45),ve.Ub(),ve.Vb(46,"div"),ve.Pc(47),ve.Ub(),ve.Ub(),ve.Ub(),ve.Ub(),ve.Ub(),ve.Ub(),ve.Ub(),ve.Ub()),2&e&&(ve.Db(9),ve.mc("ngStyle",ve.pc(18,uh,t.tracksContainerWidth)),ve.Db(1),ve.mc("ngStyle",ve.pc(20,uh,t.chapterWidth)),ve.Db(2),ve.mc("ngForOf",t.rulerMarks),ve.Db(1),ve.mc("ngStyle",ve.pc(22,uh,t.chapterWidth)),ve.Db(1),ve.mc("ngStyle",ve.pc(24,oh,t.chapterWidth)),ve.Db(4),ve.mc("ngClass",ve.pc(26,dh,t.showHoverTimeIndicator)),ve.Db(2),ve.mc("ngStyle",ve.pc(28,uh,t.scrollBarWidth)),ve.Db(6),ve.mc("ngForOf",t.leafTimelines),ve.Db(1),ve.mc("ngStyle",ve.pc(30,mh,t.scrollBarWidth)),ve.Db(4),ve.mc("ngStyle",ve.pc(32,uh,t.tracksContainerWidth)),ve.Db(1),ve.mc("ngStyle",ve.pc(34,uh,t.chapterWidth)),ve.Db(1),ve.mc("ngForOf",t.chapterLeafTimelinesMaps),ve.Db(1),ve.mc("ngStyle",ve.pc(36,uh,t.chapterWidth)),ve.Db(1),ve.mc("ngStyle",ve.pc(38,oh,t.chapterWidth)),ve.Db(3),ve.mc("ngClass",ve.pc(40,hh,t.showHoverTimeIndicator)),ve.Db(5),ve.Qc(t.hoverTimeFormatted),ve.Db(2),ve.Qc(t.hoverTimeFrames),ve.Db(2),ve.Qc(t.hoverTimeSeconds))},directives:[jm,Am,f.q,f.o,yt.a,f.m,hu.a,Pe.a,Ki.d,Ki.a,Ki.b,Gm],styles:['.edit-timeline[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-webkit-scrollbar{width:12px;height:12px}.edit-timeline[_ngcontent-%COMP%]{display:grid;width:100%;background-color:#101823;grid-template-areas:"header-left header" "body-left body";grid-template-columns:320px 1fr;grid-template-rows:56px 1fr}.edit-timeline__header-left[_ngcontent-%COMP%]{grid-area:header-left;border-bottom:1px solid #283853;border-right:1px solid #283853}.edit-timeline__header[_ngcontent-%COMP%]{grid-area:header;display:flex}.edit-timeline__header-gutter[_ngcontent-%COMP%]{flex-shrink:0;border-left:1px solid #283853;border-bottom:1px solid #283853}.edit-timeline__body-left[_ngcontent-%COMP%]{grid-area:body-left;display:flex;flex-direction:column;border-right:1px solid #283853;overflow:hidden}.edit-timeline__body-left-gutter[_ngcontent-%COMP%]{flex-shrink:0;border-top:1px solid #283853}.edit-timeline__body[_ngcontent-%COMP%]{grid-area:body;overflow:hidden}.edit-timeline__frame-controls[_ngcontent-%COMP%]{display:flex;height:100%;align-items:center}.edit-timeline__ruler-window[_ngcontent-%COMP%]{position:relative;width:100%;height:100%;overflow:hidden}.edit-timeline__ruler-container[_ngcontent-%COMP%]{position:absolute;height:100%;display:flex;justify-content:center}.edit-timeline__ruler[_ngcontent-%COMP%]{position:relative;height:100%}.edit-timeline__ruler-mark[_ngcontent-%COMP%]{position:absolute;height:100%}.edit-timeline__ruler-mark[_ngcontent-%COMP%]:before{content:" ";bottom:0;position:absolute;height:22px;border-left:1px solid #283853}.edit-timeline__ruler-mark-label[_ngcontent-%COMP%]{color:#61779e;position:absolute;bottom:22px;cursor:pointer}.edit-timeline__ruler-mark-label[_ngcontent-%COMP%]:hover{color:#d7e0ea}.edit-timeline__seconds-mark[_ngcontent-%COMP%]:before{height:26px}.edit-timeline__seconds-mark[_ngcontent-%COMP%]   .edit-timeline__ruler-mark-label[_ngcontent-%COMP%]{color:#96a8c0;bottom:26px}.edit-timeline__seconds-mark[_ngcontent-%COMP%]   .edit-timeline__ruler-mark-label[_ngcontent-%COMP%]:hover{color:#d7e0ea}.edit-timeline__indicator-heads[_ngcontent-%COMP%]{position:absolute;pointer-events:none;height:100%;top:0}.edit-timeline__leaf-timelines-window[_ngcontent-%COMP%]{width:100%;height:100%;overflow-y:scroll;position:relative}.edit-timeline__leaf-timelines-container[_ngcontent-%COMP%]{width:100%;min-height:100%;display:flex;position:absolute}.edit-timeline__leaf-timelines[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%;background-color:#131c2a}.edit-timeline__leaf-timeline[_ngcontent-%COMP%]{display:flex;align-items:center;padding:0 8px;height:48px;border-bottom:1px solid #283853;cursor:pointer}.edit-timeline__leaf-timeline-label[_ngcontent-%COMP%]{flex-grow:1;padding:0 8px;word-break:break-all;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;color:#d7e0ea}.edit-timeline__leaf-timeline-label[_ngcontent-%COMP%]:hover{color:#fff}.edit-timeline__tracks-window[_ngcontent-%COMP%]{width:100%;height:100%;position:relative;overflow:scroll;background-color:#101823;scrollbar-color:#283853 transparent}.edit-timeline__tracks-window[_ngcontent-%COMP%]::-webkit-scrollbar:vertical{border-left:1px solid #283853}.edit-timeline__tracks-window[_ngcontent-%COMP%]::-webkit-scrollbar:horizontal{border-top:1px solid #283853}.edit-timeline__tracks-window[_ngcontent-%COMP%]::-webkit-scrollbar-track{background-color:transparent}.edit-timeline__tracks-window[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background-color:#374a68;border-radius:6px}.edit-timeline__tracks-window[_ngcontent-%COMP%]::-webkit-scrollbar-corner{background-color:transparent;border-top:1px solid #283853;border-left:1px solid #283853}.edit-timeline__tracks-container[_ngcontent-%COMP%]{position:absolute;min-height:100%;display:flex;justify-content:center}.edit-timeline__tracks[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;z-index:0}.edit-timeline__track[_ngcontent-%COMP%]{display:flex;position:relative;height:48px;background-color:#131c2a;border-bottom:1px solid #101823}.edit-timeline__indicator-lines[_ngcontent-%COMP%]{position:absolute;height:100%;top:0;pointer-events:none;z-index:1}.edit-timeline__current-time-head[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;left:0;height:50px;width:16px;margin-left:-8px;background-color:#2d72dc;cursor:pointer;color:#61779e;pointer-events:all}.edit-timeline__current-time-head[_ngcontent-%COMP%]:after{content:" ";position:absolute;bottom:-16px;border:8px solid transparent;border-top-color:#2d72dc}.edit-timeline__current-time-line[_ngcontent-%COMP%]{position:absolute;left:0;margin-left:-1px;height:100%;border-right:2px solid #2d72dc}.edit-timeline__total-time-head[_ngcontent-%COMP%]{position:absolute;height:50%;bottom:0;border-right:2px solid #283853}.edit-timeline__total-time-head[_ngcontent-%COMP%]:before{content:" ";position:absolute;height:12px;width:12px;margin-left:-5px;background-color:#283853}.edit-timeline__total-time-head[_ngcontent-%COMP%]:after{content:" ";position:absolute;top:12px;margin-left:-5px;border:6px solid transparent;border-top-color:#283853}.edit-timeline__total-time-line[_ngcontent-%COMP%]{position:absolute;height:100%;border-right:2px solid #283853}.edit-timeline__hover-time-head[_ngcontent-%COMP%]{position:absolute;display:none;height:100%;border-right:1px solid #2d72dc}.edit-timeline__hover-time-head--show[_ngcontent-%COMP%]{display:flex}.edit-timeline__hover-time-line[_ngcontent-%COMP%]{position:absolute;display:none;justify-content:center;height:100%;border-right:1px solid #2d72dc}.edit-timeline__hover-time-line--show[_ngcontent-%COMP%]{display:flex}.edit-timeline__hover-time-line-label[_ngcontent-%COMP%]{position:absolute;top:4px;color:#fff;background:rgba(16,24,35,.8);border-radius:4px;font-size:10px;padding:0 8px}.edit-timeline__hover-time-line-label[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{margin:4px 0}'],changeDetection:0}),Hm([Object(y.e)(hi.getScale),Wm("design:type",_.a)],ph.prototype,"scale$",void 0),Hm([Object(y.e)(hi.getSelectedTimelineMapIds),Wm("design:type",_.a)],ph.prototype,"selectedTimelineMapIds$",void 0),Hm([Object(y.e)(hi.getCopiedTimelineMaps),Wm("design:type",_.a)],ph.prototype,"copiedTimelineMaps$",void 0),Hm([Object(y.e)(D.a.getLoadChunksRemaining),Wm("design:type",_.a)],ph.prototype,"loadChunksRemaining$",void 0),Hm([Object(y.e)(X.a.getSelectedChapterId),Wm("design:type",_.a)],ph.prototype,"selectedChapterId$",void 0),Hm([Object(y.e)(X.a.getSelectedChapterTimelineMap),Wm("design:type",_.a)],ph.prototype,"selectedChapterTimelineMap$",void 0),ph),fh=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},gh=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function vh(e,t){if(1&e){var n=ve.Wb();ve.Tb(0),ve.Vb(1,"div"),ve.Pc(2),ve.Ub(),ve.Vb(3,"button",6),ve.Qb(4,"app-icon",7),ve.Ub(),ve.Vb(5,"mat-menu",null,8),ve.Vb(7,"button",9),ve.cc("click",(function(){return ve.Cc(n),ve.gc().copyTimelineMaps()})),ve.Pc(8,"Copy"),ve.Ub(),ve.Vb(9,"button",9),ve.cc("click",(function(){return ve.Cc(n),ve.gc().duplicateTimelineMap()})),ve.Pc(10,"Duplicate"),ve.Ub(),ve.Vb(11,"button",9),ve.cc("click",(function(){return ve.Cc(n),ve.gc().deleteTimelineMaps()})),ve.Pc(12,"Remove"),ve.Ub(),ve.Ub(),ve.Sb()}if(2&e){var i=ve.yc(6),o=ve.gc();ve.Db(2),ve.Qc(o.selectedTimelineMapsLabel),ve.Db(1),ve.mc("matMenuTriggerFor",i)}}function yh(e,t){1&e&&(ve.Vb(0,"div",11),ve.Vb(1,"app-form-field",27),ve.Vb(2,"mat-radio-group",28),ve.Vb(3,"mat-radio-button",29),ve.Pc(4,"Freeze "),ve.Ub(),ve.Vb(5,"mat-radio-button",30),ve.Pc(6,"Loop "),ve.Ub(),ve.Ub(),ve.Ub(),ve.Ub())}function xh(e,t){if(1&e&&(ve.Tb(0),ve.Vb(1,"form",10),ve.Vb(2,"div",11),ve.Vb(3,"app-form-field",12),ve.Qb(4,"input",13,14),ve.Qb(6,"app-character-counter",15),ve.Ub(),ve.Ub(),ve.Vb(7,"div",11),ve.Vb(8,"app-form-field",16),ve.Qb(9,"input",17),ve.Ub(),ve.Vb(10,"app-form-field",18),ve.Qb(11,"input",19),ve.Ub(),ve.Ub(),ve.Vb(12,"div",11),ve.Vb(13,"app-form-field",20),ve.Qb(14,"input",21),ve.Ub(),ve.Vb(15,"app-form-field",22),ve.Qb(16,"input",23),ve.Ub(),ve.Ub(),ve.Vb(17,"div",11),ve.Vb(18,"mat-checkbox",24),ve.Vb(19,"span",25),ve.Pc(20,"Fit clip to timeline."),ve.Ub(),ve.Ub(),ve.Ub(),ve.Nc(21,yh,7,0,"div",26),ve.Ub(),ve.Sb()),2&e){var n=ve.yc(5),i=ve.gc();ve.Db(1),ve.mc("formGroup",i.form),ve.Db(5),ve.mc("field",n),ve.Db(12),ve.mc("indeterminate",i.indeterminateFit),ve.Db(3),ve.mc("ngIf",i.fitIsFalse)}}function Ch(e,t){1&e&&(ve.Vb(0,"p",31),ve.Pc(1,"Click on a clip in the timeline panel to edit it."),ve.Ub())}var kh,Ph,Oh=/(^[+-/*]=)(.+$)/,wh=((kh=function(){function e(t,n,i,o){l(this,e),this.store=t,this.formBuilder=n,this.animationService=i,this.changeDetectorRef=o,this.ngUnsubscribe=new C.a}return u(e,[{key:"ngOnInit",value:function(){var e=this;this.form=this.formBuilder.group({name:[null,ae.C.maxLength(100)],start:null,end:null,dataStart:null,dataEnd:null,fit:[null,{updateOn:"change"}],onEnd:[null,{updateOn:"change"}]},{updateOn:"blur"}),this.form.valueChanges.pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.handleFormChanges(t)})),this.selectedChapterTimelineMap$.pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.chapterTimelineMaps=t})),this.selectedTimelineMapIds$.pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.selectedTimelineMapIds=Array.from(t),e.buildAggregateTimelineMap(),e.setFormValues(),e.setHasSelectedTimelineMaps(),e.setSelectedTimelineMapsLabel(),e.changeDetectorRef.markForCheck()}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"getSelectedTimelineMaps",value:function(){var e=this;return this.selectedTimelineMapIds.map((function(t){return e.chapterTimelineMaps.find((function(e){return t===e.id}))}))}},{key:"getTimelineMap",value:function(e){return this.chapterTimelineMaps.find((function(t){return e===t.id}))}},{key:"buildAggregateTimelineMap",value:function(){var e=[],t=[],n=[],i=[],o=[],a=[],r=[],c=function(e,t,n){return e===n[0]},s=function(e,t){return e&&t.length>0?t[0]:null};this.getSelectedTimelineMaps().forEach((function(c){e.push(c.name),t.push(c.start),n.push(c.end),i.push(c.data.start),o.push(c.data.end),a.push(c.data.fit),r.push(c.data.onEnd)}));var l=e.every(c),p=t.every(c),u=n.every(c),d=i.every(c),m=o.every(c),h=a.every(c),b=r.every(c);this.aggregateTimelineMap={name:s(l,e),start:s(p,t),end:s(u,n),dataStart:s(d,i),dataEnd:s(m,o),fit:s(h,a),onEnd:s(b,r)}}},{key:"setFormValues",value:function(){var e=this.aggregateTimelineMap.start,t=this.aggregateTimelineMap.end,n=this.aggregateTimelineMap.dataStart,i=this.aggregateTimelineMap.dataEnd;"number"==typeof e&&(e=this.animationService.formatTime(e)),"number"==typeof t&&(t=this.animationService.formatTime(t)),"number"==typeof n&&(n=this.animationService.formatTime(n)),"number"==typeof i&&(i=this.animationService.formatTime(i)),this.form.setValue({name:this.aggregateTimelineMap.name,start:e,end:t,dataStart:n,dataEnd:i,fit:this.aggregateTimelineMap.fit,onEnd:this.aggregateTimelineMap.onEnd},{emitEvent:!1}),this.indeterminateFit=null===this.aggregateTimelineMap.fit,this.fitIsFalse=!1===this.aggregateTimelineMap.fit}},{key:"parseTimeInput",value:function(e){var t=e.match(Oh);if(t){var n=t[1],i=this.animationService.parseFormattedTime(t[2]);return new Function("value","return value ".concat(n," ").concat(i))}return this.animationService.parseFormattedTime(e)}},{key:"handleFormChanges",value:function(e){var t=this,n=Object.entries(e).filter((function(e){var t=r(e,2),n=t[0],i=t[1];return"name"===n?null!==i:null!==i&&""!==i})),i=Object.fromEntries(n);["start","end","dataStart","dataEnd"].forEach((function(e){i.hasOwnProperty(e)&&(i[e]=t.parseTimeInput(i[e]))})),this.updateTimelineMaps(this.buildUpdates(i)),this.buildAggregateTimelineMap(),this.setFormValues()}},{key:"buildUpdates",value:function(e){var t=this,n=Array.from(this.store.selectSnapshot(hi.getSelectedTimelineMapIds)),i=function(e,t){var n="function"==typeof t?t(e):t;return n<0&&(n=e),n};return n.map((function(n){var o={id:n},a=t.getTimelineMap(n);return Object.entries(e).forEach((function(e){var t=r(e,2),n=t[0],c=t[1];switch(n){case"start":case"end":o[n]=i(a[n],c);break;case"dataStart":o.data=o.data||{},o.data.start=i(a.data.start,c);break;case"dataEnd":o.data=o.data||{},o.data.end=i(a.data.end,c);break;case"fit":o.data=o.data||{},o.data.fit=c;break;case"onEnd":o.data=o.data||{},o.data.onEnd=c;break;default:o[n]=c}})),o}))}},{key:"copyTimelineMaps",value:function(){var e=this,t=Array.from(this.selectedTimelineMapIds).map((function(t){var n=e.getTimelineMap(t),i=Object(ce.cloneDeep)(n);return delete i.id,i}));this.store.dispatch(new Kn.SetCopiedTimelineMaps(t))}},{key:"duplicateTimelineMap",value:function(){var e=this,t=[],n=Human.timeline.activeRoot._nowBranch,i=this.getSelectionOffset();this.getSelectedTimelineMaps().forEach((function(e){var n=Object(ce.cloneDeep)(e),o=n.end-n.start;delete n.id,n.start=n.start+i,n.end=n.start+o,t.push(n)})),t.forEach((function(t){e.animationService.addTimelineMap(n,t)})),this.store.dispatch(new J.b(n.id,t))}},{key:"updateTimelineMaps",value:function(e){var t=Human.timeline.activeRoot._nowBranch;this.animationService.updateTimelineMaps(t,e),this.store.dispatch(new J.J(t.id,e))}},{key:"deleteTimelineMaps",value:function(){var e=Human.timeline.activeRoot._nowBranch,t=Array.from(this.store.selectSnapshot(hi.getSelectedTimelineMapIds));this.animationService.deleteTimelineMaps(e,t),this.store.dispatch(new J.l(e.id,t)),this.store.dispatch(new Kn.SetSelectedTimelineMapIds([]))}},{key:"setSelectedTimelineMapsLabel",value:function(){this.selectedTimelineMapsLabel="".concat(this.selectedTimelineMapIds.length," ").concat(this.selectedTimelineMapIds.length>1?"clips":"clip"," selected")}},{key:"setHasSelectedTimelineMaps",value:function(){this.hasSelectedTimelineMaps=this.selectedTimelineMapIds.length>0}},{key:"getSelectionOffset",value:function(){var e=this,t=this.getSelectedTimelineMaps(),n={},i=Human.timeline.activeRoot._nowBranch;t.forEach((function(t){var o=t.data.timeline;if(!n.hasOwnProperty(o)){var a=e.animationService.getLeafTimelines()[o],r=i.getLeafTimelineMaps(a),c=0;r.forEach((function(e){e.end>c&&(c=e.end)})),n[o]=c}}));var o=Object.values(n),r=Math.max.apply(Math,a(o)),c=1/0;return t.forEach((function(e){e.start<c&&(c=e.start)})),r-c}}]),e}()).\u0275fac=function(e){return new(e||kh)(ve.Pb(y.h),ve.Pb(ae.f),ve.Pb(ye.a),ve.Pb(ve.i))},kh.\u0275cmp=ve.Jb({type:kh,selectors:[["app-edit-timeline-maps"]],decls:7,vars:3,consts:[[1,"edit-timeline-maps"],[1,"edit-timeline-maps__header"],[4,"ngIf"],[1,"edit-timeline-maps__body"],[4,"ngIf","ngIfElse"],["noSelectedTimelineMaps",""],["app-button","",3,"matMenuTriggerFor"],["icon","ellipsis-v"],["timelineMapsActionsMenu","matMenu"],["mat-menu-item","",3,"click"],["autocomplete","off",1,"edit-timeline-maps__form",3,"formGroup"],[1,"edit-timeline-maps__form-row"],["label","Name",1,"flex-grow"],["type","text","maxlength","100","formControlName","name","autocomplete","timelinemap-name",1,"input","w-100"],["name",""],[3,"field"],["label","In Point",1,"mr-2"],["type","text","formControlName","start",1,"input","w-100"],["label","Out Point",1,"ml-2"],["type","text","formControlName","end",1,"input","w-100"],["label","State Start",1,"mr-2"],["type","text","formControlName","dataStart",1,"input","w-100"],["label","State End",1,"ml-2"],["type","text","formControlName","dataEnd",1,"input","w-100"],["formControlName","fit",1,"pb-4",3,"indeterminate"],[1,"text-12"],["class","edit-timeline-maps__form-row",4,"ngIf"],["label","On End",1,"flex-grow"],["formControlName","onEnd",1,"flex"],["value","freeze",1,"flex-grow","text-12"],["value","loop",1,"flex-grow","text-12"],[1,"text-12","pt-2"]],template:function(e,t){if(1&e&&(ve.Vb(0,"div",0),ve.Vb(1,"div",1),ve.Nc(2,vh,13,2,"ng-container",2),ve.Ub(),ve.Vb(3,"div",3),ve.Nc(4,xh,22,4,"ng-container",4),ve.Nc(5,Ch,2,0,"ng-template",null,5,ve.Oc),ve.Ub(),ve.Ub()),2&e){var n=ve.yc(6);ve.Db(2),ve.mc("ngIf",t.hasSelectedTimelineMaps),ve.Db(2),ve.mc("ngIf",t.hasSelectedTimelineMaps)("ngIfElse",n)}},directives:[f.p,Pe.a,Ki.d,yt.a,Ki.a,Ki.b,ae.E,ae.s,ae.j,Oe.a,ae.c,ae.m,ae.r,ae.i,we.a,Ue.a,Dt.b,Dt.a],styles:[".edit-timeline-maps[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}.edit-timeline-maps__header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;height:56px;flex-shrink:0;border-bottom:1px solid #283853;padding:0 16px}.edit-timeline-maps__body[_ngcontent-%COMP%]{flex-grow:1;padding:16px 16px 0}.edit-timeline-maps__form[_ngcontent-%COMP%]{display:flex;flex-direction:column}.edit-timeline-maps__form-row[_ngcontent-%COMP%]{display:flex}"],changeDetection:0}),fh([Object(y.e)(X.a.getSelectedChapterTimelineMap),gh("design:type",_.a)],kh.prototype,"selectedChapterTimelineMap$",void 0),fh([Object(y.e)(hi.getSelectedTimelineMapIds),gh("design:type",_.a)],kh.prototype,"selectedTimelineMapIds$",void 0),kh),Sh=o("Jk2I"),_h=((Ph=function(){function e(){l(this,e),this._count=0}return u(e,[{key:"count",get:function(){return this._count},set:function(e){this._count=e}},{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||Ph)},Ph.\u0275cmp=ve.Jb({type:Ph,selectors:[["app-edit-reload-countdown"]],inputs:{count:"count"},decls:6,vars:1,consts:[["data-test","reloadCountdown",1,"reload-countdown"],["total","90",3,"value"],[1,"text-16","mt-2"],[1,"text-12"]],template:function(e,t){1&e&&(ve.Vb(0,"div",0),ve.Qb(1,"app-progress",1),ve.Vb(2,"div",2),ve.Pc(3,"Duplicating states on the server."),ve.Ub(),ve.Vb(4,"div",3),ve.Pc(5," This page will automatically reload in 90 seconds. You may reload it sooner at your own risk, however it's possible not all states will have completed duplicating. "),ve.Ub(),ve.Ub()),2&e&&(ve.Db(1),ve.mc("value",t.count))},directives:[Sh.a],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}[_nghost-%COMP%]{display:flex;position:absolute;justify-content:center;align-items:center;background:rgba(0,0,0,.5);color:#fff;z-index:10000;top:0;bottom:0;left:0;right:0}.reload-countdown[_ngcontent-%COMP%]{width:400px;height:400px}"],changeDetection:0}),Ph),Mh=o("nhKa"),Uh=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},Th=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Vh=["engineContainer"];function Dh(e,t){1&e&&ve.Qb(0,"a",55)}function Eh(e,t){1&e&&ve.Qb(0,"a",56)}function jh(e,t){1&e&&(ve.Tb(0),ve.Pc(1,"* "),ve.Sb())}function Nh(e,t){if(1&e&&(ve.Tb(0),ve.Pc(1),ve.hc(2,"async"),ve.hc(3,"async"),ve.Nc(4,jh,2,0,"ng-container",33),ve.hc(5,"async"),ve.hc(6,"async"),ve.Sb()),2&e){var n=ve.gc(2),i=null;ve.Db(1),ve.Sc(" ",ve.ic(2,3,n.canvasSize$).width," x ",ve.ic(3,5,n.canvasSize$).height," "),ve.Db(3),ve.mc("ngIf",(null==(i=ve.ic(5,7,n.canvasSettings$))?null:i.emulateDrawer)||(null==(i=ve.ic(6,9,n.canvasSettings$))?null:i.emulateColumn))}}function Rh(e,t){1&e&&(ve.Tb(0),ve.Pc(1," Size "),ve.Sb())}function Ah(e,t){if(1&e&&(ve.Vb(0,"div",63),ve.Pc(1),ve.Ub()),2&e){var n=ve.gc().$implicit;ve.Db(1),ve.Sc("",n.width," x ",n.height,"")}}function Fh(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"button",51),ve.cc("click",(function(){ve.Cc(n);var e=t.$implicit;return ve.gc(2).setCanvasSize(e)})),ve.Vb(1,"div",61),ve.Vb(2,"div"),ve.Pc(3),ve.Ub(),ve.Nc(4,Ah,2,2,"div",62),ve.Ub(),ve.Ub()}if(2&e){var i=t.$implicit;ve.Db(3),ve.Qc(i.label),ve.Db(1),ve.mc("ngIf",-1!==i.width)}}function Ih(e,t){if(1&e&&(ve.Vb(0,"div",10),ve.Vb(1,"button",57),ve.Nc(2,Nh,7,11,"ng-container",33),ve.hc(3,"async"),ve.Nc(4,Rh,2,0,"ng-container",33),ve.hc(5,"async"),ve.Qb(6,"app-icon",58),ve.Ub(),ve.Vb(7,"mat-menu",null,59),ve.Nc(9,Fh,5,2,"button",60),ve.Ub(),ve.Ub()),2&e){var n=ve.yc(8),i=ve.gc();ve.Db(1),ve.mc("matMenuTriggerFor",n)("matTooltip",i.canvasSizeTooltip),ve.Db(1),ve.mc("ngIf",-1!==ve.ic(3,5,i.canvasSize$).width),ve.Db(2),ve.mc("ngIf",-1===ve.ic(5,7,i.canvasSize$).width),ve.Db(5),ve.mc("ngForOf",i.canvasSizes)}}function zh(e,t){1&e&&ve.Qb(0,"app-memory-summary",24)}function Lh(e,t){1&e&&ve.Qb(0,"app-edit-exit")}function Bh(e,t){1&e&&ve.Qb(0,"app-edit-document-context")}function Qh(e,t){1&e&&ve.Qb(0,"app-edit-label-context")}function $h(e,t){1&e&&ve.Qb(0,"app-edit-paint-context")}function qh(e,t){1&e&&ve.Qb(0,"app-edit-quiz-context")}function Gh(e,t){1&e&&ve.Qb(0,"app-edit-chapter-pagination")}function Hh(e,t){1&e&&(ve.Vb(0,"div",64),ve.Qb(1,"app-engine-scrubber",65),ve.Ub())}function Wh(e,t){if(1&e&&(ve.Vb(0,"button",72),ve.Pc(1),ve.hc(2,"async"),ve.Qb(3,"app-icon",58),ve.Ub()),2&e){ve.gc();var n=ve.yc(4),i=ve.gc();ve.mc("matMenuTriggerFor",n),ve.Db(1),ve.Rc(" ",i.formatTimelineScale(ve.ic(2,2,i.timelineScale$))," ")}}function Kh(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"button",51),ve.cc("click",(function(){ve.Cc(n);var e=t.$implicit;return ve.gc(2).setTimelineScale(e)})),ve.Vb(1,"div"),ve.Pc(2),ve.Ub(),ve.Ub()}if(2&e){var i=t.$implicit,o=ve.gc(2);ve.Db(2),ve.Qc(o.formatTimelineScale(i))}}function Jh(e,t){1&e&&ve.Qb(0,"app-icon",73)}function Xh(e,t){1&e&&ve.Qb(0,"app-icon",74)}function Zh(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"div",66),ve.Nc(1,Wh,4,4,"button",67),ve.hc(2,"async"),ve.Vb(3,"mat-menu",null,68),ve.Nc(5,Kh,3,1,"button",60),ve.Ub(),ve.Vb(6,"button",69),ve.cc("click",(function(){return ve.Cc(n),ve.gc().toggleTimelineEditor()})),ve.hc(7,"async"),ve.Nc(8,Jh,1,0,"app-icon",70),ve.hc(9,"async"),ve.Nc(10,Xh,1,0,"app-icon",71),ve.hc(11,"async"),ve.Ub(),ve.Ub()}if(2&e){var i=ve.gc();ve.Db(1),ve.mc("ngIf",ve.ic(2,5,i.showTimelineEditor$)),ve.Db(4),ve.mc("ngForOf",i.timelineScales),ve.Db(1),ve.mc("matTooltip",ve.ic(7,7,i.showTimelineEditor$)?"Close Timeline Editor":"Open Timeline Editor"),ve.Db(2),ve.mc("ngIf",!ve.ic(9,9,i.showTimelineEditor$)),ve.Db(2),ve.mc("ngIf",ve.ic(11,11,i.showTimelineEditor$))}}function Yh(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"app-button-group"),ve.Vb(1,"button",75),ve.cc("click",(function(){return ve.Cc(n),ve.gc().preview("modal")})),ve.hc(2,"async"),ve.Pc(3," Preview "),ve.Ub(),ve.Vb(4,"button",76),ve.hc(5,"async"),ve.Qb(6,"app-icon",77),ve.Ub(),ve.Ub()}if(2&e){var i=ve.gc(),o=ve.yc(107);ve.Db(1),ve.mc("disabled",i.atBookmarkLimit||ve.ic(2,3,i.saving$)),ve.Db(3),ve.mc("matMenuTriggerFor",o)("disabled",ve.ic(5,5,i.saving$))}}function eb(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"button",75),ve.cc("click",(function(){return ve.Cc(n),ve.gc().preview("modal")})),ve.hc(1,"async"),ve.Pc(2," Preview "),ve.Ub()}if(2&e){var i=ve.gc();ve.mc("disabled",i.atBookmarkLimit||ve.ic(1,1,i.saving$))}}function tb(e,t){1&e&&(ve.Vb(0,"span"),ve.Pc(1,"Upgrade Now"),ve.Ub())}function nb(e,t){1&e&&ve.Qb(0,"app-spinner",82)}function ib(e,t){if(1&e&&(ve.Vb(0,"span"),ve.Nc(1,nb,1,0,"app-spinner",81),ve.hc(2,"async"),ve.Pc(3," Save "),ve.Ub()),2&e){var n=ve.gc(2);ve.Db(1),ve.mc("ngIf",ve.ic(2,1,n.saving$))}}function ob(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"app-button-group",78),ve.Vb(1,"button",79),ve.cc("click",(function(){return ve.Cc(n),ve.gc().handleSaveBookmark()})),ve.hc(2,"async"),ve.Nc(3,tb,2,0,"span",33),ve.Nc(4,ib,4,3,"span",33),ve.Ub(),ve.Vb(5,"button",80),ve.hc(6,"async"),ve.Qb(7,"app-icon",77),ve.Ub(),ve.Ub()}if(2&e){var i=ve.gc(),o=ve.yc(83);ve.Db(1),ve.mc("disabled",ve.ic(2,5,i.saving$)),ve.Db(2),ve.mc("ngIf",i.atBookmarkLimit),ve.Db(1),ve.mc("ngIf",!i.atBookmarkLimit),ve.Db(1),ve.mc("matMenuTriggerFor",o)("disabled",ve.ic(6,7,i.saving$))}}function ab(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"app-button-group",83),ve.Vb(1,"button",84),ve.cc("click",(function(){return ve.Cc(n),ve.gc().saveModule()})),ve.hc(2,"async"),ve.Pc(3," Save "),ve.Ub(),ve.Vb(4,"button",85),ve.hc(5,"async"),ve.Qb(6,"app-icon",77),ve.Ub(),ve.Ub()}if(2&e){var i=ve.gc(),o=ve.yc(94);ve.Db(1),ve.mc("disabled",ve.ic(2,3,i.saving$)),ve.Db(3),ve.mc("matMenuTriggerFor",o)("disabled",ve.ic(5,5,i.saving$))}}function rb(e,t){1&e&&ve.Qb(0,"app-edit-timeline",86)}function cb(e,t){1&e&&ve.Qb(0,"app-edit-timeline-maps",87)}function sb(e,t){if(1&e){var n=ve.Wb();ve.Tb(0),ve.Vb(1,"button",51),ve.cc("click",(function(){return ve.Cc(n),ve.gc().exportQuizKey()})),ve.Pc(2,"Export Quiz Key"),ve.Ub(),ve.Qb(3,"mat-divider"),ve.Sb()}}function lb(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"button",88),ve.cc("click",(function(){return ve.Cc(n),ve.gc().publishBookmark()})),ve.hc(1,"async"),ve.Pc(2," Publish "),ve.Ub()}if(2&e){var i=ve.gc();ve.mc("disabled",i.atBookmarkLimit||ve.ic(1,1,i.saving$))}}function pb(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"button",89),ve.cc("click",(function(){return ve.Cc(n),ve.gc().upgrade()})),ve.Pc(1," Upgrade Now "),ve.Ub()}}function ub(e,t){if(1&e){var n=ve.Wb();ve.Vb(0,"button",51),ve.cc("click",(function(){return ve.Cc(n),ve.gc().exportQuizKey()})),ve.Pc(1," Export Quiz Key "),ve.Ub()}}function db(e,t){if(1&e&&ve.Qb(0,"app-edit-reload-countdown",90),2&e){var n=ve.gc();ve.mc("count",n.reloadCount)}}var mb,hb,bb,fb,gb,vb,yb,xb,Cb,kb,Pb,Ob=function(e,t,n,i,o){return{"edit--hide-left-column":e,"edit--hide-right-column":t,"edit--hide-header":n,"edit--hide-footer":i,"edit--show-timeline-editor":o}},wb=function(e){return{"edit__breadcrumb--hide":e}},Sb=((mb=function(){function e(t,n,i,o,a,r,c,s,p,u,d,m,h,b,f,g,y,x,k,P,O,w){l(this,e),this.actions=t,this.activatedRoute=n,this.router=i,this.animationService=o,this.bookmarkService=a,this.modulesService=r,this.bookmarkActionsService=c,this.cameraService=s,this.pendoService=p,this.dialog=u,this.dialogService=d,this.storageService=m,this.userAccessService=h,this.location=b,this.snackBar=f,this.store=g,this.storyService=y,this.engineService=x,this.cleanupService=k,this.imageService=P,this.snackbar=O,this.changeDetectorRef=w,this.layoutThemeEnum=v.a,this.editViewEnum=M.a,this.toolEnum=ne.a,this.environmentApplication=fe.a,this.toolIcons=pn,this.exportType=dn.a.exportType,this.canvasSizes=bn.b,this.canvasSizeTooltip="Emulate canvas size",this.reloadCount=0,this.showReloadBlocker=!1,this.isStoryDirty=!1,this.timelineScales=ai,this.ngUnsubscribe=new C.a,this.application=fe.a,this.isAnimated=!1,this.atBookmarkLimit=!1}return u(e,[{key:"ngOnInit",value:function(){var e=this.activatedRoute.snapshot.queryParams.id;this.id=this.sanitizeRouteId(e),this.type=this.storyService.getStoryType(this.id),this.store.dispatch(new H.a.SetTheme(v.a.Dark)),this.store.dispatch(new q.w(ne.a.Select)),this.store.dispatch(new U.e),this.store.dispatch(new q.A(!0)),this.store.dispatch(new q.Y(!0)),this.store.dispatch(new q.Z(!0)),this.store.dispatch(new Z.c(!0)),this.store.dispatch(new ie.e(!1)),this.store.dispatch(new $.m(this.id,this.type)),this.store.dispatch(new ee.C(this.id,this.type)),this.store.dispatch(new ie.s({tag:!0,pin:!0})),this.engineService.enableRender(),this.store.dispatch(new q.y(!1)),this.store.dispatch(new q.W(!1)),this.engineService.enableRender(),this.engineService.enableAnimation(),dn.a.application===fe.a.Loft&&this.store.dispatch(new xn.a.Reset),this.resizeEngineContainer(),this.initListeners(),this.initAuthChecks(),this.initKeyboardListeners(),this.initDirtyCheck(),this.initCaptureListener(),this.initLoadListener(),this.initPendoEvents(),this.prepareThumbnails(this.id),this.initViewGraphListeners(),this.initContentViews(),this.initPaints(),this.initStoryRecipes(),this.initNodePaintListener()}},{key:"ngAfterViewInit",value:function(){var e=this;setTimeout((function(){return e.resizeEngineContainer()}),0)}},{key:"ngOnDestroy",value:function(){this.autoCaptureListener$.unsubscribe(),this.store.dispatch(new H.a.SetTheme(v.a.Light)),this.store.dispatch(new q.A(!1)),this.store.dispatch(new ie.e(!1)),this.unbindKeyboardListeners(),this.cleanupService.resetScene(),this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"canDeactivate",value:function(){var e=this;if(this.store.selectSnapshot(oe.a.getUserProfile)&&this.isStoryDirty&&!this.atBookmarkLimit){var t=this.store.selectSnapshot(te.a.getSelectedBookmark),n=this.store.selectSnapshot(D.a.getStory).displayName,i=this.getBookmarkSaveType(t);return this.confirmSaveDialog(!0).pipe(Object(E.a)((function(o){if(void 0===o)return Object(k.a)(!1);if(!o)return Object(k.a)(!0);switch(dn.a.application){case fe.a.Studio:return("save"===i?e.saveBookmark(t,!0):e.saveNewBookmarkDialog("Save As",n)).pipe(Object(j.a)((function(){return!0})));case fe.a.Loft:e.openSaveModuleDialog(e.id).afterClosed().pipe(Object(j.a)((function(){return!0})))}})),Object(N.a)(this.ngUnsubscribe))}return Object(k.a)(!0)}},{key:"setCanvasSize",value:function(e){this.store.dispatch(new U.f(e)),this.resizeEngineContainer()}},{key:"resizeEngineContainer",value:function(){var e=this.engineContainer.nativeElement,t=e.offsetLeft,n=e.offsetTop,i=e.offsetWidth,o=e.offsetHeight,a=t,r=n,c=i,s=o,l=this.store.selectSnapshot(T.a.getCanvasSize);if(-1!==l.width||-1!==l.height){var p=[l.width,l.height];c=p[0],s=p[1];var u=this.store.selectSnapshot(T.a.getCanvasSettings);if(u.emulateDrawer&&l.width<960&&(s-=64),u.emulateColumn&&l.width>=960&&(c-=320),s>o){var d=o/s;s*=d,c*=d}if(c>i){var m=i/c;s*=m,c*=m}r=n+(o-s)/2,a=t+(i-c)/2}this.canvasSizeTooltip=-1===l.width?"Emulate canvas size":"Canvas size is ".concat(c,"px x ").concat(s,"px with ").concat(l.width>=960?ei.a.Column:ei.a.Drawer);var h=new G.a(a,r,c,s,W.a.Shown);this.store.dispatch(new q.D(h))}},{key:"initListeners",value:function(){var e=this;this.windowResize$=Object(P.a)(window,"resize"),Object(O.b)([this.engineReady$,this.incoming$]).pipe(Object(R.a)((function(e){var t=r(e,2),n=t[0],i=t[1];return n&&!!i.id})),Object(N.a)(this.ngUnsubscribe)).subscribe((function(){e.loadStory()})),Object(w.a)(this.showLeftColumn$,this.showRightColumn$,this.showHeader$,this.showFooter$,this.showTimelineEditor$,this.windowResize$).pipe(Object(A.a)(10),Object(N.a)(this.ngUnsubscribe)).subscribe((function(){e.resizeEngineContainer()})),this.record$.subscribe((function(t){e.record=t})),this.selectedChapterId$.pipe(Object(R.a)((function(e){return null!=e})),Object(j.a)((function(t){return e.store.selectSnapshot(X.a.getSelectedChapter)})),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.handleChapterChange(t)})),this.selectedLabel$.pipe(Object(R.a)((function(e){return null!=e})),Object(N.a)(this.ngUnsubscribe)).subscribe((function(){e.store.dispatch(new q.w(ne.a.Label)),e.store.dispatch(new U.h(M.a.Label))})),this.actions.pipe(Object(y.l)(q.d),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.handleNodeClick(t.node,t.event)})),this.actions.pipe(Object(y.l)(ee.B),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){return e.handleSaveBookmarkSuccess(t)})),this.actions.pipe(Object(y.l)(ee.A),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){return e.handleSaveBookmarkFailure(t)})),this.actions.pipe(Object(y.l)(mn.h),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){return e.handleSaveModuleSuccess(t)})),this.actions.pipe(Object(y.l)(J.d),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){setTimeout((function(){e.store.dispatch(new J.f),e.snackbar.open('Duplicated chapter "'.concat(t.chapter.info.displayName,'"'))}))})),this.actions.pipe(Object(y.l)(J.j),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.snackbar.open('"'.concat(t.chapter.info.displayName,'" chapter has been removed'))})),this.actions.pipe(Object(y.l)($.h),Object(N.a)(this.ngUnsubscribe)).subscribe((function(){e.store.dispatch(new $.m(null,null)),e.router.navigate(["/404"],{queryParams:{errorType:"content",errorUrl:e.router.url},skipLocationChange:!0})})),this.actions.pipe(Object(y.l)($.d),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.snackbar.open("Successfully imported ".concat(t.story.displayName,"."))})),this.actions.pipe(Object(y.l)(q.a,q.v),Object(N.a)(this.ngUnsubscribe)).subscribe((function(){e.snackbar.open("Successfully updated model layers.")})),this.actions.pipe(Object(y.l)(U.c),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.preview("modal",t.quizLocked,t.quizQuestion)})),this.actions.pipe(Object(y.l)(J.b,J.l),Object(N.a)(this.ngUnsubscribe)).subscribe((function(){var t=e.store.selectSnapshot(X.a.getSelectedChapter);e.isAnimated=e.animationService.isChapterAnimated(t)}))}},{key:"initAuthChecks",value:function(){var e=this;this.selectedBookmark$.pipe(Object(R.a)((function(t){return"module"===e.type})),Object(R.a)((function(e){return null!=e})),Object(F.a)(1),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){var n=e.store.selectSnapshot(oe.a.getUserRole);e.type!==sn.a.Bookmark||ni.e(n,t)||e.openBookmarkAccessDialog()})),this.selectedBookmark$.pipe(Object(R.a)((function(e){return!!e})),Object(R.a)((function(t){return!e.isBookmarkEditable(t)})),Object(I.a)((function(){return e.bookmarkActionsService.checkBookmarkLimit()})),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.handleBookmarkLimit(t)}))}},{key:"initContentViews",value:function(){var e=this;Object(O.b)([this.store.select(oe.a.isPremiumUser),this.store.select(X.a.getSelectedChapterModelReady),this.store.select(oe.a.getContentViews)]).pipe(Object(R.a)((function(e){var t=r(e,3),n=t[0],i=t[1],o=t[2];return!n&&i&&!o.limit_reached})),Object(F.a)(1),Object(N.a)(this.ngUnsubscribe)).subscribe((function(){e.store.dispatch(new hn.V(e.id,e.type))}))}},{key:"initStoryRecipes",value:function(){var e=this;this.story$.pipe(Object(R.a)((function(e){return null!=e})),Object(N.a)(this.ngUnsubscribe),Object(F.a)(1)).subscribe((function(t){e.store.dispatch(new fi.g),t.chapters.forEach((function(t){var n=[];Object(ce.isNil)(t.synchronization)||Object.values(t.synchronization).forEach((function(e){var t=new bi.a(e);bi.a.isRealRecipe(t)&&n.push(t)})),e.store.dispatch(new fi.l(t.id,n))}))}))}},{key:"initPaints",value:function(){var e=this.storageService.getLocalJSON(On.b.RecentRecipes);this.store.dispatch(new fi.k(e));var t=this.storageService.getLocalJSON(On.b.PaintPalettes);this.store.dispatch(new fi.j(t))}},{key:"initNodePaintListener",value:function(){var e=this;this.actions.pipe(Object(y.k)(fn.a.UpdateNodesPaint),Object(N.a)(this.ngUnsubscribe)).subscribe((function(){var t=e.store.selectSnapshot(vi.a.getCurrentRecipeForEngine);bi.a.isRealRecipe(t)&&e.store.dispatch(new fi.b(t));var n=e.store.selectSnapshot(ln.a.getNodes),i=e.buildChapterRecipes(n),o=e.store.selectSnapshot(X.a.getSelectedChapterId);e.store.dispatch(new fi.l(o,i)),e.changeDetectorRef.markForCheck()}))}},{key:"buildChapterRecipes",value:function(e){var t=[];return Object.values(e).forEach((function(e){if(gi.a.isRealRecipe(e.paint)){var n=gi.a.toEngine(e.paint);-1===bi.a.recipeIndexOf(t,n)&&t.push(n)}})),t.filter((function(e){return void 0!==e})).sort(bi.a.compare)}},{key:"initDirtyCheck",value:function(){var e=this;this.actions.pipe(Object(y.l)($.i,ee.B,mn.h,hn.J),Object(N.a)(this.ngUnsubscribe)).subscribe((function(){e.isStoryDirty=!1})),this.actions.pipe(Object(y.l)(fn.a.UpdateNodesPaint,fn.a.UpdateNodesPickable,fn.a.UpdateNodesShown,ie.b,ie.i,ie.d,ie.m,ie.n,J.d,J.j,$.d,$.j,ee.E,$.r,J.s,J.r,J.u,J.F,J.E,J.B,J.m,J.x,J.G,J.t,ii.b,J.i,Ai.a.AddQuestion,Ai.a.CopyQuestions,Ai.a.ReorderQuestions,Ai.a.RemoveQuestions,Ai.a.SetQuestion),Object(N.a)(this.ngUnsubscribe)).subscribe((function(){e.isStoryDirty=!0}))}},{key:"initCaptureListener",value:function(){var e=this;if(dn.a.application===fe.a.Studio){var t=this.storageService.getLocalJSON(On.b.AutoCapture);null!==t&&this.store.dispatch(new U.a(t))}var n=Object(S.a)(1e3,1e3).pipe(Object(N.a)(this.ngUnsubscribe),Object(j.a)((function(){return e.cameraService.getCamera()})),Object(z.a)(),Object(R.a)((function(t){var n=r(t,2),i=n[0],o=n[1];return!e.cameraService.areCamerasEqual(i,o)}))),i=this.actions.pipe(Object(y.l)(U.a),Object(R.a)((function(e){return e.enable}))),o=this.actions.pipe(Object(y.l)(fn.a.UpdateNodesPaint,fn.a.UpdateNodesShown,J.s,J.r,gn.a.Undo,gn.a.Redo,gn.a.Reset),Object(N.a)(this.ngUnsubscribe));this.autoCaptureListener$=Object(w.a)(n,o,i).pipe(Object(R.a)((function(){return 0===e.store.selectSnapshot(D.a.getLoadChunksRemaining).length&&e.store.selectSnapshot(T.a.getAutoCapture)&&!e.animationService.isPlaying()})),Object(N.a)(this.ngUnsubscribe)).subscribe((function(){e.capturePosition()}))}},{key:"initLoadListener",value:function(){var e=this;this.store.select(D.a.getLoadingChunk).pipe(Object(R.a)((function(){return null!=e.store.selectSnapshot(X.a.getSelectedChapterId)})),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){null!==t&&t.chapterId===e.store.selectSnapshot(X.a.getSelectedChapterId)||e.engineService.enableAnimation()}))}},{key:"initPendoEvents",value:function(){var e=this;this.store.select(X.a.getSelectedChapterModelReady).pipe(Object(R.a)((function(e){return e})),Object(F.a)(1),Object(N.a)(this.ngUnsubscribe)).subscribe((function(){var t=e.store.selectSnapshot(D.a.getStoryId),n=e.store.selectSnapshot(D.a.getStory);e.pendoService.trackOncePerPage("View - Loaded",{id:t,chapters:n.chapters.length,tour:n.tags.includes("tour"),animated:n.tags.includes("animated"),quiz:e.store.selectSnapshot(ti.b.hasQuiz),edit:!0})}))}},{key:"initViewGraphListeners",value:function(){var e=this;this.store.select(T.a.getShowRootNodes).pipe(Object(L.a)(1),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){var n=e.engineService.createViewGraph({},!1,t);e.store.dispatch(new q.E(n))}))}},{key:"handleBookmarkLimit",value:function(e){var t=e.limit_reached;this.atBookmarkLimit=t;var n=this.store.selectSnapshot(oe.a.getUserProfile),i=this.store.selectSnapshot(te.a.getSelectedBookmark);if(n&&i){var o=n.premium_account_valid,a=this.isBookmarkEditable(i);!t||a||o||this.userAccessService.openBookmarkSaveLimit()}}},{key:"initKeyboardListeners",value:function(){var e=this;un.bind("1",(function(){return e.handleSelectTool(ne.a.Select)})),un.bind("2",(function(){return e.handleSelectTool(ne.a.Hide)})),un.bind("3",(function(){return e.handleSelectTool(ne.a.Label)})),un.bind("4",(function(){return e.handleSelectTool(ne.a.Paint)})),un.bind("5",(function(){return e.handleSelectTool(ne.a.Quiz)})),un.bind("shift+4",(function(){return e.handleSelectTool(ne.a.Eyedropper)})),un.bind("meta+,",(function(t){t.preventDefault(),e.showColumn("left")})),un.bind("meta+.",(function(t){t.preventDefault(),e.showColumn("right")})),un.bind("meta+/",(function(t){t.preventDefault(),e.showColumn("header")})),un.bind("meta+m",(function(t){t.preventDefault(),e.showColumn("footer")})),un.bind("meta+z",(function(t){t.preventDefault(),e.undo()})),un.bind(["meta+y","meta+shift+z"],(function(t){t.preventDefault(),e.redo()})),un.bind([".","pagedown"],(function(){return e.nextChapter()})),un.bind([",","pageup"],(function(){return e.previousChapter()})),un.bind(["del","backspace"],(function(){return e.handleDelete()})),un.bind("meta+a",(function(t){t.preventDefault(),e.handleSelectAll()}))}},{key:"unbindKeyboardListeners",value:function(){un.reset()}},{key:"handleChapterTitleClick",value:function(){this.openChapterContentDialog()}},{key:"handleChapterChange",value:function(e){var t=e.camera,n=e.transparencyMode,i=e.customData,o=e.properties,a=i.postprocess||[],r=t.action,c=t.location,s=t.rotationCenter;this.store.dispatch(new Z.l(c,"flyTo"===r,void 0,s)),this.isAnimated=this.animationService.isChapterAnimated(e);var l=this.store.selectSnapshot(T.a.getShowRootNodes),p=this.engineService.createViewGraph({},!1,l);this.store.dispatch(new q.E(p)),this.store.dispatch(new q.O(n)),this.store.dispatch(new q.K(a)),this.store.dispatch(new q.L(o))}},{key:"handleSelectTool",value:function(e){switch(this.store.dispatch(new q.w(e)),e){case ne.a.Paint:case ne.a.Eyedropper:this.store.dispatch(new U.h(M.a.Paint));break;case ne.a.Label:this.store.dispatch(new U.h(M.a.Label));break;case ne.a.Position:this.store.dispatch(new U.h(M.a.Position));break;case ne.a.Quiz:this.store.dispatch(new U.h(M.a.Quiz));break;default:this.store.dispatch(new U.h(M.a.Chapter))}}},{key:"handleShowColumnClick",value:function(e){this.showColumn(e)}},{key:"handleUndoClick",value:function(){this.undo()}},{key:"handleRedoClick",value:function(){this.redo()}},{key:"handleDelete",value:function(){var e=this.store.selectSnapshot(K.a.getSelectedLabel),t=this.store.selectSnapshot(ln.a.getCheckedNodeIds);e?this.store.dispatch(new ie.i(e)):t.length&&this.store.dispatch(new fn.a.UpdateNodesShown(!1,t))}},{key:"handleSelectAll",value:function(){this.store.dispatch(new fn.a.UpdateNodesChecked(!0))}},{key:"loadStory",value:function(){var e=this.store.selectSnapshot(D.a.getIncomingStoryInfo),t=e.id,n=e.type,i=this.store.selectSnapshot(oe.a.getUserLanguage);this.store.dispatch(new $.e(t,n,i))}},{key:"handleNodeClick",value:function(e,t){var n=this.store.selectSnapshot(V.a.getActiveTool);if(e||t.srcEvent.shiftKey)if(t.srcEvent.shiftKey){var i=this.store.selectSnapshot(ln.a.getNodes);this.store.dispatch(new fn.a.UpdateNodesChecked(!i[e.id].checked,[e.id])),this.store.dispatch(new fn.a.UpdateNodeSelected(e.id))}else{var o=!this.store.selectSnapshot(ln.a.getNodes)[e.id].checked,a=this.store.selectSnapshot(ln.a.getNodePaint)(e.id),r=gi.a.toEngine(a);switch(n){case ne.a.Hide:this.store.dispatch(new fn.a.UpdateNodesShown(!1,[e.id]));break;case ne.a.Select:case ne.a.Position:this.store.dispatch(new fn.a.UpdateNodesChecked(!1)),o&&(this.store.dispatch(new fn.a.UpdateNodesChecked(!0,[e.id])),this.store.dispatch(new fn.a.UpdateNodeSelected(e.id))),this.store.dispatch(new q.g(e)),bi.a.isRealRecipe(r)?this.store.dispatch(new fi.h(a)):this.store.dispatch(new fi.d)}}else this.store.dispatch(new fn.a.UpdateNodesChecked(!1))}},{key:"showColumn",value:function(e){var t=!0;switch(e){case"left":t=!this.store.selectSnapshot(T.a.getShowLeftColumn);break;case"right":t=!this.store.selectSnapshot(T.a.getShowRightColumn);break;case"header":t=!this.store.selectSnapshot(T.a.getShowHeader);break;case"footer":t=!this.store.selectSnapshot(T.a.getShowFooter)}this.store.dispatch(new U.i(e,t))}},{key:"toggleTimelineEditor",value:function(){var e=!this.store.selectSnapshot(T.a.getShowTimelineEditor);this.store.dispatch(new U.l(e))}},{key:"setTimelineScale",value:function(e){this.store.dispatch(new Kn.SetScale(e))}},{key:"formatTimelineScale",value:function(e){return 100*e+"%"}},{key:"handleSaveBookmark",value:function(){if(this.atBookmarkLimit)this.upgrade();else{var e=this.store.selectSnapshot(te.a.getSelectedBookmark);switch(this.getBookmarkSaveType(e)){case"save":this.saveBookmark(e).pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(){}));break;case"saveAs":this.saveBookmarkAs()}}}},{key:"saveModule",value:function(){this.openSaveModuleDialog(this.id)}},{key:"saveBookmarkAs",value:function(){var e=this;this.bookmarkActionsService.checkBookmarkLimit().pipe(Object(E.b)((function(t){if(t.limit_reached)return e.userAccessService.openBookmarkSaveLimit();var n=e.store.selectSnapshot(D.a.getStory).displayName;return e.saveNewBookmarkDialog("Save As",n)})),Object(N.a)(this.ngUnsubscribe)).subscribe((function(){}))}},{key:"publishBookmark",value:function(){var e=this;if(!this.atBookmarkLimit){var t=this.store.selectSnapshot(te.a.getSelectedBookmark),n=this.getBookmarkSaveType(t);if("save"===n&&t)this.isStoryDirty?this.confirmSaveDialog().pipe(Object(E.a)((function(n){return n?e.saveBookmark(t,!0):Object(k.a)(t)})),Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){e.openPublishDialog(t)})):this.openPublishDialog(t);else if("saveAs"===n){var i=this.store.selectSnapshot(D.a.getStory).displayName;this.saveNewBookmarkDialog("Save As",i,"You must save your changes to publish your model.").pipe(Object(N.a)(this.ngUnsubscribe)).subscribe((function(t){t&&e.openPublishDialog(t)}))}}}},{key:"isBookmarkEditable",value:function(e){if(e){var t=this.store.selectSnapshot(oe.a.getUserRole),n=ni.e(t,e);return e.type===sn.a.Bookmark&&n}return!1}},{key:"getBookmarkSaveType",value:function(e){return e&&this.isBookmarkEditable(e)?"save":"saveAs"}},{key:"handleSaveBookmarkSuccess",value:function(e){var t=e.bookmark,n=e.story,i=t.id,o=t.title,a=t.type;if(this.store.dispatch(new ee.D(t)),this.location.replaceState("edit","?id="+i),this.snackBar.open(o+" saved to your library."),n){var r=this.store.selectSnapshot(X.a.getSelectedChapterIndex);this.store.dispatch(new $.a(i,n,a,r))}}},{key:"handleSaveModuleSuccess",value:function(e){var t=this;this.id=this.sanitizeRouteId(e.id);var n=this.store.selectSnapshot(X.a.getSelectedChapterIndex);if(e.statesDuplicated){this.reloadCount=0,this.showReloadBlocker=!0;var i=setInterval((function(){t.reloadCount++,t.changeDetectorRef.markForCheck()}),1e3);setTimeout((function(){clearInterval(i),t.showReloadBlocker=!1,t.changeDetectorRef.markForCheck(),window.location.reload()}),9e4)}else this.buildStory(e.id,e.story,n)}},{key:"handleSaveBookmarkFailure",value:function(e){this.snackBar.open('Unable to save "'.concat(e.bookmarkEntry.title,'". Please try again.'))}},{key:"openChapterContentDialog",value:function(){this.dialog.open(cn,{width:"90vw",maxWidth:"1280px",height:"90vh",data:{chapterId:this.store.selectSnapshot(X.a.getSelectedChapterId)}})}},{key:"buildStory",value:function(e,t,n){this.store.dispatch(new $.a(e,t,sn.a.Module,n))}},{key:"preview",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0;if(this.bookmarkActionsService.isPremiumRestrictedAction(Ri.a.Publish))this.userAccessService.openPublishPaywall();else{Object(ce.isNil)(i)||(n=!0);var o=this.store.selectSnapshot(X.a.getStoryChapters),a=Yn.a.makeChapterIdMap(o,!1),r=this.bookmarkService.createBookmarkStory(a),c=this.store.selectSnapshot(te.a.getSelectedBookmark);this.storageService.setDatabaseItem(On.a.PreviewStory,r.story).then((function(){t.storageService.setDatabaseItem(On.a.PreviewBookmark,c)})).then((function(){switch(e){case"modal":t.dialog.open(Ni,{width:"95vw",height:"95vh",maxWidth:"95w",maxHeight:"95vh",data:{quizLocked:n,questionNumber:i}}).afterClosed().pipe(Object(N.a)(t.ngUnsubscribe)).subscribe((function(e){"publish"===e&&t.publishBookmark()}));break;case"tab":window.open("/view?id=preview")}}))}}},{key:"undo",value:function(){this.store.dispatch(new gn.a.Undo(this.store.selectSnapshot(X.a.getSelectedChapterId)))}},{key:"redo",value:function(){this.store.dispatch(new gn.a.Redo(this.store.selectSnapshot(X.a.getSelectedChapterId)))}},{key:"upgrade",value:function(){this.dialogService.openUpgradeDialog()}},{key:"openInSceneEditor",value:function(){window.open("https://scene-editor.biodigital.com/apps/editor/?m=".concat(this.id,".json"))}},{key:"openInViewer",value:function(){window.open("https://human-qa.biodigital.com/viewer/?id=".concat(this.id,"&ui-label-list=true"))}},{key:"sanitizeRouteId",value:function(e){return e=e.replace(/\.json$/,""),this.location.replaceState("edit","?id="+e),e}},{key:"nextChapter",value:function(){this.store.selectSnapshot(X.a.getAllChaptersModelsReady)&&this.store.dispatch(new J.g)}},{key:"previousChapter",value:function(){this.store.selectSnapshot(X.a.getAllChaptersModelsReady)&&this.store.dispatch(new J.h)}},{key:"capturePosition",value:function(){var e=this.store.selectSnapshot(X.a.getSelectedChapterId),t=this.store.selectSnapshot(X.a.getSelectedChapterBackground);this.store.dispatch(new ii.b(e,t,Cn.a.JPEG,92,kn.a.medium,"square",!1,!1));var n=this.cameraService.getCamera();this.store.dispatch(new J.i(e,n))}},{key:"prepareThumbnails",value:function(e){var t=this;this.allChaptersReady$.pipe(Object(N.a)(this.ngUnsubscribe),Object(R.a)((function(e){return e})),Object(j.a)((function(){return t.store.selectSnapshot(D.a.getStory)})),Object(F.a)(1)).subscribe((function(n){t.imageService.generateFreshChapterImages(n.chapters,e,dn.a.application===fe.a.Studio&&t.type===sn.a.Module).pipe(Object(N.a)(t.ngUnsubscribe)).subscribe((function(e){var n=t.store.selectSnapshot(oi.a.getRegisteredThumbnails);e.forEach((function(e){n.set(e.chapterId,e)})),t.store.dispatch(new ii.a(n))}))}))}},{key:"exportWrittenContent",value:function(){var e=this.storyService.exportWrittenContent(this.store.selectSnapshot(D.a.getStory),this.store.selectSnapshot(X.a.getStoryChapters),this.store.selectSnapshot(K.a.getLabels)),t=(this.store.selectSnapshot(D.a.getStory).displayName||"story")+".md",n=new Blob([e],{type:"text/plain;charset=utf-8"});Object(yn.saveAs)(n,t)}},{key:"exportQuizKey",value:function(){var e=this.storyService.exportQuizKey(this.store.selectSnapshot(ti.b.getAllQuestions)),t=(this.store.selectSnapshot(D.a.getStory).displayName||"story")+".md",n=new Blob([e],{type:"text/plain;charset=utf-8"});Object(yn.saveAs)(n,t)}},{key:"mergeModule",value:function(){var e=this,t=null,n=Object(k.a)(!0);this.isStoryDirty&&(n=this.confirmModuleMergeSaveDialog().pipe(Object(N.a)(this.ngUnsubscribe),Object(R.a)((function(e){return e})),Object(E.b)((function(){return e.openSaveModuleDialog(e.id).afterClosed()})),Object(R.a)((function(e){return e})))),n.pipe(Object(N.a)(this.ngUnsubscribe),Object(E.b)((function(){return e.openMergeModuleDialog().afterClosed()})),Object(R.a)((function(e){return null!=e})),Object(B.a)((function(e){t=e.id})),Object(E.b)((function(){return e.modulesService.mergeModule(e.id,t)})),Object(E.b)((function(n){return n.success?Object(k.a)(n):e.resolveMergeConflict(e.id,t)}))).subscribe((function(n){e.snackBar.open("".concat(e.id," was successfully merged with ").concat(t)),e.store.dispatch(new $.j(n.merged))}))}},{key:"resolveMergeConflict",value:function(e,t){var n=this;return this.openMergeConflictDialog(e,t).afterClosed().pipe(Object(R.a)((function(e){return null!=e})),Object(E.b)((function(i){return n.modulesService.mergeModule(e,t,i)})),Object(R.a)((function(e){return e.success})))}},{key:"openMergeModuleDialog",value:function(){return this.dialog.open(Si,{id:Zn.a.MergeModuleDialog,maxWidth:"90vw",width:"90vw",height:"90vh"})}},{key:"openMergeConflictDialog",value:function(e,t){return this.dialog.open(_i,{id:Zn.a.MergeConflictDialog,data:{loft:e,bridge:t}})}},{key:"confirmModuleMergeSaveDialog",value:function(){return this.dialogService.openConfirmDialog({data:{titleText:"Unsaved Changes",bodyText:"You must save before merging files. Continue to save changes.",confirmText:"Continue",cancelText:"Cancel",confirmColor:"warn"}}).afterClosed()}},{key:"confirmSaveDialog",value:function(e){return this.dialogService.openConfirmDialog({data:{titleText:"Save Changes",bodyText:"Would you like to save your changes to your model?",confirmText:"Save",cancelText:"Don't Save",miscText:e?"Cancel":"",confirmColor:"warn"}}).afterClosed()}},{key:"saveBookmark",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];n&&this.snackBar.open('Saving "'.concat(e.title,'"...'));var i=this.isBookmarkEditable(e);return this.store.dispatch(new ee.z({isOwner:i,id:e.id,title:e.title,viewMode:e.viewMode},!0)).pipe(Object(E.a)((function(){return t.actions.pipe(Object(y.l)(ee.B,ee.A),Object(Q.a)())})),Object(j.a)((function(n){return n instanceof ee.B?t.store.selectSnapshot(te.a.getSelectedBookmark):e})))}},{key:"saveNewBookmarkDialog",value:function(e,t,n){this.dialog.closeAll();var i=this.store.selectSnapshot(te.a.getSelectedBookmarkViewMode);return this.dialog.open(wn.a,{id:Zn.a.SaveBookmarkDialog,data:{mode:wn.b.SaveStory,title:e,bookmarkTitle:t,viewMode:i,message:n}}).afterClosed()}},{key:"openPublishDialog",value:function(e){this.bookmarkActionsService.publish(e)}},{key:"openSaveModuleDialog",value:function(e,t){this.dialog.closeAll();var n=Object.assign(Object.assign({id:Zn.a.SaveModuleDialog},{width:"480px",data:{id:e}}),t);return this.dialog.open(Xn,n)}},{key:"openBookmarkAccessDialog",value:function(){var e=this.store.selectSnapshot(te.a.getSelectedBookmark);if(e){var t={id:Zn.a.BookmarkAccessDialog,width:"480px",data:{model:e}};return this.dialog.closeAll(),this.dialog.open(wn.a,t)}}}]),e}()).\u0275fac=function(e){return new(e||mb)(ve.Pb(y.b),ve.Pb(g.a),ve.Pb(g.e),ve.Pb(ye.a),ve.Pb(Fi.a),ve.Pb(Tn.a),ve.Pb(Ii.a),ve.Pb(zi.a),ve.Pb(Li.b),ve.Pb(re.b),ve.Pb(Bi.a),ve.Pb(On.d),ve.Pb(Qi.a),ve.Pb(f.k),ve.Pb(ke.b),ve.Pb(y.h),ve.Pb($i.a),ve.Pb(Ce.a),ve.Pb(qi.a),ve.Pb(Gi.a),ve.Pb(ke.b),ve.Pb(ve.i))},mb.\u0275cmp=ve.Jb({type:mb,selectors:[["app-edit"]],viewQuery:function(e,t){var n;1&e&&ve.Jc(Vh,!0),2&e&&ve.xc(n=ve.dc())&&(t.engineContainer=n.first)},decls:111,vars:105,consts:[[1,"edit","edit--dark","theme-dark",3,"ngClass"],["routerLink","/","class","edit__logo",4,"appFlagApplication"],["routerLink","/results/modules","class","edit__logo",4,"appFlagApplication"],[1,"edit__header-left"],[1,"edit__title",3,"title","click"],[1,"edit__title-text"],[1,"edit__title-icon"],["icon","pencil"],[3,"viewMode"],[1,"edit__header-bar"],[1,"edit__toolbar-group"],["app-button","","data-test","selectTool",1,"mr-1",3,"selected","click"],["iconPlacement","left",3,"icon","label"],["app-button","",1,"mr-1",3,"selected","click"],["app-button","","data-test","labelTool",1,"mr-1",3,"selected","click"],["app-button","","data-test","paintTool",1,"mr-1",3,"selected","click"],["app-button","","data-test","quizTool",1,"mr-1",3,"selected","click"],["app-button","","matTooltip","Undo",3,"disabled","click"],["icon","undo"],["app-button","","matTooltip","Redo",3,"disabled","click"],["icon","redo"],["class","edit__toolbar-group",4,"appFlagApplication"],[1,"edit__header-right"],["class","mr-2",4,"appFlagApplication"],[1,"mr-2"],[4,"appFlagApplication"],[1,"edit__scene-left"],[1,"edit__scene"],["engineContainer",""],[1,"edit__camera-bar"],[1,"edit__scene-right",3,"ngSwitch"],[4,"ngSwitchCase"],[1,"edit__footer-left"],[4,"ngIf"],[1,"edit__footer-bar"],[1,"edit__breadcrumb",3,"ngClass"],["class","edit__animation pointer-events-none",4,"ngIf"],["class","edit__timeline-options",4,"appFlagApplication"],[1,"edit__footer-right"],["app-button","","buttonType","flat","data-test","previewTrigger",3,"disabled","click",4,"ngIf"],["render","block","class","flex-grow ml-2",4,"appFlagExternal"],["class","w-100 flex-grow ml-2","render","block",4,"appFlagInternal"],[1,"edit__timeline-bar"],["class","edit__timeline",4,"ngIf"],["class","edit__timeline-map",4,"ngIf"],["fileMenuBookmarks","matMenu"],["mat-menu-item","","data-test","publishBookmark",3,"disabled","click",4,"appFlagExternal"],["mat-menu-item","","data-test","upgradeSubscriptionButton",3,"click",4,"ngIf"],["mat-menu-item","","data-test","saveBookmark",3,"disabled","click"],["mat-menu-item","","data-test","saveBookmarkAs",3,"disabled","click"],["fileMenuModules","matMenu"],["mat-menu-item","",3,"click"],["mat-menu-item","",3,"click",4,"ngIf"],["previewMenu","matMenu"],[3,"count",4,"ngIf"],["routerLink","/",1,"edit__logo"],["routerLink","/results/modules",1,"edit__logo"],["app-button","",3,"matMenuTriggerFor","matTooltip"],["icon","angle-down"],["canvasSize","matMenu"],["mat-menu-item","",3,"click",4,"ngFor","ngForOf"],[1,"flex","justify-between"],["class","pl-2",4,"ngIf"],[1,"pl-2"],[1,"edit__animation","pointer-events-none"],[1,"pointer-events-auto",2,"width","400px"],[1,"edit__timeline-options"],["app-button","","matTooltip","Zoom options",3,"matMenuTriggerFor",4,"ngIf"],["timelineScale","matMenu"],["app-button","",3,"matTooltip","click"],["icon","expand-alt",4,"ngIf"],["icon","compress-alt",4,"ngIf"],["app-button","","matTooltip","Zoom options",3,"matMenuTriggerFor"],["icon","expand-alt"],["icon","compress-alt"],["app-button","","buttonType","flat","data-test","previewTrigger",3,"disabled","click"],["app-button","","buttonType","flat","data-test","previewMenu",2,"flex","0 0 40px",3,"matMenuTriggerFor","disabled"],["icon","caret-up"],["render","block",1,"flex-grow","ml-2"],["app-button","","data-test","saveBookmark","buttonType","primary",2,"flex","1 1 100%",3,"disabled","click"],["app-button","","buttonType","primary","data-test","saveBookmarkMenu",2,"flex","0 0 40px",3,"matMenuTriggerFor","disabled"],["render","inline","size","small","class","mr-1",4,"ngIf"],["render","inline","size","small",1,"mr-1"],["render","block",1,"w-100","flex-grow","ml-2"],["app-button","","data-test","saveModuleTrigger","buttonType","primary",1,"flex-grow",3,"disabled","click"],["app-button","","buttonType","primary",2,"flex","0 0 40px",3,"matMenuTriggerFor","disabled"],[1,"edit__timeline"],[1,"edit__timeline-map"],["mat-menu-item","","data-test","publishBookmark",3,"disabled","click"],["mat-menu-item","","data-test","upgradeSubscriptionButton",3,"click"],[3,"count"]],template:function(e,t){var n,i;(1&e&&(ve.Vb(0,"div",0),ve.hc(1,"async"),ve.hc(2,"async"),ve.hc(3,"async"),ve.hc(4,"async"),ve.hc(5,"async"),ve.Nc(6,Dh,1,0,"a",1),ve.Nc(7,Eh,1,0,"a",2),ve.Vb(8,"div",3),ve.Vb(9,"div",4),ve.cc("click",(function(){return t.handleChapterTitleClick()})),ve.hc(10,"textNormalize"),ve.hc(11,"async"),ve.Vb(12,"span",5),ve.Pc(13),ve.hc(14,"textNormalize"),ve.hc(15,"async"),ve.Ub(),ve.Vb(16,"div",6),ve.Qb(17,"app-icon",7),ve.Ub(),ve.Ub(),ve.Qb(18,"app-edit-bookmark-view-mode",8),ve.hc(19,"async"),ve.Ub(),ve.Vb(20,"div",9),ve.Vb(21,"div",10),ve.Vb(22,"button",11),ve.cc("click",(function(){return t.handleSelectTool(t.toolEnum.Select)})),ve.hc(23,"async"),ve.Qb(24,"app-button-icon",12),ve.Ub(),ve.Vb(25,"button",13),ve.cc("click",(function(){return t.handleSelectTool(t.toolEnum.Hide)})),ve.hc(26,"async"),ve.Qb(27,"app-button-icon",12),ve.Ub(),ve.Vb(28,"button",14),ve.cc("click",(function(){return t.handleSelectTool(t.toolEnum.Label)})),ve.hc(29,"async"),ve.Qb(30,"app-button-icon",12),ve.Ub(),ve.Vb(31,"button",15),ve.cc("click",(function(){return t.handleSelectTool(t.toolEnum.Paint)})),ve.hc(32,"async"),ve.Qb(33,"app-button-icon",12),ve.Ub(),ve.Vb(34,"button",16),ve.cc("click",(function(){return t.handleSelectTool(t.toolEnum.Quiz)})),ve.hc(35,"async"),ve.Qb(36,"app-button-icon",12),ve.Ub(),ve.Ub(),ve.Vb(37,"div",10),ve.Vb(38,"button",17),ve.cc("click",(function(){return t.handleUndoClick()})),ve.hc(39,"async"),ve.Qb(40,"app-icon",18),ve.Ub(),ve.Vb(41,"button",19),ve.cc("click",(function(){return t.handleRedoClick()})),ve.hc(42,"async"),ve.Qb(43,"app-icon",20),ve.Ub(),ve.Ub(),ve.Nc(44,Ih,10,9,"div",21),ve.Ub(),ve.Vb(45,"div",22),ve.Nc(46,zh,1,0,"app-memory-summary",23),ve.Qb(47,"app-help-menu",24),ve.Qb(48,"app-user-profile-pin",24),ve.Nc(49,Lh,1,0,"app-edit-exit",25),ve.Ub(),ve.Vb(50,"div",26),ve.Qb(51,"app-navigation-context"),ve.Ub(),ve.Vb(52,"div",27,28),ve.Qb(54,"app-engine-camera-bar",29),ve.Ub(),ve.Vb(55,"div",30),ve.hc(56,"async"),ve.Nc(57,Bh,1,0,"app-edit-document-context",31),ve.Nc(58,Qh,1,0,"app-edit-label-context",31),ve.Nc(59,$h,1,0,"app-edit-paint-context",31),ve.Nc(60,qh,1,0,"app-edit-quiz-context",31),ve.Ub(),ve.Vb(61,"div",32),ve.Nc(62,Gh,1,0,"app-edit-chapter-pagination",33),ve.hc(63,"async"),ve.Ub(),ve.Vb(64,"div",34),ve.Vb(65,"div",35),ve.hc(66,"async"),ve.Qb(67,"app-engine-breadcrumb"),ve.Ub(),ve.Nc(68,Hh,2,0,"div",36),ve.Nc(69,Zh,12,13,"div",37),ve.Ub(),ve.Vb(70,"div",38),ve.Nc(71,Yh,7,7,"app-button-group",33),ve.hc(72,"async"),ve.Nc(73,eb,3,3,"button",39),ve.hc(74,"async"),ve.Nc(75,ob,8,9,"app-button-group",40),ve.Nc(76,ab,7,7,"app-button-group",41),ve.Ub(),ve.Vb(77,"div",42),ve.Nc(78,rb,1,0,"app-edit-timeline",43),ve.hc(79,"async"),ve.Nc(80,cb,1,0,"app-edit-timeline-maps",44),ve.hc(81,"async"),ve.Ub(),ve.Ub(),ve.Vb(82,"mat-menu",null,45),ve.Nc(84,sb,4,0,"ng-container",33),ve.hc(85,"async"),ve.Nc(86,lb,3,3,"button",46),ve.Nc(87,pb,2,0,"button",47),ve.Qb(88,"mat-divider"),ve.Vb(89,"button",48),ve.cc("click",(function(){return t.handleSaveBookmark()})),ve.Pc(90," Save "),ve.Ub(),ve.Vb(91,"button",49),ve.cc("click",(function(){return t.saveBookmarkAs()})),ve.Pc(92," Save as ... "),ve.Ub(),ve.Ub(),ve.Vb(93,"mat-menu",null,50),ve.Vb(95,"button",51),ve.cc("click",(function(){return t.openInSceneEditor()})),ve.Pc(96,"Open in Scene Editor..."),ve.Ub(),ve.Vb(97,"button",51),ve.cc("click",(function(){return t.openInViewer()})),ve.Pc(98,"Open in QA Viewer..."),ve.Ub(),ve.Qb(99,"mat-divider"),ve.Vb(100,"button",51),ve.cc("click",(function(){return t.exportWrittenContent()})),ve.Pc(101,"Export Text"),ve.Ub(),ve.Nc(102,ub,2,0,"button",52),ve.hc(103,"async"),ve.Vb(104,"button",51),ve.cc("click",(function(){return t.mergeModule()})),ve.Pc(105,"Merge Module"),ve.Ub(),ve.Ub(),ve.Vb(106,"mat-menu",null,53),ve.Vb(108,"button",51),ve.cc("click",(function(){return t.preview("modal",!0)})),ve.Pc(109,"Preview Quiz"),ve.Ub(),ve.Ub(),ve.Nc(110,db,1,1,"app-edit-reload-countdown",54)),2&e)&&(ve.mc("ngClass",ve.tc(97,Ob,!ve.ic(1,45,t.showLeftColumn$),!ve.ic(2,47,t.showRightColumn$),!ve.ic(3,49,t.showHeader$),!ve.ic(4,51,t.showFooter$),ve.ic(5,53,t.showTimelineEditor$))),ve.Db(6),ve.mc("appFlagApplication",t.environmentApplication.Studio),ve.Db(1),ve.mc("appFlagApplication",t.environmentApplication.Loft),ve.Db(2),ve.mc("title",ve.ic(10,55,null==(n=ve.ic(11,57,t.selectedBookmark$))?null:n.title)),ve.Db(4),ve.Qc(ve.ic(14,59,null==(i=ve.ic(15,61,t.selectedBookmark$))?null:i.title)),ve.Db(5),ve.mc("viewMode",ve.ic(19,63,t.selectedBookmarkViewMode$)),ve.Db(4),ve.mc("selected",ve.ic(23,65,t.activeTool$)==t.toolEnum.Select),ve.Db(2),ve.mc("icon",t.toolIcons[t.toolEnum.Select])("label",t.toolEnum.Select),ve.Db(1),ve.mc("selected",ve.ic(26,67,t.activeTool$)==t.toolEnum.Hide),ve.Db(2),ve.mc("icon",t.toolIcons[t.toolEnum.Hide])("label",t.toolEnum.Hide),ve.Db(1),ve.mc("selected",ve.ic(29,69,t.activeTool$)==t.toolEnum.Label),ve.Db(2),ve.mc("icon",t.toolIcons[t.toolEnum.Label])("label",t.toolEnum.Label),ve.Db(1),ve.mc("selected",ve.ic(32,71,t.activeTool$)==t.toolEnum.Paint),ve.Db(2),ve.mc("icon",t.toolIcons[t.toolEnum.Paint])("label",t.toolEnum.Paint),ve.Db(1),ve.mc("selected",ve.ic(35,73,t.activeTool$)==t.toolEnum.Quiz),ve.Db(2),ve.mc("icon",t.toolIcons[t.toolEnum.Quiz])("label",t.toolEnum.Quiz),ve.Db(2),ve.mc("disabled",!ve.ic(39,75,t.canUndo$)),ve.Db(3),ve.mc("disabled",!ve.ic(42,77,t.canRedo$)),ve.Db(3),ve.mc("appFlagApplication",t.application.Loft),ve.Db(2),ve.mc("appFlagApplication",t.application.Loft),ve.Db(3),ve.mc("appFlagApplication",t.application.Studio),ve.Db(6),ve.mc("ngSwitch",ve.ic(56,79,t.view$)),ve.Db(2),ve.mc("ngSwitchCase",t.editViewEnum.Chapter),ve.Db(1),ve.mc("ngSwitchCase",t.editViewEnum.Label),ve.Db(1),ve.mc("ngSwitchCase",t.editViewEnum.Paint),ve.Db(1),ve.mc("ngSwitchCase",t.editViewEnum.Quiz),ve.Db(2),ve.mc("ngIf",ve.ic(63,81,t.allChaptersReady$)),ve.Db(3),ve.mc("ngClass",ve.pc(103,wb,!ve.ic(66,83,t.hoveredNode$))),ve.Db(3),ve.mc("ngIf",t.isAnimated),ve.Db(1),ve.mc("appFlagApplication",t.environmentApplication.Loft),ve.Db(2),ve.mc("ngIf",ve.ic(72,85,t.questionTotal$)>0),ve.Db(2),ve.mc("ngIf",0==ve.ic(74,87,t.questionTotal$)),ve.Db(5),ve.mc("ngIf",ve.ic(79,89,t.showTimelineEditor$)),ve.Db(2),ve.mc("ngIf",ve.ic(81,91,t.showTimelineEditor$)),ve.Db(4),ve.mc("ngIf",ve.ic(85,93,t.questionTotal$)>0),ve.Db(3),ve.mc("ngIf",t.atBookmarkLimit),ve.Db(2),ve.mc("disabled",t.atBookmarkLimit),ve.Db(2),ve.mc("disabled",t.atBookmarkLimit),ve.Db(11),ve.mc("ngIf",ve.ic(103,95,t.questionTotal$)>0),ve.Db(8),ve.mc("ngIf",t.showReloadBlocker))},directives:[f.m,wt.a,yt.a,Yi,Pe.a,eo.a,Ct.c,to.a,no.a,Ja,Xa.a,f.r,f.s,f.p,ar,rr,Se.a,Ki.a,_e.a,Ki.b,g.h,Ki.d,f.o,Ur,Vr,Pp,$p,wd,hm,ym,Em,ea,Vn.a,bh,wh,_h],pipes:[f.b,Mh.a],styles:['.text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}@-webkit-keyframes fadeIn{0%{opacity:0}to{opacity:1}}@keyframes fadeIn{0%{opacity:0}to{opacity:1}}.edit[_ngcontent-%COMP%]{min-width:1140px;min-height:632px;width:100vw;height:100vh;overflow-y:hidden;overflow-x:auto;position:relative;background:#131c2a;color:#fff;display:grid;grid-template-areas:"logo header-left header-bar header-right" "scene-left scene-left scene scene-right" "footer-left footer-left footer-bar footer-right" "edit-timeline edit-timeline edit-timeline edit-timeline";grid-template-columns:56px 264px auto 280px;grid-template-rows:56px 1fr 56px 0}.edit--hide-columns[_ngcontent-%COMP%]{grid-template-areas:"logo header-left header-bar header-right" "scene scene scene scene" "footer-left footer-left footer-bar footer-right" "edit-timeline edit-timeline edit-timeline edit-timeline"}.edit--hide-columns[_ngcontent-%COMP%]   .edit__scene-left[_ngcontent-%COMP%], .edit--hide-columns[_ngcontent-%COMP%]   .edit__scene-right[_ngcontent-%COMP%]{display:none}.edit--hide-left-column[_ngcontent-%COMP%]{grid-template-areas:"logo header-left header-bar header-right" "scene scene scene scene-right" "footer-left footer-left footer-bar footer-right" "edit-timeline edit-timeline edit-timeline edit-timeline"}.edit--hide-left-column[_ngcontent-%COMP%]   .edit__scene-left[_ngcontent-%COMP%]{display:none}.edit--hide-right-column[_ngcontent-%COMP%]{grid-template-areas:"logo header-left header-bar header-right" "scene-left scene-left scene scene" "footer-left footer-left footer-bar footer-right" "edit-timeline edit-timeline edit-timeline edit-timeline"}.edit--hide-right-column[_ngcontent-%COMP%]   .edit__scene-right[_ngcontent-%COMP%]{display:none}.edit--hide-header[_ngcontent-%COMP%]{grid-template-rows:0 1fr 56px 0}.edit--hide-header[_ngcontent-%COMP%]   .edit__header-bar[_ngcontent-%COMP%], .edit--hide-header[_ngcontent-%COMP%]   .edit__header-left[_ngcontent-%COMP%], .edit--hide-header[_ngcontent-%COMP%]   .edit__header-right[_ngcontent-%COMP%], .edit--hide-header[_ngcontent-%COMP%]   .edit__logo[_ngcontent-%COMP%]{display:none}.edit.edit--hide-header.edit--show-timeline-editor[_ngcontent-%COMP%]{grid-template-rows:0 1fr 56px 388px}.edit--hide-footer[_ngcontent-%COMP%]{grid-template-rows:56px 1fr 0 0}.edit--hide-footer[_ngcontent-%COMP%]   .edit__footer-bar[_ngcontent-%COMP%], .edit--hide-footer[_ngcontent-%COMP%]   .edit__footer-left[_ngcontent-%COMP%], .edit--hide-footer[_ngcontent-%COMP%]   .edit__footer-right[_ngcontent-%COMP%]{display:none}.edit.edit--hide-footer.edit--show-timeline-editor[_ngcontent-%COMP%]{grid-template-rows:56px 1fr 0 388px}.edit--show-timeline-editor[_ngcontent-%COMP%]{grid-template-rows:56px 1fr 56px 388px}.edit--show-timeline-editor[_ngcontent-%COMP%]   .edit__timeline-bar[_ngcontent-%COMP%]{display:flex}.edit.edit--hide-left-column.edit--hide-right-column[_ngcontent-%COMP%]{grid-template-areas:"logo header-left header-bar header-right" "scene scene scene scene" "footer-left footer-left footer-bar footer-right" "edit-timeline edit-timeline edit-timeline edit-timeline"}.edit.edit--hide-left-column.edit--hide-right-column[_ngcontent-%COMP%]   .edit__scene-left[_ngcontent-%COMP%], .edit.edit--hide-left-column.edit--hide-right-column[_ngcontent-%COMP%]   .edit__scene-right[_ngcontent-%COMP%]{display:none}.edit.edit--hide-header.edit--hide-footer[_ngcontent-%COMP%]{grid-template-rows:0 1fr 0 0}.edit.edit--hide-header.edit--hide-footer[_ngcontent-%COMP%]   .edit__footer-bar[_ngcontent-%COMP%], .edit.edit--hide-header.edit--hide-footer[_ngcontent-%COMP%]   .edit__footer-left[_ngcontent-%COMP%], .edit.edit--hide-header.edit--hide-footer[_ngcontent-%COMP%]   .edit__footer-right[_ngcontent-%COMP%], .edit.edit--hide-header.edit--hide-footer[_ngcontent-%COMP%]   .edit__header-bar[_ngcontent-%COMP%], .edit.edit--hide-header.edit--hide-footer[_ngcontent-%COMP%]   .edit__header-left[_ngcontent-%COMP%], .edit.edit--hide-header.edit--hide-footer[_ngcontent-%COMP%]   .edit__header-right[_ngcontent-%COMP%], .edit.edit--hide-header.edit--hide-footer[_ngcontent-%COMP%]   .edit__logo[_ngcontent-%COMP%]{display:none}.edit.edit--hide-header.edit--hide-footer.edit--show-timeline-editor[_ngcontent-%COMP%]{grid-template-rows:0 1fr 0 388px}.edit__logo[_ngcontent-%COMP%]{background:#131c2a url(/assets/images/logo-white.svg) 50% no-repeat;background-size:32px;border-right:1px solid #1c2a3f;border-bottom:1px solid #283853;grid-area:logo;width:56px;height:56px;transition:background-color .25s}.edit__logo[_ngcontent-%COMP%]:hover{background-color:#de3535}.edit__title[_ngcontent-%COMP%]{align-items:center;cursor:pointer;color:#d7e0ea;height:100%;padding-left:12px;letter-spacing:1px;font-weight:300;width:320px;display:flex;justify-content:space-between;font-size:16px;letter-spacing:.4px;line-height:1.4em}.edit__title[_ngcontent-%COMP%]:hover{color:#fff}.edit__title[_ngcontent-%COMP%]:hover   .edit__title-icon[_ngcontent-%COMP%]{visibility:visible;color:#fff}.edit__title-text[_ngcontent-%COMP%]{text-overflow:ellipsis;overflow:hidden;white-space:nowrap;width:120px;padding-right:4px}.edit__title-icon[_ngcontent-%COMP%]{visibility:hidden;color:#d7e0ea;font-size:12px}.edit__camera-bar[_ngcontent-%COMP%]{position:absolute;right:4px;bottom:4px;z-index:10}.edit__header-left[_ngcontent-%COMP%]{align-items:center;justify-content:space-between;grid-area:header-left}.edit__header-bar[_ngcontent-%COMP%], .edit__header-left[_ngcontent-%COMP%]{background:#131c2a;border-bottom:1px solid #283853;display:flex}.edit__header-bar[_ngcontent-%COMP%]{grid-area:header-bar;justify-content:center;padding:4px 0}.edit__header-right[_ngcontent-%COMP%]{background:#131c2a;align-items:center;grid-area:header-right;border-bottom:1px solid #283853;display:flex;justify-content:flex-end;padding-right:12px}.edit__pagination[_ngcontent-%COMP%]{grid-area:pagination;display:flex;border-left:1px solid #1c2a3f;padding-left:8px}.edit__scene-left[_ngcontent-%COMP%]{background:#131c2a;grid-area:scene-left;min-height:0;overflow-y:hidden}.edit__scene[_ngcontent-%COMP%]{box-shadow:0 0 0 4px #fff;margin:4px;background:#f9fafd;grid-area:scene;position:relative}.edit__scene-right[_ngcontent-%COMP%]{background:#131c2a;grid-area:scene-right;min-height:0;overflow-y:auto}.edit__footer-left[_ngcontent-%COMP%]{background-color:#131c2a;grid-area:footer-left;z-index:20}.edit__footer-right[_ngcontent-%COMP%]{padding:0 8px;justify-content:space-between;grid-area:footer-right}.edit__footer-bar[_ngcontent-%COMP%], .edit__footer-right[_ngcontent-%COMP%]{background-color:#131c2a;display:flex;align-items:center;z-index:20}.edit__footer-bar[_ngcontent-%COMP%]{border-top:1px solid #283853;grid-area:footer-bar;position:relative;overflow-x:auto;white-space:nowrap}.edit__timeline-bar[_ngcontent-%COMP%]{background-color:#131c2a;border-top:1px solid #283853;grid-area:edit-timeline;display:none;z-index:20}.edit__timeline[_ngcontent-%COMP%]{display:flex;flex-grow:1}.edit__timeline-map[_ngcontent-%COMP%]{width:280px;flex-shrink:0;border-left:1px solid #283853}.edit__page-actions[_ngcontent-%COMP%]{display:flex;flex:1 1 33%;padding-right:12px;justify-content:flex-end}.edit__page-actions--hidden[_ngcontent-%COMP%]{display:none}.edit__breadcrumb[_ngcontent-%COMP%]{background:#131c2a;padding:8px 0 0;position:absolute;width:100%;height:100%;z-index:2}.edit__breadcrumb[_ngcontent-%COMP%]:after, .edit__breadcrumb[_ngcontent-%COMP%]:before{content:" ";background-color:#131c2a;bottom:0;box-shadow:0 0 16px 4px #131c2a;position:absolute;right:0;top:0;width:4px}.edit__breadcrumb--hide[_ngcontent-%COMP%]{display:none}.edit__progress[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;z-index:3}.edit__animation[_ngcontent-%COMP%]{display:flex;position:absolute;justify-content:center;width:100%;z-index:1}.edit__toolbar-group[_ngcontent-%COMP%]{display:flex;align-items:center;padding:0 8px}.edit__toolbar-group[_ngcontent-%COMP%]:not(:last-child){border-right:1px solid #283853}.edit__toolbar-group[_ngcontent-%COMP%]:first-child{margin-left:0;border-left:0}.edit__timeline-options[_ngcontent-%COMP%]{display:flex;position:absolute;justify-content:flex-end;width:100%;z-index:0}'],changeDetection:0}),Uh([Object(y.e)(x.a.getTheme),Th("design:type",_.a)],mb.prototype,"theme$",void 0),Uh([Object(y.e)(T.a.getView),Th("design:type",_.a)],mb.prototype,"view$",void 0),Uh([Object(y.e)(V.a.getActiveTool),Th("design:type",_.a)],mb.prototype,"activeTool$",void 0),Uh([Object(y.e)(T.a.getShowColumns),Th("design:type",_.a)],mb.prototype,"showColumns$",void 0),Uh([Object(y.e)(T.a.getShowLeftColumn),Th("design:type",_.a)],mb.prototype,"showLeftColumn$",void 0),Uh([Object(y.e)(T.a.getShowRightColumn),Th("design:type",_.a)],mb.prototype,"showRightColumn$",void 0),Uh([Object(y.e)(T.a.getShowHeader),Th("design:type",_.a)],mb.prototype,"showHeader$",void 0),Uh([Object(y.e)(T.a.getShowFooter),Th("design:type",_.a)],mb.prototype,"showFooter$",void 0),Uh([Object(y.e)(T.a.getShowTimelineEditor),Th("design:type",_.a)],mb.prototype,"showTimelineEditor$",void 0),Uh([Object(y.e)(T.a.getRecord),Th("design:type",_.a)],mb.prototype,"record$",void 0),Uh([Object(y.e)(T.a.getCanvasSize),Th("design:type",_.a)],mb.prototype,"canvasSize$",void 0),Uh([Object(y.e)(T.a.getCanvasSettings),Th("design:type",_.a)],mb.prototype,"canvasSettings$",void 0),Uh([Object(y.e)(vn.a.canUndo),Th("design:type",_.a)],mb.prototype,"canUndo$",void 0),Uh([Object(y.e)(vn.a.canRedo),Th("design:type",_.a)],mb.prototype,"canRedo$",void 0),Uh([Object(y.e)(V.a.getReady),Th("design:type",_.a)],mb.prototype,"engineReady$",void 0),Uh([Object(y.e)(V.a.getChapter),Th("design:type",_.a)],mb.prototype,"chapter$",void 0),Uh([Object(y.e)(ln.a.getNodes),Th("design:type",_.a)],mb.prototype,"nodes$",void 0),Uh([Object(y.e)(V.a.getHoveredNode),Th("design:type",_.a)],mb.prototype,"hoveredNode$",void 0),Uh([Object(y.e)(ln.a.getCheckedNodes),Th("design:type",_.a)],mb.prototype,"checkedNodes$",void 0),Uh([Object(y.e)(V.a.getViewGraph),Th("design:type",_.a)],mb.prototype,"viewGraph$",void 0),Uh([Object(y.e)(V.a.getAnimationPlaying),Th("design:type",_.a)],mb.prototype,"animationPlaying$",void 0),Uh([Object(y.e)(Pn.a.getStoryLoadProgress),Th("design:type",_.a)],mb.prototype,"loadProgress$",void 0),Uh([Object(y.e)(Y.a.getStoredCamera("__copy")),Th("design:type",_.a)],mb.prototype,"cameraCopy$",void 0),Uh([Object(y.e)(D.a.getStory),Th("design:type",_.a)],mb.prototype,"story$",void 0),Uh([Object(y.e)(D.a.getIncomingStoryInfo),Th("design:type",_.a)],mb.prototype,"incoming$",void 0),Uh([Object(y.e)(K.a.getLabels),Th("design:type",_.a)],mb.prototype,"labels$",void 0),Uh([Object(y.e)(K.a.getSelectedLabel),Th("design:type",_.a)],mb.prototype,"selectedLabel$",void 0),Uh([Object(y.e)(X.a.getChaptersLoaded),Th("design:type",_.a)],mb.prototype,"chaptersLoaded$",void 0),Uh([Object(y.e)(X.a.getAllChaptersModelsReady),Th("design:type",_.a)],mb.prototype,"allChaptersReady$",void 0),Uh([Object(y.e)(X.a.getSelectedChapterId),Th("design:type",_.a)],mb.prototype,"selectedChapterId$",void 0),Uh([Object(y.e)(te.a.getSelectedBookmark),Th("design:type",_.a)],mb.prototype,"selectedBookmark$",void 0),Uh([Object(y.e)(te.a.getSelectedBookmarkViewMode),Th("design:type",_.a)],mb.prototype,"selectedBookmarkViewMode$",void 0),Uh([Object(y.e)(te.a.getSaving),Th("design:type",_.a)],mb.prototype,"saving$",void 0),Uh([Object(y.e)(ti.b.getQuestionTotal),Th("design:type",_.a)],mb.prototype,"questionTotal$",void 0),Uh([Object(y.e)(oe.a.getUserProfile),Th("design:type",_.a)],mb.prototype,"userProfile$",void 0),Uh([Object(y.e)(hi.getScale),Th("design:type",_.a)],mb.prototype,"timelineScale$",void 0),mb),_b=o("uZ1g"),Mb=o("P+IX"),Ub=((hb=function(){function e(){l(this,e)}return u(e,[{key:"canDeactivate",value:function(e){return!!e.canDeactivate&&e.canDeactivate()}}]),e}()).\u0275fac=function(e){return new(e||hb)},hb.\u0275prov=ve.Lb({token:hb,factory:hb.\u0275fac,providedIn:"root"}),hb),Tb=o("mmXA"),Vb=o("WoAB"),Db=[{path:"",component:_b.a,canActivate:[Mb.a,(bb=function(){function e(t,n,i){l(this,e),this.store=t,this.router=n,this.snackbar=i}return u(e,[{key:"canActivate",value:function(e,t){var n=this;return this.store.select(oe.a.getUserRole).pipe(Object(R.a)((function(e){return!Object(ce.isNil)(e)})),Object(F.a)(1),Object(j.a)((function(e){return n.canEditBookmarks(e)})))}},{key:"canEditBookmarks",value:function(e){return!!ni.k(e,Vb.a.EditBookmarks)||this.bounceUser()}},{key:"bounceUser",value:function(){return this.snackbar.open("You do not have access to edit this bookmark."),this.router.navigate(["/results/bookmarks"]),!1}}]),e}(),bb.\u0275fac=function(e){return new(e||bb)(ve.Zb(y.h),ve.Zb(g.e),ve.Zb(ke.b))},bb.\u0275prov=ve.Lb({token:bb,factory:bb.\u0275fac,providedIn:"root"}),bb)],data:{siteHeaderType:Tb.a.Hide,fixedHeight:!0,title:"Studio"},children:[{path:"new",pathMatch:"full",component:Sb,canDeactivate:[Ub]},{component:Sb,path:"**",canDeactivate:[Ub]}]}],Eb=((fb=function e(){l(this,e)}).\u0275mod=ve.Nb({type:fb}),fb.\u0275inj=ve.Mb({factory:function(e){return new(e||fb)},imports:[[g.i.forChild(Db)],g.i]}),fb),jb=o("vvyD"),Nb=o("PCNd"),Rb=o("AIoM"),Ab=o("fP/T"),Fb=o("u9Xo"),Ib=o("+dkL"),zb=o("Tx//"),Lb=o("hQIT"),Bb=o("YsyH"),Qb=o("o0EK"),$b=o("Ow1N"),qb=((gb=function e(){l(this,e)}).\u0275mod=ve.Nb({type:gb}),gb.\u0275inj=ve.Mb({factory:function(e){return new(e||gb)},imports:[[f.c,ae.z,jb.a,dt.a.forChild()]]}),gb),Gb=o("+QY/"),Hb=o("oH02"),Wb=o("1y1q"),Kb=o("D8yp"),Jb=o("Rc+H"),Xb=o("3ros"),Zb=((vb=function e(){l(this,e)}).\u0275mod=ve.Nb({type:vb}),vb.\u0275inj=ve.Mb({factory:function(e){return new(e||vb)},imports:[[f.c,jb.a,Nb.a,ae.z,Xb.a]]}),vb),Yb=o("PXMH"),ef=o("Wqx0"),tf=((yb=function e(){l(this,e)}).\u0275mod=ve.Nb({type:yb}),yb.\u0275inj=ve.Mb({factory:function(e){return new(e||yb)},imports:[[f.c,jb.a,Nb.a,ae.z,Tt.b,Yb.a,ef.a]]}),yb),nf=o("+pSP"),of=o("EWj2"),af=((Pb=function e(){l(this,e)}).\u0275mod=ve.Nb({type:Pb}),Pb.\u0275inj=ve.Mb({factory:function(e){return new(e||Pb)},imports:[[f.c,ae.z,Yb.a,nf.a,Kb.a,vt.d,qb,of.a,jb.a]]}),Pb),rf=((kb=function e(){l(this,e)}).\u0275mod=ve.Nb({type:kb}),kb.\u0275inj=ve.Mb({factory:function(e){return new(e||kb)},imports:[[f.c,jb.a,Nb.a,ae.z,Xb.a]]}),kb),cf=((Cb=function e(){l(this,e)}).\u0275mod=ve.Nb({type:Cb}),Cb.\u0275inj=ve.Mb({factory:function(e){return new(e||Cb)},imports:[[f.c]]}),Cb),sf=((xb=function e(){l(this,e)}).\u0275mod=ve.Nb({type:xb}),xb.\u0275inj=ve.Mb({factory:function(e){return new(e||xb)},imports:[[y.d.forFeature([T.a,vi.a,hi]),tf,f.c,Tt.b,Fb.a,Eb,ae.z,ae.l,Rb.a,jb.a,Nb.a,Ab.a,Ib.a,zb.a,Lb.a,Qb.a,$b.a,Bb.a,cf,qb,dt.a.forChild(),Gb.a,Hb.a,Kb.a,Wb.c,Jb.a,Zb,rf,af],Eb]}),xb)}}])}();