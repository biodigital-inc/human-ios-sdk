(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{0:function(e,t,n){e.exports=n("dwNn")},1:function(e,t){},dwNn:function(e,t,n){"use strict";n.r(t);var i=n("fXoL"),s=function(e){return e.Loft="loft",e.Studio="studio",e.Viewer="viewer",e.All="",e}({}),o=function(e){return e.Bookmark="bookmark",e.Module="module",e.Internal="internal",e}({}),r=function(e){return e.Local="Local",e.QA="QA",e.Staging="Staging",e.Production="Production",e}({}),a=function(e){return e.Web="web",e.SDK="sdk",e}({});const c={production:!0,assetDomain:"assets-human.biodigital.com",supportEmail:"support@biodigital.com",googleAuthKey:"66261904577-061oin26uo7sor0vrqc8dnn105irq82n.apps.googleusercontent.com",googleAnalyticsId:"UA-1141985-29",linkedinId:"2641938",pendoId:"3a783681-e53b-4ebd-69c0-788bbae48f13",rollbarToken:"dd70f513aa0740668070fa3fd62b33a0",recaptchaKey:"6LdvZvcUAAAAAM0Z1St9WQXwvSYd__hMUY2WZ6um",application:s.Viewer,deploy:r.Production,platform:a.SDK,exportType:o.Bookmark,offline:!1,native:!0,minPasswordLength:8};var l=n("jhN1"),p=n("R1ws"),d=n("AcyG");class u{}let g=(()=>{class e{constructor(e,t,n){this.hostingURL=e,this.embedded=t,this.widgetConfig=n}}return e.type="[Widget] Setup Widget",e})(),h=(()=>{class e{}return e.type="[Widget] Reset",e})(),b=(()=>{class e{constructor(e){this.enabled=e}}return e.type="[Widget] Set Input Enabled",e})(),m=(()=>{class e{constructor(e){this.config=e}}return e.type="[Widget] Set API Config",e})(),f=(()=>{class e{constructor(e){this.productAccountId=e}}return e.type="[Widget] Get Widget Product Settings",e})(),y=(()=>{class e{constructor(e){this.widgetSettings=e}}return e.type="[Widget] Set Widget Product Settings",e})();var x=function(e){return e[e.User=0]="User",e[e.Developer=1]="Developer",e}({}),v=n("tk/3");let O=(()=>{class e{constructor(e){this.http=e}getWidgetSettings(e){return this.http.get("/ws/product/account/settings?product_acctid="+e)}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(v.b))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var w=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},C=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const S={userType:x.User,authenticating:!1,authenticated:!1,widgetUrlConfig:{id:"",type:""},widgetApiConfig:null,parentUrl:{full:"",domain:""},embedded:!1,engineVersion:"",engineAPIVersion:"",inputEnabled:!0,widgetSettings:void 0};let _=(()=>{let e=class{constructor(e){this.widgetConfigService=e}static getWidgetState(e){return e}static getUserType(e){return e.userType}static getWidgetAuthenticating(e){return e.authenticating}static getWidgetAuthenticated(e){return e.authenticated}static getInputEnabled(e){return e.inputEnabled}static getEmbedded(e){return e.embedded}static getBypassAnalytics(e){return e.widgetUrlConfig["bypass-analytics"]}static getParentURL(e){return e.parentUrl.full}static getWidgetUrlConfig(e){return e.widgetUrlConfig}static getWidgetApiUIConfig(e){return e.widgetApiConfig}static getWidgetSettings(e){return e.widgetSettings}setupWidget(e,{hostingURL:t,embedded:n,widgetConfig:i}){const s=t.match(/:\/\/(.[^/]+)/);e.patchState({userType:i.uaid?x.User:x.Developer,embedded:n,widgetUrlConfig:i,parentUrl:{full:t,domain:s&&s[1]?s[1]:t}})}getWidgetProductSettings(e,{productAccountId:t}){this.widgetConfigService.getWidgetSettings(t).subscribe(({settings:t})=>{e.dispatch(new y(t))})}setWidgetProductSettings(e,{widgetSettings:t}){e.patchState({widgetSettings:t})}resetWidget(e){e.setState(S)}setInputEnabled(e,t){e.patchState({inputEnabled:t.enabled})}setWidgetApiConfig(e,t){e.patchState({widgetApiConfig:t.config})}ngxsOnInit(e){e.patchState({engineVersion:Human.VERSION,engineAPIVersion:Human.API_VERSION})}};return e.\u0275fac=function(t){return new(t||e)(i.Zb(O))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac}),w([Object(d.a)(g),C("design:type",Function),C("design:paramtypes",[Object,g]),C("design:returntype",void 0)],e.prototype,"setupWidget",null),w([Object(d.a)(f),C("design:type",Function),C("design:paramtypes",[Object,f]),C("design:returntype",void 0)],e.prototype,"getWidgetProductSettings",null),w([Object(d.a)(y),C("design:type",Function),C("design:paramtypes",[Object,y]),C("design:returntype",void 0)],e.prototype,"setWidgetProductSettings",null),w([Object(d.a)(h),C("design:type",Function),C("design:paramtypes",[Object]),C("design:returntype",void 0)],e.prototype,"resetWidget",null),w([Object(d.a)(b),C("design:type",Function),C("design:paramtypes",[Object,b]),C("design:returntype",void 0)],e.prototype,"setInputEnabled",null),w([Object(d.a)(m),C("design:type",Function),C("design:paramtypes",[Object,m]),C("design:returntype",void 0)],e.prototype,"setWidgetApiConfig",null),w([Object(d.e)(),C("design:type",Function),C("design:paramtypes",[u]),C("design:returntype",void 0)],e,"getWidgetState",null),w([Object(d.e)(),C("design:type",Function),C("design:paramtypes",[u]),C("design:returntype",void 0)],e,"getUserType",null),w([Object(d.e)(),C("design:type",Function),C("design:paramtypes",[u]),C("design:returntype",void 0)],e,"getWidgetAuthenticating",null),w([Object(d.e)(),C("design:type",Function),C("design:paramtypes",[u]),C("design:returntype",void 0)],e,"getWidgetAuthenticated",null),w([Object(d.e)(),C("design:type",Function),C("design:paramtypes",[u]),C("design:returntype",void 0)],e,"getInputEnabled",null),w([Object(d.e)(),C("design:type",Function),C("design:paramtypes",[u]),C("design:returntype",void 0)],e,"getEmbedded",null),w([Object(d.e)(),C("design:type",Function),C("design:paramtypes",[u]),C("design:returntype",void 0)],e,"getBypassAnalytics",null),w([Object(d.e)(),C("design:type",Function),C("design:paramtypes",[u]),C("design:returntype",void 0)],e,"getParentURL",null),w([Object(d.e)(),C("design:type",Function),C("design:paramtypes",[u]),C("design:returntype",void 0)],e,"getWidgetUrlConfig",null),w([Object(d.e)(),C("design:type",Function),C("design:paramtypes",[u]),C("design:returntype",void 0)],e,"getWidgetApiUIConfig",null),w([Object(d.e)(),C("design:type",Function),C("design:paramtypes",[u]),C("design:returntype",Array)],e,"getWidgetSettings",null),e=w([Object(d.f)({name:"widget",defaults:S})],e),e})();var j,k=n("XNiG"),P=n("HDdC"),M=n("1G5W"),I=n("pLZG"),z=function(e){return e[e.Basics=0]="Basics",e[e.All=1]="All",e[e.Shortcuts=2]="Shortcuts",e}({});!function(e){class t{constructor(e){this.canHover=e}}t.type="[View] Set Can Hover",e.SetCanHover=t;class n{constructor(e){this.canTouch=e}}n.type="[View] Set Can Touch",e.SetCanTouch=n;class i{constructor(e){this.canFullscreen=e}}i.type="[View] Set Can Fullscreen",e.SetCanFullscreen=i;class s{constructor(e){this.ui=e}}s.type="[View] Set UI",e.SetUI=s;class o{constructor(e){this.ui=e}}o.type="[View] Set Initial UI",e.SetInitialUI=o;class r{constructor(e){this.enabled=e}}r.type="[View] Set Input Enabled",e.SetInputEnabled=r;class a{constructor(e){this.mode=e}}a.type="[View] Set Search Display Mode",e.SetSearchDisplayMode=a;class c{constructor(e){this.active=e}}c.type="[View] Toggle Presentation",e.TogglePresentation=c;class l{constructor(e){this.interactType=e}}l.type="[View] Set Interact Type",e.SetInteractType=l;class p{constructor(e){this.onDemand=e}}p.type="[View] Set On Demand",e.SetOnDemand=p;class d{constructor(e){this.layout=e}}d.type="[View] Set Layout",e.SetLayout=d;class u{constructor(e=z.Basics){this.tab=e}}u.type="[View] Toggle Help Tab",e.ToggleHelpTab=u;class g{constructor(e){this.inputMode=e}}g.type="[View] Set Input Mode",e.SetInputMode=g;class h{constructor(e){this.tutorial=e}}h.type="[View] Set Tutorial",e.SetTutorial=h;class b{constructor(e){this.intro=e}}b.type="[View] Start Tutorial",e.StartTutorial=b;class m{constructor(e){this.seen=e}}m.type="[View] Tutorial Seen",e.TutorialSeen=m;class f{constructor(){}}f.type="[View] Tutorial Next",e.TutorialNext=f;class y{constructor(){}}y.type="[View] Tutorial Previous",e.TutorialPrevious=y;class x{constructor(e){this.show=e}}x.type="[View] Toggle Node Info",e.ToggleNodeInfo=x;class v{constructor(e){this.lang=e}}v.type="[View] Set View Language",e.SetViewLanguage=v;class O{constructor(e){this.fallback=e}}O.type="[View] Set Node Info Config",e.SetNodeInfoConfig=O;class w{constructor(e){this.enabled=e}}w.type="[View] Set multi pick mode enabled",e.SetMultiPickModeEnabled=w;class C{constructor(e){this.labelsBreakpoint=e}}C.type="[View] Set Label Breakpoint",e.SetLabelBreakpoint=C;class S{constructor(e){this.usePrintImage=e}}S.type="[View] Set Use Print Image",e.SetUsePrintImage=S;class _{constructor(e){this.windows=e}}_.type="[View] Set Windows",e.SetWindows=_;class j{constructor(e){this.window=e}}j.type="[View] Open Window",e.OpenWindow=j;class k{constructor(e){this.window=e}}k.type="[View] Close Window",e.CloseWindow=k;class P{constructor(e,t){this.window=e,this.show=t}}P.type="[View] Toggle Window",e.ToggleWindow=P;class M{constructor(e){this.open=e}}M.type="[View] Toggle Menu",e.ToggleMenu=M;class I{constructor(e){this.enabled=e}}I.type="[View] Whiteboard Enabled",e.SetWhiteboardEnabled=I;class T{constructor(e){this.brushSize=e}}T.type="[View] Whiteboard Brush Size",e.SetWhiteboardBrushSize=T;class U{constructor(e){this.brushColor=e}}U.type="[View] Whiteboard Brush Color",e.SetWhiteboardBrushColor=U;class D{constructor(e){this.size=e}}D.type="[View] Whiteboard Text Size",e.SetWhiteboardTextSize=D;class L{constructor(e){this.eraserSize=e}}L.type="[View] Whiteboard Eraser Size",e.SetWhiteboardEraserSize=L;class E{constructor(e){this.mode=e}}E.type="[View] Whiteboard Annotate Mode",e.SetWhiteboardAnnotateMode=E;class F{constructor(e){this.hasPaint=e}}F.type="[View] Whiteboard Has Paint",e.SetWhiteboardHasPaint=F;class A{constructor(e){this.hasText=e}}A.type="[View] Whiteboard Has Text",e.SetWhiteboardHasText=A;class R{constructor(e,t){this.showSpinner=e,this.label=t}}R.type="[View] Show Scrim",e.ShowScrim=R;class V{constructor(){}}V.type="[View] Hide Scrim",e.HideScrim=V}(j||(j={}));var T=n("tyNb"),U=(n("mNvP"),n("m+po"),n("Wdmj")),D=n("LvDl");function L(e,t=!1){return(t?function(e){return e.filter(e=>Object.values(e).some(e=>!Object(D.isNil)(e.value)&&""!==e.value))}(e):e).reduce((e,t)=>Object.assign(Object.assign({},e),t),{})}class E{}var F=n("lJxs"),A=n("b36G");class R{}var V=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let N=(()=>{class e{constructor(){this.type=o.Bookmark,this.favorite=!1,this.unavailable=!1}}return function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);o>3&&r&&Object.defineProperty(t,n,r)}([Object(A.Type)(()=>R),V("design:type",Array)],e.prototype,"group_access",void 0),e})();var B=function(e){return e.All="",e.Quiz="mode-quiz",e.Content="mode-content",e}({});function H(e){const{id:t,type:n}=e;if("module"===n&&(e.id=function(e){return e.replace("Condition.content.","").replace(".json","").split(".").join("/")}(t)),e.tour=e.tags.includes("tour"),e.animated=e.tags.includes("animated"),e.quiz=e.tags.includes("quiz"),e.lowDefinition=e.tags.includes("low definition"),!e.viewMode){const t=Object.values(B).find(t=>e.tags.includes(t));e.viewMode=null!=t?t:B.All}return e}var Q=function(e){return e.IdAsc="+collection_id",e.IdDesc="-collection_id",e.NameAsc="+collection_name",e.NameDesc="-collection_name",e.UpdateDateAsc="+collection_updatedate",e.UpdateDateDesc="-collection_updatedate",e.CreateDateAsc="+collection_createdate",e.CreateDateDesc="-collection_createdate",e.CustomAsc="+custom_sort_order",e.CustomDesc="-custom_sort_order",e}({});function $(e){return"?"+Object.entries(e).filter(([e,t])=>!Object(D.isNil)(t)).map(([e,t])=>`${e}=${encodeURIComponent(t)}`).join("&")}const q="/ws/organization/collection";let W=(()=>{class e{constructor(e){this.http=e}createOrganization(e){return this.http.post("/ws/organization/create",e)}updateOrganization(e){return this.http.post("/ws/organization/update",e)}getCollections(e){e.sort_order||(e.sort_order=[Q.CustomAsc,Q.NameDesc]);const t=$(e);return this.http.get(`${q}${t}`).pipe(Object(F.a)(e=>Object(A.plainToClass)(E,e).map(e=>this.normalizeCollectionModel(e))))}getCollectionContent(e,t,n=""){const i=n.toLocaleLowerCase().split(" ");return this.getCollections({group_id:e,collection_id:t,include_content:1}).pipe(Object(F.a)(e=>e[0].collection_content.map(e=>Object(A.plainToClass)(N,e)).filter(e=>{let t=!0;return i.length&&e.title&&i.forEach(n=>{t=t&&e.title.toLocaleLowerCase().indexOf(n)>=0}),t=t&&!0!==e.unavailable,t})))}addCollection(e,t){return this.http.post(q,{group_id:e,collection_name:t})}removeCollection(e){return this.http.request("DELETE",q,{body:{group_id:e.group_id,collection_id:e.collection_id}})}renameCollection(e,t){return this.http.post(q,{group_id:e.group_id,collection_id:e.collection_id,collection_name:t})}reorderCollections(e,t){return this.http.post(q+"/sort-order",{group_id:e,collection_id_sort_list:t.map(e=>e.collection_id)})}updateCollectionContent(e,t,n){return this.http.post(q+"/content",{group_id:e,add_content:t,remove_content:n})}getOrganizationAttribute(e,t,n){return e.find(e=>e.type===t&&e.name===n)}getPublicProfile(e){return this.http.get("/ws/organization/public/profile",{params:Object.assign({},e)}).pipe(Object(F.a)(e=>e))}normalizeCollectionModel(e){return e.collection_content&&e.collection_content.forEach(e=>{H(e)}),e}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(v.b))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var K=function(e){return e.DiscoveredChapterNav="Discovered Chapter Nav",e}({});let G=(()=>{class e{constructor(e,t,n,i){this.config=e,this.router=t,this.route=n,this.organizationsService=i,this.appended=!1,this.initialized=!1,this.sessionEvents={},this.pageEvents={},this.queuedEvents=[],this.initRouteListener()}appendScript(){if(!this.config.enabled||this.appended)return;const e=`\n      (function(apiKey){\n        (function(p,e,n,d,o){var v,w,x,y,z;o=p[d]=p[d]||{};o._q=o._q||[];\n        v=['initialize','identify','updateOptions','pageLoad','track'];for(w=0,x=v.length;w<x;++w)(function(m){\n            o[m]=o[m]||function(){o._q[m===v[0]?'unshift':'push']([m].concat([].slice.call(arguments,0)));};})(v[w]);\n            y=e.createElement(n);y.async=!0;y.src='https://cdn.pendo.io/agent/static/'+apiKey+'/pendo.js';\n            z=e.getElementsByTagName(n)[0];z.parentNode.insertBefore(y,z);})(window,document,'script','pendo');\n      })('${this.config.pendoId}');\n    `,t=document.createElement("script");t.textContent=e,document.body.appendChild(t),this.appended=!0}initialize(e){if(!this.pendoEnabled())return;const t=Object.assign({},e);t.visitor.id&&this.setIds(t),pendo.initialize(t),this.initialized=!0,this.flushQueuedEvents()}identify(e){if(!this.pendoEnabled())return;const t=Object.assign({},e);this.setIds(t),pendo.identify(t)}createVisitorData(e){const t={},n=L(e.account_settings),i=Object(D.get)(e,"organizations[0].user_role.role_display_name",null);return e.hasOwnProperty("id")&&(t.id=e.id.toString()),e.hasOwnProperty("email")&&(t.email=e.email),e.hasOwnProperty("first_name")&&e.hasOwnProperty("last_name")&&(t.full_name=`${e.first_name} ${e.last_name}`),e.hasOwnProperty("registration_date")&&(t.registration_date=e.registration_date),e.hasOwnProperty("premium_account")&&(t.premium=e.premium_account),e.hasOwnProperty("user_is_developer")&&(t.developer=e.user_is_developer),e.hasOwnProperty("subscription")&&(t.subscriptionType=e.subscription?e.subscription.subscription_type:null),e.hasOwnProperty("is_third_party")&&(t.thirdParty=e.is_third_party),n.hasOwnProperty("account_purpose")&&(t.purpose=n.account_purpose?n.account_purpose.value:null),n.hasOwnProperty("account_role")&&(t.role=n.account_role?n.account_role.value:null),n.hasOwnProperty("account_field")&&(t.field=n.account_field?n.account_field.value:null),i&&(t.teamRole=i),t}updateVisitorData(e){this.pendoEnabled()&&pendo.updateOptions({visitor:this.createVisitorData(e)})}createAccountData(e){const t=Object(D.get)(e,"group_attributes",null);return{id:Object(D.get)(e,"id",null),name:Object(D.get)(e,"name",null),subscriptionType:Object(D.get)(e,"subscription.type",null),subscriptionEndDate:Object(D.get)(e,"subscription.paid_through_date",null),usersCount:Object(D.get)(e,"users_count",null),purpose:this.getGroupAttributeValue(t,"account_purpose"),field:this.getGroupAttributeValue(t,"account_field"),companyWebsite:this.getGroupAttributeValue(t,"account_company_website"),companySize:this.getGroupAttributeValue(t,"account_company_size")}}flushQueuedEvents(){this.queuedEvents.forEach(e=>{this.track(e.trackType,e.metadata)})}track(e,t){this.pendoEnabled()&&(this.initialized?pendo.track(e,t):this.queuedEvents.push({trackType:e,metadata:t}))}trackOncePerSession(e,t){this.sessionEvents[e]||this.pendoEnabled()&&(this.track(e,t),this.sessionEvents[e]=!0)}trackOncePerPage(e,t){this.pageEvents[e]||this.pendoEnabled()&&(this.track(e,t),this.pageEvents[e]=!0)}trackSignIn(e){this.trackSignInSignUp("Sign In - Success",e)}trackSignUp(e){this.trackSignInSignUp("Sign Up - Success",e)}trackSignInSignUp(e,t){const n=this.route.snapshot.queryParams;this.track(e,{type:t,referrer:document.referrer,refParam:n.ref||null,groupInvite:n.hasOwnProperty("group_invite"),groupCode:n.hasOwnProperty("group")&&n.hasOwnProperty("code")})}initRouteListener(){this.router.events.pipe(Object(I.a)(e=>e instanceof T.c)).subscribe(()=>{this.pageEvents={}})}pendoEnabled(){if(!this.config.enabled)return!1;const e=Object(D.get)(this.config,`whitelist[${c.application}]`,null);if(!Object(D.isNil)(e)){const t=new URLSearchParams(window.location.search),n=t.get("id")||t.get("be")||t.get("m");return e.includes(n)}return!0}setIds(e){const t=Object(D.get)(this.config,`idPrefixes[${c.deploy}]`,"");e.visitor.id=`${t}${e.visitor.id}`,e.account.id&&(e.account.id=`${t}${e.account.id}`)}getGroupAttributeValue(e,t){if(!e)return null;const n=this.organizationsService.getOrganizationAttribute(e,"account_settings",t);return n?n.value:null}}return e.\u0275fac=function(t){return new(t||e)(i.Zb("pendoConfig"),i.Zb(T.e),i.Zb(T.a),i.Zb(W))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var Z=n("ofXK"),J=n("2Yyj"),X=n.n(J),Y=n("Kd/A"),ee=n.n(Y),te=n("Hfs6"),ne=n.n(te),ie=n("VLs4"),se=n.n(ie),oe=n("1IWC"),re=n.n(oe),ae=n("Paii"),ce=n.n(ae),le=n("vT00");const pe={title:"English",lang:"en",country:"us",id:"en-US"},de=[pe,{title:"Espa\xf1ol",lang:"es",country:"es",id:"es-ES"},{title:"\u4e2d\u6587(\u7b80\u4f53)",lang:"zh",country:"cn",id:"zh-CN"},{title:"Fran\xe7ais",lang:"fr",country:"fr",id:"fr-FR"},{title:"Deutsch",lang:"de",country:"de",id:"de-DE"},{title:"Italiano",lang:"it",country:"it",id:"it-IT"},{title:"\u65e5\u672c\u8a9e",lang:"ja",country:"ja",id:"ja"},{title:"Portugu\xeas",lang:"pt",country:"pt",id:"pt-PT"}];function ue(){let e="";try{e=localStorage.getItem("locale")}catch(t){}return(de.find(t=>t.id===e)||pe).id}[X.a,ee.a,ne.a,se.a,re.a,ce.a,n.n(le).a].forEach(e=>{Object(Z.y)(e)});let ge=(()=>{class e{static forRoot(){return{ngModule:e,providers:[{provide:i.w,useFactory:ue}]}}}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[Z.c]]}),e})(),he=(()=>{class e{constructor(e,t,n=pe.lang,i=!1){this.id=e,this.type=t,this.lang=n,this.preview=i}}return e.type="[Story] Load Current Story",e})(),be=(()=>{class e{constructor(e){this.story=e}}return e.type="[Story] Replace the Story",e})(),me=(()=>{class e{constructor(e){this.id=e}}return e.type="[Story] Set the Story ID",e})(),fe=(()=>{class e{constructor(e){this.displayName=e}}return e.type="[Story] Set Story Text",e})(),ye=(()=>{class e{constructor(e){this.tags=e}}return e.type="[Story] Set Story Tags",e})(),xe=(()=>{class e{constructor(e){this.lightLibs=e}}return e.type="[Story] Set Story Light Libs",e})(),ve=(()=>{class e{constructor(e,t,n){this.id=e,this.type=t,this.reset=n}}return e.type="[Story] Set Incoming Story Id",e})(),Oe=(()=>{class e{constructor(){}}return e.type="[Story] Load Story Chunk",e})(),we=(()=>{class e{constructor(e){this.chapterId=e}}return e.type="[Story] Reorder Load Chunks",e})(),Ce=(()=>{class e{constructor(e){this.chunk=e}}return e.type="[Story] Load Story Chunk Success",e})(),Se=(()=>{class e{constructor(e,t,n,i){this.id=e,this.story=t,this.type=n,this.chapterIdx=i}}return e.type="[Story] Build Story In Engine From Story Model",e})(),_e=(()=>{class e{constructor(e,t,n){this.story=e,this.id=t,this.type=n}}return e.type="[Story] Load Success",e})(),je=(()=>{class e{constructor(e,t){this.id=e,this.type=t}}return e.type="[Story] Load Fail",e})(),ke=(()=>{class e{constructor(e,t,n=pe.lang){this.id=e,this.type=t,this.lang=n}}return e.type="[Story] Import",e})(),Pe=(()=>{class e{constructor(e,t,n){this.story=e,this.id=t,this.type=n}}return e.type="[Story] Import Success",e})(),Me=(()=>{class e{constructor(){}}return e.type="[Story] Clear",e})(),Ie=(()=>{class e{constructor(){}}return e.type="[Story] Synchronize Chapters",e})(),ze=(()=>{class e{constructor(){}}return e.type="[Story] Human Ready (Web)",e})(),Te=(()=>{class e{constructor(){}}return e.type="[Story] Human Ready (SDK)",e})(),Ue=(()=>{class e{constructor(e){this.story=e}}return e.type="[Story] Merge Bridge Module Success",e})();class De{}let Le=(()=>{class e{constructor(){}}return e.type="[Engine] Load",e})(),Ee=(()=>{class e{constructor(e){this.result=e}}return e.type="[Engine] Load Success",e})(),Fe=(()=>{class e{constructor(e){this.ready=e}}return e.type="[Engine] Set Ready",e})(),Ae=(()=>{class e{constructor(e){this.display=e}}return e.type="[Engine] Set Display of 3D Scene",e})(),Re=(()=>{class e{constructor(e){this.scrollMode=e}}return e.type="[Engine] Set Zoom via scroll Allowed",e})(),Ve=(()=>{class e{constructor(e){this.shown=e}}return e.type="[Engine] Set Scroll Alert Shwon",e})(),Ne=(()=>{class e{constructor(e){this.visible=e}}return e.type="[Engine] Set Visibility of 3D Scene",e})(),Be=(()=>{class e{constructor(e,t){this.color=e,this.duration=t}}return e.type="[Engine] Fade",e})(),He=(()=>{class e{constructor(){}}return e.type="[Engine] Fade Complete",e})(),Qe=(()=>{class e{constructor(e){this.graph=e}}return e.type="[Engine] Set Graph",e})(),$e=(()=>{class e{constructor(){}}return e.type="[Engine] Clear Graph",e})(),qe=(()=>{class e{constructor(e){this.enabled=e}}return e.type="[Engine] Set Xray Mode",e})(),We=(()=>{class e{constructor(e){this.chapterId=e}}return e.type="[Engine] Set Engine Chapter",e})(),Ke=(()=>{class e{constructor(e){this.chapterInit=e}}return e.type="[Eninge] Set Chapter Init",e})(),Ge=(()=>{class e{constructor(e,t,n){this.node=e,this.event=t,this.hit=n}}return e.type="[Engine] Click Node",e})(),Ze=(()=>{class e{constructor(e,t){this.node=e,this.hit=t}}return e.type="[Engine] Set Contextmenu",e})(),Je=(()=>{class e{constructor(e,t=!0,n){this.objectId=e,this.animate=t,this.animationDuration=n}}return e.type="[Engine] Fly To Object",e})(),Xe=(()=>{class e{constructor(){}}return e.type="[Engine] Center Camera on Visible Nodes",e})(),Ye=(()=>{class e{constructor(e,t){this.leafVisibilityState=e,this.nodes=t}}return e.type="[Engine] Synchronize Visible Nodes On Tree",e})(),et=(()=>{class e{constructor(e){this.leafRenderableState=e}}return e.type="[Engine] Synchronize Renderable State of Nodes On Tree",e})(),tt=(()=>{class e{constructor(e,t){this.leafPickableState=e,this.nodes=t}}return e.type="[Engine] Synchronize Pickable State of Nodes On Tree",e})(),nt=(()=>{class e{constructor(e){this.show=e}}return e.type="[Engine] Toggle Camera Bar",e})(),it=(()=>{class e{constructor(e){this.show=e}}return e.type="[Engine] Toggle Progress Bar",e})(),st=(()=>{class e{constructor(e){this.show=e}}return e.type="[Engine] Toggle Labels",e})(),ot=(()=>{class e{constructor(e){this.tool=e}}return e.type="[Engine] Set active tool",e})(),rt=(()=>{class e{constructor(e,t){this.chapter=e,this.pause=t}}return e.type="[Engine] Play chapter animation",e})(),at=(()=>{class e{constructor(e=!0){this.play=e}}return e.type="[Engine] Play animation",e})(),ct=(()=>{class e{constructor(e){this.playing=e}}return e.type="[Engine] Set animation playing",e})(),lt=(()=>{class e{constructor(e){this.speed=e}}return e.type="[Engine] Set playback speed",e})(),pt=(()=>{class e{constructor(e){this.play=e}}return e.type="[Engine] Play audio",e})(),dt=(()=>{class e{constructor(){}}return e.type="[Engine] Play chapter from start",e})(),ut=(()=>{class e{constructor(e){this.enable=e}}return e.type="[Engine] Set autoplay",e})(),gt=(()=>{class e{constructor(e,t){this.nodes=e,this.layer=t}}return e.type="[Engine] Set object layer order",e})(),ht=(()=>{class e{constructor(e,t){this.nodeId=e,this.displayName=t}}return e.type="[Engine] Set object display name",e})(),bt=(()=>{class e{constructor(){}}return e.type="[Engine] Auto Sort object layer orders",e})(),mt=(()=>{class e{constructor(){}}return e.type="[Engine] Reset object layer orders",e})(),ft=(()=>{class e{constructor(e){this.position=e}}return e.type="[Engine] Set Engine Position",e})(),yt=(()=>{class e{constructor(){}}return e.type="[Engine] Reset Engine Position",e})(),xt=(()=>{class e{constructor(e){this.effects=e}}return e.type="[Engine] Set Post Processing Effects",e})(),vt=(()=>{class e{constructor(e){this.properties=e}}return e.type="[Engine] Set Properties",e})(),Ot=(()=>{class e{constructor(e){this.mode=e}}return e.type="[Engine] Set Transparency Mode",e})(),wt=(()=>{class e{constructor(e){this.node=e}}return e.type="[Engine] Expand ViewTree Node",e})(),Ct=(()=>{class e{constructor(e){this.node=e}}return e.type="[Engine] Collapse ViewTree Node",e})(),St=(()=>{class e{constructor(){}}return e.type="[Engine] Collapse All ViewTree Nodes",e})(),_t=(()=>{class e{constructor(e,t){this.node=e,this.hit=t}}return e.type="[Engine] Hover Node",e})(),jt=(()=>{class e{constructor(e){this.node=e}}return e.type="[Engine] Set Label Edit Node",e})(),kt=(()=>{class e{constructor(e,t){this.node=e,this.info=t}}return e.type="[Engine] Set Node Info",e})(),Pt=(()=>{class e{constructor(e,t,n){this.node=e,this.fallback=t,this.lang=n}}return e.type="[Engine] Query Node Info",e})(),Mt=(()=>{class e{constructor(e,t){this.node=e,this.info=t}}return e.type="[Engine] Query Node Info Success",e})(),It=(()=>{class e{constructor(e){this.node=e}}return e.type="[Engine Nodes] Query Node Info Failure",e})(),zt=(()=>{class e{constructor(e){this.enabled=e}}return e.type="[Engine] Set Watermark Enabled",e})();class Tt{}class Ut{constructor(e){this.shown=e=>!1,this.selected=e=>!1,this.pickable=e=>!0,e.forEach(e=>{this[e]=e=>!1})}}var Dt,Lt;!function(e){function t(e,t){e.nodes[t.id]||(e.nodes[t.id]=t)}function n(e,t){return e.nodes[t]||null}function i(e,t){return e.predecessors[t]||null}function s(e,t){return[...e.successors[t]||[]]}function o(e){return Object.keys(e.roots)}e.addRootNode=function(e,i){t(e,i);const s=n(e,i.id);e.roots[s.id]=s},e.getNodes=function(e,t){const n=[];return t.forEach(t=>{e.nodes[t]&&n.push(e.nodes[t])}),n},e.getAncestors=function(e,t,n=!1,i="ascending"){const s=n?[t]:[];let o=e.predecessors[t];for(;o;)s.push(o),o=e.predecessors[o];return"descending"===i&&s.reverse(),s},e.addNode=t,e.getNode=n,e.getAncestor=i,e.getAllAncestorsFromList=function(e,t){const n={};let s;return t.forEach(t=>{s=i(e,t),s&&!n[s]&&(n[s]=!0)}),Object.keys(n)},e.getSuccessors=s,e.getState=function(e,t,i){const s={},o=n(e,t);return Object.entries(o.boolState).forEach(([e,t])=>{i&&i.includes(e)&&(s[e]=t)}),Object.entries(o.numState).forEach(([e,t])=>{i&&i.includes(e)&&(s[e]=t)}),s},e.isLeaf=function(e,t){return!!e.nodes[t]&&void 0===e.successors[t]},e.isRoot=function(e,t){return e.roots.hasOwnProperty(t)||!1},e.getRoots=o,e.depthFirst=function e(t,n,i){i?(n(i),s(t,i).forEach(i=>{e(t,n,i)})):o(t).forEach(i=>{n(i),e(t,n,i)})},e.createGraphFromSrc=function(e,t="objectId",n="objects",i={}){const s={nodes:{},successors:{},predecessors:{},roots:{}};return e.forEach(e=>{!function e(t,n,i,s,o,r,a){const c={id:i[s],depth:0,boolState:{},numState:{}};c.depth=a,function(e,t,n,i="id"){Object.entries(n).forEach(([n,s])=>{let o;"string"==typeof s?o=t[s]:"function"==typeof s&&(o=s(t[i])),"boolean"==typeof o?e.boolState[n]=o:"number"==typeof o?e.numState[n]=o:e[n]=o})}(c,i,r,s),t.nodes[c.id]=c,n?(t.successors[n]=[...t.successors[n]||[],c.id],t.predecessors[c.id]=n):t.roots[c.id]=c,a+=1,(i[o]||[]).forEach(n=>{e(t,c.id,n,s,o,r,a)})}(s,null,e,t,n,i,0)}),s},e.pruneHiddenObjects=function e(t,n,i){const s=[];for(const o of t){const t=n[o.objectId],r=!0===t||!1!==t&&i,a=e(o.objects||[],n,r);if(r){const e=Object.assign({},o);e.objects=a,s.push(e)}else a.forEach(e=>s.push(e))}return s}}(Dt||(Dt={})),function(e){function t(e,t){return e.reduce((e,n)=>(e[n]=t[n]||!1,e),{})}e.createVoter=t,e.getInitialVoterState=function(e,n){return Object.keys(e).reduce((i,s)=>(i[s]=t(n,e[s]),i),{})},e.getInitialElectionDepth=function(e,t){return Object.keys(e).reduce((e,n)=>Math.max(e,Dt.getNode(t,n).depth),0)-1},e.getEligibleElections=function(e,t,n){return Dt.getAllAncestorsFromList(e,t).filter(t=>t&&Dt.getNode(e,t).depth===n)};const n={trueWins:e=>({result:e.votesFor.length>0,dissenters:[...e.votesAgainst]}),falseWins:e=>({result:e.votesAgainst.length>0,dissenters:[...e.votesFor]}),majorityWins:e=>{const t=e.votesFor.length>e.votesAgainst.length;return{result:t,dissenters:t?[...e.votesAgainst]:[...e.votesFor]}}};function i(e,t,i){return Object.keys(t).reduce((s,o)=>{const r=t[o],a=i[o]||"majorityWins",{result:c,dissenters:l}=n[a](r);return s[o]={id:e,result:c,dissenters:l,voters:[...r.votesFor,...r.votesAgainst]},s},{})}e.buildElectionResult=i,e.getElectionResults=function(e,n,s,o){const r=n,a=Object.keys(o);return{results:s.reduce((s,c)=>{const l=Dt.getSuccessors(e,c),p=l.map(i=>({[i]:n[i]||t(a,Dt.getState(e,i,a))}));l.forEach(e=>{delete r[e]});const d=i(c,function(e,t){return Object.keys(e).reduce((e,n)=>{const i=t.reduce((e,t)=>{const i=Object.keys(t)[0];return t[i][n]?e.votesFor.push(i):e.votesAgainst.push(i),e},{votesFor:[],votesAgainst:[]});return e[n]=i,e},{})}(o,p),o);return r[c]=Object.entries(d).reduce((e,[t,n])=>(e[t]=n.result,e),{}),s.results.push(d),s},{results:[]}).results,remainingVoters:r}}}(Lt||(Lt={}));let Et=(()=>{class e{serializeNode(e,t,n={},i=(e=>!0)){const s={};return s.id=t.id,Object.entries(t.boolState).forEach(([e,t])=>{n.hasOwnProperty(e)&&(s[e]=t)}),Object.entries(t.numState).forEach(([e,t])=>{n.hasOwnProperty(e)&&(s[e]=t)}),e.successors[t.id]&&(s.children=[],e.successors[t.id].forEach(t=>{i(t)&&s.children.push(this.serializeNode(e,e.nodes[t],n,i))},this)),s}getAllSiblingsFromList(e,t,n){const i=[];let s;for(s=0;s<t.length;s++)this.getSiblings(e,t[s],n).forEach(e=>{i.includes(e)||i.push(e)});return i}getElectionResults(e,t,n,i){class s extends class{}{constructor(e,t){super(),Object.entries(e).forEach(([e,n])=>{this[e]={votesFor:[],votesAgainst:[]},Object.entries(t).forEach(([t,n])=>{n[e]?this[e].votesFor.push(t):this[e].votesAgainst.push(t)},this)},this)}}let o,r;const a=Object.keys(i),c=[];return n.forEach(n=>{r={},Dt.getSuccessors(e,n).forEach(n=>{r[n]=t[n]||Lt.createVoter(a,Dt.getState(e,n,a)),delete t[n]},this),o=new s(i,r);const l=Lt.buildElectionResult(n,o,i);c.push(l);const p={};Object.entries(l).forEach(([e,t])=>{p[e]=t.result}),t[n]=p},this),c}updateGraphStateRecord(e,t,n,i,s=!0){n.forEach(n=>{const o=n[i[0]].id,r=Dt.getState(e,o,i),a={};let c=!1;i.forEach(e=>{(s||n[e].result!==r[e])&&(a[e]=n[e].result,c=!0)}),c&&(t[o]=a)},this)}nodeExists(e,t){return!!e.nodes[t]}getLeaves(e){const t=[];return Object.entries(e.nodes).forEach(([n,i])=>{e.successors[n]||t.push(n)}),t}getDescendants(e,t,n=!1){const i=[];return function t(n){Dt.getSuccessors(e,n).forEach(e=>{i.push(e),t(e)})}(t),n&&i.push(t),i}getLeafDescendants(e,t,n=!1){const i=this.getDescendants(e,t,n).filter(t=>Dt.isLeaf(e,t));return(Dt.isLeaf(e,t)||n)&&i.push(t),i}getAllLeafDescendants(e,t){let n=[];return t.forEach(t=>{n=Dt.isLeaf(e,t)?[...n,t]:[...n,...this.getLeafDescendants(e,t,!1)]}),n.sort().reduce((e,t)=>(e.indexOf(t)<0&&e.push(t),e),[])}getInverseSelection(e,t){const n=this.getAllLeafDescendants(e,t);return this.getLeaves(e).filter(e=>n.indexOf(e)<0)}getSiblings(e,t,n=!1){const i=e.predecessors[t];let s=[];if(s=i?Dt.getSuccessors(e,i):Dt.getRoots(e),!n){const e=s.indexOf(t);e>=0&&s.splice(e,1)}return s}getNodes(e,t){const n=[];return t.forEach(t=>{e.nodes[t]&&n.push(e.nodes[t])}),n}setState(e,t,n){const i=Dt.getNode(e,t),s={};return Object.entries(n).forEach(([e,t])=>{"boolean"==typeof t&&i.boolState[e]!==t?(i.boolState[e]=t,s[e]=t):"number"==typeof t&&i.numState[e]!==t&&(i.numState[e]=t,s[e]=t)}),s}synchronize(e,t,n){const i=this.calculateGraphStateMap(e,t,n);return Object.entries(i).forEach(([t,n])=>{this.setState(e,t,n)},this),i}calculateGraphStateMap(e,t,n,i=!n){let s=[];const o={};let r=[];const a={},c=Object.keys(t);let l=0;for(n?Object.entries(n).forEach(([t,i])=>{o[t]=Lt.createVoter(c,n[t]),a[t]=Object.assign({},o[t]),l=Math.max(l,Dt.getNode(e,t).depth)},this):this.getLeaves(e).forEach(t=>{o[t]=Lt.createVoter(c,Dt.getNode(e,t).boolState),a[t]=Object.assign({},o[t]),l=Math.max(l,Dt.getNode(e,t).depth)},this),l-=1,s=Lt.getEligibleElections(e,Object.keys(o),l);l>=0;)r=this.getElectionResults(e,o,s,t),this.updateGraphStateRecord(e,a,r,c,i),l-=1,s=Lt.getEligibleElections(e,Object.keys(o),l);return a}filterGraphAccessors(e,t){const n=this.getNodes(e,t).sort((e,t)=>e.depth-t.depth),i=new Map;return n.filter(t=>!i.has(t.id)&&(this.getDescendants(e,t.id,!0).forEach(e=>i.set(e,!0)),!0)).map(e=>e.id)}resetDepth(e){Dt.depthFirst(e,t=>{let n=0;e.predecessors[t]&&(n=Dt.getNode(e,e.predecessors[t]).depth+1),Dt.getNode(e,t).depth=n})}deleteNode(e,t,n=!0){if(!this.nodeExists(e,t))return;delete e.nodes[t];const i=e.predecessors[t];i&&(delete e.predecessors[t],e.successors[i]&&(e.successors[i]=e.successors[i].filter(e=>e!==t)));const s=e.successors[t];s&&(delete e.successors[t],n&&s.forEach(t=>{this.deleteNode(e,t)},this)),e.roots[t]&&delete e.roots[t]}sanitizeNodeID(e){const t=new RegExp(/\|:/,"gi");return e.replace(t,"_")}resetAsLeaf(e,t){let n=[];return e.nodes[t]&&!Dt.isLeaf(e,t)&&(n=this.getDescendants(e,t),delete e.successors[t],n.forEach(t=>{delete e.nodes[t],delete e.successors[t],delete e.predecessors[t]})),n}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();class Ft{}var At=function(e){return e.Started="started",e.Loaded="loaded",e.Tick="tick",e.HumanReady="human.ready",e.HumanStarted="started",e.Error="error",e.HumanError="human.error",e.CanvasResized="canvas.resized",e.HumanCanvasResized="human.canvasResized",e.LogDebug="_log.debug",e.LogError="_log.error",e.LogInfo="_log.info",e.LogWarn="_log.warn",e.SceneLoaded="scene.loaded",e.HumanProgress="human.progress",e.AnnotationsCreated="annotations.created",e.AnnotationsDestroyed="annotations.destroyed",e.AnnotationsHidden="annotations.hidden",e.AnnotationsShown="annotations.shown",e.AssetsLoadFinish="assets.load.finish",e.AssetsLoadProgress="assets.load.progress",e.AssetsLoadStart="assets.load.start",e.CameraRested="camera.rested",e.CameraUpdated="camera.updated",e.HotspotsDisplayUpdated="hotspots.displayUpdated",e.HotspotsEntered="hotspots.entered",e.HotspotsLeft="hotspots.left",e.HotspotsPicked="hotspots.picked",e.HotspotsPositionUpdated="hotspots.positionUpdated",e.LabelsCreated="labels.created",e.LabelsUpdated="labels.updated",e.LabelsMoved="labels.moved",e.LabelsDestroyed="labels.destroyed",e.LabelsChapterInfo="labels.chapterInfo",e.LabelsShown="labels.shown",e.LabelsHidden="labels.hidden",e.LabelsEnabled="labels.enabled",e.LabelsDisabled="labels.disabled",e.LabelsEntered="labels.entered",e.LabelsLeft="labels.left",e.LabelsPicked="labels.picked",e.ModuleInteractive="module.interactive",e.ModulesActivateFinish="modules.activate.finish",e.ModulesCreateFinish="modules.create.finish",e.ModulesDestroyFinish="modules.destroy.finish",e.PickPicked="pick.picked",e.QuizEntered="quiz.entered",e.QuizExited="quiz.exited",e.QuizQuestionLoaded="quiz.questionLoaded",e.QuizAnswerSelected="quiz.answerSelected",e.QuizAnswerSubmitted="quiz.answerSubmitted",e.QuizCompleted="quiz.completed",e.SceneMarkersUpdated="scene.markers.updated",e.SceneObjectRenderable="scene.objectRenderable",e.SceneObjectsSelected="scene.objectsSelected",e.SceneObjectsShown="scene.objectsShown",e.ScenePicked="scene.picked",e.SceneRestored="scene.restored",e.SceneXrayEnabled="scene.xrayEnabled",e.SceneXrayDisabled="scene.xrayDisabled",e.SceneReady="scene.ready",e.TimelineChaptersActivated="timeline.chapters.activated",e.TimelineChaptersActivateFinish="timeline.chapters.activate.finish",e.TimelineChaptersActivateStart="timeline.chapters.activate.start",e.TimelineChapterTransition="timeline.chapterTransition",e.TimelinePlaying="timeline.playing",e.TimelineScrubbed="timeline.scrubbed",e.TimelinePlayed="timeline.played",e.TimelineStopped="timeline.stopped",e.TimelinePaused="timeline.paused",e.TimelineUnpaused="timeline.unpaused",e.TimelineCompleted="timeline.completed",e.TimelineTimeFrameUpdated="timeline.timeFrame.updated",e.GraphAssetAttachFinish="graph.assetAttach.finish",e.TweenVisibilityUpdate="TweenVisibilityUpdate",e.NativeDeleteData="native.deleteData",e.NativeUpgrade="native.upgrade",e.NativeRestore="native.restore",e.NativeShare="native.share",e.NativeGoogleSignUp="native.googleSignUp",e.NativeDebugMessage="native.debugMessage",e}({}),Rt=function(e){return e.SSAO="sao",e.Blur="blur",e.RadialBlur="radialBlur",e.DOF="dof",e.FXAA="fxaa",e.GroundShadow="groundShadow",e}({});const Vt={shown:"shown",renderable:e=>Human.scene.objects[e].isRenderable(),pickable:"pickable",label:e=>Human.scene.objects[e].displayName,expanded:e=>!1,layer:"layer"},Nt={shown:"trueWins",renderable:"falseWins",pickable:"trueWins"},Bt={trim:!0};class Ht{constructor(e){this.trim=e.trim||!1,this.terminal=e.terminal||[],this.root=e.root||{children:[],replace:!1},this.connect=e.connect||{},this.nodes=e.nodes||[]}}let Qt=(()=>{class e{constructor(e){this.graphService=e,this.objectToNodeMap={},this.nodeToObjectMap={},this.events={},this.events=Object.values(At).reduce((e,t)=>(e[t]=this.makeObservable(t),e),{})}makeObservable(e){return new P.a(t=>{Human.events.on(e,e=>{t.next(e)})})}getCanvas(){return Human.renderer.canvas.canvas}getEvent(e){return this.events[e]}fireEvent(e,t){Human.events.fire(e,t)}getSceneBoundary(){return Human.scene.getBoundary()}getObjectBoundary(e){return Human.scene.objects[e].getBoundary()}getObjectLoaded(e){const t=this.getObjectBoundary(e);return!Object(D.isNil)(t)&&Object.values(t).every(e=>isFinite(e))}pickScene(e){return Human.renderer.pick.pick(e.x,e.y,{rayPick:e.rayPick})}transformObject(e,t){const n=Human.scene.objects[e];n?n.setTransform(t):console.error(`Scene object not found: '${e}'`)}toggleNodes(e,t){const n={replace:!1,objects:{},fetchAssets:t};e.forEach(e=>{this.getObjects(e).forEach(e=>{n.objects[e]=t})}),Human.scene.setEnabledObjects(n)}setNodesVisible(e,t=!1){const n={replace:t,objects:Object.assign({},e),fetchAssets:!0};Human.scene.setEnabledObjects(n)}setNodesPickable(e){Object.keys(e).forEach(t=>{(Human.scene.objects[t].isLeaf()?[t]:this.getLeafObjects(t)).forEach(n=>{Human.scene.objects[n].setPickable(e[t])})})}filterObjects(e,t){let n=e.length;for(;n--;)switch(!0){case e[n]instanceof Human.scene.Group:e[n].objects=this.filterObjects(e[n].objects,t),0===e[n].objects.length&&e.splice(n,1);break;case e[n]instanceof Human.scene.Object:-1===e[n].displayName.toLowerCase().indexOf(t)&&e.splice(n,1)}return e}setObjectLayer(e,t){const n=Human.scene.objects[e];if(n.layer=t,n.renderables)for(let i=0;i<n.renderables.length;++i)n.renderables[i].setLayer(t);else n.hasOwnProperty("_layerNode")?n._layerNode.setPriority(t):n.hasOwnProperty("_propertiesNode")&&n._propertiesNode.setProperties({layer:t})}getObjectLayerValues(e){const t={},n=Human.scene.getBoundary();return e.forEach(e=>{const i=Human.scene.objects[e],s=i.getBoundary(),o=Math.min(s.xmin-n.xmin,n.xmax-s.xmax),r=2*Math.min(s.ymin-n.ymin,n.ymax-s.ymax),a=Math.min(s.zmin-n.zmin,n.zmax-s.zmax),c=i.layer;t[c]=t[c]||[],t[c].push({nodeId:e,value:Math.min(o,r,a)})}),t}getSceneGraph(e){const t=Dt.createGraphFromSrc(e,"objectId","objects",Vt);return this.graphService.synchronize(t,Nt),t}createViewGraph(e,t=!0,n=!1){const i=t?Dt.pruneHiddenObjects(Human.scene.rootObjects,e):Human.scene.rootObjects,s=i.reduce((e,t)=>{const i=!n&&t.objectId.includes("-root");return e[t.objectId]=!0!==i,i&&t.objects.forEach(t=>{e[t.objectId]=!0}),e},{}),o=this.getSceneGraph(Dt.pruneHiddenObjects(i,s));return this.graphService.resetDepth(o),o}getNode(e,t){return this.graphService.nodeExists(e,t)?Dt.getNode(e,t):this.objectToNodeMap[t]?Dt.getNode(e,this.objectToNodeMap[t]):null}getChapterGraphConfig(){const e=Human.timeline.activeRoot._nowBranch;return new Ht(Object.assign(Object.assign({},Bt),e.graph||{}))}getRootObjects(){return Human.scene.rootObjects}getAllSceneObjects(){return Human.scene.objects}getObjects(e){return this.nodeToObjectMap[e]?this.nodeToObjectMap[e]:[Human.scene.objects[e].objectId]||!1}getLeafObjects(e){if(e in this.nodeToObjectMap){const t={};return this.nodeToObjectMap[e].forEach(e=>{Human.scene.objects[e].isLeaf()?t[e]=!0:Human.scene.getLeaves(e).forEach(e=>{t[e]=!0})}),Object.keys(t)}return e in Human.scene.objects?Human.scene.getLeaves(e):[]}getChapter(e){return Human.timeline.branchTimelines[e]||null}getActiveChapters(){return Human.timeline.activeRoot?Human.timeline.activeRoot._chapters:[]}getBoundaryFromObjects(e){return e=e.filter(e=>Human.scene.objects[e].isLeaf()),Human.scene.getBoundary({objectIds:e,clipped:!0})}getLeaves(e){return Human.scene.getLeaves(e)}getVisibleLeaves(){return Human.scene.getEnabledLeaves()}getCameraLookAt(){return Object(A.plainToClass)(Ft,Human.renderer.camera.getLookAt())}barycentricToWorld(e,t,n,i=0){const s=new Float32Array([0,0,0]);return Human.scene.objects[e].barycentricToWorldSpace(i,t,n,s),isNaN(s[0])?[0,0,0]:[...Array.from(s)]}setGraphState(e){Human.scene.setObjectProperties(e)}getAssetNamespaces(){const e={};return Object.keys(Human.assets.loadedAssets).map(e=>e.split("/")[0]).forEach(t=>{e[t]=!0}),Object.keys(e)}loadGraphObject(e){const t=this.getObjects(e).map(e=>Human.scene.objects[e]);return new P.a(e=>{Human.scene.graph.attachAssetSetsToSubtree(t,null,()=>{e.next(!0),e.complete()})})}setProperties(e){Human.properties.set(e)}getDefaultProperties(){return Human.properties.getDefaults()}setTransparencyMode(e){Human.renderer.setTransparencyMode(e)}setPostProcessingEnabled(e){e?Human.renderer.postprocess.enable():Human.renderer.postprocess.disable()}setPostProcessingFeatures(e){const t=e.filter(e=>e.effect!==Rt.GroundShadow);Human.renderer.postprocess.parse(t);const n=e.find(e=>e.effect===Rt.GroundShadow);n?(Human.renderer.groundShadow.init(),Human.renderer.groundShadow.update({blurAmount:n.blur,opacity:n.opacity,translation:[n.xPos,n.yPos,n.zPos],scale:n.size})):Human.renderer.groundShadow.destroy()}enableAnimation(){Human.timeline.enableAnimation()}enableRender(){Human.renderer.enableRender()}canIRender(){return Human.renderer.canIRender()}enableLightLib(e){const t=Human.assets.lights.lightIds[e];if(Array.isArray(t)){const e={};t.forEach(t=>{e[t]=!0}),Human.renderer.lights.clearEnabled(),Human.renderer.lights.setEnabled(e)}}setBranchLights(e,t){const n=Human.timeline.branchTimelines[e];n.lights.libraries[0]!==t&&(n.lights.libraries[0]=t,this.enableLightLib(t))}loadLightLib(e){return new Promise((t,n)=>{Human.assets.getAssetLibrary("light","lights",e,"outline",{},()=>{const i=Human.assets.lights.lightIds;Array.isArray(i[e])?t(e):n()})})}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(Et))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();class $t{constructor(e,t,n,i,s){this.left=e,this.top=t,this.width=n,this.height=i,this.visibility=s}}var qt=function(e){return e[e.Hidden=-1]="Hidden",e[e.Shown=1]="Shown",e}({});class Wt{}let Kt=(()=>{class e{constructor(e){this.id=e}}return e.type="[Engine Camera] Clear Camera",e})(),Gt=(()=>{class e{constructor(e,t){this.id=e,this.camera=t}}return e.type="[Engine Camera] Store Camera",e})(),Zt=(()=>{class e{constructor(e,t=!0,n,i){this.camera=e,this.animate=t,this.animationDuration=n,this.rotationCenter=i}}return e.type="[Engine Camera] Set Camera",e})(),Jt=(()=>{class e{constructor(){}}return e.type="[Engine Camera] Set Camera Success",e})(),Xt=(()=>{class e{constructor(e){this.enabled=e}}return e.type="[Engine Camera] Set Chapter Camera Enabled",e})(),Yt=(()=>{class e{constructor(e){this.cameraMotion=e}}return e.type="[Engine Camera] Move Camera",e})(),en=(()=>{class e{constructor(){}}return e.type="[Engine Camera] Reset Camera",e})(),tn=(()=>{class e{constructor(e){this.value=e}}return e.type="[Engine Camera] Zoom Camera",e})(),nn=(()=>{class e{constructor(e){this.value=e}}return e.type="[Engine Camera] Zoom Camera Static",e})(),sn=(()=>{class e{constructor(e){this.value=e}}return e.type="[Engine Camera] Pan Camera X",e})(),on=(()=>{class e{constructor(e){this.value=e}}return e.type="[Engine Camera] Pan Camera Y",e})(),rn=(()=>{class e{constructor(e,t,n){this.x=e,this.y=t,this.z=n}}return e.type="[Engine Camera] Pan Camera Static",e})(),an=(()=>{class e{constructor(e){this.value=e}}return e.type="[Engine Camera] Rotate Camera X",e})(),cn=(()=>{class e{constructor(e){this.value=e}}return e.type="[Engine Camera] Rotate Camera Y",e})(),ln=(()=>{class e{constructor(e,t){this.x=e,this.y=t}}return e.type="[Engine Camera] Rotate Camera Static",e})(),pn=(()=>{class e{constructor(e){this.mode=e}}return e.type="[Engine Camera] Set Camera Mode",e})(),dn=(()=>{class e{constructor(e){this.zoomed=e}}return e.type="[Engine Camera] Set Zoomed",e})(),un=(()=>{class e{constructor(e){this.lock=e}}return e.type="[Engine Camera] Lock camera",e})(),gn=(()=>{class e{constructor(e){this.camera=e}}return e.type="[Engine Camera] Set Camera Fly To",e})(),hn=(()=>{class e{constructor(e){this.patches=e}}return e.type="[Engine Camera] Patch Camera State",e})();class bn{static toArray(e){return[e.x,e.y,e.z]}static fromArray(e){return{x:e[0],y:e[1],z:e[2]}}}let mn=(()=>{class e{constructor(){}roundModel(e,t){const n=Object.assign({},e);return Object.keys(e).filter(t=>"number"==typeof e[t]).forEach(i=>{n[i]=this.roundNumber(e[i],t)}),n}roundNumber(e,t){return Math.round(e*Math.pow(10,t))/Math.pow(10,t)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var fn=n("IOcx");let yn=(()=>{class e{constructor(e){this.numberService=e,this.rotation={vx:0,vy:0},this.pan={x:0,y:0,z:0},this.zoom=0}getEye(){return Human.renderer.camera.eye}setEye(e){Human.renderer.camera.setLookAt({eye:e})}getCamera(){return Human.renderer.camera.getLookAt()}getLookDirection(){const e=fn.a.create();return Human.renderer.camera.getLookDir(e),e}setCamera(e){return Human.renderer.camera.setLookAt(e)}getCameraZoom(){return Human.renderer.camera.getZoom()}captureCamera(){return{lookAt:Human.renderer.camera.getLookAt(),zoom:Human.renderer.camera.getZoom()}}resetCamera(){return new P.a(e=>{Human.init.resetCamera(()=>{e.next(),e.complete()})})}getDirection(e){const t=this.getEye(),n=fn.a.create();return n[0]=t.x-e.worldPos[0],n[1]=t.y-e.worldPos[1],n[2]=t.z-e.worldPos[2],fn.a.normalize(n,n),n}rotateCameraStatic(e,t){Human.renderer.camera.rotateX(e),Human.renderer.camera.rotateY(t)}panCameraStatic(e,t,n){Human.renderer.camera.pan({x:e,y:t,z:n})}setHumanZoom(e){Human.renderer.camera.zoom(e)}setHumanZoomFactor(e){Human.renderer.camera.setZoom(e)}getCameraRotationCenter(){return bn.fromArray(Human.renderer.camera.rotationCenter)}setCameraRotationCenter(e){Human.renderer.camera.setRotationCenter(...bn.toArray(e))}setCameraRotation(e,t){this.rotation.vx=t,this.rotation.vy=-e}setCameraPan(e,t){this.pan.x=e,this.pan.y=t}setCameraZoom(e){this.zoom=.03*e}setCameraZoomWithVelocity(e){this.setCameraZoom(e),requestAnimationFrame(()=>{e*=.85,Math.abs(e)>1&&this.setCameraZoomWithVelocity(e)})}tickCameraRotation(){return this.rotation.vx=this.checkEpsilon(this.rotation.vx),this.rotation.vy=this.checkEpsilon(this.rotation.vy),this.rotation}tickCameraPan(){return this.pan.x=this.checkEpsilon(this.pan.x),this.pan.y=this.checkEpsilon(this.pan.y),this.pan.z=this.checkEpsilon(this.pan.z),this.pan}tickCameraZoom(){return this.zoom=this.checkEpsilon(this.zoom),this.zoom}areCamerasEqual(e,t){return this.compareXYZ(e.eye,t.eye)&&this.compareXYZ(e.look,t.look)&&this.compareXYZ(e.up,t.up)}compareXYZ(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z}roundCamera(e,t){const{eye:n,look:i,up:s}=e;return{eye:this.numberService.roundModel(n,t),look:this.numberService.roundModel(i,t),up:this.numberService.roundModel(s,t)}}cameraAfterFlyTo(e){const t=this.getCamera(),n=bn.toArray(t.look),i=bn.toArray(t.eye),s=fn.a.create();fn.a.subtract(s,i,n);const o=fn.a.create();fn.a.normalize(o,s);const r=Math.abs(fn.a.length(o)),a=Human.math.getBoundaryDiag(e),c=Math.abs(a/1.8/Math.tan(27.5))/r*2.5,l=Human.math.getBoundaryCenter(e);fn.a.scale(s,o,c);const p=fn.a.add(fn.a.create(),l,s);return{eye:bn.fromArray(p),look:bn.fromArray(l),up:{x:0,y:1,z:0}}}setChapterCameraEnabled(e){this.initCamera||(this.initCamera=Human.timeline.BranchTimeline.prototype.initCamera),Human.timeline.BranchTimeline.prototype.initCamera=e?this.initCamera:()=>{}}checkEpsilon(e){return Math.abs(e)<.001?0:e}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(mn))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();class xn{constructor(e=0,t=0,n=0,i=0,s=0,o=!1){this.zoom=e,this.panX=t,this.panY=n,this.rotateX=i,this.rotateY=s,this.applyFriction=o}}var vn=n("vkgz");class On{}let wn=(()=>{class e{constructor(e){this.patches=e}}return e.type="[Story Chapter] Apply Patch",e})(),Cn=(()=>{class e{constructor(){}}return e.type="[Story Chapter] Next Chapter",e})(),Sn=(()=>{class e{constructor(){}}return e.type="[Story Chapter] Previous Chapter",e})(),_n=(()=>{class e{constructor(){}}return e.type="[Story Chapter] First Chapter",e})(),jn=(()=>{class e{constructor(){}}return e.type="[Story Chapter] Last Chapter",e})(),kn=(()=>{class e{constructor(e){this.chapter=e}}return e.type="[Story Chapter] Select Chapter",e})(),Pn=(()=>{class e{constructor(e){this.chapterId=e}}return e.type="[Story Chapter] Select Chapter by chapter id",e})(),Mn=(()=>{class e{constructor(e){this.chapters=e}}return e.type="[Story Chapter] Set Chapters",e})(),In=(()=>{class e{constructor(e,t){this.chapterId=e,this.cameraAction=t}}return e.type="[Story Chapter] Set Chapter Camera Action",e})(),zn=(()=>{class e{constructor(e,t){this.chapterId=e,this.ui=t}}return e.type="[Story Chapter] Set Chapter UI",e})(),Tn=(()=>{class e{constructor(e,t){this.chapterId=e,this.info=t}}return e.type="[Story Chapter] Set Chapter Info",e})(),Un=(()=>{class e{constructor(e,t){this.chapterId=e,this.legend=t}}return e.type="[Story Chapter] Set Chapter Legend",e})(),Dn=(()=>{class e{constructor(e,t){this.chapterId=e,this.legend=t}}return e.type="[Story Chapter] Add To Chapter Legend",e})(),Ln=(()=>{class e{constructor(e,t){this.previousIndex=e,this.currentIndex=t}}return e.type="[Story Chapter] Reorder Chapters",e})(),En=(()=>{class e{constructor(e,t){this.chapterId=e,this.readyState=t}}return e.type="[Story Chapter] Set Readystate",e})(),Fn=(()=>{class e{constructor(e,t,n){this.chapterId=e,this.effects=t,this.properties=n}}return e.type="[Story Chapter] Set Chapter PostProcessing",e})(),An=(()=>{class e{constructor(e,t,n){this.chapterId=e,this.transition=t,this.key=n}}return e.type="[Story Chapter] Set Chapter Transitions",e})(),Rn=(()=>{class e{constructor(e,t){this.chapterIds=e,this.properties=t}}return e.type="[Story Chapter] Set Chapter Properties",e})(),Vn=(()=>{class e{constructor(e,t){this.chapterIds=e,this.properties=t}}return e.type="[Story Chapter] Remove Chapter Properties",e})(),Nn=(()=>{class e{constructor(e,t){this.chapterId=e,this.transparencyMode=t}}return e.type="[Story Chapter] Set Chapter Transparency Mode",e})(),Bn=(()=>{class e{constructor(e,t,n,i){this.chapterId=e,this.clips=t,this.enabled=n,this.record=i}}return e.type="[Story Chapter] Set Chapter Clipping Planes",e})(),Hn=(()=>{class e{constructor(e,t){this.chapterId=e,this.background=t}}return e.type="[Story Chapter] Set Chapter Background",e})(),Qn=(()=>{class e{constructor(e){this.background=e}}return e.type="[Story Chapter] Set All Chapters Background",e})(),$n=(()=>{class e{constructor(){}}return e.type="[Story Chapter] Reset Selected Chapter Background",e})(),qn=(()=>{class e{constructor(e){this.background=e}}return e.type="[Story Chapter] Set Selected Chapter Background",e})(),Wn=(()=>{class e{constructor(e,t){this.chapter=e,this.chapterId=t}}return e.type="[Story Chapter] Duplicate An Existing Chapter",e})(),Kn=(()=>{class e{constructor(e){this.chapter=e}}return e.type="[Story Chapter] Remove Chapter",e})(),Gn=(()=>{class e{constructor(){}}return e.type="[Story Chapter] Reset",e})(),Zn=(()=>{class e{constructor(e,t,n){this.chapterId=e,this.camera=t,this.rotationCenter=n}}return e.type="[Story Chapters] Record Camera",e})(),Jn=(()=>{class e{constructor(e,t,n,i){this.chapterId=e,this.index=t,this.position=n,this.record=i}}return e.type="[Story Chapters] Set the current visibility layers index and position",e})(),Xn=(()=>{class e{constructor(e,t){this.chapterId=e,this.media=t}}return e.type="[Story Chapters] Set the media object",e})(),Yn=(()=>{class e{constructor(e,t){this.chapterId=e,this.contentBlocks=t}}return e.type="[Story Chapters] Set the content blocks",e})(),ei=(()=>{class e{constructor(e,t){this.chapterId=e,this.timelineMaps=t}}return e.type="[Story Chapters] Add to timelineMap array",e})(),ti=(()=>{class e{constructor(e,t){this.chapterId=e,this.updates=t}}return e.type="[Story Chapters] Update timelineMap array",e})(),ni=(()=>{class e{constructor(e,t){this.chapterId=e,this.timelineMapIds=t}}return e.type="[Story Chapters] Remove from timelineMap array",e})(),ii=(()=>{class e{constructor(e,t){this.chapterId=e,this.lights=t}}return e.type="[Story Chapters] Set the lights",e})();var si,oi=function(e){return e.Default="default",e.Plus="plus",e.Minus="minus",e.PlusMinus="plusMinus",e.Sequential="sequential",e.None="None",e}({}),ri=function(e){return e.Annotation="annotation",e.Classic="classic",e.StudioNext="studioNext",e.Context="context",e}({}),ai=function(e){return e.Alphabetical="alphabetical",e.Numerical="numerical",e}({});class ci{constructor(e){this.pinType=oi.PlusMinus,this.sequentialType=ai.Alphabetical,this.theme=ri.StudioNext,this.expandTag=!0,this.showDescription=!0,this.collapseDescription=!1,this.pinGlow=!1,this.hideWire=!1,this.hideTag=!1,this.title=e}}class li{}class pi{}!function(e){const t=/(\s*[\d\.]+\s*,){2,15}\s*[\d\.]+\s*/g;function n(e){for(let t=0;t<3;t++)if(parseFloat(""+e[t])>1)return!0;return!1}function i(e){const t=document.createElement("div");t.style.backgroundColor=e,document.documentElement.appendChild(t);const n=window.getComputedStyle(t).backgroundColor.replace(/\s/g,"");return window.document.documentElement.removeChild(t),n}function s(e){const t=e.slice(0,4);3===t.length&&t.push(1);for(let n=0;n<4;n++)t[n]=parseFloat(""+t[n]),t[n]<0&&(t[n]=0),t[n]>255&&(t[n]=255);return t[3]>1&&(t[3]=1),t}function o(e){let n;if(Array.isArray(e))n=s(e);else if("string"==typeof e){let o=e.match(t);o?n=s(o[0].split(",")):(o=i(e).match(t),o&&(n=s(o[0].split(","))))}return n}function r(e){const t=o(e);if(!t)throw new TypeError("Invalid color input.");const i=a(t);return{1:n(t)?i:t,255:n(t)?t:i}}function a(e){const t=n(e),i=[];for(let n=0;n<3;n++){let s=t?e[n]/255:255*e[n];s=t?Math.round(100*s)/100:Math.round(s),i.push(s)}return 4===e.length&&i.push(e[3]),i}function c(e,t=!1){e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(e,t,n,i)=>[t,t,n,n,i,i].join("")).replace(/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,(e,t,n,i)=>[t,n,i,"ff"].join(""));const n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e),i=parseInt(n[1],16),s=parseInt(n[2],16),o=parseInt(n[3],16),r=parseInt(n[4],16)/255;if(t){const e=p([i,s,o]);return[e[0],e[1],e[2],r]}return[i,s,o,r]}function l(e){const[t,n,i]=e;return Math.sqrt(t*t*.299+n*n*.587+i*i*.114)}function p(e){return e.map(e=>e/255)}function d(e){return e.map(e=>Math.round(255*e))}function u(e){return"#"+e.map(e=>{const t=e.toString(16);return t.length%2?"0"+t:t}).join("")}e.is255=n,e.isLight=function(e,t){return t||(t=[...e]),(l(e)+l(t))/2>140.25},e.getComputedColor=i,e.convertChannels=s,e.convert=o,e.getColor=r,e.getColors=function(e){let n=[];if("string"==typeof e){const n=e.match(t);n&&(e=n.join(",")),e=e.split(",")}if(Array.isArray(e))if(Array.isArray(e[0])&&Array.isArray(e[1]))n=e;else if(e.length<=2)n=1===e.length?e.concat(e):e;else{const t=Math.floor(e.length/2);n=e.length>4?[e.slice(0,t),e.slice(t)]:[e,e]}return n.map(e=>r(e))},e.scaleColor=a,e.hexToRgba=c,e.hexToRgb=function(e,t=!1){const n=c(e,t);return[n[0],n[1],n[2]]},e.rgbToHex=function(e,t=!1){return u(t?d(e):e)},e.rgbToHSP=l,e.rgbaToHex=function(e,t=!1){const n=e[0],i=e[1],s=e[2],o=255*e[3];return u(t?[...d([n,i,s]),o]:[n,i,s,o])},e.rgbToDecimal=p,e.rgbFromDecimal=d}(si||(si={}));const di=(e,t)=>{const n=[...e];return t.forEach(e=>{n.push(void 0!==e?Number(e):1)}),n},ui=e=>{const t=/rgba?\((\d{1,3})\,\s*(\d{1,3})\,\s*(\d{1,3})\,?\s*(\d+\.\d{0,5})?\)/g;let n=[];const i=t.exec(e),s=t.exec(e);return n=di(n,i.slice(1,5)),n=di(n,s.slice(1,5)),n};class gi{constructor(e,t,n){this.colors=e,this.gradientType=t,this.colorStops=n}static equals(e,t){return e.gradientType===t.gradientType&&e.colors.length===t.colors.length&&e.colors.every((e,n)=>e===t.colors[n])&&e.colorStops.length===t.colorStops.length&&e.colorStops.every((e,n)=>e===t.colorStops[n])}static deserialize(e){if(!Object.keys(e).length)return null;let t=[];"string"==typeof e.colors?t=ui(e.colors):Array.isArray(e.colors)&&8===e.colors.length&&(t=e.colors.map((e,t)=>(t+1)%4&&e<=1?Math.round(255*e):e));const n=/radial|linear/.test(e.gradientType)?e.gradientType:"radial",i=e.colorStops,s=Array.isArray(i)&&2===i.length?[i[0],i[1]]:[0,100];return new gi(t,n,s)}static toCSS(e){const t=e.colors,n=`rgba(${t[0]},${t[1]}, ${t[2]}, ${t[3]}) ${e.colorStops[0]}%`,i=`rgba(${t[4]},${t[5]}, ${t[6]}, ${t[7]}) ${e.colorStops[1]}%`;return"radial"===e.gradientType?`radial-gradient(circle, ${n}, ${i})`:`linear-gradient(180deg, ${n}, ${i})`}static fromCSS(e){const t=/radial-gradient/.test(e)?"radial":"linear",n=ui(e),i=/([0-9]+)\%/g,s=[0,100];return s[0]=Number(i.exec(e)[1]),s[1]=Number(i.exec(e)[1]),new gi(n,t,s)}static isTransparent(e){if(!e||!e.colors)return!1;const t=e.colors,n=t[3];return t.length<=4?0===n:0===n&&0===t[7]}static isLight(e){const t=null==e?void 0:e.colors;if(Array.isArray(t)){const e=t.slice(0,3);return si.isLight(e)}return!1}}var hi,bi=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},mi=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let fi=class{constructor(){this[hi]=!0}};var yi;hi=immer.immerable,bi([Object(A.Type)(()=>ci),Object(A.Type)(()=>li),Object(A.Type)(()=>Ft),Object(A.Type)(()=>pi),Object(A.Expose)(),mi("design:type",String)],fi.prototype,"id",void 0),bi([Object(A.Expose)(),mi("design:type",Object)],fi.prototype,"info",void 0),bi([Object(A.Expose)(),mi("design:type",Array)],fi.prototype,"labels",void 0),bi([Object(A.Expose)(),mi("design:type",Object)],fi.prototype,"colorRecipeObjects",void 0),bi([Object(A.Expose)(),mi("design:type",Array)],fi.prototype,"hotspots",void 0),bi([Object(A.Expose)(),mi("design:type",li)],fi.prototype,"synchronization",void 0),bi([Object(A.Expose)(),mi("design:type",gi)],fi.prototype,"background",void 0),bi([Object(A.Expose)(),mi("design:type",Object)],fi.prototype,"lights",void 0),bi([Object(A.Expose)(),mi("design:type",Array)],fi.prototype,"timelineMap",void 0),bi([Object(A.Expose)(),mi("design:type",Object)],fi.prototype,"camera",void 0),bi([Object(A.Expose)(),mi("design:type",Object)],fi.prototype,"transitions",void 0),bi([Object(A.Expose)(),mi("design:type",Object)],fi.prototype,"properties",void 0),bi([Object(A.Expose)(),mi("design:type",Boolean)],fi.prototype,"loop",void 0),bi([Object(A.Expose)(),mi("design:type",Object)],fi.prototype,"customData",void 0),bi([Object(A.Expose)(),mi("design:type",Object)],fi.prototype,"clippingPlanes",void 0),bi([Object(A.Expose)(),mi("design:type",class{})],fi.prototype,"ui",void 0),bi([Object(A.Expose)(),mi("design:type",pi)],fi.prototype,"graph",void 0),bi([Object(A.Expose)(),mi("design:type",Object)],fi.prototype,"viewModes",void 0),bi([Object(A.Expose)(),mi("design:type",Object)],fi.prototype,"recipes",void 0),bi([Object(A.Expose)(),mi("design:type",String)],fi.prototype,"transparencyMode",void 0),bi([Object(A.Expose)(),mi("design:type",Object)],fi.prototype,"fallbackTransparency",void 0),bi([Object(A.Expose)(),mi("design:type",Object)],fi.prototype,"effects",void 0),bi([Object(A.Expose)(),mi("design:type",Object)],fi.prototype,"environment",void 0),bi([Object(A.Expose)(),mi("design:type",Object)],fi.prototype,"pickThroughObjects",void 0),bi([Object(A.Expose)(),mi("design:type",Object)],fi.prototype,"showObjects",void 0),bi([Object(A.Expose)(),mi("design:type",Object)],fi.prototype,"options",void 0),bi([Object(A.Expose)(),mi("design:type",Object)],fi.prototype,"media",void 0),bi([Object(A.Expose)(),mi("design:type",Array)],fi.prototype,"legend",void 0),bi([Object(A.Expose)(),mi("design:type",class{})],fi.prototype,"visibilityLayers",void 0),bi([Object(A.Expose)(),mi("design:type",Array)],fi.prototype,"contentBlocks",void 0),bi([Object(A.Expose)(),mi("design:type",Array)],fi.prototype,"quizQuestions",void 0),bi([Object(A.Expose)(),mi("design:type",Object)],fi.prototype,"thumbnails",void 0),fi=bi([Object(A.Exclude)()],fi),function(e){function t(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}e.getUuid=t,e.idWithPrefix=function(e){return e?`${e}-${t()}`:t()}}(yi||(yi={}));class xi{}var vi=function(e){return e.classicAnnotation="classic-annotation",e.classicHotspot="classic-hotspot",e.studioNext="studio-light",e}({});class Oi{constructor(){this.title=null,this.description=null,this.errands=[]}}var wi=function(e){return e.flyToChapter="flyToChapter",e.flyToObject="flyToObject",e.flyToCamera="flyToCamera",e}({});class Ci{constructor(e){this.type=wi.flyToObject,this.value=e}}class Si{constructor(e){this.type=wi.flyToCamera,this.value=e}}var _i=function(e){return e.Circle="circle",e.CirclePlus="circle-plus",e.CircleMinus="circle-minus",e.Label="label",e.CircleLabel="circle-label",e}({});class ji{constructor(){this.type=wi.flyToChapter,this.value=null}}const ki={flyToCamera:"flyTo",flyToChapter:"flyTo"};let Pi=(()=>{class e{constructor(e){this.engineService=e,this.convertActionToErrand=(e,t,n)=>{const i=new RegExp("^flyTo(Async)?"),s=new RegExp("^flyToObject(Async)?"),o=new RegExp("^flyTo[w.:]+currentChapter.[flyTo|jumpTo]"),r=n.split(":").slice(0,2),a=e;let c=r[1];/currentChapter/.test(c)&&(c=c.replace("currentChapter",`chapters[${t}]`));let l=null;return s.test(r[0])?l=new Ci(Object(D.get)(a,c)):i.test(r[0])?l=new Si(Object(D.get)(a,c)):o.test(r[0])&&(l=new ji),l},this.convertErrandToAction=(e,t)=>{const n=yi.idWithPrefix("errand").replace(/-/g,"_"),i={};let s="";const o=function(e){return ki[e]||e}(t.type);return t.type===wi.flyToChapter?s=`${o}Async:currentChapter.${this.engineService.getChapter(e.chapterId).camera.action}`:(s=`${o}Async:currentChapter.customData.${n}`,i[n]=t.value),{action:s,data:i}}}filterHotspot(e,t,n){const i=new RegExp("^(flyTo|flyToObject|hideHotspot|showHotspot|resetHotspots)"),s=this.getHotspotAction(e,n),o=s.filter(e=>i.test(e));return s.length===o.length}deserializeAnnotation(e,t,n){const i=new ci(e.title||"");return i.id=e.annotationId||yi.idWithPrefix("label"),i.chapterId=t.id,i.expandTag=!0,i.showDescription=!0,i.collapseDescription=!1,i.pinGlow=!1,i.hideWire=!1,i.hideTag=!1,n===ri.Annotation?(i.theme=ri.Annotation,i.pinType=oi.Default,i.flyTo=!1,i.states=[]):(i.theme=ri.StudioNext,i.pinType=oi.PlusMinus,i.flyTo=!0,i.states=[new Oi,new Oi],i.states[0].errands=[new ji],i.states[1].errands=[new Ci(e.objectId)]),i.occludable=!1!==e.occludable,i.renderableIndex=e.renderableIndex||0,e.objectId&&Object.prototype.hasOwnProperty.call(e,"barycentric")?(i.objectId=e.objectId,i.primitiveIndex=e.primitiveIndex,i.barycentric=e.barycentric):Object.prototype.hasOwnProperty.call(e,"pos")&&(Object.prototype.hasOwnProperty.call(e,"objectId")&&(i.objectId=e.objectId),i.pos=e.pos),e.dir&&Array.isArray(e.dir)?i.dir=e.dir:e.dir&&e.dir instanceof Object&&(i.dir=Object.values(e.dir)),i.description=e.description||"",i.offset=e.labelOffset||[40,40],i.shown=!1!==e.shown,i.labelShown=!1!==e.labelShown,i}deserializeHotspots(e,t,n,...i){const[s,o]=i,r=new ci(s.title||"");switch(r.id=yi.idWithPrefix("hotspot"),r.objectId=s.objectId,r.chapterId=t.id,r.description=s.description||"",r.pinType=/plus|minus/.test(s.className)?oi.PlusMinus:/sequential/.test(s.className)?oi.Sequential:/none/.test(s.className)?oi.None:oi.Default,/alphabetical/.test(s.className)?r.sequentialType=ai.Alphabetical:/numerical/.test(s.className)&&(r.sequentialType=ai.Numerical),r.pinGlow=/pulse/.test(s.className),r.occludable=!0,r.shown=s.shown,r.offset=s.labelOffset?s.labelOffset:[22,-17],(/left/.test(s.className)&&r.offset[0]>0||/right/.test(s.className)&&r.offset[0]<0)&&(r.offset[0]*=-1),Object.prototype.hasOwnProperty.call(s,"barycentric")?(r.renderableIndex=s.renderableIndex||0,r.barycentric=s.barycentric,r.primitiveIndex=s.primitiveIndex):r.pos=s.pos,r.dir=s.dir,s.theme=s.theme?s.theme:vi.classicHotspot,s.theme){case vi.classicAnnotation:r.theme=ri.Annotation,r.showDescription=!0,r.collapseDescription=/collapsible/g.test(s.className),r.expandTag=!0,r.hideTag=!1,r.hideWire=!/leader-line/.test(s.className);break;case vi.classicHotspot:r.theme=ri.Classic,r.showDescription=/label/.test(s.className),r.expandTag=/label/.test(s.className),r.hideTag=!r.expandTag,r.collapseDescription=!1,r.hideWire=!/leader-line/.test(s.className);break;case vi.studioNext:r.theme=ri.StudioNext,r.showDescription=this.hasContent(s),r.collapseDescription=/collapsible/g.test(s.className),r.hideTag=!s.title,r.hideWire=!/leader-line/.test(s.className)}r.flyTo=!1,r.flyToTarget=null,r.states=[];const a=this.filterHotspotActions(this.getHotspotAction(e,s)),c=o?this.filterHotspotActions(this.getHotspotAction(e,o)):[],l=new Oi,p=new Oi;a.length&&(l.errands=a.map(t=>this.convertActionToErrand(e,n,t))),c.length&&(p.errands=c.map(t=>this.convertActionToErrand(e,n,t))),r.states=[p,l],l.errands.length>0&&(r.flyTo=!0,r.flyToTarget=l.errands[0].type,l.errands[0].type===wi.flyToCamera&&(r.cameraPosition=l.errands[0].value));const d=s.contentBlocks;return d&&(r.contentBlocks=JSON.parse(JSON.stringify(d))),r}makeDefaultStudioLabel(e){const t=e?Object.assign({},e):new ci("");return t.pinType=oi.PlusMinus,t.theme=ri.StudioNext,t.expandTag=!0,t.showDescription=!0,t.collapseDescription=!1,t.pinGlow=!1,t.hideWire=!1,t.hideTag=!1,t.occludable=!0,t.flyTo=!0,t.description="",t.shown=!0,t.states=[new Oi,new Oi],t}makeAnnotationLabel(e){const t=e?Object.assign({},e):new ci("");return t.pinType=oi.Default,t.theme=ri.Annotation,t.expandTag=!0,t.showDescription=!0,t.collapseDescription=!1,t.pinGlow=!1,t.hideWire=!1,t.hideTag=!1,t.states=[],t}serializeLabel(e,t){const n=new xi,i=Object(A.classToClass)(e),s=["circle","draggable"];n.shown=!0,e.objectId&&(n.objectId=i.objectId);try{e.primitiveIndex&&e.barycentric&&e.objectId?(n.renderableIndex=e.renderableIndex||0,n.primitiveIndex=e.primitiveIndex,n.barycentric=e.barycentric,n.pos=this.engineService.barycentricToWorld(e.objectId,e.primitiveIndex,e.barycentric)):n.pos=i.pos}catch(l){return{data:{},hotspots:[]}}switch((Array.isArray(e.dir)||ArrayBuffer.isView(e.dir))&&(n.dir=Array.prototype.slice.call(e.dir)),n.labelOffset=e.offset,e.theme){case ri.Annotation:n.theme=vi.classicAnnotation;break;case ri.Classic:n.theme=vi.classicHotspot;break;default:n.theme=vi.studioNext}""!==i.title?(n.title=i.title,n.description=i.description,n.type=_i.CircleLabel):n.type=_i.Circle,e.pinGlow&&s.push("pulse"),e.pinType===oi.PlusMinus&&s.push("plus"),e.pinType===oi.Sequential&&(s.push("sequential"),s.push(e.sequentialType===ai.Alphabetical?"alphabetical":"numerical")),e.pinType===oi.None&&s.push("none"),e.hideWire||s.push("leader-line"),e.hideTag||s.push("label"),e.collapseDescription&&s.push("collapsible collapsed"),n.className=s.join(" ");let o={};n.actions=[];const r=[n],a=e.states.length;e.states.forEach((t,i)=>{if(i===a-1)r[0].actions.push("resetHotspots"),t.errands.forEach(t=>{const n=this.convertErrandToAction(e,t);r[0].actions.push(n.action),o=Object.assign(Object.assign({},o),n.data)});else{const i=Object(A.classToClass)(n);i.actions=[],i.className=i.className.replace("plus","minus"),t.errands.forEach(t=>{const n=this.convertErrandToAction(e,t);i.actions.push(n.action),o=Object.assign(Object.assign({},o),n.data)}),r.push(i)}}),2===r.length&&(r[0].actions.push(`hideHotspots:currentChapter.hotspots[${t}]`),r[0].actions.push(`showHotspots:currentChapter.hotspots[${t+1}]`),r[1].actions.push(`hideHotspots:currentChapter.hotspots[${t+1}]`),r[1].actions.push(`showHotspots:currentChapter.hotspots[${t}]`),r[0].shown=!0,r[1].shown=!1),2===r.length&&e.collapseDescription&&(r[1].className+=r[1].className.replace("collapsed","")),r.forEach(e=>{n.labelOffset[0]<0?e.className=e.className.replace("right","")+" left":n.labelOffset[0]>0&&(e.className=e.className.replace("left","")+" right")});const c=e.contentBlocks;return c&&(n.contentBlocks=JSON.parse(JSON.stringify(c))),{data:o,hotspots:r}}setLabelContainer(e){this._labelContainer=e}getLabelContainer(){return this._labelContainer}hasContent(e){const{description:t,contentBlocks:n}=e;return!!t||!Object(D.isNil)(n)&&n.length>0}getHotspotAction(e,t){const n=t.actionSrc?Object(D.get)(e,t.actionSrc):t.actions?t.actions:[];return Array.isArray(n)?n:[]}filterHotspotActions(e){const t=new RegExp("^(flyTo|flyToObject)");return e.filter(e=>t.test(e))}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(Qt))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();class Mi{}var Ii,zi;function Ti(e,t,n,i){(function e(t,n){const i=n.objects;return 0===i.length?[]:Object(D.flattenDeep)(i.map(n=>[n.objectId,...e(t,t.scene.objects[n.objectId])]))})(Human,Human.scene.objects[e]).forEach(e=>t[e][n]=i)}function Ui(e,t){if(void 0===e.activeChapterId||void 0===e.nodeState)return;const[n,i,s]=immer.produceWithPatches(e,e=>{const n=e.nodeState[e.activeChapterId],i=t.objectIds||Object.keys(n);t.patch?Object.entries(t.patch).forEach(([e,t])=>{n[e].shown=t}):i.forEach(e=>{n[e].shown=t.show,n[e].shownSetByTween=t.setByTween,t.objectIds&&(Ti(e,n,"shown",t.show),!0===t.setByTween&&Ti(e,n,"shownSetByTween",t.setByTween))})});return{finalState:immer.produce(n,e=>{e.patches=i,e.patchesForChapter[e.activeChapterId].push(...i)}),patches:i,inversePatches:s}}!function(e){class t{constructor(){}}t.type="[Engine Nodes] Reset",e.Reset=t;class n{constructor(e){this.nodeState=e}}n.type="[Engine Nodes] init nodes",e.InitNodeState=n;class i{constructor(e){this.patches=e}}i.type="[Engine Nodes] patch nodes",e.ApplyPatch=i;class s{constructor(e){this.activeChapterId=e}}s.type="[Engine Nodes] set active chapter",e.SetActiveChapter=s;class o{constructor(e,t){this.originalChapterId=e,this.copyChapterId=t}}o.type="[Engine Nodes] Duplicate node state",e.DuplicateNodeState=o;class r{constructor(e,t,n,i=!0,s=!1){this.show=e,this.objectIds=t,this.patch=n,this.record=i,this.setByTween=s}}r.type="[Engine Nodes] update nodes shown",e.UpdateNodesShown=r;class a{constructor(e){this.objectId=e}}a.type="[Engine Nodes] update nodes selected",e.UpdateNodeSelected=a;class c{constructor(e,t,n){this.checked=e,this.objectIds=t,this.patch=n}}c.type="[Engine Nodes] update nodes checked",e.UpdateNodesChecked=c;class l{constructor(e,t,n){this.pickable=e,this.objectIds=t,this.patch=n}}l.type="[Engine Nodes] update nodes pickable",e.UpdateNodesPickable=l;class p{constructor(e,t,n,i=!0){this.recipe=e,this.objectIds=t,this.patch=n,this.record=i}}p.type="[Engine Nodes] update nodes paint",e.UpdateNodesPaint=p}(Ii||(Ii={})),function(e){class t{constructor(){}}t.type="[Undo] Reset",e.Reset=t;class n{constructor(e){this.chapterId=e}}n.type="[Undo] Undo",e.Undo=n;class i{constructor(e){this.chapterId=e}}i.type="[Undo] Undo All",e.UndoAll=i;class s{constructor(e){this.chapterId=e}}s.type="[Undo] Redo",e.Redo=s;class o{constructor(e){this.patches=e}}o.type="[Undo] Store Patches",e.SavePatches=o}(zi||(zi={}));class Di{constructor(e={center:[0,0,0],edge:[1,1,1],centerBias:1,edgeBias:0,power:1}){const{edge:t,center:n,centerBias:i,edgeBias:s,power:o}=e;this.edge=t,this.center=n,this.centerBias=i,this.edgeBias=s,this.power=o}static toEngine(e){const{center:t,edge:n,centerBias:i,edgeBias:s,power:o}=e;return[[...t],[...n],i,s,o]}}class Li{constructor(e={center:0,edge:1,centerBias:1,edgeBias:0,power:1}){const{edge:t,center:n,centerBias:i,edgeBias:s,power:o}=e;this.edge=t,this.center=n,this.centerBias=i,this.edgeBias=s,this.power=o}static toEngine(e){const{center:t,edge:n,centerBias:i,edgeBias:s,power:o}=e;return[t,n,i,s,o]}static isFresnelObject(e){let t=!1;return e&&(t="center,centerBias,edge,edgeBias,power"==Object.keys(e).sort().toString()),t}}function Ei(e,t){switch(!0){case void 0===e[t]:return;case!1===e[t]:return!1;case"number"==typeof e[t]:return 100*e[t];default:return new Li({center:e[t][0],edge:e[t][1],centerBias:e[t][2],edgeBias:e[t][3],power:e[t][4]})}}class Fi{constructor(e={}){const{tintColor:t,saturation:n,contrast:i,brightness:s,opacity:o,label:r}=e;this.tintColor=t,this.saturation=n,this.contrast=i,this.brightness=s,this.opacity=o,this.label=r}static isRealRecipe(e){return!1!==e.brightness||!1!==e.contrast||!1!==e.opacity||!1!==e.saturation||!1!==e.tintColor}static isFresnel(e){return void 0!==e&&e.hasOwnProperty("edge")&&e.hasOwnProperty("edgeBias")&&e.hasOwnProperty("center")&&e.hasOwnProperty("centerBias")&&e.hasOwnProperty("power")}static isColor(e){return Array.isArray(e)&&3===e.length}static fromEngine(e){const t=(()=>{switch(!0){case void 0===e.tintColor:return;case!1===e.tintColor:return!1;case Array.isArray(e.tintColor):return 3===e.tintColor.length?[...e.tintColor]:new Di({center:e.tintColor[0],edge:e.tintColor[1],centerBias:e.tintColor[2],edgeBias:e.tintColor[3],power:e.tintColor[4]})}})();return new Fi({tintColor:t,saturation:Ei(e,"saturation"),brightness:Ei(e,"brightness"),contrast:Ei(e,"contrast"),opacity:Ei(e,"opacity")})}static toEngine(e){let t=!1!==e.tintColor&&void 0,n=!1!==e.saturation&&void 0,i=!1!==e.brightness&&void 0,s=!1!==e.contrast&&void 0,o=!1!==e.opacity&&void 0;return Array.isArray(e.tintColor)?t=[...e.tintColor]:Fi.isFresnel(e.tintColor)&&(t=Di.toEngine(e.tintColor)),"number"==typeof e.saturation?n=e.saturation/100:Fi.isFresnel(e.saturation)&&(n=Li.toEngine(e.saturation)),"number"==typeof e.brightness?i=e.brightness/100:Fi.isFresnel(e.brightness)&&(i=Li.toEngine(e.brightness)),"number"==typeof e.contrast?s=e.contrast/100:Fi.isFresnel(e.contrast)&&(s=Li.toEngine(e.contrast)),"number"==typeof e.opacity?o=e.opacity/100:Fi.isFresnel(e.opacity)&&(o=Li.toEngine(e.opacity)),{tintColor:t,saturation:n,brightness:i,contrast:s,opacity:o}}static mergeRecipes(e,t){const n=Object.assign({},e);for(const[i,s]of Object.entries(t))void 0!==s&&(n[i]=s);return n}static modifiesSaturation(e){return"number"==typeof e.saturation&&0!==e.saturation||Fi.isFresnel(e.saturation)}static modifiesContrast(e){return"number"==typeof e.contrast&&0!==e.contrast||Fi.isFresnel(e.contrast)}static modifiesBrightness(e){return"number"==typeof e.brightness&&0!==e.brightness||Fi.isFresnel(e.brightness)}static modifiesOpacity(e){return"number"==typeof e.opacity||Fi.isFresnel(e.opacity)}}var Ai,Ri=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},Vi=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const Ni={activeChapterId:void 0,nodeState:void 0,patches:[],patchesForChapter:{}};let Bi=(()=>{let e=Ai=class{constructor(){}static getAllNodeState(e){return e.nodeState}static getActiveChapter(e){return e.activeChapterId}static getPatches(e){return e.patches}static getNodes(e){return void 0===e.activeChapterId||void 0===e.nodeState?{}:e.nodeState[e.activeChapterId]||{}}static getNodePaint(e){return t=>e.nodeState[e.activeChapterId][t].paint}static getNodeIds(e){return Object.keys(Ai.getNodes(e))}static getCheckedNodeIds(e){return Object.values(Ai.getNodes(e)).filter(e=>e.checked).map(e=>e.objectId)}static getCheckedNodes(e){return Ai.getCheckedNodeIds(e).map(t=>e.nodeState[e.activeChapterId][t])}static getUncheckedNodeIds(e){return Ai.getNodeIds(e).filter(t=>!e.nodeState[e.activeChapterId][t].checked)}static getSelectedNode(e){const t=Ai.getNodeIds(e).find(t=>e.nodeState[e.activeChapterId][t].selected);return t?e.nodeState[e.activeChapterId][t]:void 0}reset(e,t){e.patchState(immer.produce(e.getState(),e=>{e.activeChapterId=void 0,e.nodeState=void 0,e.patches=[],e.patchesForChapter={}}))}applyPatch(e,t){const n=immer.applyPatches(e.getState(),t.patches),i=immer.produce(n,e=>{e.patchesForChapter[e.activeChapterId].push(...t.patches),e.patches=t.patches});e.patchState(i)}initNodeState(e,t){e.patchState({nodeState:t.nodeState})}setActiveChapter(e,t){const n=e.getState(),i=immer.produce(n,e=>{e.activeChapterId=t.activeChapterId,e.patchesForChapter[t.activeChapterId]=e.patchesForChapter[t.activeChapterId]||[],e.patches=e.patchesForChapter[t.activeChapterId]});e.patchState(i)}duplicateNodeState(e,t){const n=e.getState(),i=immer.produce(n,e=>{e.nodeState[t.copyChapterId]=e.nodeState[t.originalChapterId],e.patchesForChapter[t.copyChapterId]=e.patchesForChapter[t.originalChapterId].map(e=>(e.path[1]=t.copyChapterId,e))});e.patchState(i)}updateNodesShown(e,t){const n=e.getState(),{finalState:i,patches:s,inversePatches:o}=Ui(n,t);e.patchState(i),t.record&&e.dispatch(new zi.SavePatches([{forward:s,inverse:o,patchAction:Ii.ApplyPatch}]))}updateNodesSelected(e,t){const n=e.getState();if(!n)return;const i=immer.produce(n,e=>{var n,i;const s=null!==(i=null===(n=e.nodeState)||void 0===n?void 0:n[e.activeChapterId])&&void 0!==i?i:{},o=Object.keys(s);switch(t.objectId){case void 0:o.forEach(e=>s[e].selected=!1);break;default:o.forEach(e=>s[e].selected=!1),s[t.objectId].selected=!0}});e.patchState(i)}updateNodesChecked(e,t){const n=e.getState(),[i,s,o]=immer.produceWithPatches(n,e=>{var n,i;const s=null!==(i=null===(n=e.nodeState)||void 0===n?void 0:n[e.activeChapterId])&&void 0!==i?i:{};switch(t.patch){case void 0:(t.objectIds||Object.keys(s)).forEach(e=>{s[e].checked=t.checked,t.objectIds&&Ti(e,s,"checked",t.checked)});break;default:Object.entries(t.patch).forEach(([e,t])=>s[e].checked=t)}}),r=immer.produce(i,e=>{e.patches=s});e.patchState(r)}updateNodesPickable(e,t){const n=e.getState(),[i,s,o]=immer.produceWithPatches(n,e=>{var n,i;const s=null!==(i=null===(n=e.nodeState)||void 0===n?void 0:n[e.activeChapterId])&&void 0!==i?i:{};t.patch?Object.entries(t.patch).forEach(([e,t])=>s[e].pickable=t):(t.objectIds||Object.keys(s)).forEach(e=>{s[e].pickable=t.pickable,t.objectIds&&Ti(e,s,"pickable",t.pickable)})}),r=immer.produce(i,e=>{e.patches=s,e.patchesForChapter[e.activeChapterId].push(...s)});e.patchState(r),e.dispatch(new zi.SavePatches([{forward:s,inverse:o,patchAction:Ii.ApplyPatch}]))}updateNodesPaint(e,t){const n=e.getState(),[i,s,o]=immer.produceWithPatches(n,e=>{var n,i;const s=null!==(i=null===(n=e.nodeState)||void 0===n?void 0:n[e.activeChapterId])&&void 0!==i?i:{},o=t.objectIds||Object.keys(s);t.patch?Object.entries(t.patch).forEach(([e,t])=>{const n=Fi.mergeRecipes(s[e].paint,t);s[e].paint=n}):o.forEach(e=>{const n=Fi.mergeRecipes(s[e].paint,t.recipe);s[e].paint=n,t.objectIds&&Ti(e,s,"paint",n)})}),r=immer.produce(i,e=>{e.patches=s,e.patchesForChapter[e.activeChapterId].push(...s)});e.patchState(r),t.record&&e.dispatch(new zi.SavePatches([{forward:s,inverse:o,patchAction:Ii.ApplyPatch}]))}};return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac}),Ri([Object(d.a)(Ii.Reset),Vi("design:type",Function),Vi("design:paramtypes",[Object,Ii.Reset]),Vi("design:returntype",void 0)],e.prototype,"reset",null),Ri([Object(d.a)(Ii.ApplyPatch),Vi("design:type",Function),Vi("design:paramtypes",[Object,Ii.ApplyPatch]),Vi("design:returntype",void 0)],e.prototype,"applyPatch",null),Ri([Object(d.a)(Ii.InitNodeState),Vi("design:type",Function),Vi("design:paramtypes",[Object,Ii.InitNodeState]),Vi("design:returntype",void 0)],e.prototype,"initNodeState",null),Ri([Object(d.a)(Ii.SetActiveChapter),Vi("design:type",Function),Vi("design:paramtypes",[Object,Ii.SetActiveChapter]),Vi("design:returntype",void 0)],e.prototype,"setActiveChapter",null),Ri([Object(d.a)(Ii.DuplicateNodeState),Vi("design:type",Function),Vi("design:paramtypes",[Object,Ii.DuplicateNodeState]),Vi("design:returntype",void 0)],e.prototype,"duplicateNodeState",null),Ri([Object(d.a)(Ii.UpdateNodesShown),Vi("design:type",Function),Vi("design:paramtypes",[Object,Ii.UpdateNodesShown]),Vi("design:returntype",void 0)],e.prototype,"updateNodesShown",null),Ri([Object(d.a)(Ii.UpdateNodeSelected),Vi("design:type",Function),Vi("design:paramtypes",[Object,Ii.UpdateNodeSelected]),Vi("design:returntype",void 0)],e.prototype,"updateNodesSelected",null),Ri([Object(d.a)(Ii.UpdateNodesChecked),Vi("design:type",Function),Vi("design:paramtypes",[Object,Ii.UpdateNodesChecked]),Vi("design:returntype",void 0)],e.prototype,"updateNodesChecked",null),Ri([Object(d.a)(Ii.UpdateNodesPickable),Vi("design:type",Function),Vi("design:paramtypes",[Object,Ii.UpdateNodesPickable]),Vi("design:returntype",void 0)],e.prototype,"updateNodesPickable",null),Ri([Object(d.a)(Ii.UpdateNodesPaint),Vi("design:type",Function),Vi("design:paramtypes",[Object,Ii.UpdateNodesPaint]),Vi("design:returntype",void 0)],e.prototype,"updateNodesPaint",null),Ri([Object(d.e)(),Vi("design:type",Function),Vi("design:paramtypes",[Mi]),Vi("design:returntype",void 0)],e,"getAllNodeState",null),Ri([Object(d.e)(),Vi("design:type",Function),Vi("design:paramtypes",[Mi]),Vi("design:returntype",void 0)],e,"getActiveChapter",null),Ri([Object(d.e)(),Vi("design:type",Function),Vi("design:paramtypes",[Mi]),Vi("design:returntype",void 0)],e,"getPatches",null),Ri([Object(d.e)(),Vi("design:type",Function),Vi("design:paramtypes",[Mi]),Vi("design:returntype",void 0)],e,"getNodes",null),Ri([Object(d.e)(),Vi("design:type",Function),Vi("design:paramtypes",[Mi]),Vi("design:returntype",void 0)],e,"getNodePaint",null),Ri([Object(d.e)(),Vi("design:type",Function),Vi("design:paramtypes",[Mi]),Vi("design:returntype",void 0)],e,"getNodeIds",null),Ri([Object(d.e)(),Vi("design:type",Function),Vi("design:paramtypes",[Mi]),Vi("design:returntype",void 0)],e,"getCheckedNodeIds",null),Ri([Object(d.e)(),Vi("design:type",Function),Vi("design:paramtypes",[Mi]),Vi("design:returntype",void 0)],e,"getCheckedNodes",null),Ri([Object(d.e)(),Vi("design:type",Function),Vi("design:paramtypes",[Mi]),Vi("design:returntype",void 0)],e,"getUncheckedNodeIds",null),Ri([Object(d.e)(),Vi("design:type",Function),Vi("design:paramtypes",[Mi]),Vi("design:returntype",void 0)],e,"getSelectedNode",null),e=Ai=Ri([Object(d.f)({name:"engineNodes",defaults:Ni})],e),e})();const Hi=new Fi({label:"Original",tintColor:!1,saturation:!1,contrast:!1,brightness:!1,opacity:!1}),Qi=(new Fi({tintColor:[0,0,0],saturation:!1,contrast:!1,brightness:!1,opacity:!1}),new Fi({tintColor:[1,0,0],saturation:!1,contrast:!1,brightness:!1,opacity:!1})),$i=(new Fi({tintColor:[1,1,0],saturation:!1,contrast:!1,brightness:!1,opacity:!1}),new Fi({tintColor:[0,1,0],saturation:!1,contrast:!1,brightness:!1,opacity:!1}),new Fi({tintColor:[0,1,1],saturation:!1,contrast:!1,brightness:!1,opacity:!1}),new Fi({tintColor:[0,0,1],saturation:!1,contrast:!1,brightness:!1,opacity:!1}),new Fi({tintColor:[1,0,1],saturation:!1,contrast:!1,brightness:!1,opacity:!1}),new Fi({label:"Grayscale",tintColor:!1,saturation:-100,contrast:!1,brightness:!1,opacity:!1}),new Fi({label:"Desaturated",tintColor:!1,saturation:-50,contrast:!1,brightness:!1,opacity:!1}),new Fi({label:"Fade",tintColor:[0,0,0],contrast:!1,brightness:55,saturation:-100,opacity:new Li({edge:1,center:0,edgeBias:0,centerBias:1,power:1})}));class qi{constructor(e={}){const{tintColor:t,saturation:n,contrast:i,brightness:s,opacity:o}=e;this.tintColor=t,this.saturation=n,this.contrast=i,this.brightness=s,this.opacity=o}static isFresnel(e){return Array.isArray(e)&&5===e.length}static isColor(e){return Array.isArray(e)&&3===e.length}static isEqual(e,t){return!(!e||!t)&&JSON.stringify(e,Object.keys(e).sort())===JSON.stringify(t,Object.keys(t).sort())}static isRealRecipe(e){return!Object(D.isNil)(e)&&(!Object(D.isNil)(e.brightness)&&!1!==e.brightness||!Object(D.isNil)(e.contrast)&&!1!==e.contrast||!Object(D.isNil)(e.opacity)&&!1!==e.opacity||!Object(D.isNil)(e.saturation)&&!1!==e.saturation||!Object(D.isNil)(e.tintColor)&&!1!==e.tintColor)}static compare(e,t){try{const n=qi.hue(e),i=qi.hue(t),s=!1===e.opacity?1:e.opacity,o=!1===t.opacity?1:t.opacity;return n===i?s===o?e.saturation===t.saturation?e.brightness===t.brightness?e.contrast>t.contrast?n+4:n-4:e.brightness>t.brightness?n+3:n-3:e.saturation>t.saturation?n+2:n-2:s>o?n+1:n-1:n-i}catch(n){return 0}}static hue(e){if(!e.tintColor)return-10;const t=e.tintColor[0],n=e.tintColor[1],i=e.tintColor[2],s=Math.max(t,n,i),o=s-Math.min(t,n,i);let r=0;return r=s===t?(n-i)/o:s===n?2+(i-t)/o:4+(t-n)/o,r*=60,r<0&&(r+=360),r}static generateUniqueRecipes(e){const t=[];return e.forEach(e=>{-1===qi.recipeIndexOf(t,e)&&t.push(e)}),t}static recipeIndexOf(e,t){return e.findIndex(e=>qi.isEqual(e,t))}}function Wi(e,t,n){const i=Dt.getSuccessors(e,t);if(0===i.length)return!1;for(const s of i)if(!0===n[s])return!0;return i.some(t=>Wi(e,t,n))}function Ki(e,t,n){switch(n[t]){case!0:return!0;case!1:return!1;case void 0:{const i=Dt.getAncestor(e,t);return!!i&&Ki(e,i,n)}}}var Gi,Zi,Ji;!function(e){class t{constructor(e,t,n){this.particleSystems=e,this.assignedParticles=t,this.tweenParticleLookup=n}}t.type="[Engine Particles] Set Particle State",e.SetParticleState=t;class n{constructor(e,t){this.particleSystem=e,this.chapterId=t}}n.type="[Engine Particles] New Particle System",e.NewParticleSystem=n;class i{constructor(e,t){this.id=e,this.targetChapterId=t}}i.type="[Engine Particles] Duplicate Particle System",e.DuplicateParticleSystem=i;class s{constructor(e,t){this.id=e,this.targetChapterId=t}}s.type="[Engine Particles] Duplicate Particle System Success",e.DuplicateParticleSystemSuccess=s;class o{constructor(e,t){this.id=e,this.particleSystem=t}}o.type="[Engine Particles] Update Particle System",e.UpdateParticleSystem=o;class r{constructor(e,t){this.visible=e,this.chapterId=t}}r.type="[Engine Particles] Set Particle Systems Visible",e.SetParticleSystemsVisible=r;class a{constructor(e,t,n){this.id=e,this.visible=t,this.chapterId=n}}a.type="[Engine Particles] Set Particle System Visible",e.SetParticleSystemVisible=a;class c{constructor(e,t){this.id=e,this.chapterId=t}}c.type="[Engine Particles] Assign Particle",e.AssignParticle=c;class l{constructor(e,t){this.id=e,this.chapterId=t}}l.type="[Engine Particles] Unassign Particle",e.UnassignParticle=l;class p{constructor(e){this.id=e}}p.type="[Engine Partiles] Delete Particle System",e.DeleteParticleSystem=p;class d{constructor(e){this.id=e}}d.type="[Engine Partiles] Select Particle System",e.SelectParticleSystem=d;class u{constructor(e){this.index=e}}u.type="[Engine Partiles] Select Particle Constraint",e.SelectParticleConstraint=u;class g{constructor(e){this.index=e}}g.type="[Engine Partiles] Select Particle Creator",e.SelectParticleCreator=g;class h{constructor(e){this.index=e}}h.type="[Engine Partiles] Select Particle Updater",e.SelectParticleUpdater=h;class b{constructor(e){this.chapterMap=e}}b.type="[Engine Particles] Update Lookup Chapters",e.UpdateTweenParticleLookupChapters=b;class m{constructor(e,t){this.chapterId=e,this.lookup=t}}m.type="[Engine Particles] Set Lookup for chapter",e.SetLookupForChapter=m;class f{constructor(e){this.chapterId=e}}f.type="[Engine Particles] Delete chapter lookup",e.DeleteChapterLookup=f;class y{constructor(e){this.patches=e}}y.type="[Engine Particles] Apply Patch",e.ApplyPatch=y}(Gi||(Gi={})),function(e){e.updateChapterIds=function(e,t){return Object.keys(e).reduce((n,i)=>(n[t[i]]=e[i],n),{})},e.duplicateChapter=function(e,t,n){return Object.assign(Object.assign({},n),{[t]:n[e]})},e.deleteChapter=function(e,t){const n=Object.assign({},t);return delete n[e],n},e.addEntryForChapter=function(e,t,n){return n[e]=Object.assign(Object.assign({},n[e]),t),n},e.refreshEngineLookup=function(e,t){Human.modules.moduleData[e].tweenParticleLookup=t}}(Zi||(Zi={})),function(e){function t(e){return e.split("-")[0].replace(/_particle$/,"")}e.getParticleIdRoot=t,e.generateParticleId=function(e,n=yi.getUuid){return`${t(e)}-${n()}`}}(Ji||(Ji={}));var Xi,Yi=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},es=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let ts=(()=>{let e=Xi=class{constructor(){}static particleSystemIdExists(e){return Object(d.h)([Xi],t=>void 0!==t.particleSystems[e])}static particleSystemsForChapter(e){return Object(d.h)([Xi],t=>(t.assignedParticles[e]||[]).map(e=>t.particleSystems[e]))}static getVisibleParticleSystesmForChapter(e){return Object(d.h)([Xi],t=>{const n=t.visibleParticleSystems[e]||{};return(t.assignedParticles[e]||[]).filter(e=>!1!==n[e])})}static getTweenParticleLookup(e){return e.tweenParticleLookup}static getParticleSystems(e){return e.particleSystems}static getVisisbleParticleSystems(e){return e.visibleParticleSystems}static getParticleSystemsList(e){return Object.values(e.particleSystems)}static getAssignedParticleSystems(e){return e.assignedParticles}static getSelectedParticleSystemId(e){return e.particleSelection.selectedParticle}static getSelectedParticleSystem(e){const{particleSystems:t,particleSelection:n}=e;return t[n.selectedParticle]}static getSelectedParticleConstraintIndex(e){return e.particleSelection.selectedConstraint}static getSelectedParticleConstraint(e){const t=Xi.getSelectedParticleSystem(e);return t?t.constraints[e.particleSelection.selectedConstraint]:null}static getSelectedParticleCreatorIndex(e){return e.particleSelection.selectedCreator}static getSelectedParticleCreator(e){const t=Xi.getSelectedParticleSystem(e);return t?t.creators[e.particleSelection.selectedCreator]:null}static getSelectedParticleUpdaterIndex(e){return e.particleSelection.selectedUpdater}static getSelectedParticleUpdater(e){const t=Xi.getSelectedParticleSystem(e);return t?t.updaters[e.particleSelection.selectedUpdater]:null}applyPatch(e,t){const n=immer.applyPatches(e.getState(),t.patches);e.patchState(n)}setParticleState(e,t){e.patchState(immer.produce(e.getState(),e=>{e.particleSystems=t.particleSystems.reduce((e,t)=>(e[t.id]=t,e),{}),e.assignedParticles=t.assignedParticles,e.tweenParticleLookup=t.tweenParticleLookup,e.visibleParticleSystems={}}))}setParticlesVisible(e,{visible:t,chapterId:n}){e.patchState(immer.produce(e.getState(),e=>{const i=(e.assignedParticles[n]||[]).reduce((e,n)=>(e[n]=t,e),{});e.visibleParticleSystems=Object.assign(Object.assign({},e.visibleParticleSystems),{[n]:i})}))}setParticleVisible(e,{id:t,visible:n,chapterId:i}){e.patchState(immer.produce(e.getState(),e=>{e.visibleParticleSystems[i]=Object.assign(Object.assign({},e.visibleParticleSystems[i]||{}),{[t]:n})}))}newParticleSystem(e,t){const{particleSystem:n,chapterId:i}=t,s=n.id,[o,r,a]=immer.produceWithPatches(e.getState(),e=>{e.particleSystems[s]=n,e.assignedParticles[i]=[...e.assignedParticles[i]||[],s]});e.patchState(o)}duplicateParticleSystem(e,t){const{id:n,targetChapterId:i}=t,s=Ji.generateParticleId(n);e.patchState(immer.produce(e.getState(),e=>{e.particleSystems[s]=JSON.parse(JSON.stringify(e.particleSystems[n])),e.particleSystems[s].id=s,e.assignedParticles[i].push(s);const t=Ji.getParticleIdRoot(n);e.tweenParticleLookup[i]&&e.tweenParticleLookup[i][t]&&(e.tweenParticleLookup=Zi.addEntryForChapter(i,{[t]:s},e.tweenParticleLookup))})),e.dispatch(new Gi.DuplicateParticleSystemSuccess(s,i))}updateParticleSystem(e,t){const n=immer.produce(e.getState(),e=>{e.particleSystems[t.id]=t.particleSystem});e.patchState(Object.assign(Object.assign({},n),{particleSystems:Object.assign({},n.particleSystems)}))}deleteChapterLookup(e,t){e.patchState(immer.produce(e.getState(),e=>{delete e.tweenParticleLookup[t.chapterId]}))}setLookupForChapter(e,t){e.patchState(immer.produce(e.getState(),e=>{e.tweenParticleLookup[t.chapterId]=t.lookup}))}assignParticle(e,t){e.patchState(immer.produce(e.getState(),e=>{const n=e.assignedParticles[t.chapterId]||[],i=Ji.getParticleIdRoot(t.id);e.assignedParticles[t.chapterId]=n.concat(t.id),e.tweenParticleLookup=Zi.addEntryForChapter(t.chapterId,{[i]:t.id},e.tweenParticleLookup),e.particleSystems=Object.assign({},e.particleSystems)}))}unassignParticle(e,t){e.patchState(immer.produce(e.getState(),e=>{const n=e.assignedParticles[t.chapterId]||[],i=Ji.getParticleIdRoot(t.id);e.assignedParticles[t.chapterId]=n.filter(e=>e!==t.id),e.tweenParticleLookup[t.chapterId]&&delete e.tweenParticleLookup[t.chapterId][i],e.particleSystems=Object.assign({},e.particleSystems)}))}deleteParticleSystem(e,t){e.patchState(immer.produce(e.getState(),e=>{delete e.particleSystems[t.id],Object.keys(e.assignedParticles).forEach(n=>{e.assignedParticles[n]=e.assignedParticles[n].filter(e=>e!==t.id)}),Object.keys(e.tweenParticleLookup).forEach(n=>{delete e.tweenParticleLookup[n][Ji.getParticleIdRoot(t.id)]})}))}selectParticleSystem(e,t){e.patchState(immer.produce(e.getState(),e=>{e.particleSelection={selectedParticle:t.id}}))}selectParticleConstraint(e,t){const n=e.getState().particleSelection;e.patchState(immer.produce(e.getState(),e=>{e.particleSelection=Object.assign(Object.assign({},n),{selectedConstraint:t.index})}))}selectParticleCreator(e,t){const n=e.getState().particleSelection;e.patchState(immer.produce(e.getState(),e=>{e.particleSelection=Object.assign(Object.assign({},n),{selectedCreator:t.index})}))}selectParticleUpdater(e,t){const n=e.getState().particleSelection;e.patchState(immer.produce(e.getState(),e=>{e.particleSelection=Object.assign(Object.assign({},n),{selectedUpdater:t.index})}))}updateTweenParticleLookupChapters(e,t){e.patchState(immer.produce(e.getState(),e=>{e.tweenParticleLookup=Zi.updateChapterIds(e.tweenParticleLookup,t.chapterMap)}))}};return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac}),Yi([Object(d.a)(Gi.ApplyPatch),es("design:type",Function),es("design:paramtypes",[Object,Gi.ApplyPatch]),es("design:returntype",void 0)],e.prototype,"applyPatch",null),Yi([Object(d.a)(Gi.SetParticleState),es("design:type",Function),es("design:paramtypes",[Object,Gi.SetParticleState]),es("design:returntype",void 0)],e.prototype,"setParticleState",null),Yi([Object(d.a)(Gi.SetParticleSystemsVisible),es("design:type",Function),es("design:paramtypes",[Object,Gi.SetParticleSystemsVisible]),es("design:returntype",void 0)],e.prototype,"setParticlesVisible",null),Yi([Object(d.a)(Gi.SetParticleSystemVisible),es("design:type",Function),es("design:paramtypes",[Object,Gi.SetParticleSystemVisible]),es("design:returntype",void 0)],e.prototype,"setParticleVisible",null),Yi([Object(d.a)(Gi.NewParticleSystem),es("design:type",Function),es("design:paramtypes",[Object,Gi.NewParticleSystem]),es("design:returntype",void 0)],e.prototype,"newParticleSystem",null),Yi([Object(d.a)(Gi.DuplicateParticleSystem),es("design:type",Function),es("design:paramtypes",[Object,Gi.DuplicateParticleSystem]),es("design:returntype",void 0)],e.prototype,"duplicateParticleSystem",null),Yi([Object(d.a)(Gi.UpdateParticleSystem),es("design:type",Function),es("design:paramtypes",[Object,Gi.UpdateParticleSystem]),es("design:returntype",void 0)],e.prototype,"updateParticleSystem",null),Yi([Object(d.a)(Gi.DeleteChapterLookup),es("design:type",Function),es("design:paramtypes",[Object,Gi.DeleteChapterLookup]),es("design:returntype",void 0)],e.prototype,"deleteChapterLookup",null),Yi([Object(d.a)(Gi.SetLookupForChapter),es("design:type",Function),es("design:paramtypes",[Object,Gi.SetLookupForChapter]),es("design:returntype",void 0)],e.prototype,"setLookupForChapter",null),Yi([Object(d.a)(Gi.AssignParticle),es("design:type",Function),es("design:paramtypes",[Object,Gi.AssignParticle]),es("design:returntype",void 0)],e.prototype,"assignParticle",null),Yi([Object(d.a)(Gi.UnassignParticle),es("design:type",Function),es("design:paramtypes",[Object,Gi.UnassignParticle]),es("design:returntype",void 0)],e.prototype,"unassignParticle",null),Yi([Object(d.a)(Gi.DeleteParticleSystem),es("design:type",Function),es("design:paramtypes",[Object,Gi.DeleteParticleSystem]),es("design:returntype",void 0)],e.prototype,"deleteParticleSystem",null),Yi([Object(d.a)(Gi.SelectParticleSystem),es("design:type",Function),es("design:paramtypes",[Object,Gi.SelectParticleSystem]),es("design:returntype",void 0)],e.prototype,"selectParticleSystem",null),Yi([Object(d.a)(Gi.SelectParticleConstraint),es("design:type",Function),es("design:paramtypes",[Object,Gi.SelectParticleConstraint]),es("design:returntype",void 0)],e.prototype,"selectParticleConstraint",null),Yi([Object(d.a)(Gi.SelectParticleCreator),es("design:type",Function),es("design:paramtypes",[Object,Gi.SelectParticleCreator]),es("design:returntype",void 0)],e.prototype,"selectParticleCreator",null),Yi([Object(d.a)(Gi.SelectParticleUpdater),es("design:type",Function),es("design:paramtypes",[Object,Gi.SelectParticleUpdater]),es("design:returntype",void 0)],e.prototype,"selectParticleUpdater",null),Yi([Object(d.a)(Gi.UpdateTweenParticleLookupChapters),es("design:type",Function),es("design:paramtypes",[Object,Gi.UpdateTweenParticleLookupChapters]),es("design:returntype",void 0)],e.prototype,"updateTweenParticleLookupChapters",null),Yi([Object(d.e)(),es("design:type",Function),es("design:paramtypes",[Object]),es("design:returntype",void 0)],e,"getTweenParticleLookup",null),Yi([Object(d.e)(),es("design:type",Function),es("design:paramtypes",[Object]),es("design:returntype",void 0)],e,"getParticleSystems",null),Yi([Object(d.e)(),es("design:type",Function),es("design:paramtypes",[Object]),es("design:returntype",void 0)],e,"getVisisbleParticleSystems",null),Yi([Object(d.e)(),es("design:type",Function),es("design:paramtypes",[Object]),es("design:returntype",void 0)],e,"getParticleSystemsList",null),Yi([Object(d.e)(),es("design:type",Function),es("design:paramtypes",[Object]),es("design:returntype",void 0)],e,"getAssignedParticleSystems",null),Yi([Object(d.e)(),es("design:type",Function),es("design:paramtypes",[Object]),es("design:returntype",void 0)],e,"getSelectedParticleSystemId",null),Yi([Object(d.e)(),es("design:type",Function),es("design:paramtypes",[Object]),es("design:returntype",void 0)],e,"getSelectedParticleSystem",null),Yi([Object(d.e)(),es("design:type",Function),es("design:paramtypes",[Object]),es("design:returntype",void 0)],e,"getSelectedParticleConstraintIndex",null),Yi([Object(d.e)(),es("design:type",Function),es("design:paramtypes",[Object]),es("design:returntype",void 0)],e,"getSelectedParticleConstraint",null),Yi([Object(d.e)(),es("design:type",Function),es("design:paramtypes",[Object]),es("design:returntype",void 0)],e,"getSelectedParticleCreatorIndex",null),Yi([Object(d.e)(),es("design:type",Function),es("design:paramtypes",[Object]),es("design:returntype",void 0)],e,"getSelectedParticleCreator",null),Yi([Object(d.e)(),es("design:type",Function),es("design:paramtypes",[Object]),es("design:returntype",void 0)],e,"getSelectedParticleUpdaterIndex",null),Yi([Object(d.e)(),es("design:type",Function),es("design:paramtypes",[Object]),es("design:returntype",void 0)],e,"getSelectedParticleUpdater",null),e=Xi=Yi([Object(d.f)({name:"engineParticles",defaults:{particleSelection:{},particleSystems:{},visibleParticleSystems:{},assignedParticles:{},tweenParticleLookup:{}}})],e),e})();var ns;!function(e){class t{constructor(e){this.quizState=e}}t.type="[Quiz] Set Quiz State",e.SetQuizState=t;class n{constructor(){}}n.type="[Quiz] Reset Quiz State",e.ResetQuizState=n;class i{constructor(e){this.quizSettings=e}}i.type="[Quiz] Set Quiz Settings",e.SetQuizSettings=i;class s{constructor(e){this.active=e}}s.type="[Quiz] Set Quiz Active",e.SetQuizActive=s;class o{constructor(e){this.enabled=e}}o.type="[Quiz] Set Quiz Enabled",e.SetQuizEnabled=o;class r{constructor(e){this.locked=e}}r.type="[Quiz] Set Quiz Locked",e.SetQuizLocked=r;class a{constructor(e){this.enable=e}}a.type="[Quiz] Set Enable Quiz Retake",e.SetEnableQuizRetake=a;class c{constructor(e){this.mode=e}}c.type="[Quiz] Set Quiz Questions Mode",e.SetQuizQuestionsMode=c;class l{constructor(e,t){this.sourceChapterId=e,this.targetChapterId=t}}l.type="[Quiz] Copy Quiz Questions",e.CopyQuestions=l;class p{constructor(e){this.chapterIds=e}}p.type="[Quiz] Reoder Quiz Questions",e.ReorderQuestions=p;class d{constructor(e){this.question=e}}d.type="[Quiz] Add Quiz Question",e.AddQuestion=d;class u{constructor(e){this.questions=e}}u.type="[Quiz] Set Quiz Questions",e.SetQuestions=u;class g{constructor(e){this.questionIds=e}}g.type="[Quiz] Remove Quiz Questions",e.RemoveQuestions=g;class h{constructor(e){this.question=e}}h.type="[Quiz] Set Quiz Question",e.SetQuestion=h;class b{constructor(e){this.submission=e}}b.type="[Quiz] Submit Question Answer",e.SubmitQuestionAnswer=b;class m{constructor(){}}m.type="[Quiz] Advance Question",e.NextQuestion=m;class f{constructor(){}}f.type="[Quiz] Previous Question",e.PreviousQuestion=f;class y{constructor(){}}y.type="[Quiz] Clear Submissions",e.ClearSubmissions=y;class x{constructor(e){this.questionId=e}}x.type="[Quiz] Set Active Question",e.SetActiveQuestion=x;class v{constructor(e){this.pickMode=e}}v.type="[Quiz] Set Pick Mode",e.SetQuizPickMode=v;class O{constructor(e){this.submission=e}}O.type="[Quiz] Set Active QuestionAnswer",e.SetActiveSubmission=O;class w{constructor(e){this.lifecycle=e}}w.type="[Quiz] Set Quiz Lifecycle",e.SetQuizLifecycle=w}(ns||(ns={}));var is=function(e){return e.Markdown="markdown",e.Images="images",e.Ticker="ticker",e}({}),ss=function(e){return e.MultipleChoice="multiple-choice",e.SelectAnatomy="select-anatomy",e.LabelAnatomy="label-anatomy",e.Instructions="text-only",e}({});const os={[ss.MultipleChoice]:"Multiple Choice",[ss.SelectAnatomy]:"Select Anatomy in 3D",[ss.LabelAnatomy]:"Label Anatomy",[ss.Instructions]:"Instructions"};function rs(e){const t=e.map(e=>(e.quizQuestions||[]).map(t=>Object.assign(Object.assign({},t),{chapterId:t.chapterId||e.id})));return[].concat(...t)}function as(e){return"string"==typeof e.data.correctAnswer?[e.data.correctAnswer]:e.data.correctAnswer}function cs(e,t){const n=as(e);switch(e.type){case ss.LabelAnatomy:return Object(D.isEqual)(n,t);case ss.MultipleChoice:return Object(D.isEqual)(n.sort(),t.sort());case ss.SelectAnatomy:if(void 0===e.data.selectType||"all"===e.data.selectType)return Object(D.isEqual)(n.sort(),t.sort());if("any"===e.data.selectType)return 0===Object(D.difference)(t,n).length&&t.length>0}}function ls(e,t){const n=e.filter(e=>e.type!==ss.Instructions),i=e.reduce((e,n)=>(e[n.id]=function(e,t){const n=e.find(e=>e.questionId===t);return n?n.answer:void 0}(t,n.id),e),{}),s=e.reduce((e,t)=>(e[t.id]=as(t),e),{}),o=n.filter(e=>{const t=i[e.id];return cs(e,void 0===t?[]:"string"==typeof t?[t]:t)}),r=e.length,a=n.length,c=o.length,l=r-c;return{score:r>0?Math.round(c/a*100):0,total:r,scorableTotal:a,correctTotal:c,incorrectTotal:l,questionAnswers:i,correctQuestionAnswers:s}}var ps,ds=function(e){return e[e.Question=0]="Question",e[e.Explanation=1]="Explanation",e[e.Review=2]="Review",e}({}),us=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},gs=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},hs=function(e){return e[e.Learning=0]="Learning",e[e.Assessment=1]="Assessment",e}({});const bs={quizModeActive:!1,quizModeLocked:!1,quizQuestionsMode:"all",enableQuizRetake:!0,launchMode:hs.Learning,questions:[],activeQuestionId:void 0,activeSubmission:void 0,questionSubmissions:[],quizSettings:{enabled:!0,showSummary:!0,showExplanation:!0,showSubmit:!0,showProgress:!0},pickMode:"single",lifecycle:ds.Question};function ms(e,t){return e.filter(e=>e.chapterId===t)}function fs(e,t){const n=t.map(t=>ms(e,t));return[].concat(...n)}function ys(e){const t=function(e){return[...new Set(e.map(e=>e.chapterId))]}(e);return fs(e,t)}let xs=(()=>{let e=ps=class{static getQuizQuestionsByChapter(e){return Object(d.h)([ps],t=>ms(t.questions,e))}static getLifecycle(e){return e.lifecycle}static getQuizSettings(e){return e.quizSettings}static getQuizModeActive(e){return e.quizModeActive}static getQuizModeLocked(e){return e.quizModeLocked}static getEnableQuizRetake(e){return e.enableQuizRetake}static getQuizReviewEnabled(e){const{quizModeLocked:t,quizQuestionsMode:n,questions:i,quizSettings:s}=e;return!(t&&!s.showSummary||t&&"restricted"===n&&1===i.length)}static globalSceneConfig(e){return e.sceneConfig}static hasQuiz(e){return e.questions.length>0}static getQuizEnabled(e){return!1!==e.quizSettings.enabled}static getAllQuestions(e){return e.questions}static getAllSubmissions(e){return e.questionSubmissions}static getActiveSubmitted(e){const{questionSubmissions:t,activeQuestionId:n}=e;return t.find(e=>e.questionId===n)}static getActiveSubmission(e){return e.activeSubmission}static getActiveQuestion(e){return e.questions.find(t=>t.id===e.activeQuestionId)}static getActiveQuestionId(e){return e.activeQuestionId}static getActiveQuestionLabels(e){const t=e.questions.find(t=>t.id===e.activeQuestionId);return t&&t.type===ss.LabelAnatomy?t.data.options:[]}static getActiveQuestionIndex(e){return e.questions.findIndex(t=>t.id===e.activeQuestionId)}static getQuestionIndex(e,t){return Object(d.h)([ps],n=>fs(n.questions,e).findIndex(e=>e.id===t))}static getQuestionTotal(e){return e.questions.length}static getCorrectAnswerTotal(e){const{questionSubmissions:t,questions:n}=e;return t.filter(e=>cs(n.find(t=>t.id===e.questionId),e.answer)).length}static getQuestionsRemaining(e){const{questions:t,questionSubmissions:n}=e;return t.length-n.length}static hasQuestionRemaining(e){const{questions:t,questionSubmissions:n}=e;return n.length<t.length}static getPickMode(e){return e.pickMode}resetQuizState(e,t){e.setState(Object.assign({},bs))}setQuizState(e,{quizState:t}){e.setState(Object.assign(Object.assign({},bs),t))}setQuizSettings(e,{quizSettings:t}){e.patchState({quizSettings:t})}setQuizActive(e,t){e.patchState({quizModeActive:t.active,activeQuestionId:!1===t.active?void 0:e.getState().activeQuestionId})}setQuizEnabled(e,t){const n=e.getState().quizSettings;e.patchState({quizSettings:Object.assign(Object.assign({},n),{enabled:t.enabled})})}setQuizLocked(e,t){e.patchState({quizModeLocked:t.locked})}setEnableQuizRetake(e,t){e.patchState({enableQuizRetake:t.enable})}setQuizQuestionsMode(e,t){e.patchState({quizQuestionsMode:t.mode})}copyQuestions(e,{sourceChapterId:t,targetChapterId:n}){const{questions:i}=e.getState(),s=[...i,...ms(e.getState().questions,t).map(e=>Object.assign(Object.assign({},JSON.parse(JSON.stringify(e))),{id:yi.idWithPrefix("question"),chapterId:n}))];e.patchState({questions:ys(s)})}reorderQuestions(e,{chapterIds:t}){e.patchState({questions:fs(e.getState().questions,t)})}addQuestion(e,t){const n=[...e.getState().questions,t.question];e.patchState({questions:ys(n)})}setQuestions(e,{questions:t}){e.patchState({questions:ys(t)})}setQuestion(e,t){const n=e.getState().questions.map(e=>e.id===t.question.id?t.question:e);e.patchState({questions:n})}removeQuestions(e,t){const n=e.getState(),i=null!=t.questionIds?t.questionIds:n.questions.map(e=>e.id),s=n.questions.filter(e=>!i.includes(e.id));e.patchState({questions:ys(s)})}submitQuestionAnswer(e,t){const n=[...e.getState().questionSubmissions],i=n.findIndex(e=>e.questionId===t.submission.questionId);i>-1?n[i]=t.submission:n.push(t.submission),e.patchState({questionSubmissions:n})}nextQuestion(e){var t;const{questions:n,activeQuestionId:i}=e.getState(),s=(null===(t=n[e.getState().questions.findIndex(e=>e.id===i)+1])||void 0===t?void 0:t.id)||void 0;void 0!==s&&e.patchState({activeQuestionId:s})}previousQuestion(e){var t;const{questions:n,activeQuestionId:i}=e.getState(),s=(null===(t=n[e.getState().questions.findIndex(e=>e.id===i)-1])||void 0===t?void 0:t.id)||void 0;void 0!==s&&e.patchState({activeQuestionId:s})}clearSubmissions(e){e.patchState({questionSubmissions:[]})}setActiveQuestion(e,t){e.patchState({activeQuestionId:t.questionId})}setQuizPickMode(e,{pickMode:t}){e.patchState({pickMode:t})}setActiveSubmission(e,{submission:t}){e.patchState({activeSubmission:t})}setQuizLifecycle(e,t){e.patchState({lifecycle:t.lifecycle})}};return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac}),us([Object(d.a)(ns.ResetQuizState),gs("design:type",Function),gs("design:paramtypes",[Object,ns.ResetQuizState]),gs("design:returntype",void 0)],e.prototype,"resetQuizState",null),us([Object(d.a)(ns.SetQuizState),gs("design:type",Function),gs("design:paramtypes",[Object,ns.SetQuizState]),gs("design:returntype",void 0)],e.prototype,"setQuizState",null),us([Object(d.a)(ns.SetQuizSettings),gs("design:type",Function),gs("design:paramtypes",[Object,ns.SetQuizSettings]),gs("design:returntype",void 0)],e.prototype,"setQuizSettings",null),us([Object(d.a)(ns.SetQuizActive),gs("design:type",Function),gs("design:paramtypes",[Object,ns.SetQuizActive]),gs("design:returntype",void 0)],e.prototype,"setQuizActive",null),us([Object(d.a)(ns.SetQuizEnabled),gs("design:type",Function),gs("design:paramtypes",[Object,ns.SetQuizEnabled]),gs("design:returntype",void 0)],e.prototype,"setQuizEnabled",null),us([Object(d.a)(ns.SetQuizLocked),gs("design:type",Function),gs("design:paramtypes",[Object,ns.SetQuizLocked]),gs("design:returntype",void 0)],e.prototype,"setQuizLocked",null),us([Object(d.a)(ns.SetEnableQuizRetake),gs("design:type",Function),gs("design:paramtypes",[Object,ns.SetEnableQuizRetake]),gs("design:returntype",void 0)],e.prototype,"setEnableQuizRetake",null),us([Object(d.a)(ns.SetQuizQuestionsMode),gs("design:type",Function),gs("design:paramtypes",[Object,ns.SetQuizQuestionsMode]),gs("design:returntype",void 0)],e.prototype,"setQuizQuestionsMode",null),us([Object(d.a)(ns.CopyQuestions),gs("design:type",Function),gs("design:paramtypes",[Object,ns.CopyQuestions]),gs("design:returntype",void 0)],e.prototype,"copyQuestions",null),us([Object(d.a)(ns.ReorderQuestions),gs("design:type",Function),gs("design:paramtypes",[Object,ns.ReorderQuestions]),gs("design:returntype",void 0)],e.prototype,"reorderQuestions",null),us([Object(d.a)(ns.AddQuestion),gs("design:type",Function),gs("design:paramtypes",[Object,ns.AddQuestion]),gs("design:returntype",void 0)],e.prototype,"addQuestion",null),us([Object(d.a)(ns.SetQuestions),gs("design:type",Function),gs("design:paramtypes",[Object,ns.SetQuestions]),gs("design:returntype",void 0)],e.prototype,"setQuestions",null),us([Object(d.a)(ns.SetQuestion),gs("design:type",Function),gs("design:paramtypes",[Object,ns.SetQuestion]),gs("design:returntype",void 0)],e.prototype,"setQuestion",null),us([Object(d.a)(ns.RemoveQuestions),gs("design:type",Function),gs("design:paramtypes",[Object,ns.RemoveQuestions]),gs("design:returntype",void 0)],e.prototype,"removeQuestions",null),us([Object(d.a)(ns.SubmitQuestionAnswer),gs("design:type",Function),gs("design:paramtypes",[Object,ns.SubmitQuestionAnswer]),gs("design:returntype",void 0)],e.prototype,"submitQuestionAnswer",null),us([Object(d.a)(ns.NextQuestion),gs("design:type",Function),gs("design:paramtypes",[Object]),gs("design:returntype",void 0)],e.prototype,"nextQuestion",null),us([Object(d.a)(ns.PreviousQuestion),gs("design:type",Function),gs("design:paramtypes",[Object]),gs("design:returntype",void 0)],e.prototype,"previousQuestion",null),us([Object(d.a)(ns.ClearSubmissions),gs("design:type",Function),gs("design:paramtypes",[Object]),gs("design:returntype",void 0)],e.prototype,"clearSubmissions",null),us([Object(d.a)(ns.SetActiveQuestion),gs("design:type",Function),gs("design:paramtypes",[Object,ns.SetActiveQuestion]),gs("design:returntype",void 0)],e.prototype,"setActiveQuestion",null),us([Object(d.a)(ns.SetQuizPickMode),gs("design:type",Function),gs("design:paramtypes",[Object,ns.SetQuizPickMode]),gs("design:returntype",void 0)],e.prototype,"setQuizPickMode",null),us([Object(d.a)(ns.SetActiveSubmission),gs("design:type",Function),gs("design:paramtypes",[Object,ns.SetActiveSubmission]),gs("design:returntype",void 0)],e.prototype,"setActiveSubmission",null),us([Object(d.a)(ns.SetQuizLifecycle),gs("design:type",Function),gs("design:paramtypes",[Object,ns.SetQuizLifecycle]),gs("design:returntype",void 0)],e.prototype,"setQuizLifecycle",null),us([Object(d.e)(),gs("design:type",Function),gs("design:paramtypes",[Object]),gs("design:returntype",void 0)],e,"getLifecycle",null),us([Object(d.e)(),gs("design:type",Function),gs("design:paramtypes",[Object]),gs("design:returntype",Object)],e,"getQuizSettings",null),us([Object(d.e)(),gs("design:type",Function),gs("design:paramtypes",[Object]),gs("design:returntype",void 0)],e,"getQuizModeActive",null),us([Object(d.e)(),gs("design:type",Function),gs("design:paramtypes",[Object]),gs("design:returntype",void 0)],e,"getQuizModeLocked",null),us([Object(d.e)(),gs("design:type",Function),gs("design:paramtypes",[Object]),gs("design:returntype",void 0)],e,"getEnableQuizRetake",null),us([Object(d.e)(),gs("design:type",Function),gs("design:paramtypes",[Object]),gs("design:returntype",Boolean)],e,"getQuizReviewEnabled",null),us([Object(d.e)(),gs("design:type",Function),gs("design:paramtypes",[Object]),gs("design:returntype",void 0)],e,"globalSceneConfig",null),us([Object(d.e)(),gs("design:type",Function),gs("design:paramtypes",[Object]),gs("design:returntype",void 0)],e,"hasQuiz",null),us([Object(d.e)(),gs("design:type",Function),gs("design:paramtypes",[Object]),gs("design:returntype",void 0)],e,"getQuizEnabled",null),us([Object(d.e)(),gs("design:type",Function),gs("design:paramtypes",[Object]),gs("design:returntype",void 0)],e,"getAllQuestions",null),us([Object(d.e)(),gs("design:type",Function),gs("design:paramtypes",[Object]),gs("design:returntype",void 0)],e,"getAllSubmissions",null),us([Object(d.e)(),gs("design:type",Function),gs("design:paramtypes",[Object]),gs("design:returntype",void 0)],e,"getActiveSubmitted",null),us([Object(d.e)(),gs("design:type",Function),gs("design:paramtypes",[Object]),gs("design:returntype",void 0)],e,"getActiveSubmission",null),us([Object(d.e)(),gs("design:type",Function),gs("design:paramtypes",[Object]),gs("design:returntype",void 0)],e,"getActiveQuestion",null),us([Object(d.e)(),gs("design:type",Function),gs("design:paramtypes",[Object]),gs("design:returntype",void 0)],e,"getActiveQuestionId",null),us([Object(d.e)(),gs("design:type",Function),gs("design:paramtypes",[Object]),gs("design:returntype",Array)],e,"getActiveQuestionLabels",null),us([Object(d.e)(),gs("design:type",Function),gs("design:paramtypes",[Object]),gs("design:returntype",void 0)],e,"getActiveQuestionIndex",null),us([Object(d.e)(),gs("design:type",Function),gs("design:paramtypes",[Object]),gs("design:returntype",void 0)],e,"getQuestionTotal",null),us([Object(d.e)(),gs("design:type",Function),gs("design:paramtypes",[Object]),gs("design:returntype",void 0)],e,"getCorrectAnswerTotal",null),us([Object(d.e)(),gs("design:type",Function),gs("design:paramtypes",[Object]),gs("design:returntype",void 0)],e,"getQuestionsRemaining",null),us([Object(d.e)(),gs("design:type",Function),gs("design:paramtypes",[Object]),gs("design:returntype",void 0)],e,"hasQuestionRemaining",null),us([Object(d.e)(),gs("design:type",Function),gs("design:paramtypes",[Object]),gs("design:returntype",void 0)],e,"getPickMode",null),e=ps=us([Object(d.f)({name:"quiz",defaults:bs})],e),e})();class vs{}const Os={colors:[245,245,245,1,245,245,245,1],gradientType:"radial",colorStops:[0,100]};var ws=function(e){return e.JPEG="image/jpeg",e.PNG="image/png",e}({});let Cs=(()=>{class e{constructor(e){this.thumbnails=e}}return e.type="[Story Chapters] Register thumbnail URLs from story",e})(),Ss=(()=>{class e{constructor(e,t=Os,n=ws.JPEG,i=.92,s,o="original",r,a,c=[]){this.chapterId=e,this.background=t,this.imageType=n,this.imageQuality=i,this.dimensions=s,this.crop=o,this.includeLabels=r,this.includeCopyright=a,this.layers=c}}return e.type="[Story Chapters] Take picture",e})(),_s=(()=>{class e{constructor(e,t,n){this.chapterId=e,this.blob=t,this.dimensions=n}}return e.type="[Story Chapters] Take picture success",e})();const js={small:{width:256,height:256},medium:{width:512,height:512},large:{width:1024,height:1024}};var ks;class Ps{constructor(){this[ks]=!0}}ks=immer.immerable;var Ms,Is,zs=n("LRne"),Ts=n("GyhO"),Us=n("5+tZ"),Ds=n("7wxJ"),Ls=n("JIr8"),Es=n("wOnQ"),Fs=n.n(Es),As=(n("INDF"),n("Cfvw")),Rs=n("Iab2"),Vs=n("VUv2");(Is=Ms||(Ms={})).exportImage=function(e,t,n,i){const s="string"==typeof e?Is.base64ToBlob(e,t):e;return i?Object(Vs.changeDpiBlob)(s,i).then((function(e){Object(Rs.saveAs)(e,n)})):Object(Rs.saveAs)(s,n),Object(zs.a)(!0)},Is.canvasToBlob=function(e,t,n){return new P.a(i=>{e.toBlob(e=>{i.next(e),i.complete()},t,n)})},Is.fitCanvas=function(e,{width:t,height:n}){const i=document.createElement("canvas");i.width=t,i.height=n;const s=i.getContext("2d"),o=Math.max(.5*(e.width-i.width/i.height*e.height),0);return new P.a(t=>{s.drawImage(e,o,0,i.width,i.height),t.next(i),t.complete()})},Is.elementToCanvas=function(e,t=!1){const n=t?{backgroundColor:"transparent"}:{};return Object(As.a)(Fs()(e,Object.assign({scale:1},n)))},Is.combineCanvasElements=function(e){const t=Math.max(0,...e.map(e=>e.width)),n=Math.max(0,...e.map(e=>e.height)),i=document.createElement("canvas");i.width=t,i.height=n;const s=i.getContext("2d");return e.forEach(e=>{s.drawImage(e,0,0)}),i},Is.base64ToBlob=function(e,t){const n=atob(e.split(",")[1]),i=new ArrayBuffer(n.length),s=new Uint8Array(i);for(let o=0;o<n.length;o++)s[o]=n.charCodeAt(o);return new Blob([i],{type:t})},Is.blobToBase64=function(e){return new P.a(t=>{const n=new FileReader;n.addEventListener("load",()=>{t.next(n.result),t.complete()}),n.readAsDataURL(e)})},Is.blobToCanvas=function(e,{width:t,height:n}){return new P.a(i=>{const s=document.createElement("canvas");s.width=t,s.height=n;const o=s.getContext("2d"),r=new Image;r.addEventListener("load",()=>{o.drawImage(r,0,0),i.next(s),i.complete()}),r.src=URL.createObjectURL(e)})};let Ns=(()=>{class e{constructor(e,t,n){this.engineService=e,this.labelsService=t,this.store=n}localResize(e,t){const n=Human.renderer.canvas.canvas,i=Human.renderer.canvas.annotationCanvas,s=n.parentNode,o=s.clientWidth,r=s.clientHeight;return s.width=e,s.height=t,n.width=e,n.height=t,i.width=e,i.height=t,s.style.width=e+"px",s.style.height=t+"px",Human.renderer.canvas.init(),Human.renderer.viewportDirty=!0,Human.renderer.camera.updateCanvas(),Human.renderer.postprocess.updateCanvas(),Human.renderer.draw.updateCanvas(),Human.renderer.viewportDirty=!0,Human.renderer.prepareFrame(),Human.renderer.forceRenderFrame(),[o,r]}canvasToImage(e,t="original"){const n=e.width/e.height,i=this.engineService.getCanvas();let{width:s,height:o}=i,r=.5*(i.width-s),a=0;switch(t){case"square":o>s?o=s:s=o,r=.5*(i.width-s),a=.5*(i.height-o);break;case"original":s=n*o}return new P.a(t=>{const n=e.getContext("2d");Human.renderer.forceRenderFrame(),n.drawImage(i,r,a,s,o,0,0,e.width,e.height),t.next(),t.complete()})}canvasToImageWithResize(e){const t=this.engineService.getCanvas();t.style.opacity="0",this.store.dispatch(new st(!1));const[n,i]=this.localResize(e.width,e.height),s=e.getContext("2d");return new P.a(e=>{setTimeout(()=>{Human.renderer.viewportDirty=!0,Human.renderer.prepareFrame(),Human.renderer.forceRenderFrame(),s.drawImage(t,0,0,t.width,t.height),this.localResize(n,i),document.getElementById("theCanvas").style.opacity="",this.store.dispatch(new st(!0)),e.next(),e.complete()},10)})}drawRadialGradient(e,t){const n=t.colors,[i,s]=t.colorStops.map(t=>((e,t,n)=>{const[i,s]=[Math.pow(t/2,2),Math.pow(n/2,2)];return e/100*Math.pow(i+s,.5)})(t,e.width,e.height)),o=e.getContext("2d"),[r,a]=[e.width/2,e.height/2],c=o.createRadialGradient(r,a,i,r,a,s);c.addColorStop(t.colorStops[0]/100,`rgba(${n.slice(0,4).join(",")})`),c.addColorStop(t.colorStops[1]/100,`rgba(${n.slice(4,8).join(",")})`),o.fillStyle=c,o.fillRect(0,0,e.width,e.height)}drawLinearGradient(e,t){const n=t.colors,i=e.getContext("2d"),[s,o]=[e.width/2,e.height/2],r=i.createLinearGradient(s,o,s,e.height);r.addColorStop(t.colorStops[0]/100,`rgba(${n.slice(0,4).join(",")})`),r.addColorStop(t.colorStops[1]/100,`rgba(${n.slice(4,8).join(",")})`),i.fillStyle=r,i.fillRect(0,0,e.width,e.height)}takeSnapshot(e,t,n,i,s,o){const{imageType:r,imageQuality:a,copyrightEnabled:c,crop:l}=o,p=document.createElement("canvas");p.width=e,p.height=t,"radial"===n.gradientType?this.drawRadialGradient(p,n):"linear"===n.gradientType&&this.drawLinearGradient(p,n);const d=this.engineService.getCanvas(),u=[],g=(p.height>d.height||p.width>d.width?this.canvasToImageWithResize(p):this.canvasToImage(p,l)).pipe(Object(F.a)(()=>p));u.push(g);const h=[],b=this.labelsService.getLabelContainer();return s&&b&&h.push(b.nativeElement),h.push(...i),u.push(...h.map(n=>(n instanceof HTMLCanvasElement?Object(zs.a)(n):Ms.elementToCanvas(n,!0)).pipe(Object(Us.a)(n=>Ms.fitCanvas(n,{width:e,height:t}))))),Object(Ts.a)(u).pipe(Object(Ds.a)(),Object(F.a)(e=>Ms.combineCanvasElements(e)),Object(Us.a)(e=>c?this.writeLogoToCanvas(e,o):Object(zs.a)(e)),Object(Us.a)(e=>Ms.canvasToBlob(e,r,a)))}writeLogoToCanvas(e,t){return this.getLogoImage(t.copyrightImagePath).pipe(Object(F.a)(n=>{let{width:i,height:s}=n;const{width:o,height:r}=e;if(.1*o>i){const e=s/i;i=.1*o,s=e*i}const{xOffset:a,yOffset:c}=this.getLogoPosition(o,r,i,s,t);return e.getContext("2d").drawImage(n,a,c,i,s),e}),Object(Ls.a)(()=>Object(zs.a)(e)))}getLogoImage(e){return new P.a(t=>{const n=new Image;n.onload=()=>{t.next(n),t.complete()},n.onerror=()=>t.error(),n.src=e})}getLogoPosition(e,t,n,i,s){const{copyrightPosition:o,copyrightOffset:r}=s;let a,c;switch(o.x){case"right":a=e-n;break;case"center":a=e/2-n/2;break;default:a=0}switch(o.y){case"bottom":c=t-i;break;case"center":c=t/2-i/2;break;default:c=0}return{xOffset:a+r.x,yOffset:c+r.y}}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(Qt),i.Zb(Pi),i.Zb(d.g))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var Bs=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},Hs=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const Qs={imageType:ws.JPEG,crop:"original",copyrightEnabled:!1,copyrightImagePath:"assets/images/powered-by-biodigital-color.svg",copyrightPosition:{x:"left",y:"bottom"},copyrightOffset:{x:12,y:-12},imageQuality:1},$s={thumbnails:new Map};let qs=(()=>{let e=class{constructor(e,t){this.snapshotService=e,this.store=t}static getRegisteredThumbnails(e){return e.thumbnails}registerChapterThumbnails(e,t){e.patchState(immer.produce(e.getState(),e=>{e.thumbnails=new Map(t.thumbnails)}))}takeChapterPicture(e,t){const{chapterId:n,includeLabels:i,includeCopyright:s,dimensions:o,imageType:r,imageQuality:a,crop:c,layers:l}=t,p=o||js.large,{width:d,height:u}=p,g=t.background;let h;switch(r){case ws.PNG:h=g||Os;break;case ws.JPEG:default:h=g&&!gi.isTransparent(g)?g:Os}const b=g.colors.slice(0,3),m=si.isLight(b),f=Object.assign(Object.assign({},Qs),{crop:c,imageType:r,imageQuality:a,copyrightEnabled:s,copyrightImagePath:m?"assets/images/powered-by-biodigital-color.svg":"assets/images/powered-by-biodigital-white.svg"});setTimeout(()=>{this.snapshotService.takeSnapshot(d,u,h,l,i,f).subscribe(t=>{e.dispatch(new _s(n,t,p))})})}takeChapterPictureSuccess(e,t){e.patchState(immer.produce(e.getState(),e=>{const n=e.thumbnails.get(t.chapterId)||new Ps;n.snapshot=URL.createObjectURL(t.blob),e.thumbnails.set(t.chapterId,n)}))}};return e.\u0275fac=function(t){return new(t||e)(i.Zb(Ns),i.Zb(d.g))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac}),Bs([Object(d.a)(Cs),Hs("design:type",Function),Hs("design:paramtypes",[Object,Cs]),Hs("design:returntype",void 0)],e.prototype,"registerChapterThumbnails",null),Bs([Object(d.a)(Ss),Hs("design:type",Function),Hs("design:paramtypes",[Object,Ss]),Hs("design:returntype",void 0)],e.prototype,"takeChapterPicture",null),Bs([Object(d.a)(_s),Hs("design:type",Function),Hs("design:paramtypes",[Object,_s]),Hs("design:returntype",void 0)],e.prototype,"takeChapterPictureSuccess",null),Bs([Object(d.e)(),Hs("design:type",Function),Hs("design:paramtypes",[vs]),Hs("design:returntype",void 0)],e,"getRegisteredThumbnails",null),e=Bs([Object(d.f)({name:"storyThumbnails",defaults:$s})],e),e})();class Ws{constructor(e){this.shown="majorityWins",this.selected="majorityWins",this.pickable="majorityWins",e.forEach(e=>{this[e]="majorityWins"})}}let Ks=(()=>{class e{constructor(e,t,n){this.store=e,this.labelService=t,this.graphService=n}getMinimumGraphSync(e,t,n){const i=Human.scene.colorRecipes.getRecipes(),s=Object.keys(new Ut(i)),o=function(e,t,n){const i={},s={};return Dt.depthFirst(e,o=>{s[o]=Dt.isRoot(e,o)?Object.assign(Object.assign({},Dt.getState(e,o,n)),t[o]||{}):Object.assign(Object.assign({},s[e.predecessors[o]]),t[o]||{}),Dt.isLeaf(e,o)&&(i[o]=s[o])}),i}(e,t,s),r=function(e,t,n){const i=Object.keys(t),s=Lt.getInitialVoterState(n,i),o=Lt.getInitialElectionDepth(n,e),r=Object(D.range)(o,-1).reduce((n,i)=>{const s=Lt.getEligibleElections(e,Object.keys(n.remainingVoters),i),o=Lt.getElectionResults(e,n.remainingVoters,s,t),r=function(e){return e.reduce((e,t)=>{const n=Object.keys(t).map(e=>function(e,t,n,i){const s=i.reduce((t,i)=>(t[i]={[e]:!n},t),{});return s[t]={[e]:n},s}(e,t[e].id,t[e].result,t[e].dissenters)).reduce((e,t)=>Object(D.merge)(e,t),{});return Object.keys(n).forEach(t=>{e[t]=n[t]}),e},{})}(o.results);return Object.keys(r).forEach(e=>{n.syncGraph[e]=r[e]}),n.remainingVoters=o.remainingVoters,n},{syncGraph:{},remainingVoters:s}).syncGraph;return function(e,t,n,i){const s=t.reduce((t,s)=>{const o=e[s],r=e[i.predecessors[s]];for(const e of n)o[e]===r[e]&&t.push({successorId:s,prop:e});return t},[]);for(const o of s)delete e[o.successorId][o.prop],0===Object.keys(e[o.successorId]).length&&delete e[o.successorId];return e}(r,Object.keys(r).filter(t=>!e.roots[t]&&!!e.successors[t]),i,e)}(e,JSON.parse(JSON.stringify(new Ws(i))),o);Object.entries(t).forEach(([e,t])=>{const n=Object(D.omit)(t,s);Object(D.isEmpty)(n)||(r[e]=Object.assign(Object.assign({},r[e]||{}),n))});const a=new Tt;return Object.entries(r).forEach(([e,t])=>{a[this.switchNamespace(e,n)]=t},this),a}convertGraphSync(e){const t={},n={},i={},s={};return Object.entries(e).forEach(([e,o])=>{Object.entries(o).forEach(([o,r])=>{"shown"===o?t[e]=r:"selected"===o?n[e]=r:"pickable"===o?i[e]=!r:s[e]=Object.assign(Object.assign({},s[e]||{}),{[o]:r})},this)},this),{showObjects:t,selectObjects:n,pickThroughObjects:i,synchronization:s}}switchNamespace(e,t){return t[e]||e}serializeProperties(e){const t=Object.assign({},e.properties),n=Human.properties.properties["annotations.layout.type"];return"draggable"!==n&&(t["annotations.layout.type"]=n),t}serializeHotspots(e,t){let n=[...e.hotspots],i={};return t.filter(t=>t.chapterId===e.id).forEach(e=>{const t=this.labelService.serializeLabel(e,n.length);n=[...n,...t.hotspots],i=Object.assign(Object.assign({},i),t.data)}),{customData:i,hotspots:n}}serializeMedia(e){return e.media?Object.entries(e.media).reduce((e,[t,n])=>(e[t]=Object.assign({},n.data),e),{}):null}serializeBackground(e){return e?Object(A.classToClass)(e):{}}serializeUI(e,t){return Object(D.isEmpty)(t)?{play:{count:1}}:t}calcMinimumPaintState(e,t){return Object.keys(e.roots).reduce((n,i)=>Object.assign(Object.assign({},n),function n(i,s=!0){const o=(e.successors[i]||[]).reduce((e,s)=>{const o=!Object(D.isEqual)(t[i],t[s]);return Object.assign(Object.assign({},e),n(s,o))},{});return s?Object.assign({[i]:t[i]},o):o}(i)),{})}serializeVisibilityLayers(e,t){const n=Object.assign({},e);return Array.isArray(e.layers)&&(n.layers=e.layers.map(e=>Object.assign(Object.assign({},e),{objectIds:e.objectIds.filter(e=>Object.prototype.hasOwnProperty.call(t.nodes,e))})).filter(e=>e.objectIds.length>0)),n}serializeTimelineMap(e){return e?e.map(e=>{const t=Object(D.cloneDeep)(e);return delete t.id,t}):[]}serializeChapter(e,t,n,i,s){var o,r;const a=this.serializeHotspots(t,i),c=this.store.selectSnapshot(ts.particleSystemsForChapter(t.id)),l=Object(D.pickBy)(t.customData,(e,t)=>!t.startsWith("errand")),p=Object.assign(Object.assign(Object.assign({},l),a.customData),{particleSystems:c.map(e=>e.id)}),d=this.store.selectSnapshot(xs.getQuizQuestionsByChapter(t.id)).map(e=>{const t=Object.assign({},e);return delete t.chapterId,t}),u=s[t.id],g=this.store.selectSnapshot(qs.getRegisteredThumbnails),h=(null===(o=g.get(u))||void 0===o?void 0:o.urls)||(null===(r=g.get(t.id))||void 0===r?void 0:r.urls)||null,b={id:u,displayName:t.info.displayName,description:t.info.description,[t.camera.action]:t.camera.location,cameraRotationCenter:t.camera.rotationCenter,background:this.serializeBackground(t.background),hotspots:a.hotspots,clippingPlanes:{clips:t.clippingPlanes.clips,boundary:t.clippingPlanes.boundary},ui:this.serializeUI(t,t.ui),media:this.serializeMedia(t),graph:t.graph||{},timelineMap:this.serializeTimelineMap(t.timelineMap),customData:p,viewModes:t.viewModes,lights:t.lights,recipes:t.recipes||{},transparencyMode:t.transparencyMode||"",fallbackTransparency:t.fallbackTransparency||"",properties:this.serializeProperties(t),effects:t.effects||{},options:t.options,transitions:t.transitions,environment:t.environment||{},legend:t.legend||[],visibilityLayers:this.serializeVisibilityLayers(t.visibilityLayers.src,e),colorRecipeObjects:t.colorRecipeObjects,contentBlocks:t.contentBlocks||[],thumbnails:h,quizQuestions:d},m=this.store.selectSnapshot(Bi.getAllNodeState)[t.id],f=Object.keys(m).reduce((n,i)=>{const s=m[i],o=s.shownSetByTween?Ki(e,i,t.showObjects)||Wi(e,i,t.showObjects):s.shown;return n.boolState[i]={shown:o,pickable:s.pickable},n.paintState[i]=Fi.toEngine(s.paint),n},{boolState:{},paintState:{}}),y=this.getMinimumGraphSync(e,f.boolState,n);return Object.entries(this.convertGraphSync(y)).forEach(([e,t])=>{b[e]=t}),b.synchronization=this.calcMinimumPaintState(e,f.paintState),b}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(d.g),i.Zb(Pi),i.Zb(Et))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var Gs;(Gs||(Gs={})).makeChapterIdMap=function(e,t){return e.reduce((e,n)=>(e[n.id]=!0===t?yi.idWithPrefix("chapter"):n.id,e),{})};var Zs=function(e){return e[e.LeftClip=0]="LeftClip",e[e.RightClip=1]="RightClip",e[e.BottomClip=2]="BottomClip",e[e.TopClip=3]="TopClip",e[e.FrontClip=4]="FrontClip",e[e.BackClip=5]="BackClip",e}({});const Js={0:"left",1:"right",2:"bottom",3:"top",4:"front",5:"back"},Xs={enabled:!1,clips:{left:{clipId:Zs.LeftClip,enabled:!1,fade:!1,fadeDistance:0,progress:0},right:{clipId:Zs.RightClip,enabled:!1,fade:!1,fadeDistance:0,progress:0},back:{clipId:Zs.BackClip,enabled:!1,fade:!1,fadeDistance:0,progress:0},front:{clipId:Zs.FrontClip,enabled:!1,fade:!1,fadeDistance:0,progress:0},top:{clipId:Zs.TopClip,enabled:!1,fade:!1,fadeDistance:0,progress:0},bottom:{clipId:Zs.BottomClip,enabled:!1,fade:!1,fadeDistance:0,progress:0}}};class Ys{constructor(){this.firstTime=0,this.lastTime=1}}let eo=(()=>{class e{constructor(){this.fps=30,this.epsilon=.001}getChapterLocalTimerange(e){const t=Human.timeline.activeRoot._chapters.find(t=>t.id===e);return Object(A.plainToClass)(Ys,t.timeRange)}mapGlobalTimeToLocal(e,t={}){const n=Human.timeline.activeRoot.mapGlobalTime(e,t);return n.time<0&&(n.time=0),n}mapLocalTimeToGlobal(e,t){const n=Human.timeline.activeRoot._chapters.find(t=>t.id===e);return Human.timeline.activeRoot.mapBranchTime(n,t)}getLocalTime(e){const t=Human.timeline.activeRoot._nowBranch,n=this.mapLocalTimeToGlobal(t.id,t.timeRange.firstTime);return this.mapGlobalTimeToLocal(e,{tie:e===n?"later":"earlier"}).time}isChapterAnimated(e){return e.timelineMap.filter(e=>"dummy"!==Object(D.get)(e,"data.timeline")&&"dummy"!==Object(D.get)(e,"data.timeline.id")&&"dummy"!==Object(D.get)(e,"data.timeline.id.id")).length>0}isChapterLooped(e){return!0===Object(D.get)(e,"loop")||-1===Object(D.get)(e,"ui.play.count")}scrub(e){Human.timeline.scrub({time:e.time,borderCondition:{which:e.which?e.which:"first",direction:"forwards"}})}scrubFrame(e){const t="next"===e?1:-1,n=this.getTime(),i=this.secondsToFrames(n),s=this.framesToSeconds(i+t),o=Human.timeline.activeRoot._nowBranch,r=o.timeRange,a=this.mapLocalTimeToGlobal(o.id,r.firstTime),c=this.mapLocalTimeToGlobal(o.id,r.lastTime);let l;l=s<=a?{time:a,which:"second"}:s>=c?{time:c,which:"first"}:{time:s},this.scrub(l)}fromEngineTimelineMap(e){return{id:e.id,name:e.name,start:e.start,end:e.end,data:{timeline:e.leafTimeline.id,start:e.dataStart,end:e.dataEnd,fit:e.fit,onEnd:e.onEnd}}}secondsToFrames(e){return Math.round(e*this.fps)}framesToSeconds(e){return e/this.fps}toNearestFrame(e){return this.framesToSeconds(this.secondsToFrames(e))}formatTime(e){const t=t=>{const n=e<0?Math.ceil:Math.floor;return Math.abs(n(t)).toString().padStart(2,"0")},n=t(e/60),i=t(e%60),s=(e=>Math.abs(this.secondsToFrames(e%1)).toString().padStart(2,"0"))(e%1);return`${e<0?"-":""}${n}:${i}:${s}`}parseFormattedTime(e){const t=/^-/,n=t.test(e)?-1:1;-1===n&&(e=e.replace(t,""));const i=e.split(":").reverse();let s=parseInt(i[0],10),o=parseInt(i[1],10),r=parseInt(i[2],10);return isNaN(s)&&(s=0),isNaN(o)&&(o=0),isNaN(r)&&(r=0),(60*r+o+this.framesToSeconds(s))*n}constrainLocalTime(e){const t=Human.timeline.activeRoot._nowBranch.timeRange;return e<t.firstTime&&(e=t.firstTime),e>t.lastTime&&(e=t.lastTime),e}addTimelineMap(e,t){const n=e.getTimeFrame(),i=e.createTimelineMap(t);t.id=i;const s=e.getTimeFrame();return n.lastTime!==s.lastTime&&Human.timeline.activeRoot.build(),t}updateTimelineMaps(e,t){const n=e.getTimeFrame();t.forEach(t=>{e.updateTimelineMap(t.id,t)});const i=e.getTimeFrame();n.lastTime!==i.lastTime&&Human.timeline.activeRoot.build()}deleteTimelineMaps(e,t){const n=e.getTimeFrame();t.forEach(t=>{e.deleteTimelineMap(t)});const i=e.getTimeFrame();n.lastTime!==i.lastTime&&Human.timeline.activeRoot.build()}getLeafTimelines(){return Human.timeline.leafTimelines}getTimeFrame(){return Human.timeline.getTimeFrame()}getTime(){return Human.timeline.time}isPlaying(){return Human.timeline.playing}hasChapterFinished(e){const t=this.getChapterLocalTimerange(e),n=this.mapGlobalTimeToLocal(Human.timeline.time);return Math.abs(n.time-t.lastTime)<this.epsilon}play(e){this.playParams=Object.keys(e).reduce((e,t)=>(void 0===e[t]&&delete e[t],e),Object.assign({},e)),Human.timeline.play(this.playParams)}rewind(e){const t=this.mapLocalTimeToGlobal(e,0);this.scrub({time:t,which:"second"})}unpause(e){this.hasChapterFinished(e)&&this.rewind(e),Human.timeline.unpause()}pause(){Human.timeline.pause()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),to=(()=>{class e{constructor(e,t,n,i){this.engineService=e,this.serializeChapterService=t,this.labelService=n,this.animationService=i}addChapterToEngine(e,t){const n=Gs.makeChapterIdMap([e],!1),i=Dt.createGraphFromSrc(Object.values(Human.scene.rootObjects),"objectId","objects",new Ut(Human.scene.colorRecipes.getRecipes())),s=this.serializeChapterService.serializeChapter(i,e,{},[],n);s.synchronization=JSON.parse(JSON.stringify(e.synchronization));const o=new Human.timeline.BranchTimeline(s);return Human.timeline.activeRoot.addChapter(o,{rebuild:!0,position:t}),o}removeChapterFromEngine(e){Human.timeline.activeRoot._chapters=Human.timeline.activeRoot._chapters.filter(t=>t.id!==e.id),Human.timeline.activeRoot.build()}copyChapter(e,t){const n=Object(A.classToClass)(e);return n.id=t,n.labels.forEach(e=>{e.id=yi.idWithPrefix("label"),e.chapterId=n.id}),n.readyState={model:!0,animation:!0},n}getCurrentChapterId(){return Human.timeline.activeRoot._nowBranch.id}fromHumanChapter(e,t,n,i){const s=Object.assign({},n),o=e.chapters[i];s.environment=Object.assign({},o.environment),s.transitions=Object.assign({},o.transitions),o.transparencyMode&&(s.transparencyMode=o.transparencyMode),s.showObjects=Object.assign({},e.chapters[i].showObjects),s.pickThroughObjects=Object.assign({},e.chapters[i].pickThroughObjects),s.camera=Object(D.cloneDeep)(n.camera),o.cameraRotationCenter&&(s.camera.rotationCenter=o.cameraRotationCenter),Array.isArray(s.camera.rotationCenter)&&(s.camera.rotationCenter=bn.fromArray(s.camera.rotationCenter));const r=s.camera.location;r.rotationCenter&&delete r.rotationCenter,s.id||(s.id=yi.idWithPrefix("chapter"));let a=!1;s.timelineMap=Object.values(n.maps).map(e=>("dummy"!==e.leafTimeline.id&&(a=!0),this.animationService.fromEngineTimelineMap(e))),delete s.maps;let c=0;const l=!!n.animation&&n.animation.loop;a&&l?c=-1:a&&!l&&(c=1),s.ui=n.ui&&!Object(D.isEmpty)(n.ui)?n.ui:{play:{count:c}};const p=ri.Annotation,d=[...s.annotations||[]].map(e=>this.labelService.deserializeAnnotation(e,s,p)),u=[],g=this.groupHotspots([...s.hotspots||[]].filter(i=>{const s=this.labelService.filterHotspot(e,n,i);return s?i.theme||(i.theme="module"===t?vi.studioNext:vi.classicHotspot):u.push(i),s})).map(t=>this.labelService.deserializeHotspots(e,n,i,...t));s.labels=[...d,...g],delete s.annotations,s.background=gi.deserialize(n.background);const h=Object(A.plainToClass)(fi,s);h.hotspots=u,h.readyState={model:!1,animation:!1},h.clippingPlanes=Object(D.isEmpty)(h.clippingPlanes)?Xs:this.sanitizeClippingPlanes(h.clippingPlanes),h.legend=[...o.legend||[]],h.visibilityLayers=this.buildVisibilityLayers(o.visibilityLayers,h.showObjects),h.colorRecipeObjects=o.colorRecipeObjects,h.contentBlocks=[...o.contentBlocks||[]],h.quizQuestions=(o.quizQuestions||[]).map(e=>Object.assign(Object.assign({},e),{chapterId:s.id}));const b=n.media||{};return Object.values(b).forEach(e=>{e.data.hasOwnProperty("lang")||(e.data.lang="en")}),h.media=b,h.thumbnails=o.thumbnails,h}getChapterTweenStates(e){const t=e.timelineMap.filter(e=>"dummy"!==e.data.timeline).map(e=>e.data.timeline);return Array.from(new Set(t))}getChapterLightLibraries(e){return(e.lights&&e.lights.libraries||[]).filter(e=>"default"!==e)}getChapterReflectionLibraries(e){const t=e.environment&&e.environment.reflectionMap||[],n=e=>e.split(".")[0],i=(e.environment&&e.environment.lightMap||[]).map(n).concat(t.map(n));return Array.from(new Set(i))}hasVisibilityLayers(e){return Array.isArray(e)&&e.length>0}buildVisibilityLayers(e,t){const n={src:{},current:{}};if(e&&this.hasVisibilityLayers(e.layers)){const i=e.initIndex||0,s=this.unpackLayers(e.layers),o=this.buildShownObjectsSet(t),r=this.buildCurrentLayers(s,o);n.src={layers:e.layers,initIndex:i},n.current={layers:r,index:i,position:0}}return n}buildShownObjectsSet(e){const t=this.engineService.getSceneGraph(Human.scene.rootObjects),n=Object.keys(t.nodes).filter(n=>Ki(t,n,e)||Wi(t,n,e));return new Set(n)}unpackLayers(e){const t=[];return e.forEach(e=>{let n=[];e.objectIds.forEach(e=>{const t=Human.scene.objects[e].getLeafObjects();n=n.concat(t.map(e=>e.objectId))}),t.push({name:e.name,objectIds:n})}),t}buildCurrentLayers(e,t){const n=[];return e.forEach((i,s)=>{let o=!1;i.objectIds.forEach(i=>{t.has(i)&&(o?n[n.length-1].objectIds.push(i):(n.push({name:e[s].name,objectIds:[i]}),o=!0))})}),n}sanitizeClippingPlanes(e){const t=Object.values(e.clips).some(e=>e.progress>0),n=Object(D.mapKeys)(e.clips,(e,t)=>Js[t]||t);return Object.assign(Object.assign({},e),{clips:n,enabled:t})}groupHotspots(e){const t={},n=e=>e.primitiveIndex?e.primitiveIndex.toFixed(0):e.pos?e.pos.map(e=>e.toFixed(3)).join(":"):Math.random().toFixed(3);return e.forEach(e=>{const i=[(s=e.type,RegExp("^circle-(plus|minus)").test(s)?"pair":"single"),e.objectId,n(e)].join("|");var s;i in t?t[i].push(e):t[i]=[e]}),Object.values(t)}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(Qt),i.Zb(Ks),i.Zb(Pi),i.Zb(eo))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var no=function(e){return e.Toggle="toggle",e.None="none",e}({});let io=(()=>{class e{constructor(e){this.patches=e}}return e.type="[Story Labels] Patch Labels",e})(),so=(()=>{class e{constructor(e,t){this.labelId=e,this.offset=t}}return e.type="[Story Labels] Set label Offset",e})(),oo=(()=>{class e{constructor(e){this.labels=e}}return e.type="[Story Labels] Set Labels",e})(),ro=(()=>{class e{constructor(e){this.label=e}}return e.type="[Story Labels] Add Label",e})(),ao=(()=>{class e{constructor(e){this.label=e}}return e.type="[Story Labels] Set Contexdt Label",e})(),co=(()=>{class e{constructor(e,t){this.sourceChapter=e,this.targetChapter=t}}return e.type="[Story Labels] Copy Labels",e})(),lo=(()=>{class e{constructor(e){this.label=e}}return e.type="[Story Labels] Remove Label",e})(),po=(()=>{class e{constructor(){}}return e.type="[Story Labels] Remove Context Label",e})(),uo=(()=>{class e{constructor(e){this.chapter=e}}return e.type="[Story Labels] Remove All Chapter Labels",e})(),go=(()=>{class e{constructor(e,t=!1){this.label=e,this.record=t}}return e.type="[Story Labels] Set Label",e})(),ho=(()=>{class e{constructor(e,t){this.id=e,this.states=t}}return e.type="[Story Labels] Set Label States",e})(),bo=(()=>{class e{constructor(e){this.scale=e}}return e.type="[Story Labels] Set Label Scale",e})(),mo=(()=>{class e{constructor(e){this.label=e}}return e.type="[Story Labels] Select Label",e})(),fo=(()=>{class e{constructor(){}}return e.type="[Story Labels] Reset",e})(),yo=(()=>{class e{constructor(e,t){this.labels=e,this.fields=t}}return e.type="[Story Labels] Convert",e})(),xo=(()=>{class e{constructor(e,t=!0,n=!0){this.enable=e,this.enableInfo=t,this.enableActions=n}}return e.type="[Story Labels] Enable Context Label",e})(),vo=(()=>{class e{constructor(e,t){this.labels=e,this.shown=t}}return e.type="[Story Labels] Set Labels Shown",e})(),Oo=(()=>{class e{constructor(e){this.show=e}}return e.type="[Story Labels] Set All Labels Shown",e})(),wo=(()=>{class e{constructor(e,t=no.None){this.collapsed=e,this.collapsedMode=t}}return e.type="[Story Labels] Set Labels Collapsed",e})(),Co=(()=>{class e{constructor(e){this.draggable=e}}return e.type="[Story Labels] Set Draggable",e})();var So=n("5+WD"),_o=function(e){return e.Hide="hide",e.Show="show",e.Collapse="collapse",e}({}),jo=function(e){return e.None="none",e.Small="small",e.Full="full",e}({}),ko=function(e){return e.None="none",e.Circle="circle",e.Bar="bar",e}({});const Po=c.application===s.Viewer?ko.Bar:ko.Circle;class Mo{constructor(e=_o.Hide,t=!0){this.status=e,this.enable=t}}var Io,zo=n("qpAl"),To=n.n(zo),Uo=n("xgIS"),Do=n("VRyK");!function(e){function t(e){s()&&(e||(e=document.body),To.a.prefixed("requestFullscreen",e)())}function n(){s()&&To.a.prefixed("exitFullscreen",document)()}function i(){return To.a.fullscreen&&To.a.prefixed("fullscreenEnabled",document)}function s(){return!!i()||(console.warn("Fullscreen is not enabled"),!1)}function o(){return To.a.prefixed("fullscreenElement",document)}e.toggleFullscreen=function(e){null===o()?t(e):n()},e.requestFullscreen=t,e.exitFullscreen=n,e.canFullscreen=i,e.checkFullscreenSupport=s,e.getFullscreenElement=o,e.isFullscreen=function(){return null!=o()},e.onFullscreenChange=function(){const e="mozfullscreenchange webkitfullscreenchange MSFullscreenChange fullscreenchange".split(" ").map(e=>Object(Uo.a)(document.body,e));return Object(Do.a)(...e)}}(Io||(Io={}));var Lo=function(e){return e.Play="play",e.Button="button",e.Hand="hand",e}({}),Eo=function(e){return e[e.OnDemand=0]="OnDemand",e[e.Interact=1]="Interact",e[e.Loader=2]="Loader",e[e.Tutorial=3]="Tutorial",e[e.Whiteboard=4]="Whiteboard",e[e.Help=5]="Help",e}({}),Fo=function(e){return e[e.Text=0]="Text",e[e.Paint=1]="Paint",e[e.Erase=2]="Erase",e}({});const Ao=[4,8,12,16,24,32],Ro=e=>e.slice(0).reverse().map(e=>({label:""+e,size:e})),Vo=Ro(Ao),No=Ro([8,12,16,20,24,32]),Bo=Ro(Ao),Ho={label:"Black",color:"#000000"},Qo={label:"White",color:"#ffffff"},$o=[Ho,{label:"Red",color:"#ff0000"},{label:"Yellow",color:"#ffff00"},{label:"Green",color:"#00ff00"},{label:"Cyan",color:"#00ffff"},{label:"Blue",color:"#0000ff"},{label:"Pink",color:"#ff00ff"},Qo],qo=Vo[4],Wo=$o[0],Ko=No[3],Go=Bo[4],Zo=Ho,Jo=Qo;var Xo=function(e){return e.Mouse="mouse",e.Touch="touch",e}({}),Yo=function(e){return e[e.Default=0]="Default",e.DrawerOnly="drawer",e.ColumnOnly="column",e}({}),er=n("Texg");class tr extends er.a{constructor(){super("HumanDatabase"),this.version(2).stores({keyValue:",value",analytics:"message"}),this.open(),this.keyValue=this.table("keyValue"),this.analytics=this.table("analytics")}}var nr=function(e,t,n,i){return new(n||(n=Promise))((function(s,o){function r(e){try{c(i.next(e))}catch(t){o(t)}}function a(e){try{c(i.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,a)}c((i=i.apply(e,t||[])).next())}))},ir=function(e){return e.WidgetOptions="widgetOptions",e.SnapshotOptions="snapshotOptions",e.Locale="locale",e.GroupRestriction="GroupRestriction",e.UserAppId="userAppId",e.RememberMeEmail="rememberMeEmail",e.LabelConversionSeen="labelConversionSeen",e.DefaultGroupEdit="defaultGroupEdit",e.DefaultCollectionId="defaultCollectionId",e.InternetExplorerWarning="internetExplorerWarning",e.GettingStartedTutorial="gettingStartedTutorial",e.AutoCapture="autoCapture",e.SystemMessage="systemMessage",e.ExploreRedesignMessage="exploreRedesignMessage",e.Iphone12Warning="iphone12Warning",e.RecentRecipes="recentRecipes",e.TeamTrialExpirationSeen="teamTrialExpiredSeen",e.ProExpirationSeen="proExpirationSeen",e.PaintPalettes="paintPalettes",e.RecentSearchConfig="recentSearchConfig",e.CameraDebug="cameraDebug",e}({}),sr=function(e){return e.UserMessagesSeen="userMessagesSeen",e.PreviewSize="previewSize",e}({}),or=function(e){return e.PreviewStory="previewStory",e.PreviewBookmark="previewBookmark",e}({});class rr{constructor(){this._data={}}get keys(){return Object.keys(this._data)}get length(){return this.keys.length}clear(){this._data={}}getItem(e){return this._data[e]}key(e){return this.keys[e]}removeItem(e){delete this._data[e]}setItem(e,t){this._data[e]=t}}let ar=(()=>{class e{constructor(){this._localStorage=this.getStorage("localStorage"),this._sessionStorage=this.getStorage("sessionStorage"),this._indexedStorage=new tr}getLocalItem(e){return this._localStorage.getItem(""+e)}getLocalJSON(e){const t=this.getLocalItem(e);return t?JSON.parse(t):null}setLocalItem(e,t){const n="object"==typeof t?JSON.stringify(t):""+t;try{return this._localStorage.setItem(""+e,n),!0}catch(i){return!1}}removeLocalItem(e){this._localStorage.removeItem(""+e)}getSessionItem(e){const t=this._sessionStorage.getItem(""+e);return t?JSON.parse(t):null}setSessionItem(e,t){const n=JSON.stringify(t);try{return this._sessionStorage.setItem(""+e,n),!0}catch(i){return!1}}removeSessionItem(e){this._sessionStorage.removeItem(""+e)}setDatabaseItem(e,t){return this._indexedStorage.keyValue.put(t,e)}setDatabaseAnalyticItem(e){(()=>{nr(this,void 0,void 0,(function*(){yield this._indexedStorage.analytics.add({message:e})}))})()}getDatabaseOfflineAnalytics(e){(()=>{nr(this,void 0,void 0,(function*(){const t=(yield this._indexedStorage.analytics.toArray()).map(e=>e.message);this._indexedStorage.analytics.clear(),e(t)}))})()}getDatabaseOfflineAnalyticsCount(e){(()=>{nr(this,void 0,void 0,(function*(){const t=yield this._indexedStorage.analytics.toArray();e(t.length)}))})()}getDatabaseItem(e){return this._indexedStorage.keyValue.get(e)}clearStorage(){this.clearLocalStorage(),this.clearSessionStorage()}clearLocalStorage(){this._localStorage.clear()}clearSessionStorage(){this._sessionStorage.clear()}getStorage(e){try{return window[e]||new rr}catch(t){return new rr}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var cr,lr=function(e){return e.BioDigital="biodigital",e.Wikipedia="wikipedia",e.NCIT="ncit",e}({}),pr=function(e){return e[e.List=0]="List",e[e.Tree=1]="Tree",e}({}),dr=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},ur=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};class gr{}const hr={audio:new Mo,camera:new Mo(_o.Show,!0),chapterList:new Mo(_o.Show,!1),column:new Mo,description:new Mo,drawer:new class extends Mo{constructor(e=!1){super(),this.isExpandedInitially=e}},fullscreen:new Mo,help:new Mo,labels:new class extends Mo{constructor(e=!0){super(),this.shown=e}},labelInfo:new Mo,labelList:new Mo(_o.Show,!1),loader:new class extends Mo{constructor(e=Po){super(),this.template=e}},logo:new class extends Mo{constructor(e=!0){super(),this.isHyperLink=e}},media:new class extends Mo{constructor(e=jo.Small){super(),this.template=e}},menu:new Mo,nodeInfo:new Mo(_o.Hide,!1),pagination:new Mo,presenter:new Mo(_o.Hide,!1),reset:new Mo,search:new Mo,quiz:new Mo,titleOnly:new Mo,toolbar:new Mo,tools:new Mo,anatomyLabels:new Mo,tutorial:new Mo(_o.Hide,!1),internetExplorerWarning:new Mo,legend:new Mo,undo:new Mo,whiteboard:new Mo,visibilityLayers:new Mo,contextActions:new Mo,toggleLabels:new Mo},br={lang:"en",canFullscreen:!1,canHover:!1,canTouch:!1,drawerCoversContent:!1,fullscreenActive:!1,help:{tab:z.Basics},initialUI:hr,inputEnabled:!0,inputMode:Xo.Mouse,interactType:Lo.Play,onDemand:!1,layout:Yo.Default,labelsBreakpoint:480,menuOpen:!1,multiPickModeEnabled:!1,openWindows:[Eo.Loader],presentationActive:!1,searchDisplayMode:pr.Tree,nodeInfo:{show:!1,fallback:lr.Wikipedia},tutorial:{pageSize:0,pageIndex:-1},tutorialSeen:!0,ui:hr,usePrintImage:!1,whiteboard:{enabled:!1,hasPaint:!1,hasText:!1,brushSize:qo.size,brushColor:Wo.color,textSize:Ko.size,eraserSize:Go.size,annotateMode:Fo.Paint},scrim:{show:!1,label:""}};let mr=(()=>{let e=cr=class{constructor(e){this.storageService=e}static getUI(e){return e.ui}static getInitialUI(e){return e.initialUI}static getLabelsBreakpoint(e){return e.labelsBreakpoint}static getInputEnabled(e){return e.inputEnabled}static getFullscreenActive(e){return e.fullscreenActive}static getPresentationActive(e){return e.presentationActive}static getDrawerCoversContent(e){return e.drawerCoversContent}static getShowNodeInfo(e){return e.nodeInfo.show}static getNodeInfoFallback(e){return e.nodeInfo.fallback}static getViewLanguage(e){return e.lang}static getInteractType(e){return e.interactType}static getOnDemand(e){return e.onDemand}static getLayout(e){return e.layout}static getInputMode(e){return e.inputMode}static getShowHelpTab(e){return e.help.tab}static getTutorial(e){return e.tutorial}static getTutorialSeen(e){return e.tutorialSeen}static getWhiteboardEnabled(e){return e.whiteboard.enabled}static getWhiteboardBrushSize(e){return e.whiteboard.brushSize}static getWhiteboardTextSize(e){return e.whiteboard.textSize}static getWhiteboardEraserSize(e){return e.whiteboard.eraserSize}static getWhiteboardAnnotateMode(e){return e.whiteboard.annotateMode}static getWhiteboardBrushColor(e){return e.whiteboard.brushColor}static getWhiteboardHasPaint(e){return e.whiteboard.hasPaint}static getWhiteboardHasText(e){return e.whiteboard.hasText}static getCanTouch(e){return e.canTouch}static getCanHover(e){return e.canHover}static getMultiPickModeEnabled(e){return e.multiPickModeEnabled}static getSearchDisplayMode(e){return e.searchDisplayMode}static getUsePrintImage(e){return e.usePrintImage}static getOpenWindow(e){return e.openWindows.length>0?e.openWindows.sort()[0]:null}static getMenuOpen(e){return e.menuOpen}static getScrim(e){return e.scrim}static shouldWindowOpen(e){return Object(d.h)([cr],t=>t.openWindows.indexOf(e)>=0)}setUI(e,t){const n=e.getState().ui;e.patchState({ui:Object.assign(Object.assign({},n),t.ui)})}setInitialUI(e,t){e.patchState({initialUI:t.ui})}setInputEnabled(e,t){e.patchState({inputEnabled:t.enabled})}setCanHover(e,t){e.patchState({canHover:t.canHover})}setCanTouch(e,t){e.patchState({canTouch:t.canTouch})}setCanFullscreen(e,t){e.patchState({canFullscreen:t.canFullscreen})}setSearchDisplayMode(e,t){e.patchState({searchDisplayMode:t.mode})}setViewLanguage(e,{lang:t}){e.patchState({lang:t})}toggleNodeInfo(e,{show:t}){e.patchState({nodeInfo:Object.assign(Object.assign({},e.getState().nodeInfo),{show:t})})}setNodeInfoConfig(e,{fallback:t}){e.patchState({nodeInfo:Object.assign(Object.assign({},e.getState().nodeInfo),{fallback:t})})}togglePresentation(e,t){e.patchState({presentationActive:t.active})}toggleHelp(e,t){e.patchState({help:{tab:t.tab}})}setLoaderType(e,t){e.patchState({interactType:t.interactType})}setOnDemand(e,t){e.patchState({onDemand:t.onDemand})}setInputMode(e,{inputMode:t}){e.patchState({inputMode:t})}SetLayout(e,t){e.patchState({layout:t.layout})}setTutorial(e,t){const n=e.getState().tutorial;e.patchState({tutorial:Object.assign(Object.assign({},n),t.tutorial)})}startTutorial(e,t){e.patchState({tutorial:Object.assign(Object.assign({},e.getState().tutorial),{pageIndex:t.intro?-1:0})}),e.dispatch(new j.TutorialSeen(!0))}tutorialSeen(e,t){this.storageService.setLocalItem(ir.GettingStartedTutorial,t.seen),e.patchState({tutorialSeen:t.seen})}tutorialPrevious(e,t){const n=e.getState().tutorial,i=Math.max(n.pageIndex-1,0);e.dispatch(new j.SetTutorial(Object.assign(Object.assign({},n),{pageIndex:i})))}tutorialNext(e,t){const n=e.getState().tutorial,i=Math.min(n.pageIndex+1,n.pageSize-1);e.dispatch(new j.SetTutorial(Object.assign(Object.assign({},n),{pageIndex:i})))}setWhiteboardEnabled(e,{enabled:t}){e.patchState({whiteboard:Object.assign(Object.assign({},e.getState().whiteboard),{enabled:t})})}setWhiteboardBrushSize(e,{brushSize:t}){e.patchState({whiteboard:Object.assign(Object.assign({},e.getState().whiteboard),{brushSize:t})})}setWhiteboardTextSize(e,{size:t}){e.patchState({whiteboard:Object.assign(Object.assign({},e.getState().whiteboard),{textSize:t})})}setWhiteboardEraserSize(e,{eraserSize:t}){e.patchState({whiteboard:Object.assign(Object.assign({},e.getState().whiteboard),{eraserSize:t})})}setWhiteboardAnnotateMode(e,{mode:t}){e.patchState({whiteboard:Object.assign(Object.assign({},e.getState().whiteboard),{annotateMode:t})})}setWhiteboardBrushColor(e,{brushColor:t}){e.patchState({whiteboard:Object.assign(Object.assign({},e.getState().whiteboard),{brushColor:t})})}setWhiteboardHasPaint(e,{hasPaint:t}){e.patchState({whiteboard:Object.assign(Object.assign({},e.getState().whiteboard),{hasPaint:t})})}setWhiteboardHasText(e,{hasText:t}){e.patchState({whiteboard:Object.assign(Object.assign({},e.getState().whiteboard),{hasText:t})})}setMultiPickModeEnabled(e,t){e.patchState({multiPickModeEnabled:t.enabled})}setLabelBreakpoint(e,t){e.patchState({labelsBreakpoint:t.labelsBreakpoint})}setUsePrintImage(e,t){e.patchState({usePrintImage:t.usePrintImage})}setWindows(e,t){e.patchState({openWindows:t.windows})}openWindow(e,t){const n=e.getState().openWindows;n.indexOf(t.window)<0&&e.patchState({openWindows:[t.window,...n]})}closeWindow(e,t){let n=e.getState().openWindows;null!=t.window?n=n.filter(e=>e!==t.window):n.shift(),e.patchState({openWindows:[...n]})}toggleWindow(e,t){const n=e.getState().openWindows.indexOf(t.window)>=0;e.dispatch((null!=t.show?t.show:!n)?new j.OpenWindow(t.window):new j.CloseWindow(t.window))}toggleMenu(e,t){e.patchState({menuOpen:t.open})}showScrim(e,t){e.patchState({scrim:{show:!0,label:t.label}})}hideScrim(e,t){e.patchState({scrim:{show:!1,label:""}})}ngxsOnInit(e){Io.onFullscreenChange().subscribe(t=>{e.patchState({fullscreenActive:Io.isFullscreen()})}),e.patchState({tutorialSeen:this.storageService.getLocalJSON(ir.GettingStartedTutorial)||!1})}};return e.\u0275fac=function(t){return new(t||e)(i.Zb(ar))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac}),dr([Object(d.a)(j.SetUI),ur("design:type",Function),ur("design:paramtypes",[Object,j.SetUI]),ur("design:returntype",void 0)],e.prototype,"setUI",null),dr([Object(d.a)(j.SetInitialUI),ur("design:type",Function),ur("design:paramtypes",[Object,j.SetInitialUI]),ur("design:returntype",void 0)],e.prototype,"setInitialUI",null),dr([Object(d.a)(j.SetInputEnabled),ur("design:type",Function),ur("design:paramtypes",[Object,j.SetInputEnabled]),ur("design:returntype",void 0)],e.prototype,"setInputEnabled",null),dr([Object(d.a)(j.SetCanHover),ur("design:type",Function),ur("design:paramtypes",[Object,j.SetCanHover]),ur("design:returntype",void 0)],e.prototype,"setCanHover",null),dr([Object(d.a)(j.SetCanTouch),ur("design:type",Function),ur("design:paramtypes",[Object,j.SetCanTouch]),ur("design:returntype",void 0)],e.prototype,"setCanTouch",null),dr([Object(d.a)(j.SetCanFullscreen),ur("design:type",Function),ur("design:paramtypes",[Object,j.SetCanFullscreen]),ur("design:returntype",void 0)],e.prototype,"setCanFullscreen",null),dr([Object(d.a)(j.SetSearchDisplayMode),ur("design:type",Function),ur("design:paramtypes",[Object,j.SetSearchDisplayMode]),ur("design:returntype",void 0)],e.prototype,"setSearchDisplayMode",null),dr([Object(d.a)(j.SetViewLanguage),ur("design:type",Function),ur("design:paramtypes",[Object,j.SetViewLanguage]),ur("design:returntype",void 0)],e.prototype,"setViewLanguage",null),dr([Object(d.a)(j.ToggleNodeInfo),ur("design:type",Function),ur("design:paramtypes",[Object,j.ToggleNodeInfo]),ur("design:returntype",void 0)],e.prototype,"toggleNodeInfo",null),dr([Object(d.a)(j.SetNodeInfoConfig),ur("design:type",Function),ur("design:paramtypes",[Object,j.SetNodeInfoConfig]),ur("design:returntype",void 0)],e.prototype,"setNodeInfoConfig",null),dr([Object(d.a)(j.TogglePresentation),ur("design:type",Function),ur("design:paramtypes",[Object,j.TogglePresentation]),ur("design:returntype",void 0)],e.prototype,"togglePresentation",null),dr([Object(d.a)(j.ToggleHelpTab),ur("design:type",Function),ur("design:paramtypes",[Object,j.ToggleHelpTab]),ur("design:returntype",void 0)],e.prototype,"toggleHelp",null),dr([Object(d.a)(j.SetInteractType),ur("design:type",Function),ur("design:paramtypes",[Object,j.SetInteractType]),ur("design:returntype",void 0)],e.prototype,"setLoaderType",null),dr([Object(d.a)(j.SetOnDemand),ur("design:type",Function),ur("design:paramtypes",[Object,j.SetOnDemand]),ur("design:returntype",void 0)],e.prototype,"setOnDemand",null),dr([Object(d.a)(j.SetInputMode),ur("design:type",Function),ur("design:paramtypes",[Object,j.SetInputMode]),ur("design:returntype",void 0)],e.prototype,"setInputMode",null),dr([Object(d.a)(j.SetLayout),ur("design:type",Function),ur("design:paramtypes",[Object,j.SetLayout]),ur("design:returntype",void 0)],e.prototype,"SetLayout",null),dr([Object(d.a)(j.SetTutorial),ur("design:type",Function),ur("design:paramtypes",[Object,j.SetTutorial]),ur("design:returntype",void 0)],e.prototype,"setTutorial",null),dr([Object(d.a)(j.StartTutorial),ur("design:type",Function),ur("design:paramtypes",[Object,j.StartTutorial]),ur("design:returntype",void 0)],e.prototype,"startTutorial",null),dr([Object(d.a)(j.TutorialSeen),ur("design:type",Function),ur("design:paramtypes",[Object,j.TutorialSeen]),ur("design:returntype",void 0)],e.prototype,"tutorialSeen",null),dr([Object(d.a)(j.TutorialPrevious),ur("design:type",Function),ur("design:paramtypes",[Object,j.TutorialPrevious]),ur("design:returntype",void 0)],e.prototype,"tutorialPrevious",null),dr([Object(d.a)(j.TutorialNext),ur("design:type",Function),ur("design:paramtypes",[Object,j.TutorialNext]),ur("design:returntype",void 0)],e.prototype,"tutorialNext",null),dr([Object(d.a)(j.SetWhiteboardEnabled),ur("design:type",Function),ur("design:paramtypes",[Object,j.SetWhiteboardEnabled]),ur("design:returntype",void 0)],e.prototype,"setWhiteboardEnabled",null),dr([Object(d.a)(j.SetWhiteboardBrushSize),ur("design:type",Function),ur("design:paramtypes",[Object,j.SetWhiteboardBrushSize]),ur("design:returntype",void 0)],e.prototype,"setWhiteboardBrushSize",null),dr([Object(d.a)(j.SetWhiteboardTextSize),ur("design:type",Function),ur("design:paramtypes",[Object,j.SetWhiteboardTextSize]),ur("design:returntype",void 0)],e.prototype,"setWhiteboardTextSize",null),dr([Object(d.a)(j.SetWhiteboardEraserSize),ur("design:type",Function),ur("design:paramtypes",[Object,j.SetWhiteboardEraserSize]),ur("design:returntype",void 0)],e.prototype,"setWhiteboardEraserSize",null),dr([Object(d.a)(j.SetWhiteboardAnnotateMode),ur("design:type",Function),ur("design:paramtypes",[Object,j.SetWhiteboardAnnotateMode]),ur("design:returntype",void 0)],e.prototype,"setWhiteboardAnnotateMode",null),dr([Object(d.a)(j.SetWhiteboardBrushColor),ur("design:type",Function),ur("design:paramtypes",[Object,j.SetWhiteboardBrushColor]),ur("design:returntype",void 0)],e.prototype,"setWhiteboardBrushColor",null),dr([Object(d.a)(j.SetWhiteboardHasPaint),ur("design:type",Function),ur("design:paramtypes",[Object,j.SetWhiteboardHasPaint]),ur("design:returntype",void 0)],e.prototype,"setWhiteboardHasPaint",null),dr([Object(d.a)(j.SetWhiteboardHasText),ur("design:type",Function),ur("design:paramtypes",[Object,j.SetWhiteboardHasText]),ur("design:returntype",void 0)],e.prototype,"setWhiteboardHasText",null),dr([Object(d.a)(j.SetMultiPickModeEnabled),ur("design:type",Function),ur("design:paramtypes",[Object,j.SetMultiPickModeEnabled]),ur("design:returntype",void 0)],e.prototype,"setMultiPickModeEnabled",null),dr([Object(d.a)(j.SetLabelBreakpoint),ur("design:type",Function),ur("design:paramtypes",[Object,j.SetLabelBreakpoint]),ur("design:returntype",void 0)],e.prototype,"setLabelBreakpoint",null),dr([Object(d.a)(j.SetUsePrintImage),ur("design:type",Function),ur("design:paramtypes",[Object,j.SetUsePrintImage]),ur("design:returntype",void 0)],e.prototype,"setUsePrintImage",null),dr([Object(d.a)(j.SetWindows),ur("design:type",Function),ur("design:paramtypes",[Object,j.SetWindows]),ur("design:returntype",void 0)],e.prototype,"setWindows",null),dr([Object(d.a)(j.OpenWindow),ur("design:type",Function),ur("design:paramtypes",[Object,j.OpenWindow]),ur("design:returntype",void 0)],e.prototype,"openWindow",null),dr([Object(d.a)(j.CloseWindow),ur("design:type",Function),ur("design:paramtypes",[Object,j.CloseWindow]),ur("design:returntype",void 0)],e.prototype,"closeWindow",null),dr([Object(d.a)(j.ToggleWindow),ur("design:type",Function),ur("design:paramtypes",[Object,j.ToggleWindow]),ur("design:returntype",void 0)],e.prototype,"toggleWindow",null),dr([Object(d.a)(j.ToggleMenu),ur("design:type",Function),ur("design:paramtypes",[Object,j.ToggleMenu]),ur("design:returntype",void 0)],e.prototype,"toggleMenu",null),dr([Object(d.a)(j.ShowScrim),ur("design:type",Function),ur("design:paramtypes",[Object,j.ShowScrim]),ur("design:returntype",void 0)],e.prototype,"showScrim",null),dr([Object(d.a)(j.HideScrim),ur("design:type",Function),ur("design:paramtypes",[Object,j.HideScrim]),ur("design:returntype",void 0)],e.prototype,"hideScrim",null),dr([Object(d.e)(),ur("design:type",Function),ur("design:paramtypes",[gr]),ur("design:returntype",void 0)],e,"getUI",null),dr([Object(d.e)(),ur("design:type",Function),ur("design:paramtypes",[gr]),ur("design:returntype",void 0)],e,"getInitialUI",null),dr([Object(d.e)(),ur("design:type",Function),ur("design:paramtypes",[gr]),ur("design:returntype",void 0)],e,"getLabelsBreakpoint",null),dr([Object(d.e)(),ur("design:type",Function),ur("design:paramtypes",[gr]),ur("design:returntype",void 0)],e,"getInputEnabled",null),dr([Object(d.e)(),ur("design:type",Function),ur("design:paramtypes",[gr]),ur("design:returntype",void 0)],e,"getFullscreenActive",null),dr([Object(d.e)(),ur("design:type",Function),ur("design:paramtypes",[gr]),ur("design:returntype",void 0)],e,"getPresentationActive",null),dr([Object(d.e)(),ur("design:type",Function),ur("design:paramtypes",[gr]),ur("design:returntype",void 0)],e,"getDrawerCoversContent",null),dr([Object(d.e)(),ur("design:type",Function),ur("design:paramtypes",[gr]),ur("design:returntype",void 0)],e,"getShowNodeInfo",null),dr([Object(d.e)(),ur("design:type",Function),ur("design:paramtypes",[gr]),ur("design:returntype",void 0)],e,"getNodeInfoFallback",null),dr([Object(d.e)(),ur("design:type",Function),ur("design:paramtypes",[gr]),ur("design:returntype",void 0)],e,"getViewLanguage",null),dr([Object(d.e)(),ur("design:type",Function),ur("design:paramtypes",[gr]),ur("design:returntype",void 0)],e,"getInteractType",null),dr([Object(d.e)(),ur("design:type",Function),ur("design:paramtypes",[gr]),ur("design:returntype",void 0)],e,"getOnDemand",null),dr([Object(d.e)(),ur("design:type",Function),ur("design:paramtypes",[gr]),ur("design:returntype",void 0)],e,"getLayout",null),dr([Object(d.e)(),ur("design:type",Function),ur("design:paramtypes",[gr]),ur("design:returntype",void 0)],e,"getInputMode",null),dr([Object(d.e)(),ur("design:type",Function),ur("design:paramtypes",[gr]),ur("design:returntype",void 0)],e,"getShowHelpTab",null),dr([Object(d.e)(),ur("design:type",Function),ur("design:paramtypes",[gr]),ur("design:returntype",void 0)],e,"getTutorial",null),dr([Object(d.e)(),ur("design:type",Function),ur("design:paramtypes",[gr]),ur("design:returntype",void 0)],e,"getTutorialSeen",null),dr([Object(d.e)(),ur("design:type",Function),ur("design:paramtypes",[gr]),ur("design:returntype",void 0)],e,"getWhiteboardEnabled",null),dr([Object(d.e)(),ur("design:type",Function),ur("design:paramtypes",[gr]),ur("design:returntype",void 0)],e,"getWhiteboardBrushSize",null),dr([Object(d.e)(),ur("design:type",Function),ur("design:paramtypes",[gr]),ur("design:returntype",void 0)],e,"getWhiteboardTextSize",null),dr([Object(d.e)(),ur("design:type",Function),ur("design:paramtypes",[gr]),ur("design:returntype",void 0)],e,"getWhiteboardEraserSize",null),dr([Object(d.e)(),ur("design:type",Function),ur("design:paramtypes",[gr]),ur("design:returntype",void 0)],e,"getWhiteboardAnnotateMode",null),dr([Object(d.e)(),ur("design:type",Function),ur("design:paramtypes",[gr]),ur("design:returntype",void 0)],e,"getWhiteboardBrushColor",null),dr([Object(d.e)(),ur("design:type",Function),ur("design:paramtypes",[gr]),ur("design:returntype",void 0)],e,"getWhiteboardHasPaint",null),dr([Object(d.e)(),ur("design:type",Function),ur("design:paramtypes",[gr]),ur("design:returntype",void 0)],e,"getWhiteboardHasText",null),dr([Object(d.e)(),ur("design:type",Function),ur("design:paramtypes",[gr]),ur("design:returntype",void 0)],e,"getCanTouch",null),dr([Object(d.e)(),ur("design:type",Function),ur("design:paramtypes",[gr]),ur("design:returntype",void 0)],e,"getCanHover",null),dr([Object(d.e)(),ur("design:type",Function),ur("design:paramtypes",[gr]),ur("design:returntype",void 0)],e,"getMultiPickModeEnabled",null),dr([Object(d.e)(),ur("design:type",Function),ur("design:paramtypes",[gr]),ur("design:returntype",void 0)],e,"getSearchDisplayMode",null),dr([Object(d.e)(),ur("design:type",Function),ur("design:paramtypes",[gr]),ur("design:returntype",void 0)],e,"getUsePrintImage",null),dr([Object(d.e)(),ur("design:type",Function),ur("design:paramtypes",[gr]),ur("design:returntype",void 0)],e,"getOpenWindow",null),dr([Object(d.e)(),ur("design:type",Function),ur("design:paramtypes",[gr]),ur("design:returntype",void 0)],e,"getMenuOpen",null),dr([Object(d.e)(),ur("design:type",Function),ur("design:paramtypes",[gr]),ur("design:returntype",void 0)],e,"getScrim",null),e=cr=dr([Object(d.f)({name:"view",defaults:br})],e),e})();var fr,yr=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},xr=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const vr={loading:!1,chapters:[],chaptersViewed:[],selectedChapter:null,isChapterAnimated:!1,thumbnails:new Map,patches:[],inversePatches:[]};let Or=(()=>{let e=fr=class{constructor(e,t,n,i){this.store=e,this.chapterService=t,this.animationService=n,this.engineService=i}static getStoryChapters(e){return e.chapters}static getChaptersViewed(e){return e.chaptersViewed}static getChapter(e){return Object(d.h)([fr],t=>t.chapters.find(t=>t.id===e))}static getSelectedChapterId(e){return e.selectedChapter}static getSelectedChapter(e){return e.chapters.find(t=>t.id===e.selectedChapter)||null}static getNextChapter(e){const t=1+fr.getSelectedChapterIndex(e);return e.chapters[t]}static getPreviousChapter(e){const t=-1+fr.getSelectedChapterIndex(e);return e.chapters[t]}static getSelectedChapterIndex(e){return e.chapters.findIndex(t=>t.id===e.selectedChapter)}static getSelectedChapterTitle(e){return e.chapters.find(t=>t.id===e.selectedChapter).info.displayName}static getChapterCount(e){return e.chapters.length}static getRegisteredThumbnails(e){return e.thumbnails}static getIsChapterAnimated(e){return e.isChapterAnimated}static getSelectedChapterReadyState(e){const{chapters:t,selectedChapter:n}=e,i=fr.findChapter(t,n);return Object(D.get)(i,"readyState")}static getChaptersLoaded(e){return{count:e.chapters.length,modelChapters:e.chapters.filter(e=>e.readyState.model),animationChapters:e.chapters.filter(e=>e.readyState.animation)}}static getAllChaptersModelsReady(e){return e.chapters.length>0&&e.chapters.every(e=>e.readyState.model)}static getSelectedChapterModelReady(e){const t=fr.getSelectedChapterReadyState(e);return!Object(D.isNil)(t)&&t.model}static getAllChaptersAnimationsReady(e){return e.chapters.length>0&&e.chapters.every(e=>e.readyState.animation)}static getSelectedChapterBackground(e){const{chapters:t,selectedChapter:n}=e,i=fr.findChapter(t,n);return Object(D.get)(i,"background")||Os}static getAllChaptersBackground(e){return e.chapters.map(e=>Object(D.get)(e,"background"))}static getSelectedChapterAllAudio(e){const t=e.chapters.find(t=>t.id===e.selectedChapter);return t&&t.media?Object.values(t.media).filter(({data:e})=>"audio"===e.streamType):[]}static getSelectedChapterAudio(e,t){return this.getSelectedChapterAllAudio(e).find(e=>e.data.lang===t.lang)}static getSelectedChapterLegend(e){const{chapters:t,selectedChapter:n}=e,i=fr.findChapter(t,n);return Object(D.get)(i,"legend")||[]}static getSelectedChapterClippingPlanes(e){const{chapters:t,selectedChapter:n}=e,i=fr.findChapter(t,n);return Object(D.get)(i,"clippingPlanes")}static getChapterCamera(e){const{chapters:t,selectedChapter:n}=e,i=fr.findChapter(t,n);return Object(D.get)(i,"camera.location")}static findChapter(e,t){return e.find(e=>e.id===t)}static getAllChaptersCurrentLayers(e){return e.chapters.map(e=>Object(D.get)(e,"visibilityLayers.current.layers",[]))}static getSelectedChapterSrcLayers(e){const{chapters:t,selectedChapter:n}=e,i=fr.findChapter(t,n);return Object(D.get)(i,"visibilityLayers.src.layers",[])}static getSelectedChapterCurrentLayers(e){const{chapters:t,selectedChapter:n}=e,i=fr.findChapter(t,n);return Object(D.get)(i,"visibilityLayers.current.layers",[])}static getSelectedChapterCurrentLayersIndex(e){const{chapters:t,selectedChapter:n}=e,i=fr.findChapter(t,n);return Object(D.get)(i,"visibilityLayers.current.index")}static getSelectedChapterCurrentLayersPosition(e){const{chapters:t,selectedChapter:n}=e,i=fr.findChapter(t,n);return Object(D.get)(i,"visibilityLayers.current.position")}static getSelectedChapterContentBlocks(e){const{chapters:t,selectedChapter:n}=e,i=fr.findChapter(t,n);return Object(D.get)(i,"contentBlocks",[])}static getSelectedChapterTimelineMap(e){const{chapters:t,selectedChapter:n}=e,i=fr.findChapter(t,n);return Object(D.get)(i,"timelineMap")||[]}setChapters(e,t){e.patchState(immer.produce(e.getState(),e=>{e.chapters=t.chapters}))}SetChapterCameraAction(e,t){e.patchState(immer.produce(e.getState(),e=>{e.chapters.find(e=>e.id===t.chapterId).camera.action=t.cameraAction}))}setChapterUI(e,t){e.patchState(immer.produce(e.getState(),e=>{e.chapters.find(e=>e.id===t.chapterId).ui=t.ui}))}setChapterInfo(e,t){e.patchState(immer.produce(e.getState(),e=>{e.chapters.find(e=>e.id===t.chapterId).info=t.info}))}setChapterLegend(e,t){e.patchState(immer.produce(e.getState(),e=>{e.chapters.find(e=>e.id===t.chapterId).legend=t.legend}))}addToChapterLegend(e,t){e.patchState(immer.produce(e.getState(),e=>{e.chapters.find(e=>e.id===t.chapterId).legend.push(t.legend)}))}ReorderChapters(e,t){e.patchState(immer.produce(e.getState(),e=>{Object(So.c)(e.chapters,t.previousIndex,t.currentIndex)}));const n=e.getState().chapters.map(e=>e.id);e.dispatch(new ns.ReorderQuestions(n))}SetChapterReadyState(e,t){const n=immer.produce(e.getState(),e=>{if(t.chapterId){const n=e.chapters.find(e=>e.id===t.chapterId);n&&(n.readyState=Object.assign(Object.assign({},n.readyState),t.readyState))}});e.patchState(n)}SetChapterPostProcessing(e,t){e.patchState(immer.produce(e.getState(),e=>{const n=e.chapters.find(e=>e.id===t.chapterId),i=n.properties||{};n.customData=Object.assign(Object.assign({},n.customData?n.customData:{}),{postprocess:t.effects}),n.properties=Object.assign(Object.assign({},i),t.properties)}))}SetChapterTransitions(e,t){e.patchState(immer.produce(e.getState(),e=>{const n=e.chapters.find(e=>e.id===t.chapterId);n.transitions=n.transitions||{},n.transitions[t.key]=t.transition}))}setChapterProperties(e,t){const n=t.chapterIds,i=t.properties;e.patchState(immer.produce(e.getState(),e=>{e.chapters.filter(e=>n.includes(e.id)).forEach(e=>{var t;const n=null!==(t=e.properties)&&void 0!==t?t:{};e.properties=Object.assign(Object.assign({},n),i)})}))}removeChapterProperties(e,t){const n=t.chapterIds,i=t.properties;e.patchState(immer.produce(e.getState(),e=>{e.chapters.filter(e=>n.includes(e.id)).forEach(e=>{(null==e?void 0:e.properties)&&i.forEach(t=>{delete e.properties[t]})})}))}SetChapterTransparencyMode(e,t){e.patchState(immer.produce(e.getState(),e=>{e.chapters.find(e=>e.id===t.chapterId).transparencyMode=t.transparencyMode}))}applyChapterPatch(e,t){const n=immer.applyPatches(e.getState(),t.patches);e.patchState(immer.produce(n,e=>{e.patches=[],e.inversePatches=[]}))}setChapterClippingPlane(e,t){const[n,i,s]=immer.produceWithPatches(e.getState(),e=>{const n=e.chapters.find(e=>e.id===t.chapterId);n.clippingPlanes.clips=t.clips,n.clippingPlanes.enabled=t.enabled,n.clippingPlanes.boundary=n.clippingPlanes.boundary||JSON.parse(JSON.stringify(this.engineService.getSceneBoundary()))}),o=immer.produce(n,e=>{e.patches.push(...i),e.inversePatches.push(...s)});t.record&&e.dispatch(new zi.SavePatches([{forward:o.patches,inverse:[...o.inversePatches].reverse(),patchAction:wn}])),e.patchState(t.record?immer.produce(o,e=>{e.patches=[],e.inversePatches=[]}):o)}setChapterBackground(e,t){e.patchState(immer.produce(e.getState(),e=>{e.chapters.find(e=>e.id===t.chapterId).background=t.background}))}setAllChaptersBackground(e,t){e.patchState(immer.produce(e.getState(),e=>{e.chapters.forEach(e=>{e.background=t.background})}))}resetSelectedChapterBackground(e,t){const{selectedChapter:n}=e.getState();this.store.dispatch(new Hn(n,Os))}setSelectedChapterBackground(e,{background:t}){const n=e.getState().selectedChapter;this.store.dispatch(new Hn(n,t))}selectChapter(e,t){if(!t.chapter)return;this.store.dispatch([new Ii.UpdateNodesChecked(!1),new Ii.UpdateNodeSelected]);const n=this.animationService.isChapterAnimated(t.chapter);this.store.dispatch(new Ne(!!t.chapter));const i=immer.produce(e.getState(),e=>{e.chaptersViewed.some(e=>t.chapter.id===e)||e.chaptersViewed.push(t.chapter.id),e.selectedChapter=t.chapter?t.chapter.id:null,e.isChapterAnimated=n});e.patchState(i)}selectChapterById(e,{chapterId:t}){this.store.dispatch(new Ne(!0)),e.patchState({selectedChapter:t})}duplicateChapter(e,t){const n=t.chapter,i=this.chapterService.copyChapter(n,t.chapterId),s=e.getState().chapters.length,o=this.store.selectSnapshot(fr.getSelectedChapterBackground),r=this.store.selectSnapshot(qs.getRegisteredThumbnails),a=r.get(n.id);n.thumbnails?i.thumbnails=Object(D.cloneDeep)(n.thumbnails):Object(D.isNil)(a)?e.dispatch(new Ss(i.id,o,ws.JPEG,92,js.medium,"square")):r.set(i.id,a);const c=this.chapterService.addChapterToEngine(Object(D.cloneDeep)(i),s);i.timelineMap=Object.values(c.maps).map(e=>this.animationService.fromEngineTimelineMap(e)),e.patchState(immer.produce(e.getState(),e=>{e.chapters.push(i)})),e.dispatch(new ns.CopyQuestions(n.id,i.id)),e.dispatch(new co(n,i))}nextChapter(e,t){const n=e.getState().chapters,i=this.chapterService.getCurrentChapterId();let s=0;s=n.findIndex(e=>e.id===i),s<n.length-1&&s++,e.dispatch(new kn(n[s]))}previousChapter(e,t){const n=e.getState().chapters,i=this.chapterService.getCurrentChapterId();let s=0;s=n.findIndex(e=>e.id===i),s>0&&s--,e.dispatch(new kn(n[s]))}lastChapter(e,t){const n=e.getState().chapters;e.dispatch(new kn(n[n.length-1]))}firstChapter(e,t){const n=e.getState().chapters;e.dispatch(new kn(n[0]))}removeChapter(e,t){const{chapters:n,selectedChapter:i}=e.getState();if(1===n.length)return;this.chapterService.removeChapterFromEngine(t.chapter);const s=n.findIndex(e=>e.id===t.chapter.id);if(e.patchState(immer.produce(e.getState(),e=>{e.chapters.splice(s,1)})),t.chapter.id===i){const t=e.getState().chapters,n=Math.min(s,t.length-1);e.dispatch(new kn(t[n]))}e.dispatch(new uo(t.chapter))}resetStoryChaptersState(e,t){e.setState(vr)}RecordCamera(e,t){e.patchState(immer.produce(e.getState(),e=>{const n=e.chapters.find(e=>e.id===t.chapterId);n.camera.location=t.camera,t.rotationCenter&&(n.camera.rotationCenter=t.rotationCenter)}))}setChapterCurrentLayersIndexPosition(e,t){const[n,i,s]=immer.produceWithPatches(e.getState(),e=>{const n=e.chapters.find(e=>e.id===t.chapterId).visibilityLayers.current;n.index=t.index,n.position=t.position}),o=immer.produce(n,e=>{e.patches.push(...i),e.inversePatches.push(...s)});e.patchState(o),t.record&&e.dispatch(new zi.SavePatches([{forward:o.patches,inverse:o.inversePatches,patchAction:wn}]))}setChapterMedia(e,t){e.patchState(immer.produce(e.getState(),e=>{e.chapters.find(e=>e.id===t.chapterId).media=t.media}))}setChapterContentBlocks(e,t){t.contentBlocks=[...t.contentBlocks.filter(e=>e.type===is.Ticker),...t.contentBlocks.filter(e=>e.type!==is.Ticker)],e.patchState(immer.produce(e.getState(),e=>{e.chapters.find(e=>e.id===t.chapterId).contentBlocks=t.contentBlocks}))}addChapterTimelineMap(e,t){e.patchState(immer.produce(e.getState(),e=>{const n=e.chapters.find(e=>e.id===t.chapterId);n.timelineMap.push.apply(n.timelineMap,t.timelineMaps)}))}updateChapterTimelineMap(e,t){e.patchState(immer.produce(e.getState(),e=>{const n=e.chapters.find(e=>e.id===t.chapterId);t.updates.forEach(e=>{const t=n.timelineMap.find(t=>t.id===e.id);Object(D.merge)(t,e)})}))}removeFromChapterTimelineMap(e,t){e.patchState(immer.produce(e.getState(),e=>{const n=e.chapters.find(e=>e.id===t.chapterId);t.timelineMapIds.forEach(e=>{const t=n.timelineMap.findIndex(t=>t.id===e);n.timelineMap.splice(t,1)})}))}SetChapterLights(e,t){e.patchState(immer.produce(e.getState(),e=>{e.chapters.find(e=>e.id===t.chapterId).lights.libraries=[t.lights]})),this.engineService.setBranchLights(t.chapterId,t.lights)}};return e.\u0275fac=function(t){return new(t||e)(i.Zb(d.g),i.Zb(to),i.Zb(eo),i.Zb(Qt))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac}),yr([Object(d.a)(Mn),xr("design:type",Function),xr("design:paramtypes",[Object,Mn]),xr("design:returntype",void 0)],e.prototype,"setChapters",null),yr([Object(d.a)(In),xr("design:type",Function),xr("design:paramtypes",[Object,In]),xr("design:returntype",void 0)],e.prototype,"SetChapterCameraAction",null),yr([Object(d.a)(zn),xr("design:type",Function),xr("design:paramtypes",[Object,zn]),xr("design:returntype",void 0)],e.prototype,"setChapterUI",null),yr([Object(d.a)(Tn),xr("design:type",Function),xr("design:paramtypes",[Object,Tn]),xr("design:returntype",void 0)],e.prototype,"setChapterInfo",null),yr([Object(d.a)(Un),xr("design:type",Function),xr("design:paramtypes",[Object,Un]),xr("design:returntype",void 0)],e.prototype,"setChapterLegend",null),yr([Object(d.a)(Dn),xr("design:type",Function),xr("design:paramtypes",[Object,Dn]),xr("design:returntype",void 0)],e.prototype,"addToChapterLegend",null),yr([Object(d.a)(Ln),xr("design:type",Function),xr("design:paramtypes",[Object,Ln]),xr("design:returntype",void 0)],e.prototype,"ReorderChapters",null),yr([Object(d.a)(En),xr("design:type",Function),xr("design:paramtypes",[Object,En]),xr("design:returntype",void 0)],e.prototype,"SetChapterReadyState",null),yr([Object(d.a)(Fn),xr("design:type",Function),xr("design:paramtypes",[Object,Fn]),xr("design:returntype",void 0)],e.prototype,"SetChapterPostProcessing",null),yr([Object(d.a)(An),xr("design:type",Function),xr("design:paramtypes",[Object,An]),xr("design:returntype",void 0)],e.prototype,"SetChapterTransitions",null),yr([Object(d.a)(Rn),xr("design:type",Function),xr("design:paramtypes",[Object,Rn]),xr("design:returntype",void 0)],e.prototype,"setChapterProperties",null),yr([Object(d.a)(Vn),xr("design:type",Function),xr("design:paramtypes",[Object,Vn]),xr("design:returntype",void 0)],e.prototype,"removeChapterProperties",null),yr([Object(d.a)(Nn),xr("design:type",Function),xr("design:paramtypes",[Object,Nn]),xr("design:returntype",void 0)],e.prototype,"SetChapterTransparencyMode",null),yr([Object(d.a)(wn),xr("design:type",Function),xr("design:paramtypes",[Object,wn]),xr("design:returntype",void 0)],e.prototype,"applyChapterPatch",null),yr([Object(d.a)(Bn),xr("design:type",Function),xr("design:paramtypes",[Object,Bn]),xr("design:returntype",void 0)],e.prototype,"setChapterClippingPlane",null),yr([Object(d.a)(Hn),xr("design:type",Function),xr("design:paramtypes",[Object,Hn]),xr("design:returntype",void 0)],e.prototype,"setChapterBackground",null),yr([Object(d.a)(Qn),xr("design:type",Function),xr("design:paramtypes",[Object,Qn]),xr("design:returntype",void 0)],e.prototype,"setAllChaptersBackground",null),yr([Object(d.a)($n),xr("design:type",Function),xr("design:paramtypes",[Object,$n]),xr("design:returntype",void 0)],e.prototype,"resetSelectedChapterBackground",null),yr([Object(d.a)(qn),xr("design:type",Function),xr("design:paramtypes",[Object,Object]),xr("design:returntype",void 0)],e.prototype,"setSelectedChapterBackground",null),yr([Object(d.a)(kn),xr("design:type",Function),xr("design:paramtypes",[Object,kn]),xr("design:returntype",void 0)],e.prototype,"selectChapter",null),yr([Object(d.a)(Pn),xr("design:type",Function),xr("design:paramtypes",[Object,Object]),xr("design:returntype",void 0)],e.prototype,"selectChapterById",null),yr([Object(d.a)(Wn),xr("design:type",Function),xr("design:paramtypes",[Object,Wn]),xr("design:returntype",void 0)],e.prototype,"duplicateChapter",null),yr([Object(d.a)(Cn),xr("design:type",Function),xr("design:paramtypes",[Object,Cn]),xr("design:returntype",void 0)],e.prototype,"nextChapter",null),yr([Object(d.a)(Sn),xr("design:type",Function),xr("design:paramtypes",[Object,Sn]),xr("design:returntype",void 0)],e.prototype,"previousChapter",null),yr([Object(d.a)(jn),xr("design:type",Function),xr("design:paramtypes",[Object,jn]),xr("design:returntype",void 0)],e.prototype,"lastChapter",null),yr([Object(d.a)(_n),xr("design:type",Function),xr("design:paramtypes",[Object,jn]),xr("design:returntype",void 0)],e.prototype,"firstChapter",null),yr([Object(d.a)(Kn),xr("design:type",Function),xr("design:paramtypes",[Object,Kn]),xr("design:returntype",void 0)],e.prototype,"removeChapter",null),yr([Object(d.a)(Gn),xr("design:type",Function),xr("design:paramtypes",[Object,Gn]),xr("design:returntype",void 0)],e.prototype,"resetStoryChaptersState",null),yr([Object(d.a)(Zn),xr("design:type",Function),xr("design:paramtypes",[Object,Zn]),xr("design:returntype",void 0)],e.prototype,"RecordCamera",null),yr([Object(d.a)(Jn),xr("design:type",Function),xr("design:paramtypes",[Object,Jn]),xr("design:returntype",void 0)],e.prototype,"setChapterCurrentLayersIndexPosition",null),yr([Object(d.a)(Xn),xr("design:type",Function),xr("design:paramtypes",[Object,Xn]),xr("design:returntype",void 0)],e.prototype,"setChapterMedia",null),yr([Object(d.a)(Yn),xr("design:type",Function),xr("design:paramtypes",[Object,Yn]),xr("design:returntype",void 0)],e.prototype,"setChapterContentBlocks",null),yr([Object(d.a)(ei),xr("design:type",Function),xr("design:paramtypes",[Object,ei]),xr("design:returntype",void 0)],e.prototype,"addChapterTimelineMap",null),yr([Object(d.a)(ti),xr("design:type",Function),xr("design:paramtypes",[Object,ti]),xr("design:returntype",void 0)],e.prototype,"updateChapterTimelineMap",null),yr([Object(d.a)(ni),xr("design:type",Function),xr("design:paramtypes",[Object,ni]),xr("design:returntype",void 0)],e.prototype,"removeFromChapterTimelineMap",null),yr([Object(d.a)(ii),xr("design:type",Function),xr("design:paramtypes",[Object,ii]),xr("design:returntype",void 0)],e.prototype,"SetChapterLights",null),yr([Object(d.e)(),xr("design:type",Function),xr("design:paramtypes",[On]),xr("design:returntype",void 0)],e,"getStoryChapters",null),yr([Object(d.e)(),xr("design:type",Function),xr("design:paramtypes",[On]),xr("design:returntype",void 0)],e,"getChaptersViewed",null),yr([Object(d.e)(),xr("design:type",Function),xr("design:paramtypes",[On]),xr("design:returntype",void 0)],e,"getSelectedChapterId",null),yr([Object(d.e)(),xr("design:type",Function),xr("design:paramtypes",[On]),xr("design:returntype",void 0)],e,"getSelectedChapter",null),yr([Object(d.e)(),xr("design:type",Function),xr("design:paramtypes",[On]),xr("design:returntype",void 0)],e,"getNextChapter",null),yr([Object(d.e)(),xr("design:type",Function),xr("design:paramtypes",[On]),xr("design:returntype",void 0)],e,"getPreviousChapter",null),yr([Object(d.e)(),xr("design:type",Function),xr("design:paramtypes",[On]),xr("design:returntype",void 0)],e,"getSelectedChapterIndex",null),yr([Object(d.e)(),xr("design:type",Function),xr("design:paramtypes",[On]),xr("design:returntype",void 0)],e,"getSelectedChapterTitle",null),yr([Object(d.e)(),xr("design:type",Function),xr("design:paramtypes",[On]),xr("design:returntype",void 0)],e,"getChapterCount",null),yr([Object(d.e)(),xr("design:type",Function),xr("design:paramtypes",[On]),xr("design:returntype",void 0)],e,"getRegisteredThumbnails",null),yr([Object(d.e)(),xr("design:type",Function),xr("design:paramtypes",[On]),xr("design:returntype",void 0)],e,"getIsChapterAnimated",null),yr([Object(d.e)(),xr("design:type",Function),xr("design:paramtypes",[On]),xr("design:returntype",void 0)],e,"getSelectedChapterReadyState",null),yr([Object(d.e)(),xr("design:type",Function),xr("design:paramtypes",[On]),xr("design:returntype",void 0)],e,"getChaptersLoaded",null),yr([Object(d.e)(),xr("design:type",Function),xr("design:paramtypes",[On]),xr("design:returntype",void 0)],e,"getAllChaptersModelsReady",null),yr([Object(d.e)(),xr("design:type",Function),xr("design:paramtypes",[On]),xr("design:returntype",void 0)],e,"getSelectedChapterModelReady",null),yr([Object(d.e)(),xr("design:type",Function),xr("design:paramtypes",[On]),xr("design:returntype",void 0)],e,"getAllChaptersAnimationsReady",null),yr([Object(d.e)(),xr("design:type",Function),xr("design:paramtypes",[On]),xr("design:returntype",void 0)],e,"getSelectedChapterBackground",null),yr([Object(d.e)(),xr("design:type",Function),xr("design:paramtypes",[On]),xr("design:returntype",void 0)],e,"getAllChaptersBackground",null),yr([Object(d.e)(),xr("design:type",Function),xr("design:paramtypes",[On]),xr("design:returntype",void 0)],e,"getSelectedChapterAllAudio",null),yr([Object(d.e)([mr]),xr("design:type",Function),xr("design:paramtypes",[On,gr]),xr("design:returntype",void 0)],e,"getSelectedChapterAudio",null),yr([Object(d.e)(),xr("design:type",Function),xr("design:paramtypes",[On]),xr("design:returntype",void 0)],e,"getSelectedChapterLegend",null),yr([Object(d.e)(),xr("design:type",Function),xr("design:paramtypes",[On]),xr("design:returntype",void 0)],e,"getSelectedChapterClippingPlanes",null),yr([Object(d.e)(),xr("design:type",Function),xr("design:paramtypes",[On]),xr("design:returntype",void 0)],e,"getChapterCamera",null),yr([Object(d.e)(),xr("design:type",Function),xr("design:paramtypes",[On]),xr("design:returntype",Array)],e,"getAllChaptersCurrentLayers",null),yr([Object(d.e)(),xr("design:type",Function),xr("design:paramtypes",[On]),xr("design:returntype",Array)],e,"getSelectedChapterSrcLayers",null),yr([Object(d.e)(),xr("design:type",Function),xr("design:paramtypes",[On]),xr("design:returntype",Array)],e,"getSelectedChapterCurrentLayers",null),yr([Object(d.e)(),xr("design:type",Function),xr("design:paramtypes",[On]),xr("design:returntype",Number)],e,"getSelectedChapterCurrentLayersIndex",null),yr([Object(d.e)(),xr("design:type",Function),xr("design:paramtypes",[On]),xr("design:returntype",Number)],e,"getSelectedChapterCurrentLayersPosition",null),yr([Object(d.e)(),xr("design:type",Function),xr("design:paramtypes",[On]),xr("design:returntype",Array)],e,"getSelectedChapterContentBlocks",null),yr([Object(d.e)(),xr("design:type",Function),xr("design:paramtypes",[On]),xr("design:returntype",Array)],e,"getSelectedChapterTimelineMap",null),e=fr=yr([Object(d.f)({name:"storyChapters",defaults:vr})],e),e})();var wr,Cr=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},Sr=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const _r={storedCameras:{},cameraMotion:new xn,panMode:"rotate",zoomed:!1,lockCamera:!1,cameraFlyTo:void 0,chapterCameraEnabled:!0};let jr=(()=>{let e=wr=class{constructor(e,t){this.cameraService=e,this.store=t}static getStoredCamera(e){return Object(d.h)([wr],t=>t.storedCameras[e]||null)}static getCameraMotion(e){return e.cameraMotion}static getPanMode(e){return e.panMode}static getZoomed(e){return e.zoomed}static getLockCamera(e){return e.lockCamera}static getChapterCameraEnabled(e){return e.chapterCameraEnabled}storeCamera(e,t){const n=t.camera||this.cameraService.getCamera(),i=e.getState().storedCameras;i[t.id]=Object.assign({},n),e.patchState({storedCameras:Object.assign({},i)})}clearCamera(e,t){const n=e.getState().storedCameras;delete n[t.id],e.patchState({storedCameras:Object.assign({},n)})}setCameraFlyTo(e,t){e.patchState(immer.produce(e.getState(),e=>{e.cameraFlyTo=t.camera}))}applyCameraPatch(e,t){const n=immer.applyPatches(e.getState(),t.patches);e.patchState(n);const i=void 0===n.cameraFlyTo?this.store.selectSnapshot(Or.getChapterCamera):n.cameraFlyTo;e.dispatch(new Zt(i,!0,1))}moveCamera(e,t){e.patchState({cameraMotion:Object.assign({},t.cameraMotion)})}resetCamera(e,t){return this.cameraService.resetCamera().pipe(Object(vn.a)(()=>{e.patchState({cameraMotion:new xn})}))}zoomCamera(e,t){const{cameraMotion:n}=e.getState();n.zoom=t.value,e.patchState({cameraMotion:Object.assign({},n)})}panCameraX(e,t){const{cameraMotion:n}=e.getState();n.panX=t.value,e.patchState({cameraMotion:Object.assign({},n)})}panCameraY(e,t){const{cameraMotion:n}=e.getState();n.panY=t.value,e.patchState({cameraMotion:Object.assign({},n)})}rotateCameraX(e,t){const{cameraMotion:n}=e.getState();e.patchState({cameraMotion:Object.assign(Object.assign({},n),{rotateX:t.value})})}rotateCameraY(e,t){const{cameraMotion:n}=e.getState();n.rotateY=t.value,e.patchState({cameraMotion:Object.assign({},n)})}SetCameraMode(e,t){e.patchState({panMode:t.mode})}setZoomed(e,t){e.patchState({zoomed:t.zoomed})}lockCamera(e,t){e.patchState({lockCamera:t.lock})}setChapterCameraEnabled(e,t){this.cameraService.setChapterCameraEnabled(t.enabled),e.patchState({chapterCameraEnabled:t.enabled})}};return e.\u0275fac=function(t){return new(t||e)(i.Zb(yn),i.Zb(d.g))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac}),Cr([Object(d.a)(Gt),Sr("design:type",Function),Sr("design:paramtypes",[Object,Gt]),Sr("design:returntype",void 0)],e.prototype,"storeCamera",null),Cr([Object(d.a)(Kt),Sr("design:type",Function),Sr("design:paramtypes",[Object,Kt]),Sr("design:returntype",void 0)],e.prototype,"clearCamera",null),Cr([Object(d.a)(gn),Sr("design:type",Function),Sr("design:paramtypes",[Object,gn]),Sr("design:returntype",void 0)],e.prototype,"setCameraFlyTo",null),Cr([Object(d.a)(hn),Sr("design:type",Function),Sr("design:paramtypes",[Object,hn]),Sr("design:returntype",void 0)],e.prototype,"applyCameraPatch",null),Cr([Object(d.a)(Yt),Sr("design:type",Function),Sr("design:paramtypes",[Object,Yt]),Sr("design:returntype",void 0)],e.prototype,"moveCamera",null),Cr([Object(d.a)(en),Sr("design:type",Function),Sr("design:paramtypes",[Object,en]),Sr("design:returntype",void 0)],e.prototype,"resetCamera",null),Cr([Object(d.a)(tn),Sr("design:type",Function),Sr("design:paramtypes",[Object,tn]),Sr("design:returntype",void 0)],e.prototype,"zoomCamera",null),Cr([Object(d.a)(sn),Sr("design:type",Function),Sr("design:paramtypes",[Object,sn]),Sr("design:returntype",void 0)],e.prototype,"panCameraX",null),Cr([Object(d.a)(on),Sr("design:type",Function),Sr("design:paramtypes",[Object,on]),Sr("design:returntype",void 0)],e.prototype,"panCameraY",null),Cr([Object(d.a)(an),Sr("design:type",Function),Sr("design:paramtypes",[Object,an]),Sr("design:returntype",void 0)],e.prototype,"rotateCameraX",null),Cr([Object(d.a)(cn),Sr("design:type",Function),Sr("design:paramtypes",[Object,cn]),Sr("design:returntype",void 0)],e.prototype,"rotateCameraY",null),Cr([Object(d.a)(pn),Sr("design:type",Function),Sr("design:paramtypes",[Object,pn]),Sr("design:returntype",void 0)],e.prototype,"SetCameraMode",null),Cr([Object(d.a)(dn),Sr("design:type",Function),Sr("design:paramtypes",[Object,dn]),Sr("design:returntype",void 0)],e.prototype,"setZoomed",null),Cr([Object(d.a)(un),Sr("design:type",Function),Sr("design:paramtypes",[Object,un]),Sr("design:returntype",void 0)],e.prototype,"lockCamera",null),Cr([Object(d.a)(Xt),Sr("design:type",Function),Sr("design:paramtypes",[Object,Xt]),Sr("design:returntype",void 0)],e.prototype,"setChapterCameraEnabled",null),Cr([Object(d.e)(),Sr("design:type",Function),Sr("design:paramtypes",[Wt]),Sr("design:returntype",void 0)],e,"getCameraMotion",null),Cr([Object(d.e)(),Sr("design:type",Function),Sr("design:paramtypes",[Wt]),Sr("design:returntype",void 0)],e,"getPanMode",null),Cr([Object(d.e)(),Sr("design:type",Function),Sr("design:paramtypes",[Wt]),Sr("design:returntype",void 0)],e,"getZoomed",null),Cr([Object(d.e)(),Sr("design:type",Function),Sr("design:paramtypes",[Wt]),Sr("design:returntype",void 0)],e,"getLockCamera",null),Cr([Object(d.e)(),Sr("design:type",Function),Sr("design:paramtypes",[Wt]),Sr("design:returntype",void 0)],e,"getChapterCameraEnabled",null),e=wr=Cr([Object(d.f)({name:"engineCamera",defaults:_r})],e),e})();var kr=function(e){return e.Select="Select",e.Hide="Hide",e.Paint="Paint",e.Eyedropper="Eyedropper",e.Label="Label",e.Isolate="Isolate",e.Fade="Fade",e.Position="Position",e.Quiz="Quiz",e}({}),Pr=function(e){return e.Capture="capture",e.DoNotCaptureShowMessage="do_not_capture_show_message",e.DoNotCapture="do_not_capture",e}({}),Mr=n("nYR2"),Ir=n("z6cu");let zr=(()=>{class e{constructor(e){this.http=e,this.nodeInfoCache=new Map}queryNodeInfo(e,t,n="en",i=!0){if(c.offline)return Object(zs.a)(void 0);const s=`/search/descriptions?name=${e}&plan=${t===lr.Wikipedia?"wiki":t}&ol=${n}`,o=s;if(i&&this.nodeInfoCache.has(o)){const e=this.nodeInfoCache.get(o);return Object(zs.a)(e)}return this.http.get(s).pipe(Object(F.a)(t=>({label:e,latinLabel:t.latin_term,description:t.description,source:t.source,sourceLink:t.url})),Object(Ls.a)(e=>404===e.status?Object(zs.a)(void 0):Object(Ir.a)(e)),Object(vn.a)(e=>this.nodeInfoCache.set(o,e)))}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(v.b))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var Tr,Ur=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},Dr=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const Lr=new $t(0,0,0,0,qt.Hidden);let Er=(()=>{let e=Tr=class{constructor(e,t,n,i,s){this.store=e,this.graphService=t,this.engineService=n,this.contentInfoService=i,this.animationService=s}static getEngine(e){return e.engine}static getReady(e){return e.ready}static getDisplay(e){return e.display}static getScrollMode(e){return e.scrollMode}static getVisible(e){return e.visible}static getViewGraph(e){return e.viewGraph}static getViewGraphNode(e){return t=>e.viewGraph.nodes[t]}static getEnginePosition(e){return e.enginePosition}static getChapter(e){return e.chapter}static getActiveTool(e){return e.activeTool}static getShowCameraBar(e){return e.showCameraBar}static getShowProgressBar(e){return e.showProgressBar}static getShowLabels(e){return e.showLabels}static getChapterInit(e){return e.chapterInit}static getAnimationPlaying(e){return e.animationPlaying}static getPlayAudio(e){return e.playAudio}static getAutoplay(e){return e.autoplay}static getXrayModeEnabled(e){return e.xrayModeEnabled}static getHoveredNode(e){return e.hoveredNode}static getLabelEditNode(e){return e.labelEditNode}static getQuerying(e){return e.queryingAnatomy}static getContextmenu(e){return e.contextmenu}static getPlaybackSpeed(e){return e.playbackSpeed}static getWatermarkEnabled(e){return e.watermarkEnabled}load(e,t){e.dispatch(new Ee("engine"))}loadSuccess({patchState:e},t){e({engine:t.result})}setReady(e,t){e.patchState({ready:t.ready})}setDisplay(e,t){e.patchState({display:t.display})}setZoomViaScrollAllowed(e,t){e.patchState({scrollMode:t.scrollMode})}setVisible(e,t){e.patchState({visible:t.visible})}setEnginePosition(e,t){e.patchState({enginePosition:Object.assign(Object.assign({},t.position),{right:t.position.left+t.position.width,bottom:t.position.top+t.position.height})})}resetEnginePosition(e,t){e.patchState({enginePosition:Lr})}setChapter(e,t){e.patchState({chapter:t.chapterId})}setChapterInit(e,t){e.patchState({chapterInit:t.chapterInit})}setActiveTool(e,t){e.patchState({activeTool:t.tool})}setGraph(e,t){e.patchState({viewGraph:Object.assign({},t.graph)})}clearGraph(e,t){e.patchState({viewGraph:{nodes:{},successors:{},predecessors:{},roots:{}}})}setXrayMode(e,t){e.patchState({xrayModeEnabled:t.enabled})}centerCameraOnVisible(e,t){const n=this.engineService.getVisibleLeaves(),i=this.engineService.getBoundaryFromObjects(n),s=this.engineService.getCameraLookAt();s.look={x:(i.xmin+i.xmax)/2,y:(i.ymin+i.ymax)/2,z:(i.zmin+i.zmax)/2},Human.renderer.camera.fly.flyTo(s)}toggleProgressBar(e,t){e.patchState({showProgressBar:t.show})}toggleCameraBar(e,t){e.patchState({showCameraBar:t.show})}toggleLabels(e,t){const n=null!=t.show?t.show:!e.getState().showLabels;e.patchState({showLabels:n})}synchronizeVisibleNodes(e,t){const n=e.getState().viewGraph,i=this.stateMapToNodeIds(n,t.leafVisibilityState),s={};i.forEach(e=>{const n=this.engineService.getLeafObjects(e).reduce((e,n)=>e||t.nodes[n].shown,!1);s[e]={shown:n}}),this.graphService.synchronize(Object.assign({},n),{shown:"trueWins"},s),e.patchState({viewGraph:Object.assign({},n)})}synchronizeRenderableNodes(e,t){const n=e.getState().viewGraph,i=this.stateMapToNodeIds(n,t.leafRenderableState),s={};i.forEach(e=>{s[e]={renderable:!0}}),this.graphService.synchronize(n,{renderable:"falseWins"},s)}synchronizePickableNodes(e,t){const n=e.getState().viewGraph,i=this.stateMapToNodeIds(n,t.leafPickableState),s={};i.forEach(e=>{const t=this.engineService.getLeafObjects(e).reduce((e,t)=>e||Human.scene.objects[t].pickable,!1);s[e]={pickable:t}}),this.graphService.synchronize(n,{pickable:"trueWins"},s),e.patchState({viewGraph:Object.assign({},n)})}playChapterAnimation(e,t){const n=this.store.selectSnapshot(Or.getSelectedChapter),i=Object(D.get)(n,"ui.play.count",0);this.animationService.play({startChapterId:n.id,loop:-1===i,numChapters:1,queue:!1}),e.getState().animationPlaying||this.animationService.pause()}toggleAnimation(e,t){const n=this.store.selectSnapshot(Or.getSelectedChapterId);t.play?this.animationService.unpause(n):this.animationService.pause()}setAnimationPlaying(e,t){e.patchState({animationPlaying:t.playing})}setPlaybackSpeed(e,t){e.patchState({playbackSpeed:t.speed})}playAudio(e,t){e.patchState({playAudio:t.play})}setAutoplay(e,t){e.patchState({autoplay:t.enable})}setObjectLayerOrder(e,t){const n=e.getState().viewGraph,i=isNaN(t.layer)?0:t.layer;let s=[];t.nodes.forEach(e=>{const t=this.graphService.getDescendants(n,e.id,!0);s=s.concat(t)}),s.forEach(e=>{this.engineService.setObjectLayer(e,i),this.graphService.setState(n,e,{layer:i})}),e.patchState({viewGraph:Object.assign({},n)})}setObjectDisplayName(e,t){const n=Human.scene.objects[t.nodeId];n&&(n.displayName=t.displayName)}autoSortObjectLayers(e,t){const n=e.getState().viewGraph;let i=0;const s=Human.scene.getEnabledLeaves(),o=this.engineService.getObjectLayerValues(s);Object.keys(o).map(e=>parseInt(e,10)).sort((e,t)=>e-t).forEach(e=>{o[e].sort((e,t)=>t.value-e.value).forEach(e=>{const t=20*i;this.engineService.setObjectLayer(e.nodeId,t),this.graphService.setState(n,e.nodeId,{layer:t}),i++})}),e.patchState({viewGraph:Object.assign({},n)})}resetObjectLayers(e,t){const n=e.getState().viewGraph;Human.scene.getEnabledLeaves().forEach(e=>{this.engineService.setObjectLayer(e,0),this.graphService.setState(n,e,{layer:0})}),e.patchState({viewGraph:Object.assign({},n)})}setPostProcessingEffects(e,{effects:t}){this.engineService.setPostProcessingFeatures(t)}setProperties(e,{properties:t}){this.engineService.setProperties(Object.assign({},t))}setTransparencyMode(e,{mode:t}){this.engineService.setTransparencyMode(t)}expandNode(e,t){const n=this.store.selectSnapshot(Tr.getViewGraph);Dt.getAncestors(n,t.node.id,!0).forEach(e=>{n.nodes[e].boolState.expanded=!0}),this.store.dispatch(new Qe(n))}collapseNode(e,t){const n=this.store.selectSnapshot(Tr.getViewGraph);n.nodes[t.node.id].boolState.expanded=!1,this.store.dispatch(new Qe(n))}collapseAllViewTreeNodes(e,t){const n=this.store.selectSnapshot(Tr.getViewGraph);Object.values(n.nodes).forEach(e=>{e.boolState.expanded=!1}),this.store.dispatch(new Qe(n))}hoverNode(e,t){e.patchState({hoveredNode:t.node})}setLabelEditNode(e,t){e.patchState({labelEditNode:t.node})}queryNodeInfo(e,{node:t,fallback:n,lang:i}){e.patchState({queryingAnatomy:!0}),this.contentInfoService.queryNodeInfo(t.label,n,i).pipe(Object(Mr.a)(()=>e.patchState({queryingAnatomy:!1}))).subscribe(n=>e.dispatch(new Mt(t,n)),()=>e.dispatch(new It(t)))}queryNodeInfoSuccess(e,{node:t,info:n}){e.dispatch(new kt(t,n))}setNodeInfo(e,{node:t,info:n}){const i=this.store.selectSnapshot(Tr.getViewGraph),s=i.nodes[t.id];s&&n&&(s.description=n.description,s.info=n,this.store.dispatch(new Qe(i)))}setContextMenu(e,t){e.patchState({contextmenu:{node:t.node,hit:t.hit}})}setWatermarkEnabled(e,{enabled:t}){e.patchState({watermarkEnabled:t})}stateMapToNodeIds(e,t){const n=Object.keys(t).map(t=>this.engineService.getNode(e,t)).filter(e=>!!e).map(e=>e.id);return new Set(n)}};return e.\u0275fac=function(t){return new(t||e)(i.Zb(d.g),i.Zb(Et),i.Zb(Qt),i.Zb(zr),i.Zb(eo))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac}),Ur([Object(d.a)(Le),Dr("design:type",Function),Dr("design:paramtypes",[Object,Le]),Dr("design:returntype",void 0)],e.prototype,"load",null),Ur([Object(d.a)(Ee),Dr("design:type",Function),Dr("design:paramtypes",[Object,Ee]),Dr("design:returntype",void 0)],e.prototype,"loadSuccess",null),Ur([Object(d.a)(Fe),Dr("design:type",Function),Dr("design:paramtypes",[Object,Fe]),Dr("design:returntype",void 0)],e.prototype,"setReady",null),Ur([Object(d.a)(Ae),Dr("design:type",Function),Dr("design:paramtypes",[Object,Ae]),Dr("design:returntype",void 0)],e.prototype,"setDisplay",null),Ur([Object(d.a)(Re),Dr("design:type",Function),Dr("design:paramtypes",[Object,Re]),Dr("design:returntype",void 0)],e.prototype,"setZoomViaScrollAllowed",null),Ur([Object(d.a)(Ne),Dr("design:type",Function),Dr("design:paramtypes",[Object,Ne]),Dr("design:returntype",void 0)],e.prototype,"setVisible",null),Ur([Object(d.a)(ft),Dr("design:type",Function),Dr("design:paramtypes",[Object,ft]),Dr("design:returntype",void 0)],e.prototype,"setEnginePosition",null),Ur([Object(d.a)(yt),Dr("design:type",Function),Dr("design:paramtypes",[Object,yt]),Dr("design:returntype",void 0)],e.prototype,"resetEnginePosition",null),Ur([Object(d.a)(We),Dr("design:type",Function),Dr("design:paramtypes",[Object,We]),Dr("design:returntype",void 0)],e.prototype,"setChapter",null),Ur([Object(d.a)(Ke),Dr("design:type",Function),Dr("design:paramtypes",[Object,Ke]),Dr("design:returntype",void 0)],e.prototype,"setChapterInit",null),Ur([Object(d.a)(ot),Dr("design:type",Function),Dr("design:paramtypes",[Object,ot]),Dr("design:returntype",void 0)],e.prototype,"setActiveTool",null),Ur([Object(d.a)(Qe),Dr("design:type",Function),Dr("design:paramtypes",[Object,Qe]),Dr("design:returntype",void 0)],e.prototype,"setGraph",null),Ur([Object(d.a)($e),Dr("design:type",Function),Dr("design:paramtypes",[Object,Qe]),Dr("design:returntype",void 0)],e.prototype,"clearGraph",null),Ur([Object(d.a)(qe),Dr("design:type",Function),Dr("design:paramtypes",[Object,qe]),Dr("design:returntype",void 0)],e.prototype,"setXrayMode",null),Ur([Object(d.a)(Xe),Dr("design:type",Function),Dr("design:paramtypes",[Object,Xe]),Dr("design:returntype",void 0)],e.prototype,"centerCameraOnVisible",null),Ur([Object(d.a)(it),Dr("design:type",Function),Dr("design:paramtypes",[Object,it]),Dr("design:returntype",void 0)],e.prototype,"toggleProgressBar",null),Ur([Object(d.a)(nt),Dr("design:type",Function),Dr("design:paramtypes",[Object,nt]),Dr("design:returntype",void 0)],e.prototype,"toggleCameraBar",null),Ur([Object(d.a)(st),Dr("design:type",Function),Dr("design:paramtypes",[Object,st]),Dr("design:returntype",void 0)],e.prototype,"toggleLabels",null),Ur([Object(d.a)(Ye),Dr("design:type",Function),Dr("design:paramtypes",[Object,Ye]),Dr("design:returntype",void 0)],e.prototype,"synchronizeVisibleNodes",null),Ur([Object(d.a)(et),Dr("design:type",Function),Dr("design:paramtypes",[Object,et]),Dr("design:returntype",void 0)],e.prototype,"synchronizeRenderableNodes",null),Ur([Object(d.a)(tt),Dr("design:type",Function),Dr("design:paramtypes",[Object,tt]),Dr("design:returntype",void 0)],e.prototype,"synchronizePickableNodes",null),Ur([Object(d.a)(rt),Dr("design:type",Function),Dr("design:paramtypes",[Object,rt]),Dr("design:returntype",void 0)],e.prototype,"playChapterAnimation",null),Ur([Object(d.a)(at),Dr("design:type",Function),Dr("design:paramtypes",[Object,at]),Dr("design:returntype",void 0)],e.prototype,"toggleAnimation",null),Ur([Object(d.a)(ct),Dr("design:type",Function),Dr("design:paramtypes",[Object,ct]),Dr("design:returntype",void 0)],e.prototype,"setAnimationPlaying",null),Ur([Object(d.a)(lt),Dr("design:type",Function),Dr("design:paramtypes",[Object,lt]),Dr("design:returntype",void 0)],e.prototype,"setPlaybackSpeed",null),Ur([Object(d.a)(pt),Dr("design:type",Function),Dr("design:paramtypes",[Object,pt]),Dr("design:returntype",void 0)],e.prototype,"playAudio",null),Ur([Object(d.a)(ut),Dr("design:type",Function),Dr("design:paramtypes",[Object,ut]),Dr("design:returntype",void 0)],e.prototype,"setAutoplay",null),Ur([Object(d.a)(gt),Dr("design:type",Function),Dr("design:paramtypes",[Object,gt]),Dr("design:returntype",void 0)],e.prototype,"setObjectLayerOrder",null),Ur([Object(d.a)(ht),Dr("design:type",Function),Dr("design:paramtypes",[Object,ht]),Dr("design:returntype",void 0)],e.prototype,"setObjectDisplayName",null),Ur([Object(d.a)(bt),Dr("design:type",Function),Dr("design:paramtypes",[Object,bt]),Dr("design:returntype",void 0)],e.prototype,"autoSortObjectLayers",null),Ur([Object(d.a)(mt),Dr("design:type",Function),Dr("design:paramtypes",[Object,mt]),Dr("design:returntype",void 0)],e.prototype,"resetObjectLayers",null),Ur([Object(d.a)(xt),Dr("design:type",Function),Dr("design:paramtypes",[Object,xt]),Dr("design:returntype",void 0)],e.prototype,"setPostProcessingEffects",null),Ur([Object(d.a)(vt),Dr("design:type",Function),Dr("design:paramtypes",[Object,vt]),Dr("design:returntype",void 0)],e.prototype,"setProperties",null),Ur([Object(d.a)(Ot),Dr("design:type",Function),Dr("design:paramtypes",[Object,Ot]),Dr("design:returntype",void 0)],e.prototype,"setTransparencyMode",null),Ur([Object(d.a)(wt),Dr("design:type",Function),Dr("design:paramtypes",[Object,wt]),Dr("design:returntype",void 0)],e.prototype,"expandNode",null),Ur([Object(d.a)(Ct),Dr("design:type",Function),Dr("design:paramtypes",[Object,Ct]),Dr("design:returntype",void 0)],e.prototype,"collapseNode",null),Ur([Object(d.a)(St),Dr("design:type",Function),Dr("design:paramtypes",[Object,St]),Dr("design:returntype",void 0)],e.prototype,"collapseAllViewTreeNodes",null),Ur([Object(d.a)(_t),Dr("design:type",Function),Dr("design:paramtypes",[Object,_t]),Dr("design:returntype",void 0)],e.prototype,"hoverNode",null),Ur([Object(d.a)(jt),Dr("design:type",Function),Dr("design:paramtypes",[Object,jt]),Dr("design:returntype",void 0)],e.prototype,"setLabelEditNode",null),Ur([Object(d.a)(Pt),Dr("design:type",Function),Dr("design:paramtypes",[Object,Pt]),Dr("design:returntype",void 0)],e.prototype,"queryNodeInfo",null),Ur([Object(d.a)(Mt),Dr("design:type",Function),Dr("design:paramtypes",[Object,Mt]),Dr("design:returntype",void 0)],e.prototype,"queryNodeInfoSuccess",null),Ur([Object(d.a)(kt),Dr("design:type",Function),Dr("design:paramtypes",[Object,kt]),Dr("design:returntype",void 0)],e.prototype,"setNodeInfo",null),Ur([Object(d.a)(Ze),Dr("design:type",Function),Dr("design:paramtypes",[Object,Ze]),Dr("design:returntype",void 0)],e.prototype,"setContextMenu",null),Ur([Object(d.a)(zt),Dr("design:type",Function),Dr("design:paramtypes",[Object,zt]),Dr("design:returntype",void 0)],e.prototype,"setWatermarkEnabled",null),Ur([Object(d.e)(),Dr("design:type",Function),Dr("design:paramtypes",[De]),Dr("design:returntype",void 0)],e,"getEngine",null),Ur([Object(d.e)(),Dr("design:type",Function),Dr("design:paramtypes",[De]),Dr("design:returntype",void 0)],e,"getReady",null),Ur([Object(d.e)(),Dr("design:type",Function),Dr("design:paramtypes",[De]),Dr("design:returntype",void 0)],e,"getDisplay",null),Ur([Object(d.e)(),Dr("design:type",Function),Dr("design:paramtypes",[De]),Dr("design:returntype",void 0)],e,"getScrollMode",null),Ur([Object(d.e)(),Dr("design:type",Function),Dr("design:paramtypes",[De]),Dr("design:returntype",void 0)],e,"getVisible",null),Ur([Object(d.e)(),Dr("design:type",Function),Dr("design:paramtypes",[De]),Dr("design:returntype",void 0)],e,"getViewGraph",null),Ur([Object(d.e)(),Dr("design:type",Function),Dr("design:paramtypes",[De]),Dr("design:returntype",void 0)],e,"getViewGraphNode",null),Ur([Object(d.e)(),Dr("design:type",Function),Dr("design:paramtypes",[De]),Dr("design:returntype",void 0)],e,"getEnginePosition",null),Ur([Object(d.e)(),Dr("design:type",Function),Dr("design:paramtypes",[De]),Dr("design:returntype",void 0)],e,"getChapter",null),Ur([Object(d.e)(),Dr("design:type",Function),Dr("design:paramtypes",[De]),Dr("design:returntype",void 0)],e,"getActiveTool",null),Ur([Object(d.e)(),Dr("design:type",Function),Dr("design:paramtypes",[De]),Dr("design:returntype",void 0)],e,"getShowCameraBar",null),Ur([Object(d.e)(),Dr("design:type",Function),Dr("design:paramtypes",[De]),Dr("design:returntype",void 0)],e,"getShowProgressBar",null),Ur([Object(d.e)(),Dr("design:type",Function),Dr("design:paramtypes",[De]),Dr("design:returntype",void 0)],e,"getShowLabels",null),Ur([Object(d.e)(),Dr("design:type",Function),Dr("design:paramtypes",[De]),Dr("design:returntype",void 0)],e,"getChapterInit",null),Ur([Object(d.e)(),Dr("design:type",Function),Dr("design:paramtypes",[De]),Dr("design:returntype",void 0)],e,"getAnimationPlaying",null),Ur([Object(d.e)(),Dr("design:type",Function),Dr("design:paramtypes",[De]),Dr("design:returntype",void 0)],e,"getPlayAudio",null),Ur([Object(d.e)(),Dr("design:type",Function),Dr("design:paramtypes",[De]),Dr("design:returntype",void 0)],e,"getAutoplay",null),Ur([Object(d.e)(),Dr("design:type",Function),Dr("design:paramtypes",[De]),Dr("design:returntype",void 0)],e,"getXrayModeEnabled",null),Ur([Object(d.e)(),Dr("design:type",Function),Dr("design:paramtypes",[De]),Dr("design:returntype",void 0)],e,"getHoveredNode",null),Ur([Object(d.e)(),Dr("design:type",Function),Dr("design:paramtypes",[De]),Dr("design:returntype",void 0)],e,"getLabelEditNode",null),Ur([Object(d.e)(),Dr("design:type",Function),Dr("design:paramtypes",[De]),Dr("design:returntype",void 0)],e,"getQuerying",null),Ur([Object(d.e)(),Dr("design:type",Function),Dr("design:paramtypes",[De]),Dr("design:returntype",void 0)],e,"getContextmenu",null),Ur([Object(d.e)(),Dr("design:type",Function),Dr("design:paramtypes",[De]),Dr("design:returntype",void 0)],e,"getPlaybackSpeed",null),Ur([Object(d.e)(),Dr("design:type",Function),Dr("design:paramtypes",[De]),Dr("design:returntype",void 0)],e,"getWatermarkEnabled",null),e=Tr=Ur([Object(d.f)({name:"engine",defaults:{loading:!1,ready:!1,viewGraph:{nodes:{},successors:{},predecessors:{},roots:{}},hoveredNode:void 0,labelEditNode:void 0,queryingAnatomy:!1,engine:"",chapter:"",chapterInit:{id:"",init:!1,camera:!1,annotations:!1,graph:!1,properties:!1,particles:!1,clips:!1,postprocessing:!1,transparency:!1},showProgressBar:!0,showCameraBar:!0,showLabels:!0,activeTool:kr.Select,animationPlaying:!0,autoplay:!0,playAudio:!1,display:!0,visible:!0,scrollMode:Pr.Capture,playbackSpeed:1,xrayModeEnabled:!1,contextmenu:{node:null,hit:null},watermarkEnabled:!1},children:[jr]})],e),e})();class Fr{}class Ar{}class Rr{}var Vr=n("cp0P");class Nr{}function Br(e,...t){return()=>new Promise(n=>{e(...t,()=>{n()})})}let Hr=(()=>{class e{constructor(){}getOnlyText(e){return e.map(e=>{switch(e.type){case is.Markdown:return e.markdown}}).join("")}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const Qr=["reflections","lights"],$r=["material","geometry","transform"],qr=["tweens","morph"];let Wr=(()=>{class e{constructor(e,t,n,i){this.http=e,this.engineService=t,this.chapterService=n,this.contentBlocksService=i}getShownObjectsFromChapter(e){const t=[];return Object.entries(e.synchronization).forEach(([e,n])=>{n.shown&&t.push(e)}),t}getChapterLoadChunks(e,t,n){const i=this.getShownObjectsFromChapter(t),s=new Ar;return s.activate=!1,s.chapterId=t.id,s.objects=i,s.storyId=e,s.assetTypes=[...$r,...qr,...Qr],s.readyState={model:!0,animation:!0},[s]}getOnDemandLoadChunks(e,t){let n=[];return Human.timeline.rootTimelines[e]._chapters.forEach(i=>{const s=this.getChapterLoadChunks(e,i,t);n=i.id===t.targetChapterId?[...s,...n]:[...n,...s]}),n}getChapterIndex(e,t){return Human.timeline.rootTimelines[e]?Human.timeline.rootTimelines[e]._chapters.findIndex(e=>e.id===t):-1}getStory(e,t,n="en"){const i=t===o.Bookmark?this.getBookmark(e):this.getContent(e);if("en"===n)return i;{let s;return i.pipe(Object(Us.a)(i=>(s=i,this.getStoryTranslation(e,t,n)))).pipe(Object(F.a)(e=>this.translateStory(s,e)),Object(Ls.a)(()=>i))}}getContentRoot(){return!0===c.offline?"undefined"==typeof localBaseDirectory?"":localBaseDirectory:"/"}getContent(e){return this.http.get(this.getContentRoot()+`content/modules/${e}.json`).pipe(Object(F.a)(e=>e))}getBookmark(e){return this.http.get("/search/bookmarks/data",{params:{be:e}}).pipe(Object(F.a)(e=>e.bookmark))}getLoadConfig(e,t=0){const n=new Rr;return n.chapterAssetBundle=!0,n.targetChapterId=Human.timeline.rootTimelines[e]._chapters[t].id,n.targetChapterConfig={global:{clipping:!0,graph:!0,camera:!0,properties:!0,transparencyMode:!0,postprocess:!0},static:{labels:!0},dynamic:{timeline:!0,particles:!0}},n.sortBy="chapter",n}buildStory(e,t,n){Human.events.fire("modules.fetch.start",e),Human.modules.moduleData[e]=t;const i=Object.assign({},t);return i.moduleId=e,new P.a(t=>{Human.modules.create(e,i,()=>{Human.modules.load(e,Object.values(Human.scene.rootObjects),[...Qr],()=>{Human.modules.activate(e,0,{},()=>{t.next(!0),t.complete()})})})})}getStoryChapters(e,t){const n=Human.modules.moduleData[e];return Human.timeline.rootTimelines[e]._chapters.map((e,i)=>this.chapterService.fromHumanChapter(n,t,e,i))}getStoryLoadChunks(e,t){let n=[];return n=this.getOnDemandLoadChunks(e,t),n.map(e=>Object.assign(Object.assign({},e),{chunkId:yi.idWithPrefix("chunk")}))}loadStoryChunk(e,t){const n=e.objects.map(e=>Human.scene.objects[e]);e.storyId?Human.modules.load(e.storyId,n,e.assetTypes,()=>{t()}):this.engineService.loadGraphObject(e.objects[0]).subscribe(()=>{t()})}unloadStory(e,t=!0){const n=(e?[e]:Object.keys(Human.modules.modules)).map(e=>this.hardDeleteStory(e,t));return new P.a(e=>{n.length?Object(Vr.a)(n).subscribe(()=>{e.next(!0),e.complete()}):(e.next(!0),e.complete())})}createLoadObjectChunk(e){const t=new Ar;return t.assetTypes=[...$r,...qr],t.objects=[e],t}hardDeleteStory(e,t=!0){const n=(e in Human.modules.modules?Human.modules.modules[e].sceneGraph:[]).map(e=>Human.scene.objects[e.objectId]).filter(e=>!!e),i=Object(D.flatten)(n.map(e=>e.getLeafObjects())),s=Br(Human.modules.deactivate,e,{}),o=Br(Human.modules.unload,e,i,["geometries","morphs","reflections","tweens","lights","materials","transforms"]),r=Br(Human.modules.destroy,e);return new P.a(n=>{(Human.timeline.activeRoot&&Human.timeline.activeRoot.id===e?s():Promise.resolve({})).then(()=>t?o():Promise.resolve({})).then(()=>r()).then(()=>(n.next(),void n.complete()))})}getStoryTranslation(e,t,n){return this.http.get(t===o.Bookmark?`/search/bookmarks/tr/${n}/${e}`:`/tr/${n}/${e}.json`).pipe(Object(F.a)(e=>Object(A.plainToClass)(Nr,e)))}getStoryType(e){return e.indexOf("/")>=0?o.Module:o.Bookmark}translateStory(e,t){const n=e.chapters||[],i=e.sceneGraph||[],s=t.objects||{},o=t.chapters||[];return e.displayName=t.displayName||e.displayName,e.description=t.description||e.description,i.forEach(e=>{(e.objects||[]).forEach(e=>{this.translateObject(e,s)})}),n.forEach((e,t)=>{const n=o[t];if(n){this.translateMetaInfo(e,n);const t=n.annotations||[];(e.annotations||[]).forEach((e,n)=>{const i=t[n];i&&this.translateMetaInfo(e,i)});const i=n.hotspots||[];(e.hotspots||[]).forEach((e,t)=>{const n=i[t];n&&this.translateMetaInfo(e,n)});const s=n.quizQuestions||[];(e.quizQuestions||[]).forEach((e,t)=>{const n=s[t];n&&this.translateQuizQuestion(e,n)})}}),e}translateQuizQuestion(e,t){if(t.nextLabel&&(e.nextLabel=t.nextLabel),["questionPrompt","explanation"].forEach(n=>{const i=t[n]||[];(e[n]||[]).forEach((e,t)=>{const n=i[t];n&&(e.markdown=n.markdown)})}),e.data&&t.data){const n=t.data.options||[];(e.data.options||[]).forEach((t,i)=>{const s=n[i];s&&(e.type===ss.LabelAnatomy?this.translateMetaInfo(t.label,s.label):t.label=s.label)})}}translateMetaInfo(e,t){const{title:n,description:i}=t;e.hasOwnProperty("displayName")&&(e.displayName=n),e.hasOwnProperty("title")&&(e.title=n),e.hasOwnProperty("description")&&(e.description=i)}translateObject(e,t){const n=t[e.objectId];n&&(e.displayName=n);const i=e.objects;i&&i.forEach(e=>{this.translateObject(e,t)})}exportWrittenContent(e,t,n){const i=[];return i.push(`\n${e.displayName}\n    `),t.forEach((e,t)=>{i.push(`\n---\n\n# Chapter ${t+1}: ${e.info.displayName||"-No Title-"}\n\n${e.info.description||"-No Description-"}\n      `),e.legend.length&&(i.push("\n## Legend\n"),e.legend.forEach(e=>{i.push(`\n* ${e.label} (${si.rgbToHex(e.colors,!0)})\n`)}));const s=n.filter(t=>t.chapterId===e.id);s.length&&(i.push("\n## Labels\n"),s.forEach(e=>{i.push(`\n* ${e.title}\n`),e.description&&i.push(`\n  > ${e.description}\n`)}))}),i.join("")}exportQuizKey(e){const t=[];return e.forEach((e,n)=>{switch(t.push(`\n# QUESTION ${n+1} (${os[e.type]})\n\n## PROMPT\n${this.contentBlocksService.getOnlyText(e.questionPrompt)}\n      `),e.type){case ss.MultipleChoice:e.data.options.forEach((n,i)=>{t.push(`\n## ANSWER ${i+1} ${e.data.correctAnswer===n.value?"- CORRECT":""}\n${n.label}\n            `)});break;case ss.SelectAnatomy:t.push("\n## ANSWERS\n          "),e.data.correctAnswer.forEach((e,n)=>{t.push(`\n${e}\n            `)});break;case ss.LabelAnatomy:e.data.options.forEach((e,n)=>{t.push(`\n## ANSWER ${n+1}\n${e.label.title}\n            `)})}this.contentBlocksService.getOnlyText(e.explanation).length&&t.push(`\n  \n## EXPLANATION\n${this.contentBlocksService.getOnlyText(e.explanation)}\n        `),t.push("\n\n\n      ")}),t.join("")}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(v.b),i.Zb(Qt),i.Zb(to),i.Zb(Hr))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function Kr(e,t,n){const i=function(e,t){const n={};for(const i of e){const e=Object.keys(t[i]);for(const t of e)n[t]=!1}return n}(t,n);return e.map(e=>Object.assign(Object.assign({},e),{showObjects:Object.assign(Object.assign({},e.showObjects),i),selectObjects:Object.assign(Object.assign({},e.selectObjects),i),pickThroughObjects:Object.assign(Object.assign({},e.pickThroughObjects),i)}))}function Gr(e){return e.split("/").length>1?o.Module:o.Bookmark}function Zr(e,t){return e.map(e=>{if(!Object(D.isEmpty)(e.lights))return e;const n={libraries:[...t],lights:[]};return Object.assign(Object.assign({},e),{lights:n})})}function Jr(e){return e.customData&&e.customData.particleSystems?e.customData.particleSystems.reduce((e,t)=>(e[Ji.getParticleIdRoot(t.id)]=t.id,e),{}):{}}function Xr(e,t){return e.customData&&e.customData.particleSystems?e.customData.particleSystems.map(e=>{const n=Ji.getParticleIdRoot(e.id);return Object.assign(Object.assign({},e),{id:t[n]})}):[]}function Yr(e,t){return e.map(e=>(e.customData&&e.customData.particleSystems&&(e.customData.particleSystems=e.customData.particleSystems.map(e=>t[Ji.getParticleIdRoot(e)])),e))}function ea(e,t){return e.map(e=>e.id).reduce((n,i)=>(e.some(e=>e.id===i&&Object(D.get)(e,"customData.particleSystems",[]).length>0)&&(n[i]=t),n),{})}function ta(e,t,n,i,s=o.Bookmark,r=yi.idWithPrefix){const{sceneGraph:a,graphsMerged:c,objectIdsUniqueToNew:l,objectIdsUniqueToOriginal:p}=function(e,t){const n=e=>void 0!==e.objectId,[i,s]=Object(D.partition)(e,n),[o,r]=Object(D.partition)(t,n),a=function(e,t){return t.reduce((t,n)=>{for(const i of e)Object(D.isEqual)(i,n)||t.push(n);return t},e)}(s,r),{newSceneGraph:c,graphsMerged:l,objectIdsUniqueToNew:p,objectIdsUniqueToOriginal:d}=function(e,t){const n=e.reduce((e,t)=>(e[t.objectId]=t,e),{}),i=t.reduce((e,t)=>{if(void 0===e.nodes[t.objectId])return e.nodes[t.objectId]=t,e;if(!Object(D.isEqual)(t,e.nodes[t.objectId])){const n=function(e,t){const n={},i={};return{root:function e(t,s){if(t.objectId!==s.objectId)return n[s.objectId]=!0,[t,s];if(void 0===t.objects&&s.objects){for(const e of s.objects)n[e.objectId]=!0;return[Object.assign({},s)]}if(t.objects&&void 0===s.objects){for(const e of t.objects)i[e.objectId]=!0;return[Object.assign({},t)]}if(void 0===t.objects&&void 0===s.objects)return[Object.assign({},t)];const o=[];for(const n of t.objects){const t=s.objects.find(e=>e.objectId===n.objectId);t?o.push(e(n,t)):(i[n.objectId]=!0,o.push(n))}for(const i of s.objects)t.objects.find(e=>e.objectId===i.objectId)||(n[i.objectId]=!0,o.push(i));const r=Object.assign({},t);return r.objects=Object(D.flatten)(o),[r]}(e,t),objectIdsUniqueToNew:n,objectIdsUniqueToOriginal:i}}(e.nodes[t.objectId],t);e.nodes[t.objectId]=n.root[0],e.graphsMerged.push(t.objectId),e.objectIdsUniqueToNew[t.objectId]=n.objectIdsUniqueToNew,e.objectIdsUniqueToOriginal[t.objectId]=n.objectIdsUniqueToOriginal}return e},{nodes:n,graphsMerged:[],objectIdsUniqueToNew:{},objectIdsUniqueToOriginal:{}});return{newSceneGraph:Object.keys(i.nodes).reduce((e,t)=>(e.push(i.nodes[t]),e),[]),graphsMerged:i.graphsMerged,objectIdsUniqueToNew:i.objectIdsUniqueToNew,objectIdsUniqueToOriginal:i.objectIdsUniqueToOriginal}}(i,o);return{sceneGraph:[...a,...c],graphsMerged:l,objectIdsUniqueToNew:p,objectIdsUniqueToOriginal:d}}(e.sceneGraph,n.sceneGraph),d=function(e,t){const n=(e,t)=>Object(D.uniq)([...e,...t]);return{lights:n(e.lights,t.lights),tweens:n(e.tweens,t.tweens),reflections:n(e.reflections,t.reflections)}}(e.assetLibraries,n.assetLibraries),u=function(e,t,n,i){e=e||{},t=t||{};const s=(e,t)=>t.includes("/")?t:`${function(e){return Gr(e)===o.Bookmark?e:e.split("/").pop()}(e)}/${t}`;return Object.assign(Object.assign({},Object(D.mapKeys)(e,(e,t)=>s(n,t))),Object(D.mapKeys)(t,(e,t)=>s(i,t)))}(e.reflections,n.reflections,t,i),{colorRecipes:g,newColorRecipeIds:h}=function(e,t,n){e=e||{},t=t||{};const i=Object.keys(t).reduce((e,i)=>{const s=n("color-recipe-"+i);return e.newColorRecipeIds[i]=s,e.colorRecipes[s]=t[i],e},{colorRecipes:{},newColorRecipeIds:{}});return{colorRecipes:Object.assign(Object.assign({},e),i.colorRecipes),newColorRecipeIds:i.newColorRecipeIds}}(e.colorRecipes,n.colorRecipes,r),b=Zr(e.chapters,e.assetLibraries.lights),m=Zr(n.chapters,n.assetLibraries.lights),f=function(e,t,n,i,s){const o=Jr(e),r=Object.values(o),a=Jr(t);for(const u in a)if(a.hasOwnProperty(u)&&r.includes(a[u])){const e=Ji.generateParticleId(u,s);a[u]=e}const c=[...Xr(e,o),...Xr(t,a)],l=Yr(n,o),p=Yr(i,a),d=Object.assign(Object.assign({},ea(l,o)),ea(p,a));return{mergedParticles:c,currentChapters:l,importedChapters:p,tweenParticleLookup:Object(D.pickBy)(d,(e,t)=>!Object(D.isEmpty)(e))}}(e,n,Kr(b,c,l),Kr(m,c,p).map(e=>Object.assign(Object.assign({},e),{id:r("chapter")})),r),y=function(e,t){return e.map(e=>{if(Object(D.isEmpty)(e.colorRecipeObjects))return e;const n=Object.keys(e.colorRecipeObjects).reduce((n,i)=>(n[t[i]]=e.colorRecipeObjects[i],n),{});return e.colorRecipeObjects=n,e})}(f.importedChapters,h),x=[...f.currentChapters,...y],v=Object.assign(Object.assign({},e.customData),{particleSystems:f.mergedParticles}),O="module"===s?e.tags:[];return Object.assign(Object.assign({},e),{assetLibraries:d,chapters:x,sceneGraph:a,customData:v,tags:O,reflections:u,colorRecipes:g,stateId:Object(D.uniq)([...e.stateId,...n.stateId]),tweenParticleLookup:f.tweenParticleLookup})}var na,ia,sa,oa=n("eIep");function ra(e){return function(e){return new P.a(t=>{const n=new Image;n.onload=()=>{const e=function(e){const t=document.createElement("canvas"),n=t.getContext("2d");return t.width=e.naturalWidth,t.height=e.naturalHeight,n.drawImage(e,0,0),t}(n);t.next(e),t.complete()},n.onerror=()=>{const e=document.createElement("canvas");t.next(e),t.complete()},n.src=e})}(e).pipe(Object(I.a)(e=>!Object(D.isNil)(e)),Object(oa.a)(e=>new P.a(t=>{e.toBlob(e=>{t.next(e),t.complete()},"image/jpeg",100)})))}!function(e){function t(e,t){const n=new Ps;if(e.thumbnails)n.legacy=!1,n.storyId=t,n.chapterId=e.id,n.urls=Object.assign({},e.thumbnails);else{const i=`/thumbs/${o.Bookmark===Gr(t)?"bookmarks":"modules"}/${t.replace(".json","")}`;n.legacy=!0,n.storyId=t,n.chapterId=e.id,n.urls={small:`${i}/small/chapters/${e.id}.jpg`,large:`${i}/large/chapters/${e.id}.jpg`}}return n}e.generateLegacyThumbnail=function(e,t){const n=`/thumbs/${o.Bookmark===Gr(e)?"bookmarks":"modules"}/${e.replace(".json","")}`;return{small:`${n}/small/chapters/${t}.jpg`,large:`${n}/large/chapters/${t}.jpg`}},e.generateThumbnails=function(e){return e.reduce((e,{originalChapterId:t,newChapterId:n,originalStoryId:i})=>{const s=o.Bookmark===Gr(i),r=new Ps;r.storyId=i,r.chapterId=t;const a=`/thumbs/${s?"bookmarks":"modules"}/${i.replace(".json","")}`;return r.urls={small:`${a}/small/chapters/${t}.jpg`,large:`${a}/large/chapters/${t}.jpg`},e.set(n,r),e},new Map)},e.getChapterThumbnail=t,e.getChapterThumbnails=function(e,n){return n.reduce((n,i)=>{const s=t(i,e);return n.set(i.id,s),n},new Map)},e.makeFreshThumbnail=function(e,t,n){return ra(n).pipe(Object(I.a)(e=>!Object(D.isNil)(e)),Object(F.a)(n=>{const i=new Ps;return i.snapshot=URL.createObjectURL(n),i.chapterId=t,i.storyId=e,i}))}}(na||(na={}));class aa{}class ca{}class la{}function pa(e,t){return{showObjects:Object(D.mapKeys)(e.showObjects,(e,n)=>sa.renamespaceValue(n,t)),selectObjects:Object(D.mapKeys)(e.selectObjects,(e,n)=>sa.renamespaceValue(n,t)),pickThroughObjects:Object(D.mapKeys)(e.pickThroughObjects,(e,n)=>sa.renamespaceValue(n,t)),synchronization:Object(D.mapKeys)(e.synchronization,(e,n)=>sa.renamespaceValue(n,t))}}function da(e,t){return(e||[]).map(e=>Object.assign(Object.assign({},e),{objectId:sa.renamespaceValue(e.objectId,t),states:e.states.map(e=>{return Object.assign(Object.assign({},e),{errands:(n=e.errands,n.map(e=>e.type===wi.flyToChapter||e.type===wi.flyToObject?Object.assign(Object.assign({},e),{value:sa.renamespaceValue(e.value,t)}):e))});var n})}))}function ua(e,t){return(e||[]).map(e=>(e.data.timeline=t[e.data.timeline]||e.data.timeline,e))}function ga(e,t){return(e||[]).map(e=>(e.objectId&&(e.objectId=sa.renamespaceValue(e.objectId,t)),e))}function ha(e,t){return e?{xray:Object(D.mapKeys)(e.xray,(e,n)=>sa.renamespaceValue(n,t)),highlight:Object(D.mapKeys)(e.highlight,(e,n)=>sa.renamespaceValue(n,t))}:{}}function ba(e,t){const n=Object.assign({},e);return Array.isArray(e.layers)&&(n.layers=e.layers.map(e=>Object.assign(Object.assign({},e),{objectIds:e.objectIds.map(e=>sa.renamespaceValue(e,t))}))),n}function ma(e,t){function n(e=[]){return e.map(e=>Object.assign(Object.assign({},e),{src:sa.renamespaceValue(e.src,t)}))}let i=[];return e&&Array.isArray(e.particleSystems)&&(i=e.particleSystems.map((function(e){return Object.assign(Object.assign({},e),{textures:n(e.textures)})}))),i}function fa(e,t){const n=function(e,t){return"string"==typeof e?[t[e]||e]:e.map(e=>t[e]||e)}(e.stateId,t),i=e.assetLibraries.tweens.map(e=>sa.renamespaceValue(e,t)),s=e.assetLibraries.reflections.map(e=>sa.renamespaceValue(e,t)),o=Object(D.mapValues)(e.reflections,(e,n)=>sa.renamespaceValue(e,t)),r=function(e,t){return e.map(e=>Object.assign(Object.assign(Object.assign({},e),pa(e,t)),{colorRecipeObjects:ha(e.colorRecipeObjects,t),timelineMap:ua(e.timelineMap,t),labels:da(e.labels,t),hotspots:ga(e.hotspots,t),visibilityLayers:ba(e.visibilityLayers,t)}))}(e.chapters,t),a=function e(t,n){for(const i of t)["objectId","displayName","geometryId","morphId","materialId","transformId"].forEach(e=>{i[e]&&(i[e]=sa.renamespaceValue(i[e],n))}),e(i.objects||[],n);return t}(e.sceneGraph,t),c=Object.assign(Object.assign({},e.customData),{particleSystems:ma(e.customData,t)});return Object.assign(Object.assign(Object.assign(Object.assign({},e),{stateId:n}),pa(e,t)),{assetLibraries:Object.assign(Object.assign({},e.assetLibraries),{tweens:i,reflections:s}),reflections:o,chapters:r,sceneGraph:a,customData:c})}!function(e){function t(e,t=0){["x","y","z"].forEach(n=>{void 0!==e[n]&&Math.abs(e[n]-t)<1e-4&&delete e[n]})}function n(e){["translate","rotate","pivot"].forEach(n=>{void 0!==e[n]&&(t(e[n]),0===Object.keys(e[n]).length&&delete e[n])}),void 0!==e.scale&&(t(e.scale,1),0===Object.keys(e.scale).length&&delete e.scale)}function i(e,t){["backfaces","displayName","layer"].forEach(n=>{e[n]&&(t[n]=e[n])})}function s(e,t){const i=new ca;i.translate=JSON.parse(JSON.stringify(e.translate)),i.rotate=JSON.parse(JSON.stringify(e.rotate)),i.scale=JSON.parse(JSON.stringify(e.scale)),i.pivot=JSON.parse(JSON.stringify(e.pivot)),n(i),Object.entries(i).forEach(([e,n])=>{t[e]=JSON.parse(JSON.stringify(n))}),t.transformId&&delete t.transformId}function o(e,t){const n=["geometryId","morphId","materialId"],i=[];return e.renderables&&e.renderables.forEach(e=>{const t=new aa;n.forEach(n=>{e[n]&&(t[n]=e[n])}),e.layer&&(t.layer=e.layer),i.push(t)}),1===i.length?t=Object.assign(Object.assign({},t),i[0]):i.length>1&&(t.renderables=i),t}e.filterTransformProperties=n,e.serializeObjectProperties=i,e.serializeTransformData=s,e.serializeRenderables=o,e.serializeHumanObject=function e(t,n){if(n[t.objectId])return null;let r=new la;return r.objectId=t.objectId,i(t,r),t.transformId?r.transformId=t.transformId:s(t,r),r=o(t,r),t.objects&&t.objects.length&&(r.objects=[]),t.objects.forEach(t=>{const i=e(t,n);null!==i&&r.objects.push(i)},this),r}}(ia||(ia={})),function(e){function t(e,t){const n=Object.entries(t);return n.sort((e,t)=>e[0].length===t[0].length?0:e[0].length<t[0].length?1:-1),n.reduce((e,[t,n])=>{if(e.startsWith(t)){const i=new RegExp("^"+t);e=e.replace(i,n)}return e},e||"")}e.renamespaceValue=t,e.renamespaceKeys=function(e,n){return Object.entries(e).reduce((e,[i,s])=>(e[t(i,n)]=s,e),{})},e.renamespaceAssetLibrary=function(e,n,i){if(!i)return e;const s=e.tweens.map(e=>t(e,n)),o=e.reflections.map(e=>t(e,n));return Object.assign(Object.assign({},e),{tweens:s,reflections:o})},e.renamespaceReflections=function(e,n,i){return i?Object(D.mapValues)(e,e=>t(e,n)):e}}(sa||(sa={}));class ya{}var xa,va=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},Oa=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const wa={enableContextLabel:{enable:!0,enableInfo:!0,enableActions:!0},loading:!1,labelsCollapsed:!1,labelsCollapsedMode:no.None,labelScale:null,labels:[],contextLabel:null,selectedLabel:null,draggable:{pin:!0,tag:!0}};let Ca=(()=>{let e=xa=class{constructor(e,t){this.store=e,this.labelsService=t}static getLabels(e){return e.labels}static getLabelsCollapsed(e){return e.labelsCollapsed}static getLabelsCollapsedMode(e){return e.labelsCollapsedMode}static getSelectedLabelId(e){return e.selectedLabel}static getSelectedLabel(e){return e.labels.find(t=>t.id===e.selectedLabel)||null}static getContextLabel(e){return e.contextLabel}static getChapterLabels(e,t){return e.labels.filter(e=>e.chapterId===t.selectedChapter)}static getChapterSequentialLabels(e){return Object(d.h)([xa,Or],(t,n)=>t.labels.filter(t=>t.chapterId===n.selectedChapter&&t.pinType===oi.Sequential&&t.sequentialType===e))}static getLabelSequence(e){return Object(d.h)([xa,xa.getChapterSequentialLabels(ai.Alphabetical),xa.getChapterSequentialLabels(ai.Numerical)],(t,n,i)=>{if(e.pinType!==oi.Sequential)return null;switch(e.sequentialType){case ai.Alphabetical:const t=n.findIndex(t=>t.id===e.id);return"ABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(t);case ai.Numerical:return i.findIndex(t=>t.id===e.id)+1}})}static getEnableContextLabel(e){return e.enableContextLabel.enable}static getEnableContextLabelInfo(e){return e.enableContextLabel.enableInfo}static getEnableContextLabelActions(e){return e.enableContextLabel.enableActions}static getLabelsDraggable(e){return e.draggable}static getLabelScale(e){return e.labelScale}PatchLabels(e,t){const n=immer.applyPatches(e.getState(),t.patches);e.patchState(n)}setLabelOffset(e,t){const[n,i,s]=immer.produceWithPatches(e.getState(),e=>{const n=e.labels.find(e=>e.id===t.labelId);n&&(n.offset=t.offset)});e.patchState(n),this.savePatches(i,s)}setLabels(e,t){e.patchState(immer.produce(e.getState(),e=>{e.labels=t.labels}))}setLabel(e,t){const[n,i,s]=immer.produceWithPatches(e.getState(),e=>{e.labels=e.labels.map(e=>e.id===t.label.id?t.label:e)});e.patchState(n),t.record&&this.savePatches(i,s)}setLabelStates(e,t){const[n,i,s]=immer.produceWithPatches(e.getState(),e=>{e.labels.find(e=>e.id===t.id).states=t.states});e.patchState(n),this.savePatches(i,s)}setLabelScale(e,t){e.patchState({labelScale:t.scale})}addLabel(e,t){const[n,i,s]=immer.produceWithPatches(e.getState(),e=>{const n=t.label.id||yi.idWithPrefix("label"),i=Object.assign(Object.assign({},t.label),{id:n});e.labels.push(i)});e.patchState(n),this.savePatches(i,s)}addContextLabel(e,t){const n=immer.produce(e.getState(),e=>{e.contextLabel=Object.assign(Object.assign({},t.label),{id:"context-label"})});e.patchState(n)}copyLabels(e,t){const n=e.getState().labels,i=n.filter(e=>e.chapterId===t.sourceChapter.id).map(e=>Object.assign(Object.assign({},Object(D.cloneDeep)(e)),{id:yi.idWithPrefix("label"),chapterId:t.targetChapter.id}));e.patchState({labels:[...n,...i]})}removeLabel(e,t){const[n,i,s]=immer.produceWithPatches(e.getState(),e=>{e.labels=e.labels.filter(e=>e.id!==t.label.id)});e.patchState(n),Human.scene.markers.delete(t.label.id),this.savePatches(i,s)}removeContextLabel(e,t){const n=immer.produce(e.getState(),e=>{e.contextLabel=void 0});Human.scene.markers.delete("context-label"),e.patchState(n)}removeAllChapterLabels(e,t){const[n,i,s]=immer.produceWithPatches(e.getState(),e=>{const[n,i]=Object(D.partition)(e.labels,e=>e.chapterId!==t.chapter.id);i.forEach(e=>Human.scene.markers.delete(e.id)),e.labels=n});e.patchState(n),this.savePatches(i,s)}selectLabel(e,t){e.patchState({selectedLabel:t.label?t.label.id:null})}resetLabels(e,t){const n=e.getState();Human.scene.markers.delete("context-label"),n.labels.forEach(e=>{Human.scene.markers.delete(e.id)}),e.setState(immer.produce(e.getState(),e=>{}))}convertLabels(e,t){const[n,i,s]=immer.produceWithPatches(e.getState(),e=>{t.labels.forEach(n=>{const i=e.labels.findIndex(e=>e.id===n.id);e.labels[i]=Object.assign(Object.assign({},e.labels[i]),t.fields)})});e.setState(Object.assign({},n)),this.savePatches(i,s)}enableContextLabel(e,t){e.patchState({enableContextLabel:Object.assign({},t)})}setLabelsShown(e,{labels:t,shown:n}){const i=e.getState().labels.map(e=>{const i=t.some(t=>t.id===e.id);return Object.assign(Object.assign({},e),{shown:i?n:e.shown})});e.patchState({labels:[...i]})}setAllLabelsShown(e,{show:t}){const n=e.getState().labels;e.dispatch(new vo(n,t))}setLabelsCollapsed(e,{collapsed:t,collapsedMode:n}){e.patchState({labelsCollapsed:t,labelsCollapsedMode:n})}setLabelsDraggable(e,t){e.patchState({draggable:Object.assign({},t.draggable)})}savePatches(e,t){this.store.dispatch(new zi.SavePatches([{forward:e,inverse:t,patchAction:io}]))}};return e.\u0275fac=function(t){return new(t||e)(i.Zb(d.g),i.Zb(Pi))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac}),va([Object(d.a)(io),Oa("design:type",Function),Oa("design:paramtypes",[Object,io]),Oa("design:returntype",void 0)],e.prototype,"PatchLabels",null),va([Object(d.a)(so),Oa("design:type",Function),Oa("design:paramtypes",[Object,so]),Oa("design:returntype",void 0)],e.prototype,"setLabelOffset",null),va([Object(d.a)(oo),Oa("design:type",Function),Oa("design:paramtypes",[Object,oo]),Oa("design:returntype",void 0)],e.prototype,"setLabels",null),va([Object(d.a)(go),Oa("design:type",Function),Oa("design:paramtypes",[Object,go]),Oa("design:returntype",void 0)],e.prototype,"setLabel",null),va([Object(d.a)(ho),Oa("design:type",Function),Oa("design:paramtypes",[Object,ho]),Oa("design:returntype",void 0)],e.prototype,"setLabelStates",null),va([Object(d.a)(bo),Oa("design:type",Function),Oa("design:paramtypes",[Object,bo]),Oa("design:returntype",void 0)],e.prototype,"setLabelScale",null),va([Object(d.a)(ro),Oa("design:type",Function),Oa("design:paramtypes",[Object,ro]),Oa("design:returntype",void 0)],e.prototype,"addLabel",null),va([Object(d.a)(ao),Oa("design:type",Function),Oa("design:paramtypes",[Object,ao]),Oa("design:returntype",void 0)],e.prototype,"addContextLabel",null),va([Object(d.a)(co),Oa("design:type",Function),Oa("design:paramtypes",[Object,co]),Oa("design:returntype",void 0)],e.prototype,"copyLabels",null),va([Object(d.a)(lo),Oa("design:type",Function),Oa("design:paramtypes",[Object,lo]),Oa("design:returntype",void 0)],e.prototype,"removeLabel",null),va([Object(d.a)(po),Oa("design:type",Function),Oa("design:paramtypes",[Object,po]),Oa("design:returntype",void 0)],e.prototype,"removeContextLabel",null),va([Object(d.a)(uo),Oa("design:type",Function),Oa("design:paramtypes",[Object,uo]),Oa("design:returntype",void 0)],e.prototype,"removeAllChapterLabels",null),va([Object(d.a)(mo),Oa("design:type",Function),Oa("design:paramtypes",[Object,mo]),Oa("design:returntype",void 0)],e.prototype,"selectLabel",null),va([Object(d.a)(fo),Oa("design:type",Function),Oa("design:paramtypes",[Object,fo]),Oa("design:returntype",void 0)],e.prototype,"resetLabels",null),va([Object(d.a)(yo),Oa("design:type",Function),Oa("design:paramtypes",[Object,yo]),Oa("design:returntype",void 0)],e.prototype,"convertLabels",null),va([Object(d.a)(xo),Oa("design:type",Function),Oa("design:paramtypes",[Object,xo]),Oa("design:returntype",void 0)],e.prototype,"enableContextLabel",null),va([Object(d.a)(vo),Oa("design:type",Function),Oa("design:paramtypes",[Object,vo]),Oa("design:returntype",void 0)],e.prototype,"setLabelsShown",null),va([Object(d.a)(Oo),Oa("design:type",Function),Oa("design:paramtypes",[Object,Oo]),Oa("design:returntype",void 0)],e.prototype,"setAllLabelsShown",null),va([Object(d.a)(wo),Oa("design:type",Function),Oa("design:paramtypes",[Object,wo]),Oa("design:returntype",void 0)],e.prototype,"setLabelsCollapsed",null),va([Object(d.a)(Co),Oa("design:type",Function),Oa("design:paramtypes",[Object,Co]),Oa("design:returntype",void 0)],e.prototype,"setLabelsDraggable",null),va([Object(d.e)(),Oa("design:type",Function),Oa("design:paramtypes",[ya]),Oa("design:returntype",void 0)],e,"getLabels",null),va([Object(d.e)(),Oa("design:type",Function),Oa("design:paramtypes",[ya]),Oa("design:returntype",void 0)],e,"getLabelsCollapsed",null),va([Object(d.e)(),Oa("design:type",Function),Oa("design:paramtypes",[ya]),Oa("design:returntype",void 0)],e,"getLabelsCollapsedMode",null),va([Object(d.e)(),Oa("design:type",Function),Oa("design:paramtypes",[ya]),Oa("design:returntype",void 0)],e,"getSelectedLabelId",null),va([Object(d.e)(),Oa("design:type",Function),Oa("design:paramtypes",[ya]),Oa("design:returntype",void 0)],e,"getSelectedLabel",null),va([Object(d.e)(),Oa("design:type",Function),Oa("design:paramtypes",[ya]),Oa("design:returntype",void 0)],e,"getContextLabel",null),va([Object(d.e)([Or]),Oa("design:type",Function),Oa("design:paramtypes",[ya,On]),Oa("design:returntype",void 0)],e,"getChapterLabels",null),va([Object(d.e)(),Oa("design:type",Function),Oa("design:paramtypes",[ya]),Oa("design:returntype",void 0)],e,"getEnableContextLabel",null),va([Object(d.e)(),Oa("design:type",Function),Oa("design:paramtypes",[ya]),Oa("design:returntype",void 0)],e,"getEnableContextLabelInfo",null),va([Object(d.e)(),Oa("design:type",Function),Oa("design:paramtypes",[ya]),Oa("design:returntype",void 0)],e,"getEnableContextLabelActions",null),va([Object(d.e)(),Oa("design:type",Function),Oa("design:paramtypes",[ya]),Oa("design:returntype",void 0)],e,"getLabelsDraggable",null),va([Object(d.e)(),Oa("design:type",Function),Oa("design:paramtypes",[ya]),Oa("design:returntype",void 0)],e,"getLabelScale",null),e=xa=va([Object(d.f)({name:"labels",defaults:wa})],e),e})(),Sa=(()=>{class e{constructor(e,t,n,i,s){this.store=e,this.engineService=t,this.chapterSerializer=n,this.animationService=i,this.chapterService=s}serializeUI(e){const t=Object.assign({},e.ui);return e.chapters.length>1&&(t.scrubber=!1,t.playPause=!1,t.tour={chapters:!0}),t}serializeAnimation(e){return this.animationService.isChapterAnimated(e)?{startTime:e.timelineMap[0].start,loop:!1!==e.loop,numChapters:1}:{}}getClippedObjects(){return 0===Human.renderer.clip.getActiveClips().length?{}:Human.scene.getLeaves().reduce((e,t)=>(Human.scene.objects[t].culledByClip&&(e[t]=!0),e),{})}generateTrimObjectMap(e){const t={};if(e.graph.hidden){const e=this.store.selectSnapshot(Bi.getAllNodeState);Object.values(e).forEach(e=>{Object.entries(e).forEach(([e,n])=>{!1!==t[e]&&(t[e]=!(n.shown||n.shownSetByTween))})})}const n=e.graph.clipped?this.getClippedObjects():{};return Object.assign(Object.assign({},t),n)}serialize(e,t,n=!1,i,s,o){const r=Object(D.cloneDeep)(i),a=this.generateTrimObjectMap(t);r.sceneGraph=function(e,t){const n=[];return Object.entries(e).forEach(([e,i])=>{const s=ia.serializeHumanObject(i,t);null!==s&&n.push(s)},this),n}(Human.scene.rootObjects,a);const c=Dt.createGraphFromSrc(r.sceneGraph,"objectId","objects",new Ut(Human.scene.colorRecipes.getRecipes())),l=this.store.selectSnapshot(Ca.getLabels);this.store.selectSnapshot(qs.getRegisteredThumbnails),r.chapters=s.map(t=>this.chapterSerializer.serializeChapter(c,t,e,l,o)),r.ui=this.serializeUI(r),r.animation=this.serializeAnimation(s[0]),r.customData=Object.assign(Object.assign({},r.customData),{particleSystems:this.store.selectSnapshot(ts.getParticleSystemsList)});const p=this.store.selectSnapshot(xs.getAllQuestions),d=this.store.selectSnapshot(xs.getQuizSettings);d&&p.length>0?r.quizSettings=d:delete r.quizSettings,r.tweenParticleLookup=this.store.selectSnapshot(ts.getTweenParticleLookup);const u=s.reduce((e,t)=>e.concat(this.chapterService.getChapterLightLibraries(t)),[]);r.assetLibraries.lights=Array.from(new Set(u));const g=this.getReflectionLibraries(r.reflections),h=s.reduce((e,t)=>e.concat(this.chapterService.getChapterReflectionLibraries(t)),[]);r.assetLibraries.reflections=Array.from(new Set(g.concat(h)));const b=[].concat.apply([],Object.values(r.assetLibraries)),m=this.getSceneGraphStateIds(r.sceneGraph);return r.stateId=Array.from(new Set(b.map(this.getStateId).concat(m))),{story:n?fa(r,e):r}}getReflectionLibraries(e){return e=e||{},Object.values(e).map(e=>{const t=e.split(".");return[t[0],t[1]].join("/")})}getSceneGraphStateIds(e){return e.map(e=>e.objectId.split("-")[0])}getStateId(e){return e.split("/")[0]}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(d.g),i.Zb(Qt),i.Zb(Ks),i.Zb(eo),i.Zb(to))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();class _a{constructor(){this.graph={hidden:!1,clipped:!1,disabled:!1,transparent:!1}}}var ja,ka=n("3E0/"),Pa=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},Ma=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const Ia={loading:!1,incoming:{id:void 0,type:void 0},storyId:void 0,storyType:void 0,loadingChunk:null,loadChunks:[],loadChunksRemaining:[],thumbnailLookup:[]};let za=(()=>{let e=ja=class{constructor(e,t,n,i,s){this.store=e,this.storyService=t,this.engineService=n,this.serializeModuleService=i,this.storageService=s,this.reload=c.native}static getStory(e){return e.story}static getStoryId(e){return e.storyId}static getLoadingChunk(e){return e.loadingChunk}static getLoadChunks(e){return e.loadChunks}static getLoadChunksRemaining(e){return e.loadChunksRemaining}static getStoryInfo(e){return{id:e.storyId,type:e.storyType}}static getIncomingStoryInfo(e){return e.incoming}static getStoryTags(e){return Object(D.get)(e,"story.tags",[])}setStoryText(e,t){const n=e.getState().story;n&&e.patchState({story:Object.assign(Object.assign({},n),{displayName:t.displayName})})}setStoryTags(e,{tags:t}){const n=e.getState().story;n&&e.patchState({story:Object.assign(Object.assign({},n),{tags:t})})}setStoryLightLibs(e,t){const n=e.getState().story;n&&e.patchState({story:Object.assign(Object.assign({},n),{assetLibraries:Object.assign(Object.assign({},n.assetLibraries),{lights:t.lightLibs})})})}setStory(e,t){e.patchState({story:t.story})}SetStoryId(e,t){e.patchState({storyId:t.id})}setIncomingStory(e,t){const n=e.getState(),{id:i,type:s,reset:o}=t;i!==n.storyId||o?e.patchState({incoming:{id:i,type:s}}):o&&e.dispatch(new Se(t.id,n.story,t.type))}loadStory(e,t){(t.preview?Object(As.a)(this.storageService.getDatabaseItem(or.PreviewStory)):this.storyService.getStory(t.id,t.type,t.lang)).subscribe(n=>{e.dispatch(new _e(n,t.id,t.type))},()=>{!0===this.reload?(this.reload=!1,this.loadStory(e,t)):e.dispatch(new je(t.id,t.type))})}loadStorySuccess(e,t){this.storyService.unloadStory(null).pipe(Object(ka.a)(0)).subscribe(()=>{e.dispatch(new Se(t.id,t.story,t.type))})}buildStoryWorkflow(e,t,n,i,s=0,o=new Map){this.storyService.buildStory(t,n,!0).subscribe(r=>{const a=this.storyService.getStoryChapters(t,i);let c=[];a.forEach(e=>{c=[...c,...e.labels]});const l=this.storyService.getLoadConfig(t,s),p=this.storyService.getStoryLoadChunks(t,l);e.patchState({storyId:t,story:n,loadChunks:p,loadChunksRemaining:p,incoming:{id:void 0,type:void 0}});const d=this.engineService.getSceneGraph(Human.scene.rootObjects),u=a.reduce((e,t)=>(e[t.id]=function(e,t,n,i){return Object.keys(e.nodes).reduce((s,o)=>(s[o]=function(s){const o=Ki(e,s,t)||Wi(e,s,t),r=function e(t,n,i){switch(i[n]){case!0:return!1;case!1:return!0;case void 0:{const s=Dt.getAncestor(t,n);return!s||e(t,s,i)}}}(e,s,n);return{objectId:s,checked:!1,selected:!1,paint:function e(t,n,i){if(i&&i[n]&&("tintColor"in(s=i[n])||"opacity"in s||"brightness"in s||"saturation"in s||"contrast"in s))return Fi.fromEngine(new qi(i[n]));var s;const o=Dt.getAncestor(t,n);return o?e(t,o,i):Hi}(e,s,i),pickable:r,shown:o,shownSetByTween:!1}}(o),s),{})}(d,t.showObjects,t.pickThroughObjects,t.synchronization),e),{});e.dispatch(new Ii.InitNodeState(u)),e.dispatch(new Ii.SetActiveChapter(a[s].id)),e.dispatch(new Mn(a)),e.dispatch(new Cs(o)),e.dispatch(new oo(c)),e.dispatch(new kn(a[s]));const g=Object(D.get)(n,"tweenParticleLookup",{}),h=Object(D.get)(n,"customData.particleSystems",[]),b=a.reduce((e,t)=>(e[t.id]=Object(D.get)(t,"customData.particleSystems",[]),e),{});e.dispatch(new Gi.SetParticleState(h,b,g)),e.dispatch(new ns.ResetQuizState),n.quizSettings&&e.dispatch(new ns.SetQuizSettings(n.quizSettings));const m=rs(a);e.dispatch(new ns.SetQuestions(m)),e.dispatch(new Te),e.dispatch(new Oe)})}importStorySuccess(e,t){const n=e.getState(),i=n.storyType,s=n.storyId,o=new _a,r=this.store.selectSnapshot(ja.getStory),a=this.store.selectSnapshot(Or.getStoryChapters),l=Gs.makeChapterIdMap(a,!1),p=this.serializeModuleService.serialize({},o,!1,r,a,l).story,d=ta(p,s,t.story,t.id,c.exportType),u=d.chapters.slice(p.chapters.length).reduce((e,n,i)=>(e[t.story.chapters[i].id]=n.id,e),{}),g=t.story.chapters.reduce((e,n)=>{const i=n.thumbnails?n.thumbnails.large:na.generateLegacyThumbnail(t.id,n.id).large,o=na.makeFreshThumbnail(s,u[n.id],i);return e.push(o),e},[]);Object(Vr.a)(g).subscribe(t=>{const n=this.store.selectSnapshot(qs.getRegisteredThumbnails);t.forEach(e=>{n.set(e.chapterId,e)}),this.storyService.unloadStory(null,!0).subscribe(()=>{this.buildStoryWorkflow(e,s,d,i,d.chapters.length-1,n)})})}buildStory(e,t){t.story.chapters.map((e,n)=>({newChapterId:e.id,originalChapterId:e.id,originalStoryId:t.id}));const n=na.getChapterThumbnails(t.id,t.story.chapters);this.buildStoryWorkflow(e,t.id,t.story,t.type,t.chapterIdx||0,n)}loadStoryChunk(e){const t=e.getState().loadChunksRemaining[0];t&&(e.patchState({loadingChunk:t}),this.storyService.loadStoryChunk(t,()=>{e.dispatch([new Ce(t),new Oe])}))}reorderLoadChunks(e,t){const{loadChunksRemaining:n}=e.getState(),[i,s]=Object(D.partition)(n,e=>e.chapterId===t.chapterId);e.patchState({loadChunksRemaining:[...i,...s]})}loadStoryChunkSuccess(e,t){const n=e.getState().loadChunksRemaining.filter(e=>e.chunkId!==t.chunk.chunkId);e.patchState({loadingChunk:null,loadChunksRemaining:n}),e.dispatch(new En(t.chunk.chapterId,t.chunk.readyState))}synchronizeChapters(e){const t=this.store.selectSnapshot(Or.getStoryChapters),{story:n}=e.getState();e.patchState({story:Object.assign(Object.assign({},n),{chapters:[...t]})})}importStory(e,t){this.storyService.getStory(t.id,t.type,t.lang).subscribe(n=>{e.dispatch(new Pe(n,t.id,t.type))})}resetStory(e){e.setState(Ia)}mergeBridgeModuleSuccess(e,{story:t}){const n=e.getState(),i=this.store.selectSnapshot(Or.getSelectedChapterIndex),s=na.getChapterThumbnails(n.storyId,t.chapters);this.storyService.unloadStory(null,!0).subscribe(()=>{this.buildStoryWorkflow(e,n.storyId,t,o.Module,i,s)})}};return e.\u0275fac=function(t){return new(t||e)(i.Zb(d.g),i.Zb(Wr),i.Zb(Qt),i.Zb(Sa),i.Zb(ar))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac}),Pa([Object(d.a)(fe),Ma("design:type",Function),Ma("design:paramtypes",[Object,fe]),Ma("design:returntype",void 0)],e.prototype,"setStoryText",null),Pa([Object(d.a)(ye),Ma("design:type",Function),Ma("design:paramtypes",[Object,ye]),Ma("design:returntype",void 0)],e.prototype,"setStoryTags",null),Pa([Object(d.a)(xe),Ma("design:type",Function),Ma("design:paramtypes",[Object,xe]),Ma("design:returntype",void 0)],e.prototype,"setStoryLightLibs",null),Pa([Object(d.a)(be),Ma("design:type",Function),Ma("design:paramtypes",[Object,be]),Ma("design:returntype",void 0)],e.prototype,"setStory",null),Pa([Object(d.a)(me),Ma("design:type",Function),Ma("design:paramtypes",[Object,me]),Ma("design:returntype",void 0)],e.prototype,"SetStoryId",null),Pa([Object(d.a)(ve),Ma("design:type",Function),Ma("design:paramtypes",[Object,ve]),Ma("design:returntype",void 0)],e.prototype,"setIncomingStory",null),Pa([Object(d.a)(he),Ma("design:type",Function),Ma("design:paramtypes",[Object,he]),Ma("design:returntype",void 0)],e.prototype,"loadStory",null),Pa([Object(d.a)(_e),Ma("design:type",Function),Ma("design:paramtypes",[Object,_e]),Ma("design:returntype",void 0)],e.prototype,"loadStorySuccess",null),Pa([Object(d.a)(Pe),Ma("design:type",Function),Ma("design:paramtypes",[Object,Pe]),Ma("design:returntype",void 0)],e.prototype,"importStorySuccess",null),Pa([Object(d.a)(Se),Ma("design:type",Function),Ma("design:paramtypes",[Object,Se]),Ma("design:returntype",void 0)],e.prototype,"buildStory",null),Pa([Object(d.a)(Oe),Ma("design:type",Function),Ma("design:paramtypes",[Object]),Ma("design:returntype",void 0)],e.prototype,"loadStoryChunk",null),Pa([Object(d.a)(we),Ma("design:type",Function),Ma("design:paramtypes",[Object,we]),Ma("design:returntype",void 0)],e.prototype,"reorderLoadChunks",null),Pa([Object(d.a)(Ce),Ma("design:type",Function),Ma("design:paramtypes",[Object,Ce]),Ma("design:returntype",void 0)],e.prototype,"loadStoryChunkSuccess",null),Pa([Object(d.a)(Ie),Ma("design:type",Function),Ma("design:paramtypes",[Object]),Ma("design:returntype",void 0)],e.prototype,"synchronizeChapters",null),Pa([Object(d.a)(ke),Ma("design:type",Function),Ma("design:paramtypes",[Object,ke]),Ma("design:returntype",void 0)],e.prototype,"importStory",null),Pa([Object(d.a)(Me),Ma("design:type",Function),Ma("design:paramtypes",[Object]),Ma("design:returntype",void 0)],e.prototype,"resetStory",null),Pa([Object(d.a)(Ue),Ma("design:type",Function),Ma("design:paramtypes",[Object,Object]),Ma("design:returntype",void 0)],e.prototype,"mergeBridgeModuleSuccess",null),Pa([Object(d.e)(),Ma("design:type",Function),Ma("design:paramtypes",[Fr]),Ma("design:returntype",void 0)],e,"getStory",null),Pa([Object(d.e)(),Ma("design:type",Function),Ma("design:paramtypes",[Fr]),Ma("design:returntype",void 0)],e,"getStoryId",null),Pa([Object(d.e)(),Ma("design:type",Function),Ma("design:paramtypes",[Fr]),Ma("design:returntype",void 0)],e,"getLoadingChunk",null),Pa([Object(d.e)(),Ma("design:type",Function),Ma("design:paramtypes",[Fr]),Ma("design:returntype",void 0)],e,"getLoadChunks",null),Pa([Object(d.e)(),Ma("design:type",Function),Ma("design:paramtypes",[Fr]),Ma("design:returntype",void 0)],e,"getLoadChunksRemaining",null),Pa([Object(d.e)(),Ma("design:type",Function),Ma("design:paramtypes",[Fr]),Ma("design:returntype",void 0)],e,"getStoryInfo",null),Pa([Object(d.e)(),Ma("design:type",Function),Ma("design:paramtypes",[Fr]),Ma("design:returntype",void 0)],e,"getIncomingStoryInfo",null),Pa([Object(d.e)(),Ma("design:type",Function),Ma("design:paramtypes",[Fr]),Ma("design:returntype",void 0)],e,"getStoryTags",null),e=ja=Pa([Object(d.f)({name:"story",defaults:Ia})],e),e})();var Ta=n("itXk"),Ua=n("IzEk"),Da=function(e){return e[e.Content=0]="Content",e[e.Label=1]="Label",e[e.Tools=2]="Tools",e[e.Search=3]="Search",e[e.Help=4]="Help",e[e.NodeInfo=5]="NodeInfo",e[e.LabelInfo=6]="LabelInfo",e}({});const La=["ui-bd.class","ui-play-pause","ui-camera-mode","ui-center","ui-cross-section","ui-dissect","ui-fs","ui-tools-display","ui-tree","ui-zoom","ui-zoom-in","ui-zoom-out","ui-pan","ui-share","ui-keys","ui-slider","o","background.color-stops","background.gradient-type","dd","dn","image-display","imageDisplay","imageSrc","pre","referrer"];function Ea(e){const{id:t,s:n,m:i,be:s,b:o}=e;let r="";if(t)r=t;else if(s)r=s;else if(o){const e=parseInt(o,10);r=Number.isNaN(e)?"":function(e){const t=[];let n,i=e;for(;i>0;)[i,n]=(s=i,62,[Math.floor(s/62),s%62]),t.unshift("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz"[n]);var s;return t.join("")}(e)}else i&&(r=function(e,t="male"){return e.includes("/")?e:`production/${t}Adult/${e}`}(i,"female"===n?"female":"male"));return r.replace(/\.json$/,"")}function Fa(e){return Ea(e).includes("/")?"module":"bookmark"}const Aa={type:e=>Fa(e),id:e=>Ea(e),background:e=>e.bgstd||e["background.colors"]||e.background};function Ra(e){if(3===e.length){const{0:t,1:n,2:i}=e;return{x:t,y:n,z:i}}return null}const Va={camera:function(e){const t=e.split(",").map(e=>parseFloat(e));if(t.length%3==0&&!t.some(e=>Number.isNaN(e))){const e=t.slice(0,3),n=t.slice(3,6),i=t.slice(6,9);return{eye:Ra(e),look:Ra(n),up:Ra(i)}}return null},background:function(e){const t=si.getColors(e);if(t){const e=[...t[0][255],...t[1][255]];return new gi(e,"radial",[0,100])}return null}};function Na(e){const t=function(e){const t=Object.keys(e),n=t.filter(e=>La.includes(e));if(n.length>0){const e=[`The following URL parameters have been deprecated: "${n.join('", "')}"`,"Please contact support@biodigital.com for more information."];console.warn(e.join("\n"))}return t.reduce((e,t)=>(La.includes(t)&&delete e[t],e),e)}(e);var n;return function(e){const t=e=>{if(e){const t=e.toLowerCase();if("true"===t)return!0;if("false"===t)return!1;if(!isNaN(Number(t)))return Number(t)}return e};return Object.keys(e).reduce((n,i)=>{const s=(Va[i]||t)(e[i]);return"load-rotate"===i&&isNaN(Number(s))||(n[i]=s),n},{})}((n=t,Object.keys(Aa).filter(e=>void 0===n[e]).reduce((e,t)=>{const i=(0,Aa[t])(n);return void 0!==i&&(e[t]=i),e},n)))}let Ba=(()=>{class e{constructor(e){this.store=e}chapterHasTransition(e,t){const n=t?"transitions.pre":"transitions.post",i=Object(D.get)(e,n);return!!i&&(t?i.onPrevious:i.onNext)}searchChapterTransitions(e,t,n){let i=[...n],s=i.findIndex(t=>t.id===e),o=i.findIndex(e=>e.id===t);const r=o<s;if(r&&(i=i.reverse(),s=i.findIndex(t=>t.id===e),o=i.findIndex(e=>e.id===t)),s<0||o<0||s===o)return null;const a=i.slice(s,o).find(e=>this.chapterHasTransition(e,r));return a?r?a.transitions.pre:a.transitions.post:null}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(d.g))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var Ha,Qa=function(e){return e.JumpTo="jumpTo",e.FlyTo="flyTo",e}({});!function(e){class t{constructor(e){this.breakpoint=e}}t.type="[View] Set Breakpoint",e.SetBreakpoint=t}(Ha||(Ha={}));var $a=function(e){return e[e.XSmall=0]="XSmall",e[e.Small=1]="Small",e[e.Medium=2]="Medium",e[e.Large=3]="Large",e[e.XLarge=4]="XLarge",e}({}),qa=n("/uUt"),Wa=n("0MNC"),Ka=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},Ga=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};class Za{}let Ja=(()=>{let e=class{constructor(e,t){this.breakpointObserver=e,this.store=t}static getBreakpoint(e){return e.breakpoint}static getBreakpointLabel(e){return["(max-width: 374px)","(max-width: 599px)","(max-width: 959px)","(max-width: 1439px)","(min-width: 1440px)"][e.breakpoint]}setBreakpoint(e,t){e.patchState({breakpoint:t.breakpoint})}ngxsOnInit(e){const t=this.breakpointObserver.observe(["(max-width: 374px)"]),n=this.breakpointObserver.observe(["(max-width: 599px)"]),i=this.breakpointObserver.observe(["(max-width: 959px)"]),s=this.breakpointObserver.observe(["(max-width: 1439px)"]),o=this.breakpointObserver.observe(["(min-width: 1440px)"]);Object(Ta.b)(t,n,i,s,o).pipe(Object(F.a)(([e,t,n,i,s])=>e.matches?$a.XSmall:t.matches?$a.Small:n.matches?$a.Medium:i.matches?$a.Large:s.matches?$a.XLarge:null),Object(qa.a)(),Object(I.a)(e=>null!=e)).subscribe(t=>{e.dispatch(new Ha.SetBreakpoint(t))})}};return e.\u0275fac=function(t){return new(t||e)(i.Zb(Wa.a),i.Zb(d.g))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac}),Ka([Object(d.a)(Ha.SetBreakpoint),Ga("design:type",Function),Ga("design:paramtypes",[Object,Ha.SetBreakpoint]),Ga("design:returntype",void 0)],e.prototype,"setBreakpoint",null),Ka([Object(d.e)(),Ga("design:type",Function),Ga("design:paramtypes",[Za]),Ga("design:returntype",void 0)],e,"getBreakpoint",null),Ka([Object(d.e)(),Ga("design:type",Function),Ga("design:paramtypes",[Za]),Ga("design:returntype",void 0)],e,"getBreakpointLabel",null),e=Ka([Object(d.f)({name:"breakpoint",defaults:{breakpoint:null}})],e),e})();var Xa=function(e){return e.AnatomyLabels="anatomyLabels",e.Audio="audio",e.Camera="camera",e.Column="column",e.ColumnToggle="column-toggle",e.ContextActions="contextActions",e.Description="description",e.Drawer="drawer",e.Fullscreen="fullscreen",e.Help="help",e.InternetExplorerWarning="internetExplorerWarning",e.LabelList="labelList",e.Labels="labels",e.Layout="layout",e.Legend="legend",e.Loader="loader",e.Logo="logo",e.Media="media",e.Mediabar="mediabar",e.Menu="menu",e.NodeInfo="nodeInfo",e.Pagination="pagination",e.Presenter="presenter",e.Reset="reset",e.Search="search",e.ScrubberButton="scrubberButton",e.ScrubberItem="scrubberItem",e.TitleOnly="title-only",e.ToggleLabels="toggleLabels",e.Toolbar="toolbar",e.Tools="tools",e.Tutorial="tutorial",e.Undo="undo",e.VisibilityLayers="visibilityLayers",e.Whiteboard="whiteboard",e}({}),Ya=function(e){return e.Drawer="drawer",e.Column="column",e}({});let ec=(()=>{class e{constructor(e,t){this.storyLoadProgress=e,this.chunkLoadProgress=t}}return e.type="[Engine Progress] Set Progress",e})(),tc=(()=>{class e{constructor(){}}return e.type="[Engine Progress] Reset Progress",e})();var nc=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},ic=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const sc={storyLoadProgress:0,chunkLoadProgress:0};let oc=(()=>{let e=class{constructor(){}static getStoryLoadProgress(e){return e.storyLoadProgress}static getChunkLoadProgress(e){return e.chunkLoadProgress}setProgress(e,t){e.patchState({storyLoadProgress:t.storyLoadProgress,chunkLoadProgress:t.chunkLoadProgress})}resetProgress(e,t){e.setState(Object.assign({},sc))}};return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac}),nc([Object(d.a)(ec),ic("design:type",Function),ic("design:paramtypes",[Object,ec]),ic("design:returntype",void 0)],e.prototype,"setProgress",null),nc([Object(d.a)(tc),ic("design:type",Function),ic("design:paramtypes",[Object,tc]),ic("design:returntype",void 0)],e.prototype,"resetProgress",null),nc([Object(d.e)(),ic("design:type",Function),ic("design:paramtypes",[Object]),ic("design:returntype",void 0)],e,"getStoryLoadProgress",null),nc([Object(d.e)(),ic("design:type",Function),ic("design:paramtypes",[Object]),ic("design:returntype",void 0)],e,"getChunkLoadProgress",null),e=nc([Object(d.f)({name:"engineProgress",defaults:sc})],e),e})(),rc=(()=>{class e{constructor(e,t){this.store=e,this.chapterService=t,this.ui=null,this.breakpoint=null}getBase(){return{ui:this.store.selectSnapshot(mr.getUI),layout:this.store.selectSnapshot(mr.getLayout),breakpoint:this.store.selectSnapshot(Ja.getBreakpoint),hideUI:this.isUIHidden()}}isUIHidden(){const e=this.store.selectSnapshot(mr.getOpenWindow),t=this.store.selectSnapshot(Or.getSelectedChapterIndex),n=this.store.selectSnapshot(mr.getUI),i=e===Eo.Loader&&t<=0&&n.loader.template===ko.Circle,s=this.store.selectSnapshot(oc.getStoryLoadProgress);return i||0===s||e===Eo.OnDemand||e===Eo.Interact||e===Eo.Tutorial||e===Eo.Whiteboard}isDrawerVisible(){const{hideUI:e,ui:t,layout:n}=this.getBase();return!e&&this.getViewLayout(n)===Ya.Drawer&&(t.drawer.enable&&"none"!==this.getVisibleContent()||t.nodeInfo.status===_o.Show||t.labelInfo.status===_o.Show)}isColumnVisible(){const{hideUI:e,layout:t,ui:n}=this.getBase();return!e&&n.column.status!==_o.Collapse&&this.getViewLayout(t)===Ya.Column&&n.column.enable&&"full"===this.getVisibleContent()}isColumnToggleVisible(){const{hideUI:e,layout:t,ui:n}=this.getBase();return!e&&!this.store.selectSnapshot(xs.getQuizModeActive)&&this.getViewLayout(t)===Ya.Column&&n.column.enable&&"full"===this.getVisibleContent()}isTitleOnlyVisible(){const{hideUI:e,ui:t,breakpoint:n}=this.getBase();return!e&&!(n<$a.Large)&&t.titleOnly.enable&&"titleOnly"===this.getVisibleContent()}isToolsVisible(){const{hideUI:e}=this.getBase();return!e&&this.isUIVisible(Xa.Tools)}isToolbarVisible(){const{hideUI:e,ui:t}=this.getBase();return!e&&t.toolbar.enable}isLogoVisible(){const{ui:e}=this.getBase();return this.store.selectSnapshot(mr.getOpenWindow)!==Eo.OnDemand&&e.logo.enable}isCameraVisible(){const{hideUI:e,ui:t}=this.getBase();return!e&&t.camera.enable}isPaginationVisible(){const{hideUI:e,ui:t}=this.getBase();return!e&&!(this.store.selectSnapshot(Or.getChapterCount)<=1)&&t.pagination.enable}isMediaVisible(){const{hideUI:e,ui:t}=this.getBase();return!e&&this.store.selectSnapshot(Or.getIsChapterAnimated)&&t.media.enable}isMediabarVisible(){const{hideUI:e}=this.getBase();if(e)return!1;const t=this.isMediaVisible(),n=this.isAudioVisible();return t||n}isScrubberVisible(e){const{hideUI:t,ui:n,breakpoint:i}=this.getBase();if(t)return!1;const s=this.isMediaVisible&&n.media.template===jo.Full;switch(e){case Xa.ScrubberButton:return s&&i>$a.Small;case Xa.ScrubberItem:return s&&i<=$a.Small}}isMenuVisible(){const{hideUI:e,ui:t}=this.getBase();return!e&&(t.fullscreen.enable||t.help.enable||t.search.enable||t.tools.enable||t.whiteboard.enable||t.tutorial.enable)&&t.menu.enable}isNodeInfoColumnVisible(){const{hideUI:e,ui:t,breakpoint:n}=this.getBase();return!e&&(!!(n>=$a.Large&&this.isUIVisible(Xa.NodeInfo))||(n<$a.Large?!t.drawer.enable&&this.isUIVisible(Xa.NodeInfo):void 0))}isNodeInfoVisible(e){const{hideUI:t,breakpoint:n}=this.getBase();return!t&&(n>=$a.Large&&e===Ya.Column||n<$a.Large&&e===Ya.Drawer)&&this.isUIVisible(Xa.NodeInfo)}isAudioVisible(){const{hideUI:e,ui:t}=this.getBase();if(e)return!1;const n=null!=this.store.selectSnapshot(Or.getSelectedChapterAudio);return t.audio.enable&&n}isSearchColumnVisible(){const{hideUI:e}=this.getBase();return!e&&this.isUIVisible(Xa.Search)}isUndoVisible(){const{hideUI:e,ui:t}=this.getBase();return!e&&t.undo.enable}isVisibilityLayersVisible(){const{hideUI:e,ui:t}=this.getBase();if(e)return!1;const n=t.visibilityLayers.enable,i=this.store.selectSnapshot(Or.getSelectedChapterCurrentLayers);return n&&this.chapterService.hasVisibilityLayers(i)}isVisible(e){switch(e){case Xa.Audio:return this.isAudioVisible();case Xa.Camera:return this.isCameraVisible();case Xa.Column:return this.isColumnVisible();case Xa.ColumnToggle:return this.isColumnToggleVisible();case Xa.Drawer:return this.isDrawerVisible();case Xa.Logo:return this.isLogoVisible();case Xa.Media:return this.isMediaVisible();case Xa.Mediabar:return this.isMediabarVisible();case Xa.Menu:return this.isMenuVisible();case Xa.Pagination:return this.isPaginationVisible();case Xa.Search:return this.isSearchColumnVisible();case Xa.ScrubberButton:return this.isScrubberVisible(Xa.ScrubberButton);case Xa.ScrubberItem:return this.isScrubberVisible(Xa.ScrubberItem);case Xa.TitleOnly:return this.isTitleOnlyVisible();case Xa.Tools:return this.isToolsVisible();case Xa.Toolbar:return this.isToolbarVisible();case Xa.Undo:return this.isUndoVisible();case Xa.VisibilityLayers:return this.isVisibilityLayersVisible();default:return this.isUIVisible(e)}}isUIVisible(e){const{hideUI:t,ui:n}=this.getBase();return n[e]?!t&&n[e].enable&&n[e].status!==_o.Hide:(console.warn("Attempting to check visibility of a non-existent element: ${element}"),!1)}isUIEnabled(e){const{ui:t}=this.getBase();return t[e].enable}getVisibleContent(){const{ui:e}=this.getBase(),t=this.store.selectSnapshot(Ca.getChapterLabels),n=this.store.selectSnapshot(Or.getSelectedChapter),i=Object(D.get)(n,"info.description"),s=Object(D.get)(n,"info.displayName"),o=Object(D.get)(n,"legend",[]),r=Object(D.get)(n,"contentBlocks",[]).length,a=e.labelList.enable&&t.length>0,c=null!=i&&Object(D.trim)(i).length>0,l=null!=s&&Object(D.trim)(s).length>0,p=e.legend.enable&&o.length>0,d=this.store.selectSnapshot(xs.getQuizModeActive);return a||c||p||d||r?"full":l?"titleOnly":"none"}getViewLayout(e){const{width:t,height:n}=document.body.getBoundingClientRect(),i=t/n>=1?"landscape":"portrait",{breakpoint:o}=this.getBase(),r=384+(c.application===s.Viewer?0:56);switch(e){case Yo.ColumnOnly:return Ya.Column;case Yo.DrawerOnly:return Ya.Drawer;default:return"portrait"===i?Ya.Drawer:o>=$a.Large||n<=r&&t>=708?Ya.Column:Ya.Drawer}}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(d.g),i.Zb(to))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),ac=(()=>{class e{constructor(e){this.query=e}}return e.type="[Bookmarks] Load",e})(),cc=(()=>{class e{constructor(e){this.organizationId=e}}return e.type="[Bookmarks] Load Organization Bookmarks",e})(),lc=(()=>{class e{constructor(e,t){this.organizationId=e,this.collectionId=t}}return e.type="[Bookmarks] Load Collection Bookmarks",e})(),pc=(()=>{class e{constructor(e,t,n=!1){this.id=e,this.type=t,this.preview=n}}return e.type="[Bookmarks] Select Bookmark",e})(),dc=(()=>{class e{constructor(e){this.bookmark=e}}return e.type="[Bookmarks] Select Bookmark Success",e})(),uc=(()=>{class e{constructor(e){this.result=e}}return e.type="[Bookmarks] Load Success",e})(),gc=(()=>{class e{constructor(e){this.bookmarkId=e}}return e.type="[Bookmarks] Delete Bookmark",e})(),hc=(()=>{class e{constructor(e){this.bookmarkId=e}}return e.type="[Bookmarks] Bookmark Delete Success",e})(),bc=(()=>{class e{constructor(e,t){this.bookmarkId=e,this.message=t}}return e.type="[Bookmarks] Bookmark Delete Fail",e})(),mc=(()=>{class e{constructor(e){this.bookmarkIds=e}}return e.type="[Bookmarks] BulkDelete Bookmark",e})(),fc=(()=>{class e{constructor(e){this.bookmarkIds=e}}return e.type="[Bookmarks] Bookmark BulkDelete Success",e})(),yc=(()=>{class e{constructor(e,t){this.bookmarkIds=e,this.message=t}}return e.type="[Bookmarks] Bookmark BulkDelete Fail",e})(),xc=(()=>{class e{constructor(e,t,n=!0){this.bookmarkEntry=e,this.inplace=t,this.includeIndex=n}}return e.type="[Bookmarks] Save Bookmark",e})(),vc=(()=>{class e{constructor(e,t,n){this.bookmark=e,this.story=t,this.method=n}}return e.type="[Bookmarks] Bookmark Saved",e})(),Oc=(()=>{class e{constructor(e){this.bookmarkEntry=e}}return e.type="[Bookmarks] Bookmark Save Failed",e})(),wc=(()=>{class e{constructor(){}}return e.type="[Bookmarks] Cancel Save Bookmark",e})(),Cc=(()=>{class e{constructor(){}}return e.type="[Bookmarks] Reset",e})(),Sc=(()=>{class e{constructor(){}}return e.type="[Bookmarks] Clear Bookmarks",e})(),_c=(()=>{class e{constructor(e){this.sort=e}}return e.type="[Bookmarks] Sort",e})(),jc=(()=>{class e{constructor(e,t){this.id=e,this.checked=t}}return e.type="[Bookmarks] Check Bookmark",e})(),kc=(()=>{class e{constructor(e){this.ids=e}}return e.type="[Bookmarks] Set Checked Bookmarks",e})(),Pc=(()=>{class e{constructor(e,t,n,i,s,o,r,a,c){this.bookmarks=e,this.organizationId=t,this.collections=n,this.widgetURL=i,this.userLanguage=s,this.userApp=o,this.widgetOptions=r,this.offlineEnabled=a,this.productAccountId=c}}return e.type="[Bookmarks] Export Bookmarks",e})(),Mc=(()=>{class e{constructor(e){this.bookmarks=e}}return e.type="[Bookmarks] Export Bookmarks Success",e})(),Ic=(()=>{class e{constructor(e){this.bookmarks=e}}return e.type="[Bookmarks] Export Bookmarks Error",e})(),zc=(()=>{class e{constructor(e,t=[],n=new Map){this.bookmark=e,this.addCollections=t,this.removeCollections=n}}return e.type="[Bookmarks] Update Bookmark Collections",e})(),Tc=(()=>{class e{constructor(e,t,n){this.bookmark=e,this.addCollections=t,this.removeCollections=n}}return e.type="[Bookmarks] Update Bookmark Collections Success",e})(),Uc=(()=>{class e{constructor(e,t,n){this.bookmark=e,this.addCollections=t,this.removeCollections=n}}return e.type="[Bookmarks] Update Bookmark Collections Error",e})(),Dc=(()=>{class e{constructor(e,t){this.bookmark=e,this.collections=t}}return e.type="[Bookmarks] Add Bookmark Collections Success",e})(),Lc=(()=>{class e{constructor(e,t){this.bookmark=e,this.collections=t}}return e.type="[Bookmarks] Add Bookmark Collections Error",e})(),Ec=(()=>{class e{constructor(e,t){this.bookmark=e,this.collections=t}}return e.type="[Bookmarks] Remove Bookmark Collections Success",e})(),Fc=(()=>{class e{constructor(e,t){this.bookmark=e,this.collections=t}}return e.type="[Bookmarks] Remove Bookmark Collections Error",e})(),Ac=(()=>{class e{constructor(e,t,n,i=pe.lang,s,o){this.id=e,this.title=t,this.type=n,this.lang=i,this.groupAccess=s,this.collections=o}}return e.type="[Bookmarks] Copy Bookmark",e})(),Rc=(()=>{class e{constructor(e){this.newBookmark=e}}return e.type="[Bookmarks] Copy Bookmark Success",e})(),Vc=(()=>{class e{constructor(e,t){this.id=e,this.error=t}}return e.type="[Bookmarks] Copy Bookmark Failure",e})(),Nc=(()=>{class e{constructor(){}}return e.type="[Bookmarks] Cancel Copy Bookmark",e})(),Bc=(()=>{class e{constructor(e){this.title=e}}return e.type="[Bookmarks] Set Bookmark Text",e})(),Hc=(()=>{class e{constructor(e){this.viewMode=e}}return e.type="[Bookmarks] Set Bookmark View Mode",e})(),Qc=(()=>{class e{constructor(e){this.category=e}}return e.type="[Bookmarks] Set Selected Category",e})();const $c=br.ui;class qc{}const Wc=(e,t)=>void 0===e?t:e;function Kc(...e){return!!e.some(e=>!0===e)||!e.some(e=>!1===e)&&void 0}function Gc(e,t,n){return Object.values(jo).indexOf(n)>=0?n:!1===e?jo.None:null!=t?t?jo.Full:jo.Small:null}function Zc(e){return Object.values(ko).includes(e)?e:null}function Jc(e){const t=null!=e["ui-all"]?Xc(e["ui-all"]):new qc;return Yc({[Xa.Layout]:e["ui-layout"],[Xa.Loader]:Zc(e["ui-loader"]),[Xa.NodeInfo]:e["ui-anatomy-descriptions"],[Xa.Tools]:e["ui-tools"],[Xa.Toolbar]:e["ui-toolbar"],[Xa.Media]:Gc(null,Kc(e["ui-scrubber"],e["ui-scrubber.chapters"],e["ui-scrubber.tour"]),e["ui-media-controls"]),[Xa.Audio]:e["ui-audio"],[Xa.Fullscreen]:e["ui-fullscreen"],[Xa.Help]:e["ui-help"],[Xa.Camera]:e["ui-nav"],[Xa.Presenter]:e["ui-presenter"],[Xa.Menu]:e["ui-menu"],[Xa.Pagination]:e["ui-tour"],[Xa.Search]:Kc(e["ui-search"],e["ui-object-tree"]),[Xa.Column]:Kc(e["ui-info"],e["ui-panel"]),[Xa.Drawer]:Kc(e["ui-info"],e["ui-panel"]),[Xa.Description]:Kc(e["ui-info"]),[Xa.TitleOnly]:Kc(e["ui-info"]),[Xa.Logo]:Kc(e["ui-bd"],e["ui-logo"]),logoIsHyperLink:Kc(e["ui-bd.link"],e["ui-logo.islink"]),[Xa.Labels]:e["ui-labels"],[Xa.LabelList]:e["ui-label-list"],[Xa.InternetExplorerWarning]:e["ie-warning"],all:e["ui-all"],drawerExpandedInitially:e["ui-info-expand"],[Xa.AnatomyLabels]:Kc(e["ui-anatomy-labels"]),[Xa.Tutorial]:Kc(e["ui-tutorial"]),[Xa.Legend]:Kc(e["ui-legend"]),[Xa.Undo]:Kc(e["ui-undo"],e["ui-reset"]),[Xa.Whiteboard]:Kc(e["ui-whiteboard"]),[Xa.VisibilityLayers]:Kc(e["ui-visibility-layers"],e["ui-layers"]),[Xa.ContextActions]:Kc(e["ui-context-actions"]),[Xa.ToggleLabels]:void 0},t)}function Xc(e){return{[Xa.Loader]:e?Po:ko.None,[Xa.Column]:e,[Xa.Drawer]:e,[Xa.Tools]:e,[Xa.Toolbar]:e,[Xa.Fullscreen]:e,[Xa.Help]:e,[Xa.Camera]:e,[Xa.Search]:e,[Xa.Presenter]:e,[Xa.Menu]:e,[Xa.Audio]:e,[Xa.Pagination]:e,[Xa.NodeInfo]:e,[Xa.Labels]:null,[Xa.LabelList]:e,[Xa.Media]:null,[Xa.TitleOnly]:e,[Xa.Undo]:e,all:e,drawerExpandedInitially:null,logoIsHyperLink:null,[Xa.AnatomyLabels]:null,[Xa.Logo]:!0,[Xa.Tutorial]:null,[Xa.InternetExplorerWarning]:!0,[Xa.Legend]:!0,[Xa.Whiteboard]:e,[Xa.VisibilityLayers]:e,[Xa.ContextActions]:e,[Xa.ToggleLabels]:!0}}function Yc(e,t,n=!1){return null==t?e:Object(D.uniq)([...Object.keys(e),...Object.keys(t)]).reduce((i,s)=>(i[s]=null==e[s]||n&&null!=t[s]?t[s]:e[s],i),new qc)}function el(e,t){const n=JSON.parse(JSON.stringify(e));return n.loader.enable=Wc(t[Xa.Loader]!==ko.None,$c.loader.enable),null!=t[Xa.Loader]&&(n.loader.template=t[Xa.Loader]),n.nodeInfo.enable=Wc(t[Xa.NodeInfo],$c.nodeInfo.enable),n.pagination.enable=Wc(t[Xa.Pagination],$c.pagination.enable),n.drawer.isExpandedInitially=Wc(t.drawerExpandedInitially,$c.drawer.isExpandedInitially),n.tools.enable=Wc(t[Xa.Tools],$c.tools.enable),n.toolbar.enable=Wc(t[Xa.Toolbar],$c.toolbar.enable),n.media.enable=Wc(t[Xa.Media]!==jo.None,$c.media.enable),n.media.template=t[Xa.Media],n.fullscreen.enable=Wc(t[Xa.Fullscreen],$c.fullscreen.enable),n.help.enable=Wc(t[Xa.Help],$c.help.enable),n.description.enable=Wc(t[Xa.Description],$c.description.enable),n.titleOnly.enable=Wc(t[Xa.TitleOnly],$c.titleOnly.enable),n.camera.enable=Wc(t[Xa.Camera],$c.camera.enable),n.search.enable=Wc(t[Xa.Search],$c.search.enable),n.presenter.enable=Wc(t[Xa.Presenter],$c.presenter.enable),n.menu.enable=Wc(t[Xa.Menu],$c.menu.enable),n.logo.enable=Wc(t[Xa.Logo],$c.logo.enable),n.logo.isHyperLink=Wc(t.logoIsHyperLink,$c.logo.isHyperLink),n.internetExplorerWarning.enable=Wc(t.internetExplorerWarning,$c.internetExplorerWarning.enable),n.undo.enable=Wc(t[Xa.Undo],$c.undo.enable),n.labels.enable=Wc(t[Xa.Labels],$c.labels.enable),n.labelList.enable=Wc(t[Xa.LabelList],$c.labelList.enable),n.audio.enable=Wc(t[Xa.Audio],$c.audio.enable),n.reset.enable=Wc(t[Xa.Reset],$c.reset.enable),n.column.enable=Wc(t[Xa.Column],$c.column.enable),n.drawer.enable=Wc(t[Xa.Drawer],$c.drawer.enable),n.anatomyLabels.enable=Wc(t[Xa.AnatomyLabels],$c.anatomyLabels.enable),n.tutorial.enable=Wc(t[Xa.Tutorial],$c.tutorial.enable),n.whiteboard.enable=Wc(t[Xa.Whiteboard],$c.whiteboard.enable),n.visibilityLayers.enable=Wc(t[Xa.VisibilityLayers],$c.visibilityLayers.enable),n.contextActions.enable=Wc(t[Xa.ContextActions],$c.contextActions.enable),n.toggleLabels.enable=Wc(t[Xa.ToggleLabels],$c.toggleLabels.enable),n}var tl,nl=n("0IaG");!function(e){class t{constructor(e){this.theme=e}}t.type="[Layout] Set Theme",e.SetTheme=t;class n{constructor(e){this.sidenav=e}}n.type="[Layout] Set Sidenav",e.SetSidenav=n;class i{constructor(e){this.open=e}}i.type="[Layout] Toggle Sidenav",e.ToggleSidenav=i;class s{constructor(e){this.siteHeaderType=e}}s.type="[Layout] Set Header",e.SetHeader=s;class o{constructor(e){this.siteFooterType=e}}o.type="[Layout] Set Footer",e.SetFooter=o;class r{constructor(){}}r.type="[Layout] Reset",e.ResetLayout=r}(tl||(tl={}));class il{}var sl=function(e){return e.Light="theme-light",e.Dark="theme-dark",e}({}),ol=function(e){return e[e.Application=0]="Application",e[e.Search=1]="Search",e[e.View=2]="View",e[e.Hide=3]="Hide",e[e.Share=4]="Share",e}({}),rl=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},al=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const cl={theme:sl.Light,sidenav:{enabled:!0,open:!1},siteHeader:ol.Application,siteFooter:function(e){return e[e.Mobile=0]="Mobile",e[e.None=1]="None",e}({}).None};let ll=(()=>{let e=class{static getTheme(e){return e.theme}static getSidenav(e){return e.sidenav}static getSiteHeader(e){return e.siteHeader}static getSiteFooter(e){return e.siteFooter}setTheme({patchState:e},{theme:t}){e({theme:t})}setHeader(e,t){e.patchState({siteHeader:t.siteHeaderType})}setFooter(e,t){e.patchState({siteFooter:t.siteFooterType})}setSidenav(e,t){e.patchState({sidenav:Object.assign({},t.sidenav)})}toggleSidenav(e,t){const n=e.getState().sidenav;e.patchState({sidenav:Object.assign(Object.assign({},n),{open:t.open})})}resetLayout(e,t){e.setState(cl)}};return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac}),rl([Object(d.a)(tl.SetTheme),al("design:type",Function),al("design:paramtypes",[Object,tl.SetTheme]),al("design:returntype",void 0)],e.prototype,"setTheme",null),rl([Object(d.a)(tl.SetHeader),al("design:type",Function),al("design:paramtypes",[Object,tl.SetHeader]),al("design:returntype",void 0)],e.prototype,"setHeader",null),rl([Object(d.a)(tl.SetFooter),al("design:type",Function),al("design:paramtypes",[Object,tl.SetFooter]),al("design:returntype",void 0)],e.prototype,"setFooter",null),rl([Object(d.a)(tl.SetSidenav),al("design:type",Function),al("design:paramtypes",[Object,tl.SetSidenav]),al("design:returntype",void 0)],e.prototype,"setSidenav",null),rl([Object(d.a)(tl.ToggleSidenav),al("design:type",Function),al("design:paramtypes",[Object,tl.ToggleSidenav]),al("design:returntype",void 0)],e.prototype,"toggleSidenav",null),rl([Object(d.a)(tl.ResetLayout),al("design:type",Function),al("design:paramtypes",[Object,tl.ResetLayout]),al("design:returntype",void 0)],e.prototype,"resetLayout",null),rl([Object(d.e)(),al("design:type",Function),al("design:paramtypes",[il]),al("design:returntype",void 0)],e,"getTheme",null),rl([Object(d.e)(),al("design:type",Function),al("design:paramtypes",[il]),al("design:returntype",void 0)],e,"getSidenav",null),rl([Object(d.e)(),al("design:type",Function),al("design:paramtypes",[il]),al("design:returntype",void 0)],e,"getSiteHeader",null),rl([Object(d.e)(),al("design:type",Function),al("design:paramtypes",[il]),al("design:returntype",void 0)],e,"getSiteFooter",null),e=rl([Object(d.f)({name:"layout",defaults:cl})],e),e})();function pl(e,t=!0){return.01*(window.innerHeight-(t&&e!==ol.Hide?56:0))}let dl=(()=>{class e{constructor(){}get iconClass(){let e="fas fa-"+this.icon;return this.size&&(e+=" fa-"+this.size),e}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-icon"]],inputs:{icon:"icon",size:"size"},decls:1,vars:1,consts:[[3,"ngClass"]],template:function(e,t){1&e&&i.Qb(0,"i",0),2&e&&i.lc("ngClass",t.iconClass)},directives:[Z.i],styles:[""],encapsulation:2,changeDetection:0}),e})();function ul(e,t){1&e&&(i.Vb(0,"div"),i.jc(1),i.Ub())}const gl=["*"];let hl=(()=>{class e{constructor(e){this.changeDetector=e,this.hide=!1,this._isActive=!1}get isActive(){return this._isActive}set isActive(e){this._isActive=e,this.changeDetector.markForCheck()}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(i.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-tab"]],inputs:{label:"label",hide:"hide"},ngContentSelectors:gl,decls:1,vars:1,consts:[[4,"ngIf"]],template:function(e,t){1&e&&(i.kc(),i.Ic(0,ul,2,0,"div",0)),2&e&&i.lc("ngIf",t.isActive)},directives:[Z.l],styles:[""],changeDetection:0}),e})();var bl=n("2Vo4"),ml=n("Zy1z");const fl=["tabButton"],yl=function(e,t,n,i){return{"tabs__label--dark":e,"tabs__label--light":t,"tabs__label--dark-active":n,"tabs__label--light-active":i}};function xl(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",5,6),i.cc("click",(function(){i.xc(e);const n=t.$implicit;return i.gc().handleTabSelect(n)})),i.Kc(2),i.Ub()}if(2&e){const e=t.$implicit,n=i.gc();i.lc("ngClass",i.qc(4,yl,"dark"==n.tabTheme,"light"==n.tabTheme,"dark"==n.tabTheme&&n.isTabActive(e),"light"==n.tabTheme&&n.isTabActive(e))),i.Eb("aria-selected",n.isTabActive(e))("tabIndex",n.isTabActive(e)?0:-1),i.Db(2),i.Mc(" ",e.label," ")}}const vl=function(e,t){return{"tabs--small":e,"tabs--medium":t}},Ol=["*"];let wl=(()=>{class e{constructor(e){this.changeDetector=e,this.display="normal",this.tabTheme="dark",this.activeTabChange=new i.p,this._activeTab=new bl.a(0),this.tabSize="small",this.tabAlign="default",this.ngUnsubscribe=new k.a}get activeTab(){return this._activeTab.value}set activeTab(e){null!=e&&("string"==typeof e&&(e=e.toUpperCase()),this._activeTab.next(e))}get tabItems(){return this._tabItems}set tabItems(e){this._tabItems=e}ngOnInit(){}ngAfterContentInit(){this._tabs.changes.pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.mapTabs(),this.changeDetector.markForCheck()}),this.mapTabs(),this._activeTab.pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.showTab(e)}),this._activeTab.pipe(Object(ml.a)(),Object(I.a)(([e,t])=>e!==t),Object(M.a)(this.ngUnsubscribe)).subscribe(([e,t])=>{this.activeTabChange.next(t)})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}handleTabSelect(e){this._activeTab.next(e.index)}mapTabs(){this.tabItems=this._tabs.map((e,t)=>({index:t,label:e.label||"Item "+t,tab:e}))}showTab(e){this._tabs.forEach((t,n)=>{switch(typeof e){case"number":t.isActive=e===n;break;case"string":t.isActive=e.toString().toUpperCase()===t.label.toUpperCase()}}),this.changeDetector.markForCheck()}isTabActive(e){return("string"==typeof this._activeTab.value?e.label.toUpperCase():e.index)===this._activeTab.value}shiftTab(e){const t=(this.tabItems.find(e=>this.isTabActive(e)).index+e+this.tabItems.length)%this.tabItems.length;this._activeTab.next(t),this._buttonRefs.toArray()[t].nativeElement.focus()}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(i.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-tabs"]],contentQueries:function(e,t,n){if(1&e&&i.Ib(n,hl,!1),2&e){let e;i.sc(e=i.dc())&&(t._tabs=e)}},viewQuery:function(e,t){if(1&e&&i.Pc(fl,!0),2&e){let e;i.sc(e=i.dc())&&(t._buttonRefs=e)}},inputs:{display:"display",tabTheme:"tabTheme",activeTab:"activeTab",tabSize:"tabSize",tabAlign:"tabAlign"},outputs:{activeTabChange:"activeTabChange"},ngContentSelectors:Ol,decls:6,vars:7,consts:[[1,"tabs",3,"ngClass"],["role","tablist",1,"tabs__labels",3,"keyup.arrowright","keyup.arrowleft"],["tabElements",""],["class","tabs__label","role","tab","type","button","data-test","tabButton",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"tabs__content"],["role","tab","type","button","data-test","tabButton",1,"tabs__label",3,"ngClass","click"],["tabButton",""]],template:function(e,t){1&e&&(i.kc(),i.Vb(0,"div",0),i.Vb(1,"div",1,2),i.cc("keyup.arrowright",(function(){return t.shiftTab(1)}))("keyup.arrowleft",(function(){return t.shiftTab(-1)})),i.Ic(3,xl,3,9,"button",3),i.Ub(),i.Vb(4,"div",4),i.jc(5),i.Ub(),i.Ub()),2&e&&(i.lc("ngClass",i.oc(4,vl,"small"==t.tabSize,"medium"==t.tabSize)),i.Db(1),i.Hb("tabs__labels--center","center"===t.tabAlign),i.Db(2),i.lc("ngForOf",t.tabItems))},directives:[Z.i,Z.k],styles:['.text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.tabs__labels[_ngcontent-%COMP%]{margin-bottom:8px}.tabs__labels--center[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.tabs__label[_ngcontent-%COMP%]{padding:2px 4px 4px;margin-right:8px;font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase;font-weight:500;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:relative;background:none;border:none}.tabs__label[_ngcontent-%COMP%]:after{content:"";display:block;border-bottom:3px solid;margin-top:4px;width:0;transition:.25s ease;position:absolute;bottom:0;left:0}.tabs__label[_ngcontent-%COMP%]:hover{cursor:pointer}.tabs__label--dark[_ngcontent-%COMP%]{color:#96a8c0}.tabs__label--dark[_ngcontent-%COMP%]:after{border-color:#2d72dc}.tabs__label--dark-active[_ngcontent-%COMP%], .tabs__label--dark[_ngcontent-%COMP%]:hover{color:#fff}.tabs__label--dark-active[_ngcontent-%COMP%]:after{width:100%}.tabs__label--light[_ngcontent-%COMP%]{color:#374a68}.tabs__label--light[_ngcontent-%COMP%]:after{border-color:#2d72dc}.tabs__label--light-active[_ngcontent-%COMP%], .tabs__label--light[_ngcontent-%COMP%]:hover{color:#283853}.tabs__label--light-active[_ngcontent-%COMP%]:after{width:100%}.tabs--medium[_ngcontent-%COMP%]   .tabs__label[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}'],changeDetection:0}),e})();function Cl(e,t){if(1&e&&(i.Vb(0,"label",11),i.Kc(1),i.Ub()),2&e){const e=i.gc().$implicit;i.Db(1),i.Lc(e.pronunciation)}}function Sl(e,t){if(1&e&&(i.Vb(0,"span"),i.Vb(1,"kbd",9),i.Kc(2),i.Ub(),i.Ic(3,Cl,2,1,"label",10),i.Ub()),2&e){const e=t.$implicit;i.Db(1),i.Eb("aria-hidden",e.hasOwnProperty("pronunciation")),i.Db(1),i.Mc(" ",e.shortcut," "),i.Db(1),i.lc("ngIf",e.hasOwnProperty("pronunciation"))}}function _l(e,t){if(1&e&&(i.Vb(0,"tr"),i.Vb(1,"th",7),i.Kc(2),i.Ub(),i.Vb(3,"td",8),i.Ic(4,Sl,4,3,"span",6),i.Ub(),i.Ub()),2&e){const e=t.$implicit;i.Db(2),i.Lc(e.label),i.Db(2),i.lc("ngForOf",e.keys)}}function jl(e,t){if(1&e&&(i.Vb(0,"div",2),i.Vb(1,"h2",3),i.Kc(2),i.Ub(),i.Vb(3,"table",4),i.Vb(4,"tr"),i.Qb(5,"th"),i.Vb(6,"th",5),i.Kc(7,"Keyboard Shortcut"),i.Ub(),i.Ub(),i.Ic(8,_l,5,2,"tr",6),i.Ub(),i.Ub()),2&e){const e=t.$implicit;i.Db(2),i.Lc(e.label),i.Db(6),i.lc("ngForOf",e.shortcuts)}}var kl=function(e){return e.Left="\u2190",e.Right="\u2192",e.Up="\u2191",e.Down="\u2193",e.Command="\u2318",e}({});let Pl=(()=>{class e{constructor(){this.shortcutGroups=[{label:"Navigation",shortcuts:[{keys:[{shortcut:",",pronunciation:"Comma."},{shortcut:"Pg-Up",pronunciation:"page-up"}],label:"Previous chapter"},{keys:[{shortcut:".",pronunciation:"Period."},{shortcut:"Pg-Down",pronunciation:"Page-down."}],label:"Next chapter"},{keys:[{shortcut:"/",pronunciation:"Forward slash."}],label:"Open Search"},{keys:[{shortcut:"Ctrl + Enter"}],label:"Enter Fullscreen"},{keys:[{shortcut:"Ctrl/Cmd + ,",pronunciation:"Control or command plus comma."}],label:"Toggle Description"},{keys:[{shortcut:"Shift + /"}],label:"Open Help"}]},{label:"Tools",shortcuts:[{keys:[{shortcut:"1"}],label:'Use "Select" tool'},{keys:[{shortcut:"2"}],label:'Use "Hide" tool'},{keys:[{shortcut:"3"}],label:'Use "Fade" tool'},{keys:[{shortcut:"del",pronunciation:"Delete."},{shortcut:"backspace"}],label:"Hide selected structure"},{keys:[{shortcut:"Shift + R"}],label:"Reset chapter"},{keys:[{shortcut:"Ctrl/Cmd + Z",pronunciation:"Control or command plus z."}],label:"Undo"},{keys:[{shortcut:"Ctrl/Cmd + Shift + Z",pronunciation:"Control or command plus shift pluz z."},{shortcut:"Ctrl/Cmd + Y",pronunciation:"Control or command plus y."}],label:"Redo"}]},{label:"Pan",shortcuts:[{keys:[{shortcut:"W"}],label:"Pan up"},{keys:[{shortcut:"S"}],label:"Pan down"},{keys:[{shortcut:"A"}],label:"Pan left"},{keys:[{shortcut:"D"}],label:"Pan right"},{keys:[{shortcut:"Shift + W"}],label:"Slow pan up"},{keys:[{shortcut:"Shift + S"}],label:"Slow pan down"},{keys:[{shortcut:"Shift + A"}],label:"Slow pan left"},{keys:[{shortcut:"Shift + D"}],label:"Slow pan right"}]},{label:"Rotate",shortcuts:[{keys:[{shortcut:kl.Up}],label:"Rotate up"},{keys:[{shortcut:kl.Down}],label:"Rotate down"},{keys:[{shortcut:kl.Left}],label:"Rotate left"},{keys:[{shortcut:kl.Right}],label:"Rotate right"},{keys:[{shortcut:"Shift + "+kl.Up}],label:"Slow rotate up"},{keys:[{shortcut:"Shift + "+kl.Down}],label:"Slow rotate down"},{keys:[{shortcut:"Shift + "+kl.Left}],label:"Slow rotate left"},{keys:[{shortcut:"Shift + "+kl.Right}],label:"Slow rotate right"}]},{label:"Zoom",shortcuts:[{keys:[{shortcut:"E"},{shortcut:"=",pronunciation:"Equals."}],label:"Zoom in"},{keys:[{shortcut:"C"},{shortcut:"-",pronunciation:"Hyphen."}],label:"Zoom out"},{keys:[{shortcut:"Shift + E"},{shortcut:"Shift + =",pronunciation:"Shift plus equals."}],label:"Slow zoom in"},{keys:[{shortcut:"Shift + C"},{shortcut:"Shift + -",pronunciation:"Shift plus hyphen."}],label:"Slow zoom out"}]}]}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-shortcuts"]],decls:2,vars:1,consts:[[1,"view-shortcuts"],["class","view-shortcuts__group",4,"ngFor","ngForOf"],[1,"view-shortcuts__group"],[1,"view-shortcuts__label","text-bold"],[1,"view-shortcuts__table"],["scope","col",1,"view-shortcuts__cell-header"],[4,"ngFor","ngForOf"],["scope","row",1,"view-shortcuts__cell-header"],[1,"view-shortcuts__cell","view-shortcuts__cell--key"],[1,"view-shortcuts__key"],["class","visually-hidden",4,"ngIf"],[1,"visually-hidden"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Ic(1,jl,9,2,"div",1),i.Ub()),2&e&&(i.Db(1),i.lc("ngForOf",t.shortcutGroups))},directives:[Z.k,Z.l],styles:[".view-shortcuts[_ngcontent-%COMP%]{display:flex;flex-direction:column}.view-shortcuts__group[_ngcontent-%COMP%]{width:100%;padding-bottom:32px;margin-top:32px}.view-shortcuts__label[_ngcontent-%COMP%]{padding:8px 0 12px}.view-shortcuts__table[_ngcontent-%COMP%]{width:100%}.view-shortcuts__cell[_ngcontent-%COMP%], .view-shortcuts__cell-header[_ngcontent-%COMP%]{padding:8px;border-bottom:1px solid hsla(0,0%,100%,.3);width:50%}.view-shortcuts__cell-header[_ngcontent-%COMP%]{text-align:left}.view-shortcuts__key[_ngcontent-%COMP%]{border-radius:4px;display:inline-flex;padding:4px;margin-right:4px;background:#000;color:#fff;justify-content:center;align-items:center;font-family:monospace;font-size:16px}"],changeDetection:0}),e})();var Ml=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const Il=["viewHelp"];let zl=(()=>{class e{constructor(e,t,n,i){this.dialogRef=e,this.renderer=t,this.store=n,this.data=i,this.helpTypeEnum=z,this.activeTab=z.Basics,this.ngUnsubscribe=new k.a,this.activeTab=i.tab}ngOnInit(){this.initWindowSizeObserver()}ngAfterViewInit(){this.updateViewHeight()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initWindowSizeObserver(){this.renderer.listen("window","resize",()=>{this.updateViewHeight()})}updateViewHeight(){const e=pl(this.store.selectSnapshot(ll.getSiteHeader),!1);this.viewHelp.nativeElement.style.setProperty("--vh",e+"px")}handleCloseClick(){this.dialogRef.close()}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(nl.g),i.Pb(i.H),i.Pb(d.g),i.Pb(nl.a))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-help-dialog"]],viewQuery:function(e,t){if(1&e&&i.Ec(Il,!0),2&e){let e;i.sc(e=i.dc())&&(t.viewHelp=e.first)}},decls:126,vars:1,consts:[["role","dialog","aria-labelledby","helpTitle",1,"view-help"],["viewHelp",""],["id","helpTitle",1,"view-help__header"],["type","button",1,"view-help__close",3,"click"],["icon","times","aria-hidden","true"],[1,"visually-hidden"],[1,"view-help__inner"],["tabSize","medium","tabAlign","center","cdkFocusInitial","",3,"activeTab"],["label","Navigation Basics","id","helpBasics","aria-controls","basicsPanel"],["role","tabpanel","aria-labelledby","helpBasics","tabindex","0","id","basicsPanel"],[1,"view-help__group"],[1,"view-help__item"],[1,"view-help__image"],["src","assets/images/widget/help-rotate.svg","alt","A heart with an arrow wrapped around it, which symbolises objects being rotated withing the 3D viewport."],[1,"view-help__label"],["src","assets/images/widget/help-pan.svg","alt","A heart with left and right arrows pointing away from it, which symbolises objects being panned within the 3D viewport"],["src","assets/images/widget/help-zoom.svg","alt","A heart with a magnifying glass over it, which symbolises zooming into and out from an object within the 3D viewport."],["src","assets/images/widget/help-learn.svg","alt","A heart with a smaller region colored in blue and a popup window specifying that the Right Ventricle is selected."],["label","All Controls","id","helpAll","aria-controls","allPanel"],["role","tabpanel","aria-labelledby","helpAll","tabindex","0","id","allPanel"],[1,"view-help__section-header"],["src","assets/images/widget/help-mouse-hold-left.svg","alt","A mouse with the left button being held in."],["src","assets/images/widget/help-mouse-hold-right.svg","alt","A mouse with the right button being held in."],["src","assets/images/widget/help-mouse-single-click-left.svg","alt","A mouse with the left button being clicked."],["src","assets/images/widget/help-mouse-double-click-left.svg","alt","A mouse with the left button being double clicked."],["src","assets/images/widget/help-mouse-long-press-left.svg","alt","A mouse with the left button being held in for a long duration."],["src","assets/images/widget/help-keyboard-rotate.svg","alt","The arrow keys."],["src","assets/images/widget/help-keyboard-pan.svg","alt","The W, A, S and D keys."],["src","assets/images/widget/help-keyboard-zoom.svg","alt","The plus and minus keys grouped together or the E and C keys grouped together."],["src","assets/images/widget/help-keyboard-slow-motion.svg","alt","The shift key."],["src","assets/images/widget/help-trackpad-single-tap.svg","alt","A finger clicking the trackpad once."],["src","assets/images/widget/help-trackpad-double-tap.svg","alt","A finger clicking the trackpad twice."],["src","assets/images/widget/help-trackpad-long-press.svg","alt","A finger pressing for a long duration on the trackpad."],["src","assets/images/widget/help-trackpad-scroll.svg","alt","Two fingers pressing the trackpad while moving vertically."],["icon","plus","aria-hidden","true",1,"view-help__icon"],["icon","minus","aria-hidden","true",1,"view-help__icon"],["icon","location","aria-hidden","true",1,"view-help__icon"],["icon","arrows","aria-hidden","true",1,"view-help__icon"],["label","Keyboard Shortcuts","id","helpShortcuts","aria-controls","shortcutsPanel"],["role","tabpanel","aria-labelledby","helpShortcuts","tabindex","0","id","shortcutsPanel"]],template:function(e,t){1&e&&(i.Vb(0,"div",0,1),i.Vb(2,"h2",2),i.Kc(3,"Help"),i.Ub(),i.Vb(4,"button",3),i.cc("click",(function(){return t.handleCloseClick()})),i.Qb(5,"app-icon",4),i.Vb(6,"span",5),i.Kc(7,"Close help modal"),i.Ub(),i.Ub(),i.Vb(8,"div",6),i.Vb(9,"app-tabs",7),i.Vb(10,"app-tab",8),i.Vb(11,"div",9),i.Vb(12,"ul",10),i.Vb(13,"li",11),i.Vb(14,"div",12),i.Qb(15,"img",13),i.Ub(),i.Vb(16,"div",14),i.Kc(17,"Rotate"),i.Ub(),i.Kc(18," Click and drag or use one finger to change the viewing angle. "),i.Ub(),i.Vb(19,"li",11),i.Vb(20,"div",12),i.Qb(21,"img",15),i.Ub(),i.Vb(22,"div",14),i.Kc(23,"Pan"),i.Ub(),i.Kc(24," Hold the shift key and drag or use two fingers to move the model's position. "),i.Ub(),i.Vb(25,"li",11),i.Vb(26,"div",12),i.Qb(27,"img",16),i.Ub(),i.Vb(28,"div",14),i.Kc(29,"Zoom"),i.Ub(),i.Kc(30," Scroll up and down or pinch with two fingers to zoom in or out. "),i.Ub(),i.Vb(31,"li",11),i.Vb(32,"div",12),i.Qb(33,"img",17),i.Ub(),i.Vb(34,"div",14),i.Kc(35,"Explore the Anatomy"),i.Ub(),i.Kc(36," Click or tap an anatomic structure or label to learn more. "),i.Ub(),i.Ub(),i.Ub(),i.Ub(),i.Vb(37,"app-tab",18),i.Vb(38,"div",19),i.Vb(39,"h3",20),i.Kc(40,"Mouse"),i.Ub(),i.Vb(41,"ul",10),i.Vb(42,"li",11),i.Vb(43,"div",12),i.Qb(44,"img",21),i.Ub(),i.Kc(45," Hold left button to rotate "),i.Ub(),i.Vb(46,"li",11),i.Vb(47,"div",12),i.Qb(48,"img",22),i.Ub(),i.Kc(49," Hold right button to pan "),i.Ub(),i.Vb(50,"li",11),i.Vb(51,"div",12),i.Qb(52,"img",23),i.Ub(),i.Kc(53," Single-click left button to select a structure "),i.Ub(),i.Vb(54,"li",11),i.Vb(55,"div",12),i.Qb(56,"img",24),i.Ub(),i.Kc(57," Double-click left button to auto-focus on a structure "),i.Ub(),i.Vb(58,"li",11),i.Vb(59,"div",12),i.Qb(60,"img",25),i.Ub(),i.Kc(61," Long-click to fly to a structure "),i.Ub(),i.Ub(),i.Vb(62,"h3",20),i.Kc(63,"Keyboard"),i.Ub(),i.Vb(64,"ul",10),i.Vb(65,"li",11),i.Vb(66,"div",12),i.Qb(67,"img",26),i.Ub(),i.Kc(68," Rotate with arrows "),i.Ub(),i.Vb(69,"li",11),i.Vb(70,"div",12),i.Qb(71,"img",27),i.Ub(),i.Kc(72," Pan up (W), left (A), down (S), right(D) "),i.Ub(),i.Vb(73,"li",11),i.Vb(74,"div",12),i.Qb(75,"img",28),i.Ub(),i.Kc(76," Zoom out (-, C) and zoom in (+, E) "),i.Ub(),i.Vb(77,"li",11),i.Vb(78,"div",12),i.Qb(79,"img",29),i.Ub(),i.Kc(80," Hold with any previous key to slow down motion "),i.Ub(),i.Ub(),i.Vb(81,"h3",20),i.Kc(82,"Trackpad"),i.Ub(),i.Vb(83,"ul",10),i.Vb(84,"li",11),i.Vb(85,"div",12),i.Qb(86,"img",30),i.Ub(),i.Kc(87," Single-tap to auto-focus a structure "),i.Ub(),i.Vb(88,"li",11),i.Vb(89,"div",12),i.Qb(90,"img",31),i.Ub(),i.Kc(91," Double-tap to select a structure "),i.Ub(),i.Vb(92,"li",11),i.Vb(93,"div",12),i.Qb(94,"img",32),i.Ub(),i.Kc(95," Long-press to fly to a structure "),i.Ub(),i.Vb(96,"li",11),i.Vb(97,"div",12),i.Qb(98,"img",33),i.Ub(),i.Kc(99," Scroll up and down to zoom "),i.Ub(),i.Ub(),i.Vb(100,"h3",20),i.Kc(101,"In-App"),i.Ub(),i.Vb(102,"ul",10),i.Vb(103,"li",11),i.Qb(104,"app-icon",34),i.Vb(105,"span",5),i.Kc(106," The plus symbol, which represents zooming in in the camera control menu. "),i.Ub(),i.Kc(107," Zoom in "),i.Ub(),i.Vb(108,"li",11),i.Qb(109,"app-icon",35),i.Vb(110,"span",5),i.Kc(111," The minus symbol, which represents zooming out in the camera control menu. "),i.Ub(),i.Kc(112," Zoom out "),i.Ub(),i.Vb(113,"li",11),i.Qb(114,"app-icon",36),i.Vb(115,"span",5),i.Kc(116," The map pin symbol, which resets the camera in the camera control menu. "),i.Ub(),i.Kc(117," Recenter 3D Model "),i.Ub(),i.Vb(118,"li",11),i.Qb(119,"app-icon",37),i.Vb(120,"span",5),i.Kc(121," Arrows pointing in four directions, which represents panning in the camera control menu. "),i.Ub(),i.Kc(122," Pan "),i.Ub(),i.Ub(),i.Ub(),i.Ub(),i.Vb(123,"app-tab",38),i.Vb(124,"div",39),i.Qb(125,"app-view-shortcuts"),i.Ub(),i.Ub(),i.Ub(),i.Ub(),i.Ub()),2&e&&(i.Db(9),i.lc("activeTab",t.activeTab))},directives:[dl,wl,hl,Pl],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3535}.text-info{color:#2d72dc}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.view-help{background-color:rgba(16,24,35,.9);color:#fff;display:flex;align-items:center;flex-direction:column;position:fixed;top:0;left:0;right:0;z-index:10000;height:100vh;height:calc(var(--vh, 1vh) * 100);max-height:100vh;overflow:auto}.view-help__inner{width:100%;max-width:1140px;height:99vh;height:calc(var(--vh, 1vh) * 99);padding:32px;position:relative}.view-help__close{color:#fff;width:40px;height:40px;display:flex;align-items:center;justify-content:center;position:fixed;right:8px;top:8px;z-index:10;border:none;background:none}.view-help__header{font-size:14px;letter-spacing:.84px}.view-help__header,.view-help__section-header{line-height:1.25em;text-transform:uppercase;font-weight:600;padding-bottom:12px;margin-top:32px}.view-help__section-header{font-size:12px;letter-spacing:.72px;border-bottom:1px solid hsla(0,0%,100%,.3)}.view-help__label{font-size:14px;letter-spacing:.35px;line-height:1.4em;font-weight:600;margin-bottom:12px}.view-help__group{display:flex;justify-content:space-around;flex-wrap:wrap}.view-help__item{font-size:12px;letter-spacing:.3px;line-height:1.4em;display:flex;flex-flow:column;text-align:center;padding:20px;flex:0 1 180px}.view-help__image{justify-content:center;margin-bottom:16px;width:160px;height:100px}.view-help__icon{font-size:24px;margin-bottom:16px}"],encapsulation:2,changeDetection:0}),function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);o>3&&r&&Object.defineProperty(t,n,r)}([Object(d.d)(mr.getCanTouch),Ml("design:type",P.a)],e.prototype,"canTouch$",void 0),e})();var Tl=n("u47x"),Ul=function(e,t,n,i){return new(n||(n=Promise))((function(s,o){function r(e){try{c(i.next(e))}catch(t){o(t)}}function a(e){try{c(i.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,a)}c((i=i.apply(e,t||[])).next())}))};let Dl=(()=>{class e{constructor(e,t,n,i,s,o,r,a){this.dialog=e,this.store=t,this.location=n,this.transitionService=i,this.engineService=s,this.layoutService=o,this.pendoService=r,this.liveAnnouncer=a}initStory(e,t,n){const i="preview"===e;this.store.dispatch(new pc(e,t,i)),this.store.dispatch(new ve(e,t,!0));const s=this.store.select(Er.getReady),o=this.store.select(za.getIncomingStoryInfo);Object(Ta.b)([s,o]).pipe(Object(I.a)(([e,t])=>e&&!!t.id),Object(Ua.a)(1)).subscribe(()=>{this.store.dispatch(new kn),this.store.dispatch(new he(e,t,n,i))})}nextChapter(e){const t=this.store.selectSnapshot(Or.getSelectedChapterIndex),n=this.store.selectSnapshot(Or.getStoryChapters);this.pendoService.trackOncePerSession(K.DiscoveredChapterNav,{source:e,breakpoint:this.store.selectSnapshot(Ja.getBreakpointLabel)});const i=n[t+1];i&&this.selectChapter(i)}previousChapter(e){const t=this.store.selectSnapshot(Or.getSelectedChapterIndex),n=this.store.selectSnapshot(Or.getStoryChapters);this.pendoService.trackOncePerSession(K.DiscoveredChapterNav,{source:e,breakpoint:this.store.selectSnapshot(Ja.getBreakpointLabel)});const i=n[t-1];i&&this.selectChapter(i)}selectChapter(e){return Ul(this,void 0,void 0,(function*(){if(!this.store.selectSnapshot(xs.getQuizModeActive)){const t=this.store.selectSnapshot(Or.getSelectedChapterId),n=e.id,i=this.store.selectSnapshot(Or.getStoryChapters),s=this.transitionService.searchChapterTransitions(t,n,i);this.pendoService.trackOncePerSession(K.DiscoveredChapterNav,{source:"Chapter List",breakpoint:this.store.selectSnapshot(Ja.getBreakpointLabel)}),s&&(yield this.chapterTransition(s)),this.store.dispatch([new we(e.id),new kn(e)])}}))}chapterTransition(e){return new Promise(t=>{e.camera&&this.store.dispatch(new Zt(e.camera,!0,e.duration)),e.fadeColor&&this.store.dispatch(new Be(e.fadeColor,e.duration)),setTimeout(()=>{t(!0)},1e3*e.duration)})}hideSelectedStructures(){const e=this.store.selectSnapshot(Bi.getCheckedNodeIds);this.store.dispatch(new Ii.UpdateNodesShown(!1,e))}selectTool(e){this.store.selectSnapshot(xs.getQuizModeActive)&&e===kr.Select&&(e=kr.Quiz),this.store.dispatch(new ot(e))}toggleColumn(e){const t=this.store.selectSnapshot(mr.getUI);t.column.status=(e=null==e?!(t.column.status===_o.Show):e)?_o.Show:_o.Collapse,this.store.dispatch(new j.SetUI(t))}togglePresentation(){this.store.selectSnapshot(mr.getPresentationActive)?this.stopPresentation():this.startPresentation()}startPresentation(){this.store.dispatch(new j.TogglePresentation(!0))}stopPresentation(){this.store.dispatch(new j.TogglePresentation(!1))}toggleHelp(e=z.Basics){0===this.dialog.openDialogs.length&&this.dialog.open(zl,{maxWidth:"100vw",maxHeight:"100vh",height:"100%",width:"100%",data:{tab:e}})}toggleInteract(e){this.store.dispatch(new j.ToggleWindow(Eo.Interact,e))}toggleOnDemand(e){this.store.dispatch(new j.SetOnDemand(e)),this.store.dispatch(new j.ToggleWindow(Eo.OnDemand,e))}toggleTutorial(e){this.store.dispatch(new j.ToggleWindow(Eo.Tutorial,e)),e&&this.store.dispatch(new j.StartTutorial(!0))}toggleWhiteboard(e){this.store.dispatch(new j.ToggleWindow(Eo.Whiteboard,e)),e&&(this.store.dispatch(new at(!1)),this.store.dispatch(new j.SetWhiteboardEnabled(!0)))}showLabels(e){const t=this.store.selectSnapshot(mr.getUI);e=Object(D.isNil)(e)?!t.labels.shown:e,t.labels.shown=e,this.store.dispatch(new j.SetUI(t))}toggleLabels(e){this.store.dispatch(new st(e))}toggleSearch(e=pr.List,t){this.store.selectSnapshot(Ja.getBreakpoint);const n=this.store.selectSnapshot(mr.getUI);n.search.status=(t=null==t?!(n.search.status===_o.Show):t)?_o.Show:_o.Hide,t&&(n.nodeInfo.status=_o.Hide),this.store.dispatch(new j.SetSearchDisplayMode(e)),this.store.dispatch(new j.SetUI(n))}toggleNodeInfo(e){this.toggleInfoLayout("nodeInfo",e)}toggleLabelInfo(e){this.toggleInfoLayout("labelInfo",e)}toggleInfoLayout(e,t){const n=this.store.selectSnapshot(mr.getUI);(t=null==t?n[e].status===_o.Hide:t)?(n[e].status=_o.Show,["nodeInfo","labelInfo"].filter(t=>t!==e).forEach(e=>n[e].status=_o.Hide)):n[e].status=_o.Hide,this.store.dispatch(new j.SetUI(n))}delegateNodeClick(e,t){if(this.clearSelectedLabel(),e||t.srcEvent.shiftKey)if(t.srcEvent.shiftKey||this.store.selectSnapshot(mr.getMultiPickModeEnabled))this.checkNode(e);else switch(this.store.selectSnapshot(Er.getActiveTool)){case kr.Hide:this.hideNode(e);break;case kr.Select:this.selectNode(e);break;case kr.Isolate:this.isolateNode(e);break;case kr.Fade:this.fadeNode(e)}else this.clearSelectedNodes()}clearSelectedLabel(){this.store.dispatch(new mo)}clearSelectedNodes(){this.store.dispatch(new Ii.UpdateNodeSelected),this.store.dispatch(new Ii.UpdateNodesChecked(!1))}clearFadedNodes(){const e=this.store.selectSnapshot(Or.getSelectedChapterId);this.store.dispatch(new zi.UndoAll(e))}checkNode(e,t){void 0!==e&&(null==t&&(t=this.store.selectSnapshot(Bi.getNodes)[e.id].checked),this.store.dispatch(new Ii.UpdateNodesChecked(!t,[e.id])),this.store.dispatch(new Ii.UpdateNodeSelected(e.id)))}fadeNode(e){this.store.dispatch(new Ii.UpdateNodesPaint($i,[e.id]))}isolateNode(e){this.store.dispatch(new Ii.UpdateNodesShown(!1)),this.store.dispatch(new Ii.UpdateNodesShown(!0,[e.id]))}selectNode(e){const t=!this.store.selectSnapshot(Bi.getNodes)[e.id].checked;this.store.dispatch(new Ii.UpdateNodesChecked(!1)),t&&(this.store.dispatch(new Ii.UpdateNodesChecked(!0,[e.id])),this.store.dispatch(new Ii.UpdateNodeSelected(e.id))),this.store.dispatch(new wt(e));const n=this.store.selectSnapshot(mr.getNodeInfoFallback),i=this.store.selectSnapshot(mr.getViewLanguage);this.store.dispatch(new Pt(e,n,i))}hideNode(e){this.store.dispatch(new Ii.UpdateNodesShown(!1,[e.id])),this.store.dispatch(new Ii.UpdateNodesChecked(!1))}selectLabel(e,t=!1){const{objectId:n,states:i}=e;this.store.dispatch(new mo(e)),t&&n&&0===i.length&&this.store.dispatch(new Je(n,!0))}initChapter(e){return Ul(this,void 0,void 0,(function*(){const t=this.engineService.createViewGraph({},!1);this.store.dispatch(new Qe(t)),this.store.selectSnapshot(jr.getChapterCameraEnabled)&&this.store.dispatch(new Zt(e.camera.location,e.camera.action===Qa.FlyTo,void 0,e.camera.rotationCenter))}))}playChapterFromStart(){this.store.dispatch(new dt)}resetCamera(){const e=this.store.selectSnapshot(Or.getSelectedChapter);e&&this.store.dispatch(new Zt(e.camera.location))}resetChapter(){this.resetCamera();const e=this.store.selectSnapshot(Or.getSelectedChapterId);this.store.dispatch(new zi.UndoAll(e)).subscribe(()=>{this.liveAnnouncer.announce("reset complete")}),this.store.dispatch(new Ii.UpdateNodesChecked(!1)),this.store.dispatch(new po)}resetLayout(){const{ui:e}=this.store.selectSnapshot(mr);this.layoutService.isUIHidden()?Object.keys(e).forEach(t=>{e[t].status=_o.Hide}):(Object.keys(e).forEach(t=>{e[t].status=_o.Show}),e.search.status=_o.Hide,e.tools.status=_o.Hide,e.nodeInfo.status=_o.Hide,e.labelInfo.status=_o.Hide,e.media.status=_o.Hide,e.visibilityLayers.status=_o.Hide),this.store.dispatch(new j.SetUI(e))}undo(){this.store.dispatch(new zi.Undo(this.store.selectSnapshot(Or.getSelectedChapterId))).subscribe(()=>{this.liveAnnouncer.announce("undo complete")})}redo(){this.store.dispatch(new zi.Redo(this.store.selectSnapshot(Or.getSelectedChapterId))).subscribe(()=>{this.liveAnnouncer.announce("redo complete")})}toggleAnimation(){const e=!this.store.selectSnapshot(Er.getAnimationPlaying);this.store.dispatch(new at(e))}toggleAudio(){const e=this.store.selectSnapshot(Er.getPlayAudio);this.store.dispatch(new pt(!e))}toggleToolbar(e){const t=this.store.selectSnapshot(mr.getUI);t.media.status=_o.Hide,t.tools.status=_o.Hide,t.toolbar.status=_o.Hide,t.visibilityLayers.status=_o.Hide,"none"!==e?t[e].status=_o.Show:this.selectTool(kr.Select),this.store.dispatch(new j.SetUI(t))}closeToolbar(){const e=this.store.selectSnapshot(mr.getUI);e.media.status=_o.Hide,e.tools.status=_o.Hide,e.visibilityLayers.status=_o.Hide,this.selectTool(kr.Select),this.store.dispatch(new j.SetUI(e))}normalizeQueryParams(e){const t=Object.assign({},e);return{id:Ea(t),type:Fa(t),lang:e.lang}}sanitizeRouteId(e){return e=e.replace(/\.json$/,""),this.location.replaceState("view","?id="+e),e}openInNewTab(){const e=window.document.location.href;window.open(e)}getComputedTransform(e){const t=getComputedStyle(e).transform.replace("matrix3d","").replace("matrix","").replace("(","").replace(")","").split(",").map(e=>e.trim()).map(e=>parseInt(e,10)),n=16===t.length?t[12]:t[4],i=16===t.length?t[13]:t[5];return Number.isNaN(n)||Number.isNaN(i)?null:{x:n,y:i}}inferDrawerMode(e){let t=Da.Content;return e.nodeInfo.status===_o.Show?t=Da.NodeInfo:e.labelInfo.status===_o.Show&&(t=Da.LabelInfo),t}setUI(e){var t;let n=null!==(t=e.baseUIConfig)&&void 0!==t?t:new qc;n=Yc(n,e.apiUIConfig),n=Yc(n,e.urlUIConfig),n=Yc(n,e.chapterUIConfig),e.quizUIConfig&&(n=Yc(n,e.quizUIConfig,!0));const i=el(this.store.selectSnapshot(mr.getUI),n);this.store.dispatch(new j.SetUI(i))}setViewLanguage(e="en"){this.store.dispatch(new j.SetViewLanguage(e))}setAnatomyDescriptionFallback(e){this.store.dispatch(new j.SetNodeInfoConfig(e))}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(nl.b),i.Zb(d.g),i.Zb(Z.g),i.Zb(Ba),i.Zb(Qt),i.Zb(rc),i.Zb(G),i.Zb(Tl.i))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),Ll=(()=>{class e{constructor(e){this.viewService=e}initialize(){window.BDGlobalActions={toggleTutorial:e=>this.viewService.toggleTutorial(e)}}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(Dl))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var El=n("Kj3r"),Fl=n("OsX3"),Al=n("3UWI");function Rl(e,t){return e.dispatch(new qe(!1)),t.fireEvent(At.SceneXrayDisabled,void 0),!0}var Vl,Nl=n("yLV6");class Bl{constructor(e){this.ngUnsubsribe=new k.a,this.store=e,this.listenForParticleChanges(),this.listenForLookupChanges()}destroy(){this.ngUnsubsribe.next(),this.ngUnsubsribe.complete()}listenForLookupChanges(){this.store.select(ts.getTweenParticleLookup).pipe(Object(M.a)(this.ngUnsubsribe)).subscribe(e=>{Object(D.isEmpty)(e)||Zi.refreshEngineLookup(this.store.selectSnapshot(za.getStoryId),e)})}listenForParticleChanges(){const e=this.store.select(ts.getParticleSystems),t=this.store.select(ts.getVisisbleParticleSystems);Object(Do.a)(e,t).pipe(Object(M.a)(this.ngUnsubsribe)).subscribe(()=>{const e=this.store.selectSnapshot(Or.getSelectedChapterId),t=this.store.selectSnapshot(ts.particleSystemsForChapter(e)),n=this.store.selectSnapshot(ts.getVisibleParticleSystesmForChapter(e)),i=t.filter(e=>n.includes(e.id));this.setEngineParticles(i)})}setEngineParticles(e=[]){Human.particles.disableAll(),Human.particles.resetAll();const t=JSON.parse(JSON.stringify(e));Human.particles.parse(t,()=>{e.forEach(e=>{Human.particles.enable(e.id)}),null!=Human.timeline.activeRoot&&(Human.timeline.activeRoot._nowBranch.particleSystems=e.map(e=>e.id))})}}(Vl||(Vl={})).getColorRecipe=function(e,t){const n=e.scene.objects[t];if(n instanceof e.scene.Object){const e=n.getProperties();return{tintColor:Object(D.get)(e,"tintColor")?e.tintColor:[1,1,1],brightness:e.brightness,saturation:e.saturation,contrast:e.contrast,opacity:e.opacity}}return null};let Hl=(()=>{class e{constructor(e,t,n){this.store=e,this.graphService=t,this.engineService=n,this.highlightDisabled=!1}colorObject(e,t){const{tintColor:n,saturation:i,brightness:s,contrast:o,opacity:r}=t,a=Human.scene.objects[e];a instanceof Human.scene.Object&&(Object(D.isNil)(n)||a.setTintColor(n),Object(D.isNil)(i)||a.setSaturation(i),Object(D.isNil)(s)||a.setBrightness(s),Object(D.isNil)(o)||a.setContrast(o),Object(D.isNil)(r)||a.setOpacity(r))}getColor(e){return Vl.getColorRecipe(Human,e)}uncolorObject(e){const t=Human.scene.objects[e];t instanceof Human.scene.Object&&(t.clearColorModifiers(),t.clearOpacityModifiers())}unpaint(e){const t=this.store.selectSnapshot(Er.getViewGraph);this.graphService.getLeafDescendants(t,e.id).forEach(e=>{this.engineService.getObjects(e).forEach(e=>{const t=Human.scene.objects[e];t instanceof Human.scene.Object&&(t.clearColorModProperties(),t.clearOpacityModProperties())})})}paint(e,t){const n=this.store.selectSnapshot(Er.getViewGraph),i=Fi.toEngine(t);this.graphService.getLeafDescendants(n,e).forEach(e=>{this.engineService.getObjects(e).forEach(e=>{this.colorObject(e,i)})})}highlight(e,t){if(!1===this.highlightDisabled||!1===t){const n=this.store.selectSnapshot(Er.getViewGraph);this.graphService.getLeafDescendants(n,e).forEach(e=>{this.engineService.getObjects(e).forEach(e=>{const n=Human.scene.objects[e];n instanceof Human.scene.Object&&n.setHighlight(t)})})}}xRay(e,t){Human.scene.objects[e.id].setXRay(t)}paintAll(e,t){e.forEach(e=>this.paint(e,t))}unpaintAll(e){e.forEach(e=>{this.unpaint(e)})}highlightAll(e,t){e.forEach(e=>this.highlight(e,t))}disableHighlight(){this.highlightDisabled=!0}enableHighlight(){this.highlightDisabled=!1}setHighlightColor(e){Human.renderer.highlightColor=[...e]}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(d.g),i.Zb(Et),i.Zb(Qt))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var Ql=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},$l=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let ql=(()=>{class e{constructor(e){this.store=e,this.currentLayers=[],this.nodesLayerIndex=0,this.objectsLayerIndex=0,this.nodeChapterOpacities={}}initObservables(){this.selectedChapterId$.pipe(Object(I.a)(e=>!Object(D.isNil)(e))).subscribe(e=>{this.selectedChapterId=e,this.updateNodeChapterOpacities()}),this.selectedChapterCurrentLayers$.subscribe(e=>{this.currentLayers=e,this.nodesLayerIndex=this.objectsLayerIndex=this.store.selectSnapshot(Or.getSelectedChapterCurrentLayersIndex)}),Object(Ta.b)([this.selectedChapterCurrentLayersIndex$,this.selectedChapterCurrentLayersPosition$]).pipe(Object(I.a)(([e,t])=>!Object(D.isNil)(e)&&!Object(D.isNil)(t))).subscribe(([e,t])=>{this.synchronizeScene(e,t,!0)})}recordLayerIndexPosition(e,t){this.store.dispatch(new Jn(this.selectedChapterId,e,t,!0))}synchronizeScene(e,t,n){this.updateLayerIndex(e,this.currentLayers,n),this.updateLayerPosition(t,this.currentLayers,n)}fractionToIndex(e){const t=this.getThreshold(),n=Math.floor(e/t);return Math.min(this.currentLayers.length-2,n)}fractionToPosition(e,t){const n=this.getThreshold();return Math.max(0,Math.min((e-n*t)/n,1))}indexPositionToFraction(e,t){const n=this.getThreshold();return e*n+t*n}getThreshold(){return this.currentLayers.length>1?1/(this.currentLayers.length-1):1}getCurrentLayerIndexProp(e){return e?"nodesLayerIndex":"objectsLayerIndex"}updateLayerIndex(e,t,n){const i=this.getCurrentLayerIndexProp(n);e!==this[i]&&(this.restoreLayers(e,this[i],t,n),n&&(this.nodesLayerIndex=e),this.objectsLayerIndex=e)}updateLayerPosition(e,t,n){const i=this.getCurrentLayerIndexProp(n);this.setObjectsOpacity(t[this[i]].objectIds,1-e)}restoreLayers(e,t,n,i){const s=(e-t)/Math.abs(e-t);let o=[],r=t;for(;r!==e;)o=o.concat(n[r].objectIds),r+=s;const a=-1===s;this.setObjectsOpacity(o,1===s?0:1),i?this.setNodesShown(o,a):this.setObjectsShown(o,a),-1===s&&(i?this.setNodesShown(n[e].objectIds,!0):this.setObjectsShown(n[e].objectIds,!0))}setObjectsOpacity(e,t){for(let n=0;n<e.length;n++){const i=e[n],s=this.nodeChapterOpacities[i];let o;this.isFresnelOpacity(s)?(o=s.slice(),o[0]=t*s[0],o[1]=t*s[1]):o=t*s,Human.scene.objects[i].setOpacity(o)}}updateNodeChapterOpacities(){const e=this.store.selectSnapshot(Bi.getAllNodeState)[this.selectedChapterId];this.nodeChapterOpacities={},Object.entries(e).forEach(([e,t])=>{if(this.nodeChapterOpacities[e]=1,t.paint&&t.paint.hasOwnProperty("opacity")){const n=Fi.toEngine(t.paint);(this.isFresnelOpacity(n.opacity)||this.isScalarOpacity(n.opacity))&&(this.nodeChapterOpacities[e]=n.opacity)}})}isScalarOpacity(e){return"number"==typeof e}isFresnelOpacity(e){return Array.isArray(e)}setObjectsShown(e,t){const n={};for(let i=0;i<e.length;i++)n[e[i]]=t;Human.scene.setEnabledObjects({objects:n})}setNodesShown(e,t){this.store.dispatch(new Ii.UpdateNodesShown(t,e,void 0,!1))}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(d.g))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),Ql([Object(d.d)(Or.getSelectedChapterCurrentLayers),$l("design:type",P.a)],e.prototype,"selectedChapterCurrentLayers$",void 0),Ql([Object(d.d)(Or.getSelectedChapterCurrentLayersIndex),$l("design:type",P.a)],e.prototype,"selectedChapterCurrentLayersIndex$",void 0),Ql([Object(d.d)(Or.getSelectedChapterCurrentLayersPosition),$l("design:type",P.a)],e.prototype,"selectedChapterCurrentLayersPosition$",void 0),Ql([Object(d.d)(Or.getSelectedChapterId),$l("design:type",P.a)],e.prototype,"selectedChapterId$",void 0),e})();var Wl=n("HlzF");const Kl=new RegExp("^/media/audio/(.*)/.*$");let Gl=(()=>{class e{constructor(){this.audioPlayers=new Map}createAudioUploadEvent(e){return{type:"uploadFile",url:"/ws/media/audio/upload",method:"POST",file:e}}getAudioClips(e){return Object.values(e).filter(e=>"audio"===e.data.streamType)}createAudioClip(e,t,n){const i=Human.timeline.branchTimelines[e.id],s=this.getAudioUUID(t);return[s,{data:{clipId:s,streamType:"audio",fullUrl:t,time1:i.timeRange.firstTime,time2:i.timeRange.lastTime,lang:n}}]}getAudioSrc(e){return e.match("/media/audio")||(e="/content/states/"+e),e}getAudioPlayer(e){return this.audioPlayers.get(e)}addAudioPlayer(e){this.removeAudioPlayer(e),e=this.getAudioSrc(e);const t=new Wl.Howl({src:[e]});return this.audioPlayers.set(e,t),t}removeAudioPlayer(e){const t=this.audioPlayers.get(e);t&&(t.unload(),this.audioPlayers.delete(e))}stopAudio(){this.audioPlayers.forEach(e=>{e.stop()})}getAudioUUID(e){return e.match(Kl)[1]}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var Zl=n("R0Ic");function Jl(e,t){1&e&&i.Qb(0,"img",9)}function Xl(e,t){1&e&&i.Qb(0,"img",9)}function Yl(e,t){1&e&&i.Qb(0,"img",10)}function ep(e,t){1&e&&i.Qb(0,"img",11)}function tp(e,t){if(1&e&&(i.Tb(0),i.Ic(1,Jl,1,0,"img",6),i.Ic(2,Xl,1,0,"img",6),i.Ic(3,Yl,1,0,"img",7),i.Ic(4,ep,1,0,"img",8),i.Sb()),2&e){const e=i.gc();i.Db(1),i.lc("ngIf",e.label.pinType==e.labelPinType.Default),i.Db(1),i.lc("ngIf",e.label.pinType==e.labelPinType.Sequential),i.Db(1),i.lc("ngIf",e.label.pinType===e.labelPinType.Plus||e.label.pinType===e.labelPinType.PlusMinus&&!e.selected),i.Db(1),i.lc("ngIf",e.label.pinType===e.labelPinType.Minus||e.label.pinType===e.labelPinType.PlusMinus&&e.selected)}}function np(e,t){1&e&&i.Qb(0,"img",15)}function ip(e,t){1&e&&i.Qb(0,"img",15)}function sp(e,t){1&e&&i.Qb(0,"img",16)}function op(e,t){1&e&&i.Qb(0,"img",17)}function rp(e,t){if(1&e&&(i.Ic(0,np,1,0,"img",12),i.Ic(1,ip,1,0,"img",12),i.Ic(2,sp,1,0,"img",13),i.Ic(3,op,1,0,"img",14)),2&e){const e=i.gc();i.lc("ngIf",e.label.pinType==e.labelPinType.Default),i.Db(1),i.lc("ngIf",e.label.pinType==e.labelPinType.Sequential),i.Db(1),i.lc("ngIf",e.label.pinType===e.labelPinType.Plus||e.label.pinType===e.labelPinType.PlusMinus&&!e.selected),i.Db(1),i.lc("ngIf",e.label.pinType===e.labelPinType.Minus||e.label.pinType===e.labelPinType.PlusMinus&&e.selected)}}const ap=function(e,t){return{"label-pin__text--white":e,"label-pin__text--black":t}};function cp(e,t){if(1&e&&(i.Tb(0),i.Vb(1,"div",18),i.Kc(2),i.Ub(),i.Sb()),2&e){const e=i.gc();i.Db(1),i.lc("ngClass",i.oc(2,ap,e.labelTheme===e.labelThemeEnum.StudioNext,e.labelTheme===e.labelThemeEnum.Annotation)),i.Db(1),i.Mc(" ",e.sequence," ")}}const lp=function(e,t,n,i){return{"label-pin--light":e,"label-pin--dark":t,"label-pin--none":n,"label-pin--selected":i}};let pp=(()=>{class e{constructor(){this.labelPinType=oi,this.labelThemeEnum=ri,this.labelTheme=ri.StudioNext,this.selected=!1}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-label-pin"]],inputs:{label:"label",labelTheme:"labelTheme",selected:"selected",sequence:"sequence"},decls:7,vars:9,consts:[[1,"label-pin",3,"ngClass"],["pin",""],[4,"ngIf","ngIfElse"],["lightPins",""],[4,"ngIf"],[1,"label__glow"],["draggable","false","alt","","src","./assets/images/labels/circle-dark.svg","class","label-pin__image",4,"ngIf"],["draggable","false","alt","","src","./assets/images/labels/circle-plus-dark.svg","class","label-pin__image",4,"ngIf"],["draggable","false","alt","","src","./assets/images/labels/circle-minus-dark.svg","class","label-pin__image",4,"ngIf"],["draggable","false","alt","","src","./assets/images/labels/circle-dark.svg",1,"label-pin__image"],["draggable","false","alt","","src","./assets/images/labels/circle-plus-dark.svg",1,"label-pin__image"],["draggable","false","alt","","src","./assets/images/labels/circle-minus-dark.svg",1,"label-pin__image"],["draggable","false","alt","","src","./assets/images/labels/circle.svg","class","label-pin__image",4,"ngIf"],["draggable","false","alt","","src","./assets/images/labels/circle-plus.svg","class","label-pin__image",4,"ngIf"],["draggable","false","alt","","src","./assets/images/labels/circle-minus.svg","class","label-pin__image",4,"ngIf"],["draggable","false","alt","","src","./assets/images/labels/circle.svg",1,"label-pin__image"],["draggable","false","alt","","src","./assets/images/labels/circle-plus.svg",1,"label-pin__image"],["draggable","false","alt","","src","./assets/images/labels/circle-minus.svg",1,"label-pin__image"],[1,"label-pin__text",3,"ngClass"]],template:function(e,t){if(1&e&&(i.Vb(0,"div",0,1),i.Ic(2,tp,5,4,"ng-container",2),i.Ic(3,rp,4,4,"ng-template",null,3,i.Jc),i.Ic(5,cp,3,5,"ng-container",4),i.Qb(6,"div",5),i.Ub()),2&e){const e=i.tc(4);i.lc("ngClass",i.qc(4,lp,t.labelTheme===t.labelThemeEnum.StudioNext,t.labelTheme===t.labelThemeEnum.Annotation,t.label.pinType===t.labelPinType.None,t.selected)),i.Db(2),i.lc("ngIf",t.labelTheme===t.labelThemeEnum.Annotation)("ngIfElse",e),i.Db(3),i.lc("ngIf",t.label.pinType===t.labelPinType.Sequential)}},directives:[Z.i,Z.l],styles:['.label-pin[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;position:relative;transition:background-color .12s;z-index:10}.label-pin__text[_ngcontent-%COMP%]{display:flex;z-index:10;justify-content:center;align-items:center;font-size:10px!important;color:#101823}.label-pin[_ngcontent-%COMP%]:before, .label-pin__text[_ngcontent-%COMP%]{position:absolute;left:0;top:0;width:100%;height:100%}.label-pin[_ngcontent-%COMP%]:before{content:" ";background-color:transparent;border:2px solid transparent;border-radius:50%;box-sizing:border-box;display:block;z-index:-2}.label-pin--light.label-pin--selected[_ngcontent-%COMP%]:before{background-color:#fff;border-color:#2d72dc;box-shadow:0 0 0 1px rgba(45,114,220,.7)}.label-pin--light.label-pin[_ngcontent-%COMP%]   .label-pin__text[_ngcontent-%COMP%]{color:#101823}.label-pin--dark.label-pin[_ngcontent-%COMP%]:before{background-color:rgba(0,0,0,.75)}.label-pin--dark.label-pin--selected[_ngcontent-%COMP%]:after, .label-pin--dark.label-pin--selected[_ngcontent-%COMP%]:before{background-color:#2d72dc}.label-pin--dark.label-pin[_ngcontent-%COMP%]   .label-pin__text[_ngcontent-%COMP%]{color:#fff}.label-pin--none.label-pin[_ngcontent-%COMP%]{display:none}'],changeDetection:0}),e})(),dp=(()=>{class e{constructor(){}onClick(e){e.stopPropagation(),e.stopImmediatePropagation()}onEnterUp(e){e.stopPropagation(),e.stopImmediatePropagation()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=i.Kb({type:e,selectors:[["","appEventFence",""]],hostBindings:function(e,t){1&e&&i.cc("click",(function(e){return t.onClick(e,e.target)}))("keyup.enter",(function(e){return t.onEnterUp(e,e.target)}))}}),e})();var up=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},gp=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const hp=["labelContainerEl"],bp=["labelEl"],mp=["wire"],fp=["tag"],yp=["pin"],xp=["title"];function vp(e,t){1&e&&(i.Vb(0,"div",18),i.Qb(1,"app-icon",19),i.Ub())}const Op=function(e){return{"label__body--collapse":e}};function wp(e,t){if(1&e&&(i.Vb(0,"div",20),i.jc(1,3),i.Ub()),2&e){const e=i.gc();i.lc("ngClass",i.nc(1,Op,e.isCollapsed||e.descriptionCollapsed))}}const Cp=[[["","label-header",""]],[["","label-actions",""]],[["","label-more",""]],[["","label-body",""]]],Sp=function(e,t,n,i,s,o,r,a,c){return{"label--selected":e,"label--glow":t,"label--annotation":n,"label--invert":i,"label--studio":s,"label--context":o,"label--screenshot-mode":r,"label--auto-fit":a,"label--opaque":c}},_p=function(e){return{"label__wire--collapse":e}},jp=function(e,t,n,i){return{"label__tag--collapse":e,"label__tag--collapsible":t,"label__tag--floating":n,"label__tag--draggable":i}},kp=["[label-header]","[label-actions]","[label-more]","[label-body]"];let Pp=(()=>{class e{constructor(e,t,n,s,o,r,a){this.renderer=e,this.labelsService=t,this.engineService=n,this.cameraService=s,this.store=o,this.actions=r,this.changeDetection=a,this.labelPinType=oi,this.labelSequentialType=ai,this.labelUpdated=new i.p,this.offsetUpdated=new i.p,this.pinClicked=new i.p,this.tagClicked=new i.p,this.displayUpdated=new i.p,this.positionUpdated=new i.p,this.hoverStart=new i.p,this.hoverEnd=new i.p,this.labelOffsetUpdated=new i.p,this.fit="fixed",this.opaque=!1,this.fixedScale=0,this.isCollapsed=!1,this.tagCollapsed=!1,this.theme="classic",this.pinDraggable=!0,this.tagDraggable=!0,this._selected=!1,this.enginePosition=null,this.isBackgroundDark=!1,this.pinDragging=!1,this.screenshotMode=!1,this.hammerManagers=[],this.displayUpdated$=new k.a,this.positionUpdated$=new k.a,this.ngUnsubscribe=new k.a}get label(){return this._label}set label(e){const t=Object(D.isEmpty)(e),n=Object(D.isEmpty)(this.label);t&&!n?(this._label=Object.assign({},e),this.destroyLabel()):t||(this._label=Object.assign({},e),this.initLabel(this.label))}set selected(e){e&&this.tagRef.nativeElement.focus(),this._selected=e}get selected(){return this._selected}ngOnInit(){this.initListeners()}ngAfterViewInit(){this.bindTagEvents(),this.bindPinEvents(),this.bindHoverEvents()}ngOnDestroy(){this.destroyLabel(),this.emitDisplayUpdated({id:this.label.id,inView:!1,shown:!1,objectShown:this.objectShown}),this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}destroyLabel(){this.hammerManagers.forEach(e=>e.destroy),this.hammerManagers=[],this.deleteMarker(this.marker)}initListeners(){this.enginePosition$.pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.enginePosition=e}),this.engineService.getEvent(At.SceneMarkersUpdated).pipe(Object(I.a)(()=>null!=this.label&&null!=this.enginePosition),Object(M.a)(this.ngUnsubscribe)).subscribe(()=>{this.setCanvasPos()}),this.displayUpdated$.pipe(Object(qa.a)((e,t)=>Object(D.isEqual)(e,t)),Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.displayUpdated.next(e)}),this.positionUpdated$.pipe(Object(qa.a)((e,t)=>Object(D.isEqual)(e,t)),Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.positionUpdated.next({positionUpdate:e,onCanvas:this.isOnCanvas()})}),this.background$.pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{const t=e.colors.slice(0,3),n=e.colors.slice(4,7);this.isBackgroundDark=!si.isLight(t,n),this.changeDetection.markForCheck()}),this.actions.pipe(Object(d.j)(Ss),Object(M.a)(this.ngUnsubscribe)).subscribe(()=>{this.screenshotMode=!0,this.changeDetection.detectChanges()}),this.actions.pipe(Object(d.i)(_s),Object(M.a)(this.ngUnsubscribe)).subscribe(()=>{this.screenshotMode=!1,this.changeDetection.markForCheck()})}bindTagEvents(){const e=new Nl(this.tagRef.nativeElement,{domEvents:!0});e.get("pan").set({direction:Nl.DIRECTION_ALL,threshold:3}),e.on("pan",e=>{if(!this.tagDraggable)return;e.srcEvent.stopPropagation(),this.cachedTagOffset||(this.cachedTagOffset=this.label.offset);const t=[this.cachedTagOffset[0]+e.deltaX,this.cachedTagOffset[1]+e.deltaY];this.label.offset=t,e.isFinal&&(this.cachedTagOffset=null,this.offsetUpdated.next({labelId:this.label.id,offset:t}))}),e.on("tap",e=>{e.srcEvent.preventDefault(),e.srcEvent.stopPropagation(),this.tagClicked.next(e)}),this.hammerManagers.push(e)}bindPinEvents(){const e=new Nl(this.pinRef.nativeElement);e.get("pan").set({direction:Nl.DIRECTION_ALL,threshold:4}),e.on("pan",e=>{if(!this.pinDraggable)return;e.srcEvent.stopPropagation(),this.pinDragging=!0;let{layerX:t,layerY:n}=e.changedPointers[0];if(t-=16,n-=16,this.marker&&this.deleteMarker(this.marker),this.renderer.setStyle(this.labelContainerRef.nativeElement,"transform",`translate(${t}px, ${n}px)`),e.isFinal){this.pinDragging=!1;const e=Object.assign({},this.label),i=Human.renderer.pick.pick(t,n,{rayPick:!0}),s="string"==typeof i.objectId;s&&(e.dir=this.cameraService.getDirection(i),e.objectId=i.objectId,e.barycentric=[i.barycentric[0],i.barycentric[1],i.barycentric[2]],e.pos=[i.worldPos[0],i.worldPos[1],i.worldPos[2]],e.primitiveIndex=i.primitiveIndex),this.labelUpdated.next({label:e,shouldPreserve:s})}}),e.on("tap",e=>{e.srcEvent.preventDefault(),e.srcEvent.stopImmediatePropagation(),this.pinClicked.next(e)}),this.hammerManagers.push(e)}bindHoverEvents(){const e=this.labelRef.nativeElement;this.renderer.listen(e,"mouseenter",()=>{this.hoverStart.next({labelId:this.label.id})}),this.renderer.listen(e,"mouseleave",()=>{this.hoverEnd.next({labelId:this.label.id})})}initLabel(e){this.initMarker(e),this.ensureObjectId(e),this.initObjectSubscription(e)}initMarker(e){this.marker&&this.deleteMarker(this.marker),this.marker=Human.scene.markers.create({id:e.id,pos:e.pos,dir:e.dir,objectId:e.objectId,primitiveIndex:e.primitiveIndex,barycentric:e.barycentric,renderableIndex:e.renderableIndex||0})}checkLabelDisplay(){return{id:this.label.id,shown:this.label.shown,inView:this.isOnCanvas(),objectShown:!0}}ensureObjectId(e){if(!e.objectId){const[t,n]=this.marker.canvasPos,i=Human.renderer.pick.pick(t,n,{rayPick:!0});i.objectId&&(e.objectId=i.objectId,e.states.forEach(e=>{e.errands.forEach(e=>{e.type===wi.flyToObject&&(e.value=i.objectId)})}),this.labelUpdated.next({label:e,shouldPreserve:void 0}))}}initObjectSubscription(e){this.object$&&this.object$.unsubscribe(),e.objectId&&(this.object$=this.store.select(Er.getViewGraphNode).pipe(Object(F.a)(t=>t(e.objectId)),Object(I.a)(e=>!!e),Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.objectShown=e.boolState.shown}))}deleteMarker(e){Human.scene.markers.delete(e.id),this.marker=null}setCanvasPos(){if(this.pinDragging||!this.marker)return;this.depth=-this.marker.viewPos[2];const e=this.isOccluded(),t=this.isOcclusionIgnored(),n=this.isOnCanvas(),i=e&&!t,s=void 0===this.objectShown?n&&!i:n&&this.objectShown&&!i;s!==this.shown&&(this.shown=s,this.setDisplay(s)),this.setElementPosition(),this.setElementScale(),this.setTagPosition(),this.setWirePosition();const{0:o,1:r}=this.marker.canvasPos;this.positionUpdated$.next({id:this.label.id,canvasPos:{x:o,y:r},occluded:i})}isOcclusionIgnored(){return this.selected||!this.label.occludable}isOccluded(){return this.depth<0||this.marker.occluded}isOnCanvas(){const{offsetWidth:e,offsetHeight:t}=this.labelsService.getLabelContainer().nativeElement,[n,i]=this.marker.canvasPos;return n>0&&i>0&&n<e&&i<t}setDisplay(e){this.renderer.setStyle(this.labelRef.nativeElement,"visibility",e?"visible":"hidden"),this.emitDisplayUpdated({id:this.label.id,inView:this.isOnCanvas(),shown:e,objectShown:this.objectShown})}setOpacity(e){let t=1;e?(this.marker.viewAngle>=80&&(t=Math.max(1-(this.marker.viewAngle-80)/20*1,0)),this.renderer.setStyle(this.labelContainerRef.nativeElement,"opacity",t)):this.renderer.setStyle(this.labelContainerRef.nativeElement,"opacity",1)}setElementPosition(){const e=this.marker.canvasPos;this.renderer.setStyle(this.labelContainerRef.nativeElement,"transform",`translate(${e[0]}px, ${e[1]}px)`)}setElementScale(){let e;if(this.fixedScale)e=this.fixedScale;else{const t=this.store.selectSnapshot(Er.getEnginePosition).width;e=t>1440?t/1440:1}const t=32*e-32;this.renderer.setStyle(this.labelRef.nativeElement,"transform-origin","top left"),this.renderer.setStyle(this.labelRef.nativeElement,"transform",`translate(-${t/2}px, -${t/2}px) scale(${e}, ${e})`)}setTagPosition(){const e=this.label.offset,t=this.tagRef.nativeElement.offsetWidth;switch(this.label.offset[0]>0?"left":"right"){case"left":this.renderer.setStyle(this.tagRef.nativeElement,"transform",`translate(${16+e[0]}px, ${e[1]}px)`);break;case"right":this.renderer.setStyle(this.tagRef.nativeElement,"transform",`translate(${16+e[0]-t}px, ${e[1]}px)`)}}setWirePosition(){let[e,t]=this.label.offset;switch(this.label.theme){case ri.Annotation:case ri.Classic:t+=this.titleRef.nativeElement.offsetHeight-16-2}const n=Math.sqrt(e*e+t*t);this.renderer.setStyle(this.wireRef.nativeElement,"width",n+"px"),this.renderer.setStyle(this.wireRef.nativeElement,"transform",`rotate(${Math.atan2(t,e)}rad)`)}emitDisplayUpdated(e){"context-label"!==this.label.id&&null!=e.inView&&null!=e.shown&&this.displayUpdated$.next(e)}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(i.H),i.Pb(Pi),i.Pb(Qt),i.Pb(yn),i.Pb(d.g),i.Pb(d.b),i.Pb(i.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-generic-label"]],viewQuery:function(e,t){if(1&e&&(i.Ec(hp,!0),i.Ec(bp,!0),i.Ec(mp,!0),i.Ec(fp,!0),i.Ec(yp,!0),i.Ec(xp,!0)),2&e){let e;i.sc(e=i.dc())&&(t.labelContainerRef=e.first),i.sc(e=i.dc())&&(t.labelRef=e.first),i.sc(e=i.dc())&&(t.wireRef=e.first),i.sc(e=i.dc())&&(t.tagRef=e.first),i.sc(e=i.dc())&&(t.pinRef=e.first),i.sc(e=i.dc())&&(t.titleRef=e.first)}},hostVars:2,hostBindings:function(e,t){2&e&&i.Hb("selected",t.selected)},inputs:{fit:"fit",opaque:"opaque",fixedScale:"fixedScale",sequence:"sequence",hasContent:"hasContent",label:"label",isCollapsed:"isCollapsed",descriptionCollapsed:"descriptionCollapsed",tagCollapsed:"tagCollapsed",selected:"selected",theme:"theme",pinDraggable:"pinDraggable",tagDraggable:"tagDraggable"},outputs:{labelUpdated:"labelUpdated",offsetUpdated:"offsetUpdated",pinClicked:"pinClicked",tagClicked:"tagClicked",displayUpdated:"displayUpdated",positionUpdated:"positionUpdated",hoverStart:"hoverStart",hoverEnd:"hoverEnd",labelOffsetUpdated:"labelOffsetUpdated"},ngContentSelectors:kp,decls:21,vars:26,consts:[["data-test","labelContainer",1,"label-container"],["labelContainerEl",""],["data-test","labelElement",1,"label",3,"ngClass"],["labelEl",""],[1,"label__pin"],["pin",""],[3,"label","labelTheme","selected","sequence"],[1,"label__glow"],[1,"label__wire",3,"ngClass"],["wire",""],["tabindex","0",1,"label__tag",3,"ngClass"],["tag",""],[1,"label__header"],["data-test","labelTitle",1,"label__title"],["title",""],["class","label__more",4,"ngIf"],["appEventFence","",1,"label__actions"],["class","label__body",3,"ngClass",4,"ngIf"],[1,"label__more"],["icon","caret-right"],[1,"label__body",3,"ngClass"]],template:function(e,t){1&e&&(i.kc(Cp),i.Vb(0,"div",0,1),i.Vb(2,"div",2,3),i.Vb(4,"div",4,5),i.Qb(6,"app-label-pin",6),i.Qb(7,"div",7),i.Ub(),i.Qb(8,"div",8,9),i.Vb(10,"div",10,11),i.Vb(12,"div",12),i.Vb(13,"div",13,14),i.jc(15),i.Ub(),i.Ic(16,vp,2,0,"div",15),i.Vb(17,"div",16),i.jc(18,1),i.Ub(),i.Ub(),i.Ic(19,wp,2,3,"div",17),i.jc(20,2),i.Ub(),i.Ub(),i.Ub()),2&e&&(i.Db(2),i.lc("ngClass",i.rc(9,Sp,[t.selected,t.label.pinGlow,"annotation"===t.label.theme||"classic"===t.label.theme,t.isBackgroundDark,"studioNext"===t.label.theme,"context"===t.label.theme,t.screenshotMode,"auto"===t.fit,t.opaque])),i.Db(4),i.lc("label",t.label)("labelTheme",t.label.theme)("selected",t.selected)("sequence",t.sequence),i.Db(2),i.lc("ngClass",i.nc(19,_p,t.isCollapsed||t.tagCollapsed||t.label.hideWire)),i.Db(2),i.lc("ngClass",i.qc(21,jp,t.isCollapsed||t.tagCollapsed,t.label.collapseDescription,t.label.hideWire,t.tagDraggable)),i.Db(6),i.lc("ngIf",t.hasContent&&t.label.collapseDescription),i.Db(3),i.lc("ngIf",t.hasContent))},directives:[Z.i,pp,Z.l,dp,dl],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}@-webkit-keyframes fadeIn{0%{display:none;opacity:0}1%{display:block;opacity:0}to{opacity:1;display:block}}@keyframes fadeIn{0%{display:none;opacity:0}1%{display:block;opacity:0}to{opacity:1;display:block}}@-webkit-keyframes fadeOut{0%{display:block;opacity:1}99%{opacity:0}to{opacity:0;display:none}}@keyframes fadeOut{0%{display:block;opacity:1}99%{opacity:0}to{opacity:0;display:none}}@-webkit-keyframes glow{0%{box-shadow:0 0 0 hsla(0,0%,100%,.5)}50%{box-shadow:0 0 8px 2px hsla(0,0%,100%,.5)}to{box-shadow:0 0 0 hsla(0,0%,100%,.5)}}@keyframes glow{0%{box-shadow:0 0 0 hsla(0,0%,100%,.5)}50%{box-shadow:0 0 8px 2px hsla(0,0%,100%,.5)}to{box-shadow:0 0 0 hsla(0,0%,100%,.5)}}@-webkit-keyframes classic-glow{0%{transform:scale(.5)}10%{transform:scale(.5)}50%{transform:scale(1)}90%{transform:scale(.5)}to{transform:scale(.5)}}@keyframes classic-glow{0%{transform:scale(.5)}10%{transform:scale(.5)}50%{transform:scale(1)}90%{transform:scale(.5)}to{transform:scale(.5)}}.label-container[_ngcontent-%COMP%], [_nghost-%COMP%]{display:block;position:absolute;z-index:10;width:160px;pointer-events:all;pointer-events:none}.label-container[_ngcontent-%COMP%]:hover, [_nghost-%COMP%]:hover{z-index:12}.selected[_nghost-%COMP%]{z-index:11}.label-container[_ngcontent-%COMP%]{left:-16px;top:-16px}.label[_ngcontent-%COMP%]{display:block;overflow:visible;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;justify-content:center;align-items:center;height:32px}.label--screenshot-mode[_ngcontent-%COMP%]{text-shadow:none!important}.label--screenshot-mode[_ngcontent-%COMP%]   .label__pin[_ngcontent-%COMP%]:after, .label--screenshot-mode[_ngcontent-%COMP%]   .label__pin[_ngcontent-%COMP%]:before{box-shadow:none!important}.label--screenshot-mode[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]{box-shadow:none!important;text-shadow:none!important}.label--screenshot-mode[_ngcontent-%COMP%]   .label__more[_ngcontent-%COMP%]{display:none!important}.label--auto-fit[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]{min-width:-webkit-max-content;min-width:-moz-max-content;min-width:max-content;padding:0!important}.label--auto-fit[_ngcontent-%COMP%]   .label__body[_ngcontent-%COMP%]{padding:0!important}.label__glow[_ngcontent-%COMP%]{display:none;position:absolute;width:32px;height:32px;border-radius:50%;z-index:0;top:0;left:0}.label--selected[_ngcontent-%COMP%]   .label__more[_ngcontent-%COMP%]{transform:rotate(45deg)}.label__more[_ngcontent-%COMP%]{color:#374a68;display:none;flex:0 0 16px;height:16px;transition:transform .15s ease-in-out}.label__more[_ngcontent-%COMP%], .label__pin[_ngcontent-%COMP%]{align-items:center;justify-content:center}.label__pin[_ngcontent-%COMP%]{display:flex;width:32px;height:32px;border-radius:50%;position:absolute;pointer-events:all;transition:background-color .12s;z-index:10}.label__pin[_ngcontent-%COMP%]:hover{cursor:pointer}.label__pin--draggable[_ngcontent-%COMP%]:hover{cursor:-webkit-grab;cursor:grab}.label__pin--draggable[_ngcontent-%COMP%]:active{cursor:-webkit-grabbing;cursor:grabbing}.label__wire[_ngcontent-%COMP%]{position:absolute;top:16px;left:16px;height:0;transform-origin:0 100%;pointer-events:none;z-index:1}.label__wire--collapse[_ngcontent-%COMP%]{display:none}.label__tag[_ngcontent-%COMP%]{display:inline-block;left:16px;top:0;z-index:10;max-width:160px;pointer-events:all}.label__tag[_ngcontent-%COMP%]:hover{cursor:pointer}.label__tag--draggable[_ngcontent-%COMP%]:hover{cursor:-webkit-grab;cursor:grab}.label__tag--draggable[_ngcontent-%COMP%]:active{cursor:-webkit-grabbing;cursor:grabbing}.label__tag--collapse[_ngcontent-%COMP%]{display:none}.label__tag[_ngcontent-%COMP%]:focus{outline:2px solid #2d72dc!important;border-radius:4px}.label__header[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.label__title[_ngcontent-%COMP%]{line-height:1.4em;line-height:140%;align-self:center}.label__body[_ngcontent-%COMP%], .label__title[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;letter-spacing:0}.label__body[_ngcontent-%COMP%]{line-height:1.4em}.label__body--collapse[_ngcontent-%COMP%]{display:none}.label__icon[_ngcontent-%COMP%]{margin:0 -4px 0 4px}.label__actions[_ngcontent-%COMP%]{padding-left:4px}.label--studio.label--glow[_ngcontent-%COMP%]   .label__glow[_ngcontent-%COMP%]{background-color:hsla(0,0%,100%,.3);display:block;-webkit-animation:classic-glow 4s infinite;animation:classic-glow 4s infinite}.label--studio.label--opaque[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]{background-color:hsla(0,0%,100%,.85)!important}.label--studio.label.label--selected[_ngcontent-%COMP%]   .label__wire[_ngcontent-%COMP%]{border-color:#2d72dc}.label--studio.label.label--selected[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]{background-color:#fff;border-color:#2d72dc;box-shadow:0 0 0 1px rgba(45,114,220,.7)}.label--studio.label.label--selected[_ngcontent-%COMP%]   .label__title[_ngcontent-%COMP%]{font-weight:600}.label--studio.label[_ngcontent-%COMP%]   .label__wire[_ngcontent-%COMP%]{border-top:1px solid rgba(16,24,35,.5)}.label--studio.label[_ngcontent-%COMP%]   .label__wire--collapse[_ngcontent-%COMP%]{display:none}.label--studio.label[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]{background:hsla(0,0%,100%,.55);border:1px solid rgba(16,24,35,.5);box-shadow:0 0 24px rgba(16,24,35,.1);padding:4px 8px;border-radius:4px}.label--studio.label[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]:hover{background:hsla(0,0%,100%,.8)}.label--studio.label[_ngcontent-%COMP%]   .label__title[_ngcontent-%COMP%]{color:#101823;flex:1 1 auto}.label--studio.label[_ngcontent-%COMP%]   .label__body[_ngcontent-%COMP%]{color:#374a68;overflow-x:hidden;padding-top:4px}.label--studio.label[_ngcontent-%COMP%]   .label__body[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-weight:700}.label--studio.label[_ngcontent-%COMP%]   .label__body[_ngcontent-%COMP%]   em[_ngcontent-%COMP%]{font-style:italic}.label--studio.label[_ngcontent-%COMP%]   .label__more[_ngcontent-%COMP%]{display:flex}.label--studio.label.label--invert[_ngcontent-%COMP%]   .label__wire[_ngcontent-%COMP%]{border-color:hsla(0,0%,100%,.5)}.label--annotation.label--glow[_ngcontent-%COMP%]   .label__glow[_ngcontent-%COMP%]{background-color:hsla(0,0%,100%,.25);display:block;-webkit-animation:classic-glow 4s infinite;animation:classic-glow 4s infinite;top:-1px;left:-1px}.label--annotation.label--none[_ngcontent-%COMP%]{display:none}.label--annotation.label[_ngcontent-%COMP%]   .label__wire[_ngcontent-%COMP%]{border-top:1px solid #666}.label--annotation.label[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]{min-width:10px;color:#eee}.label--annotation.label[_ngcontent-%COMP%]   .label__tag--collapsible[_ngcontent-%COMP%]   .label__more[_ngcontent-%COMP%]{display:flex;color:#000}.label--annotation.label[_ngcontent-%COMP%]   .label__tag--floating[_ngcontent-%COMP%]   .label__header[_ngcontent-%COMP%]{border-bottom:none}.label--annotation.label[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]:focus{outline-offset:4px}.label--annotation.label[_ngcontent-%COMP%]   .label__header[_ngcontent-%COMP%]{border-bottom:1px solid #666}.label--annotation.label[_ngcontent-%COMP%]   .label__title[_ngcontent-%COMP%]{font-weight:600;min-height:18px;width:100%;padding-bottom:4px;margin-bottom:-2px;color:#000}.label--annotation.label[_ngcontent-%COMP%]   .label__body[_ngcontent-%COMP%]{padding-top:4px;color:#333}.label--annotation.label.label--invert.label[_ngcontent-%COMP%]   .label__wire[_ngcontent-%COMP%]{border-color:#eee}.label--annotation.label.label--invert.label[_ngcontent-%COMP%]   .label__tag--collapsible[_ngcontent-%COMP%]   .label__more[_ngcontent-%COMP%]{display:flex;color:#fff}.label--annotation.label.label--invert.label[_ngcontent-%COMP%]   .label__title[_ngcontent-%COMP%]{color:#fff}.label--annotation.label.label--invert.label[_ngcontent-%COMP%]   .label__header[_ngcontent-%COMP%]{border-color:#eee}.label--annotation.label.label--invert.label[_ngcontent-%COMP%]   .label__body[_ngcontent-%COMP%]{color:#eee}.label--context.label[_ngcontent-%COMP%]{pointer-events:none}.label--context.label--glow[_ngcontent-%COMP%]   .label__glow[_ngcontent-%COMP%]{background-color:hsla(0,0%,100%,.3);display:block;-webkit-animation:classic-glow 4s infinite;animation:classic-glow 4s infinite}.label--context.label[_ngcontent-%COMP%]   .label__pin[_ngcontent-%COMP%], .label--context.label[_ngcontent-%COMP%]   .label__wire[_ngcontent-%COMP%]{display:none}.label--context.label[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]{background:hsla(0,0%,100%,.7);border:1px solid rgba(16,24,35,.5);box-shadow:0 0 24px rgba(16,24,35,.1);padding:4px 8px;border-radius:4px}.label--context.label[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]:hover{background:hsla(0,0%,100%,.8);cursor:-webkit-grab;cursor:grab}.label--context.label[_ngcontent-%COMP%]   .label__title[_ngcontent-%COMP%]{font-weight:600;color:#101823}.label--context.label[_ngcontent-%COMP%]   .label__body[_ngcontent-%COMP%]{margin-top:8px;border-top:1px solid #eaeff5;color:#101823;overflow-x:hidden;padding-top:8px}.label--context.label[_ngcontent-%COMP%]   .label__body[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-weight:700}.label--context.label[_ngcontent-%COMP%]   .label__body[_ngcontent-%COMP%]   em[_ngcontent-%COMP%]{font-style:italic}"],changeDetection:0}),up([Object(d.d)(Er.getEnginePosition),gp("design:type",P.a)],e.prototype,"enginePosition$",void 0),up([Object(d.d)(Or.getSelectedChapterBackground),gp("design:type",P.a)],e.prototype,"background$",void 0),e})(),Mp=(()=>{class e{constructor(e){this.engineService=e}getClipboardAPISupport(){return"clipboard"in navigator}getClipboardAPI(){return navigator.clipboard}copyToClipboard(e,t){if(!0===c.native||c.platform===a.SDK)return new P.a(n=>{this.engineService.fireEvent(At.NativeShare,{type:t,value:e}),n.next(!0),n.complete()});if(this.getClipboardAPISupport()){const t=this.getClipboardAPI();return new P.a(n=>{t.writeText(e).then(()=>{n.next(!0),n.complete()}).catch(e=>{n.next(!1),n.complete()})})}return Object(zs.a)(!1)}copyInputFieldValue(e){e.select();let t=!1;try{t=document.execCommand("copy")}catch(n){t=!1}return t}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(Qt))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),Ip=(()=>{class e{constructor(e){this.colorRecipe=e}}return e.type="[Edit Paint] Set Color Recipe",e})(),zp=(()=>{class e{constructor(e){this.brushMode=e}}return e.type="[Edit Paint] Set Paint Brush Mode",e})(),Tp=(()=>{class e{constructor(){}}return e.type="[Edit Paint] Clear Current Recipe",e})(),Up=(()=>{class e{constructor(){}}return e.type="[Edit Paint] Reset Paint",e})(),Dp=(()=>{class e{constructor(e){this.recipe=e}}return e.type="[Edit Paint] Add Recent Recipe",e})(),Lp=(()=>{class e{constructor(e){this.recipes=e}}return e.type="[Edit Paint] Set Recent Recipes",e})(),Ep=(()=>{class e{constructor(){}}return e.type="[Edit Paint] Reset Story Recipes",e})(),Fp=(()=>{class e{constructor(e,t){this.chapterId=e,this.recipes=t}}return e.type="[Edit Paint] Set Story Recipes For Chapter",e})(),Ap=(()=>{class e{constructor(e){this.palette=e}}return e.type="[Edit Paint] Add Palette",e})(),Rp=(()=>{class e{constructor(e){this.paletteId=e}}return e.type="[Edit Paint] Remove Palette",e})(),Vp=(()=>{class e{constructor(e){this.palette=e}}return e.type="[Edit Paint] Update Palette",e})(),Np=(()=>{class e{constructor(e){this.palettes=e}}return e.type="[Edit Paint] Set Palettes",e})(),Bp=(()=>{class e{constructor(e,t){this.recipe=e,this.paletteId=t}}return e.type="[Edit Paint] Add Recipe to Palette",e})(),Hp=(()=>{class e{constructor(e,t){this.paletteId=e,this.open=t}}return e.type="[Edit Paint] Toggle Palette",e})(),Qp=(()=>{class e{constructor(e){this.view=e}}return e.type="[Edit] Set view",e})(),$p=(()=>{class e{constructor(){}}return e.type="[Edit] Next view",e})(),qp=(()=>{class e{constructor(){}}return e.type="[Edit] Previous view",e})(),Wp=(()=>{class e{constructor(e){this.show=e}}return e.type="[Edit] Show columns",e})(),Kp=(()=>{class e{constructor(e,t){this.column=e,this.show=t}}return e.type="[Edit] Show column",e})(),Gp=(()=>{class e{constructor(e){this.show=e}}return e.type="[Edit] Show Timeline Editor",e})(),Zp=(()=>{class e{constructor(){}}return e.type="[Edit] Reset",e})(),Jp=(()=>{class e{constructor(e){this.layerOrderMode=e}}return e.type="[Edit] Set Layer Order Mode",e})(),Xp=(()=>{class e{constructor(e){this.show=e}}return e.type="[Edit] Show Tree Node Ids",e})(),Yp=(()=>{class e{constructor(e){this.show=e}}return e.type="[Edit] Show Root Nodess",e})(),ed=(()=>{class e{constructor(e){this.size=e}}return e.type="[Edit] Set Canvas Size",e})(),td=(()=>{class e{constructor(e){this.enable=e}}return e.type="[Edit] Auto Capture",e})();var nd=function(e){return e.Chapter="chapter",e.Label="label",e.Paint="paint",e.Position="position",e.Quiz="quiz",e}({}),id=n("dNgK"),sd=function(e){return e.Dark="dark",e.Light="light",e.Themed="themed",e}({});const od=["app-button",""],rd=function(e,t,n,i,s,o,r,a,c,l,p,d,u,g,h,b,m,f,y,x,v,O,w,C){return{"app-button--xsmall":e,"app-button--small":t,"app-button--medium":n,"app-button--large":i,"app-button--flat":s,"app-button--default":o,"app-button--primary":r,"app-button--white":a,"app-button--info":c,"app-button--outline":l,"app-button--text":p,"app-button--light":d,"app-button--dark":u,"app-button--themed":g,"app-button--circle":h,"app-button--rounded":b,"app-button--square":m,"app-button--selected":f,"app-button--uppercase":y,"app-button--disabled":x,"app-button--no-border":v,"app-button--expanded":O,"app-button--left":w,"app-button--loading":C}},ad=["*"];var cd=function(e){return e.XSmall="xsmall",e.Small="small",e.Medium="medium",e.Large="large",e}({}),ld=function(e){return e.Default="default",e.Flat="flat",e.Primary="primary",e.Info="info",e.Outline="outline",e.Text="text",e.White="white",e}({}),pd=function(e){return e.Default="default",e.Circle="circle",e.Rounded="rounded",e.Square="square",e}({}),dd=function(e){return e.Left="left",e.Center="center",e}({});let ud=(()=>{class e{constructor(){this.buttonSize=cd.Medium,this.buttonType=ld.Default,this.buttonTheme=sd.Dark,this.buttonShape=pd.Default,this.buttonAlign=dd.Center,this.uppercase=!0,this.selected=!1,this.expanded=!1,this.loading=!1,this.bordered=!0}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["button","app-button",""],["a","app-button",""]],hostVars:1,hostBindings:function(e,t){2&e&&i.Yb("disabled",t.disabled)},inputs:{buttonSize:"buttonSize",buttonType:"buttonType",buttonTheme:"buttonTheme",buttonShape:"buttonShape",buttonAlign:"buttonAlign",uppercase:"uppercase",selected:"selected",expanded:"expanded",loading:"loading",disabled:"disabled",bordered:"bordered"},attrs:od,ngContentSelectors:ad,decls:3,vars:26,consts:[[1,"app-button",3,"ngClass"],[1,"app-button__container"]],template:function(e,t){1&e&&(i.kc(),i.Vb(0,"span",0),i.Vb(1,"span",1),i.jc(2),i.Ub(),i.Ub()),2&e&&i.lc("ngClass",i.rc(1,rd,["xsmall"==t.buttonSize,"small"==t.buttonSize,"medium"==t.buttonSize,"large"==t.buttonSize,"flat"==t.buttonType,"default"==t.buttonType,"primary"==t.buttonType,"white"==t.buttonType,"info"==t.buttonType,"outline"==t.buttonType,"text"==t.buttonType,"light"==t.buttonTheme,"dark"==t.buttonTheme,"themed"==t.buttonTheme,"circle"==t.buttonShape,"rounded"==t.buttonShape,"square"==t.buttonShape,t.selected,t.uppercase,t.disabled,!t.bordered,t.expanded,"left"===t.buttonAlign,t.loading]))},directives:[Z.i],styles:['.text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3535}.text-info{color:#2d72dc}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}a[app-button],button[app-button]{border-color:transparent;background:none;border-width:0;padding:0;margin:0;border-radius:4px;outline:0 none}a[app-button]:not([disabled]):hover,button[app-button]:not([disabled]):hover{cursor:pointer}a[app-button]:focus .app-button,button[app-button]:focus .app-button{outline:2px solid #2d72dc!important}.app-button{font-size:13px;letter-spacing:.325px;line-height:1.4em;align-items:center;border-radius:4px;display:flex;font-family:Inter UI,sans-serif;justify-content:center;padding:0 16px;position:relative;text-align:center;transition:background-color .12s;width:100%}.app-button:after{content:" ";background-color:#283853;border-radius:4px;display:block;position:absolute;left:0;top:0;bottom:0;right:0;opacity:0;z-index:1;transition:opacity .06s}.app-button:not(.app-button--disabled):hover:after{opacity:.7}.app-button__container{position:relative;z-index:2;width:100%}.app-button--uppercase{text-transform:uppercase}.app-button--expanded{display:flex;flex:1}.app-button--xsmall{height:24px;min-width:24px;padding:0 8px;font-size:10px;letter-spacing:.25px;line-height:1.4em}.app-button--small{height:32px;min-width:32px;padding:0 12px}.app-button--medium,.app-button--small{font-size:13px;letter-spacing:.325px;line-height:1.4em}.app-button--medium{height:36px;min-width:36px;padding:0 16px}.app-button--large{height:48px;min-width:48px;padding:0 16px;font-size:14px;letter-spacing:.35px;line-height:1.4em}.app-button--no-border,.app-button--no-border:after{border-radius:0!important}.app-button--left{text-align:left}.app-button--themed{color:#374a68}.app-button--themed:hover{color:#1c2a3f}.app-button--themed:after{background-color:#d7e0ea}.app-button--dark{color:#d7e0ea}.app-button--dark:hover{color:#fff}.app-button--dark:after{background-color:#283853}.app-button--dark.app-button--flat{background:#374a68}.app-button--dark.app-button--default{background:transparent}.app-button--dark.app-button--outline{background:transparent;border:1px solid #374a68;transition:border-color .12s}.app-button--dark.app-button--outline:hover{border-color:#96a8c0}.app-button--dark.app-button--outline:hover:after{background-color:transparent;display:none}.app-button--dark.app-button--text{background:transparent;color:#d7e0ea}.app-button--dark.app-button--text:hover{color:#fff}.app-button--dark.app-button--text:hover:after{display:none}.app-button--dark.app-button--selected{background-color:#2d72dc;color:#fff}.app-button--dark.app-button--selected:hover:after{display:none}.app-button--light{color:#283853}.app-button--light:hover{color:#1c2a3f}.app-button--light:after{background-color:#96a8c0}.app-button--light:not(.app-button--disabled):hover:after{opacity:.6}.app-button--light::-moz-focus-inner{border:0}.app-button--light:not([disabled]):hover{cursor:pointer}.app-button--light[disabled]{pointer-events:none}.app-button--light.app-button--flat{background:#d7e0ea;font-weight:500}.app-button--light.app-button--flat.app-button--selected{background-color:#96a8c0}.app-button--light.app-button--default{background:transparent;color:#131c2a}.app-button--light.app-button--default:not(.app-button--disabled):hover:after{opacity:.2}.app-button--light.app-button--outline{background:transparent;border:1px solid #96a8c0;color:#283853;transition:border-color .12s}.app-button--light.app-button--outline:after{display:none}.app-button--light.app-button--outline:hover{background:rgba(55,74,104,.05);border-color:#374a68;color:#1c2a3f}.app-button--light.app-button--outline:hover:after{background-color:transparent}.app-button--light.app-button--selected{background-color:#eaeff5}.app-button--light.app-button--selected:hover:after{display:none}.app-button--light.app-button--text{color:#283853}.app-button--light.app-button--text:hover{color:#1c2a3f}.app-button--light.app-button--text:hover:after{display:none}.app-button.app-button--primary{background:#de3535;color:#fff}.app-button.app-button--primary:after{background:#f9fafd}.app-button.app-button--primary:hover:after{opacity:.1}.app-button.app-button--white{background:#fff;color:#283853;transition:border-color .12s}.app-button.app-button--white:hover{border-color:#96a8c0}.app-button.app-button--white:hover:after{background-color:#131c2a;display:none}.app-button.app-button--info{background:#2d72dc;color:#fff}.app-button.app-button--info:after{background:#f9fafd}.app-button.app-button--info:hover:after{opacity:.1}.app-button--selected{background-color:#2d72dc}.app-button--disabled:not(.app-button--loading){opacity:.5}.app-button--loading{background-color:#eaeff5!important;color:#61779e!important}.app-button--circle{border-radius:50%}.app-button--circle.app-button--xsmall{width:24px}.app-button--circle.app-button--small{width:32px;padding:0 6px}.app-button--circle.app-button--medium{width:36px;padding:0 8px}.app-button--circle.app-button--large{width:48px}.app-button--circle:after{border-radius:50%}.app-button--square{padding:0}.app-button--square.app-button--xsmall{width:24px;height:24px}.app-button--square.app-button--small{width:32px;height:32px}.app-button--square.app-button--medium{width:36px;height:36px}.app-button--square.app-button--large{width:48px;height:48px}.app-button--rounded,.app-button--rounded:after{border-radius:18px}'],encapsulation:2,changeDetection:0}),e})();var gd=n("STbY"),hd=function(e){return e.All="all",e.iOS="ios",e.Android="android",e}({});let bd=(()=>{class e{constructor(e,t,n){this.templateRef=e,this.viewContainer=t,this.router=n,this._appFlagApplicationMode="include"}get appFlagApplication(){return this._appFlagApplication}set appFlagApplication(e){this._appFlagApplication=e}get appFlagApplicationMode(){return this._appFlagApplicationMode}set appFlagApplicationMode(e){this._appFlagApplicationMode=e}get appFlagApplicationPage(){return this._appFlagApplicationPage}set appFlagApplicationPage(e){this._appFlagApplicationPage=e}get appFlagApplicationPlatform(){return this._appFlagApplicationPlatform}set appFlagApplicationPlatform(e){this._appFlagApplicationPlatform=e}get appFlagApplicationNative(){return this._appFlagApplicationNative}set appFlagApplicationNative(e){this._appFlagApplicationNative=e}ngOnInit(){this.update()}update(){let e=!1,t=!1,n=!1,i=!1,s=!1;if(""===this.appFlagApplication?t=!0:Array.isArray(this.appFlagApplication)?t=this.appFlagApplication.some(e=>e===c.application):"string"==typeof this.appFlagApplication&&(t=this.appFlagApplication===c.application),null==this.appFlagApplicationPage)n=!0;else{const e=this.router.url;Array.isArray(this.appFlagApplicationPage)?n=this.appFlagApplicationPage.some(t=>e.indexOf(t)>=0):"string"==typeof this.appFlagApplicationPage&&(n=e.indexOf(this.appFlagApplicationPage)>=0)}if(null==this.appFlagApplicationPlatform)i=!0;else{const e=c.platform;Array.isArray(this.appFlagApplicationPlatform)?i=this.appFlagApplicationPlatform.some(t=>e.indexOf(t)>=0):"string"==typeof this.appFlagApplicationPlatform&&(i=e.indexOf(this.appFlagApplicationPlatform)>=0)}null==this.appFlagApplicationNative?s=!0:(s=c.native,(Array.isArray(this.appFlagApplicationNative)?this.appFlagApplicationNative:[this.appFlagApplicationNative]).includes(hd.iOS)&&(s=c.native&&void 0!==window.webkit)),e=t&&n&&i&&s,e&&"include"===this.appFlagApplicationMode||!e&&"exclude"===this.appFlagApplicationMode?this.viewContainer.createEmbeddedView(this.templateRef):this.viewContainer.clear()}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(i.O),i.Pb(i.S),i.Pb(T.e))},e.\u0275dir=i.Kb({type:e,selectors:[["","appFlagApplication",""]],inputs:{appFlagApplication:"appFlagApplication",appFlagApplicationMode:"appFlagApplicationMode",appFlagApplicationPage:"appFlagApplicationPage",appFlagApplicationPlatform:"appFlagApplicationPlatform",appFlagApplicationNative:"appFlagApplicationNative"}}),e})();var md=n("f0Cb");const fd=["nodeActionsTrigger"];function yd(e,t){if(1&e&&(i.Tb(0),i.Vb(1,"button",30),i.Kc(2,"Select"),i.Ub(),i.Qb(3,"mat-divider"),i.Sb()),2&e){i.gc();const e=i.tc(24);i.Db(1),i.lc("matMenuTriggerFor",e)}}function xd(e,t){if(1&e&&(i.Tb(0),i.Qb(1,"mat-divider"),i.Vb(2,"button",31),i.Kc(3," Selectable / Unselectable "),i.Ub(),i.Sb()),2&e){i.gc();const e=i.tc(43);i.Db(2),i.lc("matMenuTriggerFor",e)}}function vd(e,t){if(1&e){const e=i.Wb();i.Tb(0),i.Qb(1,"mat-divider"),i.Vb(2,"button",32),i.cc("click",(function(){i.xc(e);const t=i.gc();return t.editNodeLabel(t.node)})),i.Kc(3," Edit Object Name "),i.Ub(),i.Sb()}}function Od(e,t){if(1&e&&(i.Tb(0),i.Qb(1,"mat-divider"),i.Vb(2,"button",33),i.Kc(3," Copy "),i.Ub(),i.Sb()),2&e){i.gc();const e=i.tc(50);i.Db(2),i.lc("matMenuTriggerFor",e)}}function wd(e,t){if(1&e){const e=i.Wb();i.Tb(0),i.Qb(1,"mat-divider"),i.Vb(2,"button",34),i.cc("click",(function(){i.xc(e);const t=i.gc();return t.samplePaint(t.node)})),i.Kc(3," Sample Paint "),i.Ub(),i.Sb()}}function Cd(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",35),i.cc("click",(function(){i.xc(e);const t=i.gc();return t.toggleVisible(t.node,!0)})),i.Kc(1," Show This "),i.Ub()}}function Sd(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",36),i.cc("click",(function(){i.xc(e);const t=i.gc();return t.toggleVisible(t.node,!1)})),i.Kc(1," Hide This "),i.Ub()}}function _d(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",37),i.cc("click",(function(){i.xc(e);const t=i.gc();return t.togglePickable(t.node,!1)})),i.Kc(1," Make Unselectable "),i.Ub()}}function jd(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",38),i.cc("click",(function(){i.xc(e);const t=i.gc();return t.togglePickable(t.node,!0)})),i.Kc(1," Make Selectable "),i.Ub()}}let kd=(()=>{class e{constructor(e,t,n,o,r,a,c,l){this.store=e,this.graphService=t,this.changeDetectorRef=n,this.clipboardService=o,this.snackbar=r,this.cameraService=a,this.engineService=c,this.liveAnnouncer=l,this.application=s,this.shortId="",this.theme="dark",this.eventCategory="",this.nodeActionsClosed=new i.p}get node(){return this._node}set node(e){this._node=e;const t=this.node.id.split("-");this.shortId=2===t.length?t[1]:t[0]}isNodeChecked(e){return this.store.selectSnapshot(Bi.getNodes)[e].checked}isNodeShown(e){return this.store.selectSnapshot(Bi.getNodes)[e].shown}checkNode(e,t){const n=void 0===t?!this.isNodeChecked(e.id):t;this.store.dispatch(new Ii.UpdateNodesChecked(n,[e.id]))}checkInverse(e){this.store.dispatch(new Ii.UpdateNodesChecked(!0)),this.store.dispatch(new Ii.UpdateNodesChecked(!1,[e.id]))}setCheckedNodes(e,t){this.store.dispatch(new Ii.UpdateNodesChecked(!1));const n=void 0===t?!this.isNodeChecked(e.id):t;this.store.dispatch(new Ii.UpdateNodesChecked(n,[e.id]))}flyToNode(e){this.store.dispatch(new Je(e.id)).subscribe(()=>{this.liveAnnouncer.announce("Fly to complete")})}hideNode(e){this.store.dispatch(new Ii.UpdateNodesShown(!1,[e.id]))}hideInverse(e){const t=this.store.selectSnapshot(Er.getViewGraph),n=this.graphService.getAllLeafDescendants(t,[e.id]),i=this.graphService.getInverseSelection(t,[e.id]),s={};n.forEach(e=>{s[e]=!0}),i.forEach(e=>{s[e]=!1});const o=new Ii.UpdateNodesShown(void 0,void 0,s),r=Ui(this.store.selectSnapshot(Bi),o);this.store.dispatch(new Ii.ApplyPatch(r.patches));const a=this.engineService.getObjectBoundary(e.id),c=this.cameraService.cameraAfterFlyTo(a),l=new gn(c),p=function(e,t){const[n,i,s]=immer.produceWithPatches(e,e=>{e.cameraFlyTo=t.camera});return{nextState:n,patches:i,inversePatches:s}}(this.store.selectSnapshot(jr),l);this.store.dispatch(new hn(p.patches)).subscribe(()=>{this.liveAnnouncer.announce("Isolate complete")}),this.store.dispatch(new Ii.UpdateNodeSelected),this.store.dispatch(new Ii.UpdateNodesChecked(!1)),this.store.dispatch(new zi.SavePatches([{forward:r.patches,inverse:r.inversePatches,patchAction:Ii.ApplyPatch},{forward:p.patches,inverse:p.inversePatches,patchAction:hn}]))}showNode(e){this.store.dispatch(new Ii.UpdateNodesShown(!0,[e.id])),this.changeDetectorRef.markForCheck()}toggleVisible(e,t){const n=void 0===t?this.isNodeShown(e.id):t;this.store.dispatch(new Ii.UpdateNodesShown(n,[e.id])).subscribe(()=>{this.liveAnnouncer.announce("Object "+(n?"shown":"hidden"))}),this.changeDetectorRef.markForCheck()}togglePickable(e,t){this.store.dispatch(new Ii.UpdateNodesPickable(t,[e.id])),this.changeDetectorRef.markForCheck()}makeEverythingElseUnpickale(e){this.store.dispatch(new Ii.UpdateNodesPickable(!1)),this.store.dispatch(new Ii.UpdateNodesPickable(!0,[e.id]))}fadeInverseNodes(e){const t=this.store.selectSnapshot(Er.getViewGraph),n=this.graphService.getInverseSelection(t,[e.id]),i=this.graphService.getNodes(t,n);this.store.dispatch(new Ii.UpdateNodesPaint($i,i.map(e=>e.id))).subscribe(()=>{})}fadeNode(e){this.store.dispatch(new Ii.UpdateNodesPaint($i,[e.id])).subscribe(()=>{this.liveAnnouncer.announce("Fade complete")})}editNodeLabel(e){this.store.dispatch(new jt(e))}copy(e){this.clipboardService.copyToClipboard(e,"text").subscribe(()=>{this.snackbar.open(`Copied ${e} to clipboard.`)})}onMenuClosed(){this.nodeActionsClosed.emit()}samplePaint(e){const t=this.store.selectSnapshot(Bi.getNodePaint)(e.id),n=Fi.toEngine(t);qi.isRealRecipe(n)?this.store.dispatch(new Ip(t)):this.store.dispatch(new Tp),this.store.dispatch(new ot(kr.Paint)),this.store.dispatch(new Qp(nd.Paint))}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.g),i.Pb(Et),i.Pb(i.i),i.Pb(Mp),i.Pb(id.b),i.Pb(yn),i.Pb(Qt),i.Pb(Tl.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-node-actions"]],viewQuery:function(e,t){if(1&e&&i.Ec(fd,!0),2&e){let e;i.sc(e=i.dc())&&(t.nodeActionsTrigger=e.first)}},inputs:{node:"node",theme:"theme",eventCategory:"eventCategory"},outputs:{nodeActionsClosed:"nodeActionsClosed"},decls:58,vars:25,consts:[["app-button","","data-test","nodeActionsTrigger","buttonSize","xsmall",3,"buttonTheme","matMenuTriggerFor","menuClosed"],["nodeActionsTrigger","matMenuTrigger"],["icon","ellipsis-v","aria-hidden","true"],[1,"visually-hidden"],[3,"overlapTrigger"],["nodeActions","matMenu"],[4,"appFlagApplication","appFlagApplicationPage","appFlagApplicationMode"],["mat-menu-item","","data-test","nodeActionsHideShow",3,"click"],["mat-menu-item","","data-test","nodeActionsIsolate",3,"click"],["data-test","nodeActionsFadeTrigger","mat-menu-item","",3,"matMenuTriggerFor"],[4,"appFlagApplication","appFlagApplicationMode","appFlagApplicationPage"],["mat-menu-item","","data-test","nodeActionsFlyTo",3,"click"],["selectActions","matMenu"],["mat-menu-item","","data-test","nodeActionsSelectThis",3,"click"],["mat-menu-item","","data-test","nodeActionsSelectEverythingElse",3,"click"],["fadeActions","matMenu"],["mat-menu-item","","data-test","nodeActionsFadeThis",3,"click"],["mat-menu-item","","data-test","nodeActionsFadeEverythingElse",3,"click"],["showHideActions","matMenu"],["mat-menu-item","","data-test","nodeActionsShowThis",3,"click",4,"ngIf"],["mat-menu-item","","data-test","nodeActionsShowEverythingElse",3,"click",4,"ngIf"],["mat-menu-item","",3,"click"],["pickableActions","matMenu"],["mat-menu-item","","data-test","nodeActionsPickable",3,"click",4,"ngIf"],["mat-menu-item","","data-test","nodeActionsUnpickable",3,"click",4,"ngIf"],["mat-menu-item","","data-test","nodeActionsEverythingElseUnpickable",3,"click"],["copyActions","matMenu"],["mat-menu-item","","data-test","nodeActionsCopyShortID",3,"click"],["mat-menu-item","","data-test","nodeActionsCopyFullID",3,"click"],["mat-menu-item","","data-test","nodeActionsCopyDisplayName",3,"click"],["mat-menu-item","",3,"matMenuTriggerFor"],["mat-menu-item","","data-test","nodeActionsPickableTrigger",3,"matMenuTriggerFor"],["mat-menu-item","","data-test","nodeActionsEditName",3,"click"],["mat-menu-item","","data-test","nodeActionsCopyTrigger",3,"matMenuTriggerFor"],["mat-menu-item","","data-test","nodeActionsSamplePaint",3,"click"],["mat-menu-item","","data-test","nodeActionsShowThis",3,"click"],["mat-menu-item","","data-test","nodeActionsShowEverythingElse",3,"click"],["mat-menu-item","","data-test","nodeActionsPickable",3,"click"],["mat-menu-item","","data-test","nodeActionsUnpickable",3,"click"]],template:function(e,t){if(1&e&&(i.Tb(0),i.Vb(1,"button",0,1),i.cc("menuClosed",(function(){return t.onMenuClosed()})),i.Qb(3,"app-icon",2),i.Vb(4,"span",3),i.Kc(5),i.Ub(),i.Ub(),i.Vb(6,"mat-menu",4,5),i.Ic(8,yd,4,1,"ng-container",6),i.Vb(9,"button",7),i.cc("click",(function(){return t.toggleVisible(t.node,!t.node.boolState.shown)})),i.Kc(10),i.Ub(),i.Vb(11,"button",8),i.cc("click",(function(){return t.hideInverse(t.node)})),i.Kc(12," Isolate "),i.Ub(),i.Qb(13,"mat-divider"),i.Vb(14,"button",9),i.Kc(15," Fade "),i.Ub(),i.Ic(16,xd,4,1,"ng-container",10),i.Qb(17,"mat-divider"),i.Vb(18,"button",11),i.cc("click",(function(){return t.flyToNode(t.node)})),i.Kc(19,"Fly To"),i.Ub(),i.Ic(20,vd,4,0,"ng-container",6),i.Ic(21,Od,4,1,"ng-container",6),i.Ic(22,wd,4,0,"ng-container",6),i.Ub(),i.Vb(23,"mat-menu",null,12),i.Vb(25,"button",13),i.cc("click",(function(){return t.checkNode(t.node,!0)})),i.Kc(26," Select This "),i.Ub(),i.Vb(27,"button",14),i.cc("click",(function(){return t.checkInverse(t.node)})),i.Kc(28," Select Everything Else "),i.Ub(),i.Ub(),i.Vb(29,"mat-menu",null,15),i.Vb(31,"button",16),i.cc("click",(function(){return t.fadeNode(t.node)})),i.Kc(32," Fade This "),i.Ub(),i.Vb(33,"button",17),i.cc("click",(function(){return t.fadeInverseNodes(t.node)})),i.Kc(34," Fade Everything Else "),i.Ub(),i.Ub(),i.Vb(35,"mat-menu",null,18),i.Ic(37,Cd,2,0,"button",19),i.Ic(38,Sd,2,0,"button",20),i.Qb(39,"mat-divider"),i.Vb(40,"button",21),i.cc("click",(function(){return t.hideInverse(t.node)})),i.Kc(41,"Hide Everything Else"),i.Ub(),i.Ub(),i.Vb(42,"mat-menu",null,22),i.Ic(44,_d,2,0,"button",23),i.Ic(45,jd,2,0,"button",24),i.Qb(46,"mat-divider"),i.Vb(47,"button",25),i.cc("click",(function(){return t.makeEverythingElseUnpickale(t.node)})),i.Kc(48," Make Everything Else Unselectable "),i.Ub(),i.Ub(),i.Vb(49,"mat-menu",null,26),i.Vb(51,"button",27),i.cc("click",(function(){return t.copy(t.shortId)})),i.Kc(52," Copy Short ID "),i.Ub(),i.Vb(53,"button",28),i.cc("click",(function(){return t.copy(t.node.id)})),i.Kc(54," Copy Full ID "),i.Ub(),i.Qb(55,"mat-divider"),i.Vb(56,"button",29),i.cc("click",(function(){return t.copy(t.node.label)})),i.Kc(57," Copy Display Name "),i.Ub(),i.Ub(),i.Sb()),2&e){const e=i.tc(7),n=i.tc(30);i.Db(1),i.lc("buttonTheme",t.theme)("matMenuTriggerFor",e),i.Db(4),i.Mc("",t.node.label," menu"),i.Db(1),i.lc("overlapTrigger",!0),i.Db(2),i.lc("appFlagApplication",t.application.All)("appFlagApplicationPage","/edit")("appFlagApplicationMode","include"),i.Db(2),i.Mc(" ",t.node.boolState.shown?"Hide":"Show"," "),i.Db(4),i.lc("matMenuTriggerFor",n),i.Db(2),i.lc("appFlagApplication",t.application.All)("appFlagApplicationMode","include")("appFlagApplicationPage","/edit"),i.Db(4),i.lc("appFlagApplication",t.application.Loft)("appFlagApplicationPage","/edit")("appFlagApplicationMode","include"),i.Db(1),i.lc("appFlagApplication",t.application.Loft)("appFlagApplicationPage","/edit")("appFlagApplicationMode","include"),i.Db(1),i.lc("appFlagApplication",t.application.All)("appFlagApplicationPage","/edit")("appFlagApplicationMode","include"),i.Db(15),i.lc("ngIf",!t.node.boolState.shown),i.Db(1),i.lc("ngIf",t.node.boolState.shown),i.Db(6),i.lc("ngIf",t.node.boolState.pickable),i.Db(1),i.lc("ngIf",!t.node.boolState.pickable)}},directives:[ud,gd.d,dl,gd.a,bd,gd.b,md.a,Z.l],styles:[""],changeDetection:0}),e})();var Pd=n("lR5k"),Md=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Id(e,t){if(1&e&&i.Qb(0,"app-node-actions",9),2&e){const e=i.gc(2);i.lc("node",e.node)}}function zd(e,t){if(1&e&&(i.Vb(0,"div",7),i.jc(1),i.Ic(2,Id,1,1,"app-node-actions",8),i.Ub()),2&e){const e=i.gc();i.Db(2),i.lc("ngIf",e.enableActions)}}function Td(e,t){if(1&e&&(i.Vb(0,"i",10),i.Kc(1),i.Ub()),2&e){const e=i.gc();i.Db(1),i.Mc(" ",e.node.info.latinLabel," ")}}function Ud(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",11),i.cc("click",(function(){return i.xc(e),i.gc().handleReadMoreClick()})),i.Kc(1," Read More "),i.Ub()}2&e&&i.lc("@show",void 0)}const Dd=["*"];let Ld=(()=>{class e{constructor(e,t,n,i,s){this.store=e,this.actions=t,this.engineService=n,this.viewService=i,this.changeDetectorRef=s,this.ngUnsubscribe=new k.a}set label(e){this._label=e,this.setLabelNode()}get label(){return this._label}ngOnInit(){this.initInfoListeners()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}setLabelNode(){const e=Object(D.get)(this.label,"objectId");if(e){const t=this.store.selectSnapshot(Er.getViewGraph);this.node=this.engineService.getNode(t,e)}else this.node=null;this.changeDetectorRef.markForCheck()}initInfoListeners(){this.actions.pipe(Object(d.i)(kt),Object(M.a)(this.ngUnsubscribe)).subscribe(()=>{this.setLabelNode()})}handleReadMoreClick(){this.node&&this.viewService.toggleNodeInfo(!0)}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.g),i.Pb(d.b),i.Pb(Qt),i.Pb(Dl),i.Pb(i.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-context-label"]],inputs:{label:"label",enableInfo:"enableInfo",enableActions:"enableActions"},ngContentSelectors:Dd,decls:8,vars:9,consts:[[1,"context-label",3,"label"],["label-header","",1,"context-label__header","html",3,"innerHTML"],["title",""],["class","context-label__actions","label-actions","",4,"ngIf"],["label-more",""],["class","context-label__latin",4,"ngIf"],["type","button","app-button","","buttonTheme","light","buttonSize","xsmall","class","context-label__more",3,"click",4,"ngIf"],["label-actions","",1,"context-label__actions"],["eventCategory","Context Node","theme","light",3,"node",4,"ngIf"],["eventCategory","Context Node","theme","light",3,"node"],[1,"context-label__latin"],["type","button","app-button","","buttonTheme","light","buttonSize","xsmall",1,"context-label__more",3,"click"]],template:function(e,t){1&e&&(i.kc(),i.Vb(0,"app-generic-label",0),i.Qb(1,"div",1,2),i.hc(3,"markdown"),i.Ic(4,zd,3,1,"div",3),i.Tb(5,4),i.Ic(6,Td,2,1,"i",5),i.Ic(7,Ud,2,1,"button",6),i.Sb(),i.Ub()),2&e&&(i.Hb("context-label--more",t.enableInfo&&t.node&&t.node.info),i.lc("label",t.label),i.Db(1),i.lc("innerHTML",i.ic(3,7,t.label.title),i.yc),i.Db(3),i.lc("ngIf",t.node),i.Db(2),i.lc("ngIf",t.node&&(null==t.node.info?null:t.node.info.latinLabel)),i.Db(1),i.lc("ngIf",t.enableInfo&&t.node&&t.node.info))},directives:[Pp,Z.l,kd,ud],pipes:[Pd.b],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.context-label__latin[_ngcontent-%COMP%], .text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.context-label[_ngcontent-%COMP%]{z-index:12}.context-label__actions[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}.context-label__action[_ngcontent-%COMP%]{cursor:pointer}.context-label__action--selected[_ngcontent-%COMP%]{color:#2d72dc}.context-label__header[_ngcontent-%COMP%]{margin-left:4px}.context-label__latin[_ngcontent-%COMP%]{display:block;margin-left:4px}.context-label__latin[_ngcontent-%COMP%], .context-label__more[_ngcontent-%COMP%]{margin-bottom:4px;font-size:10px;letter-spacing:.25px;line-height:1.4em}.context-label__more[_ngcontent-%COMP%]{margin-left:-4px;margin-top:4px}.context-label--more[_ngcontent-%COMP%]   .context-label__actions[_ngcontent-%COMP%], .context-label--more[_ngcontent-%COMP%]   .context-label__header[_ngcontent-%COMP%]{margin-top:4px}"],data:{animation:[Object(Zl.n)("show",[Object(Zl.m)(":enter",[Object(Zl.j)([Object(Zl.l)({height:"0"}),Object(Zl.e)("125ms ease-in-out",Object(Zl.l)({height:"*"}))])])])]},changeDetection:0}),function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);o>3&&r&&Object.defineProperty(t,n,r)}([Object(d.d)(Er.getQuerying),Md("design:type",P.a)],e.prototype,"querying$",void 0),e})();var Ed=function(e){return e.Normal="normal",e.Compact="compact",e}({}),Fd=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},Ad=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const Rd=["image"],Vd=["imagePre"],Nd=["imagePost"],Bd=["imageContainer"];function Hd(e,t){if(1&e&&(i.Qb(0,"span",8),i.hc(1,"markdown")),2&e){const e=i.gc();i.lc("innerHTML",i.ic(1,1,e.label),i.yc)}}function Qd(e,t){if(1&e&&i.Qb(0,"img",9,10),2&e){const e=i.gc();i.lc("src",e.imageUrl,i.Ac)}}function $d(e,t){if(1&e&&i.Qb(0,"img",11,12),2&e){const e=i.gc();i.lc("src",e.imageUrl,i.Ac)}}let qd=(()=>{class e{constructor(e,t,n){this.renderer=e,this.engineService=t,this.animationService=n,this.ngUnsubscribe=new k.a,this.loopImage=!1}ngOnInit(){this.initChapterListener(),this.initTimelineListener()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initChapterListener(){this.selectedChapterId$.pipe(Object(I.a)(e=>null!=e),Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.timerange=this.animationService.getChapterLocalTimerange(e)})}initTimelineListener(){Object(Do.a)(this.engineService.getEvent(At.TimelineScrubbed),this.engineService.getEvent(At.TimelinePlaying)).pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{const t=this.getChapterPercent(e.time);this.moveImage(t)})}moveImage(e){const t=this.image.nativeElement.getBoundingClientRect().width;this.renderer.setStyle(this.imageContainer.nativeElement,"transform",`translate(${e/100*-t}px, 0)`),this.loopImage&&(this.renderer.setStyle(this.imagePre.nativeElement,"transform",`translate(${-t}px, 0)`),this.renderer.setStyle(this.imagePost.nativeElement,"transform",`translate(${t}px, 0)`))}getChapterPercent(e){const{firstTime:t,lastTime:n}=this.timerange,i=this.animationService.mapGlobalTimeToLocal(e).time;return Math.max(t,Math.min(i,n))/n*100}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(i.H),i.Pb(Qt),i.Pb(eo))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-ticker-block-item"]],viewQuery:function(e,t){if(1&e&&(i.Ec(Rd,!0),i.Pc(Vd,!0),i.Pc(Nd,!0),i.Ec(Bd,!0)),2&e){let e;i.sc(e=i.dc())&&(t.image=e.first),i.sc(e=i.dc())&&(t.imagePre=e.first),i.sc(e=i.dc())&&(t.imagePost=e.first),i.sc(e=i.dc())&&(t.imageContainer=e.first)}},inputs:{label:"label",imageUrl:"imageUrl",loopImage:"loopImage"},decls:8,vars:4,consts:[[1,"ticker-block-item"],["class","ticker-block-item__label html",3,"innerHTML",4,"ngIf"],[1,"ticker-block__image-container"],["imageContainer",""],["class","ticker-block-item__image ticker-block-item__image--pre",3,"src",4,"ngIf"],["class","ticker-block-item__image ticker-block-item__image--post",3,"src",4,"ngIf"],[1,"ticker-block-item__image",3,"src"],["image",""],[1,"ticker-block-item__label","html",3,"innerHTML"],[1,"ticker-block-item__image","ticker-block-item__image--pre",3,"src"],["imagePre",""],[1,"ticker-block-item__image","ticker-block-item__image--post",3,"src"],["imagePost",""]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Ic(1,Hd,2,3,"span",1),i.Vb(2,"div",2,3),i.Ic(4,Qd,2,1,"img",4),i.Ic(5,$d,2,1,"img",5),i.Qb(6,"img",6,7),i.Ub(),i.Ub()),2&e&&(i.Db(1),i.lc("ngIf",t.label),i.Db(3),i.lc("ngIf",t.loopImage),i.Db(1),i.lc("ngIf",t.loopImage),i.Db(1),i.lc("src",t.imageUrl,i.Ac))},directives:[Z.l],pipes:[Pd.b],styles:['.ticker-block-item[_ngcontent-%COMP%]{background:#f9fafd;background:linear-gradient(90deg,#f9fafd 20%,hsla(0,0%,100%,0) 40%,#fff 60%,#f9fafd 80%);overflow:hidden;padding-left:50%;position:relative}.ticker-block-item[_ngcontent-%COMP%]:hover   .ticker-block-item__label[_ngcontent-%COMP%]{background:hsla(0,0%,100%,.9)}.ticker-block-item[_ngcontent-%COMP%]:after{content:"";display:block;position:absolute;left:50%;top:0;height:100%;width:1px;background:red;box-shadow:0 0 0 4px rgba(255,0,0,.2);z-index:10}.ticker-block-item__label[_ngcontent-%COMP%]{position:absolute;z-index:10;left:4px;top:4px;border-radius:8px;padding:2px 6px;font-size:12px;border:1px solid rgba(16,24,35,.5);background:hsla(0,0%,100%,.55)}.ticker-block-item__image-container[_ngcontent-%COMP%]{position:relative}.ticker-block-item__image[_ngcontent-%COMP%]{display:block}.ticker-block-item__image--post[_ngcontent-%COMP%], .ticker-block-item__image--pre[_ngcontent-%COMP%]{position:absolute;top:0;left:0}'],changeDetection:0}),Fd([Object(d.d)(Er.getAnimationPlaying),Ad("design:type",P.a)],e.prototype,"animationPlaying$",void 0),Fd([Object(d.d)(Or.getSelectedChapterId),Ad("design:type",P.a)],e.prototype,"selectedChapterId$",void 0),e})();function Wd(e,t){if(1&e&&i.Qb(0,"app-ticker-block-item",3),2&e){const e=t.$implicit,n=i.gc(2);i.lc("imageUrl",e.urls.default)("label",e.caption)("loopImage",n.tickerBlock.loopImage)}}function Kd(e,t){if(1&e&&(i.Vb(0,"div",1),i.Ic(1,Wd,1,3,"app-ticker-block-item",2),i.Ub()),2&e){const e=i.gc();i.Db(1),i.lc("ngForOf",e.tickerBlock.images)}}let Gd=(()=>{class e{constructor(){this.ngUnsubscribe=new k.a}ngOnInit(){}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-ticker-block"]],inputs:{tickerBlock:"tickerBlock"},decls:1,vars:1,consts:[["class","ticker-block",4,"ngIf"],[1,"ticker-block"],[3,"imageUrl","label","loopImage",4,"ngFor","ngForOf"],[3,"imageUrl","label","loopImage"]],template:function(e,t){1&e&&i.Ic(0,Kd,2,1,"div",0),2&e&&i.lc("ngIf",t.tickerBlock)},directives:[Z.l,Z.k,qd],styles:[""],changeDetection:0}),e})(),Zd=(()=>{class e{constructor(e,t){this.domSanitizer=e,this.markdownService=t}set html(e){this.safeHTML=this.domSanitizer.bypassSecurityTrustHtml(e||"")}set markdownText(e){this.html=this.markdownService.compile(e,!0)}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(l.b),i.Pb(Pd.c))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-html"]],inputs:{html:"html",markdownText:"markdownText"},decls:1,vars:1,consts:[[1,"html",3,"innerHTML"]],template:function(e,t){1&e&&i.Qb(0,"div",0),2&e&&i.lc("innerHTML",t.safeHTML,i.yc)},styles:[""],encapsulation:2,changeDetection:0}),e})(),Jd=(()=>{class e{constructor(){this.layout=Ed.Normal}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-markdown-block"]],inputs:{markdownBlock:"markdownBlock",layout:"layout"},decls:2,vars:1,consts:[[1,"markdown-block"],[3,"markdownText"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Qb(1,"app-html",1),i.Ub()),2&e&&(i.Db(1),i.lc("markdownText",t.markdownBlock.markdown))},directives:[Zd],styles:[""],encapsulation:2,changeDetection:0}),e})();function Xd(e,t){if(1&e&&i.Qb(0,"app-icon",5),2&e){const e=i.gc();i.lc("icon",e.icon)}}function Yd(e,t){if(1&e&&i.Qb(0,"span",6),2&e){const e=i.gc();i.Fc("background-image","url("+e.src+")")}}function eu(e,t){if(1&e&&(i.Vb(0,"span",7),i.Kc(1),i.Ub()),2&e){const e=i.gc();i.Db(1),i.Mc(" ",e.label," ")}}const tu=function(e,t,n,i,s,o,r,a,c,l,p,d,u,g,h,b,m){return{"pin-button--selected":e,"pin-button--disabled":t,"pin-button--small":n,"pin-button--medium":i,"pin-button--large":s,"pin-button--ghost":o,"pin-button--primary":r,"pin-button--secondary":a,"pin-button--outline":c,"pin-button--floating":l,"pin-button--dark":p,"pin-button--row":d,"pin-button--circle":u,"pin-button--square":g,"pin-button--rounded":h,"pin-button--fill":b,"pin-button--left":m}},nu=["*"];var iu=function(e){return e.Circle="circle",e.Rounded="rounded",e.Square="square",e}({}),su=function(e){return e.Left="left",e.Center="center",e}({});let ou=(()=>{class e{constructor(e){this.elRef=e,this.selectable=!1,this.size="medium",this.buttonType="default",this.buttonShape=iu.Circle,this.buttonAlign=su.Center,this.direction="column",this.fill=!1,this._selected=!1,this.disabled=!1,this.selectedChange=new i.p}get selected(){return this._selected}set selected(e){this._selected=e,this.selectedChange=new i.p}ngOnInit(){}handleClick(){this.disabled||this.selectable&&(this.selected=!this.selected)}focus(e){this.elRef&&this.elRef.nativeElement.focus()}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(i.m))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-pin-button"],["button","app-pin-button",""]],inputs:{icon:"icon",src:"src",description:"description",label:"label",selectable:"selectable",size:"size",buttonType:"buttonType",buttonShape:"buttonShape",buttonAlign:"buttonAlign",direction:"direction",fill:"fill",selected:"selected",disabled:"disabled"},outputs:{selectedChange:"selectedChange"},ngContentSelectors:nu,decls:6,vars:22,consts:[[1,"pin-button",3,"ngClass","click"],[1,"pin-button__pin"],["style","font-size: 14px !important",3,"icon",4,"ngIf"],["class","pin-button__image",3,"backgroundImage",4,"ngIf"],["class","pin-button__label",4,"ngIf"],[2,"font-size","14px !important",3,"icon"],[1,"pin-button__image"],[1,"pin-button__label"]],template:function(e,t){1&e&&(i.kc(),i.Vb(0,"span",0),i.cc("click",(function(){return t.handleClick()})),i.Vb(1,"span",1),i.Ic(2,Xd,1,1,"app-icon",2),i.Ic(3,Yd,1,2,"span",3),i.jc(4),i.Ub(),i.Ic(5,eu,2,1,"span",4),i.Ub()),2&e&&(i.lc("ngClass",i.rc(4,tu,[t.selected,t.disabled,"small"===t.size,"medium"===t.size,"large"===t.size,"ghost"===t.buttonType,"primary"===t.buttonType,"secondary"===t.buttonType,"outline"===t.buttonType,"floating"===t.buttonType,"dark"===t.buttonType,"row"===t.direction,"circle"==t.buttonShape,"square"==t.buttonShape,"rounded"==t.buttonShape,t.fill,"left"===t.buttonAlign])),i.Db(2),i.lc("ngIf",t.icon),i.Db(1),i.lc("ngIf",t.src),i.Db(2),i.lc("ngIf",t.label))},directives:[Z.i,Z.l,dl],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3535}.text-info{color:#2d72dc}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}button[app-pin-button]{border-color:transparent;background:none;border-width:0;padding:0;outline:none;margin:0;pointer-events:all}button[app-pin-button]::-moz-focus-inner{border:0}button[app-pin-button]:not([disabled]):hover{cursor:pointer}button[app-pin-button]:focus .pin-button__pin{outline:2px solid #fff;outline-offset:-4px}button[app-pin-button]:focus :not(.pin-button--selected) .pin-button__pin{outline:2px solid #2d72dc!important;outline-offset:-2px}button[app-pin-button]:focus :not(.pin-button--selected).pin-button--dark .pin-button__pin{background-color:#61779e!important}button[app-pin-button]:focus .pin-button--secondary .pin-button__pin{outline:2px solid #fff;outline-offset:-4px}button[app-pin-button][disabled]{pointer-events:none}.pin-button{display:inline-flex;flex-flow:column;align-items:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-tap-highlight-color:rgba(0,0,0,0);-webkit-tap-highlight-color:transparent}.pin-button:hover{cursor:pointer}.pin-button:hover:not(.pin-button--selected):not(.pin-button--disabled) .pin-button__pin{background:rgba(215,224,234,.6)}.pin-button:not(.pin-button--selected):active:hover .pin-button__pin{background:#d7e0ea}.pin-button--selected .pin-button__pin{background-color:#2d72dc;color:#fff}.pin-button--selected .pin-button__label{color:#2d72dc;font-weight:600}.pin-button--small .pin-button__pin{border-radius:14px;min-width:28px;height:28px}.pin-button--small .pin-button__label{margin-top:0}.pin-button--large .pin-button__pin{font-size:20px;letter-spacing:.5px;line-height:1.4em}.pin-button--left .pin-button__pin{justify-content:flex-start}.pin-button--row{flex-direction:row}.pin-button--row .pin-button__label{margin:0 0 0 4px}.pin-button--ghost:not(.pin-button--selected) .pin-button__pin{background:transparent}.pin-button--outline:not(.pin-button--selected) .pin-button__pin{background:transparent;border:1px solid #96a8c0}.pin-button--primary .pin-button__pin{background:#de3535;color:#fff}.pin-button--primary:not(.pin-button--selected):not(.pin-button--disabled) .pin-button__pin{background:#de3535!important;color:#fff}.pin-button--primary:not(.pin-button--selected):not(.pin-button--disabled):hover .pin-button__pin{background:#e24b4b}.pin-button--secondary .pin-button__pin,.pin-button--secondary:not(.pin-button--selected):not(.pin-button--disabled) .pin-button__pin{background:#2d72dc;color:#fff}.pin-button--secondary:not(.pin-button--selected):not(.pin-button--disabled):hover .pin-button__pin{background:#4381e0}.pin-button--disabled{opacity:.2}.pin-button--disabled:hover{cursor:auto}.pin-button--fill,.pin-button--fill .pin-button__pin{width:100%;height:100%}.pin-button--floating .pin-button__pin{background-color:#fff;box-shadow:1px -1px 2px 0 rgba(28,42,63,.1),0 1px 2px 0 rgba(28,42,63,.3)}.pin-button--dark .pin-button__pin{color:#f9fafd;background-color:#1c2a3f!important;box-shadow:1px -1px 2px 0 rgba(28,42,63,.1),0 1px 2px 0 rgba(28,42,63,.3)}.pin-button--square .pin-button__pin{border-radius:4px}.pin-button--circle .pin-button__pin{border-radius:50%}.pin-button--rounded .pin-button__pin,.pin-button__pin{border-radius:20px}.pin-button__pin{--pin-button-pin-color:#1c2a3f;display:flex;font-size:12px;float:left;min-width:40px;height:40px;align-items:center;justify-content:center;position:relative;background-color:#eaeff5;color:#1c2a3f;color:var(--pin-button-pin-color);transition:background-color 125ms}.pin-button__label{font-size:10px;letter-spacing:.25px;line-height:1.4em;color:#1c2a3f;padding:2px 0 4px}.pin-button__image{width:100%;height:100%;background-size:50%;background-repeat:no-repeat;background-position:50%}"],encapsulation:2,changeDetection:0}),e})();var ru=n("Qu3c");function au(e,t){if(1&e&&(i.Vb(0,"div",3),i.Kc(1),i.Ub()),2&e){const e=i.gc();i.Db(1),i.Mc(" ",e.label," ")}}const cu=function(e,t,n){return[e,t,n]};var lu=function(e){return e.Small="small",e.Medium="medium",e.Large="large",e.Huge="huge",e}({}),pu=function(e){return e.Horizontal="horizontal",e.Vertical="vertical",e}({}),du=function(e){return e.Inline="inline",e.Block="block",e.Fill="fill",e}({});let uu=(()=>{class e{constructor(){this.size=lu.Medium,this.label="",this.direction=pu.Horizontal,this.render=du.Fill}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-spinner"]],inputs:{size:"size",label:"label",direction:"direction",render:"render"},decls:3,vars:6,consts:[[1,"spinner","spinner--horizontal",3,"ngClass"],[1,"spinner__circle"],["class","spinner__label",4,"ngIf"],[1,"spinner__label"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Qb(1,"div",1),i.Ic(2,au,2,1,"div",2),i.Ub()),2&e&&(i.lc("ngClass",i.pc(2,cu,"spinner--"+t.size,"spinner--"+t.render,"spinner--"+t.direction)),i.Db(2),i.lc("ngIf",t.label.length))},directives:[Z.i,Z.l],styles:['@-webkit-keyframes spinner{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}@keyframes spinner{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}.spinner[_ngcontent-%COMP%]{display:inline-flex;justify-content:center;align-items:center}.spinner--small[_ngcontent-%COMP%]   .spinner__circle[_ngcontent-%COMP%], .spinner--small[_ngcontent-%COMP%]   .spinner__circle[_ngcontent-%COMP%]:after{width:11px;height:11px}.spinner--small[_ngcontent-%COMP%]   .spinner__label[_ngcontent-%COMP%]{font-size:10px}.spinner--medium[_ngcontent-%COMP%]   .spinner__circle[_ngcontent-%COMP%], .spinner--medium[_ngcontent-%COMP%]   .spinner__circle[_ngcontent-%COMP%]:after{width:14px;height:14px}.spinner--medium[_ngcontent-%COMP%]   .spinner__label[_ngcontent-%COMP%]{font-size:10px}.spinner--large[_ngcontent-%COMP%]   .spinner__circle[_ngcontent-%COMP%], .spinner--large[_ngcontent-%COMP%]   .spinner__circle[_ngcontent-%COMP%]:after{width:28px;height:28px}.spinner--large[_ngcontent-%COMP%]   .spinner__label[_ngcontent-%COMP%]{font-size:14px}.spinner--huge[_ngcontent-%COMP%]   .spinner__circle[_ngcontent-%COMP%], .spinner--huge[_ngcontent-%COMP%]   .spinner__circle[_ngcontent-%COMP%]:after{width:44px;height:44px}.spinner--huge[_ngcontent-%COMP%]   .spinner__label[_ngcontent-%COMP%]{font-size:16px}.spinner--horizontal[_ngcontent-%COMP%]{flex-direction:row}.spinner--vertical[_ngcontent-%COMP%]{align-items:center;flex-direction:column}.spinner--vertical[_ngcontent-%COMP%]   .spinner__label[_ngcontent-%COMP%]{padding:8px 0 0}.spinner--inline[_ngcontent-%COMP%]{display:inline-flex}.spinner--block[_ngcontent-%COMP%]{display:flex}.spinner--fill[_ngcontent-%COMP%]{display:flex;height:100%}.spinner__circle[_ngcontent-%COMP%]{width:14px;height:14px;border-radius:50%;border:2px solid rgba(16,24,35,.1);position:relative}.spinner__circle[_ngcontent-%COMP%]:after{-webkit-animation:spinner .4s linear infinite;animation:spinner .4s linear infinite;content:" ";border-radius:50%;border-color:hsla(0,0%,100%,.2) rgba(16,24,35,.2) transparent transparent;border-style:solid;border-width:2px;box-sizing:border-box;position:absolute;display:block;width:14px;height:14px;top:-2px;left:-2px}.spinner__label[_ngcontent-%COMP%]{padding-left:8px;font-size:14px;text-transform:uppercase}.theme-dark[_nghost-%COMP%]   .spinner__label[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .spinner__label[_ngcontent-%COMP%]{color:hsla(0,0%,100%,.2)}.theme-light[_nghost-%COMP%]   .spinner__label[_ngcontent-%COMP%], .theme-light   [_nghost-%COMP%]   .spinner__label[_ngcontent-%COMP%]{color:rgba(16,24,35,.6)}'],changeDetection:0}),e})();function gu(e,t){1&e&&(i.Vb(0,"div",4),i.Qb(1,"app-spinner",5),i.Ub())}let hu=(()=>{class e{constructor(e,t,n){this.dialogRef=e,this.data=t,this.changeRef=n,this.config=t}ngOnInit(){}handleCloseClick(){this.dialogRef.close()}handleImageLoaded(){this.imageLoaded=!0,this.changeRef.markForCheck()}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(nl.g),i.Pb(nl.a),i.Pb(i.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-image-dialog"]],decls:4,vars:7,consts:[["role","dialog","aria-modal","true",1,"image-dialog",3,"click","keyup.enter"],["class","image-dialog__loading flex flex-column p-8",4,"ngIf"],[1,"image-dialog__image",3,"src","title","alt","load"],["type","button","app-pin-button","","buttonType","dark","size","large","icon","times","aria-label","Close","matTooltip","Close","matTooltipPosition","left",1,"image-dialog__close"],[1,"image-dialog__loading","flex","flex-column","p-8"],["size","huge"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.cc("click",(function(){return t.handleCloseClick()}))("keyup.enter",(function(){return t.handleCloseClick()})),i.Ic(1,gu,2,0,"div",1),i.Vb(2,"img",2),i.cc("load",(function(){return t.handleImageLoaded()})),i.Ub(),i.Qb(3,"button",3),i.Ub()),2&e&&(i.Eb("aria-label",(t.config.title||t.config.alt||"")+" Image Dialog"),i.Db(1),i.lc("ngIf",!t.imageLoaded),i.Db(1),i.lc("src",t.config.src,i.Ac)("title",t.config.title||"")("alt",t.config.alt||""),i.Eb("aria-label",t.config.title||""),i.Db(1),i.Eb("aria-label","Close Dialog"))},directives:[Z.l,ou,ru.c,uu],styles:[".image-dialog[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;width:100%}.image-dialog__loading[_ngcontent-%COMP%]{position:absolute}.image-dialog__image[_ngcontent-%COMP%]{max-width:100%;max-height:100vh}.image-dialog__close[_ngcontent-%COMP%]{position:fixed;top:24px;right:24px}"],changeDetection:0}),e})();var bu=function(e){return e.AboutDialog="AboutDialog",e.AddTeamModelDialog="AddTeamModelDialog",e.AssignUserRoleDialog="AssignUserRoleDialog",e.BookmarkAccessDialog="BookmarkAccessDialog",e.ClipboardDialog="ClipboardDialog",e.ShareUrlDialog="ShareUrlDialog",e.ConfirmDialog="ConfirmDialog",e.ContactDialog="ContactDialog",e.GroupRestrictionDialog="GroupRestrictionDialog",e.ImageDialog="ImageDialog",e.ImportDialog="ImportDialog",e.JoinDomainDialog="JoinDomainDialog",e.LimitDialog="LimitDialog",e.ManageDialog="ManageDialog",e.PremiumContentDialog="PremiumContentDialog",e.PricingDialog="PricingDialog",e.ProfileDialog="ProfileDialog",e.QuizSettingsDialog="QuizSettingsDialog",e.SaveAsBookmarkDialog="SaveAsBookmarkDialog",e.SaveBookmarkDialog="SaveBookmarkDialog",e.SaveModuleDialog="SaveModuleDialog",e.TransferUserContentDialog="TransferUserContentDialog",e.RemoveUserDialog="RemoveUserDialog",e.MergeModuleDialog="MergeModuleDialog",e.MergeConflictDialog="MergeConflictDialog",e.WelcomeTourDialog="WelcomeTourDialog",e.TrialExpiredDialog="TrialExpiredDialog",e.PremiumAccessDialog="PremiumAccessDialog",e.ConfirmRoleDialog="ConfirmRoleDialog",e.CollectionNameDialog="CollectionNameDialog",e.PublicViewGateDialog="PublicViewGateDialog",e}({});const mu=["imageView"];let fu=(()=>{class e{constructor(e){this.dialog=e,this.fit="normal",this.fullscreenEnabled=!1}handleFullscreen(e){this.dialog.open(hu,{id:bu.ImageDialog,backdropClass:"bd-dialog-backdrop",panelClass:"bd-dialog-panel",disableClose:!1,data:{src:this.fullscreenSrc||this.src,alt:this.alt||""}}),e.stopPropagation()}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(nl.b))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-image-view"]],viewQuery:function(e,t){if(1&e&&i.Ec(mu,!0),2&e){let e;i.sc(e=i.dc())&&(t.imageView=e.first)}},inputs:{fit:"fit",fitSize:"fitSize",src:"src",fullscreenSrc:"fullscreenSrc",alt:"alt"},decls:7,vars:8,consts:[["role","button","tabindex","0","matTooltip","Expand",1,"image-view",3,"click","keyup.enter"],["imageView",""],[1,"visually-hidden"],[1,"image-view__image",3,"src"],["aria-hidden","true",1,"image-view__overlay"],["icon","expand-alt",1,"image-view__icon"]],template:function(e,t){1&e&&(i.Vb(0,"div",0,1),i.cc("click",(function(e){return t.handleFullscreen(e)}))("keyup.enter",(function(e){return t.handleFullscreen(e)})),i.Vb(2,"span",2),i.Kc(3,"Click to expand the image"),i.Ub(),i.Qb(4,"img",3),i.Vb(5,"div",4),i.Qb(6,"app-icon",5),i.Ub(),i.Ub()),2&e&&(i.Hb("image-view--auto-fit","auto"===t.fit),i.Db(4),i.Fc("max-width","auto"===t.fit&&t.fitSize?t.fitSize+"px":"100%")("max-height","auto"===t.fit&&t.fitSize?t.fitSize+"px":"100%"),i.lc("src",t.src,i.Ac),i.Eb("alt",t.alt))},directives:[ru.c,dl],styles:[".image-view[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:inherit;min-height:32px;position:relative;background-color:#f9fafd}.image-view__image[_ngcontent-%COMP%]{width:auto;height:auto}.image-view--auto-fit[_ngcontent-%COMP%]   .image-view__image[_ngcontent-%COMP%]{max-width:100%;height:auto}.image-view__overlay[_ngcontent-%COMP%]{background:rgba(28,42,63,.3);color:#fff;display:flex;flex-direction:row;align-items:center;justify-content:center;padding:8px;position:absolute;top:0;bottom:0;left:0;right:0;opacity:0;transition:opacity .25s}.image-view__icon[_ngcontent-%COMP%]{text-shadow:0 0 2px rgba(0,0,0,.6)}.image-view[_ngcontent-%COMP%]:hover{cursor:pointer}.image-view[_ngcontent-%COMP%]:hover   .image-view__overlay[_ngcontent-%COMP%]{opacity:1}.image-view[_ngcontent-%COMP%]:focus{outline:2px solid #2d72dc!important}.image-view[_ngcontent-%COMP%]:focus   .image-view__overlay[_ngcontent-%COMP%]{opacity:1}"],changeDetection:0}),e})();function yu(e,t){if(1&e&&(i.Vb(0,"div",6),i.Qb(1,"app-image-view",7),i.Ub()),2&e){const e=i.gc(2);i.Hb("mb-3",e.currentImage.caption),i.Db(1),i.lc("src",e.currentImage.urls.small)("fullscreenSrc",e.currentImage.urls.default)("alt",e.currentImage.alt)("fit",e.fit)("fitSize",e.fitSize)}}function xu(e,t){if(1&e&&i.Qb(0,"app-html",8),2&e){const e=i.gc(2);i.lc("markdownText",e.currentImage.caption)}}function vu(e,t){if(1&e){const e=i.Wb();i.Vb(0,"div",9),i.Vb(1,"button",10),i.cc("click",(function(){return i.xc(e),i.gc(2).handlePrevClick()})),i.Ub(),i.Vb(2,"button",11),i.cc("click",(function(){return i.xc(e),i.gc(2).handleNextClick()})),i.Ub(),i.Ub()}}function Ou(e,t){if(1&e&&(i.Vb(0,"div",1),i.Vb(1,"div",2),i.Ic(2,yu,2,7,"div",3),i.Ic(3,xu,1,1,"app-html",4),i.Ic(4,vu,3,0,"div",5),i.Ub(),i.Ub()),2&e){const e=i.gc();i.Hb("images-block--slideshow",e.images&&e.images.length>1),i.Db(2),i.lc("ngIf",e.currentImage.urls),i.Db(1),i.lc("ngIf",e.currentImage.caption),i.Db(1),i.lc("ngIf",e.images.length>1)}}let wu=(()=>{class e{constructor(){this.layout=Ed.Normal}get imagesBlock(){return this._imagesBlock}set imagesBlock(e){this._imagesBlock=e;const t=Object(D.get)(e,"images",[]);t.length&&(this.images=t,this.currentImage=this.images[0])}get fit(){return"compact"===this.layout?"auto":"normal"}get fitSize(){return"compact"===this.layout?100:void 0}ngOnInit(){}handlePrevClick(){let e=this.getCurrentImageIndex();e--,e<0&&(e=this.images.length-1),this.currentImage=this.images[e]}handleNextClick(){let e=this.getCurrentImageIndex();e++,e>=this.images.length&&(e=0),this.currentImage=this.images[e]}getCurrentImageIndex(){return this.images.indexOf(this.currentImage)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-images-block"]],inputs:{imagesBlock:"imagesBlock",layout:"layout"},decls:1,vars:1,consts:[["class","images-block",3,"images-block--slideshow",4,"ngIf"],[1,"images-block"],[1,"images-block__content"],["class","images-block__image-container",3,"mb-3",4,"ngIf"],["class","images-block__caption",3,"markdownText",4,"ngIf"],["class","images-block__actions",4,"ngIf"],[1,"images-block__image-container"],[1,"images-block__image-view",3,"src","fullscreenSrc","alt","fit","fitSize"],[1,"images-block__caption",3,"markdownText"],[1,"images-block__actions"],["type","button","app-pin-button","","icon","chevron-left","size","small","buttonType","ghost","matTooltip","Previous Image","aria-label","Previous Image",3,"click"],["type","button","app-pin-button","","icon","chevron-right","size","small","buttonType","ghost","matTooltip","Next Image","aria-label","Next Image",3,"click"]],template:function(e,t){1&e&&i.Ic(0,Ou,5,5,"div",0),2&e&&i.lc("ngIf",t.currentImage)},directives:[Z.l,fu,Zd,ou,ru.c],styles:[".images-block__header{display:flex;align-items:center;justify-content:space-between;margin-bottom:16px}.images-block__label{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase;color:#374a68;font-weight:600;display:flex;align-items:center;min-height:28px}.images-block__image-container{display:flex;justify-content:center;background-color:#f9fafd}.images-block__image-view{display:flex;height:100%;min-height:32px}.images-block__caption{font-size:12px;margin-top:12px}.images-block__actions{display:flex;justify-content:flex-end;margin-top:14px}.images-block--slideshow .images-block__image-container{height:200px}"],encapsulation:2,changeDetection:0}),e})();function Cu(e,t){if(1&e&&i.Qb(0,"app-ticker-block",6),2&e){const e=i.gc().$implicit;i.lc("tickerBlock",e)}}function Su(e,t){if(1&e&&i.Qb(0,"app-markdown-block",7),2&e){const e=i.gc().$implicit,t=i.gc(2);i.lc("markdownBlock",e)("layout",t.layout)}}function _u(e,t){if(1&e&&i.Qb(0,"app-images-block",8),2&e){const e=i.gc().$implicit,t=i.gc(2);i.lc("imagesBlock",e)("layout",t.layout)}}function ju(e,t){if(1&e&&(i.Vb(0,"div"),i.Tb(1,2),i.Ic(2,Cu,1,1,"app-ticker-block",3),i.Ic(3,Su,1,2,"app-markdown-block",4),i.Ic(4,_u,1,2,"app-images-block",5),i.Sb(),i.Ub()),2&e){const e=t.$implicit;i.Hb("mv-2",t.index>0),i.Db(1),i.lc("ngSwitch",e.type),i.Db(1),i.lc("ngSwitchCase","ticker"),i.Db(1),i.lc("ngSwitchCase","markdown"),i.Db(1),i.lc("ngSwitchCase","images")}}function ku(e,t){if(1&e&&(i.Tb(0),i.Ic(1,ju,5,6,"div",1),i.Sb()),2&e){const e=i.gc();i.Db(1),i.lc("ngForOf",e.contentBlocks)}}let Pu=(()=>{class e{constructor(){this._contentBlocks=[],this.layout=Ed.Normal,this.include=[],this.exclude=[]}get contentBlocks(){return this._contentBlocks.filter(e=>!this.include.length||this.include.includes(e.type)).filter(e=>!this.exclude.length||!this.exclude.includes(e.type))}set contentBlocks(e){this._contentBlocks=e}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-content-blocks"]],inputs:{contentBlocks:"contentBlocks",layout:"layout",include:"include",exclude:"exclude"},decls:1,vars:1,consts:[[4,"ngIf"],[3,"mv-2",4,"ngFor","ngForOf"],[3,"ngSwitch"],[3,"tickerBlock",4,"ngSwitchCase"],[3,"markdownBlock","layout",4,"ngSwitchCase"],[3,"imagesBlock","layout",4,"ngSwitchCase"],[3,"tickerBlock"],[3,"markdownBlock","layout"],[3,"imagesBlock","layout"]],template:function(e,t){1&e&&i.Ic(0,ku,2,1,"ng-container",0),2&e&&i.lc("ngIf",t.contentBlocks.length>0)},directives:[Z.l,Z.k,Z.n,Z.o,Gd,Jd,wu],styles:[""],encapsulation:2,changeDetection:0}),e})();var Mu=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},Iu=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function zu(e,t){if(1&e&&(i.Vb(0,"div",6),i.Qb(1,"app-content-blocks",7),i.Ub()),2&e){const e=i.gc();i.Db(1),i.lc("contentBlocks",e.label.contentBlocks)("layout","compact")}}function Tu(e,t){if(1&e&&(i.Qb(0,"div",8),i.hc(1,"markdown")),2&e){const e=i.gc();i.lc("innerHTML",i.ic(1,1,e.label.description),i.yc)}}let Uu=(()=>{class e{constructor(e,t,n,i){this.store=e,this.labelsService=t,this.engineService=n,this.changeDetectorRef=i,this.emitEvents=!0,this.collapsedMode=no.None,this.collapsed=!1,this.pinDraggable=!1,this.tagDraggable=!1,this.descriptionCollapsed=!1,this.tagCollapsed=!1,this.ngUnsubscribe=new k.a}get isCollapsed(){if(this.collapsedMode===no.Toggle){const e=this.store.selectSnapshot(Ca.getSelectedLabelId)===this.label.id;return this.collapsed&&!e}return this.collapsed}get hasContent(){return this.labelsService.hasContent(this.label)}ngOnInit(){this.selectedLabel$.pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(e=>this.handleLabelSelected(e)),this.store.select(Ca.getChapterLabels).pipe(Object(M.a)(this.ngUnsubscribe),Object(El.a)(100)).subscribe(()=>{this.sequence=this.store.selectSnapshot(Ca.getLabelSequence(this.label)),this.changeDetectorRef.markForCheck()}),this.descriptionCollapsed=this.label.collapseDescription,this.tagCollapsed=this.label.hideTag}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}handleLabelUpdated(e){const{label:t,shouldPreserve:n}=e;this.store.dispatch(new go(t,n))}handleOffsetUpdated(e){const{labelId:t,offset:n}=e;this.store.dispatch(new so(t,n))}handlePinClicked(e){this.selectLabel()}handleTagClicked(e){this.selectLabel()}selectLabel(){const e=this.store.selectSnapshot(Ca.getSelectedLabel);this.store.dispatch(new mo(e&&e.id===this.label.id?null:this.label)),this.emitEngineEvent(At.HotspotsPicked,{id:this.label.id}),this.emitEngineEvent(At.LabelsPicked,{labelId:this.label.id})}emitEngineEvent(e,t){this.emitEvents&&this.engineService.fireEvent(e,t)}handleDisplayUpdated(e){this.emitEngineEvent(At.HotspotsDisplayUpdated,e)}handlePositionUpdated(e){this.emitEngineEvent(At.HotspotsPositionUpdated,e.positionUpdate),this.emitEngineEvent(At.LabelsMoved,{labelId:e.positionUpdate.id,canvasPosition:[e.positionUpdate.canvasPos.x,e.positionUpdate.canvasPos.y],occluded:e.positionUpdate.occluded||!e.onCanvas})}handleHoverStart(e){this.emitEngineEvent(At.HotspotsEntered,{id:e.labelId}),this.emitEngineEvent(At.LabelsEntered,{labelId:e.labelId})}handleHoverEnd(e){this.emitEngineEvent(At.HotspotsLeft,{id:e.labelId}),this.emitEngineEvent(At.LabelsLeft,{labelId:e.labelId})}handleLabelSelected(e){const t=e&&e.id===this.label.id,n=Object(D.get)(e,"states[1].errands"),i=this.store.selectSnapshot(jr.getLockCamera);t&&n&&!i&&n.forEach(e=>{switch(e.type){case wi.flyToObject:this.store.dispatch(new Je(e.value));break;case wi.flyToCamera:this.store.dispatch(new Zt(e.value))}this.store.dispatch(new dn(!0))}),this.tagCollapsed=!(this.label.title||this.hasContent)||(this.label.expandTag&&this.label.hideTag?!t:this.label.hideTag),this.descriptionCollapsed=this.label.showDescription&&this.label.collapseDescription?!t:this.label.collapseDescription}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.g),i.Pb(Pi),i.Pb(Qt),i.Pb(i.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-story-label"]],inputs:{label:"label",emitEvents:"emitEvents",collapsedMode:"collapsedMode",collapsed:"collapsed",pinDraggable:"pinDraggable",tagDraggable:"tagDraggable"},decls:9,vars:18,consts:[[3,"label","selected","fixedScale","sequence","isCollapsed","tagCollapsed","pinDraggable","tagDraggable","descriptionCollapsed","hasContent","labelUpdated","offsetUpdated","tagClicked","pinClicked","keydown.enter","displayUpdated","positionUpdated","hoverStart","hoverEnd"],["label-header","",1,"html",3,"innerHTML"],["title",""],["label-body","",1,"html"],["class","mv-1","appEventFence","",4,"ngIf"],["data-test","labelDescription",3,"innerHTML",4,"ngIf"],["appEventFence","",1,"mv-1"],[3,"contentBlocks","layout"],["data-test","labelDescription",3,"innerHTML"]],template:function(e,t){if(1&e&&(i.Vb(0,"app-generic-label",0),i.cc("labelUpdated",(function(e){return t.handleLabelUpdated(e)}))("offsetUpdated",(function(e){return t.handleOffsetUpdated(e)}))("tagClicked",(function(e){return t.handleTagClicked(e)}))("pinClicked",(function(e){return t.handlePinClicked(e)}))("keydown.enter",(function(e){return t.handleTagClicked(e)}))("displayUpdated",(function(e){return t.handleDisplayUpdated(e)}))("positionUpdated",(function(e){return t.handlePositionUpdated(e)}))("hoverStart",(function(e){return t.handleHoverStart(e)}))("hoverEnd",(function(e){return t.handleHoverEnd(e)})),i.hc(1,"async"),i.hc(2,"async"),i.Qb(3,"div",1,2),i.hc(5,"markdown"),i.Vb(6,"div",3),i.Ic(7,zu,2,2,"div",4),i.Ic(8,Tu,2,3,"div",5),i.Ub(),i.Ub()),2&e){let e=null;i.lc("label",t.label)("selected",(null==(e=i.ic(1,12,t.selectedLabel$))?null:e.id)===t.label.id)("fixedScale",i.ic(2,14,t.labelScale$))("sequence",t.sequence)("isCollapsed",t.isCollapsed)("tagCollapsed",t.tagCollapsed)("pinDraggable",t.pinDraggable)("descriptionCollapsed",t.descriptionCollapsed)("hasContent",t.hasContent),i.Db(3),i.lc("innerHTML",i.ic(5,16,t.label.title),i.yc),i.Db(4),i.lc("ngIf",t.label.contentBlocks),i.Db(1),i.lc("ngIf",t.label.description)}},directives:[Pp,Z.l,dp,Pu],pipes:[Z.b,Pd.b],styles:[""],changeDetection:0}),Mu([Object(d.d)(Ca.getLabelScale),Iu("design:type",P.a)],e.prototype,"labelScale$",void 0),Mu([Object(d.d)(Ca.getSelectedLabel),Iu("design:type",P.a)],e.prototype,"selectedLabel$",void 0),e})();var Du=n("3Pt+");let Lu=(()=>{class e{constructor(e){this.controlContainer=e}get control(){return this.formControl||this.controlContainer.control.get(this.formControlName)}registerOnTouched(e){this.formControlDirective.valueAccessor.registerOnTouched(e)}registerOnChange(e){this.formControlDirective.valueAccessor.registerOnChange(e)}writeValue(e){this.formControlDirective.valueAccessor.writeValue(e)}setDisabledState(e){this.formControlDirective.valueAccessor.setDisabledState(e)}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(Du.b))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-base-accessor-control"]],viewQuery:function(e,t){if(1&e&&i.Ec(Du.g,!0),2&e){let e;i.sc(e=i.dc())&&(t.formControlDirective=e.first)}},inputs:{formControl:"formControl",formControlName:"formControlName"},decls:0,vars:0,template:function(e,t){},encapsulation:2}),e})(),Eu=(()=>{class e{constructor(){}get value(){return this._value}set value(e){Object(D.isEqual)(this._value,e)||(this._value=e,this.setFormValues(e),this.onChange(e))}onChange(e){}onTouched(){}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}writeValue(e){this.value=e}setDisabledState(e){this.disabled=e}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-abstract-input-control"]],inputs:{value:"value",disabled:"disabled"},decls:0,vars:0,template:function(e,t){},encapsulation:2}),e})();function Fu(e,t){if(1&e&&(i.Vb(0,"option",9),i.Kc(1),i.Ub()),2&e){const e=t.$implicit;i.lc("value",e.value),i.Db(1),i.Mc(" ",e.label.title," ")}}function Au(e,t){if(1&e&&(i.Vb(0,"select",6),i.Vb(1,"option",7),i.Kc(2,"Select"),i.Ub(),i.Ic(3,Fu,2,2,"option",8),i.Ub()),2&e){const e=i.gc();i.Db(3),i.lc("ngForOf",e.options)}}let Ru=(()=>{class e extends Eu{constructor(e,t){super(),this.formBuilder=e,this.changeRef=t,this.outline=!0,this.valueChange=new i.p,this.ngUnsubscribe=new k.a,this.form=this.formBuilder.group({value:[""]}),this.valueControl=this.form.get("value")}get options(){return this._options}set options(e){const t=Object(D.clone)(e);this._options=t.sort((e,t)=>e.label.title.localeCompare(t.label.title)),this.changeRef.markForCheck()}ngOnInit(){this.initFormListeners()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initFormListeners(){this.form.valueChanges.pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(({value:e})=>{this.writeValue(e),this.valueChange.next(e)})}setDisabledState(e){super.setDisabledState(e),e?this.form.disable():this.form.enable(),this.changeRef.markForCheck()}setFormValues(e){this.valueControl.setValue(e),this.changeRef.markForCheck()}getSelectedOption(){const e=this.valueControl.value;return this.options.find(t=>t.value===e)}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(Du.e),i.Pb(i.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-quiz-label-anatomy-select"]],inputs:{options:"options",outline:"outline"},outputs:{valueChange:"valueChange"},features:[i.Cb([{provide:Du.l,useExisting:Object(i.W)(()=>e),multi:!0}]),i.Ab],decls:7,vars:5,consts:[[1,"label",3,"formGroup"],[1,"label__select-label","flex","text-12"],[1,"flex","justify-between","p-2","flex-auto"],[1,"mr-2"],["icon","caret-down","size","lg"],["class","input label__select","placeholder","Select Option","formControlName","value","data-test","quizLabelSelect",4,"ngIf"],["placeholder","Select Option","formControlName","value","data-test","quizLabelSelect",1,"input","label__select"],["value","","data-test","questionAnswerOption"],["class","label__option","data-test","questionAnswerOption",3,"value",4,"ngFor","ngForOf"],["data-test","questionAnswerOption",1,"label__option",3,"value"]],template:function(e,t){if(1&e&&(i.Vb(0,"div",0),i.Vb(1,"label",1),i.Vb(2,"div",2),i.Vb(3,"div",3),i.Kc(4),i.Ub(),i.Qb(5,"app-icon",4),i.Ub(),i.Ic(6,Au,4,1,"select",5),i.Ub(),i.Ub()),2&e){let e=null;i.Hb("label--empty",""===t.valueControl.value),i.lc("formGroup",t.form),i.Db(4),i.Lc((null==(e=t.getSelectedOption())||null==e.label?null:e.label.title)||"Select"),i.Db(2),i.lc("ngIf",!t.disabled)}},directives:[Du.o,Du.i,dl,Z.l,Du.s,Du.n,Du.h,Du.q,Du.u,Z.k],styles:[".label[_ngcontent-%COMP%]{overflow:hidden}.label__select-label[_ngcontent-%COMP%]{color:#101823;position:relative}.label__select[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;opacity:.01}.label--empty[_ngcontent-%COMP%]   .label__select-label[_ngcontent-%COMP%]{color:#96a8c0}"],changeDetection:0}),e})();function Vu(e,t){1&e&&i.Qb(0,"app-icon",8)}function Nu(e,t){1&e&&i.Qb(0,"app-icon",9)}function Bu(e,t){if(1&e&&(i.Vb(0,"div",10),i.Vb(1,"em",11),i.Kc(2),i.Ub(),i.Kc(3,". "),i.Ub()),2&e){const e=i.gc(2);i.Db(2),i.Lc(e.option.label.title)}}function Hu(e,t){if(1&e&&(i.Vb(0,"div",10),i.Vb(1,"p",12),i.Kc(2," You selected "),i.Vb(3,"em",11),i.Kc(4),i.Ub(),i.Kc(5,". "),i.Ub(),i.Vb(6,"p"),i.Kc(7," This is the "),i.Vb(8,"em",11),i.Kc(9),i.Ub(),i.Kc(10,". "),i.Ub(),i.Ub()),2&e){const e=i.gc(2);let t=null;i.Db(4),i.Lc(null==(t=e.getSelectedLabel(e.options,e.control.value))?null:t.title.trim()),i.Db(5),i.Lc(e.option.label.title.trim())}}function Qu(e,t){if(1&e&&(i.Vb(0,"div",4),i.Ic(1,Vu,1,0,"app-icon",5),i.Ic(2,Nu,1,0,"app-icon",6),i.Ic(3,Bu,4,1,"div",7),i.Ic(4,Hu,11,2,"div",7),i.Ub()),2&e){const e=i.gc();i.lc("ngSwitch",e.correct),i.Db(1),i.lc("ngSwitchCase",!0),i.Db(1),i.lc("ngSwitchCase",!1),i.Db(1),i.lc("ngSwitchCase",!0),i.Db(1),i.lc("ngSwitchCase",!1)}}let $u=(()=>{class e extends Lu{constructor(){super(...arguments),this.sequence=0,this.labelUpdated=new i.p}ngOnInit(){}handleLabelUpdated(e){this.labelUpdated.next(e.label)}handleOffsetUpdated(e){this.labelUpdated.next(Object.assign(Object.assign({},this.option.label),{offset:e.offset}))}getSelectedLabel(e,t){const n=this.options.find(e=>e.value===t);return n?n.label:void 0}}return e.\u0275fac=function(t){return qu(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-quiz-label"]],inputs:{sequence:"sequence",collapsed:"collapsed",options:"options",option:"option",correct:"correct",mode:"mode"},outputs:{labelUpdated:"labelUpdated"},features:[i.Cb([{provide:Du.l,useExisting:Object(i.W)(()=>e),multi:!0}]),i.Ab],decls:4,vars:14,consts:[[1,"label","theme-light",3,"label","fit","opaque","pinDraggable","tagDraggable","isCollapsed","descriptionCollapsed","hasContent","sequence","labelUpdated","offsetUpdated"],["label-body","",1,"label__body"],[3,"outline","hidden","options","formControl"],["class","label__summary flex items-start",3,"ngSwitch",4,"ngIf"],[1,"label__summary","flex","items-start",3,"ngSwitch"],["class","label__icon label__icon--correct","style","font-size: 16px","icon","check-circle",4,"ngSwitchCase"],["class","label__icon label__icon--incorrect","style","font-size: 16px","icon","times-circle",4,"ngSwitchCase"],["class","label__text pl-2",4,"ngSwitchCase"],["icon","check-circle",1,"label__icon","label__icon--correct",2,"font-size","16px"],["icon","times-circle",1,"label__icon","label__icon--incorrect",2,"font-size","16px"],[1,"label__text","pl-2"],[1,"text-semibold"],[1,"pb-2"]],template:function(e,t){1&e&&(i.Vb(0,"app-generic-label",0),i.cc("labelUpdated",(function(e){return t.handleLabelUpdated(e)}))("offsetUpdated",(function(e){return t.handleOffsetUpdated(e)})),i.Vb(1,"div",1),i.Qb(2,"app-quiz-label-anatomy-select",2),i.Ic(3,Qu,5,5,"div",3),i.Ub(),i.Ub()),2&e&&(i.lc("label",t.option.label)("fit","summary"===t.mode?"fixed":"auto")("opaque",!0)("pinDraggable","edit"===t.mode)("tagDraggable","edit"===t.mode)("isCollapsed",t.collapsed)("descriptionCollapsed",!1)("hasContent",!0)("sequence",t.sequence),i.Db(2),i.lc("outline",!1)("hidden","summary"===t.mode)("options",t.options)("formControl",t.control),i.Db(1),i.lc("ngIf","summary"===t.mode))},directives:[Pp,Ru,Du.n,Du.g,Z.l,Z.n,Z.o,dl],styles:[".label__body[_ngcontent-%COMP%]{color:#101823;min-width:142px;max-width:200px}.label__icon[_ngcontent-%COMP%]{position:relative;flex-basis:0 0 20px;justify-content:center}.label__icon--correct[_ngcontent-%COMP%]{color:#83e692}.label__icon--incorrect[_ngcontent-%COMP%]{color:#f44336}.label__text[_ngcontent-%COMP%]{flex-wrap:wrap}"],changeDetection:0}),e})();const qu=i.Xb($u);var Wu=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},Ku=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Gu(e,t){if(1&e){const e=i.Wb();i.Tb(0),i.Vb(1,"app-quiz-label",3),i.cc("labelUpdated",(function(n){i.xc(e);const s=t.index;return i.gc().handleLabelUpdated(n,s)})),i.hc(2,"async"),i.hc(3,"async"),i.hc(4,"async"),i.hc(5,"async"),i.hc(6,"async"),i.Ub(),i.Sb()}if(2&e){const e=t.$implicit,n=t.index,s=i.gc();i.Db(1),i.lc("mode",s.mode)("formControl",e)("option",i.ic(2,7,s.quizLabels$)[n])("options",i.ic(3,9,s.quizLabels$))("sequence",n+1)("correct",s.isCorrect(i.ic(4,11,s.quizLabels$)[n],i.ic(5,13,s.activeSubmitted$),n))("collapsed",i.ic(6,15,s.labelsCollapsed$))}}let Zu=(()=>{class e{constructor(e,t,n,i){this.store=e,this.formBuilder=t,this.changeRef=n,this.router=i,this.ngUnsubscribe=new k.a,this.mode="edit",this.form=this.formBuilder.group({options:this.formBuilder.array([])}),this.optionsArray=this.form.get("options")}ngOnInit(){this.initFormListeners(),this.initQuizSubmissionListeners()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initFormListeners(){this.quizLabels$.pipe(Object(qa.a)((e,t)=>{const n=e.map(e=>e.value),i=t.map(e=>e.value);return Object(D.isEqual)(n,i)}),Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{const t=this.store.selectSnapshot(xs.getQuizModeActive);this.buildFormOptions(e,t),this.changeRef.markForCheck()}),Object(Ta.b)([this.quizModeActive$,this.quizLabels$]).pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(([e])=>{this.setFormEnabled(e),this.changeRef.markForCheck()})}initQuizSubmissionListeners(){this.activeSubmission$.pipe(Object(I.a)(e=>!Object(D.isNil)(e)&&!Object(D.isNil)(e.answer)&&Array.isArray(e.answer)),Object(qa.a)((e,t)=>Object(D.isEqual)(e,t)),Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{const t=this.form.value.options,n=e.answer;Object(D.isEqual)(t,n)||(this.form.patchValue({options:n},{emitEvent:!1,onlySelf:!0}),this.changeRef.markForCheck())}),this.form.valueChanges.pipe(Object(qa.a)((e,t)=>Object(D.isEqual)(e,t)),Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{const t=this.store.selectSnapshot(xs.getActiveQuestionId),n=this.store.selectSnapshot(xs.getActiveSubmitted),i=this.store.selectSnapshot(xs.getActiveSubmission),s=Object(D.isNil)(i)?[]:i.answer,o=e.options;Object(D.isNil)(n)&&(Object(D.isEqual)(o,s)||this.store.dispatch(new ns.SetActiveSubmission({questionId:t,answer:o})),this.changeRef.markForCheck())}),Object(Ta.b)([this.quizModeActive$,this.activeSubmitted$]).subscribe(([e,t])=>{const n=this.router.url.includes("/edit");this.mode=n?"edit":e&&!Object(D.isNil)(t)?"summary":"view",this.changeRef.markForCheck()})}isCorrect(e,t,n){if(!Object(D.isNil)(t))return t.answer[n]===e.value}handleLabelUpdated(e,t){const n=this.store.selectSnapshot(xs.getActiveQuestion);n.data.options[t].label=e,this.store.dispatch(new ns.SetQuestion(n))}buildFormOptions(e,t){this.optionsArray.clear(),e.forEach(e=>{this.optionsArray.push(this.formBuilder.control(t?"":e.value))})}setFormEnabled(e){e?this.optionsArray.enable():this.optionsArray.disable()}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.g),i.Pb(Du.e),i.Pb(i.i),i.Pb(T.e))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-quiz-labels"]],decls:3,vars:2,consts:[["data-test","quizLabelsElement",3,"formGroup"],["formArrayName","options"],[4,"ngFor","ngForOf"],["data-test","appQuizLabel",3,"mode","formControl","option","options","sequence","correct","collapsed","labelUpdated"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Vb(1,"div",1),i.Ic(2,Gu,7,17,"ng-container",2),i.Ub(),i.Ub()),2&e&&(i.lc("formGroup",t.form),i.Db(2),i.lc("ngForOf",t.optionsArray.controls))},directives:[Du.o,Du.i,Du.d,Z.k,$u,Du.n,Du.g],pipes:[Z.b],styles:[""],changeDetection:0}),Wu([Object(d.d)(Ca.getLabelsCollapsed),Ku("design:type",P.a)],e.prototype,"labelsCollapsed$",void 0),Wu([Object(d.d)(xs.getActiveQuestionLabels),Ku("design:type",P.a)],e.prototype,"quizLabels$",void 0),Wu([Object(d.d)(xs.getQuizModeActive),Ku("design:type",P.a)],e.prototype,"quizModeActive$",void 0),Wu([Object(d.d)(xs.getAllSubmissions),Ku("design:type",P.a)],e.prototype,"allSubmissions$",void 0),Wu([Object(d.d)(xs.getActiveSubmission),Ku("design:type",P.a)],e.prototype,"activeSubmission$",void 0),Wu([Object(d.d)(xs.getActiveSubmitted),Ku("design:type",P.a)],e.prototype,"activeSubmitted$",void 0),e})();var Ju=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},Xu=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Yu(e,t){if(1&e&&(i.Qb(0,"app-context-label",5),i.hc(1,"async"),i.hc(2,"async"),i.hc(3,"async"),i.hc(4,"async"),i.hc(5,"async")),2&e){const e=i.gc(3);let t=null,n=null;i.lc("label",i.ic(1,3,e.contextLabel$))("enableInfo",i.ic(2,5,e.enableContextLabelInfo$)&&(null==(t=i.ic(3,7,e.layout$))?null:t.nodeInfo.enable))("enableActions",i.ic(4,9,e.enableContextLabelActions$)&&(null==(n=i.ic(5,11,e.layout$))?null:n.contextActions.enable))}}function eg(e,t){if(1&e&&(i.Tb(0),i.Qb(1,"app-story-label",6),i.hc(2,"async"),i.hc(3,"async"),i.hc(4,"async"),i.hc(5,"async"),i.Sb()),2&e){const e=t.$implicit,n=i.gc(3);let s=null,o=null;i.Db(1),i.Hb("labels__label--hidden",!e.shown),i.lc("pinDraggable",null==(s=i.ic(2,7,n.draggable$))?null:s.pin)("tagDraggable",null==(o=i.ic(3,9,n.draggable$))?null:o.tag)("label",e)("collapsed",i.ic(4,11,n.labelsCollapsed$))("collapsedMode",i.ic(5,13,n.labelsCollapsedMode$))}}function tg(e,t){if(1&e&&(i.Tb(0),i.Ic(1,Yu,6,13,"app-context-label",3),i.hc(2,"async"),i.hc(3,"async"),i.Ic(4,eg,6,15,"ng-container",4),i.hc(5,"async"),i.Sb()),2&e){const e=i.gc(2);i.Db(1),i.lc("ngIf",i.ic(2,3,e.enableContextLabel$)&&i.ic(3,5,e.contextLabel$)),i.Db(3),i.lc("ngForOf",i.ic(5,7,e.labels$))("ngForTrackBy",e.trackLabel)}}function ng(e,t){1&e&&(i.Tb(0),i.Qb(1,"app-quiz-labels"),i.Sb())}function ig(e,t){if(1&e&&(i.Vb(0,"div",1),i.Ic(1,tg,6,9,"ng-container",2),i.Ic(2,ng,2,0,"ng-container",2),i.Ub()),2&e){const e=i.gc();i.Db(1),i.lc("ngIf",e.showAnatomyLabels),i.Db(1),i.lc("ngIf",e.showQuizLabels)}}let sg=(()=>{class e{constructor(e,t,n,i,s,o,r,a){this.store=e,this.action$=t,this.router=n,this.engineService=i,this.cameraService=s,this.changeDetector=o,this.labelsService=r,this.elRef=a,this.interactive=!1,this.showAnatomyLabels=!1,this.showQuizLabels=!1,this.ngUnsubscribe=new k.a}ngOnInit(){this.bindEngineEvents(),this.bindApplicationEvents(),this.labelsService.setLabelContainer(this.elRef)}ngOnDestroy(){this.labelsService.setLabelContainer(null),this.changeDetector.detach(),this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}bindApplicationEvents(){this.action$.pipe(Object(d.j)(Ge),Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.handleClickNode(e)}),this.labels$.pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.changeDetector.markForCheck()}),this.selectedLabel$.pipe(Object(I.a)(e=>null==e),Object(M.a)(this.ngUnsubscribe)).subscribe(()=>{const e=this.store.selectSnapshot(jr.getZoomed),t=this.store.selectSnapshot(jr.getLockCamera);e&&!t&&this.resetCamera()});const e=Object(Ta.b)([this.activeTool$,this.activeQuestion$]).pipe(Object(M.a)(this.ngUnsubscribe),Object(F.a)(([e,t])=>{const n=this.router.url.indexOf("/edit")>=0,i=Object(D.get)(t,"type")===ss.LabelAnatomy;return n?e===kr.Quiz:i}));Object(Ta.b)([this.showLabels$,e,this.activeQuestion$]).pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(([e,t,n])=>{const i=Object(D.get)(n,"showChapterLabels");this.showQuizLabels=t,this.showAnatomyLabels=!this.showQuizLabels&&e||i,this.changeDetector.markForCheck()}),this.store.select(Or.getSelectedChapterReadyState).pipe(Object(I.a)(e=>null!=e),Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.interactive=e.model,this.changeDetector.markForCheck()})}bindEngineEvents(){this.action$.pipe(Object(d.j)(st,Oo),Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.engineService.fireEvent(e.show?At.LabelsEnabled:At.LabelsDisabled,null)}),this.action$.pipe(Object(d.j)(ro),Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.engineService.fireEvent(At.LabelsCreated,e.label)}),this.action$.pipe(Object(d.j)(go),Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.engineService.fireEvent(At.LabelsUpdated,e.label)}),this.action$.pipe(Object(d.j)(vo),Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{e.labels.forEach(t=>{this.engineService.fireEvent(e.shown?At.LabelsShown:At.LabelsHidden,{labelId:t.id})})}),this.action$.pipe(Object(d.j)(lo),Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.engineService.fireEvent(At.LabelsDestroyed,e.label)})}handleClickNode(e){const t=this.store.selectSnapshot(Er.getActiveTool);null!=e.node?t===kr.Label?this.addLabel(e.hit,e.node):setTimeout(()=>{this.toggleContextLabel(e.hit,e.node)}):(this.store.dispatch(new mo(null)),this.store.dispatch(new po))}addLabel(e,t){const n=this.cameraService.getDirection(e),i=this.getLabelDefaults(e.objectId),s=i.hideWire?20:32;i.title=t.label,i.offset=[s,0],i.objectId=e.objectId,i.barycentric=[e.barycentric[0],e.barycentric[1],e.barycentric[2]],i.pos=[e.worldPos[0],e.worldPos[1],e.worldPos[2]],i.primitiveIndex=e.primitiveIndex,i.renderableIndex=e.renderableIndex||0,i.dir=n,i.chapterId=this.store.selectSnapshot(Or.getSelectedChapter).id,i.occludable=!0,i.shown=!0,this.store.dispatch(new ro(i)),this.store.dispatch(new mo(i))}toggleContextLabel(e,t){if(this.store.selectSnapshot(Bi.getCheckedNodeIds).some(e=>e===t.id)){const n=this.cameraService.getDirection(e),i=this.labelsService.makeDefaultStudioLabel();i.theme=ri.Context,i.title=t.label,i.offset=[32,0],i.objectId=e.objectId,i.barycentric=[e.barycentric[0],e.barycentric[1],e.barycentric[2]],i.pos=[e.worldPos[0],e.worldPos[1],e.worldPos[2]],i.primitiveIndex=e.primitiveIndex,i.dir=n,i.occludable=!1,this.store.dispatch(new ao(i))}else this.store.dispatch(new po)}getLabelDefaults(e){let t=this.store.selectSnapshot(Ca.getSelectedLabel);if(null==t){let e=this.store.selectSnapshot(Ca.getChapterLabels);e&&0!==e.length||(e=this.store.selectSnapshot(Ca.getLabels)),e.length&&(t=Object(D.cloneDeep)(e[e.length-1]))}if(null!=t){const n=this.labelsService.makeDefaultStudioLabel();switch(n.hideWire=t.hideWire,n.pinGlow=t.pinGlow,n.pinType=t.pinType,n.theme=t.theme,n.sequentialType=t.sequentialType,n.states[0].errands[0]=new ji,Object(D.get)(t,"states[1].errands[0].type")){case wi.flyToObject:case wi.flyToCamera:n.states[1].errands[0]=new Ci(e)}return n}{const t=this.labelsService.makeDefaultStudioLabel();return t.states[0].errands[0]=new ji,t.states[1].errands[0]=new Ci(e),t}}trackLabel(e,t){const{id:n,shown:i,theme:s}=t;return`${n}${i}${s}`}resetCamera(){const e=this.store.selectSnapshot(Or.getSelectedChapter);Object(D.get)(e,"camera.location")&&this.store.dispatch(new Zt(e.camera.location))}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.g),i.Pb(d.b),i.Pb(T.e),i.Pb(Qt),i.Pb(yn),i.Pb(i.i),i.Pb(Pi),i.Pb(i.m))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-labels"]],decls:1,vars:1,consts:[["class","labels","data-test","labelsElement",4,"ngIf"],["data-test","labelsElement",1,"labels"],[4,"ngIf"],[3,"label","enableInfo","enableActions",4,"ngIf"],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"label","enableInfo","enableActions"],["data-test","appStoryLabel",1,"labels__label",3,"pinDraggable","tagDraggable","label","collapsed","collapsedMode"]],template:function(e,t){1&e&&i.Ic(0,ig,3,2,"div",0),2&e&&i.lc("ngIf",t.interactive)},directives:[Z.l,Z.k,Ld,Uu,Zu],pipes:[Z.b],styles:["[_nghost-%COMP%]{position:relative}.labels[_ngcontent-%COMP%], [_nghost-%COMP%]{width:100%;height:100%;display:block}.labels[_ngcontent-%COMP%]{position:absolute;left:0;top:0;z-index:2;pointer-events:none}.labels__label--hidden[_ngcontent-%COMP%]{display:none}"],changeDetection:0}),Ju([Object(d.d)(mr.getUI),Xu("design:type",P.a)],e.prototype,"layout$",void 0),Ju([Object(d.d)(Ca.getChapterLabels),Xu("design:type",P.a)],e.prototype,"labels$",void 0),Ju([Object(d.d)(xs.getQuizModeActive),Xu("design:type",P.a)],e.prototype,"quizModeActive$",void 0),Ju([Object(d.d)(Er.getActiveTool),Xu("design:type",P.a)],e.prototype,"activeTool$",void 0),Ju([Object(d.d)(xs.getActiveQuestion),Xu("design:type",P.a)],e.prototype,"activeQuestion$",void 0),Ju([Object(d.d)(Or.getSelectedChapter),Xu("design:type",P.a)],e.prototype,"selectedChapter$",void 0),Ju([Object(d.d)(Ca.getSelectedLabel),Xu("design:type",P.a)],e.prototype,"selectedLabel$",void 0),Ju([Object(d.d)(Ca.getLabelsCollapsed),Xu("design:type",P.a)],e.prototype,"labelsCollapsed$",void 0),Ju([Object(d.d)(Ca.getLabelsCollapsedMode),Xu("design:type",P.a)],e.prototype,"labelsCollapsedMode$",void 0),Ju([Object(d.d)(Ca.getContextLabel),Xu("design:type",P.a)],e.prototype,"contextLabel$",void 0),Ju([Object(d.d)(Er.getShowLabels),Xu("design:type",P.a)],e.prototype,"showLabels$",void 0),Ju([Object(d.d)(jr.getZoomed),Xu("design:type",P.a)],e.prototype,"zoomed$",void 0),Ju([Object(d.d)(Ca.getEnableContextLabel),Xu("design:type",P.a)],e.prototype,"enableContextLabel$",void 0),Ju([Object(d.d)(Ca.getEnableContextLabelInfo),Xu("design:type",P.a)],e.prototype,"enableContextLabelInfo$",void 0),Ju([Object(d.d)(Ca.getEnableContextLabelActions),Xu("design:type",P.a)],e.prototype,"enableContextLabelActions$",void 0),Ju([Object(d.d)(Ca.getLabelsDraggable),Xu("design:type",P.a)],e.prototype,"draggable$",void 0),e})();function og(e,t){if(1&e){const e=i.Wb();i.Vb(0,"div",1),i.cc("@show.done",(function(){return i.xc(e),i.gc().onShowDone()})),i.Vb(1,"div",2),i.Kc(2,"Use control + scroll to zoom"),i.Ub(),i.Ub()}2&e&&i.lc("@show",void 0)}let rg=(()=>{class e{constructor(e,t){this.actions=e,this.changeDetectorRef=t,this.ngUnsubscribe=new k.a,this.show=!1}ngOnInit(){this.actions.pipe(Object(d.j)(Ve),Object(M.a)(this.ngUnsubscribe)).subscribe(()=>{this.show=!0,this.changeDetectorRef.markForCheck()})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}onShowDone(){this.show=!1}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.b),i.Pb(i.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-engine-scroll"]],decls:1,vars:1,consts:[["class","engine-scroll","data-test","engineScroll",4,"ngIf"],["data-test","engineScroll",1,"engine-scroll"],[1,"engine-scroll__label"]],template:function(e,t){1&e&&i.Ic(0,og,3,1,"div",0),2&e&&i.lc("ngIf",t.show)},directives:[Z.l],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.engine-scroll[_ngcontent-%COMP%]{display:flex;position:absolute;justify-content:center;align-items:center;top:0;bottom:0;left:0;right:0;z-index:10000;opacity:0;pointer-events:none}.engine-scroll__label[_ngcontent-%COMP%]{background:rgba(16,24,35,.5);font-size:16px;letter-spacing:.4px;line-height:1.4em;color:#fff;font-weight:600;padding:24px 32px;border-radius:40px}"],data:{animation:[Object(Zl.n)("show",[Object(Zl.m)(":enter",[Object(Zl.j)([Object(Zl.l)({opacity:"*"}),Object(Zl.e)("500ms ease-in-out",Object(Zl.l)({opacity:1})),Object(Zl.e)("500ms 2000ms ease-in-out",Object(Zl.l)({opacity:0}))])])])]},changeDetection:0}),e})();const ag=function(e,t){return{backgroundColor:e,duration:t}},cg=function(e,t){return{value:e,params:t}},lg=Object(Zl.g)([Object(Zl.l)({opacity:"0",backgroundColor:"*"}),Object(Zl.j)([Object(Zl.e)("{{ duration }}ms {{ easing }}",Object(Zl.l)({opacity:1,backgroundColor:"{{ backgroundColor }}"})),Object(Zl.e)("250ms 500ms ease-in",Object(Zl.l)({opacity:0}))])],{params:{duration:2e3,backgroundColor:"#ffffff",easing:"ease-out"}});let pg=(()=>{class e{constructor(e,t,n){this.actions=e,this.changeDetectorRef=t,this.store=n,this.color="#FFFFFF",this.duration=2e3,this.isVisible=!1,this.ngUnsubscribe=new k.a}ngOnInit(){this.initFadeListener()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initFadeListener(){this.actions.pipe(Object(d.j)(Be),Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.fadeIn(e.color,e.duration)})}handleFadeComplete(){this.store.dispatch(new He),this.isVisible=!1,this.changeDetectorRef.markForCheck()}fadeIn(e,t){this.isVisible=!0,this.color=e,this.duration=1e3*t,this.changeDetectorRef.markForCheck()}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.b),i.Pb(i.i),i.Pb(d.g))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-engine-fade"]],decls:1,vars:7,consts:[[1,"engine-fade"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.cc("@fade.done",(function(){return t.handleFadeComplete()})),i.Ub()),2&e&&i.lc("@fade",i.oc(4,cg,t.isVisible,i.oc(1,ag,t.color,t.duration)))},styles:[".engine-fade{pointer-events:none;display:block;position:absolute;left:0;right:0;top:0;bottom:0;z-index:10000}"],encapsulation:2,data:{animation:[Object(Zl.n)("fade",[Object(Zl.m)("* => true",Object(Zl.o)(lg))])]},changeDetection:0}),e})(),dg=(()=>{class e{constructor(e){this.store=e}ngOnInit(){}ngAfterViewInit(){this.nodeActionsComponent.nodeActionsTrigger.openMenu()}onNodeActionsClosed(){this.store.dispatch(new Ze(null,null))}getNodeActionsStyles(){return{"left.px":this.hit?this.hit.canvasPos[0]:0,"top.px":this.hit?this.hit.canvasPos[1]:0}}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.g))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-engine-contextmenu"]],viewQuery:function(e,t){if(1&e&&i.Ec(kd,!0),2&e){let e;i.sc(e=i.dc())&&(t.nodeActionsComponent=e.first)}},inputs:{node:"node",hit:"hit"},decls:2,vars:2,consts:[[1,"contextmenu"],["eventCategory","Context Node","theme","light",1,"contextmenu__node-actions",3,"ngStyle","node","nodeActionsClosed"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Vb(1,"app-node-actions",1),i.cc("nodeActionsClosed",(function(){return t.onNodeActionsClosed()})),i.Ub(),i.Ub()),2&e&&(i.Db(1),i.lc("ngStyle",t.getNodeActionsStyles())("node",t.node))},directives:[kd,Z.m],styles:[".contextmenu[_ngcontent-%COMP%]{left:0;top:0;width:100%;height:100%;display:block;z-index:2}.contextmenu[_ngcontent-%COMP%], .contextmenu__node-actions[_ngcontent-%COMP%]{position:absolute}"]}),e})();const ug=function(e){return{"progress__bar--complete":e}},gg=function(e){return{width:e}};let hg=(()=>{class e{constructor(e,t){this.router=e,this.changeDetector=t,this.total=100,this._value=0,this.percentWidth=0,this.ngUnsubscribe=new k.a}get value(){return this._value}set value(e){this._value=e,this.percentWidth=this.value/this.total*100,this.changeDetector.markForCheck()}ngOnInit(){this.router.events.pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{e instanceof T.d&&(this.value=0)})}ngOnDestroy(){this.changeDetector.detach(),this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(T.e),i.Pb(i.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-progress"]],inputs:{total:"total",value:"value"},decls:2,vars:7,consts:[[1,"progress"],["role","progressbar","aria-valuemin","0","aria-valuemax","100",1,"progress__bar",3,"ngClass","ngStyle"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Qb(1,"div",1),i.Ub()),2&e&&(i.Db(1),i.lc("ngClass",i.nc(3,ug,100===t.percentWidth))("ngStyle",i.nc(5,gg,t.percentWidth+"%")),i.Eb("aria-valuenow",t.percentWidth))},directives:[Z.i,Z.m],styles:["@-webkit-keyframes progressSuccess{0%{width:100%!important;background:#38de38}50%{opacity:1;background:#38de38}to{opacity:0}}@keyframes progressSuccess{0%{width:100%!important;background:#38de38}50%{opacity:1;background:#38de38}to{opacity:0}}.progress[_ngcontent-%COMP%]{border-radius:0 1px 1px 0;display:flex;align-items:center;height:4px;width:100%}.progress__bar[_ngcontent-%COMP%]{background:#de3535;height:100%;width:0}.progress__bar--complete[_ngcontent-%COMP%]{-webkit-animation:progressSuccess 2s linear forwards;animation:progressSuccess 2s linear forwards}"],changeDetection:0}),e})(),bg=(()=>{class e{constructor(e,t){this.store=e,this.changeDetectorRef=t,this.ngUnsubscribe=new k.a,this.storyLoadProgress=0}ngOnInit(){const e=this.store.select(oc.getChunkLoadProgress),t=this.store.select(za.getLoadingChunk);Object(Ta.b)(e,t).pipe(Object(I.a)(()=>{const e=this.store.selectSnapshot(za.getLoadChunks);return null!==e&&e.length>0}),Object(M.a)(this.ngUnsubscribe)).subscribe(([e,t])=>{const n=null!==t&&t.chapterId===this.store.selectSnapshot(Or.getSelectedChapterId);this.storyLoadProgress=n?e:1,this.changeDetectorRef.markForCheck()})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.g),i.Pb(i.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-engine-progress"]],decls:1,vars:2,consts:[["data-test","engineProgress",1,"engine-progress",3,"value","total"]],template:function(e,t){1&e&&i.Qb(0,"app-progress",0),2&e&&i.lc("value",t.storyLoadProgress)("total",1)},directives:[hg],styles:[".engine-progress[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;z-index:2;pointer-events:none}"],changeDetection:0}),e})(),mg=(()=>{class e{constructor(e,t){this.engineService=e,this.changeDetectionRef=t,this.camera={x:0,y:0,z:0,zoom:0,dist:0}}ngOnInit(){this.initCameraListener()}initCameraListener(){this.engineService.getEvent(At.CameraUpdated).pipe(Object(Al.a)(50)).subscribe(e=>{this.camera={x:e.eye.x.toFixed(0),y:e.eye.y.toFixed(0),z:e.eye.z.toFixed(0),zoom:Math.floor(100*Human.renderer.camera.getZoom()),dist:e.dist.toFixed(0)},this.changeDetectionRef.markForCheck()})}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(Qt),i.Pb(i.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-engine-camera-position"]],decls:2,vars:5,consts:[[1,"engine-camera-position"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Kc(1),i.Ub()),2&e&&(i.Db(1),i.Oc(" X:",null==t.camera?null:t.camera.x," Y:",null==t.camera?null:t.camera.y," Z:",null==t.camera?null:t.camera.z," Dist:",null==t.camera?null:t.camera.dist," Zoom:",null==t.camera?null:t.camera.zoom,"\n"))},styles:[".engine-camera-position[_ngcontent-%COMP%]{position:absolute;top:8px;right:8px;color:#fff;font-size:10px;text-shadow:0 0 2px rgba(0,0,0,.8);z-index:10}"],changeDetection:0}),e})();var fg=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},yg=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const xg=["engine"],vg=["engineCanvas"],Og=["engineAnnotations"];function wg(e,t){1&e&&i.Qb(0,"div",11)}function Cg(e,t){if(1&e&&i.Qb(0,"app-engine-contextmenu",12),2&e){const e=i.gc();i.lc("node",e.contextmenuNode)("hit",e.contextmenuHit)}}function Sg(e,t){1&e&&i.Qb(0,"div",13)}function _g(e,t){1&e&&i.Qb(0,"app-engine-progress",14)}function jg(e,t){1&e&&(i.Tb(0),i.Qb(1,"app-engine-camera-position"),i.Sb())}var kg=function(e){return e[e.Pan=.4]="Pan",e[e.PanSlow=.04]="PanSlow",e[e.Zoom=5]="Zoom",e[e.ZoomSlow=1]="ZoomSlow",e[e.Rotate=.3]="Rotate",e[e.RotateSlow=.03]="RotateSlow",e}({}),Pg=function(e){return e[e.Rotate=6]="Rotate",e[e.Pan=1.75]="Pan",e[e.Zoom=2.5]="Zoom",e}({}),Mg=function(e){return e[e.Zoom=-6]="Zoom",e[e.TrackZoom=.5]="TrackZoom",e[e.Pan=1.25]="Pan",e[e.Rotate=1.5]="Rotate",e[e.Friction=.85]="Friction",e[e.ZoomFriction=.85]="ZoomFriction",e[e.FrictionThreshold=.002]="FrictionThreshold",e}({}),Ig=function(e){return e.Hide="engine--cursor-hide",e.Label="engine--cursor-label",e.Paint="engine--cursor-paint",e.Eyedropper="engine--cursor-eyedropper",e.Crosshair="engine--cursor-crosshair",e.Default="",e}({}),zg=function(e){return e[e.None=0]="None",e[e.Left=1]="Left",e[e.Right=2]="Right",e[e.LeftAndRight=4]="LeftAndRight",e}({});let Tg=(()=>{class e{constructor(e,t,i,o,r,a,l,p,d,u,g,h){this.actions=e,this.cameraService=t,this.chapterService=i,this.changeDetecton=o,this.engineService=r,this.paintService=a,this.visibilityLayersService=l,this.mediaService=p,this.storageService=d,this.renderer=u,this.store=g,this.matDialog=h,this.flyCamera=!0,this.chapterActivating=!1,this.visible=!1,this.application=s,this.cursorClass=Ig.Default,this.showDebug=c.application===s.Loft||this.storageService.getLocalItem(ir.CameraDebug),this.ngUnsubscribe=new k.a,this.display=!1,this.engineVisible=!0,this.background=new bl.a(null),this.ctrlPressed=!1,this.scrollType=null,this.scrollTimeout=null,this.pinchTicks=0,this.progress="0",this.deltaTime=window.performance.now(),this.pinchMode="",this.cameraAnimating=!1,this.inputEnabled=!0,c.application===s.Loft&&n.e(6).then(n.t.bind(null,"16wW",7)).then(e=>{window.pako=e})}wheel(e){const t=this.store.selectSnapshot(Er.getScrollMode),n=e.ctrlKey;t!==Pr.DoNotCaptureShowMessage||n||this.store.dispatch(new Ve(!0)),(t===Pr.Capture||n)&&(e.preventDefault(),this.handleWheel(e))}contextmenu(e){this.handleContextMenu(e)}mouseout(){this.handleMouseOut()}convertToLeafStateMap(e,t){const n={};return Object.entries(t).forEach(([t,i])=>{n[t]={},n[t][e]=i}),n}ngOnInit(){this.particleStateListener=new Bl(this.store),this.bindEngineEvents(),this.bindApplicationEvents(),this.bindChapterChangeEvents(),this.bindCameraEvents(),this.bindToolEvents(),this.bindMouseEvents(),this.bindKeyEvents(),this.bindHumanInteractions(),this.initChangeListener(),this.initChapterAudio(),this.initBackgroundListener(),this.initPlaybackSpeedListener(),Human.properties.set({assetDomain:c.assetDomain}),Human.init.init()}ngOnDestroy(){this.changeDetecton.detach(),this.particleStateListener.destroy(),this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}bindEngineEvents(){this.engineService.getEvent(At.Loaded).pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(()=>{this.store.dispatch(new Fe(!0))}),this.engineService.getEvent(At.TimelineChaptersActivateStart).pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(()=>{this.chapterActivating=!0}),this.engineService.getEvent(At.TimelineChaptersActivateFinish).pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.chapterActivating=!1;const t=Human.timeline.activeRoot._nowBranch,n={id:t.id,init:!0,camera:t.initializedCamera,annotations:t.initializedAnnotations,graph:t.initializedGraph,properties:t.initializedProperties,particles:t.initializedParticles,clips:t.initializedClippingPlanes,postprocessing:t.initializedPostprocess,transparency:t.initializedTransparencyMode};this.store.dispatch(new We(e.chapterId)),this.store.dispatch(new Ke(n))}),this.engineService.getEvent(At.TimelineChaptersActivated).pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(()=>{this.engineService.fireEvent(At.LabelsChapterInfo,this.store.selectSnapshot(Ca.getChapterLabels))}),Object(Do.a)(this.engineService.getEvent(At.TimelinePlayed),this.engineService.getEvent(At.TimelinePaused)).pipe(Object(M.a)(this.ngUnsubscribe),Object(I.a)(()=>null!=this.store.selectSnapshot(Or.getSelectedChapterId)),Object(El.a)(50),Object(F.a)(()=>Human.timeline.playing)).subscribe(e=>{this.store.dispatch(new ct(e))}),this.engineService.getEvent(At.Tick).pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(()=>{this.visible&&(this.inputEnabled&&this.handleMouseInputEngineTick(),this.handleCameraTick(),this.deltaTime=window.performance.now())}),this.engineService.getEvent(At.TweenVisibilityUpdate).pipe(Object(qa.a)((e,t)=>JSON.stringify(e)===JSON.stringify(t)),Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{const t=Object.keys(e).filter(t=>!0===e[t]),n=Object.keys(e).filter(t=>!1===e[t]);t.length>0&&this.store.dispatch(new Ii.UpdateNodesShown(!0,t,void 0,!1,!0)),n.length>0&&this.store.dispatch(new Ii.UpdateNodesShown(!1,n,void 0,!1,!0))}),this.engineService.getEvent(At.SceneObjectRenderable).pipe(Object(Fl.a)(1e3),Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{if(e.length){const t={};e.forEach(e=>{t[e.objectId]={renderable:!0}}),this.store.dispatch(new et(t))}}),this.engineService.getEvent(At.AssetsLoadProgress).pipe(Object(Al.a)(33),Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{const t=Math.max(1,this.store.selectSnapshot(za.getLoadChunks).length),n=this.store.selectSnapshot(za.getLoadChunksRemaining).length,i=t-n,{receivedAssets:s,requestedAssets:o}=e,r=s/o,a=1/t,c=0===n?1:r*a+i*a;this.progress=c.toFixed(2),this.changeDetecton.markForCheck(),this.store.dispatch(new ec(c,r))}),this.actions.pipe(Object(d.i)(Ce),Object(M.a)(this.ngUnsubscribe)).subscribe(()=>{0===this.store.selectSnapshot(za.getLoadChunksRemaining).length&&(this.store.dispatch(new ec(1,1)),this.engineService.enableRender())}),this.engineService.getEvent(At.CameraUpdated).pipe(Object(I.a)(()=>!this.cameraAnimating),Object(M.a)(this.ngUnsubscribe)).subscribe(()=>{this.cameraAnimating=!0,this.changeDetecton.markForCheck()}),this.engineService.getEvent(At.CameraRested).pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(()=>{this.cameraAnimating=!1,this.changeDetecton.markForCheck()})}bindApplicationEvents(){this.enginePosition$.pipe(Object(I.a)(e=>null!=e),Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.repositionEngine(e)}),this.store.select(Er.getXrayModeEnabled).pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{const t=this.store.selectSnapshot(Bi.getCheckedNodes),n=this.store.selectSnapshot(Bi.getNodes);!1===e?(Object.keys(n||[]).forEach(e=>{this.paintService.paint(e,n[e].paint)}),t.forEach(e=>this.paintService.highlight(e.objectId,!0))):(this.paintService.paintAll(Object.keys(n),$i),this.paintService.paintAll(t.map(e=>e.objectId),Hi))}),this.actions.pipe(Object(d.j)(dt),Object(M.a)(this.ngUnsubscribe)).subscribe(()=>{this.playChapterFromStart()}),this.engineDisplay$.pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.display=e,this.changeDetecton.markForCheck()}),this.engineVisible$.pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.engineVisible=e,this.changeDetecton.markForCheck()}),this.visibilityLayersService.initObservables(),this.contextmenu$.pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.contextmenuNode=e.node,this.contextmenuHit=e.hit,this.changeDetecton.markForCheck()})}bindChapterChangeEvents(){this.selectedChapter$.pipe(Object(I.a)(e=>!Object(D.isNil)(e)),Object(ml.a)(),Object(M.a)(this.ngUnsubscribe)).subscribe(([e,t])=>{const n=this.chapterService.getCurrentChapterId(),i=t.id;e.id===i&&n===i||(this.store.dispatch(new Ii.SetActiveChapter(i)),Rl(this.store,this.engineService),Human.timeline.scrub({chapterId:i}),this.store.dispatch(new gn(void 0)))}),this.clippingPlanes$.pipe(Object(I.a)(e=>void 0!==e),Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{const t=Object.values(e.clips).filter(e=>e.enabled);Human.renderer.clip.reset(),t.forEach(t=>Human.renderer.clip.setClip(Object.assign({boundary:e.boundary},t)))}),Object(Ta.b)(this.selectedChapterId$,this.readyState$,this.autoplay$).pipe(Object(I.a)(([e,t,n])=>!Object(D.isNil)(e)&&!Object(D.isNil)(t)&&!Object(D.isNil)(n)),Object(M.a)(this.ngUnsubscribe)).subscribe(([,e,t])=>{const n=Object(D.get)(e,"animation",!1),i=this.store.selectSnapshot(Or.getSelectedChapter),s=Object(D.get)(i,"ui.play.autoplay",!0),o=n&&t&&s;this.store.dispatch(new rt(i,!o)),this.store.dispatch(new at(o))})}bindCameraEvents(){this.actions.pipe(Object(d.j)(Zt),Object(I.a)(e=>!Object(D.isNil)(e.camera)),Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{(e.animate?this.flyToPoint(e.camera,e.animationDuration):this.jumpToPoint(e.camera)).then(()=>{this.store.dispatch(new Jt),e.rotationCenter&&this.cameraService.setCameraRotationCenter(e.rotationCenter)})}),this.actions.pipe(Object(d.j)(rn),Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.cameraService.panCameraStatic(e.x,e.y,e.z)}),this.actions.pipe(Object(d.j)(ln),Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.cameraService.rotateCameraStatic(e.x,e.y)}),this.actions.pipe(Object(d.j)(nn),Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.cameraService.setHumanZoomFactor(e.value)}),this.actions.pipe(Object(d.j)(Je),Object(I.a)(e=>!!e.objectId),Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{e.animate?this.flyToObject(e.objectId,e.animationDuration):this.jumpToObject(e.objectId)})}bindToolEvents(){this.activeTool$.pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{switch(Object.values(Ig).forEach(e=>{e&&this.renderer.removeClass(this.engineElement.nativeElement,e)}),e){case kr.Hide:this.renderer.addClass(this.engineElement.nativeElement,Ig.Hide);break;case kr.Label:this.renderer.addClass(this.engineElement.nativeElement,Ig.Label);break;case kr.Paint:this.renderer.addClass(this.engineElement.nativeElement,Ig.Paint);break;case kr.Eyedropper:this.renderer.addClass(this.engineElement.nativeElement,Ig.Eyedropper);break;case kr.Quiz:this.renderer.addClass(this.engineElement.nativeElement,Ig.Crosshair)}})}bindMouseEvents(){this.mouseMove$=Object(Uo.a)(this.engineElement.nativeElement,"mousemove"),this.mouseMove$.pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.handleMousePan(e)}),this.mouseMove$.pipe(Object(El.a)(10),Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.handleMouseHover(e)}),this.mouseLeave$=Object(Uo.a)(this.engineElement.nativeElement,"mouseleave"),this.mouseLeave$.pipe(Object(El.a)(10),Object(M.a)(this.ngUnsubscribe)).subscribe(()=>{this.handleMouseLeave()})}bindWindowKeyEvent(e){return Object(Uo.a)(window,e).pipe(Object(I.a)(e=>Object(D.isEmpty)(this.matDialog.openDialogs)))}bindKeyEvents(){const e=["w","a","s","d","e","c","=","-","+","_","arrowleft","arrowright","arrowup","arrowdown","shiftKey"].reduce((e,t)=>(e[t]=!1,e),{}),t=new bl.a(e);let n;this.bindWindowKeyEvent("keydown").pipe(Object(I.a)(e=>!(e.repeat||e.metaKey||e.ctrlKey)),Object(I.a)(e=>{const t=e.target.nodeName.toLowerCase();return!(["input","textarea","select","option"].indexOf(t)>=0)}),Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{t.next(Object.assign(Object.assign({},t.value),{[e.key.toLowerCase()]:!0,shiftKey:e.shiftKey,hasMomentum:!1}))}),this.bindWindowKeyEvent("keyup").pipe(Object(I.a)(e=>!!e.key),Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{1===Object.values(n).filter(e=>!0===e).length?(this.applyMotion(n,!0),t.next(Object.assign(Object.assign({},t.value),{[e.key.toLowerCase()]:!1,shiftKey:e.shiftKey,hasMomentum:!1===n.shiftKey}))):t.next(Object.assign(Object.assign({},t.value),{[e.key.toLowerCase()]:!1,shiftKey:e.shiftKey,hasMomentum:!1}))}),t.pipe(Object(I.a)(()=>this.inputEnabled),Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{n=e,!1===e.hasMomentum&&this.applyMotion(e,!1)}),this.bindWindowKeyEvent("keydown").pipe(Object(I.a)(e=>"Control"===e.key),Object(M.a)(this.ngUnsubscribe)).subscribe(()=>{this.ctrlPressed=!0}),this.bindWindowKeyEvent("keyup").pipe(Object(I.a)(e=>"Control"===e.key),Object(M.a)(this.ngUnsubscribe)).subscribe(()=>{this.ctrlPressed=!1})}applyMotion(e,t){const n=new xn,i=e.shiftKey?kg.ZoomSlow:kg.Zoom,s=e.shiftKey?kg.PanSlow:kg.Pan,o=e.shiftKey?kg.RotateSlow:kg.Rotate;n.zoom+=e.c||e["-"]||e._?i:0,n.zoom-=e.e||e["="]||e["+"]?i:0,n.panX-=e.d?s:0,n.panX+=e.a?s:0,n.panY+=e.w?s:0,n.panY-=e.s?s:0,n.rotateX-=e.arrowright?o:0,n.rotateX+=e.arrowleft?o:0,n.rotateY+=e.arrowup?o:0,n.rotateY-=e.arrowdown?o:0,n.applyFriction=t,this.store.dispatch(new Yt(n))}initChangeListener(){this.store.select(Bi.getPatches).pipe(Object(I.a)(e=>e.length>0),Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{const t=e.reduce((e,t)=>{const n=t.path[t.path.length-1];return void 0!==e[n]&&e[n].push(t),e},{shown:[],checked:[],paint:[],pickable:[]}),n=e=>t[e].reduce((e,t)=>(e[t.path[2]]=t.value,e),{}),i=n("checked"),s=n("shown"),o=n("paint"),r=n("pickable");if(!Object(D.isEmpty)(s)){const e=this.store.selectSnapshot(Bi.getNodes),t=Object.values(e).reduce((e,t)=>(e[t.objectId]=t.shown,e),{});this.engineService.setNodesVisible(t);const n=this.convertToLeafStateMap("shown",t);this.store.dispatch(new Ye(n,e))}if(!Object(D.isEmpty)(i)){this.engineService.fireEvent(At.SceneObjectsSelected,{selectedObjectsUpdate:i});const e=this.store.selectSnapshot(Er.getXrayModeEnabled)?(e,t)=>this.paintService.paint(e,!0===t?Hi:$i):(e,t)=>this.paintService.highlight(e,t);Object.entries(i).forEach(([t,n])=>{e(t,n)})}if(!Object(D.isEmpty)(o))for(const[a,c]of Object.entries(o))this.paintService.colorObject(a,Fi.toEngine(c));if(!Object(D.isEmpty)(r)){const e=this.store.selectSnapshot(Bi.getNodes),t=Object.values(e).reduce((e,t)=>(e[t.objectId]=t.pickable,e),{});this.engineService.setNodesPickable(t),this.store.dispatch(new tt(this.convertToLeafStateMap("pickable",t),e))}})}initChapterAudio(){Object(Ta.b)([this.selectedChapterId$,this.playAudio$]).pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(([e,t])=>{this.playAudio(t)})}initBackgroundListener(){Object(Ta.b)([this.background$,this.engineDisplay$,this.engineVisible$]).pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(([e,t,n])=>{this.renderer.setStyle(this.engineElement.nativeElement,"background-image",gi.toCSS(e)),this.isBackgroundCheckered(e)?this.renderer.addClass(this.engineElement.nativeElement,"engine--checkered"):this.renderer.removeClass(this.engineElement.nativeElement,"engine--checkered"),this.renderer.setStyle(this.engineElement.nativeElement,"display",t?"block":"none"),this.renderer.setStyle(this.engineElement.nativeElement,"opacity",n?1:0)})}initPlaybackSpeedListener(){this.store.select(Er.getPlaybackSpeed).pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{Human.timeline.scale=e})}repositionEngine(e){this.renderer.setStyle(this.engineElement.nativeElement,"left",e.left+"px"),this.renderer.setStyle(this.engineElement.nativeElement,"top",e.top+"px"),this.renderer.setStyle(this.engineElement.nativeElement,"width",e.width+"px"),this.renderer.setStyle(this.engineElement.nativeElement,"height",e.height+"px"),this.renderer.setStyle(this.engineElement.nativeElement,"zIndex",""+e.visibility),this.renderer.setStyle(this.engineElement.nativeElement,"visibility",e.visibility===qt.Shown?"visible":"hidden"),this.visible=e.visibility===qt.Shown,Human.renderer.resize()}bindHumanInteractions(){const e=new Nl.Manager(this.engineCanvasElement.nativeElement);e.add(new Nl.Tap({event:"doubletap",taps:2,posThreshold:50})),e.add(new Nl.Tap({event:"singletap"})),e.add(new Nl.Pan({event:"pan",pointers:0})),e.add(new Nl.Pinch({event:"pinch"})),e.add(new Nl.Press({time:500})),e.on("singletap",e=>{this.handleTap(e)}),e.on("doubletap",e=>{this.handleDoubleTap(e)}),e.on("press",e=>{e.preventDefault(),e.srcEvent.stopImmediatePropagation(),this.handlePress(e)}),e.on("pan",e=>{e.preventDefault(),this.handlePan(e)}),e.on("panend",e=>{this.handlePanEnd(e)}),e.on("pinchend",e=>{this.handlePinchEnd(e)});let t=0,n=0;e.on("pinchstart",e=>{t=e.scale,this.pinchMode=""}),e.on("pinchmove",e=>{if(this.pinchTicks>0)return;const i=Math.abs(e.deltaX)>60||Math.abs(e.deltaY)>60,s=e.scale>1.25||e.scale<.75;this.pinchMode?("pan"===this.pinchMode&&s&&!i&&(this.pinchMode="pinch"),"pinch"===this.pinchMode&&i&&!s&&(this.pinchMode="pan")):this.pinchMode=s?"pinch":"pan";const o=e.scale-t;t=e.scale;const r=n;n=0===o?0:o>0?1:-1,this.cameraService.setCameraPan(e.velocityX*Mg.Pan,e.velocityY*Mg.Pan),n+r!==0&&this.cameraService.setHumanZoom(o*Mg.Zoom)})}handleMouseHover(e){if(e.buttons!==zg.None)return;const{offsetX:t,offsetY:n}=e,i=Human.renderer.pick.pick(t,n);if(i.objectId){const e=this.store.selectSnapshot(Er.getViewGraph),t=this.engineService.getNode(e,i.objectId),n=this.store.selectSnapshot(Er.getHoveredNode);n&&n.id===t.id||this.store.dispatch(new _t(t,i))}else null!=this.store.selectSnapshot(Er.getHoveredNode)&&this.store.dispatch(new _t(null))}handleMouseLeave(){this.store.dispatch(new _t(null))}handleMousePan(e){if(2===e.buttons||4===e.buttons){let{movementX:t,movementY:n}=e;t/=16,n/=16,this.cameraService.setCameraPan(t,n)}}handleMouseOut(){this.store.dispatch(new _t(null))}handleWheel(e){let t=0;switch(e.deltaMode){case 0:null===this.scrollType&&(this.scrollType=Math.abs(e.deltaY)<10?"trackpad":"wheel"),t="trackpad"===this.scrollType?e.deltaY*Mg.TrackZoom:Math.sign(e.deltaY)*Pg.Zoom;break;default:this.scrollType="wheel",t=e.deltaY*Pg.Zoom}clearTimeout(this.scrollTimeout),this.scrollTimeout=setTimeout(()=>{this.scrollType=null},500),Math.abs(t)>40&&(t=40*Math.sign(t)),"trackpad"===this.scrollType?this.cameraService.setCameraZoom(t):this.zoomWithVelocity(t)}zoomWithVelocity(e){this.cameraService.setCameraZoom(e),requestAnimationFrame(()=>{e*=.85,Math.abs(e)>1&&this.zoomWithVelocity(e)})}handleContextMenu(e){e.preventDefault();const{offsetX:t,offsetY:n}=e,i=this.getHit(t,n),s=this.getNodeFromHit(i);this.store.dispatch(new Ze(s,i))}handlePanEnd(e){const t=this.store.selectSnapshot(jr.getCameraMotion);if(this.pinchTicks>0||t.panX===e.velocityX&&t.panY===e.velocityY)return;const n=this.store.selectSnapshot(jr.getPanMode);e.srcEvent.shiftKey||"pan"===n?(t.panX=e.velocityX*Mg.Pan,t.panY=e.velocityY*Mg.Pan):(t.rotateX=e.velocityX*Mg.Rotate,t.rotateY=e.velocityY*Mg.Rotate),t.applyFriction=!0,this.store.dispatch(new Yt(t))}handlePinchEnd(e){const t=this.store.selectSnapshot(jr.getCameraMotion);if("pan"===this.pinchMode)t.panX=e.velocityX*Mg.Pan,t.panY=e.velocityY*Mg.Pan;else{const n=e.velocity>0?1:-1;t.zoom=Math.sqrt(e.velocityX*e.velocityX+e.velocityY*e.velocityY)*-n*Mg.Zoom}t.applyFriction=!0,this.store.dispatch(new Yt(t)),this.pinchTicks=10}handleTap(e){const{offsetX:t,offsetY:n}=this.getOffset(e),i=this.getHit(t,n),s=this.getNodeFromHit(i);this.store.dispatch(new Ge(s,e,i))}handleDoubleTap(e){const{offsetX:t,offsetY:n}=this.getOffset(e),i=this.getHit(t,n),s=this.getNodeFromHit(i);s&&this.store.dispatch(new Je(s.id))}handlePress(e){const{offsetX:t,offsetY:n}=this.getOffset(e),i=this.getHit(t,n),s=this.getNodeFromHit(i);s&&this.store.dispatch(new Je(s.id))}handlePan(e){if(this.pinchTicks>0)return;const t=this.store.selectSnapshot(jr.getPanMode),{velocityX:n,velocityY:i}=e;e.srcEvent.shiftKey||"pan"===t?this.cameraService.setCameraPan(n*Mg.Pan,i*Mg.Pan):this.cameraService.setCameraRotation(n*Mg.Rotate,i*Mg.Rotate)}handleMouseInputEngineTick(){const e=this.cameraService.tickCameraRotation(),t=this.cameraService.tickCameraPan(),n=this.cameraService.tickCameraZoom(),i=Math.min(15,(window.performance.now()-this.deltaTime)/16.666666666666668);if((e.vx||e.vy)&&this.cameraService.rotateCameraStatic(0!==e.vx?i*e.vx*Pg.Rotate:0,0!==e.vy?i*e.vy*Pg.Rotate:0),t.x||t.y){const e=Math.max(Human.renderer.camera.lookDistance/80,.01);this.cameraService.panCameraStatic(i*t.x*e*Pg.Pan,i*t.y*e*Pg.Pan,i*t.z*e*Pg.Pan)}0!==n&&this.cameraService.setHumanZoom(i*n*Pg.Zoom)}handleCameraTick(){this.pinchTicks>0&&this.pinchTicks--,this.applyFriction();const e=this.store.selectSnapshot(jr.getCameraMotion);this.cameraService.setCameraPan(e.panX,e.panY),this.cameraService.setCameraRotation(e.rotateX,e.rotateY),this.cameraService.setCameraZoom(e.zoom)}getFriction(e){if(0===e)return 0;const t=(window.performance.now()-this.deltaTime)/16.666666666666668;let n=e*Math.max(0,Mg.Friction+.1*(1-t));return Math.abs(n)<Mg.FrictionThreshold&&(n=0),n}applyFriction(){const e=this.store.selectSnapshot(jr.getCameraMotion);!0===e.applyFriction&&(e.rotateX=this.getFriction(e.rotateX),e.rotateY=this.getFriction(e.rotateY),e.panX=this.getFriction(e.panX),e.panY=this.getFriction(e.panY),e.zoom=this.getFriction(e.zoom),0===e.rotateX&&0===e.rotateY&&0===e.panX&&0===e.panY&&0===e.zoom&&(e.applyFriction=!1),this.store.dispatch(new Yt(e)))}flyToObject(e,t){Human.renderer.camera.fly.flyTo({objectId:e,animationDuration:t})}jumpToObject(e){Human.renderer.camera.fly.jumpTo({objectId:e})}flyToPoint(e,t){return new Promise(n=>{Human.renderer.camera.fly.flyTo(Object.assign(Object.assign({},e),{animationDuration:t}),n)})}jumpToPoint(e){return new Promise(t=>{Human.renderer.camera.fly.jumpTo(e,t)})}getNodeFromHit(e){let t;if(e.objectId){const n=this.store.selectSnapshot(Er.getViewGraph);t=this.engineService.getNode(n,e.objectId)}return t}getHit(e,t){return Human.renderer.pick.pick(e,t,{rayPick:!0})}getOffset(e){let t=0,n=0;e.center?(t=e.center.x,n=e.center.y):(t=e.clientX,n=e.clientY);const i=this.engineElement.nativeElement.getBoundingClientRect();return{offsetX:t-i.left,offsetY:n-i.top}}playAudio(e){e=Object(D.isNil)(e)?this.store.selectSnapshot(Er.getPlayAudio):e,this.mediaService.stopAudio();const t=this.store.selectSnapshot(Or.getSelectedChapterAudio),n=Object(D.get)(t,"data.fullUrl");if(n){let t=this.mediaService.getAudioPlayer(n);t||(t=this.mediaService.addAudioPlayer(n)),e?t.play():t.stop()}}playChapterFromStart(){const e=this.store.selectSnapshot(Or.getSelectedChapter);this.playAudio(),this.store.dispatch(new rt(e)),this.store.dispatch(new at(!0))}isTransparentBackground(e){return!!e&&gi.isTransparent(this.background.getValue())}isBackgroundCheckered(e){return c.application!==s.Viewer&&this.isTransparentBackground(e)}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.b),i.Pb(yn),i.Pb(to),i.Pb(i.i),i.Pb(Qt),i.Pb(Hl),i.Pb(ql),i.Pb(Gl),i.Pb(ar),i.Pb(i.H),i.Pb(d.g),i.Pb(nl.b))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-engine"]],viewQuery:function(e,t){if(1&e&&(i.Ec(xg,!0),i.Ec(vg,!0),i.Ec(Og,!0)),2&e){let e;i.sc(e=i.dc())&&(t.engineElement=e.first),i.sc(e=i.dc())&&(t.engineCanvasElement=e.first),i.sc(e=i.dc())&&(t.engineAnnotationsElement=e.first)}},hostBindings:function(e,t){1&e&&i.cc("wheel",(function(e){return t.wheel(e)}))("contextmenu",(function(e){return t.contextmenu(e)}))("mouseout",(function(e){return t.mouseout(e)}))},inputs:{inputEnabled:"inputEnabled"},decls:16,vars:11,consts:[["id","container","data-test","engine","role","complementary",1,"engine"],["engine",""],["class","engine__watermark","role","img","aria-label","watermark","data-test","engineWatermark",4,"ngIf"],["id","theCanvas","data-test","engineCanvas",1,"engine__canvas"],["engineCanvas",""],["id","annotationCanvas",1,"engine__annotations"],["engineAnnotations",""],[3,"node","hit",4,"ngIf"],["data-test","engineInputBlocker","class","engine__input-blocking",4,"ngIf"],["data-test","engineProgressBar",4,"ngIf"],[4,"ngIf"],["role","img","aria-label","watermark","data-test","engineWatermark",1,"engine__watermark"],[3,"node","hit"],["data-test","engineInputBlocker",1,"engine__input-blocking"],["data-test","engineProgressBar"]],template:function(e,t){1&e&&(i.Vb(0,"div",0,1),i.Ic(2,wg,1,0,"div",2),i.hc(3,"async"),i.Qb(4,"canvas",3,4),i.Qb(6,"canvas",5,6),i.Qb(8,"app-labels"),i.Ic(9,Cg,1,2,"app-engine-contextmenu",7),i.Ic(10,Sg,1,0,"div",8),i.Ic(11,_g,1,0,"app-engine-progress",9),i.hc(12,"async"),i.Qb(13,"app-engine-scroll"),i.Qb(14,"app-engine-fade"),i.Ic(15,jg,2,0,"ng-container",10),i.Ub()),2&e&&(i.Eb("data-progress",t.progress)("data-camera-animating",t.cameraAnimating),i.Db(2),i.lc("ngIf",i.ic(3,7,t.watermarkEnabled$)),i.Db(7),i.lc("ngIf",t.contextmenuNode),i.Db(1),i.lc("ngIf",!t.inputEnabled),i.Db(1),i.lc("ngIf",i.ic(12,9,t.showProgressBar$)),i.Db(4),i.lc("ngIf",t.showDebug))},directives:[Z.l,sg,rg,pg,dg,bg,mg],pipes:[Z.b],styles:[".engine[_ngcontent-%COMP%]{-webkit-tap-highlight-color:rgba(0,0,0,0);-webkit-tap-highlight-color:transparent;position:fixed;width:100vw;height:100vh;overflow:hidden;visibility:hidden;z-index:-1;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.engine__canvas[_ngcontent-%COMP%]{display:block;position:absolute;width:100%;height:100%;z-index:1}.engine__annotations[_ngcontent-%COMP%]{display:none}.engine--cursor-eyedropper[_ngcontent-%COMP%]:hover{cursor:url(/assets/images/cursors/cursor-eyedropper.png) 7 20,pointer}.engine--cursor-paint[_ngcontent-%COMP%]:hover{cursor:url(/assets/images/cursors/cursor-paint.png) 7 20,pointer}.engine--cursor-hide[_ngcontent-%COMP%]:hover{cursor:url(/assets/images/cursors/cursor-hide.png) 7 20,pointer}.engine--cursor-label[_ngcontent-%COMP%]:hover{cursor:url(/assets/images/cursors/cursor-label.png) 7 20,pointer}.engine--cursor-crosshair[_ngcontent-%COMP%]:hover{cursor:crosshair}.engine--checkered[_ngcontent-%COMP%]{background-color:#fff;background-size:24px 24px;background-position:0 0,12px 12px;background-image:linear-gradient(45deg,#d7e0ea 25%,transparent 0,transparent 75%,#d7e0ea 0,#d7e0ea),linear-gradient(45deg,#d7e0ea 25%,transparent 0,transparent 75%,#d7e0ea 0,#d7e0ea)}.engine__controls[_ngcontent-%COMP%]{position:absolute;right:16px;bottom:16px;z-index:2}.engine__progress[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;z-index:2}.engine__progress--hide[_ngcontent-%COMP%]{display:none}.engine__input-blocking[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0;z-index:3}.engine__watermark[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;z-index:101;pointer-events:none;background-image:url(/assets/images/BioDigital_watermark_1024x768.svg);background-repeat:no-repeat;background-position:50%;background-size:auto}@media (max-width:768px){.engine__controls[_ngcontent-%COMP%]{bottom:96px}}@media (max-width:959px){.engine__watermark[_ngcontent-%COMP%]{background-image:url(/assets/images/BioDigital_watermark_959x100.svg);background-size:contain}}"],changeDetection:0}),fg([Object(d.d)(Er.getReady),yg("design:type",P.a)],e.prototype,"ready$",void 0),fg([Object(d.d)(Er.getViewGraph),yg("design:type",P.a)],e.prototype,"viewGraph$",void 0),fg([Object(d.d)(Er.getEnginePosition),yg("design:type",P.a)],e.prototype,"enginePosition$",void 0),fg([Object(d.d)(Er.getHoveredNode),yg("design:type",P.a)],e.prototype,"hoveredNode$",void 0),fg([Object(d.d)(Er.getChapter),yg("design:type",P.a)],e.prototype,"chapter$",void 0),fg([Object(d.d)(Er.getChapterInit),yg("design:type",P.a)],e.prototype,"chapterInit$",void 0),fg([Object(d.d)(Bi.getCheckedNodes),yg("design:type",P.a)],e.prototype,"checkedNodes$",void 0),fg([Object(d.d)(Er.getActiveTool),yg("design:type",P.a)],e.prototype,"activeTool$",void 0),fg([Object(d.d)(Er.getAnimationPlaying),yg("design:type",P.a)],e.prototype,"animationPlaying$",void 0),fg([Object(d.d)(Er.getAutoplay),yg("design:type",P.a)],e.prototype,"autoplay$",void 0),fg([Object(d.d)(Er.getPlayAudio),yg("design:type",P.a)],e.prototype,"playAudio$",void 0),fg([Object(d.d)(Er.getDisplay),yg("design:type",P.a)],e.prototype,"engineDisplay$",void 0),fg([Object(d.d)(Er.getVisible),yg("design:type",P.a)],e.prototype,"engineVisible$",void 0),fg([Object(d.d)(Er.getShowProgressBar),yg("design:type",P.a)],e.prototype,"showProgressBar$",void 0),fg([Object(d.d)(Er.getContextmenu),yg("design:type",P.a)],e.prototype,"contextmenu$",void 0),fg([Object(d.d)(Or.getSelectedChapter),yg("design:type",P.a)],e.prototype,"selectedChapter$",void 0),fg([Object(d.d)(Or.getSelectedChapterId),yg("design:type",P.a)],e.prototype,"selectedChapterId$",void 0),fg([Object(d.d)(Or.getSelectedChapterReadyState),yg("design:type",P.a)],e.prototype,"readyState$",void 0),fg([Object(d.d)(Or.getSelectedChapterClippingPlanes),yg("design:type",P.a)],e.prototype,"clippingPlanes$",void 0),fg([Object(d.d)(jr.getCameraMotion),yg("design:type",P.a)],e.prototype,"cameraMotion$",void 0),fg([Object(d.d)(Or.getSelectedChapterBackground),yg("design:type",P.a)],e.prototype,"background$",void 0),fg([Object(d.d)(Er.getWatermarkEnabled),yg("design:type",P.a)],e.prototype,"watermarkEnabled$",void 0),e})();var Ug=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let Dg=(()=>{class e{constructor(e,t,n,i,s){this.store=e,this.router=t,this.ga=n,this.pendoService=i,this.globalActionsService=s,this.title="Biodigital Human",this.ngUnsubscribe=new k.a}ngOnInit(){this.initPendo(),this.initPageAnalytics(),this.initInputObserver(),this.globalActionsService.initialize()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initPendo(){this.pendoService.appendScript(),this.pendoService.initialize({visitor:{id:""},account:{}})}initInputObserver(){this.inputEnabled$.pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.store.dispatch(new j.SetInputEnabled(e))})}initPageAnalytics(){this.router.events.pipe(Object(I.a)(e=>e instanceof T.c),Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.ga.pageView(e.urlAfterRedirects)})}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.g),i.Pb(T.e),i.Pb(U.c),i.Pb(G),i.Pb(Ll))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-root"]],decls:3,vars:3,consts:[[3,"inputEnabled"]],template:function(e,t){1&e&&(i.Qb(0,"app-engine",0),i.hc(1,"async"),i.Qb(2,"router-outlet")),2&e&&i.lc("inputEnabled",i.ic(1,1,t.inputEnabled$))},directives:[Tg,T.g],pipes:[Z.b],styles:[""],changeDetection:0}),function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);o>3&&r&&Object.defineProperty(t,n,r)}([Object(d.d)(_.getInputEnabled),Ug("design:type",P.a)],e.prototype,"inputEnabled$",void 0),e})();var Lg=n("imBb"),Eg=n("7sSR"),Fg=function(e){return e[e.Main=0]="Main",e[e.Media=1]="Media",e[e.Tools=2]="Tools",e[e.Whiteboard=3]="Whiteboard",e[e.VisibilityLayers=4]="VisibilityLayers",e[e.Empty=5]="Empty",e}({});let Ag=(()=>{class e{constructor(e,t,n){this.store=e,this.engineService=t,this.viewService=n}startQuiz(){this.viewService.toggleColumn(!0),this.store.dispatch(new ns.SetQuizActive(!0));const e=this.store.selectSnapshot(xs.getAllQuestions)[0].id;this.store.dispatch(new ns.SetActiveQuestion(e))}resetQuiz(){this.viewService.clearFadedNodes(),this.viewService.clearSelectedNodes(),this.store.dispatch(new ns.SetQuizActive(!1)),this.store.dispatch(new ns.SetActiveSubmission(void 0)),this.store.dispatch(new ns.ClearSubmissions),this.store.dispatch(new ns.SetQuizLifecycle(ds.Question))}exitQuiz(){this.resetQuiz(),setTimeout(()=>{this.store.dispatch(new Zt(this.store.selectSnapshot(Or.getChapterCamera),!1))})}submitQuestion(e,t){const n=this.store.selectSnapshot(xs.getAllQuestions).find(t=>t.id===e),{launchMode:i,quizSettings:s}=this.store.selectSnapshot(xs);this.store.dispatch(new ns.SubmitQuestionAnswer({questionId:n.id,answer:t})),this.store.dispatch(new ns.SetActiveSubmission({questionId:n.id,answer:t})),this.engineService.fireEvent(At.QuizAnswerSubmitted,{questionId:n.id,answer:t}),i===hs.Learning&&n.type!==ss.Instructions&&!1!==s.showExplanation?this.store.dispatch(new ns.SetQuizLifecycle(ds.Explanation)):this.nextQuestion()}nextQuestion(){this.store.selectSnapshot(xs.hasQuestionRemaining)?(this.store.dispatch(new ns.SetQuizLifecycle(ds.Question)),this.viewService.clearFadedNodes(),this.viewService.clearSelectedNodes(),this.store.dispatch(new ns.NextQuestion)):(this.store.dispatch(new ns.SetQuizLifecycle(ds.Review)),this.engineService.fireEvent(At.QuizCompleted,!0))}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(d.g),i.Zb(Qt),i.Zb(Dl))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var Rg;!function(e){e.normalize=function(e){return(""+(e||"")).replace(/&#(\d+);/g,(e,t)=>String.fromCharCode(t)).replace(/(&.+;)/gi,(e,t)=>String.fromCharCode(e.charCodeAt(0)))},e.prettyPrint=function(e){return(""+(e||"")).trim().replace(/([A-Z])/g," $1").replace(/^./,e=>e.toUpperCase()).trim()},e.parseEmails=function(e){return e.split(",").map(e=>e.trim()).filter(e=>!!e)},e.validateEmail=function(e){return/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/.test(e)},e.toTitleCase=function(e){return e.replace(/\w\S*/g,e=>e.charAt(0).toUpperCase()+e.substring(1).toLowerCase())}}(Rg||(Rg={}));var Vg=n("wf0l");let Ng=(()=>{class e{transform(e,t){return function(e){if(null==e)return"";const t=new RegExp(/[^a-zA-Z0-9_]/,"gi");return e.replace(t,"_")}(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=i.Ob({name:"elementID",type:e,pure:!0}),e})();var Bg=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},Hg=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const Qg=["chapterMenu"];function $g(e,t){1&e&&i.jc(0)}function qg(e,t){1&e&&i.Rb(0)}function Wg(e,t){if(1&e){const e=i.Wb();i.Tb(0),i.Vb(1,"button",5),i.cc("menuOpened",(function(){return i.xc(e),i.gc().handleMenuOpened()})),i.Ic(2,qg,1,0,"ng-container",6),i.Ub(),i.Sb()}if(2&e){const e=i.gc(),t=i.tc(5),n=i.tc(1);i.Db(1),i.lc("buttonShape",e.buttonShape)("fill",!0)("matMenuTriggerFor",t),i.Db(1),i.lc("ngTemplateOutlet",n)}}function Kg(e,t){1&e&&(i.Vb(0,"span",12),i.Kc(1,"current"),i.Ub())}const Gg=function(e,t){return{"view-chapters__item--viewed":e,"view-chapters__item--selected":t}};function Zg(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",7),i.cc("click",(function(){i.xc(e);const n=t.$implicit;return i.gc().handleChapterClick(n)})),i.hc(1,"elementID"),i.hc(2,"async"),i.Vb(3,"div",8),i.Kc(4),i.Ub(),i.Vb(5,"div",9),i.Kc(6),i.Ub(),i.Ic(7,Kg,2,0,"span",10),i.hc(8,"async"),i.Qb(9,"div",11),i.Ub()}if(2&e){const e=t.$implicit,n=t.index,s=i.gc();i.lc("ngClass",i.oc(13,Gg,s.isViewed(e.id),e.id===i.ic(2,9,s.selectedChapterId$))),i.Eb("data-chapter-id",i.ic(1,7,e.id)),i.Db(4),i.Mc("",n+1,"."),i.Db(2),i.Lc(e.info.displayName),i.Db(1),i.lc("ngIf",e.id===i.ic(8,11,s.selectedChapterId$)),i.Db(2),i.lc("defaultImage",s.defaultImage)("lazyLoad",s.getChapterThumb(e.id))}}const Jg=["*"];let Xg=(()=>{class e{constructor(e,t){this.store=e,this.viewService=t,this.defaultImage="/assets/images/view-chapter-thumbnail-placeholder.png",this.buttonShape="circle"}handleChapterClick(e){this.viewService.selectChapter(e)}handleMenuOpened(){const e=this.store.selectSnapshot(Or.getSelectedChapterIndex);this.chapterMenu._allItems.toArray()[e].focus()}getChapterThumb(e){const t=this.store.selectSnapshot(qs.getRegisteredThumbnails).get(e);return t?t.snapshot||t.urls.small:""}isViewed(e){return this.store.selectSnapshot(Or.getChaptersViewed).some(t=>t===e)}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.g),i.Pb(Dl))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-chapters"]],viewQuery:function(e,t){if(1&e&&i.Ec(Qg,!0),2&e){let e;i.sc(e=i.dc())&&(t.chapterMenu=e.first)}},inputs:{defaultImage:"defaultImage",buttonShape:"buttonShape"},ngContentSelectors:Jg,decls:8,vars:7,consts:[["contentTmp",""],[4,"ngIf","ngIfElse"],[1,"view-chapters"],["chapterMenu","matMenu"],["mat-menu-item","","class","view-chapters__item",3,"ngClass","click",4,"ngFor","ngForOf"],["app-pin-button","","buttonAlign","left","buttonType","ghost","data-test","viewChaptersButton",1,"w-100","h-100",3,"buttonShape","fill","matMenuTriggerFor","menuOpened"],[4,"ngTemplateOutlet"],["mat-menu-item","",1,"view-chapters__item",3,"ngClass","click"],[1,"view-chapters__index"],[1,"view-chapters__title"],["class","visually-hidden",4,"ngIf"],[1,"view-chapters__thumb",3,"defaultImage","lazyLoad"],[1,"visually-hidden"]],template:function(e,t){if(1&e&&(i.kc(),i.Ic(0,$g,1,0,"ng-template",null,0,i.Jc),i.Ic(2,Wg,3,4,"ng-container",1),i.hc(3,"async"),i.Vb(4,"mat-menu",2,3),i.Ic(6,Zg,10,16,"button",4),i.hc(7,"async"),i.Ub()),2&e){const e=i.tc(1);let n=null;i.Db(2),i.lc("ngIf",(null==(n=i.ic(3,3,t.chapters$))?null:n.length)>1)("ngIfElse",e),i.Db(4),i.lc("ngForOf",i.ic(7,5,t.chapters$))}},directives:[Z.l,gd.a,Z.k,ou,gd.d,Z.q,gd.b,Z.i,Vg.a],pipes:[Z.b,Ng],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3535}.text-info{color:#2d72dc}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.view-chapters{min-width:300px;max-height:320px;overflow:auto;padding:8px}.view-chapters button.mat-menu-item{height:auto;font-size:14px;letter-spacing:.35px;line-height:1.4em}.view-chapters button.mat-button-toggle-focus-overlay{display:none}.view-chapters__item{height:auto;white-space:normal;display:flex!important;padding:8px!important;border-radius:4px;border:2px solid transparent;background-color:transparent;color:#131c2a;margin-bottom:4px;transition:background-color 125ms,color 125ms,border 125ms}.view-chapters__item:hover{cursor:pointer;background:#eaeff5}.view-chapters__item--selected{border-color:#2d72dc}.view-chapters__index{display:flex;flex:0 0 32px;justify-content:center}.view-chapters__thumb{background-color:#f9fafd;border-radius:4px;background-repeat:no-repeat;flex:0 0 56px;height:56px;width:56px;transition:border-color .1s}.view-chapters__title{word-wrap:break-word;overflow-wrap:break-word;word-break:break-word;white-space:normal;display:flex;flex:1 1 auto;padding-right:4px}.view-chapters__thumb{background-size:cover}"],encapsulation:2,changeDetection:0}),Bg([Object(d.d)(Or.getStoryChapters),Hg("design:type",P.a)],e.prototype,"chapters$",void 0),Bg([Object(d.d)(Or.getSelectedChapterId),Hg("design:type",P.a)],e.prototype,"selectedChapterId$",void 0),Bg([Object(d.d)(Or.getSelectedChapterIndex),Hg("design:type",P.a)],e.prototype,"selectedChapterIndex$",void 0),Bg([Object(d.d)(qs.getRegisteredThumbnails),Hg("design:type",P.a)],e.prototype,"thumbnails$",void 0),Bg([Object(d.d)(Or.getChaptersViewed),Hg("design:type",P.a)],e.prototype,"chaptersViewed$",void 0),e})(),Yg=(()=>{class e{transform(e,t){return Rg.normalize(""+(e||""))}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=i.Ob({name:"textNormalize",type:e,pure:!0}),e})();var eh=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},th=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const nh=function(e){return{"view-description__story-title--large":e}};function ih(e,t){if(1&e&&(i.Vb(0,"h1",7),i.Kc(1),i.Ub()),2&e){const e=i.gc();i.lc("ngClass",i.nc(2,nh,!e.chapterTitle)),i.Db(1),i.Mc(" ",e.storyTitle," ")}}function sh(e,t){if(1&e&&(i.Vb(0,"span"),i.Kc(1),i.hc(2,"async"),i.Ub()),2&e){const e=i.gc();i.Db(1),i.Mc("",i.ic(2,1,e.chapterIndex$)+1,".")}}function oh(e,t){1&e&&i.Qb(0,"app-icon",8)}const rh=function(e,t){return{"view-title--clickable":e,"view-title--large":t}};let ah=(()=>{class e{constructor(e,t){this.layoutService=e,this.changeDetectorRef=t,this._isPopulated=!1,this.isPopulatedChange=new i.p,this._menuEnabled=!0,this.viewLayout=Xa,this.ngUnsubscribe=new k.a,this.storyTitle="",this.chapterTitle=""}get isPopulated(){return this._isPopulated}set isPopulated(e){this._isPopulated=e,this.isPopulatedChange.emit(this.isPopulated)}get menuEnabled(){return this._menuEnabled}set menuEnabled(e){this._menuEnabled=e}ngOnInit(){this.initContentListener(),this.initLayoutListener()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}isEnabled(e){return this.layoutService.isUIEnabled(e)}initContentListener(){Object(Ta.b)([this.story$,this.chapter$]).pipe(Object(I.a)(([e,t])=>null!=t&&null!=e),Object(M.a)(this.ngUnsubscribe)).subscribe(([e,t])=>{this.storyTitle=c.application!==s.Viewer?Rg.normalize(e.displayName):"",this.chapterTitle=Rg.normalize(t.info.displayName),this.isPopulated=!!this.chapterTitle||!!this.storyTitle})}initLayoutListener(){this.layout$.pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(()=>{this.changeDetectorRef.markForCheck()})}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(rc),i.Pb(i.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-title"]],viewQuery:function(e,t){if(1&e&&i.Pc(Xg,!0),2&e){let e;i.sc(e=i.dc())&&(t.chapterListComponentMenu=e.first)}},inputs:{size:"size",isPopulated:"isPopulated",menuEnabled:"menuEnabled"},outputs:{isPopulatedChange:"isPopulatedChange"},decls:12,vars:16,consts:[[1,"view-title",3,"ngClass"],["buttonShape","square"],[1,"p-2"],["id","view-title","class","view-title__story",3,"ngClass",4,"ngIf"],["id","view-title",1,"view-title__chapter"],[4,"ngIf"],["icon","caret-down",4,"ngIf"],["id","view-title",1,"view-title__story",3,"ngClass"],["icon","caret-down"]],template:function(e,t){1&e&&(i.Vb(0,"section",0),i.hc(1,"async"),i.Vb(2,"app-view-chapters",1),i.Vb(3,"div",2),i.Ic(4,ih,2,4,"h1",3),i.Vb(5,"h1",4),i.Ic(6,sh,3,3,"span",5),i.hc(7,"async"),i.Kc(8),i.hc(9,"textNormalize"),i.Ic(10,oh,1,0,"app-icon",6),i.hc(11,"async"),i.Ub(),i.Ub(),i.Ub(),i.Ub()),2&e&&(i.lc("ngClass",i.oc(13,rh,i.ic(1,5,t.chapterCount$)>1&&t.menuEnabled,"large"===t.size)),i.Db(4),i.lc("ngIf",t.storyTitle&&t.storyTitle!=t.chapterTitle),i.Db(2),i.lc("ngIf",i.ic(7,7,t.chapterCount$)>1&&t.menuEnabled),i.Db(2),i.Mc(" ",i.ic(9,9,t.chapterTitle)," "),i.Db(2),i.lc("ngIf",i.ic(11,11,t.chapterCount$)>1&&t.menuEnabled))},directives:[Z.i,Xg,Z.l,dl],pipes:[Z.b,Yg],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3535}.text-info{color:#2d72dc}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.view-title{word-wrap:break-word;overflow-wrap:break-word;border-radius:4px;padding:4px;margin:0 -4px;transition:background-color 125ms}.view-title--large{font-size:18px;letter-spacing:.45px;line-height:1.4em}.view-title__story{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase;word-wrap:break-word;overflow-wrap:break-word;text-align:left;font-weight:600;color:var(--view-description-secondary-color)}.view-title__chapter{font-size:14px;letter-spacing:.35px;line-height:1.4em;text-align:left;font-weight:600;color:#131c2a}"],encapsulation:2,changeDetection:0}),eh([Object(d.d)(za.getStory),th("design:type",P.a)],e.prototype,"story$",void 0),eh([Object(d.d)(Or.getSelectedChapter),th("design:type",P.a)],e.prototype,"chapter$",void 0),eh([Object(d.d)(Or.getChapterCount),th("design:type",P.a)],e.prototype,"chapterCount$",void 0),eh([Object(d.d)(Or.getSelectedChapterIndex),th("design:type",P.a)],e.prototype,"chapterIndex$",void 0),eh([Object(d.d)(mr.getUI),th("design:type",P.a)],e.prototype,"layout$",void 0),e})();function ch(e,t){if(1&e&&(i.Vb(0,"div",2),i.Vb(1,"h2",3),i.Kc(2),i.Ub(),i.jc(3,1,["class","view-panel__actions","actions",""]),i.Ub()),2&e){const e=i.gc();i.Db(2),i.Mc(" ",e.label," ")}}const lh=["*",[["","actions",""]]],ph=function(e,t){return{"view-panel--padding-none":e,"view-panel--padding-dense":t}},dh=["*","[actions]"];let uh=(()=>{class e{constructor(){this.label="",this.showHeader=!0,this.padding="normal"}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-panel"]],inputs:{label:"label",showHeader:"showHeader",padding:"padding"},ngContentSelectors:dh,decls:3,vars:5,consts:[[1,"view-panel",3,"ngClass"],["class","view-panel__header",4,"ngIf"],[1,"view-panel__header"],[1,"view-panel__label"]],template:function(e,t){1&e&&(i.kc(lh),i.Vb(0,"div",0),i.Ic(1,ch,4,1,"div",1),i.jc(2),i.Ub()),2&e&&(i.lc("ngClass",i.oc(2,ph,"none"===t.padding,"dense"===t.padding)),i.Db(1),i.lc("ngIf",t.showHeader))},directives:[Z.i,Z.l],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3535}.text-info{color:#2d72dc}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.view-panel{border-bottom:1px solid #eaeff5;padding:0 0 32px;margin-bottom:16px}.view-panel--padding-none{padding:0;margin:0}.view-panel--padding-dense{padding:0 0 8px;margin:0 0 8px}.view-panel__label{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase;color:#374a68;font-weight:600;display:flex;align-items:center;min-height:28px}.view-panel__header{display:flex;flex-direction:row;align-items:flex-start;justify-content:space-between;margin-bottom:16px}"],encapsulation:2,changeDetection:0}),e})();var gh=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},hh=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function bh(e,t){if(1&e&&(i.Vb(0,"div",3),i.Qb(1,"app-html",4),i.Ub()),2&e){const e=i.gc();i.Db(1),i.lc("markdownText",e.chapterDescription)}}const mh=function(e,t){return{"view-description--layout-column":e,"view-description--layout-drawer":t}};let fh=(()=>{class e{constructor(e,t,n){this.viewService=e,this.layoutService=t,this.changeDetectorRef=n,this.viewLayout=Xa,this.ngUnsubscribe=new k.a,this.storyTitle="",this.chapterTitle="",this.chapterDescription="",this.layout=Ya.Drawer,this._isPopulated=!1,this.isPopulatedChange=new i.p}get isPopulated(){return this._isPopulated}set isPopulated(e){this._isPopulated=e,this.isPopulatedChange.emit(this.isPopulated)}ngOnInit(){this.initContentListener(),this.initLayoutListener()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}isEnabled(e){return this.layoutService.isUIEnabled(e)}initContentListener(){Object(Ta.b)(this.story$,this.chapter$).pipe(Object(I.a)(([e,t])=>null!=e&&null!=t),Object(M.a)(this.ngUnsubscribe)).subscribe(([e,t])=>{this.storyTitle=c.application!==s.Viewer?Rg.normalize(e.displayName):"",this.chapterTitle=Rg.normalize(t.info.displayName),this.chapterDescription=Object(D.trim)(t.info.description),this.isPopulated=""!==this.storyTitle||!!this.chapterTitle||!!this.chapterDescription})}initLayoutListener(){this.layout$.pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.changeDetectorRef.markForCheck()})}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(Dl),i.Pb(rc),i.Pb(i.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-description"]],inputs:{layout:"layout",isPopulated:"isPopulated"},outputs:{isPopulatedChange:"isPopulatedChange"},decls:4,vars:5,consts:[[1,"view-description",3,"ngClass"],[1,"view-description__inner"],["class","view-description__body",4,"ngIf"],[1,"view-description__body"],[3,"markdownText"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Vb(1,"div",1),i.Vb(2,"section"),i.Ic(3,bh,2,1,"div",2),i.Ub(),i.Ub(),i.Ub()),2&e&&(i.lc("ngClass",i.oc(2,mh,"column"===t.layout,"drawer"===t.layout)),i.Db(3),i.lc("ngIf",t.chapterDescription))},directives:[Z.i,Z.l,Zd],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3535}.text-info{color:#2d72dc}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.view-description{color:#131c2a;display:flex;flex-direction:column;justify-content:left}.view-description--layout-column .view-description__chapter-title{font-size:18px;letter-spacing:.45px;line-height:1.4em}.view-description--layout-column .view-description__body{padding:4px 8px 12px}.view-description--layout-drawer .view-description__story-title{text-align:center}.view-description--layout-drawer .view-description__story-title--large{font-size:14px;letter-spacing:.35px;line-height:1.4em}.view-description--layout-drawer .view-description__body{padding-top:4px}.view-description__inner{flex:1 0 auto}.view-description__story-title{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase;word-wrap:break-word;overflow-wrap:break-word;flex-grow:1;font-weight:600;color:#374a68}.view-description__story-title--large{font-size:18px;letter-spacing:.45px;line-height:1.4em;text-transform:none}.view-description__body{font-size:14px;letter-spacing:.35px;line-height:1.4em;word-wrap:break-word;overflow-wrap:break-word;padding-top:8px;color:#374a68}"],encapsulation:2,changeDetection:0}),gh([Object(d.d)(za.getStory),hh("design:type",P.a)],e.prototype,"story$",void 0),gh([Object(d.d)(Or.getSelectedChapter),hh("design:type",P.a)],e.prototype,"chapter$",void 0),gh([Object(d.d)(Or.getSelectedChapterIndex),hh("design:type",P.a)],e.prototype,"chapterIndex$",void 0),gh([Object(d.d)(Or.getChapterCount),hh("design:type",P.a)],e.prototype,"chapterCount$",void 0),gh([Object(d.d)(mr.getUI),hh("design:type",P.a)],e.prototype,"layout$",void 0),e})();function yh(e,t){if(1&e&&(i.Vb(0,"div",6),i.Kc(1),i.Ub()),2&e){const e=i.gc().$implicit;i.Db(1),i.Lc(e.description)}}function xh(e,t){if(1&e&&(i.Vb(0,"li",2),i.Qb(1,"div",3),i.Vb(2,"div",4),i.Vb(3,"div"),i.Kc(4),i.Ub(),i.Ic(5,yh,2,1,"div",5),i.Ub(),i.Ub()),2&e){const e=t.$implicit,n=i.gc();i.Db(1),i.Fc("background-color",n.getComputedColor(e.colors)),i.Db(3),i.Lc(e.label),i.Db(1),i.lc("ngIf",e.description)}}let vh=(()=>{class e{constructor(){}ngOnInit(){}getComputedColor(e){return si.rgbToHex(e,!0)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-legend"]],inputs:{legend:"legend"},decls:2,vars:1,consts:[["aria-label","Legend","role","complementary",1,"view-legend"],["class","view-legend__item",4,"ngFor","ngForOf"],[1,"view-legend__item"],[1,"view-legend__color","mh-2"],[1,"view-legend__content","text-14"],["class","mv-2",4,"ngIf"],[1,"mv-2"]],template:function(e,t){1&e&&(i.Vb(0,"ul",0),i.Ic(1,xh,6,4,"li",1),i.Ub()),2&e&&(i.Db(1),i.lc("ngForOf",t.legend))},directives:[Z.k,Z.l],styles:['.view-legend{display:flex;flex-direction:column}.view-legend__item{padding:8px 0;display:flex;flex-direction:row;justify-content:flex-start;align-items:flex-start}.view-legend__content{display:flex;flex-direction:column}.view-legend__color{content:" ";display:block;flex:0 0 16px;width:16px;height:16px;border-radius:50%}.view-legend__color:after{content:" "}'],encapsulation:2,changeDetection:0}),e})();var Oh=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},wh=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const Ch=function(e){return{"view-labels__item--selected":e}};function Sh(e,t){if(1&e){const e=i.Wb();i.Vb(0,"li"),i.Vb(1,"button",2),i.cc("click",(function(){i.xc(e);const n=t.$implicit;return i.gc().handleLabelClick(n)}))("keyup.enter",(function(){i.xc(e);const n=t.$implicit;return i.gc().handleLabelClick(n)})),i.hc(2,"async"),i.hc(3,"async"),i.Vb(4,"span",3),i.Kc(5,"Navigate to description for, "),i.Ub(),i.Vb(6,"div",4),i.Vb(7,"div",5),i.Qb(8,"app-label-pin",6),i.Ub(),i.Ub(),i.Vb(9,"div",7),i.Qb(10,"div",8),i.hc(11,"markdown"),i.Ub(),i.Ub(),i.Ub()}if(2&e){const e=t.$implicit,n=i.gc();let s=null,o=null;i.Db(1),i.lc("ngClass",i.nc(11,Ch,(null==(s=i.ic(2,5,n.selectedLabel$))?null:s.id)===e.id)),i.Eb("aria-current",(null==(o=i.ic(3,7,n.selectedLabel$))?null:o.id)===e.id),i.Db(7),i.lc("label",e)("sequence",n.getLabelSequence(e)),i.Db(2),i.lc("innerHTML",i.ic(11,9,e.title),i.yc)}}let _h=(()=>{class e{constructor(e,t){this.viewService=e,this.store=t,this.labelPinType=oi,this.labelSequentialtype=ai}ngOnInit(){}getLabelSequence(e){return this.store.selectSnapshot(Ca.getLabelSequence(e))}handleLabelClick(e){this.viewService.selectLabel(e,!0)}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(Dl),i.Pb(d.g))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-labels"]],decls:3,vars:3,consts:[[1,"view-labels"],[4,"ngFor","ngForOf"],[1,"view-labels__item",3,"ngClass","click","keyup.enter"],[1,"visually-hidden"],[1,"view-labels__pre"],[1,"view-labels__pin"],[3,"label","sequence"],[1,"view-labels__body"],[1,"view-labels__title","html",3,"innerHTML"]],template:function(e,t){1&e&&(i.Vb(0,"ul",0),i.Ic(1,Sh,12,13,"li",1),i.hc(2,"async"),i.Ub()),2&e&&(i.Db(1),i.lc("ngForOf",i.ic(2,1,t.labels$)))},directives:[Z.k,Z.i,pp],pipes:[Z.b,Pd.b],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3535}.text-info{color:#2d72dc}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.view-labels__item{background:none;border:0;border-left:4px solid transparent;border-radius:2px;display:flex;padding:12px 8px;margin-bottom:4px;cursor:pointer;transition:background-color 125ms,color 125ms,border 125ms;width:100%;text-align:left}.view-labels__item:focus{outline:2px solid #2d72dc!important}.view-labels__item:hover{background:#eaeff5}.view-labels__item--selected{background:#f0f8ff;border-left:4px solid #2d72dc}.view-labels__item--selected:hover{background:#f0f8ff}.view-labels__pre{flex:0 0 32px;display:flex;justify-content:center;position:relative}.view-labels__pin{display:flex;align-items:center;justify-content:center;position:absolute}.view-labels__title{color:#131c2a}.view-labels__description,.view-labels__title{font-size:14px;letter-spacing:.35px;line-height:1.4em}.view-labels__description{color:#374a68;padding-top:4px}.view-labels__label{position:absolute;font-size:10px;top:3px}"],encapsulation:2,changeDetection:0}),Oh([Object(d.d)(Ca.getChapterLabels),wh("design:type",P.a)],e.prototype,"labels$",void 0),Oh([Object(d.d)(Ca.getSelectedLabel),wh("design:type",P.a)],e.prototype,"selectedLabel$",void 0),e})();var jh=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},kh=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Ph(e,t){if(1&e&&(i.Vb(0,"div"),i.Qb(1,"app-content-blocks",7),i.hc(2,"async"),i.Ub()),2&e){const e=i.gc(2);i.Db(1),i.lc("contentBlocks",i.ic(2,2,e.contentBlocks$))("include",e.contentBlockTypes.Ticker)}}function Mh(e,t){if(1&e&&(i.Vb(0,"div"),i.Qb(1,"app-content-blocks",8),i.hc(2,"async"),i.Ub()),2&e){const e=i.gc(2);i.Db(1),i.lc("contentBlocks",i.ic(2,2,e.contentBlocks$))("exclude",e.contentBlockTypes.Ticker)}}function Ih(e,t){if(1&e){const e=i.Wb();i.Vb(0,"app-view-panel",4),i.Ic(1,Ph,3,4,"div",5),i.hc(2,"async"),i.Vb(3,"app-view-description",6),i.cc("isPopulatedChange",(function(t){return i.xc(e),i.gc().isPopulated=t})),i.Ub(),i.Ic(4,Mh,3,4,"div",5),i.hc(5,"async"),i.Ub()}if(2&e){const e=i.gc();let t=null,n=null;i.lc("showHeader",!1)("hidden",!e.isPopulated),i.Db(1),i.lc("ngIf",(null==(t=i.ic(2,6,e.contentBlocks$))?null:t.length)>0),i.Db(2),i.lc("isPopulated",e.isPopulated)("layout",e.layout),i.Db(1),i.lc("ngIf",(null==(n=i.ic(5,8,e.contentBlocks$))?null:n.length)>0)}}function zh(e,t){if(1&e&&(i.Vb(0,"app-view-panel",9),i.Qb(1,"app-view-legend",10),i.hc(2,"async"),i.Ub()),2&e){const e=i.gc();i.Db(1),i.lc("legend",i.ic(2,1,e.chapter$).legend)}}function Th(e,t){if(1&e){const e=i.Wb();i.Vb(0,"div",13),i.Vb(1,"button",14),i.cc("click",(function(){return i.xc(e),i.gc(2).handlePrevClick()})),i.Ub(),i.Vb(2,"button",15),i.cc("click",(function(){return i.xc(e),i.gc(2).handleNextClick()})),i.Ub(),i.Ub()}}function Uh(e,t){if(1&e&&(i.Vb(0,"app-view-panel",11),i.Ic(1,Th,3,0,"div",12),i.hc(2,"async"),i.Qb(3,"app-view-labels"),i.Ub()),2&e){const e=i.gc();let t=null;i.Db(1),i.lc("ngIf",(null==(t=i.ic(2,1,e.labels$))?null:t.length)>1)}}let Dh=(()=>{class e{constructor(e,t,n,i){this.store=e,this.viewService=t,this.layoutService=n,this.changeDetectorRef=i,this.ngUnsubscribe=new k.a,this.layout=Ya.Column,this.viewLayout=Xa,this.isPopulated=!0,this.descriptionVisible=!1,this.legendVisible=!1,this.labelListVisible=!1,this.contentBlockTypes=is}ngOnInit(){this.store.select(mr.getUI).pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(()=>{this.descriptionVisible=this.isVisible(Xa.Description),this.legendVisible=this.isVisible(Xa.Legend),this.labelListVisible=this.isVisible(Xa.LabelList),this.changeDetectorRef.markForCheck()})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}isVisible(e){return this.layoutService.isUIVisible(e)}isEnabled(e){return this.layoutService.isUIEnabled(e)}handlePrevClick(){this.selectLabel(-1)}handleNextClick(){this.selectLabel(1)}selectLabel(e){const t=this.store.selectSnapshot(Ca.getChapterLabels),n=t.length,i=this.store.selectSnapshot(Ca.getSelectedLabelId),s=t.findIndex(e=>e.id===i),o=t[((-1!==s?s+e:0)%n+n)%n];o&&this.viewService.selectLabel(o,!0)}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.g),i.Pb(Dl),i.Pb(rc),i.Pb(i.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-content-mode"]],inputs:{layout:"layout"},decls:7,vars:9,consts:[[1,"view-content-mode"],["role","complementary","aria-describedby","view-title",3,"showHeader","hidden",4,"ngIf"],["label","Legend",4,"ngIf"],["label","Labels","role","complementary","aria-label","Labels",4,"ngIf"],["role","complementary","aria-describedby","view-title",3,"showHeader","hidden"],[4,"ngIf"],[3,"isPopulated","layout","isPopulatedChange"],[3,"contentBlocks","include"],[3,"contentBlocks","exclude"],["label","Legend"],[3,"legend"],["label","Labels","role","complementary","aria-label","Labels"],["actions","","class","flex",4,"ngIf"],["actions","",1,"flex"],["app-pin-button","","icon","chevron-left","size","small","buttonType","ghost","aria-label","Previous Label","matTooltip","Previous Label","data-test","previousLabelButton",3,"click"],["app-pin-button","","icon","chevron-right","size","small","buttonType","ghost","aria-label","Next Label","matTooltip","Next Label","data-test","nextLabelButton",3,"click"]],template:function(e,t){if(1&e&&(i.Vb(0,"div",0),i.Ic(1,Ih,6,10,"app-view-panel",1),i.Ic(2,zh,3,3,"app-view-panel",2),i.hc(3,"async"),i.hc(4,"async"),i.Ic(5,Uh,4,3,"app-view-panel",3),i.hc(6,"async"),i.Ub()),2&e){let e=null,n=null;i.Db(1),i.lc("ngIf",t.descriptionVisible),i.Db(1),i.lc("ngIf",(null==(e=i.ic(3,3,t.chapter$))?null:e.legend)&&(null==(e=i.ic(4,5,t.chapter$))?null:e.legend.length)>0&&t.legendVisible),i.Db(3),i.lc("ngIf",(null==(n=i.ic(6,7,t.labels$))?null:n.length)&&t.labelListVisible)}},directives:[Z.l,uh,fh,Pu,vh,_h,ou,ru.c],pipes:[Z.b],styles:[".view-content-mode[_ngcontent-%COMP%]{padding-bottom:24px}"],changeDetection:0}),jh([Object(d.d)(Or.getStoryChapters),kh("design:type",P.a)],e.prototype,"chapters$",void 0),jh([Object(d.d)(Or.getSelectedChapter),kh("design:type",P.a)],e.prototype,"chapter$",void 0),jh([Object(d.d)(Or.getSelectedChapterContentBlocks),kh("design:type",P.a)],e.prototype,"contentBlocks$",void 0),jh([Object(d.d)(Ca.getChapterLabels),kh("design:type",P.a)],e.prototype,"labels$",void 0),e})();function Lh(e,t){if(1&e&&(i.Vb(0,"span"),i.Kc(1),i.Ub()),2&e){const e=i.gc();i.Db(1),i.Mc(" of ",e.total,"")}}let Eh=(()=>{class e{constructor(){this.index=0,this.total=0}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-quiz-progress"]],inputs:{index:"index",total:"total"},decls:4,vars:2,consts:[["data-test","quizProgress",1,"view-quiz-progress"],[1,"text-semibold"],[4,"ngIf"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Vb(1,"span",1),i.Kc(2),i.Ub(),i.Ic(3,Lh,2,1,"span",2),i.Ub()),2&e&&(i.Db(2),i.Mc("Question ",t.index+1,""),i.Db(1),i.lc("ngIf",t.total>1))},directives:[Z.l],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.view-quiz-progress[_ngcontent-%COMP%]{color:#374a68;font-size:12px;letter-spacing:.3px;line-height:1.4em}"],changeDetection:0}),e})();var Fh=n("QibW");const Ah=[[["app-list-item"]]],Rh=["app-list-item"];var Vh=function(e){return e.Default="default",e.Commafied="commafied",e.flat="flat",e.inline="inline",e}({});let Nh=(()=>{class e{constructor(){this.listType=Vh.Default}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-list"]],inputs:{listType:"listType"},ngContentSelectors:Rh,decls:2,vars:1,consts:[[1,"list",3,"ngClass"]],template:function(e,t){1&e&&(i.kc(Ah),i.Vb(0,"div",0),i.jc(1),i.Ub()),2&e&&i.lc("ngClass","list--"+t.listType)},directives:[Z.i],styles:['.list{display:flex;flex-direction:column}.list--default app-list-item{display:list-item;margin-left:16px;list-style-type:disc}.list--commafied{align-items:center;display:flex;flex-direction:row;flex-wrap:wrap;padding:0 4px 4px 0}.list--commafied app-list-item:not(:last-child):after{content:", ";float:right;padding-right:4px}.list--flat app-list-item:not(:last-child){margin-bottom:4px}.list--inline{display:inline-flex;align-items:center;display:flex;flex-direction:row;flex-wrap:wrap}.list--inline app-list-item{margin:0 8px 4px 0}.list__item{display:block}'],encapsulation:2,changeDetection:0}),e})();const Bh=["*"];let Hh=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-list-item"]],ngContentSelectors:Bh,decls:1,vars:0,template:function(e,t){1&e&&(i.kc(),i.jc(0))},styles:[""],encapsulation:2,changeDetection:0}),e})();function Qh(e,t){if(1&e&&(i.Vb(0,"app-list-item"),i.Vb(1,"div",1),i.Kc(2),i.Ub(),i.Ub()),2&e){const e=t.$implicit;i.Db(1),i.Eb("data-id",e.id),i.Db(1),i.Lc(e.label)}}let $h=(()=>{class e{constructor(e,t,n){this.store=e,this.graphService=t,this.changeRef=n}get objectIds(){return this._objectIds}set objectIds(e){this._objectIds=e;const t=this.store.selectSnapshot(Er.getViewGraph);this.nodes=this.graphService.getNodes(t,e),this.changeRef.markForCheck()}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.g),i.Pb(Et),i.Pb(i.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-quiz-object-tree"]],inputs:{objectIds:"objectIds"},decls:2,vars:1,consts:[[4,"ngFor","ngForOf"],[1,"text-14","text-medium","mv-1"]],template:function(e,t){1&e&&(i.Vb(0,"app-list"),i.Ic(1,Qh,3,2,"app-list-item",0),i.Ub()),2&e&&(i.Db(1),i.lc("ngForOf",t.nodes))},directives:[Nh,Z.k,Hh],styles:[""],changeDetection:0}),e})(),qh=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-quiz-answer-number"]],inputs:{number:"number"},decls:3,vars:1,consts:[[1,"number","text-10","text-medium"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Vb(1,"div"),i.Kc(2),i.Ub(),i.Ub()),2&e&&(i.Db(2),i.Lc(t.number))},styles:[".number[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:20px;height:20px;color:#131c2a;border:1px solid rgba(55,74,104,.5);border-radius:50%}"],changeDetection:0}),e})();var Wh=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Kh(e,t){if(1&e&&(i.Vb(0,"div",3),i.Vb(1,"div",4),i.Qb(2,"app-view-quiz-answer-number",5),i.Ub(),i.Vb(3,"div",6),i.Qb(4,"app-quiz-label-anatomy-select",7),i.Ub(),i.Ub()),2&e){const e=t.index,n=i.gc();i.Db(2),i.lc("number",e+1),i.Db(2),i.lc("options",n.options)("formControlName",e)}}let Gh=(()=>{class e{constructor(e){this.formBuilder=e,this.valueChange=new i.p,this.ngUnsubscribe=new k.a,this._options=[],this.form=this.formBuilder.group({options:this.formBuilder.array([])}),this.optionsArray=this.form.get("options")}get options(){return this._options}set options(e){Object(D.isEqual)(e,this._options)||(this._options=e,this.buildFormOptions(e))}ngOnInit(){this.initFormListeners(),this.init()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initFormListeners(){this.form.valueChanges.pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(({options:e})=>{this.valueChange.next(e)})}init(){this.activeSubmission$.pipe(Object(I.a)(e=>!Object(D.isNil)(e)&&!Object(D.isNil)(e.answer)),Object(ml.a)(),Object(M.a)(this.ngUnsubscribe)).subscribe(([e,t])=>{const n=function(e,t,n){const i=t.findIndex((t,n)=>{const i=e[n];return!Object(D.isEqual)(i,t)}),s=t[i];return t.map((e,t)=>Object(D.isEqual)(s,e)&&t!==i?"":e)}(e.answer||[],t.answer||[]);Object(D.isEqual)(t,n)||this.form.patchValue({options:n||[]})}),this.activeSubmission$.pipe(Object(I.a)(e=>!Object(D.isNil)(e)&&!Object(D.isNil)(e.answer)&&Array.isArray(e.answer)),Object(qa.a)((e,t)=>Object(D.isEqual)(e,t)),Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{const t=this.form.value.options,n=e.answer;Object(D.isEqual)(t,n)||this.form.patchValue({options:n},{emitEvent:!1,onlySelf:!0})})}buildFormOptions(e){this.optionsArray.clear(),e.forEach(()=>{this.optionsArray.push(this.formBuilder.control(""))}),this.optionsArray.setValue(e.map(()=>""))}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(Du.e))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-quiz-label-anatomy"]],inputs:{options:"options"},outputs:{valueChange:"valueChange"},decls:3,vars:2,consts:[[1,"options",3,"formGroup"],["formArrayName","options"],["class","options__item mb-4","data-test","questionAnswer",4,"ngFor","ngForOf"],["data-test","questionAnswer",1,"options__item","mb-4"],[1,"mr-2"],[3,"number"],[1,"options__item-select"],[3,"options","formControlName"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Vb(1,"div",1),i.Ic(2,Kh,5,3,"div",2),i.Ub(),i.Ub()),2&e&&(i.lc("formGroup",t.form),i.Db(2),i.lc("ngForOf",t.options))},directives:[Du.o,Du.i,Du.d,Z.k,qh,Ru,Du.n,Du.h],styles:[".options__item[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}.options__item-select[_ngcontent-%COMP%]{border:1px solid #96a8c0;border-radius:4px;flex:1 1 auto}"],changeDetection:0}),function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);o>3&&r&&Object.defineProperty(t,n,r)}([Object(d.d)(xs.getActiveSubmission),Wh("design:type",P.a)],e.prototype,"activeSubmission$",void 0),e})();var Zh=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},Jh=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Xh(e,t){if(1&e&&(i.Vb(0,"mat-radio-button",8),i.Kc(1),i.Ub()),2&e){const e=t.$implicit;i.lc("value",e.value),i.Db(1),i.Mc(" ",e.label," ")}}function Yh(e,t){if(1&e){const e=i.Wb();i.Vb(0,"div"),i.Vb(1,"mat-radio-group",6),i.cc("change",(function(t){return i.xc(e),i.gc(2).handleMultipleChoiceChange(t)})),i.Ic(2,Xh,2,2,"mat-radio-button",7),i.Ub(),i.Ub()}if(2&e){const e=i.gc(2);i.Db(2),i.lc("ngForOf",e.question.data.options)}}function eb(e,t){if(1&e&&(i.Vb(0,"div",10),i.Qb(1,"app-view-quiz-object-tree",11),i.Ub()),2&e){const e=i.gc(3);i.Db(1),i.lc("objectIds",e.question.data.correctAnswer)}}function tb(e,t){if(1&e&&(i.Vb(0,"div"),i.Ic(1,eb,2,1,"div",9),i.Ub()),2&e){const e=i.gc(2);i.Db(1),i.lc("ngIf",e.question.data.showAnswerList)}}function nb(e,t){if(1&e){const e=i.Wb();i.Vb(0,"div"),i.Vb(1,"app-view-quiz-label-anatomy",12),i.cc("valueChange",(function(t){return i.xc(e),i.gc(2).handleLabelAnatomyChanges(t)})),i.Ub(),i.Ub()}if(2&e){const e=i.gc(2);i.Db(1),i.lc("options",e.question.data.options)}}function ib(e,t){if(1&e&&(i.Vb(0,"div",1),i.Vb(1,"div",2),i.Qb(2,"app-content-blocks",3),i.Ub(),i.Vb(3,"div",4),i.Ic(4,Yh,3,1,"div",5),i.Ic(5,tb,2,1,"div",5),i.Ic(6,nb,2,1,"div",5),i.Ub(),i.Ub()),2&e){const e=i.gc();i.Db(2),i.lc("contentBlocks",e.question.questionPrompt),i.Db(1),i.lc("ngSwitch",e.question.type),i.Db(1),i.lc("ngSwitchCase",e.QuestionType.MultipleChoice),i.Db(1),i.lc("ngSwitchCase",e.QuestionType.SelectAnatomy),i.Db(1),i.lc("ngSwitchCase",e.QuestionType.LabelAnatomy)}}let sb=(()=>{class e{constructor(e,t){this.changeRef=e,this.viewService=t,this.disabled=!1,this.QuestionType=ss,this.ngUnsubscribe=new k.a}get question(){return this._question}set question(e){this._question=e,this.initQuestionListeners()}get value(){return this._value}set value(e){this._value=e,this.onChange(e)}handleMultipleChoiceChange(e){this.writeValue(e.value)}handleLabelAnatomyChanges(e){this.writeValue(e)}ngOnInit(){}initQuestionListeners(){switch(this.question.type){case ss.SelectAnatomy:this.initSelectAnatomyListeners(),this.viewService.toggleToolbar("tools");break;case ss.Instructions:this.initInstructions(),this.viewService.toggleToolbar("none");break;default:this.viewService.toggleToolbar("none")}}initSelectAnatomyListeners(){this.checkedNodesIds$.pipe(Object(qa.a)((e,t)=>Object(D.isEqual)(e,t)),Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.writeValue(e),this.changeRef.markForCheck()})}initInstructions(){setTimeout(()=>{this.writeValue("-"),this.changeRef.markForCheck()})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}onChange(e){}onTouched(){}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}writeValue(e){this.value=e}setDisabledState(e){this.disabled=e}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(i.i),i.Pb(Dl))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-quiz-question"]],inputs:{question:"question",value:"value"},features:[i.Cb([{provide:Du.l,useExisting:Object(i.W)(()=>e),multi:!0}])],decls:1,vars:1,consts:[["class","view-quiz-question text-14 mb-8","data-test","question",4,"ngIf"],["data-test","question",1,"view-quiz-question","text-14","mb-8"],["data-test","questionPrompt",1,"view-quiz-question__prompt","mb-4"],[3,"contentBlocks"],[3,"ngSwitch"],[4,"ngSwitchCase"],[1,"flex","flex-column",3,"change"],["data-test","questionAnswer","class","view-quiz-question__option",3,"value",4,"ngFor","ngForOf"],["data-test","questionAnswer",1,"view-quiz-question__option",3,"value"],["class","ml-3",4,"ngIf"],[1,"ml-3"],[3,"objectIds"],[3,"options","valueChange"]],template:function(e,t){1&e&&i.Ic(0,ib,7,5,"div",0),2&e&&i.lc("ngIf",t.question)},directives:[Z.l,Pu,Z.n,Z.o,Fh.b,Z.k,Fh.a,$h,Gh],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3535}.text-info{color:#2d72dc}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.view-quiz-question__option{font-size:14px;letter-spacing:.35px;line-height:1.4em;padding:12px 0 12px 12px}.view-quiz-question__option,.view-quiz-question__option>*{white-space:normal!important}.view-quiz-question__option .mat-radio-label{align-items:flex-start!important}.view-quiz-question__option .mat-radio-label-content{padding-left:12px!important}"],encapsulation:2,changeDetection:0}),Zh([Object(d.d)(Bi.getCheckedNodeIds),Jh("design:type",P.a)],e.prototype,"checkedNodesIds$",void 0),Zh([Object(d.d)(xs.getActiveSubmission),Jh("design:type",P.a)],e.prototype,"activeSubmission$",void 0),e})();function ob(e,t){1&e&&i.Qb(0,"app-icon",6)}function rb(e,t){1&e&&i.Qb(0,"app-icon",7)}function ab(e,t){1&e&&(i.Vb(0,"span",8),i.Qb(1,"span",9),i.Ub())}const cb=["*"];let lb=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-quiz-answer-option"]],inputs:{correct:"correct"},ngContentSelectors:cb,decls:7,vars:7,consts:[["data-test","answerOptionContainer",1,"option"],[1,"flex","relative",3,"ngSwitch"],["class","option__icon option__icon--correct","style","font-size: 20px","icon","check-circle",4,"ngSwitchCase"],["class","option__icon option__icon--incorrect","style","font-size: 20px","icon","times-circle",4,"ngSwitchCase"],["class","option__icon",4,"ngSwitchDefault"],[1,"pl-2"],["icon","check-circle",1,"option__icon","option__icon--correct",2,"font-size","20px"],["icon","times-circle",1,"option__icon","option__icon--incorrect",2,"font-size","20px"],[1,"option__icon"],[1,"mat-radio-outer-circle"]],template:function(e,t){1&e&&(i.kc(),i.Vb(0,"div",0),i.Vb(1,"div",1),i.Ic(2,ob,1,0,"app-icon",2),i.Ic(3,rb,1,0,"app-icon",3),i.Ic(4,ab,2,0,"span",4),i.Vb(5,"div",5),i.jc(6),i.Ub(),i.Ub(),i.Ub()),2&e&&(i.Hb("option--correct",!0===t.correct)("option--incorrect",!1===t.correct),i.Db(1),i.lc("ngSwitch",t.correct),i.Db(1),i.lc("ngSwitchCase",!0),i.Db(1),i.lc("ngSwitchCase",!1))},directives:[Z.n,Z.o,Z.p,dl],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.option[_ngcontent-%COMP%]{padding:12px;border-radius:4px;margin-bottom:8px;color:#131c2a}.option--correct[_ngcontent-%COMP%]{border:1px solid #83e692;background-color:#f0fff0}.option--incorrect[_ngcontent-%COMP%]{border:1px solid #f44336;background-color:#ffe2db}.option__icon[_ngcontent-%COMP%]{position:relative;flex:0 0 20px;justify-content:center}.option__icon--correct[_ngcontent-%COMP%]{color:#83e692}.option__icon--incorrect[_ngcontent-%COMP%]{color:#f44336}"],changeDetection:0}),e})();function pb(e,t){if(1&e&&(i.Vb(0,"div"),i.Vb(1,"app-view-quiz-answer-option",1),i.Vb(2,"div",2),i.Kc(3),i.Ub(),i.Ub(),i.Ub()),2&e){const e=t.$implicit,n=i.gc();i.Db(1),i.lc("correct",n.isOptionAnswerCorrect(n.question,e.value,n.answer)),i.Db(2),i.Mc(" ",e.label," ")}}let db=(()=>{class e{constructor(){}ngOnInit(){}isOptionAnswerCorrect(e,t,n){const i=cs(e,[t]);return t===n[0]||i?i:void 0}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-quiz-multiple-choice-answer"]],inputs:{question:"question",answer:"answer",summary:"summary"},decls:1,vars:1,consts:[[4,"ngFor","ngForOf"],[3,"correct"],[1,"text-semibold"]],template:function(e,t){1&e&&i.Ic(0,pb,4,2,"div",0),2&e&&i.lc("ngForOf",t.question.data.options)},directives:[Z.k,lb],styles:[""],changeDetection:0}),e})();function ub(e,t){if(1&e){const e=i.Wb();i.Vb(0,"div",6),i.Vb(1,"button",7),i.cc("click",(function(){i.xc(e);const t=i.gc();return t.handleSelectedObjectsClick(t.answer)})),i.Kc(2," Highlight My Answer "),i.Ub(),i.Vb(3,"button",8),i.cc("click",(function(){i.xc(e);const t=i.gc();return t.handleCorrectObjectsClick(t.question.data.correctAnswer)})),i.Kc(4," Highlight Correct Answer "),i.Ub(),i.Ub()}}let gb=(()=>{class e{constructor(e,t,n){this.graphService=e,this.viewService=t,this.store=n}get isCorrect(){return cs(this.question,this.answer)}fadeNonselected(e){const t=this.store.selectSnapshot(Er.getViewGraph),n=this.graphService.getInverseSelection(t,e),i=this.graphService.getNodes(t,n);this.store.dispatch(new Ii.UpdateNodesPaint($i,i.map(e=>e.id)))}handleCorrectObjectsClick(e){this.highlightNodes(e)}handleSelectedObjectsClick(e){this.highlightNodes(e)}highlightNodes(e){const t=e.filter(e=>e&&""!==e);this.resetSelectAndFade(),this.repositionCamera(t),this.fadeNonselected(t)}repositionCamera(e){1===e.length?this.store.dispatch(new Je(e[0])):this.viewService.resetCamera()}resetSelectAndFade(){this.viewService.clearSelectedNodes(),this.viewService.clearFadedNodes()}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(Et),i.Pb(Dl),i.Pb(d.g))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-quiz-select-anatomy-answer"]],inputs:{question:"question",answer:"answer",summary:"summary"},decls:9,vars:4,consts:[[3,"correct"],["selectAnatomyAnswer",""],[1,"flex","flex-column","text-semibold"],[1,"mt-2","ml-2"],[3,"objectIds"],["class","mt-4",4,"ngIf"],[1,"mt-4"],["buttonType","outline","buttonTheme","light","app-button","","data-test","highlightUserAnswers",1,"w-100","mv-2",3,"click"],["buttonType","outline","buttonTheme","light","app-button","","data-test","highlightCorrectAnswers",1,"w-100","mv-2",3,"click"]],template:function(e,t){if(1&e&&(i.Vb(0,"div"),i.Vb(1,"app-view-quiz-answer-option",0,1),i.Vb(3,"div",2),i.Vb(4,"div"),i.Kc(5),i.Ub(),i.Vb(6,"div",3),i.Qb(7,"app-view-quiz-object-tree",4),i.Ub(),i.Ub(),i.Ub(),i.Ic(8,ub,5,0,"div",5),i.Ub()),2&e){const e=i.tc(2);i.Db(1),i.lc("correct",t.isCorrect),i.Db(4),i.Mc("",e.correct?"Correct":"Incorrect","! You selected:"),i.Db(2),i.lc("objectIds",t.answer),i.Db(1),i.lc("ngIf",!t.summary&&!t.isCorrect)}},directives:[lb,$h,Z.l,ud],styles:[""],changeDetection:0}),e})();function hb(e,t){if(1&e&&(i.Vb(0,"div",9),i.Kc(1),i.Ub()),2&e){const e=i.gc().$implicit;i.Db(1),i.Mc(" ",e.label.title," ")}}function bb(e,t){if(1&e&&(i.Vb(0,"div"),i.Kc(1," You selected "),i.Vb(2,"em",9),i.Kc(3),i.Ub(),i.Kc(4,". "),i.Ub(),i.Vb(5,"div",10),i.Kc(6," This is the "),i.Vb(7,"em",9),i.Kc(8),i.Ub(),i.Kc(9,". "),i.Ub()),2&e){const e=i.gc(),t=e.index,n=e.$implicit,s=i.gc();i.Db(3),i.Lc(s.getSelectedUserOption(t).label.title.trim()),i.Db(5),i.Lc(n.label.title.trim())}}function mb(e,t){if(1&e&&(i.Vb(0,"div",1),i.Vb(1,"div",2),i.Qb(2,"app-view-quiz-answer-number",3),i.Ub(),i.Vb(3,"div",4),i.Vb(4,"app-view-quiz-answer-option",5,6),i.Ic(6,hb,2,1,"div",7),i.Ic(7,bb,10,2,"ng-template",null,8,i.Jc),i.Ub(),i.Ub(),i.Ub()),2&e){const e=t.index,n=i.tc(5),s=i.tc(8),o=i.gc();i.Db(2),i.lc("number",e+1),i.Db(2),i.lc("correct",o.isOptionAnswerCorrect(e)),i.Db(2),i.lc("ngIf",n.correct)("ngIfElse",s)}}let fb=(()=>{class e{constructor(){}ngOnInit(){}isOptionAnswerCorrect(e){return this.answer[e]===this.question.data.correctAnswer[e]}getSelectedUserOption(e){const t=this.answer[e];return this.question.data.options.find(e=>e.value===t)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-quiz-label-anatomy-answer"]],inputs:{question:"question",answer:"answer",summary:"summary"},decls:1,vars:1,consts:[["class","answers",4,"ngFor","ngForOf"],[1,"answers"],[1,"mt-2","mr-2"],[3,"number"],[1,"answers__option"],[3,"correct"],["answerOption",""],["class","text-semibold",4,"ngIf","ngIfElse"],["falseBlock",""],[1,"text-semibold"],[1,"mt-1"]],template:function(e,t){1&e&&i.Ic(0,mb,9,4,"div",0),2&e&&i.lc("ngForOf",t.question.data.options)},directives:[Z.k,qh,lb,Z.l],styles:[".answers[_ngcontent-%COMP%]{display:flex;flex-direction:row}.answers__option[_ngcontent-%COMP%]{flex:1 1 auto}"],changeDetection:0}),e})();function yb(e,t){if(1&e&&(i.Vb(0,"div",7),i.Kc(1),i.Ub()),2&e){const e=i.gc();i.Db(1),i.Mc("",e.questionNumber,".")}}function xb(e,t){if(1&e&&(i.Vb(0,"div"),i.Qb(1,"app-view-quiz-multiple-choice-answer",8),i.Ub()),2&e){const e=i.gc();i.Db(1),i.lc("question",e.question)("answer",e.answer)("summary",e.summary)}}function vb(e,t){if(1&e&&(i.Vb(0,"div"),i.Qb(1,"app-view-quiz-select-anatomy-answer",8),i.Ub()),2&e){const e=i.gc();i.Db(1),i.lc("question",e.question)("answer",e.answer)("summary",e.summary)}}function Ob(e,t){if(1&e&&(i.Vb(0,"div"),i.Qb(1,"app-view-quiz-label-anatomy-answer",8),i.Ub()),2&e){const e=i.gc();i.Db(1),i.lc("question",e.question)("answer",e.answer)("summary",e.summary)}}let wb=(()=>{class e{constructor(e){this.store=e,this.QuestionType=ss}ngOnInit(){this.initAnswerConfig()}initAnswerConfig(){const{type:e}=this.question;this.store.dispatch(new ns.SetQuizPickMode(e===ss.SelectAnatomy?"none":"single"))}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.g))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-quiz-answer"]],inputs:{question:"question",questionNumber:"questionNumber",answer:"answer",summary:"summary"},decls:11,vars:7,consts:[["data-test","answer",1,"answer"],[1,"answer__prompt"],["class","mr-1",4,"ngIf"],[3,"contentBlocks"],[3,"ngSwitch"],[4,"ngSwitchCase"],[1,"answer__explanation"],[1,"mr-1"],[3,"question","answer","summary"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Vb(1,"div",1),i.Ic(2,yb,2,1,"div",2),i.Vb(3,"div"),i.Qb(4,"app-content-blocks",3),i.Ub(),i.Ub(),i.Vb(5,"div",4),i.Ic(6,xb,2,3,"div",5),i.Ic(7,vb,2,3,"div",5),i.Ic(8,Ob,2,3,"div",5),i.Ub(),i.Vb(9,"div",6),i.Qb(10,"app-content-blocks",3),i.Ub(),i.Ub()),2&e&&(i.Db(2),i.lc("ngIf",t.questionNumber),i.Db(2),i.lc("contentBlocks",t.question.questionPrompt),i.Db(1),i.lc("ngSwitch",t.question.type),i.Db(1),i.lc("ngSwitchCase",t.QuestionType.MultipleChoice),i.Db(1),i.lc("ngSwitchCase",t.QuestionType.SelectAnatomy),i.Db(1),i.lc("ngSwitchCase",t.QuestionType.LabelAnatomy),i.Db(2),i.lc("contentBlocks",t.question.explanation))},directives:[Z.l,Pu,Z.n,Z.o,db,gb,fb],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.answer[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.answer__prompt[_ngcontent-%COMP%]{display:flex;padding-bottom:16px}.answer__explanation[_ngcontent-%COMP%]{padding-top:24px}"],changeDetection:0}),e})();class Cb{}let Sb=(()=>{class e{constructor(){}}return e.type="[Auth] Is Logged In",e})(),_b=(()=>{class e{constructor(){}}return e.type="[Auth] Is Logged In Success",e})(),jb=(()=>{class e{constructor(){}}return e.type="[Auth] Is Logged In Failure",e})(),kb=(()=>{class e{constructor(e){this.login=e}}return e.type="[Auth] Login With Biodigital",e})(),Pb=(()=>{class e{}return e.type="[Auth] Load Google Auth",e})(),Mb=(()=>{class e{constructor(e){this.online=e}}return e.type="[Auth] Google Auth Service Online",e})(),Ib=(()=>{class e{constructor(e){this.login=e}}return e.type="[Auth] Login With Google",e})(),zb=(()=>{class e{constructor(e,t){this.loginType=e,this.response=t}}return e.type="[Auth] Login Success",e})(),Tb=(()=>{class e{constructor(e,t,n){this.loginType=e,this.error=t,this.login=n}}return e.type="[Auth] Login Failure",e})(),Ub=(()=>{class e{constructor(){}}return e.type="[Auth] Logout",e})(),Db=(()=>{class e{constructor(){}}return e.type="[Auth] Logout Success",e})(),Lb=(()=>{class e{constructor(){}}return e.type="[Auth] Logout Failure",e})(),Eb=(()=>{class e{constructor(){}}return e.type="[Auth] Get Environment Settings",e})(),Fb=(()=>{class e{constructor(e){this.environmentSettings=e}}return e.type="[Auth] Get Environment Settings Success",e})(),Ab=(()=>{class e{constructor(e){this.error=e}}return e.type="[Auth] Get Environment Settings Failure",e})(),Rb=(()=>{class e{constructor(e=!1){this.hardCheck=e}}return e.type="[Auth] Get User Profile",e})(),Vb=(()=>{class e{constructor(e){this.userProfile=e}}return e.type="[Auth] Get User Profile Success",e})(),Nb=(()=>{class e{constructor(e){this.error=e}}return e.type="[Auth] Get User Profile Failure",e})(),Bb=(()=>{class e{constructor(e){this.userProfile=e}}return e.type="[Auth] Update User Profile",e})(),Hb=(()=>{class e{constructor(e){this.userProfile=e}}return e.type="[Auth] Update User Profile Success",e})(),Qb=(()=>{class e{constructor(e){this.error=e}}return e.type="[Auth] Update User Profile Failure",e})(),$b=(()=>{class e{constructor(){}}return e.type="[Auth] Delete User Profile",e})(),qb=(()=>{class e{constructor(e){this.userEmail=e}}return e.type="[Auth] Delete User Profile Success",e})(),Wb=(()=>{class e{constructor(e){this.error=e}}return e.type="[Auth] Delete User Profile Failure",e})(),Kb=(()=>{class e{constructor(e){this.email=e}}return e.type="[Auth] Check Profile",e})(),Gb=(()=>{class e{constructor(e){this.profile=e}}return e.type="[Auth] Check Profile Success",e})(),Zb=(()=>{class e{constructor(e){this.error=e}}return e.type="[Auth] Check Profile Failure",e})(),Jb=(()=>{class e{constructor(){}}return e.type="[Auth] Get User Roles",e})(),Xb=(()=>{class e{constructor(e){this.email=e}}return e.type="[Auth] Reset Password",e})(),Yb=(()=>{class e{constructor(e){this.email=e}}return e.type="[Auth] Reset Password Success",e})(),em=(()=>{class e{constructor(e){this.error=e}}return e.type="[Auth] Reset Password Failure",e})(),tm=(()=>{class e{constructor(e){this.email=e}}return e.type="[Auth] Transfer Facebook Account",e})(),nm=(()=>{class e{constructor(e){this.email=e}}return e.type="[Auth] Transfer Facebook Account Success",e})(),im=(()=>{class e{constructor(e){this.error=e}}return e.type="[Auth] Transfer Facebook Account Failure",e})(),sm=(()=>{class e{constructor(e,t,n){this.currentPassword=e,this.newPassword=t,this.confirmNewPassword=n}}return e.type="[Auth] Update Password",e})(),om=(()=>{class e{constructor(){}}return e.type="[Auth] Update Password Success",e})(),rm=(()=>{class e{constructor(e){this.error=e}}return e.type="[Auth] Update Password Failure",e})(),am=(()=>{class e{constructor(){}}return e.type="[Auth] Check Session",e})(),cm=(()=>{class e{constructor(e){this.value=e}}return e.type="[Auth] Sign Up",e})(),lm=(()=>{class e{constructor(e){this.response=e}}return e.type="[Auth] Sign Up Success",e})(),pm=(()=>{class e{constructor(e){this.error=e}}return e.type="[Auth] Sign Up Failure",e})(),dm=(()=>{class e{constructor(e){this.locale=e}}return e.type="[Auth] Set User Locale",e})(),um=(()=>{class e{constructor(e){this.locale=e}}return e.type="[Auth] Set User Locale Success",e})(),gm=(()=>{class e{constructor(){}}return e.type="[Auth] Check Locale",e})(),hm=(()=>{class e{constructor(){}}return e.type="[Auth] Get User Apps",e})(),bm=(()=>{class e{constructor(e){this.apps=e}}return e.type="[Auth] Set User Apps",e})(),mm=(()=>{class e{constructor(){}}return e.type="[Auth] Check Selected App",e})(),fm=(()=>{class e{constructor(e){this.appId=e}}return e.type="[Auth] Set Selected User App",e})(),ym=(()=>{class e{constructor(e){this.message=e}}return e.type="[Auth] Send User Message",e})(),xm=(()=>{class e{constructor(e){this.message=e}}return e.type="[Auth] Send User Message Success",e})(),vm=(()=>{class e{constructor(e){this.err=e}}return e.type="[Auth] Send User Message Fail",e})(),Om=(()=>{class e{constructor(e,t){this.type=e,this.mode=t}}return e.type="[Auth] Get User Message",e})(),wm=(()=>{class e{constructor(e){this.message=e}}return e.type="[Auth] Get User Message Success",e})(),Cm=(()=>{class e{constructor(e){this.type=e}}return e.type="[Auth] Get User Message Fail",e})(),Sm=(()=>{class e{constructor(e){this.messageSeenId=e}}return e.type="[Auth] Set Message Viewed",e})(),_m=(()=>{class e{constructor(){}}return e.type="[Auth] Set Message Viewed Success",e})(),jm=(()=>{class e{constructor(){}}return e.type="[Auth] Set Message Viewed Fail",e})(),km=(()=>{class e{constructor(e){this.error=e}}return e.type="[Auth] Verify Fail",e})(),Pm=(()=>{class e{constructor(){}}return e.type="[Auth] Reset",e})(),Mm=(()=>{class e{constructor(e,t){this.email=e,this.token=t}}return e.type="[Auth] Request Verification Code",e})(),Im=(()=>{class e{constructor(e){this.response=e}}return e.type="[Auth] Request Verification Code Success",e})(),zm=(()=>{class e{constructor(e){this.error=e}}return e.type="[Auth] Request Verification Code Fail",e})(),Tm=(()=>{class e{constructor(e,t,n){this.email=e,this.token=t,this.code=n}}return e.type="[Auth] Verify Profile",e})(),Um=(()=>{class e{constructor(e){this.response=e}}return e.type="[Auth] Verify Profile Success",e})(),Dm=(()=>{class e{constructor(e){this.error=e}}return e.type="[Auth] Verify Profile Fail",e})(),Lm=(()=>{class e{constructor(e,t){this.contentId=e,this.contentType=t}}return e.type="[Auth] Set Content Viewed",e})(),Em=(()=>{class e{constructor(){}}return e.type="[Auth] Set Content Viewed Success",e})(),Fm=(()=>{class e{constructor(){}}return e.type="[Auth] Check Content Viewed",e})(),Am=(()=>{class e{constructor(e){this.contentViews=e}}return e.type="[Auth] Check Content Viewed Success",e})(),Rm=(()=>{class e{constructor(e){this.isDeveloperReferral=e}}return e.type="[Auth] Set Developer Referral",e})();class Vm{}var Nm=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let Bm=(()=>{class e{}return function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);o>3&&r&&Object.defineProperty(t,n,r)}([Object(A.Type)(()=>Vm),Nm("design:type",Array)],e.prototype,"organizations",void 0),e})();class Hm{static fromJSON(e){const t=new Hm;return t.email=e.user_email,t.credentials=e.credentials,t.isUser=e.is_user,t.isThirdParty=e.user_is_third_party,t.thirdPartyProvider=e.user_third_party_provider,t.isDeveloper=e.user_is_developer,t.isDeveloperActive=e.user_is_developer_active,t.isDeveloperVerified=e.user_is_developer_verified,t.firstName=e.user_first_name,t.lastName=e.user_last_name,t.name=`${e.firstName} ${e.lastName}`,t}}class Qm{static fromJSON(e){const t=new Qm;return t.google=e.google_api_key,t}}class $m{constructor(){this.version=4,this.groupInviteMode=0,this.groupCodeMode=0}}class qm extends $m{constructor(){super(...arguments),this.version=4}static toJSON(e){return{version:e.version,app_producttype:e.app_producttype,app_productkey:e.app_productkey,email:e.email,password:e.password,first_name:e.firstName,last_name:e.lastName,group_invite_mode:e.groupInviteMode,group_invite_key:e.groupInviteKey,group_code_mode:e.groupCodeMode,group_code:e.groupCode,group_ovid_mode:e.groupOvidMode,group_ovid_osptok:e.groupOvidOsptok,platform:e.platform,return_to:e.returnTo,brand_id:e.brandId,locale_id:e.localeId,timestamp:e.timestamp,site_verify_response:e.site_verify_response}}}class Wm extends $m{constructor(e){super(),this.token=e}static toJSON(e){return{id_token:e.token,version:e.version,app_producttype:e.app_producttype,app_productkey:e.app_productkey,group_invite_mode:e.groupInviteMode,group_invite_key:e.groupInviteKey,group_code_mode:e.groupCodeMode,group_code:e.groupCode,group_ovid_mode:e.groupOvidMode,group_ovid_osptok:e.groupOvidOsptok,platform:e.platform,return_to:e.returnTo,brand_id:e.brandId,locale_id:e.localeId,timestamp:e.timestamp,site_verify_response:e.site_verify_response}}}class Km extends $m{constructor(e,t,n){super(),this.email=e,this.password=t,this.rememberMe=n}static toJSON(e){return{id_token:e.token,version:e.version,app_producttype:e.app_producttype,app_productkey:e.app_productkey,group_invite_mode:e.groupInviteMode,group_invite_key:e.groupInviteKey,group_code_mode:e.groupCodeMode,group_code:e.groupCode,group_ovid_mode:e.groupOvidMode,group_ovid_osptok:e.groupOvidOsptok,email:e.email,password:e.password,email_remember_me:e.rememberMe,platform:e.platform,return_to:e.returnTo,brand_id:e.brandId,locale_id:e.localeId,timestamp:e.timestamp,site_verify_response:e.site_verify_response}}}var Gm=n("jCJ1"),Zm=function(e){return e.Zendesk="zendesk",e}({});class Jm{}var Xm=function(e){return e.AssignRole="assignRole",e.RemoveUser="removeUser",e.TransferContent="transferContent",e.CreateCollection="createCollection",e.DeleteCollection="deleteCollection",e.EditTeamAccount="editTeamAccount",e.EditTeamBookmarks="editTeamBookmarks",e.EditAllTeamBookmarks="editAllTeamBookmarks",e.AddTeamBookmarks="addTeamBookmarks",e.RemoveTeamBookmarks="removeTeamBookmarks",e.EditBookmarks="editBookmarks",e.PublishBookmarks="publishBookmarks",e.SavePrivateBookmarks="savePrivateBookmarks",e.CopyUrl="copyURL",e.ViewBookmarks="viewBookmarks",e.InviteUsers="inviteUsers",e.ExportCSV="exportCSV",e.DuplicateTeamBookmarks="duplicateTeamBookmarks",e}({}),Ym=function(e){return e.Admin="admin",e.Creator="creator",e.Viewer="viewer",e}({});const ef=[Xm.ViewBookmarks,Xm.CopyUrl,Xm.SavePrivateBookmarks,Xm.ExportCSV],tf=[...ef,Xm.InviteUsers,Xm.PublishBookmarks,Xm.EditBookmarks,Xm.EditTeamBookmarks,Xm.RemoveTeamBookmarks,Xm.AddTeamBookmarks,Xm.DuplicateTeamBookmarks],nf=[...tf,Xm.InviteUsers,Xm.EditTeamAccount,Xm.EditAllTeamBookmarks,Xm.CreateCollection,Xm.TransferContent,Xm.RemoveUser,Xm.AssignRole],sf=[Ym.Viewer,Ym.Creator,Ym.Admin],of={role_id:void 0,role_name:Ym.Creator,role_display_name:"",role_description:"",permissions:[...tf]},rf={[Ym.Viewer]:ef,[Ym.Creator]:tf,[Ym.Admin]:nf},af={[Ym.Viewer]:"Can view team content and edit personal content",[Ym.Creator]:"Can edit and view team content",[Ym.Admin]:"Can manage team settings and edit all content"};function cf(e){const t=Object(D.get)(e,"role_name",of.role_name),n=Object(D.get)(e,"role_description",af[t]),i=Object(D.get)(e,"permissions",void 0);return Object.assign(Object.assign({},e),{role_description:n,permissions:Object(D.isNil)(i)?(s=t,rf[s]||[]):i});var s}class lf{}class pf{}class df{}var uf=function(e){return e.DomainAlert="join_group_through_domain_alert",e.WelcomeTour="welcome_tour_alert",e.CompleteProfileAlert="complete_profile_alert",e}({});let gf=(()=>{class e{constructor(e,t){this.http=e,this.storageService=t}getUserMessage(e,t="",n=!0){const i=this.getCachedMessage(e);return n&&i?Object(zs.a)(i):this.http.get(`/ws/user/message?version=2&type=${e}&mode=${t}`).pipe(Object(F.a)(t=>{const{message_seen_id:n,show_alert:i}=t;let s;switch(e){case uf.DomainAlert:s=Object(A.plainToClass)(Vm,t.join_organization);break;case uf.WelcomeTour:s=""+t.tour_version;break;case uf.CompleteProfileAlert:const{is_new_user:e,is_team_user:n}=t||{};s=Object(A.plainToClass)(df,{is_new_user:e,is_team_user:n})}return{messageSeenId:n,messageType:e,showUserAlert:i,messageData:s}}),Object(vn.a)(e=>{e.showUserAlert||this.addCachedMessage(e)}))}setUserMessageViewed(e){return this.http.post("/ws/user/message",{version:2,message_seen_id:e})}sendMessage(e){return this.http.post("/ws/user/message",e)}getCachedMessage(e){return this.getCachedMessages().find(t=>t.messageType===e)}getCachedMessages(){return this.storageService.getSessionItem(sr.UserMessagesSeen)||[]}addCachedMessage(e){if(!this.getCachedMessage(e.messageType)){const t=this.getCachedMessages();this.storageService.setSessionItem(sr.UserMessagesSeen,[...t,e])}}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(v.b),i.Zb(ar))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var hf=n("nLfN"),bf=function(e){return e.Web="web",e.Android="mobile_android",e.iOS="mobile_ios",e}({});let mf=(()=>{class e{constructor(e){this.platform=e}get productKey(){return c.productKey}get productType(){if(c.native){if(this.platform.ANDROID)return bf.Android;if(this.platform.IOS)return bf.iOS}return bf.Web}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(hf.a))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const ff=["harvard.edu","liberty.edu"];let yf=(()=>{class e{constructor(e,t,n,i,s){this.http=e,this.reCaptchaV3Service=t,this.userMessageService=n,this.productService=i,this.RECAPTCHA_V3_SITE_KEY=s}loginWithBiodigital(e){return this.http.post("/ws/user/sign/in",Km.toJSON(e))}loginWithGoogle(e){return this.http.post("/ws/user/sign/in/google",Wm.toJSON(e))}logout(){return this.http.get("/ws/user/sign/out")}checkProfile(e){return this.http.post("/ws/user/profile/check",{version:2,email:e}).pipe(Object(F.a)(e=>{const t=Hm.fromJSON(e);return t.isThirdParty=""!==t.thirdPartyProvider,t}))}getUserProfile(e){return this.http.get(e?"/ws/user/profile?version=2&subscription_hard_check=1":"/ws/user/profile?version=2").pipe(Object(F.a)(e=>{const t=Object(A.plainToClass)(Bm,e);return t.organizations.forEach(e=>{const t=Object(D.get)(e,"user_role",of);e.user_role=cf(t)}),t}))}getUserRoles(){return this.http.get("/ws/organization/user/roles").pipe(Object(F.a)(e=>e.user_roles.map(e=>cf(Object(A.plainToClass)(Jm,e)))))}updaterUserProfile(e){return this.http.post("/ws/user/profile?version=2",e)}deleteUserProfile(){return this.http.post("/ws/user/profile/delete",{}).pipe(Object(F.a)(e=>e.deleted_user_email))}getEnvironmentSettings(){return this.http.get("/ws/environment/settings?version=2").pipe(Object(F.a)(e=>Qm.fromJSON(e)))}getUserApps(){return this.http.get("/ws/developer/apps/profile").pipe(Object(F.a)(e=>e&&e.apps?JSON.parse(e.apps):[]))}getGroupConfigFromRoute(e){const t=e.queryParams.code||"",n=e.queryParams.group_invite||"",i=e.queryParams.osptok||"";return{group:e.queryParams.group||"",groupCode:t,groupCodeMode:t?1:0,groupInviteMode:n?1:0,groupInviteKey:n,groupOvidMode:i?1:0,groupOvidOsptok:i}}getPlatformConfigFromRoute(e){const{zendesk_signin:t,return_to:n,brand_id:i,locale_id:s,timestamp:o}=e.queryParams;return"1"===t?{platform:Zm.Zendesk,returnTo:n,brandId:i,localeId:s,timestamp:o}:void 0}isLoggedIn(){return this.http.get(`/ws/user/is/signed-in?version=4&app_producttype=${this.productService.productType}&app_productkey=${this.productService.productKey}`)}getProfileRestrictions(e){let t=!1,n=!1,i="";return e.organizations.forEach(e=>{t||n||(i=e.name,t=e.user_is_subscribed&&e.email_domain_restriction&&!e.user_has_email_domain_access,n=e.user_is_subscribed&&e.ip_address_restriction&&!e.user_has_domain_access)}),{organizationName:i,email:t,ip:n}}resetPassword(e){return this.http.post("/ws/user/password/forgot",{email:e})}deactivateFacebook(e){return this.http.post("/ws/user/sign/in/facebook/deactivate",e)}updatePassword(e,t,n){return this.http.post("/ws/user/password/change",{current_password:e,new_password:t,confirm_new_password:n})}signUp(e){return this.http.post("/ws/user/sign/up",qm.toJSON(e))}verifyToken(e){return this.http.post("/ws/recaptcha/siteverify",{recaptcha_reponse_token:e,recaptcha_version:"v3"}).pipe(Object(F.a)(e=>e))}isHuman(e,t=!1){return t&&grecaptcha.reset(this.RECAPTCHA_V3_SITE_KEY),this.reCaptchaV3Service.execute(e).pipe(Object(Us.b)(e=>this.verifyToken(e)),Object(F.a)(t=>({isHuman:t.action===e&&t.score>.2,verification:t})))}isReCaptchaWhiteListed(e){return ff.some(t=>new RegExp(t+"$","i").test(e))}requestVerificationCode(e){const t=Object.assign(Object.assign({},e),{version:4,app_producttype:this.productService.productType,app_productkey:this.productService.productKey});return this.http.post("/ws/user/verification/request",t).pipe(Object(F.a)(e=>Object(A.plainToClass)(lf,e)))}verifyProfile(e){const t=Object.assign(Object.assign({},e),{version:4,app_producttype:this.productService.productType,app_productkey:this.productService.productKey});return this.http.post("/ws/user/verification/confirm",t).pipe(Object(F.a)(e=>Object(A.plainToClass)(pf,e)))}checkProfileIncomplete(){return this.userMessageService.getUserMessage(uf.CompleteProfileAlert,"v2",!1).pipe(Object(Ls.a)(()=>Object(zs.a)({messageType:uf.CompleteProfileAlert,messageData:{},showUserAlert:!1})))}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(v.b),i.Zb(Gm.b),i.Zb(gf),i.Zb(mf),i.Zb(Gm.a))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),xf=(()=>{class e{constructor(e){this.organizations=e}}return e.type="[Organizations] Set Organizations",e})(),vf=(()=>{class e{constructor(e){this.organization=e}}return e.type="[Organizations] Select Organization",e})(),Of=(()=>{class e{constructor(e){this.collection=e}}return e.type="[Organizations] Select Collection",e})(),wf=(()=>{class e{constructor(e){this.organizationId=e}}return e.type="[Organizations] Get Collections",e})(),Cf=(()=>{class e{constructor(e){this.collections=e}}return e.type="[Organizations] Get Collections Success",e})(),Sf=(()=>{class e{constructor(e,t){this.organizationId=e,this.collectionName=t}}return e.type="[Organizations] Add Collection",e})(),_f=(()=>{class e{constructor(e,t){this.organizationId=e,this.collectionName=t}}return e.type="[Organizations] Add Collection Success",e})(),jf=(()=>{class e{constructor(e){this.error=e}}return e.type="[Organizations] Add Collection Error",e})(),kf=(()=>{class e{constructor(e){this.collection=e}}return e.type="[Organizations] Remove Collection",e})(),Pf=(()=>{class e{constructor(e){this.collection=e}}return e.type="[Organizations] Remove Collection Success",e})(),Mf=(()=>{class e{constructor(e){this.error=e}}return e.type="[Organizations] Remove Collection Error",e})(),If=(()=>{class e{constructor(e){this.collection=e}}return e.type="[Organizations] Set Collection Rename Mode",e})(),zf=(()=>{class e{constructor(e,t){this.collection=e,this.collectionName=t}}return e.type="[Organizations] Rename Collection",e})(),Tf=(()=>{class e{constructor(e,t){this.collection=e,this.collectionName=t}}return e.type="[Organizations] Rename Collection Success",e})(),Uf=(()=>{class e{constructor(e){this.error=e}}return e.type="[Organizations] Rename Collection Error",e})(),Df=(()=>{class e{constructor(e,t){this.organizationId=e,this.collections=t}}return e.type="[Organizations] Reorder Collections",e})(),Lf=(()=>{class e{constructor(e,t){this.organizationId=e,this.collections=t}}return e.type="[Organizations] Reorder Collections Success",e})(),Ef=(()=>{class e{constructor(e){this.error=e}}return e.type="[Organizations] Reorder Collections Error",e})(),Ff=(()=>{class e{constructor(){}}return e.type="[Organizations] Reset",e})(),Af=(()=>{class e{constructor(e){this.organization=e}}return e.type="[Organizations] Create Organization",e})(),Rf=(()=>{class e{constructor(){}}return e.type="[Organizations] Create Organization Success",e})(),Vf=(()=>{class e{constructor(e){this.error=e}}return e.type="[Organizations] Create Organization Fail",e})(),Nf=(()=>{class e{constructor(e){this.organization=e}}return e.type="[Organizations] Update Organization",e})(),Bf=(()=>{class e{constructor(){}}return e.type="[Organizations] Update Organization Success",e})(),Hf=(()=>{class e{constructor(e){this.error=e}}return e.type="[Organizations] Update Organization Fail",e})(),Qf=(()=>{class e{constructor(e){this.request=e}}return e.type="[Organizations] Get Organization Profile",e})(),$f=(()=>{class e{constructor(e){this.organizationProfile=e}}return e.type="[Organizations] Get Organization Profile Success",e})(),qf=(()=>{class e{constructor(e){this.error=e}}return e.type="[Organizations] Get Organization Profile Fail",e})(),Wf=(()=>{class e{constructor(){}}return e.type="[Organizations] Clear Organization Profile",e})();class Kf{constructor(e,t,n){this.category=e,this.message=t,this.log=n}}let Gf=(()=>{class e{constructor(e){this.http=e,this.log={}}logError(e,t=!1){const n=`${e.category}${e.message}`;return t&&this.log[n]?Object(zs.a)():(this.log[n]=!0,this.http.post("/ws/human-error",e))}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(v.b))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var Zf;!function(e){class t{constructor(e){this.searchMode=e}}t.type="[Gallery] Set Search Mode",e.SetSearchMode=t;class n{constructor(e){this.viewMode=e}}n.type="[Gallery] Set View Mode",e.SetViewMode=n;class i{constructor(e,t=!1){this.show=e,this.triggerDrawer=t}}i.type="[Gallery] Show Filters",e.ShowFilters=i;class s{constructor(e){this.organizationId=e}}s.type="[Gallery] Get Studio Options",e.GetStudioOptions=s;class o{constructor(e){this.options=e}}o.type="[Gallery] Get Studio Options Success",e.GetStudioOptionsSuccess=o;class r{constructor(e){this.config=e}}r.type="[Gallery] Search Loft",e.SearchLoft=r;class a{constructor(e){this.bookmarks=e}}a.type="[Gallery] Search Loft Success",e.SearchLoftSuccess=a;class c{constructor(e,t){this.config=e,this.options=t}}c.type="[Gallery] Set Search Config",e.SetSearchConfig=c;class l{constructor(e){this.options=e}}l.type="[Gallery] Set Search Options",e.SetSearchOptions=l;class p{constructor(e){this.activeTags=e}}p.type="[Gallery] Set Active Tags",e.SetActiveTags=p;class d{constructor(e){this.categoryId=e}}d.type="[Gallery] Search Category",e.SearchCategory=d;class u{constructor(){}}u.type="[Gallery] Search Studio",e.SearchStudio=u;class g{constructor(e){this.bookmarks=e}}g.type="[Gallery] Search Studio Success",e.SearchStudioSuccess=g;class h{constructor(e){this.bookmarks=e}}h.type="[Gallery] Search Success",e.SearchSuccess=h;class b{constructor(e){this.result=e}}b.type="[Gallery] Select Bookmark",e.SelectBookmark=b;class m{constructor(e){this.sidenav=e}}m.type="[Gallery] Set Sidenav",e.SetSidenav=m;class f{constructor(e){this.bulkActions=e}}f.type="[Gallery] Set Bulk Actions",e.SetBulkActions=f;class y{constructor(e){this.cardActions=e}}y.type="[Gallery] Set Card Actions",e.SetCardActions=y;class x{constructor(){}}x.type="[Gallery] Clear Results",e.ClearResults=x;class v{constructor(e,t){this.id=e,this.checked=t}}v.type="[Gallery] Check Item",e.CheckItem=v;class O{constructor(){}}O.type="[Gallery] Check All",e.CheckAll=O;class w{constructor(){}}w.type="[Gallery] Uncheck All",e.UncheckAll=w;class C{constructor(e){this.ids=e}}C.type="[Gallery] Set Checked Items",e.SetCheckedItems=C;class S{constructor(){}}S.type="[Gallery] Reset",e.Reset=S}(Zf||(Zf={}));var Jf=function(e){return e.Web="web",e.Mobile="mobilesdk",e}({});let Xf=(()=>{class e{constructor(){}}return e.type="[Subscription] Reset Subscription State",e})();const Yf={"Sign in":"3971305","Sign up":"3971297"};let ey=(()=>{class e{constructor(e){this.config=e,this.initialized=!1}initialize(){if(!this.config.enabled||this.initialized)return;const e=`\n      _linkedin_partner_id = "${this.config.linkedinId}"; \n      window._linkedin_data_partner_ids = window._linkedin_data_partner_ids || []; \n      window._linkedin_data_partner_ids.push(_linkedin_partner_id);\n      (function(){var s = document.getElementsByTagName("script")[0]; var b = document.createElement("script"); b.type = "text/javascript";b.async = true; b.src = "https://snap.licdn.com/li.lms-analytics/insight.min.js"; s.parentNode.insertBefore(b, s);})();\n    `,t=document.createElement("script");t.textContent=e,document.body.appendChild(t),this.initialized=!0}track(e){const t=Yf[e];if(t){const e=document.createElement("img");e.height=1,e.width=1,e.style.display="none",e.alt="",e.src=`https://px.ads.linkedin.com/collect/?pid=${this.config.linkedinId}&conversionId=${t}&fmt=gif`,document.body.appendChild(e)}}}return e.\u0275fac=function(t){return new(t||e)(i.Zb("linkedinConfig"))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var ty=function(e){return e.Free="free",e.Premium="premium",e.Team="team",e}({});let ny=(()=>{class e{constructor(e,t){this.http=e,this.productService=t}trackContentPublish(e,t){return this.http.post("/ws/user/analytics/content/inapp/publish",{version:4,app_producttype:this.productService.productType,app_productkey:this.productService.productKey,content_type:t,content_id:e})}trackContentView(e,t){return this.http.post("/ws/user/analytics/content/inapp/view",{version:4,app_producttype:this.productService.productType,app_productkey:this.productService.productKey,content_type:t,content_id:e})}checkContentView(){return this.http.get("/ws/user/content/inapp/view/check")}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(v.b),i.Zb(mf))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function iy(e,t){return Object(D.get)(e,"permissions",[]).includes(t)}function sy(e){return Array.isArray(e.group_access)&&e.group_access.length>0}var oy,ry=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},ay=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const cy=c.application===s.Studio,ly={loading:!1,requestingCode:!1,profileStatus:"ready",auth2:null,googleAuthStatus:"waiting",loggedIn:null,userLocale:null,userRoles:[],contentViews:{limit_reached:!1,inapp_view_limit:0,inapp_view_count:0},developerReferral:!1};let py=(()=>{let e=oy=class{constructor(e,t,n,i,s,o,r,a){this.authService=e,this.userMessageService=t,this.storageService=n,this.errorLoggingService=i,this.linkedinInsights=s,this.pendoService=o,this.contentViewService=r,this.productService=a}static getLoggedIn(e){return e.loggedIn}static getEnvironmentSettings(e){return e.environmentSettings}static getUserProfile(e){return e.userProfile}static getUserRole(e){if(!Object(D.isNil)(e.userProfile))return Object(D.get)(e,"userProfile.organizations[0].user_role",of)}static getUserRoles(e){return e.userRoles}static getUserType(e){if(!Object(D.isNil)(e.userProfile)){const{premium_account:t,premium_account_type:n}=e.userProfile;if(t)return"group"===n?ty.Team:ty.Premium}return ty.Free}static canInviteUsers(e){if(!Object(D.isNil)(e.userProfile)){const t=oy.getUserType(e);return iy(oy.getUserRole(e),Xm.InviteUsers)&&t===ty.Team}return!1}static getUserAccountSettings(e){return Object(D.get)(e,"userProfile.account_settings",[])}static getAuth2(e){return e.auth2}static getGoogleAuthOnline(e){return e.googleAuthStatus}static getProfileCheck(e){return e.profileCheck}static getLoading(e){return e.loading}static getVerifyingProfile(e){return"verifying"===e.profileStatus}static getProfileUpdating(e){return"updating"===e.profileStatus}static getProfileDeleting(e){return"deleting"===e.profileStatus}static getUserLocale(e){return e.userLocale}static getUserLanguage(e){return Object(D.get)(e,"userLocale.lang",pe.lang)}static getUserApps(e){return Object(D.get)(e,"userApps",[])}static getSelectedUserApp(e){return(e.userApps||[]).find(t=>t.id===e.selectedAppId)}static getUserFullName(e){var t,n;if(Object(D.isNil)(e.userProfile))return null;const i=null!==(t=e.userProfile.first_name)&&void 0!==t?t:"",s=null!==(n=e.userProfile.last_name)&&void 0!==n?n:"";return Object(D.trim)([i,s].join(" "))}static getUserEmail(e){return Object(D.isNil)(e.userProfile)?null:e.userProfile.email}static isPrivateUser(e){return!Object(D.isNil)(e.userProfile)&&0===Object(D.get)(e,"userProfile.organizations",[]).length}static isPremiumUser(e){return!0===Object(D.get)(e,"userProfile.premium_account_valid")}static isAdmin(e){const t=this.getUserRole(e);return!!t&&t.role_name===Ym.Admin}static isDeveloperReferral(e){return e.developerReferral}static getContentViews(e){return e.contentViews}static getContentViewsReached(e){return!oy.isPremiumUser(e)&&e.contentViews.limit_reached}initializeGoogleOAuth(e){e.dispatch(new Mb("loading")),gapi.load("auth2",{callback:()=>{const t=gapi.auth2.init({client_id:c.googleAuthKey,scope:"profile"});e.patchState({auth2:t}),t.then(()=>{e.dispatch(new Mb("ready"))},()=>{e.dispatch(new Mb("error"))})},onerror:()=>{e.dispatch(new Mb("error"))},timeout:5e3,ontimeout:()=>{e.dispatch(new Mb("error"))}})}setGoogleAuthOnline(e,t){e.patchState({googleAuthStatus:t.online})}isLoggedIn(e,t){e.patchState({loading:!0}),this.authService.isLoggedIn().pipe(Object(Mr.a)(()=>e.patchState({loading:!1}))).subscribe(t=>{e.dispatch(t.signed_in?new _b:new jb)})}isLoggedInSuccess(e,t){e.patchState({loggedIn:!0})}isLoggedInFailure(e,t){e.patchState({loggedIn:!1})}login(e,t){e.patchState({loading:!0}),this.verify("studio_login",t.login.email,e).pipe(Object(Us.b)(e=>this.authService.loginWithBiodigital(Object.assign(Object.assign({},t.login),e?{site_verify_response:e}:null))),Object(Mr.a)(()=>e.patchState({loading:!1}))).subscribe(t=>{e.dispatch(new zb("biodigital",t))},n=>{this.logFailure("LOGIN_FAILURE",n),e.dispatch(new Tb("biodigital",n,t.login))})}loginWithGoogle(e,t){e.patchState({loading:!0}),this.authService.loginWithGoogle(t.login).pipe(Object(Mr.a)(()=>e.patchState({loading:!1}))).subscribe(t=>{e.dispatch(new zb("google",t))},n=>{1!==t.login.groupCodeMode&&1!==t.login.groupInviteMode||this.logFailure("GOOGLE_SIGNUP_FAILURE",n),e.dispatch(new Tb("google",n,t.login))})}loginSuccess(e,t){cy&&(this.linkedinInsights.track("Sign in"),"google"===t.loginType&&"signup"===t.response.authentication_type?this.pendoService.trackSignUp(t.loginType):this.pendoService.trackSignIn(t.loginType)),e.dispatch(new Sb),e.dispatch(new gm)}loginFailure(e,t){var n;cy&&this.pendoService.track("Sign In - Failure",{type:t.loginType,error:Object(D.get)(t,"error.error.error.message")||"There was an error logging in.",statusCode:null===(n=t.error)||void 0===n?void 0:n.status})}logout(e,t){e.patchState({loading:!0}),this.authService.logout().pipe(Object(Mr.a)(()=>e.patchState({loading:!1}))).subscribe(()=>e.dispatch(new Db),()=>e.dispatch(new Lb))}logoutSuccess(e,t){e.setState(ly),e.dispatch(new Pm),e.dispatch(new Xf),e.dispatch(new Cc),e.dispatch(new Zp),e.dispatch(new yt),e.dispatch(new fo),e.dispatch(new tl.ResetLayout),e.dispatch(new Ff),e.dispatch(new Me),e.dispatch(new Gn),e.dispatch(new Zf.Reset),this.storageService.clearSessionStorage()}checkProfile(e,t){return e.patchState({loading:!0}),this.authService.checkProfile(t.email).pipe(Object(Mr.a)(()=>e.patchState({loading:!1}))).subscribe(t=>{e.dispatch(new Gb(t))},t=>{e.dispatch(new Zb(t))})}checkProfileSuccess(e,t){e.patchState({profileCheck:t.profile})}getUserProfile(e,{hardCheck:t}){return e.patchState({loading:!0}),this.authService.getUserProfile(t).pipe(Object(Mr.a)(()=>e.patchState({loading:!1}))).subscribe(t=>{e.dispatch(new Vb(t))},t=>{e.dispatch(new Nb(t))})}getUserProfileSuccess(e,t){e.patchState({userProfile:t.userProfile}),e.dispatch(new xf(t.userProfile.organizations)),e.dispatch(new hm),e.dispatch(new gm)}updateUserProfile(e,{userProfile:t}){e.patchState({profileStatus:"updating"}),this.authService.updaterUserProfile(t).pipe(Object(Mr.a)(()=>e.patchState({profileStatus:"ready"}))).subscribe(()=>{e.dispatch(new Hb(t))},t=>{e.dispatch(new Qb(t))})}updateUserProfileSuccess(e,{userProfile:t}){this.pendoService.updateVisitorData(t)}deleteUserProfile(e,t){e.patchState({profileStatus:"deleting"}),this.authService.deleteUserProfile().pipe(Object(Mr.a)(()=>e.patchState({profileStatus:"ready"}))).subscribe(t=>{e.dispatch(new qb(t))},t=>{e.dispatch(new Wb(t))})}getUserRoles(e,t){this.authService.getUserRoles().subscribe(t=>{e.patchState({userRoles:t})})}getUserApps(e,t){this.authService.getUserApps().subscribe(t=>{e.dispatch(new bm(t)),e.dispatch(new mm)},e=>{})}setUserApps(e,{apps:t}){e.patchState({userApps:t})}setSelectedUserApp(e,{appId:t}){e.patchState({selectedAppId:t}),null!==t?this.storageService.setLocalItem(ir.UserAppId,t):this.storageService.removeLocalItem(ir.UserAppId)}checkSelectedUserApp(e,t){const n=e.getState().userApps,i=this.storageService.getLocalItem(ir.UserAppId);if(i){const t=parseInt(i,10);e.dispatch(new fm(t))}else if(n&&n.length){const t=n.find(e=>e.app_platform.some(e=>e.type===Jf.Web));e.dispatch(new fm(t?t.id:void 0))}}checkSession(e,t){e.patchState({loading:!0}),this.authService.isLoggedIn().pipe(Object(Mr.a)(()=>e.patchState({loading:!1}))).subscribe(t=>{t.signed_in?(e.dispatch(new _b),e.dispatch(new Rb),e.dispatch(new Jb)):e.dispatch(new jb)})}getEnvironmentSettings(e,t){return e.patchState({loading:!0}),this.authService.getEnvironmentSettings().pipe(Object(Mr.a)(()=>e.patchState({loading:!1}))).subscribe(t=>{e.dispatch(new Fb(t))},t=>{e.dispatch(new Ab(t))})}GetEnvironmentSettingsSuccess(e,t){e.patchState({environmentSettings:t.environmentSettings})}resetPassword(e,t){e.patchState({loading:!0}),this.authService.resetPassword(t.email).pipe(Object(Mr.a)(()=>e.patchState({loading:!1}))).subscribe(()=>{e.dispatch(new Yb(t.email))},t=>{e.dispatch(new em(t))})}transferFacebookAccount(e,t){e.patchState({loading:!0}),this.verify("deactivate_facebook",t.email,e).pipe(Object(Us.b)(e=>this.authService.deactivateFacebook(Object.assign(Object.assign({version:4,app_productkey:this.productService.productKey,app_producttype:this.productService.productType},e?{site_verify_response:e}:null),{user_email:t.email}))),Object(Mr.a)(()=>e.patchState({loading:!1}))).subscribe(n=>{console.log(n),e.dispatch(n.conversion_complete&&n.reset_password_email_sent?new nm(t.email):new im(new Error("Facebook deactivation failed")))},t=>{e.dispatch(new im(t))})}updatePassword(e,t){const{currentPassword:n,newPassword:i,confirmNewPassword:s}=t;this.authService.updatePassword(n,i,s).subscribe(()=>{e.dispatch(new om)},t=>{e.dispatch(new rm(t))})}signUp(e,t){e.patchState({loading:!0}),this.verify("studio_signup",t.value.email,e).pipe(Object(Us.b)(e=>this.authService.signUp(Object.assign(Object.assign({},t.value),e?{site_verify_response:e}:null))),Object(Mr.a)(()=>e.patchState({loading:!1}))).subscribe(t=>{e.dispatch(new lm(t))},t=>{e.dispatch(new pm(t))})}signUpSuccess(e,t){cy&&this.pendoService.trackSignUp("biodigital")}signUpFailure(e,t){var n;cy&&this.pendoService.track("Sign Up - Failure",{error:Object(D.get)(t,"error.error.error.message")||"There was an error signing up.",statusCode:null===(n=t.error)||void 0===n?void 0:n.status}),this.logFailure("BIODIGITAL_SIGNUP_FAILURE",t)}setUserLocale(e,{locale:t}){this.storageService.setLocalItem(ir.Locale,t.id),e.patchState({userLocale:t}),e.dispatch(new um(t))}checkLocale(e,t){const n=ue(),i=de.find(e=>e.id===n)||pe;e.dispatch(new dm(i))}sendUserMessage(e,{message:t}){this.userMessageService.sendMessage(t).subscribe(()=>{e.dispatch(new xm(t))},t=>{e.dispatch(new vm(t))})}getUserMessage(e,{type:t,mode:n}){this.userMessageService.getUserMessage(t,n).subscribe(t=>{e.dispatch(new wm(t))},()=>{e.dispatch(new Cm(t))})}setUserMessageViewed(e,{messageSeenId:t}){this.userMessageService.setUserMessageViewed(t).subscribe(()=>e.dispatch(new _m),()=>e.dispatch(new jm))}resetAuth(e,t){e.setState(ly),e.dispatch(new Pb)}requestVerificationCode(e,{email:t,token:n}){e.patchState({requestingCode:!0}),this.authService.requestVerificationCode({user_email:t,verification_jwt:n}).pipe(Object(Mr.a)(()=>e.patchState({requestingCode:!1}))).subscribe(t=>{e.dispatch(new Im(t))},t=>{e.dispatch(new zm(t))})}verifyProfile(e,{email:t,token:n,code:i}){const s=i.toUpperCase();e.patchState({profileStatus:"verifying"}),this.authService.verifyProfile({user_email:t,verification_code:s,verification_jwt:n}).pipe(Object(Mr.a)(()=>e.patchState({profileStatus:"ready"}))).subscribe(t=>{e.dispatch(new Um(t)),e.dispatch(new am)},t=>{e.dispatch(new Dm(t))})}verifyProfileSuccess(e){this.pendoService.track("Email Verify - Success",{platform:this.productService.productType})}verifyProfileFail(e,t){var n;this.pendoService.track("Email Verify - Failure",{error:Object(D.get)(t,"error.error.error.message")||"There was an error with email verification.",statusCode:null===(n=t.error)||void 0===n?void 0:n.status})}setContentView(e,{contentId:t,contentType:n}){this.contentViewService.trackContentView(t,n).subscribe(()=>{e.dispatch(new Em),e.dispatch(new Fm)})}checkContentViews(e,t){this.contentViewService.checkContentView().subscribe(t=>{e.patchState({contentViews:t}),e.dispatch(new Am(t))})}setDeveloperReferral(e,t){e.patchState({developerReferral:t.isDeveloperReferral})}logFailure(e,t){const n=Object(D.get)(t,"message")||"",i=Object(D.get)(t,"error.error.message")||"";this.errorLoggingService.logError(new Kf(e,n,i)).subscribe()}verify(e,t,n){return this.authService.isReCaptchaWhiteListed(t)?Object(zs.a)(null):this.authService.isHuman(e).pipe(Object(vn.a)(e=>{e.isHuman||n.dispatch(new km)}),Object(I.a)(e=>e.isHuman),Object(F.a)(e=>e.verification))}ngxsOnInit(e){e.dispatch(new am),e.dispatch(new gm),e.dispatch(new mm),e.dispatch(new Pb)}};return e.\u0275fac=function(t){return new(t||e)(i.Zb(yf),i.Zb(gf),i.Zb(ar),i.Zb(Gf),i.Zb(ey),i.Zb(G),i.Zb(ny),i.Zb(mf))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac}),ry([Object(d.a)(Pb),ay("design:type",Function),ay("design:paramtypes",[Object]),ay("design:returntype",void 0)],e.prototype,"initializeGoogleOAuth",null),ry([Object(d.a)(Mb),ay("design:type",Function),ay("design:paramtypes",[Object,Mb]),ay("design:returntype",void 0)],e.prototype,"setGoogleAuthOnline",null),ry([Object(d.a)(Sb),ay("design:type",Function),ay("design:paramtypes",[Object,Sb]),ay("design:returntype",void 0)],e.prototype,"isLoggedIn",null),ry([Object(d.a)(_b),ay("design:type",Function),ay("design:paramtypes",[Object,_b]),ay("design:returntype",void 0)],e.prototype,"isLoggedInSuccess",null),ry([Object(d.a)(jb),ay("design:type",Function),ay("design:paramtypes",[Object,jb]),ay("design:returntype",void 0)],e.prototype,"isLoggedInFailure",null),ry([Object(d.a)(kb),ay("design:type",Function),ay("design:paramtypes",[Object,kb]),ay("design:returntype",void 0)],e.prototype,"login",null),ry([Object(d.a)(Ib),ay("design:type",Function),ay("design:paramtypes",[Object,Ib]),ay("design:returntype",void 0)],e.prototype,"loginWithGoogle",null),ry([Object(d.a)(zb),ay("design:type",Function),ay("design:paramtypes",[Object,zb]),ay("design:returntype",void 0)],e.prototype,"loginSuccess",null),ry([Object(d.a)(Tb),ay("design:type",Function),ay("design:paramtypes",[Object,Tb]),ay("design:returntype",void 0)],e.prototype,"loginFailure",null),ry([Object(d.a)(Ub),ay("design:type",Function),ay("design:paramtypes",[Object,Ub]),ay("design:returntype",void 0)],e.prototype,"logout",null),ry([Object(d.a)(Db),ay("design:type",Function),ay("design:paramtypes",[Object,Db]),ay("design:returntype",void 0)],e.prototype,"logoutSuccess",null),ry([Object(d.a)(Kb),ay("design:type",Function),ay("design:paramtypes",[Object,Kb]),ay("design:returntype",void 0)],e.prototype,"checkProfile",null),ry([Object(d.a)(Gb),ay("design:type",Function),ay("design:paramtypes",[Object,Gb]),ay("design:returntype",void 0)],e.prototype,"checkProfileSuccess",null),ry([Object(d.a)(Rb),ay("design:type",Function),ay("design:paramtypes",[Object,Rb]),ay("design:returntype",void 0)],e.prototype,"getUserProfile",null),ry([Object(d.a)(Vb),ay("design:type",Function),ay("design:paramtypes",[Object,Vb]),ay("design:returntype",void 0)],e.prototype,"getUserProfileSuccess",null),ry([Object(d.a)(Bb),ay("design:type",Function),ay("design:paramtypes",[Object,Bb]),ay("design:returntype",void 0)],e.prototype,"updateUserProfile",null),ry([Object(d.a)(Hb),ay("design:type",Function),ay("design:paramtypes",[Object,Bb]),ay("design:returntype",void 0)],e.prototype,"updateUserProfileSuccess",null),ry([Object(d.a)($b),ay("design:type",Function),ay("design:paramtypes",[Object,$b]),ay("design:returntype",void 0)],e.prototype,"deleteUserProfile",null),ry([Object(d.a)(Jb),ay("design:type",Function),ay("design:paramtypes",[Object,Jb]),ay("design:returntype",void 0)],e.prototype,"getUserRoles",null),ry([Object(d.a)(hm),ay("design:type",Function),ay("design:paramtypes",[Object,hm]),ay("design:returntype",void 0)],e.prototype,"getUserApps",null),ry([Object(d.a)(bm),ay("design:type",Function),ay("design:paramtypes",[Object,bm]),ay("design:returntype",void 0)],e.prototype,"setUserApps",null),ry([Object(d.a)(fm),ay("design:type",Function),ay("design:paramtypes",[Object,fm]),ay("design:returntype",void 0)],e.prototype,"setSelectedUserApp",null),ry([Object(d.a)(mm),ay("design:type",Function),ay("design:paramtypes",[Object,mm]),ay("design:returntype",void 0)],e.prototype,"checkSelectedUserApp",null),ry([Object(d.a)(am),ay("design:type",Function),ay("design:paramtypes",[Object,am]),ay("design:returntype",void 0)],e.prototype,"checkSession",null),ry([Object(d.a)(Eb),ay("design:type",Function),ay("design:paramtypes",[Object,Eb]),ay("design:returntype",void 0)],e.prototype,"getEnvironmentSettings",null),ry([Object(d.a)(Fb),ay("design:type",Function),ay("design:paramtypes",[Object,Fb]),ay("design:returntype",void 0)],e.prototype,"GetEnvironmentSettingsSuccess",null),ry([Object(d.a)(Xb),ay("design:type",Function),ay("design:paramtypes",[Object,Xb]),ay("design:returntype",void 0)],e.prototype,"resetPassword",null),ry([Object(d.a)(tm),ay("design:type",Function),ay("design:paramtypes",[Object,tm]),ay("design:returntype",void 0)],e.prototype,"transferFacebookAccount",null),ry([Object(d.a)(sm),ay("design:type",Function),ay("design:paramtypes",[Object,sm]),ay("design:returntype",void 0)],e.prototype,"updatePassword",null),ry([Object(d.a)(cm),ay("design:type",Function),ay("design:paramtypes",[Object,cm]),ay("design:returntype",void 0)],e.prototype,"signUp",null),ry([Object(d.a)(lm),ay("design:type",Function),ay("design:paramtypes",[Object,lm]),ay("design:returntype",void 0)],e.prototype,"signUpSuccess",null),ry([Object(d.a)(pm),ay("design:type",Function),ay("design:paramtypes",[Object,pm]),ay("design:returntype",void 0)],e.prototype,"signUpFailure",null),ry([Object(d.a)(dm),ay("design:type",Function),ay("design:paramtypes",[Object,dm]),ay("design:returntype",void 0)],e.prototype,"setUserLocale",null),ry([Object(d.a)(gm),ay("design:type",Function),ay("design:paramtypes",[Object,gm]),ay("design:returntype",void 0)],e.prototype,"checkLocale",null),ry([Object(d.a)(ym),ay("design:type",Function),ay("design:paramtypes",[Object,ym]),ay("design:returntype",void 0)],e.prototype,"sendUserMessage",null),ry([Object(d.a)(Om),ay("design:type",Function),ay("design:paramtypes",[Object,Om]),ay("design:returntype",void 0)],e.prototype,"getUserMessage",null),ry([Object(d.a)(Sm),ay("design:type",Function),ay("design:paramtypes",[Object,Sm]),ay("design:returntype",void 0)],e.prototype,"setUserMessageViewed",null),ry([Object(d.a)(Pm),ay("design:type",Function),ay("design:paramtypes",[Object,Pm]),ay("design:returntype",void 0)],e.prototype,"resetAuth",null),ry([Object(d.a)(Mm),ay("design:type",Function),ay("design:paramtypes",[Object,Mm]),ay("design:returntype",void 0)],e.prototype,"requestVerificationCode",null),ry([Object(d.a)(Tm),ay("design:type",Function),ay("design:paramtypes",[Object,Tm]),ay("design:returntype",void 0)],e.prototype,"verifyProfile",null),ry([Object(d.a)(Um),ay("design:type",Function),ay("design:paramtypes",[Object]),ay("design:returntype",void 0)],e.prototype,"verifyProfileSuccess",null),ry([Object(d.a)(Dm),ay("design:type",Function),ay("design:paramtypes",[Object,Dm]),ay("design:returntype",void 0)],e.prototype,"verifyProfileFail",null),ry([Object(d.a)(Lm),ay("design:type",Function),ay("design:paramtypes",[Object,Lm]),ay("design:returntype",void 0)],e.prototype,"setContentView",null),ry([Object(d.a)(Fm),ay("design:type",Function),ay("design:paramtypes",[Object,Fm]),ay("design:returntype",void 0)],e.prototype,"checkContentViews",null),ry([Object(d.a)(Rm),ay("design:type",Function),ay("design:paramtypes",[Object,Rm]),ay("design:returntype",void 0)],e.prototype,"setDeveloperReferral",null),ry([Object(d.e)(),ay("design:type",Function),ay("design:paramtypes",[Cb]),ay("design:returntype",void 0)],e,"getLoggedIn",null),ry([Object(d.e)(),ay("design:type",Function),ay("design:paramtypes",[Cb]),ay("design:returntype",void 0)],e,"getEnvironmentSettings",null),ry([Object(d.e)(),ay("design:type",Function),ay("design:paramtypes",[Cb]),ay("design:returntype",void 0)],e,"getUserProfile",null),ry([Object(d.e)(),ay("design:type",Function),ay("design:paramtypes",[Cb]),ay("design:returntype",Jm)],e,"getUserRole",null),ry([Object(d.e)(),ay("design:type",Function),ay("design:paramtypes",[Cb]),ay("design:returntype",Array)],e,"getUserRoles",null),ry([Object(d.e)(),ay("design:type",Function),ay("design:paramtypes",[Cb]),ay("design:returntype",String)],e,"getUserType",null),ry([Object(d.e)(),ay("design:type",Function),ay("design:paramtypes",[Cb]),ay("design:returntype",Boolean)],e,"canInviteUsers",null),ry([Object(d.e)(),ay("design:type",Function),ay("design:paramtypes",[Cb]),ay("design:returntype",Array)],e,"getUserAccountSettings",null),ry([Object(d.e)(),ay("design:type",Function),ay("design:paramtypes",[Cb]),ay("design:returntype",Object)],e,"getAuth2",null),ry([Object(d.e)(),ay("design:type",Function),ay("design:paramtypes",[Cb]),ay("design:returntype",String)],e,"getGoogleAuthOnline",null),ry([Object(d.e)(),ay("design:type",Function),ay("design:paramtypes",[Cb]),ay("design:returntype",void 0)],e,"getProfileCheck",null),ry([Object(d.e)(),ay("design:type",Function),ay("design:paramtypes",[Cb]),ay("design:returntype",void 0)],e,"getLoading",null),ry([Object(d.e)(),ay("design:type",Function),ay("design:paramtypes",[Cb]),ay("design:returntype",void 0)],e,"getVerifyingProfile",null),ry([Object(d.e)(),ay("design:type",Function),ay("design:paramtypes",[Cb]),ay("design:returntype",void 0)],e,"getProfileUpdating",null),ry([Object(d.e)(),ay("design:type",Function),ay("design:paramtypes",[Cb]),ay("design:returntype",void 0)],e,"getProfileDeleting",null),ry([Object(d.e)(),ay("design:type",Function),ay("design:paramtypes",[Cb]),ay("design:returntype",void 0)],e,"getUserLocale",null),ry([Object(d.e)(),ay("design:type",Function),ay("design:paramtypes",[Cb]),ay("design:returntype",String)],e,"getUserLanguage",null),ry([Object(d.e)(),ay("design:type",Function),ay("design:paramtypes",[Cb]),ay("design:returntype",void 0)],e,"getUserApps",null),ry([Object(d.e)(),ay("design:type",Function),ay("design:paramtypes",[Cb]),ay("design:returntype",void 0)],e,"getSelectedUserApp",null),ry([Object(d.e)(),ay("design:type",Function),ay("design:paramtypes",[Cb]),ay("design:returntype",void 0)],e,"getUserFullName",null),ry([Object(d.e)(),ay("design:type",Function),ay("design:paramtypes",[Cb]),ay("design:returntype",void 0)],e,"getUserEmail",null),ry([Object(d.e)(),ay("design:type",Function),ay("design:paramtypes",[Cb]),ay("design:returntype",void 0)],e,"isPrivateUser",null),ry([Object(d.e)(),ay("design:type",Function),ay("design:paramtypes",[Cb]),ay("design:returntype",void 0)],e,"isPremiumUser",null),ry([Object(d.e)(),ay("design:type",Function),ay("design:paramtypes",[Cb]),ay("design:returntype",void 0)],e,"isAdmin",null),ry([Object(d.e)(),ay("design:type",Function),ay("design:paramtypes",[Cb]),ay("design:returntype",void 0)],e,"isDeveloperReferral",null),ry([Object(d.e)(),ay("design:type",Function),ay("design:paramtypes",[Cb]),ay("design:returntype",void 0)],e,"getContentViews",null),ry([Object(d.e)(),ay("design:type",Function),ay("design:paramtypes",[Cb]),ay("design:returntype",void 0)],e,"getContentViewsReached",null),e=oy=ry([Object(d.f)({name:"auth",defaults:ly})],e),e})();const dy=["progressCircle"];let uy=(()=>{class e{constructor(e,t){this.renderer=e,this.changeRef=t,this._size="medium",this._progress=0,this.strokeWidth=8,this.diameter=120}get size(){return this._size}set size(e){this._size=e,this.updateCircle()}get progress(){return this._progress}set progress(e){this._progress=e,this.updateCircle()}ngOnInit(){}ngAfterViewInit(){this.updateCircle()}updateCircle(){switch(this.size){case"small":this.strokeWidth=4,this.diameter=60;break;case"medium":this.strokeWidth=8,this.diameter=120;break;case"large":this.strokeWidth=16,this.diameter=240}if(this.progressCircleRef){const e=2*this.progressCircleRef.nativeElement.r.baseVal.value*Math.PI,t=e-this.progress/100*e;this.renderer.setStyle(this.progressCircleRef.nativeElement,"strokeDasharray",`${e} ${e}`),this.renderer.setStyle(this.progressCircleRef.nativeElement,"strokeDashoffset",""+t)}this.changeRef.markForCheck()}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(i.H),i.Pb(i.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-progress-circle"]],viewQuery:function(e,t){if(1&e&&i.Ec(dy,!0),2&e){let e;i.sc(e=i.dc())&&(t.progressCircleRef=e.first)}},inputs:{size:"size",progress:"progress"},decls:9,vars:18,consts:[["role","progressbar","aria-valuemin","0","aria-valuemax","100","data-test","progress",1,"progress"],["stroke","#F9FAFD","fill","transparent",1,"progress__circle"],["stroke","#5BB96F","fill","transparent",1,"progress__circle"],["progressCircle",""],["data-test","progressPercentage",1,"progress__label","text-semibold"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.fc(),i.Vb(1,"svg"),i.Vb(2,"g"),i.Qb(3,"circle",1),i.Ub(),i.Vb(4,"g"),i.Qb(5,"circle",2,3),i.Ub(),i.Ub(),i.ec(),i.Vb(7,"div",4),i.Kc(8),i.Ub(),i.Ub()),2&e&&(i.Hb("progress--small","small"===t.size)("progress--medium","medium"===t.size)("progress--large","large"===t.size),i.Eb("aria-valuenow",t.progress),i.Db(1),i.Eb("width",t.diameter)("height",t.diameter),i.Db(2),i.Eb("stroke-width",t.strokeWidth)("r",t.diameter/2-2*t.strokeWidth)("cx",t.diameter/2)("cy",t.diameter/2),i.Db(2),i.Eb("stroke-width",t.strokeWidth)("r",t.diameter/2-2*t.strokeWidth)("cx",t.diameter/2)("cy",t.diameter/2),i.Db(3),i.Mc("",t.progress,"%"))},styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.progress[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:center}.progress__ring[_ngcontent-%COMP%]{position:absolute;z-index:1}.progress__circle[_ngcontent-%COMP%]{transition:stroke-dashoffset .35s;transform:rotate(-90deg);transform-origin:50% 50%}.progress__label[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);z-index:2}.progress--small[_ngcontent-%COMP%]   .progress__label[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.progress--medium[_ngcontent-%COMP%]   .progress__label[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.progress--large[_ngcontent-%COMP%]   .progress__label[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}"],changeDetection:0}),e})();var gy=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},hy=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const by=["summary"];function my(e,t){if(1&e&&(i.Vb(0,"div",14),i.Vb(1,"div",15),i.Kc(2),i.hc(3,"async"),i.Ub(),i.Vb(4,"div",16),i.Kc(5),i.hc(6,"async"),i.Ub(),i.Ub()),2&e){const e=i.gc(3);i.Db(2),i.Lc(i.ic(3,2,e.userFullName$)),i.Db(3),i.Lc(i.ic(6,4,e.userEmail$))}}function fy(e,t){if(1&e&&(i.Vb(0,"div",11),i.Ic(1,my,7,6,"div",12),i.hc(2,"async"),i.Vb(3,"div",13),i.Kc(4,"Quiz Complete"),i.Ub(),i.Ub()),2&e){const e=i.gc(2);i.Db(1),i.lc("ngIf",i.ic(2,1,e.userProfile$))}}function yy(e,t){if(1&e&&(i.Vb(0,"div",19),i.Qb(1,"app-view-quiz-answer",20),i.Ub()),2&e){const e=t.$implicit,n=t.index,s=i.gc(3);i.Db(1),i.lc("question",e)("questionNumber",n+1)("answer",null==s.quizScore?null:s.quizScore.questionAnswers[e.id])("summary",!0)}}function xy(e,t){if(1&e&&(i.Vb(0,"div",17),i.Ic(1,yy,2,4,"div",18),i.Ub()),2&e){const e=i.gc(2);i.Db(1),i.lc("ngForOf",e.questions)}}function vy(e,t){if(1&e&&(i.Tb(0),i.Vb(1,"div",3,4),i.Ic(3,fy,5,3,"div",5),i.Vb(4,"div",6),i.Qb(5,"app-progress-circle",7),i.Vb(6,"div",8),i.Kc(7,"Quiz Complete"),i.Ub(),i.Vb(8,"div",9),i.Kc(9),i.Ub(),i.Ub(),i.Ic(10,xy,2,1,"div",10),i.Ub(),i.Sb()),2&e){const e=i.gc();i.Db(3),i.lc("ngIf",e.downloading),i.Db(2),i.lc("progress",null==e.quizScore?null:e.quizScore.score),i.Db(4),i.Nc(" You answered ",null==e.quizScore?null:e.quizScore.correctTotal," of ",null==e.quizScore?null:e.quizScore.scorableTotal," questions correctly. "),i.Db(1),i.lc("ngIf",e.showExplanationEnabled&&e.showExplanation)}}function Oy(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",26),i.cc("click",(function(){return i.xc(e),i.gc(2).handleToggleSummaryClick()})),i.Kc(1),i.Ub()}if(2&e){const e=i.gc(2);i.Db(1),i.Mc(" ",e.showExplanation?"Hide Summary":"Show Summary"," ")}}function wy(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",27),i.cc("click",(function(){return i.xc(e),i.gc(2).handleDownloadSummaryClick()})),i.Qb(1,"app-icon",28),i.Kc(2," Download Results "),i.Ub()}}function Cy(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",29),i.cc("click",(function(){return i.xc(e),i.gc(2).handleRestartClick()})),i.Kc(1," Take Again "),i.Ub()}}function Sy(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",30),i.cc("click",(function(){return i.xc(e),i.gc(2).handleExitClick()})),i.Kc(1," Back to View "),i.Ub()}}function _y(e,t){if(1&e&&(i.Vb(0,"div",21),i.Ic(1,Oy,2,1,"button",22),i.Ic(2,wy,3,0,"button",23),i.Ic(3,Cy,2,0,"button",24),i.hc(4,"async"),i.Ic(5,Sy,2,0,"button",25),i.hc(6,"async"),i.Ub()),2&e){const e=i.gc();i.Db(1),i.lc("ngIf",e.showSummaryEnabled&&e.showExplanationEnabled),i.Db(1),i.lc("ngIf",e.showSummaryEnabled&&e.showExplanationEnabled),i.Db(1),i.lc("ngIf",i.ic(4,4,e.enableQuizRetake$)),i.Db(2),i.lc("ngIf",!i.ic(6,6,e.quizLocked$))}}const jy=function(e){return{"review--downloading":e}};let ky=(()=>{class e{constructor(e,t,n,i){this.changeRef=e,this.quizService=t,this.store=n,this.clipboardService=i,this.userFullName="",this.userEmail="",this.questions=[],this.showSummaryEnabled=!1,this.showExplanationEnabled=!1,this.showExplanation=!1,this.downloading=!1,this.ngUnsubscribe=new k.a}ngOnInit(){this.initReviewListeners()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initReviewListeners(){Object(Ta.b)([this.questions$,this.submissions$]).pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(([e,t])=>{this.questions=e,this.quizScore=ls(e,t),this.changeRef.markForCheck()}),this.quizSettings$.pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(({showSummary:e,showExplanation:t})=>{this.showSummaryEnabled=!1!==e,this.showExplanationEnabled=!1!==t,this.changeRef.markForCheck()})}handleToggleSummaryClick(){this.showExplanation=!this.showExplanation,this.changeRef.markForCheck()}handleDownloadSummaryClick(){this.downloadResults()}downloadResults(){const e=this.showExplanation;this.store.dispatch(new j.ShowScrim(!0,"Downloading")),this.showExplanation=!0,this.changeRef.detectChanges(),this.downloading=!0,this.changeRef.detectChanges(),Fs()(this.summary.nativeElement,{onclone:e=>{e.querySelector(".review").classList.add("review--download")}}).then(t=>{const n=this.store.selectSnapshot(za.getStory).displayName.replace(/\ /g,"_")||"anatomy",i=t.toDataURL("image/png");!0===c.native||c.platform===a.SDK?this.clipboardService.copyToClipboard(i,"image").toPromise():Object(Rs.saveAs)(i,n+"_quiz_results.png"),this.showExplanation=e,this.downloading=!1,this.store.dispatch(new j.HideScrim),this.changeRef.markForCheck()})}handleRestartClick(){this.quizService.resetQuiz(),this.quizService.startQuiz()}handleExitClick(){this.quizService.exitQuiz()}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(i.i),i.Pb(Ag),i.Pb(d.g),i.Pb(Mp))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-quiz-review"]],viewQuery:function(e,t){if(1&e&&i.Pc(by,!0),2&e){let e;i.sc(e=i.dc())&&(t.summary=e.first)}},decls:3,vars:5,consts:[["data-test","quizReview",1,"review",3,"ngClass"],[4,"ngIf"],["class","review__actions",4,"ngIf"],["data-test","quizDownload",1,"review__container"],["summary",""],["class","pv-4",4,"ngIf"],["data-test","quizSummary",1,"text-center"],["size","medium",3,"progress"],["data-html2canvas-ignore","true",1,"mt-8","text-18","text-semibold"],[1,"mv-4","text-14","text-medium"],["class","review__summary mb-4","data-test","quizExplanation",4,"ngIf"],[1,"pv-4"],["class","pb-4 pr-4",4,"ngIf"],[1,"text-18","text-semibold","text-center"],[1,"pb-4","pr-4"],[1,"text-right","text-semibold","text-14"],[1,"text-right","text-14"],["data-test","quizExplanation",1,"review__summary","mb-4"],["class","mv-6",4,"ngFor","ngForOf"],[1,"mv-6"],[3,"question","questionNumber","answer","summary"],[1,"review__actions"],["class","w-100","app-button","","buttonType","outline","buttonTheme","light","data-test","quizToggleSummaryButton",3,"click",4,"ngIf"],["class","w-100 mt-3","app-button","","buttonType","outline","buttonTheme","light","data-test","quizDownloadSummaryButton",3,"click",4,"ngIf"],["class","mt-8 w-100","app-button","","buttonType","info","buttonTheme","light","data-test","quizTakeAgainButton",3,"click",4,"ngIf"],["class","mt-3 w-100","app-button","","buttonType","info","buttonTheme","light","data-test","quizExitButton",3,"click",4,"ngIf"],["app-button","","buttonType","outline","buttonTheme","light","data-test","quizToggleSummaryButton",1,"w-100",3,"click"],["app-button","","buttonType","outline","buttonTheme","light","data-test","quizDownloadSummaryButton",1,"w-100","mt-3",3,"click"],["icon","download"],["app-button","","buttonType","info","buttonTheme","light","data-test","quizTakeAgainButton",1,"mt-8","w-100",3,"click"],["app-button","","buttonType","info","buttonTheme","light","data-test","quizExitButton",1,"mt-3","w-100",3,"click"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Ic(1,vy,11,5,"ng-container",1),i.Ic(2,_y,7,8,"div",2),i.Ub()),2&e&&(i.lc("ngClass",i.nc(3,jy,t.downloading)),i.Db(1),i.lc("ngIf",t.showSummaryEnabled),i.Db(1),i.lc("ngIf",!t.downloading))},directives:[Z.i,Z.l,uy,Z.k,wb,ud,dl],pipes:[Z.b],styles:[".review[_ngcontent-%COMP%]{position:relative}.review--downloading[_ngcontent-%COMP%]   .review__download-scrim[_ngcontent-%COMP%]{display:flex}.review--download[_ngcontent-%COMP%]{width:595px}.review--download[_ngcontent-%COMP%], .review--download[_ngcontent-%COMP%]   .review__summary[_ngcontent-%COMP%]{background-color:#fff}.review__summary[_ngcontent-%COMP%]{background-color:#f9fafd;padding:4px 12px}"],changeDetection:0}),gy([Object(d.d)(xs.getAllQuestions),hy("design:type",P.a)],e.prototype,"questions$",void 0),gy([Object(d.d)(xs.getAllSubmissions),hy("design:type",P.a)],e.prototype,"submissions$",void 0),gy([Object(d.d)(xs.getQuizSettings),hy("design:type",P.a)],e.prototype,"quizSettings$",void 0),gy([Object(d.d)(xs.getQuizModeLocked),hy("design:type",P.a)],e.prototype,"quizLocked$",void 0),gy([Object(d.d)(xs.getEnableQuizRetake),hy("design:type",P.a)],e.prototype,"enableQuizRetake$",void 0),gy([Object(d.d)(py.getUserProfile),hy("design:type",P.a)],e.prototype,"userProfile$",void 0),gy([Object(d.d)(py.getUserFullName),hy("design:type",P.a)],e.prototype,"userFullName$",void 0),gy([Object(d.d)(py.getUserEmail),hy("design:type",P.a)],e.prototype,"userEmail$",void 0),e})();var Py=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},My=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Iy(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",10),i.cc("click",(function(){return i.xc(e),i.gc(2).handleExitClick()})),i.Vb(1,"span",11),i.Kc(2,"Exit Quiz"),i.Ub(),i.Ub()}}function zy(e,t){if(1&e&&(i.Qb(0,"app-view-quiz-progress",12),i.hc(1,"async"),i.hc(2,"async")),2&e){const e=i.gc(2);i.lc("index",i.ic(1,2,e.questionIndex$))("total",i.ic(2,4,e.questionTotal$))}}function Ty(e,t){if(1&e&&(i.Vb(0,"div",5),i.Vb(1,"div",6),i.Vb(2,"h1",7),i.Kc(3,"Quiz"),i.Ub(),i.Ic(4,Iy,3,0,"button",8),i.hc(5,"async"),i.Ub(),i.Ic(6,zy,3,6,"app-view-quiz-progress",9),i.hc(7,"async"),i.hc(8,"async"),i.Ub()),2&e){const e=i.gc();let t=null;i.Db(4),i.lc("ngIf",!i.ic(5,2,e.quizLocked$)),i.Db(2),i.lc("ngIf",(null==(t=i.ic(7,4,e.quizSettings$))?null:t.showProgress)&&i.ic(8,6,e.lifecycle$)!==e.Lifecycle.Review)}}function Uy(e,t){if(1&e&&(i.Qb(0,"app-view-quiz-question",16),i.hc(1,"async")),2&e){const e=i.gc(2);i.lc("question",i.ic(1,1,e.question$))}}function Dy(e,t){if(1&e&&(i.Vb(0,"div"),i.Kc(1),i.hc(2,"async"),i.Ub()),2&e){const e=i.gc(3);let t=null;i.Db(1),i.Mc(" ",(null==(t=i.ic(2,1,e.question$))?null:t.nextLabel)||e.defaultNextButtonNext," ")}}function Ly(e,t){1&e&&(i.Vb(0,"div"),i.Kc(1,"Submit"),i.Ub())}function Ey(e,t){if(1&e&&(i.Vb(0,"button",17),i.Vb(1,"div",18),i.hc(2,"async"),i.Ic(3,Dy,3,3,"div",19),i.Ic(4,Ly,2,0,"div",20),i.Ub(),i.Ub()),2&e){const e=i.gc(2);let t=null;i.lc("disabled",!e.form.valid),i.Db(1),i.lc("ngSwitch",null==(t=i.ic(2,3,e.question$))?null:t.type),i.Db(2),i.lc("ngSwitchCase",e.quizQuestionType.Instructions)}}function Fy(e,t){if(1&e){const e=i.Wb();i.Vb(0,"form",13),i.cc("submit",(function(){return i.xc(e),i.gc().handleSubmit()})),i.Ic(1,Uy,2,3,"app-view-quiz-question",14),i.hc(2,"async"),i.Ic(3,Ey,5,5,"button",15),i.hc(4,"async"),i.hc(5,"async"),i.Ub()}if(2&e){const e=i.gc();let t=null;i.lc("formGroup",e.form),i.Db(1),i.lc("ngIf",i.ic(2,3,e.question$)),i.Db(2),i.lc("ngIf",(null==(t=i.ic(4,5,e.quizSettings$))?null:t.showSubmit)&&i.ic(5,7,e.lifecycle$)===e.Lifecycle.Question)}}function Ay(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",24),i.cc("click",(function(){return i.xc(e),i.gc(2).nextQuestion()})),i.Kc(1),i.hc(2,"async"),i.Ub()}if(2&e){const e=i.gc(2);let t=null;i.Db(1),i.Mc(" ",(null==(t=i.ic(2,1,e.question$))?null:t.nextLabel)||e.defaultNextButtonNext," ")}}function Ry(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",26),i.cc("click",(function(){return i.xc(e),i.gc(3).handleViewSummaryClick()})),i.Kc(1," See Results "),i.Ub()}}function Vy(e,t){if(1&e&&(i.Tb(0),i.Ic(1,Ry,2,0,"button",25),i.hc(2,"async"),i.Sb()),2&e){const e=i.gc(2);i.Db(1),i.lc("ngIf",i.ic(2,1,e.quizReviewEnabled$))}}function Ny(e,t){if(1&e&&(i.Tb(0),i.Vb(1,"div",21),i.Qb(2,"app-view-quiz-answer",22),i.hc(3,"async"),i.hc(4,"async"),i.Ub(),i.Tb(5,18),i.hc(6,"async"),i.Ic(7,Ay,3,3,"button",23),i.Ic(8,Vy,3,3,"ng-container",20),i.Sb(),i.Sb()),2&e){const e=i.gc();i.Db(2),i.lc("question",i.ic(3,5,e.question$))("answer",i.ic(4,7,e.submission$).answer)("summary",!1),i.Db(3),i.lc("ngSwitch",i.ic(6,9,e.hasQuestionsRemaining$)),i.Db(2),i.lc("ngSwitchCase",!0)}}function By(e,t){1&e&&(i.Tb(0),i.Qb(1,"app-view-quiz-review"),i.Sb())}function Hy(e,t){if(1&e&&(i.Vb(0,"div",27),i.Kc(1),i.hc(2,"async"),i.Ub()),2&e){const e=i.gc();let t=null;i.Db(1),i.Mc(" ",1===(null==(t=i.ic(2,1,e.questions$))?null:t.length)?"Answer":"Answers"," submitted ")}}let Qy=(()=>{class e{constructor(e,t,n,i,s,o,r){this.store=e,this.actions=t,this.formBuilder=n,this.viewService=i,this.engineService=s,this.quizService=o,this.pendoService=r,this.defaultNextButtonNext="Next Question",this.showHeader=!0,this.Lifecycle=ds,this.quizQuestionType=ss,this.sceneConfigStash={},this.ngUnsubscribe=new k.a}ngOnInit(){if(!this.store.selectSnapshot(xs.getActiveQuestionId)){const e=this.store.selectSnapshot(xs).questions[0].id;this.store.dispatch(new ns.SetActiveQuestion(e))}this.store.dispatch(new ns.SetQuizLifecycle(ds.Question)),this.form=this.formBuilder.group({question:new Du.f("",this.getQuizValidation())}),this.initQuestionObserver(),this.initAnswerObserver(),this.initEngineInteractionObserver(),this.engineService.fireEvent(At.QuizEntered,!0)}ngOnDestroy(){Object.entries(this.sceneConfigStash).forEach(([e,t])=>{this.store.dispatch(new Hn(e,t.background))}),this.engineService.fireEvent(At.QuizExited,!0),this.viewService.selectTool(kr.Select),this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}get answer(){const e=this.form.get("question").value;return Array.isArray(e)?e:[e]}initQuestionObserver(){this.question$.pipe(Object(M.a)(this.ngUnsubscribe),Object(I.a)(e=>void 0!==e)).subscribe(e=>{const t=this.store.selectSnapshot(Or.getSelectedChapterId);e.chapterId!==t&&this.store.dispatch(new Pn(e.chapterId)),this.form.reset(),this.setSceneConfig(e),this.store.dispatch(new ns.SetActiveSubmission(void 0)),e.type===ss.Instructions&&this.form.get("question").setValue("-"),this.engineService.fireEvent(At.QuizQuestionLoaded,e)})}initAnswerObserver(){this.form.get("question").valueChanges.pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{const t=this.store.selectSnapshot(xs.getActiveQuestion),n=this.store.selectSnapshot(xs.getActiveSubmission);void 0!==t&&(this.store.selectSnapshot(xs.getAllSubmissions).some(e=>e.questionId===t.id)||(n&&Object(D.isEqual)(n.answer,e)||this.store.dispatch(new ns.SetActiveSubmission({questionId:t.id,answer:e})),Object(D.isNil)(e)||this.engineService.fireEvent(At.QuizAnswerSelected,{questionId:t.id,answerId:e})))})}initEngineInteractionObserver(){this.viewService.selectTool(kr.Quiz),this.store.dispatch(new ns.SetQuizPickMode("single")),this.actions.pipe(Object(d.j)(Ge),Object(I.a)(e=>{const{node:t,event:n}=e;return!Object(D.isNil)(t)&&this.store.selectSnapshot(Er.getActiveTool)===kr.Quiz&&!n.srcEvent.shiftKey})).pipe(Object(I.a)(()=>"none"!==this.store.selectSnapshot(xs.getPickMode)),Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{"single"===this.store.selectSnapshot(xs.getPickMode)&&this.viewService.clearSelectedNodes();const t=Object(D.get)(e,"hit.objectId");if(t){const e=this.store.selectSnapshot(Bi.getCheckedNodeIds).includes(t);this.store.dispatch(new Ii.UpdateNodesChecked(!e,[t]))}}),this.question$.pipe(Object(qa.a)((e,t)=>Object(D.get)(e,"id")===Object(D.get)(t,"id")),Object(I.a)(e=>!Object(D.isNil)(e))).pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{const{type:t,data:n}=e;this.store.dispatch(new ns.SetQuizPickMode(t===ss.SelectAnatomy&&n.correctAnswer.length>1&&"any"!==n.selectType?"multi":"single"))})}handleSubmit(){const e=this.store.selectSnapshot(xs.getActiveQuestion);(this.form.valid||e.type===ss.Instructions)&&this.quizService.submitQuestion(e.id,this.answer)}handleViewSummaryClick(){this.viewSummary()}handleExitClick(){this.quizService.exitQuiz()}nextQuestion(){this.quizService.nextQuestion()}viewSummary(){this.store.dispatch(new ns.SetQuizLifecycle(ds.Review)),this.engineService.fireEvent(At.QuizCompleted,!0)}setSceneConfig(e){const{camera:t,background:n}=(null==e?void 0:e.sceneConfig)||{},i=this.store.selectSnapshot(Or.getChapter(e.chapterId));t&&(this.setStash(e.chapterId,{camera:i.camera.location}),setTimeout(()=>{this.store.dispatch(new Zt(t.location,!0,1))})),n&&(this.setStash(e.chapterId,{background:i.background}),this.store.dispatch(new Hn(e.chapterId,n)))}setStash(e,t){this.sceneConfigStash[e]=Object.assign(Object.assign({},this.sceneConfigStash[e]||{}),t)}getQuizValidation(){return e=>{const t=e.value,n=Array.isArray(t)?t:[t],i=function(e){switch(Object(D.get)(e,"type","")){case ss.MultipleChoice:const t=Object(D.get)(e,"data.correctAnswer","");return t&&""!==t;case ss.SelectAnatomy:case ss.LabelAnatomy:return Object(D.get)(e,"data.correctAnswer",[]).length>0;default:return!0}}(this.store.selectSnapshot(xs.getActiveQuestion)),s=n.some(e=>Object(D.isNil)(e)||""===e);return i&&s?{invalidValues:s}:null}}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.g),i.Pb(d.b),i.Pb(Du.e),i.Pb(Dl),i.Pb(Qt),i.Pb(Ag),i.Pb(G))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-quiz"]],inputs:{showHeader:"showHeader"},decls:13,vars:19,consts:[["data-test","quiz",1,"view-quiz"],["class","pb-2 mb-4 view-quiz__header",4,"ngIf"],[3,"formGroup","submit",4,"ngIf"],[4,"ngIf"],["class","text-16 text-bold text-center",4,"ngIf"],[1,"pb-2","mb-4","view-quiz__header"],[1,"flex"],[1,"text-20","text-semibold","flex-grow"],["app-pin-button","","icon","times","size","small","data-test","quizHeaderExit",3,"click",4,"ngIf"],["class","mt-3",3,"index","total",4,"ngIf"],["app-pin-button","","icon","times","size","small","data-test","quizHeaderExit",3,"click"],[1,"visually-hidden"],[1,"mt-3",3,"index","total"],[3,"formGroup","submit"],["formControlName","question",3,"question",4,"ngIf"],["app-button","","class","w-100","buttonType","info","data-test","questionSubmit",3,"disabled",4,"ngIf"],["formControlName","question",3,"question"],["app-button","","buttonType","info","data-test","questionSubmit",1,"w-100",3,"disabled"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"mb-8"],[3,"question","answer","summary"],["app-button","","buttonType","info","class","w-100","data-test","questionNextButton",3,"click",4,"ngSwitchCase"],["app-button","","buttonType","info","data-test","questionNextButton",1,"w-100",3,"click"],["data-test","quizViewSummaryButton","app-button","","buttonType","info","class","w-100",3,"click",4,"ngIf"],["data-test","quizViewSummaryButton","app-button","","buttonType","info",1,"w-100",3,"click"],[1,"text-16","text-bold","text-center"]],template:function(e,t){if(1&e&&(i.Vb(0,"div",0),i.Ic(1,Ty,9,8,"div",1),i.Ic(2,Fy,6,9,"form",2),i.hc(3,"async"),i.Ic(4,Ny,9,11,"ng-container",3),i.hc(5,"async"),i.Ic(6,By,2,0,"ng-container",3),i.hc(7,"async"),i.hc(8,"async"),i.Ic(9,Hy,3,3,"div",4),i.hc(10,"async"),i.hc(11,"async"),i.hc(12,"async"),i.Ub()),2&e){let e=null;i.Db(1),i.lc("ngIf",t.showHeader),i.Db(1),i.lc("ngIf",i.ic(3,5,t.lifecycle$)===t.Lifecycle.Question),i.Db(2),i.lc("ngIf",i.ic(5,7,t.lifecycle$)===t.Lifecycle.Explanation),i.Db(2),i.lc("ngIf",i.ic(7,9,t.lifecycle$)===t.Lifecycle.Review&&i.ic(8,11,t.quizReviewEnabled$)),i.Db(3),i.lc("ngIf",!(i.ic(10,13,t.hasQuestionsRemaining$)||i.ic(11,15,t.quizReviewEnabled$)||null!=(e=i.ic(12,17,t.quizSettings$))&&e.showExplanation))}},directives:[Z.l,ou,Eh,Du.v,Du.o,Du.i,sb,Du.n,Du.h,ud,Z.n,Z.o,Z.p,wb,ky],pipes:[Z.b],styles:[".view-quiz__header[_ngcontent-%COMP%]{border-bottom:1px solid #eaeff5}"],changeDetection:0}),Py([Object(d.d)(xs.getQuizReviewEnabled),My("design:type",P.a)],e.prototype,"quizReviewEnabled$",void 0),Py([Object(d.d)(xs.getActiveQuestion),My("design:type",P.a)],e.prototype,"question$",void 0),Py([Object(d.d)(xs.getAllQuestions),My("design:type",P.a)],e.prototype,"questions$",void 0),Py([Object(d.d)(xs.getActiveQuestionIndex),My("design:type",P.a)],e.prototype,"questionIndex$",void 0),Py([Object(d.d)(xs.getQuestionTotal),My("design:type",P.a)],e.prototype,"questionTotal$",void 0),Py([Object(d.d)(xs.getCorrectAnswerTotal),My("design:type",P.a)],e.prototype,"correctAnswerTotal$",void 0),Py([Object(d.d)(xs.hasQuestionRemaining),My("design:type",P.a)],e.prototype,"hasQuestionsRemaining$",void 0),Py([Object(d.d)(xs.getQuizSettings),My("design:type",P.a)],e.prototype,"quizSettings$",void 0),Py([Object(d.d)(xs.getLifecycle),My("design:type",P.a)],e.prototype,"lifecycle$",void 0),Py([Object(d.d)(xs.getQuizModeLocked),My("design:type",P.a)],e.prototype,"quizLocked$",void 0),Py([Object(d.d)(xs.getActiveSubmission),My("design:type",P.a)],e.prototype,"submission$",void 0),e})();var $y=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},qy=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const Wy=["viewDrawer"],Ky=["viewDrawerOuter"];function Gy(e,t){if(1&e&&(i.Vb(0,"div",7),i.Qb(1,"app-spinner",8),i.hc(2,"async"),i.Ub()),2&e){const e=i.gc();let t=null;i.Db(1),i.lc("label",null==(t=i.ic(2,1,e.scrim$))?null:t.label)}}function Zy(e,t){1&e&&i.Qb(0,"app-icon",21)}function Jy(e,t){1&e&&i.Qb(0,"app-icon",22)}function Xy(e,t){if(1&e&&(i.Vb(0,"div",23),i.Qb(1,"app-content-blocks",24),i.hc(2,"async"),i.Ub()),2&e){const e=i.gc(2);let t=null;i.Db(1),i.lc("contentBlocks",null==(t=i.ic(2,2,e.selectedLabel$))?null:t.contentBlocks)("layout","compact")}}function Yy(e,t){if(1&e){const e=i.Wb();i.Tb(0),i.Vb(1,"div",9),i.Vb(2,"div",10),i.Vb(3,"button",11),i.cc("click",(function(){return i.xc(e),i.gc().handleLabelBack()})),i.Qb(4,"app-icon",12),i.Ub(),i.Ub(),i.Vb(5,"div",13),i.Qb(6,"app-html",14),i.hc(7,"async"),i.Ub(),i.Vb(8,"div",15),i.Vb(9,"button",11),i.cc("click",(function(){return i.xc(e),i.gc().handleToggleClick()})),i.Ic(10,Zy,1,0,"app-icon",16),i.Ic(11,Jy,1,0,"app-icon",17),i.Ub(),i.Ub(),i.Ub(),i.Ic(12,Xy,3,4,"div",18),i.hc(13,"async"),i.Vb(14,"div",19),i.Qb(15,"app-html",20),i.hc(16,"async"),i.Ub(),i.Sb()}if(2&e){const e=i.gc();let t=null,n=null,s=null;i.Db(6),i.lc("markdownText",null==(t=i.ic(7,7,e.selectedLabel$))?null:t.title),i.Db(3),i.Eb("aria-expanded",e.open)("aria-label",e.open?"Close Info Panel":"Open Info Panel"),i.Db(1),i.lc("ngIf",!e.open),i.Db(1),i.lc("ngIf",e.open),i.Db(1),i.lc("ngIf",null==(n=i.ic(13,9,e.selectedLabel$))?null:n.contentBlocks),i.Db(3),i.lc("markdownText",null==(s=i.ic(16,11,e.selectedLabel$))?null:s.description)}}function ex(e,t){1&e&&(i.Tb(0),i.Qb(1,"app-view-title",29),i.Sb()),2&e&&(i.Db(1),i.lc("menuEnabled",!1))}function tx(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",35),i.cc("click",(function(){return i.xc(e),i.gc(3).handleExitQuiz()})),i.Qb(1,"app-icon",36),i.Ub()}}function nx(e,t){if(1&e&&(i.Vb(0,"span",37),i.Vb(1,"span",38),i.Kc(2),i.hc(3,"async"),i.Ub(),i.Kc(4),i.hc(5,"async"),i.Ub()),2&e){const e=i.gc(3);i.Db(2),i.Mc("Question ",i.ic(3,2,e.activeQuestionIndex$)+1,""),i.Db(2),i.Mc(" of ",i.ic(5,4,e.questionTotal$)," ")}}function ix(e,t){if(1&e&&(i.Tb(0),i.Vb(1,"div",30),i.Ic(2,tx,2,0,"button",31),i.hc(3,"async"),i.Ub(),i.Vb(4,"div",13),i.Vb(5,"div",32),i.Vb(6,"span",33),i.Kc(7,"Quiz"),i.Ub(),i.Ic(8,nx,6,6,"span",34),i.hc(9,"async"),i.hc(10,"async"),i.Ub(),i.Ub(),i.Sb()),2&e){const e=i.gc(2);let t=null;i.Db(2),i.lc("ngIf",!i.ic(3,2,e.quizLocked$)),i.Db(6),i.lc("ngIf",(null==(t=i.ic(9,4,e.quizSettings$))?null:t.showProgress)&&i.ic(10,6,e.questionRemaining$)>0)}}function sx(e,t){1&e&&i.Qb(0,"app-icon",21)}function ox(e,t){1&e&&i.Qb(0,"app-icon",22)}function rx(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",39),i.cc("click",(function(){return i.xc(e),i.gc(2).handleToggleClick()})),i.Ic(1,sx,1,0,"app-icon",16),i.Ic(2,ox,1,0,"app-icon",17),i.Ub()}if(2&e){const e=i.gc(2);i.Eb("aria-expanded",e.open)("aria-label",e.open?"Close Info Panel":"Open Info Panel"),i.Db(1),i.lc("ngIf",!e.open),i.Db(1),i.lc("ngIf",e.open)}}function ax(e,t){1&e&&i.Qb(0,"app-view-content-mode",41)}function cx(e,t){if(1&e&&(i.Tb(0),i.Ic(1,ax,1,0,"app-view-content-mode",40),i.Sb()),2&e){const e=i.gc(2);i.Db(1),i.lc("ngIf",e.expandable)}}function lx(e,t){1&e&&i.Qb(0,"app-view-quiz",42),2&e&&i.lc("showHeader",!1)}function px(e,t){if(1&e&&(i.Tb(0),i.Vb(1,"article",9),i.Ic(2,ex,2,1,"ng-container",25),i.hc(3,"async"),i.Ic(4,ix,11,8,"ng-container",25),i.hc(5,"async"),i.Vb(6,"div",26),i.Ic(7,rx,3,4,"button",27),i.Ub(),i.Ub(),i.Vb(8,"div",19),i.Ic(9,cx,2,1,"ng-container",25),i.hc(10,"async"),i.Ic(11,lx,1,1,"app-view-quiz",28),i.hc(12,"async"),i.Ub(),i.Sb()),2&e){const e=i.gc();i.Db(2),i.lc("ngIf",!i.ic(3,5,e.quizModeActive$)),i.Db(2),i.lc("ngIf",i.ic(5,7,e.quizModeActive$)),i.Db(3),i.lc("ngIf",e.expandable),i.Db(2),i.lc("ngIf",!i.ic(10,9,e.quizModeActive$)),i.Db(2),i.lc("ngIf",i.ic(12,11,e.quizModeActive$))}}const dx=function(e,t,n,i){return{"view-drawer--closed":e,"view-drawer--active":t,"view-drawer--scrollable":n,"view-drawer--fixed":i}};let ux=(()=>{class e{constructor(e,t,n,s,o,r){this.renderer=e,this.changeDetectorRef=t,this.viewService=n,this.quizService=s,this.store=o,this.layoutService=r,this.offsetYChange=new i.p,this.breakpoints={minimumDrawer:{velocity:1/0,point:0},halfDrawer:{velocity:1,point:0}},this.ngUnsubscribe=new k.a,this.viewMode=Da,this.viewToolsMode=Fg,this.mode=Da.Content,this.open=!1}get expandable(){return"full"===this.layoutService.getVisibleContent()||this.mode===Da.LabelInfo||this.mode===Da.NodeInfo||this.open}ngOnInit(){this.initWindowSizeObserver(),this.initLayoutObserver(),this.initQuizObserver()}ngAfterViewInit(){this.refresh(this.store.selectSnapshot(mr.getUI).drawer.isExpandedInitially)}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initWindowSizeObserver(){Object(Ts.a)(Object(Uo.a)(window,"resize"),Object(Uo.a)(window,"orientationchange")).pipe(Object(ka.a)(0),Object(M.a)(this.ngUnsubscribe)).subscribe(()=>{this.refresh(!1)})}initLayoutObserver(){this.layout$.pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.updateMode(e)})}initQuizObserver(){const e=this.selectedChapterReady$.pipe(Object(F.a)(e=>e&&e.model),Object(I.a)(e=>e),Object(El.a)(300));Object(Ta.b)([e,this.quizModeActive$]).pipe(Object(I.a)(([e,t])=>e&&t),Object(M.a)(this.ngUnsubscribe)).subscribe(()=>{setTimeout(()=>{this.toggleDrawer(!0),this.changeDetectorRef.markForCheck()})})}updateViewHeight(){const e=c.application!==s.Viewer,t=pl(this.store.selectSnapshot(ll.getSiteHeader),e);this.viewDrawer.nativeElement.style.setProperty("--vh",t+"px")}updateStops(){const e=window.innerHeight,t=this.store.selectSnapshot(ll.getSiteHeader)===ol.Hide?0:56;this.breakpoints.minimumDrawer.point=-64,this.breakpoints.halfDrawer.point=Math.floor(-.5*(e-t))}updateMode(e){this.mode=this.viewService.inferDrawerMode(e),this.changeDetectorRef.markForCheck()}resetDrawerPosition(e){setTimeout(()=>{this.slideDrawerToPoint(e?this.breakpoints.halfDrawer.point:this.breakpoints.minimumDrawer.point),this.open=e,this.changeDetectorRef.markForCheck()})}refresh(e){setTimeout(()=>{this.updateViewHeight(),this.updateStops(),this.resetDrawerPosition(e)})}handleToggleClick(){this.expandable&&this.toggleDrawer()}handleDrawerKeydown(e){"ArrowDown"!==e.key&&"ArrowUp"!==e.key||e.stopPropagation()}handleLabelBack(){this.viewService.clearSelectedLabel()}toggleDrawer(e){null==e&&(e=!this.open),this.slideDrawerToPoint((e?this.breakpoints.halfDrawer:this.breakpoints.minimumDrawer).point),this.open=e}handleExitQuiz(){this.quizService.exitQuiz()}slideDrawerToPoint(e){this.renderer.setStyle(this.viewDrawer.nativeElement,"transform",`translate3d(0, ${e}px, 0)`),this.offsetYChange.emit(e)}getDrawerY(){if(this.viewDrawer){const e=this.viewService.getComputedTransform(this.viewDrawer.nativeElement);return e?e.y:null}return null}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(i.H),i.Pb(i.i),i.Pb(Dl),i.Pb(Ag),i.Pb(d.g),i.Pb(rc))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-drawer"]],viewQuery:function(e,t){if(1&e&&(i.Pc(Wy,!0),i.Pc(Ky,!0)),2&e){let e;i.sc(e=i.dc())&&(t.viewDrawer=e.first),i.sc(e=i.dc())&&(t.viewDrawerOuter=e.first)}},inputs:{expandable:"expandable"},outputs:{offsetYChange:"offsetYChange"},decls:9,vars:13,consts:[[1,"view-drawer",3,"ngClass"],["viewDrawer",""],["class","view-drawer__scrim",4,"ngIf"],["role","region","aria-label","Chapter Description",1,"view-drawer__outer",3,"keydown"],["viewDrawerOuter",""],[1,"view-drawer__inner",3,"ngSwitch"],[4,"ngSwitchCase"],[1,"view-drawer__scrim"],["size","large",3,"label"],[1,"view-drawer__header",2,"height","64px"],[1,"view-drawer__button","view-drawer__button--left"],["app-pin-button","","buttonType","outline",3,"click"],["icon","arrow-left"],[1,"view-drawer__title"],[1,"text-semibold","text-14",3,"markdownText"],[1,"view-drawer__button","view-drawer__button--right"],["icon","caret-up",4,"ngIf"],["icon","caret-down",4,"ngIf"],["class","mv-1","appEventFence","",4,"ngIf"],[1,"view-drawer__content"],[1,"text-14",3,"markdownText"],["icon","caret-up"],["icon","caret-down"],["appEventFence","",1,"mv-1"],[3,"contentBlocks","layout"],[4,"ngIf"],["appEventFence","",1,"view-drawer__button","view-drawer__button--right"],["type","button","app-pin-button","","buttonType","outline",3,"click",4,"ngIf"],[3,"showHeader",4,"ngIf"],["alignTitle","center","size","medium",1,"view-drawer__title",3,"menuEnabled"],["appEventFence","",1,"view-drawer__button","view-drawer__button--left"],["app-pin-button","","buttonType","outline","type","button",3,"click",4,"ngIf"],[1,"flex","flex-column","text-center"],[1,"text-11","text-semibold","text-uppercase"],["class","text-14",4,"ngIf"],["app-pin-button","","buttonType","outline","type","button",3,"click"],["icon","times"],[1,"text-14"],[1,"text-semibold"],["type","button","app-pin-button","","buttonType","outline",3,"click"],["layout","drawer",4,"ngIf"],["layout","drawer"],[3,"showHeader"]],template:function(e,t){if(1&e&&(i.Vb(0,"div",0,1),i.Ic(2,Gy,3,3,"div",2),i.hc(3,"async"),i.Vb(4,"div",3,4),i.cc("keydown",(function(e){return t.handleDrawerKeydown(e)})),i.Vb(6,"div",5),i.Ic(7,Yy,17,13,"ng-container",6),i.Ic(8,px,13,13,"ng-container",6),i.Ub(),i.Ub(),i.Ub()),2&e){let e=null;i.lc("ngClass",i.qc(8,dx,!t.open,t.open,t.open,!t.expandable)),i.Db(2),i.lc("ngIf",null==(e=i.ic(3,6,t.scrim$))?null:e.show),i.Db(2),i.Eb("tabindex",t.open?0:-1),i.Db(2),i.lc("ngSwitch",t.mode),i.Db(1),i.lc("ngSwitchCase",t.viewMode.LabelInfo),i.Db(1),i.lc("ngSwitchCase",t.viewMode.Content)}},directives:[Z.i,Z.l,Z.n,Z.o,uu,ou,dl,Zd,dp,Pu,ah,Dh,Qy],pipes:[Z.b],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3535}.text-info{color:#2d72dc}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.view-drawer{border-top:rgba(234,239,245,.8);box-shadow:0 -1px 0 0 rgba(28,42,63,.16);background:hsla(0,0%,100%,.8);left:0;min-height:100vh;right:0;position:absolute;z-index:20;top:100vh;top:calc(var(--vh, 1vh) * 100);transform:translate3d(0,-56px,0);transition:transform .3s}.view-drawer--active,.view-drawer--closed{background-color:#fff}.view-drawer--scrollable{min-height:0}.view-drawer--scrollable .view-drawer__outer{height:50vh;height:calc(var(--vh, 1vh) * 50);overflow-y:scroll}.view-drawer--fixed{height:56px;overflow:hidden}.view-drawer--fixed .view-drawer__inner{height:56px;padding:0 16px}.view-drawer--fixed .view-drawer__content{justify-content:center;padding-top:0}.view-drawer__header{position:relative}.view-drawer__header,.view-drawer__title{height:64px;display:flex;justify-content:center;align-items:center}.view-drawer__title{flex-grow:1;margin:0 64px;padding:0 8px}.view-drawer__button{height:40px;width:40px;display:flex;align-items:center;justify-content:center;position:absolute}.view-drawer__button--left{left:16px}.view-drawer__button--right{right:16px}.view-drawer__inner{position:relative}.view-drawer__outer{outline:none}.view-drawer__content{display:flex;flex:1 1 100%;flex-direction:column;max-width:600px;min-height:56px;margin:0 auto;padding:8px 16px 48px}.view-drawer__scrim{background-color:#fff;position:absolute;display:flex;justify-content:center;align-items:center;z-index:50;left:0;right:0;top:0;bottom:0}"],encapsulation:2,changeDetection:0}),$y([Object(d.d)(mr.getUI),qy("design:type",P.a)],e.prototype,"layout$",void 0),$y([Object(d.d)(mr.getScrim),qy("design:type",P.a)],e.prototype,"scrim$",void 0),$y([Object(d.d)(Or.getSelectedChapterReadyState),qy("design:type",P.a)],e.prototype,"selectedChapterReady$",void 0),$y([Object(d.d)(Or.getSelectedChapterIndex),qy("design:type",P.a)],e.prototype,"chapterIndex$",void 0),$y([Object(d.d)(Or.getChapterCount),qy("design:type",P.a)],e.prototype,"chapterCount$",void 0),$y([Object(d.d)(Ca.getSelectedLabel),qy("design:type",P.a)],e.prototype,"selectedLabel$",void 0),$y([Object(d.d)(xs.getQuizModeActive),qy("design:type",P.a)],e.prototype,"quizModeActive$",void 0),$y([Object(d.d)(xs.getActiveQuestionIndex),qy("design:type",P.a)],e.prototype,"activeQuestionIndex$",void 0),$y([Object(d.d)(xs.getQuestionTotal),qy("design:type",P.a)],e.prototype,"questionTotal$",void 0),$y([Object(d.d)(xs.getQuestionsRemaining),qy("design:type",P.a)],e.prototype,"questionRemaining$",void 0),$y([Object(d.d)(xs.getQuizSettings),qy("design:type",P.a)],e.prototype,"quizSettings$",void 0),$y([Object(d.d)(xs.getQuizModeLocked),qy("design:type",P.a)],e.prototype,"quizLocked$",void 0),e})();var gx=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const hx=["viewColumn"];function bx(e,t){if(1&e&&(i.Vb(0,"div",6),i.Qb(1,"app-spinner",7),i.hc(2,"async"),i.Ub()),2&e){const e=i.gc();let t=null;i.Db(1),i.lc("label",null==(t=i.ic(2,1,e.scrim$))?null:t.label)}}const mx=[[["","view-column-header",""]],"*"],fx=function(e,t,n){return{"view-column--unpadded":e,"view-column--left":t,"view-column--right":n}},yx=["[view-column-header]","*"];let xx=(()=>{class e{constructor(){this.unpadded=!1,this.placement="left"}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-column"]],viewQuery:function(e,t){if(1&e&&i.Pc(hx,!0),2&e){let e;i.sc(e=i.dc())&&(t.viewColumn=e.first)}},inputs:{unpadded:"unpadded",placement:"placement"},ngContentSelectors:yx,decls:9,vars:8,consts:[[1,"view-column",3,"ngClass"],["viewColumn",""],["class","view-column__scrim",4,"ngIf"],[1,"view-column__inner"],[1,"view-column__header"],[1,"view-column__body"],[1,"view-column__scrim"],["size","large",3,"label"]],template:function(e,t){if(1&e&&(i.kc(mx),i.Vb(0,"div",0,1),i.Ic(2,bx,3,3,"div",2),i.hc(3,"async"),i.Vb(4,"article",3),i.Vb(5,"div",4),i.jc(6),i.Ub(),i.Vb(7,"div",5),i.jc(8,1),i.Ub(),i.Ub(),i.Ub()),2&e){let e=null;i.lc("ngClass",i.pc(4,fx,t.unpadded,"left"===t.placement,"right"===t.placement)),i.Db(2),i.lc("ngIf",null==(e=i.ic(3,2,t.scrim$))?null:e.show)}},directives:[Z.i,Z.l,uu],pipes:[Z.b],styles:[".view-column[_ngcontent-%COMP%]{pointer-events:auto;background:#fff;box-shadow:1px -1px 2px 0 rgba(28,42,63,.1),0 1px 2px 0 rgba(28,42,63,.3);color:#131c2a;width:320px;height:100%;position:absolute;z-index:30}.view-column--left[_ngcontent-%COMP%]{left:0}.view-column--right[_ngcontent-%COMP%]{right:0;box-shadow:0 -1px 24px rgba(0,0,0,.4)}.view-column--unpadded[_ngcontent-%COMP%]   .view-column__body[_ngcontent-%COMP%]{padding:0}.view-column__inner[_ngcontent-%COMP%]{background:#fff;border-right:1px solid #eaeff5;display:flex;flex-direction:column;height:100%;width:320px;position:absolute;left:0;z-index:10}.view-column__header[_ngcontent-%COMP%]{flex-shrink:1;background:#fff}.view-column__header[_ngcontent-%COMP%]:empty{display:none}.view-column__body[_ngcontent-%COMP%]{overflow-y:auto;flex-grow:1;height:100%;padding:16px 12px}.view-column__scrim[_ngcontent-%COMP%]{background-color:#fff;position:absolute;display:flex;justify-content:center;align-items:center;z-index:50;left:0;right:0;top:0;bottom:0}"],changeDetection:0}),function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);o>3&&r&&Object.defineProperty(t,n,r)}([Object(d.d)(mr.getScrim),gx("design:type",P.a)],e.prototype,"scrim$",void 0),e})();const vx=["*"];let Ox=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-list-container"],["","app-view-list-container",""]],ngContentSelectors:vx,decls:2,vars:0,consts:[[1,"view-list-container"]],template:function(e,t){1&e&&(i.kc(),i.Vb(0,"div",0),i.jc(1),i.Ub())},styles:[".view-list-container{display:flex;flex-direction:column}"],encapsulation:2,changeDetection:0}),e})();var wx=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},Cx=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const Sx=function(e,t,n,i){return{"view-logo--full-color":e,"view-logo--full-white":t,"view-logo--small-color":n,"view-logo--small-white":i}};function _x(e,t){if(1&e&&(i.Tb(0),i.Qb(1,"a",1),i.Sb()),2&e){const e=i.gc();i.Db(1),i.lc("href","https://www.biodigital.com?utm_source="+(e.isNative?"human_mobile":"human_web")+"&utm_medium=PLG&utm_campaign=poweredby&ref=poweredby",i.Ac)("ngClass",i.qc(3,Sx,"color"===e.logoColor&&"full"===e.logoSize,"white"===e.logoColor&&"full"===e.logoSize,"color"===e.logoColor&&"small"===e.logoSize,"white"===e.logoColor&&"small"===e.logoSize))("gaLabel",e.contentId)}}function jx(e,t){if(1&e&&(i.Tb(0),i.Qb(1,"span",2),i.Sb()),2&e){const e=i.gc();i.Db(1),i.lc("ngClass",i.qc(1,Sx,"color"===e.logoColor&&"full"===e.logoSize,"white"===e.logoColor&&"full"===e.logoSize,"color"===e.logoColor&&"small"===e.logoSize,"white"===e.logoColor&&"small"===e.logoSize))}}let kx=(()=>{class e{constructor(){this.logoSize="full",this.logoColor="color",this.contentId="",this.source="",this.isNative=!1,this.isLight=!0,this.breakpoint=$a,this.ngUnsubscribe=new k.a}ngOnInit(){this.isNative=c.native}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-logo"]],inputs:{logoSize:"logoSize",logoColor:"logoColor",contentId:"contentId"},decls:4,vars:6,consts:[[4,"ngIf"],["target","_blank","title","Powered by BioDigital","aria-label","Powered by BioDigital (opens in a new tab)","data-test","viewLogo","gaCategory","Logo","gaEvent","clicked_powered_by",1,"view-logo",3,"href","ngClass","gaLabel"],["title","Powered by BioDigital",1,"view-logo",3,"ngClass"]],template:function(e,t){if(1&e&&(i.Ic(0,_x,2,8,"ng-container",0),i.hc(1,"async"),i.Ic(2,jx,2,6,"ng-container",0),i.hc(3,"async")),2&e){let e=null,n=null;i.lc("ngIf",null==(e=i.ic(1,2,t.layout$))?null:e.logo.isHyperLink),i.Db(2),i.lc("ngIf",!(null!=(n=i.ic(3,4,t.layout$))&&n.logo.isHyperLink))}},directives:[Z.l,U.a,U.b,Z.i],pipes:[Z.b],styles:["[_nghost-%COMP%]{display:flex;height:52px;align-items:center}.view-logo[_ngcontent-%COMP%]:focus{border-radius:4px;outline:2px solid #2d72dc!important}.view-logo--small-color[_ngcontent-%COMP%]{width:28px;height:44px;background:url(logo-color.svg) 50% no-repeat}.view-logo--full-color[_ngcontent-%COMP%]{width:120px;height:32px;background:url(powered-by-biodigital-color.svg) 50% no-repeat}.view-logo--small-white[_ngcontent-%COMP%]{width:28px;height:44px;background:url(logo-white.svg) 50% no-repeat}.view-logo--full-white[_ngcontent-%COMP%]{width:120px;height:32px;background:url(powered-by-biodigital-white.svg) 50% no-repeat}.view-logo[_ngcontent-%COMP%]:not([hidden]){display:flex}.view-logo[href][_ngcontent-%COMP%]:hover{cursor:pointer}"],changeDetection:0}),wx([Object(d.d)(mr.getUI),Cx("design:type",P.a)],e.prototype,"layout$",void 0),wx([Object(d.d)(Or.getSelectedChapterBackground),Cx("design:type",P.a)],e.prototype,"background$",void 0),wx([Object(d.d)(Ja.getBreakpoint),Cx("design:type",P.a)],e.prototype,"breakpoint$",void 0),e})();const Px=function(e){return{"view-list-item--selected":e}},Mx=["*"];let Ix=(()=>{class e{constructor(){this.selected=!1}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-list-item"],["","app-view-list-item",""]],inputs:{selected:"selected"},ngContentSelectors:Mx,decls:2,vars:3,consts:[[1,"view-list-item",3,"ngClass"]],template:function(e,t){1&e&&(i.kc(),i.Vb(0,"div",0),i.jc(1),i.Ub()),2&e&&i.lc("ngClass",i.nc(1,Px,t.selected))},directives:[Z.i],styles:['.text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3535}.text-info{color:#2d72dc}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.button{font-size:12px;letter-spacing:.3px;line-height:1.4em;align-items:center;background:none;border-color:transparent;border-radius:4px;border-width:0;color:inherit;display:flex;font-family:Inter UI,sans-serif;justify-content:center;margin:0;outline:0 none;padding:0 16px;position:relative;text-align:center;text-decoration:none;transition:background-color .12s;width:100%}.button:not([disabled]):hover{cursor:pointer}.button:focus .button--themed{outline:2px solid #2d72dc!important}.button:after{content:" ";background-color:#283853;border-radius:4px;display:block;position:absolute;left:0;top:0;bottom:0;right:0;opacity:0;z-index:1;transition:opacity .06s}.button:not(.button--disabled):hover:after{opacity:.7}.button__container{position:relative;z-index:2;width:100%}.button--uppercase{text-transform:uppercase}.button--expanded{display:flex;flex:1}.button--xsmall{height:24px;min-width:24px;padding:0 8px;font-size:10px;letter-spacing:.25px;line-height:1.4em}.button--small{height:32px;min-width:32px;padding:0 12px}.button--medium,.button--small{font-size:12px;letter-spacing:.3px;line-height:1.4em}.button--medium{height:36px;min-width:36px;padding:0 16px}.button--large{height:48px;min-width:48px;padding:0 16px;font-size:14px;letter-spacing:.35px;line-height:1.4em}.button--no-border,.button--no-border:after{border-radius:0!important}.button--left{text-align:left}.button--themed{color:#374a68}.button--themed:hover{color:#1c2a3f}.button--themed:after{background-color:#d7e0ea}.button--dark{color:#d7e0ea}.button--dark:hover{color:#fff}.button--dark:after{background-color:#283853}.button--dark.button--flat{background:#374a68}.button--dark.button--default{background:transparent}.button--dark.button--outline{background:transparent;border:1px solid #374a68;transition:border-color .12s}.button--dark.button--outline:hover{border-color:#96a8c0}.button--dark.button--outline:hover:after{background-color:transparent;display:none}.button--dark.button--text{background:transparent;color:#d7e0ea}.button--dark.button--text:hover{color:#fff}.button--dark.button--text:hover:after{display:none}.button--dark.button--selected{background-color:#2d72dc;color:#fff}.button--dark.button--selected:hover:after{display:none}.button--light{color:#283853}.button--light:hover{color:#1c2a3f}.button--light:after{background-color:#96a8c0}.button--light:not(.button--disabled):hover:after{opacity:.6}.button--light.button--flat{background:#d7e0ea;font-weight:500}.button--light.button--flat.button--selected{background-color:#96a8c0}.button--light.button--default{background:transparent;color:#131c2a}.button--light.button--default:not(.button--disabled):hover:after{opacity:.2}.button--light.button--outline{background:transparent;border:1px solid #96a8c0;color:#283853;transition:border-color .12s}.button--light.button--outline:after{display:none}.button--light.button--outline:hover{background:rgba(55,74,104,.05);border-color:#374a68;color:#1c2a3f}.button--light.button--outline:hover:after{background-color:transparent}.button--light.button--selected{background-color:#eaeff5}.button--light.button--selected:hover:after{display:none}.button--light.button--text{color:#283853}.button--light.button--text:hover{color:#1c2a3f}.button--light.button--text:hover:after{display:none}.button--primary{background:#de3535;color:#fff}.button--primary:after{background:#f9fafd}.button--primary:not([disabled]):hover:after{opacity:.1}.button--info{background:#3892dc;color:#fff}.button--info:after{background:#f9fafd}.button--info:hover:after{opacity:.1}.button--selected{background-color:#2d72dc}.button--disabled{opacity:.5}.button--circle{border-radius:50%}.button--circle.button--xsmall{width:24px}.button--circle.button--small{width:32px;padding:0 6px}.button--circle.button--medium{width:36px;padding:0 8px}.button--circle.button--large{width:48px}.button--circle:after{border-radius:50%}.button--rounded,.button--rounded:after{border-radius:18px}[app-view-list-item]{border-color:transparent;background:none;border-width:0;padding:0;outline:none;margin:0;pointer-events:all;display:flex;width:100%}[app-view-list-item]::-moz-focus-inner{border:0}[app-view-list-item]:not([disabled]):hover{cursor:pointer}.view-list-item{font-size:14px;letter-spacing:.35px;line-height:1.4em;display:flex;flex-grow:1;flex-direction:row;padding:12px;border-radius:2px;border-left:4px solid transparent;background-color:transparent;color:#131c2a;transition:background-color 125ms,color 125ms,border 125ms}.view-list-item:hover{cursor:pointer;background:#eaeff5}.view-list-item:focus{outline:2px solid #2d72dc!important}.view-list-item--selected{border-left:4px solid #2d72dc;background-color:#f0f8ff}.view-list-item__index{display:flex;flex:0 0 32px;justify-content:center}.view-list-item__title{word-wrap:break-word;overflow-wrap:break-word;display:flex;flex:1 1 auto;padding-right:4px}.view-list-item__thumb{background-color:#f9fafd;background-size:cover;border-radius:4px;background-repeat:no-repeat;flex:0 0 56px;height:56px;width:56px;transition:border-color .1s}'],encapsulation:2,changeDetection:0}),e})();var zx=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},Tx=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Ux(e,t){if(1&e){const e=i.Wb();i.Vb(0,"div",2),i.cc("click",(function(){return i.xc(e),i.gc().handleCloseClick()})),i.Ub()}}function Dx(e,t){1&e&&(i.Vb(0,"span"),i.Kc(1,"Hide Labels"),i.Ub())}function Lx(e,t){1&e&&(i.Vb(0,"span"),i.Kc(1,"Show Labels"),i.Ub())}function Ex(e,t){if(1&e){const e=i.Wb();i.Vb(0,"app-view-column",3),i.Vb(1,"nav",4),i.Vb(2,"app-view-panel",5),i.Qb(3,"app-view-logo"),i.Ub(),i.Vb(4,"app-view-panel",5),i.Vb(5,"button",6),i.cc("click",(function(){return i.xc(e),i.gc().handleCloseClick()})),i.Kc(6,"Close"),i.Ub(),i.Ub(),i.Vb(7,"app-view-panel",5),i.Vb(8,"button",6),i.cc("click",(function(){return i.xc(e),i.gc().handleToggleToolbar("tools")})),i.Qb(9,"app-icon",7),i.Kc(10," Open Explore Tools "),i.Ub(),i.Vb(11,"button",6),i.cc("click",(function(){return i.xc(e),i.gc().handleToggleToolbar("media")})),i.Qb(12,"app-icon",8),i.Kc(13," Open Media Controls "),i.Ub(),i.Vb(14,"button",6),i.cc("click",(function(){return i.xc(e),i.gc().handleSearchClick()})),i.Qb(15,"app-icon",9),i.Kc(16," Search Anatomy "),i.Ub(),i.Ub(),i.Vb(17,"app-view-panel",5),i.Vb(18,"button",6),i.cc("click",(function(){return i.xc(e),i.gc().handleFullscreenClick()})),i.Qb(19,"app-icon",10),i.Kc(20," Enter Fullscreen "),i.Ub(),i.Ub(),i.Vb(21,"app-view-panel",5),i.Vb(22,"button",6),i.cc("click",(function(){return i.xc(e),i.gc().handleToggleLabelsClick()})),i.Qb(23,"app-icon",11),i.Ic(24,Dx,2,0,"span",12),i.hc(25,"async"),i.Ic(26,Lx,2,0,"span",12),i.hc(27,"async"),i.Ub(),i.Ub(),i.Vb(28,"app-view-panel",5),i.Vb(29,"button",13),i.cc("click",(function(){return i.xc(e),i.gc().handleTutorialClick()})),i.hc(30,"async"),i.Kc(31," Launch Tutorial "),i.Ub(),i.Vb(32,"button",6),i.cc("click",(function(){return i.xc(e),i.gc().handleHelpBasicsClick()})),i.Kc(33,"3D Navigation Basics"),i.Ub(),i.Vb(34,"button",6),i.cc("click",(function(){return i.xc(e),i.gc().handleHelpShortcutsClick()})),i.Kc(35,"Keyboard Shortcuts"),i.Ub(),i.Ub(),i.Ub(),i.Ub()}if(2&e){const e=i.gc();let t=null;i.lc("@slideInOut",void 0),i.Db(2),i.lc("showHeader",!1),i.Db(2),i.lc("showHeader",!1),i.Db(3),i.lc("showHeader",!1),i.Db(10),i.lc("showHeader",!1),i.Db(4),i.lc("showHeader",!1),i.Db(3),i.lc("ngIf",i.ic(25,10,e.showLabels$)),i.Db(2),i.lc("ngIf",!i.ic(27,12,e.showLabels$)),i.Db(2),i.lc("showHeader",!1),i.Db(1),i.lc("disabled",!(null!=(t=i.ic(30,14,e.selectedChapterReady$))&&t.model))}}let Fx=(()=>{class e{constructor(e,t){this.store=e,this.viewService=t}ngOnInit(){}handleCloseClick(){this.store.dispatch(new j.ToggleMenu(!1))}handleToggleLabelsClick(){this.viewService.toggleLabels()}handleFullscreenClick(){this.handleCloseClick(),Io.toggleFullscreen()}handleNewTabClick(){this.handleCloseClick(),this.viewService.openInNewTab()}handleSearchClick(){this.handleCloseClick(),this.viewService.toggleSearch()}handleTutorialClick(){this.handleCloseClick(),this.viewService.toggleTutorial(!0)}handleHelpBasicsClick(){this.handleCloseClick(),this.viewService.toggleHelp(z.Basics)}handleHelpShortcutsClick(){this.handleCloseClick(),this.viewService.toggleHelp(z.Shortcuts)}handleToggleToolbar(e){this.handleCloseClick();const t=this.store.selectSnapshot(mr.getUI);t.media.status=_o.Hide,t.tools.status=_o.Hide,t.toolbar.status=_o.Hide,t[e].status=_o.Show,this.store.dispatch(new j.SetUI(t))}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.g),i.Pb(Dl))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-menu-column"]],decls:4,vars:6,consts:[["class","view-menu-scrim",3,"click",4,"ngIf"],["placement","right","class","view-menu-column",4,"ngIf"],[1,"view-menu-scrim",3,"click"],["placement","right",1,"view-menu-column"],["app-view-list-container",""],["padding","dense",3,"showHeader"],["app-view-list-item","",3,"click"],["icon","pen",1,"mr-3"],["icon","play",1,"mr-3"],["icon","search",1,"mr-3"],["icon","expand",1,"mr-3"],["icon","tag",1,"mr-3"],[4,"ngIf"],["app-view-list-item","",3,"disabled","click"]],template:function(e,t){1&e&&(i.Ic(0,Ux,1,0,"div",0),i.hc(1,"async"),i.Ic(2,Ex,36,16,"app-view-column",1),i.hc(3,"async")),2&e&&(i.lc("ngIf",i.ic(1,2,t.menuOpen$)),i.Db(2),i.lc("ngIf",i.ic(3,4,t.menuOpen$)))},directives:[Z.l,xx,Ox,uh,kx,Ix,dl],pipes:[Z.b],styles:[".view-menu-column[_ngcontent-%COMP%]{position:absolute;top:0;right:0;z-index:10000;height:100%}.view-menu-scrim[_ngcontent-%COMP%]{background:rgba(0,0,0,.2);display:flex;position:fixed;justify-content:center;align-items:center;top:0;bottom:0;left:0;right:0;transition:background-color .25s,opacity .25s;z-index:10000}.view-menu-scrim[_ngcontent-%COMP%]:hover{opacity:1;cursor:pointer;background:rgba(0,0,0,.2)}"],data:{animation:[Object(Zl.n)("slideInOut",[Object(Zl.m)(":enter",[Object(Zl.l)({transform:"translateX(320px)"}),Object(Zl.e)("200ms ease-out",Object(Zl.l)({transform:"*"}))]),Object(Zl.m)(":leave",[Object(Zl.e)("200ms",Object(Zl.l)({transform:"translateX(320px)"}))])])]},changeDetection:0}),zx([Object(d.d)(Or.getSelectedChapterReadyState),Tx("design:type",P.a)],e.prototype,"selectedChapterReady$",void 0),zx([Object(d.d)(mr.getMenuOpen),Tx("design:type",P.a)],e.prototype,"menuOpen$",void 0),zx([Object(d.d)(mr.getCanTouch),Tx("design:type",P.a)],e.prototype,"canTouch$",void 0),zx([Object(d.d)(Er.getShowLabels),Tx("design:type",P.a)],e.prototype,"showLabels$",void 0),e})();var Ax=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},Rx=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Vx(e,t){if(1&e){const e=i.Wb();i.Vb(0,"div",1),i.cc("click",(function(){return i.xc(e),i.gc().handleToggle()}))("keyup.enter",(function(){return i.xc(e),i.gc().handleToggle()})),i.Qb(1,"app-icon",2),i.Ub()}if(2&e){const e=i.gc();i.lc("@show",void 0)("matTooltip",e.isIn?"Open Info Panel":"Close Info Panel"),i.Eb("aria-label",e.isIn?"Open Info Panel":"Close Info Panel")("aria-expanded",!e.isIn),i.Db(1),i.lc("icon",e.isIn?"caret-right":"caret-left")}}let Nx=(()=>{class e{constructor(e,t,n,i){this.viewService=e,this.layoutService=t,this.changeDetectorRef=n,this.store=i,this.ngUnsubscribe=new k.a,this.isIn=!1,this.columnToggleVisible=!1}ngOnInit(){Object(Ta.b)(this.chapter$,this.layout$).pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(([e,t])=>{this.isIn=t.column.status===_o.Collapse,this.columnToggleVisible=this.layoutService.isVisible(Xa.ColumnToggle),this.changeDetectorRef.markForCheck()})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}isVisible(){return this.layoutService.isVisible(Xa.ColumnToggle)}handleToggle(){this.viewService.toggleColumn(),this.viewService.toggleSearch(null,!1),this.viewService.toggleNodeInfo(!1),this.viewService.toggleLabelInfo(!1),this.changeDetectorRef.markForCheck()}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(Dl),i.Pb(rc),i.Pb(i.i),i.Pb(d.g))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-column-toggle"]],decls:1,vars:1,consts:[["class","view-column-toggle","data-test","viewInformationPanel","role","button","tabindex","0","matTooltipPosition","right",3,"matTooltip","click","keyup.enter",4,"ngIf"],["data-test","viewInformationPanel","role","button","tabindex","0","matTooltipPosition","right",1,"view-column-toggle",3,"matTooltip","click","keyup.enter"],[3,"icon"]],template:function(e,t){1&e&&i.Ic(0,Vx,2,5,"div",0),2&e&&i.lc("ngIf",t.columnToggleVisible)},directives:[Z.l,ru.c,dl],styles:[".view-column-toggle{color:#131c2a;background:hsla(0,0%,100%,.8);box-shadow:1px -1px 2px 0 rgba(28,42,63,.1),0 1px 2px 0 rgba(28,42,63,.3);border-radius:0 4px 4px 0;display:flex;justify-content:center;align-items:center;width:24px;height:48px}.view-column-toggle:hover{background-color:#eaeff5;cursor:pointer}"],encapsulation:2,data:{animation:[Object(Zl.n)("show",[Object(Zl.m)(":enter",[Object(Zl.l)({opacity:0,transform:"translateX(-32px)"}),Object(Zl.e)("300ms ease-in-out",Object(Zl.l)({opacity:1,transform:"*"}))]),Object(Zl.m)(":leave",[Object(Zl.e)("300ms ease-in-out",Object(Zl.l)({transform:"translateX(-32px)",opacity:0}))])])]},changeDetection:0}),Ax([Object(d.d)(mr.getUI),Rx("design:type",P.a)],e.prototype,"layout$",void 0),Ax([Object(d.d)(Or.getSelectedChapter),Rx("design:type",P.a)],e.prototype,"chapter$",void 0),e})();var Bx,Hx;function Qx(e,t){if(1&e&&(i.Vb(0,"div",7),i.Vb(1,"div",8),i.Qb(2,"app-icon",9),i.Ub(),i.Ub()),2&e){const e=i.gc(2);i.Db(2),i.lc("icon",e.icon)}}function $x(e,t){if(1&e&&(i.Vb(0,"h3",10),i.Kc(1),i.Ub()),2&e){const e=i.gc(2);i.Db(1),i.Lc(e.title)}}function qx(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",11),i.cc("click",(function(){return i.xc(e),i.gc(2).handleDismissClicked()})),i.Qb(1,"app-icon",12),i.Ub()}}function Wx(e,t){if(1&e&&(i.Vb(0,"div",1),i.Vb(1,"div",2),i.Ic(2,Qx,3,1,"div",3),i.Vb(3,"div",4),i.Ic(4,$x,2,1,"h3",5),i.Vb(5,"p"),i.jc(6),i.Ub(),i.Ub(),i.Ub(),i.Ic(7,qx,2,0,"button",6),i.Ub()),2&e){const e=i.gc();i.Hb("toggle--message","message"===e.type)("toggle--error","error"===e.type)("toggle--notification","notification"===e.type)("toggle--warning","warning"===e.type)("toggle--rounded","rounded"===e.toggleStyle)("toggle--light","light"===e.theme)("toggle--dark","dark"===e.theme)("toggle--left","left"===e.toggleAlign)("toggle--center","center"===e.toggleAlign),i.lc("@show",void 0),i.Db(2),i.lc("ngIf",e.icon),i.Db(2),i.lc("ngIf",e.title),i.Db(3),i.lc("ngIf",e.dismiss)}}(Hx=Bx||(Bx={})).slideTransition=Object(Zl.g)([Object(Zl.l)({transform:"translateY({{ from }}%)",opacity:0}),Object(Zl.e)("{{ duration }}ms ease-out",Object(Zl.l)({transform:"translateY({{ to }})",opacity:1}))]),Hx.fadeIn=Object(Zl.g)([Object(Zl.l)({opacity:0}),Object(Zl.e)("{{ duration }}ms ease-out",Object(Zl.l)({opacity:1}))]),Hx.fadeOut=Object(Zl.g)([Object(Zl.l)({opacity:"*"}),Object(Zl.e)("{{ duration }}ms ease-in",Object(Zl.l)({opacity:0}))]);const Kx=["*"];let Gx=(()=>{class e{constructor(e){this.changeRef=e,this.type="message",this.theme="light",this.toggleAlign="left",this.showDelay=0,this.hideDelay=5e3,this.dismiss=!1,this.toggleStyle="rounded",this.handleDismiss=new k.a,this._shown=!0,this.shownSubject=new k.a,this.ngUnsubscribe=new k.a}get shown(){return this._shown}set shown(e){this._shown!==e&&(this._shown=e,this.shownSubject.next(e),this.changeRef.markForCheck())}ngOnInit(){this.initViewShownListeners()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}handleDismissClicked(){this.handleDismiss.next()}initViewShownListeners(){this.shownSubject.pipe(Object(I.a)(()=>this.hideDelay>0),Object(El.a)(this.hideDelay),Object(I.a)(e=>e),Object(M.a)(this.ngUnsubscribe)).subscribe(()=>{this._shown=!1,this.changeRef.markForCheck()})}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(i.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-message-toggle"]],inputs:{type:"type",theme:"theme",toggleAlign:"toggleAlign",icon:"icon",title:"title",showDelay:"showDelay",hideDelay:"hideDelay",dismiss:"dismiss",toggleStyle:"toggleStyle",shown:"shown"},outputs:{handleDismiss:"handleDismiss"},ngContentSelectors:Kx,decls:1,vars:1,consts:[["class","toggle flex flex-row items-start justify-between",3,"toggle--message","toggle--error","toggle--notification","toggle--warning","toggle--rounded","toggle--light","toggle--dark","toggle--left","toggle--center",4,"ngIf"],[1,"toggle","flex","flex-row","items-start","justify-between"],[1,"toggle__wrapper","flex","flex-row","flex-auto"],["class","mr-3",4,"ngIf"],[1,"toggle__content"],["class","text-semibold mb-1",4,"ngIf"],["class","toggle__icon toggle__dismiss",3,"click",4,"ngIf"],[1,"mr-3"],[1,"toggle__icon"],[3,"icon"],[1,"text-semibold","mb-1"],[1,"toggle__icon","toggle__dismiss",3,"click"],["icon","times"]],template:function(e,t){1&e&&(i.kc(),i.Ic(0,Wx,8,22,"div",0)),2&e&&i.lc("ngIf",t.shown)},directives:[Z.l,dl],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3535}.text-info{color:#2d72dc}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}:root{--message-toggle-color:#1c2a3f;--message-toggle-background-color:#f0f8ff;--message-toggle-icon-color:#2d72dc}.toggle{padding:16px;box-sizing:border-box;font-size:13px;line-height:20px;color:var(--message-toggle-color);background-color:var(--message-toggle-background-color)}.toggle--rounded{border-radius:4px}.toggle__icon{display:flex;flex-direction:column;align-items:center;justify-content:center;margin-top:1px;color:#fff;font-size:16px;background:none;border:none;color:var(--message-toggle-icon-color)}.toggle__content{padding:0 2px;word-break:break-word}.toggle__dismiss{font-size:14px;color:var(--message-toggle-color)}.toggle--left .toggle__content{flex:1 1 auto}.toggle--center .toggle__wrapper{justify-content:center}.toggle.toggle--message{--message-toggle-color:#1c2a3f;--message-toggle-background-color:#f0fff0;--message-toggle-icon-color:#33cd54}.toggle.toggle--notification{--message-toggle-color:#1c2a3f;--message-toggle-background-color:#f0f8ff;--message-toggle-icon-color:#2d72dc}.toggle.toggle--warning{--message-toggle-color:#1c2a3f;--message-toggle-background-color:#fffcf0;--message-toggle-icon-color:#ffb92e}.toggle.toggle--error{--message-toggle-color:#1c2a3f;--message-toggle-background-color:#fff3f0;--message-toggle-icon-color:#f44336}.toggle--dark.toggle--message{--message-toggle-background-color:#e3ffe5}.toggle--dark.toggle--notification{--message-toggle-background-color:#d6ecff}.toggle--dark.toggle--warning{--message-toggle-background-color:#fff6d1}.toggle--dark.toggle--error{--message-toggle-background-color:#ffe2db}"],encapsulation:2,data:{animation:[Object(Zl.n)("show",[Object(Zl.m)(":enter",[Object(Zl.o)(Bx.fadeIn,{params:{duration:300}})]),Object(Zl.m)(":leave",[Object(Zl.o)(Bx.fadeOut,{params:{duration:300}})])])]},changeDetection:0}),e})();function Zx(e,t){if(1&e){const e=i.Wb();i.Vb(0,"div",1),i.Vb(1,"app-message-toggle",2),i.cc("handleDismiss",(function(){return i.xc(e),i.gc().handleDismiss()})),i.Vb(2,"div"),i.Kc(3," This model appears to be performing slowly on your device. For an optimal experience, please switch to a different device or try another model. "),i.Ub(),i.Ub(),i.Ub()}2&e&&(i.Db(1),i.lc("dismiss",!0))}const Jx=[];let Xx,Yx,ev=(()=>{class e{constructor(e,t){this.storageService=e,this.changeRef=t,this.shown=!1,this.sampling=!1}ngOnInit(){this.storageService.getLocalItem(ir.Iphone12Warning)||this.testDevices()}ngOnDestroy(){this.sampling=!1}testDevices(){const e=window.matchMedia("only screen and (device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3)"),t=window.matchMedia("only screen and (device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3)"),n=window.matchMedia("only screen and (device-width: 820px) and (device-height: 1180px) and (-webkit-device-pixel-ratio: 2)"),i=e.matches||t.matches||n.matches,s=/iPhone|iPad/.test(navigator.userAgent),o=/OS\s14/.test(navigator.userAgent);i&&s&&o&&this.startFrameSampling()}startFrameSampling(){this.sampling=!0,Xx=0,Yx=Date.now();const e=()=>{this.frame()?(this.shown=!0,this.changeRef.markForCheck()):this.sampling&&requestAnimationFrame(e)};requestAnimationFrame(e)}frame(){Xx++;const e=Date.now();if(e>=Yx+500){const t=Math.floor(500*Xx/(e-Yx)*2);if(Jx.push(t),Jx.length>3&&Jx.shift(),3===Jx.length&&(Jx[0]+Jx[1]+Jx[2])/3<10)return!0;Yx=e,Xx=0}}handleDismiss(){this.shown=!1,this.changeRef.markForCheck(),this.storageService.setLocalItem(ir.Iphone12Warning,!0)}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(ar),i.Pb(i.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-iphone12-warning"]],decls:1,vars:1,consts:[["class","warning",4,"ngIf"],[1,"warning"],["type","warning","toggleStyle","flat","icon","info-circle",3,"dismiss","handleDismiss"]],template:function(e,t){1&e&&i.Ic(0,Zx,4,1,"div",0),2&e&&i.lc("ngIf",t.shown)},directives:[Z.l,Gx],styles:[".warning[_ngcontent-%COMP%]{position:fixed;top:0;left:0;right:0;z-index:1002}"],changeDetection:0}),e})(),tv=(()=>{class e{constructor(){}supportsWebGl(){const e=document.createElement("canvas"),t=e.getContext("webgl")||e.getContext("experimental-webgl");return t&&t instanceof WebGLRenderingContext}isHoverSupported(){return window.matchMedia("(hover: hover)").matches}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),nv=(()=>{class e{constructor(e,t){this.el=e,this.compatibilityService=t}ngAfterContentInit(){this.compatibilityService.isHoverSupported()&&setTimeout(()=>{this.el.nativeElement.focus()},0)}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(i.m),i.Pb(tv))},e.\u0275dir=i.Kb({type:e,selectors:[["input","appAutoFocus",""]]}),e})(),iv=(()=>{class e{constructor(){}onClick(e,t){t.select()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=i.Kb({type:e,selectors:[["","appSelectOnFocus",""]],hostBindings:function(e,t){1&e&&i.cc("click",(function(e){return t.onClick(e,e.target)}))}}),e})();var sv=n("C9yA");class ov{}class rv{}var av,cv=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},lv=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const pv={currentRecipe:Qi,brushMode:function(e){return e[e.Modify=0]="Modify",e[e.Replace=1]="Replace",e}({}).Replace,storyRecipes:{},recentRecipes:[],uniqueStoryRecipes:[],palettes:[]};let dv=(()=>{let e=av=class{constructor(e){this.storageService=e}static getCurrentRecipe(e){return e.currentRecipe}static getCurrentRecipeForEngine(e){return Fi.toEngine(e.currentRecipe)}static getPaintBrushMode(e){return e.brushMode}static getRecentRecipes(e){return e.recentRecipes}static getStoryRecipes(e){return e.storyRecipes}static getUniqueStoryRecipes(e){return e.uniqueStoryRecipes}static getPalettes(e){return e.palettes}static getCurrentChapterRecipes(e,t){return e.storyRecipes[t.selectedChapter]}static getChapterRecipes(e){return Object(d.h)([av],t=>t.storyRecipes[e])}setCurrentRecipe(e,{colorRecipe:t}){e.patchState({currentRecipe:t})}setBrushMode(e,t){e.patchState({brushMode:t.brushMode})}clearCurrentRecipe(e,t){e.patchState({currentRecipe:null})}resetPaint(e,t){e.setState(pv)}addRecentRecipe(e,t){let n=e.getState().recentRecipes;n.some(e=>qi.isEqual(e,t.recipe))||(n.splice(0,0,t.recipe),n.length>14&&(n=n.slice(0,14)),this.storageService.setLocalItem(ir.RecentRecipes,n),e.patchState({recentRecipes:[...n]}))}setRecentRecipes(e,t){const n=Object(D.isNil)(t.recipes)?[]:[...t.recipes];e.patchState({recentRecipes:n}),this.storageService.setLocalItem(ir.RecentRecipes,n)}setStoryRecipesForChapter(e,t){const n=qi.generateUniqueRecipes([...t.recipes]),i=e.getState().storyRecipes;i[t.chapterId]=Object(D.isNil)(n)?[]:[...n],e.patchState({storyRecipes:i});let s=Object.values(i).reduce((e,t)=>[...e,...t],[]);s=qi.generateUniqueRecipes(s),s.sort(qi.compare),e.patchState({uniqueStoryRecipes:s})}resetStoryRecipes(e,t){e.patchState({storyRecipes:{}})}addPalette(e,t){t.palette.id=yi.idWithPrefix("palette");const n=[...e.getState().palettes,t.palette];e.dispatch(new Np(n))}updatePalette(e,t){const n=e.getState().palettes,i=n.findIndex(e=>e.id===t.palette.id);i>=0&&(n[i]=Object.assign({},t.palette)),e.dispatch(new Np(n))}removePalette(e,t){const n=[...e.getState().palettes.filter(e=>e.id!==t.paletteId)];e.dispatch(new Np(n))}setPalettes(e,t){const n=Object(D.cloneDeep)(t.palettes?[...t.palettes]:[]);e.patchState({palettes:n}),localStorage.setItem(ir.PaintPalettes,JSON.stringify(n))}addRecipeToPalette(e,t){const n=e.getState().palettes,i=n.findIndex(e=>e.id===t.paletteId);i>=0&&n[i].recipes.push(t.recipe),e.dispatch(new Np(n))}togglePalette(e,t){const n=e.getState().palettes,i=n.findIndex(e=>e.id===t.paletteId);i>=0&&(n[i].open=Object(D.isNil)(t.open)?!n[i].open:t.open,e.dispatch(new Np(n)))}ngxsOnInit(e){}};return e.\u0275fac=function(t){return new(t||e)(i.Zb(ar))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac}),cv([Object(d.a)(Ip),lv("design:type",Function),lv("design:paramtypes",[Object,Ip]),lv("design:returntype",void 0)],e.prototype,"setCurrentRecipe",null),cv([Object(d.a)(zp),lv("design:type",Function),lv("design:paramtypes",[Object,zp]),lv("design:returntype",void 0)],e.prototype,"setBrushMode",null),cv([Object(d.a)(Tp),lv("design:type",Function),lv("design:paramtypes",[Object,Tp]),lv("design:returntype",void 0)],e.prototype,"clearCurrentRecipe",null),cv([Object(d.a)(Up),lv("design:type",Function),lv("design:paramtypes",[Object,Up]),lv("design:returntype",void 0)],e.prototype,"resetPaint",null),cv([Object(d.a)(Dp),lv("design:type",Function),lv("design:paramtypes",[Object,Dp]),lv("design:returntype",void 0)],e.prototype,"addRecentRecipe",null),cv([Object(d.a)(Lp),lv("design:type",Function),lv("design:paramtypes",[Object,Lp]),lv("design:returntype",void 0)],e.prototype,"setRecentRecipes",null),cv([Object(d.a)(Fp),lv("design:type",Function),lv("design:paramtypes",[Object,Fp]),lv("design:returntype",void 0)],e.prototype,"setStoryRecipesForChapter",null),cv([Object(d.a)(Ep),lv("design:type",Function),lv("design:paramtypes",[Object,Ep]),lv("design:returntype",void 0)],e.prototype,"resetStoryRecipes",null),cv([Object(d.a)(Ap),lv("design:type",Function),lv("design:paramtypes",[Object,Ap]),lv("design:returntype",void 0)],e.prototype,"addPalette",null),cv([Object(d.a)(Vp),lv("design:type",Function),lv("design:paramtypes",[Object,Vp]),lv("design:returntype",void 0)],e.prototype,"updatePalette",null),cv([Object(d.a)(Rp),lv("design:type",Function),lv("design:paramtypes",[Object,Rp]),lv("design:returntype",void 0)],e.prototype,"removePalette",null),cv([Object(d.a)(Np),lv("design:type",Function),lv("design:paramtypes",[Object,Np]),lv("design:returntype",void 0)],e.prototype,"setPalettes",null),cv([Object(d.a)(Bp),lv("design:type",Function),lv("design:paramtypes",[Object,Bp]),lv("design:returntype",void 0)],e.prototype,"addRecipeToPalette",null),cv([Object(d.a)(Hp),lv("design:type",Function),lv("design:paramtypes",[Object,Hp]),lv("design:returntype",void 0)],e.prototype,"togglePalette",null),cv([Object(d.e)(),lv("design:type",Function),lv("design:paramtypes",[rv]),lv("design:returntype",void 0)],e,"getCurrentRecipe",null),cv([Object(d.e)(),lv("design:type",Function),lv("design:paramtypes",[rv]),lv("design:returntype",void 0)],e,"getCurrentRecipeForEngine",null),cv([Object(d.e)(),lv("design:type",Function),lv("design:paramtypes",[rv]),lv("design:returntype",void 0)],e,"getPaintBrushMode",null),cv([Object(d.e)(),lv("design:type",Function),lv("design:paramtypes",[rv]),lv("design:returntype",void 0)],e,"getRecentRecipes",null),cv([Object(d.e)(),lv("design:type",Function),lv("design:paramtypes",[rv]),lv("design:returntype",void 0)],e,"getStoryRecipes",null),cv([Object(d.e)(),lv("design:type",Function),lv("design:paramtypes",[rv]),lv("design:returntype",void 0)],e,"getUniqueStoryRecipes",null),cv([Object(d.e)(),lv("design:type",Function),lv("design:paramtypes",[rv]),lv("design:returntype",void 0)],e,"getPalettes",null),cv([Object(d.e)([Or]),lv("design:type",Function),lv("design:paramtypes",[rv,On]),lv("design:returntype",void 0)],e,"getCurrentChapterRecipes",null),e=av=cv([Object(d.f)({name:"editPaint",defaults:pv})],e),e})();class uv{constructor(e,t,n){this.label=e,this.width=t,this.height=n}}const gv=new uv("Don't Resize",-1,-1);new uv("Common (Mobile)",360,640),new uv("Common (Minimum)",300,300),new uv("Common (Publish Default)",700,550),new uv("iPhone X",375,812),new uv("iPad (Portrait)",768,1024),new uv("iPad (Landscape)",1024,768);var hv=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},bv=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const mv={view:nd.Chapter,showColumns:!0,showLeftColumn:!0,showRightColumn:!0,showHeader:!0,showFooter:!0,showTimelineEditor:!1,autoCapture:c.application!==s.Loft,record:!0,layerOrderMode:!1,showTreeNodeIds:!1,showRootNodes:!1,canvasSize:gv,canvasSettings:{emulateDrawer:!0,emulateColumn:!0}};let fv=(()=>{let e=class{constructor(e){this.storageService=e}static getView(e){return e.view}static getShowColumns(e){return e.showColumns}static getShowLeftColumn(e){return e.showLeftColumn}static getShowRightColumn(e){return e.showRightColumn}static getShowHeader(e){return e.showHeader}static getShowFooter(e){return e.showFooter}static getShowTimelineEditor(e){return e.showTimelineEditor}static getRecord(e){return e.record}static getLayerOrderMode(e){return e.layerOrderMode}static getShowTreeNodeIds(e){return e.showTreeNodeIds}static getCanvasSize(e){return e.canvasSize}static getCanvasSettings(e){return e.canvasSettings}static getAutoCapture(e){return e.autoCapture}static getShowRootNodes(e){return e.showRootNodes}SetLayerOrderMode(e,t){e.patchState({layerOrderMode:t.layerOrderMode})}ShowTreeNodeIds(e,t){const n=null!=t.show?t.show:!e.getState().showTreeNodeIds;e.patchState({showTreeNodeIds:n})}showRootNodes(e,t){e.patchState({showRootNodes:t.show})}setView(e,t){e.patchState({view:t.view})}nextView(e,t){const{view:n}=e.getState(),i=Object.values(nd),s=i[i.indexOf(n)+1]||i[0];e.patchState({view:s})}previousView(e,t){const{view:n}=e.getState(),i=Object.values(nd),s=i[i.indexOf(n)-1]||i[i.length-1];e.patchState({view:s})}showColumns(e,t){e.patchState({showColumns:t.show})}showColumn(e,t){switch(t.column){case"left":e.patchState({showLeftColumn:t.show});break;case"right":e.patchState({showRightColumn:t.show});break;case"header":e.patchState({showHeader:t.show});break;case"footer":e.patchState({showFooter:t.show})}}showTimelineEditor(e,t){e.patchState({showTimelineEditor:t.show})}resetEditPage(e,t){e.setState(mv),e.dispatch(new Up)}setCanvasSize(e,t){e.patchState({canvasSize:t.size})}autoCapture(e,t){e.patchState({autoCapture:t.enable}),c.application===s.Studio&&this.storageService.setLocalItem(ir.AutoCapture,t.enable)}ngxsOnInit(e){setTimeout(()=>{this.initAutoCapture(e)})}initAutoCapture(e){if(c.application===s.Studio){const t=this.storageService.getLocalJSON(ir.AutoCapture);"boolean"==typeof t&&e.patchState({autoCapture:t})}}};return e.\u0275fac=function(t){return new(t||e)(i.Zb(ar))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac}),hv([Object(d.a)(Jp),bv("design:type",Function),bv("design:paramtypes",[Object,Jp]),bv("design:returntype",void 0)],e.prototype,"SetLayerOrderMode",null),hv([Object(d.a)(Xp),bv("design:type",Function),bv("design:paramtypes",[Object,Xp]),bv("design:returntype",void 0)],e.prototype,"ShowTreeNodeIds",null),hv([Object(d.a)(Yp),bv("design:type",Function),bv("design:paramtypes",[Object,Yp]),bv("design:returntype",void 0)],e.prototype,"showRootNodes",null),hv([Object(d.a)(Qp),bv("design:type",Function),bv("design:paramtypes",[Object,Qp]),bv("design:returntype",void 0)],e.prototype,"setView",null),hv([Object(d.a)($p),bv("design:type",Function),bv("design:paramtypes",[Object,$p]),bv("design:returntype",void 0)],e.prototype,"nextView",null),hv([Object(d.a)(qp),bv("design:type",Function),bv("design:paramtypes",[Object,$p]),bv("design:returntype",void 0)],e.prototype,"previousView",null),hv([Object(d.a)(Wp),bv("design:type",Function),bv("design:paramtypes",[Object,Wp]),bv("design:returntype",void 0)],e.prototype,"showColumns",null),hv([Object(d.a)(Kp),bv("design:type",Function),bv("design:paramtypes",[Object,Kp]),bv("design:returntype",void 0)],e.prototype,"showColumn",null),hv([Object(d.a)(Gp),bv("design:type",Function),bv("design:paramtypes",[Object,Gp]),bv("design:returntype",void 0)],e.prototype,"showTimelineEditor",null),hv([Object(d.a)(Zp),bv("design:type",Function),bv("design:paramtypes",[Object,Zp]),bv("design:returntype",void 0)],e.prototype,"resetEditPage",null),hv([Object(d.a)(ed),bv("design:type",Function),bv("design:paramtypes",[Object,ed]),bv("design:returntype",void 0)],e.prototype,"setCanvasSize",null),hv([Object(d.a)(td),bv("design:type",Function),bv("design:paramtypes",[Object,td]),bv("design:returntype",void 0)],e.prototype,"autoCapture",null),hv([Object(d.e)(),bv("design:type",Function),bv("design:paramtypes",[ov]),bv("design:returntype",void 0)],e,"getView",null),hv([Object(d.e)(),bv("design:type",Function),bv("design:paramtypes",[ov]),bv("design:returntype",void 0)],e,"getShowColumns",null),hv([Object(d.e)(),bv("design:type",Function),bv("design:paramtypes",[ov]),bv("design:returntype",void 0)],e,"getShowLeftColumn",null),hv([Object(d.e)(),bv("design:type",Function),bv("design:paramtypes",[ov]),bv("design:returntype",void 0)],e,"getShowRightColumn",null),hv([Object(d.e)(),bv("design:type",Function),bv("design:paramtypes",[ov]),bv("design:returntype",void 0)],e,"getShowHeader",null),hv([Object(d.e)(),bv("design:type",Function),bv("design:paramtypes",[ov]),bv("design:returntype",void 0)],e,"getShowFooter",null),hv([Object(d.e)(),bv("design:type",Function),bv("design:paramtypes",[ov]),bv("design:returntype",void 0)],e,"getShowTimelineEditor",null),hv([Object(d.e)(),bv("design:type",Function),bv("design:paramtypes",[ov]),bv("design:returntype",void 0)],e,"getRecord",null),hv([Object(d.e)(),bv("design:type",Function),bv("design:paramtypes",[ov]),bv("design:returntype",void 0)],e,"getLayerOrderMode",null),hv([Object(d.e)(),bv("design:type",Function),bv("design:paramtypes",[ov]),bv("design:returntype",void 0)],e,"getShowTreeNodeIds",null),hv([Object(d.e)(),bv("design:type",Function),bv("design:paramtypes",[ov]),bv("design:returntype",void 0)],e,"getCanvasSize",null),hv([Object(d.e)(),bv("design:type",Function),bv("design:paramtypes",[ov]),bv("design:returntype",void 0)],e,"getCanvasSettings",null),hv([Object(d.e)(),bv("design:type",Function),bv("design:paramtypes",[ov]),bv("design:returntype",void 0)],e,"getAutoCapture",null),hv([Object(d.e)(),bv("design:type",Function),bv("design:paramtypes",[ov]),bv("design:returntype",void 0)],e,"getShowRootNodes",null),e=hv([Object(d.f)({name:"edit",defaults:mv,children:[dv]})],e),e})();var yv=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},xv=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function vv(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",9),i.cc("click",(function(){i.xc(e);const t=i.gc();return t.handleExpandClick(t.node,t.node.boolState.expanded)})),i.Qb(1,"app-icon",10),i.Ub()}if(2&e){const e=i.gc();i.lc("buttonTheme",e.theme),i.Eb("aria-label",e.node.boolState.expanded?"Collapse "+e.node.label:"Expand "+e.node.label)("aria-expanded",e.node.boolState.expanded),i.Db(1),i.Hb("rotate-45",e.node.boolState.expanded)}}function Ov(e,t){if(1&e&&(i.Vb(0,"div",16),i.Kc(1),i.Ub()),2&e){const e=i.gc(2);i.Db(1),i.Mc(" ",e.shortId," ")}}const wv=function(e){return{"tree-node__label--padded":e}};function Cv(e,t){if(1&e){const e=i.Wb();i.Vb(0,"div",11),i.cc("dblclick",(function(){return i.xc(e),i.gc().setEditLabelMode(!0)})),i.Vb(1,"div",12),i.Ic(2,Ov,2,1,"div",13),i.hc(3,"async"),i.Vb(4,"div",14),i.Vb(5,"span",15),i.Kc(6,"Select"),i.Ub(),i.Kc(7),i.Ub(),i.Ub(),i.Ub()}if(2&e){const e=i.gc();i.lc("ngClass",i.nc(6,wv,!e.hasChildren&&e.nested)),i.Eb("aria-current",e.checked),i.Db(2),i.lc("ngIf",i.ic(3,4,e.showTreeNodeIds$)),i.Db(5),i.Mc(" ",e.node.label," ")}}function Sv(e,t){if(1&e){const e=i.Wb();i.Vb(0,"input",17),i.cc("blur",(function(t){return i.xc(e),i.gc().handleObjectLabel(t)}))("keyup",(function(t){return i.xc(e),i.gc().handleObjectLabel(t)})),i.Ub()}if(2&e){const e=i.gc();i.lc("value",e.node.label)}}function _v(e,t){if(1&e){const e=i.Wb();i.Vb(0,"input",18),i.cc("change",(function(t){i.xc(e);const n=i.gc();return n.handleLayerOrder(t,n.node)})),i.Ub()}if(2&e){const e=i.gc();i.lc("value",e.node.numState.layer)}}const jv=function(e,t,n,i){return{"tree-node--light":e,"tree-node--hidden":t,"tree-node--selected":n,"tree-node--unpickable":i}};let kv=(()=>{class e{constructor(e,t,n,i,s){this.store=e,this.graphService=t,this.engineService=n,this.router=i,this.changeDetection=s,this.themeEnum=sd,this.isLoft="module"===c.exportType,this.nested=!0,this._theme=sd.Dark,this.checked=!1,this.hasChildren=!1,this.editLabelMode=!1,this.sanitizedID="",this.parentId="",this.shortId="",this.ngUnsubscribe=new k.a}get node(){return this._node}set node(e){this._node=e,this.sanitizedID=this.graphService.sanitizeNodeID(this.node.id),this.checked=this.isNodeChecked(this.node.id);const t=this.node.id.split("-");2===t.length?(this.parentId=t[0],this.shortId=t[1]):(this.shortId=t[0],this.parentId=""),this.shortId=this.shortId.replace(/_/g," "),this.nested&&(this.hasChildren=Dt.getSuccessors(this.graph,this.node.id).length>0),this.changeDetection.markForCheck()}get theme(){return this._theme}set theme(e){this._theme=e}isNodeChecked(e){return this.store.selectSnapshot(Bi.getNodes)[e].checked}isNodeShown(e){return this.store.selectSnapshot(Bi.getNodes)[e].shown}ngOnInit(){this.checkedNodesIds$.pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.checked=e.some(e=>e===this.node.id),this.changeDetection.markForCheck()}),this.labelEditNode$.pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.editLabelMode=e===this.node}),this.isEditMode=this.router.url.indexOf("/edit")>=0}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}handleExpandClick(e,t){this.store.dispatch(t?new Ct(e):new wt(e))}handleNodeClick(e,t){e.shiftKey?this.checkNode(t):(this.setCheckedNodes(t),this.isFlyToNodeEnabled(t)&&this.store.dispatch(new Je(t.id)),this.handleExpandClick(t,!t.boolState.expanded))}toggleVisible(e,t){const n=void 0===t?!this.isNodeShown(e.id):t;this.store.dispatch(new Ii.UpdateNodesShown(n,[e.id])),this.changeDetection.markForCheck()}handleLayerOrder(e,t){const n=parseInt(e.target.value,10);this.setLayerOrder(t,n)}checkNode(e,t){const n=void 0===t?!this.isNodeChecked(e.id):t;this.store.dispatch(new Ii.UpdateNodesChecked(n,[e.id]))}setCheckedNodes(e,t){this.store.dispatch(new Ii.UpdateNodesChecked(!1));const n=void 0===t?!this.isNodeChecked(e.id):t;this.store.dispatch(new Ii.UpdateNodesChecked(n,[e.id]))}setLayerOrder(e,t){this.store.dispatch(new gt([e],t)),this.changeDetection.markForCheck()}handleObjectLabel(e){const t=e.target;e instanceof KeyboardEvent?("enter"===e.key.toLowerCase()&&(this.setLabel(t.value),this.setEditLabelMode(!1)),"escape"===e.key.toLowerCase()&&this.setEditLabelMode(!1)):e instanceof FocusEvent&&"blur"===e.type&&(this.setLabel(t.value),this.setEditLabelMode(!1))}setLabel(e){this.node.label=e,this.store.dispatch(new ht(this.node.id,e))}setEditLabelMode(e){c.application===s.Loft&&this.isEditMode&&this.store.dispatch(new jt(e?this.node:null))}isFlyToNodeEnabled(e){return!this.isEditMode&&(e.boolState.shown||this.engineService.getObjectLoaded(e.id))}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.g),i.Pb(Et),i.Pb(Qt),i.Pb(T.e),i.Pb(i.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-tree-nested-node"]],inputs:{graph:"graph",node:"node",nested:"nested",theme:"theme"},decls:10,vars:16,consts:[["data-test","treeNode",1,"tree-node",3,"ngClass","keyup.enter","click"],["app-button","","appEventFence","","buttonSize","xsmall","class","tree-node__button","data-test","treeNodeExpand",3,"buttonTheme","click",4,"ngIf"],["class","tree-node__label","tabindex","0","role","button",3,"ngClass","dblclick",4,"ngIf"],["type","text","appEventFence","","appAutoFocus","","data-test","treeNodeEditLabel","class","input",3,"value","blur","keyup",4,"ngIf"],["appEventFence","","type","text","data-test","treeNodeLayerOrder","class","input input--small tree-node__layer-order",3,"value","change",4,"ngIf"],["app-button","","buttonSize","xsmall","data-test","treeNodeVisible","tabindex","-1","aria-hidden","true","appEventFence","",1,"tree-node__visible",3,"buttonTheme","click"],["icon","eye","data-test","treeNodeVisibleTrue","size","xs",1,"text-14","tree-node__eye"],["icon","eye-slash","data-test","treeNodeVisibleFalse","size","xs",1,"text-14","tree-node__eye-slash"],["eventCategory","Search Node","appEventFence","",3,"theme","node"],["app-button","","appEventFence","","buttonSize","xsmall","data-test","treeNodeExpand",1,"tree-node__button",3,"buttonTheme","click"],["icon","caret-right",1,"inline-block","text-14"],["tabindex","0","role","button",1,"tree-node__label",3,"ngClass","dblclick"],[1,"flex","flex-column"],["data-test","treeNodeId","class","text-10 text-uppercase","style","opacity: 0.7",4,"ngIf"],["data-test","treeNodeLabel"],[1,"visually-hidden"],["data-test","treeNodeId",1,"text-10","text-uppercase",2,"opacity","0.7"],["type","text","appEventFence","","appAutoFocus","","data-test","treeNodeEditLabel",1,"input",3,"value","blur","keyup"],["appEventFence","","type","text","data-test","treeNodeLayerOrder",1,"input","input--small","tree-node__layer-order",3,"value","change"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.cc("keyup.enter",(function(e){return t.handleNodeClick(e,t.node)}))("click",(function(e){return t.handleNodeClick(e,t.node)})),i.Ic(1,vv,2,5,"button",1),i.Ic(2,Cv,8,8,"div",2),i.Ic(3,Sv,1,1,"input",3),i.Ic(4,_v,1,1,"input",4),i.hc(5,"async"),i.Vb(6,"button",5),i.cc("click",(function(){return t.toggleVisible(t.node)})),i.Qb(7,"app-icon",6),i.Qb(8,"app-icon",7),i.Ub(),i.Qb(9,"app-node-actions",8),i.Ub()),2&e&&(i.lc("ngClass",i.qc(11,jv,t.theme===t.themeEnum.Light,!t.node.boolState.shown,t.checked,!t.node.boolState.pickable)),i.Eb("data-id",t.sanitizedID),i.Db(1),i.lc("ngIf",t.nested&&t.hasChildren),i.Db(1),i.lc("ngIf",!t.editLabelMode),i.Db(1),i.lc("ngIf",t.editLabelMode),i.Db(1),i.lc("ngIf",i.ic(5,9,t.layerOrderMode$)),i.Db(2),i.lc("buttonTheme",t.theme),i.Db(3),i.lc("theme",t.theme)("node",t.node))},directives:[Z.i,Z.l,ud,dp,dl,kd,nv],pipes:[Z.b],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3535}.text-info{color:#2d72dc}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}:host{display:block}.tree-node{border-radius:4px;padding:4px;margin-bottom:4px;display:flex;align-items:center;height:100%;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;min-width:200px;transition:background-color .12s}.tree-node--light{padding-right:12px}.tree-node--light:focus{outline:2px solid #2d72dc!important;outline-offset:-2px;border-radius:4px}.tree-node--light .tree-node__label{color:#101823;font-size:13px;letter-spacing:.325px;line-height:1.4em}.tree-node--light.tree-node--selected{background:transparent;border-left-color:transparent}.tree-node--light.tree-node--selected .tree-node__label{color:#101823!important}.tree-node--light.tree-node--selected .tree-node__expand,.tree-node--light.tree-node--selected .tree-node__visible{color:#101823}.tree-node--light.tree-node--unpickable{border:none}.tree-node--light.tree-node--hidden .tree-node__label{color:#61779e}.tree-node--light .tree-node__expand,.tree-node--light .tree-node__visible{background-color:transparent;color:#96a8c0;border-radius:4px}.tree-node--selected{background-color:#2d72dc}.tree-node--selected .tree-node__label{color:#fff}.tree-node--unpickable{border:1px dashed #61779e}.tree-node--hidden .tree-node__expand,.tree-node--hidden .tree-node__label,.tree-node--hidden .tree-node__visible{color:#96a8c0}.tree-node--hidden .tree-node__visible{visibility:visible}.tree-node.tree-node--hidden.tree-node--selected .tree-node__expand,.tree-node.tree-node--hidden.tree-node--selected .tree-node__label,.tree-node.tree-node--hidden.tree-node--selected .tree-node__visible{color:#fff}.tree-node__label{font-size:12px;letter-spacing:.3px;line-height:1.4em;letter-spacing:.5px;font-weight:400;line-height:1.3em;color:#d7e0ea;padding:8px 4px 8px 12px;display:flex;align-items:center;flex:1 1 100%;min-height:28px}.tree-node__label--padded{padding-left:36px}.tree-node__button{display:flex;flex:0 0 24px;height:24px;justify-content:center;align-items:center;border:none}.tree-node__expand i{transition:transform .12s}.tree-node__expand--open app-icon{transform:rotate(45deg)}.tree-node .tree-node__expand+.tree-node__label{margin-left:-8px}.tree-node__expand,.tree-node__visible{border-radius:4px;color:#d7e0ea;display:flex;flex:0 0 24px;height:24px;justify-content:center;align-items:center;border:none}.tree-node__layer-order{font-size:10px;flex:0 0 56px;min-height:28px;height:28px;padding:4px;margin:2px;text-align:center}.tree-node .tree-node__eye,.tree-node .tree-node__eye-slash{display:none}.tree-node.tree-node--hidden .tree-node__eye-slash,.tree-node:not(.tree-node--hidden) .tree-node__eye{display:inline}@media (hover:hover){.tree-node__visible{visibility:hidden}.tree-node:hover{cursor:pointer}.tree-node:hover .tree-node__visible{visibility:visible}.tree-node:hover .tree-node__label{color:#fff}.tree-node--light:hover{background-color:#d6ecff}.tree-node--light:hover .tree-node__label{color:#101823}.tree-node--light.tree-node--selected{background-color:#d6ecff}.tree-node--light.tree-node--selected:hover{background-color:#bde0ff}.tree-node--light.tree-node--selected .tree-node__label{color:#101823}.tree-node--light.tree-node--selected .tree-node__expand:hover,.tree-node--light.tree-node--selected .tree-node__visible:hover,.tree-node--light .tree-node__expand:hover,.tree-node--light .tree-node__visible:hover{background-color:transparent;color:inherit}.tree-node__expand:hover,.tree-node__visible:hover{background-color:#1c2a3f;color:#fff;cursor:pointer}.tree-node--selected .tree-node__expand:hover,.tree-node--selected .tree-node__visible:hover{background-color:#2d72dc}.tree-node .tree-node__eye,.tree-node .tree-node__eye-slash{display:none}.tree-node.tree-node--hidden .tree-node__eye-slash,.tree-node:hover:not(.tree-node--hidden) .tree-node__eye{display:inline}}"],encapsulation:2,changeDetection:0}),yv([Object(d.d)(Bi.getCheckedNodeIds),xv("design:type",P.a)],e.prototype,"checkedNodesIds$",void 0),yv([Object(d.d)(fv.getLayerOrderMode),xv("design:type",P.a)],e.prototype,"layerOrderMode$",void 0),yv([Object(d.d)(Er.getLabelEditNode),xv("design:type",P.a)],e.prototype,"labelEditNode$",void 0),yv([Object(d.d)(fv.getShowTreeNodeIds),xv("design:type",P.a)],e.prototype,"showTreeNodeIds$",void 0),e})();function Pv(e,t){if(1&e){const e=i.Wb();i.Vb(0,"div",6),i.cc("click",(function(){i.xc(e);const t=i.gc(2).$implicit;return i.gc().handleExpandClick(t,!0)})),i.Ub()}if(2&e){const e=i.gc(2).$implicit;i.lc("title",e.label)}}function Mv(e,t){if(1&e&&(i.Vb(0,"div",4),i.Ic(1,Pv,1,1,"div",5),i.Qb(2,"app-tree-group",2),i.Ub()),2&e){const e=i.gc().$implicit,t=i.gc();i.Db(1),i.lc("ngIf",t.hasChildren(e)),i.Db(1),i.lc("graph",t.graph)("node",e)("theme",t.theme)}}const Iv=function(e){return{"tree-group--light":e}};function zv(e,t){if(1&e&&(i.Vb(0,"div",1),i.Qb(1,"app-tree-nested-node",2),i.Ic(2,Mv,3,4,"div",3),i.Ub()),2&e){const e=t.$implicit,n=i.gc();i.lc("ngClass",i.nc(5,Iv,n.theme===n.themeEnum.Light)),i.Db(1),i.lc("graph",n.graph)("node",e)("theme",n.theme),i.Db(1),i.lc("ngIf",e.boolState.expanded)}}let Tv=(()=>{class e{constructor(e,t){this.graphService=e,this.store=t,this.themeEnum=sd,this.graphSubject=new bl.a(null),this.theme=sd.Dark,this.nodes=[],this.ngUnsubscribe=new k.a}get graph(){return this._graph}set graph(e){e&&(this._graph=e,this.graphSubject.next(e))}ngOnInit(){this.graphSubject.pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{e&&this.getNodes()})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}getNodes(){const e=this.node?Dt.getSuccessors(this.graph,this.node.id):Dt.getRoots(this.graph);this.nodes=this.graphService.getNodes(this.graph,e)}countChildren(e){return Dt.getSuccessors(this.graph,e.id).length}hasChildren(e){return this.countChildren(e)>0}trackTreeNode(e,t){return t.id}handleExpandClick(e,t){this.store.dispatch(t?new Ct(e):new wt(e))}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(Et),i.Pb(d.g))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-tree-group"]],inputs:{graph:"graph",theme:"theme",node:"node"},decls:1,vars:2,consts:[["class","tree-group",3,"ngClass",4,"ngFor","ngForOf","ngForTrackBy"],[1,"tree-group",3,"ngClass"],[3,"graph","node","theme"],["class","tree-group__children",4,"ngIf"],[1,"tree-group__children"],["class","tree-group__collapse",3,"title","click",4,"ngIf"],[1,"tree-group__collapse",3,"title","click"]],template:function(e,t){1&e&&i.Ic(0,zv,3,7,"div",0),2&e&&i.lc("ngForOf",t.nodes)("ngForTrackBy",t.trackTreeNode)},directives:[Z.k,Z.i,kv,Z.l,e],styles:['.text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.tree-group[_ngcontent-%COMP%]{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.tree-group--light[_ngcontent-%COMP%]   .tree-group__collapse[_ngcontent-%COMP%]:after{background:#eaeff5}.tree-group--light[_ngcontent-%COMP%]   .tree-group__collapse[_ngcontent-%COMP%]:hover{background:transparent}.tree-group--light[_ngcontent-%COMP%]   .tree-group__collapse[_ngcontent-%COMP%]:hover:after{background:#d7e0ea}.tree-group__children[_ngcontent-%COMP%]{padding-left:20px;position:relative}.tree-group__collapse[_ngcontent-%COMP%]{position:absolute;left:0;top:0;bottom:0;width:20px;z-index:1}.tree-group__collapse[_ngcontent-%COMP%]:after{content:" ";display:block;position:absolute;width:1px;left:10px;top:0;bottom:0;background:#1c2a3f}.tree-group__collapse[_ngcontent-%COMP%]:hover{cursor:pointer}.tree-group__collapse[_ngcontent-%COMP%]:hover:after{background:#283853}'],changeDetection:0}),e})();var Uv=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let Dv=(()=>{class e{constructor(e,t){this.store=e,this.graphService=t,this.theme=sd.Dark,this.ngUnsubscribe=new k.a}ngOnInit(){this.store.select(Bi.getCheckedNodes).pipe(Object(I.a)(e=>1===e.length),Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{setTimeout(()=>{this.scrollNodeIntoView(e[0])})})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}scrollNodeIntoView(e){const t=this.graphService.sanitizeNodeID(e.objectId),n=document.querySelector(`[data-id="${t}"]`);n&&"scrollBehavior"in document.documentElement.style&&n.scrollIntoView({behavior:"smooth",block:"nearest"})}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.g),i.Pb(Et))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-tree"]],inputs:{theme:"theme",searchGraph:"searchGraph"},decls:2,vars:4,consts:[[3,"theme","graph"]],template:function(e,t){1&e&&(i.Qb(0,"app-tree-group",0),i.hc(1,"async")),2&e&&i.lc("theme",t.theme)("graph",t.searchGraph?t.searchGraph:i.ic(1,2,t.viewGraph$))},directives:[Tv],pipes:[Z.b],styles:[""]}),function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);o>3&&r&&Object.defineProperty(t,n,r)}([Object(d.d)(Er.getViewGraph),Uv("design:type",P.a)],e.prototype,"viewGraph$",void 0),e})();var Lv=n("vxfF");function Ev(e,t){1&e&&(i.Vb(0,"div",4),i.Kc(1,"No results"),i.Ub())}function Fv(e,t){if(1&e&&(i.Vb(0,"div",5),i.Qb(1,"app-tree",6),i.Ub()),2&e){const e=i.gc();i.Db(1),i.lc("theme",e.theme)("searchGraph",e.searchGraph)}}function Av(e,t){if(1&e&&(i.Vb(0,"div"),i.Qb(1,"app-tree-nested-node",9),i.Ub()),2&e){const e=t.$implicit,n=i.gc(2);i.Db(1),i.lc("theme",n.theme)("nested",!1)("node",e)("graph",n.prunedViewGraph)}}function Rv(e,t){if(1&e&&(i.Vb(0,"cdk-virtual-scroll-viewport",7),i.Ic(1,Av,2,4,"div",8),i.Ub()),2&e){const e=i.gc();i.Fc("height",e.searchHeight,"px"),i.lc("itemSize",64),i.Db(1),i.lc("cdkVirtualForOf",e.searchResults)("cdkVirtualForTrackBy",e.trackTreeNode)}}let Vv=(()=>{class e{constructor(e,t,n,s,o,r){this.renderer=e,this.changeDetectorRef=t,this.elementRef=n,this.engineService=s,this.store=o,this.liveAnnouncer=r,this._query="",this._displayMode=pr.List,this.displayModeChange=new i.p,this.theme=sd.Dark,this.treeSearchDisplayMode=pr,this.searchResults=[],this.searchHeight=0,this.ngUnsubscribe=new k.a,this.numResults$=new bl.a(0)}get query(){return this._query}set query(e){this._query=e||"",this.handleQueryChange(),void 0!==this.viewGraph&&this.numResults$.next(this.searchResults.length)}get displayMode(){return this._displayMode}set displayMode(e){null!=e&&(this._displayMode=e,this.handleQueryChange(),this.displayModeChange.emit(this.displayMode))}get viewGraph(){return this._viewGraph}set viewGraph(e){this._viewGraph=e,this.leafNodes=this.engineService.getLeaves(),this.buildPrunedViewGraph(this.displayMode),this.handleQueryChange(),this.changeDetectorRef.markForCheck()}ngOnInit(){}buildPrunedViewGraph(e){const t=this.store.selectSnapshot(Or.getSelectedChapter),n=this.engineService.createViewGraph(t.showObjects,!0);this.prunedViewGraph=n}ngAfterViewInit(){this.renderer.listen("window","resize",e=>{this.resize()}),this.numResults$.pipe(Object(El.a)(600)).subscribe(e=>{this.liveAnnouncer.announce(this.searchResults.length+" structures found")})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}handleQueryChange(){const e=this.search(this._query,this.displayMode===pr.List?this.prunedViewGraph:this.viewGraph);this.displayMode===pr.Tree&&(this.searchGraph=function(e,t){return t.reduce((t,n)=>function e(t,n,i){Dt.addNode(t,n);const s=Dt.getAncestor(i,n.id);if(s){const o=t.successors[s]||[];return o.push(n.id),t.successors[s]=Object(D.uniq)(o),t.predecessors[n.id]=s,e(t,Dt.getNode(i,s),i)}return Dt.addRootNode(t,n),t}(t,n,e),{nodes:{},successors:{},predecessors:{},roots:{}})}(this.viewGraph,e)),this.searchResults=e,this.resize()}resize(){this.getSearchHeight().pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.searchHeight=e,this.changeDetectorRef.markForCheck()})}getSearchHeight(){return new P.a(e=>{setTimeout(()=>{const t=this.elementRef.nativeElement.offsetHeight;null!=t&&(e.next(t),e.complete())})})}search(e,t){return void 0===t?[]:(e=Object(sv.remove)(e.toLowerCase()),Object.values(t.nodes).filter(t=>0===e.length||Object(sv.remove)(t.label.toLowerCase()).indexOf(e)>=0).sort((e,t)=>e.label.localeCompare(t.label)))}trackTreeNode(e,t){return t.id}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(i.H),i.Pb(i.i),i.Pb(i.m),i.Pb(Qt),i.Pb(d.g),i.Pb(Tl.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-tree-search"]],inputs:{query:"query",displayMode:"displayMode",viewGraph:"viewGraph",theme:"theme"},outputs:{displayModeChange:"displayModeChange"},decls:4,vars:3,consts:[[1,"tree-search"],["class","tree-search__empty",4,"ngIf"],["class","pr-3 pv-3",4,"ngIf"],["class","pv-3",3,"itemSize","height",4,"ngIf"],[1,"tree-search__empty"],[1,"pr-3","pv-3"],[1,"tree-search__tree",3,"theme","searchGraph"],[1,"pv-3",3,"itemSize"],[4,"cdkVirtualFor","cdkVirtualForOf","cdkVirtualForTrackBy"],[1,"mr-3",2,"height","64px",3,"theme","nested","node","graph"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Ic(1,Ev,2,0,"div",1),i.Ic(2,Fv,2,2,"div",2),i.Ic(3,Rv,2,5,"cdk-virtual-scroll-viewport",3),i.Ub()),2&e&&(i.Db(1),i.lc("ngIf",0===t.searchResults.length),i.Db(1),i.lc("ngIf",t.displayMode===t.treeSearchDisplayMode.Tree),i.Db(1),i.lc("ngIf",t.displayMode===t.treeSearchDisplayMode.List))},directives:[Z.l,Dv,Lv.e,Lv.a,Lv.d,kv],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3535}.text-info{color:#2d72dc}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.tree-search{display:flex;flex-direction:column;flex:1 1 auto;height:100%}.tree-search__tree{flex-grow:1;width:100%}.tree-search__empty{font-size:14px;letter-spacing:.35px;line-height:1.4em;padding:12px;font-style:italic;margin-top:12px}.tree-search cdk-virtual-scroll-viewport{flex:1 1 auto}.tree-search cdk-virtual-scroll-viewport .cdk-virtual-scroll-content-wrapper{padding-right:12px}"],encapsulation:2,changeDetection:0}),e})();var Nv=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},Bv=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const Hv=["searchInput"],Qv=["tabButton"],$v=function(e){return{"view-search__action--selected":e}};let qv=(()=>{class e{constructor(e,t,n){this.viewService=e,this.engineService=t,this.store=n,this.ngUnsubscribe=new k.a,this.query="",this.themeEnum=sd,this.treeSearchDisplayMode=pr}ngOnInit(){this.initViewGraphSubscription(),this.initDisplayModeSubscription()}initViewGraphSubscription(){this.store.select(Or.getSelectedChapterId).pipe(Object(I.a)(e=>null!=e),Object(qa.a)(),Object(M.a)(this.ngUnsubscribe)).subscribe(()=>{this.store.dispatch(new Qe(this.engineService.createViewGraph({},!1)))})}initDisplayModeSubscription(){this.searchDisplayMode$.pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{setTimeout(()=>{this.searchInput.nativeElement.focus()})})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}handleSearchKeyup(e,t){"Escape"===e.key&&(this.handleExitClick(),this.searchInput.nativeElement.blur()),this.query=t}handleExitClick(){this.query="",this.viewService.toggleSearch(null,!1)}toggleDisplayMode(){let e=this.store.selectSnapshot(mr.getSearchDisplayMode);e=e===pr.List?pr.Tree:pr.List,this.setDisplayMode(e)}setDisplayMode(e){this.store.dispatch(new j.SetSearchDisplayMode(e))}handleTreeButtonClick(){this.setDisplayMode(pr.Tree)}handleListButtonClick(){this.setDisplayMode(pr.List)}getActiveTab(){switch(this.store.selectSnapshot(mr.getSearchDisplayMode)){case pr.List:return"searchTab";case pr.Tree:return"treeTab";default:return null}}shiftFocus(e,t){e.stopPropagation();const n=this._buttonRefs.toArray(),i=n.findIndex(e=>e.nativeElement==document.activeElement);n[(i+t+n.length)%n.length].nativeElement.focus()}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(Dl),i.Pb(Qt),i.Pb(d.g))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-search"]],viewQuery:function(e,t){if(1&e&&(i.Pc(Hv,!0),i.Pc(Qv,!0)),2&e){let e;i.sc(e=i.dc())&&(t.searchInput=e.first),i.sc(e=i.dc())&&(t._buttonRefs=e)}},decls:29,vars:33,consts:[["role","dialog","cdkTrapFocus","",1,"view-search",3,"keyup.escape"],[1,"view-search__header"],[1,"view-search__actions-row"],["role","tablist",1,"view-search__actions",3,"keydown.arrowleft","keydown.arrowright"],["type","button","role","tab","id","treeTab",1,"view-search__action",3,"ngClass","click","keyup.space"],["tabButton",""],["aria-hidden","true",1,"view-search__action-icon",3,"icon"],["type","button","role","tab","id","searchTab",1,"view-search__action",3,"ngClass","click","keyup.space"],["aria-hidden","true","icon","search",1,"view-search__action-icon"],["type","button","matTooltip","Close Search","aria-label","Close Search",1,"view-search__exit",3,"click"],["icon","times"],[1,"view-search__input-row"],[1,"view-search__input-container"],["icon","search",1,"view-search__input-icon"],["appAutoFocus","","appSelectOnFocus","","role","search","type","text","aria-label","Start typing the search term, then use tab to navigate the results","placeholder","Search Anatomy",1,"view-search__input",3,"value","keyup"],["searchInput",""],["role","tabpanel",1,"view-search__body"],[3,"displayMode","theme","query","viewGraph"]],template:function(e,t){if(1&e){const e=i.Wb();i.Vb(0,"div",0),i.cc("keyup.escape",(function(){return t.handleExitClick()})),i.Vb(1,"div",1),i.Vb(2,"div",2),i.Vb(3,"div",3),i.cc("keydown.arrowleft",(function(e){return t.shiftFocus(e,-1)}))("keydown.arrowright",(function(e){return t.shiftFocus(e,1)})),i.Vb(4,"button",4,5),i.cc("click",(function(){return t.handleTreeButtonClick()}))("keyup.space",(function(){return t.handleTreeButtonClick()})),i.hc(6,"async"),i.hc(7,"async"),i.hc(8,"async"),i.Qb(9,"app-icon",6),i.Kc(10,"Tree "),i.Ub(),i.Vb(11,"button",7,5),i.cc("click",(function(){return t.handleListButtonClick()}))("keyup.space",(function(){return t.handleListButtonClick()})),i.hc(13,"async"),i.hc(14,"async"),i.hc(15,"async"),i.Qb(16,"app-icon",8),i.Kc(17,"Search "),i.Ub(),i.Ub(),i.Vb(18,"button",9),i.cc("click",(function(){return t.handleExitClick()})),i.Qb(19,"app-icon",10),i.Ub(),i.Ub(),i.Vb(20,"div",11),i.Vb(21,"div",12),i.Qb(22,"app-icon",13),i.Vb(23,"input",14,15),i.cc("keyup",(function(n){i.xc(e);const s=i.tc(24);return t.handleSearchKeyup(n,s.value)})),i.Ub(),i.Ub(),i.Ub(),i.Ub(),i.Vb(25,"div",16),i.Qb(26,"app-tree-search",17),i.hc(27,"async"),i.hc(28,"async"),i.Ub(),i.Ub()}2&e&&(i.Db(4),i.lc("ngClass",i.nc(29,$v,i.ic(6,13,t.searchDisplayMode$)===t.treeSearchDisplayMode.Tree)),i.Eb("aria-selected",i.ic(7,15,t.searchDisplayMode$)===t.treeSearchDisplayMode.Tree)("tabIndex",i.ic(8,17,t.searchDisplayMode$)===t.treeSearchDisplayMode.Tree?0:-1),i.Db(5),i.lc("icon","sitemap"),i.Db(2),i.lc("ngClass",i.nc(31,$v,i.ic(13,19,t.searchDisplayMode$)===t.treeSearchDisplayMode.List)),i.Eb("aria-selected",i.ic(14,21,t.searchDisplayMode$)===t.treeSearchDisplayMode.List)("tabIndex",i.ic(15,23,t.searchDisplayMode$)===t.treeSearchDisplayMode.List?0:-1),i.Db(12),i.lc("value",t.query),i.Db(2),i.Eb("aria-labelledby",t.getActiveTab()),i.Db(1),i.lc("displayMode",i.ic(27,25,t.searchDisplayMode$))("theme",t.themeEnum.Light)("query",t.query)("viewGraph",i.ic(28,27,t.viewGraph$)))},directives:[Tl.d,Z.i,dl,ru.c,nv,iv,Vv],pipes:[Z.b],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3535}.text-info{color:#2d72dc}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.view-search{display:flex;flex-direction:column;height:100%}@-webkit-keyframes appear{0%{background-color:transparent}}@keyframes appear{0%{background-color:transparent}}.view-search__header{flex:0 0 auto;flex-direction:column;display:flex;-webkit-animation:appear .25s ease-out;animation:appear .25s ease-out}.view-search__actions-row{flex:0 0 auto;display:flex;padding:0 12px;justify-content:space-between;align-items:center;border-bottom:1px solid #d7e0ea}.view-search__actions{display:flex;height:56px;flex:1;justify-content:space-between}.view-search__action{font-size:14px;letter-spacing:.35px;line-height:1.4em;font-weight:500;text-transform:uppercase;background:transparent;display:flex;align-items:center;justify-content:center;border:0;border-bottom:2px solid transparent;color:#374a68;cursor:pointer;width:49%;padding-top:4px}.view-search__action:hover:not(.view-search__action--selected){color:#131c2a;border-bottom-color:#d7e0ea}.view-search__action--selected{color:#131c2a;border-bottom-color:#2d72dc}.view-search__action-icon{margin-right:8px}.view-search__exit{display:flex;align-items:center;justify-content:center;border:0;border-radius:50%;color:#374a68;background-color:#d7e0ea;opacity:.8;cursor:pointer;width:28px;height:28px;margin-left:12px;outline:none}.view-search__input-row{flex:0 0 auto;display:flex;padding:12px}.view-search__input-container{background-color:#fff;border:1px solid #fff;display:flex;flex-grow:1;border-radius:4px}.view-search__input-container:hover{border-color:#61779e}.view-search__input-container:focus-within{outline:2px solid #2d72dc!important;outline-offset:-2px}.view-search__input-icon{background:0 0;display:flex;align-items:center;justify-content:center;color:#61779e;width:36px;height:36px;outline:0}.view-search__input{font-size:13px;letter-spacing:.325px;line-height:1.4em;font-weight:400;color:#131c2a;background:transparent;border:1px solid transparent;outline:none;flex:1 0 auto;padding:8px 12px 8px 0}.view-search__input::-ms-clear{display:none}.view-search__input::-moz-placeholder{color:#61779e;opacity:1}.view-search__input:-ms-input-placeholder{color:#61779e;opacity:1}.view-search__input::placeholder{color:#61779e;opacity:1}.view-search__body{flex:1 1 100%;overflow-y:scroll;padding-left:12px}.view-search__input{font-family:Inter UI,Font Awesome\\ 5 Pro!important}@media not all and (min-resolution:0.001dpcm){@supports (-webkit-appearance:none){.view-search__input{font-size:16px;padding:4px 8px;width:0}}}"],encapsulation:2,changeDetection:0}),Nv([Object(d.d)(Er.getViewGraph),Bv("design:type",P.a)],e.prototype,"viewGraph$",void 0),Nv([Object(d.d)(mr.getSearchDisplayMode),Bv("design:type",P.a)],e.prototype,"searchDisplayMode$",void 0),e})();var Wv=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Kv(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",7),i.cc("click",(function(){return i.xc(e),i.gc().handleCloseClick()})),i.Ub()}2&e&&i.Eb("aria-label","Close")}function Gv(e,t){if(1&e&&(i.Vb(0,"i",8),i.Kc(1),i.Ub()),2&e){const e=i.gc();i.Db(1),i.Mc(" ",e.node.info.latinLabel," ")}}function Zv(e,t){if(1&e&&i.Qb(0,"p",9),2&e){const e=i.gc();i.Hb("text-italic",!(null!=e.node.info&&e.node.info.description)),i.lc("innerHTML",e.formatHTML((null==e.node.info?null:e.node.info.description)||"No description available"),i.yc)}}function Jv(e,t){if(1&e&&(i.Vb(0,"a",10),i.Kc(1," View source "),i.Ub()),2&e){const e=i.gc();i.Eb("href",null==e.node.info?null:e.node.info.sourceLink,i.Ac)}}const Xv=function(e,t){return{"view-node-description--layout-column":e,"view-node-description--layout-drawer":t}};let Yv=(()=>{class e{constructor(e,t,n){this.store=e,this.actions=t,this.changeRef=n,this.layout=Ya.Drawer,this.showClose=!0,this.isOpen=!1,this.ngUnsubscribe=new k.a}ngOnInit(){this.initInfoListeners(),this.store.select(Bi.getSelectedNode).pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{void 0!==e&&(this.node=this.store.selectSnapshot(Er.getViewGraphNode)(e.objectId))})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}handleHideClick(e){this.store.dispatch(new Ii.UpdateNodesShown(!1,[e.id]))}handleCloseClick(){const e=this.store.selectSnapshot(mr.getUI);e.nodeInfo.status=_o.Hide,this.store.dispatch(new j.SetUI(e))}initInfoListeners(){this.actions.pipe(Object(d.i)(Mt,It,kt),Object(M.a)(this.ngUnsubscribe)).subscribe(()=>{this.isOpen=!0,this.changeRef.markForCheck()})}formatHTML(e){return e.trim().replace(new RegExp("\r?\n","g"),"<br><br>")}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.g),i.Pb(d.b),i.Pb(i.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-node-description"]],inputs:{layout:"layout",showClose:"showClose"},decls:9,vars:11,consts:[[1,"view-node-description",3,"ngClass"],[1,"view-node-description__header","mb-3"],["type","button","app-pin-button","","size","small","icon","arrow-left","class","mr-1 mt-1",3,"click",4,"ngIf"],[1,"view-node-description__title"],["class","mv-1 text-14 text-medium text-italic",4,"ngIf"],["class","view-node-description__body mv-2",3,"text-italic","innerHTML",4,"ngIf"],["class","view-node-description__attribution text-link text-underline mv-1","target","_blank","rel","noreferrer nofollow",4,"ngIf"],["type","button","app-pin-button","","size","small","icon","arrow-left",1,"mr-1","mt-1",3,"click"],[1,"mv-1","text-14","text-medium","text-italic"],[1,"view-node-description__body","mv-2",3,"innerHTML"],["target","_blank","rel","noreferrer nofollow",1,"view-node-description__attribution","text-link","text-underline","mv-1"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Vb(1,"div",1),i.Ic(2,Kv,1,1,"button",2),i.Vb(3,"h2",3),i.Kc(4),i.Ub(),i.Ub(),i.Ic(5,Gv,2,1,"i",4),i.Ic(6,Zv,1,3,"p",5),i.hc(7,"async"),i.Ic(8,Jv,2,1,"a",6),i.Ub()),2&e&&(i.lc("ngClass",i.oc(8,Xv,"column"===t.layout,"drawer"===t.layout)),i.Db(2),i.lc("ngIf",t.showClose),i.Db(2),i.Lc(null==t.node?null:t.node.label),i.Db(1),i.lc("ngIf",null==t.node.info?null:t.node.info.latinLabel),i.Db(1),i.lc("ngIf",!i.ic(7,6,t.querying$)),i.Db(2),i.lc("ngIf",null==t.node.info?null:t.node.info.sourceLink))},directives:[Z.i,Z.l,ou],pipes:[Z.b],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3535}.text-info{color:#2d72dc}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.view-node-description{display:flex;flex-direction:column}.view-node-description--layout-drawer .view-node-description__body{margin-top:8px}.view-node-description--layout-column .view-node-description__body{margin-top:4px}.view-node-description__header{display:flex}.view-node-description__title{font-size:18px;letter-spacing:.45px;line-height:1.4em;flex:1 1 auto;font-weight:600;align-self:center}.view-node-description--layout-drawer .view-node-description__title,.view-node-description__body{font-size:14px;letter-spacing:.35px;line-height:1.4em}.view-node-description__body{color:#374a68}.view-node-description__attribution{font-size:12px;letter-spacing:.3px;line-height:1.4em;color:#374a68}.view-node-description__actions{cursor:pointer;outline:none;border:none;background:transparent;padding:4px 8px}"],encapsulation:2,changeDetection:0}),function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);o>3&&r&&Object.defineProperty(t,n,r)}([Object(d.d)(Er.getQuerying),Wv("design:type",P.a)],e.prototype,"querying$",void 0),e})();var eO=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},tO=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function nO(e,t){1&e&&(i.Tb(0),i.Qb(1,"app-view-title"),i.Qb(2,"app-view-content-mode",6),i.Sb())}function iO(e,t){1&e&&i.Qb(0,"app-view-quiz")}function sO(e,t){if(1&e&&(i.Vb(0,"app-view-column",3),i.Tb(1,4),i.Ic(2,nO,3,0,"ng-container",5),i.hc(3,"async"),i.Ic(4,iO,1,0,"app-view-quiz",5),i.hc(5,"async"),i.Sb(),i.Ub()),2&e){const e=i.gc();i.lc("@slideInOut",void 0),i.Db(2),i.lc("ngIf",!i.ic(3,3,e.quizModeActive$)),i.Db(2),i.lc("ngIf",i.ic(5,5,e.quizModeActive$))}}function oO(e,t){1&e&&(i.Vb(0,"app-view-column",7),i.Qb(1,"app-view-search"),i.Ub()),2&e&&i.lc("unpadded",!0)("@slideInOut",void 0)}function rO(e,t){1&e&&(i.Vb(0,"app-view-column",3),i.Qb(1,"app-view-node-description",6),i.Ub()),2&e&&i.lc("@slideInOut",void 0)}const aO=function(){return{"view-column-container--header-offset":!0}};let cO=(()=>{class e{constructor(e,t,n){this.viewService=e,this.layoutService=t,this.changeDetectorRef=n,this.ngUnsubscribe=new k.a,this.viewLayout=Xa,this.application=s,this.columnVisible=!1,this.searchVisible=!1,this.nodeInfoVisible=!1}ngOnInit(){this.initLayoutObserver()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initLayoutObserver(){Object(Ta.b)(this.layout$,this.chapter$).pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(([])=>{this.columnVisible=this.layoutService.isVisible(Xa.Column),this.searchVisible=this.layoutService.isVisible(Xa.Search),this.nodeInfoVisible=this.layoutService.isVisible(Xa.NodeInfo),this.changeDetectorRef.markForCheck()})}handleSearchClick(){this.viewService.toggleSearch(null,!0)}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(Dl),i.Pb(rc),i.Pb(i.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-column-container"]],decls:4,vars:5,consts:[[1,"view-column-container",3,"ngClass"],["class","view-column-container__inner",4,"ngIf"],["class","view-column-container__inner",3,"unpadded",4,"ngIf"],[1,"view-column-container__inner"],["view-column-body",""],[4,"ngIf"],["layout","column"],[1,"view-column-container__inner",3,"unpadded"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Ic(1,sO,6,7,"app-view-column",1),i.Ic(2,oO,2,2,"app-view-column",2),i.Ic(3,rO,2,1,"app-view-column",1),i.Ub()),2&e&&(i.lc("ngClass",i.mc(4,aO)),i.Db(1),i.lc("ngIf",t.columnVisible),i.Db(1),i.lc("ngIf",t.searchVisible),i.Db(1),i.lc("ngIf",t.nodeInfoVisible))},directives:[Z.i,Z.l,xx,ah,Dh,Qy,qv,Yv],pipes:[Z.b],styles:[".view-column-container{pointer-events:none;height:100%;width:320px;position:absolute;left:0;top:0;z-index:30}.view-column-container app-view-column{position:absolute;left:0;top:0;height:100%;z-index:40}"],encapsulation:2,data:{animation:[Object(Zl.n)("slideInOut",[Object(Zl.m)(":enter",[Object(Zl.l)({transform:"translateX(-320px)"}),Object(Zl.e)("300ms ease-in-out",Object(Zl.l)({transform:"*"}))]),Object(Zl.m)(":leave",[Object(Zl.e)("300ms ease-in-out",Object(Zl.l)({transform:"translateX(-320px)"}))])])]},changeDetection:0}),eO([Object(d.d)(Or.getSelectedChapter),tO("design:type",P.a)],e.prototype,"chapter$",void 0),eO([Object(d.d)(mr.getUI),tO("design:type",P.a)],e.prototype,"layout$",void 0),eO([Object(d.d)(xs.getQuizModeActive),tO("design:type",P.a)],e.prototype,"quizModeActive$",void 0),e})();var lO=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let pO=(()=>{class e{constructor(e){this.store=e,this.audioVisible=!1,this.ngUnsubscribe=new k.a}ngOnInit(){}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}handleAudioClick(){const e=this.store.selectSnapshot(Er.getPlayAudio);this.store.dispatch(new pt(!e))}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.g))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-engine-audio"]],decls:7,vars:9,consts:[["type","button",1,"audio",3,"click"],[1,"audio__icon",3,"icon"],[1,"audio__label","text-10","text-uppercase","text-semibold"]],template:function(e,t){1&e&&(i.Vb(0,"button",0),i.cc("click",(function(){return t.handleAudioClick()})),i.hc(1,"async"),i.Qb(2,"app-icon",1),i.hc(3,"async"),i.Vb(4,"span",2),i.Kc(5),i.hc(6,"async"),i.Ub(),i.Ub()),2&e&&(i.Eb("aria-label",i.ic(1,3,t.playAudio$)?"Stop Audio":"Play Audio"),i.Db(2),i.lc("icon",i.ic(3,5,t.playAudio$)?"volume-up":"volume-slash"),i.Db(3),i.Mc(" ",i.ic(6,7,t.playAudio$)?"Stop Audio":"Play Audio"," "))},directives:[dl],pipes:[Z.b],styles:[".audio[_ngcontent-%COMP%]{border:none;background:#283853;box-shadow:1px -1px 2px 0 rgba(28,42,63,.1),0 1px 2px 0 rgba(28,42,63,.3);color:#fff;border-radius:4px;height:26px;width:26px;padding:0;display:flex;justify-content:flex-start;align-items:center;overflow:hidden;transition:width .3s ease-in-out;text-transform:uppercase}.audio[_ngcontent-%COMP%]:hover{background:#374a68;cursor:pointer;width:100px}.audio[_ngcontent-%COMP%]:hover   .audio__label[_ngcontent-%COMP%]{flex:1 0 auto;display:inline-block;padding:0 8px 0 0}.audio__icon[_ngcontent-%COMP%]{flex:0 0 26px}.audio__label[_ngcontent-%COMP%]{display:none}"],changeDetection:0}),function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);o>3&&r&&Object.defineProperty(t,n,r)}([Object(d.d)(Er.getPlayAudio),lO("design:type",P.a)],e.prototype,"playAudio$",void 0),e})();var dO=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},uO=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const gO={stacksForChapter:{}};let hO=(()=>{let e=class{constructor(e){this.store=e}static canUndo(e,t){return e.stacksForChapter[t.selectedChapter].undoStack.length>0}static canRedo(e,t){return e.stacksForChapter[t.selectedChapter].redoStack.length>0}static getUndoCount(e,t){return e.stacksForChapter[t.selectedChapter].undoStack.length||0}reset(e,t){e.patchState(immer.produce(e.getState(),e=>{e.stacksForChapter={}}))}undoAll(e,t){const n=e.getState();if(void 0===n.stacksForChapter[t.chapterId])return;const i=[...n.stacksForChapter[t.chapterId].undoStack].reverse(),s=i.flat().reduce((e,t)=>(void 0===e[t.patchAction]&&(e[t.patchAction]={action:t.patchAction,patches:[]}),e[t.patchAction].patches=[...e[t.patchAction].patches,...t.inverse],e),{});Object.keys(s).forEach(t=>{e.dispatch(new s[t].action(s[t].patches))});const o=immer.produce(n,e=>{e.stacksForChapter[t.chapterId].undoStack=[],e.stacksForChapter[t.chapterId].redoStack=i});e.patchState(o)}preserveState(e,t){const n=this.store.selectSnapshot(Or.getSelectedChapterId),i=immer.produce(e.getState(),e=>{0!==t.patches.length&&(t.patches.some(e=>0===e.forward.length)&&t.patches.some(e=>0===e.inverse.length)||(void 0===e.stacksForChapter[n]&&(e.stacksForChapter[n]={redoStack:[],undoStack:[]}),e.stacksForChapter[n].redoStack=[],e.stacksForChapter[n].undoStack.push(t.patches)))});e.patchState(i)}redo(e,t){const n=e.getState(),i=Object(D.get)(n.stacksForChapter[t.chapterId],"redoStack",[]);if(0===i.length)return;const s=i[i.length-1],o=immer.produce(n,e=>{e.stacksForChapter[t.chapterId].redoStack.pop(),e.stacksForChapter[t.chapterId].undoStack.push(s)});e.patchState(o),s.forEach(t=>{e.dispatch(new t.patchAction(t.forward))})}undo(e,t){const n=e.getState(),i=Object(D.get)(n.stacksForChapter[t.chapterId],"undoStack",[]);if(0===i.length)return;const s=i[i.length-1],o=immer.produce(n,e=>{e.stacksForChapter[t.chapterId].undoStack.pop(),e.stacksForChapter[t.chapterId].redoStack.push(s)});e.patchState(o),s.forEach(t=>{e.dispatch(new t.patchAction(t.inverse))})}};return e.\u0275fac=function(t){return new(t||e)(i.Zb(d.g))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac}),dO([Object(d.a)(zi.Reset),uO("design:type",Function),uO("design:paramtypes",[Object,zi.Reset]),uO("design:returntype",void 0)],e.prototype,"reset",null),dO([Object(d.a)(zi.UndoAll),uO("design:type",Function),uO("design:paramtypes",[Object,zi.UndoAll]),uO("design:returntype",void 0)],e.prototype,"undoAll",null),dO([Object(d.a)(zi.SavePatches),uO("design:type",Function),uO("design:paramtypes",[Object,zi.SavePatches]),uO("design:returntype",void 0)],e.prototype,"preserveState",null),dO([Object(d.a)(zi.Redo),uO("design:type",Function),uO("design:paramtypes",[Object,zi.Redo]),uO("design:returntype",void 0)],e.prototype,"redo",null),dO([Object(d.a)(zi.Undo),uO("design:type",Function),uO("design:paramtypes",[Object,zi.Undo]),uO("design:returntype",void 0)],e.prototype,"undo",null),dO([Object(d.e)([Or]),uO("design:type",Function),uO("design:paramtypes",[Object,On]),uO("design:returntype",Boolean)],e,"canUndo",null),dO([Object(d.e)([Or]),uO("design:type",Function),uO("design:paramtypes",[Object,On]),uO("design:returntype",Boolean)],e,"canRedo",null),dO([Object(d.e)([Or]),uO("design:type",Function),uO("design:paramtypes",[Object,On]),uO("design:returntype",Number)],e,"getUndoCount",null),e=dO([Object(d.f)({name:"undo",defaults:gO})],e),e})(),bO=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-pillbox-divider"]],decls:1,vars:0,consts:[[1,"pillbox-divider"]],template:function(e,t){1&e&&i.Qb(0,"div",0)},styles:[".pillbox-divider{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;border-right:1px solid rgba(0,0,0,.1);height:18px;margin:0 8px}"],encapsulation:2,changeDetection:0}),e})();function mO(e,t){if(1&e){const e=i.Wb();i.Tb(0),i.Qb(1,"app-pillbox-divider"),i.Vb(2,"button",2),i.cc("click",(function(){return i.xc(e),i.gc().handleExitClick()})),i.Ub(),i.Sb()}if(2&e){const e=i.gc();i.Db(2),i.lc("matTooltip","Close "+e.name),i.Eb("aria-label","Close "+e.name)}}const fO=function(e,t,n){return{"pillbox--padding-dense":e,"pillbox--padding-none":t,"pillbox--vertical":n}},yO=["*"];let xO=(()=>{class e{constructor(){this.canExit=!1,this.padding="normal",this.orientation="horizontal",this.name="",this.eventCategory="",this.exit=new i.p}ngOnInit(){}handleExitClick(){this.exit.emit()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-pillbox"]],inputs:{canExit:"canExit",padding:"padding",orientation:"orientation",name:"name",eventCategory:"eventCategory"},outputs:{exit:"exit"},ngContentSelectors:yO,decls:3,vars:6,consts:[[1,"pillbox",3,"ngClass"],[4,"ngIf"],["data-test","closePillboxButton","app-pin-button","","buttonType","ghost","icon","times",3,"matTooltip","click"]],template:function(e,t){1&e&&(i.kc(),i.Vb(0,"div",0),i.jc(1),i.Ic(2,mO,3,2,"ng-container",1),i.Ub()),2&e&&(i.lc("ngClass",i.pc(2,fO,"dense"===t.padding,"none"===t.padding,"vertical"===t.orientation)),i.Db(2),i.lc("ngIf",t.canExit))},directives:[Z.i,Z.l,bO,ou,ru.c],styles:[".pillbox{border-radius:32px;background-color:hsla(0,0%,100%,.9);box-shadow:1px -1px 2px 0 rgba(28,42,63,.1),0 1px 2px 0 rgba(28,42,63,.3);color:#131c2a;padding:6px;display:inline-flex;justify-content:center;align-items:center;overflow:hidden;transition:padding .15s}.pillbox--padding-dense{padding:4px}.pillbox--padding-none{padding:0}.pillbox--vertical{flex-direction:column;padding:6px}"],encapsulation:2,changeDetection:0}),e})();var vO=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},OO=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function wO(e,t){if(1&e){const e=i.Wb();i.Vb(0,"div",1),i.Vb(1,"app-pillbox",2),i.Vb(2,"button",3),i.cc("click",(function(){return i.xc(e),i.gc().handleUndoClick()})),i.hc(3,"async"),i.hc(4,"async"),i.Ub(),i.Vb(5,"button",4),i.cc("click",(function(){return i.xc(e),i.gc().handleRedoClick()})),i.hc(6,"async"),i.hc(7,"async"),i.Ub(),i.Vb(8,"button",5),i.cc("click",(function(){return i.xc(e),i.gc().handleResetClick()})),i.hc(9,"async"),i.hc(10,"async"),i.Vb(11,"span",6),i.Kc(12,"Reset"),i.Ub(),i.Ub(),i.Ub(),i.Ub()}if(2&e){const e=i.gc();i.lc("@show",void 0),i.Db(2),i.lc("disabled",!i.ic(4,9,e.canUndo$)),i.Eb("aria-disabled",!i.ic(3,7,e.canUndo$)),i.Db(3),i.lc("disabled",!i.ic(7,13,e.canRedo$)),i.Eb("aria-disabled",!i.ic(6,11,e.canRedo$)),i.Db(3),i.lc("disabled",!i.ic(10,17,e.canUndo$)),i.Eb("aria-disabled",!i.ic(9,15,e.canUndo$))}}let CO=(()=>{class e{constructor(e){this.viewService=e}ngOnInit(){}handleUndoClick(){this.viewService.undo()}handleRedoClick(){this.viewService.redo()}handleResetClick(){this.viewService.resetChapter()}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(Dl))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-undo"]],decls:2,vars:3,consts:[["class","view-undo",4,"ngIf"],[1,"view-undo"],["padding","dense"],["app-pin-button","","data-test","undo-btn","buttonType","ghost","icon","undo","aria-label","Undo","matTooltip","Undo",1,"mr-2",3,"disabled","click"],["buttonType","ghost","app-pin-button","","data-test","redo-btn","aria-label","Redo","matTooltip","Redo","icon","redo",1,"mr-2",3,"disabled","click"],["app-pin-button","","buttonShape","rounded","buttonType","ghost","data-test","reset-btn",3,"disabled","click"],[1,"ph-4","text-bold"]],template:function(e,t){1&e&&(i.Ic(0,wO,13,19,"div",0),i.hc(1,"async")),2&e&&i.lc("ngIf",i.ic(1,1,t.canUndo$))},directives:[Z.l,xO,ou,ru.c],pipes:[Z.b],styles:["[_nghost-%COMP%]{display:flex;justify-content:center;width:100%;padding:8px 0;pointer-events:none}"],data:{animation:[Object(Zl.n)("show",[Object(Zl.m)(":enter",Object(Zl.j)([Object(Zl.l)({transform:"translateY(-100%)",opacity:0}),Object(Zl.e)("150ms ease-in-out",Object(Zl.l)({transform:"translateY(0%)",opacity:1}))]))])]},changeDetection:0}),vO([Object(d.d)(hO.canUndo),OO("design:type",P.a)],e.prototype,"canUndo$",void 0),vO([Object(d.d)(hO.canRedo),OO("design:type",P.a)],e.prototype,"canRedo$",void 0),vO([Object(d.d)(hO.getUndoCount),OO("design:type",P.a)],e.prototype,"undoCount$",void 0),e})();var SO=n("PqYM"),_O=n("JX91"),jO=n("32Ea"),kO=n("gcYM"),PO=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},MO=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const IO=["scrubber"],zO=["track"],TO=["bar"],UO=["handle"],DO=function(e){return{"view-scrubber--draggable":e}},LO=function(e,t){return{"view-scrubber__handle--hide":e,"view-scrubber__handle-touch":t}};let EO=(()=>{class e{constructor(e,t,n,i,s,o){this.engineService=e,this.animationService=t,this.renderer=n,this.viewService=i,this.changeDetectorRef=s,this.store=o,this.showHandle=!0,this.ngUnsubscribe=new k.a,this.trackWidth=0,this.dragPosition={x:16,y:0},this.playing=!0}ngOnInit(){this.initChapterListener(),this.initTimelineListener()}ngAfterViewInit(){this.initDragListener()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initChapterListener(){this.selectedChapterId$.pipe(Object(I.a)(e=>null!=e),Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.timerange=this.animationService.getChapterLocalTimerange(e),this.tick(this.animationService.getTime())})}initTimelineListener(){this.engineService.getEvent(At.TimelinePlaying).pipe(Object(kO.a)(20),Object(M.a)(this.ngUnsubscribe)).subscribe(e=>this.tick(e.time)),this.engineService.getEvent(At.TimelineScrubbed).pipe(Object(kO.a)(20),Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{const t=this.getPercent(e.time);this.setScrubberBar(t)})}initDragListener(){this.dragInstance.moved.pipe(Object(Al.a)(20),Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{const t=this.calculateHandlePercent();this.scrubToPercent(t)})}handleDragStart(){this.playing=this.store.selectSnapshot(Er.getAnimationPlaying),this.store.dispatch(new at(!1))}handleDragEnd(){this.store.dispatch(new at(this.playing))}handleTrackClick(e){if(!this.showHandle)return;const t=e.offsetX/this.track.nativeElement.getBoundingClientRect().width*100;this.playing=this.store.selectSnapshot(Er.getAnimationPlaying),this.scrubToPercent(t),this.setScrubberBar(t),this.setScrubberHandle(t),this.store.dispatch(new at(this.playing))}tick(e){if(!this.timerange)return;const t=this.getPercent(e);this.setScrubberBar(t),this.setScrubberHandle(t)}getPercent(e){return this.animationService.getLocalTime(e)/this.timerange.lastTime*100}calculateHandlePercent(){const{left:e,right:t}=this.scrubber.nativeElement.getBoundingClientRect(),n=t-e-this.handle.nativeElement.offsetWidth,i=this.handle.nativeElement.getBoundingClientRect().left;return Math.min(Math.max((i-e)/n*100,0),100)}scrubToPercent(e){const t=e/100*this.timerange.lastTime,n=0===e?"second":"first",i=this.store.selectSnapshot(Or.getSelectedChapterId),s=this.animationService.mapLocalTimeToGlobal(i,t);this.animationService.scrub({time:s,which:n})}handlePlayClick(){this.viewService.toggleAnimation()}setScrubberBar(e){this.renderer.setStyle(this.bar.nativeElement,"width",e+"%")}setScrubberHandle(e){0===this.trackWidth&&(this.trackWidth=this.track.nativeElement.offsetWidth-32),this.showHandle&&(this.dragPosition=Object.assign(Object.assign({},this.dragPosition),{x:16+this.trackWidth*(e/100)}),this.changeDetectorRef.markForCheck())}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(Qt),i.Pb(eo),i.Pb(i.H),i.Pb(Dl),i.Pb(i.i),i.Pb(d.g))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-scrubber"]],viewQuery:function(e,t){if(1&e&&(i.Ec(IO,!0),i.Ec(zO,!0),i.Ec(TO,!0),i.Ec(UO,!0),i.Pc(So.a,!0)),2&e){let e;i.sc(e=i.dc())&&(t.scrubber=e.first),i.sc(e=i.dc())&&(t.track=e.first),i.sc(e=i.dc())&&(t.bar=e.first),i.sc(e=i.dc())&&(t.handle=e.first),i.sc(e=i.dc())&&(t.dragInstance=e.first)}},inputs:{showHandle:"showHandle"},decls:9,vars:10,consts:[[1,"view-scrubber",3,"ngClass"],["scrubber",""],[1,"view-scrubber__track",3,"click"],["track",""],[1,"view-scrubber__bar"],["bar",""],["cdkDrag","","cdkDragLockAxis","x","cdkDragBoundary",".view-scrubber",1,"view-scrubber__handle",3,"cdkDragFreeDragPosition","ngClass","cdkDragStarted","cdkDragEnded"],["handle",""]],template:function(e,t){1&e&&(i.Vb(0,"div",0,1),i.Vb(2,"div",2,3),i.cc("click",(function(e){return t.handleTrackClick(e)})),i.Qb(4,"div",4,5),i.Ub(),i.Vb(6,"div",6,7),i.cc("cdkDragStarted",(function(){return t.handleDragStart()}))("cdkDragEnded",(function(){return t.handleDragEnd()})),i.hc(8,"async"),i.Ub(),i.Ub()),2&e&&(i.lc("ngClass",i.nc(5,DO,t.showHandle)),i.Db(6),i.lc("cdkDragFreeDragPosition",t.dragPosition)("ngClass",i.oc(7,LO,!t.showHandle,i.ic(8,3,t.canTouch$))))},directives:[Z.i,So.a],pipes:[Z.b],styles:['.view-scrubber{position:relative;display:flex;justify-content:center;align-items:center;height:40px;width:100%}.view-scrubber:hover .view-scrubber__handle:after{opacity:1}.view-scrubber--draggable .view-scrubber__track{left:16px;right:16px}.view-scrubber__track{background:rgba(150,168,192,.6);z-index:1;right:0}.view-scrubber__bar,.view-scrubber__track{border-radius:2px;position:absolute;height:4px;left:0}.view-scrubber__bar{background:#374a68;z-index:2;width:0}.view-scrubber__handle{width:40px;height:40px;margin-left:-16px;left:0;display:flex;align-items:center;justify-content:center;position:absolute;z-index:2}.view-scrubber__handle--hide{display:none}.view-scrubber__handle:after{opacity:1;transition:opacity .25s;content:"";width:8px;height:8px;border-radius:4px;background:#374a68;box-shadow:1px -1px 2px 0 rgba(28,42,63,.1),0 1px 2px 0 rgba(28,42,63,.3)}.view-scrubber__handle:hover:after{background:#2d72dc}.view-scrubber__handle:hover{cursor:pointer}.view-scrubber__handle-touch:after{opacity:1}'],encapsulation:2,changeDetection:0}),PO([Object(d.d)(Er.getAnimationPlaying),MO("design:type",P.a)],e.prototype,"animationPlaying$",void 0),PO([Object(d.d)(Or.getSelectedChapterId),MO("design:type",P.a)],e.prototype,"selectedChapterId$",void 0),PO([Object(d.d)(mr.getCanTouch),MO("design:type",P.a)],e.prototype,"canTouch$",void 0),e})();var FO=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},AO=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function RO(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",9),i.cc("click",(function(){return i.xc(e),i.gc(2).handlePlayClick()})),i.hc(1,"async"),i.hc(2,"async"),i.Ub()}if(2&e){const e=i.gc(2);i.lc("matTooltip",i.ic(1,2,e.animationPlaying$)?"Pause":"Play")("icon",i.ic(2,4,e.animationPlaying$)?"pause":"play")}}function VO(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",10),i.cc("click",(function(){return i.xc(e),i.gc(2).handlePlayChapterFromStartClick()})),i.Ub()}}function NO(e,t){1&e&&i.Qb(0,"app-view-scrubber",11)}function BO(e,t){if(1&e&&(i.Vb(0,"div",3),i.Ic(1,RO,3,6,"button",4),i.Ic(2,VO,1,0,"button",5),i.Ic(3,NO,1,0,"app-view-scrubber",6),i.Vb(4,"button",7),i.Vb(5,"span",8),i.Kc(6),i.hc(7,"async"),i.Ub(),i.Ub(),i.Ub()),2&e){const e=i.gc(),t=i.tc(2);i.Db(1),i.lc("ngIf",e.showPlayPause),i.Db(1),i.lc("ngIf",e.showPlayPause),i.Db(1),i.lc("ngIf",e.showScrubber),i.Db(1),i.lc("matMenuTriggerFor",t),i.Db(2),i.Mc("",i.ic(7,5,e.playbackSpeed$),"x")}}let HO=(()=>{class e{constructor(e,t,n,i,s){this.animationService=e,this.viewService=t,this.layoutService=n,this.store=i,this.changeDetectorRef=s,this.viewLayout=Xa,this.size="small",this.showPlayPause=!0,this.showScrubber=!0,this.showBar=!0,this.ngUnsubscribe=new k.a}get template(){return this._template}set template(e){this._template=e,this.updateLayoutProperties(this.template)}ngOnInit(){this.initChapterListener()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initChapterListener(){this.selectedChapterId$.pipe(Object(I.a)(e=>null!=e),Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.timerange=this.animationService.getChapterLocalTimerange(e)})}updateLayoutProperties(e){this.showBar=e!==jo.None,this.showScrubber=e===jo.Full,this.showPlayPause=e!==jo.None}handlePlayClick(){this.viewService.toggleAnimation()}handlePlayChapterFromStartClick(){this.viewService.playChapterFromStart()}setPlaybackSpeed(e){this.store.dispatch(new lt(e))}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(eo),i.Pb(Dl),i.Pb(rc),i.Pb(d.g),i.Pb(i.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-media-bar"]],inputs:{template:"template",size:"size"},decls:11,vars:1,consts:[["class","view-media-bar",4,"ngIf"],["playbackMenu","matMenu"],["mat-menu-item","",3,"click"],[1,"view-media-bar"],["app-pin-button","","buttonType","ghost","data-test","Play/Pause__small","matTooltipPosition","above",3,"matTooltip","icon","click",4,"ngIf"],["app-pin-button","","buttonType","ghost","matTooltipPosition","above","matTooltip","Play Chapter from Start","icon","step-backward",3,"click",4,"ngIf"],["class","view-media-bar__scrubber","data-test","Scrub__small",4,"ngIf"],["app-pin-button","","buttonType","ghost","matTooltipPosition","above","matTooltip","Playback Speed",3,"matMenuTriggerFor"],[1,"text-semibold"],["app-pin-button","","buttonType","ghost","data-test","Play/Pause__small","matTooltipPosition","above",3,"matTooltip","icon","click"],["app-pin-button","","buttonType","ghost","matTooltipPosition","above","matTooltip","Play Chapter from Start","icon","step-backward",3,"click"],["data-test","Scrub__small",1,"view-media-bar__scrubber"]],template:function(e,t){1&e&&(i.Ic(0,BO,8,7,"div",0),i.Vb(1,"mat-menu",null,1),i.Vb(3,"button",2),i.cc("click",(function(){return t.setPlaybackSpeed(1)})),i.Kc(4,"Normal"),i.Ub(),i.Vb(5,"button",2),i.cc("click",(function(){return t.setPlaybackSpeed(.5)})),i.Kc(6,"0.5"),i.Ub(),i.Vb(7,"button",2),i.cc("click",(function(){return t.setPlaybackSpeed(.25)})),i.Kc(8,"0.25"),i.Ub(),i.Vb(9,"button",2),i.cc("click",(function(){return t.setPlaybackSpeed(.1)})),i.Kc(10,"0.1"),i.Ub(),i.Ub()),2&e&&i.lc("ngIf",t.showBar)},directives:[Z.l,gd.a,gd.b,ou,ru.c,gd.d,EO],pipes:[Z.b],styles:[".view-media-bar{display:flex}.view-media-bar__scrubber{width:120px;display:flex;justify-content:center;align-items:center}"],encapsulation:2,changeDetection:0}),FO([Object(d.d)(Er.getAnimationPlaying),AO("design:type",P.a)],e.prototype,"animationPlaying$",void 0),FO([Object(d.d)(Or.getSelectedChapterId),AO("design:type",P.a)],e.prototype,"selectedChapterId$",void 0),FO([Object(d.d)(Er.getPlaybackSpeed),AO("design:type",P.a)],e.prototype,"playbackSpeed$",void 0),e})();var QO=n("rDax");class $O{constructor(e,t,n){this.overlay=e,this.content=t,this.data=n,this.afterClosed=new k.a,this.afterClosed$=this.afterClosed.asObservable(),e.backdropClick().subscribe(()=>this._close("backdropClick",n)),this.entered$=Object(Do.a)(Object(Uo.a)(e.overlayElement,"mouseenter"),Object(Uo.a)(e.overlayElement,"mouseleave")).pipe(Object(F.a)(e=>"mouseenter"===e.type),Object(M.a)(this.afterClosed$))}close(e){this._close("close",e)}_close(e,t){this.overlay.dispose(),this.afterClosed.next({type:e,data:t}),this.afterClosed.complete()}}var qO=n("+rOU");function WO(e,t){if(1&e&&i.Qb(0,"div",4),2&e){const e=i.gc();i.lc("innerHTML",e.content,i.yc)}}function KO(e,t){1&e&&i.Rb(0)}function GO(e,t){if(1&e&&(i.Tb(0),i.Ic(1,KO,1,0,"ng-container",5),i.Sb()),2&e){const e=i.gc();i.Db(1),i.lc("ngTemplateOutlet",e.content)("ngTemplateOutletContext",e.context)}}function ZO(e,t){1&e&&i.Rb(0)}function JO(e,t){if(1&e&&(i.Tb(0),i.Ic(1,ZO,1,0,"ng-container",6),i.Sb()),2&e){const e=i.gc();i.Db(1),i.lc("ngComponentOutlet",e.content)}}let XO=(()=>{class e{constructor(e){this.popupRef=e,this.renderMethod="component"}ngOnInit(){this.content=this.popupRef.content,"string"==typeof this.content?this.renderMethod="text":this.content instanceof i.O&&(this.renderMethod="template",this.context={close:this.popupRef.close.bind(this.popupRef)})}}return e.\u0275fac=function(t){return new(t||e)(i.Pb($O))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-popup"]],decls:5,vars:4,consts:[[1,"popup"],[3,"ngSwitch"],[3,"innerHTML",4,"ngSwitchCase"],[4,"ngSwitchCase"],[3,"innerHTML"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[4,"ngComponentOutlet"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Tb(1,1),i.Ic(2,WO,1,1,"div",2),i.Ic(3,GO,2,2,"ng-container",3),i.Ic(4,JO,2,1,"ng-container",3),i.Sb(),i.Ub()),2&e&&(i.Db(1),i.lc("ngSwitch",t.renderMethod),i.Db(1),i.lc("ngSwitchCase","text"),i.Db(1),i.lc("ngSwitchCase","template"),i.Db(1),i.lc("ngSwitchCase","component"))},directives:[Z.n,Z.o,Z.q,Z.j],styles:["[_nghost-%COMP%]{width:100%;height:100%}.popup[_ngcontent-%COMP%]{background:#fff;border-radius:4px;padding:8px;overflow-y:auto;box-shadow:1px -1px 2px 0 rgba(28,42,63,.1),0 1px 2px 0 rgba(28,42,63,.3)}"],changeDetection:0}),e})();var YO=function(e){return e.Above="above",e.Below="below",e.Left="left",e.Right="right",e}({});const ew={[YO.Above]:{originX:"center",originY:"top",overlayX:"center",overlayY:"bottom",offsetY:-12},[YO.Below]:{originX:"center",originY:"bottom",overlayX:"center",overlayY:"top",offsetY:12},[YO.Left]:{originX:"start",originY:"center",overlayX:"end",overlayY:"center",offsetX:-12},[YO.Right]:{originX:"end",originY:"center",overlayX:"start",overlayY:"center",offsetX:12}};let tw=(()=>{class e{constructor(e,t){this.overlay=e,this.injector=t}open(e){const{origin:t,content:n,data:i,width:s,height:o,hasBackdrop:r}=e,a=this.overlay.create(this.getOverlayConfig({origin:t,width:s,height:o,hasBackdrop:r})),c=new $O(a,n,i),l=this.createInjector(c,this.injector);return a.attach(new qO.c(XO,null,l)),c}createInjector(e,t){const n=new WeakMap([[$O,e]]);return new qO.e(t,n)}getPositionStrategy(e,t){return this.overlay.position().flexibleConnectedTo(e).withPositions(this.getPositions(t))}getOverlayConfig({origin:e,width:t,height:n,hasBackdrop:i}){return new QO.d({width:t,height:n,hasBackdrop:null==i||i,backdropClass:"popup-scrim",positionStrategy:this.getOverlayPosition(e),scrollStrategy:this.overlay.scrollStrategies.reposition()})}getOverlayPosition(e,t){return t=t||[YO.Above,YO.Below,YO.Left,YO.Right],this.overlay.position().flexibleConnectedTo(e).withPositions(this.getPositions(t)).withPush(!0)}getPositions(e){return e.map(e=>ew[e])}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(QO.c),i.Zb(i.t))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const nw=()=>window.navigator.userAgent.includes("Trident");let iw=(()=>{class e{constructor(e,t){this.el=e,this.renderer=t}ngOnInit(){nw()&&this.renderer.setStyle(this.el.nativeElement,"display","none")}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(i.m),i.Pb(i.H))},e.\u0275dir=i.Kb({type:e,selectors:[["","appHideIE11",""]]}),e})();var sw=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},ow=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const rw=["chapterCount"],aw=["mediaToggle"];function cw(e,t){if(1&e){const e=i.Wb();i.Vb(0,"div",4),i.Vb(1,"button",5),i.cc("click",(function(){return i.xc(e),i.gc(2).handlePreviousClick()})),i.hc(2,"async"),i.hc(3,"async"),i.hc(4,"async"),i.hc(5,"async"),i.Ub(),i.Vb(6,"button",6),i.cc("click",(function(){return i.xc(e),i.gc(2).handleNextClick()})),i.hc(7,"async"),i.hc(8,"async"),i.hc(9,"async"),i.hc(10,"async"),i.hc(11,"async"),i.hc(12,"async"),i.Ub(),i.Ub()}if(2&e){const e=i.gc(2);let t=null,n=null;i.Db(1),i.lc("disabled",0===i.ic(2,6,e.chapterIndex$))("matTooltip",i.ic(4,10,e.previousChapter$)?"Previous: "+(null==(t=i.ic(5,12,e.previousChapter$))?null:t.info.displayName):""),i.Eb("aria-disabled",0===i.ic(3,8,e.chapterIndex$)),i.Db(5),i.lc("disabled",i.ic(9,18,e.chapterIndex$)===i.ic(10,20,e.chapterCount$)-1)("matTooltip",i.ic(11,22,e.nextChapter$)?"Next: "+(null==(n=i.ic(12,24,e.nextChapter$))?null:n.info.displayName):""),i.Eb("aria-disabled",i.ic(7,14,e.chapterIndex$)===i.ic(8,16,e.chapterCount$)-1)}}function lw(e,t){if(1&e&&(i.Vb(0,"div",7),i.Vb(1,"app-view-chapters",8),i.Vb(2,"div",9),i.Kc(3),i.hc(4,"async"),i.hc(5,"async"),i.Qb(6,"app-icon",10),i.Ub(),i.Vb(7,"span",11),i.Kc(8),i.hc(9,"async"),i.hc(10,"async"),i.Ub(),i.Ub(),i.Ub()),2&e){const e=i.gc(2);i.Db(3),i.Nc(" ",i.ic(4,4,e.chapterIndex$)+1," of ",i.ic(5,6,e.chapterCount$)," "),i.Db(5),i.Nc(" Toggle Chapter List, Chapter ",i.ic(9,8,e.chapterIndex$)+1," of ",i.ic(10,10,e.chapterCount$)," ")}}function pw(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",14),i.cc("click",(function(){return i.xc(e),i.gc(3).handlePlayClick()})),i.hc(1,"async"),i.hc(2,"async"),i.hc(3,"async"),i.Ub()}if(2&e){const e=i.gc(3);i.lc("icon",i.ic(1,3,e.animationPlaying$)?"pause":"play")("matTooltip",i.ic(3,7,e.animationPlaying$)?"Pause Animation":"Play Animation"),i.Eb("aria-label",i.ic(2,5,e.animationPlaying$)?"Pause Animation":"Play Animation")}}function dw(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",15),i.cc("click",(function(){return i.xc(e),i.gc(3).toggleToolbar("media")})),i.Qb(1,"app-view-scrubber",16),i.Ub()}2&e&&(i.Db(1),i.lc("showHandle",!1))}function uw(e,t){if(1&e&&(i.Vb(0,"div",7),i.Ic(1,pw,4,9,"button",12),i.Ic(2,dw,2,1,"button",13),i.Ub()),2&e){const e=i.gc(2);i.Db(1),i.lc("ngIf",e.isVisible(e.viewUI.Media)),i.Db(1),i.lc("ngIf",e.isVisible(e.viewUI.ScrubberButton))}}function gw(e,t){if(1&e&&(i.Tb(0),i.Ic(1,cw,13,26,"div",2),i.Ic(2,lw,11,12,"div",3),i.Ic(3,uw,3,2,"div",3),i.Sb()),2&e){const e=i.gc();i.Db(1),i.lc("ngIf",e.paginationVisible),i.Db(1),i.lc("ngIf",e.paginationVisible&&!e.collapsePagination),i.Db(1),i.lc("ngIf",e.mediaVisible)}}function hw(e,t){if(1&e){const e=i.Wb();i.Tb(0),i.Vb(1,"div",7),i.Vb(2,"div",17),i.Vb(3,"button",18),i.cc("click",(function(){i.xc(e);const t=i.gc();return t.handleSelectTool(t.toolEnum.Select)})),i.hc(4,"async"),i.hc(5,"async"),i.Ub(),i.Vb(6,"button",19),i.cc("click",(function(){i.xc(e);const t=i.gc();return t.handleSelectTool(t.toolEnum.Hide)})),i.hc(7,"async"),i.hc(8,"async"),i.Ub(),i.Vb(9,"button",20),i.cc("click",(function(){i.xc(e);const t=i.gc();return t.handleSelectTool(t.toolEnum.Fade)})),i.hc(10,"async"),i.hc(11,"async"),i.Ub(),i.Ub(),i.Ub(),i.Sb()}if(2&e){const e=i.gc();i.Db(3),i.lc("selected",i.ic(4,6,e.activeTool$)===e.toolEnum.Select),i.Eb("aria-pressed",i.ic(5,8,e.activeTool$)===e.toolEnum.Select),i.Db(3),i.lc("selected",i.ic(7,10,e.activeTool$)===e.toolEnum.Hide),i.Eb("aria-pressed",i.ic(8,12,e.activeTool$)===e.toolEnum.Hide),i.Db(3),i.lc("selected",i.ic(10,14,e.activeTool$)===e.toolEnum.Fade),i.Eb("aria-pressed",i.ic(11,16,e.activeTool$)===e.toolEnum.Fade)}}let bw=(()=>{class e{constructor(e,t,n,s,o,r){this.viewService=e,this.viewUIService=t,this.store=n,this.changeDetectorRef=s,this.popupService=o,this.ga=r,this.viewToolsMode=Fg,this.viewUI=Xa,this.breakpointEnum=$a,this.canFullscreen=!0,this.isFullscreen=!1,this.toolEnum=kr,this.mediaControlsEnum=jo,this.paginationVisible=!1,this.mediaVisible=!1,this.ngUnsubscribe=new k.a,this.animate=!0,this._mode=Fg.Main,this.collapsePagination=!1,this.collapseScrubber=!1,this.modeChange=new i.p}get mode(){return this._mode}set mode(e){this._mode=e}ngOnInit(){this.canFullscreen=Io.canFullscreen(),this.initLayoutListener(),this.initBreakpointListener(),this.initFullscreenListener()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initLayoutListener(){this.store.select(mr.getUI).pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.mediaTemplate=e.media.template,this.paginationVisible=this.viewUIService.isVisible(Xa.Pagination),this.mediaVisible=this.viewUIService.isVisible(Xa.Media),this.changeDetectorRef.markForCheck()})}initBreakpointListener(){this.store.select(Ja.getBreakpoint).pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.breakpoint=e,this.changeDetectorRef.markForCheck()})}initFullscreenListener(){this.fullscreen$=Io.onFullscreenChange(),this.fullscreen$.pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.isFullscreen=Io.isFullscreen(),this.changeDetectorRef.markForCheck()})}handleSelectTool(e){const t=this.store.selectSnapshot(Er.getActiveTool);this.viewService.selectTool(e===t?kr.Select:e)}handlePlayClick(){this.viewService.toggleAnimation()}handleMenuClick(){this.store.dispatch(new j.ToggleMenu(!0))}handlePreviousClick(){this.viewService.previousChapter("Toolbar")}handleNextClick(){this.viewService.nextChapter("Toolbar")}handleMediaClick(){this.toggleMediaPopup()}toggleMediaPopup(){this.mediaPopup?this.mediaPopup.close():(this.mediaPopup=this.popupService.open({origin:this.mediaToggle.nativeElement,content:HO,width:"300px"}),this.mediaPopup.afterClosed$.pipe(Object(M.a)(this.ngUnsubscribe),Object(Ua.a)(1)).subscribe(e=>{this.mediaPopup=null}))}toggleToolbar(e){this.viewService.toggleToolbar(e)}isEnabled(e){return this.viewUIService.isUIEnabled(e)}isVisible(e){return this.viewUIService.isVisible(e)}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(Dl),i.Pb(rc),i.Pb(d.g),i.Pb(i.i),i.Pb(tw),i.Pb(U.c))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-tools"]],viewQuery:function(e,t){if(1&e&&(i.Pc(rw,!0),i.Pc(aw,!0)),2&e){let e;i.sc(e=i.dc())&&(t.chapterCount=e.first),i.sc(e=i.dc())&&(t.mediaToggle=e.first)}},inputs:{animate:"animate",mode:"mode",collapsePagination:"collapsePagination",collapseScrubber:"collapseScrubber"},outputs:{modeChange:"modeChange"},features:[i.Cb([tw])],decls:3,vars:2,consts:[["role","toolbar","aria-label","Tools","data-test","viewTools",1,"view-tools"],[4,"ngIf"],["class","view-tools__group","role","navigation","aria-label","Chapters",4,"ngIf"],["class","view-tools__group",4,"ngIf"],["role","navigation","aria-label","Chapters",1,"view-tools__group"],["data-test","viewToolsPreviousChapter","aria-label","Previous Chapter","app-pin-button","","buttonType","ghost","icon","chevron-left",1,"view-tools__item",3,"disabled","matTooltip","click"],["data-test","viewToolsNextChapter","aria-label","Next Chapter","app-pin-button","","buttonType","ghost","icon","chevron-right",1,"view-tools__item",3,"disabled","matTooltip","click"],[1,"view-tools__group"],["buttonShape","rounded"],["aria-hidden","true",1,"ph-2","text-13","text-semibold",2,"white-space","nowrap"],["icon","caret-up",1,"ml-2"],[1,"visually-hidden"],["data-test","viewToolsPlay","app-pin-button","","buttonType","ghost","class","view-tools__item",3,"icon","matTooltip","click",4,"ngIf"],["data-test","viewToolsMedia","app-pin-button","","buttonType","ghost","class","view-tools__item","aria-label","Open Media Bar","matTooltip","Open Media Bar",3,"click",4,"ngIf"],["data-test","viewToolsPlay","app-pin-button","","buttonType","ghost",1,"view-tools__item",3,"icon","matTooltip","click"],["data-test","viewToolsMedia","app-pin-button","","buttonType","ghost","aria-label","Open Media Bar","matTooltip","Open Media Bar",1,"view-tools__item",3,"click"],[2,"width","32px","margin","0 8px",3,"showHandle"],["role","radiogroup",1,"flex"],["app-pin-button","","buttonType","ghost","icon","mouse-pointer","aria-label","Select","matTooltip","Select","data-test","viewToolsSelect",1,"view-tools__item",3,"selected","click"],["app-pin-button","","buttonType","ghost","icon","eye-slash","aria-label","Hide","matTooltip","Hide","data-test","viewToolsHide",1,"view-tools__item",3,"selected","click"],["app-pin-button","","appHideIE11","","buttonType","ghost","aria-label","Fade","matTooltip","Fade","icon","adjust","data-test","viewToolsFade",1,"view-tools__item",3,"selected","click"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Ic(1,gw,4,3,"ng-container",1),i.Ic(2,hw,12,18,"ng-container",1),i.Ub()),2&e&&(i.Db(1),i.lc("ngIf",t.mode===t.viewToolsMode.Main),i.Db(1),i.lc("ngIf",t.mode===t.viewToolsMode.Tools))},directives:[Z.l,ou,ru.c,Xg,dl,EO,iw],pipes:[Z.b],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3535}.text-info{color:#2d72dc}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.view-tools{display:flex;justify-content:center;overflow:hidden}@-webkit-keyframes viewToolsToggle{0%{opacity:1}50%{opacity:0}to{opacity:1}}@keyframes viewToolsToggle{0%{opacity:1}50%{opacity:0}to{opacity:1}}.view-tools--swap{-webkit-animation:viewToolsToggle .3s ease-in-out;animation:viewToolsToggle .3s ease-in-out}.view-tools--dense .view-tools__divider{margin:4px}.view-tools__inner{display:flex;justify-content:center}.view-tools__group{border-right:1px solid rgba(0,0,0,.1);padding:0 8px;display:flex}.view-tools__group:empty{display:none}.view-tools__group:empty:first-of-type+.view-tools__group:not(:empty),.view-tools__group:first-of-type{padding-left:0}.view-tools__group:last-of-type{border-right:none;padding-right:0}.view-tools__item{display:flex;align-items:center}.view-tools__item:not(:last-child){margin-right:4px}.view-tools__divider{border-right:1px solid rgba(0,0,0,.1);margin:4px 8px}.view-tools__count{font-size:12px;letter-spacing:.3px;line-height:1.4em;white-space:nowrap}"],encapsulation:2,changeDetection:0}),sw([Object(d.d)(Or.getSelectedChapterReadyState),ow("design:type",P.a)],e.prototype,"selectedChapterReady$",void 0),sw([Object(d.d)(Er.getActiveTool),ow("design:type",P.a)],e.prototype,"activeTool$",void 0),sw([Object(d.d)(mr.getPresentationActive),ow("design:type",P.a)],e.prototype,"presentationActive$",void 0),sw([Object(d.d)(Or.getIsChapterAnimated),ow("design:type",P.a)],e.prototype,"isChapterAnimated$",void 0),sw([Object(d.d)(Er.getShowLabels),ow("design:type",P.a)],e.prototype,"showLabels$",void 0),sw([Object(d.d)(Er.getAnimationPlaying),ow("design:type",P.a)],e.prototype,"animationPlaying$",void 0),sw([Object(d.d)(Ca.getChapterLabels),ow("design:type",P.a)],e.prototype,"labels$",void 0),sw([Object(d.d)(Or.getSelectedChapterTitle),ow("design:type",P.a)],e.prototype,"chapterTitle$",void 0),sw([Object(d.d)(Or.getSelectedChapterIndex),ow("design:type",P.a)],e.prototype,"chapterIndex$",void 0),sw([Object(d.d)(Or.getNextChapter),ow("design:type",P.a)],e.prototype,"nextChapter$",void 0),sw([Object(d.d)(Or.getPreviousChapter),ow("design:type",P.a)],e.prototype,"previousChapter$",void 0),sw([Object(d.d)(Or.getChapterCount),ow("design:type",P.a)],e.prototype,"chapterCount$",void 0),sw([Object(d.d)(mr.getCanTouch),ow("design:type",P.a)],e.prototype,"canTouch$",void 0),e})();var mw=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},fw=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const yw=["slider"],xw=["track"],vw=["bar"],Ow=["handle"],ww=function(e){return{"view-layers-slider__handle-touch":e}};let Cw=(()=>{class e{constructor(e,t,n){this.renderer=e,this.visibilityLayersService=t,this.changeDetectorRef=n,this.ngUnsubscribe=new k.a,this.currentLayers=[],this.fullOffset=0,this.dragMove=new k.a,this.dragPosition={x:0,y:0},this.currentLayerName="",this.currentOffset=0}ngOnInit(){this.initLayersObserver(),this.initIndexPositionObserver(),this.initDragMoveObserver()}ngAfterViewInit(){setTimeout(()=>{this.handle.nativeElement.focus()},200),this.fullOffset=this.track.nativeElement.offsetWidth}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initLayersObserver(){this.selectedChapterCurrentLayers$.pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.currentLayers=e})}initIndexPositionObserver(){Object(Ta.b)([this.selectedChapterCurrentLayersIndex$,this.selectedChapterCurrentLayersPosition$,this.selectedChapterCurrentLayers$]).pipe(Object(I.a)(([e,t,n])=>!Object(D.isNil)(e)&&!Object(D.isNil)(t)&&!Object(D.isNil)(n)),Object(El.a)(0),Object(M.a)(this.ngUnsubscribe)).subscribe(([e,t,n])=>{this.currentLayerName=n[e].name;const i=this.visibilityLayersService.indexPositionToFraction(e,t);this.currentOffset=Math.round(100*i),this.setSliderBar(i),this.setSliderHandle(i)})}initDragMoveObserver(){this.dragMove.pipe(Object(Al.a)(20),Object(M.a)(this.ngUnsubscribe)).subscribe(()=>this.handleAuditedDrag())}handleDragEnded(){const e=this.calculateHandleFraction(),t=this.visibilityLayersService.fractionToIndex(e),n=this.visibilityLayersService.fractionToPosition(e,t);this.visibilityLayersService.recordLayerIndexPosition(t,n)}handleDragMoved(e){this.dragMove.next(e)}handleAuditedDrag(){const e=this.calculateHandleFraction(),t=this.visibilityLayersService.fractionToIndex(e),n=this.visibilityLayersService.fractionToPosition(e,t);this.currentLayerName=this.currentLayers[t].name,this.visibilityLayersService.synchronizeScene(t,n,!1),this.setSliderBar(e)}handleTrackClick(e){const t=e.offsetX/this.fullOffset,n=this.visibilityLayersService.fractionToIndex(t),i=this.visibilityLayersService.fractionToPosition(t,n);this.visibilityLayersService.recordLayerIndexPosition(n,i)}handleKeyDown(e){switch(e.key){case"Home":this.handleIncriment(-1),e.stopPropagation();break;case"End":this.handleIncriment(1),e.stopPropagation();break;case"PageDown":this.handleIncriment(-.1),e.stopPropagation();break;case"PageUp":this.handleIncriment(.1),e.stopPropagation();break;case"ArrowLeft":case"ArrowDown":this.handleIncriment(-.01),e.stopPropagation();break;case"ArrowRight":case"ArrowUp":this.handleIncriment(.01),e.stopPropagation()}}handleIncriment(e){const t=Object(D.clamp)(this.calculateHandleFraction()+e,0,1),n=this.visibilityLayersService.fractionToIndex(t),i=this.visibilityLayersService.fractionToPosition(t,n);this.visibilityLayersService.recordLayerIndexPosition(n,i)}calculateHandleFraction(){const e=this.slider.nativeElement.getBoundingClientRect();return(this.handle.nativeElement.getBoundingClientRect().left-e.left)/this.fullOffset}setSliderBar(e){this.renderer.setStyle(this.bar.nativeElement,"width",100*e+"%")}setSliderHandle(e){this.dragPosition={x:e*this.fullOffset,y:this.dragPosition.y},this.changeDetectorRef.markForCheck()}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(i.H),i.Pb(ql),i.Pb(i.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-layers-slider"]],viewQuery:function(e,t){if(1&e&&(i.Ec(yw,!0),i.Ec(xw,!0),i.Ec(vw,!0),i.Ec(Ow,!0)),2&e){let e;i.sc(e=i.dc())&&(t.slider=e.first),i.sc(e=i.dc())&&(t.track=e.first),i.sc(e=i.dc())&&(t.bar=e.first),i.sc(e=i.dc())&&(t.handle=e.first)}},decls:9,vars:8,consts:[[1,"view-layers-slider"],["slider",""],[1,"view-layers-slider__track",3,"click"],["track",""],[1,"view-layers-slider__bar"],["bar",""],["cdkDrag","","cdkDragLockAxis","x","cdkDragBoundary",".view-layers-slider","role","slider","tabindex","0","aria-valuemin","0","aria-valuemax","100",1,"view-layers-slider__handle",3,"cdkDragFreeDragPosition","ngClass","matTooltip","cdkDragEnded","cdkDragMoved","keydown"],["handle",""]],template:function(e,t){1&e&&(i.Vb(0,"div",0,1),i.Vb(2,"div",2,3),i.cc("click",(function(e){return t.handleTrackClick(e)})),i.Qb(4,"div",4,5),i.Ub(),i.Vb(6,"div",6,7),i.cc("cdkDragEnded",(function(){return t.handleDragEnded()}))("cdkDragMoved",(function(e){return t.handleDragMoved(e)}))("keydown",(function(e){return t.handleKeyDown(e)})),i.hc(8,"async"),i.Ub(),i.Ub()),2&e&&(i.Db(6),i.lc("cdkDragFreeDragPosition",t.dragPosition)("ngClass",i.nc(6,ww,i.ic(8,4,t.canTouch$)))("matTooltip",t.currentLayerName),i.Eb("aria-valuenow",t.currentOffset))},directives:[So.a,Z.i,ru.c],pipes:[Z.b],styles:['.view-layers-slider[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;height:28px;width:100%}.view-layers-slider__track[_ngcontent-%COMP%]{position:absolute;background:rgba(150,168,192,.6);z-index:1;height:5px;border-radius:5px;left:14px;right:14px}.view-layers-slider__bar[_ngcontent-%COMP%]{position:absolute;background:#374a68;height:5px;border-radius:5px;z-index:2;width:0;left:0;pointer-events:none}.view-layers-slider__handle[_ngcontent-%COMP%]{width:28px;height:28px;margin-left:-14px;left:14px;display:flex;align-items:center;justify-content:center;position:absolute;z-index:2}.view-layers-slider__handle--hide[_ngcontent-%COMP%]{display:none}.view-layers-slider__handle[_ngcontent-%COMP%]:after{content:"";width:12px;height:12px;border-radius:6px;background:#374a68;box-shadow:1px -1px 2px 0 rgba(28,42,63,.1),0 1px 2px 0 rgba(28,42,63,.3)}.view-layers-slider__handle[_ngcontent-%COMP%]:hover:after{background:#2d72dc}'],changeDetection:0}),mw([Object(d.d)(Or.getSelectedChapterCurrentLayers),fw("design:type",P.a)],e.prototype,"selectedChapterCurrentLayers$",void 0),mw([Object(d.d)(Or.getSelectedChapterCurrentLayersIndex),fw("design:type",P.a)],e.prototype,"selectedChapterCurrentLayersIndex$",void 0),mw([Object(d.d)(Or.getSelectedChapterCurrentLayersPosition),fw("design:type",P.a)],e.prototype,"selectedChapterCurrentLayersPosition$",void 0),mw([Object(d.d)(mr.getCanTouch),fw("design:type",P.a)],e.prototype,"canTouch$",void 0),e})();const Sw=function(e,t,n){return{"view-layers-bar__slider--large":e,"view-layers-bar__slider--small":t,"view-layers-bar__slider--disabled":n}};let _w=(()=>{class e{constructor(e,t,n){this.store=e,this.engineService=t,this.changeDetectorRef=n,this.ngUnsubscribe=new k.a,this.assetsLoading=!1}ngOnInit(){this.engineService.getEvent(At.AssetsLoadProgress).pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.assetsLoading=e.requestedAssets!==e.receivedAssets,this.changeDetectorRef.markForCheck()})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}isLarge(){return this.store.selectSnapshot(Ja.getBreakpoint)>=$a.Medium}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.g),i.Pb(Qt),i.Pb(i.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-layers-bar"]],decls:2,vars:5,consts:[[1,"view-layers-bar"],[1,"view-layers-bar__slider",3,"ngClass"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Qb(1,"app-view-layers-slider",1),i.Ub()),2&e&&(i.Db(1),i.lc("ngClass",i.pc(1,Sw,t.isLarge(),!t.isLarge(),t.assetsLoading)))},directives:[Cw,Z.i],styles:[".view-layers-bar[_ngcontent-%COMP%]{display:flex}.view-layers-bar__slider[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;margin-left:4px}.view-layers-bar__slider--large[_ngcontent-%COMP%]{width:300px}.view-layers-bar__slider--small[_ngcontent-%COMP%]{width:180px}.view-layers-bar__slider--disabled[_ngcontent-%COMP%]{opacity:.25;pointer-events:none}"],changeDetection:0}),e})();const jw=["viewToolbar"],kw=["exploreTrigger"];function Pw(e,t){if(1&e&&(i.Vb(0,"app-pillbox",6),i.Qb(1,"app-view-tools",7),i.Ub()),2&e){const e=i.gc(2);i.Db(1),i.lc("collapsePagination",e.collapsePagination)("collapseScrubber",e.collapseScrubber)("mode",e.viewToolsMode.Main)}}function Mw(e,t){if(1&e){const e=i.Wb();i.Vb(0,"app-pillbox",8),i.Vb(1,"button",9,10),i.cc("click",(function(){return i.xc(e),i.gc(2).handleExploreToolsClick()})),i.Ub(),i.Ub()}2&e&&(i.Db(1),i.lc("matTooltip","Explore"),i.Eb("aria-label","Explore"))}function Iw(e,t){if(1&e&&(i.Vb(0,"div",3),i.Ic(1,Pw,2,3,"app-pillbox",4),i.Ic(2,Mw,3,2,"app-pillbox",5),i.Ub()),2&e){const e=i.gc();i.lc("@inOutAnimation",void 0),i.Db(1),i.lc("ngIf",e.isVisible(e.viewUI.Pagination)||e.isVisible(e.viewUI.Mediabar)),i.Db(1),i.lc("ngIf",e.isEnabled(e.viewUI.Tools))}}function zw(e,t){if(1&e){const e=i.Wb();i.Vb(0,"div",3),i.Vb(1,"app-pillbox",11),i.cc("exit",(function(){return i.xc(e),i.gc().handleExitClick()})),i.Qb(2,"app-view-media-bar",12),i.Ub(),i.Ub()}if(2&e){const e=i.gc();i.lc("@inOutAnimation",void 0),i.Db(1),i.lc("canExit",e.canExit),i.Db(1),i.lc("template",e.mediaTemplate)}}function Tw(e,t){if(1&e){const e=i.Wb();i.Vb(0,"div",3),i.Vb(1,"app-pillbox",13),i.cc("exit",(function(){return i.xc(e),i.gc().handleExitClick()})),i.Qb(2,"app-view-tools",14),i.Ub(),i.Ub()}if(2&e){const e=i.gc();i.lc("@inOutAnimation",void 0),i.Db(1),i.lc("canExit",e.canExit),i.Db(1),i.lc("mode",e.viewToolsMode.Tools)}}function Uw(e,t){if(1&e){const e=i.Wb();i.Vb(0,"div",3),i.Vb(1,"app-pillbox",15),i.cc("exit",(function(){return i.xc(e),i.gc().handleExitClick()})),i.Qb(2,"app-view-layers-bar"),i.Ub(),i.Ub()}if(2&e){const e=i.gc();i.lc("@inOutAnimation",void 0),i.Db(1),i.lc("canExit",e.canExit)}}let Dw=(()=>{class e{constructor(e,t,n,i,s){this.store=e,this.changeDetectorRef=t,this.viewService=n,this.viewUIService=i,this.elementRef=s,this.viewUI=Xa,this.canExit=!0,this.mode=Fg.Main,this.lockMode=!1,this.position="center",this.ngUnsubscribe=new k.a,this.breakpoint=$a,this.viewToolsMode=Fg,this.viewLayout=Xa,this.collapsePagination=!1,this.collapseScrubber=!1,this.modeSubject=new bl.a(Fg.Main)}ngOnInit(){this.initLayoutListener(),this.initBreakpointListener(),this.initFocusListeners()}initLayoutListener(){this.store.select(mr.getUI).pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.lockMode||(this.mode=Fg.Main,this.viewUIService.isUIVisible(Xa.Media)&&(this.mediaTemplate=e.media.template,this.mode=Fg.Media),this.viewUIService.isToolsVisible()&&(this.mode=Fg.Tools),this.viewUIService.isVisibilityLayersVisible()&&this.viewUIService.isUIVisible(Xa.VisibilityLayers)&&(this.mode=Fg.VisibilityLayers),this.modeSubject.next(this.mode),this.changeDetectorRef.markForCheck())})}initBreakpointListener(){this.store.select(Ja.getBreakpoint).pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{const t=e<=$a.Small;this.collapseScrubber=t,this.collapsePagination=t,this.changeDetectorRef.markForCheck()})}initFocusListeners(){const e=this.modeSubject.asObservable().pipe(Object(_O.a)(this.mode),Object(ml.a)(),Object(I.a)(([e,t])=>e===Fg.Tools&&t===Fg.Main),Object(qa.a)(),Object(M.a)(this.ngUnsubscribe));Object(Uo.a)(this.elementRef.nativeElement,"keypress").pipe(Object(jO.a)(()=>this.mode===Fg.Tools),Object(oa.a)(()=>e.pipe(Object(M.a)(Object(SO.a)(125)))),Object(El.a)(301),Object(M.a)(this.ngUnsubscribe)).subscribe(()=>{this.exploreTrigger&&this.exploreTrigger.focus()})}isVisible(e){return this.viewUIService.isVisible(e)}isEnabled(e){return this.viewUIService.isUIEnabled(e)}handleExitClick(){const e=this.store.selectSnapshot(mr.getUI);e.media.status=_o.Hide,e.tools.status=_o.Hide,e.visibilityLayers.status=_o.Hide,this.viewService.selectTool(kr.Select),this.store.dispatch(new j.SetUI(e))}handleExploreToolsClick(){this.viewService.toggleToolbar("tools")}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.g),i.Pb(i.i),i.Pb(Dl),i.Pb(rc),i.Pb(i.m))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-toolbar"]],viewQuery:function(e,t){if(1&e&&(i.Pc(jw,!0),i.Pc(kw,!0)),2&e){let e;i.sc(e=i.dc())&&(t.viewToolbar=e.first),i.sc(e=i.dc())&&(t.exploreTrigger=e.first)}},inputs:{canExit:"canExit",mode:"mode",lockMode:"lockMode",position:"position"},decls:5,vars:4,consts:[[3,"ngSwitch"],["data-test","viewToolbar","class","view-toolbar",4,"ngSwitchDefault"],["data-test","viewToolbar","class","view-toolbar",4,"ngSwitchCase"],["data-test","viewToolbar",1,"view-toolbar"],["eventCategory","View Primary Toolbar","name","Primary Toolbar",4,"ngIf"],["name","Explore Toolbar","class","ml-3",4,"ngIf"],["eventCategory","View Primary Toolbar","name","Primary Toolbar"],[3,"collapsePagination","collapseScrubber","mode"],["name","Explore Toolbar",1,"ml-3"],["data-test","viewExploreToolbar","icon","mouse-pointer","app-pin-button","","buttonType","ghost",3,"matTooltip","click"],["exploreTrigger",""],["eventCategory","View Media Bar","name","Media Bar",3,"canExit","exit"],[3,"template"],["eventCategory","View Explore Tools","name","Explore Tools",3,"canExit","exit"],[3,"mode"],["name","Visibility Layers",3,"canExit","exit"]],template:function(e,t){1&e&&(i.Tb(0,0),i.Ic(1,Iw,3,3,"div",1),i.Ic(2,zw,3,3,"div",2),i.Ic(3,Tw,3,3,"div",2),i.Ic(4,Uw,3,2,"div",2),i.Sb()),2&e&&(i.lc("ngSwitch",t.mode),i.Db(2),i.lc("ngSwitchCase",t.viewToolsMode.Media),i.Db(1),i.lc("ngSwitchCase",t.viewToolsMode.Tools),i.Db(1),i.lc("ngSwitchCase",t.viewToolsMode.VisibilityLayers))},directives:[Z.n,Z.p,Z.o,Z.l,xO,bw,ou,ru.c,HO,_w],styles:[".view-toolbar{position:absolute;display:flex;z-index:20;bottom:0;right:0}"],encapsulation:2,data:{animation:[Object(Zl.n)("inOutAnimation",[Object(Zl.m)(":enter",[Object(Zl.l)({opacity:0,transform:"translateY(200px)"}),Object(Zl.e)("300ms ease-in-out",Object(Zl.l)({opacity:1,transform:"*"}))]),Object(Zl.m)(":leave",[Object(Zl.e)("300ms ease-in-out",Object(Zl.l)({transform:"translateY(200px)",opacity:0}))])])]},changeDetection:0}),e})();class Lw{}var Ew=n("MtjB"),Fw=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let Aw=(()=>{class e{}return function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);o>3&&r&&Object.defineProperty(t,n,r)}([Object(A.Type)(()=>ca),Fw("design:type",String)],e.prototype,"objectId",void 0),e})();class Rw{}var Vw=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let Nw=(()=>{class e{}return function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);o>3&&r&&Object.defineProperty(t,n,r)}([Object(A.Type)(()=>Aw),Object(A.Type)(()=>Ft),Object(A.Type)(()=>Rw),Vw("design:type",String)],e.prototype,"moduleId",void 0),e})();var Bw=function(e){return e.UserGeneratedTour="user_generated_tour",e.Animated="animated",e.Quiz="quiz",e.ModeQuiz="mode_quiz",e.ModeContent="mode_content",e}({}),Hw=function(e){return e.Private="private",e.Group="enterprise",e.Public="public",e}({});const Qw={headers:new v.d({"Content-Type":"application/json; charset=utf-8"})};let $w=(()=>{class e{constructor(e,t,n,i,s){this.store=e,this.http=t,this.serializeModuleService=n,this.storyService=i,this.productService=s}getBookmarkData(e){return this.http.get("/search/bookmarks/data?be="+e).pipe(Object(Ew.a)(e=>e.pipe(Object(ka.a)(1e3),Object(Ua.a)(3))),Object(F.a)(e=>((e=e.bookmark).moduleId=e.customData?e.customData.moduleId:e.modules.activeModules[0],Object(A.plainToClass)(Nw,e))))}getBookmarkModel(e){return this.http.get("/ws/search/bookmarks?eid="+e).pipe(Object(Ew.a)(e=>e.pipe(Object(ka.a)(1e3),Object(Ua.a)(3))),Object(F.a)(e=>Object(A.plainToClass)(N,e.bookmark_info)),Object(F.a)(e=>H(e)))}getUserBookmarks(e,t="",n=1e4,i){const s={q:t,page_size:""+n};return Object(D.isNil)(i)||(s.is_owner=""+(i?1:0)),this.http.get("/ws/search/bookmarks/"+e,{params:s}).pipe(Object(Ew.a)(e=>e.pipe(Object(ka.a)(1e3),Object(Ua.a)(3))),Object(F.a)(e=>e.map(e=>Object(A.plainToClass)(N,e)).map(e=>H(e))))}getUserConditions(e,t="",n,i=1e4){let s="";switch(e){case Hw.Private:s="user";break;case Hw.Group:s="group"}return this.http.get(`/ws/search/conditions/private?q=${t}&page_size=${i}`).pipe(Object(F.a)(e=>e.filter(e=>e.module_accessor_level===s&&(!n||e.module_accessor_id===n))),Object(F.a)(e=>Object(A.plainToClass)(N,e)),Object(F.a)(e=>e.map(e=>H(e))))}getPrivateBookmarks(e="",t=1e4){return this.getUserBookmarks(Hw.Private,e,t,!0)}getPrivateConditions(e=""){return this.getUserConditions(Hw.Private)}getOrganizationBookmarks(e,t="",n=1e4){return this.getUserBookmarks(Hw.Private,t,n).pipe(Object(F.a)(t=>t.filter(e=>e.tags.includes("enterprise")).filter(t=>t.group_access.some(t=>t.group_id===e))))}getOrganizationConditions(e,t=""){return this.getUserConditions(Hw.Group,t,e)}getOrganizationContent(e,t=""){return Object(Vr.a)([this.getOrganizationBookmarks(e,t),this.getOrganizationConditions(e,t)]).pipe(Object(F.a)(([e,t])=>[...e,...t]))}getPrivateContent(e=""){return Object(Vr.a)([this.getPrivateBookmarks(e),this.getPrivateConditions(e)]).pipe(Object(F.a)(([e,t])=>[...e,...t]))}createBookmarkStory(e){return this.serializeModuleService.serialize({},new _a,!1,this.store.selectSnapshot(za.getStory),this.store.selectSnapshot(Or.getStoryChapters),e)}getPublicBookmarks(e=""){return this.getUserBookmarks(Hw.Public,e)}saveBookmark(e){const t=this.getNormalizedBookmarkEntry(e);let n;return n=this.http.post(e.id?"/ws/user/bookmark/v4/update":"/ws/user/bookmark/v4/save",t,Qw),n.pipe(Object(Us.a)(e=>this.getBookmarkModel(e.id)))}deleteBookmark(e){return this.http.delete(`/ws/user/bookmark/v4/delete?eid=${e}&app_producttype=${this.productService.productType}&app_productkey=${this.productService.productKey}`).pipe(Object(Ls.a)(e=>{const{error:t}=e.error,n=t?t.message:"";return Object(Ir.a)(n)}))}atMaxFreeBookmarkCount(){return this.http.get("/ws/user/content/limit/check?version=2").pipe(Object(Ls.a)(e=>Object(zs.a)({limit_reached:!1})))}filterByTags(e,t,n=!1){return e.filter(e=>n?t.every(t=>e.tags.includes(t)):t.some(t=>e.tags.includes(t)))}getGalleryTags(e){if(e){const t=[],n=function(e,t){const n=iy(e,Xm.EditBookmarks);return!!n&&(t.type===o.Module?n:!(!0!==t.is_owner)||!!sy(t)&&function(e,t){if(iy(e,Xm.EditAllTeamBookmarks))return!0;const n=iy(e,Xm.EditTeamBookmarks),i=sy(t)&&t.group_access[0].member_edit;return n&&i}(e,t))}(this.store.selectSnapshot(py.getUserRole),e);return e.type===o.Bookmark&&!n&&t.push("View Only"),e.animated&&t.push("Animated"),e.tour&&t.push("Tour"),e.quiz&&t.push("Quiz"),t}return[]}getShowcase(e){const t=[],n=this.getPrivateBookmarks("",10).pipe(Object(F.a)(e=>this.createPrivateShowcase(e)));if(t.push(n),!Object(D.isNil)(e)){const n=this.getOrganizationBookmarks(e.id,"",10).pipe(Object(F.a)(t=>this.createOrganizationShowcase(t,e)));t.push(n)}return Object(Vr.a)(t)}createMockBookmark(e){return Object.assign({author:"",author_first_name:"",author_last_name:"",cost:0,create_date_time:new Date,description:"",id:"",is_owner:!0,last_editor:"",last_editor_first_name:"",last_editor_last_name:"",tags:[],thumbnail_url:"",title:"",update_date_time:new Date,type:o.Bookmark},e?{animated:!0,tour:!0}:{})}createMockBookmarks(e){return[...Array(e).keys()].map(e=>this.createMockBookmark(e%2==0))}createPrivateShowcase(e){return{title:"Pick up where you left off",description:"",url:"/results/bookmarks?type=Private",bookmarks:e}}createOrganizationShowcase(e,t){return{title:"Recently added to "+t.name,description:"Recently added models to your Team library.",url:`/results/bookmarks?organizationId=${t.id}&type=Organization`,bookmarks:e}}translateBookmark(e,t,n,i){const s=n===o.Module||n===o.Internal?t.replace(".json",""):t;return Object(Vr.a)([this.storyService.getStory(e,o.Bookmark),this.storyService.getStoryTranslation(s,n,i)]).pipe(Object(F.a)(([e,t])=>this.storyService.translateStory(e,t)),Object(Us.a)(t=>this.saveBookmark({isOwner:!0,title:t.displayName.substr(0,60),id:e,index:t})),Object(F.a)(e=>e.id),Object(Ls.a)(t=>404===t.status?Object(zs.a)(e):Object(Ir.a)(t)))}getNormalizedBookmarkEntry(e){let t,n,i,s;if(e.isOwner){if(t=e.add_group_access?this.getGroupAccess(e.add_group_access):[],e.remove_group_access&&e.remove_group_access.forEach(e=>{const n=this.getNormalizeGroupAccess({group_id:e.group_id,remove:!0});t.push(n)}),n=this.getNormalizedBool(e.public_access),e.index){i={},e.index.chapters&&(i[Bw.UserGeneratedTour]=this.getNormalizedBool(e.index.chapters.length>1));const t=(e.index.tags||[]).includes("animated");i[Bw.Animated]=this.getNormalizedBool(t),i[Bw.ModeQuiz]=this.getNormalizedBool(e.viewMode===B.Quiz),i[Bw.ModeContent]=this.getNormalizedBool(e.viewMode===B.Content);const n=Object(D.get)(e.index,"quizSettings.enabled",!1);i[Bw.Quiz]=this.getNormalizedBool(n)}s=this.getNormalizedBool(e.is_content_copy)}return{eid:e.id,name:e.title,description:e.description,index:e.index,group_access:t,public_access:n,flags:i,is_content_copy:s,app_producttype:this.productService.productType,app_productkey:this.productService.productKey}}getGroupAccess(e){return e.map(e=>this.getNormalizeGroupAccess(e))}getNormalizeGroupAccess(e){const{group_id:t,group_name:n,member_edit:i,visible:s,remove:o}=e;return{group_id:t,group_name:n,member_edit:this.getNormalizedBool(i),visibility:this.getNormalizedBool(s),remove:this.getNormalizedBool(o)}}getNormalizedBool(e){return!0===e?"1":!1===e?"0":""}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(d.g),i.Zb(v.b),i.Zb(Sa),i.Zb(Wr),i.Zb(mf))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const qw={label:"Relevance",fields:[],ascending:!0},Ww={label:"Most Recent",fields:["collection_content_createdate","update_date_time","create_date_time"],ascending:!1},Kw={label:"Title (A-Z)",fields:["title"],ascending:!0},Gw={label:"Title (Z-A)",fields:["title"],ascending:!1},Zw={label:"Author (A-Z)",fields:["author"],ascending:!0},Jw={label:"Author (Z-A)",fields:["author"],ascending:!1};var Xw=function(e){return e.Enabled="enabled",e.Disabled="disabled",e.Locked="locked",e}({});class Yw{constructor(){this.background={colors:null},this.uiAnnotations=!1,this.uiAudio=!1,this.uiInfo=!0,this.uiFullscreen=!0,this.uiScrubber=!1,this.uiHelp=!0,this.uiBd="",this.loadRotate=null,this.initial={button:!1,handHint:!1,play:!1},this.disableScroll={alert:!1,overlay:!1},this.uiQuiz={mode:Xw.Enabled,number:void 0},this.autoLoad=!0,this.uiTour=!1,this.uiNav=!0,this.uiSearch=!0,this.uiTools=!0,this.uiUndo=!0,this.uiLabelList=!0,this.uiChapterList=!1,this.all=!1,this.collapseLabel=null,this.uiMenu=!0,this.uiAnatomyDescriptions=!1,this.uiTutorial=!1,this.uiLegend=!0,this.uiLoader=Po,this.uiWhiteboard=!0,this.uiVisibilityLayers=!0,this.uiAnatomyLabels=!0}}const eC={title:"Desktop",type:"desktop",dimensions:{width:700,height:550},orientation:"vertical"};var tC=n("P6Fj");const nC=new i.s(""),iC=new i.s(""),sC=c.deploy===r.Production?"https://human.biodigital.com":window.location.origin,oC=c.deploy===r.Local?"https://localhost:4202":sC+"/viewer";let rC=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},providers:[{provide:nC,useValue:sC},{provide:iC,useValue:oC}],imports:[[Z.c]]}),e})();var aC=function(e){return e.Single="share.widget.link",e.Bulk="share.widget.export",e}({});const cC={headers:new v.d({"Content-Type":"application/json; charset=utf-8"})},lC=new Yw,pC={id:"embedded-human",dimensions:eC.dimensions,fullScreen:!0};let dC=(()=>{class e{constructor(e,t,n,i,s,o,r,a){this.http=e,this.cameraService=t,this.numberService=n,this.orgnanizationService=i,this.contentViewService=s,this.matSnackbar=o,this.APP_BASE_URL=r,this.VIEWER_BASE_URL=a}exportBookmarks(e,t,n,i,s,o,r,a,c=!1,l=""){this.matSnackbar.open(`Exporting ${e.length} models to CSV...`);const p=[{label:"Title",field:"title"},{label:"ID",field:"id"},{label:"Collection",field:"collection"},{label:"URL",field:"url"},{label:"iFrame",field:"iFrame"},{label:"Author",field:"author"},{label:"Thumbnail URL",field:"thumbnail_url"},{label:"Created Date",field:"create_date_time"},{label:"Updated Date",field:"update_date_time"}];c&&p.push({label:"Offline Package URL",field:"offline_url"});const d=a?Object(zs.a)(null):this.getUAID(aC.Bulk),u=c?this.getDownloadURLs(e):Object(zs.a)([]),g=new Map,h=n.length?Object(Vr.a)(n.map(e=>this.orgnanizationService.getCollectionContent(t,e.collection_id).pipe(Object(F.a)(t=>{t.forEach(t=>{g.set(t.id,e)})})))):Object(zs.a)(!0);return Object(Vr.a)([d,u,h]).pipe(Object(F.a)(([t,n])=>e.map((e,c)=>{var p,d;const{id:u,title:h,author:b,thumbnail_url:m,create_date_time:f,update_date_time:y}=e,x=null!==(d=null===(p=g.get(e.id))||void 0===p?void 0:p.collection_name)&&void 0!==d?d:"",v=this.getWidgetURL(e,i,s,null,t,r,a,l),O=this.getWidgetEmbed(v,o),w=this.buildThumbnailURL(m),C=n[c]||"";return{title:h,id:u,collection:x,url:v,iFrame:O,author:b,thumbnail_url:w,create_date_time:Object(Z.v)(new Date(f),"shortDate","en"),update_date_time:Object(Z.v)(new Date(y),"shortDate","en"),offline_url:C}})),Object(oa.a)(e=>function(e,t,n=!0){const i=new tC.a,s=[];return n&&s.push(t.map(e=>e.label)),e.forEach(e=>{const n=t.map(t=>e[t.field]);s.push(n)}),new P.a(e=>{const t=i.unparse(s,{quotes:!0,header:!1});e.next(t),e.complete()})}(e,p)),Object(oa.a)(e=>{const t=`BioDigital-Widgets-${(new Date).toISOString().split("T")[0]}-export.csv`,n=new Blob([e],{type:"text/csv;charset=utf-8"});return Object(Rs.saveAs)(n,t),Object(zs.a)(!0)}))}generateWidgetURL(e,t,n,i,s,o,r,a){const c=r||!s?Object(zs.a)(null):this.getUAID(s);return Object(Vr.a)([c,this.contentViewService.trackContentPublish(e.id,e.type)]).pipe(Object(F.a)(([s])=>this.getWidgetURL(e,t,n,i,s,o,r,a)))}getWidgetURL(e,t,n,i,s,o="en",r,a){n=n||lC;const c="bookmark"===e.type,l={};l[c?"id":"m"]=""+(c?e.id:e.module_name);const p=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},l),this.getParamsForUIOptions(n||lC)),this.getParamsForLoadingExperience(n||lC)),this.getParamsForScrollMode(n||lC)),this.getParamsForLoadRotate(n||lC)),this.getParamsForLabelScale(n||lC)),d=Object(D.get)(n,"background.colors");if(Array.isArray(d)&&d.length>=3){const e=d.slice(0,4).map(e=>this.numberService.roundNumber(e,3));p["background.colors"]=""+e}if(i){const{eye:e,look:t,up:n}=this.cameraService.roundCamera(i,3);p.camera=""+[e.x,e.y,e.z,t.x,t.y,t.z,n.x,n.y,n.z]}r?p.dk=r.app_apikey:s&&(p.uaid=s),o&&"en"!==o&&(p.lang=o),a&&(p.paid=a);const u=this.isCustomWidget(e.embed_url_path)?e.embed_url_path:t;return this.buildWidgetURL(u,p)}generateWidgetEmbed(e,t,n,i,s,o,r,a,c){return this.generateWidgetURL(e,t,n,s,o,r,a,c).pipe(Object(F.a)(e=>this.getWidgetEmbed(e,i)))}getWidgetEmbed(e,t){const{width:n,height:i}=t||pC.dimensions;return`<iframe id="${pC.id}" frameBorder="0" width="${n}" height="${i}" allowFullScreen="${pC.fullScreen}" loading="lazy" src="${e}"></iframe>`}getImageEmbed(e,t,n){const i=("BioDigital Human: "+e).replace(/"/g,"&quot;");return`<a href="${t}" target="_blank"><img src="${n}" alt="${i}" title="${i}" /></a>`}getUAID(e){return this.http.post("/ws/user/analytics",{analytic_type:""+e,analytic_platform:"app"},cC).pipe(Object(F.a)(e=>e.id))}getDownloadURLs(e){const t=e.filter(e=>!e.favorite&&!e.unavailable).map(e=>({type:e.type,id:"module"===e.type?e.module_name:e.id}));return this.http.post("/ws/download/reserve",{content:t},{headers:{"Content-Type":"application/json"}}).pipe(Object(F.a)(t=>{const n=t.tokens;return e.map(e=>{const t=e.type,i="module"===e.type?e.module_name:e.id,s=n.find(e=>e.type===t&&e.id===i);return s&&s.token?this.buildDownloadURL(s.token):""})}),Object(Ls.a)(()=>Object(zs.a)(e.map(()=>""))))}extendWidgetOptions(e,t){const n=this.expandWidgetOptions(t);return this.deepExtendWidgetOptions(e,n),e}getWidgetConfig(e){const t={};return Object.keys(e).forEach(n=>{const i=e[n];if(null!==i){const e=this.getConfigName(n);t[e]=i}}),t}getConfigName(e){const t=this.camelToDashCase(e).replace(/^ui-/g,"");return this.dashCaseToCamelCase(t)}getParamsForLoadingExperience(e){return e.autoLoad?e.initial.button?{"initial.button":!0}:e.initial.handHint?{"initial.hand":!0}:e.initial.play?{"initial.play":!0}:{}:{"auto-load":!1}}getParamsForScrollMode(e){return e.disableScroll.alert?{"disable-scroll.alert":!0}:e.disableScroll.overlay?{"disable-scroll":!0}:{"disable-scroll":!1}}getParamsForLoadRotate(e){return"number"==typeof e.loadRotate?{"load-rotate":e.loadRotate}:{}}getParamsForLabelScale(e){return{}}getParamsForUIOptions(e){return Object.assign({"ui-info":e.uiInfo,"ui-search":e.uiSearch,"ui-undo":e.uiUndo,"ui-fullscreen":e.uiFullscreen,"ui-nav":e.uiNav,"ui-tools":e.uiTools,"ui-help":e.uiHelp,"ui-chapter-list":e.uiChapterList,"ui-label-list":e.uiLabelList,"ui-anatomy-descriptions":e.uiAnatomyDescriptions,"ui-tutorial":e.uiTutorial,"ui-loader":e.uiLoader,"ui-whiteboard":e.uiWhiteboard,"ui-layers":e.uiVisibilityLayers,"ui-anatomy-labels":e.uiAnatomyLabels},this.getParamsForUIQuiz(e))}getParamsForUIQuiz(e){const t={},n=Object(D.get)(e,"uiQuiz.mode"),i=Object(D.get)(e,"uiQuiz.number");return n===Xw.Disabled&&(t["ui-quiz"]=!1),n===Xw.Locked&&(t["ui-quiz-locked"]=!0),Object(D.isNil)(i)||(t["ui-quiz-start"]=i,t["ui-quiz-end"]=i),t}camelToDashCase(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}dashCaseToCamelCase(e){return e.replace(/-([a-z])/g,e=>e[1].toUpperCase())}isCustomWidget(e){return/widgets\/([^\/]+)\//.test(e)}saveUserImage(e,t="jpeg"){return this.http.post("/ws/user/image/v1-0",{image_src:e,image_type:t},cC).pipe(Object(F.a)(e=>e.url))}buildWidgetURL(e,t){const n=Object.entries(t).map(([e,t])=>`${e}=${t}`).join("&");let i="",s=e.replace(/^\/|\/$/g,"");return!1===t["auto-load"]&&"viewer"===s&&(s="tiny-viewer",i="/tiny-viewer"),c.deploy===r.Local?`${this.VIEWER_BASE_URL}${i}/?${n}`:`${this.APP_BASE_URL}/${s}/?${n}`}buildThumbnailURL(e){return`${this.APP_BASE_URL}${e}`}buildDownloadURL(e){return`${this.APP_BASE_URL}/download?t=${e}`}deepExtendWidgetOptions(e,t){Object.entries(e).forEach(([n,i])=>{const s=typeof i;[n,this.camelToDashCase(n),this.getConfigName(n)].forEach(o=>{if(t.hasOwnProperty(o)&&null!==t[o]){const r=t[o],a=typeof r;null===i?e[n]=r:s===a&&("object"===s?this.deepExtendWidgetOptions(i,r):e[n]=r)}})})}expandWidgetOptions(e){const t={};return Object.entries(e).forEach(([n,i])=>{const s=n.split(".");if(s.length>1){const e=s[0],n=s.slice(1).join(".");null!==t[e]&&"object"==typeof t[e]||(t[e]={}),t[e][n]=i}else t[n]=e[n]}),t}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(v.b),i.Zb(yn),i.Zb(mn),i.Zb(W),i.Zb(ny),i.Zb(id.b),i.Zb(nC),i.Zb(iC))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const uC={main:[{title:"All Models",id:"all",type:"Category",translations:{es:{title:"Todas las Categor\xedas"},zh:{title:"\u6240\u6709\u7c7b\u522b"},fr:{title:"Toutes les cat\xe9gories"},de:{title:"Alle Kategorien"},it:{title:"Tutte le categorie"},ja:{title:"\u3059\u3079\u3066\u306e\u30ab\u30c6\u30b4\u30ea"},pt:{title:"Todas as categorias"}}}],categories:[{title:"Anatomy by Regions",id:"regional",type:"Category",translations:{es:{title:"Anatom\xeda por Regiones"},zh:{title:"\u5c40\u90e8\u89e3\u5256"},fr:{title:"Anatomie par r\xe9gions"},de:{title:"Anatomie nach Regionen"},it:{title:"Anatomia per regioni"},ja:{title:"\u5404\u90e8\u4f4d\u306e\u69cb\u9020"},pt:{title:"Anatomia por Regi\xf5es"}}},{title:"Anatomy by Systems",id:"system",type:"Category",translations:{es:{title:"Anatom\xeda por Sistemas"},zh:{title:"\u7cfb\u7edf\u89e3\u5256"},fr:{title:"Anatomie par syst\xe8mes"},de:{title:"Anatomie nach Systemen"},it:{title:"Anatomia per sistemi"},ja:{title:"\u5404\u5668\u5b98\u7cfb\u306e\u69cb\u9020"},pt:{title:"Anatomia por Sistemas"}}},{title:"Complete Anatomy",id:"complete anatomy",type:"Category",translations:{de:{title:"Komplette Anatomie"},es:{title:"Anatom\xeda completa"},fr:{title:"Anatomie compl\xe8te"},it:{title:"Anatomia completa"},ja:{title:"\u4eba\u4f53\u306e\u5168\u4f53\u69cb\u9020"},pt:{title:"Anatomia Completa"},zh:{title:"\u5b8c\u6574\u89e3\u5256"}}},{title:"Bony Landmarks",id:"Bony Landmarks",type:"Category",translations:{de:{title:"Knochenmarksteine"},es:{title:"Hitos huesudos"},fr:{title:"Points de rep\xe8re osseux"},it:{title:"Punti di riferimento ossei"},ja:{title:"\u9aa8\u306e\u30e9\u30f3\u30c9\u30de\u30fc\u30af"},pt:{title:"Marcos \xf3sseos"},zh:{title:"\u9aa8\u6027\u6807\u5fd7"}}},{title:"Cross Sections & Micro Anatomy",id:"Cross Section and Micro Anatomy",type:"Category",translations:{de:{title:"Querschnitte & Mikro-Anatomie"},es:{title:"Secciones transversales y Micro Anatom\xeda"},fr:{title:"Sections transversales et micro anatomie"},it:{title:"Sezioni trasversali & Micro Anatomia"},ja:{title:"\u65ad\u9762\u56f3\u30fb\u30de\u30a4\u30af\u30ed\u89e3\u5256\u5b66"},pt:{title:"Se\xe7\xf5es Transversais e Micro Anatomia"},zh:{title:"\u6a2a\u65ad\u9762&\u663e\u5fae\u89e3\u5256"}}},{title:"Origins & Insertions",id:"Origins and Insertions",type:"Category",translations:{de:{title:"Urspr\xfcnge und Einf\xfcgungen"},es:{title:"Or\xedgenes e inserciones"},fr:{title:"Origines et insertions"},it:{title:"Origini e Inserzioni"},ja:{title:"\u8d77\u6e90\u3068\u633f\u5165"},pt:{title:"Origens e Inser\xe7\xf5es"},zh:{title:"\u808c\u8089\u8d77\u6b62\u70b9"}}},{title:"Anatomy Quizzes",id:"quiz",type:"Category",translations:{de:{title:"Anatomie-Quiz"},es:{title:"Cuestionarios de anatom\xeda"},fr:{title:"Quiz d'anatomie"},it:{title:"Quiz di anatomia"},ja:{title:"\u89e3\u5256\u5b66\u30af\u30a4\u30ba"},pt:{title:"Quizzes de anatomia"},zh:{title:"\u89e3\u5256\u6d4b\u9a8c"}}}],specialties:[{title:"Allergy & Immunology",id:"Allergy and Immunology",type:"Category",translations:{de:{title:"Allergie und Immunologie"},es:{title:"Alergia e Inmunolog\xeda"},fr:{title:"Allergie et Immunologie"},it:{title:"Allergia e Immunologia"},ja:{title:"\u30a2\u30ec\u30eb\u30ae\u30fc\u3068\u514d\u75ab\u5b66"},pt:{title:"Alergia e Imunologia"},zh:{title:"\u8fc7\u654f\u4e0e\u514d\u75ab\u5b66"}}},{title:"Cardiology",id:"Cardiology",type:"Category",translations:{de:{title:"Kardiologie"},es:{title:"Cardiolog\xeda"},fr:{title:"Cardiologie"},it:{title:"Cardiologia"},ja:{title:"\u5fc3\u81d3\u75c5\u5b66"},pt:{title:"Cardiologia"},zh:{title:"\u5fc3\u810f\u79d1"}}},{title:"Dentistry",id:"Dentistry",type:"Category",translations:{de:{title:"Zahnmedizin"},es:{title:"Odontolog\xeda"},fr:{title:"Dentisterie"},it:{title:"Odontoiatria"},ja:{title:"\u6b6f\u5b66"},pt:{title:"Odontologia"},zh:{title:"\u7259\u79d1"}}},{title:"Dermatology",id:"Dermatology",type:"Category",translations:{de:{title:"Dermatologie"},es:{title:"Dermatolog\xeda"},fr:{title:"Dermatologie"},it:{title:"Dermatologia"},ja:{title:"\u76ae\u819a\u5b66"},pt:{title:"Dermatologia"},zh:{title:"\u76ae\u80a4\u79d1"}}},{title:"Endocrinology",id:"Endocrinology",type:"Category",translations:{de:{title:"Endokrinologie"},es:{title:"Endocrinolog\xeda"},fr:{title:"Endocrinologie"},it:{title:"Endocrinologia"},ja:{title:"\u5185\u5206\u6ccc\u5b66"},pt:{title:"Endocrinologia"},zh:{title:"\u5185\u5206\u6ccc\u79d1"}}},{title:"Gastroenterology",id:"Gastroenterology and Hepatology",type:"Category",translations:{de:{title:"Gastroenterologie"},es:{title:"Gastroenterolog\xeda"},fr:{title:"Gastroent\xe9rologie"},it:{title:"Gastroenterologia"},ja:{title:"\u80c3\u8178\u5b66\u30fb\u809d\u81d3\u5b66"},pt:{title:"Gastroenterologia"},zh:{title:"\u80c3\u80a0\u79d1&\u809d\u810f\u79d1"}}},{title:"Gynecology",id:"Gynecology",type:"Category",translations:{de:{title:"Gyn\xe4kologie"},es:{title:"Ginecolog\xeda"},fr:{title:"Gyn\xe9cologie"},it:{title:"Ginecologia"},ja:{title:"\u5a66\u4eba\u79d1"},pt:{title:"Ginecologia"},zh:{title:"\u5987\u79d1"}}},{title:"Hematology & Oncology",id:"Oncology and Hematology",type:"Category",translations:{de:{title:"H\xe4matologie/Onkologie"},es:{title:"Hematolog\xeda/Oncolog\xeda"},fr:{title:"H\xe9matologie/Oncologie"},it:{title:"Ematologia/Oncologia"},ja:{title:"\u816b\u760d\u5b66\u30fb\u8840\u6db2\u5b66"},pt:{title:"Hematologia/Oncologia"},zh:{title:"\u80bf\u7624\u79d1/\u8840\u6db2\u79d1"}}},{title:"Infectious Disease",id:"Infectious Disease",type:"Category",translations:{de:{title:"Infektionskrankheit"},es:{title:"Enfermedades Infecciosas"},fr:{title:"Maladies infectieuses"},it:{title:"Malattie Infettive"},ja:{title:"\u611f\u67d3\u75c7"},pt:{title:"Doen\xe7a Infecciosa"},zh:{title:"\u4f20\u67d3\u75c5"}}},{title:"Nephrology",id:"Nephrology",type:"Category",translations:{de:{title:"Nephrologie"},es:{title:"Nefrolog\xeda"},fr:{title:"N\xe9phrologie"},it:{title:"Nefrologia"},ja:{title:"\u814e\u81d3\u5b66"},pt:{title:"Nefrologia"},zh:{title:"\u80be\u79d1"}}},{title:"Neurology & Psychiatry",id:"Neurology and Psychiatry",type:"Category",translations:{de:{title:"Neurologie & Psychiatrie"},es:{title:"Neurolog\xeda y Psiquiatr\xeda"},fr:{title:"Neurologie & Psychiatrie"},it:{title:"Neurologia & Psichiatria"},ja:{title:"\u795e\u7d4c\u5b66\u30fb\u7cbe\u795e\u533b\u5b66"},pt:{title:"Neurologia e Psiquiatria"},zh:{title:"\u795e\u7ecf\u79d1&\u7cbe\u795e\u79d1"}}},{title:"Obstetrics",id:"Obstetrics",type:"Category",translations:{de:{title:"Geburtshilfe"},es:{title:"Obstetricia "},fr:{title:"Obst\xe9trique"},it:{title:"Ostetricia"},ja:{title:"\u7523\u79d1"},pt:{title:"Obstetr\xedcia"},zh:{title:"\u4ea7\u79d1"}}},{title:"Ophthalmology",id:"Ophthalmology",type:"Category",translations:{de:{title:"Ophthalmologie"},es:{title:"Oftalmolog\xeda"},fr:{title:"Ophtalmologie"},it:{title:"Oftalmologia"},ja:{title:"\u773c\u79d1\u5b66"},pt:{title:"Oftalmologia"},zh:{title:"\u773c\u79d1"}}},{title:"Orthopedics",id:"Orthopedics",type:"Category",translations:{de:{title:"Orthop\xe4die"},es:{title:"Ortopedia"},fr:{title:"Orthop\xe9die"},it:{title:"Ortopedia"},ja:{title:"\u6574\u5f62\u5916\u79d1\u5b66"},pt:{title:"Ortopedia"},zh:{title:"\u9aa8\u79d1"}}},{title:"Otolaryngology",id:"Otolaryngology",type:"Category",translations:{de:{title:"HNO-Heilkunde"},es:{title:"Otorrinolaringolog\xeda"},fr:{title:"Otorhinolaryngologie"},it:{title:"Otorinolaringoiatria"},ja:{title:"\u8033\u9f3b\u79d1\u5b66"},pt:{title:"Otorrinolaringologia"},zh:{title:"\u8033\u9f3b\u5589\u79d1"}}},{title:"Pediatrics",id:"Pediatrics",type:"Category",translations:{de:{title:"P\xe4diatrie"},es:{title:"Pediatr\xeda"},fr:{title:"P\xe9diatrie"},it:{title:"Pediatria"},ja:{title:"\u5c0f\u5150\u79d1\u5b66"},pt:{title:"Pediatria"},zh:{title:"\u513f\u79d1"}}},{title:"Physical Therapy",id:"Physical Therapy",type:"Category",translations:{de:{title:"Physikalische Therapie"},es:{title:"Fisioterapia"},fr:{title:"Physioth\xe9rapie"},it:{title:"Terapia fisica"},ja:{title:"\u7406\u5b66\u7642\u6cd5"},pt:{title:"Fisioterapia"},zh:{title:"\u7269\u7406\u7597\u6cd5"}}},{title:"Pulmonology",id:"Pulmonology and Respiratory",type:"Category",translations:{de:{title:"Pulmonologie"},es:{title:"Neumolog\xeda"},fr:{title:"Pneumologie"},it:{title:"Pneumologia"},ja:{title:"\u547c\u5438\u5668\u5b66"},pt:{title:"Pneumologia"},zh:{title:"\u80ba\u75c5\u79d1/\u547c\u5438\u79d1"}}},{title:"Rheumatology",id:"Rheumatology",type:"Category",translations:{de:{title:"Rheumatologie"},es:{title:"Reumatolog\xeda"},fr:{title:"Rhumatologie"},it:{title:"Reumatologia"},ja:{title:"\u30ea\u30a6\u30de\u30c1\u5b66"},pt:{title:"Reumatologia"},zh:{title:"\u98ce\u6e7f\u79d1"}}},{title:"Urology",id:"Urology",type:"Category",translations:{de:{title:"Urologie"},es:{title:"Urolog\xeda"},fr:{title:"Urologie"},it:{title:"Urologia"},ja:{title:"\u6ccc\u5c3f\u5668\u79d1\u5b66"},pt:{title:"Urologia"},zh:{title:"\u6ccc\u5c3f\u5916\u79d1"}}}],community:[{title:"Community Bookmarks",id:"public",type:"Community",translations:{de:{title:"Community-Lesezeichen"},es:{title:"Marcadores de la comunidad"},fr:{title:"Signets communautaires"},it:{title:"Segnalibri della community"},ja:{title:"\u30b3\u30df\u30e5\u30cb\u30c6\u30a3\u306e\u30d6\u30c3\u30af\u30de\u30fc\u30af"},pt:{title:"Favoritos da comunidade"},zh:{title:"\u793e\u533a\u4e66\u7b7e"}}}]},gC=[{icon:"search",tag:"Heart",params:{categoryId:"all",query:"Heart",type:"Category"}},{icon:"search",tag:"Brain",params:{categoryId:"all",query:"Brain",type:"Category"}},{icon:"search",tag:"Cardiology",params:{categoryId:"Cardiology",type:"Category"}},{icon:"search",tag:"COVID-19",params:{categoryId:"all",query:"COVID-19",type:"Category"}},{icon:"search",tag:"Treatments",params:{categoryId:"all",query:"Treatments",type:"Category"}},{icon:"search",tag:"Eye",params:{categoryId:"all",query:"Eye",type:"Category"}},{icon:"search",tag:"Skull",params:{categoryId:"all",query:"Skull",type:"Category"}},{icon:"search",tag:"Nervous System",params:{categoryId:"all",query:"Nervous System",type:"Category"}},{icon:"search",tag:"Muscles",params:{categoryId:"all",query:"Muscles",type:"Category"}},{icon:"search",tag:"Skeleton",params:{categoryId:"all",query:"Skeleton",type:"Category"}},{icon:"search",tag:"Digestive System",params:{categoryId:"all",query:"Digestive System",type:"Category"}}],hC=["assets/images/hero/biodigital-human-muscular-system.jpg","assets/images/hero/biodigital-human-cardiovascular-system.jpg","assets/images/hero/biodigital-human-nervous-system.jpg","assets/images/hero/biodigital-human-multiple-systems.jpg"],bC=["live"];let mC=(()=>{class e{constructor(e){this.http=e}search(e="",t=[],n="en"){const i=e.split(/[ ]+/).join("+"),s=bC.concat(t).filter(e=>""!==e&&null!=e).map(e=>`"${e}"`).join("+");return this.http.get(`/search?k=${i}&t=${s}&il=${n}&ol=${n}&odns=true`).pipe(Object(F.a)(e=>this.resultsToBookmarks(e)))}searchInternal(e="",t=""){return this.http.get(`/ws/search/internal?k=${e}&dir=${t}`).pipe(Object(F.a)(e=>this.resultsToBookmarks(e)))}getAnatomyCategory(e,t,n=[],i){return this.search(e,[t,...n],i)}getConditionModel(e){if(c.offline)return Object(zs.a)(null);const t=this.toDatabaseContentId(e);return this.http.get("/search/conditions?q="+t).pipe(Object(Ew.a)(e=>e.pipe(Object(ka.a)(1e3),Object(Ua.a)(3))),Object(F.a)(e=>this.resultsToBookmarks(e)),Object(F.a)(e=>e[0]))}getShowcase(){return this.http.get("/assets/bookmarks/showcase.json").pipe(Object(F.a)(e=>(e.forEach(e=>(e.bookmarks=this.resultsToBookmarks(e.bookmarks),e)),e)))}createMockShowcase(e){return{title:" ",description:" ",url:"",bookmarks:[...e],loading:!0}}createMockShowcases(e,t){return[...Array(e).keys()].map(()=>this.createMockShowcase(t))}resultsToBookmarks(e){return e.forEach(e=>{e=H(e)}),Object(A.plainToClass)(N,e)}getBookmarkCategory(e){if(!e.tags)return null;const t=uC.categories.map(e=>e.id.toLocaleLowerCase());return e.tags.find(e=>t.includes(e.toLocaleLowerCase()))}getStoryCategory(e){if(!e.tags)return null;const t=[...uC.main,...uC.categories,...uC.specialties,...uC.community].map(e=>e.id.toLocaleLowerCase());return e.tags.find(e=>t.includes(e.toLocaleLowerCase()))}toAppContentId(e){return e.replace("Condition.content.","").replace(".json","").split(".").join("/")}toDatabaseContentId(e){return e.match("Condition.content")?e:`Condition.content.${e.replace(".json","").split("/").join(".")}.json`}getHeroImages(){return Object(zs.a)(hC)}getHeroQuickTags(){return Object(zs.a)(gC)}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(v.b))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function fC(e,t,n){const i=t.map(t=>e[t]).filter(e=>!Object(D.isNil)(e));return n?i.sort().shift():i.sort().pop()}function yC(e,t,n){if(0===t.length)return e;const i=new Intl.Collator("en-US",{sensitivity:"base"});return e.sort((e,s)=>{const o=fC(e,t,n)||"",r=fC(s,t,n)||"";return(n?1:-1)*i.compare(o.toString(),r.toString())})}class xC{}let vC=(()=>{class e{constructor(e){this.http=e}generateFreshChapterImages(e,t,n=!1){const i=[];return e.forEach(e=>{const s=na.getChapterThumbnail(e,t);(s.legacy||n)&&i.push(na.makeFreshThumbnail(s.storyId,s.chapterId,s.urls.large))}),i.length?Object(Vr.a)(i):Object(zs.a)([])}saveChapterThumbnails(e,t,n){return e.reduce((e,i)=>{const s=t.get(n[i.id]),o=Object(D.get)(s,"snapshot");return o&&e.push(this.saveNewChapterImage(i.id,o)),e},[])}saveNewChapterImage(e,t){return new P.a(n=>{ra(t).pipe(Object(oa.a)(e=>this.saveImageBlob(e)),Object(F.a)(t=>Object.assign({chapterId:e},t))).subscribe(e=>{n.next(e),n.complete()},()=>{n.next(null),n.complete()})})}getIndexThumbnail(e,t="large"){return`${"undefined"==typeof localBaseDirectory?"":localBaseDirectory}thumbs/modules/${e}/${t}/index.jpg`}saveImageBlob(e){const t=new File([e],"image.jpg",{type:"image/jpeg"}),n=new FormData;return n.append("file",t),this.http.post("/ws/media/images/upload",n)}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(v.b))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var OC=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},wC=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function CC(e,t,n,i,s,r){return r?Object(As.a)(n.getDatabaseItem(or.PreviewBookmark)):s===o.Bookmark?e.getBookmarkModel(i):t.getConditionModel(i)}const SC={loading:!0,exporting:!1,copying:!1,saving:!1,bookmarks:[],selectedBookmark:null,sort:Ww,checkedBookmarks:[],selectedCategory:null};let _C=(()=>{let e=class{constructor(e,t,n,i,s,o,r,a,c,l,p){this.store=e,this.actions=t,this.bookmarksService=n,this.imagesService=i,this.storyService=s,this.exploreService=o,this.publishService=r,this.organizationsService=a,this.snackbar=c,this.pendoService=l,this.storageService=p}static getBookmarks(e){const{bookmarks:t,sort:n}=e,{ascending:i,fields:s}=n;return yC(t,s,i)}static getCheckedBookmarks(e){return e.checkedBookmarks}static getSelectedBookmark(e){return e.selectedBookmark}static getSelectedBookmarkViewMode(e){return e.selectedBookmark.viewMode||B.All}static getLoading(e){return e.loading}static getExporting(e){return e.exporting}static getSaving(e){return e.saving}static getCopying(e){return e.copying}static getSort(e){return e.sort}static getSelectedCategory(e){return e.selectedCategory}loadBookmarks(e,t){e.patchState({loading:!0,bookmarks:[],checkedBookmarks:[]}),Object(Vr.a)(this.bookmarksService.getPrivateBookmarks(t.query),this.bookmarksService.getPrivateConditions(t.query)).pipe(Object(Mr.a)(()=>e.patchState({loading:!1}))).subscribe(([t,n])=>{e.dispatch(new uc([...t,...n]))})}loadOrganizationBookmarks(e,{organizationId:t}){e.patchState({loading:!0,bookmarks:[],checkedBookmarks:[]}),this.bookmarksService.getOrganizationContent(t).pipe(Object(Mr.a)(()=>e.patchState({loading:!1}))).subscribe(t=>{e.dispatch(new uc(t))})}loadCollectionBookmarks(e,t){e.patchState({loading:!0,bookmarks:[],checkedBookmarks:[]}),this.organizationsService.getCollectionContent(t.organizationId,t.collectionId).pipe(Object(Mr.a)(()=>e.patchState({loading:!1}))).subscribe(t=>{e.dispatch(new uc(t))})}loadSuccess({patchState:e},t){e({bookmarks:t.result})}selectBookmark(e,t){const{id:n,type:i,preview:s}=t;CC(this.bookmarksService,this.exploreService,this.storageService,n,i,s).subscribe(t=>{e.dispatch(new dc(t))})}selectBookmarkSuccess(e,t){let{bookmark:n}=t;n&&(n=H(n)),e.patchState({selectedBookmark:n})}saveBookmark(e,t){return n=this,void 0,s=function*(){let n;e.patchState({saving:!0});const i=t.bookmarkEntry,s=this.store.selectSnapshot(Or.getStoryChapters),o=!1===t.inplace,r=Gs.makeChapterIdMap(s,o);o&&(yield this.store.dispatch(new Gi.UpdateTweenParticleLookupChapters(r)).toPromise()),t.includeIndex&&(n=this.bookmarksService.createBookmarkStory(r),i.index=n.story);let a=Object(zs.a)([]);if(t.includeIndex){const e=this.store.selectSnapshot(qs.getRegisteredThumbnails),t=this.imagesService.saveChapterThumbnails(i.index.chapters,e,Object(D.invert)(r));t.length&&(a=Object(Vr.a)(t))}a.pipe(Object(Us.b)(t=>{const n=this.store.selectSnapshot(qs.getRegisteredThumbnails);return t.forEach(e=>{const t=new Ps;t.storyId=i.id,t.chapterId=e.chapterId,t.urls={small:e.uris.small,large:e.uris.large},n.set(e.chapterId,t);const s=i.index.chapters.findIndex(t=>t.id===e.chapterId);s>=0&&(i.index.chapters[s].thumbnails=Object.assign({},e.uris))}),e.dispatch(new Cs(n)),this.bookmarksService.saveBookmark(i)})).subscribe(t=>{e.patchState({saving:!1});const s=n?n.story:null,o=i.id?"update":"save",r=Array.isArray(i.addCollections)&&i.addCollections.length>0,a=i.removeCollections&&Array.from(i.removeCollections.keys()).length>0;r||a?(this.actions.pipe(Object(d.j)(Tc,Uc),Object(Ua.a)(1)).subscribe(()=>{e.dispatch(new vc(t,s,o))}),e.dispatch(new zc(t,i.addCollections,i.removeCollections))):e.dispatch(new vc(t,s,o))},()=>{e.dispatch(new Oc(i))}),this.pendoService.track("Bookmark Save - Start")},new((i=void 0)||(i=Promise))((function(e,t){function o(e){try{a(s.next(e))}catch(n){t(n)}}function r(e){try{a(s.throw(e))}catch(n){t(n)}}function a(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(o,r)}a((s=s.apply(n,[])).next())}));var n,i,s}saveBookmarkSuccess(e,t){const n=t.bookmark,i=e.getState().bookmarks,s=i.findIndex(e=>e.id===n.id);-1!==s&&(i[s]=n,e.patchState({bookmarks:[...i]})),"save"===t.method&&e.patchState({selectedBookmark:t.bookmark}),this.pendoService.track("Bookmark Save - Success")}saveBookmarkFail(e,t){this.pendoService.track("Bookmark Save - Failure")}deleteBookmark(e,t){const n=t.bookmarkId;this.bookmarksService.deleteBookmark(n).subscribe(()=>{e.dispatch(new hc(n))},t=>{e.dispatch(new bc(n,t))})}deleteBookmarkSuccess(e,t){const n=e.getState().bookmarks.filter(e=>e.id!==t.bookmarkId);e.patchState({bookmarks:[...n]}),this.snackbar.open("Successfully deleted 3D model")}bulkDeleteBookmark(e,t){const n=t.bookmarkIds,i=t.bookmarkIds.map(e=>this.bookmarksService.deleteBookmark(e));Object(Vr.a)(i).subscribe(()=>{e.dispatch(new fc(n))},t=>{e.dispatch(new yc(n,t))})}bulkDeleteBookmarkSuccess(e,t){const n=e.getState().bookmarks.filter(e=>!t.bookmarkIds.some(t=>t===e.id));e.patchState({bookmarks:[...n]}),this.snackbar.open("Successfully deleted 3D models")}sortBookmarks(e,t){const n=e.getState().bookmarks;e.patchState({sort:t.sort,bookmarks:[...n]})}clearBookmarks(e,t){e.patchState({bookmarks:[],checkedBookmarks:[]})}resetBookmarks(e,t){e.setState(SC)}checkBookmark(e,t){let n=e.getState().checkedBookmarks;const i=n.some(e=>e===t.id);t.checked&&!i?n=[...n,t.id]:t.checked||(n=n.filter(e=>e!==t.id)),e.patchState({checkedBookmarks:n})}setCheckedBookmarks(e,t){e.patchState({checkedBookmarks:t.ids})}exportBookmarks(e,t){const{bookmarks:n,organizationId:i,collections:s,widgetURL:o,widgetOptions:r,offlineEnabled:a,productAccountId:c}=t,l=r||new Yw;e.patchState({exporting:!0}),this.publishService.exportBookmarks(n,i,s,o,l,null,t.userLanguage,t.userApp,a,c).pipe(Object(Mr.a)(()=>{e.patchState({exporting:!1})})).subscribe(t=>{e.dispatch(t?new Mc(n):new Ic(n))})}updateBookmarkCollections(e,t){const n=t.addCollections,i=n.map(e=>({collection_id:e.collection_id,content_list:[{content_type:t.bookmark.type,content_id:t.bookmark.id}]})),s=Array.from(t.removeCollections.keys()),o=s.map(e=>({collection_id:e.collection_id,collection_content_id_list:[t.removeCollections.get(e)]})),r=n.concat(s)[0].group_id;this.organizationsService.updateCollectionContent(r,i,o).subscribe(()=>{n.length>0&&e.dispatch(new Dc(t.bookmark,n)),s.length>0&&e.dispatch(new Ec(t.bookmark,s)),e.dispatch(new Tc(t.bookmark,n,s))},()=>{n.length>0&&e.dispatch(new Lc(t.bookmark,n)),s.length>0&&e.dispatch(new Fc(t.bookmark,s)),e.dispatch(new Uc(t.bookmark,n,s))})}removeBookmarkCollectionSuccess(e,t){const{bookmarks:n,selectedCategory:i}=e.getState();if("collection"===i){const i=t.bookmark.id,s=n.filter(e=>e.id!==i);e.patchState({bookmarks:[...s]})}}copyBookmark(e,t){this.pendoService.track("Bookmark Copy - Start");const{groupAccess:n,collections:i}=t;let s,o,r,a,c;e.patchState({copying:!0,saving:!0});const l=CC(this.bookmarksService,this.exploreService,this.storageService,t.id,t.type,!1),p=this.storyService.getStory(t.id,t.type,t.lang);Object(Vr.a)([l,p]).pipe(Object(F.a)(([e,t])=>{o=Object(D.cloneDeep)(t),r=Object(D.cloneDeep)(t),a=Gs.makeChapterIdMap(o.chapters,!0),r.chapters.forEach(e=>{e.id=a[e.id]}),r.tweenParticleLookup&&(r.tweenParticleLookup=Zi.updateChapterIds(r.tweenParticleLookup,a)),c=e.viewMode}),Object(oa.a)(()=>this.imagesService.generateFreshChapterImages(o.chapters,t.id)),Object(oa.a)(e=>{const t=e.map(e=>this.imagesService.saveNewChapterImage(e.chapterId,e.snapshot));return t.length?Object(Vr.a)(t):Object(zs.a)([])}),Object(F.a)(e=>{e.forEach(e=>{e.chapterId=a[e.chapterId]}),r.chapters.forEach(t=>{const n=e.find(e=>e.chapterId===t.id);n&&(t.thumbnails=Object.assign({},n.uris))})}),Object(oa.a)(()=>{const e=new xC;return e.title=t.title,e.isOwner=!0,e.index=r,e.viewMode=c,e.is_content_copy=!0,n&&(e.add_group_access=[n]),this.bookmarksService.saveBookmark(e)}),Object(vn.a)(e=>{s=e}),Object(oa.a)(()=>{if(n&&i&&i.length>0){const e=i[0].group_id,t=i.map(e=>({collection_id:e.collection_id,content_list:[{content_type:s.type,content_id:s.id}]}));return this.organizationsService.updateCollectionContent(e,t,[])}return Object(zs.a)(!0)}),Object(Mr.a)(()=>{e.patchState({copying:!1,saving:!1})})).subscribe(()=>{this.pendoService.track("Bookmark Copy - Success"),e.dispatch(new Rc(s))},n=>{this.pendoService.track("Bookmark Copy - Failure"),e.dispatch(new Vc(t.id,n))})}setBookmarkText(e,t){const n=e.getState().selectedBookmark;e.patchState({selectedBookmark:Object.assign(Object.assign({},n),{title:t.title})})}setBookmarkViewMode(e,t){const n=e.getState().selectedBookmark;e.patchState({selectedBookmark:Object.assign(Object.assign({},n),{viewMode:t.viewMode})})}setSelectedCategory(e,{category:t}){e.patchState({selectedCategory:t||null})}cancelSaveBookmark(e,t){e.patchState({saving:!1})}cancelCopyBookmark(e,t){e.patchState({copying:!1})}};return e.\u0275fac=function(t){return new(t||e)(i.Zb(d.g),i.Zb(d.b),i.Zb($w),i.Zb(vC),i.Zb(Wr),i.Zb(mC),i.Zb(dC),i.Zb(W),i.Zb(id.b),i.Zb(G),i.Zb(ar))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac}),OC([Object(d.a)(ac),wC("design:type",Function),wC("design:paramtypes",[Object,ac]),wC("design:returntype",void 0)],e.prototype,"loadBookmarks",null),OC([Object(d.a)(cc),wC("design:type",Function),wC("design:paramtypes",[Object,cc]),wC("design:returntype",void 0)],e.prototype,"loadOrganizationBookmarks",null),OC([Object(d.a)(lc),wC("design:type",Function),wC("design:paramtypes",[Object,lc]),wC("design:returntype",void 0)],e.prototype,"loadCollectionBookmarks",null),OC([Object(d.a)(uc),wC("design:type",Function),wC("design:paramtypes",[Object,uc]),wC("design:returntype",void 0)],e.prototype,"loadSuccess",null),OC([Object(d.a)(pc),wC("design:type",Function),wC("design:paramtypes",[Object,pc]),wC("design:returntype",void 0)],e.prototype,"selectBookmark",null),OC([Object(d.a)(dc),wC("design:type",Function),wC("design:paramtypes",[Object,dc]),wC("design:returntype",void 0)],e.prototype,"selectBookmarkSuccess",null),OC([Object(d.a)(xc),wC("design:type",Function),wC("design:paramtypes",[Object,xc]),wC("design:returntype",Promise)],e.prototype,"saveBookmark",null),OC([Object(d.a)(vc),wC("design:type",Function),wC("design:paramtypes",[Object,vc]),wC("design:returntype",void 0)],e.prototype,"saveBookmarkSuccess",null),OC([Object(d.a)(Oc),wC("design:type",Function),wC("design:paramtypes",[Object,Oc]),wC("design:returntype",void 0)],e.prototype,"saveBookmarkFail",null),OC([Object(d.a)(gc),wC("design:type",Function),wC("design:paramtypes",[Object,gc]),wC("design:returntype",void 0)],e.prototype,"deleteBookmark",null),OC([Object(d.a)(hc),wC("design:type",Function),wC("design:paramtypes",[Object,hc]),wC("design:returntype",void 0)],e.prototype,"deleteBookmarkSuccess",null),OC([Object(d.a)(mc),wC("design:type",Function),wC("design:paramtypes",[Object,mc]),wC("design:returntype",void 0)],e.prototype,"bulkDeleteBookmark",null),OC([Object(d.a)(fc),wC("design:type",Function),wC("design:paramtypes",[Object,fc]),wC("design:returntype",void 0)],e.prototype,"bulkDeleteBookmarkSuccess",null),OC([Object(d.a)(_c),wC("design:type",Function),wC("design:paramtypes",[Object,_c]),wC("design:returntype",void 0)],e.prototype,"sortBookmarks",null),OC([Object(d.a)(Sc),wC("design:type",Function),wC("design:paramtypes",[Object,Sc]),wC("design:returntype",void 0)],e.prototype,"clearBookmarks",null),OC([Object(d.a)(Cc),wC("design:type",Function),wC("design:paramtypes",[Object,Cc]),wC("design:returntype",void 0)],e.prototype,"resetBookmarks",null),OC([Object(d.a)(jc),wC("design:type",Function),wC("design:paramtypes",[Object,jc]),wC("design:returntype",void 0)],e.prototype,"checkBookmark",null),OC([Object(d.a)(kc),wC("design:type",Function),wC("design:paramtypes",[Object,kc]),wC("design:returntype",void 0)],e.prototype,"setCheckedBookmarks",null),OC([Object(d.a)(Pc),wC("design:type",Function),wC("design:paramtypes",[Object,Pc]),wC("design:returntype",void 0)],e.prototype,"exportBookmarks",null),OC([Object(d.a)(zc),wC("design:type",Function),wC("design:paramtypes",[Object,zc]),wC("design:returntype",void 0)],e.prototype,"updateBookmarkCollections",null),OC([Object(d.a)(Ec),wC("design:type",Function),wC("design:paramtypes",[Object,Ec]),wC("design:returntype",void 0)],e.prototype,"removeBookmarkCollectionSuccess",null),OC([Object(d.a)(Ac),wC("design:type",Function),wC("design:paramtypes",[Object,Ac]),wC("design:returntype",void 0)],e.prototype,"copyBookmark",null),OC([Object(d.a)(Bc),wC("design:type",Function),wC("design:paramtypes",[Object,Bc]),wC("design:returntype",void 0)],e.prototype,"setBookmarkText",null),OC([Object(d.a)(Hc),wC("design:type",Function),wC("design:paramtypes",[Object,Hc]),wC("design:returntype",void 0)],e.prototype,"setBookmarkViewMode",null),OC([Object(d.a)(Qc),wC("design:type",Function),wC("design:paramtypes",[Object,Qc]),wC("design:returntype",void 0)],e.prototype,"setSelectedCategory",null),OC([Object(d.a)(wc),wC("design:type",Function),wC("design:paramtypes",[Object,wc]),wC("design:returntype",void 0)],e.prototype,"cancelSaveBookmark",null),OC([Object(d.a)(Nc),wC("design:type",Function),wC("design:paramtypes",[Object,Nc]),wC("design:returntype",void 0)],e.prototype,"cancelCopyBookmark",null),OC([Object(d.e)(),wC("design:type",Function),wC("design:paramtypes",[Lw]),wC("design:returntype",void 0)],e,"getBookmarks",null),OC([Object(d.e)(),wC("design:type",Function),wC("design:paramtypes",[Lw]),wC("design:returntype",void 0)],e,"getCheckedBookmarks",null),OC([Object(d.e)(),wC("design:type",Function),wC("design:paramtypes",[Lw]),wC("design:returntype",void 0)],e,"getSelectedBookmark",null),OC([Object(d.e)(),wC("design:type",Function),wC("design:paramtypes",[Lw]),wC("design:returntype",void 0)],e,"getSelectedBookmarkViewMode",null),OC([Object(d.e)(),wC("design:type",Function),wC("design:paramtypes",[Lw]),wC("design:returntype",void 0)],e,"getLoading",null),OC([Object(d.e)(),wC("design:type",Function),wC("design:paramtypes",[Lw]),wC("design:returntype",void 0)],e,"getExporting",null),OC([Object(d.e)(),wC("design:type",Function),wC("design:paramtypes",[Lw]),wC("design:returntype",void 0)],e,"getSaving",null),OC([Object(d.e)(),wC("design:type",Function),wC("design:paramtypes",[Lw]),wC("design:returntype",void 0)],e,"getCopying",null),OC([Object(d.e)(),wC("design:type",Function),wC("design:paramtypes",[Lw]),wC("design:returntype",void 0)],e,"getSort",null),OC([Object(d.e)(),wC("design:type",Function),wC("design:paramtypes",[Lw]),wC("design:returntype",void 0)],e,"getSelectedCategory",null),e=OC([Object(d.f)({name:"bookmarks",defaults:SC})],e),e})();var jC=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},kC=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function PC(e,t){if(1&e){const e=i.Wb();i.Tb(0),i.Vb(1,"button",15),i.cc("click",(function(){return i.xc(e),i.gc().handleTreeClick()})),i.Qb(2,"app-icon",16),i.Vb(3,"span",17),i.Kc(4,"Anatomy Tree"),i.Ub(),i.Ub(),i.Vb(5,"button",18),i.cc("click",(function(){return i.xc(e),i.gc().handleSearchClick()})),i.Qb(6,"app-icon",19),i.Vb(7,"span",17),i.Kc(8,"Search"),i.Ub(),i.Ub(),i.Qb(9,"mat-divider"),i.Sb()}}function MC(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",20),i.cc("click",(function(){return i.xc(e),i.gc().toggleToolbar("visibilityLayers")})),i.Qb(1,"app-icon",21),i.Vb(2,"span",17),i.Kc(3,"Layers"),i.Ub(),i.Ub()}}function IC(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",22),i.cc("click",(function(){return i.xc(e),i.gc().handleDrawClick()})),i.hc(1,"async"),i.Qb(2,"app-icon",23),i.Vb(3,"span",17),i.Kc(4,"Draw"),i.Ub(),i.Ub()}if(2&e){const e=i.gc();let t=null;i.lc("disabled",!(null!=(t=i.ic(1,1,e.selectedChapterReady$))&&t.model))}}function zC(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",24),i.cc("click",(function(){return i.xc(e),i.gc().handleTakeQuizClick()})),i.hc(1,"async"),i.hc(2,"async"),i.Qb(3,"app-icon",25),i.Vb(4,"span",17),i.Kc(5,"Take Quiz"),i.Ub(),i.Ub()}if(2&e){const e=i.gc();let t=null;i.lc("disabled",!(null!=(t=i.ic(1,1,e.selectedChapterReady$))&&t.model)||i.ic(2,3,e.quizActive$))}}function TC(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",26),i.cc("click",(function(){return i.xc(e),i.gc().toggleToolbar("media")})),i.Qb(1,"app-icon",27),i.Kc(2," Open Media Bar "),i.Ub()}}function UC(e,t){if(1&e&&(i.Vb(0,"button",28),i.Kc(1," Settings "),i.Ub()),2&e){i.gc();const e=i.tc(16);i.lc("matMenuTriggerFor",e)}}function DC(e,t){if(1&e&&(i.Vb(0,"button",28),i.Kc(1,"Help"),i.Ub()),2&e){i.gc();const e=i.tc(20);i.lc("matMenuTriggerFor",e)}}function LC(e,t){1&e&&(i.Tb(0),i.Kc(1,"Exit Fullscreen"),i.Sb())}function EC(e,t){1&e&&(i.Tb(0),i.Kc(1,"Enter Fullscreen"),i.Sb())}function FC(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",31),i.cc("click",(function(){return i.xc(e),i.gc(2).handleFullscreenClick()})),i.Ic(1,LC,2,0,"ng-container",3),i.Ic(2,EC,2,0,"ng-container",3),i.Ub()}if(2&e){const e=i.gc(2);i.Db(1),i.lc("ngIf",e.isFullscreen),i.Db(1),i.lc("ngIf",!e.isFullscreen)}}function AC(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",33),i.cc("click",(function(){return i.xc(e),i.gc(3).handleNewTabClick()})),i.Kc(1," Open in New Tab "),i.Ub()}}function RC(e,t){if(1&e&&(i.Tb(0),i.Ic(1,AC,2,0,"button",32),i.Sb()),2&e){const e=i.gc(2);i.Db(1),i.lc("ngIf",!e.canFullscreen)}}function VC(e,t){if(1&e&&(i.Tb(0),i.Ic(1,FC,3,2,"button",29),i.Ic(2,RC,2,1,"ng-container",30),i.Sb()),2&e){const e=i.gc();i.Db(1),i.lc("ngIf",e.canFullscreen),i.Db(1),i.lc("appFlagApplication",e.application.All)("appFlagApplicationMode","exclude")("appFlagApplicationNative",e.nativePlatform.All)}}function NC(e,t){1&e&&(i.Tb(0),i.Kc(1,"Hide Labels"),i.Sb())}function BC(e,t){1&e&&(i.Tb(0),i.Kc(1,"Show Labels"),i.Sb())}function HC(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",34),i.cc("click",(function(){return i.xc(e),i.gc().handleToggleLabelsClick()})),i.Ic(1,NC,2,0,"ng-container",3),i.hc(2,"async"),i.Ic(3,BC,2,0,"ng-container",3),i.hc(4,"async"),i.Ub()}if(2&e){const e=i.gc();i.Db(1),i.lc("ngIf",i.ic(2,2,e.showLabels$)),i.Db(2),i.lc("ngIf",!i.ic(4,4,e.showLabels$))}}let QC=(()=>{class e{constructor(e,t,n,i,o){this.viewUIService=e,this.viewService=t,this.quizService=n,this.changeDetectorRef=i,this.store=o,this.application=s,this.nativePlatform=hd,this.bookmarkViewMode=B,this.viewUI=Xa,this.isFullscreen=!1,this.canFullscreen=!1,this.ngUnsubscribe=new k.a,this.visibilityLayersVisible=!1,this.showTakeQuiz=!1}ngOnInit(){this.canFullscreen=Io.canFullscreen(),this.initFullscreenListener(),this.initLayoutListener()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initFullscreenListener(){this.fullscreen$=Io.onFullscreenChange(),this.fullscreen$.pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.isFullscreen=Io.isFullscreen(),this.changeDetectorRef.markForCheck()})}initLayoutListener(){this.store.select(mr.getUI).pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(()=>{this.visibilityLayersVisible=this.viewUIService.isVisible(Xa.VisibilityLayers),this.changeDetectorRef.markForCheck()})}initTakeQuizButton(){Object(Ta.b)([this.hasQuiz$,this.quizEnabled$,this.quizLocked$,this.selectedBookmarkViewMode$]).pipe(Object(F.a)(([e,t,n,i])=>!!e&&!!t&&(!(!n||i===B.Content)||void 0)),Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.showTakeQuiz=e})}handleToggleLabelsClick(){this.viewService.showLabels()}handleFullscreenClick(){Io.toggleFullscreen()}handleTutorialClick(){this.viewService.toggleTutorial(!0)}handleTakeQuizClick(){this.quizService.startQuiz()}handleHelpBasicsClick(){this.viewService.toggleHelp(z.Basics)}handleHelpShortcutsClick(){this.viewService.toggleHelp(z.Shortcuts)}handlePresentClick(){this.viewService.togglePresentation()}handleNewTabClick(){this.viewService.openInNewTab()}handleSearchClick(){this.viewService.toggleSearch(pr.List,!0)}handleTreeClick(){this.viewService.toggleSearch(pr.Tree,!0)}handleDrawClick(){this.viewService.toggleWhiteboard(!0)}toggleToolbar(e){this.viewService.toggleToolbar(e)}isEnabled(e){return this.viewUIService.isUIEnabled(e)}isVisible(e){return this.viewUIService.isVisible(e)}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(rc),i.Pb(Dl),i.Pb(Ag),i.Pb(i.i),i.Pb(d.g))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-menu"]],decls:28,vars:22,consts:[["type","button","data-test","viewMenu","matTooltip","Menu","app-pin-button","","buttonType","secondary","icon","bars","aria-label","View Menu",2,"width","52px","height","52px",3,"matMenuTriggerFor","fill"],[1,"view-menu"],["viewMenu","matMenu"],[4,"ngIf"],["mat-menu-item","","data-test","viewLayersButton",3,"click",4,"ngIf"],["mat-menu-item","","data-test","viewDrawButton",3,"disabled","click",4,"ngIf"],["mat-menu-item","","data-test","viewQuizButton",3,"disabled","click",4,"ngIf"],["mat-menu-item","","data-test","viewMediaBarButton",3,"click",4,"ngIf"],["mat-menu-item","",3,"matMenuTriggerFor",4,"ngIf"],["settingsMenu","matMenu"],["mat-menu-item","","data-test","viewToggleLabels",3,"click",4,"ngIf"],["helpMenu","matMenu"],["mat-menu-item","","data-test","viewLaunchTutorial",3,"disabled","click"],["mat-menu-item","","data-test","view3DNavigationBasics",3,"click"],["mat-menu-item","","data-test","viewKeyboardShortcuts",3,"click"],["mat-menu-item","","data-test","viewTreeButton",3,"click"],["icon","sitemap",1,"view-menu__icon"],[1,"ml-2"],["mat-menu-item","","data-test","viewSearchButton",3,"click"],["icon","search",1,"view-menu__icon"],["mat-menu-item","","data-test","viewLayersButton",3,"click"],["icon","layer-group",1,"view-menu__icon"],["mat-menu-item","","data-test","viewDrawButton",3,"disabled","click"],["icon","signature",1,"view-menu__icon"],["mat-menu-item","","data-test","viewQuizButton",3,"disabled","click"],["icon","check",1,"view-menu__icon"],["mat-menu-item","","data-test","viewMediaBarButton",3,"click"],["icon","play",1,"view-menu__icon"],["mat-menu-item","",3,"matMenuTriggerFor"],["mat-menu-item","","data-test","viewHandleFullscreen",3,"click",4,"ngIf"],[4,"appFlagApplication","appFlagApplicationMode","appFlagApplicationNative"],["mat-menu-item","","data-test","viewHandleFullscreen",3,"click"],["mat-menu-item","",3,"click",4,"ngIf"],["mat-menu-item","",3,"click"],["mat-menu-item","","data-test","viewToggleLabels",3,"click"]],template:function(e,t){if(1&e&&(i.Qb(0,"button",0),i.Vb(1,"mat-menu",1,2),i.Ic(3,PC,10,0,"ng-container",3),i.Ic(4,MC,4,0,"button",4),i.Ic(5,IC,5,3,"button",5),i.Ic(6,zC,6,5,"button",6),i.hc(7,"async"),i.hc(8,"async"),i.hc(9,"async"),i.hc(10,"async"),i.Ic(11,TC,3,0,"button",7),i.Qb(12,"mat-divider"),i.Ic(13,UC,2,1,"button",8),i.Ic(14,DC,2,1,"button",8),i.Ub(),i.Vb(15,"mat-menu",null,9),i.Ic(17,VC,3,4,"ng-container",3),i.Ic(18,HC,5,6,"button",10),i.Ub(),i.Vb(19,"mat-menu",null,11),i.Vb(21,"button",12),i.cc("click",(function(){return t.handleTutorialClick()})),i.hc(22,"async"),i.Kc(23," Launch Tutorial "),i.Ub(),i.Vb(24,"button",13),i.cc("click",(function(){return t.handleHelpBasicsClick()})),i.Kc(25," 3D Navigation Basics "),i.Ub(),i.Vb(26,"button",14),i.cc("click",(function(){return t.handleHelpShortcutsClick()})),i.Kc(27," Keyboard Shortcuts "),i.Ub(),i.Ub()),2&e){const e=i.tc(2);let n=null;i.lc("matMenuTriggerFor",e)("fill",!0),i.Db(3),i.lc("ngIf",t.isEnabled(t.viewUI.Search)),i.Db(1),i.lc("ngIf",t.visibilityLayersVisible),i.Db(1),i.lc("ngIf",t.isEnabled(t.viewUI.Whiteboard)),i.Db(1),i.lc("ngIf",i.ic(7,12,t.hasQuiz$)&&i.ic(8,14,t.quizEnabled$)&&!i.ic(9,16,t.quizLocked$)&&i.ic(10,18,t.selectedBookmarkViewMode$)!==t.bookmarkViewMode.Content),i.Db(5),i.lc("ngIf",t.isVisible(t.viewUI.ScrubberItem)),i.Db(2),i.lc("ngIf",t.isEnabled(t.viewUI.Fullscreen)||t.isEnabled(t.viewUI.ToggleLabels)),i.Db(1),i.lc("ngIf",t.isEnabled(t.viewUI.Help)),i.Db(3),i.lc("ngIf",t.isEnabled(t.viewUI.Fullscreen)),i.Db(1),i.lc("ngIf",t.isEnabled(t.viewUI.ToggleLabels)),i.Db(3),i.lc("disabled",!(null!=(n=i.ic(22,20,t.selectedChapterReady$))&&n.model))}},directives:[ou,ru.c,gd.d,gd.a,Z.l,md.a,gd.b,dl,bd],pipes:[Z.b],styles:[".view-menu__icon[_ngcontent-%COMP%]{display:inline-flex;justify-content:center;width:16px}"],changeDetection:0}),jC([Object(d.d)(_C.getSelectedBookmarkViewMode),kC("design:type",P.a)],e.prototype,"selectedBookmarkViewMode$",void 0),jC([Object(d.d)(Or.getSelectedChapterReadyState),kC("design:type",P.a)],e.prototype,"selectedChapterReady$",void 0),jC([Object(d.d)(xs.hasQuiz),kC("design:type",P.a)],e.prototype,"hasQuiz$",void 0),jC([Object(d.d)(xs.getQuizEnabled),kC("design:type",P.a)],e.prototype,"quizEnabled$",void 0),jC([Object(d.d)(xs.getQuizModeLocked),kC("design:type",P.a)],e.prototype,"quizLocked$",void 0),jC([Object(d.d)(xs.getQuizModeActive),kC("design:type",P.a)],e.prototype,"quizActive$",void 0),jC([Object(d.d)(Er.getShowLabels),kC("design:type",P.a)],e.prototype,"showLabels$",void 0),e})();var $C=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},qC=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function WC(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",8),i.cc("touchend",(function(){return i.xc(e),i.gc(2).setZoomFixed("out")}))("mouseup",(function(){return i.xc(e),i.gc(2).setZoomFixed("out")}))("keyup.enter",(function(){return i.xc(e),i.gc(2).setZoomFixed("out")})),i.Ub()}}function KC(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",9),i.cc("touchend",(function(){return i.xc(e),i.gc(2).setZoomFixed("in")}))("mouseup",(function(){return i.xc(e),i.gc(2).setZoomFixed("in")}))("keyup.enter",(function(){return i.xc(e),i.gc(2).setZoomFixed("in")})),i.Ub()}}function GC(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",10),i.cc("click",(function(){return i.xc(e),i.gc(2).returnToChapterCamera()})),i.Vb(1,"span",11),i.Kc(2,"Clicking this button will reset the camera viewing the 3D model"),i.Ub(),i.Ub()}}function ZC(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",12),i.cc("click",(function(){return i.xc(e),i.gc(2).togglePan()})),i.hc(1,"async"),i.hc(2,"async"),i.hc(3,"async"),i.Vb(4,"span",11),i.Kc(5,"Clicking this button changes whether the mouse movement rotates or pans the camera"),i.Ub(),i.Ub()}if(2&e){const e=i.gc(2);i.lc("selected","pan"===i.ic(1,3,e.panMode$))("matTooltip","pan"===i.ic(2,5,e.panMode$)?"Switch to Rotate Mode":"Switch to Pan Mode"),i.Eb("aria-pressed","pan"===i.ic(3,7,e.panMode$))}}function JC(e,t){if(1&e&&(i.Vb(0,"app-pillbox",2),i.Vb(1,"ul",3),i.Vb(2,"li"),i.Ic(3,WC,1,0,"button",4),i.Ub(),i.Vb(4,"li"),i.Ic(5,KC,1,0,"button",5),i.Ub(),i.Vb(6,"li"),i.Ic(7,GC,3,0,"button",6),i.Ub(),i.Vb(8,"li"),i.Ic(9,ZC,6,9,"button",7),i.Ub(),i.Ub(),i.Ub()),2&e){const e=i.gc();i.Db(3),i.lc("ngIf",e.showZoom),i.Db(2),i.lc("ngIf",e.showZoom),i.Db(2),i.lc("ngIf",e.showResetPosition),i.Db(2),i.lc("ngIf",e.showPan)}}let XC=(()=>{class e{constructor(e,t,n){this.store=e,this.cameraService=t,this.liveAnnouncer=n,this.showNav=!0,this.showZoom=!0,this.showPan=!0,this.showResetPosition=!0,this.viewLayout=Xa,this.toolEnum=kr,this.expandNav=!1,this.breakpointEnum=$a,this.padding="none",this.ngUnsubscribe=new k.a}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}setZoomFixed(e){this.cameraService.setCameraZoomWithVelocity("in"===e?-8:8),this.liveAnnouncer.announce(`zoom ${e} complete`)}returnToChapterCamera(){const e=this.store.selectSnapshot(Or.getSelectedChapter);this.store.dispatch(new Zt(e.camera.location)).subscribe(()=>{this.liveAnnouncer.announce("recenter complete")})}resetChapter(){this.returnToChapterCamera();const e=this.store.selectSnapshot(Or.getSelectedChapterId);this.store.dispatch(new zi.UndoAll(e)),this.store.dispatch(new Ii.UpdateNodesChecked(!1)),this.store.dispatch(new po)}centerCamera(){this.store.dispatch(new Xe)}togglePan(){const e="pan"===this.store.selectSnapshot(jr.getPanMode)?"rotate":"pan";this.store.dispatch(new pn(e))}toggleNav(){this.expandNav=!this.expandNav}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.g),i.Pb(yn),i.Pb(Tl.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-engine-camera-bar"]],inputs:{showNav:"showNav",showZoom:"showZoom",showPan:"showPan",showResetPosition:"showResetPosition"},decls:2,vars:1,consts:[["data-test","cameraBar",1,"camera-bar"],["eventCategory","Engine 3D Controls","orientation","vertical",4,"ngIf"],["eventCategory","Engine 3D Controls","orientation","vertical"],["aria-label","Camera Control Buttons",1,"camera-bar__nav"],["app-pin-button","","buttonType","ghost","icon","minus","tabIndex","0","data-test","cameraZoomOut","matTooltip","Zoom Out","matTooltipPosition","left",3,"touchend","mouseup","keyup.enter",4,"ngIf"],["app-pin-button","","buttonType","ghost","icon","plus","tabIndex","0","data-test","cameraZoomIn","matTooltip","Zoom In","matTooltipPosition","left",3,"touchend","mouseup","keyup.enter",4,"ngIf"],["app-pin-button","","icon","location","buttonType","ghost","tabIndex","0","matTooltip","Recenter 3D Model","matTooltipPosition","left","data-test","cameraReset",3,"click",4,"ngIf"],["app-pin-button","","tabIndex","0","icon","arrows-alt","buttonType","ghost","matTooltipPosition","left","data-test","cameraPan",3,"selected","matTooltip","click",4,"ngIf"],["app-pin-button","","buttonType","ghost","icon","minus","tabIndex","0","data-test","cameraZoomOut","matTooltip","Zoom Out","matTooltipPosition","left",3,"touchend","mouseup","keyup.enter"],["app-pin-button","","buttonType","ghost","icon","plus","tabIndex","0","data-test","cameraZoomIn","matTooltip","Zoom In","matTooltipPosition","left",3,"touchend","mouseup","keyup.enter"],["app-pin-button","","icon","location","buttonType","ghost","tabIndex","0","matTooltip","Recenter 3D Model","matTooltipPosition","left","data-test","cameraReset",3,"click"],[1,"visually-hidden"],["app-pin-button","","tabIndex","0","icon","arrows-alt","buttonType","ghost","matTooltipPosition","left","data-test","cameraPan",3,"selected","matTooltip","click"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Ic(1,JC,10,4,"app-pillbox",1),i.Ub()),2&e&&(i.Db(1),i.lc("ngIf",t.showNav))},directives:[Z.l,xO,ou,ru.c],pipes:[Z.b],styles:[":host{position:relative}.camera-bar{display:flex;flex-direction:column;align-items:center}.camera-bar button:not(:first-child){margin-top:4px}.camera-bar__nav{display:flex;flex-direction:column-reverse;overflow:hidden;transition:height .15s ease-in-out;justify-content:space-between}"],encapsulation:2,data:{animation:[Object(Zl.n)("expand",[Object(Zl.m)(":enter",[Object(Zl.j)([Object(Zl.l)({height:0}),Object(Zl.e)("150ms ease-in-out",Object(Zl.l)({height:"*"}))])]),Object(Zl.m)(":leave",[Object(Zl.j)([Object(Zl.e)("150ms ease-in-out",Object(Zl.l)({height:"0"}))])])]),Object(Zl.n)("show",[Object(Zl.m)(":enter",[Object(Zl.j)([Object(Zl.l)({height:"0"}),Object(Zl.e)("125ms ease-in-out",Object(Zl.l)({height:"*"}))])]),Object(Zl.m)(":leave",[Object(Zl.j)([Object(Zl.e)("125ms 125ms ease-in-out",Object(Zl.l)({height:"0"}))])])])]},changeDetection:0}),$C([Object(d.d)(jr.getPanMode),qC("design:type",P.a)],e.prototype,"panMode$",void 0),$C([Object(d.d)(Ja.getBreakpoint),qC("design:type",P.a)],e.prototype,"breakpoint$",void 0),e})(),YC=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-button-loader"]],decls:5,vars:0,consts:[["tabindex","0","type","button","aria-label","Interact in 3D","type","button",1,"button-loader"],[1,"button-loader__button"],["src","assets/images/widget/loading_experience/interact-in-3d-arrow.svg","alt","Interact in 3D",1,"button-loader__3d-arrow"],[1,"button-loader__label"]],template:function(e,t){1&e&&(i.Vb(0,"button",0),i.Vb(1,"div",1),i.Qb(2,"img",2),i.Vb(3,"div",3),i.Kc(4,"Interact in 3D"),i.Ub(),i.Ub(),i.Ub())},styles:[".m-1[_ngcontent-%COMP%]{margin:4px!important}.mv-1[_ngcontent-%COMP%]{margin-top:4px!important;margin-bottom:4px!important}.mh-1[_ngcontent-%COMP%]{margin-left:4px!important;margin-right:4px!important}.mt-1[_ngcontent-%COMP%]{margin-top:4px!important}.mr-1[_ngcontent-%COMP%]{margin-right:4px!important}.mb-1[_ngcontent-%COMP%]{margin-bottom:4px!important}.ml-1[_ngcontent-%COMP%]{margin-left:4px!important}.p-1[_ngcontent-%COMP%]{padding:4px!important}.pv-1[_ngcontent-%COMP%]{padding-top:4px!important;padding-bottom:4px!important}.ph-1[_ngcontent-%COMP%]{padding-left:4px!important;padding-right:4px!important}.pt-1[_ngcontent-%COMP%]{padding-top:4px!important}.pr-1[_ngcontent-%COMP%]{padding-right:4px!important}.pb-1[_ngcontent-%COMP%]{padding-bottom:4px!important}.pl-1[_ngcontent-%COMP%]{padding-left:4px!important}.m-2[_ngcontent-%COMP%]{margin:8px!important}.mv-2[_ngcontent-%COMP%]{margin-top:8px!important;margin-bottom:8px!important}.mh-2[_ngcontent-%COMP%]{margin-left:8px!important;margin-right:8px!important}.mt-2[_ngcontent-%COMP%]{margin-top:8px!important}.mr-2[_ngcontent-%COMP%]{margin-right:8px!important}.mb-2[_ngcontent-%COMP%]{margin-bottom:8px!important}.ml-2[_ngcontent-%COMP%]{margin-left:8px!important}.p-2[_ngcontent-%COMP%]{padding:8px!important}.pv-2[_ngcontent-%COMP%]{padding-top:8px!important;padding-bottom:8px!important}.ph-2[_ngcontent-%COMP%]{padding-left:8px!important;padding-right:8px!important}.pt-2[_ngcontent-%COMP%]{padding-top:8px!important}.pr-2[_ngcontent-%COMP%]{padding-right:8px!important}.pb-2[_ngcontent-%COMP%]{padding-bottom:8px!important}.pl-2[_ngcontent-%COMP%]{padding-left:8px!important}.m-3[_ngcontent-%COMP%]{margin:12px!important}.mv-3[_ngcontent-%COMP%]{margin-top:12px!important;margin-bottom:12px!important}.mh-3[_ngcontent-%COMP%]{margin-left:12px!important;margin-right:12px!important}.mt-3[_ngcontent-%COMP%]{margin-top:12px!important}.mr-3[_ngcontent-%COMP%]{margin-right:12px!important}.mb-3[_ngcontent-%COMP%]{margin-bottom:12px!important}.ml-3[_ngcontent-%COMP%]{margin-left:12px!important}.p-3[_ngcontent-%COMP%]{padding:12px!important}.pv-3[_ngcontent-%COMP%]{padding-top:12px!important;padding-bottom:12px!important}.ph-3[_ngcontent-%COMP%]{padding-left:12px!important;padding-right:12px!important}.pt-3[_ngcontent-%COMP%]{padding-top:12px!important}.pr-3[_ngcontent-%COMP%]{padding-right:12px!important}.pb-3[_ngcontent-%COMP%]{padding-bottom:12px!important}.pl-3[_ngcontent-%COMP%]{padding-left:12px!important}.m-4[_ngcontent-%COMP%]{margin:16px!important}.mv-4[_ngcontent-%COMP%]{margin-top:16px!important;margin-bottom:16px!important}.mh-4[_ngcontent-%COMP%]{margin-left:16px!important;margin-right:16px!important}.mt-4[_ngcontent-%COMP%]{margin-top:16px!important}.mr-4[_ngcontent-%COMP%]{margin-right:16px!important}.mb-4[_ngcontent-%COMP%]{margin-bottom:16px!important}.ml-4[_ngcontent-%COMP%]{margin-left:16px!important}.p-4[_ngcontent-%COMP%]{padding:16px!important}.pv-4[_ngcontent-%COMP%]{padding-top:16px!important;padding-bottom:16px!important}.ph-4[_ngcontent-%COMP%]{padding-left:16px!important;padding-right:16px!important}.pt-4[_ngcontent-%COMP%]{padding-top:16px!important}.pr-4[_ngcontent-%COMP%]{padding-right:16px!important}.pb-4[_ngcontent-%COMP%]{padding-bottom:16px!important}.pl-4[_ngcontent-%COMP%]{padding-left:16px!important}.m-5[_ngcontent-%COMP%]{margin:20px!important}.mv-5[_ngcontent-%COMP%]{margin-top:20px!important;margin-bottom:20px!important}.mh-5[_ngcontent-%COMP%]{margin-left:20px!important;margin-right:20px!important}.mt-5[_ngcontent-%COMP%]{margin-top:20px!important}.mr-5[_ngcontent-%COMP%]{margin-right:20px!important}.mb-5[_ngcontent-%COMP%]{margin-bottom:20px!important}.ml-5[_ngcontent-%COMP%]{margin-left:20px!important}.p-5[_ngcontent-%COMP%]{padding:20px!important}.pv-5[_ngcontent-%COMP%]{padding-top:20px!important;padding-bottom:20px!important}.ph-5[_ngcontent-%COMP%]{padding-left:20px!important;padding-right:20px!important}.pt-5[_ngcontent-%COMP%]{padding-top:20px!important}.pr-5[_ngcontent-%COMP%]{padding-right:20px!important}.pb-5[_ngcontent-%COMP%]{padding-bottom:20px!important}.pl-5[_ngcontent-%COMP%]{padding-left:20px!important}.m-6[_ngcontent-%COMP%]{margin:24px!important}.mv-6[_ngcontent-%COMP%]{margin-top:24px!important;margin-bottom:24px!important}.mh-6[_ngcontent-%COMP%]{margin-left:24px!important;margin-right:24px!important}.mt-6[_ngcontent-%COMP%]{margin-top:24px!important}.mr-6[_ngcontent-%COMP%]{margin-right:24px!important}.mb-6[_ngcontent-%COMP%]{margin-bottom:24px!important}.ml-6[_ngcontent-%COMP%]{margin-left:24px!important}.p-6[_ngcontent-%COMP%]{padding:24px!important}.pv-6[_ngcontent-%COMP%]{padding-top:24px!important;padding-bottom:24px!important}.ph-6[_ngcontent-%COMP%]{padding-left:24px!important;padding-right:24px!important}.pt-6[_ngcontent-%COMP%]{padding-top:24px!important}.pr-6[_ngcontent-%COMP%]{padding-right:24px!important}.pb-6[_ngcontent-%COMP%]{padding-bottom:24px!important}.pl-6[_ngcontent-%COMP%]{padding-left:24px!important}.m-7[_ngcontent-%COMP%]{margin:28px!important}.mv-7[_ngcontent-%COMP%]{margin-top:28px!important;margin-bottom:28px!important}.mh-7[_ngcontent-%COMP%]{margin-left:28px!important;margin-right:28px!important}.mt-7[_ngcontent-%COMP%]{margin-top:28px!important}.mr-7[_ngcontent-%COMP%]{margin-right:28px!important}.mb-7[_ngcontent-%COMP%]{margin-bottom:28px!important}.ml-7[_ngcontent-%COMP%]{margin-left:28px!important}.p-7[_ngcontent-%COMP%]{padding:28px!important}.pv-7[_ngcontent-%COMP%]{padding-top:28px!important;padding-bottom:28px!important}.ph-7[_ngcontent-%COMP%]{padding-left:28px!important;padding-right:28px!important}.pt-7[_ngcontent-%COMP%]{padding-top:28px!important}.pr-7[_ngcontent-%COMP%]{padding-right:28px!important}.pb-7[_ngcontent-%COMP%]{padding-bottom:28px!important}.pl-7[_ngcontent-%COMP%]{padding-left:28px!important}.m-8[_ngcontent-%COMP%]{margin:32px!important}.mv-8[_ngcontent-%COMP%]{margin-top:32px!important;margin-bottom:32px!important}.mh-8[_ngcontent-%COMP%]{margin-left:32px!important;margin-right:32px!important}.mt-8[_ngcontent-%COMP%]{margin-top:32px!important}.mr-8[_ngcontent-%COMP%]{margin-right:32px!important}.mb-8[_ngcontent-%COMP%]{margin-bottom:32px!important}.ml-8[_ngcontent-%COMP%]{margin-left:32px!important}.p-8[_ngcontent-%COMP%]{padding:32px!important}.pv-8[_ngcontent-%COMP%]{padding-top:32px!important;padding-bottom:32px!important}.ph-8[_ngcontent-%COMP%]{padding-left:32px!important;padding-right:32px!important}.pt-8[_ngcontent-%COMP%]{padding-top:32px!important}.pr-8[_ngcontent-%COMP%]{padding-right:32px!important}.pb-8[_ngcontent-%COMP%]{padding-bottom:32px!important}.pl-8[_ngcontent-%COMP%]{padding-left:32px!important}.m-9[_ngcontent-%COMP%]{margin:36px!important}.mv-9[_ngcontent-%COMP%]{margin-top:36px!important;margin-bottom:36px!important}.mh-9[_ngcontent-%COMP%]{margin-left:36px!important;margin-right:36px!important}.mt-9[_ngcontent-%COMP%]{margin-top:36px!important}.mr-9[_ngcontent-%COMP%]{margin-right:36px!important}.mb-9[_ngcontent-%COMP%]{margin-bottom:36px!important}.ml-9[_ngcontent-%COMP%]{margin-left:36px!important}.p-9[_ngcontent-%COMP%]{padding:36px!important}.pv-9[_ngcontent-%COMP%]{padding-top:36px!important;padding-bottom:36px!important}.ph-9[_ngcontent-%COMP%]{padding-left:36px!important;padding-right:36px!important}.pt-9[_ngcontent-%COMP%]{padding-top:36px!important}.pr-9[_ngcontent-%COMP%]{padding-right:36px!important}.pb-9[_ngcontent-%COMP%]{padding-bottom:36px!important}.pl-9[_ngcontent-%COMP%]{padding-left:36px!important}.m-10[_ngcontent-%COMP%]{margin:40px!important}.mv-10[_ngcontent-%COMP%]{margin-top:40px!important;margin-bottom:40px!important}.mh-10[_ngcontent-%COMP%]{margin-left:40px!important;margin-right:40px!important}.mt-10[_ngcontent-%COMP%]{margin-top:40px!important}.mr-10[_ngcontent-%COMP%]{margin-right:40px!important}.mb-10[_ngcontent-%COMP%]{margin-bottom:40px!important}.ml-10[_ngcontent-%COMP%]{margin-left:40px!important}.p-10[_ngcontent-%COMP%]{padding:40px!important}.pv-10[_ngcontent-%COMP%]{padding-top:40px!important;padding-bottom:40px!important}.ph-10[_ngcontent-%COMP%]{padding-left:40px!important;padding-right:40px!important}.pt-10[_ngcontent-%COMP%]{padding-top:40px!important}.pr-10[_ngcontent-%COMP%]{padding-right:40px!important}.pb-10[_ngcontent-%COMP%]{padding-bottom:40px!important}.pl-10[_ngcontent-%COMP%]{padding-left:40px!important}.text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.button-loader[_ngcontent-%COMP%]{border:0;width:100%;background:rgba(0,0,0,.2);display:flex;position:fixed;justify-content:center;align-items:center;top:0;bottom:0;left:0;right:0;transition:background-color .25s,opacity .25s;z-index:10000}.button-loader[_ngcontent-%COMP%]:hover{opacity:1;cursor:pointer;background:rgba(0,0,0,.2)}@media print{.button-loader[_ngcontent-%COMP%]{display:none}}.button-loader[_ngcontent-%COMP%]:focus   .button-loader__button[_ngcontent-%COMP%], .button-loader[_ngcontent-%COMP%]:hover   .button-loader__button[_ngcontent-%COMP%]{background-color:#2d72dc;transform:scale(1.1)}.button-loader[_ngcontent-%COMP%]:focus   .button-loader__3d-arrow[_ngcontent-%COMP%], .button-loader[_ngcontent-%COMP%]:hover   .button-loader__3d-arrow[_ngcontent-%COMP%]{transform:scale(1.2)}.button-loader__button[_ngcontent-%COMP%]{display:flex;padding:12px 28px;border-radius:32px;align-items:center;transition:transform .25s,background-color .25s;background-color:rgba(16,24,35,.8)}.button-loader__3d-arrow[_ngcontent-%COMP%]{transition:transform .25s;margin-right:4px}.button-loader__label[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em;color:#fff;font-weight:600;margin-left:4px}"],changeDetection:0}),e})(),eS=(()=>{class e{constructor(e,t,n,i){this.changeRef=e,this.viewService=t,this.bookmarksService=n,this.imagesService=i,this.thumbnailURL=""}ngOnInit(){this.setThumbnailUrl()}handleClick(){this.viewService.toggleOnDemand(!1)}setThumbnailUrl(){this.contentType===o.Bookmark?this.bookmarksService.getBookmarkModel(this.contentId).subscribe(e=>{this.thumbnailURL=e.thumbnail_url,this.changeRef.markForCheck()}):(this.thumbnailURL=this.imagesService.getIndexThumbnail(this.contentId),this.changeRef.markForCheck())}getPoweredByUrl(){return("undefined"==typeof localBaseDirectory?"":localBaseDirectory)+"assets/images/powered-by-biodigital-logo.svg"}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(i.i),i.Pb(Dl),i.Pb($w),i.Pb(vC))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-ondemand"]],inputs:{contentId:"contentId",contentType:"contentType"},decls:5,vars:2,consts:[[1,"ondemand",3,"click"],[1,"ondemand__image",3,"lazyLoad"],[1,"ondemand__logo"],[3,"src"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.cc("click",(function(){return t.handleClick()})),i.Qb(1,"div",1),i.Qb(2,"app-button-loader"),i.Vb(3,"div",2),i.Qb(4,"img",3),i.Ub(),i.Ub()),2&e&&(i.Db(1),i.lc("lazyLoad",t.thumbnailURL),i.Db(3),i.lc("src",t.getPoweredByUrl(),i.Ac))},directives:[Vg.a,YC],styles:[".ondemand__image[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;left:0;right:0;background-size:cover;background-repeat:no-repeat;background-position:50%;filter:blur(6px)}.ondemand__logo[_ngcontent-%COMP%]{position:absolute;bottom:40px;justify-content:center;width:100%;z-index:20000;display:flex}"],changeDetection:0}),e})();const tS=["circle"],nS=["progressCircle"],iS=["progressContainer"];function sS(e,t){if(1&e&&(i.fc(),i.ec(),i.Vb(0,"div",9),i.Kc(1),i.Ub()),2&e){const e=i.gc();i.Db(1),i.Mc("",e.percent,"%")}}const oS=function(e){return{"view-progress--active":e}},rS=function(e){return{"view-progress__ring--pulse":e}};let aS=(()=>{class e{constructor(e,t){this.renderer=e,this.changeDetectorRef=t,this.ngUnsubscribe=new k.a,this.label="Loading...",this._show=!1,this._percent=new bl.a(0)}get show(){return this._show}set show(e){setTimeout(()=>{this._show=e,this.changeDetectorRef.markForCheck()})}get percent(){return Math.floor(this._percent.value)}set percent(e){null!=e&&this._percent.next(e)}ngOnInit(){this.initSizeObserver()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}ngAfterViewInit(){this.updateDimensions(),this.initPercentObserver()}initPercentObserver(){this._percent.pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(()=>{this.label=this.getLoadingLabel(this.percent),this.renderProgress(0===this.percent?100:this.percent),this.changeDetectorRef.markForCheck()})}initSizeObserver(){Object(Uo.a)(window,"resize").pipe(Object(El.a)(10),Object(M.a)(this.ngUnsubscribe)).subscribe(()=>{this.updateDimensions()})}calculateRadius(){return this.getCircleWidth()/2}getCircleWidth(){return this.circleRef.nativeElement.offsetWidth}getRadius(){return this.progressCircleRef.nativeElement.r.baseVal.value}getCircumference(){return 2*this.getRadius()*Math.PI}getOffset(e=100){const t=this.getCircumference();return t-e/100*t}renderProgress(e){e>=100&&(e=100);const t=this.getCircumference(),n=this.getOffset(e);this.renderer.setStyle(this.progressCircleRef.nativeElement,"strokeDasharray",`${t} ${t}`),this.renderer.setStyle(this.progressCircleRef.nativeElement,"strokeDashoffset",""+n)}getLoadingLabel(e){return 100===e?"Launching...":"Loading..."}updateDimensions(){const e=this.calculateRadius();this.renderer.setAttribute(this.progressContainerRef.nativeElement,"width",""+2*e),this.renderer.setAttribute(this.progressContainerRef.nativeElement,"height",""+2*e),this.renderer.setAttribute(this.progressCircleRef.nativeElement,"r",""+(e-6)),this.renderer.setAttribute(this.progressCircleRef.nativeElement,"cx",""+e),this.renderer.setAttribute(this.progressCircleRef.nativeElement,"cy",""+e);const t=this.getCircumference();this.renderer.setStyle(this.progressCircleRef.nativeElement,"strokeDasharray",`${t} ${t}`),this.renderer.setStyle(this.progressCircleRef.nativeElement,"strokeDashoffset",""+t)}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(i.H),i.Pb(i.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-progress"]],viewQuery:function(e,t){if(1&e&&(i.Ec(tS,!0),i.Ec(nS,!0),i.Ec(iS,!0)),2&e){let e;i.sc(e=i.dc())&&(t.circleRef=e.first),i.sc(e=i.dc())&&(t.progressCircleRef=e.first),i.sc(e=i.dc())&&(t.progressContainerRef=e.first)}},inputs:{show:"show",percent:"percent"},decls:10,vars:10,consts:[["data-test","viewProgress","role","alert",1,"view-progress",3,"ngClass"],["aria-hidden","true",1,"view-progress__circle"],["circle",""],[1,"view-progress__ring",3,"ngClass"],["progressContainer",""],[1,"view-progress__ring-inner"],["progressCircle",""],["class","view-progress__count",4,"ngIf"],[1,"view-progress__label"],[1,"view-progress__count"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Vb(1,"div",1,2),i.fc(),i.Vb(3,"svg",3,4),i.Qb(5,"circle",5,6),i.Ub(),i.Ic(7,sS,2,1,"div",7),i.ec(),i.Vb(8,"div",8),i.Kc(9),i.Ub(),i.Ub(),i.Ub()),2&e&&(i.lc("ngClass",i.nc(6,oS,t.show)),i.Eb("aria-busy",t.show),i.Db(1),i.lc("@isOpen",t.show?"open":"closed"),i.Db(2),i.lc("ngClass",i.nc(8,rS,0===t.percent||100===t.percent)),i.Db(4),i.lc("ngIf",t.percent>0&&t.percent<100),i.Db(2),i.Mc(" ",t.label," "))},directives:[Z.i,Z.l],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.view-progress[_ngcontent-%COMP%]{--circleSize:35vw;pointer-events:none;position:absolute;display:flex;justify-content:center;align-items:center;left:0;right:0;top:0;bottom:0;z-index:1000;transition:background-color .15s}@-webkit-keyframes progressPulse{0%{stroke-width:4}50%{stroke-width:1}to{stroke-width:4}}@keyframes progressPulse{0%{stroke-width:4}50%{stroke-width:1}to{stroke-width:4}}.view-progress--active[_ngcontent-%COMP%]{background-color:rgba(0,0,0,.2)}.view-progress__circle[_ngcontent-%COMP%]{transform:scale(0);width:var(--circleSize);height:var(--circleSize);border-radius:50%;background-color:rgba(16,24,35,.8);display:flex;flex-direction:column;align-items:center;justify-content:center;position:relative}.view-progress__count[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em;color:#fff;font-weight:700}.view-progress__label[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em;color:hsla(0,0%,100%,.8)}.view-progress__ring[_ngcontent-%COMP%]{position:absolute;top:0;right:0;bottom:0;left:0;z-index:3;opacity:1;stroke-dashoffset:0;stroke-width:4;stroke:hsla(0,0%,100%,.8);fill:transparent;transform:rotate(-90deg)}.view-progress__ring--pulse[_ngcontent-%COMP%]{-webkit-animation:progressPulse 2s ease-in-out infinite;animation:progressPulse 2s ease-in-out infinite}@media (min-width:600px){.view-progress__circle[_ngcontent-%COMP%]{width:160px;height:160px}}"],data:{animation:[Object(Zl.n)("isOpen",[Object(Zl.k)("open",Object(Zl.l)({transform:"scale(1)"})),Object(Zl.k)("closed",Object(Zl.l)({transform:"scale(0)"})),Object(Zl.m)("closed => open",[Object(Zl.e)("300ms ease-out")]),Object(Zl.m)("open => closed",[Object(Zl.e)("150ms ease-in")])])]},changeDetection:0}),e})();const cS=["viewLoader"],lS=["*"];let pS=(()=>{class e{constructor(e,t,n){this.renderer=e,this.viewService=t,this.actions=n,this.ngUnsubscribe=new k.a}handleClick(){this.renderer.addClass(this.viewLoaderRef.nativeElement,"view-loader--disappear"),setTimeout(()=>{this.viewService.toggleInteract(!1),this.viewService.playChapterFromStart()},250)}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(i.H),i.Pb(Dl),i.Pb(d.b))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-loader"]],viewQuery:function(e,t){if(1&e&&i.Ec(cS,!0),2&e){let e;i.sc(e=i.dc())&&(t.viewLoaderRef=e.first)}},ngContentSelectors:lS,decls:4,vars:0,consts:[["role","dialog",1,"view-loader"],["viewLoader",""],["role","button",3,"click"]],template:function(e,t){1&e&&(i.kc(),i.Vb(0,"div",0,1),i.Vb(2,"div",2),i.cc("click",(function(){return t.handleClick()})),i.jc(3),i.Ub(),i.Ub())},styles:[""],encapsulation:2,changeDetection:0}),e})();const dS=["circle"],uS=["progressCircle"],gS=["progressContainer"];let hS=(()=>{class e{constructor(e){this.renderer=e,this.ngUnsubscribe=new k.a,this._percent=0}get percent(){return this._percent}set percent(e){null!=e&&(this._percent=e,this.setProgress(this.percent))}ngOnInit(){this.initSizeObserver()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}ngAfterViewInit(){this.updateDimensions()}initSizeObserver(){Object(Uo.a)(window,"resize").pipe(Object(El.a)(10),Object(M.a)(this.ngUnsubscribe)).subscribe(()=>{this.updateDimensions()})}calculateRadius(){return this.getCircleWidth()/2}getCircleWidth(){return this.circleRef.nativeElement.offsetWidth}getRadius(){return this.progressCircleRef.nativeElement.r.baseVal.value}getCircumference(){return 2*this.getRadius()*Math.PI}getOffset(e=100){const t=this.getCircumference();return t-e/100*t}setProgress(e=0){e>=100&&(e=100);const t=this.getCircumference(),n=this.getOffset(e);this.renderer.setStyle(this.progressCircleRef.nativeElement,"strokeDasharray",`${t} ${t}`),this.renderer.setStyle(this.progressCircleRef.nativeElement,"strokeDashoffset",""+n)}updateDimensions(){const e=this.calculateRadius();this.renderer.setAttribute(this.progressContainerRef.nativeElement,"width",""+2*e),this.renderer.setAttribute(this.progressContainerRef.nativeElement,"height",""+2*e),this.renderer.setAttribute(this.progressCircleRef.nativeElement,"r",""+(e-6)),this.renderer.setAttribute(this.progressCircleRef.nativeElement,"cx",""+e),this.renderer.setAttribute(this.progressCircleRef.nativeElement,"cy",""+e);const t=this.getCircumference();this.renderer.setStyle(this.progressCircleRef.nativeElement,"strokeDasharray",`${t} ${t}`),this.renderer.setStyle(this.progressCircleRef.nativeElement,"strokeDashoffset",""+t),setTimeout(()=>{this.renderer.setStyle(this.progressCircleRef.nativeElement,"transition","stroke-dashoffset 300ms")})}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(i.H))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-play-loader"]],viewQuery:function(e,t){if(1&e&&(i.Ec(dS,!0),i.Ec(uS,!0),i.Ec(gS,!0)),2&e){let e;i.sc(e=i.dc())&&(t.circleRef=e.first),i.sc(e=i.dc())&&(t.progressCircleRef=e.first),i.sc(e=i.dc())&&(t.progressContainerRef=e.first)}},inputs:{percent:"percent"},decls:10,vars:0,consts:[["tabindex","0","type","button","aria-label","Interact in 3D",1,"play-loader"],[1,"play-loader__circle"],["circle",""],[1,"play-loader__ring"],["progressContainer",""],[1,"play-loader__ring-inner"],["progressCircle",""],["icon","play",1,"play-loader__icon"],[1,"play-loader__label"]],template:function(e,t){1&e&&(i.Vb(0,"button",0),i.Vb(1,"div",1,2),i.fc(),i.Vb(3,"svg",3,4),i.Qb(5,"circle",5,6),i.Ub(),i.ec(),i.Qb(7,"app-icon",7),i.Vb(8,"div",8),i.Kc(9,"3D"),i.Ub(),i.Ub(),i.Ub())},directives:[dl],styles:[".play-loader[_ngcontent-%COMP%]{--buttonSize:35vw;border:0;width:100%;background:rgba(0,0,0,.2);display:flex;position:fixed;justify-content:center;align-items:center;top:0;bottom:0;left:0;right:0;transition:background-color .25s,opacity .25s;z-index:10000}.play-loader[_ngcontent-%COMP%]:hover{opacity:1;cursor:pointer;background:rgba(0,0,0,.2)}.play-loader[_ngcontent-%COMP%]:focus   .play-loader__circle[_ngcontent-%COMP%], .play-loader[_ngcontent-%COMP%]:hover   .play-loader__circle[_ngcontent-%COMP%]{background:hsla(0,0%,100%,.8);transform:scale(1.1)}.play-loader[_ngcontent-%COMP%]:focus   .play-loader__icon[_ngcontent-%COMP%], .play-loader[_ngcontent-%COMP%]:hover   .play-loader__icon[_ngcontent-%COMP%]{color:#2d72dc;transform:scale(1.2)}.play-loader[_ngcontent-%COMP%]:focus   .play-loader__label[_ngcontent-%COMP%], .play-loader[_ngcontent-%COMP%]:hover   .play-loader__label[_ngcontent-%COMP%]{color:#fff}.play-loader[_ngcontent-%COMP%]:focus   .play-loader__ring[_ngcontent-%COMP%], .play-loader[_ngcontent-%COMP%]:hover   .play-loader__ring[_ngcontent-%COMP%]{stroke:#2d72dc}.play-loader__circle[_ngcontent-%COMP%]{width:var(--buttonSize);height:var(--buttonSize);border-radius:50%;background-color:rgba(16,24,35,.8);display:flex;align-items:center;justify-content:center;position:relative;transition:background-color .25s,color .25s,transform .25s}.play-loader__icon[_ngcontent-%COMP%]{font-size:calc(var(--buttonSize) / 2);color:hsla(0,0%,100%,.9);transition:color .25s,transform .25s;margin-right:-10%}.play-loader__label[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;display:flex;justify-content:center;align-items:center;z-index:2;font-weight:600}.play-loader__ring[_ngcontent-%COMP%]{position:absolute;top:0;right:0;bottom:0;left:0;z-index:3;stroke-width:4;stroke:#fff;fill:transparent;transform:rotate(-90deg)}@media (min-width:600px){.play-loader__circle[_ngcontent-%COMP%]{width:160px;height:160px}.play-loader__icon[_ngcontent-%COMP%]{font-size:80px}}"],changeDetection:0}),e})(),bS=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-hand-loader"]],decls:6,vars:0,consts:[["tabindex","0","type","button","aria-label","Interact in 3D",1,"hand-loader"],[1,"hand-loader__container"],[1,"hand-loader__circle"],["src","assets/images/widget/loading_experience/interact-in-3d-hand.svg","alt","Interact in 3D",1,"hand-loader__3d-hand"],[1,"hand-loader__label"]],template:function(e,t){1&e&&(i.Vb(0,"button",0),i.Vb(1,"div",1),i.Qb(2,"div",2),i.Qb(3,"img",3),i.Vb(4,"div",4),i.Kc(5,"Interact in 3D"),i.Ub(),i.Ub(),i.Ub())},styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.hand-loader[_ngcontent-%COMP%]{border:0;width:100%;background:rgba(0,0,0,.2);display:flex;position:fixed;justify-content:center;align-items:center;top:0;bottom:0;left:0;right:0;transition:background-color .25s,opacity .25s;z-index:10000}.hand-loader[_ngcontent-%COMP%]:hover{opacity:1;cursor:pointer;background:rgba(0,0,0,.2)}@-webkit-keyframes handKeyframes{0%{transform:scale(1.2)}25%{transform:scale(1)}40%{transform:scale(1)}60%{transform:scale(1.2)}to{transform:scale(1.2)}}@keyframes handKeyframes{0%{transform:scale(1.2)}25%{transform:scale(1)}40%{transform:scale(1)}60%{transform:scale(1.2)}to{transform:scale(1.2)}}@-webkit-keyframes circleKeyframes{0%{transform:scale(0)}20%{transform:scale(0);opacity:1}to{transform:scale(1);opacity:0}}@keyframes circleKeyframes{0%{transform:scale(0)}20%{transform:scale(0);opacity:1}to{transform:scale(1);opacity:0}}.hand-loader[_ngcontent-%COMP%]:focus   .hand-loader__3d-hand[_ngcontent-%COMP%], .hand-loader[_ngcontent-%COMP%]:hover   .hand-loader__3d-hand[_ngcontent-%COMP%]{filter:drop-shadow(0 0 8px #2d72dc)}.hand-loader__container[_ngcontent-%COMP%]{position:relative;width:200px;height:200px}.hand-loader__circle[_ngcontent-%COMP%]{background-color:#fff;position:absolute;left:50%;margin-left:-40.5px;margin-top:-1.5px;width:70px;height:70px;border-radius:50%;-webkit-animation:circleKeyframes 2s infinite;animation:circleKeyframes 2s infinite}.hand-loader__3d-hand[_ngcontent-%COMP%]{-webkit-animation:handKeyframes 2s ease-in-out infinite;animation:handKeyframes 2s ease-in-out infinite;position:absolute;height:96px;width:86px;left:50%;margin-left:-43px;margin-top:27px;transition:filter .3s ease-out}.hand-loader__label[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em;font-weight:600;color:#fff;text-shadow:0 1px 5px #000;bottom:40px;position:absolute;text-align:center;width:100%}"],changeDetection:0}),e})();const mS=["app-view-rounded-button",""];function fS(e,t){if(1&e&&i.Qb(0,"app-icon",3),2&e){const e=i.gc();i.lc("icon",e.icon)}}let yS=(()=>{class e{constructor(){this.iconPlacement="left",this.compact=!1,this.buttonType="outline"}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["button","app-view-rounded-button",""]],inputs:{icon:"icon",iconPlacement:"iconPlacement",label:"label",compact:"compact",buttonType:"buttonType",shadow:"shadow"},attrs:mS,decls:4,vars:12,consts:[[1,"view-rounded-button"],["class","view-rounded-button__icon mh-1",3,"icon",4,"ngIf"],[1,"view-rounded-button__label","mh-1"],[1,"view-rounded-button__icon","mh-1",3,"icon"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Ic(1,fS,1,1,"app-icon",1),i.Vb(2,"div",2),i.Kc(3),i.Ub(),i.Ub()),2&e&&(i.Hb("view-rounded-button--outline","outline"===t.buttonType)("view-rounded-button--solid","solid"===t.buttonType)("view-rounded-button--shadow",t.shadow)("view-rounded-button--compact",t.compact)("view-rounded-button--reverse","right"===t.iconPlacement),i.Db(1),i.lc("ngIf",t.icon),i.Db(2),i.Lc(t.label))},directives:[Z.l,dl],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3535}.text-info{color:#2d72dc}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}button[app-view-rounded-button]{border-color:transparent;background:none;border-width:0;padding:0;outline:none;margin:0;pointer-events:all}button[app-view-rounded-button]:focus .view-rounded-button,button[app-view-rounded-button]:hover .view-rounded-button{color:#f9fafd;border-color:#f9fafd;background:rgba(249,250,253,.25)}button[app-view-rounded-button]:focus .view-rounded-button--solid,button[app-view-rounded-button]:hover .view-rounded-button--solid{border-color:rgba(249,250,253,.25)}.view-rounded-button{cursor:pointer;display:flex;flex-direction:row;align-items:center;justify-content:center;padding:12px 16px;border-radius:24px;color:#f9fafd;border:1px solid #f9fafd}.view-rounded-button__label{font-size:16px;letter-spacing:.4px;line-height:1.4em}.view-rounded-button--solid{color:#060502;border-color:#060502;background:#f9fafd}.view-rounded-button--shadow{box-shadow:0 0 8px rgba(0,0,0,.32)}.view-rounded-button--reverse{flex-direction:row-reverse}.view-rounded-button--compact{padding:4px 8px}"],encapsulation:2,changeDetection:0}),e})();var xS=function(e){return e.CameraZoom="camera-zoom",e.CameraRotate="camera-rotate",e.CameraPan="camera-pan",e.NodeSelection="node-selection",e}({});function vS(e,t,n=1e3,i=.001){return CS(e).pipe(Object(_O.a)(t.getCameraZoom()),Object(F.a)(()=>t.getCameraZoom()),Object(ml.a)(),Object(F.a)(([e,t])=>t-e),Object(I.a)(e=>Math.abs(e)>i),Object(El.a)(n))}function OS(e,t,n=125){return CS(e).pipe(Object(_O.a)(t.getLookDirection()),Object(F.a)(()=>t.getLookDirection()),Object(ml.a)(),Object(F.a)(([e,t])=>function(e,t){return fn.a.angle(e,t)>.001}(e,t)),Object(I.a)(e=>e),Object(El.a)(n))}function wS(e){return{camera:e.getCamera(),zoom:e.getCameraZoom()}}function CS(e){return e.getEvent(At.CameraRested)}function SS(e){const{eye:t,look:n}=e,i=fn.a.fromValues(t.x,t.y,t.z),s=fn.a.fromValues(n.x,n.y,n.z),o=fn.a.create();return fn.a.sub(o,i,s),o}var _S=n("vqkR");function jS(e,t){if(1&e&&(i.Vb(0,"h2",6),i.Kc(1),i.Ub()),2&e){const e=i.gc(2);i.Db(1),i.Mc(" ",e.title," ")}}function kS(e,t){if(1&e&&i.Qb(0,"img",7),2&e){const e=i.gc(2);i.lc("src",e.image,i.Ac)("alt",e.alt)}}function PS(e,t){if(1&e&&(i.Vb(0,"div",1),i.Ic(1,jS,2,1,"h2",2),i.Vb(2,"article",3),i.jc(3),i.Ub(),i.Ic(4,kS,1,2,"img",4),i.Vb(5,"div",5),i.jc(6,1),i.Ub(),i.Ub()),2&e){const e=i.gc();i.Hb("slide--expanded","expanded"===e.spacing),i.lc("@refresh",void 0),i.Db(1),i.lc("ngIf",e.title),i.Db(3),i.lc("ngIf",e.image)}}const MS=["*",[["","slide-footer",""]]],IS=["*","[slide-footer]"];let zS=(()=>{class e{constructor(e,t,n,s,o){this.store=e,this.actions=t,this.engineService=n,this.cameraService=s,this.changeRef=o,this.alt="",this.spacing="compact",this.exitEnabled=!0,this.triggerDelay=300,this.triggerComplete=new i.p,this._shown=!1,this.ngUnsubscribe=new k.a}set shown(e){this._shown=e,this.initTrigger(),this.changeRef.markForCheck()}get shown(){return this._shown}ngOnInit(){}ngAfterViewInit(){this.initTrigger()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initTrigger(){if(this.ngUnsubscribe.next(),this.shown&&this.trigger){const e=this.resetCamera(),t=this.store.selectSnapshot(mr.getCanTouch);(function(e,t,n,i,s){switch(e){case xS.CameraZoom:return s?vS(n,i):function(e,t,n=1e3,i=.001){const s=e.getCanvas(),o=Object(Uo.a)(s,"wheel"),r=Object(Uo.a)(s,"touchmove").pipe(Object(I.a)(e=>2===e.touches.length)),a=vS(e,t,n,i);return Object(Do.a)(o,r).pipe(Object(Us.a)(()=>a))}(n,i);case xS.CameraPan:return function(e,t,n=125){const i=e.getCanvas(),s=Object(Uo.a)(i,"mousemove").pipe(Object(I.a)(e=>1===e.buttons&&e.shiftKey||2===e.buttons||4===e.buttons)),o=Object(Uo.a)(i,"touchmove").pipe(Object(I.a)(e=>2===e.touches.length)),r=function(e,t,n=125){return CS(e).pipe(Object(_O.a)(wS(t)),Object(F.a)(()=>wS(t)),Object(El.a)(n),Object(ml.a)(),Object(F.a)(([e,t])=>function(e,t){const n=SS(e.camera),i=SS(t.camera),s=fn.a.create();fn.a.sub(s,n,i);const o=s.reduce((e,t)=>e+t),r=t.zoom-e.zoom;return(0!==r||0!==o)&&Math.abs(o)<1&&Math.abs(r)<.001}(e,t)),Object(I.a)(e=>e))}(e,t,n);return Object(Do.a)(s,o).pipe(Object(Us.a)(()=>r))}(n,i);case xS.CameraRotate:return s?OS(n,i):function(e,t,n,i=1e3){const s=t.getCanvas(),o=Object(Uo.a)(s,"mousemove").pipe(Object(I.a)(e=>1===e.buttons)),r=Object(Uo.a)(s,"touchmove").pipe(Object(I.a)(e=>1===e.touches.length)),a=OS(t,n,i);return Object(Do.a)(o,r).pipe(Object(Us.a)(()=>a),Object(I.a)(()=>"rotate"===e.selectSnapshot(jr.getPanMode)),Object(El.a)(125))}(t,n,i);case xS.NodeSelection:return function(e){return e.select(Bi.getCheckedNodes).pipe(Object(ml.a)(),Object(I.a)(([e,t])=>t.length>0))}(t)}})(this.trigger,this.store,this.engineService,this.cameraService,t).pipe(Object(_S.a)(e),Object(ka.a)(this.triggerDelay),Object(M.a)(this.ngUnsubscribe)).subscribe(()=>{this.triggerComplete.next()})}}resetCamera(){const e=this.store.selectSnapshot(Or.getSelectedChapter);return this.store.dispatch(new Zt(e.camera.location,!0)).pipe(Object(Us.a)(()=>this.actions.pipe(Object(d.j)(Jt))),Object(Ua.a)(1))}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.g),i.Pb(d.b),i.Pb(Qt),i.Pb(yn),i.Pb(i.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-tour-slide"]],inputs:{title:"title",image:"image",alt:"alt",spacing:"spacing",shown:"shown",exitEnabled:"exitEnabled",trigger:"trigger",triggerDelay:"triggerDelay"},outputs:{triggerComplete:"triggerComplete"},ngContentSelectors:IS,decls:1,vars:1,consts:[["class","slide",3,"slide--expanded",4,"ngIf"],[1,"slide"],["class","slide__title",4,"ngIf"],[1,"slide__content"],["class","slide__image",3,"src","alt",4,"ngIf"],[1,"slide__footer"],[1,"slide__title"],[1,"slide__image",3,"src","alt"]],template:function(e,t){1&e&&(i.kc(MS),i.Ic(0,PS,7,5,"div",0)),2&e&&i.lc("ngIf",t.shown)},directives:[Z.l],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.slide[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;max-width:500px}.slide__title[_ngcontent-%COMP%]{font-weight:600;font-size:18px;letter-spacing:.45px}.slide__content[_ngcontent-%COMP%], .slide__title[_ngcontent-%COMP%]{margin-bottom:16px;line-height:1.4em}.slide__content[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.5em;max-width:100%}.slide__image[_ngcontent-%COMP%]{margin:24px auto;max-width:100%;min-height:1px}.slide__footer[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em;font-weight:500;display:flex;flex-direction:row;align-items:center;justify-content:center;max-width:100%}.slide--expanded[_ngcontent-%COMP%]   .slide__title[_ngcontent-%COMP%]{margin:16px}.slide--expanded[_ngcontent-%COMP%]   .slide__content[_ngcontent-%COMP%]{margin:48px}.slide--expanded[_ngcontent-%COMP%]   .slide__image[_ngcontent-%COMP%]{margin:48px auto}@media (max-width:768px){.slide[_ngcontent-%COMP%]{max-width:400px}.slide__image[_ngcontent-%COMP%]{margin:16px}.slide__title[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em;margin-bottom:12px}.slide__content[_ngcontent-%COMP%]{margin-bottom:12px}.slide__content[_ngcontent-%COMP%], .slide__footer[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}}@media (max-width:640px){.slide[_ngcontent-%COMP%]{max-width:320px}}@media (max-width:480px){.slide[_ngcontent-%COMP%]{max-width:240px}.slide__title[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px}.slide__content[_ngcontent-%COMP%], .slide__title[_ngcontent-%COMP%]{line-height:1.4em;margin-bottom:8px}.slide__content[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px}.slide__image[_ngcontent-%COMP%]{margin:4px auto}.slide__footer[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}}@media (max-width:320px){.slide[_ngcontent-%COMP%]{max-width:160px}}"],data:{animation:[Object(Zl.n)("refresh",[Object(Zl.m)(":enter",[Object(Zl.o)(Bx.slideTransition,{params:{duration:500,from:100,to:0}})])])]},changeDetection:0}),e})();function TS(e,t){1&e&&(i.Vb(0,"div",1),i.Vb(1,"div",2),i.jc(2),i.Ub(),i.Ub())}const US=["*"];let DS=(()=>{class e{constructor(e){this.changeRef=e,this.selectedSlideIndex=0,this._shown=!1,this.ngUnsubscribe=new k.a}set shown(e){this._shown=e,this.setSelectedSlide(0)}get shown(){return this._shown}ngOnInit(){}ngAfterViewInit(){this.initListeners(),setTimeout(()=>{this.setSlideShown(this.selectedSlideIndex)})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}goToPrevSlide(){this.setSelectedSlide(this.selectedSlideIndex-1)}goToNextSlide(){this.setSelectedSlide(this.selectedSlideIndex+1)}setSelectedSlide(e){if(this.selectedSlideIndex=e,this.slides){const t=Math.max(0,Math.min(this.slides.length-1,e));this.selectedSlideIndex=t}this.setSlideShown(this.selectedSlideIndex)}initListeners(){Object(Do.a)(...this.slides.map(e=>e.triggerComplete.asObservable())).pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(()=>{this.goToNextSlide()})}setSlideShown(e){this.slides&&this.slides.forEach((t,n)=>{t.shown=n===e}),this.changeRef.markForCheck()}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(i.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-tour-page"]],contentQueries:function(e,t,n){if(1&e&&i.Ib(n,zS,!1),2&e){let e;i.sc(e=i.dc())&&(t.slides=e)}},inputs:{shown:"shown"},ngContentSelectors:US,decls:1,vars:1,consts:[["class","page",4,"ngIf"],[1,"page"],[1,"page__contents"]],template:function(e,t){1&e&&(i.kc(),i.Ic(0,TS,3,0,"div",0)),2&e&&i.lc("ngIf",t.shown)},directives:[Z.l],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.page[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center}.page__contents[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}@media (max-width:768px){.page__contents[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}}@media (max-width:480px){.page__contents[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}}"],changeDetection:0}),e})();var LS=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function ES(e,t){if(1&e){const e=i.Wb();i.Vb(0,"div",5),i.Vb(1,"button",6),i.cc("click",(function(){return i.xc(e),i.gc(2).handlePrevClick()})),i.Ub(),i.Vb(2,"div",7),i.Kc(3),i.Ub(),i.Vb(4,"button",8),i.cc("click",(function(){return i.xc(e),i.gc(2).handleNextClick()})),i.Ub(),i.Ub()}if(2&e){const e=i.gc().$implicit;i.Db(1),i.lc("disabled",e.pageIndex<1),i.Eb("aria-disabled",e.pageIndex<1)("tabindex",e.pageIndex<1?-1:0),i.Db(2),i.Nc("",e.pageIndex+1," / ",e.pageSize,""),i.Db(1),i.lc("disabled",e.pageIndex===e.pageSize-1),i.Eb("aria-disabled",e.pageIndex===e.pageSize-1)("tabindex",e.pageIndex===e.pageSize-1?-1:0)}}const FS=function(e){return{"pages--opaquer":e}};function AS(e,t){if(1&e){const e=i.Wb();i.Vb(0,"div",1),i.Vb(1,"button",2),i.cc("click",(function(){return i.xc(e),i.gc().handleExitClick()})),i.Ub(),i.Vb(2,"div",3),i.jc(3),i.Ub(),i.Ic(4,ES,5,8,"div",4),i.Ub()}if(2&e){const e=t.$implicit;i.lc("ngClass",i.nc(2,FS,e.pageIndex==e.pageSize-1)),i.Db(4),i.lc("ngIf",e.pageIndex<e.pageSize-1)}}const RS=["*"];let VS=(()=>{class e{constructor(e,t){this.store=e,this.changeRef=t,this.ngUnsubscribe=new k.a}ngOnInit(){}ngAfterViewInit(){this.tutorial$.pipe(Object(M.a)(this.ngUnsubscribe),Object(I.a)(e=>null!=e&&e.pageSize>0)).subscribe(e=>{this.handleTutorialPages(e)}),this.store.dispatch(new j.SetTutorial({pageSize:this.pages.length,pageIndex:0}))}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}handlePrevClick(){this.store.dispatch(new j.TutorialPrevious)}handleNextClick(){this.store.dispatch(new j.TutorialNext)}handleExitClick(){this.store.dispatch(new j.ToggleWindow(Eo.Tutorial,!1))}handleTutorialPages(e){this.pages.forEach((t,n)=>{t.shown=n===e.pageIndex}),this.changeRef.markForCheck()}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.g),i.Pb(i.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-tour-pages"]],contentQueries:function(e,t,n){if(1&e&&i.Ib(n,DS,!1),2&e){let e;i.sc(e=i.dc())&&(t.pages=e)}},ngContentSelectors:RS,decls:2,vars:3,consts:[["class","pages",3,"ngClass",4,"ngIf"],[1,"pages",3,"ngClass"],["app-pin-button","","buttonType","dark","size","medium","icon","times","aria-label","Exit Tutorial","matTooltip","Exit Tutorial","matTooltipPosition","right","data-test","tutorialExitButton",1,"pages__close",3,"click"],[1,"pages__contents"],["class","pages__footer",4,"ngIf"],[1,"pages__footer"],["app-pin-button","","buttonType","dark","size","large","icon","angle-left","aria-label","Previous Tutorial Step","matTooltip","Previous Tutorial Step","matTooltipPosition","left","data-test","tutorialPreviousButton",1,"pages__nav",3,"disabled","click"],[1,"mh-8"],["app-pin-button","","buttonType","dark","size","large","icon","angle-right","aria-label","Next Tutorial Step","matTooltip"," Next Tutorial Step","matTooltipPosition","right","data-test","tutorialNextButton",1,"pages__nav",3,"disabled","click"]],template:function(e,t){1&e&&(i.kc(),i.Ic(0,AS,5,4,"div",0),i.hc(1,"async")),2&e&&i.lc("ngIf",i.ic(1,1,t.tutorial$))},directives:[Z.l,Z.i,ou,ru.c],pipes:[Z.b],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.pages[_ngcontent-%COMP%]{pointer-events:none;display:flex;flex-direction:column;align-items:center;justify-content:center;margin:20px auto 48px;max-width:600px;position:relative;background:rgba(16,24,35,.8);border-radius:16px;padding:24px 28px 20px}.pages--opaquer[_ngcontent-%COMP%]{background:rgba(16,24,35,.9)}.pages__footer[_ngcontent-%COMP%]{flex-direction:row;font-size:16px;letter-spacing:.4px;line-height:1.4em;font-weight:500}.pages__close[_ngcontent-%COMP%], .pages__footer[_ngcontent-%COMP%]{display:flex;align-items:center}.pages__close[_ngcontent-%COMP%]{z-index:1;position:absolute;top:8px;right:8px;align-self:flex-end;justify-content:center}.pages__contents[_ngcontent-%COMP%]{padding:16px 0}@media (max-width:768px){.pages[_ngcontent-%COMP%]{margin:16px 12% 48px;border-radius:10px;padding:18px 22px 14px}.pages__contents[_ngcontent-%COMP%]{padding:24px 0}.pages__footer[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.pages__nav[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}}@media (max-width:480px){.pages[_ngcontent-%COMP%]{margin:12px 10% 48px;border-radius:8px;padding:24px 20px 12px}.pages__footer[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.pages__nav[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}}"],changeDetection:0}),function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);o>3&&r&&Object.defineProperty(t,n,r)}([Object(d.d)(mr.getTutorial),LS("design:type",P.a)],e.prototype,"tutorial$",void 0),e})(),NS=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-tour-success"]],inputs:{inline:"inline"},decls:2,vars:2,consts:[[1,"view-tour-success"],["icon","check",1,"view-tour-success__icon"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Qb(1,"app-icon",1),i.Ub()),2&e&&i.Hb("view-tour-success--inline",t.inline)},directives:[dl],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3535}.text-info{color:#2d72dc}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.view-tour-success{width:52px;height:52px;display:flex;background-color:#1bbc66;border-radius:50%;justify-content:center;align-items:center}.view-tour-success__icon{font-size:36px;letter-spacing:.9px;line-height:1.4em;color:#fff}.view-tour-success--inline{display:inline-flex;width:32px;height:32px}.view-tour-success--inline .view-tour-success__icon{font-size:18px;letter-spacing:.45px;line-height:1.4em}@media (max-width:768px){.view-tour-success{width:36px;height:36px}.view-tour-success__icon{font-size:20px;letter-spacing:.5px;line-height:1.4em}.view-tour-success--inline{display:inline-flex;width:24px;height:24px}.view-tour-success--inline .view-tour-success__icon{font-size:12px;letter-spacing:.3px;line-height:1.4em}}"],encapsulation:2,changeDetection:0}),e})(),BS=(()=>{class e{constructor(e){this.viewService=e,this.triggers=xS}handleStartClick(){this.viewService.toggleTutorial(!1)}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(Dl))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-tour-mobile"]],decls:31,vars:5,consts:[["title","Rotate",3,"trigger"],["title","Zoom",3,"trigger"],["title","Pan",3,"trigger"],["title","Explore the Anatomy",3,"trigger"],[1,"flex","justify-start","items-center"],[1,"mr-2",3,"inline"],[1,"text-semibold"],["title","Toolbar","image","assets/images/tutorial/tutorial-toolbar@3x.png","alt","Toolbars used for navigating content"],["slide-footer","",1,"flex","flex-column","items-center","justify-center"],["app-view-rounded-button","","buttonType","solid","label","Start Exploring!","aria-label","Start Exploring",1,"mt-4",3,"click"]],template:function(e,t){1&e&&(i.Vb(0,"app-view-tour-pages"),i.Vb(1,"app-view-tour-page"),i.Vb(2,"app-view-tour-slide",0),i.Kc(3," Tap and drag with one finger to change the viewing angle. "),i.Ub(),i.Vb(4,"app-view-tour-slide"),i.Qb(5,"app-view-tour-success"),i.Ub(),i.Ub(),i.Vb(6,"app-view-tour-page"),i.Vb(7,"app-view-tour-slide",1),i.Kc(8," Pinch with two fingers to zoom in or out. "),i.Ub(),i.Vb(9,"app-view-tour-slide"),i.Qb(10,"app-view-tour-success"),i.Ub(),i.Ub(),i.Vb(11,"app-view-tour-page"),i.Vb(12,"app-view-tour-slide",2),i.Kc(13," Use two fingers to adjust the model's position. "),i.Ub(),i.Vb(14,"app-view-tour-slide"),i.Qb(15,"app-view-tour-success"),i.Ub(),i.Ub(),i.Vb(16,"app-view-tour-page"),i.Vb(17,"app-view-tour-slide",3),i.Kc(18," Tap on an individual part of the model to highlight anatomy. "),i.Ub(),i.Vb(19,"app-view-tour-slide"),i.Vb(20,"div",4),i.Vb(21,"div"),i.Qb(22,"app-view-tour-success",5),i.Vb(23,"strong",6),i.Kc(24,"Tip:"),i.Ub(),i.Kc(25," Double-tap to zoom in on specific structures. "),i.Ub(),i.Ub(),i.Ub(),i.Ub(),i.Vb(26,"app-view-tour-page"),i.Vb(27,"app-view-tour-slide",7),i.Kc(28," Use the toolbar to navigate through the 3D experience, launch deeper exploration tools, and relaunch this tutorial. "),i.Vb(29,"div",8),i.Vb(30,"button",9),i.cc("click",(function(){return t.handleStartClick()})),i.Ub(),i.Ub(),i.Ub(),i.Ub(),i.Ub()),2&e&&(i.Db(2),i.lc("trigger","camera-rotate"),i.Db(5),i.lc("trigger",t.triggers.CameraZoom),i.Db(5),i.lc("trigger",t.triggers.CameraPan),i.Db(5),i.lc("trigger",t.triggers.NodeSelection),i.Db(5),i.lc("inline",!0))},directives:[VS,DS,zS,NS,yS],styles:[""],changeDetection:0}),e})();function HS(e,t){if(1&e&&i.Qb(0,"app-icon",5),2&e){const e=i.gc(2);i.lc("icon",e.icon)}}function QS(e,t){if(1&e&&(i.Vb(0,"span",6),i.Kc(1),i.Ub()),2&e){const e=i.gc(2);i.Db(1),i.Lc(e.label)}}function $S(e,t){if(1&e&&(i.Tb(0),i.Ic(1,HS,1,1,"app-icon",3),i.Ic(2,QS,2,1,"span",4),i.Sb()),2&e){const e=i.gc();i.Db(1),i.lc("ngIf",e.icon),i.Db(1),i.lc("ngIf",e.icon)}}function qS(e,t){if(1&e&&(i.Vb(0,"span"),i.Kc(1),i.Ub()),2&e){const e=i.gc();i.Db(1),i.Mc(" ",e.label," ")}}let WS=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-tour-tip-button"]],inputs:{label:"label",icon:"icon"},decls:3,vars:2,consts:[[1,"view-tour-tip-button","mv-1","mh-1",3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"icon",4,"ngIf"],["class","visually-hidden",4,"ngIf"],[3,"icon"],[1,"visually-hidden"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Ic(1,$S,3,2,"ng-container",1),i.Ic(2,qS,2,1,"span",2),i.Ub()),2&e&&(i.lc("ngSwitch",!!t.icon),i.Db(1),i.lc("ngSwitchCase",!0))},directives:[Z.n,Z.o,Z.p,Z.l,dl],styles:[".view-tour-tip-button{display:inline-flex;align-items:center;justify-content:center;vertical-align:middle;color:#131c2a;background-color:#fff;border-radius:2px;font-weight:700;padding:4px;width:24px;height:24px}@media (max-width:768px){.view-tour-tip-button{width:20px;height:20px}}"],encapsulation:2,changeDetection:0}),e})();var KS=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function GS(e,t){1&e&&(i.Tb(0),i.Kc(1," Hold the control key and scroll up and down to zoom in or out. "),i.Sb())}function ZS(e,t){1&e&&(i.Tb(0),i.Kc(1," Scroll up and down to zoom in or out. "),i.Sb())}let JS=(()=>{class e{constructor(e){this.viewService=e,this.triggers=xS}ngOnInit(){this.captureScroll$=this.scrollMode$.pipe(Object(F.a)(e=>e===Pr.Capture))}handleStartClick(){this.viewService.toggleTutorial(!1)}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(Dl))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-tour-desktop"]],decls:62,vars:12,consts:[["title","Rotate",3,"trigger"],[1,"flex","justify-start","items-center"],[1,"mr-2",3,"inline"],[1,"text-semibold"],["icon","caret-up","label","up"],["icon","caret-down","label","down"],["icon","caret-left","label","left"],["icon","caret-right","label","right"],["title","Zoom",3,"trigger","ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["label","+"],["label","-"],["title","Pan",3,"trigger"],["label","W"],["label","A"],["label","S"],["label","D"],["title","Explore the Anatomy",3,"trigger"],["image","assets/images/tutorial/tutorial-toolbar@3x.png","alt","Toolbars used for navigating content"],["slide-footer","",1,"flex","flex-column","items-center","justify-center"],["app-view-rounded-button","","buttonType","solid","label","Start Exploring!","aria-label","Start Exploring",1,"mt-4",3,"click"]],template:function(e,t){1&e&&(i.Vb(0,"app-view-tour-pages"),i.Vb(1,"app-view-tour-page"),i.Vb(2,"app-view-tour-slide",0),i.Kc(3," Click and drag the model to change the viewing angle. "),i.Ub(),i.Vb(4,"app-view-tour-slide"),i.Vb(5,"div",1),i.Vb(6,"div"),i.Qb(7,"app-view-tour-success",2),i.Vb(8,"strong",3),i.Kc(9,"Tip:"),i.Ub(),i.Kc(10," You can also use the arrow keys "),i.Qb(11,"app-view-tour-tip-button",4),i.Qb(12,"app-view-tour-tip-button",5),i.Qb(13,"app-view-tour-tip-button",6),i.Qb(14,"app-view-tour-tip-button",7),i.Kc(15," to rotate. "),i.Ub(),i.Ub(),i.Ub(),i.Ub(),i.Vb(16,"app-view-tour-page"),i.Vb(17,"app-view-tour-slide",8),i.hc(18,"async"),i.Ic(19,GS,2,0,"ng-container",9),i.Ic(20,ZS,2,0,"ng-container",10),i.Ub(),i.Vb(21,"app-view-tour-slide"),i.Vb(22,"div",1),i.Vb(23,"div"),i.Qb(24,"app-view-tour-success",2),i.Vb(25,"strong",3),i.Kc(26,"Tip:"),i.Ub(),i.Kc(27," You can also use "),i.Qb(28,"app-view-tour-tip-button",11),i.Kc(29," to zoom in and "),i.Qb(30,"app-view-tour-tip-button",12),i.Kc(31," to zoom out. "),i.Ub(),i.Ub(),i.Ub(),i.Ub(),i.Vb(32,"app-view-tour-page"),i.Vb(33,"app-view-tour-slide",13),i.Kc(34," Hold the shift key and drag to move the model's position. "),i.Ub(),i.Vb(35,"app-view-tour-slide"),i.Vb(36,"div",1),i.Vb(37,"div"),i.Qb(38,"app-view-tour-success",2),i.Vb(39,"strong",3),i.Kc(40,"Tip:"),i.Ub(),i.Kc(41," You can also use the "),i.Qb(42,"app-view-tour-tip-button",14),i.Qb(43,"app-view-tour-tip-button",15),i.Qb(44,"app-view-tour-tip-button",16),i.Qb(45,"app-view-tour-tip-button",17),i.Kc(46," keys to pan. "),i.Ub(),i.Ub(),i.Ub(),i.Ub(),i.Vb(47,"app-view-tour-page"),i.Vb(48,"app-view-tour-slide",18),i.Kc(49," Click on an individual part of the model to highlight anatomy. "),i.Ub(),i.Vb(50,"app-view-tour-slide"),i.Vb(51,"div",1),i.Vb(52,"div"),i.Qb(53,"app-view-tour-success",2),i.Vb(54,"strong",3),i.Kc(55,"Tip:"),i.Ub(),i.Kc(56," Double-click to zoom in on specific structures. "),i.Ub(),i.Ub(),i.Ub(),i.Ub(),i.Vb(57,"app-view-tour-page"),i.Vb(58,"app-view-tour-slide",19),i.Kc(59," Use the toolbar to navigate through the 3D experience, launch deeper exploration tools, and relaunch this tutorial. "),i.Vb(60,"div",20),i.Vb(61,"button",21),i.cc("click",(function(){return t.handleStartClick()})),i.Ub(),i.Ub(),i.Ub(),i.Ub(),i.Ub()),2&e&&(i.Db(2),i.lc("trigger",t.triggers.CameraRotate),i.Db(5),i.lc("inline",!0),i.Db(10),i.lc("trigger",t.triggers.CameraZoom)("ngSwitch",i.ic(18,10,t.captureScroll$)),i.Db(2),i.lc("ngSwitchCase",!1),i.Db(5),i.lc("inline",!0),i.Db(9),i.lc("trigger",t.triggers.CameraPan),i.Db(5),i.lc("inline",!0),i.Db(10),i.lc("trigger",t.triggers.NodeSelection),i.Db(5),i.lc("inline",!0))},directives:[VS,DS,zS,NS,WS,Z.n,Z.o,Z.p,yS],pipes:[Z.b],styles:[""],changeDetection:0}),function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);o>3&&r&&Object.defineProperty(t,n,r)}([Object(d.d)(Er.getScrollMode),KS("design:type",P.a)],e.prototype,"scrollMode$",void 0),e})();var XS=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},YS=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function e_(e,t){if(1&e){const e=i.Wb();i.Vb(0,"div",3),i.Vb(1,"h2",4),i.Kc(2,"Getting Started"),i.Ub(),i.Vb(3,"p",5),i.Kc(4," Welcome! This tutorial will teach you how to navigate and explore in 3D using your "),i.Qb(5,"button",6),i.hc(6,"async"),i.hc(7,"async"),i.Vb(8,"mat-menu",null,7),i.Vb(10,"button",8),i.cc("click",(function(){i.xc(e);const t=i.gc();return t.handleSelectInputModeClick(t.inputModes.Mouse)})),i.Kc(11),i.Ub(),i.Vb(12,"button",8),i.cc("click",(function(){i.xc(e);const t=i.gc();return t.handleSelectInputModeClick(t.inputModes.Touch)})),i.Kc(13),i.Ub(),i.Ub(),i.Ub(),i.Vb(14,"div",9),i.Vb(15,"button",10),i.cc("click",(function(){return i.xc(e),i.gc().handleExitClick()})),i.Ub(),i.Vb(16,"button",11),i.cc("click",(function(){return i.xc(e),i.gc().handleStartClick()})),i.Ub(),i.Ub(),i.Ub()}if(2&e){const e=i.tc(9),t=i.gc();i.Db(5),i.lc("compact",!0)("label",t.inputModesText[i.ic(6,6,t.inputMode$)])("matMenuTriggerFor",e),i.Eb("aria-label",t.inputModesText[i.ic(7,8,t.inputMode$)]),i.Db(6),i.Mc(" ",t.inputModesText[t.inputModes.Mouse]," "),i.Db(2),i.Mc(" ",t.inputModesText[t.inputModes.Touch]," ")}}function t_(e,t){1&e&&i.Qb(0,"app-view-tour-mobile")}function n_(e,t){1&e&&i.Qb(0,"app-view-tour-desktop")}function i_(e,t){if(1&e&&(i.Vb(0,"div",12),i.hc(1,"async"),i.Ic(2,t_,1,0,"app-view-tour-mobile",13),i.Ic(3,n_,1,0,"app-view-tour-desktop",14),i.Ub()),2&e){const e=i.gc();i.lc("ngSwitch",i.ic(1,2,e.inputMode$)),i.Db(2),i.lc("ngSwitchCase",e.inputModes.Touch)}}const s_={[Xo.Mouse]:"mouse, trackpad, or keyboard",[Xo.Touch]:"touchscreen"};let o_=(()=>{class e{constructor(e,t,n){this.store=e,this.viewService=t,this.storageService=n,this.inputModes=Xo,this.inputModesText=s_,this.tourStarted=!1,this.tourEnded=!1,this.ngUnsubscribe=new k.a}ngOnInit(){this.initListeners(),this.store.dispatch(new j.TutorialSeen(!0))}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initListeners(){this.tutorial$.pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(({pageIndex:e,pageSize:t})=>{this.tourStarted=e>-1,this.tourEnded=e===t-1}),Object(Uo.a)(window,"keyup").pipe(Object(I.a)(e=>"Escape"===e.key),Object(M.a)(this.ngUnsubscribe)).subscribe(()=>{this.exit()})}handleExitClick(){this.exit()}handleStartClick(){this.store.dispatch(new j.StartTutorial(!1))}handleSelectInputModeClick(e){this.store.dispatch(new j.SetInputMode(e))}exit(){this.viewService.toggleTutorial(!1)}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.g),i.Pb(Dl),i.Pb(ar))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-tour"]],decls:3,vars:7,consts:[["role","dialog","aria-label","Getting Started Tutorial","cdkTrapFocus","",1,"tour"],["class","tour__intro",4,"ngIf"],["class","tour__contents",3,"ngSwitch",4,"ngIf"],[1,"tour__intro"],[1,"tour__title"],[1,"tour__welcome"],["app-view-rounded-button","","buttonType","outline","icon","chevron-down","iconPlacement","right",1,"tour__input-selection","text-small",3,"compact","label","matMenuTriggerFor"],["inputSelectionMenu","matMenu"],["mat-menu-item","",3,"click"],[1,"tour__footer"],["app-view-rounded-button","","buttonType","outline","label","No, Thanks.","data-test","tutorialExitButton",1,"mr-3","text-medium",3,"click"],["app-view-rounded-button","","buttonType","solid","label","Start Tutorial","aria-label","Start Tutorial","data-test","tutorialStartButton",1,"ml-3","text-medium",3,"click"],[1,"tour__contents",3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Ic(1,e_,17,10,"div",1),i.Ic(2,i_,4,4,"div",2),i.Ub()),2&e&&(i.Hb("tour--started",t.tourStarted)("tour--ended",t.tourEnded),i.lc("@refresh",void 0),i.Db(1),i.lc("ngIf",!t.tourStarted),i.Db(1),i.lc("ngIf",t.tourStarted))},directives:[Tl.d,Z.l,yS,gd.d,gd.a,gd.b,Z.n,Z.o,Z.p,BS,JS],pipes:[Z.b],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.tour[_ngcontent-%COMP%]{color:#fff;position:absolute;top:0;right:0;bottom:0;left:0;z-index:100;pointer-events:none;display:flex;flex-direction:column;align-items:center;overflow:auto}.tour__title[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.tour__welcome[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em;margin:16px auto 32px}.tour__intro[_ngcontent-%COMP%]{background:rgba(16,24,35,.9);border-radius:16px;margin:auto;padding:28px 32px;text-align:center;max-width:560px}.tour__input-selection[_ngcontent-%COMP%]{vertical-align:middle}.tour__header[_ngcontent-%COMP%]{flex:none;align-self:flex-end;justify-self:flex-start;margin:24px}.tour__contents[_ngcontent-%COMP%]{flex:auto;display:flex;flex-direction:column;justify-content:flex-end;width:100%}.tour__footer[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em;display:flex;flex-direction:row;align-items:center;justify-content:center}.tour__nav-arrow[_ngcontent-%COMP%]{font-size:32px;letter-spacing:.8px;line-height:1.4em;cursor:pointer}.tour--ended[_ngcontent-%COMP%]   .tour__contents[_ngcontent-%COMP%]{justify-content:center}@media (max-width:768px){.tour__intro[_ngcontent-%COMP%]{border-radius:12px;padding:20px 24px;margin:auto 12%;max-width:100%}.tour__intro__title[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.tour__intro__content[_ngcontent-%COMP%]{max-width:80%}.tour__header[_ngcontent-%COMP%], .tour__intro__content[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.tour__header[_ngcontent-%COMP%]{margin:12px}.tour__footer[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.tour__nav-arrow[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}}@media (max-width:480px){.tour__intro[_ngcontent-%COMP%]{border-radius:8px;padding:16px 20px;margin:auto 10%}.tour__intro__title[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.tour__intro__content[_ngcontent-%COMP%]{margin:12px auto 16px}.tour__header[_ngcontent-%COMP%], .tour__intro__content[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.tour__header[_ngcontent-%COMP%]{margin:12px}.tour__footer[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.tour__nav-arrow[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}}"],data:{animation:[Object(Zl.n)("refresh",[Object(Zl.m)(":enter",[Object(Zl.o)(Bx.slideTransition,{params:{duration:500,from:100,to:0}})])])]},changeDetection:0}),XS([Object(d.d)(mr.getTutorial),YS("design:type",P.a)],e.prototype,"tutorial$",void 0),XS([Object(d.d)(mr.getInputMode),YS("design:type",P.a)],e.prototype,"inputMode$",void 0),e})();var r_=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},a_=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const c_=["colorBtn"];function l_(e,t){1&e&&(i.Vb(0,"div"),i.Qb(1,"app-icon",19),i.Vb(2,"span",20),i.Kc(3,"current"),i.Ub(),i.Ub())}function p_(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",14),i.cc("click",(function(){i.xc(e);const n=t.$implicit;return i.gc().setTextSize(n.size)})),i.Vb(1,"div",15),i.Vb(2,"div",16),i.Ic(3,l_,4,0,"div",17),i.hc(4,"async"),i.Ub(),i.Vb(5,"div",18),i.Vb(6,"span"),i.Kc(7),i.Ub(),i.Ub(),i.Ub(),i.Ub()}if(2&e){const e=t.$implicit,n=i.gc();i.Db(3),i.lc("ngIf",e.size===i.ic(4,2,n.textSize$)),i.Db(4),i.Mc("",e.label,"px")}}function d_(e,t){1&e&&(i.Vb(0,"div"),i.Qb(1,"app-icon",19),i.Vb(2,"span",20),i.Kc(3,"current"),i.Ub(),i.Ub())}function u_(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",14),i.cc("click",(function(){i.xc(e);const n=t.$implicit;return i.gc().setBrushSize(n.size)})),i.Vb(1,"div",15),i.Vb(2,"div",16),i.Ic(3,d_,4,0,"div",17),i.hc(4,"async"),i.Ub(),i.Vb(5,"div",18),i.Qb(6,"app-icon",21),i.Vb(7,"span"),i.Kc(8),i.Ub(),i.Ub(),i.Ub(),i.Ub()}if(2&e){const e=t.$implicit,n=i.gc();i.Db(3),i.lc("ngIf",e.size===i.ic(4,4,n.brushSize$)),i.Db(3),i.Fc("font-size",e.size,"px"),i.Db(2),i.Lc(e.label)}}function g_(e,t){1&e&&(i.Vb(0,"div"),i.Qb(1,"app-icon",19),i.Vb(2,"span",20),i.Kc(3,"current"),i.Ub(),i.Ub())}function h_(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",14),i.cc("click",(function(){i.xc(e);const n=t.$implicit;return i.gc().setEraserSize(n.size)})),i.Vb(1,"div",15),i.Vb(2,"div",16),i.Ic(3,g_,4,0,"div",17),i.hc(4,"async"),i.Ub(),i.Vb(5,"div",18),i.Qb(6,"app-icon",21),i.Vb(7,"span"),i.Kc(8),i.Ub(),i.Ub(),i.Ub(),i.Ub()}if(2&e){const e=t.$implicit,n=i.gc();i.Db(3),i.lc("ngIf",e.size===i.ic(4,4,n.eraserSize$)),i.Db(3),i.Fc("font-size",e.size,"px"),i.Db(2),i.Lc(e.label)}}function b_(e,t){1&e&&(i.Vb(0,"div"),i.Qb(1,"app-icon",19),i.Vb(2,"span",20),i.Kc(3,"current"),i.Ub(),i.Ub())}function m_(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",14),i.cc("click",(function(){i.xc(e);const n=t.$implicit;return i.gc().setBrushColor(n.color)})),i.Vb(1,"div",15),i.Vb(2,"div",16),i.Ic(3,b_,4,0,"div",17),i.hc(4,"async"),i.Ub(),i.Vb(5,"div",18),i.Qb(6,"span",22),i.Vb(7,"span"),i.Kc(8),i.Ub(),i.Ub(),i.Ub(),i.Ub()}if(2&e){const e=t.$implicit,n=i.gc();i.Db(3),i.lc("ngIf",e.color===i.ic(4,4,n.brushColor$)),i.Db(3),i.Fc("background-color",e.color),i.Db(2),i.Lc(e.label)}}let f_=(()=>{class e{constructor(e){this.store=e,this.textSizes=No,this.brushSizes=Vo,this.brushColors=$o,this.eraserSizes=Bo,this.modeEnum=Fo,this.downloadClick=new i.p,this.clearClick=new i.p,this.exitClick=new i.p,this.ngUnsubscribe=new k.a}ngOnInit(){}ngAfterViewInit(){this.brushColor$.pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.colorBtn.nativeElement.style.setProperty("--pin-button-pin-color",e)}),this.hasPaint$.pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{e||this.store.selectSnapshot(mr.getWhiteboardAnnotateMode)!==Fo.Erase||this.handleModeSelect(Fo.Paint)})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}setBrushSize(e){this.store.dispatch(new j.SetWhiteboardBrushSize(e))}setBrushColor(e){this.store.dispatch(new j.SetWhiteboardBrushColor(e))}setTextSize(e){this.store.dispatch(new j.SetWhiteboardTextSize(e))}handleModeSelect(e){this.store.dispatch(new j.SetWhiteboardAnnotateMode(e))}setEraserSize(e){this.store.dispatch(new j.SetWhiteboardEraserSize(e))}handleDownloadClick(){this.downloadClick.next()}handleClearClick(){this.clearClick.next()}handleExitClick(){this.exitClick.next()}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.g))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-whiteboard-tools"]],viewQuery:function(e,t){if(1&e&&i.Ec(c_,!0,i.m),2&e){let e;i.sc(e=i.dc())&&(t.colorBtn=e.first)}},outputs:{downloadClick:"downloadClick",clearClick:"clearClick",exitClick:"exitClick"},decls:39,vars:52,consts:[[1,"view-whiteboard-tools"],["eventCategory","View Whiteboard Tools","name","Whiteboard","padding","dense",3,"canExit","exit"],["app-pin-button","","buttonType","ghost","icon","text-size","aria-label","Text","matTooltip","Text",1,"mr-1",3,"matMenuTriggerFor","selected","click"],["app-pin-button","","buttonType","ghost","icon","paint-brush","aria-label","Brush","matTooltip","Brush",1,"mr-1",3,"matMenuTriggerFor","selected","click"],["app-pin-button","","buttonType","ghost","icon","eraser","aria-label","Eraser","matTooltip","Eraser",3,"matMenuTriggerFor","selected","disabled","click"],["app-pin-button","","buttonType","ghost","icon","tint","aria-label","Color","matTooltip","Color",3,"matMenuTriggerFor","selected"],["colorBtn","matMenuTrigger"],["app-pin-button","","buttonType","ghost","icon","download","aria-label","Download","matTooltip","Download",3,"click"],["app-pin-button","","buttonType","ghost","aria-label","Clear","matTooltip","Clear",3,"disabled","click"],["textSizeMenu","matMenu"],["mat-menu-item","",3,"click",4,"ngFor","ngForOf"],["brushSizeMenu","matMenu"],["eraserSizeMenu","matMenu"],["brushColorMenu","matMenu"],["mat-menu-item","",3,"click"],[1,"flex","flex-row","items-center","justify-end"],[1,"view-whiteboard-tools__check"],[4,"ngIf"],[1,"view-whiteboard-tools__label"],["icon","check","aria-hidden","true",1,"mr-2"],[1,"visually-hidden"],["icon","circle","aria-hidden","true",1,"mr-2"],[1,"view-whiteboard-tools__swatch"]],template:function(e,t){if(1&e&&(i.Vb(0,"div",0),i.Vb(1,"app-pillbox",1),i.cc("exit",(function(){return t.handleExitClick()})),i.Vb(2,"button",2),i.cc("click",(function(){return t.handleModeSelect(t.modeEnum.Text)})),i.hc(3,"async"),i.hc(4,"async"),i.Ub(),i.Vb(5,"button",3),i.cc("click",(function(){return t.handleModeSelect(t.modeEnum.Paint)})),i.hc(6,"async"),i.hc(7,"async"),i.hc(8,"async"),i.Ub(),i.Vb(9,"button",4),i.cc("click",(function(){return t.handleModeSelect(t.modeEnum.Erase)})),i.hc(10,"async"),i.hc(11,"async"),i.hc(12,"async"),i.hc(13,"async"),i.hc(14,"async"),i.Ub(),i.Qb(15,"app-pillbox-divider"),i.Qb(16,"button",5,6),i.Qb(18,"app-pillbox-divider"),i.Vb(19,"button",7),i.cc("click",(function(){return t.handleDownloadClick()})),i.Ub(),i.Qb(20,"app-pillbox-divider"),i.Vb(21,"button",8),i.cc("click",(function(){return t.handleClearClick()})),i.hc(22,"async"),i.hc(23,"async"),i.hc(24,"async"),i.hc(25,"async"),i.Kc(26," Clear "),i.Ub(),i.Vb(27,"mat-menu",null,9),i.Ic(29,p_,8,4,"button",10),i.Ub(),i.Vb(30,"mat-menu",null,11),i.Ic(32,u_,9,6,"button",10),i.Ub(),i.Vb(33,"mat-menu",null,12),i.Ic(35,h_,9,6,"button",10),i.Ub(),i.Vb(36,"mat-menu",null,13),i.Ic(38,m_,9,6,"button",10),i.Ub(),i.Ub(),i.Ub()),2&e){const e=i.tc(17),n=i.tc(28),s=i.tc(31),o=i.tc(34),r=i.tc(37);i.Db(1),i.lc("canExit",!0),i.Db(1),i.lc("matMenuTriggerFor",n)("selected",i.ic(3,24,t.mode$)===t.modeEnum.Text),i.Eb("aria-pressed",i.ic(4,26,t.mode$)===t.modeEnum.Text),i.Db(3),i.lc("matMenuTriggerFor",s)("selected",i.ic(6,28,t.mode$)===t.modeEnum.Paint),i.Eb("aria-selected",i.ic(7,30,t.mode$)===t.modeEnum.Paint)("aria-pressed",i.ic(8,32,t.mode$)===t.modeEnum.Paint),i.Db(4),i.lc("matMenuTriggerFor",o)("selected",i.ic(10,34,t.mode$)===t.modeEnum.Erase)("disabled",!1===i.ic(13,40,t.hasPaint$)),i.Eb("aria-selected",i.ic(11,36,t.mode$)===t.modeEnum.Erase)("aria-pressed",i.ic(12,38,t.mode$)===t.modeEnum.Erase)("aria-disabled",!1===i.ic(14,42,t.hasPaint$)),i.Db(7),i.lc("matMenuTriggerFor",r)("selected",e.menuOpen),i.Eb("aria-selected",e.menuOpen)("aria-pressed",e.menuOpen),i.Db(5),i.lc("disabled",!1===i.ic(22,44,t.hasPaint$)&&!1===i.ic(23,46,t.hasText$)),i.Eb("aria-disabled",!1===i.ic(24,48,t.hasPaint$)&&!1===i.ic(25,50,t.hasText$)),i.Db(8),i.lc("ngForOf",t.textSizes),i.Db(3),i.lc("ngForOf",t.brushSizes),i.Db(3),i.lc("ngForOf",t.eraserSizes),i.Db(3),i.lc("ngForOf",t.brushColors)}},directives:[xO,ou,ru.c,gd.d,bO,gd.a,Z.k,gd.b,Z.l,dl],pipes:[Z.b],styles:[".view-whiteboard-tools__check{flex:2 1 0;color:#2d72dc}.view-whiteboard-tools__label{display:flex;flex:6 1 0;align-items:center}.view-whiteboard-tools__swatch{display:inline-block;width:14px;height:14px;border-radius:50%;margin-right:8px;box-shadow:0 0 0 1px #96a8c0}"],encapsulation:2,changeDetection:0}),r_([Object(d.d)(mr.getWhiteboardAnnotateMode),a_("design:type",P.a)],e.prototype,"mode$",void 0),r_([Object(d.d)(mr.getWhiteboardBrushSize),a_("design:type",P.a)],e.prototype,"brushSize$",void 0),r_([Object(d.d)(mr.getWhiteboardTextSize),a_("design:type",P.a)],e.prototype,"textSize$",void 0),r_([Object(d.d)(mr.getWhiteboardBrushColor),a_("design:type",P.a)],e.prototype,"brushColor$",void 0),r_([Object(d.d)(mr.getWhiteboardEraserSize),a_("design:type",P.a)],e.prototype,"eraserSize$",void 0),r_([Object(d.d)(mr.getWhiteboardHasPaint),a_("design:type",P.a)],e.prototype,"hasPaint$",void 0),r_([Object(d.d)(mr.getWhiteboardHasText),a_("design:type",P.a)],e.prototype,"hasText$",void 0),e})();const y_=["textRef"];function x_(e,t){if(1&e){const e=i.Wb();i.Vb(0,"div"),i.Vb(1,"div",4),i.cc("cdkDragMoved",(function(t){return i.xc(e),i.gc().dragMoved(t,"corner1")})),i.Ub(),i.Vb(2,"div",5),i.cc("cdkDragMoved",(function(t){return i.xc(e),i.gc().dragMoved(t,"corner2")})),i.Ub(),i.Vb(3,"div",6),i.cc("cdkDragMoved",(function(t){return i.xc(e),i.gc().dragMoved(t,"corner3")})),i.Ub(),i.Vb(4,"div",7),i.cc("cdkDragMoved",(function(t){return i.xc(e),i.gc().dragMoved(t,"corner4")})),i.Ub(),i.Vb(5,"div",8),i.cc("cdkDragMoved",(function(t){return i.xc(e),i.gc().translateHandleMoved(t)})),i.Ub(),i.Ub()}if(2&e){const e=i.gc();i.Db(1),i.lc("cdkDragFreeDragPosition",e.dragHandles.corner1),i.Db(1),i.lc("cdkDragFreeDragPosition",e.dragHandles.corner2),i.Db(1),i.lc("cdkDragFreeDragPosition",e.dragHandles.corner3),i.Db(1),i.lc("cdkDragFreeDragPosition",e.dragHandles.corner4),i.Db(1),i.lc("cdkDragFreeDragPosition",e.dragHandles.translate)}}const v_=function(e){return{"whiteboard-label__label--active":e}};let O_=(()=>{class e{constructor(e,t){this.changeDetectorRef=e,this.renderer=t,this.active=!0,this.initialized=!1,this.labelActive=new i.p,this.labelEmpty=new i.p,this.dragHandles={translate:{x:0,y:0},corner1:{x:0,y:0},corner2:{x:0,y:0},corner3:{x:0,y:0},corner4:{x:0,y:0}},this.handleCoords={translate:{x:0,y:0},corner1:{x:0,y:0},corner2:{x:0,y:0},corner3:{x:0,y:0},corner4:{x:0,y:0}},this.textareaTransform={x:0,y:0,width:110,height:40},this.handleDocumentBackspace=e=>{const{activeElement:t}=this.textRef.nativeElement;"Backspace"===e.key&&this.active&&!t&&this.deleteLabel()},this.handleTextboxMouseDown=e=>{this.active=!0,this.labelActive.next(this.id),this.refreshHandles()},this.handleDocumentMouseDown=e=>{const t=e.target.className.includes("view-whiteboard__canvas"),n=e.target.className.includes("whiteboard-label__label"),i=e.target.dataset.id===this.id;this.isLabelEmpty()&&!i&&this.initialized?this.deleteLabel():(t||n&&!i)&&(this.active=!1,this.changeDetectorRef.markForCheck())},this.handleTextKeyDown=e=>{if(e.stopPropagation(),this.isLabelEmpty()&&"Backspace"===e.key)return void this.deleteLabel();const t=this.textRef.nativeElement.scrollHeight,{corner1:n,corner3:i,corner4:s}=this.handleCoords,o=n.y+t;this.handleCoords.corner3=Object.assign(Object.assign({},i),{y:o}),this.handleCoords.corner4=Object.assign(Object.assign({},s),{y:o}),this.dragHandles.corner3=Object.assign({},this.handleCoords.corner3),this.dragHandles.corner4=Object.assign({},this.handleCoords.corner4),this.updateTextarea(),this.changeDetectorRef.markForCheck()}}get id(){return this._id}set id(e){this._id=e,this.initialized=!1}set color(e){this.renderer.setStyle(this.textRef.nativeElement,"color",e)}set exporting(e){e&&(this.active=!1,this.labelActive.next(void 0))}set size(e){this.renderer.setStyle(this.textRef.nativeElement,"font-size",e+"px")}ngOnInit(){this.initHandles(),this.initInteractionListeners(),setTimeout(()=>{this.textRef.nativeElement.focus(),this.initialized=!0})}ngOnDestroy(){this.textRef.nativeElement.removeEventListener("keydown",this.handleTextKeyDown),this.textRef.nativeElement.removeEventListener("mousedown",this.handleTextboxMouseDown),this.mouseDownListener(),this.backspaceListener()}initHandles(){this.textareaTransform.x=this.initialPos.x,this.textareaTransform.y=this.initialPos.y;const{x:e,y:t,width:n,height:i}=this.textareaTransform;this.dragHandles.corner1={x:e,y:t},this.dragHandles.corner2={x:e+n,y:t},this.dragHandles.corner3={x:e+n,y:t+i},this.dragHandles.corner4={x:e,y:t+i},this.dragHandles.translate={x:e+n/2,y:t+-10},this.handleCoords.corner1=Object.assign({},this.dragHandles.corner1),this.handleCoords.corner2=Object.assign({},this.dragHandles.corner2),this.handleCoords.corner3=Object.assign({},this.dragHandles.corner3),this.handleCoords.corner4=Object.assign({},this.dragHandles.corner4),this.handleCoords.translate=Object.assign({},this.dragHandles.translate),this.updateTextarea()}initInteractionListeners(){this.mouseDownListener=this.renderer.listen("document","mousedown",this.handleDocumentMouseDown),this.backspaceListener=this.renderer.listen("document","keydown",this.handleDocumentBackspace),this.textRef.nativeElement.addEventListener("mousedown",this.handleTextboxMouseDown),this.textRef.nativeElement.addEventListener("keydown",this.handleTextKeyDown)}refreshHandles(){this.dragHandles.corner1=Object.assign({},this.handleCoords.corner1),this.dragHandles.corner2=Object.assign({},this.handleCoords.corner2),this.dragHandles.corner3=Object.assign({},this.handleCoords.corner3),this.dragHandles.corner4=Object.assign({},this.handleCoords.corner4),this.dragHandles.translate=Object.assign({},this.handleCoords.translate),this.changeDetectorRef.markForCheck()}isLabelEmpty(){return""===this.textRef.nativeElement.innerText||"\n"===this.textRef.nativeElement.innerText}deleteLabel(){this.labelEmpty.next(this.id)}updateTextarea(){const{corner1:e,corner2:t,corner3:n}=this.handleCoords;this.textareaTransform.x=e.x,this.textareaTransform.y=e.y,this.textareaTransform.width=t.x-e.x,this.textareaTransform.height=n.y-t.y,this.renderer.setStyle(this.textRef.nativeElement,"transform",`translate(${this.textareaTransform.x}px, ${this.textareaTransform.y}px)`),this.renderer.setStyle(this.textRef.nativeElement,"width",this.textareaTransform.width+"px"),this.renderer.setStyle(this.textRef.nativeElement,"height",this.textareaTransform.height+"px")}updateTranslateHandle(){const{corner1:e,corner2:t}=this.handleCoords;this.handleCoords.translate={x:(t.x-e.x)/2+e.x,y:e.y+-10},this.dragHandles.translate=Object.assign({},this.handleCoords.translate)}setHandle(e,t,n){this.handleCoords[e]=Object.assign(Object.assign({},this.handleCoords[e]),{[t]:n[t]}),this.dragHandles[e]=Object.assign({},this.handleCoords[e])}addDiffToHandle(e,t){this.handleCoords[e]={x:this.handleCoords[e].x+t.x,y:this.handleCoords[e].y+t.y},this.dragHandles[e]=Object.assign({},this.handleCoords[e])}translateHandleMoved(e){const t=e.source._dragRef.getFreeDragPosition(),n={x:t.x-this.handleCoords.translate.x,y:t.y-this.handleCoords.translate.y};this.handleCoords.translate=Object.assign({},t),this.addDiffToHandle("corner1",n),this.addDiffToHandle("corner2",n),this.addDiffToHandle("corner3",n),this.addDiffToHandle("corner4",n),this.updateTextarea()}dragMoved(e,t){const n=e.source._dragRef.getFreeDragPosition();this.handleCoords[t]=Object.assign({},n),"corner1"===t&&(this.setHandle("corner2","y",n),this.setHandle("corner4","x",n)),"corner2"===t&&(this.setHandle("corner1","y",n),this.setHandle("corner3","x",n)),"corner3"===t&&(this.setHandle("corner2","x",n),this.setHandle("corner4","y",n)),"corner4"===t&&(this.setHandle("corner1","x",n),this.setHandle("corner3","y",n)),this.updateTranslateHandle(),this.updateTextarea()}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(i.i),i.Pb(i.H))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-whiteboard-label"]],viewQuery:function(e,t){if(1&e&&i.Ec(y_,!0),2&e){let e;i.sc(e=i.dc())&&(t.textRef=e.first)}},inputs:{id:"id",initialPos:"initialPos",color:"color",exporting:"exporting",size:"size"},outputs:{labelActive:"labelActive",labelEmpty:"labelEmpty"},decls:4,vars:5,consts:[[1,"whiteboard-label"],[4,"ngIf"],["contenteditable","true","data-placeholder","Type..",1,"whiteboard-label__label",3,"ngClass"],["textRef",""],["cdkDrag","",1,"whiteboard-label__handle","whiteboard-label__handle--top-left",3,"cdkDragFreeDragPosition","cdkDragMoved"],["cdkDrag","",1,"whiteboard-label__handle","whiteboard-label__handle--top-right",3,"cdkDragFreeDragPosition","cdkDragMoved"],["cdkDrag","",1,"whiteboard-label__handle","whiteboard-label__handle--bottom-right",3,"cdkDragFreeDragPosition","cdkDragMoved"],["cdkDrag","",1,"whiteboard-label__handle","whiteboard-label__handle--bottom-left",3,"cdkDragFreeDragPosition","cdkDragMoved"],["cdkDrag","",1,"whiteboard-label__handle","whiteboard-label__handle--move",3,"cdkDragFreeDragPosition","cdkDragMoved"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Ic(1,x_,6,5,"div",1),i.Qb(2,"div",2,3),i.Ub()),2&e&&(i.Db(1),i.lc("ngIf",!0===t.active),i.Db(1),i.lc("ngClass",i.nc(3,v_,!0===t.active)),i.Eb("data-id",t.id))},directives:[Z.l,Z.i,So.a],styles:['.whiteboard-label[_ngcontent-%COMP%]{position:relative;z-index:1000}.whiteboard-label__handle[_ngcontent-%COMP%]{position:fixed;z-index:10;width:32px;height:32px;left:-16px;top:-16px}.whiteboard-label__handle[_ngcontent-%COMP%]:after{content:"";position:absolute;width:12px;height:12px;left:10px;top:10px;border-radius:50%;background-color:#2d72dc}.whiteboard-label__handle[_ngcontent-%COMP%]:hover{cursor:pointer}.whiteboard-label__handle--top-left[_ngcontent-%COMP%]:hover{cursor:nw-resize}.whiteboard-label__handle--top-right[_ngcontent-%COMP%]:hover{cursor:ne-resize}.whiteboard-label__handle--bottom-right[_ngcontent-%COMP%]:hover{cursor:se-resize}.whiteboard-label__handle--bottom-left[_ngcontent-%COMP%]:hover{cursor:sw-resize}.whiteboard-label__handle--move[_ngcontent-%COMP%]:hover{cursor:move}.whiteboard-label__label[_ngcontent-%COMP%]{box-sizing:border-box;position:absolute;border:none;padding:5px;overflow-y:hidden}.whiteboard-label__label--active[_ngcontent-%COMP%]{box-shadow:inset 0 0 0 1px #2d72dc}.whiteboard-label__label[_ngcontent-%COMP%]:focus{outline:none}.whiteboard-label__label[_ngcontent-%COMP%]:empty:before{content:attr(data-placeholder);color:rgba(55,74,104,.5)}'],changeDetection:0}),e})();var w_=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},C_=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const S_=["drawCanvas"],__=["annotateWrapper"];function j_(e,t){if(1&e){const e=i.Wb();i.Vb(0,"app-view-whiteboard-label",7),i.cc("labelActive",(function(t){return i.xc(e),i.gc().handleLabelActive(t)}))("labelEmpty",(function(t){return i.xc(e),i.gc().handleLabelEmpty(t)})),i.hc(1,"async"),i.Ub()}if(2&e){const e=t.$implicit,n=i.gc();i.Hb("view-whiteboard__label--clickthrough",i.ic(1,7,n.annotateMode$)!==n.whiteboardAnnotateMode.Text),i.lc("exporting",n.exporting)("id",e.id)("initialPos",e.pos)("color",e.color)("size",e.size)}}const k_=ws.PNG;let P_=(()=>{class e{constructor(e,t,n,i,s){this.store=e,this.actions=t,this.viewService=n,this.clipboardService=i,this.changeRef=s,this.whiteboardAnnotateMode=Fo,this.labels=[],this.exporting=!1,this.brushSize=0,this.eraserSize=0,this.lineWidth=0,this.ngUnsubscribe=new k.a}initTextModeListener(){this.inputManager=new Hammer.Manager(this.drawCanvas.nativeElement),this.inputManager.add(new Hammer.Tap({event:"tap"})),this.inputManager.on("tap",e=>{if(this.activeLabelId)return void(this.activeLabelId=void 0);const t=Object(D.uniqueId)();let n=e.center.x,i=e.center.y;void 0!==e.pointers[0].x&&(n=e.pointers[0].x,i=e.pointers[0].y);const s=this.store.selectSnapshot(mr.getWhiteboardBrushColor),o=this.store.selectSnapshot(mr.getWhiteboardTextSize);this.labels.push({id:t,pos:{x:n,y:i},color:s,size:o}),this.activeLabelId=t,this.changeRef.markForCheck(),this.dispatchHasText()})}handleLabelActive(e){this.activeLabelId=e;const t=this.labels.find(t=>t.id===e);t&&this.store.dispatch([new j.SetWhiteboardTextSize(t.size),new j.SetWhiteboardBrushColor(t.color)])}handleLabelEmpty(e){this.labels=this.labels.filter(t=>t.id!==e),this.changeRef.markForCheck(),this.dispatchHasText()}dispatchHasText(){this.store.dispatch(new j.SetWhiteboardHasText(this.labels.length>0))}ngOnInit(){this.canvasElement=this.drawCanvas.nativeElement,this.canvasContext=this.canvasElement.getContext("2d"),this.siteHeader=this.store.selectSnapshot(ll.getSiteHeader),this.store.dispatch(new tl.SetHeader(ol.Hide)),this.brushColor$.pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{const t=this.labels.find(e=>e.id===this.activeLabelId);t&&(t.color=e,this.changeRef.markForCheck())}),this.textSize$.pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{const t=this.labels.find(e=>e.id===this.activeLabelId);t&&(t.size=e,this.changeRef.markForCheck())}),this.annotateMode$.pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.inputManager&&this.inputManager.destroy(),e===Fo.Paint?(this.canvasContext.globalCompositeOperation="source-over",this.setLineWidth(this.brushSize),this.initInputListeners()):e===Fo.Text?this.initTextModeListener():e===Fo.Erase&&(this.canvasContext.globalCompositeOperation="destination-out",this.setLineWidth(this.eraserSize),this.initInputListeners())}),this.background$.pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{const t=gi.isLight(e)?Zo:Jo;this.store.dispatch(new j.SetWhiteboardBrushColor(t.color))})}ngAfterViewInit(){this.initCanvasListeners()}ngOnDestroy(){this.inputManager.destroy(),this.reset(),this.store.dispatch(new tl.SetHeader(this.siteHeader)),this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initCanvasListeners(){this.brushSize$.pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.setBrushSize(e)}),this.brushColor$.pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.setBrushColor(e)}),this.eraserSize$.pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.setEraserSize(e)}),this.syncCanvas()}initInputListeners(){this.inputManager=new Hammer.Manager(this.drawCanvas.nativeElement),this.inputManager.add(new Hammer.Pan({event:"pan",pointers:0})),this.inputManager.add(new Hammer.Tap({event:"tap"}));const e=new Map;this.inputManager.on("tap",e=>{e.pointers.forEach(t=>{if(void 0!==t.x){const{x:e,y:n}=t;this.drawPoint(e,n)}else{const{x:t,y:n}=e.center;this.drawPoint(t,n)}this.checkCanvasPaint()})}),this.inputManager.on("panstart",t=>{t.pointers.forEach(n=>{if(void 0===n.x)e.set(1,t.center);else{const{x:t,y:i}=n;e.set(n.pointerId,{x:t,y:i})}})}),this.inputManager.on("pan",t=>{t.pointers.forEach(n=>{let i=t.center.x,s=t.center.y,o=1;void 0!==n.pointerId&&(i=n.x,s=n.y,o=n.pointerId);const{x:r,y:a}=e.get(o);this.drawLine(r,a,i,s),this.drawPoint(i,s),e.set(o,{x:i,y:s})})}),this.inputManager.on("panend",()=>{e.clear(),this.checkCanvasPaint()})}handleResetClick(){this.reset()}handleDownloadClick(){this.exporting=!0,this.changeRef.detectChanges();const{width:e,height:t}=this.canvasElement,n=this.store.selectSnapshot(Or.getSelectedChapterId),i=this.store.selectSnapshot(Or.getSelectedChapterBackground),s=this.store.selectSnapshot(Er.getWatermarkEnabled),o=document.querySelector(".engine__watermark"),r=[this.annotateElement.nativeElement];s&&!Object(D.isNil)(o)&&r.push(o),this.store.dispatch(new Ss(n,i,k_,100,{width:e,height:t},"original",!0,!0,r)).pipe(Object(Us.a)(()=>this.actions.pipe(Object(d.j)(_s),Object(Ua.a)(1))),Object(M.a)(this.ngUnsubscribe),Object(Mr.a)(()=>{this.exporting=!1,this.changeRef.markForCheck()})).subscribe(e=>{this.downloadSnapshot(e.blob)})}handleExitClick(){this.resetCanvas(),this.viewService.toggleWhiteboard(!1)}checkCanvasPaint(){const e=this.canvasContext.getImageData(0,0,this.canvasElement.width,this.canvasElement.height),t=new Uint32Array(e.data.buffer).some(e=>0!==e);this.store.dispatch(new j.SetWhiteboardHasPaint(t))}drawPoint(e,t){const n=this.lineWidth/2,i=2*Math.PI;this.canvasContext.beginPath(),this.canvasContext.arc(e,t,n,0,i),this.canvasContext.fill()}drawLine(e,t,n,i){this.canvasContext.beginPath(),this.canvasContext.moveTo(e,t),this.canvasContext.lineTo(n,i),this.canvasContext.stroke(),this.canvasContext.closePath()}reset(){this.resetCanvas(),this.labels=[],this.changeRef.markForCheck(),this.dispatchHasText()}setBrushSize(e){this.brushSize=e,this.setLineWidth(e)}setBrushColor(e){this.canvasContext.fillStyle=e,this.canvasContext.strokeStyle=e}setEraserSize(e){this.eraserSize=e,this.setLineWidth(e)}setLineWidth(e){this.canvasContext.lineWidth=e,this.lineWidth=e}syncCanvas(){const e=this.store.selectSnapshot(mr.getWhiteboardBrushSize),t=this.store.selectSnapshot(mr.getWhiteboardBrushColor),n=this.store.selectSnapshot(mr.getWhiteboardEraserSize),{width:i,height:s}=this.getScreenDimensions();this.canvasElement.width=i,this.canvasElement.height=s,this.setBrushSize(e),this.setBrushColor(t),this.setEraserSize(n),this.canvasContext.lineJoin="round"}resetCanvas(){const{width:e,height:t}=this.canvasElement;this.canvasContext.clearRect(0,0,e,t),this.store.dispatch(new j.SetWhiteboardHasPaint(!1))}downloadSnapshot(e){const{displayName:t}=this.store.selectSnapshot(za.getStory),n=`${(t||"").replace(/ /g,"_").replace(/\W/g,"").toLowerCase()}_drawing.${k_===ws.PNG?"png":"jpg"}`;!0===c.native||c.platform===a.SDK?Ms.blobToBase64(e).pipe(Object(Us.a)(e=>this.clipboardService.copyToClipboard(e,"image")),Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{}):Ms.exportImage(e,k_,n)}getScreenDimensions(){const{innerWidth:e,innerHeight:t}=window;return{width:e,height:t}}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.g),i.Pb(d.b),i.Pb(Dl),i.Pb(Mp),i.Pb(i.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-whiteboard"]],viewQuery:function(e,t){if(1&e&&(i.Ec(S_,!0),i.Ec(__,!0)),2&e){let e;i.sc(e=i.dc())&&(t.drawCanvas=e.first),i.sc(e=i.dc())&&(t.annotateElement=e.first)}},decls:10,vars:15,consts:[[1,"view-whiteboard"],["annotateWrapper",""],["class","view-whiteboard__label",3,"view-whiteboard__label--clickthrough","exporting","id","initialPos","color","size","labelActive","labelEmpty",4,"ngFor","ngForOf"],["data-test","drawCanvas",1,"view-whiteboard__canvas"],["drawCanvas",""],[1,"view-whiteboard__tools"],[3,"clearClick","downloadClick","exitClick"],[1,"view-whiteboard__label",3,"exporting","id","initialPos","color","size","labelActive","labelEmpty"]],template:function(e,t){1&e&&(i.Vb(0,"div",0,1),i.hc(2,"async"),i.hc(3,"async"),i.hc(4,"async"),i.Ic(5,j_,2,9,"app-view-whiteboard-label",2),i.Qb(6,"canvas",3,4),i.Vb(8,"div",5),i.Vb(9,"app-view-whiteboard-tools",6),i.cc("clearClick",(function(){return t.handleResetClick()}))("downloadClick",(function(){return t.handleDownloadClick()}))("exitClick",(function(){return t.handleExitClick()})),i.Ub(),i.Ub(),i.Ub()),2&e&&(i.Hb("view-whiteboard--exporting",t.exporting)("view-whiteboard--cursor-paint",i.ic(2,9,t.annotateMode$)===t.whiteboardAnnotateMode.Paint)("view-whiteboard--cursor-erase",i.ic(3,11,t.annotateMode$)===t.whiteboardAnnotateMode.Erase)("view-whiteboard--cursor-text",i.ic(4,13,t.annotateMode$)===t.whiteboardAnnotateMode.Text),i.Db(5),i.lc("ngForOf",t.labels))},directives:[Z.k,f_,O_],pipes:[Z.b],styles:[".view-whiteboard{position:fixed;top:0;left:0;right:0;bottom:0;z-index:20;display:flex;flex-direction:column;align-items:center;justify-content:space-between;box-shadow:inset 0 0 0 4px #38de38;padding:8px;transition:border .3s linear}.view-whiteboard--exporting{box-shadow:none}.view-whiteboard--exporting .view-whiteboard__tools{display:none}.view-whiteboard--cursor-paint:hover{cursor:url(/assets/images/cursor-whiteboard-paint.svg) 7 20,pointer}.view-whiteboard--cursor-erase:hover{cursor:url(/assets/images/cursor-whiteboard-erase.svg) 7 20,pointer}.view-whiteboard--cursor-text:hover{cursor:url(/assets/images/cursor-whiteboard-text.svg) 7 20,pointer}.view-whiteboard__label{position:absolute;top:0;left:0;z-index:10}.view-whiteboard__label--clickthrough{pointer-events:none}.view-whiteboard__canvas{position:fixed;top:0;left:0;right:0;bottom:0;z-index:1}.view-whiteboard__tools{z-index:1;right:8px;bottom:8px;position:absolute}"],encapsulation:2,changeDetection:0}),w_([Object(d.d)(mr.getWhiteboardAnnotateMode),C_("design:type",P.a)],e.prototype,"annotateMode$",void 0),w_([Object(d.d)(mr.getWhiteboardBrushSize),C_("design:type",P.a)],e.prototype,"brushSize$",void 0),w_([Object(d.d)(mr.getWhiteboardBrushColor),C_("design:type",P.a)],e.prototype,"brushColor$",void 0),w_([Object(d.d)(mr.getWhiteboardTextSize),C_("design:type",P.a)],e.prototype,"textSize$",void 0),w_([Object(d.d)(mr.getWhiteboardEraserSize),C_("design:type",P.a)],e.prototype,"eraserSize$",void 0),w_([Object(d.d)(Or.getSelectedChapterBackground),C_("design:type",P.a)],e.prototype,"background$",void 0),e})();var M_=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let I_=(()=>{class e{constructor(e,t){this.store=e,this.changeDetectorRef=t,this.ngUnsubscribe=new k.a,this.visible=!1}beforePrint(e){this.visible=!0,this.changeDetectorRef.markForCheck()}afterPrint(e){this.visible=!1,this.changeDetectorRef.markForCheck()}ngOnInit(){this.initImageUrlListener()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initImageUrlListener(){Object(Ta.b)(this.storyChapters$,this.store.select(qs.getRegisteredThumbnails)).pipe(Object(I.a)(([e,t])=>e.length>0&&t.size>0),Object(F.a)(([e,t])=>t.get(e[0].id).urls.large),Object(qa.a)(),Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.imageUrl=e,this.changeDetectorRef.markForCheck()})}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.g),i.Pb(i.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-print"]],hostBindings:function(e,t){1&e&&i.cc("beforeprint",(function(){return t.beforePrint()}),!1,i.wc)("afterprint",(function(){return t.afterPrint()}),!1,i.wc)},decls:3,vars:1,consts:[[1,"view-print"],["src","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=",1,"view-print__scrim"],[1,"view-print__image",3,"src"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Qb(1,"img",1),i.Qb(2,"img",2),i.Ub()),2&e&&(i.Db(2),i.lc("src",t.imageUrl,i.Ac))},styles:[".view-print[_ngcontent-%COMP%]{background-color:#fff;display:none;position:absolute;top:0;left:0;width:100%;height:100%;z-index:10000;justify-content:space-around;margin:auto;margin-top:0!important}@media print{.view-print[_ngcontent-%COMP%]{display:flex}}.view-print__scrim[_ngcontent-%COMP%]{display:block;width:100%;height:100%;position:absolute;z-index:-1;top:0;right:0;bottom:0;left:0}.view-print__image[_ngcontent-%COMP%]{display:block;flex:1 1 auto;-o-object-fit:contain;object-fit:contain;margin:0 auto;z-index:1}"],changeDetection:0}),function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);o>3&&r&&Object.defineProperty(t,n,r)}([Object(d.d)(Or.getStoryChapters),M_("design:type",P.a)],e.prototype,"storyChapters$",void 0),e})();var z_=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function T_(e,t){if(1&e){const e=i.Wb();i.Vb(0,"div",1),i.Vb(1,"app-message-toggle",2),i.cc("handleDismiss",(function(){return i.xc(e),i.gc().handleDismiss()})),i.Vb(2,"div"),i.Kc(3," This model is not optimized for use on mobile devices. For an optimal experience, please switch to a desktop device or try our Anatomy by Regions. "),i.Ub(),i.Ub(),i.Ub()}2&e&&(i.Db(1),i.lc("dismiss",!0))}let U_=(()=>{class e{constructor(e){this.changeRef=e,this.shown=!1,this.ngUnsubscribe=new k.a}ngOnInit(){this.bookmark$.pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{const t=Object(D.get)(e,"tags",[]);this.shown=t.includes("complete anatomy"),this.changeRef.markForCheck()})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}handleDismiss(){this.shown=!1,this.changeRef.markForCheck()}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(i.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-content-warning"]],decls:2,vars:3,consts:[["class","warning",4,"ngIf"],[1,"warning"],["type","warning","toggleStyle","flat","icon","info-circle",3,"dismiss","handleDismiss"]],template:function(e,t){1&e&&(i.Ic(0,T_,4,1,"div",0),i.hc(1,"async")),2&e&&i.lc("ngIf",i.ic(1,1,t.bookmark$)&&t.shown)},directives:[Z.l,Gx],pipes:[Z.b],styles:[".warning{position:fixed;top:0;left:0;right:0;z-index:1001}"],encapsulation:2,changeDetection:0}),function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);o>3&&r&&Object.defineProperty(t,n,r)}([Object(d.d)(_C.getSelectedBookmark),z_("design:type",P.a)],e.prototype,"bookmark$",void 0),e})();var D_=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},L_=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const E_=["engineContainer"],F_=["viewContainer"],A_=["view"],R_=["viewCameraBar"],V_=["viewLogo"],N_=["viewSceneBase"],B_=["viewToolbar"],H_=["drawer"];function Q_(e,t){1&e&&i.Qb(0,"app-view-column-container")}function $_(e,t){1&e&&(i.Vb(0,"div",25),i.Qb(1,"app-view-title",26),i.Ub())}function q_(e,t){1&e&&(i.Vb(0,"div",27),i.Qb(1,"app-engine-audio"),i.Ub())}function W_(e,t){1&e&&(i.Vb(0,"div",28),i.Qb(1,"app-view-undo"),i.Ub())}function K_(e,t){1&e&&i.Qb(0,"app-view-toolbar",29)}function G_(e,t){1&e&&(i.Vb(0,"div",30),i.Qb(1,"app-view-menu",31),i.Ub())}function Z_(e,t){if(1&e&&i.Qb(0,"app-engine-camera-bar",32),2&e){const e=i.gc();i.lc("showNav",e.cameraVisible)}}function J_(e,t){if(1&e&&(i.Vb(0,"div",33),i.Qb(1,"app-view-logo",34),i.hc(2,"async"),i.Ub()),2&e){const e=i.gc();i.Db(1),i.lc("logoColor",e.isBackgroundLight?"color":"white")("logoSize",i.ic(2,3,e.breakpoint$)>e.breakpoint.Small?"full":"small")("contentId",e.contentId)}}function X_(e,t){if(1&e){const e=i.Wb();i.Tb(0),i.Vb(1,"app-view-drawer",35,36),i.cc("offsetYChange",(function(t){return i.xc(e),i.gc().handleDrawerOffsetChange(t)})),i.Ub(),i.Sb()}}function Y_(e,t){1&e&&i.Qb(0,"div",37)}function ej(e,t){if(1&e&&i.Qb(0,"app-view-ondemand",38),2&e){const e=i.gc();i.lc("contentId",e.contentId)("contentType",e.contentType)}}function tj(e,t){if(1&e&&(i.Qb(0,"app-view-progress",39),i.hc(1,"async")),2&e){const e=i.gc();i.lc("show",i.ic(1,2,e.viewWindow$)===e.viewWindow.Loader)("percent",e.chunkLoadProgress)}}function nj(e,t){if(1&e&&i.Qb(0,"app-play-loader",41),2&e){const e=i.gc(2);i.lc("percent",e.chunkLoadProgress)}}function ij(e,t){1&e&&i.Qb(0,"app-button-loader")}function sj(e,t){1&e&&i.Qb(0,"app-hand-loader")}function oj(e,t){if(1&e&&(i.Vb(0,"app-view-loader"),i.Ic(1,nj,1,1,"app-play-loader",40),i.hc(2,"async"),i.Ic(3,ij,1,0,"app-button-loader",4),i.hc(4,"async"),i.Ic(5,sj,1,0,"app-hand-loader",4),i.hc(6,"async"),i.Ub()),2&e){const e=i.gc();i.Db(1),i.lc("ngIf","play"===i.ic(2,3,e.interactType$)),i.Db(2),i.lc("ngIf","button"===i.ic(4,5,e.interactType$)),i.Db(2),i.lc("ngIf","hand"===i.ic(6,7,e.interactType$))}}function rj(e,t){1&e&&i.Qb(0,"app-view-tour")}function aj(e,t){1&e&&i.Qb(0,"app-view-whiteboard")}function cj(e,t){1&e&&i.Qb(0,"app-view-print")}function lj(e,t){1&e&&i.Qb(0,"app-view-content-warning")}const pj=function(e,t,n){return{"view-page--column-in":e,"view-page--column-out":t,"view-page--drawer-push":n}};let dj=(()=>{class e{constructor(e,t,n,i,o,r,a,c,l,p,d,u){this.activatedRoute=e,this.renderer=t,this.changeDetectorRef=n,this.store=i,this.actions=o,this.liveAnnouncer=r,this.viewService=a,this.quizService=c,this.layoutService=l,this.engineService=p,this.pendoService=d,this.title=u,this.application=s,this.nativePlatform=hd,this.breakpoint=$a,this.viewLayoutStatus=_o,this.viewMode=Da,this.viewUI=Xa,this.viewWindow=Eo,this.columnLayoutStatus=_o.Hide,this.drawerExpandable=!0,this.drawerOpen=!1,this.drawerY=0,this.loadLabel="",this.chunkLoadProgress=0,this.chaptersLoaded=0,this.isBackgroundLight=!0,this.selectedChapterLoading=!1,this.viewToolsMode=Fg,this.audioVisible=!1,this.cameraVisible=!1,this.columnVisible=!1,this.drawerVisible=!1,this.logoVisible=!1,this.menuVisible=!1,this.nodeInfoVisible=!1,this.searchVisible=!1,this.titleOnlyVisible=!1,this.toolbarVisible=!1,this.undoVisible=!1,this.ngUnsubscribe=new k.a,this.audioListening=new k.a}onClick(e){this.handleFirstClickTracking(e)}ngOnInit(){this.resetScene();const e=this.viewService.normalizeQueryParams(this.activatedRoute.snapshot.queryParams);this.contentId=e.id,this.contentType=e.type,this.contentLang=e.lang}ngAfterViewInit(){this.viewService.setViewLanguage(this.contentLang),this.loadStory(),this.store.dispatch(new Co({tag:!0,pin:!1})),this.store.dispatch(new ut(!0));const e=this.store.selectSnapshot(mr.getUI).loader.template;this.store.dispatch(new it(e===ko.Bar)),e!==ko.None&&this.store.dispatch(new j.ToggleWindow(Eo.Loader,!0)),this.checkCapabilities(),this.initSizeObservers(),this.initHeaderObserver(),this.initLayoutObserver(),this.initBreakpointObservers(),this.initKeyboardObserver(),this.initLoadProgressObserver(),this.initWindowObserver(),this.initBackgroundColorObserver(),this.initResponsiveLabels(),this.initNodeObserver(),this.initChapterObserver(),this.initAudioObserver(),this.initAccessibility(),this.positionRelativeElements(this.drawerY),this.storyId$.pipe(Object(I.a)(e=>!Object(D.isNil)(e)&&"preview"!==e),Object(Ua.a)(1),Object(M.a)(this.ngUnsubscribe)).subscribe(()=>this.initPendoEvents())}ngOnDestroy(){this.store.dispatch(new Ae(!1)),this.store.dispatch(new tc),this.store.dispatch(new po),Io.isFullscreen()&&Io.exitFullscreen(),this.quizService.exitQuiz(),this.unbindKeyboard(),this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}loadStory(){this.onDemand$.pipe(Object(I.a)(e=>!e),Object(Ua.a)(1),Object(M.a)(this.ngUnsubscribe)).subscribe(()=>{this.viewService.initStory(this.contentId,this.contentType,this.contentLang)})}checkCapabilities(){const e=this.renderer.listen("window","mouseover",()=>{e(),this.store.dispatch(new j.SetCanHover(!0))}),t="ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0;this.store.dispatch(new j.SetCanTouch(t)),this.store.dispatch(new j.SetCanFullscreen(Io.canFullscreen())),this.store.dispatch(new j.SetInputMode(t?Xo.Touch:Xo.Mouse))}initBreakpointObservers(){this.breakpoint$.pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(()=>{this.handleResize()})}initResponsiveLabels(){const e=Object(Uo.a)(window,"resize").pipe(Object(El.a)(100)),t=this.store.select(mr.getLabelsBreakpoint),n=this.store.select(Ca.getSelectedLabel),i=this.store.select(Ca.getLabelsCollapsed);n.pipe(Object(I.a)(()=>this.store.selectSnapshot(Ca.getLabelsCollapsed)),Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.viewService.toggleLabelInfo(!!e)}),i.pipe(Object(I.a)(()=>!!this.store.selectSnapshot(Ca.getSelectedLabel)),Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.viewService.toggleLabelInfo(e)}),Object(Ta.b)(e,t).pipe(Object(I.a)(([,e])=>!Object(D.isNil)(e)),Object(M.a)(this.ngUnsubscribe)).subscribe(()=>{this.checkLabelsCollapsed()}),this.checkLabelsCollapsed()}initSizeObservers(){const e=Eg({strategy:"scroll"});Object(Uo.a)(window,"resize").pipe(Object(El.a)(10),Object(M.a)(this.ngUnsubscribe)).subscribe(()=>{this.updateViewHeight(),this.refreshLayout()}),new P.a(t=>{e.listenTo(this.engineContainer.nativeElement,()=>{t.next()})}).pipe(Object(El.a)(10)).subscribe(()=>{this.resizeEngineContainer()})}initHeaderObserver(){this.store.select(ll.getSiteHeader).pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.updateViewHeight()})}initLayoutObserver(){this.layout$.pipe(Object(I.a)(e=>null!=e),Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.refreshLayout()})}initKeyboardObserver(){this.inputEnabled$.pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{e?this.bindKeyboard():this.unbindKeyboard()})}initNodeObserver(){this.actions.pipe(Object(d.j)(Ge),Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.viewService.delegateNodeClick(e.node,e.event)}),this.store.select(Bi.getSelectedNode).pipe(Object(ml.a)(),Object(M.a)(this.ngUnsubscribe)).subscribe(([e,t])=>{const n=Object(D.get)(e,"objectId",void 0),i=Object(D.get)(t,"objectId",void 0);void 0!==t&&n===i||this.viewService.toggleNodeInfo(!1)})}initChapterObserver(){this.store.select(Or.getSelectedChapterId).pipe(Object(I.a)(e=>null!=e),Object(F.a)(()=>this.store.selectSnapshot(Or.getSelectedChapter)),Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.viewService.initChapter(e),this.store.dispatch(new po),this.setPageTitle(e),this.refreshLayout()})}initLoadProgressObserver(){this.storyLoadProgress$.pipe(Object(M.a)(this.ngUnsubscribe),Object(I.a)(e=>1===e)).subscribe(()=>{this.viewService.resetLayout()}),this.store.select(oc.getChunkLoadProgress).pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.chunkLoadProgress=100*e,this.engineService.fireEvent(At.HumanProgress,{progress:this.chunkLoadProgress}),this.changeDetectorRef.markForCheck(),this.checkShowLoader()}),this.store.select(za.getLoadingChunk).pipe(Object(I.a)(()=>null!=this.store.selectSnapshot(Or.getSelectedChapterId)),Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{null!==e&&e.chapterId===this.store.selectSnapshot(Or.getSelectedChapterId)||c.offline?this.store.dispatch(new j.ToggleWindow(Eo.Loader,!0)):(this.engineService.enableRender(),this.store.dispatch(new j.ToggleWindow(Eo.Loader,!1)),this.refreshLayout(),setTimeout(()=>{this.engineService.enableAnimation()},500))}),this.actions.pipe(Object(d.i)(Ce),Object(M.a)(this.ngUnsubscribe)).subscribe(()=>{0===this.store.selectSnapshot(za.getLoadChunksRemaining).length&&(this.engineService.fireEvent(At.SceneLoaded,null),this.store.dispatch(new j.ToggleWindow(Eo.Loader,!1)),c.offline)&&setTimeout(()=>{this.engineService.enableAnimation()},1750)})}checkShowLoader(){if(this.store.selectSnapshot(Or.getSelectedChapterIndex)>0){const e=this.store.selectSnapshot(Or.getSelectedChapterId),t=this.store.selectSnapshot(za.getLoadingChunk);null!==t&&e===t.chapterId&&this.store.dispatch(new j.ToggleWindow(Eo.Loader,!0))}}initWindowObserver(){this.viewWindow$.pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.viewService.resetLayout(),e===Eo.Tutorial?(this.viewService.resetChapter(),this.viewService.toggleLabels(!1)):this.viewService.toggleLabels(!0)})}initBackgroundColorObserver(){this.background$.pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.isBackgroundLight=gi.isLight(e),this.changeDetectorRef.markForCheck()})}initAudioObserver(){const e=Object(Do.a)(this.ngUnsubscribe,this.audioListening),t=this.viewWindow$.pipe(Object(F.a)(e=>e===Eo.Tutorial||e===Eo.Interact),Object(I.a)(e=>e),Object(Ua.a)(1));Object(Ta.b)(this.viewWindow$,t,this.audio$).pipe(Object(I.a)(([e])=>Object(D.isNil)(e)),Object(M.a)(e)).subscribe(([,e,t])=>{e?Object(D.isNil)(t)||this.playAudio():this.stopAudioListening()})}initPendoEvents(){const e={totalQuestions:0};this.store.select(xs.getQuestionTotal).pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(t=>{e.totalQuestions=t}),this.store.select(xs.getQuizModeActive).pipe(Object(I.a)(()=>this.store.selectSnapshot(xs.getQuestionTotal)>0),Object(M.a)(this.ngUnsubscribe)).subscribe(t=>{t&&this.pendoService.track("Quiz - Entered",e)}),this.actions.pipe(Object(d.j)(ns.SubmitQuestionAnswer),Object(M.a)(this.ngUnsubscribe)).subscribe(()=>{const t=this.store.selectSnapshot(xs.getActiveQuestionIndex),n=this.store.selectSnapshot(xs.getQuestionsRemaining);0===t&&this.pendoService.track("Quiz - First Question Answered",e),0===n&&this.pendoService.track("Quiz - Completed",e)}),this.store.select(Or.getSelectedChapterModelReady).pipe(Object(I.a)(e=>e),Object(Ua.a)(1),Object(M.a)(this.ngUnsubscribe)).subscribe(()=>{const e=this.store.selectSnapshot(za.getStoryId),t=this.store.selectSnapshot(za.getStory);this.pendoService.trackOncePerPage("View - Loaded",{id:e,chapters:t.chapters.length,tour:t.tags.includes("tour"),animated:t.tags.includes("animated"),quiz:this.store.selectSnapshot(xs.hasQuiz),edit:!1})})}initAccessibility(){this.chapter$.pipe(Object(I.a)(e=>null!==e),Object(qa.a)((e,t)=>e.id===t.id),Object(F.a)(e=>Object(D.get)(e,"info.displayName",""))).subscribe(e=>{this.liveAnnouncer.announce("Opened chapter "+e)})}handleFirstClickTracking(e){e.composedPath().some(e=>"APP-SITE-HEADER"===e.nodeName)||1===this.store.selectSnapshot(oc.getStoryLoadProgress)&&this.pendoService.trackOncePerPage("First Click")}stopAudioListening(){this.audioListening.next(),this.audioListening.complete()}playAudio(){this.store.dispatch(new pt(!0)),this.stopAudioListening()}handleColumnToggle(){this.viewService.toggleColumn(),this.changeDetectorRef.markForCheck()}handleDrawerOffsetChange(e){this.drawerY=e,this.drawerOpen=-64!==e,this.positionRelativeElements(this.drawerY)}checkLabelsCollapsed(){const e=this.store.selectSnapshot(Ja.getBreakpoint),t=this.store.selectSnapshot(mr.getLabelsBreakpoint),n=this.isLabelBreaking(t);this.store.dispatch(new wo(n,e>=$a.Large?no.Toggle:no.None))}isLabelBreaking(e){return window.innerWidth<e}bindKeyboard(){Lg.bind("1",()=>this.viewService.selectTool(kr.Select)),Lg.bind("2",()=>this.viewService.selectTool(kr.Hide)),Lg.bind("3",()=>this.viewService.selectTool(kr.Fade)),Lg.bind(["command+,","ctrl+,"],e=>{e.preventDefault(),this.store.selectSnapshot(Ja.getBreakpoint)>$a.Medium?this.viewService.toggleColumn():this.drawer.toggleDrawer(),this.changeDetectorRef.markForCheck()}),Lg.bind(["command+enter","ctrl+enter","command+p"],e=>{e.preventDefault(),Io.toggleFullscreen()}),Lg.bind("meta+z",e=>{e.preventDefault(),this.viewService.undo()}),Lg.bind(["meta+y","meta+shift+z"],e=>{e.preventDefault(),this.viewService.redo()}),Lg.bind([".","pagedown"],()=>this.viewService.nextChapter("Keyboard")),Lg.bind([",","pageup"],()=>this.viewService.previousChapter("Keyboard")),Lg.bind(["del","backspace"],e=>{e.preventDefault(),this.viewService.hideSelectedStructures()}),Lg.bind("R",e=>{e.preventDefault(),this.viewService.resetChapter()}),Lg.bind("/",()=>this.viewService.toggleSearch()),Lg.bind("?",()=>this.viewService.toggleHelp()),Lg.bind("space",e=>{e.preventDefault(),this.viewService.toggleAnimation()})}unbindKeyboard(){Lg.reset()}resizeEngineContainer(){const{top:e,left:t,width:n,height:i}=this.engineContainer.nativeElement.getBoundingClientRect(),s=new $t(t,e,n,i,qt.Shown);this.store.dispatch(new ft(s))}updateViewHeight(){const e=c.application!==s.Viewer,t=pl(this.store.selectSnapshot(ll.getSiteHeader),e);this.view.nativeElement.style.setProperty("--vh",t+"px")}handleResize(){this.viewService.resetLayout()}resetScene(){this.store.dispatch(new Ae(!0)),this.store.dispatch(new Ne(!1)),this.store.dispatch(new ot(kr.Select)),this.store.dispatch(new tc),this.store.dispatch(new un(!1)),this.engineService.getEvent(At.AssetsLoadProgress).pipe(Object(Ua.a)(1),Object(M.a)(this.ngUnsubscribe)).subscribe(()=>{this.store.dispatch(new Ne(!0))})}refreshLayout(){const e=this.store.selectSnapshot(mr.getUI);this.columnLayoutStatus=e.column.status,this.audioVisible=this.layoutService.isVisible(Xa.Audio),this.cameraVisible=this.layoutService.isVisible(Xa.Camera),this.columnVisible=this.layoutService.isVisible(Xa.Column),this.drawerVisible=this.layoutService.isVisible(Xa.Drawer),this.logoVisible=this.layoutService.isVisible(Xa.Logo),this.menuVisible=this.layoutService.isVisible(Xa.Menu),this.nodeInfoVisible=this.layoutService.isVisible(Xa.NodeInfo),this.searchVisible=this.layoutService.isVisible(Xa.Search),this.titleOnlyVisible=this.layoutService.isVisible(Xa.TitleOnly),this.toolbarVisible=this.layoutService.isVisible(Xa.Toolbar),this.undoVisible=this.layoutService.isVisible(Xa.Undo),this.updateViewHeight(),this.resizeEngineContainer(),this.store.dispatch(new xo(!1!==e.anatomyLabels.enable,!1!==e.nodeInfo.enable,!0)),this.store.dispatch(new st(!1!==e.labels.enable&&!1!==e.labels.shown)),setTimeout(()=>{this.drawer?this.positionRelativeElements(this.drawerY):this.positionRelativeElements(),this.changeDetectorRef.markForCheck()})}positionRelativeElements(e=0){this.store.selectSnapshot(Ja.getBreakpoint),null!=this.viewCameraBar&&this.cameraVisible&&this.renderer.setStyle(this.viewCameraBar.nativeElement,"transform",`translate3d(-4px, ${this.menuVisible?-64:0}px, 0)`),this.renderer.setStyle(this.viewToolbar.nativeElement,"transform","translate3d(-8px, 0, 0)"),this.renderer.setStyle(this.viewSceneBase.nativeElement,"transform","translate3d(0, -8px, 0)"),this.renderer.setStyle(this.view.nativeElement,"padding-bottom",-e+"px")}setPageTitle(e){const t=Object(D.get)(e,"info.displayName");this.title.setTitle((t?t+" | ":"")+"BioDigital Human Platform")}isVisible(e){return this.layoutService.isVisible(e)}isEnabled(e){return this.layoutService.isUIEnabled(e)}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(T.a),i.Pb(i.H),i.Pb(i.i),i.Pb(d.g),i.Pb(d.b),i.Pb(Tl.i),i.Pb(Dl),i.Pb(Ag),i.Pb(rc),i.Pb(Qt),i.Pb(G),i.Pb(l.c))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-view-page"]],viewQuery:function(e,t){if(1&e&&(i.Ec(E_,!0),i.Ec(F_,!0),i.Ec(A_,!0),i.Pc(R_,!0),i.Pc(V_,!0),i.Ec(N_,!0),i.Pc(B_,!0),i.Pc(H_,!0,ux)),2&e){let e;i.sc(e=i.dc())&&(t.engineContainer=e.first),i.sc(e=i.dc())&&(t.viewContainer=e.first),i.sc(e=i.dc())&&(t.view=e.first),i.sc(e=i.dc())&&(t.viewCameraBar=e.first),i.sc(e=i.dc())&&(t.viewLogo=e.first),i.sc(e=i.dc())&&(t.viewSceneBase=e.first),i.sc(e=i.dc())&&(t.viewToolbar=e.first),i.sc(e=i.dc())&&(t.drawer=e.first)}},hostBindings:function(e,t){1&e&&i.cc("click",(function(e){return t.onClick(e)}),!1,i.vc)},decls:41,vars:40,consts:[["role","main"],["viewContainer",""],[1,"view-page",3,"ngClass"],["view",""],[4,"ngIf"],["class","view-page__title-only",4,"ngIf"],[1,"view-page__engine"],["engineContainer",""],["class","view-page__audio",4,"ngIf"],["class","view-page__undo",4,"ngIf"],[1,"view-page__column-toggle"],[1,"view-page__scene-base"],["viewSceneBase",""],[1,"view-page__toolbar"],["viewToolbar",""],["position","right",4,"ngIf"],["class","view-page__menu",4,"ngIf"],[1,"view-page__camera-bar"],["viewCameraBar",""],[3,"showNav",4,"ngIf"],["class","view-page__logo",4,"ngIf"],["class","view-block-input",4,"ngIf"],[3,"contentId","contentType",4,"ngIf"],[3,"show","percent",4,"ngIf"],[4,"appFlagApplication","appFlagApplicationMode","appFlagApplicationNative"],[1,"view-page__title-only"],["layout","column"],[1,"view-page__audio"],[1,"view-page__undo"],["position","right"],[1,"view-page__menu"],[1,"ml-4"],[3,"showNav"],[1,"view-page__logo"],[3,"logoColor","logoSize","contentId"],[3,"offsetYChange"],["drawer",""],[1,"view-block-input"],[3,"contentId","contentType"],[3,"show","percent"],[3,"percent",4,"ngIf"],[3,"percent"]],template:function(e,t){if(1&e&&(i.Vb(0,"div",0,1),i.Vb(2,"div",2,3),i.Ic(4,Q_,1,0,"app-view-column-container",4),i.Qb(5,"app-view-menu-column"),i.Ic(6,$_,2,0,"div",5),i.hc(7,"async"),i.Vb(8,"div",6,7),i.Ic(10,q_,2,0,"div",8),i.Ic(11,W_,2,0,"div",9),i.Vb(12,"div",10),i.Qb(13,"app-view-column-toggle"),i.Ub(),i.Vb(14,"div",11,12),i.Vb(16,"div",13,14),i.Ic(18,K_,1,0,"app-view-toolbar",15),i.Ub(),i.Ic(19,G_,2,0,"div",16),i.Vb(20,"div",17,18),i.Ic(22,Z_,1,1,"app-engine-camera-bar",19),i.Ub(),i.Ic(23,J_,3,5,"div",20),i.Ub(),i.Ic(24,X_,3,0,"ng-container",4),i.Ub(),i.Ub(),i.Ub(),i.Ic(25,Y_,1,0,"div",21),i.hc(26,"async"),i.Ic(27,ej,1,2,"app-view-ondemand",22),i.hc(28,"async"),i.Ic(29,tj,2,4,"app-view-progress",23),i.hc(30,"async"),i.Ic(31,oj,7,9,"app-view-loader",4),i.hc(32,"async"),i.Ic(33,rj,1,0,"app-view-tour",4),i.hc(34,"async"),i.Ic(35,aj,1,0,"app-view-whiteboard",4),i.hc(36,"async"),i.Ic(37,cj,1,0,"app-view-print",4),i.hc(38,"async"),i.Ic(39,lj,1,0,"app-view-content-warning",24),i.Qb(40,"app-view-iphone12-warning")),2&e){let e=null,n=null;i.Db(2),i.lc("ngClass",i.pc(36,pj,t.columnVisible,!t.columnVisible,t.drawerVisible)),i.Db(2),i.lc("ngIf",t.columnVisible||t.searchVisible||t.nodeInfoVisible),i.Db(2),i.lc("ngIf",t.titleOnlyVisible&&(null==(e=i.ic(7,20,t.chapter$))?null:e.info.displayName)),i.Db(4),i.lc("ngIf",t.audioVisible),i.Db(1),i.lc("ngIf",t.undoVisible),i.Db(7),i.lc("ngIf",t.toolbarVisible),i.Db(1),i.lc("ngIf",t.menuVisible),i.Db(3),i.lc("ngIf",t.cameraVisible),i.Db(1),i.lc("ngIf",t.logoVisible),i.Db(1),i.lc("ngIf",t.drawerVisible),i.Db(1),i.lc("ngIf",!i.ic(26,22,t.inputEnabled$)),i.Db(2),i.lc("ngIf",i.ic(28,24,t.viewWindow$)===t.viewWindow.OnDemand),i.Db(2),i.lc("ngIf","circle"===(null==(n=i.ic(30,26,t.layout$))?null:n.loader.template)),i.Db(2),i.lc("ngIf",i.ic(32,28,t.viewWindow$)===t.viewWindow.Interact),i.Db(2),i.lc("ngIf",i.ic(34,30,t.viewWindow$)===t.viewWindow.Tutorial),i.Db(2),i.lc("ngIf",i.ic(36,32,t.viewWindow$)===t.viewWindow.Whiteboard),i.Db(2),i.lc("ngIf",i.ic(38,34,t.usePrintImage$)),i.Db(2),i.lc("appFlagApplication",t.application.All)("appFlagApplicationMode","include")("appFlagApplicationNative",t.nativePlatform.All)}},directives:[Z.i,Z.l,Fx,Nx,bd,ev,cO,ah,pO,CO,Dw,QC,XC,kx,ux,eS,aS,pS,hS,YC,bS,o_,P_,I_,U_],pipes:[Z.b],styles:[".view-page{border:none;width:100vw;height:100vh;height:calc(var(--vh, 1vh) * 100);max-height:100vh;overflow:hidden;transition:padding-left .25s,padding-bottom .3s}.view-page--column-in{padding-left:320px}.view-page--column-out{padding-left:0}.view-page--drawer-push{padding-bottom:64px}.view-page__audio{position:absolute;z-index:10;top:12px;left:12px}.view-page__column{height:100%}.view-page__column-toggle{position:absolute;top:50%;margin-top:-18px;left:0;z-index:10}.view-page__engine{width:100%;height:100%;position:relative}.view-page__menu{position:absolute;right:8px;bottom:0;z-index:30}.view-page__camera-bar{position:absolute;bottom:0;right:4px;z-index:20}.view-page__logo{display:inline-block;position:absolute;left:16px;bottom:0;z-index:10}.view-page__media-bar{position:absolute;left:50%;margin-left:-100px;width:200px;bottom:0;z-index:10;justify-content:center}.view-page__media-bar:not([hidden]){display:flex}.view-page__notifications{position:absolute;top:12px;right:12px;z-index:20}.view-page__title-only{position:absolute;top:8px;left:8px;max-width:304px;z-index:10;padding:12px;border-radius:4px;background:hsla(0,0%,100%,.8);box-shadow:1px -1px 2px 0 rgba(28,42,63,.1),0 1px 2px 0 rgba(28,42,63,.3);color:#131c2a}.view-page__scene-base{position:absolute;left:0;bottom:0;right:0;z-index:10;transition:transform .3s}.view-page__toolbar{position:absolute;display:inline-block;z-index:20;bottom:0;right:64px;transition:transform .25s}.view-page__undo{position:absolute;display:flex;justify-content:center;pointer-events:none;left:0;z-index:10;width:100%}.view-block-input{position:fixed;top:0;bottom:0;left:0;right:0;z-index:10000}"],encapsulation:2,changeDetection:0}),D_([Object(d.d)(za.getStoryId),L_("design:type",P.a)],e.prototype,"storyId$",void 0),D_([Object(d.d)(mr.getUI),L_("design:type",P.a)],e.prototype,"layout$",void 0),D_([Object(d.d)(mr.getInputEnabled),L_("design:type",P.a)],e.prototype,"inputEnabled$",void 0),D_([Object(d.d)(mr.getFullscreenActive),L_("design:type",P.a)],e.prototype,"fullscreenActive$",void 0),D_([Object(d.d)(mr.getDrawerCoversContent),L_("design:type",P.a)],e.prototype,"drawerCoversContent$",void 0),D_([Object(d.d)(mr.getInteractType),L_("design:type",P.a)],e.prototype,"interactType$",void 0),D_([Object(d.d)(mr.getOnDemand),L_("design:type",P.a)],e.prototype,"onDemand$",void 0),D_([Object(d.d)(mr.getShowHelpTab),L_("design:type",P.a)],e.prototype,"showHelpTab$",void 0),D_([Object(d.d)(mr.getUsePrintImage),L_("design:type",P.a)],e.prototype,"usePrintImage$",void 0),D_([Object(d.d)(mr.getOpenWindow),L_("design:type",P.a)],e.prototype,"viewWindow$",void 0),D_([Object(d.d)(mr.getTutorialSeen),L_("design:type",P.a)],e.prototype,"tutorialSeen$",void 0),D_([Object(d.d)(oc.getStoryLoadProgress),L_("design:type",P.a)],e.prototype,"storyLoadProgress$",void 0),D_([Object(d.d)(Ja.getBreakpoint),L_("design:type",P.a)],e.prototype,"breakpoint$",void 0),D_([Object(d.d)(Or.getSelectedChapter),L_("design:type",P.a)],e.prototype,"chapter$",void 0),D_([Object(d.d)(Or.getSelectedChapterReadyState),L_("design:type",P.a)],e.prototype,"selectedChapterReady$",void 0),D_([Object(d.d)(Or.getChaptersLoaded),L_("design:type",P.a)],e.prototype,"chaptersLoaded$",void 0),D_([Object(d.d)(Or.getSelectedChapterBackground),L_("design:type",P.a)],e.prototype,"background$",void 0),D_([Object(d.d)(Or.getSelectedChapterAudio),L_("design:type",P.a)],e.prototype,"audio$",void 0),D_([Object(d.d)(Ca.getSelectedLabel),L_("design:type",P.a)],e.prototype,"selectedLabel$",void 0),e})(),uj=(()=>{class e{constructor(){}resolve(e){const t=Object.assign({},e.queryParams);return Na(Object.keys(t).reduce((e,n)=>{const i=Array.isArray(t[n]);return e[n]=i?Object(D.last)(t[n]):t[n],e},{}))}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac}),e})();var gj=n("1uah"),hj=n("l5mm"),bj=n("eNwd"),mj=function(e){return e.Content="content",e.SceneJS="scenejs",e}({}),fj=function(e){return e.Auth="auth",e}({});let yj=(()=>{class e{}return e.type="[Analytics] Authorize App",e})(),xj=(()=>{class e{constructor(e,t){this.userType=e,this.response=t}}return e.type="[Analytics] Auth Success",e})(),vj=(()=>{class e{constructor(e,t){this.userType=e,this.response=t}}return e.type="[Analytics] Auth Failure",e})(),Oj=(()=>{class e{constructor(e,t){this.interaction=e,this.source=t}}return e.type="[Analytics] Log Interaction",e})(),wj=(()=>{class e{constructor(e,t){this.interaction=e,this.response=t}}return e.type="[Analyics] Log Interaction Success",e})(),Cj=(()=>{class e{constructor(e,t){this.interaction=e,this.response=t}}return e.type="[Analyics] Log Interaction Failure",e})(),Sj=(()=>{class e{}return e.type="[Analytics] Log View Analytic",e})(),_j=(()=>{class e{}return e.type="[Analytics] Log Interaction Chance",e})(),jj=(()=>{class e{}return e.type="[Analytics] Log First Interaction",e})(),kj=(()=>{class e{}return e.type="[Analytics] Reset First Interaction",e})();var Pj=function(e){return e.Widget="widget",e.WidgetAPI="widgetapi",e}({}),Mj=n("Qyje"),Ij=function(e){return e.InvalidUAID="analytic id does not exist",e.InvalidDeveloperId="Client id invalid",e.InvalidProductKey="app product key",e.MissingUAID="analytic id missing",e.WebOnlyAPI="Api key only compatible with Web Widget",e.AndroidOnlyAPI="Api key only compatible with Mobile Widget SDK for Android",e.IOSOnlyAPI="Api key only compatible with Mobile Widget SDK for iOS",e.MixedAPIKeys="Use of both an app product key and an app api key not allowed",e.ProductKeyNotRegistered='App product key "xxx" has not been registered or is incorrect.  Ensure it has been registered by the system admin',e.ProductKeyInvalidAppBundleID='The app product key "xxx" has not been authorized to be used for app bundle id "yyy".  Confirm the correct values are being used from the system admin',e.ProductKeyBundleIDWhitelist='Use of app product key "xxx" requires the affiliated app bundle id (app_domain) to be white-listed.  Ensure the system admin has white-listed "yyy"',e.ImproperProductKeyUsage='Improper use of app product key "xxx" detected. Contact the system admin if issue continues',e.InvalidPlatformSource="Invalid platform source",e.MissingSource="Missing source",e.MissingPlatform="Missing platform",e.MissingAppDomain="Missing app domain",e.APIKeyMissing="Api key missing",e.APIKeyInvalid="Api key invalid",e.DeveloperDeactivated="Developer account for api key is deactivated",e.BundleIDNotAllowed="App bundle id not allowed",e.BundleIDUnregistered="App bundle id unregistered",e}({});class zj{}class Tj{}class Uj{}const Dj={headers:new v.d({"Content-Type":"application/json; charset=utf-8"})};let Lj=(()=>{class e{constructor(e,t,n){this.http=e,this.storageService=t,this.store=n}getAnalytic(e){return c.offline?(fetch("https://human.biodigital.com/ws/user/analytics?analytic_id="+e,{method:"GET",mode:"no-cors"}),Object(zs.a)({success:!0})):this.http.get("/ws/user/analytics?analytic_id="+e).pipe(Object(F.a)(()=>({success:!0})),Object(Ls.a)(e=>Object(zs.a)(this.parseError(e))))}sendAnalytic(e){if(c.offline){const t=e instanceof zj?"https://human.biodigital.com/ws/user/analytics":"https://human.biodigital.com/ws/developer/apps/access/key",n=Object(Mj.stringify)(e);if(navigator.onLine)this.sendOfflineAnalytic(t,n),this.sendSavedOfflineMessages(t);else{const e=(new Date).toISOString().substring(0,19);this.storageService.setDatabaseAnalyticItem("offline_event=1&event_timestamp="+e+"&"+n)}return Object(zs.a)({success:!0})}return this.http.post(e instanceof zj?"/ws/user/analytics":"/ws/developer/apps/access/key",e,Dj).pipe(Object(F.a)(()=>({success:!0})),Object(Ls.a)(e=>Object(zs.a)(this.parseError(e))))}sendOfflineAnalytic(e,t){return n=this,void 0,s=function*(){fetch(e,{headers:{"Content-Type":"application/x-www-form-urlencoded"},method:"POST",mode:"no-cors",body:t}).catch(()=>{navigator.onLine?setTimeout(()=>{fetch(e,{headers:{"Content-Type":"application/x-www-form-urlencoded"},method:"POST",mode:"no-cors",body:t})},300):this.storageService.setDatabaseAnalyticItem(t)})},new((i=void 0)||(i=Promise))((function(e,t){function o(e){try{a(s.next(e))}catch(n){t(n)}}function r(e){try{a(s.throw(e))}catch(n){t(n)}}function a(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(o,r)}a((s=s.apply(n,[])).next())}));var n,i,s}sendSavedOfflineMessages(e){this.storageService.getDatabaseOfflineAnalytics(t=>{t.forEach(t=>{this.sendOfflineAnalytic(e,t)})})}buildUserAnalytic(e,t){const n=this.store.selectSnapshot(_.getWidgetState),{widgetUrlConfig:i,parentUrl:s}=n,o=i.uaid,r=s.domain,a=Object.assign(Object.assign({},this.buildAppActivityData()),{parent_analytic_identifier:o,referer_domain:r,[e+"_source"]:t}),c={analytic_platform:Pj.Widget,analytic_type:e,analytic_data:a};return Object(A.plainToClass)(zj,c)}buildDeveloperAnalytic(e,t=Pj.Widget,n){const i=this.store.selectSnapshot(_.getWidgetState),{widgetUrlConfig:s,parentUrl:o,embedded:r}=i,a={platform:t,app_activity:e,app_productkey:s["app-productkey"],app_userid:s["app-userid"],app_apikey:s.dk,app_domain:o.full,app_activity_data:n,widget_is_fullscreen:!r};return Object(A.plainToClass)(Tj,a)}buildAppActivityData(){const e=this.store.selectSnapshot(_.getWidgetState),{engineVersion:t,engineAPIVersion:n,widgetUrlConfig:i}=e,s={engine_version:t,api_version:n};return Object.entries(i).filter(([e])=>"dk"!==e).forEach(([e,t])=>{s["url_param_"+e]=t}),Object(A.plainToClass)(Uj,s)}parseError(e){if(c.offline)return{success:!0,message:"",errorCode:null};const t=e.error.error,n=e.status,i=t&&t.message?t.message:"";return{success:n>=500&&n<=504,message:i,errorCode:Object.values(Ij).includes(i)?i:null}}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(v.b),i.Zb(ar),i.Zb(d.g))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var Ej=function(e){return e.Init="init",e.View="view",e.ChanceInteraction="interactionc",e.FirstInteraction="interactionf",e.Call="call",e}({});class Fj{}var Aj,Rj=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},Vj=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const Nj={authenticating:!1,authenticated:!1,bypassAnalytics:!1,loggedInteractions:{init:!1,view:!1,interactionc:!1,interactionf:!1,call:!1}};let Bj=(()=>{let e=Aj=class{constructor(e,t){this.store=e,this.analyticsService=t}static isAuthenticated(e){return e.authenticated}static isFirstInteractionLogged(e){return e.loggedInteractions.interactionf}autherizeAnalyticId(e){const t=this.store.selectSnapshot(_.getWidgetState),{embedded:n,userType:i,widgetUrlConfig:s}=t,o=s["bypass-analytics"];let r;e.patchState({bypassAnalytics:o}),!n||c.native||o?e.patchState({authenticated:!0}):(r=i===x.User?this.analyticsService.getAnalytic(s.uaid):this.analyticsService.sendAnalytic(this.analyticsService.buildDeveloperAnalytic(Ej.Init,Pj.WidgetAPI,this.analyticsService.buildAppActivityData())),e.patchState({authenticating:!0}),r.pipe(Object(Mr.a)(()=>e.patchState({authenticating:!1}))).subscribe(t=>{const n=t.success;e.patchState({authenticated:n}),e.dispatch(n?new xj(i,t):new vj(i,t))}))}logInteraction(e,{interaction:t,source:n}){const i=this.store.selectSnapshot(_.getWidgetState).userType===x.User?this.analyticsService.buildUserAnalytic(t,n):this.analyticsService.buildDeveloperAnalytic(t,Pj.Widget,this.analyticsService.buildAppActivityData());this.analyticsService.sendAnalytic(i).subscribe(n=>{e.dispatch(n.success?new wj(t,n):new Cj(t,n))})}logInteractionSuccess(e,t){const{loggedInteractions:n}=e.getState();n[t.interaction]=!0,e.patchState({loggedInteractions:n})}initView(e){const t=["interactive","complete"].includes(document.readyState),n=t?Object(zs.a)(t):Object(Uo.a)(document,"DOMContentLoaded");this.store.select(Aj.isAuthenticated).pipe(Object(_S.a)(n),Object(I.a)(e=>!0===e),Object(Ua.a)(1)).subscribe(()=>{e.getState().bypassAnalytics||this.store.dispatch(new Oj(Ej.View))})}logInteractionChance(e){const t=e.getState();t.loggedInteractions.interactionc||t.bypassAnalytics||e.dispatch(new Oj(Ej.ChanceInteraction))}logFirstInteraction(e){e.getState().loggedInteractions.interactionf||e.dispatch(new Oj(Ej.FirstInteraction))}resetFirstInteraction(e){const t=e.getState().loggedInteractions;t.interactionf=!1,e.patchState({loggedInteractions:t})}ngxsOnInit(e){e.dispatch(new Sj)}};return e.\u0275fac=function(t){return new(t||e)(i.Zb(d.g),i.Zb(Lj))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac}),Rj([Object(d.a)(yj),Vj("design:type",Function),Vj("design:paramtypes",[Object]),Vj("design:returntype",void 0)],e.prototype,"autherizeAnalyticId",null),Rj([Object(d.a)(Oj),Vj("design:type",Function),Vj("design:paramtypes",[Object,Oj]),Vj("design:returntype",void 0)],e.prototype,"logInteraction",null),Rj([Object(d.a)(wj),Vj("design:type",Function),Vj("design:paramtypes",[Object,wj]),Vj("design:returntype",void 0)],e.prototype,"logInteractionSuccess",null),Rj([Object(d.a)(Sj),Vj("design:type",Function),Vj("design:paramtypes",[Object]),Vj("design:returntype",void 0)],e.prototype,"initView",null),Rj([Object(d.a)(_j),Vj("design:type",Function),Vj("design:paramtypes",[Object]),Vj("design:returntype",void 0)],e.prototype,"logInteractionChance",null),Rj([Object(d.a)(jj),Vj("design:type",Function),Vj("design:paramtypes",[Object]),Vj("design:returntype",void 0)],e.prototype,"logFirstInteraction",null),Rj([Object(d.a)(kj),Vj("design:type",Function),Vj("design:paramtypes",[Object]),Vj("design:returntype",void 0)],e.prototype,"resetFirstInteraction",null),Rj([Object(d.e)(),Vj("design:type",Function),Vj("design:paramtypes",[Fj]),Vj("design:returntype",void 0)],e,"isAuthenticated",null),Rj([Object(d.e)(),Vj("design:type",Function),Vj("design:paramtypes",[Fj]),Vj("design:returntype",void 0)],e,"isFirstInteractionLogged",null),e=Aj=Rj([Object(d.f)({name:"modules",defaults:Nj})],e),e})();function Hj(e,t){const{procName:n,actionFn:i,aliases:s=[],mapFnIn:o,mapFnOut:r,hideDefinition:a=!1}=t,c=function(e){const t=this,n=o?o(e):e,s=i(n);if(void 0!==s)if(s instanceof P.a)s.subscribe(e=>{const n=r?r(e):e;t.setResult(n)});else{const e=r?r(s):s;t.setResult(e)}};[n,...s].forEach(t=>{const n=()=>e.rpc.define(t,c);a?e.rpc.hideDefinitions(()=>n()):n()})}var Qj=function(e){return e.AnnotationsCreate="annotations.create",e.AnnotationsDestroy="annotations.destroy",e.AnnotationsInfo="annotations.info",e.AnnotationsSetDescription="annotations.setDescription",e.AnnotationsSetLabelsShown="annotations.setLabelsShown",e.AnnotationsSetTitle="annotations.setTitle",e.AnnotationsUpdate="annotations.update",e.AnnotationsSetEnabled="annotations.setEnabled",e.CameraInfo="camera.info",e.CameraOrbit="camera.orbit",e.CameraPan="camera.pan",e.CameraReset="camera.reset",e.CameraSet="camera.set",e.CameraZoom="camera.zoom",e.setCameraMode="camera.setCameraMode",e.CameraDisableChapterCamera="camera.disableChapterCamera",e.CameraEnableChapterCamera="camera.enableChapterCamera",e.GetAnnotationInfo="annotations.info",e.HideAnnotations="annotations.hide",e.HotspotsCreate="hotspots.create",e.HotspotsDestroy="hotspots.destroy",e.HotspotsHide="hotspots.hide",e.HotspotsInfo="hotspots.info",e.HotspotsShow="hotspots.show",e.HotspotsTypes="hotspots.types",e.HotspotsUpdate="hotspots.update",e.HumanInfo="human.info",e.HumanCanvasInfo="human.canvasInfo",e.InputDisable="input.disable",e.InputEnable="input.enable",e.LabelsCreate="labels.create",e.LabelsDestroy="labels.destroy",e.LabelsInfo="labels.info",e.LabelsHide="labels.hide",e.LabelsSetEnabled="labels.setEnabled",e.LabelsShow="labels.show",e.LabelsUpdate="labels.update",e.LabelsCanvasUpdate="labels.canvasUpdate",e.LabelsSetScale="labels.setScale",e.NativeErrorMessage="native.errorMessage",e.NativeSetSdkOffline="native.setSdkOffline",e.NativeSetAppVersion="native.setAppVersion",e.NativeRedirect="native.redirect",e.NativeReload="native.reload",e.NativeOfflineModelIds="native.offlineModelIDs",e.QuizInfo="quiz.info",e.QuizEnter="quiz.enter",e.QuizExit="quiz.exit",e.QuizQuestion="quiz.currentQuestion",e.QuizSubmit="quiz.submit",e.QuizNextQuestion="quiz.next",e.QuizPreviousQuestion="quiz.previous",e.QuizSelectQuestion="quiz.select",e.QuizSet="quiz.set",e.QuizReset="quiz.reset",e.SceneMetaData="scene.metadata",e.SceneSetHighlightColor="scene.setHighlightColor",e.SceneColorObject="scene.colorObject",e.SceneDisableHighlight="scene.disableHighlight",e.SceneEnableHighlight="scene.enableHighlight",e.SceneGetColor="scene.getColor",e.SceneInfo="scene.info",e.SceneLoad="scene.load",e.ScenePick="scene.pick",e.SceneReset="scene.reset",e.SceneSelectObjects="scene.selectObjects",e.SceneShowObjects="scene.showObjects",e.SceneTransformObject="scene.transformObject",e.SceneUncolorObject="scene.uncolorObject",e.SceneSnapshot="scene.snapshot",e.SceneCapture="scene.capture",e.SceneRestore="scene.restore",e.SceneEnableXrayMode="scene.enableXray",e.SceneDisableXrayMode="scene.disableXray",e.SceneSetLayersSliderPosition="scene.setLayersSliderPosition",e.SceneGetLayers="scene.getLayers",e.SceneSetBaseDirectory="scene.setBaseDirectory",e.ShowAnnotations="annotations.show",e.SetAnnotationsShown="annotations.setShown",e.TimelineInfo="timeline.info",e.TimelineQuery="timeline.query",e.TimelineNext="timeline.nextChapter",e.TimelinePause="timeline.pause",e.TimelinePlay="timeline.play",e.TimelinePrev="timeline.previousChapter",e.TimelineSet="timeline.set",e.UIGetBackground="ui.getBackground",e.UIGetDisplay="ui.getDisplay",e.UIGetWorldPosition="ui.getWorldPosition",e.UISetBackground="ui.setBackground",e.UIPresetBackground="ui.presetBackground",e.UISetDisplay="ui.setDisplay",e.UIResetDisplay="ui.resetDisplay",e.UISnapshot="ui.snapshot",e.focusObject="focus.focusObject",e.dissectSetEnabled="dissect.setEnabled",e.pickSingleSetEnabled="pick.single.setEnabled",e.pickMultiSetEnabled="pick.multi.setEnabled",e.getCanvasPos="scene.getCanvasPos",e.sceneSetClickMode="scene.setClickMode",e.sceneGetClickMode="scene.getClickMode",e.IsolateObject="scene.isolateObject",e.UISetOndemand="ui.setOndemand",e.UISetLoadingExperience="ui.setLoadingExperience",e.UISetScrollCaptureMode="ui.setScrollCaptureMode",e.UISetTutorial="ui.setTutorial",e.UISetQuizLock="ui.setQuizLock",e}({});function $j(e){const t=e.captureCamera();return{position:t.lookAt.eye,target:t.lookAt.look,up:t.lookAt.up,zoom:t.zoom}}var qj,Wj,Kj=n("SxV6");function Gj(e){if(!e)return null;const{objectId:t,canvasPos:n,worldPos:i}=e;return{objectId:t||void 0,canvasPosition:n?{x:n[0],y:n[1]}:void 0,mode:"query",position:i?{x:i[0],y:i[1],z:i[2]}:void 0}}function Zj(e,t,n){const i=e.scene.objects[n].parent;return null!==i&&(t[i.objectId].checked||Zj(e,t,i.objectId))}function Jj(e,t){const n=t.includes("/")?o.Module:o.Bookmark;e.dispatch(new he(t,n))}function Xj(e,t){return e.dispatch(new qe(!0)),t.fireEvent(At.SceneXrayEnabled,void 0),!0}function Yj(e){var t,n;const i=e.find(e=>e.type==is.Images);return null!==(n=null===(t=null==i?void 0:i.images)||void 0===t?void 0:t.filter(e=>{var t;return null!=(null===(t=e.urls)||void 0===t?void 0:t.default)}).map(e=>e.urls.default))&&void 0!==n?n:[]}function ek(e,t,n,i){e.rpc.defineEvent(t,{events:n||[t],map:i||(e=>e)})}(qj||(qj={})).getCanvasPos=function(e,t,n,i,s){n&&fn.a.add(t,n,t);const o=e.renderer.getViewMat(),r=e.renderer.getProjMat(),a=fn.b.create();fn.a.transformMat4(a,t,o),a[3]=1,fn.b.transformMat4(a,a,r);const c=a[1],l=a[3];return[Math.round((1+a[0]/l)*i/2),Math.round((1-c/l)*s/2)]},function(e){e.isLegacyCaptureFormat=function(e){return void 0!==e.engineVersion},e.convertCaptureFormat=function(e){const t=Object.keys(e.objects).reduce((e,t)=>(e.push({objectId:t,selected:!1,hidden:!1}),e),[]);return{storyId:e.timeline.rootName.replace(".json",""),camera:{lookAt:e.camera,zoom:void 0},labels:[],objects:t,background:[],activeChapterId:e.timeline.scrub?e.timeline.scrub.chapterId:void 0}},e.convertMediaFormat=function(e){const t={};return Object.entries(e).forEach(([e,n])=>{t[e]={fullUrl:n.data.fullUrl,lang:n.data.lang,streamType:n.data.streamType}}),t}}(Wj||(Wj={}));var tk=n("I65S");function nk(e){return si.getColors(e).map(e=>e[255])}function ik(e,t){const n=e.selectSnapshot(Or.getSelectedChapterBackground),{colors:i,colorStops:s,gradientType:o}=n,r=t.colors?[].concat(...t.colors):i;return new gi(r,t.gradientType||o,t.colorStops||s)}function sk(e){return e.selectSnapshot(Ca.getChapterLabels)}function ok(e,t){return function(e,t){return e.find(e=>t===e.id)}(sk(e),t)}function rk(e,t){const n=function(e,t){return e.scene.markers.markers[t]}(e,t.id);return{annotationId:t.id,objectId:t.objectId||null,title:t.title,description:t.description,shown:t.shown,occludable:t.occludable,position:n?{x:n.pos[0],y:n.pos[1],z:n.pos[2]}:null,canvasPosition:n?{x:n.canvasPos[0],y:n.canvasPos[1]}:null}}function ak(e,t){const n=ok(e,t.annotationId);return n?Object.assign(Object.assign({},n),t):null}function ck(e,t){return t&&e.dispatch(new go(t)),!0}function lk(e,t){return e.dispatch(new Oo(t)),!0}function pk(e,t){return e.reduce((e,n)=>Object.assign(Object.assign({},e),{[""+n]:t}),{})}function dk(e,t){return function(e,n){return Object.entries(e).filter(([e,n])=>((e,n)=>n===t)(0,n)).reduce((e,[t,n])=>Object.assign(Object.assign({},e),{[""+t]:n}),{})}(e)}function uk(e,t){return Object.keys(dk(e,t))}function gk(e,t,n){return function(e,t){return e.filter(e=>t.includes(e.id))}(e,uk(t,n))}function hk(e,t,n){const i=uk(t,n).map(t=>function(e,...t){const n=t.map(t=>e.filter(e=>t===e.objectId));return function(e){const t=new Set(e);return Array.from(t.values())}([].concat(...n))}(e,t)).map(e=>e.map(e=>e.id));return pk([].concat(...i),n)}function bk(e,t){return[{eventName:At.AnnotationsCreated,aliasEvents:[At.LabelsCreated],mapFn:t=>rk(e,t)},{eventName:At.AnnotationsDestroyed,aliasEvents:[At.LabelsDestroyed],mapFn:e=>({annotationId:e.id})},{eventName:At.AnnotationsShown,aliasEvents:[At.LabelsEnabled],mapFn:()=>!0},{eventName:At.AnnotationsHidden,aliasEvents:[At.LabelsDisabled],mapFn:()=>!0}]}function mk(e,t,n){return[{procName:Qj.AnnotationsInfo,actionFn:()=>sk(t),mapFnOut:t=>function(e,t){return t.reduce((t,n)=>(t[n.id]=rk(e,n),t),{})}(e,t)},{procName:Qj.AnnotationsCreate,mapFnIn:i=>function(e,t,n,i){const s=t.selectSnapshot(Or.getSelectedChapter),o={annotationId:i.annotationId,title:i.title,description:i.description,objectId:e.scene.objects[i.objectId]?i.objectId:void 0,pos:i.position,occludable:i.occludable,labelOffset:i.labelOffset,shown:i.shown,labelShown:i.shown};return o.objectId&&void 0===o.pos&&(o.pos=e.scene.objects[o.objectId].center),n.deserializeAnnotation(o,s,ri.Annotation)}(e,t,n,i),actionFn:e=>function(e,t){return t.objectId||t.pos?(e.dispatch(new ro(t)),t):null}(t,e),mapFnOut:t=>t?rk(e,t):null},{procName:Qj.AnnotationsUpdate,mapFnIn:e=>ak(t,e),actionFn:e=>ck(t,e)},{procName:Qj.AnnotationsSetTitle,mapFnIn:e=>ak(t,e),actionFn:e=>ck(t,e),hideDefinition:!0},{procName:Qj.AnnotationsSetDescription,mapFnIn:e=>ak(t,e),actionFn:e=>ck(t,e),hideDefinition:!0},{procName:Qj.AnnotationsDestroy,mapFnIn:e=>ok(t,e),actionFn:e=>function(e,t){return t&&e.dispatch(new lo(t)),!0}(t,e)},{procName:Qj.ShowAnnotations,actionFn:()=>lk(t,!0)},{procName:Qj.SetAnnotationsShown,actionFn:()=>lk(t,!0),hideDefinition:!0},{procName:Qj.HideAnnotations,actionFn:()=>lk(t,!1)},{procName:Qj.AnnotationsSetLabelsShown,mapFnIn:e=>function(e,t){const{annotations:n,objects:i,replace:s}=t,o=n||{},r=i||{},a=sk(e),c=Object.assign(Object.assign(Object.assign(Object.assign({},dk(o,!0)),dk(o,!1)),hk(a,r,!0)),hk(a,r,!1));return s?Object.assign(Object.assign({},pk(a.map(e=>e.id),!1)),c):c}(t,e),actionFn:e=>function(e,t){const n=sk(e),i=gk(n,t,!1),s=gk(n,t,!0);e.dispatch(new vo(s,!0)),e.dispatch(new vo(i,!1))}(t,e),hideDefinition:!0}]}const fk={};function yk(e,t){t.hasOwnProperty("data")&&(t[e]=t.data)}const xk={hotspotSeedId:0,hotspotIdMap:new Map,getHotspotMap:e=>{const{hotspotIdMap:t,createHotspotId:n}=xk;return e.selectSnapshot(Ca.getLabels).forEach(e=>{const i=e.id;void 0===t.get(i)&&n(i)}),t},createHotspotId:e=>(xk.hotspotSeedId++,xk.hotspotIdMap.set(e,xk.hotspotSeedId),xk.hotspotSeedId),getHotspotIdByLabel:(e,t,n)=>{const{getHotspotMap:i,createHotspotId:s}=xk,o=i(e).get(t);return n&&void 0===o?s(t):o},getLabelIdByHotspotId:(e,t)=>{const n=xk.getHotspotMap(e),i=Array.from(n).find(([e,n])=>n===t);return i?i[0]:null}};function vk(e,t){const n=e.selectSnapshot(Ca.getLabels);return void 0!==t?n.filter(e=>e.chapterId===t):n}function Ok(e,t){const n=vk(e),i=xk.getLabelIdByHotspotId(e,t);return n.find(e=>e.id===i)}function wk(e){return e===_i.CirclePlus?oi.Plus:e===_i.CircleMinus?oi.Minus:oi.Default}function Ck(e,t){return xk.getHotspotIdByLabel(e,t)}function Sk(e,t){return Object.assign(Object.assign({},t),{id:Ck(e,t.id)})}function _k(e,t,n){const i=t.selectSnapshot(Or.getStoryChapters);return n.map(n=>function(e,t,n,i){const{id:s,chapterId:o,title:r,objectId:a}=i,c=n.findIndex(e=>o===e.id),l=xk.getHotspotIdByLabel(t,s,!0),p=function(e,t){return e.scene.markers.markers[t]}(e,s);return{id:l,title:r,objectId:a,position:p?jk(p.pos):null,direction:p?jk(p.dir):null,canvasPosition:p?(d=p.canvasPos,{x:d[0],y:d[1]}):null,chapterScope:c,type:i.pinType===oi.PlusMinus?_i.CirclePlus:_i.Circle,shown:i.shown,data:fk[i.id]};var d}(e,t,i,n))}function jk(e){return{x:e[0],y:e[1],z:e[2]}}function kk(e){return[e.x,e.y,e.z]}function Pk(e,t,n){return e.dispatch(new vo(t,n)),!0}function Mk(e,t){if("number"==typeof t){const n=Ok(e,t);return n?[n]:[]}return vk(e)}function Ik(e,t){return[{eventName:At.HotspotsEntered,mapFn:e=>Sk(t,e)},{eventName:At.HotspotsLeft,mapFn:e=>Sk(t,e)},{eventName:At.HotspotsPicked,mapFn:e=>Sk(t,e)},{eventName:At.HotspotsDisplayUpdated,mapFn:e=>Sk(t,e)},{eventName:At.HotspotsPositionUpdated,mapFn:e=>function(e,t){const{id:n,canvasPos:i}=t,{x:s,y:o}=i;return{id:Ck(e,n),canvasPosition:{x:s,y:o,0:s,1:o},occluded:t.occluded}}(t,e)}]}function zk(e,t,n){return[{procName:Qj.HotspotsInfo,actionFn:n=>{const i="number"==typeof n?n:void 0;if(void 0!==i){const n=Ok(t,i);return _k(e,t,[n])[0]}{const n=Mk(t,i);return _k(e,t,n)}}},{procName:Qj.HotspotsTypes,mapFnIn:()=>Object.values(_i).map(e=>""+e),actionFn:e=>e},{procName:Qj.HotspotsCreate,mapFnIn:e=>function(e,t,n){const{title:i,objectId:s,position:o,direction:r,chapterScope:a,type:c}=n,l=e.selectSnapshot(Or.getStoryChapters),p=e.selectSnapshot(Or.getSelectedChapter),d=e.selectSnapshot(Or.getSelectedChapterIndex),u="number"==typeof a?a:d,g=l[u]||p,h=!1!==n.shown,b=h&&!!i,m={title:i,type:c||_i.CircleLabel,objectId:s,pos:o?kk(o):null,dir:r?kk(r):null,shown:h,symbol:"",className:""},f=t.deserializeHotspots({},g,u,m);return f.title=i,f.expandTag=!0,f.flyTo=!1,f.flyToTarget=null,f.occludable=!0,f.pinGlow=!1,f.pinType=oi.PlusMinus,f.shown=h,f.hideTag=!b,f.hideWire=!0,f.theme=ri.StudioNext,f.pinType=wk(c),yk(f.id,n),f}(t,n,e),actionFn:e=>function(e,t){return t.objectId||t.pos?(e.dispatch(new ro(t)),t):null}(t,e),mapFnOut:e=>e?Ck(t,e.id):null},{procName:Qj.HotspotsUpdate,mapFnIn:e=>function(e,t){const n=Ok(e,t.id);return n?function(e,t){const{title:n,objectId:i,direction:s,position:o,shown:r,type:a}=e,c=Object.assign(Object.assign({},t),{title:n,objectId:i,shown:r,pos:o?kk(o):null,dir:s?kk(s):null,pinType:a?wk(a):null});return yk(t.id,e),Object.assign(Object.assign({},t),Object(D.omitBy)(c,D.isNil))}(t,n):null}(t,e),actionFn:e=>e?function(e,t){return e.dispatch(new go(t)),t}(t,e):null},{procName:Qj.HotspotsDestroy,mapFnIn:e=>Ok(t,e),actionFn:e=>e?function(e,t){return e.dispatch(new lo(t)),t}(t,e):null},{procName:Qj.HotspotsShow,mapFnIn:e=>Mk(t,e),actionFn:e=>Pk(t,e,!0)},{procName:Qj.HotspotsHide,mapFnIn:e=>Mk(t,e),actionFn:e=>Pk(t,e,!1)}]}function Tk(e){return e.selectSnapshot(Ca.getChapterLabels)}function Uk(e,t){return e.dispatch(new Oo(t)),!0}function Dk(e,t){return Tk(e).find(e=>t===e.id)}function Lk(e,t){return Tk(e).filter(e=>t.includes(e.id))}function Ek(e,t,n){return t&&t.objectId?(e.dispatch(n?new ro(t):new go(t)),t):null}function Fk(e,t){const n=document.createElement("span");return n.innerHTML=e,Object(D.trim)(n.textContent).length<=t}function Ak(e,t,n){const i=e;return i.title=t.title&&Fk(t.title,100)?t.title:i.title,i.description=t.description&&Fk(t.description,300)?t.description:i.description,i.theme=t.theme||i.theme,i.pinType=t.pinType||i.pinType,i.sequentialType=t.sequentialType||i.sequentialType,i.offset=function(e,t){return t||[-(e.hideWire?20:32),0]}(i,t.labelOffset),i.pinGlow=void 0!==t.pinGlow?t.pinGlow:i.pinGlow,i.hideWire=void 0!==t.hideWire?t.hideWire:i.hideWire,i.hideTag=void 0!==t.hideTag?t.hideTag:i.hideTag,i.collapseDescription=void 0!==t.collapseDescription?t.collapseDescription:i.collapseDescription,i.occludable=void 0!==t.occludable?t.occludable:i.occludable,i.cameraPosition=t.flyToCamera||i.cameraPosition,i.flyTo=function(e,t){return!1!==t&&(t||e.flyTo)}(i,t.flyTo),i.states=function(e){if(!e.flyTo)return[];const t=[new Oi,new Oi];t[0].errands=[new ji],t[1].errands=e.cameraPosition?[new Si(e.cameraPosition)]:[new Ci(e.objectId)]}(i),i}function Rk(e,t){if(t){const n=e.scene.markers.markers[t.id];return{labelId:t.id,objectId:t.objectId,title:t.title,description:t.description,theme:t.theme,pinType:t.pinType,labelOffset:t.offset,hideWire:t.hideWire,pinGlow:t.pinGlow,occludable:t.occludable,sequentialType:t.sequentialType,shown:t.shown,collapseDescription:t.collapseDescription,hideTag:t.hideTag,flyTo:!0===t.flyTo,flyToCamera:t.cameraPosition,position:n?[n.pos[0],n.pos[1],n.pos[2]]:t.pos,canvasPosition:n?[n.canvasPos[0],n.canvasPos[1]]:[-1,-1],occluded:!n||n.occluded}}return null}function Vk(e,t){return t.reduce((t,n)=>(t[n.id]=Rk(e,n),t),{})}function Nk(e){return e.selectSnapshot(xs.getAllQuestions)}function Bk(e,t){return Nk(e).find(e=>e.id===t)}function Hk(e){return Bk(e,Kk(e))}function Qk(e){return{enabled:e.selectSnapshot(xs.getQuizEnabled),active:e.selectSnapshot(xs.getQuizModeActive),questions:Xk(Nk(e)),questionId:Kk(e),submissions:$k(e,Wk(e))}}function $k(e,t){return t.map(t=>qk(e,t))}function qk(e,t){const n=Hk(e);return{questionId:t.questionId,answerIds:n.data.correctAnswer,correctAnswerIds:Yk(n),correct:cs(n,t.answer)}}function Wk(e){return e.selectSnapshot(xs.getAllSubmissions)}function Kk(e){return e.selectSnapshot(xs.getActiveQuestionId)}function Gk(e){const t=Hk(e),n=function(e){return Wk(e).find(t=>t.questionId===Kk(e))}(e);return{question:Jk(t),submission:n?qk(e,n):void 0}}function Zk(e){return e.map(e=>function(e){const t=e.type;switch(t){case is.Markdown:const{markdown:n}=e;return{type:t,content:n};case is.Images:const{images:i}=e;return{type:t,content:i.map(e=>e.urls.default)};default:return{type:t,content:""}}}(e))}function Jk(e){let t=[],n="";switch(e.type){case ss.MultipleChoice:const i=e.data;t=i.options.map(e=>function(e){return{answerId:e.value,displayText:e.label}}(e)),n=i.correctAnswer;break;case ss.SelectAnatomy:t=e.data.correctAnswer.map(e=>({answerId:e,displayText:e})),n="";break;case ss.LabelAnatomy:t=e.data.options.map(e=>({answerId:e.value,displayText:e.label.title})),n=""}return{questionId:e.id,questionType:e.type,questionPrompt:Zk(e.questionPrompt),answerExplanation:Zk(e.explanation),answers:t,answerId:n}}function Xk(e,t){const n=e.map(e=>Jk(e));return void 0!==t?n.filter(e=>t.includes(e.questionId)):n}function Yk(e){const t=Jk(e);switch(t.questionType){case ss.LabelAnatomy:case ss.SelectAnatomy:return t.answers.map(({answerId:e})=>e);case ss.Instructions:return["-"];default:return[t.answerId]}}let eP=(()=>{class e{constructor(e,t,n,i,s,o,r,a,c,l,p,d){this.store=e,this.actions=t,this.cameraService=n,this.engineService=i,this.animationService=s,this.paintService=o,this.labelsService=r,this.graphService=a,this.viewService=c,this.analyticsService=l,this.visibilityLayersService=p,this.quizService=d,this.webGLInfo=SceneJS.WEBGL_INFO}listen(e){this.initProcedures(),this.initEvents(),e&&this.logAPIUsage()}logAPIUsage(){setInterval(()=>{const e=Human.rpc.getLog(),t=Object(D.uniqBy)(e,e=>e.identifier);if(t.length>0){const e=JSON.stringify(t),n=this.analyticsService.buildDeveloperAnalytic(Ej.Call,Pj.WidgetAPI,e);this.analyticsService.sendAnalytic(n).subscribe({next:e=>{},error:e=>{throw new Error(e)}}),Human.rpc.resetLog()}},1e4)}initEvents(){var e,t;ek(Human,At.HumanProgress,void 0,e=>e),(e=this.store,[{eventName:At.HumanReady,aliasEvents:[At.HumanStarted]},{eventName:At.Error,aliasEvents:[At.HumanError],mapFn:e=>e},{eventName:At.HumanCanvasResized,aliasEvents:[At.CanvasResized],mapFn:()=>e.selectSnapshot(Er.getEnginePosition)}]).forEach(e=>{ek(Human,e.eventName,e.aliasEvents,e.mapFn)}),[{eventName:At.SceneLoaded,mapFn:e=>e},{eventName:At.ScenePicked,aliasEvents:[At.PickPicked],mapFn:Gj},{eventName:At.SceneObjectsSelected,mapFn:e=>e.selectedObjectsUpdate},{eventName:At.SceneObjectsShown,mapFn:e=>e.enabledObjectsUpdate},{eventName:At.SceneReady,aliasEvents:[At.Started]},{eventName:At.SceneRestored,mapFn:()=>!0},{eventName:At.SceneXrayEnabled,mapFn:()=>!0},{eventName:At.SceneXrayDisabled,mapFn:()=>!0},{eventName:At.NativeShare,mapFn:e=>e},{eventName:At.NativeDebugMessage,mapFn:e=>e}].forEach(e=>{ek(Human,e.eventName,e.aliasEvents,e.mapFn)}),(t=this.cameraService,[{eventName:At.CameraUpdated,aliasEvents:[At.CameraRested],mapFn:()=>$j(t)}]).forEach(e=>{ek(Human,e.eventName,e.aliasEvents,e.mapFn)}),[{eventName:At.TimelinePlaying,mapFn:e=>e},{eventName:At.TimelineCompleted,mapFn:e=>!0},{eventName:At.TimelineChapterTransition,aliasEvents:[At.TimelineChaptersActivated],mapFn:e=>({previousChapter:e.oldChapterIndex,currentChapter:e.newChapterIndex,time:e.time})}].forEach(e=>{ek(Human,e.eventName,e.aliasEvents,e.mapFn)}),[].forEach(e=>{ek(Human,e.eventName,e.aliasEvents,e.mapFn)}),[].forEach(e=>{ek(Human,e.eventName,e.aliasEvents,e.mapFn)}),function(e,t){return[...bk(e),...Ik(0,t),{eventName:At.LabelsChapterInfo,mapFn:t=>Vk(e,t)},{eventName:At.LabelsCreated,mapFn:t=>Rk(e,t)},{eventName:At.LabelsUpdated,mapFn:t=>Rk(e,t)},{eventName:At.LabelsDestroyed,mapFn:e=>({labelId:e.id})},{eventName:At.LabelsEntered,mapFn:e=>e},{eventName:At.LabelsLeft,mapFn:e=>e},{eventName:At.LabelsPicked,mapFn:e=>e},{eventName:At.LabelsMoved,mapFn:e=>e},{eventName:At.LabelsEnabled,mapFn:()=>!0},{eventName:At.LabelsDisabled,mapFn:()=>!0},{eventName:At.LabelsShown,mapFn:e=>e},{eventName:At.LabelsHidden,mapFn:e=>e}]}(Human,this.store).forEach(e=>{ek(Human,e.eventName,e.aliasEvents,e.mapFn)}),function(e){return[{eventName:At.QuizEntered,mapFn:()=>Qk(e)},{eventName:At.QuizExited,mapFn:()=>!0},{eventName:At.QuizQuestionLoaded,mapFn:e=>e},{eventName:At.QuizAnswerSelected,mapFn:t=>{const{questionId:n,answerId:i}=t;return{questionId:n,answerId:i,correctAnswerIds:Yk(Bk(e,t.questionId))}}},{eventName:At.QuizAnswerSubmitted,mapFn:t=>{const n=Bk(e,t.questionId),i=Yk(n);return{questionId:t.questionId,answerIds:t.answer,correctAnswerIds:i,correct:cs(n,t.answer)}}},{eventName:At.QuizCompleted,mapFn:()=>ls(Nk(e),Wk(e))}]}(this.store).forEach(e=>{ek(Human,e.eventName,e.aliasEvents,e.mapFn)})}initProcedures(){var e,t,n;(e=Human,t=this.webGLInfo,n=this.store,[{procName:Qj.HumanInfo,actionFn:()=>({version:e.VERSION,webglInfo:t,apiFunctions:e.rpc.getProcedures().sort(),apiEvents:e.rpc.getEvents().sort()})},{procName:Qj.HumanCanvasInfo,actionFn:()=>n.selectSnapshot(Er.getEnginePosition)}]).forEach(e=>{Hj(Human,e)}),function(e,t,n,i,s,o,r,a,c){return[{procName:Qj.SceneMetaData,actionFn:()=>{const e=t.selectSnapshot(za.getStory),n=t.selectSnapshot(Or.getStoryChapters);return{title:e.displayName,description:e.description,chapters:n.map(e=>({id:e.id,title:e.info.displayName,description:e.info.description,isAnimated:r.isChapterAnimated(e),loops:r.isChapterLooped(e),duration:r.getChapterLocalTimerange(e.id),media:Wj.convertMediaFormat(e.media),images:e.contentBlocks?Yj(e.contentBlocks):[],thumbnail:e.thumbnails?e.thumbnails.default:""}))}}},{procName:Qj.focusObject,actionFn:e=>(function(e,t,n){e.select&&e.xray?Xj(t,n):Rl(t,n),e.select&&t.dispatch(new Ii.UpdateNodesChecked(!0,[e.objectId])),t.dispatch(new Je(e.objectId,!0,1))}(e,t,n),!0),hideDefinition:!0},{procName:Qj.dissectSetEnabled,actionFn:e=>(t.dispatch(new ot(e.enable?kr.Hide:kr.Select)),!0),hideDefinition:!0},{procName:Qj.sceneSetClickMode,actionFn:e=>(t.dispatch(new ot("select"===e?kr.Select:"hide"===e?kr.Hide:"fade"===e?kr.Fade:kr.Select)),!0)},{procName:Qj.sceneGetClickMode,actionFn:()=>t.selectSnapshot(Er.getActiveTool)},{procName:Qj.pickSingleSetEnabled,actionFn:e=>{const n=(()=>{switch(e.enable){case void 0:return!t.selectSnapshot(mr.getMultiPickModeEnabled);case!0:return!1;case!1:return!0}})();return t.dispatch(new j.SetMultiPickModeEnabled(n)),!0},hideDefinition:!0},{procName:Qj.pickMultiSetEnabled,actionFn:e=>{const n=(()=>{switch(e.enable){case void 0:return!t.selectSnapshot(mr.getMultiPickModeEnabled);default:return e.enable}})();return t.dispatch(new j.SetMultiPickModeEnabled(n)),!0},hideDefinition:!0},{procName:Qj.getCanvasPos,actionFn:t=>{const i=n.getCanvas();return qj.getCanvasPos(e,t.worldPos,t.offset,i.width,i.height)},hideDefinition:!0},{procName:Qj.SceneCapture,actionFn:()=>function(e,t,n){const i=n.captureCamera(),s=t.selectSnapshot(Bi.getNodes),o=Object.keys(s).map(t=>({objectId:t,selected:s[t].checked||Zj(e,s,t),hidden:!s[t].shown})),r=t.selectSnapshot(Or.getStoryChapters).map(e=>({chapterId:e.id,background:e.background||Os})),a=t.selectSnapshot(za.getStoryId);return{camera:i,labels:t.selectSnapshot(Ca.getLabels),storyId:a,objects:o,background:r,activeChapterId:t.selectSnapshot(Or.getSelectedChapterId)}}(e,t,s)},{procName:Qj.SceneRestore,actionFn:i=>{const s=Wj.isLegacyCaptureFormat(i),o=s?Wj.convertCaptureFormat(i):i;return function(e,t,n,i,s){return new P.a(o=>{i.getEvent(At.HumanStarted).pipe(Object(Kj.a)()).subscribe(()=>{(function(e,t,n,i=!1){return new Promise(s=>{n.selectSnapshot(Er.getViewGraph);const o=t.objects.filter(e=>!0===e.selected).map(e=>e.objectId),r=i?e.scene.getLeaves().filter(e=>void 0===t.objects.find(t=>t.objectId===e)):t.objects.filter(e=>!0===e.hidden).map(e=>e.objectId),a=t.background.map(e=>new Hn(e.chapterId,e.background)),c=t.activeChapterId?[new Pn(t.activeChapterId)]:[],l=void 0!==t.camera.zoom?[new nn(t.camera.zoom)]:[];setTimeout(()=>{n.dispatch([new Zt(t.camera.lookAt,!1),new oo(t.labels),new Ii.UpdateNodesShown(!1,r),new Ii.UpdateNodesChecked(!0,o),...l,...c,...a]),s(void 0)})})})(e,t,n,s).then(()=>{i.fireEvent(At.SceneRestored,void 0),o.next(!0),o.complete()})}),Jj(n,t.storyId)})}(e,o,t,n,s)}},{procName:Qj.SceneEnableXrayMode,actionFn:()=>Xj(t,n)},{procName:Qj.SceneDisableXrayMode,actionFn:()=>Rl(t,n)},{procName:Qj.SceneLoad,actionFn:e=>(Jj(t,e),t.dispatch(new kj),!0)},{procName:Qj.SceneSetBaseDirectory,actionFn:t=>(e.events.fire("scene.setBaseDirectory",t),!0)},{procName:Qj.NativeSetSdkOffline,actionFn:t=>(e.events.fire("native.setSdkOffline",t),!0)},{procName:Qj.SceneReset,actionFn:()=>(a.resetChapter(),!0)},{procName:Qj.SceneInfo,actionFn:n=>{const i=n&&n.objectId?[n.objectId]:Object.keys(e.scene.objects),s=t.selectSnapshot(za.getStory).displayName;return function(e,t,n,i){const s=i.selectSnapshot(Bi.getNodes);return{name:t,objects:n.reduce((t,n)=>(t[n]=(t=>{const n=e.scene.objects[t],i=n.isLeaf()?s[t].checked||Zj(e,s,t):void 0;return{objectId:n.objectId,name:n.displayName,description:n.description||"",shown:n.shown,selected:i,children:n.objects.map(e=>e.objectId),parent:n.parent?n.parent.objectId:null}})(n),t),{})}}(e,s,i,t)}},{procName:Qj.ScenePick,actionFn:e=>Gj(n.pickScene({x:e.x,y:e.y,rayPick:!0}))},{procName:Qj.SceneSelectObjects,actionFn:e=>{const n=!0===e.replace,i=e;return delete i.replace,n&&t.dispatch(new Ii.UpdateNodesChecked(!1)),t.dispatch(new Ii.UpdateNodesChecked(!1,[],i)),!0}},{procName:Qj.SceneShowObjects,actionFn:n=>{delete n.replace;const i=(t,s)=>{const o=e.scene.objects[t].objects;let r={[t]:s};for(const e of o)void 0!==n[e.objectId]||(r[e.objectId]=s,r=Object.assign(Object.assign({},r),i(e.objectId,s)));return r},s=Object.entries(n).reduce((e,[t,n])=>Object.assign(Object.assign({},e),i(t,n)),{});return t.dispatch(new Ii.UpdateNodesShown(!1,[],s)),!0}},{procName:Qj.IsolateObject,actionFn:e=>{const n="string"==typeof e?[e]:e,i=t.selectSnapshot(Er.getViewGraph),s=o.getInverseSelection(i,n),r=o.getNodes(i,s);return t.dispatch(new Ii.UpdateNodesShown(!1,r.map(e=>e.id))),!0}},{procName:Qj.SceneTransformObject,actionFn:e=>(n.transformObject(e.objectId,e),!0)},{procName:Qj.SceneColorObject,actionFn:e=>{const{objectId:n,tintColor:i,saturation:s,contrast:o,brightness:r,opacity:a}=e;return t.dispatch(new Ii.UpdateNodesPaint(Fi.fromEngine({tintColor:i,saturation:s,contrast:o,brightness:r,opacity:a}),[n])),!0}},{procName:Qj.SceneGetColor,actionFn:e=>{const n=t.selectSnapshot(Bi.getNodePaint)(e.objectId);return Fi.toEngine(n)}},{procName:Qj.SceneUncolorObject,actionFn:e=>(t.dispatch(new Ii.UpdateNodesPaint(Hi,[e.objectId])),!0)},{procName:Qj.SceneDisableHighlight,actionFn:()=>(i.disableHighlight(),!0)},{procName:Qj.SceneEnableHighlight,actionFn:()=>(i.enableHighlight(),!0)},{procName:Qj.SceneSetHighlightColor,actionFn:e=>(i.setHighlightColor(e),!0)},{procName:Qj.SceneSetLayersSliderPosition,actionFn:e=>{const t=Math.min(1,Math.max(e.position,0)),n=c.fractionToIndex(t),i=c.fractionToPosition(t,n);return e.record?c.recordLayerIndexPosition(n,i):c.synchronizeScene(n,i,!1),!0}},{procName:Qj.SceneGetLayers,actionFn:()=>t.selectSnapshot(Or.getAllChaptersCurrentLayers)}]}(Human,this.store,this.engineService,this.paintService,this.cameraService,this.graphService,this.animationService,this.viewService,this.visibilityLayersService).forEach(e=>{Hj(Human,e)}),function(e,t){return[{procName:Qj.CameraInfo,actionFn:()=>$j(t)},{procName:Qj.CameraOrbit,actionFn:t=>(e.dispatch(new ln(void 0===t.pitch?0:t.pitch,void 0===t.yaw?0:t.yaw)),!0)},{procName:Qj.CameraPan,actionFn:t=>(e.dispatch(new rn(void 0===t.x?0:t.x,void 0===t.y?0:t.y,void 0===t.z?0:t.z)),!0)},{procName:Qj.CameraReset,actionFn:()=>e.dispatch(new en)},{procName:Qj.CameraSet,actionFn:n=>{const i=n.animate||!1;if(n.objectId)return e.dispatch(new Je(n.objectId,i,n.animationDuration)),!0;const s=$j(t);return e.dispatch(new Zt({eye:n.position||s.position,look:n.target||s.target,up:n.up||s.up},i)),!0}},{procName:Qj.CameraZoom,actionFn:t=>(e.dispatch(new nn(t||0)),!0)},{procName:Qj.setCameraMode,actionFn:t=>(e.dispatch(new pn("pan"===t?"pan":"rotate")),!0)},{procName:Qj.CameraDisableChapterCamera,actionFn:()=>(e.dispatch(new Xt(!1)),!0)},{procName:Qj.CameraEnableChapterCamera,actionFn:()=>(e.dispatch(new Xt(!0)),!0)}]}(this.store,this.cameraService).forEach(e=>{Hj(Human,e)}),function(e,t,n,i){return[{procName:Qj.TimelineQuery,actionFn:()=>({chapters:e.selectSnapshot(Or.getStoryChapters).map(e=>{const{description:t,displayName:n}=e.info;return{description:t,displayName:n,annotations:e.labels.map(e=>({title:e.title,description:e.description}))}})}),hideDefinition:!0},{procName:Qj.TimelineInfo,actionFn:()=>function(e,t){const n=t.getTimeFrame();return{time:t.getTime(),startTime:n.firstTime,endTime:n.lastTime,chapters:e.selectSnapshot(Or.getStoryChapters).map(e=>e.id),playing:t.isPlaying()}}(e,n)},{procName:Qj.TimelinePlay,actionFn:i=>{const s=i.loop||!1;if(void 0===i.time&&void 0===i.chapterId){const t=e.selectSnapshot(Or.getSelectedChapterId);return n.play({numChapters:1,loop:s,queue:!1,startChapterId:t}),!0}const o=Math.max(0,i.time),r=n.getTimeFrame().lastTime,a=Math.min(o,r-.001);return new P.a(o=>{t.pipe(Object(d.i)(Pn),Object(Ua.a)(1)).subscribe(()=>{n.play(Object.assign(Object.assign({},{numChapters:1,queue:!1,loop:s}),void 0!==i.time?{startTime:a}:{startChapterId:i.chapterId})),o.next(!0),o.complete()});const r=i.chapterId?i.chapterId:n.mapGlobalTimeToLocal(a,{tie:"later"}).branch.id;e.dispatch(new Pn(r))})}},{procName:Qj.TimelinePause,actionFn:()=>(n.pause(),!0)},{procName:Qj.TimelineSet,actionFn:i=>{if(void 0===i.time&&void 0===i.chapterId)return!0;if(void 0!==i.chapterId)return e.dispatch(new Pn(i.chapterId)),!0;const s=Math.max(0,i.time),o=n.getTimeFrame().lastTime,r=Math.min(s,o);return new P.a(i=>{t.pipe(Object(d.i)(Pn),Object(Ua.a)(1)).subscribe(()=>{n.scrub({time:r,which:0===r?"second":"first"}),i.next(!0),i.complete()});const s=n.mapGlobalTimeToLocal(r,0===r?{tie:"later"}:{});e.dispatch(new Pn(s.branch.id))})}},{procName:Qj.TimelineNext,actionFn:()=>(i.nextChapter("API"),!0)},{procName:Qj.TimelinePrev,actionFn:()=>(i.previousChapter("API"),!0)}]}(this.store,this.actions,this.animationService,this.viewService).forEach(e=>{Hj(Human,e)}),function(e){return[{procName:Qj.InputEnable,actionFn:()=>(e.dispatch(new b(!0)),!0)},{procName:Qj.InputDisable,actionFn:()=>(e.dispatch(new b(!1)),!0)}]}(this.store).forEach(e=>{Hj(Human,e)}),function(e,t,n,i,s){const o=new bl.a(!1);return n.pipe(Object(d.i)(Mn)).subscribe(()=>{o.next(!0)}),[{procName:Qj.UIGetBackground,actionFn:()=>function(e){const{colors:t,gradientType:n,colorStops:i}=e;return{colors:[[t[0],t[1],t[2],t[3]],[t[4],t[5],t[6],t[7]]],gradientType:n,colorStops:i}}(t.selectSnapshot(Or.getSelectedChapterBackground))},{procName:Qj.UISetBackground,mapFnIn:e=>{const{colors:t,colorStops:n,gradientType:i}=e;return{colors:t?nk(t):t,gradientType:i,colorStops:n}},actionFn:e=>{if(e){const n=ik(t,e);t.dispatch(new qn(n))}return!0}},{procName:Qj.UIPresetBackground,mapFnIn:e=>{const{colors:t,colorStops:n,gradientType:i}=e;return{colors:t?nk(t):t,gradientType:i,colorStops:n}},actionFn:e=>{if(e){const n=ik(t,e);c.platform===a.SDK&&o.next(!1),o.pipe(Object(I.a)(e=>!!e),Object(Ua.a)(1)).subscribe(()=>{t.dispatch(new Qn(n))})}return!0}},{procName:Qj.UIGetWorldPosition,actionFn:t=>{const{worldPos:n}=e.renderer.pick.pick(t.x,t.y,{rayPick:!0});if(n){const{0:e,1:t,2:i}=n;return{x:e,y:t,z:i}}return null}},{procName:Qj.UISetOndemand,actionFn:e=>(t.dispatch([new j.ToggleWindow(Eo.OnDemand,e.enabled)]),!0)},{procName:Qj.UISetLoadingExperience,actionFn:e=>(Object(D.isEmpty)(e)?t.dispatch(new j.CloseWindow(Eo.Interact)):t.dispatch([new j.SetInteractType(e),new j.OpenWindow(Eo.Interact)]),!0)},{procName:Qj.UISetScrollCaptureMode,actionFn:e=>(t.dispatch(new Re(e)),!0)},{procName:Qj.UISetTutorial,actionFn:e=>(t.dispatch([new j.ToggleWindow(Eo.Tutorial,e.enabled),new j.StartTutorial(e.enabled)]),!0)},{procName:Qj.UIGetDisplay,actionFn:()=>{const e=t.selectSnapshot(mr.getUI);return{audio:e.audio.enable,fullscreen:e.fullscreen.enable,help:e.help.enable,nav:e.camera.enable,cameraMode:e.camera.enable,center:e.camera.enable,zoomIn:e.camera.enable,zoomOut:e.camera.enable,info:e.column.enable||e.drawer.enable,playPause:e.media.enable,scrubber:e.media.enable,"scrubber.chapters":e.media.enable,tools:e.tools.enable,"tools-display":e.tools.enable,tour:e.pagination.enable,"tour.chapters":e.pagination.enable,objectTree:e.search.enable,anatomyLabels:e.anatomyLabels.enable,share:!1,dissect:!1,xray:!1,annotations:!1,crossSection:!1,isolate:!1}}},{procName:Qj.UISetDisplay,actionFn:e=>{const n=function(e){const t=null!=e.all?Xc(e.all):new qc;return Yc({all:e.all,[Xa.Loader]:Zc(e.loader),[Xa.Help]:Kc(e.help,e.help),[Xa.Tools]:Kc(e.tools,e.tools),[Xa.Layout]:e.layout,[Xa.Toolbar]:e.toolbar,[Xa.Fullscreen]:Kc(e.fullscreen,e.fullscreen),[Xa.Search]:Kc(e.objectTree,e.search),[Xa.Audio]:e.audio,[Xa.Media]:Gc(e.playPause,Kc(e.scrubber,e["scrubber.chapters"]),e.media),[Xa.Camera]:Kc(e.nav,e.cameraMode,e.center,e.zoomIn,e.zoomOut,e.nav),[Xa.Pagination]:Kc(e.tour,e["tour.chapters"]),[Xa.Column]:Kc(e.info,e.info),[Xa.Drawer]:Kc(e.info,e.info),[Xa.TitleOnly]:Kc(e.info,e.info),[Xa.LabelList]:Kc(e.labelList,e.labelList),[Xa.NodeInfo]:e.anatomyDescriptions,[Xa.Legend]:e.legend,[Xa.Menu]:e.menu,[Xa.InternetExplorerWarning]:void 0,[Xa.Logo]:e.logo,[Xa.Labels]:void 0,[Xa.Presenter]:void 0,logoIsHyperLink:void 0,drawerExpandedInitially:void 0,[Xa.Tutorial]:void 0,[Xa.AnatomyLabels]:Kc(e.anatomyLabels,e.anatomyLabels),[Xa.Undo]:Kc(e.reset,e.undo),[Xa.Whiteboard]:e.whiteboard,[Xa.VisibilityLayers]:e.visibilityLayers,[Xa.ContextActions]:e.contextActions,[Xa.ToggleLabels]:void 0},t)}(e);return t.dispatch(new m(n)),e}},{procName:Qj.UIResetDisplay,actionFn:()=>{const e=t.selectSnapshot(mr.getInitialUI);t.dispatch(new j.SetUI(e))}},{procName:Qj.UISetQuizLock,actionFn:e=>(n.pipe(Object(d.j)(Te),Object(Ua.a)(1)).subscribe(()=>{t.dispatch(new ns.SetQuizLocked(e)),t.dispatch(new ns.SetEnableQuizRetake(e)),!0===e&&s.startQuiz()}),!0)},{procName:Qj.UISnapshot,aliases:[Qj.SceneSnapshot],mapFnIn:e=>{const{width:t,height:n}=i.getCanvas();return Object.assign({width:t,height:n,openInTab:!1,fileType:"jpeg",quality:.92},e)},actionFn:e=>{const{width:i,height:s,openInTab:o,fileType:r}=e,a=t.selectSnapshot(Or.getSelectedChapterId),c={width:i,height:s},l="jpeg"===r?ws.JPEG:ws.PNG,p=t.selectSnapshot(Or.getSelectedChapterBackground);return t.dispatch(new Ss(a,p,l,.92,c,"original",!0,!0)).pipe(Object(Us.a)(()=>n.pipe(Object(d.j)(_s),Object(Ua.a)(1))),Object(Us.a)(e=>Ms.blobToBase64(e.blob)),Object(vn.a)(e=>{o&&e&&function(e){const t=window.open("","_blank");if(t){const n=t.document.createElement("img");n.src=e,t.document.body.appendChild(n)}}(e)}),Object(Ls.a)(()=>Object(tk.of)(null)))}}]}(Human,this.store,this.actions,this.engineService,this.quizService).forEach(e=>{Hj(Human,e)}),function(e,t,n,i){return[...mk(e,t,n),...zk(e,t,n),{procName:Qj.LabelsInfo,actionFn:e=>e.length>0?Lk(t,e):t.selectSnapshot(Ca.getChapterLabels),mapFnOut:t=>Vk(e,t)},{procName:Qj.LabelsCreate,mapFnIn:e=>e.labelId&&Dk(t,e.labelId)?null:e.objectId&&e.position?function(e,t,n,i){const s=n.makeDefaultStudioLabel();s.id=i.labelId||yi.idWithPrefix("label"),s.objectId=i.objectId,s.pos=i.position,s.renderableIndex=0,s.occludable=!0,s.flyTo=!0,s.description="",s.shown=!0;const o=t.selectSnapshot(Or.getSelectedChapter);return s.chapterId=o.id,Ak(s,i)}(0,t,n,e):(console.log("attempt to create a label with no objectId and position"),null),actionFn:e=>Ek(t,e,!0),mapFnOut:t=>Rk(e,t)},{procName:Qj.LabelsUpdate,mapFnIn:e=>Dk(t,e.labelId)?function(e,t){return Ak(Dk(e,t.labelId),t,e.selectSnapshot(Or.getSelectedChapter))}(t,e):null,actionFn:e=>Ek(t,e,!1),mapFnOut:t=>Rk(e,t)},{procName:Qj.LabelsCanvasUpdate,mapFnIn:e=>Dk(t,e.labelId)?function(e,t,n){const i=Dk(e,n.labelId),s=n.canvasPosition,o=t.pickScene({x:s[0],y:s[1],rayPick:!0});return o&&o.objectId?(i.objectId=o.objectId,i.pos=[o.worldPos[0],o.worldPos[1],o.worldPos[2]],i.offset=[i.hideWire?20:32,0],i.barycentric=[o.barycentric[0],o.barycentric[1],o.barycentric[2]],i.primitiveIndex=o.primitiveIndex,i.renderableIndex=o.renderableIndex||0,i):null}(t,i,e):null,actionFn:e=>Ek(t,e,!1),mapFnOut:t=>Rk(e,t)},{procName:Qj.LabelsDestroy,mapFnIn:e=>Dk(t,e),actionFn:e=>e?(t.dispatch(new lo(e)),{labelId:e.id}):null},{procName:Qj.LabelsShow,actionFn:e=>(e.length>0?t.dispatch(new vo(Lk(t,e),!0)):Uk(t,!0),!0)},{procName:Qj.LabelsHide,actionFn:e=>(e.length>0?t.dispatch(new vo(Lk(t,e),!1)):Uk(t,!1),!0)},{procName:Qj.LabelsSetEnabled,aliases:[Qj.AnnotationsSetEnabled],actionFn:e=>{t.dispatch(new st(e.enable))},hideDefinition:!0},{procName:Qj.LabelsSetScale,actionFn:e=>{t.dispatch(new bo(e.scale))}}]}(Human,this.store,this.labelsService,this.engineService).forEach(e=>{Hj(Human,e)}),function(e,t){function n(t){return e.selectSnapshot(xs.getQuizModeActive)?t():{error:"quiz mode is not active"}}return[{procName:Qj.QuizInfo,actionFn:()=>e.selectSnapshot(xs.hasQuiz)?Qk(e):null},{procName:Qj.QuizSubmit,actionFn:i=>n(()=>(t.submitQuestion(i.questionId,i.answerIds),Qk(e)))},{procName:Qj.QuizQuestion,actionFn:()=>n(()=>Gk(e))},{procName:Qj.QuizEnter,actionFn:()=>e.selectSnapshot(xs.hasQuiz)?(t.startQuiz(),!0):{error:"quiz not found"}},{procName:Qj.QuizExit,actionFn:()=>(t.exitQuiz(),!0)},{procName:Qj.QuizSelectQuestion,actionFn:t=>n(()=>(e.dispatch(new ns.SetActiveQuestion(t)),Qk(e)))},{procName:Qj.QuizNextQuestion,actionFn:()=>n(()=>(t.nextQuestion(),Gk(e)))},{procName:Qj.QuizPreviousQuestion,actionFn:()=>n(()=>(e.dispatch(new ns.SetQuizLifecycle(ds.Question)),e.dispatch(new ns.PreviousQuestion),Gk(e)))},{procName:Qj.QuizReset,actionFn:()=>(t.resetQuiz(),Qk(e))},{procName:Qj.QuizSet,actionFn:t=>{const{settings:n,startNumber:i,endNumber:s,locked:o}=t;if(!Object(D.isNil)(n)){const t=e.selectSnapshot(xs.getQuizSettings);e.dispatch(new ns.SetQuizSettings(Object.assign(Object.assign({},t),n)))}if("number"==typeof i||"number"==typeof s){const t=rs(e.selectSnapshot(Or.getStoryChapters)),n=t.slice("number"==typeof i?i-1:0,"number"==typeof s?s:t.length);e.dispatch(new ns.SetQuestions(n))}return"boolean"==typeof o&&e.dispatch(new ns.SetQuizLocked(o)),e.dispatch(new ns.SetQuizQuestionsMode("number"==typeof i&&"number"==typeof s?"restricted":"all")),Qk(e)}}]}(this.store,this.quizService).forEach(e=>{Hj(Human,e)})}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(d.g),i.Zb(d.b),i.Zb(yn),i.Zb(Qt),i.Zb(eo),i.Zb(Hl),i.Zb(Pi),i.Zb(Et),i.Zb(Dl),i.Zb(Lj),i.Zb(ql),i.Zb(Ag))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),tP=(()=>{class e{constructor(e,t,n){this.locationStrategy=e,this.router=t,this.errorLoggingService=n,window.SceneJS_error.setFatalErrorHandler(this.handleSceneJSFatalErrors.bind(this))}handleSceneJSFatalErrors(e){const t={log:Human.log.messages.join("\n"),stack:e.stackTrace,webglInfo:window.SceneJS.WEBGL_INFO},n={category:e.errorName,log:JSON.stringify(t),message:e.messageFromCaller};this.errorLoggingService.logError(n,!0).subscribe();const i=btoa(JSON.stringify(e));this.redirectToErrorPage(mj.SceneJS,void 0,i)}redirectToErrorPage(e,t,n){if((this.router.url||"").match("/error"))return;const i=this.locationStrategy.getBaseHref(),o=this.router.createUrlTree([c.application===s.Viewer?i+"/error":i+"/view/error"],{queryParams:{errorType:e,errorCode:t,errorBlob:n,errorUrl:this.router.url}}),r=this.router.serializeUrl(o);window.location.href=r}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(Z.h),i.Zb(T.e),i.Zb(Gf))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const nP=["*"];let iP=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-warning-message"]],ngContentSelectors:nP,decls:2,vars:0,consts:[[1,"message","p-4","text-12"]],template:function(e,t){1&e&&(i.kc(),i.Vb(0,"div",0),i.jc(1),i.Ub())},styles:[".message{background-color:#2d72dc;color:#fff}@media print{.message{display:none}}"],encapsulation:2,changeDetection:0}),e})();var sP=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function oP(e,t){if(1&e){const e=i.Wb();i.Vb(0,"app-warning-message"),i.Vb(1,"div",1),i.Vb(2,"div",2),i.Kc(3),i.Ub(),i.Vb(4,"div"),i.Vb(5,"div",3),i.cc("click",(function(){return i.xc(e),i.gc().handleDismissClick()})),i.Qb(6,"app-icon",4),i.Ub(),i.Ub(),i.Ub(),i.Ub()}if(2&e){const e=i.gc();i.Db(3),i.Mc(" ",e.message," ")}}let rP=(()=>{class e{constructor(e,t){this.changeDetector=e,this.storageService=t,this.show=!1,this.message="For the full interactive 3D experience please try loading this content in Chrome or Firefox.",this.ngUnsubscribe=new k.a}ngOnInit(){this.initLayoutListener()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}handleDismissClick(){this.show=!1,this.storageService.setLocalItem(ir.InternetExplorerWarning,!0)}shouldShow(e){const t=this.storageService.getLocalItem(ir.InternetExplorerWarning);return nw()&&!t&&e.internetExplorerWarning.enable}initLayoutListener(){this.layout$.pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.show=this.shouldShow(e),this.changeDetector.markForCheck()})}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(i.i),i.Pb(ar))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-ie-warning"]],decls:1,vars:1,consts:[[4,"ngIf"],[1,"warning","flex","flex-row","justify-between"],[1,"warning__text","flex-auto"],[1,"warning__close","flex","justify-center",3,"click"],["icon","times","size","lg","title","Close"]],template:function(e,t){1&e&&i.Ic(0,oP,7,1,"app-warning-message",0),2&e&&i.lc("ngIf",!0===t.show)},directives:[Z.l,iP,dl],styles:[".warning[_ngcontent-%COMP%]{align-items:center}.warning__text[_ngcontent-%COMP%]{text-align:center}.warning__close[_ngcontent-%COMP%]{cursor:pointer;align-items:center;width:32px;height:32px}"],changeDetection:0}),function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);o>3&&r&&Object.defineProperty(t,n,r)}([Object(d.d)(mr.getUI),sP("design:type",P.a)],e.prototype,"layout$",void 0),e})(),aP=(()=>{class e{constructor(e,t){this.el=e,this.renderer=t}ngOnInit(){nw()||this.renderer.setStyle(this.el.nativeElement,"display","none")}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(i.m),i.Pb(i.H))},e.\u0275dir=i.Kb({type:e,selectors:[["","appShowIE11",""]]}),e})();var cP=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},lP=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function pP(e,t){1&e&&i.Qb(0,"div",4)}const dP={title:"We're unable to find the model you're looking for.",description:'Please check your URL or visit the <a href="/" target="_blank">BioDigital Human</a> to see what\'s available in our 3D model library.'},uP={title:"Your BioDigital Human embed requires proper authentication.",description:""},gP={[Ij.InvalidUAID]:{title:"Authentication Issues",description:"Your Human Widget has invalid user credentials.",url:"https://support.biodigital.com"}};function hP(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",13),i.cc("click",(function(){return i.xc(e),i.gc(2).handleSeeDetailsClick()})),i.Kc(1," See Details "),i.Ub()}}function bP(e,t){if(1&e&&(i.Vb(0,"textarea",14),i.Kc(1,"        "),i.Ub()),2&e){const e=i.gc(2);i.lc("value",e.sceneJSErrorReport)}}function mP(e,t){if(1&e){const e=i.Wb();i.Vb(0,"div"),i.Vb(1,"h1",3),i.Kc(2,"The BioDigital Human encountered an error."),i.Ub(),i.Vb(3,"h2",4),i.Kc(4," Error: "),i.Vb(5,"span",5),i.Kc(6),i.Ub(),i.Ub(),i.Vb(7,"div",6),i.Kc(8," To receive assistance with this error, please follow these steps: "),i.Ub(),i.Vb(9,"ol",7),i.Vb(10,"li",8),i.Vb(11,"button",9),i.cc("click",(function(){return i.xc(e),i.gc().handleDownloadClick()})),i.Kc(12," Download "),i.Ub(),i.Kc(13," the error report. "),i.Ub(),i.Vb(14,"li",8),i.Vb(15,"button",9),i.cc("click",(function(){i.xc(e);const t=i.gc();return t.handleActionClick(t.supportURL)})),i.Kc(16," Share the report "),i.Ub(),i.Kc(17," with the customer support team. "),i.Ub(),i.Ub(),i.Vb(18,"div",10),i.Ic(19,hP,2,0,"button",11),i.Vb(20,"div"),i.Ic(21,bP,2,1,"textarea",12),i.Ub(),i.Ub(),i.Ub()}if(2&e){const e=i.gc();i.Db(6),i.Lc(e.sceneJSErrorTeaser),i.Db(13),i.lc("ngIf",!e.viewSceneJSErrorDetails),i.Db(2),i.lc("ngIf",e.viewSceneJSErrorDetails)}}function fP(e,t){if(1&e){const e=i.Wb();i.Vb(0,"div",3),i.Kc(1),i.Ub(),i.Vb(2,"div",15),i.Tb(3),i.Vb(4,"button",9),i.cc("click",(function(){i.xc(e);const t=i.gc();return t.handleActionClick(t.supportURL)})),i.Kc(5," Contact Support "),i.Ub(),i.Sb(),i.Ub(),i.Qb(6,"div",16)}if(2&e){const e=i.gc();i.Db(1),i.Mc(" ",e.title," "),i.Db(5),i.lc("innerHTML",e.description,i.yc)}}const yP=[{path:"",component:(()=>{class e{constructor(e,t,n,i,o,r,c,l,p,d,u){this.store=e,this.actions=t,this.activatedRoute=n,this.widgetAPIHandler=i,this.errorService=o,this.engineService=r,this.cameraService=c,this.storageService=l,this.renderer=p,this.viewService=d,this.quizService=u,this.title="Biodigital Human",this.environmentApplication=s,this.environmentPlatform=a,this.ngUnsubscribe=new k.a}ngOnInit(){this.initErrorHandling(),this.initInteractions();const{data:e}=this.activatedRoute.snapshot,t=e.widgetUrlConfig;this.initWidgetBreakpoints(t),this.initWidgetLabelScale(t),this.initWidgetLayout(t),this.initWidgetSetup(t),this.initCustomWidgetSettings(t.paid),this.store.dispatch(new yj),this.initBackgroundFromWidget(t),this.initBackgroundFromChapter(),this.initCamera(t),this.initRotation(t),this.initQuizInteractions(t),this.widgetAPIHandler.listen(c.deploy===r.Production),this.initChaptersReadyListener(),this.initHumanReadyListener(),this.initDynamicLayout()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initWidgetSetup(e){const t=window!==window.top,n=t?BD_DOCUMENT_REFERRER:window.location.href;this.store.dispatch(new g(n,t,e));const i=this.store.selectSnapshot(mr.getUI),s=Jc(e),o=el(i,s);this.store.dispatch(new j.SetUI(o)),this.store.dispatch(new j.SetInitialUI(o));const r=function(e){return e["disable-scroll"]?Pr.DoNotCapture:e["disable-scroll.alert"]||e["disable-scroll.overlay"]?Pr.DoNotCaptureShowMessage:Pr.Capture}(e);this.store.dispatch(new Re(r));const a=function(e){return!0===e["ui-print-image"]}(e),c=function(e){return!1===e["auto-load"]}(e),{interactType:l,isInteractActive:p}=function(e,t,n){const i=e["initial.play"]||e.initial||e["initial.button"]||e["initial.hand"]||e["initial.hand-hint"]||t;return{interactType:(()=>{switch(!0){case e.initial:case e["initial.button"]:return Lo.Button;case e["initial.hand"]:case e["initial.hand-hint"]:return Lo.Hand;case e["initial.play"]:return Lo.Play;default:return n}})(),isInteractActive:i}}(e,this.store.selectSnapshot(mr.shouldWindowOpen(Eo.Interact)),this.store.selectSnapshot(mr.getInteractType)),d=this.storageService.getLocalItem(ir.GettingStartedTutorial),u=!0===s.tutorial&&"true"!==d;this.store.dispatch([new j.SetOnDemand(c),new j.ToggleWindow(Eo.OnDemand,c),new j.SetInteractType(l),new j.ToggleWindow(Eo.Interact,p),new j.ToggleWindow(Eo.Tutorial,u),new j.StartTutorial(u),new j.SetUsePrintImage(a)])}initCustomWidgetSettings(e){c.offline||e&&(this.store.select(_.getWidgetSettings).pipe(Object(I.a)(e=>!Object(D.isNil)(e)&&e.length>0),Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{e.forEach(e=>{e.anatomy_description_fallback&&this.viewService.setAnatomyDescriptionFallback(e.anatomy_description_fallback)})}),this.store.dispatch(new f(e)))}initErrorHandling(){this.actions.pipe(Object(d.j)(je),Object(M.a)(this.ngUnsubscribe)).subscribe(()=>this.handleContentErrors()),this.actions.pipe(Object(d.j)(vj),Object(M.a)(this.ngUnsubscribe)).subscribe(e=>this.handleAuthErrors(e))}initWidgetBreakpoints({"ui-collapse-label":e,"annotation-collapse":t}){const n=[e,t].find(e=>!Object(D.isNil)(e));Object(D.isNil)(n)||this.store.dispatch(new j.SetLabelBreakpoint(n))}initWidgetLabelScale({"label-scale":e}){Object(D.isNil)(e)||this.store.dispatch(new bo(e))}initWidgetLayout({"ui-layout":e}){Object(D.isNil)(e)||this.store.dispatch(new j.SetLayout(e))}initQuizInteractions(e){const t=this.store.select(_C.getSelectedBookmark);Object(Ta.b)([this.store.select(xs.hasQuiz),t]).pipe(Object(I.a)(([e,t])=>!Object(D.isNil)(t)&&e),Object(Ua.a)(1),Object(M.a)(this.ngUnsubscribe)).subscribe(([t,n])=>{const i=this.store.selectSnapshot(xs.getAllQuestions),s=e["ui-quiz"];s&&this.store.dispatch(new ns.SetQuizEnabled(""+s!="false"));const o=""+e["ui-quiz-locked"]=="true",r=n.viewMode===B.Quiz;this.store.dispatch(new ns.SetQuizLocked(o||r)),o&&this.store.dispatch(new ns.SetEnableQuizRetake(!1));const a=parseInt(e["ui-quiz-start"],10),c=parseInt(e["ui-quiz-end"],10),l=i.length,p=isNaN(a)?1:a,d=isNaN(c)?l:c;if(1!==p||d!==l){const e=i.filter((e,t)=>{const n=t+1;return n>=p&&n<=d});this.store.dispatch(new ns.SetQuestions(e))}const u=isNaN(a)&&isNaN(c)?"all":"restricted";this.store.dispatch(new ns.SetQuizQuestionsMode(u)),(o||r)&&setTimeout(()=>{this.quizService.startQuiz()})})}initInteractions(){const e=this.getCanvasInteraction(),t=this.actions.pipe(Object(d.j)(Ii.UpdateNodeSelected,Ii.UpdateNodesChecked,Ii.UpdateNodesShown,Ii.UpdateNodesPickable,Ii.UpdateNodesPaint),Object(I.a)(e=>void 0!==e.objectId||void 0!==e.objectIds)),n=this.store.select(Or.getSelectedChapter).pipe(Object(I.a)(e=>e&&e.readyState.model),Object(M.a)(this.ngUnsubscribe)),i=this.engineService.getCanvas();Object(gj.a)([n,this.getIntersectionObserver(i,.75)]).pipe(Object(Ua.a)(1)).subscribe(()=>{this.store.dispatch(new _j)}),Object(Do.a)(e,t).pipe(Object(_S.a)(n),Object(El.a)(125)).subscribe(()=>{this.store.dispatch(new jj)})}initBackgroundFromWidget({background:e}){e&&(this.setWidgetTransparent(gi.isTransparent(e)),this.actions.pipe(Object(d.i)(Mn),Object(Ua.a)(1),Object(M.a)(this.ngUnsubscribe)).subscribe(()=>{this.store.dispatch(new Qn(e))}))}initBackgroundFromChapter(){this.store.select(Or.getSelectedChapter).pipe(Object(I.a)(e=>null!=e),Object(F.a)(e=>gi.isTransparent(e.background)),Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.setWidgetTransparent(e)})}initCamera({camera:e}){e&&this.actions.pipe(Object(d.j)(Ce),Object(Ua.a)(1),Object(M.a)(this.ngUnsubscribe)).subscribe(()=>{this.store.dispatch(new Zt(e,!1))})}initRotation({"load-rotate":e}){if(e){let t=performance.now();Object(hj.a)(0,bj.a).pipe(Object(F.a)(()=>e*(performance.now()-t)*.001),Object(vn.a)(()=>t=performance.now()),Object(M.a)(this.isFirstInteractionLogged$.pipe(Object(I.a)(e=>!0===e))),Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.cameraService.rotateCameraStatic(0,e)}),this.isFirstInteractionLogged$.pipe(Object(I.a)(e=>!0===e),Object(M.a)(this.ngUnsubscribe)).subscribe(()=>{const e=this.store.selectSnapshot(Or.getSelectedChapter),t=Object(D.get)(e,"camera.location");t&&this.store.dispatch(new Zt(t,!0,2))})}}initHumanReadyListener(){this.actions.pipe(Object(d.j)(c.platform===a.SDK?Te:ze)).pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(()=>{this.engineService.fireEvent(At.Started,null)})}initChaptersReadyListener(){this.store.select(Or.getAllChaptersModelsReady).pipe(Object(I.a)(e=>!0===e),Object(M.a)(this.ngUnsubscribe)).subscribe(()=>{this.store.dispatch(new ze),this.engineService.fireEvent(At.TimelineChaptersActivated,{oldChapterIndex:0,newChapterIndex:0,time:0})})}initDynamicLayout(){Object(Ta.b)([this.store.select(_.getWidgetApiUIConfig),this.store.select(_.getWidgetUrlConfig),this.store.select(Or.getSelectedChapter),this.store.select(xs.getQuizModeActive),this.store.select(xs.getActiveQuestion)]).pipe(Object(I.a)(([e,t,n])=>null!=n&&null!=t),Object(M.a)(this.ngUnsubscribe)).subscribe(([e,t,n,i,s])=>{const o=Jc(t),r=function(e){if(!e||!e.config)return null;const t=new qc;return t[Xa.Column]=e.config.info,t[Xa.Drawer]=e.config.info,t[Xa.Fullscreen]=e.config.fullscreen,t[Xa.Search]=e.config.objectTree,t[Xa.Camera]=e.config.nav,t[Xa.Loader]=Zc(e.config.loader),t[Xa.Whiteboard]=e.config.whiteboard,t[Xa.VisibilityLayers]=e.config.visibilityLayers,t[Xa.ContextActions]=e.config.contextActions,t[Xa.Media]=Gc(e.config.playPause,e.config.scrubber,e.config.mediaControls),t}(n.ui),a=function(){const e=new qc;return e.search=!1,e.pagination=!1,e.labelList=!1,e.labels=!1,e.anatomyLabels=!1,e.nodeInfo=!1,e.toggleLabels=!1,e.legend=!1,e}();this.viewService.setUI({apiUIConfig:e,urlUIConfig:o,chapterUIConfig:r,quizUIConfig:i?a:null})})}handleContentErrors(){this.store.dispatch(new ve(null,null)),this.errorService.redirectToErrorPage(mj.Content)}handleAuthErrors(e){c.deploy!==r.Local&&this.errorService.redirectToErrorPage(fj.Auth,e.response.errorCode)}getCanvasInteraction(){let e;return new P.a(t=>{const n=this.engineService.getCanvas();e=new Nl.Manager(n),e.add([new Nl.Tap({event:"singletap"}),new Nl.Tap({event:"doubletap",taps:2}),new Nl.Pan({event:"pan",direction:Nl.DIRECTION_ALL,threshold:0})]);const i=(()=>t.next()).bind(this);e.on("panstart",i),e.on("singletap",i)}).pipe(Object(Mr.a)(()=>{e&&(e.destroy(),e=null)}),Object(M.a)(this.ngUnsubscribe))}getIntersectionObserver(e,t){return new P.a(n=>{const i=new IntersectionObserver(s=>{s[0].intersectionRatio>=t&&(n.next(e),n.complete(),i.unobserve(e))},{root:null,threshold:t});i.observe(e)})}setWidgetTransparent(e){e?this.renderer.setStyle(document.body,"background","none transparent"):this.renderer.removeStyle(document.body,"background")}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.g),i.Pb(d.b),i.Pb(T.a),i.Pb(eP),i.Pb(tP),i.Pb(Qt),i.Pb(yn),i.Pb(ar),i.Pb(i.H),i.Pb(Dl),i.Pb(Ag))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-widget-master"]],decls:5,vars:3,consts:[[1,"widget","theme-light"],[1,"widget__messages","pt-2","pr-2","pl-2"],["appShowIE11",""],["class","widget-shell",4,"appFlagApplication","appFlagApplicationPlatform","appFlagApplicationMode"],[1,"widget-shell"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Qb(1,"router-outlet"),i.Vb(2,"div",1),i.Qb(3,"app-ie-warning",2),i.Ub(),i.Ub(),i.Ic(4,pP,1,0,"div",3)),2&e&&(i.Db(4),i.lc("appFlagApplication",t.environmentApplication.All)("appFlagApplicationPlatform",t.environmentPlatform.SDK)("appFlagApplicationMode","exclude"))},directives:[T.g,rP,aP,bd],styles:[".widget__messages[_ngcontent-%COMP%]{display:flex;flex-direction:column;z-index:101}.widget-shell[_ngcontent-%COMP%], .widget__messages[_ngcontent-%COMP%]{position:fixed;top:0;left:0;right:0}.widget-shell[_ngcontent-%COMP%]{pointer-events:none;bottom:0;z-index:99999;border:1px solid #eaeff5}"]}),cP([Object(d.d)(_.getBypassAnalytics),lP("design:type",P.a)],e.prototype,"bypassAnalytics$",void 0),cP([Object(d.d)(Bj.isFirstInteractionLogged),lP("design:type",P.a)],e.prototype,"isFirstInteractionLogged$",void 0),e})(),resolve:{widgetUrlConfig:uj},children:[{path:"",component:dj},{path:"error",component:(()=>{class e{constructor(e,t){this.route=e,this.snackBar=t,this.supportURL="https://support.biodigital.com",this.isSceneJSError=!1,this.viewSceneJSErrorDetails=!1}handleSeeDetailsClick(){this.viewSceneJSErrorDetails=!0}buildSceneJSErrorReport(e,t){return{contentId:e,error:JSON.parse(atob(t)),webglInfo:window.SceneJS.WEBGL_INFO}}get title(){return this.errorConfig.title}get description(){return this.errorConfig.description}ngOnInit(){const{errorType:e,errorCode:t,errorBlob:n,errorUrl:i}=this.route.snapshot.queryParams;if(e===mj.SceneJS){this.isSceneJSError=!0;const e=this.buildSceneJSErrorReport(i,n);this.sceneJSErrorTeaser=e.error.errorName,this.sceneJSErrorReport=JSON.stringify(e,null,2)}else this.errorConfig=e===mj.Content?dP:gP[t]||uP}handleDownloadClick(){Object(Rs.saveAs)(new Blob([this.sceneJSErrorReport],{type:"text/plain"}),"BioDigital_Error_Report.txt")}handleActionClick(e){window.open(e)||this.snackBar.open("Unable to open link in new window, please check your pop-up settings.")}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(T.a),i.Pb(id.b))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-error-page"]],decls:4,vars:2,consts:[[1,"error"],[4,"ngIf","ngIfElse"],["notSceneJSError",""],[1,"text-24","text-bold"],[1,"text-16","mt-4","mb-8"],[1,"text-semibold"],[1,"text-16","mb-4"],[1,"text-16"],[1,"mv-4"],["app-button","","buttonType","outline","buttonTheme","light",3,"click"],[1,"mt-8"],["app-button","","buttonType","outline","buttonTheme","light","buttonSize","xsmall",3,"click",4,"ngIf"],["class","error__details mt-2",3,"value",4,"ngIf"],["app-button","","buttonType","outline","buttonTheme","light","buttonSize","xsmall",3,"click"],[1,"error__details","mt-2",3,"value"],[1,"flex","items-start","mt-10"],[1,"error__description","text-16","mt-8",3,"innerHTML"]],template:function(e,t){if(1&e&&(i.Vb(0,"div",0),i.Ic(1,mP,22,3,"div",1),i.Ic(2,fP,7,2,"ng-template",null,2,i.Jc),i.Ub()),2&e){const e=i.tc(3);i.Db(1),i.lc("ngIf",t.isSceneJSError)("ngIfElse",e)}},directives:[Z.l,ud],styles:[".error[_ngcontent-%COMP%]{margin:0 auto;max-width:640px;display:flex;flex-direction:column;padding:40px;color:#283853}.error[_ngcontent-%COMP%]   ol[_ngcontent-%COMP%]{list-style:decimal}.error__details[_ngcontent-%COMP%]{width:100%;height:200px}.error__description[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .error__description[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:visited{color:#283853}"],changeDetection:0}),e})()}]}],xP=!0===c.offline?T.f.forRoot(yP,{useHash:!0}):T.f.forRoot(yP);let vP=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},providers:[uj],imports:[[xP],T.f]}),e})();var OP=n("f6nW"),wP=n("FvrZ"),CP=n("bSwM"),SP=n("FKr1"),_P=n("bTqV"),jP=n("d3UM"),kP=n("/t3+"),PP=n("jaxi"),MP=n("XhcP"),IP=n("bv9b");const zP={disabled:!0,animation:{enterDuration:0,exitDuration:0}},TP=Object.assign(Object.assign({},Object(ru.b)()),{touchGestures:"off"});let UP=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},providers:[{provide:id.a,useValue:{duration:3e3}},{provide:SP.d,useValue:zP},{provide:ru.a,useValue:TP}],imports:[[So.b,OP.a,CP.a,CP.a,_P.b,Fh.c,jP.a,gd.c,kP.a,PP.a,nl.f,ru.d,id.c,md.b,MP.a,Lv.g,QO.f,qO.f],So.b,OP.a,wP.a,CP.a,CP.a,_P.b,Fh.c,jP.a,gd.c,kP.a,PP.a,nl.f,ru.d,id.c,md.b,MP.a,Lv.g,QO.f,qO.f,IP.a]}),e})();var DP=n("R9Cn");let LP=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[Z.c]]}),e})(),EP=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[UP,Du.j,Z.c,LP]]}),e})(),FP=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[Z.c,Du.j]]}),e})();class AP{}var RP=function(e){return e.WoltersKluwer="wolters_kluwer",e}({});const VP={[RP.WoltersKluwer]:"https://tools.ovid.com/support/index_inner.html"};function NP(){return window}let BP=(()=>{class e{constructor(e){if(!e.accountUrl)throw new Error("Missing accountUrl. Please set in app config via ZendeskWidgetProvider");this.window=NP();let t=this.window;t.zEmbed||function(n,i){var s,o,r,a,c=[],l=document.createElement("iframe");t.zEmbed=function(){c.push(arguments)},t.zE=t.zE||t.zEmbed,l.src="javascript:false",l.title="",l.style.cssText="display: none",(r=(r=document.getElementsByTagName("script"))[r.length-1]).parentNode.insertBefore(l,r),a=l.contentWindow.document;try{o=a}catch(n){s=document.domain,l.src='javascript:var d=document.open();d.domain="'+s+'";void(0);',o=a}o.open()._l=function(){var t=this.createElement("script");s&&(this.domain=s),t.id="js-iframe-async",t.src="https://assets.zendesk.com/embeddable_framework/main.js",this.t=+new Date,this.zendeskHost=e.accountUrl,this.zEQueue=c,this.body.appendChild(t)},o.write('<body onload="document._l();">'),o.close()}(),this.window.zE(()=>{e.beforePageLoad(this.window.zE)})}setLocale(e){this.window.zE(()=>{this.window.zE.setLocale(e)})}identify(e){this.window.zE(()=>{Object(D.isNil)(e)?this.window.zE("webWidget","clear"):this.window.zE.identify({name:this.getUserFullName(e),email:e.email})})}hide(){this.window.zE(()=>{this.window.zE.hide()})}show(){this.window.zE(()=>{this.window.zE.show()})}activate(e){this.window.zE(()=>{this.window.zE.activate(e)})}showWidget(e="help"){this.hide(),this.setSettings({webWidget:{helpCenter:{suppress:"contact"===e}}}),this.activate({hideOnClose:!0})}setHelpCenterSuggestions(e){this.window.zE(()=>{this.window.zE.setHelpCenterSuggestions(e)})}setSettings(e){this.window.zE(()=>{this.window.zE("webWidget","updateSettings",e)})}updateFromProfile(e){const t=[];if(null!=e){const{premium_account:n,premium_account_type:i,developer_account:s,subscription:o}=e;n?(t.push("premium_account_"+i),o&&t.push("subscription_"+o.subscription_provider)):t.push("free_account"),s&&t.push("developer_account")}const n=function(e){var t,n;return!(null===(n=null===(t=null==e?void 0:e.organizations[0])||void 0===t?void 0:t.external_account)||void 0===n?void 0:n.is_external_account)&&function(e){return!0===(null==e?void 0:e.premium_account_valid)||"group"===(null==e?void 0:e.premium_account_type)}(e)}(e);this.setSettings({webWidget:{position:{horizontal:"right",vertical:"bottom"},offset:{horizontal:"0px",vertical:"0px"},contactForm:{suppress:!n,tags:t,fields:[{id:"name",prefill:{"*":this.getUserFullName(e)}}]}}})}getUserFullName(e){if(e){const{first_name:t,last_name:n}=e;return`${t} ${n}`}return""}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(AP))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),HP=(()=>{class e{static forRoot(t){return{ngModule:e,providers:[{provide:t,useClass:t},{provide:BP,useClass:BP,deps:[t]}]}}}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[Z.c]]}),e})();class QP extends AP{constructor(){super(...arguments),this.accountUrl="biodigital.zendesk.com"}beforePageLoad(e){e.setLocale("en"),e.hide()}}let $P=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[HP.forRoot(QP)]]}),e})(),qP=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[Z.c,LP,UP]]}),e})(),WP=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[Z.c]]}),e})(),KP=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[Z.c,WP,UP,qP,LP,U.d]]}),e})(),GP=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[Z.c,LP,UP,qP,KP,WP,U.d]]}),e})(),ZP=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[Z.c]]}),e})(),JP=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[Z.c,Vg.b,UP,ZP,WP]]}),e})(),XP=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[Z.c]]}),e})(),YP=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[Z.c]]}),e})(),eM=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[Z.c,qP,UP,U.d]]}),e})(),tM=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[Z.c]]}),e})(),nM=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[Z.c,ZP]]}),e})(),iM=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[Z.c,LP]]}),e})(),sM=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[Z.c,LP]]}),e})(),oM=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[Z.c,EP,LP]]}),e})(),rM=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[T.f,qP,JP,DP.a,nM,Z.c,WP,LP,XP,EP,UP,iM,KP,eM,YP,ZP,Du.r,FP,tM,sM,GP,$P,Pd.a.forChild()],qP,JP,nM,WP,XP,LP,EP,iM,KP,YP,eM,oM,ZP,FP,tM,sM,GP]}),e})();class aM{}let cM=(()=>{class e{constructor(e){this.widgetURL=e}}return e.type="[Publish] Set Widget URL",e})(),lM=(()=>{class e{constructor(e){this.dimensions=e}}return e.type="[Publish] Set Dimensions",e})(),pM=(()=>{class e{constructor(e,t,n){this.model=e,this.widgetOptions=t,this.camera=n}}return e.type="[Publish] Get iFrame",e})(),dM=(()=>{class e{constructor(e){this.embed=e}}return e.type="[Publish] Get iFrame Success",e})(),uM=(()=>{class e{constructor(){}}return e.type="[Publish] Get iFrame Fail",e})(),gM=(()=>{class e{constructor(e,t,n){this.model=e,this.widgetOptions=t,this.camera=n}}return e.type="[Publish] Get URL",e})(),hM=(()=>{class e{constructor(e,t){this.model=e,this.url=t}}return e.type="[Publish] Get URL Success",e})(),bM=(()=>{class e{constructor(e){this.model=e}}return e.type="[Publish] Get URL Fail",e})(),mM=(()=>{class e{constructor(e){this.publishing=e}}return e.type="[Publish] Set Publishing",e})(),fM=(()=>{class e{constructor(){}}return e.type="[Publish] Reset Publishing",e})(),yM=(()=>{class e{constructor(e,t="jpeg"){this.imageData=e,this.imageType=t}}return e.type="[Publish] Save Publish Image",e})(),xM=(()=>{class e{constructor(e){this.imageURL=e}}return e.type="[Publish] Save Publish Image Success",e})(),vM=(()=>{class e{constructor(){}}return e.type="[Publish] Save Publish Image Fail",e})(),OM=(()=>{class e{constructor(e,t,n,i,s){this.model=e,this.imageData=t,this.fileType=n,this.widgetOptions=i,this.camera=s}}return e.type="[Publish] Get Publish Image Code",e})(),wM=(()=>{class e{constructor(e){this.embed=e}}return e.type="[Publish] Get Publish Image Code Success",e})(),CM=(()=>{class e{constructor(){}}return e.type="[Publish] Get Publish Image Code Fail",e})();class SM{}var _M=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},jM=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const kM={creating:!1,updating:!1,loadingCollections:!1,addingCollection:!1,reorderingCollections:!1,removingCollection:!1,updatingCollection:!1,collectionRenaming:null};let PM=(()=>{let e=class{constructor(e,t,n,i){this.organizationsService=e,this.publishService=t,this.pendoService=n,this.productService=i}static getOrganizations(e){return e.organizations}static getOrganization(e){return e.organization}static getOrganizationLogo(e){return e.organization?e.organization.group_logos.default:""}static getSelectedOrganization(e){return e.selectedOrganization}static getSelectedOrganizationProductAccountId(e){return Object(D.get)(e,"organization.product_acctid")}static getOrganizationProfile(e){return e.organizationProfile}static getOrganizationAccountSettings(e){return Object(D.get)(e,"organization.group_attributes",[]).filter(e=>"account_settings"===e.type).map(e=>{const{name:t,value:n}=e;return{[t]:{value:n}}})}static getCollections(e){return e.collections}static getSelectedCollection(e){return e.selectedCollection}static getReorderingCollections(e){return e.reorderingCollections}static getAddingCollection(e){return e.addingCollection}static getRemovingCollection(e){return e.removingCollection}static getUpdatingCollection(e){return e.updatingCollection}static getCollectionRenaming(e){return e.collectionRenaming}static getWidgetURL(e){return e.widgetURL}static getWidgetOptions(e){return e.widgetOptions}static getAppFeatures(e){return e.appFeatures}static getCreating(e){return e.creating}static getUpdating(e){return e.updating}static getCollectionsLoading(e){return e.loadingCollections}static hasOrganization(e){return!Object(D.isNil)(e.organization)}static isTrial(e){return Object(D.get)(e,"organization.subscription.type","").includes("Trial")}static isTrialExpired(e){return!0===Object(D.get)(e,"organization.subscription.expired",!1)}static getSubscriptionEndDate(e){const t=Object(D.get)(e,"organization.subscription.paid_through_date_time");return Object(D.isNil)(t)?void 0:new Date(t)}static getExternalAccount({organization:e}){return null==e?void 0:e.external_account}selectOrganization(e,t){const n=t.organization;e.patchState({selectedOrganization:n,selectedCollection:null}),n&&e.dispatch(new wf(n.id))}setOrganizations(e,t){const n=t.organizations||[],i=n[0];let s,o=null,r=Object.assign({},e.getState().appFeatures);if(i&&i.group_attributes){const e=i.group_attributes,t=this.organizationsService.getOrganizationAttribute(e,"widget_settings","widget_custom_url_path");t&&t.value&&(s=t.value);const n=this.organizationsService.getOrganizationAttribute(e,"widget_settings","widget_url_params");n&&n.value&&(o=this.publishService.extendWidgetOptions(new Yw,n.value));const a=this.organizationsService.getOrganizationAttribute(e,"app_settings","web_app_features");a&&(r=Object.assign(Object.assign({},r),a.value))}e.patchState({organization:i,organizations:n,widgetURL:s,widgetOptions:o,appFeatures:r}),e.dispatch(new cM(s))}getCollections(e,t){e.patchState({loadingCollections:!0}),this.organizationsService.getCollections({group_id:t.organizationId}).pipe(Object(Mr.a)(()=>e.patchState({loadingCollections:!1}))).subscribe(t=>{e.dispatch(new Cf(t))})}getCollectionsSuccess(e,t){e.patchState({collections:t.collections})}selectCollection(e,t){const{organization:n,selectedOrganization:i}=e.getState();e.patchState({selectedOrganization:i||n,selectedCollection:t.collection})}addCollection(e,t){e.patchState({addingCollection:!0}),this.organizationsService.addCollection(t.organizationId,t.collectionName).pipe(Object(Mr.a)(()=>{e.patchState({addingCollection:!1})})).subscribe(()=>{e.dispatch(new _f(t.organizationId,t.collectionName))},t=>{e.dispatch(new jf(t))})}addCollectionSuccess(e,t){this.pendoService.track("Add Collection - Success",{platform:this.productService.productType})}addCollectionError(e,t){this.pendoService.track("Add Collection - Failure",{error:Object(D.get)(t,"error.error.error.message")||"There was an error with collection creation."})}removeCollection(e,t){e.patchState({removingCollection:!0}),this.organizationsService.removeCollection(t.collection).pipe(Object(Mr.a)(()=>{e.patchState({removingCollection:!1})})).subscribe(()=>{e.dispatch(new Pf(t.collection))},t=>{e.dispatch(new Mf(t))})}removeCollectionSuccess(e,t){this.pendoService.track("Remove Collection - Success",{platform:this.productService.productType})}removeCollectionError(e,t){this.pendoService.track("Remove Collection - Failure",{error:Object(D.get)(t,"error.error.error.message")||"There was an error with collection removal."})}setCollectionRenameMode(e,t){e.patchState({collectionRenaming:t.collection})}renameCollection(e,t){e.patchState({updatingCollection:!0}),this.organizationsService.renameCollection(t.collection,t.collectionName).pipe(Object(Mr.a)(()=>{e.patchState({updatingCollection:!1})})).subscribe(()=>{e.dispatch(new Tf(t.collection,t.collectionName))},t=>{e.dispatch(new Uf(t))})}renameCollectionSuccess(e,t){this.pendoService.track("Rename Collection - Success",{platform:this.productService.productType})}renameCollectionError(e,t){this.pendoService.track("Rename Collection - Failure",{error:Object(D.get)(t,"error.error.error.message")||"There was an error with collection renaming."})}reorderCollections(e,t){e.patchState({reorderingCollections:!0}),this.organizationsService.reorderCollections(t.organizationId,t.collections).pipe(Object(Mr.a)(()=>{e.patchState({reorderingCollections:!1})})).subscribe(()=>{e.dispatch(new Lf(t.organizationId,t.collections))},t=>{e.dispatch(new Ef(t))})}reorderCollectionsSuccess(e,t){e.patchState({collections:[...t.collections]})}resetOrganizations(e,t){e.setState(kM)}createOrganization(e,{organization:t}){e.patchState({creating:!0}),this.organizationsService.createOrganization(t).pipe(Object(Mr.a)(()=>e.patchState({creating:!1}))).subscribe(()=>e.dispatch(new Rf),t=>e.dispatch(new Vf(t)))}createOrganizationSuccess(e){this.pendoService.track("Team Creation - Success",{platform:this.productService.productType})}createOrganizationFail(e,t){this.pendoService.track("Team Creation - Failure",{error:Object(D.get)(t,"error.error.error.message")||"There was an error with team creation."})}updateOrganization(e,{organization:t}){e.patchState({updating:!0}),this.organizationsService.updateOrganization(t).pipe(Object(Mr.a)(()=>e.patchState({updating:!1}))).subscribe(()=>e.dispatch(new Bf),t=>e.dispatch(new Hf(t)))}getOrganizationProfile(e,{request:t}){e.patchState({updating:!0}),this.organizationsService.getPublicProfile(t).pipe().subscribe(t=>e.dispatch(new $f(t)),t=>e.dispatch(new qf(t)))}getOrganizationProfileSuccess(e,{organizationProfile:t}){e.patchState({organizationProfile:t})}clearOrganizationProfile(e,t){e.patchState({organizationProfile:void 0})}};return e.\u0275fac=function(t){return new(t||e)(i.Zb(W),i.Zb(dC),i.Zb(G),i.Zb(mf))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac}),_M([Object(d.a)(vf),jM("design:type",Function),jM("design:paramtypes",[Object,vf]),jM("design:returntype",void 0)],e.prototype,"selectOrganization",null),_M([Object(d.a)(xf),jM("design:type",Function),jM("design:paramtypes",[Object,xf]),jM("design:returntype",void 0)],e.prototype,"setOrganizations",null),_M([Object(d.a)(wf),jM("design:type",Function),jM("design:paramtypes",[Object,wf]),jM("design:returntype",void 0)],e.prototype,"getCollections",null),_M([Object(d.a)(Cf),jM("design:type",Function),jM("design:paramtypes",[Object,Cf]),jM("design:returntype",void 0)],e.prototype,"getCollectionsSuccess",null),_M([Object(d.a)(Of),jM("design:type",Function),jM("design:paramtypes",[Object,Of]),jM("design:returntype",void 0)],e.prototype,"selectCollection",null),_M([Object(d.a)(Sf),jM("design:type",Function),jM("design:paramtypes",[Object,Sf]),jM("design:returntype",void 0)],e.prototype,"addCollection",null),_M([Object(d.a)(_f),jM("design:type",Function),jM("design:paramtypes",[Object,_f]),jM("design:returntype",void 0)],e.prototype,"addCollectionSuccess",null),_M([Object(d.a)(jf),jM("design:type",Function),jM("design:paramtypes",[Object,jf]),jM("design:returntype",void 0)],e.prototype,"addCollectionError",null),_M([Object(d.a)(kf),jM("design:type",Function),jM("design:paramtypes",[Object,kf]),jM("design:returntype",void 0)],e.prototype,"removeCollection",null),_M([Object(d.a)(Pf),jM("design:type",Function),jM("design:paramtypes",[Object,Pf]),jM("design:returntype",void 0)],e.prototype,"removeCollectionSuccess",null),_M([Object(d.a)(Mf),jM("design:type",Function),jM("design:paramtypes",[Object,Mf]),jM("design:returntype",void 0)],e.prototype,"removeCollectionError",null),_M([Object(d.a)(If),jM("design:type",Function),jM("design:paramtypes",[Object,If]),jM("design:returntype",void 0)],e.prototype,"setCollectionRenameMode",null),_M([Object(d.a)(zf),jM("design:type",Function),jM("design:paramtypes",[Object,zf]),jM("design:returntype",void 0)],e.prototype,"renameCollection",null),_M([Object(d.a)(Tf),jM("design:type",Function),jM("design:paramtypes",[Object,Tf]),jM("design:returntype",void 0)],e.prototype,"renameCollectionSuccess",null),_M([Object(d.a)(Uf),jM("design:type",Function),jM("design:paramtypes",[Object,Uf]),jM("design:returntype",void 0)],e.prototype,"renameCollectionError",null),_M([Object(d.a)(Df),jM("design:type",Function),jM("design:paramtypes",[Object,Df]),jM("design:returntype",void 0)],e.prototype,"reorderCollections",null),_M([Object(d.a)(Lf),jM("design:type",Function),jM("design:paramtypes",[Object,Lf]),jM("design:returntype",void 0)],e.prototype,"reorderCollectionsSuccess",null),_M([Object(d.a)(Ff),jM("design:type",Function),jM("design:paramtypes",[Object,Ff]),jM("design:returntype",void 0)],e.prototype,"resetOrganizations",null),_M([Object(d.a)(Af),jM("design:type",Function),jM("design:paramtypes",[Object,Af]),jM("design:returntype",void 0)],e.prototype,"createOrganization",null),_M([Object(d.a)(Rf),jM("design:type",Function),jM("design:paramtypes",[Object]),jM("design:returntype",void 0)],e.prototype,"createOrganizationSuccess",null),_M([Object(d.a)(Vf),jM("design:type",Function),jM("design:paramtypes",[Object,Vf]),jM("design:returntype",void 0)],e.prototype,"createOrganizationFail",null),_M([Object(d.a)(Nf),jM("design:type",Function),jM("design:paramtypes",[Object,Nf]),jM("design:returntype",void 0)],e.prototype,"updateOrganization",null),_M([Object(d.a)(Qf),jM("design:type",Function),jM("design:paramtypes",[Object,Qf]),jM("design:returntype",void 0)],e.prototype,"getOrganizationProfile",null),_M([Object(d.a)($f),jM("design:type",Function),jM("design:paramtypes",[Object,$f]),jM("design:returntype",void 0)],e.prototype,"getOrganizationProfileSuccess",null),_M([Object(d.a)(Wf),jM("design:type",Function),jM("design:paramtypes",[Object,Wf]),jM("design:returntype",void 0)],e.prototype,"clearOrganizationProfile",null),_M([Object(d.e)(),jM("design:type",Function),jM("design:paramtypes",[SM]),jM("design:returntype",void 0)],e,"getOrganizations",null),_M([Object(d.e)(),jM("design:type",Function),jM("design:paramtypes",[SM]),jM("design:returntype",void 0)],e,"getOrganization",null),_M([Object(d.e)(),jM("design:type",Function),jM("design:paramtypes",[SM]),jM("design:returntype",String)],e,"getOrganizationLogo",null),_M([Object(d.e)(),jM("design:type",Function),jM("design:paramtypes",[SM]),jM("design:returntype",void 0)],e,"getSelectedOrganization",null),_M([Object(d.e)(),jM("design:type",Function),jM("design:paramtypes",[SM]),jM("design:returntype",String)],e,"getSelectedOrganizationProductAccountId",null),_M([Object(d.e)(),jM("design:type",Function),jM("design:paramtypes",[SM]),jM("design:returntype",void 0)],e,"getOrganizationProfile",null),_M([Object(d.e)(),jM("design:type",Function),jM("design:paramtypes",[SM]),jM("design:returntype",Array)],e,"getOrganizationAccountSettings",null),_M([Object(d.e)(),jM("design:type",Function),jM("design:paramtypes",[SM]),jM("design:returntype",void 0)],e,"getCollections",null),_M([Object(d.e)(),jM("design:type",Function),jM("design:paramtypes",[SM]),jM("design:returntype",void 0)],e,"getSelectedCollection",null),_M([Object(d.e)(),jM("design:type",Function),jM("design:paramtypes",[SM]),jM("design:returntype",void 0)],e,"getReorderingCollections",null),_M([Object(d.e)(),jM("design:type",Function),jM("design:paramtypes",[SM]),jM("design:returntype",void 0)],e,"getAddingCollection",null),_M([Object(d.e)(),jM("design:type",Function),jM("design:paramtypes",[SM]),jM("design:returntype",void 0)],e,"getRemovingCollection",null),_M([Object(d.e)(),jM("design:type",Function),jM("design:paramtypes",[SM]),jM("design:returntype",void 0)],e,"getUpdatingCollection",null),_M([Object(d.e)(),jM("design:type",Function),jM("design:paramtypes",[SM]),jM("design:returntype",void 0)],e,"getCollectionRenaming",null),_M([Object(d.e)(),jM("design:type",Function),jM("design:paramtypes",[SM]),jM("design:returntype",void 0)],e,"getWidgetURL",null),_M([Object(d.e)(),jM("design:type",Function),jM("design:paramtypes",[SM]),jM("design:returntype",void 0)],e,"getWidgetOptions",null),_M([Object(d.e)(),jM("design:type",Function),jM("design:paramtypes",[SM]),jM("design:returntype",void 0)],e,"getAppFeatures",null),_M([Object(d.e)(),jM("design:type",Function),jM("design:paramtypes",[SM]),jM("design:returntype",void 0)],e,"getCreating",null),_M([Object(d.e)(),jM("design:type",Function),jM("design:paramtypes",[SM]),jM("design:returntype",void 0)],e,"getUpdating",null),_M([Object(d.e)(),jM("design:type",Function),jM("design:paramtypes",[SM]),jM("design:returntype",void 0)],e,"getCollectionsLoading",null),_M([Object(d.e)(),jM("design:type",Function),jM("design:paramtypes",[SM]),jM("design:returntype",void 0)],e,"hasOrganization",null),_M([Object(d.e)(),jM("design:type",Function),jM("design:paramtypes",[SM]),jM("design:returntype",void 0)],e,"isTrial",null),_M([Object(d.e)(),jM("design:type",Function),jM("design:paramtypes",[SM]),jM("design:returntype",void 0)],e,"isTrialExpired",null),_M([Object(d.e)(),jM("design:type",Function),jM("design:paramtypes",[SM]),jM("design:returntype",void 0)],e,"getSubscriptionEndDate",null),_M([Object(d.e)(),jM("design:type",Function),jM("design:paramtypes",[SM]),jM("design:returntype",Object)],e,"getExternalAccount",null),e=_M([Object(d.f)({name:"organizations",defaults:kM})],e),e})();var MM=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},IM=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const zM={publishing:!1,widgetURL:"/viewer",dimensions:eC.dimensions,minDimensions:{width:300,height:400}};let TM=(()=>{let e=class{constructor(e,t,n,i){this.publishService=e,this.store=t,this.snackbar=n,this.pendoService=i}static getDimensions(e){return e.dimensions}static getMinDimensions(e){return e.minDimensions}static getWidgetURL(e){return e.widgetURL}static getPublishing(e){return e.publishing}setPublishWidgetURL(e,t){e.patchState({widgetURL:t.widgetURL||"/viewer"})}setPublishDimensions(e,t){e.patchState({dimensions:t.dimensions})}getPublishURL(e,t){const{model:n,camera:i,widgetOptions:s}=t,{widgetURL:o}=e.getState(),r=this.store.selectSnapshot(py.getUserLanguage),a=this.store.selectSnapshot(py.getSelectedUserApp),c=this.store.selectSnapshot(PM.getSelectedOrganizationProductAccountId);this.publishService.generateWidgetURL(n,o,s,i,aC.Single,r,a,c).subscribe(t=>{e.dispatch(new hM(n,t))},()=>{e.dispatch(new bM(n))})}getPublishURLSuccess(e,t){this.pendoService.track("Publish - Success",{type:"url",source:"publish"})}getPublishURLFail(e,t){this.snackbar.open("Unable to generate URL.")}getPublishIFrame(e,t){const{model:n,camera:i,widgetOptions:s}=t,{widgetURL:o,dimensions:r}=e.getState(),a=this.store.selectSnapshot(py.getUserLanguage),c=this.store.selectSnapshot(py.getSelectedUserApp),l=this.store.selectSnapshot(PM.getSelectedOrganizationProductAccountId);this.publishService.generateWidgetEmbed(n,o,s,r,i,aC.Single,a,c,l).subscribe(t=>{e.dispatch(new dM(t))},()=>{e.dispatch(new uM)})}setPublishIFrameSuccess(e,t){this.pendoService.track("Publish - Success",{type:"iframe",source:"publish"})}savePublishImage(e,{imageData:t,imageType:n}){this.publishService.saveUserImage(t,n).subscribe(t=>{e.dispatch(new xM(t))},()=>{e.dispatch(new vM)})}savePublishImageSuccess(e,t){this.pendoService.track("Publish - Success",{type:"image",source:"publish"})}getPublishImage(e,t){const{model:n,camera:i,widgetOptions:s,imageData:o,fileType:r}=t,{widgetURL:a}=e.getState(),c=this.store.selectSnapshot(py.getUserLanguage),l=this.store.selectSnapshot(py.getSelectedUserApp);Object(Vr.a)(this.publishService.generateWidgetURL(n,a,s,i,aC.Single,c,l),this.publishService.saveUserImage(o,r)).subscribe(([t,i])=>{const s=this.publishService.getImageEmbed(n.title,t,i);e.dispatch(new wM(s))},()=>{e.dispatch(new CM)})}setPublishing(e,{publishing:t}){e.patchState({publishing:t})}resetPublish(e,t){e.setState(zM)}};return e.\u0275fac=function(t){return new(t||e)(i.Zb(dC),i.Zb(d.g),i.Zb(id.b),i.Zb(G))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac}),MM([Object(d.a)(cM),IM("design:type",Function),IM("design:paramtypes",[Object,cM]),IM("design:returntype",void 0)],e.prototype,"setPublishWidgetURL",null),MM([Object(d.a)(lM),IM("design:type",Function),IM("design:paramtypes",[Object,lM]),IM("design:returntype",void 0)],e.prototype,"setPublishDimensions",null),MM([Object(d.a)(gM),IM("design:type",Function),IM("design:paramtypes",[Object,gM]),IM("design:returntype",void 0)],e.prototype,"getPublishURL",null),MM([Object(d.a)(hM),IM("design:type",Function),IM("design:paramtypes",[Object,hM]),IM("design:returntype",void 0)],e.prototype,"getPublishURLSuccess",null),MM([Object(d.a)(bM),IM("design:type",Function),IM("design:paramtypes",[Object,bM]),IM("design:returntype",void 0)],e.prototype,"getPublishURLFail",null),MM([Object(d.a)(pM),IM("design:type",Function),IM("design:paramtypes",[Object,pM]),IM("design:returntype",void 0)],e.prototype,"getPublishIFrame",null),MM([Object(d.a)(dM),IM("design:type",Function),IM("design:paramtypes",[Object,dM]),IM("design:returntype",void 0)],e.prototype,"setPublishIFrameSuccess",null),MM([Object(d.a)(yM),IM("design:type",Function),IM("design:paramtypes",[Object,yM]),IM("design:returntype",void 0)],e.prototype,"savePublishImage",null),MM([Object(d.a)(xM),IM("design:type",Function),IM("design:paramtypes",[Object,xM]),IM("design:returntype",void 0)],e.prototype,"savePublishImageSuccess",null),MM([Object(d.a)(OM),IM("design:type",Function),IM("design:paramtypes",[Object,OM]),IM("design:returntype",void 0)],e.prototype,"getPublishImage",null),MM([Object(d.a)(mM),IM("design:type",Function),IM("design:paramtypes",[Object,mM]),IM("design:returntype",void 0)],e.prototype,"setPublishing",null),MM([Object(d.a)(fM),IM("design:type",Function),IM("design:paramtypes",[Object,fM]),IM("design:returntype",void 0)],e.prototype,"resetPublish",null),MM([Object(d.e)(),IM("design:type",Function),IM("design:paramtypes",[aM]),IM("design:returntype",void 0)],e,"getDimensions",null),MM([Object(d.e)(),IM("design:type",Function),IM("design:paramtypes",[aM]),IM("design:returntype",void 0)],e,"getMinDimensions",null),MM([Object(d.e)(),IM("design:type",Function),IM("design:paramtypes",[aM]),IM("design:returntype",void 0)],e,"getWidgetURL",null),MM([Object(d.e)(),IM("design:type",Function),IM("design:paramtypes",[aM]),IM("design:returntype",void 0)],e,"getPublishing",null),e=MM([Object(d.f)({name:"publish",defaults:zM})],e),e})(),UM=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[Z.c,UP,Du.r,rM,DP.a,d.c.forFeature([TM])]]}),e})(),DM=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[d.c.forFeature([_C]),Z.c,UP,Du.r,rM,T.f,UM,U.d]]}),e})();class LM{}var EM=function(e){return e[e.Query=0]="Query",e[e.Path=1]="Path",e}({}),FM=function(e){return e[e.List=0]="List",e[e.Card=1]="Card",e}({});const AM=c.application===s.Loft?FM.List:FM.Card;var RM=function(e){return e.Success="success",e.Fail="fail",e}({});const VM="cdb/content",NM="cdb/copy/content",BM={headers:new v.d({"Content-Type":"application/json; charset=utf-8"})},HM=["production","client","preview","internal_content","public_preview","demos","social","exports","real_data"];let QM=(()=>{class e{constructor(e,t){this.http=e,this.serializeModuleService=t}saveModule(e,t){t=this.formatModulePath(t);const n=[VM,"modules",t].join("/"),i=this.JSONStringify(e);return this.http.put(n,i,BM).pipe(Object(F.a)(()=>RM.Success),Object(Ls.a)(({status:e})=>e>=200&&e<=202?Object(zs.a)(RM.Success):Object(zs.a)(RM.Fail)))}mergeModule(e,t,n="exception"){return this.http.post("/cdb/merge/modules",{loft:e+".json",bridge:t+".json",merge_option:n})}copyState(e,t){const n=[NM,"states",t].join("/"),i={headers:new v.d({"Content-Type":"application/json; charset=utf-8","source-state":e})};return this.http.put(n,{},i)}listContents(e,t,n,i=!1){const s=this.generateModulePath(e,t||"",n||"");return this.http.get("/cdb/ls/content/modules/"+s).pipe(Object(F.a)(e=>i?e.contents.map(e=>{const t=e.name.replace("/content/modules/","").replace(".json",""),n=e.name.split("/").pop().replace("/content/modules","").replace(".json",""),i=new N;return i.id=t,i.title=n,i.type=o.Module,i}):e.contents))}getState(e){return this.http.get("/cdb/ls/content/states/"+e).pipe(Object(F.a)(e=>e.contents))}getClients(){return this.http.get("/search/client").pipe(Object(F.a)(e=>e.clients))}getUsedStates(){const e={};return Object.values(Human.scene.objects).reduce((t,n)=>(["transformId","morphId","geometryId","materialId"].forEach(t=>{const i=this.getPropertyState(n,t);i.length&&(e[i]=!0)}),n.hasOwnProperty("renderables")&&["morphId","geometryId","materialId"].forEach(t=>{n.renderables.forEach(n=>{const i=this.getPropertyState(n,t);i.length&&(e[i]=!0)})}),t),{}),Object.keys(e)}parseScenePath(e){const t=e.split("/");return 1===t.length?null:{fullPath:"https://qa.biodigital.com/content/modules/"+e,relativePath:t.slice(0,t.length-1).join("/"),sceneName:t[t.length-1]}}formatModulePath(e){let t=e;return/\.json$/.test(e)||(t+=".json"),t}getPrimaryCategories(){return Object(zs.a)(HM)}getSecondaryCategories(e){switch(e){case"production":return Object(zs.a)(["maleAdult","femaleAdult"]);case"client":return this.getClients();default:return Object(zs.a)([])}}generateSaveModule(e){const t=this.parseScenePath(e),n=t.relativePath.split("/");return{id:e,name:t.sceneName,primaryCategory:n[0]||"",secondaryCategory:n[1]||""}}generateModulePath(e,t,n){const i=[];return e.length&&i.push(e),t.length&&i.push(t),n.length&&(n.indexOf(".json")<0&&(n+=".json"),i.push(n)),i.join("/")}getPropertyState(e,t){return null!=e[t]?e[t].split("/")[0]:""}JSONStringify(e){return JSON.stringify(e).replace(/[\u007f-\uffff]/g,e=>"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4))}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(v.b),i.Zb(Sa))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var $M=function(e){return e.Organization="Organization",e.Collection="Collection",e.Private="Private",e.Category="Category",e.Community="Community",e.Internal="Internal",e.Loft="Loft",e}({});class qM{constructor(e="",t,n=25,i=0){this.query=e,this.sortBy=t,this.pageSize=n,this.offset=i}}class WM{}let KM=(()=>{class e{constructor(e){this.store=e}ngOnInit(){}close(){this.store.dispatch(new Zf.ShowFilters(!1,!0))}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.g))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-gallery-drawer"]],decls:8,vars:2,consts:[["appEventFence","","data-test","galleryDrawer",1,"gallery-drawer"],[1,"gallery-drawer__header"],[1,"gallery-drawer__label"],["app-button","","buttonType","ghost","buttonTheme","light","type","button","title","Close","data-test","galleryDrawerClose",3,"click"],["icon","times","size","lg"],[1,"gallery-drawer__body"],["viewMode","expanded"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Vb(1,"div",1),i.Vb(2,"h1",2),i.Kc(3,"Filters"),i.Ub(),i.Vb(4,"button",3),i.cc("click",(function(){return t.close()})),i.Qb(5,"app-icon",4),i.Ub(),i.Ub(),i.Vb(6,"div",5),i.Qb(7,"app-gallery-filters",6),i.Ub(),i.Ub()),2&e&&(i.lc("@expand",void 0),i.Db(4),i.Eb("aria-label","Close"))},styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.gallery-drawer[_ngcontent-%COMP%]{box-shadow:0 11px 15px rgba(0,0,0,.2),0 24px 38px rgba(0,0,0,.14),0 9px 46px rgba(0,0,0,.12);background:#fff;border-radius:16px 16px 0 0;display:block;position:fixed;bottom:0;top:auto;width:100vw}.gallery-drawer__header[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em;font-weight:600;border-bottom:1px solid #eaeff5;height:52px;padding:0 12px 0 20px;display:flex;align-items:center}.gallery-drawer__label[_ngcontent-%COMP%]{flex:1 0 auto}.gallery-drawer__body[_ngcontent-%COMP%]{padding:20px}"],data:{animation:[Object(Zl.n)("expand",[Object(Zl.m)(":enter",[Object(Zl.j)([Object(Zl.l)({top:"100%"}),Object(Zl.e)("250ms ease-in-out",Object(Zl.l)({top:"*"}))])])])]},changeDetection:0}),e})(),GM=(()=>{class e{constructor(e,t){this.overlay=e,this.store=t}openDrawer(){this.overlayRef||this._createOverlay();const e=new qO.c(KM);this.overlayRef.attach(e)}closeDrawer(){this.overlayRef.detach()}_createOverlay(){const e=new QO.d({hasBackdrop:!0,scrollStrategy:this.overlay.scrollStrategies.block()});this.overlayRef=this.overlay.create(e),this.overlayRef.backdropClick().subscribe(()=>{this.store.dispatch(new Zf.ShowFilters(!1,!0))})}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(QO.c),i.Zb(d.g))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const ZM={title:"Tags",tags:["Animated","Tour","Quiz","featured","new"]},JM={title:"Type",tags:["Anatomy","Disease","Pharmacology","Physiology","Procedure"]},XM={title:"Level of Detail",tags:["Gross Anatomy","Tissue","Cellular","Molecular"]},YM={title:"Downloaded",tags:["Downloaded"]},eI=[{title:"Status",tags:["Live","obsolete"]},{title:"Paywall",tags:["Premium","Basic"]},{title:"Platform",tags:["web platform","ios platform","android platform"]},ZM,{title:"Flags",tags:["animated","tour","Audio","low definition"]},{title:"Gender",tags:["male","female"]},JM,XM,{title:"Anatomy Categories",tags:["complete anatomy","system","regional","Bony Landmarks","Cross Section","Cross Section and Micro Anatomy","Micro Anatomy","Origins and Insertions"]},{title:"Clinical Specialty",tags:["Allergy and Immunology","Cardiology","Dentistry","Dermatology","Endocrinology","Gastroenterology and Hepatology","Gynecology","Infectious Disease","Nephrology","Neurology and Psychiatry","Obstetrics","Oncology and Hematology","Ophthalmology","Orthopedics","Otolaryngology","Pediatrics","Physical Therapy","Pulmonology and Respiratory","Rheumatology","Urology"]},{title:"Health Conditions",tags:["Blood, Heart and Circulation","Brain and Nerves","Ear, Nose and Throat","Eyes and Vision","Immune System","Lungs and Breathing","Mouth and Teeth","Bones, Joints and Muscles","Digestive System","Endocrine System","Female Reproductive System","Male Reproductive System","Skin, Hair and Nail"]},YM];class tI{constructor(e,t=[],n=""){this.categoryId=e,this.tags=t,this.query=n,this.type=$M.Category}}class nI{constructor(e="",t=[]){this.query=e,this.tags=t,this.categoryId="public",this.type=$M.Community}}let iI=(()=>{class e{static getOfflineModelIDs(){return e._offlineModelIDs$}static setOfflineModelIDs(t){e._offlineModelIDs.next(t)}static getOfflineModelIDList(){return this._offlineModelIDs.getValue()}static setStore(t){e.store=t}static setSnackBar(t){e.snackBar=t}static setRouter(t){e.router=t}static debug(e){"undefined"!=typeof Human&&void 0!==Human.events&&Human.events.fire(At.NativeDebugMessage,e)}static fire(e,t){Human.events.fire(e,t)}on(e,t){Human.events.on(e,t)}send(t,n){let i=null,s={};switch(t){case Qj.NativeErrorMessage:i=e.snackBar.open(n,"OK",{duration:6e3,verticalPosition:"top"}),i.onAction().subscribe(()=>{i.dismiss()});break;case Qj.NativeSetAppVersion:e.appVersion=n.appVersion;break;case Qj.NativeRedirect:s=JSON.parse(n.queryItems),e.router.navigate([n.url],{queryParams:s});break;case Qj.NativeReload:window.location.href=n.url;break;case Qj.NativeOfflineModelIds:e.setOfflineModelIDs(n.modelIds);break;default:Human.events.fire(At.NativeDebugMessage,"unprocessed HumanWindowAPI send "+t)}}}return e.store=null,e.snackBar=null,e.router=null,e.appVersion="",e._offlineModelIDs=new bl.a([]),e._offlineModelIDs$=e._offlineModelIDs.asObservable(),e})();var sI=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},oI=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const rI={loading:!0,searchMode:EM.Query,viewMode:AM,showFilters:!1,searchResults:{total:0,items:[]},checkedResults:[],searchConfig:null,searchOptions:null,sidenav:{enabled:!0,open:!0,disableClose:!1},bulkActions:{enabled:!0,active:!1,items:[]},cardActions:{enabled:!0}},aI=[...JM.tags,...XM.tags,...ZM.tags];let cI=(()=>{let e=class{constructor(e,t,n,i,s,o){this.organizationsService=e,this.modulesService=t,this.exploreService=n,this.bookmarksService=i,this.galleryService=s,this.store=o}static getLoading(e){return e.loading}static getSearchMode(e){return e.searchMode}static getSearchConfig(e){return e.searchConfig}static getSearchOptions(e){return e.searchOptions}static getAvailableTags(e){const t=[],n=e.searchResults.items,i=c.native?iI.getOfflineModelIDList():[];return n.forEach(e=>{e.tags.forEach(e=>{"quiz"===e&&(e="Quiz"),aI.includes(e)&&!t.includes(e)&&t.push(e)}),c.native&&i.includes(e.id)&&!t.includes("Downloaded")&&t.push("Downloaded")}),t}static getActiveTags(e){const t={};return e.searchConfig.tags.forEach(e=>{const n=eI.find(t=>t.tags.some(t=>t===e)),i=Object(D.get)(n,"title","");t[i]=e}),t}static getActiveTagsCount(e){const t=e.searchConfig;return Object(D.compact)(t.tags).length}static getSearchType(e){return e.searchConfig?e.searchConfig.type:null}static getSearchGroup(e){var t;switch(null===(t=e.searchConfig)||void 0===t?void 0:t.type){case $M.Category:case $M.Community:case $M.Internal:case $M.Loft:return o.Module;case $M.Collection:case $M.Private:case $M.Organization:return o.Bookmark}}static getViewMode(e){return e.viewMode}static getShowFilters(e){return e.showFilters}static getSort(e){return e.searchOptions.sortBy}static getSortOptions(e){switch(e.searchConfig.type){case $M.Loft:return[Kw,Gw];case $M.Category:return[qw,Ww,Kw,Gw];default:return[Ww,Kw,Gw,Zw,Jw]}}static getSidenav(e){return e.sidenav}static getBulkActions(e){return e.bulkActions}static getBulkActionsAvailable(e){const{enabled:t,items:n}=e.bulkActions;return t&&n.length>0}static getBulkActionsActive(e){return e.bulkActions.active}static getCardActions(e){return e.cardActions}static getFilteredResults(e,t){const{searchResults:n,searchOptions:i}=e,{ascending:s,fields:o}=i.sortBy,{offset:r,pageSize:a}=i,c=yC(n.items,o,s).slice(r,r+a);return Object.assign(Object.assign({},n),{items:c})}static getAllResults(e,t){const{searchResults:n,searchOptions:i}=e,{ascending:s,fields:o}=i.sortBy,r=yC(n.items,o,s);return{total:n.total,items:r}}static getCheckedResults(e){return e.checkedResults}setSearchMode(e,t){e.patchState({searchMode:t.searchMode})}setViewMode(e,t){e.patchState({viewMode:t.viewMode})}showFilters(e,t){e.patchState({showFilters:t.show}),t.triggerDrawer&&(t.show?this.galleryService.openDrawer():this.galleryService.closeDrawer())}setSearchOptions(e,t){e.patchState({searchOptions:Object.assign({},t.options)})}setActiveTags(e,t){const n=e.getState().searchConfig,i=Object.assign(Object.assign({},n),{tags:Object(D.flatten)(Object.values(t.activeTags))});this.store.dispatch(new Zf.SetSearchConfig(i))}setSearchConfig(e,t){const n=t.config||e.getState().searchConfig,i=t.options||e.getState().searchOptions;null!==n&&e.patchState({searchOptions:Object.assign({},i),searchConfig:Object.assign({},n)})}searchCategory(e,{categoryId:t}){const n="public"===t?new nI(""):new tI(t);e.dispatch(new Zf.SetSearchConfig(n))}searchStudio(e,t){const{searchConfig:n,searchOptions:i}=e.getState(),s=new qM("",Kw),o=this.store.selectSnapshot(py.getUserLanguage);e.patchState({loading:!0,searchOptions:Object.assign(Object.assign({},i),{pageSize:s.pageSize,offset:s.offset}),checkedResults:[]});let r=new P.a;switch(n.type){case $M.Category:r=this.exploreService.getAnatomyCategory(n.query,"all"===n.categoryId?"":n.categoryId,n.tags.filter(e=>!e.startsWith("Downloaded")),o);break;case $M.Organization:r=this.bookmarksService.getOrganizationContent(n.organizationId,n.query);break;case $M.Collection:r=this.organizationsService.getCollectionContent(n.organizationId,n.collectionId,n.query);break;case $M.Community:r=this.bookmarksService.getPublicBookmarks(n.query);break;case $M.Private:r=this.bookmarksService.getPrivateContent(n.query);break;case $M.Internal:r=this.exploreService.searchInternal(n.query,n.directory);break;case $M.Loft:const e=n.query.indexOf(".json")>0;r=this.modulesService.listContents(n.primary,n.secondary,e?n.query:"",!0).pipe(Object(F.a)(t=>e?t:t.filter(e=>e.title.indexOf(n.query)>=0)))}r.pipe(Object(Mr.a)(()=>e.patchState({loading:!1}))).subscribe(t=>{const i=c.native?iI.getOfflineModelIDList():[],s=n.tags.includes("Downloaded")?t.filter(e=>i.includes(e.id)):t;e.dispatch(new Zf.SearchSuccess(s))})}searchSuccess(e,t){e.patchState({searchResults:{items:t.bookmarks,total:t.bookmarks.length}})}checkItem(e,t){let n=e.getState().checkedResults;const i=n.some(e=>e===t.id);t.checked&&!i?n=[...n,t.id]:t.checked||(n=n.filter(e=>e!==t.id)),e.patchState({checkedResults:n})}checkAll(e,t){const n=e.getState().searchResults.items.map(e=>e.id);e.patchState({checkedResults:n})}uncheckAll(e,t){e.patchState({checkedResults:[]})}setCheckedItems(e,t){e.patchState({checkedResults:t.ids})}setSidenav(e,t){e.patchState({sidenav:Object.assign({},t.sidenav)})}setCardActions(e,t){e.patchState({cardActions:Object.assign({},t.cardActions)})}setBulkActions(e,t){const{bulkActions:n}=e.getState();e.patchState({bulkActions:Object.assign(Object.assign({},n),t.bulkActions)})}clearResults(e,t){e.patchState({searchResults:{items:[],total:0}})}resetGallery(e,t){e.patchState(rI)}};return e.\u0275fac=function(t){return new(t||e)(i.Zb(W),i.Zb(QM),i.Zb(mC),i.Zb($w),i.Zb(GM),i.Zb(d.g))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac}),sI([Object(d.a)(Zf.SetSearchMode),oI("design:type",Function),oI("design:paramtypes",[Object,Zf.SetSearchMode]),oI("design:returntype",void 0)],e.prototype,"setSearchMode",null),sI([Object(d.a)(Zf.SetViewMode),oI("design:type",Function),oI("design:paramtypes",[Object,Zf.SetViewMode]),oI("design:returntype",void 0)],e.prototype,"setViewMode",null),sI([Object(d.a)(Zf.ShowFilters),oI("design:type",Function),oI("design:paramtypes",[Object,Zf.ShowFilters]),oI("design:returntype",void 0)],e.prototype,"showFilters",null),sI([Object(d.a)(Zf.SetSearchOptions),oI("design:type",Function),oI("design:paramtypes",[Object,Zf.SetSearchOptions]),oI("design:returntype",void 0)],e.prototype,"setSearchOptions",null),sI([Object(d.a)(Zf.SetActiveTags),oI("design:type",Function),oI("design:paramtypes",[Object,Zf.SetActiveTags]),oI("design:returntype",void 0)],e.prototype,"setActiveTags",null),sI([Object(d.a)(Zf.SetSearchConfig),oI("design:type",Function),oI("design:paramtypes",[Object,Zf.SetSearchConfig]),oI("design:returntype",void 0)],e.prototype,"setSearchConfig",null),sI([Object(d.a)(Zf.SearchCategory),oI("design:type",Function),oI("design:paramtypes",[Object,Zf.SearchCategory]),oI("design:returntype",void 0)],e.prototype,"searchCategory",null),sI([Object(d.a)(Zf.SearchStudio),oI("design:type",Function),oI("design:paramtypes",[Object,Zf.SearchStudio]),oI("design:returntype",void 0)],e.prototype,"searchStudio",null),sI([Object(d.a)(Zf.SearchSuccess),oI("design:type",Function),oI("design:paramtypes",[Object,Zf.SearchSuccess]),oI("design:returntype",void 0)],e.prototype,"searchSuccess",null),sI([Object(d.a)(Zf.CheckItem),oI("design:type",Function),oI("design:paramtypes",[Object,Zf.CheckItem]),oI("design:returntype",void 0)],e.prototype,"checkItem",null),sI([Object(d.a)(Zf.CheckAll),oI("design:type",Function),oI("design:paramtypes",[Object,Zf.CheckAll]),oI("design:returntype",void 0)],e.prototype,"checkAll",null),sI([Object(d.a)(Zf.UncheckAll),oI("design:type",Function),oI("design:paramtypes",[Object,Zf.UncheckAll]),oI("design:returntype",void 0)],e.prototype,"uncheckAll",null),sI([Object(d.a)(Zf.SetCheckedItems),oI("design:type",Function),oI("design:paramtypes",[Object,Zf.SetCheckedItems]),oI("design:returntype",void 0)],e.prototype,"setCheckedItems",null),sI([Object(d.a)(Zf.SetSidenav),oI("design:type",Function),oI("design:paramtypes",[Object,Zf.SetSidenav]),oI("design:returntype",void 0)],e.prototype,"setSidenav",null),sI([Object(d.a)(Zf.SetCardActions),oI("design:type",Function),oI("design:paramtypes",[Object,Zf.SetCardActions]),oI("design:returntype",void 0)],e.prototype,"setCardActions",null),sI([Object(d.a)(Zf.SetBulkActions),oI("design:type",Function),oI("design:paramtypes",[Object,Zf.SetBulkActions]),oI("design:returntype",void 0)],e.prototype,"setBulkActions",null),sI([Object(d.a)(Zf.ClearResults),oI("design:type",Function),oI("design:paramtypes",[Object,Zf.ClearResults]),oI("design:returntype",void 0)],e.prototype,"clearResults",null),sI([Object(d.a)(Zf.Reset),oI("design:type",Function),oI("design:paramtypes",[Object,Zf.Reset]),oI("design:returntype",void 0)],e.prototype,"resetGallery",null),sI([Object(d.e)(),oI("design:type",Function),oI("design:paramtypes",[LM]),oI("design:returntype",void 0)],e,"getLoading",null),sI([Object(d.e)(),oI("design:type",Function),oI("design:paramtypes",[LM]),oI("design:returntype",void 0)],e,"getSearchMode",null),sI([Object(d.e)(),oI("design:type",Function),oI("design:paramtypes",[LM]),oI("design:returntype",void 0)],e,"getSearchConfig",null),sI([Object(d.e)(),oI("design:type",Function),oI("design:paramtypes",[LM]),oI("design:returntype",void 0)],e,"getSearchOptions",null),sI([Object(d.e)(),oI("design:type",Function),oI("design:paramtypes",[LM]),oI("design:returntype",void 0)],e,"getAvailableTags",null),sI([Object(d.e)(),oI("design:type",Function),oI("design:paramtypes",[LM]),oI("design:returntype",void 0)],e,"getActiveTags",null),sI([Object(d.e)(),oI("design:type",Function),oI("design:paramtypes",[LM]),oI("design:returntype",void 0)],e,"getActiveTagsCount",null),sI([Object(d.e)(),oI("design:type",Function),oI("design:paramtypes",[LM]),oI("design:returntype",void 0)],e,"getSearchType",null),sI([Object(d.e)(),oI("design:type",Function),oI("design:paramtypes",[LM]),oI("design:returntype",void 0)],e,"getSearchGroup",null),sI([Object(d.e)(),oI("design:type",Function),oI("design:paramtypes",[LM]),oI("design:returntype",void 0)],e,"getViewMode",null),sI([Object(d.e)(),oI("design:type",Function),oI("design:paramtypes",[LM]),oI("design:returntype",void 0)],e,"getShowFilters",null),sI([Object(d.e)(),oI("design:type",Function),oI("design:paramtypes",[LM]),oI("design:returntype",void 0)],e,"getSort",null),sI([Object(d.e)(),oI("design:type",Function),oI("design:paramtypes",[LM]),oI("design:returntype",void 0)],e,"getSortOptions",null),sI([Object(d.e)(),oI("design:type",Function),oI("design:paramtypes",[LM]),oI("design:returntype",void 0)],e,"getSidenav",null),sI([Object(d.e)(),oI("design:type",Function),oI("design:paramtypes",[LM]),oI("design:returntype",void 0)],e,"getBulkActions",null),sI([Object(d.e)(),oI("design:type",Function),oI("design:paramtypes",[LM]),oI("design:returntype",void 0)],e,"getBulkActionsAvailable",null),sI([Object(d.e)(),oI("design:type",Function),oI("design:paramtypes",[LM]),oI("design:returntype",Boolean)],e,"getBulkActionsActive",null),sI([Object(d.e)(),oI("design:type",Function),oI("design:paramtypes",[LM]),oI("design:returntype",void 0)],e,"getCardActions",null),sI([Object(d.e)([py]),oI("design:type",Function),oI("design:paramtypes",[LM,Cb]),oI("design:returntype",WM)],e,"getFilteredResults",null),sI([Object(d.e)(),oI("design:type",Function),oI("design:paramtypes",[LM,Cb]),oI("design:returntype",WM)],e,"getAllResults",null),sI([Object(d.e)(),oI("design:type",Function),oI("design:paramtypes",[LM]),oI("design:returntype",void 0)],e,"getCheckedResults",null),e=sI([Object(d.f)({name:"gallery",defaults:rI})],e),e})();const lI=["app-pill-button",""],pI=function(e){return{"pill-button--selected":e}},dI=["*"];let uI=(()=>{class e{constructor(){this.selected=!1}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["button","app-pill-button",""],["a","app-pill-button",""]],inputs:{selected:"selected"},attrs:lI,ngContentSelectors:dI,decls:2,vars:3,consts:[[1,"pill-button",3,"ngClass"]],template:function(e,t){1&e&&(i.kc(),i.Vb(0,"span",0),i.jc(1),i.Ub()),2&e&&i.lc("ngClass",i.nc(1,pI,t.selected))},directives:[Z.i],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}[_nghost-%COMP%]{border-color:transparent;background:none;border-width:0;padding:0;margin:0;border-radius:4px;outline:0 none}[_nghost-%COMP%]:not([disabled]):hover{cursor:pointer}[_nghost-%COMP%]:focus   .pill-button[_ngcontent-%COMP%]{outline:2px solid #2d72dc!important}[_nghost-%COMP%]:disabled   .pill-button[_ngcontent-%COMP%], [_nghost-%COMP%]:disabled:hover   .pill-button[_ngcontent-%COMP%]{background-color:#f9fafd;color:#96a8c0}.pill-button[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em;font-family:Inter UI,sans-serif;font-weight:500;color:#374a68;display:flex;align-items:center;justify-content:center;background-color:#eaeff5;border-radius:100px;padding:8px 16px;transition:background-color .12s,color .12s;width:100%}.pill-button[_ngcontent-%COMP%]:hover{background-color:#d7e0ea}.pill-button--selected[_ngcontent-%COMP%], .pill-button--selected[_ngcontent-%COMP%]:hover{background-color:#2d72dc;color:#fff}"],changeDetection:0}),e})();var gI=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function hI(e,t){if(1&e){const e=i.Wb();i.Vb(0,"li",9),i.Vb(1,"button",10),i.cc("click",(function(){i.xc(e);const n=t.$implicit,s=i.gc().$implicit,o=i.gc(2);return o.setTag(s.title,o.activeTags[s.title]===n?"":n)})),i.hc(2,"async"),i.Kc(3),i.hc(4,"titlecase"),i.Ub(),i.Ub()}if(2&e){const e=t.$implicit,n=i.gc().$implicit,s=i.gc(2);let o=null;i.Db(1),i.lc("disabled",!(null!=(o=i.ic(2,3,s.availableTags$))&&o.includes(e)))("selected",s.activeTags[n.title]===e),i.Db(2),i.Mc(" ",i.ic(4,5,e)," ")}}function bI(e,t){if(1&e&&(i.Vb(0,"div",5),i.Vb(1,"h2",6),i.Kc(2),i.Ub(),i.Vb(3,"ul",7),i.Ic(4,hI,5,7,"li",8),i.Ub(),i.Ub()),2&e){const e=t.$implicit;i.Db(2),i.Lc(e.title),i.Db(2),i.lc("ngForOf",e.tags)}}function mI(e,t){if(1&e&&(i.Vb(0,"div",3),i.Ic(1,bI,5,2,"div",4),i.Ub()),2&e){const e=i.gc();i.lc("@show",void 0),i.Db(1),i.lc("ngForOf",e.tagGroups)}}function fI(e,t){if(1&e){const e=i.Wb();i.Vb(0,"li",9),i.Vb(1,"button",14),i.cc("click",(function(){i.xc(e);const t=i.gc(2).$implicit;return i.gc(2).setTag(t.title,"")})),i.Vb(2,"span",15),i.Kc(3),i.hc(4,"titlecase"),i.Ub(),i.Qb(5,"app-icon",16),i.Ub(),i.Ub()}if(2&e){const e=i.gc().$implicit;i.Db(3),i.Lc(i.ic(4,1,e))}}function yI(e,t){if(1&e&&(i.Tb(0),i.Ic(1,fI,6,3,"li",13),i.Sb()),2&e){const e=t.$implicit,n=i.gc().$implicit,s=i.gc(2);i.Db(1),i.lc("ngIf",s.activeTags[n.title]===e)}}function xI(e,t){if(1&e&&(i.Tb(0),i.Ic(1,yI,2,1,"ng-container",12),i.Sb()),2&e){const e=t.$implicit;i.Db(1),i.lc("ngForOf",e.tags)}}function vI(e,t){if(1&e&&(i.Vb(0,"ul",11),i.Ic(1,xI,2,1,"ng-container",12),i.Ub()),2&e){const e=i.gc();i.Db(1),i.lc("ngForOf",e.tagGroups)}}let OI=(()=>{class e{constructor(e,t,n){this.changeDetectorRef=e,this.store=t,this.router=n,this.activeTagList=[],this.ngUnsubscribe=new k.a,this._viewMode="expanded",this.tagGroups=[],this._activeTags={},this.selectedTagChange=new i.p}get viewMode(){return this._viewMode}set viewMode(e){this._viewMode=e}get activeTags(){return this._activeTags}set activeTags(e){null==e&&(e={}),this._activeTags=e,this.activeTagList=Object.values(this.activeTags).reduce((e,t)=>(""!=t&&e.push(t),e),[]),this.changeDetectorRef.markForCheck()}ngOnInit(){this.store.select(cI.getActiveTags).pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.activeTags=e}),this.tagGroups=[],c.native&&this.tagGroups.push(YM),this.isExplore()&&(this.tagGroups=this.tagGroups.concat([JM,XM,Object.assign(Object.assign({},ZM),{tags:Object(D.without)(ZM.tags,"Quiz")})]))}isExplore(){return this.router.url.indexOf("/results/modules")>=0}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}setTag(e,t){const n=this.store.selectSnapshot(cI.getActiveTags);n[e]=t,this.store.dispatch(new Zf.SetActiveTags(n))}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(i.i),i.Pb(d.g),i.Pb(T.e))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-gallery-filters"]],inputs:{viewMode:"viewMode"},outputs:{selectedTagChange:"selectedTagChange"},decls:3,vars:2,consts:[["data-test","galleryFilters",1,"gallery-filters"],["class","gallery-filters__expanded","data-test","galleryFiltersExpanded",4,"ngIf"],["class","gallery-filters__tags","data-test","galleryFiltersSummary",4,"ngIf"],["data-test","galleryFiltersExpanded",1,"gallery-filters__expanded"],["class","gallery-filters__group",4,"ngFor","ngForOf"],[1,"gallery-filters__group"],[1,"gallery-filters__header"],[1,"gallery-filters__tags"],["class","gallery-filters__tag",4,"ngFor","ngForOf"],[1,"gallery-filters__tag"],["app-pill-button","","data-test","galleryFiltersTag",3,"disabled","selected","click"],["data-test","galleryFiltersSummary",1,"gallery-filters__tags"],[4,"ngFor","ngForOf"],["class","gallery-filters__tag",4,"ngIf"],["app-pill-button","","data-test","galleryFiltersTag",3,"click"],[1,"mr-2"],["icon","times"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Ic(1,mI,2,2,"div",1),i.Ic(2,vI,2,1,"ul",2),i.Ub()),2&e&&(i.Db(1),i.lc("ngIf","expanded"===t.viewMode),i.Db(1),i.lc("ngIf","summary"===t.viewMode))},directives:[Z.l,Z.k,uI,dl],pipes:[Z.b,Z.t],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.gallery-filters__expanded[_ngcontent-%COMP%]{display:grid;grid-template-columns:33% 33% 33%;grid-gap:16px}.gallery-filters__header[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em;font-weight:600;padding-bottom:12px}.gallery-filters__tag[_ngcontent-%COMP%]{display:inline-block;margin:0 12px 12px 0}@media (max-width:1179px){.gallery-filters__expanded[_ngcontent-%COMP%]{grid-template-columns:100%}}@media (max-width:540px){.gallery-filters__group[_ngcontent-%COMP%]{padding:0 0 24px}}"],data:{animation:[Object(Zl.n)("show",[Object(Zl.m)(":enter",[Object(Zl.l)({height:"0"}),Object(Zl.e)("250ms ease-out",Object(Zl.l)({height:"*"}))])])]},changeDetection:0}),function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);o>3&&r&&Object.defineProperty(t,n,r)}([Object(d.d)(cI.getAvailableTags),gI("design:type",P.a)],e.prototype,"availableTags$",void 0),e})(),wI=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[Z.c,qO.f,nM,LP,qP,rM]]}),e})(),CI=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[d.c.forFeature([cI]),Vg.b,T.f,qP,Z.c,Du.r,DM,WP,EP,UP,iM,ZP,rM,CP.a,wI]]}),e})();i.Bc(KM,[dp,ud,dl,OI],[]);let SI=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[Z.c,UP,T.f,rM]]}),e})(),_I=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[rM,UP,Z.c,T.f,iM,ge,Du.r,DM,CI,SI,d.c.forFeature([ll])]]}),e})(),jI=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[Z.c,Pd.a.forChild()]]}),e})(),kI=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[Z.c,rM,UP,jI]]}),e})(),PI=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[d.c.forFeature([xs]),Z.c,LP,Du.r]]}),e})(),MI=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[d.c.forFeature([za,Or,Ca,qs]),Z.c,rM,UP,KP,kI,Du.r,Pd.a.forChild(),PI]]}),e})(),II=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[d.c.forFeature([Er,jr,Bi,oc,ts]),U.d,Z.c,WP,UP,Du.j,MI,rM,KP]]}),e})(),zI=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[Z.c,UP,rM,UM,d.c.forFeature([PM])]]}),e})(),TI=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[Z.c,UP,rM]]}),e})(),UI=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[Z.c,UP,rM]]}),e})(),DI=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[Z.c,UP,rM,Du.r]]}),e})(),LI=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[Z.c,UP,rM]]}),e})(),EI=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[Z.c,UP,rM]]}),e})(),FI=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[Z.c,UP,rM]]}),e})(),AI=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[Z.c,UP,rM]]}),e})(),RI=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[Z.c,UP,qP]]}),e})(),VI=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[Z.c,UP,rM,Du.r]]}),e})(),NI=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[Z.c,UP,rM,Du.r]]}),e})(),BI=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[Z.c,UP,rM]]}),e})();class HI{}var QI;!function(e){class t{constructor(){}}t.type="[Dialog] Open Limit",e.OpenLimit=t;class n{constructor(e){this.upgrade=e}}n.type="[Dialog] Close Limit",e.CloseLimit=n;class i{constructor(){}}i.type="[Dialog] Open Premium Content",e.OpenPremiumContent=i;class s{constructor(e){this.confirmed=e}}s.type="[Dialog] Close Premium Content",e.ClosePremiumContent=s;class o{constructor(){}}o.type="[Dialog] Open Upgrade",e.OpenUpgrade=o;class r{constructor(){}}r.type="[Dialog] Close Upgrade",e.CloseUpgrade=r}(QI||(QI={}));let $I=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-limit-dialog"]],decls:12,vars:2,consts:[["mat-dialog-title",""],["mat-dialog-content","",1,"pt-1","pb-6"],[1,"text-14","pb-3"],[1,"text-14"],["mat-dialog-actions","",1,"pt-2"],["app-button","","buttonTheme","light","cdkFocusInitial","",1,"mr-2",3,"mat-dialog-close"],["app-button","","buttonType","primary",3,"mat-dialog-close"]],template:function(e,t){1&e&&(i.Vb(0,"h1",0),i.Kc(1,"New Bookmark Limit Reached"),i.Ub(),i.Vb(2,"div",1),i.Vb(3,"div",2),i.Kc(4," You've reached your limit of 5 3D models in your Library. You can make changes to this model, but you will not be able to save as a new model. "),i.Ub(),i.Vb(5,"div",3),i.Kc(6,"Upgrade to a Premium Plan to save unlimited 3D models."),i.Ub(),i.Ub(),i.Vb(7,"div",4),i.Vb(8,"button",5),i.Kc(9," OK "),i.Ub(),i.Vb(10,"button",6),i.Kc(11,"Upgrade Now"),i.Ub(),i.Ub()),2&e&&(i.Db(8),i.lc("mat-dialog-close",!1),i.Db(2),i.lc("mat-dialog-close",!0))},directives:[nl.h,nl.e,nl.c,ud,nl.d],styles:[""],changeDetection:0}),e})();function qI(e,t){if(1&e&&(i.Vb(0,"button",7),i.Kc(1),i.Ub()),2&e){const e=i.gc();i.Db(1),i.Mc(" ",e.settings.miscText," ")}}function WI(e,t){if(1&e&&(i.Vb(0,"button",8),i.Kc(1),i.Ub()),2&e){const e=i.gc();i.lc("mat-dialog-close",!1),i.Db(1),i.Mc(" ",e.settings.cancelText," ")}}function KI(e,t){if(1&e&&(i.Vb(0,"button",9),i.Kc(1),i.Ub()),2&e){const e=i.gc();i.lc("mat-dialog-close",!0),i.Db(1),i.Mc(" ",e.settings.confirmText," ")}}let GI=(()=>{class e{constructor(e,t){this.dialogRef=e,this.data=t,this.settings={titleText:"Confirm Action",bodyText:"",confirmText:"Confirm",confirmColor:"primary",cancelText:"Cancel",confirmEnabled:!0,cancelEnabled:!0,miscText:""},t&&(this.settings=Object.assign(Object.assign({},this.settings),t))}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(nl.g),i.Pb(nl.a))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-confirm-dialog"]],decls:10,vars:8,consts:[["data-test","confirmDialog","role","alertdialog","aria-modal","true"],["mat-dialog-title",""],["mat-dialog-content","",1,"pt-4","pb-6","text-14"],["mat-dialog-actions","",1,"dialog__actions","pt-2"],["app-button","","buttonTheme","light",3,"mat-dialog-close",4,"ngIf"],["type","button","class","mr-1","app-button","","buttonTheme","light","data-test","confirmDialogCancelButton",3,"mat-dialog-close",4,"ngIf"],["type","button","app-button","","buttonType","primary","data-test","confirmDialogConfirmButton","cdkFocusInitial","",3,"mat-dialog-close",4,"ngIf"],["app-button","","buttonTheme","light",3,"mat-dialog-close"],["type","button","app-button","","buttonTheme","light","data-test","confirmDialogCancelButton",1,"mr-1",3,"mat-dialog-close"],["type","button","app-button","","buttonType","primary","data-test","confirmDialogConfirmButton","cdkFocusInitial","",3,"mat-dialog-close"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Vb(1,"h1",1),i.Kc(2),i.Ub(),i.Vb(3,"p",2),i.Kc(4),i.Ub(),i.Vb(5,"div",3),i.Ic(6,qI,2,1,"button",4),i.Vb(7,"div"),i.Ic(8,WI,2,2,"button",5),i.Ic(9,KI,2,2,"button",6),i.Ub(),i.Ub(),i.Ub()),2&e&&(i.Eb("aria-label",t.settings.titleText),i.Db(2),i.Mc(" ",t.settings.titleText," "),i.Db(2),i.Mc(" ",t.settings.bodyText," "),i.Db(1),i.Hb("dialog__actions--compact",!t.settings.miscText),i.Db(1),i.lc("ngIf",t.settings.miscText),i.Db(2),i.lc("ngIf",t.settings.cancelEnabled),i.Db(1),i.lc("ngIf",t.settings.confirmEnabled))},directives:[nl.h,nl.e,nl.c,Z.l,ud,nl.d],styles:["[_nghost-%COMP%]{display:block}.dialog__actions[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:center}.dialog__actions--compact[_ngcontent-%COMP%]{justify-content:flex-end}@media (min-width:480px){[_nghost-%COMP%]{min-width:320px}}"],changeDetection:0}),e})();const ZI=["copyField"];let JI=(()=>{class e{constructor(e,t,n){this.dialogRef=e,this.data=t,this.clipboardService=n,this.settings={title:"Copy to Clipboard",copyText:""},this.settings=Object.assign(Object.assign({},this.settings),t)}get rowCount(){return this.settings.copyText.split(/\r?\n/).length+1}ngOnInit(){}ngAfterViewInit(){const e=this.copyField.nativeElement;e.focus(),e.select()}handleCopyClick(){const e=this.clipboardService.copyInputFieldValue(this.copyField.nativeElement);this.close(e)}handleCancelClick(){this.close(!1)}close(e){this.dialogRef.close(e)}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(nl.g),i.Pb(nl.a),i.Pb(Mp))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-clipboard-dialog"]],viewQuery:function(e,t){if(1&e&&i.Ec(ZI,!0),2&e){let e;i.sc(e=i.dc())&&(t.copyField=e.first)}},decls:11,vars:3,consts:[["mat-dialog-title",""],["mat-dialog-content","",1,"copy","flex"],[1,"copy__input","flex-auto",3,"value","rows"],["copyField",""],["mat-dialog-actions",""],["app-button","","buttonTheme","light",3,"click"],["app-button","","buttonType","primary",3,"click"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Kc(1),i.Ub(),i.Vb(2,"div",1),i.Vb(3,"textarea",2,3),i.Kc(5,"  "),i.Ub(),i.Ub(),i.Vb(6,"div",4),i.Vb(7,"button",5),i.cc("click",(function(){return t.handleCancelClick()})),i.Kc(8,"Cancel"),i.Ub(),i.Vb(9,"button",6),i.cc("click",(function(){return t.handleCopyClick()})),i.Kc(10,"Copy to Clipboard"),i.Ub(),i.Ub()),2&e&&(i.Db(1),i.Mc(" ",t.settings.title,"\n"),i.Db(2),i.lc("value",t.settings.copyText)("rows",t.rowCount))},directives:[nl.h,nl.e,nl.c,ud],styles:[".copy[_ngcontent-%COMP%]{min-width:480px}"],changeDetection:0}),e})();const XI=["modalContents"];let YI=(()=>{class e{constructor(e,t,n,i,s,o){this.dialogRef=e,this.data=t,this.sanitizer=n,this.renderer=i,this.pendoService=s,this.productService=o}onMessage(e){switch(e.data.action){case"close":this.dialogRef.close(e.data);break;case"track":this.pendoService.track(e.data.label,Object.assign(Object.assign({},e.data.metadata),{platform:this.productService.productType}))}}ngOnInit(){this.title=this.data.title,this.url=this.data.url?this.sanitizer.bypassSecurityTrustResourceUrl(this.data.url):"",this.renderer.setStyle(this.modalContents.nativeElement,"background-color",this.data.backgroundColor||"#ffffff")}closeDialog(){this.dialogRef.close()}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(nl.g),i.Pb(nl.a),i.Pb(l.b),i.Pb(i.H),i.Pb(G),i.Pb(mf))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-iframe-dialog"]],viewQuery:function(e,t){if(1&e&&i.Ec(XI,!0),2&e){let e;i.sc(e=i.dc())&&(t.modalContents=e.first)}},hostBindings:function(e,t){1&e&&i.cc("message",(function(e){return t.onMessage(e)}),!1,i.wc)},decls:6,vars:3,consts:[["role","dialog","aria-modal","true",1,"modal"],[1,"modal__contents"],["modalContents",""],["cdkFocusInitial","",1,"modal__frame",3,"src"],["app-button","","buttonTheme","dark","buttonType","white","buttonShape","circle","type","button","title","Close",1,"modal__close",3,"click"],["icon","times","size","lg"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Vb(1,"div",1,2),i.Qb(3,"iframe",3),i.Ub(),i.Vb(4,"button",4),i.cc("click",(function(){return t.closeDialog()})),i.Qb(5,"app-icon",5),i.Ub(),i.Ub()),2&e&&(i.Eb("aria-label",t.title),i.Db(3),i.lc("src",t.url,i.zc),i.Db(1),i.Eb("aria-label","Close"))},directives:[ud,dl],styles:[".modal[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;position:relative}.modal__close[_ngcontent-%COMP%]{margin-bottom:4px;align-self:flex-end;cursor:pointer;position:absolute;right:12px;top:12px}.modal__contents[_ngcontent-%COMP%]{flex-grow:1}.modal__frame[_ngcontent-%COMP%]{width:100%;height:100%}"],changeDetection:0}),e})();var ez=function(e){return e.PersonalUse="Personal Use",e.Education="Education",e.Business="Business",e}({});let tz=(()=>{class e{constructor(e){this.organization=e}}return e.type="[Users] Join Organization",e})(),nz=(()=>{class e{constructor(e){this.organization=e}}return e.type="[Users] Join Organization Success",e})(),iz=(()=>{class e{constructor(e){this.organization=e}}return e.type="[Users] Join Organization Fail",e})(),sz=(()=>{class e{constructor(e){this.code=e}}return e.type="[Users] Join Organization With Code",e})(),oz=(()=>{class e{constructor(e){this.organizationName=e}}return e.type="[Users] Join Organization With Code Success",e})(),rz=(()=>{class e{constructor(e){this.error=e}}return e.type="[Users] Join Organization With Code Fail",e})(),az=(()=>{class e{constructor(e,t){this.groupEID=e,this.invites=t}}return e.type="[Users] Send Organization Invite",e})(),cz=(()=>{class e{constructor(e){this.responses=e}}return e.type="[Users] Send Organization Invite Success",e})(),lz=(()=>{class e{constructor(e){this.error=e}}return e.type="[Users] Send Organization Invite Fail",e})(),pz=(()=>{class e{constructor(e){this.groupId=e}}return e.type="[Users] Get Organization Users",e})(),dz=(()=>{class e{constructor(e){this.users=e}}return e.type="[Users] Get Organization Users Success",e})(),uz=(()=>{class e{constructor(e){this.error=e}}return e.type="[Users] Get Organization Users Fail",e})(),gz=(()=>{class e{constructor(e){this.groupId=e}}return e.type="[Users] Get Organization Invited Users",e})(),hz=(()=>{class e{constructor(e){this.invites=e}}return e.type="[Users] Get Organization Invited Users Success",e})(),bz=(()=>{class e{constructor(e){this.error=e}}return e.type="[Users] Get Organization Invited Users Fail",e})(),mz=(()=>{class e{}return e.type="[Users] Reset",e})(),fz=(()=>{class e{constructor(e,t){this.groupId=e,this.users=t}}return e.type="[Users] Update User Roles",e})(),yz=(()=>{class e{constructor(e,t){this.groupId=e,this.users=t}}return e.type="[Users] Update User Roles Success",e})(),xz=(()=>{class e{}return e.type="[Users] Update User Roles Fail",e})(),vz=(()=>{class e{constructor(e,t){this.groupId=e,this.users=t}}return e.type="[Users] Remove Organization User",e})(),Oz=(()=>{class e{constructor(e,t){this.groupId=e,this.users=t}}return e.type="[Users] Remove Organization User Success",e})(),wz=(()=>{class e{}return e.type="[Users] Remove Organization User Fail",e})(),Cz=(()=>{class e{constructor(e,t){this.groupId=e,this.users=t}}return e.type="[Users] Transfer Organization Content",e})(),Sz=(()=>{class e{constructor(e,t){this.groupId=e,this.users=t}}return e.type="[Users] Transfer Organization Content Success",e})(),_z=(()=>{class e{}return e.type="[Users] Transfer Organization Content Fail",e})();var jz=n("7HRe"),kz=n("qgXg"),Pz=n("0EUg");let Mz=(()=>{class e{constructor(e){this.http=e}getOrganizationUsers(e){const t=$(e);return this.http.get("/ws/organization/users"+t).pipe(Object(F.a)(e=>e.users),Object(F.a)(e=>e.map(e=>Object.assign(Object.assign({},e),{user_role:cf(e.user_role)}))))}getOrganizationInvites(e){const t=$(e);return this.http.get("/ws/organization/invite"+t).pipe(Object(F.a)(e=>e.invites),Object(F.a)(e=>e.map(e=>Object.assign(Object.assign({},e),{invite_user:Object.assign(Object.assign({},e.inviter_user),{user_role:cf(e.inviter_user.user_role)}),invitee_user:Object.assign(Object.assign({},e.invitee_user),{user_role:cf(e.invitee_user.user_role)})}))))}sendOrganizationInvites(e,t,n){return this.http.post("/ws/organization/invite",{version:2,group_eid:e,invite_emails:t,site_verify_response:n}).pipe(Object(F.a)(e=>{const{messages:t}=e.results_summary;return t}))}addUserToOrganization(e){return this.http.post("/ws/organization/user/add",{group_eid:e})}addUserWithGroupCode(e){return this.http.post("/ws/organization/user/add",{group_code:e}).pipe(Object(F.a)(e=>e.organization_name))}updateUserRoles(e,t){return this.batchUsers(t,t=>this.http.post("/ws/organization/users",{group_id:e,update_users:t.map(e=>({user_id:e.userId,role_id:e.roleId}))}))}removeUsers(e,t){return this.batchUsers(t,t=>this.http.post("/ws/organization/users",{group_id:e,remove_users:t.map(e=>this.createTransferRequest(e))}))}transferUserContent(e,t){return this.batchUsers(t,t=>this.http.post("/ws/organization/bookmark/transfer",{group_id:e,transfer_bookmarks:t.map(e=>this.createTransferRequest(e))}))}createUserDisplayModel(e,t){return{name:this.formatUserName(e),initials:this.formatBadgeLabel(e),email:e.user_email,id:e.user_id,role:e.user_role,selected:!1,invitationStatus:t}}batchUsers(e,t){let n=0;const i=[];for(;n<e.length;){const s=e.slice(n,n+50);i.push(t(s)),n+=50}const s=Object(jz.a)(i,kz.b).pipe(Object(Pz.a)());return Object(Vr.a)(s).pipe(Object(F.a)(()=>!0))}createTransferRequest(e){const{sourceUserId:t,targetUserId:n}=e;return"number"==typeof n?{user_id:t,group_bookmarks:{transfer_ownership:1,transfer_user_id:n}}:{user_id:t}}formatUserName(e){const{user_first_name:t,user_last_name:n}=e,i=[t,n].filter(e=>!!e);return i.length>0?i.join(" "):""}formatBadgeLabel(e){const{user_first_name:t,user_last_name:n}=e;return[t,n].filter(e=>!!e).map(e=>e[0]).join("")}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(v.b))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();class Iz{}var zz=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},Tz=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const Uz={joining:!1,inviting:!1,loadingUsers:!1,loadingInvites:!1,users:[],invites:[]};let Dz=(()=>{let e=class{constructor(e,t,n,i){this.usersService=e,this.pendoService=t,this.productService=n,this.authService=i}static getUsers(e){return e.users}static getInvites(e){return e.invites}static getUsersLoading(e){return e.loadingUsers}static getJoining(e){return e.joining}static getInviting(e){return e.inviting}joinOrganization(e,{organization:t}){e.patchState({joining:!0}),this.usersService.addUserToOrganization(t.eid).pipe(Object(Mr.a)(()=>e.patchState({joining:!1}))).subscribe(()=>e.dispatch(new nz(t)),()=>e.dispatch(new iz(t)))}joinOrganizationWithCode(e,{code:t}){e.patchState({joining:!0}),this.usersService.addUserWithGroupCode(t).pipe(Object(Mr.a)(()=>e.patchState({joining:!1}))).subscribe(t=>e.dispatch(new oz(t)),t=>e.dispatch(new rz(t)))}joinOrganizationWithCodeSuccess(){this.pendoService.track("Account Upgrade - Free Individual to Team")}sendOrganizationInvite(e,{groupEID:t,invites:n}){e.patchState({inviting:!0}),this.authService.isHuman("invites",!0).pipe(Object(vn.a)(t=>{t.isHuman||e.dispatch(new km(new Error("reCAPTCHA error. Refresh the page and try again.")))}),Object(I.a)(e=>e.isHuman),Object(Us.b)(e=>this.usersService.sendOrganizationInvites(t,n,e.verification)),Object(Mr.a)(()=>e.patchState({inviting:!1}))).subscribe(t=>e.dispatch(new cz(t)),t=>e.dispatch(new lz(t)))}getOrganizationUsers(e,{groupId:t}){e.patchState({loadingUsers:!0}),this.usersService.getOrganizationUsers({group_id:t}).pipe(Object(Mr.a)(()=>e.patchState({loadingUsers:!1}))).subscribe(t=>e.dispatch(new dz(t)),t=>e.dispatch(new uz(t)))}getOrganizationUsersSuccess(e,{users:t}){e.patchState({users:t})}getOrganizationUserInvites(e,{groupId:t}){e.patchState({loadingInvites:!0}),this.usersService.getOrganizationInvites({group_id:t,version:1,app_productkey:this.productService.productKey,app_producttype:this.productService.productType}).pipe(Object(Mr.a)(()=>e.patchState({loadingInvites:!1}))).subscribe(t=>e.dispatch(new hz(t)),t=>e.dispatch(new bz(t)))}getOrganizationUserInvitesSuccess(e,{invites:t}){e.patchState({invites:t})}resetOrganizations(e){e.setState(Uz)}updateUserRoles(e,{groupId:t,users:n}){this.usersService.updateUserRoles(t,n).subscribe(()=>e.dispatch(new yz(t,n)),()=>e.dispatch(new xz))}removeOrganizationUser(e,{groupId:t,users:n}){this.usersService.removeUsers(t,n).subscribe(()=>e.dispatch(new Oz(t,n)),()=>e.dispatch(new wz))}transferOrganizationContent(e,{groupId:t,users:n}){this.usersService.transferUserContent(t,n).subscribe(()=>e.dispatch(new Sz(t,n)),()=>e.dispatch(new _z))}};return e.\u0275fac=function(t){return new(t||e)(i.Zb(Mz),i.Zb(G),i.Zb(mf),i.Zb(yf))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac}),zz([Object(d.a)(tz),Tz("design:type",Function),Tz("design:paramtypes",[Object,tz]),Tz("design:returntype",void 0)],e.prototype,"joinOrganization",null),zz([Object(d.a)(sz),Tz("design:type",Function),Tz("design:paramtypes",[Object,sz]),Tz("design:returntype",void 0)],e.prototype,"joinOrganizationWithCode",null),zz([Object(d.a)(oz),Tz("design:type",Function),Tz("design:paramtypes",[]),Tz("design:returntype",void 0)],e.prototype,"joinOrganizationWithCodeSuccess",null),zz([Object(d.a)(az),Tz("design:type",Function),Tz("design:paramtypes",[Object,az]),Tz("design:returntype",void 0)],e.prototype,"sendOrganizationInvite",null),zz([Object(d.a)(pz),Tz("design:type",Function),Tz("design:paramtypes",[Object,pz]),Tz("design:returntype",void 0)],e.prototype,"getOrganizationUsers",null),zz([Object(d.a)(dz),Tz("design:type",Function),Tz("design:paramtypes",[Object,dz]),Tz("design:returntype",void 0)],e.prototype,"getOrganizationUsersSuccess",null),zz([Object(d.a)(gz),Tz("design:type",Function),Tz("design:paramtypes",[Object,gz]),Tz("design:returntype",void 0)],e.prototype,"getOrganizationUserInvites",null),zz([Object(d.a)(hz),Tz("design:type",Function),Tz("design:paramtypes",[Object,hz]),Tz("design:returntype",void 0)],e.prototype,"getOrganizationUserInvitesSuccess",null),zz([Object(d.a)(mz),Tz("design:type",Function),Tz("design:paramtypes",[Object]),Tz("design:returntype",void 0)],e.prototype,"resetOrganizations",null),zz([Object(d.a)(fz),Tz("design:type",Function),Tz("design:paramtypes",[Object,fz]),Tz("design:returntype",void 0)],e.prototype,"updateUserRoles",null),zz([Object(d.a)(vz),Tz("design:type",Function),Tz("design:paramtypes",[Object,vz]),Tz("design:returntype",void 0)],e.prototype,"removeOrganizationUser",null),zz([Object(d.a)(Cz),Tz("design:type",Function),Tz("design:paramtypes",[Object,Cz]),Tz("design:returntype",void 0)],e.prototype,"transferOrganizationContent",null),zz([Object(d.e)(),Tz("design:type",Function),Tz("design:paramtypes",[Iz]),Tz("design:returntype",void 0)],e,"getUsers",null),zz([Object(d.e)(),Tz("design:type",Function),Tz("design:paramtypes",[Iz]),Tz("design:returntype",void 0)],e,"getInvites",null),zz([Object(d.e)(),Tz("design:type",Function),Tz("design:paramtypes",[Iz]),Tz("design:returntype",void 0)],e,"getUsersLoading",null),zz([Object(d.e)(),Tz("design:type",Function),Tz("design:paramtypes",[Iz]),Tz("design:returntype",void 0)],e,"getJoining",null),zz([Object(d.e)(),Tz("design:type",Function),Tz("design:paramtypes",[Iz]),Tz("design:returntype",void 0)],e,"getInviting",null),e=zz([Object(d.f)({name:"users",defaults:Uz})],e),e})();function Lz(e){return t=>{const n=Rg.parseEmails(t.value),i=n.filter(e=>!Rg.validateEmail(e)),s=n.length,o="number"==typeof e&&s>e;let r={};return o&&(r=Object.assign(Object.assign({},r),{maxEmailsExceeded:o,currentEmailCount:s})),i.length>0&&(r=Object.assign(Object.assign({},r),{invalidEmails:i})),Object.keys(r).length>0?Object(zs.a)(r):Object(zs.a)(null)}}const Ez=VP[RP.WoltersKluwer],Fz={};function Az(e,t){const n=Object(D.get)(e,"error.error.error_id",""),i=Object(D.get)(e,"error.error.message","");return function(e,t){switch(e){case"OPPH01.00122":case"SUH01.00122":case"SIH01.00122":case"FSH01.00122":case"GSH01.00122":return`We were unable to find an account associated with your institution. \n      Please contact your administrator [here](${Ez}) and provide this error ID: ${e}.`;case"OPPH01.00123":case"SUH01.00123":case"SIH01.00123":case"FSH01.00123":case"GSH01.00123":return`There are multiple team accounts associated with your institution. \n      Please contact your administrator [here](${Ez}) and provide this error ID: ${e}.`;case"OPPH01.00124":case"OPPH01.00125":case"OPPH01.00110":case"OPPH01.00111":case"OPPH01.00112":case"SUH01.00124":case"SUH01.00110":case"SUH01.00111":case"SUH01.00112":case"SIH01.00124":case"SIH01.00110":case"SIH01.00111":case"SIH01.00112":case"FSH01.00124":case"FSH01.00125":case"FSH01.00110":case"FSH01.00111":case"FSH01.00112":case"GSH01.00124":case"GSH01.00110":case"GSH01.00111":case"GSH01.00112":return`There was an issue with retrieving information from your institution. \n      Please try again or contact your administrator [here](${Ez}) and provide this error ID: ${e}.`;default:return Fz[e]||""}}(n)||(i?i.replace(/^\[(.+)\]$/,"$1").replace(/^\'(.+)\'$/,"$1"):"")}const Rz=["labelEl"];function Vz(e,t){if(1&e&&(i.Vb(0,"div",5),i.Kc(1),i.Ub()),2&e){const e=i.gc();i.Hb("text-uppercase",e.uppercase),i.Db(1),i.Mc(" ",e.label," ")}}const Nz=["*",[["","form-field-help",""]]],Bz=function(e,t,n,i){return{"field--light":e,"field--dark":t,"field--inline":n,"field--compact":i}},Hz=["*","[form-field-help]"];let Qz=(()=>{class e{constructor(){this.display="block",this.theme="dark",this.uppercase=!0,this.isCompact=!1,this.ngUnsubscribe=new k.a}ngOnInit(){}ngAfterViewInit(){this.labelEl.nativeElement.querySelectorAll("[contenteditable]").length>0&&Object(Uo.a)(this.labelEl.nativeElement,"click").pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{e.preventDefault()})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Jb({type:e,selectors:[["app-form-field"]],viewQuery:function(e,t){if(1&e&&i.Ec(Rz,!0),2&e){let e;i.sc(e=i.dc())&&(t.labelEl=e.first)}},inputs:{label:"label",display:"display",theme:"theme",uppercase:"uppercase",isCompact:"isCompact"},ngContentSelectors:Hz,decls:8,vars:8,consts:[["data-test","formField",1,"field",3,"ngClass"],["labelEl",""],["class","field__label text-10","data-test","formFieldLabel",3,"text-uppercase",4,"ngIf"],[1,"field__input"],[1,"field__help","text-dim","text-11"],["data-test","formFieldLabel",1,"field__label","text-10"]],template:function(e,t){1&e&&(i.kc(Nz),i.Vb(0,"div",0),i.Vb(1,"label",null,1),i.Ic(3,Vz,2,3,"div",2),i.Vb(4,"div",3),i.jc(5),i.Vb(6,"div",4),i.jc(7,1),i.Ub(),i.Ub(),i.Ub(),i.Ub()),2&e&&(i.lc("ngClass",i.qc(3,Bz,"light"===t.theme,"dark"===t.theme,"inline"===t.display,t.isCompact)),i.Db(1),i.Eb("aria-label",t.label),i.Db(2),i.lc("ngIf",t.label))},directives:[Z.i,Z.l],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.field[_ngcontent-%COMP%]{padding-bottom:16px;display:block;width:100%}.field__input[_ngcontent-%COMP%]{margin-top:4px}.field--light[_ngcontent-%COMP%]   .field__label[_ngcontent-%COMP%]{color:#374a68}.field--dark[_ngcontent-%COMP%]   .field__label[_ngcontent-%COMP%]{color:#96a8c0}.field--inline[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;width:auto}.field--inline[_ngcontent-%COMP%]   .field__label[_ngcontent-%COMP%]{margin-right:8px}.field--inline[_ngcontent-%COMP%]   .field__input[_ngcontent-%COMP%]{margin-top:auto}.field--compact[_ngcontent-%COMP%]{padding-bottom:0}.field__help[_ngcontent-%COMP%]:not(:empty){padding-top:8px}"],changeDetection:0}),e})();var $z=n("kmnG"),qz=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},Wz=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Kz(e,t){if(1&e&&(i.Vb(0,"div",7),i.Vb(1,"app-message-toggle",8),i.Kc(2),i.Ub(),i.Ub()),2&e){const e=i.gc(2);i.Db(2),i.Mc(" ",e.sentResponses.length," invite(s) have been sent. Please allow up to a few minutes for invitees to receive their invitations. ")}}function Gz(e,t){if(1&e&&(i.Tb(0),i.Ic(1,Kz,3,1,"div",6),i.Sb()),2&e){const e=i.gc();i.Db(1),i.lc("ngIf",e.sentResponses.length>0)}}function Zz(e,t){if(1&e&&(i.Vb(0,"div"),i.Kc(1),i.Ub()),2&e){const e=t.$implicit;i.Db(1),i.Mc(" ",e," ")}}function Jz(e,t){if(1&e&&(i.Vb(0,"div",16),i.Vb(1,"app-message-toggle",17),i.Vb(2,"div"),i.Kc(3),i.Ub(),i.Ic(4,Zz,2,1,"div",18),i.Ub(),i.Ub()),2&e){const e=i.gc(3);i.Db(3),i.Mc("There was an error sending ",e.errorResponses.length," invite(s)."),i.Db(1),i.lc("ngForOf",e.formatResponses(e.errorResponses))}}function Xz(e,t){if(1&e&&(i.Vb(0,"div",16),i.Vb(1,"app-message-toggle",17),i.Kc(2),i.Ub(),i.Ub()),2&e){const e=i.gc(3);i.Db(2),i.Mc(" ",e.errorMessage," ")}}function Yz(e,t){if(1&e&&(i.Vb(0,"div",19),i.Vb(1,"mat-error"),i.Kc(2),i.Ub(),i.Ub()),2&e){const e=i.gc().$implicit,t=i.gc(2);i.Db(2),i.Nc(" Please limit your entry to ",t.maxEmailCount,". Current count: ",null==e.errors?null:e.errors.currentEmailCount,". ")}}function eT(e,t){if(1&e&&(i.Vb(0,"div",19),i.Vb(1,"mat-error"),i.Kc(2),i.Ub(),i.Ub()),2&e){const e=i.gc().$implicit,t=i.gc(2);i.Db(2),i.Nc(" ",t.formatEmails(null==e.errors?null:e.errors.invalidEmails)," ",1===e.errors.invalidEmails.length?"is not a valid email address.":"are not valid email addresses."," ")}}function tT(e,t){if(1&e&&(i.Vb(0,"option",24),i.Kc(1),i.Ub()),2&e){const e=t.$implicit;i.lc("value",e.role_id),i.Db(1),i.Mc(" ",e.role_display_name," ")}}function nT(e,t){1&e&&(i.Vb(0,"div",19),i.Vb(1,"mat-error"),i.Kc(2," Please select a valid role. "),i.Ub(),i.Ub())}function iT(e,t){if(1&e&&(i.Vb(0,"app-form-field",20),i.Vb(1,"select",21),i.Vb(2,"option",22),i.Kc(3,"--"),i.Ub(),i.Ic(4,tT,2,2,"option",23),i.Ub(),i.Ic(5,nT,3,0,"div",14),i.Ub()),2&e){const e=t.$implicit,n=i.gc(3);i.Db(4),i.lc("ngForOf",n.availableRoles),i.Db(1),i.lc("ngIf",e.touched&&e.invalid)}}function sT(e,t){if(1&e&&(i.Tb(0,10),i.Ic(1,Jz,5,2,"div",11),i.Ic(2,Xz,3,1,"div",11),i.Vb(3,"app-form-field",12),i.Vb(4,"textarea",13),i.Kc(5,"          "),i.Ub(),i.Ic(6,Yz,3,2,"div",14),i.Ic(7,eT,3,2,"div",14),i.Ub(),i.Ic(8,iT,6,2,"app-form-field",15),i.Sb()),2&e){const e=t.$implicit,n=i.gc(2);i.lc("formGroup",n.form),i.Db(1),i.lc("ngIf",n.errorResponses.length>0),i.Db(1),i.lc("ngIf",n.errorMessage),i.Db(2),i.lc("placeholder","Enter up to "+n.maxEmailCount+" email addresses separated by commas"),i.Db(2),i.lc("ngIf",null==e.errors?null:e.errors.maxEmailsExceeded),i.Db(1),i.lc("ngIf",null==e.errors?null:e.errors.invalidEmails),i.Db(1),i.lc("ngIf",n.form.get("roleId"))}}function oT(e,t){if(1&e&&i.Ic(0,sT,9,7,"ng-container",9),2&e){const e=i.gc();i.lc("ngIf",e.form.get("emails"))}}function rT(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",29),i.cc("click",(function(){return i.xc(e),i.gc(2).handleCancelClick()})),i.Kc(1),i.Ub()}if(2&e){const e=i.gc(2);i.lc("uppercase","inline"===e.layout),i.Db(1),i.Mc(" ",e.cancelText," ")}}function aT(e,t){if(1&e){const e=i.Wb();i.Vb(0,"button",30),i.cc("click",(function(){return i.xc(e),i.gc(2).handleInviteClick()})),i.hc(1,"async"),i.Kc(2),i.Ub()}if(2&e){const e=i.gc(2);i.lc("uppercase","inline"===e.layout)("disabled",e.form.invalid||i.ic(1,3,e.inviting$)),i.Db(2),i.Mc(" ",e.errorResponses.length>0?"Try Again":e.sendText," ")}}function cT(e,t){1&e&&i.Rb(0)}function lT(e,t){1&e&&i.Rb(0)}function pT(e,t){if(1&e&&(i.Tb(0),i.Ic(1,cT,1,0,"ng-container",31),i.Ic(2,lT,1,0,"ng-container",31),i.Sb()),2&e){i.gc();const e=i.tc(3),t=i.tc(5);i.Db(1),i.lc("ngTemplateOutlet",e),i.Db(1),i.lc("ngTemplateOutlet",t)}}function dT(e,t){1&e&&i.Rb(0)}function uT(e,t){1&e&&i.Rb(0)}function gT(e,t){if(1&e&&(i.Ic(0,dT,1,0,"ng-container",31),i.Ic(1,uT,1,0,"ng-container",31)),2&e){i.gc();const e=i.tc(5),t=i.tc(3);i.lc("ngTemplateOutlet",e),i.Db(1),i.lc("ngTemplateOutlet",t)}}function hT(e,t){if(1&e&&(i.Vb(0,"div"),i.Vb(1,"div",25),i.Ic(2,rT,2,2,"ng-template",null,26,i.Jc),i.Ic(4,aT,3,5,"ng-template",null,27,i.Jc),i.Ic(6,pT,3,2,"ng-container",2),i.Ic(7,gT,2,2,"ng-template",null,28,i.Jc),i.Ub(),i.Ub()),2&e){const e=i.tc(8),t=i.gc();i.Db(6),i.lc("ngIf","inline"===t.layout)("ngIfElse",e)}}const bT=["*"];let mT=(()=>{class e{constructor(e,t,n,s){this.store=e,this.actions=t,this.formBuilder=n,this.changeRef=s,this.maxEmailCount=50,this.availableRoles=[],this.layout="inline",this.enableActions=!0,this.sendText="Send invites",this.cancelText="Cancel",this.inviteSent=new i.p,this.inviteCancelled=new i.p,this.ngUnsubscribe=new k.a,this.sent=!1,this.sentResponses=[],this.errorResponses=[]}get valid(){return this.form.valid}ngOnInit(){this.initForm(),this.initInviteListeners()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initForm(){this.store.dispatch(new Jb),this.currentUserRole=this.store.selectSnapshot(py.getUserRole),this.userRoles$.pipe(Object(I.a)(e=>e.length>0),Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.availableRoles=e.filter(e=>sf.indexOf(e.role_name)<=sf.indexOf(this.currentUserRole.role_name)),this.changeRef.markForCheck()}),this.form=this.formBuilder.group({emails:["",Du.t.required,Lz(this.maxEmailCount).bind(this)],roleId:["",Du.t.required]})}initInviteListeners(){this.actions.pipe(Object(d.j)(az),Object(M.a)(this.ngUnsubscribe)).subscribe(()=>{this.resetState(),this.changeRef.markForCheck()}),this.actions.pipe(Object(d.j)(cz),Object(M.a)(this.ngUnsubscribe)).subscribe(({responses:e})=>{this.resetState(),this.sentResponses=e.filter(e=>"success"===e.status),this.errorResponses=e.filter(e=>"error"===e.status),this.sent=0===this.errorResponses.length,this.sent&&this.inviteSent.next(e),this.changeRef.markForCheck()}),this.actions.pipe(Object(d.j)(lz,km),Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.resetState(),this.errorMessage=Az(e.error)||"There was an error sending the invites, please try again.",this.changeRef.markForCheck()})}handleCancelClick(){this.inviteCancelled.next()}backToFormClick(){this.resetState(),this.changeRef.markForCheck()}handleInviteClick(){const{eid:e}=this.organization,t=Rg.parseEmails(this.form.value.emails).map(e=>({user_email:e,role_id:parseInt(this.form.value.roleId,10)}));this.store.dispatch(new az(e,t))}formatEmails(e){return e.join(", ")}formatResponses(e){const t=e.map(e=>e.reason);return[...new Set([...t])].map(t=>{const n=e.filter(e=>e.reason===t).map(e=>e.email),i=this.formatEmails(n);return`"${t}": ${i}`})}resetState(){this.sent=!1,this.sentResponses=[],this.errorResponses=[],this.errorMessage=""}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.g),i.Pb(d.b),i.Pb(Du.e),i.Pb(i.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-team-invite"]],inputs:{organization:"organization",layout:"layout",enableActions:"enableActions",sendText:"sendText",cancelText:"cancelText"},outputs:{inviteSent:"inviteSent",inviteCancelled:"inviteCancelled"},ngContentSelectors:bT,decls:8,vars:7,consts:[[1,"invite"],[1,"theme-light"],[4,"ngIf","ngIfElse"],["sendFormTmp",""],[4,"ngIf"],[1,"invite__footer"],["class","mv-1",4,"ngIf"],[1,"mv-1"],["data-test","teamInviteSuccess","type","message"],[3,"formGroup",4,"ngIf"],[3,"formGroup"],["class","mb-4",4,"ngIf"],["theme","light","label","Invite via email"],["formControlName","emails","data-test","teamInviteEmails","rows","8",1,"invite__input","input",3,"placeholder"],["class","mt-1",4,"ngIf"],["theme","light","label","Role",4,"ngIf"],[1,"mb-4"],["type","error"],[4,"ngFor","ngForOf"],[1,"mt-1"],["theme","light","label","Role"],["formControlName","roleId",1,"input"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"invite__buttons"],["cancelBtnTmp",""],["sendBtnTmp",""],["blockBtnTmp",""],["app-button","","buttonSize","large","buttonTheme","light","buttonType","default","data-test","skipInvitesButton",1,"invite__button",3,"uppercase","click"],["app-button","","buttonSize","large","buttonType","primary","data-test","sendInvitesButton",1,"invite__button",3,"uppercase","disabled","click"],[4,"ngTemplateOutlet"]],template:function(e,t){if(1&e&&(i.kc(),i.Vb(0,"div",0),i.Vb(1,"div",1),i.Ic(2,Gz,2,1,"ng-container",2),i.Ic(3,oT,1,1,"ng-template",null,3,i.Jc),i.Ub(),i.Ic(5,hT,9,2,"div",4),i.Vb(6,"div",5),i.jc(7,0,["[select]","invite - footer"]),i.Ub(),i.Ub()),2&e){const e=i.tc(4);i.Hb("invite--inline","inline"===t.layout)("invite--block","block"===t.layout),i.Db(2),i.lc("ngIf",t.sent)("ngIfElse",e),i.Db(3),i.lc("ngIf",t.enableActions&&!t.sent)}},directives:[Z.l,Gx,Du.o,Du.i,Qz,Du.c,Du.n,Du.h,Z.k,$z.b,Du.s,Du.q,Du.u,ud,Z.q],pipes:[Z.b],styles:[".invite__input[_ngcontent-%COMP%]{resize:vertical}.invite__actions[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:center}.invite__actions--compact[_ngcontent-%COMP%]{justify-content:flex-end}.invite__buttons[_ngcontent-%COMP%]{display:flex;flex-direction:row;margin:8px auto}.invite--inline[_ngcontent-%COMP%]   .invite__button[_ngcontent-%COMP%]{margin-left:16px}.invite--inline[_ngcontent-%COMP%]   .invite__buttons[_ngcontent-%COMP%]{justify-content:flex-end}.invite--block[_ngcontent-%COMP%]   .invite__button[_ngcontent-%COMP%]{margin:16px 0}.invite--block[_ngcontent-%COMP%]   .invite__buttons[_ngcontent-%COMP%]{justify-content:flex-end;flex-direction:column}"],changeDetection:0}),qz([Object(d.d)(Dz.getInviting),Wz("design:type",P.a)],e.prototype,"inviting$",void 0),qz([Object(d.d)(py.getUserRoles),Wz("design:type",P.a)],e.prototype,"userRoles$",void 0),e})();var fT=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let yT=(()=>{class e{constructor(e,t){this.dialogRef=e,this.data=t,this.sent=!1,this.sentResponses=[],this.errorResponses=[],this.ngUnsubscribe=new k.a,this.organization=t.organization}ngOnInit(){}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}handleInviteSent(e){setTimeout(()=>{this.inviteComplete()},5e3)}handleInviteCancelled(){this.inviteComplete()}inviteComplete(){this.dialogRef.close()}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(nl.g),i.Pb(nl.a))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-team-invite-dialog"]],decls:10,vars:3,consts:[[1,"dialog"],["mat-dialog-title",""],[1,"flex","flex-row","justify-between"],["app-button","","buttonType","text","buttonTheme","light","type","button","title","Close",3,"click"],["icon","times","size","lg"],["mat-dialog-content","",1,"theme-light","p-6"],["sentText","Send invites","cancelText","Cancel",3,"organization","layout","inviteSent","inviteCancelled"]],template:function(e,t){1&e&&(i.Vb(0,"div",0),i.Vb(1,"div",1),i.Vb(2,"div",2),i.Vb(3,"h1"),i.Kc(4,"Invite Members"),i.Ub(),i.Vb(5,"button",3),i.cc("click",(function(){return t.handleInviteCancelled()})),i.Qb(6,"app-icon",4),i.Ub(),i.Ub(),i.Ub(),i.Qb(7,"mat-divider"),i.Vb(8,"div",5),i.Vb(9,"app-team-invite",6),i.cc("inviteSent",(function(e){return t.handleInviteSent(e)}))("inviteCancelled",(function(){return t.handleInviteCancelled()})),i.Ub(),i.Ub(),i.Ub()),2&e&&(i.Db(5),i.Eb("aria-label","Close"),i.Db(4),i.lc("organization",t.organization)("layout","inline"))},directives:[nl.h,ud,dl,md.a,nl.e,mT],styles:[".dialog[_ngcontent-%COMP%]{width:480px;min-height:320px}.dialog__input[_ngcontent-%COMP%]{resize:vertical}.dialog__actions[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:center}.dialog__actions--compact[_ngcontent-%COMP%]{justify-content:flex-end}@media (max-width:480px){.dialog[_ngcontent-%COMP%]{width:100%}}"],changeDetection:0}),function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);o>3&&r&&Object.defineProperty(t,n,r)}([Object(d.d)(Dz.getInviting),fT("design:type",P.a)],e.prototype,"inviting$",void 0),e})(),xT=(()=>{class e{constructor(){}}return e.type="[Share] Reset",e})(),vT=(()=>{class e{constructor(e){this.shareEmail=e}}return e.type="[Share] Share Email Link",e})(),OT=(()=>{class e{constructor(e){this.shareEmail=e}}return e.type="[Share] Share Email Link Success",e})(),wT=(()=>{class e{constructor(e){this.error=e}}return e.type="[Share] Share Email Link Fail",e})();class CT{}var ST=function(e){return e.Facebook="facebook",e.LinkedIn="linkedin",e.Twitter="twitter",e}({}),_T=function(e){return e.Model="model",e.Quiz="quiz",e}({});let jT=(()=>{class e{constructor(e,t){this.http=e,this.APP_BASE_URL=t}shareEmailLink(e){return this.http.post("/ws/user/share/email",e)}generateShareLink(e,t="en"){const n=e.thumbnail_url.replace("/small/","/large/");return{type:e.quiz?_T.Quiz:_T.Model,title:e.title,relativeUrl:this.createShareUrl(e,"share",t,!1,!1),fullUrl:this.createShareUrl(e,"share",t,!0,!1),thumbUrl:n,social:[{type:ST.Facebook,url:"https://www.facebook.com/sharer/sharer.php?u="+this.createShareUrl(e,ST.Facebook,t,!0,!0)},{type:ST.LinkedIn,url:"https://www.linkedin.com/sharing/share-offsite/?url="+this.createShareUrl(e,ST.LinkedIn,t,!0,!0)},{type:ST.Twitter,url:"http://twitter.com/share?url="+this.createShareUrl(e,ST.Twitter,t,!0,!0)}]}}createShareUrl(e,t,n,i,s){const o=e.id.replace(".json",""),r=Object.values(ST).includes(t),a=`/view?id=${o}&lang=${n}&ref=${t}`,c=i||r?`${r?"https://human.biodigital.com":this.APP_BASE_URL}${a}`:a;return s?encodeURIComponent(c):c}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(v.b),i.Zb(nC))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var kT=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},PT=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const MT={sharing:!1};let IT=(()=>{let e=class{constructor(e,t,n){this.shareService=e,this.productService=t,this.authService=n}static getSharing(e){return e.sharing}resetShare(e,t){e.setState(MT)}sendEmail(e,{shareEmail:t}){e.patchState({sharing:!0}),this.authService.isHuman("share_email",!0).pipe(Object(vn.a)(t=>{t.isHuman||e.dispatch(new km(new Error("reCAPTCHA error. Refresh the page and try again.")))}),Object(I.a)(e=>e.isHuman),Object(Us.b)(e=>this.shareService.shareEmailLink(Object.assign({version:4,app_productkey:this.productService.productKey,app_producttype:this.productService.productType,site_verify_response:e.verification},t))),Object(Mr.a)(()=>e.patchState({sharing:!1}))).subscribe(()=>e.dispatch(new OT(t)),t=>e.dispatch(new wT(t)))}};return e.\u0275fac=function(t){return new(t||e)(i.Zb(jT),i.Zb(mf),i.Zb(yf))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac}),kT([Object(d.a)(xT),PT("design:type",Function),PT("design:paramtypes",[Object,xT]),PT("design:returntype",void 0)],e.prototype,"resetShare",null),kT([Object(d.a)(vT),PT("design:type",Function),PT("design:paramtypes",[Object,vT]),PT("design:returntype",void 0)],e.prototype,"sendEmail",null),kT([Object(d.e)(),PT("design:type",Function),PT("design:paramtypes",[CT]),PT("design:returntype",void 0)],e,"getSharing",null),e=kT([Object(d.f)({name:"share",defaults:MT})],e),e})();var zT=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const TT=["emailField"];function UT(e,t){1&e&&(i.Tb(0),i.Vb(1,"div",11),i.Vb(2,"app-message-toggle",12),i.Kc(3," Your email was successfully sent. "),i.Ub(),i.Ub(),i.Sb())}function DT(e,t){if(1&e&&(i.Vb(0,"div",11),i.Vb(1,"app-message-toggle",20),i.Kc(2),i.Ub(),i.Ub()),2&e){const e=i.gc(2);i.Db(2),i.Mc(" ",e.errorMessage," ")}}function LT(e,t){1&e&&i.Qb(0,"app-spinner",21)}function ET(e,t){1&e&&(i.Vb(0,"div",24),i.Vb(1,"mat-error"),i.Kc(2,"Please enter a valid email address."),i.Ub(),i.Ub())}function FT(e,t){if(1&e&&(i.Vb(0,"div",26),i.Vb(1,"mat-error"),i.Kc(2),i.Ub(),i.Ub()),2&e){const e=i.gc(2).$implicit,t=i.gc(2);i.Db(2),i.Nc(" Maximum email addresses excceeded, ",e.currentEmailCount," of ",t.maxEmailCount," max. ")}}function AT(e,t){if(1&e&&i.Ic(0,FT,3,2,"div",25),2&e){const e=i.gc().$implicit;i.lc("ngIf",e.maxEmailsExceeded)}}function RT(e,t){if(1&e&&(i.Tb(0),i.Ic(1,ET,3,0,"div",22),i.Ic(2,AT,1,1,"ng-template",null,23,i.Jc),i.Sb()),2&e){const e=t.$implicit,n=i.tc(3);i.Db(1),i.lc("ngIf",e.invalidEmails)("ngIfElse",n)}}function VT(e,t){if(1&e){const e=i.Wb();i.Ic(0,DT,3,1,"div",13),i.Vb(1,"form",14),i.cc("submit",(function(){i.xc(e);const t=i.gc();return t.submitForm(t.config.shareLink)})),i.Vb(2,"textarea",15,16),i.Kc(4,"        "),i.Ub(),i.Vb(5,"button",17),i.hc(6,"async"),i.hc(7,"async"),i.Ic(8,LT,1,0,"app-spinner",18),i.hc(9,"async"),i.Kc(10),i.hc(11,"async"),i.Ub(),i.Ub(),i.Ic(12,RT,4,2,"ng-container",19)}if(2&e){const e=i.gc();i.lc("ngIf",e.errorMessage),i.Db(1),i.lc("formGroup",e.form),i.Db(4),i.lc("disabled",!e.form.valid||i.ic(6,8,e.sharing$))("loading",i.ic(7,10,e.sharing$)),i.Eb("aria-label","Send Email"),i.Db(3),i.lc("ngIf",i.ic(9,12,e.sharing$)),i.Db(2),i.Mc(" ",i.ic(11,14,e.sharing$)?"Sending":"Send Email"," "),i.Db(2),i.lc("ngIf",e.form.get("emails").errors)}}function NT(e,t){if(1&e&&(i.Vb(0,"a",27),i.hc(1,"titlecase"),i.hc(2,"titlecase"),i.Qb(3,"img",6),i.Ub()),2&e){const e=t.$implicit;i.lc("href",e.url,i.Ac)("matTooltip","Share via "+i.ic(2,7,e.type)),i.Eb("aria-label","Share via "+i.ic(1,5,e.type))("data-test",e.type+"LinkButton"),i.Db(3),i.lc("src","/assets/images/social/"+e.type+"-share.svg",i.Ac)}}function BT(e,t){if(1&e&&(i.Vb(0,"p",28),i.Kc(1),i.Ub()),2&e){const e=i.gc();i.Db(1),i.Mc(" ",e.config.description," ")}}let HT=(()=>{class e{constructor(e,t,n,i,s,o,r,a){this.store=e,this.actions=t,this.dialogRef=n,this.data=i,this.clipboardService=s,this.snackBar=o,this.formBuilder=r,this.changeRef=a,this.maxEmailCount=50,this.config={title:"Share"},this.emailSent=!1,this.errorMessage="",this.formError="",this.ngUnsubscribe=new k.a,this.config=Object.assign(Object.assign({},this.config),i),this.initForm()}ngOnInit(){this.initEmailListeners()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initForm(){this.form=this.formBuilder.group({emails:["",Du.t.required,Lz(this.maxEmailCount).bind(this)]})}initEmailListeners(){this.actions.pipe(Object(d.j)(vT),Object(M.a)(this.ngUnsubscribe)).subscribe(()=>{this.emailSent=!1,this.errorMessage="",this.changeRef.markForCheck()}),this.actions.pipe(Object(d.j)(OT),Object(M.a)(this.ngUnsubscribe)).subscribe(()=>{this.emailSent=!0,this.errorMessage="",setTimeout(()=>{this.emailSent=!1,this.form.setValue({emails:""}),this.changeRef.markForCheck(),setTimeout(()=>this.focus())},5e3),this.changeRef.markForCheck()}),this.actions.pipe(Object(d.j)(wT),Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.emailSent=!1,this.errorMessage=Az(e.error)||"There was an error sending the email.",setTimeout(()=>this.focus()),this.changeRef.markForCheck()})}focus(){var e;const t=null===(e=this.emailField)||void 0===e?void 0:e.nativeElement;t&&t.focus()}submitForm(e){const{type:t,title:n,relativeUrl:i,thumbUrl:s}=e,o=Rg.parseEmails(this.form.value.emails);this.store.dispatch(new vT({share_type:t,share_title:n,share_thumbnail_path:s,share_link_path:i,share_emails:o}))}handleCopyClick(e,t){this.clipboardService.copyToClipboard(e,"url").pipe(Object(M.a)(this.ngUnsubscribe)).subscribe(e=>{this.snackBar.open(`Link ${e?"copied":"not copied"}.`)}),t.preventDefault()}handleCloseClick(){this.dialogRef.close()}}return e.\u0275fac=function(t){return new(t||e)(i.Pb(d.g),i.Pb(d.b),i.Pb(nl.g),i.Pb(nl.a),i.Pb(Mp),i.Pb(id.b),i.Pb(Du.e),i.Pb(i.i))},e.\u0275cmp=i.Jb({type:e,selectors:[["app-share-url-dialog"]],viewQuery:function(e,t){if(1&e&&i.Pc(TT,!0),2&e){let e;i.sc(e=i.dc())&&(t.emailField=e.first)}},decls:14,vars:9,consts:[["role","dialog","aria-modal","true","data-test","shareUrlDialog",1,"share-url-dialog"],[1,"share-url-dialog__title","mb-5"],[4,"ngIf","ngIfElse"],["emailFormTmp",""],[1,"share-url-dialog__social"],["target","_blank","aria-label","Copy Link","matTooltip","Copy Link","matTooltipPosition","below","data-test","copyLinkButton",1,"share-url-dialog__social-link",3,"href","click"],[3,"src"],["class","share-url-dialog__social-link","target","_blank","matTooltipPosition","below",3,"href","matTooltip",4,"ngFor","ngForOf"],["class","share-url-dialog__description mv-3",4,"ngIf"],["app-button","","buttonType","text","buttonTheme","light","type","button","title","Close",1,"share-url-dialog__close",3,"click"],["icon","times","size","lg"],[1,"mv-2"],["type","message"],["class","mv-2",4,"ngIf"],[1,"share-url-dialog__form",3,"formGroup","submit"],["rows","1","formControlName","emails","placeholder","Email, comma separated","data-test","emailEntryField",1,"share-url-dialog__input","input","theme-light"],["emailField",""],["type","submit","app-button","","buttonType","primary","title","'Send Email'","data-test","emailLinkButton",1,"share-url-dialog__submit",3,"disabled","loading"],["size","small","class","mr-2","render","inline",4,"ngIf"],[4,"ngIf"],["type","error"],["size","small","render","inline",1,"mr-2"],["class","mv-1",4,"ngIf","ngIfElse"],["maxEmailErrorTmp",""],[1,"mv-1"],["class","flex flex-column mv-1",4,"ngIf"],[1,"flex","flex-column","mv-1"],["target","_blank","matTooltipPosition","below",1,"share-url-dialog__social-link",3,"href","matTooltip"],[1,"share-url-dialog__description","mv-3"]],template:function(e,t){if(1&e&&(i.Vb(0,"div",0),i.Vb(1,"h2",1),i.Kc(2),i.Ub(),i.Tb(3),i.Ic(4,UT,4,0,"ng-container",2),i.Ic(5,VT,13,16,"ng-template",null,3,i.Jc),i.Sb(),i.Vb(7,"div",4),i.Vb(8,"a",5),i.cc("click",(function(e){return t.handleCopyClick(null==t.config.shareLink?null:t.config.shareLink.fullUrl,e)})),i.Qb(9,"img",6),i.Ub(),i.Ic(10,NT,4,9,"a",7),i.Ub(),i.Ic(11,BT,2,1,"p",8),i.Vb(12,"button",9),i.cc("click",(function(){return t.handleCloseClick()})),i.Qb(13,"app-icon",10),i.Ub(),i.Ub()),2&e){const e=i.tc(6);i.Eb("aria-label",t.config.title+" Dialog"),i.Db(2),i.Mc(" ",t.config.title," "),i.Db(2),i.lc("ngIf",t.emailSent)("ngIfElse",e),i.Db(4),i.lc("href",null==t.config.shareLink?null:t.config.shareLink.fullUrl,i.Ac),i.Db(1),i.lc("src","/assets/images/social/link-share.svg",i.Ac),i.Db(1),i.lc("ngForOf",null==t.config.shareLink?null:t.config.shareLink.social),i.Db(1),i.lc("ngIf",t.config.description),i.Db(1),i.Eb("aria-label","Close")}},directives:[Z.l,ru.c,Z.k,ud,dl,Gx,Du.v,Du.o,Du.i,Du.c,Du.n,Du.h,uu,$z.b],pipes:[Z.b,Z.t],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.share-url-dialog[_ngcontent-%COMP%]{position:relative;max-width:420px}.share-url-dialog__title[_ngcontent-%COMP%]{color:#1c2a3f;font-size:20px;letter-spacing:.5px;line-height:1.4em;font-weight:500}.share-url-dialog__description[_ngcontent-%COMP%]{color:#61779e;font-size:11px;letter-spacing:.275px;line-height:1.4em}.share-url-dialog__form[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;gap:8px}.share-url-dialog__submit[_ngcontent-%COMP%]{flex:1 0 120px}.share-url-dialog__social[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:24px;margin-top:32px;margin-bottom:20px}.share-url-dialog__social-link[_ngcontent-%COMP%]{width:36px;height:36px;border-radius:100%;cursor:pointer}.share-url-dialog__social-link[_ngcontent-%COMP%]:focus{outline:2px solid #2d72dc!important}.share-url-dialog__social-link[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%}.share-url-dialog__input[_ngcontent-%COMP%], .share-url-dialog__input[_ngcontent-%COMP%]:disabled{background-color:#f9fafd;color:#61779e;font-size:12px;letter-spacing:.3px;line-height:1.4em;opacity:1;resize:vertical;max-height:240px}.share-url-dialog__close[_ngcontent-%COMP%]{position:absolute;top:-4px;right:-12px}@media (max-width:480px){.share-url-dialog__form[_ngcontent-%COMP%]{flex-wrap:wrap}}"],changeDetection:0}),function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);o>3&&r&&Object.defineProperty(t,n,r)}([Object(d.d)(IT.getSharing),zT("design:type",P.a)],e.prototype,"sharing$",void 0),e})();const QT={maxWidth:"100vw",width:"100vw",height:"100vh",panelClass:"full-modal"};let $T=(()=>{class e{constructor(e,t,n,i,s,o,r){this.dialog=e,this.engineService=t,this.router=n,this.store=i,this.pendoService=s,this.productService=o,this.organizationsService=r}get isMobile(){return window.innerWidth<=959}openClipboardDialog(e,t){const n=Object.assign({data:{id:bu.ClipboardDialog,copyText:e}},t);return this.dialog.open(JI,n)}openShareDialog(e,t,n){return this.dialog.open(HT,{id:bu.ShareUrlDialog,disableClose:!0,data:{title:t,description:n,shareLink:e},maxWidth:"90vw"})}openConfirmDialog(e){const t=Object.assign({id:bu.ConfirmDialog},e);return this.dialog.open(GI,t)}openLimitDialog(){return this.closeAllDialogs(),this.dialog.open($I,{id:bu.LimitDialog,width:"480px"})}openUpgradeDialog(e=!0){e&&this.closeAllDialogs();const t=this.store.selectSnapshot(py.getUserProfile),n=this.getContactProfileParams(t),i=t.premium_account_valid?t.premium_account_type:"free",s=Object(D.get)(t,"organizations[0].subscription.type","").toLowerCase(),o=this.store.selectSnapshot(PM.isTrialExpired),a=L(t.account_settings);let l;switch(Object(D.get)(a,"account_purpose.value","")){case ez.Business:l="business.html";break;case ez.Education:l="school.html";break;default:l="individual.html"}const p=Object.assign(Object.assign({},n),{accountType:i,subscription:s,expired:o}),d=`${c.native?"":{[r.Local]:"https://localhost:1234",[r.QA]:"https://pricing-qa.biodigital.com",[r.Staging]:"https://pricing.biodigital.com",[r.Production]:"https://pricing.biodigital.com"}[c.deploy]}/${l}?${this.serializeQueryParams(p)}`,u=Object.assign(Object.assign({id:bu.PricingDialog},QT),{data:{title:"Upgrade",url:d,backgroundColor:"#0B1220"}}),g=encodeURIComponent(this.router.url);return this.dialog.open(YI,u).afterClosed().subscribe(e=>{if(e){const t=Object.assign({action:"",plan:""},e.metadata),n={business:["starter","premium","enterprise"],education:["class","institution"]};let i="Individual";Object.entries(n).forEach(([e,n])=>{n.indexOf(t.plan)&&(i=e)}),t.action&&this.pendoService.track(`Pricing - ${Object(D.capitalize)(t.action)} - ${Object(D.capitalize)(t.plan)}`,{platform:this.productService.productType,page:i});let s="";switch(t.action){case"buy":if(c.native)return void this.engineService.fireEvent(At.NativeUpgrade,null);this.router.navigate(["/account/profile"],{queryParams:{section:"subscription",mode:"edit"}});break;case"contact":this.openContactDialog("pricing page");break;case"try":switch(!0){case n.business.includes(t.plan):s="/account/workflow/team/create?purpose=Business&returnTo="+g;break;case n.education.includes(t.plan):s="/account/workflow/team/create?purpose=Education&returnTo="+g;break;default:s="account/workflow"}this.router.navigateByUrl(s)}}else this.pendoService.track("Pricing - Exit")})}openContactDialog(e=""){const t=this.store.selectSnapshot(PM.getOrganization),n=Object(D.isNil)(t)?"":""+t.id,i=this.store.selectSnapshot(py.getUserProfile),s=this.getContactProfileParams(i),o={[r.Local]:"http://craft-sandbox.biodigital.local",[r.QA]:"http://craft-sandbox.biodigital.local",[r.Staging]:"https://www.biodigital.com",[r.Production]:"https://www.biodigital.com"},a=c.native?o[r.Production]:o[c.deploy];if(c.native){const t=this.serializeQueryParams(Object.assign(Object.assign({},s),{organizationId:n,utm_source:"human-mobile",utm_campaign:e}));return window.open(`${a}/contact?${t}`,"_blank")}{const t=`${a}/headless/contact-us?${this.serializeQueryParams(Object.assign(Object.assign({},s),{organizationId:n,utm_source:"human-web",utm_campaign:e}))}`,i=Object.assign(Object.assign({id:bu.ContactDialog},QT),{data:{title:"Contact Us",url:t}});return this.dialog.open(YI,i)}}openPremiumContentDialog(){const e=c.native||!this.isMobile;return this.openConfirmDialog({id:bu.PremiumContentDialog,data:{titleText:"Premium Content",bodyText:e?"This is premium content. Upgrade to a Premium Plan for unlimited access.":"This is premium content. Visit us on desktop to upgrade to a premium plan.",confirmText:"Upgrade Now",confirmEnabled:e,cancelText:"OK",confirmColor:"warn"}})}openAddUserDialog(){const e=this.store.selectSnapshot(PM.getOrganization);this.dialog.open(yT,{id:bu.AddTeamModelDialog,disableClose:!1,data:{organization:e}})}closeAllDialogs(){this.dialog.closeAll()}getContactProfileParams(e){const{first_name:t,last_name:n,email:i}=e,s=Object(D.get)(e,"organizations[0].name",""),o=Object(D.get)(e,"organizations[0].group_attributes",[]),r=L(e.account_settings),a=Object(D.get)(r,"account_purpose.value",""),c=Object(D.get)(r,"account_field.value",""),l=Object(D.get)(r,"account_field.value",""),p=Object(D.get)(r,"account_role.value",""),d=this.organizationsService.getOrganizationAttribute(o,"account_settings","account_company_size"),u=this.organizationsService.getOrganizationAttribute(o,"account_settings","account_company_website");return{first_name:t,last_name:n,email:i,company:s,website:u?u.value:"",purpose:a,role:p,program_type:l,program_size:d?d.value:"",industry:a===ez.Education?"Academia":c}}serializeQueryParams(e){return Object.entries(e).map(([e,t])=>{const n="string"!=typeof t?JSON.stringify(t):t;return`${e}=${encodeURIComponent(n)}`}).join("&")}}return e.\u0275fac=function(t){return new(t||e)(i.Zb(nl.b),i.Zb(Qt),i.Zb(T.e),i.Zb(d.g),i.Zb(G),i.Zb(mf),i.Zb(W))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var qT=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},WT=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let KT=(()=>{let e=class{constructor(e){this.dialogService=e}static getOpenDialog(e){return e.openDialog}openLimit(e,t){this.dialogService.openLimitDialog().afterClosed().subscribe(t=>{e.dispatch(new QI.CloseLimit(t))})}closeLimit(e,t){t.upgrade&&this.dialogService.openUpgradeDialog()}openPremiumContent(e,t){this.dialogService.openPremiumContentDialog().afterClosed().subscribe(t=>{e.dispatch(new QI.ClosePremiumContent(t))})}closePremiumContent(e,t){t.confirmed&&e.dispatch(new QI.OpenUpgrade)}openUpgrade(e,t){this.dialogService.openUpgradeDialog()}};return e.\u0275fac=function(t){return new(t||e)(i.Zb($T))},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac}),qT([Object(d.a)(QI.OpenLimit),WT("design:type",Function),WT("design:paramtypes",[Object,QI.OpenLimit]),WT("design:returntype",void 0)],e.prototype,"openLimit",null),qT([Object(d.a)(QI.CloseLimit),WT("design:type",Function),WT("design:paramtypes",[Object,QI.CloseLimit]),WT("design:returntype",void 0)],e.prototype,"closeLimit",null),qT([Object(d.a)(QI.OpenPremiumContent),WT("design:type",Function),WT("design:paramtypes",[Object,QI.OpenPremiumContent]),WT("design:returntype",void 0)],e.prototype,"openPremiumContent",null),qT([Object(d.a)(QI.ClosePremiumContent),WT("design:type",Function),WT("design:paramtypes",[Object,QI.ClosePremiumContent]),WT("design:returntype",void 0)],e.prototype,"closePremiumContent",null),qT([Object(d.a)(QI.OpenUpgrade),WT("design:type",Function),WT("design:paramtypes",[Object,QI.OpenUpgrade]),WT("design:returntype",void 0)],e.prototype,"openUpgrade",null),qT([Object(d.e)(),WT("design:type",Function),WT("design:paramtypes",[HI]),WT("design:returntype",void 0)],e,"getOpenDialog",null),e=qT([Object(d.f)({name:"dialog",defaults:{openDialog:null}})],e),e})(),GT=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[Z.c,UP,rM,Du.r]]}),e})(),ZT=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[Z.c,UP,rM,Du.r]]}),e})(),JT=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[Z.c,UP,rM,Du.r]]}),e})(),XT=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[Z.c,UP,rM]]}),e})(),YT=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[Z.c,UP,Du.j,Du.r,rM]]}),e})(),eU=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[Z.c,UP,rM,Du.r]]}),e})(),tU=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[Z.c,UP,rM,Du.r]]}),e})(),nU=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[Z.c,UP,LP,qP]]}),e})();var iU=n("1y1q");let sU=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[Z.c,rM,UP,IP.a,kI,iU.a]]}),e})(),oU=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[Z.c,UP,Du.j,XP,Du.r,ZP,qP,sU,tM]]}),e})(),rU=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[Z.c,UP,rM,Du.r,oU]]}),e})(),aU=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[Z.c,UP,rM,Du.r]]}),e})(),cU=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[Z.c,UP,rM,Du.r]]}),e})(),lU=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[Z.c,UP,rM,Du.r]]}),e})(),pU=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[Z.c,UP,rM,Du.r]]}),e})(),dU=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[Z.c,UP,rM,Du.r]]}),e})(),uU=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[Z.c,UP,rM,Du.j,Du.r]]}),e})(),gU=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[d.c.forFeature([KT]),TI,UI,DI,LI,EI,dU,FI,AI,nU,RI,VI,NI,BI,GT,ZT,JT,XT,YT,eU,tU,rU,lU,pU,tM,XP,rM],TI,UI,DI,LI,EI,dU,FI,AI,nU,RI,VI,NI,BI,GT,rU,ZT,JT,XT,YT,eU,tU,aU,cU,lU,pU,SI,uU]}),e})();const hU=[];let bU=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[T.f.forChild(hU)],T.f]}),e})(),mU=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[Z.c]]}),e})(),fU=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[Z.c,LP]]}),e})(),yU=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[Z.c,UP,qP,WP,LP,kI,EP,Du.r,PI,ZP]]}),e})(),xU=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[d.c.forFeature([mr]),Pd.a.forChild(),U.d,Z.c,II,bU,UP,Du.r,Du.j,qP,WP,LP,YP,eM,mU,GP,ZP,KP,Vg.b,DM,MI,kI,rM,fU,PI,yU,Tl.a]]}),e})(),vU=(()=>{class e{intercept(e,t){return t.handle(e).pipe(Object(F.a)(e=>(e instanceof v.e&&e.body&&e.body.hasOwnProperty("results")&&(e=e.clone({body:e.body.results})),e)))}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac}),e})(),OU=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},providers:[uj],imports:[[d.c.forFeature([_]),Z.c,rM]]}),e})(),wU=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[Z.c,T.f,qP,WP,LP]]}),e})(),CU=(()=>{class e{parse(e){e=e.replace(/&amp;/g,"&");const t=(new T.b).parse(e);return this.ensureQueryParam(t.queryParams,"dk",e),this.ensureQueryParam(t.queryParams,"uaid",e),t}serialize(e){return(new T.b).serialize(e).replace(/%2F/g,"/")}ensureQueryParam(e,t,n){if(e.hasOwnProperty(t))return e;const i=this.getParameterByName(t,n);return null!==i&&(e[t]=i),e}getParameterByName(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");const n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac}),e})(),SU=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[d.c.forFeature([Ja]),Z.c]]}),e})(),_U=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[d.c.forFeature([hO]),Z.c]]}),e})();var jU=n("OnMO");function kU(){const e=new jU.Renderer;return e.link=(e,t,n)=>{var i;return`<a href="${(i=e).match(/^(?:(?:(?:ht)tps?):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i)?i:""}" target="_blank" rel="noreferrer nofollow">${n}</a>`},e.paragraph=e=>`<p>${e}</p>`,e.image=(e,t,n)=>"",{renderer:e,gfm:!1}}let PU=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[Z.c,Pd.a.forRoot({markedOptions:{provide:Pd.d,useFactory:kU}})]]}),e})(),MU=(()=>{class e{constructor(){}static forRoot(t){return{ngModule:e,providers:[G,{provide:"pendoConfig",useValue:t}]}}}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[]]}),e})(),IU=(()=>{class e{}return e.\u0275mod=i.Nb({type:e}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},imports:[[Z.c,d.c.forFeature([Bj])]]}),e})();immer.enableAllPlugins(),immer.enableES5();const zU=[{provide:v.a,useClass:vU,multi:!0},{provide:T.h,useClass:CU},{provide:Z.a,useValue:"./"},{provide:Z.h,useClass:Z.e}],TU=[{provide:v.a,useClass:vU,multi:!0},{provide:T.h,useClass:CU}];let UU=(()=>{class e{}return e.\u0275mod=i.Nb({type:e,bootstrap:[Dg]}),e.\u0275inj=i.Mb({factory:function(t){return new(t||e)},providers:!0===c.offline?zU:TU,imports:[[d.c.forRoot(),SU,ge.forRoot(),U.d.forRoot(c.googleAnalyticsId),MU.forRoot({enabled:!0,pendoId:c.pendoId,whitelist:{[s.Viewer]:c.deploy===r.Production?["48Ab","3FZO","3FN2","3Hb8","3FQJ","3FQU","38fD","3wgE","3gLk","3vSx","3XdS","3SOp","3Um8","3hOe","3QWH","4C1Q","3WvE","3epq","3Dyq","3O47","3DJ4","3fKF","3gLf","3PVx","3caY","3cTn","3tVK","3Yau","3QSx","3ZY5","3Z6w","3IF5","3fKs","45y8","3fLN","3QpZ","3J6C","3adO","3Z6v","3hjc","3a50","4EBE","44FH","3WlU","3atu","4E2N","4Bma","43bE","3xxi","3CT7","4D5X","3UVi","3T7X","3QT8","3NG8","3gyj","3UWt","3UWc"]:["production/maleAdult/coronavirus_protein_structure","production/maleAdult/eyeAnatomyTour","production/maleAdult/acute_lymphoblastic_leukemia","production/maleAdult/abdominal_aortic_aneurysm"]},idPrefixes:{[r.Local]:"local-",[r.QA]:"qa-",[r.Staging]:"staging-",[r.Production]:""}}),PU,l.a,p.b,v.c,II,DM,_I,zI,MI,_U,gU,xU,wU,OU,IU,rC,vP]]}),e})();c.production&&Object(i.V)(),l.d().bootstrapModule(UU).catch(e=>console.error(e))},qpAl:function(e,t){!function(t){var n="Modernizr"in t,i=t.Modernizr;!function(e,t,n,i){function s(e,t){return typeof e===t}function o(e,t){return!!~(""+e).indexOf(t)}function r(){return"function"!=typeof n.createElement?n.createElement(arguments[0]):x?n.createElementNS.call(n,"http://www.w3.org/2000/svg",arguments[0]):n.createElement.apply(n,arguments)}function a(e,t,i,s){var o,a,c,l,p="modernizr",d=r("div"),u=function(){var e=n.body;return e||((e=r(x?"svg":"body")).fake=!0),e}();if(parseInt(i,10))for(;i--;)(c=r("div")).id=s?s[i]:p+(i+1),d.appendChild(c);return(o=r("style")).type="text/css",o.id="s"+p,(u.fake?u:d).appendChild(o),u.appendChild(d),o.styleSheet?o.styleSheet.cssText=e:o.appendChild(n.createTextNode(e)),d.id=p,u.fake&&(u.style.background="",u.style.overflow="hidden",l=y.style.overflow,y.style.overflow="hidden",y.appendChild(u)),a=t(d,e),u.fake&&u.parentNode?(u.parentNode.removeChild(u),y.style.overflow=l):d.parentNode.removeChild(d),!!a}function c(e){return e.replace(/([A-Z])/g,(function(e,t){return"-"+t.toLowerCase()})).replace(/^ms-/,"-ms-")}function l(e,n){var s=e.length;if("CSS"in t&&"supports"in t.CSS){for(;s--;)if(t.CSS.supports(c(e[s]),n))return!0;return!1}if("CSSSupportsRule"in t){for(var o=[];s--;)o.push("("+c(e[s])+":"+n+")");return a("@supports ("+(o=o.join(" or "))+") { #modernizr { position: absolute; } }",(function(e){return"absolute"===function(e,n,i){var s;if("getComputedStyle"in t){s=getComputedStyle.call(t,e,null);var o=t.console;null!==s?s=s.getPropertyValue(i):o&&o[o.error?"error":"log"].call(o,"getComputedStyle returning null, its possible modernizr test results are inaccurate")}else s=e.currentStyle&&e.currentStyle[i];return s}(e,0,"position")}))}return i}function p(e){return e.replace(/([a-z])-([a-z])/g,(function(e,t,n){return t+n.toUpperCase()})).replace(/^-/,"")}function d(e,t,n,a){function c(){u&&(delete C.style,delete C.modElem)}if(a=!s(a,"undefined")&&a,!s(n,"undefined")){var d=l(e,n);if(!s(d,"undefined"))return d}for(var u,g,h,b,m,f=["modernizr","tspan","samp"];!C.style&&f.length;)u=!0,C.modElem=r(f.shift()),C.style=C.modElem.style;for(h=e.length,g=0;g<h;g++)if(m=C.style[b=e[g]],o(b,"-")&&(b=p(b)),C.style[b]!==i){if(a||s(n,"undefined"))return c(),"pfx"!==t||b;try{C.style[b]=n}catch(e){}if(C.style[b]!==m)return c(),"pfx"!==t||b}return c(),!1}function u(e,t){return function(){return e.apply(t,arguments)}}function g(e,t,n,i,o){var r=e.charAt(0).toUpperCase()+e.slice(1),a=(e+" "+O.join(r+" ")+r).split(" ");return s(t,"string")||s(t,"undefined")?d(a,t,i,o):function(e,t,n){var i;for(var o in e)if(e[o]in t)return!1===n?e[o]:s(i=t[e[o]],"function")?u(i,n||t):i;return!1}(a=(e+" "+S.join(r+" ")+r).split(" "),t,n)}var h=[],b={_version:"3.11.8",_config:{classPrefix:"",enableClasses:!0,enableJSClass:!0,usePrefixes:!0},_q:[],on:function(e,t){var n=this;setTimeout((function(){t(n[e])}),0)},addTest:function(e,t,n){h.push({name:e,fn:t,options:n})},addAsyncTest:function(e){h.push({name:null,fn:e})}},m=function(){};m.prototype=b,m=new m;var f=[],y=n.documentElement,x="svg"===y.nodeName.toLowerCase(),v="Moz O ms Webkit",O=b._config.usePrefixes?v.split(" "):[];b._cssomPrefixes=O;var w={elem:r("modernizr")};m._q.push((function(){delete w.elem}));var C={style:w.elem.style};m._q.unshift((function(){delete C.style}));var S=b._config.usePrefixes?v.toLowerCase().split(" "):[];b._domPrefixes=S,b.testAllProps=g;var _=function(e){var n,s=prefixes.length,o=t.CSSRule;if(void 0===o)return i;if(!e)return!1;if((n=(e=e.replace(/^@/,"")).replace(/-/g,"_").toUpperCase()+"_RULE")in o)return"@"+e;for(var r=0;r<s;r++){var a=prefixes[r];if(a.toUpperCase()+"_"+n in o)return"@-"+a.toLowerCase()+"-"+e}return!1};b.atRule=_;var j=b.prefixed=function(e,t,n){return 0===e.indexOf("@")?_(e):(-1!==e.indexOf("-")&&(e=p(e)),t?g(e,t,n):g(e,"pfx"))};m.addTest("fullscreen",!(!j("exitFullscreen",n,!1)&&!j("cancelFullScreen",n,!1))),function(){var e,t,n,i,o,r;for(var a in h)if(h.hasOwnProperty(a)){if(e=[],(t=h[a]).name&&(e.push(t.name.toLowerCase()),t.options&&t.options.aliases&&t.options.aliases.length))for(n=0;n<t.options.aliases.length;n++)e.push(t.options.aliases[n].toLowerCase());for(i=s(t.fn,"function")?t.fn():t.fn,o=0;o<e.length;o++)1===(r=e[o].split(".")).length?m[r[0]]=i:(m[r[0]]&&(!m[r[0]]||m[r[0]]instanceof Boolean)||(m[r[0]]=new Boolean(m[r[0]])),m[r[0]][r[1]]=i),f.push((i?"":"no-")+r.join("-"))}}(),function(e){var t=y.className,n=m._config.classPrefix||"";if(x&&(t=t.baseVal),m._config.enableJSClass){var i=new RegExp("(^|\\s)"+n+"no-js(\\s|$)");t=t.replace(i,"$1"+n+"js$2")}m._config.enableClasses&&(e.length>0&&(t+=" "+n+e.join(" "+n)),x?y.className.baseVal=t:y.className=t)}(f),delete b.addTest,delete b.addAsyncTest;for(var k=0;k<m._q.length;k++)m._q[k]();e.Modernizr=m}(t,t,document),e.exports=t.Modernizr,n?t.Modernizr=i:delete t.Modernizr}(window)},zn8P:function(e,t){function n(e){return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}))}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id="zn8P"}},[[0,0,5]]]);