"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[450],{47450:(le,ie,l)=>{l.r(ie),l.d(ie,{ViewInternalModule:()=>h1});var p=l(60177),k=l(18617),L=l(76549),N=l(11818),T=l(39685),W=l(89511),ae=l(16515),B=l(72026),ne=l(73845),Y=l(35286),X=l(45189),c=l(92014),Te=l(82192),e=l(54438);let De=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=e.$C({type:n});static#i=this.\u0275inj=e.G2t({imports:[p.MD,B.o]})}return n})();var $=l(46374),ge=l(6049),re=l(42887),he=l(59162),K=l(42617),Z=l(89417),mt=l(21604),U=l(10381),S=l(18824),se=l(90556),h=l(89079),P=l(65985),Ee=l(87947),ce=l(27180),me=l(90699),F=l(39358),j=l(14823),Xe=l(59369),oe=l(12637),D=l(26779);function Qe(n,_){if(1&n){const t=e.RV6();e.j41(0,"button",1),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.handleFullscreenClick())}),e.j41(1,"span",2),e.EFF(2),e.k0s(),e.nrm(3,"app-icon",3),e.k0s()}if(2&n){const t=e.XpG();e.Y8G("buttonSize",t.buttonSize())("matTooltip",t.fullscreenToggleTooltip()),e.R7$(2),e.JRh(t.fullscreenToggleTooltip()),e.R7$(),e.Y8G("icon",t.isFullscreen()?"compress":"expand")}}function Pt(n,_){if(1&n){const t=e.RV6();e.qex(0),e.j41(1,"button",5),e.bIt("click",function(){e.eBV(t);const o=e.XpG(2);return e.Njj(o.handleNewTabClick())}),e.nrm(2,"app-icon",6),e.k0s(),e.bVm()}if(2&n){const t=e.XpG(2);e.R7$(),e.Y8G("buttonSize",t.buttonSize())}}function ft(n,_){if(1&n&&e.DNE(0,Pt,3,1,"ng-container",4),2&n){const t=e.XpG();e.Y8G("appFlagApplication",t.application.All)("appFlagApplicationMode","exclude")("appFlagApplicationNative",t.nativePlatform.All)}}let Ye=(()=>{class n{constructor(t){this.viewService=t,this.nativePlatform=me.I,this.application=ce.c,this.buttonSize=(0,e.hFB)(P.Mp.Default),this.isFullscreen=(0,e.vPA)(!1),this.canFullscreen=(0,e.vPA)(!1),this.fullscreenToggleTooltip=(0,e.EWP)(()=>this.isFullscreen()?$localize`Exit Fullscreen`:$localize`Enter Fullscreen`),this.canFullscreen.set(Ee.g.canFullscreen());const i=(0,h.ot)(Ee.g.onFullscreenChange(),{initialValue:Ee.g.isFullscreen()});(0,e.QZP)(()=>{const o=i();this.isFullscreen.set(o)},{allowSignalWrites:!0})}handleFullscreenClick(){Ee.g.toggleFullscreen()}handleNewTabClick(){this.viewService.openInNewTab()}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(F.z))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-view-fullscreen"]],inputs:{buttonSize:[1,"buttonSize"]},standalone:!0,features:[e.aNF],decls:2,vars:1,consts:()=>{let t;return t=$localize`:␟0ced11d3928af0572f10cfd084c3f86347d3af60␟6283253681872253092:Open in New Tab`,[["appPreventFadeout","","app-view-button","","data-test","viewFullscreenButton","matTooltipPosition","left",3,"buttonSize","matTooltip"],["appPreventFadeout","","app-view-button","","data-test","viewFullscreenButton","matTooltipPosition","left",3,"click","buttonSize","matTooltip"],[1,"sr-only"],["size","lg",3,"icon"],[4,"appFlagApplication","appFlagApplicationMode","appFlagApplicationNative"],["appPreventFadeout","","app-view-button","","matTooltip",t,"matTooltipPosition","left","data-test","viewNewTab",3,"click","buttonSize"],["icon","arrow-up-right-from-square"]]},template:function(i,o){1&i&&e.DNE(0,Qe,4,4,"button",0)(1,ft,1,3,"ng-container"),2&i&&e.vxM(o.canFullscreen()?0:1)},dependencies:[p.MD,j.uc,j.oV,W.h,Xe.Y,oe.s,B.o,D.R,N.C,P.ri],encapsulation:2,changeDetection:0})}return n})();var V=l(49204),z=l(85052),de=l(82656),M=l(14264),g=l(37925),d=l(2573),Tt=l(17042),b=l(94495);let C=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=e.$C({type:n});static#i=this.\u0275inj=e.G2t({imports:[p.MD,k.Pd,X.G]})}return n})();var H=l(81391),q=l(9065);const Ge=["scrubber"],ct=["track"],bt=["bar"],vt=["handle"],Le=(n,_,t,i)=>({"view-slider--immediate":n,"view-slider--show-track":_,"view-slider--x":t,"view-slider--y":i});let ee=(()=>{class n{get percent(){return this._percent}set percent(t){this._percent=t,this.dragging||(this.setScrubberBar(t),this.setScrubberHandle(t))}get dragging(){return this._dragging}set dragging(t){t!=this.dragging&&(t?this.dragStarted.emit(this.percent):this.dragEnded.emit(this.percent)),this._dragging=t,this.draggingChanged.emit(t)}constructor(t,i){this.renderer=t,this.changeDetectorRef=i,this.accessibleLabel="",this.sliderAxis="x",this.showTrack=!1,this._percent=0,this.percentChanged=new e.bkB,this._dragging=!1,this.animate=!0,this.draggingChanged=new e.bkB,this.dragStarted=new e.bkB,this.dragEnded=new e.bkB,this.trackClicked=new e.bkB,this.ngUnsubscribe=new z.B,this.trackWidth=0,this.dragPosition={x:0,y:0}}ngOnInit(){}ngAfterViewInit(){setTimeout(()=>{this.setScrubberBar(this.percent),this.setScrubberHandle(this.percent)}),this.initDragListener()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initDragListener(){this.dragInstance.moved.pipe((0,q.Z)(20),(0,g.Q)(this.ngUnsubscribe)).subscribe(t=>{this.percent=this.calculateHandlePercent(),this.setScrubberBar(this.percent),this.percentChanged.emit(this.percent)})}handleDragStart(){this.dragging=!0,this.animate=!1}handleDragEnd(){this.dragging=!1,this.animate=!0}handleTrackClick(t){this.animate=!1,this.changeDetectorRef.markForCheck(),setTimeout(()=>{this.percent=this.getClickPercent(t),this.trackClicked.emit(this.percent),this.percentChanged.emit(this.percent),setTimeout(()=>{this.animate=!0})})}handleKeyDown(t){switch(t.key){case"Home":this.increment(-100),t.stopPropagation();break;case"End":this.increment(100),t.stopPropagation();break;case"PageDown":this.increment(-10),t.stopPropagation();break;case"PageUp":this.increment(10),t.stopPropagation();break;case"ArrowLeft":case"ArrowDown":this.increment(-1),t.stopPropagation();break;case"ArrowRight":case"ArrowUp":this.increment(1),t.stopPropagation()}}increment(t){this.percent+=t,this.percent>100&&(this.percent=100),this.percent<0&&(this.percent=0),this.percentChanged.emit(this.percent)}getClickPercent(t){const{height:i,width:o}=this.track.nativeElement.getBoundingClientRect();let s=0;switch(this.sliderAxis){case"x":s=t.offsetX/o*100;break;case"y":s=(i-t.offsetY)/i*100}return s>100&&(s=100),s<0&&(s=0),s}calculateHandlePercent(){const t=this.getTrackWidth(),i=this.scrubber.nativeElement.getBoundingClientRect().left,o=this.handle.nativeElement.getBoundingClientRect().left,s=this.getTrackHeight(),a=this.scrubber.nativeElement.getBoundingClientRect().top,r=this.handle.nativeElement.getBoundingClientRect().top;let u=0;switch(this.sliderAxis){case"x":u=(o-i)/t*100;break;case"y":u=100-(r-a)/s*100}return Math.min(Math.max(u,0),100)}setScrubberBar(t){switch(this.sliderAxis){case"x":this.renderer.setStyle(this.bar.nativeElement,"width",`${t}%`);break;case"y":this.renderer.setStyle(this.bar.nativeElement,"height",`${t}%`)}this.changeDetectorRef.markForCheck()}setScrubberHandle(t){let i,o;switch(this.sliderAxis){case"x":i=this.getTrackWidth(),this.dragPosition={...this.dragPosition,x:i*(t/100)};break;case"y":o=this.getTrackHeight(),this.dragPosition={...this.dragPosition,y:o-o*(t/100)}}this.changeDetectorRef.markForCheck()}getTrackWidth(){const{left:t,right:i}=this.scrubber.nativeElement.getBoundingClientRect();return i-t-this.handle.nativeElement.offsetWidth}getTrackHeight(){const{height:t}=this.scrubber.nativeElement.getBoundingClientRect();return t-this.handle.nativeElement.offsetHeight}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(e.sFG),e.rXU(e.gRc))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-view-slider"]],viewQuery:function(i,o){if(1&i&&(e.GBs(Ge,7),e.GBs(ct,7),e.GBs(bt,7),e.GBs(vt,7),e.GBs(H.T1,5)),2&i){let s;e.mGM(s=e.lsd())&&(o.scrubber=s.first),e.mGM(s=e.lsd())&&(o.track=s.first),e.mGM(s=e.lsd())&&(o.bar=s.first),e.mGM(s=e.lsd())&&(o.handle=s.first),e.mGM(s=e.lsd())&&(o.dragInstance=s.first)}},inputs:{accessibleLabel:"accessibleLabel",sliderAxis:"sliderAxis",showTrack:"showTrack",percent:"percent"},outputs:{percentChanged:"percentChanged",draggingChanged:"draggingChanged",dragStarted:"dragStarted",dragEnded:"dragEnded",trackClicked:"trackClicked"},decls:8,vars:10,consts:[["scrubber",""],["track",""],["bar",""],["handle",""],[1,"view-slider",3,"ngClass"],[1,"view-slider__track",3,"click"],[1,"view-slider__bar"],["cdkDrag","","cdkDragBoundary",".view-slider","role","slider","tabindex","0","aria-valuemin","0","aria-valuemax","100",1,"view-slider__handle",3,"cdkDragStarted","cdkDragEnded","keydown","cdkDragLockAxis","cdkDragFreeDragPosition"]],template:function(i,o){if(1&i){const s=e.RV6();e.j41(0,"div",4,0)(2,"div",5,1),e.bIt("click",function(r){return e.eBV(s),e.Njj(o.handleTrackClick(r))}),e.nrm(4,"div",6,2),e.k0s(),e.j41(6,"div",7,3),e.bIt("cdkDragStarted",function(){return e.eBV(s),e.Njj(o.handleDragStart())})("cdkDragEnded",function(){return e.eBV(s),e.Njj(o.handleDragEnd())})("keydown",function(r){return e.eBV(s),e.Njj(o.handleKeyDown(r))}),e.k0s()()}2&i&&(e.Y8G("ngClass",e.ziG(5,Le,!o.animate,o.showTrack,"x"===o.sliderAxis,"y"===o.sliderAxis)),e.R7$(6),e.Y8G("cdkDragLockAxis",o.sliderAxis)("cdkDragFreeDragPosition",o.dragPosition),e.BMQ("aria-label",o.accessibleLabel)("aria-valuenow",o.percent))},dependencies:[p.YU,H.T1],styles:['.view-slider[_ngcontent-%COMP%]{--height: 28px;--width: 100%;--track-height: 4px;--track-width: 100%;--bar-height: 4px;--bar-width: 0;--handle-height: 28px;--handle-width: 32px;--handle-bulb-size: 12px;--track-color: #d7e0ea;--bar-color: #374a68;--handle-color: transparent;--bar-hover-color: #2d72dc;--handle-hover-color: #2d72dc;--track-hover-color: #d7e0ea;--half-width: calc(var(--handle-width) / 2);--half-height: calc(var(--handle-height) / 2);position:relative;display:flex;justify-content:center;align-items:center;height:var(--height);width:var(--width)}.view-slider[_ngcontent-%COMP%]:hover, .view-slider.view-slider--show-track[_ngcontent-%COMP%]{cursor:pointer}.view-slider[_ngcontent-%COMP%]:hover.view-slider--x, .view-slider.view-slider--show-track.view-slider--x[_ngcontent-%COMP%]{--bar-height: 6px;--track-height: 6px}.view-slider[_ngcontent-%COMP%]:hover.view-slider--y, .view-slider.view-slider--show-track.view-slider--y[_ngcontent-%COMP%]{--bar-width: 6px;--track-width: 6px}.view-slider[_ngcontent-%COMP%]:hover   .view-slider__bar[_ngcontent-%COMP%], .view-slider.view-slider--show-track[_ngcontent-%COMP%]   .view-slider__bar[_ngcontent-%COMP%]{background:var(--bar-hover-color)}.view-slider[_ngcontent-%COMP%]:hover   .view-slider__handle[_ngcontent-%COMP%], .view-slider.view-slider--show-track[_ngcontent-%COMP%]   .view-slider__handle[_ngcontent-%COMP%]{opacity:1}.view-slider[_ngcontent-%COMP%]:hover   .view-slider__handle[_ngcontent-%COMP%]:after, .view-slider.view-slider--show-track[_ngcontent-%COMP%]   .view-slider__handle[_ngcontent-%COMP%]:after{background:var(--handle-hover-color)}.view-slider[_ngcontent-%COMP%]:hover   .view-slider__track[_ngcontent-%COMP%]:after, .view-slider.view-slider--show-track[_ngcontent-%COMP%]   .view-slider__track[_ngcontent-%COMP%]:after{background:var(--track-hover-color)}.view-slider--x[_ngcontent-%COMP%]   .view-slider__track[_ngcontent-%COMP%]{left:var(--half-width);right:var(--half-width)}.view-slider--y[_ngcontent-%COMP%]{--height: 100%;--width: 28px;--track-height: 100%;--track-width: 4px;--bar-height: 0;--bar-width: 4px;--handle-height: 32px;--handle-width: 28px;flex-direction:column-reverse;justify-content:flex-end}.view-slider--y[_ngcontent-%COMP%]:hover{--bar-width: 6px;--track-width: 6px}.view-slider--y[_ngcontent-%COMP%]   .view-slider__bar[_ngcontent-%COMP%]{left:auto}.view-slider--y[_ngcontent-%COMP%]   .view-slider__track[_ngcontent-%COMP%]{flex-direction:column-reverse;top:var(--half-height);bottom:var(--half-height)}.view-slider--immediate[_ngcontent-%COMP%]   .view-slider__bar[_ngcontent-%COMP%], .view-slider--immediate[_ngcontent-%COMP%]   .view-slider__handle[_ngcontent-%COMP%]{transition:none!important}.view-slider__track[_ngcontent-%COMP%]{display:flex;align-items:center;position:absolute;inset:0}.view-slider__track[_ngcontent-%COMP%]:after{content:" ";background:var(--track-color);height:var(--track-height);width:var(--track-width);transition:all .2s ease-in-out,width 50ms}.view-slider__bar[_ngcontent-%COMP%]{border-radius:2px;position:absolute;background:var(--bar-color);height:var(--bar-height);width:var(--bar-width);z-index:2;left:0;transition:all .2s ease-in-out,width 50ms;pointer-events:none}.view-slider__handle[_ngcontent-%COMP%]{width:var(--handle-width);height:var(--handle-height);margin-left:-calc(var(--handle-width)/2);left:0;display:flex;align-items:center;justify-content:center;position:absolute;z-index:2;opacity:0;transition:transform 50ms linear}.view-slider__handle[_ngcontent-%COMP%]:hover:after{transform:scale(1.3)}.view-slider__handle[_ngcontent-%COMP%]:after{opacity:1;content:"";width:var(--handle-bulb-size);height:var(--handle-bulb-size);border-radius:50%;background:var(--handle-color);transition:opacity .25s,transform ease-out .15s}.view-slider__handle-touch[_ngcontent-%COMP%]:after{opacity:1}'],changeDetection:0})}return n})();var Ne=function(n,_,t,i){var a,o=arguments.length,s=o<3?_:null===i?i=Object.getOwnPropertyDescriptor(_,t):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(n,_,t,i);else for(var r=n.length-1;r>=0;r--)(a=n[r])&&(s=(o<3?a(s):o>3?a(_,t,s):a(_,t))||s);return o>3&&s&&Object.defineProperty(_,t,s),s},qe=function(n,_){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(n,_)};class Oe{constructor(_,t,i){this.store=_,this.visibilityLayersService=t,this.changeDetectorRef=i,this.accessibleLabel=$localize`layer slider`,this.percent=100,this.ngUnsubscribe=new z.B}ngOnInit(){this.initIndexPositionObserver()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initIndexPositionObserver(){(0,de.z)([this.selectedChapterCurrentLayersIndex$,this.selectedChapterCurrentLayersPosition$,this.selectedChapterCurrentLayers$]).pipe((0,M.p)(([_,t,i])=>!(0,V.isNil)(_)&&!(0,V.isNil)(t)&&!(0,V.isNil)(i)),(0,g.Q)(this.ngUnsubscribe)).subscribe(([_,t,i])=>{const o=this.visibilityLayersService.indexPositionToFraction(i,_,t);this.percent=this.visibilityLayersService.fractionToPercent(o),this.changeDetectorRef.markForCheck()})}handleDragEnded(_){this.syncSliderLayers(_,!1,!0)}handleTrackClicked(_){this.syncSliderLayers(_,!1,!0)}handlePercentChanged(_){this.syncSliderLayers(_,!0,!1)}syncSliderLayers(_,t,i){const o=this.store.selectSnapshot(b.N.getSelectedChapterId),s=this.store.selectSnapshot(b.N.getSelectedChapterCurrentLayers),a=this.visibilityLayersService.percentToFraction(_),r=this.visibilityLayersService.fractionToIndex(s,a),u=this.visibilityLayersService.fractionToPosition(s,a,r);t&&this.visibilityLayersService.syncLayersToScene(s,r,u,!1),i&&this.visibilityLayersService.syncLayersToState(o,r,u)}static#e=this.\u0275fac=function(t){return new(t||Oe)(e.rXU(c.il),e.rXU(Tt.n),e.rXU(e.gRc))};static#t=this.\u0275cmp=e.VBU({type:Oe,selectors:[["app-view-layers-slider"]],standalone:!0,features:[e.aNF],decls:4,vars:3,consts:()=>{let _;return _=$localize`:␟78670204058ee08d827f2323fab98b7520c7c51e␟7032204075609591368: Changing the value of the slider will modify visibility of different layers of the model `,[_,[1,"flex","justify-center","w-full",2,"height","200px"],[1,"sr-only"],["sliderAxis","y",3,"percentChanged","dragEnded","trackClicked","percent","showTrack","accessibleLabel"]]},template:function(t,i){1&t&&(e.j41(0,"div",1)(1,"span",2),e.pXf(2,0),e.k0s(),e.j41(3,"app-view-slider",3),e.bIt("percentChanged",function(s){return i.handlePercentChanged(s)})("dragEnded",function(s){return i.handleDragEnded(s)})("trackClicked",function(s){return i.handleTrackClicked(s)}),e.k0s()()),2&t&&(e.R7$(3),e.Y8G("percent",i.percent)("showTrack",!0)("accessibleLabel",i.accessibleLabel))},dependencies:[C,ee],styles:['.view-layers-slider[_ngcontent-%COMP%]{--track-width: 5px;height:200px;width:40px;display:flex;justify-content:center}.view-layers-slider--disabled[_ngcontent-%COMP%]{opacity:.25;pointer-events:none}.view-layers-slider__group[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;justify-content:center;align-items:center;width:28px;height:100%}.view-layers-slider__track[_ngcontent-%COMP%]{cursor:pointer;position:absolute;background:#96a8c099;z-index:1;width:var(--track-width);border-radius:var(--track-width);top:14px;bottom:14px}.view-layers-slider__bar[_ngcontent-%COMP%]{position:absolute;background:#374a68;width:var(--track-width);border-radius:var(--track-width);z-index:2;height:0;top:0;pointer-events:none}.view-layers-slider__handle[_ngcontent-%COMP%]{cursor:pointer;width:28px;height:28px;margin-top:-14px;top:14px;display:flex;align-items:center;justify-content:center;position:absolute;z-index:2}.view-layers-slider__handle[_ngcontent-%COMP%]:focus{outline:none;border:none}.view-layers-slider__handle--hide[_ngcontent-%COMP%]{display:none}.view-layers-slider__handle[_ngcontent-%COMP%]:after{content:"";width:12px;height:12px;border-radius:6px;background:#374a68;box-shadow:1px -1px 2px #1c2a3f1a,0 1px 2px #1c2a3f4d}.view-layers-slider__handle[_ngcontent-%COMP%]:hover:after, .view-layers-slider__handle[_ngcontent-%COMP%]:focus:after{background:#2d72dc}'],changeDetection:0})}Ne([(0,c.l6)(b.N.getSelectedChapterCurrentLayers),qe("design:type",d.c)],Oe.prototype,"selectedChapterCurrentLayers$",void 0),Ne([(0,c.l6)(b.N.getSelectedChapterCurrentLayersIndex),qe("design:type",d.c)],Oe.prototype,"selectedChapterCurrentLayersIndex$",void 0),Ne([(0,c.l6)(b.N.getSelectedChapterCurrentLayersPosition),qe("design:type",d.c)],Oe.prototype,"selectedChapterCurrentLayersPosition$",void 0);var O=l(51640),E=l(93822),ji=l(20342),Zt=l(98020);function Hi(n,_){if(1&n&&e.nrm(0,"a",1),2&n){const t=e.XpG();e.HbH(t.classClasses()),e.xc7("background-image",t.cssBackgroundImage()),e.BMQ("href",t.logoLinkoutUrl(),e.B4B)("rel",t.logoLinkRel())("target","_blank")("title",t.logoTitle())("aria-label",t.logoAriaLabel())}}function Qi(n,_){if(1&n&&e.nrm(0,"span",1),2&n){const t=e.XpG();e.HbH(t.classClasses()),e.xc7("background-image",t.cssBackgroundImage()),e.BMQ("title",t.logoTitle())}}let mi=(()=>{class n{constructor(t){this.store=t,this.logoUI=(0,h.ot)(this.store.select(O.dF.getUIEntry(E.U.Logo))),this.logoConfig=(0,h.ot)(this.store.select(Zt.X.getViewLogoConfig)),this.logoSize=(0,e.hFB)("full"),this.logoColor=(0,e.hFB)("color"),this.logoModel=(0,e.EWP)(()=>(0,ji.g)(this.logoConfig(),this.logoSize(),this.logoColor())),this.logoDisplayMode=(0,e.EWP)(()=>{const i=this.logoUI()?.isHyperLink,o=this.logoLinkoutUrl();return i&&o?"link":"text"}),this.logoImageUrl=(0,e.EWP)(()=>this.logoModel()?.logo_url??""),this.logoLinkoutUrl=(0,e.EWP)(()=>this.logoModel()?.logo_linkout_url??""),this.isCustomBranding=(0,e.EWP)(()=>"logo_swap"===this.logoConfig()?.viewer?.viewer_logo_setting),this.classClasses=(0,e.EWP)(()=>["view-logo",`view-logo--${this.logoSize()}-${this.logoColor()}`]),this.cssBackgroundImage=(0,e.EWP)(()=>`url('${this.logoImageUrl()}')`),this.logoTitle=(0,e.EWP)(()=>this.isCustomBranding()?"":$localize`Powered by BioDigital`),this.logoAriaLabel=(0,e.EWP)(()=>this.isCustomBranding()?$localize`link opens in a new tab`:$localize`Powered by BioDigital (opens in a new tab)`),this.logoLinkRel=(0,e.EWP)(()=>this.isCustomBranding()?"noreferrer nofollow":"")}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(c.il))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-view-logo"]],inputs:{logoSize:[1,"logoSize"],logoColor:[1,"logoColor"]},standalone:!0,features:[e.aNF],decls:2,vars:1,consts:[["data-test","viewLogo",3,"class","background-image"],["data-test","viewLogo"]],template:function(i,o){if(1&i&&e.DNE(0,Hi,1,9,"a",0)(1,Qi,1,5,"span",0),2&i){let s;e.vxM("link"===(s=o.logoDisplayMode())?0:"text"===s?1:-1)}},dependencies:[p.MD],styles:["[_nghost-%COMP%]{display:flex;align-items:center}.view-logo[_ngcontent-%COMP%]{pointer-events:all;background-position:center center;background-repeat:no-repeat}.view-logo[_ngcontent-%COMP%]:focus{outline:#2d72dc solid 2px!important}.view-logo--small-color[_ngcontent-%COMP%]{width:40px;display:flex;justify-content:center;height:40px}.view-logo--full-color[_ngcontent-%COMP%]{width:120px;height:33px}.view-logo--small-white[_ngcontent-%COMP%]{width:40px;display:flex;justify-content:center;height:40px}.view-logo--full-white[_ngcontent-%COMP%]{width:120px;height:33px}.view-logo[_ngcontent-%COMP%]:not([hidden]){display:flex}.view-logo[href][_ngcontent-%COMP%]:hover{cursor:pointer}"],changeDetection:0})}return n})();var J=l(21082),be=l(28407),xe=l(29160),We=l(95419),Ut=l(12347),f=l(26463),fi=l(46842);let Yi=(()=>{class n{constructor(t,i,o){this.mediaService=t,this.animationService=i,this.store=o,this.countdownStatus=new xe.t("inactive"),this.countdownChanged=new z.B,this.countdownComplete=new z.B,this.audioObserver=new d.c,this.audioSubject=new xe.t({current:0,duration:0,complete:!1}),this.animationSubject=new xe.t({current:0,duration:0,complete:!1}),this.readingSubject=new xe.t({current:0,duration:0,complete:!1}),this.minimumSubject=new xe.t({current:0,duration:0,complete:!1})}startChapterTimers(t,i=!1){var o=this;return(0,be.A)(function*(){const a={current:0,duration:0,complete:!1},r=o.store.selectSnapshot(f.Pf.getViewLanguage),u=o.store.selectSnapshot(fi.U.getPrefersReducedMotion);if(o.clearChapterTimers(),o.clearCountdown(),(i||o.mediaService.chapterHasAudio(t,r))&&(o.audioRef=yield o.mediaService.getChapterAudioPlayer(t,r,i)),o.audioRef){const v=yield o.mediaService.getDuration(o.audioRef);o.audioSubject.next({current:0,duration:v,complete:!1}),o.audioRef.on("end",()=>{o.audioSubject.next({...o.audioSubject.value,complete:!0})}),o.audioRef.on("stop",()=>{o.audioSubject.next({...o.audioSubject.value,complete:!1})}),o.audioRef.on("play",()=>{o.audioSubject.next({current:o.audioRef?.seek(),duration:v,complete:!1})})}else o.audioSubject.next({current:0,duration:0,complete:!0});o.animationSubject.next({current:o.animationService.getTime(),duration:o.animationService.getChapterDuration(),complete:!1}),o.readingSubject.next({current:0,duration:o.calculateChapterReadingTime(t),complete:!1});const{minimum:m}=o.store.selectSnapshot(f.Pf.getPlaythroughSettings);o.minimumSubject.next({current:0,duration:m,complete:!1}),o.interval=setInterval(()=>{o.audioSubject.next(o.audioRef?{...o.audioSubject.value,current:o.audioRef?.seek()}:{...a,complete:!0}),!o.animationService.isChapterAnimated(t)||u?o.animationSubject.next({...a,complete:!0}):o.animationService.isChapterLooped(t)?o.animationSubject.next({...o.animationSubject.value,current:o.animationSubject.value.current+.05,complete:o.animationSubject.value.current>=o.animationSubject.value.duration}):o.animationSubject.next({...o.animationSubject.value,current:o.animationService.getTime(),complete:o.animationService.hasChapterFinished()}),o.readingSubject.next({...o.readingSubject.value,current:o.readingSubject.value.current+50,complete:o.readingSubject.value.current>=o.readingSubject.value.duration}),o.minimumSubject.next({...o.minimumSubject.value,current:o.minimumSubject.value.current+50,complete:o.minimumSubject.value.current>=o.minimumSubject.value.duration})},50)})()}clearChapterTimers(){clearInterval(this.interval),this.audioRef=null;const t={current:0,duration:0,complete:!1};this.animationSubject.next({...t}),this.audioSubject.next({...t}),this.readingSubject.next({...t}),this.minimumSubject.next({...t})}calculateMaximumRemainingTime(){return[{...this.audioSubject.getValue(),type:"audio"},{...this.animationSubject.getValue(),type:"animation"},{...this.readingSubject.getValue(),type:"reading"},{...this.minimumSubject.getValue(),type:"minimum"}].reduce((t,i)=>(i.complete||(("audio"===i.type||"animation"===i.type)&&(i={...i,current:1e3*i.current,duration:1e3*i.duration}),i.duration-i.current>t.duration-t.current&&(t={...i})),t),{complete:!0,current:0,duration:0})}calculateChapterReadingTime(t){return 1e3*Math.floor((t.description??"").split(" ").length/200*60)}preloadAudio(t,i=!1){var o=this;return(0,be.A)(function*(){const s=o.store.selectSnapshot(f.Pf.getViewLanguage);for(const a of t)yield o.mediaService.getChapterAudioPlayer(a,s,i)})()}startCountdown(){this.clearCountdown(),this.countdownStatus.next("active");let{countdown:t}=this.store.selectSnapshot(f.Pf.getPlaythroughSettings);this.countdownInterval=setInterval(()=>{t-=50,this.countdownChanged.next(t),t<=0&&(this.countdownComplete.next(),this.clearCountdown())},50)}delayCountdown(){const{countdownDelay:t}=this.store.selectSnapshot(f.Pf.getPlaythroughSettings);this.countdownInterval&&(this.clearCountdown(),clearTimeout(this.countdownDelay),this.countdownStatus.next("delay"),this.countdownDelay=setTimeout(()=>{this.startCountdown()},t))}clearCountdown(){const{countdown:t}=this.store.selectSnapshot(f.Pf.getPlaythroughSettings);clearInterval(this.countdownInterval),clearTimeout(this.countdownDelay),this.countdownChanged.next(t),this.countdownStatus.next("inactive")}static#e=this.\u0275fac=function(i){return new(i||n)(e.KVO(We.u),e.KVO(Ut.O),e.KVO(c.il))};static#t=this.\u0275prov=e.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var te=l(76304);const C_=["progressCircle"],I_=["*"],M_=(n,_)=>({"progress--text-small":n,"progress--animate":_});function w_(n,_){if(1&n&&(e.j41(0,"div",6),e.EFF(1),e.k0s()),2&n){const t=e.XpG();e.R7$(),e.SpI(" ",t.progress,"% ")}}function A_(n,_){1&n&&(e.j41(0,"div",7),e.SdG(1),e.k0s())}let Jn=(()=>{class n{get progress(){return this._progress}set progress(t){this._progress=t,this.updateCircle()}get strokeWidth(){return this._strokeWidth}set strokeWidth(t){this._strokeWidth=t}get diameter(){return this._diameter}set diameter(t){this._diameter=t}constructor(t,i){this.renderer=t,this.changeRef=i,this.textSize="default",this._progress=0,this.showPercent=!0,this.strokeColor="#2d72dc",this.fillColor="#ffffff",this.ringColor="#eaeff5",this._strokeWidth=8,this._diameter=120,this.fillOnComplete=!1,this.animate=!0}ngOnInit(){}ngAfterViewInit(){this.updateCircle()}updateCircle(){if(this.progressCircleRef){const i=2*this.progressCircleRef.nativeElement.r.baseVal.value*Math.PI,o=i-this.progress/100*i;this.renderer.setStyle(this.progressCircleRef.nativeElement,"strokeDasharray",`${i} ${i}`),this.renderer.setStyle(this.progressCircleRef.nativeElement,"strokeDashoffset",`${o}`)}this.changeRef.markForCheck()}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(e.sFG),e.rXU(e.gRc))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-progress-circle"]],viewQuery:function(i,o){if(1&i&&e.GBs(C_,7),2&i){let s;e.mGM(s=e.lsd())&&(o.progressCircleRef=s.first)}},inputs:{textSize:"textSize",progress:"progress",showPercent:"showPercent",strokeColor:"strokeColor",fillColor:"fillColor",ringColor:"ringColor",strokeWidth:"strokeWidth",diameter:"diameter",fillOnComplete:"fillOnComplete",animate:"animate"},ngContentSelectors:I_,decls:9,vars:20,consts:[["progressCircle",""],["data-test","progress",1,"progress",3,"ngClass"],["alt",""],[1,"progress__circle"],["class","progress__label","data-test","progressPercentage",4,"ngIf"],["class","progress__content","data-test","progressContent",4,"ngIf"],["data-test","progressPercentage",1,"progress__label"],["data-test","progressContent",1,"progress__content"]],template:function(i,o){1&i&&(e.NAR(),e.j41(0,"div",1),e.qSk(),e.j41(1,"svg",2)(2,"g"),e.nrm(3,"circle",3),e.k0s(),e.j41(4,"g"),e.nrm(5,"circle",3,0),e.k0s()(),e.DNE(7,w_,2,1,"div",4)(8,A_,2,0,"div",5),e.k0s()),2&i&&(e.Y8G("ngClass",e.l_i(17,M_,"small"===o.textSize,o.animate)),e.R7$(),e.BMQ("width",o.diameter)("height",o.diameter),e.R7$(2),e.BMQ("stroke",o.ringColor)("stroke-width",o.strokeWidth)("fill",o.fillColor)("r",o.diameter/2-o.strokeWidth)("cx",o.diameter/2)("cy",o.diameter/2),e.R7$(2),e.BMQ("stroke",o.strokeColor)("stroke-width",o.strokeWidth)("fill",100===o.progress&&o.fillOnComplete?o.strokeColor:"transparent")("r",o.diameter/2-o.strokeWidth)("cx",o.diameter/2)("cy",o.diameter/2),e.R7$(2),e.Y8G("ngIf",o.showPercent),e.R7$(),e.Y8G("ngIf",!o.showPercent))},dependencies:[p.YU,p.bT],styles:[".progress[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:center}.progress--animate[_ngcontent-%COMP%]   .progress__circle[_ngcontent-%COMP%]{transition:stroke-dashoffset .35s,fill .35s}.progress--small[_ngcontent-%COMP%]   .progress__label[_ngcontent-%COMP%]{font-size:.75rem;line-height:1rem}.progress__ring[_ngcontent-%COMP%]{position:absolute;z-index:1}.progress__circle[_ngcontent-%COMP%]{transform:rotate(-90deg);transform-origin:50% 50%}.progress__label[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;font-weight:600;transform:translate(-50%,-50%);z-index:2;font-size:1.125rem;line-height:1.75rem}.progress__content[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;color:#fff;position:absolute}"],changeDetection:0})}return n})();var Ti=function(n,_,t,i){var a,o=arguments.length,s=o<3?_:null===i?i=Object.getOwnPropertyDescriptor(_,t):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(n,_,t,i);else for(var r=n.length-1;r>=0;r--)(a=n[r])&&(s=(o<3?a(s):o>3?a(_,t,s):a(_,t))||s);return o>3&&s&&Object.defineProperty(_,t,s),s},bi=function(n,_){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(n,_)};function y_(n,_){if(1&n&&(e.qex(0),e.j41(1,"div",6),e.nrm(2,"app-progress-circle",7),e.k0s(),e.j41(3,"div",6),e.nrm(4,"app-progress-circle",8),e.k0s(),e.bVm()),2&n){const t=e.XpG();e.R7$(2),e.Y8G("progress",t.chapterPercent)("showPercent",!1)("animate",!1),e.R7$(2),e.Y8G("progress",t.countdownPercent)("showPercent",!1)("animate",!1)}}class Ke{constructor(_,t,i,o){this.viewService=_,this.viewPlaythroughService=t,this.store=i,this.changeDetectorRef=o,this.showCount=!0,this.showPlaythrough=!1,this.buttonSize=P.Mp.Default,this.iconSize="md",this.buttonTheme="transparent-fill",this.interval=null,this.chapterPercent=0,this.countdownPercent=0,this.ngUnsubscribe=new z.B}ngOnInit(){this.initChapterListener(),this.initPlaythrough()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete(),this.stopChapterTimer()}handlePreviousClick(){this.viewService.previousChapter("Pagination")}handleNextClick(){this.viewService.nextChapter("Pagination")}initChapterListener(){this.store.select(b.N.getSelectedChapterId).pipe((0,g.Q)(this.ngUnsubscribe)).subscribe(()=>{this.stopChapterTimer()}),(0,de.z)([this.store.select(te.S.getChapter),this.store.select(f.Pf.getPlaythroughEnabled)]).pipe((0,J.F)(),(0,g.Q)(this.ngUnsubscribe)).subscribe(([_,t])=>{this.chapterPercent=0,t?this.startChapterTimer():this.stopChapterTimer()})}initPlaythrough(){this.viewPlaythroughService.countdownChanged.pipe((0,g.Q)(this.ngUnsubscribe)).subscribe(_=>{const{countdown:t}=this.store.selectSnapshot(f.Pf.getPlaythroughSettings);this.countdownPercent=Math.floor(100-_/t*100),this.changeDetectorRef.markForCheck()})}startChapterTimer(){this.chapterPercent=0,this.countdownPercent=0,this.stopChapterTimer(),this.interval=setInterval(()=>{const _=this.viewPlaythroughService.calculateMaximumRemainingTime();this.chapterPercent=Math.ceil(_.current/_.duration*100),this.chapterPercent>100&&(this.chapterPercent=100),this.changeDetectorRef.markForCheck()},50)}stopChapterTimer(){this.interval&&clearInterval(this.interval),this.interval=null}static#e=this.\u0275fac=function(t){return new(t||Ke)(e.rXU(F.z),e.rXU(Yi),e.rXU(c.il),e.rXU(e.gRc))};static#t=this.\u0275cmp=e.VBU({type:Ke,selectors:[["app-view-pagination"]],inputs:{showCount:"showCount",showPlaythrough:"showPlaythrough",buttonSize:"buttonSize",iconSize:"iconSize",buttonTheme:"buttonTheme"},standalone:!0,features:[e.aNF],decls:10,vars:17,consts:()=>{let _,t,i;return _=$localize`:␟30249dc18ca1115e36390baf1cfe06e1805b6963␟744656089369810133:Chapter pagination`,t=$localize`:␟3228d65908ec43ba657d860b050c2a3871868cee␟8424575283863104959:Previous Chapter`,i=$localize`:␟95f5388846a3beaee5f870eb0996ed47d9c7819a␟8192680256063110394:Next Chapter`,[["aria-label",_,1,"view-pagination"],["data-test","viewPreviousChapter","aria-label",t,"app-view-button","",3,"click","buttonSize","buttonTheme","disabled"],["icon","arrow-left","appLogicalDir","",3,"size"],["data-test","viewNextChapter","aria-label",i,"app-view-button","",3,"click","buttonSize","buttonTheme","disabled"],[4,"ngIf"],["icon","arrow-right","appLogicalDir","",3,"size"],[1,"view-pagination__playthrough"],["fillColor","transparent","ringColor","#eaeff5","strokeColor","#96a8c0","diameter","28","strokeWidth","3",3,"progress","showPercent","animate"],["fillColor","transparent","ringColor","transparent","strokeColor","#374a68","diameter","28","strokeWidth","3",3,"progress","showPercent","animate"]]},template:function(t,i){1&t&&(e.j41(0,"nav",0)(1,"button",1),e.nI1(2,"async"),e.bIt("click",function(){return i.handlePreviousClick()}),e.nrm(3,"app-icon",2),e.k0s(),e.j41(4,"button",3),e.nI1(5,"async"),e.nI1(6,"async"),e.bIt("click",function(){return i.handleNextClick()}),e.DNE(7,y_,5,6,"ng-container",4),e.nI1(8,"async"),e.nrm(9,"app-icon",5),e.k0s()()),2&t&&(e.R7$(),e.Y8G("buttonSize",i.buttonSize)("buttonTheme",i.buttonTheme)("disabled",0===e.bMT(2,9,i.chapterIndex$)?"true":null),e.R7$(2),e.Y8G("size",i.iconSize),e.R7$(),e.Y8G("buttonSize",i.buttonSize)("buttonTheme",i.buttonTheme)("disabled",e.bMT(5,11,i.chapterIndex$)===e.bMT(6,13,i.chapterCount$)-1?"true":null),e.R7$(3),e.Y8G("ngIf",e.bMT(8,15,i.playthroughEnabled$)),e.R7$(2),e.Y8G("size",i.iconSize))},dependencies:[p.MD,p.bT,p.Jj,N.C,P.ri,B.o,D.R,he.M,Jn],styles:["@keyframes _ngcontent-%COMP%_disappear{0%{top:0}to{top:100%}}.view-pagination[_ngcontent-%COMP%]{display:flex;position:relative;white-space:nowrap}.view-pagination__count[_ngcontent-%COMP%]{font-size:14px;padding:0 8px}.view-pagination__playthrough[_ngcontent-%COMP%]{position:absolute;inset:0;display:flex;justify-content:center;align-items:center}"],changeDetection:0})}Ti([(0,c.l6)(b.N.getSelectedChapterIndex),bi("design:type",d.c)],Ke.prototype,"chapterIndex$",void 0),Ti([(0,c.l6)(b.N.getNextChapter),bi("design:type",d.c)],Ke.prototype,"nextChapter$",void 0),Ti([(0,c.l6)(b.N.getPreviousChapter),bi("design:type",d.c)],Ke.prototype,"previousChapter$",void 0),Ti([(0,c.l6)(b.N.getChapterCount),bi("design:type",d.c)],Ke.prototype,"chapterCount$",void 0),Ti([(0,c.l6)(f.Pf.getPlaythroughEnabled),bi("design:type",d.c)],Ke.prototype,"playthroughEnabled$",void 0);var R_=l(78696);let P_=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=e.$C({type:n});static#i=this.\u0275inj=e.G2t({imports:[p.MD,X.G,N.C,W.h,B.o,T.y,R_.H,Z.X1,K.c,he.M]})}return n})();var nt=l(38645);const U_=[];let V_=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=e.$C({type:n});static#i=this.\u0275inj=e.G2t({imports:[nt.iI.forChild(U_),nt.iI]})}return n})();var qi=l(68947),Ce=l(22679),ei=l(24418),w=l(87710),Ki=l(24552),eo=l(345);const D_=(n,_)=>({"view-title--center":n,"view-title--ellipsis":_}),L_=(n,_)=>({"text-md":n,"text-lg":_});function x_(n,_){if(1&n&&(e.nrm(0,"h2",1),e.nI1(1,"markdown"),e.nI1(2,"async")),2&n){const t=e.XpG();e.Y8G("innerHTML",e.bMT(2,3,e.bMT(1,1,t.titles().metaTitle)),e.npT)}}function $_(n,_){if(1&n&&(e.nrm(0,"h2",3),e.nI1(1,"markdown"),e.nI1(2,"async")),2&n){const t=e.XpG();e.Y8G("innerHTML",e.bMT(2,3,e.bMT(1,1,t.titles().subTitle)),e.npT)}}let Zi=(()=>{class n{get style(){const t=this.useEllipsis()?"overflow: hidden; display: flex; width: 100%;":"";return this.sanitizer.bypassSecurityTrustStyle(t)}constructor(t,i){this.sanitizer=t,this.store=i,this.story=(0,h.ot)(this.store.select(Ce.t.getStory)),this.chapter=(0,h.ot)(this.store.select(b.N.getSelectedChapter)),this.pagination=(0,h.ot)(this.store.select(b.N.getChapterPagination)),this.activeQuestionIndex=(0,h.ot)(this.store.select(w.j.getActiveQuestionIndex)),this.quizSettings=(0,h.ot)(this.store.select(w.j.getQuizSettings)),this.quizLifecycle=(0,h.ot)(this.store.select(w.j.getLifecycle)),this.quizQuestionTotal=(0,h.ot)(this.store.select(w.j.getQuestionTotal)),this.mainTitle=(0,e.hFB)(""),this.metaTitle=(0,e.hFB)(""),this.subTitle=(0,e.hFB)(""),this.showMetaTitle=(0,e.hFB)(!0),this.showSubTitle=(0,e.hFB)(!0),this.useEllipsis=(0,e.hFB)(!1),this.includePagination=(0,e.hFB)(!1),this.dynamicTitle=(0,e.hFB)("none"),this.size=(0,e.hFB)("md"),this.align=(0,e.hFB)("left"),this.titles=(0,e.EWP)(()=>{const o=this.dynamicTitle(),s=this.inputTitles(),a=this.chapterTitles(),r=this.quizTitles();switch(o){case"chapter":return a;case"quiz":return r;default:return s}}),this.inputTitles=(0,e.EWP)(()=>({mainTitle:this.mainTitle(),metaTitle:this.metaTitle(),subTitle:this.subTitle()})),this.chapterTitles=(0,e.EWP)(()=>{const o=this.story(),s=this.chapter(),a=this.pagination(),r=this.includePagination(),u=qi.l.normalize(o?.displayName??""),m=s?.displayName?qi.l.normalize(s.displayName):$localize`Chapter`+` ${a.index+1}`;return{mainTitle:m,metaTitle:ei.c.application===ce.c.Studio&&u!==m?u:"",subTitle:r?a?.label:""}}),this.quizTitles=(0,e.EWP)(()=>{const o=this.quizSettings(),s=this.quizLifecycle(),a=this.activeQuestionIndex(),r=this.quizQuestionTotal();return o.showProgress&&s!==Ki.h.Review?{mainTitle:`${$localize`Question ${a+1}`}<span class="font-normal">${$localize` of ${r}`}</span>`}:{mainTitle:$localize`Quiz`}})}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(eo.up),e.rXU(c.il))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-view-title"]],hostVars:2,hostBindings:function(i,o){2&i&&e.Aen(o.style)},inputs:{mainTitle:[1,"mainTitle"],metaTitle:[1,"metaTitle"],subTitle:[1,"subTitle"],showMetaTitle:[1,"showMetaTitle"],showSubTitle:[1,"showSubTitle"],useEllipsis:[1,"useEllipsis"],includePagination:[1,"includePagination"],dynamicTitle:[1,"dynamicTitle"],size:[1,"size"],align:[1,"align"]},standalone:!0,features:[e.aNF],decls:6,vars:15,consts:[[1,"view-title",3,"ngClass"],["id","view-title-meta",1,"view-title__meta",3,"innerHTML"],["id","view-title","tabindex","0",1,"view-title__main",3,"ngClass","innerHTML"],["id","view-title-sub",1,"view-title__sub",3,"innerHTML"]],template:function(i,o){if(1&i&&(e.j41(0,"section",0),e.DNE(1,x_,3,5,"h2",1),e.nrm(2,"h1",2),e.nI1(3,"markdown"),e.nI1(4,"async"),e.DNE(5,$_,3,5,"h2",3),e.k0s()),2&i){let s;e.Y8G("ngClass",e.l_i(9,D_,"center"===o.align(),o.useEllipsis())),e.R7$(),e.vxM((null==(s=o.titles().metaTitle)?null:s.length)>0&&o.showMetaTitle()?1:-1),e.R7$(),e.Y8G("ngClass",e.l_i(12,L_,"md"===o.size(),"lg"===o.size()))("innerHTML",e.bMT(4,7,e.bMT(3,5,o.titles().mainTitle)),e.npT),e.R7$(3),e.vxM(o.showSubTitle()?5:-1)}},dependencies:[p.MD,p.YU,p.Jj,Y.y2,Y.i0],styles:["[_nghost-%COMP%]{display:flex}.view-title[_ngcontent-%COMP%]{overflow-wrap:break-word;color:#131c2a;border-radius:4px;transition:background-color 125ms;flex:1 1 0;display:flex;flex-direction:column;align-items:flex-start}.view-title--ellipsis[_ngcontent-%COMP%]{width:0}.view-title--ellipsis[_ngcontent-%COMP%]   .view-title__meta[_ngcontent-%COMP%], .view-title--ellipsis[_ngcontent-%COMP%]   .view-title__main[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis}.view-title--center[_ngcontent-%COMP%]{justify-content:center}.view-title__meta[_ngcontent-%COMP%]{font-size:.625rem;line-height:.75rem;text-transform:uppercase;text-align:start;font-weight:400;color:#374a68;overflow-wrap:anywhere;margin-bottom:4px}.view-title__main[_ngcontent-%COMP%]{color:#131c2a;text-align:start;font-weight:600;overflow-wrap:anywhere}.view-title__sub[_ngcontent-%COMP%]{font-size:.625rem;line-height:.75rem;text-transform:uppercase;text-align:start;margin-top:4px;color:#374a68;font-weight:400}.view-title[_ngcontent-%COMP%]:hover   .view-title__count[_ngcontent-%COMP%]{display:none}.view-title[_ngcontent-%COMP%]:hover   .view-title__show[_ngcontent-%COMP%]{display:block}.view-title__show[_ngcontent-%COMP%]{display:none}"],changeDetection:0})}return n})();var Ji=l(65650),Ie=l(59115),to=l(34763),Ze=l(82487),In=l(48948);let k_=(()=>{class n{transform(t,i){return(0,to.w)(t)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275pipe=e.EJ8({name:"elementID",type:n,pure:!0})}return n})();const G_=["chapter"],W_=n=>({"view-chapters__item--viewed":n}),X_=n=>({"outline outline-blue-600 outline-2":n});function F_(n,_){if(1&n){const t=e.RV6();e.nrm(0,"app-pillbox-divider"),e.j41(1,"button",12,1),e.bIt("menuOpened",function(){e.eBV(t);const o=e.XpG(2);return e.Njj(o.handleChapterMenuOpen())}),e.j41(3,"div",13)(4,"div",14)(5,"span",15),e.pXf(6,3),e.k0s(),e.j41(7,"div",16),e.EFF(8),e.k0s(),e.j41(9,"div",17),e.EFF(10),e.qex(11),e.pXf(12,4),e.bVm(),e.EFF(13),e.k0s()(),e.j41(14,"div",18),e.nrm(15,"app-icon",19),e.k0s()()()}if(2&n){const t=e.XpG(2),i=e.sdS(4);e.R7$(),e.Y8G("matMenuTriggerFor",i),e.R7$(7),e.SpI(" ",t.getFormattedChapterTitle(t.chapterTitle(),t.chapterIndex())," "),e.R7$(2),e.SpI(" ",t.chapterIndex()+1," "),e.R7$(3),e.SpI(" ",t.chapterCount()," ")}}function z_(n,_){if(1&n&&(e.j41(0,"div",7),e.nrm(1,"app-view-pagination",11),e.DNE(2,F_,16,4),e.k0s()),2&n){const t=e.XpG();e.R7$(),e.Y8G("showCount",!1),e.R7$(),e.vxM(t.showTitle()?2:-1)}}function B_(n,_){if(1&n&&(e.j41(0,"div",8)(1,"span",20),e.EFF(2),e.k0s()()),2&n){const t=e.XpG();e.R7$(2),e.JRh(t.getFormattedChapterTitle(t.chapterTitle(),t.chapterIndex()))}}function j_(n,_){1&n&&(e.j41(0,"span",15),e.pXf(1,5),e.k0s())}function H_(n,_){if(1&n){const t=e.RV6();e.j41(0,"button",21,2),e.nI1(2,"elementID"),e.bIt("click",function(){const o=e.eBV(t).$implicit,s=e.XpG();return e.Njj(s.handleChapterClick(o))}),e.nrm(3,"div",22),e.j41(4,"div",23),e.EFF(5),e.k0s(),e.DNE(6,j_,2,0,"span",15),e.k0s()}if(2&n){const t=_.$implicit,i=_.$index,o=e.XpG();e.Y8G("ngClass",e.eq3(10,W_,o.isViewed(t.id))),e.BMQ("data-chapter-id",e.bMT(2,8,t.id)),e.R7$(3),e.Y8G("ngClass",e.eq3(12,X_,t.id===o.selectedChapterId()))("defaultImage",o.defaultImage)("lazyLoad",o.getChapterThumb(t.id)),e.R7$(2),e.Lme(" ",i+1,": ",o.getFormattedChapterTitle(t.displayName,i)," "),e.R7$(),e.vxM(t.id===o.selectedChapterId()?6:-1)}}let Mn=(()=>{class n{constructor(t,i){this.viewService=t,this.store=i,this.defaultImage="/assets/images/view-chapter-thumbnail-placeholder.png",this.chapterElements=(0,e.dtW)("chapter",{read:e.aKT}),this.chapterTitle=(0,h.ot)(this.store.select(b.N.getSelectedChapterTitle)),this.chapterIndex=(0,h.ot)(this.store.select(b.N.getSelectedChapterIndex)),this.chapterCount=(0,h.ot)(this.store.select(b.N.getChapterCount)),this.chapters=(0,h.ot)(this.store.select(b.N.getStoryChapters)),this.selectedChapterId=(0,h.ot)(this.store.select(b.N.getSelectedChapterId)),this.showPagination=(0,e.hFB)(!0),this.showTitle=(0,e.hFB)(!0)}getChapterThumb(t){const o=this.store.selectSnapshot(Ji.K.getRegisteredThumbnails).get(t);return o?o.snapshot||o.urls.small:""}getFormattedChapterTitle(t,i){return t||$localize`Chapter`+` ${i+1}`}isViewed(t){return this.store.selectSnapshot(b.N.getChaptersViewed).some(i=>i===t)}handleChapterMenuOpen(){setTimeout(()=>{this.scrollToSelectedChapter()})}handleNextClick(){this.viewService.nextChapter("titleOnly")}handleChapterClick(t){this.viewService.selectChapter(t)}handlePreviousClick(){this.viewService.previousChapter("titleOnly")}scrollToSelectedChapter(){const t=(0,to.w)(this.store.selectSnapshot(b.N.getSelectedChapterId));this.chapterElements().find(s=>s.nativeElement.dataset.chapterId===t)?.nativeElement.scrollIntoView({block:"center"})}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(F.z),e.rXU(c.il))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-view-title-only"]],viewQuery:function(i,o){1&i&&e.wEZ(o.chapterElements,G_,5,e.aKT),2&i&&e.NyB()},inputs:{showPagination:[1,"showPagination"],showTitle:[1,"showTitle"]},standalone:!0,features:[e.aNF],decls:7,vars:1,consts:()=>{let t,i,o;return t=$localize`:␟0498f53592b97136a56a48a29c54aea03a15b5e0␟9209125563388589034:Chapter List`,i=$localize`:␟169eed2bc3e08e1bea977bcc5d799379f6b8a758␟5881876145178332550:of`,o=$localize`:␟1e7180823484a8b886c921518255e24324c3d47b␟8167513183851535531:current`,[["chapterMenu","matMenu"],["chapterMenuTrigger","matMenuTrigger"],["chapter",""],t,i,o,["orientation","horizontal","data-test","viewTitleOnly","appPreventFadeout","",1,"relative"],[1,"flex","w-full","min-w-0"],["data-test","viewStaticTitle",1,"view-title-only__title","view-title-only__title--static"],[1,"view-chapters"],["mat-menu-item","",1,"view-chapters__item",3,"ngClass"],["data-test","viewFloatingPagination","buttonSize","small","iconSize","lg",3,"showCount"],["app-view-button","","data-test","viewChaptersButton","buttonSize","small",1,"w-full","min-w-0",3,"menuOpened","matMenuTriggerFor"],[1,"flex","flex-row","w-full"],[1,"px-2","py-0","overflow-hidden","text-start","grow"],[1,"sr-only"],[1,"view-title-only__title","view-title-only__title--truncated"],[1,"view-title-only__count"],[1,"view-title-only__icon"],["icon","angle-down","size","lg"],[1,"view-title-only__title--truncated"],["mat-menu-item","",1,"view-chapters__item",3,"click","ngClass"],[1,"view-chapters__thumb",3,"ngClass","defaultImage","lazyLoad"],[1,"view-chapters__title"]]},template:function(i,o){1&i&&(e.j41(0,"app-pillbox",6),e.DNE(1,z_,3,2,"div",7)(2,B_,3,1,"div",8),e.k0s(),e.j41(3,"mat-menu",9,0),e.Z7z(5,H_,7,14,"button",10,e.Vm6),e.k0s()),2&i&&(e.R7$(),e.vxM(o.showPagination()?1:o.showTitle()?2:-1),e.R7$(4),e.Dyx(o.chapters()))},dependencies:[p.MD,p.YU,Ie.Cn,Ie.kk,Ie.fb,Ie.Cp,$.b,Ze.O,In.p,N.C,P.ri,B.o,D.R,ge.Y,k_,ne.Un,ne.Je,Ke],styles:[".view-title-only{display:flex;align-items:center}.view-title-only__title{font-size:.875rem;line-height:1.25rem;font-weight:600;color:#131c2a}.view-title-only__title--static{padding:0 12px;min-height:40px;display:flex;align-items:center;min-width:0}.view-title-only__title--truncated{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.view-title-only__count{font-size:10px;text-transform:uppercase;color:#374a68}.view-title-only__icon{display:flex;align-items:center;padding:0 8px}.view-chapters{min-width:300px;max-height:228px;overflow:auto}.view-chapters button.mat-mdc-menu-item{width:100%;height:auto;font-size:.75rem;line-height:1rem}.view-chapters div.mat-mdc-menu-content{padding:0}.view-chapters .mat-mdc-menu-item-text{display:flex;line-height:1.4em!important}.view-chapters__item{height:auto;white-space:normal;display:flex!important;padding:12px 20px!important;background-color:transparent;width:240px;transition:background-color 125ms,color 125ms}.view-chapters__item:first-of-type{border-top-left-radius:4px;border-top-right-radius:4px}.view-chapters__item:last-of-type{border-bottom-left-radius:4px;border-bottom-right-radius:4px}.view-chapters__item:hover{cursor:pointer;background:#eaeff5}.view-chapters__item--selected{background-color:#2d72dc!important;--mat-menu-item-label-text-color: #ffffff}.view-chapters__thumb{background-size:cover;background-color:#f9fafd;border-radius:4px;background-repeat:no-repeat;border:2px solid white;flex:0 0 52px;height:52px;width:52px;transition:border-color .1s}.view-chapters__title{overflow-wrap:break-word;padding-inline-start:16px;word-break:break-word;white-space:normal;display:flex;flex-grow:1;font-weight:500}\n"],encapsulation:2,changeDetection:0})}return n})();var vi=l(58832),Vt=l(21523),je=l(47555),wn=l(39898),io=l(34215),Oi=l(30607),Q_=l(84370),An=l(34006),Y_=l(16443);let q_=(()=>{class n{constructor(t,i){this.dialogRef=t,this.data=i,this.config=i}handleCloseClick(){this.dialogRef.close()}ngOnInit(){}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(An.CP),e.rXU(An.Vh))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-video-dialog"]],decls:4,vars:2,consts:[["role","dialog","aria-modal","true",1,"video-dialog"],["mode","full",1,"video-dialog__video",3,"sources"],["type","button","app-view-button","","buttonShape","rounded","buttonTheme","white","matTooltip","Close Dialog","matTooltipPosition","left","aria-label","Close Dialog",1,"video-dialog__close",3,"click"],["icon","times"]],template:function(i,o){1&i&&(e.j41(0,"div",0),e.nrm(1,"app-video-view",1),e.j41(2,"button",2),e.bIt("click",function(){return o.handleCloseClick()}),e.nrm(3,"app-icon",3),e.k0s()()),2&i&&(e.BMQ("aria-label",(o.config.title||"")+" Video Dialog"),e.R7$(),e.Y8G("sources",o.config.videoSources))},dependencies:[D.R,Y_.E,P.ri],styles:[".video-dialog[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;width:100%}.video-dialog__video[_ngcontent-%COMP%]{display:block;max-width:100%}.video-dialog__close[_ngcontent-%COMP%]{position:fixed;top:24px;inset-inline-end:24px}"],changeDetection:0})}return n})();const yn=[{src:"/umedia/video/a5b42697-64f5-43e1-97d2-48e62b8945ed/viewer.mpd",type:"application/dash+xml"},{src:"/umedia/video/a5b42697-64f5-43e1-97d2-48e62b8945ed/viewer.m3u8",type:"application/x-mpegURL"},{src:"/umedia/video/a5b42697-64f5-43e1-97d2-48e62b8945ed/viewer.0000022.jpg",type:"image/jpeg"}];var we=l(32724),Je=l(48570),no=l(73987),Dt=l(28203),Ot=l(49989);const K_=["viewMenu"],Z_=["viewQuizMenu"],J_=n=>({"bg-blue-600 text-white":n}),es=n=>({"font-bold":n});function ts(n,_){1&n&&e.nrm(0,"app-icon",39)}function is(n,_){1&n&&e.nrm(0,"app-icon",40)}function ns(n,_){1&n&&e.nrm(0,"app-icon",41)}function os(n,_){if(1&n&&(e.j41(0,"button",34)(1,"div",38),e.DNE(2,ts,1,0,"app-icon",39)(3,is,1,0,"app-icon",40)(4,ns,1,0,"app-icon",41),e.k0s()()),2&n){let t;const i=e.XpG(2),o=e.sdS(22);e.Y8G("matMenuTriggerFor",o)("matTooltipPosition",i.tooltipPosition),e.R7$(2),e.vxM((t=i.activeTool())===i.toolEnum.Hide?2:t===i.toolEnum.Fade?3:4)}}function _s(n,_){if(1&n){const t=e.RV6();e.j41(0,"button",42),e.bIt("click",function(){e.eBV(t);const o=e.XpG(2);return e.Njj(o.handleLayers())}),e.nrm(1,"app-icon",43),e.k0s()}if(2&n){let t;const i=e.XpG(2);e.Y8G("buttonTheme","show"===(null==(t=i.visibilityLayersUI())?null:t.status)?"blue-fill":"transparent-fill")("matTooltipPosition",i.tooltipPosition),e.BMQ("data-test-visibility-layers",i.visibilityLayersVisible())("data-test-skin-layers",i.skinLayersVisible())}}function ss(n,_){if(1&n){const t=e.RV6();e.j41(0,"button",44),e.bIt("click",function(){e.eBV(t);const o=e.XpG(2);return e.Njj(o.handleSearch())}),e.nrm(1,"app-icon",45),e.k0s()}if(2&n){const t=e.XpG(2);e.Y8G("buttonTheme","show"===t.searchStatus()?"blue-fill":"transparent-fill")("matTooltipPosition",t.tooltipPosition),e.BMQ("aria-pressed","show"===t.searchStatus())}}function as(n,_){if(1&n){const t=e.RV6();e.j41(0,"button",46),e.bIt("click",function(){e.eBV(t);const o=e.XpG(2);return e.Njj(o.handleDraw())}),e.nrm(1,"app-icon",47),e.k0s()}if(2&n){const t=e.XpG(2);e.Y8G("matTooltipPosition",t.tooltipPosition)}}function rs(n,_){if(1&n&&e.DNE(0,os,5,3,"button",34)(1,_s,2,4,"button",35)(2,ss,2,3,"button",36)(3,as,2,1,"button",37),2&n){const t=e.XpG();e.vxM(t.toolsVisible()?0:-1),e.R7$(),e.vxM(t.visibilityLayersVisible()?1:-1),e.R7$(),e.vxM(t.searchVisible()?2:-1),e.R7$(),e.vxM(t.whiteboardVisible()?3:-1)}}function ls(n,_){if(1&n&&(e.j41(0,"button",22),e.nrm(1,"app-icon",48),e.k0s()),2&n){const t=e.XpG(),i=e.sdS(6),o=e.sdS(25);e.Y8G("matMenuTriggerFor",t.heightBreakpoint()>t.canvasHeightBreakpoint.Small?o:i)("matTooltipPosition",t.tooltipPosition)}}function cs(n,_){1&n&&(e.j41(0,"app-pillbox",23),e.nrm(1,"app-view-layers-slider"),e.k0s())}function ds(n,_){1&n&&e.nrm(0,"app-icon",53)}function ps(n,_){1&n&&e.nrm(0,"app-icon",54)}function us(n,_){1&n&&e.nrm(0,"app-icon",55)}function hs(n,_){if(1&n&&(e.j41(0,"button",49),e.DNE(1,ds,1,0,"app-icon",53)(2,ps,1,0,"app-icon",54)(3,us,1,0,"app-icon",55),e.qex(4),e.pXf(5,8),e.bVm(),e.k0s()),2&n){let t;const i=e.XpG(2),o=e.sdS(22);e.Y8G("matMenuTriggerFor",o),e.R7$(),e.vxM((t=i.activeTool())===i.toolEnum.Hide?1:t===i.toolEnum.Fade?2:3)}}function gs(n,_){if(1&n){const t=e.RV6();e.j41(0,"button",56),e.bIt("click",function(){e.eBV(t);const o=e.XpG(2);return e.Njj(o.handleLayers())}),e.nrm(1,"app-icon",57),e.qex(2),e.pXf(3,9),e.bVm(),e.k0s()}if(2&n){const t=e.XpG(2);e.BMQ("data-test-visibility-layers",t.visibilityLayersVisible())("data-test-skin-layers",t.skinLayersVisible())}}function Es(n,_){if(1&n){const t=e.RV6();e.j41(0,"button",58),e.bIt("click",function(){e.eBV(t);const o=e.XpG(2);return e.Njj(o.handleSearch())}),e.nrm(1,"app-icon",59),e.qex(2),e.pXf(3,10),e.bVm(),e.k0s()}}function Ss(n,_){if(1&n){const t=e.RV6();e.j41(0,"button",60),e.bIt("click",function(){e.eBV(t);const o=e.XpG(2);return e.Njj(o.handleDraw())}),e.nrm(1,"app-icon",61),e.qex(2),e.pXf(3,11),e.bVm(),e.k0s()}}function ms(n,_){if(1&n&&e.DNE(0,hs,6,2,"button",49)(1,gs,4,2,"button",50)(2,Es,4,0,"button",51)(3,Ss,4,0,"button",52),2&n){const t=e.XpG();e.vxM(t.toolsVisible()?0:-1),e.R7$(),e.vxM(t.visibilityLayersVisible()&&t.heightBreakpoint()<t.canvasHeightBreakpoint.Standard?1:-1),e.R7$(),e.vxM(t.searchVisible()?2:-1),e.R7$(),e.vxM(t.whiteboardVisible()?3:-1)}}function fs(n,_){if(1&n){const t=e.RV6();e.j41(0,"button",63),e.bIt("click",function(){const o=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.handleSelectTool(o.id))}),e.j41(1,"div",64)(2,"div",65),e.nrm(3,"app-icon",66),e.k0s(),e.j41(4,"div",67),e.EFF(5),e.k0s()()()}if(2&n){const t=_.$implicit,i=e.XpG(2);e.BMQ("data-test","viewQuizTools"+t.label),e.R7$(2),e.Y8G("ngClass",e.eq3(5,J_,i.activeTool()===t.id)),e.R7$(),e.Y8G("icon",t.icon),e.R7$(),e.Y8G("ngClass",e.eq3(7,es,i.activeTool()===t.id)),e.R7$(),e.SpI(" ",t.label," ")}}function Ts(n,_){if(1&n&&e.Z7z(0,fs,6,9,"button",62,e.Vm6),2&n){const t=e.XpG();e.Dyx(t.tools)}}function bs(n,_){if(1&n){const t=e.RV6();e.j41(0,"button",68),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.handleTakeQuiz())}),e.nrm(1,"app-icon",69),e.qex(2),e.pXf(3,12),e.bVm(),e.k0s()}if(2&n){let t;const i=e.XpG();e.Y8G("disabled",!(null!=(t=i.selectedChapterReady())&&t.model)||i.quizActive())}}function vs(n,_){1&n&&(e.qex(0),e.pXf(1,13),e.bVm())}function Os(n,_){1&n&&(e.qex(0),e.pXf(1,14),e.bVm())}function Cs(n,_){if(1&n){const t=e.RV6();e.j41(0,"button",70),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.handleToggleLabels())}),e.DNE(1,vs,2,0,"ng-container")(2,Os,2,0,"ng-container"),e.k0s()}if(2&n){const t=e.XpG();e.R7$(),e.vxM(t.showLabels()?1:2)}}function Is(n,_){1&n&&(e.qex(0),e.pXf(1,15),e.bVm())}function Ms(n,_){1&n&&(e.qex(0),e.pXf(1,16),e.bVm())}function ws(n,_){if(1&n){const t=e.RV6();e.j41(0,"button",72),e.bIt("click",function(){e.eBV(t);const o=e.XpG(2);return e.Njj(o.toggleXRModeClick("immersive-vr"))}),e.nrm(1,"app-icon",73),e.DNE(2,Is,2,0,"ng-container")(3,Ms,2,0,"ng-container"),e.k0s()}if(2&n){const t=e.XpG(2);e.Y8G("disabled","immersive-ar"===t.xrSessionMode()),e.R7$(2),e.vxM(t.isVRActive()?2:3)}}function As(n,_){1&n&&(e.qex(0),e.pXf(1,17),e.bVm())}function ys(n,_){1&n&&(e.qex(0),e.pXf(1,18),e.bVm())}function Ns(n,_){if(1&n){const t=e.RV6();e.j41(0,"button",72),e.bIt("click",function(){e.eBV(t);const o=e.XpG(2);return e.Njj(o.toggleXRModeClick("immersive-ar"))}),e.nrm(1,"app-icon",74),e.DNE(2,As,2,0,"ng-container")(3,ys,2,0,"ng-container"),e.k0s()}if(2&n){const t=e.XpG(2);e.Y8G("disabled","immersive-vr"===t.xrSessionMode()),e.R7$(2),e.vxM(t.isARActive()?2:3)}}function Rs(n,_){if(1&n&&e.DNE(0,ws,4,2,"button",71)(1,Ns,4,2,"button",71),2&n){const t=e.XpG();e.vxM(t.isVREnabled()?0:-1),e.R7$(),e.vxM(t.isAREnabled()?1:-1)}}function Ps(n,_){if(1&n&&(e.j41(0,"button",33),e.pXf(1,19),e.k0s()),2&n){e.XpG();const t=e.sdS(12);e.Y8G("matMenuTriggerFor",t)}}let Nn=(()=>{class n{constructor(t,i,o,s,a,r){this.viewService=t,this.viewUIService=i,this.quizService=o,this.dialog=s,this.store=a,this.directionality=r,this.toolEnum=je.s,this.canvasHeightBreakpoint=no.h,this.bookmarkViewMode=vi._,this.tools=[{id:je.s.Select,label:$localize`Select`,icon:"mouse-pointer"},{id:je.s.Hide,label:$localize`Hide`,icon:"eye-slash"},{id:je.s.Fade,label:$localize`Fade`,icon:"adjust"}],this.viewMenu=(0,e.ebz)("viewMenu"),this.viewQuizMenu=(0,e.ebz)("viewQuizMenu"),this.heightBreakpoint=(0,h.ot)(this.store.select(te.S.getCanvasHeightBreakpoint)),this.toolsVisible=(0,h.ot)(this.store.select(O.dF.getVisible(E.U.Tools))),this.visibilityLayersVisible=(0,h.ot)(this.store.select(O.dF.getVisible(E.U.VisibilityLayers))),this.visibilityLayersUI=(0,h.ot)(this.store.select(O.dF.getUIEntry(E.U.VisibilityLayers))),this.skinLayersVisible=(0,h.ot)(this.store.select(O.dF.getVisible(E.U.SkinLayers))),this.searchVisible=(0,h.ot)(this.store.select(O.dF.getVisible(E.U.Search))),this.whiteboardVisible=(0,h.ot)(this.store.select(O.dF.getVisible(E.U.Whiteboard))),this.toggleLabelsVisible=(0,h.ot)(this.store.select(O.dF.getVisible(E.U.ToggleLabels))),this.helpVisible=(0,h.ot)(this.store.select(O.dF.getVisible(E.U.Help))),this.playthroughVisible=(0,h.ot)(this.store.select(O.dF.getVisible(E.U.Playthrough))),this.toolbarOverflowVisible=(0,h.ot)(this.store.select(O.dF.getVisible(E.U.ToolbarOverflow))),this.quizPromptVisible=(0,h.ot)(this.store.select(O.dF.getVisible(E.U.QuizPrompt))),this.searchStatus=(0,h.ot)(this.store.select(O.dF.getSearchStatus)),this.hasQuiz=(0,h.ot)(this.store.select(w.j.hasQuiz)),this.quizEnabled=(0,h.ot)(this.store.select(w.j.getQuizEnabled)),this.quizLocked=(0,h.ot)(this.store.select(w.j.getQuizModeLocked)),this.quizActive=(0,h.ot)(this.store.select(w.j.getQuizModeActive)),this.showLabels=(0,h.ot)(this.store.select(te.S.getShowLabels)),this.activeTool=(0,h.ot)(this.store.select(te.S.getActiveTool)),this.selectedChapterReady=(0,h.ot)(this.store.select(b.N.getSelectedChapterReadyState)),this.selectedBookmarkViewMode=(0,h.ot)(this.store.select(Vt.J.getSelectedBookmarkViewMode)),this.isMobileWeb=(0,h.ot)(this.store.select(f.Pf.getIsMobileWeb)),this.xrSessionMode=(0,h.ot)(this.store.select(we.U.getXRSessionMode)),this.xrSupportedModes=(0,h.ot)(this.store.select(we.U.getXRSupportedModes)),this.xrEnabled=(0,h.ot)(this.store.select(we.U.getXREnabled)),this.xrActive=(0,h.ot)(this.store.select(we.U.getXRActive)),this.isVREnabled=(0,h.ot)(this.store.select(we.U.getVREnabled)),this.isAREnabled=(0,h.ot)(this.store.select(we.U.getAREnabled)),this.isVRActive=(0,h.ot)(this.store.select(we.U.getVRActive)),this.isARActive=(0,h.ot)(this.store.select(we.U.getXRActive)),this.tooltipPosition="ltr"===this.directionality.value?"right":"left"}handleSearch(){this.viewService.toggleSearch()}handleDraw(){this.viewService.toggleWhiteboard(!0)}handleSelectTool(t){(0,V.isNil)(t)||this.viewService.selectTool(t)}handleLayers(){this.viewService.toggleLayers()}handleToggleLabels(){this.viewService.showLabels()}handleTakeQuiz(){this.quizService.startQuiz()}handleHelpShortcuts(){this.viewService.toggleHelp(wn.J.Shortcuts)}handleHelpBasics(){this.viewService.toggleHelp(wn.J.Basics)}handlePlaythrough(t){this.viewService.togglePlaythrough(t)}handleTutorial(){this.viewService.toggleTutorial(!0)}handleVideo(t){this.dialog.open(q_,{id:Q_.t.VideoDialog,backdropClass:"bd-dialog-backdrop",panelClass:"bd-dialog-panel",disableClose:!1,data:{videoSources:yn}}),t.stopPropagation()}isEnabled(t){return this.viewUIService.isUIEnabled(t)}handleUndoClick(){this.viewService.undo()}handleRedoClick(){this.viewService.redo()}handleResetClick(){this.viewService.resetChapter()}toggleXRModeClick(t){this.store.selectSnapshot(we.U.getXRSessionMode)?this.store.dispatch(new Je.W.ExitXR(!1)):this.store.dispatch(new Je.W.EnterXR(t))}openRemoteQuest(){const t=new URL("https://oculus.com/open_url/");t.searchParams.set("url",location.href),window.open(t,"__blank")}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(F.z),e.rXU(io.d),e.rXU(Oi.k),e.rXU(An.bZ),e.rXU(c.il),e.rXU(Dt.dS))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-view-toolbar"]],viewQuery:function(i,o){1&i&&(e.wEZ(o.viewMenu,K_,5),e.wEZ(o.viewQuizMenu,Z_,5)),2&i&&e.NyB(2)},standalone:!0,features:[e.aNF],decls:30,vars:12,consts:()=>{let t,i,o,s,a,r,u,m,v,R,_e,$e,ke,Se,Rt,Ht,Qt,Yt,qt,Kt,Fi,zi,Bi,pe,b_,v_,O_;return t=$localize`:␟7d208927e15566385c17967cc202c76e52e8f6a5␟3354617747657053846:Selection Tools`,i=$localize`:␟90fe9fae0783d2318d135abeb52592f09485421e␟4976034006498894948:More Options`,o=$localize`:␟90fe9fae0783d2318d135abeb52592f09485421e␟4976034006498894948:More Options`,s=$localize`:␟ac0f81713a84217c9bd1d9bb460245d8190b073f␟5937251202465808296:More`,a=$localize`:␟58083a2c0d5c2b2184981c0887b01d1b3795eb61␟3384117902239564995:Getting Started Video`,r=$localize`:␟27469d782d17f88ac1d4bbb5ab0715a83be9bfec␟1108080934572452765:3D Navigation Tutorial`,u=$localize`:␟eedb1f2596af2c8fcb065b15ace6b88d079e45db␟4831075576673859232:Keyboard Shortcuts`,m=$localize`:␟7d208927e15566385c17967cc202c76e52e8f6a5␟3354617747657053846:Selection Tools`,v=$localize`:␟7d208927e15566385c17967cc202c76e52e8f6a5␟3354617747657053846:Selection Tools`,R=$localize`:␟3a7999f75941d258d1b67979cf1dc683a5db872b␟8605048384026546143:Anatomy Layers`,_e=$localize`:␟3a7999f75941d258d1b67979cf1dc683a5db872b␟8605048384026546143:Anatomy Layers`,$e=$localize`:␟b4c7cd9839a91a097a7d23041261d812818f2688␟1240960779977380559:Anatomy Search`,ke=$localize`:␟b4c7cd9839a91a097a7d23041261d812818f2688␟1240960779977380559:Anatomy Search`,Se=$localize`:␟a9c16db1d07908ad468c925fb3a36d96b98e9080␟8647687729200262691:Draw`,Rt=$localize`:␟a9c16db1d07908ad468c925fb3a36d96b98e9080␟8647687729200262691:Draw`,Ht=$localize`:␟7d208927e15566385c17967cc202c76e52e8f6a5␟3354617747657053846:Selection Tools`,Qt=$localize`:␟3a7999f75941d258d1b67979cf1dc683a5db872b␟8605048384026546143:Anatomy Layers`,Yt=$localize`:␟b4c7cd9839a91a097a7d23041261d812818f2688␟1240960779977380559:Anatomy Search`,qt=$localize`:␟a9c16db1d07908ad468c925fb3a36d96b98e9080␟8647687729200262691:Draw`,Kt=$localize`:␟66a82c6638b304a349b7d43b13482fa7493419c9␟1556772664146095223:Take Quiz`,Fi=$localize`:␟0176531c3e308e6a4f5dd4776a054145a1a6f2f3␟4142825283571551211:Hide Labels`,zi=$localize`:␟5a595fd88f56c04bacea3ea933dd02f98f213150␟6701808385090866243:Show Labels`,Bi=$localize`:␟d8f00947439583705b11afdb26b3606125755d7b␟1909228686165085461:Exit VR`,pe=$localize`:␟5830a413540a273b819289949937046a450e5d1d␟3237949197627908261:Enter VR`,b_=$localize`:␟1d0d80fb57ed2c1c18d12b2df218541387455b4d␟6343763191422968223:Exit AR`,v_=$localize`:␟ea19499751215e7ca470be4008a3fc22ed128146␟7143676568850518157:Enter AR`,O_=$localize`:␟79b5cb803980738a667e2f41746369c1efc9b0b1␟1685423440406455552: Help `,[["viewMenu","matMenu"],["helpMenu","matMenu"],["selectionToolsMenu","matMenu"],["moreMenu","matMenu"],s,a,r,u,Ht,Qt,Yt,qt,Kt,Fi,zi,Bi,pe,b_,v_,O_,["data-test","viewToolbar",1,"view-toolbar"],["orientation","vertical","role","group","aria-label",t,"appPreventFadeout","",1,"view-toolbar__main"],["type","button","data-test","viewMenuButton","matTooltip",i,"app-view-button","","buttonSize","small","aria-label",o,3,"matMenuTriggerFor","matTooltipPosition"],["appPreventFadeout","","orientation","vertical","data-test","viewLayers",1,"view-toolbar__tools"],["data-test","viewMenu",1,"view-menu",3,"overlapTrigger"],["mat-menu-item","","data-test","viewMoreMenuButton",3,"matMenuTriggerFor"],[1,"view-menu"],["mat-menu-item","",3,"click"],["mat-menu-item","","data-test","viewLaunchTutorial",3,"click","disabled"],["mat-menu-item","","data-test","viewKeyboardShortcuts",3,"click"],["data-test","selectionToolsMenu",1,"view-menu"],["mat-menu-item","","data-test","viewQuizMenuButton",3,"disabled"],["mat-menu-item","","data-test","viewToggleLabels"],["data-test","viewHelpMenuButton","mat-menu-item","",3,"matMenuTriggerFor"],["app-view-button","","buttonSize","small","buttonTheme","transparent-fill","data-test","viewToolsButton","aria-label",m,"matTooltip",v,3,"matMenuTriggerFor","matTooltipPosition"],["app-view-button","","buttonSize","small","data-test","viewLayersButton","aria-label",R,"matTooltip",_e,3,"buttonTheme","matTooltipPosition"],["app-view-button","","buttonSize","small","data-test","viewSearchButton","aria-label",$e,"matTooltip",ke,3,"buttonTheme","matTooltipPosition"],["app-view-button","","buttonSize","small","data-test","viewDrawButton","aria-label",Se,"matTooltip",Rt,3,"matTooltipPosition"],[1,"relative","flex","justify-center"],["size","lg","icon","eye-slash"],["size","lg","icon","adjust"],["size","lg","icon","mouse-pointer"],["app-view-button","","buttonSize","small","data-test","viewLayersButton","aria-label",R,"matTooltip",_e,3,"click","buttonTheme","matTooltipPosition"],["size","lg","icon","sliders-simple"],["app-view-button","","buttonSize","small","data-test","viewSearchButton","aria-label",$e,"matTooltip",ke,3,"click","buttonTheme","matTooltipPosition"],["size","lg","icon","magnifying-glass"],["app-view-button","","buttonSize","small","data-test","viewDrawButton","aria-label",Se,"matTooltip",Rt,3,"click","matTooltipPosition"],["size","lg","icon","pen"],["size","lg","icon","ellipsis-vertical"],["mat-menu-item","","data-test","viewToolsButton",3,"matMenuTriggerFor"],["mat-menu-item","","data-test","viewLayersButton"],["mat-menu-item","","data-test","viewSearchButton"],["mat-menu-item","","data-test","viewDrawButton"],["size","lg","icon","eye-slash",1,"view-toolbar__menu-icon"],["size","lg","icon","adjust",1,"view-toolbar__menu-icon"],["size","lg","icon","mouse-pointer",1,"view-toolbar__menu-icon"],["mat-menu-item","","data-test","viewLayersButton",3,"click"],["size","lg","icon","sliders-simple",1,"view-toolbar__menu-icon"],["mat-menu-item","","data-test","viewSearchButton",3,"click"],["size","lg","icon","magnifying-glass",1,"view-toolbar__menu-icon"],["mat-menu-item","","data-test","viewDrawButton",3,"click"],["size","lg","icon","pen",1,"view-toolbar__menu-icon"],["mat-menu-item","",1,"!px-2"],["mat-menu-item","",1,"!px-2",3,"click"],[1,"flex","items-center","gap-2","pr-4"],["aria-hidden","",1,"flex","items-center","justify-center","w-8","h-8","rounded",3,"ngClass"],["size","lg","appLogicalDir","",3,"icon"],[3,"ngClass"],["mat-menu-item","","data-test","viewQuizMenuButton",3,"click","disabled"],["size","lg","icon","user-graduate","appLogicalDir","",1,"view-toolbar__menu-icon"],["mat-menu-item","","data-test","viewToggleLabels",3,"click"],["mat-menu-item","",3,"disabled"],["mat-menu-item","",3,"click","disabled"],["size","lg","icon","head-side-goggles",1,"view-toolbar__menu-icon"],["size","lg","icon","glasses",1,"view-toolbar__menu-icon"]]},template:function(i,o){if(1&i){const s=e.RV6();e.j41(0,"div",20)(1,"app-pillbox",21),e.DNE(2,rs,4,4)(3,ls,2,2,"button",22),e.k0s(),e.DNE(4,cs,2,0,"app-pillbox",23),e.k0s(),e.j41(5,"mat-menu",24,0),e.DNE(7,ms,4,4),e.j41(8,"button",25),e.qex(9),e.pXf(10,4),e.bVm(),e.k0s()(),e.j41(11,"mat-menu",26,1)(13,"button",27),e.bIt("click",function(r){return e.eBV(s),e.Njj(o.handleVideo(r))}),e.pXf(14,5),e.k0s(),e.j41(15,"button",28),e.bIt("click",function(){return e.eBV(s),e.Njj(o.handleTutorial())}),e.qex(16),e.pXf(17,6),e.bVm(),e.k0s(),e.j41(18,"button",29),e.bIt("click",function(){return e.eBV(s),e.Njj(o.handleHelpShortcuts())}),e.qex(19),e.pXf(20,7),e.bVm(),e.k0s()(),e.j41(21,"mat-menu",30,2),e.DNE(23,Ts,2,0),e.k0s(),e.j41(24,"mat-menu",26,3),e.DNE(26,bs,4,1,"button",31)(27,Cs,3,1,"button",32)(28,Rs,2,2)(29,Ps,2,1,"button",33),e.k0s()}if(2&i){let s,a;const r=e.sdS(25);e.R7$(2),e.vxM(o.heightBreakpoint()>o.canvasHeightBreakpoint.Small?2:-1),e.R7$(),e.vxM(o.toolbarOverflowVisible()?3:-1),e.R7$(),e.vxM("show"===(null==(s=o.visibilityLayersUI())?null:s.status)&&"single"===(null==(s=o.visibilityLayersUI())?null:s.layersMode)?4:-1),e.R7$(),e.Y8G("overlapTrigger",o.heightBreakpoint()<o.canvasHeightBreakpoint.Standard),e.R7$(2),e.vxM(o.heightBreakpoint()<o.canvasHeightBreakpoint.Standard?7:-1),e.R7$(),e.Y8G("matMenuTriggerFor",r),e.R7$(7),e.Y8G("disabled",!(null!=(a=o.selectedChapterReady())&&a.model)),e.R7$(8),e.vxM(o.toolsVisible()?23:-1),e.R7$(3),e.vxM(o.hasQuiz()&&o.quizEnabled()&&o.quizPromptVisible()&&!1===o.quizLocked()&&o.selectedBookmarkViewMode()!==o.bookmarkViewMode.Content&&o.isMobileWeb()?26:-1),e.R7$(),e.vxM(o.toggleLabelsVisible()?27:-1),e.R7$(),e.vxM(o.xrEnabled()?28:-1),e.R7$(),e.vxM(o.helpVisible()?29:-1)}},dependencies:[p.MD,p.YU,Ie.Cn,Ie.kk,Ie.fb,Ie.Cp,j.uc,j.oV,N.C,P.ri,B.o,D.R,$.b,Ze.O,W.h,oe.s,Ot.e,Oe],styles:[".view-toolbar[_ngcontent-%COMP%]{position:relative}.view-toolbar__menu-icon[_ngcontent-%COMP%]{display:inline-block;width:20px;text-align:center;margin-inline-end:4px}.view-toolbar__menu-icon--light[_ngcontent-%COMP%]{color:#374a68}.view-toolbar__tools[_ngcontent-%COMP%]{position:absolute;z-index:2;inset-inline-start:48px;top:0;width:40px}"],changeDetection:0})}return n})();var oo=l(68504),x=l(49969);function Us(n,_){if(1&n){const t=e.RV6();e.j41(0,"button",5),e.bIt("click",function(){e.eBV(t);const o=e.XpG(2);return e.Njj(o.handleUndoClick())}),e.nrm(1,"app-icon",6),e.k0s(),e.j41(2,"button",7),e.bIt("click",function(){e.eBV(t);const o=e.XpG(2);return e.Njj(o.handleRedoClick())}),e.nrm(3,"app-icon",8),e.k0s()}if(2&n){const t=e.XpG(2);e.Y8G("disabled",!1===t.canUndo())("matTooltipPosition",t.tooltipPosition),e.R7$(),e.Y8G("custom",!0),e.R7$(),e.Y8G("disabled",!1===t.canRedo())("matTooltipPosition",t.tooltipPosition),e.R7$(),e.Y8G("custom",!0)}}function Vs(n,_){if(1&n){const t=e.RV6();e.j41(0,"div",1)(1,"app-pillbox",2),e.DNE(2,Us,4,6),e.j41(3,"button",3),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.handleResetClick())}),e.j41(4,"span",4),e.pXf(5,0),e.k0s()()()()}if(2&n){const t=e.XpG();e.Y8G("@show",void 0),e.R7$(2),e.vxM("full"===t.layout()?2:-1),e.R7$(),e.Y8G("disabled",!1===t.canUndo())("matTooltipPosition",t.tooltipPosition)}}let Rn=(()=>{class n{constructor(t,i,o){this.store=t,this.viewService=i,this.directionality=o,this.canUndo=(0,h.ot)(this.store.select(oo.o.canUndo)),this.canRedo=(0,h.ot)(this.store.select(oo.o.canRedo)),this.layout=(0,e.hFB)("full"),this.tooltipPosition="ltr"===this.directionality.value?"right":"left"}handleUndoClick(){this.viewService.undo()}handleRedoClick(){this.viewService.redo()}handleResetClick(){this.viewService.resetChapter()}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(c.il),e.rXU(F.z),e.rXU(Dt.dS))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-view-undo"]],inputs:{layout:[1,"layout"]},standalone:!0,features:[e.aNF],decls:1,vars:1,consts:()=>{let t,i,o,s,a,r,u;return t=$localize`:␟5d09ab375cce1f50ab075f60a2f4e3c2aa39ed46␟5271497798766647376:Undo Tools`,i=$localize`:␟06c663bf1474713f57551123a46b34318543b67d␟7808756054397155068:Reset`,o=$localize`:␟06c663bf1474713f57551123a46b34318543b67d␟7808756054397155068:Reset`,s=$localize`:␟4f26c54d5c3edadf92756d7d3ce466dde1f01e2a␟5775346636203685655:Undo`,a=$localize`:␟4f26c54d5c3edadf92756d7d3ce466dde1f01e2a␟5775346636203685655:Undo`,r=$localize`:␟91b3b95ffa91d6355be5d7b3d48dfa32f3118bfa␟4221042196936324014:Redo`,u=$localize`:␟91b3b95ffa91d6355be5d7b3d48dfa32f3118bfa␟4221042196936324014:Redo`,[o,[1,"view-undo"],["orientation","vertical","role","group","aria-label",t,"appPreventFadeout",""],["app-view-button","","buttonSize","small","buttonShape","rounded","data-test","reset-btn","matTooltip",i,3,"click","disabled","matTooltipPosition"],[1,"font-semibold","text-2xs"],["app-view-button","","buttonSize","small","data-test","undo-btn","icon","undo","aria-label",s,"matTooltip",a,3,"click","disabled","matTooltipPosition"],["icon","undo","appLogicalDir","",3,"custom"],["app-view-button","","buttonSize","small","data-test","redo-btn","aria-label",r,"matTooltip",u,"icon","redo",3,"click","disabled","matTooltipPosition"],["icon","redo","appLogicalDir","",3,"custom"]]},template:function(i,o){1&i&&e.DNE(0,Vs,6,4,"div",1),2&i&&e.vxM(o.canUndo()?0:-1)},dependencies:[p.MD,j.uc,j.oV,$.b,Ze.O,W.h,oe.s,Ot.e,N.C,P.ri,B.o,D.R],styles:["[_nghost-%COMP%]{pointer-events:none}"],data:{animation:[(0,x.hZ)("show",[(0,x.kY)(":enter",(0,x.K2)([(0,x.iF)({transform:"translateX(-100%)",opacity:0}),(0,x.i0)("150ms ease-in-out",(0,x.iF)({transform:"translateX(0%)",opacity:1}))]))])]},changeDetection:0})}return n})();var _o=l(5584),Ae=l(47610);let en=(()=>{class n{constructor(t){this.store=t,this.animationPlaying=(0,h.ot)(this.store.select(te.S.getAnimationPlaying)),this.animationPlayingTooltip=(0,e.EWP)(()=>this.animationPlaying()?$localize`Pause Animation`:$localize`Play Animation`)}handlePlayClick(){const t=this.store.selectSnapshot(te.S.getAnimationPlaying);this.store.dispatch(new Ae.dE(!t))}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(c.il))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-view-play"]],standalone:!0,features:[e.aNF],decls:4,vars:3,consts:[["app-view-button","","buttonSize","small","data-test","viewMediaPlay","matTooltipPosition","above",3,"click","matTooltip"],[1,"sr-only"],["size","lg","aria-hidden","true",3,"icon"]],template:function(i,o){1&i&&(e.j41(0,"button",0),e.bIt("click",function(){return o.handlePlayClick()}),e.j41(1,"span",1),e.EFF(2),e.k0s(),e.nrm(3,"app-icon",2),e.k0s()),2&i&&(e.Y8G("matTooltip",o.animationPlayingTooltip()),e.R7$(2),e.JRh(o.animationPlayingTooltip()),e.R7$(),e.Y8G("icon",o.animationPlaying()?"pause":"play"))},dependencies:[p.MD,j.uc,j.oV,B.o,D.R,N.C,P.ri],changeDetection:0})}return n})(),Ds=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=e.$C({type:n});static#i=this.\u0275inj=e.G2t({imports:[p.MD,k.Pd,N.C,X.G,ae.x,B.o,_o.d,Z.YN,C,he.M,mt.G,en]})}return n})();var Ls=l(64218);let xs=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=e.$C({type:n});static#i=this.\u0275inj=e.G2t({imports:[p.MD,B.o,Ls.H,N.C]})}return n})();var tn=l(37710);let $s=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=e.$C({type:n});static#i=this.\u0275inj=e.G2t({imports:[c.rK.forFeature([tn.S]),p.MD]})}return n})();var nn=l(36860),Lt=l(86600);const ks=["knob"],Gs=["valueIndicatorContainer"];function Ws(n,_){if(1&n&&(e.j41(0,"div",2,1)(2,"div",5)(3,"span",6),e.EFF(4),e.k0s()()()),2&n){const t=e.XpG();e.R7$(4),e.JRh(t.valueIndicatorText)}}const Xs=["trackActive"],Fs=["*"];function zs(n,_){if(1&n&&e.nrm(0,"div"),2&n){const t=_.$implicit,i=_.$index,o=e.XpG(3);e.HbH(0===t?"mdc-slider__tick-mark--active":"mdc-slider__tick-mark--inactive"),e.xc7("transform",o._calcTickMarkTransform(i))}}function Bs(n,_){if(1&n&&e.Z7z(0,zs,1,4,"div",8,e.Vm6),2&n){const t=e.XpG(2);e.Dyx(t._tickMarks)}}function js(n,_){if(1&n&&(e.j41(0,"div",6,1),e.DNE(2,Bs,2,0),e.k0s()),2&n){const t=e.XpG();e.R7$(2),e.vxM(t._cachedWidth?2:-1)}}function Hs(n,_){if(1&n&&e.nrm(0,"mat-slider-visual-thumb",7),2&n){const t=e.XpG();e.Y8G("discrete",t.discrete)("thumbPosition",1)("valueIndicatorText",t.startValueIndicatorText)}}var G=function(n){return n[n.START=1]="START",n[n.END=2]="END",n}(G||{}),ti=function(n){return n[n.ACTIVE=0]="ACTIVE",n[n.INACTIVE=1]="INACTIVE",n}(ti||{});const on=new e.nKC("_MatSlider"),so=new e.nKC("_MatSliderThumb"),ao=new e.nKC("_MatSliderRangeThumb"),ro=new e.nKC("_MatSliderVisualThumb");let Qs=(()=>{class n{constructor(t,i,o,s){this._cdr=t,this._ngZone=i,this._slider=s,this._isHovered=!1,this._isActive=!1,this._isValueIndicatorVisible=!1,this._platform=(0,e.WQX)(nn.OD),this._onPointerMove=a=>{if(this._sliderInput._isFocused)return;const r=this._hostElement.getBoundingClientRect(),u=this._slider._isCursorOnSliderThumb(a,r);this._isHovered=u,u?this._showHoverRipple():this._hideRipple(this._hoverRippleRef)},this._onMouseLeave=()=>{this._isHovered=!1,this._hideRipple(this._hoverRippleRef)},this._onFocus=()=>{this._hideRipple(this._hoverRippleRef),this._showFocusRipple(),this._hostElement.classList.add("mdc-slider__thumb--focused")},this._onBlur=()=>{this._isActive||this._hideRipple(this._focusRippleRef),this._isHovered&&this._showHoverRipple(),this._hostElement.classList.remove("mdc-slider__thumb--focused")},this._onDragStart=a=>{0===a.button&&(this._isActive=!0,this._showActiveRipple())},this._onDragEnd=()=>{this._isActive=!1,this._hideRipple(this._activeRippleRef),this._sliderInput._isFocused||this._hideRipple(this._focusRippleRef),this._platform.SAFARI&&this._showHoverRipple()},this._hostElement=o.nativeElement}ngAfterViewInit(){const t=this._slider._getInput(this.thumbPosition);t&&(this._ripple.radius=24,this._sliderInput=t,this._sliderInputEl=this._sliderInput._hostElement,this._ngZone.runOutsideAngular(()=>{const i=this._sliderInputEl;i.addEventListener("pointermove",this._onPointerMove),i.addEventListener("pointerdown",this._onDragStart),i.addEventListener("pointerup",this._onDragEnd),i.addEventListener("pointerleave",this._onMouseLeave),i.addEventListener("focus",this._onFocus),i.addEventListener("blur",this._onBlur)}))}ngOnDestroy(){const t=this._sliderInputEl;t&&(t.removeEventListener("pointermove",this._onPointerMove),t.removeEventListener("pointerdown",this._onDragStart),t.removeEventListener("pointerup",this._onDragEnd),t.removeEventListener("pointerleave",this._onMouseLeave),t.removeEventListener("focus",this._onFocus),t.removeEventListener("blur",this._onBlur))}_showHoverRipple(){this._isShowingRipple(this._hoverRippleRef)||(this._hoverRippleRef=this._showRipple({enterDuration:0,exitDuration:0}),this._hoverRippleRef?.element.classList.add("mat-mdc-slider-hover-ripple"))}_showFocusRipple(){this._isShowingRipple(this._focusRippleRef)||(this._focusRippleRef=this._showRipple({enterDuration:0,exitDuration:0},!0),this._focusRippleRef?.element.classList.add("mat-mdc-slider-focus-ripple"))}_showActiveRipple(){this._isShowingRipple(this._activeRippleRef)||(this._activeRippleRef=this._showRipple({enterDuration:225,exitDuration:400}),this._activeRippleRef?.element.classList.add("mat-mdc-slider-active-ripple"))}_isShowingRipple(t){return t?.state===Lt.Ex.FADING_IN||t?.state===Lt.Ex.VISIBLE}_showRipple(t,i){if(!this._slider.disabled&&(this._showValueIndicator(),this._slider._isRange&&this._slider._getThumb(this.thumbPosition===G.START?G.END:G.START)._showValueIndicator(),!this._slider._globalRippleOptions?.disabled||i))return this._ripple.launch({animation:this._slider._noopAnimations?{enterDuration:0,exitDuration:0}:t,centered:!0,persistent:!0})}_hideRipple(t){if(t?.fadeOut(),this._isShowingAnyRipple())return;this._slider._isRange||this._hideValueIndicator();const i=this._getSibling();i._isShowingAnyRipple()||(this._hideValueIndicator(),i._hideValueIndicator())}_showValueIndicator(){this._hostElement.classList.add("mdc-slider__thumb--with-indicator")}_hideValueIndicator(){this._hostElement.classList.remove("mdc-slider__thumb--with-indicator")}_getSibling(){return this._slider._getThumb(this.thumbPosition===G.START?G.END:G.START)}_getValueIndicatorContainer(){return this._valueIndicatorContainer?.nativeElement}_getKnob(){return this._knob.nativeElement}_isShowingAnyRipple(){return this._isShowingRipple(this._hoverRippleRef)||this._isShowingRipple(this._focusRippleRef)||this._isShowingRipple(this._activeRippleRef)}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(e.gRc),e.rXU(e.SKi),e.rXU(e.aKT),e.rXU(on))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["mat-slider-visual-thumb"]],viewQuery:function(i,o){if(1&i&&(e.GBs(Lt.r6,5),e.GBs(ks,5),e.GBs(Gs,5)),2&i){let s;e.mGM(s=e.lsd())&&(o._ripple=s.first),e.mGM(s=e.lsd())&&(o._knob=s.first),e.mGM(s=e.lsd())&&(o._valueIndicatorContainer=s.first)}},hostAttrs:[1,"mdc-slider__thumb","mat-mdc-slider-visual-thumb"],inputs:{discrete:"discrete",thumbPosition:"thumbPosition",valueIndicatorText:"valueIndicatorText"},standalone:!0,features:[e.Jv_([{provide:ro,useExisting:n}]),e.aNF],decls:4,vars:2,consts:[["knob",""],["valueIndicatorContainer",""],[1,"mdc-slider__value-indicator-container"],[1,"mdc-slider__thumb-knob"],["matRipple","",1,"mat-mdc-focus-indicator",3,"matRippleDisabled"],[1,"mdc-slider__value-indicator"],[1,"mdc-slider__value-indicator-text"]],template:function(i,o){1&i&&(e.DNE(0,Ws,5,1,"div",2),e.nrm(1,"div",3,0)(3,"div",4)),2&i&&(e.vxM(o.discrete?0:-1),e.R7$(3),e.Y8G("matRippleDisabled",!0))},dependencies:[Lt.r6],styles:[".mat-mdc-slider-visual-thumb .mat-ripple{height:100%;width:100%}.mat-mdc-slider .mdc-slider__tick-marks{justify-content:start}.mat-mdc-slider .mdc-slider__tick-marks .mdc-slider__tick-mark--active,.mat-mdc-slider .mdc-slider__tick-marks .mdc-slider__tick-mark--inactive{position:absolute;left:2px}"],encapsulation:2,changeDetection:0})}return n})(),lo=(()=>{class n{get disabled(){return this._disabled}set disabled(t){this._disabled=t;const i=this._getInput(G.END),o=this._getInput(G.START);i&&(i.disabled=this._disabled),o&&(o.disabled=this._disabled)}get discrete(){return this._discrete}set discrete(t){this._discrete=t,this._updateValueIndicatorUIs()}get min(){return this._min}set min(t){const i=isNaN(t)?this._min:t;this._min!==i&&this._updateMin(i)}_updateMin(t){const i=this._min;this._min=t,this._isRange?this._updateMinRange({old:i,new:t}):this._updateMinNonRange(t),this._onMinMaxOrStepChange()}_updateMinRange(t){const i=this._getInput(G.END),o=this._getInput(G.START),s=i.value,a=o.value;o.min=t.new,i.min=Math.max(t.new,o.value),o.max=Math.min(i.max,i.value),o._updateWidthInactive(),i._updateWidthInactive(),t.new<t.old?this._onTranslateXChangeBySideEffect(i,o):this._onTranslateXChangeBySideEffect(o,i),s!==i.value&&this._onValueChange(i),a!==o.value&&this._onValueChange(o)}_updateMinNonRange(t){const i=this._getInput(G.END);if(i){const o=i.value;i.min=t,i._updateThumbUIByValue(),this._updateTrackUI(i),o!==i.value&&this._onValueChange(i)}}get max(){return this._max}set max(t){const i=isNaN(t)?this._max:t;this._max!==i&&this._updateMax(i)}_updateMax(t){const i=this._max;this._max=t,this._isRange?this._updateMaxRange({old:i,new:t}):this._updateMaxNonRange(t),this._onMinMaxOrStepChange()}_updateMaxRange(t){const i=this._getInput(G.END),o=this._getInput(G.START),s=i.value,a=o.value;i.max=t.new,o.max=Math.min(t.new,i.value),i.min=o.value,i._updateWidthInactive(),o._updateWidthInactive(),t.new>t.old?this._onTranslateXChangeBySideEffect(o,i):this._onTranslateXChangeBySideEffect(i,o),s!==i.value&&this._onValueChange(i),a!==o.value&&this._onValueChange(o)}_updateMaxNonRange(t){const i=this._getInput(G.END);if(i){const o=i.value;i.max=t,i._updateThumbUIByValue(),this._updateTrackUI(i),o!==i.value&&this._onValueChange(i)}}get step(){return this._step}set step(t){const i=isNaN(t)?this._step:t;this._step!==i&&this._updateStep(i)}_updateStep(t){this._step=t,this._isRange?this._updateStepRange():this._updateStepNonRange(),this._onMinMaxOrStepChange()}_updateStepRange(){const t=this._getInput(G.END),i=this._getInput(G.START),o=t.value,s=i.value,a=i.value;t.min=this._min,i.max=this._max,t.step=this._step,i.step=this._step,this._platform.SAFARI&&(t.value=t.value,i.value=i.value),t.min=Math.max(this._min,i.value),i.max=Math.min(this._max,t.value),i._updateWidthInactive(),t._updateWidthInactive(),t.value<a?this._onTranslateXChangeBySideEffect(i,t):this._onTranslateXChangeBySideEffect(t,i),o!==t.value&&this._onValueChange(t),s!==i.value&&this._onValueChange(i)}_updateStepNonRange(){const t=this._getInput(G.END);if(t){const i=t.value;t.step=this._step,this._platform.SAFARI&&(t.value=t.value),t._updateThumbUIByValue(),i!==t.value&&this._onValueChange(t)}}constructor(t,i,o,s,a,r){this._ngZone=t,this._cdr=i,this._elementRef=o,this._dir=s,this._globalRippleOptions=a,this._disabled=!1,this._discrete=!1,this.showTickMarks=!1,this._min=0,this.disableRipple=!1,this._max=100,this._step=1,this.displayWith=u=>`${u}`,this._rippleRadius=24,this.startValueIndicatorText="",this.endValueIndicatorText="",this._isRange=!1,this._isRtl=!1,this._hasViewInitialized=!1,this._tickMarkTrackWidth=0,this._hasAnimation=!1,this._resizeTimer=null,this._platform=(0,e.WQX)(nn.OD),this._knobRadius=8,this._thumbsOverlap=!1,this._noopAnimations="NoopAnimations"===r,this._dirChangeSubscription=this._dir.change.subscribe(()=>this._onDirChange()),this._isRtl="rtl"===this._dir.value}ngAfterViewInit(){this._platform.isBrowser&&this._updateDimensions();const t=this._getInput(G.END),i=this._getInput(G.START);this._isRange=!!t&&!!i,this._cdr.detectChanges();const o=this._getThumb(G.END);this._rippleRadius=o._ripple.radius,this._inputPadding=this._rippleRadius-this._knobRadius,this._isRange?this._initUIRange(t,i):this._initUINonRange(t),this._updateTrackUI(t),this._updateTickMarkUI(),this._updateTickMarkTrackUI(),this._observeHostResize(),this._cdr.detectChanges()}_initUINonRange(t){t.initProps(),t.initUI(),this._updateValueIndicatorUI(t),this._hasViewInitialized=!0,t._updateThumbUIByValue()}_initUIRange(t,i){t.initProps(),t.initUI(),i.initProps(),i.initUI(),t._updateMinMax(),i._updateMinMax(),t._updateStaticStyles(),i._updateStaticStyles(),this._updateValueIndicatorUIs(),this._hasViewInitialized=!0,t._updateThumbUIByValue(),i._updateThumbUIByValue()}ngOnDestroy(){this._dirChangeSubscription.unsubscribe(),this._resizeObserver?.disconnect(),this._resizeObserver=null}_onDirChange(){this._isRtl="rtl"===this._dir.value,this._isRange?this._onDirChangeRange():this._onDirChangeNonRange(),this._updateTickMarkUI()}_onDirChangeRange(){const t=this._getInput(G.END),i=this._getInput(G.START);t._setIsLeftThumb(),i._setIsLeftThumb(),t.translateX=t._calcTranslateXByValue(),i.translateX=i._calcTranslateXByValue(),t._updateStaticStyles(),i._updateStaticStyles(),t._updateWidthInactive(),i._updateWidthInactive(),t._updateThumbUIByValue(),i._updateThumbUIByValue()}_onDirChangeNonRange(){this._getInput(G.END)._updateThumbUIByValue()}_observeHostResize(){typeof ResizeObserver>"u"||!ResizeObserver||this._ngZone.runOutsideAngular(()=>{this._resizeObserver=new ResizeObserver(()=>{this._isActive()||(this._resizeTimer&&clearTimeout(this._resizeTimer),this._onResize())}),this._resizeObserver.observe(this._elementRef.nativeElement)})}_isActive(){return this._getThumb(G.START)._isActive||this._getThumb(G.END)._isActive}_getValue(t=G.END){const i=this._getInput(t);return i?i.value:this.min}_skipUpdate(){return!(!this._getInput(G.START)?._skipUIUpdate&&!this._getInput(G.END)?._skipUIUpdate)}_updateDimensions(){this._cachedWidth=this._elementRef.nativeElement.offsetWidth,this._cachedLeft=this._elementRef.nativeElement.getBoundingClientRect().left}_setTrackActiveStyles(t){const i=this._trackActive.nativeElement.style;i.left=t.left,i.right=t.right,i.transformOrigin=t.transformOrigin,i.transform=t.transform}_calcTickMarkTransform(t){return`translateX(${t*(this._tickMarkTrackWidth/(this._tickMarks.length-1))}px`}_onTranslateXChange(t){this._hasViewInitialized&&(this._updateThumbUI(t),this._updateTrackUI(t),this._updateOverlappingThumbUI(t))}_onTranslateXChangeBySideEffect(t,i){this._hasViewInitialized&&(t._updateThumbUIByValue(),i._updateThumbUIByValue())}_onValueChange(t){this._hasViewInitialized&&(this._updateValueIndicatorUI(t),this._updateTickMarkUI(),this._cdr.detectChanges())}_onMinMaxOrStepChange(){this._hasViewInitialized&&(this._updateTickMarkUI(),this._updateTickMarkTrackUI(),this._cdr.markForCheck())}_onResize(){if(this._hasViewInitialized){if(this._updateDimensions(),this._isRange){const t=this._getInput(G.END),i=this._getInput(G.START);t._updateThumbUIByValue(),i._updateThumbUIByValue(),t._updateStaticStyles(),i._updateStaticStyles(),t._updateMinMax(),i._updateMinMax(),t._updateWidthInactive(),i._updateWidthInactive()}else{const t=this._getInput(G.END);t&&t._updateThumbUIByValue()}this._updateTickMarkUI(),this._updateTickMarkTrackUI(),this._cdr.detectChanges()}}_areThumbsOverlapping(){const t=this._getInput(G.START),i=this._getInput(G.END);return!(!t||!i)&&i.translateX-t.translateX<20}_updateOverlappingThumbClassNames(t){const i=t.getSibling(),o=this._getThumb(t.thumbPosition);this._getThumb(i.thumbPosition)._hostElement.classList.remove("mdc-slider__thumb--top"),o._hostElement.classList.toggle("mdc-slider__thumb--top",this._thumbsOverlap)}_updateOverlappingThumbUI(t){!this._isRange||this._skipUpdate()||this._thumbsOverlap!==this._areThumbsOverlapping()&&(this._thumbsOverlap=!this._thumbsOverlap,this._updateOverlappingThumbClassNames(t))}_updateThumbUI(t){this._skipUpdate()||(this._getThumb(t.thumbPosition===G.END?G.END:G.START)._hostElement.style.transform=`translateX(${t.translateX}px)`)}_updateValueIndicatorUI(t){if(this._skipUpdate())return;const i=this.displayWith(t.value);if(this._hasViewInitialized?t._valuetext.set(i):t._hostElement.setAttribute("aria-valuetext",i),this.discrete){t.thumbPosition===G.START?this.startValueIndicatorText=i:this.endValueIndicatorText=i;const o=this._getThumb(t.thumbPosition);i.length<3?o._hostElement.classList.add("mdc-slider__thumb--short-value"):o._hostElement.classList.remove("mdc-slider__thumb--short-value")}}_updateValueIndicatorUIs(){const t=this._getInput(G.END),i=this._getInput(G.START);t&&this._updateValueIndicatorUI(t),i&&this._updateValueIndicatorUI(i)}_updateTickMarkTrackUI(){if(!this.showTickMarks||this._skipUpdate())return;const t=this._step&&this._step>0?this._step:1,o=(Math.floor(this.max/t)*t-this.min)/(this.max-this.min);this._tickMarkTrackWidth=this._cachedWidth*o-6}_updateTrackUI(t){this._skipUpdate()||(this._isRange?this._updateTrackUIRange(t):this._updateTrackUINonRange(t))}_updateTrackUIRange(t){const i=t.getSibling();if(!i||!this._cachedWidth)return;const o=Math.abs(i.translateX-t.translateX)/this._cachedWidth;this._setTrackActiveStyles(t._isLeftThumb&&this._cachedWidth?{left:"auto",right:this._cachedWidth-i.translateX+"px",transformOrigin:"right",transform:`scaleX(${o})`}:{left:`${i.translateX}px`,right:"auto",transformOrigin:"left",transform:`scaleX(${o})`})}_updateTrackUINonRange(t){this._setTrackActiveStyles(this._isRtl?{left:"auto",right:"0px",transformOrigin:"right",transform:`scaleX(${1-t.fillPercentage})`}:{left:"0px",right:"auto",transformOrigin:"left",transform:`scaleX(${t.fillPercentage})`})}_updateTickMarkUI(){if(!this.showTickMarks||void 0===this.step||void 0===this.min||void 0===this.max)return;const t=this.step>0?this.step:1;this._isRange?this._updateTickMarkUIRange(t):this._updateTickMarkUINonRange(t),this._isRtl&&this._tickMarks.reverse()}_updateTickMarkUINonRange(t){const i=this._getValue();let o=Math.max(Math.round((i-this.min)/t),0),s=Math.max(Math.round((this.max-i)/t),0);this._isRtl?o++:s++,this._tickMarks=Array(o).fill(ti.ACTIVE).concat(Array(s).fill(ti.INACTIVE))}_updateTickMarkUIRange(t){const i=this._getValue(),o=this._getValue(G.START),s=Math.max(Math.round((o-this.min)/t),0),a=Math.max(Math.round((i-o)/t)+1,0),r=Math.max(Math.round((this.max-i)/t),0);this._tickMarks=Array(s).fill(ti.INACTIVE).concat(Array(a).fill(ti.ACTIVE),Array(r).fill(ti.INACTIVE))}_getInput(t){return t===G.END&&this._input?this._input:this._inputs?.length?t===G.START?this._inputs.first:this._inputs.last:void 0}_getThumb(t){return t===G.END?this._thumbs?.last:this._thumbs?.first}_setTransition(t){this._hasAnimation=!this._platform.IOS&&t&&!this._noopAnimations,this._elementRef.nativeElement.classList.toggle("mat-mdc-slider-with-animation",this._hasAnimation)}_isCursorOnSliderThumb(t,i){const o=i.width/2,u=t.clientY-(i.y+o);return Math.pow(t.clientX-(i.x+o),2)+Math.pow(u,2)<Math.pow(o,2)}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(e.SKi),e.rXU(e.gRc),e.rXU(e.aKT),e.rXU(Dt.dS,8),e.rXU(Lt.$E,8),e.rXU(e.bc$,8))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["mat-slider"]],contentQueries:function(i,o,s){if(1&i&&(e.wni(s,so,5),e.wni(s,ao,4)),2&i){let a;e.mGM(a=e.lsd())&&(o._input=a.first),e.mGM(a=e.lsd())&&(o._inputs=a)}},viewQuery:function(i,o){if(1&i&&(e.GBs(Xs,5),e.GBs(ro,5)),2&i){let s;e.mGM(s=e.lsd())&&(o._trackActive=s.first),e.mGM(s=e.lsd())&&(o._thumbs=s)}},hostAttrs:[1,"mat-mdc-slider","mdc-slider"],hostVars:12,hostBindings:function(i,o){2&i&&(e.HbH("mat-"+(o.color||"primary")),e.AVh("mdc-slider--range",o._isRange)("mdc-slider--disabled",o.disabled)("mdc-slider--discrete",o.discrete)("mdc-slider--tick-marks",o.showTickMarks)("_mat-animation-noopable",o._noopAnimations))},inputs:{disabled:[2,"disabled","disabled",e.L39],discrete:[2,"discrete","discrete",e.L39],showTickMarks:[2,"showTickMarks","showTickMarks",e.L39],min:[2,"min","min",e.Udg],color:"color",disableRipple:[2,"disableRipple","disableRipple",e.L39],max:[2,"max","max",e.Udg],step:[2,"step","step",e.Udg],displayWith:"displayWith"},exportAs:["matSlider"],standalone:!0,features:[e.Jv_([{provide:on,useExisting:n}]),e.GFd,e.aNF],ngContentSelectors:Fs,decls:9,vars:5,consts:[["trackActive",""],["tickMarkContainer",""],[1,"mdc-slider__track"],[1,"mdc-slider__track--inactive"],[1,"mdc-slider__track--active"],[1,"mdc-slider__track--active_fill"],[1,"mdc-slider__tick-marks"],[3,"discrete","thumbPosition","valueIndicatorText"],[3,"class","transform"]],template:function(i,o){1&i&&(e.NAR(),e.SdG(0),e.j41(1,"div",2),e.nrm(2,"div",3),e.j41(3,"div",4),e.nrm(4,"div",5,0),e.k0s(),e.DNE(6,js,3,1,"div",6),e.k0s(),e.DNE(7,Hs,1,3,"mat-slider-visual-thumb",7),e.nrm(8,"mat-slider-visual-thumb",7)),2&i&&(e.R7$(6),e.vxM(o.showTickMarks?6:-1),e.R7$(),e.vxM(o._isRange?7:-1),e.R7$(),e.Y8G("discrete",o.discrete)("thumbPosition",2)("valueIndicatorText",o.endValueIndicatorText))},dependencies:[Qs],styles:['.mdc-slider__track{position:absolute;top:50%;transform:translateY(-50%);width:100%;pointer-events:none;height:var(--mdc-slider-inactive-track-height)}.mdc-slider__track--active,.mdc-slider__track--inactive{display:flex;height:100%;position:absolute;width:100%}.mdc-slider__track--active{overflow:hidden;border-radius:var(--mdc-slider-active-track-shape, var(--mat-app-corner-full));height:var(--mdc-slider-active-track-height);top:calc((var(--mdc-slider-inactive-track-height) - var(--mdc-slider-active-track-height))/2)}.mdc-slider__track--active_fill{border-top-style:solid;box-sizing:border-box;height:100%;width:100%;position:relative;transform-origin:left;transition:transform 80ms ease;border-color:var(--mdc-slider-active-track-color, var(--mat-app-primary));border-top-width:var(--mdc-slider-active-track-height)}.mdc-slider--disabled .mdc-slider__track--active_fill{border-color:var(--mdc-slider-disabled-active-track-color, var(--mat-app-on-surface))}[dir=rtl] .mdc-slider__track--active_fill{-webkit-transform-origin:right;transform-origin:right}.mdc-slider__track--inactive{left:0;top:0;opacity:.24;background-color:var(--mdc-slider-inactive-track-color, var(--mat-app-surface-variant));height:var(--mdc-slider-inactive-track-height);border-radius:var(--mdc-slider-inactive-track-shape, var(--mat-app-corner-full))}.mdc-slider--disabled .mdc-slider__track--inactive{background-color:var(--mdc-slider-disabled-inactive-track-color, var(--mat-app-on-surface));opacity:.24}.mdc-slider__track--inactive::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}.cdk-high-contrast-active .mdc-slider__track--inactive::before{border-color:CanvasText}.mdc-slider__value-indicator-container{bottom:44px;left:50%;pointer-events:none;position:absolute;transform:translateX(-50%);transform:var(--mat-slider-value-indicator-container-transform)}.mdc-slider__thumb--with-indicator .mdc-slider__value-indicator-container{pointer-events:auto}.mdc-slider__value-indicator{display:flex;align-items:center;border-radius:4px;height:32px;padding:0 12px;transform:scale(0);transform-origin:bottom;opacity:1;transition:transform 100ms cubic-bezier(0.4, 0, 1, 1);word-break:normal;background-color:var(--mdc-slider-label-container-color, var(--mat-app-primary));color:var(--mdc-slider-label-label-text-color, var(--mat-app-on-primary));width:var(--mat-slider-value-indicator-width);height:var(--mat-slider-value-indicator-height);padding:var(--mat-slider-value-indicator-padding);opacity:var(--mat-slider-value-indicator-opacity);border-radius:var(--mat-slider-value-indicator-border-radius)}.mdc-slider__thumb--with-indicator .mdc-slider__value-indicator{transition:transform 100ms cubic-bezier(0, 0, 0.2, 1);transform:scale(1)}.mdc-slider__value-indicator::before{border-left:6px solid rgba(0,0,0,0);border-right:6px solid rgba(0,0,0,0);border-top:6px solid;bottom:-5px;content:"";height:0;left:50%;position:absolute;transform:translateX(-50%);width:0;display:var(--mat-slider-value-indicator-caret-display);border-top-color:var(--mdc-slider-label-container-color, var(--mat-app-primary))}.mdc-slider__value-indicator::after{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}.cdk-high-contrast-active .mdc-slider__value-indicator::after{border-color:CanvasText}.mdc-slider__value-indicator-text{text-align:center;width:var(--mat-slider-value-indicator-width);transform:var(--mat-slider-value-indicator-text-transform);font-family:var(--mdc-slider-label-label-text-font, var(--mat-app-label-medium-font));font-size:var(--mdc-slider-label-label-text-size, var(--mat-app-label-medium-size));font-weight:var(--mdc-slider-label-label-text-weight, var(--mat-app-label-medium-weight));line-height:var(--mdc-slider-label-label-text-line-height, var(--mat-app-label-medium-line-height));letter-spacing:var(--mdc-slider-label-label-text-tracking, var(--mat-app-label-medium-tracking))}.mdc-slider__thumb{-webkit-user-select:none;user-select:none;display:flex;left:-24px;outline:none;position:absolute;height:48px;width:48px;pointer-events:none}.mdc-slider--discrete .mdc-slider__thumb{transition:transform 80ms ease}.mdc-slider--disabled .mdc-slider__thumb{pointer-events:none}.mdc-slider__thumb--top{z-index:1}.mdc-slider__thumb-knob{position:absolute;box-sizing:border-box;left:50%;top:50%;transform:translate(-50%, -50%);border-style:solid;width:var(--mdc-slider-handle-width);height:var(--mdc-slider-handle-height);border-width:calc(var(--mdc-slider-handle-height)/2) calc(var(--mdc-slider-handle-width)/2);box-shadow:var(--mdc-slider-handle-elevation, var(--mat-app-level1));background-color:var(--mdc-slider-handle-color, var(--mat-app-primary));border-color:var(--mdc-slider-handle-color, var(--mat-app-primary));border-radius:var(--mdc-slider-handle-shape, var(--mat-app-corner-full))}.mdc-slider__thumb:hover .mdc-slider__thumb-knob{background-color:var(--mdc-slider-hover-handle-color, var(--mat-app-primary));border-color:var(--mdc-slider-hover-handle-color, var(--mat-app-primary))}.mdc-slider__thumb--focused .mdc-slider__thumb-knob{background-color:var(--mdc-slider-focus-handle-color, var(--mat-app-primary));border-color:var(--mdc-slider-focus-handle-color, var(--mat-app-primary))}.mdc-slider--disabled .mdc-slider__thumb-knob{background-color:var(--mdc-slider-disabled-handle-color, var(--mat-app-on-surface));border-color:var(--mdc-slider-disabled-handle-color, var(--mat-app-on-surface))}.mdc-slider__thumb--top .mdc-slider__thumb-knob,.mdc-slider__thumb--top.mdc-slider__thumb:hover .mdc-slider__thumb-knob,.mdc-slider__thumb--top.mdc-slider__thumb--focused .mdc-slider__thumb-knob{border:solid 1px #fff;box-sizing:content-box;border-color:var(--mdc-slider-with-overlap-handle-outline-color, var(--mat-app-on-primary));border-width:var(--mdc-slider-with-overlap-handle-outline-width)}.mdc-slider__tick-marks{align-items:center;box-sizing:border-box;display:flex;height:100%;justify-content:space-between;padding:0 1px;position:absolute;width:100%}.mdc-slider__tick-mark--active,.mdc-slider__tick-mark--inactive{width:var(--mdc-slider-with-tick-marks-container-size);height:var(--mdc-slider-with-tick-marks-container-size);border-radius:var(--mdc-slider-with-tick-marks-container-shape, var(--mat-app-corner-full))}.mdc-slider__tick-mark--inactive{opacity:var(--mdc-slider-with-tick-marks-inactive-container-opacity);background-color:var(--mdc-slider-with-tick-marks-inactive-container-color, var(--mat-app-on-surface-variant))}.mdc-slider--disabled .mdc-slider__tick-mark--inactive{opacity:var(--mdc-slider-with-tick-marks-inactive-container-opacity);background-color:var(--mdc-slider-with-tick-marks-disabled-container-color, var(--mat-app-on-surface))}.mdc-slider__tick-mark--active{opacity:var(--mdc-slider-with-tick-marks-active-container-opacity);background-color:var(--mdc-slider-with-tick-marks-active-container-color, var(--mat-app-on-primary))}.mdc-slider__input{cursor:pointer;left:2px;margin:0;height:44px;opacity:0;position:absolute;top:2px;width:44px;box-sizing:content-box}.mdc-slider__input.mat-mdc-slider-input-no-pointer-events{pointer-events:none}.mdc-slider__input.mat-slider__right-input{left:auto;right:0}.mat-mdc-slider{display:inline-block;box-sizing:border-box;outline:none;vertical-align:middle;cursor:pointer;height:48px;margin:0 8px;position:relative;touch-action:pan-y;width:auto;min-width:112px;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-slider.mdc-slider--disabled{cursor:auto;opacity:.38}.mat-mdc-slider .mdc-slider__thumb,.mat-mdc-slider .mdc-slider__track--active_fill{transition-duration:0ms}.mat-mdc-slider.mat-mdc-slider-with-animation .mdc-slider__thumb,.mat-mdc-slider.mat-mdc-slider-with-animation .mdc-slider__track--active_fill{transition-duration:80ms}.mat-mdc-slider.mdc-slider--discrete .mdc-slider__thumb,.mat-mdc-slider.mdc-slider--discrete .mdc-slider__track--active_fill{transition-duration:0ms}.mat-mdc-slider.mat-mdc-slider-with-animation .mdc-slider__thumb,.mat-mdc-slider.mat-mdc-slider-with-animation .mdc-slider__track--active_fill{transition-duration:80ms}.mat-mdc-slider .mat-ripple .mat-ripple-element{background-color:var(--mat-slider-ripple-color, var(--mat-app-primary))}.mat-mdc-slider .mat-ripple .mat-mdc-slider-hover-ripple{background-color:var(--mat-slider-hover-state-layer-color)}.mat-mdc-slider .mat-ripple .mat-mdc-slider-focus-ripple,.mat-mdc-slider .mat-ripple .mat-mdc-slider-active-ripple{background-color:var(--mat-slider-focus-state-layer-color)}.mat-mdc-slider._mat-animation-noopable.mdc-slider--discrete .mdc-slider__thumb,.mat-mdc-slider._mat-animation-noopable.mdc-slider--discrete .mdc-slider__track--active_fill,.mat-mdc-slider._mat-animation-noopable .mdc-slider__value-indicator{transition:none}.mat-mdc-slider .mat-mdc-focus-indicator::before{border-radius:50%}.mdc-slider__thumb--focused .mat-mdc-focus-indicator::before{content:""}'],encapsulation:2,changeDetection:0})}return n})();const qs={provide:Z.kq,useExisting:(0,e.Rfq)(()=>_n),multi:!0};let _n=(()=>{class n{get value(){return(0,e.Udg)(this._hostElement.value,0)}set value(t){const i=(t=isNaN(t)?0:t)+"";this._hasSetInitialValue?this._isActive||this._setValue(i):this._initialValue=i}_setValue(t){this._hostElement.value=t,this._updateThumbUIByValue(),this._slider._onValueChange(this),this._cdr.detectChanges(),this._slider._cdr.markForCheck()}get translateX(){return this._slider.min>=this._slider.max?(this._translateX=this._tickMarkOffset,this._translateX):(void 0===this._translateX&&(this._translateX=this._calcTranslateXByValue()),this._translateX)}set translateX(t){this._translateX=t}get min(){return(0,e.Udg)(this._hostElement.min,0)}set min(t){this._hostElement.min=t+"",this._cdr.detectChanges()}get max(){return(0,e.Udg)(this._hostElement.max,0)}set max(t){this._hostElement.max=t+"",this._cdr.detectChanges()}get step(){return(0,e.Udg)(this._hostElement.step,0)}set step(t){this._hostElement.step=t+"",this._cdr.detectChanges()}get disabled(){return(0,e.L39)(this._hostElement.disabled)}set disabled(t){this._hostElement.disabled=t,this._cdr.detectChanges(),this._slider.disabled!==this.disabled&&(this._slider.disabled=this.disabled)}get percentage(){return this._slider.min>=this._slider.max?this._slider._isRtl?1:0:(this.value-this._slider.min)/(this._slider.max-this._slider.min)}get fillPercentage(){return this._slider._cachedWidth?0===this._translateX?0:this.translateX/this._slider._cachedWidth:this._slider._isRtl?1:0}_setIsFocused(t){this._isFocused=t}constructor(t,i,o,s){this._ngZone=t,this._elementRef=i,this._cdr=o,this._slider=s,this.valueChange=new e.bkB,this.dragStart=new e.bkB,this.dragEnd=new e.bkB,this.thumbPosition=G.END,this._valuetext=(0,e.vPA)(""),this._knobRadius=8,this._tickMarkOffset=3,this._isActive=!1,this._isFocused=!1,this._hasSetInitialValue=!1,this._destroyed=new z.B,this._skipUIUpdate=!1,this._onTouchedFn=()=>{},this._isControlInitialized=!1,this._platform=(0,e.WQX)(nn.OD),this._hostElement=i.nativeElement,this._ngZone.runOutsideAngular(()=>{this._hostElement.addEventListener("pointerdown",this._onPointerDown.bind(this)),this._hostElement.addEventListener("pointermove",this._onPointerMove.bind(this)),this._hostElement.addEventListener("pointerup",this._onPointerUp.bind(this))})}ngOnDestroy(){this._hostElement.removeEventListener("pointerdown",this._onPointerDown),this._hostElement.removeEventListener("pointermove",this._onPointerMove),this._hostElement.removeEventListener("pointerup",this._onPointerUp),this._destroyed.next(),this._destroyed.complete(),this.dragStart.complete(),this.dragEnd.complete()}initProps(){this._updateWidthInactive(),this.disabled!==this._slider.disabled&&(this._slider.disabled=!0),this.step=this._slider.step,this.min=this._slider.min,this.max=this._slider.max,this._initValue()}initUI(){this._updateThumbUIByValue()}_initValue(){this._hasSetInitialValue=!0,void 0===this._initialValue?this.value=this._getDefaultValue():(this._hostElement.value=this._initialValue,this._updateThumbUIByValue(),this._slider._onValueChange(this),this._cdr.detectChanges())}_getDefaultValue(){return this.min}_onBlur(){this._setIsFocused(!1),this._onTouchedFn()}_onFocus(){this._slider._setTransition(!1),this._slider._updateTrackUI(this),this._setIsFocused(!0)}_onChange(){this.valueChange.emit(this.value),this._isActive&&this._updateThumbUIByValue({withAnimation:!0})}_onInput(){this._onChangeFn?.(this.value),(this._slider.step||!this._isActive)&&this._updateThumbUIByValue({withAnimation:!0}),this._slider._onValueChange(this)}_onNgControlValueChange(){(!this._isActive||!this._isFocused)&&(this._slider._onValueChange(this),this._updateThumbUIByValue()),this._slider.disabled=this._formControl.disabled}_onPointerDown(t){if(!this.disabled&&0===t.button){if(this._platform.IOS){const i=this._slider._isCursorOnSliderThumb(t,this._slider._getThumb(this.thumbPosition)._hostElement.getBoundingClientRect());return this._isActive=i,this._updateWidthActive(),void this._slider._updateDimensions()}this._isActive=!0,this._setIsFocused(!0),this._updateWidthActive(),this._slider._updateDimensions(),this._slider.step||this._updateThumbUIByPointerEvent(t,{withAnimation:!0}),this.disabled||(this._handleValueCorrection(t),this.dragStart.emit({source:this,parent:this._slider,value:this.value}))}}_handleValueCorrection(t){this._skipUIUpdate=!0,setTimeout(()=>{this._skipUIUpdate=!1,this._fixValue(t)},0)}_fixValue(t){const i=t.clientX-this._slider._cachedLeft,o=this._slider._cachedWidth,s=0===this._slider.step?1:this._slider.step,a=Math.floor((this._slider.max-this._slider.min)/s),m=Math.round((this._slider._isRtl?1-i/o:i/o)*a)/a*(this._slider.max-this._slider.min)+this._slider.min,v=Math.round(m/s)*s;if(v===this.value)return this._slider._onValueChange(this),void(this._slider.step>0?this._updateThumbUIByValue():this._updateThumbUIByPointerEvent(t,{withAnimation:this._slider._hasAnimation}));this.value=v,this.valueChange.emit(this.value),this._onChangeFn?.(this.value),this._slider._onValueChange(this),this._slider.step>0?this._updateThumbUIByValue():this._updateThumbUIByPointerEvent(t,{withAnimation:this._slider._hasAnimation})}_onPointerMove(t){!this._slider.step&&this._isActive&&this._updateThumbUIByPointerEvent(t)}_onPointerUp(){this._isActive&&(this._isActive=!1,this._platform.SAFARI&&this._setIsFocused(!1),this.dragEnd.emit({source:this,parent:this._slider,value:this.value}),setTimeout(()=>this._updateWidthInactive(),this._platform.IOS?10:0))}_clamp(t){const i=this._tickMarkOffset;return Math.max(Math.min(t,this._slider._cachedWidth-this._tickMarkOffset),i)}_calcTranslateXByValue(){return this._slider._isRtl?(1-this.percentage)*(this._slider._cachedWidth-2*this._tickMarkOffset)+this._tickMarkOffset:this.percentage*(this._slider._cachedWidth-2*this._tickMarkOffset)+this._tickMarkOffset}_calcTranslateXByPointerEvent(t){return t.clientX-this._slider._cachedLeft}_updateWidthActive(){}_updateWidthInactive(){this._hostElement.style.padding=`0 ${this._slider._inputPadding}px`,this._hostElement.style.width=`calc(100% + ${this._slider._inputPadding-2*this._tickMarkOffset}px)`,this._hostElement.style.left=`-${this._slider._rippleRadius-this._tickMarkOffset}px`}_updateThumbUIByValue(t){this.translateX=this._clamp(this._calcTranslateXByValue()),this._updateThumbUI(t)}_updateThumbUIByPointerEvent(t,i){this.translateX=this._clamp(this._calcTranslateXByPointerEvent(t)),this._updateThumbUI(i)}_updateThumbUI(t){this._slider._setTransition(!!t?.withAnimation),this._slider._onTranslateXChange(this)}writeValue(t){(this._isControlInitialized||null!==t)&&(this.value=t)}registerOnChange(t){this._onChangeFn=t,this._isControlInitialized=!0}registerOnTouched(t){this._onTouchedFn=t}setDisabledState(t){this.disabled=t}focus(){this._hostElement.focus()}blur(){this._hostElement.blur()}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(e.SKi),e.rXU(e.aKT),e.rXU(e.gRc),e.rXU(on))};static#t=this.\u0275dir=e.FsC({type:n,selectors:[["input","matSliderThumb",""]],hostAttrs:["type","range",1,"mdc-slider__input"],hostVars:1,hostBindings:function(i,o){1&i&&e.bIt("change",function(){return o._onChange()})("input",function(){return o._onInput()})("blur",function(){return o._onBlur()})("focus",function(){return o._onFocus()}),2&i&&e.BMQ("aria-valuetext",o._valuetext())},inputs:{value:[2,"value","value",e.Udg]},outputs:{valueChange:"valueChange",dragStart:"dragStart",dragEnd:"dragEnd"},exportAs:["matSliderThumb"],standalone:!0,features:[e.Jv_([qs,{provide:so,useExisting:n}]),e.GFd]})}return n})(),Pn=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=e.$C({type:n});static#i=this.\u0275inj=e.G2t({imports:[Lt.yE,Lt.pZ]})}return n})();var Js=l(66915),co=l(64566),ea=l(63365),ta=l(60286),po=l(35650),dt=l(61295),xt=l(13409),uo=l(59e3);const ia=(n,_,t)=>({"justify-between":n,"justify-start":_,"gap-2":t}),na=()=>["outline","outline-blue-600"],oa=()=>[""];function _a(n,_){if(1&n&&e.nrm(0,"div",11),2&n){const t=e.XpG().$implicit;e.HbH(t.imageClass)}}function sa(n,_){if(1&n&&(e.j41(0,"span",10),e.EFF(1),e.k0s()),2&n){const t=e.XpG().$implicit;e.R7$(),e.JRh(t.title)}}function aa(n,_){if(1&n){const t=e.RV6();e.j41(0,"li")(1,"button",7),e.bIt("click",function(){const o=e.eBV(t).$implicit,s=e.XpG();return e.Njj(s.handleThemeSelected(o))}),e.j41(2,"div",8),e.DNE(3,_a,1,2,"div",9)(4,sa,2,1,"span",10),e.k0s()()()}if(2&n){const t=_.$implicit,i=e.XpG();e.R7$(),e.Y8G("matTooltip",t.title)("lang",i.lang()),e.BMQ("aria-label",t.arialLabel)("data-test-skin",t.id),e.R7$(),e.HbH(i.selectedTheme()===t?e.lJ4(7,na):e.lJ4(8,oa)),e.R7$(),e.vxM(t.imageClass?3:4)}}function ra(n,_){if(1&n){const t=e.RV6();e.j41(0,"div",6)(1,"mat-slider",12)(2,"input",13,0),e.bIt("valueChange",function(o){e.eBV(t);const s=e.XpG();return e.Njj(s.handleSliderChange(o,!1,!0))})("input",function(){e.eBV(t);const o=e.sdS(3),s=e.XpG();return e.Njj(s.handleSliderChange(o.value,!0,!1))}),e.k0s()(),e.j41(4,"div",14)(5,"span"),e.pXf(6,1),e.k0s(),e.j41(7,"span"),e.EFF(8),e.k0s()()()}if(2&n){const t=e.sdS(3),i=e.XpG();e.R7$(),e.Y8G("min",0)("max",100)("showTickMarks",!1),e.R7$(),e.Y8G("value",i.opacity()),e.R7$(6),e.SpI("",t.value,"%")}}let sn=(()=>{class n{constructor(t,i,o,s){this.store=t,this.sceneService=i,this.paintService=o,this.vendorAnalyticsService=s,this.skinUIConfig={"integumentary system":{title:$localize`Integumentary System`},off:{id:"off",title:$localize`Off`,arialLabel:$localize`Off`},"dark skin":{id:"dark",title:$localize`Dark Skin`,imageClass:"dark"},"medium skin":{id:"medium",title:$localize`Medium Skin`,imageClass:"medium"},"light skin":{id:"light",title:$localize`Light Skin`,imageClass:"light"},"fair skin":{id:"fair",title:$localize`Fair Skin`,imageClass:"fair"},"transparent skin":{id:"transparent",title:$localize`Transparent Skin`,imageClass:"transparent"}},this.offSkinTheme={id:"off",title:$localize`Off`,arialLabel:$localize`Turn off Skin`,objectVariants:{}},this.lang=e.hFB.required(),this.schema=e.hFB.required(),this.contentId=e.hFB.required(),this.contentType=e.hFB.required(),this.schemaTitle=(0,e.EWP)(()=>{const a=this.schema(),r=a.title.toLowerCase();return this.skinUIConfig[r]?.title??a.title}),this.compact=(0,e.hFB)(!1),this.themes=(0,e.EWP)(()=>{const a=function la(n,_){return n.map(t=>{const i=t.title.toLowerCase(),o=_[i],s=o?.id??i.replace(/\s/g,""),a=o?.title??t.title,r=o?.arialLabel??$localize`Switch to ${a}`,u=Object.keys(t.objectVariants).some(v=>v.includes("female"))?"female":"male";let m=o?.imageClass?`view-skin__image--${u}--${o.imageClass}`:"";return{...t,id:s,title:a,arialLabel:r,imageClass:m}})}(this.schema().themes,this.skinUIConfig);return[this.offSkinTheme,...a]}),this.selectedThemeIndex=(0,e.EWP)(()=>{const a=this.themes(),r=this.nodes();return a.findIndex((u,m)=>u===this.offSkinTheme?this.allObjectIds().every(R=>!1===r[R]?.shown):Object.entries(u.objectVariants).every(([v,R])=>r[v]?.variant===R))}),this.selectedTheme=(0,e.EWP)(()=>this.themes()[this.selectedThemeIndex()]),this.isOffThemeSelected=(0,e.EWP)(()=>this.selectedTheme()===this.offSkinTheme),this.allObjectIds=(0,e.EWP)(()=>{const r=this.themes().reduce((u,m)=>{const v=Object.keys(m.objectVariants);return u.push(...v),u},[]);return Array.from(new Set(r))}),this.selectedObjectIds=(0,e.EWP)(()=>Object.keys(this.selectedTheme()?.objectVariants??{})),this.selectedSkinId=(0,e.EWP)(()=>this.selectedObjectIds().find(a=>a.includes("skin"))),this.opacity=(0,e.EWP)(()=>{const a=this.nodes(),r=this.selectedSkinId(),m=a[r]?.paint;return this.getObjectOpacity(m?.opacity)??100}),this.nodes=(0,h.ot)(this.store.select(xt.z.getNodes))}toggleVisibility(t){t||this.handleThemeSelected(this.offSkinTheme)}handleThemeSelected(t){if(t===this.offSkinTheme){const r=this.allObjectIds();this.store.dispatch(new dt.yr(!1,r)),this.store.dispatch(new dt._n({}))}else{const{objectVariants:r}=t,u=Object.keys(r);this.store.dispatch(new dt.yr(!0,u)),this.store.dispatch(new dt._n(r))}const i=qi.l.toTitleCase(t.id),o=this.lang(),s=this.contentId(),a=this.contentType();this.vendorAnalyticsService.track("Skin Type",{skinType:i,contentId:s,contentType:a,lang:o})}handleSliderChange(t,i,o){const s=t/100,a=this.selectedObjectIds();if(i&&a.forEach(r=>{this.setObjectOpacity(r,s)}),o){const r=a.reduce((u,m)=>{const v=this.paintService.getColor(m);if(v){const R=(0,ea.H)(v);u[m]=R}return u},{});this.store.dispatch(new dt.Jp(void 0,void 0,r))}}setObjectOpacity(t,i){this.sceneService.getLeafIds(t).forEach(s=>{const a=this.paintService.getColor(s)?.opacity||1;let r;Array.isArray(a)?(r=[...a],r[0]=i):"number"==typeof a&&(r=i),this.paintService.colorObject(s,{opacity:r})})}getObjectOpacity(t){if(Array.isArray(t)){const[i]=t;return i}if("number"==typeof t)return t}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(c.il),e.rXU(po.w),e.rXU(ta.s),e.rXU(uo.e))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-view-skin-variants"]],inputs:{lang:[1,"lang"],schema:[1,"schema"],contentId:[1,"contentId"],contentType:[1,"contentType"],compact:[1,"compact"]},standalone:!0,features:[e.aNF],decls:8,vars:7,consts:()=>{let t;return t=$localize`:␟fd09d25b9e69b686d3fc0154c0b316c7c9f45cec␟8036200981586016464:Opacity`,[["slider","matSliderThumb"],t,[1,"flex","flex-col","gap-1","gray-400"],[1,"uppercase","text-2xs"],[1,"flex","flex-col","gap-1","p-3","border","border-gray-200","border-solid","rounded"],[1,"flex","flex-row","item-center","text-2xs",3,"ngClass"],[1,"grow"],["type","button","app-view-button","","buttonSize","small","buttonShape","rounded","buttonTheme","transparent","matTooltipPosition","below","data-test","skinToggleButton",1,"rounded-sm","focus:rounded-sm","focus:outline","focus:outline-blue-600",3,"click","matTooltip","lang"],[1,"flex","items-center","justify-center","w-10","h-10","text-black","bg-gray-100","rounded-sm"],["role","img",1,"w-full","h-full","bg-center","bg-repeat","bg-cover","rounded-sm",3,"class"],[1,"break-words","hyphens-auto","text-2xs"],["role","img",1,"w-full","h-full","bg-center","bg-repeat","bg-cover","rounded-sm"],[1,"!w-full","!m-0",3,"min","max","showTickMarks"],["matSliderThumb","",3,"valueChange","input","value"],[1,"flex","items-center","justify-between","uppercase","text-2xs"]]},template:function(i,o){1&i&&(e.j41(0,"div",2)(1,"div",3),e.EFF(2),e.k0s(),e.j41(3,"div",4)(4,"ul",5),e.Z7z(5,aa,5,9,"li",null,e.fX1),e.k0s(),e.DNE(7,ra,9,5,"div",6),e.k0s()()),2&i&&(e.R7$(2),e.JRh(o.schemaTitle()),e.R7$(2),e.Y8G("ngClass",e.sMw(3,ia,!o.compact(),o.compact(),o.compact())),e.R7$(),e.Dyx(o.themes()),e.R7$(2),e.vxM(!1===o.isOffThemeSelected()?7:-1))},dependencies:[p.MD,p.YU,Pn,lo,_n,j.uc,j.oV,N.C,P.ri],styles:[".view-skin__image--male--fair{background-image:url(maleskin_variants_fair.png)}.view-skin__image--male--light{background-image:url(maleskin_variants_light.png)}.view-skin__image--male--medium{background-image:url(maleskin_variants_medium.png)}.view-skin__image--male--dark{background-image:url(maleskin_variants_dark.png)}.view-skin__image--male--transparent{background-image:url(maleskin_variants_transparent.png)}.view-skin__image--female--fair{background-image:url(femaleskin_variants_fair.png)}.view-skin__image--female--light{background-image:url(femaleskin_variants_light.png)}.view-skin__image--female--medium{background-image:url(femaleskin_variants_medium.png)}.view-skin__image--female--dark{background-image:url(femaleskin_variants_dark.png)}.view-skin__image--female--transparent{background-image:url(femaleskin_variants_transparent.png)}\n"],encapsulation:2})}return n})();const ca=(n,_)=>_.name;function da(n,_){if(1&n&&e.nrm(0,"app-view-skin-variants",6,0),2&n){const t=e.XpG();e.Y8G("compact",t.compact())("schema",t.skinVariantsSchema())("lang",t.lang())("contentId",t.storyId())("contentType",t.storyType())}}function pa(n,_){if(1&n){const t=e.RV6();e.j41(0,"li",10)(1,"div",11),e.EFF(2),e.k0s(),e.j41(3,"div",12)(4,"button",13),e.bIt("click",function(){const o=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.toggleGroupVisibilityClick(o))}),e.j41(5,"div",14),e.nrm(6,"div",15),e.k0s()(),e.j41(7,"div",16)(8,"mat-slider",17)(9,"input",18,1),e.bIt("valueChange",function(o){const s=e.eBV(t).$implicit,a=e.XpG(2);return e.Njj(a.handleSliderChange(s,o,!1,!0))})("input",function(){const o=e.eBV(t).$implicit,s=e.sdS(10),a=e.XpG(2);return e.Njj(a.handleSliderChange(o,s.value,!0,!1))}),e.k0s()()()()()}if(2&n){const t=_.$implicit,i=e.XpG(2);e.AVh("view-visibility-layers__list-item--hidden",!t.visible),e.R7$(2),e.JRh(t.label),e.R7$(2),e.Y8G("buttonTheme","transparent-fill")("matTooltip",t.visible?i.hideLayersTooltip:i.showLayersTooltip),e.BMQ("aria-label",i.getGroupAriaLabel(t.name,t.visible)),e.R7$(2),e.Y8G("className",t.imageClassName),e.R7$(2),e.Y8G("min",0)("max",t.layers.length)("step",1)("showTickMarks",!0),e.R7$(),e.Y8G("value",t.position)}}function ua(n,_){if(1&n&&(e.j41(0,"ul",7),e.Z7z(1,pa,11,12,"li",9,ca),e.k0s()),2&n){const t=e.XpG();e.R7$(),e.Dyx(t.viewGroups())}}function ha(n,_){if(1&n){const t=e.RV6();e.j41(0,"div",8)(1,"button",19),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.handleToggleAllClick(o.viewGroups(),o.allGroupsHidden()))}),e.EFF(2),e.k0s()()}if(2&n){const t=e.XpG();e.R7$(2),e.SpI(" ",t.allGroupsHidden()?t.showAllLayersTooltip:t.hideAllLayersTooltip," ")}}let Un=(()=>{class n{constructor(t,i,o,s){this.store=t,this.viewService=i,this.visibilityLayersService=o,this.elementRef=s,this.defaultSystemToImage={label:$localize`Layer`,icon:"layer"},this.systemToImage={"muscular system":{label:$localize`muscular system`,icon:"muscular-system"},"connective tissue":{label:$localize`connective tissue`,icon:"connective-tissue"},"skeletal system":{label:$localize`skeletal system`,icon:"skeletal-system"},"respiratory system":{label:$localize`respiratory system`,icon:"respiratory-system"},"endocrine system":{label:$localize`endocrine system`,icon:"endocrine-system"},"digestive system":{label:$localize`digestive system`,icon:"digestive-system"},"reproductive system":{label:$localize`reproductive system`,icon:"reproductive-system"},"urinary system":{label:$localize`urinary system`,icon:"urinary-system"},"cardiovascular system":{label:$localize`cardiovascular system`,icon:"cardiovascular-system"},"lymphatic system":{label:$localize`lymphatic system`,icon:"lymphatic-system"},"nervous system":{label:$localize`nervous system`,icon:"nervous-system"},"integumentary system":{label:$localize`integumentary system`,icon:"integumentary-system"}},this.showAllLayersTooltip=$localize`Show All Anatomy Layers`,this.hideAllLayersTooltip=$localize`Hide All Anatomy Layers`,this.showLayersTooltip=$localize`Show Layer`,this.hideLayersTooltip=$localize`Hide Layer`,this.skinLayersComponent=(0,e.ebz)(sn),this.selectedChapterLayerGroups=(0,h.ot)(this.store.select(b.N.getSelectedChapterLayerGroups)),this.skinVariantsSchema=(0,h.ot)(this.store.select(Ce.t.getVariantSchema("skin"))),this.skinLayersUI=(0,h.ot)(this.store.select(O.dF.getUIEntry(E.U.SkinLayers))),this.visibilityLayersUI=(0,h.ot)(this.store.select(O.dF.getUIEntry(E.U.VisibilityLayers))),this.lang=(0,h.ot)(this.store.select(f.Pf.getViewLanguage)),this.storyId=(0,h.ot)(this.store.select(Ce.t.getStoryId)),this.storyType=(0,h.ot)(this.store.select(Ce.t.getStoryType)),this.compact=(0,e.hFB)(!1),this.showSkinLayers=(0,e.EWP)(()=>{const a=this.skinVariantsSchema(),r=this.skinLayersUI();return!(0,V.isNil)(a)&&r.enable}),this.showVisibilityLayers=(0,e.EWP)(()=>{const a=this.viewGroups(),r=this.visibilityLayersUI();return a.length>0&&r.enable}),this.viewGroups=(0,e.EWP)(()=>{const a=this.selectedChapterLayerGroups();return this.createViewLayerGroups(a)}),this.allGroupsHidden=(0,e.EWP)(()=>this.viewGroups().every(r=>!r.visible))}handleKeyPress(){this.viewService.elementHasFocus(this.elementRef.nativeElement)&&!this.viewService.isMaterialMenuOut()&&this.viewService.toggleLayers(!1)}handleSliderChange(t,i,o,s){this.setLayerGroupVisibility([{...t,position:i}],o,s)}toggleGroupVisibilityClick(t){const i=this.visibilityLayersService.computeGroupPositionsByFraction([t],t.visible?0:1);this.setLayerGroupVisibility(i,!0,!0)}handleToggleAllClick(t,i){this.toggleLayers(t,i)}getGroupAriaLabel(t,i){return i?$localize`Hide ${t} Layer`:$localize`Show ${t} Layer`}toggleLayers(t,i){const o=this.visibilityLayersService.computeGroupPositionsByFraction(t,i?1:0);this.setLayerGroupVisibility(o,!0,!0),this.skinLayersComponent()?.toggleVisibility(i)}setLayerGroupVisibility(t,i,o){const s=this.store.selectSnapshot(b.N.getSelectedChapterId);i&&this.visibilityLayersService.syncLayerGroupsToScene(t),o&&this.visibilityLayersService.syncLayerGroupsToState(s,t,!0)}createViewLayerGroups(t){return t.map((i,o)=>{const{name:s}=i,a=o+1,r=0!==i.position,u=s.toLowerCase(),m=this.systemToImage[u]??this.defaultSystemToImage,v=m===this.defaultSystemToImage?`${m.label} ${a}`:m.label,_e="view-visibility-layers__image",ke=[_e,`${_e}--${m.icon}`].join(" ");return{...i,visible:r,label:v,imageClassName:ke}})}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(c.il),e.rXU(F.z),e.rXU(co.u),e.rXU(e.aKT))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-view-visibility-layers"]],viewQuery:function(i,o){1&i&&e.wEZ(o.skinLayersComponent,sn,5),2&i&&e.NyB()},hostBindings:function(i,o){1&i&&e.bIt("keydown.escape",function(){return o.handleKeyPress()},!1,e.EBC)},inputs:{compact:[1,"compact"]},standalone:!0,features:[e.aNF],decls:7,vars:6,consts:()=>{let t;return t=$localize`:␟3acd4e3a84c66d140da3c19c36a4d0d7ce688e6a␟6086371624662249440: Changing the value of the sliders will modify visibility of different layers of the model `,[["skinLayers",""],["slider","matSliderThumb"],t,["role","dialog","cdkTrapFocus","",1,"view-visibility-layers",3,"cdkTrapFocusAutoCapture"],[1,"sr-only"],[1,"flex","flex-col","flex-auto","gap-4","view-visibility-layers__list-wraper"],[3,"compact","schema","lang","contentId","contentType"],[1,"view-visibility-layers__list"],[1,"view-visibility-layers__toggle"],[1,"view-visibility-layers__list-item",3,"view-visibility-layers__list-item--hidden"],[1,"view-visibility-layers__list-item"],[1,"mb-1","uppercase","text-2xs"],[1,"view-visibility-layers__slider"],["type","button","app-view-button","","buttonSize","small","buttonShape","square","data-test","viewToolsButton",1,"view-visibility-layers__slider-button",3,"click","buttonTheme","matTooltip"],[1,"relative","flex","items-center","justify-center"],["role","img",3,"className"],[1,"pl-1","pr-6","grow"],[2,"width","100% !important",3,"min","max","step","showTickMarks"],["matSliderThumb","",3,"valueChange","input","value"],["app-view-button","","buttonTheme","light-gray-outline","buttonShape","rounded","buttonSize","small","cdkFocusInitial","",1,"w-full",3,"click"]]},template:function(i,o){1&i&&(e.j41(0,"div",3)(1,"span",4),e.pXf(2,2),e.k0s(),e.j41(3,"div",5),e.DNE(4,da,2,5,"app-view-skin-variants",6)(5,ua,3,0,"ul",7),e.k0s(),e.DNE(6,ha,3,1,"div",8),e.k0s()),2&i&&(e.AVh("view-visibility-layers--overflow",!o.compact()),e.Y8G("cdkTrapFocusAutoCapture",!o.compact()),e.R7$(4),e.vxM(o.showSkinLayers()?4:-1),e.R7$(),e.vxM(o.showVisibilityLayers()?5:-1),e.R7$(),e.vxM(o.showVisibilityLayers()?6:-1))},dependencies:[k.kB,j.uc,j.oV,Pn,lo,_n,N.C,P.ri,sn],styles:[".view-visibility-layers{display:flex;flex-direction:column;position:relative;max-height:100%}.view-visibility-layers__toggle{padding:20px 0}.view-visibility-layers__list{display:flex;flex-direction:column;gap:16px}.view-visibility-layers__list-item{color:#374a68}.view-visibility-layers__list-item--hidden{color:#8196b1}.view-visibility-layers__slider{display:flex;align-items:center;border:1px solid #d7e0ea;border-radius:4px}.view-visibility-layers__slider-button{border-right:1px solid #d7e0ea!important}.view-visibility-layers__image{display:inline-block;width:20px;height:20px;background-repeat:no-repeat;background-position:center center;background-size:contain}.view-visibility-layers__image--muscular-system{background-image:url(muscular-system.svg)}.view-visibility-layers__image--connective-tissue{background-image:url(connective-tissue.svg)}.view-visibility-layers__image--skeletal-system{background-image:url(skeletal-system.svg)}.view-visibility-layers__image--respiratory-system{background-image:url(respiratory-system.svg)}.view-visibility-layers__image--endocrine-system{background-image:url(endocrine-system.svg)}.view-visibility-layers__image--digestive-system{background-image:url(digestive-system.svg)}.view-visibility-layers__image--reproductive-system{background-image:url(reproductive-system.svg)}.view-visibility-layers__image--urinary-system{background-image:url(urinary-system.svg)}.view-visibility-layers__image--cardiovascular-system{background-image:url(cardiovascular-system.svg)}.view-visibility-layers__image--lymphatic-system{background-image:url(lymphatic-system.svg)}.view-visibility-layers__image--nervous-system{background-image:url(nervous-system.svg)}.view-visibility-layers__image--integumentary-system{background-image:url(integumentary-system.svg)}.view-visibility-layers__image--layer{background-image:url(layer.svg)}.view-visibility-layers--overflow .view-visibility-layers__toggle{background-color:#fff;position:sticky!important;bottom:0}@media (hover: none){.view-visibility-layers input[type=range]{pointer-events:none!important}.view-visibility-layers input[type=range]::-webkit-slider-thumb{pointer-events:all!important}.view-visibility-layers input[type=range]::-moz-range-thumb{pointer-events:all!important}.view-visibility-layers input[type=range]::-ms-thumb{pointer-events:all!important}}\n"],encapsulation:2,changeDetection:0})}return n})();var ga=l(4763),an=l(70914);function Ea(n,_){if(1&n&&(e.j41(0,"li",4)(1,"div",5),e.EFF(2),e.k0s(),e.j41(3,"div",6),e.nrm(4,"app-html",7),e.k0s()()),2&n){const t=_.$implicit,i=_.$index;e.R7$(2),e.SpI("",i+1,"."),e.R7$(2),e.Y8G("markdownText",t.label)}}let Sa=(()=>{class n{constructor(){this.references=e.hFB.required()}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-view-references"]],inputs:{references:[1,"references"]},standalone:!0,features:[e.aNF],decls:6,vars:0,consts:()=>{let t;return t=$localize`:␟0dc2e6fb6d0244d5024e73ede409a45d5b0c8a64␟449712922219700420:References`,[t,[1,"flex","flex-row","items-center","pb-3","font-bold"],["data-test","view-references",1,"view-references"],[1,"flex","flex-col","gap-4"],[1,"flex","flex-row","gap-1","text-xs"],[1,"text-xs","text-right",2,"flex","0 0 20px"],[1,"flex-auto","w-full"],[1,"!text-gray-900",3,"markdownText"]]},template:function(i,o){1&i&&(e.j41(0,"div",1),e.pXf(1,0),e.k0s(),e.j41(2,"div",2)(3,"ol",3),e.Z7z(4,Ea,5,2,"li",4,e.fX1),e.k0s()()),2&i&&(e.R7$(4),e.Dyx(o.references()))},dependencies:[an.V],styles:[".view-references{color:#374a68}\n"],encapsulation:2,changeDetection:0})}return n})();var Ci=l(17766);const ma=n=>({"p-4 rounded shadow":n}),fa=(n,_)=>({hidden:n,"pt-6":_}),Ta=n=>({"rotate-90":n});function ba(n,_){if(1&n&&(e.j41(0,"span"),e.pXf(1,0),e.k0s()),2&n){const t=e.XpG(3);e.R7$(),e.uP7(t.updateDateText()),e.nnv(1)}}function va(n,_){1&n&&(e.j41(0,"span"),e.pXf(1,1),e.k0s())}function Oa(n,_){if(1&n){const t=e.RV6();e.j41(0,"button",12),e.bIt("click",function(){e.eBV(t);const o=e.XpG(2);return e.Njj(o.open.set(!o.open()))}),e.j41(1,"div",13)(2,"span",14),e.DNE(3,ba,2,1,"span")(4,va,2,0,"span"),e.k0s(),e.nrm(5,"app-icon",15),e.k0s()()}if(2&n){let t;const i=e.XpG(2);e.R7$(3),e.vxM(null!=(t=i.sourceInfo().reviewed)&&t.enabled&&null!=(t=i.sourceInfo().audit)&&t.enabled&&i.updateDate()?3:4),e.R7$(2),e.Y8G("ngClass",e.eq3(2,Ta,i.open()))}}function Ca(n,_){1&n&&e.nrm(0,"app-badge",17)}function Ia(n,_){if(1&n&&(e.j41(0,"div")(1,"span",20),e.pXf(2,2),e.k0s(),e.j41(3,"time"),e.EFF(4),e.k0s()()),2&n){const t=e.XpG(3);e.R7$(3),e.BMQ("datetime",t.updateDateTime()),e.R7$(),e.JRh(t.updateDateText())}}function Ma(n,_){if(1&n&&(e.j41(0,"a",19)(1,"span"),e.pXf(2,3),e.k0s(),e.nrm(3,"app-icon",21),e.k0s()),2&n){const t=e.XpG(3);e.BMQ("href",t.sourceInfo().reviewed.url,e.B4B)}}function wa(n,_){if(1&n&&(e.j41(0,"div")(1,"em",20),e.pXf(2,4),e.k0s(),e.EFF(3),e.k0s()),2&n){const t=e.XpG(4);e.R7$(3),e.SpI(" ",t.sourceInfo().collaborated.authors," ")}}function Aa(n,_){if(1&n&&(e.j41(0,"div",16),e.nrm(1,"app-badge",22),e.DNE(2,wa,4,1,"div"),e.k0s()),2&n){const t=e.XpG(3);e.R7$(2),e.vxM(t.sourceInfo().collaborated.authors?2:-1)}}function ya(n,_){if(1&n&&(e.j41(0,"div",10)(1,"div",16),e.DNE(2,Ca,1,0,"app-badge",17),e.j41(3,"div",18),e.DNE(4,Ia,5,2,"div")(5,Ma,4,1,"a",19),e.k0s()(),e.DNE(6,Aa,3,1,"div",16),e.k0s()),2&n){let t,i,o,s;const a=e.XpG(2);e.R7$(2),e.vxM(null!=(t=a.sourceInfo().reviewed)&&t.enabled?2:-1),e.R7$(2),e.vxM(null!=(i=a.sourceInfo().audit)&&i.enabled&&a.updateDate()?4:-1),e.R7$(),e.vxM(null!=(o=a.sourceInfo().reviewed)&&o.url?5:-1),e.R7$(),e.vxM(null!=(s=a.sourceInfo().collaborated)&&s.enabled?6:-1)}}function Na(n,_){if(1&n&&(e.j41(0,"div",11),e.nrm(1,"app-view-references",23),e.k0s()),2&n){const t=e.XpG(2);e.R7$(),e.Y8G("references",t.references())}}function Ra(n,_){if(1&n&&(e.j41(0,"div")(1,"em",20),e.pXf(2,5),e.k0s(),e.EFF(3),e.k0s()),2&n){const t=e.XpG(3);e.R7$(3),e.SpI(" ",t.updateDateText(),"")}}function Pa(n,_){if(1&n&&(e.j41(0,"div",10),e.nrm(1,"app-view-references",23),e.DNE(2,Ra,4,1,"div"),e.k0s()),2&n){let t;const i=e.XpG(2);e.R7$(),e.Y8G("references",i.references()),e.R7$(),e.vxM(null!=(t=i.sourceInfo().audit)&&t.enabled&&i.updateDateText()?2:-1)}}function Ua(n,_){if(1&n&&(e.j41(0,"div")(1,"em",20),e.pXf(2,6),e.k0s(),e.EFF(3),e.k0s()),2&n){const t=e.XpG(2);e.R7$(3),e.SpI(" ",t.updateDateText(),"")}}function Va(n,_){if(1&n&&(e.j41(0,"div",7),e.DNE(1,Oa,6,4,"button",8),e.j41(2,"div",9),e.DNE(3,ya,7,4,"div",10)(4,Na,2,1,"div",11)(5,Pa,3,2,"div",10)(6,Ua,4,1,"div"),e.k0s()()),2&n){let t;const i=e.XpG();e.Y8G("ngClass",e.eq3(7,ma,i.toggleable()&&i.open())),e.R7$(),e.vxM(i.toggleable()?1:-1),e.R7$(),e.Y8G("ngClass",e.l_i(9,fa,i.toggleable()&&!i.open(),i.toggleable()&&i.open())),e.R7$(),e.vxM(i.displaySources()?3:-1),e.R7$(),e.vxM(i.displayReferences()&&i.displaySources()?4:-1),e.R7$(),e.vxM(i.displayReferences()&&!i.displaySources()?5:-1),e.R7$(),e.vxM(!i.displayReferences()&&!i.displaySources()&&null!=(t=i.sourceInfo().audit)&&t.enabled&&i.updateDateText()?6:-1)}}let rn=(()=>{class n{constructor(t){this.store=t,this.sourceInfo=(0,h.ot)(this.store.select(Ce.t.getStorySourceInfo)),this.storyType=(0,h.ot)(this.store.select(Ce.t.getStoryType)),this.selectedBookmark=(0,h.ot)(this.store.select(Vt.J.getSelectedBookmark)),this.toggleable=(0,e.hFB)(!1),this.open=(0,e.vPA)(!1),this.showSources=(0,e.EWP)(()=>this.storyType()===Ci.c.Module),this.updateDate=(0,e.EWP)(()=>this.selectedBookmark()?.update_date_time??this.selectedBookmark()?.create_date_time),this.updateDateTime=(0,e.EWP)(()=>{const i=this.updateDate();return i?new Date(i).toISOString():void 0}),this.updateDateText=(0,e.EWP)(()=>{const i=this.updateDate();return i?new Date(i).toLocaleDateString():void 0}),this.displaySources=(0,e.EWP)(()=>{const i=this.sourceInfo();return this.showSources()&&i?.reviewed?.enabled||i?.collaborated?.enabled}),this.displayReferences=(0,e.EWP)(()=>this.references().length>0),this.references=(0,e.EWP)(()=>this.sourceInfo()?.references??[])}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(c.il))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-view-source-info"]],inputs:{toggleable:[1,"toggleable"]},standalone:!0,features:[e.aNF],decls:1,vars:1,consts:()=>{let t,i,o,s,a,r,u,m,v;return t=$localize`:␟ec2c1d22b6e2207023be0f04e37c533e4e5cc7ec␟7104746773075604544:Medically reviewed on ${"\ufffd0\ufffd"}:INTERPOLATION:`,i=$localize`:␟5bbf2bcdb5d3aa2b328ab66786845485b997e0e7␟5233133710285034701:Source Information`,o=$localize`:␟8130925c3a61817eae8b407d5bbcdaaba8758d15␟429607993299883476:Medically Reviewed`,s=$localize`:␟c0036f237054be68e8a0cc165f3b71b2f874cbf1␟63496578423295101:Updated on `,a=$localize`:␟9a747d50c4db80b1cb473adfd9e5a9c9e034b7d5␟5574571308850658695:Read about our review process.`,r=$localize`:␟d5b8a08bdd48b443f541a8477c756faa70d686d5␟214207563889300286:Built in Collaboration`,u=$localize`:␟525d654f08c7e65835ec2836814a49aa1ba604f3␟4382887906654551268:Created with`,m=$localize`:␟bc56b2e58706df3bcb07aa8e07b86d26e1e3d93d␟738579991266800938:Updated on`,v=$localize`:␟bc56b2e58706df3bcb07aa8e07b86d26e1e3d93d␟738579991266800938:Updated on`,[t,i,s,a,u,m,v,[1,"transition-all",3,"ngClass"],["app-view-button","","buttonSize","2xsmall",1,"w-full"],[1,"flex","flex-col","gap-6","[&_a]:break-all","text-xs",3,"ngClass"],[1,"flex","flex-col","gap-6"],["id","view-source-info-references"],["app-view-button","","buttonSize","2xsmall",1,"w-full",3,"click"],[1,"flex","items-center"],[1,"text-xs"],["icon","angle-right",1,"ml-1","transition-transform",3,"ngClass"],[1,"flex","flex-col","gap-2"],["theme","blue","icon","check","label",o],[1,"flex","flex-col","gap-1"],["target","_blank","rel","noreferrer nofollow",1,"hover:underline"],[1,"font-bold"],["icon","arrow-up-right-from-square",1,"ml-1"],["theme","green","icon","check","label",r],[3,"references"]]},template:function(i,o){1&i&&e.DNE(0,Va,7,12,"div",7),2&i&&e.vxM(o.sourceInfo()?0:-1)},dependencies:[p.MD,p.YU,N.C,P.ri,B.o,D.R,ga.n,Sa],styles:[".view-source-info{color:#131c2a}.view-source-info__toggle{color:#131c2a;font-size:.75rem;line-height:1rem}\n"],encapsulation:2,changeDetection:0})}return n})();class ii{constructor(_){this.store=_,this.injector=(0,e.WQX)(e.zZn),this.defaultImage=(0,e.hFB)("/assets/images/view-chapter-thumbnail-placeholder.png"),this.chapterId=e.hFB.required(),this.chapterThumb=(0,e.EWP)(()=>{const t=this.thumbnails().get(this.chapterId());return t?t.snapshot||t.urls.small:""}),this.thumbnails=(0,h.ot)(this.store.select(Ji.K.getRegisteredThumbnails))}static#e=this.\u0275fac=function(t){return new(t||ii)(e.rXU(c.il))};static#t=this.\u0275cmp=e.VBU({type:ii,selectors:[["app-chapter-image"]],inputs:{defaultImage:[1,"defaultImage"],chapterId:[1,"chapterId"]},standalone:!0,features:[e.aNF],decls:1,vars:2,consts:[[1,"w-full","h-full","bg-cover",3,"defaultImage","lazyLoad"]],template:function(t,i){1&t&&e.nrm(0,"div",0),2&t&&e.Y8G("defaultImage",i.defaultImage())("lazyLoad",i.chapterThumb())},dependencies:[ne.Un,ne.Je],styles:["[_nghost-%COMP%]{width:100%;height:100%;display:block}"],changeDetection:0})}!function(n,_,t,i){var a,o=arguments.length,s=o<3?_:null===i?i=Object.getOwnPropertyDescriptor(_,t):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(n,_,t,i);else for(var r=n.length-1;r>=0;r--)(a=n[r])&&(s=(o<3?a(s):o>3?a(_,t,s):a(_,t))||s);o>3&&s&&Object.defineProperty(_,t,s)}([(0,c.l6)(Ji.K.getRegisteredThumbnails),function(n,_){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata("design:type",_)}(0,d.c)],ii.prototype,"thumbnails$",void 0);var xa=l(62497),Vn=l(5025);const $a=["container"],ka=n=>({"rotate-90":n});function Ga(n,_){if(1&n&&(e.j41(0,"span"),e.pXf(1,1),e.k0s()),2&n){const t=e.XpG(2);e.R7$(),e.uP7(t.updateDateText()),e.nnv(1)}}function Wa(n,_){1&n&&(e.j41(0,"span"),e.pXf(1,2),e.k0s())}function Xa(n,_){if(1&n){const t=e.RV6();e.j41(0,"div",null,0)(2,"button",3),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.toggleDetails())}),e.j41(3,"div",4)(4,"span",5),e.DNE(5,Ga,2,1,"span")(6,Wa,2,0,"span"),e.k0s(),e.nrm(7,"app-icon",6),e.k0s()()()}if(2&n){let t;const i=e.XpG();e.R7$(5),e.vxM(null!=(t=i.sourceInfo().reviewed)&&t.enabled&&null!=(t=i.sourceInfo().audit)&&t.enabled&&i.updateDate()?5:6),e.R7$(2),e.Y8G("ngClass",e.eq3(2,ka,i.open()))}}let ho=(()=>{class n{ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}constructor(t,i){this.store=t,this.popupService=i,this.ngUnsubscribe=new z.B,this.open=(0,e.vPA)(!1),this.sourceInfo=(0,h.ot)(this.store.select(Ce.t.getStorySourceInfo)),this.selectedBookmark=(0,h.ot)(this.store.select(Vt.J.getSelectedBookmark)),this.updateDate=(0,e.EWP)(()=>this.selectedBookmark()?.update_date_time??this.selectedBookmark()?.create_date_time),this.updateDateTime=(0,e.EWP)(()=>{const o=this.updateDate();return o?new Date(o).toISOString():void 0}),this.updateDateText=(0,e.EWP)(()=>{const o=this.updateDate();return o?new Date(o).toLocaleDateString():void 0})}toggleDetails(){const t=this.popupService.open({origin:this.container.nativeElement,positions:[Vn.k.Below],width:"272px",maxHeight:"484px",content:rn});this.open.set(!0),t.afterClosed$.pipe((0,g.Q)(this.ngUnsubscribe)).subscribe(()=>{this.open.set(!1)})}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(c.il),e.rXU(Vn.O))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-view-source-info-toggle"]],viewQuery:function(i,o){if(1&i&&e.GBs($a,5),2&i){let s;e.mGM(s=e.lsd())&&(o.container=s.first)}},standalone:!0,features:[e.aNF],decls:1,vars:1,consts:()=>{let t,i;return t=$localize`:␟ec2c1d22b6e2207023be0f04e37c533e4e5cc7ec␟7104746773075604544:Medically reviewed on ${"\ufffd0\ufffd"}:INTERPOLATION:`,i=$localize`:␟5bbf2bcdb5d3aa2b328ab66786845485b997e0e7␟5233133710285034701:Source Information`,[["container",""],t,i,["app-view-button","","buttonSize","2xsmall","data-test","viewSourceInfoToggle",1,"w-full","overflow-hidden","rounded",3,"click"],[1,"flex","items-center"],[1,"text-xs"],["icon","angle-right",1,"ml-1","transition-transform",3,"ngClass"]]},template:function(i,o){1&i&&e.DNE(0,Xa,8,4,"div"),2&i&&e.vxM(o.sourceInfo()?0:-1)},dependencies:[p.MD,p.YU,N.C,P.ri,B.o,D.R],changeDetection:0})}return n})();const Fa=["zones"],za=[[["","top",""]],[["","left",""]],[["","right",""]],[["","bottom",""]]],Ba=["[top]","[left]","[right]","[bottom]"];let go=(()=>{class n{constructor(){this.zoneElRef=(0,e.ebz)("zones"),this.showZones=(0,e.hFB)([]),this.verticalPadding=(0,e.hFB)(12),this.horizontalPadding=(0,e.hFB)(12),(0,e.QZP)(()=>{const t=this.zoneElRef()?.nativeElement,i=this.verticalPadding(),o=this.horizontalPadding();t?.style?.setProperty("--zone-vertical-padding",`${i}px`),t?.style?.setProperty("--zone-horizontal-padding",`${o}px`)})}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-view-zones"]],viewQuery:function(i,o){1&i&&e.wEZ(o.zoneElRef,Fa,5),2&i&&e.NyB()},inputs:{showZones:[1,"showZones"],verticalPadding:[1,"verticalPadding"],horizontalPadding:[1,"horizontalPadding"]},standalone:!0,features:[e.aNF],ngContentSelectors:Ba,decls:10,vars:4,consts:[["zones",""],[1,"view-zones"],[1,"view-zones__zone","view-zones__zone--top"],[1,"view-zones__zone","view-zones__zone--left"],[1,"view-zones__zone","view-zones__zone--right"],[1,"view-zones__zone","view-zones__zone--bottom"]],template:function(i,o){1&i&&(e.NAR(za),e.j41(0,"div",1,0)(2,"div",2),e.SdG(3),e.k0s(),e.j41(4,"div",3),e.SdG(5,1),e.k0s(),e.j41(6,"div",4),e.SdG(7,2),e.k0s(),e.j41(8,"div",5),e.SdG(9,3),e.k0s()()),2&i&&(e.R7$(2),e.Y8G("@isShown",o.showZones().includes("top")?"shown":"hidden"),e.R7$(2),e.Y8G("@isShown",o.showZones().includes("left")?"shown":"hidden"),e.R7$(2),e.Y8G("@isShown",o.showZones().includes("right")?"shown":"hidden"),e.R7$(2),e.Y8G("@isShown",o.showZones().includes("bottom")?"shown":"hidden"))},styles:['[_nghost-%COMP%]{width:100%;height:100%;--zone-vertical-padding: 12px;--zone-horizontal-padding: 12px}.view-zones[_ngcontent-%COMP%]{width:100%;height:100%;display:grid;grid-template-areas:"top top top" "left . right" "bottom bottom bottom";grid-template-columns:minmax(40px,auto) 1fr minmax(40px,auto);grid-template-rows:auto 1fr auto;padding:var(--zone-vertical-padding) var(--zone-horizontal-padding);pointer-events:none;position:absolute;z-index:20}.view-zones__zone[_ngcontent-%COMP%]{opacity:0;display:flex;gap:8px}.view-zones__zone--left[_ngcontent-%COMP%]{grid-area:left;flex-direction:column}.view-zones__zone--right[_ngcontent-%COMP%]{grid-area:right;flex-direction:column}.view-zones__zone--top[_ngcontent-%COMP%]{grid-area:top;flex-direction:row;opacity:1}.view-zones__zone--top[_ngcontent-%COMP%]:not(:empty){margin-bottom:8px}.view-zones__zone--bottom[_ngcontent-%COMP%]{grid-area:bottom;flex-direction:row;justify-content:flex-end}.view-zones__zone--bottom[_ngcontent-%COMP%]:not(:empty){margin-top:8px}'],data:{animation:[(0,x.hZ)("isShown",[(0,x.wk)("shown",(0,x.iF)({opacity:1})),(0,x.wk)("hidden",(0,x.iF)({opacity:0})),(0,x.kY)("hidden => shown",[(0,x.i0)("300ms ease-out")]),(0,x.kY)("shown => hidden",[(0,x.i0)("150ms ease-in")])])]},changeDetection:0})}return n})();var ja=l(8358),Eo=l(94604),Ha=l(22397),Dn=l(11040);let Qa=(()=>{class n{constructor(t,i,o){this.mediaService=t,this.renderer2=i,this.markdownService=o,this.audioText=(0,e.hFB)(""),this.audioLocale=(0,e.hFB)(Dn.q.id),this.playing=(0,e.geq)(!1),this.loading=(0,e.geq)(!1),this.audioId=(0,e.EWP)(()=>{const s=this.audioText();return`${this.audioLocale()}-${s}`}),(0,e.QZP)(s=>{this.audioId(),this.removeAudioPlayer(),s(()=>{this.removeAudioPlayer()})})}play(){var t=this;return(0,be.A)(function*(){if((0,V.isNil)(t.audioPlayer)){const i=t.audioLocale();yield t.setAudioPlayer(i)}t.audioPlayer.stop(),t.audioPlayer.play()})()}pause(){this.audioPlayer?.pause()}setAudioPlayer(t){var i=this;return(0,be.A)(function*(){i.removeAudioPlayer(),i.loading.set(!0),i.audioPlayer=yield i.mediaService.addAudioPlayer(i.audioId(),i.getAudioSource(t),!1),i.audioPlayer.on("play",()=>{i.playing.set(!0)}),["pause","stop","end","loaderror","playerror"].forEach(a=>{i.audioPlayer.on(a,()=>i.playing.set(!1))}),["play"].forEach(a=>{i.audioPlayer.on(a,()=>i.playing.set(!0))}),i.loading.set(!1)})()}removeAudioPlayer(){this.audioPlayer?.stop(),this.mediaService.removeAudioPlayer(this.audioId()),this.audioPlayer=null}getAudioSource(t){var i=this;return(0,be.A)(function*(){const o=i.audioText(),s=yield qi.l.getPlainTextFromMarkdown(i.renderer2,i.markdownService,o,!0);return(0,Ha.R)(s,t)})()}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(We.u),e.rXU(e.sFG),e.rXU(Y.Rl))};static#t=this.\u0275dir=e.FsC({type:n,selectors:[["","appAudioPlayer",""]],inputs:{audioText:[1,"audioText"],audioLocale:[1,"audioLocale"],playing:[1,"playing"],loading:[1,"loading"]},outputs:{playing:"playingChange",loading:"loadingChange"},exportAs:["audioPlayer"],standalone:!0})}return n})();var Ct=l(93915);function Ya(n,_){1&n&&(e.qex(0),e.pXf(1,3),e.bVm())}function qa(n,_){1&n&&(e.qex(0),e.pXf(1,4),e.bVm())}let Ka=(()=>{class n{constructor(t,i){this.store=t,this.nodeService=i,this.graph=(0,h.ot)(this.store.select(te.S.getViewGraph)),this.nodeId=e.hFB.required(),this.title=(0,e.hFB)(""),this.nodeShown=(0,e.EWP)(()=>{const o=this.graph(),s=this.nodeId();return o.nodes[s]?.boolState?.shown})}handleCloseClick(){this.store.dispatch(new Ct.S3)}handleToggleShownClick(t,i){const o=!i;this.nodeService.show(t,o),o||this.store.dispatch(new Ct.S3)}handleFadeClick(t){this.nodeService.fade([t])}handleIsolateClick(t){this.nodeService.hideInverse([t])}getAudioLabel(t){return t?$localize`Pause Audio`:$localize`Play Audio`}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(c.il),e.rXU(Eo.w))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-view-context-label"]],inputs:{nodeId:[1,"nodeId"],title:[1,"title"]},standalone:!0,features:[e.aNF],decls:21,vars:5,consts:()=>{let t,i,o,s,a;return t=$localize`:␟f4e529ae5ffd73001d1ff4bbdeeb0a72e342e5c8␟7819314041543176992:Close`,i=$localize`:␟81d6fa1833302eff81aca2a44b472dbd23898f44␟7797708308805705984:Fade`,o=$localize`:␟1d0272689cde55e9082a761694f77704b269d315␟424278156329248517:Isolate`,s=$localize`:␟1eede69e18c5ac9c0b0295b72cabb7e64e029e74␟8461609631969932886:Hide`,a=$localize`:␟2aba1e87039819aca3b70faa9aa848c12bf139ca␟8461842260159597706:Show`,[["audio","audioPlayer"],i,o,s,a,["orientation","horizontal","padding","none"],[1,"flex","flex-col","items-stretch","w-full"],[1,"flex","items-center","justify-between","border-b","border-solid","border-b-gray-300"],["type","button","app-view-button","","appAudioPlayer","",3,"click","audioText","disabled"],["icon","volume-up"],[1,"flex-auto","text-sm","font-bold"],["type","button","app-view-button","","aria-label",t,3,"click"],["icon","times"],[1,"flex","items-center","divide-x","divide-gray-300","justify-evenly"],["type","button","app-view-button","","buttonSize","small",1,"flex-auto",3,"click"],[1,"text-xs","font-medium","uppercase"]]},template:function(i,o){if(1&i){const s=e.RV6();e.j41(0,"app-pillbox",5)(1,"div",6)(2,"div",7)(3,"button",8,0),e.bIt("click",function(){e.eBV(s);const r=e.sdS(4);return e.Njj(r.play())}),e.nrm(5,"app-icon",9),e.k0s(),e.j41(6,"div",10),e.EFF(7),e.k0s(),e.j41(8,"button",11),e.bIt("click",function(){return e.eBV(s),e.Njj(o.handleCloseClick())}),e.nrm(9,"app-icon",12),e.k0s()(),e.j41(10,"div",13)(11,"button",14),e.bIt("click",function(){return e.eBV(s),e.Njj(o.handleToggleShownClick(o.nodeId(),o.nodeShown()))}),e.j41(12,"span",15),e.DNE(13,Ya,2,0,"ng-container")(14,qa,2,0,"ng-container"),e.k0s()(),e.j41(15,"button",14),e.bIt("click",function(){return e.eBV(s),e.Njj(o.handleFadeClick(o.nodeId()))}),e.j41(16,"span",15),e.pXf(17,1),e.k0s()(),e.j41(18,"button",14),e.bIt("click",function(){return e.eBV(s),e.Njj(o.handleIsolateClick(o.nodeId()))}),e.j41(19,"span",15),e.pXf(20,2),e.k0s()()()()()}if(2&i){const s=e.sdS(4);e.R7$(3),e.Y8G("audioText",o.title())("disabled",s.loading()),e.BMQ("aria-label",o.getAudioLabel(s.playing())),e.R7$(4),e.JRh(o.title()),e.R7$(6),e.vxM(o.nodeShown()?13:14)}},dependencies:[p.MD,$.b,Ze.O,N.C,P.ri,B.o,D.R,Qa],encapsulation:2,changeDetection:0})}return n})();var ln=l(83403),Ln=l(45861),xn=l(25780);let Za=(()=>{class n{constructor(t){this.store=t,this.selectingLocation=(0,h.ot)(this.store.select(we.U.getSelectingLocation))}handleToggleSelectingLocation(t){t?(this.store.dispatch(new Je.W.SetARLocation),this.store.dispatch(new Je.W.SetARSelectingLocation(!1))):this.store.dispatch(new Je.W.SetARSelectingLocation(!0))}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(c.il))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-xr-controls-bar"]],standalone:!0,features:[e.aNF],decls:7,vars:0,consts:()=>{let t,i,o;return t=$localize`:␟a00fddb6017dc71ea1d67721046393443bc075f4␟5662376323613763162:XR Control Buttons`,i=$localize`:␟09a3819eec064e9b1e71734181cb6cdaf4e14cdf␟553682680938609163:Set new scene position`,o=$localize`:␟f56d4869e48b6899e74d5c664ea6aac99df9dc4c␟8445031949094621348:Place 3D model in AR space`,[o,["direction","vertical","data-test","xrControlsBar","direction","vertical","appPreventFadeout",""],["role","group","aria-label",t],["app-view-button","","buttonSize","small","matTooltip",i,"matTooltipPosition","left","data-test","xrSetPosition","appEventFence","",3,"click"],["size","lg","icon","location-crosshairs"],[1,"sr-only"]]},template:function(i,o){1&i&&(e.j41(0,"app-pillbox",1)(1,"ul",2)(2,"li")(3,"button",3),e.bIt("click",function(){return o.handleToggleSelectingLocation(o.selectingLocation())}),e.nrm(4,"app-icon",4),e.j41(5,"span",5),e.pXf(6,0),e.k0s()()()()())},dependencies:[p.MD,j.uc,j.oV,W.h,xn.L,oe.s,B.o,D.R,N.C,P.ri,$.b,Ze.O],encapsulation:2,changeDetection:0})}return n})();var Ja=l(9984),Ii=l(95416),ni=l(79805),So=l(11724),er=l(46889),tr=l(51196),Re=l(87996),ir=l(94909),oi=l(76718),ve=l(36110),cn=l(13491);function mo(n){const{rotation:_,scale:t,position:i,origin:o}=n;return{translate:cn.n.fromArray(i),rotate:cn.n.fromArray(_),scale:cn.n.fromArray(t),pivot:cn.n.fromArray(o)}}var Fe=l(38753),$n=l(86050),or=l(25209);const _r=["overlayContainer"],sr=["labelsContainer"],ar=()=>["top","right","bottom","left"],rr=n=>({"w-full":n});function lr(n,_){if(1&n){const t=e.RV6();e.j41(0,"button",4)(1,"div",21),e.EFF(2),e.nI1(3,"percent"),e.k0s(),e.j41(4,"button",22),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.handleResetScaleClick())}),e.nrm(5,"app-icon",23),e.k0s()()}if(2&n){const t=e.XpG();e.Y8G("@show",void 0),e.R7$(2),e.JRh(e.bMT(3,2,t.sceneScale()))}}function cr(n,_){1&n&&e.nrm(0,"app-view-toolbar")}function dr(n,_){1&n&&e.nrm(0,"app-view-undo",10),2&n&&e.Y8G("layout","full")}function pr(n,_){1&n&&(e.j41(0,"app-pillbox",24),e.nrm(1,"app-view-play"),e.k0s())}function ur(n,_){if(1&n&&(e.nrm(0,"app-xr-controls-bar"),e.DNE(1,pr,2,0,"app-pillbox",24)),2&n){const t=e.XpG();e.R7$(),e.vxM(t.mediaVisible()?1:-1)}}function hr(n,_){1&n&&(e.j41(0,"app-pillbox",24),e.nrm(1,"app-view-play"),e.k0s())}function gr(n,_){if(1&n&&(e.j41(0,"div",16),e.nrm(1,"app-xr-controls-bar"),e.DNE(2,hr,2,0,"app-pillbox",24),e.k0s()),2&n){const t=e.XpG();e.R7$(2),e.vxM(t.mediaVisible()?2:-1)}}function Er(n,_){if(1&n&&e.nrm(0,"app-view-context-label",17),2&n){let t,i;const o=e.XpG();e.Y8G("nodeId",null==(t=o.contextLabel())?null:t.objectId)("title",null==(i=o.contextLabel())?null:i.title)}}function Sr(n,_){1&n&&e.nrm(0,"img",19)}function mr(n,_){1&n&&(e.PLo(0,2,1),e.j41(1,"p"),e.nrm(2,"em",26),e.k0s(),e.YFu())}function fr(n,_){1&n&&(e.PLo(0,2,2),e.j41(1,"p"),e.nrm(2,"em",26),e.k0s(),e.YFu())}function Tr(n,_){1&n&&(e.PLo(0,2,3),e.j41(1,"p"),e.nrm(2,"em",26),e.k0s(),e.YFu())}function br(n,_){if(1&n){const t=e.RV6();e.PLo(0,2,4),e.j41(1,"button",27),e.bIt("click",function(){e.eBV(t);const o=e.XpG(2);return e.Njj(o.handleCancelClick())}),e.k0s(),e.YFu()}}function vr(n,_){if(1&n&&(e.j41(0,"div",20),e.PLo(1,2),e.DNE(2,mr,3,0,"p")(3,fr,3,0,"p")(4,Tr,3,0,"p")(5,br,2,0,"button",25),e.YFu(),e.k0s()),2&n){let t;const i=e.XpG();e.R7$(2),e.vxM("Pending"===(t=i.placementState())?2:"Valid"===t?3:4),e.R7$(3),e.vxM(i.placementCount()>1?5:-1)}}var fo=function(n){return n.Pending="Pending",n}(fo||{});let bo=(()=>{class n{constructor(t,i,o,s,a,r,u){let m;this.store=t,this.actions=i,this.snackBar=o,this.labelsService=s,this.engineService=a,this.sceneService=r,this.xrService=u,this.overlayContainerRef=(0,e.ebz)("overlayContainer"),this.labelsContainerRef=(0,e.ebz)("labelsContainer"),this.toolbarVisible=(0,h.ot)(this.store.select(O.dF.getVisible(E.U.Toolbar))),this.mediaVisible=(0,h.ot)(this.store.select(O.dF.getVisible(E.U.Media))),this.undoVisible=(0,h.ot)(this.store.select(O.dF.getVisible(E.U.Undo))),this.contentMode=(0,h.ot)(this.store.select(f.Pf.getContentMode)),this.selectedChapter=(0,h.ot)(this.store.select(b.N.getSelectedChapter)),this.graph=(0,h.ot)(this.store.select(te.S.getViewGraph)),this.checkedNodeIds=(0,h.ot)(this.store.select(xt.z.getCheckedNodeIds)),this.selectingLocation=(0,h.ot)(this.store.select(we.U.getSelectingLocation)),this.viewGraph=(0,h.ot)(this.store.select(te.S.getViewGraph)),this.contextLabel=(0,h.ot)(this.store.select(Fe.y.getContextLabel)),this.enginePlacementState=(0,h.ot)(this.store.select(we.U.getPlacementState)),this.labelsEnabled=(0,e.hFB)(!1),this.checkedNode=(0,e.EWP)(()=>{const v=this.graph(),R=this.checkedNodeIds()[0];return v.nodes[R]}),this.usdzUrl=(0,e.EWP)(()=>{const v=this.selectedChapter()?.contentBlocks??[];return(0,Ln.p)(v)[0]}),this.placementPending=(0,e.vPA)(!1),this.placementState=(0,e.EWP)(()=>{const v=this.enginePlacementState();return this.placementPending()?fo.Pending:v}),this.placementCount=(0,e.vPA)(0),this.sceneScale=(0,e.vPA)(1),this.interacting=(0,e.vPA)(!1),this.initialTransform=new Map,this.engineService.engine.story.anatomySceneGraph.anatomyRoots.forEach(({objectId:v,sceneNode:R})=>{this.initialTransform.set(v,mo(R))}),(0,e.QZP)(()=>{this.selectingLocation()&&this.placementCount.update(R=>R+1)},{allowSignalWrites:!0}),(0,e.QZP)(v=>{const R=this.labelsContainerRef();this.labelsService.setLabelContainer(R),v(()=>{this.labelsService.setLabelContainer(null)})}),(0,e.QZP)(v=>{this.selectingLocation()?(this.placementPending.set(!0),clearTimeout(m),setTimeout(()=>{this.placementPending.set(!1)},5e3)):this.placementPending.set(!1),v(()=>{clearTimeout(m)})},{allowSignalWrites:!0}),(0,e.QZP)(()=>{const v=this.placementPending();this.store.dispatch(new Je.W.SetARSelectingLocationVisible(!v))}),this.actions.pipe((0,c.xi)(Je.W.SetARLocationSuccess),(0,h.pQ)()).subscribe(()=>{this.snackBar.dismiss()}),this.actions.pipe((0,c.xi)(Je.W.SetARLocationFail),(0,h.pQ)()).subscribe(()=>{this.handleSelectFail()}),this.initInputListeners()}ngOnDestroy(){this.hammerManager?.destroy(),this.hammerManager=null,this.resetSceneTransform(),this.initialTransform.clear()}initInputListeners(){let t="",i=1,o=0;const s=new z.B,a=new z.B,r=this.xrService.getObjectSelecting();s.asObservable().pipe((0,Re.B)(50),(0,ir.E)(r),(0,M.p)(([u])=>!u),(0,h.pQ)()).subscribe(([,u])=>{const m=this.viewGraph(),v=this.sceneService.getViewNode(m,u?.objectId);this.store.dispatch(new Ae.zE(v,void 0,u))}),this.store.select(b.N.getSelectedChapterId).pipe((0,J.F)(),(0,h.pQ)()).subscribe(()=>{this.resetSceneTransform()}),(0,oi.h)(a,a.pipe((0,Re.B)(2e3),(0,ve.T)(()=>!1))).pipe((0,h.pQ)()).subscribe(u=>{this.interacting.set(u)}),this.hammerManager=new Hammer.Manager(document.body),this.hammerManager.add(new Hammer.Tap({event:"press"})),this.hammerManager.add(new Hammer.Pan({event:"pan",pointers:0})),this.hammerManager.add(new Hammer.Pinch({event:"pinch"})),this.hammerManager.on("press",u=>{a.next(!0);const v=this.overlayContainerRef()?.nativeElement?.contains(u?.target);s.next(v)}),this.hammerManager.on("pan",u=>{if(this.selectingLocation())return;u.preventDefault();const{velocityX:m,velocityY:v}=u;this.applySceneRotate(m,v),a.next(!0)}),this.hammerManager.on("panend",u=>{this.selectingLocation()}),this.hammerManager.on("pinchstart",u=>{this.selectingLocation()||(i*=u.scale,t="",a.next(!0))}),this.hammerManager.on("pinchmove",u=>{if(this.selectingLocation())return;u.preventDefault();const m=Math.abs(u.deltaX)>60||Math.abs(u.deltaY)>60,v=u.scale>1.5||u.scale<.5;t?("pan"===t&&v&&!m&&(t="pinch"),"pinch"===t&&m&&!v&&(t="pan")):t=v?"pinch":"pan";const R=i*u.scale,_e=o;switch(o=0===R?0:R>0?1:-1,t){case"pan":{const{velocityX:$e,velocityY:ke}=u;this.applySceneMove($e,ke);break}case"pinch":o+_e!==0&&this.applySceneScale(R)}a.next(!0)}),this.hammerManager.on("pinchend",u=>{i*=u.scale})}handleResetScaleClick(){this.applySceneScale(1)}handleOverlayClick(t,i){t&&(i!==Ja.I.Valid?this.handleSelectFail():this.store.dispatch(new Je.W.SetARLocation))}handleCancelClick(){this.store.dispatch(new Je.W.SetARSelectingLocation(!1))}handleSelectFail(){this.displaySnackbar("You cannot place the object here.")}resetSceneTransform(){this.applySceneScale(1),this.initialTransform.forEach((t,i)=>{const{anatomyObjects:o}=this.engineService.engine.story.anatomySceneGraph,{sceneNode:s}=o.get(i);(0,So.applyTransform)(s,t)})}applySceneRotate(t,i){this.applyTransform((o,s)=>{const{rotate:a}=s,{y:u}=a;return{rotate:{y:(0,er.nv)(u)+1*t}}})}applySceneMove(t,i){this.applyTransform((o,s)=>{const{translate:a}=s,{x:r,y:u}=a;return{translate:{x:r+.5*t,y:u-.5*i}}})}applySceneScale(t){t=(0,V.clamp)(t,.25,4),this.sceneScale.set(t),this.applyTransform(()=>({scale:{x:t,y:t,z:t}}))}applyTransform(t){const{engine:i}=this.engineService;i.story.anatomySceneGraph.anatomyRoots.forEach(o=>{!function nr(n,_){const i=_(n,mo(n));i&&(0,So.applyTransform)(n,i)}(o.sceneNode,t)})}displaySnackbar(t){this.snackBar.open(t,"",{horizontalPosition:"left",verticalPosition:"top",duration:2e3})}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(c.il),e.rXU(c.En),e.rXU(Ii.UG),e.rXU(ja.x),e.rXU(ni.y),e.rXU(po.w),e.rXU(tr.S))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-xr-overlay"]],viewQuery:function(i,o){1&i&&(e.wEZ(o.overlayContainerRef,_r,5),e.wEZ(o.labelsContainerRef,sr,5)),2&i&&e.NyB(2)},inputs:{labelsEnabled:[1,"labelsEnabled"]},standalone:!0,features:[e.aNF],decls:23,vars:29,consts:()=>{let t;return t=$localize`:␟272a6581ac01a11353aaf8d6d40d7b9cb229a5dc␟6802581832720117990:${"\ufffd*2:1\ufffd"}:START_BLOCK_CASE:${"[\ufffd#1:1\ufffd|\ufffd#1:2\ufffd|\ufffd#1:3\ufffd]"}:START_PARAGRAPH:${"[\ufffd#2:1\ufffd|\ufffd#2:2\ufffd|\ufffd#2:3\ufffd]"}:START_EMPHASISED_TEXT:Slowly move your camera around to scan${"[\ufffd/#2:1\ufffd|\ufffd/#2:2\ufffd|\ufffd/#2:3\ufffd]"}:CLOSE_EMPHASISED_TEXT: a surface in the room. ${"[\ufffd/#1:1\ufffd|\ufffd/#1:2\ufffd|\ufffd/#1:3\ufffd]"}:CLOSE_PARAGRAPH:${"[\ufffd/*2:1\ufffd|\ufffd/*3:2\ufffd]"}:CLOSE_BLOCK_CASE:${"\ufffd*3:2\ufffd"}:START_BLOCK_CASE_1:${"[\ufffd#1:1\ufffd|\ufffd#1:2\ufffd|\ufffd#1:3\ufffd]"}:START_PARAGRAPH:${"[\ufffd#2:1\ufffd|\ufffd#2:2\ufffd|\ufffd#2:3\ufffd]"}:START_EMPHASISED_TEXT:Tap the white circle${"[\ufffd/#2:1\ufffd|\ufffd/#2:2\ufffd|\ufffd/#2:3\ufffd]"}:CLOSE_EMPHASISED_TEXT: to place the object.${"[\ufffd/#1:1\ufffd|\ufffd/#1:2\ufffd|\ufffd/#1:3\ufffd]"}:CLOSE_PARAGRAPH:${"[\ufffd/*2:1\ufffd|\ufffd/*3:2\ufffd]"}:CLOSE_BLOCK_CASE:${"\ufffd*4:3\ufffd"}:START_BLOCK_DEFAULT:${"[\ufffd#1:1\ufffd|\ufffd#1:2\ufffd|\ufffd#1:3\ufffd]"}:START_PARAGRAPH: You cannot place the object on this surface. ${"[\ufffd#2:1\ufffd|\ufffd#2:2\ufffd|\ufffd#2:3\ufffd]"}:START_EMPHASISED_TEXT:Please try to focus on different surface.${"[\ufffd/#2:1\ufffd|\ufffd/#2:2\ufffd|\ufffd/#2:3\ufffd]"}:CLOSE_EMPHASISED_TEXT:${"[\ufffd/#1:1\ufffd|\ufffd/#1:2\ufffd|\ufffd/#1:3\ufffd]"}:CLOSE_PARAGRAPH:${"\ufffd/*4:3\ufffd"}:CLOSE_BLOCK_DEFAULT:${"\ufffd*5:4\ufffd"}:START_BLOCK_IF:${"\ufffd#1:4\ufffd"}:START_TAG_BUTTON: Cancel ${"\ufffd/#1:4\ufffd"}:CLOSE_TAG_BUTTON:${"\ufffd/*5:4\ufffd"}:CLOSE_BLOCK_IF:`,t=e.k04(t),[["overlayContainer",""],["labelsContainer",""],t,[1,"absolute","top-0","bottom-0","left-0","right-0","z-50","flex","flex-col","items-center","w-screen","h-screen",3,"click"],["appEventFence","",1,"fixed","z-50","flex","items-center","justify-between","text-lg","font-medium","text-white","transform","-translate-x-1/2","bg-opacity-75","divide-x","divide-white","rounded-lg","bg-gray-950","left-1/2","top-20"],[1,"absolute","top-6","right-3"],["padding","none"],[3,"mode","title","modelUrl","transparent","bordered","compact"],[3,"showZones","hidden","verticalPadding","horizontalPadding"],["left",""],[3,"layout"],["bottom",""],[1,"flex","flex-col","items-end","w-full","gap-3","justify-items-end"],[1,"flex","flex-col","items-start","w-full","gap-3"],[1,"flex","flex-row","justify-between","w-full"],[3,"showPagination","showTitle","ngClass"],[1,"flex","flex-col","gap-1"],[1,"w-full",3,"nodeId","title"],[1,"absolute","top-0","bottom-0","left-0","right-0","w-full","h-full","pointer-events-none",3,"hidden"],["src","/assets/images/ar_move_phone.svg","width","200",1,"fixed","transform","-translate-x-1/2","-translate-y-1/2","top-1/2","left-1/2"],[1,"flex","flex-col","gap-3","p-6","mx-5","my-10","text-lg","font-medium","text-center","text-white","bg-opacity-50","border","border-gray-200","rounded-lg","bg-gray-950"],[1,"px-3"],["app-view-button","","buttonTheme","transparent","buttonSize","small",3,"click"],["icon","rotate-left"],["orientation","horizontal"],["app-view-button","","buttonTheme","white-outline","buttonShape","rounded",1,"w-full"],[1,"font-bold"],["app-view-button","","buttonTheme","white-outline","buttonShape","rounded",1,"w-full",3,"click"]]},template:function(i,o){if(1&i){const s=e.RV6();e.j41(0,"div",3,0),e.bIt("click",function(){return e.eBV(s),e.Njj(o.handleOverlayClick(o.selectingLocation(),o.enginePlacementState()))}),e.DNE(2,lr,6,4,"button",4),e.j41(3,"div",5)(4,"app-pillbox",6),e.nrm(5,"app-view-xr-button",7),e.k0s()(),e.j41(6,"app-view-zones",8),e.qex(7,9),e.DNE(8,cr,1,0,"app-view-toolbar")(9,dr,1,1,"app-view-undo",10),e.bVm(),e.qex(10,11),e.j41(11,"div",12),e.DNE(12,ur,2,1),e.j41(13,"div",13)(14,"div",14),e.nrm(15,"app-view-title-only",15),e.DNE(16,gr,3,1,"div",16),e.k0s(),e.DNE(17,Er,1,2,"app-view-context-label",17),e.k0s()(),e.bVm(),e.k0s(),e.j41(18,"div",18,1),e.nrm(20,"app-labels"),e.k0s(),e.DNE(21,Sr,1,0,"img",19)(22,vr,6,2,"div",20),e.k0s()}if(2&i){let s;e.AVh("pointer-events-none",!o.selectingLocation())("justify-end",o.selectingLocation()),e.R7$(2),e.vxM(o.interacting()&&1!==o.sceneScale()?2:-1),e.R7$(3),e.Y8G("mode","ar")("title",null==(s=o.selectedChapter())?null:s.displayName)("modelUrl",o.usdzUrl())("transparent",!0)("bordered",!1)("compact",!0),e.R7$(),e.Y8G("showZones",e.lJ4(26,ar))("hidden",o.selectingLocation())("verticalPadding",24)("horizontalPadding",12),e.R7$(2),e.vxM(o.toolbarVisible()?8:-1),e.R7$(),e.vxM(o.undoVisible()?9:-1),e.R7$(3),e.vxM(o.contextLabel()?-1:12),e.R7$(3),e.Y8G("showPagination",!0)("showTitle",!o.contextLabel())("ngClass",e.eq3(27,rr,!o.contextLabel())),e.R7$(),e.vxM(o.contextLabel()?16:-1),e.R7$(),e.vxM(o.contextLabel()?17:-1),e.R7$(),e.Y8G("hidden",!o.labelsEnabled()||o.selectingLocation()),e.R7$(3),e.vxM("Pending"===o.placementState()?21:-1),e.R7$(),e.vxM(o.selectingLocation()?22:-1)}},dependencies:[p.MD,p.YU,p.m1,Ii._T,Ie.Cn,j.uc,N.C,P.ri,B.o,D.R,$.b,Ze.O,W.h,xn.L,go,Nn,Rn,en,U.k,or.H,Ka,ln.R,Za,Mn],encapsulation:2,data:{animation:[(0,x.hZ)("show",[(0,x.kY)(":enter",[(0,x.sM)($n.O.fadeIn,{params:{duration:500}})])])]}})}return n})();var vo=l(6930),_i=l(82109),wr=l(77428);function Ar(n,_){if(1&n&&(e.j41(0,"h2",4),e.EFF(1),e.k0s()),2&n){const t=e.XpG();e.R7$(),e.JRh(t.title())}}function yr(n,_){if(1&n&&e.nrm(0,"app-progress",6),2&n){const t=e.XpG();e.Y8G("value",t.storyLoadProgress())("total",1)("theme","light")}}function Nr(n,_){if(1&n){const t=e.RV6();e.nrm(0,"app-view-xr-button",7),e.j41(1,"button",8),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.handleLearnMoreClick())}),e.pXf(2,0),e.k0s()}if(2&n){const t=e.XpG();e.Y8G("mode",t.mode())("title",t.title())("modelUrl",t.modelUrl())("transparent",!1)("bordered",!1)("compact",!1)}}let Oo=(()=>{class n{constructor(t){this.store=t,this.xrLoaderEnum=vo.t,this.nativeEnvironmentPlatform=me.I,this.progressByChapter=(0,h.ot)(this.store.select(_i.N.getChaptersLoadProgress)),this.chapter=(0,h.ot)(this.store.select(Ce.t.getLoadingChapter)),this.selectedChapter=(0,h.ot)(this.store.select(b.N.getSelectedChapterId)),this.storyLoadProgress=(0,e.EWP)(()=>{const i=this.progressByChapter(),o=this.chapter(),s=this.selectedChapter();return(0,V.isNil)(o)||o.chapterId!==s?1:i[s]??0}),this.mode=e.hFB.required(),this.platform=e.hFB.required(),this.title=(0,e.hFB)(),this.contentBlocks=e.hFB.required(),this.learnMoreClick=(0,e.CGW)(),this.modelUrl=(0,e.EWP)(()=>{const i=this.contentBlocks();return(0,Ln.p)(i??[])[0]})}handleLearnMoreClick(){this.learnMoreClick.emit()}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(c.il))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-xr-loader-summary"]],inputs:{mode:[1,"mode"],platform:[1,"platform"],title:[1,"title"],contentBlocks:[1,"contentBlocks"]},outputs:{learnMoreClick:"learnMoreClick"},standalone:!0,features:[e.aNF],decls:7,vars:2,consts:()=>{let t;return t=$localize`:␟3fde104b80163b40899412fd782ea159e7fea74a␟2747860579732384082: Learn More `,[t,["role","dialog","aria-modal","true","aria-label","XR Loader",1,"fixed","top-0","bottom-0","left-0","right-0","z-50","flex","flex-col","items-center","w-screen","h-screen"],[1,"absolute","w-full","h-full","bg-gray-950","opacity-70"],[1,"absolute","flex","flex-col","items-center","justify-center","w-full","h-full","max-w-xs","gap-14"],[1,"text-2xl","font-bold","text-center","text-gray-100"],[1,"flex","flex-col","gap-6","w-72"],[3,"value","total","theme"],[3,"mode","title","modelUrl","transparent","bordered","compact"],["type","button","app-view-button","","buttonShape","rounded","buttonTheme","white-outline",3,"click"]]},template:function(i,o){1&i&&(e.j41(0,"div",1),e.nrm(1,"div",2),e.j41(2,"div",3),e.DNE(3,Ar,2,1,"h2",4),e.j41(4,"div",5),e.DNE(5,yr,1,3,"app-progress",6)(6,Nr,3,6),e.k0s()()()),2&i&&(e.R7$(3),e.vxM(o.title()?3:-1),e.R7$(2),e.vxM(o.storyLoadProgress()<1?5:6))},dependencies:[N.C,P.ri,B.o,he.M,wr.X,ln.R]})}return n})(),Rr=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=e.$C({type:n});static#i=this.\u0275inj=e.G2t({imports:[c.rK.forFeature([f.Pf]),c.rK.forFeature([O.dF]),Y.y2.forChild(),k.Pd,L.k,N.C,p.MD,T.y,W.h,ae.x,Z.YN,B.o,ne.Un,X.G,$s,Te.G,De,$.b,ge.Y,re.x,he.M,K.c,Z.X1,mt.G,U.k,S.j,_o.d,se.f,C,Ds,P_,V_,xs,Js.z,Pn,xa.N,rn,ho,Un,sn,ii,mi,bo,Oo,ln.R,Zi,Mn,Ke,Nn,Oe,Rn,Ye]})}return n})();var Pr=l(20736),ye=l(35426),Ur=l(81027),Vr=l(24911),Dr=l(4664),pt=l(17365),si=l(1670),Co=l(39705),Q=l(93132),ot=l(13181),dn=function(n){return n[n.Content=0]="Content",n[n.Label=1]="Label",n[n.Tools=2]="Tools",n[n.Search=3]="Search",n[n.Help=4]="Help",n[n.NodeInfo=5]="NodeInfo",n[n.LabelInfo=6]="LabelInfo",n}(dn||{}),Me=l(73828),Lr=l(38465),Io=function(n){return n[n.Main=0]="Main",n[n.Media=1]="Media",n[n.Tools=2]="Tools",n[n.Whiteboard=3]="Whiteboard",n[n.VisibilityLayers=4]="VisibilityLayers",n[n.Empty=5]="Empty",n}(Io||{}),Mo=l(15375),wo=l(30327),$t=l(515),Mi=l(38104),pn=l(15623),_t=l(17276),Ao=l(96557),yo=l(62943),wi=l(47932),No=l(66056),ai=l(32408),It=l(76016),un=l(47833),hn=l(7431),st=l(51529),Ai=l(62949),kn=l(50677),ut=l(18272),Ro=l(92811),gn=l(63008),Po=l(82529);function Wr(n,_){if(1&n){const t=e.RV6();e.j41(0,"button",8),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.handleAction("takeQuiz"))}),e.pXf(1,2),e.k0s()}}class yi{constructor(_){this.dialogRef=_}ngOnInit(){}handleAction(_){this.dialogRef.close(_)}static#e=this.\u0275fac=function(t){return new(t||yi)(e.rXU(Po.ce))};static#t=this.\u0275cmp=e.VBU({type:yi,selectors:[["app-view-playthrough-modal"]],decls:10,vars:3,consts:()=>{let _,t,i;return _=$localize`:␟1cbfa5d1bd6e6c717ce755355bc69d490bacec68␟4369858959634679447:${"\ufffd#4\ufffd"}:START_TAG_APP_ICON:${"\ufffd/#4\ufffd"}:CLOSE_TAG_APP_ICON: Explore on Your Own `,t=$localize`:␟1a4ef7deae63552688d7b8d2aa530d0ed9addf03␟8508351863775798459:${"\ufffd#9\ufffd"}:START_TAG_APP_ICON:${"\ufffd/#9\ufffd"}:CLOSE_TAG_APP_ICON: Play Again `,i=$localize`:␟3453239ade2e7a669baf13d6322db6a7dcc27688␟2019708727875402043: Take Quiz `,[_,t,i,[1,"view-playthrough-modal"],[1,"view-playthrough-modal__buttons"],["app-view-button","","buttonTheme","blue-fill","buttonSize","large","buttonShape","rounded",1,"view-playthrough-modal__button",3,"click"],["icon","arrow-pointer","aria-hidden","true"],["app-view-button","","class","view-playthrough-modal__button","buttonTheme","white-outline","buttonSize","large","buttonShape","rounded",3,"click",4,"ngIf"],["app-view-button","","buttonTheme","white-outline","buttonSize","large","buttonShape","rounded",1,"view-playthrough-modal__button",3,"click"],["icon","rotate-left","aria-hidden","true"]]},template:function(t,i){1&t&&(e.j41(0,"div",3)(1,"div",4)(2,"button",5),e.bIt("click",function(){return i.handleAction("explore")}),e.PLo(3,0),e.nrm(4,"app-icon",6),e.YFu(),e.k0s(),e.DNE(5,Wr,2,0,"button",7),e.nI1(6,"async"),e.j41(7,"button",8),e.bIt("click",function(){return i.handleAction("playAgain")}),e.PLo(8,1),e.nrm(9,"app-icon",9),e.YFu(),e.k0s()()()),2&t&&(e.R7$(5),e.Y8G("ngIf",e.bMT(6,1,i.hasQuiz$)))},dependencies:[P.ri,p.bT,D.R,p.Jj],styles:["[_nghost-%COMP%]{display:flex;background:#1018238c;width:100%;height:100%;justify-content:center;align-items:center;transition:background .3 ease-out}.view-playthrough-modal__button[_ngcontent-%COMP%]{width:280px}.view-playthrough-modal__buttons[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px}"],changeDetection:0})}!function(n,_,t,i){var a,o=arguments.length,s=o<3?_:null===i?i=Object.getOwnPropertyDescriptor(_,t):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(n,_,t,i);else for(var r=n.length-1;r>=0;r--)(a=n[r])&&(s=(o<3?a(s):o>3?a(_,t,s):a(_,t))||s);o>3&&s&&Object.defineProperty(_,t,s)}([(0,c.l6)(w.j.hasQuiz),function(n,_){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata("design:type",_)}(0,d.c)],yi.prototype,"hasQuiz$",void 0);var at=l(65294),En=l(90908),Xr=l(20339),Gn=l(83621),Fr=l(97307),zr=l(51002),Sn=function(n,_,t,i){var a,o=arguments.length,s=o<3?_:null===i?i=Object.getOwnPropertyDescriptor(_,t):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(n,_,t,i);else for(var r=n.length-1;r>=0;r--)(a=n[r])&&(s=(o<3?a(s):o>3?a(_,t,s):a(_,t))||s);return o>3&&s&&Object.defineProperty(_,t,s),s},mn=function(n,_){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(n,_)};class Mt{constructor(_,t,i,o){this.store=_,this.animationService=t,this.engineService=i,this.changeDetetorRef=o,this.ngUnsubscribe=new z.B,this.duration=0,this.wasPlaying=!0,this.percent=0,this.accessibleLabel=$localize`media slider`}ngOnInit(){this.initChapterListener(),this.initTimelineListener()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}handlePercentChanged(_){this.percent=_,this.scrubToPercent(_)}initChapterListener(){this.chapterReadyState$.pipe((0,M.p)(_=>!(0,V.isNil)(_)&&_.animation),(0,g.Q)(this.ngUnsubscribe)).subscribe(()=>{this.timerange=this.animationService.getChapterTimeFrame(),this.tick(this.animationService.getTime())})}initTimelineListener(){this.engineService.getEvent($t.X.TimelinePlaying).pipe((0,q.Z)(20),(0,g.Q)(this.ngUnsubscribe)).subscribe(_=>{this.tick(_.time)}),this.engineService.getEvent($t.X.TimelineScrubbed).pipe((0,q.Z)(20),(0,g.Q)(this.ngUnsubscribe)).subscribe(_=>{this.percent=this.getPercent(_.time)})}handleDragStart(){this.wasPlaying=this.store.selectSnapshot(te.S.getAnimationPlaying),this.animationService.pause()}handleTrackClick(_){const t=this.store.selectSnapshot(te.S.getAnimationPlaying);t&&this.animationService.pause(),this.percent=_,this.scrubToPercent(_),setTimeout(()=>{t&&this.animationService.unpause()})}handleDragEnd(){this.wasPlaying&&this.animationService.play()}tick(_){this.percent=this.getPercent(_),this.changeDetetorRef.markForCheck()}getPercent(_){return this.timerange?.lastTime>0?_/this.timerange.lastTime*100:0}scrubToPercent(_){this.timerange?.lastTime>0&&this.animationService.scrub(_/100*this.timerange.lastTime)}static#e=this.\u0275fac=function(t){return new(t||Mt)(e.rXU(c.il),e.rXU(Ut.O),e.rXU(ni.y),e.rXU(e.gRc))};static#t=this.\u0275cmp=e.VBU({type:Mt,selectors:[["app-view-scrubber"]],decls:1,vars:2,consts:[["data-test","viewMediaScrubber",3,"dragStarted","dragEnded","trackClicked","percentChanged","percent","accessibleLabel"]],template:function(t,i){1&t&&(e.j41(0,"app-view-slider",0),e.bIt("dragStarted",function(){return i.handleDragStart()})("dragEnded",function(){return i.handleDragEnd()})("trackClicked",function(s){return i.handleTrackClick(s)})("percentChanged",function(s){return i.handlePercentChanged(s)}),e.k0s()),2&t&&e.Y8G("percent",i.percent)("accessibleLabel",i.accessibleLabel)},dependencies:[ee],encapsulation:2})}Sn([(0,c.l6)(b.N.getSelectedChapterId),mn("design:type",d.c)],Mt.prototype,"selectedChapterId$",void 0),Sn([(0,c.l6)(te.S.getAnimationPlaying),mn("design:type",d.c)],Mt.prototype,"animationPlaying$",void 0),Sn([(0,c.l6)(b.N.getSelectedChapterReadyState),mn("design:type",d.c)],Mt.prototype,"chapterReadyState$",void 0),Sn([(0,c.l6)(f.Pf.getCanTouch),mn("design:type",d.c)],Mt.prototype,"canTouch$",void 0);class Ni{constructor(_){this.store=_}setPlaybackSpeed(_){this.store.dispatch(new Ae.Vs(_))}static#e=this.\u0275fac=function(t){return new(t||Ni)(e.rXU(c.il))};static#t=this.\u0275cmp=e.VBU({type:Ni,selectors:[["app-view-playback-speed"]],decls:18,vars:4,consts:()=>{let _,t,i;return _=$localize`:␟4f8e5379083ddd28f3d57c885e7917c264af4f2a␟7596687563071324760:Playback Speed`,t=$localize`:␟4f8e5379083ddd28f3d57c885e7917c264af4f2a␟7596687563071324760:Playback Speed`,i=$localize`:␟077e90416bdae39a40441d0b94c5a9e8fcad4514␟3080483882937310852:Normal`,[["playbackMenu","matMenu"],t,i,["app-view-button","","buttonSize","small","data-test","viewPlaybackSpeed","matTooltip",_,"matTooltipPosition","above",3,"matMenuTriggerFor"],[1,"px-2"],[1,"sr-only"],[1,"text-xs"],["icon","angle-up","size","xs",1,"ml-2"],["mat-menu-item","",3,"click"]]},template:function(t,i){if(1&t){const o=e.RV6();e.j41(0,"button",3)(1,"div",4)(2,"span",5),e.pXf(3,1),e.k0s(),e.j41(4,"span",6),e.EFF(5),e.nI1(6,"async"),e.k0s(),e.nrm(7,"app-icon",7),e.k0s()(),e.j41(8,"mat-menu",null,0)(10,"button",8),e.bIt("click",function(){return e.eBV(o),e.Njj(i.setPlaybackSpeed(1))}),e.pXf(11,2),e.k0s(),e.j41(12,"button",8),e.bIt("click",function(){return e.eBV(o),e.Njj(i.setPlaybackSpeed(.5))}),e.EFF(13,"0.5"),e.k0s(),e.j41(14,"button",8),e.bIt("click",function(){return e.eBV(o),e.Njj(i.setPlaybackSpeed(.25))}),e.EFF(15,"0.25"),e.k0s(),e.j41(16,"button",8),e.bIt("click",function(){return e.eBV(o),e.Njj(i.setPlaybackSpeed(.1))}),e.EFF(17,"0.1"),e.k0s()()}if(2&t){const o=e.sdS(9);e.Y8G("matMenuTriggerFor",o),e.R7$(5),e.SpI("",e.bMT(6,2,i.playbackSpeed$),"x ")}},dependencies:[P.ri,Ie.kk,Ie.fb,Ie.Cp,j.oV,D.R,p.Jj],changeDetection:0})}!function(n,_,t,i){var a,o=arguments.length,s=o<3?_:null===i?i=Object.getOwnPropertyDescriptor(_,t):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(n,_,t,i);else for(var r=n.length-1;r>=0;r--)(a=n[r])&&(s=(o<3?a(s):o>3?a(_,t,s):a(_,t))||s);o>3&&s&&Object.defineProperty(_,t,s)}([(0,c.l6)(te.S.getPlaybackSpeed),function(n,_){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata("design:type",_)}(0,d.c)],Ni.prototype,"playbackSpeed$",void 0);var ri=function(n,_,t,i){var a,o=arguments.length,s=o<3?_:null===i?i=Object.getOwnPropertyDescriptor(_,t):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(n,_,t,i);else for(var r=n.length-1;r>=0;r--)(a=n[r])&&(s=(o<3?a(s):o>3?a(_,t,s):a(_,t))||s);return o>3&&s&&Object.defineProperty(_,t,s),s},li=function(n,_){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(n,_)};const Hr=["mediaPlayButton"];function Qr(n,_){if(1&n){const t=e.RV6();e.j41(0,"button",6),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.handlePlayChapterFromStartClick())}),e.j41(1,"span",7),e.pXf(2,0),e.k0s(),e.nrm(3,"app-icon",8),e.k0s()}}function Yr(n,_){1&n&&e.nrm(0,"app-view-scrubber",9)}function qr(n,_){if(1&n&&(e.j41(0,"div",10),e.EFF(1),e.k0s()),2&n){const t=e.XpG();e.R7$(),e.SpI(" ",t.timeLabel," ")}}function Kr(n,_){1&n&&e.nrm(0,"app-view-playback-speed")}class rt{set autoFocus(_){_&&!this.triedToFocus&&setTimeout(()=>{this.playButton.focus()},0),this.triedToFocus=!0}constructor(_,t,i,o,s){this.animationService=_,this.engineService=t,this.viewService=i,this.store=o,this.changeDetectorRef=s,this.viewLayout=E.U,this.buttonSize=P.Mp.Default,this.showScrubber=!0,this.showSpeed=!0,this.triedToFocus=!1,this.ngUnsubscribe=new z.B,this.timeLabel="0:00 / 0:00",this.viewUI=E.U}ngOnInit(){this.initChapterListener(),this.initTimelineListener()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initChapterListener(){this.chapterReadyState$.pipe((0,M.p)(_=>!(0,V.isNil)(_)&&_.animation),(0,g.Q)(this.ngUnsubscribe)).subscribe(()=>{this.timerange=this.animationService.getChapterTimeFrame(),this.tick(0)})}initTimelineListener(){this.engineService.getEvent($t.X.TimelinePlaying).pipe((0,q.Z)(500),(0,g.Q)(this.ngUnsubscribe)).subscribe(_=>{this.tick(_.time)})}handlePlayClick(){this.viewService.toggleAnimation()}handlePlayChapterFromStartClick(){this.viewService.playChapterFromStart()}setPlaybackSpeed(_){this.store.dispatch(new Ae.Vs(_))}tick(_){this.timerange&&(this.timeLabel=`${this.getFormattedTime(_)} / ${this.getFormattedTime(this.timerange.lastTime)}`,this.changeDetectorRef.markForCheck())}getFormattedTime(_){return`${Math.floor(Math.floor(_)/60)}:${(0,V.padStart)((Math.floor(_)%60).toString(),2,"0")}`}static#e=this.\u0275fac=function(t){return new(t||rt)(e.rXU(Ut.O),e.rXU(ni.y),e.rXU(F.z),e.rXU(c.il),e.rXU(e.gRc))};static#t=this.\u0275cmp=e.VBU({type:rt,selectors:[["app-view-media-bar"]],viewQuery:function(t,i){if(1&t&&e.GBs(Hr,5),2&t){let o;e.mGM(o=e.lsd())&&(i.playButton=o.first)}},inputs:{buttonSize:"buttonSize",showScrubber:"showScrubber",showSpeed:"showSpeed",autoFocus:"autoFocus"},decls:10,vars:12,consts:()=>{let _,t;return _=$localize`:␟623c2eb512dd08c852fcda4f15379224c8c97133␟7851550536336238650:Play Chapter From Start`,t=$localize`:␟b3e95ffdcd71216e76228de060aaa7fd8662266c␟162780291567006895:Play Chapter from Start`,[t,["data-test","viewMediaBar",1,"view-media-bar"],["app-view-button","","buttonSize","small","data-test","viewMediaRestart","matTooltip",_,"matTooltipPosition","above",3,"click",4,"ngIf"],["class","view-media-bar__scrubber",4,"ngIf"],["class","view-media-bar__time","data-test","viewMediaTime",4,"ngIf"],[4,"ngIf"],["app-view-button","","buttonSize","small","data-test","viewMediaRestart","matTooltip",_,"matTooltipPosition","above",3,"click"],[1,"sr-only"],["size","lg","icon","step-backward","aria-hidden","true"],[1,"view-media-bar__scrubber"],["data-test","viewMediaTime",1,"view-media-bar__time"]]},template:function(t,i){if(1&t&&(e.j41(0,"div",1),e.nrm(1,"app-view-play"),e.DNE(2,Qr,4,0,"button",2),e.nI1(3,"async"),e.DNE(4,Yr,1,0,"app-view-scrubber",3),e.nI1(5,"async"),e.DNE(6,qr,2,1,"div",4),e.nI1(7,"async"),e.DNE(8,Kr,1,0,"app-view-playback-speed",5),e.nI1(9,"async"),e.k0s()),2&t){let o,s,a,r;e.R7$(2),e.Y8G("ngIf","full"===(null==(o=e.bMT(3,4,i.mediaUI$))?null:o.template)),e.R7$(2),e.Y8G("ngIf","full"===(null==(s=e.bMT(5,6,i.mediaUI$))?null:s.template)&&i.showScrubber),e.R7$(2),e.Y8G("ngIf","full"===(null==(a=e.bMT(7,8,i.mediaUI$))?null:a.template)&&i.showScrubber),e.R7$(2),e.Y8G("ngIf","full"===(null==(r=e.bMT(9,10,i.mediaUI$))?null:r.template)&&i.showSpeed)}},dependencies:[p.bT,P.ri,j.oV,D.R,en,Mt,Ni,p.Jj],styles:[".view-media-bar[_ngcontent-%COMP%]{display:flex;align-items:center;height:100%;position:relative}.view-media-bar__scrubber[_ngcontent-%COMP%]{flex:1}.view-media-bar__scrubber--disabled[_ngcontent-%COMP%]{opacity:.5;pointer-events:none}.view-media-bar__time[_ngcontent-%COMP%]{display:inline-flex;align-items:center;padding:0 12px;font-size:12px;color:#374a68;height:100%;white-space:nowrap}.view-media-bar__playback[_ngcontent-%COMP%]{font-size:.75rem;line-height:1rem;font-weight:600}"],changeDetection:0})}ri([(0,c.l6)(b.N.getSelectedChapterId),li("design:type",d.c)],rt.prototype,"selectedChapterId$",void 0),ri([(0,c.l6)(b.N.getSelectedChapterReadyState),li("design:type",d.c)],rt.prototype,"chapterReadyState$",void 0),ri([(0,c.l6)(te.S.getPlaybackSpeed),li("design:type",d.c)],rt.prototype,"playbackSpeed$",void 0),ri([(0,c.l6)(f.Pf.getAutoplay),li("design:type",d.c)],rt.prototype,"autoplay$",void 0),ri([(0,c.l6)(O.dF.getVisible(E.U.Audio)),li("design:type",d.c)],rt.prototype,"audioVisible$",void 0),ri([(0,c.l6)(O.dF.getUIEntry(E.U.Media)),li("design:type",d.c)],rt.prototype,"mediaUI$",void 0);var fn=l(97352);function el(n,_){1&n&&e.nrm(0,"app-spinner",3)}function tl(n,_){if(1&n&&(e.nrm(0,"app-icon",4),e.nI1(1,"async")),2&n){const t=e.XpG();e.Y8G("icon",e.bMT(1,1,t.muted$)?"volume-slash":"volume")}}class ci{get text(){return this.store.selectSnapshot(tn.S.getAudioMuted)?$localize`Unmute`:$localize`Mute`}constructor(_,t){this.store=_,this.mediaService=t,this.buttonSize="small",this.buttonShape="square",this.buttonTheme="transparent-fill"}handleClick(){const _=this.store.selectSnapshot(b.N.getSelectedChapter),t=!this.store.selectSnapshot(tn.S.getAudioMuted);if(this.store.dispatch(new gn.O.SetAudioMuted(t)),t)this.mediaService.muteAudio();else if(this.mediaService.getPlayingAudio()?.length)this.mediaService.unmuteAudio(_.id);else{const o=this.store.selectSnapshot(f.Pf.getViewLanguage),s=this.store.selectSnapshot(f.Pf.getForceAudio);this.mediaService.getChapterAudioPlayer(_,o,s).then(()=>{this.mediaService.playChapterAudio(_.id)})}}static#e=this.\u0275fac=function(t){return new(t||ci)(e.rXU(c.il),e.rXU(We.u))};static#t=this.\u0275cmp=e.VBU({type:ci,selectors:[["app-view-audio-mute"]],inputs:{disabled:"disabled",buttonSize:"buttonSize",buttonShape:"buttonShape",buttonTheme:"buttonTheme"},decls:5,vars:13,consts:()=>{let _;return _=$localize`:␟17517742950bb7560a3ca4c8fa23122e16b56116␟3135353579204779711:mute audio`,[["type","button","app-view-button","","aria-label",_,"matTooltipPosition","above","data-test","viewAudioMute",1,"view-audio-mute",3,"click","buttonSize","buttonShape","buttonTheme","matTooltip","disabled"],["spinnerSize","small",4,"ngIf"],["appLogicalDir","","class","view-audio-mute__icon","aria-hidden","true",3,"icon",4,"ngIf"],["spinnerSize","small"],["appLogicalDir","","aria-hidden","true",1,"view-audio-mute__icon",3,"icon"]]},template:function(t,i){1&t&&(e.j41(0,"button",0),e.nI1(1,"async"),e.nI1(2,"async"),e.bIt("click",function(){return i.handleClick()}),e.DNE(3,el,1,0,"app-spinner",1)(4,tl,2,3,"app-icon",2),e.k0s()),2&t&&(e.Y8G("buttonSize",i.buttonSize)("buttonShape",i.buttonShape)("buttonTheme",i.buttonTheme)("matTooltip",i.text)("disabled",i.disabled),e.BMQ("aria-pressed",!1===e.bMT(1,9,i.muted$))("data-test-muted",e.bMT(2,11,i.muted$)),e.R7$(3),e.Y8G("ngIf",i.disabled),e.R7$(),e.Y8G("ngIf",!i.disabled))},dependencies:[p.bT,P.ri,j.oV,D.R,fn.tI,Ot.e,p.Jj],changeDetection:0})}!function(n,_,t,i){var a,o=arguments.length,s=o<3?_:null===i?i=Object.getOwnPropertyDescriptor(_,t):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(n,_,t,i);else for(var r=n.length-1;r>=0;r--)(a=n[r])&&(s=(o<3?a(s):o>3?a(_,t,s):a(_,t))||s);o>3&&s&&Object.defineProperty(_,t,s)}([(0,c.l6)(tn.S.getAudioMuted),function(n,_){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata("design:type",_)}(0,d.c)],ci.prototype,"muted$",void 0);let Uo=(()=>{class n{constructor(){}ngOnInit(){}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-button-loader"]],decls:5,vars:0,consts:()=>{let t,i,o;return t=$localize`:␟b13403343605d44ebc315fb7b618d8d859410163␟306128254471360973:Interact in 3D`,i=$localize`:␟b13403343605d44ebc315fb7b618d8d859410163␟306128254471360973:Interact in 3D`,o=$localize`:␟b13403343605d44ebc315fb7b618d8d859410163␟306128254471360973:Interact in 3D`,[o,["type","button","aria-label",t,"type","button",1,"button-loader"],[1,"button-loader__button"],["src","assets/images/widget/loading_experience/interact-in-3d-arrow.svg","alt",i,1,"button-loader__3d-arrow"],[1,"button-loader__label"]]},template:function(i,o){1&i&&(e.j41(0,"button",1)(1,"div",2),e.nrm(2,"img",3),e.j41(3,"div",4),e.pXf(4,0),e.k0s()()())},styles:[".button-loader[_ngcontent-%COMP%]{border:0;background:#0003;display:flex;position:fixed;justify-content:center;align-items:center;inset:0;width:100%;height:100%;transition:background-color .25s,opacity .25s;z-index:10000}.button-loader[_ngcontent-%COMP%]:hover{opacity:1;cursor:pointer;background:#0003}@media print{.button-loader[_ngcontent-%COMP%]{display:none}}.button-loader[_ngcontent-%COMP%]:focus   .button-loader__button[_ngcontent-%COMP%], .button-loader[_ngcontent-%COMP%]:hover   .button-loader__button[_ngcontent-%COMP%]{background-color:#2d72dc;transform:scale(1.1)}.button-loader[_ngcontent-%COMP%]:focus   .button-loader__3d-arrow[_ngcontent-%COMP%], .button-loader[_ngcontent-%COMP%]:hover   .button-loader__3d-arrow[_ngcontent-%COMP%]{transform:scale(1.2)}.button-loader__button[_ngcontent-%COMP%]{display:flex;padding:12px 28px;border-radius:32px;align-items:center;transition:transform .25s,background-color .25s;background-color:#101823cc}.button-loader__3d-arrow[_ngcontent-%COMP%]{transition:transform .25s;margin-inline-end:4px}.button-loader__label[_ngcontent-%COMP%]{font-size:1rem;line-height:1.5rem;color:#fff;font-weight:600;margin-inline-start:4px}"],changeDetection:0})}return n})(),Vo=(()=>{class n{constructor(){}ngOnInit(){}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-hand-loader"]],decls:6,vars:0,consts:()=>{let t,i,o;return t=$localize`:␟b13403343605d44ebc315fb7b618d8d859410163␟306128254471360973:Interact in 3D`,i=$localize`:␟b13403343605d44ebc315fb7b618d8d859410163␟306128254471360973:Interact in 3D`,o=$localize`:␟b13403343605d44ebc315fb7b618d8d859410163␟306128254471360973:Interact in 3D`,[o,["type","button","aria-label",t,1,"hand-loader"],[1,"hand-loader__container"],[1,"hand-loader__circle"],["src","assets/images/widget/loading_experience/interact-in-3d-hand.svg","alt",i,1,"hand-loader__3d-hand"],[1,"hand-loader__label"]]},template:function(i,o){1&i&&(e.j41(0,"button",1)(1,"div",2),e.nrm(2,"div",3)(3,"img",4),e.j41(4,"div",5),e.pXf(5,0),e.k0s()()())},styles:[".hand-loader[_ngcontent-%COMP%]{border:0;background:#0003;display:flex;position:fixed;justify-content:center;align-items:center;inset:0;width:100%;height:100%;transition:background-color .25s,opacity .25s;z-index:10000}.hand-loader[_ngcontent-%COMP%]:hover{opacity:1;cursor:pointer;background:#0003}@keyframes _ngcontent-%COMP%_handKeyframes{0%{transform:scale(1.2)}25%{transform:scale(1)}40%{transform:scale(1)}60%{transform:scale(1.2)}to{transform:scale(1.2)}}@keyframes _ngcontent-%COMP%_circleKeyframes{0%{transform:scale(0)}20%{transform:scale(0);opacity:1}to{transform:scale(1);opacity:0}}.hand-loader[_ngcontent-%COMP%]:focus   .hand-loader__3d-hand[_ngcontent-%COMP%], .hand-loader[_ngcontent-%COMP%]:hover   .hand-loader__3d-hand[_ngcontent-%COMP%]{filter:drop-shadow(0 0 8px #2d72dc)}.hand-loader__container[_ngcontent-%COMP%]{position:relative;width:200px;height:200px}.hand-loader__circle[_ngcontent-%COMP%]{background-color:#fff;position:absolute;left:50%;margin-left:-40.5px;margin-top:-1.5px;width:70px;height:70px;border-radius:50%;animation:_ngcontent-%COMP%_circleKeyframes 2s infinite}.hand-loader__3d-hand[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_handKeyframes 2s ease-in-out infinite;position:absolute;height:96px;width:86px;left:50%;margin-left:-43px;margin-top:27px;transition:filter .3s ease-out}.hand-loader__label[_ngcontent-%COMP%]{font-size:1rem;line-height:1.5rem;font-weight:600;color:#fff;text-shadow:0px 1px 5px black;bottom:40px;position:absolute;text-align:center;width:100%}"],changeDetection:0})}return n})();const il=["circle"],nl=["progressCircle"],ol=["progressContainer"];let Do=(()=>{class n{get percent(){return this._percent}set percent(t){null!=t&&(this._percent=t,this.setProgress(this.percent))}constructor(t){this.renderer=t,this.ngUnsubscribe=new z.B,this._percent=0}ngOnInit(){this.initSizeObserver()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}ngAfterViewInit(){this.updateDimensions()}initSizeObserver(){(0,ye.R)(window,"resize").pipe((0,Re.B)(10),(0,g.Q)(this.ngUnsubscribe)).subscribe(()=>{this.updateDimensions()})}calculateRadius(){return this.getCircleWidth()/2}getCircleWidth(){return this.circleRef.nativeElement.offsetWidth}getRadius(){return this.progressCircleRef.nativeElement.r.baseVal.value}getCircumference(){return 2*this.getRadius()*Math.PI}getOffset(t=100){const i=this.getCircumference();return i-t/100*i}setProgress(t=0){t>=100&&(t=100);const i=this.getCircumference(),o=this.getOffset(t);this.renderer.setStyle(this.progressCircleRef.nativeElement,"strokeDasharray",`${i} ${i}`),this.renderer.setStyle(this.progressCircleRef.nativeElement,"strokeDashoffset",`${o}`)}updateDimensions(){const t=this.calculateRadius();this.renderer.setAttribute(this.progressContainerRef.nativeElement,"width",""+2*t),this.renderer.setAttribute(this.progressContainerRef.nativeElement,"height",""+2*t),this.renderer.setAttribute(this.progressCircleRef.nativeElement,"r",""+(t-6)),this.renderer.setAttribute(this.progressCircleRef.nativeElement,"cx",`${t}`),this.renderer.setAttribute(this.progressCircleRef.nativeElement,"cy",`${t}`);const i=this.getCircumference();this.renderer.setStyle(this.progressCircleRef.nativeElement,"strokeDasharray",`${i} ${i}`),this.renderer.setStyle(this.progressCircleRef.nativeElement,"strokeDashoffset",`${i}`),setTimeout(()=>{this.renderer.setStyle(this.progressCircleRef.nativeElement,"transition","stroke-dashoffset 300ms")})}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(e.sFG))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-play-loader"]],viewQuery:function(i,o){if(1&i&&(e.GBs(il,7),e.GBs(nl,7),e.GBs(ol,7)),2&i){let s;e.mGM(s=e.lsd())&&(o.circleRef=s.first),e.mGM(s=e.lsd())&&(o.progressCircleRef=s.first),e.mGM(s=e.lsd())&&(o.progressContainerRef=s.first)}},inputs:{percent:"percent"},decls:10,vars:0,consts:()=>{let t,i;return t=$localize`:␟b13403343605d44ebc315fb7b618d8d859410163␟306128254471360973:Interact in 3D`,i=$localize`:␟4b03875d535c300d85a81c17105d24d85adadbae␟9093351263643113653:3D`,[["circle",""],["progressContainer",""],["progressCircle",""],i,["type","button","aria-label",t,1,"play-loader"],[1,"play-loader__circle"],[1,"play-loader__ring"],[1,"play-loader__ring-inner"],["icon","play",1,"play-loader__icon"],[1,"play-loader__label"]]},template:function(i,o){1&i&&(e.j41(0,"button",4)(1,"div",5,0),e.qSk(),e.j41(3,"svg",6,1),e.nrm(5,"circle",7,2),e.k0s(),e.joV(),e.nrm(7,"app-icon",8),e.j41(8,"div",9),e.pXf(9,3),e.k0s()()())},dependencies:[D.R],styles:[".play-loader[_ngcontent-%COMP%]{--buttonSize: 35vw;border:0;background:#0003;display:flex;position:fixed;justify-content:center;align-items:center;inset:0;width:100%;height:100%;transition:background-color .25s,opacity .25s;z-index:10000}.play-loader[_ngcontent-%COMP%]:hover{opacity:1;cursor:pointer;background:#0003}.play-loader[_ngcontent-%COMP%]:focus   .play-loader__circle[_ngcontent-%COMP%], .play-loader[_ngcontent-%COMP%]:hover   .play-loader__circle[_ngcontent-%COMP%]{background:#fffc;transform:scale(1.1)}.play-loader[_ngcontent-%COMP%]:focus   .play-loader__icon[_ngcontent-%COMP%], .play-loader[_ngcontent-%COMP%]:hover   .play-loader__icon[_ngcontent-%COMP%]{color:#2d72dc;transform:scale(1.2)}.play-loader[_ngcontent-%COMP%]:focus   .play-loader__label[_ngcontent-%COMP%], .play-loader[_ngcontent-%COMP%]:hover   .play-loader__label[_ngcontent-%COMP%]{color:#fff}.play-loader[_ngcontent-%COMP%]:focus   .play-loader__ring[_ngcontent-%COMP%], .play-loader[_ngcontent-%COMP%]:hover   .play-loader__ring[_ngcontent-%COMP%]{stroke:#2d72dc}.play-loader__circle[_ngcontent-%COMP%]{width:var(--buttonSize);height:var(--buttonSize);border-radius:50%;background-color:#101823cc;display:flex;align-items:center;justify-content:center;position:relative;transition:background-color .25s,color .25s,transform .25s}.play-loader__icon[_ngcontent-%COMP%]{font-size:calc(var(--buttonSize) / 2);color:#ffffffe6;transition:color .25s,transform .25s;margin-right:-10%}.play-loader__label[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;display:flex;justify-content:center;align-items:center;z-index:2;font-weight:600}.play-loader__ring[_ngcontent-%COMP%]{position:absolute;inset:0;z-index:3;stroke-width:4;stroke:#fff;fill:transparent;transform:rotate(-90deg)}@media (min-width: 600px){.play-loader__circle[_ngcontent-%COMP%]{width:160px;height:160px}.play-loader__icon[_ngcontent-%COMP%]{font-size:80px}}"],changeDetection:0})}return n})();var Wn=l(33013),ze=l(43753),Ri=l(76774),Lo=(l(24484),l(5951)),Pi=l(40819),xo=l(78109),_l=l(77242),sl=l(41640);function al(n,_){if(1&n&&(e.j41(0,"app-list-item")(1,"div",1),e.EFF(2),e.k0s()()),2&n){const t=_.$implicit;e.R7$(),e.BMQ("data-id",t.id),e.R7$(),e.JRh(t.label)}}let $o=(()=>{class n{get objectIds(){return this._objectIds}set objectIds(t){this._objectIds=t;const i=this.store.selectSnapshot(te.S.getViewGraph);this.nodes=this.graphService.getNodes(i,t),this.changeRef.markForCheck()}constructor(t,i,o){this.store=t,this.graphService=i,this.changeRef=o}ngOnInit(){}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(c.il),e.rXU(xo.w),e.rXU(e.gRc))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-view-quiz-object-tree"]],inputs:{objectIds:"objectIds"},decls:2,vars:1,consts:[[4,"ngFor","ngForOf"],[1,"text-sm","my-1"]],template:function(i,o){1&i&&(e.j41(0,"app-list"),e.DNE(1,al,3,2,"app-list-item",0),e.k0s()),2&i&&(e.R7$(),e.Y8G("ngForOf",o.nodes))},dependencies:[p.Sq,_l.s,sl.P],changeDetection:0})}return n})();var rl=l(91442),ll=l(57743);let ko=(()=>{class n{constructor(){}ngOnInit(){}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-view-quiz-answer-number"]],inputs:{number:"number"},decls:3,vars:1,consts:[[1,"number","text-2xs"]],template:function(i,o){1&i&&(e.j41(0,"div",0)(1,"div"),e.EFF(2),e.k0s()()),2&i&&(e.R7$(2),e.JRh(o.number))},styles:[".number[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:20px;height:20px;color:#131c2a;border:1px solid rgba(55,74,104,.5);border-radius:50%}"],changeDetection:0})}return n})();function pl(n,_){if(1&n&&(e.j41(0,"div",3)(1,"div",4),e.nrm(2,"app-view-quiz-answer-number",5),e.k0s(),e.j41(3,"div",6),e.nrm(4,"app-quiz-label-anatomy-select",7),e.k0s()()),2&n){const t=_.index,i=e.XpG();e.R7$(2),e.Y8G("number",t+1),e.R7$(2),e.Y8G("options",i.options)("formControlName",t)}}class Ui{get options(){return this._options}set options(_){(0,V.isEqual)(_,this._options)||(this._options=_,this.buildFormOptions(_))}constructor(_){this.formBuilder=_,this.valueChange=new e.bkB,this.ngUnsubscribe=new z.B,this._options=[],this.form=this.formBuilder.group({options:this.formBuilder.array([])}),this.optionsArray=this.form.get("options")}ngOnInit(){this.initFormListeners(),this.init()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initFormListeners(){this.form.valueChanges.pipe((0,g.Q)(this.ngUnsubscribe)).subscribe(({options:_})=>{this.valueChange.next(_)})}init(){this.activeSubmission$.pipe((0,M.p)(_=>!(0,V.isNil)(_)&&!(0,V.isNil)(_.answer)),(0,si.J)(),(0,g.Q)(this.ngUnsubscribe)).subscribe(([_,t])=>{const i=(0,rl.R)(_.answer||[],t.answer||[],"");(0,V.isEqual)(t,i)||this.form.patchValue({options:i||[]})}),this.activeSubmission$.pipe((0,M.p)(_=>!(0,V.isNil)(_)&&!(0,V.isNil)(_.answer)&&Array.isArray(_.answer)),(0,J.F)((_,t)=>(0,V.isEqual)(_,t)),(0,g.Q)(this.ngUnsubscribe)).subscribe(_=>{const i=_.answer;(0,V.isEqual)(this.form.value.options,i)||this.form.patchValue({options:i},{emitEvent:!1,onlySelf:!0})})}buildFormOptions(_){this.optionsArray.clear(),_.forEach(()=>{this.optionsArray.push(this.formBuilder.control(""))}),this.optionsArray.setValue(_.map(()=>""))}static#e=this.\u0275fac=function(t){return new(t||Ui)(e.rXU(Z.ze))};static#t=this.\u0275cmp=e.VBU({type:Ui,selectors:[["app-view-quiz-label-anatomy"]],inputs:{options:"options"},outputs:{valueChange:"valueChange"},decls:3,vars:2,consts:[[1,"options",3,"formGroup"],["formArrayName","options"],["class","options__item","data-test","questionAnswer",4,"ngFor","ngForOf"],["data-test","questionAnswer",1,"options__item"],[1,"mr-2"],[3,"number"],[1,"options__item-select"],[3,"options","formControlName"]],template:function(t,i){1&t&&(e.j41(0,"div",0)(1,"div",1),e.DNE(2,pl,5,3,"div",2),e.k0s()()),2&t&&(e.Y8G("formGroup",i.form),e.R7$(2),e.Y8G("ngForOf",i.options))},dependencies:[p.Sq,Z.BC,Z.cb,Z.j4,Z.JD,Z.v8,ll.w,ko],styles:[".options__item[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;margin-bottom:12px}.options__item-select[_ngcontent-%COMP%]{border:1px solid #96a8c0;border-radius:4px;flex:1 1 auto}"],changeDetection:0})}!function(n,_,t,i){var a,o=arguments.length,s=o<3?_:null===i?i=Object.getOwnPropertyDescriptor(_,t):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(n,_,t,i);else for(var r=n.length-1;r>=0;r--)(a=n[r])&&(s=(o<3?a(s):o>3?a(_,t,s):a(_,t))||s);o>3&&s&&Object.defineProperty(_,t,s)}([(0,c.l6)(w.j.getActiveSubmission),function(n,_){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata("design:type",_)}(0,d.c)],Ui.prototype,"activeSubmission$",void 0);var Go=function(n,_,t,i){var a,o=arguments.length,s=o<3?_:null===i?i=Object.getOwnPropertyDescriptor(_,t):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(n,_,t,i);else for(var r=n.length-1;r>=0;r--)(a=n[r])&&(s=(o<3?a(s):o>3?a(_,t,s):a(_,t))||s);return o>3&&s&&Object.defineProperty(_,t,s),s},Wo=function(n,_){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(n,_)};function ul(n,_){if(1&n&&(e.j41(0,"mat-radio-button",8),e.EFF(1),e.k0s()),2&n){const t=_.$implicit;e.Y8G("value",t.value),e.R7$(),e.SpI(" ",t.label," ")}}function hl(n,_){if(1&n){const t=e.RV6();e.j41(0,"div")(1,"mat-radio-group",6),e.bIt("change",function(o){e.eBV(t);const s=e.XpG(2);return e.Njj(s.handleMultipleChoiceChange(o))}),e.DNE(2,ul,2,2,"mat-radio-button",7),e.k0s()()}if(2&n){const t=e.XpG(2);e.R7$(2),e.Y8G("ngForOf",t.question.data.options)}}function gl(n,_){if(1&n&&(e.j41(0,"div",10),e.nrm(1,"app-view-quiz-object-tree",11),e.k0s()),2&n){const t=e.XpG(3);e.R7$(),e.Y8G("objectIds",t.question.data.correctAnswer)}}function El(n,_){if(1&n&&(e.j41(0,"div"),e.DNE(1,gl,2,1,"div",9),e.k0s()),2&n){const t=e.XpG(2);e.R7$(),e.Y8G("ngIf",t.question.data.showAnswerList)}}function Sl(n,_){if(1&n){const t=e.RV6();e.j41(0,"div")(1,"app-view-quiz-label-anatomy",12),e.bIt("valueChange",function(o){e.eBV(t);const s=e.XpG(2);return e.Njj(s.handleLabelAnatomyChanges(o))}),e.k0s()()}if(2&n){const t=e.XpG(2);e.R7$(),e.Y8G("options",t.question.data.options)}}function ml(n,_){if(1&n&&(e.j41(0,"div",1)(1,"div",2),e.nrm(2,"app-content-blocks",3),e.k0s(),e.j41(3,"div",4),e.DNE(4,hl,3,1,"div",5)(5,El,2,1,"div",5)(6,Sl,2,1,"div",5),e.k0s()()),2&n){const t=e.XpG();e.R7$(2),e.Y8G("contentBlocks",t.question.questionPrompt),e.R7$(),e.Y8G("ngSwitch",t.question.type),e.R7$(),e.Y8G("ngSwitchCase",t.QuestionType.MultipleChoice),e.R7$(),e.Y8G("ngSwitchCase",t.QuestionType.SelectAnatomy),e.R7$(),e.Y8G("ngSwitchCase",t.QuestionType.LabelAnatomy)}}class kt{get question(){return this._question}set question(_){this._question=_,this.initQuestionListeners()}get value(){return this._value}set value(_){this._value=_,this.onChange(_)}constructor(_,t){this.changeRef=_,this.viewService=t,this.disabled=!1,this.QuestionType=ze.Q5,this.ngUnsubscribe=new z.B}handleMultipleChoiceChange(_){this.writeValue(_.value)}handleLabelAnatomyChanges(_){this.writeValue(_)}initQuestionListeners(){switch(this.question.type){case ze.Q5.SelectAnatomy:this.initSelectAnatomyListeners();break;case ze.Q5.Instructions:this.initInstructions()}}initSelectAnatomyListeners(){this.checkedNodesIds$.pipe((0,J.F)((_,t)=>(0,V.isEqual)(_,t)),(0,g.Q)(this.ngUnsubscribe)).subscribe(_=>{this.writeValue(_),this.changeRef.markForCheck()})}initInstructions(){setTimeout(()=>{this.writeValue("-"),this.changeRef.markForCheck()})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}onChange(_){}onTouched(){}registerOnTouched(_){this.onTouched=_}registerOnChange(_){this.onChange=_}writeValue(_){this.value=_}setDisabledState(_){this.disabled=_}static#e=this.\u0275fac=function(t){return new(t||kt)(e.rXU(e.gRc),e.rXU(F.z))};static#t=this.\u0275cmp=e.VBU({type:kt,selectors:[["app-view-quiz-question"]],inputs:{question:"question",value:"value"},features:[e.Jv_([{provide:Z.kq,useExisting:(0,e.Rfq)(()=>kt),multi:!0}])],decls:1,vars:1,consts:[["class","view-quiz-question text-sm mb-8","data-test","question",4,"ngIf"],["data-test","question",1,"view-quiz-question","text-sm","mb-8"],["data-test","questionPrompt",1,"view-quiz-question__prompt"],[3,"contentBlocks"],[3,"ngSwitch"],[4,"ngSwitchCase"],[1,"flex","flex-col",3,"change"],["data-test","questionAnswer","class","view-quiz-question__option",3,"value",4,"ngFor","ngForOf"],["data-test","questionAnswer",1,"view-quiz-question__option",3,"value"],["class","ml-3",4,"ngIf"],[1,"ml-3"],[3,"objectIds"],[3,"valueChange","options"]],template:function(t,i){1&t&&e.DNE(0,ml,7,5,"div",0),2&t&&e.Y8G("ngIf",i.question)},dependencies:[p.Sq,p.bT,p.ux,p.e1,Lo.VT,Lo._g,Pi.l,$o,Ui],styles:[".view-quiz-question__prompt{margin-bottom:8px}.view-quiz-question__option{font-size:.875rem;line-height:1.25rem;padding:12px;white-space:normal!important}.view-quiz-question__option>*{white-space:normal!important}\n"],encapsulation:2,changeDetection:0})}Go([(0,c.l6)(xt.z.getCheckedNodeIds),Wo("design:type",d.c)],kt.prototype,"checkedNodesIds$",void 0),Go([(0,c.l6)(w.j.getActiveSubmission),Wo("design:type",d.c)],kt.prototype,"activeSubmission$",void 0);var Xo=l(13976);const fl=["*"];function Tl(n,_){1&n&&e.nrm(0,"app-icon",6)}function bl(n,_){1&n&&e.nrm(0,"app-icon",7)}function vl(n,_){1&n&&(e.j41(0,"span",8),e.nrm(1,"span",9),e.k0s())}let Xn=(()=>{class n{constructor(){}ngOnInit(){}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-view-quiz-answer-option"]],inputs:{correct:"correct"},ngContentSelectors:fl,decls:7,vars:7,consts:[["data-test","answerOptionContainer",1,"option"],[1,"flex","relative",3,"ngSwitch"],["class","option__icon option__icon--correct","style","font-size: 20px","icon","check-circle",4,"ngSwitchCase"],["class","option__icon option__icon--incorrect","style","font-size: 20px","icon","times-circle",4,"ngSwitchCase"],["class","option__icon",4,"ngSwitchDefault"],[1,"pl-2"],["icon","check-circle",1,"option__icon","option__icon--correct",2,"font-size","20px"],["icon","times-circle",1,"option__icon","option__icon--incorrect",2,"font-size","20px"],[1,"option__icon"],[1,"mat-radio-outer-circle"]],template:function(i,o){1&i&&(e.NAR(),e.j41(0,"div",0)(1,"div",1),e.DNE(2,Tl,1,0,"app-icon",2)(3,bl,1,0,"app-icon",3)(4,vl,2,0,"span",4),e.j41(5,"div",5),e.SdG(6),e.k0s()()()),2&i&&(e.AVh("option--correct",!0===o.correct)("option--incorrect",!1===o.correct),e.R7$(),e.Y8G("ngSwitch",o.correct),e.R7$(),e.Y8G("ngSwitchCase",!0),e.R7$(),e.Y8G("ngSwitchCase",!1))},dependencies:[p.ux,p.e1,p.fG,D.R],styles:[".option[_ngcontent-%COMP%]{padding:12px;border-radius:4px;margin-bottom:8px;color:#131c2a}.option--correct[_ngcontent-%COMP%]{border:1px solid #83e692;background-color:#f0fff0}.option--incorrect[_ngcontent-%COMP%]{border:1px solid #f44336;background-color:#ffe2db}.option__icon[_ngcontent-%COMP%]{position:relative;flex:0 0 20px;justify-content:center}.option__icon--correct[_ngcontent-%COMP%]{color:#83e692}.option__icon--incorrect[_ngcontent-%COMP%]{color:#f44336}"],changeDetection:0})}return n})();function Ol(n,_){if(1&n&&(e.j41(0,"div")(1,"app-view-quiz-answer-option",1)(2,"div"),e.EFF(3),e.k0s()()()),2&n){const t=_.$implicit,i=e.XpG();e.R7$(),e.Y8G("correct",i.isOptionAnswerCorrect(i.question,t.value,i.answer)),e.R7$(2),e.SpI(" ",t.label," ")}}let Cl=(()=>{class n{constructor(){}ngOnInit(){}isOptionAnswerCorrect(t,i,o){const s=(0,Ri.Br)(t,[i]);return i===o[0]||s?s:void 0}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-view-quiz-multiple-choice-answer"]],inputs:{question:"question",answer:"answer",summary:"summary"},decls:1,vars:1,consts:[[4,"ngFor","ngForOf"],[3,"correct"]],template:function(i,o){1&i&&e.DNE(0,Ol,4,2,"div",0),2&i&&e.Y8G("ngForOf",o.question.data.options)},dependencies:[p.Sq,Xn],changeDetection:0})}return n})();var Il=l(20458);function Ml(n,_){1&n&&(e.qex(0),e.pXf(1,1),e.bVm())}function wl(n,_){1&n&&(e.qex(0),e.pXf(1,2),e.bVm())}function Al(n,_){if(1&n){const t=e.RV6();e.j41(0,"div",11)(1,"button",12),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.handleSelectedObjectsClick(o.answer))}),e.pXf(2,3),e.k0s(),e.j41(3,"button",13),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.handleCorrectObjectsClick(o.question.data.correctAnswer))}),e.EFF(4," Highlight Correct Answer "),e.k0s()()}}let yl=(()=>{class n{get isCorrect(){return(0,Ri.Br)(this.question,this.answer)}constructor(t,i,o){this.graphService=t,this.viewService=i,this.store=o}fadeNonselected(t){const i=this.store.selectSnapshot(te.S.getViewGraph),o=this.graphService.getInverseSelection(i,t),s=this.graphService.getNodes(i,o);this.store.dispatch(new dt.Jp(Il.EC,s.map(a=>a.id)))}handleCorrectObjectsClick(t){this.highlightNodes(t)}handleSelectedObjectsClick(t){this.highlightNodes(t)}highlightNodes(t){const i=t.filter(o=>o&&""!==o);this.resetSelectAndFade(),this.repositionCamera(i),this.fadeNonselected(i)}repositionCamera(t){1===t.length?this.store.dispatch(new Ae.W6(t[0])):this.viewService.resetCamera()}resetSelectAndFade(){this.viewService.clearSelectedNodes(),this.viewService.clearFadedNodes()}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(xo.w),e.rXU(F.z),e.rXU(c.il))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-view-quiz-select-anatomy-answer"]],inputs:{question:"question",answer:"answer",summary:"summary"},decls:11,vars:5,consts:()=>{let t,i,o;return t=$localize`:␟4274205d4ae04ab28b67840a011bbbc3c207f608␟3164453258197222114:Correct! You selected:`,i=$localize`:␟86fadbb89f45c1d0fad1eae1936d43d4e59e065a␟682829795532587629:Incorrect! You selected:`,o=$localize`:␟a5dfb5defc5b4f7d9d17e3175f3a2832a3380187␟2737293371102556031: Highlight My Answer `,[["selectAnatomyAnswer",""],t,i,o,[3,"correct"],[1,"flex","flex-col"],[1,"font-semibold"],[4,"ngIf"],[1,"mt-2","ml-2"],[3,"objectIds"],["class","flex flex-col gap-2 mt-4",4,"ngIf"],[1,"flex","flex-col","gap-2","mt-4"],["app-view-button","","buttonSize","small","buttonShape","rounded","buttonTheme","light-gray-fill","data-test","highlightUserAnswers",1,"w-full",3,"click"],["app-view-button","","buttonSize","small","buttonShape","rounded","buttonTheme","light-gray-fill","data-test","highlightCorrectAnswers",1,"w-full",3,"click"]]},template:function(i,o){if(1&i&&(e.j41(0,"div")(1,"app-view-quiz-answer-option",4,0)(3,"div",5)(4,"div")(5,"span",6),e.DNE(6,Ml,2,0,"ng-container",7)(7,wl,2,0,"ng-container",7),e.k0s()(),e.j41(8,"div",8),e.nrm(9,"app-view-quiz-object-tree",9),e.k0s()()(),e.DNE(10,Al,5,0,"div",10),e.k0s()),2&i){const s=e.sdS(2);e.R7$(),e.Y8G("correct",o.isCorrect),e.R7$(5),e.Y8G("ngIf",s.correct),e.R7$(),e.Y8G("ngIf",!s.correct),e.R7$(2),e.Y8G("objectIds",o.answer),e.R7$(),e.Y8G("ngIf",!o.summary&&!o.isCorrect)}},dependencies:[p.bT,P.ri,$o,Xn],changeDetection:0})}return n})();function Nl(n,_){if(1&n&&(e.j41(0,"div"),e.EFF(1),e.k0s()),2&n){const t=e.XpG().$implicit;e.R7$(),e.SpI(" ",t.label.title," ")}}function Rl(n,_){if(1&n&&(e.j41(0,"div"),e.pXf(1,2),e.k0s(),e.j41(2,"div",11),e.pXf(3,3),e.k0s()),2&n){const t=e.XpG(),i=t.$implicit,o=t.index,s=e.XpG();e.R7$(),e.uP7(s.getSelectedUserOption(o).label.title.trim()),e.nnv(1),e.R7$(2),e.uP7(i.label.title.trim()),e.nnv(3)}}function Pl(n,_){if(1&n&&(e.j41(0,"div",5)(1,"div",6),e.nrm(2,"app-view-quiz-answer-number",7),e.k0s(),e.j41(3,"div",8)(4,"app-view-quiz-answer-option",9,0),e.DNE(6,Nl,2,1,"div",10)(7,Rl,4,2,"ng-template",null,1,e.C5r),e.k0s()()()),2&n){const t=_.index,i=e.sdS(5),o=e.sdS(8),s=e.XpG();e.R7$(2),e.Y8G("number",t+1),e.R7$(2),e.Y8G("correct",s.isOptionAnswerCorrect(t)),e.R7$(2),e.Y8G("ngIf",i.correct)("ngIfElse",o)}}let Ul=(()=>{class n{constructor(){}ngOnInit(){}isOptionAnswerCorrect(t){return this.answer[t]===this.question.data.correctAnswer[t]}getSelectedUserOption(t){const i=this.answer[t];return this.question.data.options.find(o=>o.value===i)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-view-quiz-label-anatomy-answer"]],inputs:{question:"question",answer:"answer",summary:"summary"},decls:1,vars:1,consts:()=>{let t,i;return t=$localize`:␟a72b1c5957d49334a91017e69eb28a64b4794be9␟3931625009645654184:You selected ${"\ufffd0\ufffd"}:INTERPOLATION:.`,i=$localize`:␟68452fc86b9a1e10579d11cafee518846c2acf74␟7572660995305138875:This is the ${"\ufffd0\ufffd"}:INTERPOLATION:.`,[["answerOption",""],["falseBlock",""],t,i,["class","answers",4,"ngFor","ngForOf"],[1,"answers"],[1,"answers__number"],[3,"number"],[1,"answers__option"],[3,"correct"],[4,"ngIf","ngIfElse"],[1,"mt-1"]]},template:function(i,o){1&i&&e.DNE(0,Pl,9,4,"div",4),2&i&&e.Y8G("ngForOf",o.question.data.options)},dependencies:[p.Sq,p.bT,Xn,ko],styles:[".answers[_ngcontent-%COMP%]{display:flex;flex-direction:row}.answers__number[_ngcontent-%COMP%]{border-top:1px solid transparent;margin-top:12px;margin-inline-end:8px}.answers__option[_ngcontent-%COMP%]{flex:1 1 auto}"],changeDetection:0})}return n})();function Vl(n,_){if(1&n&&(e.j41(0,"div",7),e.EFF(1),e.k0s()),2&n){const t=e.XpG();e.R7$(),e.SpI("",t.questionNumber,".")}}function Dl(n,_){if(1&n&&(e.j41(0,"div"),e.nrm(1,"app-view-quiz-multiple-choice-answer",8),e.k0s()),2&n){const t=e.XpG();e.R7$(),e.Y8G("question",t.question)("answer",t.answer)("summary",t.summary)}}function Ll(n,_){if(1&n&&(e.j41(0,"div"),e.nrm(1,"app-view-quiz-select-anatomy-answer",8),e.k0s()),2&n){const t=e.XpG();e.R7$(),e.Y8G("question",t.question)("answer",t.answer)("summary",t.summary)}}function xl(n,_){if(1&n&&(e.j41(0,"div"),e.nrm(1,"app-view-quiz-label-anatomy-answer",8),e.k0s()),2&n){const t=e.XpG();e.R7$(),e.Y8G("question",t.question)("answer",t.answer)("summary",t.summary)}}function $l(n,_){if(1&n&&(e.j41(0,"div",9),e.nrm(1,"app-content-blocks",3),e.k0s()),2&n){const t=e.XpG();e.R7$(),e.Y8G("contentBlocks",t.question.explanation)}}let Fo=(()=>{class n{constructor(t,i){this.store=t,this.contentBlocksService=i,this.QuestionType=ze.Q5,this.hasExplanation=!1}ngOnInit(){this.store.dispatch(new It.B.SetQuizPickMode("none")),this.hasExplanation=this.contentBlocksService.hasContentBlockText(this.question.explanation)}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(c.il),e.rXU(Xo.V))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-view-quiz-answer"]],inputs:{question:"question",questionNumber:"questionNumber",answer:"answer",summary:"summary"},decls:10,vars:7,consts:[["data-test","answer",1,"answer"],[1,"answer__prompt"],["class","mr-1",4,"ngIf"],[3,"contentBlocks"],[3,"ngSwitch"],[4,"ngSwitchCase"],["class","answer__explanation",4,"ngIf"],[1,"mr-1"],[3,"question","answer","summary"],[1,"answer__explanation"]],template:function(i,o){1&i&&(e.j41(0,"div",0)(1,"div",1),e.DNE(2,Vl,2,1,"div",2),e.j41(3,"div"),e.nrm(4,"app-content-blocks",3),e.k0s()(),e.j41(5,"div",4),e.DNE(6,Dl,2,3,"div",5)(7,Ll,2,3,"div",5)(8,xl,2,3,"div",5),e.k0s(),e.DNE(9,$l,2,1,"div",6),e.k0s()),2&i&&(e.R7$(2),e.Y8G("ngIf",o.questionNumber),e.R7$(2),e.Y8G("contentBlocks",o.question.questionPrompt),e.R7$(),e.Y8G("ngSwitch",o.question.type),e.R7$(),e.Y8G("ngSwitchCase",o.QuestionType.MultipleChoice),e.R7$(),e.Y8G("ngSwitchCase",o.QuestionType.SelectAnatomy),e.R7$(),e.Y8G("ngSwitchCase",o.QuestionType.LabelAnatomy),e.R7$(),e.Y8G("ngIf",o.hasExplanation))},dependencies:[p.bT,p.ux,p.e1,Pi.l,Cl,yl,Ul],styles:[".answer[_ngcontent-%COMP%]{font-size:.875rem;line-height:1.25rem}.answer__prompt[_ngcontent-%COMP%]{display:flex;padding-bottom:16px}.answer__explanation[_ngcontent-%COMP%]{padding-top:32px}"],changeDetection:0})}return n})();var kl=l(60391),Gt=l(11756),ht=l(16823),zo=l(21626),Gl=l(28577),Vi=l(15877),gt=l(65776),Wl=l(44867);let Xl=(()=>{class n{constructor(t,i,o){this.http=t,this.markdownService=i,this.store=o}downloadResultsPDF(t="",i="",o="",s,a){return this.http.post("/ws/mc/pdf",this.getPDFHTML(t,i,o,s,a),{responseType:"arraybuffer",headers:new zo.Lr({"Content-Type":"text/html; charset=utf-8"})}).pipe((0,ve.T)(r=>{const u=new Blob([r],{type:"application/pdf"}),m=window.URL.createObjectURL(u),v=(o||"Quiz Results").replace(/ /g,"_").replace(/\W/g,"").toLowerCase(),R=document.createElement("a");return R.download=v,R.href=m,R.click(),!0}),(0,Gl.W)(()=>(0,Vi.of)(!1)))}getPDFHTML(t,i,o,s,a){return`\n    <html>\n      <head>\n        <meta charset="utf-8">\n        <style>\n\n          @media print {\n\n            html {\n              font-family: Arial;\n            }\n\n            body {\n              margin: 0;\n            }\n\n            ol {\n              list-style-position: inside;\n              padding-left: 0;\n            }\n\n            header {\n              position: running(header);\n              width: 100%;\n            }\n\n            header > div {\n              display: flex;\n              justify-content: space-between;\n            }\n\n            @page {\n              size: letter portrait;\n              margin: 1in;\n              \n              @top-center {\n                content: element(header);\n                width: 100%;\n              }\n\n              @bottom-center {\n                content: "Page " counter(page) " of " counter(pages);\n                font-size: 10px;\n              }\n            }\n\n          }\n          \n        </style>\n      </head>\n      <body style="font-size: 12px">\n\n        <header>\n          <div style="margin-bottom: .05in">\n            <div style="font-weight: 900">${t}</div>\n            <div style="text-align: right">\n                <span style="font-weight: 900">Score: </span>\n                <span>${a.correctTotal} out of ${a.scorableTotal}</span>\n            </div>\n          </div>\n\n          <div>\n            <div>${i}</div>\n            <div style="text-align: right">\n              <span style="font-weight: 900">Percentage: </span>\n              <span>${a.score}%</span>\n            </div>\n          </div>\n        </header>\n\n        \x3c!-- PDF CONTENT --\x3e\n\n        <div style="font-weight: 900; margin-bottom: .05in">${o}</div>\n        <div style="font-size: 10px">QUIZ RESULTS</div>\n\n        <br />\n\n        ${this.createPDFResponses(s,a)}\n        \n      </body>\n    </html>\n    `}createPDFResponses(t,i){const o=t.filter(u=>u.type!==ze.Q5.Instructions),s=this.markdownService.renderer.list,a=this.markdownService.renderer.listitem;this.markdownService.renderer.list=u=>u.replace(/,$/,""),this.markdownService.renderer.listitem=u=>` ${u},`;const r=o.map(u=>{const m=this.getNormalizedAnswer(i.questionAnswers[u.id]);return this.createPDFResponse(u,m)}).join("\n      <br />\n      <br />\n    ");return this.markdownService.renderer.list=s,this.markdownService.renderer.listitem=a,`\n      <ol>\n        ${r}\n      </ol>\n    `}getNormalizedAnswer(t){return typeof t>"u"?[]:"string"==typeof t?[t]:t}createPDFResponse(t,i){let o=this.convertContentBlockArray(t.questionPrompt);t.type===ze.Q5.SelectAnatomy&&t.data.showAnswerList&&(o=`${o} ${this.printAnatomyList(t.data.correctAnswer)}.`);const s=(0,Ri.Br)(t,i);return`\n      <li style="font-weight: 900">\n        ${o}\n        <div style="font-weight: 400; margin-top: .1in; margin-left: .2in; line-height: .2in;">\n          <img src="${(s?"correct":"incorrect")+".svg"}" />\n          <span style="font-weight: 900; margin-left: .05in; margin-right: .05in">${s?"Correct!":"Incorrect!"}</span>\n          ${this.getResponseText(t,i,s)}\n        </div>\n        <p style="font-weight: 400; font-style: italic; margin-bottom: 0">\n          ${this.convertContentBlockArray(t.explanation)}\n        </p>\n      </li>\n    `}getResponseText(t,i,o){let s="";switch(t.type){case ze.Q5.MultipleChoice:s=`You selected: ${this.getMultipleChoiceLabel(t,i[0])}.`,o||(s=`${s} The correct answer is: ${this.getMultipleChoiceLabel(t,t.data.correctAnswer)}.`);break;case ze.Q5.LabelAnatomy:s=`You labeled the anatomy ${o?"correctly":"incorrectly. The correct answer is"}: ${this.printLabelList(t)}.`;break;case ze.Q5.SelectAnatomy:o||(s=`You selected: ${this.printAnatomyList(i)}.`)}return s}printAnatomyList(t){const i=this.store.selectSnapshot(te.S.getViewGraph);return t.map(o=>(0,Wl.dV)(i,o)?.label).join(", ")}printLabelList(t){return t.data.correctAnswer.map((i,o)=>`${o+1}. ${t.data.options.find(a=>a.value===i).label.title}`).join(", ")}getMultipleChoiceLabel(t,i){return t.data.options.find(s=>s.value===i)?.label}convertContentBlockArray(t){return t.filter(i=>i.type===gt.m.Markdown).map(i=>{const o=this.markdownService.parse(i.markdown);return this.stripHTML(o)}).join("\n")}stripHTML(t){return(new DOMParser).parseFromString(t,"text/html").body.textContent||""}static#e=this.\u0275fac=function(i){return new(i||n)(e.KVO(zo.Qq),e.KVO(Y.Rl),e.KVO(c.il))};static#t=this.\u0275prov=e.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var Et=function(n,_,t,i){var a,o=arguments.length,s=o<3?_:null===i?i=Object.getOwnPropertyDescriptor(_,t):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(n,_,t,i);else for(var r=n.length-1;r>=0;r--)(a=n[r])&&(s=(o<3?a(s):o>3?a(_,t,s):a(_,t))||s);return o>3&&s&&Object.defineProperty(_,t,s),s},St=function(n,_){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(n,_)};function Fl(n,_){if(1&n&&(e.j41(0,"div",10)(1,"div",11),e.nrm(2,"app-progress-circle",12),e.j41(3,"div",13),e.pXf(4,0),e.k0s()()()),2&n){const t=e.XpG();e.R7$(2),e.Y8G("progress",null==t.quizScore?null:t.quizScore.score),e.R7$(2),e.uP7(null==t.quizScore?null:t.quizScore.correctTotal)(null==t.quizScore?null:t.quizScore.scorableTotal),e.nnv(4)}}function zl(n,_){if(1&n){const t=e.RV6();e.j41(0,"button",20),e.bIt("click",function(){e.eBV(t);const o=e.XpG(2);return e.Njj(o.handleResultsClick())}),e.nrm(1,"app-icon",21),e.qex(2),e.pXf(3,1),e.bVm(),e.k0s()}}function Bl(n,_){1&n&&(e.qex(0),e.pXf(1,2),e.bVm())}function jl(n,_){1&n&&(e.qex(0),e.pXf(1,3),e.bVm())}function Hl(n,_){if(1&n){const t=e.RV6();e.j41(0,"button",22),e.bIt("click",function(){e.eBV(t);const o=e.XpG(2);return e.Njj(o.handleToggleSummaryClick())}),e.DNE(1,Bl,2,0,"ng-container",23)(2,jl,2,0,"ng-container",23),e.k0s()}if(2&n){const t=e.XpG(2);e.R7$(),e.Y8G("ngIf",t.showExplanation),e.R7$(),e.Y8G("ngIf",!t.showExplanation)}}function Ql(n,_){if(1&n&&(e.j41(0,"div",26),e.nrm(1,"app-view-quiz-answer",27),e.k0s()),2&n){const t=_.$implicit,i=_.index,o=e.XpG(3);e.R7$(),e.Y8G("question",t)("questionNumber",i+1)("answer",null==o.quizScore?null:o.quizScore.questionAnswers[t.id])("summary",!0)}}function Yl(n,_){if(1&n&&(e.j41(0,"div",24),e.DNE(1,Ql,2,4,"div",25),e.k0s()),2&n){const t=e.XpG(2);e.R7$(),e.Y8G("ngForOf",t.questions)}}function ql(n,_){if(1&n){const t=e.RV6();e.j41(0,"button",28),e.bIt("click",function(){e.eBV(t);const o=e.XpG(2);return e.Njj(o.handleRestartClick())}),e.pXf(1,4),e.k0s()}}function Kl(n,_){if(1&n){const t=e.RV6();e.j41(0,"button",29),e.bIt("click",function(){e.eBV(t);const o=e.XpG(2);return e.Njj(o.handleExitClick())}),e.pXf(1,5),e.k0s()}}function Zl(n,_){if(1&n&&(e.j41(0,"div",14),e.DNE(1,zl,4,0,"button",15)(2,Hl,3,2,"button",16)(3,Yl,2,1,"div",17)(4,ql,2,0,"button",18),e.nI1(5,"async"),e.DNE(6,Kl,2,0,"button",19),e.nI1(7,"async"),e.k0s()),2&n){const t=e.XpG();e.R7$(),e.Y8G("ngIf",t.showSummaryEnabled&&t.showExplanationEnabled),e.R7$(),e.Y8G("ngIf",t.showSummaryEnabled&&t.showExplanationEnabled),e.R7$(),e.Y8G("ngIf",t.showExplanationEnabled&&t.showExplanation),e.R7$(),e.Y8G("ngIf",e.bMT(5,5,t.enableQuizRetake$)),e.R7$(2),e.Y8G("ngIf",!1===e.bMT(7,7,t.quizLocked$))}}function Jl(n,_){1&n&&(e.j41(0,"div",30),e.nrm(1,"app-spinner",31),e.k0s())}class Be{constructor(_,t,i,o){this.changeRef=_,this.quizService=t,this.quizPDFService=i,this.snackbar=o,this.questions=[],this.showSummaryEnabled=!1,this.showExplanationEnabled=!1,this.showExplanation=!1,this.loadingPDF=!1,this.ngUnsubscribe=new z.B,this.pdfInputs=new kl.m(1)}ngOnInit(){this.initReviewListeners()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete(),this.pdfInputs.complete()}initReviewListeners(){(0,de.z)([this.userFullName$,this.userEmail$,this.story$,this.questions$,this.submissions$]).pipe((0,g.Q)(this.ngUnsubscribe)).subscribe(([_,t,i,o,s])=>{this.questions=o,this.quizScore=(0,Ri.MH)(o,s),this.pdfInputs.next([_,t,i,o,this.quizScore]),this.changeRef.markForCheck()}),this.quizSettings$.pipe((0,g.Q)(this.ngUnsubscribe)).subscribe(({showSummary:_,showExplanation:t})=>{this.showSummaryEnabled=!1!==_,this.showExplanationEnabled=!1!==t,this.changeRef.markForCheck()})}handleToggleSummaryClick(){this.showExplanation=!this.showExplanation}handleResultsClick(){this.loadingPDF=!0,this.pdfInputs.pipe((0,pt.s)(1),(0,Gt.Z)(([_,t,i,o,s])=>this.quizPDFService.downloadResultsPDF(_,t,i.displayName.toUpperCase(),o,s)),(0,g.Q)(this.ngUnsubscribe)).subscribe(_=>{this.loadingPDF=!1,_||this.snackbar.open("Error opening the results PDF."),this.changeRef.markForCheck()})}handleRestartClick(){this.quizService.resetQuiz(),this.quizService.startQuiz()}handleExitClick(){this.quizService.exitQuiz()}static#e=this.\u0275fac=function(t){return new(t||Be)(e.rXU(e.gRc),e.rXU(Oi.k),e.rXU(Xl),e.rXU(Ii.UG))};static#t=this.\u0275cmp=e.VBU({type:Be,selectors:[["app-view-quiz-review"]],decls:4,vars:3,consts:()=>{let _,t,i,o,s,a;return _=$localize`:␟2bba53403aac78f4e44cdb7a38216c93a0a33ab7␟1432800600767014651: You answered ${"\ufffd0\ufffd"}:INTERPOLATION: of ${"\ufffd1\ufffd"}:INTERPOLATION_1: questions correctly. `,t=$localize`:␟f57ccc4608c3db5d46b9ebd75467a841f5e7599e␟1835089687895717278:Download Results as PDF`,i=$localize`:␟1f4dec9e6be75af098a539e0eedf41f86f2c8c38␟6268957596815378507:Hide Summary`,o=$localize`:␟96b2e76703c8dea4c7c173b97fff2a10f45c5907␟3866918107243977386:Show Summary`,s=$localize`:␟bf6eb666b88af02c4793aba88435a71da36ba5d2␟5529862952779485373: Take Again `,a=$localize`:␟19411ab6ff55d914e6f229a14e03ffc1127ffccf␟4002907482219878023: Exit Quiz `,[_,t,i,o,s,a,["data-test","quizReview",1,"review"],["class","review__container","data-test","quizDownload",4,"ngIf"],["class","flex flex-col gap-2",4,"ngIf"],["class","mt-10 review__loading",4,"ngIf"],["data-test","quizDownload",1,"review__container"],["data-test","quizSummary",1,"text-center"],["strokeWidth","12","diameter","96",3,"progress"],[1,"mt-5","mb-8","text-xs","font-semibold"],[1,"flex","flex-col","gap-2"],["class","w-full","app-view-button","","buttonSize","small","buttonShape","rounded","buttonTheme","light-gray-fill","data-test","quizGetResultsButton",3,"click",4,"ngIf"],["class","w-full","app-view-button","","buttonSize","small","buttonShape","rounded","buttonTheme","light-gray-fill","data-test","quizToggleSummaryButton",3,"click",4,"ngIf"],["class","mt-3 review__summary","data-test","quizExplanation",4,"ngIf"],["class","w-full mt-8","app-view-button","","buttonSize","small","buttonShape","rounded","buttonTheme","blue-fill","data-test","quizTakeAgainButton",3,"click",4,"ngIf"],["class","w-full mt-3","app-view-button","","buttonSize","small","buttonShape","rounded","buttonTheme","light-gray-fill","data-test","quizExitButton",3,"click",4,"ngIf"],["app-view-button","","buttonSize","small","buttonShape","rounded","buttonTheme","light-gray-fill","data-test","quizGetResultsButton",1,"w-full",3,"click"],["icon","download",1,"mr-1"],["app-view-button","","buttonSize","small","buttonShape","rounded","buttonTheme","light-gray-fill","data-test","quizToggleSummaryButton",1,"w-full",3,"click"],[4,"ngIf"],["data-test","quizExplanation",1,"mt-3","review__summary"],["class","my-6",4,"ngFor","ngForOf"],[1,"my-6"],[3,"question","questionNumber","answer","summary"],["app-view-button","","buttonSize","small","buttonShape","rounded","buttonTheme","blue-fill","data-test","quizTakeAgainButton",1,"w-full","mt-8",3,"click"],["app-view-button","","buttonSize","small","buttonShape","rounded","buttonTheme","light-gray-fill","data-test","quizExitButton",1,"w-full","mt-3",3,"click"],[1,"mt-10","review__loading"],["size","huge","direction","vertical","label","Loading"]]},template:function(t,i){1&t&&(e.j41(0,"div",6),e.DNE(1,Fl,5,3,"div",7)(2,Zl,8,9,"div",8)(3,Jl,2,0,"div",9),e.k0s()),2&t&&(e.R7$(),e.Y8G("ngIf",i.showSummaryEnabled),e.R7$(),e.Y8G("ngIf",!i.loadingPDF),e.R7$(),e.Y8G("ngIf",i.loadingPDF))},dependencies:[p.Sq,p.bT,P.ri,D.R,fn.tI,Jn,Fo,p.Jj],styles:[".review[_ngcontent-%COMP%]{position:relative}.review__summary[_ngcontent-%COMP%]{background-color:#f9fafd;padding:4px 12px}"],changeDetection:0})}Et([(0,c.l6)(w.j.getAllQuestions),St("design:type",d.c)],Be.prototype,"questions$",void 0),Et([(0,c.l6)(w.j.getAllSubmissions),St("design:type",d.c)],Be.prototype,"submissions$",void 0),Et([(0,c.l6)(w.j.getQuizSettings),St("design:type",d.c)],Be.prototype,"quizSettings$",void 0),Et([(0,c.l6)(w.j.getQuizModeLocked),St("design:type",d.c)],Be.prototype,"quizLocked$",void 0),Et([(0,c.l6)(w.j.getEnableQuizRetake),St("design:type",d.c)],Be.prototype,"enableQuizRetake$",void 0),Et([(0,c.l6)(ht.k.getUserProfile),St("design:type",d.c)],Be.prototype,"userProfile$",void 0),Et([(0,c.l6)(ht.k.getUserFullName),St("design:type",d.c)],Be.prototype,"userFullName$",void 0),Et([(0,c.l6)(ht.k.getUserEmail),St("design:type",d.c)],Be.prototype,"userEmail$",void 0),Et([(0,c.l6)(Ce.t.getStory),St("design:type",d.c)],Be.prototype,"story$",void 0);var et=function(n,_,t,i){var a,o=arguments.length,s=o<3?_:null===i?i=Object.getOwnPropertyDescriptor(_,t):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(n,_,t,i);else for(var r=n.length-1;r>=0;r--)(a=n[r])&&(s=(o<3?a(s):o>3?a(_,t,s):a(_,t))||s);return o>3&&s&&Object.defineProperty(_,t,s),s},tt=function(n,_){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(n,_)};const ec=(n,_)=>({"view-quiz--column":n,"view-quiz--drawer":_});function tc(n,_){if(1&n&&(e.nrm(0,"app-view-quiz-question",12),e.nI1(1,"async")),2&n){const t=e.XpG(2);e.Y8G("question",e.bMT(1,1,t.question$))}}function ic(n,_){if(1&n&&(e.j41(0,"div",17),e.EFF(1),e.nI1(2,"async"),e.k0s()),2&n){let t;const i=e.XpG(3);e.R7$(),e.SpI(" ",(null==(t=e.bMT(2,1,i.question$))?null:t.nextLabel)||i.defaultNextButtonNext," ")}}function nc(n,_){1&n&&(e.j41(0,"div",17),e.pXf(1,0),e.k0s())}function oc(n,_){if(1&n){const t=e.RV6();e.j41(0,"button",13),e.bIt("click",function(){e.eBV(t);const o=e.XpG(2);return e.Njj(o.handleSubmit())}),e.j41(1,"div",14),e.nI1(2,"async"),e.DNE(3,ic,3,3,"div",15)(4,nc,2,0,"div",16),e.k0s()()}if(2&n){let t;const i=e.XpG(2);e.Y8G("disabled",!i.form.valid),e.R7$(),e.Y8G("ngSwitch",null==(t=e.bMT(2,3,i.question$))?null:t.type),e.R7$(2),e.Y8G("ngSwitchCase",i.quizQuestionType.Instructions)}}function _c(n,_){if(1&n&&(e.j41(0,"div",8),e.DNE(1,tc,2,3,"app-view-quiz-question",9),e.nI1(2,"async"),e.j41(3,"div",10),e.DNE(4,oc,5,5,"button",11),e.nI1(5,"async"),e.nI1(6,"async"),e.k0s()()),2&n){let t;const i=e.XpG();e.Y8G("formGroup",i.form),e.R7$(),e.Y8G("ngIf",e.bMT(2,3,i.question$)),e.R7$(3),e.Y8G("ngIf",(null==(t=e.bMT(5,5,i.quizSettings$))?null:t.showSubmit)&&e.bMT(6,7,i.lifecycle$)===i.Lifecycle.Question)}}function sc(n,_){if(1&n){const t=e.RV6();e.j41(0,"button",22),e.bIt("click",function(){e.eBV(t);const o=e.XpG(2);return e.Njj(o.nextQuestion())}),e.j41(1,"div",17),e.EFF(2),e.nI1(3,"async"),e.k0s()()}if(2&n){let t;const i=e.XpG(2);e.R7$(2),e.JRh((null==(t=e.bMT(3,1,i.question$))?null:t.nextLabel)||i.defaultNextButtonNext)}}function ac(n,_){if(1&n){const t=e.RV6();e.j41(0,"button",24),e.bIt("click",function(){e.eBV(t);const o=e.XpG(3);return e.Njj(o.handleViewSummaryClick())}),e.PLo(1,1),e.nrm(2,"div",17),e.YFu(),e.k0s()}}function rc(n,_){if(1&n&&(e.qex(0),e.DNE(1,ac,3,0,"button",23),e.nI1(2,"async"),e.bVm()),2&n){const t=e.XpG(2);e.R7$(),e.Y8G("ngIf",e.bMT(2,1,t.quizReviewEnabled$))}}function lc(n,_){if(1&n&&(e.qex(0),e.j41(1,"div",18),e.nrm(2,"app-view-quiz-answer",19),e.nI1(3,"async"),e.nI1(4,"async"),e.k0s(),e.qex(5,14),e.nI1(6,"async"),e.j41(7,"div",10),e.DNE(8,sc,4,3,"button",20)(9,rc,3,3,"ng-container",21),e.k0s(),e.bVm()()),2&n){const t=e.XpG();e.R7$(2),e.Y8G("question",e.bMT(3,5,t.question$))("answer",e.bMT(4,7,t.submission$).answer)("summary",!1),e.R7$(3),e.Y8G("ngSwitch",e.bMT(6,9,t.hasQuestionsRemaining$)),e.R7$(3),e.Y8G("ngSwitchCase",!0)}}function cc(n,_){1&n&&(e.qex(0),e.nrm(1,"app-view-quiz-review"),e.bVm())}function dc(n,_){if(1&n&&(e.j41(0,"div",25),e.qex(1),e.pXf(2,2),e.nI1(3,"async"),e.bVm(),e.qex(4),e.pXf(5,3),e.bVm(),e.k0s()),2&n){let t;const i=e.XpG();e.R7$(3),e.uP7(null==(t=e.bMT(3,1,i.questions$))?null:t.length),e.nnv(2)}}class Pe{constructor(_,t,i,o,s,a){this.store=_,this.actions=t,this.formBuilder=i,this.viewService=o,this.applicationEventService=s,this.viewQuizService=a,this.defaultNextButtonNext=$localize`Next Question`,this.showHeader=!0,this.mode="column",this.Lifecycle=Ki.h,this.quizQuestionType=ze.Q5,this.sceneConfigStash={},this.ngUnsubscribe=new z.B}ngOnInit(){if(!this.store.selectSnapshot(w.j.getActiveQuestionId)){const _=this.store.selectSnapshot(w.j.getAllQuestions).at(0).id;this.store.dispatch(new It.B.SetActiveQuestion(_))}this.form=this.formBuilder.group({question:new Z.hs("",this.getQuizValidation())}),this.initQuestionObserver(),this.initAnswerObserver(),this.initEngineInteractionObserver(),this.applicationEventService.fireEvent(at.F.QuizEntered,!0)}ngOnDestroy(){Object.entries(this.sceneConfigStash).forEach(([_,t])=>{this.store.dispatch(new Wn.qi(_,t.background))}),this.applicationEventService.fireEvent(at.F.QuizExited,!0),this.viewService.selectTool(je.s.Select),this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}get answer(){const _=this.form.get("question").value;return Array.isArray(_)?_:[_]}initQuestionObserver(){this.question$.pipe((0,g.Q)(this.ngUnsubscribe),(0,M.p)(_=>void 0!==_)).subscribe(_=>{const t=this.store.selectSnapshot(b.N.getSelectedChapterId);_.chapterId!==t&&this.store.dispatch(new Wn.wg(_.chapterId)),this.form.reset(),this.setSceneConfig(_),_.type===ze.Q5.Instructions&&this.form.get("question").setValue("-"),this.applicationEventService.fireEvent(at.F.QuizQuestionLoaded,_)})}initAnswerObserver(){this.form.get("question").valueChanges.pipe((0,g.Q)(this.ngUnsubscribe)).subscribe(_=>{const t=this.store.selectSnapshot(w.j.getActiveQuestion),i=this.store.selectSnapshot(w.j.getActiveSubmission);void 0!==t&&(this.store.selectSnapshot(w.j.getAllSubmissions).some(o=>o.questionId===t.id)||((!i||!(0,V.isEqual)(i.answer,_))&&this.store.dispatch(new It.B.SetActiveSubmission({questionId:t.id,answer:_})),(0,V.isNil)(_)||this.applicationEventService.fireEvent(at.F.QuizAnswerSelected,{questionId:t.id,answerId:_})))})}initEngineInteractionObserver(){this.viewService.selectTool(je.s.Quiz),this.actions.pipe((0,c.xi)(Ae.zE),(0,M.p)(i=>{const{node:o,event:s}=i;return!(0,V.isNil)(o)&&this.store.selectSnapshot(te.S.getActiveTool)===je.s.Quiz&&!s.srcEvent.shiftKey})).pipe((0,M.p)(()=>"none"!==this.store.selectSnapshot(w.j.getPickMode)),(0,g.Q)(this.ngUnsubscribe)).subscribe(i=>{"single"===this.store.selectSnapshot(w.j.getPickMode)&&this.viewService.clearSelectedNodes();const s=(0,V.get)(i,"hit.objectId");if(s){const r=this.store.selectSnapshot(xt.z.getCheckedNodeIds).includes(s);this.store.dispatch(new dt.q9(!r,[s]))}}),this.question$.pipe((0,J.F)((i,o)=>(0,V.get)(i,"id")===(0,V.get)(o,"id")),(0,M.p)(i=>!(0,V.isNil)(i))).pipe((0,g.Q)(this.ngUnsubscribe)).subscribe(i=>this.setQuestionPickMode(i))}setQuestionPickMode(_){const{type:t,data:i}=_;let o;o=t===ze.Q5.SelectAnatomy?i.correctAnswer.length>1&&"any"!==i.selectType?"multi":"single":"none",this.store.dispatch(new It.B.SetQuizPickMode(o))}handleSubmit(){const _=this.store.selectSnapshot(w.j.getActiveQuestion);(this.form.valid||_.type===ze.Q5.Instructions)&&this.viewQuizService.submitQuestion(_.id,this.answer)}handleViewSummaryClick(){this.viewSummary()}handleExitClick(){this.viewQuizService.exitQuiz()}nextQuestion(){this.viewQuizService.nextQuestion()}viewSummary(){this.store.dispatch(new It.B.SetQuizLifecycle(Ki.h.Review)),this.applicationEventService.fireEvent(at.F.QuizCompleted,!0)}setSceneConfig(_){const{camera:t,background:i}=_?.sceneConfig||{},o=this.store.selectSnapshot(b.N.getChapter(_.chapterId));t&&(this.setStash(_.chapterId,{camera:o.camera.location}),setTimeout(()=>{this.store.dispatch(new hn.Ih(t.location,!0,1))})),i&&(this.setStash(_.chapterId,{background:o.background}),this.store.dispatch(new Wn.qi(_.chapterId,i)))}setStash(_,t){this.sceneConfigStash[_]={...this.sceneConfigStash[_]||{},...t}}getQuizValidation(){return _=>{const t=_.value,i=Array.isArray(t)?t:[t],o=this.store.selectSnapshot(w.j.getActiveQuestion),s=(0,Ri.Ie)(o),a=i.some(r=>(0,V.isNil)(r)||""===r);return s&&a?{invalidValues:a}:null}}static#e=this.\u0275fac=function(t){return new(t||Pe)(e.rXU(c.il),e.rXU(c.En),e.rXU(Z.ze),e.rXU(F.z),e.rXU(Gn.S),e.rXU(Oi.k))};static#t=this.\u0275cmp=e.VBU({type:Pe,selectors:[["app-view-quiz"]],inputs:{showHeader:"showHeader",mode:"mode"},decls:12,vars:22,consts:()=>{let _,t,i,o;return _=$localize`:␟71c77bb8cecdf11ec3eead24dd1ba506573fa9cd␟935187492052582731:Submit`,t=$localize`:␟19c0d80cbbbe6ab7d75dbe7c77ef3017ec5f4d96␟7886851004377486562:${"\ufffd#2\ufffd"}:START_TAG_DIV:See Results${"\ufffd/#2\ufffd"}:CLOSE_TAG_DIV:`,i=$localize`:␟6649c9f6c298747891fb175dbe382be60e1728c6␟6638623222432926474:{VAR_PLURAL, plural, =1 {Answer} other {Answers}}`,i=e.k04(i,{VAR_PLURAL:"\ufffd0\ufffd"}),o=$localize`:␟ceb65fed78c2ea1d81ce1514a244608fdc02bfca␟1766523863374888036:submitted`,[_,t,i,o,["data-test","quiz",1,"view-quiz",3,"ngClass"],["role","form","class","flex flex-col",3,"formGroup",4,"ngIf"],[4,"ngIf"],["class","text-base font-bold text-center",4,"ngIf"],["role","form",1,"flex","flex-col",3,"formGroup"],["formControlName","question",3,"question",4,"ngIf"],[1,"flex","flex-row-reverse"],["app-view-button","","class","view-quiz__button","buttonTheme","blue-fill","buttonSize","small","buttonShape","rounded","data-test","questionSubmit",3,"disabled","click",4,"ngIf"],["formControlName","question",3,"question"],["app-view-button","","buttonTheme","blue-fill","buttonSize","small","buttonShape","rounded","data-test","questionSubmit",1,"view-quiz__button",3,"click","disabled"],[3,"ngSwitch"],["class","px-4",4,"ngSwitchCase"],["class","px-4",4,"ngSwitchDefault"],[1,"px-4"],[1,"mb-8"],[3,"question","answer","summary"],["app-view-button","","buttonTheme","blue-fill","buttonSize","small","buttonShape","rounded","class","view-quiz__button","data-test","questionNextButton",3,"click",4,"ngSwitchCase"],[4,"ngSwitchDefault"],["app-view-button","","buttonTheme","blue-fill","buttonSize","small","buttonShape","rounded","data-test","questionNextButton",1,"view-quiz__button",3,"click"],["data-test","quizViewSummaryButton","app-view-button","","buttonTheme","blue-fill","buttonSize","small","buttonShape","rounded","class","view-quiz__button",3,"click",4,"ngIf"],["data-test","quizViewSummaryButton","app-view-button","","buttonTheme","blue-fill","buttonSize","small","buttonShape","rounded",1,"view-quiz__button",3,"click"],[1,"text-base","font-bold","text-center"]]},template:function(t,i){if(1&t&&(e.j41(0,"div",4),e.DNE(1,_c,7,9,"div",5),e.nI1(2,"async"),e.DNE(3,lc,10,11,"ng-container",6),e.nI1(4,"async"),e.DNE(5,cc,2,0,"ng-container",6),e.nI1(6,"async"),e.nI1(7,"async"),e.DNE(8,dc,6,3,"div",7),e.nI1(9,"async"),e.nI1(10,"async"),e.nI1(11,"async"),e.k0s()),2&t){let o;e.Y8G("ngClass",e.l_i(19,ec,"column"===i.mode,"drawer"===i.mode)),e.R7$(),e.Y8G("ngIf",e.bMT(2,5,i.lifecycle$)===i.Lifecycle.Question),e.R7$(2),e.Y8G("ngIf",e.bMT(4,7,i.lifecycle$)===i.Lifecycle.Explanation),e.R7$(2),e.Y8G("ngIf",e.bMT(6,9,i.lifecycle$)===i.Lifecycle.Review&&e.bMT(7,11,i.quizReviewEnabled$)),e.R7$(3),e.Y8G("ngIf",!(e.bMT(9,13,i.hasQuestionsRemaining$)||e.bMT(10,15,i.quizReviewEnabled$)||null!=(o=e.bMT(11,17,i.quizSettings$))&&o.showExplanation))}},dependencies:[p.YU,p.bT,p.ux,p.e1,p.fG,P.ri,Z.BC,Z.cb,Z.j4,Z.JD,kt,Fo,Be,p.Jj],styles:[".view-quiz[_ngcontent-%COMP%]{color:#374a68}.view-quiz__button[_ngcontent-%COMP%]:disabled{opacity:.5}.view-quiz--column[_ngcontent-%COMP%]   .view-quiz__button[_ngcontent-%COMP%]{width:100%}"],changeDetection:0})}et([(0,c.l6)(w.j.getQuizReviewEnabled),tt("design:type",d.c)],Pe.prototype,"quizReviewEnabled$",void 0),et([(0,c.l6)(w.j.getActiveQuestion),tt("design:type",d.c)],Pe.prototype,"question$",void 0),et([(0,c.l6)(w.j.getAllQuestions),tt("design:type",d.c)],Pe.prototype,"questions$",void 0),et([(0,c.l6)(w.j.getActiveQuestionIndex),tt("design:type",d.c)],Pe.prototype,"questionIndex$",void 0),et([(0,c.l6)(w.j.getQuestionTotal),tt("design:type",d.c)],Pe.prototype,"questionTotal$",void 0),et([(0,c.l6)(w.j.getCorrectAnswerTotal),tt("design:type",d.c)],Pe.prototype,"correctAnswerTotal$",void 0),et([(0,c.l6)(w.j.hasQuestionRemaining),tt("design:type",d.c)],Pe.prototype,"hasQuestionsRemaining$",void 0),et([(0,c.l6)(w.j.getQuizSettings),tt("design:type",d.c)],Pe.prototype,"quizSettings$",void 0),et([(0,c.l6)(w.j.getLifecycle),tt("design:type",d.c)],Pe.prototype,"lifecycle$",void 0),et([(0,c.l6)(w.j.getQuizModeLocked),tt("design:type",d.c)],Pe.prototype,"quizLocked$",void 0),et([(0,c.l6)(w.j.getActiveSubmission),tt("design:type",d.c)],Pe.prototype,"submission$",void 0);let Bo=(()=>{class n{constructor(t){this.el=t,this.appScrollListener=(0,e.geq)()}ngOnInit(){this.el.nativeElement.addEventListener("scroll",()=>{this.emitScroll()})}ngOnDestroy(){this.el.nativeElement.removeEventListener("scroll",this.emitScroll)}emitScroll(){this.appScrollListener.set(this.el.nativeElement.scrollTop)}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(e.aKT))};static#t=this.\u0275dir=e.FsC({type:n,selectors:[["","appScrollListener",""]],inputs:{appScrollListener:[1,"appScrollListener"]},outputs:{appScrollListener:"appScrollListenerChange"}})}return n})();const hc=n=>({"!border-gray-200":n}),gc=n=>({"!outline-blue-600":n}),Ec=(n,_)=>({"!bg-gray-200":n,"!bg-blue-600 !text-white !outline-blue-600":_}),Sc=n=>({"!opacity-100":n});function mc(n,_){1&n&&e.nrm(0,"div",12)}function fc(n,_){1&n&&e.nrm(0,"div",13)}function Tc(n,_){if(1&n){const t=e.RV6();e.j41(0,"li",6)(1,"button",7),e.bIt("click",function(){const o=e.eBV(t).$implicit,s=e.XpG();return e.Njj(s.handleChapterClick(o))}),e.j41(2,"span",8),e.EFF(3),e.k0s(),e.j41(4,"div",9)(5,"div",10),e.EFF(6),e.k0s(),e.nrm(7,"app-chapter-image",11),e.k0s(),e.DNE(8,mc,1,0,"div",12)(9,fc,1,0,"div",13),e.k0s()()}if(2&n){const t=_.$implicit,i=_.$index,o=_.$index,s=_.$count,a=e.XpG();e.R7$(),e.Y8G("matTooltip",a.getTooltip(i,t)),e.BMQ("aria-current",a.selectedChapterIndex()===i)("data-id",t.id),e.R7$(2),e.JRh(t.displayName),e.R7$(),e.Y8G("ngClass",e.eq3(11,gc,i===a.selectedChapterIndex())),e.R7$(),e.Y8G("ngClass",e.l_i(13,Ec,i<a.selectedChapterIndex(),a.selectedChapterIndex()===i)),e.R7$(),e.SpI(" ",i+1," "),e.R7$(),e.Y8G("chapterId",t.id)("ngClass",e.eq3(16,Sc,i<=a.selectedChapterIndex())),e.R7$(),e.vxM(0!==o?8:-1),e.R7$(),e.vxM(o!==s-1?9:-1)}}class Di{constructor(_,t){this.viewService=_,this.store=t,this.chapters=(0,h.ot)(this.store.select(b.N.getStoryChapters)),this.selectedChapterIndex=(0,h.ot)(this.store.select(b.N.getSelectedChapterIndex)),this.scrollTop=0,(0,e.QZP)(()=>{this.scrollChapterIntoView(this.selectedChapterIndex())})}getTooltip(_,t){return $localize`${_+1} of ${this.chapters().length}\: ${t.displayName}`}handleChapterClick(_){this.viewService.selectChapter(_)}handleNextChapter(){this.viewService.nextChapter("Pagination")}handlePreviousChapter(){this.viewService.previousChapter("Pagination")}scrollChapterIntoView(_){const t=document.querySelector(`[data-test="viewChapterThumbnail"]:nth-child(${_+1})`);null!=t&&setTimeout(()=>{t.scrollIntoView({block:"nearest"})})}static#e=this.\u0275fac=function(t){return new(t||Di)(e.rXU(F.z),e.rXU(c.il))};static#t=this.\u0275cmp=e.VBU({type:Di,selectors:[["app-view-chapter-list"]],decls:8,vars:5,consts:()=>{let _,t;return _=$localize`:␟d34ec3fa65cd79fae0796d2e789e6217f0cc0a48␟5014509299839865224:Chapter list`,t=$localize`:␟2be2e0ec21a9620412d9a21102e7645fce9d9cc1␟5659091765954160016:List of Chapters`,[["data-test","viewChapterList",1,"flex","flex-col","h-full"],[1,"flex","items-center","justify-center","flex-grow-0","py-5","transition-colors","border-b","border-transparent","border-solid","bg-gray-50",3,"ngClass"],[1,"shadow"],["buttonSize","2xsmall",3,"showCount"],["aria-label",_,1,"flex-grow","overflow-x-hidden","overflow-y-auto","scroll-smooth"],["aria-label",t,3,"appScrollListenerChange","appScrollListener"],["data-test","viewChapterThumbnail"],["matTooltipPosition","right","data-test","viewChapterListButton",1,"relative","flex","flex-col","items-center","justify-center","w-full","py-2","cursor-pointer","group","min-h-20","focus:outline-none",3,"click","matTooltip"],[1,"sr-only"],[1,"absolute","z-10","transition-all","bg-white","border-2","border-white","border-solid","rounded","w-14","h-14","outline","outline-2","outline-gray-200","group-hover:outline-gray-300","group-focus:outline-blue-600",3,"ngClass"],[1,"absolute","top-0","left-0","z-20","flex","items-center","justify-center","w-6","h-6","font-semibold","text-gray-600","transition-all","-translate-x-[15px]","-translate-y-[15px]","bg-white","border","border-2","border-white","border-solid","rounded","rounded-full","outline","outline-2","-outline-offset-4","outline-gray-200","group-hover:outline-gray-300","group-focus:outline-blue-600","text-2xs",3,"ngClass"],[1,"overflow-hidden","transition-opacity","rounded","opacity-50","group-hover:opacity-100","group-focus:opacity-100",3,"chapterId","ngClass"],[1,"w-[2px]","h-1/2","bg-gray-200","absolute","z-0","top-0"],[1,"w-[2px]","h-1/2","bg-gray-200","absolute","z-0","bottom-0"]]},template:function(t,i){1&t&&(e.j41(0,"div",0)(1,"div",1)(2,"app-pillbox",2),e.nrm(3,"app-view-pagination",3),e.k0s()(),e.j41(4,"nav",4)(5,"ol",5),e.mxI("appScrollListenerChange",function(s){return e.DH7(i.scrollTop,s)||(i.scrollTop=s),s}),e.Z7z(6,Tc,10,18,"li",6,e.Vm6),e.k0s()()()),2&t&&(e.R7$(),e.Y8G("ngClass",e.eq3(3,hc,i.scrollTop>0)),e.R7$(2),e.Y8G("showCount",!1),e.R7$(2),e.R50("appScrollListener",i.scrollTop),e.R7$(),e.Dyx(i.chapters()))},dependencies:[p.YU,Bo,j.oV,Ze.O,ii,Ke],changeDetection:0})}!function(n,_,t,i){var a,o=arguments.length,s=o<3?_:null===i?i=Object.getOwnPropertyDescriptor(_,t):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(n,_,t,i);else for(var r=n.length-1;r>=0;r--)(a=n[r])&&(s=(o<3?a(s):o>3?a(_,t,s):a(_,t))||s);o>3&&s&&Object.defineProperty(_,t,s)}([(0,c.l6)(b.N.getSelectedChapterId),function(n,_){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata("design:type",_)}(0,d.c)],Di.prototype,"selectedChapterId$",void 0);var bc=l(91003),jo=l(32914);function vc(n,_){if(1&n){const t=e.RV6();e.qex(0),e.j41(1,"button",5),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.handlePlayFromBeginning())}),e.nrm(2,"app-icon",6),e.j41(3,"span",7),e.pXf(4,1),e.k0s()(),e.nrm(5,"app-view-audio-mute",8),e.bVm()}}function Oc(n,_){1&n&&(e.j41(0,"button",9)(1,"div",10),e.nrm(2,"app-spinner",11),e.j41(3,"span",7),e.pXf(4,2),e.k0s()()()),2&n&&e.Y8G("disabled",!0)}let Cc=(()=>{class n{constructor(t,i,o,s){this.viewService=t,this.mediaService=i,this.store=o,this.changeDetectorRef=s,this.hasAudioPlayer=!1,this.ngUnsubscribe=new z.B}ngOnInit(){this.initChapterPlayer()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initChapterPlayer(){this.store.select(b.N.getSelectedChapter).pipe((0,Co.M)(()=>{this.hasAudioPlayer=!1,this.changeDetectorRef.markForCheck()}),(0,jo.n)(t=>{const i=this.store.selectSnapshot(f.Pf.getViewLanguage),o=this.store.selectSnapshot(f.Pf.getForceAudio);return this.mediaService.getChapterAudioPlayer(t,i,o)}),(0,g.Q)(this.ngUnsubscribe)).subscribe(t=>{this.hasAudioPlayer=!(0,V.isNil)(t),this.changeDetectorRef.markForCheck()})}handlePlayFromBeginning(){const t=this.store.selectSnapshot(b.N.getSelectedChapterId);this.mediaService.playChapterAudio(t),this.viewService.playChapterFromStart()}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(F.z),e.rXU(We.u),e.rXU(c.il),e.rXU(e.gRc))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-view-audio-bar"]],decls:4,vars:2,consts:()=>{let t,i,o;return t=$localize`:␟5006279573e513c000899122cbef8e588b25faae␟2965090484617938475:play from beginning`,i=$localize`:␟81e8d1fd604d4f4e83ad3300e500ae3b35aa4be7␟1494613406887362546:Play From Beginning`,o=$localize`:␟65026328a38cc4b6451777987b5dee29a779a10f␟3235113974618934655:Loading Audio`,[["loading",""],i,o,[1,"view-audio-bar"],[4,"ngIf","ngIfElse"],["type","button","app-view-button","","buttonSize","small","buttonShape","rounded","buttonTheme","light-gray-outline","aria-label",t,"data-test","viewPlayFromBeginning",1,"view-audio-bar__play",3,"click"],["icon","rotate-left","aria-hidden","true"],[1,"ml-2","uppercase","text-2xs"],["buttonSize","small","buttonShape","rounded","buttonTheme","light-gray-outline"],["type","button","app-view-button","","buttonSize","small","buttonShape","rounded","buttonTheme","light-gray-outline",1,"view-audio-bar__play",3,"disabled"],[1,"flex","justify-center","items-center"],["spinnerSize","small"]]},template:function(i,o){if(1&i&&(e.j41(0,"div",3),e.DNE(1,vc,6,0,"ng-container",4)(2,Oc,5,1,"ng-template",null,0,e.C5r),e.k0s()),2&i){const s=e.sdS(3);e.R7$(),e.Y8G("ngIf",o.hasAudioPlayer)("ngIfElse",s)}},dependencies:[p.bT,P.ri,D.R,fn.tI,ci],styles:[".view-audio-bar[_ngcontent-%COMP%]{display:flex;gap:12px}.view-audio-bar__play[_ngcontent-%COMP%]{flex-grow:1}"],changeDetection:0})}return n})();var Ic=l(24151),Mc=l(79817),wc=l(26513),Ho=function(n,_,t,i){var a,o=arguments.length,s=o<3?_:null===i?i=Object.getOwnPropertyDescriptor(_,t):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(n,_,t,i);else for(var r=n.length-1;r>=0;r--)(a=n[r])&&(s=(o<3?a(s):o>3?a(_,t,s):a(_,t))||s);return o>3&&s&&Object.defineProperty(_,t,s),s},Qo=function(n,_){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(n,_)};const Ac=n=>({"view-labels__item--selected":n}),yc=n=>({"view-labels__content--shown":n});function Nc(n,_){if(1&n&&(e.j41(0,"div",11),e.nrm(1,"div",12),e.nI1(2,"markdown"),e.nI1(3,"async"),e.k0s()),2&n){const t=e.XpG().$implicit;e.R7$(),e.Y8G("innerHTML",e.bMT(3,3,e.bMT(2,1,t.title)),e.npT)}}function Rc(n,_){if(1&n&&(e.j41(0,"div",13)(1,"div",14),e.nrm(2,"app-icon",15),e.nI1(3,"async"),e.k0s()()),2&n){let t;const i=e.XpG().$implicit,o=e.XpG();e.R7$(2),e.Y8G("ngClass",(null==(t=e.bMT(3,1,o.selectedLabel$))?null:t.id)===i.id?"rotate-90":"rotate-0")}}function Pc(n,_){if(1&n&&(e.j41(0,"div",19),e.nrm(1,"app-content-blocks",20),e.k0s()),2&n){const t=e.XpG(2).$implicit;e.R7$(),e.Y8G("contentBlocks",t.contentBlocks)}}function Uc(n,_){if(1&n&&(e.j41(0,"div",16),e.nI1(1,"async"),e.nI1(2,"async"),e.nrm(3,"app-html",17),e.DNE(4,Pc,2,1,"div",18),e.k0s()),2&n){let t,i;const o=e.XpG(),s=o.$implicit,a=o.index,r=e.XpG();e.Y8G("ngClass",e.eq3(9,yc,(null==(t=e.bMT(1,5,r.selectedLabel$))?null:t.id)===s.id)),e.BMQ("aria-hidden",(null==(i=e.bMT(2,7,r.selectedLabel$))?null:i.id)!==s.id)("id","content-"+a),e.R7$(3),e.Y8G("markdownText",s.description),e.R7$(),e.Y8G("ngIf",(null==s.contentBlocks?null:s.contentBlocks.length)>0)}}function Vc(n,_){if(1&n){const t=e.RV6();e.j41(0,"li",3)(1,"button",4),e.nI1(2,"async"),e.nI1(3,"async"),e.nI1(4,"async"),e.bIt("click",function(){const o=e.eBV(t).$implicit,s=e.XpG();return e.Njj(s.handleLabelClick(o))}),e.j41(5,"span",5),e.pXf(6,0),e.k0s(),e.j41(7,"div",6),e.nrm(8,"app-label-pin",7),e.nI1(9,"async"),e.k0s(),e.DNE(10,Nc,4,5,"div",8)(11,Rc,4,3,"div",9),e.k0s(),e.DNE(12,Uc,5,11,"div",10),e.k0s()}if(2&n){let t,i,o,s;const a=_.$implicit,r=_.index,u=e.XpG();e.R7$(),e.Y8G("ngClass",e.eq3(23,Ac,(null==(t=e.bMT(2,15,u.selectedLabel$))?null:t.id)===a.id)),e.BMQ("aria-current",(null==(i=e.bMT(3,17,u.selectedLabel$))?null:i.id)===a.id)("aria-controls","label-list-content-"+r)("aria-expanded",(null==(o=e.bMT(4,19,u.selectedLabel$))?null:o.id)===a.id)("id","label-list-item-"+r),e.R7$(7),e.Y8G("showOnNone",!0)("selected",(null==(s=e.bMT(9,21,u.selectedLabel$))?null:s.id)===a.id)("pinType",a.pinType)("labelTheme",a.theme)("sequence",u.getLabelSequence(a))("foregroundColor",null==a.themeStyles?null:a.themeStyles.pinForegroundColor)("backgroundColor",null==a.themeStyles?null:a.themeStyles.pinBackgroundColor),e.R7$(2),e.Y8G("ngIf",a.title),e.R7$(),e.Y8G("ngIf",a.description||(null==a.contentBlocks?null:a.contentBlocks.length)>0),e.R7$(),e.Y8G("ngIf",a.description||(null==a.contentBlocks?null:a.contentBlocks.length)>0)}}class di{constructor(_,t){this.viewService=_,this.store=t,this.labelPinType=Ic.O,this.labelSequentialtype=Mc.C}ngOnInit(){}getLabelSequence(_){return this.store.selectSnapshot(Fe.y.getLabelSequence(_))}handleLabelClick(_){const t=this.store.selectSnapshot(Fe.y.getSelectedLabel);_.id===t?.id?this.viewService.clearSelectedLabel():this.viewService.selectLabel(_,!0)}static#e=this.\u0275fac=function(t){return new(t||di)(e.rXU(F.z),e.rXU(c.il))};static#t=this.\u0275cmp=e.VBU({type:di,selectors:[["app-view-labels"]],decls:3,vars:3,consts:()=>{let _;return _=$localize`:␟e788aaf840ca6aea39b81480b735057823a73b53␟2641792472434523020:Navigate to description for, `,[_,["data-test","viewLabelList",1,"view-labels"],["data-test","viewLabelListItem","class","view-labels__list-item",4,"ngFor","ngForOf"],["data-test","viewLabelListItem",1,"view-labels__list-item"],["data-test","viewLabelListButton",1,"view-labels__item",3,"click","ngClass"],[1,"sr-only"],[1,"view-labels__pin"],[1,"flex",3,"showOnNone","selected","pinType","labelTheme","sequence","foregroundColor","backgroundColor"],["class","view-labels__body",4,"ngIf"],["class","view-labels__expand","data-test","viewLabelsToggle",4,"ngIf"],["class","view-labels__content","data-test","viewLabelListContent",3,"ngClass",4,"ngIf"],[1,"view-labels__body"],[1,"view-labels__title","html",3,"innerHTML"],["data-test","viewLabelsToggle",1,"view-labels__expand"],["aria-hidden","true",1,"px-3"],["icon","angle-right",1,"transition-transform",3,"ngClass"],["data-test","viewLabelListContent",1,"view-labels__content",3,"ngClass"],["data-test","viewLabelListHtml",3,"markdownText"],["data-test","viewLabelListBlocks",4,"ngIf"],["data-test","viewLabelListBlocks"],[3,"contentBlocks"]]},template:function(t,i){1&t&&(e.j41(0,"ul",1),e.DNE(1,Vc,13,25,"li",2),e.nI1(2,"async"),e.k0s()),2&t&&(e.R7$(),e.Y8G("ngForOf",e.bMT(2,1,i.labels$)))},dependencies:[p.YU,p.Sq,p.bT,Pi.l,D.R,an.V,wc.b,Y.i0,p.Jj],styles:[".view-labels__list-item{padding-bottom:8px}.view-labels__item{background:none;border:0;display:flex;padding:12px 0 12px 16px;cursor:pointer;transition:background-color 125ms,color 125ms,border 125ms;width:100%;gap:12px;text-align:left;align-items:center}.view-labels__item:focus{outline:#2d72dc solid 2px!important}.view-labels__item:hover,.view-labels__item--selected:hover{background-color:#131c2a0d}.view-labels__item--selected .view-labels__title{font-weight:600}.view-labels__pin{display:flex;align-items:center;justify-content:center;flex:0 0 18px;height:18px}.view-labels__body{flex:1 1 auto}.view-labels__expand{flex-grow:0;display:flex;justify-content:center;align-items:center;position:relative;font-size:14px}.view-labels__title{color:#131c2a;font-size:.875rem;line-height:1.25rem}.view-labels__label{position:absolute;font-size:10px;top:3px}.view-labels__content{display:none;padding:8px 0 12px 46px;font-size:.875rem;line-height:1.25rem;overflow-wrap:break-word;color:#374a68}.view-labels__content--shown{display:block}\n"],encapsulation:2,changeDetection:0})}Ho([(0,c.l6)(Fe.y.getChapterLabels),Qo("design:type",d.c)],di.prototype,"labels$",void 0),Ho([(0,c.l6)(Fe.y.getSelectedLabel),Qo("design:type",d.c)],di.prototype,"selectedLabel$",void 0);var Dc=l(11789);function Lc(n,_){if(1&n&&(e.j41(0,"div",6),e.EFF(1),e.k0s()),2&n){const t=e.XpG().$implicit;e.R7$(),e.JRh(t.description)}}function xc(n,_){if(1&n&&(e.j41(0,"li",2),e.nrm(1,"div",3),e.j41(2,"div",4)(3,"div"),e.EFF(4),e.k0s(),e.DNE(5,Lc,2,1,"div",5),e.k0s()()),2&n){const t=_.$implicit,i=e.XpG();e.R7$(),e.xc7("background-color",i.getComputedColor(t.colors)),e.R7$(3),e.JRh(t.label),e.R7$(),e.Y8G("ngIf",t.description)}}let $c=(()=>{class n{constructor(){}ngOnInit(){}getComputedColor(t){return Dc.T.rgbToHex(t,!0)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-view-legend"]],inputs:{legend:"legend"},decls:2,vars:1,consts:()=>{let t;return t=$localize`:␟5c5419db944ed6a96f9515a2ac0ee390ec8cf3b5␟7297822327994766046:Legend`,[["aria-label",t,1,"view-legend"],["class","view-legend__item",4,"ngFor","ngForOf"],[1,"view-legend__item"],[1,"view-legend__color"],[1,"text-sm","view-legend__content"],["class","my-2",4,"ngIf"],[1,"my-2"]]},template:function(i,o){1&i&&(e.j41(0,"ul",0),e.DNE(1,xc,6,4,"li",1),e.k0s()),2&i&&(e.R7$(),e.Y8G("ngForOf",o.legend))},dependencies:[p.Sq,p.bT],styles:['.view-legend{display:flex;flex-direction:column}.view-legend__item{padding:12px 12px 12px 16px;display:flex;gap:12px;flex-direction:row;justify-content:flex-start;align-items:flex-start}.view-legend__content{word-break:break-word;display:flex;flex-direction:column}.view-legend__color{border:2px solid white;outline:1px solid #96a8c0;content:" ";display:block;flex:0 0 18px;width:18px;height:18px;border-radius:50%}.view-legend__color:after{content:" "}\n'],encapsulation:2,changeDetection:0})}return n})();const kc=["*"];function Gc(n,_){if(1&n){const t=e.RV6();e.j41(0,"h2",0)(1,"button",2),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.togglePanel())}),e.j41(2,"div",3)(3,"span",4),e.EFF(4),e.k0s(),e.j41(5,"div",5),e.nrm(6,"app-icon",6),e.k0s()()()()}if(2&n){const t=e.XpG();e.R7$(),e.BMQ("aria-expanded",t.open())("aria-controls",t.panelId()),e.R7$(3),e.JRh(t.label()),e.R7$(2),e.Y8G("ngClass",t.open()?"rotate-90":"rotate-0")}}let Wc=(()=>{class n{constructor(t){this.store=t,this.panelId=e.hFB.required(),this.label=(0,e.hFB)(""),this.showHeader=(0,e.hFB)(!0),this.canToggle=(0,e.hFB)(!0),this.open=(0,e.geq)(!1)}togglePanel(){const t=!this.open();this.open.set(t),this.store.dispatch(new Q.B.TogglePanel(this.panelId(),t))}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(c.il))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-view-panel"]],inputs:{panelId:[1,"panelId"],label:[1,"label"],showHeader:[1,"showHeader"],canToggle:[1,"canToggle"],open:[1,"open"]},outputs:{open:"openChange"},ngContentSelectors:kc,decls:3,vars:3,consts:[[1,"-ml-1","text-sm","font-semibold"],[1,"transition-all",3,"id","ngClass"],["app-view-button","","buttonShape","rounded",1,"flex-grow","w-full","rounded","min-h-11",3,"click"],[1,"flex","justify-between","text-gray-900"],[1,"pl-1"],["aria-hidden","true",1,"px-3"],["icon","angle-right",1,"transition-transform",3,"ngClass"]],template:function(i,o){1&i&&(e.NAR(),e.DNE(0,Gc,7,4,"h2",0),e.j41(1,"div",1),e.SdG(2),e.k0s()),2&i&&(e.vxM(o.showHeader()?0:-1),e.R7$(),e.Y8G("id",o.panelId())("ngClass",o.open()?"pb-6":"h-0 overflow-hidden"))},dependencies:[P.ri,p.YU,D.R],styles:["[_nghost-%COMP%]{display:block}"],changeDetection:0})}return n})();var Fn=function(n,_,t,i){var a,o=arguments.length,s=o<3?_:null===i?i=Object.getOwnPropertyDescriptor(_,t):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(n,_,t,i);else for(var r=n.length-1;r>=0;r--)(a=n[r])&&(s=(o<3?a(s):o>3?a(_,t,s):a(_,t))||s);return o>3&&s&&Object.defineProperty(_,t,s),s},zn=function(n,_){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(n,_)};function Xc(n,_){1&n&&e.nrm(0,"app-view-source-info",1),2&n&&e.Y8G("toggleable",!0)}function Fc(n,_){1&n&&e.nrm(0,"app-view-audio-bar",6)}function zc(n,_){if(1&n&&(e.j41(0,"div"),e.nrm(1,"app-content-blocks",10),e.k0s()),2&n){const t=e.XpG(2);e.R7$(),e.Y8G("contentBlocks",t.tickerBlocks())("include",t.contentBlockTypes.Ticker)}}function Bc(n,_){if(1&n&&(e.j41(0,"div",9),e.nrm(1,"app-content-blocks",10),e.k0s()),2&n){const t=e.XpG(2);e.R7$(),e.Y8G("contentBlocks",t.mediaBlocks())("include",t.mediaBlockTypes)}}function jc(n,_){if(1&n&&(e.j41(0,"app-view-panel",2),e.DNE(1,Fc,1,0,"app-view-audio-bar",6)(2,zc,2,2,"div"),e.j41(3,"section",7),e.nrm(4,"app-html",8),e.k0s(),e.DNE(5,Bc,2,2,"div",9),e.k0s()),2&n){const t=e.XpG();e.Y8G("showHeader",!1)("canToggle",!1)("open",!0),e.R7$(),e.vxM(t.audioVisible()?1:-1),e.R7$(),e.vxM(t.tickerBlocks().length>0?2:-1),e.R7$(2),e.Y8G("markdownText",t.chapterDescription()),e.R7$(),e.vxM(t.mediaBlocks().length>0?5:-1)}}function Hc(n,_){if(1&n&&(e.j41(0,"app-view-panel",3),e.nrm(1,"app-view-legend",11),e.k0s()),2&n){const t=e.XpG();e.Y8G("open",t.legendOpen()),e.R7$(),e.Y8G("legend",t.chapter().legend)}}function Qc(n,_){if(1&n&&(e.j41(0,"app-view-panel",4),e.nrm(1,"app-view-labels"),e.k0s()),2&n){const t=e.XpG();e.Y8G("open",t.labelsOpen())}}function Yc(n,_){if(1&n&&(e.j41(0,"app-view-panel",5),e.nrm(1,"app-content-blocks",12),e.k0s()),2&n){const t=e.XpG();e.Y8G("open",t.positionsOpen()),e.R7$(),e.Y8G("contentBlocks",t.positionBlocks())}}class wt{constructor(_,t,i){this.store=_,this.contentBlocksService=t,this.positionsService=i,this.contentTypes=Ci.c,this.chapter=(0,h.ot)(this.store.select(b.N.getSelectedChapter)),this.chapterDescription=(0,e.EWP)(()=>{const o=this.chapter();return(0,V.trim)(o?.description??"")}),this.descriptionVisible=(0,h.ot)(this.store.select(O.dF.getVisible(E.U.Description))),this.audioVisible=(0,h.ot)(this.store.select(O.dF.getVisible(E.U.Audio))),this.contentBlocks=(0,h.ot)(this.store.select(b.N.getSelectedChapterContentBlocks)),this.mediaBlockTypes=[gt.m.Markdown,gt.m.Images,gt.m.AnimatedImages,gt.m.Videos],this.tickerBlocks=(0,e.EWP)(()=>{const o=this.contentBlocks()||[];return this.contentBlocksService.filterContentBlocksByType(o,[gt.m.Ticker])}),this.mediaBlocks=(0,e.EWP)(()=>{const o=this.contentBlocks()||[];return this.contentBlocksService.filterContentBlocksByType(o,this.mediaBlockTypes)}),this.positionBlocks=(0,e.EWP)(()=>{const o=this.contentBlocks()||[];let s=this.contentBlocksService.filterContentBlocksByType(o,[gt.m.Positions]);return s.length>0&&(s=this.insertStartingPosition(s)),s}),this.descriptionPanelVisible=(0,e.EWP)(()=>{const o=this.descriptionVisible(),s=this.audioVisible(),a=this.tickerBlocks(),r=this.chapterDescription(),u=this.mediaBlocks();return o&&(s||a.length>0||""!==r||u.length>0)}),this.toggledPanels=(0,h.ot)(this.store.select(f.Pf.getToggledPanels)),this.legendOpen=(0,e.EWP)(()=>this.computeOpen("legend")),this.labelsOpen=(0,e.EWP)(()=>this.computeOpen("labels")),this.positionsOpen=(0,e.EWP)(()=>this.computeOpen("positions")),this.layout=(0,e.hFB)(),this.contentBlockTypes=gt.m}computeOpen(_){const t=this.toggledPanels(),i=this.descriptionPanelVisible();return t.has(_)?t.get(_):!i}insertStartingPosition(_){return(_=(0,V.cloneDeep)(_))[0].positions.unshift(this.positionsService.startingPositionToAdditionalPosition(this.store.selectSnapshot(b.N.getSelectedChapterId))),_}static#e=this.\u0275fac=function(t){return new(t||wt)(e.rXU(c.il),e.rXU(Xo.V),e.rXU(bc.c))};static#t=this.\u0275cmp=e.VBU({type:wt,selectors:[["app-view-content-mode"]],inputs:{layout:[1,"layout"]},decls:9,vars:11,consts:()=>{let _,t,i;return _=$localize`:␟5c5419db944ed6a96f9515a2ac0ee390ec8cf3b5␟7297822327994766046:Legend`,t=$localize`:␟2af7efecfae8d7fed3b07f718a623eca1ad8163f␟546766753072101168:Labels`,i=$localize`:␟7acfeb6214be6d5b9c6ca7285d689dd1402ca446␟529261375582544700:Positions`,[["data-test","viewContentMode",1,"view-content-mode"],[1,"block","mb-4",3,"toggleable"],["panelId","description","aria-describedby","view-title",3,"showHeader","canToggle","open"],["panelId","legend","label",_,3,"open"],["label",t,"panelId","labels",3,"open"],["label",i,"panelId","positions",3,"open"],[1,"block","mb-4"],[1,"text-sm","break-words"],[3,"markdownText"],[1,"mt-5"],[3,"contentBlocks","include"],[3,"legend"],[3,"contentBlocks"]]},template:function(t,i){if(1&t&&(e.j41(0,"div",0),e.DNE(1,Xc,1,1,"app-view-source-info",1)(2,jc,6,7,"app-view-panel",2)(3,Hc,2,2,"app-view-panel",3),e.nI1(4,"async"),e.DNE(5,Qc,2,1,"app-view-panel",4),e.nI1(6,"async"),e.nI1(7,"async"),e.DNE(8,Yc,2,2,"app-view-panel",5),e.k0s()),2&t){let o,s;e.R7$(),e.vxM("drawer"===i.layout()?1:-1),e.R7$(),e.vxM(i.descriptionPanelVisible()?2:-1),e.R7$(),e.vxM(null!=(o=i.chapter())&&o.legend&&(null==(o=i.chapter())?null:o.legend.length)>0&&e.bMT(4,5,i.legendVisible$)?3:-1),e.R7$(2),e.vxM(null!=(s=e.bMT(6,7,i.labels$))&&s.length&&e.bMT(7,9,i.labelListVisible$)?5:-1),e.R7$(3),e.vxM(i.positionBlocks().length>0?8:-1)}},dependencies:[Pi.l,an.V,Cc,rn,di,$c,Wc,p.Jj],styles:[".view-content-mode[_ngcontent-%COMP%]{padding-bottom:24px}"],changeDetection:0})}Fn([(0,c.l6)(Fe.y.getChapterLabels),zn("design:type",d.c)],wt.prototype,"labels$",void 0),Fn([(0,c.l6)(O.dF.getVisible(E.U.LabelList)),zn("design:type",d.c)],wt.prototype,"labelListVisible$",void 0),Fn([(0,c.l6)(O.dF.getVisible(E.U.Legend)),zn("design:type",d.c)],wt.prototype,"legendVisible$",void 0);let Yo=(()=>{class n{constructor(t,i){this.store=t,this.el=i,this.appInfoScroll=!0,this.ngUnsubscribe=new z.B}ngOnInit(){this.store.selectSnapshot(w.j.hasQuiz)&&this.handleQuizScrolling(),this.handleChapterScrolling()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}handleChapterScrolling(){this.store.select(b.N.getSelectedChapterId).pipe((0,M.p)(()=>this.appInfoScroll),(0,g.Q)(this.ngUnsubscribe)).subscribe(()=>{this.scrollToTop()})}handleQuizScrolling(){const t=this.store.select(w.j.getQuizModeActive),i=this.store.select(w.j.getLifecycle);t.pipe((0,M.p)(()=>this.appInfoScroll),(0,g.Q)(this.ngUnsubscribe)).subscribe(()=>{this.scrollToTop()}),i.pipe((0,M.p)(()=>this.appInfoScroll),(0,g.Q)(this.ngUnsubscribe)).subscribe(o=>{o===Ki.h.Explanation?setTimeout(()=>this.scrollToBottom()):this.scrollToTop()})}scrollToTop(){this.el.nativeElement.scrollTo({top:0})}scrollToBottom(){this.el.nativeElement.scrollTo({top:this.el.nativeElement.scrollHeight,behavior:"smooth"})}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(c.il),e.rXU(e.aKT))};static#t=this.\u0275dir=e.FsC({type:n,selectors:[["","appInfoScroll",""]],inputs:{appInfoScroll:"appInfoScroll"}})}return n})();const qc=[[["","header",""]],[["","body",""]],[["","aside",""]]],Kc=["[header]","[body]","[aside]"],Zc=(n,_)=>({"view-column--padded":n,"view-column--show-aside":_}),Jc=n=>({"!border-gray-200":n});function ed(n,_){1&n&&(e.j41(0,"div",4),e.SdG(1,2),e.k0s())}let Tn="-100%";const td=(0,x.lY)([(0,x.iF)({transform:"translateX({{ translateX }})"}),(0,x.i0)("150ms ease-in-out",(0,x.iF)({transform:"*"}))],{params:{translateX:Tn}}),id=(0,x.lY)([(0,x.i0)("150ms ease-in-out",(0,x.iF)({transform:"translateX({{ translateX }})"}))],{params:{translateX:Tn}});let qo=(()=>{class n{get show(){return{value:this.floating(),params:{translateX:Tn}}}constructor(t,i,o){this.el=t,this.store=i,this.localeId=o,this.animationsDisabled=this.store.selectSnapshot(fi.U.getPrefersReducedMotion),this.contentMode=(0,h.ot)(this.store.select(f.Pf.getContentMode)),this.animated=(0,e.hFB)(!1),this.padded=(0,e.hFB)(!0),this.wide=(0,e.hFB)(!1),this.floating=(0,e.hFB)(!1),this.showFooter=(0,e.hFB)(!1),this.showAside=(0,e.hFB)(!1),this.footerLabel=(0,e.hFB)(""),this.viewContentMode=st.G,this.footerExpanded=!1,this.scrollTop=0,"rtl"===(0,Dn.NS)(this.localeId).direction&&(Tn="100%"),(0,e.QZP)(()=>{this.floating()&&this.el.nativeElement.classList.add("!absolute","z-50","top-0","start-0","bottom-0")}),(0,e.QZP)(()=>{const s=this.wide()?"424px":"320px";this.el.nativeElement.style.setProperty("--column-width",s)})}handleToggleFooter(t){this.footerExpanded=t}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(e.aKT),e.rXU(c.il),e.rXU(e.xe9))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-view-column"]],hostVars:2,hostBindings:function(i,o){2&i&&e.zvX("@show",o.show)("@.disabled",o.animationsDisabled)},inputs:{animated:[1,"animated"],padded:[1,"padded"],wide:[1,"wide"],floating:[1,"floating"],showFooter:[1,"showFooter"],showAside:[1,"showAside"],footerLabel:[1,"footerLabel"]},ngContentSelectors:Kc,decls:6,vars:10,consts:[["role","main","data-test","viewColumn",1,"view-column",3,"ngClass"],[1,"border-b","border-transparent","border-solid","view-column__header",3,"ngClass"],[1,"view-column__body",3,"appScrollListenerChange","appScrollListener","appInfoScroll"],["class","view-column__aside",4,"ngIf"],[1,"view-column__aside"]],template:function(i,o){1&i&&(e.NAR(qc),e.j41(0,"article",0)(1,"div",1),e.SdG(2),e.k0s(),e.j41(3,"div",2),e.mxI("appScrollListenerChange",function(a){return e.DH7(o.scrollTop,a)||(o.scrollTop=a),a}),e.SdG(4,1),e.k0s(),e.DNE(5,ed,2,0,"div",3),e.k0s()),2&i&&(e.Y8G("ngClass",e.l_i(5,Zc,o.padded(),o.showAside())),e.R7$(),e.Y8G("ngClass",e.eq3(8,Jc,o.scrollTop>0||o.floating())),e.R7$(2),e.R50("appScrollListener",o.scrollTop),e.Y8G("appInfoScroll",o.contentMode()===o.viewContentMode.ChapterInfo||o.contentMode()===o.viewContentMode.Quiz),e.R7$(2),e.Y8G("ngIf",o.showAside()))},dependencies:[p.YU,p.bT,Yo,Bo],styles:['[_nghost-%COMP%]{--column-width: 320px;position:relative;width:var(--column-width);max-width:100vw}.view-column[_ngcontent-%COMP%]{background-color:#fff;border-right:1px solid #d7e0ea;height:100%;display:grid;grid-template-areas:"header" "content" "footer";grid-template-columns:auto;grid-template-rows:auto 1fr}.view-column--padded[_ngcontent-%COMP%]   .view-column__header[_ngcontent-%COMP%]{padding:20px 24px 12px}.view-column--padded[_ngcontent-%COMP%]   .view-column__body[_ngcontent-%COMP%]{padding:12px 24px 20px}.view-column--padded[_ngcontent-%COMP%]   .view-column__footer-content[_ngcontent-%COMP%]{padding:4px 24px 24px 12px}.view-column--show-aside[_ngcontent-%COMP%]{grid-template-areas:"aside header" "aside content" "aside footer";grid-template-columns:104px 320px}.view-column__aside[_ngcontent-%COMP%]{background-color:#f9fafd;grid-area:aside;border-right:1px solid #d7e0ea}.view-column__aside[_ngcontent-%COMP%]:empty{display:none}.view-column__header[_ngcontent-%COMP%]{grid-area:header}.view-column__body[_ngcontent-%COMP%]{grid-area:content;overflow:auto}.view-column__footer[_ngcontent-%COMP%]{grid-area:footer;border:1px solid #d7e0ea;display:flex;flex-direction:column}.view-column__footer-toggle[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:space-between;padding:16px 12px;color:#131c2a;font-size:.875rem;line-height:1.25rem;font-weight:600;text-transform:uppercase}.view-column__footer-content-wrapper[_ngcontent-%COMP%]{max-height:0;overflow:hidden;transition:all .5s}.view-column__footer-content-wrapper--expanded[_ngcontent-%COMP%]{overflow:auto;max-height:40vh}'],data:{animation:[(0,x.hZ)("show",[(0,x.kY)(":enter",(0,x.sM)(td)),(0,x.kY)(":leave",(0,x.sM)(id))])]},changeDetection:0})}return n})();var Ko=function(n,_,t,i){var a,o=arguments.length,s=o<3?_:null===i?i=Object.getOwnPropertyDescriptor(_,t):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(n,_,t,i);else for(var r=n.length-1;r>=0;r--)(a=n[r])&&(s=(o<3?a(s):o>3?a(_,t,s):a(_,t))||s);return o>3&&s&&Object.defineProperty(_,t,s),s},Zo=function(n,_){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(n,_)};class pi{constructor(){}ngOnInit(){}static#e=this.\u0275fac=function(t){return new(t||pi)};static#t=this.\u0275cmp=e.VBU({type:pi,selectors:[["app-view-column-chapter-header"]],decls:3,vars:3,consts:[["data-test","viewColumnHeader",1,"view-column-chapter-header"],[1,"view-column-chapter-header__title"],["size","lg",3,"dynamicTitle","showMetaTitle","showSubTitle"]],template:function(t,i){1&t&&(e.j41(0,"div",0)(1,"div",1),e.nrm(2,"app-view-title",2),e.k0s()()),2&t&&(e.R7$(2),e.Y8G("dynamicTitle","chapter")("showMetaTitle",!1)("showSubTitle",!1))},dependencies:[Zi],styles:[".view-column-chapter-header[_ngcontent-%COMP%]{min-height:32px;display:flex;align-items:center}.view-column-chapter-header__title[_ngcontent-%COMP%]{flex-grow:1;padding-right:12px}.view-column-chapter-header__pagination[_ngcontent-%COMP%]{align-self:flex-start}"],changeDetection:0})}Ko([(0,c.l6)(b.N.getChapterCount),Zo("design:type",d.c)],pi.prototype,"chapterCount$",void 0),Ko([(0,c.l6)(O.dF.getVisible(E.U.Pagination)),Zo("design:type",d.c)],pi.prototype,"paginationVisible$",void 0);var Jo=function(n,_,t,i){var a,o=arguments.length,s=o<3?_:null===i?i=Object.getOwnPropertyDescriptor(_,t):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(n,_,t,i);else for(var r=n.length-1;r>=0;r--)(a=n[r])&&(s=(o<3?a(s):o>3?a(_,t,s):a(_,t))||s);return o>3&&s&&Object.defineProperty(_,t,s),s},e_=function(n,_){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(n,_)};const nd=["sourceInformation"];function od(n,_){1&n&&(e.qex(0),e.nrm(1,"app-view-title",9),e.bVm()),2&n&&(e.R7$(),e.Y8G("dynamicTitle","quiz")("showMetaTitle",!1)("showSubTitle",!1))}function _d(n,_){1&n&&(e.qex(0),e.nrm(1,"app-view-column-chapter-header")(2,"app-view-source-info-toggle"),e.bVm())}function sd(n,_){1&n&&(e.qex(0),e.nrm(1,"app-view-content-mode"),e.bVm())}function ad(n,_){1&n&&(e.qex(0),e.nrm(1,"app-view-quiz",10),e.bVm())}class ui{constructor(_,t){this.store=_,this.popupService=t,this.contentMode=(0,h.ot)(this.store.select(f.Pf.getContentMode)),this.paginationVisible=(0,h.ot)(this.store.select(O.dF.getVisible(E.U.Pagination))),this.viewContentMode=st.G}toggleSourceInformation(){this.popupService.open({origin:this.sourceInformationEl.nativeElement,content:rn}).afterClosed$.subscribe()}static#e=this.\u0275fac=function(t){return new(t||ui)(e.rXU(c.il),e.rXU(Vn.O))};static#t=this.\u0275cmp=e.VBU({type:ui,selectors:[["app-view-column-container"]],viewQuery:function(t,i){if(1&t&&e.GBs(nd,5),2&t){let o;e.mGM(o=e.lsd())&&(i.sourceInformationEl=o.first)}},decls:11,vars:8,consts:[["data-test","viewColumnContainer",3,"padded","showAside"],["aside",""],[1,"block","h-full"],["header",""],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["body",""],[4,"ngIf"],[3,"dynamicTitle","showMetaTitle","showSubTitle"],["mode","column"]],template:function(t,i){1&t&&(e.j41(0,"app-view-column",0),e.qex(1,1),e.nrm(2,"app-view-chapter-list",2),e.bVm(),e.qex(3,3)(4,4),e.nI1(5,"async"),e.DNE(6,od,2,3,"ng-container",5)(7,_d,3,0,"ng-container",6),e.bVm()(),e.qex(8,7),e.DNE(9,sd,2,0,"ng-container",8)(10,ad,2,0,"ng-container",8),e.bVm(),e.k0s()),2&t&&(e.Y8G("padded",i.contentMode()!==i.viewContentMode.Search)("showAside",i.paginationVisible()),e.R7$(4),e.Y8G("ngSwitch",e.bMT(5,6,i.contentMode$)),e.R7$(2),e.Y8G("ngSwitchCase",i.viewContentMode.Quiz),e.R7$(3),e.Y8G("ngIf",i.contentMode()===i.viewContentMode.ChapterInfo),e.R7$(),e.Y8G("ngIf",i.contentMode()===i.viewContentMode.Quiz))},dependencies:[p.bT,p.ux,p.e1,p.fG,Pe,ho,Zi,Di,wt,qo,pi,p.Jj],styles:["[_nghost-%COMP%]{position:relative;height:100%}.view-column-container[_ngcontent-%COMP%]{height:100%}.view-column-container--hide-tabs[_ngcontent-%COMP%]   .view-column-container__tabs[_ngcontent-%COMP%]{display:none}"],changeDetection:0})}Jo([(0,c.l6)(f.Pf.getContentMode),e_("design:type",d.c)],ui.prototype,"contentMode$",void 0),Jo([(0,c.l6)(O.dF.getVisible(E.U.Pagination)),e_("design:type",d.c)],ui.prototype,"paginationVisible$",void 0);const rd=(n,_)=>({"rotate-180":n,"rotate-0":_});let ld=(()=>{class n{constructor(t,i,o){this.viewService=t,this.store=i,this.directionality=o,this.chapter=(0,h.ot)(this.store.select(b.N.getSelectedChapter)),this.viewUI=(0,h.ot)(this.store.select(O.dF.getUI)),this.isOut=(0,e.EWP)(()=>!(0,V.isNil)(this.chapter())&&this.viewUI().column.status!==ot.Q.Collapse),this.tooltipText=(0,e.EWP)(()=>this.isOut()?$localize`Close Info Panel`:$localize`Open Info Panel`),this.tooltipPosition="ltr"===this.directionality.value?"right":"left"}handleToggle(){const t=this.store.selectSnapshot(f.Pf.getContentMode);this.viewService.toggleColumn(),this.viewService.toggleSearch(null,!1),t===st.G.NodeInfo&&this.viewService.toggleNodeInfo(!1),t===st.G.LabelInfo&&this.viewService.toggleLabelInfo(!1)}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(F.z),e.rXU(c.il),e.rXU(Dt.dS))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-view-column-toggle"]],decls:3,vars:8,consts:[["orientation","vertical","appPreventFadeout",""],["app-view-button","","buttonSize","small","data-test","viewColumnToggle",3,"click","matTooltip","matTooltipPosition"],["appLogicalDir","","size","lg","icon","angles-left",1,"rotate--animate",3,"ngClass"]],template:function(i,o){1&i&&(e.j41(0,"app-pillbox",0)(1,"button",1),e.bIt("click",function(){return o.handleToggle()}),e.nrm(2,"app-icon",2),e.k0s()()),2&i&&(e.R7$(),e.Y8G("matTooltip",o.tooltipText())("matTooltipPosition",o.tooltipPosition),e.BMQ("aria-label",o.tooltipText())("aria-expanded",o.isOut()),e.R7$(),e.Y8G("ngClass",e.l_i(5,rd,!o.isOut(),o.isOut())))},dependencies:[P.ri,p.YU,oe.s,Ot.e,D.R,j.oV,Ze.O],encapsulation:2,data:{animation:[(0,x.hZ)("show",[(0,x.kY)(":enter",[(0,x.iF)({opacity:0,transform:"translateX(-32px)"}),(0,x.i0)("300ms ease-in-out",(0,x.iF)({opacity:1,transform:"*"}))]),(0,x.kY)(":leave",[(0,x.i0)("300ms ease-in-out",(0,x.iF)({transform:"translateX(-32px)",opacity:0}))])])]},changeDetection:0})}return n})();var t_=l(8961);function pd(n,_){if(1&n){const t=e.RV6();e.j41(0,"div",2)(1,"app-message-toggle",3),e.bIt("handleDismiss",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.handleDismiss())}),e.j41(2,"div"),e.pXf(3,0),e.k0s()()()}2&n&&(e.R7$(),e.Y8G("dismiss",!0))}class Li{constructor(_){this.changeRef=_,this.shown=!1,this.ngUnsubscribe=new z.B}ngOnInit(){this.bookmark$.pipe((0,g.Q)(this.ngUnsubscribe)).subscribe(_=>{const t=(0,V.get)(_,"tags",[]);this.shown=t.includes("complete anatomy"),this.changeRef.markForCheck()})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}handleDismiss(){this.shown=!1,this.changeRef.markForCheck()}static#e=this.\u0275fac=function(t){return new(t||Li)(e.rXU(e.gRc))};static#t=this.\u0275cmp=e.VBU({type:Li,selectors:[["app-view-content-warning"]],decls:2,vars:3,consts:()=>{let _;return _=$localize`:␟1d4c33eaee2d38fb3172aed1c2b4dc7eee0c2eb6␟890030107605562637: This model is not optimized for use on mobile devices. For an optimal experience, please switch to a desktop device or try our Anatomy by Region. `,[_,["class","warning",4,"ngIf"],[1,"warning"],["type","warning","toggleStyle","flat","icon","info-circle",3,"handleDismiss","dismiss"]]},template:function(t,i){1&t&&(e.DNE(0,pd,4,1,"div",1),e.nI1(1,"async")),2&t&&e.Y8G("ngIf",e.bMT(1,1,i.bookmark$)&&i.shown)},dependencies:[p.bT,t_.X,p.Jj],styles:[".warning{position:fixed;top:0;left:0;right:0;z-index:1001}\n"],encapsulation:2,changeDetection:0})}!function(n,_,t,i){var a,o=arguments.length,s=o<3?_:null===i?i=Object.getOwnPropertyDescriptor(_,t):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(n,_,t,i);else for(var r=n.length-1;r>=0;r--)(a=n[r])&&(s=(o<3?a(s):o>3?a(_,t,s):a(_,t))||s);o>3&&s&&Object.defineProperty(_,t,s)}([(0,c.l6)(Vt.J.getSelectedBookmark),function(n,_){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata("design:type",_)}(0,d.c)],Li.prototype,"bookmark$",void 0);const gd=["*"];class xi{constructor(){this.toggle=new e.bkB,this.open=!1,this.fixed=!1,this.compact=!1}handleToggleClick(){this.toggle.emit()}static#e=this.\u0275fac=function(t){return new(t||xi)};static#t=this.\u0275cmp=e.VBU({type:xi,selectors:[["app-view-drawer-header"]],inputs:{open:"open",fixed:"fixed",compact:"compact"},outputs:{toggle:"toggle"},ngContentSelectors:gd,decls:5,vars:8,consts:[["app-view-button","","buttonSize","fill","data-test","drawerToggleButton",1,"view-drawer-header",3,"click"],[1,"view-drawer-header__content"],["size","md",1,"mx-4",3,"icon"]],template:function(t,i){if(1&t&&(e.NAR(),e.j41(0,"button",0),e.bIt("click",function(){return i.handleToggleClick()}),e.j41(1,"div",1),e.SdG(2),e.nrm(3,"app-icon",2),e.nI1(4,"async"),e.k0s()()),2&t){let o;e.AVh("view-drawer-header--fixed",i.fixed)("view-drawer-header--compact",i.compact),e.BMQ("aria-expanded",i.open),e.R7$(3),e.Y8G("icon","show"===(null==(o=e.bMT(4,6,i.viewUI$))?null:o.drawer.status)?"angle-down":"angle-up")}},dependencies:[P.ri,D.R,p.Jj],styles:[".view-drawer-header[_ngcontent-%COMP%]{--header-height: 40px;font-size:16px;width:100%;border-bottom:1px solid #d7e0ea;min-height:var(--header-height)}.view-drawer-header--fixed[_ngcontent-%COMP%]{font-size:14px;height:var(--header-height)}.view-drawer-header--compact[_ngcontent-%COMP%]{--header-height: 24px;min-height:var(--header-height);height:var(--header-height);font-size:12px}.view-drawer-header__content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:0 16px;margin:0 auto;max-width:520px;min-height:var(--header-height)-4px}"],changeDetection:0})}!function(n,_,t,i){var a,o=arguments.length,s=o<3?_:null===i?i=Object.getOwnPropertyDescriptor(_,t):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(n,_,t,i);else for(var r=n.length-1;r>=0;r--)(a=n[r])&&(s=(o<3?a(s):o>3?a(_,t,s):a(_,t))||s);o>3&&s&&Object.defineProperty(_,t,s)}([(0,c.l6)(O.dF.getUI),function(n,_){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata("design:type",_)}(0,d.c)],xi.prototype,"viewUI$",void 0);var Ue=function(n,_,t,i){var a,o=arguments.length,s=o<3?_:null===i?i=Object.getOwnPropertyDescriptor(_,t):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(n,_,t,i);else for(var r=n.length-1;r>=0;r--)(a=n[r])&&(s=(o<3?a(s):o>3?a(_,t,s):a(_,t))||s);return o>3&&s&&Object.defineProperty(_,t,s),s},Ve=function(n,_){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(n,_)};const Ed=["viewDrawer"],Sd=["viewDrawerContent"],md=(n,_,t)=>({"view-drawer--closed":n,"view-drawer--active":_,"view-drawer--scrollable":t}),i_=n=>[n];function fd(n,_){if(1&n&&(e.j41(0,"div",9),e.nrm(1,"app-spinner",10),e.nI1(2,"async"),e.k0s()),2&n){let t;const i=e.XpG();e.R7$(),e.Y8G("label",null==(t=e.bMT(2,1,i.scrim$))?null:t.label)}}function Td(n,_){if(1&n){const t=e.RV6();e.qex(0),e.j41(1,"app-view-drawer-header",11),e.bIt("toggle",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.handleToggleClick(o.viewContentMode.ChapterInfo))}),e.nrm(2,"app-view-title",12),e.k0s(),e.bVm()}if(2&n){const t=e.XpG();e.R7$(),e.Y8G("compact",t.scrolled&&t.scrollThreshold),e.R7$(),e.Y8G("dynamicTitle","chapter")("showMetaTitle",!1)("showSubTitle",!1)("useEllipsis",t.scrolled&&t.scrollThreshold)}}function bd(n,_){if(1&n){const t=e.RV6();e.qex(0),e.j41(1,"app-view-drawer-header",13),e.bIt("toggle",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.handleToggleClick(o.viewContentMode.Quiz))}),e.nrm(2,"app-view-title",14),e.k0s(),e.bVm()}if(2&n){const t=e.XpG();e.R7$(),e.Y8G("fixed",!0)("compact",t.scrolled&&t.scrollThreshold),e.R7$(),e.Y8G("dynamicTitle","quiz")("showMetaTitle",!1)("showSubTitle",!1)}}function vd(n,_){if(1&n){const t=e.RV6();e.qex(0),e.j41(1,"app-view-drawer-header",13),e.nI1(2,"async"),e.bIt("toggle",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.handleToggleClick(o.viewContentMode.LabelInfo))}),e.nrm(3,"app-view-title",15),e.nI1(4,"async"),e.k0s(),e.bVm()}if(2&n){let t,i;const o=e.XpG();e.R7$(),e.Y8G("fixed","collapse"===(null==(t=e.bMT(2,5,o.drawerUI$))?null:t.status))("compact",o.scrolled&&o.scrollThreshold),e.R7$(2),e.Y8G("align","center")("mainTitle",null==(i=e.bMT(4,7,o.selectedLabel$))?null:i.title)("useEllipsis",o.scrolled&&o.scrollThreshold)}}function Od(n,_){if(1&n){const t=e.RV6();e.qex(0),e.j41(1,"app-view-drawer-header",13),e.nI1(2,"async"),e.bIt("toggle",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.handleToggleClick(o.viewContentMode.VisibilityLayers))}),e.nrm(3,"app-view-title",16),e.k0s(),e.bVm()}if(2&n){let t;const i=e.XpG();e.R7$(),e.Y8G("fixed","collapse"===(null==(t=e.bMT(2,3,i.drawerUI$))?null:t.status))("compact",i.scrolled&&i.scrollThreshold),e.R7$(2),e.Y8G("align","left")}}function Cd(n,_){1&n&&(e.qex(0),e.nrm(1,"app-view-content-mode",17),e.bVm())}function Id(n,_){1&n&&e.nrm(0,"app-view-quiz",20)}function Md(n,_){if(1&n&&(e.j41(0,"div",18),e.DNE(1,Id,1,0,"app-view-quiz",19),e.nI1(2,"async"),e.k0s()),2&n){const t=e.XpG();e.R7$(),e.Y8G("ngIf",e.bMT(2,1,t.quizModeActive$))}}function wd(n,_){if(1&n&&(e.j41(0,"div",24),e.nrm(1,"app-content-blocks",25),e.nI1(2,"async"),e.k0s()),2&n){let t;const i=e.XpG(2);e.R7$(),e.Y8G("contentBlocks",null==(t=e.bMT(2,3,i.selectedLabel$))?null:t.contentBlocks)("exclude",e.eq3(5,i_,i.contentBlockTypes.CTA))("layout","compact")}}function Ad(n,_){if(1&n&&(e.j41(0,"div",26),e.nrm(1,"app-content-blocks",27),e.nI1(2,"async"),e.k0s()),2&n){let t;const i=e.XpG(2);e.R7$(),e.Y8G("contentBlocks",null==(t=e.bMT(2,3,i.selectedLabel$))?null:t.contentBlocks)("include",e.eq3(5,i_,i.contentBlockTypes.CTA))("layout","compact")}}function yd(n,_){if(1&n&&(e.qex(0),e.DNE(1,wd,3,7,"div",21),e.nI1(2,"async"),e.nrm(3,"app-html",22),e.nI1(4,"async"),e.DNE(5,Ad,3,7,"div",23),e.nI1(6,"async"),e.bVm()),2&n){let t,i,o;const s=e.XpG();e.R7$(),e.Y8G("ngIf",null==(t=e.bMT(2,3,s.selectedLabel$))?null:t.contentBlocks),e.R7$(2),e.Y8G("markdownText",null==(i=e.bMT(4,5,s.selectedLabel$))?null:i.description),e.R7$(2),e.Y8G("ngIf",null==(o=e.bMT(6,7,s.selectedLabel$))?null:o.contentBlocks)}}function Nd(n,_){1&n&&(e.qex(0),e.nrm(1,"app-view-visibility-layers",28),e.bVm()),2&n&&(e.R7$(),e.Y8G("compact",!0))}class fe{constructor(_,t,i){this.changeDetectorRef=_,this.viewService=t,this.store=i,this.viewContentMode=st.G,this.contentBlockTypes=gt.m,this.openChanged=new e.bkB,this.ngUnsubscribe=new z.B,this.viewMode=dn,this.mode=dn.Content,this.horizontalBreakpoint=pn.m,this.scrolled=!1,this.scrollThreshold=!1}ngOnInit(){this.initQuizObserver(),this.initScrollObserver()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initQuizObserver(){const _=this.selectedChapterReady$.pipe((0,ve.T)(t=>t&&t.model),(0,M.p)(t=>t),(0,Re.B)(300));(0,de.z)([_,this.quizModeActive$]).pipe((0,M.p)(([t])=>t),(0,g.Q)(this.ngUnsubscribe)).subscribe(([,t])=>{setTimeout(()=>{t&&(this.viewService.toggleDrawer(ot.Q.Show),this.changeDetectorRef.markForCheck())})})}initScrollObserver(){(0,ye.R)(this.viewDrawerContent.nativeElement,"scroll").pipe((0,g.Q)(this.ngUnsubscribe)).subscribe(()=>this.handleContentScroll())}updateViewHeight(){const _=this.store.selectSnapshot(ai.W.getSiteHeader),t=this.store.selectSnapshot(ai.W.getSiteHeaderHeight),i=(0,un.Un)(_),o=(0,un.mJ)(_,t,i);this.viewDrawer.nativeElement.style.setProperty("--vh",`${o}px`)}handleToggleClick(_){const t=this.store.selectSnapshot(O.dF.getUIEntry(E.U.Drawer));switch(_){case st.G.LabelInfo:this.viewService.clearSelectedLabel();break;case st.G.Quiz:this.viewService.toggleDrawer(t.status===ot.Q.Show?ot.Q.Collapse:ot.Q.Show);break;default:this.viewService.toggleDrawer()}}handleDrawerKeydown(_){("ArrowDown"===_.key||"ArrowUp"===_.key)&&_.stopPropagation()}handleLabelBack(){this.viewService.clearSelectedLabel()}handlePreviousClick(){this.viewService.previousChapter("drawer")}handleNextClick(){this.viewService.nextChapter("drawer")}handleContentScroll(){const _=this.viewDrawerContent.nativeElement.scrollTop;this.scrollThreshold=this.viewDrawerContent.nativeElement.scrollHeight-this.viewDrawerContent.nativeElement.clientHeight>21;const o=_>0;o!==this.scrolled&&(this.scrolled=o,this.changeDetectorRef.markForCheck())}static#e=this.\u0275fac=function(t){return new(t||fe)(e.rXU(e.gRc),e.rXU(F.z),e.rXU(c.il))};static#t=this.\u0275cmp=e.VBU({type:fe,selectors:[["app-view-drawer"]],viewQuery:function(t,i){if(1&t&&(e.GBs(Ed,5),e.GBs(Sd,7)),2&t){let o;e.mGM(o=e.lsd())&&(i.viewDrawer=o.first),e.mGM(o=e.lsd())&&(i.viewDrawerContent=o.first)}},outputs:{openChanged:"openChanged"},decls:22,vars:32,consts:[["viewDrawer",""],["viewDrawerContent",""],["role","main","data-test","viewPageDrawer",1,"view-drawer",3,"ngClass"],["class","view-drawer__scrim",4,"ngIf"],[1,"view-drawer__outer",3,"keydown"],[1,"view-drawer__inner",3,"ngSwitch"],[4,"ngSwitchCase"],[1,"view-drawer__content",3,"appInfoScroll","ngSwitch"],["class","pt-3 pb-8",4,"ngSwitchCase"],[1,"view-drawer__scrim"],["size","large",3,"label"],[3,"toggle","compact"],[3,"dynamicTitle","showMetaTitle","showSubTitle","useEllipsis"],[3,"toggle","fixed","compact"],[3,"dynamicTitle","showMetaTitle","showSubTitle"],[3,"align","mainTitle","useEllipsis"],["mainTitle","Anatomy Layers",3,"align"],["layout","drawer",1,"mt-2"],[1,"pt-3","pb-8"],["mode","drawer",4,"ngIf"],["mode","drawer"],["appEventFence","",4,"ngIf"],[1,"text-sm",3,"markdownText"],["class","mt-2",4,"ngIf"],["appEventFence",""],[3,"contentBlocks","exclude","layout"],[1,"mt-2"],[3,"contentBlocks","include","layout"],[3,"compact"]],template:function(t,i){if(1&t){const o=e.RV6();e.j41(0,"article",2,0),e.nI1(2,"async"),e.nI1(3,"async"),e.nI1(4,"async"),e.DNE(5,fd,3,3,"div",3),e.nI1(6,"async"),e.j41(7,"div",4),e.bIt("keydown",function(a){return e.eBV(o),e.Njj(i.handleDrawerKeydown(a))}),e.j41(8,"div",5),e.nI1(9,"async"),e.DNE(10,Td,3,5,"ng-container",6)(11,bd,3,5,"ng-container",6)(12,vd,5,9,"ng-container",6)(13,Od,4,5,"ng-container",6),e.j41(14,"div",7,1),e.nI1(16,"async"),e.nI1(17,"async"),e.DNE(18,Cd,2,0,"ng-container",6)(19,Md,3,3,"div",8)(20,yd,7,9,"ng-container",6)(21,Nd,2,1,"ng-container",6),e.k0s()()()()}if(2&t){let o,s;e.Y8G("ngClass",e.sMw(28,md,!1===e.bMT(2,14,i.drawerVisible$),e.bMT(3,16,i.drawerVisible$),"show"===(null==(o=e.bMT(4,18,i.drawerUI$))?null:o.status))),e.R7$(5),e.Y8G("ngIf",null==(s=e.bMT(6,20,i.scrim$))?null:s.show),e.R7$(3),e.Y8G("ngSwitch",e.bMT(9,22,i.contentMode$)),e.R7$(2),e.Y8G("ngSwitchCase",i.viewContentMode.ChapterInfo),e.R7$(),e.Y8G("ngSwitchCase",i.viewContentMode.Quiz),e.R7$(),e.Y8G("ngSwitchCase",i.viewContentMode.LabelInfo),e.R7$(),e.Y8G("ngSwitchCase",i.viewContentMode.VisibilityLayers),e.R7$(),e.Y8G("appInfoScroll",!0)("ngSwitch",e.bMT(16,24,i.contentMode$)),e.BMQ("tabindex",e.bMT(17,26,i.drawerVisible$)?0:-1),e.R7$(4),e.Y8G("ngSwitchCase",i.viewContentMode.ChapterInfo),e.R7$(),e.Y8G("ngSwitchCase",i.viewContentMode.Quiz),e.R7$(),e.Y8G("ngSwitchCase",i.viewContentMode.LabelInfo),e.R7$(),e.Y8G("ngSwitchCase",i.viewContentMode.VisibilityLayers)}},dependencies:[p.YU,p.bT,p.ux,p.e1,Pi.l,xn.L,Yo,fn.tI,an.V,Pe,Un,Zi,wt,xi,p.Jj],styles:[".view-drawer{height:100%;padding-bottom:4px}.view-drawer--active,.view-drawer--closed{background-color:#fff}.view-drawer--scrollable{min-height:0}.view-drawer--scrollable .view-drawer__content{overflow-y:scroll}.view-drawer__header{position:relative;border-bottom:1px solid #eaeff5}.view-drawer__pagination,.view-drawer__media{display:flex;align-items:center;border-right:1px solid rgba(0,0,0,.1)}.view-drawer__toggle{padding:0 16px;display:flex;align-items:center;justify-content:center;width:100%;font-size:.625rem;line-height:.75rem;text-transform:uppercase;font-weight:600}.view-drawer__inner{height:100%;display:flex;flex-direction:column}.view-drawer__outer{outline:none;height:100%}.view-drawer__content{display:flex;flex:1 1 100%;flex-direction:column;width:100%;max-width:520px;margin:0 auto;padding:8px 16px}.view-drawer__scrim{background-color:#fff;position:absolute;display:flex;justify-content:center;align-items:center;z-index:50;inset:0}.view-drawer__pagination-tooltip{position:absolute;z-index:1000;bottom:100%;left:36px}\n"],encapsulation:2,changeDetection:0})}Ue([(0,c.l6)(f.Pf.getContentMode),Ve("design:type",d.c)],fe.prototype,"contentMode$",void 0),Ue([(0,c.l6)(f.Pf.getScrim),Ve("design:type",d.c)],fe.prototype,"scrim$",void 0),Ue([(0,c.l6)(b.N.getSelectedChapterTitle),Ve("design:type",d.c)],fe.prototype,"selectedChapterTitle$",void 0),Ue([(0,c.l6)(b.N.getChapterPagination),Ve("design:type",d.c)],fe.prototype,"pagination$",void 0),Ue([(0,c.l6)(b.N.getSelectedChapterReadyState),Ve("design:type",d.c)],fe.prototype,"selectedChapterReady$",void 0),Ue([(0,c.l6)(b.N.getNextChapter),Ve("design:type",d.c)],fe.prototype,"nextChapter$",void 0),Ue([(0,c.l6)(Fe.y.getSelectedLabel),Ve("design:type",d.c)],fe.prototype,"selectedLabel$",void 0),Ue([(0,c.l6)(w.j.getQuizModeActive),Ve("design:type",d.c)],fe.prototype,"quizModeActive$",void 0),Ue([(0,c.l6)(w.j.getActiveQuestionIndex),Ve("design:type",d.c)],fe.prototype,"activeQuestionIndex$",void 0),Ue([(0,c.l6)(w.j.getQuestionTotal),Ve("design:type",d.c)],fe.prototype,"questionTotal$",void 0),Ue([(0,c.l6)(w.j.getQuestionsRemaining),Ve("design:type",d.c)],fe.prototype,"questionRemaining$",void 0),Ue([(0,c.l6)(w.j.getQuizSettings),Ve("design:type",d.c)],fe.prototype,"quizSettings$",void 0),Ue([(0,c.l6)(w.j.getQuizModeLocked),Ve("design:type",d.c)],fe.prototype,"quizLocked$",void 0),Ue([(0,c.l6)(Mi.V.getHorizontalBreakpoint),Ve("design:type",d.c)],fe.prototype,"horizontalBreakpoint$",void 0),Ue([(0,c.l6)(O.dF.getVisible(E.U.Drawer)),Ve("design:type",d.c)],fe.prototype,"drawerVisible$",void 0),Ue([(0,c.l6)(O.dF.getUIEntry(E.U.Drawer)),Ve("design:type",d.c)],fe.prototype,"drawerUI$",void 0);let Rd=(()=>{class n{constructor(t,i,o){this.viewService=t,this.directionality=i,this.store=o,this.viewUI=(0,h.ot)(this.store.select(O.dF.getUI)),this.contentMode=(0,h.ot)(this.store.select(f.Pf.getContentMode)),this.isOut=(0,e.EWP)(()=>this.viewUI().drawer.status===ot.Q.Show&&this.contentMode()===st.G.ChapterInfo),this.tooltipText=(0,e.EWP)(()=>this.isOut()?$localize`Close Info Panel`:$localize`Open Info Panel`),this.tooltipPosition="ltr"===this.directionality.value?"right":"left"}toggleDrawer(){const t=this.isOut()?ot.Q.Hide:ot.Q.Show;this.viewService.clearSelectedLabel(),this.viewService.setContentMode(st.G.ChapterInfo),this.viewService.toggleDrawer(t,!0)}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(F.z),e.rXU(Dt.dS),e.rXU(c.il))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-view-drawer-toggle"]],decls:2,vars:4,consts:[["app-view-button","","buttonSize","small","data-test","viewDrawerToggle",3,"click","matTooltip","matTooltipPosition","buttonTheme"],["size","lg","icon","info",3,"custom"]],template:function(i,o){1&i&&(e.j41(0,"button",0),e.bIt("click",function(){return o.toggleDrawer()}),e.nrm(1,"app-icon",1),e.k0s()),2&i&&(e.Y8G("matTooltip",o.tooltipText())("matTooltipPosition",o.tooltipPosition)("buttonTheme",o.isOut()?"blue-fill":"transparent-fill"),e.R7$(),e.Y8G("custom",!0))},dependencies:[P.ri,D.R,j.oV],changeDetection:0})}return n})();var bn=l(17215);function Pd(n,_){if(1&n){const t=e.RV6();e.j41(0,"div",2)(1,"app-message-toggle",3),e.bIt("handleDismiss",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.handleDismiss())}),e.j41(2,"div"),e.pXf(3,0),e.k0s()()()}2&n&&(e.R7$(),e.Y8G("dismiss",!0))}const Wt=[];let vn,On,Vd=(()=>{class n{constructor(t,i){this.storageService=t,this.changeRef=i,this.shown=!1,this.sampling=!1}ngOnInit(){this.storageService.getLocalItem(bn.UT.Iphone12Warning)||this.testDevices()}ngOnDestroy(){this.sampling=!1}testDevices(){const t=window.matchMedia("only screen and (device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3)"),i=window.matchMedia("only screen and (device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3)"),o=window.matchMedia("only screen and (device-width: 820px) and (device-height: 1180px) and (-webkit-device-pixel-ratio: 2)"),s=t.matches||i.matches||o.matches,a=/iPhone|iPad/.test(navigator.userAgent),r=/OS\s14/.test(navigator.userAgent);s&&a&&r&&this.startFrameSampling()}startFrameSampling(){this.sampling=!0,vn=0,On=Date.now();const t=()=>{this.frame()?(this.shown=!0,this.changeRef.markForCheck()):this.sampling&&requestAnimationFrame(t)};requestAnimationFrame(t)}frame(){vn++;const t=Date.now();if(t>=On+500){const o=Math.floor(500*vn/(t-On)*2);if(Wt.push(o),Wt.length>3&&Wt.shift(),3===Wt.length&&(Wt[0]+Wt[1]+Wt[2])/3<10)return!0;On=t,vn=0}}handleDismiss(){this.shown=!1,this.changeRef.markForCheck(),this.storageService.setLocalItem(bn.UT.Iphone12Warning,!0)}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(bn.n$),e.rXU(e.gRc))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-view-iphone12-warning"]],decls:1,vars:1,consts:()=>{let t;return t=$localize`:␟6aa3f174a7565623c9f89ee56c05a46a791742c9␟6041509682411192729: This model appears to be performing slowly on your device. For an optimal experience, please switch to a different device or try another model. `,[t,["class","warning",4,"ngIf"],[1,"warning"],["type","warning","toggleStyle","flat","icon","info-circle",3,"handleDismiss","dismiss"]]},template:function(i,o){1&i&&e.DNE(0,Pd,4,1,"div",1),2&i&&e.Y8G("ngIf",o.shown)},dependencies:[p.bT,t_.X],styles:[".warning[_ngcontent-%COMP%]{position:fixed;top:0;left:0;right:0;z-index:1002}"],changeDetection:0})}return n})();const Dd=["viewLoader"],Ld=["*"];let xd=(()=>{class n{constructor(t,i,o,s){this.renderer=t,this.viewService=i,this.mediaService=o,this.store=s,this.ngUnsubscribe=new z.B}handleClick(){this.renderer.addClass(this.viewLoaderRef.nativeElement,"view-loader--disappear"),this.viewService.toggleInteract(!1),this.store.selectSnapshot(fi.U.getPrefersReducedMotion)||this.viewService.playChapterFromStart();const t=this.store.selectSnapshot(f.Pf.getViewLanguage),i=this.store.selectSnapshot(b.N.getSelectedChapter);this.store.selectSnapshot(f.Pf.getPlaythroughEnabled)||this.mediaService.getChapterAudioPlayer(i,t).then(s=>{if(s){const a=this.store.selectSnapshot(b.N.getSelectedChapterId);this.mediaService.playChapterAudio(a)}})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(e.sFG),e.rXU(F.z),e.rXU(We.u),e.rXU(c.il))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-view-loader"]],viewQuery:function(i,o){if(1&i&&e.GBs(Dd,7),2&i){let s;e.mGM(s=e.lsd())&&(o.viewLoaderRef=s.first)}},ngContentSelectors:Ld,decls:4,vars:0,consts:[["viewLoader",""],["role","dialog",1,"view-loader"],["role","button",3,"click"]],template:function(i,o){if(1&i){const s=e.RV6();e.NAR(),e.j41(0,"div",1,0)(2,"div",2),e.bIt("click",function(){return e.eBV(s),e.Njj(o.handleClick())}),e.SdG(3),e.k0s()()}},encapsulation:2,changeDetection:0})}return n})();var $d=l(72760),kd=l(1580),Gd=l(65855);function Wd(n,_){if(1&n&&(e.j41(0,"p"),e.EFF(1),e.qex(2),e.pXf(3,0),e.bVm(),e.k0s()),2&n){const t=e.XpG(3);e.R7$(),e.SpI("",t.chapterCount()," ")}}function Xd(n,_){1&n&&(e.j41(0,"p"),e.pXf(1,1),e.k0s())}function Fd(n,_){if(1&n&&(e.j41(0,"div",7),e.DNE(1,Wd,4,1,"p")(2,Xd,2,0,"p"),e.k0s()),2&n){const t=e.XpG(2);e.R7$(),e.vxM(t.hasMultiChapter()?1:-1),e.R7$(),e.vxM(t.hasSkinVariants()?2:-1)}}function zd(n,_){1&n&&(e.qex(0),e.pXf(1,2),e.bVm())}function Bd(n,_){1&n&&(e.qex(0),e.pXf(1,3),e.bVm())}function jd(n,_){1&n&&(e.qex(0),e.pXf(1,4),e.bVm())}function Hd(n,_){if(1&n&&e.DNE(0,Bd,2,0,"ng-container")(1,jd,2,0,"ng-container"),2&n){const t=e.XpG(2);e.vxM(t.hasMultiChapter()?0:1)}}function Qd(n,_){if(1&n&&(e.j41(0,"h1",6),e.EFF(1),e.k0s(),e.DNE(2,Fd,3,2,"div",7),e.j41(3,"div",8),e.DNE(4,zd,2,0,"ng-container")(5,Hd,2,1),e.nrm(6,"app-icon",9),e.k0s()),2&n){let t;const i=e.XpG();e.R7$(),e.SpI(" ",i.story().displayName," "),e.R7$(),e.vxM(i.hasMultiChapter()||i.hasSkinVariants()?2:-1),e.R7$(2),e.vxM((t=i.selectedBookmarkViewMode())===i.bookmarkViewMode.Quiz?4:5)}}let n_=(()=>{class n{constructor(t){this.store=t,this.bookmarkViewMode=vi._,this.story=(0,h.ot)(this.store.select(Ce.t.getStory)),this.chapterCount=(0,h.ot)(this.store.select(b.N.getChapterCount)),this.selectedBookmarkViewMode=(0,h.ot)(this.store.select(Vt.J.getSelectedBookmarkViewMode)),this.skinVariant=(0,h.ot)(this.store.select(Ce.t.getVariantSchema("skin"))),this.hasSkinVariants=(0,e.EWP)(()=>!(0,V.isEmpty)(this.skinVariant())),this.hasMultiChapter=(0,e.EWP)(()=>this.chapterCount()>1)}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(c.il))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-summary-loader"]],decls:2,vars:1,consts:()=>{let t,i,o,s,a,r;return t=$localize`:␟b13403343605d44ebc315fb7b618d8d859410163␟306128254471360973:Interact in 3D`,i=$localize`:␟d904f74acb72356dd3547977ca3cf29d6da25946␟5096495468612049743:Chapters`,o=$localize`:␟39967f284caff71af5063e41259bb4968bff203b␟4142145898284245309:Skin Options Available`,s=$localize`:␟66a82c6638b304a349b7d43b13482fa7493419c9␟1556772664146095223:Take Quiz`,a=$localize`:␟2c55dafd02bed135add1986e10e77ae660728533␟2899734440722419896:Begin Interactive Tour`,r=$localize`:␟b13403343605d44ebc315fb7b618d8d859410163␟306128254471360973:Interact in 3D`,[i,o,s,a,r,["type","button","aria-label",t,1,"summary-loader"],[1,"text-2xl","font-bold"],[1,"summary-loader__sub-title"],[1,"summary-loader__cta"],["icon","arrow-right","appLogicalDir","",1,"ml-2"]]},template:function(i,o){1&i&&(e.j41(0,"button",5),e.DNE(1,Qd,7,3),e.k0s()),2&i&&(e.R7$(),e.vxM(o.story()?1:-1))},dependencies:[Ot.e,D.R],styles:['.button[_ngcontent-%COMP%]{font-size:.75rem;line-height:1rem;align-items:center;background:none;border-color:transparent;border-radius:4px;border-width:0;color:inherit;display:flex;font-family:Inter,sans-serif;justify-content:center;margin:0;outline:0 none;padding:0 16px;position:relative;text-align:center;text-decoration:none;transition:background-color .12s;width:100%}.button[_ngcontent-%COMP%]:not([disabled]):hover{cursor:pointer}.button[_ngcontent-%COMP%]:focus   .button--themed[_ngcontent-%COMP%]{outline:#2d72dc solid 2px!important}.button[_ngcontent-%COMP%]:after{content:" ";background-color:#283853;border-radius:4px;display:block;position:absolute;inset:0;opacity:0;z-index:1;transition:opacity .06s}.button[_ngcontent-%COMP%]:not(.button--disabled):hover:after{opacity:.7}.button__container[_ngcontent-%COMP%]{position:relative;z-index:2;width:100%}.button--uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.button--expanded[_ngcontent-%COMP%]{display:flex;flex:1}.button--xsmall[_ngcontent-%COMP%]{height:24px;min-width:24px;padding:0 8px;font-size:.625rem;line-height:.75rem}.button--small[_ngcontent-%COMP%]{height:32px;min-width:32px;padding:0 12px;font-size:.75rem;line-height:1rem}.button--medium[_ngcontent-%COMP%]{height:36px;min-width:36px;padding:0 16px;font-size:.75rem;line-height:1rem}.button--large[_ngcontent-%COMP%]{height:48px;min-width:48px;padding:0 16px;font-size:.875rem;line-height:1.25rem}.button--no-border[_ngcontent-%COMP%]{border-radius:0!important}.button--no-border[_ngcontent-%COMP%]:after{border-radius:0!important}.button--left[_ngcontent-%COMP%]{text-align:left}.button--themed[_ngcontent-%COMP%]{color:#374a68}.button--themed[_ngcontent-%COMP%]:hover{color:#1c2a3f}.button--themed[_ngcontent-%COMP%]:after{background-color:#d7e0ea}.button--dark[_ngcontent-%COMP%]{color:#d7e0ea}.button--dark[_ngcontent-%COMP%]:hover{color:#fff}.button--dark[_ngcontent-%COMP%]:after{background-color:#283853}.button--dark.button--flat[_ngcontent-%COMP%]{background:#374a68}.button--dark.button--default[_ngcontent-%COMP%]{background:transparent}.button--dark.button--outline[_ngcontent-%COMP%]{background:transparent;border:1px solid #374a68;transition:border-color .12s}.button--dark.button--outline[_ngcontent-%COMP%]:hover{border-color:#96a8c0}.button--dark.button--outline[_ngcontent-%COMP%]:hover:after{background-color:transparent;display:none}.button--dark.button--text[_ngcontent-%COMP%]{background:transparent;color:#d7e0ea}.button--dark.button--text[_ngcontent-%COMP%]:hover{color:#fff}.button--dark.button--text[_ngcontent-%COMP%]:hover:after{display:none}.button--dark.button--selected[_ngcontent-%COMP%]{background-color:#2d72dc;color:#fff}.button--dark.button--selected[_ngcontent-%COMP%]:hover:after{display:none}.button--light[_ngcontent-%COMP%]{color:#283853}.button--light[_ngcontent-%COMP%]:hover{color:#1c2a3f}.button--light[_ngcontent-%COMP%]:after{background-color:#96a8c0}.button--light[_ngcontent-%COMP%]:not(.button--disabled):hover:after{opacity:.6}.button--light.button--flat[_ngcontent-%COMP%]{background:#d7e0ea;font-weight:500}.button--light.button--flat.button--selected[_ngcontent-%COMP%]{background-color:#96a8c0}.button--light.button--default[_ngcontent-%COMP%]{background:transparent;color:#131c2a}.button--light.button--default[_ngcontent-%COMP%]:not(.button--disabled):hover:after{opacity:.2}.button--light.button--outline[_ngcontent-%COMP%]{background:transparent;border:1px solid #96a8c0;color:#283853;transition:border-color .12s}.button--light.button--outline[_ngcontent-%COMP%]:after{display:none}.button--light.button--outline[_ngcontent-%COMP%]:hover{background:#374a680d;border-color:#374a68;color:#1c2a3f}.button--light.button--outline[_ngcontent-%COMP%]:hover:after{background-color:transparent}.button--light.button--selected[_ngcontent-%COMP%]{background-color:#eaeff5}.button--light.button--selected[_ngcontent-%COMP%]:hover:after{display:none}.button--light.button--text[_ngcontent-%COMP%]{color:#283853}.button--light.button--text[_ngcontent-%COMP%]:hover{color:#1c2a3f}.button--light.button--text[_ngcontent-%COMP%]:hover:after{display:none}.button--primary[_ngcontent-%COMP%]{background:#de3535;color:#fff}.button--primary[_ngcontent-%COMP%]:after{background:#f9fafd}.button--primary[_ngcontent-%COMP%]:not([disabled]):hover:after{opacity:.1}.button--info[_ngcontent-%COMP%]{background:#3892dc;color:#fff}.button--info[_ngcontent-%COMP%]:after{background:#f9fafd}.button--info[_ngcontent-%COMP%]:hover:after{opacity:.1}.button--selected[_ngcontent-%COMP%]{background-color:#2d72dc}.button--disabled[_ngcontent-%COMP%]{opacity:.5}.button--circle[_ngcontent-%COMP%]{border-radius:50%}.button--circle.button--xsmall[_ngcontent-%COMP%]{width:24px}.button--circle.button--small[_ngcontent-%COMP%]{width:32px;padding:0 6px}.button--circle.button--medium[_ngcontent-%COMP%]{width:36px;padding:0 8px}.button--circle.button--large[_ngcontent-%COMP%]{width:48px}.button--circle[_ngcontent-%COMP%]:after{border-radius:50%}.button--rounded[_ngcontent-%COMP%]{border-radius:18px}.button--rounded[_ngcontent-%COMP%]:after{border-radius:18px}.summary-loader[_ngcontent-%COMP%]{border-color:transparent;background:none;border-width:0;outline:none;margin:0;pointer-events:all;background:#0006108c;position:fixed;justify-content:center;align-items:center;inset:0;width:100%;height:100%;transition:background-color .25s,opacity .25s;z-index:10000;position:absolute;padding:36px;color:#fff;display:flex;justify-content:flex-start;align-items:flex-start;flex-direction:column;gap:8px}.summary-loader[_ngcontent-%COMP%]::-moz-focus-inner{border:0}.summary-loader[_ngcontent-%COMP%]:not([disabled]):hover{cursor:pointer}.summary-loader[_ngcontent-%COMP%]:hover{opacity:1;cursor:pointer;background:#000610b3}.summary-loader[_ngcontent-%COMP%]:hover   .summary-loader__cta[_ngcontent-%COMP%]{background-color:#2d72dc;border-color:#2d72dc}.summary-loader__title[_ngcontent-%COMP%]{font-size:24px;line-height:1.33em;font-weight:700}.summary-loader__sub-title[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:wrap;font-size:16px;line-height:1.25em;letter-spacing:.02em;text-align:left;gap:8px}.summary-loader__sub-title[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:not(:first-child){padding-left:8px;border-left:2px solid #ffffff}.summary-loader__cta[_ngcontent-%COMP%]{width:220px;height:48px;border:1px solid #ffffff;border-radius:4px;margin-top:20px;font-weight:600px;font-size:16px;display:flex;justify-content:center;align-items:center;transition:all .25s ease-in-out}'],changeDetection:0})}return n})();function Kd(n,_){1&n&&e.nrm(0,"app-play-loader")}function Zd(n,_){1&n&&e.nrm(0,"app-button-loader")}function Jd(n,_){1&n&&e.nrm(0,"app-hand-loader")}function ep(n,_){1&n&&e.nrm(0,"app-summary-loader")}function tp(n,_){1&n&&e.nrm(0,"div",7)}class $i{constructor(_,t,i,o){this.changeRef=_,this.viewService=t,this.bookmarksService=i,this.imagesService=o,this.thumbnailURL="",this.interactionType=Gd.i}ngOnInit(){this.setThumbnailUrl()}handleClick(){this.viewService.toggleOnDemand(!1),this.viewService.toggleInteract(!1)}setThumbnailUrl(){this.contentType===Ci.c.Bookmark?this.bookmarksService.getBookmarkModel(this.contentId).subscribe(_=>{this.thumbnailURL=_.thumbnail_url,this.changeRef.markForCheck()}):(this.thumbnailURL=this.imagesService.getIndexThumbnail(this.contentId),this.changeRef.markForCheck())}getPoweredByUrl(){return(typeof localBaseDirectory>"u"?"":localBaseDirectory)+"assets/images/powered-by-biodigital-logo.svg"}static#e=this.\u0275fac=function(t){return new(t||$i)(e.rXU(e.gRc),e.rXU(F.z),e.rXU($d.x),e.rXU(kd.M))};static#t=this.\u0275cmp=e.VBU({type:$i,selectors:[["app-view-ondemand"]],inputs:{contentId:"contentId",contentType:"contentType"},decls:11,vars:10,consts:[[1,"ondemand",3,"click"],[1,"ondemand__image",3,"lazyLoad"],[3,"ngSwitch"],[4,"ngSwitchCase"],["class","ondemand__blank-overlay",4,"ngSwitchCase"],[1,"ondemand__logo"],[3,"src"],[1,"ondemand__blank-overlay"]],template:function(t,i){1&t&&(e.j41(0,"div",0),e.bIt("click",function(){return i.handleClick()}),e.nrm(1,"div",1),e.j41(2,"div",2),e.nI1(3,"async"),e.DNE(4,Kd,1,0,"app-play-loader",3)(5,Zd,1,0,"app-button-loader",3)(6,Jd,1,0,"app-hand-loader",3)(7,ep,1,0,"app-summary-loader",3)(8,tp,1,0,"div",4),e.k0s(),e.j41(9,"div",5),e.nrm(10,"img",6),e.k0s()()),2&t&&(e.R7$(),e.Y8G("lazyLoad",i.thumbnailURL),e.R7$(),e.Y8G("ngSwitch",e.bMT(3,8,i.interactType$)),e.R7$(2),e.Y8G("ngSwitchCase",i.interactionType.Play),e.R7$(),e.Y8G("ngSwitchCase",i.interactionType.Button),e.R7$(),e.Y8G("ngSwitchCase",i.interactionType.Hand),e.R7$(),e.Y8G("ngSwitchCase",i.interactionType.Summary),e.R7$(),e.Y8G("ngSwitchCase",i.interactionType.None),e.R7$(2),e.Y8G("src",i.getPoweredByUrl(),e.B4B))},dependencies:[p.ux,p.e1,ne.Je,Uo,Vo,Do,n_,p.Jj],styles:[".ondemand__blank-overlay[_ngcontent-%COMP%]{background:#0003;display:flex;position:fixed;justify-content:center;align-items:center;inset:0;width:100%;height:100%;transition:background-color .25s,opacity .25s;z-index:10000}.ondemand__blank-overlay[_ngcontent-%COMP%]:hover{opacity:1;cursor:pointer;background:#0003}.ondemand__image[_ngcontent-%COMP%]{position:absolute;inset:0;background-size:cover;background-repeat:no-repeat;background-position:center center;filter:blur(6px);z-index:1000}.ondemand__logo[_ngcontent-%COMP%]{position:absolute;bottom:40px;justify-content:center;width:100%;z-index:20000;display:flex}"],changeDetection:0})}!function(n,_,t,i){var a,o=arguments.length,s=o<3?_:null===i?i=Object.getOwnPropertyDescriptor(_,t):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(n,_,t,i);else for(var r=n.length-1;r>=0;r--)(a=n[r])&&(s=(o<3?a(s):o>3?a(_,t,s):a(_,t))||s);o>3&&s&&Object.defineProperty(_,t,s)}([(0,c.l6)(f.Pf.getInteractType),function(n,_){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata("design:type",_)}(0,d.c)],$i.prototype,"interactType$",void 0);class ki{beforePrint(_){this.visible=!0,this.changeDetectorRef.markForCheck()}afterPrint(_){this.visible=!1,this.changeDetectorRef.markForCheck()}constructor(_,t){this.store=_,this.changeDetectorRef=t,this.ngUnsubscribe=new z.B,this.visible=!1}ngOnInit(){this.initImageUrlListener()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initImageUrlListener(){(0,de.z)(this.storyChapters$,this.store.select(Ji.K.getRegisteredThumbnails)).pipe((0,M.p)(([_,t])=>_.length>0&&t.size>0),(0,ve.T)(([_,t])=>t.get(_[0].id).urls.large),(0,J.F)(),(0,g.Q)(this.ngUnsubscribe)).subscribe(_=>{this.imageUrl=_,this.changeDetectorRef.markForCheck()})}static#e=this.\u0275fac=function(t){return new(t||ki)(e.rXU(c.il),e.rXU(e.gRc))};static#t=this.\u0275cmp=e.VBU({type:ki,selectors:[["app-view-print"]],hostBindings:function(t,i){1&t&&e.bIt("beforeprint",function(){return i.beforePrint()},!1,e.tSv)("afterprint",function(){return i.afterPrint()},!1,e.tSv)},decls:3,vars:1,consts:[[1,"view-print"],["src","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=",1,"view-print__scrim"],[1,"view-print__image",3,"src"]],template:function(t,i){1&t&&(e.j41(0,"div",0),e.nrm(1,"img",1)(2,"img",2),e.k0s()),2&t&&(e.R7$(2),e.Y8G("src",i.imageUrl,e.B4B))},styles:[".view-print[_ngcontent-%COMP%]{background-color:#fff;display:none;position:absolute;top:0;left:0;width:100%;height:100%;z-index:10000;justify-content:space-around;margin:auto;margin-top:0!important}@media print{.view-print[_ngcontent-%COMP%]{display:flex}}.view-print__scrim[_ngcontent-%COMP%]{display:block;width:100%;height:100%;position:absolute;z-index:-1;inset:0}.view-print__image[_ngcontent-%COMP%]{display:block;flex:1 1 auto;object-fit:contain;margin:0 auto;z-index:1}"],changeDetection:0})}!function(n,_,t,i){var a,o=arguments.length,s=o<3?_:null===i?i=Object.getOwnPropertyDescriptor(_,t):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(n,_,t,i);else for(var r=n.length-1;r>=0;r--)(a=n[r])&&(s=(o<3?a(s):o>3?a(_,t,s):a(_,t))||s);o>3&&s&&Object.defineProperty(_,t,s)}([(0,c.l6)(b.N.getStoryChapters),function(n,_){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata("design:type",_)}(0,d.c)],ki.prototype,"storyChapters$",void 0);const op=["circle"],_p=["progressCircle"],sp=["progressContainer"],ap=n=>({"view-progress--active":n}),rp=n=>({"view-progress__ring--pulse":n});function lp(n,_){if(1&n&&(e.j41(0,"div",9),e.EFF(1),e.k0s()),2&n){const t=e.XpG();e.R7$(),e.SpI("",t.percent,"%")}}let cp=(()=>{class n{get show(){return this._show}set show(t){setTimeout(()=>{this._show=t,this.changeDetectorRef.markForCheck()})}get percent(){return Math.floor(this._percent.value)}set percent(t){null!=t&&this._percent.next(t)}constructor(t,i){this.renderer=t,this.changeDetectorRef=i,this.ngUnsubscribe=new z.B,this.label=$localize`Loading...`,this._show=!1,this._percent=new xe.t(0)}ngOnInit(){this.initSizeObserver()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}ngAfterViewInit(){this.updateDimensions(),this.initPercentObserver()}initPercentObserver(){this._percent.pipe((0,g.Q)(this.ngUnsubscribe)).subscribe(()=>{this.label=this.getLoadingLabel(this.percent),this.renderProgress(0===this.percent?100:this.percent),this.changeDetectorRef.markForCheck()})}initSizeObserver(){(0,ye.R)(window,"resize").pipe((0,Re.B)(10),(0,g.Q)(this.ngUnsubscribe)).subscribe(()=>{this.updateDimensions()})}calculateRadius(){return this.getCircleWidth()/2}getCircleWidth(){return this.circleRef.nativeElement.offsetWidth}getRadius(){return this.progressCircleRef.nativeElement.r.baseVal.value}getCircumference(){return 2*this.getRadius()*Math.PI}getOffset(t=100){const i=this.getCircumference();return i-t/100*i}renderProgress(t){t>=100&&(t=100);const i=this.getCircumference(),o=this.getOffset(t);this.renderer.setStyle(this.progressCircleRef.nativeElement,"strokeDasharray",`${i} ${i}`),this.renderer.setStyle(this.progressCircleRef.nativeElement,"strokeDashoffset",`${o}`)}getLoadingLabel(t){return 100===t?$localize`Launching...`:$localize`Loading...`}updateDimensions(){const t=this.calculateRadius();this.renderer.setAttribute(this.progressContainerRef.nativeElement,"width",""+2*t),this.renderer.setAttribute(this.progressContainerRef.nativeElement,"height",""+2*t),this.renderer.setAttribute(this.progressCircleRef.nativeElement,"r",""+(t-6)),this.renderer.setAttribute(this.progressCircleRef.nativeElement,"cx",`${t}`),this.renderer.setAttribute(this.progressCircleRef.nativeElement,"cy",`${t}`);const i=this.getCircumference();this.renderer.setStyle(this.progressCircleRef.nativeElement,"strokeDasharray",`${i} ${i}`),this.renderer.setStyle(this.progressCircleRef.nativeElement,"strokeDashoffset",`${i}`)}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(e.sFG),e.rXU(e.gRc))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-view-progress"]],viewQuery:function(i,o){if(1&i&&(e.GBs(op,7),e.GBs(_p,7),e.GBs(sp,7)),2&i){let s;e.mGM(s=e.lsd())&&(o.circleRef=s.first),e.mGM(s=e.lsd())&&(o.progressCircleRef=s.first),e.mGM(s=e.lsd())&&(o.progressContainerRef=s.first)}},inputs:{show:"show",percent:"percent"},decls:10,vars:10,consts:[["circle",""],["progressContainer",""],["progressCircle",""],["data-test","viewProgress","role","status","aria-live","polite",1,"view-progress",3,"ngClass"],["aria-hidden","true",1,"view-progress__circle"],[1,"view-progress__ring",3,"ngClass"],[1,"view-progress__ring-inner"],["class","view-progress__count",4,"ngIf"],[1,"view-progress__label"],[1,"view-progress__count"]],template:function(i,o){1&i&&(e.j41(0,"div",3)(1,"div",4,0),e.qSk(),e.j41(3,"svg",5,1),e.nrm(5,"circle",6,2),e.k0s(),e.DNE(7,lp,2,1,"div",7),e.joV(),e.j41(8,"div",8),e.EFF(9),e.k0s()()()),2&i&&(e.Y8G("ngClass",e.eq3(6,ap,o.show)),e.BMQ("aria-busy",o.show),e.R7$(),e.Y8G("@isOpen",o.show?"open":"closed"),e.R7$(2),e.Y8G("ngClass",e.eq3(8,rp,0===o.percent||100===o.percent)),e.R7$(4),e.Y8G("ngIf",o.percent>0&&o.percent<100),e.R7$(2),e.SpI(" ",o.label," "))},dependencies:[p.YU,p.bT],styles:[".view-progress[_ngcontent-%COMP%]{--circleSize: 35vw;pointer-events:none;position:absolute;display:flex;justify-content:center;align-items:center;inset:0;z-index:1000;transition:background-color .15s}@keyframes _ngcontent-%COMP%_progressPulse{0%{stroke-width:4}50%{stroke-width:1}to{stroke-width:4}}.view-progress--active[_ngcontent-%COMP%]{background-color:#0003}.view-progress__circle[_ngcontent-%COMP%]{transform:scale(0);width:var(--circleSize);height:var(--circleSize);border-radius:50%;background-color:#101823cc;display:flex;flex-direction:column;align-items:center;justify-content:center;position:relative}.view-progress__count[_ngcontent-%COMP%]{font-size:1.125rem;line-height:1.75rem;color:#fff;font-weight:700}.view-progress__label[_ngcontent-%COMP%]{font-size:.75rem;line-height:1rem;color:#fffc}.view-progress__ring[_ngcontent-%COMP%]{position:absolute;inset:0;z-index:3;opacity:1;stroke-dashoffset:0;stroke-width:4;stroke:#fffc;fill:transparent;transform:rotate(-90deg)}.view-progress__ring--pulse[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_progressPulse ease-in-out infinite 2s}@media (min-width: 600px){.view-progress__circle[_ngcontent-%COMP%]{width:160px;height:160px}}"],data:{animation:[(0,x.hZ)("isOpen",[(0,x.wk)("open",(0,x.iF)({transform:"scale(1)"})),(0,x.wk)("closed",(0,x.iF)({transform:"scale(0)"})),(0,x.kY)("closed => open",[(0,x.i0)("300ms ease-out")]),(0,x.kY)("open => closed",[(0,x.i0)("150ms ease-in")])])]},changeDetection:0})}return n})();var Gi=l(35160),dp=l(82542),pp=l(37737);let up=(()=>{class n{constructor(){}onClick(t,i){i.select()}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275dir=e.FsC({type:n,selectors:[["","appSelectOnFocus",""]],hostBindings:function(i,o){1&i&&e.bIt("click",function(a){return o.onClick(a,a.target)})}})}return n})();var hp=l(30356),hi=function(n,_,t,i){var a,o=arguments.length,s=o<3?_:null===i?i=Object.getOwnPropertyDescriptor(_,t):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(n,_,t,i);else for(var r=n.length-1;r>=0;r--)(a=n[r])&&(s=(o<3?a(s):o>3?a(_,t,s):a(_,t))||s);return o>3&&s&&Object.defineProperty(_,t,s),s},gi=function(n,_){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(n,_)};const gp=["searchInput"],Ep=["tabButton"],o_=n=>({"view-search__action--selected":n});class lt{constructor(_,t,i){this.viewService=_,this.store=t,this.elementRef=i,this.application=ce.c,this.ngUnsubscribe=new z.B,this.themeEnum=dp.P,this.treeSearchDisplayMode=ut.q}handleKeyPress(){this.viewService.elementHasFocus(this.elementRef.nativeElement)&&!this.viewService.isMaterialMenuOut()&&this.close()}ngOnInit(){this.initSearchForm()}ngAfterViewInit(){this.initDisplayModeSubscription()}initDisplayModeSubscription(){this.searchDisplayMode$.pipe((0,g.Q)(this.ngUnsubscribe)).subscribe(_=>{setTimeout(()=>{this.searchInput.nativeElement.focus()})})}initSearchForm(){this.searchForm=new Z.gE({query:new Z.MJ("")});const _=this.searchForm.controls.query;this.searchQuery$=_.valueChanges.pipe((0,Gi.Z)(_.value),(0,g.Q)(this.ngUnsubscribe))}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}toggleDisplayMode(){let _=this.store.selectSnapshot(f.Pf.getSearchDisplayMode);_=_===ut.q.List?ut.q.Tree:ut.q.List,this.setDisplayMode(_)}setDisplayMode(_){this.store.dispatch(new Q.B.SetSearchDisplayMode(_))}handleTreeButtonClick(){this.setDisplayMode(ut.q.Tree)}handleListButtonClick(){this.setDisplayMode(ut.q.List)}getActiveTab(){switch(this.store.selectSnapshot(f.Pf.getSearchDisplayMode)){case ut.q.List:return"searchTab";case ut.q.Tree:return"treeTab";default:return null}}shiftFocus(_,t){_.stopPropagation();const i=this._buttonRefs.toArray(),s=(i.findIndex(a=>a.nativeElement==document.activeElement)+t+i.length)%i.length;i[s].nativeElement.focus()}close(){this.searchForm.patchValue({query:""}),this.viewService.toggleSearch(null,!1)}static#e=this.\u0275fac=function(t){return new(t||lt)(e.rXU(F.z),e.rXU(c.il),e.rXU(e.aKT))};static#t=this.\u0275cmp=e.VBU({type:lt,selectors:[["app-view-search"]],viewQuery:function(t,i){if(1&t&&(e.GBs(gp,5),e.GBs(Ep,5)),2&t){let o;e.mGM(o=e.lsd())&&(i.searchInput=o.first),e.mGM(o=e.lsd())&&(i._buttonRefs=o)}},hostBindings:function(t,i){1&t&&e.bIt("keydown.escape",function(){return i.handleKeyPress()},!1,e.EBC)},decls:31,vars:47,consts:()=>{let _,t,i,o;return _=$localize`:␟4c4305eb340456e2e50f1eb70a8061a4e63fc352␟1130690042989597231:Start typing the search term, then use tab to navigate the results`,t=$localize`:␟8f62b63665181ac3c3afe409d6d76530ef267bc1␟1644955292665662544:Search for a structure`,i=$localize`:␟6490b3960cc7c4a789cdbd29575d93abad081e07␟7906458871395232033:List`,o=$localize`:␟979a2479fa31a7c56e45cf33c4d29dbda0b3ace3␟5139118152626940877:Tree`,[["searchInput",""],["tabButton",""],i,o,["role","dialog","cdkTrapFocus","",1,"view-search"],[1,"view-search__header",3,"formGroup"],[1,"view-search__input-row",3,"formGroup"],[1,"view-search__input-container"],["icon","search",1,"view-search__input-icon"],["appAutoFocus","","appSelectOnFocus","","type","search","aria-label",_,"placeholder",t,"formControlName","query",1,"view-search__input"],[1,"view-search__actions-row"],["role","tablist",1,"view-search__actions",3,"keydown.arrowleft","keydown.arrowright"],["type","button","role","tab","id","searchTab",1,"view-search__action",3,"click","keyup.space","ngClass"],["type","button","role","tab","id","treeTab",1,"view-search__action",3,"click","keyup.space","ngClass"],["role","tabpanel",1,"mt-3","view-search__body"],[3,"displayMode","theme","query","viewGraph","viewGraphMetadata","viewGraphRank","selectedChapter","layerOrderMode","showTreeNodeIds","showLatinLabel"]]},template:function(t,i){if(1&t){const o=e.RV6();e.j41(0,"div",4)(1,"div",5)(2,"div",6)(3,"div",7),e.nrm(4,"app-icon",8)(5,"input",9,0),e.k0s()(),e.j41(7,"div",10)(8,"div",11),e.bIt("keydown.arrowleft",function(a){return e.eBV(o),e.Njj(i.shiftFocus(a,-1))})("keydown.arrowright",function(a){return e.eBV(o),e.Njj(i.shiftFocus(a,1))}),e.j41(9,"button",12,1),e.nI1(11,"async"),e.nI1(12,"async"),e.nI1(13,"async"),e.bIt("click",function(){return e.eBV(o),e.Njj(i.handleListButtonClick())})("keyup.space",function(){return e.eBV(o),e.Njj(i.handleListButtonClick())}),e.qex(14),e.pXf(15,2),e.bVm(),e.k0s(),e.j41(16,"button",13,1),e.nI1(18,"async"),e.nI1(19,"async"),e.nI1(20,"async"),e.bIt("click",function(){return e.eBV(o),e.Njj(i.handleTreeButtonClick())})("keyup.space",function(){return e.eBV(o),e.Njj(i.handleTreeButtonClick())}),e.qex(21),e.pXf(22,3),e.bVm(),e.k0s()()()(),e.j41(23,"div",14),e.nrm(24,"app-tree-search",15),e.nI1(25,"async"),e.nI1(26,"async"),e.nI1(27,"async"),e.nI1(28,"async"),e.nI1(29,"async"),e.nI1(30,"async"),e.k0s()()}2&t&&(e.R7$(),e.Y8G("formGroup",i.searchForm),e.R7$(),e.Y8G("formGroup",i.searchForm),e.R7$(7),e.Y8G("ngClass",e.eq3(43,o_,e.bMT(11,19,i.searchDisplayMode$)===i.treeSearchDisplayMode.List)),e.BMQ("aria-selected",e.bMT(12,21,i.searchDisplayMode$)===i.treeSearchDisplayMode.List)("tabIndex",e.bMT(13,23,i.searchDisplayMode$)===i.treeSearchDisplayMode.List?0:-1),e.R7$(7),e.Y8G("ngClass",e.eq3(45,o_,e.bMT(18,25,i.searchDisplayMode$)===i.treeSearchDisplayMode.Tree)),e.BMQ("aria-selected",e.bMT(19,27,i.searchDisplayMode$)===i.treeSearchDisplayMode.Tree)("tabIndex",e.bMT(20,29,i.searchDisplayMode$)===i.treeSearchDisplayMode.Tree?0:-1),e.R7$(7),e.BMQ("aria-labelledby",i.getActiveTab()),e.R7$(),e.Y8G("displayMode",e.bMT(25,31,i.searchDisplayMode$))("theme",i.themeEnum.Light)("query",e.bMT(26,33,i.searchQuery$))("viewGraph",e.bMT(27,35,i.treeGraph$))("viewGraphMetadata",e.bMT(28,37,i.viewGraphMetadata$))("viewGraphRank",e.bMT(29,39,i.viewGraphRank$))("selectedChapter",e.bMT(30,41,i.selectedChapter$))("layerOrderMode",!1)("showTreeNodeIds",!1)("showLatinLabel",!0))},dependencies:[k.kB,p.YU,pp.B,up,Z.me,Z.BC,Z.cb,D.R,Z.j4,Z.JD,hp.k,p.Jj],styles:[".view-search{display:flex;flex-direction:column;height:100%}@keyframes appear{0%{background-color:transparent}}.view-search__header{flex:0 0 auto;flex-direction:column;display:flex;animation:appear .25s ease-out}.view-search__actions-row{flex:0 0 auto;display:flex;align-items:center}.view-search__actions{display:flex;height:48px;flex:1;justify-content:space-between}.view-search__action{font-size:.625rem;line-height:.75rem;text-transform:uppercase;align-items:center;background:transparent;border:none;border-bottom:2px solid transparent;color:#374a68;display:flex;flex-direction:column;flex:1;justify-content:flex-end;padding-bottom:8px;transition:all .3s ease-in-out;cursor:pointer}.view-search__action:hover:not(.view-search__action--selected){border-bottom-color:#f9fafd}.view-search__action--selected{border-bottom-color:#2d72dc;font-weight:600}.view-search__input-row{flex:0 0 auto;display:flex;padding:24px 0 0}.view-search__input-container{background-color:#fff;border:1px solid #96a8c0;display:flex;flex-grow:1;border-radius:4px}.view-search__input-container:hover{border-color:#61779e}.view-search__input-container:focus-within{outline:#2d72dc solid 2px!important;outline-offset:-2px}.view-search__input-icon{background:0 0;display:flex;align-items:center;justify-content:center;color:#61779e;width:36px;height:36px;outline:0}.view-search__input{font-size:.875rem;line-height:1.25rem;font-weight:400;color:#131c2a;background:transparent;border:1px solid transparent;outline:none;flex:1 0 auto;padding:8px 12px 8px 0}.view-search__input::-ms-clear{display:none}.view-search__input::placeholder{color:#61779e;opacity:1}.view-search__body{flex:1 1 100%}@media not all and (min-resolution: .001dpcm){@supports (-webkit-appearance: none){.view-search__input{font-size:16px;padding:4px 8px;width:0}}}\n"],encapsulation:2,changeDetection:0})}hi([(0,c.l6)(te.S.getViewGraph),gi("design:type",d.c)],lt.prototype,"viewGraph$",void 0),hi([(0,c.l6)(te.S.getTreeGraph),gi("design:type",d.c)],lt.prototype,"treeGraph$",void 0),hi([(0,c.l6)(te.S.getViewGraphMetadata),gi("design:type",d.c)],lt.prototype,"viewGraphMetadata$",void 0),hi([(0,c.l6)(te.S.getViewGraphRank),gi("design:type",d.c)],lt.prototype,"viewGraphRank$",void 0),hi([(0,c.l6)(f.Pf.getSearchDisplayMode),gi("design:type",d.c)],lt.prototype,"searchDisplayMode$",void 0),hi([(0,c.l6)(b.N.getSelectedChapter),gi("design:type",d.c)],lt.prototype,"selectedChapter$",void 0);const Sp=["app-view-rounded-button",""];function mp(n,_){if(1&n&&e.nrm(0,"app-icon",3),2&n){const t=e.XpG();e.Y8G("icon",t.icon)}}let fp=(()=>{class n{constructor(){this.iconPlacement="left",this.compact=!1,this.buttonType="outline"}ngOnInit(){}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["button","app-view-rounded-button",""]],inputs:{icon:"icon",iconPlacement:"iconPlacement",label:"label",compact:"compact",buttonType:"buttonType",shadow:"shadow"},attrs:Sp,decls:4,vars:12,consts:[[1,"view-rounded-button"],["class","view-rounded-button__icon mx-1",3,"icon",4,"ngIf"],[1,"view-rounded-button__label","mx-1"],[1,"view-rounded-button__icon","mx-1",3,"icon"]],template:function(i,o){1&i&&(e.j41(0,"div",0),e.DNE(1,mp,1,1,"app-icon",1),e.j41(2,"div",2),e.EFF(3),e.k0s()()),2&i&&(e.AVh("view-rounded-button--outline","outline"===o.buttonType)("view-rounded-button--solid","solid"===o.buttonType)("view-rounded-button--shadow",o.shadow)("view-rounded-button--compact",o.compact)("view-rounded-button--reverse","right"===o.iconPlacement),e.R7$(),e.Y8G("ngIf",o.icon),e.R7$(2),e.JRh(o.label))},dependencies:[p.bT,D.R],styles:["button[app-view-rounded-button]{border-color:transparent;background:none;border-width:0;padding:0;outline:none;margin:0;pointer-events:all}button[app-view-rounded-button]:hover .view-rounded-button,button[app-view-rounded-button]:focus .view-rounded-button{color:#f9fafd;border-color:#f9fafd;background:#f9fafd40}button[app-view-rounded-button]:hover .view-rounded-button--solid,button[app-view-rounded-button]:focus .view-rounded-button--solid{border-color:#f9fafd40}.view-rounded-button{cursor:pointer;display:flex;flex-direction:row;align-items:center;justify-content:center;padding:12px 16px;border-style:solid;border-width:1px;border-radius:24px;color:#f9fafd;border-color:#f9fafd}.view-rounded-button__label{font-size:1rem;line-height:1.5rem}.view-rounded-button--solid{color:#060502;border-color:#060502;background:#f9fafd}.view-rounded-button--shadow{box-shadow:0 0 8px #00000052}.view-rounded-button--reverse{flex-direction:row-reverse}.view-rounded-button--compact{padding:4px 8px}\n"],encapsulation:2,changeDetection:0})}return n})();var Xt=function(n){return n.CameraZoom="camera-zoom",n.CameraRotate="camera-rotate",n.CameraPan="camera-pan",n.NodeSelection="node-selection",n}(Xt||{}),Tp=l(13878),bp=l(3266),Ft=l(38472),vp=l(3829);function __(n,_,t=1e3,i=.001){return jn(n).pipe((0,Gi.Z)(_.getCameraZoom()),(0,ve.T)(()=>_.getCameraZoom()),(0,si.J)(),(0,ve.T)(([o,s])=>s-o),(0,M.p)(o=>Math.abs(o)>i),(0,Re.B)(t))}function s_(n,_,t=125){return jn(n).pipe((0,Gi.Z)(_.getLookDirection()),(0,ve.T)(()=>_.getLookDirection()),(0,si.J)(),(0,ve.T)(([i,o])=>function yp(n,_){return Ft.angle(n,_)>.001}(i,o)),(0,M.p)(i=>i),(0,Re.B)(t))}function a_(n){return{camera:n.getCamera(),zoom:n.getCameraZoom()}}function jn(n){return n.getEvent($t.X.CameraRested)}function r_(n){const{eye:_,look:t}=n,i=Ft.fromValues(_.x,_.y,_.z),o=Ft.fromValues(t.x,t.y,t.z),s=Ft.create();return Ft.sub(s,i,o),s}var Rp=l(15210),l_=l(66196),Pp=l(81954),Up=l(19827),Dp=l(19833),Lp=l(46799);const xp=["*",[["","slide-footer",""]]],$p=["*","[slide-footer]"];function kp(n,_){if(1&n&&(e.j41(0,"h2",6),e.EFF(1),e.k0s()),2&n){const t=e.XpG(2);e.R7$(),e.SpI(" ",t.title," ")}}function Gp(n,_){if(1&n&&e.nrm(0,"img",7),2&n){const t=e.XpG(2);e.Y8G("src",t.image,e.B4B)("alt",t.alt)}}function Wp(n,_){if(1&n&&(e.j41(0,"div",1),e.DNE(1,kp,2,1,"h2",2),e.j41(2,"article",3),e.SdG(3),e.k0s(),e.DNE(4,Gp,1,2,"img",4),e.j41(5,"div",5),e.SdG(6,1),e.k0s()()),2&n){const t=e.XpG();e.AVh("slide--expanded","expanded"===t.spacing),e.Y8G("@refresh",void 0),e.R7$(),e.Y8G("ngIf",t.title),e.R7$(3),e.Y8G("ngIf",t.image)}}let Hn=(()=>{class n{set shown(t){this._shown=t,this.initTrigger(),this.changeRef.markForCheck()}get shown(){return this._shown}constructor(t,i,o,s,a,r){this.store=t,this.actions=i,this.engineService=o,this.cameraService=s,this.engineRendererService=a,this.changeRef=r,this.alt="",this.spacing="compact",this.exitEnabled=!0,this.triggerDelay=300,this.triggerComplete=new e.bkB,this._shown=!1,this.ngUnsubscribe=new z.B}ngOnInit(){}ngAfterViewInit(){this.initTrigger()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initTrigger(){if(this.ngUnsubscribe.next(),this.shown&&this.trigger){const t=this.resetCamera(),i=this.store.selectSnapshot(f.Pf.getCanTouch);(function Op(n,_,t,i,o,s){switch(n){case Xt.CameraZoom:return s?__(t,i):function Cp(n,_,t,i=1e3,o=.001){const s=t.getCanvas(),a=(0,ye.R)(s,"wheel"),r=(0,ye.R)(s,"touchmove").pipe((0,M.p)(m=>2===m.touches.length)),u=__(n,_,i,o);return(0,oi.h)(a,r).pipe((0,Gt.Z)(()=>u))}(t,i,o);case Xt.CameraPan:return function wp(n,_,t,i=125){const o=t.getCanvas(),s=(0,ye.R)(o,"mousemove").pipe((0,M.p)(u=>1===u.buttons&&u.shiftKey||2===u.buttons||4===u.buttons)),a=(0,ye.R)(o,"touchmove").pipe((0,M.p)(u=>2===u.touches.length)),r=function Mp(n,_,t=125){return jn(n).pipe((0,Gi.Z)(a_(_)),(0,ve.T)(()=>a_(_)),(0,Re.B)(t),(0,si.J)(),(0,ve.T)(([i,o])=>function Np(n,_){const o=r_(n.camera),s=r_(_.camera),a=Ft.create();Ft.sub(a,o,s);const r=a.reduce((m,v)=>m+v),u=_.zoom-n.zoom;return(0!==u||0!==r)&&Math.abs(r)<1&&Math.abs(u)<.001}(i,o)),(0,M.p)(i=>i))}(n,_,i);return(0,oi.h)(s,a).pipe((0,Gt.Z)(()=>r))}(t,i,o);case Xt.CameraRotate:return s?s_(t,i):function Ip(n,_,t,i,o=1e3){const s=i.getCanvas(),a=(0,ye.R)(s,"mousemove").pipe((0,M.p)(m=>1===m.buttons)),r=(0,ye.R)(s,"touchmove").pipe((0,M.p)(m=>1===m.touches.length)),u=s_(_,t,o);return(0,oi.h)(a,r).pipe((0,Gt.Z)(()=>u),(0,M.p)(()=>"rotate"===n.selectSnapshot(vp.x.getPanMode)),(0,Re.B)(125))}(_,t,i,o);case Xt.NodeSelection:return function Ap(n){return n.select(xt.z.getCheckedNodes).pipe((0,si.J)(),(0,M.p)(([,_])=>_.length>0))}(_)}})(this.trigger,this.store,this.engineService,this.cameraService,this.engineRendererService,i).pipe(function Vp(n){return(0,Rp.N)((_,t)=>{let i=!1;const o=(0,l_._)(t,()=>{o?.unsubscribe(),i=!0},Up.l);(0,Pp.Tg)(n).subscribe(o),_.subscribe((0,l_._)(t,s=>i&&t.next(s)))})}(t),(0,Dp.c)(this.triggerDelay),(0,g.Q)(this.ngUnsubscribe)).subscribe(()=>{this.triggerComplete.next()})}}resetCamera(){const i=this.store.selectSnapshot(b.N.getSelectedChapter)?.camera?.location;return(0,V.isNil)(i)?(0,Vi.of)(void 0):this.store.dispatch(new hn.Ih(i,!0)).pipe((0,Gt.Z)(()=>this.actions.pipe((0,c.xi)(hn.Nz))),(0,pt.s)(1))}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(c.il),e.rXU(c.En),e.rXU(ni.y),e.rXU(bp.j),e.rXU(Lp.z),e.rXU(e.gRc))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-view-tour-slide"]],inputs:{title:"title",image:"image",alt:"alt",spacing:"spacing",shown:"shown",exitEnabled:"exitEnabled",trigger:"trigger",triggerDelay:"triggerDelay"},outputs:{triggerComplete:"triggerComplete"},ngContentSelectors:$p,decls:1,vars:1,consts:[["class","slide",3,"slide--expanded",4,"ngIf"],[1,"slide"],["class","slide__title",4,"ngIf"],[1,"slide__content"],["class","slide__image",3,"src","alt",4,"ngIf"],[1,"slide__footer"],[1,"slide__title"],[1,"slide__image",3,"src","alt"]],template:function(i,o){1&i&&(e.NAR(xp),e.DNE(0,Wp,7,5,"div",0)),2&i&&e.Y8G("ngIf",o.shown)},dependencies:[p.bT],styles:[".slide[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;max-width:500px}.slide__title[_ngcontent-%COMP%]{margin-bottom:16px;font-weight:600;font-size:1.125rem;line-height:1.75rem}.slide__content[_ngcontent-%COMP%]{margin-bottom:16px;font-size:1rem;line-height:1.5rem;line-height:1.5em;max-width:100%}.slide__image[_ngcontent-%COMP%]{margin:24px auto;max-width:100%;min-height:1px}.slide__footer[_ngcontent-%COMP%]{font-size:.875rem;line-height:1.25rem;font-weight:500;display:flex;flex-direction:row;align-items:center;justify-content:center;max-width:100%}.slide--expanded[_ngcontent-%COMP%]   .slide__title[_ngcontent-%COMP%]{margin:16px}.slide--expanded[_ngcontent-%COMP%]   .slide__content[_ngcontent-%COMP%]{margin:48px}.slide--expanded[_ngcontent-%COMP%]   .slide__image[_ngcontent-%COMP%]{margin:48px auto}@media (max-width: 768px){.slide[_ngcontent-%COMP%]{max-width:400px}.slide__image[_ngcontent-%COMP%]{margin:16px}.slide__title[_ngcontent-%COMP%]{font-size:1.125rem;line-height:1.75rem;margin-bottom:12px}.slide__content[_ngcontent-%COMP%]{font-size:.875rem;line-height:1.25rem;margin-bottom:12px}.slide__footer[_ngcontent-%COMP%]{font-size:.875rem;line-height:1.25rem}}@media (max-width: 640px){.slide[_ngcontent-%COMP%]{max-width:320px}}@media (max-width: 480px){.slide[_ngcontent-%COMP%]{max-width:240px}.slide__title[_ngcontent-%COMP%]{font-size:.875rem;line-height:1.25rem;margin-bottom:8px}.slide__content[_ngcontent-%COMP%]{font-size:.75rem;line-height:1rem;margin-bottom:8px}.slide__image[_ngcontent-%COMP%]{margin:4px auto}.slide__footer[_ngcontent-%COMP%]{font-size:.75rem;line-height:1rem}}@media (max-width: 320px){.slide[_ngcontent-%COMP%]{max-width:160px}}"],data:{animation:[(0,x.hZ)("refresh",[(0,x.kY)(":enter",[(0,x.sM)($n.O.slideTransition,{params:{duration:500,from:100,to:0}})])])]},changeDetection:0})}return n})();const Xp=["*"];function Fp(n,_){1&n&&(e.j41(0,"div",1)(1,"div",2),e.SdG(2),e.k0s()())}let Qn=(()=>{class n{set shown(t){this._shown=t,this.setSelectedSlide(0)}get shown(){return this._shown}constructor(t){this.changeRef=t,this.selectedSlideIndex=0,this._shown=!1,this.ngUnsubscribe=new z.B}ngOnInit(){}ngAfterViewInit(){this.initListeners(),setTimeout(()=>{this.setSlideShown(this.selectedSlideIndex)})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}goToPrevSlide(){this.setSelectedSlide(this.selectedSlideIndex-1)}goToNextSlide(){this.setSelectedSlide(this.selectedSlideIndex+1)}setSelectedSlide(t){if(this.selectedSlideIndex=t,this.slides){const o=Math.max(0,Math.min(this.slides.length-1,t));this.selectedSlideIndex=o}this.setSlideShown(this.selectedSlideIndex)}initListeners(){(0,oi.h)(...this.slides.map(t=>t.triggerComplete.asObservable())).pipe((0,g.Q)(this.ngUnsubscribe)).subscribe(()=>{this.goToNextSlide()})}setSlideShown(t){this.slides&&this.slides.forEach((i,o)=>{i.shown=o===t}),this.changeRef.markForCheck()}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(e.gRc))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-view-tour-page"]],contentQueries:function(i,o,s){if(1&i&&e.wni(s,Hn,4),2&i){let a;e.mGM(a=e.lsd())&&(o.slides=a)}},inputs:{shown:"shown"},ngContentSelectors:Xp,decls:1,vars:1,consts:[["class","page",4,"ngIf"],[1,"page"],[1,"page__contents"]],template:function(i,o){1&i&&(e.NAR(),e.DNE(0,Fp,3,0,"div",0)),2&i&&e.Y8G("ngIf",o.shown)},dependencies:[p.bT],styles:[".page[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center}.page__contents[_ngcontent-%COMP%]{font-size:1rem;line-height:1.5rem}@media (max-width: 768px){.page__contents[_ngcontent-%COMP%]{font-size:.875rem;line-height:1.25rem}}@media (max-width: 480px){.page__contents[_ngcontent-%COMP%]{font-size:.75rem;line-height:1rem}}"],changeDetection:0})}return n})();const jp=["*"],Hp=n=>({"pages--opaquer":n});function Qp(n,_){if(1&n){const t=e.RV6();e.j41(0,"div",1)(1,"button",2),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.handleExitClick())}),e.nrm(2,"app-icon",3),e.k0s(),e.j41(3,"div",4),e.SdG(4),e.k0s(),e.j41(5,"div",5)(6,"button",6),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.handlePrevClick())}),e.nrm(7,"app-icon",7),e.k0s(),e.j41(8,"div",8),e.EFF(9),e.k0s(),e.j41(10,"button",9),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.handleNextClick())}),e.nrm(11,"app-icon",10),e.k0s()()()}if(2&n){const t=_.$implicit;e.Y8G("ngClass",e.eq3(7,Hp,t.pageIndex==t.pageSize-1)),e.R7$(6),e.Y8G("disabled",t.pageIndex<1),e.BMQ("tabindex",t.pageIndex<1?-1:0),e.R7$(3),e.Lme("",t.pageIndex+1," / ",t.pageSize,""),e.R7$(),e.Y8G("disabled",t.pageIndex===t.pageSize-1),e.BMQ("tabindex",t.pageIndex===t.pageSize-1?-1:0)}}class Ei{constructor(_,t){this.store=_,this.changeRef=t,this.ngUnsubscribe=new z.B}ngOnInit(){}ngAfterViewInit(){this.tutorial$.pipe((0,g.Q)(this.ngUnsubscribe),(0,M.p)(_=>null!=_&&_.pageSize>0)).subscribe(_=>{this.handleTutorialPages(_)}),this.store.dispatch(new Q.B.SetTutorial({pageSize:this.pages.length,pageIndex:0}))}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}handlePrevClick(){this.store.dispatch(new Q.B.TutorialPrevious)}handleNextClick(){this.store.dispatch(new Q.B.TutorialNext)}handleExitClick(){this.store.dispatch(new Q.B.ToggleWindow(_t.U.Tutorial,!1))}handleTutorialPages(_){this.pages.forEach((t,i)=>{t.shown=i===_.pageIndex}),this.changeRef.markForCheck()}static#e=this.\u0275fac=function(t){return new(t||Ei)(e.rXU(c.il),e.rXU(e.gRc))};static#t=this.\u0275cmp=e.VBU({type:Ei,selectors:[["app-view-tour-pages"]],contentQueries:function(t,i,o){if(1&t&&e.wni(o,Qn,4),2&t){let s;e.mGM(s=e.lsd())&&(i.pages=s)}},ngContentSelectors:jp,decls:2,vars:3,consts:()=>{let _,t,i,o,s,a;return _=$localize`:␟8a8cd4cbe664d8683580bdf9b28edb0bdac8acf9␟227449910725820734:Exit Tutorial`,t=$localize`:␟8a8cd4cbe664d8683580bdf9b28edb0bdac8acf9␟227449910725820734:Exit Tutorial`,i=$localize`:␟06547848178fce0f19047d0d07c2df326650718b␟2765563396217571020:Previous Tutorial Step`,o=$localize`:␟06547848178fce0f19047d0d07c2df326650718b␟2765563396217571020:Previous Tutorial Step`,s=$localize`:␟a165a2589725552dea3ac6e98be73c72f5ae03a0␟1978646816781669814:Next Tutorial Step`,a=$localize`:␟4ff3dad8ce52dc71e7b3158b1b20b5039959dabf␟2249392320351386178: Next Tutorial Step`,[["class","pages",3,"ngClass",4,"ngIf"],[1,"pages",3,"ngClass"],["app-view-button","","buttonShape","rounded","buttonTheme","dark-gray-fill","buttonSize","small","aria-label",_,"matTooltip",t,"matTooltipPosition","right","data-test","tutorialExitButton",1,"pages__close",3,"click"],["icon","times"],[1,"pages__contents"],[1,"pages__footer"],["app-view-button","","buttonShape","rounded","buttonTheme","dark-gray-fill","aria-label",i,"matTooltip",o,"matTooltipPosition","left","data-test","tutorialPreviousButton",1,"pages__nav",3,"click","disabled"],["icon","angle-left","appLogicalDir",""],[1,"mx-8"],["app-view-button","","buttonShape","rounded","buttonTheme","dark-gray-fill","aria-label",s,"matTooltip",a,"matTooltipPosition","right","data-test","tutorialNextButton",1,"pages__nav",3,"click","disabled"],["icon","angle-right","appLogicalDir",""]]},template:function(t,i){1&t&&(e.NAR(),e.DNE(0,Qp,12,9,"div",0),e.nI1(1,"async")),2&t&&e.Y8G("ngIf",e.bMT(1,1,i.tutorial$))},dependencies:[P.ri,p.YU,p.bT,Ot.e,D.R,j.oV,p.Jj],styles:[".pages[_ngcontent-%COMP%]{pointer-events:none;display:flex;flex-direction:column;align-items:center;justify-content:center;margin:20px auto 48px;max-width:600px;position:relative;background:#101823cc;border-radius:16px;padding:24px 28px 20px}.pages--opaquer[_ngcontent-%COMP%]{background:#101823e6}.pages__footer[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;font-size:1rem;line-height:1.5rem;font-weight:500}.pages__close[_ngcontent-%COMP%]{z-index:1;position:absolute;top:8px;inset-inline-end:8px;align-self:flex-end;display:flex;align-items:center;justify-content:center}.pages__contents[_ngcontent-%COMP%]{padding:16px 0}@media (max-width: 768px){.pages[_ngcontent-%COMP%]{margin:16px 12% 48px;border-radius:10px;padding:18px 22px 14px}.pages__contents[_ngcontent-%COMP%]{padding:24px 0}.pages__footer[_ngcontent-%COMP%]{font-size:.875rem;line-height:1.25rem}.pages__nav[_ngcontent-%COMP%]{font-size:1.5rem;line-height:2rem}}@media (max-width: 480px){.pages[_ngcontent-%COMP%]{margin:12px 10% 48px;border-radius:8px;padding:24px 20px 12px}.pages__footer[_ngcontent-%COMP%]{font-size:.75rem;line-height:1rem}.pages__nav[_ngcontent-%COMP%]{font-size:1.25rem;line-height:1.75rem}}"],changeDetection:0})}!function(n,_,t,i){var a,o=arguments.length,s=o<3?_:null===i?i=Object.getOwnPropertyDescriptor(_,t):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(n,_,t,i);else for(var r=n.length-1;r>=0;r--)(a=n[r])&&(s=(o<3?a(s):o>3?a(_,t,s):a(_,t))||s);o>3&&s&&Object.defineProperty(_,t,s)}([(0,c.l6)(f.Pf.getTutorial),function(n,_){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata("design:type",_)}(0,d.c)],Ei.prototype,"tutorial$",void 0);let c_=(()=>{class n{constructor(){}ngOnInit(){}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-view-tour-success"]],inputs:{inline:"inline"},decls:2,vars:2,consts:[[1,"view-tour-success"],["icon","check",1,"view-tour-success__icon"]],template:function(i,o){1&i&&(e.j41(0,"div",0),e.nrm(1,"app-icon",1),e.k0s()),2&i&&e.AVh("view-tour-success--inline",o.inline)},dependencies:[D.R],styles:[".view-tour-success{width:52px;height:52px;display:flex;background-color:#1bbc66;border-radius:50%;justify-content:center;align-items:center}.view-tour-success__icon{font-size:2.25rem;line-height:2.5rem;color:#fff}.view-tour-success--inline{display:inline-flex;width:32px;height:32px}.view-tour-success--inline .view-tour-success__icon{font-size:1.125rem;line-height:1.75rem}@media (max-width: 768px){.view-tour-success{width:36px;height:36px}.view-tour-success__icon{font-size:1.25rem;line-height:1.75rem}.view-tour-success--inline{display:inline-flex;width:24px;height:24px}.view-tour-success--inline .view-tour-success__icon{font-size:.75rem;line-height:1rem}}\n"],encapsulation:2,changeDetection:0})}return n})();function Yp(n,_){if(1&n&&e.nrm(0,"app-icon",5),2&n){const t=e.XpG(2);e.Y8G("icon",t.icon)}}function qp(n,_){if(1&n&&(e.j41(0,"span",6),e.EFF(1),e.k0s()),2&n){const t=e.XpG(2);e.R7$(),e.JRh(t.label)}}function Kp(n,_){if(1&n&&(e.qex(0),e.DNE(1,Yp,1,1,"app-icon",3)(2,qp,2,1,"span",4),e.bVm()),2&n){const t=e.XpG();e.R7$(),e.Y8G("ngIf",t.icon),e.R7$(),e.Y8G("ngIf",t.icon)}}function Zp(n,_){if(1&n&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&n){const t=e.XpG();e.R7$(),e.SpI(" ",t.label," ")}}let Jp=(()=>{class n{constructor(){}ngOnInit(){}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-view-tour-tip-button"]],inputs:{label:"label",icon:"icon"},decls:3,vars:2,consts:[[1,"view-tour-tip-button","my-1","mx-1",3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"icon",4,"ngIf"],["class","sr-only",4,"ngIf"],[3,"icon"],[1,"sr-only"]],template:function(i,o){1&i&&(e.j41(0,"div",0),e.DNE(1,Kp,3,2,"ng-container",1)(2,Zp,2,1,"span",2),e.k0s()),2&i&&(e.Y8G("ngSwitch",!!o.icon),e.R7$(),e.Y8G("ngSwitchCase",!0))},dependencies:[p.bT,p.ux,p.e1,p.fG,D.R],styles:[".view-tour-tip-button{display:inline-flex;align-items:center;justify-content:center;vertical-align:middle;color:#131c2a;background-color:#fff;border-radius:2px;font-weight:700;padding:4px;width:24px;height:24px}@media (max-width: 768px){.view-tour-tip-button{width:20px;height:20px}}\n"],encapsulation:2,changeDetection:0})}return n})();function iu(n,_){1&n&&(e.qex(0),e.pXf(1,14),e.bVm())}function nu(n,_){1&n&&(e.qex(0),e.pXf(1,15),e.bVm())}class Wi{constructor(_){this.viewService=_,this.triggers=Xt,this.videoTutorialSources=yn}ngOnInit(){this.captureScroll$=this.scrollMode$.pipe((0,ve.T)(_=>_===Tp.M.Capture))}handleStartClick(){this.viewService.toggleTutorial(!1)}static#e=this.\u0275fac=function(t){return new(t||Wi)(e.rXU(F.z))};static#t=this.\u0275cmp=e.VBU({type:Wi,selectors:[["app-view-tour-desktop"]],decls:65,vars:12,consts:()=>{let _,t,i,o,s,a,r,u,m,v,R,_e,$e,ke,Se,Rt,Ht,Qt,Yt,qt,Kt,Fi,zi,Bi;return _=$localize`:␟20058274f3bdffd2cf7023d350d44170f6ff7a12␟1050269006235116171:Rotate`,t=$localize`:␟129a2224e1f9d19eb5e11e2a07fe10a785556484␟8515973702474791807:up`,i=$localize`:␟b5fbc7c7f007dd53b2318525bb7ff8b0376c9e37␟1301930865667956193:down`,o=$localize`:␟478c0bf6552f7226e27bb5b57b8209a040ded2c6␟7449548947549758066:left`,s=$localize`:␟4a379a71f932b31ecae93a9232f818eef02ece10␟6520868693399199322:right`,a=$localize`:␟e76cd6dbaa898f85934f363fef654b29e44d004b␟6421460271971606186:Zoom`,r=$localize`:␟7cd14ceae63b4aba71ab7935638f5d3b799f4f4b␟9128067536654850026:Pan`,u=$localize`:␟eb55d5cbcf6e2a42868bede1caa64be0f1f1e435␟5702628055979003671:Explore the Anatomy`,m=$localize`:␟0cfd714a023e7dddfab02ebbaffddf8b3b7dd988␟1831081178261551807: Click and drag the model to change the viewing angle. `,v=$localize`:␟50f7d911f4c3caa51c033edb36261331cb756e7f␟7923762190272525956:Tip:`,R=$localize`:␟c71aa1ed54f03bfd28210dccb6f900b4962ea522␟114624992018654005:You can also use the arrow keys`,_e=$localize`:␟8b5e6e1e74d302bbdd638500b071bb0859f3ab40␟5411319251728756176:to rotate.`,$e=$localize`:␟50f7d911f4c3caa51c033edb36261331cb756e7f␟7923762190272525956:Tip:`,ke=$localize`:␟a6a4d760af95bd17149d92758784333d288f02a4␟7584501271397744885:You can also use`,Se=$localize`:␟5be36bcbbbee99ffb6ea5f40636c92334e7c3d37␟4307223492407933970:to zoom out.`,Rt=$localize`:␟197d3f7bb3c4bdbe8c11eb56a4cebb7bc9b5880c␟2383075435551442269: Hold the shift key and drag to move the model's position. `,Ht=$localize`:␟50f7d911f4c3caa51c033edb36261331cb756e7f␟7923762190272525956:Tip:`,Qt=$localize`:␟7e72d30152be758594ce5a0257a4fc0ee19f94d5␟4528617795430260542:You can also use the`,Yt=$localize`:␟a6e5a9592abcd7af3cf72b5d4ba3a12a124208c7␟9056703775803925947:keys to pan.`,qt=$localize`:␟b9964d82e0ae5a31d53f6aef4fdaa996d15dce16␟1011814326808580654: Click on an individual part of the model to highlight anatomy. `,Kt=$localize`:␟50f7d911f4c3caa51c033edb36261331cb756e7f␟7923762190272525956:Tip:`,Fi=$localize`:␟2949e52a456470cb255048c7e1e40b496934ed32␟962414889722492464: Double-click to zoom in on specific structures.`,zi=$localize`:␟c4673f13cb56aec8867cfdce431a5c1f283895f6␟6288669230125842319: Hold the control key and scroll up and down to zoom in or out. `,Bi=$localize`:␟dfdbec5eab67c07d82c394952e19cca3652719ea␟6750824053364243866: Scroll up and down to zoom in or out. `,[m,v,R,_e,$e,ke,Se,Rt,Ht,Qt,Yt,qt,Kt,Fi,zi,Bi,["title",_,3,"trigger"],[1,"flex","justify-start","items-center"],[1,"mr-2",3,"inline"],[1,"font-semibold"],["icon","caret-up","label",t],["icon","caret-down","label",i],["appLogicalDir","","icon","caret-left","label",o],["appLogicalDir","","icon","caret-right","label",s],["title",a,3,"trigger","ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["label","+"],["label","-"],["title",r,3,"trigger"],["label","W"],["label","A"],["label","S"],["label","D"],["title",u,3,"trigger"]]},template:function(t,i){1&t&&(e.j41(0,"app-view-tour-pages")(1,"app-view-tour-page")(2,"app-view-tour-slide",16),e.pXf(3,0),e.k0s(),e.j41(4,"app-view-tour-slide")(5,"div",17)(6,"div"),e.nrm(7,"app-view-tour-success",18),e.j41(8,"strong",19),e.pXf(9,1),e.k0s(),e.qex(10),e.pXf(11,2),e.bVm(),e.nrm(12,"app-view-tour-tip-button",20)(13,"app-view-tour-tip-button",21)(14,"app-view-tour-tip-button",22)(15,"app-view-tour-tip-button",23),e.qex(16),e.pXf(17,3),e.bVm(),e.k0s()()()(),e.j41(18,"app-view-tour-page")(19,"app-view-tour-slide",24),e.nI1(20,"async"),e.DNE(21,iu,2,0,"ng-container",25)(22,nu,2,0,"ng-container",26),e.k0s(),e.j41(23,"app-view-tour-slide")(24,"div",17)(25,"div"),e.nrm(26,"app-view-tour-success",18),e.j41(27,"strong",19),e.pXf(28,4),e.k0s(),e.qex(29),e.pXf(30,5),e.bVm(),e.nrm(31,"app-view-tour-tip-button",27),e.eu8(32),e.EFF(33,"to zoom in and "),e.nrm(34,"app-view-tour-tip-button",28),e.qex(35),e.pXf(36,6),e.bVm(),e.k0s()()()(),e.j41(37,"app-view-tour-page")(38,"app-view-tour-slide",29),e.pXf(39,7),e.k0s(),e.j41(40,"app-view-tour-slide")(41,"div",17)(42,"div"),e.nrm(43,"app-view-tour-success",18),e.j41(44,"strong",19),e.pXf(45,8),e.k0s(),e.qex(46),e.pXf(47,9),e.bVm(),e.nrm(48,"app-view-tour-tip-button",30)(49,"app-view-tour-tip-button",31)(50,"app-view-tour-tip-button",32)(51,"app-view-tour-tip-button",33),e.qex(52),e.pXf(53,10),e.bVm(),e.k0s()()()(),e.j41(54,"app-view-tour-page")(55,"app-view-tour-slide",34),e.pXf(56,11),e.k0s(),e.j41(57,"app-view-tour-slide")(58,"div",17)(59,"div"),e.nrm(60,"app-view-tour-success",18),e.j41(61,"strong",19),e.pXf(62,12),e.k0s(),e.qex(63),e.pXf(64,13),e.bVm(),e.k0s()()()()()),2&t&&(e.R7$(2),e.Y8G("trigger",i.triggers.CameraRotate),e.R7$(5),e.Y8G("inline",!0),e.R7$(12),e.Y8G("trigger",i.triggers.CameraZoom)("ngSwitch",e.bMT(20,10,i.captureScroll$)),e.R7$(2),e.Y8G("ngSwitchCase",!1),e.R7$(5),e.Y8G("inline",!0),e.R7$(12),e.Y8G("trigger",i.triggers.CameraPan),e.R7$(5),e.Y8G("inline",!0),e.R7$(12),e.Y8G("trigger",i.triggers.NodeSelection),e.R7$(5),e.Y8G("inline",!0))},dependencies:[p.ux,p.e1,p.fG,Ot.e,Qn,Ei,Hn,c_,Jp,p.Jj],changeDetection:0})}!function(n,_,t,i){var a,o=arguments.length,s=o<3?_:null===i?i=Object.getOwnPropertyDescriptor(_,t):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(n,_,t,i);else for(var r=n.length-1;r>=0;r--)(a=n[r])&&(s=(o<3?a(s):o>3?a(_,t,s):a(_,t))||s);o>3&&s&&Object.defineProperty(_,t,s)}([(0,c.l6)(te.S.getScrollMode),function(n,_){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata("design:type",_)}(0,d.c)],Wi.prototype,"scrollMode$",void 0);let ou=(()=>{class n{constructor(t){this.viewService=t,this.triggers=Xt,this.videoTutorialSources=yn}handleStartClick(){this.viewService.toggleTutorial(!1)}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(F.z))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-view-tour-mobile"]],decls:27,vars:5,consts:()=>{let t,i,o,s,a,r,u,m,v,R;return t=$localize`:␟20058274f3bdffd2cf7023d350d44170f6ff7a12␟1050269006235116171:Rotate`,i=$localize`:␟e76cd6dbaa898f85934f363fef654b29e44d004b␟6421460271971606186:Zoom`,o=$localize`:␟7cd14ceae63b4aba71ab7935638f5d3b799f4f4b␟9128067536654850026:Pan`,s=$localize`:␟eb55d5cbcf6e2a42868bede1caa64be0f1f1e435␟5702628055979003671:Explore the Anatomy`,a=$localize`:␟40fea76a56245ebbead6177bc3d17ae5ec40a165␟2280443087469838323: Tap and drag with one finger to change the viewing angle. `,r=$localize`:␟8427d89e9a09d73465919535774a238eb9d421db␟2729825529782328186: Pinch with two fingers to zoom in or out. `,u=$localize`:␟14defb0441cab2a9b33483931a54f51867c652e9␟6006726473932808920: Use two fingers to adjust the model's position. `,m=$localize`:␟1a9195f9922538bdf4a4aff64ca479c285355cfe␟7928756420516267887: Tap on an individual part of the model to highlight anatomy. `,v=$localize`:␟50f7d911f4c3caa51c033edb36261331cb756e7f␟7923762190272525956:Tip:`,R=$localize`:␟646945605f8dced01098f9c393573c2a9b46a842␟5072295053569562541:Double-tap to zoom in on specific structures.`,[a,r,u,m,v,R,["title",t,3,"trigger"],["title",i,3,"trigger"],["title",o,3,"trigger"],["title",s,3,"trigger"],[1,"flex","justify-start","items-center"],[1,"mr-2",3,"inline"],[1,"font-semibold"]]},template:function(i,o){1&i&&(e.j41(0,"app-view-tour-pages")(1,"app-view-tour-page")(2,"app-view-tour-slide",6),e.pXf(3,0),e.k0s(),e.j41(4,"app-view-tour-slide"),e.nrm(5,"app-view-tour-success"),e.k0s()(),e.j41(6,"app-view-tour-page")(7,"app-view-tour-slide",7),e.pXf(8,1),e.k0s(),e.j41(9,"app-view-tour-slide"),e.nrm(10,"app-view-tour-success"),e.k0s()(),e.j41(11,"app-view-tour-page")(12,"app-view-tour-slide",8),e.pXf(13,2),e.k0s(),e.j41(14,"app-view-tour-slide"),e.nrm(15,"app-view-tour-success"),e.k0s()(),e.j41(16,"app-view-tour-page")(17,"app-view-tour-slide",9),e.pXf(18,3),e.k0s(),e.j41(19,"app-view-tour-slide")(20,"div",10)(21,"div"),e.nrm(22,"app-view-tour-success",11),e.j41(23,"strong",12),e.pXf(24,4),e.k0s(),e.qex(25),e.pXf(26,5),e.bVm(),e.k0s()()()()()),2&i&&(e.R7$(2),e.Y8G("trigger","camera-rotate"),e.R7$(5),e.Y8G("trigger",o.triggers.CameraZoom),e.R7$(5),e.Y8G("trigger",o.triggers.CameraPan),e.R7$(5),e.Y8G("trigger",o.triggers.NodeSelection),e.R7$(5),e.Y8G("inline",!0))},dependencies:[Qn,Ei,Hn,c_],changeDetection:0})}return n})();var d_=function(n,_,t,i){var a,o=arguments.length,s=o<3?_:null===i?i=Object.getOwnPropertyDescriptor(_,t):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(n,_,t,i);else for(var r=n.length-1;r>=0;r--)(a=n[r])&&(s=(o<3?a(s):o>3?a(_,t,s):a(_,t))||s);return o>3&&s&&Object.defineProperty(_,t,s),s},p_=function(n,_){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(n,_)};function _u(n,_){if(1&n){const t=e.RV6();e.j41(0,"div",6)(1,"h2",7),e.pXf(2,1),e.k0s(),e.j41(3,"p",8),e.qex(4),e.pXf(5,2),e.bVm(),e.nrm(6,"button",9),e.nI1(7,"async"),e.nI1(8,"async"),e.j41(9,"mat-menu",null,0)(11,"button",10),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.handleSelectInputModeClick(o.inputModes.Mouse))}),e.EFF(12),e.k0s(),e.j41(13,"button",10),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.handleSelectInputModeClick(o.inputModes.Touch))}),e.EFF(14),e.k0s()()(),e.j41(15,"div",11)(16,"button",12),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.handleExitClick())}),e.k0s(),e.j41(17,"button",13),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.handleStartClick())}),e.k0s()()()}if(2&n){const t=e.sdS(10),i=e.XpG();e.R7$(6),e.Y8G("compact",!0)("label",i.inputModesText[e.bMT(7,6,i.inputMode$)])("matMenuTriggerFor",t),e.BMQ("aria-label",i.inputModesText[e.bMT(8,8,i.inputMode$)]),e.R7$(6),e.SpI(" ",i.inputModesText[i.inputModes.Mouse]," "),e.R7$(2),e.SpI(" ",i.inputModesText[i.inputModes.Touch]," ")}}function su(n,_){1&n&&e.nrm(0,"app-view-tour-mobile")}function au(n,_){1&n&&e.nrm(0,"app-view-tour-desktop")}function ru(n,_){if(1&n&&(e.j41(0,"div",14),e.nI1(1,"async"),e.DNE(2,su,1,0,"app-view-tour-mobile",15)(3,au,1,0,"app-view-tour-desktop",16),e.k0s()),2&n){const t=e.XpG();e.Y8G("ngSwitch",e.bMT(1,2,t.inputMode$)),e.R7$(2),e.Y8G("ngSwitchCase",t.inputModes.Touch)}}class Si{constructor(_,t,i){this.store=_,this.viewService=t,this.storageService=i,this.inputModes=wi.A,this.inputModesText={[wi.A.Mouse]:$localize`mouse, trackpad, or keyboard`,[wi.A.Touch]:$localize`touchscreen`},this.tourStarted=!1,this.tourEnded=!1,this.ngUnsubscribe=new z.B}ngOnInit(){this.initListeners(),this.store.dispatch(new Q.B.TutorialSeen(!0))}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initListeners(){this.tutorial$.pipe((0,g.Q)(this.ngUnsubscribe)).subscribe(({pageIndex:_,pageSize:t})=>{this.tourStarted=_>-1,this.tourEnded=_===t-1}),(0,ye.R)(window,"keyup").pipe((0,M.p)(_=>"Escape"===_.key),(0,g.Q)(this.ngUnsubscribe)).subscribe(()=>{this.exit()})}handleExitClick(){this.exit()}handleStartClick(){this.store.dispatch(new Q.B.StartTutorial(!1))}handleSelectInputModeClick(_){this.store.dispatch(new Q.B.SetInputMode(_))}exit(){this.viewService.toggleTutorial(!1)}static#e=this.\u0275fac=function(t){return new(t||Si)(e.rXU(c.il),e.rXU(F.z),e.rXU(bn.n$))};static#t=this.\u0275cmp=e.VBU({type:Si,selectors:[["app-view-tour"]],decls:3,vars:5,consts:()=>{let _,t,i,o,s,a,r;return _=$localize`:␟b6d518ec10f5635af884c06c0ee31f0d4589e8a2␟580493549510248593:Getting Started Tutorial`,t=$localize`:␟329b57635013c51987214c5913ca7092ec9a41be␟6199587308275891980:No, Thanks.`,i=$localize`:␟329b57635013c51987214c5913ca7092ec9a41be␟6199587308275891980:No, Thanks.`,o=$localize`:␟6aec50f9ac99e43913886a863d03bbd06133aa94␟188529236849865957:Start Tutorial`,s=$localize`:␟6aec50f9ac99e43913886a863d03bbd06133aa94␟188529236849865957:Start Tutorial`,a=$localize`:␟486c6addfeb93356cab8bbb37310c8f61534e1f2␟9156212170228959929:Getting Started`,r=$localize`:␟80ef270109b95917aeaa29935ed0aeb1b5337627␟5246430719012249797:Welcome! This tutorial will teach you how to navigate and explore in 3D using your`,[["inputSelectionMenu","matMenu"],a,r,["role","dialog","aria-label",_,"cdkTrapFocus","",1,"tour"],["class","tour__intro",4,"ngIf"],["class","tour__contents",3,"ngSwitch",4,"ngIf"],[1,"tour__intro"],[1,"tour__title"],[1,"tour__welcome"],["app-view-rounded-button","","buttonType","outline","icon","chevron-down","iconPlacement","right",1,"tour__input-selection","text-small",3,"compact","label","matMenuTriggerFor"],["mat-menu-item","",3,"click"],[1,"tour__footer"],["app-view-rounded-button","","buttonType","outline","label",t,"aria-label",i,"data-test","tutorialExitButton",1,"mr-3",3,"click"],["app-view-rounded-button","","buttonType","solid","label",o,"aria-label",s,"data-test","tutorialStartButton",1,"ml-3",3,"click"],[1,"tour__contents",3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"]]},template:function(t,i){1&t&&(e.j41(0,"div",3),e.DNE(1,_u,18,10,"div",4)(2,ru,4,4,"div",5),e.k0s()),2&t&&(e.AVh("tour--started",i.tourStarted),e.Y8G("@refresh",void 0),e.R7$(),e.Y8G("ngIf",!i.tourStarted),e.R7$(),e.Y8G("ngIf",i.tourStarted))},dependencies:[k.kB,p.bT,p.ux,p.e1,p.fG,Ie.kk,Ie.fb,Ie.Cp,fp,Wi,ou,p.Jj],styles:[".tour[_ngcontent-%COMP%]{color:#fff;position:fixed;inset:0;z-index:100;pointer-events:none;display:flex;flex-direction:column;align-items:center;overflow:auto}.tour__title[_ngcontent-%COMP%]{font-size:1.25rem;line-height:1.75rem}.tour__welcome[_ngcontent-%COMP%]{font-size:1rem;line-height:1.5rem;margin:16px auto 32px}.tour__intro[_ngcontent-%COMP%]{background:#101823e6;border-radius:16px;margin:auto;padding:28px 32px;text-align:center;max-width:560px}.tour__input-selection[_ngcontent-%COMP%]{margin:0 8px;vertical-align:middle}.tour__header[_ngcontent-%COMP%]{flex:none;align-self:flex-end;justify-self:flex-start;margin:24px}.tour__contents[_ngcontent-%COMP%]{flex:auto;display:flex;flex-direction:column;justify-content:flex-end;width:100%}.tour__footer[_ngcontent-%COMP%]{font-size:1rem;line-height:1.5rem;display:flex;flex-direction:row;align-items:center;justify-content:center}.tour__nav-arrow[_ngcontent-%COMP%]{font-size:1.875rem;line-height:2.25rem;cursor:pointer}.tour--ended[_ngcontent-%COMP%]   .tour__contents[_ngcontent-%COMP%]{justify-content:center}@media (max-width: 768px){.tour__intro[_ngcontent-%COMP%]{border-radius:12px;padding:20px 24px;margin:auto 12%;max-width:100%}.tour__intro__title[_ngcontent-%COMP%]{font-size:1.125rem;line-height:1.75rem}.tour__intro__content[_ngcontent-%COMP%]{font-size:.875rem;line-height:1.25rem;max-width:80%}.tour__header[_ngcontent-%COMP%]{margin:12px;font-size:.875rem;line-height:1.25rem}.tour__footer[_ngcontent-%COMP%]{font-size:.875rem;line-height:1.25rem}.tour__nav-arrow[_ngcontent-%COMP%]{font-size:1.25rem;line-height:1.75rem}}@media (max-width: 480px){.tour__intro[_ngcontent-%COMP%]{border-radius:8px;padding:16px 20px;margin:auto 10%}.tour__intro__title[_ngcontent-%COMP%]{font-size:.875rem;line-height:1.25rem}.tour__intro__content[_ngcontent-%COMP%]{font-size:.75rem;line-height:1rem;margin:12px auto 16px}.tour__header[_ngcontent-%COMP%]{margin:12px;font-size:.75rem;line-height:1rem}.tour__footer[_ngcontent-%COMP%]{font-size:.75rem;line-height:1rem}.tour__nav-arrow[_ngcontent-%COMP%]{font-size:1rem;line-height:1.5rem}}"],data:{animation:[(0,x.hZ)("refresh",[(0,x.kY)(":enter",[(0,x.sM)($n.O.slideTransition,{params:{duration:500,from:100,to:0}})])])]},changeDetection:0})}d_([(0,c.l6)(f.Pf.getTutorial),p_("design:type",d.c)],Si.prototype,"tutorial$",void 0),d_([(0,c.l6)(f.Pf.getInputMode),p_("design:type",d.c)],Si.prototype,"inputMode$",void 0);var lu=l(40215),cu=l(38399),u_=l(9592),h_=l(15810),Yn=l(22083),At=l(55671),g_=l(42482),du=l(4951),zt=l(46107),E_=l(1308),pu=l(30582);const uu=["textRef"],hu=n=>({"whiteboard-label__label--active":n});function gu(n,_){if(1&n){const t=e.RV6();e.j41(0,"div")(1,"div",4),e.bIt("cdkDragMoved",function(o){e.eBV(t);const s=e.XpG();return e.Njj(s.dragMoved(o,"corner1"))}),e.k0s(),e.j41(2,"div",5),e.bIt("cdkDragMoved",function(o){e.eBV(t);const s=e.XpG();return e.Njj(s.dragMoved(o,"corner2"))}),e.k0s(),e.j41(3,"div",6),e.bIt("cdkDragMoved",function(o){e.eBV(t);const s=e.XpG();return e.Njj(s.dragMoved(o,"corner3"))}),e.k0s(),e.j41(4,"div",7),e.bIt("cdkDragMoved",function(o){e.eBV(t);const s=e.XpG();return e.Njj(s.dragMoved(o,"corner4"))}),e.k0s(),e.j41(5,"div",8),e.bIt("cdkDragMoved",function(o){e.eBV(t);const s=e.XpG();return e.Njj(s.translateHandleMoved(o))}),e.k0s()()}if(2&n){const t=e.XpG();e.R7$(),e.Y8G("cdkDragFreeDragPosition",t.dragHandles.corner1),e.R7$(),e.Y8G("cdkDragFreeDragPosition",t.dragHandles.corner2),e.R7$(),e.Y8G("cdkDragFreeDragPosition",t.dragHandles.corner3),e.R7$(),e.Y8G("cdkDragFreeDragPosition",t.dragHandles.corner4),e.R7$(),e.Y8G("cdkDragFreeDragPosition",t.dragHandles.translate)}}let Eu=(()=>{class n{get id(){return this._id}set id(t){this._id=t,this.initialized=!1}set color(t){this.renderer.setStyle(this.textRef.nativeElement,"color",t)}set exporting(t){t&&(this.active=!1,this.labelActive.next(void 0))}set size(t){this.renderer.setStyle(this.textRef.nativeElement,"font-size",`${t}px`)}constructor(t,i,o,s){this.store=t,this.changeDetectorRef=i,this.renderer=o,this.localeId=s,this.active=!0,this.initialized=!1,this.labelActive=new e.bkB,this.labelEmpty=new e.bkB,this.dragHandles={translate:{x:0,y:0},corner1:{x:0,y:0},corner2:{x:0,y:0},corner3:{x:0,y:0},corner4:{x:0,y:0}},this.handleCoords={translate:{x:0,y:0},corner1:{x:0,y:0},corner2:{x:0,y:0},corner3:{x:0,y:0},corner4:{x:0,y:0}},this.textareaTransform={x:0,y:0,width:110,height:40},this.ngUnsubscribe=new z.B,this.handleDocumentBackspace=a=>{const{activeElement:r}=this.textRef.nativeElement;"Backspace"===a.key&&this.active&&!r&&this.deleteLabel()},this.handleTextboxMouseDown=a=>{this.active=!0,this.labelActive.next(this.id),this.refreshHandles()},this.handleDocumentMouseDown=a=>{const r=a.target.className.includes("view-whiteboard__canvas"),u=a.target.className.includes("whiteboard-label__label"),m=a.target.dataset.id===this.id;this.isLabelEmpty()&&!m&&this.initialized?this.deleteLabel():(r||u&&!m)&&(this.active=!1,this.changeDetectorRef.markForCheck())},this.handleTextKeyDown=a=>{if(a.stopPropagation(),this.isLabelEmpty()&&"Backspace"===a.key)return void this.deleteLabel();const r=this.textRef.nativeElement.scrollHeight,{corner1:u,corner3:m,corner4:v}=this.handleCoords,R=u.y+r;this.handleCoords.corner3={...m,y:R},this.handleCoords.corner4={...v,y:R},this.dragHandles.corner3={...this.handleCoords.corner3},this.dragHandles.corner4={...this.handleCoords.corner4},this.updateTextarea(),this.changeDetectorRef.markForCheck()},this.dir=(0,Dn.NS)(this.localeId).direction}ngOnInit(){this.initHandles(),this.initInteractionListeners(),this.initStateListeners(),setTimeout(()=>{this.textRef.nativeElement.focus(),this.initialized=!0})}ngOnDestroy(){this.textRef.nativeElement.removeEventListener("keydown",this.handleTextKeyDown),this.textRef.nativeElement.removeEventListener("mousedown",this.handleTextboxMouseDown),this.mouseDownListener(),this.backspaceListener(),this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initHandles(){this.textareaTransform.x=this.initialPos.x,this.textareaTransform.y=this.initialPos.y;const{x:t,y:i,width:o,height:s}=this.textareaTransform;this.dragHandles.corner1={x:t,y:i},this.dragHandles.corner2={x:t+o,y:i},this.dragHandles.corner3={x:t+o,y:i+s},this.dragHandles.corner4={x:t,y:i+s},this.dragHandles.translate={x:t+o/2,y:i+-10},this.handleCoords.corner1={...this.dragHandles.corner1},this.handleCoords.corner2={...this.dragHandles.corner2},this.handleCoords.corner3={...this.dragHandles.corner3},this.handleCoords.corner4={...this.dragHandles.corner4},this.handleCoords.translate={...this.dragHandles.translate},this.updateTextarea()}initStateListeners(){this.store.select(f.Pf.getWhiteboardAnnotateMode).pipe((0,g.Q)(this.ngUnsubscribe)).subscribe(t=>{t!==At.D.Text&&(this.active=!1,this.labelActive.next(void 0),this.changeDetectorRef.markForCheck())})}initInteractionListeners(){this.mouseDownListener=this.renderer.listen("document","mousedown",this.handleDocumentMouseDown),this.backspaceListener=this.renderer.listen("document","keydown",this.handleDocumentBackspace),this.textRef.nativeElement.addEventListener("mousedown",this.handleTextboxMouseDown),this.textRef.nativeElement.addEventListener("keydown",this.handleTextKeyDown)}refreshHandles(){this.dragHandles.corner1={...this.handleCoords.corner1},this.dragHandles.corner2={...this.handleCoords.corner2},this.dragHandles.corner3={...this.handleCoords.corner3},this.dragHandles.corner4={...this.handleCoords.corner4},this.dragHandles.translate={...this.handleCoords.translate},this.changeDetectorRef.markForCheck()}isLabelEmpty(){return""===this.textRef.nativeElement.innerText||"\n"===this.textRef.nativeElement.innerText}deleteLabel(){this.labelEmpty.next(this.id)}updateTextarea(){const{corner1:t,corner2:i,corner3:o}=this.handleCoords;this.textareaTransform.x=t.x,this.textareaTransform.y=t.y,this.textareaTransform.width=i.x-t.x,this.textareaTransform.height=o.y-i.y,this.renderer.setStyle(this.textRef.nativeElement,"transform",`translate(${this.textareaTransform.x}px, ${this.textareaTransform.y}px)`),this.renderer.setStyle(this.textRef.nativeElement,"width",`${this.textareaTransform.width}px`),this.renderer.setStyle(this.textRef.nativeElement,"height",`${this.textareaTransform.height}px`)}updateTranslateHandle(){const{corner1:t,corner2:i}=this.handleCoords;this.handleCoords.translate={x:(i.x-t.x)/2+t.x,y:t.y+-10},this.dragHandles.translate={...this.handleCoords.translate}}setHandle(t,i,o){this.handleCoords[t]={...this.handleCoords[t],[i]:o[i]},this.dragHandles[t]={...this.handleCoords[t]}}addDiffToHandle(t,i){this.handleCoords[t]={x:this.handleCoords[t].x+i.x,y:this.handleCoords[t].y+i.y},this.dragHandles[t]={...this.handleCoords[t]}}translateHandleMoved(t){const i=t.source._dragRef.getFreeDragPosition(),o={x:i.x-this.handleCoords.translate.x,y:i.y-this.handleCoords.translate.y};this.handleCoords.translate={...i},this.addDiffToHandle("corner1",o),this.addDiffToHandle("corner2",o),this.addDiffToHandle("corner3",o),this.addDiffToHandle("corner4",o),this.updateTextarea()}dragMoved(t,i){const o=t.source._dragRef.getFreeDragPosition();this.handleCoords[i]={...o},"corner1"===i&&(this.setHandle("corner2","y",o),this.setHandle("corner4","x",o)),"corner2"===i&&(this.setHandle("corner1","y",o),this.setHandle("corner3","x",o)),"corner3"===i&&(this.setHandle("corner2","x",o),this.setHandle("corner4","y",o)),"corner4"===i&&(this.setHandle("corner1","x",o),this.setHandle("corner3","y",o)),this.updateTranslateHandle(),this.updateTextarea()}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(c.il),e.rXU(e.gRc),e.rXU(e.sFG),e.rXU(e.xe9))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-view-whiteboard-label"]],viewQuery:function(i,o){if(1&i&&e.GBs(uu,7),2&i){let s;e.mGM(s=e.lsd())&&(o.textRef=s.first)}},inputs:{id:"id",initialPos:"initialPos",color:"color",exporting:"exporting",size:"size"},outputs:{labelActive:"labelActive",labelEmpty:"labelEmpty"},decls:4,vars:6,consts:()=>{let t;return t=$localize`:␟0fde29c90b84be4dd7bc39adcce90313a570f14b␟1511122002214104331:Type..`,[["textRef",""],[1,"whiteboard-label"],[4,"ngIf"],["contenteditable","true","data-placeholder",t,1,"whiteboard-label__label",3,"dir","ngClass"],["cdkDrag","",1,"whiteboard-label__handle","whiteboard-label__handle--top-left",3,"cdkDragMoved","cdkDragFreeDragPosition"],["cdkDrag","",1,"whiteboard-label__handle","whiteboard-label__handle--top-right",3,"cdkDragMoved","cdkDragFreeDragPosition"],["cdkDrag","",1,"whiteboard-label__handle","whiteboard-label__handle--bottom-right",3,"cdkDragMoved","cdkDragFreeDragPosition"],["cdkDrag","",1,"whiteboard-label__handle","whiteboard-label__handle--bottom-left",3,"cdkDragMoved","cdkDragFreeDragPosition"],["cdkDrag","",1,"whiteboard-label__handle","whiteboard-label__handle--move",3,"cdkDragMoved","cdkDragFreeDragPosition"]]},template:function(i,o){1&i&&(e.j41(0,"div",1),e.DNE(1,gu,6,5,"div",2),e.nrm(2,"div",3,0),e.k0s()),2&i&&(e.R7$(),e.Y8G("ngIf",!0===o.active),e.R7$(),e.Y8G("dir",o.dir)("ngClass",e.eq3(4,hu,!0===o.active)),e.BMQ("data-id",o.id))},dependencies:[p.YU,p.bT,H.T1,Dt.ig],styles:['.whiteboard-label[_ngcontent-%COMP%]{position:relative;z-index:1000}.whiteboard-label__handle[_ngcontent-%COMP%]{position:fixed;z-index:10;width:32px;height:32px;left:-16px;top:-16px}.whiteboard-label__handle[_ngcontent-%COMP%]:after{content:"";position:absolute;width:12px;height:12px;left:10px;top:10px;border-radius:50%;background-color:#2d72dc}.whiteboard-label__handle[_ngcontent-%COMP%]:hover{cursor:pointer}.whiteboard-label__handle--top-left[_ngcontent-%COMP%]:hover{cursor:nw-resize}.whiteboard-label__handle--top-right[_ngcontent-%COMP%]:hover{cursor:ne-resize}.whiteboard-label__handle--bottom-right[_ngcontent-%COMP%]:hover{cursor:se-resize}.whiteboard-label__handle--bottom-left[_ngcontent-%COMP%]:hover{cursor:sw-resize}.whiteboard-label__handle--move[_ngcontent-%COMP%]:hover{cursor:move}.whiteboard-label__label[_ngcontent-%COMP%]{box-sizing:border-box;position:absolute;border:none;padding:5px;overflow-y:hidden}.whiteboard-label__label--active[_ngcontent-%COMP%]{box-shadow:inset 0 0 0 1px #2d72dc}.whiteboard-label__label[_ngcontent-%COMP%]:focus{outline:none}.whiteboard-label__label[_ngcontent-%COMP%]:empty:before{content:attr(data-placeholder);color:#374a6880}'],changeDetection:0})}return n})();var yt=function(n,_,t,i){var a,o=arguments.length,s=o<3?_:null===i?i=Object.getOwnPropertyDescriptor(_,t):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(n,_,t,i);else for(var r=n.length-1;r>=0;r--)(a=n[r])&&(s=(o<3?a(s):o>3?a(_,t,s):a(_,t))||s);return o>3&&s&&Object.defineProperty(_,t,s),s},Nt=function(n,_){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(n,_)};const Su=["colorBtn"];function mu(n,_){1&n&&(e.j41(0,"div"),e.nrm(1,"app-icon",28),e.j41(2,"span",29),e.pXf(3,5),e.k0s()())}function fu(n,_){if(1&n){const t=e.RV6();e.j41(0,"button",23),e.bIt("click",function(){const o=e.eBV(t).$implicit,s=e.XpG();return e.Njj(s.setTextSize(o.size))}),e.j41(1,"div",24)(2,"div",25),e.DNE(3,mu,4,0,"div",26),e.nI1(4,"async"),e.k0s(),e.j41(5,"div",27)(6,"span"),e.EFF(7),e.k0s()()()()}if(2&n){const t=_.$implicit,i=e.XpG();e.R7$(3),e.Y8G("ngIf",t.size===e.bMT(4,2,i.textSize$)),e.R7$(4),e.SpI("",t.label,"px")}}function Tu(n,_){1&n&&(e.j41(0,"div"),e.nrm(1,"app-icon",28),e.j41(2,"span",29),e.pXf(3,6),e.k0s()())}function bu(n,_){if(1&n){const t=e.RV6();e.j41(0,"button",23),e.bIt("click",function(){const o=e.eBV(t).$implicit,s=e.XpG();return e.Njj(s.setBrushSize(o.size))}),e.j41(1,"div",24)(2,"div",25),e.DNE(3,Tu,4,0,"div",26),e.nI1(4,"async"),e.k0s(),e.j41(5,"div",27),e.nrm(6,"app-icon",30),e.j41(7,"span"),e.EFF(8),e.k0s()()()()}if(2&n){const t=_.$implicit,i=e.XpG();e.R7$(3),e.Y8G("ngIf",t.size===e.bMT(4,4,i.brushSize$)),e.R7$(3),e.xc7("font-size",t.size,"px"),e.R7$(2),e.JRh(t.label)}}function vu(n,_){1&n&&(e.j41(0,"div"),e.nrm(1,"app-icon",28),e.j41(2,"span",29),e.pXf(3,7),e.k0s()())}function Ou(n,_){if(1&n){const t=e.RV6();e.j41(0,"button",23),e.bIt("click",function(){const o=e.eBV(t).$implicit,s=e.XpG();return e.Njj(s.setEraserSize(o.size))}),e.j41(1,"div",24)(2,"div",25),e.DNE(3,vu,4,0,"div",26),e.nI1(4,"async"),e.k0s(),e.j41(5,"div",31),e.nrm(6,"app-icon",30),e.j41(7,"span"),e.EFF(8),e.k0s()()()()}if(2&n){const t=_.$implicit,i=e.XpG();e.R7$(3),e.Y8G("ngIf",t.size===e.bMT(4,4,i.eraserSize$)),e.R7$(3),e.xc7("font-size",t.size,"px"),e.R7$(2),e.JRh(t.label)}}function Cu(n,_){1&n&&(e.j41(0,"div"),e.nrm(1,"app-icon",28),e.j41(2,"span",29),e.pXf(3,8),e.k0s()())}function Iu(n,_){if(1&n){const t=e.RV6();e.j41(0,"button",23),e.bIt("click",function(){const o=e.eBV(t).$implicit,s=e.XpG();return e.Njj(s.setBrushColor(o.color))}),e.j41(1,"div",24)(2,"div",25),e.DNE(3,Cu,4,0,"div",26),e.nI1(4,"async"),e.k0s(),e.j41(5,"div",27),e.nrm(6,"span",32),e.j41(7,"span"),e.EFF(8),e.nI1(9,"titlecase"),e.k0s()()()()}if(2&n){const t=_.$implicit,i=e.XpG();e.R7$(3),e.Y8G("ngIf",t.color===e.bMT(4,4,i.brushColor$)),e.R7$(3),e.xc7("background-color",t.color),e.R7$(2),e.JRh(e.bMT(9,6,t.label))}}class He{constructor(_){this.store=_,this.textSizes=zt.WC,this.brushSizes=zt.TH,this.brushColors=[{label:$localize`Black`,color:zt.u5.color},{label:$localize`Red`,color:"#ff0000"},{label:$localize`Yellow`,color:"#ffff00"},{label:$localize`Green`,color:"#00ff00"},{label:$localize`Cyan`,color:"#00ffff"},{label:$localize`Blue`,color:"#0000ff"},{label:$localize`Pink`,color:"#ff00ff"},{label:$localize`White`,color:zt.ky.color}],this.eraserSizes=zt.nt,this.modeEnum=At.D,this.downloadClick=new e.bkB,this.clearClick=new e.bkB,this.exitClick=new e.bkB,this.ngUnsubscribe=new z.B}ngOnInit(){}ngAfterViewInit(){this.hasPaint$.pipe((0,g.Q)(this.ngUnsubscribe)).subscribe(_=>{!_&&this.store.selectSnapshot(f.Pf.getWhiteboardAnnotateMode)===At.D.Erase&&this.handleModeSelect(At.D.Paint)})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}setBrushSize(_){this.store.dispatch(new Q.B.SetWhiteboardBrushSize(_))}setBrushColor(_){this.store.dispatch(new Q.B.SetWhiteboardBrushColor(_))}setTextSize(_){this.store.dispatch(new Q.B.SetWhiteboardTextSize(_))}handleModeSelect(_){this.store.dispatch(new Q.B.SetWhiteboardAnnotateMode(_))}setEraserSize(_){this.store.dispatch(new Q.B.SetWhiteboardEraserSize(_))}handleDownloadClick(){this.downloadClick.next()}handleClearClick(){this.clearClick.next()}handleExitClick(){this.exitClick.next()}static#e=this.\u0275fac=function(t){return new(t||He)(e.rXU(c.il))};static#t=this.\u0275cmp=e.VBU({type:He,selectors:[["app-view-whiteboard-tools"]],viewQuery:function(t,i){if(1&t&&e.GBs(Su,7,e.aKT),2&t){let o;e.mGM(o=e.lsd())&&(i.colorBtn=o.first)}},outputs:{downloadClick:"downloadClick",clearClick:"clearClick",exitClick:"exitClick"},decls:37,vars:43,consts:()=>{let _,t,i,o,s,a,r,u,m,v,R,_e,$e,ke;return _=$localize`:␟8fa4d523f7b91df4390120b85ed0406138273e1a␟9011959596901584887:Color`,t=$localize`:␟8fa4d523f7b91df4390120b85ed0406138273e1a␟9011959596901584887:Color`,i=$localize`:␟a0e8b3d9b3da6e0adfc24e2a32c7a6403b72fbf1␟8792981974820069318:Brush`,o=$localize`:␟a0e8b3d9b3da6e0adfc24e2a32c7a6403b72fbf1␟8792981974820069318:Brush`,s=$localize`:␟8ba143716c2da6e4120c0c1a804f0bdd9a7e5f5b␟6162693758764653365:Text`,a=$localize`:␟8ba143716c2da6e4120c0c1a804f0bdd9a7e5f5b␟6162693758764653365:Text`,r=$localize`:␟07845aefc0a7038371e36035e75183d0cfffbbc3␟8027390660031780542:Eraser`,u=$localize`:␟07845aefc0a7038371e36035e75183d0cfffbbc3␟8027390660031780542:Eraser`,m=$localize`:␟99ee4faa69cd2ea8e3678c1f557c0ff1f05aae46␟8700121026680200191:Clear`,v=$localize`:␟99ee4faa69cd2ea8e3678c1f557c0ff1f05aae46␟8700121026680200191:Clear`,R=$localize`:␟1e7180823484a8b886c921518255e24324c3d47b␟8167513183851535531:current`,_e=$localize`:␟1e7180823484a8b886c921518255e24324c3d47b␟8167513183851535531:current`,$e=$localize`:␟1e7180823484a8b886c921518255e24324c3d47b␟8167513183851535531:current`,ke=$localize`:␟1e7180823484a8b886c921518255e24324c3d47b␟8167513183851535531:current`,[["colorBtn","matMenuTrigger"],["textSizeMenu","matMenu"],["brushSizeMenu","matMenu"],["eraserSizeMenu","matMenu"],["brushColorMenu","matMenu"],R,_e,$e,ke,[1,"view-whiteboard-tools"],["name","Whiteboard","orientation","vertical"],["app-view-button","","buttonSize","small","aria-label",_,"matTooltip",t,"matTooltipPosition","right",3,"matMenuTriggerFor","buttonTheme"],["size","lg","icon","tint"],["app-view-button","","buttonSize","small","aria-label",i,"matTooltip",o,"matTooltipPosition","right",3,"click","matMenuTriggerFor","buttonTheme"],["size","lg","icon","paint-brush"],["app-view-button","","buttonSize","small","aria-label",s,"matTooltip",a,"matTooltipPosition","right",3,"click","matMenuTriggerFor","buttonTheme"],["size","lg","icon","text-size"],["app-view-button","","buttonSize","small","aria-label",r,"matTooltip",u,"matTooltipPosition","right",3,"click","matMenuTriggerFor","buttonTheme","disabled"],["size","lg","icon","eraser"],["orientation","vertical"],["app-view-button","","buttonSize","small","aria-label",m,"matTooltip",v,"matTooltipPosition","right",3,"click","disabled"],["size","lg","icon","trash"],["mat-menu-item","",3,"click",4,"ngFor","ngForOf"],["mat-menu-item","",3,"click"],[1,"flex","flex-row","items-center","justify-start"],[1,"view-whiteboard-tools__check"],[4,"ngIf"],[1,"view-whiteboard-tools__label"],["icon","check","aria-hidden","true",1,"mr-2"],[1,"sr-only"],["icon","circle","aria-hidden","true",1,"mr-2"],[1,"view-whiteboard-tools__label","flex","flex-auto","items-center"],[1,"view-whiteboard-tools__swatch"]]},template:function(t,i){if(1&t){const o=e.RV6();e.j41(0,"div",9)(1,"app-pillbox",10)(2,"button",11,0),e.nrm(4,"app-icon",12),e.k0s(),e.j41(5,"button",13),e.nI1(6,"async"),e.nI1(7,"async"),e.nI1(8,"async"),e.bIt("click",function(){return e.eBV(o),e.Njj(i.handleModeSelect(i.modeEnum.Paint))}),e.nrm(9,"app-icon",14),e.k0s(),e.j41(10,"button",15),e.nI1(11,"async"),e.nI1(12,"async"),e.bIt("click",function(){return e.eBV(o),e.Njj(i.handleModeSelect(i.modeEnum.Text))}),e.nrm(13,"app-icon",16),e.k0s(),e.j41(14,"button",17),e.nI1(15,"async"),e.nI1(16,"async"),e.nI1(17,"async"),e.nI1(18,"async"),e.bIt("click",function(){return e.eBV(o),e.Njj(i.handleModeSelect(i.modeEnum.Erase))}),e.nrm(19,"app-icon",18),e.k0s(),e.nrm(20,"app-pillbox-divider",19),e.j41(21,"button",20),e.nI1(22,"async"),e.nI1(23,"async"),e.bIt("click",function(){return e.eBV(o),e.Njj(i.handleClearClick())}),e.nrm(24,"app-icon",21),e.k0s(),e.j41(25,"mat-menu",null,1),e.DNE(27,fu,8,4,"button",22),e.k0s(),e.j41(28,"mat-menu",null,2),e.DNE(30,bu,9,6,"button",22),e.k0s(),e.j41(31,"mat-menu",null,3),e.DNE(33,Ou,9,6,"button",22),e.k0s(),e.j41(34,"mat-menu",null,4),e.DNE(36,Iu,10,8,"button",22),e.k0s()()()}if(2&t){const o=e.sdS(3),s=e.sdS(26),a=e.sdS(29),r=e.sdS(32),u=e.sdS(35);e.R7$(2),e.Y8G("matMenuTriggerFor",u)("buttonTheme",o.menuOpen?"blue-fill":"transparent-fill"),e.BMQ("aria-selected",o.menuOpen)("aria-pressed",o.menuOpen),e.R7$(3),e.Y8G("matMenuTriggerFor",a)("buttonTheme",e.bMT(6,21,i.mode$)===i.modeEnum.Paint?"blue-fill":"transparent-fill"),e.BMQ("aria-selected",e.bMT(7,23,i.mode$)===i.modeEnum.Paint)("aria-pressed",e.bMT(8,25,i.mode$)===i.modeEnum.Paint),e.R7$(5),e.Y8G("matMenuTriggerFor",s)("buttonTheme",e.bMT(11,27,i.mode$)===i.modeEnum.Text?"blue-fill":"transparent-fill"),e.BMQ("aria-pressed",e.bMT(12,29,i.mode$)===i.modeEnum.Text),e.R7$(4),e.Y8G("matMenuTriggerFor",r)("buttonTheme",e.bMT(15,31,i.mode$)===i.modeEnum.Erase?"blue-fill":"transparent-fill")("disabled",!1===e.bMT(16,33,i.hasPaint$)),e.BMQ("aria-selected",e.bMT(17,35,i.mode$)===i.modeEnum.Erase)("aria-pressed",e.bMT(18,37,i.mode$)===i.modeEnum.Erase),e.R7$(7),e.Y8G("disabled",!1===e.bMT(22,39,i.hasPaint$)&&!1===e.bMT(23,41,i.hasText$)),e.R7$(6),e.Y8G("ngForOf",i.textSizes),e.R7$(3),e.Y8G("ngForOf",i.brushSizes),e.R7$(3),e.Y8G("ngForOf",i.eraserSizes),e.R7$(3),e.Y8G("ngForOf",i.brushColors)}},dependencies:[P.ri,p.Sq,p.bT,D.R,Ie.kk,Ie.fb,Ie.Cp,j.oV,Ze.O,In.p,p.Jj,p.PV],styles:[".view-whiteboard-tools__check{min-width:20px;color:#2d72dc}.view-whiteboard-tools__swatch{display:inline-block;width:14px;height:14px;border-radius:50%;margin-inline-end:8px;box-shadow:0 0 0 1px #96a8c0}\n"],encapsulation:2,changeDetection:0})}yt([(0,c.l6)(f.Pf.isWhiteboardLocked),Nt("design:type",d.c)],He.prototype,"isLocked$",void 0),yt([(0,c.l6)(f.Pf.getWhiteboardAnnotateMode),Nt("design:type",d.c)],He.prototype,"mode$",void 0),yt([(0,c.l6)(f.Pf.getWhiteboardBrushSize),Nt("design:type",d.c)],He.prototype,"brushSize$",void 0),yt([(0,c.l6)(f.Pf.getWhiteboardTextSize),Nt("design:type",d.c)],He.prototype,"textSize$",void 0),yt([(0,c.l6)(f.Pf.getWhiteboardBrushColor),Nt("design:type",d.c)],He.prototype,"brushColor$",void 0),yt([(0,c.l6)(f.Pf.getWhiteboardEraserSize),Nt("design:type",d.c)],He.prototype,"eraserSize$",void 0),yt([(0,c.l6)(f.Pf.getWhiteboardHasPaint),Nt("design:type",d.c)],He.prototype,"hasPaint$",void 0),yt([(0,c.l6)(f.Pf.getWhiteboardHasText),Nt("design:type",d.c)],He.prototype,"hasText$",void 0);var Bt=function(n,_,t,i){var a,o=arguments.length,s=o<3?_:null===i?i=Object.getOwnPropertyDescriptor(_,t):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(n,_,t,i);else for(var r=n.length-1;r>=0;r--)(a=n[r])&&(s=(o<3?a(s):o>3?a(_,t,s):a(_,t))||s);return o>3&&s&&Object.defineProperty(_,t,s),s},jt=function(n,_){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(n,_)};const Mu=["drawCanvas"],wu=["annotateWrapper"];function Au(n,_){if(1&n){const t=e.RV6();e.j41(0,"app-view-whiteboard-label",14),e.nI1(1,"async"),e.bIt("labelActive",function(o){e.eBV(t);const s=e.XpG();return e.Njj(s.handleLabelActive(o))})("labelEmpty",function(o){e.eBV(t);const s=e.XpG();return e.Njj(s.handleLabelEmpty(o))}),e.k0s()}if(2&n){const t=_.$implicit,i=e.XpG();e.AVh("view-whiteboard__label--clickthrough",e.bMT(1,7,i.annotateMode$)!==i.whiteboardAnnotateMode.Text),e.Y8G("exporting",i.exporting)("id",t.id)("initialPos",t.pos)("color",t.color)("size",t.size)}}function yu(n,_){if(1&n){const t=e.RV6();e.j41(0,"button",15),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.handleExitClick())}),e.j41(1,"span",16),e.pXf(2,2),e.k0s()()}}const Cn=u_.H.PNG;class it{constructor(_,t,i,o,s,a,r,u,m){this.store=_,this.actions=t,this.viewService=i,this.clipboardService=o,this.applicationEventService=s,this.changeRef=a,this.animationService=r,this.snapshotService=u,this.snackbar=m,this.whiteboardAnnotateMode=At.D,this.labels=[],this.exporting=!1,this.drawing=!1,this.brushSize=0,this.eraserSize=0,this.lineWidth=0,this.wasPlaying=!1,this.ngUnsubscribe=new z.B}ngOnInit(){this.siteHeader=this.store.selectSnapshot(ai.W.getSiteHeader),this.store.dispatch(new h_.G.SetHeader(Yn.D.Hide)),this.canvasElement=this.drawCanvas.nativeElement,this.canvasContext=this.canvasElement.getContext("2d"),this.initActiveLabelColorListener(),this.initActiveLabelTextSizeListener(),this.initAnnotateModeListener(),this.initBrushColorFromBackgroundListener(),this.animationService.isPlaying()&&(this.animationService.pause(),this.wasPlaying=!0)}ngAfterViewInit(){this.initCanvasListeners(),this.snapshotService.setDrawCanvas(this.drawCanvas.nativeElement),this.snapshotService.setAnnotateElement(this.annotateElement.nativeElement)}ngOnDestroy(){this.inputManager.destroy(),this.reset(),this.store.dispatch(new h_.G.SetHeader(this.siteHeader)),this.wasPlaying&&this.animationService.unpause(),this.snapshotService.setDrawCanvas(null),this.snapshotService.setAnnotateElement(null),this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initAnnotateModeListener(){this.annotateMode$.pipe((0,g.Q)(this.ngUnsubscribe)).subscribe(_=>{switch(this.inputManager&&this.inputManager.destroy(),_){case At.D.Paint:this.canvasContext.globalCompositeOperation="source-over",this.setLineWidth(this.brushSize),this.initDrawListeners();break;case At.D.Text:this.initTextListener();break;case At.D.Erase:this.canvasContext.globalCompositeOperation="destination-out",this.setLineWidth(this.eraserSize),this.initDrawListeners()}this.applicationEventService.fireEvent(at.F.WhiteboardModeUpdated,_)})}initActiveLabelColorListener(){this.brushColor$.pipe((0,g.Q)(this.ngUnsubscribe)).subscribe(_=>{const t=this.labels.find(i=>i.id===this.activeLabelId);t&&(t.color=_,this.changeRef.markForCheck())})}initActiveLabelTextSizeListener(){this.textSize$.pipe((0,g.Q)(this.ngUnsubscribe)).subscribe(_=>{const t=this.labels.find(i=>i.id===this.activeLabelId);t&&(t.size=_,this.changeRef.markForCheck())})}initBrushColorFromBackgroundListener(){this.background$.pipe((0,g.Q)(this.ngUnsubscribe)).subscribe(_=>{const t=(0,yo.T4)(_)?zt.fY:zt.dS;this.store.dispatch(new Q.B.SetWhiteboardBrushColor(t.color))})}initTextListener(){this.inputManager=new Hammer.Manager(this.drawCanvas.nativeElement),this.inputManager.add(new Hammer.Tap({event:"tap"})),this.inputManager.on("tap",_=>{if(this.activeLabelId)return void(this.activeLabelId=void 0);const t=(0,V.uniqueId)();let i=_.center.x,o=_.center.y;void 0!==_.pointers[0].x&&(i=_.pointers[0].x,o=_.pointers[0].y);const s=this.store.selectSnapshot(f.Pf.getWhiteboardBrushColor),a=this.store.selectSnapshot(f.Pf.getWhiteboardTextSize);this.labels.push({id:t,pos:{x:i,y:o},color:s,size:a}),this.activeLabelId=t,this.changeRef.markForCheck(),this.dispatchHasText()})}initCanvasListeners(){this.brushSize$.pipe((0,g.Q)(this.ngUnsubscribe)).subscribe(_=>{this.setBrushSize(_)}),this.brushColor$.pipe((0,g.Q)(this.ngUnsubscribe)).subscribe(_=>{this.setBrushColor(_)}),this.eraserSize$.pipe((0,g.Q)(this.ngUnsubscribe)).subscribe(_=>{this.setEraserSize(_)}),this.syncCanvas()}initDrawListeners(){this.inputManager=new Hammer.Manager(this.drawCanvas.nativeElement),this.inputManager.add(new Hammer.Pan({event:"pan",pointers:0})),this.inputManager.add(new Hammer.Tap({event:"tap"}));const _=new Map;this.inputManager.on("tap",t=>{this.changeRef.markForCheck();const{x:i,y:o}=this.getInputPosition(t);this.drawPoint(i,o),this.checkCanvasPaint()}),this.inputManager.on("panstart",t=>{this.drawing=!0,this.changeRef.markForCheck();const{x:i,y:o}=this.getInputPosition(t);_.set(t.pointers[0]?.pointerId||1,{x:i,y:o}),this.applicationEventService.fireEvent(at.F.WhiteboardDrawingStarted)}),this.inputManager.on("pan",t=>{this.drawing=!0,this.changeRef.markForCheck();const{x:i,y:o}=this.getInputPosition(t),s=t.pointers[0]?.pointerId||1,{x:a,y:r}=_.get(s);this.drawLine(a,r,i,o),this.drawPoint(i,o),_.set(s,{x:i,y:o})}),this.inputManager.on("panend",()=>{this.drawing=!1,this.changeRef.markForCheck(),_.clear(),this.checkCanvasPaint(),this.applicationEventService.fireEvent(at.F.WhiteboardDrawingFinished)})}handleLabelActive(_){this.activeLabelId=_;const t=this.labels.find(i=>i.id===_);t&&this.store.dispatch([new Q.B.SetWhiteboardTextSize(t.size),new Q.B.SetWhiteboardBrushColor(t.color)])}handleLabelEmpty(_){this.labels=this.labels.filter(t=>t.id!==_),this.changeRef.markForCheck(),this.dispatchHasText()}dispatchHasText(){this.store.dispatch(new Q.B.SetWhiteboardHasText(this.labels.length>0))}handleResetClick(){this.reset()}handleCopyClick(){var _=this;return(0,be.A)(function*(){try{const t=function(){var i=(0,be.A)(function*(){return yield yield _.getSnapshotBlob()});return function(){return i.apply(this,arguments)}}();yield navigator.clipboard.write([new ClipboardItem({"image/png":t()})]),_.snackbar.open("Image copied")}catch{_.snackbar.open("Error copying image")}})()}handleDownloadClick(){var _=this;return(0,be.A)(function*(){const t=yield _.getSnapshotBlob();_.downloadSnapshot(t)})()}handleExitClick(){this.resetCanvas(),this.viewService.toggleWhiteboard(!1)}getSnapshotBlob(){var _=this;return(0,be.A)(function*(){_.exporting=!0,_.changeRef.detectChanges();const{width:t,height:i}=_.canvasElement,o=_.store.selectSnapshot(b.N.getSelectedChapterBackground),s=_.store.selectSnapshot(te.S.getWatermarkEnabled),a=document.querySelector(".engine__watermark"),r=[_.drawCanvas.nativeElement,_.annotateElement.nativeElement];s&&!(0,V.isNil)(a)&&r.push(a);const u=(0,E_.F$)(Cn,o),m=_.snapshotService.getLogoFromBackground(o),v={...E_._,crop:"original",imageType:Cn,imageQuality:100,copyrightEnabled:!0,copyrightImagePath:m.logo_url},R=yield(0,lu._)(_.snapshotService.takeSnapshot(t,i,u,r,!0,v));return _.exporting=!1,_.changeRef.markForCheck(),R})()}getInputPosition(_){const t=_.pointers[0];return t?.pageX?{x:t.pageX,y:t.pageY}:{x:_.center.x,y:_.center.y}}checkCanvasPaint(){const _=this.canvasContext.getImageData(0,0,this.canvasElement.width,this.canvasElement.height),i=new Uint32Array(_.data.buffer).some(o=>0!==o);this.store.dispatch(new Q.B.SetWhiteboardHasPaint(i))}drawPoint(_,t){const i=this.lineWidth/2,o=2*Math.PI;this.canvasContext.beginPath(),this.canvasContext.arc(_,t,i,0,o),this.canvasContext.fill()}drawLine(_,t,i,o){this.canvasContext.beginPath(),this.canvasContext.moveTo(_,t),this.canvasContext.lineTo(i,o),this.canvasContext.stroke(),this.canvasContext.closePath()}reset(){this.resetCanvas(),this.labels=[],this.changeRef.markForCheck(),this.dispatchHasText()}setBrushSize(_){this.brushSize=_,this.setLineWidth(_)}setBrushColor(_){this.canvasContext.fillStyle=_,this.canvasContext.strokeStyle=_}setEraserSize(_){this.eraserSize=_,this.setLineWidth(_)}setLineWidth(_){this.canvasContext.lineWidth=_,this.lineWidth=_}syncCanvas(){const _=this.store.selectSnapshot(f.Pf.getWhiteboardBrushSize),t=this.store.selectSnapshot(f.Pf.getWhiteboardBrushColor),i=this.store.selectSnapshot(f.Pf.getWhiteboardEraserSize),{width:o,height:s}=this.getScreenDimensions();this.canvasElement.width=o,this.canvasElement.height=s,this.setBrushSize(_),this.setBrushColor(t),this.setEraserSize(i),this.canvasContext.lineJoin="round"}resetCanvas(){const{width:_,height:t}=this.canvasElement;this.canvasContext.clearRect(0,0,_,t),this.store.dispatch(new Q.B.SetWhiteboardHasPaint(!1))}downloadSnapshot(_){const{displayName:t}=this.store.selectSnapshot(Ce.t.getStory),s=`${(t||"").replace(/ /g,"_").replace(/\W/g,"").toLowerCase()}_drawing.${Cn===u_.H.PNG?"png":"jpg"}`;!0===ei.c.native||ei.c.platform===Ro.N.SDK?g_.X.blobToBase64(_).pipe((0,cu.q)(a=>this.clipboardService.copyToClipboard(a,"image")),(0,g.Q)(this.ngUnsubscribe)).subscribe(a=>{}):g_.X.exportImage(_,Cn,s)}getScreenDimensions(){const{innerWidth:_,innerHeight:t}=window;return{width:_,height:t}}static#e=this.\u0275fac=function(t){return new(t||it)(e.rXU(c.il),e.rXU(c.En),e.rXU(F.z),e.rXU(du.W),e.rXU(Gn.S),e.rXU(e.gRc),e.rXU(Ut.O),e.rXU(pu.M),e.rXU(Ii.UG))};static#t=this.\u0275cmp=e.VBU({type:it,selectors:[["app-view-whiteboard"]],viewQuery:function(t,i){if(1&t&&(e.GBs(Mu,7),e.GBs(wu,7)),2&t){let o;e.mGM(o=e.lsd())&&(i.drawCanvas=o.first),e.mGM(o=e.lsd())&&(i.annotateElement=o.first)}},decls:19,vars:20,consts:()=>{let _,t,i,o,s,a;return _=$localize`:␟1979da7460819153e11d2078244645d94291b69c␟4323470180912194028:Copy`,t=$localize`:␟1979da7460819153e11d2078244645d94291b69c␟4323470180912194028:Copy`,i=$localize`:␟dc75033a5238fdc4f462212c847a45ba8018a3fd␟3099741642167775297:Download`,o=$localize`:␟dc75033a5238fdc4f462212c847a45ba8018a3fd␟3099741642167775297:Download`,s=$localize`:␟321ea915069a7cb35969b033591534495fa061ec␟7029026028912706681:Exit Draw`,a=$localize`:␟321ea915069a7cb35969b033591534495fa061ec␟7029026028912706681:Exit Draw`,[["annotateWrapper",""],["drawCanvas",""],a,[1,"view-whiteboard"],["dir","ltr"],["class","view-whiteboard__label",3,"view-whiteboard__label--clickthrough","exporting","id","initialPos","color","size","labelActive","labelEmpty",4,"ngFor","ngForOf"],["data-test","drawCanvas",1,"view-whiteboard__canvas"],["data-test","viewWhiteboardTools",1,"view-whiteboard__tools",3,"clearClick","downloadClick","exitClick"],[1,"view-whiteboard__actions"],["app-view-button","","buttonSize","small","data-test","viewWhiteboardCopy","aria-label",_,"matTooltip",t,"matTooltipPosition","right",3,"click"],["size","lg","icon","copy"],["app-view-button","","buttonSize","small","data-test","viewWhiteboardDownload","aria-label",i,"matTooltip",o,"matTooltipPosition","right",3,"click"],["size","lg","icon","down-to-bracket"],["data-test","viewDrawExit","app-view-button","","buttonSize","small","aria-label",s,3,"click",4,"ngIf"],[1,"view-whiteboard__label",3,"labelActive","labelEmpty","exporting","id","initialPos","color","size"],["data-test","viewDrawExit","app-view-button","","buttonSize","small","aria-label",s,3,"click"],[1,"px-3","text-xs","uppercase"]]},template:function(t,i){if(1&t){const o=e.RV6();e.j41(0,"div",3,0),e.nI1(2,"async"),e.nI1(3,"async"),e.nI1(4,"async"),e.j41(5,"div",4),e.DNE(6,Au,2,9,"app-view-whiteboard-label",5),e.k0s(),e.nrm(7,"canvas",6,1),e.j41(9,"app-view-whiteboard-tools",7),e.bIt("clearClick",function(){return e.eBV(o),e.Njj(i.handleResetClick())})("downloadClick",function(){return e.eBV(o),e.Njj(i.handleDownloadClick())})("exitClick",function(){return e.eBV(o),e.Njj(i.handleExitClick())}),e.k0s(),e.j41(10,"div",8)(11,"app-pillbox")(12,"button",9),e.bIt("click",function(){return e.eBV(o),e.Njj(i.handleCopyClick())}),e.nrm(13,"app-icon",10),e.k0s(),e.j41(14,"button",11),e.bIt("click",function(){return e.eBV(o),e.Njj(i.handleDownloadClick())}),e.nrm(15,"app-icon",12),e.k0s()(),e.j41(16,"app-pillbox"),e.DNE(17,yu,3,0,"button",13),e.nI1(18,"async"),e.k0s()()()}2&t&&(e.AVh("view-whiteboard--exporting",i.exporting)("view-whiteboard--drawing",i.drawing)("view-whiteboard--cursor-paint",e.bMT(2,12,i.annotateMode$)===i.whiteboardAnnotateMode.Paint)("view-whiteboard--cursor-erase",e.bMT(3,14,i.annotateMode$)===i.whiteboardAnnotateMode.Erase)("view-whiteboard--cursor-text",e.bMT(4,16,i.annotateMode$)===i.whiteboardAnnotateMode.Text),e.R7$(6),e.Y8G("ngForOf",i.labels),e.R7$(11),e.Y8G("ngIf",!1===e.bMT(18,18,i.isLocked$)))},dependencies:[P.ri,p.Sq,p.bT,D.R,Dt.ig,j.oV,Ze.O,Eu,He,p.Jj],styles:[".view-whiteboard{touch-action:none;position:fixed;inset:0;z-index:20;display:flex;flex-direction:column;align-items:center;justify-content:space-between;transition:all .3s linear}.view-whiteboard--exporting .view-whiteboard__tools,.view-whiteboard--exporting .view-whiteboard__actions,.view-whiteboard--drawing .view-whiteboard__tools,.view-whiteboard--drawing .view-whiteboard__actions{display:none}.view-whiteboard--cursor-paint:hover{cursor:url(/assets/images/cursor-whiteboard-paint.svg) 7 20,pointer}.view-whiteboard--cursor-erase:hover{cursor:url(/assets/images/cursor-whiteboard-erase.svg) 7 20,pointer}.view-whiteboard--cursor-text:hover{cursor:url(/assets/images/cursor-whiteboard-text.svg) 7 20,pointer}.view-whiteboard__canvas{position:absolute;inset:0;z-index:1}.view-whiteboard__label{position:absolute;top:0;left:0;z-index:10}.view-whiteboard__label--clickthrough{pointer-events:none}.view-whiteboard__tools{position:absolute;inset-inline-start:12px;top:12px;bottom:12px;z-index:20;display:flex;align-items:center}.view-whiteboard__actions{display:flex;gap:8px;position:absolute;inset-inline-end:12px;top:12px;z-index:20}\n"],encapsulation:2,changeDetection:0})}Bt([(0,c.l6)(f.Pf.isWhiteboardLocked),jt("design:type",d.c)],it.prototype,"isLocked$",void 0),Bt([(0,c.l6)(f.Pf.getWhiteboardAnnotateMode),jt("design:type",d.c)],it.prototype,"annotateMode$",void 0),Bt([(0,c.l6)(f.Pf.getWhiteboardBrushSize),jt("design:type",d.c)],it.prototype,"brushSize$",void 0),Bt([(0,c.l6)(f.Pf.getWhiteboardBrushColor),jt("design:type",d.c)],it.prototype,"brushColor$",void 0),Bt([(0,c.l6)(f.Pf.getWhiteboardTextSize),jt("design:type",d.c)],it.prototype,"textSize$",void 0),Bt([(0,c.l6)(f.Pf.getWhiteboardEraserSize),jt("design:type",d.c)],it.prototype,"eraserSize$",void 0),Bt([(0,c.l6)(b.N.getSelectedChapterBackground),jt("design:type",d.c)],it.prototype,"background$",void 0);var A=function(n,_,t,i){var a,o=arguments.length,s=o<3?_:null===i?i=Object.getOwnPropertyDescriptor(_,t):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(n,_,t,i);else for(var r=n.length-1;r>=0;r--)(a=n[r])&&(s=(o<3?a(s):o>3?a(_,t,s):a(_,t))||s);return o>3&&s&&Object.defineProperty(_,t,s),s},y=function(n,_){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(n,_)};const Ru=["viewContainer"],Pu=["columnContainer"],Uu=["drawerContainer"],Vu=["engineContainer"],Du=["view"],Lu=["viewCameraBar"],xu=["viewLogo"],$u=["viewSceneBase"],ku=["viewToolbar"],Gu=(n,_,t,i,o,s,a,r)=>({"view-page--layout-column":n,"view-page--layout-drawer":_,"view-page--show-aside":t,"view-page--column-open":i,"view-page--column-closed":o,"view-page--drawer-open":s,"view-page--drawer-closed":a,"view-page--drawer-peek":r}),Wu=n=>({"view-page__drawer-nav--overflow":n}),m_=n=>({"w-full":n}),Xu=n=>({grow:n}),Fu=n=>({collapsed:n}),zu=n=>({"pt-2":n}),Bu=(n,_,t)=>({"view-page__logo--mobile":n,"view-page__logo--web":_,"view-page__logo--raised":t});function ju(n,_){1&n&&e.nrm(0,"app-view-toolbar")}function Hu(n,_){if(1&n&&(e.nrm(0,"app-view-undo",41),e.nI1(1,"async")),2&n){const t=e.XpG();e.Y8G("layout",e.bMT(1,1,t.canvasHeightBreakpoint$)>t.canvasHeightBreakpoint.Tiny?"full":"resetOnly")}}function Qu(n,_){if(1&n&&(e.nrm(0,"app-view-title-only",49),e.nI1(1,"async")),2&n){const t=e.XpG(4);e.Y8G("showPagination",e.bMT(1,1,t.paginationVisible$))}}function Yu(n,_){1&n&&e.nrm(0,"app-view-audio-mute")}function qu(n,_){if(1&n&&(e.j41(0,"app-pillbox",50),e.DNE(1,Yu,1,0,"app-view-audio-mute",18),e.nI1(2,"async"),e.nrm(3,"app-view-drawer-toggle"),e.k0s()),2&n){const t=e.XpG(4);e.R7$(),e.Y8G("ngIf",e.bMT(2,1,t.audioVisible$))}}function Ku(n,_){if(1&n&&(e.j41(0,"div",46),e.nI1(1,"async"),e.nI1(2,"async"),e.nI1(3,"async"),e.j41(4,"div"),e.DNE(5,Qu,2,3,"app-view-title-only",47),e.nI1(6,"async"),e.k0s(),e.DNE(7,qu,4,3,"app-pillbox",48),e.nI1(8,"async"),e.nI1(9,"async"),e.k0s()),2&n){const t=e.XpG(3);e.Y8G("ngClass",e.eq3(15,Wu,e.bMT(1,3,t.titleOnlyVisible$)&&(e.bMT(2,5,t.drawerToggleVisible$)||e.bMT(3,7,t.audioVisible$)))),e.R7$(5),e.Y8G("ngIf",e.bMT(6,9,t.titleOnlyVisible$)),e.R7$(2),e.Y8G("ngIf",e.bMT(8,11,t.drawerToggleVisible$)||e.bMT(9,13,t.audioVisible$))}}function Zu(n,_){if(1&n){const t=e.RV6();e.j41(0,"app-pillbox")(1,"button",51),e.bIt("click",function(){e.eBV(t);const o=e.XpG(3);return e.Njj(o.handleQuizClick())}),e.nrm(2,"app-icon",52),e.k0s()()}}function Ju(n,_){if(1&n&&(e.j41(0,"div",44),e.DNE(1,Ku,10,17,"div",45),e.nI1(2,"async"),e.nI1(3,"async"),e.nI1(4,"async"),e.DNE(5,Zu,3,0,"app-pillbox",18),e.nI1(6,"async"),e.nI1(7,"async"),e.nI1(8,"async"),e.nI1(9,"async"),e.nI1(10,"async"),e.k0s()),2&n){const t=e.XpG(2);e.R7$(),e.Y8G("ngIf",e.bMT(2,2,t.titleOnlyVisible$)||e.bMT(3,4,t.drawerToggleVisible$)||e.bMT(4,6,t.audioVisible$)),e.R7$(4),e.Y8G("ngIf",e.bMT(6,8,t.hasQuiz$)&&e.bMT(7,10,t.quizEnabled$)&&!1===e.bMT(8,12,t.quizModeLocked$)&&e.bMT(9,14,t.quizPromptVisible$)&&!1===e.bMT(10,16,t.quizModeActive$))}}function eh(n,_){if(1&n&&(e.qex(0,42),e.DNE(1,Ju,11,18,"div",43),e.nI1(2,"async"),e.nI1(3,"async"),e.nI1(4,"async"),e.nI1(5,"async"),e.bVm()),2&n){const t=e.XpG();e.R7$(),e.Y8G("ngIf",e.bMT(2,1,t.titleOnlyVisible$)||e.bMT(3,3,t.drawerToggleVisible$)||e.bMT(4,5,t.quizModeActive$)&&!1===e.bMT(5,7,t.quizModeLocked$))}}function th(n,_){1&n&&e.nrm(0,"app-view-column-toggle")}function ih(n,_){if(1&n&&(e.qex(0),e.nrm(1,"app-view-title-only",56),e.nI1(2,"async"),e.bVm()),2&n){const t=e.XpG(3);e.R7$(),e.Y8G("showPagination",e.bMT(2,1,t.paginationVisible$))}}function nh(n,_){1&n&&e.nrm(0,"app-view-audio-mute")}function oh(n,_){if(1&n){const t=e.RV6();e.j41(0,"button",58),e.bIt("click",function(){e.eBV(t);const o=e.XpG(4);return e.Njj(o.handleQuizClick())}),e.nrm(1,"app-icon",59),e.j41(2,"span",60),e.pXf(3,6),e.k0s()()}}function _h(n,_){if(1&n&&(e.j41(0,"app-pillbox"),e.DNE(1,nh,1,0,"app-view-audio-mute",18),e.nI1(2,"async"),e.nI1(3,"async"),e.DNE(4,oh,4,0,"button",57),e.nI1(5,"async"),e.nI1(6,"async"),e.nI1(7,"async"),e.nI1(8,"async"),e.nI1(9,"async"),e.k0s()),2&n){const t=e.XpG(3);e.R7$(),e.Y8G("ngIf",e.bMT(2,2,t.audioVisible$)&&!1===e.bMT(3,4,t.columnVisible$)),e.R7$(3),e.Y8G("ngIf",e.bMT(5,6,t.hasQuiz$)&&e.bMT(6,8,t.quizEnabled$)&&!1===e.bMT(7,10,t.quizModeLocked$)&&e.bMT(8,12,t.quizPromptVisible$)&&!1===e.bMT(9,14,t.quizModeActive$))}}function sh(n,_){if(1&n&&(e.j41(0,"div",54)(1,"div",55),e.DNE(2,th,1,0,"app-view-column-toggle",18),e.nI1(3,"async"),e.DNE(4,ih,3,3,"ng-container",18),e.nI1(5,"async"),e.DNE(6,_h,10,16,"app-pillbox",18),e.nI1(7,"async"),e.nI1(8,"async"),e.nI1(9,"async"),e.nI1(10,"async"),e.nI1(11,"async"),e.nI1(12,"async"),e.nI1(13,"async"),e.k0s()()),2&n){const t=e.XpG(2);e.R7$(2),e.Y8G("ngIf",e.bMT(3,3,t.columnToggleVisible$)),e.R7$(2),e.Y8G("ngIf",e.bMT(5,5,t.titleOnlyVisible$)),e.R7$(2),e.Y8G("ngIf",e.bMT(7,7,t.hasQuiz$)&&e.bMT(8,9,t.quizEnabled$)&&!1===e.bMT(9,11,t.quizModeLocked$)&&e.bMT(10,13,t.quizPromptVisible$)&&!1===e.bMT(11,15,t.quizModeActive$)||e.bMT(12,17,t.audioVisible$)&&!1===e.bMT(13,19,t.columnVisible$))}}function ah(n,_){if(1&n&&(e.qex(0,42),e.DNE(1,sh,14,21,"div",53),e.nI1(2,"async"),e.nI1(3,"async"),e.nI1(4,"async"),e.bVm()),2&n){const t=e.XpG();e.R7$(),e.Y8G("ngIf",e.bMT(2,1,t.columnToggleVisible$)||e.bMT(3,3,t.titleOnlyVisible$)||e.bMT(4,5,t.quizModeActive$))}}function rh(n,_){1&n&&e.eu8(0,42)}function lh(n,_){if(1&n&&(e.j41(0,"div",23)(1,"app-pillbox",61),e.nrm(2,"app-view-xr-button",62),e.nI1(3,"async"),e.nI1(4,"async"),e.k0s()()),2&n){let t;const i=e.XpG();e.R7$(2),e.Y8G("mode","ar")("title",null==(t=e.bMT(3,6,i.story$))?null:t.displayName)("modelUrl",e.bMT(4,8,i.arModelUrl$))("transparent",!0)("bordered",!1)("compact",!0)}}function ch(n,_){1&n&&e.nrm(0,"app-engine-camera-bar")}function dh(n,_){1&n&&(e.j41(0,"app-pillbox",63),e.nrm(1,"app-view-fullscreen",64),e.k0s())}function ph(n,_){if(1&n){const t=e.RV6();e.j41(0,"button",76),e.nI1(1,"async"),e.bIt("click",function(){e.eBV(t);const o=e.XpG(4);return e.Njj(o.handleToggleMedia(!1))}),e.nrm(2,"app-icon",77),e.k0s()}if(2&n){let t;const i=e.XpG(4);e.Y8G("matTooltip",i.mediaBarTooltip)("thin",!0),e.BMQ("aria-label",i.mediaBarTooltip)("aria-expanded","show"===(null==(t=e.bMT(1,4,i.mediaUI$))?null:t.status))}}function uh(n,_){if(1&n&&(e.j41(0,"div",71),e.nI1(1,"async"),e.nI1(2,"async"),e.j41(3,"app-pillbox",72),e.nI1(4,"async"),e.nI1(5,"async"),e.DNE(6,ph,3,6,"button",73),e.nI1(7,"async"),e.nrm(8,"app-pillbox-divider",74)(9,"app-view-media-bar",75),e.nI1(10,"async"),e.nI1(11,"async"),e.k0s()()),2&n){let t,i,o;const s=e.XpG(3);e.Y8G("ngClass",e.eq3(20,m_,e.bMT(1,6,s.horizontalBreakpoint$)>s.horizontalBreakpoint.XSmall&&"full"===(null==(t=e.bMT(2,8,s.mediaUI$))?null:t.template))),e.R7$(3),e.Y8G("ngClass",e.eq3(22,Xu,e.bMT(4,10,s.horizontalBreakpoint$)>s.horizontalBreakpoint.XSmall&&"full"===(null==(i=e.bMT(5,12,s.mediaUI$))?null:i.template))),e.R7$(3),e.Y8G("ngIf",e.eq3(24,Fu,"show"===(null==(o=e.bMT(7,14,s.mediaUI$))?null:o.status))),e.R7$(3),e.Y8G("autoFocus","keyboard"===s.focusOrigin)("showSpeed",e.bMT(10,16,s.horizontalBreakpoint$)>s.horizontalBreakpoint.XSmall)("showScrubber",e.bMT(11,18,s.horizontalBreakpoint$)>s.horizontalBreakpoint.XSmall)}}function hh(n,_){if(1&n){const t=e.RV6();e.qex(0),e.j41(1,"button",76),e.nI1(2,"async"),e.bIt("click",function(){e.eBV(t);const o=e.XpG(4);return e.Njj(o.handleToggleMedia(!0))}),e.nrm(3,"app-icon",78),e.k0s(),e.nrm(4,"app-pillbox-divider",74),e.bVm()}if(2&n){let t;const i=e.XpG(4);e.R7$(),e.Y8G("matTooltip",i.mediaBarTooltip)("thin",!0),e.BMQ("aria-label",i.mediaBarTooltip)("aria-expanded","show"===(null==(t=e.bMT(2,4,i.mediaUI$))?null:t.status))}}function gh(n,_){if(1&n&&(e.j41(0,"app-pillbox",74),e.DNE(1,hh,5,6,"ng-container",18),e.nI1(2,"async"),e.nI1(3,"async"),e.nI1(4,"async"),e.nrm(5,"app-view-play"),e.k0s()),2&n){let t;const i=e.XpG(3);e.R7$(),e.Y8G("ngIf",!1===e.bMT(2,1,i.isMobileWeb$)&&"collapse"===(null==(t=e.bMT(3,3,i.mediaUI$))?null:t.status)&&"full"===(null==(t=e.bMT(4,5,i.mediaUI$))?null:t.template))}}function Eh(n,_){if(1&n&&(e.j41(0,"div",68),e.DNE(1,uh,12,26,"div",69),e.nI1(2,"async"),e.nI1(3,"async"),e.DNE(4,gh,6,7,"app-pillbox",70),e.nI1(5,"async"),e.k0s()),2&n){let t,i;const o=e.XpG(2);e.R7$(),e.Y8G("ngIf",e.bMT(2,2,o.mediaVisible$)&&"show"===(null==(t=e.bMT(3,4,o.mediaUI$))?null:t.status)),e.R7$(3),e.Y8G("ngIf","show"!==(null==(i=e.bMT(5,6,o.mediaUI$))?null:i.status))}}function Sh(n,_){if(1&n&&(e.nrm(0,"app-view-title-only",82),e.nI1(1,"async"),e.nI1(2,"async")),2&n){const t=e.XpG(3);e.Y8G("showPagination",e.bMT(1,2,t.paginationVisible$))("showTitle",!1===e.bMT(2,4,t.drawerVisible$))}}function mh(n,_){1&n&&(e.j41(0,"app-pillbox",50),e.nrm(1,"app-view-drawer-toggle"),e.k0s())}function fh(n,_){if(1&n&&(e.j41(0,"div",79),e.nI1(1,"async"),e.j41(2,"div",80),e.nI1(3,"async"),e.DNE(4,Sh,3,6,"app-view-title-only",81),e.nI1(5,"async"),e.k0s(),e.DNE(6,mh,2,0,"app-pillbox",48),e.nI1(7,"async"),e.k0s()),2&n){const t=e.XpG(2);e.Y8G("ngClass",e.eq3(12,zu,e.bMT(1,4,t.mediaVisible$))),e.R7$(2),e.Y8G("ngClass",e.eq3(14,m_,!1===e.bMT(3,6,t.drawerVisible$))),e.R7$(2),e.Y8G("ngIf",e.bMT(5,8,t.titleOnlyVisible$)),e.R7$(2),e.Y8G("ngIf",e.bMT(7,10,t.drawerToggleVisible$))}}function Th(n,_){if(1&n&&(e.j41(0,"div",65),e.DNE(1,Eh,6,8,"div",66),e.nI1(2,"async"),e.DNE(3,fh,8,16,"div",67),e.nI1(4,"async"),e.nI1(5,"async"),e.k0s()),2&n){const t=e.XpG();e.R7$(),e.Y8G("ngIf",e.bMT(2,2,t.mediaVisible$)),e.R7$(2),e.Y8G("ngIf",!0===e.bMT(4,4,t.isMobileWeb$)&&"drawer"===e.bMT(5,6,t.viewLayout$))}}function bh(n,_){if(1&n&&(e.nrm(0,"app-view-logo",83),e.nI1(1,"async"),e.nI1(2,"async"),e.nI1(3,"async"),e.nI1(4,"async")),2&n){const t=e.XpG();e.Y8G("ngClass",e.sMw(11,Bu,!0===e.bMT(1,3,t.isMobileWeb$),!1===e.bMT(2,5,t.isMobileWeb$),t.isLogoRaised))("logoColor",t.isBackgroundLight?"color":"white")("logoSize",!0===e.bMT(3,7,t.isMobileWeb$)||e.bMT(4,9,t.horizontalBreakpoint$)<=t.horizontalBreakpoint.Small?"small":"full")}}function vh(n,_){if(1&n){const t=e.RV6();e.j41(0,"div",84)(1,"app-pillbox")(2,"button",51),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.handleExitQuiz())}),e.j41(3,"span",85),e.pXf(4,7),e.k0s()()()()}}function Oh(n,_){1&n&&e.nrm(0,"app-view-column-container",86)}function Ch(n,_){if(1&n){const t=e.RV6();e.j41(0,"app-view-column",87),e.nI1(1,"async"),e.qex(2,88),e.j41(3,"div",89)(4,"div",90),e.pXf(5,8),e.k0s(),e.j41(6,"button",91),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.handleToggleSearch(!1))}),e.nrm(7,"app-icon",92),e.j41(8,"span",93),e.pXf(9,9),e.k0s()()(),e.bVm(),e.qex(10,94),e.j41(11,"div",95),e.nrm(12,"app-view-search"),e.k0s(),e.bVm(),e.k0s()}if(2&n){const t=e.XpG();e.Y8G("floating",!0)("padded",!1)("wide",e.bMT(1,3,t.paginationVisible$))}}function Ih(n,_){if(1&n){const t=e.RV6();e.j41(0,"app-view-column",96),e.nI1(1,"async"),e.qex(2,88),e.j41(3,"div",89)(4,"div",90),e.pXf(5,10),e.k0s(),e.j41(6,"button",97),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.handleToggleLayers())}),e.nrm(7,"app-icon",92),e.j41(8,"span",93),e.pXf(9,11),e.k0s()()(),e.bVm(),e.qex(10,94),e.j41(11,"div",98),e.nrm(12,"app-view-visibility-layers"),e.k0s(),e.bVm(),e.k0s()}if(2&n){const t=e.XpG();e.Y8G("wide",e.bMT(1,3,t.paginationVisible$))("floating",!0)("padded",!1)}}function Mh(n,_){1&n&&(e.j41(0,"div",99,5),e.nrm(2,"app-view-drawer"),e.k0s())}function wh(n,_){1&n&&e.nrm(0,"div",100)}function Ah(n,_){if(1&n&&e.nrm(0,"app-view-ondemand",36),2&n){const t=e.XpG();e.Y8G("contentId",t.contentId)("contentType",t.contentType)}}function yh(n,_){1&n&&e.nrm(0,"app-view-tour")}function Nh(n,_){1&n&&e.nrm(0,"app-view-whiteboard",37)}function Rh(n,_){if(1&n){const t=e.RV6();e.j41(0,"app-xr-loader-summary",101),e.nI1(1,"async"),e.nI1(2,"async"),e.nI1(3,"async"),e.nI1(4,"async"),e.bIt("learnMoreClick",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.handleExitARClick())}),e.k0s()}if(2&n){let t,i,o;const s=e.XpG();e.Y8G("platform",e.bMT(1,4,s.platform$))("mode",null==(t=e.bMT(2,6,s.viewUI$))?null:t.xrLoader.template)("contentBlocks",null==(i=e.bMT(3,8,s.chapter$))?null:i.contentBlocks)("title",null==(o=e.bMT(4,10,s.story$))?null:o.displayName)}}function Ph(n,_){if(1&n&&e.nrm(0,"app-play-loader",102),2&n){const t=e.XpG(2);e.Y8G("percent",t.chapterLoadProgress)}}function Uh(n,_){1&n&&e.nrm(0,"app-button-loader")}function Vh(n,_){1&n&&e.nrm(0,"app-hand-loader")}function Dh(n,_){1&n&&e.nrm(0,"app-summary-loader")}function Lh(n,_){if(1&n&&(e.j41(0,"app-view-loader"),e.DNE(1,Ph,1,1,"app-play-loader",102),e.nI1(2,"async"),e.DNE(3,Uh,1,0,"app-button-loader")(4,Vh,1,0,"app-hand-loader")(5,Dh,1,0,"app-summary-loader"),e.k0s()),2&n){let t;const i=e.XpG();e.R7$(),e.vxM("play"===(t=e.bMT(2,1,i.interactType$))?1:"button"===t?3:"hand"===t?4:"summary"===t?5:-1)}}function xh(n,_){if(1&n&&(e.nrm(0,"app-view-progress",103),e.nI1(1,"async")),2&n){const t=e.XpG();e.Y8G("show",e.bMT(1,2,t.viewWindow$)===t.viewWindow.Loader)("percent",t.chapterLoadProgress)}}function $h(n,_){1&n&&e.nrm(0,"app-view-print")}function kh(n,_){1&n&&e.nrm(0,"app-view-content-warning")}function Gh(n,_){1&n&&e.nrm(0,"app-xr-overlay")}class I{onClick(_){this.handleFirstClickTracking(_)}onActive(_){this.showTools$.next(!0)}onInactive(_){const t=this.store.selectSnapshot(f.Pf.getFadeout),i=this.store.selectSnapshot(f.Pf.getFadeoutPaused),o=this.viewLayout$.getValue();0!==t&&o!==Ai.G.Column&&!i&&this.showTools$.next(!1)}get arModelUrl$(){return this.chapter$.pipe((0,ve.T)(_=>_?.contentBlocks??[]),(0,ve.T)(_=>(0,Ln.p)(_)[0]))}constructor(_,t,i,o,s,a,r,u,m,v,R,_e,$e,ke,Se,Rt,Ht,Qt,Yt,qt,Kt){this.activatedRoute=_,this.changeDetectorRef=t,this.store=i,this.actions=o,this.liveAnnouncer=s,this.viewService=a,this.viewQuizService=r,this.viewUIService=u,this.engineService=m,this.nodeService=v,this.animationService=R,this.applicationEventService=_e,this.vendorAnalyticsService=$e,this.mediaService=ke,this.title=Se,this.platform=Rt,this.viewPlaythroughService=Ht,this.focusMonitor=Qt,this.dialog=Yt,this.visibilityLayersService=qt,this.legacyVisibilityLayersService=Kt,this.application=ce.c,this.environment=ei.c,this.nativePlatform=me.I,this.toolEnum=je.s,this.showTools$=new xe.t(!1),this.mediaExpanded=!1,this.horizontalBreakpoint=pn.m,this.canvasHeightBreakpoint=no.h,this.viewContentMode=st.G,this.viewLayoutStatus=ot.Q,this.viewMode=dn,this.viewUI=E.U,this.viewWindow=_t.U,this.columnLayoutStatus=ot.Q.Hide,this.drawerExpandable=!0,this.drawerOpen=!1,this.loadLabel="",this.chapterLoadProgress=0,this.chaptersLoaded=0,this.isBackgroundLight=!0,this.selectedChapterLoading=!1,this.viewToolsMode=Io,this.viewLayout$=new xe.t(Ai.G.Column),this.showZones=[],this.focusOrigin="",this.isLogoRaised=!1,this.ngUnsubscribe=new z.B}ngOnInit(){this.resetScene();const _=this.activatedRoute.snapshot.queryParams,{id:t,type:i,lang:o}=this.viewService.normalizeQueryParams(_),s="true"===_.xr;this.contentId=t,this.contentType=i,this.contentLang=o,this.store.dispatch(new Je.W.SetEnabled(s))}ngAfterViewInit(){this.viewService.setViewLanguage(this.contentLang),this.loadStory(),this.store.dispatch(new Ct.Ds({tag:!0,pin:!1})),this.store.dispatch(new Ae.kE(!0));const _=this.store.selectSnapshot(O.dF.getUI).loader.template,t=this.store.selectSnapshot(O.dF.getUI).xrLoader.template;this.store.dispatch(new Ae.Ti(_===Ao.aD.Bar)),this.store.selectSnapshot(we.U.getXREnabled)&&t!==vo.t.None?this.store.dispatch(new Q.B.ToggleWindow(_t.U.XRLoader,!0)):_!==Ao.aD.None&&this.store.dispatch(new Q.B.ToggleWindow(_t.U.Loader,!0)),this.liveAnnouncer.announce("Loading","polite"),this.store.select(O.dF.getUIEntry(E.U.Playthrough)).pipe((0,M.p)(s=>s.enable),(0,pt.s)(1),(0,g.Q)(this.ngUnsubscribe)).subscribe(s=>{this.store.dispatch(new Q.B.SetPlaythroughEnabled(s.enable))}),this.checkCapabilities(),this.initSizeObservers(),this.initHeaderObserver(),this.initViewUIObserver(),this.initUIObserver(),this.initKeyboardObserver(),this.initLoadProgressObserver(),this.initPlaythroughObserver(),this.initWindowObserver(),this.initMobileNav(),this.initBackgroundColorObserver(),this.initResponsiveLabels(),this.initNodeObserver(),this.initChapterObserver(),this.initChapterAudioPlayer(),this.initToolsFadeout(),this.initAccessibility(),this.initTooltips(),this.initQuizStateListener(),this.initVisibilityLayers(),this.storyId$.pipe((0,M.p)(s=>!(0,V.isNil)(s)&&"preview"!==s),(0,pt.s)(1),(0,g.Q)(this.ngUnsubscribe)).subscribe(()=>this.initVendorAnalyticsEvents()),this.initAnatomyTree()}ngOnDestroy(){this.store.dispatch(new Ae.t5(!1)),this.store.dispatch(new wo.J),this.store.dispatch(new Ct.S3),Ee.g.isFullscreen()&&Ee.g.exitFullscreen(),this.viewQuizService.exitQuiz(),this.unbindKeyboard(),this.mediaService.stopAllAudio(),this.mediaService.removeAllAudioPlayers(),this.store.dispatch(new gn.O.ResetAudio),this.viewPlaythroughService.clearChapterTimers(),this.destroyVisibilityLayers(),this.ngUnsubscribe.next(),this.ngUnsubscribe.complete(),this.focusMonitor.stopMonitoring(document.body),this.viewService.unobserveMaterialOverlay()}loadStory(){this.onDemand$.pipe((0,M.p)(_=>!_),(0,pt.s)(1),(0,g.Q)(this.ngUnsubscribe)).subscribe(()=>{this.viewService.initStory(this.contentId,this.contentType,this.contentLang)})}checkCapabilities(){const _=(0,En.ZO)(),t=(0,En.yd)();this.store.dispatch(new Q.B.SetCanHover(_)),this.store.dispatch(new Q.B.SetCanTouch(t)),this.store.dispatch(new Q.B.SetCanFullscreen(Ee.g.canFullscreen())),this.store.dispatch(new Q.B.SetInputMode(t?wi.A.Touch:wi.A.Mouse)),(0,ye.R)(window,"orientationchange").pipe((0,Re.B)(100),(0,g.Q)(this.ngUnsubscribe)).subscribe(()=>{this.store.dispatch(new Q.B.SetCanHover((0,En.ZO)())),this.store.dispatch(new Q.B.SetCanTouch((0,En.yd)()))})}initResponsiveLabels(){const _=(0,ye.R)(window,"resize").pipe((0,Re.B)(100)),t=this.store.select(f.Pf.getLabelsBreakpoint),i=this.store.select(Fe.y.getSelectedLabel),o=this.store.select(Fe.y.getLabelsCollapsed);i.pipe((0,M.p)(()=>this.store.selectSnapshot(Fe.y.getLabelsCollapsed)),(0,g.Q)(this.ngUnsubscribe)).subscribe(s=>{this.viewService.toggleLabelInfo(null!=s)}),o.pipe((0,M.p)(()=>!!this.store.selectSnapshot(Fe.y.getSelectedLabel)),(0,g.Q)(this.ngUnsubscribe)).subscribe(s=>{this.viewService.toggleLabelInfo(s)}),(0,de.z)(_,t).pipe((0,M.p)(([,s])=>!(0,V.isNil)(s)),(0,g.Q)(this.ngUnsubscribe)).subscribe(()=>{this.checkLabelsCollapsed()}),this.checkLabelsCollapsed()}initSizeObservers(){const _=Lr({strategy:"scroll"});(0,ye.R)(window,"resize").pipe((0,Re.B)(10),(0,g.Q)(this.ngUnsubscribe)).subscribe(()=>{this.updateViewHeight(),this.refreshLayout()}),new d.c(o=>{_.listenTo(this.engineContainer.nativeElement,()=>{o.next()})}).pipe((0,Re.B)(10)).subscribe(()=>{this.resizeEngineContainer()})}initHeaderObserver(){this.store.select(ai.W.getSiteHeader).pipe((0,g.Q)(this.ngUnsubscribe)).subscribe(_=>{this.updateViewHeight()})}initUIObserver(){this.viewUI$.pipe((0,M.p)(_=>!(0,V.isNil)(_)),(0,g.Q)(this.ngUnsubscribe)).subscribe(_=>{this.refreshLayout()}),this.viewUI$.pipe((0,M.p)(_=>!(0,V.isNil)(_)),(0,q.Z)(100),(0,J.F)(),(0,g.Q)(this.ngUnsubscribe)).subscribe(_=>{this.applicationEventService.fireEvent(at.F.UIUpdated,_)}),this.viewWindow$.pipe((0,g.Q)(this.ngUnsubscribe)).subscribe(_=>{this.applicationEventService.fireEvent(at.F.UIWindowUpdated,_)}),(0,de.z)([this.viewLayout$,this.isMobileWeb$,this.drawerVisible$,this.paginationVisible$,this.titleOnlyVisible$]).pipe((0,g.Q)(this.ngUnsubscribe)).subscribe(([_,t,i,o,s])=>{this.isLogoRaised=!(!t||_!==Ai.G.Drawer)&&(!i&&s||o&&i)})}initViewUIObserver(){var n;(0,de.z)([this.horizontalBreakpoint$,this.verticalBreakpoint$,(n=this.engineContainer.nativeElement,new d.c(_=>{const t=new ResizeObserver(i=>{_.next(i)});return t.observe(n),function(){t.unobserve(n)}})),this.viewWindow$,this.store.select(b.N.getSelectedChapterId),this.store.select(_i.N.getStoryLoadProgress),this.store.select(O.dF.getUI),this.store.select(Fe.y.getSelectedLabel)]).pipe((0,g.Q)(this.ngUnsubscribe),(0,Re.B)(30)).subscribe(()=>{this.store.dispatch(new kn.p.ToggleVisible({[E.U.Audio]:this.viewUIService.isVisible(E.U.Audio),[E.U.Camera]:this.viewUIService.isVisible(E.U.Camera),[E.U.Column]:this.viewUIService.isVisible(E.U.Column),[E.U.ColumnToggle]:this.viewUIService.isVisible(E.U.ColumnToggle),[E.U.Drawer]:this.viewUIService.isVisible(E.U.Drawer),[E.U.DrawerToggle]:this.viewUIService.isVisible(E.U.DrawerToggle),[E.U.Description]:this.viewUIService.isVisible(E.U.Description),[E.U.Fullscreen]:this.viewUIService.isVisible(E.U.Fullscreen),[E.U.Help]:this.viewUIService.isVisible(E.U.Help),[E.U.LabelList]:this.viewUIService.isVisible(E.U.LabelList),[E.U.Legend]:this.viewUIService.isVisible(E.U.Legend),[E.U.Logo]:this.viewUIService.isVisible(E.U.Logo),[E.U.Media]:this.viewUIService.isVisible(E.U.Media),[E.U.ToolbarOverflow]:this.viewUIService.isVisible(E.U.ToolbarOverflow),[E.U.NodeInfo]:this.viewUIService.isVisible(E.U.NodeInfo),[E.U.Pagination]:this.viewUIService.isVisible(E.U.Pagination),[E.U.Playthrough]:this.viewUIService.isVisible(E.U.Playthrough),[E.U.QuizPrompt]:this.viewUIService.isVisible(E.U.QuizPrompt),[E.U.Search]:this.viewUIService.isVisible(E.U.Search),[E.U.TitleOnly]:this.viewUIService.isVisible(E.U.TitleOnly),[E.U.Toolbar]:this.viewUIService.isVisible(E.U.Toolbar),[E.U.Tools]:this.viewUIService.isVisible(E.U.Tools),[E.U.ToggleLabels]:this.viewUIService.isVisible(E.U.ToggleLabels),[E.U.Undo]:this.viewUIService.isVisible(E.U.Undo),[E.U.VisibilityLayers]:this.viewUIService.isVisible(E.U.VisibilityLayers),[E.U.SkinLayers]:this.viewUIService.isVisible(E.U.SkinLayers),[E.U.Whiteboard]:this.viewUIService.isVisible(E.U.Whiteboard)}))})}initKeyboardObserver(){this.inputEnabled$.pipe((0,g.Q)(this.ngUnsubscribe)).subscribe(_=>{_?this.bindKeyboard():this.unbindKeyboard()})}initNodeObserver(){this.actions.pipe((0,c.xi)(Ae.zE),(0,g.Q)(this.ngUnsubscribe)).subscribe(_=>{this.viewService.delegateNodeClick(_.node,_.event)}),this.store.select(xt.z.getSelectedNode).pipe((0,si.J)(),(0,g.Q)(this.ngUnsubscribe)).subscribe(([_,t])=>{const i=(0,V.get)(_,"objectId",void 0),o=(0,V.get)(t,"objectId",void 0);(void 0===t||i!==o)&&this.viewService.toggleNodeInfo(!1)})}initChapterObserver(){this.store.select(b.N.getSelectedChapterId).pipe((0,M.p)(_=>!!_),(0,ve.T)(()=>this.store.selectSnapshot(b.N.getSelectedChapter)),(0,g.Q)(this.ngUnsubscribe)).subscribe(_=>{this.store.dispatch(new Ct.S3),this.setPageTitle(_),this.refreshLayout(),this.viewService.resetUI(),this.viewService.resetContentMode()}),this.store.select(te.S.getChapter).pipe((0,M.p)(_=>!!_),(0,ve.T)(()=>this.store.selectSnapshot(b.N.getSelectedChapter)),(0,g.Q)(this.ngUnsubscribe)).subscribe(_=>{this.viewService.applyChapterCamera(_),this.viewService.applyChapterScenegraph(_),this.engineService.fireEvent($t.X.SceneLoaded,null);const t=this.store.selectSnapshot(b.N.getChapterPagination);if(this.liveAnnouncer.announce(_.displayName?`Changed to ${_.displayName}, ${t.label}`:`Changed to ${t.label}`),this.store.selectSnapshot(f.Pf.getPlaythroughEnabled)){const o=this.store.selectSnapshot(f.Pf.getForceAudio);this.viewPlaythroughService.startChapterTimers(_,o);const s=this.store.selectSnapshot(b.N.getNextChapter);this.viewPlaythroughService.preloadAudio([s],o)}})}startPlaythroughMonitoring(){this.stopPlaythroughMonitoring(),this.playthroughMonitor$=(0,de.z)([this.viewPlaythroughService.audioSubject,this.viewPlaythroughService.animationSubject,this.viewPlaythroughService.readingSubject,this.viewPlaythroughService.minimumSubject]).pipe((0,q.Z)(50),(0,ve.T)(([_,t,i,o])=>_.complete&&t.complete&&i.complete&&o.complete),(0,J.F)(),(0,g.Q)(this.ngUnsubscribe)).subscribe(_=>{_&&this.viewPlaythroughService.startCountdown()}),this.playthroughCountdown$=this.viewPlaythroughService.countdownComplete.pipe((0,M.p)(()=>this.store.selectSnapshot(f.Pf.getPlaythroughEnabled)),(0,g.Q)(this.ngUnsubscribe)).subscribe(()=>{const _=this.store.selectSnapshot(f.Pf.getPlaythroughSettings);this.store.selectSnapshot(b.N.isLastChapter)?_.loop?this.viewService.firstChapter("Playthrough Loop"):this.openPlaythroughDialog():this.viewService.nextChapter("playthrough")}),this.playthroughInterrupt$=(0,oi.h)((0,ye.R)(document,"mousemove").pipe((0,q.Z)(50),(0,M.p)(_=>_.buttons>0)),(0,ye.R)(document,"mousedown"),(0,ye.R)(document,"keydown"),(0,ye.R)(document,"wheel")).pipe((0,M.p)(()=>this.viewPlaythroughService.audioSubject.getValue().complete&&this.viewPlaythroughService.animationSubject.getValue().complete&&this.viewPlaythroughService.readingSubject.getValue().complete&&this.viewPlaythroughService.minimumSubject.getValue().complete),(0,g.Q)(this.ngUnsubscribe)).subscribe(_=>{this.viewPlaythroughService.delayCountdown()})}stopPlaythroughMonitoring(){[this.playthroughMonitor$,this.playthroughCountdown$,this.playthroughInterrupt$].forEach(_=>{_ instanceof Ur.yU&&_.unsubscribe()})}openPlaythroughDialog(){(0,V.isNil)(this.playthroughDialog)&&(this.playthroughDialog=this.dialog.open(yi,{width:"100%",height:"100%"}),this.playthroughDialog.closed.pipe((0,g.Q)(this.ngUnsubscribe)).subscribe(_=>{switch(_){case"explore":this.stopPlaythrough(),this.viewService.togglePlaythrough(!1,!1),this.viewService.firstChapter("Playthrough Modal - Explore");break;case"playAgain":this.viewService.togglePlaythrough(!0,!0),this.viewService.firstChapter("Playthrough Modal - Play Again");break;case"takeQuiz":this.stopPlaythrough(),this.viewService.togglePlaythrough(!1,!1),this.viewQuizService.startQuiz();break;default:this.stopPlaythrough(),this.viewService.togglePlaythrough(!1,!1)}this.playthroughDialog=null}))}initChapterAudioPlayer(){this.store.select(b.N.getSelectedChapterId).pipe((0,M.p)(_=>!!_),(0,Co.M)(()=>{this.mediaService.stopAllAudio()}),(0,Re.B)(300),(0,g.Q)(this.ngUnsubscribe)).subscribe(()=>{const _=this.store.selectSnapshot(f.Pf.getForceAudio);this.store.selectSnapshot(w.j.getQuizModeActive)||(_||this.viewUIService.isAudioVisible())&&this.viewService.playChapterAudio(_)})}initLoadProgressObserver(){this.chapterLoadProgress=0,this.store.select(_i.N.getChaptersLoadProgress).pipe((0,g.Q)(this.ngUnsubscribe)).subscribe(_=>{const t=this.store.selectSnapshot(Ce.t.getLoadingChapter),i=this.store.selectSnapshot(b.N.getSelectedChapterId);if(!(0,V.isNil)(t)&&i===t.chapterId){const s=100*(_[i]??0),a=this.store.selectSnapshot(f.Pf.getOpenWindow)===_t.U.XRLoader;this.store.dispatch(new Q.B.ToggleWindow(_t.U.Loader,!a)),this.chapterLoadProgress=s,this.changeDetectorRef.markForCheck()}}),this.store.select(_i.N.getStoryLoadProgress).pipe((0,g.Q)(this.ngUnsubscribe)).subscribe(_=>{this.engineService.fireEvent($t.X.HumanProgress,{progress:_})}),this.actions.pipe((0,c.rM)(No.dC),(0,g.Q)(this.ngUnsubscribe)).subscribe(()=>{this.chapterLoadProgress=100,this.changeDetectorRef.markForCheck(),this.store.dispatch(new Q.B.ToggleWindow(_t.U.Loader,!1)),this.liveAnnouncer.announce("Loading complete","polite")})}initPlaythroughObserver(){(0,de.z)([this.store.select(f.Pf.getPlaythroughEnabled),this.viewWindow$,this.quizModeActive$]).pipe((0,J.F)(),(0,g.Q)(this.ngUnsubscribe)).subscribe(([_,t,i])=>{_&&null===t&&!0!==i?this.startPlaythrough():this.stopPlaythrough()})}initWindowObserver(){this.viewWindow$.pipe((0,g.Q)(this.ngUnsubscribe)).subscribe(_=>{if(this.viewService.resetUI(),_===_t.U.Tutorial||_===_t.U.Interact)this.viewService.resetChapter(),this.viewService.toggleLabels(!1);else{const t=this.viewUIService.isUIEnabled(E.U.Labels);this.viewService.toggleLabels(t)}})}initMobileNav(){const _=(this.platform.ANDROID||this.platform.IOS||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1)&&(!function $r(){try{return window.self!==window.top}catch{return!0}}()||ei.c.platform===Ro.N.SDK);this.store.dispatch(new Q.B.SetIsMobileWeb(_))}initBackgroundColorObserver(){this.background$.pipe((0,g.Q)(this.ngUnsubscribe)).subscribe(_=>{this.isBackgroundLight=(0,yo.T4)(_),this.changeDetectorRef.markForCheck()})}initToolsFadeout(){this.showTools$.pipe((0,g.Q)(this.ngUnsubscribe),(0,J.F)()).subscribe(i=>{this.showZones=this.store.selectSnapshot(f.Pf.getIsMobileWeb)?i?["top","right","bottom","left"]:["bottom"]:i?["top","right","bottom","left"]:["top"],this.changeDetectorRef.markForCheck()});const _=this.store.selectSnapshot(f.Pf.getFadeout);0===_&&this.showTools$.next(!0);const t=this.store.selectSnapshot(f.Pf.getIsMobileWeb);this.viewLayout$.pipe((0,g.Q)(this.ngUnsubscribe),(0,J.F)()).subscribe(i=>{this.showTools$.next(i===Ai.G.Column||0===_||t)}),this.showTools$.pipe((0,M.p)(i=>!0===i),(0,M.p)(()=>0!==_),(0,Re.B)(this.store.selectSnapshot(f.Pf.getFadeout)),(0,M.p)(()=>this.viewLayout$.getValue()!==Ai.G.Column),(0,M.p)(()=>!t),(0,M.p)(()=>!this.store.selectSnapshot(f.Pf.getFadeoutPaused)),(0,g.Q)(this.ngUnsubscribe)).subscribe(()=>{this.showTools$.next(!1)}),this.focusMonitor.monitor(document.body,!0).pipe((0,g.Q)(this.ngUnsubscribe)).subscribe(i=>{this.focusOrigin=i,("keyboard"===i||"touch"===i)&&this.showTools$.next(!0)}),this.viewService.observeMaterialOverlay(),this.viewService.materialOverlayOut$.pipe((0,g.Q)(this.ngUnsubscribe)).subscribe(()=>{this.store.dispatch(new Q.B.SetPreventFadeoutEvent("overlay",this.viewService.isMaterialMenuOut()))})}initVendorAnalyticsEvents(){const _={totalQuestions:0};this.store.select(w.j.getQuestionTotal).pipe((0,g.Q)(this.ngUnsubscribe)).subscribe(t=>{_.totalQuestions=t}),this.store.select(w.j.getQuizModeActive).pipe((0,M.p)(()=>this.store.selectSnapshot(w.j.getQuestionTotal)>0),(0,g.Q)(this.ngUnsubscribe)).subscribe(t=>{t&&this.vendorAnalyticsService.track("Quiz - Entered",_)}),this.actions.pipe((0,c.xi)(It.B.SubmitQuestionAnswer),(0,g.Q)(this.ngUnsubscribe)).subscribe(()=>{const t=this.store.selectSnapshot(w.j.getActiveQuestionIndex),i=this.store.selectSnapshot(w.j.getQuestionsRemaining);0===t&&this.vendorAnalyticsService.track("Quiz - First Question Answered",_),0===i&&this.vendorAnalyticsService.track("Quiz - Completed",_)}),this.store.select(b.N.getSelectedChapterModelReady).pipe((0,M.p)(t=>t),(0,pt.s)(1),(0,g.Q)(this.ngUnsubscribe)).subscribe(()=>{const t=this.store.selectSnapshot(Ce.t.getStoryId),i=this.store.selectSnapshot(Ce.t.getStory);this.vendorAnalyticsService.trackOncePerPage("View - Loaded",{id:t,chapters:i.chapters.length,tour:i.tags.includes("tour"),animated:i.tags.includes("animated"),quiz:this.store.selectSnapshot(w.j.hasQuiz),edit:!1})})}initAccessibility(){this.actions.pipe((0,c.xi)(dt.yr)).subscribe(_=>{this.liveAnnouncer.announce("Object "+(_.show?"shown":"hidden"))})}initTooltips(){this.mediaUI$.pipe((0,g.Q)(this.ngUnsubscribe)).subscribe(_=>{this.mediaBarTooltip="collapse"===_?.status?$localize`Open Media Bar`:$localize`Close Media Bar`,this.changeDetectorRef.markForCheck()})}initQuizStateListener(){(0,de.z)([this.actions.pipe((0,c.rM)(No.t1)),this.store.select(Vt.J.getSelectedBookmarkViewMode)]).pipe((0,M.p)(([,_])=>!(0,V.isNil)(_)),(0,g.Q)(this.ngUnsubscribe)).subscribe(([,_])=>{const t=this.store.selectSnapshot(w.j.getQuizSettings);this.store.dispatch(new It.B.SetQuizSettings({...t,enabled:_!==vi._.Content}))})}initVisibilityLayers(){this.visibilityLayersService.initObservables(),this.legacyVisibilityLayersService.initObservables()}destroyVisibilityLayers(){this.visibilityLayersService.destroyObservables(),this.legacyVisibilityLayersService.destroyObservables()}initAnatomyTree(){this.store.dispatch(new Xr.Z(!1))}handleExitARClick(){this.store.dispatch(new Q.B.ToggleWindow(_t.U.XRLoader,!1))}handleFirstClickTracking(_){_.composedPath().some(s=>"APP-SITE-HEADER"===s.nodeName)||1===this.store.selectSnapshot(_i.N.getStoryLoadProgress)&&this.vendorAnalyticsService.trackOncePerPage("First Click")}handleToggleAutoplay(_){this.viewService.toggleAutoplay(_)}handleColumnToggle(){this.viewService.toggleColumn(),this.changeDetectorRef.markForCheck()}handleDrawClick(){this.viewService.toggleWhiteboard(!0)}handleQuizClick(){this.viewQuizService.startQuiz()}handleExitQuiz(){this.viewQuizService.exitQuiz()}handleToggleSearch(_){this.viewService.toggleSearch(ut.q.Tree,_)}handleToggleLayers(){this.viewService.toggleLayers(!1)}handleSelectTool(_){this.viewService.selectTool(_)}handleToggleMedia(_){this.viewService.toggleMedia(_)}checkLabelsCollapsed(){const _=this.store.selectSnapshot(Mi.V.getHorizontalBreakpoint),t=this.store.selectSnapshot(f.Pf.getLabelsBreakpoint),i=this.isLabelBreaking(t);this.store.dispatch(new Ct.vf(i,_>=pn.m.Large?Mo.Q.Toggle:Mo.Q.None))}isLabelBreaking(_){return window.innerWidth<_}bindKeyboard(){Me.bind("1",()=>this.viewService.selectTool(je.s.Select)),Me.bind("2",()=>this.viewService.selectTool(je.s.Hide)),Me.bind("3",()=>this.viewService.selectTool(je.s.Fade)),Me.bind(["command+,","ctrl+,"],_=>{_.preventDefault(),this.store.selectSnapshot(Mi.V.getHorizontalBreakpoint)>pn.m.Medium?this.viewService.toggleColumn():this.viewService.toggleDrawer(),this.changeDetectorRef.markForCheck()}),Me.bind(["command+enter","ctrl+enter","command+p"],_=>{_.preventDefault(),Ee.g.toggleFullscreen()}),Me.bind("meta+z",_=>{_.preventDefault(),this.viewService.undo()}),Me.bind(["meta+y","meta+shift+z"],_=>{_.preventDefault(),this.viewService.redo()}),Me.bind([".","pagedown"],()=>this.viewService.nextChapter("Keyboard")),Me.bind([",","pageup"],()=>this.viewService.previousChapter("Keyboard")),Me.bind(["del","backspace"],_=>{_.preventDefault(),this.viewService.hideSelectedStructures()}),Me.bind("R",_=>{_.preventDefault(),this.viewService.resetChapter()}),Me.bind("p",_=>{_.preventDefault(),this.viewService.togglePan()}),Me.bind("/",()=>{const _=this.store.selectSnapshot(w.j.getQuizModeActive),t=this.store.selectSnapshot(O.dF.getUIEntry(E.U.Search))?.enable??!1;!_&&t&&this.viewService.toggleSearch()}),Me.bind("?",()=>this.viewService.toggleHelp(wn.J.Shortcuts)),Me.bind(["space","k"],_=>{_.preventDefault(),this.viewService.toggleAnimation()}),Me.bind(["j","l"],_=>{switch(_.preventDefault(),_.key){case"j":this.animationService.scrubRelative(-1,!0);break;case"l":this.animationService.scrubRelative(1,!0)}}),Me.bind(["H","I","F"],_=>{_.preventDefault();const t=this.store.selectSnapshot(xt.z.getCheckedNodeIds);if(t.length>0)switch(_.key){case"H":this.store.dispatch(new dt.yr(!1,t));break;case"I":this.nodeService.hideInverse(t);break;case"F":this.nodeService.fade(t)}})}unbindKeyboard(){Me.reset()}resizeEngineContainer(){const{top:_,left:t,width:i,height:o}=this.engineContainer.nativeElement.getBoundingClientRect(),s=new Vr.j(i,o,t,_,i,o,Dr.g.Shown,1);this.store.dispatch(new Ae.Sh(s))}updateViewHeight(){const _=this.store.selectSnapshot(ai.W.getSiteHeader),t=this.store.selectSnapshot(ai.W.getSiteHeaderHeight),i=(0,un.Un)(_),o=(0,un.mJ)(_,t,i);this.view.nativeElement.style.setProperty("--vh",`${o}px`)}resetScene(){this.store.dispatch(new Ae.t5(!0)),this.store.dispatch(new Ae.dB(!1)),this.store.dispatch(new Ae.pL(je.s.Select)),this.store.dispatch(new wo.J),this.store.dispatch(new hn.pU(!1)),this.engineService.getEvent($t.X.AssetsLoadProgress).pipe((0,pt.s)(1),(0,g.Q)(this.ngUnsubscribe)).subscribe(()=>{this.store.dispatch(new Ae.dB(!0))})}refreshLayout(){const _=this.store.selectSnapshot(O.dF.getUI),t=this.store.selectSnapshot(f.Pf.getLayout);this.viewLayout$.next(this.viewUIService.getViewLayout(t)),this.columnLayoutStatus=_.column.status,this.updateViewHeight(),this.resizeEngineContainer(),this.store.dispatch(new Ct.Tz(_.anatomyLabels.enable??!0,_.nodeInfo.enable??!0,!0,_.nodeAudio.enable??!0)),this.store.dispatch(new Ae.Gv((_.labels.enable??!0)&&(_.labels.shown??!0))),this.changeDetectorRef.markForCheck()}setPageTitle(_){const t=(0,V.get)(_,"displayName");this.title.setTitle((t?`${t} | `:"")+"BioDigital Human Platform")}deselectLabel(){this.store.dispatch(new Ct.TR(null))}startPlaythrough(){this.startPlaythroughMonitoring();const _=this.store.selectSnapshot(f.Pf.getPlaythroughSettings);this.store.dispatch(new Q.B.SetForceAudio(_.forceAudio));const t=_.forceAudio,i=this.store.selectSnapshot(b.N.getSelectedChapter),o=this.store.selectSnapshot(f.Pf.getViewLanguage);(t||this.mediaService.chapterHasAudio(i,o))&&(this.store.dispatch(new gn.O.SetAudioMuted(!1)),this.viewService.playChapterAudio(t),this.store.dispatch(new kn.p.ToggleVisible({[E.U.Audio]:!0}))),this.viewPlaythroughService.startChapterTimers(i,t)}stopPlaythrough(){this.stopPlaythroughMonitoring(),this.viewPlaythroughService.clearChapterTimers(),this.mediaService.stopAllAudio(),this.mediaService.muteAudio(),this.store.dispatch(new gn.O.SetAudioMuted(!0))}static#e=this.\u0275fac=function(t){return new(t||I)(e.rXU(nt.nX),e.rXU(e.gRc),e.rXU(c.il),e.rXU(c.En),e.rXU(k.Ai),e.rXU(F.z),e.rXU(Oi.k),e.rXU(io.d),e.rXU(ni.y),e.rXU(Eo.w),e.rXU(Ut.O),e.rXU(Gn.S),e.rXU(uo.e),e.rXU(We.u),e.rXU(eo.hE),e.rXU(nn.OD),e.rXU(Yi),e.rXU(k.FN),e.rXU(Po.lG),e.rXU(co.u),e.rXU(Tt.n))};static#t=this.\u0275cmp=e.VBU({type:I,selectors:[["app-view-page"]],viewQuery:function(t,i){if(1&t&&(e.GBs(Ru,7),e.GBs(Pu,7),e.GBs(Uu,5),e.GBs(Vu,7),e.GBs(Du,7),e.GBs(Lu,5),e.GBs(xu,5),e.GBs($u,7),e.GBs(ku,5)),2&t){let o;e.mGM(o=e.lsd())&&(i.viewContainer=o.first),e.mGM(o=e.lsd())&&(i.columnContainer=o.first),e.mGM(o=e.lsd())&&(i.drawerContainer=o.first),e.mGM(o=e.lsd())&&(i.engineContainer=o.first),e.mGM(o=e.lsd())&&(i.view=o.first),e.mGM(o=e.lsd())&&(i.viewCameraBar=o.first),e.mGM(o=e.lsd())&&(i.viewLogo=o.first),e.mGM(o=e.lsd())&&(i.viewSceneBase=o.first),e.mGM(o=e.lsd())&&(i.viewToolbar=o.first)}},hostBindings:function(t,i){1&t&&e.bIt("click",function(s){return i.onClick(s)},!1,e.EBC)("mousemove",function(s){return i.onActive(s)},!1,e.EBC)("mouseenter",function(s){return i.onActive(s)},!1,e.EBC)("touchstart",function(s){return i.onActive(s)},!1,e.EBC)("mouseleave",function(s){return i.onInactive(s)},!1,e.EBC)},decls:83,vars:116,consts:()=>{let _,t,i,o,s,a,r,u,m;return _=$localize`:␟66a82c6638b304a349b7d43b13482fa7493419c9␟1556772664146095223:Take Quiz`,t=$localize`:␟a8428f42065b95600de48a6a73096f397fe77548␟7584706465725808283:Media Controls`,i=$localize`:␟76fbeb67fc76fbebecb31395a76d10d6f65188f4␟4157627069774048070:Exit Quiz`,o=$localize`:␟774e30c83aba684afbcbdfc30ab51e5ccdbb08ef␟5018030683477673235:Close Anatomy`,s=$localize`:␟b4c7cd9839a91a097a7d23041261d812818f2688␟1240960779977380559:Anatomy Search`,a=$localize`:␟8d649ab3a81d2e70497b706acb98ee078c9625cf␟6438735765171590350:Close anatomy column`,r=$localize`:␟e6871f3c841a7ea3095d82216180cdf00363e630␟7224674749555007457:Close Anatomy Layers`,u=$localize`:␟3a7999f75941d258d1b67979cf1dc683a5db872b␟8605048384026546143:Anatomy Layers`,m=$localize`:␟c02273112dd8379f0d352a3b817f7c69bc525b3c␟7920034665687725450:Close layers`,[["viewContainer",""],["view",""],["engineContainer",""],["viewSceneBase",""],["columnContainer",""],["drawerContainer",""],_,i,s,a,u,m,["id","viewContainer",3,"hidden"],[1,"view-page",3,"ngClass"],["id","engine-container","data-test","viewEngineContainer",1,"view-page__engine"],[3,"contextMenuEnable"],[3,"showZones"],["left",""],[4,"ngIf"],[3,"layout",4,"ngIf"],["top","",4,"ngIf"],["right",""],[1,"flex","flex-col","items-end","justify-end","h-full"],[1,"flex-auto"],[1,"flex","flex-col","gap-2"],["orientation","vertical","data-test","viewFullscreen",4,"ngIf"],["bottom",""],["class","w-full",4,"ngIf"],["class","view-page__logo",3,"ngClass","logoColor","logoSize",4,"ngIf"],["class","view-page__exit-quiz",4,"ngIf"],[1,"view-page__scene-base"],["class","view-page__column",4,"ngIf"],["data-test","viewSearch",3,"floating","padded","wide",4,"ngIf"],["data-test","viewVisibilityLayers",3,"wide","floating","padded",4,"ngIf"],["class","view-page__drawer",4,"ngIf"],["class","view-block-input",4,"ngIf"],[3,"contentId","contentType"],["data-test","viewWhiteboard"],[3,"platform","mode","contentBlocks","title"],[3,"show","percent",4,"ngIf"],[4,"appFlagApplication","appFlagApplicationMode","appFlagApplicationNative"],[3,"layout"],["top",""],["class","w-full view-page__title-nav",4,"ngIf"],[1,"w-full","view-page__title-nav"],["class","view-page__drawer-nav",3,"ngClass",4,"ngIf"],[1,"view-page__drawer-nav",3,"ngClass"],[3,"showPagination",4,"ngIf"],["appPreventFadeout","",4,"ngIf"],[3,"showPagination"],["appPreventFadeout",""],["app-view-button","","buttonSize","small",3,"click"],["size","lg","icon","user-graduate"],["class","flex justify-between w-full",4,"ngIf"],[1,"flex","justify-between","w-full"],[1,"flex","gap-2"],[1,"max-w-sm",3,"showPagination"],["app-view-button","","buttonSize","small","data-test","viewQuizButton",3,"click",4,"ngIf"],["app-view-button","","buttonSize","small","data-test","viewQuizButton",3,"click"],["icon","user-graduate",1,"pl-3"],[1,"px-3","text-xs","font-semibold","uppercase"],["padding","none"],[3,"mode","title","modelUrl","transparent","bordered","compact"],["orientation","vertical","data-test","viewFullscreen"],["buttonSize","small"],[1,"w-full"],["class","flex justify-end gap-2","role","group","aria-label",t,4,"ngIf"],["class","view-page__mobile-nav",3,"ngClass",4,"ngIf"],["role","group","aria-label",t,1,"flex","justify-end","gap-2"],[3,"ngClass",4,"ngIf"],["orientation","horizontal",4,"ngIf"],[3,"ngClass"],["orientation","horizontal","appPreventFadeout","",3,"ngClass"],["appPreventFadeout","","app-view-button","","matTooltipPosition","left","buttonSize","small","data-test","viewMediaToggle",3,"matTooltip","thin","click",4,"ngIf"],["orientation","horizontal"],[1,"w-full",3,"autoFocus","showSpeed","showScrubber"],["appPreventFadeout","","app-view-button","","matTooltipPosition","left","buttonSize","small","data-test","viewMediaToggle",3,"click","matTooltip","thin"],["icon","angle-right","appLogicalDir",""],["icon","angle-left","appLogicalDir",""],[1,"view-page__mobile-nav",3,"ngClass"],[2,"min-width","0",3,"ngClass"],[3,"showPagination","showTitle",4,"ngIf"],[3,"showPagination","showTitle"],[1,"view-page__logo",3,"ngClass","logoColor","logoSize"],[1,"view-page__exit-quiz"],[1,"px-3","text-xs","uppercase"],[1,"view-page__column"],["data-test","viewSearch",3,"floating","padded","wide"],["header",""],[1,"flex","justify-between"],[1,"px-3","py-6","text-base","font-semibold"],["app-view-button","","matTooltip",o,"matTooltipPosition","right","data-test","viewSearchClose",3,"click"],["icon","times"],[1,"sr-only"],["body",""],[1,"h-full","px-3"],["data-test","viewVisibilityLayers",3,"wide","floating","padded"],["app-view-button","","matTooltip",r,"matTooltipPosition","right","data-test","viewVisibilityLayersClose",3,"click"],[1,"h-full","px-3","py-4"],[1,"view-page__drawer"],[1,"view-block-input"],[3,"learnMoreClick","platform","mode","contentBlocks","title"],[3,"percent"],[3,"show","percent"]]},template:function(t,i){if(1&t&&(e.j41(0,"div",12,0),e.nI1(2,"async"),e.j41(3,"div",13,1),e.nI1(5,"async"),e.nI1(6,"async"),e.nI1(7,"async"),e.nI1(8,"async"),e.nI1(9,"async"),e.nI1(10,"async"),e.nI1(11,"async"),e.nI1(12,"async"),e.nI1(13,"async"),e.nI1(14,"async"),e.j41(15,"div",14,2),e.nrm(17,"app-engine",15),e.nI1(18,"async"),e.j41(19,"app-view-zones",16),e.qex(20,17),e.DNE(21,ju,1,0,"app-view-toolbar",18),e.nI1(22,"async"),e.DNE(23,Hu,2,3,"app-view-undo",19),e.nI1(24,"async"),e.bVm(),e.DNE(25,eh,6,9,"ng-container",20),e.nI1(26,"async"),e.nI1(27,"async"),e.DNE(28,ah,5,7,"ng-container",20),e.nI1(29,"async"),e.DNE(30,rh,1,0,"ng-container",20),e.nI1(31,"async"),e.nI1(32,"async"),e.qex(33,21),e.j41(34,"div",22),e.DNE(35,lh,5,10,"div",23),e.nI1(36,"async"),e.nI1(37,"async"),e.nI1(38,"async"),e.nI1(39,"async"),e.j41(40,"div",24),e.DNE(41,ch,1,0,"app-engine-camera-bar",18),e.nI1(42,"async"),e.DNE(43,dh,2,0,"app-pillbox",25),e.nI1(44,"async"),e.k0s()(),e.bVm(),e.qex(45,26),e.DNE(46,Th,6,8,"div",27),e.nI1(47,"async"),e.nI1(48,"async"),e.bVm(),e.k0s(),e.DNE(49,bh,5,15,"app-view-logo",28),e.nI1(50,"async"),e.DNE(51,vh,5,0,"div",29),e.nI1(52,"async"),e.nI1(53,"async"),e.nrm(54,"div",30,3),e.k0s(),e.j41(56,"div",null,4),e.DNE(58,Oh,1,0,"app-view-column-container",31),e.nI1(59,"async"),e.DNE(60,Ch,13,5,"app-view-column",32),e.nI1(61,"async"),e.DNE(62,Ih,13,5,"app-view-column",33),e.nI1(63,"async"),e.nI1(64,"async"),e.k0s(),e.DNE(65,Mh,3,0,"div",34),e.nI1(66,"async"),e.k0s()(),e.DNE(67,wh,1,0,"div",35),e.nI1(68,"async"),e.DNE(69,Ah,1,2,"app-view-ondemand",36),e.nI1(70,"async"),e.DNE(71,yh,1,0,"app-view-tour")(72,Nh,1,0,"app-view-whiteboard",37)(73,Rh,5,12,"app-xr-loader-summary",38)(74,Lh,6,3,"app-view-loader")(75,xh,2,4,"app-view-progress",39),e.nI1(76,"async"),e.DNE(77,$h,1,0,"app-view-print",18),e.nI1(78,"async"),e.DNE(79,kh,1,0,"app-view-content-warning",40),e.nrm(80,"app-view-iphone12-warning"),e.DNE(81,Gh,1,0,"app-xr-overlay"),e.nI1(82,"async")),2&t){let o,s,a,r,u,m;e.Y8G("hidden",e.bMT(2,27,i.arActive$)),e.R7$(3),e.Y8G("ngClass",e.lV(107,Gu,"column"===e.bMT(5,29,i.viewLayout$),"drawer"===e.bMT(6,31,i.viewLayout$),e.bMT(7,33,i.paginationVisible$),e.bMT(8,35,i.columnVisible$),!1===e.bMT(9,37,i.columnVisible$),e.bMT(10,39,i.drawerVisible$)&&"show"===(null==(o=e.bMT(11,41,i.drawerUI$))?null:o.status),!1===e.bMT(12,43,i.drawerVisible$),e.bMT(13,45,i.drawerVisible$)&&"collapse"===(null==(o=e.bMT(14,47,i.drawerUI$))?null:o.status))),e.R7$(14),e.Y8G("contextMenuEnable",null==(s=e.bMT(18,49,i.contextMenu$))?null:s.enable),e.R7$(2),e.Y8G("showZones",i.showZones),e.R7$(2),e.Y8G("ngIf",e.bMT(22,51,i.toolbarVisible$)),e.R7$(2),e.Y8G("ngIf",e.bMT(24,53,i.undoVisible$)),e.R7$(2),e.Y8G("ngIf","drawer"===e.bMT(26,55,i.viewLayout$)&&!1===e.bMT(27,57,i.isMobileWeb$)),e.R7$(3),e.Y8G("ngIf","column"===e.bMT(29,59,i.viewLayout$)),e.R7$(2),e.Y8G("ngIf","drawer"===e.bMT(31,61,i.viewLayout$)&&!0===e.bMT(32,63,i.isMobileWeb$)),e.R7$(5),e.vxM((e.bMT(36,65,i.arEnabled$)||e.bMT(37,67,i.nativeAREnabled$))&&!1===e.bMT(38,69,i.arActive$)&&e.bMT(39,71,i.viewWindow$)!==i.viewWindow.XRLoader?35:-1),e.R7$(6),e.Y8G("ngIf",e.bMT(42,73,i.cameraVisible$)),e.R7$(2),e.Y8G("ngIf",e.bMT(44,75,i.fullscreenVisible$)),e.R7$(3),e.Y8G("ngIf",!0===e.bMT(47,77,i.isMobileWeb$)||e.bMT(48,79,i.mediaVisible$)),e.R7$(3),e.Y8G("ngIf",e.bMT(50,81,i.logoVisible$)),e.R7$(2),e.Y8G("ngIf",e.bMT(52,83,i.quizModeActive$)&&!e.bMT(53,85,i.quizModeLocked$)),e.R7$(7),e.Y8G("ngIf",e.bMT(59,87,i.columnVisible$)),e.R7$(2),e.Y8G("ngIf","show"===(null==(a=e.bMT(61,89,i.searchUI$))?null:a.status)),e.R7$(2),e.Y8G("ngIf","show"===(null==(r=e.bMT(63,91,i.visibilityLayersUI$))?null:r.status)&&"group"===(null==(r=e.bMT(64,93,i.visibilityLayersUI$))?null:r.layersMode)),e.R7$(3),e.Y8G("ngIf",e.bMT(66,95,i.drawerVisible$)),e.R7$(2),e.Y8G("ngIf",!1===e.bMT(68,97,i.inputEnabled$)),e.R7$(2),e.vxM((u=e.bMT(70,99,i.viewWindow$))===i.viewWindow.OnDemand?69:u===i.viewWindow.Tutorial?71:u===i.viewWindow.Whiteboard?72:u===i.viewWindow.XRLoader?73:u===i.viewWindow.Interact?74:-1),e.R7$(6),e.Y8G("ngIf","circle"===(null==(m=e.bMT(76,101,i.viewUI$))?null:m.loader.template)),e.R7$(2),e.Y8G("ngIf",e.bMT(78,103,i.usePrintImage$)),e.R7$(2),e.Y8G("appFlagApplication",i.application.All)("appFlagApplicationMode","include")("appFlagApplicationNative",i.nativePlatform.All),e.R7$(2),e.vxM(e.bMT(82,105,i.arActive$)?81:-1)}},dependencies:[P.ri,p.YU,p.bT,Xe.Y,oe.s,Ot.e,Fr._,zr.k,D.R,j.oV,Ze.O,In.p,rt,ci,en,Un,mi,bo,Oo,ln.R,Mn,go,Nn,Rn,Ye,Uo,Vo,Do,ui,ld,Li,fe,Rd,Vd,xd,$i,ki,cp,lt,Si,it,n_,qo,p.Jj],styles:['.view-page{--drawer-height: 0;--column-width: 320px;border:none;width:100vw;height:calc(var(--vh, 1vh) * 100);max-height:100vh;overflow:hidden;display:grid;transition:all .25s}.view-page--layout-column{grid-template-rows:100%;grid-template-columns:var(--column-width) 1fr;grid-template-areas:"column engine"}.view-page--layout-drawer{grid-template-rows:1fr var(--drawer-height);grid-template-columns:1fr;grid-template-areas:"engine" "drawer"}.view-page--column-open{--column-width: 320px}.view-page--column-open.view-page--show-aside{--column-width: 424px}.view-page--column-closed{--column-width: 0}.view-page--drawer-peek{--drawer-height: 40px}.view-page--drawer-open{--drawer-height: 40%}.view-page--drawer-closed.view-page--has-drawer{--drawer-height: 0}.view-page__column{background-color:#fff;grid-area:column;height:100%}.view-page__engine{grid-area:engine;width:100%;height:100%;position:relative}.view-page__drawer{max-width:100vw;border-top:1px solid #d7e0ea;background-color:#fff;grid-area:drawer}.view-page--drawer-push{padding-bottom:var(--drawer-height)}.view-page__title-nav{display:flex;justify-content:flex-start;gap:8px}.view-page__drawer-nav{display:grid;grid-template-columns:minmax(0,1fr) auto;width:auto}.view-page__drawer-nav--overflow{gap:8px}.view-page__mobile-nav{display:flex;justify-content:space-between;gap:8px;width:auto}.view-page__logo{display:inline-block;position:absolute;inset-inline-start:12px;inset-block-end:12px;z-index:10}.view-page__logo--raised{inset-block-end:62px}.view-page__exit-quiz{position:absolute;inset-block-start:12px;inset-inline-end:12px;z-index:10}.view-page__scene-base{position:absolute;left:0;bottom:0;right:0;z-index:10;transition:transform .3s}@media (prefers-reduced-motion: reduce){.view-page{transition:none}}.view-block-input{position:fixed;inset:0;z-index:10000}\n'],encapsulation:2,changeDetection:0})}A([(0,c.l6)(Ce.t.getStory),y("design:type",d.c)],I.prototype,"story$",void 0),A([(0,c.l6)(Ce.t.getStoryId),y("design:type",d.c)],I.prototype,"storyId$",void 0),A([(0,c.l6)(O.dF.getUI),y("design:type",d.c)],I.prototype,"viewUI$",void 0),A([(0,c.l6)(f.Pf.getAutoplay),y("design:type",d.c)],I.prototype,"autoplay$",void 0),A([(0,c.l6)(f.Pf.getInputEnabled),y("design:type",d.c)],I.prototype,"inputEnabled$",void 0),A([(0,c.l6)(f.Pf.getIsMobileWeb),y("design:type",d.c)],I.prototype,"isMobileWeb$",void 0),A([(0,c.l6)(f.Pf.getContentMode),y("design:type",d.c)],I.prototype,"contentMode$",void 0),A([(0,c.l6)(f.Pf.getFullscreenActive),y("design:type",d.c)],I.prototype,"fullscreenActive$",void 0),A([(0,c.l6)(f.Pf.getDrawerCoversContent),y("design:type",d.c)],I.prototype,"drawerCoversContent$",void 0),A([(0,c.l6)(f.Pf.getInteractType),y("design:type",d.c)],I.prototype,"interactType$",void 0),A([(0,c.l6)(f.Pf.getOnDemand),y("design:type",d.c)],I.prototype,"onDemand$",void 0),A([(0,c.l6)(f.Pf.getShowHelpTab),y("design:type",d.c)],I.prototype,"showHelpTab$",void 0),A([(0,c.l6)(f.Pf.getUsePrintImage),y("design:type",d.c)],I.prototype,"usePrintImage$",void 0),A([(0,c.l6)(f.Pf.getOpenWindow),y("design:type",d.c)],I.prototype,"viewWindow$",void 0),A([(0,c.l6)(f.Pf.getTutorialSeen),y("design:type",d.c)],I.prototype,"tutorialSeen$",void 0),A([(0,c.l6)(_i.N.getStoryLoadProgress),y("design:type",d.c)],I.prototype,"storyLoadProgress$",void 0),A([(0,c.l6)(Mi.V.getHorizontalBreakpoint),y("design:type",d.c)],I.prototype,"horizontalBreakpoint$",void 0),A([(0,c.l6)(Mi.V.getVerticalBreakpoint),y("design:type",d.c)],I.prototype,"verticalBreakpoint$",void 0),A([(0,c.l6)(b.N.getSelectedChapter),y("design:type",d.c)],I.prototype,"chapter$",void 0),A([(0,c.l6)(b.N.getSelectedChapterReadyState),y("design:type",d.c)],I.prototype,"selectedChapterReady$",void 0),A([(0,c.l6)(b.N.getChaptersLoaded),y("design:type",d.c)],I.prototype,"chaptersLoaded$",void 0),A([(0,c.l6)(b.N.getSelectedChapterIndex),y("design:type",d.c)],I.prototype,"chapterIndex$",void 0),A([(0,c.l6)(b.N.getChapterCount),y("design:type",d.c)],I.prototype,"chapterCount$",void 0),A([(0,c.l6)(b.N.getSelectedChapterBackground),y("design:type",d.c)],I.prototype,"background$",void 0),A([(0,c.l6)(O.dF.getVisible(E.U.Audio)),y("design:type",d.c)],I.prototype,"audioVisible$",void 0),A([(0,c.l6)(te.S.getAnimationPlaying),y("design:type",d.c)],I.prototype,"animationPlaying$",void 0),A([(0,c.l6)(te.S.getHoveredNode),y("design:type",d.c)],I.prototype,"hoveredNode$",void 0),A([(0,c.l6)(te.S.getActiveTool),y("design:type",d.c)],I.prototype,"activeTool$",void 0),A([(0,c.l6)(te.S.getEnginePosition),y("design:type",d.c)],I.prototype,"enginePosition$",void 0),A([(0,c.l6)(te.S.getCanvasHeightBreakpoint),y("design:type",d.c)],I.prototype,"canvasHeightBreakpoint$",void 0),A([(0,c.l6)(Fe.y.getSelectedLabel),y("design:type",d.c)],I.prototype,"selectedLabel$",void 0),A([(0,c.l6)(w.j.hasQuiz),y("design:type",d.c)],I.prototype,"hasQuiz$",void 0),A([(0,c.l6)(w.j.getQuizModeActive),y("design:type",d.c)],I.prototype,"quizModeActive$",void 0),A([(0,c.l6)(w.j.getQuizModeLocked),y("design:type",d.c)],I.prototype,"quizModeLocked$",void 0),A([(0,c.l6)(w.j.getQuizEnabled),y("design:type",d.c)],I.prototype,"quizEnabled$",void 0),A([(0,c.l6)(w.j.getActiveQuestionIndex),y("design:type",d.c)],I.prototype,"activeQuestionIndex$",void 0),A([(0,c.l6)(w.j.getQuestionTotal),y("design:type",d.c)],I.prototype,"questionTotal$",void 0),A([(0,c.l6)(f.Pf.getStartingTool),y("design:type",d.c)],I.prototype,"startingTool$",void 0),A([(0,c.l6)(O.dF.getVisible(E.U.Camera)),y("design:type",d.c)],I.prototype,"cameraVisible$",void 0),A([(0,c.l6)(O.dF.getVisible(E.U.Column)),y("design:type",d.c)],I.prototype,"columnVisible$",void 0),A([(0,c.l6)(O.dF.getVisible(E.U.Drawer)),y("design:type",d.c)],I.prototype,"drawerVisible$",void 0),A([(0,c.l6)(O.dF.getUIEntry(E.U.Drawer)),y("design:type",d.c)],I.prototype,"drawerUI$",void 0),A([(0,c.l6)(O.dF.getVisible(E.U.DrawerToggle)),y("design:type",d.c)],I.prototype,"drawerToggleVisible$",void 0),A([(0,c.l6)(O.dF.getVisible(E.U.Fullscreen)),y("design:type",d.c)],I.prototype,"fullscreenVisible$",void 0),A([(0,c.l6)(O.dF.getVisible(E.U.Logo)),y("design:type",d.c)],I.prototype,"logoVisible$",void 0),A([(0,c.l6)(O.dF.getVisible(E.U.Media)),y("design:type",d.c)],I.prototype,"mediaVisible$",void 0),A([(0,c.l6)(O.dF.getUIEntry(E.U.Media)),y("design:type",d.c)],I.prototype,"mediaUI$",void 0),A([(0,c.l6)(O.dF.getVisible(E.U.NodeInfo)),y("design:type",d.c)],I.prototype,"nodeInfoVisible$",void 0),A([(0,c.l6)(O.dF.getVisible(E.U.QuizPrompt)),y("design:type",d.c)],I.prototype,"quizPromptVisible$",void 0),A([(0,c.l6)(O.dF.getVisible(E.U.Search)),y("design:type",d.c)],I.prototype,"searchVisible$",void 0),A([(0,c.l6)(O.dF.getUIEntry(E.U.Search)),y("design:type",d.c)],I.prototype,"searchUI$",void 0),A([(0,c.l6)(O.dF.getVisible(E.U.TitleOnly)),y("design:type",d.c)],I.prototype,"titleOnlyVisible$",void 0),A([(0,c.l6)(O.dF.getVisible(E.U.Toolbar)),y("design:type",d.c)],I.prototype,"toolbarVisible$",void 0),A([(0,c.l6)(O.dF.getVisible(E.U.Undo)),y("design:type",d.c)],I.prototype,"undoVisible$",void 0),A([(0,c.l6)(O.dF.getVisible(E.U.VisibilityLayers)),y("design:type",d.c)],I.prototype,"visibilityLayersVisible$",void 0),A([(0,c.l6)(O.dF.getUIEntry(E.U.VisibilityLayers)),y("design:type",d.c)],I.prototype,"visibilityLayersUI$",void 0),A([(0,c.l6)(O.dF.getVisible(E.U.ColumnToggle)),y("design:type",d.c)],I.prototype,"columnToggleVisible$",void 0),A([(0,c.l6)(O.dF.getVisible(E.U.Pagination)),y("design:type",d.c)],I.prototype,"paginationVisible$",void 0),A([(0,c.l6)(O.dF.getUIEntry(E.U.ContextMenu)),y("design:type",d.c)],I.prototype,"contextMenu$",void 0),A([(0,c.l6)(we.U.getARActive),y("design:type",d.c)],I.prototype,"arActive$",void 0),A([(0,c.l6)(we.U.getAREnabled),y("design:type",d.c)],I.prototype,"arEnabled$",void 0),A([(0,c.l6)(we.U.getNativeAREnabled),y("design:type",d.c)],I.prototype,"nativeAREnabled$",void 0),A([(0,c.l6)(we.U.getXRPlatform),y("design:type",d.c)],I.prototype,"platform$",void 0);var Wh=l(3909),qn=l(24477),Xh=l(21424),Fh=l(65459),zh=l(39596),Kn=l(38165);class Xi{constructor(_,t,i,o,s,a,r,u,m){this.store=_,this.router=t,this.actions=i,this.cleanupService=o,this.viewService=s,this.quizService=a,this.organizationsService=r,this.activatedRoute=u,this.userAccessService=m,this.ngUnsubscribe=new z.B,this.viewGateSubject=new z.B}ngOnInit(){this.initDynamicLayout(),this.initOrganizationViewConfig(),this.initQuizAutoStart(),ei.c.application===ce.c.Studio&&(this.initContentViews(),this.initPublicViewGate())}ngOnDestroy(){this.viewUI&&this.store.dispatch(new kn.p.SetUI(this.viewUI)),this.store.dispatch(new Q.B.ResetViewState),this.viewGateSubject.next(),this.viewGateSubject.complete(),this.cleanupService.resetScene(),this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initOrganizationViewConfig(){this.store.select(Xh.q.getOrganization).pipe((0,M.p)(_=>!(0,V.isNil)(_)),(0,g.Q)(this.ngUnsubscribe)).subscribe(_=>{const t=this.organizationsService.getOrganizationAttribute(_.group_attributes,"app_settings","anatomy_description_fallback");(0,V.isNil)(t)||this.viewService.setAnatomyDescriptionFallback(t.value)})}initDynamicLayout(){(0,de.z)([this.store.select(b.N.getSelectedChapter),this.store.select(w.j.getQuizModeActive),this.store.select(w.j.getActiveQuestion)]).pipe((0,M.p)(([_])=>null!=_),(0,g.Q)(this.ngUnsubscribe)).subscribe(([_,t,i])=>{const o=(0,qn.Fm)(!0),s=(0,qn.JO)(_.ui),a=(0,qn.VD)(i);this.viewService.setUI({baseUIConfig:o,chapterUIConfig:s,quizUIConfig:t?a:null})})}initQuizAutoStart(){const _=this.activatedRoute.snapshot.queryParams,t=this.store.select(Vt.J.getSelectedBookmark),i=this.store.select(b.N.getSelectedChapterReadyState),o=this.store.select(w.j.hasQuiz);(0,de.z)([t,i,o]).pipe((0,M.p)(([s,a,r])=>{if(!s)return!1;const u=(0,V.get)(a,"model",!1),m=(0,V.get)(_,"quiz",!1);return u&&r&&(m||s.viewMode===vi._.Quiz)}),(0,pt.s)(1),(0,g.Q)(this.ngUnsubscribe)).subscribe(([s])=>{this.quizService.startQuiz(),s.viewMode===vi._.Quiz&&this.store.dispatch(new It.B.SetQuizLocked(!0))})}initContentViews(){const _=this.viewService.normalizeQueryParams(this.activatedRoute.snapshot.queryParams),t=_.id,i=_.type;(0,de.z)([this.store.select(ht.k.getLoggedInState),this.store.select(ht.k.isPremiumUser),this.store.select(b.N.getSelectedChapterModelReady),this.store.select(ht.k.getContentViews)]).pipe((0,M.p)(([o,s,a,r])=>"user"===o?.session_type&&!s&&a&&!r.limit_reached),(0,pt.s)(1),(0,g.Q)(this.ngUnsubscribe)).subscribe(()=>{this.store.dispatch(new Kn.e0(t,i))})}initPublicViewGate(){this.actions.pipe((0,c.xi)(Kn.ec),(0,ve.T)(_=>_.active),(0,Gi.Z)(!1),(0,J.F)(),(0,g.Q)(this.ngUnsubscribe)).subscribe(_=>{_?this.createPublicViewGate():this.destroyPublicViewGate()}),this.store.select(ht.k.getLoggedIn).pipe((0,g.Q)(this.ngUnsubscribe)).subscribe(_=>{this.store.dispatch(new Ae.E7(!_)),this.store.dispatch(new Kn.ec(!_))})}createPublicViewGate(){this.destroyPublicViewGate(),this.store.select(ht.k.getLoggedIn).pipe((0,M.p)(_=>!_),(0,jo.n)(()=>this.userAccessService.createViewinteractionGate(1e4,5,15)),(0,J.F)(),(0,M.p)(_=>_),(0,Gt.Z)(()=>this.userAccessService.openPublicViewGate()),(0,g.Q)(this.viewGateSubject),(0,g.Q)(this.ngUnsubscribe)).subscribe(()=>{this.createPublicViewGate()})}destroyPublicViewGate(){this.userAccessService.closePublicViewGate(),this.viewGateSubject.next()}static#e=this.\u0275fac=function(t){return new(t||Xi)(e.rXU(c.il),e.rXU(nt.Ix),e.rXU(c.En),e.rXU(Wh.M),e.rXU(F.z),e.rXU(Oi.k),e.rXU(Fh.k),e.rXU(nt.nX),e.rXU(zh.p))};static#t=this.\u0275cmp=e.VBU({type:Xi,selectors:[["app-view-internal-page"]],decls:1,vars:0,template:function(t,i){1&t&&e.nrm(0,"router-outlet")},dependencies:[nt.n3],changeDetection:0})}!function(n,_,t,i){var a,o=arguments.length,s=o<3?_:null===i?i=Object.getOwnPropertyDescriptor(_,t):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(n,_,t,i);else for(var r=n.length-1;r>=0;r--)(a=n[r])&&(s=(o<3?a(s):o>3?a(_,t,s):a(_,t))||s);o>3&&s&&Object.defineProperty(_,t,s)}([(0,c.l6)(Ce.t.getStory),function(n,_){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata("design:type",_)}(0,d.c)],Xi.prototype,"story$",void 0);var f_=l(85884);const qh={title:"We're unable to find the model you're looking for.",description:'Please check your URL or visit the <a href="/" target="_blank">BioDigital Human</a> to see what\'s available in our 3D model library.'};var Kh=l(41981);const Zh={title:"Your BioDigital Human embed requires proper authentication.",description:""},Jh={[Kh.U.InvalidUAID]:{title:"Authentication Issues",description:"Your Human Widget has invalid user credentials.",url:"https://support.biodigital.com"}};var e1=l(37678),t1=l(21007);function i1(n,_){if(1&n){const t=e.RV6();e.j41(0,"button",13),e.bIt("click",function(){e.eBV(t);const o=e.XpG(2);return e.Njj(o.handleSeeDetailsClick())}),e.EFF(1," See Details "),e.k0s()}}function n1(n,_){if(1&n&&(e.j41(0,"textarea",14),e.EFF(1,"        "),e.k0s()),2&n){const t=e.XpG(2);e.Y8G("value",t.engineErrorReport)}}function o1(n,_){if(1&n){const t=e.RV6();e.j41(0,"div")(1,"h1",3),e.EFF(2,"The BioDigital Human encountered an error."),e.k0s(),e.j41(3,"h2",4),e.EFF(4," Error: "),e.j41(5,"span",5),e.EFF(6),e.k0s()(),e.j41(7,"div",6),e.EFF(8," To receive assistance with this error, please follow these steps: "),e.k0s(),e.j41(9,"ol",7)(10,"li",8)(11,"button",9),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.handleDownloadClick())}),e.EFF(12," Download "),e.k0s(),e.EFF(13," the error report. "),e.k0s(),e.j41(14,"li",8)(15,"button",9),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.handleActionClick(o.supportURL))}),e.EFF(16," Share the report "),e.k0s(),e.EFF(17," with the customer support team. "),e.k0s()(),e.j41(18,"div",10),e.DNE(19,i1,2,0,"button",11),e.j41(20,"div"),e.DNE(21,n1,2,1,"textarea",12),e.k0s()()()}if(2&n){const t=e.XpG();e.R7$(6),e.JRh(t.engineErrorMessage),e.R7$(13),e.Y8G("ngIf",!t.viewEngineErrorDetails),e.R7$(2),e.Y8G("ngIf",t.viewEngineErrorDetails)}}function _1(n,_){if(1&n){const t=e.RV6();e.j41(0,"div",3),e.EFF(1),e.k0s(),e.j41(2,"div",15),e.qex(3),e.j41(4,"button",9),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.handleActionClick(o.supportURL))}),e.EFF(5," Contact Support "),e.k0s(),e.bVm(),e.k0s(),e.nrm(6,"div",16)}if(2&n){const t=e.XpG();e.R7$(),e.SpI(" ",t.title," "),e.R7$(5),e.Y8G("innerHTML",t.description,e.npT)}}let s1=(()=>{class n{handleSeeDetailsClick(){this.viewEngineErrorDetails=!0}get title(){return this.errorConfig.title}get description(){return this.errorConfig.description}constructor(t,i,o){this.router=t,this.snackBar=i,this.engineService=o,this.supportURL="https://support.biodigital.com",this.isEngineError=!1,this.viewEngineErrorDetails=!1;const{errorType:s,errorCode:a,error:r,errorUrl:u}=this.router.getCurrentNavigation().extras.state;this.errorType=s,this.errorUrl=u,this.errorCode=a,this.error=r}ngOnInit(){if(this.errorType===f_.Y.Engine){this.isEngineError=!0;const t={contentId:this.errorUrl,error:this.error,webglInfo:this.engineService.getWEBGLInfo()};this.engineErrorMessage=t.error.message,this.engineErrorReport=JSON.stringify(t,null,2)}else this.errorConfig=this.errorType===f_.Y.Content?qh:Jh[this.errorCode]||Zh}handleDownloadClick(){(0,e1.saveAs)(new Blob([this.engineErrorReport],{type:"text/plain"}),"BioDigital_Error_Report.txt")}handleActionClick(t){window.open(t)||this.snackBar.open("Unable to open link in new window, please check your pop-up settings.")}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(nt.Ix),e.rXU(Ii.UG),e.rXU(ni.y))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-error-page"]],decls:4,vars:2,consts:[["notEngineError",""],[1,"error"],[4,"ngIf","ngIfElse"],[1,"text-2xl","font-bold"],[1,"text-base","mt-4","mb-8"],[1,"font-semibold"],[1,"text-base","mb-4"],[1,"text-base"],[1,"my-4"],["app-button","","buttonType","outline","buttonTheme","light",3,"click"],[1,"mt-8"],["app-button","","buttonType","outline","buttonTheme","light","buttonSize","xs",3,"click",4,"ngIf"],["class","error__details mt-2",3,"value",4,"ngIf"],["app-button","","buttonType","outline","buttonTheme","light","buttonSize","xs",3,"click"],[1,"error__details","mt-2",3,"value"],[1,"flex","items-start","mt-10"],[1,"error__description","text-base","mt-8",3,"innerHTML"]],template:function(i,o){if(1&i&&(e.j41(0,"div",1),e.DNE(1,o1,22,3,"div",2)(2,_1,7,2,"ng-template",null,0,e.C5r),e.k0s()),2&i){const s=e.sdS(3);e.R7$(),e.Y8G("ngIf",o.isEngineError)("ngIfElse",s)}},dependencies:[t1.Q,p.bT],styles:[".error[_ngcontent-%COMP%]{margin:0 auto;max-width:640px;display:flex;flex-direction:column;padding:40px;color:#283853}.error[_ngcontent-%COMP%]   ol[_ngcontent-%COMP%]{list-style:decimal}.error__details[_ngcontent-%COMP%]{width:100%;height:200px}.error__description[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .error__description[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:visited{color:#283853}"],changeDetection:0})}return n})();var Zn=l(71263);let T_=(()=>{class n{constructor(t,i){this.authService=t,this.store=i}canActivate(t,i){const o=this.store.selectSnapshot(ht.k.getLoggedIn);return o?(0,Vi.of)(o):this.authService.isLoggedIn().pipe((0,ve.T)(s=>s.signed_in))}static#e=this.\u0275fac=function(i){return new(i||n)(e.KVO(Zn.u),e.KVO(c.il))};static#t=this.\u0275prov=e.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var a1=l(69270);const r1=[Ci.c.Module,Ci.c.Bookmark],d1=[{path:"",component:Pr.m,canActivate:[(()=>{class n extends T_{constructor(t,i,o){super(t,i),this.authService=t,this.store=i,this.router=o}canActivate(t,i){const{id:o,be:s,m:a}=t.queryParams,u=(0,a1.S)(o||s||a);return super.canActivate(t,i).pipe((0,Gt.Z)(m=>{const v=m||r1.includes(u);return(0,Vi.of)(v||m)}))}static#e=this.\u0275fac=function(i){return new(i||n)(e.KVO(Zn.u),e.KVO(c.il),e.KVO(nt.Ix))};static#t=this.\u0275prov=e.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})()],data:{fixedHeight:!0},resolve:{siteHeaderType:(()=>{class n{constructor(t,i){this.store=t,this.authService=i}resolve(t,i){return new T_(this.authService,this.store).canActivate(t,i).pipe((0,ve.T)(o=>o?Yn.D.View:Yn.D.Share))}static#e=this.\u0275fac=function(i){return new(i||n)(e.KVO(c.il),e.KVO(Zn.u))};static#t=this.\u0275prov=e.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})()},children:[{path:"",component:Xi,children:[{path:"",component:I}]},{path:"error",component:s1}]}];let p1=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=e.$C({type:n});static#i=this.\u0275inj=e.G2t({imports:[nt.iI.forChild(d1),nt.iI]})}return n})();var u1=l(28107);let h1=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=e.$C({type:n});static#i=this.\u0275inj=e.G2t({imports:[u1.R,Rr,p1,p.MD]})}return n})()},46733:(le,ie,l)=>{var p=l(20741);function k(){var L={},N=0,T=0,W=0;return{add:function ae(Y,X){X||(X=Y,Y=0),Y>T?T=Y:Y<W&&(W=Y),L[Y]||(L[Y]=[]),L[Y].push(X),N++},process:function B(){for(var Y=W;Y<=T;Y++)for(var X=L[Y],c=0;c<X.length;c++)(0,X[c])()},size:function ne(){return N}}}le.exports=function(N){var T=(N=N||{}).reporter,W=p.getOption(N,"async",!0),ae=p.getOption(N,"auto",!0);ae&&!W&&(T&&T.warn("Invalid options combination. auto=true and async=false is invalid. Setting async=true."),W=!0);var ne,B=k(),Y=!1;function c(){for(Y=!0;B.size();){var re=B;B=k(),re.process()}Y=!1}function e(){ne=function ge(re){return setTimeout(re,0)}(c)}return{add:function X(re,he){!Y&&ae&&W&&0===B.size()&&e(),B.add(re,he)},force:function Te(re){Y||(void 0===re&&(re=W),ne&&(function $(re){clearTimeout(re)}(ne),ne=null),re?e():c())}}}},20741:le=>{(le.exports={}).getOption=function l(p,k,L){var N=p[k];return null==N&&void 0!==L?L:N}},37764:le=>{var ie=le.exports={};ie.isIE=function(l){return!(!function p(){var L=navigator.userAgent.toLowerCase();return-1!==L.indexOf("msie")||-1!==L.indexOf("trident")||-1!==L.indexOf(" edge/")}()||l&&l!==function(){var N=3,T=document.createElement("div"),W=T.getElementsByTagName("i");do{T.innerHTML="\x3c!--[if gt IE "+ ++N+"]><i></i><![endif]--\x3e"}while(W[0]);return N>4?N:void 0}())},ie.isLegacyOpera=function(){return!!window.opera}},36565:le=>{(le.exports={}).forEach=function(l,p){for(var k=0;k<l.length;k++){var L=p(l[k]);if(L)return L}}},67618:(le,ie,l)=>{var p=l(37764);le.exports=function(k){var L=(k=k||{}).reporter,N=k.batchProcessor,T=k.stateHandler.getState;if(!L)throw new Error("Missing required dependency: reporter.");function ne(X){return T(X).object}return{makeDetectable:function B(X,c,Te){Te||(Te=c,c=X,X=null),X=X||{},p.isIE(8)?Te(c):function De($,ge){var re=function ae(X){var c=k.important?" !important; ":"; ";return(X.join(c)+c).trim()}(["display: block","position: absolute","top: 0","left: 0","width: 100%","height: 100%","border: none","padding: 0","margin: 0","opacity: 0","z-index: -1000","pointer-events: none"]),he=!1,K=window.getComputedStyle($),Z=$.offsetWidth,mt=$.offsetHeight;function U(){function S(){if("static"===K.position){$.style.setProperty("position","relative",X.important?"important":"");var P=function(Ee,ce,me,F){var Xe=me[F];"auto"!==Xe&&"0"!==function j(oe){return oe.replace(/[^-\d\.]/g,"")}(Xe)&&(Ee.warn("An element that is positioned static has style."+F+"="+Xe+" which is ignored due to the static positioning. The element will need to be positioned relative, so the style."+F+" will be set to 0. Element: ",ce),ce.style.setProperty(F,"0",X.important?"important":""))};P(L,$,K,"top"),P(L,$,K,"right"),P(L,$,K,"bottom"),P(L,$,K,"left")}}""!==K.position&&(S(),he=!0);var h=document.createElement("object");h.style.cssText=re,h.tabIndex=-1,h.type="text/html",h.setAttribute("aria-hidden","true"),h.onload=function se(){he||S(),function P(ce,me){if(!ce.contentDocument){var F=T(ce);return F.checkForObjectDocumentTimeoutId&&window.clearTimeout(F.checkForObjectDocumentTimeoutId),void(F.checkForObjectDocumentTimeoutId=setTimeout(function(){F.checkForObjectDocumentTimeoutId=0,P(ce,me)},100))}me(ce.contentDocument)}(this,function(me){ge($)})},p.isIE()||(h.data="about:blank"),T($)&&($.appendChild(h),T($).object=h,p.isIE()&&(h.data="about:blank"))}T($).startSize={width:Z,height:mt},N?N.add(U):U()}(c,Te)},addListener:function W(X,c){function Te(){c(X)}if(p.isIE(8))T(X).object={proxy:Te},X.attachEvent("onresize",Te);else{var e=ne(X);if(!e)throw new Error("Element is not detectable by this strategy.");e.contentDocument.defaultView.addEventListener("resize",Te)}},uninstall:function Y(X){if(T(X)){var c=ne(X);c&&(p.isIE(8)?X.detachEvent("onresize",c.proxy):X.removeChild(c),T(X).checkForObjectDocumentTimeoutId&&window.clearTimeout(T(X).checkForObjectDocumentTimeoutId),delete T(X).object)}}}}},47728:(le,ie,l)=>{var p=l(36565).forEach;le.exports=function(k){var L=(k=k||{}).reporter,N=k.batchProcessor,T=k.stateHandler.getState,ae=k.idHandler;if(!N)throw new Error("Missing required dependency: batchProcessor");if(!L)throw new Error("Missing required dependency: reporter.");var B=function Te(){var se=document.createElement("div");se.style.cssText=c(["position: absolute","width: 1000px","height: 1000px","visibility: hidden","margin: 0","padding: 0"]);var h=document.createElement("div");h.style.cssText=c(["position: absolute","width: 500px","height: 500px","overflow: scroll","visibility: none","top: -1500px","left: -1500px","visibility: hidden","margin: 0","padding: 0"]),h.appendChild(se),document.body.insertBefore(h,document.body.firstChild);var P=500-h.clientWidth,Ee=500-h.clientHeight;return document.body.removeChild(h),{width:P,height:Ee}}(),Y="erd_scroll_detection_container";function X(U){!function e(U,S,se){if(!U.getElementById(S)){var P=se+"_animation",Ee=se+"_animation_active",ce="/* Created by the element-resize-detector library. */\n";ce+="."+se+" > div::-webkit-scrollbar { "+c(["display: none"])+" }\n\n",ce+="."+Ee+" { "+c(["-webkit-animation-duration: 0.1s","animation-duration: 0.1s","-webkit-animation-name: "+P,"animation-name: "+P])+" }\n",ce+="@-webkit-keyframes "+P+" { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }\n",function h(me,F){F=F||function(Xe){U.head.appendChild(Xe)};var j=U.createElement("style");return j.innerHTML=me,j.id=S,F(j),j}(ce+="@keyframes "+P+" { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }")}}(U,"erd_scroll_detection_scrollbar_style",Y)}function c(U){var S=k.important?" !important; ":"; ";return(U.join(S)+S).trim()}function $(U,S,se){if(U.addEventListener)U.addEventListener(S,se);else{if(!U.attachEvent)return L.error("[scroll] Don't know how to add event listeners.");U.attachEvent("on"+S,se)}}function ge(U,S,se){if(U.removeEventListener)U.removeEventListener(S,se);else{if(!U.detachEvent)return L.error("[scroll] Don't know how to remove event listeners.");U.detachEvent("on"+S,se)}}function re(U){return T(U).container.childNodes[0].childNodes[0].childNodes[0]}function he(U){return T(U).container.childNodes[0].childNodes[0].childNodes[1]}return X(window.document),{makeDetectable:function Z(U,S,se){function h(){if(U.debug){var C=Array.prototype.slice.call(arguments);if(C.unshift(ae.get(S),"Scroll: "),L.log.apply)L.log.apply(null,C);else for(var H=0;H<C.length;H++)L.log(C[H])}}function Ee(C){var H=T(C).container.childNodes[0],q=window.getComputedStyle(H);return!q.width||-1===q.width.indexOf("px")}function ce(){var C=window.getComputedStyle(S),H={};return H.position=C.position,H.width=S.offsetWidth,H.height=S.offsetHeight,H.top=C.top,H.right=C.right,H.bottom=C.bottom,H.left=C.left,H.widthCSS=C.width,H.heightCSS=C.height,H}function j(){if(h("storeStyle invoked."),T(S)){var C=ce();T(S).style=C}else h("Aborting because element has been uninstalled")}function Xe(C,H,q){T(C).lastWidth=H,T(C).lastHeight=q}function D(){return 2*B.width+1}function Qe(){return 2*B.height+1}function Pt(C){return C+10+D()}function ft(C){return C+10+Qe()}function z(C,H,q){var Ge=re(C),ct=he(C),bt=Pt(H),vt=ft(q),Le=function Ye(C){return 2*C+D()}(H),ee=function V(C){return 2*C+Qe()}(q);Ge.scrollLeft=bt,Ge.scrollTop=vt,ct.scrollLeft=Le,ct.scrollTop=ee}function de(){var C=T(S).container;if(!C){(C=document.createElement("div")).className=Y,C.style.cssText=c(["visibility: hidden","display: inline","width: 0px","height: 0px","z-index: -1","overflow: hidden","margin: 0","padding: 0"]),T(S).container=C,function De(U){U.className+=" "+Y+"_animation_active"}(C),S.appendChild(C);var H=function(){T(S).onRendered&&T(S).onRendered()};$(C,"animationstart",H),T(S).onAnimationStart=H}return C}function M(){if(h("Injecting elements"),T(S)){!function C(){var J=T(S).style;if("static"===J.position){S.style.setProperty("position","relative",U.important?"important":"");var be=function(xe,We,Ut,f){var Jt=Ut[f];"auto"!==Jt&&"0"!==function fi(Yi){return Yi.replace(/[^-\d\.]/g,"")}(Jt)&&(xe.warn("An element that is positioned static has style."+f+"="+Jt+" which is ignored due to the static positioning. The element will need to be positioned relative, so the style."+f+" will be set to 0. Element: ",We),We.style[f]=0)};be(L,S,J,"top"),be(L,S,J,"right"),be(L,S,J,"bottom"),be(L,S,J,"left")}}();var q=T(S).container;q||(q=de());var Ge=B.width,ct=B.height,bt=c(["position: absolute","flex: none","overflow: hidden","z-index: -1","visibility: hidden","width: 100%","height: 100%","left: 0px","top: 0px"]),vt=c(["position: absolute","flex: none","overflow: hidden","z-index: -1","visibility: hidden"].concat(function H(J,be,xe,We){return["left: "+(J=J?J+"px":"0"),"top: "+(be=be?be+"px":"0"),"right: "+(We=We?We+"px":"0"),"bottom: "+(xe=xe?xe+"px":"0")]}(-(1+Ge),-(1+ct),-ct,-Ge))),Le=c(["position: absolute","flex: none","overflow: scroll","z-index: -1","visibility: hidden","width: 100%","height: 100%"]),ee=c(["position: absolute","flex: none","overflow: scroll","z-index: -1","visibility: hidden","width: 100%","height: 100%"]),Ne=c(["position: absolute","left: 0","top: 0"]),qe=c(["position: absolute","width: 200%","height: 200%"]),Oe=document.createElement("div"),O=document.createElement("div"),E=document.createElement("div"),ji=document.createElement("div"),Zt=document.createElement("div"),Hi=document.createElement("div");Oe.dir="ltr",Oe.style.cssText=bt,Oe.className=Y,O.className=Y,O.style.cssText=vt,E.style.cssText=Le,ji.style.cssText=Ne,Zt.style.cssText=ee,Hi.style.cssText=qe,E.appendChild(ji),Zt.appendChild(Hi),O.appendChild(E),O.appendChild(Zt),Oe.appendChild(O),q.appendChild(Oe),$(E,"scroll",Qi),$(Zt,"scroll",mi),T(S).onExpandScroll=Qi,T(S).onShrinkScroll=mi}else h("Aborting because element has been uninstalled");function Qi(){var J=T(S);J&&J.onExpand?J.onExpand():h("Aborting expand scroll handler: element has been uninstalled")}function mi(){var J=T(S);J&&J.onShrink?J.onShrink():h("Aborting shrink scroll handler: element has been uninstalled")}}function g(){function C(Le,ee,Ne){var qe=function oe(C){return re(C).childNodes[0]}(Le),Oe=Pt(ee),O=ft(Ne);qe.style.setProperty("width",Oe+"px",U.important?"important":""),qe.style.setProperty("height",O+"px",U.important?"important":"")}function H(Le){var ee=S.offsetWidth,Ne=S.offsetHeight,qe=ee!==T(S).lastWidth||Ne!==T(S).lastHeight;h("Storing current size",ee,Ne),Xe(S,ee,Ne),N.add(0,function(){if(qe){if(!T(S))return void h("Aborting because element has been uninstalled");if(!q())return void h("Aborting because element container has not been initialized");U.debug&&(S.offsetWidth!==ee||S.offsetHeight!==Ne)&&L.warn(ae.get(S),"Scroll: Size changed before updating detector elements."),C(S,ee,Ne)}}),N.add(1,function(){T(S)?q()?z(S,ee,Ne):h("Aborting because element container has not been initialized"):h("Aborting because element has been uninstalled")}),qe&&Le&&N.add(2,function(){T(S)?q()?Le():h("Aborting because element container has not been initialized"):h("Aborting because element has been uninstalled")})}function q(){return!!T(S).container}function Ge(){h("notifyListenersIfNeeded invoked");var ee=T(S);return function Le(){return void 0===T(S).lastNotifiedWidth}()&&ee.lastWidth===ee.startSize.width&&ee.lastHeight===ee.startSize.height?h("Not notifying: Size is the same as the start size, and there has been no notification yet."):ee.lastWidth===ee.lastNotifiedWidth&&ee.lastHeight===ee.lastNotifiedHeight?h("Not notifying: Size already notified"):(h("Current size not notified, notifying..."),ee.lastNotifiedWidth=ee.lastWidth,ee.lastNotifiedHeight=ee.lastHeight,void p(T(S).listeners,function(Ne){Ne(S)}))}function bt(){h("Scroll detected."),Ee(S)?h("Scroll event fired while unrendered. Ignoring..."):H(Ge)}if(h("registerListenersAndPositionElements invoked."),T(S)){T(S).onRendered=function ct(){if(h("startanimation triggered."),Ee(S))h("Ignoring since element is still unrendered...");else{h("Element rendered.");var Le=re(S),ee=he(S);(0===Le.scrollLeft||0===Le.scrollTop||0===ee.scrollLeft||0===ee.scrollTop)&&(h("Scrollbars out of sync. Updating detector elements..."),H(Ge))}},T(S).onExpand=bt,T(S).onShrink=bt;var vt=T(S).style;C(S,vt.width,vt.height)}else h("Aborting because element has been uninstalled")}function d(){if(h("finalizeDomMutation invoked."),T(S)){var C=T(S).style;Xe(S,C.width,C.height),z(S,C.width,C.height)}else h("Aborting because element has been uninstalled")}function Tt(){se(S)}function b(){h("Installing..."),function F(){T(S).listeners=[]}(),function me(){var C=ce();T(S).startSize={width:C.width,height:C.height},h("Element start size",T(S).startSize)}(),N.add(0,j),N.add(1,M),N.add(2,g),N.add(3,d),N.add(4,Tt)}se||(se=S,S=U,U=null),U=U||{},h("Making detectable..."),function P(C){return!function H(q){var Ge=q.getRootNode&&q.getRootNode().contains(q);return q===q.ownerDocument.body||q.ownerDocument.body.contains(q)||Ge}(C)||null===window.getComputedStyle(C)}(S)?(h("Element is detached"),de(),h("Waiting until element is attached..."),T(S).onRendered=function(){h("Element is now attached"),b()}):b()},addListener:function K(U,S){if(!T(U).listeners.push)throw new Error("Cannot add listener to an element that is not detectable.");T(U).listeners.push(S)},uninstall:function mt(U){var S=T(U);S&&(S.onExpandScroll&&ge(re(U),"scroll",S.onExpandScroll),S.onShrinkScroll&&ge(he(U),"scroll",S.onShrinkScroll),S.onAnimationStart&&ge(S.container,"animationstart",S.onAnimationStart),S.container&&U.removeChild(S.container))},initDocument:X}}},38465:(le,ie,l)=>{var p=l(36565).forEach,k=l(6861),L=l(49216),N=l(36100),T=l(1157),W=l(68816),ae=l(37764),B=l(46733),ne=l(43133),Y=l(67618),X=l(47728);function c($){return Array.isArray($)||void 0!==$.length}function Te($){if(Array.isArray($))return $;var ge=[];return p($,function(re){ge.push(re)}),ge}function e($){return $&&1===$.nodeType}function De($,ge,re){var he=$[ge];return null==he&&void 0!==re?re:he}le.exports=function($){var ge;if(($=$||{}).idHandler)ge={get:function(oe){return $.idHandler.get(oe,!0)},set:$.idHandler.set};else{var re=N(),he=T({idGenerator:re,stateHandler:ne});ge=he}var K=$.reporter;K||(K=W(!1===K));var mt=De($,"batchProcessor",B({reporter:K})),U={};U.callOnAdd=!!De($,"callOnAdd",!0),U.debug=!!De($,"debug",!1);var h,S=L(ge),se=k({stateHandler:ne}),P=De($,"strategy","object"),Ee=De($,"important",!1),ce={reporter:K,batchProcessor:mt,stateHandler:ne,idHandler:ge,important:Ee};if("scroll"===P&&(ae.isLegacyOpera()?(K.warn("Scroll strategy is not supported on legacy Opera. Changing to object strategy."),P="object"):ae.isIE(9)&&(K.warn("Scroll strategy is not supported on IE9. Changing to object strategy."),P="object")),"scroll"===P)h=X(ce);else{if("object"!==P)throw new Error("Invalid strategy name: "+P);h=Y(ce)}var me={};return{listenTo:function F(oe,D,Qe){function Pt(M){var g=S.get(M);p(g,function(Tt){Tt(M)})}function ft(M,g,d){S.add(g,d),M&&d(g)}if(Qe||(Qe=D,D=oe,oe={}),!D)throw new Error("At least one element required.");if(!Qe)throw new Error("Listener required.");if(e(D))D=[D];else{if(!c(D))return K.error("Invalid arguments. Must be a DOM element or a collection of DOM elements.");D=Te(D)}var Ye=0,V=De(oe,"callOnAdd",U.callOnAdd),z=De(oe,"onReady",function(){}),de=De(oe,"debug",U.debug);p(D,function(g){ne.getState(g)||(ne.initState(g),ge.set(g));var d=ge.get(g);if(de&&K.log("Attaching listener to element",d,g),!se.isDetectable(g))return de&&K.log(d,"Not detectable."),se.isBusy(g)?(de&&K.log(d,"System busy making it detectable"),ft(V,g,Qe),me[d]=me[d]||[],void me[d].push(function(){++Ye===D.length&&z()})):(de&&K.log(d,"Making detectable..."),se.markBusy(g,!0),h.makeDetectable({debug:de,important:Ee},g,function(b){if(de&&K.log(d,"onElementDetectable"),ne.getState(b)){se.markAsDetectable(b),se.markBusy(b,!1),h.addListener(b,Pt),ft(V,b,Qe);var C=ne.getState(b);C&&C.startSize&&(C.startSize.width!==b.offsetWidth||C.startSize.height!==b.offsetHeight)&&Pt(b),me[d]&&p(me[d],function(Ge){Ge()})}else de&&K.log(d,"Element uninstalled before being detectable.");delete me[d],++Ye===D.length&&z()}));de&&K.log(d,"Already detecable, adding listener."),ft(V,g,Qe),Ye++}),Ye===D.length&&z()},removeListener:S.removeListener,removeAllListeners:S.removeAllListeners,uninstall:function j(oe){if(!oe)return K.error("At least one element is required.");if(e(oe))oe=[oe];else{if(!c(oe))return K.error("Invalid arguments. Must be a DOM element or a collection of DOM elements.");oe=Te(oe)}p(oe,function(D){S.removeAllListeners(D),h.uninstall(D),ne.cleanState(D)})},initDocument:function Xe(oe){h.initDocument&&h.initDocument(oe)}}}},6861:le=>{le.exports=function(ie){var l=ie.stateHandler.getState;return{isDetectable:function p(T){var W=l(T);return W&&!!W.isDetectable},markAsDetectable:function k(T){l(T).isDetectable=!0},isBusy:function L(T){return!!l(T).busy},markBusy:function N(T,W){l(T).busy=!!W}}}},36100:le=>{le.exports=function(){var ie=1;return{generate:function l(){return ie++}}}},1157:le=>{le.exports=function(ie){var l=ie.idGenerator,p=ie.stateHandler.getState;return{get:function k(N){var T=p(N);return T&&void 0!==T.id?T.id:null},set:function L(N){var T=p(N);if(!T)throw new Error("setId required the element to have a resize detection state.");var W=l.generate();return T.id=W,W}}}},49216:le=>{le.exports=function(ie){var l={};function p(T){var W=ie.get(T);return void 0===W?[]:l[W]||[]}return{get:p,add:function k(T,W){var ae=ie.get(T);l[ae]||(l[ae]=[]),l[ae].push(W)},removeListener:function L(T,W){for(var ae=p(T),B=0,ne=ae.length;B<ne;++B)if(ae[B]===W){ae.splice(B,1);break}},removeAllListeners:function N(T){var W=p(T);W&&(W.length=0)}}}},68816:le=>{le.exports=function(ie){function l(){}var p={log:l,warn:l,error:l};if(!ie&&window.console){var k=function(L,N){L[N]=function(){var W=console[N];if(W.apply)W.apply(console,arguments);else for(var ae=0;ae<arguments.length;ae++)W(arguments[ae])}};k(p,"log"),k(p,"warn"),k(p,"error")}return p}},43133:le=>{var ie="_erd";function p(L){return L[ie]}le.exports={initState:function l(L){return L[ie]={},p(L)},getState:p,cleanState:function k(L){delete L[ie]}}}}]);