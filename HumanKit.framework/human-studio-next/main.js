(self.webpackChunkweb=self.webpackChunkweb||[]).push([[792],{62497:(le,N,n)=>{"use strict";n.d(N,{N:()=>O});var e=n(46842),t=n(92014),s=n(60177),c=n(54438);let O=(()=>{class P{static#e=this.\u0275fac=function(f){return new(f||P)};static#t=this.\u0275mod=c.$C({type:P});static#n=this.\u0275inj=c.G2t({imports:[t.rK.forFeature([e.U]),s.MD]})}return P})()},46842:(le,N,n)=>{"use strict";n.d(N,{U:()=>P});var e=n(92014),t=n(54438),s=function(S,a,f,E){var g,y=arguments.length,i=y<3?a:null===E?E=Object.getOwnPropertyDescriptor(a,f):E;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(S,a,f,E);else for(var p=S.length-1;p>=0;p--)(g=S[p])&&(i=(y<3?g(i):y>3?g(a,f,i):g(a,f))||i);return y>3&&i&&Object.defineProperty(a,f,i),i},c=function(S,a){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(S,a)};const O={prefersReducedMotion:window.matchMedia("(prefers-reduced-motion: reduce)").matches};let P=class ls{static getPrefersReducedMotion(a){return a.prefersReducedMotion}static#e=this.\u0275fac=function(f){return new(f||ls)};static#t=this.\u0275prov=t.jDH({token:ls,factory:ls.\u0275fac})};s([(0,e.MD)(),c("design:type",Function),c("design:paramtypes",[Object]),c("design:returntype",void 0)],P,"getPrefersReducedMotion",null),P=s([(0,e.Uw)({name:"accessibility",defaults:O})],P)},15828:(le,N,n)=>{"use strict";n.d(N,{j:()=>e});var e=function(t){return t.PersonalUse="Personal Use",t.Education="Education",t.Business="Business",t}(e||{})},27153:(le,N,n)=>{"use strict";n.d(N,{$r:()=>p,E:()=>f,Iw:()=>i,NP:()=>g,RP:()=>E,YO:()=>S,dx:()=>a,eu:()=>y,fQ:()=>O,mY:()=>P,n3:()=>c});var e=n(71217),t=n(30234);const s="https://support.biodigital.com/hc/en-us",c={[t.a.WoltersKluwer]:"Wolters Kluwer",[t.a.Zspace]:"zSpace"},O={[t.a.WoltersKluwer]:"https://tools.ovid.com/support/index_inner.html",[t.a.Zspace]:"https://support.zspace.com/s/contactsupport"},P={[t.a.WoltersKluwer]:"HLRP-AcademicOperations@wolterskluwer.com"};function S(o){return s}function a(o){return!0===o?.premium_account_valid||"group"===o?.premium_account_type}function f(o){return!o?.organizations[0]?.external_account?.is_external_account&&a(o)}function E(o){const v=o?.organizations[0]?.external_account?.external_account_provider;return O[v]}function y(o){return`/login?${h(o)}`}function i(o){return`/login/create?${h(o)}`}function g(o,v="",d=""){return`mailto:${o}?subject=${encodeURIComponent(v)}&body=${encodeURIComponent(d)}`}function p(o){return/^\d{5}(-\d{4})?$/.test(o)}function h(o){const v=new URLSearchParams;if(o?.type===e.P.Organization){const r=o.data,_=r?.session_source,u=r?.session_source_id;"ovid_osptok"===_&&v.append("osptok",u)}return v}},41981:(le,N,n)=>{"use strict";n.d(N,{U:()=>e});var e=function(t){return t.InvalidUAID="analytic id does not exist",t.InvalidDeveloperId="Client id invalid",t.InvalidProductKey="app product key",t.MissingUAID="analytic id missing",t.WebOnlyAPI="Api key only compatible with Web Widget",t.AndroidOnlyAPI="Api key only compatible with Mobile Widget SDK for Android",t.IOSOnlyAPI="Api key only compatible with Mobile Widget SDK for iOS",t.MixedAPIKeys="Use of both an app product key and an app api key not allowed",t.ProductKeyNotRegistered='App product key "xxx" has not been registered or is incorrect.  Ensure it has been registered by the system admin',t.ProductKeyInvalidAppBundleID='The app product key "xxx" has not been authorized to be used for app bundle id "yyy".  Confirm the correct values are being used from the system admin',t.ProductKeyBundleIDWhitelist='Use of app product key "xxx" requires the affiliated app bundle id (app_domain) to be white-listed.  Ensure the system admin has white-listed "yyy"',t.ImproperProductKeyUsage='Improper use of app product key "xxx" detected. Contact the system admin if issue continues',t.InvalidPlatformSource="Invalid platform source",t.MissingSource="Missing source",t.MissingPlatform="Missing platform",t.MissingAppDomain="Missing app domain",t.APIKeyMissing="Api key missing",t.APIKeyInvalid="Api key invalid",t.DeveloperDeactivated="Developer account for api key is deactivated",t.BundleIDNotAllowed="App bundle id not allowed",t.BundleIDUnregistered="App bundle id unregistered",t}(e||{})},85446:(le,N,n)=>{"use strict";n.d(N,{q:()=>a});var e=n(28407),t=n(71263),s=n(16823),c=n(40215),O=n(54438),P=n(38645),S=n(92014);let a=(()=>{class f{constructor(y,i,g){this.router=y,this.authService=i,this.store=g}canActivate(y,i){var g=this;return(0,e.A)(function*(){return g.getIsLoggedIn().then(p=>!!p.signed_in||(g.redirectToLogin(i.url),!1))})()}getIsLoggedIn(){var y=this;return(0,e.A)(function*(){const i=y.store.selectSnapshot(s.k.getLoggedInState);return i?.signed_in?i:(0,c._)(y.authService.isLoggedIn())})()}redirectToLogin(y){this.router.navigate(["/login"],{queryParams:{returnUrl:y}})}static#e=this.\u0275fac=function(i){return new(i||f)(O.KVO(P.Ix),O.KVO(t.u),O.KVO(S.il))};static#t=this.\u0275prov=O.jDH({token:f,factory:f.\u0275fac,providedIn:"root"})}return f})()},71263:(le,N,n)=>{"use strict";n.d(N,{u:()=>R});var e=n(21626),t=n(36110),s=n(11756),c=n(28577),O=n(15877),P=n(37780),S=n(40470);class a{static fromJSON(G){const k=new a;return k.isUser=G.is_user,k.email=G.user_email,k.firstName=G.user_first_name,k.lastName=G.user_last_name,k.name=`${G.user_first_name} ${G.user_last_name}`,k.isDeveloper=G.user_is_developer,k.isDeveloperActive=G.user_is_developer_active,k.isDeveloperVerified=G.user_is_developer_verified,k.isThirdParty=G.user_is_third_party,k.thirdPartyProvider=G.user_third_party_provider,k.isTeamMember=G.user_is_team_member,k}}class f{static fromJSON(G){const k=new f;return k.google=G.google_api_key,k}}var E=n(24684),y=n(99972),i=n(68845),g=n(90450),p=function(A){return A.Zendesk="zendesk",A}(p||{}),h=n(91939),o=n(49204),v=n(56081);class d{}class r{}var _=n(15318),u=n(11129),l=n(5690),m=n(29302),C=n(54438);const b=["harvard.edu","liberty.edu"];let R=(()=>{class A{constructor(k,V,W,T,x){this.http=k,this.reCaptchaV3Service=V,this.userMessageService=W,this.productService=T,this.RECAPTCHA_V3_SITE_KEY=x}loginWithBiodigital(k){return this.http.post("/ws/user/sign/in",i.z.toJSON(k),{headers:this.productService.productHeader})}loginWithGoogle(k){return this.http.post("/ws/user/sign/in/google",y.o.toJSON(k),{headers:this.productService.productHeader})}loginWithGroup(k){return this.http.post("/ws/organization/sign/in",m.G.toJSON(k),{headers:this.productService.productHeader})}logout(){return google.accounts.id.disableAutoSelect(),this.http.get("/ws/user/sign/out")}logoutGroup(){return google.accounts.id.disableAutoSelect(),this.http.get("/ws/organization/sign/out",{params:{version:1,app_producttype:this.productService.productType,app_productkey:this.productService.productKey}})}checkProfile(k){return this.http.post("/ws/user/profile/check",{version:5,email:k,app_producttype:this.productService.productType,app_productkey:this.productService.productKey},{headers:this.productService.productHeader}).pipe((0,t.T)(x=>a.fromJSON(x)))}getUserProfile(k){return this.http.get("/ws/user/profile",{params:{version:2,subscription_hard_check:k?1:0}}).pipe((0,t.T)(T=>{const x=(0,S.bj)(P.s,T);return x.organizations.forEach(z=>{const I=(0,o.get)(z,"user_role",v.br);z.user_role=(0,v.t9)(I)}),x}))}getUserRoles(){return this.http.get("/ws/organization/user/roles").pipe((0,t.T)(k=>k.user_roles.map(V=>{const W=(0,S.bj)(h.V,V);return(0,v.t9)(W)})))}getGroupUserProfile(){return this.http.get("/ws/organization/profile",{params:{version:1,app_producttype:this.productService.productType,app_productkey:this.productService.productKey}})}updaterUserProfile(k){return this.http.post("/ws/user/profile?version=2",k)}deleteUserProfile(){return this.http.post("/ws/user/profile/delete",{}).pipe((0,t.T)(k=>k.deleted_user_email))}getEnvironmentSettings(){return this.http.get("/ws/environment/settings?version=2").pipe((0,t.T)(k=>f.fromJSON(k)))}getUserApps(){return this.http.get("/ws/developer/apps/profile").pipe((0,t.T)(k=>k&&k.apps?JSON.parse(k.apps):[]))}getGroupConfigFromRoute(k){const W=k.queryParams.code||"",T=k.queryParams.group_invite||"",x=k.queryParams.osptok||"";return{group:k.queryParams.group||"",groupCode:W,groupCodeMode:W?1:0,groupInviteMode:T?1:0,groupInviteKey:T,groupOvidMode:x?1:0,groupOvidOsptok:x}}getPlatformConfigFromRoute(k){const{zendesk_signin:V,return_to:W,brand_id:T,locale_id:x,timestamp:z}=k.queryParams;if("1"===V)return{platform:p.Zendesk,returnTo:W,brandId:T,localeId:x,timestamp:z}}isLoggedIn(){return this.http.get("/ws/product/account/is/signed-in",{params:{version:1,app_producttype:this.productService.productType,app_productkey:this.productService.productKey}})}getProfileRestrictions(k){let V=!1,W=!1,T="";return k.organizations.forEach(x=>{V||W||(T=x.name,V=x.user_is_subscribed&&x.email_domain_restriction&&!x.user_has_email_domain_access,W=x.user_is_subscribed&&x.ip_address_restriction&&!x.user_has_domain_access)}),{organizationName:T,email:V,ip:W}}resetPassword(k){return this.http.post("/ws/user/password/forgot",{email:k})}deactivateFacebook(k){return this.http.post("/ws/user/sign/in/facebook/deactivate",k)}updatePassword(k,V,W){return this.http.post("/ws/user/password/change",{current_password:k,new_password:V,confirm_new_password:W})}signUp(k){return this.http.post("/ws/user/sign/up",E.g.toJSON(k),{headers:this.productService.productHeader})}verifyToken(k,V){return this.http.post("/ws/recaptcha/siteverify",{recaptcha_reponse_token:k,recaptcha_version:V})}verifyReCaptcha(k,V){return V&&grecaptcha.reset(this.RECAPTCHA_V3_SITE_KEY),this.reCaptchaV3Service.execute(k).pipe((0,s.Z)(W=>this.verifyToken(W,"v3")),(0,t.T)(W=>({isHuman:W.action===k&&W.score>.2,verification:W})))}isReCaptchaWhiteListed(k){return b.some(V=>new RegExp(`${V}$`,"i").test(k))}verifyIsHuman(k,V,W=!1){return this.isReCaptchaWhiteListed(V)?(0,O.of)({isHuman:!0}):this.verifyReCaptcha(k,W)}isValidGoogleDomain(){return new Set(["human-qa.biodigital.com","human-staging.biodigital.com","human.biodigital.com","loft.biodigital.com","loft-qa.biodigital.com","qa.biodigital.com","localhost:4200","localhost:4201"]).has(window.location.host)}requestVerificationCode(k){const V={...k,version:4,app_producttype:this.productService.productType,app_productkey:this.productService.productKey};return this.http.post("/ws/user/verification/request",V).pipe((0,t.T)(W=>(0,S.bj)(d,W)))}verifyProfile(k){const V={...k,version:4,app_producttype:this.productService.productType,app_productkey:this.productService.productKey};return this.http.post("/ws/user/verification/confirm",V).pipe((0,t.T)(W=>(0,S.bj)(r,W)))}checkProfileIncomplete(){return this.userMessageService.getUserMessage(u.s$.CompleteProfileAlert,"v2",!1).pipe((0,c.W)(()=>(0,O.of)({messageType:u.s$.CompleteProfileAlert,messageData:{},showUserAlert:!1})))}getUserNotices(){const V=new e.Nl({fromObject:{version:1,app_productkey:this.productService.productKey,app_producttype:this.productService.productType}});return this.http.get("ws/user/notices",{params:V})}markUserNoticeAsSeen(k){return this.http.post("ws/user/notices/seen",{version:1,app_productkey:this.productService.productKey,app_producttype:this.productService.productType,notice_id:k})}static#e=this.\u0275fac=function(V){return new(V||A)(C.KVO(e.Qq),C.KVO(g.ob),C.KVO(_.K),C.KVO(l.b),C.KVO(g.gq))};static#t=this.\u0275prov=C.jDH({token:A,factory:A.\u0275fac,providedIn:"root"})}return A})()},74707:(le,N,n)=>{"use strict";n.d(N,{V:()=>O,k:()=>P});var e=n(54438),t=n(60177),s=n(24418),c=n(90450);const O=new e.nKC("");let P=(()=>{class S{static#e=this.\u0275fac=function(E){return new(E||S)};static#t=this.\u0275mod=e.$C({type:S});static#n=this.\u0275inj=e.G2t({providers:[{provide:c.gq,useValue:s.c.recaptchaV3Key},{provide:O,useValue:s.c.recaptchaV2Key}],imports:[t.MD,c.tA,c.cm]})}return S})()},63308:(le,N,n)=>{"use strict";n.d(N,{j:()=>s,q:()=>c});var e=n(49204);function s(P,S=!1){return(S?O(P):P).reduce((f,E)=>({...f,...E}),{})}function c(P,S=!1){const a=Object.entries(P).map(([f,E])=>({[f]:E}));return S?O(a):a}function O(P){return P.filter(S=>Object.values(S).some(a=>!(0,e.isNil)(a.value)&&""!==a.value))}},27182:(le,N,n)=>{"use strict";n.d(N,{I:()=>e});var e=function(t){return t.Free="free",t.Premium="premium",t.Team="team",t}(e||{})},68845:(le,N,n)=>{"use strict";n.d(N,{z:()=>t});var e=n(98125);class t extends e.Q{constructor(c,O,P){super(),this.email=c,this.password=O,this.rememberMe=P}static toJSON(c){return{id_token:c.token,version:c.version,app_producttype:c.app_producttype,app_productkey:c.app_productkey,group_invite_mode:c.groupInviteMode,group_invite_key:c.groupInviteKey,group_code_mode:c.groupCodeMode,group_code:c.groupCode,group_ovid_mode:c.groupOvidMode,group_ovid_osptok:c.groupOvidOsptok,email:c.email,password:c.password,email_remember_me:c.rememberMe,platform:c.platform,return_to:c.returnTo,brand_id:c.brandId,locale_id:c.localeId,timestamp:c.timestamp,site_verify_response:c.site_verify_response}}}},99972:(le,N,n)=>{"use strict";n.d(N,{o:()=>t});var e=n(98125);class t extends e.Q{constructor(c){super(),this.token=c}static toJSON(c){return{id_token:c.token,version:c.version,app_producttype:c.app_producttype,app_productkey:c.app_productkey,group_invite_mode:c.groupInviteMode,group_invite_key:c.groupInviteKey,group_code_mode:c.groupCodeMode,group_code:c.groupCode,group_ovid_mode:c.groupOvidMode,group_ovid_osptok:c.groupOvidOsptok,platform:c.platform,return_to:c.returnTo,brand_id:c.brandId,locale_id:c.localeId,timestamp:c.timestamp,site_verify_response:c.site_verify_response}}}},29302:(le,N,n)=>{"use strict";n.d(N,{G:()=>O});var e=n(98125),t=n(24418),s=n(12215),c=n(27180);class O extends e.Q{constructor(S,a,f,E){super(),this.app_producttype=S,this.app_productkey=a,this.groupOvidMode=f,this.groupOvidOsptok=E}static toJSON(S){return{version:S.version,app_producttype:S.app_producttype,app_productkey:S.app_productkey,group_ovid_mode:S.groupOvidMode,group_ovid_osptok:S.groupOvidOsptok,ignore_ovid_exp:t.c.application===c.c.Studio&&t.c.deploy!==s.Z.Production&&!1===t.c.native?1:0}}}},98125:(le,N,n)=>{"use strict";n.d(N,{Q:()=>e});class e{constructor(){this.version=5,this.groupInviteMode=0,this.groupCodeMode=0}}},20342:(le,N,n)=>{"use strict";n.d(N,{O:()=>c,g:()=>O});const s=`https://www.biodigital.com?utm_source=${n(24418).c.native?"human_mobile":"human_web"}&utm_medium=PLG&utm_campaign=poweredby&ref=poweredby`,c={default:"./assets/images/powered-by-biodigital-color.svg",human_app:{default:{logo_url:"./assets/images/powered-by-biodigital-color.svg",logo_linkout_url:s}},viewer:{viewer_logo_setting:null,full_dark:{logo_url:"./assets/images/powered-by-biodigital-color.svg",logo_linkout_url:s},full_light:{logo_url:"./assets/images/powered-by-biodigital-white.svg",logo_linkout_url:s},square_dark:{logo_url:"./assets/images/logo-color.svg",logo_linkout_url:s},square_light:{logo_url:"./assets/images/logo-white.svg",logo_linkout_url:s}}};function O(P,S,a){const{full_dark:f,full_light:E,square_dark:y,square_light:i}=P.viewer;switch(S){case"full":return"color"===a?f:E;case"small":return"color"===a?y:i}}},7213:(le,N,n)=>{"use strict";n.d(N,{c8:()=>R,E2:()=>A,D1:()=>k,Dy:()=>o,XP:()=>l,M8:()=>g,Ie:()=>b,dE:()=>y,OS:()=>f,Dx:()=>V,WV:()=>h,yq:()=>m,KZ:()=>C,Hp:()=>G,$Z:()=>i,Lo:()=>x,h_:()=>z,_m:()=>a,dl:()=>E,Cy:()=>W});var e=n(49204),t=n(17766),s=n(70737),c=n(24418),O=function(I){return I.User="user",I.Group="group",I}(O||{}),P=n(52394),S=n(27180);function a(I,D){return(0,e.get)(I,"permissions",[]).includes(D)}function f(I){return a(I,s.y.EditBookmarks)&&!c.c.native}function E(I){return!1!==I?.human_studio_access}function y(I,D){const L=a(I,s.y.EditBookmarks);return!!L&&(D.type===t.c.Module?L:!(!0!==D.is_owner)||!!T(D)&&v(I,D))}function i(){return!0}function g(I,D){return!0===D.is_owner}function h(I,D){return!!a(I,s.y.EditBookmarks)&&(!(!0!==D.is_owner&&!W(D))||!!T(D)&&v(I,D))}function o(I,D){return!!D&&a(I,s.y.BulkManageTeamBookmarks)}function v(I,D){if(a(I,s.y.EditAllTeamBookmarks))return!0;const Q=a(I,s.y.EditTeamBookmarks),ie=T(D)&&D.group_access[0].member_edit;return Q&&ie}function r(I){return T(I)&&!0===I.group_access[0].visible}function _(I){return T(I)&&!0===I.group_access[0].member_edit}function u(I){return!(0,e.isNil)(I.module_accessor_level)}function l(I,D,L,Q){return!(!L||!Q)&&a(I,s.y.CopyUrl)}function m(I){return a(I,s.y.PublishBookmarks)}function C(I,D,L,Q){return!!(D&&L&&m(I))&&!0===Q?.human_2dimage_access}function b(I,D){const L=!0===D.is_owner,Q=a(I,s.y.DuplicateTeamBookmarks);return!(!L&&!Q)}function R(I,D){return!u(D)}function A(I,D){return!(!I||D)}function G(I,D,L){if(u(D))return!1;const ie=c.c.application===S.c.Studio,se=L.startsWith("/view");return ie&&se}function k(I,D,L){return L&&I.every(Q=>g(0,Q))}function V(I,D){return!!D&&a(I,s.y.ExportCSV)}function W(I){return I.type==t.c.Module&&I.module_accessor_level===O.Group}function T(I){return Array.isArray(I.group_access)&&I.group_access.length>0}function x(I,D,L=!0){return I.filter(Q=>{const ie=!0===Q.is_owner,se=r(Q),Z=_(Q),de=u(Q),ae=q=>{switch(q){case P.c.Private:return ie;case P.c.TeamEdit:return se&&Z;case P.c.TeamView:return se&&!Z||de;default:return!1}};return L?D.every(ae):D.some(ae)})}function z(I){const D=new Set;return I.forEach(L=>{const Q=!0===L.is_owner,ie=r(L),se=_(L),Z=u(L);Q?D.add(P.c.Private):ie&&se?D.add(P.c.TeamEdit):(ie&&!se||Z)&&D.add(P.c.TeamView)}),Array.from(D)}},56081:(le,N,n)=>{"use strict";n.d(N,{Oj:()=>E,Ub:()=>h,Zv:()=>a,br:()=>f,t9:()=>p});var e=n(49204),s=n(70737),c=n(87732);const O=[s.y.ViewBookmarks,s.y.CopyUrl,s.y.SavePrivateBookmarks,s.y.ExportCSV],P=[...O,s.y.ViewUsers,s.y.InviteUsers,s.y.PublishBookmarks,s.y.EditBookmarks,s.y.EditTeamBookmarks,s.y.RemoveTeamBookmarks,s.y.AddTeamBookmarks,s.y.DuplicateTeamBookmarks,s.y.BulkManageTeamBookmarks],S=[...P,s.y.EditTeamAccount,s.y.EditAllTeamBookmarks,s.y.CreateCollection,s.y.TransferContent,s.y.RemoveUser,s.y.AssignRole,s.y.ManageJoinRequests],a=[c.x.Viewer,c.x.Creator,c.x.Admin],f={role_id:void 0,role_name:c.x.Creator,role_display_name:"",role_description:"",permissions:[...P]},E={permissions:[s.y.ViewBookmarks,s.y.SavePrivateBookmarks,s.y.PublishBookmarks,s.y.EditBookmarks]},y={[c.x.Viewer]:O,[c.x.Creator]:P,[c.x.Admin]:S},i={[c.x.Viewer]:"Can view team content and edit personal content",[c.x.Creator]:"Can edit and view team content",[c.x.Admin]:"Can manage team settings and edit all content"};function g(o){return y[o]||[]}function p(o){const v=o?.role_name??f.role_name,d=o?.role_description??i[v],r=o?.permissions;return{...o,role_description:d,permissions:(0,e.isNil)(r)?g(v):r}}function h(o,v){return a.indexOf(o)-a.indexOf(v)}},70737:(le,N,n)=>{"use strict";n.d(N,{y:()=>e});var e=function(t){return t.AssignRole="assignRole",t.RemoveUser="removeUser",t.TransferContent="transferContent",t.CreateCollection="createCollection",t.DeleteCollection="deleteCollection",t.EditTeamAccount="editTeamAccount",t.EditTeamBookmarks="editTeamBookmarks",t.EditAllTeamBookmarks="editAllTeamBookmarks",t.AddTeamBookmarks="addTeamBookmarks",t.RemoveTeamBookmarks="removeTeamBookmarks",t.EditBookmarks="editBookmarks",t.PublishBookmarks="publishBookmarks",t.SavePrivateBookmarks="savePrivateBookmarks",t.CopyUrl="copyURL",t.ViewBookmarks="viewBookmarks",t.InviteUsers="inviteUsers",t.ViewUsers="viewUsers",t.ExportCSV="exportCSV",t.DuplicateTeamBookmarks="duplicateTeamBookmarks",t.BulkManageTeamBookmarks="bulkManageTeamBookmarks",t.ManageJoinRequests="manageJoinRequests",t}(e||{})},87732:(le,N,n)=>{"use strict";n.d(N,{x:()=>e});var e=function(t){return t.Admin="admin",t.Creator="creator",t.Viewer="viewer",t}(e||{})},71217:(le,N,n)=>{"use strict";n.d(N,{P:()=>e});var e=function(t){return t.User="user",t.Organization="organization",t}(e||{})},51036:(le,N,n)=>{"use strict";function t(c,O){return{type:c,data:O}}function s(c){return"id"in c&&"email"in c}n.d(N,{Q:()=>s,v:()=>t}),n(71217)},24684:(le,N,n)=>{"use strict";n.d(N,{g:()=>t});var e=n(98125);class t extends e.Q{static toJSON(c){return{version:c.version,app_producttype:c.app_producttype,app_productkey:c.app_productkey,email:c.email,password:c.password,first_name:c.firstName,last_name:c.lastName,group_invite_mode:c.groupInviteMode,group_invite_key:c.groupInviteKey,group_code_mode:c.groupCodeMode,group_code:c.groupCode,group_ovid_mode:c.groupOvidMode,group_ovid_osptok:c.groupOvidOsptok,platform:c.platform,return_to:c.returnTo,brand_id:c.brandId,locale_id:c.localeId,timestamp:c.timestamp,site_verify_response:c.site_verify_response}}}},52762:(le,N,n)=>{"use strict";n.d(N,{MM:()=>t});var t=function(c){return c.Web="web",c.Mobile="mobilesdk",c}(t||{})},11129:(le,N,n)=>{"use strict";n.d(N,{KH:()=>e,s$:()=>t});class e{}var t=function(c){return c.DomainAlert="join_group_through_domain_alert",c.WelcomeTour="welcome_tour_alert",c.CompleteProfileAlert="complete_profile_alert",c}(t||{})},37780:(le,N,n)=>{"use strict";n.d(N,{W:()=>P,s:()=>O});var e=n(16938),t=n(15040);class O{}function P(S){return S.email.endsWith("@biodigital.com")}!function(S,a,f,E){var g,y=arguments.length,i=y<3?a:null===E?E=Object.getOwnPropertyDescriptor(a,f):E;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(S,a,f,E);else for(var p=S.length-1;p>=0;p--)(g=S[p])&&(i=(y<3?g(i):y>3?g(a,f,i):g(a,f))||i);y>3&&i&&Object.defineProperty(a,f,i)}([(0,e.Z)(()=>t.n),function(){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata("design:type",Array)}()],O.prototype,"organizations",void 0)},91939:(le,N,n)=>{"use strict";n.d(N,{V:()=>e});class e{}},50262:(le,N,n)=>{"use strict";n.d(N,{s:()=>e});class e extends Error{constructor(){super("reCAPTCHA error. Please complete the form to continue.")}}},38165:(le,N,n)=>{"use strict";n.d(N,{$_:()=>rt,A$:()=>F,CU:()=>Xe,Cx:()=>r,Cy:()=>m,Dv:()=>d,EX:()=>Ue,Fm:()=>L,Fw:()=>Me,Gu:()=>c,HP:()=>M,Hx:()=>K,JY:()=>Q,Kg:()=>b,Ko:()=>v,Mg:()=>Ce,Ml:()=>we,NH:()=>ne,OF:()=>Ee,P:()=>_e,Qb:()=>e,R$:()=>Ne,RE:()=>Z,RL:()=>t,RO:()=>I,RR:()=>Be,RW:()=>st,Sw:()=>u,T9:()=>je,W3:()=>he,XH:()=>ce,XZ:()=>Je,Xb:()=>z,YP:()=>W,YY:()=>x,ZD:()=>R,Zc:()=>f,_E:()=>te,_L:()=>X,_h:()=>A,aD:()=>$,b9:()=>y,bY:()=>Ve,bl:()=>E,cO:()=>p,cZ:()=>V,ct:()=>D,e0:()=>et,ec:()=>ot,eu:()=>S,fQ:()=>g,h5:()=>ge,h8:()=>C,hg:()=>re,hs:()=>l,hz:()=>a,i1:()=>s,iM:()=>tt,ij:()=>O,j3:()=>ae,je:()=>h,kK:()=>$e,kP:()=>de,kb:()=>i,lC:()=>q,mK:()=>j,nb:()=>k,o5:()=>ue,o7:()=>ie,r:()=>w,rH:()=>Ke,rK:()=>P,ru:()=>Y,sG:()=>G,sz:()=>Ie,tM:()=>Te,tk:()=>_,uG:()=>xe,uj:()=>Oe,vL:()=>Fe,vY:()=>T,wj:()=>ve,xG:()=>o,yO:()=>H,z3:()=>se,zc:()=>oe});let e=(()=>{class be{static#e=this.type="[Auth] Is Logged In";constructor(){}}return be})(),t=(()=>{class be{static#e=this.type="[Auth] Is Logged In Success";constructor(Re){this.sessionType=Re}}return be})(),s=(()=>{class be{static#e=this.type="[Auth] Is Logged In Failure";constructor(Re){this.sessionType=Re}}return be})(),c=(()=>{class be{static#e=this.type="[Auth] Login With Biodigital";constructor(Re,dt){this.login=Re,this.verification=dt}}return be})(),O=(()=>{class be{static#e=this.type="[Auth] Initialize Google Auth";constructor(){}}return be})(),P=(()=>{class be{static#e=this.type="[Auth] Authenticate With Google";constructor(Re){this.credential=Re}}return be})(),S=(()=>{class be{static#e=this.type="[Auth] Prompt With Google";constructor(){}}return be})(),a=(()=>{class be{static#e=this.type="[Auth] Prompt With Google Success";constructor(Re){this.promptResult=Re}}return be})(),f=(()=>{class be{static#e=this.type="[Auth] Login With Google";constructor(Re){this.login=Re}}return be})(),E=(()=>{class be{static#e=this.type="[Auth] Login With Group";constructor(Re){this.login=Re}}return be})(),y=(()=>{class be{static#e=this.type="[Auth] Login Success";constructor(Re,dt){this.loginType=Re,this.response=dt}}return be})(),i=(()=>{class be{static#e=this.type="[Auth] Login Failure";constructor(Re,dt,yt){this.loginType=Re,this.error=dt,this.login=yt}}return be})(),g=(()=>{class be{static#e=this.type="[Auth] Logout";constructor(){}}return be})(),p=(()=>{class be{static#e=this.type="[Auth] Logout Success";constructor(){}}return be})(),h=(()=>{class be{static#e=this.type="[Auth] Logout Failure";constructor(){}}return be})(),o=(()=>{class be{static#e=this.type="[Auth] Get Environment Settings";constructor(){}}return be})(),v=(()=>{class be{static#e=this.type="[Auth] Get Environment Settings Success";constructor(Re){this.environmentSettings=Re}}return be})(),d=(()=>{class be{static#e=this.type="[Auth] Get Environment Settings Failure";constructor(Re){this.error=Re}}return be})(),r=(()=>{class be{static#e=this.type="[Auth] Get Group User Profile";constructor(){}}return be})(),_=(()=>{class be{static#e=this.type="[Auth] Get Group User Profile Success";constructor(Re){this.groupUserProfile=Re}}return be})(),u=(()=>{class be{static#e=this.type="[Auth] Get Group User Profile Failure";constructor(Re){this.error=Re}}return be})(),l=(()=>{class be{static#e=this.type="[Auth] Get User Profile";constructor(Re=!1){this.hardCheck=Re}}return be})(),m=(()=>{class be{static#e=this.type="[Auth] Get User Profile Success";constructor(Re){this.userProfile=Re}}return be})(),C=(()=>{class be{static#e=this.type="[Auth] Get User Profile Failure";constructor(Re){this.error=Re}}return be})(),b=(()=>{class be{static#e=this.type="[Auth] Update User Profile";constructor(Re){this.userProfile=Re}}return be})(),R=(()=>{class be{static#e=this.type="[Auth] Update User Profile Success";constructor(Re){this.userProfile=Re}}return be})(),A=(()=>{class be{static#e=this.type="[Auth] Update User Profile Failure";constructor(Re){this.error=Re}}return be})(),G=(()=>{class be{static#e=this.type="[Auth] Delete User Profile";constructor(){}}return be})(),k=(()=>{class be{static#e=this.type="[Auth] Delete User Profile Success";constructor(Re){this.userEmail=Re}}return be})(),V=(()=>{class be{static#e=this.type="[Auth] Delete User Profile Failure";constructor(Re){this.error=Re}}return be})(),W=(()=>{class be{static#e=this.type="[Auth] Check Profile";constructor(Re){this.email=Re}}return be})(),T=(()=>{class be{static#e=this.type="[Auth] Check Profile Success";constructor(Re){this.profile=Re}}return be})(),x=(()=>{class be{static#e=this.type="[Auth] Check Profile Failure";constructor(Re){this.error=Re}}return be})(),z=(()=>{class be{static#e=this.type="[Auth] Get User Roles";constructor(){}}return be})(),I=(()=>{class be{static#e=this.type="[Auth] Reset Password";constructor(Re){this.email=Re}}return be})(),D=(()=>{class be{static#e=this.type="[Auth] Reset Password Success";constructor(Re){this.email=Re}}return be})(),L=(()=>{class be{static#e=this.type="[Auth] Reset Password Failure";constructor(Re){this.error=Re}}return be})(),Q=(()=>{class be{static#e=this.type="[Auth] Transfer Facebook Account";constructor(Re){this.email=Re}}return be})(),ie=(()=>{class be{static#e=this.type="[Auth] Transfer Facebook Account Success";constructor(Re){this.email=Re}}return be})(),se=(()=>{class be{static#e=this.type="[Auth] Transfer Facebook Account Failure";constructor(Re){this.error=Re}}return be})(),Z=(()=>{class be{static#e=this.type="[Auth] Update Password";constructor(Re,dt,yt){this.currentPassword=Re,this.newPassword=dt,this.confirmNewPassword=yt}}return be})(),de=(()=>{class be{static#e=this.type="[Auth] Update Password Success";constructor(){}}return be})(),ae=(()=>{class be{static#e=this.type="[Auth] Update Password Failure";constructor(Re){this.error=Re}}return be})(),q=(()=>{class be{static#e=this.type="[Auth] Check Session";constructor(){}}return be})(),K=(()=>{class be{static#e=this.type="[Auth] Sign Up";constructor(Re,dt){this.value=Re,this.verification=dt}}return be})(),j=(()=>{class be{static#e=this.type="[Auth] Sign Up Success";constructor(Re){this.response=Re}}return be})(),M=(()=>{class be{static#e=this.type="[Auth] Sign Up Failure";constructor(Re){this.error=Re}}return be})(),$=(()=>{class be{static#e=this.type="[Auth] Set User Locale";constructor(Re,dt){this.locale=Re,this.reload=dt}}return be})(),ce=(()=>{class be{static#e=this.type="[Auth] Set User Locale Success";constructor(Re){this.locale=Re}}return be})(),re=(()=>{class be{static#e=this.type="[Auth] Check Locale";constructor(){}}return be})(),ue=(()=>{class be{static#e=this.type="[Auth] Get User Apps";constructor(){}}return be})(),H=(()=>{class be{static#e=this.type="[Auth] Set User Apps";constructor(Re){this.apps=Re}}return be})(),te=(()=>{class be{static#e=this.type="[Auth] Check Selected App";constructor(){}}return be})(),F=(()=>{class be{static#e=this.type="[Auth] Set Selected User App";constructor(Re){this.appId=Re}}return be})(),w=(()=>{class be{static#e=this.type="[Auth] Send User Message";constructor(Re){this.message=Re}}return be})(),X=(()=>{class be{static#e=this.type="[Auth] Send User Message Success";constructor(Re){this.message=Re}}return be})(),oe=(()=>{class be{static#e=this.type="[Auth] Send User Message Fail";constructor(Re){this.err=Re}}return be})(),Y=(()=>{class be{static#e=this.type="[Auth] Get User Message";constructor(Re,dt){this.type=Re,this.mode=dt}}return be})(),he=(()=>{class be{static#e=this.type="[Auth] Get User Message Success";constructor(Re){this.message=Re}}return be})(),ne=(()=>{class be{static#e=this.type="[Auth] Get User Message Fail";constructor(Re){this.type=Re}}return be})(),_e=(()=>{class be{static#e=this.type="[Auth] Set Message Viewed";constructor(Re){this.messageSeenId=Re}}return be})(),Ce=(()=>{class be{static#e=this.type="[Auth] Set Message Viewed Success";constructor(){}}return be})(),Be=(()=>{class be{static#e=this.type="[Auth] Set Message Viewed Fail";constructor(){}}return be})(),Ie=(()=>{class be{static#e=this.type="[Auth] Verify Fail";constructor(Re){this.error=Re}}return be})(),Oe=(()=>{class be{static#e=this.type="[Auth] Reset";constructor(){}}return be})(),Te=(()=>{class be{static#e=this.type="[Auth] Delete Stored Data";constructor(){}}return be})(),ve=(()=>{class be{static#e=this.type="[Auth] Request Verification Code";constructor(Re,dt){this.email=Re,this.token=dt}}return be})(),Ve=(()=>{class be{static#e=this.type="[Auth] Request Verification Code Success";constructor(Re){this.response=Re}}return be})(),we=(()=>{class be{static#e=this.type="[Auth] Request Verification Code Fail";constructor(Re){this.error=Re}}return be})(),Je=(()=>{class be{static#e=this.type="[Auth] Verify Profile";constructor(Re,dt,yt){this.email=Re,this.token=dt,this.code=yt}}return be})(),tt=(()=>{class be{static#e=this.type="[Auth] Verify Profile Success";constructor(Re){this.response=Re}}return be})(),st=(()=>{class be{static#e=this.type="[Auth] Verify Profile Fail";constructor(Re){this.error=Re}}return be})(),rt=(()=>{class be{static#e=this.type="[Auth] Notify User Restriction";constructor(Re,dt,yt){this.type=Re,this.display=dt,this.data=yt}}return be})(),Ke=(()=>{class be{static#e=this.type="[Auth] Clear User Restriction";constructor(Re){this.displays=Re}}return be})(),et=(()=>{class be{static#e=this.type="[Auth] Set Content Viewed";constructor(Re,dt){this.contentId=Re,this.contentType=dt}}return be})(),ge=(()=>{class be{static#e=this.type="[Auth] Set Content Viewed Success";constructor(){}}return be})(),Ee=(()=>{class be{static#e=this.type="[Auth] Check Content Viewed";constructor(){}}return be})(),Fe=(()=>{class be{static#e=this.type="[Auth] Check Content Viewed Success";constructor(Re){this.contentViews=Re}}return be})(),$e=(()=>{class be{static#e=this.type="[Auth] Set Developer Referral";constructor(Re){this.isDeveloperReferral=Re}}return be})(),ot=(()=>{class be{static#e=this.type="[Auth] Set User View Gate Active";constructor(Re){this.active=Re}}return be})(),je=(()=>{class be{static#e=this.type="[Auth] Get User Notices"}return be})(),xe=(()=>{class be{static#e=this.type="[Auth] Get User Notices Success";constructor(Re){this.userNotices=Re}}return be})(),Me=(()=>{class be{static#e=this.type="[Auth] Get User Notices Fail";constructor(Re){this.error=Re}}return be})(),Ue=(()=>{class be{static#e=this.type="[Auth] Mark User Notice As Seen";constructor(Re){this.noticeId=Re}}return be})(),Ne=(()=>{class be{static#e=this.type="[Auth] Mark User Notice As Seen Success";constructor(Re){this.noticeId=Re}}return be})(),Xe=(()=>{class be{static#e=this.type="[Auth] Mark User Notice As Seen Fail";constructor(Re){this.error=Re}}return be})()},16823:(le,N,n)=>{"use strict";n.d(N,{k:()=>H});var e=n(92014),t=n(38165),s=n(71263),c=n(18152),O=n(15152),P=n(11756),S=n(21626),a=n(17215),f=n(11040),E=n(4158),y=n(47632),i=n(41862),g=n(47610),p=n(93915),h=n(66056),o=n(33013),v=n(15810),d=n(15318),r=n(15877),_=n(54438);class u{constructor(F,w,X){this.category=F,this.message=w,this.log=X}}let l=(()=>{class te{constructor(w){this.http=w,this.log={}}logError(w,X=!1){const oe=`${w.category}${w.message}`;return X&&this.log[oe]?(0,r.of)():(this.log[oe]=!0,this.http.post("/ws/human-error",w))}static#e=this.\u0275fac=function(X){return new(X||te)(_.KVO(S.Qq))};static#t=this.\u0275prov=_.jDH({token:te,factory:te.\u0275fac,providedIn:"root"})}return te})();var $,m=n(49204),C=n(28696),b=n(24418),R=n(52762),A=n(94371),G=n(27180),k=n(83889),V=n(91939),W=n(56081),T=n(59e3),x=n(27182),z=n(4475),I=n(87732),D=n(5690),L=n(7213),Q=n(70737),ie=n(71217),se=n(51036),Z=n(37780),de=n(53236),q=n(11153),K=n(50262),j=function(te,F,w,X){var he,oe=arguments.length,Y=oe<3?F:null===X?X=Object.getOwnPropertyDescriptor(F,w):X;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)Y=Reflect.decorate(te,F,w,X);else for(var ne=te.length-1;ne>=0;ne--)(he=te[ne])&&(Y=(oe<3?he(Y):oe>3?he(F,w,Y):he(F,w))||Y);return oe>3&&Y&&Object.defineProperty(F,w,Y),Y},M=function(te,F){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(te,F)};const ce=b.c.application===G.c.Studio,re={signed_in:!1},ue={loading:!1,requestingCode:!1,profileStatus:"ready",auth2:null,googleCredential:null,googlePromptResult:null,loggedIn:re,userLocale:null,userRoles:[],contentViews:{limit_reached:!1,inapp_view_limit:0,inapp_view_count:0},developerReferral:!1};let H=class cs{static#e=$=this;static getLoggedIn(F){return!0===F.loggedIn?.signed_in}static getLoggedInState(F){return F.loggedIn}static getEnvironmentSettings(F){return F.environmentSettings}static getProfile(F){const{userProfile:w,groupUserProfile:X}=F;return(0,m.isNil)(w)?(0,m.isNil)(X)?void 0:(0,se.v)(ie.P.Organization,X):(0,se.v)(ie.P.User,w)}static getUserProfile(F){return F.userProfile}static getGroupUserProfile(F){return F.groupUserProfile}static getUserRole(F){return(0,m.isNil)(F.userProfile)?(0,m.isNil)(F.groupUserProfile)?void 0:W.Oj:F.userProfile?.organizations[0]?.user_role??W.br}static getUserRoles(F){return F.userRoles}static getSystemDefaultRole(F){let w;return F&&(w=F.userRoles.find(X=>X.role_name===W.br.role_name)),null!==w?w:W.br}static getUserType(F){if(!(0,m.isNil)(F.userProfile)){const{premium_account:w,premium_account_type:X}=F.userProfile;if(w)return"group"===X?x.I.Team:x.I.Premium}return x.I.Free}static getUserSessionType(F){return F.loggedIn?.session_type}static canInviteUsers(F){if(!(0,m.isNil)(F.userProfile)){const w=$.getUserType(F),X=$.getUserRole(F);return(0,L._m)(X,Q.y.InviteUsers)&&w===x.I.Team}return!1}static getUserAccountSettings(F){return F?.userProfile?.account_settings??[]}static getAuth2(F){return F.auth2}static getGooglePromptResult(F){return F.googlePromptResult}static getProfileCheck(F){return F.profileCheck}static getLoading(F){return F.loading}static getVerifyingProfile(F){return"verifying"===F.profileStatus}static getProfileUpdating(F){return"updating"===F.profileStatus}static getProfileDeleting(F){return"deleting"===F.profileStatus}static getUserLocale(F){return F.userLocale}static getUserLanguage(F){return F.userLocale?.lang||f.q.lang}static getUserApps(F){return F?.userApps??[]}static getSelectedUserApp(F){return(F.userApps||[]).find(X=>X.id===F.selectedAppId)}static getUserFullName(F){return(0,m.isNil)(F.userProfile)?null:(0,m.trim)([F.userProfile.first_name??"",F.userProfile.last_name??""].join(" "))}static getUserEmail(F){return(0,m.isNil)(F.userProfile)?null:F.userProfile.email}static isPrivateUser(F){return!(0,m.isNil)(F.userProfile)&&0===(F?.userProfile?.organizations??[]).length}static isPremiumUser(F){return!0===F?.userProfile?.premium_account_valid}static isAdmin(F){const w=this.getUserRole(F);return!!w&&w.role_name===I.x.Admin}static isDeveloperReferral(F){return F.developerReferral}static getContentViews(F){return F.contentViews}static getContentViewsReached(F){return!$.isPremiumUser(F)&&F.contentViews.limit_reached}static hasActiveDeveloperAccount(F){return!(0,m.isNil)(F.userProfile)&&F.userProfile.developer_account&&(F.userProfile.developer_account_active||F.userProfile.developer_account_verified)&&F.userProfile.developer_has_apps}static getUserNotices(F){return F.userNotices}static canStartFreeTrial(F){return F.userProfile?.premium_account_eligibility.group_free_trial??!1}initializeGoogleAuth(F){const w={client_id:b.c.googleAuthKey,itp_support:!1};navigator.userAgent.indexOf("BioDigitalVR")>=0?(w.ux_mode="redirect",w.login_uri="https://"+window.location.host+"/ws/google/to/auth"):(w.ux_mode="popup",w.callback=oe=>{F.patchState({googleCredential:oe.credential}),F.dispatch(new t.rK(oe.credential))}),google.accounts.id.initialize(w)}promptWithGoogle(F){google.accounts.id.prompt(w=>{const X={dismissedReason:w.getDismissedReason(),momentType:w.getMomentType(),notDisplayedReason:w.getNotDisplayedReason(),skippedReason:w.getSkippedReason()};F.dispatch(new t.hz(X))})}promptWithGoogleSuccess(F,w){F.patchState({googlePromptResult:w.promptResult})}isLoggedIn(F,w){F.patchState({loading:!0}),this.authService.isLoggedIn().pipe((0,O.j)(()=>F.patchState({loading:!1}))).subscribe(X=>{const{signed_in:oe,session_type:Y}=X;F.dispatch(oe?new t.RL(Y):new t.i1(Y))})}isLoggedInSuccess(F,w){F.patchState({loggedIn:{signed_in:!0,session_type:w.sessionType}})}isLoggedInFailure(F,w){F.patchState({loggedIn:re})}login(F,w){const{login:X,verification:oe}=w,{email:Y}=X;F.patchState({loading:!0}),(oe?.isHuman?(0,r.of)(oe):this.authService.verifyIsHuman("studio_login",Y)).pipe((0,P.Z)(({isHuman:ne,verification:_e})=>{if(!ne)throw new K.s;return this.authService.loginWithBiodigital({...X,..._e?{site_verify_response:_e}:null})}),(0,O.j)(()=>F.patchState({loading:!1}))).subscribe({next:ne=>{F.dispatch(new t.b9("biodigital",ne))},error:ne=>{ne instanceof K.s&&F.dispatch(new t.sz(ne)),this.logFailure("LOGIN_FAILURE",ne),F.dispatch(new t.kb("biodigital",ne,X))}})}loginWithGoogle(F,w){F.patchState({loading:!0}),this.authService.loginWithGoogle(w.login).pipe((0,O.j)(()=>F.patchState({loading:!1}))).subscribe(X=>{F.dispatch(new t.b9("google",X))},X=>{(1===w.login.groupCodeMode||1===w.login.groupInviteMode)&&this.logFailure("GOOGLE_SIGNUP_FAILURE",X),F.dispatch(new t.kb("google",X,w.login))})}loginWithGroup(F,w){F.patchState({loading:!0}),this.authService.loginWithGroup(w.login).pipe((0,O.j)(()=>F.patchState({loading:!1}))).subscribe(X=>{F.dispatch(new t.b9("group",X))},X=>{F.dispatch(new t.kb("group",X,w.login))})}loginSuccess(F,w){ce&&(this.linkedinInsights.track("Sign in"),"google"===w.loginType&&"signup"===w.response.authentication_type?this.vendorAnalyticsService.trackSignUp(w.loginType):this.vendorAnalyticsService.trackSignIn(w.loginType)),F.dispatch(new t.Qb),F.dispatch(new t.hg)}loginFailure(F,w){ce&&this.vendorAnalyticsService.track("Sign In - Failure",{type:w.loginType,error:(0,de.u1)(w.error)||"There was an error logging in.",statusCode:w.error?.status})}logout(F,w){F.patchState({loading:!0}),("organization"===F.getState().loggedIn?.session_type?this.authService.logoutGroup():this.authService.logout()).pipe((0,O.j)(()=>F.patchState({loading:!1}))).subscribe(()=>F.dispatch(new t.cO),()=>F.dispatch(new t.je))}logoutSuccess(F,w){F.setState(ue),F.dispatch(new t.uj),F.dispatch(new A.W9),F.dispatch(new y.Ri),F.dispatch(new i.tV),F.dispatch(new g.lQ),F.dispatch(new p.$y),F.dispatch(new v.G.ResetLayout),F.dispatch(new c.QB),F.dispatch(new h.jj),F.dispatch(new o.FN),F.dispatch(new C.w.Reset),F.dispatch(new q.hw),this.storageService.clearSessionStorage()}checkProfile(F,w){return F.patchState({loading:!0}),this.authService.checkProfile(w.email).pipe((0,O.j)(()=>F.patchState({loading:!1}))).subscribe(X=>{F.dispatch(new t.vY(X))},X=>{F.dispatch(new t.YY(X))})}checkProfileSuccess(F,w){F.patchState({profileCheck:w.profile})}getGroupUserProfileAction(F,w){return F.patchState({loading:!0}),this.authService.getGroupUserProfile().pipe((0,O.j)(()=>F.patchState({loading:!1}))).subscribe(X=>{F.dispatch(new t.tk(X))},X=>{F.dispatch(new t.Sw(X))})}getGroupUserProfileSuccess(F,{groupUserProfile:w}){F.patchState({userProfile:null,groupUserProfile:w}),F.dispatch(new c.Fy(w.organizations)),F.dispatch(new t.hg)}getUserProfile(F,{hardCheck:w}){return F.patchState({loading:!0}),this.authService.getUserProfile(w).pipe((0,O.j)(()=>F.patchState({loading:!1}))).subscribe(X=>{F.dispatch(new t.Cy(X))},X=>{F.dispatch(new t.h8(X))})}getUserProfileSuccess(F,w){F.patchState({userProfile:w.userProfile,groupUserProfile:null}),F.dispatch(new c.Fy(w.userProfile.organizations)),F.dispatch(new t.o5),F.dispatch(new t.hg)}updateUserProfile(F,{userProfile:w}){F.patchState({profileStatus:"updating"}),this.authService.updaterUserProfile(w).pipe((0,O.j)(()=>F.patchState({profileStatus:"ready"}))).subscribe(()=>{F.dispatch(new t.ZD(w))},X=>{F.dispatch(new t._h(X))})}updateUserProfileSuccess(F,{userProfile:w}){this.vendorAnalyticsService.updateVisitorData(w)}deleteUserProfile(F,w){F.patchState({profileStatus:"deleting"}),this.authService.deleteUserProfile().pipe((0,O.j)(()=>F.patchState({profileStatus:"ready"}))).subscribe(X=>{F.dispatch(new t.nb(X))},X=>{F.dispatch(new t.cZ(X))})}getUserRoles(F,w){this.authService.getUserRoles().subscribe(X=>{F.patchState({userRoles:X})})}getUserApps(F,w){this.authService.getUserApps().subscribe(X=>{F.dispatch(new t.yO(X)),F.dispatch(new t._E)},X=>{})}setUserApps(F,{apps:w}){F.patchState({userApps:w})}setSelectedUserApp(F,{appId:w}){F.patchState({selectedAppId:w}),null!==w?this.storageService.setLocalItem(a.UT.UserAppId,w):this.storageService.removeLocalItem(a.UT.UserAppId)}checkSelectedUserApp(F,w){const X=F.getState().userApps,oe=this.storageService.getLocalItem(a.UT.UserAppId);if(oe){const Y=parseInt(oe,10);F.dispatch(new t.A$(Y))}else if(X&&X.length){const Y=X.find(he=>he.app_platform.some(ne=>ne.type===R.MM.Web));F.dispatch(new t.A$(Y?Y.id:void 0))}}checkSession(F,w){F.patchState({loading:!0}),this.authService.isLoggedIn().pipe((0,O.j)(()=>F.patchState({loading:!1}))).subscribe(X=>{const{signed_in:oe,session_type:Y}=X;oe?(F.dispatch(new t.RL(Y)),"organization"===Y?F.dispatch(new t.Cx):(F.dispatch(new t.hs),F.dispatch(new t.Xb))):F.dispatch(new t.i1(Y))})}getEnvironmentSettings(F,w){return F.patchState({loading:!0}),this.authService.getEnvironmentSettings().pipe((0,O.j)(()=>F.patchState({loading:!1}))).subscribe(X=>{F.dispatch(new t.Ko(X))},X=>{F.dispatch(new t.Dv(X))})}GetEnvironmentSettingsSuccess(F,w){F.patchState({environmentSettings:w.environmentSettings})}resetPassword(F,w){F.patchState({loading:!0}),this.authService.resetPassword(w.email).pipe((0,O.j)(()=>F.patchState({loading:!1}))).subscribe(()=>{F.dispatch(new t.ct(w.email))},X=>{F.dispatch(new t.Fm(X))})}transferFacebookAccount(F,w){F.patchState({loading:!0}),this.authService.verifyIsHuman("deactivate_facebook",w.email).pipe((0,P.Z)(({isHuman:X,verification:oe})=>{if(!X)throw new K.s;return this.authService.deactivateFacebook({version:4,app_productkey:this.productService.productKey,app_producttype:this.productService.productType,...oe?{site_verify_response:oe}:null,user_email:w.email})}),(0,O.j)(()=>F.patchState({loading:!1}))).subscribe({next:X=>{F.dispatch(X.conversion_complete&&X.reset_password_email_sent?new t.o7(w.email):new t.z3(new Error("Facebook deactivation failed")))},error:X=>{X instanceof K.s&&F.dispatch(new t.sz(X)),F.dispatch(new t.z3(X))}})}updatePassword(F,w){const{currentPassword:X,newPassword:oe,confirmNewPassword:Y}=w;this.authService.updatePassword(X,oe,Y).subscribe(()=>{F.dispatch(new t.kP)},he=>{F.dispatch(new t.j3(he))})}signUp(F,w){const{value:X,verification:oe}=w,{email:Y}=X;F.patchState({loading:!0}),(oe?.isHuman?(0,r.of)(oe):this.authService.verifyIsHuman("studio_signup",Y)).pipe((0,P.Z)(({isHuman:ne,verification:_e})=>{if(!ne)throw new K.s;return this.authService.signUp({...X,..._e?{site_verify_response:_e}:null})}),(0,O.j)(()=>F.patchState({loading:!1}))).subscribe({next:ne=>{F.dispatch(new t.mK(ne))},error:ne=>{ne instanceof K.s&&F.dispatch(new t.sz(ne)),F.dispatch(new t.HP(ne))}})}signUpSuccess(F,w){ce&&this.vendorAnalyticsService.trackSignUp("biodigital")}signUpFailure(F,w){ce&&this.vendorAnalyticsService.track("Sign Up - Failure",{error:(0,de.u1)(w?.error)||"There was an error signing up.",statusCode:w.error?.status}),this.logFailure("BIODIGITAL_SIGNUP_FAILURE",w)}setUserLocale(F,{locale:w,reload:X}){this.storageService.setLocalItem(a.UT.Locale,w.id),X?window.location.reload():(F.patchState({userLocale:w}),F.dispatch(new t.XH(w)))}setUserLocaleSuccess(F,{locale:w}){(0,E.vM)(this.httpClient,w.id)().subscribe(()=>{})}checkLocale(F,w){const X=(0,f.kF)(),oe=f.IB.find(Y=>Y.id===X)||f.q;F.dispatch(new t.aD(oe))}sendUserMessage(F,{message:w}){this.userMessageService.sendMessage(w).subscribe(()=>{F.dispatch(new t._L(w))},X=>{F.dispatch(new t.zc(X))})}getUserMessage(F,{type:w,mode:X}){this.userMessageService.getUserMessage(w,X).subscribe(oe=>{F.dispatch(new t.W3(oe))},()=>{F.dispatch(new t.NH(w))})}setUserMessageViewed(F,{messageSeenId:w}){this.userMessageService.setUserMessageViewed(w).subscribe(()=>F.dispatch(new t.Mg),()=>F.dispatch(new t.RR))}resetAuth(F,w){F.setState(ue)}requestVerificationCode(F,{email:w,token:X}){F.patchState({requestingCode:!0}),this.authService.requestVerificationCode({user_email:w,verification_jwt:X}).pipe((0,O.j)(()=>F.patchState({requestingCode:!1}))).subscribe(oe=>{F.dispatch(new t.bY(oe))},oe=>{F.dispatch(new t.Ml(oe))})}verifyProfile(F,{email:w,token:X,code:oe}){const Y=oe.toUpperCase();F.patchState({profileStatus:"verifying"}),this.authService.verifyProfile({user_email:w,verification_code:Y,verification_jwt:X}).pipe((0,O.j)(()=>F.patchState({profileStatus:"ready"}))).subscribe(he=>{F.dispatch(new t.iM(he)),F.dispatch(new t.lC)},he=>{F.dispatch(new t.RW(he))})}verifyProfileSuccess(F){this.vendorAnalyticsService.track("Email Verify - Success",{platform:this.productService.productType})}verifyProfileFail(F,w){this.vendorAnalyticsService.track("Email Verify - Failure",{error:(0,de.u1)(w?.error)||"There was an error with email verification.",statusCode:w.error?.status})}setContentView(F,{contentId:w,contentType:X}){this.contentViewService.trackContentView(w,X).subscribe(()=>{F.dispatch(new t.h5),F.dispatch(new t.OF)})}checkContentViews(F,w){this.contentViewService.checkContentView().subscribe(X=>{F.patchState({contentViews:X}),F.dispatch(new t.vL(X))})}setDeveloperReferral(F,w){F.patchState({developerReferral:w.isDeveloperReferral})}logFailure(F,w){const X=w?.message||"",oe=(0,de.u1)(w)||"";this.errorLoggingService.logError(new u(F,X,oe)).subscribe()}getUserNotices(F){this.authService.getUserNotices().subscribe({next:w=>{const X=w.notices;F.patchState({userNotices:X}),F.dispatch(new t.uG(X))},error:w=>F.dispatch(new t.Fw(w))})}markUserNoticeAsSeen(F,{noticeId:w}){this.authService.markUserNoticeAsSeen(w).subscribe({next:()=>{const X=F.getState().userNotices;if(X){const oe=X.findIndex(Y=>Y.notice_id===w);X.splice(oe,1),F.patchState({userNotices:[...X]}),F.dispatch(new t.R$(w))}},error:X=>F.dispatch(new t.CU(X))})}constructor(F,w,X,oe,Y,he,ne,_e,Ce){this.authService=F,this.userMessageService=w,this.storageService=X,this.errorLoggingService=oe,this.linkedinInsights=Y,this.vendorAnalyticsService=he,this.contentViewService=ne,this.productService=_e,this.httpClient=Ce}ngxsOnInit(F){F.dispatch(new t.lC),F.dispatch(new t.hg),F.dispatch(new t._E),F.dispatch(new t.ij)}static#t=this.\u0275fac=function(w){return new(w||cs)(_.KVO(s.u),_.KVO(d.K),_.KVO(a.n$),_.KVO(l),_.KVO(k.n),_.KVO(T.e),_.KVO(z.K),_.KVO(D.b),_.KVO(S.Qq))};static#n=this.\u0275prov=_.jDH({token:cs,factory:cs.\u0275fac})};j([(0,e.rc)(t.ij),M("design:type",Function),M("design:paramtypes",[Object]),M("design:returntype",void 0)],H.prototype,"initializeGoogleAuth",null),j([(0,e.rc)(t.eu),M("design:type",Function),M("design:paramtypes",[Object]),M("design:returntype",void 0)],H.prototype,"promptWithGoogle",null),j([(0,e.rc)(t.hz),M("design:type",Function),M("design:paramtypes",[Object,t.hz]),M("design:returntype",void 0)],H.prototype,"promptWithGoogleSuccess",null),j([(0,e.rc)(t.Qb),M("design:type",Function),M("design:paramtypes",[Object,t.Qb]),M("design:returntype",void 0)],H.prototype,"isLoggedIn",null),j([(0,e.rc)(t.RL),M("design:type",Function),M("design:paramtypes",[Object,t.RL]),M("design:returntype",void 0)],H.prototype,"isLoggedInSuccess",null),j([(0,e.rc)(t.i1),M("design:type",Function),M("design:paramtypes",[Object,t.i1]),M("design:returntype",void 0)],H.prototype,"isLoggedInFailure",null),j([(0,e.rc)(t.Gu),M("design:type",Function),M("design:paramtypes",[Object,t.Gu]),M("design:returntype",void 0)],H.prototype,"login",null),j([(0,e.rc)(t.Zc),M("design:type",Function),M("design:paramtypes",[Object,t.Zc]),M("design:returntype",void 0)],H.prototype,"loginWithGoogle",null),j([(0,e.rc)(t.bl),M("design:type",Function),M("design:paramtypes",[Object,t.bl]),M("design:returntype",void 0)],H.prototype,"loginWithGroup",null),j([(0,e.rc)(t.b9),M("design:type",Function),M("design:paramtypes",[Object,t.b9]),M("design:returntype",void 0)],H.prototype,"loginSuccess",null),j([(0,e.rc)(t.kb),M("design:type",Function),M("design:paramtypes",[Object,t.kb]),M("design:returntype",void 0)],H.prototype,"loginFailure",null),j([(0,e.rc)(t.fQ),M("design:type",Function),M("design:paramtypes",[Object,t.fQ]),M("design:returntype",void 0)],H.prototype,"logout",null),j([(0,e.rc)(t.cO),M("design:type",Function),M("design:paramtypes",[Object,t.cO]),M("design:returntype",void 0)],H.prototype,"logoutSuccess",null),j([(0,e.rc)(t.YP),M("design:type",Function),M("design:paramtypes",[Object,t.YP]),M("design:returntype",void 0)],H.prototype,"checkProfile",null),j([(0,e.rc)(t.vY),M("design:type",Function),M("design:paramtypes",[Object,t.vY]),M("design:returntype",void 0)],H.prototype,"checkProfileSuccess",null),j([(0,e.rc)(t.Cx),M("design:type",Function),M("design:paramtypes",[Object,t.Cx]),M("design:returntype",void 0)],H.prototype,"getGroupUserProfileAction",null),j([(0,e.rc)(t.tk),M("design:type",Function),M("design:paramtypes",[Object,t.tk]),M("design:returntype",void 0)],H.prototype,"getGroupUserProfileSuccess",null),j([(0,e.rc)(t.hs),M("design:type",Function),M("design:paramtypes",[Object,t.hs]),M("design:returntype",void 0)],H.prototype,"getUserProfile",null),j([(0,e.rc)(t.Cy),M("design:type",Function),M("design:paramtypes",[Object,t.Cy]),M("design:returntype",void 0)],H.prototype,"getUserProfileSuccess",null),j([(0,e.rc)(t.Kg),M("design:type",Function),M("design:paramtypes",[Object,t.Kg]),M("design:returntype",void 0)],H.prototype,"updateUserProfile",null),j([(0,e.rc)(t.ZD),M("design:type",Function),M("design:paramtypes",[Object,t.Kg]),M("design:returntype",void 0)],H.prototype,"updateUserProfileSuccess",null),j([(0,e.rc)(t.sG),M("design:type",Function),M("design:paramtypes",[Object,t.sG]),M("design:returntype",void 0)],H.prototype,"deleteUserProfile",null),j([(0,e.rc)(t.Xb),M("design:type",Function),M("design:paramtypes",[Object,t.Xb]),M("design:returntype",void 0)],H.prototype,"getUserRoles",null),j([(0,e.rc)(t.o5),M("design:type",Function),M("design:paramtypes",[Object,t.o5]),M("design:returntype",void 0)],H.prototype,"getUserApps",null),j([(0,e.rc)(t.yO),M("design:type",Function),M("design:paramtypes",[Object,t.yO]),M("design:returntype",void 0)],H.prototype,"setUserApps",null),j([(0,e.rc)(t.A$),M("design:type",Function),M("design:paramtypes",[Object,t.A$]),M("design:returntype",void 0)],H.prototype,"setSelectedUserApp",null),j([(0,e.rc)(t._E),M("design:type",Function),M("design:paramtypes",[Object,t._E]),M("design:returntype",void 0)],H.prototype,"checkSelectedUserApp",null),j([(0,e.rc)(t.lC),M("design:type",Function),M("design:paramtypes",[Object,t.lC]),M("design:returntype",void 0)],H.prototype,"checkSession",null),j([(0,e.rc)(t.xG),M("design:type",Function),M("design:paramtypes",[Object,t.xG]),M("design:returntype",void 0)],H.prototype,"getEnvironmentSettings",null),j([(0,e.rc)(t.Ko),M("design:type",Function),M("design:paramtypes",[Object,t.Ko]),M("design:returntype",void 0)],H.prototype,"GetEnvironmentSettingsSuccess",null),j([(0,e.rc)(t.RO),M("design:type",Function),M("design:paramtypes",[Object,t.RO]),M("design:returntype",void 0)],H.prototype,"resetPassword",null),j([(0,e.rc)(t.JY),M("design:type",Function),M("design:paramtypes",[Object,t.JY]),M("design:returntype",void 0)],H.prototype,"transferFacebookAccount",null),j([(0,e.rc)(t.RE),M("design:type",Function),M("design:paramtypes",[Object,t.RE]),M("design:returntype",void 0)],H.prototype,"updatePassword",null),j([(0,e.rc)(t.Hx),M("design:type",Function),M("design:paramtypes",[Object,t.Hx]),M("design:returntype",void 0)],H.prototype,"signUp",null),j([(0,e.rc)(t.mK),M("design:type",Function),M("design:paramtypes",[Object,t.mK]),M("design:returntype",void 0)],H.prototype,"signUpSuccess",null),j([(0,e.rc)(t.HP),M("design:type",Function),M("design:paramtypes",[Object,t.HP]),M("design:returntype",void 0)],H.prototype,"signUpFailure",null),j([(0,e.rc)(t.aD),M("design:type",Function),M("design:paramtypes",[Object,t.aD]),M("design:returntype",void 0)],H.prototype,"setUserLocale",null),j([(0,e.rc)(t.XH),M("design:type",Function),M("design:paramtypes",[Object,t.XH]),M("design:returntype",void 0)],H.prototype,"setUserLocaleSuccess",null),j([(0,e.rc)(t.hg),M("design:type",Function),M("design:paramtypes",[Object,t.hg]),M("design:returntype",void 0)],H.prototype,"checkLocale",null),j([(0,e.rc)(t.r),M("design:type",Function),M("design:paramtypes",[Object,t.r]),M("design:returntype",void 0)],H.prototype,"sendUserMessage",null),j([(0,e.rc)(t.ru),M("design:type",Function),M("design:paramtypes",[Object,t.ru]),M("design:returntype",void 0)],H.prototype,"getUserMessage",null),j([(0,e.rc)(t.P),M("design:type",Function),M("design:paramtypes",[Object,t.P]),M("design:returntype",void 0)],H.prototype,"setUserMessageViewed",null),j([(0,e.rc)(t.uj),M("design:type",Function),M("design:paramtypes",[Object,t.uj]),M("design:returntype",void 0)],H.prototype,"resetAuth",null),j([(0,e.rc)(t.wj),M("design:type",Function),M("design:paramtypes",[Object,t.wj]),M("design:returntype",void 0)],H.prototype,"requestVerificationCode",null),j([(0,e.rc)(t.XZ),M("design:type",Function),M("design:paramtypes",[Object,t.XZ]),M("design:returntype",void 0)],H.prototype,"verifyProfile",null),j([(0,e.rc)(t.iM),M("design:type",Function),M("design:paramtypes",[Object]),M("design:returntype",void 0)],H.prototype,"verifyProfileSuccess",null),j([(0,e.rc)(t.RW),M("design:type",Function),M("design:paramtypes",[Object,t.RW]),M("design:returntype",void 0)],H.prototype,"verifyProfileFail",null),j([(0,e.rc)(t.e0),M("design:type",Function),M("design:paramtypes",[Object,t.e0]),M("design:returntype",void 0)],H.prototype,"setContentView",null),j([(0,e.rc)(t.OF),M("design:type",Function),M("design:paramtypes",[Object,t.OF]),M("design:returntype",void 0)],H.prototype,"checkContentViews",null),j([(0,e.rc)(t.kK),M("design:type",Function),M("design:paramtypes",[Object,t.kK]),M("design:returntype",void 0)],H.prototype,"setDeveloperReferral",null),j([(0,e.rc)(t.T9),M("design:type",Function),M("design:paramtypes",[Object]),M("design:returntype",void 0)],H.prototype,"getUserNotices",null),j([(0,e.rc)(t.EX),M("design:type",Function),M("design:paramtypes",[Object,t.EX]),M("design:returntype",void 0)],H.prototype,"markUserNoticeAsSeen",null),j([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[Object]),M("design:returntype",void 0)],H,"getLoggedIn",null),j([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[Object]),M("design:returntype",Object)],H,"getLoggedInState",null),j([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[Object]),M("design:returntype",void 0)],H,"getEnvironmentSettings",null),j([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[Object]),M("design:returntype",Object)],H,"getProfile",null),j([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[Object]),M("design:returntype",Z.s)],H,"getUserProfile",null),j([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[Object]),M("design:returntype",class ae{})],H,"getGroupUserProfile",null),j([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[Object]),M("design:returntype",V.V)],H,"getUserRole",null),j([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[Object]),M("design:returntype",Array)],H,"getUserRoles",null),j([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[Object]),M("design:returntype",V.V)],H,"getSystemDefaultRole",null),j([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[Object]),M("design:returntype",String)],H,"getUserType",null),j([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[Object]),M("design:returntype",void 0)],H,"getUserSessionType",null),j([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[Object]),M("design:returntype",Boolean)],H,"canInviteUsers",null),j([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[Object]),M("design:returntype",Array)],H,"getUserAccountSettings",null),j([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[Object]),M("design:returntype",Object)],H,"getAuth2",null),j([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[Object]),M("design:returntype",Object)],H,"getGooglePromptResult",null),j([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[Object]),M("design:returntype",void 0)],H,"getProfileCheck",null),j([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[Object]),M("design:returntype",void 0)],H,"getLoading",null),j([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[Object]),M("design:returntype",void 0)],H,"getVerifyingProfile",null),j([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[Object]),M("design:returntype",void 0)],H,"getProfileUpdating",null),j([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[Object]),M("design:returntype",void 0)],H,"getProfileDeleting",null),j([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[Object]),M("design:returntype",void 0)],H,"getUserLocale",null),j([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[Object]),M("design:returntype",String)],H,"getUserLanguage",null),j([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[Object]),M("design:returntype",void 0)],H,"getUserApps",null),j([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[Object]),M("design:returntype",void 0)],H,"getSelectedUserApp",null),j([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[Object]),M("design:returntype",void 0)],H,"getUserFullName",null),j([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[Object]),M("design:returntype",void 0)],H,"getUserEmail",null),j([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[Object]),M("design:returntype",void 0)],H,"isPrivateUser",null),j([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[Object]),M("design:returntype",void 0)],H,"isPremiumUser",null),j([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[Object]),M("design:returntype",void 0)],H,"isAdmin",null),j([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[Object]),M("design:returntype",void 0)],H,"isDeveloperReferral",null),j([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[Object]),M("design:returntype",void 0)],H,"getContentViews",null),j([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[Object]),M("design:returntype",void 0)],H,"getContentViewsReached",null),j([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[Object]),M("design:returntype",void 0)],H,"hasActiveDeveloperAccount",null),j([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[Object]),M("design:returntype",void 0)],H,"getUserNotices",null),j([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[Object]),M("design:returntype",void 0)],H,"canStartFreeTrial",null),H=$=j([(0,e.Uw)({name:"auth",defaults:ue}),M("design:paramtypes",[s.u,d.K,a.n$,l,k.n,T.e,z.K,D.b,S.Qq])],H)},94371:(le,N,n)=>{"use strict";n.d(N,{BO:()=>f,FT:()=>v,Fn:()=>g,GY:()=>i,Jv:()=>t,K$:()=>s,OR:()=>c,P1:()=>S,SF:()=>p,Vz:()=>r,W9:()=>e,XF:()=>O,Yj:()=>a,dJ:()=>C,eI:()=>u,ee:()=>P,gq:()=>m,l2:()=>_,lG:()=>y,sM:()=>o,v_:()=>l,wE:()=>E,wq:()=>d,xD:()=>h});let e=(()=>{class b{static#e=this.type="[Subscription] Reset Subscription State"}return b})(),t=(()=>{class b{static#e=this.type="[Subscription] Request Braintree Payment Success";constructor(A){this.request=A}}return b})(),s=(()=>{class b{static#e=this.type="[Subscription] Request Braintree Payment Failure";constructor(A,G){this.request=A,this.errorMessage=G}}return b})(),c=(()=>{class b{static#e=this.type="[Subscription] Buy Subscription";constructor(A){this.request=A}}return b})(),O=(()=>{class b{static#e=this.type="[Subscription] Buy Subscription Success";constructor(A){this.request=A}}return b})(),P=(()=>{class b{static#e=this.type="[Subscription] Buy Subscription Failure";constructor(A,G){this.error=A,this.request=G}}return b})(),S=(()=>{class b{static#e=this.type="[Subscription] Update Subscription";constructor(A){this.request=A}}return b})(),a=(()=>{class b{static#e=this.type="[Subscription] Update Subscription Success";constructor(A){this.request=A}}return b})(),f=(()=>{class b{static#e=this.type="[Subscription] Update Subscription Failure";constructor(A,G){this.error=A,this.request=G}}return b})(),E=(()=>{class b{static#e=this.type="[Subscription] Cancel Subscription"}return b})(),y=(()=>{class b{static#e=this.type="[Subscription] Cancel Subscription Success"}return b})(),i=(()=>{class b{static#e=this.type="[Subscription] Cancel Subscription Failure";constructor(A){this.error=A}}return b})(),g=(()=>{class b{static#e=this.type="[Subscription] Get Subscription Sales Tax";constructor(A,G,k){this.planId=A,this.billingAddress=G,this.code=k}}return b})(),p=(()=>{class b{static#e=this.type="[Subscription] Get Subscription Sales Tax Success";constructor(A){this.planSalesTax=A}}return b})(),h=(()=>{class b{static#e=this.type="[Subscription] Get Subscription Sales Tax Failure";constructor(A,G){this.error=A,this.request=G}}return b})(),o=(()=>{class b{static#e=this.type="[Subscription] Clear Subscription Sales Tax"}return b})(),v=(()=>{class b{static#e=this.type="[Subscription] Check Promo Code";constructor(A,G){this.planId=A,this.code=G}}return b})(),d=(()=>{class b{static#e=this.type="[Subscription] Check Promo Code Success";constructor(A,G){this.code=A,this.plan=G}}return b})(),r=(()=>{class b{static#e=this.type="[Subscription] Check Promo Code Failure";constructor(A){this.err=A}}return b})(),_=(()=>{class b{static#e=this.type="[Subscription] Clear Discount"}return b})(),u=(()=>{class b{static#e=this.type="[Subscription] Get Premium Plans"}return b})(),l=(()=>{class b{static#e=this.type="[Subscription] Get Premium Plans Success ";constructor(A){this.plans=A}}return b})(),m=(()=>{class b{static#e=this.type="[Subscription] Get Premium Plans Failure";constructor(A){this.error=A}}return b})(),C=(()=>{class b{static#e=this.type="[Subscription] Set Premium Plan";constructor(A){this.plan=A}}return b})()},34440:(le,N,n)=>{"use strict";n.d(N,{z:()=>l});var e=n(92014);class t{}var r,s=n(59771),c=n(94371),O=n(15152),P=n(11756),S=n(71263),a=n(24418),f=n(12215),E=n(38165),y=n(49204),i=n(16823),g=n(59e3),p=n(50262),h=n(53236),o=n(54438),v=function(m,C,b,R){var k,A=arguments.length,G=A<3?C:null===R?R=Object.getOwnPropertyDescriptor(C,b):R;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)G=Reflect.decorate(m,C,b,R);else for(var V=m.length-1;V>=0;V--)(k=m[V])&&(G=(A<3?k(G):A>3?k(C,b,G):k(C,b))||G);return A>3&&G&&Object.defineProperty(C,b,G),G},d=function(m,C){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(m,C)};let _;const u={buying:!1,updating:!1,cancelling:!1,checkingCode:!1,checkingSalesTax:!1,plans:[],selectedPlan:null,selectedPlanSalesTax:null};let l=class ds{static#e=r=this;static getBuying(C){return C.buying}static getUpdating(C){return C.updating}static getCancelling(C){return C.cancelling}static getSubscription(C,b){return b.userProfile?.subscription}static getPlans(C){return C.plans}static getSelectedPlan(C){return C.selectedPlan}static getSelectedPlanSalesTax(C){return C.selectedPlanSalesTax}static getCheckingSalesTax(C){return C.checkingSalesTax}static getCheckingCode(C){return C.checkingCode}static isFreeTrial(C,b){return"Free Trial"===(b.userProfile?.subscription?.subscription_type||"")}static isCanceled(C,b){return"canceled"===(b.userProfile?.subscription?.subscription_status||"")}requestBraintreePaymentSuccess(C,{request:b}){this.recordSubscriptionAnalytic("Request Payment",b)}requestBraintreePaymentFailure(C,{request:b,errorMessage:R}){this.recordSubscriptionAnalytic("Request Payment Failure",b,R)}resetSubscriptionState(C,b){C.setState(u)}getPremiumPlans(C,b){this.subscriptionService.getBraintreePlans().subscribe(R=>{C.dispatch(new c.v_(R))},R=>{C.dispatch(new c.gq(R))})}getPremiumPlansSuccess(C,{plans:b}){C.patchState({plans:b})}setPremiumPlan(C,{plan:b}){C.patchState({selectedPlan:b})}buySubscription(C,{request:b}){C.patchState({buying:!0}),a.c.deploy===f.Z.Local?this.subscriptionService.buyProfessionalSubscription(b).pipe((0,O.j)(()=>C.patchState({buying:!1}))).subscribe(()=>{C.dispatch(new c.XF(b))},R=>{C.dispatch(new c.ee(R,b))}):this.authService.verifyIsHuman("subscription_checkout").pipe((0,P.Z)(({isHuman:R})=>{if(!R)throw new p.s;return this.subscriptionService.buyProfessionalSubscription(b)}),(0,O.j)(()=>C.patchState({buying:!1}))).subscribe({next:()=>{C.dispatch(new c.XF(b))},error:R=>{R instanceof p.s&&C.dispatch(new E.sz(R)),C.dispatch(new c.ee(R,b))}})}buySubscriptionSuccess(C,{request:b}){this.recordSubscriptionAnalytic("Account Upgrade",b)}buySubscriptionFailure(C,{request:b,error:R}){const A=`${R.message}: ${(0,h.u1)(R)}`;this.recordSubscriptionAnalytic("Account Upgrade Failure",b,A)}updateSubscription(C,{request:b}){C.patchState({updating:!0}),this.subscriptionService.updateProfessionalSubscription(b).pipe((0,O.j)(()=>C.patchState({updating:!1}))).subscribe(()=>{C.dispatch(new c.Yj(b))},R=>{C.dispatch(new c.BO(R,b))})}updateSubscriptionSuccess(C,{request:b}){this.recordSubscriptionAnalytic("Update Subscription",b)}updateSubscriptionFailure(C,{request:b,error:R}){const A=`${R.message}: ${(0,h.u1)(R)}`;this.recordSubscriptionAnalytic("Update Subscription Failure",b,A)}cancelSubscription(C,b){C.patchState({cancelling:!0}),this.subscriptionService.cancelSubscription().pipe((0,O.j)(()=>C.patchState({cancelling:!1}))).subscribe(()=>{C.dispatch(new c.lG)},R=>{C.dispatch(new c.GY(R))})}getSubscriptionSalesTax(C,{planId:b,billingAddress:R,code:A}){_&&_.unsubscribe(),C.patchState({checkingSalesTax:!0}),_=this.subscriptionService.getBraintreePlanSalesTax(b,R,A).subscribe({next:G=>{C.patchState({checkingSalesTax:!1}),C.dispatch(new c.SF(G))},error:G=>{C.patchState({checkingSalesTax:!1}),C.dispatch(new c.xD(G,{planId:b}))}})}getSubscriptionSalesTaxSuccess(C,{planSalesTax:b}){C.patchState({selectedPlanSalesTax:b})}getSubscriptionSalesTaxFailure(C,{error:b,request:R}){C.patchState({selectedPlanSalesTax:null});const A=`${b.message}: ${(0,h.u1)(b)}`;this.recordSubscriptionAnalytic("Subscription Sales Tax Failure",R,A)}clearSubscriptionSalesTax(C){C.patchState({selectedPlanSalesTax:null})}checkPromoCode(C,{planId:b,code:R}){C.patchState({checkingCode:!0}),this.subscriptionService.getBraintreePlan(b,R).pipe((0,O.j)(()=>C.patchState({checkingCode:!1}))).subscribe(A=>{C.dispatch(new c.wq(R,A))},A=>{C.dispatch(new c.Vz(A))})}checkPromoCodeSuccess(C,{plan:b}){C.patchState({selectedPlan:b})}removePromoCode(C){const{plans:b,selectedPlan:R}=C.getState();if(!(0,y.isNil)(R)){const A=R.plan_id;C.patchState({selectedPlan:b.find(G=>G.plan_id===A)})}}constructor(C,b,R,A){this.authService=C,this.subscriptionService=b,this.vendorAnalyticsService=R,this.store=A}recordSubscriptionAnalytic(C,b,R){this.store.selectSnapshot(r.getSubscription)||(C=`${C} - ${this.store.selectSnapshot(r.isFreeTrial)?"Free Trial to Premium Individual":"Free Individual to Premium Individual"}`);const A={planId:b.planId};b.type&&(A.paymentType=b.type),R&&(A.errorMessage=R),this.vendorAnalyticsService.track(C,A)}static#t=this.\u0275fac=function(b){return new(b||ds)(o.KVO(S.u),o.KVO(s.n),o.KVO(g.e),o.KVO(e.il))};static#n=this.\u0275prov=o.jDH({token:ds,factory:ds.\u0275fac})};v([(0,e.rc)(c.Jv),d("design:type",Function),d("design:paramtypes",[Object,c.Jv]),d("design:returntype",void 0)],l.prototype,"requestBraintreePaymentSuccess",null),v([(0,e.rc)(c.K$),d("design:type",Function),d("design:paramtypes",[Object,c.K$]),d("design:returntype",void 0)],l.prototype,"requestBraintreePaymentFailure",null),v([(0,e.rc)(c.W9),d("design:type",Function),d("design:paramtypes",[Object,c.W9]),d("design:returntype",void 0)],l.prototype,"resetSubscriptionState",null),v([(0,e.rc)(c.eI),d("design:type",Function),d("design:paramtypes",[Object,c.eI]),d("design:returntype",void 0)],l.prototype,"getPremiumPlans",null),v([(0,e.rc)(c.v_),d("design:type",Function),d("design:paramtypes",[Object,c.v_]),d("design:returntype",void 0)],l.prototype,"getPremiumPlansSuccess",null),v([(0,e.rc)(c.dJ),d("design:type",Function),d("design:paramtypes",[Object,c.dJ]),d("design:returntype",void 0)],l.prototype,"setPremiumPlan",null),v([(0,e.rc)(c.OR),d("design:type",Function),d("design:paramtypes",[Object,c.OR]),d("design:returntype",void 0)],l.prototype,"buySubscription",null),v([(0,e.rc)(c.XF),d("design:type",Function),d("design:paramtypes",[Object,c.XF]),d("design:returntype",void 0)],l.prototype,"buySubscriptionSuccess",null),v([(0,e.rc)(c.ee),d("design:type",Function),d("design:paramtypes",[Object,c.ee]),d("design:returntype",void 0)],l.prototype,"buySubscriptionFailure",null),v([(0,e.rc)(c.P1),d("design:type",Function),d("design:paramtypes",[Object,c.P1]),d("design:returntype",void 0)],l.prototype,"updateSubscription",null),v([(0,e.rc)(c.Yj),d("design:type",Function),d("design:paramtypes",[Object,c.Yj]),d("design:returntype",void 0)],l.prototype,"updateSubscriptionSuccess",null),v([(0,e.rc)(c.BO),d("design:type",Function),d("design:paramtypes",[Object,c.BO]),d("design:returntype",void 0)],l.prototype,"updateSubscriptionFailure",null),v([(0,e.rc)(c.wE),d("design:type",Function),d("design:paramtypes",[Object,c.wE]),d("design:returntype",void 0)],l.prototype,"cancelSubscription",null),v([(0,e.rc)(c.Fn),d("design:type",Function),d("design:paramtypes",[Object,c.Fn]),d("design:returntype",void 0)],l.prototype,"getSubscriptionSalesTax",null),v([(0,e.rc)(c.SF),d("design:type",Function),d("design:paramtypes",[Object,c.SF]),d("design:returntype",void 0)],l.prototype,"getSubscriptionSalesTaxSuccess",null),v([(0,e.rc)(c.xD),d("design:type",Function),d("design:paramtypes",[Object,c.xD]),d("design:returntype",void 0)],l.prototype,"getSubscriptionSalesTaxFailure",null),v([(0,e.rc)(c.sM),d("design:type",Function),d("design:paramtypes",[Object]),d("design:returntype",void 0)],l.prototype,"clearSubscriptionSalesTax",null),v([(0,e.rc)(c.FT),d("design:type",Function),d("design:paramtypes",[Object,c.FT]),d("design:returntype",void 0)],l.prototype,"checkPromoCode",null),v([(0,e.rc)(c.wq),d("design:type",Function),d("design:paramtypes",[Object,c.wq]),d("design:returntype",void 0)],l.prototype,"checkPromoCodeSuccess",null),v([(0,e.rc)(c.l2),d("design:type",Function),d("design:paramtypes",[Object]),d("design:returntype",void 0)],l.prototype,"removePromoCode",null),v([(0,e.MD)(),d("design:type",Function),d("design:paramtypes",[t]),d("design:returntype",void 0)],l,"getBuying",null),v([(0,e.MD)(),d("design:type",Function),d("design:paramtypes",[t]),d("design:returntype",void 0)],l,"getUpdating",null),v([(0,e.MD)(),d("design:type",Function),d("design:paramtypes",[t]),d("design:returntype",void 0)],l,"getCancelling",null),v([(0,e.MD)([l,i.k]),d("design:type",Function),d("design:paramtypes",[t,Object]),d("design:returntype",void 0)],l,"getSubscription",null),v([(0,e.MD)(),d("design:type",Function),d("design:paramtypes",[t]),d("design:returntype",void 0)],l,"getPlans",null),v([(0,e.MD)(),d("design:type",Function),d("design:paramtypes",[t]),d("design:returntype",void 0)],l,"getSelectedPlan",null),v([(0,e.MD)(),d("design:type",Function),d("design:paramtypes",[t]),d("design:returntype",void 0)],l,"getSelectedPlanSalesTax",null),v([(0,e.MD)(),d("design:type",Function),d("design:paramtypes",[t]),d("design:returntype",void 0)],l,"getCheckingSalesTax",null),v([(0,e.MD)(),d("design:type",Function),d("design:paramtypes",[t]),d("design:returntype",void 0)],l,"getCheckingCode",null),v([(0,e.MD)([l,i.k]),d("design:type",Function),d("design:paramtypes",[t,Object]),d("design:returntype",void 0)],l,"isFreeTrial",null),v([(0,e.MD)([l,i.k]),d("design:type",Function),d("design:paramtypes",[t,Object]),d("design:returntype",void 0)],l,"isCanceled",null),l=r=v([(0,e.Uw)({name:"subscription",defaults:u}),d("design:paramtypes",[S.u,s.n,g.e,e.il])],l)},59771:(le,N,n)=>{"use strict";n.d(N,{n:()=>S});var e=n(28407),t=n(40215),s=n(36110),c=n(5690),O=n(54438),P=n(21626);let S=(()=>{class a{constructor(E,y){this.http=E,this.productService=y}loadBraintreeAPI(){var E=this;return(0,e.A)(function*(){return yield Promise.all([n.e(411).then(n.t.bind(n,46411,23)),E.getBraintreeClientToken()])})()}getBraintreeClientToken(){const E=this.http.get("/ws/professional/customer").pipe((0,s.T)(y=>y.client_token));return(0,t._)(E)}getBraintreePlans(){return this.http.get("/ws/professional/plan").pipe((0,s.T)(E=>E.plans))}getBraintreePlan(E,y){return this.http.get(`/ws/professional/plan?plan_id=${E}&discountcode=${y}`).pipe((0,s.T)(i=>i.plan))}getBraintreePlanSalesTax(E,y,i){return this.http.post("ws/professional/plan/salestax",{version:1,app_producttype:this.productService.productType,app_productkey:this.productService.productKey,plan_id:E,discountcode:i,billing_address_details:y}).pipe((0,s.T)(p=>p.plan))}buyProfessionalSubscription(E){return this.http.post("/ws/professional/subscribe",{version:2,app_producttype:this.productService.productType,app_productkey:this.productService.productKey,payment_method_nonce:E.nonce,device_data:E.deviceData,plan_id:E.planId,discountcode:E.discountcode,sales_tax_code:E.salesTaxCode,subscription_intent:"buy"})}updateProfessionalSubscription(E){return this.http.post("/ws/professional/subscribe",{version:2,app_producttype:this.productService.productType,app_productkey:this.productService.productKey,payment_method_nonce:E.nonce,device_data:E.deviceData,billing_address_details:E.billingAddress,subscription_intent:"update"})}cancelSubscription(){return this.http.post("/ws/professional/cancel",{})}getCardImageSrc(E){return`assets/images/credit-cards/${E}.png`}static#e=this.\u0275fac=function(y){return new(y||a)(O.KVO(P.Qq),O.KVO(c.b))};static#t=this.\u0275prov=O.jDH({token:a,factory:a.\u0275fac,providedIn:"root"})}return a})()},25382:(le,N,n)=>{"use strict";n.d(N,{h:()=>Hn});var e=n(28407),t=n(16058),s=n(66571),c=n(21424),O=n(56583),P=n(68132),S=n(16823),a=n(17365),f=n(89417),E=n(34006),y=n(35379),i=n(54438),g=n(60177),p=n(21007),h=n(26779),o=n(49206);let v=(()=>{class Le{static#e=this.\u0275fac=function(fe){return new(fe||Le)};static#t=this.\u0275cmp=i.VBU({type:Le,selectors:[["app-toggle-group-item"]],inputs:{label:"label",tooltip:"tooltip",icon:"icon",value:"value"},decls:0,vars:0,template:function(fe,Pe){},encapsulation:2,changeDetection:0})}return Le})();var d=n(65571),r=n(14823);const _=(Le,De,me,fe,Pe,We)=>({"toggle-group--theme-light":Le,"toggle-group--theme-dark":De,"toggle-group--small":me,"toggle-group--medium":fe,"toggle-group--large":Pe,"toggle-group--block":We});function u(Le,De){if(1&Le&&i.nrm(0,"app-icon",7),2&Le){const me=i.XpG().$implicit;i.Y8G("icon",me.icon)}}function l(Le,De){if(1&Le&&(i.j41(0,"span"),i.EFF(1),i.k0s()),2&Le){const me=i.XpG().$implicit;i.R7$(),i.JRh(me.label)}}function m(Le,De){if(1&Le&&(i.j41(0,"mat-button-toggle",3)(1,"div",4),i.DNE(2,u,1,1,"app-icon",5)(3,l,2,1,"span",6),i.k0s()()),2&Le){const me=De.$implicit;i.Y8G("value",me.value)("matTooltip",me.tooltip||""),i.BMQ("aria-label",me.label||""),i.R7$(2),i.Y8G("ngIf",me.icon),i.R7$(),i.Y8G("ngIf",me.label)}}let C=(()=>{class Le extends o.Z{constructor(){super(...arguments),this.theme="light",this.display="inline",this.size="medium"}static#e=this.\u0275fac=(()=>{let me;return function(Pe){return(me||(me=i.xGo(Le)))(Pe||Le)}})();static#t=this.\u0275cmp=i.VBU({type:Le,selectors:[["app-toggle-group"]],contentQueries:function(fe,Pe,We){if(1&fe&&i.wni(We,v,5),2&fe){let Ze;i.mGM(Ze=i.lsd())&&(Pe.items=Ze)}},inputs:{theme:"theme",display:"display",size:"size"},features:[i.Jv_([{provide:f.kq,useExisting:(0,i.Rfq)(()=>Le),multi:!0}]),i.Vt3],decls:3,vars:11,consts:[[1,"toggle-group",3,"ngClass"],[3,"formControl","hideSingleSelectionIndicator"],[3,"value","matTooltip",4,"ngFor","ngForOf"],[3,"value","matTooltip"],[1,"toggle-group__label"],[3,"icon",4,"ngIf"],[4,"ngIf"],[3,"icon"]],template:function(fe,Pe){1&fe&&(i.j41(0,"div",0)(1,"mat-button-toggle-group",1),i.DNE(2,m,4,5,"mat-button-toggle",2),i.k0s()()),2&fe&&(i.Y8G("ngClass",i.l4e(4,_,"light"===Pe.theme,"dark"===Pe.theme,"small"===Pe.size,"medium"===Pe.size,"large"===Pe.size,"block"===Pe.display)),i.R7$(),i.Y8G("formControl",Pe.control)("hideSingleSelectionIndicator",!0),i.R7$(),i.Y8G("ngForOf",Pe.items))},dependencies:[g.YU,g.Sq,g.bT,d.ec,d.pc,r.oV,h.R,f.BC,f.l_],styles:[".toggle-group{--mat-toggle-border-color: #d7e0ea;--mat-toggle-background-color: #131c2a;--mat-toggle-selected-background-color: #374a68;--mat-toggle-selected-color: #f9fafd;--mat-toggle-color: #61779e;--mat-toggle-font-size: 14px;--mat-toggle-line-height: 20px;--mat-toggle-padding: 12px;--mat-toggle-min-width: 32px}.toggle-group .mat-button-toggle-group-appearance-standard{border:none}.toggle-group .mat-button-toggle-group-appearance-standard.mat-button-toggle-group .mat-button-toggle{background-color:#eaeff5;color:#374a68;border:none;border-radius:0!important;padding:0}.toggle-group .mat-button-toggle-group-appearance-standard.mat-button-toggle-group .mat-button-toggle-label-content{font-weight:500;font-size:var(--mat-toggle-font-size);line-height:var(--mat-toggle-line-height);padding:var(--mat-toggle-padding);min-width:var(--mat-toggle-min-width)}.toggle-group .mat-button-toggle-group-appearance-standard.mat-button-toggle-group .mat-button-toggle:hover:not(.toggle-group .mat-button-toggle-group-appearance-standard.mat-button-toggle-group .mat-button-toggle-checked){background-color:#d7e0ea;color:#1c2a3f}.toggle-group .mat-button-toggle-group-appearance-standard.mat-button-toggle-group .mat-button-toggle:first-child{border-radius:4px 0 0 4px!important}.toggle-group .mat-button-toggle-group-appearance-standard.mat-button-toggle-group .mat-button-toggle:last-child{border-radius:0 4px 4px 0!important}.toggle-group .mat-button-toggle-group-appearance-standard.mat-button-toggle-group .mat-button-toggle:last-child .mat-button-toggle-button{border-right:none}.toggle-group .mat-button-toggle-group-appearance-standard.mat-button-toggle-group .mat-button-toggle-checked{background-color:#283853;color:#fff}.toggle-group .mat-button-toggle-group-appearance-standard.mat-button-toggle-group .mat-button-toggle .mat-button-toggle-button{border-right:1px solid #d7e0ea}.toggle-group .mat-button-toggle-group-appearance-standard.mat-button-toggle-group .mat-button-toggle .mat-button-toggle-button:focus{outline:#2d72dc solid 2px!important;outline-offset:-2px}.toggle-group__label{display:flex;flex-direction:row;align-items:center;justify-content:center;gap:8px}.toggle-group--small{--mat-toggle-font-size: 12px;--mat-toggle-line-height: 16px;--mat-toggle-padding: 6px;--mat-toggle-min-width: 28px}.toggle-group--medium{--mat-toggle-font-size: 14px;--mat-toggle-line-height: 20px;--mat-toggle-padding: 8px;--mat-toggle-min-width: 44px}.toggle-group--large{--mat-toggle-font-size: 14px;--mat-toggle-line-height: 20px;--mat-toggle-padding: 12px;--mat-toggle-min-width: 48px}.toggle-group--block .mat-button-toggle-group-appearance-standard.mat-button-toggle-group{display:flex;flex-direction:row;justify-content:space-evenly}.toggle-group--block .mat-button-toggle-group-appearance-standard.mat-button-toggle-group .mat-button-toggle{flex:1}\n"],encapsulation:2,changeDetection:0})}return Le})();n(45731);var R=n(92014),A=n(94528),G=n(85052),k=n(15877),V=n(2573),W=n(37925),T=n(87996),x=n(21082),z=n(38399),I=n(35160),D=n(17215),L=n(4951),Q=n(90265),ie=n(49204),Z=n(96557),de=n(16606),ae=n(47125),q=n(76774),K=n(13517),j=n(17766),M=n(21523),$=n(47632),ce=n(9529),re=n(45024);const ue=["*"];let H=(()=>{class Le extends ce.Ky{handleToggleClick(){this.toggle()}constructor(me,fe,Pe){super(me,fe,Pe)}static#e=this.\u0275fac=function(fe){return new(fe||Le)(i.rXU(ce.z8,12),i.rXU(i.gRc),i.rXU(re.zP))};static#t=this.\u0275cmp=i.VBU({type:Le,selectors:[["app-accordion-item"]],inputs:{title:"title"},features:[i.Vt3],ngContentSelectors:ue,decls:8,vars:9,consts:[[1,"accordion-item"],["tabindex","0",1,"accordion-item__header",3,"click"],[1,"accordion-item__title"],[1,"accordion-item__arrow",3,"icon"],[1,"accordion-item__body"]],template:function(fe,Pe){1&fe&&(i.NAR(),i.j41(0,"div",0)(1,"h3")(2,"button",1),i.bIt("click",function(){return Pe.handleToggleClick()}),i.j41(3,"span",2),i.EFF(4),i.k0s(),i.nrm(5,"app-icon",3),i.k0s()(),i.j41(6,"div",4),i.SdG(7),i.k0s()()),2&fe&&(i.AVh("accordion-item--expanded",Pe.expanded),i.R7$(2),i.BMQ("id","accordion-header-"+Pe.id)("aria-expanded",Pe.expanded)("aria-controls","accordion-body-"+Pe.id),i.R7$(2),i.JRh(Pe.title),i.R7$(),i.Y8G("icon",Pe.expanded?"chevron-down":"chevron-right"),i.R7$(),i.BMQ("id","accordion-body-"+Pe.id)("aria-labelledby","accordion-header-"+Pe.id))},dependencies:[h.R],styles:["[_nghost-%COMP%]   .accordion-item[_ngcontent-%COMP%]{border-top:1px solid #d7e0ea}[_nghost-%COMP%]:last-child   .accordion-item[_ngcontent-%COMP%]{border-bottom:1px solid #d7e0ea}.accordion-item__header[_ngcontent-%COMP%]{cursor:pointer;border:none;display:flex;align-items:center;justify-content:space-between;background:none;width:100%;padding:12px 8px}.accordion-item__header[_ngcontent-%COMP%]:hover{background-color:#eaeff5}.accordion-item__title[_ngcontent-%COMP%]{color:#374a68;font-size:.875rem;line-height:1.25rem;font-weight:500}.accordion-item__arrow[_ngcontent-%COMP%]{width:16px}.accordion-item__body[_ngcontent-%COMP%]{padding:8px 8px 32px;display:none}.accordion-item--expanded[_ngcontent-%COMP%]   .accordion-item__body[_ngcontent-%COMP%]{display:block}"],changeDetection:0})}return Le})();var te=n(28722),F=n(59115),w=n(97443),X=n(74988),oe=n(95416),Y=n(82765),he=n(5951),ne=n(93547),_e=n(37737),Ce=n(87505),Be=n(97352),Ie=function(Le,De,me,fe){var Ze,Pe=arguments.length,We=Pe<3?De:null===fe?fe=Object.getOwnPropertyDescriptor(De,me):fe;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)We=Reflect.decorate(Le,De,me,fe);else for(var it=Le.length-1;it>=0;it--)(Ze=Le[it])&&(We=(Pe<3?Ze(We):Pe>3?Ze(De,me,We):Ze(De,me))||We);return Pe>3&&We&&Object.defineProperty(De,me,We),We},Oe=function(Le,De){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(Le,De)};const Te=["publishOptionsEl"],ve=["embedAccordion"];function Ve(Le,De){if(1&Le&&(i.j41(0,"option",46),i.EFF(1),i.k0s()),2&Le){const me=De.index;i.Y8G("value",me+1),i.R7$(),i.SpI(" ",me+1," ")}}function we(Le,De){if(1&Le&&(i.j41(0,"div",72)(1,"mat-radio-group",73)(2,"mat-radio-button",74),i.EFF(3,"All questions"),i.k0s(),i.j41(4,"div",22)(5,"mat-radio-button",75),i.EFF(6,"Single question"),i.k0s(),i.j41(7,"select",76),i.DNE(8,Ve,2,2,"option",77),i.k0s()()()()),2&Le){const me=i.XpG(2);i.R7$(7),i.BMQ("aria-label","Question Number"),i.R7$(),i.Y8G("ngForOf",me.quizQuestions)}}function Je(Le,De){if(1&Le&&(i.j41(0,"app-accordion-item",66)(1,"fieldset",67)(2,"mat-checkbox",68),i.EFF(3,"Assessment Mode"),i.k0s(),i.DNE(4,we,9,2,"div",69),i.k0s(),i.j41(5,"div",70)(6,"a",71),i.EFF(7," Learn more about quizzes in assessment mode "),i.k0s()()()),2&Le){const me=i.XpG();i.Y8G("title","Quiz")("expanded",!0),i.R7$(),i.Y8G("formGroup",me.formQuiz),i.R7$(3),i.Y8G("ngIf",me.formQuiz.value.locked)}}function tt(Le,De){if(1&Le){const me=i.RV6();i.j41(0,"button",87),i.bIt("click",function(){const Pe=i.eBV(me).$implicit,We=i.XpG(2);return i.Njj(We.handleViewerSizeClick(Pe))}),i.EFF(1),i.k0s()}if(2&Le){const me=De.$implicit;i.R7$(),i.SpI(" ",me.title," ")}}function st(Le,De){1&Le&&(i.j41(0,"fieldset",88)(1,"legend",89),i.EFF(2,"Viewer Aspect Ratio"),i.k0s(),i.j41(3,"app-form-field",90),i.nrm(4,"input",91),i.j41(5,"div",92),i.EFF(6,"Width ratio"),i.k0s()(),i.j41(7,"span",93),i.EFF(8,":"),i.k0s(),i.j41(9,"app-form-field",90),i.nrm(10,"input",94),i.j41(11,"div",92),i.EFF(12,"Height ratio"),i.k0s()()()),2&Le&&(i.R7$(3),i.Y8G("isCompact",!0),i.R7$(),i.BMQ("aria-label","Width"),i.R7$(5),i.Y8G("isCompact",!0),i.R7$(),i.BMQ("aria-label","Height"))}function rt(Le,De){if(1&Le){const me=i.RV6();i.j41(0,"div")(1,"button",78,5),i.bIt("menuOpened",function(){i.eBV(me);const Pe=i.sdS(2),We=i.XpG();return i.Njj(We.handleViewerSizeMenuOpened(Pe))}),i.j41(3,"div",79)(4,"span"),i.EFF(5),i.k0s(),i.nrm(6,"app-icon",80),i.k0s()(),i.j41(7,"mat-menu",null,6),i.DNE(9,tt,2,1,"button",81),i.k0s(),i.DNE(10,st,13,4,"fieldset",82),i.j41(11,"app-alert",83)(12,"a",84),i.EFF(13,"Some websites may strip the style attributes"),i.k0s(),i.EFF(14," required for responsive Viewer sizing "),i.k0s(),i.j41(15,"div",85)(16,"a",86),i.EFF(17," Learn more about aspect ratio "),i.k0s()()()}if(2&Le){const me=i.sdS(8),fe=i.XpG();i.R7$(),i.Y8G("uppercase",!1)("matMenuTriggerFor",me),i.R7$(4),i.JRh(fe.selectedAspectRatio.title),i.R7$(4),i.Y8G("ngForOf",fe.viewerFixedSizes),i.R7$(),i.Y8G("ngIf",fe.isCustomAspectRatioSelected)}}function Ke(Le,De){if(1&Le&&(i.j41(0,"fieldset",98)(1,"app-form-field",99),i.nrm(2,"input",100),i.j41(3,"div",92),i.EFF(4),i.k0s()(),i.j41(5,"span",93),i.EFF(6,"X"),i.k0s(),i.j41(7,"app-form-field",99),i.nrm(8,"input",101),i.j41(9,"div",92),i.EFF(10),i.k0s()()()),2&Le){const me=De.ngIf;i.R7$(),i.Y8G("isCompact",!0),i.R7$(),i.Y8G("min",me.width),i.BMQ("aria-label","Width"),i.R7$(2),i.SpI("Width min. ",me.width,"px"),i.R7$(3),i.Y8G("isCompact",!0),i.R7$(),i.Y8G("min",me.height),i.BMQ("aria-label","Height"),i.R7$(2),i.SpI("Height min. ",me.height,"px")}}function et(Le,De){if(1&Le&&(i.j41(0,"div",96),i.DNE(1,Ke,11,8,"fieldset",97),i.nI1(2,"async"),i.k0s()),2&Le){const me=i.XpG(2);i.R7$(),i.Y8G("ngIf",i.bMT(2,1,me.minDimensions$))}}function ge(Le,De){if(1&Le&&(i.j41(0,"div"),i.DNE(1,et,3,3,"div",95),i.nI1(2,"async"),i.k0s()),2&Le){const me=i.XpG();i.R7$(),i.Y8G("ngIf",i.bMT(2,1,me.dimensions$))}}function Ee(Le,De){1&Le&&(i.j41(0,"div",102)(1,"app-form-field",103),i.nrm(2,"input",104),i.k0s()()),2&Le&&(i.R7$(),i.Y8G("isCompact",!0),i.R7$(),i.BMQ("aria-label","Degree of Rotation"))}function Fe(Le,De){1&Le&&(i.j41(0,"div",105)(1,"mat-checkbox",106),i.EFF(2,' Show "info icon" for description '),i.k0s(),i.j41(3,"mat-checkbox",107),i.EFF(4,' Show "audio icon" for pronunciations '),i.k0s()())}function $e(Le,De){1&Le&&(i.j41(0,"div",105)(1,"mat-checkbox",108),i.EFF(2,"Show label list in Information Panel"),i.k0s()())}function ot(Le,De){1&Le&&(i.j41(0,"li")(1,"mat-checkbox",111),i.EFF(2,"Anatomy layers"),i.k0s()())}function je(Le,De){1&Le&&(i.j41(0,"li")(1,"mat-checkbox",112),i.EFF(2,"Skin selector"),i.k0s()())}function xe(Le,De){if(1&Le&&(i.j41(0,"li")(1,"mat-checkbox",109),i.EFF(2,"Customize appearance"),i.k0s(),i.j41(3,"ul",110),i.DNE(4,ot,3,0,"li",51)(5,je,3,0,"li",51),i.k0s()()),2&Le){const me=i.XpG();i.R7$(),i.Y8G("formControl",me.uiLayersEnabled)("indeterminate",me.uiLayersIndeterminate),i.R7$(3),i.Y8G("ngIf",me.hasVisibilityLayers()),i.R7$(),i.Y8G("ngIf",me.hasSkinLayers())}}function Me(Le,De){if(1&Le){const me=i.RV6();i.j41(0,"button",113),i.bIt("click",function(){i.eBV(me);const Pe=i.XpG();return i.Njj(Pe.handleEmbedClick())}),i.EFF(1," Reset to Default "),i.k0s()}}function Ue(Le,De){1&Le&&(i.j41(0,"p",118),i.EFF(1," Make this model available to anyone by publishing it to the web. "),i.k0s())}function Ne(Le,De){1&Le&&(i.j41(0,"p",118),i.EFF(1," Your content has been saved to "),i.j41(2,"strong",119),i.EFF(3,"My Library > Private."),i.k0s(),i.nrm(4,"br"),i.EFF(5," Share a direct link or copy the embed code to use on your website. "),i.k0s())}function Xe(Le,De){if(1&Le){const me=i.RV6();i.j41(0,"div"),i.DNE(1,Ue,2,0,"p",114)(2,Ne,6,0,"p",114),i.j41(3,"div",115)(4,"button",116),i.bIt("click",function(){i.eBV(me);const Pe=i.XpG();return i.Njj(Pe.handleGenerateIFrame())}),i.EFF(5," Copy embed code "),i.k0s(),i.j41(6,"button",117),i.bIt("click",function(){i.eBV(me);const Pe=i.XpG();return i.Njj(Pe.handleGenerateURL())}),i.EFF(7," Copy link "),i.k0s()()()}if(2&Le){const me=i.XpG();i.R7$(),i.Y8G("ngIf",me.model.id===me.modelToPublish.id),i.R7$(),i.Y8G("ngIf",me.model.id!==me.modelToPublish.id),i.R7$(2),i.Y8G("disabled",!me.formEmbed.valid),i.R7$(2),i.Y8G("disabled",!me.formEmbed.valid)}}function be(Le,De){1&Le&&(i.j41(0,"p",123),i.EFF(1," Save this model to "),i.j41(2,"strong",119),i.EFF(3,"My Library"),i.k0s(),i.EFF(4," to make it available for anyone, by publishing it to the web. "),i.k0s())}function ke(Le,De){1&Le&&(i.j41(0,"p",123),i.EFF(1," You can manage this saved model at anytime in "),i.nrm(2,"br"),i.j41(3,"strong",119),i.EFF(4,"My Library > Private > All Models."),i.k0s()())}function Re(Le,De){1&Le&&i.nrm(0,"app-spinner",124)}function dt(Le,De){if(1&Le){const me=i.RV6();i.DNE(0,be,5,0,"p",120),i.nI1(1,"async"),i.DNE(2,ke,5,0,"p",120),i.nI1(3,"async"),i.j41(4,"div",115)(5,"button",121),i.nI1(6,"async"),i.bIt("click",function(){i.eBV(me);const Pe=i.XpG();return i.Njj(Pe.handleSaveClick())}),i.EFF(7),i.nI1(8,"async"),i.DNE(9,Re,1,0,"app-spinner",122),i.nI1(10,"async"),i.k0s()()}if(2&Le){const me=i.XpG();i.Y8G("ngIf",!1===i.bMT(1,5,me.copying$)),i.R7$(2),i.Y8G("ngIf",!0===i.bMT(3,7,me.copying$)),i.R7$(3),i.Y8G("disabled",i.bMT(6,9,me.copying$)),i.R7$(2),i.SpI(" ",!0===i.bMT(8,11,me.copying$)?"Saving to My Library":"Save & Publish"," "),i.R7$(2),i.Y8G("ngIf",i.bMT(10,13,me.copying$))}}class yt{get accordionExpanded(){return!!this.accordionItems&&this.accordionItems.toArray().every(De=>De.expanded)}get rotateEnabled(){return this.formEmbed.get("rotate").value.enabled}get viewerSizeType(){return this.formEmbed.value.viewerSizeType}get widgetOptionsValues(){return this.widgetOptionsGroup.value}get isCustomAspectRatioSelected(){return this.selectedAspectRatio.title===X.Dx.title}constructor(De,me,fe,Pe,We,Ze,it,ht,_t,pt,ut){this.store=De,this.actions=me,this.publishService=fe,this.storageService=Pe,this.clipboardService=We,this.dialogService=Ze,this.storyService=it,this.snackBar=ht,this.formBuilder=_t,this.changeDetectorRef=pt,this.renderer2=ut,this.mediaEnum=te.Y,this.viewerSizeTypeEnum=w.M,this.viewerFixedSizes=[...X.Bg,X.Dx],this.selectedAspectRatio=X.Q2,this.quizQuestions=[],this.submit=new G.B,this.requiresSave=!1,this.defaultEmbedFormValues=this.getEmbedFormDefaults(),this.ngUnsubscribe=new G.B,this.defaultWidgetOptions={...new O.$,loadRotate:10},this.initEmbedForm()}ngOnInit(){this.model.type===j.c.Module&&(0,ie.isNil)(this.model.module_accessor_level)&&(this.requiresSave=!0),this.initQuizForm(),this.initQuizFormListeners(),this.initActionListeners(),this.setupEmbedForm(),this.initCopy(),this.store.dispatch(new A.id(!0))}ngOnDestroy(){this.store.dispatch(new A.id(!1)),this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initCopy(){this.actions.pipe((0,R.xi)($.lN),(0,W.Q)(this.ngUnsubscribe)).subscribe(De=>this.handleCopySuccess(De)),this.actions.pipe((0,R.xi)($.Cr),(0,W.Q)(this.ngUnsubscribe)).subscribe(()=>this.handleCopyFailure()),this.submit.pipe((0,T.B)(100),(0,W.Q)(this.ngUnsubscribe)).subscribe(()=>this.onDebouncedSubmit()),this.modelToPublish=this.model}initEmbedForm(){const De=this.getWidgetOptions(),me=this.store.selectSnapshot(P.F.getDimensions),fe=this.store.selectSnapshot(P.F.getAspectRatio),Pe=this.store.selectSnapshot(P.F.getMinDimensions),{button:We,handHint:Ze,play:it,summary:ht}=De.initial,{alert:_t,overlay:pt}=De.disableScroll;this.formEmbed=this.formBuilder.group({viewerSizeType:this.formBuilder.control(w.M.Responsive),dimensions:this.formBuilder.group({width:[me.width,[f.k0.min(Pe.width)]],height:[me.height,[f.k0.min(Pe.height)]]}),aspectRatio:this.formBuilder.group({width:[fe.width,[f.k0.min(1)]],height:[fe.height,[f.k0.min(1)]]}),options:this.formBuilder.group(De),loader:this.formBuilder.group({enabled:De.uiLoader!==Z.aD.None,mode:De.uiLoader}),rotate:this.formBuilder.group({enabled:null!==De.loadRotate,value:De.loadRotate}),autoLoad:this.formBuilder.control(De.autoLoad),playthrough:this.formBuilder.control(De.playthrough),initial:this.formBuilder.group({enabled:De.autoLoad&&(We||Ze||it||ht),mode:We?"button":Ze?"handHint":it?"play":ht?"summary":""}),disableScroll:this.formBuilder.group({enabled:_t||pt,mode:_t?"alert":pt?"overlay":""})}),this.uiLayersEnabled=new f.MJ(De.uiSkinLayers||De.uiVisibilityLayers),this.widgetOptionsGroup=this.formEmbed.get("options"),JSON.stringify(this.defaultEmbedFormValues)!==JSON.stringify(this.formEmbed.value)&&this.formEmbed.markAsDirty(),this.widgetEmbedSettings=this.getEmbedPublishOptions(),this.changeDetectorRef.markForCheck()}initQuizForm(){if(this.formQuiz=this.formBuilder.group({locked:[!1],options:this.formBuilder.group({mode:["all"],number:[1]})}),(this.model.tags||[]).includes(K.x.Quiz)){const{id:fe,type:Pe}=this.model;this.storyService.getStory(fe,Pe).pipe((0,W.Q)(this.ngUnsubscribe)).subscribe(We=>{this.quizQuestions=(0,q.En)(We.chapters),this.changeDetectorRef.markForCheck()})}}initQuizFormListeners(){const De=this.formEmbed.get("options"),me=this.formQuiz.get("locked"),fe=this.formQuiz.get("options"),Pe=fe.get("mode"),We=fe.get("number");this.formQuiz.valueChanges.pipe((0,W.Q)(this.ngUnsubscribe)).subscribe(Ze=>{let it,ht;const{locked:_t,options:pt}=Ze;if(_t){const{mode:ut,number:mt}=pt;it=ae.R.Locked,ht="single"===ut?mt:void 0}De.patchValue({uiQuiz:{mode:it,number:ht}})}),me.valueChanges.pipe((0,W.Q)(this.ngUnsubscribe)).subscribe(Ze=>{Ze?fe.enable():fe.disable()}),We.valueChanges.pipe((0,x.F)(),(0,W.Q)(this.ngUnsubscribe)).subscribe(()=>{!0===me.value&&"single"!==Pe.value&&Pe.setValue("single")}),me.setValue(!1)}initActionListeners(){this.actions.pipe((0,R.xi)(A.M),(0,z.q)(De=>this.copyToClipboard(De.url,"url")),(0,W.Q)(this.ngUnsubscribe)).subscribe(De=>{this.snackBar.open(De?"Successfully copied link to clipboard.":"Unable to copy link to clipboard.")}),this.actions.pipe((0,R.xi)(A.LD),(0,z.q)(De=>this.copyToClipboard(De.embed,"embed")),(0,W.Q)(this.ngUnsubscribe)).subscribe(De=>{this.snackBar.open(De?"Successfully copied embed code to clipboard.":"Unable to copy embed code to clipboard.")}),this.actions.pipe((0,R.xi)(A._T),(0,W.Q)(this.ngUnsubscribe)).subscribe(()=>{this.snackBar.open("Unable to generate embed code.")})}setupEmbedForm(){const De=this.formEmbed.get("options"),me=this.formEmbed.get("dimensions"),fe=this.formEmbed.get("loader"),Pe=this.formEmbed.get("rotate"),We=this.formEmbed.get("initial"),Ze=this.formEmbed.get("disableScroll"),it=De.get("uiMenu"),ht=this.formEmbed.get("autoLoad"),_t=this.formEmbed.get("playthrough"),pt=fe.get("enabled"),ut=fe.get("mode");pt.valueChanges.pipe((0,W.Q)(this.ngUnsubscribe)).subscribe(qe=>{ut.patchValue(qe?Z.ij:Z.aD.None)}),ut.valueChanges.pipe((0,W.Q)(this.ngUnsubscribe)).subscribe(qe=>{De.patchValue({uiLoader:qe}),qe!==Z.aD.None&&pt.patchValue(!0,{emitEvent:!1})});const mt=Pe.get("enabled"),ft=Pe.get("value");mt.valueChanges.pipe((0,W.Q)(this.ngUnsubscribe)).subscribe(qe=>{qe?ft.patchValue("number"==typeof ft.value?ft.value:this.defaultWidgetOptions.loadRotate):De.patchValue({loadRotate:null})}),ft.valueChanges.pipe((0,W.Q)(this.ngUnsubscribe)).subscribe(qe=>{De.patchValue({loadRotate:qe})}),ht.valueChanges.pipe((0,W.Q)(this.ngUnsubscribe)).subscribe(qe=>{De.patchValue({autoLoad:qe})}),_t.valueChanges.pipe((0,W.Q)(this.ngUnsubscribe)).subscribe(qe=>{De.patchValue({playthrough:qe})}),We.get("enabled").valueChanges.pipe((0,W.Q)(this.ngUnsubscribe)).subscribe(qe=>{We.patchValue({mode:qe?"button":""})}),We.get("mode").valueChanges.pipe((0,W.Q)(this.ngUnsubscribe)).subscribe(qe=>{We.patchValue({enabled:!!qe},{emitEvent:!1}),De.patchValue({initial:{button:"button"===qe,handHint:"handHint"===qe,play:"play"===qe,summary:"summary"===qe}})}),Ze.get("enabled").valueChanges.pipe((0,W.Q)(this.ngUnsubscribe)).subscribe(qe=>{Ze.patchValue({mode:qe?"alert":""})}),Ze.get("mode").valueChanges.pipe((0,W.Q)(this.ngUnsubscribe)).subscribe(qe=>{Ze.patchValue({enabled:!!qe},{emitEvent:!1}),De.patchValue({disableScroll:{alert:"alert"===qe,overlay:"overlay"===qe}})}),me.valueChanges.pipe((0,T.B)(300),(0,W.Q)(this.ngUnsubscribe)).subscribe(qe=>{this.setScreenDimensions(qe)}),this.dimensions$.pipe((0,W.Q)(this.ngUnsubscribe)).subscribe(qe=>{me.setValue(qe,{emitEvent:!1})}),De.valueChanges.pipe((0,W.Q)(this.ngUnsubscribe)).subscribe(qe=>{this.writeEmbedOptions(qe)}),De.valueChanges.pipe((0,I.Z)(De.value),(0,x.F)((qe,Pt)=>(0,ie.isEqual)(qe,Pt)),(0,W.Q)(this.ngUnsubscribe)).subscribe(qe=>{const{uiMenu:Pt,uiTools:Yt,uiSearch:kn,uiVisibilityLayers:Cn,uiSkinLayers:On,uiWhiteboard:zs,uiHelp:xn}=qe,Pn=[Yt,kn,zs,xn],Mn=[On,Cn];this.hasVisibilityLayers()&&Pn.push(Cn),this.hasSkinLayers()&&Pn.push(On);const $s=Pn.length,nn=Pn.filter(Jt=>Jt).length,Qn=nn>0&&nn!==$s;0===nn&&Pt&&it.setValue(!1,{emitEvent:!1}),Qn&&!Pt&&it.setValue(!0,{emitEvent:!1}),this.uiMenuIndeterminate=Qn;const Tn=Mn.some(Jt=>Jt),Yn=Mn.every(Jt=>Jt);this.uiLayersEnabled.setValue(Tn,{emitEvent:!1}),this.uiLayersIndeterminate=Tn&&!Yn,this.changeDetectorRef.markForCheck()}),this.uiLayersEnabled.valueChanges.pipe((0,W.Q)(this.ngUnsubscribe)).subscribe(qe=>{De.patchValue({uiVisibilityLayers:qe,uiSkinLayers:qe})}),it.valueChanges.pipe((0,W.Q)(this.ngUnsubscribe)).subscribe(qe=>{De.patchValue({uiTools:qe,uiSearch:qe,uiVisibilityLayers:qe,uiSkinLayers:qe,uiWhiteboard:qe,uiHelp:qe})}),this.formEmbed.valueChanges.pipe((0,T.B)(100),(0,x.F)((qe,Pt)=>(0,ie.isEqual)(qe,Pt)),(0,W.Q)(this.ngUnsubscribe)).subscribe(()=>{this.widgetEmbedSettings=this.getEmbedPublishOptions(),this.changeDetectorRef.markForCheck()})}handleGenerateIFrame(){this.generateIFrameCode()}handleGenerateURL(){this.generateURL()}handleEmbedClick(){this.setEmbedFormDefaults()}handleHideAllEmbedUIClick(){const me={...this.formEmbed.value.options,uiAnatomyLabels:!1,uiInfo:!1,uiAudio:!1,uiMedia:te.Y.None,uiNav:!1,uiTools:!1,uiUndo:!1,uiMenu:!1,uiSearch:!1,uiVisibilityLayers:!1,uiSkinLayers:!1,uiWhiteboard:!1,uiFullscreen:!1,uiHelp:!1};this.formEmbed.patchValue({options:me}),this.formEmbed.markAsDirty()}handleViewerSizeMenuOpened(De){const me=this.publishOptionsEl.nativeElement,{offsetWidth:fe,clientWidth:Pe}=me,Ze=Pe-(fe-Pe),it=document.querySelector(`#${De.menu.panelId}`);this.renderer2.setStyle(it,"width",`${Ze}px`),this.renderer2.setStyle(it,"max-width","100vw")}handleToggleAccordionClick(){this.accordionExpanded?this.embedAccordion.closeAll():this.embedAccordion.openAll()}handleViewerSizeClick(De){this.selectedAspectRatio={...De},this.formEmbed.patchValue({aspectRatio:{width:De.dimensions.width,height:De.dimensions.height}})}handleSaveClick(){this.submit.next()}hasVisibilityLayers(){return this.publishWidget.allVisibilityLayers.some(De=>Array.isArray(De)&&De.length>0)}hasSkinLayers(){return!(0,ie.isEmpty)(this.publishWidget.variantSchemas.skin)}setScreenDimensions(De){this.store.dispatch(new A.LI(De))}generateIFrameCode(){const{options:De,dimensions:me}=this.getEmbedPublishOptions();this.store.dispatch(new A.kS(this.modelToPublish,De,null,me))}generateURL(){this.store.dispatch(new A.D4(this.modelToPublish,this.formEmbed.value.options))}handleCopySuccess(De){this.snackBar.open(`"${De.bookmark.title}" saved to your library.`),this.requiresSave=!1,this.modelToPublish=De.bookmark}handleCopyFailure(){this.snackBar.open("There was an error adding to your library")}copyToClipboard(De,me){return this.clipboardService.copyToClipboard(De,me).pipe((0,z.q)(fe=>(0,k.of)(fe)))}onDebouncedSubmit(){const De=this.model,me={isOwner:!0,id:De?De.id:null,title:De.title},fe=this.store.selectSnapshot(S.k.getUserLanguage);this.store.dispatch(new $.eW(me.id,me.title,De.type,fe))}setEmbedFormDefaults(){this.formEmbed.reset(this.defaultEmbedFormValues),this.formEmbed.markAsPristine(),this.changeDetectorRef.markForCheck()}getEmbedFormDefaults(){const De=new O.$,{dimensions:me,aspectRatio:fe}=P.f,{button:Pe,handHint:We,play:Ze,summary:it}=De.initial,{alert:ht,overlay:_t}=De.disableScroll;return{viewerSizeType:w.M.Responsive,dimensions:{width:me.width,height:me.height},aspectRatio:{width:fe.width,height:fe.height},options:De,loader:{enabled:De.uiLoader!==Z.aD.None,mode:De.uiLoader},rotate:{enabled:null!==De.loadRotate,value:De.loadRotate},autoLoad:De.autoLoad,playthrough:De.playthrough,initial:{enabled:De.autoLoad&&(Pe||We||Ze||it),mode:Pe?"button":We?"handHint":Ze?"play":it?"summary":""},disableScroll:{enabled:ht||_t,mode:ht?"alert":_t?"overlay":""}}}getWidgetOptions(){const De=this.readEmbedOptions(),me=this.store.selectSnapshot(c.q.getWidgetOptions);return De?{...this.publishService.extendWidgetOptions(new O.$,De),background:me?me.background:null,uiAudio:this.defaultWidgetOptions.uiAudio}:me||new O.$}readEmbedOptions(){!function se(Le,De){const me=localStorage.getItem(D.UT.WidgetOptions);if(null===me)return;const fe=JSON.parse(me);if(void 0!==fe[Le]&&(fe[Le].timestamp||0)<De){delete fe[Le];try{localStorage.setItem(D.UT.WidgetOptions,JSON.stringify(fe))}catch{}}}(this.getStorageKey(),1573675067505);const fe=this.storageService.getLocalJSON(D.UT.WidgetOptions);return fe?fe[this.getStorageKey()]:null}writeEmbedOptions(De){const me={...De};delete me.uiQuiz;const fe={...me,timestamp:Date.now()},Pe=this.storageService.getLocalJSON(D.UT.WidgetOptions)||{};Pe[this.getStorageKey()]=fe,this.storageService.setLocalItem(D.UT.WidgetOptions,Pe)}getStorageKey(){return this.store.selectSnapshot(S.k.getUserProfile).eid}getEmbedPublishOptions(){let De;const me=this.formEmbed.get("viewerSizeType").value;De=this.formEmbed.get(me===w.M.Fixed?"dimensions":"aspectRatio");const fe=this.formEmbed.value.options||{};return{dimensions:{width:De.get("width").value,height:De.get("height").value,type:me},labelsEnabled:!0,labelScale:1,scalable:!0,backgroundColor:null,options:fe}}static#e=this.\u0275fac=function(me){return new(me||yt)(i.rXU(R.il),i.rXU(R.En),i.rXU(t.D),i.rXU(D.n$),i.rXU(L.W),i.rXU(s.o),i.rXU(de.J),i.rXU(oe.UG),i.rXU(f.ze),i.rXU(i.gRc),i.rXU(i.sFG))};static#t=this.\u0275cmp=i.VBU({type:yt,selectors:[["app-publish"]],viewQuery:function(me,fe){if(1&me&&(i.GBs(Q.B,7),i.GBs(Te,5),i.GBs(ve,5,ce.z8),i.GBs(H,5),i.GBs(F.kk,5)),2&me){let Pe;i.mGM(Pe=i.lsd())&&(fe.publishWidget=Pe.first),i.mGM(Pe=i.lsd())&&(fe.publishOptionsEl=Pe.first),i.mGM(Pe=i.lsd())&&(fe.embedAccordion=Pe.first),i.mGM(Pe=i.lsd())&&(fe.accordionItems=Pe),i.mGM(Pe=i.lsd())&&(fe.items=Pe)}},inputs:{model:"model",device:"device"},decls:112,vars:42,consts:[["publishOptionsEl",""],["embedAccordion","cdkAccordion"],["rotate",""],["saveTemplate",""],["publishWidget",""],["trigger","matMenuTrigger"],["viewerSizes","matMenu"],[1,"publish","theme-light"],[1,"flex","justify-end","mb-3","publish__mode"],["type","button","app-button","","buttonSize","sm","buttonType","text","buttonTheme","light","buttonAlign","left","data-test","publishAccordionButton",1,"text-xs",3,"click","uppercase"],[1,"ml-2",3,"icon"],["data-test","publishOptions",1,"text-xs","publish__options",3,"formGroup"],[3,"multi"],[3,"title","expanded",4,"ngIf"],[3,"title"],[1,"publish__flex-group"],["formControlName","viewerSizeType",1,"flex","flex-row","w-full"],[1,"flex-auto",3,"value"],[1,"flex-auto","mr-2",3,"value"],[1,"mt-2",3,"ngSwitch"],[4,"ngSwitchCase"],[1,"publish__input-group"],[1,"flex","items-center"],["formControlName","autoLoad"],["icon","info-circle","matTooltip","If you uncheck this, your 3D model won't load automatically, but page load time will improve.",1,"ml-2","publish__info-icon"],["formGroupName","rotate",1,"publish__input-group"],["formControlName","enabled"],["class","mb-3 ml-6",4,"ngIf"],["formGroupName","options"],["formControlName","uiTutorial"],["formGroupName","initial",1,"mt-2"],["label","3d Interaction Prompt","theme","light","display","block",3,"isCompact"],["formControlName","mode",1,"input"],["value","button",1,"my-1"],["value","handHint",1,"my-1"],["value","play",1,"my-1"],["value","summary",1,"my-1"],["value","",1,"my-1"],["formGroupName","options",1,"publish__input-group"],["formControlName","uiAnatomyLabels"],["class","ml-6",4,"ngIf"],["formControlName","uiInfo"],["formControlName","uiAudio"],[1,"mt-2"],["label","ANIMATION CONTROLS","theme","light","display","block",3,"isCompact"],["formControlName","uiMedia",1,"mt-1","input"],[3,"value"],["formGroupName","options",1,"flex","flex-col","gap-5"],["label","Upper Left","theme","light","display","block",3,"uppercase","labelElement","isCompact"],["formControlName","uiTools"],["formControlName","uiSearch"],[4,"ngIf"],["formControlName","uiWhiteboard"],["formControlName","uiHelp"],["formControlName","uiUndo"],["label","Bottom right","theme","light","display","block",3,"uppercase","labelElement","isCompact"],["formControlName","uiNav"],["formControlName","uiFullscreen"],[1,"px-2","py-6"],["type","button","app-button","","buttonType","outline","buttonTheme","light",1,"w-full",3,"click"],["type","button","class","w-full mt-3","app-button","","buttonType","outline","buttonTheme","light","data-test","publishResetEmbed",3,"click",4,"ngIf"],["href","https://support.biodigital.com/hc/en-us/articles/225773768-Publish-a-3D-model","target","_blank",1,"underline","text-link"],["data-test","publishActions",1,"publish__actions"],[4,"ngIf","ngIfElse"],[1,"publish__embed"],["theme","light",3,"device","model","options"],[3,"title","expanded"],[3,"formGroup"],["formControlName","locked","data-test","quizLocked"],["class","mt-2 ml-6","formGroupName","options","data-test","quizOptions",4,"ngIf"],[1,"mt-5"],["href","https://support.biodigital.com/hc/en-us/articles/6204568025495-View-Modes-for-3D-quizzes#h_01FR8MPPCA3WTZRHVV17H5AYRF","target","_blank",1,"underline","text-link"],["formGroupName","options","data-test","quizOptions",1,"mt-2","ml-6"],["formControlName","mode",1,"flex","flex-col"],["value","all","data-test","quizOptionsAll"],["value","single","data-test","quizOptionsSingle"],["formControlName","number","data-test","quizOptionsNumber",1,"w-1/3","ml-3","input"],[3,"value",4,"ngFor","ngForOf"],["app-button","","buttonType","outline","buttonTheme","light","buttonAlign","left",1,"w-full","mt-1",3,"menuOpened","uppercase","matMenuTriggerFor"],[1,"flex","flex-row","justify-between"],["icon","caret-down",1,"ml-1"],["mat-menu-item","",3,"click",4,"ngFor","ngForOf"],["class","items-baseline justify-between mt-3 publish__flex-group","formGroupName","aspectRatio",4,"ngIf"],["type","info","theme","light",1,"flex","mt-4"],["href","https://support.biodigital.com/hc/en-us/articles/9838935675287#h_01GTZYQ3XJY31JH00F5A8C7H4K","target","_blank",1,"underline","text-link"],[1,"pt-4"],["href","https://support.biodigital.com/hc/en-us/articles/9838935675287","target","_blank",1,"underline","text-link"],["mat-menu-item","",3,"click"],["formGroupName","aspectRatio",1,"items-baseline","justify-between","mt-3","publish__flex-group"],[1,"sr-only"],["theme","light","display","block",1,"flex-auto",3,"isCompact"],["type","number","formControlName","width","min","1","appAutoFocus","",1,"w-full","publish__input","input"],["form-field-help",""],[1,"mx-4","text-sm"],["type","number","formControlName","height","min","1",1,"w-full","publish__input","input"],["formGroupName","dimensions","label","Size",4,"ngIf"],["formGroupName","dimensions","label","Size"],["class","items-baseline justify-between publish__flex-group",4,"ngIf"],[1,"items-baseline","justify-between","publish__flex-group"],["theme","light","display","block",1,"w-1/2",3,"isCompact"],["type","number","formControlName","width",1,"w-full","publish__input","input",3,"min"],["type","number","formControlName","height",1,"w-full","publish__input","input",3,"min"],[1,"mb-3","ml-6"],["label","Degree of Rotation","theme","light",3,"isCompact"],["type","number","formControlName","value",1,"w-1/2","publish__input","input"],[1,"ml-6"],["formControlName","uiAnatomyDescriptions"],["formControlName","uiAnatomyPronunciations"],["formControlName","uiLabelList"],[3,"formControl","indeterminate"],[1,"ml-6","publish__input-group"],["formControlName","uiVisibilityLayers"],["formControlName","uiSkinLayers"],["type","button","app-button","","buttonType","outline","buttonTheme","light","data-test","publishResetEmbed",1,"w-full","mt-3",3,"click"],["class","py-2 mt-2 mb-2 text-xs",4,"ngIf"],[1,"publish__actions-content"],["app-button","","buttonType","primary","buttonTheme","light","data-test","copyEmbed3D",1,"w-full",3,"click","disabled"],["app-button","","buttonType","outline","buttonTheme","light","data-test","copyURL3D",1,"w-full",3,"click","disabled"],[1,"py-2","mt-2","mb-2","text-xs"],[1,"font-semibold"],["class","p-2 mt-2 mb-2 text-xs font-light",4,"ngIf"],["app-button","","buttonType","primary","buttonTheme","light","data-test","saveToMyLibrary",1,"w-full",3,"click","disabled"],["size","medium","class","ml-2","render","inline",4,"ngIf"],[1,"p-2","mt-2","mb-2","text-xs","font-light"],["size","medium","render","inline",1,"ml-2"]],template:function(me,fe){if(1&me){const Pe=i.RV6();i.j41(0,"div",7)(1,"div",8)(2,"button",9),i.bIt("click",function(){return i.eBV(Pe),i.Njj(fe.handleToggleAccordionClick())}),i.EFF(3),i.nrm(4,"app-icon",10),i.k0s()(),i.j41(5,"div",11,0)(7,"cdk-accordion",12,1),i.DNE(9,Je,8,4,"app-accordion-item",13),i.j41(10,"app-accordion-item",14)(11,"div",15)(12,"mat-radio-group",16)(13,"mat-radio-button",17),i.EFF(14,"Responsive"),i.k0s(),i.j41(15,"mat-radio-button",18),i.EFF(16,"Fixed"),i.k0s()()(),i.j41(17,"div",19),i.DNE(18,rt,18,5,"div",20)(19,ge,3,3,"div",20),i.k0s()(),i.j41(20,"app-accordion-item",14)(21,"fieldset",21)(22,"div",22)(23,"mat-checkbox",23),i.EFF(24,"Load 3D model automatically"),i.k0s(),i.nrm(25,"app-icon",24),i.k0s(),i.j41(26,"div",25)(27,"mat-checkbox",26,2),i.EFF(29,"Rotate 3D model on load"),i.k0s(),i.DNE(30,Ee,3,2,"div",27),i.k0s(),i.j41(31,"div",28)(32,"mat-checkbox",29),i.EFF(33,"Launch tutorial on load"),i.k0s()(),i.j41(34,"div",30)(35,"app-form-field",31)(36,"select",32)(37,"option",33),i.EFF(38,"Show button"),i.k0s(),i.j41(39,"option",34),i.EFF(40,"Show animated hand"),i.k0s(),i.j41(41,"option",35),i.EFF(42,"Show play button"),i.k0s(),i.j41(43,"option",36),i.EFF(44,"Show summary"),i.k0s(),i.j41(45,"option",37),i.EFF(46,"Do not show prompt"),i.k0s()()()()()(),i.j41(47,"app-accordion-item",14)(48,"fieldset",38)(49,"mat-checkbox",39),i.EFF(50,"Show label when anatomy is selected"),i.k0s(),i.DNE(51,Fe,5,0,"div",40),i.k0s()(),i.j41(52,"app-accordion-item",14)(53,"fieldset",38)(54,"mat-checkbox",41),i.EFF(55,"Show Information Panel"),i.k0s(),i.DNE(56,$e,3,0,"div",40),i.k0s()(),i.j41(57,"app-accordion-item",14)(58,"fieldset",38)(59,"mat-checkbox",42),i.EFF(60,"Show audio controls when available"),i.k0s(),i.j41(61,"div",43)(62,"app-form-field",44)(63,"select",45)(64,"option",46),i.EFF(65,"Show all (play/pause button & scrubber)"),i.k0s(),i.j41(66,"option",46),i.EFF(67,"Only show play/pause button"),i.k0s(),i.j41(68,"option",46),i.EFF(69,"Do not show"),i.k0s()()()()()(),i.j41(70,"app-accordion-item",14)(71,"fieldset",47)(72,"app-form-field",48)(73,"ul",21)(74,"li")(75,"mat-checkbox",49),i.EFF(76,"Selection tools (select, hide, fade)"),i.k0s()(),i.j41(77,"li")(78,"mat-checkbox",50),i.EFF(79,"Anatomy search"),i.k0s()(),i.DNE(80,xe,6,4,"li",51),i.j41(81,"li")(82,"mat-checkbox",52),i.EFF(83,"Draw"),i.k0s()(),i.j41(84,"li")(85,"mat-checkbox",53),i.EFF(86,"Help"),i.k0s()(),i.j41(87,"li")(88,"mat-checkbox",54),i.EFF(89,"Undo, redo, reset"),i.k0s()()()(),i.j41(90,"app-form-field",55)(91,"ul",21)(92,"li")(93,"mat-checkbox",56),i.EFF(94,"3D navigation controls"),i.k0s()(),i.j41(95,"li")(96,"mat-checkbox",57),i.EFF(97,"Fullscreen"),i.k0s()()()()()()(),i.j41(98,"div",58)(99,"button",59),i.bIt("click",function(){return i.eBV(Pe),i.Njj(fe.handleHideAllEmbedUIClick())}),i.EFF(100," Hide All UI "),i.k0s(),i.DNE(101,Me,2,0,"button",60),i.k0s(),i.j41(102,"div",58)(103,"a",61),i.EFF(104," Learn about publishing 3D Embeds "),i.k0s()()(),i.j41(105,"div",62),i.DNE(106,Xe,8,4,"div",63)(107,dt,11,15,"ng-template",null,3,i.C5r),i.k0s(),i.j41(109,"div",64),i.nrm(110,"app-embed-viewer",65,4),i.k0s()()}if(2&me){const Pe=i.sdS(8),We=i.sdS(28),Ze=i.sdS(108);i.R7$(2),i.Y8G("uppercase",!1),i.BMQ("aria-controls",Pe.id)("aria-expanded",fe.accordionExpanded),i.R7$(),i.SpI(" ",fe.accordionExpanded?"Collapse all":"Expand all"," "),i.R7$(),i.Y8G("icon",fe.accordionExpanded?"minus-square":"plus-square"),i.R7$(),i.Y8G("formGroup",fe.formEmbed),i.R7$(2),i.Y8G("multi",!0),i.BMQ("id",Pe.id),i.R7$(2),i.Y8G("ngIf",fe.quizQuestions.length>0),i.R7$(),i.Y8G("title","Viewer Size"),i.R7$(2),i.BMQ("aria-label","Image Size"),i.R7$(),i.Y8G("value",fe.viewerSizeTypeEnum.Responsive),i.R7$(2),i.Y8G("value",fe.viewerSizeTypeEnum.Fixed),i.R7$(2),i.Y8G("ngSwitch",fe.viewerSizeType),i.R7$(),i.Y8G("ngSwitchCase",fe.viewerSizeTypeEnum.Responsive),i.R7$(),i.Y8G("ngSwitchCase",fe.viewerSizeTypeEnum.Fixed),i.R7$(),i.Y8G("title","Loading Experience"),i.R7$(10),i.Y8G("ngIf",We.checked),i.R7$(5),i.Y8G("isCompact",!0),i.R7$(12),i.Y8G("title","Anatomy Labels"),i.R7$(4),i.Y8G("ngIf",fe.widgetOptionsValues.uiAnatomyLabels),i.R7$(),i.Y8G("title","Information Panel"),i.R7$(4),i.Y8G("ngIf",fe.widgetOptionsValues.uiInfo),i.R7$(),i.Y8G("title","Media Controls"),i.R7$(5),i.Y8G("isCompact",!0),i.R7$(2),i.Y8G("value",fe.mediaEnum.Full),i.R7$(2),i.Y8G("value",fe.mediaEnum.Small),i.R7$(2),i.Y8G("value",fe.mediaEnum.None),i.R7$(2),i.Y8G("title","Tools"),i.R7$(2),i.Y8G("uppercase",!0)("labelElement",!1)("isCompact",!0),i.R7$(8),i.Y8G("ngIf",fe.hasVisibilityLayers()||fe.hasSkinLayers()),i.R7$(10),i.Y8G("uppercase",!0)("labelElement",!1)("isCompact",!0),i.R7$(11),i.Y8G("ngIf",fe.formEmbed.dirty),i.R7$(5),i.Y8G("ngIf",!fe.requiresSave)("ngIfElse",Ze),i.R7$(4),i.Y8G("device",fe.device)("model",fe.model)("options",fe.widgetEmbedSettings)}},dependencies:[g.Sq,g.bT,g.ux,g.e1,Y.So,he.VT,he._g,F.kk,F.fb,F.Cp,r.oV,f.xH,f.y7,f.me,f.Q0,f.wz,f.BC,f.cb,f.VZ,f.l_,f.j4,f.JD,f.$R,ne.C,p.Q,_e.B,Ce.K,h.R,Be.tI,H,Q.B,ce.z8,g.Jj],styles:['.publish[_ngcontent-%COMP%]{display:grid;grid-template-columns:320px auto;grid-template-rows:auto 1fr;column-gap:40px;height:100%;grid-template-areas:"mode embed" "options embed" "actions embed"}.publish__mode[_ngcontent-%COMP%]{grid-area:mode}.publish__options[_ngcontent-%COMP%]{grid-area:options;overflow:auto}.publish__screens[_ngcontent-%COMP%]{grid-area:screens;text-align:center}.publish__embed[_ngcontent-%COMP%]{grid-area:embed;background-color:#fff;overflow:auto;margin-top:44px}.publish__actions[_ngcontent-%COMP%]{border-top:1px solid #d7e0ea;position:relative;grid-area:actions}.publish__actions-content[_ngcontent-%COMP%]{padding:0;display:flex;flex-direction:column;gap:12px}.publish__group[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto auto;column-gap:8px;align-items:center}.publish__flex-group[_ngcontent-%COMP%]{display:flex}.publish__input[_ngcontent-%COMP%]{font-size:.875rem;line-height:1.25rem}.publish__picker-group[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:12px}.publish__input-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.publish__info-icon[_ngcontent-%COMP%]{color:#96a8c0;font-size:1rem;line-height:1.5rem}'],changeDetection:0})}function Dt(Le,De){if(1&Le&&i.nrm(0,"app-publish",12),2&Le){const me=i.XpG();i.Y8G("model",me.bookmark)("device",me.device)}}Ie([(0,R.l6)(P.F.getDimensions),Oe("design:type",V.c)],yt.prototype,"dimensions$",void 0),Ie([(0,R.l6)(P.F.getMinDimensions),Oe("design:type",V.c)],yt.prototype,"minDimensions$",void 0),Ie([(0,R.l6)(M.J.getCopying),Oe("design:type",V.c)],yt.prototype,"copying$",void 0);let Ft=(()=>{class Le{get device(){return this.form.value.device}constructor(me,fe){this.dialogRef=me,this.deviceTypeEnum=y.k,this.form=new f.gE({device:new f.MJ(y.k.Desktop,[f.k0.required])}),this.bookmark=fe.bookmark}closeDialog(){this.dialogRef.close()}static#e=this.\u0275fac=function(fe){return new(fe||Le)(i.rXU(E.CP),i.rXU(E.Vh))};static#t=this.\u0275cmp=i.VBU({type:Le,selectors:[["app-publish-dialog"]],decls:13,vars:7,consts:[["data-test","publishDialog","role","dialog","aria-modal","true",1,"publish",3,"formGroup"],[1,"publish__header"],[1,"publish__heading"],[1,"flex","justify-center","flex-auto"],["formControlName","device","display","inline","size","medium"],["tooltip","Desktop View","icon","desktop-alt",3,"value"],["tooltip","Tablet View","icon","tablet-alt",3,"value"],["tooltip","Phone View","icon","mobile-alt",3,"value"],[1,"publish__contents"],[3,"model","device",4,"ngIf"],["app-button","","buttonType","text","buttonTheme","light","type","button","title","Close",1,"publish__close",3,"click"],["icon","times","size","lg"],[3,"model","device"]],template:function(fe,Pe){1&fe&&(i.j41(0,"div",0)(1,"div",1)(2,"h2",2),i.EFF(3,"Publish"),i.k0s(),i.j41(4,"div",3)(5,"app-toggle-group",4),i.nrm(6,"app-toggle-group-item",5)(7,"app-toggle-group-item",6)(8,"app-toggle-group-item",7),i.k0s()()(),i.j41(9,"div",8),i.DNE(10,Dt,1,2,"app-publish",9),i.k0s(),i.j41(11,"button",10),i.bIt("click",function(){return Pe.closeDialog()}),i.nrm(12,"app-icon",11),i.k0s()()),2&fe&&(i.Y8G("formGroup",Pe.form),i.BMQ("aria-label","Publish"),i.R7$(6),i.Y8G("value",Pe.deviceTypeEnum.Desktop),i.R7$(),i.Y8G("value",Pe.deviceTypeEnum.Tablet),i.R7$(),i.Y8G("value",Pe.deviceTypeEnum.Mobile),i.R7$(2),i.Y8G("ngIf",Pe.bookmark),i.R7$(),i.BMQ("aria-label","Close"))},dependencies:[g.bT,f.BC,f.cb,f.j4,f.JD,p.Q,h.R,C,v,yt],styles:["a[_ngcontent-%COMP%]{color:#de3535}a[_ngcontent-%COMP%]:hover{color:#c11f1f}.publish[_ngcontent-%COMP%]{position:relative;padding:24px}.publish__header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;height:40px}.publish__heading[_ngcontent-%COMP%]{flex:0 1 320px;font-size:1.25rem;line-height:1.75rem;font-weight:600}.publish__contents[_ngcontent-%COMP%]{height:calc(100vh - 216px)}.publish__close[_ngcontent-%COMP%]{position:absolute;top:24px;right:24px;color:#283853}.publish__close[_ngcontent-%COMP%]:hover{color:#1c2a3f}"],changeDetection:0})}return Le})();var ze=n(93844),It=n(72760),Ot=n(24418),jt=n(92811),wt=n(27180),Et=n(40215),zt=n(65459),Rt=n(36110),Gt=n(18152),vt=n(7213),Bt=n(70737),$t=n(28696),Xt=n(7431),rn=n(94495),Zt=n(91003),ln=n(89079),cn=n(53719),dn=n(82798),un=n(86600),pn=n(98101),hn=n(8961);const _n=(Le,De)=>De.collection_id;function gn(Le,De){if(1&Le&&(i.j41(0,"p",4),i.EFF(1),i.k0s()),2&Le){const me=i.XpG();i.R7$(),i.SpI(" ",me.settings.message," ")}}function At(Le,De){1&Le&&(i.j41(0,"mat-error"),i.EFF(1,"Please enter a valid title."),i.k0s())}function mn(Le,De){1&Le&&(i.j41(0,"app-form-field",13)(1,"mat-select",16)(2,"mat-option",17),i.EFF(3,"Private Library"),i.k0s(),i.j41(4,"mat-option",18),i.EFF(5,"Team Library"),i.k0s()()())}function fn(Le,De){1&Le&&(i.j41(0,"app-form-field",14)(1,"mat-select",19)(2,"mat-option",20),i.EFF(3,"View Only"),i.k0s(),i.j41(4,"mat-option",21),i.EFF(5,"View & Edit"),i.k0s()()())}function qt(Le,De){if(1&Le&&(i.j41(0,"mat-option",23),i.EFF(1),i.k0s()),2&Le){const me=De.$implicit;i.Y8G("value",me.collection_id),i.R7$(),i.JRh(me.collection_name)}}function yn(Le,De){if(1&Le&&(i.j41(0,"app-form-field",15)(1,"mat-select",22),i.Z7z(2,qt,2,2,"mat-option",23,_n),i.k0s()()),2&Le){const me=i.XpG(2);i.R7$(2),i.Dyx(me.collections())}}function vn(Le,De){if(1&Le&&i.DNE(0,mn,6,0,"app-form-field",13)(1,fn,6,0,"app-form-field",14)(2,yn,4,0,"app-form-field",15),2&Le){let me;const fe=i.XpG();i.vxM(fe.canEditBookmark()?0:-1),i.R7$(),i.vxM(fe.canEditBookmark()&&fe.addToTeam()?1:-1),i.R7$(),i.vxM((null==(me=fe.collections())?null:me.length)>0&&fe.addToTeam()?2:-1)}}function en(Le,De){1&Le&&(i.j41(0,"app-form-field",8)(1,"mat-checkbox",24)(2,"span",25),i.EFF(3,"With the BioDigital Community"),i.k0s()()())}function Sn(Le,De){1&Le&&(i.j41(0,"app-message-toggle",28)(1,"span"),i.EFF(2,"Only the following changes will be saved:"),i.k0s(),i.j41(3,"ul",29)(4,"li"),i.EFF(5,"Visibility of structures (hide, fade, isolate)"),i.k0s(),i.j41(6,"li"),i.EFF(7,"Starting position for each chapter"),i.k0s()()())}function bn(Le,De){if(1&Le&&(i.j41(0,"app-form-field",26)(1,"mat-checkbox",27)(2,"span",25),i.EFF(3,"Include changes to this 3D model"),i.k0s()()(),i.DNE(4,Sn,8,0,"app-message-toggle",28)),2&Le){const me=i.XpG();i.R7$(4),i.vxM(me.formIncludeViewChanges.value?4:-1)}}function jn(Le,De){1&Le&&i.nrm(0,"app-spinner",12)}let Nn=(()=>{class Le{get action(){return this.settings.action}get bookmark(){return this.settings.bookmark}get dialogTitle(){switch(this.action){case ze.t9.Manage:return"Manage";case ze.t9.AddToMyLibrary:return"Save this Model";case ze.t9.Duplicate:return"Duplicate";case ze.t9.SaveFromEdit:return"Save As";case ze.t9.SaveFromView:return"bookmark"===this.bookmark.type?"Save As":"Save this Model"}}get saveWithViewChanges(){return this.action===ze.t9.SaveFromView&&this.formIncludeViewChanges.value}get formTitle(){return this.form.get("title")}get formAddTo(){return this.form.get("addTo")}get formModelPermissions(){return this.form.get("modelPermissions")}get formSelectedCollections(){return this.form.get("selectedCollections")}get formIncludeViewChanges(){return this.form.get("includeViewChanges")}constructor(me,fe,Pe,We,Ze,it,ht,_t,pt,ut){this.store=me,this.formBuilder=fe,this.dialogRef=Pe,this.data=We,this.snackbar=Ze,this.actions=it,this.organizationsService=ht,this.positionsService=_t,this.bookmarksService=pt,this.storyService=ut,this.userRole=(0,R.Lt)(S.k.getUserRole),this.organization=(0,R.Lt)(c.q.getOrganization),this.collections=(0,R.Lt)(c.q.getCollections),this.collectionsLoading=(0,R.Lt)(c.q.getCollectionsLoading),this.bookmarkSaving=(0,R.Lt)(M.J.getSaving),this.bookmarkCopying=(0,R.Lt)(M.J.getCopying),this.saving=(0,i.EWP)(()=>{const mt=this.bookmarkCopying(),ft=this.bookmarkSaving();return mt||ft}),this.form=this.formBuilder.group({title:["",[f.k0.required,f.k0.maxLength(60)]],addTo:["",f.k0.required],modelPermissions:[""],publicAccess:[!1],selectedCollections:[[]],includeViewChanges:[!1]}),this.formValues=(0,ln.ot)(this.form.valueChanges.pipe((0,Rt.T)(()=>this.form.getRawValue()))),this.addToTeam=(0,i.EWP)(()=>{const mt=this.formValues();return!!mt&&"team"===mt.addTo}),this.titleAccessDirty=(0,i.EWP)(()=>{const mt=this.formValues();if(!mt)return!1;const ft={title:this.initialTitle,addTo:this.initialAddTo,modelPermissions:this.initialModelPermissions,publicAccess:this.initialPublicAccess},{title:qe,addTo:Pt,modelPermissions:Yt,publicAccess:kn}=mt;return!(0,ie.isEqual)(ft,{title:qe,addTo:Pt,modelPermissions:Yt,publicAccess:kn})}),this.collectionsDirty=(0,i.EWP)(()=>{const mt=this.formValues();return!!mt&&!(0,ie.isEqual)(this.initialSelectedCollections,mt.selectedCollections)}),this.formUnchanged=(0,i.EWP)(()=>{const mt=this.titleAccessDirty(),ft=this.collectionsDirty();return!mt&&!ft}),this.canAddTeamBookmarks=(0,i.EWP)(()=>{const mt=this.userRole(),ft=this.organization();return!(0,ie.isNil)(ft)&&vt._m(mt,Bt.y.AddTeamBookmarks)}),this.canEditBookmark=(0,i.EWP)(()=>{const mt=this.userRole();return this.action===ze.t9.SaveFromEdit||vt.dE(mt,this.bookmark)}),this.contentCollectionsMap=new Map,this.contentCollections=(0,i.vPA)([]),this.isGroupModule=!1,this.bookmarkAction=ze.t9,this.ngUnsubscribe=new G.B,this.settings={...We},this.isGroupModule=vt.Cy(this.bookmark),this.initFormTitle(),this.initFormAccess(),this.getCollections(),(0,i.QZP)(()=>{this.collections(),this.contentCollections(),this.initFormSelectedCollections()})}ngOnInit(){this.initSubscriptions()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}handleCancelClick(){this.dialogRef.close()}initFormTitle(){let me=this.bookmark.title??"";(this.action===ze.t9.Duplicate||this.action===ze.t9.SaveFromView&&"bookmark"===this.bookmark.type)&&(me=`Copy of ${me}`.slice(0,60)),this.initialTitle=me,this.form.patchValue({title:me}),this.isGroupModule&&this.formTitle.disable()}initFormAccess(){let me,fe;const Pe=this.organization(),We=this.bookmarksService.getOrganizationBookmarkGroup(this.bookmark,Pe);this.isGroupModule?(me="team",fe="view"):this.action===ze.t9.Manage&&We?(me=We.visible?"team":"private",fe=We.member_edit?"viewEdit":"view"):(me="private",fe="view");const Ze=!Pe&&this.bookmark.tags.includes("public");this.initialAddTo=me,this.initialModelPermissions=fe,this.initialPublicAccess=Ze,this.form.patchValue({addTo:me,modelPermissions:fe,publicAccess:Ze}),this.isGroupModule&&(this.formAddTo.disable(),this.formModelPermissions.disable())}getCollections(){var me=this;return(0,e.A)(function*(){const fe=me.organization();if(fe&&(me.collections()||me.store.dispatch(new Gt._q(fe.id)),me.action!==ze.t9.SaveFromEdit)){me.formSelectedCollections.disable();const Pe=yield(0,Et._)(me.organizationsService.getCollections({group_id:fe.id,content_type:me.bookmark.type,content_id:me.bookmark.id,include_content:1}));me.formSelectedCollections.enable(),me.contentCollections.set(Pe)}})()}initFormSelectedCollections(){const me=[];this.contentCollections().forEach(fe=>{const Pe=fe.collection_id;this.contentCollectionsMap.set(Pe,fe.collection_content?.[0]?.collection_content_id??null),me.push(Pe)}),this.initialSelectedCollections=me,this.form.patchValue({selectedCollections:me})}initSubscriptions(){this.actions.pipe((0,R.xi)($.x$,$.lN),(0,W.Q)(this.ngUnsubscribe)).subscribe(me=>{this.handleSaveSuccess(me)}),this.actions.pipe((0,R.xi)($.Ur,$.Cr),(0,W.Q)(this.ngUnsubscribe)).subscribe(me=>this.handleSaveFailure(me)),this.isGroupModule&&(this.actions.pipe((0,R.xi)($.u),(0,W.Q)(this.ngUnsubscribe)).subscribe(me=>{this.handleSaveSuccess(me),this.store.dispatch(new $t.w.SearchStudio)}),this.actions.pipe((0,R.xi)($.Ny),(0,W.Q)(this.ngUnsubscribe)).subscribe(me=>this.handleSaveFailure(me))),this.dialogRef.beforeClosed().pipe((0,W.Q)(this.ngUnsubscribe)).subscribe(()=>{this.checkCancelSave()})}handleSubmit(){const me=this.action===ze.t9.AddToMyLibrary||this.action===ze.t9.Duplicate||this.action===ze.t9.SaveFromView&&!this.formIncludeViewChanges.value,fe=this.action===ze.t9.SaveFromEdit||this.saveWithViewChanges,Pe=this.action===ze.t9.Manage,We=this.getBookmarkEntry();me?this.copyBookmark(We):fe?this.saveBookmark(We):Pe&&this.manageBookmark(We)}copyBookmark(me){const fe=this.canAddTeamBookmarks()&&me.add_group_access[0],Pe=this.canAddTeamBookmarks()&&me.addCollections;this.store.dispatch(new $.eW(me.id,me.title,this.bookmark.type,this.store.selectSnapshot(S.k.getUserLanguage),fe,Pe))}saveBookmark(me){var fe=this;return(0,e.A)(function*(){if(fe.isGroupModule)return void fe.updateBookmarkCollections(me);let Pe=!1;fe.formIncludeViewChanges.value&&(fe.store.dispatch(new Xt.gV(fe.store.selectSnapshot(rn.N.getSelectedChapterId),fe.positionsService.getCamera())),Pe=!0),fe.store.dispatch(new $.iy(me,!0,Pe))})()}manageBookmark(me){var fe=this;return(0,e.A)(function*(){fe.isGroupModule?fe.updateBookmarkCollections(me):fe.store.dispatch(new $.iy(me,!1,!1))})()}updateBookmarkCollections(me){this.store.dispatch(new $.Pd(this.bookmark,me.addCollections,me.removeCollections))}handleSaveSuccess(me){const fe=me.bookmark,Pe=this.action===ze.t9.Manage?`Your updates to "${fe.title}" have been saved to your library.`:`"${fe.title}" saved to your library.`;this.action===ze.t9.SaveFromView&&(me instanceof $.x$||me instanceof $.lN)?this.snackbar.open(Pe,"Open",{duration:5e3}).onAction().subscribe(()=>{this.storyService.loadNewBookmark(me.bookmark,me.story,!0,0)}):this.snackbar.open(Pe),this.dialogRef.close(me)}handleSaveFailure(me){let fe="";switch(me.constructor){case $.Ur:case $.Ny:fe=`Unable to save bookmark "${this.formTitle}". Please try again.`;break;case $.Cr:fe="There was an error adding to your library"}this.snackbar.open(fe)}getBookmarkEntry(){const me=this.bookmark,fe=this.action===ze.t9.SaveFromEdit||this.saveWithViewChanges?null:me.id,Pe=me.viewMode,{title:We,publicAccess:Ze}=this.form.value;let it=[],ht=[];const _t=[],pt=new Map;if(this.canAddTeamBookmarks()&&this.canEditBookmark()){const ut=this.createGroupAccess();ut?it=[ut]:ht=me?me.group_access:[];const mt=new Set(this.formSelectedCollections.value);this.collections().forEach(ft=>{const qe=ft.collection_id,Pt=this.contentCollectionsMap.get(qe),Yt=mt.has(qe);this.addToTeam()?((0,ie.isNil)(Pt)||this.action===ze.t9.Duplicate)&&Yt?_t.push(ft):!(0,ie.isNil)(Pt)&&!Yt&&pt.set(ft,Pt):(0,ie.isNil)(Pt)||pt.set(ft,Pt)})}return{isOwner:!0,id:fe,title:We,viewMode:Pe,addCollections:_t,removeCollections:pt,add_group_access:it,remove_group_access:ht,public_access:Ze}}createGroupAccess(){const me=this.organization();if(me&&this.addToTeam())return{group_id:me.id,visible:!0,member_edit:"viewEdit"===this.formModelPermissions.value}}checkCancelSave(){this.bookmarkCopying()?this.store.dispatch(new $.M):this.bookmarkSaving()&&this.store.dispatch(new $.A)}static#e=this.\u0275fac=function(fe){return new(fe||Le)(i.rXU(R.il),i.rXU(f.ok),i.rXU(E.CP),i.rXU(E.Vh),i.rXU(oe.UG),i.rXU(R.En),i.rXU(zt.k),i.rXU(Zt.c),i.rXU(It.x),i.rXU(de.J))};static#t=this.\u0275cmp=i.VBU({type:Le,selectors:[["app-save-bookmark-dialog"]],decls:19,vars:11,consts:[["title",""],["mat-dialog-title",""],["mat-dialog-content",""],[1,"theme-light",3,"formGroup"],[1,"text-gray-500","text-xs","my-3"],["theme","light","label","Title"],["type","text","name","title","maxlength","60","autocomplete","off","formControlName","title","required","","aria-label","Title","data-test","bookmarkTitleInput",1,"input"],[3,"field"],["theme","light","label","Share"],["mat-dialog-actions",""],["type","button","app-button","","buttonTheme","light",3,"click"],["type","submit","app-button","","buttonType","primary","data-test","saveButton",3,"click","disabled"],["size","medium","render","inline",1,"ml-2"],["theme","light","label","Add To"],["theme","light","label","Model Permissions"],["theme","light","label","Collection (Optional)","data-test","saveCollection"],["hideSingleSelectionIndicator","","formControlName","addTo","aria-label","Add To","data-test","bookmarkAddTo",1,"input","mt-2"],["value","private","data-test","bookmarkAddToPrivate"],["value","team","data-test","bookmarkAddToTeam"],["hideSingleSelectionIndicator","","formControlName","modelPermissions","aria-label","Model Permissions","data-test","bookmarkModelPermissions",1,"input","mt-2"],["value","view","data-test","bookmarkModelPermissionsView"],["value","viewEdit","data-test","bookmarkModelPermissionsViewEdit"],["aria-label","Collection (Optional)","formControlName","selectedCollections","multiple","",1,"input"],["data-test","saveCollectionOption",3,"value"],["formControlName","publicAccess"],[1,"text-xs"],["theme","light"],["formControlName","includeViewChanges"],["type","notification",1,"block","mt-2"],[1,"list-disc","list-inside"]],template:function(fe,Pe){if(1&fe){const We=i.RV6();i.j41(0,"h1",1),i.EFF(1),i.k0s(),i.j41(2,"div",2)(3,"form",3),i.DNE(4,gn,2,1,"p",4),i.j41(5,"app-form-field",5),i.nrm(6,"input",6,0)(8,"app-character-counter",7),i.DNE(9,At,2,0,"mat-error"),i.k0s(),i.DNE(10,vn,3,3)(11,en,4,0,"app-form-field",8)(12,bn,5,1),i.k0s()(),i.j41(13,"div",9)(14,"button",10),i.bIt("click",function(){return i.eBV(We),i.Njj(Pe.handleCancelClick())}),i.EFF(15,"Cancel"),i.k0s(),i.j41(16,"button",11),i.bIt("click",function(){return i.eBV(We),i.Njj(Pe.handleSubmit())}),i.EFF(17),i.DNE(18,jn,1,0,"app-spinner",12),i.k0s()()}if(2&fe){const We=i.sdS(7);i.R7$(),i.JRh(Pe.dialogTitle),i.R7$(2),i.Y8G("formGroup",Pe.form),i.R7$(),i.vxM(Pe.settings.message?4:-1),i.R7$(4),i.Y8G("field",We),i.R7$(),i.vxM(Pe.formTitle.invalid?9:-1),i.R7$(),i.vxM(Pe.canAddTeamBookmarks()?10:-1),i.R7$(),i.vxM(Pe.organization()||Pe.action===Pe.bookmarkAction.AddToMyLibrary?-1:11),i.R7$(),i.vxM(Pe.action===Pe.bookmarkAction.SaveFromView?12:-1),i.R7$(4),i.Y8G("disabled",Pe.action===Pe.bookmarkAction.Manage&&Pe.formUnchanged()||Pe.collectionsLoading()||Pe.saving()||Pe.form.invalid),i.R7$(),i.SpI(" ",Pe.saving()?"Saving":"Save"," "),i.R7$(),i.vxM(Pe.saving()?18:-1)}},dependencies:[Y.So,cn.TL,dn.VO,un.wT,E.BI,E.E7,E.Yi,p.Q,Ce.K,pn.P,Be.tI,hn.X,f.qT,f.me,f.BC,f.cb,f.YS,f.tU,f.j4,f.JD],changeDetection:0})}return Le})();var Qt=n(84370),En=n(39596),nt=n(79898),$n=n(58832),ws=n(59e3),Gs=n(71120),Vs=n(30234),Bn=n(63181),tn=n(38645),Ws=n(99327);const Kn=[ze.t9.View,ze.t9.Edit],kt=[ze.t9.Edit,ze.t9.Publish];let Hn=(()=>{class Le{constructor(me,fe,Pe,We,Ze,it,ht,_t,pt,ut,mt,ft,qe){this.store=me,this.publishService=fe,this.dialogService=Pe,this.storageService=We,this.dialog=Ze,this.snackbar=it,this.router=ht,this.bookmarksService=_t,this.breakpointObserver=pt,this.clipboardService=ut,this.userAccessService=mt,this.vendorAnalyticsService=ft,this.shareService=qe}getBookmarkActions(me,fe,Pe,We,Ze){if((0,ie.isNil)(fe)||this.bookmarksService.isZSpaceModel(fe)&&Ot.c.application!==wt.c.Loft)return[];const it=fe.tags||[],ht=vt.dE(me,fe),_t=it.includes("public")&&!ht?j.c.Module:fe.type,pt=this.getBookmarkShareActions(fe,_t);let ut=[];switch(_t){case j.c.Module:ut=[ze.t9.AddToMyLibrary,ze.t9.SaveFromView,ze.t9.Edit,...pt],vt.Cy(fe)&&ut.push(ze.t9.Manage);break;case j.c.Bookmark:ut=[ze.t9.SaveFromView,ze.t9.Edit,...pt,ze.t9.Manage,ze.t9.Duplicate,ze.t9.Delete]}ut=ut.filter(qe=>{if(Ot.c.application===wt.c.Loft&&!Kn.includes(qe)||Ze&&Ze.excludeActions&&Ze.excludeActions.includes(qe)||Ze&&Ze.includeActions&&!Ze.includeActions.includes(qe))return!1;switch(qe){case ze.t9.View:return vt.$Z();case ze.t9.Edit:return vt.OS(me);case ze.t9.Delete:return vt.M8(me,fe);case ze.t9.Duplicate:return vt.Ie(me,fe);case ze.t9.AddToMyLibrary:return vt.c8(me,fe);case ze.t9.SaveFromView:return vt.Hp(me,fe,this.router.url);case ze.t9.Manage:return vt.WV(me,fe);case ze.t9.CopyURL:return vt.XP(me,fe,Pe,We);case ze.t9.Share:return(We?[j.c.Module]:[j.c.Module,j.c.Bookmark]).includes(fe.type);case ze.t9.Publish:return vt.yq(me);default:return!0}});const mt=this.breakpointObserver.isMatched("(max-width: 959px)"),ft=[ze.t9.Edit,ze.t9.Publish,ze.t9.Manage];return(mt||Ot.c.platform!==jt.N.Web)&&(ut=ut.filter(qe=>!ft.includes(qe))),Ot.c.native&&(ut=ut.filter(qe=>!kt.includes(qe))),ut}getBookmarkPrimaryActionLabel(me,fe){let Pe="Select";if(fe===nt.g.Select)Pe="Select";else if(fe===nt.g.Import)Pe="Import";else{const We=me.viewMode??$n._.All;let Ze=me.tour?"View Tour":"View";this.bookmarksService.isZSpaceModel(me)&&this.storageService.getLocalItem(D.UT.ZSpaceDevice)&&(Ze=`${Ze} in XR`);let it=me.quiz?"Take Quiz":"";switch(We){case $n._.Content:it="";break;case $n._.Quiz:me.quiz&&(Ze="")}Pe=Ze||it}return Pe}checkBookmarkLimit(){return this.store.selectSnapshot(S.k.isPremiumUser)?(0,k.of)({limit_reached:!1}):this.bookmarksService.atMaxFreeBookmarkCount()}isPremiumRestrictedAction(me){const fe=this.store.selectSnapshot(S.k.getUserProfile),Pe=!(0,ie.isNil)(fe),We=this.store.selectSnapshot(S.k.isPremiumUser),Ze=this.store.selectSnapshot(c.q.hasOrganization),it=We&&Ze;switch(me){case ze.t9.Publish:return!Pe||!it;case ze.t9.Edit:case ze.t9.AddToMyLibrary:case ze.t9.SaveFromView:return!Pe;default:return!1}}getBookmarkActionsGrouping(me){return{mainActions:me.slice(0,2),moreActions:me.slice(2)}}handleBookmarkAction(me,fe){switch(me){case ze.t9.View:this.view(fe);break;case ze.t9.Edit:this.edit(fe);break;case ze.t9.Manage:this.openSaveDialog({bookmark:fe,action:ze.t9.Manage});break;case ze.t9.Delete:this.delete(fe);break;case ze.t9.CopyURL:this.copyURL(fe);break;case ze.t9.Duplicate:this.duplicate(fe);break;case ze.t9.AddToMyLibrary:this.addToMyLibrary(fe);break;case ze.t9.SaveFromEdit:this.saveFromEdit(fe);break;case ze.t9.SaveFromView:this.saveFromView(fe);break;case ze.t9.Share:this.share(fe);break;case ze.t9.Publish:this.publish(fe)}}view(me){const{id:fe,title:Pe}=me,We=this.store.selectSnapshot(S.k.getUserLocale).lang,Ze=this.publishService.isCustomWidget(me.embed_url_path),it=this.bookmarksService.isZSpaceModel(me),ht=this.storageService.getLocalItem(D.UT.ZSpaceDevice),_t={id:fe,lang:We};if(me.unavailable)this.snackbar.open(`Error opening "${Pe}", it is unavailable.`);else if(Ze){const pt=this.publishService.getWidgetURL(me,me.embed_url,new O.$);window.open(pt)?this.snackbar.open(`"${Pe}" loaded in a new tab.`):this.snackbar.open(`Error launching "${Pe}" in a new tab.`)}else if(it&&ht){const pt=this.publishService.buildWidgetURL("zspace-viewer",_t);window.open(pt)}else this.router.navigate(["/view"],{queryParams:_t})}publish(me){var fe=this;return(0,e.A)(function*(){if(fe.isPremiumRestrictedAction(ze.t9.Publish)){const Pe=fe.store.selectSnapshot(S.k.getProfile);yield(0,Et._)(fe.userAccessService.openPublishPaywall(Pe))}else fe.dialog.open(Ft,{width:"90vw",panelClass:"bd-publish-dialog-panel",data:{bookmark:me}})})()}openSaveDialog(me){var fe=this;return(0,e.A)(function*(){const Pe={id:Qt.t.SaveBookmarkDialog,width:"512px",data:me};return fe.dialog.closeAll(),(0,Et._)(fe.dialog.open(Nn,Pe).afterClosed())})()}edit(me){var fe=this;return(0,e.A)(function*(){if(fe.isPremiumRestrictedAction(ze.t9.Edit)){const We=fe.store.selectSnapshot(S.k.getProfile);return void(yield(0,Et._)(fe.userAccessService.openEditPaywall(We)))}const Pe=fe.store.selectSnapshot(c.q.getOrganizationAddOns);vt.dl(Pe)?fe.router.navigate(["/edit"],{queryParams:{id:me.id}}):fe.userAccessService.openExternalAccountEditGate(Vs.a.WoltersKluwer).pipe((0,a.s)(1)).subscribe()})()}copyURL(me){var fe=this;return(0,e.A)(function*(){const Pe=fe.store.selectSnapshot(c.q.getWidgetOptions)||new O.$,We=fe.store.selectSnapshot(P.F.getWidgetURL),Ze=fe.store.selectSnapshot(S.k.getUserLanguage),it=fe.store.selectSnapshot(S.k.getSelectedUserApp),ht=fe.store.selectSnapshot(c.q.getSelectedOrganizationProductAccountId),_t=yield(0,Et._)(fe.publishService.generateWidgetURL(me,We,Pe,null,t.Q.Single,Ze,it,ht));(yield(0,Et._)(fe.clipboardService.copyToClipboard(_t,"url")))&&fe.snackbar.open("Successfully copied link to clipboard."),fe.vendorAnalyticsService.track("Publish - Success",{type:"url",source:"bookmark-action"})})()}delete(me){return this.dialog.open(Bn.Y,{id:Qt.t.BulkDeleteModelDialog,data:{bookmarks:[me]}})}share(me){const fe=this.store.selectSnapshot(S.k.getUserLanguage),Pe=this.shareService.generateShareLink(me,fe);return!0===Ot.c.native||Ot.c.platform===jt.N.SDK?(this.clipboardService.nativeShareLink(Pe),(0,k.of)(null)):this.dialogService.openShareDialog(Pe,"Share","Anyone with the link can view this 3D model. They will need to create an account for full acccess.").afterClosed()}duplicate(me){this.checkBookmarkLimit().subscribe(fe=>{fe.limit_reached?this.userAccessService.openBookmarkSaveLimit():this.openSaveDialog({bookmark:me,action:ze.t9.Duplicate})})}addToMyLibrary(me){var fe=this;return(0,e.A)(function*(){if(fe.isPremiumRestrictedAction(ze.t9.AddToMyLibrary)){const Pe=fe.store.selectSnapshot(S.k.getProfile);yield(0,Et._)(fe.userAccessService.openAddModelPaywall(Pe))}else fe.checkBookmarkLimit().subscribe(function(){var Pe=(0,e.A)(function*(We){We.limit_reached?fe.userAccessService.openBookmarkSaveLimit():fe.openSaveDialog({bookmark:me,action:ze.t9.AddToMyLibrary})});return function(We){return Pe.apply(this,arguments)}}())})()}saveFromEdit(me){var fe=this;return(0,e.A)(function*(){(yield(0,Et._)(fe.checkBookmarkLimit())).limit_reached?fe.userAccessService.openBookmarkSaveLimit():fe.openSaveDialog({bookmark:me,action:ze.t9.SaveFromEdit})})()}saveFromView(me){var fe=this;return(0,e.A)(function*(){if(fe.isPremiumRestrictedAction(ze.t9.SaveFromView)){const We=fe.store.selectSnapshot(S.k.getProfile);yield(0,Et._)(fe.userAccessService.openAddModelPaywall(We))}else(yield(0,Et._)(fe.checkBookmarkLimit())).limit_reached?fe.userAccessService.openBookmarkSaveLimit():fe.openSaveDialog({bookmark:me,action:ze.t9.SaveFromView})})()}getBookmarkShareActions(me,fe){if(fe===j.c.Module){const pt=!(0,ie.isNil)(me.module_accessor_level);if(pt)return[ze.t9.Publish];if(!pt&&!0!==me.collection_content)return[ze.t9.Publish,ze.t9.Share]}const Pe=this.store.selectSnapshot(S.k.getUserRole),We=this.store.selectSnapshot(S.k.isPremiumUser),Ze=this.store.selectSnapshot(c.q.hasOrganization),it=[];return vt.yq(Pe)&&it.push(ze.t9.Publish),vt.XP(Pe,me,We,Ze)&&it.push(ze.t9.CopyURL),!Ze&&fe===j.c.Bookmark&&it.push(ze.t9.Share),it.length>0?[...it]:[]}static#e=this.\u0275fac=function(fe){return new(fe||Le)(i.KVO(R.il),i.KVO(t.D),i.KVO(s.o),i.KVO(D.n$),i.KVO(E.bZ),i.KVO(oe.UG),i.KVO(tn.Ix),i.KVO(It.x),i.KVO(Ws.QP),i.KVO(L.W),i.KVO(En.p),i.KVO(ws.e),i.KVO(Gs.D))};static#t=this.\u0275prov=i.jDH({token:Le,factory:Le.\u0275fac,providedIn:"root"})}return Le})()},76549:(le,N,n)=>{"use strict";n.d(N,{k:()=>E});var e=n(60177),t=n(92014),s=n(21523),c=n(89417),O=n(21604),P=n(45189),S=n(38645),a=n(40430),f=n(54438);let E=(()=>{class y{static#e=this.\u0275fac=function(p){return new(p||y)};static#t=this.\u0275mod=f.$C({type:y});static#n=this.\u0275inj=f.G2t({imports:[t.rK.forFeature([s.J]),e.MD,P.G,c.X1,O.G,S.iI,a.i]})}return y})()},72760:(le,N,n)=>{"use strict";n.d(N,{x:()=>L});var e=n(21626),t=n(64346),s=n(19833),c=n(17365),O=n(36110),P=n(38399),S=n(28577),a=n(45731),f=n(46104),E=n(45326),y=n(15877),i=n(17766),g=n(49204),p=n(16606),h=n(13517),o=function(Q){return Q.Private="private",Q.Group="enterprise",Q.Public="public",Q}(o||{}),v=n(58832),d=n(79440),r=n(5690),_=n(16823),u=n(7213),l=n(53236),m=n(40470),C=n(30234),b=n(27153),R=n(21424),A=n(17215),G=n(24418),k=n(27180),V=n(66432),W=n(71217),T=n(54438),x=n(92014);const z=1e4,I="/ws/user/bookmark/v4",D={headers:new e.Lr({"Content-Type":"application/json; charset=utf-8"})};let L=(()=>{class Q{constructor(se,Z,de,ae,q){this.store=se,this.http=Z,this.storyService=de,this.productService=ae,this.storageService=q}getBookmarkModel(se){return this.http.get(`/ws/search/bookmarks?eid=${se}`).pipe((0,t.l)(Z=>Z.pipe((0,s.c)(1e3),(0,c.s)(3))),(0,O.T)(Z=>(0,m.bj)(a.S,Z.bookmark_info)),(0,O.T)(Z=>(0,d.H)(Z)))}getUserBookmarks(se,Z="",de=z,ae,q){const K={q:Z,page_size:`${de}`,ol:ae};return(0,g.isNil)(q)||(K.is_owner=""+(q?1:0)),this.http.get(`/ws/search/bookmarks/${se}`,{params:K}).pipe((0,t.l)(j=>j.pipe((0,s.c)(1e3),(0,c.s)(3))),(0,O.T)(j=>j.results.map(M=>(0,m.bj)(a.S,M)).map(M=>(0,d.H)(M))))}getUserConditions(se,Z="",de,ae,q=z){let K="";switch(se){case o.Private:K="user";break;case o.Group:K="group"}return this.http.get(`/ws/search/conditions/private?q=${Z}&page_size=${q}&ol=${de}`).pipe((0,O.T)(j=>j.results.filter(M=>M.module_accessor_level===K&&(!ae||M.module_accessor_id===ae))),(0,O.T)(j=>j.map(M=>(0,d.H)(M))))}getPrivateBookmarks(se="",Z,de=z){return this.getUserBookmarks(o.Private,se,de,Z,!0)}getPrivateConditions(se="",Z){return this.getUserConditions(o.Private,se,Z)}getOrganizationBookmarks(se,Z="",de=z,ae){return this.getUserBookmarks(o.Private,Z,de,ae).pipe((0,O.T)(q=>q.filter(K=>K.tags.includes("enterprise")).filter(K=>K.group_access.some(j=>j.group_id===se))))}getOrganizationConditions(se,Z="",de){return this.getUserConditions(o.Group,Z,de,se)}getOrganizationContent(se,Z="",de){return(0,f.p)([this.getOrganizationBookmarks(se,Z,z,de),this.getOrganizationConditions(se,Z,de)]).pipe((0,O.T)(([ae,q])=>[...ae,...q]))}getPrivateContent(se="",Z){return(0,f.p)([this.getPrivateBookmarks(se,Z),this.getPrivateConditions(se,Z)]).pipe((0,O.T)(([de,ae])=>[...de,...ae]))}getPublicBookmarks(se="",Z){return this.getUserBookmarks(o.Public,se,z,Z)}saveBookmark(se){const Z=this.getNormalizedBookmarkEntry(se);let de;return de=this.http.post(se.id?`${I}/update`:`${I}/save`,Z,D),de.pipe((0,P.q)(ae=>this.getBookmarkModel(ae.id)))}bulkCopyBookmarks(se){const{productType:Z,productKey:de}=this.productService;return this.http.post("/ws/user/bookmark/bulk/copy",{version:1,app_producttype:Z,app_productkey:de,source_content:se},D)}getBookmarkJobs(se={}){const{productType:Z,productKey:de}=this.productService;return this.http.get("/ws/user/jobs",{params:{version:1,app_producttype:Z,app_productkey:de,...se}}).pipe((0,O.T)(ae=>ae?.jobs??[]))}cancelBookmarkJob(se){const{productType:Z,productKey:de}=this.productService;return this.http.post("/ws/user/jobs/cancel",{version:1,app_producttype:Z,app_productkey:de,job_id:se},D)}deleteBookmark(se){return this.http.delete(`${I}/delete`,{params:{eid:se,app_producttype:this.productService.productType,app_productkey:this.productService.productKey}}).pipe((0,S.W)(ae=>{const q=(0,l.u1)(ae);return(0,E.$)(()=>q)}))}bulkDeleteBookmarks(se){const{productType:Z,productKey:de}=this.productService;return this.http.post("/ws/user/bookmark/bulk/delete",{version:1,app_producttype:Z,app_productkey:de,eids:se},D)}atMaxFreeBookmarkCount(){return this.http.get("/ws/user/content/limit/check?version=2").pipe((0,S.W)(se=>(0,y.of)({limit_reached:!1})))}filterByTags(se,Z,de=!1){return se.filter(ae=>de?Z.every(q=>ae.tags.includes(q)):Z.some(q=>ae.tags.includes(q)))}getTags(se){if(se){const Z=[],de=this.store.selectSnapshot(_.k.getUserRole),ae=u.dE(de,se),q=se.type===i.c.Bookmark&&!ae;return this.isZSpaceModel(se)&&Z.push(b.n3[C.a.Zspace]),q&&Z.push("View Only"),se.animated&&Z.push("Animated"),se.tour&&Z.push("Tour"),se.quiz&&Z.push("Quiz"),Z}return[]}getCategories(se,Z="en",de){const ae=null!=de?(0,g.flatten)(de.map(K=>(0,V.e7)(K,Z))):(0,V.QU)(Z),q=[];return se.type===i.c.Module?(se.tags.forEach(K=>{const j=ae.find(M=>M.id===K);j&&q.push(j)}),q):null}isZSpaceModel(se){return!!(0,g.isArray)(se.tags)&&se.tags.includes(C.a.Zspace)}getZSpaceRestriction(){return G.c.application===k.c.Loft?C.O.None:!this.store.selectSnapshot(R.q.hasOrganization)||this.store.selectSnapshot(R.q.isSubscriptionExpired)?C.O.Subscription:"true"!==this.storageService.getLocalItem(A.UT.ZSpaceDevice)?C.O.Device:C.O.None}getShowcase(se,Z,de="en"){const ae=[];if(!(0,g.isNil)(se)&&se.type===W.P.User){const q=this.getUserShowcase(de);ae.push(q)}if(!(0,g.isNil)(Z)){const q=this.getOrganizationShowcase(Z,de);ae.push(q)}return ae.length?(0,f.p)(ae):(0,y.of)([])}getUserShowcase(se="en"){return this.getPrivateBookmarks("",se,10).pipe((0,O.T)(Z=>this.createPrivateShowcase(Z)))}getOrganizationShowcase(se,Z="en"){return this.getOrganizationBookmarks(se.id,"",10,Z).pipe((0,O.T)(de=>this.createOrganizationShowcase(de,se)))}createMockBookmark(se){return{author:"",author_first_name:"",author_last_name:"",cost:0,create_date_time:new Date,description:"",id:"",is_owner:!0,last_editor:"",last_editor_first_name:"",last_editor_last_name:"",tags:[],thumbnail_url:"",title:"",update_date_time:new Date,type:i.c.Bookmark,...se?{animated:!0,tour:!0}:{}}}createMockBookmarks(se=5){return[...Array(se).keys()].map(Z=>this.createMockBookmark(Z%2==0))}getOrganizationBookmarkGroup(se,Z){let de;return Z&&se.group_access&&(de=se.group_access.find(ae=>ae.group_id===Z.id)),de}createPrivateShowcase(se){return{title:"Pick up where you left off",description:"",url:"/results/bookmarks?type=Private",bookmarks:se}}createOrganizationShowcase(se,Z){return{title:`Recently added to ${Z.name}`,description:"Recently added models to your Team library.",url:`/results/bookmarks?organizationId=${Z.id}&type=Organization`,bookmarks:se}}translateBookmark(se,Z,de,ae){const q=de===i.c.Module||de===i.c.Internal?Z.replace(".json",""):Z;return(0,f.p)([this.storyService.getStory(se,i.c.Bookmark),this.storyService.getStoryTranslation(q,de,ae)]).pipe((0,O.T)(([K,j])=>this.storyService.translateStory(K,j)),(0,P.q)(K=>this.saveBookmark({isOwner:!0,title:K.displayName.substr(0,60),id:se,index:K})),(0,O.T)(K=>K.id),(0,S.W)(K=>404===K.status?(0,y.of)(se):(0,E.$)(K)))}getNormalizedBookmarkEntry(se){let Z,de,ae,q;if(se.isOwner){if(Z=se.add_group_access?this.getGroupAccess(se.add_group_access):[],se.remove_group_access&&se.remove_group_access.forEach(K=>{const j=this.getNormalizeGroupAccess({group_id:K.group_id,remove:!0});Z.push(j)}),de=this.getNormalizedBool(se.public_access),se.index){ae={},se.index.chapters&&(ae[h.x.UserGeneratedTour]=this.getNormalizedBool(se.index.chapters.length>1));const K=(se.index.tags||[]).includes("animated");ae[h.x.Animated]=this.getNormalizedBool(K),ae[h.x.ModeQuiz]=this.getNormalizedBool(se.viewMode===v._.Quiz),ae[h.x.ModeContent]=this.getNormalizedBool(se.viewMode===v._.Content),ae[h.x.Quiz]=this.getNormalizedBool(se.index?.quizSettings?.enabled??!1)}q=this.getNormalizedBool(se.is_content_copy)}return{eid:se.id,name:se.title,description:se.description,index:se.index,group_access:Z,public_access:de,flags:ae,is_content_copy:q,app_producttype:this.productService.productType,app_productkey:this.productService.productKey}}getGroupAccess(se){return se.map(Z=>this.getNormalizeGroupAccess(Z))}getNormalizeGroupAccess(se){const{group_id:Z,group_name:de,member_edit:ae,visible:q,remove:K}=se;return{group_id:Z,group_name:de,member_edit:this.getNormalizedBool(ae),visibility:this.getNormalizedBool(q),remove:this.getNormalizedBool(K)}}getNormalizedBool(se){return!0===se?"1":!1===se?"0":""}static#e=this.\u0275fac=function(Z){return new(Z||Q)(T.KVO(x.il),T.KVO(e.Qq),T.KVO(p.J),T.KVO(r.b),T.KVO(A.n$))};static#t=this.\u0275prov=T.jDH({token:Q,factory:Q.\u0275fac,providedIn:"root"})}return Q})()},96728:(le,N,n)=>{"use strict";n.d(N,{F:()=>S,He:()=>O,Ir:()=>e,MQ:()=>s,ZZ:()=>P,_z:()=>t,iU:()=>c});const e={label:"Relevance",fields:[],ascending:!0},t={label:"Most Recent",fields:["collection_content_createdate","update_date_time","create_date_time"],ascending:!1},s={label:"Title (A-Z)",fields:["title"],ascending:!0},c={label:"Title (Z-A)",fields:["title"],ascending:!1},O={label:"Author (A-Z)",fields:["author"],ascending:!0},P={label:"Author (Z-A)",fields:["author"],ascending:!1},S=[e,t,s,c,O,P]},74394:(le,N,n)=>{"use strict";n.d(N,{Ht:()=>f,IZ:()=>v,L7:()=>O,NB:()=>P,Pg:()=>d,Ub:()=>o,Ue:()=>c,VM:()=>p,a:()=>a,iE:()=>S,oM:()=>E});const t={title:"Status",tags:["Live","obsolete"]},s={title:"Platform",tags:["web platform","ios platform","android platform"]},c={title:"Tags",tags:["Animated","Tour","Quiz","featured","new",n(30234).a.Zspace]},O={title:"Gender",tags:["male","female"]},P={title:"Pregnancy",tags:["First Trimester","Second Trimester","Third Trimester"]},S={title:"Regions",tags:["Head and Neck","Thorax","Abdomen","Back","Upper Limb","Pelvis","Lower Limb"]},a={title:"Type (Deprecated)",tags:["Anatomy","Disease","Pharmacology","Physiology","Procedure"]},f={title:"Type",tags:["Anatomy and Physiology","Conditions","Procedures and Treatments"]},E={title:"Level of Detail",tags:["Gross Anatomy","Tissue","Cellular","Molecular"]},y={title:"Anatomy Categories",tags:["complete anatomy","system","regional","Bony Landmarks, Origins, and Insertions","Cross Section","Cross Sections and Microanatomy","Donor Scans","Guided Anatomy","Micro Anatomy"]},i={title:"Clinical Specialty",tags:["Allergy and Immunology","Cardiology","Dentistry","Dermatology","Endocrinology","Gastroenterology and Hepatology","Gynecology","Hematology","Infectious Disease","Neurology and Psychiatry","Obstetrics","Oncology","Ophthalmology","Orthopedics and Rheumatology","Ear, Nose, and Throat","Pediatrics","Physical Therapy","Primary Care","Pulmonology and Respiratory","Urology and Nephrology"]},p={title:"Downloaded",tags:["Downloaded"]},o={title:"Permissions",tags:["My Models","View & Edit","View Only"]},v=[t,s,c,O,f,E,y,i,S,P,{title:"expert collections",tags:["Anatomy for Physical Therapy Students","Anatomy for Medical Students"]}],d=[t,s,c,O,f,a,E,y,i,p,o,S,P]},79440:(le,N,n)=>{"use strict";n.d(N,{H:()=>t});var e=n(58832);function t(c){const{id:O,type:P}=c;if("module"===P&&(c.id=function s(c){return c.replace("Condition.content.","").replace(".json","").split(".").join("/")}(O)),c.tour=c.tags.includes("tour"),c.animated=c.tags.includes("animated"),c.quiz=c.tags.includes("quiz"),c.lowDefinition=c.tags.includes("low definition"),!c.viewMode){const S=Object.values(e._).find(a=>c.tags.includes(a));c.viewMode=S??e._.All}return c}},93844:(le,N,n)=>{"use strict";n.d(N,{Qi:()=>c,bf:()=>O,t9:()=>s});var e=n(49204),s=function(P){return P[P.View=0]="View",P[P.Edit=1]="Edit",P[P.Manage=2]="Manage",P[P.Publish=3]="Publish",P[P.Delete=4]="Delete",P[P.CopyURL=5]="CopyURL",P[P.Share=6]="Share",P[P.AddToMyLibrary=7]="AddToMyLibrary",P[P.Duplicate=8]="Duplicate",P[P.SaveFromEdit=9]="SaveFromEdit",P[P.SaveFromView=10]="SaveFromView",P}(s||{});const c={[s.View]:"",[s.AddToMyLibrary]:"plus",[s.SaveFromView]:"",[s.SaveFromEdit]:"",[s.Edit]:"wand-magic-sparkles",[s.Share]:"share-alt",[s.Publish]:"code",[s.CopyURL]:"link",[s.Duplicate]:"",[s.Manage]:"",[s.Delete]:""};function O(P){return{[s.View]:"View",[s.AddToMyLibrary]:"Save this Model",[s.SaveFromView]:"Save this Model",[s.SaveFromEdit]:"Save As",[s.Edit]:`Customize in ${(0,e.capitalize)(P)}`,[s.Share]:"Share",[s.Publish]:"Publish",[s.CopyURL]:"Copy URL",[s.Duplicate]:"Duplicate",[s.Manage]:"Manage",[s.Delete]:"Delete"}}},52394:(le,N,n)=>{"use strict";n.d(N,{c:()=>e});var e=function(t){return t.Private="Private",t.TeamView="Team - View Only",t.TeamEdit="Team - View & Edit",t}(e||{})},55361:(le,N,n)=>{"use strict";n.d(N,{EL:()=>a,h5:()=>S});var e=n(97948),t=n(49204);function P(f,E,y){const i=E.map(g=>f[g]).filter(g=>!(0,t.isNil)(g));return y?i.sort().shift():i.sort().pop()}function S(f,E,y){if(0===E.length)return f;const i=new Intl.Collator("en-US",{sensitivity:"base"});return f.sort((g,p)=>{const h=P(g,E,y)||"",o=P(p,E,y)||"";return(y?1:-1)*i.compare(h.toString(),o.toString())})}function a(f,E,y){return 0===f.sortBy.fields.length&&""===E?.query&&E?.type===e.n.Category&&"regional"===E?.categoryId?[...y.filter(g=>!g.tags.includes("Guided Anatomy")),...y.filter(g=>g.tags.includes("Guided Anatomy"))]:[...y]}},58832:(le,N,n)=>{"use strict";n.d(N,{_:()=>e});var e=function(t){return t.All="",t.Quiz="mode-quiz",t.Content="mode-content",t}(e||{})},13517:(le,N,n)=>{"use strict";n.d(N,{x:()=>e});var e=function(t){return t.UserGeneratedTour="user_generated_tour",t.Animated="animated",t.Quiz="quiz",t.ModeQuiz="mode_quiz",t.ModeContent="mode_content",t}(e||{})},45731:(le,N,n)=>{"use strict";n.d(N,{S:()=>P});var e=n(16938);class t{}var s=n(17766);class P{constructor(){this.type=s.c.Bookmark,this.favorite=!1,this.unavailable=!1}}!function(S,a,f,E){var g,y=arguments.length,i=y<3?a:null===E?E=Object.getOwnPropertyDescriptor(a,f):E;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(S,a,f,E);else for(var p=S.length-1;p>=0;p--)(g=S[p])&&(i=(y<3?g(i):y>3?g(a,f,i):g(a,f))||i);y>3&&i&&Object.defineProperty(a,f,i)}([(0,e.Z)(()=>t),function(){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata("design:type",Array)}()],P.prototype,"group_access",void 0)},47632:(le,N,n)=>{"use strict";n.d(N,{$H:()=>H,A:()=>p,B7:()=>l,B9:()=>v,C$:()=>te,CF:()=>re,CR:()=>a,Cr:()=>x,D3:()=>G,DN:()=>f,ET:()=>X,F_:()=>ce,GZ:()=>j,Gr:()=>t,HN:()=>ae,I0:()=>de,J9:()=>r,Kf:()=>c,Ln:()=>w,M:()=>z,Mo:()=>q,Mv:()=>A,Ny:()=>R,PS:()=>F,PU:()=>s,Pd:()=>C,Qw:()=>E,Ri:()=>o,U8:()=>$,Ur:()=>g,VN:()=>Z,Xt:()=>O,ZA:()=>K,ZW:()=>M,Zp:()=>ie,a1:()=>L,cK:()=>se,dc:()=>oe,eW:()=>W,e_:()=>I,g:()=>m,iw:()=>V,iy:()=>y,j5:()=>_,lN:()=>T,ov:()=>u,pE:()=>D,sN:()=>P,te:()=>ue,u:()=>b,x$:()=>i,yH:()=>d,zP:()=>k,zW:()=>Q,zX:()=>S});var e=n(11040);let t=(()=>{class Y{static#e=this.type="[Bookmarks] Load";constructor(ne,_e){this.query=ne,this.lang=_e}}return Y})(),s=(()=>{class Y{static#e=this.type="[Bookmarks] Load Organization Bookmarks";constructor(ne,_e,Ce){this.organizationId=ne,this.query=_e,this.lang=Ce}}return Y})(),c=(()=>{class Y{static#e=this.type="[Bookmarks] Load Collection Bookmarks";constructor(ne,_e,Ce,Be){this.organizationId=ne,this.collectionId=_e,this.query=Ce,this.lang=Be}}return Y})(),O=(()=>{class Y{static#e=this.type="[Bookmarks] Select Bookmark";constructor(ne,_e,Ce=!1){this.id=ne,this.type=_e,this.preview=Ce}}return Y})(),P=(()=>{class Y{static#e=this.type="[Bookmarks] Select Bookmark Success";constructor(ne){this.bookmark=ne}}return Y})(),S=(()=>{class Y{static#e=this.type="[Bookmarks] Load Success";constructor(ne){this.result=ne}}return Y})(),a=(()=>{class Y{static#e=this.type="[Bookmarks] Delete Bookmark";constructor(ne){this.bookmarkId=ne}}return Y})(),f=(()=>{class Y{static#e=this.type="[Bookmarks] Bookmark Delete Success";constructor(ne){this.bookmarkId=ne}}return Y})(),E=(()=>{class Y{static#e=this.type="[Bookmarks] Bookmark Delete Fail";constructor(ne,_e){this.bookmarkId=ne,this.error=_e}}return Y})(),y=(()=>{class Y{static#e=this.type="[Bookmarks] Save Bookmark";constructor(ne,_e,Ce){this.bookmarkEntry=ne,this.serializeScene=_e,this.includeCameraPositions=Ce}}return Y})(),i=(()=>{class Y{static#e=this.type="[Bookmarks] Bookmark Saved";constructor(ne,_e,Ce){this.bookmark=ne,this.story=_e,this.method=Ce}}return Y})(),g=(()=>{class Y{static#e=this.type="[Bookmarks] Bookmark Save Failed";constructor(ne,_e){this.bookmarkEntry=ne,this.error=_e}}return Y})(),p=(()=>{class Y{static#e=this.type="[Bookmarks] Cancel Save Bookmark"}return Y})(),o=(()=>{class Y{static#e=this.type="[Bookmarks] Reset"}return Y})(),v=(()=>{class Y{static#e=this.type="[Bookmarks] Clear Bookmarks"}return Y})(),d=(()=>{class Y{static#e=this.type="[Bookmarks] Sort";constructor(ne){this.sort=ne}}return Y})(),r=(()=>{class Y{static#e=this.type="[Bookmarks] Check Bookmark";constructor(ne,_e){this.id=ne,this.checked=_e}}return Y})(),_=(()=>{class Y{static#e=this.type="[Bookmarks] Set Checked Bookmarks";constructor(ne){this.ids=ne}}return Y})(),u=(()=>{class Y{static#e=this.type="[Bookmarks] Export Bookmarks";constructor(ne,_e,Ce,Be,Ie,Oe,Te,ve,Ve){this.bookmarks=ne,this.organizationId=_e,this.collections=Ce,this.widgetURL=Be,this.userLanguage=Ie,this.userApp=Oe,this.widgetOptions=Te,this.offlineEnabled=ve,this.productAccountId=Ve}}return Y})(),l=(()=>{class Y{static#e=this.type="[Bookmarks] Export Bookmarks Success";constructor(ne){this.bookmarks=ne}}return Y})(),m=(()=>{class Y{static#e=this.type="[Bookmarks] Export Bookmarks Error";constructor(ne){this.bookmarks=ne}}return Y})(),C=(()=>{class Y{static#e=this.type="[Bookmarks] Update Bookmark Collections";constructor(ne,_e=[],Ce=new Map){this.bookmark=ne,this.addCollections=_e,this.removeCollections=Ce}}return Y})(),b=(()=>{class Y{static#e=this.type="[Bookmarks] Update Bookmark Collections Success";constructor(ne,_e,Ce){this.bookmark=ne,this.addCollections=_e,this.removeCollections=Ce}}return Y})(),R=(()=>{class Y{static#e=this.type="[Bookmarks] Update Bookmark Collections Error";constructor(ne,_e,Ce){this.bookmark=ne,this.addCollections=_e,this.removeCollections=Ce}}return Y})(),A=(()=>{class Y{static#e=this.type="[Bookmarks] Add Bookmark Collections Success";constructor(ne,_e){this.bookmark=ne,this.collections=_e}}return Y})(),G=(()=>{class Y{static#e=this.type="[Bookmarks] Add Bookmark Collections Error";constructor(ne,_e){this.bookmark=ne,this.collections=_e}}return Y})(),k=(()=>{class Y{static#e=this.type="[Bookmarks] Remove Bookmark Collections Success";constructor(ne,_e){this.bookmark=ne,this.collections=_e}}return Y})(),V=(()=>{class Y{static#e=this.type="[Bookmarks] Remove Bookmark Collections Error";constructor(ne,_e){this.bookmark=ne,this.collections=_e}}return Y})(),W=(()=>{class Y{static#e=this.type="[Bookmarks] Copy Bookmark";constructor(ne,_e,Ce,Be=e.q.lang,Ie,Oe){this.id=ne,this.title=_e,this.type=Ce,this.lang=Be,this.groupAccess=Ie,this.collections=Oe}}return Y})(),T=(()=>{class Y{static#e=this.type="[Bookmarks] Copy Bookmark Success";constructor(ne,_e){this.bookmark=ne,this.story=_e}}return Y})(),x=(()=>{class Y{static#e=this.type="[Bookmarks] Copy Bookmark Failure";constructor(ne,_e){this.id=ne,this.error=_e}}return Y})(),z=(()=>{class Y{static#e=this.type="[Bookmarks] Cancel Copy Bookmark"}return Y})(),I=(()=>{class Y{static#e=this.type="[Bookmarks] Set Bookmark Text";constructor(ne){this.title=ne}}return Y})(),D=(()=>{class Y{static#e=this.type="[Bookmarks] Set Bookmark View Mode";constructor(ne){this.viewMode=ne}}return Y})(),L=(()=>{class Y{static#e=this.type="[Bookmarks] Set Selected Category";constructor(ne){this.category=ne}}return Y})(),Q=(()=>{class Y{static#e=this.type="[Bookmarks] Get Bookmark Jobs"}return Y})(),ie=(()=>{class Y{static#e=this.type="[Bookmarks] Set Bookmark Jobs";constructor(ne){this.bookmarkJobs=ne}}return Y})(),se=(()=>{class Y{static#e=this.type="[Bookmarks] Get Bookmark Jobs Success";constructor(ne){this.bookmarkJobs=ne}}return Y})(),Z=(()=>{class Y{static#e=this.type="[Bookmarks] Get Bookmark Jobs Failure";constructor(ne){this.error=ne}}return Y})(),de=(()=>{class Y{static#e=this.type="[Bookmarks] Cancel Bookmark Job";constructor(ne,_e){this.jobId=ne,this.jobType=_e}}return Y})(),ae=(()=>{class Y{static#e=this.type="[Bookmarks] Cancel Bookmark Job Success";constructor(ne,_e){this.jobId=ne,this.jobType=_e}}return Y})(),q=(()=>{class Y{static#e=this.type="[Bookmarks] Cancel Bookmark Job Fail";constructor(ne,_e,Ce){this.jobId=ne,this.jobType=_e,this.error=Ce}}return Y})(),K=(()=>{class Y{static#e=this.type="[Bookmarks] Bulk Copy Bookmarks";constructor(ne){this.copyBookmarkModels=ne}}return Y})(),j=(()=>{class Y{static#e=this.type="[Bookmarks] Bulk Copy Bookmarks Processing";constructor(ne,_e){this.copyBookmarkModels=ne,this.jobId=_e}}return Y})(),M=(()=>{class Y{static#e=this.type="[Bookmarks] Bulk Copy Bookmarks Error"}return Y})(),$=(()=>{class Y{static#e=this.type="[Bookmarks] Bulk Copy Bookmarks Complete"}return Y})(),ce=(()=>{class Y{static#e=this.type="[Bookmarks] Bulk Copy Bookmarks Failure";constructor(ne,_e){this.copyBookmarkModels=ne,this.error=_e}}return Y})(),re=(()=>{class Y{static#e=this.type="[Bookmarks] Bulk Delete Bookmark";constructor(ne){this.bookmarkIds=ne}}return Y})(),ue=(()=>{class Y{static#e=this.type="[Bookmarks] Bookmark Bulk Delete Processing";constructor(ne,_e){this.deleteBookmarkIds=ne,this.jobId=_e}}return Y})(),H=(()=>{class Y{static#e=this.type="[Bookmarks] Bookmark Bulk Delete Complete"}return Y})(),te=(()=>{class Y{static#e=this.type="[Bookmarks] Bookmark Bulk Delete Fail";constructor(ne,_e){this.bookmarkIds=ne,this.error=_e}}return Y})(),F=(()=>{class Y{static#e=this.type="[Bookmarks] Bulk Delete Bookmarks Error"}return Y})(),w=(()=>{class Y{static#e=this.type="[Bookmarks] Bulk Update Bookmark Collections";constructor(ne,_e){this.groupId=ne,this.updates=_e}}return Y})(),X=(()=>{class Y{static#e=this.type="[Bookmarks] Bulk Update Bookmark Collections Success";constructor(ne){this.updates=ne}}return Y})(),oe=(()=>{class Y{static#e=this.type="[Bookmarks] Bulk Update Bookmark Collections Error";constructor(ne,_e){this.updates=ne,this.error=_e}}return Y})()},21523:(le,N,n)=>{"use strict";n.d(N,{J:()=>ue});var e=n(28407),t=n(92014);class s{}var c=n(47632),O=n(15152),P=n(11756),S=n(17365),a=n(36110),f=n(32914),E=n(39705),y=n(72760),i=n(94495),g=n(21472),p=n(46104),h=n(15877),o=n(96728),v=n(16058),d=n(56583),r=n(65459),_=n(66874),u=n(49204),l=n(55361),m=n(65881),C=n(95416),b=n(35939);class R{}var A=n(16606),G=n(59e3),k=n(57238),V=n(65650),W=n(82323),T=n(1580),x=n(11113),z=n(58832),I=n(79440),D=n(17215),L=n(17766),Q=n(40215),ie=n(53236),se=n(24418),Z=n(38645),de=n(22679),ae=n(2096),q=n(84426),K=n(21894),j=n(54438),M=function(H,te,F,w){var Y,X=arguments.length,oe=X<3?te:null===w?w=Object.getOwnPropertyDescriptor(te,F):w;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)oe=Reflect.decorate(H,te,F,w);else for(var he=H.length-1;he>=0;he--)(Y=H[he])&&(oe=(X<3?Y(oe):X>3?Y(te,F,oe):Y(te,F))||oe);return X>3&&oe&&Object.defineProperty(te,F,oe),oe},$=function(H,te){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(H,te)};function ce(H,te,F,w,X,oe){return oe?(0,g.H)(F.getDatabaseItem(D.AJ.PreviewBookmark)):X===L.c.Bookmark?H.getBookmarkModel(w):te.getConditionModel(w)}const re={loading:!0,exporting:!1,copying:!1,saving:!1,bookmarks:[],selectedBookmark:null,sort:o._z,checkedBookmarks:[],selectedCategory:null,bookmarkJobs:[]};let ue=class us{static getBookmarks(te){const{bookmarks:F,sort:w}=te,{ascending:X,fields:oe}=w;return(0,l.h5)(F,oe,X)}static getCheckedBookmarks(te){return te.checkedBookmarks}static getSelectedBookmark(te){return te.selectedBookmark}static getSelectedBookmarkViewMode(te){return te.selectedBookmark?te.selectedBookmark.viewMode:z._.All}static getLoading(te){return te.loading}static getExporting(te){return te.exporting}static getSaving(te){return te.saving}static getCopying(te){return te.copying}static getSort(te){return te.sort}static getSelectedCategory(te){return te.selectedCategory}static getBookmarkJobs(te){return te.bookmarkJobs}static getActiveBookmarkJob(te){const F=["aborted","complete","error"];return te.bookmarkJobs.find(w=>!F.includes(w.job_status))}loadBookmarks(te,F){te.patchState({loading:!0,bookmarks:[],checkedBookmarks:[]}),(0,p.p)(this.bookmarksService.getPrivateBookmarks(F.query,F.lang),this.bookmarksService.getPrivateConditions(F.query,F.lang)).pipe((0,O.j)(()=>te.patchState({loading:!1}))).subscribe(([w,X])=>{te.dispatch(new c.zX([...w,...X]))})}loadOrganizationBookmarks(te,{organizationId:F,query:w,lang:X}){te.patchState({loading:!0,bookmarks:[],checkedBookmarks:[]}),this.bookmarksService.getOrganizationContent(F,w,X).pipe((0,O.j)(()=>te.patchState({loading:!1}))).subscribe(oe=>{te.dispatch(new c.zX(oe))})}loadCollectionBookmarks(te,F){te.patchState({loading:!0,bookmarks:[],checkedBookmarks:[]}),this.organizationsService.getCollectionContent(F.organizationId,F.collectionId,F.query,F.lang).pipe((0,O.j)(()=>te.patchState({loading:!1}))).subscribe(w=>{te.dispatch(new c.zX(w))})}loadSuccess({patchState:te},F){te({bookmarks:F.result})}selectBookmark(te,F){const{id:w,type:X,preview:oe}=F;ce(this.bookmarksService,this.exploreService,this.storageService,w,X,oe).subscribe(he=>{te.dispatch(new c.sN(he))})}selectBookmarkSuccess(te,F){let{bookmark:w}=F;w&&(w=(0,I.H)(w)),te.patchState({selectedBookmark:w})}saveBookmark(te,F){var w=this;return(0,e.A)(function*(){te.patchState({saving:!0});const X=F.bookmarkEntry,oe=X.id?"update":"save",Y=w.store.selectSnapshot(i.N.getStoryChapters),he="save"===oe,ne=(0,m.S)(Y,he);let _e;he&&(yield(0,Q._)(w.store.dispatch(new b.u.UpdateTweenParticleLookupChapters(ne)))),_e=F.serializeScene?w.serializeModuleService.serialize({},new K.F,!1,w.store.selectSnapshot(de.t.getStory),w.store.selectSnapshot(i.N.getStoryChapters),ne,F.includeCameraPositions).story:yield(0,Q._)(w.storyService.getStory(X.id,L.c.Bookmark)),"save"===oe&&w.storyService.addContentRecord(w.store.selectSnapshot(de.t.getStoryId),_e),_e.displayName=X.title,X.index=_e;let Ce=(0,h.of)([]);if(F.serializeScene){const Be=w.store.selectSnapshot(V.K.getRegisteredThumbnails),Ie=w.imagesService.saveChapterThumbnails(X.index.chapters,Be,(0,u.invert)(ne));Ie.length&&(Ce=(0,p.p)(Ie))}Ce.pipe((0,P.Z)(Be=>{const Ie=w.store.selectSnapshot(V.K.getRegisteredThumbnails);return Be.forEach(Oe=>{const Te=new k.R;Te.storyId=X.id,Te.chapterId=Oe.chapterId,Te.urls={small:Oe.uris.small,large:Oe.uris.large},Ie.set(Oe.chapterId,Te);const ve=X.index.chapters.findIndex(Ve=>Ve.id===Oe.chapterId);ve>=0&&(X.index.chapters[ve].thumbnails={...Oe.uris})}),te.dispatch(new W.W2(Ie)),w.bookmarksService.saveBookmark(X)})).subscribe({next:Be=>{const Ie=Array.isArray(X.addCollections)&&X.addCollections.length>0,Oe=X.removeCollections&&Array.from(X.removeCollections.keys()).length>0;Ie||Oe?(w.actions.pipe((0,t.xi)(c.u,c.Ny),(0,S.s)(1)).subscribe(()=>{te.dispatch(new c.x$(Be,X.index,oe))}),te.dispatch(new c.Pd(Be,X.addCollections,X.removeCollections))):te.dispatch(new c.x$(Be,X.index,oe))},error:Be=>{te.dispatch(new c.Ur(X,Be))}}),w.vendorAnalyticsService.track("Bookmark Save - Start")})()}saveBookmarkSuccess(te,F){te.patchState({saving:!1});const w=F.bookmark,X=te.getState().bookmarks,oe=X.findIndex(Y=>Y.id===w.id);-1!==oe&&(X[oe]=w,te.patchState({bookmarks:[...X]})),this.vendorAnalyticsService.track("Bookmark Save - Success",{id:w.id,chapters:F.story.chapters.length,tour:w.tour,animated:w.animated,quiz:w.quiz,edit:this.router.url.startsWith("/edit")})}saveBookmarkFail(te,F){te.patchState({saving:!1});const w=F.bookmarkEntry?.id||"",X=w.includes("/")?L.c.Module:L.c.Bookmark,oe=(0,ie.u1)(F.error),Y=F.error?.status;this.vendorAnalyticsService.track("Bookmark Save - Failure",{contentId:w,contentType:X,error:oe,statusCode:Y,application:se.c.application})}deleteBookmark(te,F){const w=F.bookmarkId;this.bookmarksService.deleteBookmark(w).subscribe(()=>{te.dispatch(new c.DN(w))},X=>{te.dispatch(new c.Qw(w,X))})}deleteBookmarkSuccess(te,F){const w=te.getState().bookmarks.filter(X=>X.id!==F.bookmarkId);te.patchState({bookmarks:[...w]}),this.snackbar.open("Successfully deleted 3D model")}bulkDeleteBookmark(te,{bookmarkIds:F}){this.vendorAnalyticsService.track("Bulk Delete - Start"),this.bookmarksService.bulkDeleteBookmarks(F).subscribe({next:w=>{te.dispatch(new c.te(F,w.job_id)),te.dispatch(new c.zW)},error:w=>{this.vendorAnalyticsService.track("Bulk Delete - Error"),te.dispatch(new c.C$(F,w))}})}bulkDeleteBookmarkComplete(te,F){this.vendorAnalyticsService.track("Bulk Delete - Complete")}bulkDeleteBookmarksError(te,F){this.vendorAnalyticsService.track("Bulk Delete - Error")}sortBookmarks(te,F){const w=te.getState().bookmarks;te.patchState({sort:F.sort,bookmarks:[...w]})}clearBookmarks(te,F){te.patchState({bookmarks:[],checkedBookmarks:[]})}resetBookmarks(te,F){te.setState(re)}checkBookmark(te,F){let w=te.getState().checkedBookmarks;const X=w.some(oe=>oe===F.id);F.checked&&!X?w=[...w,F.id]:F.checked||(w=w.filter(oe=>oe!==F.id)),te.patchState({checkedBookmarks:w})}setCheckedBookmarks(te,F){te.patchState({checkedBookmarks:F.ids})}exportBookmarks(te,F){const{bookmarks:w,organizationId:X,collections:oe,widgetURL:Y,widgetOptions:he,offlineEnabled:ne,productAccountId:_e}=F,Ce=he||new d.$;te.patchState({exporting:!0}),this.publishService.exportBookmarks(w,X,oe,Y,Ce,null,F.userLanguage,F.userApp,ne,_e).pipe((0,O.j)(()=>{te.patchState({exporting:!1})})).subscribe(Be=>{te.dispatch(Be?new c.B7(w):new c.g(w))})}postUpdateBookmarkCollections(te,F){const w=new Map,X=new Map;F.forEach(({bookmark:he,addCollections:ne,removeCollections:_e})=>{ne.forEach(Ce=>{const Be=Ce.collection_id,Ie={content_type:he.type,content_id:he.id},Oe=w.get(Be)??[];Oe.push(Ie),w.set(Be,Oe)}),_e.forEach((Ce,Be)=>{const Ie=Be.collection_id,Oe=X.get(Ie)??[];Oe.push(Ce),X.set(Ie,Oe)})});const oe=Array.from(w).map(([he,ne])=>({collection_id:he,content_list:ne})),Y=Array.from(X).map(([he,ne])=>({collection_id:he,collection_content_id_list:ne}));return this.organizationsService.updateCollectionContent(te,oe,Y)}bulkUpdateBookmarkCollections(te,{groupId:F,updates:w}){this.vendorAnalyticsService.track("Bulk Move/Remove - Start"),this.postUpdateBookmarkCollections(F,w).subscribe({next:()=>{this.vendorAnalyticsService.track("Bulk Move/Remove - Success"),te.dispatch(new c.ET(w))},error:X=>{this.vendorAnalyticsService.track("Bulk Move/Remove - Error"),te.dispatch(new c.dc(w,X))}})}updateBookmarkCollections(te,F){const w=F.addCollections,X=w.map(ne=>({collection_id:ne.collection_id,content_list:[{content_type:F.bookmark.type,content_id:F.bookmark.id}]})),oe=Array.from(F.removeCollections.keys()),Y=oe.map(ne=>({collection_id:ne.collection_id,collection_content_id_list:[F.removeCollections.get(ne)]})),he=w.concat(oe)[0].group_id;this.organizationsService.updateCollectionContent(he,X,Y).subscribe(()=>{w.length>0&&te.dispatch(new c.Mv(F.bookmark,w)),oe.length>0&&te.dispatch(new c.zP(F.bookmark,oe)),te.dispatch(new c.u(F.bookmark,w,oe))},()=>{w.length>0&&te.dispatch(new c.D3(F.bookmark,w)),oe.length>0&&te.dispatch(new c.iw(F.bookmark,oe)),te.dispatch(new c.Ny(F.bookmark,w,oe))})}removeBookmarkCollectionSuccess(te,F){const{bookmarks:w,selectedCategory:X}=te.getState();if("collection"===X){const oe=F.bookmark.id,Y=w.filter(he=>he.id!==oe);te.patchState({bookmarks:[...Y]})}}copyBookmark(te,F){this.vendorAnalyticsService.track("Bookmark Copy - Start");const{groupAccess:w,collections:X}=F;let oe,Y,he,ne,_e;te.patchState({copying:!0,saving:!0});const Ce=ce(this.bookmarksService,this.exploreService,this.storageService,F.id,F.type,!1),Be=this.storyService.getStory(F.id,F.type,F.lang);(0,p.p)([Ce,Be]).pipe((0,a.T)(([Ie,Oe])=>{Y=(0,u.cloneDeep)(Oe),he=(0,u.cloneDeep)(Oe),this.storyService.addContentRecord(F.id,he),ne=(0,m.S)(Y.chapters,!0),he.chapters.forEach(Te=>{Te.id=ne[Te.id]}),F.title&&(he.displayName=F.title),F.type?delete he.sourceInfo:he.sourceInfo=(0,ae.CE)(he.sourceInfo),he.tweenParticleLookup&&(he.tweenParticleLookup=x.e.updateChapterIds(he.tweenParticleLookup,ne)),_e=Ie.viewMode}),(0,f.n)(()=>this.imagesService.generateFreshChapterImages(Y.chapters,F.id)),(0,f.n)(Ie=>{const Oe=Ie.map(Te=>this.imagesService.saveNewChapterImage(Te.chapterId,Te.snapshot));return Oe.length?(0,p.p)(Oe):(0,h.of)([])}),(0,a.T)(Ie=>{Ie.forEach(Oe=>{Oe.chapterId=ne[Oe.chapterId]}),he.chapters.forEach(Oe=>{const Te=Ie.find(ve=>ve.chapterId===Oe.id);Te&&(Oe.thumbnails={...Te.uris})})}),(0,f.n)(()=>{const Ie=new R;return Ie.title=F.title,Ie.isOwner=!0,Ie.index=he,Ie.viewMode=_e,Ie.is_content_copy=!0,w&&(Ie.add_group_access=[w]),this.bookmarksService.saveBookmark(Ie)}),(0,E.M)(Ie=>{oe=Ie}),(0,f.n)(()=>{if(w&&X&&X.length>0){const Ie=X[0].group_id,Oe=X.map(Te=>({collection_id:Te.collection_id,content_list:[{content_type:oe.type,content_id:oe.id}]}));return this.organizationsService.updateCollectionContent(Ie,Oe,[])}return(0,h.of)(!0)}),(0,O.j)(()=>{te.patchState({copying:!1,saving:!1})})).subscribe(()=>{this.vendorAnalyticsService.track("Bookmark Copy - Success",{id:oe.id,chapters:he.chapters.length,tour:oe.tour,animated:oe.animated,quiz:oe.quiz,edit:this.router.url.startsWith("/edit")}),te.dispatch(new c.lN(oe,he))},Ie=>{this.vendorAnalyticsService.track("Bookmark Copy - Failure"),te.dispatch(new c.Cr(F.id,Ie))})}copyBookmarks(te,{copyBookmarkModels:F}){this.vendorAnalyticsService.track("Bulk Add - Start"),te.patchState({copying:!0}),this.bookmarksService.bulkCopyBookmarks(F).pipe((0,O.j)(()=>{te.patchState({copying:!1})})).subscribe({next:w=>{te.dispatch(new c.GZ(F,w.job_id)),te.dispatch(new c.zW)},error:w=>{this.vendorAnalyticsService.track("Bulk Add - Error"),te.dispatch(new c.F_(F,w))}})}bulkCopyBookmarksComplete(te,F){this.vendorAnalyticsService.track("Bulk Add - Success")}BulkCopyBookmarksError(te,F){this.vendorAnalyticsService.track("Bulk Add - Error")}getBookmarkJobs(te,F){this.bookmarksService.getBookmarkJobs().subscribe({next:w=>{te.dispatch(new c.cK(w))},error:w=>{te.dispatch(new c.VN(w))}})}setBookmarkJobs(te,{bookmarkJobs:F}){te.patchState({bookmarkJobs:F})}getBookmarkJobsSuccess(te,{bookmarkJobs:F}){te.dispatch(new c.Zp(F))}cancelBookmarkJob(te,{jobId:F,jobType:w}){this.vendorAnalyticsService.track(("bookmark_copy"===w?"Bulk Add":"Bulk Delete")+" - Stopped"),this.bookmarksService.cancelBookmarkJob(F).subscribe({next:()=>{te.dispatch(new c.HN(F,w)),te.dispatch(new c.zW)},error:X=>{te.dispatch(new c.Mo(F,w,X))}})}setBookmarkText(te,F){const w=te.getState().selectedBookmark;te.patchState({selectedBookmark:{...w,title:F.title}})}setBookmarkViewMode(te,F){const w=te.getState().selectedBookmark;te.patchState({selectedBookmark:{...w,viewMode:F.viewMode}})}setSelectedCategory(te,{category:F}){te.patchState({selectedCategory:F||null})}cancelSaveBookmark(te,F){te.patchState({saving:!1})}cancelCopyBookmark(te,F){te.patchState({copying:!1})}constructor(te,F,w,X,oe,Y,he,ne,_e,Ce,Be,Ie,Oe){this.store=te,this.actions=F,this.bookmarksService=w,this.imagesService=X,this.storyService=oe,this.exploreService=Y,this.publishService=he,this.organizationsService=ne,this.snackbar=_e,this.vendorAnalyticsService=Ce,this.storageService=Be,this.router=Ie,this.serializeModuleService=Oe}static#e=this.\u0275fac=function(F){return new(F||us)(j.KVO(t.il),j.KVO(t.En),j.KVO(y.x),j.KVO(T.M),j.KVO(A.J),j.KVO(_.z),j.KVO(v.D),j.KVO(r.k),j.KVO(C.UG),j.KVO(G.e),j.KVO(D.n$),j.KVO(Z.Ix),j.KVO(q.g))};static#t=this.\u0275prov=j.jDH({token:us,factory:us.\u0275fac})};M([(0,t.rc)(c.Gr),$("design:type",Function),$("design:paramtypes",[Object,c.Gr]),$("design:returntype",void 0)],ue.prototype,"loadBookmarks",null),M([(0,t.rc)(c.PU),$("design:type",Function),$("design:paramtypes",[Object,c.PU]),$("design:returntype",void 0)],ue.prototype,"loadOrganizationBookmarks",null),M([(0,t.rc)(c.Kf),$("design:type",Function),$("design:paramtypes",[Object,c.Kf]),$("design:returntype",void 0)],ue.prototype,"loadCollectionBookmarks",null),M([(0,t.rc)(c.zX),$("design:type",Function),$("design:paramtypes",[Object,c.zX]),$("design:returntype",void 0)],ue.prototype,"loadSuccess",null),M([(0,t.rc)(c.Xt),$("design:type",Function),$("design:paramtypes",[Object,c.Xt]),$("design:returntype",void 0)],ue.prototype,"selectBookmark",null),M([(0,t.rc)(c.sN),$("design:type",Function),$("design:paramtypes",[Object,c.sN]),$("design:returntype",void 0)],ue.prototype,"selectBookmarkSuccess",null),M([(0,t.rc)(c.iy),$("design:type",Function),$("design:paramtypes",[Object,c.iy]),$("design:returntype",Promise)],ue.prototype,"saveBookmark",null),M([(0,t.rc)(c.x$),$("design:type",Function),$("design:paramtypes",[Object,c.x$]),$("design:returntype",void 0)],ue.prototype,"saveBookmarkSuccess",null),M([(0,t.rc)(c.Ur),$("design:type",Function),$("design:paramtypes",[Object,c.Ur]),$("design:returntype",void 0)],ue.prototype,"saveBookmarkFail",null),M([(0,t.rc)(c.CR),$("design:type",Function),$("design:paramtypes",[Object,c.CR]),$("design:returntype",void 0)],ue.prototype,"deleteBookmark",null),M([(0,t.rc)(c.DN),$("design:type",Function),$("design:paramtypes",[Object,c.DN]),$("design:returntype",void 0)],ue.prototype,"deleteBookmarkSuccess",null),M([(0,t.rc)(c.CF),$("design:type",Function),$("design:paramtypes",[Object,c.CF]),$("design:returntype",void 0)],ue.prototype,"bulkDeleteBookmark",null),M([(0,t.rc)(c.$H),$("design:type",Function),$("design:paramtypes",[Object,c.$H]),$("design:returntype",void 0)],ue.prototype,"bulkDeleteBookmarkComplete",null),M([(0,t.rc)(c.PS),$("design:type",Function),$("design:paramtypes",[Object,c.PS]),$("design:returntype",void 0)],ue.prototype,"bulkDeleteBookmarksError",null),M([(0,t.rc)(c.yH),$("design:type",Function),$("design:paramtypes",[Object,c.yH]),$("design:returntype",void 0)],ue.prototype,"sortBookmarks",null),M([(0,t.rc)(c.B9),$("design:type",Function),$("design:paramtypes",[Object,c.B9]),$("design:returntype",void 0)],ue.prototype,"clearBookmarks",null),M([(0,t.rc)(c.Ri),$("design:type",Function),$("design:paramtypes",[Object,c.Ri]),$("design:returntype",void 0)],ue.prototype,"resetBookmarks",null),M([(0,t.rc)(c.J9),$("design:type",Function),$("design:paramtypes",[Object,c.J9]),$("design:returntype",void 0)],ue.prototype,"checkBookmark",null),M([(0,t.rc)(c.j5),$("design:type",Function),$("design:paramtypes",[Object,c.j5]),$("design:returntype",void 0)],ue.prototype,"setCheckedBookmarks",null),M([(0,t.rc)(c.ov),$("design:type",Function),$("design:paramtypes",[Object,c.ov]),$("design:returntype",void 0)],ue.prototype,"exportBookmarks",null),M([(0,t.rc)(c.Ln),$("design:type",Function),$("design:paramtypes",[Object,c.Ln]),$("design:returntype",void 0)],ue.prototype,"bulkUpdateBookmarkCollections",null),M([(0,t.rc)(c.Pd),$("design:type",Function),$("design:paramtypes",[Object,c.Pd]),$("design:returntype",void 0)],ue.prototype,"updateBookmarkCollections",null),M([(0,t.rc)(c.zP),$("design:type",Function),$("design:paramtypes",[Object,c.zP]),$("design:returntype",void 0)],ue.prototype,"removeBookmarkCollectionSuccess",null),M([(0,t.rc)(c.eW),$("design:type",Function),$("design:paramtypes",[Object,c.eW]),$("design:returntype",void 0)],ue.prototype,"copyBookmark",null),M([(0,t.rc)(c.ZA),$("design:type",Function),$("design:paramtypes",[Object,c.ZA]),$("design:returntype",void 0)],ue.prototype,"copyBookmarks",null),M([(0,t.rc)(c.U8),$("design:type",Function),$("design:paramtypes",[Object,c.U8]),$("design:returntype",void 0)],ue.prototype,"bulkCopyBookmarksComplete",null),M([(0,t.rc)(c.ZW),$("design:type",Function),$("design:paramtypes",[Object,c.ZW]),$("design:returntype",void 0)],ue.prototype,"BulkCopyBookmarksError",null),M([(0,t.rc)(c.zW),$("design:type",Function),$("design:paramtypes",[Object,c.zW]),$("design:returntype",void 0)],ue.prototype,"getBookmarkJobs",null),M([(0,t.rc)(c.Zp),$("design:type",Function),$("design:paramtypes",[Object,c.Zp]),$("design:returntype",void 0)],ue.prototype,"setBookmarkJobs",null),M([(0,t.rc)(c.cK),$("design:type",Function),$("design:paramtypes",[Object,c.cK]),$("design:returntype",void 0)],ue.prototype,"getBookmarkJobsSuccess",null),M([(0,t.rc)(c.I0),$("design:type",Function),$("design:paramtypes",[Object,c.I0]),$("design:returntype",void 0)],ue.prototype,"cancelBookmarkJob",null),M([(0,t.rc)(c.e_),$("design:type",Function),$("design:paramtypes",[Object,c.e_]),$("design:returntype",void 0)],ue.prototype,"setBookmarkText",null),M([(0,t.rc)(c.pE),$("design:type",Function),$("design:paramtypes",[Object,c.pE]),$("design:returntype",void 0)],ue.prototype,"setBookmarkViewMode",null),M([(0,t.rc)(c.a1),$("design:type",Function),$("design:paramtypes",[Object,c.a1]),$("design:returntype",void 0)],ue.prototype,"setSelectedCategory",null),M([(0,t.rc)(c.A),$("design:type",Function),$("design:paramtypes",[Object,c.A]),$("design:returntype",void 0)],ue.prototype,"cancelSaveBookmark",null),M([(0,t.rc)(c.M),$("design:type",Function),$("design:paramtypes",[Object,c.M]),$("design:returntype",void 0)],ue.prototype,"cancelCopyBookmark",null),M([(0,t.MD)(),$("design:type",Function),$("design:paramtypes",[s]),$("design:returntype",void 0)],ue,"getBookmarks",null),M([(0,t.MD)(),$("design:type",Function),$("design:paramtypes",[s]),$("design:returntype",void 0)],ue,"getCheckedBookmarks",null),M([(0,t.MD)(),$("design:type",Function),$("design:paramtypes",[s]),$("design:returntype",void 0)],ue,"getSelectedBookmark",null),M([(0,t.MD)(),$("design:type",Function),$("design:paramtypes",[s]),$("design:returntype",void 0)],ue,"getSelectedBookmarkViewMode",null),M([(0,t.MD)(),$("design:type",Function),$("design:paramtypes",[s]),$("design:returntype",void 0)],ue,"getLoading",null),M([(0,t.MD)(),$("design:type",Function),$("design:paramtypes",[s]),$("design:returntype",void 0)],ue,"getExporting",null),M([(0,t.MD)(),$("design:type",Function),$("design:paramtypes",[s]),$("design:returntype",void 0)],ue,"getSaving",null),M([(0,t.MD)(),$("design:type",Function),$("design:paramtypes",[s]),$("design:returntype",void 0)],ue,"getCopying",null),M([(0,t.MD)(),$("design:type",Function),$("design:paramtypes",[s]),$("design:returntype",void 0)],ue,"getSort",null),M([(0,t.MD)(),$("design:type",Function),$("design:paramtypes",[s]),$("design:returntype",void 0)],ue,"getSelectedCategory",null),M([(0,t.MD)(),$("design:type",Function),$("design:paramtypes",[s]),$("design:returntype",void 0)],ue,"getBookmarkJobs",null),M([(0,t.MD)(),$("design:type",Function),$("design:paramtypes",[s]),$("design:returntype",void 0)],ue,"getActiveBookmarkJob",null),ue=M([(0,t.Uw)({name:"bookmarks",defaults:re}),$("design:paramtypes",[t.il,t.En,y.x,T.M,A.J,_.z,v.D,r.k,C.UG,G.e,D.n$,Z.Ix,q.g])],ue)},15623:(le,N,n)=>{"use strict";n.d(N,{m:()=>e,q:()=>t});var e=function(s){return s[s.XSmall=0]="XSmall",s[s.Small=1]="Small",s[s.Medium=2]="Medium",s[s.Large=3]="Large",s[s.XLarge=4]="XLarge",s}(e||{}),t=function(s){return s[s.Tiny=0]="Tiny",s[s.Small=1]="Small",s[s.Medium=2]="Medium",s}(t||{})},38104:(le,N,n)=>{"use strict";n.d(N,{V:()=>g});var t,p,e=n(92014);(p=t||(t={})).SetHorizontalBreakpoint=(()=>{class v{static#e=this.type="[View] Set Horizontal Breakpoint";constructor(r){this.breakpoint=r}}return v})(),p.SetVerticalBreakpoint=(()=>{class v{static#e=this.type="[View] Set Vertical Breakpoint";constructor(r){this.breakpoint=r}}return v})();var s=n(15623),c=n(99327),O=n(82656),P=n(36110),S=n(21082),a=n(14264),f=n(54438),E=function(p,h,o,v){var _,d=arguments.length,r=d<3?h:null===v?v=Object.getOwnPropertyDescriptor(h,o):v;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(p,h,o,v);else for(var u=p.length-1;u>=0;u--)(_=p[u])&&(r=(d<3?_(r):d>3?_(h,o,r):_(h,o))||r);return d>3&&r&&Object.defineProperty(h,o,r),r},y=function(p,h){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(p,h)};class i{}let g=class ps{static getHorizontalBreakpoint(h){return h.horizontalBreakpoint}static getHorizontalBreakpointLabel(h){return["(max-width: 374px)","(max-width: 599px)","(max-width: 959px)","(max-width: 1439px)","(min-width: 1440px)"][h.horizontalBreakpoint]}static getVerticalBreakpoint(h){return h.verticalBreakpoint}static getVerticalBreakpointLabel(h){return["(max-height: 479px)","(min-height: 480px)","(min-height: 375px)"][h.verticalBreakpoint]}setBreakpoint(h,o){h.patchState({horizontalBreakpoint:o.breakpoint})}setVerticalBreakpoint(h,o){h.patchState({verticalBreakpoint:o.breakpoint})}constructor(h,o){this.breakpointObserver=h,this.store=o}ngxsOnInit(h){this.initHorizontalBreakpointObserver(h),this.initVerticalBreakpointObserver(h)}initHorizontalBreakpointObserver(h){const o=this.breakpointObserver.observe(["(max-width: 374px)"]),v=this.breakpointObserver.observe(["(max-width: 599px)"]),d=this.breakpointObserver.observe(["(max-width: 959px)"]),r=this.breakpointObserver.observe(["(max-width: 1439px)"]),_=this.breakpointObserver.observe(["(min-width: 1440px)"]);(0,O.z)([o,v,d,r,_]).pipe((0,P.T)(([u,l,m,C,b])=>u.matches?s.m.XSmall:l.matches?s.m.Small:m.matches?s.m.Medium:C.matches?s.m.Large:b.matches?s.m.XLarge:null),(0,S.F)(),(0,a.p)(u=>null!=u)).subscribe(u=>{h.dispatch(new t.SetHorizontalBreakpoint(u))})}initVerticalBreakpointObserver(h){const o=this.breakpointObserver.observe(["(max-height: 374px)"]),v=this.breakpointObserver.observe(["(max-height: 479px)"]),d=this.breakpointObserver.observe(["(min-height: 480px)"]);(0,O.z)([o,v,d]).pipe((0,P.T)(([r,_,u])=>r.matches?s.q.Tiny:_.matches?s.q.Small:u.matches?s.q.Medium:null),(0,S.F)(),(0,a.p)(r=>null!=r)).subscribe(r=>{h.dispatch(new t.SetVerticalBreakpoint(r))})}static#e=this.\u0275fac=function(o){return new(o||ps)(f.KVO(c.QP),f.KVO(e.il))};static#t=this.\u0275prov=f.jDH({token:ps,factory:ps.\u0275fac})};E([(0,e.rc)(t.SetHorizontalBreakpoint),y("design:type",Function),y("design:paramtypes",[Object,t.SetHorizontalBreakpoint]),y("design:returntype",void 0)],g.prototype,"setBreakpoint",null),E([(0,e.rc)(t.SetVerticalBreakpoint),y("design:type",Function),y("design:paramtypes",[Object,t.SetVerticalBreakpoint]),y("design:returntype",void 0)],g.prototype,"setVerticalBreakpoint",null),E([(0,e.MD)(),y("design:type",Function),y("design:paramtypes",[i]),y("design:returntype",void 0)],g,"getHorizontalBreakpoint",null),E([(0,e.MD)(),y("design:type",Function),y("design:paramtypes",[i]),y("design:returntype",void 0)],g,"getHorizontalBreakpointLabel",null),E([(0,e.MD)(),y("design:type",Function),y("design:paramtypes",[i]),y("design:returntype",void 0)],g,"getVerticalBreakpoint",null),E([(0,e.MD)(),y("design:type",Function),y("design:paramtypes",[i]),y("design:returntype",void 0)],g,"getVerticalBreakpointLabel",null),g=E([(0,e.Uw)({name:"breakpoint",defaults:{horizontalBreakpoint:null,verticalBreakpoint:null}}),y("design:paramtypes",[c.QP,e.il])],g)},22346:(le,N,n)=>{"use strict";n.d(N,{K:()=>f});var e=n(60177),t=n(54438),s=n(38645),c=n(73845);const O=["featuredCard"];function P(E,y){if(1&E&&(t.j41(0,"div",8),t.EFF(1),t.k0s()),2&E){const i=t.XpG();t.R7$(),t.JRh(i.subtitle())}}function S(E,y){if(1&E&&(t.j41(0,"div",9),t.EFF(1),t.k0s()),2&E){const i=t.XpG();t.R7$(),t.JRh(i.metadata())}}function a(E,y){if(1&E&&(t.j41(0,"figure",10),t.nrm(1,"img",11),t.k0s()),2&E){const i=t.XpG();t.R7$(),t.Y8G("lazyLoad",i.featuredIcon())}}let f=(()=>{class E{constructor(){this.defaultImage="/assets/images/card-thumbnail-placeholder.png",this.title=t.hFB.required(),this.subtitle=(0,t.hFB)(),this.metadata=(0,t.hFB)(),this.image=(0,t.hFB)(),this.featuredIcon=(0,t.hFB)(),this.colorOnHover=(0,t.hFB)(!1),this.routerLink=(0,t.hFB)(),this.queryParams=(0,t.hFB)(),this.innerColor=(0,t.hFB)(),this.outerColor=(0,t.hFB)(),this.foreground=(0,t.hFB)("white"),this.gradientColor=(0,t.EWP)(()=>`radial-gradient(${this.innerColor()}, ${this.outerColor()})`),(0,t.QZP)(()=>{this.colorOnHover()?this.removeColorFromCard():this.applyColorToCard()})}onMouseEnter(){this.colorOnHover()&&this.applyColorToCard()}onMouseLeave(){this.colorOnHover()&&this.removeColorFromCard()}applyColorToCard(){this.featuredCardElement.nativeElement.style.setProperty("--background",this.gradientColor()),this.featuredCardElement.nativeElement.style.setProperty("--foreground",this.foreground()),this.colorOnHover()&&this.featuredCardElement.nativeElement.style.setProperty("--border",this.outerColor())}removeColorFromCard(){this.featuredCardElement.nativeElement.style.setProperty("--background","white"),this.featuredCardElement.nativeElement.style.setProperty("--foreground","#1c2a3f"),this.colorOnHover()&&this.featuredCardElement.nativeElement.style.setProperty("--border","#d7e0ea")}static#e=this.\u0275fac=function(g){return new(g||E)};static#t=this.\u0275cmp=t.VBU({type:E,selectors:[["app-featured-card"]],viewQuery:function(g,p){if(1&g&&t.GBs(O,7),2&g){let h;t.mGM(h=t.lsd())&&(p.featuredCardElement=h.first)}},inputs:{title:[1,"title"],subtitle:[1,"subtitle"],metadata:[1,"metadata"],image:[1,"image"],featuredIcon:[1,"featuredIcon"],colorOnHover:[1,"colorOnHover"],routerLink:[1,"routerLink"],queryParams:[1,"queryParams"],innerColor:[1,"innerColor"],outerColor:[1,"outerColor"],foreground:[1,"foreground"]},standalone:!0,features:[t.aNF],decls:12,vars:8,consts:[["featuredCard",""],[1,"@container","featured-card"],[1,"flex","w-full","rounded-lg","cursor-pointer","h-24","@xs:h-48",3,"mouseenter","mouseleave","routerLink","queryParams"],[1,"rounded-l-lg","hidden","@lg:block","h-48","w-48",3,"defaultImage","lazyLoad"],[1,"flex","flex-col","justify-between","h-full","w-full","p-4","@xs:p-8"],[1,"text-xs","@xs:text-lg","font-semibold"],[1,"flex","gap-3"],[1,"flex","flex-col","flex-grow","gap-2"],[1,"text-2xs","@xs:text-sm","font-normal","@xs:font-semibold"],[1,"hidden","@xs:block","text-2xs","@xs:text-sm","font-normal"],[1,"rounded","bg-white","min-w-8","min-h-8","w-8","h-8","items-center","justify-center","justify-self-end","self-end","hidden","@xs:flex"],[3,"lazyLoad"]],template:function(g,p){if(1&g){const h=t.RV6();t.j41(0,"div",1,0)(2,"a",2),t.bIt("mouseenter",function(){return t.eBV(h),t.Njj(p.onMouseEnter())})("mouseleave",function(){return t.eBV(h),t.Njj(p.onMouseLeave())}),t.nrm(3,"img",3),t.j41(4,"div",4)(5,"h1",5),t.EFF(6),t.k0s(),t.j41(7,"div",6)(8,"div",7),t.DNE(9,P,2,1,"div",8)(10,S,2,1,"div",9),t.k0s(),t.DNE(11,a,2,1,"figure",10),t.k0s()()()()}2&g&&(t.R7$(2),t.Y8G("routerLink",p.routerLink())("queryParams",p.queryParams()),t.R7$(),t.Y8G("defaultImage",p.defaultImage)("lazyLoad",p.image()),t.R7$(3),t.SpI(" ",p.title()," "),t.R7$(3),t.vxM(p.subtitle()?9:-1),t.R7$(),t.vxM(p.metadata()?10:-1),t.R7$(),t.vxM(p.featuredIcon()?11:-1))},dependencies:[e.MD,s.iI,s.Wk,c.Un,c.Je],styles:[".featured-card[_ngcontent-%COMP%]{--background: white;--foreground: #1c2a3f;--border: transparent}.featured-card[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{background:var(--background);color:var(--foreground);outline:1px solid var(--border)!important}"],changeDetection:0})}return E})()},40819:(le,N,n)=>{"use strict";n.d(N,{l:()=>k});var e=n(58743),t=n(65776),s=n(13976),c=n(60177),O=n(56592),P=n(34882),S=n(36204),a=n(86008),E=(n(71441),n(7431)),y=n(62751),i=n(15185),g=n(54438),p=n(92014);function h(V,W){if(1&V){const T=g.RV6();g.j41(0,"li",1)(1,"button",2),g.bIt("click",function(){const z=g.eBV(T).$implicit,I=g.XpG();return g.Njj(I.handlePositionClick(z))}),g.j41(2,"div",3),g.nrm(3,"app-thumbnail-view",4),g.k0s(),g.j41(4,"div",5),g.EFF(5),g.k0s()()()}if(2&V){const T=W.$implicit;g.R7$(3),g.Y8G("thumbnail",T.thumbnail),g.R7$(2),g.JRh(T.title)}}let o=(()=>{class V{constructor(T){this.store=T}handlePositionClick(T){this.store.dispatch(new E.Ih(T.camera.location,T.camera.action===y.L.FlyTo,void 0,T.camera.rotationCenter))}static#e=this.\u0275fac=function(x){return new(x||V)(g.rXU(p.il))};static#t=this.\u0275cmp=g.VBU({type:V,selectors:[["app-position-block"]],inputs:{positionBlock:"positionBlock"},standalone:!0,features:[g.aNF],decls:3,vars:0,consts:[[1,"view-positions"],[1,"view-positions__list-item"],[1,"view-positions__item",3,"click"],[1,"view-positions__thumbnail"],[3,"thumbnail"],[1,"view-positions__title"]],template:function(x,z){1&x&&(g.j41(0,"ul",0),g.Z7z(1,h,6,2,"li",1,g.Vm6),g.k0s()),2&x&&(g.R7$(),g.Dyx(z.positionBlock.positions))},dependencies:[i.J],styles:[".view-positions__list-item[_ngcontent-%COMP%]{padding-bottom:8px}.view-positions__item[_ngcontent-%COMP%]{background:none;border:0;display:flex;padding:12px 12px 12px 16px;cursor:pointer;transition:background-color 125ms,color 125ms,border 125ms;width:100%;gap:12px;text-align:start;align-items:center}.view-positions__item[_ngcontent-%COMP%]:focus{outline:#2d72dc solid 2px!important}.view-positions__item[_ngcontent-%COMP%]:hover, .view-positions__item--selected[_ngcontent-%COMP%]:hover{background-color:#131c2a0d}.view-positions__item--selected[_ngcontent-%COMP%]   .view-positions__title[_ngcontent-%COMP%]{font-weight:600}.view-positions__thumbnail[_ngcontent-%COMP%]{flex:0 0 56px;height:56px;width:56px;margin-inline-end:12px;border:1px solid #eaeff5;border-radius:4px}.view-positions__title[_ngcontent-%COMP%]{color:#131c2a;font-size:.875rem;line-height:1.25rem;word-break:break-word}"],changeDetection:0})}return V})();var v=n(77778);function d(V,W){return this.trackContentBlock}function r(V,W){if(1&V&&g.nrm(0,"app-ticker-block",6),2&V){const T=g.XpG(2).$implicit;g.Y8G("tickerBlock",T)}}function _(V,W){if(1&V&&g.DNE(0,r,1,1,"app-ticker-block",6),2&V){const T=g.XpG().$implicit,x=g.XpG(2);g.vxM(x.isTickerBlockEnabled(T)?0:-1)}}function u(V,W){if(1&V&&g.nrm(0,"app-markdown-block",1),2&V){const T=g.XpG().$implicit,x=g.XpG(2);g.Y8G("markdownBlock",T)("layout",x.layout)}}function l(V,W){if(1&V&&g.nrm(0,"app-images-block",2),2&V){const T=g.XpG().$implicit,x=g.XpG(2);g.Y8G("imagesBlock",T)("layout",x.layout)}}function m(V,W){if(1&V&&g.nrm(0,"app-images-block",2),2&V){const T=g.XpG().$implicit,x=g.XpG(2);g.Y8G("imagesBlock",T)("layout",x.layout)}}function C(V,W){if(1&V&&g.nrm(0,"app-videos-block",3),2&V){const T=g.XpG().$implicit,x=g.XpG(2);g.Y8G("videosBlock",T)("layout",x.layout)}}function b(V,W){if(1&V&&g.nrm(0,"app-position-block",4),2&V){const T=g.XpG().$implicit;g.Y8G("positionBlock",T)}}function R(V,W){if(1&V&&g.nrm(0,"app-cta-block",5),2&V){const T=g.XpG().$implicit;g.Y8G("ctaBlock",T)}}function A(V,W){if(1&V&&(g.j41(0,"div"),g.DNE(1,_,1,1)(2,u,1,2,"app-markdown-block",1)(3,l,1,2,"app-images-block",2)(4,m,1,2,"app-images-block",2)(5,C,1,2,"app-videos-block",3)(6,b,1,1,"app-position-block",4)(7,R,1,1,"app-cta-block",5),g.k0s()),2&V){let T;const x=W.$implicit,z=W.$index,I=g.XpG(2);g.AVh("mt-6",z>0),g.R7$(),g.vxM((T=x.type)===I.contentBlockTypes.Ticker?1:T===I.contentBlockTypes.Markdown?2:T===I.contentBlockTypes.Images?3:T===I.contentBlockTypes.AnimatedImages?4:T===I.contentBlockTypes.Videos?5:T===I.contentBlockTypes.Positions?6:T===I.contentBlockTypes.CTA?7:-1)}}function G(V,W){if(1&V&&g.Z7z(0,A,8,3,"div",0,d,!0),2&V){const T=g.XpG();g.Dyx(T.contentBlocks)}}let k=(()=>{class V{get contentBlocks(){return this.contentBlocksService.filterContentBlocksByType(this._contentBlocks,this.include,this.exclude)}set contentBlocks(T){this._contentBlocks=T}constructor(T){this.contentBlocksService=T,this.contentBlockTypes=t.m,this._contentBlocks=[],this.layout=e.j.Normal,this.include=[],this.exclude=[]}isTickerBlockEnabled(T){return T?.enable}trackContentBlock(T,x){return x.type}static#e=this.\u0275fac=function(x){return new(x||V)(g.rXU(s.V))};static#t=this.\u0275cmp=g.VBU({type:V,selectors:[["app-content-blocks"]],inputs:{contentBlocks:"contentBlocks",layout:"layout",include:"include",exclude:"exclude"},standalone:!0,features:[g.aNF],decls:1,vars:1,consts:[[3,"mt-6"],[3,"markdownBlock","layout"],[3,"imagesBlock","layout"],[3,"videosBlock","layout"],[3,"positionBlock"],[3,"ctaBlock"],[3,"tickerBlock"]],template:function(x,z){1&x&&g.DNE(0,G,2,0),2&x&&g.vxM(z.contentBlocks.length>0?0:-1)},dependencies:[c.MD,O.p,P.y,S.Z,a.V,o,v.B],encapsulation:2,changeDetection:0})}return V})()},46075:(le,N,n)=>{"use strict";n.d(N,{C6:()=>S,CC:()=>f,Sq:()=>s,U6:()=>P,rh:()=>i,tR:()=>p,vb:()=>a,zV:()=>y});var e=n(49204),s=function(h){return h.Audio="audio",h.Image="image",h.AnimatedImage="animatedImage",h.Video="video",h}(s||{});const c={[s.Image]:15*Math.pow(1024,2),[s.AnimatedImage]:10*Math.pow(1024,2),[s.Audio]:50*Math.pow(1024,2),[s.Video]:2*Math.pow(1024,3)},O={[s.Image]:void 0,[s.AnimatedImage]:15,[s.Audio]:void 0,[s.Video]:void 0};function P(h){if(0===h)return"0 Byte";const v=Math.floor(Math.log(h)/Math.log(1024));return Math.round(h/Math.pow(1024,v))+" "+["Bytes","KB","MB","GB","TB"][v]}function S(h){let o="";return h&&(o=`${h} secs`),o}const a={[s.Audio]:"/ws/media/audio/upload",[s.Image]:"/ws/media/images/upload",[s.AnimatedImage]:"/ws/media/gifs/upload",[s.Video]:""},f={".svg":["image/svg+xml"],".jpg":["image/jpeg"],".jpeg":["image/jpeg"],".png":["image/png"],".aac":["audio/aac"],".m4a":["audio/mp4","audio/x-m4a"],".mp3":["audio/mpeg"],".webm":["video/webm"],".mpg":["video/mpeg"],".mp2":["video/mpeg"],".mpeg":["video/mpeg"],".mpe":["video/mpeg"],".mpv":["video/x-mpv"],".ogg":["video/ogg"],".mp4":["video/mp4"],".m4p":["video/mp4","video/x-m4p"],".m4v":["video/mp4","video/x-m4v"],".avi":["video/x-msvideo"],".wmv":["video/x-ms-wmv"],".mov":["video/quicktime"],".qt":["video/quicktime"],".flv":["video/x-flv"],".swf":["application/x-shockwave-flash"],".mpd":["application/dash+xml"],".m3u8":["application/x-mpegURL"],".webp":["image/webp"]},E={[s.Audio]:[".aac",".m4a",".mp3"],[s.Image]:[".png",".jpg",".jpeg",".svg"],[s.AnimatedImage]:[".webp",".mov",".mp4",".webm"],[s.Video]:[".webm",".mpg",".mp2",".mpeg",".mpe",".mpv",".ogg",".mp4",".m4p",".m4v",".avi",".wmv",".mov",".qt",".flv",".swf"]};function y(h){return[...E[h]||[]]}function i(h){const v=y(h).map(d=>function g(h){return[...f[h]||[]]}(d));return[].concat(...v)}function p(h){const o=i(h),v=c[h],d=O[h];return{concurrency:1,allowedContentTypes:o,...(0,e.isNil)(v)?{}:{maxFileSize:v},maxLength:d}}},13403:(le,N,n)=>{"use strict";n.d(N,{j:()=>a});var e=n(60177),t=n(27878),s=n(21604),c=n(39685),O=n(45189),P=n(67575),S=n(54438);let a=(()=>{class f{static#e=this.\u0275fac=function(i){return new(i||f)};static#t=this.\u0275mod=S.$C({type:f});static#n=this.\u0275inj=S.G2t({imports:[e.MD,s.G,O.G,P.PO,c.y,t.wR]})}return f})()},77778:(le,N,n)=>{"use strict";n.d(N,{B:()=>y});var e=n(54438),t=n(83403),s=n(89079),c=n(32724),O=n(89511),P=n(92014),S=n(25780);function a(i,g){if(1&i&&(e.j41(0,"a",0),e.EFF(1),e.k0s()),2&i){const p=e.XpG();e.Y8G("href",p.ctaBlock().url,e.B4B),e.R7$(),e.SpI(" ",p.ctaBlock().label||p.ctaBlock().url," ")}}function f(i,g){if(1&i&&e.nrm(0,"app-view-xr-button",1),2&i){const p=e.XpG(2);e.Y8G("mode","ar")("title",p.ctaBlock().label)("modelUrl",p.ctaBlock().url)("transparent",!1)("bordered",!0)("compact",!0)}}function E(i,g){if(1&i&&e.DNE(0,f,1,6,"app-view-xr-button",1),2&i){const p=e.XpG();e.vxM(p.nativeAREnabled()?0:-1)}}let y=(()=>{class i{constructor(p){this.store=p,this.nativeAREnabled=(0,s.ot)(this.store.select(c.U.getNativeAREnabled)),this.ctaBlock=e.hFB.required()}static#e=this.\u0275fac=function(h){return new(h||i)(e.rXU(P.il))};static#t=this.\u0275cmp=e.VBU({type:i,selectors:[["app-cta-block"]],inputs:{ctaBlock:[1,"ctaBlock"]},standalone:!0,features:[e.aNF],decls:2,vars:1,consts:[["appEventFence","","target","_blank","rel","noreferrer nofollow",1,"block","px-4","py-3","text-center","bg-white","border","border-gray-200","border-solid","rounded","text-gray-950","visited:text-gray-950",3,"href"],[3,"mode","title","modelUrl","transparent","bordered","compact"]],template:function(h,o){if(1&h&&e.DNE(0,a,2,2,"a",0)(1,E,1,1),2&h){let v;e.vxM("link"===(v=o.ctaBlock().action)?0:"ar-link"===v?1:-1)}},dependencies:[t.R,O.h,S.L],encapsulation:2,changeDetection:0})}return i})()},36204:(le,N,n)=>{"use strict";n.d(N,{Z:()=>C});var e=n(28407),t=n(54438),c=(n(44334),n(58743)),O=n(49204),S=n(13976),a=n(95419),f=n(60177),E=n(14823),y=n(11818),i=n(72026),g=n(26621),p=n(70914),h=n(26779),o=n(65985);function v(b,R){if(1&b&&(t.j41(0,"div",9),t.nrm(1,"app-image-view",10),t.k0s()),2&b){const A=t.XpG(3);t.AVh("mb-3",A.currentImage().caption),t.R7$(),t.Y8G("src",A.currentImage().urls.small)("fullscreenSrc",A.currentImage().urls.default)("alt",A.currentImage().alt)("fit",A.fit)("fitSize",A.fitSize)}}function d(b,R){1&b&&(t.j41(0,"div",8)(1,"div",11),t.pXf(2,0),t.k0s(),t.j41(3,"div",12),t.pXf(4,1),t.k0s()())}function r(b,R){if(1&b&&t.DNE(0,v,2,7,"div",7)(1,d,5,0,"div",8),2&b){const A=t.XpG(2);t.vxM(!0===A.currentImage().transcoded?0:!1===A.currentImage().transcoded?1:-1)}}function _(b,R){if(1&b&&t.nrm(0,"app-html",13),2&b){const A=t.XpG(2);t.Y8G("markdownText",A.currentImage().caption)}}function u(b,R){if(1&b){const A=t.RV6();t.j41(0,"div",14)(1,"button",15),t.bIt("click",function(){t.eBV(A);const k=t.XpG(2);return t.Njj(k.handlePrevClick())}),t.nrm(2,"app-icon",16),t.k0s(),t.j41(3,"button",17),t.bIt("click",function(){t.eBV(A);const k=t.XpG(2);return t.Njj(k.handleNextClick())}),t.nrm(4,"app-icon",18),t.k0s()()}}function l(b,R){if(1&b&&(t.j41(0,"div",3)(1,"div",4),t.DNE(2,r,2,1)(3,_,1,1,"app-html",5)(4,u,5,0,"div",6),t.k0s()()),2&b){const A=t.XpG();t.HbH("images-block--"+A.layout),t.AVh("images-block--slideshow",A.images&&A.images.length>1),t.R7$(2),t.vxM(A.currentImage().urls?2:-1),t.R7$(),t.Y8G("ngIf",A.currentImage().caption),t.R7$(),t.Y8G("ngIf",A.images.length>1)}}let C=(()=>{class b{get imagesBlock(){return this._imagesBlock}set imagesBlock(A){this._imagesBlock=A;const G=(0,O.get)(A,"images",[]).map(k=>{const V=this.contentBlocksService.isImageBlock(this.imagesBlock),W=(0,t.vPA)({...k,transcoded:V||void 0});return V||this.checkTranscodingStatus(W),W});G.length&&(this.images=G,this.currentImage=this.images[0])}get fit(){return"compact"===this.layout?"auto":"normal"}get fitSize(){return"compact"===this.layout?100:void 0}constructor(A,G){this.contentBlocksService=A,this.mediaService=G,this.currentImage=(0,t.vPA)(null),this.layout=c.j.Normal}handlePrevClick(){let A=this.getCurrentImageIndex();A--,A<0&&(A=this.images.length-1),this.currentImage=this.images[A]}handleNextClick(){let A=this.getCurrentImageIndex();A++,A>=this.images.length&&(A=0),this.currentImage=this.images[A]}getCurrentImageIndex(){return this.images.indexOf(this.currentImage)}checkTranscodingStatus(A){var G=this;return(0,e.A)(function*(){const k=yield G.mediaService.checkAnimatedImageStatus(A().urls.default);A.set({...A(),transcoded:k})})()}static#e=this.\u0275fac=function(G){return new(G||b)(t.rXU(S.V),t.rXU(a.u))};static#t=this.\u0275cmp=t.VBU({type:b,selectors:[["app-images-block"]],inputs:{imagesBlock:"imagesBlock",layout:"layout"},standalone:!0,features:[t.aNF],decls:1,vars:1,consts:()=>{let A,G,k,V,W,T;return A=$localize`:e58ec8a32823536140cecc28fb83731389a6bdd64428081059558168074:Processing...`,G=$localize`:d42c9f0fedd02c63f5c7c427be1d009a60bc222a1933294937220675094:Please check back in a few minutes for updates.`,k=$localize`:bff50c5768e60557928b77318e5dbeff17952bfe338174691477444439:Previous Image`,V=$localize`:bff50c5768e60557928b77318e5dbeff17952bfe338174691477444439:Previous Image`,W=$localize`:e1c872c4f9394cb6870bf82b7227481e47eaa8414885809904292086423:Next Image`,T=$localize`:e1c872c4f9394cb6870bf82b7227481e47eaa8414885809904292086423:Next Image`,[A,G,["class","images-block","data-test","images-block",3,"class","images-block--slideshow",4,"ngIf"],["data-test","images-block",1,"images-block"],[1,"images-block__content"],["class","images-block__caption",3,"markdownText",4,"ngIf"],["class","images-block__actions",4,"ngIf"],[1,"images-block__image-container",3,"mb-3"],[1,"images-block__image-processing"],[1,"images-block__image-container"],[1,"images-block__image-view",3,"src","fullscreenSrc","alt","fit","fitSize"],[1,"text-xs","font-semibold"],[1,"mt-1","text-2xs"],[1,"images-block__caption",3,"markdownText"],[1,"images-block__actions"],["type","button","app-view-button","","buttonSize","sm","matTooltip",k,"aria-label",V,3,"click"],["icon","chevron-left"],["type","button","app-view-button","","buttonSize","sm","matTooltip",W,"aria-label",T,3,"click"],["icon","chevron-right"]]},template:function(G,k){1&G&&t.DNE(0,l,5,7,"div",2),2&G&&t.Y8G("ngIf",k.currentImage)},dependencies:[f.MD,f.bT,i.o,h.R,y.C,o.ri,E.uc,E.oV,p.V,g.o],styles:[".images-block__header{display:flex;align-items:center;justify-content:space-between;margin-bottom:16px}.images-block__image-processing{display:flex;align-items:center;justify-content:center;flex-direction:column;text-align:center;background-color:#fff;border:1px solid #96a8c0;border-radius:4px;padding:0 20px;aspect-ratio:16/9;color:#374a68}.images-block__label{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase;color:#374a68;font-weight:600;display:flex;align-items:center;min-height:28px}.images-block__image-container{display:flex;justify-content:center;background-color:#f9fafd}.images-block__image-view{display:flex;height:100%;min-height:32px}.images-block__caption{font-size:12px;margin-top:12px}.images-block__actions{display:flex;justify-content:flex-end;margin-top:14px}.images-block--slideshow .images-block__image-container{height:200px}\n"],encapsulation:2,changeDetection:0})}return b})()},34882:(le,N,n)=>{"use strict";n.d(N,{y:()=>P}),n(65776);var s=n(58743),c=n(70914),O=n(54438);let P=(()=>{class S{constructor(){this.layout=s.j.Normal}ngOnInit(){}static#e=this.\u0275fac=function(E){return new(E||S)};static#t=this.\u0275cmp=O.VBU({type:S,selectors:[["app-markdown-block"]],inputs:{markdownBlock:"markdownBlock",layout:"layout"},standalone:!0,features:[O.aNF],decls:2,vars:1,consts:[[1,"markdown-block"],[3,"markdownText"]],template:function(E,y){1&E&&(O.j41(0,"div",0),O.nrm(1,"app-html",1),O.k0s()),2&E&&(O.R7$(),O.Y8G("markdownText",y.markdownBlock.markdown))},dependencies:[c.V],encapsulation:2,changeDetection:0})}return S})()},47605:(le,N,n)=>{"use strict";n.d(N,{Q:()=>R});var e=n(60177),t=n(92014),s=n(49204),O=n(35286),P=n(85052),S=n(76718),a=n(2573),f=n(14264),E=n(37925),y=n(12347),i=n(79805),g=n(515),p=n(76304),h=n(94495),o=n(54438),v=function(A,G,k,V){var x,W=arguments.length,T=W<3?G:null===V?V=Object.getOwnPropertyDescriptor(G,k):V;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)T=Reflect.decorate(A,G,k,V);else for(var z=A.length-1;z>=0;z--)(x=A[z])&&(T=(W<3?x(T):W>3?x(G,k,T):x(G,k))||T);return W>3&&T&&Object.defineProperty(G,k,T),T},d=function(A,G){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(A,G)};const r=["image"],_=["imagePre"],u=["imagePost"],l=["imageContainer"];function m(A,G){if(1&A&&(o.nrm(0,"div",5),o.nI1(1,"markdown"),o.nI1(2,"async")),2&A){const k=o.XpG();o.Y8G("innerHTML",o.bMT(2,3,o.bMT(1,1,k.label)),o.npT)}}function C(A,G){if(1&A&&o.nrm(0,"img",7,2),2&A){const k=o.XpG();o.Y8G("src",k.imageUrl,o.B4B)}}function b(A,G){if(1&A&&o.nrm(0,"img",8,3),2&A){const k=o.XpG();o.Y8G("src",k.imageUrl,o.B4B)}}class R{constructor(G,k,V,W){this.renderer=G,this.engineService=k,this.animationService=V,this.store=W,this.ngUnsubscribe=new P.B,this.loopImage=!1}ngOnInit(){this.initChapterListener(),this.initTimelineListener()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initChapterListener(){this.chapterReadyState$.pipe((0,f.p)(G=>!!G.animation),(0,E.Q)(this.ngUnsubscribe)).subscribe(()=>{this.timerange=this.animationService.getChapterTimeFrame()})}initTimelineListener(){(0,S.h)(this.engineService.getEvent(g.X.TimelineScrubbed),this.engineService.getEvent(g.X.TimelinePlaying)).pipe((0,E.Q)(this.ngUnsubscribe)).subscribe(G=>{const k=this.getChapterPercent();this.moveImage(k)})}handleClick(G){const k=this.store.selectSnapshot(p.S.getAnimationPlaying);k&&this.animationService.pause(),this.scrub(G),setTimeout(()=>{k&&this.animationService.unpause()})}scrub(G){if(G.currentTarget instanceof HTMLElement){const k=G.currentTarget.getBoundingClientRect(),T=this.timerange.lastTime-this.timerange.firstTime,z=(G.clientX-k.left-k.width/2)*(T/this.getImageWidth());let I=this.animationService.getTime()+z;this.loopImage&&(I<0?I=T+I:I>T&&(I-=T)),I>=0&&I<=T&&this.animationService.scrub(I)}}moveImage(G){const k=this.getImageWidth();this.renderer.setStyle(this.imageContainer.nativeElement,"transform",`translate(${G/100*-k}px, 0)`),this.loopImage&&(this.renderer.setStyle(this.imagePre.nativeElement,"transform",`translate(${-k}px, 0)`),this.renderer.setStyle(this.imagePost.nativeElement,"transform",`translate(${k}px, 0)`))}getImageWidth(){return this.image.nativeElement.getBoundingClientRect().width}getChapterPercent(){if((0,s.isNil)(this.timerange))return 0;const{firstTime:G,lastTime:k}=this.timerange,V=this.animationService.getTime();return Math.max(G,Math.min(V,k))/k*100}static#e=this.\u0275fac=function(k){return new(k||R)(o.rXU(o.sFG),o.rXU(i.y),o.rXU(y.O),o.rXU(t.il))};static#t=this.\u0275cmp=o.VBU({type:R,selectors:[["app-ticker-block-item"]],viewQuery:function(k,V){if(1&k&&(o.GBs(r,7),o.GBs(_,5),o.GBs(u,5),o.GBs(l,7)),2&k){let W;o.mGM(W=o.lsd())&&(V.image=W.first),o.mGM(W=o.lsd())&&(V.imagePre=W.first),o.mGM(W=o.lsd())&&(V.imagePost=W.first),o.mGM(W=o.lsd())&&(V.imageContainer=W.first)}},inputs:{label:"label",imageUrl:"imageUrl",loopImage:"loopImage"},standalone:!0,features:[o.aNF],decls:8,vars:4,consts:[["imageContainer",""],["image",""],["imagePre",""],["imagePost",""],[1,"ticker-block-item",3,"click"],[1,"ticker-block-item__label","html",3,"innerHTML"],[1,"ticker-block-item__image-container"],[1,"ticker-block-item__image","ticker-block-item__image--pre",3,"src"],[1,"ticker-block-item__image","ticker-block-item__image--post",3,"src"],[1,"ticker-block-item__image",3,"src"]],template:function(k,V){if(1&k){const W=o.RV6();o.j41(0,"div",4),o.bIt("click",function(x){return o.eBV(W),o.Njj(V.handleClick(x))}),o.DNE(1,m,3,5,"div",5),o.j41(2,"div",6,0),o.DNE(4,C,2,1,"img",7)(5,b,2,1,"img",8),o.nrm(6,"img",9,1),o.k0s()()}2&k&&(o.R7$(),o.vxM(V.label?1:-1),o.R7$(3),o.vxM(V.loopImage?4:-1),o.R7$(),o.vxM(V.loopImage?5:-1),o.R7$(),o.Y8G("src",V.imageUrl,o.B4B))},dependencies:[e.MD,e.Jj,O.y2,O.i0],styles:['.ticker-block-item[_ngcontent-%COMP%]{--label-height: 24px;background:#f9fafd;background:linear-gradient(90deg,#f9fafd 20%,#fff0,#fff,#f9fafd 80%);overflow:hidden;padding-left:50%;position:relative;cursor:pointer}.ticker-block-item[_ngcontent-%COMP%]:hover   .ticker-block-item__label[_ngcontent-%COMP%]{background:#ffffffe6}.ticker-block-item[_ngcontent-%COMP%]:after{content:"";display:block;position:absolute;left:50%;top:0;height:100%;width:1px;background:red;box-shadow:0 0 0 4px #f003;z-index:10}.ticker-block-item__label[_ngcontent-%COMP%]{position:absolute;height:var(--label-height);left:0;top:0;width:100%;display:flex;align-items:center;font-size:12px;z-index:10;background:#ffffff8c}.ticker-block-item__image-container[_ngcontent-%COMP%]{position:relative;margin-top:var(--label-height);pointer-events:none;-webkit-user-select:none;user-select:none}.ticker-block-item__image[_ngcontent-%COMP%]{display:block;max-width:none}.ticker-block-item__image--pre[_ngcontent-%COMP%], .ticker-block-item__image--post[_ngcontent-%COMP%]{position:absolute;top:0;left:0}'],changeDetection:0})}v([(0,t.l6)(p.S.getAnimationPlaying),d("design:type",a.c)],R.prototype,"animationPlaying$",void 0),v([(0,t.l6)(h.N.getSelectedChapterReadyState),d("design:type",a.c)],R.prototype,"chapterReadyState$",void 0)},56592:(le,N,n)=>{"use strict";n.d(N,{p:()=>r});var e=n(92014),t=n(85052),s=n(2573),O=(n(31462),n(47610)),P=n(76304),S=n(11818),a=n(72026),f=n(47605),E=n(60177),y=n(54438),i=n(65985),g=n(26779);const o=["guideline"];function v(_,u){if(1&_&&y.nrm(0,"app-ticker-block-item",4),2&_){const l=u.$implicit,m=y.XpG(2);y.Y8G("imageUrl",l.urls.default)("label",l.caption)("loopImage",m.tickerBlock.loopImage)}}function d(_,u){if(1&_){const l=y.RV6();y.j41(0,"div",2)(1,"div",3),y.bIt("mouseenter",function(){y.eBV(l);const C=y.XpG();return y.Njj(C.handleMouseEnter())})("mouseleave",function(){y.eBV(l);const C=y.XpG();return y.Njj(C.handleMouseLeave())})("mousemove",function(C){y.eBV(l);const b=y.XpG();return y.Njj(b.handleMouseMove(C))}),y.Z7z(2,v,1,3,"app-ticker-block-item",4,y.Vm6),y.nrm(4,"div",5,0),y.k0s(),y.j41(6,"button",6),y.bIt("click",function(){y.eBV(l);const C=y.XpG();return y.Njj(C.handlePlayClick())}),y.j41(7,"span",7),y.EFF(8),y.nI1(9,"async"),y.k0s(),y.nrm(10,"app-icon",8),y.nI1(11,"async"),y.j41(12,"span",9),y.pXf(13,1),y.nI1(14,"async"),y.k0s()()()}if(2&_){const l=y.XpG();y.R7$(2),y.Dyx(l.tickerBlock.images),y.R7$(6),y.JRh(l.getAnimationPlayingTooltip(y.bMT(9,3,l.animationPlaying$))),y.R7$(2),y.Y8G("icon",y.bMT(11,5,l.animationPlaying$)?"pause":"play"),y.R7$(4),y.uP7(y.bMT(14,7,l.animationPlaying$)?"Pause":"Play"),y.nnv(13)}}class r{constructor(u,l){this.store=u,this.renderer=l,this.ngUnsubscribe=new t.B}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}handlePlayClick(){const u=this.store.selectSnapshot(P.S.getAnimationPlaying);this.store.dispatch(new O.dE(!u))}getAnimationPlayingTooltip(u){return u?$localize`Pause Animation`:$localize`Play Animation`}handleMouseMove(u){const l=this.guideline.nativeElement,C=l.parentElement.getBoundingClientRect();this.renderer.setStyle(l,"transform",`translate(${u.clientX-C.left}px, 0)`)}handleMouseEnter(){this.renderer.setStyle(this.guideline.nativeElement,"display","block")}handleMouseLeave(){this.renderer.setStyle(this.guideline.nativeElement,"display","none")}static#e=this.\u0275fac=function(l){return new(l||r)(y.rXU(e.il),y.rXU(y.sFG))};static#t=this.\u0275cmp=y.VBU({type:r,selectors:[["app-ticker-block"]],viewQuery:function(l,m){if(1&l&&y.GBs(o,5),2&l){let C;y.mGM(C=y.lsd())&&(m.guideline=C.first)}},inputs:{tickerBlock:"tickerBlock"},standalone:!0,features:[y.aNF],decls:1,vars:1,consts:()=>{let u;return u=$localize`:026d242c5f68dd78d7735a118cb96c4d3ed15eb6793165009929591137:${"\ufffd0\ufffd"}:INTERPOLATION: Animation`,[["guideline",""],u,[1,"ticker-block"],[1,"ticker-block__item-container",3,"mouseenter","mouseleave","mousemove"],[3,"imageUrl","label","loopImage"],[1,"ticker-block__guideline"],["type","button","app-view-button","","buttonSize","small","buttonShape","rounded","buttonTheme","light-gray-outline",1,"ticker-block__play",3,"click"],[1,"sr-only"],["size","lg","aria-hidden","true",3,"icon"],[1,"ml-2","text-uppercase","text-10"]]},template:function(l,m){1&l&&y.DNE(0,d,15,9,"div",2),2&l&&y.vxM(m.tickerBlock?0:-1)},dependencies:[E.MD,E.Jj,S.C,i.ri,a.o,g.R,f.Q],styles:[".ticker-block__item-container[_ngcontent-%COMP%]{position:relative}.ticker-block__guideline[_ngcontent-%COMP%]{display:none;position:absolute;pointer-events:none;left:0;top:0;height:100%;width:1px;background:red;z-index:10}.ticker-block__play[_ngcontent-%COMP%]{width:100%;margin:12px 0}"],changeDetection:0})}!function(_,u,l,m){var R,C=arguments.length,b=C<3?u:null===m?m=Object.getOwnPropertyDescriptor(u,l):m;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)b=Reflect.decorate(_,u,l,m);else for(var A=_.length-1;A>=0;A--)(R=_[A])&&(b=(C<3?R(b):C>3?R(u,l,b):R(u,l))||b);C>3&&b&&Object.defineProperty(u,l,b)}([(0,e.l6)(P.S.getAnimationPlaying),function(_,u){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata("design:type",u)}(0,s.c)],r.prototype,"animationPlaying$",void 0)},86008:(le,N,n)=>{"use strict";n.d(N,{V:()=>r});var e=n(49204),s=n(17365),c=n(95419),O=n(58743),S=(n(70744),n(16443)),a=n(70914),f=n(64218),E=n(60177),y=n(54438);function i(_,u){return this.trackVideo}function g(_,u){if(1&_&&y.nrm(0,"app-video-view",8),2&_){const l=y.XpG(),m=l.$implicit,C=l.$index,b=y.XpG(2);y.AVh("videos-block__video--next-sibling",C>0),y.Y8G("sources",m.sources)("mode",b.mode)}}function p(_,u){1&_&&(y.j41(0,"div",12),y.pXf(1,1),y.k0s())}function h(_,u){if(1&_&&(y.j41(0,"div",9)(1,"div",10)(2,"div",11),y.pXf(3,0),y.k0s(),y.DNE(4,p,2,0,"div",12),y.k0s()()),2&_){const l=y.XpG().$index,m=y.XpG(2);y.AVh("videos-block__video--next-sibling",l>0),y.R7$(4),y.vxM(m.emailMessage?4:-1)}}function o(_,u){if(1&_&&y.nrm(0,"app-html",7),2&_){const l=y.XpG().$implicit;y.Y8G("markdownText",l.caption)}}function v(_,u){if(1&_&&(y.j41(0,"div"),y.DNE(1,g,1,4,"app-video-view",5)(2,h,5,3,"div",6)(3,o,1,1,"app-html",7),y.k0s()),2&_){const l=u.$implicit;y.R7$(),y.vxM(l.transcoded?1:2),y.R7$(2),y.vxM(l.caption?3:-1)}}function d(_,u){if(1&_&&(y.j41(0,"div",3)(1,"div",4),y.Z7z(2,v,4,2,"div",null,i,!0),y.k0s()()),2&_){const l=y.XpG();y.HbH("videos-block--"+l.layout),y.R7$(2),y.Dyx(l.videos)}}let r=(()=>{class _{get videosBlock(){return this._videosBlock}set videosBlock(l){this._videosBlock=l,this.videos=(0,e.get)(l,"videos",[]).map(m=>{const C={...m};return this.checkTranscodingStatus(C),C}),this.hasVideos=this.videos.length>0}constructor(l,m){this.mediaService=l,this.changeRef=m,this.layout=O.j.Normal,this.mode=S.l.Full,this.emailMessage=!1,this.videos=[],this.hasVideos=!1}checkTranscodingStatus(l){this.mediaService.checkVideoStatus(l.url).pipe((0,s.s)(1)).subscribe(m=>{m&&"boolean"!=typeof m?(l.sources=m,l.transcoded=!0):l.transcoded=!1,this.changeRef.markForCheck()})}trackVideo(l,m){return m.url}static#e=this.\u0275fac=function(m){return new(m||_)(y.rXU(c.u),y.rXU(y.gRc))};static#t=this.\u0275cmp=y.VBU({type:_,selectors:[["app-videos-block"]],inputs:{layout:"layout",mode:"mode",emailMessage:"emailMessage",videosBlock:"videosBlock"},standalone:!0,features:[y.aNF],decls:1,vars:1,consts:()=>{let l,m;return l=$localize`:76807dc051a8773b9486978f33c7f05090c566fb2265850775265912967:Processing Video`,m=$localize`:3e4738ac862bbcd7a02a7355fe93de2f32521c544720931509138129579:Check your email for updates.`,[l,m,["data-test","videoBlock",1,"videos-block",3,"class"],["data-test","videoBlock",1,"videos-block"],[1,"videos-block__content"],[1,"videos-block__video","videos-block__video-view",3,"sources","mode","videos-block__video--next-sibling"],[1,"videos-block__video","videos-block__video-processing",3,"videos-block__video--next-sibling"],[1,"videos-block__video-caption",3,"markdownText"],[1,"videos-block__video","videos-block__video-view",3,"sources","mode"],[1,"videos-block__video","videos-block__video-processing"],[1,"videos-block__video-processing-content"],[1,"text-xs","font-semibold"],[1,"mt-1","text-2xs"]]},template:function(m,C){1&m&&y.DNE(0,d,4,2,"div",2),2&m&&y.vxM(C.hasVideos?0:-1)},dependencies:[E.MD,f.H,S.E,a.V],styles:[".videos-block[_ngcontent-%COMP%]{color:#374a68}.videos-block__video[_ngcontent-%COMP%]{display:block}.videos-block__video--next-sibling[_ngcontent-%COMP%]{margin-top:20px}.videos-block__video-processing[_ngcontent-%COMP%]{padding-top:56.25%;position:relative;display:flex;justify-content:center;background-color:#fff;text-align:center;border:1px solid #96a8c0;border-radius:4px;min-width:180px}.videos-block__video-processing-content[_ngcontent-%COMP%]{position:absolute;top:0;height:100%;display:flex;align-items:center;justify-content:center;flex-direction:column;padding:0 8px}.videos-block__video-caption[_ngcontent-%COMP%]{display:block;font-size:12px;margin-top:12px}.videos-block--compact[_ngcontent-%COMP%]   .videos-block__video-caption[_ngcontent-%COMP%]{font-size:10px;margin-top:4px}"],changeDetection:0})}return _})()},39685:(le,N,n)=>{"use strict";n.d(N,{y:()=>p});var e=n(60177),t=n(34882),s=n(21604),c=n(36204),O=n(45189),P=n(40819),S=n(56592),a=n(47605),f=n(35286),E=n(54438);let y=(()=>{class h{static#e=this.\u0275fac=function(d){return new(d||h)};static#t=this.\u0275mod=E.$C({type:h});static#n=this.\u0275inj=E.G2t({imports:[e.MD,s.G,f.y2.forChild(),S.p,a.Q]})}return h})();var i=n(86008),g=n(77778);let p=(()=>{class h{static#e=this.\u0275fac=function(d){return new(d||h)};static#t=this.\u0275mod=E.$C({type:h});static#n=this.\u0275inj=E.G2t({imports:[e.MD,s.G,O.G,y,P.l,t.y,c.Z,i.V,g.B]})}return h})()},13976:(le,N,n)=>{"use strict";n.d(N,{V:()=>c});var e=n(65776),t=n(54438);const s={[e.m.Markdown]:({markdown:O})=>0===(O??"").length,[e.m.Images]:({images:O})=>0===O.length,[e.m.AnimatedImages]:({images:O})=>0===O.length,[e.m.Ticker]:({images:O})=>0===O.length,[e.m.Videos]:({videos:O})=>0===O.length,[e.m.Positions]:({positions:O})=>0===O.length,[e.m.CTA]:({url:O})=>0===(O??"").length};let c=(()=>{class O{isContentBlockType(S,a){return S?.type===a}isTickerBlock(S){return this.isContentBlockType(S,e.m.Ticker)}isImageBlock(S){return this.isContentBlockType(S,e.m.Images)}isAnimatedImageBlock(S){return this.isContentBlockType(S,e.m.AnimatedImages)}isEmptyBlock(S){return!0===s[S?.type]?.(S)}filterEmptyBlocks(S){return S.filter(a=>!this.isEmptyBlock(a))}filterContentBlocksByType(S,a=[],f=[]){return S.filter(E=>!a.length||a.includes(E.type)).filter(E=>!f.length||!f.includes(E.type))}findContentBlockByType(S,a){return this.filterContentBlocksByType(S,[a])[0]}extractContentBlockText(S,a=""){return S?S.filter(f=>f.type===e.m.Markdown).map(f=>f.markdown).join(a):""}hasContentBlockText(S){return""!==this.extractContentBlockText(S)}static#e=this.\u0275fac=function(a){return new(a||O)};static#t=this.\u0275prov=t.jDH({token:O,factory:O.\u0275fac,providedIn:"root"})}return O})()},58743:(le,N,n)=>{"use strict";n.d(N,{j:()=>e});var e=function(t){return t.Normal="normal",t.Compact="compact",t}(e||{})},65776:(le,N,n)=>{"use strict";n.d(N,{m:()=>e});var e=function(t){return t.Markdown="markdown",t.Images="images",t.AnimatedImages="animatedImages",t.Ticker="ticker",t.Videos="videos",t.Positions="positions",t.CTA="cta",t}(e||{})},44334:(le,N,n)=>{"use strict";n.d(N,{D:()=>s,Y:()=>t});var e=n(65776);class t{}class s{constructor(){this.type=e.m.Images,this.images=[]}}},71441:(le,N,n)=>{"use strict";n.d(N,{q:()=>t,z:()=>s});var e=n(65776);class t{}class s{constructor(){this.type=e.m.Positions,this.positions=[]}}},31462:(le,N,n)=>{"use strict";n.d(N,{F:()=>t,g:()=>s});var e=n(65776);class t{}class s{constructor(){this.type=e.m.Ticker,this.images=[],this.loopImage=!1,this.enable=!0}}},70744:(le,N,n)=>{"use strict";n.d(N,{F:()=>s,Q:()=>t});var e=n(65776);class t{}class s{constructor(){this.type=e.m.Videos,this.videos=[]}}},11153:(le,N,n)=>{"use strict";n.d(N,{hw:()=>s,v9:()=>e,vf:()=>t});let e=(()=>{class c{static#e=this.type="[AppConfig] Set View Logos";constructor(P){this.logoConfig=P}}return c})(),t=(()=>{class c{static#e=this.type="[AppConfig] Set Header Logos";constructor(P){this.logoConfig=P}}return c})(),s=(()=>{class c{static#e=this.type="[AppConfig] Reset";constructor(){}}return c})()},9632:(le,N,n)=>{"use strict";n.d(N,{Gt:()=>y,ar:()=>S,jw:()=>a});var e=n(54438),t=n(60177),s=n(24418),c=n(12215),O=n(92014),P=n(98020);const S=new e.nKC(""),a=new e.nKC(""),f=s.c.deploy===c.Z.Production?"https://human.biodigital.com":window.location.origin,E=s.c.deploy===c.Z.Local?"https://localhost:4202":`${f}/viewer`;let y=(()=>{class i{static#e=this.\u0275fac=function(h){return new(h||i)};static#t=this.\u0275mod=e.$C({type:i});static#n=this.\u0275inj=e.G2t({providers:[{provide:S,useValue:f},{provide:a,useValue:E}],imports:[O.rK.forFeature([P.X]),t.MD]})}return i})()},98020:(le,N,n)=>{"use strict";n.d(N,{X:()=>f});var e=n(92014);class t{}var s=n(20342),c=n(11153),O=n(54438),P=function(E,y,i,g){var o,p=arguments.length,h=p<3?y:null===g?g=Object.getOwnPropertyDescriptor(y,i):g;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)h=Reflect.decorate(E,y,i,g);else for(var v=E.length-1;v>=0;v--)(o=E[v])&&(h=(p<3?o(h):p>3?o(y,i,h):o(y,i))||h);return p>3&&h&&Object.defineProperty(y,i,h),h},S=function(E,y){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(E,y)};const a={viewLogoConfig:s.O,headerLogoConfig:s.O};let f=class hs{static getViewLogoConfig(y){return y.viewLogoConfig}static getHeaderLogoConfig(y){return y.headerLogoConfig}setLogos(y,{logoConfig:i}){y.patchState({viewLogoConfig:i})}setAppHeaderLogos(y,{logoConfig:i}){y.patchState({headerLogoConfig:i})}resetAppConfig(y){y.setState({...a})}static#e=this.\u0275fac=function(i){return new(i||hs)};static#t=this.\u0275prov=O.jDH({token:hs,factory:hs.\u0275fac})};P([(0,e.rc)(c.v9),S("design:type",Function),S("design:paramtypes",[Object,c.v9]),S("design:returntype",void 0)],f.prototype,"setLogos",null),P([(0,e.rc)(c.vf),S("design:type",Function),S("design:paramtypes",[Object,c.v9]),S("design:returntype",void 0)],f.prototype,"setAppHeaderLogos",null),P([(0,e.rc)(c.hw),S("design:type",Function),S("design:paramtypes",[Object]),S("design:returntype",void 0)],f.prototype,"resetAppConfig",null),P([(0,e.MD)(),S("design:type",Function),S("design:paramtypes",[t]),S("design:returntype",void 0)],f,"getViewLogoConfig",null),P([(0,e.MD)(),S("design:type",Function),S("design:paramtypes",[t]),S("design:returntype",void 0)],f,"getHeaderLogoConfig",null),f=P([(0,e.Uw)({name:"appConfig",defaults:{...a}})],f)},65294:(le,N,n)=>{"use strict";n.d(N,{F:()=>e});var e=function(t){return t.AnnotationsCreated="annotations.created",t.AnnotationsDestroyed="annotations.destroyed",t.AnnotationsHidden="annotations.hidden",t.AnnotationsShown="annotations.shown",t.QuizEntered="quiz.entered",t.QuizExited="quiz.exited",t.QuizQuestionLoaded="quiz.questionLoaded",t.QuizAnswerSelected="quiz.answerSelected",t.QuizAnswerSubmitted="quiz.answerSubmitted",t.QuizCompleted="quiz.completed",t.LabelsCreated="labels.created",t.LabelsUpdated="labels.updated",t.LabelsMoved="labels.moved",t.LabelsDestroyed="labels.destroyed",t.LabelsChapterInfo="labels.chapterInfo",t.LabelsShown="labels.shown",t.LabelsHidden="labels.hidden",t.LabelsEnabled="labels.enabled",t.LabelsDisabled="labels.disabled",t.LabelsEntered="labels.entered",t.LabelsLeft="labels.left",t.LabelsPicked="labels.picked",t.HotspotsDisplayUpdated="hotspots.displayUpdated",t.HotspotsEntered="hotspots.entered",t.HotspotsLeft="hotspots.left",t.HotspotsPicked="hotspots.picked",t.HotspotsPositionUpdated="hotspots.positionUpdated",t.NativeDeleteData="native.deleteData",t.NativeUpgrade="native.upgrade",t.NativeRestore="native.restore",t.NativeShare="native.share",t.NativeGoogleSignUp="native.googleSignUp",t.NativeDebugMessage="native.debugMessage",t.NativeSetSdkOffline="native.setSdkOffline",t.NativeSetBaseDirectory="native.setBaseDirectory",t.WhiteboardDrawingStarted="whiteboard.drawingStarted",t.WhiteboardDrawingFinished="whiteboard.drawingFinished",t.WhiteboardModeUpdated="whiteboard.modeUpdated",t.UIUpdated="ui.updated",t.UIWindowUpdated="ui.windowUpdated",t}(e||{})},83621:(le,N,n)=>{"use strict";n.d(N,{S:()=>s});var e=n(26982),t=n(54438);let s=(()=>{class c extends e.U{static#e=this.\u0275fac=(()=>{let P;return function(a){return(P||(P=t.xGo(c)))(a||c)}})();static#t=this.\u0275prov=t.jDH({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})()},26982:(le,N,n)=>{"use strict";n.d(N,{U:()=>t});var e=n(85052);class t{constructor(){this._subjects={}}getEvent(c){return(this._subjects[c]=this._subjects[c]??new e.B).asObservable()}fireEvent(c,O){const P=this._subjects[c];P&&P.next(O)}}},10352:(le,N,n)=>{"use strict";n.d(N,{RK:()=>e,Vw:()=>t,aN:()=>c,vk:()=>s});const e={colors:[245,245,245,1,245,245,245,1],gradientType:"radial",colorStops:[0,100]},t={colors:[255,255,255,0,255,255,255,0],gradientType:"linear",colorStops:[0,100]},s=[{colors:[0,0,0,1,0,0,0,1],gradientType:"linear",colorStops:[0,100]},{colors:[38,38,38,1,38,38,38,1],gradientType:"linear",colorStops:[0,100]},{colors:[77,77,77,1,77,77,77,1],gradientType:"linear",colorStops:[0,100]},{colors:[115,115,115,1,115,115,115,1],gradientType:"linear",colorStops:[0,100]},{colors:[153,153,153,1,153,153,153,1],gradientType:"linear",colorStops:[0,100]},{colors:[191,191,191,1,191,191,191,1],gradientType:"linear",colorStops:[0,100]},{colors:[230,230,230,1,230,230,230,1],gradientType:"linear",colorStops:[0,100]},{colors:[255,255,255,1,255,255,255,1],gradientType:"linear",colorStops:[0,100]},{colors:[128,128,128,1,0,0,0,1],gradientType:"radial",colorStops:[0,100]},{colors:[128,128,128,1,38,38,38,1],gradientType:"radial",colorStops:[0,100]},{colors:[128,128,128,1,77,77,77,1],gradientType:"radial",colorStops:[0,100]},{colors:[128,128,128,1,115,115,115,1],gradientType:"radial",colorStops:[0,100]},{colors:[128,128,128,1,153,153,153,1],gradientType:"radial",colorStops:[0,100]},{colors:[128,128,128,1,191,191,191,1],gradientType:"radial",colorStops:[0,100]},{colors:[128,128,128,1,230,230,230,1],gradientType:"radial",colorStops:[0,100]},{colors:[128,128,128,1,255,255,255,1],gradientType:"radial",colorStops:[0,100]},{colors:[245,208,208,1,245,208,208,1],gradientType:"linear",colorStops:[0,100]},{colors:[253,236,219,1,253,236,219,1],gradientType:"linear",colorStops:[0,100]},{colors:[255,246,219,1,255,246,219,1],gradientType:"linear",colorStops:[0,100]},{colors:[220,236,213,1,220,236,213,1],gradientType:"linear",colorStops:[0,100]},{colors:[212,229,245,1,212,229,245,1],gradientType:"linear",colorStops:[0,100]},{colors:[219,212,235,1,219,212,235,1],gradientType:"linear",colorStops:[0,100]},{colors:[164,194,244,1,164,194,244,1],gradientType:"linear",colorStops:[0,100]},{colors:[118,165,175,1,118,165,175,1],gradientType:"linear",colorStops:[0,100]},{colors:[245,208,208,1,245,208,208,1],gradientType:"radial",colorStops:[0,100]},{colors:[253,236,219,1,240,169,99,1],gradientType:"radial",colorStops:[0,100]},{colors:[255,246,219,1,250,210,92,1],gradientType:"radial",colorStops:[0,100]},{colors:[220,236,213,1,147,188,129,1],gradientType:"radial",colorStops:[0,100]},{colors:[212,229,245,1,112,164,213,1],gradientType:"radial",colorStops:[0,100]},{colors:[219,212,235,1,145,128,187,1],gradientType:"radial",colorStops:[0,100]},{colors:[164,194,244,1,112,164,213,1],gradientType:"radial",colorStops:[0,100]},{colors:[211,211,211,1,118,165,175,1],gradientType:"radial",colorStops:[0,100]}],c=[...s,{colors:[10,132,130,255,5,43,51,255],gradientType:"radial",colorStops:[0,68]},{colors:[0,28,84,1,0,0,0,1],gradientType:"radial",colorStops:[12,100]}]},93253:(le,N,n)=>{"use strict";n.d(N,{w:()=>a});var e=n(34006),t=n(54438),s=n(60177),c=n(21007);function O(f,E){if(1&f&&(t.j41(0,"button",7),t.EFF(1),t.k0s()),2&f){const y=t.XpG();t.R7$(),t.SpI(" ",y.settings.miscText," ")}}function P(f,E){if(1&f&&(t.j41(0,"button",8),t.EFF(1),t.k0s()),2&f){const y=t.XpG();t.Y8G("mat-dialog-close",!1),t.R7$(),t.SpI(" ",y.settings.cancelText," ")}}function S(f,E){if(1&f&&(t.j41(0,"button",9),t.EFF(1),t.k0s()),2&f){const y=t.XpG();t.Y8G("mat-dialog-close",!0),t.R7$(),t.SpI(" ",y.settings.confirmText," ")}}let a=(()=>{class f{constructor(y,i){this.dialogRef=y,this.data=i,this.settings={titleText:"Confirm Action",bodyText:"",confirmText:"Confirm",confirmColor:"primary",cancelText:"Cancel",confirmEnabled:!0,cancelEnabled:!0,miscText:""},i&&(this.settings={...this.settings,...i})}ngOnInit(){}static#e=this.\u0275fac=function(i){return new(i||f)(t.rXU(e.CP),t.rXU(e.Vh))};static#t=this.\u0275cmp=t.VBU({type:f,selectors:[["app-confirm-dialog"]],decls:9,vars:5,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"text-sm"],["mat-dialog-actions",""],["app-button","","buttonTheme","light",3,"mat-dialog-close",4,"ngIf"],["type","button","app-button","","buttonTheme","light","data-test","confirmDialogCancelButton",3,"mat-dialog-close",4,"ngIf"],["type","button","app-button","","buttonType","primary","data-test","confirmDialogConfirmButton","cdkFocusInitial","",3,"mat-dialog-close",4,"ngIf"],["app-button","","buttonTheme","light",3,"mat-dialog-close"],["type","button","app-button","","buttonTheme","light","data-test","confirmDialogCancelButton",3,"mat-dialog-close"],["type","button","app-button","","buttonType","primary","data-test","confirmDialogConfirmButton","cdkFocusInitial","",3,"mat-dialog-close"]],template:function(i,g){1&i&&(t.j41(0,"h1",0),t.EFF(1),t.k0s(),t.j41(2,"div",1)(3,"div",2),t.EFF(4),t.k0s()(),t.j41(5,"div",3),t.DNE(6,O,2,1,"button",4)(7,P,2,2,"button",5)(8,S,2,2,"button",6),t.k0s()),2&i&&(t.R7$(),t.JRh(g.settings.titleText),t.R7$(3),t.JRh(g.settings.bodyText),t.R7$(2),t.Y8G("ngIf",g.settings.miscText),t.R7$(),t.Y8G("ngIf",g.settings.cancelEnabled),t.R7$(),t.Y8G("ngIf",g.settings.confirmEnabled))},dependencies:[s.bT,e.tx,e.BI,e.E7,e.Yi,c.Q],styles:["[_nghost-%COMP%]{display:block}.dialog__actions[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:center;width:100%}.dialog__actions--compact[_ngcontent-%COMP%]{justify-content:flex-end}@media (min-width: 480px){[_nghost-%COMP%]{min-width:320px}}"],changeDetection:0})}return f})()},63181:(le,N,n)=>{"use strict";n.d(N,{Y:()=>o});var e=n(54438),t=n(89417),s=n(34006),c=n(92014),O=n(29160),P=n(85052),S=n(37925),a=n(47632),f=n(95416),E=n(60177),y=n(82765),i=n(21007),g=n(97352);function p(v,d){1&v&&(e.qex(0),e.nrm(1,"app-spinner",15),e.EFF(2," Deleting "),e.bVm())}function h(v,d){1&v&&e.EFF(0,"Delete")}let o=(()=>{class v{constructor(r,_,u,l,m,C){this.store=r,this.actions=_,this.snackBar=u,this.formBuilder=l,this.dialogRef=m,this.data=C,this.settings=(0,e.vPA)({bookmarks:[]}),this.deleting$=new O.t(!1),this.ngUnsubscribe=new P.B,this.noun=(0,e.EWP)(()=>1===this.settings().bookmarks.length?"model":"models"),this.countedNoun=(0,e.EWP)(()=>`${1===this.settings().bookmarks.length?"":`${this.settings().bookmarks.length} `}${this.noun()}`),this.adjective=(0,e.EWP)(()=>1===this.settings().bookmarks.length?"this":"these"),this.settings.set({...this.settings(),...C})}ngOnInit(){this.initStateListeners(),this.initForm()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initStateListeners(){this.actions.pipe((0,c.xi)(a.CF,a.CR),(0,S.Q)(this.ngUnsubscribe)).subscribe(()=>{this.deleting$.next(!0)}),this.actions.pipe((0,c.xi)(a.te,a.DN),(0,S.Q)(this.ngUnsubscribe)).subscribe(r=>{this.deleting$.next(!1),this.handleDeleteSuccess(r)}),this.actions.pipe((0,c.xi)(a.C$,a.Qw),(0,S.Q)(this.ngUnsubscribe)).subscribe(r=>{this.deleting$.next(!1),this.handleDeleteFailure(r)})}initForm(){this.form=this.formBuilder.group({confirm:[!1,t.k0.requiredTrue]})}handleDeleteSuccess(r){this.dialogRef.close(!0)}handleDeleteFailure(r){this.snackBar.open(`There was an error deleting the ${r.bookmarkIds.length} requested ${this.noun}.`)}handleCancelClick(){this.dialogRef.close(!1)}handleDeleteClick(){const r=this.settings().bookmarks.map(_=>_.id);this.store.dispatch(1===r.length?new a.CR(r[0]):new a.CF(r))}static#e=this.\u0275fac=function(_){return new(_||v)(e.rXU(c.il),e.rXU(c.En),e.rXU(f.UG),e.rXU(t.ze),e.rXU(s.CP),e.rXU(s.Vh))};static#t=this.\u0275cmp=e.VBU({type:v,selectors:[["app-delete-bookmarks-dialog"]],decls:39,vars:20,consts:[["defaultTmp",""],["mat-dialog-title",""],["mat-dialog-content",""],[1,"dialog",3,"formGroup"],[1,"text-sm","theme-light"],[1,"font-bold"],[1,"ml-4","list-disc"],[1,"mt-2"],[1,"mt-6"],["formControlName","confirm"],[2,"white-space","normal"],["mat-dialog-actions",""],["app-button","","buttonTheme","light","buttonType","default",3,"click","disabled"],["app-button","","buttonType","primary",3,"click","disabled"],[4,"ngIf","ngIfElse"],["size","small","render","inline",1,"mr-1"]],template:function(_,u){if(1&_){const l=e.RV6();e.j41(0,"h1",1),e.EFF(1),e.nI1(2,"titlecase"),e.k0s(),e.j41(3,"div",2)(4,"div",3)(5,"div",4)(6,"div"),e.EFF(7," Are you sure you want to "),e.j41(8,"em",5),e.EFF(9),e.k0s(),e.EFF(10," from My Library? "),e.j41(11,"ul",6)(12,"li",7),e.EFF(13),e.j41(14,"em",5),e.EFF(15,"Private"),e.k0s(),e.EFF(16," or "),e.j41(17,"em",5),e.EFF(18,"Team"),e.k0s(),e.EFF(19," collections. "),e.k0s(),e.j41(20,"li",7),e.EFF(21," This action "),e.j41(22,"em",5),e.EFF(23,"cannot be undone"),e.k0s(),e.EFF(24),e.k0s()()(),e.j41(25,"div",8)(26,"mat-checkbox",9)(27,"span",10),e.EFF(28),e.k0s()()()()()(),e.j41(29,"div",11)(30,"button",12),e.nI1(31,"async"),e.bIt("click",function(){return e.eBV(l),e.Njj(u.handleCancelClick())}),e.EFF(32," Cancel "),e.k0s(),e.j41(33,"button",13),e.nI1(34,"async"),e.bIt("click",function(){return e.eBV(l),e.Njj(u.handleDeleteClick())}),e.DNE(35,p,3,0,"ng-container",14),e.nI1(36,"async"),e.DNE(37,h,1,0,"ng-template",null,0,e.C5r),e.k0s()()}if(2&_){const l=e.sdS(38);e.R7$(),e.SpI("Delete ",e.bMT(2,12,u.countedNoun()),""),e.R7$(3),e.Y8G("formGroup",u.form),e.R7$(5),e.Lme("permanently delete ",u.adjective()," ",u.countedNoun(),""),e.R7$(4),e.SpI(" The ",u.noun()," will be no longer be available in your "),e.R7$(11),e.SpI(", and the ",u.noun()," cannot be recovered. "),e.R7$(4),e.Lme("I confirm that I want to permanently delete ",u.adjective()," ",u.countedNoun(),"."),e.R7$(2),e.Y8G("disabled",e.bMT(31,14,u.deleting$)),e.R7$(3),e.Y8G("disabled",u.form.invalid||e.bMT(34,16,u.deleting$)),e.R7$(2),e.Y8G("ngIf",e.bMT(36,18,u.deleting$))("ngIfElse",l)}},dependencies:[E.bT,y.So,s.BI,s.E7,s.Yi,i.Q,g.tI,t.BC,t.cb,t.j4,t.JD,E.Jj,E.PV],styles:[".dialog[_ngcontent-%COMP%]{max-width:520px}.dialog__list[_ngcontent-%COMP%]{list-style-type:disc;margin:0;padding-left:40px}"],changeDetection:0})}return v})()},27800:(le,N,n)=>{"use strict";n.d(N,{I:()=>P});var e=n(60177),t=n(45189),s=n(21604),c=n(89417),O=n(54438);let P=(()=>{class S{static#e=this.\u0275fac=function(E){return new(E||S)};static#t=this.\u0275mod=O.$C({type:S});static#n=this.\u0275inj=O.G2t({imports:[e.MD,t.G,s.G,c.X1]})}return S})()},84178:(le,N,n)=>{"use strict";n.d(N,{i:()=>h});var e=n(24418),t=n(54438),s=n(38645),c=n(60177),O=n(21007),P=n(26779),S=n(77242),a=n(41640);const f=o=>({"signup-messaging--compact":o});function E(o,v){if(1&o&&(t.j41(0,"app-list-item")(1,"div",11),t.nrm(2,"app-icon",12),t.j41(3,"div"),t.EFF(4),t.k0s()()()),2&o){const d=v.$implicit;t.R7$(4),t.JRh(d)}}function y(o,v){if(1&o&&(t.qex(0),t.EFF(1," Unlock full access to the BioDigital library: "),t.j41(2,"div",8)(3,"app-list",9),t.DNE(4,E,5,1,"app-list-item",10),t.k0s()(),t.bVm()),2&o){const d=t.XpG();t.R7$(4),t.Y8G("ngForOf",d.features)}}function i(o,v){1&o&&(t.qex(0),t.EFF(1," Create a free account to explore 1000+ anatomy, physiology, and treatment models in interactive 3D. "),t.bVm())}function g(o,v){if(1&o){const d=t.RV6();t.j41(0,"button",13),t.bIt("click",function(){t.eBV(d);const _=t.XpG();return t.Njj(_.handleLearnMoreClick())}),t.EFF(1," Learn More "),t.k0s()}if(2&o){const d=t.XpG();t.Y8G("buttonSize",d.compact?"md":"lg"),t.BMQ("aria-label","Learn More")}}function p(o,v){if(1&o&&(t.j41(0,"p",14)(1,"a",15),t.EFF(2,"Already have an account? Sign in"),t.k0s()()),2&o){const d=t.XpG();t.R7$(),t.Y8G("queryParams",d.loginUrlParams)}}let h=(()=>{class o{constructor(d,r){this.activatedRoute=d,this.router=r,this.features=["Complete male and female anatomy","600+ health condition and treatment 3D models","200+ 3D anatomy quizzes","Animated 3D models and virtual 3D tours"],this.compact=!1,this.loginUrlParams={}}ngOnInit(){this.loginUrlParams={returnUrl:this.router.url}}handleSignUpClick(d){this.router.navigate(["/login/create"],{queryParams:{returnUrl:this.router.url,ref:this.activatedRoute.snapshot.queryParams.ref||"share",utm_source:e.c.native?"human_mobile":"human_web",utm_campaign:"share",utm_medium:"PLG"}}),d.stopImmediatePropagation()}handleLearnMoreClick(){window.open(`https://www.biodigital.com?utm_source=${e.c.native?"human_mobile":"human_web"}&utm_medium=PLG&utm_campaign=share&ref=share`)}static#e=this.\u0275fac=function(r){return new(r||o)(t.rXU(s.nX),t.rXU(s.Ix))};static#t=this.\u0275cmp=t.VBU({type:o,selectors:[["app-signup-messaging"]],inputs:{compact:"compact"},decls:9,vars:9,consts:[[1,"flex","flex-col","items-center","signup-messaging",3,"ngClass"],[1,"signup-messaging__content",3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"signup-messaging__actions"],["type","button","app-button","","buttonType","primary","buttonTheme","light","title","Sign Up For Free","data-test","signupMessageButton",3,"click","buttonSize"],["type","button","app-button","","buttonType","outline","buttonTheme","light","title","Learn More",3,"buttonSize","click",4,"ngIf"],["class","signup-messaging__footer",4,"ngIf"],[1,"mt-7"],["listType","flat",1,"mt-2"],[4,"ngFor","ngForOf"],[1,"flex","flex-row","my-1","signup-messaging__list-item"],["icon","check",1,"mr-2"],["type","button","app-button","","buttonType","outline","buttonTheme","light","title","Learn More",3,"click","buttonSize"],[1,"signup-messaging__footer"],["routerLink","/login",1,"signup-messaging__link","link",3,"queryParams"]],template:function(r,_){1&r&&(t.j41(0,"div",0)(1,"p",1),t.DNE(2,y,5,1,"ng-container",2)(3,i,2,0,"ng-container",3),t.k0s(),t.j41(4,"div",4)(5,"button",5),t.bIt("click",function(l){return _.handleSignUpClick(l)}),t.EFF(6," Sign Up For Free "),t.k0s(),t.DNE(7,g,2,2,"button",6),t.k0s(),t.DNE(8,p,3,1,"p",7),t.k0s()),2&r&&(t.Y8G("ngClass",t.eq3(7,f,_.compact)),t.R7$(),t.Y8G("ngSwitch",_.compact),t.R7$(),t.Y8G("ngSwitchCase",!0),t.R7$(3),t.Y8G("buttonSize",_.compact?"md":"lg"),t.BMQ("aria-label","Sign Up For Free"),t.R7$(2),t.Y8G("ngIf",!_.compact),t.R7$(),t.Y8G("ngIf",!_.compact))},dependencies:[c.YU,c.Sq,c.bT,c.ux,c.e1,c.fG,s.Wk,O.Q,P.R,S.s,a.P],styles:[".signup-messaging[_ngcontent-%COMP%]{background-color:#fff}.signup-messaging__content[_ngcontent-%COMP%]{color:#101823;font-size:1.25rem;line-height:1.75rem;font-weight:600;max-width:632px;text-align:center}.signup-messaging__list-item[_ngcontent-%COMP%]{font-size:.875rem;line-height:1.25rem;font-weight:400;color:#283853}.signup-messaging__actions[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;gap:32px;margin-top:40px}.signup-messaging__footer[_ngcontent-%COMP%]{color:#283853;font-size:.875rem;line-height:1.25rem;margin-top:28px}.signup-messaging__link[_ngcontent-%COMP%]{text-decoration:underline;color:#283853}.signup-messaging--compact[_ngcontent-%COMP%]{padding:40px 60px;border-radius:8px}.signup-messaging--compact[_ngcontent-%COMP%]   .signup-messaging__content[_ngcontent-%COMP%]{font-size:1.25rem;line-height:1.75rem;text-align:left}.signup-messaging--compact[_ngcontent-%COMP%]   .signup-messaging__actions[_ngcontent-%COMP%]{margin-top:28px}.signup-messaging--compact[_ngcontent-%COMP%]   .signup-messaging__footer[_ngcontent-%COMP%]{font-size:.75rem;line-height:1rem}@media (max-width: 959px){.signup-messaging--compact[_ngcontent-%COMP%]{padding:24px}.signup-messaging--compact[_ngcontent-%COMP%]   .signup-messaging__content[_ngcontent-%COMP%]{font-size:.875rem;line-height:1.25rem}.signup-messaging--compact[_ngcontent-%COMP%]   .signup-messaging__list-item[_ngcontent-%COMP%]{font-size:.75rem;line-height:1rem}.signup-messaging--compact[_ngcontent-%COMP%]   .signup-messaging__actions[_ngcontent-%COMP%]{margin-top:20px}}@media (max-width: 480px){.signup-messaging__content[_ngcontent-%COMP%]{font-size:1rem;line-height:1.5rem}.signup-messaging__actions[_ngcontent-%COMP%]{width:80%;flex-direction:column;align-items:stretch;gap:16px;margin-top:28px}}"],changeDetection:0})}return o})()},91060:(le,N,n)=>{"use strict";n.d(N,{w:()=>P});var e=n(60177),t=n(45189),s=n(21604),c=n(38645),O=n(54438);let P=(()=>{class S{static#e=this.\u0275fac=function(E){return new(E||S)};static#t=this.\u0275mod=O.$C({type:S});static#n=this.\u0275inj=O.G2t({imports:[e.MD,t.G,c.iI,s.G]})}return S})()},82633:(le,N,n)=>{"use strict";n.d(N,{A:()=>r,G:()=>p});var e=n(34006),t=n(85052),s=n(54438),c=n(92014),O=n(60177),P=n(21007),S=n(26779);function a(_,u){if(1&_&&s.nrm(0,"img",17),2&_){const l=s.XpG().$implicit;s.Y8G("src",l.logo,s.B4B)}}function f(_,u){if(1&_&&(s.j41(0,"h2",18),s.EFF(1),s.k0s()),2&_){const l=s.XpG().$implicit;s.R7$(),s.SpI(" ",l.title," ")}}function E(_,u){if(1&_&&s.nrm(0,"p",19),2&_){const l=s.XpG().$implicit;s.AVh("text-xl",l.logo)("font-medium",l.logo),s.Y8G("innerHTML",l.text,s.npT)}}function y(_,u){if(1&_&&s.nrm(0,"img",20),2&_){const l=s.XpG().$implicit;s.Y8G("src",l.image,s.B4B)}}function i(_,u){if(1&_&&(s.j41(0,"div",12),s.DNE(1,a,1,1,"img",13)(2,f,2,1,"h2",14)(3,E,1,5,"p",15)(4,y,1,1,"img",16),s.k0s()),2&_){const l=u.$implicit,m=u.index,C=s.XpG();s.AVh("slide__item--hidden",C.selectedIndex!==m),s.R7$(),s.Y8G("ngIf",l.logo),s.R7$(),s.Y8G("ngIf",l.title),s.R7$(),s.Y8G("ngIf",l.text),s.R7$(),s.Y8G("ngIf",l.image)}}function g(_,u){if(1&_){const l=s.RV6();s.j41(0,"button",21),s.bIt("click",function(){const C=s.eBV(l).index,b=s.XpG();return s.Njj(b.handleSelectSlideClick(C))}),s.k0s()}if(2&_){const l=u.$implicit,m=u.index,C=s.XpG();s.AVh("slide__nav-dot--active",C.selectedIndex===m),s.BMQ("title",l.title)("aria-label",l.title)}}var p=function(_){return _[_.NewUser=0]="NewUser",_[_.ExistingUser=1]="ExistingUser",_[_.Group=2]="Group",_}(p||{});const v=[{text:"We make it easy to visualize the human body<br/> for your educational needs - all in interactive 3D.",logo:"/assets/images/biodigital-logo.svg"},{title:"Explore",text:"Browse our digital library for 3D models to complement your curriculum.",image:"/assets/images/welcome-tour-explore.jpg"},{title:"Customize",text:"Use our authoring tools to create 3D views tailored to your educational goals.",image:"/assets/images/welcome-tour-customize.jpg"},{title:"Collaborate",text:"Share your saved 3D views with your team from a central Library.",image:"/assets/images/welcome-tour-collaborate.jpg"},{title:"Integrate",text:"Publish your interactive 3D model and drop into your digital content.",image:"/assets/images/welcome-tour-integrate.jpg"}],d=[{title:"Introducing Human Studio",text:"The first product for authoring custom interactive 3D models of anatomy, disease and treatments.",image:"/assets/images/studio-tour-studio.jpg"},{title:"Interactive Labels",text:"Quickly add anatomical labels to call out key learning objectives.",image:"/assets/images/studio-tour-labels.jpg"},{title:"Paint",text:"Customize the look and feel of your 3D model by applying different paint effects to anatomical structures.",image:"/assets/images/studio-tour-paint.jpg"},{title:"Tour Builder",text:"Tell an interactive story by stringing together different views of your 3D model.",image:"/assets/images/studio-tour-tour.jpg"},{title:"Text Manager",text:"Add or modify text from one dedicated place.",image:"/assets/images/studio-tour-text.jpg"}];let r=(()=>{class _{get isFirstSlide(){return 0===this.selectedIndex}get isLastSlide(){return this.selectedIndex===this.slides.length-1}constructor(l,m,C){switch(this.store=l,this.dialogRef=m,this.data=C,this.ngUnsubscribe=new t.B,this.settings={userType:p.NewUser},this.slides=[],this.selectedIndex=0,this.settings={...this.settings,...C},this.settings.userType){case p.NewUser:this.slides=v;break;case p.ExistingUser:this.slides=d}}ngOnInit(){}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}handleCloseTour(){this.close()}close(){this.dialogRef.close()}handleSelectSlideClick(l){this.selectedIndex=l}handleNextClick(){this.incrementSelectedIndex(1)}handlePrevClick(){this.incrementSelectedIndex(-1)}incrementSelectedIndex(l){this.selectedIndex=Math.max(0,this.selectedIndex+l)%this.slides.length}static#e=this.\u0275fac=function(m){return new(m||_)(s.rXU(c.il),s.rXU(e.CP),s.rXU(e.Vh))};static#t=this.\u0275cmp=s.VBU({type:_,selectors:[["app-welcome-tour-dialog"]],decls:12,vars:8,consts:[["role","dialog","aria-modal","true","data-test","welcomeTour",1,"welcome"],[1,"slide"],["class","slide__item",3,"slide__item--hidden",4,"ngFor","ngForOf"],[1,"slide__nav"],["app-button","","buttonType","text","buttonTheme","light","type","button","title","Previous Slide",1,"slide__nav-arrow",3,"click","disabled"],["icon","chevron-left","size","md"],[1,"slide__nav-dots"],["type","button","class","slide__nav-dot",3,"slide__nav-dot--active","click",4,"ngFor","ngForOf"],["app-button","","buttonType","text","buttonTheme","light","type","button","title","Next Slide",1,"slide__nav-arrow",3,"click","disabled"],["icon","chevron-right","size","md"],["app-button","","buttonType","text","buttonTheme","light","type","button","title","Close","data-test","welcomeTourClose",1,"welcome__close",3,"click"],["icon","times","size","lg"],[1,"slide__item"],["class","slide__logo",3,"src",4,"ngIf"],["class","text-2xl uppercase mt-4",4,"ngIf"],["class","text-lg mt-4 mb-4",3,"text-xl","font-medium","innerHTML",4,"ngIf"],["class","slide__image",3,"src",4,"ngIf"],[1,"slide__logo",3,"src"],[1,"text-2xl","uppercase","mt-4"],[1,"text-lg","mt-4","mb-4",3,"innerHTML"],[1,"slide__image",3,"src"],["type","button",1,"slide__nav-dot",3,"click"]],template:function(m,C){1&m&&(s.j41(0,"div",0)(1,"div",1),s.DNE(2,i,5,6,"div",2),s.j41(3,"div",3)(4,"button",4),s.bIt("click",function(){return C.handlePrevClick()}),s.nrm(5,"app-icon",5),s.k0s(),s.j41(6,"div",6),s.DNE(7,g,1,4,"button",7),s.k0s(),s.j41(8,"button",8),s.bIt("click",function(){return C.handleNextClick()}),s.nrm(9,"app-icon",9),s.k0s()()(),s.j41(10,"button",10),s.bIt("click",function(){return C.handleCloseTour()}),s.nrm(11,"app-icon",11),s.k0s()()),2&m&&(s.BMQ("aria-label","Welcome Tour"),s.R7$(2),s.Y8G("ngForOf",C.slides),s.R7$(2),s.Y8G("disabled",C.isFirstSlide),s.BMQ("aria-label","Previous Slide"),s.R7$(3),s.Y8G("ngForOf",C.slides),s.R7$(),s.Y8G("disabled",C.isLastSlide),s.BMQ("aria-label","Next Slide"),s.R7$(2),s.BMQ("aria-label","Close"))},dependencies:[O.Sq,O.bT,P.Q,S.R],styles:[".welcome[_ngcontent-%COMP%]{position:relative;display:flex;align-items:flex-end;flex-direction:column;padding:24px}.welcome__close[_ngcontent-%COMP%]{position:absolute;top:24px;right:24px}.slide[_ngcontent-%COMP%]{width:800px;height:600px;position:relative;margin:auto;display:flex;flex-direction:column;justify-content:space-between}.slide__item[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;text-align:center}.slide__item--hidden[_ngcontent-%COMP%]{display:none}.slide__logo[_ngcontent-%COMP%]{width:300px;margin:160px 0 40px}.slide__image[_ngcontent-%COMP%]{flex:2;overflow:auto;width:100%}.slide__nav[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:center;font-size:16px;margin:12px 0}.slide__nav-arrow[_ngcontent-%COMP%]{cursor:pointer;margin:auto 12px;opacity:.8}.slide__nav-arrow[_ngcontent-%COMP%]:hover:not([disabled]){opacity:1}.slide__nav-dots[_ngcontent-%COMP%]{display:flex}.slide__nav-dot[_ngcontent-%COMP%]{margin:auto 4px;cursor:pointer;display:flex;background-color:#1c2a3f66;border-radius:50%;border:none;width:14px;height:14px;line-height:17px}.slide__nav-dot[_ngcontent-%COMP%]:hover{background-color:#1c2a3f99}.slide__nav-dot--active[_ngcontent-%COMP%]{background-color:#2d72dc}@media (max-width: 1024px){.slide[_ngcontent-%COMP%]{width:100%;height:80vh}}"],changeDetection:0})}return _})()},45367:(le,N,n)=>{"use strict";n.d(N,{P:()=>ue});var e=n(60177),t=n(45189),s=n(21604),c=n(54438);let O=(()=>{class H{static#e=this.\u0275fac=function(w){return new(w||H)};static#t=this.\u0275mod=c.$C({type:H});static#n=this.\u0275inj=c.G2t({imports:[e.MD,t.G,s.G]})}return H})();var P=n(89417),S=n(3272);let a=(()=>{class H{static#e=this.\u0275fac=function(w){return new(w||H)};static#t=this.\u0275mod=c.$C({type:H});static#n=this.\u0275inj=c.G2t({imports:[e.MD,t.G,P.YN,P.X1,S.D]})}return H})(),f=(()=>{class H{static#e=this.\u0275fac=function(w){return new(w||H)};static#t=this.\u0275mod=c.$C({type:H});static#n=this.\u0275inj=c.G2t({imports:[e.MD,t.G,s.G,P.X1,a]})}return H})(),E=(()=>{class H{static#e=this.\u0275fac=function(w){return new(w||H)};static#t=this.\u0275mod=c.$C({type:H});static#n=this.\u0275inj=c.G2t({imports:[e.MD,t.G,s.G]})}return H})(),y=(()=>{class H{static#e=this.\u0275fac=function(w){return new(w||H)};static#t=this.\u0275mod=c.$C({type:H});static#n=this.\u0275inj=c.G2t({imports:[e.MD,t.G,s.G]})}return H})(),i=(()=>{class H{static#e=this.\u0275fac=function(w){return new(w||H)};static#t=this.\u0275mod=c.$C({type:H});static#n=this.\u0275inj=c.G2t({imports:[e.MD,t.G,s.G]})}return H})(),g=(()=>{class H{static#e=this.\u0275fac=function(w){return new(w||H)};static#t=this.\u0275mod=c.$C({type:H});static#n=this.\u0275inj=c.G2t({imports:[e.MD,t.G,s.G,P.X1]})}return H})();var p=n(27800);let h=(()=>{class H{static#e=this.\u0275fac=function(w){return new(w||H)};static#t=this.\u0275mod=c.$C({type:H});static#n=this.\u0275inj=c.G2t({imports:[e.MD,t.G,s.G]})}return H})();var d,H,o=n(92014);(H=d||(d={})).OpenLimit=(()=>{class he{static#e=this.type="[Dialog] Open Limit";constructor(){}}return he})(),H.CloseLimit=(()=>{class he{static#e=this.type="[Dialog] Close Limit";constructor(_e){this.upgrade=_e}}return he})(),H.OpenPremiumContent=(()=>{class he{static#e=this.type="[Dialog] Open Premium Content";constructor(){}}return he})(),H.ClosePremiumContent=(()=>{class he{static#e=this.type="[Dialog] Close Premium Content";constructor(_e){this.confirmed=_e}}return he})(),H.OpenUpgrade=(()=>{class he{static#e=this.type="[Dialog] Open Upgrade";constructor(){}}return he})(),H.CloseUpgrade=(()=>{class he{static#e=this.type="[Dialog] Close Upgrade";constructor(){}}return he})();var r=n(66571),_=function(H,te,F,w){var Y,X=arguments.length,oe=X<3?te:null===w?w=Object.getOwnPropertyDescriptor(te,F):w;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)oe=Reflect.decorate(H,te,F,w);else for(var he=H.length-1;he>=0;he--)(Y=H[he])&&(oe=(X<3?Y(oe):X>3?Y(te,F,oe):Y(te,F))||oe);return X>3&&oe&&Object.defineProperty(te,F,oe),oe},u=function(H,te){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(H,te)};let l=class _s{static getOpenDialog(te){return te.openDialog}openPremiumContent(te,F){this.dialogService.openPremiumContentDialog().afterClosed().subscribe(X=>{te.dispatch(new d.ClosePremiumContent(X))})}closePremiumContent(te,F){F.confirmed&&te.dispatch(new d.OpenUpgrade)}openUpgrade(te,F){this.dialogService.openUpgradeDialog()}constructor(te){this.dialogService=te}static#e=this.\u0275fac=function(F){return new(F||_s)(c.KVO(r.o))};static#t=this.\u0275prov=c.jDH({token:_s,factory:_s.\u0275fac})};_([(0,o.rc)(d.OpenPremiumContent),u("design:type",Function),u("design:paramtypes",[Object,d.OpenPremiumContent]),u("design:returntype",void 0)],l.prototype,"openPremiumContent",null),_([(0,o.rc)(d.ClosePremiumContent),u("design:type",Function),u("design:paramtypes",[Object,d.ClosePremiumContent]),u("design:returntype",void 0)],l.prototype,"closePremiumContent",null),_([(0,o.rc)(d.OpenUpgrade),u("design:type",Function),u("design:paramtypes",[Object,d.OpenUpgrade]),u("design:returntype",void 0)],l.prototype,"openUpgrade",null),_([(0,o.MD)(),u("design:type",Function),u("design:paramtypes",[class v{}]),u("design:returntype",void 0)],l,"getOpenDialog",null),l=_([(0,o.Uw)({name:"dialog",defaults:{openDialog:null}}),u("design:paramtypes",[r.o])],l);let m=(()=>{class H{static#e=this.\u0275fac=function(w){return new(w||H)};static#t=this.\u0275mod=c.$C({type:H});static#n=this.\u0275inj=c.G2t({imports:[e.MD,t.G,s.G,P.X1]})}return H})(),C=(()=>{class H{static#e=this.\u0275fac=function(w){return new(w||H)};static#t=this.\u0275mod=c.$C({type:H});static#n=this.\u0275inj=c.G2t({imports:[e.MD,t.G,s.G,P.X1]})}return H})(),b=(()=>{class H{static#e=this.\u0275fac=function(w){return new(w||H)};static#t=this.\u0275mod=c.$C({type:H});static#n=this.\u0275inj=c.G2t({imports:[e.MD,t.G,s.G,P.X1]})}return H})(),R=(()=>{class H{static#e=this.\u0275fac=function(w){return new(w||H)};static#t=this.\u0275mod=c.$C({type:H});static#n=this.\u0275inj=c.G2t({imports:[e.MD,t.G,s.G]})}return H})(),A=(()=>{class H{static#e=this.\u0275fac=function(w){return new(w||H)};static#t=this.\u0275mod=c.$C({type:H});static#n=this.\u0275inj=c.G2t({imports:[e.MD,t.G,P.YN,P.X1,s.G]})}return H})();var G=n(59464);let k=(()=>{class H{static#e=this.\u0275fac=function(w){return new(w||H)};static#t=this.\u0275mod=c.$C({type:H});static#n=this.\u0275inj=c.G2t({imports:[e.MD,t.G,s.G,P.X1]})}return H})(),V=(()=>{class H{static#e=this.\u0275fac=function(w){return new(w||H)};static#t=this.\u0275mod=c.$C({type:H});static#n=this.\u0275inj=c.G2t({imports:[e.MD,t.G,s.G,P.X1]})}return H})();var W=n(72026),T=n(11818);let x=(()=>{class H{static#e=this.\u0275fac=function(w){return new(w||H)};static#t=this.\u0275mod=c.$C({type:H});static#n=this.\u0275inj=c.G2t({imports:[e.MD,t.G,W.o,T.C]})}return H})();var z=n(36918);let I=(()=>{class H{static#e=this.\u0275fac=function(w){return new(w||H)};static#t=this.\u0275mod=c.$C({type:H});static#n=this.\u0275inj=c.G2t({imports:[e.MD,t.G,s.G,P.X1,z.e,a]})}return H})(),D=(()=>{class H{static#e=this.\u0275fac=function(w){return new(w||H)};static#t=this.\u0275mod=c.$C({type:H});static#n=this.\u0275inj=c.G2t({imports:[e.MD,t.G,s.G,P.X1]})}return H})(),L=(()=>{class H{static#e=this.\u0275fac=function(w){return new(w||H)};static#t=this.\u0275mod=c.$C({type:H});static#n=this.\u0275inj=c.G2t({imports:[e.MD,t.G,s.G,P.X1]})}return H})(),Q=(()=>{class H{static#e=this.\u0275fac=function(w){return new(w||H)};static#t=this.\u0275mod=c.$C({type:H});static#n=this.\u0275inj=c.G2t({imports:[e.MD,t.G,s.G,P.X1]})}return H})(),ie=(()=>{class H{static#e=this.\u0275fac=function(w){return new(w||H)};static#t=this.\u0275mod=c.$C({type:H});static#n=this.\u0275inj=c.G2t({imports:[e.MD,t.G,s.G,P.X1]})}return H})(),se=(()=>{class H{static#e=this.\u0275fac=function(w){return new(w||H)};static#t=this.\u0275mod=c.$C({type:H});static#n=this.\u0275inj=c.G2t({imports:[e.MD,t.G,s.G,P.X1]})}return H})();var Z=n(91060);let de=(()=>{class H{static#e=this.\u0275fac=function(w){return new(w||H)};static#t=this.\u0275mod=c.$C({type:H});static#n=this.\u0275inj=c.G2t({imports:[e.MD,t.G,s.G,P.YN,P.X1]})}return H})();var ae=n(35286);let q=(()=>{class H{static#e=this.\u0275fac=function(w){return new(w||H)};static#t=this.\u0275mod=c.$C({type:H});static#n=this.\u0275inj=c.G2t({imports:[e.MD,t.G,s.G,ae.y2.forChild()]})}return H})(),K=(()=>{class H{static#e=this.\u0275fac=function(w){return new(w||H)};static#t=this.\u0275mod=c.$C({type:H});static#n=this.\u0275inj=c.G2t({imports:[e.MD,t.G,s.G,P.X1,a]})}return H})(),j=(()=>{class H{static#e=this.\u0275fac=function(w){return new(w||H)};static#t=this.\u0275mod=c.$C({type:H});static#n=this.\u0275inj=c.G2t({imports:[e.MD,t.G,s.G]})}return H})(),M=(()=>{class H{static#e=this.\u0275fac=function(w){return new(w||H)};static#t=this.\u0275mod=c.$C({type:H});static#n=this.\u0275inj=c.G2t({imports:[e.MD,t.G,s.G,P.X1]})}return H})(),$=(()=>{class H{static#e=this.\u0275fac=function(w){return new(w||H)};static#t=this.\u0275mod=c.$C({type:H});static#n=this.\u0275inj=c.G2t({imports:[e.MD,t.G,s.G,P.X1]})}return H})(),ce=(()=>{class H{static#e=this.\u0275fac=function(w){return new(w||H)};static#t=this.\u0275mod=c.$C({type:H});static#n=this.\u0275inj=c.G2t({imports:[e.MD,t.G,s.G]})}return H})(),re=(()=>{class H{static#e=this.\u0275fac=function(w){return new(w||H)};static#t=this.\u0275mod=c.$C({type:H});static#n=this.\u0275inj=c.G2t({imports:[e.MD,t.G,s.G,P.X1]})}return H})(),ue=(()=>{class H{static#e=this.\u0275fac=function(w){return new(w||H)};static#t=this.\u0275mod=c.$C({type:H});static#n=this.\u0275inj=c.G2t({imports:[o.rK.forFeature([l]),O,f,K,E,se,y,i,x,g,p.I,h,m,C,b,R,A,k,V,I,Q,ie,re,G.j,S.D,s.G,q,j,M,$,ce,O,f,K,E,se,y,i,x,g,p.I,h,m,I,C,b,R,A,k,V,D,L,Q,ie,re,Z.w,de,q,j,M,$,ce]})}return H})()},66571:(le,N,n)=>{"use strict";n.d(N,{o:()=>ot});var e=n(93253),t=n(84370),s=n(65294),c=n(24418),O=n(34006),P=n(59e3),S=n(5690),a=n(54438),f=n(345),E=n(26779),y=n(21007);const i=["modalContents"];let g=(()=>{class je{constructor(Me,Ue,Ne,Xe,be,ke){this.dialogRef=Me,this.data=Ue,this.sanitizer=Ne,this.renderer=Xe,this.vendorAnalyticsService=be,this.productService=ke}onMessage(Me){switch(Me.data.action){case"close":this.dialogRef.close(Me.data);break;case"track":this.vendorAnalyticsService.track(Me.data.label,{...Me.data.metadata,platform:this.productService.productType})}}ngOnInit(){this.title=this.data.title,this.url=this.data.url?this.sanitizer.bypassSecurityTrustResourceUrl(this.data.url):"",this.renderer.setStyle(this.modalContents.nativeElement,"background-color",this.data.backgroundColor||"#ffffff")}closeDialog(){this.dialogRef.close()}static#e=this.\u0275fac=function(Ue){return new(Ue||je)(a.rXU(O.CP),a.rXU(O.Vh),a.rXU(f.up),a.rXU(a.sFG),a.rXU(P.e),a.rXU(S.b))};static#t=this.\u0275cmp=a.VBU({type:je,selectors:[["app-iframe-dialog"]],viewQuery:function(Ue,Ne){if(1&Ue&&a.GBs(i,7),2&Ue){let Xe;a.mGM(Xe=a.lsd())&&(Ne.modalContents=Xe.first)}},hostBindings:function(Ue,Ne){1&Ue&&a.bIt("message",function(be){return Ne.onMessage(be)},!1,a.tSv)},decls:6,vars:3,consts:[["modalContents",""],["role","dialog","aria-modal","true",1,"modal"],[1,"modal__contents"],["cdkFocusInitial","",1,"modal__frame",3,"src"],["app-button","","buttonTheme","light","buttonType","flat","buttonShape","circle","type","button","title","Close",1,"modal__close",3,"click"],["icon","times","size","lg"]],template:function(Ue,Ne){if(1&Ue){const Xe=a.RV6();a.j41(0,"div",1)(1,"div",2,0),a.nrm(3,"iframe",3),a.k0s(),a.j41(4,"button",4),a.bIt("click",function(){return a.eBV(Xe),a.Njj(Ne.closeDialog())}),a.nrm(5,"app-icon",5),a.k0s()()}2&Ue&&(a.BMQ("aria-label",Ne.title),a.R7$(3),a.Y8G("src",Ne.url,a.f$h),a.R7$(),a.BMQ("aria-label","Close"))},dependencies:[E.R,y.Q],styles:[".modal[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;position:relative}.modal__close[_ngcontent-%COMP%]{margin-bottom:4px;align-self:flex-end;cursor:pointer;position:absolute;right:12px;top:12px}.modal__contents[_ngcontent-%COMP%]{flex-grow:1}.modal__frame[_ngcontent-%COMP%]{width:100%;height:100%}"],changeDetection:0})}return je})();var p=n(49204),h=n(16823),o=n(21424),v=n(63308),d=n(15828),r=n(12215),_=n(65459),u=n(92014),l=n(85052),m=n(2573),C=n(99504),b=n(60177),R=n(87424),A=n(57018),G=n(21091),k=n(65115);function T(je,xe){1&je&&a.eu8(0)}function x(je,xe){1&je&&a.eu8(0)}function z(je,xe){if(1&je){const Me=a.RV6();a.j41(0,"div",11)(1,"app-team-invite",12),a.bIt("inviteSent",function(Ne){a.eBV(Me);const Xe=a.XpG();return a.Njj(Xe.handleInviteSent(Ne))})("inviteCancelled",function(){a.eBV(Me);const Ne=a.XpG();return a.Njj(Ne.handleInviteCancelled())}),a.k0s()()}if(2&je){const Me=a.XpG();a.R7$(),a.Y8G("organization",Me.organization)("layout","inline")}}function I(je,xe){1&je&&(a.j41(0,"div",13),a.nrm(1,"app-team-group-code"),a.k0s())}class D{constructor(xe,Me){this.dialogRef=xe,this.data=Me,this.sent=!1,this.sentResponses=[],this.errorResponses=[],this.ngUnsubscribe=new l.B,this.organization=Me.organization}ngOnInit(){}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}handleInviteSent(xe){setTimeout(()=>{this.inviteComplete()},5e3)}handleInviteCancelled(){this.inviteComplete()}inviteComplete(){this.dialogRef.close()}static#e=this.\u0275fac=function(Me){return new(Me||D)(a.rXU(O.CP),a.rXU(O.Vh))};static#t=this.\u0275cmp=a.VBU({type:D,selectors:[["app-team-invite-dialog"]],decls:15,vars:4,consts:[["inviteTmpl",""],["groupCodeTmpl",""],["mat-dialog-title",""],["mat-dialog-content",""],[1,"dialog"],["app-button","","buttonType","text","buttonTheme","light","type","button","title","Close",1,"dialog__close",3,"click"],["icon","times","size","lg"],["tabSize","medium","tabTheme","light","tabColor","red",3,"tabUnderline"],["label","Invite By Email"],[4,"ngTemplateOutlet"],["label","Share Code or Link"],[1,"theme-light","pt-6"],["sentText","Send invites","cancelText","Cancel",3,"inviteSent","inviteCancelled","organization","layout"],[1,"theme-light","py-6"]],template:function(Me,Ue){if(1&Me){const Ne=a.RV6();a.j41(0,"h1",2),a.EFF(1,"Invite Members"),a.k0s(),a.j41(2,"div",3)(3,"div",4)(4,"button",5),a.bIt("click",function(){return a.eBV(Ne),a.Njj(Ue.handleInviteCancelled())}),a.nrm(5,"app-icon",6),a.k0s(),a.j41(6,"app-tabs",7)(7,"app-tab",8),a.DNE(8,T,1,0,"ng-container",9),a.k0s(),a.j41(9,"app-tab",10),a.DNE(10,x,1,0,"ng-container",9),a.k0s()(),a.DNE(11,z,2,2,"ng-template",null,0,a.C5r)(13,I,2,0,"ng-template",null,1,a.C5r),a.k0s()()}if(2&Me){const Ne=a.sdS(12),Xe=a.sdS(14);a.R7$(4),a.BMQ("aria-label","Close"),a.R7$(2),a.Y8G("tabUnderline",!0),a.R7$(2),a.Y8G("ngTemplateOutlet",Ne),a.R7$(2),a.Y8G("ngTemplateOutlet",Xe)}},dependencies:[b.T3,O.BI,O.Yi,y.Q,E.R,R.j,A.O,G.G,k.H],styles:[".dialog[_ngcontent-%COMP%]{width:480px}.dialog__input[_ngcontent-%COMP%]{resize:vertical}.dialog__actions[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:center}.dialog__actions--compact[_ngcontent-%COMP%]{justify-content:flex-end}.dialog__close[_ngcontent-%COMP%]{position:absolute;right:24px;top:24px}@media (max-width: 480px){.dialog[_ngcontent-%COMP%]{width:100%}}"],changeDetection:0})}!function(je,xe,Me,Ue){var be,Ne=arguments.length,Xe=Ne<3?xe:null===Ue?Ue=Object.getOwnPropertyDescriptor(xe,Me):Ue;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)Xe=Reflect.decorate(je,xe,Me,Ue);else for(var ke=je.length-1;ke>=0;ke--)(be=je[ke])&&(Xe=(Ne<3?be(Xe):Ne>3?be(xe,Me,Xe):be(xe,Me))||Xe);Ne>3&&Xe&&Object.defineProperty(xe,Me,Xe)}([(0,u.l6)(C.e.getInviting),function(je,xe){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata("design:type",xe)}(0,m.c)],D.prototype,"inviting$",void 0);var L=n(89417),Q=n(37925),ie=n(4951),se=n(76115),Z=n(53236),de=n(68947),ae=n(17192),q=n(9940),K=n(95416),j=n(53719),M=n(14823),$=n(97352),ce=n(8961),re=function(je,xe,Me,Ue){var be,Ne=arguments.length,Xe=Ne<3?xe:null===Ue?Ue=Object.getOwnPropertyDescriptor(xe,Me):Ue;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)Xe=Reflect.decorate(je,xe,Me,Ue);else for(var ke=je.length-1;ke>=0;ke--)(be=je[ke])&&(Xe=(Ne<3?be(Xe):Ne>3?be(xe,Me,Xe):be(xe,Me))||Xe);return Ne>3&&Xe&&Object.defineProperty(xe,Me,Xe),Xe},ue=function(je,xe){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(je,xe)};const H=["emailField"];function te(je,xe){1&je&&(a.qex(0),a.j41(1,"div",15)(2,"app-message-toggle",16),a.EFF(3," Your email was successfully sent. "),a.k0s()(),a.bVm())}function F(je,xe){if(1&je&&(a.j41(0,"div",15)(1,"app-message-toggle",22),a.EFF(2),a.k0s()()),2&je){const Me=a.XpG(3);a.R7$(2),a.SpI(" ",Me.errorMessage," ")}}function w(je,xe){1&je&&a.nrm(0,"app-spinner",23)}function X(je,xe){1&je&&(a.j41(0,"div",25)(1,"mat-error"),a.EFF(2,"Please enter a valid email address."),a.k0s()())}function oe(je,xe){if(1&je&&(a.j41(0,"div",27)(1,"mat-error"),a.EFF(2),a.k0s()()),2&je){const Me=a.XpG(2).$implicit,Ue=a.XpG(3);a.R7$(2),a.Lme(" Maximum email addresses excceeded, ",Me.currentEmailCount," of ",Ue.maxEmailCount," max. ")}}function Y(je,xe){if(1&je&&a.DNE(0,oe,3,2,"div",26),2&je){const Me=a.XpG().$implicit;a.Y8G("ngIf",Me.maxEmailsExceeded)}}function he(je,xe){if(1&je&&(a.qex(0),a.DNE(1,X,3,0,"div",24)(2,Y,1,1,"ng-template",null,2,a.C5r),a.bVm()),2&je){const Me=xe.$implicit,Ue=a.sdS(3);a.R7$(),a.Y8G("ngIf",Me.invalidEmails)("ngIfElse",Ue)}}function ne(je,xe){if(1&je){const Me=a.RV6();a.DNE(0,F,3,1,"div",17),a.j41(1,"form",18),a.bIt("submit",function(){a.eBV(Me);const Ne=a.XpG(2);return a.Njj(Ne.submitForm(Ne.config.shareLink))}),a.j41(2,"textarea",19,1),a.EFF(4,"          "),a.k0s(),a.j41(5,"button",20),a.nI1(6,"async"),a.DNE(7,w,1,0,"app-spinner",21),a.nI1(8,"async"),a.EFF(9),a.nI1(10,"async"),a.k0s()(),a.DNE(11,he,4,2,"ng-container",6)}if(2&je){const Me=a.XpG(2);a.Y8G("ngIf",Me.errorMessage),a.R7$(),a.Y8G("formGroup",Me.form),a.R7$(4),a.Y8G("disabled",!Me.form.valid||a.bMT(6,7,Me.sharing$)),a.BMQ("aria-label","Send Email"),a.R7$(2),a.Y8G("ngIf",a.bMT(8,9,Me.sharing$)),a.R7$(2),a.SpI(" ",a.bMT(10,11,Me.sharing$)?"Sending":"Send Email"," "),a.R7$(2),a.Y8G("ngIf",Me.form.get("emails").errors)}}function _e(je,xe){if(1&je&&(a.qex(0),a.DNE(1,te,4,0,"ng-container",14)(2,ne,12,13,"ng-template",null,0,a.C5r),a.bVm()),2&je){const Me=a.sdS(3),Ue=a.XpG();a.R7$(),a.Y8G("ngIf",Ue.emailSent)("ngIfElse",Me)}}function Ce(je,xe){if(1&je&&(a.j41(0,"a",28),a.nI1(1,"titlecase"),a.nI1(2,"titlecase"),a.nrm(3,"img",9),a.k0s()),2&je){const Me=xe.$implicit;a.Y8G("href",Me.url,a.B4B)("matTooltip","Share via "+a.bMT(1,5,Me.type)),a.BMQ("aria-label","Share via "+a.bMT(2,7,Me.type))("data-test",Me.type+"LinkButton"),a.R7$(3),a.Y8G("src","/assets/images/social/"+Me.type+"-share.svg",a.B4B)}}function Be(je,xe){if(1&je&&(a.j41(0,"p",29),a.EFF(1),a.k0s()),2&je){const Me=a.XpG();a.R7$(),a.SpI(" ",Me.config.description," ")}}class Ie{constructor(xe,Me,Ue,Ne,Xe,be,ke,Re){this.store=xe,this.actions=Me,this.dialogRef=Ue,this.data=Ne,this.clipboardService=Xe,this.snackBar=be,this.formBuilder=ke,this.changeRef=Re,this.maxEmailCount=50,this.config={title:"Share"},this.emailSent=!1,this.errorMessage="",this.formError="",this.ngUnsubscribe=new l.B,this.config={...this.config,...Ne},this.initForm()}ngOnInit(){this.initEmailListeners()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initForm(){this.form=this.formBuilder.group({emails:["",L.k0.required,(0,se.H)(this.maxEmailCount).bind(this)]})}initEmailListeners(){this.actions.pipe((0,u.xi)(ae.Cg),(0,Q.Q)(this.ngUnsubscribe)).subscribe(()=>{this.emailSent=!1,this.errorMessage="",this.changeRef.markForCheck()}),this.actions.pipe((0,u.xi)(ae.zq),(0,Q.Q)(this.ngUnsubscribe)).subscribe(()=>{this.emailSent=!0,this.errorMessage="",setTimeout(()=>{this.emailSent=!1,this.form.setValue({emails:""}),this.changeRef.markForCheck(),setTimeout(()=>this.focus())},5e3),this.changeRef.markForCheck()}),this.actions.pipe((0,u.xi)(ae.Km),(0,Q.Q)(this.ngUnsubscribe)).subscribe(xe=>{this.emailSent=!1,this.errorMessage=(0,Z.u1)(xe.error)||"There was an error sending the email.",setTimeout(()=>this.focus()),this.changeRef.markForCheck()})}focus(){const xe=this.emailField?.nativeElement;xe&&xe.focus()}submitForm(xe){const{type:Me,title:Ue,relativeUrl:Ne,thumbUrl:Xe}=xe,be=de.l.parseEmails(this.form.value.emails);this.store.dispatch(new ae.Cg({share_type:Me,share_title:Ue,share_thumbnail_path:Xe,share_link_path:Ne,share_emails:be}))}handleCopyClick(xe,Me){this.clipboardService.copyToClipboard(xe,"url").pipe((0,Q.Q)(this.ngUnsubscribe)).subscribe(Ue=>{this.snackBar.open(`Link ${Ue?"copied":"not copied"}.`)}),Me.preventDefault()}handleCloseClick(){this.dialogRef.close()}static#e=this.\u0275fac=function(Me){return new(Me||Ie)(a.rXU(u.il),a.rXU(u.En),a.rXU(O.CP),a.rXU(O.Vh),a.rXU(ie.W),a.rXU(K.UG),a.rXU(L.ok),a.rXU(a.gRc))};static#t=this.\u0275cmp=a.VBU({type:Ie,selectors:[["app-share-url-dialog"]],viewQuery:function(Me,Ue){if(1&Me&&a.GBs(H,5),2&Me){let Ne;a.mGM(Ne=a.lsd())&&(Ue.emailField=Ne.first)}},decls:14,vars:9,consts:[["emailFormTmp",""],["emailField",""],["maxEmailErrorTmp",""],["mat-dialog-title",""],["mat-dialog-content",""],[1,"share-url-dialog"],[4,"ngIf"],[1,"share-url-dialog__social"],["target","_blank","aria-label","Copy Link","matTooltip","Copy Link","matTooltipPosition","below","data-test","copyLinkButton",1,"share-url-dialog__social-link",3,"click","href"],[3,"src"],["class","share-url-dialog__social-link","target","_blank","matTooltipPosition","below",3,"href","matTooltip",4,"ngFor","ngForOf"],["class","share-url-dialog__description my-3",4,"ngIf"],["mat-dialog-actions",""],["app-button","","buttonType","flat","buttonTheme","light","type","button","title","Close",1,"share-url-dialog__close",3,"click"],[4,"ngIf","ngIfElse"],[1,"my-2"],["type","message"],["class","my-2",4,"ngIf"],[1,"share-url-dialog__form",3,"submit","formGroup"],["rows","1","formControlName","emails","placeholder","Email, comma separated","data-test","emailEntryField",1,"share-url-dialog__input","input","theme-light"],["type","submit","app-button","","buttonType","primary","title","'Send Email'","data-test","emailLinkButton",1,"share-url-dialog__submit",3,"disabled"],["size","small","class","mr-2","render","inline",4,"ngIf"],["type","error"],["size","small","render","inline",1,"mr-2"],["class","my-1",4,"ngIf","ngIfElse"],[1,"my-1"],["class","flex flex-col my-1",4,"ngIf"],[1,"flex","flex-col","my-1"],["target","_blank","matTooltipPosition","below",1,"share-url-dialog__social-link",3,"href","matTooltip"],[1,"share-url-dialog__description","my-3"]],template:function(Me,Ue){1&Me&&(a.j41(0,"h1",3),a.EFF(1),a.k0s(),a.j41(2,"div",4)(3,"div",5),a.DNE(4,_e,4,2,"ng-container",6),a.nI1(5,"async"),a.j41(6,"div",7)(7,"a",8),a.bIt("click",function(Xe){return Ue.handleCopyClick(null==Ue.config.shareLink?null:Ue.config.shareLink.fullUrl,Xe)}),a.nrm(8,"img",9),a.k0s(),a.DNE(9,Ce,4,9,"a",10),a.k0s(),a.DNE(10,Be,2,1,"p",11),a.k0s()(),a.j41(11,"div",12)(12,"button",13),a.bIt("click",function(){return Ue.handleCloseClick()}),a.EFF(13," Close "),a.k0s()()),2&Me&&(a.R7$(),a.JRh(Ue.config.title),a.R7$(3),a.Y8G("ngIf",a.bMT(5,7,Ue.userProfile$)),a.R7$(3),a.Y8G("href",null==Ue.config.shareLink?null:Ue.config.shareLink.fullUrl,a.B4B),a.R7$(),a.Y8G("src","/assets/images/social/link-share.svg",a.B4B),a.R7$(),a.Y8G("ngForOf",null==Ue.config.shareLink?null:Ue.config.shareLink.social),a.R7$(),a.Y8G("ngIf",Ue.config.description),a.R7$(2),a.BMQ("aria-label","Close"))},dependencies:[b.Sq,b.bT,j.TL,O.BI,O.E7,O.Yi,M.oV,y.Q,$.tI,ce.X,L.qT,L.me,L.BC,L.cb,L.j4,L.JD,b.Jj,b.PV],styles:[".share-url-dialog__description[_ngcontent-%COMP%]{color:#61779e;font-size:.75rem;line-height:1rem}.share-url-dialog__form[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;gap:12px}.share-url-dialog__submit[_ngcontent-%COMP%]{flex:1 0 120px}.share-url-dialog__social[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:24px;margin-top:32px;margin-bottom:20px}.share-url-dialog__social-link[_ngcontent-%COMP%]{width:36px;height:36px;border-radius:100%;cursor:pointer}.share-url-dialog__social-link[_ngcontent-%COMP%]:focus{outline:#2d72dc solid 2px!important}.share-url-dialog__social-link[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%}.share-url-dialog__input[_ngcontent-%COMP%], .share-url-dialog__input[_ngcontent-%COMP%]:disabled{background-color:#f9fafd;color:#61779e;font-size:.75rem;line-height:1rem;opacity:1;resize:vertical;max-height:240px}@media (max-width: 480px){.share-url-dialog__form[_ngcontent-%COMP%]{flex-wrap:wrap}}"],changeDetection:0})}re([(0,u.l6)(h.k.getUserProfile),ue("design:type",m.c)],Ie.prototype,"userProfile$",void 0),re([(0,u.l6)(q.D.getSharing),ue("design:type",m.c)],Ie.prototype,"sharing$",void 0);var Oe=n(82633),Te=n(17215),ve=n(38645),Ve=n(21827);let we=(()=>{class je{constructor(Me,Ue,Ne,Xe){this.dialogRef=Me,this.router=Ue,this.storageService=Ne,this.data=Xe,this.requestOrganizationsText="",this.organizations=[]}ngOnInit(){this.organizations=this.data.organizations,this.storageService.setLocalItem(Te.UT.UserJoinPromptSeen,!0),this.dialogRef.afterClosed().subscribe(Me=>{Me&&this.router.navigateByUrl("/account/team")})}handleViewTeamsCancel(){this.dialogRef.close(!1)}handleViewTeamsClick(){this.dialogRef.close(!0)}static#e=this.\u0275fac=function(Ue){return new(Ue||je)(a.rXU(O.CP),a.rXU(ve.Ix),a.rXU(Te.n$),a.rXU(O.Vh))};static#t=this.\u0275cmp=a.VBU({type:je,selectors:[["app-user-join-dialog"]],decls:7,vars:2,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[3,"readonly","organizations"],["mat-dialog-actions",""],["app-button","","buttonType","primary",3,"click"]],template:function(Ue,Ne){1&Ue&&(a.j41(0,"h1",0),a.EFF(1,"We found your team"),a.k0s(),a.j41(2,"div",1),a.nrm(3,"app-team-join",2),a.k0s(),a.j41(4,"div",3)(5,"button",4),a.bIt("click",function(){return Ne.handleViewTeamsClick()}),a.EFF(6,"View Teams"),a.k0s()()),2&Ue&&(a.R7$(3),a.Y8G("readonly",!0)("organizations",Ne.organizations))},dependencies:[O.BI,O.E7,O.Yi,y.Q,Ve.H],changeDetection:0})}return je})();var Je=n(45438);function rt(je,xe){if(1&je&&(a.j41(0,"option",14),a.EFF(1),a.k0s()),2&je){const Me=xe.$implicit;a.Y8G("value",Me.role_id),a.R7$(),a.SpI(" ",Me.role_display_name," ")}}function Ke(je,xe){if(1&je&&(a.j41(0,"select",12),a.DNE(1,rt,2,2,"option",13),a.nI1(2,"async"),a.k0s()),2&je){const Me=a.XpG(2);a.R7$(),a.Y8G("ngForOf",a.bMT(2,1,Me.userRoles$))}}function et(je,xe){if(1&je&&(a.j41(0,"div",9),a.nrm(1,"app-team-user",10),a.DNE(2,Ke,3,3,"select",11),a.k0s()),2&je){const Me=xe.$implicit,Ue=xe.index,Ne=a.XpG();a.Y8G("formGroupName",Ue),a.R7$(),a.Y8G("user",Me)("showEmail",!0)("showNameUnknown",!0)("showRole",!1),a.R7$(),a.Y8G("ngIf",Ne.data.accept)}}class ge{constructor(xe,Me,Ue){this.dialogRef=xe,this.formBuilder=Me,this.data=Ue}ngOnInit(){this.action=this.data.accept?"approve":"deny";const xe="request"+(this.data.users.length>1?"s":"");this.title=`${(0,p.capitalize)(this.action)} ${(0,p.capitalize)(xe)}?`,this.text=`Are you sure you want to ${this.action} the following ${xe} to join your team?`,this.initForm()}initForm(){const xe=this.data.users.map(Me=>this.formBuilder.group({joinRequestKey:Me.joinRequestKey,roleId:Me.role.role_id}));this.form=this.formBuilder.group({joinRequests:new L.Bm(xe)})}createPayload(){const{joinRequests:xe}=this.form.value;return xe.map(this.data.accept?Me=>({join_request_key:Me.joinRequestKey,user_role_id:parseInt(Me.roleId)}):Me=>Me.joinRequestKey)}handleConfirmClick(){this.dialogRef.close(this.createPayload())}static#e=this.\u0275fac=function(Me){return new(Me||ge)(a.rXU(O.CP),a.rXU(L.ze),a.rXU(O.Vh))};static#t=this.\u0275cmp=a.VBU({type:ge,selectors:[["app-team-join-dialog"]],decls:13,vars:5,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"dialog",3,"formGroup"],["formArrayName","joinRequests"],[1,"my-3","text-sm"],["class","flex space-between align-center my-2 py-2",3,"formGroupName",4,"ngFor","ngForOf"],["mat-dialog-actions",""],["app-button","","buttonTheme","light","mat-dialog-close",""],["app-button","","buttonType","primary",3,"click"],[1,"flex","space-between","align-center","my-2","py-2",3,"formGroupName"],[1,"flex","grow",3,"user","showEmail","showNameUnknown","showRole"],["class","input w-auto","formControlName","roleId",4,"ngIf"],["formControlName","roleId",1,"input","w-auto"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(Me,Ue){1&Me&&(a.j41(0,"h1",0),a.EFF(1),a.k0s(),a.j41(2,"div",1)(3,"div",2)(4,"div",3)(5,"div",4),a.EFF(6),a.k0s(),a.DNE(7,et,3,6,"div",5),a.k0s()()(),a.j41(8,"div",6)(9,"button",7),a.EFF(10,"Cancel"),a.k0s(),a.j41(11,"button",8),a.bIt("click",function(){return Ue.handleConfirmClick()}),a.EFF(12),a.k0s()()),2&Me&&(a.R7$(),a.JRh(Ue.title),a.R7$(2),a.Y8G("formGroup",Ue.form),a.R7$(3),a.JRh(Ue.text),a.R7$(),a.Y8G("ngForOf",Ue.data.users),a.R7$(5),a.SpI(" ",Ue.action," "))},dependencies:[b.Sq,b.bT,O.tx,O.BI,O.E7,O.Yi,y.Q,Je.o,L.xH,L.y7,L.wz,L.BC,L.cb,L.j4,L.JD,L.$R,L.v8,b.Jj],changeDetection:0})}!function(je,xe,Me,Ue){var be,Ne=arguments.length,Xe=Ne<3?xe:null===Ue?Ue=Object.getOwnPropertyDescriptor(xe,Me):Ue;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)Xe=Reflect.decorate(je,xe,Me,Ue);else for(var ke=je.length-1;ke>=0;ke--)(be=je[ke])&&(Xe=(Ne<3?be(Xe):Ne>3?be(xe,Me,Xe):be(xe,Me))||Xe);Ne>3&&Xe&&Object.defineProperty(xe,Me,Xe)}([(0,u.l6)(h.k.getUserRoles),function(je,xe){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata("design:type",xe)}(0,m.c)],ge.prototype,"userRoles$",void 0);var Ee=n(83621);const $e={maxWidth:"100vw",width:"100vw",height:"100vh",panelClass:"full-modal"};let ot=(()=>{class je{get isMobile(){return window.innerWidth<=959}constructor(Me,Ue,Ne,Xe,be,ke,Re){this.dialog=Me,this.applicationEventService=Ue,this.router=Ne,this.store=Xe,this.vendorAnalyticsService=be,this.productService=ke,this.organizationsService=Re}openShareDialog(Me,Ue,Ne){return this.dialog.open(Ie,{id:t.t.ShareUrlDialog,data:{title:Ue,description:Ne,shareLink:Me},width:"480px",maxWidth:"90vw"})}openConfirmDialog(Me){const Ue={id:t.t.ConfirmDialog,...Me};return this.dialog.open(e.w,Ue)}openUpgradeDialog(Me=!0){Me&&this.closeAllDialogs();const Ue=this.store.selectSnapshot(h.k.getUserProfile),Ne=this.getContactProfileParams(Ue),Xe=Ue.premium_account_valid?Ue.premium_account_type:"free",be=(0,p.get)(Ue,"organizations[0].subscription.type","").toLowerCase(),ke=this.store.selectSnapshot(o.q.isSubscriptionExpired),Re=Ue.premium_account_eligibility.group_free_trial,dt=(0,v.j)(Ue.account_settings),yt=(0,p.get)(dt,"account_purpose.value","");let Dt;if(c.c.native)Dt="mobile.html";else switch(yt){case d.j.Business:Dt="business.html";break;case d.j.Education:Dt="school.html";break;default:Dt="individual.html"}const Ft={...Ne,accountType:Xe,subscription:be,expired:ke,groupFreeTrial:Re},jt=`${c.c.native?"":{[r.Z.Local]:"https://localhost:1234",[r.Z.QA]:"https://pricing-qa.biodigital.com",[r.Z.Staging]:"https://pricing.biodigital.com",[r.Z.Production]:"https://pricing.biodigital.com"}[c.c.deploy]}/${Dt}?${this.serializeQueryParams(Ft)}`,wt={id:t.t.PricingDialog,...$e,data:{title:"Upgrade",url:jt,backgroundColor:"#0B1220"}},Et=encodeURIComponent(this.router.url);return this.dialog.open(g,wt).afterClosed().subscribe(zt=>{if(zt){const Rt={action:"",plan:"",...zt.metadata},Gt={business:["starter","premium","enterprise"],education:["class","institution"]};let vt="Individual";Object.entries(Gt).forEach(([$t,Xt])=>{Xt.indexOf(Rt.plan)&&(vt=$t)}),Rt.action&&this.vendorAnalyticsService.track(`Pricing - ${(0,p.capitalize)(Rt.action)} - ${(0,p.capitalize)(Rt.plan)}`,{platform:this.productService.productType,page:vt});let Bt="";switch(Rt.action){case"buy":if(c.c.native)return void this.applicationEventService.fireEvent(s.F.NativeUpgrade);this.router.navigate(["/account/profile"],{queryParams:{section:"subscription",mode:"edit"}});break;case"contact":this.openContactDialog("pricing page");break;case"try":switch(!0){case Gt.business.includes(Rt.plan):Bt=`/account/workflow/team/create?purpose=Business&returnTo=${Et}`;break;case Gt.education.includes(Rt.plan):Bt=`/account/workflow/team/create?purpose=Education&returnTo=${Et}`;break;default:Bt="account/workflow"}this.router.navigateByUrl(Bt)}}else this.vendorAnalyticsService.track("Pricing - Exit")})}openContactDialog(Me=""){const Ue=this.store.selectSnapshot(o.q.getOrganization),Ne=(0,p.isNil)(Ue)?"":`${Ue.id}`,Xe=this.store.selectSnapshot(h.k.getUserProfile),be=this.getContactProfileParams(Xe),ke={[r.Z.Local]:"http://craft-sandbox.biodigital.local",[r.Z.QA]:"http://craft-sandbox.biodigital.local",[r.Z.Staging]:"https://www.biodigital.com",[r.Z.Production]:"https://www.biodigital.com"},Re=c.c.native?ke[r.Z.Production]:ke[c.c.deploy];if(c.c.native){const dt=this.serializeQueryParams({...be,organizationId:Ne,utm_source:"human-mobile",utm_campaign:Me});return window.open(`${Re}/contact?${dt}`,"_blank")}{const yt=`${Re}/headless/contact-us?${this.serializeQueryParams({...be,organizationId:Ne,utm_source:"human-web",utm_campaign:Me})}`,Dt={id:t.t.ContactDialog,...$e,data:{title:"Contact Us",url:yt}};return this.dialog.open(g,Dt)}}openPremiumContentDialog(){const Me=c.c.native||!this.isMobile;return this.openConfirmDialog({id:t.t.PremiumContentDialog,data:{titleText:"Premium Content",bodyText:Me?"This is premium content. Upgrade to a Premium Plan for unlimited access.":"This is premium content. Visit us on desktop to upgrade to a premium plan.",confirmText:"Upgrade Now",confirmEnabled:Me,cancelText:"OK",confirmColor:"warn"}})}openAddUserDialog(){const Me=this.store.selectSnapshot(o.q.getOrganization);this.dialog.open(D,{id:t.t.AddTeamModelDialog,disableClose:!1,data:{organization:Me}})}openWelcomeTourDialog(Me,Ue){const Ne={id:t.t.WelcomeTourDialog,disableClose:!1,data:{userType:Me},...Ue};return this.dialog.open(Oe.A,Ne)}openUserJoinDialog(Me,Ue){return this.dialog.open(we,{width:"480px",data:{userEmail:Me,organizations:Ue}})}openTeamJoinDialog(Me,Ue){return this.dialog.open(ge,{width:"480px",disableClose:!1,data:{users:Me,accept:Ue}})}closeAllDialogs(){this.dialog.closeAll()}getContactProfileParams(Me){const{first_name:Ue,last_name:Ne,email:Xe}=Me,be=(0,p.get)(Me,"organizations[0].name",""),ke=(0,p.get)(Me,"organizations[0].group_attributes",[]),Re=(0,v.j)(Me.account_settings),dt=(0,p.get)(Re,"account_purpose.value",""),yt=(0,p.get)(Re,"account_field.value",""),Dt=(0,p.get)(Re,"account_field.value",""),Ft=(0,p.get)(Re,"account_role.value",""),ze=this.organizationsService.getOrganizationAttribute(ke,"account_settings","account_company_size"),It=this.organizationsService.getOrganizationAttribute(ke,"account_settings","account_company_website");return{first_name:Ue,last_name:Ne,email:Xe,company:be,website:It?It.value:"",purpose:dt,role:Ft,program_type:Dt,program_size:ze?ze.value:"",industry:dt===d.j.Education?"Academia":yt}}serializeQueryParams(Me){return Object.entries(Me).map(([Ue,Ne])=>{const Xe="string"!=typeof Ne?JSON.stringify(Ne):Ne;return`${Ue}=${encodeURIComponent(Xe)}`}).join("&")}static#e=this.\u0275fac=function(Ue){return new(Ue||je)(a.KVO(O.bZ),a.KVO(Ee.S),a.KVO(ve.Ix),a.KVO(u.il),a.KVO(P.e),a.KVO(S.b),a.KVO(_.k))};static#t=this.\u0275prov=a.jDH({token:je,factory:je.\u0275fac,providedIn:"root"})}return je})()},84370:(le,N,n)=>{"use strict";n.d(N,{t:()=>e});var e=function(t){return t.AboutDialog="AboutDialog",t.AddTeamModelDialog="AddTeamModelDialog",t.AssignUserRoleDialog="AssignUserRoleDialog",t.BulkUpdateDialog="BulkUpdateDialog",t.BookmarkAccessDialog="BookmarkAccessDialog",t.ShareUrlDialog="ShareUrlDialog",t.ConfirmDialog="ConfirmDialog",t.ContactDialog="ContactDialog",t.GroupRestrictionDialog="GroupRestrictionDialog",t.ImageDialog="ImageDialog",t.VideoDialog="VideoDialog",t.ImportDialog="ImportDialog",t.JoinDomainDialog="JoinDomainDialog",t.LimitDialog="LimitDialog",t.ManageDialog="ManageDialog",t.PremiumContentDialog="PremiumContentDialog",t.PricingDialog="PricingDialog",t.ProfileDialog="ProfileDialog",t.QuizSettingsDialog="QuizSettingsDialog",t.SaveAsBookmarkDialog="SaveAsBookmarkDialog",t.SaveBookmarkDialog="SaveBookmarkDialog",t.SaveModuleDialog="SaveModuleDialog",t.TransferUserContentDialog="TransferUserContentDialog",t.RemoveUserDialog="RemoveUserDialog",t.MergeModuleDialog="MergeModuleDialog",t.MergeConflictDialog="MergeConflictDialog",t.WelcomeTourDialog="WelcomeTourDialog",t.TrialExpiredDialog="TrialExpiredDialog",t.PremiumAccessDialog="PremiumAccessDialog",t.ConfirmRoleDialog="ConfirmRoleDialog",t.CollectionNameDialog="CollectionNameDialog",t.PublicViewGateDialog="PublicViewGateDialog",t.BookmarkJobsDialog="BookmarkJobsDialog",t.BulkAddModelDialog="BulkAddModelDialog",t.BulkDeleteModelDialog="BulkDeleteModelDialog",t}(e||{})},45434:(le,N,n)=>{"use strict";n.d(N,{m:()=>e});class e{constructor(s={center:[0,0,0],edge:[1,1,1],centerBias:1,edgeBias:0,power:1}){const{edge:c,center:O,centerBias:P,edgeBias:S,power:a}=s;this.edge=c,this.center=O,this.centerBias=P,this.edgeBias=S,this.power=a}static toEngine(s){const{center:c,edge:O,centerBias:P,edgeBias:S,power:a}=s;return[[...c],[...O],P,S,a]}}},63365:(le,N,n)=>{"use strict";n.d(N,{H:()=>f,Sf:()=>E,_M:()=>h,_U:()=>S,_o:()=>a,ql:()=>y});var e=n(45434),t=n(1367),s=n(49204);function O(o,v){switch(!0){case void 0===o[v]:return;case!1===o[v]:return!1;case"number"==typeof o[v]:return 100*o[v];default:return new t.R({center:o[v][0],edge:o[v][1],centerBias:o[v][2],edgeBias:o[v][3],power:o[v][4]})}}function S(o){return!(0,s.isNil)(o)&&Object.prototype.hasOwnProperty.call(o,"edge")&&Object.prototype.hasOwnProperty.call(o,"edgeBias")&&Object.prototype.hasOwnProperty.call(o,"center")&&Object.prototype.hasOwnProperty.call(o,"centerBias")&&Object.prototype.hasOwnProperty.call(o,"power")}function a(o){return Array.isArray(o)&&3===o.length}function f(o){return{tintColor:(()=>{switch(!0){case void 0===o.tintColor:return;case!1===o.tintColor:return!1;case Array.isArray(o.tintColor):return 3===o.tintColor.length?[...o.tintColor]:new e.m({center:o.tintColor[0],edge:o.tintColor[1],centerBias:o.tintColor[2],edgeBias:o.tintColor[3],power:o.tintColor[4]})}})(),saturation:O(o,"saturation"),brightness:O(o,"brightness"),contrast:O(o,"contrast"),opacity:O(o,"opacity")}}function E(o){let v=!1!==o.tintColor&&void 0,d=!1!==o.saturation&&void 0,r=!1!==o.brightness&&void 0,_=!1!==o.contrast&&void 0,u=!1!==o.opacity&&void 0;return Array.isArray(o.tintColor)?v=[...o.tintColor]:S(o.tintColor)&&(v=e.m.toEngine(o.tintColor)),"number"==typeof o.saturation?d=o.saturation/100:S(o.saturation)&&(d=t.R.toEngine(o.saturation)),"number"==typeof o.brightness?r=o.brightness/100:S(o.brightness)&&(r=t.R.toEngine(o.brightness)),"number"==typeof o.contrast?_=o.contrast/100:S(o.contrast)&&(_=t.R.toEngine(o.contrast)),"number"==typeof o.opacity?u=o.opacity/100:S(o.opacity)&&(u=t.R.toEngine(o.opacity)),{tintColor:v,saturation:d,brightness:r,contrast:_,opacity:u}}function y(o,v){const d=Object.assign({},o);for(const[r,_]of Object.entries(v))typeof _<"u"&&(d[r]=_);return d}function h(o){return"number"==typeof o.opacity||S(o.opacity)}},45415:(le,N,n)=>{"use strict";n.d(N,{x:()=>e});var e=function(t){return t.Chapter="chapter",t.Label="label",t.Paint="paint",t.Positions="positions",t.Quiz="quiz",t.Image="image",t}(e||{})},58398:(le,N,n)=>{"use strict";n.d(N,{Jl:()=>O,UD:()=>P,c7:()=>a,n4:()=>c});var e=n(49204);function c(f,E){return!(!f||!E)&&JSON.stringify(f,Object.keys(f).sort())===JSON.stringify(E,Object.keys(E).sort())}function O(f){return!(0,e.isNil)(f)&&(!(0,e.isNil)(f.brightness)&&!1!==f.brightness||!(0,e.isNil)(f.contrast)&&!1!==f.contrast||!(0,e.isNil)(f.opacity)&&!1!==f.opacity||!(0,e.isNil)(f.saturation)&&!1!==f.saturation||!(0,e.isNil)(f.tintColor)&&!1!==f.tintColor)}function P(f,E){try{const y=S(f),i=S(E),g=!1===f.opacity?1:f.opacity,p=!1===E.opacity?1:E.opacity;return y===i?g===p?f.saturation===E.saturation?f.brightness===E.brightness?f.contrast>E.contrast?y+4:y-4:f.brightness>E.brightness?y+3:y-3:f.saturation>E.saturation?y+2:y-2:g>p?y+1:y-1:y-i}catch{return 0}}function S(f){if(!f.tintColor)return-10;const E=f.tintColor[0],y=f.tintColor[1],i=f.tintColor[2],g=Math.max(E,y,i),h=g-Math.min(E,y,i);let o=0;return o=g===E?(y-i)/h:g===y?2+(i-E)/h:4+(E-y)/h,o*=60,o<0&&(o+=360),o}function a(f){const E=new Map;return f.filter(i=>{const g=JSON.stringify(i,Object.keys(i));return!E.has(g)&&(E.set(g,!0),!0)})}},68114:(le,N,n)=>{"use strict";n.d(N,{u:()=>e});var e=function(t){return t[t.Modify=0]="Modify",t[t.Replace=1]="Replace",t}(e||{})},1367:(le,N,n)=>{"use strict";n.d(N,{R:()=>e});class e{constructor(s={center:0,edge:1,centerBias:1,edgeBias:0,power:1}){const{edge:c,center:O,centerBias:P,edgeBias:S,power:a}=s;this.edge=c,this.center=O,this.centerBias=P,this.edgeBias=S,this.power=a}static toEngine(s){const{center:c,edge:O,centerBias:P,edgeBias:S,power:a}=s;return[c,O,P,S,a]}static isFresnelObject(s){let c=!1;return s&&(c="center,centerBias,edge,edgeBias,power"==Object.keys(s).sort().toString()),c}}},21894:(le,N,n)=>{"use strict";n.d(N,{F:()=>e,i:()=>t});class e{constructor(){this.graph={unavailable:!1,hidden:!1,clipped:!1}}}const t={unavailable:"Trim objects that are un-available in ALL chapters",hidden:"Trim objects that are hidden in ALL chapters.",clipped:"Trim FULLY clipped objects in the CURRENT chapter."}},84426:(le,N,n)=>{"use strict";n.d(N,{g:()=>q});var P,e=n(21164),t=n(49204),s=n(79805),c=n(23881),O=n(12347);!function(K){function j(re,ue){const H=Object.entries(ue);return H.sort((te,F)=>te[0].length===F[0].length?0:te[0].length<F[0].length?1:-1),H.reduce((te,[F,w])=>{if(te.startsWith(F)){const X=new RegExp(`^${F}`);te=te.replace(X,w)}return te},re||"")}K.renamespaceValue=j,K.renamespaceKeys=function M(re,ue){return Object.entries(re).reduce((H,[te,F])=>(H[j(te,ue)]=F,H),{})},K.renamespaceAssetLibrary=function $(re,ue,H){if(!H)return re;const te=re.tweens.map(w=>j(w,ue)),F=re.reflections.map(w=>j(w,ue));return{...re,tweens:te,reflections:F}},K.renamespaceReflections=function ce(re,ue,H){return H?(0,t.mapValues)(re,te=>j(te,ue)):re}}(P||(P={}));var S=n(38157),a=n(38970);const f=["objectId","displayName","geometryId","morphId","materialId","transformId"],E=["geometryId","materialId","morphId"];function y(K,j){return{availableObjects:(0,t.mapKeys)(K.availableObjects,(H,te)=>P.renamespaceValue(te,j)),showObjects:(0,t.mapKeys)(K.showObjects,(H,te)=>P.renamespaceValue(te,j)),selectObjects:(0,t.mapKeys)(K.selectObjects,(H,te)=>P.renamespaceValue(te,j)),pickThroughObjects:(0,t.mapKeys)(K.pickThroughObjects,(H,te)=>P.renamespaceValue(te,j)),synchronization:(0,t.mapKeys)(K.synchronization,(H,te)=>P.renamespaceValue(te,j))}}function i(K,j){const M=$=>$.map(ce=>ce.type===S.X.flyToChapter||ce.type===S.X.flyToObject?{...ce,value:P.renamespaceValue(ce.value,j)}:ce);return(K||[]).map($=>({...$,objectId:P.renamespaceValue($.objectId,j),states:$.states.map(ce=>({...ce,errands:M(ce.errands)}))}))}function g(K,j){return(K||[]).map(M=>(M.data.timeline=j[M.data.timeline]||M.data.timeline,M))}function p(K,j){return(K||[]).map(M=>(M.objectId&&(M.objectId=P.renamespaceValue(M.objectId,j)),M))}function h(K,j){return K?{xray:(0,t.mapKeys)(K.xray,(M,$)=>P.renamespaceValue($,j)),highlight:(0,t.mapKeys)(K.highlight,(M,$)=>P.renamespaceValue($,j))}:{}}function o(K,j){const $={...K};return Array.isArray(K?.layers)&&($.layers=K.layers.map(ce=>({...ce,objectIds:ce.objectIds.map(re=>P.renamespaceValue(re,j))}))),$}function r(K,j){return K.forEach(M=>{f.forEach($=>{const ce=M[$];ce&&"string"==typeof ce&&(M[$]=P.renamespaceValue(ce,j))}),M.renderables?.forEach($=>{E.forEach(ce=>{const re=$[ce];re&&"string"==typeof re&&($[ce]=P.renamespaceValue(re,j))})}),M.objects&&r(M.objects,j)}),K}function _(K,j){function M(re=[]){return re.map(ue=>({...ue,src:P.renamespaceValue(ue.src,j)}))}let ce=[];return K&&Array.isArray(K.particleSystems)&&(ce=K.particleSystems.map(function $(re){return(0,a.bF)(re)?{...re,textures:M(re.textures)}:{...re}})),ce}function u(K,j){const M=function d(K,j){return"string"==typeof K?[j[K]||K]:K.map(M=>j[M]||M)}(K.stateId,j),$=K.assetLibraries.tweens.map(F=>P.renamespaceValue(F,j)),ce=K.assetLibraries.reflections.map(F=>P.renamespaceValue(F,j)),re=(0,t.mapValues)(K.reflections,(F,w)=>P.renamespaceValue(F,j)),ue=function v(K,j){return K.map(M=>({...M,...y(M,j),colorRecipeObjects:h(M.colorRecipeObjects,j),timelineMap:g(M.timelineMap,j),labels:i(M.labels,j),hotspots:p(M.hotspots,j),visibilityLayers:o(M.visibilityLayers,j)}))}(K.chapters,j),H=r(K.sceneGraph,j),te={...K.customData,particleSystems:_(K.customData,j)};return{...K,stateId:M,...y(K,j),assetLibraries:{...K.assetLibraries,tweens:$,reflections:ce},reflections:re,chapters:ue,sceneGraph:H,customData:te}}var l=n(38753),m=n(12921),C=n(87710),b=n(44867),R=n(18171),A=n(13409),G=n(60286),k=n(76724),V=n(35650),W=n(11724),T=n(38472);const x=1e-4;function z(K,j){const M={};return Math.abs(K[0]-j)>=x&&(M.x=K[0]),Math.abs(K[1]-j)>=x&&(M.y=K[1]),Math.abs(K[2]-j)>=x&&(M.z=K[2]),M.x||M.y||M.z?M:null}function L(K,j){if(j[K.objectId])return null;let M={objectId:K.objectId,displayName:K.displayName,layer:K.layer};return K.transformId?M.transformId=K.transformId:M=function I(K,j){const M=W.vec3Pool.get();T.scale(M,K.sceneNode.rotation,180/Math.PI);const $={translate:z(K.sceneNode.position,0),rotate:z(M,0),scale:z(K.sceneNode.scale,1),pivot:z(K.sceneNode.origin,0)};return W.vec3Pool.release(M),(0,t.isNull)($.translate)||(j.translate=$.translate),(0,t.isNull)($.rotate)||(j.rotate=$.rotate),(0,t.isNull)($.scale)||(j.scale=$.scale),(0,t.isNull)($.pivot)||(j.pivot=$.pivot),j.transformId&&(console.error("There should not be a transform"),delete j.transformId),j}(K,M),M=function D(K,j){const $=Q(K.renderables??[]);return 1===$.length?(0,t.merge)(j,$[0]):$.length>1&&(j.renderables=$),j}(K,M),K.children&&K.children.length&&(M.objects=[]),K.children.forEach($=>{const ce=L($,j);null!==ce&&M.objects.push(ce)},this),K.variants?.length>1&&(M.variants=K.variants.map($=>Q($))),M}function Q(K){return K.map(j=>{const{geometryId:M,morphId:$,materialId:ce,layer:re}=j;return{geometryId:M,morphId:$,materialId:ce,layer:re}})}var se=n(94495),Z=n(2096),de=n(54438),ae=n(92014);let q=(()=>{class K{constructor(M,$,ce,re,ue,H,te,F){this.store=M,this.engineService=$,this.chapterSerializer=ce,this.animationService=re,this.chapterService=ue,this.paintService=H,this.clippingPlanesService=te,this.sceneService=F}serializeUI(M){const $={...M.ui};return M.chapters.length>1&&($.scrubber=!1,$.playPause=!1,$.tour={chapters:!0}),$}serializeAnimation(M){return this.animationService.isChapterAnimated(M)?{play:{startTime:M.timelineMap[0].start,loop:!1!==M.loop,numChapters:1}}:{}}getClippedObjects(){const M=this.store.selectSnapshot(se.N.getSelectedChapterClippingPlanes),$=this.clippingPlanesService.createEngineClippingPlanes(M);return 0===$.length?{}:this.sceneService.getLeafIds().reduce((ce,re)=>{const ue=this.sceneService.getObjectById(re);return this.sceneService.isObjectCulledByClip(ue,$)&&(ce[re]=!0),ce},{})}generateTrimObjectMap(M){const $={};if(M.graph.unavailable){const re=this.store.selectSnapshot(A.z.getAllNodeState);Object.values(re).forEach(ue=>{Object.entries(ue).forEach(([H,te])=>{!1!==$[H]&&($[H]=!te.available)})})}if(M.graph.hidden){const re=this.store.selectSnapshot(A.z.getAllNodeState);Object.values(re).forEach(ue=>{Object.entries(ue).forEach(([H,te])=>{!1!==$[H]&&($[H]=!(te.shown||te.shownSetByTween))})})}const ce=M.graph.clipped?this.getClippedObjects():{};return{...$,...ce}}trimObjects(M,$){if($[M.objectId])return null;const ce=[];return M.children.forEach(re=>{const ue=this.trimObjects(re,$);(0,t.isNil)(ue)||ce.push(ue)}),M.children=ce,M}serialize(M,$,ce=!1,re,ue,H,te=!1){const F=(0,t.cloneDeep)(re),w=this.generateTrimObjectMap($),X=this.sceneService.getRootObjects();F.sceneGraph=function ie(K,j){const M=[];return Object.entries(K).forEach(([$,ce])=>{const re=L(ce,j);null!==re&&M.push(re)},this),M}(X,w);const oe=[];Object.values(X).forEach(we=>{const Je=this.trimObjects(we,w);null!==Je&&oe.push(Je)},this);const Y=(0,c.ow)(this.paintService.getColorRecipes()),he=(0,b.fm)(oe,Y),ne=this.store.selectSnapshot(l.y.getLabels);F.chapters=ue.map(we=>this.chapterSerializer.serializeChapter(he,we,M,ne,H,te)),F.ui=this.serializeUI(F),F.animation=this.serializeAnimation(ue[0]),F.customData={...F.customData,particleSystems:this.store.selectSnapshot(m.B.getParticleSystemsList)},F.sourceInfo=(0,Z.CE)(F.sourceInfo);const _e=this.store.selectSnapshot(C.j.getAllQuestions),Ce=this.store.selectSnapshot(C.j.getQuizSettings);Ce&&_e.length>0?F.quizSettings=Ce:delete F.quizSettings,F.playthroughSettings=re.playthroughSettings,F.tweenParticleLookup=this.store.selectSnapshot(m.B.getTweenParticleLookup);const Be=ue.reduce((we,Je)=>we.concat(this.chapterService.getChapterLightLibraries(Je)),[]),Ie=Array.from(new Set(Be));F.assetLibraries.lights.forEach(we=>{Ie.includes(we)||Ie.push(we)}),F.assetLibraries.lights=Ie;const Oe=this.getReflectionLibraries(F.reflections),Te=ue.reduce((we,Je)=>we.concat(this.chapterService.getChapterReflectionLibraries(Je)),[]);F.assetLibraries.reflections=Array.from(new Set(Oe.concat(Te)));const ve=[...Object.values(F.assetLibraries)].flat(),Ve=this.getSceneGraphStateIds(F.sceneGraph);return F.stateId=Array.from(new Set(ve.map(this.getStateId).concat(Ve))),(0,t.isEmpty)(re.variantSchemas)?delete F.variantSchemas:F.variantSchemas=re.variantSchemas,{story:ce?u(F,M):F}}getReflectionLibraries(M){return M=M||{},Object.values(M).map(ce=>{const re=ce.split(".");return[re[0],re[1]].join("/")})}getSceneGraphStateIds(M){return M.map($=>$.objectId.split("-")[0])}getStateId(M){return M.split("/")[0]}static#e=this.\u0275fac=function($){return new($||K)(de.KVO(ae.il),de.KVO(s.y),de.KVO(e.p),de.KVO(O.O),de.KVO(R.j),de.KVO(G.s),de.KVO(k.h),de.KVO(V.w))};static#t=this.\u0275prov=de.jDH({token:K,factory:K.\u0275fac,providedIn:"root"})}return K})()},21164:(le,N,n)=>{"use strict";n.d(N,{p:()=>R});var e=n(23881),t=n(49204),s=n(8358),c=n(44867),P=n(287);var y=n(13409),i=n(63365),g=n(29284),p=n(12921),h=n(87710),o=n(65650),v=n(60286),d=n(63508),r=n(92333),_=n(56343),u=n(3829),l=n(54438),m=n(92014);const b={play:{count:1}};let R=(()=>{class A{constructor(k,V,W){this.store=k,this.labelService=V,this.paintService=W}getMinimumGraphSync(k,V,W){const T=this.paintService.getColorRecipes(),x=Object.keys((0,e.ow)(T)),z=function O(A,G,k){const V={},W={};return(0,c.Wy)(A,x=>{W[x]=(0,c.jX)(A,x)?{...(0,c._D)(A,x,k),...G[x]||{}}:{...W[A.predecessors[x]],...G[x]||{}},(0,c.xe)(A,x)&&(V[x]=W[x])}),V}(k,V,x),I=function C(A){return A.reduce((G,k)=>(G[k]=_.t.MajorityWins,G),{available:_.t.MajorityWins,shown:_.t.MajorityWins,selected:_.t.MajorityWins,pickable:_.t.MajorityWins})}(T),D=function E(A,G,k){const V=Object.keys(G),W=Object.keys(k),T=(0,P.sO)(k,V),x=(0,P.FV)(W,A),z=(0,t.range)(x,-1).reduce((L,Q)=>{const ie=(0,P.AY)(A,Object.keys(L.remainingVoters),Q),se=(0,P.kK)(A,L.remainingVoters,ie,G),Z=function a(A){return A.reduce((G,k)=>{const T=Object.keys(k).map(x=>function S(A,G,k,V){const W=V.reduce((T,x)=>(T[x]={[A]:!k},T),{});return W[G]={[A]:k},W}(x,k[x].id,k[x].result,k[x].dissenters)).reduce((x,z)=>(0,t.merge)(x,z),{});return Object.keys(T).forEach(x=>{G[x]=T[x]}),G},{})}(se.results);return Object.keys(Z).forEach(de=>{L.syncGraph[de]=Z[de]}),L.remainingVoters=se.remainingVoters,L},{syncGraph:{},remainingVoters:T}).syncGraph;return function f(A,G,k,V){const W=G.reduce((T,x)=>{const I=A[x],D=A[V.predecessors[x]];for(const L of k)I[L]===D[L]&&T.push({successorId:x,prop:L});return T},[]);for(const T of W)delete A[T.successorId][T.prop],0===Object.keys(A[T.successorId]).length&&delete A[T.successorId];return A}(z,Object.keys(z).filter(L=>!A.roots[L]&&!!A.successors[L]),V,A)}(k,I,z);Object.entries(V).forEach(([Q,ie])=>{const se=(0,t.omit)(ie,x);(0,t.isEmpty)(se)||(D[Q]={...D[Q]||{},...se})});const L=new e.YR;return Object.entries(D).forEach(([Q,ie])=>{L[this.switchNamespace(Q,W)]=ie},this),L}convertGraphSync(k){const V={},W={},T={},x={},z={};return Object.entries(k).forEach(([I,D])=>{Object.entries(D).forEach(([L,Q])=>{"available"===L?V[I]=Q:"shown"===L?W[I]=Q:"selected"===L?T[I]=Q:"pickable"===L?x[I]=!Q:z[I]={...z[I]||{},[L]:Q}},this)},this),{availableObjects:V,showObjects:W,selectObjects:T,pickThroughObjects:x,synchronization:z}}switchNamespace(k,V){return V[k]||k}serializeHotspots(k,V){let W=[...k.hotspots],T={};return V.filter(z=>z.chapterId===k.id).forEach(z=>{const I=this.labelService.serializeLabel(z,W.length);W=[...W,...I.hotspots],T={...T,...I.data}}),{customData:T,hotspots:W}}calcMinimumPaintState(k,V){function W(T,x=!0){const I=(k.successors[T]||[]).reduce((D,L)=>({...D,...W(L,!(0,t.isEqual)(V[T],V[L]))}),{});return x?{[T]:V[T],...I}:I}return Object.keys(k.roots).reduce((T,x)=>({...T,...W(x)}),{})}serializeVisibilityLayers(k,V){const T={...k};return Array.isArray(k?.layers)&&(T.layers=k.layers.map(x=>({...x,objectIds:x.objectIds.filter(z=>Object.prototype.hasOwnProperty.call(V.nodes,z))})).filter(x=>x.objectIds.length>0)),T}serializeCamera(k){const V=k.title===r.y?void 0:k.title;return{[k.action]:{...k.location,title:V},cameraRotationCenter:k.rotationCenter}}duplicateTimelineMap(k){return k?k.map(V=>{const W=(0,t.cloneDeep)(V);return delete W.id,W}):[]}duplicateQuizQuestions(k){return this.store.selectSnapshot(h.j.getQuizQuestionsByChapter(k)).map(V=>{const W=(0,t.cloneDeep)(V);return delete W.chapterId,W})}serializeChapter(k,V,W,T,x,z=!1){const I=this.serializeHotspots(V,T),D=this.store.selectSnapshot(p.B.particleSystemsForChapter(V.id)),Q={...(0,t.pickBy)(V.customData,($,ce)=>!ce.startsWith("errand")),...I.customData,particleSystems:D.map($=>$.id)};let ie=V.camera;if(z){const ce=this.store.selectSnapshot(u.x.getChapterCameraPositions).get(V.id);ce&&(ie=Object.assign({},ie,ce))}const se=x[V.id],Z=this.store.selectSnapshot(o.K.getRegisteredThumbnails),de=Z.get(se)?.urls||Z.get(V.id)?.urls||null,ae={id:se,createdFrom:V.createdFrom,displayName:V.displayName,description:V.description,...this.serializeCamera(ie),background:V.background??{},hotspots:I.hotspots,clippingPlanes:{clips:V.clippingPlanes.clips,boundary:V.clippingPlanes.boundary},ui:(0,t.isEmpty)(V.ui)?b:V.ui,media:V.media,timelineMap:this.duplicateTimelineMap(V.timelineMap),customData:Q,transparencyMode:V.transparencyMode||null,fallbackTransparency:V.fallbackTransparency,properties:V.properties,transitions:V.transitions,legend:V.legend||[],visibilityLayers:this.serializeVisibilityLayers(V.sliderLayers.src,k),contentBlocks:V.contentBlocks||[],thumbnails:{default:"",...de},quizQuestions:this.duplicateQuizQuestions(V.id),synchronization:void 0};if((0,d.Mi)(V))ae.lightLibraryId=V.lightLibraryId;else if((0,d.Uv)(V)){const $=ae;$.lights=V.lights,$.environment=V.environment}const K=this.store.selectSnapshot(y.z.getAllNodeState)[V.id],j=Object.entries(K).reduce(($,[ce,re])=>{const ue=re.shownSetByTween?(0,g.BK)(k,ce,V.showObjects)||(0,g._x)(k,ce,V.showObjects):re.shown;return $.boolState[ce]={shown:ue,pickable:re.pickable,available:re.available},$.paintState[ce]=(0,i.Sf)(re.paint),$},{boolState:{},paintState:{}}),M=this.getMinimumGraphSync(k,j.boolState,W);return Object.entries(this.convertGraphSync(M)).forEach(([$,ce])=>{ae[$]=ce}),ae.synchronization=this.calcMinimumPaintState(k,j.paintState),ae}static#e=this.\u0275fac=function(V){return new(V||A)(l.KVO(m.il),l.KVO(s.x),l.KVO(v.s))};static#t=this.\u0275prov=l.jDH({token:A,factory:A.\u0275fac,providedIn:"root"})}return A})()},41862:(le,N,n)=>{"use strict";n.d(N,{$j:()=>t,HZ:()=>O,IW:()=>y,N6:()=>E,hE:()=>c,lN:()=>s,m3:()=>f,tV:()=>S,ud:()=>P,yF:()=>e,zA:()=>a});let e=(()=>{class i{static#e=this.type="[Edit] Set view";constructor(p){this.view=p}}return i})(),t=(()=>{class i{static#e=this.type="[Edit] Next view";constructor(){}}return i})(),s=(()=>{class i{static#e=this.type="[Edit] Preview";constructor(p=!1,h){this.quizLocked=p,this.quizQuestion=h}}return i})(),c=(()=>{class i{static#e=this.type="[Edit] Previous view";constructor(){}}return i})(),O=(()=>{class i{static#e=this.type="[Edit] Set Left Column Collapsed";constructor(p){this.collapsed=p}}return i})(),P=(()=>{class i{static#e=this.type="[Edit] Show Timeline Editor";constructor(p){this.show=p}}return i})(),S=(()=>{class i{static#e=this.type="[Edit] Reset";constructor(){}}return i})(),a=(()=>{class i{static#e=this.type="[Edit] Set Layer Order Mode";constructor(p){this.layerOrderMode=p}}return i})(),f=(()=>{class i{static#e=this.type="[Edit] Show Tree Node Ids";constructor(p){this.show=p}}return i})(),E=(()=>{class i{static#e=this.type="[Edit] Show Root Nodes";constructor(p){this.show=p}}return i})(),y=(()=>{class i{static#e=this.type="[Edit] Set Canvas Size";constructor(p){this.size=p}}return i})()},81881:(le,N,n)=>{"use strict";n.d(N,{Df:()=>O,GG:()=>t,Hr:()=>s,Nf:()=>P,T2:()=>i,WD:()=>e,b8:()=>a,hd:()=>f,ut:()=>y,wx:()=>p,yE:()=>S,yG:()=>E,yJ:()=>g,yk:()=>c});let e=(()=>{class h{static#e=this.type="[Edit Paint] Set Color Recipe";constructor(v){this.colorRecipe=v}}return h})(),t=(()=>{class h{static#e=this.type="[Edit Paint] Set Paint Brush Mode";constructor(v){this.brushMode=v}}return h})(),s=(()=>{class h{static#e=this.type="[Edit Paint] Clear Current Recipe";constructor(){}}return h})(),c=(()=>{class h{static#e=this.type="[Edit Paint] Reset Paint";constructor(){}}return h})(),O=(()=>{class h{static#e=this.type="[Edit Paint] Add Recent Recipe";constructor(v){this.recipe=v}}return h})(),P=(()=>{class h{static#e=this.type="[Edit Paint] Set Recent Recipes";constructor(v){this.recipes=v}}return h})(),S=(()=>{class h{static#e=this.type="[Edit Paint] Reset Story Recipes";constructor(){}}return h})(),a=(()=>{class h{static#e=this.type="[Edit Paint] Set Story Recipes For Chapter";constructor(v,d){this.chapterId=v,this.recipes=d}}return h})(),f=(()=>{class h{static#e=this.type="[Edit Paint] Add Palette";constructor(v){this.palette=v}}return h})(),E=(()=>{class h{static#e=this.type="[Edit Paint] Remove Palette";constructor(v){this.paletteId=v}}return h})(),y=(()=>{class h{static#e=this.type="[Edit Paint] Update Palette";constructor(v){this.palette=v}}return h})(),i=(()=>{class h{static#e=this.type="[Edit Paint] Set Palettes";constructor(v){this.palettes=v}}return h})(),g=(()=>{class h{static#e=this.type="[Edit Paint] Add Recipe to Palette";constructor(v,d){this.recipe=v,this.paletteId=d}}return h})(),p=(()=>{class h{static#e=this.type="[Edit Paint] Toggle Palette";constructor(v,d){this.paletteId=v,this.open=d}}return h})()},92676:(le,N,n)=>{"use strict";n.d(N,{i:()=>d});var e=n(92014);class t{}var o,s=n(81881),c=n(20458),O=n(68114),P=n(58398),S=n(17215),a=n(49204),f=n(63365),E=n(94495),y=n(59676),i=n(59429),g=n(54438),p=function(r,_,u,l){var b,m=arguments.length,C=m<3?_:null===l?l=Object.getOwnPropertyDescriptor(_,u):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)C=Reflect.decorate(r,_,u,l);else for(var R=r.length-1;R>=0;R--)(b=r[R])&&(C=(m<3?b(C):m>3?b(_,u,C):b(_,u))||C);return m>3&&C&&Object.defineProperty(_,u,C),C},h=function(r,_){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(r,_)};const v={currentRecipe:c.Rn,brushMode:O.u.Replace,storyRecipes:{},recentRecipes:[],uniqueStoryRecipes:[],palettes:[]};let d=class gs{static#e=o=this;static getCurrentRecipe(_){return _.currentRecipe}static getCurrentRecipeForEngine(_){return(0,f.Sf)(_.currentRecipe)}static getPaintBrushMode(_){return _.brushMode}static getRecentRecipes(_){return _.recentRecipes}static getStoryRecipes(_){return _.storyRecipes}static getUniqueStoryRecipes(_){return _.uniqueStoryRecipes}static getPalettes(_){return _.palettes}static getCurrentChapterRecipes(_,u){return _.storyRecipes[u.selectedChapter]}static getChapterRecipes(_){return(0,e.Mz)([o],u=>u.storyRecipes[_])}setCurrentRecipe(_,{colorRecipe:u}){_.patchState({currentRecipe:u})}setBrushMode(_,u){_.patchState({brushMode:u.brushMode})}clearCurrentRecipe(_,u){_.patchState({currentRecipe:null})}resetPaint(_,u){_.setState(v)}addRecentRecipe(_,u){let l=_.getState().recentRecipes;l.some(C=>(0,P.n4)(C,u.recipe))||(l.splice(0,0,u.recipe),l.length>14&&(l=l.slice(0,14)),this.storageService.setLocalItem(S.UT.RecentRecipes,l),_.patchState({recentRecipes:[...l]}))}setRecentRecipes(_,u){const l=(0,a.isNil)(u.recipes)?[]:[...u.recipes];_.patchState({recentRecipes:l}),this.storageService.setLocalItem(S.UT.RecentRecipes,l)}setStoryRecipesForChapter(_,u){const l=(0,P.c7)(u.recipes),m=_.getState().storyRecipes;m[u.chapterId]=[...l],_.patchState({storyRecipes:m});const C=Object.values(m).reduce((R,A)=>[...R,...A],[]),b=(0,P.c7)(C).sort(P.UD);_.patchState({uniqueStoryRecipes:b})}resetStoryRecipes(_,u){_.patchState({storyRecipes:{}})}addPalette(_,u){u.palette.id=i.u.idWithPrefix("palette");const l=[..._.getState().palettes,u.palette];_.dispatch(new s.T2(l))}updatePalette(_,u){const l=_.getState().palettes,m=l.findIndex(C=>C.id===u.palette.id);m>=0&&(l[m]={...u.palette}),_.dispatch(new s.T2(l))}removePalette(_,u){const l=[..._.getState().palettes.filter(m=>m.id!==u.paletteId)];_.dispatch(new s.T2(l))}setPalettes(_,u){const l=(0,a.cloneDeep)(u.palettes?[...u.palettes]:[]);_.patchState({palettes:l}),localStorage.setItem(S.UT.PaintPalettes,JSON.stringify(l))}addRecipeToPalette(_,u){const l=_.getState().palettes,m=l.findIndex(C=>C.id===u.paletteId);m>=0&&l[m].recipes.push(u.recipe),_.dispatch(new s.T2(l))}togglePalette(_,u){const l=_.getState().palettes,m=l.findIndex(C=>C.id===u.paletteId);m>=0&&(l[m].open=(0,a.isNil)(u.open)?!l[m].open:u.open,_.dispatch(new s.T2(l)))}ngxsOnInit(_){}constructor(_){this.storageService=_}static#t=this.\u0275fac=function(u){return new(u||gs)(g.KVO(S.n$))};static#n=this.\u0275prov=g.jDH({token:gs,factory:gs.\u0275fac})};p([(0,e.rc)(s.WD),h("design:type",Function),h("design:paramtypes",[Object,s.WD]),h("design:returntype",void 0)],d.prototype,"setCurrentRecipe",null),p([(0,e.rc)(s.GG),h("design:type",Function),h("design:paramtypes",[Object,s.GG]),h("design:returntype",void 0)],d.prototype,"setBrushMode",null),p([(0,e.rc)(s.Hr),h("design:type",Function),h("design:paramtypes",[Object,s.Hr]),h("design:returntype",void 0)],d.prototype,"clearCurrentRecipe",null),p([(0,e.rc)(s.yk),h("design:type",Function),h("design:paramtypes",[Object,s.yk]),h("design:returntype",void 0)],d.prototype,"resetPaint",null),p([(0,e.rc)(s.Df),h("design:type",Function),h("design:paramtypes",[Object,s.Df]),h("design:returntype",void 0)],d.prototype,"addRecentRecipe",null),p([(0,e.rc)(s.Nf),h("design:type",Function),h("design:paramtypes",[Object,s.Nf]),h("design:returntype",void 0)],d.prototype,"setRecentRecipes",null),p([(0,e.rc)(s.b8),h("design:type",Function),h("design:paramtypes",[Object,s.b8]),h("design:returntype",void 0)],d.prototype,"setStoryRecipesForChapter",null),p([(0,e.rc)(s.yE),h("design:type",Function),h("design:paramtypes",[Object,s.yE]),h("design:returntype",void 0)],d.prototype,"resetStoryRecipes",null),p([(0,e.rc)(s.hd),h("design:type",Function),h("design:paramtypes",[Object,s.hd]),h("design:returntype",void 0)],d.prototype,"addPalette",null),p([(0,e.rc)(s.ut),h("design:type",Function),h("design:paramtypes",[Object,s.ut]),h("design:returntype",void 0)],d.prototype,"updatePalette",null),p([(0,e.rc)(s.yG),h("design:type",Function),h("design:paramtypes",[Object,s.yG]),h("design:returntype",void 0)],d.prototype,"removePalette",null),p([(0,e.rc)(s.T2),h("design:type",Function),h("design:paramtypes",[Object,s.T2]),h("design:returntype",void 0)],d.prototype,"setPalettes",null),p([(0,e.rc)(s.yJ),h("design:type",Function),h("design:paramtypes",[Object,s.yJ]),h("design:returntype",void 0)],d.prototype,"addRecipeToPalette",null),p([(0,e.rc)(s.wx),h("design:type",Function),h("design:paramtypes",[Object,s.wx]),h("design:returntype",void 0)],d.prototype,"togglePalette",null),p([(0,e.MD)(),h("design:type",Function),h("design:paramtypes",[t]),h("design:returntype",void 0)],d,"getCurrentRecipe",null),p([(0,e.MD)(),h("design:type",Function),h("design:paramtypes",[t]),h("design:returntype",void 0)],d,"getCurrentRecipeForEngine",null),p([(0,e.MD)(),h("design:type",Function),h("design:paramtypes",[t]),h("design:returntype",void 0)],d,"getPaintBrushMode",null),p([(0,e.MD)(),h("design:type",Function),h("design:paramtypes",[t]),h("design:returntype",void 0)],d,"getRecentRecipes",null),p([(0,e.MD)(),h("design:type",Function),h("design:paramtypes",[t]),h("design:returntype",void 0)],d,"getStoryRecipes",null),p([(0,e.MD)(),h("design:type",Function),h("design:paramtypes",[t]),h("design:returntype",void 0)],d,"getUniqueStoryRecipes",null),p([(0,e.MD)(),h("design:type",Function),h("design:paramtypes",[t]),h("design:returntype",void 0)],d,"getPalettes",null),p([(0,e.MD)([d,E.N]),h("design:type",Function),h("design:paramtypes",[t,y.G]),h("design:returntype",void 0)],d,"getCurrentChapterRecipes",null),d=o=p([(0,e.Uw)({name:"editPaint",defaults:v}),h("design:paramtypes",[S.n$])],d)},12347:(le,N,n)=>{"use strict";n.d(N,{O:()=>g});var e=n(28407),t=n(49204),s=n(79805),c=n(11724),O=n(515),P=n(33013),S=n(94495),a=n(47610),f=n(76304),y=n(54438),i=n(92014);let g=(()=>{class p{constructor(o,v){this.engineService=o,this.store=v,this.fps=30}setChapter(o,v=!1){var d=this;return(0,e.A)(function*(){const{story:r}=d.engineService.engine,{chapters:_,activeChapter:u}=r;if(o&&(o!==u?.id||v)){const m=_.findIndex(C=>C.id===o);return r.activateChapter(m).then(C=>(d.initPlayer(C),C.id))}return o})()}initPlayer(o){this.destroyPlayer();const{animationSystem:v}=o;this._animationPlayer=new c.BioDigitalAnimationPlayer(v),this.engineService.engine.renderer.on("animate",()=>{this.engineService.fireEvent(O.X.TimelineAnimatingStart),this._animationPlayer.update(),this.engineService.fireEvent(O.X.TimelineAnimatingEnd)}),this._animationPlayer.on("timeupdate",()=>{this.engineService.fireEvent(O.X.TimelinePlaying,{time:this._animationPlayer.currentTime})}),this._animationPlayer.on("play",()=>{this.engineService.fireEvent(O.X.TimelinePlayed,{time:this._animationPlayer.currentTime})}),this._animationPlayer.on("pause",()=>{this.engineService.fireEvent(O.X.TimelinePaused,{time:this._animationPlayer.currentTime})}),this._animationPlayer.on("ended",()=>{this.engineService.fireEvent(O.X.TimelineCompleted)}),this._animationPlayer.on("ratechange",({playBackRate:G})=>{const k=this.engineService.engine?.story;k&&(k.playBackRate=G)});const d=this.store.selectSnapshot(f.S.getPlaybackSpeed);this.setPlaybackRate(d);const r=[];o.timelineMap.forEach((G,k)=>{const V={id:k,...G};V.name=V.name??"",r.push(V)}),this.store.dispatch(new P.bg(r)),o.timelineMap.on("change",()=>{this.engineService.fireEvent(O.X.TimelineTimeFrameUpdated)}),this.store.dispatch(new P.M5(o.id,{model:!0,animation:!0}));const _=this.store.selectSnapshot(f.S.getChapter),u=this.store.selectSnapshot(S.N.getStoryChapters),l=u.findIndex(G=>G.id===_),m=u.findIndex(G=>G.id===o.id),R=-1===(this.store.selectSnapshot(S.N.getChapter(o.id))?.ui?.play?.count??0);this.setAnimationLoop(R),l!==m&&this.engineService.fireEvent(O.X.TimelineChapterTransition,{oldChapterIndex:l,newChapterIndex:m,time:0}),this.store.dispatch(new a.u3(o.id))}destroyPlayer(){this._animationPlayer?.pause(),this._animationPlayer?.destroy(),this._animationPlayer=null}isChapterAnimated(o){return!!o?.timelineMap&&function E(p){return p.some(h=>"dummy"!==h?.data?.timeline&&"dummy"!==h?.name)}(o.timelineMap)}isChapterLooped(o){return!0===(0,t.get)(o,"loop")||-1===(0,t.get)(o,"ui.play.count")}restart(){if((0,t.isNil)(this._animationPlayer))return;const o=this.isPlaying();o&&this.pause(),this._animationPlayer.currentTime=0,o&&this.play()}play(){this._animationPlayer?.play(),this.playParticles()}pause(){this._animationPlayer?.pause(),this.pauseParticles()}unpause(){this._animationPlayer&&(this.hasChapterFinished()&&this.scrub(0),this.play())}scrub(o){this._animationPlayer&&(this._animationPlayer.currentTime=(0,t.clamp)(o,0,this._animationPlayer.duration),this.engineService.fireEvent(O.X.TimelineScrubbed,{time:this._animationPlayer.currentTime}))}scrubRelative(o,v){this._animationPlayer&&(v&&this.isPlaying()?(this.pause(),this.scrub(this.getTime()+o),setTimeout(()=>this.unpause())):this.scrub(this.getTime()+o))}scrubFrame(o){const v="next"===o?1:-1,d=this.getTime(),_=this.secondsToFrames(d)+v,u=this.framesToSeconds(_);this.scrub(u)}secondsToFrames(o){return Math.round(o*this.fps)}framesToSeconds(o){return o/this.fps}getNearestFrameTime(o){return this.framesToSeconds(this.secondsToFrames(o))}formatTime(o){const v=m=>{const C=o<0?Math.ceil:Math.floor;return Math.abs(C(m)).toString().padStart(2,"0")},r=v(o/60),_=v(o%60),u=(m=>Math.abs(this.secondsToFrames(m%1)).toString().padStart(2,"0"))(o%1);return`${o<0?"-":""}${r}:${_}:${u}`}parseFormattedTime(o){const v=/^-/,d=v.test(o)?-1:1;-1===d&&(o=o.replace(v,""));const r=o.split(":").reverse();let _=parseInt(r[0],10),u=parseInt(r[1],10),l=parseInt(r[2],10);return isNaN(_)&&(_=0),isNaN(u)&&(u=0),isNaN(l)&&(l=0),(60*l+u+this.framesToSeconds(_))*d}updateTimelineClips(o){const v=this.engineService.engine.story.activeChapter;o.forEach(d=>{v.timelineMap.set(d.id,d)})}deleteTimelineClips(o){const v=this.engineService.engine.story.activeChapter;o.forEach(d=>{v.timelineMap.delete(d)})}setPlaybackRate(o){this._animationPlayer.playBackRate=o}getStoryAnimationNames(){const o=this.store.selectSnapshot(S.N.getStoryChapters),v=[];return o.forEach(d=>{d.timelineMap.forEach(r=>{const _=r.data.timeline;v.includes(_)||v.push(_)})}),v}getChapterTimeFrame(o){return{firstTime:0,lastTime:this.getChapterDuration(o)}}getChapterDuration(o){return(0,t.isNil)(o)?(0,t.isNil)(this._animationPlayer)?0:this._animationPlayer.duration:this.engineService.engine.story.chapters.find(_=>_.id===o)?.animationSystem?.duration??0}getTime(){return(0,t.isNil)(this._animationPlayer)?0:this._animationPlayer.currentTime}isPlaying(){return!(0,t.isNil)(this._animationPlayer)&&!this._animationPlayer.paused}hasChapterFinished(){return!(0,t.isNil)(this._animationPlayer)&&this._animationPlayer.currentTime===this._animationPlayer.duration}setAnimationLoop(o){if(!this._animationPlayer)throw new Error("Animation player is not initialized");this._animationPlayer.loop=o}mapChapterGlobalTime(o,v){let d=v;if((0,t.isNil)(d))return 0;const r=this.store.selectSnapshot(S.N.getStoryChapters),_=r.findIndex(u=>u.id===o);for(let u=0;u<_;u++){let m=0;r[u].timelineMap.forEach(C=>{C.end>m&&(m=C.end)}),d-=m}return d}mapGlobalTimeToChapterId(o){let v=0;const d=this.store.selectSnapshot(S.N.getStoryChapters);let r;for(let _=0;_<d.length;_++){const u=d[_],l=this.getChapterDuration(u.id);if(o>=v&&o<v+l){r=u.id;break}v+=l}return o===v&&!r&&(r=d[d.length-1].id),r}getGlobalTime(){const o=this.store.selectSnapshot(S.N.getSelectedChapterIndex),v=this.store.selectSnapshot(S.N.getStoryChapters);let d=this._animationPlayer.currentTime;for(let r=0;r<o;r++){let u=0;v[r].timelineMap.forEach(l=>{l.end>u&&(u=l.end)}),d+=u}return d}playParticles(){this.engineService.engine?.story?.activeChapter?.start()}pauseParticles(){this.engineService.engine?.story?.activeChapter?.stop()}static#e=this.\u0275fac=function(v){return new(v||p)(y.KVO(s.y),y.KVO(i.il))};static#t=this.\u0275prov=y.jDH({token:p,factory:p.\u0275fac,providedIn:"root"})}return p})()},13955:(le,N,n)=>{"use strict";n.d(N,{I:()=>S});var e=n(28407),t=n(94495),s=n(79805),c=n(63508),O=n(54438),P=n(92014);let S=(()=>{class a{constructor(E,y){this.engineService=E,this.store=y}getGeometries(){return{}}getGeometryCompressionSupported(){return!0}getLoadedAssets(){return{}}getLights(){return{}}getMaterials(){return{}}getTextureCompressionSupported(){return!0}getMorphs(){return{}}getAssetLibrary(E,y,i){const{server:g,serverBaseDirectory:p}=this.engineService;return g.getAssetLibrary(p,E,y,i)}getAssetNamespaces(){const E={},y=this.getLoadedAssets();return Object.keys(y).map(i=>i.split("/")[0]).forEach(i=>{E[i]=!0}),Object.keys(E)}enableLightLib(E){const i=this.getLights()[E];if(Array.isArray(i)){const g={};i.forEach(p=>{g[p]=!0}),console.warn("Enabling of lights in real-time not yet implemented.")}}setBranchLights(E,y){const i=this.store.selectSnapshot(t.N.getSelectedChapter);(0,c.Uv)(i)&&i.lights.libraries[0]!==y&&(i.lights.libraries[0]=y,this.enableLightLib(y))}loadLightLib(E){var y=this;return(0,e.A)(function*(){return y.getAssetLibrary("lights",E,"outline").then(i=>({type:"physicalImageLight"in i?"physical":"legacy",libId:E,asset:i}))})()}getLightingLibs(E){var y=this;return(0,e.A)(function*(){return Promise.all(E.map(i=>y.loadLightLib(i)))})()}static#e=this.\u0275fac=function(y){return new(y||a)(O.KVO(s.y),O.KVO(P.il))};static#t=this.\u0275prov=O.jDH({token:a,factory:a.\u0275fac,providedIn:"root"})}return a})()},3266:(le,N,n)=>{"use strict";n.d(N,{j:()=>R});var e=n(13491),t=n(85052),s=n(66017),c=n(15913),O=n(2353),P=n(38472),S=n(79805),a=n(11724),f=n(515),E=n(35650),y=n(46889),i=n(49204);const h={backOff:0,stopFOV:55,dist:2.5};function o(A,G,k,V=h){const W={...h,...V},T=W.dist,x=W.stopFOV,z=1-(0,i.clamp)(W.backOff,0,1),I=(0,y.E8)(A,G);return Math.abs(I/(1+.8*z)/Math.tan(x/2))/k*T}function v(A,G,k){const V=e.n.toArray(A.look),W=e.n.toArray(A.eye),T=P.create();P.subtract(T,W,V);const x=P.create();P.normalize(x,T);const z=Math.abs(P.length(x)),{min:I,max:D}=(0,O.n)(G),L=o(I,D,z,k),Q=(0,y.A1)(I,D);P.scale(T,x,L);const ie=P.add(P.create(),Q,T);return{eye:e.n.fromArray(ie),look:e.n.fromArray(Q),up:e.n.fromArray([0,1,0])}}class d{constructor(G,k){this.tempVec=P.create(),this.eyeVec=P.create(),this.lookVec=P.create(),this.cameraService=G;const{targetCamera:V,targetBoundary:W}=k,T=G.getCamera();if(this.initialLook=e.n.toArray(T.look),this.initialEye=e.n.toArray(T.eye),this.initialUp=e.n.toArray(T.up),W){P.subtract(this.tempVec,this.initialEye,this.initialLook);const D=P.create();P.normalize(D,this.tempVec);const L=Math.abs(P.length(D)),{min:Q,max:ie}=(0,O.n)(W),se=o(Q,ie,L,k);P.scale(this.tempVec,D,se),this.targetLook=(0,y.A1)(Q,ie),this.targetEye=P.add(P.create(),this.targetLook,this.tempVec),this.targetUp=P.fromValues(0,1,0)}V&&(this.targetLook=e.n.toArray(V.look),this.targetEye=e.n.toArray(V.eye),this.targetUp=e.n.toArray(V.up)),P.subtract(this.tempVec,this.targetLook,this.initialLook);const x=Math.abs(P.length(this.tempVec));P.subtract(this.tempVec,this.targetEye,this.initialEye);const z=Math.abs(P.length(this.tempVec));this.animationDuration=k.animationDuration?1e3*k.animationDuration:1e3*((x>z?x:z)/(200*(k.velocity||1))+1),this.onComplete=k.onComplete}update(G){if(void 0===this.startTime&&(this.startTime=G,this.endTime=this.startTime+this.animationDuration),this.animationDone||G>this.endTime)return this.animationDone||this.cameraService.setCamera({eye:e.n.fromArray(this.targetEye),look:e.n.fromArray(this.targetLook),up:e.n.fromArray(this.targetUp)}),this.animationDone=!0,void this.onComplete(this);const V=(0,y.vT)((G-this.startTime)/this.animationDuration,0,1);(0,y.dL)(V,0,1,this.initialLook,this.targetLook,this.lookVec),(0,y.dL)(V,0,1,this.initialEye,this.targetEye,this.eyeVec),(0,y.dL)(V,0,1,this.initialUp,this.targetUp),this.cameraService.setCamera({eye:e.n.fromArray(this.eyeVec),look:e.n.fromArray(this.lookVec),up:e.n.fromArray(this.targetUp)})}stop(){}}var r=n(54438),_=n(81642);const m=180/Math.PI,C=1/a.BIODIGITAL_SCENE_SCALE,b=a.BIODIGITAL_SCENE_SCALE;let R=(()=>{class A{get cameraController(){const k=this.engineService.engine?.story?.cameraController;if(!k)throw new Error("Story not instantiated, cannot get camera controller");return k}constructor(k,V,W){this.engineService=k,this.numberService=V,this.sceneService=W,this.rotation={vx:0,vy:0},this.pan={x:0,y:0,z:0},this.zoom=0,this.animationCallbacks=[],this.initCameraEvents()}tickCamera(k){this.animation&&this.animation.update(performance.now())}getCamera(){const{up:k,target:V,position:W}=this.cameraController,T=a.vec3Pool.get(),x=a.vec3Pool.get();P.scale(T,W,C),P.scale(x,V,C);const z={eye:e.n.fromArray(T),look:e.n.fromArray(x),up:e.n.fromArray(k)};return a.vec3Pool.release(T),a.vec3Pool.release(x),z}setCamera(k,V=!1){const{cameraController:W}=this,{eye:T,look:x,up:z}=k;let I,D,L;T&&(I=a.vec3Pool.get(),P.scale(I,e.n.toArray(T),b)),x&&(D=a.vec3Pool.get(),P.scale(D,e.n.toArray(x),b)),z&&(L=e.n.toArray(z)),W.setCamera(I??W.position,D??W.target,L),I&&a.vec3Pool.release(I),D&&a.vec3Pool.release(D),x&&!V&&this.setCameraRotationCenter(x)}getLookDirection(){const{target:k,position:V}=this.cameraController,W=P.create();return P.sub(W,k,V),P.normalize(W,W),W}getLookDistance(){return this.cameraController.distance*C}getCameraZoom(){return this.cameraController.zoom}captureCamera(){return{lookAt:this.getCamera(),zoom:this.getCameraZoom()}}getDirection(k){const{position:V}=this.cameraController,W=P.create();return P.sub(W,V,k.worldPos),P.normalize(W,W),[W[0],W[1],W[2]]}rotateCameraStatic(k,V){this.cameraController.orbit(k/m,V/m)}panCameraStatic(k,V,W){this.cameraController.pan(k*b,V*b,W*b)}setRelativeZoom(k){this.cameraController.dolly(k)}setAbsoluteZoom(k){this.cameraController.zoom=k}getCameraRotationCenter(){const k=a.vec3Pool.get();P.scale(k,this.cameraController.center,C);const V=e.n.fromArray(k);return a.vec3Pool.release(k),V}setCameraRotationCenter(k){const V=a.vec3Pool.get(),W=Array.isArray(k)?k:e.n.toArray(k);P.scale(V,W,b),P.copy(this.cameraController.center,V),a.vec3Pool.release(V)}setCameraRotation(k,V){this.rotation.vx=V,this.rotation.vy=-k}setCameraPan(k,V){this.pan.x=k,this.pan.y=V}setCameraZoom(k){this.zoom=.03*k}setCameraZoomWithVelocity(k){this.setCameraZoom(k),requestAnimationFrame(()=>{k*=.85,Math.abs(k)>1&&this.setCameraZoomWithVelocity(k)})}tickCameraRotation(){return this.rotation.vx=this.checkEpsilon(this.rotation.vx),this.rotation.vy=this.checkEpsilon(this.rotation.vy),this.rotation}tickCameraPan(){return this.pan.x=this.checkEpsilon(this.pan.x),this.pan.y=this.checkEpsilon(this.pan.y),this.pan.z=this.checkEpsilon(this.pan.z),this.pan}tickCameraZoom(){return this.zoom=this.checkEpsilon(this.zoom),this.zoom}areCamerasEqual(k,V){return this.compareXYZ(k.eye,V.eye)&&this.compareXYZ(k.look,V.look)&&this.compareXYZ(k.up,V.up)}compareXYZ(k,V){return k.x===V.x&&k.y===V.y&&k.z===V.z}roundCamera(k,V){const{eye:W,look:T,up:x}=k;return{eye:this.numberService.roundModel(W,V),look:this.numberService.roundModel(T,V),up:this.numberService.roundModel(x,V)}}flyToObject(k,V){return new Promise(W=>{const T=this.sceneService.getObjectBoundary([k]);(0,O.L)(T)?(this.animationCallbacks.push(W),this.animation=new d(this,{targetBoundary:T,animationDuration:V,onComplete:()=>{this.finishAnimation()}}),this.animation.update(performance.now())):W(void 0)})}flyToCamera(k,V){return new Promise(W=>{this.animationCallbacks.push(W),this.animation=new d(this,{targetCamera:k,animationDuration:V,onComplete:()=>{this.finishAnimation()}}),this.animation.update(performance.now())})}jumpToObject(k){const V=this.sceneService.getObjectBoundary([k]);if((0,O.L)(V)){const T=v(this.getCamera(),V);return this.jumpToCamera(T)}return new Promise(W=>W(void 0))}jumpToCamera(k){return new Promise(V=>{this.finishAnimation(),this.setCamera(k),V(void 0)})}getCameraAfterFlyTo(k){return v(this.getCamera(),k)}checkEpsilon(k){return Math.abs(k)<.001?0:k}initCameraEvents(){const k=new t.B,V=k.asObservable();V.subscribe(x=>{this.engineService.fireEvent(f.X.CameraUpdated,x)});const T=this.engineService.getEvent(f.X.Tick).pipe((0,s.S)(2));V.pipe((0,c.s)(()=>T)).subscribe(x=>{this.engineService.fireEvent(f.X.CameraRested,x)}),this.engineService.engineCreated$.subscribe(x=>{x.camera.on("updateWorldMatrix",z=>{if(!x?.story)return;const L={...this.getCamera(),dist:this.getLookDistance()};k.next(L)})})}finishAnimation(){for(this.animation&&(this.animation.stop(),this.animation=null);this.animationCallbacks.length>0;)this.animationCallbacks.pop()()}static#e=this.\u0275fac=function(V){return new(V||A)(r.KVO(S.y),r.KVO(_.D),r.KVO(E.w))};static#t=this.\u0275prov=r.jDH({token:A,factory:A.\u0275fac,providedIn:"root"})}return A})()},76724:(le,N,n)=>{"use strict";n.d(N,{h:()=>S});var e=n(79805),t=n(11724),c=n(49204),P=n(54438);let S=(()=>{class a{constructor(E){this.engineService=E}createEngineClippingPlanes(E){return(0,t.makeClippingPlanes)(E)}setClippingPlanes(E){const{story:y}=this.engineService.engine,{activeChapter:i}=y;if((0,c.isNil)(i))return;const g=this.createEngineClippingPlanes(E);i.clippingPlanes.length=0,i.clippingPlanes.push(...g)}static#e=this.\u0275fac=function(y){return new(y||a)(P.KVO(e.y))};static#t=this.\u0275prov=P.jDH({token:a,factory:a.\u0275fac,providedIn:"root"})}return a})()},51002:(le,N,n)=>{"use strict";n.d(N,{k:()=>W});var e=n(54438),t=n(7431),s=n(94495),c=n(93915),O=n(49969),P=n(61295),S=n(75069),a=n(3266),f=n(39358),E=n(60177),y=n(72026),i=n(11818),g=n(46374),p=n(14823),h=n(89511),o=n(89079),v=n(3829),d=n(76304),r=n(73987),_=n(92014),u=n(18617),l=n(12637),m=n(26779),C=n(65985),b=n(82487);function R(T,x){if(1&T){const z=e.RV6();e.j41(0,"li")(1,"button",9),e.bIt("click",function(){e.eBV(z);const D=e.XpG();return e.Njj(D.toggleCameraBar())}),e.nrm(2,"app-icon",10),e.j41(3,"span",8),e.pXf(4,1),e.k0s()()()}if(2&T){const z=e.XpG();e.R7$(),e.Y8G("short",!0)("matTooltip",z.cameraToggleTooltip()),e.R7$(),e.Y8G("icon",z.collapsed()?"angle-up":"angle-down")}}function A(T,x){1&T&&(e.nrm(0,"app-icon",12),e.j41(1,"span",8),e.pXf(2,2),e.k0s())}function G(T,x){1&T&&(e.nrm(0,"app-icon",13),e.j41(1,"span",8),e.pXf(2,3),e.k0s()),2&T&&e.Y8G("custom",!0)}function k(T,x){if(1&T){const z=e.RV6();e.j41(0,"li")(1,"button",14),e.bIt("touchend",function(){e.eBV(z);const D=e.XpG(2);return e.Njj(D.setZoomFixed("in"))})("mouseup",function(){e.eBV(z);const D=e.XpG(2);return e.Njj(D.setZoomFixed("in"))})("keyup.enter",function(){e.eBV(z);const D=e.XpG(2);return e.Njj(D.setZoomFixed("in"))}),e.nrm(2,"app-icon",15),e.k0s()(),e.j41(3,"li")(4,"button",16),e.bIt("touchend",function(){e.eBV(z);const D=e.XpG(2);return e.Njj(D.setZoomFixed("out"))})("mouseup",function(){e.eBV(z);const D=e.XpG(2);return e.Njj(D.setZoomFixed("out"))})("keyup.enter",function(){e.eBV(z);const D=e.XpG(2);return e.Njj(D.setZoomFixed("out"))}),e.nrm(5,"app-icon",17),e.k0s()()}}function V(T,x){if(1&T){const z=e.RV6();e.j41(0,"li")(1,"button",11),e.bIt("click",function(){e.eBV(z);const D=e.XpG();return e.Njj(D.togglePan())}),e.DNE(2,A,3,0)(3,G,3,1),e.k0s()(),e.DNE(4,k,6,0)}if(2&T){let z;const I=e.XpG();e.R7$(),e.Y8G("matTooltip",I.cameraModeTooltip()),e.BMQ("aria-pressed","pan"===I.panMode()),e.R7$(),e.vxM("pan"===(z=I.panMode())?2:"rotate"===z?3:-1),e.R7$(2),e.vxM(I.zoomEnabled()?4:-1)}}let W=(()=>{class T{constructor(z,I,D,L){this.store=z,this.cameraService=I,this.viewService=D,this.liveAnnouncer=L,this.panMode=(0,o.ot)(this.store.select(v.x.getPanMode)),this.canvasHeightBreakpoint=(0,o.ot)(this.store.select(d.S.getCanvasHeightBreakpoint)),this.zoomEnabled=(0,e.EWP)(()=>this.canvasHeightBreakpoint()>r.h.Tiny),this.cameraToggleTooltip=(0,e.EWP)(()=>this.collapsed()?$localize`Open 3D Controls`:$localize`Close 3D Controls`),this.cameraModeTooltip=(0,e.EWP)(()=>"pan"===this.panMode()?$localize`Change to Rotate Mode`:$localize`Change to Pan Mode`),this.collapsed=(0,e.vPA)(!0)}setZoomFixed(z){this.cameraService.setCameraZoomWithVelocity("in"===z?-8:8);const D=(100*this.cameraService.getCameraZoom()).toFixed(0);this.liveAnnouncer.announce(`zoomed ${z} to ${D}%`)}returnToChapterCamera(){const z=this.store.selectSnapshot(s.N.getSelectedChapter);this.store.dispatch(new t.Ih(z.camera.location)).subscribe(()=>{this.liveAnnouncer.announce("recenter complete")})}resetChapter(){this.returnToChapterCamera();const z=this.store.selectSnapshot(s.N.getSelectedChapterId);this.store.dispatch(new S.a.UndoAll(z)),this.store.dispatch(new P.q9(!1)),this.store.dispatch(new c.S3)}togglePan(){this.viewService.togglePan()}toggleCameraBar(){this.collapsed.update(z=>!z)}static#e=this.\u0275fac=function(I){return new(I||T)(e.rXU(_.il),e.rXU(a.j),e.rXU(f.z),e.rXU(u.Ai))};static#t=this.\u0275cmp=e.VBU({type:T,selectors:[["app-engine-camera-bar"]],standalone:!0,features:[e.aNF],decls:9,vars:2,consts:()=>{let z,I,D,L,Q,ie,se,Z,de,ae;return z=$localize`:fa8adc0f5e22d9c18b37663b6f2bb1b50424eb1c8617328588319285229:Camera Control Buttons`,I=$localize`:ac4a855ff1671d74a0692e3b9ee5be349e6281ca6332173527621530176:Return to Starting Position`,D=$localize`:0459da369b661293df2216dab6d5504bc0ae736d4770948314010072135:Clicking this button will reset the camera viewing the 3D model`,L=$localize`:0c6b2042f7ade77091a6e0b314f5797a51644835918403358406080994:Toggle 3D navigation controls`,Q=$localize`:240d93ec4b5179c4fd189688280eaa63b0d6d7836492222661583280:Pan mode active, change to rotate mode`,ie=$localize`:e583fc810e521ceb2967fc19734fed46a2540c944140573029148607220:Rotate mode active, change to pan mode`,se=$localize`:34fb6028a6630cf3a7308084b31e86e89d0579651470758907984185227:Zoom In`,Z=$localize`:34fb6028a6630cf3a7308084b31e86e89d0579651470758907984185227:Zoom In`,de=$localize`:677ce9c57b5558cb10f0b39327d5a965bfb21dc51356460275822781324:Zoom Out`,ae=$localize`:677ce9c57b5558cb10f0b39327d5a965bfb21dc51356460275822781324:Zoom Out`,[D,L,Q,ie,["direction","vertical","data-test","cameraBar","direction","vertical","appPreventFadeout",""],["role","group","aria-label",z],["app-view-button","","buttonSize","small","matTooltip",I,"matTooltipPosition","left","data-test","cameraReset",3,"click"],["size","lg","icon","location-crosshairs"],[1,"sr-only"],["app-view-button","","buttonSize","small","data-test","cameraToggleBar","matTooltipPosition","left",3,"click","short","matTooltip"],["size","sm",3,"icon"],["app-view-button","","buttonSize","small","matTooltipPosition","left","data-test","cameraPan",3,"click","matTooltip"],["size","lg","icon","arrows-up-down-left-right"],["size","lg","icon","rotate",3,"custom"],["app-view-button","","buttonSize","small","data-test","cameraZoomIn","aria-label",se,"matTooltip",Z,"matTooltipPosition","left",3,"touchend","mouseup","keyup.enter"],["size","lg","icon","plus"],["app-view-button","","buttonSize","small","data-test","cameraZoomOut","aria-label",de,"matTooltip",ae,"matTooltipPosition","left",3,"touchend","mouseup","keyup.enter"],["size","lg","icon","minus"]]},template:function(I,D){1&I&&(e.j41(0,"app-pillbox",4)(1,"ul",5),e.DNE(2,R,5,3,"li"),e.j41(3,"li")(4,"button",6),e.bIt("click",function(){return D.returnToChapterCamera()}),e.nrm(5,"app-icon",7),e.j41(6,"span",8),e.pXf(7,0),e.k0s()()(),e.DNE(8,V,5,4),e.k0s()()),2&I&&(e.R7$(2),e.vxM(D.zoomEnabled()?2:-1),e.R7$(6),e.vxM(D.collapsed()?-1:8))},dependencies:[E.MD,p.uc,p.oV,h.h,l.s,y.o,m.R,i.C,C.ri,g.b,b.O],encapsulation:2,data:{animation:[(0,O.hZ)("expand",[(0,O.kY)(":enter",[(0,O.K2)([(0,O.iF)({height:0}),(0,O.i0)("150ms ease-in-out",(0,O.iF)({height:"*"}))])]),(0,O.kY)(":leave",[(0,O.K2)([(0,O.i0)("150ms ease-in-out",(0,O.iF)({height:"0"}))])])]),(0,O.hZ)("show",[(0,O.kY)(":enter",[(0,O.K2)([(0,O.iF)({height:"0"}),(0,O.i0)("125ms ease-in-out",(0,O.iF)({height:"*"}))])]),(0,O.kY)(":leave",[(0,O.K2)([(0,O.i0)("125ms 125ms ease-in-out",(0,O.iF)({height:"0"}))])])])]},changeDetection:0})}return T})()},26655:(le,N,n)=>{"use strict";n.d(N,{A:()=>s,m:()=>c});const s=n(11724).VERSION,c="2.0.1"},46799:(le,N,n)=>{"use strict";n.d(N,{z:()=>y});var e=n(65133),t=n(38472),s=n(11724);const c={stats:{textures:{baseColor:{"1024x1024":1,memory:1e6,"512x512":1,"2048x2048":1},alpha:{"1024x1024":1,memory:1e6,"512x512":1},normals:{"1024x1024":1,memory:1e6,"512x512":1,"2048x2048":1},emit:{"1024x1024":1,memory:1e6,"512x512":1,"256x256":1},roughness:{"512x512":1,memory:1e6,"1024x1024":1}}}};var O=n(79805),P=n(515),S=n(49204),a=n(54438);const f=e.create(),E=e.create();let y=(()=>{class i{get canvas(){if(!this.engineService.engine)throw new Error("Engine not defined, cannot use canvas");return this.engineService.engine.renderer.canvas}constructor(p){this.engineService=p}forceRenderFrame(){this.engineService.engine.renderer.render()}getCanvas(){return this.canvas}getScene(){return c}getViewMat(){return this.scaleAndNormalizeMatrix(this.engineService.engine.story.camera.worldMatrixInverse)}getProjMat(){return this.scaleAndNormalizeMatrix(this.engineService.engine.story.camera.projectionMatrix)}pick(p,h,o=!0){const v=this.engineService.engine,d=v.story?.anatomySceneGraph,r=v.rayCastCamera(p,h,{filter:_=>d?.findAnatomyObject(_)?.pickable});if(r){const _=this.generateHitModel(d,r,o,p,h);return this.engineService.fireEvent(P.X.PickPicked,_),_}return{canvasPos:{x:p,y:h}}}pickMatrix(p,h=!0){const o=this.engineService.engine,v=o.story?.anatomySceneGraph,d=o.rayCast(p,{filter:r=>v?.findAnatomyObject(r)?.pickable,near:0});if(d){const r=this.generateHitModel(v,d,h);return this.engineService.fireEvent(P.X.PickPicked,r),r}}setTransparencyMode(p){this.engineService.engine.renderer.transparencyMode=p}scaleAndNormalizeMatrix(p){return e.copy(E,p),E[12]*=s.BIODIGITAL_SCENE_SCALE,E[13]*=s.BIODIGITAL_SCENE_SCALE,E[14]*=s.BIODIGITAL_SCENE_SCALE,E}generateHitModel(p,h,o,v,d){const{triIndex:r,intersection:_,object:u}=h,l=p.findAnatomyObject(u),{objectId:m,renderables:C}=l,b=C.findIndex(k=>k.meshNode===u),R=C[b]?.meshNode,G={canvasPos:(0,S.isNil)(v)||(0,S.isNil)(d)?void 0:{x:v,y:d},objectId:m,renderableIndex:b,triIndex:r};if(o){const k=this.getBarycentricCoordinate(R,_,r),V=this.getTriangleNormal(R,r);return t.scale(_,_,1/s.BIODIGITAL_SCENE_SCALE),{...G,barycentric:k,worldPos:_,normal:V}}return G}getBarycentricCoordinate(p,h,o){const v=t.create(),d=s.vec3Pool.get(),r=s.vec3Pool.get(),_=s.vec3Pool.get(),u=s.vec3Pool.get();return e.invert(f,p.worldMatrix),t.transformMat4(d,h,f),(0,s.getTrianglePositions)(p,o,r,_,u),(0,s.barycentricCoord)(v,d,r,_,u),t.transformMat4(r,r,p.worldMatrix),t.transformMat4(_,_,p.worldMatrix),t.transformMat4(u,u,p.worldMatrix),s.vec3Pool.release(d),s.vec3Pool.release(r),s.vec3Pool.release(_),s.vec3Pool.release(u),v}getTriangleNormal(p,h){const o=t.create(),v=s.vec3Pool.get(),d=s.vec3Pool.get(),r=s.vec3Pool.get();return(0,s.getTrianglePositions)(p,h,v,d,r),t.transformMat4(v,v,p.worldMatrix),t.transformMat4(d,d,p.worldMatrix),t.transformMat4(r,r,p.worldMatrix),(0,s.triangleNormal)(o,v,d,r),s.vec3Pool.release(v),s.vec3Pool.release(d),s.vec3Pool.release(r),o}static#e=this.\u0275fac=function(h){return new(h||i)(a.KVO(O.y))};static#t=this.\u0275prov=a.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})()},16515:(le,N,n)=>{"use strict";n.d(N,{x:()=>r});var e=n(60177),t=n(92014),s=n(76304),c=n(10381),O=n(3829),P=n(21604),S=n(45189),a=n(51002),f=n(89417),E=n(13409),y=n(82192),i=n(82109),g=n(89511),p=n(12921),h=n(76037),o=n(66915),v=n(43631),d=n(54438);let r=(()=>{class _{static#e=this.\u0275fac=function(m){return new(m||_)};static#t=this.\u0275mod=d.$C({type:_});static#n=this.\u0275inj=d.G2t({imports:[t.rK.forFeature([v._,s.S,O.x,E.z,i.N,p.B]),e.MD,g.h,S.G,f.YN,f.X1,c.k,P.G,y.G,o.z,h.J,a.k]})}return _})()},79805:(le,N,n)=>{"use strict";n.d(N,{y:()=>de});var e=n(28407),t=n(29160),s=n(85052),c=n(14264),O=n(11756),P=n(40215),S=n(37925),a=n(515),f=n(24418),E=n(17215),y=n(85884),i=n(27180),g=n(54438),p=n(38645);let h=(()=>{class ae{constructor(K){this.router=K}redirectToErrorPage(K,j,M){(this.router.url||"").match("/error")||this.router.navigateByUrl(f.c.application===i.c.Viewer?"/error":"/view/error",{skipLocationChange:!0,state:{errorType:K,errorCode:j,error:M,errorUrl:this.router.url}})}static#e=this.\u0275fac=function(j){return new(j||ae)(g.KVO(p.Ix))};static#t=this.\u0275prov=g.jDH({token:ae,factory:ae.\u0275fac,providedIn:"root"})}return ae})();var o=n(11724),v=n(49204);const d={[o.FogModeNumericEnum.Linear]:"linear",[o.FogModeNumericEnum.Exponential]:"exp",[o.FogModeNumericEnum.ExponentialSquared]:"exp2"};var r=n(70432),_=n(34992);const u=(ae,q)=>(0,o.joinPath)(ae,"assets",q),m=5,C=new _.A({concurrency:900});function R(){return(R=(0,e.A)(function*(ae,q,K){const j=yield fetch(ae,{signal:q});return j.ok?K(j):null})).apply(this,arguments)}function A(ae,q,K,j){return G.apply(this,arguments)}function G(){return G=(0,e.A)(function*(ae,q,K,j){const M=u(q,K);return C.add(()=>(0,r.A)(()=>function b(ae,q,K){return R.apply(this,arguments)}(M,ae,j),{retries:m}))}),G.apply(this,arguments)}function k(ae,q,K){return A(ae,q,K,function(){var j=(0,e.A)(function*(M){return M.json()});return function(M){return j.apply(this,arguments)}}())}function V(ae,q,K){return A(ae,q,K,function(){var j=(0,e.A)(function*(M){return M.arrayBuffer()});return function(M){return j.apply(this,arguments)}}())}function T(){return(T=(0,e.A)(function*(ae){return(yield fetch(ae)).json()})).apply(this,arguments)}function z(){return(z=(0,e.A)(function*(ae,q){return C.add(()=>(0,r.A)(()=>fetch("/assets/"+ae,q),{retries:m}))})).apply(this,arguments)}const I={material:k,morph:V,geometry:V,transform:k};class D{fetch(q,K){return(0,e.A)(function*(){const j=C.add(()=>(0,r.A)(()=>fetch(q),{retries:m}));return void 0!==j?j:null})()}constructor(q,K,j={}){let M=new o.BioDigitalWebSocketServer(K,j);const $=typeof AbortController>"u"?null:new o.MultiKeyMap;function ue(){return ue=(0,e.A)(function*(H,te,F,w){const X=F.split("/"),oe=(0,o.joinPath)(H,"content/states",X[0],te,X[1],w);return C.add(()=>(0,r.A)(()=>function W(ae){return T.apply(this,arguments)}(oe),{retries:m}))}),ue.apply(this,arguments)}this.getAsset=function(){var H=(0,e.A)(function*(te,F){const w=I[te];if(!w)throw new Error("BioDigitalHybridServer: Unsupported type '$type'");let X=null;$&&(X=new AbortController,$.set(te,F,X));let oe=yield w(X?.signal,q,F);return null===oe&&(oe=yield function ce(){return M||(M=new o.BioDigitalWebSocketServer(K,j)),M}().getAsset(te,F),function x(ae,q){z.apply(this,arguments)}(F,{method:"PUT",body:"morph"===te||"geometry"===te?oe:JSON.stringify(oe)})),$&&$?.delete(te,F),oe});return function(te,F){return H.apply(this,arguments)}}(),this.getAssetLibrary=function re(H,te,F,w){return ue.apply(this,arguments)},this.destroy=()=>{$&&($.forEach(H=>H.abort()),$.clear()),M&&M.destroy()}}}var L=n(26982);let Q=(()=>{class ae extends L.U{static#e=this.\u0275fac=(()=>{let K;return function(M){return(K||(K=g.xGo(ae)))(M||ae)}})();static#t=this.\u0275prov=g.jDH({token:ae,factory:ae.\u0275fac,providedIn:"root"})}return ae})();var ie=n(21626);let de=(()=>{class ae{get engine(){return this._engine}get server(){return this._server}get serverBaseDirectory(){return typeof localBaseDirectory>"u"?"/":localBaseDirectory}constructor(K,j,M,$){this.errorService=K,this.storageService=j,this.engineEventService=M,this.http=$,this.events={},this.errorLogged=!1,this._engineCreated=new t.t(void 0),this._engineDestroyed=new s.B,this.registerEngineWorkers(),this.events=Object.values(a.X).reduce((ce,re)=>(ce[re]=this.engineEventService.getEvent(re),ce),{}),this.engineCreated$=this._engineCreated.asObservable().pipe((0,c.p)(ce=>!(0,v.isNil)(ce))),this.engineDestroyed$=this._engineDestroyed.asObservable(),this.engineCreated$.pipe((0,O.Z)(ce=>this.getGPUCapabilities(ce))).subscribe(ce=>{this.gpuCapabilities=ce}),this.initEngineErrorHandling()}getEvent(K){return this.events[K]}fireEvent(K,j){this.engineEventService.fireEvent(K,j)}initEngine(K){return this.createServerInstance(),this.createEngineInstance(K),this.fireEvent(a.X.Loaded),this.engine}destroyEngine(){this._engine&&(this._engineCreated.next(void 0),this._engineDestroyed.next(),this._engine.destroy(),this._engine=null),this._server&&(this._server.destroy(),this._server=null)}setStory(K){this.engine.setStory(K),f.c.offline&&(this._server.moduleId=K.moduleId,typeof requiresFileExtensions<"u"&&(this._server.requiresFileExtensions=requiresFileExtensions)),this.engine.story.chapters.forEach(j=>{j.on("progress",()=>{const{id:M,loadProgress:$}=j;this.fireEvent(a.X.AssetsLoadProgress,{chapterId:M,chapterProgress:$})})})}getWEBGLInfo(){return this.gpuCapabilities?.webgl?.params}setProperties(K){const{story:j,renderer:M}=this.engine,$=j?.activeChapter,ce=j?.cameraController;(0,v.isNil)($)||(this.setFogProperties(M,$,K),this.setCameraProperties(M,$,ce,K))}setFogProperties(K,j,M){Object.entries(M).forEach(([ce,re])=>{if(ce.startsWith("fog.")&&((0,v.has)(K.environment,ce)&&(0,v.set)(j.properties,ce,re),(0,v.has)(K.environment,ce)))switch(ce){case"fog.density":K.environment.fog.density=re/o.BIODIGITAL_SCENE_SCALE;break;case"fog.mode":K.environment.fog.mode=d[re];break;case"fog.start":K.environment.fog.start=re*o.BIODIGITAL_SCENE_SCALE;break;case"fog.end":K.environment.fog.end=re*o.BIODIGITAL_SCENE_SCALE;break;default:(0,v.set)(K.environment,ce,re)}}),!1===M["fog.enabled"]&&(K.environment.fog.mode="")}setCameraProperties(K,j,M,$){Object.entries($).forEach(([ue,H])=>{if(ue.startsWith("camera."))switch(ue){case"camera.optics.near":j.properties.camera.optics.near=H;break;case"camera.optics.far":j.properties.camera.optics.far=H;break;case"camera.optics.fov":j.properties.camera.optics.fov=H;break;case"camera.zoomLimits":j.properties.camera.zoomLimits=H}});const{optics:ce,zoomLimits:re}=j.properties.camera;K.camera.fov=ce.fov*Math.PI/180,K.camera.far=ce.far*o.BIODIGITAL_SCENE_SCALE,K.camera.near=ce.near*o.BIODIGITAL_SCENE_SCALE,K.camera.dirtyProjection(),M.minDistance=re.min*o.BIODIGITAL_SCENE_SCALE,M.maxDistance=re.max*o.BIODIGITAL_SCENE_SCALE}getGPUCapabilities(K){var j=this;return(0,e.A)(function*(){return j.gpuCapabilities=j.gpuCapabilities??(yield K.renderer.getGPUCapabilities()),j.gpuCapabilities})()}initAnalytics(K,j,M,$){var ce=this;return(0,e.A)(function*(){ce.gpuAnalytic={version:4,app_producttype:K,app_productkey:j,gpu_data:{},acct_cred_type:M,acct_cred_id:$,offline_event:f.c.offline?1:0};const re=yield(0,P._)(ce.engineCreated$),ue=yield ce.getGPUCapabilities(re);if(ce.gpuAnalytic={...ce.gpuAnalytic,gpu_data:{...ue}},!ce.storageService.getSessionItem(E.d0.GPUAnalyticsStored)){const te=f.c.offline?{...ce.gpuAnalytic,event_timestamp:(new Date).toISOString().substring(0,19)}:ce.gpuAnalytic;f.c.offline?fetch("https://human.biodigital.com/ws/product/analytic/gpu-event",{method:"POST",body:JSON.stringify(te),headers:new Headers({"Content-Type":"application/json; charset=utf-8"}),mode:"no-cors"}).then(()=>{ce.storageService.setSessionItem(E.d0.GPUAnalyticsStored,Date.now())}):ce.http.post("/ws/product/analytic/gpu-event",te,{headers:{"Content-Type":"application/json; charset=utf-8"}}).subscribe(()=>{ce.storageService.setSessionItem(E.d0.GPUAnalyticsStored,Date.now())})}})()}createServerInstance(){if(this._server)throw new Error("Websocket server already exists");this._server=f.c.offline?new o.BioDigitalFileServer(this.serverBaseDirectory):f.c.native?new D(this.serverBaseDirectory,f.c.assetDomain,{timeout:6e5,socketProtocol:"wss"}):new o.BioDigitalWebSocketServer(f.c.assetDomain,{timeout:6e5})}createEngineInstance(K){if(this._engine)throw new Error("Engine is already instantiated");try{const j=typeof localBaseDirectory>"u"?"/":localBaseDirectory;this._engine=new o.BioDigitalEngine(this._server,{...K,baseUrl:j}),this.initEngineTickEvent(this._engine),this.initTweenVisibilityEvent(this._engine),this._engineCreated.next(this._engine)}catch(j){const M=j??new Error("There was an error creating the engine");this.fireEvent(a.X.HumanError,M)}}initEngineErrorHandling(){this.getEvent(a.X.HumanError).pipe((0,c.p)(K=>!(0,v.isNil)(K))).subscribe(K=>{this.handleFatalEngineErrors(K)})}initEngineTickEvent(K){const j=M=>{this.fireEvent(a.X.Tick,M)};K.renderer.on("animate",j),K.on("destroy",()=>{K.renderer.off("animate",j)})}initTweenVisibilityEvent(K){let j={shown:{},shownSetByTween:{},variant:{}},M=!1;this.getEvent(a.X.TimelineAnimatingStart).pipe((0,S.Q)(this._engineDestroyed)).subscribe(()=>{M=!0,j={shown:{},shownSetByTween:{},variant:{}}}),this.getEvent(a.X.TimelinePlaying).pipe((0,S.Q)(this._engineDestroyed)).subscribe(()=>{const{shownSetByTween:$,variant:ce}=j;Object.keys($).length>0&&this.fireEvent(a.X.TweenVisibilityUpdate,$),Object.keys(ce).length>0&&this.fireEvent(a.X.VariantsUpdate,ce),M=!1,j={shown:{},shownSetByTween:{},variant:{}}}),K.on("changestory",()=>{const $=re=>{const ue=re?.property,H=re?.object,te=H?.objectId;if(ue in j&&(j[ue][te]=H[ue],"shown"===ue&&M)){const{shown:w}=H;j.shownSetByTween[te]=w}},{anatomyObjects:ce}=K.story.anatomySceneGraph;ce.forEach(re=>{re.on("change",$)})}),K.on("changechapter",()=>{const{anatomyObjects:$}=K.story.anatomySceneGraph,ce={shown:{},shownSetByTween:{},variant:{}};$.forEach(ue=>function Z(ae,q){for(const K in ae)K in q&&(ae[K][q.objectId]=q[K])}(ce,ue));const{variant:re}=ce;this.fireEvent(a.X.VariantsUpdate,re)})}registerEngineWorkers(){new Worker(n.tu(new URL(n.p+n.u(401),n.b))),(0,o.registerWorker)("geometry",()=>new Worker(n.tu(new URL(n.p+n.u(762),n.b)))),(0,o.registerWorker)("texture",()=>new Worker(n.tu(new URL(n.p+n.u(235),n.b)))),(0,o.registerWorker)("simulation",()=>new Worker(n.tu(new URL(n.p+n.u(513),n.b))))}handleFatalEngineErrors(K){const{message:j,name:M,stack:$}=K,ce={name:M,message:j,stack:$},re={...this.gpuAnalytic,error_category:M,error_message:JSON.stringify({message:j,stack:$})};f.c.offline&&(re.event_timestamp=(new Date).toISOString().substring(0,19)),this.errorLogged||(this.http.post("/ws/product/error/gpu-event",re,{headers:{"Content-Type":"application/json; charset=utf-8"}}).subscribe(),this.errorLogged=!0),this.errorService.redirectToErrorPage(y.Y.Engine,void 0,ce)}static#e=this.\u0275fac=function(j){return new(j||ae)(g.KVO(h),g.KVO(E.n$),g.KVO(Q),g.KVO(ie.Qq))};static#t=this.\u0275prov=g.jDH({token:ae,factory:ae.\u0275fac,providedIn:"root"})}return ae})()},62943:(le,N,n)=>{"use strict";n.d(N,{T4:()=>a,iu:()=>c,tH:()=>O,ty:()=>S});var e=n(11789);function c(f){if(!Object.keys(f).length)return null;const E=[...f.colors];E.forEach((p,h)=>{E[h]=(h+1)%4&&p<=1?Math.round(255*p):p});const y=/radial|linear/.test(f.gradientType)?f.gradientType:"radial",i=f.colorStops,g=Array.isArray(i)&&2===i.length?[i[0],i[1]]:[0,100];return{colors:E,gradientType:y,colorStops:g}}function O(f){const E=f.colors,y=`rgba(${E[0]},${E[1]}, ${E[2]}, ${E[3]}) ${f.colorStops[0]}%`,i=`rgba(${E[4]},${E[5]}, ${E[6]}, ${E[7]}) ${f.colorStops[1]}%`;return"radial"===f.gradientType?`radial-gradient(circle, ${y}, ${i})`:`linear-gradient(180deg, ${y}, ${i})`}function S(f){if(!f||!f.colors)return!1;const E=f.colors,y=E[3];return E.length<=4?0===y:0===y&&0===E[7]}function a(f){const E=f?.colors;if(Array.isArray(E)){const y=E.slice(0,3);return e.T.isLight(y)}return!1}},2353:(le,N,n)=>{"use strict";n.d(N,{L:()=>c,n:()=>s});var e=n(49204);function s(O){const{xmin:P,ymin:S,zmin:a,xmax:f,ymax:E,zmax:y}=O;return{min:[P,S,a],max:[f,E,y]}}function c(O){if((0,e.isNil)(O))return!1;{const P=Object.values(O);return 6===P.length&&P.every(S=>Number.isFinite(S))}}},57021:(le,N,n)=>{"use strict";n.d(N,{x:()=>e});class e{constructor(s=0,c=0,O=0,P=0,S=0,a=!1){this.zoom=s,this.panX=c,this.panY=O,this.rotateX=P,this.rotateY=S,this.applyFriction=a}}},73987:(le,N,n)=>{"use strict";n.d(N,{h:()=>e});var e=function(t){return t[t.Tiny=0]="Tiny",t[t.Small=1]="Small",t[t.Standard=2]="Standard",t}(e||{})},515:(le,N,n)=>{"use strict";n.d(N,{X:()=>e});var e=function(t){return t.Started="started",t.Loaded="loaded",t.Tick="tick",t.HumanReady="human.ready",t.HumanStarted="started",t.Error="error",t.HumanError="human.error",t.CanvasResized="canvas.resized",t.HumanCanvasResized="human.canvasResized",t.LogDebug="_log.debug",t.LogError="_log.error",t.LogInfo="_log.info",t.LogWarn="_log.warn",t.SceneLoaded="scene.loaded",t.HumanProgress="human.progress",t.AssetsLoadFinish="assets.load.finish",t.AssetsLoadProgress="assets.load.progress",t.AssetsLoadStart="assets.load.start",t.CameraRested="camera.rested",t.CameraUpdated="camera.updated",t.ModuleInteractive="module.interactive",t.ModulesActivateFinish="modules.activate.finish",t.ModulesCreateFinish="modules.create.finish",t.ModulesDestroyFinish="modules.destroy.finish",t.ModulesFetchStart="modules.fetch.start",t.PickPicked="pick.picked",t.SceneMarkersUpdated="scene.markers.updated",t.SceneObjectRenderable="scene.objectRenderable",t.SceneObjectsSelected="scene.objectsSelected",t.SceneObjectsShown="scene.objectsShown",t.ScenePicked="scene.picked",t.SceneRestored="scene.restored",t.SceneXrayEnabled="scene.xrayEnabled",t.SceneXrayDisabled="scene.xrayDisabled",t.SceneReady="scene.ready",t.TimelineChapterTransition="timeline.chapterTransition",t.TimelinePlaying="timeline.playing",t.TimelineScrubbed="timeline.scrubbed",t.TimelinePlayed="timeline.played",t.TimelinePaused="timeline.paused",t.TimelineCompleted="timeline.completed",t.TimelineTimeFrameUpdated="timeline.timeFrame.updated",t.TimelineAnimatingStart="timeline.animating.start",t.TimelineAnimatingEnd="timeline.animating.end",t.GraphAssetAttachFinish="graph.assetAttach.finish",t.TweenVisibilityUpdate="TweenVisibilityUpdate",t.VariantsUpdate="VariantsUpdate",t}(e||{})},24911:(le,N,n)=>{"use strict";n.d(N,{j:()=>e});class e{constructor(s,c,O,P,S,a,f,E){this.viewportWidth=s,this.viewportHeight=c,this.left=O,this.top=P,this.width=S,this.height=a,this.visibility=f,this.scale=E}}},4664:(le,N,n)=>{"use strict";n.d(N,{g:()=>e});var e=function(t){return t[t.Hidden=-1]="Hidden",t[t.Shown=1]="Shown",t}(e||{})},20458:(le,N,n)=>{"use strict";n.d(N,{EC:()=>i,Me:()=>g,NR:()=>t,Rn:()=>c,_d:()=>p});var e=n(1367);const t={label:"Original",tintColor:!1,saturation:!1,contrast:!1,brightness:!1,opacity:!1},c={tintColor:[1,0,0],saturation:!1,contrast:!1,brightness:!1,opacity:!1},i={label:"Fade",tintColor:[0,0,0],contrast:!1,brightness:55,saturation:-100,opacity:new e.R({edge:1,center:0,edgeBias:0,centerBias:1,power:1})},g=[t,{tintColor:[0,0,0],saturation:!1,contrast:!1,brightness:!1,opacity:!1},c,{tintColor:[1,1,0],saturation:!1,contrast:!1,brightness:!1,opacity:!1},{tintColor:[0,1,0],saturation:!1,contrast:!1,brightness:!1,opacity:!1},{tintColor:[0,1,1],saturation:!1,contrast:!1,brightness:!1,opacity:!1},{tintColor:[0,0,1],saturation:!1,contrast:!1,brightness:!1,opacity:!1},{tintColor:[1,0,1],saturation:!1,contrast:!1,brightness:!1,opacity:!1}],p=[{label:"Grayscale",tintColor:!1,saturation:-100,contrast:!1,brightness:!1,opacity:!1},{label:"Desaturated",tintColor:!1,saturation:-50,contrast:!1,brightness:!1,opacity:!1},i]},38970:(le,N,n)=>{"use strict";n.d(N,{$t:()=>t,Po:()=>c,Uy:()=>e,Xr:()=>P,bF:()=>S,kC:()=>a,lc:()=>s,zu:()=>O});var e=function(f){return f.DirectionalVelocity="DirectionalVelocity",f.Lifetime="Lifetime",f.PointPosition="PointPosition",f.RandomVelocity="RandomVelocity",f.SpherePosition="SpherePosition",f.CylinderPosition="CylinderPosition",f.CubePosition="CubePosition",f.RandomRotation="RandomRotation",f.RandomRotationSpeed="RandomRotationSpeed",f.RandomScale="RandomScale",f.SpriteAnimationDuration="SpriteAnimationDuration",f}(e||{}),t=function(f){return f.AgeColorBlend="AgeColorBlend",f.BrownianMotion="BrownianMotion",f.UniformForce="UniformForce",f.RadialForce="RadialForce",f.Friction="Friction",f.Gravity="Gravity",f.Path="Path",f.AxisForce="AxisForce",f.SpriteAnimation="SpriteAnimation",f}(t||{}),s=function(f){return f.LifetimeKill="LifetimeKill",f.LifetimeStop="LifetimeStop",f.PathKill="PathKill",f.PathStop="PathStop",f.PathRadius="PathRadius",f.ShapeBounce="ShapeBounce",f.ShapeKill="ShapeKill",f.ShapeStop="ShapeStop",f}(s||{}),c=function(f){return f.Sphere="Sphere",f.Plane="Plane",f.Cube="Cube",f.Cylinder="Cylinder",f}(c||{}),O=function(f){return f.In="in",f.Out="out",f}(O||{});function P(f){return"materialId"in f}function S(f){return"material"in f&&!("workflow"in f.material)}function a(f){return"material"in f&&"workflow"in f.material}},13878:(le,N,n)=>{"use strict";n.d(N,{M:()=>e});var e=function(t){return t.Capture="capture",t.DoNotCaptureShowMessage="do_not_capture_show_message",t.DoNotCapture="do_not_capture",t}(e||{})},1308:(le,N,n)=>{"use strict";n.d(N,{F$:()=>S,_:()=>P});var e=n(20342),t=n(10352),s=n(9592),c=n(62943);const P={imageType:s.H.JPEG,crop:"original",copyrightEnabled:!1,copyrightImagePath:e.O.viewer.full_dark.logo_url,copyrightPosition:{x:"left",y:"bottom"},copyrightOffset:{x:12,y:-12},imageQuality:1};function S(a,f){return a===s.H.PNG?f||t.RK:f&&!(0,c.ty)(f)?f:t.RK}},47555:(le,N,n)=>{"use strict";n.d(N,{s:()=>e});var e=function(t){return t.Select="Select",t.Hide="Hide",t.Paint="Paint",t.Eyedropper="Eyedropper",t.Label="Label",t.Isolate="Isolate",t.Fade="Fade",t.Positions="Positions",t.Quiz="Quiz",t.Image="Image",t.Dimensions="Dimensions",t.Background="Background",t}(e||{})},46107:(le,N,n)=>{"use strict";n.d(N,{H6:()=>y,Om:()=>i,TH:()=>c,WC:()=>O,_T:()=>E,dS:()=>p,fY:()=>g,iw:()=>f,ky:()=>a,nt:()=>P,u5:()=>S});const e=[4,8,12,16,24,32],s=h=>h.slice(0).reverse().map(o=>({label:`${o}`,size:o})),c=s(e),O=s([8,12,16,20,24,32]),P=s(e),S={color:"#000000"},a={color:"#ffffff"},f=c[4],E=S,y=O[3],i=P[4],g=S,p=a},94604:(le,N,n)=>{"use strict";n.d(N,{w:()=>d});var e=n(78109),t=n(75069),s=n(3266),c=n(20458),O=n(35650),P=n(81025),a=n(7431),f=n(3829),E=n(76304),y=n(61295),i=n(13409),g=n(12865),p=n(92676),h=n(54438),o=n(92014),v=n(18617);let d=(()=>{class r{constructor(u,l,m,C,b){this.store=u,this.graphService=l,this.cameraService=m,this.sceneService=C,this.liveAnnouncer=b}applyCurrentRecipe(u){const l=this.store.selectSnapshot(p.i.getCurrentRecipe);if(!l)return;Object.entries(l).forEach(([C,b])=>{typeof b>"u"&&(l[C]=!1)}),this.store.dispatch(new y.Jp(l,u));const m=u.reduce((C,b)=>(C[b]=!1,C),{});this.sceneService.setNodesProperty(m,"selected")}fadeInverse(u){const l=this.store.selectSnapshot(E.S.getViewGraph),m=this.graphService.getInverseSelection(l,u),C=this.graphService.getNodes(l,m);this.store.dispatch(new y.Jp(c.EC,C.map(b=>b.id))).subscribe(()=>{this.liveAnnouncer.announce("Fade complete")})}fade(u){this.store.dispatch(new y.Jp(c.EC,u)).subscribe(()=>{this.liveAnnouncer.announce("Fade complete")})}hideInverse(u){const l=this.store.selectSnapshot(E.S.getViewGraph),m=this.graphService.getAllLeafDescendants(l,u),C=this.graphService.getInverseSelection(l,u),b={};m.forEach(T=>{b[T]=!0}),C.forEach(T=>{b[T]=!1});const R=new y.yr(void 0,void 0,b),A=(0,g.r)(this.store.selectSnapshot(i.z.getState),R,this.sceneService);this.store.dispatch(new y.NP(A.patches));const G=this.sceneService.getObjectBoundary(u),k=this.cameraService.getCameraAfterFlyTo(G),V=new a.Yp(k),W=function S(r,_){const[u,l,m]=P.vI(r,C=>{C.cameraFlyTo=_.camera});return{nextState:u,patches:l,inversePatches:m}}(this.store.selectSnapshot(f.x.getState),V);this.store.dispatch(new a.sQ(W.patches)).subscribe(()=>{this.liveAnnouncer.announce("Isolate complete")}),this.store.dispatch(new y.hg),this.store.dispatch(new y.q9(!1)),this.store.dispatch(new t.a.SavePatches([{forward:A.patches,inverse:A.inversePatches,patchAction:y.NP},{forward:W.patches,inverse:W.inversePatches,patchAction:a.sQ}]))}clearSelection(){this.store.dispatch(new y.hg),this.store.dispatch(new y.q9(!1))}show(u,l){this.store.dispatch(new y.yr(l,[u]))}static#e=this.\u0275fac=function(l){return new(l||r)(h.KVO(o.il),h.KVO(e.w),h.KVO(s.j),h.KVO(O.w),h.KVO(v.Ai))};static#t=this.\u0275prov=h.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})()},60286:(le,N,n)=>{"use strict";n.d(N,{s:()=>P});var e=n(78109),t=n(63365),s=n(35650),O=n(54438);let P=(()=>{class S{constructor(f,E){this.graphService=f,this.sceneService=E,this.highlightDisabled=!1}colorObject(f,E){const y=this.sceneService.getObjectById(f);if(this.sceneService.isLeaf(y)){const i=y.modifiers;Object.keys(E).forEach(g=>{const p=E[g];if(!1===p)i.delete(g);else if(Array.isArray(p)&&5===p.length){const[h,o,v,d,r]=p;i.set(g,{applyTo:g,fresnel:{center:h,edge:o,centerBias:v,edgeBias:d,power:r}})}else i.set(g,{applyTo:g,value:p})})}}getColor(f){return function c(S,a){const f=S.getObjectById(a);if(S.isLeaf(f)){const y={};return f.modifiers.forEach(i=>{y[i.applyTo]=i.fresnel??i.value}),y}return null}(this.sceneService,f)}uncolorObject(f){const E=this.sceneService.getObjectById(f);this.sceneService.isLeaf(E)&&E.modifiers.clear()}unpaint(f,E){this.graphService.getLeafDescendants(f,E.id).forEach(y=>{const i=this.sceneService.getObjectById(y);this.sceneService.isLeaf(i)&&i.modifiers.clear()})}paint(f,E,y){const i=(0,t.Sf)(y);this.graphService.getLeafDescendants(f,E).forEach(g=>{this.colorObject(g,i)})}highlight(f,E,y){(!1===this.highlightDisabled||!1===y)&&this.graphService.getLeafDescendants(f,E).forEach(i=>{const g=this.sceneService.getObjectById(i);this.sceneService.isLeaf(g)&&(g.selected=y)})}paintAll(f,E,y){E.forEach(i=>this.paint(f,i,y))}unpaintAll(f,E){E.forEach(y=>{this.unpaint(f,y)})}highlightAll(f,E,y){E.forEach(i=>this.highlight(f,i,y))}disableHighlight(){this.highlightDisabled=!0}enableHighlight(){this.highlightDisabled=!1}setHighlightColor(f){}getColorRecipes(){return[]}static#e=this.\u0275fac=function(E){return new(E||S)(O.KVO(e.w),O.KVO(s.w))};static#t=this.\u0275prov=O.jDH({token:S,factory:S.\u0275fac,providedIn:"root"})}return S})()},35650:(le,N,n)=>{"use strict";n.d(N,{w:()=>v});var e=n(2353),t=n(38472),s=n(44867),c=n(23881),O=n(78109),P=n(79805),S=n(11724),f=n(46889),E=n(49204),i=n(56343),g=n(54438);const p=1/S.BIODIGITAL_SCENE_SCALE,h=new S.AABB,o={shown:i.t.TrueWins,renderable:i.t.FalseWins,pickable:i.t.TrueWins};let v=(()=>{class d{constructor(_,u){this.engineService=_,this.graphService=u}getObjects(){const _={};return this.getAnatomySceneGraph()?.anatomyObjects.forEach((l,m)=>_[m]=l),_}getObjectById(_){return this.getAnatomySceneGraph()?.anatomyObjects?.get(_)}getObjectsById(_){const l=this.getAnatomySceneGraph()?.anatomyObjects;return _.reduce((m,C)=>{const b=l?.get(C);return b&&(m[b.objectId]=b),m},{})}isObjectLoaded(_){return!0===this.getObjectById(_)?.loaded}isObjectCulledByClip(_,u){if(0===u.length)return!1;const l=u.map(m=>m.plane);return _.renderables.some(m=>(0,S.boxIntersectsPlaneBounds)(l,m.meshNode.worldBounds))}getRootObjects(){return this.getAnatomySceneGraph()?.anatomyRoots??[]}getSceneBoundary(){const{rootNode:_}=this.engineService.engine;return this.getSceneNodeBoundaryModel([_],h)}getObjectBoundary(_){const u=_.map(l=>this.getObjectById(l).sceneNode);return this.getSceneNodeBoundaryModel(u,h)}getObjectBoundaryCenter(_){const u=this.getObjectBoundary([_]),{min:l,max:m}=(0,e.n)(u);return(0,f.A1)(l,m)}setShownObjects(_){const{replace:u,showObjects:l}=_,m=this.getRootObjects();this.setObjectsShown(m,l,!u&&void 0)}getLeavesByObject(_){const u=_.children??[];return 0===u.length?[_]:u.map(l=>this.getLeavesByObject(l)).flat()}getLeaves(_){if(_){const u=this.getObjectById(_);return u?this.getLeavesByObject(u):[]}return this.getRootObjects().map(l=>this.getLeavesByObject(l)).flat()}getLeafIds(_){return this.getLeaves(_).map(u=>u.objectId)}getEnabledLeafIds(){return this.getLeaves().filter(_=>!0===_?.shown).map(_=>_.objectId)}isLeaf(_){return 0===_.children.length}transformObject(_,u){const l=this.getObjectById(_)?.sceneNode;l?(0,S.applyTransform)(l,u):console.error(`Scene node not found: '${_}'`)}setNodesVisible(_,u=!1){const l={replace:u,showObjects:{..._}};this.setShownObjects(l)}setNodesProperty(_,u){Object.keys(_).forEach(l=>{const m=this.getObjectById(l);(this.isLeaf(m)?[l]:this.getLeafIds(l)).forEach(b=>{this.getObjectById(b)[u]=_[l]})})}setObjectLayer(_,u,l){_.get(u).layer=l}setObjectVariant(_,u,l){_.get(u).variant=l}getObjectLayerValues(_){const u={},l=this.getSceneBoundary();return _.forEach(m=>{const C=this.getObjectById(m),b=this.getObjectBoundary([m]),R=Math.min(b.xmin-l.xmin,l.xmax-b.xmax),A=2*Math.min(b.ymin-l.ymin,l.ymax-b.ymax),G=Math.min(b.zmin-l.zmin,l.zmax-b.zmax),k=C.layer;u[k]=u[k]??[],u[k].push({nodeId:m,value:Math.min(R,A,G)})}),u}getWorldPosition(_,u,l,m=0){const b=this.getObjectById(_)?.renderables[m]?.meshNode;if((0,E.isNil)(b))return;const R=b.worldMatrix,A=t.create(),G=S.vec3Pool.get(),k=S.vec3Pool.get(),V=S.vec3Pool.get();return(0,S.getTrianglePositions)(b,u,G,k,V),(0,S.cartesianCoord)(A,l,G,k,V),t.transformMat4(A,A,R),t.scale(A,A,1/S.BIODIGITAL_SCENE_SCALE),S.vec3Pool.release(G),S.vec3Pool.release(k),S.vec3Pool.release(V),A}getSceneGraph(_){const{anatomyObjects:u}=this.getAnatomySceneGraph(),l={...(0,c.ow)(),shown:C=>!0===u.get(C)?.shown,pickable:C=>!0===u.get(C)?.pickable,label:C=>u.get(C)?.displayName??"",layer:C=>u.get(C)?.layer??0},m=(0,s.fm)(_,l);return this.graphService.synchronize(m,o),m}createViewGraph({availableObjects:_,showObjects:u,includeRoot:l=!1,viewGraphMetadata:m}){const C=this.getRootObjects(),b=u?(0,s.TJ)(C,u):C,R=b.reduce((G,k)=>{const V=!l&&k.objectId.includes("-root");return G[k.objectId]=!V,V&&k.children.forEach(W=>{G[W.objectId]=!0}),G},{}),A=this.getSceneGraph((0,s.TJ)(b,R));return this.graphService.resetDepth(A),(0,E.isEmpty)(_)||this.computeObjectAvailable(A,_),(0,E.isEmpty)(m)||this.computeNodesMetadata(A,m),A}computeObjectAvailable(_,u){const{anatomyObjects:l}=this.getAnatomySceneGraph(),m=b=>l.get(b).parent?.objectId,C=b=>{const R=l.get(b);return R?R.children.map(A=>A.objectId):[]};Object.entries(_.nodes).forEach(([b,R])=>{R.boolState.available=(0,s.If)(b,u,m,C)})}computeNodesMetadata(_,u){(0,s.u7)(_,u)}getViewNode(_,u){return this.graphService.nodeExists(_,u)?(0,s.dV)(_,u):null}setObjectsShown(_,u,l){_.forEach(m=>{const b=u[m.objectId]??l;"boolean"==typeof b&&m.shown!==b&&(m.shown=b),this.setObjectsShown(m.children,u,l)})}getSceneNodeBoundaryModel(_,u){const{min:l,max:m}=this.getSceneNodeBounds(_,u);return t.scale(l,l,p),t.scale(m,m,p),{xmin:l[0],ymin:l[1],zmin:l[2],xmax:m[0],ymax:m[1],zmax:m[2]}}getSceneNodeBounds(_,u){return u.clear(),_.forEach(l=>{(0,S.traverseSceneNodes)(l,m=>{m instanceof S.MeshNode&&u.expand(m.worldBounds)})}),u}getChapterIndex(_){return this.engineService.engine.story?.chapters?.findIndex(m=>m.id===_)}getChapter(_){const u=this.engineService.engine?.story,l=u?.chapters,m=u?.activeChapterIndex;return l?.[_??m]}getAnatomySceneGraph(){return this.engineService.engine?.story?.anatomySceneGraph}static#e=this.\u0275fac=function(u){return new(u||d)(g.KVO(P.y),g.KVO(O.w))};static#t=this.\u0275prov=g.jDH({token:d,factory:d.\u0275fac,providedIn:"root"})}return d})()},30582:(le,N,n)=>{"use strict";n.d(N,{M:()=>d});var e=n(28407),t=n(21472),s=n(15877),c=n(35892),O=n(2573),P=n(36110),S=n(98837),a=n(11756),f=n(28577),E=n(8358),y=n(42482),i=n(46799),g=n(11789),p=n(98020),h=n(20342),o=n(54438),v=n(92014);let d=(()=>{class r{constructor(u,l,m){this.labelsService=u,this.engineRendererService=l,this.store=m,this.drawCanvas=null,this.annotateElement=null}setDrawCanvas(u){this.drawCanvas=u}getDrawCanvas(){return this.drawCanvas}setAnnotateElement(u){this.annotateElement=u}getAnnotateElement(){return this.annotateElement}localResize(u,l){const m=this.engineRendererService.getCanvas(),C=m.parentNode,b=C.clientWidth,R=C.clientHeight;return m.width=u,m.height=l,C.style.width=`${u}px`,C.style.height=`${l}px`,[b,R]}canvasToImage(u,l="original",m){var C=this;return(0,e.A)(function*(){const{width:b,height:R}=u,A=u.getContext("2d"),G=C.labelsService.getLabelContainer().nativeElement,k=u.width/u.height,V=C.engineRendererService.getCanvas();let{width:W,height:T}=V,x=.5*(V.width-W),z=0;switch(l){case"square":T>W?T=W:W=T,x=.5*(V.width-W),z=.5*(V.height-T);break;case"original":W=k*T}return C.engineRendererService.forceRenderFrame(),A.drawImage(V,x,z,W,T,0,0,b,R),m&&G?new Promise(requestAnimationFrame).then((0,e.A)(function*(){const I=yield y.X.elementToCanvas(G,!0);return A.drawImage(I,x,z,W,T,0,0,b,R),u})):u})()}canvasToImageWithResize(u,l){var m=this;return(0,e.A)(function*(){const{width:C,height:b}=u,R=m.engineRendererService.getCanvas(),A=u.getContext("2d"),G=m.labelsService.getLabelContainer().nativeElement,[k,V]=m.localResize(C,b);return m.engineRendererService.forceRenderFrame(),A.drawImage(R,0,0,C,b),l&&G?new Promise(requestAnimationFrame).then((0,e.A)(function*(){const W=yield y.X.elementToCanvas(G,!0);return A.drawImage(W,0,0,C,b),m.localResize(k,V),u})):(m.localResize(k,V),u)})()}drawRadialGradient(u,l){const m=l.colors,[b,R]=l.colorStops.map(W=>((W,T,x)=>{const[z,I]=[Math.pow(T/2,2),Math.pow(x/2,2)];return W/100*Math.pow(z+I,.5)})(W,u.width,u.height)),A=u.getContext("2d"),[G,k]=[u.width/2,u.height/2],V=A.createRadialGradient(G,k,b,G,k,R);V.addColorStop(l.colorStops[0]/100,`rgba(${m.slice(0,4).join(",")})`),V.addColorStop(l.colorStops[1]/100,`rgba(${m.slice(4,8).join(",")})`),A.fillStyle=V,A.fillRect(0,0,u.width,u.height)}drawLinearGradient(u,l){const m=l.colors,C=u.getContext("2d"),[b,R]=[u.width/2,u.height/2],A=C.createLinearGradient(b,R,b,u.height);A.addColorStop(l.colorStops[0]/100,`rgba(${m.slice(0,4).join(",")})`),A.addColorStop(l.colorStops[1]/100,`rgba(${m.slice(4,8).join(",")})`),C.fillStyle=A,C.fillRect(0,0,u.width,u.height)}takeSnapshot(u,l,m,C,b,R,A=1){const{imageType:G,imageQuality:k,copyrightEnabled:V,crop:W}=R,T=document.createElement("canvas");T.width=u,T.height=l,"radial"===m.gradientType?this.drawRadialGradient(T,m):"linear"===m.gradientType&&this.drawLinearGradient(T,m);const x=this.engineRendererService.getCanvas(),I=[],D=1!==A||T.height>x.height||T.width>x.width?this.canvasToImageWithResize(T,b):this.canvasToImage(T,W,b),L=(0,t.H)(D);I.push(L);const Q=[...C];return I.push(...Q.map(ie=>(ie instanceof HTMLCanvasElement?(0,s.of)(ie):(0,t.H)(y.X.elementToCanvas(ie,!0))).pipe((0,P.T)(Z=>y.X.fitCanvas(Z,u,l))))),this.engineRendererService.forceRenderFrame(),(0,c.x)(I).pipe((0,S.p)(),(0,P.T)(ie=>y.X.combineCanvasElements(ie)),(0,a.Z)(ie=>V?this.writeLogoToCanvas(ie,R):(0,s.of)(ie)),(0,a.Z)(ie=>y.X.canvasToBlob(ie,G,k)))}writeLogoToCanvas(u,l){return this.getLogoImage(l.copyrightImagePath).pipe((0,P.T)(m=>{let{width:C,height:b}=m;const{width:R,height:A}=u;if(.1*R>C){const W=b/C;C=.1*R,b=W*C}const{xOffset:G,yOffset:k}=this.getLogoPosition(R,A,C,b,l);return u.getContext("2d").drawImage(m,G,k,C,b),u}),(0,f.W)(()=>(0,s.of)(u)))}getLogoImage(u){return new O.c(l=>{const m=new Image;m.onload=()=>{l.next(m),l.complete()},m.onerror=()=>l.error(),m.src=u})}getLogoPosition(u,l,m,C,b){const{copyrightPosition:R,copyrightOffset:A}=b;let G,k;switch(R.x){case"right":G=u-m;break;case"center":G=u/2-m/2;break;default:G=0}switch(R.y){case"bottom":k=l-C;break;case"center":k=l/2-C/2;break;default:k=0}return{xOffset:G+A.x,yOffset:k+A.y}}getLogoFromBackground(u){const l=u.colors.slice(0,3),m=g.T.isLight(l),C=this.store.selectSnapshot(p.X.getViewLogoConfig);return(0,h.g)(C,"full",m?"color":"white")}static#e=this.\u0275fac=function(l){return new(l||r)(o.KVO(E.x),o.KVO(i.z),o.KVO(v.il))};static#t=this.\u0275prov=o.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})()},7431:(le,N,n)=>{"use strict";n.d(N,{Cy:()=>O,F5:()=>f,Ih:()=>e,Nz:()=>t,P4:()=>P,Qn:()=>s,RG:()=>E,RJ:()=>h,Xz:()=>v,Yi:()=>y,Yp:()=>r,bB:()=>i,gV:()=>c,j4:()=>g,nW:()=>S,pU:()=>d,pg:()=>a,qG:()=>p,sQ:()=>_,vq:()=>o});let e=(()=>{class u{static#e=this.type="[Engine Camera] Set Camera";constructor(m,C=!0,b,R){this.camera=m,this.animate=C,this.animationDuration=b,this.rotationCenter=R}}return u})(),t=(()=>{class u{static#e=this.type="[Engine Camera] Set Camera Success"}return u})(),s=(()=>{class u{static#e=this.type="[Engine Camera] Set Chapter Camera Enabled";constructor(m){this.enabled=m}}return u})(),c=(()=>{class u{static#e=this.type="[Engine Camera] Set Chapter Camera Position";constructor(m,C){this.chapterId=m,this.position=C}}return u})(),O=(()=>{class u{static#e=this.type="[Engine Camera] Clear Chapter Camera Positions"}return u})(),P=(()=>{class u{static#e=this.type="[Engine Camera] Move Camera";constructor(m){this.cameraMotion=m}}return u})(),S=(()=>{class u{static#e=this.type="[Engine Camera] Reset Camera"}return u})(),a=(()=>{class u{static#e=this.type="[Engine Camera] Zoom Camera";constructor(m){this.value=m}}return u})(),f=(()=>{class u{static#e=this.type="[Engine Camera] Zoom Camera Static";constructor(m){this.value=m}}return u})(),E=(()=>{class u{static#e=this.type="[Engine Camera] Pan Camera X";constructor(m){this.value=m}}return u})(),y=(()=>{class u{static#e=this.type="[Engine Camera] Pan Camera Y";constructor(m){this.value=m}}return u})(),i=(()=>{class u{static#e=this.type="[Engine Camera] Pan Camera Static";constructor(m,C,b){this.x=m,this.y=C,this.z=b}}return u})(),g=(()=>{class u{static#e=this.type="[Engine Camera] Rotate Camera X";constructor(m){this.value=m}}return u})(),p=(()=>{class u{static#e=this.type="[Engine Camera] Rotate Camera Y";constructor(m){this.value=m}}return u})(),h=(()=>{class u{static#e=this.type="[Engine Camera] Rotate Camera Static";constructor(m,C){this.x=m,this.y=C}}return u})(),o=(()=>{class u{static#e=this.type="[Engine Camera] Set Camera Mode";constructor(m){this.mode=m}}return u})(),v=(()=>{class u{static#e=this.type="[Engine Camera] Set Zoomed";constructor(m){this.zoomed=m}}return u})(),d=(()=>{class u{static#e=this.type="[Engine Camera] Lock camera";constructor(m){this.lock=m}}return u})(),r=(()=>{class u{static#e=this.type="[Engine Camera] Set Camera Fly To";constructor(m){this.camera=m}}return u})(),_=(()=>{class u{static#e=this.type="[Engine Camera] Patch Camera State";constructor(m){this.patches=m}}return u})()},3829:(le,N,n)=>{"use strict";n.d(N,{x:()=>o});var e=n(28407),t=n(92014);class s{}var c=n(7431),O=n(3266),P=n(57021),S=n(94495),a=n(81025),f=n(18617),E=n(79805),y=n(49204),i=n(54438),g=function(v,d,r,_){var m,u=arguments.length,l=u<3?d:null===_?_=Object.getOwnPropertyDescriptor(d,r):_;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(v,d,r,_);else for(var C=v.length-1;C>=0;C--)(m=v[C])&&(l=(u<3?m(l):u>3?m(d,r,l):m(d,r))||l);return u>3&&l&&Object.defineProperty(d,r,l),l},p=function(v,d){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(v,d)};const h={cameraMotion:new P.x,panMode:"rotate",zoomed:!1,lockCamera:!1,cameraFlyTo:void 0,chapterCameraEnabled:!0,chapterCameraPositions:new Map};let o=class ms{static getState(d){return d}static getCameraMotion(d){return d.cameraMotion}static getPanMode(d){return d.panMode}static getZoomed(d){return d.zoomed}static getLockCamera(d){return d.lockCamera}static getChapterCameraEnabled(d){return d.chapterCameraEnabled}static getChapterCameraPositions(d){return d.chapterCameraPositions}setCameraFlyTo(d,r){d.patchState(a.jM(d.getState(),_=>{_.cameraFlyTo=r.camera}))}applyCameraPatch(d,r){const _=a.$i(d.getState(),r.patches);d.patchState(_);const u=void 0===_.cameraFlyTo?this.store.selectSnapshot(S.N.getChapterCamera):_.cameraFlyTo;d.dispatch(new c.Ih(u,!0,1))}moveCamera(d,r){d.patchState({cameraMotion:{...r.cameraMotion}})}resetCamera(d,r){var _=this;return(0,e.A)(function*(){const u=_.store.selectSnapshot(S.N.getSelectedChapter);return((0,y.isNil)(_.engineService.engine?.story?.activeChapter)?Promise.resolve():_.cameraService.flyToCamera(u.camera.location)).then(()=>{d.patchState({cameraMotion:new P.x})})})()}zoomCamera(d,r){const{cameraMotion:_}=d.getState();_.zoom=r.value,d.patchState({cameraMotion:{..._}})}panCameraX(d,r){const{cameraMotion:_}=d.getState();_.panX=r.value,d.patchState({cameraMotion:{..._}})}panCameraY(d,r){const{cameraMotion:_}=d.getState();_.panY=r.value,d.patchState({cameraMotion:{..._}})}rotateCameraX(d,r){const{cameraMotion:_}=d.getState();d.patchState({cameraMotion:{..._,rotateX:r.value}})}rotateCameraY(d,r){const{cameraMotion:_}=d.getState();_.rotateY=r.value,d.patchState({cameraMotion:{..._}})}SetCameraMode(d,r){d.patchState({panMode:r.mode}),this.liveAnnouncer.announce(`Switched to ${r.mode} mode`)}setZoomed(d,r){d.patchState({zoomed:r.zoomed})}lockCamera(d,r){d.patchState({lockCamera:r.lock})}setChapterCameraEnabled(d,r){d.patchState({chapterCameraEnabled:r.enabled})}setChapterCameraPosition(d,r){const _=d.getState().chapterCameraPositions;_.set(r.chapterId,r.position),d.patchState({chapterCameraPositions:_})}clearChapterCameraPositions(d){const r=d.getState().chapterCameraPositions;r.clear(),d.patchState({chapterCameraPositions:r})}constructor(d,r,_,u){this.cameraService=d,this.liveAnnouncer=r,this.store=_,this.engineService=u}static#e=this.\u0275fac=function(r){return new(r||ms)(i.KVO(O.j),i.KVO(f.Ai),i.KVO(t.il),i.KVO(E.y))};static#t=this.\u0275prov=i.jDH({token:ms,factory:ms.\u0275fac})};g([(0,t.rc)(c.Yp),p("design:type",Function),p("design:paramtypes",[Object,c.Yp]),p("design:returntype",void 0)],o.prototype,"setCameraFlyTo",null),g([(0,t.rc)(c.sQ),p("design:type",Function),p("design:paramtypes",[Object,c.sQ]),p("design:returntype",void 0)],o.prototype,"applyCameraPatch",null),g([(0,t.rc)(c.P4),p("design:type",Function),p("design:paramtypes",[Object,c.P4]),p("design:returntype",void 0)],o.prototype,"moveCamera",null),g([(0,t.rc)(c.nW),p("design:type",Function),p("design:paramtypes",[Object,c.nW]),p("design:returntype",Promise)],o.prototype,"resetCamera",null),g([(0,t.rc)(c.pg),p("design:type",Function),p("design:paramtypes",[Object,c.pg]),p("design:returntype",void 0)],o.prototype,"zoomCamera",null),g([(0,t.rc)(c.RG),p("design:type",Function),p("design:paramtypes",[Object,c.RG]),p("design:returntype",void 0)],o.prototype,"panCameraX",null),g([(0,t.rc)(c.Yi),p("design:type",Function),p("design:paramtypes",[Object,c.Yi]),p("design:returntype",void 0)],o.prototype,"panCameraY",null),g([(0,t.rc)(c.j4),p("design:type",Function),p("design:paramtypes",[Object,c.j4]),p("design:returntype",void 0)],o.prototype,"rotateCameraX",null),g([(0,t.rc)(c.qG),p("design:type",Function),p("design:paramtypes",[Object,c.qG]),p("design:returntype",void 0)],o.prototype,"rotateCameraY",null),g([(0,t.rc)(c.vq),p("design:type",Function),p("design:paramtypes",[Object,c.vq]),p("design:returntype",void 0)],o.prototype,"SetCameraMode",null),g([(0,t.rc)(c.Xz),p("design:type",Function),p("design:paramtypes",[Object,c.Xz]),p("design:returntype",void 0)],o.prototype,"setZoomed",null),g([(0,t.rc)(c.pU),p("design:type",Function),p("design:paramtypes",[Object,c.pU]),p("design:returntype",void 0)],o.prototype,"lockCamera",null),g([(0,t.rc)(c.Qn),p("design:type",Function),p("design:paramtypes",[Object,c.Qn]),p("design:returntype",void 0)],o.prototype,"setChapterCameraEnabled",null),g([(0,t.rc)(c.gV),p("design:type",Function),p("design:paramtypes",[Object,c.gV]),p("design:returntype",void 0)],o.prototype,"setChapterCameraPosition",null),g([(0,t.rc)(c.Cy),p("design:type",Function),p("design:paramtypes",[Object]),p("design:returntype",void 0)],o.prototype,"clearChapterCameraPositions",null),g([(0,t.MD)(),p("design:type",Function),p("design:paramtypes",[s]),p("design:returntype",void 0)],o,"getState",null),g([(0,t.MD)(),p("design:type",Function),p("design:paramtypes",[s]),p("design:returntype",void 0)],o,"getCameraMotion",null),g([(0,t.MD)(),p("design:type",Function),p("design:paramtypes",[s]),p("design:returntype",void 0)],o,"getPanMode",null),g([(0,t.MD)(),p("design:type",Function),p("design:paramtypes",[s]),p("design:returntype",void 0)],o,"getZoomed",null),g([(0,t.MD)(),p("design:type",Function),p("design:paramtypes",[s]),p("design:returntype",void 0)],o,"getLockCamera",null),g([(0,t.MD)(),p("design:type",Function),p("design:paramtypes",[s]),p("design:returntype",void 0)],o,"getChapterCameraEnabled",null),g([(0,t.MD)(),p("design:type",Function),p("design:paramtypes",[s]),p("design:returntype",void 0)],o,"getChapterCameraPositions",null),o=g([(0,t.Uw)({name:"engineCamera",defaults:h}),p("design:paramtypes",[O.j,f.Ai,t.il,E.y])],o)},20339:(le,N,n)=>{"use strict";n.d(N,{Z:()=>e});let e=(()=>{class t{static#e=this.type="[Engine Config] Set Show Unavailable Nodes";constructor(c){this.showUnavailableNodes=c}}return t})()},43631:(le,N,n)=>{"use strict";n.d(N,{_:()=>S});var e=n(92014);class t{}var s=n(20339),c=n(54438),O=function(a,f,E,y){var p,i=arguments.length,g=i<3?f:null===y?y=Object.getOwnPropertyDescriptor(f,E):y;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)g=Reflect.decorate(a,f,E,y);else for(var h=a.length-1;h>=0;h--)(p=a[h])&&(g=(i<3?p(g):i>3?p(f,E,g):p(f,E))||g);return i>3&&g&&Object.defineProperty(f,E,g),g},P=function(a,f){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(a,f)};let S=class fs{static getPerChapterTreeEnabled(f){return f.perChapterTreeEnabled}static getShowUnavailableNodes(f){return f.showUnavailableNodes}setShowUnavailableNodes(f,{showUnavailableNodes:E}){f.patchState({showUnavailableNodes:E})}static#e=this.\u0275fac=function(E){return new(E||fs)};static#t=this.\u0275prov=c.jDH({token:fs,factory:fs.\u0275fac})};O([(0,e.rc)(s.Z),P("design:type",Function),P("design:paramtypes",[Object,s.Z]),P("design:returntype",void 0)],S.prototype,"setShowUnavailableNodes",null),O([(0,e.MD)(),P("design:type",Function),P("design:paramtypes",[t]),P("design:returntype",void 0)],S,"getPerChapterTreeEnabled",null),O([(0,e.MD)(),P("design:type",Function),P("design:paramtypes",[t]),P("design:returntype",void 0)],S,"getShowUnavailableNodes",null),S=O([(0,e.Uw)({name:"engineConfig",defaults:{showUnavailableNodes:!1,perChapterTreeEnabled:!0}})],S)},47610:(le,N,n)=>{"use strict";n.d(N,{$V:()=>l,$h:()=>D,A0:()=>_,A6:()=>k,AU:()=>s,B9:()=>Z,BM:()=>X,DZ:()=>$,E7:()=>F,GT:()=>u,Gv:()=>A,In:()=>f,JK:()=>P,K6:()=>x,LL:()=>y,P6:()=>b,PF:()=>Q,Pk:()=>oe,RR:()=>te,RV:()=>re,RZ:()=>L,Rc:()=>m,Sh:()=>ie,Tf:()=>e,Ti:()=>R,Vs:()=>T,W6:()=>r,YI:()=>ae,_h:()=>q,_o:()=>K,_y:()=>p,bo:()=>ue,dB:()=>S,dE:()=>V,fZ:()=>d,hk:()=>O,iQ:()=>t,jM:()=>W,kE:()=>z,lQ:()=>se,pL:()=>G,q:()=>i,qL:()=>H,ro:()=>ce,t5:()=>c,u3:()=>h,uM:()=>de,v$:()=>M,vA:()=>w,w8:()=>g,z:()=>j,zE:()=>o,zW:()=>a,zw:()=>I});let e=(()=>{class Y{static#e=this.type="[Engine] Load";constructor(){}}return Y})(),t=(()=>{class Y{static#e=this.type="[Engine] Load Success";constructor(ne){this.result=ne}}return Y})(),s=(()=>{class Y{static#e=this.type="[Engine] Set Ready";constructor(ne){this.ready=ne}}return Y})(),c=(()=>{class Y{static#e=this.type="[Engine] Set Display of 3D Scene";constructor(ne){this.display=ne}}return Y})(),O=(()=>{class Y{static#e=this.type="[Engine] Set Zoom via scroll Allowed";constructor(ne){this.scrollMode=ne}}return Y})(),P=(()=>{class Y{static#e=this.type="[Engine] Set Scroll Alert Shwon";constructor(ne){this.shown=ne}}return Y})(),S=(()=>{class Y{static#e=this.type="[Engine] Set Visibility of 3D Scene";constructor(ne){this.visible=ne}}return Y})(),a=(()=>{class Y{static#e=this.type="[Engine] Fade";constructor(ne,_e){this.color=ne,this.duration=_e}}return Y})(),f=(()=>{class Y{static#e=this.type="[Engine] Fade Complete";constructor(){}}return Y})(),y=(()=>{class Y{static#e=this.type="[Engine] Set Graph";constructor(ne){this.graph=ne}}return Y})(),i=(()=>{class Y{static#e=this.type="[Engine] Get Graph Metadata";constructor(){}}return Y})(),g=(()=>{class Y{static#e=this.type="[Engine] Clear Graph";constructor(){}}return Y})(),p=(()=>{class Y{static#e=this.type="[Engine] Set Xray Mode";constructor(ne){this.enabled=ne}}return Y})(),h=(()=>{class Y{static#e=this.type="[Engine] Set Engine Chapter";constructor(ne){this.chapterId=ne}}return Y})(),o=(()=>{class Y{static#e=this.type="[Engine] Click Node";constructor(ne,_e,Ce){this.node=ne,this.event=_e,this.hit=Ce}}return Y})(),d=(()=>{class Y{static#e=this.type="[Engine] Set Contextmenu";constructor(ne,_e){this.node=ne,this.hit=_e}}return Y})(),r=(()=>{class Y{static#e=this.type="[Engine] Fly To Object";constructor(ne,_e=!0,Ce){this.objectId=ne,this.animate=_e,this.animationDuration=Ce}}return Y})(),_=(()=>{class Y{static#e=this.type="[Engine] Synchronize Visible Nodes On Tree";constructor(ne,_e){this.leafVisibilityState=ne,this.nodes=_e}}return Y})(),u=(()=>{class Y{static#e=this.type="[Engine] Synchronize Renderable State of Nodes On Tree";constructor(ne){this.leafRenderableState=ne}}return Y})(),l=(()=>{class Y{static#e=this.type="[Engine] Synchronize Pickable State of Nodes On Tree";constructor(ne,_e){this.leafPickableState=ne,this.nodes=_e}}return Y})(),m=(()=>{class Y{static#e=this.type="[Engine] Synchronize Available State of Nodes On Tree";constructor(ne,_e){this.leafAvailableState=ne,this.nodes=_e}}return Y})(),b=(()=>{class Y{static#e=this.type="[Engine] Toggle Camera Bar";constructor(ne){this.show=ne}}return Y})(),R=(()=>{class Y{static#e=this.type="[Engine] Toggle Progress Bar";constructor(ne){this.show=ne}}return Y})(),A=(()=>{class Y{static#e=this.type="[Engine] Toggle Labels";constructor(ne){this.show=ne}}return Y})(),G=(()=>{class Y{static#e=this.type="[Engine] Set active tool";constructor(ne){this.tool=ne}}return Y})(),k=(()=>{class Y{static#e=this.type="[Engine] Play chapter animation";constructor(){}}return Y})(),V=(()=>{class Y{static#e=this.type="[Engine] Play animation";constructor(ne=!0){this.play=ne}}return Y})(),W=(()=>{class Y{static#e=this.type="[Engine] Set animation playing";constructor(ne){this.playing=ne}}return Y})(),T=(()=>{class Y{static#e=this.type="[Engine] Set playback speed";constructor(ne){this.speed=ne}}return Y})(),x=(()=>{class Y{static#e=this.type="[Engine] Play chapter from start";constructor(){}}return Y})(),z=(()=>{class Y{static#e=this.type="[Engine] Set autoplay";constructor(ne){this.enable=ne}}return Y})(),I=(()=>{class Y{static#e=this.type="[Engine] Set object layer order";constructor(ne,_e){this.nodes=ne,this.layer=_e}}return Y})(),D=(()=>{class Y{static#e=this.type="[Engine] Set object display name";constructor(ne,_e){this.nodeId=ne,this.displayName=_e}}return Y})(),L=(()=>{class Y{static#e=this.type="[Engine] Auto Sort object layer orders";constructor(){}}return Y})(),Q=(()=>{class Y{static#e=this.type="[Engine] Reset object layer orders";constructor(){}}return Y})(),ie=(()=>{class Y{static#e=this.type="[Engine] Set Engine Position";constructor(ne){this.position=ne}}return Y})(),se=(()=>{class Y{static#e=this.type="[Engine] Reset Engine Position";constructor(){}}return Y})(),Z=(()=>{class Y{static#e=this.type="[Engine] Reset Interactions";constructor(){}}return Y})(),de=(()=>{class Y{static#e=this.type="[Engine] Set Post Processing Effects";constructor(ne){this.effects=ne}}return Y})(),ae=(()=>{class Y{static#e=this.type="[Engine] Set Properties";constructor(ne){this.properties=ne}}return Y})(),q=(()=>{class Y{static#e=this.type="[Engine] Set Transparency Mode";constructor(ne){this.mode=ne}}return Y})(),K=(()=>{class Y{static#e=this.type="[Engine] Expand ViewTree Node";constructor(ne){this.node=ne}}return Y})(),j=(()=>{class Y{static#e=this.type="[Engine] Collapse ViewTree Node";constructor(ne){this.node=ne}}return Y})(),M=(()=>{class Y{static#e=this.type="[Engine] Collapse All ViewTree Nodes";constructor(){}}return Y})(),$=(()=>{class Y{static#e=this.type="[Engine] Hover Node";constructor(ne,_e){this.node=ne,this.hit=_e}}return Y})(),ce=(()=>{class Y{static#e=this.type="[Engine] Set Label Edit Node";constructor(ne){this.node=ne}}return Y})(),re=(()=>{class Y{static#e=this.type="[Engine] Set Node Info";constructor(ne,_e){this.node=ne,this.info=_e}}return Y})(),ue=(()=>{class Y{static#e=this.type="[Engine] Query Node Info";constructor(ne,_e,Ce){this.node=ne,this.fallback=_e,this.lang=Ce}}return Y})(),H=(()=>{class Y{static#e=this.type="[Engine] Query Node Info Success";constructor(ne,_e){this.node=ne,this.info=_e}}return Y})(),te=(()=>{class Y{static#e=this.type="[Engine Nodes] Query Node Info Failure";constructor(ne){this.node=ne}}return Y})(),F=(()=>{class Y{static#e=this.type="[Engine] Set Watermark Enabled";constructor(ne){this.enabled=ne}}return Y})(),w=(()=>{class Y{static#e=this.type="[Engine] Set Engine WebGL Context";constructor(ne){this.context=ne}}return Y})(),X=(()=>{class Y{static#e=this.type="[Engine] Set Engine Stats Enabled";constructor(ne,_e){this.enabled=ne,this.showAdvancedTools=_e}}return Y})(),oe=(()=>{class Y{static#e=this.type="[Engine] Set Pick State";constructor(ne){this.pickState=ne}}return Y})()},76304:(le,N,n)=>{"use strict";n.d(N,{S:()=>q});var e=n(92014);class t{}var s=n(47610),c=n(78109),O=n(79805),P=n(23881),S=n(24911),a=n(4664),f=n(3829),E=n(47555),y=n(13878),i=n(14264),g=n(17365),p=n(15152),h=n(79435),o=n(44867),v=n(12347),d=n(54438);let r=(()=>{class K{constructor(M){this.engineService=M}setPostProcessingFeatures(M){const{renderer:$,story:ce}=this.engineService.engine;ce?.activeChapter&&(ce.activeChapter.postProcess.length=0,ce.activeChapter.postProcess.push(...M)),$.setPostProcessingPipeline(M)}static#e=this.\u0275fac=function($){return new($||K)(d.KVO(O.y))};static#t=this.\u0275prov=d.jDH({token:K,factory:K.\u0275fac,providedIn:"root"})}return K})();var _=n(46799),u=n(35650),l=n(73987),m=n(56343),C=n(43631),b=n(28407);const R={};var A=function(K){return K.Binary="application/octet-stream",K.JSON="application/json;charset=UTF-8",K}(A||{});const G="assetCache";class k{addToCache(j,M){return(0,b.A)(function*(){const $=M instanceof ArrayBuffer?M:JSON.stringify(M),ce=$ instanceof ArrayBuffer?A.Binary:A.JSON,re=$ instanceof ArrayBuffer?$.byteLength:$.length,ue=new Response($,{headers:{...R,"Content-Type":ce,"Content-Length":`${re}`}});return(yield caches.open(G)).put(j,ue)})()}removeFromCache(j){return(0,b.A)(function*(){return(yield caches.open(G)).delete(j)})()}getFromCache(j){return(0,b.A)(function*(){const $=yield(yield caches.open(G)).match(j),ce=$?.headers?.get("Content-Type");if(ce)return"application/octet-stream"===ce?$.arrayBuffer():$.json()})()}closeCache(){return(0,b.A)(function*(){})()}}var V=n(29160);const W="/assets/latin/l2bi.json";function T(K){return{titlesToLatin:I(K)}}function z(){return(z=(0,b.A)(function*(){return yield(yield fetch(W)).json()})).apply(this,arguments)}function I(K){return Object.entries(K).reduce((j,[M,$])=>($.forEach(ce=>{j[ce]=M}),j),{})}var D=n(49204);let L=(()=>{class K{constructor(){this.graphMetadata=new V.t(void 0)}getGraphMetadata(){return(0,D.isNil)(this.graphMetadata.value)&&this.fetchGraphMetadata().then(M=>{this.graphMetadata.next(M)}),this.graphMetadata.asObservable()}destroy(){this.cacheDatabase?.closeCache(),this.cacheDatabase=null}fetchGraphMetadata(){var M=this;return(0,b.A)(function*(){M.destroy(),M.cacheDatabase=new k;const $=yield M.cacheDatabase.getFromCache(W);if($){const ce=T($);return M.graphMetadata.next(ce),ce}{const ce=yield function x(){return z.apply(this,arguments)}();M.cacheDatabase.addToCache(W,ce);const re=T(ce);return M.graphMetadata.next(re),re}})()}static#e=this.\u0275fac=function($){return new($||K)};static#t=this.\u0275prov=d.jDH({token:K,factory:K.\u0275fac,providedIn:"root"})}return K})();var de,Q=n(90917),ie=n(32724),se=function(K,j,M,$){var ue,ce=arguments.length,re=ce<3?j:null===$?$=Object.getOwnPropertyDescriptor(j,M):$;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)re=Reflect.decorate(K,j,M,$);else for(var H=K.length-1;H>=0;H--)(ue=K[H])&&(re=(ce<3?ue(re):ce>3?ue(j,M,re):ue(j,M))||re);return ce>3&&re&&Object.defineProperty(j,M,re),re},Z=function(K,j){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(K,j)};const ae=new S.j(0,0,0,0,0,0,a.g.Hidden,1);let q=class ys{static#e=de=this;static getEngine(j){return j.engine}static getReady(j){return j.ready}static getDisplay(j){return j.display}static getScrollMode(j){return j.scrollMode}static getVisible(j){return j.visible}static getViewGraph(j){return j.viewGraph}static getViewGraphMetadata(j){return j.viewGraphMetadata}static getTreeGraph(j,M){return M?j:(0,o.vU)(j)}static getViewGraphNode(j){return M=>j.viewGraph.nodes[M]}static getEnginePosition(j){return j.enginePosition}static getCanvasHeightBreakpoint(j,M){return M?l.h.Standard:j?.height<375?l.h.Tiny:j?.height<480?l.h.Small:l.h.Standard}static getChapter(j){return j.chapter}static getActiveTool(j){return j.activeTool}static getShowCameraBar(j){return j.showCameraBar}static getShowProgressBar(j){return j.showProgressBar}static getShowLabels(j){return j.showLabels}static getAnimationPlaying(j){return j.animationPlaying}static getAutoplay(j){return j.autoplay}static getXrayModeEnabled(j){return j.xrayModeEnabled}static getHoveredNode(j){return j.hoveredNode}static getLabelEditNode(j){return j.labelEditNode}static getQuerying(j){return j.queryingAnatomy}static getContextMenu(j){return j.contextMenu}static getPlaybackSpeed(j){return j.playbackSpeed}static getWatermarkEnabled(j){return j.watermarkEnabled}static getWebGLContextName(j){return j.webGLContextName}static getStatsEnabled(j){return j.stats.enabled}static getShowAdvancedStatsTools(j){return j.stats.showAdvancedTools}static getClickPickEnabled(j){return j.pickState.clickEnabled}static getHoverPickEnabled(j){return j.pickState.hoverEnabled}static getViewGraphRank(j){return j.viewGraphRank}load(j,M){j.dispatch(new s.iQ("engine"))}loadSuccess({patchState:j},M){j({engine:M.result})}setReady(j,M){j.patchState({ready:M.ready})}setDisplay(j,M){j.patchState({display:M.display})}setZoomViaScrollAllowed(j,M){j.patchState({scrollMode:M.scrollMode})}setVisible(j,M){j.patchState({visible:M.visible})}setEnginePosition(j,M){j.patchState({enginePosition:{...M.position,right:M.position.left+M.position.width,bottom:M.position.top+M.position.height}})}resetEnginePosition(j,M){j.patchState({enginePosition:ae})}setChapter(j,M){j.patchState({chapter:M.chapterId})}setActiveTool(j,M){j.patchState({activeTool:M.tool})}setGraph(j,{graph:M}){const $=(0,Q.D$)(Object.values(M.nodes),[{field:"shown",dir:"asc"},{field:"label",dir:"asc"}]).reduce((ce,re,ue)=>(ce[re.id]=ue,ce),{});j.patchState({viewGraph:{...M},viewGraphRank:{initiallyShownRank:$}})}getGraphMetadata(j){const{viewGraphMetadata:M}=j.getState();(0,D.isEmpty)(M)&&this.nodeSearchService.getGraphMetadata().pipe((0,i.p)($=>!(0,D.isEmpty)($)),(0,g.s)(1)).subscribe($=>{const{viewGraph:ce}=j.getState();j.patchState({viewGraphMetadata:$,viewGraph:{...(0,o.u7)(ce,$)}})})}clearGraph(j){j.patchState({viewGraph:(0,P.q3)(),viewGraphRank:{initiallyShownRank:{}}})}setXrayMode(j,M){j.patchState({xrayModeEnabled:M.enabled})}toggleProgressBar(j,M){j.patchState({showProgressBar:M.show})}toggleCameraBar(j,M){j.patchState({showCameraBar:M.show})}toggleLabels(j,M){const $=null!=M.show?M.show:!j.getState().showLabels;j.patchState({showLabels:$})}synchronizeVisibleNodes(j,M){const $=j.getState().viewGraph,ce=this.stateMapToNodeIds($,M.leafVisibilityState),re={};ce.forEach(ue=>{const te=this.sceneService.getLeafIds(ue).reduce((F,w)=>F||M.nodes[w].shown,!1);re[ue]={shown:te}}),this.graphService.synchronize({...$},{shown:m.t.TrueWins},re),j.patchState({viewGraph:{...$}})}synchronizeRenderableNodes(j,M){const $=j.getState().viewGraph,ce=this.stateMapToNodeIds($,M.leafRenderableState),re={};ce.forEach(ue=>{re[ue]={renderable:!0}}),this.graphService.synchronize($,{renderable:m.t.FalseWins},re)}synchronizePickableNodes(j,M){const $=j.getState().viewGraph,ce=this.stateMapToNodeIds($,M.leafPickableState),re={};ce.forEach(ue=>{const te=this.sceneService.getLeafIds(ue).reduce((F,w)=>F||this.sceneService.getObjectById(w).pickable,!1);re[ue]={pickable:te}}),this.graphService.synchronize($,{pickable:m.t.TrueWins},re),j.patchState({viewGraph:{...$}})}synchronizeAvailableNodes(j,M){const $=j.getState().viewGraph,ce=this.stateMapToNodeIds($,M.leafAvailableState),re={};ce.forEach(ue=>{const te=this.sceneService.getLeafIds(ue).reduce((F,w)=>F||M.nodes[w].available,!1);re[ue]={available:te}}),this.graphService.synchronize($,{available:m.t.TrueWins},re),j.patchState({viewGraph:{...$}})}playChapterAnimation(j,M){this.animationService.restart(),j.getState().animationPlaying||this.animationService.pause()}toggleAnimation(j,M){M.play?this.animationService.unpause():this.animationService.pause()}setAnimationPlaying(j,M){j.patchState({animationPlaying:M.playing})}setPlaybackSpeed(j,M){j.patchState({playbackSpeed:M.speed})}setAutoplay(j,M){j.patchState({autoplay:M.enable})}setObjectLayerOrder(j,M){const $=j.getState().viewGraph,ce=isNaN(M.layer)?0:M.layer,{anatomyObjects:re}=this.sceneService.getAnatomySceneGraph();let ue=[];M.nodes.forEach(H=>{const te=this.graphService.getDescendants($,H.id,!0);ue=ue.concat(te)}),ue.forEach(H=>{this.sceneService.setObjectLayer(re,H,ce),this.graphService.setState($,H,{layer:ce})}),j.patchState({viewGraph:{...$}})}setObjectDisplayName(j,M){const{nodeId:$,displayName:ce}=M,re=j.getState().viewGraph,ue=re.nodes[$],H=this.sceneService.getObjectById($);H&&(H.displayName=ce),ue&&(ue.label=ce,j.patchState({viewGraph:{...re}}))}autoSortObjectLayers(j,M){const $=j.getState().viewGraph;let re=0;const ue=this.sceneService.getEnabledLeafIds(),H=this.sceneService.getObjectLayerValues(ue),{anatomyObjects:te}=this.sceneService.getAnatomySceneGraph();Object.keys(H).map(F=>parseInt(F,10)).sort((F,w)=>F-w).forEach(F=>{H[F].sort((w,X)=>X.value-w.value).forEach(w=>{const X=20*re;this.sceneService.setObjectLayer(te,w.nodeId,X),this.graphService.setState($,w.nodeId,{layer:X}),re++})}),j.patchState({viewGraph:{...$}})}resetObjectLayers(j,M){const $=j.getState().viewGraph,ce=this.sceneService.getEnabledLeafIds(),{anatomyObjects:re}=this.sceneService.getAnatomySceneGraph();ce.forEach(ue=>{this.sceneService.setObjectLayer(re,ue,0),this.graphService.setState($,ue,{layer:0})}),j.patchState({viewGraph:{...$}})}setPostProcessingEffects(j,{effects:M}){this.postProcessingService.setPostProcessingFeatures(M)}setProperties(j,{properties:M}){this.engineService.setProperties({...M})}setTransparencyMode(j,{mode:M}){this.engineRendererService.setTransparencyMode(M)}expandNode(j,M){const $=this.store.selectSnapshot(de.getViewGraph);(0,o.DS)($,M.node.id,!0).forEach(re=>{$.nodes[re].boolState.expanded=!0}),j.patchState({viewGraph:{...$}})}collapseNode(j,M){const $=this.store.selectSnapshot(de.getViewGraph);$.nodes[M.node.id].boolState.expanded=!1,j.patchState({viewGraph:{...$}})}collapseAllViewTreeNodes(j,M){const $=this.store.selectSnapshot(de.getViewGraph);Object.values($.nodes).forEach(ce=>{ce.boolState.expanded=!1}),j.patchState({viewGraph:{...$}})}hoverNode(j,M){j.patchState({hoveredNode:M.node})}setLabelEditNode(j,M){j.patchState({labelEditNode:M.node})}queryNodeInfo(j,{node:M,fallback:$,lang:ce}){j.patchState({queryingAnatomy:!0}),this.contentInfoService.queryNodeInfo(M.label,$,ce).pipe((0,p.j)(()=>j.patchState({queryingAnatomy:!1}))).subscribe(re=>j.dispatch(new s.qL(M,re)),()=>j.dispatch(new s.RR(M)))}queryNodeInfoSuccess(j,{node:M,info:$}){j.dispatch(new s.RV(M,$))}setNodeInfo(j,{node:M,info:$}){const ce=this.store.selectSnapshot(de.getViewGraph),re=ce.nodes[M.id];re&&$&&(re.description=$.description,re.info=$,j.patchState({viewGraph:{...ce}}))}setContextMenu(j,{node:M,hit:$}){j.patchState({contextMenu:{node:M,hit:$}})}setWatermarkEnabled(j,{enabled:M}){j.patchState({watermarkEnabled:M})}setWebGLContext(j,M){j.patchState({webGLContextName:M.context})}setEngineStatsEnabled(j,{enabled:M,showAdvancedTools:$}){j.patchState({stats:{enabled:M,showAdvancedTools:$}})}setHoverPick(j,M){j.patchState({pickState:{...j.getState().pickState,...M.pickState}})}stateMapToNodeIds(j,M){const $=Object.keys(M).map(ce=>this.sceneService.getViewNode(j,ce)).filter(ce=>!!ce).map(ce=>ce.id);return new Set($)}constructor(j,M,$,ce,re,ue,H,te,F){this.store=j,this.graphService=M,this.engineService=$,this.contentInfoService=ce,this.animationService=re,this.postProcessingService=ue,this.engineRendererService=H,this.sceneService=te,this.nodeSearchService=F}static#t=this.\u0275fac=function(M){return new(M||ys)(d.KVO(e.il),d.KVO(c.w),d.KVO(O.y),d.KVO(h.T),d.KVO(v.O),d.KVO(r),d.KVO(_.z),d.KVO(u.w),d.KVO(L))};static#n=this.\u0275prov=d.jDH({token:ys,factory:ys.\u0275fac})};se([(0,e.rc)(s.Tf),Z("design:type",Function),Z("design:paramtypes",[Object,s.Tf]),Z("design:returntype",void 0)],q.prototype,"load",null),se([(0,e.rc)(s.iQ),Z("design:type",Function),Z("design:paramtypes",[Object,s.iQ]),Z("design:returntype",void 0)],q.prototype,"loadSuccess",null),se([(0,e.rc)(s.AU),Z("design:type",Function),Z("design:paramtypes",[Object,s.AU]),Z("design:returntype",void 0)],q.prototype,"setReady",null),se([(0,e.rc)(s.t5),Z("design:type",Function),Z("design:paramtypes",[Object,s.t5]),Z("design:returntype",void 0)],q.prototype,"setDisplay",null),se([(0,e.rc)(s.hk),Z("design:type",Function),Z("design:paramtypes",[Object,s.hk]),Z("design:returntype",void 0)],q.prototype,"setZoomViaScrollAllowed",null),se([(0,e.rc)(s.dB),Z("design:type",Function),Z("design:paramtypes",[Object,s.dB]),Z("design:returntype",void 0)],q.prototype,"setVisible",null),se([(0,e.rc)(s.Sh),Z("design:type",Function),Z("design:paramtypes",[Object,s.Sh]),Z("design:returntype",void 0)],q.prototype,"setEnginePosition",null),se([(0,e.rc)(s.lQ),Z("design:type",Function),Z("design:paramtypes",[Object,s.lQ]),Z("design:returntype",void 0)],q.prototype,"resetEnginePosition",null),se([(0,e.rc)(s.u3),Z("design:type",Function),Z("design:paramtypes",[Object,s.u3]),Z("design:returntype",void 0)],q.prototype,"setChapter",null),se([(0,e.rc)(s.pL),Z("design:type",Function),Z("design:paramtypes",[Object,s.pL]),Z("design:returntype",void 0)],q.prototype,"setActiveTool",null),se([(0,e.rc)(s.LL),Z("design:type",Function),Z("design:paramtypes",[Object,s.LL]),Z("design:returntype",void 0)],q.prototype,"setGraph",null),se([(0,e.rc)(s.q),Z("design:type",Function),Z("design:paramtypes",[Object]),Z("design:returntype",void 0)],q.prototype,"getGraphMetadata",null),se([(0,e.rc)(s.w8),Z("design:type",Function),Z("design:paramtypes",[Object]),Z("design:returntype",void 0)],q.prototype,"clearGraph",null),se([(0,e.rc)(s._y),Z("design:type",Function),Z("design:paramtypes",[Object,s._y]),Z("design:returntype",void 0)],q.prototype,"setXrayMode",null),se([(0,e.rc)(s.Ti),Z("design:type",Function),Z("design:paramtypes",[Object,s.Ti]),Z("design:returntype",void 0)],q.prototype,"toggleProgressBar",null),se([(0,e.rc)(s.P6),Z("design:type",Function),Z("design:paramtypes",[Object,s.P6]),Z("design:returntype",void 0)],q.prototype,"toggleCameraBar",null),se([(0,e.rc)(s.Gv),Z("design:type",Function),Z("design:paramtypes",[Object,s.Gv]),Z("design:returntype",void 0)],q.prototype,"toggleLabels",null),se([(0,e.rc)(s.A0),Z("design:type",Function),Z("design:paramtypes",[Object,s.A0]),Z("design:returntype",void 0)],q.prototype,"synchronizeVisibleNodes",null),se([(0,e.rc)(s.GT),Z("design:type",Function),Z("design:paramtypes",[Object,s.GT]),Z("design:returntype",void 0)],q.prototype,"synchronizeRenderableNodes",null),se([(0,e.rc)(s.$V),Z("design:type",Function),Z("design:paramtypes",[Object,s.$V]),Z("design:returntype",void 0)],q.prototype,"synchronizePickableNodes",null),se([(0,e.rc)(s.Rc),Z("design:type",Function),Z("design:paramtypes",[Object,s.Rc]),Z("design:returntype",void 0)],q.prototype,"synchronizeAvailableNodes",null),se([(0,e.rc)(s.A6),Z("design:type",Function),Z("design:paramtypes",[Object,s.A6]),Z("design:returntype",void 0)],q.prototype,"playChapterAnimation",null),se([(0,e.rc)(s.dE),Z("design:type",Function),Z("design:paramtypes",[Object,s.dE]),Z("design:returntype",void 0)],q.prototype,"toggleAnimation",null),se([(0,e.rc)(s.jM),Z("design:type",Function),Z("design:paramtypes",[Object,s.jM]),Z("design:returntype",void 0)],q.prototype,"setAnimationPlaying",null),se([(0,e.rc)(s.Vs),Z("design:type",Function),Z("design:paramtypes",[Object,s.Vs]),Z("design:returntype",void 0)],q.prototype,"setPlaybackSpeed",null),se([(0,e.rc)(s.kE),Z("design:type",Function),Z("design:paramtypes",[Object,s.kE]),Z("design:returntype",void 0)],q.prototype,"setAutoplay",null),se([(0,e.rc)(s.zw),Z("design:type",Function),Z("design:paramtypes",[Object,s.zw]),Z("design:returntype",void 0)],q.prototype,"setObjectLayerOrder",null),se([(0,e.rc)(s.$h),Z("design:type",Function),Z("design:paramtypes",[Object,s.$h]),Z("design:returntype",void 0)],q.prototype,"setObjectDisplayName",null),se([(0,e.rc)(s.RZ),Z("design:type",Function),Z("design:paramtypes",[Object,s.RZ]),Z("design:returntype",void 0)],q.prototype,"autoSortObjectLayers",null),se([(0,e.rc)(s.PF),Z("design:type",Function),Z("design:paramtypes",[Object,s.PF]),Z("design:returntype",void 0)],q.prototype,"resetObjectLayers",null),se([(0,e.rc)(s.uM),Z("design:type",Function),Z("design:paramtypes",[Object,s.uM]),Z("design:returntype",void 0)],q.prototype,"setPostProcessingEffects",null),se([(0,e.rc)(s.YI),Z("design:type",Function),Z("design:paramtypes",[Object,s.YI]),Z("design:returntype",void 0)],q.prototype,"setProperties",null),se([(0,e.rc)(s._h),Z("design:type",Function),Z("design:paramtypes",[Object,s._h]),Z("design:returntype",void 0)],q.prototype,"setTransparencyMode",null),se([(0,e.rc)(s._o),Z("design:type",Function),Z("design:paramtypes",[Object,s._o]),Z("design:returntype",void 0)],q.prototype,"expandNode",null),se([(0,e.rc)(s.z),Z("design:type",Function),Z("design:paramtypes",[Object,s.z]),Z("design:returntype",void 0)],q.prototype,"collapseNode",null),se([(0,e.rc)(s.v$),Z("design:type",Function),Z("design:paramtypes",[Object,s.v$]),Z("design:returntype",void 0)],q.prototype,"collapseAllViewTreeNodes",null),se([(0,e.rc)(s.DZ),Z("design:type",Function),Z("design:paramtypes",[Object,s.DZ]),Z("design:returntype",void 0)],q.prototype,"hoverNode",null),se([(0,e.rc)(s.ro),Z("design:type",Function),Z("design:paramtypes",[Object,s.ro]),Z("design:returntype",void 0)],q.prototype,"setLabelEditNode",null),se([(0,e.rc)(s.bo),Z("design:type",Function),Z("design:paramtypes",[Object,s.bo]),Z("design:returntype",void 0)],q.prototype,"queryNodeInfo",null),se([(0,e.rc)(s.qL),Z("design:type",Function),Z("design:paramtypes",[Object,s.qL]),Z("design:returntype",void 0)],q.prototype,"queryNodeInfoSuccess",null),se([(0,e.rc)(s.RV),Z("design:type",Function),Z("design:paramtypes",[Object,s.RV]),Z("design:returntype",void 0)],q.prototype,"setNodeInfo",null),se([(0,e.rc)(s.fZ),Z("design:type",Function),Z("design:paramtypes",[Object,s.fZ]),Z("design:returntype",void 0)],q.prototype,"setContextMenu",null),se([(0,e.rc)(s.E7),Z("design:type",Function),Z("design:paramtypes",[Object,s.E7]),Z("design:returntype",void 0)],q.prototype,"setWatermarkEnabled",null),se([(0,e.rc)(s.vA),Z("design:type",Function),Z("design:paramtypes",[Object,s.vA]),Z("design:returntype",void 0)],q.prototype,"setWebGLContext",null),se([(0,e.rc)(s.BM),Z("design:type",Function),Z("design:paramtypes",[Object,s.BM]),Z("design:returntype",void 0)],q.prototype,"setEngineStatsEnabled",null),se([(0,e.rc)(s.Pk),Z("design:type",Function),Z("design:paramtypes",[Object,s.Pk]),Z("design:returntype",void 0)],q.prototype,"setHoverPick",null),se([(0,e.MD)(),Z("design:type",Function),Z("design:paramtypes",[t]),Z("design:returntype",void 0)],q,"getEngine",null),se([(0,e.MD)(),Z("design:type",Function),Z("design:paramtypes",[t]),Z("design:returntype",void 0)],q,"getReady",null),se([(0,e.MD)(),Z("design:type",Function),Z("design:paramtypes",[t]),Z("design:returntype",void 0)],q,"getDisplay",null),se([(0,e.MD)(),Z("design:type",Function),Z("design:paramtypes",[t]),Z("design:returntype",void 0)],q,"getScrollMode",null),se([(0,e.MD)(),Z("design:type",Function),Z("design:paramtypes",[t]),Z("design:returntype",void 0)],q,"getVisible",null),se([(0,e.MD)(),Z("design:type",Function),Z("design:paramtypes",[t]),Z("design:returntype",void 0)],q,"getViewGraph",null),se([(0,e.MD)(),Z("design:type",Function),Z("design:paramtypes",[t]),Z("design:returntype",void 0)],q,"getViewGraphMetadata",null),se([(0,e.MD)([q.getViewGraph,C._.getShowUnavailableNodes]),Z("design:type",Function),Z("design:paramtypes",[Object,Boolean]),Z("design:returntype",Object)],q,"getTreeGraph",null),se([(0,e.MD)(),Z("design:type",Function),Z("design:paramtypes",[t]),Z("design:returntype",void 0)],q,"getViewGraphNode",null),se([(0,e.MD)(),Z("design:type",Function),Z("design:paramtypes",[t]),Z("design:returntype",void 0)],q,"getEnginePosition",null),se([(0,e.Um)({injectContainerState:!1}),(0,e.MD)([q.getEnginePosition,ie.U.getXRActive]),Z("design:type",Function),Z("design:paramtypes",[S.j,Boolean]),Z("design:returntype",Number)],q,"getCanvasHeightBreakpoint",null),se([(0,e.MD)(),Z("design:type",Function),Z("design:paramtypes",[t]),Z("design:returntype",void 0)],q,"getChapter",null),se([(0,e.MD)(),Z("design:type",Function),Z("design:paramtypes",[t]),Z("design:returntype",void 0)],q,"getActiveTool",null),se([(0,e.MD)(),Z("design:type",Function),Z("design:paramtypes",[t]),Z("design:returntype",void 0)],q,"getShowCameraBar",null),se([(0,e.MD)(),Z("design:type",Function),Z("design:paramtypes",[t]),Z("design:returntype",void 0)],q,"getShowProgressBar",null),se([(0,e.MD)(),Z("design:type",Function),Z("design:paramtypes",[t]),Z("design:returntype",void 0)],q,"getShowLabels",null),se([(0,e.MD)(),Z("design:type",Function),Z("design:paramtypes",[t]),Z("design:returntype",void 0)],q,"getAnimationPlaying",null),se([(0,e.MD)(),Z("design:type",Function),Z("design:paramtypes",[t]),Z("design:returntype",void 0)],q,"getAutoplay",null),se([(0,e.MD)(),Z("design:type",Function),Z("design:paramtypes",[t]),Z("design:returntype",void 0)],q,"getXrayModeEnabled",null),se([(0,e.MD)(),Z("design:type",Function),Z("design:paramtypes",[t]),Z("design:returntype",void 0)],q,"getHoveredNode",null),se([(0,e.MD)(),Z("design:type",Function),Z("design:paramtypes",[t]),Z("design:returntype",void 0)],q,"getLabelEditNode",null),se([(0,e.MD)(),Z("design:type",Function),Z("design:paramtypes",[t]),Z("design:returntype",void 0)],q,"getQuerying",null),se([(0,e.MD)(),Z("design:type",Function),Z("design:paramtypes",[t]),Z("design:returntype",void 0)],q,"getContextMenu",null),se([(0,e.MD)(),Z("design:type",Function),Z("design:paramtypes",[t]),Z("design:returntype",void 0)],q,"getPlaybackSpeed",null),se([(0,e.MD)(),Z("design:type",Function),Z("design:paramtypes",[t]),Z("design:returntype",void 0)],q,"getWatermarkEnabled",null),se([(0,e.MD)(),Z("design:type",Function),Z("design:paramtypes",[t]),Z("design:returntype",void 0)],q,"getWebGLContextName",null),se([(0,e.MD)(),Z("design:type",Function),Z("design:paramtypes",[t]),Z("design:returntype",void 0)],q,"getStatsEnabled",null),se([(0,e.MD)(),Z("design:type",Function),Z("design:paramtypes",[t]),Z("design:returntype",void 0)],q,"getShowAdvancedStatsTools",null),se([(0,e.MD)(),Z("design:type",Function),Z("design:paramtypes",[t]),Z("design:returntype",void 0)],q,"getClickPickEnabled",null),se([(0,e.MD)(),Z("design:type",Function),Z("design:paramtypes",[t]),Z("design:returntype",void 0)],q,"getHoverPickEnabled",null),se([(0,e.MD)(),Z("design:type",Function),Z("design:paramtypes",[t]),Z("design:returntype",void 0)],q,"getViewGraphRank",null),q=de=se([(0,e.Uw)({name:"engine",defaults:{loading:!1,ready:!1,viewGraph:(0,P.q3)(),viewGraphMetadata:void 0,viewGraphRank:{initiallyShownRank:{}},hoveredNode:void 0,labelEditNode:void 0,queryingAnatomy:!1,engine:"",chapter:"",showProgressBar:!0,showCameraBar:!0,showLabels:!0,activeTool:E.s.Select,animationPlaying:!1,autoplay:!0,display:!0,visible:!0,scrollMode:y.M.Capture,playbackSpeed:1,xrayModeEnabled:!1,contextMenu:{node:null,hit:null},watermarkEnabled:!1,stats:{enabled:!1,showAdvancedTools:!1},webGLContextName:void 0,pickState:{clickEnabled:!0,hoverEnabled:!0},xrRequesting:!1},children:[f.x]}),Z("design:paramtypes",[e.il,c.w,O.y,h.T,v.O,r,_.z,u.w,L])],q)},29284:(le,N,n)=>{"use strict";n.d(N,{BK:()=>S,_x:()=>P,iE:()=>g});var e=n(20458),t=n(63365),s=n(44867),c=n(49204);function P(p,h,o){const v=(0,s.IA)(p,h);if(0===v.length)return!1;for(const d of v)if(!0===o[d])return!0;return v.some(d=>P(p,d,o))}function S(p,h,o){switch(o[h]){case!0:return!0;case!1:return!1;case void 0:{const v=(0,s.ir)(p,h);return!!v&&S(p,v,o)}}}function a(p,h,o){if((0,c.isNil)(o))return!0;switch(o[h]){case!0:return!1;case!1:return!0;case void 0:{const v=(0,s.ir)(p,h);return!v||a(p,v,o)}}}function i(p,h,o){if(o&&o[h]&&function y(p){return"tintColor"in p||"opacity"in p||"brightness"in p||"saturation"in p||"contrast"in p}(o[h]))return(0,t.H)(o[h]);const v=(0,s.ir)(p,h);return v?i(p,v,o):e.NR}function g(p,h,o,v,d){function r(u){const l=function E(p,h,o){return(0,s.If)(h,o,v=>(0,s.ir)(p,v),v=>(0,s.IA)(p,v))}(p,u,o),m=function f(p,h,o){return S(p,h,o)||P(p,h,o)}(p,u,h),C=a(p,u,v);return{objectId:u,checked:!1,selected:!1,paint:i(p,u,d),pickable:C,shown:m,shownSetByTween:!1,available:l,variant:0}}return Object.keys(p.nodes).reduce((u,l)=>(u[l]=r(l),u),{})}},61295:(le,N,n)=>{"use strict";n.d(N,{IA:()=>c,Jp:()=>y,K8:()=>t,Ke:()=>E,LV:()=>P,NP:()=>s,Ws:()=>i,Yn:()=>e,ZF:()=>g,_n:()=>p,hg:()=>a,q9:()=>f,rg:()=>O,yr:()=>S});let e=(()=>{class h{static#e=this.type="[Engine Nodes] Reset";constructor(){}}return h})(),t=(()=>{class h{static#e=this.type="[Engine Nodes] init nodes";constructor(v){this.nodeState=v}}return h})(),s=(()=>{class h{static#e=this.type="[Engine Nodes] patch nodes";constructor(v){this.patches=v}}return h})(),c=(()=>{class h{static#e=this.type="[Engine Nodes] set active chapter";constructor(v){this.activeChapterId=v}}return h})(),O=(()=>{class h{static#e=this.type="[Engine Nodes] Duplicate node state";constructor(v,d){this.originalChapterId=v,this.copyChapterId=d}}return h})(),P=(()=>{class h{static#e=this.type="[Engine Nodes] update tween nodes shown";constructor(v,d){this.show=v,this.objectIds=d}}return h})(),S=(()=>{class h{static#e=this.type="[Engine Nodes] update nodes shown";constructor(v,d,r,_=!0,u=!1,l=!1){this.show=v,this.objectIds=d,this.patch=r,this.record=_,this.setByTween=u,this.includeUnavailable=l}}return h})(),a=(()=>{class h{static#e=this.type="[Engine Nodes] update nodes selected";constructor(v){this.objectId=v}}return h})(),f=(()=>{class h{static#e=this.type="[Engine Nodes] update nodes checked";constructor(v,d,r){this.checked=v,this.objectIds=d,this.patch=r}}return h})(),E=(()=>{class h{static#e=this.type="[Engine Nodes] update nodes pickable";constructor(v,d,r){this.pickable=v,this.objectIds=d,this.patch=r}}return h})(),y=(()=>{class h{static#e=this.type="[Engine Nodes] update nodes paint";constructor(v,d,r,_=!0){this.recipe=v,this.objectIds=d,this.patch=r,this.record=_}}return h})(),i=(()=>{class h{static#e=this.type="[Engine Nodes] update nodes available";constructor(v,d,r){this.available=v,this.objectIds=d,this.patch=r}}return h})(),g=(()=>{class h{static#e=this.type="[Engine Nodes] copy nodes paint";constructor(v,d){this.objectIds=v,this.sourceChapterId=d}}return h})(),p=(()=>{class h{static#e=this.type="[Engine Nodes] update node variants";constructor(v,d=!0){this.objectVariants=v,this.record=d}}return h})()},13409:(le,N,n)=>{"use strict";n.d(N,{z:()=>o});var e=n(92014);class t{}var s=n(61295),c=n(75069),O=n(10467),P=n(12865),S=n(63365),a=n(81025),f=n(35650),E=n(43631),y=n(44867),i=n(54438),g=function(v,d,r,_){var m,u=arguments.length,l=u<3?d:null===_?_=Object.getOwnPropertyDescriptor(d,r):_;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(v,d,r,_);else for(var C=v.length-1;C>=0;C--)(m=v[C])&&(l=(u<3?m(l):u>3?m(d,r,l):m(d,r))||l);return u>3&&l&&Object.defineProperty(d,r,l),l},p=function(v,d){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(v,d)};let o=class vs{static getState(d){return d}static getAllNodeState(d){return d.nodeState}static getActiveChapter(d){return d.activeChapterId}static getPatches(d){return d.patches}static getNodes(d,r){return d?.[r]??{}}static getAvailableNodes(d,r){return r?d:(0,y.bd)(d)}static getNodePaint(d){return r=>d.nodeState[d.activeChapterId][r].paint}static getNodeIds(d){return Object.keys(d)}static getCheckedNodeIds(d){return d.map(r=>r.objectId)}static getCheckedNodesCount(d){return d.length}static getCheckedNodes(d){return Object.values(d).filter(r=>r.checked)}static getSelectedNode(d){return Object.values(d).find(r=>r.selected)}reset(d,r){d.patchState(a.jM(d.getState(),_=>{_.activeChapterId=void 0,_.nodeState=void 0,_.patches=[],_.patchesForChapter={}}))}applyPatch(d,r){const _=a.$i(d.getState(),r.patches),u=a.jM(_,l=>{l.patchesForChapter[l.activeChapterId].push(...r.patches),l.patches=r.patches});d.patchState(u)}initNodeState(d,r){d.patchState({nodeState:r.nodeState})}setActiveChapter(d,r){const _=d.getState(),u=a.jM(_,l=>{l.activeChapterId=r.activeChapterId,l.patchesForChapter[r.activeChapterId]=l.patchesForChapter[r.activeChapterId]||[],l.patches=l.patchesForChapter[r.activeChapterId]});d.patchState(u)}duplicateNodeState(d,r){const _=d.getState(),u=a.jM(_,l=>{l.nodeState[r.copyChapterId]=l.nodeState[r.originalChapterId],l.patchesForChapter[r.copyChapterId]=l.patchesForChapter[r.originalChapterId].map(C=>(C.path[1]=r.copyChapterId,C))});d.patchState(u)}updateTweenNodesShown(d,r){const _=d.getState(),{finalState:u}=(0,P.r)(_,{...r,record:!1,setByTween:!0,includeUnavailable:!0},this.sceneService),{nodeState:l}=u;d.patchState({nodeState:l})}updateNodesShown(d,r){const _=d.getState(),{finalState:u,patches:l,inversePatches:m}=(0,P.r)(_,r,this.sceneService);d.patchState(u),r.record&&d.dispatch(new c.a.SavePatches([{forward:l,inverse:m,patchAction:s.NP}]))}updateNodesSelected(d,r){const _=d.getState();if(!_)return;const u=a.jM(_,l=>{const m=l.nodeState?.[l.activeChapterId]??{},C=Object.keys(m);void 0===r.objectId?C.forEach(b=>m[b].selected=!1):(C.forEach(b=>m[b].selected=!1),m[r.objectId].selected=!0)});d.patchState(u)}updateNodesChecked(d,r){const _=d.getState(),[u,l,m]=a.vI(_,b=>{const R=b.nodeState?.[b.activeChapterId]??{};void 0===r.patch?(r.objectIds||Object.keys(R)).forEach(G=>{R[G].checked=r.checked,r.objectIds&&(0,O.I7)(this.sceneService,G,R,"checked",r.checked)}):Object.entries(r.patch).forEach(([A,G])=>R[A].checked=G)}),C=a.jM(u,b=>{b.patches=l});d.patchState(C)}updateNodesPickable(d,r){const _=d.getState(),[u,l,m]=a.vI(_,b=>{const R=b.nodeState?.[b.activeChapterId]??{};r.patch?Object.entries(r.patch).forEach(([A,G])=>R[A].pickable=G):(r.objectIds||Object.keys(R)).forEach(G=>{R[G].pickable=r.pickable,r.objectIds&&(0,O.I7)(this.sceneService,G,R,"pickable",r.pickable)})}),C=a.jM(u,b=>{b.patches=l,b.patchesForChapter[b.activeChapterId].push(...l)});d.patchState(C),d.dispatch(new c.a.SavePatches([{forward:l,inverse:m,patchAction:s.NP}]))}updateNodesPaint(d,r){const _=d.getState(),[u,l,m]=a.vI(_,b=>{const R=b.nodeState?.[b.activeChapterId]??{},A=r.objectIds||Object.keys(R);r.patch?Object.entries(r.patch).forEach(([G,k])=>{const V=(0,S.ql)(R[G].paint,k);R[G].paint=V}):A.forEach(G=>{const k=(0,S.ql)(R[G].paint,r.recipe);R[G].paint=k,r.objectIds&&(0,O.I7)(this.sceneService,G,R,"paint",k)})}),C=a.jM(u,b=>{b.patches=l,b.patchesForChapter[b.activeChapterId].push(...l)});d.patchState(C),r.record&&d.dispatch(new c.a.SavePatches([{forward:l,inverse:m,patchAction:s.NP}]))}updateNodesAvailable(d,r){const _=d.getState(),[u,l,m]=a.vI(_,b=>{const R=b.nodeState?.[b.activeChapterId]??{};if(r.patch)Object.entries(r.patch).forEach(([A,G])=>{R[A].available=G,R[A].pickable=G});else{const{available:A,objectIds:G}=r;(G??Object.keys(R)).forEach(V=>{R[V].available=A,R[V].pickable=A,G&&((0,O.I7)(this.sceneService,V,R,"available",A),(0,O.I7)(this.sceneService,V,R,"pickable",A))})}}),C=a.jM(u,b=>{b.patches=l,b.patchesForChapter[b.activeChapterId].push(...l)});d.patchState(C),d.dispatch(new c.a.SavePatches([{forward:l,inverse:m,patchAction:s.NP}]))}updateNodeVariants(d,{objectVariants:r,record:_}){const u=d.getState(),[l,m,C]=a.vI(u,R=>{const A=R.nodeState?.[R.activeChapterId]??{};Object.entries(r).forEach(([G,k])=>{A[G].variant=k})}),b=a.jM(l,R=>{R.patches=m,R.patchesForChapter[R.activeChapterId].push(...m)});d.patchState(b),_&&d.dispatch(new c.a.SavePatches([{forward:m,inverse:C,patchAction:s.NP}]))}copyNodesPaint(d,{sourceChapterId:r,objectIds:_}){const u=d.getState(),[l,m,C]=a.vI(u,R=>{(0,O.hW)(this.sceneService,R.nodeState?.[r]??{},R.nodeState?.[R.activeChapterId]??{},_,"paint")}),b=a.jM(l,R=>{R.patches=m,R.patchesForChapter[R.activeChapterId].push(...m)});d.patchState(b),d.dispatch(new c.a.SavePatches([{forward:m,inverse:C,patchAction:s.NP}]))}constructor(d){this.sceneService=d}static#e=this.\u0275fac=function(r){return new(r||vs)(i.KVO(f.w))};static#t=this.\u0275prov=i.jDH({token:vs,factory:vs.\u0275fac})};g([(0,e.rc)(s.Yn),p("design:type",Function),p("design:paramtypes",[Object,s.Yn]),p("design:returntype",void 0)],o.prototype,"reset",null),g([(0,e.rc)(s.NP),p("design:type",Function),p("design:paramtypes",[Object,s.NP]),p("design:returntype",void 0)],o.prototype,"applyPatch",null),g([(0,e.rc)(s.K8),p("design:type",Function),p("design:paramtypes",[Object,s.K8]),p("design:returntype",void 0)],o.prototype,"initNodeState",null),g([(0,e.rc)(s.IA),p("design:type",Function),p("design:paramtypes",[Object,s.IA]),p("design:returntype",void 0)],o.prototype,"setActiveChapter",null),g([(0,e.rc)(s.rg),p("design:type",Function),p("design:paramtypes",[Object,s.rg]),p("design:returntype",void 0)],o.prototype,"duplicateNodeState",null),g([(0,e.rc)(s.LV),p("design:type",Function),p("design:paramtypes",[Object,s.LV]),p("design:returntype",void 0)],o.prototype,"updateTweenNodesShown",null),g([(0,e.rc)(s.yr),p("design:type",Function),p("design:paramtypes",[Object,s.yr]),p("design:returntype",void 0)],o.prototype,"updateNodesShown",null),g([(0,e.rc)(s.hg),p("design:type",Function),p("design:paramtypes",[Object,s.hg]),p("design:returntype",void 0)],o.prototype,"updateNodesSelected",null),g([(0,e.rc)(s.q9),p("design:type",Function),p("design:paramtypes",[Object,s.q9]),p("design:returntype",void 0)],o.prototype,"updateNodesChecked",null),g([(0,e.rc)(s.Ke),p("design:type",Function),p("design:paramtypes",[Object,s.Ke]),p("design:returntype",void 0)],o.prototype,"updateNodesPickable",null),g([(0,e.rc)(s.Jp),p("design:type",Function),p("design:paramtypes",[Object,s.Jp]),p("design:returntype",void 0)],o.prototype,"updateNodesPaint",null),g([(0,e.rc)(s.Ws),p("design:type",Function),p("design:paramtypes",[Object,s.Ws]),p("design:returntype",void 0)],o.prototype,"updateNodesAvailable",null),g([(0,e.rc)(s._n),p("design:type",Function),p("design:paramtypes",[Object,s._n]),p("design:returntype",void 0)],o.prototype,"updateNodeVariants",null),g([(0,e.rc)(s.ZF),p("design:type",Function),p("design:paramtypes",[Object,s.ZF]),p("design:returntype",void 0)],o.prototype,"copyNodesPaint",null),g([(0,e.MD)(),p("design:type",Function),p("design:paramtypes",[t]),p("design:returntype",void 0)],o,"getState",null),g([(0,e.MD)(),p("design:type",Function),p("design:paramtypes",[t]),p("design:returntype",void 0)],o,"getAllNodeState",null),g([(0,e.MD)(),p("design:type",Function),p("design:paramtypes",[t]),p("design:returntype",void 0)],o,"getActiveChapter",null),g([(0,e.MD)(),p("design:type",Function),p("design:paramtypes",[t]),p("design:returntype",void 0)],o,"getPatches",null),g([(0,e.MD)([o.getAllNodeState,o.getActiveChapter]),p("design:type",Function),p("design:paramtypes",[Object,String]),p("design:returntype",void 0)],o,"getNodes",null),g([(0,e.MD)([o.getNodes,E._.getShowUnavailableNodes]),p("design:type",Function),p("design:paramtypes",[Object,Boolean]),p("design:returntype",Object)],o,"getAvailableNodes",null),g([(0,e.MD)(),p("design:type",Function),p("design:paramtypes",[t]),p("design:returntype",void 0)],o,"getNodePaint",null),g([(0,e.MD)([o.getNodes]),p("design:type",Function),p("design:paramtypes",[Object]),p("design:returntype",void 0)],o,"getNodeIds",null),g([(0,e.MD)([o.getCheckedNodes]),p("design:type",Function),p("design:paramtypes",[Array]),p("design:returntype",void 0)],o,"getCheckedNodeIds",null),g([(0,e.MD)([o.getCheckedNodes]),p("design:type",Function),p("design:paramtypes",[Array]),p("design:returntype",void 0)],o,"getCheckedNodesCount",null),g([(0,e.MD)([o.getAvailableNodes]),p("design:type",Function),p("design:paramtypes",[Object]),p("design:returntype",void 0)],o,"getCheckedNodes",null),g([(0,e.MD)([o.getAvailableNodes]),p("design:type",Function),p("design:paramtypes",[Object]),p("design:returntype",void 0)],o,"getSelectedNode",null),o=g([(0,e.Uw)({name:"engineNodes",defaults:{activeChapterId:void 0,nodeState:void 0,patches:[],patchesForChapter:{}}}),p("design:paramtypes",[f.w])],o)},12865:(le,N,n)=>{"use strict";n.d(N,{r:()=>c});var e=n(10467),t=n(81025),s=n(44867);function c(O,P,S){if(!O.activeChapterId||!O.nodeState)return;const{objectIds:a,patch:f,setByTween:E,show:y,includeUnavailable:i}=P,[g,p,h]=t.vI(O,v=>{const d=v.nodeState[v.activeChapterId],r=i?d:(0,s.bd)(d);f?Object.entries(f).forEach(([_,u])=>{_ in r&&(r[_].shown=u)}):(a??Object.keys(r)).forEach(u=>{u in r&&(r[u].shown=y,r[u].shownSetByTween=E,a&&((0,e.I7)(S,u,r,"shown",y),!0===E&&(0,e.I7)(S,u,r,"shownSetByTween",E)))})});return{finalState:t.jM(g,v=>{v.patches=p,v.patchesForChapter[v.activeChapterId].push(...p)}),patches:p,inversePatches:h}}},10467:(le,N,n)=>{"use strict";n.d(N,{I7:()=>c,hW:()=>O});var e=n(49204);function s(S,a){const f=a.children;return 0===f.length?[]:(0,e.flattenDeep)(f.map(E=>[E.objectId,...s(S,S.getObjectById(E.objectId))]))}function c(S,a,f,E,y){const i=S.getObjectById(a);s(S,i).forEach(p=>{p in f&&(f[p][E]=y)})}function O(S,a,f,E,y){E.forEach(i=>{const g=S.getObjectById(i),p=s(S,g);P(a,f,i,y),p.forEach(h=>{P(a,f,h,y)})})}function P(S,a,f,E){a[f][E]=(0,e.cloneDeep)(S[f][E])}},35939:(le,N,n)=>{"use strict";var e,t;n.d(N,{u:()=>e}),(t=e||(e={})).SetParticleState=(()=>{class u{static#e=this.type="[Engine Particles] Set Particle State";constructor(m,C,b){this.particleSystems=m,this.assignedParticles=C,this.tweenParticleLookup=b}}return u})(),t.NewParticleSystem=(()=>{class u{static#e=this.type="[Engine Particles] New Particle System";constructor(m,C){this.particleSystem=m,this.chapterId=C}}return u})(),t.DuplicateParticleSystem=(()=>{class u{static#e=this.type="[Engine Particles] Duplicate Particle System";constructor(m,C){this.id=m,this.targetChapterId=C}}return u})(),t.DuplicateParticleSystemSuccess=(()=>{class u{static#e=this.type="[Engine Particles] Duplicate Particle System Success";constructor(m,C){this.id=m,this.targetChapterId=C}}return u})(),t.UpdateParticleSystem=(()=>{class u{static#e=this.type="[Engine Particles] Update Particle System";constructor(m,C){this.id=m,this.particleSystem=C}}return u})(),t.SetParticleSystemsVisible=(()=>{class u{static#e=this.type="[Engine Particles] Set Particle Systems Visible";constructor(m,C){this.visible=m,this.chapterId=C}}return u})(),t.SetParticleSystemVisible=(()=>{class u{static#e=this.type="[Engine Particles] Set Particle System Visible";constructor(m,C,b){this.id=m,this.visible=C,this.chapterId=b}}return u})(),t.AssignParticle=(()=>{class u{static#e=this.type="[Engine Particles] Assign Particle";constructor(m,C){this.id=m,this.chapterId=C}}return u})(),t.UnassignParticle=(()=>{class u{static#e=this.type="[Engine Particles] Unassign Particle";constructor(m,C){this.id=m,this.chapterId=C}}return u})(),t.DeleteParticleSystem=(()=>{class u{static#e=this.type="[Engine Partiles] Delete Particle System";constructor(m){this.id=m}}return u})(),t.SelectParticleSystem=(()=>{class u{static#e=this.type="[Engine Partiles] Select Particle System";constructor(m){this.id=m}}return u})(),t.SelectParticleConstraint=(()=>{class u{static#e=this.type="[Engine Partiles] Select Particle Constraint";constructor(m){this.index=m}}return u})(),t.SelectParticleCreator=(()=>{class u{static#e=this.type="[Engine Partiles] Select Particle Creator";constructor(m){this.index=m}}return u})(),t.SelectParticleUpdater=(()=>{class u{static#e=this.type="[Engine Partiles] Select Particle Updater";constructor(m){this.index=m}}return u})(),t.UpdateTweenParticleLookupChapters=(()=>{class u{static#e=this.type="[Engine Particles] Update Lookup Chapters";constructor(m){this.chapterMap=m}}return u})(),t.SetLookupForChapter=(()=>{class u{static#e=this.type="[Engine Particles] Set Lookup for chapter";constructor(m,C){this.chapterId=m,this.lookup=C}}return u})(),t.DeleteChapterLookup=(()=>{class u{static#e=this.type="[Engine Particles] Delete chapter lookup";constructor(m){this.chapterId=m}}return u})(),t.ApplyPatch=(()=>{class u{static#e=this.type="[Engine Particles] Apply Patch";constructor(m){this.patches=m}}return u})()},12921:(le,N,n)=>{"use strict";n.d(N,{B:()=>E});var f,e=n(92014),t=n(35939),s=n(11113),c=n(86544),O=n(81025),P=n(54438),S=function(y,i,g,p){var v,h=arguments.length,o=h<3?i:null===p?p=Object.getOwnPropertyDescriptor(i,g):p;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(y,i,g,p);else for(var d=y.length-1;d>=0;d--)(v=y[d])&&(o=(h<3?v(o):h>3?v(i,g,o):v(i,g))||o);return h>3&&o&&Object.defineProperty(i,g,o),o},a=function(y,i){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(y,i)};let E=class Ss{static#e=f=this;static particleSystemIdExists(i){return(0,e.Mz)([f],g=>void 0!==g.particleSystems[i])}static particleSystemsForChapter(i){return(0,e.Mz)([f],g=>(g.assignedParticles[i]||[]).map(h=>g.particleSystems[h]))}static getVisibleParticleSystemsForChapter(i){return(0,e.Mz)([f],g=>{const h=g.visibleParticleSystems[i]||{};return(g.assignedParticles[i]||[]).filter(o=>!1!==h[o])})}static getTweenParticleLookup(i){return i.tweenParticleLookup}static getParticleSystems(i){return i.particleSystems}static getVisisbleParticleSystems(i){return i.visibleParticleSystems}static getParticleSystemsList(i){return Object.values(i.particleSystems)}static getAssignedParticleSystems(i){return i.assignedParticles}static getSelectedParticleSystemId(i){return i.particleSelection.selectedParticle}static getSelectedParticleSystem(i){const{particleSystems:g,particleSelection:p}=i;return g[p.selectedParticle]}static getSelectedParticleConstraintIndex(i){return i.particleSelection.selectedConstraint}static getSelectedParticleConstraint(i){const g=f.getSelectedParticleSystem(i);return g?g.constraints[i.particleSelection.selectedConstraint]:null}static getSelectedParticleCreatorIndex(i){return i.particleSelection.selectedCreator}static getSelectedParticleCreator(i){const g=f.getSelectedParticleSystem(i);return g?g.creators[i.particleSelection.selectedCreator]:null}static getSelectedParticleUpdaterIndex(i){return i.particleSelection.selectedUpdater}static getSelectedParticleUpdater(i){const g=f.getSelectedParticleSystem(i);return g?g.updaters[i.particleSelection.selectedUpdater]:null}applyPatch(i,g){const p=O.$i(i.getState(),g.patches);i.patchState(p)}setParticleState(i,g){i.patchState(O.jM(i.getState(),p=>{p.particleSystems=g.particleSystems.reduce((h,o)=>(h[o.id]=o,h),{}),p.assignedParticles=g.assignedParticles,p.tweenParticleLookup=g.tweenParticleLookup,p.visibleParticleSystems={}}))}setParticlesVisible(i,{visible:g,chapterId:p}){i.patchState(O.jM(i.getState(),h=>{const v=(h.assignedParticles[p]||[]).reduce((d,r)=>(d[r]=g,d),{});h.visibleParticleSystems={...h.visibleParticleSystems,[p]:v}}))}setParticleVisible(i,{id:g,visible:p,chapterId:h}){i.patchState(O.jM(i.getState(),o=>{o.visibleParticleSystems[h]={...o.visibleParticleSystems[h]||{},[g]:p}}))}newParticleSystem(i,g){const{particleSystem:p,chapterId:h}=g,o=p.id,[v,d,r]=O.vI(i.getState(),_=>{_.particleSystems[o]=p,_.assignedParticles[h]=[..._.assignedParticles[h]||[],o]});i.patchState(v)}duplicateParticleSystem(i,g){const{id:p,targetChapterId:h}=g,o=c.R.generateParticleId(p);i.patchState(O.jM(i.getState(),v=>{v.particleSystems[o]=JSON.parse(JSON.stringify(v.particleSystems[p])),v.particleSystems[o].id=o,v.assignedParticles[h].push(o);const d=c.R.getParticleIdRoot(p);v.tweenParticleLookup[h]&&v.tweenParticleLookup[h][d]&&(v.tweenParticleLookup=s.e.addEntryForChapter(h,{[d]:o},v.tweenParticleLookup))})),i.dispatch(new t.u.DuplicateParticleSystemSuccess(o,h))}updateParticleSystem(i,g){const p=O.jM(i.getState(),h=>{h.particleSystems[g.id]=g.particleSystem});i.patchState({...p,particleSystems:{...p.particleSystems}})}deleteChapterLookup(i,g){i.patchState(O.jM(i.getState(),p=>{delete p.tweenParticleLookup[g.chapterId]}))}setLookupForChapter(i,g){i.patchState(O.jM(i.getState(),p=>{p.tweenParticleLookup[g.chapterId]=g.lookup}))}assignParticle(i,g){i.patchState(O.jM(i.getState(),p=>{const h=p.assignedParticles[g.chapterId]||[],o=c.R.getParticleIdRoot(g.id);p.assignedParticles[g.chapterId]=h.concat(g.id),p.tweenParticleLookup=s.e.addEntryForChapter(g.chapterId,{[o]:g.id},p.tweenParticleLookup),p.particleSystems={...p.particleSystems}}))}unassignParticle(i,g){i.patchState(O.jM(i.getState(),p=>{const h=p.assignedParticles[g.chapterId]||[],o=c.R.getParticleIdRoot(g.id);p.assignedParticles[g.chapterId]=h.filter(v=>v!==g.id),p.tweenParticleLookup[g.chapterId]&&delete p.tweenParticleLookup[g.chapterId][o],p.particleSystems={...p.particleSystems}}))}deleteParticleSystem(i,g){i.patchState(O.jM(i.getState(),p=>{delete p.particleSystems[g.id],Object.keys(p.assignedParticles).forEach(h=>{p.assignedParticles[h]=p.assignedParticles[h].filter(o=>o!==g.id)}),Object.keys(p.tweenParticleLookup).forEach(h=>{delete p.tweenParticleLookup[h][c.R.getParticleIdRoot(g.id)]})}))}selectParticleSystem(i,g){i.patchState(O.jM(i.getState(),p=>{p.particleSelection={selectedParticle:g.id}}))}selectParticleConstraint(i,g){const h=i.getState().particleSelection;i.patchState(O.jM(i.getState(),o=>{o.particleSelection={...h,selectedConstraint:g.index}}))}selectParticleCreator(i,g){const h=i.getState().particleSelection;i.patchState(O.jM(i.getState(),o=>{o.particleSelection={...h,selectedCreator:g.index}}))}selectParticleUpdater(i,g){const h=i.getState().particleSelection;i.patchState(O.jM(i.getState(),o=>{o.particleSelection={...h,selectedUpdater:g.index}}))}updateTweenParticleLookupChapters(i,g){i.patchState(O.jM(i.getState(),p=>{p.tweenParticleLookup=s.e.updateChapterIds(p.tweenParticleLookup,g.chapterMap)}))}constructor(){}static#t=this.\u0275fac=function(g){return new(g||Ss)};static#n=this.\u0275prov=P.jDH({token:Ss,factory:Ss.\u0275fac})};S([(0,e.rc)(t.u.ApplyPatch),a("design:type",Function),a("design:paramtypes",[Object,t.u.ApplyPatch]),a("design:returntype",void 0)],E.prototype,"applyPatch",null),S([(0,e.rc)(t.u.SetParticleState),a("design:type",Function),a("design:paramtypes",[Object,t.u.SetParticleState]),a("design:returntype",void 0)],E.prototype,"setParticleState",null),S([(0,e.rc)(t.u.SetParticleSystemsVisible),a("design:type",Function),a("design:paramtypes",[Object,t.u.SetParticleSystemsVisible]),a("design:returntype",void 0)],E.prototype,"setParticlesVisible",null),S([(0,e.rc)(t.u.SetParticleSystemVisible),a("design:type",Function),a("design:paramtypes",[Object,t.u.SetParticleSystemVisible]),a("design:returntype",void 0)],E.prototype,"setParticleVisible",null),S([(0,e.rc)(t.u.NewParticleSystem),a("design:type",Function),a("design:paramtypes",[Object,t.u.NewParticleSystem]),a("design:returntype",void 0)],E.prototype,"newParticleSystem",null),S([(0,e.rc)(t.u.DuplicateParticleSystem),a("design:type",Function),a("design:paramtypes",[Object,t.u.DuplicateParticleSystem]),a("design:returntype",void 0)],E.prototype,"duplicateParticleSystem",null),S([(0,e.rc)(t.u.UpdateParticleSystem),a("design:type",Function),a("design:paramtypes",[Object,t.u.UpdateParticleSystem]),a("design:returntype",void 0)],E.prototype,"updateParticleSystem",null),S([(0,e.rc)(t.u.DeleteChapterLookup),a("design:type",Function),a("design:paramtypes",[Object,t.u.DeleteChapterLookup]),a("design:returntype",void 0)],E.prototype,"deleteChapterLookup",null),S([(0,e.rc)(t.u.SetLookupForChapter),a("design:type",Function),a("design:paramtypes",[Object,t.u.SetLookupForChapter]),a("design:returntype",void 0)],E.prototype,"setLookupForChapter",null),S([(0,e.rc)(t.u.AssignParticle),a("design:type",Function),a("design:paramtypes",[Object,t.u.AssignParticle]),a("design:returntype",void 0)],E.prototype,"assignParticle",null),S([(0,e.rc)(t.u.UnassignParticle),a("design:type",Function),a("design:paramtypes",[Object,t.u.UnassignParticle]),a("design:returntype",void 0)],E.prototype,"unassignParticle",null),S([(0,e.rc)(t.u.DeleteParticleSystem),a("design:type",Function),a("design:paramtypes",[Object,t.u.DeleteParticleSystem]),a("design:returntype",void 0)],E.prototype,"deleteParticleSystem",null),S([(0,e.rc)(t.u.SelectParticleSystem),a("design:type",Function),a("design:paramtypes",[Object,t.u.SelectParticleSystem]),a("design:returntype",void 0)],E.prototype,"selectParticleSystem",null),S([(0,e.rc)(t.u.SelectParticleConstraint),a("design:type",Function),a("design:paramtypes",[Object,t.u.SelectParticleConstraint]),a("design:returntype",void 0)],E.prototype,"selectParticleConstraint",null),S([(0,e.rc)(t.u.SelectParticleCreator),a("design:type",Function),a("design:paramtypes",[Object,t.u.SelectParticleCreator]),a("design:returntype",void 0)],E.prototype,"selectParticleCreator",null),S([(0,e.rc)(t.u.SelectParticleUpdater),a("design:type",Function),a("design:paramtypes",[Object,t.u.SelectParticleUpdater]),a("design:returntype",void 0)],E.prototype,"selectParticleUpdater",null),S([(0,e.rc)(t.u.UpdateTweenParticleLookupChapters),a("design:type",Function),a("design:paramtypes",[Object,t.u.UpdateTweenParticleLookupChapters]),a("design:returntype",void 0)],E.prototype,"updateTweenParticleLookupChapters",null),S([(0,e.MD)(),a("design:type",Function),a("design:paramtypes",[Object]),a("design:returntype",void 0)],E,"getTweenParticleLookup",null),S([(0,e.MD)(),a("design:type",Function),a("design:paramtypes",[Object]),a("design:returntype",void 0)],E,"getParticleSystems",null),S([(0,e.MD)(),a("design:type",Function),a("design:paramtypes",[Object]),a("design:returntype",void 0)],E,"getVisisbleParticleSystems",null),S([(0,e.MD)(),a("design:type",Function),a("design:paramtypes",[Object]),a("design:returntype",void 0)],E,"getParticleSystemsList",null),S([(0,e.MD)(),a("design:type",Function),a("design:paramtypes",[Object]),a("design:returntype",void 0)],E,"getAssignedParticleSystems",null),S([(0,e.MD)(),a("design:type",Function),a("design:paramtypes",[Object]),a("design:returntype",void 0)],E,"getSelectedParticleSystemId",null),S([(0,e.MD)(),a("design:type",Function),a("design:paramtypes",[Object]),a("design:returntype",void 0)],E,"getSelectedParticleSystem",null),S([(0,e.MD)(),a("design:type",Function),a("design:paramtypes",[Object]),a("design:returntype",void 0)],E,"getSelectedParticleConstraintIndex",null),S([(0,e.MD)(),a("design:type",Function),a("design:paramtypes",[Object]),a("design:returntype",void 0)],E,"getSelectedParticleConstraint",null),S([(0,e.MD)(),a("design:type",Function),a("design:paramtypes",[Object]),a("design:returntype",void 0)],E,"getSelectedParticleCreatorIndex",null),S([(0,e.MD)(),a("design:type",Function),a("design:paramtypes",[Object]),a("design:returntype",void 0)],E,"getSelectedParticleCreator",null),S([(0,e.MD)(),a("design:type",Function),a("design:paramtypes",[Object]),a("design:returntype",void 0)],E,"getSelectedParticleUpdaterIndex",null),S([(0,e.MD)(),a("design:type",Function),a("design:paramtypes",[Object]),a("design:returntype",void 0)],E,"getSelectedParticleUpdater",null),E=f=S([(0,e.Uw)({name:"engineParticles",defaults:{particleSelection:{},particleSystems:{},visibleParticleSystems:{},assignedParticles:{},tweenParticleLookup:{}}}),a("design:paramtypes",[])],E)},30327:(le,N,n)=>{"use strict";n.d(N,{J:()=>t,m:()=>e});let e=(()=>{class s{static#e=this.type="[Engine Progress] Set Progress";constructor(O,P,S){this.storyLoadProgress=O,this.chapterId=P,this.chapterProgress=S}}return s})(),t=(()=>{class s{static#e=this.type="[Engine Progress] Reset Progress";constructor(){}}return s})()},82109:(le,N,n)=>{"use strict";n.d(N,{N:()=>S});var e=n(92014),t=n(30327),s=n(54438),c=function(a,f,E,y){var p,i=arguments.length,g=i<3?f:null===y?y=Object.getOwnPropertyDescriptor(f,E):y;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)g=Reflect.decorate(a,f,E,y);else for(var h=a.length-1;h>=0;h--)(p=a[h])&&(g=(i<3?p(g):i>3?p(f,E,g):p(f,E))||g);return i>3&&g&&Object.defineProperty(f,E,g),g},O=function(a,f){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(a,f)};const P={storyLoadProgress:0,chapterLoadProgress:{}};let S=class bs{constructor(){}static getStoryLoadProgress(f){return f.storyLoadProgress}static getChaptersLoadProgress(f){return f.chapterLoadProgress}setProgress(f,E){const{storyLoadProgress:y,chapterId:i,chapterProgress:g}=E;f.patchState({storyLoadProgress:y,chapterLoadProgress:{...f.getState().chapterLoadProgress,[i]:g}})}resetProgress(f,E){f.setState({...P})}static#e=this.\u0275fac=function(E){return new(E||bs)};static#t=this.\u0275prov=s.jDH({token:bs,factory:bs.\u0275fac})};c([(0,e.rc)(t.m),O("design:type",Function),O("design:paramtypes",[Object,t.m]),O("design:returntype",void 0)],S.prototype,"setProgress",null),c([(0,e.rc)(t.J),O("design:type",Function),O("design:paramtypes",[Object,t.J]),O("design:returntype",void 0)],S.prototype,"resetProgress",null),c([(0,e.MD)(),O("design:type",Function),O("design:paramtypes",[Object]),O("design:returntype",void 0)],S,"getStoryLoadProgress",null),c([(0,e.MD)(),O("design:type",Function),O("design:paramtypes",[Object]),O("design:returntype",void 0)],S,"getChaptersLoadProgress",null),S=c([(0,e.Uw)({name:"engineProgress",defaults:P}),O("design:paramtypes",[])],S)},66874:(le,N,n)=>{"use strict";n.d(N,{z:()=>p});var e=n(15877),t=n(36110),s=n(64346),c=n(19833),O=n(17365),P=n(66432),S=n(79440),a=n(24418),f=n(30234),E=n(72865),y=n(54438),i=n(21626);const g=["live"];let p=(()=>{class h{constructor(v){this.http=v}searchInternal(v="",d=""){return this.http.get(`/ws/search/internal?k=${v}&dir=${d}`).pipe((0,t.T)(r=>this.normalizeBookmarks(r.results)))}getAnatomyCategory(v,d,r=[],_=!1,u="en"){return this.search(v,[d,...r],_,u)}getConditionModel(v){if(a.c.offline)return(0,e.of)(null);const d=this.toDatabaseContentId(v);return this.http.get(`/search/conditions?q=${d}`).pipe((0,s.l)(r=>r.pipe((0,c.c)(1e3),(0,O.s)(3))),(0,t.T)(r=>this.normalizeBookmarks(r.results)),(0,t.T)(r=>r[0]))}getShowcase(v){return this.http.get(`/ws/product/app/settings/homepage-showcase?ol=${v}`).pipe((0,t.T)(d=>d.results.map(_=>(_.bookmarks=this.normalizeBookmarks(_.bookmarks),_))))}getZSpaceShowcase(){return this.getAnatomyCategory("",f.a.Zspace,[],!0).pipe((0,t.T)(v=>({title:"zSpace Models",description:" ",url:E.Wj,bookmarks:v})))}createMockShowcase(v){return{title:" ",description:" ",url:"",bookmarks:[...v],loading:!0}}createMockShowcases(v,d){return[...Array(v).keys()].map(()=>this.createMockShowcase(d))}search(v="",d,r,_){const u=v.split(/[ ]+/).join("+"),l=g.concat(d).filter(m=>""!==m&&null!=m).map(m=>`"${m}"`).join("+");return this.http.get(`/search/ai?k=${u}&t=${l}&zspace=${r}&il=${_}&ol=${_}&odns=true`).pipe((0,t.T)(m=>this.normalizeBookmarks(m.results)))}normalizeBookmarks(v){return v.map(d=>(0,S.H)(d))}getStoryCategory(v){if(!v.tags)return null;const d=(0,P.QU)().map(r=>r.id.toLocaleLowerCase());return v.tags.find(r=>d.includes(r.toLocaleLowerCase()))}toAppContentId(v){return v.replace("Condition.content.","").replace(".json","").split(".").join("/")}toDatabaseContentId(v){return v.match("Condition.content")?v:`Condition.content.${v.replace(".json","").split("/").join(".")}.json`}static#e=this.\u0275fac=function(d){return new(d||h)(y.KVO(i.Qq))};static#t=this.\u0275prov=y.jDH({token:h,factory:h.\u0275fac,providedIn:"root"})}return h})()},96298:(le,N,n)=>{"use strict";n.d(N,{Z:()=>O});var e=n(49969),t=n(28696),s=n(54438),c=n(92014);let O=(()=>{class P{constructor(a){this.store=a}ngOnInit(){}close(){this.store.dispatch(new t.w.ShowFilters(!1,!0))}static#e=this.\u0275fac=function(f){return new(f||P)(s.rXU(c.il))};static#t=this.\u0275cmp=s.VBU({type:P,selectors:[["app-gallery-drawer"]],decls:8,vars:2,consts:[["appEventFence","","data-test","galleryDrawer",1,"gallery-drawer"],[1,"gallery-drawer__header"],[1,"gallery-drawer__label"],["app-button","","buttonType","ghost","buttonTheme","light","type","button","title","Close","data-test","galleryDrawerClose",3,"click"],["icon","times","size","lg"],[1,"gallery-drawer__body"],["viewMode","expanded"]],template:function(f,E){1&f&&(s.j41(0,"div",0)(1,"div",1)(2,"h1",2),s.EFF(3,"Filters"),s.k0s(),s.j41(4,"button",3),s.bIt("click",function(){return E.close()}),s.nrm(5,"app-icon",4),s.k0s()(),s.j41(6,"div",5),s.nrm(7,"app-gallery-filters",6),s.k0s()()),2&f&&(s.Y8G("@expand",void 0),s.R7$(4),s.BMQ("aria-label","Close"))},styles:[".gallery-drawer[_ngcontent-%COMP%]{box-shadow:0 11px 15px #0003,0 24px 38px #00000024,0 9px 46px #0000001f;background:#fff;border-radius:16px 16px 0 0;display:block;position:fixed;bottom:0;top:auto;width:100vw}.gallery-drawer__header[_ngcontent-%COMP%]{font-size:.875rem;line-height:1.25rem;font-weight:600;border-bottom:1px solid #eaeff5;height:52px;padding:0 12px 0 20px;display:flex;align-items:center}.gallery-drawer__label[_ngcontent-%COMP%]{flex:1 0 auto}.gallery-drawer__body[_ngcontent-%COMP%]{padding:20px}"],data:{animation:[(0,e.hZ)("expand",[(0,e.kY)(":enter",[(0,e.K2)([(0,e.iF)({top:"100%"}),(0,e.i0)("250ms ease-in-out",(0,e.iF)({top:"*"}))])])])]},changeDetection:0})}return P})()},68008:(le,N,n)=>{"use strict";n.d(N,{N:()=>G});var e=n(54438),t=n(92014),s=n(49204),c=n(85052),O=n(2573),P=n(37925),S=n(74394),a=n(24418),f=n(28696),E=n(43194),y=n(30234),i=n(38645),g=n(60177);const p=["app-pill-button",""],h=["*"],o=k=>({"pill-button--selected":k});let v=(()=>{class k{constructor(){this.selected=!1}ngOnInit(){}static#e=this.\u0275fac=function(T){return new(T||k)};static#t=this.\u0275cmp=e.VBU({type:k,selectors:[["button","app-pill-button",""],["a","app-pill-button",""]],inputs:{selected:"selected"},attrs:p,ngContentSelectors:h,decls:2,vars:3,consts:[[1,"pill-button",3,"ngClass"]],template:function(T,x){1&T&&(e.NAR(),e.j41(0,"span",0),e.SdG(1),e.k0s()),2&T&&e.Y8G("ngClass",e.eq3(1,o,x.selected))},dependencies:[g.YU],styles:["[_nghost-%COMP%]{border-color:transparent;background:none;border-width:0;padding:0;margin:0;border-radius:4px;outline:0 none}[_nghost-%COMP%]:not([disabled]):hover{cursor:pointer}[_nghost-%COMP%]:focus   .pill-button[_ngcontent-%COMP%]{outline:#2d72dc solid 2px!important}[_nghost-%COMP%]:disabled   .pill-button[_ngcontent-%COMP%], [_nghost-%COMP%]:disabled:hover   .pill-button[_ngcontent-%COMP%]{background-color:#f9fafd;color:#96a8c0}.pill-button[_ngcontent-%COMP%]{font-size:.75rem;line-height:1rem;font-family:Inter,sans-serif;font-weight:500;color:#374a68;display:flex;align-items:center;justify-content:center;background-color:#eaeff5;border-radius:100px;padding:8px 16px;transition:background-color .12s,color .12s;width:100%}.pill-button[_ngcontent-%COMP%]:hover{background-color:#d7e0ea}.pill-button--selected[_ngcontent-%COMP%], .pill-button--selected[_ngcontent-%COMP%]:hover{background-color:#2d72dc;color:#fff}"],changeDetection:0})}return k})();var d=n(26779);function u(k,V){if(1&k){const W=e.RV6();e.j41(0,"li",9)(1,"button",10),e.nI1(2,"async"),e.bIt("click",function(){const x=e.eBV(W).$implicit,z=e.XpG().$implicit,I=e.XpG(2);return e.Njj(I.setTag(z.title,I.activeTags[z.title]===x?"":x))}),e.EFF(3),e.nI1(4,"titlecase"),e.k0s()()}if(2&k){let W;const T=V.$implicit,x=e.XpG().$implicit,z=e.XpG(2);e.R7$(),e.Y8G("disabled",!(null!=(W=e.bMT(2,3,z.availableTags$))&&W.includes(T)))("selected",z.activeTags[x.title]===T),e.R7$(2),e.SpI(" ",e.bMT(4,5,T)," ")}}function l(k,V){if(1&k&&(e.j41(0,"div",5)(1,"h2",6),e.EFF(2),e.k0s(),e.j41(3,"ul",7),e.DNE(4,u,5,7,"li",8),e.k0s()()),2&k){const W=V.$implicit;e.R7$(2),e.JRh(W.title),e.R7$(2),e.Y8G("ngForOf",W.tags)}}function m(k,V){if(1&k&&(e.j41(0,"div",3),e.DNE(1,l,5,2,"div",4),e.k0s()),2&k){const W=e.XpG();e.R7$(),e.Y8G("ngForOf",W.tagGroups)}}function C(k,V){if(1&k){const W=e.RV6();e.j41(0,"li",9)(1,"button",14),e.bIt("click",function(){e.eBV(W);const x=e.XpG(2).$implicit,z=e.XpG(2);return e.Njj(z.setTag(x.title,""))}),e.j41(2,"span",15),e.EFF(3),e.nI1(4,"titlecase"),e.k0s(),e.nrm(5,"app-icon",16),e.k0s()()}if(2&k){const W=e.XpG().$implicit;e.R7$(3),e.JRh(e.bMT(4,1,W))}}function b(k,V){if(1&k&&(e.qex(0),e.DNE(1,C,6,3,"li",13),e.bVm()),2&k){const W=V.$implicit,T=e.XpG().$implicit,x=e.XpG(2);e.R7$(),e.Y8G("ngIf",x.activeTags[T.title]===W)}}function R(k,V){if(1&k&&(e.qex(0),e.DNE(1,b,2,1,"ng-container",12),e.bVm()),2&k){const W=V.$implicit;e.R7$(),e.Y8G("ngForOf",W.tags)}}function A(k,V){if(1&k&&(e.j41(0,"ul",11),e.DNE(1,R,2,1,"ng-container",12),e.k0s()),2&k){const W=e.XpG();e.R7$(),e.Y8G("ngForOf",W.tagGroups)}}class G{get viewMode(){return this._viewMode}set viewMode(V){this._viewMode=V}get activeTags(){return this._activeTags}set activeTags(V){null==V&&(V={}),this._activeTags=V,this.activeTagList=Object.values(this.activeTags).reduce((W,T)=>(""!=T&&W.push(T),W),[]),this.changeDetectorRef.markForCheck()}constructor(V,W,T){this.changeDetectorRef=V,this.store=W,this.router=T,this.activeTagList=[],this.ngUnsubscribe=new c.B,this._viewMode="expanded",this.tagGroups=[],this._activeTags={},this.selectedTagChange=new e.bkB}ngOnInit(){this.store.select(E.Y.getActiveTags).pipe((0,P.Q)(this.ngUnsubscribe)).subscribe(V=>{this.activeTags=V}),this.initFilters()}isMyLibrary(){return this.router.url.includes("/results/bookmarks")}initFilters(){const V=a.c.native;this.tagGroups=[],V&&this.tagGroups.push(S.VM),this.isMyLibrary()?this.tagGroups.push(S.Ub):this.tagGroups=this.tagGroups.concat([S.oM,{...S.Ue,tags:(0,s.without)(S.Ue.tags,"Quiz",y.a.Zspace)}])}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}setTag(V,W){const T=this.store.selectSnapshot(E.Y.getActiveTags);T[V]=W,this.store.dispatch(new f.w.SetActiveTags(T))}static#e=this.\u0275fac=function(W){return new(W||G)(e.rXU(e.gRc),e.rXU(t.il),e.rXU(i.Ix))};static#t=this.\u0275cmp=e.VBU({type:G,selectors:[["app-gallery-filters"]],inputs:{viewMode:"viewMode"},outputs:{selectedTagChange:"selectedTagChange"},decls:3,vars:4,consts:[["data-test","galleryFilters",1,"gallery-filters"],["class","gallery-filters__expanded","data-test","galleryFiltersExpanded",4,"ngIf"],["class","gallery-filters__tags","data-test","galleryFiltersSummary",4,"ngIf"],["data-test","galleryFiltersExpanded",1,"gallery-filters__expanded"],["class","gallery-filters__group",4,"ngFor","ngForOf"],[1,"gallery-filters__group"],[1,"gallery-filters__header"],[1,"gallery-filters__tags"],["class","gallery-filters__tag",4,"ngFor","ngForOf"],[1,"gallery-filters__tag"],["app-pill-button","","data-test","galleryFiltersTag",3,"click","disabled","selected"],["data-test","galleryFiltersSummary",1,"gallery-filters__tags"],[4,"ngFor","ngForOf"],["class","gallery-filters__tag",4,"ngIf"],["app-pill-button","","data-test","galleryFiltersTag",3,"click"],[1,"mr-2"],["icon","times"]],template:function(W,T){1&W&&(e.j41(0,"div",0),e.DNE(1,m,2,1,"div",1)(2,A,2,1,"ul",2),e.k0s()),2&W&&(e.AVh("gallery-filters--multiple",T.tagGroups.length>1),e.R7$(),e.Y8G("ngIf","expanded"===T.viewMode),e.R7$(),e.Y8G("ngIf","summary"===T.viewMode))},dependencies:[v,g.Sq,g.bT,d.R,g.Jj,g.PV],styles:[".gallery-filters__expanded[_ngcontent-%COMP%]{display:flex;gap:32px}.gallery-filters__header[_ngcontent-%COMP%]{font-size:.875rem;line-height:1.25rem;font-weight:600;padding-bottom:8px}.gallery-filters__tag[_ngcontent-%COMP%]{display:inline-block;margin:0 12px 12px 0}@media (max-width: 540px){.gallery-filters__expanded[_ngcontent-%COMP%]{flex-direction:column;gap:0}.gallery-filters__group[_ngcontent-%COMP%]{padding:0 0 24px}}"],changeDetection:0})}!function(k,V,W,T){var I,x=arguments.length,z=x<3?V:null===T?T=Object.getOwnPropertyDescriptor(V,W):T;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)z=Reflect.decorate(k,V,W,T);else for(var D=k.length-1;D>=0;D--)(I=k[D])&&(z=(x<3?I(z):x>3?I(V,W,z):I(V,W))||z);x>3&&z&&Object.defineProperty(V,W,z)}([(0,t.l6)(E.Y.getAvailableTags),function(k,V){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata("design:type",V)}(0,O.c)],G.prototype,"availableTags$",void 0)},8377:(le,N,n)=>{"use strict";n.d(N,{l:()=>b});var e=n(60177),t=n(11818),s=n(89417),c=n(92014),O=n(43194),P=n(76549),S=n(89511),a=n(59162),f=n(78696),E=n(73845),y=n(21604),i=n(82765),g=n(45189),p=n(38645),h=n(81488),o=n(68008),v=n(96298),d=n(24184),r=n(13403),_=n(22346),u=n(54438),l=n(21007),m=n(25780),C=n(26779);let b=(()=>{class R{static#e=this.\u0275fac=function(k){return new(k||R)};static#t=this.\u0275mod=u.$C({type:R});static#n=this.\u0275inj=u.G2t({imports:[c.rK.forFeature([O.Y]),E.Un,p.iI,t.C,e.MD,s.X1,P.k,S.h,f.H,g.G,h.f,a.M,y.G,i.g7,d.C,r.j,_.K]})}return R})();u.wjB(v.Z,function(){return[l.Q,m.L,C.R,o.N]},[])},79898:(le,N,n)=>{"use strict";n.d(N,{g:()=>e});var e=function(t){return t[t.Select=0]="Select",t[t.Import=1]="Import",t[t.Explore=2]="Explore",t[t.Check=3]="Check",t}(e||{})},72192:(le,N,n)=>{"use strict";n.d(N,{A:()=>e});var e=function(t){return t[t.Query=0]="Query",t[t.Path=1]="Path",t}(e||{})},58841:(le,N,n)=>{"use strict";n.d(N,{P:()=>s,k:()=>c});var e=n(24418),t=n(27180),s=function(O){return O[O.Row=0]="Row",O[O.Card=1]="Card",O}(s||{});const c=e.c.application===t.c.Loft?s.Row:s.Card},72865:(le,N,n)=>{"use strict";n.d(N,{Ij:()=>S,O5:()=>f,S8:()=>O,Vf:()=>P,Wj:()=>s,Y0:()=>a,pf:()=>c,qS:()=>E});var e=n(30234),t=n(97948);const s=`/results/modules?categoryId=${e.a.Zspace}&type=Category`;class c{constructor(i,g=[],p=""){this.categoryId=i,this.tags=g,this.query=p,this.type=t.n.Category}}class O{constructor(i,g="",p=[]){this.organizationId=i,this.query=g,this.tags=p,this.type=t.n.Organization}}class P{constructor(i,g,p="",h=[]){this.organizationId=i,this.collectionId=g,this.query=p,this.tags=h,this.type=t.n.Collection}}class S{constructor(i="",g=[]){this.query=i,this.tags=g,this.categoryId="public",this.type=t.n.Community}}class a{constructor(i="",g=[]){this.query=i,this.tags=g,this.type=t.n.Private}}class f{constructor(i="",g="",p=[]){this.query=i,this.directory=g,this.tags=p,this.type=t.n.Internal}}class E{constructor(i,g="",p="",h=[]){this.primary=i,this.secondary=g,this.query=p,this.tags=h,this.type=t.n.Loft}}},54169:(le,N,n)=>{"use strict";n.d(N,{n:()=>e});class e{constructor(s="",c,O=25,P=0){this.query=s,this.sortBy=c,this.pageSize=O,this.offset=P}}},97948:(le,N,n)=>{"use strict";n.d(N,{n:()=>e});var e=function(t){return t.Organization="Organization",t.Collection="Collection",t.Private="Private",t.Category="Category",t.Community="Community",t.Internal="Internal",t.Loft="Loft",t}(e||{})},28696:(le,N,n)=>{"use strict";var e,t;n.d(N,{w:()=>e}),(t=e||(e={})).SetSearchMode=(()=>{class A{static#e=this.type="[Gallery] Set Search Mode";constructor(k){this.searchMode=k}}return A})(),t.SetViewMode=(()=>{class A{static#e=this.type="[Gallery] Set View Mode";constructor(k){this.viewMode=k}}return A})(),t.ShowFilters=(()=>{class A{static#e=this.type="[Gallery] Show Filters";constructor(k,V=!1){this.show=k,this.triggerDrawer=V}}return A})(),t.GetStudioOptions=(()=>{class A{static#e=this.type="[Gallery] Get Studio Options";constructor(k){this.organizationId=k}}return A})(),t.GetStudioOptionsSuccess=(()=>{class A{static#e=this.type="[Gallery] Get Studio Options Success";constructor(k){this.options=k}}return A})(),t.SearchLoft=(()=>{class A{static#e=this.type="[Gallery] Search Loft";constructor(k){this.config=k}}return A})(),t.SearchLoftSuccess=(()=>{class A{static#e=this.type="[Gallery] Search Loft Success";constructor(k){this.bookmarks=k}}return A})(),t.SetSearchConfig=(()=>{class A{static#e=this.type="[Gallery] Set Search Config";constructor(k,V){this.config=k,this.options=V}}return A})(),t.SetSearchOptions=(()=>{class A{static#e=this.type="[Gallery] Set Search Options";constructor(k){this.options=k}}return A})(),t.SetActiveTags=(()=>{class A{static#e=this.type="[Gallery] Set Active Tags";constructor(k){this.activeTags=k}}return A})(),t.SearchCategory=(()=>{class A{static#e=this.type="[Gallery] Search Category";constructor(k){this.categoryId=k}}return A})(),t.SearchStudio=(()=>{class A{static#e=this.type="[Gallery] Search Studio";constructor(){}}return A})(),t.SearchStudioSuccess=(()=>{class A{static#e=this.type="[Gallery] Search Studio Success";constructor(k){this.bookmarks=k}}return A})(),t.SearchSuccess=(()=>{class A{static#e=this.type="[Gallery] Search Success";constructor(k){this.bookmarks=k}}return A})(),t.SelectBookmark=(()=>{class A{static#e=this.type="[Gallery] Select Bookmark";constructor(k){this.result=k}}return A})(),t.SetSidenav=(()=>{class A{static#e=this.type="[Gallery] Set Sidenav";constructor(k){this.sidenav=k}}return A})(),t.SetBulkActions=(()=>{class A{static#e=this.type="[Gallery] Set Bulk Actions";constructor(k){this.bulkActions=k}}return A})(),t.SetCardActions=(()=>{class A{static#e=this.type="[Gallery] Set Card Actions";constructor(k){this.cardActions=k}}return A})(),t.ClearResults=(()=>{class A{static#e=this.type="[Gallery] Clear Results";constructor(){}}return A})(),t.CheckItem=(()=>{class A{static#e=this.type="[Gallery] Check Item";constructor(k,V){this.id=k,this.checked=V}}return A})(),t.CheckAll=(()=>{class A{static#e=this.type="[Gallery] Check All";constructor(){}}return A})(),t.UncheckAll=(()=>{class A{static#e=this.type="[Gallery] Uncheck All";constructor(){}}return A})(),t.SetCheckedItems=(()=>{class A{static#e=this.type="[Gallery] Set Checked Items";constructor(k){this.ids=k}}return A})(),t.Reset=(()=>{class A{static#e=this.type="[Gallery] Reset";constructor(){}}return A})()},50353:(le,N,n)=>{"use strict";n.d(N,{Bz:()=>e,S4:()=>s});class e{}class s{}},43194:(le,N,n)=>{"use strict";n.d(N,{Y:()=>ae});var e=n(92014),t=n(50353),s=n(72192),c=n(58841),O=n(28696),P=n(65459),S=n(2573),a=n(97978),f=n(36110),E=n(15152),y=n(66874),i=n(72760),g=n(55361),p=n(96728),h=n(97948),o=n(54169);class v{}var d=n(16823),r=n(17766),_=n(47987),u=n(76939),l=n(96298),m=n(54438);let C=(()=>{class q{constructor(j,M){this.overlay=j,this.store=M}openDrawer(){this.overlayRef||this._createOverlay();const j=new u.A8(l.Z);this.overlayRef.attach(j)}closeDrawer(){this.overlayRef.detach()}_createOverlay(){const j=new _.rR({hasBackdrop:!0,scrollStrategy:this.overlay.scrollStrategies.block()});this.overlayRef=this.overlay.create(j),this.overlayRef.backdropClick().subscribe(()=>{this.store.dispatch(new O.w.ShowFilters(!1,!0))})}static#e=this.\u0275fac=function(M){return new(M||q)(m.KVO(_.hJ),m.KVO(e.il))};static#t=this.\u0275prov=m.jDH({token:q,factory:q.\u0275fac,providedIn:"root"})}return q})();var b=n(74394),R=n(49204),A=n(72865),G=n(24418),k=n(6795),V=n(59e3),W=n(7213),T=n(21424),x=n(52394),z=n(30234),I=function(q,K,j,M){var re,$=arguments.length,ce=$<3?K:null===M?M=Object.getOwnPropertyDescriptor(K,j):M;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)ce=Reflect.decorate(q,K,j,M);else for(var ue=q.length-1;ue>=0;ue--)(re=q[ue])&&(ce=($<3?re(ce):$>3?re(K,j,ce):re(K,j))||ce);return $>3&&ce&&Object.defineProperty(K,j,ce),ce},D=function(q,K){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(q,K)};const L=[h.n.Organization,h.n.Collection],Q=[...L,h.n.Category],ie={[x.c.Private]:"My Models",[x.c.TeamEdit]:"View & Edit",[x.c.TeamView]:"View Only"},se=Object.fromEntries(Object.entries(ie).map(([q,K])=>[K,q])),Z={loading:!0,searchMode:s.A.Query,viewMode:c.k,showFilters:!1,searchResults:{total:0,items:[]},checkedResults:[],searchConfig:null,searchOptions:{offset:0,pageSize:0,sortBy:{ascending:!0,fields:[],label:""},query:""},sidenav:{enabled:!0,open:!0,disableClose:!1},bulkActions:{enabled:!0,active:!1,items:[]},cardActions:{enabled:!0}},de=[...b.Ht.tags,...b.a.tags,...b.oM.tags,...b.Ue.tags,...b.iE.tags];let ae=class Es{static getLoading(K){return K.loading}static getSearchMode(K){return K.searchMode}static getSearchConfig(K){return K.searchConfig}static getSearchOptions(K){return K.searchOptions}static getSearchResults(K){return K.searchResults}static getHasFilters(K){return Q.includes(K?.type)||!0===G.c.native}static getAvailableTags(K,j){const M=new Set,$=K.items,ce=G.c.native?k.s.getOfflineModelIDList():[];return L.includes(j?.type)?(0,W.h_)($).forEach(H=>{M.add(ie[H])}):$.forEach(ue=>{ue.tags.forEach(H=>{"quiz"===H&&(H="Quiz"),de.includes(H)&&M.add(H)}),G.c.native&&ce.includes(ue.id)&&M.add("Downloaded")}),Array.from(M)}static getActiveTags(K){const j={};return(K?.tags??[]).forEach($=>{const ce=b.Pg.find(re=>re.tags.some(ue=>ue===$));ce&&(j[ce?.title??""]=$)}),j}static getActiveTagsCount(K){return(0,R.compact)(K?.tags??[]).length}static getSearchType(K){return K?.type??null}static getSearchGroup(K){switch(K){case h.n.Category:case h.n.Community:case h.n.Internal:case h.n.Loft:return r.c.Module;case h.n.Collection:case h.n.Private:case h.n.Organization:return r.c.Bookmark}}static getViewMode(K){return K.viewMode}static getShowFilters(K){return K.showFilters}static getSort(K){return K.searchOptions?.sortBy}static getSortOptions(K){switch(K){case h.n.Loft:return[p.MQ,p.iU];case h.n.Category:return[p.Ir,p._z,p.MQ,p.iU];default:return[p._z,p.MQ,p.iU,p.He,p.ZZ]}}static getSidenav(K){return K.sidenav}static getBulkActions(K){return K.bulkActions}static getBulkActionsAvailable(K){const{enabled:j,items:M}=K;return j&&M.length>0}static getBulkActionsActive(K){return K.active}static getCardActions(K){return K.cardActions}static getFilteredResults(K,j,M){if((0,R.isNil)(j)||(0,R.isNil)(M)||(0,R.isNil)(K))return{total:0,items:[]};let $=[...K.items];if(null!==j){const{ascending:ce,fields:re}=j.sortBy,{offset:ue,pageSize:H}=j;$=(0,g.h5)(K.items,re,ce),$=(0,g.EL)(j,M,$),$=$.slice(ue,ue+H)}return{total:K.total,items:$}}static getAllResults(K,j,M){const{ascending:$,fields:ce}=j.sortBy;let re=(0,g.h5)(K.items,ce,$);return re=(0,g.EL)(j,M,re),{total:K.total,items:re}}static getCheckedResults(K){return K.checkedResults}static isZSpaceSearch(K){return K?.type===h.n.Category&&K?.categoryId===z.a.Zspace}setSearchMode(K,j){K.patchState({searchMode:j.searchMode})}setViewMode(K,j){K.patchState({viewMode:j.viewMode})}showFilters(K,j){K.patchState({showFilters:j.show}),j.triggerDrawer&&(j.show?this.galleryService.openDrawer():this.galleryService.closeDrawer())}setSearchOptions(K,j){K.patchState({searchOptions:{...j.options}})}setActiveTags(K,j){const $={...K.getState().searchConfig,tags:(0,R.flatten)(Object.values(j.activeTags))};this.store.dispatch(new O.w.SetSearchConfig($))}setSearchConfig(K,j){const M=j.config||K.getState().searchConfig,$=j.options||K.getState().searchOptions;null!==M&&K.patchState({searchOptions:{...$},searchConfig:{...M}})}searchCategory(K,{categoryId:j}){const M="public"===j?new A.Ij(""):new A.pf(j);K.dispatch(new O.w.SetSearchConfig(M))}searchStudio(K,j){const{searchConfig:M,searchOptions:$}=K.getState(),ce=new o.n("",p.MQ),re=this.store.selectSnapshot(d.k.getUserLanguage),ue=this.store.selectSnapshot(T.q.isZSpaceAccount);K.patchState({loading:!0,searchOptions:{...$,pageSize:ce.pageSize,offset:ce.offset},checkedResults:[]});let H=new S.c;switch(M.type){case h.n.Category:H=this.exploreService.getAnatomyCategory(M.query,"all"===M.categoryId?"":M.categoryId,M.tags.filter(w=>!w.startsWith("Downloaded")),ue,re);break;case h.n.Organization:H=this.bookmarksService.getOrganizationContent(M.organizationId,M.query,re);break;case h.n.Collection:H=this.organizationsService.getCollectionContent(M.organizationId,M.collectionId,M.query,re);break;case h.n.Community:H=this.bookmarksService.getPublicBookmarks(M.query,re);break;case h.n.Private:H=this.bookmarksService.getPrivateContent(M.query,re);break;case h.n.Internal:H=this.exploreService.searchInternal(M.query,M.directory);break;case h.n.Loft:const F=M.query.indexOf(".json")>0;H=this.modulesService.listContents(M.primary,M.secondary,F?M.query:"",!0).pipe((0,f.T)(w=>F?w:w.filter(X=>X.title.indexOf(M.query)>=0)))}const te=M.tags.reduce((F,w)=>{const X=se[w];return X&&F.push(X),F},[]);H.pipe((0,f.T)(F=>te.length>0?(0,W.Lo)(F,te):F),(0,E.j)(()=>K.patchState({loading:!1}))).subscribe(F=>{const w=G.c.native?k.s.getOfflineModelIDList():[],X=M.tags.includes("Downloaded")?F.filter(oe=>w.includes(oe.id)):F;K.dispatch(new O.w.SearchSuccess(X))})}searchSuccess(K,j){K.patchState({searchResults:{items:j.bookmarks,total:j.bookmarks.length}});const M=K.getState().searchConfig,$=j.bookmarks.length>0?"Search - With Results":"Search - No Results",ce={...M,tags:M.tags.filter(re=>""!==re).join(", ")};this.vendorAnalyticsService.track($,ce)}checkItem(K,j){let M=K.getState().checkedResults;const $=M.some(ce=>ce===j.id);j.checked&&!$?M=[...M,j.id]:j.checked||(M=M.filter(ce=>ce!==j.id)),K.patchState({checkedResults:M})}checkAll(K,j){const M=K.getState().searchResults.items.map($=>$.id);K.patchState({checkedResults:M})}uncheckAll(K,j){K.patchState({checkedResults:[]})}setCheckedItems(K,j){K.patchState({checkedResults:j.ids})}setSidenav(K,j){K.patchState({sidenav:{...j.sidenav}})}setCardActions(K,j){K.patchState({cardActions:{...j.cardActions}})}setBulkActions(K,j){const{bulkActions:M}=K.getState();K.patchState({bulkActions:{...M,...j.bulkActions}})}clearResults(K,j){K.patchState({searchResults:{items:[],total:0}})}resetGallery(K,j){K.patchState(Z)}constructor(K,j,M,$,ce,re,ue){this.organizationsService=K,this.modulesService=j,this.exploreService=M,this.bookmarksService=$,this.galleryService=ce,this.store=re,this.vendorAnalyticsService=ue}static#e=this.\u0275fac=function(j){return new(j||Es)(m.KVO(P.k),m.KVO(a.F),m.KVO(y.z),m.KVO(i.x),m.KVO(C),m.KVO(e.il),m.KVO(V.e))};static#t=this.\u0275prov=m.jDH({token:Es,factory:Es.\u0275fac})};I([(0,e.rc)(O.w.SetSearchMode),D("design:type",Function),D("design:paramtypes",[Object,O.w.SetSearchMode]),D("design:returntype",void 0)],ae.prototype,"setSearchMode",null),I([(0,e.rc)(O.w.SetViewMode),D("design:type",Function),D("design:paramtypes",[Object,O.w.SetViewMode]),D("design:returntype",void 0)],ae.prototype,"setViewMode",null),I([(0,e.rc)(O.w.ShowFilters),D("design:type",Function),D("design:paramtypes",[Object,O.w.ShowFilters]),D("design:returntype",void 0)],ae.prototype,"showFilters",null),I([(0,e.rc)(O.w.SetSearchOptions),D("design:type",Function),D("design:paramtypes",[Object,O.w.SetSearchOptions]),D("design:returntype",void 0)],ae.prototype,"setSearchOptions",null),I([(0,e.rc)(O.w.SetActiveTags),D("design:type",Function),D("design:paramtypes",[Object,O.w.SetActiveTags]),D("design:returntype",void 0)],ae.prototype,"setActiveTags",null),I([(0,e.rc)(O.w.SetSearchConfig),D("design:type",Function),D("design:paramtypes",[Object,O.w.SetSearchConfig]),D("design:returntype",void 0)],ae.prototype,"setSearchConfig",null),I([(0,e.rc)(O.w.SearchCategory),D("design:type",Function),D("design:paramtypes",[Object,O.w.SearchCategory]),D("design:returntype",void 0)],ae.prototype,"searchCategory",null),I([(0,e.rc)(O.w.SearchStudio),D("design:type",Function),D("design:paramtypes",[Object,O.w.SearchStudio]),D("design:returntype",void 0)],ae.prototype,"searchStudio",null),I([(0,e.rc)(O.w.SearchSuccess),D("design:type",Function),D("design:paramtypes",[Object,O.w.SearchSuccess]),D("design:returntype",void 0)],ae.prototype,"searchSuccess",null),I([(0,e.rc)(O.w.CheckItem),D("design:type",Function),D("design:paramtypes",[Object,O.w.CheckItem]),D("design:returntype",void 0)],ae.prototype,"checkItem",null),I([(0,e.rc)(O.w.CheckAll),D("design:type",Function),D("design:paramtypes",[Object,O.w.CheckAll]),D("design:returntype",void 0)],ae.prototype,"checkAll",null),I([(0,e.rc)(O.w.UncheckAll),D("design:type",Function),D("design:paramtypes",[Object,O.w.UncheckAll]),D("design:returntype",void 0)],ae.prototype,"uncheckAll",null),I([(0,e.rc)(O.w.SetCheckedItems),D("design:type",Function),D("design:paramtypes",[Object,O.w.SetCheckedItems]),D("design:returntype",void 0)],ae.prototype,"setCheckedItems",null),I([(0,e.rc)(O.w.SetSidenav),D("design:type",Function),D("design:paramtypes",[Object,O.w.SetSidenav]),D("design:returntype",void 0)],ae.prototype,"setSidenav",null),I([(0,e.rc)(O.w.SetCardActions),D("design:type",Function),D("design:paramtypes",[Object,O.w.SetCardActions]),D("design:returntype",void 0)],ae.prototype,"setCardActions",null),I([(0,e.rc)(O.w.SetBulkActions),D("design:type",Function),D("design:paramtypes",[Object,O.w.SetBulkActions]),D("design:returntype",void 0)],ae.prototype,"setBulkActions",null),I([(0,e.rc)(O.w.ClearResults),D("design:type",Function),D("design:paramtypes",[Object,O.w.ClearResults]),D("design:returntype",void 0)],ae.prototype,"clearResults",null),I([(0,e.rc)(O.w.Reset),D("design:type",Function),D("design:paramtypes",[Object,O.w.Reset]),D("design:returntype",void 0)],ae.prototype,"resetGallery",null),I([(0,e.MD)(),D("design:type",Function),D("design:paramtypes",[t.Bz]),D("design:returntype",void 0)],ae,"getLoading",null),I([(0,e.MD)(),D("design:type",Function),D("design:paramtypes",[t.Bz]),D("design:returntype",void 0)],ae,"getSearchMode",null),I([(0,e.MD)(),D("design:type",Function),D("design:paramtypes",[t.Bz]),D("design:returntype",void 0)],ae,"getSearchConfig",null),I([(0,e.MD)(),D("design:type",Function),D("design:paramtypes",[t.Bz]),D("design:returntype",void 0)],ae,"getSearchOptions",null),I([(0,e.MD)(),D("design:type",Function),D("design:paramtypes",[t.Bz]),D("design:returntype",void 0)],ae,"getSearchResults",null),I([(0,e.MD)([ae.getSearchConfig]),D("design:type",Function),D("design:paramtypes",[Object]),D("design:returntype",void 0)],ae,"getHasFilters",null),I([(0,e.MD)([ae.getSearchResults,ae.getSearchConfig]),D("design:type",Function),D("design:paramtypes",[v,Object]),D("design:returntype",void 0)],ae,"getAvailableTags",null),I([(0,e.MD)([ae.getSearchConfig]),D("design:type",Function),D("design:paramtypes",[Object]),D("design:returntype",void 0)],ae,"getActiveTags",null),I([(0,e.MD)([ae.getSearchConfig]),D("design:type",Function),D("design:paramtypes",[Object]),D("design:returntype",void 0)],ae,"getActiveTagsCount",null),I([(0,e.MD)([ae.getSearchConfig]),D("design:type",Function),D("design:paramtypes",[Object]),D("design:returntype",void 0)],ae,"getSearchType",null),I([(0,e.MD)([ae.getSearchType]),D("design:type",Function),D("design:paramtypes",[String]),D("design:returntype",void 0)],ae,"getSearchGroup",null),I([(0,e.MD)(),D("design:type",Function),D("design:paramtypes",[t.Bz]),D("design:returntype",void 0)],ae,"getViewMode",null),I([(0,e.MD)(),D("design:type",Function),D("design:paramtypes",[t.Bz]),D("design:returntype",void 0)],ae,"getShowFilters",null),I([(0,e.MD)(),D("design:type",Function),D("design:paramtypes",[t.Bz]),D("design:returntype",void 0)],ae,"getSort",null),I([(0,e.MD)([ae.getSearchType]),D("design:type",Function),D("design:paramtypes",[String]),D("design:returntype",void 0)],ae,"getSortOptions",null),I([(0,e.MD)(),D("design:type",Function),D("design:paramtypes",[t.Bz]),D("design:returntype",void 0)],ae,"getSidenav",null),I([(0,e.MD)(),D("design:type",Function),D("design:paramtypes",[t.Bz]),D("design:returntype",void 0)],ae,"getBulkActions",null),I([(0,e.MD)([ae.getBulkActions]),D("design:type",Function),D("design:paramtypes",[t.S4]),D("design:returntype",void 0)],ae,"getBulkActionsAvailable",null),I([(0,e.MD)([ae.getBulkActions]),D("design:type",Function),D("design:paramtypes",[t.S4]),D("design:returntype",Boolean)],ae,"getBulkActionsActive",null),I([(0,e.MD)(),D("design:type",Function),D("design:paramtypes",[t.Bz]),D("design:returntype",void 0)],ae,"getCardActions",null),I([(0,e.MD)([ae.getSearchResults,ae.getSearchOptions,ae.getSearchConfig]),D("design:type",Function),D("design:paramtypes",[v,o.n,Object]),D("design:returntype",v)],ae,"getFilteredResults",null),I([(0,e.MD)([ae.getSearchResults,ae.getSearchOptions,ae.getSearchConfig]),D("design:type",Function),D("design:paramtypes",[v,o.n,Object]),D("design:returntype",v)],ae,"getAllResults",null),I([(0,e.MD)(),D("design:type",Function),D("design:paramtypes",[t.Bz]),D("design:returntype",void 0)],ae,"getCheckedResults",null),I([(0,e.MD)([ae.getSearchConfig]),D("design:type",Function),D("design:paramtypes",[Object]),D("design:returntype",void 0)],ae,"isZSpaceSearch",null),ae=I([(0,e.Uw)({name:"gallery",defaults:Z}),D("design:paramtypes",[P.k,a.F,y.z,i.x,C,e.il,V.e])],ae)},21770:(le,N,n)=>{"use strict";n.d(N,{U_:()=>a});var e=n(49204),s=n(2573),c=n(14264),O=n(32914);function a(f){return function S(f){return new s.c(E=>{const y=new Image;y.onload=()=>{const i=function P(f){const E=document.createElement("canvas"),y=E.getContext("2d");return E.width=f.naturalWidth,E.height=f.naturalHeight,y.drawImage(f,0,0),E}(y);E.next(i),E.complete()},y.onerror=()=>{const i=document.createElement("canvas");E.next(i),E.complete()},y.src=f})}(f).pipe((0,c.p)(E=>!(0,e.isNil)(E)),(0,O.n)(E=>new s.c(y=>{E.toBlob(i=>{y.next(i),y.complete()},"image/jpeg",100)})))}},1580:(le,N,n)=>{"use strict";n.d(N,{M:()=>i});var e=n(49204),s=n(46104),c=n(15877),O=n(2573),P=n(32914),S=n(36110),a=n(89612),f=n(21770),E=n(54438),y=n(21626);let i=(()=>{class g{constructor(h){this.http=h}generateFreshChapterImages(h,o,v=!1){const d=[];return h.forEach(r=>{const _=a.V.getChapterThumbnail(r,o);(_.legacy||v)&&d.push(a.V.makeFreshThumbnail(_.storyId,_.chapterId,_.urls.large))}),d.length?(0,s.p)(d):(0,c.of)([])}saveChapterThumbnails(h,o,v){return h.reduce((r,_)=>{const m=o.get(v[_.id]),C=(0,e.get)(m,"snapshot");return C&&r.push(this.saveNewChapterImage(_.id,C)),r},[])}saveNewChapterImage(h,o){return new O.c(v=>{(0,f.U_)(o).pipe((0,P.n)(d=>this.saveImageBlob(d)),(0,S.T)(d=>({chapterId:h,...d}))).subscribe(d=>{v.next(d),v.complete()},()=>{v.next(null),v.complete()})})}getIndexThumbnail(h,o="large"){return`${typeof localBaseDirectory>"u"?"":localBaseDirectory}thumbs/modules/${h}/${o}/index.jpg`}saveImageBlob(h){const v=new File([h],"image.jpg",{type:"image/jpeg"}),d=new FormData;return d.append("file",v),this.http.post("/ws/media/images/upload",d)}static#e=this.\u0275fac=function(o){return new(o||g)(E.KVO(y.Qq))};static#t=this.\u0275prov=E.jDH({token:g,factory:g.\u0275fac,providedIn:"root"})}return g})()},28107:(le,N,n)=>{"use strict";n.d(N,{R:()=>h});var e=n(60177),t=n(38645),s=n(92014),c=n(32408),O=n(45189),P=n(21604),S=n(56400),a=n(89417),f=n(81488),E=n(76549),y=n(8377),i=n(91060),g=n(62497),p=n(54438);let h=(()=>{class o{static#e=this.\u0275fac=function(r){return new(r||o)};static#t=this.\u0275mod=p.$C({type:o});static#n=this.\u0275inj=p.G2t({imports:[P.G,O.G,e.MD,t.iI,f.f,S.P,a.X1,E.k,y.l,i.w,g.N,s.rK.forFeature([c.W])]})}return o})()},67271:(le,N,n)=>{"use strict";n.d(N,{Z:()=>e});var e=function(t){return t.Light="theme-light",t.Dark="theme-dark",t}(e||{})},7277:(le,N,n)=>{"use strict";n.d(N,{v:()=>e});var e=function(t){return t[t.Mobile=0]="Mobile",t[t.None=1]="None",t}(e||{})},22083:(le,N,n)=>{"use strict";n.d(N,{D:()=>e});var e=function(t){return t[t.Application=0]="Application",t[t.Search=1]="Search",t[t.View=2]="View",t[t.Hide=3]="Hide",t[t.Share=4]="Share",t[t.Logo=5]="Logo",t}(e||{})},15810:(le,N,n)=>{"use strict";var e,t;n.d(N,{G:()=>e}),(t=e||(e={})).SetTheme=(()=>{class y{static#e=this.type="[Layout] Set Theme";constructor(g){this.theme=g}}return y})(),t.SetSidenav=(()=>{class y{static#e=this.type="[Layout] Set Sidenav";constructor(g){this.sidenav=g}}return y})(),t.ToggleSidenav=(()=>{class y{static#e=this.type="[Layout] Toggle Sidenav";constructor(g){this.open=g}}return y})(),t.SetHeader=(()=>{class y{static#e=this.type="[Layout] Set Header";constructor(g){this.siteHeaderType=g}}return y})(),t.SetFooter=(()=>{class y{static#e=this.type="[Layout] Set Footer";constructor(g){this.siteFooterType=g}}return y})(),t.SetHeaderHeight=(()=>{class y{static#e=this.type="[Layout] Set Header Height";constructor(g){this.height=g}}return y})(),t.SetFooterHeight=(()=>{class y{static#e=this.type="[Layout] Set Footer Height";constructor(g){this.height=g}}return y})(),t.ResetLayout=(()=>{class y{static#e=this.type="[Layout] Reset";constructor(){}}return y})()},32408:(le,N,n)=>{"use strict";n.d(N,{W:()=>i});var e=n(92014),t=n(15810);class s{}var O=n(67271),P=n(22083),S=n(7277),a=n(54438),f=function(g,p,h,o){var r,v=arguments.length,d=v<3?p:null===o?o=Object.getOwnPropertyDescriptor(p,h):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)d=Reflect.decorate(g,p,h,o);else for(var _=g.length-1;_>=0;_--)(r=g[_])&&(d=(v<3?r(d):v>3?r(p,h,d):r(p,h))||d);return v>3&&d&&Object.defineProperty(p,h,d),d},E=function(g,p){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(g,p)};const y={theme:O.Z.Light,sidenav:{enabled:!0,open:!1},siteHeader:P.D.Application,siteFooter:S.v.None,siteHeaderHeight:56,siteFooterHeight:56};let i=class Cs{static getTheme(p){return p.theme}static getSidenav(p){return p.sidenav}static getSiteHeader(p){return p.siteHeader}static getSiteHeaderHeight(p){return p.siteHeaderHeight}static getSiteFooter(p){return p.siteFooter}static getSiteFooterHeight(p){return p.siteFooterHeight}setTheme({patchState:p},{theme:h}){p({theme:h})}setHeader(p,h){p.patchState({siteHeader:h.siteHeaderType})}setFooter(p,h){p.patchState({siteFooter:h.siteFooterType})}setHeaderHeight(p,h){p.patchState({siteHeaderHeight:h.height})}setFooterHeight(p,h){p.patchState({siteFooterHeight:h.height})}setSidenav(p,h){p.patchState({sidenav:{...h.sidenav}})}toggleSidenav(p,h){const o=p.getState().sidenav;p.patchState({sidenav:{...o,open:h.open}})}resetLayout(p,h){p.setState(y)}static#e=this.\u0275fac=function(h){return new(h||Cs)};static#t=this.\u0275prov=a.jDH({token:Cs,factory:Cs.\u0275fac})};f([(0,e.rc)(t.G.SetTheme),E("design:type",Function),E("design:paramtypes",[Object,t.G.SetTheme]),E("design:returntype",void 0)],i.prototype,"setTheme",null),f([(0,e.rc)(t.G.SetHeader),E("design:type",Function),E("design:paramtypes",[Object,t.G.SetHeader]),E("design:returntype",void 0)],i.prototype,"setHeader",null),f([(0,e.rc)(t.G.SetFooter),E("design:type",Function),E("design:paramtypes",[Object,t.G.SetFooter]),E("design:returntype",void 0)],i.prototype,"setFooter",null),f([(0,e.rc)(t.G.SetHeaderHeight),E("design:type",Function),E("design:paramtypes",[Object,t.G.SetHeaderHeight]),E("design:returntype",void 0)],i.prototype,"setHeaderHeight",null),f([(0,e.rc)(t.G.SetFooterHeight),E("design:type",Function),E("design:paramtypes",[Object,t.G.SetFooterHeight]),E("design:returntype",void 0)],i.prototype,"setFooterHeight",null),f([(0,e.rc)(t.G.SetSidenav),E("design:type",Function),E("design:paramtypes",[Object,t.G.SetSidenav]),E("design:returntype",void 0)],i.prototype,"setSidenav",null),f([(0,e.rc)(t.G.ToggleSidenav),E("design:type",Function),E("design:paramtypes",[Object,t.G.ToggleSidenav]),E("design:returntype",void 0)],i.prototype,"toggleSidenav",null),f([(0,e.rc)(t.G.ResetLayout),E("design:type",Function),E("design:paramtypes",[Object,t.G.ResetLayout]),E("design:returntype",void 0)],i.prototype,"resetLayout",null),f([(0,e.MD)(),E("design:type",Function),E("design:paramtypes",[s]),E("design:returntype",void 0)],i,"getTheme",null),f([(0,e.MD)(),E("design:type",Function),E("design:paramtypes",[s]),E("design:returntype",void 0)],i,"getSidenav",null),f([(0,e.MD)(),E("design:type",Function),E("design:paramtypes",[s]),E("design:returntype",void 0)],i,"getSiteHeader",null),f([(0,e.MD)(),E("design:type",Function),E("design:paramtypes",[s]),E("design:returntype",void 0)],i,"getSiteHeaderHeight",null),f([(0,e.MD)(),E("design:type",Function),E("design:paramtypes",[s]),E("design:returntype",void 0)],i,"getSiteFooter",null),f([(0,e.MD)(),E("design:type",Function),E("design:paramtypes",[s]),E("design:returntype",void 0)],i,"getSiteFooterHeight",null),i=f([(0,e.Uw)({name:"layout",defaults:y})],i)},56400:(le,N,n)=>{"use strict";n.d(N,{P:()=>p});var e=n(54438),t=n(60177),s=n(37522),c=n(29512),O=n(57078),P=n(50583),S=n(83649),a=n(43649),f=n(98138),E=n(21626),y=n(11040),i=n(4158);[s.A,c.A,O.A,P.A,S.A,a.A,f.A].forEach(h=>{(0,t.EO)(h)});let p=(()=>{class h{static forRoot(){return{ngModule:h,providers:[{provide:e.xe9,useFactory:y.kF},{provide:e.hnV,useFactory:i.vM,deps:[E.Qq,e.xe9],multi:!0}]}}static#e=this.\u0275fac=function(d){return new(d||h)};static#t=this.\u0275mod=e.$C({type:h});static#n=this.\u0275inj=e.G2t({imports:[t.MD]})}return h})()},5393:(le,N,n)=>{"use strict";n.d(N,{E:()=>S});var e=n(28407),t=n(11040);const s=0,c={eng:"en",spa:"es",cmn:"zh",fra:"fr",deu:"de",ita:"it",jpn:"ja",por:"pt"},O=Object.keys(c);function S(f){return a.apply(this,arguments)}function a(){return(a=(0,e.A)(function*(f){return n.e(17).then(n.bind(n,16017)).then(E=>function P(f,E){const y=f.franc(E,{minLength:s,only:O}),i=c[y];return t.IB.find(p=>p.lang===i)?.id}(E,f))})).apply(this,arguments)}},4158:(le,N,n)=>{"use strict";n.d(N,{KS:()=>y,vM:()=>i});var e=n(15877),t=n(28577),s=n(46104),c=n(32914),O=n(35801),P=n(49204),a=n(11040);const f={"en-US":!0,"en-GB":!0,"es-ES":!0,"es-MX":!0,"fr-FR":!0,"it-IT":!0,"pt-PT":!0,"pt-BR":!0,"he-IL":!0,"de-DE":!1,"zh-CN":!1,"cmn-CN":!1,ja:!1,"ja-JP":!1};function E(g,p){const h=a.WF[p]??p;return f[h]??1?g.get(`assets/locales/${h}.json`).pipe((0,t.W)(()=>(0,e.of)(void 0))):(0,e.of)(void 0)}function y(g,p){const h=p.map(o=>E(g,o));return h.length>0?(0,s.p)(h):(0,e.of)([])}function i(g,p){return()=>{if(p===a.q.id)return(0,e.of)({});const h=a.WF[p]??p;return E(g,p).pipe((0,c.n)(o=>{const v=o?.translations;return(0,P.isNil)(v)?console.warn(`Translations not found for locale: ${h}`):(0,O.Zi)(v),(0,e.of)(o)}))}}},11040:(le,N,n)=>{"use strict";n.d(N,{A8:()=>S,IB:()=>P,N9:()=>O,NS:()=>a,U1:()=>f,WF:()=>s,kF:()=>i,q:()=>c});var e=n(24418),t=n(27180);const s={ja:"ja-JP","pt-PT":"pt-BR"},c={title:"English",lang:"en",country:"us",id:"en-US",direction:"ltr",applications:[t.c.All]},O=[c,{title:"Espa\xf1ol",lang:"es",country:"es",id:"es-ES",direction:"ltr",applications:[t.c.All]},{title:"\u4e2d\u6587(\u7b80\u4f53)",lang:"zh",country:"cn",id:"zh-CN",direction:"ltr",applications:[t.c.All]},{title:"Fran\xe7ais",lang:"fr",country:"fr",id:"fr-FR",direction:"ltr",applications:[t.c.All]},{title:"Deutsch",lang:"de",country:"de",id:"de-DE",direction:"ltr",applications:[t.c.All]},{title:"Italiano",lang:"it",country:"it",id:"it-IT",direction:"ltr",applications:[t.c.All]},{title:"\u65e5\u672c\u8a9e",lang:"ja",country:"ja",id:"ja",direction:"ltr",applications:[t.c.All]},{title:"Portugu\xeas",lang:"pt",country:"pt",id:"pt-PT",direction:"ltr",applications:[t.c.All]},{title:"\u05e2\u05b4\u05d1\u05e8\u05b4\u05d9\u05ea",lang:"he",country:"il",id:"he-IL",direction:"rtl",applications:[t.c.Viewer]}],P=O.filter(g=>g.applications.includes(t.c.All)||g.applications.includes(e.c.application)),S={en:"englishLocaleButton",es:"spanishLocaleButton",zh:"chineseLocaleButton",fr:"frenchLocaleButton",de:"germanLocaleButton",it:"italianLocaleButton",ja:"japaneseLocaleButton",pt:"portugueseLocaleButton",he:"hebrewLocaleButton"};function a(g){return P.find(p=>p.id===g)}function f(g){return P.find(p=>p.lang===g)}function i(){return(e.c.application===t.c.Viewer?function y(){return f(new URLSearchParams(window.location.search).get("lang"))??c}():function E(){let g="";try{g=localStorage.getItem("locale")}catch{}return a(g)||c}()).id}},1314:(le,N,n)=>{"use strict";n.d(N,{U_:()=>a,cb:()=>O});var e=n(60177),t=n(40832),s=n(35286),c=n(54438);const O=["strong","sub","sup"];function P(){const f=new t.A4;return f.link=(E,y,i)=>`<a href="${function S(f){return f.match(/^(?:(?:(?:ht)tps?):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i)?f:""}(E)}" target="_blank" rel="noreferrer nofollow">${i}</a>`,f.paragraph=E=>`<p>${E}</p>`,f.image=(E,y,i)=>"",{renderer:f,gfm:!1}}let a=(()=>{class f{static#e=this.\u0275fac=function(i){return new(i||f)};static#t=this.\u0275mod=c.$C({type:f});static#n=this.\u0275inj=c.G2t({imports:[e.MD,s.y2.forRoot({markedOptions:{provide:s.GY,useFactory:P}})]})}return f})()},45189:(le,N,n)=>{"use strict";n.d(N,{G:()=>G});var e=n(45887),t=n(64109),s=n(82765),c=n(86600),O=n(88834),P=n(5951),S=n(82798),a=n(59115),f=n(55911),E=n(65571),y=n(34006),i=n(14823),g=n(95416),p=n(71997),h=n(90882),o=n(67575),r=(n(28931),n(65478)),_=n(81391),u=n(47987),l=n(76939),m=n(30450),C=n(54438);const b={disabled:!0,animation:{enterDuration:0,exitDuration:0}},R={...(0,i.zi)(),touchGestures:"off",disableTooltipInteractivity:!0},A={overlayPanelClass:"bd-select-panel"};let G=(()=>{class k{static#e=this.\u0275fac=function(T){return new(T||k)};static#t=this.\u0275mod=C.$C({type:k});static#n=this.\u0275inj=C.G2t({providers:[{provide:g.x6,useValue:{duration:3e3}},{provide:c.$E,useValue:b},{provide:i.sM,useValue:R},{provide:S.JO,useValue:A}],imports:[_.ad,e.N0,s.g7,s.g7,O.Hl,P.Wk,S.Ve,a.Cn,f.s5,E.Vg,y.hM,i.uc,g._T,p.w,h.vg,r.E9,u.z_,l.jc,m.mV,_.ad,e.N0,t.Dc,s.g7,s.g7,O.Hl,P.Wk,S.Ve,a.Cn,f.s5,E.Vg,y.hM,i.uc,g._T,p.w,h.vg,r.E9,u.z_,l.jc,m.mV,o.PO]})}return k})()},95419:(le,N,n)=>{"use strict";n.d(N,{u:()=>V});var e=n(28407),t=n(97953),s=n(49204),c=n(85052),O=n(14264),P=n(37925);class S{get currentPlayer(){return this.players[this.index]}constructor(T){this.players=T,this.index=0,this.isPlaying=!1,this.eventSubject=new c.B,this.ngUnsubscribe=new c.B,this.loadState="unloaded",this.totalDuration=0,this.init()}state(){return this.loadState}duration(){return this.totalDuration}play(){this.currentPlayer&&this.currentPlayer.play()}pause(){this.currentPlayer&&this.currentPlayer.pause()}stop(){this.currentPlayer&&this.currentPlayer.stop(),this.index=0}seek(T){if(this.currentPlayer)return this.currentPlayer.seek(T)}rate(T){if(this.currentPlayer)return this.currentPlayer.rate(T)}mute(T){if(this.currentPlayer){if((0,s.isNil)(T))return this.currentPlayer.mute();this.currentPlayer.mute(T)}}playing(){return!!this.currentPlayer&&this.currentPlayer.playing()}on(T,x){this.eventSubject.asObservable().pipe((0,O.p)(z=>z===T),(0,P.Q)(this.ngUnsubscribe)).subscribe(x)}load(){this.players.forEach(T=>T.load())}unload(){this.players.forEach(T=>T.unload()),this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}init(){const T=this.players.length;let x=0;this.players.forEach((z,I)=>{z.on("load",()=>{this.totalDuration+=z.duration(),x++,x>=T&&(this.eventSubject.next("load"),this.loadState="loaded")}),z.on("play",()=>{"unloaded"===this.loadState&&(this.loadState="loading"),this.isPlaying||this.eventSubject.next("play"),this.isPlaying=!0,this.index=I}),z.on("pause",()=>{this.isPlaying=!1,this.eventSubject.next("pause")}),z.on("end",()=>{if(this.isPlaying){const L=this.players[I+1];L?L.play():(this.isPlaying=!1,this.index=0,this.eventSubject.next("end"))}}),z.on("stop",()=>{this.isPlaying=!1,this.eventSubject.next("stop")}),z.on("loaderror",()=>{this.eventSubject.next("loaderror")}),z.on("playerror",()=>{this.eventSubject.next("playerror")})})}}var a=n(2573),f=n(36110),E=n(28577),y=n(15877),i=n(46075),g=n(11040),p=n(68947),h=n(5393),o=n(22397),v=n(12347),d=n(45144),r=n(63008),_=n(54438),u=n(21626),l=n(35286),m=n(92014);const b="/media/audio",A=new RegExp(`^${b}/(.*)/.*$`),G=["aac","m4a","mp3","ogg"],k={aac:"audio/aac",m4a:"audio/mp4",mp3:"audio/mpeg",ogg:"audio/ogg"};Howler.autoUnlock=!1;let V=(()=>{class W{constructor(x,z,I,D,L){this.http=z,this.markdownService=I,this.animationService=D,this.store=L,this.audioPromises=new Map,this.audioPlayers=new Map,this.audioEventSubject=new c.B,this.videoPlayers=new Map,this.videoEventSubject=new c.B,this.videoSources=new Map,this.renderer=x.createRenderer(null,null)}addAudioPlayer(x,z,I,D={}){var L=this;return(0,e.A)(function*(){L.removeAudioPlayer(x);const Q=z.then(Z=>L.createAudioPlayer(Z,I,D));L.audioPromises.set(x,Q);const ie=yield Q,se=()=>{ie.playing()&&(L.audioEventSubject.next({event:"playing",id:x,data:{time:ie.seek()}}),requestAnimationFrame(se))};return ie.on("load",()=>{L.audioEventSubject.next({event:"load",id:x})}),ie.on("play",()=>{L.audioEventSubject.next({event:"play",id:x}),se()}),ie.on("pause",()=>{L.audioEventSubject.next({event:"pause",id:x})}),ie.on("stop",()=>{L.audioEventSubject.next({event:"stop",id:x})}),ie.on("seek",()=>{L.audioEventSubject.next({event:"seek",id:x,data:{time:ie.seek()}})}),ie.on("end",()=>{L.audioEventSubject.next({event:"end",id:x})}),ie.on("playerror",()=>{L.audioEventSubject.next({event:"playerror",id:x})}),L.audioPlayers.set(x,ie),ie})()}createAudioPlayer(x,z,I){var D=this;return(0,e.A)(function*(){if(z){const L=yield D.createAudioDataUrl(x);return D.createSinglePlayer(L,I)}return x.length>1?D.createSinglePlayer(x[0],I):D.createMultiPlayer(x,I)})()}createSinglePlayer(x,z){return new t.Howl({...z,src:x,format:G})}createMultiPlayer(x,z){const I=x.map(D=>this.createSinglePlayer(D,z));return new S(I)}removeAudioPlayer(x){var z=this;return(0,e.A)(function*(){const I=z.audioPromises.get(x);if(z.audioPromises.delete(x),z.audioPlayers.delete(x),I)return I.then(D=>D.unload())})()}getAudioPlayer(x){var z=this;return(0,e.A)(function*(){return z.audioPromises.get(x)})()}hasAudioPlayer(x){return this.audioPromises.has(x)}removeAllAudioPlayers(){this.audioPromises.forEach((x,z)=>this.removeAudioPlayer(z))}createAudioUploadEvent(x){return{type:"uploadFile",url:"/ws/media/audio/upload",method:"POST",file:x}}getAudioEvents(){return this.audioEventSubject.asObservable()}getAudioClips(x){return Object.values(x).filter(z=>"audio"===z.streamType)}createAudioClip(x,z,I){const D=this.getAudioUUID(z),{firstTime:L,lastTime:Q}=this.animationService.getChapterTimeFrame();return[D,{clipId:D,streamType:"audio",fullUrl:z,time1:L,time2:Q,lang:I}]}createAudioDataUrl(x){return(0,e.A)(function*(){const z=x.map(I=>fetch(I).then(D=>D.blob()));return Promise.all(z).then(I=>{const D=x[0].split(".").pop();return URL.createObjectURL(new Blob(I,{type:k[D]||k.mp3}))})})()}getDuration(x){return(0,e.A)(function*(){return"loaded"===x.state()?x.duration():new Promise(z=>{x.on("load",()=>{z(x.duration())})})})()}getTTSSources(x,z=g.q.id){var I=this;return(0,e.A)(function*(){const D=yield p.l.getPlainTextFromMarkdown(I.renderer,I.markdownService,x||"",!0),L=yield(0,h.E)(D);return(0,o.R)(D,L||z)})()}getAudioUUID(x){return x.match(A)[1]}getAudioSrc(x){return x.match(b)?x:`/content/states/${x}`}muteAudio(){this.audioPlayers.forEach(x=>{x.mute(!0)})}unmuteAudio(x){const z=this.audioPlayers.get(x);z&&(z.mute(!1),this.store.dispatch(new r.O.SetAudioMuted(!1)))}stopAllAudio(){this.stopAudio()}stopAllOtherAudio(x){this.stopAudio(x)}stopAudio(x){this.audioPlayers.forEach((z,I)=>{(!x||I!==x)&&z.stop()})}playAudio(x,z){this.getAudioPlayer(x).then(I=>{I&&((0,s.isNil)(z)||(I.mute(z),this.store.dispatch(new r.O.SetAudioMuted(z))),I.play())})}playChapterAudio(x){this.stopAllAudio(),this.playAudio(x,!1),this.store.dispatch(new r.O.SetAutoplayAudio(!0)),this.store.dispatch(new r.O.SetAudioMuted(!1))}getPlayingAudio(){const x=[];return this.audioPlayers.forEach(z=>{z.playing()&&x.push(z)}),x}getChapterAudioPlayer(x,z,I=!1){var D=this;return(0,e.A)(function*(){return D.getChapterAudioPlaybackType(x,z,I)!==d.Y.None?D.hasAudioPlayer(x.id)?yield D.getAudioPlayer(x.id):yield D.createChapterAudioPlayer(x,z,I):null})()}createChapterAudioPlayer(x,z,I=!1){var D=this;return(0,e.A)(function*(){const L=D.getChapterAudioPlaybackType(x,z,I),Q=D.buildChapterAudioSources(x,L,z);return L===d.Y.None?null:yield D.addAudioPlayer(x.id,Q,!0,{preload:!0,mute:!0})})()}buildChapterAudioSources(x,z,I){var D=this;return(0,e.A)(function*(){const Q=D.getChapterAudioInLanguage(x,I)?.fullUrl??"",ie=x?.description,se=g.IB.find(Z=>Z.lang===I);switch(z){case d.Y.File:return Q?[D.getAudioSrc(Q)]:[];case d.Y.TTS:return D.getTTSSources(ie,se?.id);default:return[]}})()}getChapterAudioList(x){return x.media?Object.values(x.media).filter(I=>"audio"===I.streamType):[]}getChapterAudioInLanguage(x,z){return this.getChapterAudioList(x).find(D=>D.lang===z)}getChapterAudioPlaybackType(x,z,I=!1){let D=x?.ui?.config?.audio??d.Y.File;const L=!(0,s.isNil)(this.getChapterAudioList(x).find(ie=>ie.lang===z));I&&!L&&D!==d.Y.TTS&&(D=d.Y.TTS);const Q=(0,s.trim)(x?.description??"").length>0;switch(D){case d.Y.File:return L?d.Y.File:d.Y.None;case d.Y.TTS:return Q?d.Y.TTS:d.Y.None;default:return d.Y.None}}chapterHasAudio(x,z){return this.getChapterAudioPlaybackType(x,z)!==d.Y.None}getVideoPlayer(x){return this.videoPlayers.get(x)}createVideoPlayer(x,z){return(0,e.A)(function*(){return(0,(yield n.e(78).then(n.bind(n,37078))).default)(x,z)})()}getVideoEvents(){return this.videoEventSubject.asObservable()}addVideoPlayer(x,z){var I=this;return(0,e.A)(function*(){const D=yield I.createVideoPlayer(x,z),L=D.id();return D.on("play",()=>{I.videoEventSubject.next({event:"play",id:L})}),D.on("pause",()=>{I.videoEventSubject.next({event:"pause",id:L})}),D.on("seeking",()=>{I.videoEventSubject.next({event:"seeking",id:L})}),D.on("ended",()=>{I.videoEventSubject.next({event:"ended",id:L})}),D.on("error",()=>{I.videoEventSubject.next({event:"error",id:L})}),I.videoPlayers.set(L,D),L})()}removeVideoPlayer(x){const z=this.getVideoPlayer(x);z&&(z.dispose(),this.videoPlayers.delete(x))}getVideoUrls(x){return this.http.post("/ws/mc/video/upload/authorize",{filename:x})}checkVideoStatus(x){return this.videoSources.has(x)?new a.c(z=>{z.next(this.videoSources.get(x)),z.complete()}):this.http.get(x).pipe((0,f.T)(z=>{const I=z.listing.map(D=>({src:D,type:this.getFileMIMEType(D)}));return this.videoSources.set(x,I),I}),(0,E.W)(()=>(0,y.of)(!1)))}checkAnimatedImageStatus(x){return(0,e.A)(function*(){return new Promise(z=>{const I=new Image;I.onload=()=>z(!0),I.onerror=()=>z(!1),I.onabort=()=>z(!1),I.src=x})})()}getFileMIMEType(x){const z=x.split(".").pop(),I=i.CC[`.${z}`];return I?I[0]:""}static#e=this.\u0275fac=function(z){return new(z||W)(_.KVO(_._9s),_.KVO(u.Qq),_.KVO(l.Rl),_.KVO(v.O),_.KVO(m.il))};static#t=this.\u0275prov=_.jDH({token:W,factory:W.\u0275fac,providedIn:"root"})}return W})()},63008:(le,N,n)=>{"use strict";var e,t;n.d(N,{O:()=>e}),(t=e||(e={})).SetAudioMuted=(()=>{class P{static#e=this.type="[Media] Set Audio Muted";constructor(a){this.mute=a}}return P})(),t.SetAutoplayAudio=(()=>{class P{static#e=this.type="[Media] Set Autoplay Audio";constructor(a){this.autoplay=a}}return P})(),t.ResetAudio=(()=>{class P{static#e=this.type="[Media] Reset Audio";constructor(){}}return P})()},37710:(le,N,n)=>{"use strict";n.d(N,{S:()=>f});var e=n(92014),t=n(63008),s=n(81025),c=n(54438),O=function(E,y,i,g){var o,p=arguments.length,h=p<3?y:null===g?g=Object.getOwnPropertyDescriptor(y,i):g;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)h=Reflect.decorate(E,y,i,g);else for(var v=E.length-1;v>=0;v--)(o=E[v])&&(h=(p<3?o(h):p>3?o(y,i,h):o(y,i))||h);return p>3&&h&&Object.defineProperty(y,i,h),h},P=function(E,y){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(E,y)};class S{}const a={audioMuted:!0,autoplayAudio:!1};let f=class Os{static getAudioMuted(y){return y.audioMuted}static getAutoplayAudio(y){return y.autoplayAudio}setAudioMuted(y,i){const g=s.jM(y.getState(),p=>{p.audioMuted=i.mute});y.setState(g)}setAutoplayAudio(y,i){const g=s.jM(y.getState(),p=>{p.autoplayAudio=i.autoplay});y.setState(g)}resetAudio(y,i){y.setState(a)}static#e=this.\u0275fac=function(i){return new(i||Os)};static#t=this.\u0275prov=c.jDH({token:Os,factory:Os.\u0275fac})};O([(0,e.rc)(t.O.SetAudioMuted),P("design:type",Function),P("design:paramtypes",[Object,t.O.SetAudioMuted]),P("design:returntype",void 0)],f.prototype,"setAudioMuted",null),O([(0,e.rc)(t.O.SetAutoplayAudio),P("design:type",Function),P("design:paramtypes",[Object,t.O.SetAutoplayAudio]),P("design:returntype",void 0)],f.prototype,"setAutoplayAudio",null),O([(0,e.rc)(t.O.ResetAudio),P("design:type",Function),P("design:paramtypes",[Object,t.O.ResetAudio]),P("design:returntype",void 0)],f.prototype,"resetAudio",null),O([(0,e.MD)(),P("design:type",Function),P("design:paramtypes",[S]),P("design:returntype",void 0)],f,"getAudioMuted",null),O([(0,e.MD)(),P("design:type",Function),P("design:paramtypes",[S]),P("design:returntype",void 0)],f,"getAutoplayAudio",null),f=O([(0,e.Uw)({name:"media",defaults:a})],f)},16e3:(le,N,n)=>{"use strict";var e,t;n.d(N,{h:()=>e}),(t=e||(e={})).Reset=(()=>{class O{static#e=this.type="[Memory] Reset";constructor(){}}return O})(),t.Update=(()=>{class O{static#e=this.type="[Memory] Update";constructor(S,a=!1){this.isFirstChapter=S,this.logToConsole=a}}return O})()},52597:(le,N,n)=>{"use strict";n.d(N,{d:()=>e});var e=function(t){return t.Success="success",t.Fail="fail",t}(e||{})},97978:(le,N,n)=>{"use strict";n.d(N,{F:()=>p});var e=n(21626),t=n(15877),s=n(36110),c=n(28577),O=n(52597),P=n(45731),S=n(17766),a=n(35650),f=n(54438);const E="cdb/content",y="cdb/copy/content",i={headers:new e.Lr({"Content-Type":"application/json; charset=utf-8"})},g=["production","client","preview","internal_content","public_preview","demos","social","exports","real_data"];let p=(()=>{class h{constructor(v,d){this.http=v,this.sceneService=d}saveModule(v,d){d=this.formatModulePath(d);const r=[E,"modules",d].join("/"),_=this.JSONStringify(v);return this.http.put(r,_,i).pipe((0,s.T)(()=>O.d.Success),(0,c.W)(({status:u})=>(0,t.of)(u>=200&&u<=202?O.d.Success:O.d.Fail)))}mergeModule(v,d,r="exception"){return this.http.post("/cdb/merge/modules",{loft:`${v}.json`,bridge:`${d}.json`,merge_option:r})}copyState(v,d){const r=[y,"states",d].join("/"),_={headers:new e.Lr({"Content-Type":"application/json; charset=utf-8","source-state":v})};return this.http.put(r,{},_)}listContents(v,d,r,_=!1){const u=this.generateModulePath(v,d||"",r||"");return this.http.get(`/cdb/ls/content/modules/${u}`).pipe((0,s.T)(l=>_?l.contents.map(C=>{const b=C.name.replace("/content/modules/","").replace(".json",""),R=C.name.split("/").pop().replace("/content/modules","").replace(".json",""),A=new P.S;return A.id=b,A.title=R,A.type=S.c.Module,A}):l.contents))}getState(v){return this.http.get(`/cdb/ls/content/states/${v}`).pipe((0,s.T)(d=>d.contents))}getClients(){return this.http.get("/search/client").pipe((0,s.T)(v=>v.clients))}getUsedStates(){const v={};return Object.values(this.sceneService.getObjects()).reduce((d,r)=>(["transformId","morphId","geometryId","materialId"].forEach(_=>{const u=this.getPropertyState(r,_);u.length&&(v[u]=!0)}),r.hasOwnProperty("renderables")&&["morphId","geometryId","materialId"].forEach(_=>{r.renderables.forEach(l=>{const m=this.getPropertyState(l,_);m.length&&(v[m]=!0)})}),d),{}),Object.keys(v)}parseScenePath(v){const d=v.split("/");return 1===d.length?null:{fullPath:`https://qa.biodigital.com/content/modules/${v}`,relativePath:d.slice(0,d.length-1).join("/"),sceneName:d[d.length-1]}}formatModulePath(v){let d=v;return/\.json$/.test(v)||(d=`${d}.json`),d}getPrimaryCategories(){return(0,t.of)(g)}getSecondaryCategories(v){switch(v){case"production":return(0,t.of)(["maleAdult","femaleAdult"]);case"client":return this.getClients();default:return(0,t.of)([])}}generateSaveModule(v){const d=this.parseScenePath(v),r=d.relativePath.split("/");return{id:v,name:d.sceneName,primaryCategory:r[0]||"",secondaryCategory:r[1]||""}}generateModulePath(v,d,r){const _=[];return v.length&&_.push(v),d.length&&_.push(d),r.length&&(r.indexOf(".json")<0&&(r=`${r}.json`),_.push(r)),_.join("/")}getPropertyState(v,d){return null!=v[d]?v[d].split("/")[0]:""}JSONStringify(v){return JSON.stringify(v).replace(/[\u007f-\uffff]/g,d=>"\\u"+("0000"+d.charCodeAt(0).toString(16)).slice(-4))}static#e=this.\u0275fac=function(d){return new(d||h)(f.KVO(e.Qq),f.KVO(a.w))};static#t=this.\u0275prov=f.jDH({token:h,factory:h.\u0275fac,providedIn:"root"})}return h})()},30234:(le,N,n)=>{"use strict";n.d(N,{O:()=>t,a:()=>e});var e=function(s){return s.WoltersKluwer="wolters_kluwer",s.Zspace="zspace",s}(e||{}),t=function(s){return s.None="none",s.Subscription="subcription",s.Device="device",s}(t||{})},15040:(le,N,n)=>{"use strict";n.d(N,{n:()=>t});class t{}},2824:(le,N,n)=>{"use strict";n.d(N,{V:()=>s});var e=n(49204);function s(c){return"?"+Object.entries(c).filter(([O,P])=>!(0,e.isNil)(P)).map(([O,P])=>`${O}=${encodeURIComponent(P)}`).join("&")}},65459:(le,N,n)=>{"use strict";n.d(N,{k:()=>p});var e=n(21626);class t{}var s=n(36110),c=n(40470),O=n(45731),P=n(79440),S=function(h){return h.IdAsc="+collection_id",h.IdDesc="-collection_id",h.NameAsc="+collection_name",h.NameDesc="-collection_name",h.UpdateDateAsc="+collection_updatedate",h.UpdateDateDesc="-collection_updatedate",h.CreateDateAsc="+collection_createdate",h.CreateDateDesc="-collection_createdate",h.CustomAsc="+custom_sort_order",h.CustomDesc="-custom_sort_order",h}(S||{}),a=n(2824),f=n(5690),E=n(49204),y=n(54438);const i="/ws/organization/collection",g="/ws/organization/join/domains";let p=(()=>{class h{constructor(v,d){this.http=v,this.productService=d}createOrganization(v){return this.http.post("/ws/organization/create",v)}updateOrganization(v){return this.http.post("/ws/organization/update",v)}deleteOrganization(v){return this.http.request("delete","/ws/organization/delete",{body:{version:1,app_productkey:this.productService.productKey,app_producttype:this.productService.productType,group_id:v}})}getCollections(v){v.sort_order||(v.sort_order=[S.CustomAsc,S.NameDesc]);const d=a.V(v);return this.http.get(`${i}${d}`).pipe((0,s.T)(r=>(0,c.bj)(t,r).map(_=>this.normalizeCollectionModel(_))))}getCollectionContent(v,d,r="",_="en"){const u=r.toLocaleLowerCase().split(" ");return this.getCollections({group_id:v,collection_id:d,include_content:1,ol:_}).pipe((0,s.T)(l=>l[0].collection_content.map(C=>(0,c.bj)(O.S,C)).filter(C=>{let b=!0;return u.length&&C.title&&u.forEach(R=>{b=b&&C.title.toLocaleLowerCase().indexOf(R)>=0}),b=b&&!0!==C.unavailable,b})))}addCollection(v,d){return this.http.post(i,{group_id:v,collection_name:d})}removeCollection(v){return this.http.request("DELETE",i,{body:{group_id:v.group_id,collection_id:v.collection_id}})}renameCollection(v,d){return this.http.post(i,{group_id:v.group_id,collection_id:v.collection_id,collection_name:d})}reorderCollections(v,d){return this.http.post(`${i}/sort-order`,{group_id:v,collection_id_sort_list:d.map(r=>r.collection_id)})}updateCollectionContent(v,d,r){return this.http.post(`${i}/content`,{group_id:v,add_content:d,remove_content:r})}getOrganizationAttribute(v,d,r){return v.find(_=>_.type===d&&_.name===r)}getPublicProfile(v){return this.http.get("/ws/organization/public/profile",{params:{...v}}).pipe((0,s.T)(d=>d))}normalizeCollectionModel(v){return v.collection_content&&v.collection_content.forEach(d=>{(0,P.H)(d)}),v}isNewJoinDomain(v){return(0,E.isNil)(v.join_domain_id)}checkJoinDomains(v){return this.http.post("/ws/organization/join/domain/check",{version:1,app_productkey:this.productService.productKey,app_producttype:this.productService.productType,email_domains:v}).pipe((0,s.T)(r=>{const _=r.email_domains_checked;return v.map(u=>_[u].is_blacklisted)}))}getJoinDomains(v){const d={version:1,app_productkey:this.productService.productKey,app_producttype:this.productService.productType,...v},r=new e.Nl({fromObject:{...d}});return this.http.get(g,{params:r})}postJoinDomains(v){return this.http.post(g,{version:1,app_productkey:this.productService.productKey,app_producttype:this.productService.productType,email_domains:v})}deleteJoinDomains(v){return this.http.request("delete",g,{body:{version:1,app_productkey:this.productService.productKey,app_producttype:this.productService.productType,join_domain_ids:v}})}generateGroupCode(v){return this.http.post("/ws/organization/generate/groupcode",{version:1,app_productkey:this.productService.productKey,app_producttype:this.productService.productType,group_id:v})}static#e=this.\u0275fac=function(d){return new(d||h)(y.KVO(e.Qq),y.KVO(f.b))};static#t=this.\u0275prov=y.jDH({token:h,factory:h.\u0275fac,providedIn:"root"})}return h})()},18152:(le,N,n)=>{"use strict";n.d(N,{$7:()=>R,A6:()=>t,B4:()=>s,BD:()=>h,DM:()=>Q,F:()=>W,Fy:()=>e,GC:()=>A,Hi:()=>D,LJ:()=>k,Lo:()=>m,O4:()=>x,OG:()=>I,Ot:()=>T,QB:()=>r,Rk:()=>y,T1:()=>f,Uj:()=>L,XL:()=>G,Yn:()=>v,_o:()=>V,_q:()=>c,bE:()=>se,cw:()=>l,cz:()=>ae,dD:()=>S,dl:()=>O,e1:()=>ie,eS:()=>Z,fA:()=>z,hQ:()=>d,hu:()=>o,jK:()=>g,kW:()=>a,ks:()=>i,m1:()=>C,nB:()=>u,ob:()=>E,pv:()=>de,qS:()=>P,qd:()=>p,ul:()=>_,xX:()=>b});let e=(()=>{class q{static#e=this.type="[Organizations] Set Organizations";constructor(j){this.organizations=j}}return q})(),t=(()=>{class q{static#e=this.type="[Organizations] Select Organization";constructor(j){this.organization=j}}return q})(),s=(()=>{class q{static#e=this.type="[Organizations] Select Collection";constructor(j){this.collection=j}}return q})(),c=(()=>{class q{static#e=this.type="[Organizations] Get Collections";constructor(j){this.organizationId=j}}return q})(),O=(()=>{class q{static#e=this.type="[Organizations] Get Collections Success";constructor(j){this.collections=j}}return q})(),P=(()=>{class q{static#e=this.type="[Organizations] Add Collection";constructor(j,M){this.organizationId=j,this.collectionName=M}}return q})(),S=(()=>{class q{static#e=this.type="[Organizations] Add Collection Success";constructor(j,M){this.organizationId=j,this.collectionName=M}}return q})(),a=(()=>{class q{static#e=this.type="[Organizations] Add Collection Error";constructor(j){this.error=j}}return q})(),f=(()=>{class q{static#e=this.type="[Organizations] Remove Collection";constructor(j){this.collection=j}}return q})(),E=(()=>{class q{static#e=this.type="[Organizations] Remove Collection Success";constructor(j){this.collection=j}}return q})(),y=(()=>{class q{static#e=this.type="[Organizations] Remove Collection Error";constructor(j){this.error=j}}return q})(),i=(()=>{class q{static#e=this.type="[Organizations] Set Collection Rename Mode";constructor(j){this.collection=j}}return q})(),g=(()=>{class q{static#e=this.type="[Organizations] Rename Collection";constructor(j,M){this.collection=j,this.collectionName=M}}return q})(),p=(()=>{class q{static#e=this.type="[Organizations] Rename Collection Success";constructor(j,M){this.collection=j,this.collectionName=M}}return q})(),h=(()=>{class q{static#e=this.type="[Organizations] Rename Collection Error";constructor(j){this.error=j}}return q})(),o=(()=>{class q{static#e=this.type="[Organizations] Reorder Collections";constructor(j,M){this.organizationId=j,this.collections=M}}return q})(),v=(()=>{class q{static#e=this.type="[Organizations] Reorder Collections Success";constructor(j,M){this.organizationId=j,this.collections=M}}return q})(),d=(()=>{class q{static#e=this.type="[Organizations] Reorder Collections Error";constructor(j){this.error=j}}return q})(),r=(()=>{class q{static#e=this.type="[Organizations] Reset";constructor(){}}return q})(),_=(()=>{class q{static#e=this.type="[Organizations] Create Organization";constructor(j){this.organization=j}}return q})(),u=(()=>{class q{static#e=this.type="[Organizations] Create Organization Success";constructor(){}}return q})(),l=(()=>{class q{static#e=this.type="[Organizations] Create Organization Fail";constructor(j){this.error=j}}return q})(),m=(()=>{class q{static#e=this.type="[Organizations] Update Organization";constructor(j){this.organization=j}}return q})(),C=(()=>{class q{static#e=this.type="[Organizations] Update Organization Success";constructor(){}}return q})(),b=(()=>{class q{static#e=this.type="[Organizations] Update Organization Fail";constructor(j){this.error=j}}return q})(),R=(()=>{class q{static#e=this.type="[Organizations] Delete Organization";constructor(j){this.organization=j}}return q})(),A=(()=>{class q{static#e=this.type="[Organizations] Delete Organization Success";constructor(j){this.organization=j}}return q})(),G=(()=>{class q{static#e=this.type="[Organizations] Delete Organization Fail";constructor(j){this.error=j}}return q})(),k=(()=>{class q{static#e=this.type="[Organizations] Get Organization Profile";constructor(j){this.request=j}}return q})(),V=(()=>{class q{static#e=this.type="[Organizations] Get Organization Profile Success";constructor(j){this.organizationProfile=j}}return q})(),W=(()=>{class q{static#e=this.type="[Organizations] Get Organization Profile Fail";constructor(j){this.error=j}}return q})(),T=(()=>{class q{static#e=this.type="[Organizations] Clear Organization Profile";constructor(){}}return q})(),x=(()=>{class q{static#e=this.type="[Organizations] Get Join Domains";constructor(j){this.params=j}}return q})(),z=(()=>{class q{static#e=this.type="[Organizations] Get Join Domains Success";constructor(j){this.joinDomains=j}}return q})(),I=(()=>{class q{static#e=this.type="[Organizations] Post Join Domains";constructor(j){this.emailDomains=j}}return q})(),D=(()=>{class q{static#e=this.type="[Organizations] Post Join Domains Success";constructor(j){this.emailDomains=j}}return q})(),L=(()=>{class q{static#e=this.type="[Organizations] Post Join Domains Fail";constructor(j){this.error=j}}return q})(),Q=(()=>{class q{static#e=this.type="[Organizations] Delete Join Domains";constructor(j){this.joinDomainIds=j}}return q})(),ie=(()=>{class q{static#e=this.type="[Organizations] Delete Join Domains Success";constructor(j){this.joinDomainIds=j}}return q})(),se=(()=>{class q{static#e=this.type="[Organizations] Delete Join Domains Fail";constructor(j){this.error=j}}return q})(),Z=(()=>{class q{static#e=this.type="[Organizations] Generate Group Code";constructor(j){this.groupId=j}}return q})(),de=(()=>{class q{static#e=this.type="[Organizations] Generate Group Code Success";constructor(j){this.groupCode=j}}return q})(),ae=(()=>{class q{static#e=this.type="[Organizations] Generate Group Code Fail";constructor(j){this.error=j}}return q})()},21424:(le,N,n)=>{"use strict";n.d(N,{q:()=>r});var e=n(92014);class t{}var s=n(18152),c=n(65459),O=n(56583),P=n(16058),S=n(94528),a=n(15152),f=n(59e3),E=n(49204),y=n(30234),i=n(5690),g=n(16823),p=n(54438),h=function(_,u,l,m){var R,C=arguments.length,b=C<3?u:null===m?m=Object.getOwnPropertyDescriptor(u,l):m;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)b=Reflect.decorate(_,u,l,m);else for(var A=_.length-1;A>=0;A--)(R=_[A])&&(b=(C<3?R(b):C>3?R(u,l,b):R(u,l))||b);return C>3&&b&&Object.defineProperty(u,l,b),b},o=function(_,u){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(_,u)};const v={joinDomains:[],loading:!1,creating:!1,updating:!1,deleting:!1,loadingJoinDomains:!1,addingJoinDomains:!1,removingJoinDomains:!1,generatingGroupCode:!1,loadingCollections:!1,addingCollection:!1,reorderingCollections:!1,removingCollection:!1,updatingCollection:!1,isZSpaceAccount:!1,collectionRenaming:null};let r=class Ps{static getOrganizations(u){return u.organizations}static getOrganization(u){return u.organization}static getOrganizationLogo(u){return u.organization?.group_logos?.human_app?.default?.logo_url??""}static getSelectedOrganization(u){return u.selectedOrganization}static getSelectedOrganizationProductAccountId(u){return u.organization?.product_acctid||""}static getOrganizationProfile(u){return u.organizationProfile}static getOrganizationGroupAttributes(u){return u.organization?.group_attributes||[]}static getOrganizationAccountSettings(u){return function d(_,u){return _.filter(l=>l.type===u).map(l=>{const{name:m,value:C}=l;return{[m]:{value:C}}})}(this.getOrganizationGroupAttributes(u),"account_settings")}static getDefaultUserRole(u,l){return this.getOrganizationGroupAttributes(u).find(C=>"default_user_role"===C.name).value??g.k.getSystemDefaultRole(l)}static getOrganizationGroupCode(u){return(0,E.get)(u,"organization.group_code","")}static getCollections(u){return u.collections}static getSelectedCollection(u){return u.selectedCollection}static getReorderingCollections(u){return u.reorderingCollections}static getAddingCollection(u){return u.addingCollection}static getRemovingCollection(u){return u.removingCollection}static getUpdatingCollection(u){return u.updatingCollection}static getCollectionRenaming(u){return u.collectionRenaming}static getGeneratingGroupCode(u){return u.generatingGroupCode}static getWidgetURL(u){return u.widgetURL}static getWidgetOptions(u){return u.widgetOptions}static getAppFeatures(u){return u.appFeatures}static getCreating(u){return u.creating}static getUpdating(u){return u.updating}static getDeleting(u){return u.deleting}static getLoading(u){return u.loading}static getCollectionsLoading(u){return u.loadingCollections}static getLoadingJoinDomains(u){return u.loadingJoinDomains}static getAddingJoinDomains(u){return u.addingJoinDomains}static getRemovingJoinDomains(u){return u.removingJoinDomains}static hasOrganization(u){return!(0,E.isNil)(u.organization)}static isTrial(u){return(0,E.get)(u,"organization.subscription.free_trial",!1)}static isSubscriptionExpired(u){return!0===(0,E.get)(u,"organization.subscription.expired",!1)}static getSubscriptionEndDate(u){const l=(0,E.get)(u,"organization.subscription.paid_through_date_time");return(0,E.isNil)(l)?void 0:new Date(l)}static getExternalAccount({organization:u}){return u?.external_account}static isValidPaidSubscription(u){return this.hasOrganization(u)&&!this.isTrial(u)&&!this.isSubscriptionExpired(u)}static getJoinDomains(u){return u.joinDomains}static isZSpaceAccount(u){return u.isZSpaceAccount}static getOrganizationAddOns(u){return u?.organization?.subscription?.addons}selectOrganization(u,l){const m=l.organization;u.patchState({selectedOrganization:m,selectedCollection:null}),m&&u.dispatch(new s._q(m.id))}setOrganizations(u,l){const m=l.organizations||[],C=m[0];let b,R=null,A={...u.getState().appFeatures};if(C&&C.group_attributes){const k=C.group_attributes,V=this.organizationsService.getOrganizationAttribute(k,"widget_settings","widget_custom_url_path");V&&V.value&&(b=V.value);const W=this.organizationsService.getOrganizationAttribute(k,"widget_settings","widget_url_params");W&&W.value&&(R=this.publishService.extendWidgetOptions(new O.$,W.value));const T=this.organizationsService.getOrganizationAttribute(k,"app_settings","web_app_features");T&&(A={...A,...T.value})}u.patchState({organization:C,organizations:m,widgetURL:b,widgetOptions:R,appFeatures:A,isZSpaceAccount:C.external_account.external_account_provider===y.a.Zspace}),u.dispatch(new S.PE(b)),C&&this.vendorAnalyticsService.updateAccountData(C)}getCollections(u,l){u.patchState({loadingCollections:!0}),this.organizationsService.getCollections({group_id:l.organizationId}).pipe((0,a.j)(()=>u.patchState({loadingCollections:!1}))).subscribe(m=>{u.dispatch(new s.dl(m))})}getCollectionsSuccess(u,l){u.patchState({collections:l.collections})}selectCollection(u,l){const{organization:m,selectedOrganization:C}=u.getState();u.patchState({selectedOrganization:C||m,selectedCollection:l.collection})}addCollection(u,l){u.patchState({addingCollection:!0}),this.organizationsService.addCollection(l.organizationId,l.collectionName).pipe((0,a.j)(()=>{u.patchState({addingCollection:!1})})).subscribe(()=>{u.dispatch(new s.dD(l.organizationId,l.collectionName))},m=>{u.dispatch(new s.kW(m))})}addCollectionSuccess(u,l){this.vendorAnalyticsService.track("Add Collection - Success",{platform:this.productService.productType})}addCollectionError(u,l){this.vendorAnalyticsService.track("Add Collection - Failure",{error:(0,E.get)(l,"error.error.error.message")||"There was an error with collection creation."})}removeCollection(u,l){u.patchState({removingCollection:!0}),this.organizationsService.removeCollection(l.collection).pipe((0,a.j)(()=>{u.patchState({removingCollection:!1})})).subscribe(()=>{u.dispatch(new s.ob(l.collection))},m=>{u.dispatch(new s.Rk(m))})}removeCollectionSuccess(u,l){this.vendorAnalyticsService.track("Remove Collection - Success",{platform:this.productService.productType})}removeCollectionError(u,l){this.vendorAnalyticsService.track("Remove Collection - Failure",{error:(0,E.get)(l,"error.error.error.message")||"There was an error with collection removal."})}setCollectionRenameMode(u,l){u.patchState({collectionRenaming:l.collection})}renameCollection(u,l){u.patchState({updatingCollection:!0}),this.organizationsService.renameCollection(l.collection,l.collectionName).pipe((0,a.j)(()=>{u.patchState({updatingCollection:!1})})).subscribe(()=>{u.dispatch(new s.qd(l.collection,l.collectionName))},m=>{u.dispatch(new s.BD(m))})}renameCollectionSuccess(u,l){this.vendorAnalyticsService.track("Rename Collection - Success",{platform:this.productService.productType})}renameCollectionError(u,l){this.vendorAnalyticsService.track("Rename Collection - Failure",{error:(0,E.get)(l,"error.error.error.message")||"There was an error with collection renaming."})}reorderCollections(u,l){u.patchState({reorderingCollections:!0}),this.organizationsService.reorderCollections(l.organizationId,l.collections).pipe((0,a.j)(()=>{u.patchState({reorderingCollections:!1})})).subscribe(()=>{u.dispatch(new s.Yn(l.organizationId,l.collections))},m=>{u.dispatch(new s.hQ(m))})}reorderCollectionsSuccess(u,l){u.patchState({collections:[...l.collections]})}resetOrganizations(u,l){u.setState(v)}createOrganization(u,{organization:l}){u.patchState({creating:!0}),this.organizationsService.createOrganization(l).pipe((0,a.j)(()=>u.patchState({creating:!1}))).subscribe(()=>u.dispatch(new s.nB),m=>u.dispatch(new s.cw(m)))}createOrganizationSuccess(u){this.vendorAnalyticsService.track("Team Creation - Success",{platform:this.productService.productType})}createOrganizationFail(u,l){this.vendorAnalyticsService.track("Team Creation - Failure",{error:(0,E.get)(l,"error.error.error.message")||"There was an error with team creation."})}updateOrganization(u,{organization:l}){u.patchState({updating:!0}),this.organizationsService.updateOrganization(l).pipe((0,a.j)(()=>u.patchState({updating:!1}))).subscribe(()=>u.dispatch(new s.m1),m=>u.dispatch(new s.xX(m)))}deleteOrganization(u,{organization:l}){u.patchState({deleting:!0}),this.organizationsService.deleteOrganization(l.id).pipe((0,a.j)(()=>u.patchState({deleting:!1}))).subscribe({next:()=>u.dispatch(new s.GC(l)),error:m=>u.dispatch(new s.XL(m))})}getOrganizationProfile(u,{request:l}){u.patchState({loading:!0}),this.organizationsService.getPublicProfile(l).pipe((0,a.j)(()=>u.patchState({loading:!1}))).subscribe(m=>u.dispatch(new s._o(m)),m=>u.dispatch(new s.F(m)))}getOrganizationProfileSuccess(u,{organizationProfile:l}){u.patchState({organizationProfile:l})}clearOrganizationProfile(u,l){u.patchState({organizationProfile:void 0})}getJoinDomains(u,l){u.patchState({loadingJoinDomains:!0}),this.organizationsService.getJoinDomains(l.params).pipe((0,a.j)(()=>u.patchState({loadingJoinDomains:!1}))).subscribe(m=>{u.dispatch(new s.fA(m.email_domains))})}getJoinDomainsSuccess(u,{joinDomains:l}){u.patchState({joinDomains:l})}postJoinDomains(u,l){u.patchState({addingJoinDomains:!0}),this.organizationsService.postJoinDomains(l.emailDomains).pipe((0,a.j)(()=>u.patchState({addingJoinDomains:!1}))).subscribe({next:()=>{u.dispatch(new s.Hi(l.emailDomains))},error:m=>{u.dispatch(new s.Uj(m))}})}deleteJoinDomains(u,l){u.patchState({removingJoinDomains:!0}),this.organizationsService.deleteJoinDomains(l.joinDomainIds).pipe((0,a.j)(()=>u.patchState({removingJoinDomains:!1}))).subscribe({next:()=>{u.dispatch(new s.e1(l.joinDomainIds))},error:m=>{u.dispatch(new s.bE(m))}})}generateGroupCode(u,l){u.patchState({generatingGroupCode:!0}),this.organizationsService.generateGroupCode(l.groupId).pipe((0,a.j)(()=>u.patchState({generatingGroupCode:!1}))).subscribe({next:m=>u.dispatch(new s.pv(m.group_code)),error:m=>u.dispatch(new s.cz(m))})}generateGroupCodeSuccess(u,l){const m={...u.getState().organization,group_code:l.groupCode};u.patchState({organization:m})}constructor(u,l,m,C){this.organizationsService=u,this.publishService=l,this.vendorAnalyticsService=m,this.productService=C}static#e=this.\u0275fac=function(l){return new(l||Ps)(p.KVO(c.k),p.KVO(P.D),p.KVO(f.e),p.KVO(i.b))};static#t=this.\u0275prov=p.jDH({token:Ps,factory:Ps.\u0275fac})};h([(0,e.rc)(s.A6),o("design:type",Function),o("design:paramtypes",[Object,s.A6]),o("design:returntype",void 0)],r.prototype,"selectOrganization",null),h([(0,e.rc)(s.Fy),o("design:type",Function),o("design:paramtypes",[Object,s.Fy]),o("design:returntype",void 0)],r.prototype,"setOrganizations",null),h([(0,e.rc)(s._q),o("design:type",Function),o("design:paramtypes",[Object,s._q]),o("design:returntype",void 0)],r.prototype,"getCollections",null),h([(0,e.rc)(s.dl),o("design:type",Function),o("design:paramtypes",[Object,s.dl]),o("design:returntype",void 0)],r.prototype,"getCollectionsSuccess",null),h([(0,e.rc)(s.B4),o("design:type",Function),o("design:paramtypes",[Object,s.B4]),o("design:returntype",void 0)],r.prototype,"selectCollection",null),h([(0,e.rc)(s.qS),o("design:type",Function),o("design:paramtypes",[Object,s.qS]),o("design:returntype",void 0)],r.prototype,"addCollection",null),h([(0,e.rc)(s.dD),o("design:type",Function),o("design:paramtypes",[Object,s.dD]),o("design:returntype",void 0)],r.prototype,"addCollectionSuccess",null),h([(0,e.rc)(s.kW),o("design:type",Function),o("design:paramtypes",[Object,s.kW]),o("design:returntype",void 0)],r.prototype,"addCollectionError",null),h([(0,e.rc)(s.T1),o("design:type",Function),o("design:paramtypes",[Object,s.T1]),o("design:returntype",void 0)],r.prototype,"removeCollection",null),h([(0,e.rc)(s.ob),o("design:type",Function),o("design:paramtypes",[Object,s.ob]),o("design:returntype",void 0)],r.prototype,"removeCollectionSuccess",null),h([(0,e.rc)(s.Rk),o("design:type",Function),o("design:paramtypes",[Object,s.Rk]),o("design:returntype",void 0)],r.prototype,"removeCollectionError",null),h([(0,e.rc)(s.ks),o("design:type",Function),o("design:paramtypes",[Object,s.ks]),o("design:returntype",void 0)],r.prototype,"setCollectionRenameMode",null),h([(0,e.rc)(s.jK),o("design:type",Function),o("design:paramtypes",[Object,s.jK]),o("design:returntype",void 0)],r.prototype,"renameCollection",null),h([(0,e.rc)(s.qd),o("design:type",Function),o("design:paramtypes",[Object,s.qd]),o("design:returntype",void 0)],r.prototype,"renameCollectionSuccess",null),h([(0,e.rc)(s.BD),o("design:type",Function),o("design:paramtypes",[Object,s.BD]),o("design:returntype",void 0)],r.prototype,"renameCollectionError",null),h([(0,e.rc)(s.hu),o("design:type",Function),o("design:paramtypes",[Object,s.hu]),o("design:returntype",void 0)],r.prototype,"reorderCollections",null),h([(0,e.rc)(s.Yn),o("design:type",Function),o("design:paramtypes",[Object,s.Yn]),o("design:returntype",void 0)],r.prototype,"reorderCollectionsSuccess",null),h([(0,e.rc)(s.QB),o("design:type",Function),o("design:paramtypes",[Object,s.QB]),o("design:returntype",void 0)],r.prototype,"resetOrganizations",null),h([(0,e.rc)(s.ul),o("design:type",Function),o("design:paramtypes",[Object,s.ul]),o("design:returntype",void 0)],r.prototype,"createOrganization",null),h([(0,e.rc)(s.nB),o("design:type",Function),o("design:paramtypes",[Object]),o("design:returntype",void 0)],r.prototype,"createOrganizationSuccess",null),h([(0,e.rc)(s.cw),o("design:type",Function),o("design:paramtypes",[Object,s.cw]),o("design:returntype",void 0)],r.prototype,"createOrganizationFail",null),h([(0,e.rc)(s.Lo),o("design:type",Function),o("design:paramtypes",[Object,s.Lo]),o("design:returntype",void 0)],r.prototype,"updateOrganization",null),h([(0,e.rc)(s.$7),o("design:type",Function),o("design:paramtypes",[Object,s.$7]),o("design:returntype",void 0)],r.prototype,"deleteOrganization",null),h([(0,e.rc)(s.LJ),o("design:type",Function),o("design:paramtypes",[Object,s.LJ]),o("design:returntype",void 0)],r.prototype,"getOrganizationProfile",null),h([(0,e.rc)(s._o),o("design:type",Function),o("design:paramtypes",[Object,s._o]),o("design:returntype",void 0)],r.prototype,"getOrganizationProfileSuccess",null),h([(0,e.rc)(s.Ot),o("design:type",Function),o("design:paramtypes",[Object,s.Ot]),o("design:returntype",void 0)],r.prototype,"clearOrganizationProfile",null),h([(0,e.rc)(s.O4),o("design:type",Function),o("design:paramtypes",[Object,s.O4]),o("design:returntype",void 0)],r.prototype,"getJoinDomains",null),h([(0,e.rc)(s.fA),o("design:type",Function),o("design:paramtypes",[Object,s.fA]),o("design:returntype",void 0)],r.prototype,"getJoinDomainsSuccess",null),h([(0,e.rc)(s.OG),o("design:type",Function),o("design:paramtypes",[Object,s.OG]),o("design:returntype",void 0)],r.prototype,"postJoinDomains",null),h([(0,e.rc)(s.DM),o("design:type",Function),o("design:paramtypes",[Object,s.DM]),o("design:returntype",void 0)],r.prototype,"deleteJoinDomains",null),h([(0,e.rc)(s.eS),o("design:type",Function),o("design:paramtypes",[Object,s.eS]),o("design:returntype",void 0)],r.prototype,"generateGroupCode",null),h([(0,e.rc)(s.pv),o("design:type",Function),o("design:paramtypes",[Object,s.pv]),o("design:returntype",void 0)],r.prototype,"generateGroupCodeSuccess",null),h([(0,e.MD)(),o("design:type",Function),o("design:paramtypes",[t]),o("design:returntype",void 0)],r,"getOrganizations",null),h([(0,e.MD)(),o("design:type",Function),o("design:paramtypes",[t]),o("design:returntype",void 0)],r,"getOrganization",null),h([(0,e.MD)(),o("design:type",Function),o("design:paramtypes",[t]),o("design:returntype",String)],r,"getOrganizationLogo",null),h([(0,e.MD)(),o("design:type",Function),o("design:paramtypes",[t]),o("design:returntype",void 0)],r,"getSelectedOrganization",null),h([(0,e.MD)(),o("design:type",Function),o("design:paramtypes",[t]),o("design:returntype",String)],r,"getSelectedOrganizationProductAccountId",null),h([(0,e.MD)(),o("design:type",Function),o("design:paramtypes",[t]),o("design:returntype",void 0)],r,"getOrganizationProfile",null),h([(0,e.MD)(),o("design:type",Function),o("design:paramtypes",[t]),o("design:returntype",void 0)],r,"getOrganizationGroupAttributes",null),h([(0,e.MD)(),o("design:type",Function),o("design:paramtypes",[t]),o("design:returntype",Array)],r,"getOrganizationAccountSettings",null),h([(0,e.MD)([r,g.k]),o("design:type",Function),o("design:paramtypes",[t,Object]),o("design:returntype",void 0)],r,"getDefaultUserRole",null),h([(0,e.MD)(),o("design:type",Function),o("design:paramtypes",[t]),o("design:returntype",void 0)],r,"getOrganizationGroupCode",null),h([(0,e.MD)(),o("design:type",Function),o("design:paramtypes",[t]),o("design:returntype",void 0)],r,"getCollections",null),h([(0,e.MD)(),o("design:type",Function),o("design:paramtypes",[t]),o("design:returntype",void 0)],r,"getSelectedCollection",null),h([(0,e.MD)(),o("design:type",Function),o("design:paramtypes",[t]),o("design:returntype",void 0)],r,"getReorderingCollections",null),h([(0,e.MD)(),o("design:type",Function),o("design:paramtypes",[t]),o("design:returntype",void 0)],r,"getAddingCollection",null),h([(0,e.MD)(),o("design:type",Function),o("design:paramtypes",[t]),o("design:returntype",void 0)],r,"getRemovingCollection",null),h([(0,e.MD)(),o("design:type",Function),o("design:paramtypes",[t]),o("design:returntype",void 0)],r,"getUpdatingCollection",null),h([(0,e.MD)(),o("design:type",Function),o("design:paramtypes",[t]),o("design:returntype",void 0)],r,"getCollectionRenaming",null),h([(0,e.MD)(),o("design:type",Function),o("design:paramtypes",[t]),o("design:returntype",void 0)],r,"getGeneratingGroupCode",null),h([(0,e.MD)(),o("design:type",Function),o("design:paramtypes",[t]),o("design:returntype",void 0)],r,"getWidgetURL",null),h([(0,e.MD)(),o("design:type",Function),o("design:paramtypes",[t]),o("design:returntype",void 0)],r,"getWidgetOptions",null),h([(0,e.MD)(),o("design:type",Function),o("design:paramtypes",[t]),o("design:returntype",void 0)],r,"getAppFeatures",null),h([(0,e.MD)(),o("design:type",Function),o("design:paramtypes",[t]),o("design:returntype",void 0)],r,"getCreating",null),h([(0,e.MD)(),o("design:type",Function),o("design:paramtypes",[t]),o("design:returntype",void 0)],r,"getUpdating",null),h([(0,e.MD)(),o("design:type",Function),o("design:paramtypes",[t]),o("design:returntype",void 0)],r,"getDeleting",null),h([(0,e.MD)(),o("design:type",Function),o("design:paramtypes",[t]),o("design:returntype",void 0)],r,"getLoading",null),h([(0,e.MD)(),o("design:type",Function),o("design:paramtypes",[t]),o("design:returntype",void 0)],r,"getCollectionsLoading",null),h([(0,e.MD)(),o("design:type",Function),o("design:paramtypes",[t]),o("design:returntype",void 0)],r,"getLoadingJoinDomains",null),h([(0,e.MD)(),o("design:type",Function),o("design:paramtypes",[t]),o("design:returntype",void 0)],r,"getAddingJoinDomains",null),h([(0,e.MD)(),o("design:type",Function),o("design:paramtypes",[t]),o("design:returntype",void 0)],r,"getRemovingJoinDomains",null),h([(0,e.MD)(),o("design:type",Function),o("design:paramtypes",[t]),o("design:returntype",void 0)],r,"hasOrganization",null),h([(0,e.MD)(),o("design:type",Function),o("design:paramtypes",[t]),o("design:returntype",void 0)],r,"isTrial",null),h([(0,e.MD)(),o("design:type",Function),o("design:paramtypes",[t]),o("design:returntype",void 0)],r,"isSubscriptionExpired",null),h([(0,e.MD)(),o("design:type",Function),o("design:paramtypes",[t]),o("design:returntype",void 0)],r,"getSubscriptionEndDate",null),h([(0,e.MD)(),o("design:type",Function),o("design:paramtypes",[t]),o("design:returntype",Object)],r,"getExternalAccount",null),h([(0,e.MD)(),o("design:type",Function),o("design:paramtypes",[t]),o("design:returntype",void 0)],r,"isValidPaidSubscription",null),h([(0,e.MD)(),o("design:type",Function),o("design:paramtypes",[t]),o("design:returntype",void 0)],r,"getJoinDomains",null),h([(0,e.MD)(),o("design:type",Function),o("design:paramtypes",[t]),o("design:returntype",void 0)],r,"isZSpaceAccount",null),h([(0,e.MD)(),o("design:type",Function),o("design:paramtypes",[t]),o("design:returntype",Object)],r,"getOrganizationAddOns",null),r=h([(0,e.Uw)({name:"organizations",defaults:v}),o("design:paramtypes",[c.k,P.D,f.e,i.b])],r)},74988:(le,N,n)=>{"use strict";n.d(N,{Av:()=>a,Bg:()=>f,Dx:()=>P,EC:()=>t,Fg:()=>u,P2:()=>r,Q2:()=>s,SJ:()=>S,Un:()=>o,aC:()=>h,gG:()=>v,ie:()=>d,jN:()=>l,t6:()=>_,w2:()=>y});var e=n(97443);const t={title:"Desktop",type:"desktop",dimensions:{width:700,height:550},orientation:"vertical"},s={title:"Standard Aspect Ratio (4:3)",type:"aspectRatio",dimensions:{width:4,height:3,type:e.M.Responsive},orientation:"horizontal"},c={title:"Widescreen Aspect Ratio (16:9)",type:"aspectRatio",dimensions:{width:16,height:9,type:e.M.Responsive},orientation:"horizontal"},O={title:"Square Aspect Ratio (1:1)",type:"aspectRatio",dimensions:{width:1,height:1,type:e.M.Responsive},orientation:"horizontal"},P={...s,title:"Custom"},S={width:320,height:256},a={width:5120,height:2880},f=[s,c,O],y={title:"Medium",type:"desktop",dimensions:{width:700,height:550},orientation:"horizontal"},h=[{title:"Small",type:"desktop",dimensions:{width:480,height:320},orientation:"horizontal"},y,{title:"Large",type:"desktop",dimensions:{width:1920,height:1200},orientation:"horizontal"},{title:"Extra Large",type:"desktop",dimensions:{width:2560,height:1440},orientation:"horizontal"},{title:"Maximum",type:"desktop",dimensions:{width:5120,height:2880},orientation:"horizontal"}],o=300,v={width:300,height:300},d={width:5120,height:2880},r={width:u(v.width),height:u(v.height)},_={width:u(d.width),height:u(d.height)};function u(m,C=o,b=2){return parseFloat((m/C).toFixed(b))}function l(m,C=o){return m*o}},35379:(le,N,n)=>{"use strict";n.d(N,{K:()=>t,k:()=>e});var e=function(s){return s.Desktop="desktop",s.Tablet="tablet",s.Mobile="mobile",s}(e||{});const t={[e.Desktop]:"Desktop",[e.Tablet]:"iPad Pro 11",[e.Mobile]:"iPhone 8 Plus"}},56583:(le,N,n)=>{"use strict";n.d(N,{$:()=>c});var e=n(28722),t=n(96557),s=n(47125);class c{constructor(){this.background={colors:null},this.uiAnnotations=!1,this.uiAudio=!0,this.uiMedia=e.Y.Full,this.uiInfo=!0,this.uiFullscreen=!0,this.uiScrubber=!1,this.uiHelp=!0,this.uiBd="",this.loadRotate=null,this.initial={button:!1,handHint:!1,play:!1,summary:!1},this.disableScroll={alert:!1,overlay:!1},this.uiQuiz={mode:s.R.Enabled,number:void 0},this.autoLoad=!0,this.playthrough=!1,this.uiTour=!1,this.uiNav=!0,this.uiSearch=!0,this.uiTools=!0,this.uiUndo=!0,this.uiLabelList=!0,this.uiChapterList=!1,this.all=!1,this.collapseLabel=null,this.uiMenu=!0,this.uiAnatomyDescriptions=!0,this.uiAnatomyPronunciations=!0,this.uiTutorial=!1,this.uiLegend=!0,this.uiLoader=t.kF,this.uiWhiteboard=!0,this.uiVisibilityLayers=!0,this.uiSkinLayers=!0,this.uiAnatomyLabels=!0}}},40430:(le,N,n)=>{"use strict";n.d(N,{i:()=>i});var e=n(60177),t=n(92014),s=n(45189),c=n(21604),O=n(89417),P=n(68132),S=n(11562),a=n(9529),f=n(72026),E=n(54438);let y=(()=>{class g{static#e=this.\u0275fac=function(o){return new(o||g)};static#t=this.\u0275mod=E.$C({type:g});static#n=this.\u0275inj=E.G2t({imports:[e.MD,s.G,f.o,O.YN,O.X1]})}return g})(),i=(()=>{class g{static#e=this.\u0275fac=function(o){return new(o||g)};static#t=this.\u0275mod=E.$C({type:g});static#n=this.\u0275inj=E.G2t({imports:[e.MD,s.G,O.X1,c.G,S.YG,a.bU,y,t.rK.forFeature([P.F])]})}return g})()},16058:(le,N,n)=>{"use strict";n.d(N,{D:()=>V,Q:()=>R});var e=n(15877),t=n(46104),s=n(3266),c=n(56583),O=n(36110),P=n(32914),S=n(28577),a=n(21626),f=n(74988),E=n(49204),i=n(24418),g=n(12215),p=n(3287),h=n(47125),o=n(60177),v=n(65459),d=n(9632),r=n(4475),_=n(97443),u=n(37678),l=n.n(u),m=n(54438),C=n(81642),b=n(95416),R=function(W){return W.Single="share.widget.link",W.Bulk="share.widget.export",W}(R||{});const A={headers:new a.Lr({"Content-Type":"application/json; charset=utf-8"})},G=new c.$,k={id:"embedded-human",dimensions:f.EC.dimensions,fullScreen:!0};let V=(()=>{class W{constructor(x,z,I,D,L,Q,ie,se){this.http=x,this.cameraService=z,this.numberService=I,this.orgnanizationService=D,this.contentViewService=L,this.matSnackbar=Q,this.APP_BASE_URL=ie,this.VIEWER_BASE_URL=se}exportBookmarks(x,z,I,D,L,Q,ie,se,Z=!1,de=""){this.matSnackbar.open(`Exporting ${x.length} models to CSV...`);const ae=[{label:"Title",field:"title"},{label:"ID",field:"id"},{label:"Collection",field:"collection"},{label:"URL",field:"url"},{label:"iFrame",field:"iFrame"},{label:"Author",field:"author"},{label:"Thumbnail URL",field:"thumbnail_url"},{label:"Created Date",field:"create_date_time"},{label:"Updated Date",field:"update_date_time"}];Z&&ae.push({label:"Offline Package URL",field:"offline_url"});const q=se?(0,e.of)(null):this.getUAID(R.Bulk),K=Z?this.getDownloadURLs(x):(0,e.of)([]),j=new Map,M=I.length?(0,t.p)(I.map($=>this.orgnanizationService.getCollectionContent(z,$.collection_id,"",ie).pipe((0,O.T)(ce=>{ce.forEach(re=>{j.set(re.id,$)})})))):(0,e.of)(!0);return(0,t.p)([q,K,M]).pipe((0,O.T)(([$,ce])=>x.map((re,ue)=>{const{id:H,title:te,author:F,thumbnail_url:w,create_date_time:X,update_date_time:oe}=re,Y=j.get(re.id)?.collection_name??"",he=this.getWidgetURL(re,D,L,null,$,ie,se,de),ne=this.getWidgetEmbed(he,Q),_e=this.buildThumbnailURL(w),Ce=ce[ue]||"";return{title:te,id:H,collection:Y,url:he,iFrame:ne,author:F,thumbnail_url:_e,create_date_time:(0,o.Yq)(new Date(X),"shortDate","en"),update_date_time:(0,o.Yq)(new Date(oe),"shortDate","en"),offline_url:Ce}})),(0,P.n)($=>(0,p.H)($,ae)),(0,P.n)($=>{const re=`BioDigital-Widgets-${(new Date).toISOString().split("T")[0]}-export.csv`,ue=new Blob([$],{type:"text/csv;charset=utf-8"});return l()(ue,re),(0,e.of)(!0)}))}generateWidgetURL(x,z,I,D,L,Q,ie,se){const Z=ie||!L?(0,e.of)(null):this.getUAID(L);return(0,t.p)([Z,this.contentViewService.trackContentPublish(x.id,x.type)]).pipe((0,O.T)(([de])=>this.getWidgetURL(x,z,I,D,de,Q,ie,se)))}getWidgetURL(x,z,I,D,L,Q="en",ie,se){I=I||G;const Z="bookmark"===x.type,de={};de[Z?"id":"m"]=`${Z?x.id:x.module_name}`;const K={...de,...this.getParamsForUIOptions(I||G),...this.getParamsForLoadingExperience(I||G),...this.getParamsForScrollMode(I||G),...this.getParamsForLoadRotate(I||G),...this.getParamsForLabelScale(I||G)},j=(0,E.get)(I,"background.colors");if(Array.isArray(j)&&j.length>=3){const $=j.slice(0,4).map(ce=>this.numberService.roundNumber(ce,3));K["background.colors"]=`${$}`}if(D){const{eye:$,look:ce,up:re}=this.cameraService.roundCamera(D,3);K.camera=`${[$.x,$.y,$.z,ce.x,ce.y,ce.z,re.x,re.y,re.z]}`}ie?K.dk=ie.app_apikey:L&&(K.uaid=L),Q&&"en"!==Q&&(K.lang=Q),se&&(K.paid=se);const M=this.isCustomWidget(x.embed_url_path)?x.embed_url_path:z;return this.buildWidgetURL(M,K)}generateWidgetEmbed(x,z,I,D,L,Q,ie,se,Z){return this.generateWidgetURL(x,z,I,L,Q,ie,se,Z).pipe((0,O.T)(de=>this.getWidgetEmbed(de,D)))}getWidgetEmbed(x,z){const{width:I,height:D,type:L}=z||k.dimensions;let Q="";return Q=L===_.M.Responsive?`style="aspect-ratio: ${I} / ${D}; width: 100%"`:`width="${I}" height="${D}"`,`<iframe id="${k.id}" frameBorder="0" ${Q} allowFullScreen="${k.fullScreen}" loading="lazy" src="${x}"></iframe>`}getImageEmbed(x,z,I){const D=`BioDigital Human: ${x}`.replace(/"/g,"&quot;");return`<a href="${z}" target="_blank"><img src="${I}" alt="${D}" title="${D}" /></a>`}getUAID(x){return this.http.post("/ws/user/analytics",{analytic_type:`${x}`,analytic_platform:"app"},A).pipe((0,O.T)(I=>I.id))}getDownloadURLs(x){const z=x.filter(I=>!I.favorite&&!I.unavailable).map(I=>({type:I.type,id:"module"===I.type?I.module_name:I.id}));return this.http.post("/ws/download/reserve",{content:z},{headers:{"Content-Type":"application/json"}}).pipe((0,O.T)(I=>{const D=I.tokens;return x.map(L=>{const Q=L.type,ie="module"===L.type?L.module_name:L.id,se=D.find(Z=>Z.type===Q&&Z.id===ie);return se&&se.token?this.buildDownloadURL(se.token):""})}),(0,S.W)(()=>(0,e.of)(x.map(()=>""))))}extendWidgetOptions(x,z){const I=this.expandWidgetOptions(z);return this.deepExtendWidgetOptions(x,I),x}getWidgetConfig(x){const z={};return Object.keys(x).forEach(D=>{const L=x[D];if(null!==L){const Q=this.getConfigName(D);z[Q]=L}}),z}getConfigName(x){const I=this.camelToDashCase(x).replace(/^ui-/g,"");return this.dashCaseToCamelCase(I)}getParamsForLoadingExperience(x){const z={};return x.autoLoad||(z["auto-load"]=!1),x.initial.button?z["initial.button"]=!0:x.initial.handHint?z["initial.hand"]=!0:x.initial.play?z["initial.play"]=!0:x.initial.summary?z["initial.summary"]=!0:z["initial.none"]=!0,x.playthrough&&(z.playthrough=!0),z}getParamsForScrollMode(x){return x.disableScroll.alert?{"disable-scroll.alert":!0}:x.disableScroll.overlay?{"disable-scroll":!0}:{"disable-scroll":!1}}getParamsForLoadRotate(x){return"number"==typeof x.loadRotate?{"load-rotate":x.loadRotate}:{}}getParamsForLabelScale(x){return{}}getParamsForUIOptions(x){return{"ui-anatomy-descriptions":x.uiAnatomyDescriptions,"ui-anatomy-pronunciations":x.uiAnatomyPronunciations,"ui-anatomy-labels":x.uiAnatomyLabels,"ui-audio":x.uiAudio,"ui-chapter-list":x.uiChapterList,"ui-fullscreen":x.uiFullscreen,"ui-help":x.uiHelp,"ui-info":x.uiInfo,"ui-label-list":x.uiLabelList,"ui-layers":x.uiVisibilityLayers,"ui-skin-layers":x.uiSkinLayers,"ui-loader":x.uiLoader,"ui-media-controls":x.uiMedia,"ui-menu":x.uiMenu,"ui-nav":x.uiNav,"ui-search":x.uiSearch,"ui-tools":x.uiTools,"ui-tutorial":x.uiTutorial,"ui-undo":x.uiUndo,"ui-whiteboard":x.uiWhiteboard,...this.getParamsForUIQuiz(x)}}getParamsForUIQuiz(x){const z={},I=(0,E.get)(x,"uiQuiz.mode"),D=(0,E.get)(x,"uiQuiz.number");return I===h.R.Disabled&&(z["ui-quiz"]=!1),I===h.R.Locked&&(z["ui-quiz-locked"]=!0),(0,E.isNil)(D)||(z["ui-quiz-start"]=D,z["ui-quiz-end"]=D),z}camelToDashCase(x){return x.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}dashCaseToCamelCase(x){return x.replace(/-([a-z])/g,z=>z[1].toUpperCase())}isCustomWidget(x){return/widgets\/([^\/]+)\//.test(x)}saveUserImage(x,z="jpeg"){return this.http.post("/ws/user/image/v1-0",{image_src:x,image_type:z},A).pipe((0,O.T)(I=>I.url))}buildWidgetURL(x,z){const I=Object.entries(z).map(([L,Q])=>`${L}=${Q}`).join("&");let D=x.replace(/^\/|\/$/g,"");return!1===z["auto-load"]&&"viewer"===D&&(D="tiny-viewer"),i.c.deploy===g.Z.Local?`${this.VIEWER_BASE_URL}/?${I}`:`${this.APP_BASE_URL}/${D}/?${I}`}buildThumbnailURL(x){return`${this.APP_BASE_URL}${x}`}buildDownloadURL(x){return`${this.APP_BASE_URL}/download?t=${x}`}deepExtendWidgetOptions(x,z){Object.entries(x).forEach(([I,D])=>{const L=typeof D;[I,this.camelToDashCase(I),this.getConfigName(I)].forEach(ie=>{if(z.hasOwnProperty(ie)&&null!==z[ie]){const se=z[ie];null===D?x[I]=se:L===typeof se&&("object"===L?this.deepExtendWidgetOptions(D,se):x[I]=se)}})})}expandWidgetOptions(x){const z={};return Object.entries(x).forEach(([I,D])=>{const L=I.split(".");if(L.length>1){const Q=L[0],ie=L.slice(1).join(".");(null===z[Q]||"object"!=typeof z[Q])&&(z[Q]={}),z[Q][ie]=D}else z[I]=x[I]}),z}static#e=this.\u0275fac=function(z){return new(z||W)(m.KVO(a.Qq),m.KVO(s.j),m.KVO(C.D),m.KVO(v.k),m.KVO(r.K),m.KVO(b.UG),m.KVO(d.ar),m.KVO(d.jw))};static#t=this.\u0275prov=m.jDH({token:W,factory:W.\u0275fac,providedIn:"root"})}return W})()},94528:(le,N,n)=>{"use strict";n.d(N,{$A:()=>f,D4:()=>S,DU:()=>g,F0:()=>o,H:()=>y,Iz:()=>i,LD:()=>O,LI:()=>t,M:()=>a,PE:()=>e,SJ:()=>v,YJ:()=>p,_T:()=>P,id:()=>E,kS:()=>c,yX:()=>h});let e=(()=>{class d{static#e=this.type="[Publish] Set Widget URL";constructor(_){this.widgetURL=_}}return d})(),t=(()=>{class d{static#e=this.type="[Publish] Set Dimensions";constructor(_){this.dimensions=_}}return d})(),c=(()=>{class d{static#e=this.type="[Publish] Get iFrame";constructor(_,u,l,m){this.model=_,this.widgetOptions=u,this.camera=l,this.dimensions=m}}return d})(),O=(()=>{class d{static#e=this.type="[Publish] Get iFrame Success";constructor(_){this.embed=_}}return d})(),P=(()=>{class d{static#e=this.type="[Publish] Get iFrame Fail";constructor(){}}return d})(),S=(()=>{class d{static#e=this.type="[Publish] Get URL";constructor(_,u,l){this.model=_,this.widgetOptions=u,this.camera=l}}return d})(),a=(()=>{class d{static#e=this.type="[Publish] Get URL Success";constructor(_,u){this.model=_,this.url=u}}return d})(),f=(()=>{class d{static#e=this.type="[Publish] Get URL Fail";constructor(_){this.model=_}}return d})(),E=(()=>{class d{static#e=this.type="[Publish] Set Publishing";constructor(_){this.publishing=_}}return d})(),y=(()=>{class d{static#e=this.type="[Publish] Reset Publishing";constructor(){}}return d})(),i=(()=>{class d{static#e=this.type="[Publish] Save Publish Image";constructor(_,u="jpeg"){this.imageData=_,this.imageType=u}}return d})(),g=(()=>{class d{static#e=this.type="[Publish] Save Publish Image Success";constructor(_){this.imageURL=_}}return d})(),p=(()=>{class d{static#e=this.type="[Publish] Save Publish Image Fail";constructor(){}}return d})(),h=(()=>{class d{static#e=this.type="[Publish] Get Publish Image Code";constructor(_,u,l,m,C){this.model=_,this.imageData=u,this.fileType=l,this.widgetOptions=m,this.camera=C}}return d})(),o=(()=>{class d{static#e=this.type="[Publish] Get Publish Image Code Success";constructor(_){this.embed=_}}return d})(),v=(()=>{class d{static#e=this.type="[Publish] Get Publish Image Code Fail";constructor(){}}return d})()},68132:(le,N,n)=>{"use strict";n.d(N,{F:()=>o,f:()=>h});var e=n(92014);class t{}var s=n(94528),c=n(16058),O=n(74988),P=n(16823),S=n(46104),a=n(95416),f=n(21424),E=n(59e3),y=n(54438),i=function(v,d,r,_){var m,u=arguments.length,l=u<3?d:null===_?_=Object.getOwnPropertyDescriptor(d,r):_;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(v,d,r,_);else for(var C=v.length-1;C>=0;C--)(m=v[C])&&(l=(u<3?m(l):u>3?m(d,r,l):m(d,r))||l);return u>3&&l&&Object.defineProperty(d,r,l),l},g=function(v,d){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(v,d)};const p="/viewer",h={publishing:!1,widgetURL:p,dimensions:O.EC.dimensions,minDimensions:{width:300,height:400},aspectRatio:{width:4,height:3}};let o=class Ms{static getDimensions(d){return d.dimensions}static getAspectRatio(d){return d.aspectRatio}static getMinDimensions(d){return d.minDimensions}static getWidgetURL(d){return d.widgetURL}static getPublishing(d){return d.publishing}setPublishWidgetURL(d,r){d.patchState({widgetURL:r.widgetURL||p})}setPublishDimensions(d,r){d.patchState({dimensions:r.dimensions})}getPublishURL(d,r){const{model:_,camera:u,widgetOptions:l}=r,{widgetURL:m}=d.getState(),C=this.store.selectSnapshot(P.k.getUserLanguage),b=this.store.selectSnapshot(P.k.getSelectedUserApp),R=this.store.selectSnapshot(f.q.getSelectedOrganizationProductAccountId);this.publishService.generateWidgetURL(_,m,l,u,c.Q.Single,C,b,R).subscribe(A=>{d.dispatch(new s.M(_,A))},()=>{d.dispatch(new s.$A(_))})}getPublishURLSuccess(d,r){this.vendorAnalyticsService.track("Publish - Success",{type:"url",source:"publish"})}getPublishURLFail(d,r){this.snackbar.open("Unable to generate URL.")}getPublishIFrame(d,r){const{model:_,camera:u,widgetOptions:l}=r,m=d.getState(),C=m.widgetURL,b=r.dimensions??m.dimensions,R=this.store.selectSnapshot(P.k.getUserLanguage),A=this.store.selectSnapshot(P.k.getSelectedUserApp),G=this.store.selectSnapshot(f.q.getSelectedOrganizationProductAccountId);this.publishService.generateWidgetEmbed(_,C,l,b,u,c.Q.Single,R,A,G).subscribe(k=>{d.dispatch(new s.LD(k))},()=>{d.dispatch(new s._T)})}setPublishIFrameSuccess(d,r){this.vendorAnalyticsService.track("Publish - Success",{type:"iframe",source:"publish"})}savePublishImage(d,{imageData:r,imageType:_}){this.publishService.saveUserImage(r,_).subscribe(u=>{d.dispatch(new s.DU(u))},()=>{d.dispatch(new s.YJ)})}savePublishImageSuccess(d,r){this.vendorAnalyticsService.track("Publish - Success",{type:"image",source:"publish"})}getPublishImage(d,r){const{model:_,camera:u,widgetOptions:l,imageData:m,fileType:C}=r,{widgetURL:b}=d.getState(),R=this.store.selectSnapshot(P.k.getUserLanguage),A=this.store.selectSnapshot(P.k.getSelectedUserApp);(0,S.p)(this.publishService.generateWidgetURL(_,b,l,u,c.Q.Single,R,A),this.publishService.saveUserImage(m,C)).subscribe(([G,k])=>{const V=this.publishService.getImageEmbed(_.title,G,k);d.dispatch(new s.F0(V))},()=>{d.dispatch(new s.SJ)})}setPublishing(d,{publishing:r}){d.patchState({publishing:r})}resetPublish(d,r){d.setState(h)}constructor(d,r,_,u){this.publishService=d,this.store=r,this.snackbar=_,this.vendorAnalyticsService=u}static#e=this.\u0275fac=function(r){return new(r||Ms)(y.KVO(c.D),y.KVO(e.il),y.KVO(a.UG),y.KVO(E.e))};static#t=this.\u0275prov=y.jDH({token:Ms,factory:Ms.\u0275fac})};i([(0,e.rc)(s.PE),g("design:type",Function),g("design:paramtypes",[Object,s.PE]),g("design:returntype",void 0)],o.prototype,"setPublishWidgetURL",null),i([(0,e.rc)(s.LI),g("design:type",Function),g("design:paramtypes",[Object,s.LI]),g("design:returntype",void 0)],o.prototype,"setPublishDimensions",null),i([(0,e.rc)(s.D4),g("design:type",Function),g("design:paramtypes",[Object,s.D4]),g("design:returntype",void 0)],o.prototype,"getPublishURL",null),i([(0,e.rc)(s.M),g("design:type",Function),g("design:paramtypes",[Object,s.M]),g("design:returntype",void 0)],o.prototype,"getPublishURLSuccess",null),i([(0,e.rc)(s.$A),g("design:type",Function),g("design:paramtypes",[Object,s.$A]),g("design:returntype",void 0)],o.prototype,"getPublishURLFail",null),i([(0,e.rc)(s.kS),g("design:type",Function),g("design:paramtypes",[Object,s.kS]),g("design:returntype",void 0)],o.prototype,"getPublishIFrame",null),i([(0,e.rc)(s.LD),g("design:type",Function),g("design:paramtypes",[Object,s.LD]),g("design:returntype",void 0)],o.prototype,"setPublishIFrameSuccess",null),i([(0,e.rc)(s.Iz),g("design:type",Function),g("design:paramtypes",[Object,s.Iz]),g("design:returntype",void 0)],o.prototype,"savePublishImage",null),i([(0,e.rc)(s.DU),g("design:type",Function),g("design:paramtypes",[Object,s.DU]),g("design:returntype",void 0)],o.prototype,"savePublishImageSuccess",null),i([(0,e.rc)(s.yX),g("design:type",Function),g("design:paramtypes",[Object,s.yX]),g("design:returntype",void 0)],o.prototype,"getPublishImage",null),i([(0,e.rc)(s.id),g("design:type",Function),g("design:paramtypes",[Object,s.id]),g("design:returntype",void 0)],o.prototype,"setPublishing",null),i([(0,e.rc)(s.H),g("design:type",Function),g("design:paramtypes",[Object,s.H]),g("design:returntype",void 0)],o.prototype,"resetPublish",null),i([(0,e.MD)(),g("design:type",Function),g("design:paramtypes",[t]),g("design:returntype",void 0)],o,"getDimensions",null),i([(0,e.MD)(),g("design:type",Function),g("design:paramtypes",[t]),g("design:returntype",void 0)],o,"getAspectRatio",null),i([(0,e.MD)(),g("design:type",Function),g("design:paramtypes",[t]),g("design:returntype",void 0)],o,"getMinDimensions",null),i([(0,e.MD)(),g("design:type",Function),g("design:paramtypes",[t]),g("design:returntype",void 0)],o,"getWidgetURL",null),i([(0,e.MD)(),g("design:type",Function),g("design:paramtypes",[t]),g("design:returntype",void 0)],o,"getPublishing",null),o=i([(0,e.Uw)({name:"publish",defaults:h}),g("design:paramtypes",[c.D,e.il,a.UG,E.e])],o)},57743:(le,N,n)=>{"use strict";n.d(N,{w:()=>g});var e=n(54438),t=n(89417),s=n(49204),O=n(85052),P=n(37925),S=n(49206),a=n(60177),f=n(72026),E=n(26779);function y(p,h){if(1&p&&(e.j41(0,"option",9),e.EFF(1),e.k0s()),2&p){const o=h.$implicit;e.Y8G("value",o.value),e.R7$(),e.SpI(" ",o.label.title," ")}}function i(p,h){if(1&p&&(e.j41(0,"select",6)(1,"option",7),e.EFF(2,"Select"),e.k0s(),e.DNE(3,y,2,2,"option",8),e.k0s()),2&p){const o=e.XpG();e.R7$(3),e.Y8G("ngForOf",o.options)}}let g=(()=>{class p extends S.n{get options(){return this._options}set options(o){const v=(0,s.clone)(o);this._options=v.sort((d,r)=>d.label.title.localeCompare(r.label.title)),this.changeRef.markForCheck()}constructor(o,v){super(),this.formBuilder=o,this.changeRef=v,this.outline=!0,this.valueChange=new e.bkB,this.ngUnsubscribe=new O.B,this.form=this.formBuilder.group({value:[""]}),this.valueControl=this.form.get("value")}ngOnInit(){this.initFormListeners()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initFormListeners(){this.form.valueChanges.pipe((0,P.Q)(this.ngUnsubscribe)).subscribe(({value:o})=>{this.writeValue(o),this.valueChange.next(o)})}setDisabledState(o){super.setDisabledState(o),o?this.form.disable():this.form.enable(),this.changeRef.markForCheck()}setFormValues(o){this.valueControl.setValue(o),this.changeRef.markForCheck()}getSelectedOption(){const o=this.valueControl.value;return this.options.find(v=>v.value===o)}static#e=this.\u0275fac=function(v){return new(v||p)(e.rXU(t.ze),e.rXU(e.gRc))};static#t=this.\u0275cmp=e.VBU({type:p,selectors:[["app-quiz-label-anatomy-select"]],inputs:{options:"options",outline:"outline"},outputs:{valueChange:"valueChange"},standalone:!0,features:[e.Jv_([{provide:t.kq,useExisting:(0,e.Rfq)(()=>p),multi:!0}]),e.Vt3,e.aNF],decls:7,vars:5,consts:[[1,"label",3,"formGroup"],[1,"flex","text-xs","label__select-label"],[1,"flex","justify-between","flex-auto","p-2"],[1,"mr-2"],["icon","caret-down","size","lg"],["class","input label__select","placeholder","Select Option","formControlName","value","data-test","quizLabelSelect",4,"ngIf"],["placeholder","Select Option","formControlName","value","data-test","quizLabelSelect",1,"input","label__select"],["value","","data-test","questionAnswerOption"],["class","label__option","data-test","questionAnswerOption",3,"value",4,"ngFor","ngForOf"],["data-test","questionAnswerOption",1,"label__option",3,"value"]],template:function(v,d){if(1&v&&(e.j41(0,"div",0)(1,"label",1)(2,"div",2)(3,"div",3),e.EFF(4),e.k0s(),e.nrm(5,"app-icon",4),e.k0s(),e.DNE(6,i,4,1,"select",5),e.k0s()()),2&v){let r;e.AVh("label--empty",""===d.valueControl.value),e.Y8G("formGroup",d.form),e.R7$(4),e.JRh((null==(r=d.getSelectedOption())||null==r.label?null:r.label.title)||"Select"),e.R7$(2),e.Y8G("ngIf",!d.disabled)}},dependencies:[a.MD,a.Sq,a.bT,t.YN,t.xH,t.y7,t.wz,t.BC,t.cb,t.X1,t.j4,t.JD,f.o,E.R],styles:[".label[_ngcontent-%COMP%]{overflow:hidden}.label__select-label[_ngcontent-%COMP%]{color:#101823;position:relative}.label__select[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;opacity:.01}.label--empty[_ngcontent-%COMP%]   .label__select-label[_ngcontent-%COMP%]{color:#96a8c0}"],changeDetection:0})}return p})()},76774:(le,N,n)=>{"use strict";n.d(N,{Aw:()=>g,Br:()=>d,En:()=>f,Ie:()=>u,MH:()=>_,UB:()=>E,br:()=>i,qH:()=>a,tI:()=>y,z9:()=>p});var e=n(49204),s=n(59429),c=n(24151),O=n(69568),P=n(43753),S=n(65776);const a="Next Question";function f(m){const C=m.map(b=>(b.quizQuestions||[]).map(A=>({...A,chapterId:A.chapterId||b.id})));return[].concat(...C)}function E(m){const C={id:s.u.idWithPrefix("question"),chapterId:"",type:m,questionPrompt:[l()],data:{},explanation:[l()],nextLabel:"",showChapterLabels:!1,sceneConfig:{}};switch(m){case P.Q5.MultipleChoice:const b=[y(),y()];return{...C,data:{correctAnswer:b[0].value,options:b}};case P.Q5.SelectAnatomy:return{...C,data:{showAnswerList:!0,selectType:"all",correctAnswer:[]}};case P.Q5.LabelAnatomy:return{...C,data:{correctAnswer:[],options:[]}};case P.Q5.Instructions:return{...C}}}function y(m=""){return{value:s.u.idWithPrefix("question-option"),label:m}}function i(m){return{value:s.u.idWithPrefix("question-option"),label:m}}function g(m,C,b,R){const A=new O.ed(C.label);A.id=s.u.idWithPrefix("quiz-label"),A.chapterId=m;const G=A.hideWire?20:32;return A.title=(0,e.trim)(C.label),A.offset=[G,0],A.objectId=b.objectId,A.barycentric=[b.barycentric[0],b.barycentric[1],b.barycentric[2]],A.pos=[b.worldPos[0],b.worldPos[1],b.worldPos[2]],A.primitiveIndex=b.triIndex,A.renderableIndex=b.renderableIndex||0,A.dir=R,A.occludable=!0,A.shown=!0,A.pinType=c.O.Sequential,A}function p(m,C,b){return{...m,id:C,chapterId:b,data:h(m.type,m.data,b)}}function h(m,C,b){return m===P.Q5.LabelAnatomy?function o(m,C){return{...m,options:m.options.map(b=>({...b,label:{...b.label,chapterId:C}}))}}(C,b):(0,e.cloneDeep)(C)}function v(m){return"string"==typeof m.data.correctAnswer?[m.data.correctAnswer]:m.data.correctAnswer}function d(m,C){const b=v(m);switch(m.type){case P.Q5.LabelAnatomy:return(0,e.isEqual)(b,C);case P.Q5.MultipleChoice:return(0,e.isEqual)(b.sort(),C.sort());case P.Q5.SelectAnatomy:if(void 0===m.data.selectType||"all"===m.data.selectType)return(0,e.isEqual)(b.sort(),C.sort());if("any"===m.data.selectType)return 0===(0,e.difference)(C,b).length&&C.length>0}}function _(m,C){const b=m.filter(z=>z.type!==P.Q5.Instructions),R=m.reduce((z,I)=>(z[I.id]=function r(m,C){const b=m.find(R=>R.questionId===C);return b?b.answer:void 0}(C,I.id),z),{}),A=m.reduce((z,I)=>(z[I.id]=v(I),z),{}),G=b.filter(z=>{const I=R[z.id];return d(z,typeof I>"u"?[]:"string"==typeof I?[I]:I)}),k=m.length,V=b.length,W=G.length,T=k-W;return{score:k>0?Math.round(W/V*100):0,total:k,scorableTotal:V,correctTotal:W,incorrectTotal:T,questionAnswers:R,correctQuestionAnswers:A}}function u(m){switch((0,e.get)(m,"type","")){case P.Q5.MultipleChoice:const b=(0,e.get)(m,"data.correctAnswer","");return b&&""!==b;case P.Q5.SelectAnatomy:case P.Q5.LabelAnatomy:return(0,e.get)(m,"data.correctAnswer",[]).length>0;default:return!0}}function l(m=""){return{type:S.m.Markdown,markdown:m}}},24552:(le,N,n)=>{"use strict";n.d(N,{h:()=>e});var e=function(t){return t[t.Question=0]="Question",t[t.Explanation=1]="Explanation",t[t.Review=2]="Review",t}(e||{})},43753:(le,N,n)=>{"use strict";n.d(N,{Q5:()=>e,of:()=>t,sb:()=>s});var e=function(c){return c.MultipleChoice="multiple-choice",c.SelectAnatomy="select-anatomy",c.LabelAnatomy="label-anatomy",c.Instructions="text-only",c}(e||{});const t={[e.MultipleChoice]:"Multiple Choice",[e.SelectAnatomy]:"Select Anatomy in 3D",[e.LabelAnatomy]:"Label Anatomy",[e.Instructions]:"Instructions"},s={[e.MultipleChoice]:"Identify the correct answer from a list of options.",[e.SelectAnatomy]:"Identify the correct structure(s) in the 3D model",[e.LabelAnatomy]:"Correctly label each structure from a list of options",[e.Instructions]:"Use descriptive text to provide context between questions"}},42617:(le,N,n)=>{"use strict";n.d(N,{c:()=>a});var e=n(60177),t=n(92014),s=n(87710),c=n(57743),O=n(89417),P=n(72026),S=n(54438);let a=(()=>{class f{static#e=this.\u0275fac=function(i){return new(i||f)};static#t=this.\u0275mod=S.$C({type:f});static#n=this.\u0275inj=S.G2t({imports:[t.rK.forFeature([s.j]),e.MD,P.o,O.X1,c.w]})}return f})()},76016:(le,N,n)=>{"use strict";var e,t;n.d(N,{B:()=>e}),(t=e||(e={})).SetQuizState=(()=>{class m{static#e=this.type="[Quiz] Set Quiz State";constructor(b){this.quizState=b}}return m})(),t.ResetQuizState=(()=>{class m{static#e=this.type="[Quiz] Reset Quiz State";constructor(){}}return m})(),t.SetQuizSettings=(()=>{class m{static#e=this.type="[Quiz] Set Quiz Settings";constructor(b){this.quizSettings=b}}return m})(),t.SetQuizActive=(()=>{class m{static#e=this.type="[Quiz] Set Quiz Active";constructor(b){this.active=b}}return m})(),t.SetQuizLocked=(()=>{class m{static#e=this.type="[Quiz] Set Quiz Locked";constructor(b){this.locked=b}}return m})(),t.SetEnableQuizRetake=(()=>{class m{static#e=this.type="[Quiz] Set Enable Quiz Retake";constructor(b){this.enable=b}}return m})(),t.SetQuizQuestionsMode=(()=>{class m{static#e=this.type="[Quiz] Set Quiz Questions Mode";constructor(b){this.mode=b}}return m})(),t.ReorderQuestions=(()=>{class m{static#e=this.type="[Quiz] Reoder Quiz Questions";constructor(b){this.chapterIds=b}}return m})(),t.AddQuestion=(()=>{class m{static#e=this.type="[Quiz] Add Quiz Question";constructor(b){this.question=b}}return m})(),t.SetQuestions=(()=>{class m{static#e=this.type="[Quiz] Set Quiz Questions";constructor(b){this.questions=b}}return m})(),t.RemoveQuestions=(()=>{class m{static#e=this.type="[Quiz] Remove Quiz Questions";constructor(b){this.questionIds=b}}return m})(),t.SetQuestion=(()=>{class m{static#e=this.type="[Quiz] Set Quiz Question";constructor(b){this.question=b}}return m})(),t.SubmitQuestionAnswer=(()=>{class m{static#e=this.type="[Quiz] Submit Question Answer";constructor(b){this.submission=b}}return m})(),t.NextQuestion=(()=>{class m{static#e=this.type="[Quiz] Advance Question";constructor(){}}return m})(),t.PreviousQuestion=(()=>{class m{static#e=this.type="[Quiz] Previous Question";constructor(){}}return m})(),t.ClearSubmissions=(()=>{class m{static#e=this.type="[Quiz] Clear Submissions";constructor(){}}return m})(),t.SetActiveQuestion=(()=>{class m{static#e=this.type="[Quiz] Set Active Question";constructor(b){this.questionId=b}}return m})(),t.SetQuizPickMode=(()=>{class m{static#e=this.type="[Quiz] Set Pick Mode";constructor(b){this.pickMode=b}}return m})(),t.SetActiveSubmission=(()=>{class m{static#e=this.type="[Quiz] Set Active QuestionAnswer";constructor(b){this.submission=b}}return m})(),t.SetQuizLifecycle=(()=>{class m{static#e=this.type="[Quiz] Set Quiz Lifecycle";constructor(b){this.lifecycle=b}}return m})()},87710:(le,N,n)=>{"use strict";n.d(N,{W:()=>E,j:()=>v});var f,e=n(92014),t=n(76016),s=n(76774),c=n(43753),O=n(24552),P=n(54438),S=function(d,r,_,u){var C,l=arguments.length,m=l<3?r:null===u?u=Object.getOwnPropertyDescriptor(r,_):u;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)m=Reflect.decorate(d,r,_,u);else for(var b=d.length-1;b>=0;b--)(C=d[b])&&(m=(l<3?C(m):l>3?C(r,_,m):C(r,_))||m);return l>3&&m&&Object.defineProperty(r,_,m),m},a=function(d,r){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(d,r)},E=function(d){return d[d.Learning=0]="Learning",d[d.Assessment=1]="Assessment",d}(E||{});const i={quizModeActive:!1,quizModeLocked:!1,quizQuestionsMode:"all",enableQuizRetake:!0,launchMode:E.Learning,questions:[],activeQuestionId:void 0,activeSubmission:void 0,questionSubmissions:[],quizSettings:{enabled:!0,showSummary:!0,showExplanation:!0,showSubmit:!0,showProgress:!0},pickMode:"single",lifecycle:O.h.Question};function g(d,r){return d.filter(_=>_.chapterId===r)}function h(d,r){const _=r.map(l=>g(d,l));return[].concat(..._)}function o(d){const r=function p(d){return[...new Set(d.map(r=>r.chapterId))]}(d);return h(d,r)}let v=class Ts{static#e=f=this;static getQuizQuestionsByChapter(r){return(0,e.Mz)([f],_=>g(_.questions,r))}static getLifecycle(r){return r.lifecycle}static getQuizSettings(r){return r.quizSettings}static getQuizLaunchMode(r){return r.launchMode}static getQuizModeActive(r){return r.quizModeActive}static getQuizModeLocked(r){return r.quizModeLocked}static getEnableQuizRetake(r){return r.enableQuizRetake}static getQuizReviewEnabled(r){const{quizModeLocked:_,quizQuestionsMode:u,questions:l,quizSettings:m}=r;return!(_&&!m.showSummary||_&&"restricted"===u&&1===l.length)}static globalSceneConfig(r){return r.sceneConfig}static hasQuiz(r){return r.questions.length>0}static getQuizEnabled(r){return!1!==r.quizSettings.enabled}static getAllQuestions(r){return r.questions}static getAllSubmissions(r){return r.questionSubmissions}static getActiveSubmitted(r){const{questionSubmissions:_,activeQuestionId:u}=r;return _.find(l=>l.questionId===u)}static getActiveSubmission(r){return r.activeSubmission}static getActiveQuestion(r){return r.questions.find(_=>_.id===r.activeQuestionId)}static getActiveQuestionId(r){return r.activeQuestionId}static getActiveQuestionLabels(r){const _=r.questions.find(u=>u.id===r.activeQuestionId);return _&&_.type===c.Q5.LabelAnatomy?_.data.options:[]}static getActiveQuestionIndex(r){return r.questions.findIndex(_=>_.id===r.activeQuestionId)}static getQuestionIndex(r,_){return(0,e.Mz)([f],u=>h(u.questions,r).findIndex(l=>l.id===_))}static getQuestionTotal(r){return r.questions.length}static getCorrectAnswerTotal(r){const{questionSubmissions:_,questions:u}=r;return _.filter(m=>{const C=u.find(b=>b.id===m.questionId);return(0,s.Br)(C,m.answer)}).length}static getQuestionsRemaining(r){const{questions:_,questionSubmissions:u}=r;return _.length-u.length}static hasQuestionRemaining(r){const{questions:_,questionSubmissions:u}=r;return u.length<_.length}static getPickMode(r){return r.pickMode}resetQuizState(r,_){r.setState({...i})}setQuizState(r,{quizState:_}){r.setState({...i,..._})}setQuizSettings(r,{quizSettings:_}){r.patchState({quizSettings:_})}setQuizActive(r,_){r.patchState({quizModeActive:_.active,activeQuestionId:!1===_.active?void 0:r.getState().activeQuestionId})}setQuizLocked(r,_){r.patchState({quizModeLocked:_.locked})}setEnableQuizRetake(r,_){r.patchState({enableQuizRetake:_.enable})}setQuizQuestionsMode(r,_){r.patchState({quizQuestionsMode:_.mode})}reorderQuestions(r,{chapterIds:_}){r.patchState({questions:h(r.getState().questions,_)})}addQuestion(r,_){const u=[...r.getState().questions,_.question];r.patchState({questions:o(u)})}setQuestions(r,{questions:_}){r.patchState({questions:o(_)})}setQuestion(r,_){const u=r.getState().questions.map(l=>l.id===_.question.id?_.question:l);r.patchState({questions:u})}removeQuestions(r,_){const u=r.getState(),l=null!=_.questionIds?_.questionIds:u.questions.map(C=>C.id),m=u.questions.filter(C=>!l.includes(C.id));r.patchState({questions:o(m)})}submitQuestionAnswer(r,_){const u=[...r.getState().questionSubmissions],l=u.findIndex(C=>C.questionId===_.submission.questionId);l>-1?u[l]=_.submission:u.push(_.submission),r.patchState({questionSubmissions:u})}nextQuestion(r){const{questions:_,activeQuestionId:u}=r.getState(),l=r.getState().questions.findIndex(C=>C.id===u),m=_[l+1]?.id||void 0;void 0!==m&&r.patchState({activeQuestionId:m})}previousQuestion(r){const{questions:_,activeQuestionId:u}=r.getState(),l=r.getState().questions.findIndex(C=>C.id===u),m=_[l-1]?.id||void 0;void 0!==m&&r.patchState({activeQuestionId:m})}clearSubmissions(r){r.patchState({questionSubmissions:[]})}setActiveQuestion(r,_){r.patchState({activeQuestionId:_.questionId})}setQuizPickMode(r,{pickMode:_}){r.patchState({pickMode:_})}setActiveSubmission(r,{submission:_}){r.patchState({activeSubmission:_})}setQuizLifecycle(r,_){r.patchState({lifecycle:_.lifecycle})}static#t=this.\u0275fac=function(_){return new(_||Ts)};static#n=this.\u0275prov=P.jDH({token:Ts,factory:Ts.\u0275fac})};S([(0,e.rc)(t.B.ResetQuizState),a("design:type",Function),a("design:paramtypes",[Object,t.B.ResetQuizState]),a("design:returntype",void 0)],v.prototype,"resetQuizState",null),S([(0,e.rc)(t.B.SetQuizState),a("design:type",Function),a("design:paramtypes",[Object,t.B.SetQuizState]),a("design:returntype",void 0)],v.prototype,"setQuizState",null),S([(0,e.rc)(t.B.SetQuizSettings),a("design:type",Function),a("design:paramtypes",[Object,t.B.SetQuizSettings]),a("design:returntype",void 0)],v.prototype,"setQuizSettings",null),S([(0,e.rc)(t.B.SetQuizActive),a("design:type",Function),a("design:paramtypes",[Object,t.B.SetQuizActive]),a("design:returntype",void 0)],v.prototype,"setQuizActive",null),S([(0,e.rc)(t.B.SetQuizLocked),a("design:type",Function),a("design:paramtypes",[Object,t.B.SetQuizLocked]),a("design:returntype",void 0)],v.prototype,"setQuizLocked",null),S([(0,e.rc)(t.B.SetEnableQuizRetake),a("design:type",Function),a("design:paramtypes",[Object,t.B.SetEnableQuizRetake]),a("design:returntype",void 0)],v.prototype,"setEnableQuizRetake",null),S([(0,e.rc)(t.B.SetQuizQuestionsMode),a("design:type",Function),a("design:paramtypes",[Object,t.B.SetQuizQuestionsMode]),a("design:returntype",void 0)],v.prototype,"setQuizQuestionsMode",null),S([(0,e.rc)(t.B.ReorderQuestions),a("design:type",Function),a("design:paramtypes",[Object,t.B.ReorderQuestions]),a("design:returntype",void 0)],v.prototype,"reorderQuestions",null),S([(0,e.rc)(t.B.AddQuestion),a("design:type",Function),a("design:paramtypes",[Object,t.B.AddQuestion]),a("design:returntype",void 0)],v.prototype,"addQuestion",null),S([(0,e.rc)(t.B.SetQuestions),a("design:type",Function),a("design:paramtypes",[Object,t.B.SetQuestions]),a("design:returntype",void 0)],v.prototype,"setQuestions",null),S([(0,e.rc)(t.B.SetQuestion),a("design:type",Function),a("design:paramtypes",[Object,t.B.SetQuestion]),a("design:returntype",void 0)],v.prototype,"setQuestion",null),S([(0,e.rc)(t.B.RemoveQuestions),a("design:type",Function),a("design:paramtypes",[Object,t.B.RemoveQuestions]),a("design:returntype",void 0)],v.prototype,"removeQuestions",null),S([(0,e.rc)(t.B.SubmitQuestionAnswer),a("design:type",Function),a("design:paramtypes",[Object,t.B.SubmitQuestionAnswer]),a("design:returntype",void 0)],v.prototype,"submitQuestionAnswer",null),S([(0,e.rc)(t.B.NextQuestion),a("design:type",Function),a("design:paramtypes",[Object]),a("design:returntype",void 0)],v.prototype,"nextQuestion",null),S([(0,e.rc)(t.B.PreviousQuestion),a("design:type",Function),a("design:paramtypes",[Object]),a("design:returntype",void 0)],v.prototype,"previousQuestion",null),S([(0,e.rc)(t.B.ClearSubmissions),a("design:type",Function),a("design:paramtypes",[Object]),a("design:returntype",void 0)],v.prototype,"clearSubmissions",null),S([(0,e.rc)(t.B.SetActiveQuestion),a("design:type",Function),a("design:paramtypes",[Object,t.B.SetActiveQuestion]),a("design:returntype",void 0)],v.prototype,"setActiveQuestion",null),S([(0,e.rc)(t.B.SetQuizPickMode),a("design:type",Function),a("design:paramtypes",[Object,t.B.SetQuizPickMode]),a("design:returntype",void 0)],v.prototype,"setQuizPickMode",null),S([(0,e.rc)(t.B.SetActiveSubmission),a("design:type",Function),a("design:paramtypes",[Object,t.B.SetActiveSubmission]),a("design:returntype",void 0)],v.prototype,"setActiveSubmission",null),S([(0,e.rc)(t.B.SetQuizLifecycle),a("design:type",Function),a("design:paramtypes",[Object,t.B.SetQuizLifecycle]),a("design:returntype",void 0)],v.prototype,"setQuizLifecycle",null),S([(0,e.MD)(),a("design:type",Function),a("design:paramtypes",[Object]),a("design:returntype",void 0)],v,"getLifecycle",null),S([(0,e.MD)(),a("design:type",Function),a("design:paramtypes",[Object]),a("design:returntype",Object)],v,"getQuizSettings",null),S([(0,e.MD)(),a("design:type",Function),a("design:paramtypes",[Object]),a("design:returntype",Number)],v,"getQuizLaunchMode",null),S([(0,e.MD)(),a("design:type",Function),a("design:paramtypes",[Object]),a("design:returntype",void 0)],v,"getQuizModeActive",null),S([(0,e.MD)(),a("design:type",Function),a("design:paramtypes",[Object]),a("design:returntype",void 0)],v,"getQuizModeLocked",null),S([(0,e.MD)(),a("design:type",Function),a("design:paramtypes",[Object]),a("design:returntype",void 0)],v,"getEnableQuizRetake",null),S([(0,e.MD)(),a("design:type",Function),a("design:paramtypes",[Object]),a("design:returntype",Boolean)],v,"getQuizReviewEnabled",null),S([(0,e.MD)(),a("design:type",Function),a("design:paramtypes",[Object]),a("design:returntype",void 0)],v,"globalSceneConfig",null),S([(0,e.MD)(),a("design:type",Function),a("design:paramtypes",[Object]),a("design:returntype",void 0)],v,"hasQuiz",null),S([(0,e.MD)(),a("design:type",Function),a("design:paramtypes",[Object]),a("design:returntype",void 0)],v,"getQuizEnabled",null),S([(0,e.MD)(),a("design:type",Function),a("design:paramtypes",[Object]),a("design:returntype",void 0)],v,"getAllQuestions",null),S([(0,e.MD)(),a("design:type",Function),a("design:paramtypes",[Object]),a("design:returntype",void 0)],v,"getAllSubmissions",null),S([(0,e.MD)(),a("design:type",Function),a("design:paramtypes",[Object]),a("design:returntype",void 0)],v,"getActiveSubmitted",null),S([(0,e.MD)(),a("design:type",Function),a("design:paramtypes",[Object]),a("design:returntype",void 0)],v,"getActiveSubmission",null),S([(0,e.MD)(),a("design:type",Function),a("design:paramtypes",[Object]),a("design:returntype",void 0)],v,"getActiveQuestion",null),S([(0,e.MD)(),a("design:type",Function),a("design:paramtypes",[Object]),a("design:returntype",void 0)],v,"getActiveQuestionId",null),S([(0,e.MD)(),a("design:type",Function),a("design:paramtypes",[Object]),a("design:returntype",Array)],v,"getActiveQuestionLabels",null),S([(0,e.MD)(),a("design:type",Function),a("design:paramtypes",[Object]),a("design:returntype",void 0)],v,"getActiveQuestionIndex",null),S([(0,e.MD)(),a("design:type",Function),a("design:paramtypes",[Object]),a("design:returntype",void 0)],v,"getQuestionTotal",null),S([(0,e.MD)(),a("design:type",Function),a("design:paramtypes",[Object]),a("design:returntype",void 0)],v,"getCorrectAnswerTotal",null),S([(0,e.MD)(),a("design:type",Function),a("design:paramtypes",[Object]),a("design:returntype",void 0)],v,"getQuestionsRemaining",null),S([(0,e.MD)(),a("design:type",Function),a("design:paramtypes",[Object]),a("design:returntype",void 0)],v,"hasQuestionRemaining",null),S([(0,e.MD)(),a("design:type",Function),a("design:paramtypes",[Object]),a("design:returntype",void 0)],v,"getPickMode",null),v=f=S([(0,e.Uw)({name:"quiz",defaults:i})],v)},71120:(le,N,n)=>{"use strict";n.d(N,{D:()=>P});var e=function(S){return S.Facebook="facebook",S.LinkedIn="linkedin",S.Twitter="twitter",S}(e||{}),t=n(9632),s=function(S){return S.Model="model",S.Quiz="quiz",S}(s||{}),c=n(54438),O=n(21626);let P=(()=>{class S{constructor(f,E){this.http=f,this.APP_BASE_URL=E}shareEmailLink(f){return this.http.post("/ws/user/share/email",f)}generateShareLink(f,E="en"){const y=f.thumbnail_url.replace("/small/","/large/");return{type:f.quiz?s.Quiz:s.Model,title:f.title,relativeUrl:this.createShareUrl(f,"share",E,!1,!1),fullUrl:this.createShareUrl(f,"share",E,!0,!1),thumbUrl:y,social:[{type:e.Facebook,url:`https://www.facebook.com/sharer/sharer.php?u=${this.createShareUrl(f,e.Facebook,E,!0,!0)}`},{type:e.LinkedIn,url:`https://www.linkedin.com/sharing/share-offsite/?url=${this.createShareUrl(f,e.LinkedIn,E,!0,!0)}`},{type:e.Twitter,url:`http://twitter.com/share?url=${this.createShareUrl(f,e.Twitter,E,!0,!0)}`}]}}createShareUrl(f,E,y,i,g){const p=f.id.replace(".json",""),h=Object.values(e).includes(E),v=`/view?id=${p}&lang=${y}&ref=${E}`,d=i||h?`${h?"https://human.biodigital.com":this.APP_BASE_URL}${v}`:v;return g?encodeURIComponent(d):d}static#e=this.\u0275fac=function(E){return new(E||S)(c.KVO(O.Qq),c.KVO(t.ar))};static#t=this.\u0275prov=c.jDH({token:S,factory:S.\u0275fac,providedIn:"root"})}return S})()},17192:(le,N,n)=>{"use strict";n.d(N,{Cg:()=>t,Km:()=>c,Rr:()=>e,zq:()=>s});let e=(()=>{class O{static#e=this.type="[Share] Reset";constructor(){}}return O})(),t=(()=>{class O{static#e=this.type="[Share] Share Email Link";constructor(S){this.shareEmail=S}}return O})(),s=(()=>{class O{static#e=this.type="[Share] Share Email Link Success";constructor(S){this.shareEmail=S}}return O})(),c=(()=>{class O{static#e=this.type="[Share] Share Email Link Fail";constructor(S){this.error=S}}return O})()},9940:(le,N,n)=>{"use strict";n.d(N,{D:()=>h});var e=n(92014),t=n(71263),s=n(11756),c=n(15152),O=n(38165),P=n(5690),a=n(17192),f=n(71120),E=n(50262),y=n(54438),i=function(o,v,d,r){var l,_=arguments.length,u=_<3?v:null===r?r=Object.getOwnPropertyDescriptor(v,d):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(o,v,d,r);else for(var m=o.length-1;m>=0;m--)(l=o[m])&&(u=(_<3?l(u):_>3?l(v,d,u):l(v,d))||u);return _>3&&u&&Object.defineProperty(v,d,u),u},g=function(o,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(o,v)};const p={sharing:!1};let h=class Ds{static getSharing(v){return v.sharing}resetShare(v,d){v.setState(p)}sendEmail(v,{shareEmail:d}){v.patchState({sharing:!0}),this.authService.verifyIsHuman("share_email").pipe((0,s.Z)(({isHuman:r,verification:_})=>{if(!r)throw new E.s;return this.shareService.shareEmailLink({version:4,app_productkey:this.productService.productKey,app_producttype:this.productService.productType,site_verify_response:_,...d})}),(0,c.j)(()=>v.patchState({sharing:!1}))).subscribe({next:()=>{v.dispatch(new a.zq(d))},error:r=>{r instanceof E.s&&v.dispatch(new O.sz(r)),v.dispatch(new a.Km(r))}})}constructor(v,d,r){this.shareService=v,this.productService=d,this.authService=r}static#e=this.\u0275fac=function(d){return new(d||Ds)(y.KVO(f.D),y.KVO(P.b),y.KVO(t.u))};static#t=this.\u0275prov=y.jDH({token:Ds,factory:Ds.\u0275fac})};i([(0,e.rc)(a.Rr),g("design:type",Function),g("design:paramtypes",[Object,a.Rr]),g("design:returntype",void 0)],h.prototype,"resetShare",null),i([(0,e.rc)(a.Cg),g("design:type",Function),g("design:paramtypes",[Object,a.Cg]),g("design:returntype",void 0)],h.prototype,"sendEmail",null),i([(0,e.MD)(),g("design:type",Function),g("design:paramtypes",[class S{}]),g("design:returntype",void 0)],h,"getSharing",null),h=i([(0,e.Uw)({name:"share",defaults:p}),g("design:paramtypes",[f.D,P.b,t.u])],h)},65881:(le,N,n)=>{"use strict";n.d(N,{G:()=>s,S:()=>t});var e=n(59429);function t(c,O){return c.reduce((P,S)=>(P[S.id]=!0===O?s():S.id,P),{})}function s(){return e.u.idWithPrefix("chapter")}},4951:(le,N,n)=>{"use strict";n.d(N,{W:()=>a});var e=n(2573),t=n(15877),s=n(24418),c=n(92811),O=n(65294),P=n(54438),S=n(83621);let a=(()=>{class f{constructor(y){this.applicationEventService=y}getClipboardAPISupport(){return"clipboard"in navigator}getClipboardAPI(){return navigator.clipboard}nativeShareLink(y){(!0===s.c.native||s.c.platform===c.N.SDK)&&this.applicationEventService.fireEvent(O.F.NativeShare,{type:"shareLinkModel",value:JSON.stringify(y)})}copyToClipboard(y,i){if(!0===s.c.native||s.c.platform===c.N.SDK)return new e.c(g=>{this.applicationEventService.fireEvent(O.F.NativeShare,{type:i,value:y}),g.next(!0),g.complete()});if(this.getClipboardAPISupport()){const g=this.getClipboardAPI();return new e.c(p=>{setTimeout(()=>{g.writeText(y).then(()=>{p.next(!0),p.complete()}).catch(h=>{console.log(h),p.next(!1),p.complete()})})})}return(0,t.of)(!1)}copyInputFieldValue(y){y.select();let i=!1;try{i=document.execCommand("copy")}catch{i=!1}return i}static#e=this.\u0275fac=function(i){return new(i||f)(P.KVO(S.S))};static#t=this.\u0275prov=P.jDH({token:f,factory:f.\u0275fac,providedIn:"root"})}return f})()},90908:(le,N,n)=>{"use strict";function e(){const O=document.createElement("canvas"),P=O.getContext("webgl")||O.getContext("experimental-webgl"),S=P instanceof WebGLRenderingContext;return S&&P.getExtension("WEBGL_lose_context")?.loseContext(),S}function t(){return window.matchMedia("(hover: hover)").matches}function s(){return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0}function c(){return"scrollBehavior"in document.documentElement.style}n.d(N,{MN:()=>e,ZO:()=>t,uK:()=>c,yd:()=>s})},93547:(le,N,n)=>{"use strict";n.d(N,{C:()=>O});var e=n(54438),t=n(60177);const s=["*"];var c=function(P){return P.Danger="danger",P.Info="info",P}(c||{});let O=(()=>{class P{constructor(){this.type=c.Info,this.theme="dark"}ngOnInit(){}static#e=this.\u0275fac=function(f){return new(f||P)};static#t=this.\u0275cmp=e.VBU({type:P,selectors:[["app-alert"]],inputs:{type:"type",theme:"theme"},ngContentSelectors:s,decls:2,vars:5,consts:[[1,"app-alert",3,"ngClass"]],template:function(f,E){1&f&&(e.NAR(),e.j41(0,"div",0),e.SdG(1),e.k0s()),2&f&&(e.AVh("app-alert--dark","dark"===E.theme)("app-alert--light","light"===E.theme),e.Y8G("ngClass","app-alert--"+E.type))},dependencies:[t.YU],styles:[":host{display:block}.app-alert{border-radius:4px;padding:16px;font-size:.75rem;line-height:1rem}.app-alert--info{background:#2d90dc26}.app-alert--danger{background:#de353526}.app-alert--light{color:#1c2a3f}.app-alert--light a,.app-alert--light a:visited{color:#283853}.app-alert--dark{color:#f9fafd}.app-alert--dark a,.app-alert--dark a:visited{color:#fff}\n"],encapsulation:2,changeDetection:0})}return P})()},21007:(le,N,n)=>{"use strict";n.d(N,{Q:()=>y});var e=n(54438),t=n(82542);const s=["app-button",""],c=["*"],P={[t.P.Light]:{default:"text-gray-800 hover:bg-gray-900/10",flat:"text-gray-700 bg-gray-200 hover:text-black",outline:"border border-solid border-gray-300 text-gray-800 hover:bg-gray-900/10 text-gray-900",primary:"bg-red-700 text-white hover:bg-red-600",info:"bg-blue-600 text-white hover:bg-blue-500",text:"text-gray-900 hover:text-gray-800"},[t.P.Dark]:{default:"text-gray-200 hover:bg-gray-800",flat:"bg-gray-700 hover:bg-gray-600",outline:"border border-solid border-gray-600 text-gray-200 hover:bg-white/10 hover:text-white",primary:"bg-red-700 text-white hover:bg-red-600",info:"bg-blue-600 text-white hover:bg-blue-500",text:"text-gray-500"}},S={default:"rounded px-4",rounded:"rounded-3xl px-4",circle:"rounded-full",square:"rounded",text:""},a={"2xs":"h-5",xs:"h-6",sm:"h-8",md:"h-9",lg:"h-11",xl:"h-12"},f={"2xs":"w-5",xs:"w-6",sm:"w-8",md:"w-9",lg:"w-11",xl:"w-12"},E={"2xs":"text-2xs",xs:"text-2xs",sm:"text-xs",md:"text-xs",lg:"text-sm",xl:"text-sm"};let y=(()=>{class i{constructor(){this.buttonSize=(0,e.hFB)("md"),this.buttonType=(0,e.hFB)("default"),this.buttonTheme=(0,e.hFB)(t.P.Dark),this.buttonShape=(0,e.hFB)("default"),this.buttonAlign=(0,e.hFB)("center"),this.uppercase=(0,e.hFB)(!0),this.disabled=(0,e.hFB)(!1),this.classes=(0,e.EWP)(()=>{const p=[];switch(p.push("flex items-center justify-center font-sans transition-colors"),p.push(this.disabled()?"opacity-50":"cursor-pointer"),this.uppercase()&&p.push("uppercase"),p.push("left"===this.buttonAlign()?"text-left":"text-center"),p.push(P[this.buttonTheme()][this.buttonType()]),p.push(a[this.buttonSize()]),p.push(E[this.buttonSize()]),p.push(S[this.buttonShape()]),this.buttonShape()){case"circle":case"square":p.push(f[this.buttonSize()])}return p.join(" ")})}get hostDisabled(){return this.disabled()}get hostButtonType(){return this.buttonType()}static#e=this.\u0275fac=function(h){return new(h||i)};static#t=this.\u0275cmp=e.VBU({type:i,selectors:[["button","app-button",""],["a","app-button",""]],hostVars:2,hostBindings:function(h,o){2&h&&(e.Mr5("disabled",o.hostDisabled),e.BMQ("data-button-type",o.hostButtonType))},inputs:{buttonSize:[1,"buttonSize"],buttonType:[1,"buttonType"],buttonTheme:[1,"buttonTheme"],buttonShape:[1,"buttonShape"],buttonAlign:[1,"buttonAlign"],uppercase:[1,"uppercase"],disabled:[1,"disabled"]},attrs:s,ngContentSelectors:c,decls:2,vars:2,template:function(h,o){1&h&&(e.NAR(),e.j41(0,"span"),e.SdG(1),e.k0s()),2&h&&e.HbH(o.classes())},styles:["a[app-button],button[app-button]{border-color:transparent;background:none;border-width:0;padding:0;border-radius:4px;outline:0 none}a[app-button]:focus,button[app-button]:focus{--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(3px + var(--tw-ring-offset-width)) var(--tw-ring-color);--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000);--tw-ring-opacity: 1;--tw-ring-color: rgb(45 114 220 / var(--tw-ring-opacity, 1))}a[app-button][buttonshape=circle],a[app-button][ng-reflect-button-shape=circle],button[app-button][buttonshape=circle],button[app-button][ng-reflect-button-shape=circle]{border-radius:.25rem;border-radius:9999px}a[app-button]:not([disabled]):hover,button[app-button]:not([disabled]):hover{cursor:pointer}\n"],encapsulation:2,changeDetection:0})}return i})()},11818:(le,N,n)=>{"use strict";n.d(N,{C:()=>O});var e=n(60177),t=n(72026),s=n(45189),c=n(54438);let O=(()=>{class P{static#e=this.\u0275fac=function(f){return new(f||P)};static#t=this.\u0275mod=c.$C({type:P});static#n=this.\u0275inj=c.G2t({imports:[e.MD,t.o,s.G]})}return P})()},65985:(le,N,n)=>{"use strict";n.d(N,{Mp:()=>P,ri:()=>a});var e=n(54438);const t=["viewButton"],s=["app-view-button",""],c=["*"];var O=function(f){return f.Rounded="rounded",f.Square="square",f.Narrow="narrow",f.Squat="squat",f}(O||{}),P=function(f){return f.Default="default",f.Fill="fill",f.Small="small",f.XSmall="xsmall",f.XXSmall="2xsmall",f}(P||{});const S={transparent:{background:"transparent",color:"inherit",border:"transparent",borderWidth:"0"},"transparent-fill":{background:"transparent",color:"#374A68",border:"transparent"},"blue-fill":{background:"#2d72dc",color:"#ffffff",border:"transparent",focusBorder:"#1C2A3F"},"red-fill":{background:"#f44336",color:"#ffffff",border:"transparent"},"dark-gray-fill":{background:"#283853",color:"#ffffff",border:"transparent",disabledColor:"#374a68"},"light-gray-fill":{background:"#eaeff5",color:"#374a68",border:"transparent",disabledColor:"#d7e0ea"},"white-outline":{background:"transparent",color:"#ffffff",border:"#ffffff",borderWidth:"1px"},white:{background:"transparent",color:"#ffffff",border:"transparent"},"light-gray-outline":{background:"transparent",color:"#000000",border:"#d7e0ea",borderWidth:"1px"}};let a=(()=>{class f{constructor(y,i){this.tabindex=y,this.hostElement=i,this.selected=!1,this.thin=!1,this.short=!1,this.buttonSize=P.Default,this.buttonShape=O.Square,this.addFocusStyle=!1,this.buttonTheme="transparent-fill",this.hasFocus=!1}ngOnInit(){this.styleButton()}ngOnChanges(){this.styleButton()}get attrAriaDisabled(){return this.disabled}onFocus(){this.hasFocus=!0,this.styleButton()}onBlur(){this.hasFocus=!1,this.styleButton()}styleButton(){const y=this.viewButton.nativeElement.style,i=S[this.buttonTheme??"transparent-fill"];switch(y.setProperty("border-color",i.border||"transparent"),y.setProperty("border-width",i.borderWidth||"2px"),y.setProperty("background-color",i.background),y.setProperty("color",i.color),(this.hasFocus||this.addFocusStyle)&&y.setProperty("border-color",i.focusBorder||"#2d72dc"),this.buttonShape){case O.Rounded:y.setProperty("border-radius","4px");break;case O.Square:y.setProperty("border-radius","0")}switch(this.buttonSize){case P.XXSmall:y.setProperty("min-height","28px"),y.setProperty("min-width","28px");break;case P.XSmall:y.setProperty("min-height","32px"),y.setProperty("min-width","32px");break;case P.Small:y.setProperty("min-height","40px"),y.setProperty("min-width","40px");break;case P.Fill:y.setProperty("min-height","100%"),y.setProperty("min-width","100%");break;default:y.setProperty("min-height","48px"),y.setProperty("min-width","48px")}this.thin&&y.setProperty("min-width","28px"),this.short&&y.setProperty("min-height","28px"),this.disabled&&y.setProperty("color",i.disabledColor||"#d7e0ea")}focus(){this.hostElement.nativeElement.focus()}static#e=this.\u0275fac=function(i){return new(i||f)(e.kS0("tabindex"),e.rXU(e.aKT))};static#t=this.\u0275cmp=e.VBU({type:f,selectors:[["button","app-view-button",""]],viewQuery:function(i,g){if(1&i&&e.GBs(t,7),2&i){let p;e.mGM(p=e.lsd())&&(g.viewButton=p.first)}},hostVars:2,hostBindings:function(i,g){1&i&&e.bIt("focus",function(){return g.onFocus()})("blur",function(){return g.onBlur()}),2&i&&(e.Mr5("disabled",g.disabled),e.BMQ("aria-disabled",g.attrAriaDisabled))},inputs:{disabled:"disabled",selected:"selected",thin:"thin",short:"short",buttonSize:"buttonSize",buttonShape:"buttonShape",addFocusStyle:"addFocusStyle",buttonTheme:"buttonTheme"},features:[e.OA$],attrs:s,ngContentSelectors:c,decls:4,vars:0,consts:[["viewButton",""],[1,"view-button"],[1,"view-button__content"]],template:function(i,g){1&i&&(e.NAR(),e.j41(0,"div",1,0)(2,"span",2),e.SdG(3),e.k0s()())},styles:['button[app-view-button]{border-color:transparent;background:none;border-width:0;padding:0;outline:none;margin:0;pointer-events:all;position:relative;font-size:14px}button[app-view-button]::-moz-focus-inner{border:0}button[app-view-button]:not(:disabled):hover{cursor:pointer}button[app-view-button]:hover:not(:disabled):after{content:" ";pointer-events:none;position:absolute;inset:0;background-color:#0000000d}button[app-view-button]:disabled .view-button{color:#61779e}.view-button{--background-color: transparent;--color: $gray-20;--border-color: transparent;--border-radius: 0;--border-width: 2px;--min-width: 48px;--min-height: 48px;background:var(--background-color);border:var(--border-width) solid var(--border-color);border-radius:var(--border-radius);color:var(--color);display:flex;align-items:center;justify-content:center;-webkit-user-select:none;user-select:none;pointer-events:none;min-width:var(--min-width);min-height:var(--min-height);height:100%;width:100%;transition:background-color .15s ease-out,border-color .15s ease-out,color .15s ease-out}.view-button--focus{--border-color: #2d72dc !important}.view-button__content{width:100%;transition:all .15s ease-out}\n'],encapsulation:2,changeDetection:0})}return f})()},32996:(le,N,n)=>{"use strict";n.d(N,{z:()=>c});var e=n(60177),t=n(59162),s=n(54438);let c=(()=>{class O{static#e=this.\u0275fac=function(a){return new(a||O)};static#t=this.\u0275mod=s.$C({type:O});static#n=this.\u0275inj=s.G2t({imports:[e.MD,t.M]})}return O})()},90265:(le,N,n)=>{"use strict";n.d(N,{B:()=>ie});var e=n(54438),s=(n(45731),n(3266)),c=n(85052),O=n(35426),P=n(96513),S=n(94974),a=n(2573),f=n(87996),E=n(37925),y=n(36110),i=n(14264),g=n(21082),p=n(39705),h=n(66897),o=n(515),v=n(65855),d=n(13878),r=n(47125),_=n(49204),u=n(35379),l=n(97443),m=function(se){return se.Image="2d",se.Embed="3d",se}(m||{}),C=n(68132),b=n(16823),R=n(21424),A=n(16058),G=n(92014),k=n(60177),V=n(345);let W=(()=>{class se{set url(de){de&&(this.src=this.sanitizer.bypassSecurityTrustResourceUrl(de))}constructor(de){this.sanitizer=de}static#e=this.\u0275fac=function(ae){return new(ae||se)(e.rXU(V.up))};static#t=this.\u0275dir=e.FsC({type:se,selectors:[["iframe","appEmbedSrc",""]],hostVars:1,hostBindings:function(ae,q){2&ae&&e.Mr5("src",q.src,e.f$h)},inputs:{url:"url"}})}return se})();const T=["embedViewerContainer"],x=["previewContainer"],z=["groupContainer"],I=["embedViewerFrame"],D=(se,Z,de)=>({"embed-viewer--light":se,"embed-viewer--dark":Z,"embed-viewer--compact":de}),L=(se,Z,de)=>({"embed-viewer__group--desktop":se,"embed-viewer__group--tablet":Z,"embed-viewer__group--mobile":de}),Q={[u.k.Desktop]:{width:1,height:1},[u.k.Tablet]:{width:834,height:1194},[u.k.Mobile]:{width:414,height:736}};let ie=(()=>{class se{set model(de){if(de){const ae=this.store.selectSnapshot(C.F.getWidgetURL),q=this.store.selectSnapshot(b.k.getUserLanguage),K=this.store.selectSnapshot(R.q.getSelectedOrganizationProductAccountId);let j=this.publishService.getWidgetURL(de,ae,null,null,null,q,null,K);j+="&ui-fadeout=0",this.url=j}}get device(){return this._device}set device(de){this._device=de,this.options&&this.updateViewer(this.options)}get options(){return this._options}set options(de){de&&(this._options=de,this.updateViewer(this.options))}get topOffset(){const ae=(this.previewRef.nativeElement.offsetHeight-this.height)/2;return this.scaleFactor<1?ae:Math.max(0,ae)}get leftOffset(){const ae=(this.previewRef.nativeElement.offsetWidth-this.width)/2;return this.scaleFactor<1?ae:Math.max(0,ae)}get scaleFactor(){if(this.scalable){const{offsetWidth:de,offsetHeight:ae}=this.previewRef.nativeElement;let q,K;return this.device===u.k.Desktop?(q=this.previewRef.nativeElement.offsetWidth/this.width,K=this.previewRef.nativeElement.offsetHeight/this.height):(q=de/Q[this.device].width,K=ae/Q[this.device].height),Math.min(q,K,1)}return 1}get scaleFactorPercentage(){return Math.round(100*this.scaleFactor)}get zoomInfoText(){if(this.device===u.k.Desktop)return`Displayed at ${this.scaleFactorPercentage}%`;{const{width:de,height:ae}=Q[this.device];return`${u.K[this.device]} (${de}x${ae} resolution) displayed at ${this.scaleFactorPercentage}%`}}get previewHeight(){return this.containerRef.nativeElement.offsetHeight}get isDesktop(){return this.device===u.k.Desktop}get isTablet(){return this.device===u.k.Tablet}get isMobile(){return this.device===u.k.Mobile}get isThemeLight(){return"light"===this.theme}get isThemeDark(){return"dark"===this.theme}constructor(de,ae,q,K,j){this.cameraService=de,this.publishService=ae,this.changeDetectorRef=q,this.store=K,this.renderer2=j,this.publishModeEnum=m,this.theme="light",this.compact=!1,this.scalable=!1,this.labelScale=1,this.allVisibilityLayers=[],this.variantSchemas={},this.cameraUpdated=new e.bkB,this.ngUnsubscribe=new c.B,this.widgetOptionsSubject=new c.B}ngOnInit(){this._apiRef=new HumanAPI({iframeId:this.frameRef.nativeElement.id}),this.initAPIListeners(),this.initQuizAPIListeners(),this.initTutorialListeners(),this.initCameraListeners()}ngAfterViewInit(){this.updateViewer(this.options),(0,O.R)(window,"resize").pipe((0,f.B)(50),(0,E.Q)(this.ngUnsubscribe)).subscribe(()=>{this.updateViewer(this.options)})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initAPIListeners(){this.getAPIEvent(o.X.HumanReady).pipe((0,E.Q)(this.ngUnsubscribe)).subscribe(()=>{this.setupCameraTracking(),this.setupCameraRotation(),this.setViewerUIConfig(this.options?.options),this.getModelBackgroundColor().pipe((0,E.Q)(this.ngUnsubscribe)).subscribe(de=>{this.defaultBackgroundColor=de,this.setViewerBackground(this.options.backgroundColor||this.defaultBackgroundColor)}),this.getLayers().pipe((0,E.Q)(this.ngUnsubscribe)).subscribe(de=>{this.allVisibilityLayers=de,this.changeDetectorRef.markForCheck()}),this.getVariantSchemas().pipe((0,E.Q)(this.ngUnsubscribe)).subscribe(de=>{this.variantSchemas=de,this.changeDetectorRef.markForCheck()})})}initQuizAPIListeners(){this.widgetOptionsSubject.asObservable().pipe((0,y.T)(ae=>ae.uiQuiz),(0,i.p)(ae=>!(0,_.isNil)(ae))).pipe((0,g.F)((ae,q)=>(0,_.isEqual)(ae,q)),(0,i.p)(()=>!(0,_.isNil)(this._apiRef)),(0,E.Q)(this.ngUnsubscribe)).subscribe(ae=>{const{mode:q,number:K}=ae,j=q===r.R.Locked;if(j){const M=parseInt(K,10),$=isNaN(M)?1:M,ce=isNaN(M)?void 0:M;this._apiRef.send(h.t.QuizReset),this._apiRef.send(h.t.QuizSet,{locked:j,startNumber:$,endNumber:ce}),this._apiRef.send(h.t.QuizEnter)}else this._apiRef.send(h.t.QuizSet,{locked:j}),this._apiRef.send(h.t.QuizExit)})}initTutorialListeners(){this.widgetOptionsSubject.asObservable().pipe((0,y.T)(de=>de.uiTutorial),(0,g.F)(),(0,E.Q)(this.ngUnsubscribe)).subscribe(de=>{this._apiRef.send(h.t.UISetTutorial,{enabled:de})})}initCameraListeners(){this.widgetOptionsSubject.asObservable().pipe((0,y.T)(de=>de.loadRotate),(0,g.F)(),(0,E.Q)(this.ngUnsubscribe)).subscribe(de=>{this._rotateDegrees=de})}updateViewer(de){this.width=de.dimensions.width,this.height=de.dimensions.height,this.scalable=de.scalable,this.setLabelsEnabled(de.labelsEnabled),this.setLabelScale(de.labelScale),this.setViewerUIConfig(de.options),this.setViewerBackground(this.options.backgroundColor||this.defaultBackgroundColor);const ae=de.dimensions.type;this.setDeviceDimensions(ae);const q=this.frameRef?.nativeElement;q&&(ae===l.M.Fixed?this.setFixedDimensions(q):ae===l.M.Responsive&&this.setResponsiveDimensions(q))}setResponsiveDimensions(de){this.renderer2.removeAttribute(de,"width"),this.renderer2.removeAttribute(de,"height");let ae="width",q="height";this.device===u.k.Desktop&&this.containerRef.nativeElement.offsetWidth/this.width>=this.containerRef.nativeElement.offsetHeight/this.height&&(ae="height",q="width"),this.renderer2.setStyle(de,ae,"100%"),this.renderer2.setStyle(de,q,"auto"),this.renderer2.setStyle(de,"aspect-ratio",`${this.width} / ${this.height}`),this.renderer2.setStyle(de,"max-height","100%")}setFixedDimensions(de){this.renderer2.setAttribute(de,"width",`${this.width}`),this.renderer2.setAttribute(de,"height",`${this.height}`),this.renderer2.setStyle(de,"width",`${this.width}px`),this.renderer2.setStyle(de,"height",`${this.height}px`),this.renderer2.setStyle(de,"aspect-ratio","auto")}setDeviceDimensions(de){this.device===u.k.Desktop&&de===l.M.Fixed?(this.renderer2.setStyle(this.groupContainerRef.nativeElement,"width",`${this.width}px`),this.renderer2.setStyle(this.groupContainerRef.nativeElement,"height",`${this.height}px`),this.renderer2.setStyle(this.groupContainerRef.nativeElement,"left",`${this.leftOffset}px`),this.renderer2.setStyle(this.groupContainerRef.nativeElement,"top",`${this.topOffset}px`)):(this.renderer2.removeStyle(this.groupContainerRef.nativeElement,"width"),this.renderer2.removeStyle(this.groupContainerRef.nativeElement,"height"),this.renderer2.removeStyle(this.groupContainerRef.nativeElement,"left"),this.renderer2.removeStyle(this.groupContainerRef.nativeElement,"top")),this.device!==u.k.Desktop&&this.renderer2.setStyle(this.groupContainerRef.nativeElement,"left",(this.previewRef.nativeElement.offsetWidth-Q[this.device].width*this.scaleFactor)/2+"px"),this.changeDetectorRef.markForCheck()}setViewerUIConfig(de){if(this._apiRef&&de){const ae=this.convertWidgetOptionsToDisplayParams(de);this.setUIDisplay(ae);const q={enabled:!de.autoLoad},K=(M=de.initial).button?v.i.Button:M.handHint?v.i.Hand:M.play?v.i.Play:M.summary?v.i.Summary:void 0,j=(M=>M.alert?d.M.DoNotCaptureShowMessage:M.overlay?d.M.DoNotCapture:d.M.Capture)(de.disableScroll);this._apiRef.send(h.t.UISetOndemand,q),this._apiRef.send(h.t.UISetLoadingExperience,K),this._apiRef.send(h.t.UISetScrollCaptureMode,j),this.widgetOptionsSubject.next(de)}var M}takeSnapshot(de="jpeg",ae){return this.getAPIData(h.t.UISnapshot,{width:this.width,height:this.height,fileType:de,...ae})}setCameraOrbit(de){this.sendAPIData(h.t.CameraOrbit,{yaw:de})}setViewerBackground(de){this._apiRef&&de&&this.sendAPIData(h.t.UIPresetBackground,de)}setLabelsEnabled(de){this._apiRef&&this.sendAPIData(de?h.t.LabelsShow:h.t.LabelsHide)}setLabelScale(de){this._apiRef&&this.sendAPIData(h.t.LabelsSetScale,{scale:de})}setupCameraTracking(){this.getCurrentCamera().pipe((0,E.Q)(this.ngUnsubscribe)).subscribe(de=>{this.setDefaultCamera(de),this.getCameraUpdates().pipe((0,E.Q)(this.ngUnsubscribe)).subscribe(ae=>{this.setUpdateCamera(ae)})})}setupCameraRotation(){let de=performance.now();(0,P.Y)(0,S.X).pipe((0,i.p)(()=>!!this._rotateDegrees),(0,y.T)(()=>this._rotateDegrees*(performance.now()-de)*.001),(0,p.M)(()=>de=performance.now()),(0,E.Q)(this.ngUnsubscribe)).subscribe(ae=>{this.setCameraOrbit(ae)})}setDefaultCamera(de){this._defaultCamera=de,this.setUpdateCamera(de)}setUpdateCamera(de){this._currentCamera=de;const q=this.cameraService.areCamerasEqual(this.cameraService.roundCamera(this._defaultCamera,3),this.cameraService.roundCamera(this._currentCamera,3))?null:this._currentCamera;this.cameraUpdated.emit(q)}getAPIEvent(de){return new a.c(ae=>{this._apiRef.on(de,q=>{ae.next(q)})})}getAPIData(de,ae){return new a.c(q=>{this._apiRef.send(de,ae,K=>{q.next(K),q.complete()})})}sendAPIData(de,ae){this._apiRef.send(de,ae)}getCurrentCamera(){return this.getAPIData(h.t.CameraInfo).pipe((0,y.T)(de=>({eye:de.position,look:de.target,up:de.up})))}getModelBackgroundColor(){return this.getAPIData(h.t.UIGetBackground).pipe((0,y.T)(de=>{if(de){const{colors:ae,gradientType:q,colorStops:K}=de,[j,M]=ae;return{colors:[...j,...M],gradientType:q,colorStops:K}}return null}))}getCameraUpdates(){return this.getAPIEvent(o.X.CameraUpdated).pipe((0,y.T)(de=>{const{position:ae,target:q,up:K}=de;return{eye:ae,look:q,up:K}}))}setUIDisplay(de){this._apiRef.send(h.t.UISetDisplay,de)}getLayers(){return this.getAPIData(h.t.SceneGetLayers)}getVariantSchemas(){return this.getAPIData(h.t.SceneGetVariantSchemas)}convertWidgetOptionsToDisplayParams(de){return{anatomyDescriptions:de.uiAnatomyDescriptions,anatomyPronunciations:de.uiAnatomyPronunciations,anatomyLabels:de.uiAnatomyLabels,audio:de.uiAudio,chapterList:de.uiChapterList,fullscreen:de.uiFullscreen,help:de.uiHelp,info:de.uiInfo,labelList:de.uiLabelList,legend:de.uiLegend,loader:de.uiLoader,media:de.uiMedia,menu:de.uiMenu,nav:de.uiNav,playthrough:de.playthrough,search:de.uiSearch,tools:de.uiTools,undo:de.uiUndo,visibilityLayers:de.uiVisibilityLayers,skinLayers:de.uiSkinLayers,whiteboard:de.uiWhiteboard}}static#e=this.\u0275fac=function(ae){return new(ae||se)(e.rXU(s.j),e.rXU(A.D),e.rXU(e.gRc),e.rXU(G.il),e.rXU(e.sFG))};static#t=this.\u0275cmp=e.VBU({type:se,selectors:[["app-embed-viewer"]],viewQuery:function(ae,q){if(1&ae&&(e.GBs(T,7),e.GBs(x,7),e.GBs(z,7),e.GBs(I,7)),2&ae){let K;e.mGM(K=e.lsd())&&(q.containerRef=K.first),e.mGM(K=e.lsd())&&(q.previewRef=K.first),e.mGM(K=e.lsd())&&(q.groupContainerRef=K.first),e.mGM(K=e.lsd())&&(q.frameRef=K.first)}},inputs:{model:"model",url:"url",device:"device",options:"options",theme:"theme",compact:"compact"},outputs:{cameraUpdated:"cameraUpdated"},decls:27,vars:14,consts:[["embedViewerContainer",""],["previewContainer",""],["groupContainer",""],["embedViewerFrame",""],[1,"embed-viewer",3,"ngClass"],[1,"embed-viewer__preview"],[1,"embed-viewer__group",3,"ngClass"],[1,"embed-viewer__group-text","mb-3"],[1,"embed-viewer__group-text","w-1/2","mb-10"],["appEmbedSrc","","allowfullscreen","","id","embed-viewer-frame","data-test","embedViewerFrame",1,"embed-viewer__frame",3,"url"],[1,"embed-viewer__group-text","w-1/2","mt-5","mb-10"],[1,"embed-viewer__group-text","mb-8"],[1,"embed-viewer__group-text","w-1/3","mb-8"],[1,"embed-viewer__group-text","w-66","mb-8"],[1,"embed-viewer__group-text","w-1/3"],[1,"embed-viewer__label"]],template:function(ae,q){1&ae&&(e.j41(0,"div",4,0)(2,"div",5,1)(4,"div",6,2),e.nrm(6,"div",7)(7,"div",8)(8,"iframe",9,3)(10,"div",10)(11,"div",7)(12,"div",11)(13,"div",7)(14,"div",7)(15,"div",12)(16,"div",7)(17,"div",7)(18,"div",7)(19,"div",13)(20,"div",7)(21,"div",11)(22,"div",7)(23,"div",7)(24,"div",14),e.k0s()(),e.j41(25,"div",15),e.EFF(26),e.k0s()()),2&ae&&(e.Y8G("ngClass",e.sMw(6,D,q.isThemeLight,q.isThemeDark,q.compact)),e.R7$(4),e.xc7("transform","scale("+q.scaleFactor+")"),e.Y8G("ngClass",e.sMw(10,L,q.isDesktop,q.isTablet,q.isMobile)),e.R7$(4),e.Y8G("url",q.url),e.R7$(18),e.JRh(q.zoomInfoText))},dependencies:[k.YU,W],styles:[".embed-viewer[_ngcontent-%COMP%]{display:flex;flex-flow:column nowrap;align-items:center;width:100%;height:100%;position:relative;overflow:hidden}.embed-viewer--dark[_ngcontent-%COMP%]   .embed-viewer__frame[_ngcontent-%COMP%]{outline:1px solid #6c6c6c}.embed-viewer--dark[_ngcontent-%COMP%]   .embed-viewer__label[_ngcontent-%COMP%]{color:#101823}.embed-viewer--light[_ngcontent-%COMP%]   .embed-viewer__frame[_ngcontent-%COMP%]{outline:1px solid #d7e0ea}.embed-viewer--light[_ngcontent-%COMP%]   .embed-viewer__label[_ngcontent-%COMP%]{color:#61779e}.embed-viewer__preview[_ngcontent-%COMP%]{flex-grow:1;overflow:hidden;width:100%}.embed-viewer__group[_ngcontent-%COMP%]{overflow:hidden}.embed-viewer__group--desktop[_ngcontent-%COMP%]{width:100%;height:100%;padding:0;transform-origin:center center;position:relative}.embed-viewer__group--desktop[_ngcontent-%COMP%] > .embed-viewer__group-text[_ngcontent-%COMP%]{display:none}.embed-viewer__group--tablet[_ngcontent-%COMP%]{border:2px solid #d7e0ea;border-radius:4px;width:834px;height:1194px;padding:40px;transform-origin:left top;position:relative}.embed-viewer__group--mobile[_ngcontent-%COMP%]{border:2px solid #d7e0ea;border-radius:4px;width:414px;height:736px;padding:40px 20px;transform-origin:left top;position:relative}.embed-viewer__group-text[_ngcontent-%COMP%]{background-color:#d9d9d9;height:16px;width:100%}.embed-viewer__container[_ngcontent-%COMP%]{position:relative}.embed-viewer__frame[_ngcontent-%COMP%]{display:block;box-shadow:0 0 0 1px #eaeff5;margin-left:auto;margin-right:auto}.embed-viewer__label[_ngcontent-%COMP%]{flex-basis:40px;padding-top:24px;font-size:.75rem;line-height:1rem;text-align:center}.embed-viewer--compact[_ngcontent-%COMP%]   .embed-viewer__label[_ngcontent-%COMP%]{padding-top:12px}"],changeDetection:0})}return se})()},26779:(le,N,n)=>{"use strict";n.d(N,{R:()=>s});var e=n(54438),t=n(60177);let s=(()=>{class c{get iconClass(){let S=`${this.custom?"fak":"fas"} fa-${this.icon}`;return this.size&&(S+=` fa-${this.size}`),S}constructor(){this.custom=!1}ngOnInit(){}static#e=this.\u0275fac=function(S){return new(S||c)};static#t=this.\u0275cmp=e.VBU({type:c,selectors:[["app-icon"]],inputs:{icon:"icon",size:"size",custom:"custom"},decls:1,vars:1,consts:[[3,"ngClass"]],template:function(S,a){1&S&&e.nrm(0,"i",0),2&S&&e.Y8G("ngClass",a.iconClass)},dependencies:[t.YU],styles:["[_nghost-%COMP%]{display:inline-block}"],changeDetection:0})}return c})()},72026:(le,N,n)=>{"use strict";n.d(N,{o:()=>s});var e=n(60177),t=n(54438);let s=(()=>{class c{static#e=this.\u0275fac=function(S){return new(S||c)};static#t=this.\u0275mod=t.$C({type:c});static#n=this.\u0275inj=t.G2t({imports:[e.MD]})}return c})()},26621:(le,N,n)=>{"use strict";n.d(N,{o:()=>g});var e=n(60177),t=n(14823),s=n(34006),c=n(54438),O=n(65985),P=n(26779),S=n(97352);function a(p,h){1&p&&(c.j41(0,"div",5),c.nrm(1,"app-spinner",6),c.k0s())}let f=(()=>{class p{constructor(o,v,d){this.dialogRef=o,this.data=v,this.changeRef=d,this.config=v}ngOnInit(){}handleCloseClick(){this.dialogRef.close()}handleImageLoaded(){this.imageLoaded=!0,this.changeRef.markForCheck()}static#e=this.\u0275fac=function(v){return new(v||p)(c.rXU(s.CP),c.rXU(s.Vh),c.rXU(c.gRc))};static#t=this.\u0275cmp=c.VBU({type:p,selectors:[["app-image-dialog"]],decls:5,vars:6,consts:[["role","dialog","aria-modal","true",1,"image-dialog",3,"click","keyup.enter"],["class","image-dialog__loading flex flex-col p-8",4,"ngIf"],[1,"image-dialog__image",3,"load","src","title","alt"],["type","button","app-view-button","","buttonTheme","white","buttonShape","rounded","matTooltip","Close Dialog","matTooltipPosition","left","aria-label","Close Dialog",1,"image-dialog__close",3,"click"],["icon","times"],[1,"image-dialog__loading","flex","flex-col","p-8"],["size","huge"]],template:function(v,d){1&v&&(c.j41(0,"div",0),c.bIt("click",function(){return d.handleCloseClick()})("keyup.enter",function(){return d.handleCloseClick()}),c.DNE(1,a,2,0,"div",1),c.j41(2,"img",2),c.bIt("load",function(){return d.handleImageLoaded()}),c.k0s(),c.j41(3,"button",3),c.bIt("click",function(){return d.handleCloseClick()}),c.nrm(4,"app-icon",4),c.k0s()()),2&v&&(c.BMQ("aria-label",(d.config.title||d.config.alt||"")+" Image Dialog"),c.R7$(),c.Y8G("ngIf",!d.imageLoaded),c.R7$(),c.Y8G("src",d.config.src,c.B4B)("title",d.config.title||"")("alt",d.config.alt||""),c.BMQ("aria-label",d.config.title||""))},dependencies:[e.bT,t.oV,O.ri,P.R,S.tI],styles:[".image-dialog[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;width:100%}.image-dialog__loading[_ngcontent-%COMP%]{position:absolute}.image-dialog__image[_ngcontent-%COMP%]{max-width:100%;max-height:100vh}.image-dialog__close[_ngcontent-%COMP%]{position:fixed;top:24px;right:24px}"],changeDetection:0})}return p})();var E=n(84370),y=n(72026);const i=["imageView"];let g=(()=>{class p{constructor(o){this.dialog=o,this.fit="normal",this.fullscreenEnabled=!1}handleFullscreen(o){this.dialog.open(f,{id:E.t.ImageDialog,backdropClass:"bd-dialog-backdrop",panelClass:"bd-dialog-panel",disableClose:!1,data:{src:this.fullscreenSrc||this.src,alt:this.alt||""}}),o.stopPropagation()}static#e=this.\u0275fac=function(v){return new(v||p)(c.rXU(s.bZ))};static#t=this.\u0275cmp=c.VBU({type:p,selectors:[["app-image-view"]],viewQuery:function(v,d){if(1&v&&c.GBs(i,7),2&v){let r;c.mGM(r=c.lsd())&&(d.imageView=r.first)}},inputs:{fit:"fit",fitSize:"fitSize",src:"src",fullscreenSrc:"fullscreenSrc",alt:"alt"},standalone:!0,features:[c.aNF],decls:7,vars:8,consts:()=>{let o,v;return o=$localize`:1f332ec66f3bc8d943c248091be7f92772ba280f1359092845802014498:Expand`,v=$localize`:18f469ed5b239831a3f607f35e2faa3ccd9527d63521332303708985940:Click to expand the image`,[["imageView",""],v,["role","button","tabindex","0","matTooltip",o,1,"image-view",3,"click","keyup.enter"],[1,"sr-only"],[1,"image-view__image",3,"src"],["aria-hidden","true",1,"image-view__overlay"],["icon","expand-alt",1,"image-view__icon"]]},template:function(v,d){if(1&v){const r=c.RV6();c.j41(0,"div",2,0),c.bIt("click",function(u){return c.eBV(r),c.Njj(d.handleFullscreen(u))})("keyup.enter",function(u){return c.eBV(r),c.Njj(d.handleFullscreen(u))}),c.j41(2,"span",3),c.pXf(3,1),c.k0s(),c.nrm(4,"img",4),c.j41(5,"div",5),c.nrm(6,"app-icon",6),c.k0s()()}2&v&&(c.AVh("image-view--auto-fit","auto"===d.fit),c.R7$(4),c.xc7("max-width","auto"===d.fit&&d.fitSize?d.fitSize+"px":"100%")("max-height","auto"===d.fit&&d.fitSize?d.fitSize+"px":"100%"),c.Y8G("src",d.src,c.B4B),c.BMQ("alt",d.alt))},dependencies:[e.MD,t.uc,t.oV,y.o,P.R],styles:[".image-view[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:inherit;min-height:32px;position:relative;background-color:#f9fafd}.image-view__image[_ngcontent-%COMP%]{width:auto;height:auto}.image-view--auto-fit[_ngcontent-%COMP%]   .image-view__image[_ngcontent-%COMP%]{max-width:100%;height:auto}.image-view__overlay[_ngcontent-%COMP%]{background:#1c2a3f4d;color:#fff;display:flex;flex-direction:row;align-items:center;justify-content:center;padding:8px;position:absolute;inset:0;opacity:0;transition:opacity .25s}.image-view__icon[_ngcontent-%COMP%]{text-shadow:0 0 2px rgba(0,0,0,.6)}.image-view[_ngcontent-%COMP%]:hover{cursor:pointer}.image-view[_ngcontent-%COMP%]:hover   .image-view__overlay[_ngcontent-%COMP%]{opacity:1}.image-view[_ngcontent-%COMP%]:focus{outline:#2d72dc solid 2px!important}.image-view[_ngcontent-%COMP%]:focus   .image-view__overlay[_ngcontent-%COMP%]{opacity:1}"],changeDetection:0})}return p})()},41640:(le,N,n)=>{"use strict";n.d(N,{P:()=>s});var e=n(54438);const t=["*"];let s=(()=>{class c{constructor(){}ngOnInit(){}static#e=this.\u0275fac=function(S){return new(S||c)};static#t=this.\u0275cmp=e.VBU({type:c,selectors:[["app-list-item"]],ngContentSelectors:t,decls:1,vars:0,template:function(S,a){1&S&&(e.NAR(),e.SdG(0))},encapsulation:2,changeDetection:0})}return c})()},78696:(le,N,n)=>{"use strict";n.d(N,{H:()=>P});var e=n(60177),t=n(89417),s=n(45189),c=n(72026),O=n(54438);let P=(()=>{class S{static#e=this.\u0275fac=function(E){return new(E||S)};static#t=this.\u0275mod=O.$C({type:S});static#n=this.\u0275inj=O.G2t({imports:[s.G,t.YN,e.MD,c.o]})}return S})()},77242:(le,N,n)=>{"use strict";n.d(N,{s:()=>P});var e=n(54438),t=n(60177);const s=[[["app-list-item"]]],c=["app-list-item"];var O=function(S){return S.Default="default",S.Commafied="commafied",S.flat="flat",S.inline="inline",S.bulleted="bulleted",S}(O||{});let P=(()=>{class S{constructor(){this.listType=O.Default,this.dense=!1}ngOnInit(){}static#e=this.\u0275fac=function(E){return new(E||S)};static#t=this.\u0275cmp=e.VBU({type:S,selectors:[["app-list"]],inputs:{listType:"listType",dense:"dense"},ngContentSelectors:c,decls:2,vars:3,consts:[[1,"list",3,"ngClass"]],template:function(E,y){1&E&&(e.NAR(s),e.j41(0,"div",0),e.SdG(1),e.k0s()),2&E&&(e.AVh("list--dense",y.dense),e.Y8G("ngClass","list--"+y.listType))},dependencies:[t.YU],styles:['@charset "UTF-8";.list{display:flex;flex-direction:column}.list--dense{padding:0!important}.list--default app-list-item{display:list-item;margin-left:16px;list-style-type:disc}.list--commafied{align-items:center;display:flex;flex-direction:row;flex-wrap:wrap;padding:0 4px 4px 0}.list--commafied app-list-item:not(:last-child):after{content:", ";float:right;padding-right:4px}.list--bulleted{align-items:center;display:flex;flex-direction:row;flex-wrap:wrap;padding:0 4px 4px 0}.list--bulleted app-list-item:not(:last-child):after{content:" \\2022  ";float:right;padding-right:4px;padding-left:4px}.list--flat app-list-item:not(:last-child){margin-bottom:4px}.list--inline{display:inline-flex;align-items:center;display:flex;flex-direction:row;flex-wrap:wrap}.list--inline app-list-item{margin:0 8px 4px 0}.list__item{display:block}\n'],encapsulation:2,changeDetection:0})}return S})()},98101:(le,N,n)=>{"use strict";n.d(N,{P:()=>f});var e=n(85052),t=n(35426),s=n(37925),c=n(54438),O=n(60177);function P(E,y){if(1&E&&(c.j41(0,"span",4),c.EFF(1),c.k0s()),2&E){const i=c.XpG(2);c.R7$(),c.Lme("",i.remainingCount," ",1===i.remainingCount?"character":"characters"," remaining")}}function S(E,y){if(1&E&&(c.j41(0,"span",4),c.EFF(1),c.k0s()),2&E){const i=c.XpG(2);c.R7$(),c.Lme("",i.count,"/",i.max,"")}}function a(E,y){if(1&E&&(c.j41(0,"div",1),c.DNE(1,P,2,2,"span",2)(2,S,2,2,"span",3),c.k0s()),2&E){const i=c.XpG();c.AVh("counter--inline","inline"===i.display),c.Y8G("ngSwitch",i.mode),c.R7$(),c.Y8G("ngSwitchCase","remaining")}}let f=(()=>{class E{get remainingCount(){return this.max-this.count}constructor(i){this.ref=i,this.ngUnsubscribe=new e.B,this.display="block",this.mode="count"}ngOnInit(){this.count=0,this.max=this.field.maxLength||0}ngAfterViewInit(){this.getValueChanges().pipe((0,s.Q)(this.ngUnsubscribe)).subscribe(()=>{this.updateCount()})}ngAfterContentChecked(){this.updateCount()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}updateCount(){const i=this.getValue().length;this.count!==i&&(this.count=i,this.ref.markForCheck())}getValueChanges(){return this.field.getValueChanges?this.field.getValueChanges():(0,t.R)(this.field,"input")}getValue(){return typeof this.field.textValue<"u"?this.field.textValue:this.field.value}static#e=this.\u0275fac=function(g){return new(g||E)(c.rXU(c.gRc))};static#t=this.\u0275cmp=c.VBU({type:E,selectors:[["app-character-counter"]],inputs:{field:"field",display:"display",mode:"mode"},decls:1,vars:1,consts:[["class","counter text-2xs pt-1 pb-1",3,"counter--inline","ngSwitch",4,"ngIf"],[1,"counter","text-2xs","pt-1","pb-1",3,"ngSwitch"],["class","counter__label",4,"ngSwitchCase"],["class","counter__label",4,"ngSwitchDefault"],[1,"counter__label"]],template:function(g,p){1&g&&c.DNE(0,a,3,4,"div",0),2&g&&c.Y8G("ngIf",p.max)},dependencies:[O.bT,O.ux,O.e1,O.fG],styles:[".theme-light[_nghost-%COMP%]   .counter__label[_ngcontent-%COMP%], .theme-light   [_nghost-%COMP%]   .counter__label[_ngcontent-%COMP%]{color:#1c2a3f}.theme-dark[_nghost-%COMP%]   .counter__label[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .counter__label[_ngcontent-%COMP%]{color:#96a8c0}.counter[_ngcontent-%COMP%]{display:block;width:100%;float:right;text-align:right}.counter--inline[_ngcontent-%COMP%]{display:inline-block;width:auto}"]})}return E})()},76115:(le,N,n)=>{"use strict";n.d(N,{H:()=>s});var e=n(15877),t=n(68947);function s(c){return O=>{const P=t.l.parseEmails(O.value),S=P.filter(y=>!t.l.validateEmail(y)),a=P.length,f="number"==typeof c&&a>c;let E={};return f&&(E={...E,maxEmailsExceeded:f,currentEmailCount:a}),S.length>0&&(E={...E,invalidEmails:S}),Object.keys(E).length>0?(0,e.of)(E):(0,e.of)(null)}}},87505:(le,N,n)=>{"use strict";n.d(N,{K:()=>v});var e=n(85052),t=n(35426),s=n(37925),c=n(54438),O=n(60177);const P=["labelEl"],S=["*",[["","form-field-help",""]]],a=["*","[form-field-help]"],f=(d,r,_,u)=>({"field--light":d,"field--dark":r,"field--inline":_,"field--compact":u});function E(d,r){1&d&&c.eu8(0)}function y(d,r){if(1&d&&(c.j41(0,"label",4,1),c.DNE(2,E,1,0,"ng-container",5),c.k0s()),2&d){const _=c.XpG(),u=c.sdS(4);c.BMQ("aria-label",_.label),c.R7$(2),c.Y8G("ngTemplateOutlet",u)}}function i(d,r){1&d&&c.eu8(0)}function g(d,r){if(1&d&&(c.j41(0,"div",4),c.DNE(1,i,1,0,"ng-container",5),c.k0s()),2&d){const _=c.XpG(),u=c.sdS(4);c.BMQ("aria-label",_.label),c.R7$(),c.Y8G("ngTemplateOutlet",u)}}function p(d,r){if(1&d&&(c.j41(0,"div",10),c.EFF(1),c.k0s()),2&d){const _=c.XpG(2);c.AVh("uppercase",_.uppercase),c.R7$(),c.SpI(" ",_.label," ")}}function h(d,r){if(1&d&&(c.j41(0,"div",11),c.EFF(1),c.k0s()),2&d){const _=c.XpG(2);c.R7$(),c.SpI(" ",_.labelHelp," ")}}function o(d,r){if(1&d&&(c.DNE(0,p,2,3,"div",6)(1,h,2,1,"div",7),c.j41(2,"div",8),c.SdG(3),c.j41(4,"div",9),c.SdG(5,1),c.k0s()()),2&d){const _=c.XpG();c.Y8G("ngIf",_.label),c.R7$(),c.Y8G("ngIf",_.labelHelp)}}let v=(()=>{class d{constructor(){this.display="block",this.theme="dark",this.uppercase=!0,this.isCompact=!1,this.labelElement=!0,this.ngUnsubscribe=new e.B}ngOnInit(){}ngAfterViewInit(){this.labelEl&&this.initLabel()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initLabel(){this.labelEl.nativeElement.querySelectorAll("[contenteditable]").length>0&&(0,t.R)(this.labelEl.nativeElement,"click").pipe((0,s.Q)(this.ngUnsubscribe)).subscribe(l=>{l.preventDefault()})}static#e=this.\u0275fac=function(u){return new(u||d)};static#t=this.\u0275cmp=c.VBU({type:d,selectors:[["app-form-field"]],viewQuery:function(u,l){if(1&u&&c.GBs(P,5),2&u){let m;c.mGM(m=c.lsd())&&(l.labelEl=m.first)}},inputs:{label:"label",labelHelp:"labelHelp",display:"display",theme:"theme",uppercase:"uppercase",isCompact:"isCompact",labelElement:"labelElement"},ngContentSelectors:a,decls:5,vars:8,consts:[["contentTemplate",""],["labelEl",""],["data-test","formField",1,"field",3,"ngClass"],["class","field__container",4,"ngIf"],[1,"field__container"],[4,"ngTemplateOutlet"],["class","field__label text-2xs","data-test","formFieldLabel",3,"uppercase",4,"ngIf"],["class","text-xs text-gray-400 my-1",4,"ngIf"],[1,"field__input"],[1,"field__help","text-gray-400","text-xs"],["data-test","formFieldLabel",1,"field__label","text-2xs"],[1,"text-xs","text-gray-400","my-1"]],template:function(u,l){1&u&&(c.NAR(S),c.j41(0,"div",2),c.DNE(1,y,3,2,"label",3)(2,g,2,2,"div",3)(3,o,6,2,"ng-template",null,0,c.C5r),c.k0s()),2&u&&(c.Y8G("ngClass",c.ziG(3,f,"light"===l.theme,"dark"===l.theme,"inline"===l.display,l.isCompact)),c.R7$(),c.Y8G("ngIf",l.labelElement),c.R7$(),c.Y8G("ngIf",!l.labelElement))},dependencies:[O.YU,O.bT,O.T3],styles:[".field[_ngcontent-%COMP%]{padding-bottom:16px;display:block;width:100%}.field__input[_ngcontent-%COMP%]{margin-top:4px}.field--light[_ngcontent-%COMP%]   .field__label[_ngcontent-%COMP%]{color:#374a68}.field--dark[_ngcontent-%COMP%]   .field__label[_ngcontent-%COMP%]{color:#96a8c0}.field--inline[_ngcontent-%COMP%]   .field__container[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;width:auto}.field--inline[_ngcontent-%COMP%]   .field__label[_ngcontent-%COMP%]{margin-right:8px}.field--inline[_ngcontent-%COMP%]   .field__input[_ngcontent-%COMP%]{margin-top:auto}.field--compact[_ngcontent-%COMP%]{padding-bottom:0}.field__help[_ngcontent-%COMP%]:not(:empty){padding-top:4px}"],changeDetection:0})}return d})()},3272:(le,N,n)=>{"use strict";n.d(N,{D:()=>s});var e=n(60177),t=n(54438);let s=(()=>{class c{static#e=this.\u0275fac=function(S){return new(S||c)};static#t=this.\u0275mod=t.$C({type:c});static#n=this.\u0275inj=t.G2t({imports:[e.MD]})}return c})()},8961:(le,N,n)=>{"use strict";n.d(N,{X:()=>h});var e=n(49969),t=n(85052),s=n(14264),c=n(87996),O=n(37925),P=n(86050),S=n(54438),a=n(60177),f=n(26779);const E=["*"];function y(o,v){if(1&o&&(S.j41(0,"div",7),S.nrm(1,"app-icon",8),S.k0s()),2&o){const d=S.XpG(2);S.R7$(),S.Y8G("icon",d.icon)}}function i(o,v){if(1&o&&(S.j41(0,"h3",9),S.EFF(1),S.k0s()),2&o){const d=S.XpG(2);S.R7$(),S.JRh(d.title)}}function g(o,v){if(1&o){const d=S.RV6();S.j41(0,"button",10),S.bIt("click",function(){S.eBV(d);const _=S.XpG(2);return S.Njj(_.handleDismissClicked())}),S.nrm(1,"app-icon",11),S.k0s()}}function p(o,v){if(1&o&&(S.j41(0,"div",1)(1,"div",2),S.DNE(2,y,2,1,"div",3),S.j41(3,"div",4),S.DNE(4,i,2,1,"h3",5),S.j41(5,"p"),S.SdG(6),S.k0s()()(),S.DNE(7,g,2,0,"button",6),S.k0s()),2&o){const d=S.XpG();S.AVh("message-toggle--message","message"===d.type)("message-toggle--error","error"===d.type)("message-toggle--danger","danger"===d.type)("message-toggle--notification","notification"===d.type)("message-toggle--warning","warning"===d.type)("message-toggle--rounded","rounded"===d.toggleStyle)("message-toggle--light","light"===d.theme)("message-toggle--dark","dark"===d.theme)("message-toggle--left","left"===d.toggleAlign)("message-toggle--center","center"===d.toggleAlign)("message-toggle--icon-top","top"===d.alignIcon)("message-toggle--icon-center","center"===d.alignIcon)("message-toggle--icon-bottom","bottom"===d.alignIcon),S.Y8G("@show",void 0),S.R7$(2),S.Y8G("ngIf",d.icon),S.R7$(2),S.Y8G("ngIf",d.title),S.R7$(3),S.Y8G("ngIf",d.dismiss)}}let h=(()=>{class o{get shown(){return this._shown}set shown(d){this._shown!==d&&(this._shown=d,this.shownSubject.next(d),this.changeRef.markForCheck())}constructor(d){this.changeRef=d,this.type="message",this.theme="light",this.toggleAlign="left",this.alignIcon="top",this.showDelay=0,this.hideDelay=5e3,this.dismiss=!1,this.toggleStyle="rounded",this.handleDismiss=new t.B,this._shown=!0,this.shownSubject=new t.B,this.ngUnsubscribe=new t.B}ngOnInit(){this.initViewShownListeners()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}handleDismissClicked(){this.handleDismiss.next()}initViewShownListeners(){this.shownSubject.pipe((0,s.p)(()=>this.hideDelay>0),(0,c.B)(this.hideDelay),(0,s.p)(d=>d),(0,O.Q)(this.ngUnsubscribe)).subscribe(()=>{this._shown=!1,this.changeRef.markForCheck()})}static#e=this.\u0275fac=function(r){return new(r||o)(S.rXU(S.gRc))};static#t=this.\u0275cmp=S.VBU({type:o,selectors:[["app-message-toggle"]],inputs:{type:"type",theme:"theme",toggleAlign:"toggleAlign",icon:"icon",alignIcon:"alignIcon",title:"title",showDelay:"showDelay",hideDelay:"hideDelay",dismiss:"dismiss",toggleStyle:"toggleStyle",shown:"shown"},outputs:{handleDismiss:"handleDismiss"},ngContentSelectors:E,decls:1,vars:1,consts:[["class","message-toggle flex flex-row items-start justify-between",3,"message-toggle--message","message-toggle--error","message-toggle--danger","message-toggle--notification","message-toggle--warning","message-toggle--rounded","message-toggle--light","message-toggle--dark","message-toggle--left","message-toggle--center","message-toggle--icon-top","message-toggle--icon-center","message-toggle--icon-bottom",4,"ngIf"],[1,"message-toggle","flex","flex-row","items-start","justify-between"],[1,"message-toggle__wrapper","flex","flex-row","flex-auto"],["class","message-toggle__icon mr-3",4,"ngIf"],[1,"message-toggle__content"],["class","font-semibold mb-1",4,"ngIf"],["class","message-toggle__icon message-toggle__dismiss",3,"click",4,"ngIf"],[1,"message-toggle__icon","mr-3"],[3,"icon"],[1,"font-semibold","mb-1"],[1,"message-toggle__icon","message-toggle__dismiss",3,"click"],["icon","times"]],template:function(r,_){1&r&&(S.NAR(),S.DNE(0,p,8,30,"div",0)),2&r&&S.Y8G("ngIf",_.shown)},dependencies:[a.bT,f.R],styles:[":root{--message-toggle-color: #1c2a3f;--message-toggle-background-color: #f0f8ff;--message-toggle-icon-color: #2d72dc}.message-toggle{padding:16px;box-sizing:border-box;font-size:13px;line-height:20px;color:var(--message-toggle-color);background-color:var(--message-toggle-background-color)}.message-toggle--rounded{border-radius:4px}.message-toggle__icon{color:#fff;font-size:16px;background:none;border:none;color:var(--message-toggle-icon-color)}.message-toggle__content{padding:0 2px;word-break:break-word}.message-toggle__dismiss{font-size:14px;color:var(--message-toggle-color);cursor:pointer}.message-toggle--left .message-toggle__content{flex:1 1 auto}.message-toggle--center .message-toggle__wrapper{justify-content:center}.message-toggle--icon-top .message-toggle__icon{align-self:flex-start}.message-toggle--icon-center .message-toggle__icon{align-self:center}.message-toggle--icon-bottom .message-toggle__icon{align-self:flex-end}.message-toggle.message-toggle--message{--message-toggle-color: #1c2a3f;--message-toggle-background-color: #f0fff0;--message-toggle-icon-color: #33cd54}.message-toggle.message-toggle--notification{--message-toggle-color: #1c2a3f;--message-toggle-background-color: #f0f8ff;--message-toggle-icon-color: #2d72dc}.message-toggle.message-toggle--warning{--message-toggle-color: #1c2a3f;--message-toggle-background-color: #fffcf0;--message-toggle-icon-color: #ffb92e}.message-toggle.message-toggle--error,.message-toggle.message-toggle--danger{--message-toggle-color: #1c2a3f;--message-toggle-background-color: #fff3f0;--message-toggle-icon-color: #f44336}.message-toggle--dark.message-toggle--message{--message-toggle-background-color: #e3ffe5}.message-toggle--dark.message-toggle--notification{--message-toggle-background-color: #d6ecff}.message-toggle--dark.message-toggle--warning{--message-toggle-background-color: #fff6d1}.message-toggle--dark.message-toggle--error,.message-toggle--dark.message-toggle--danger{--message-toggle-background-color: #ffe2db}\n"],encapsulation:2,data:{animation:[(0,e.hZ)("show",[(0,e.kY)(":enter",[(0,e.sM)(P.O.fadeIn,{params:{duration:300}})]),(0,e.kY)(":leave",[(0,e.sM)(P.O.fadeOut,{params:{duration:300}})])])]},changeDetection:0})}return o})()},24184:(le,N,n)=>{"use strict";n.d(N,{C:()=>a});var e=n(60177),t=n(76939),s=n(32996),c=n(72026),O=n(11818),P=n(21604),S=n(54438);let a=(()=>{class f{static#e=this.\u0275fac=function(i){return new(i||f)};static#t=this.\u0275mod=S.$C({type:f});static#n=this.\u0275inj=S.G2t({imports:[e.MD,t.jc,s.z,c.o,O.C,P.G]})}return f})()},81488:(le,N,n)=>{"use strict";n.d(N,{f:()=>c});var e=n(60177),t=n(72026),s=n(54438);let c=(()=>{class O{static#e=this.\u0275fac=function(a){return new(a||O)};static#t=this.\u0275mod=s.$C({type:O});static#n=this.\u0275inj=s.G2t({imports:[e.MD,t.o]})}return O})()},90413:(le,N,n)=>{"use strict";n.d(N,{D:()=>H});var e=n(54438),t=n(47610),s=n(13409),c=n(27180),O=n(61295),P=n(4951),S=n(59115),a=n(63365),f=n(58398),E=n(81881),y=n(47555),i=n(41862),g=n(45415),p=n(94604),h=n(43631),o=n(94495),v=n(44867),d=n(60177),r=n(89511),_=n(11818),u=n(72026),l=n(71997),m=n(89079),C=n(92014),b=n(95416),R=n(18617),A=n(59369),G=n(21007),k=n(26779);const V=["nodeActionsTrigger"],W=(te,F)=>F.id;function T(te,F){if(1&te&&(e.qex(0),e.j41(1,"button",65),e.pXf(2,22),e.k0s(),e.nrm(3,"mat-divider"),e.bVm()),2&te){e.XpG();const w=e.sdS(30);e.R7$(),e.Y8G("matMenuTriggerFor",w)}}function x(te,F){1&te&&(e.qex(0),e.pXf(1,23),e.bVm())}function z(te,F){1&te&&(e.qex(0),e.pXf(1,24),e.bVm())}function I(te,F){if(1&te&&(e.qex(0),e.nrm(1,"mat-divider"),e.j41(2,"button",66),e.pXf(3,25),e.k0s(),e.bVm()),2&te){e.XpG();const w=e.sdS(49);e.R7$(2),e.Y8G("matMenuTriggerFor",w)}}function D(te,F){if(1&te&&(e.qex(0),e.nrm(1,"mat-divider"),e.j41(2,"button",67),e.pXf(3,26),e.k0s(),e.bVm()),2&te){e.XpG(2);const w=e.sdS(56);e.R7$(2),e.Y8G("matMenuTriggerFor",w)}}function L(te,F){if(1&te&&e.DNE(0,D,4,1,"ng-container",47),2&te){const w=e.XpG();e.Y8G("appFlagApplication",w.application.Loft)("appFlagApplicationMode","include")("appFlagApplicationPage","/edit")}}function Q(te,F){1&te&&e.nrm(0,"mat-divider")}function ie(te,F){if(1&te){const w=e.RV6();e.j41(0,"button",68),e.bIt("click",function(){e.eBV(w);const oe=e.XpG();return e.Njj(oe.editNodeLabel(oe.node()))}),e.pXf(1,27),e.k0s()}}function se(te,F){if(1&te){const w=e.RV6();e.qex(0),e.j41(1,"button",64),e.bIt("click",function(){e.eBV(w);const oe=e.XpG();return e.Njj(oe.copy(oe.node().label))}),e.pXf(2,28),e.k0s(),e.bVm()}}function Z(te,F){if(1&te&&(e.j41(0,"button",70),e.pXf(1,30),e.k0s()),2&te){e.XpG(2);const w=e.sdS(69);e.Y8G("matMenuTriggerFor",w)}}function de(te,F){if(1&te&&(e.qex(0),e.j41(1,"button",69),e.pXf(2,29),e.k0s(),e.DNE(3,Z,2,1,"button",70),e.bVm()),2&te){const w=e.XpG(),X=e.sdS(60);e.R7$(),e.Y8G("matMenuTriggerFor",X),e.R7$(2),e.vxM(w.node().boolState.available?3:-1)}}function ae(te,F){if(1&te){const w=e.RV6();e.qex(0),e.nrm(1,"mat-divider"),e.j41(2,"button",71),e.bIt("click",function(){e.eBV(w);const oe=e.XpG();return e.Njj(oe.samplePaint(oe.node()))}),e.pXf(3,31),e.k0s(),e.bVm()}}function q(te,F){if(1&te){const w=e.RV6();e.j41(0,"button",72),e.bIt("click",function(){e.eBV(w);const oe=e.XpG();return e.Njj(oe.toggleVisible(oe.node(),!1))}),e.pXf(1,32),e.k0s()}}function K(te,F){if(1&te){const w=e.RV6();e.j41(0,"button",73),e.bIt("click",function(){e.eBV(w);const oe=e.XpG();return e.Njj(oe.toggleVisible(oe.node(),!0))}),e.pXf(1,33),e.k0s()}}function j(te,F){if(1&te){const w=e.RV6();e.j41(0,"button",74),e.bIt("click",function(){e.eBV(w);const oe=e.XpG();return e.Njj(oe.togglePickable(oe.node(),!1))}),e.pXf(1,34),e.k0s()}}function M(te,F){if(1&te){const w=e.RV6();e.j41(0,"button",75),e.bIt("click",function(){e.eBV(w);const oe=e.XpG();return e.Njj(oe.togglePickable(oe.node(),!0))}),e.pXf(1,35),e.k0s()}}function $(te,F){if(1&te){const w=e.RV6();e.j41(0,"button",76),e.bIt("click",function(){e.eBV(w);const oe=e.XpG();return e.Njj(oe.toggleAvailable(oe.node(),!1))}),e.pXf(1,36),e.k0s()}}function ce(te,F){if(1&te){const w=e.RV6();e.j41(0,"button",77),e.bIt("click",function(){e.eBV(w);const oe=e.XpG();return e.Njj(oe.toggleAvailable(oe.node(),!0))}),e.pXf(1,37),e.k0s()}}function re(te,F){if(1&te){const w=e.RV6();e.j41(0,"button",62),e.bIt("click",function(){e.eBV(w);const oe=e.XpG().$implicit,Y=e.XpG();return e.Njj(Y.copyChapterPaint(Y.node(),oe.id))}),e.pXf(1,38),e.k0s()}if(2&te){const w=e.XpG().$index;e.R7$(),e.uP7(w+1),e.nnv(1)}}function ue(te,F){if(1&te&&e.DNE(0,re,2,1,"button",78),2&te){const w=F.$implicit,X=e.XpG();e.vxM(w.id!==X.selectedChapterId()?0:-1)}}let H=(()=>{class te{constructor(w,X,oe,Y,he,ne){this.store=w,this.clipboardService=X,this.snackbar=oe,this.liveAnnouncer=Y,this.nodeService=he,this.changeDetectorRef=ne,this.application=c.c,this.perChapterTreeEnabled=(0,m.ot)(this.store.select(h._.getPerChapterTreeEnabled)),this.chapters=(0,m.ot)(this.store.select(o.N.getStoryChapters)),this.selectedChapterId=(0,m.ot)(this.store.select(o.N.getSelectedChapterId)),this.node=(0,e.hFB)(),this.theme=(0,e.hFB)("dark"),this.shortId=(0,e.EWP)(()=>{const _e=this.node();return(0,v.KJ)(_e.id)}),this.eventCategory=(0,e.hFB)(""),this.nodeActionsClosed=(0,e.CGW)(),this.nodeActionsTrigger=(0,e.ebz)("nodeActionsTrigger")}isNodeChecked(w){return this.store.selectSnapshot(s.z.getNodes)[w].checked}isNodeShown(w){return this.store.selectSnapshot(s.z.getNodes)[w].shown}checkNode(w,X){const oe=void 0===X?!this.isNodeChecked(w.id):X;this.store.dispatch(new O.q9(oe,[w.id]))}checkInverse(w){this.store.dispatch(new O.q9(!0)),this.store.dispatch(new O.q9(!1,[w.id]))}setCheckedNodes(w,X){this.store.dispatch(new O.q9(!1));const oe=void 0===X?!this.isNodeChecked(w.id):X;this.store.dispatch(new O.q9(oe,[w.id]))}flyToNode(w){this.store.dispatch(new t.W6(w.id)).subscribe(()=>{this.liveAnnouncer.announce("Fly to complete")})}hideNode(w){this.store.dispatch(new O.yr(!1,[w.id]))}showNode(w){this.store.dispatch(new O.yr(!0,[w.id])),this.changeDetectorRef.markForCheck()}toggleVisible(w,X){const oe=void 0===X?this.isNodeShown(w.id):X;this.store.dispatch(new O.yr(oe,[w.id])),this.changeDetectorRef.markForCheck()}togglePickable(w,X){this.store.dispatch(new O.Ke(X,[w.id])),this.changeDetectorRef.markForCheck()}makeEverythingElseUnpickale(w){this.store.dispatch(new O.Ke(!1)),this.store.dispatch(new O.Ke(!0,[w.id]))}toggleAvailable(w,X){this.store.dispatch(new O.Ws(X,[w.id])),this.changeDetectorRef.markForCheck()}hideInverse(w){this.nodeService.hideInverse([w.id])}fadeNode(w){this.nodeService.fade([w.id])}fadeInverseNodes(w){this.nodeService.fadeInverse([w.id])}editNodeLabel(w){this.store.dispatch(new t._o(w)),this.store.dispatch(new t.ro(w))}copy(w){this.clipboardService.copyToClipboard(w,"text").subscribe(()=>{this.snackbar.open(`Copied ${w} to clipboard.`)})}onMenuClosed(){this.nodeActionsClosed.emit()}samplePaint(w){const X=this.store.selectSnapshot(s.z.getNodePaint)(w.id),oe=(0,a.Sf)(X);(0,f.Jl)(oe)?this.store.dispatch(new E.WD(X)):this.store.dispatch(new E.Hr),this.store.dispatch(new t.pL(y.s.Paint)),this.store.dispatch(new i.yF(g.x.Paint))}copyChapterPaint(w,X){this.store.dispatch(new O.ZF([w.id],X))}static#e=this.\u0275fac=function(X){return new(X||te)(e.rXU(C.il),e.rXU(P.W),e.rXU(b.UG),e.rXU(R.Ai),e.rXU(p.w),e.rXU(e.gRc))};static#t=this.\u0275cmp=e.VBU({type:te,selectors:[["app-node-actions"]],viewQuery:function(X,oe){1&X&&e.wEZ(oe.nodeActionsTrigger,V,5),2&X&&e.NyB()},inputs:{node:[1,"node"],theme:[1,"theme"],eventCategory:[1,"eventCategory"]},outputs:{nodeActionsClosed:"nodeActionsClosed"},standalone:!0,features:[e.aNF],decls:72,vars:31,consts:()=>{let w,X,oe,Y,he,ne,_e,Ce,Be,Ie,Oe,Te,ve,Ve,we,Je,tt,st,rt,Ke,et,ge,Ee,Fe,$e,ot,je,xe,Me,Ue;return w=$localize`:8973bc8c23a3f7c42aa9bd447386a3b0d26b74bc278590554940342755:menu`,X=$localize`:0a1d519b102495c607707a8de3e121d9777eb8f57459515625406813591: Isolate `,oe=$localize`:3f42464a5a50bfc4200a744e960b2193b395d8336476624779946658339: Fade `,Y=$localize`:23054cc1a12bc2f02ce35c53dda0a85a599c42b91462430833776684733: Fly To `,he=$localize`:54cc524c29eb42615ed3660dbda137e40d9dd5027873649950229208086: Select This `,ne=$localize`:0fffdd57d53d51daf33ea3051cfee157555f7a052795853712015890159: Select Everything Else `,_e=$localize`:0ef9e3fa378a368d7def26850536752a3de491cf5280042464648975457: Fade This `,Ce=$localize`:b8640b44be68c687650962b406f6363a3b8758d76392506384252263496: Fade Everything Else `,Be=$localize`:59e0b28333dd6b25a8fccbe60b09a1e3be64c3eb4950300091124319961:Hide Everything Else`,Ie=$localize`:3cea94df167f2ab21fb6fbca0ac24da30254ab374608376353419364284: Make Everything Else Unselectable `,Oe=$localize`:70b9aca63f75c39c1c4a5a05b2ba3023a77a2b089128837186595333201: Copy Short ID `,Te=$localize`:f9220e31a995fb0f115662c3b630782b55a205069004635034659549721: Copy Full ID `,ve=$localize`:0a3f724079cb80043738d1f0784a7563106faddc2488186665405139057: Copy Display Name `,Ve=$localize`:9ca82952a6bc860b5391d5975322d8af8ceddfa43797570084942068182:Select`,we=$localize`:1eede69e18c5ac9c0b0295b72cabb7e64e029e748461609631969932886:Hide`,Je=$localize`:2aba1e87039819aca3b70faa9aa848c12bf139ca8461842260159597706:Show`,tt=$localize`:864421378feb1d521cd7a7174c792db76b43a2187629795719386983652: Selectable / Unselectable `,st=$localize`:f8552086e072958cbd175fce6ca62724c5f313bb4966413469492836967: Available / Unavailable `,rt=$localize`:9ca20604245c07d56b1413d9e67a151a3ab2022d55699984583421362: Edit Display Name `,Ke=$localize`:db693767fd3d7ba3a7c6d19faf21fbacf09226512283300174173662646: Copy Display Name `,et=$localize`:353d39004ad14e085967669d05448251baab93a72821938014126744982: Copy `,ge=$localize`:9190906690c1c5cd2136c84fb81d0c85751dbc814172863901001023616: Paint `,Ee=$localize`:28fc8508c6148c461ec04013970b2ed628bfc06e6750409730286190445: Sample Paint `,Fe=$localize`:f05cec857f16c24d8db89c50f3059742cbbfbbda5339110957660716850: Hide This `,$e=$localize`:552d734ad4619a8965231cc491c0e85a7bb155c73401892363421578792: Show This `,ot=$localize`:968164c8722359889c83d149a11a5397358416601582264599495505864: Make Unselectable `,je=$localize`:e7a08e6fec5a48b10e609eb63886bbd92fbdbacf2477567055965309744: Make Selectable `,xe=$localize`:99751ab6a5c4c71f400d25371daa6fa7d8d74abb2837486388916680829: Make Unavailable `,Me=$localize`:7df51bb35892872f649fbbe6c8ae82dae9edcd123656836653049520580: Make Available `,Ue=$localize`:a8db3e589abd66249c1c5671c8587cc8b6714ffc6619637855472690038: Apply Chapter ${"\ufffd0\ufffd"}:INTERPOLATION: Paint `,[["nodeActionsTrigger","matMenuTrigger"],["nodeActions","matMenu"],["selectActions","matMenu"],["fadeActions","matMenu"],["showHideActions","matMenu"],["pickableActions","matMenu"],["availableActions","matMenu"],["copyActions","matMenu"],["paintActions","matMenu"],w,X,oe,Y,he,ne,_e,Ce,Be,Ie,Oe,Te,ve,Ve,we,Je,tt,st,rt,Ke,et,ge,Ee,Fe,$e,ot,je,xe,Me,Ue,["app-button","","data-test","nodeActionsTrigger","buttonSize","xs","buttonShape","square",3,"menuClosed","buttonTheme","matMenuTriggerFor"],["icon","ellipsis-v","aria-hidden","true"],[1,"sr-only"],[3,"overlapTrigger"],[4,"appFlagApplication","appFlagApplicationPage","appFlagApplicationMode"],["mat-menu-item","","data-test","nodeActionsHideShow",3,"click"],["mat-menu-item","","data-test","nodeActionsIsolate",3,"click"],["data-test","nodeActionsFadeTrigger","mat-menu-item","",3,"matMenuTriggerFor"],[4,"appFlagApplication","appFlagApplicationMode","appFlagApplicationPage"],["mat-menu-item","","data-test","nodeActionsFlyTo",3,"click"],["mat-menu-item","","data-test","nodeActionsEditName",3,"click",4,"appFlagApplication","appFlagApplicationPage","appFlagApplicationMode"],["mat-menu-item","","data-test","nodeActionsSelectThis",3,"click"],["mat-menu-item","","data-test","nodeActionsSelectEverythingElse",3,"click"],["mat-menu-item","","data-test","nodeActionsFadeThis",3,"click"],["mat-menu-item","","data-test","nodeActionsFadeEverythingElse",3,"click"],["mat-menu-item","","data-test","nodeActionsShowEverythingElse"],["mat-menu-item","","data-test","nodeActionsShowThis"],["mat-menu-item","",3,"click"],["mat-menu-item","","data-test","nodeActionsPickable"],["mat-menu-item","","data-test","nodeActionsUnpickable"],["mat-menu-item","","data-test","nodeActionsEverythingElseUnpickable",3,"click"],["mat-menu-item","","data-test","nodeActionsUnavailable"],["mat-menu-item","","data-test","nodeActionsAvailable"],["mat-menu-item","","data-test","nodeActionsCopyShortID",3,"click"],["mat-menu-item","","data-test","nodeActionsCopyFullID",3,"click"],["mat-menu-item","","data-test","nodeActionsCopyDisplayName",3,"click"],["mat-menu-item","",3,"matMenuTriggerFor"],["mat-menu-item","","data-test","nodeActionsPickableTrigger",3,"matMenuTriggerFor"],["mat-menu-item","","data-test","nodeActionsAvailableTrigger",3,"matMenuTriggerFor"],["mat-menu-item","","data-test","nodeActionsEditName",3,"click"],["mat-menu-item","","data-test","nodeActionsCopyTrigger",3,"matMenuTriggerFor"],["mat-menu-item","","data-test","nodeActionsPaintTrigger",3,"matMenuTriggerFor"],["mat-menu-item","","data-test","nodeActionsSamplePaint",3,"click"],["mat-menu-item","","data-test","nodeActionsShowEverythingElse",3,"click"],["mat-menu-item","","data-test","nodeActionsShowThis",3,"click"],["mat-menu-item","","data-test","nodeActionsPickable",3,"click"],["mat-menu-item","","data-test","nodeActionsUnpickable",3,"click"],["mat-menu-item","","data-test","nodeActionsUnavailable",3,"click"],["mat-menu-item","","data-test","nodeActionsAvailable",3,"click"],["mat-menu-item","","data-test","nodeActionsCopyShortID"]]},template:function(X,oe){if(1&X){const Y=e.RV6();e.qex(0),e.j41(1,"button",39,0),e.bIt("menuClosed",function(){return e.eBV(Y),e.Njj(oe.onMenuClosed())}),e.nrm(3,"app-icon",40),e.j41(4,"span",41),e.EFF(5),e.qex(6),e.pXf(7,9),e.bVm(),e.k0s()(),e.j41(8,"mat-menu",42,1),e.DNE(10,T,4,1,"ng-container",43),e.j41(11,"button",44),e.bIt("click",function(){return e.eBV(Y),e.Njj(oe.toggleVisible(oe.node(),!oe.node().boolState.shown))}),e.DNE(12,x,2,0,"ng-container")(13,z,2,0,"ng-container"),e.k0s(),e.j41(14,"button",45),e.bIt("click",function(){return e.eBV(Y),e.Njj(oe.hideInverse(oe.node()))}),e.pXf(15,10),e.k0s(),e.nrm(16,"mat-divider"),e.j41(17,"button",46),e.pXf(18,11),e.k0s(),e.DNE(19,I,4,1,"ng-container",47)(20,L,1,3,"ng-container"),e.nrm(21,"mat-divider"),e.j41(22,"button",48),e.bIt("click",function(){return e.eBV(Y),e.Njj(oe.flyToNode(oe.node()))}),e.pXf(23,12),e.k0s(),e.DNE(24,Q,1,0,"mat-divider",43)(25,ie,2,0,"button",49)(26,se,3,0,"ng-container",43)(27,de,4,2,"ng-container",43)(28,ae,4,0,"ng-container",43),e.k0s(),e.j41(29,"mat-menu",null,2)(31,"button",50),e.bIt("click",function(){return e.eBV(Y),e.Njj(oe.checkNode(oe.node(),!0))}),e.pXf(32,13),e.k0s(),e.j41(33,"button",51),e.bIt("click",function(){return e.eBV(Y),e.Njj(oe.checkInverse(oe.node()))}),e.pXf(34,14),e.k0s()(),e.j41(35,"mat-menu",null,3)(37,"button",52),e.bIt("click",function(){return e.eBV(Y),e.Njj(oe.fadeNode(oe.node()))}),e.pXf(38,15),e.k0s(),e.j41(39,"button",53),e.bIt("click",function(){return e.eBV(Y),e.Njj(oe.fadeInverseNodes(oe.node()))}),e.pXf(40,16),e.k0s()(),e.j41(41,"mat-menu",null,4),e.DNE(43,q,2,0,"button",54)(44,K,2,0,"button",55),e.nrm(45,"mat-divider"),e.j41(46,"button",56),e.bIt("click",function(){return e.eBV(Y),e.Njj(oe.hideInverse(oe.node()))}),e.pXf(47,17),e.k0s()(),e.j41(48,"mat-menu",null,5),e.DNE(50,j,2,0,"button",57)(51,M,2,0,"button",58),e.nrm(52,"mat-divider"),e.j41(53,"button",59),e.bIt("click",function(){return e.eBV(Y),e.Njj(oe.makeEverythingElseUnpickale(oe.node()))}),e.pXf(54,18),e.k0s()(),e.j41(55,"mat-menu",null,6),e.DNE(57,$,2,0,"button",60)(58,ce,2,0,"button",61),e.k0s(),e.j41(59,"mat-menu",null,7)(61,"button",62),e.bIt("click",function(){return e.eBV(Y),e.Njj(oe.copy(oe.shortId()))}),e.pXf(62,19),e.k0s(),e.j41(63,"button",63),e.bIt("click",function(){return e.eBV(Y),e.Njj(oe.copy(oe.node().id))}),e.pXf(64,20),e.k0s(),e.nrm(65,"mat-divider"),e.j41(66,"button",64),e.bIt("click",function(){return e.eBV(Y),e.Njj(oe.copy(oe.node().label))}),e.pXf(67,21),e.k0s()(),e.j41(68,"mat-menu",null,8),e.Z7z(70,ue,1,1,null,null,W),e.k0s(),e.bVm()}if(2&X){const Y=e.sdS(9),he=e.sdS(36);e.R7$(),e.Y8G("buttonTheme",oe.theme())("matMenuTriggerFor",Y),e.R7$(4),e.SpI("",oe.node().label," "),e.R7$(3),e.Y8G("overlapTrigger",!0),e.R7$(2),e.Y8G("appFlagApplication",oe.application.All)("appFlagApplicationPage","/edit")("appFlagApplicationMode","include"),e.R7$(2),e.vxM(oe.node().boolState.shown?12:13),e.R7$(5),e.Y8G("matMenuTriggerFor",he),e.R7$(2),e.Y8G("appFlagApplication",oe.application.All)("appFlagApplicationMode","include")("appFlagApplicationPage","/edit"),e.R7$(),e.vxM(oe.perChapterTreeEnabled()?20:-1),e.R7$(4),e.Y8G("appFlagApplication",oe.application.All)("appFlagApplicationPage","/edit")("appFlagApplicationMode","include"),e.R7$(),e.Y8G("appFlagApplication",oe.application.All)("appFlagApplicationPage","/edit")("appFlagApplicationMode","include"),e.R7$(),e.Y8G("appFlagApplication",oe.application.Studio)("appFlagApplicationPage","/edit")("appFlagApplicationMode","include"),e.R7$(),e.Y8G("appFlagApplication",oe.application.Loft)("appFlagApplicationPage","/edit")("appFlagApplicationMode","include"),e.R7$(),e.Y8G("appFlagApplication",oe.application.All)("appFlagApplicationPage","/edit")("appFlagApplicationMode","include"),e.R7$(15),e.vxM(oe.node().boolState.shown?43:44),e.R7$(7),e.vxM(oe.node().boolState.pickable?50:51),e.R7$(7),e.vxM(oe.node().boolState.available?57:58),e.R7$(13),e.Dyx(oe.chapters())}},dependencies:[d.MD,S.Cn,S.kk,S.fb,S.Cp,l.w,l.q,r.h,A.Y,_.C,G.Q,u.o,k.R],changeDetection:0})}return te})()},82192:(le,N,n)=>{"use strict";n.d(N,{G:()=>a});var e=n(60177),t=n(90413),s=n(45189),c=n(72026),O=n(11818),P=n(89511),S=n(54438);let a=(()=>{class f{static#e=this.\u0275fac=function(i){return new(i||f)};static#t=this.\u0275mod=S.$C({type:f});static#n=this.\u0275inj=S.G2t({imports:[e.MD,P.h,s.G,O.C,c.o,t.D]})}return f})()},48948:(le,N,n)=>{"use strict";n.d(N,{p:()=>c});var e=n(54438),t=n(60177);const s=(O,P)=>({"pillbox-divider--horizontal":O,"pillbox-divider--vertical":P});let c=(()=>{class O{constructor(){this.orientation="horizontal"}ngOnInit(){}get justifySelf(){return"vertical"===this.orientation?"stretch":""}get alignSelf(){return"horizontal"===this.orientation?"stretch":""}static#e=this.\u0275fac=function(a){return new(a||O)};static#t=this.\u0275cmp=e.VBU({type:O,selectors:[["app-pillbox-divider"]],hostVars:4,hostBindings:function(a,f){2&a&&e.xc7("justify-self",f.justifySelf)("align-self",f.alignSelf)},inputs:{orientation:"orientation"},decls:1,vars:4,consts:[[1,"pillbox-divider",3,"ngClass"]],template:function(a,f){1&a&&e.nrm(0,"div",0),2&a&&e.Y8G("ngClass",e.l_i(1,s,"horizontal"===f.orientation,"vertical"===f.orientation))},dependencies:[t.YU],styles:["[_nghost-%COMP%]{display:flex}.pillbox-divider[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none}.pillbox-divider--horizontal[_ngcontent-%COMP%]{height:100%;border-right:1px solid #d7e0ea}.pillbox-divider--vertical[_ngcontent-%COMP%]{width:40px;border-bottom:1px solid #d7e0ea}"],changeDetection:0})}return O})()},82487:(le,N,n)=>{"use strict";n.d(N,{O:()=>E});var e=n(54438),t=n(60177),s=n(65985),c=n(14823),O=n(26779),P=n(48948);const S=["*"],a=(y,i)=>({"pillbox--vertical":y,"pillbox--horizontal":i});function f(y,i){if(1&y){const g=e.RV6();e.qex(0),e.nrm(1,"app-pillbox-divider"),e.j41(2,"button",2),e.bIt("click",function(){e.eBV(g);const h=e.XpG();return e.Njj(h.handleExitClick())}),e.nrm(3,"app-icon",3),e.k0s(),e.bVm()}if(2&y){const g=e.XpG();e.R7$(2),e.Y8G("matTooltip","Close "+g.name),e.BMQ("aria-label","Close "+g.name)}}let E=(()=>{class y{constructor(){this.canExit=!1,this.padding="normal",this.orientation="horizontal",this.name="",this.exit=new e.bkB}ngOnInit(){}handleExitClick(){this.exit.emit()}static#e=this.\u0275fac=function(p){return new(p||y)};static#t=this.\u0275cmp=e.VBU({type:y,selectors:[["app-pillbox"]],inputs:{canExit:"canExit",padding:"padding",orientation:"orientation",name:"name"},outputs:{exit:"exit"},ngContentSelectors:S,decls:3,vars:5,consts:[[1,"pillbox",3,"ngClass"],[4,"ngIf"],["data-test","closePillboxButton","app-view-button","",3,"click","matTooltip"],["icon","times"]],template:function(p,h){1&p&&(e.NAR(),e.j41(0,"div",0),e.SdG(1),e.DNE(2,f,4,2,"ng-container",1),e.k0s()),2&p&&(e.Y8G("ngClass",e.l_i(2,a,"vertical"===h.orientation,"horizontal"===h.orientation)),e.R7$(2),e.Y8G("ngIf",h.canExit))},dependencies:[t.YU,t.bT,s.ri,c.oV,O.R,P.p],styles:[":host{display:inline-block}.pillbox{box-shadow:0 1px 4px 1px #0500380a;border:1px solid #d7e0ea;pointer-events:all;background:#fffffff2;border-radius:4px;display:flex;overflow:hidden;transition:all .1s ease-out}.pillbox:empty{border:0;box-shadow:none}.pillbox:hover{background:#fff}.pillbox--vertical{flex-direction:column;align-items:center}.pillbox--horizontal{flex-direction:row}\n"],encapsulation:2,changeDetection:0})}return y})()},46374:(le,N,n)=>{"use strict";n.d(N,{b:()=>P});var e=n(60177),t=n(11818),s=n(45189),c=n(72026),O=n(54438);let P=(()=>{class S{static#e=this.\u0275fac=function(E){return new(E||S)};static#t=this.\u0275mod=O.$C({type:S});static#n=this.\u0275inj=O.G2t({imports:[e.MD,t.C,s.G,c.o]})}return S})()},59162:(le,N,n)=>{"use strict";n.d(N,{M:()=>s});var e=n(60177),t=n(54438);let s=(()=>{class c{static#e=this.\u0275fac=function(S){return new(S||c)};static#t=this.\u0275mod=t.$C({type:c});static#n=this.\u0275inj=t.G2t({imports:[e.MD]})}return c})()},97352:(le,N,n)=>{"use strict";n.d(N,{tI:()=>a});var e=n(54438),t=n(60177);const s=(f,E,y)=>[f,E,y];function c(f,E){if(1&f&&(e.j41(0,"div",3),e.EFF(1),e.k0s()),2&f){const y=e.XpG();e.R7$(),e.SpI(" ",y.label," ")}}var O=function(f){return f.Small="small",f.Medium="medium",f.Large="large",f.Huge="huge",f}(O||{}),P=function(f){return f.Horizontal="horizontal",f.Vertical="vertical",f}(P||{}),S=function(f){return f.Inline="inline",f.Block="block",f.Fill="fill",f}(S||{});let a=(()=>{class f{constructor(){this.size=O.Medium,this.label="",this.direction=P.Horizontal,this.render=S.Fill}ngOnInit(){}static#e=this.\u0275fac=function(i){return new(i||f)};static#t=this.\u0275cmp=e.VBU({type:f,selectors:[["app-spinner"]],inputs:{size:"size",label:"label",direction:"direction",render:"render"},decls:3,vars:6,consts:[[1,"spinner","spinner--horizontal",3,"ngClass"],[1,"spinner__circle"],["class","spinner__label",4,"ngIf"],[1,"spinner__label"]],template:function(i,g){1&i&&(e.j41(0,"div",0),e.nrm(1,"div",1),e.DNE(2,c,2,1,"div",2),e.k0s()),2&i&&(e.Y8G("ngClass",e.sMw(2,s,"spinner--"+g.size,"spinner--"+g.render,"spinner--"+g.direction)),e.R7$(2),e.Y8G("ngIf",g.label.length))},dependencies:[t.YU,t.bT],styles:['@keyframes _ngcontent-%COMP%_spinner{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.spinner[_ngcontent-%COMP%]{display:inline-flex;justify-content:center;align-items:center}.spinner--small[_ngcontent-%COMP%]   .spinner__circle[_ngcontent-%COMP%]{width:11px;height:11px}.spinner--small[_ngcontent-%COMP%]   .spinner__circle[_ngcontent-%COMP%]:after{width:11px;height:11px}.spinner--small[_ngcontent-%COMP%]   .spinner__label[_ngcontent-%COMP%]{font-size:10px}.spinner--medium[_ngcontent-%COMP%]   .spinner__circle[_ngcontent-%COMP%]{width:14px;height:14px}.spinner--medium[_ngcontent-%COMP%]   .spinner__circle[_ngcontent-%COMP%]:after{width:14px;height:14px}.spinner--medium[_ngcontent-%COMP%]   .spinner__label[_ngcontent-%COMP%]{font-size:10px}.spinner--large[_ngcontent-%COMP%]   .spinner__circle[_ngcontent-%COMP%]{width:28px;height:28px}.spinner--large[_ngcontent-%COMP%]   .spinner__circle[_ngcontent-%COMP%]:after{width:28px;height:28px}.spinner--large[_ngcontent-%COMP%]   .spinner__label[_ngcontent-%COMP%]{font-size:14px}.spinner--huge[_ngcontent-%COMP%]   .spinner__circle[_ngcontent-%COMP%]{width:44px;height:44px}.spinner--huge[_ngcontent-%COMP%]   .spinner__circle[_ngcontent-%COMP%]:after{width:44px;height:44px}.spinner--huge[_ngcontent-%COMP%]   .spinner__label[_ngcontent-%COMP%]{font-size:16px}.spinner--horizontal[_ngcontent-%COMP%]{flex-direction:row}.spinner--vertical[_ngcontent-%COMP%]{align-items:center;flex-direction:column}.spinner--vertical[_ngcontent-%COMP%]   .spinner__label[_ngcontent-%COMP%]{padding:8px 0 0}.spinner--inline[_ngcontent-%COMP%]{display:inline-flex}.spinner--block[_ngcontent-%COMP%]{display:flex}.spinner--fill[_ngcontent-%COMP%]{display:flex;height:100%}.spinner__circle[_ngcontent-%COMP%]{width:14px;height:14px;border-radius:50%;border:2px solid rgba(16,24,35,.1);position:relative}.theme-dark[_nghost-%COMP%]   .spinner__circle[_ngcontent-%COMP%]{border-color:#fff6}.spinner__circle[_ngcontent-%COMP%]:after{animation:_ngcontent-%COMP%_spinner .4s linear infinite;content:" ";border-radius:50%;border:2px solid transparent;border-top-color:#fff3;border-right-color:#10182333;box-sizing:border-box;position:absolute;display:block;width:14px;height:14px;top:-2px;left:-2px}.theme-dark[_nghost-%COMP%]   .spinner__circle[_ngcontent-%COMP%]:after{border-top-color:#fff;border-right-color:#fff}.spinner__label[_ngcontent-%COMP%]{padding-left:8px;font-size:14px;text-transform:uppercase}.theme-dark[_nghost-%COMP%]   .spinner__label[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .spinner__label[_ngcontent-%COMP%]{color:#fff3}.theme-light[_nghost-%COMP%]   .spinner__label[_ngcontent-%COMP%], .theme-light   [_nghost-%COMP%]   .spinner__label[_ngcontent-%COMP%]{color:#10182399}'],changeDetection:0})}return f})()},66598:(le,N,n)=>{"use strict";n.d(N,{S:()=>c});var e=n(60177),t=n(89417),s=n(54438);let c=(()=>{class O{static#e=this.\u0275fac=function(a){return new(a||O)};static#t=this.\u0275mod=s.$C({type:O});static#n=this.\u0275inj=s.G2t({imports:[e.MD,t.YN]})}return O})()},87424:(le,N,n)=>{"use strict";n.d(N,{j:()=>O});var e=n(54438),t=n(60177);const s=["*"];function c(P,S){1&P&&(e.j41(0,"div"),e.SdG(1),e.k0s())}let O=(()=>{class P{get isActive(){return this._isActive}set isActive(a){this._isActive=a,this.changeDetector.markForCheck()}constructor(a){this.changeDetector=a,this.hide=!1,this._isActive=!1}ngOnInit(){}static#e=this.\u0275fac=function(f){return new(f||P)(e.rXU(e.gRc))};static#t=this.\u0275cmp=e.VBU({type:P,selectors:[["app-tab"]],inputs:{label:"label",hide:"hide"},ngContentSelectors:s,decls:1,vars:1,consts:[[4,"ngIf"]],template:function(f,E){1&f&&(e.NAR(),e.DNE(0,c,2,0,"div",0)),2&f&&e.Y8G("ngIf",E.isActive)},dependencies:[t.bT],changeDetection:0})}return P})()},59464:(le,N,n)=>{"use strict";n.d(N,{j:()=>c});var e=n(60177),t=n(45189),s=n(54438);let c=(()=>{class O{static#e=this.\u0275fac=function(a){return new(a||O)};static#t=this.\u0275mod=s.$C({type:O});static#n=this.\u0275inj=s.G2t({imports:[e.MD,t.G]})}return O})()},57018:(le,N,n)=>{"use strict";n.d(N,{O:()=>v});var e=n(54438),t=n(87424),s=n(29160),c=n(85052),O=n(37925),P=n(1670),S=n(14264),a=n(60177),f=n(71997);const E=["tabButton"],y=["*"],i=(d,r,_,u)=>({"tabs--small":d,"tabs--medium":r,"tabs--scrollable":_,"tabs--padded":u}),g=(d,r,_,u,l,m)=>({"tabs__label--dark":d,"tabs__label--light":r,"tabs__label--dark-active":_,"tabs__label--light-active":u,"tabs__label--blue":l,"tabs__label--red":m});function p(d,r){if(1&d){const _=e.RV6();e.j41(0,"button",7,1),e.bIt("click",function(){const l=e.eBV(_).$implicit,m=e.XpG();return e.Njj(m.handleTabSelect(l))}),e.EFF(2),e.k0s()}if(2&d){const _=r.$implicit,u=e.XpG();e.Y8G("ngClass",e.l4e(4,g,"dark"===u.tabTheme,"light"===u.tabTheme,"dark"===u.tabTheme&&u.isTabActive(_),"light"===u.tabTheme&&u.isTabActive(_),"blue"===u.tabColor,"red"===u.tabColor)),e.BMQ("aria-selected",u.isTabActive(_))("tabIndex",u.isTabActive(_)?0:-1),e.R7$(2),e.SpI(" ",_.label," ")}}function h(d,r){1&d&&e.nrm(0,"mat-divider")}let v=(()=>{class d{get activeTab(){return this._activeTab.value}set activeTab(_){null!=_&&("string"==typeof _&&(_=_.toUpperCase()),this._activeTab.next(_))}get tabItems(){return this._tabItems}set tabItems(_){this._tabItems=_}constructor(_){this.changeDetector=_,this.display="normal",this.tabTheme="dark",this.activeTabChange=new e.bkB,this._activeTab=new s.t(0),this.tabSize="small",this.tabAlign="default",this.tabColor="blue",this.tabUnderline=!1,this.tabPadded=!1,this.scrollable=!1,this.ngUnsubscribe=new c.B}ngAfterContentInit(){this._tabs.changes.pipe((0,O.Q)(this.ngUnsubscribe)).subscribe(_=>{this.mapTabs(),this.changeDetector.markForCheck()}),this.mapTabs(),this._activeTab.pipe((0,O.Q)(this.ngUnsubscribe)).subscribe(_=>{this.showTab(_)}),this._activeTab.pipe((0,P.J)(),(0,S.p)(([_,u])=>_!==u),(0,O.Q)(this.ngUnsubscribe)).subscribe(([_,u])=>{this.activeTabChange.next(u)})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}handleTabSelect(_){this._activeTab.next(_.index)}mapTabs(){this.tabItems=this._tabs.map((_,u)=>({index:u,label:_.label||`Item ${u}`,tab:_}))}showTab(_){this._tabs.forEach((u,l)=>{switch(typeof _){case"number":u.isActive=_===l;break;case"string":u.isActive=_.toString().toUpperCase()===u.label.toUpperCase()}}),this.changeDetector.markForCheck()}isTabActive(_){return("string"==typeof this._activeTab.value?_.label.toUpperCase():_.index)===this._activeTab.value}shiftTab(_){const l=(this.tabItems.find(m=>this.isTabActive(m)).index+_+this.tabItems.length)%this.tabItems.length;this._activeTab.next(l),this._buttonRefs.toArray()[l].nativeElement.focus()}static#e=this.\u0275fac=function(u){return new(u||d)(e.rXU(e.gRc))};static#t=this.\u0275cmp=e.VBU({type:d,selectors:[["app-tabs"]],contentQueries:function(u,l,m){if(1&u&&e.wni(m,t.j,4),2&u){let C;e.mGM(C=e.lsd())&&(l._tabs=C)}},viewQuery:function(u,l){if(1&u&&e.GBs(E,5),2&u){let m;e.mGM(m=e.lsd())&&(l._buttonRefs=m)}},inputs:{display:"display",tabTheme:"tabTheme",activeTab:"activeTab",tabSize:"tabSize",tabAlign:"tabAlign",tabColor:"tabColor",tabUnderline:"tabUnderline",tabPadded:"tabPadded",scrollable:"scrollable"},outputs:{activeTabChange:"activeTabChange"},ngContentSelectors:y,decls:7,vars:10,consts:[["tabElements",""],["tabButton",""],[1,"tabs",3,"ngClass"],["role","tablist",1,"tabs__labels",3,"keyup.arrowright","keyup.arrowleft"],["class","tabs__label","role","tab","type","button","data-test","tabButton",3,"ngClass","click",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"tabs__content"],["role","tab","type","button","data-test","tabButton",1,"tabs__label",3,"click","ngClass"]],template:function(u,l){if(1&u){const m=e.RV6();e.NAR(),e.j41(0,"div",2)(1,"div",3,0),e.bIt("keyup.arrowright",function(){return e.eBV(m),e.Njj(l.shiftTab(1))})("keyup.arrowleft",function(){return e.eBV(m),e.Njj(l.shiftTab(-1))}),e.DNE(3,p,3,11,"button",4)(4,h,1,0,"mat-divider",5),e.k0s(),e.j41(5,"div",6),e.SdG(6),e.k0s()()}2&u&&(e.Y8G("ngClass",e.ziG(5,i,"small"===l.tabSize,"medium"===l.tabSize,l.scrollable,l.tabPadded)),e.R7$(),e.AVh("tabs__labels--center","center"===l.tabAlign),e.R7$(2),e.Y8G("ngForOf",l.tabItems),e.R7$(),e.Y8G("ngIf",l.tabUnderline))},dependencies:[a.YU,a.Sq,a.bT,f.q],styles:['.tabs__labels[_ngcontent-%COMP%]{margin-bottom:8px}.tabs__labels--center[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.tabs__label[_ngcontent-%COMP%]{padding:2px 4px 4px;margin-right:8px;font-size:.625rem;line-height:.75rem;text-transform:uppercase;font-weight:500;-webkit-user-select:none;user-select:none;position:relative;background:none;border:none}.tabs__label[_ngcontent-%COMP%]:after{content:"";display:block;border-bottom:3px solid;margin-top:4px;width:0;transition:.25s ease;position:absolute;bottom:0;left:0}.tabs__label[_ngcontent-%COMP%]:hover{cursor:pointer}.tabs__label--blue[_ngcontent-%COMP%]:after{border-color:#2d72dc}.tabs__label--red[_ngcontent-%COMP%]:after{border-color:#de3535}.tabs__label--dark[_ngcontent-%COMP%]{color:#96a8c0}.tabs__label--dark[_ngcontent-%COMP%]:hover, .tabs__label--dark-active[_ngcontent-%COMP%]{color:#fff}.tabs__label--dark-active[_ngcontent-%COMP%]:after{width:100%}.tabs__label--light[_ngcontent-%COMP%]{color:#374a68}.tabs__label--light[_ngcontent-%COMP%]:hover, .tabs__label--light-active[_ngcontent-%COMP%]{color:#283853}.tabs__label--light-active[_ngcontent-%COMP%]:after{width:100%}.tabs--medium[_ngcontent-%COMP%]   .tabs__label[_ngcontent-%COMP%]{font-size:.75rem;line-height:1rem}.tabs--scrollable[_ngcontent-%COMP%]{display:flex;flex-direction:column;max-height:100%}.tabs--scrollable[_ngcontent-%COMP%]   .tabs__content[_ngcontent-%COMP%]{overflow:auto;flex:1 1 auto}.tabs--padded[_ngcontent-%COMP%]   .tabs__content[_ngcontent-%COMP%]{padding:20px 4px}'],changeDetection:0})}return d})()},11583:(le,N,n)=>{"use strict";n.d(N,{e:()=>P});var e=n(54438),t=n(60177),s=n(26779);function c(S,a){if(1&S&&e.nrm(0,"app-icon",3),2&S){const f=e.XpG();e.Y8G("icon",f.icon)}}var O=function(S){return S.Blue="blue",S.Purple="purple",S.Green="green",S.Gray="gray",S}(O||{});let P=(()=>{class S{constructor(){this.label="",this.icon="",this.color=O.Blue}ngOnInit(){}static#e=this.\u0275fac=function(E){return new(E||S)};static#t=this.\u0275cmp=e.VBU({type:S,selectors:[["app-tag"]],inputs:{label:"label",icon:"icon",color:"color"},decls:4,vars:3,consts:[[1,"tag",3,"ngClass"],["class","mr-2",3,"icon",4,"ngIf"],[1,"text-nowrap"],[1,"mr-2",3,"icon"]],template:function(E,y){1&E&&(e.j41(0,"span",0),e.DNE(1,c,1,1,"app-icon",1),e.j41(2,"span",2),e.EFF(3),e.k0s()()),2&E&&(e.Y8G("ngClass","tag--"+y.color),e.R7$(),e.Y8G("ngIf",y.icon),e.R7$(2),e.JRh(y.label))},dependencies:[t.YU,t.bT,s.R],styles:[".tag[_ngcontent-%COMP%]{align-items:center;background-color:#2d72dc;border-radius:10px;color:#fff;display:inline-flex;font-size:10px;height:20px;padding:0 8px;text-transform:uppercase}.tag--blue[_ngcontent-%COMP%]{background-color:#2d72dc}.tag--gray[_ngcontent-%COMP%]{background-color:#374a68}.tag--green[_ngcontent-%COMP%]{background-color:#3f7d84}.tag--purple[_ngcontent-%COMP%]{background-color:#925bc3}"],changeDetection:0})}return S})()},89630:(le,N,n)=>{"use strict";n.d(N,{$:()=>c});var e=n(60177),t=n(72026),s=n(54438);let c=(()=>{class O{static#e=this.\u0275fac=function(a){return new(a||O)};static#t=this.\u0275mod=s.$C({type:O});static#n=this.\u0275inj=s.G2t({imports:[e.MD,t.o]})}return O})()},36918:(le,N,n)=>{"use strict";n.d(N,{e:()=>g});var e=n(60177),t=n(89417),s=n(13403),c=n(3272),O=n(59162),P=n(11818),S=n(45189),a=n(59464),f=n(72026),E=n(64026),y=n(78696),i=n(54438);let g=(()=>{class p{static#e=this.\u0275fac=function(v){return new(v||p)};static#t=this.\u0275mod=i.$C({type:p});static#n=this.\u0275inj=i.G2t({imports:[e.MD,S.G,t.YN,c.D,t.X1,O.M,P.C,s.j,a.j,f.o,E.m,y.H]})}return p})()},76203:(le,N,n)=>{"use strict";n.d(N,{W:()=>E});var e=n(54438),t=n(60177),s=n(77242),c=n(41640),O=n(26779);function P(y,i){if(1&y&&(e.j41(0,"div",4),e.EFF(1),e.k0s()),2&y){const g=e.XpG();e.R7$(),e.SpI(" ",g.label," ")}}function S(y,i){if(1&y&&(e.j41(0,"app-list-item")(1,"div",5),e.nrm(2,"app-icon",6),e.j41(3,"div"),e.EFF(4),e.k0s()()()),2&y){const g=i.$implicit;e.R7$(4),e.JRh(g)}}const f=["Gain unlimited access to over 700 anatomy, disease and treatment models","Save unlimited 3D models","Embed models directly into your learning management system, website or application","Improve cross-team collaboration"];let E=(()=>{class y{constructor(){this.label="Team plans are great for schools or businesses looking to create a collaborative\nexperience for their users. With a team plan, you get:",this.features=f}ngOnInit(){}static#e=this.\u0275fac=function(p){return new(p||y)};static#t=this.\u0275cmp=e.VBU({type:y,selectors:[["app-team-features"]],inputs:{label:"label",features:"features"},decls:4,vars:2,consts:[[1,"feature","text-sm"],["class","mb-4",4,"ngIf"],["listType","flat"],[4,"ngFor","ngForOf"],[1,"mb-4"],[1,"my-1","flex","flex-row"],["icon","check",1,"mr-2"]],template:function(p,h){1&p&&(e.j41(0,"div",0),e.DNE(1,P,2,1,"div",1),e.j41(2,"app-list",2),e.DNE(3,S,5,1,"app-list-item",3),e.k0s()()),2&p&&(e.R7$(),e.Y8G("ngIf",h.label),e.R7$(2),e.Y8G("ngForOf",h.features))},dependencies:[t.Sq,t.bT,s.s,c.P,O.R],changeDetection:0})}return y})()},65115:(le,N,n)=>{"use strict";n.d(N,{H:()=>i});var e=n(92014),t=n(85052),s=n(37925),c=n(2573),O=n(21424),P=n(4951),S=n(54438),a=n(95416),f=n(21007);class i{constructor(p,h,o){this.clipboardService=p,this.changeRef=h,this.snackbar=o,this.ngUnsubscribe=new t.B,this.copyErrorMessage="There was a problem copying to the clipboard."}ngOnInit(){this.groupCode$.pipe((0,s.Q)(this.ngUnsubscribe)).subscribe(p=>{this.groupCode=p,this.signupLink=`https://${window.location.host}/login/create?code=${p}`,this.changeRef.markForCheck()})}handleCopyCodeClick(p){p.preventDefault(),this.clipboardService.copyToClipboard(this.groupCode,"text").pipe((0,s.Q)(this.ngUnsubscribe)).subscribe(h=>{this.snackbar.open(h?"Team invite code copied to your clipboard.":this.copyErrorMessage)})}handleCopyLinkClick(p){p.preventDefault(),this.clipboardService.copyToClipboard(this.signupLink,"url").pipe((0,s.Q)(this.ngUnsubscribe)).subscribe(h=>{this.snackbar.open(h?"Team invite link copied to your clipboard.":this.copyErrorMessage)})}static#e=this.\u0275fac=function(h){return new(h||i)(S.rXU(P.W),S.rXU(S.gRc),S.rXU(a.UG))};static#t=this.\u0275cmp=S.VBU({type:i,selectors:[["app-team-group-code"]],decls:10,vars:6,consts:[[1,"team-group-code","text-sm","mb-4"],[1,"flex","mb-3"],["type","text",1,"team-group-code__input","input",3,"readonly","value"],["app-button","","buttonSize","md","buttonTheme","light","buttonType","primary",1,"team-group-code__button","ml-4",3,"click","uppercase"],[1,"flex"],["type","text",1,"team-group-code__input","input","underline",3,"readonly","value"]],template:function(h,o){1&h&&(S.j41(0,"div",0),S.EFF(1," Share this code or invite link so people can join your team directly.\n"),S.k0s(),S.j41(2,"div",1),S.nrm(3,"input",2),S.j41(4,"button",3),S.bIt("click",function(d){return o.handleCopyCodeClick(d)}),S.EFF(5," Copy Code "),S.k0s()(),S.j41(6,"div",4),S.nrm(7,"input",5),S.j41(8,"button",3),S.bIt("click",function(d){return o.handleCopyLinkClick(d)}),S.EFF(9," Copy Link "),S.k0s()()),2&h&&(S.R7$(3),S.Y8G("readonly",!0)("value",o.groupCode),S.R7$(),S.Y8G("uppercase",!0),S.R7$(3),S.Y8G("readonly",!0)("value",o.signupLink),S.R7$(),S.Y8G("uppercase",!0))},dependencies:[f.Q],styles:[".team-group-code__input[_ngcontent-%COMP%]{background-color:#eaeff5!important}.team-group-code__button[_ngcontent-%COMP%]{flex:0 0 112px}"],changeDetection:0})}!function(g,p,h,o){var r,v=arguments.length,d=v<3?p:null===o?o=Object.getOwnPropertyDescriptor(p,h):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)d=Reflect.decorate(g,p,h,o);else for(var _=g.length-1;_>=0;_--)(r=g[_])&&(d=(v<3?r(d):v>3?r(p,h,d):r(p,h))||d);v>3&&d&&Object.defineProperty(p,h,d)}([(0,e.l6)(O.q.getOrganizationGroupCode),function(g,p){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata("design:type",p)}(0,c.c)],i.prototype,"groupCode$",void 0)},64026:(le,N,n)=>{"use strict";n.d(N,{m:()=>c});var e=n(60177),t=n(11818),s=n(54438);let c=(()=>{class O{static#e=this.\u0275fac=function(a){return new(a||O)};static#t=this.\u0275mod=s.$C({type:O});static#n=this.\u0275inj=s.G2t({imports:[e.MD,t.C]})}return O})()},21091:(le,N,n)=>{"use strict";n.d(N,{G:()=>j});var e=n(54438),t=n(89417),s=n(92014),c=n(85052),O=n(2573),P=n(14264),S=n(37925),a=n(56081),f=n(38165),E=n(16823),i=(n(15040),n(68947)),g=n(82608),p=n(99504),h=n(76115),o=n(53236),v=n(21007),d=n(60177),r=n(87505),_=n(53719),u=n(8961),l=function(M,$,ce,re){var te,ue=arguments.length,H=ue<3?$:null===re?re=Object.getOwnPropertyDescriptor($,ce):re;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)H=Reflect.decorate(M,$,ce,re);else for(var F=M.length-1;F>=0;F--)(te=M[F])&&(H=(ue<3?te(H):ue>3?te($,ce,H):te($,ce))||H);return ue>3&&H&&Object.defineProperty($,ce,H),H},m=function(M,$){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(M,$)};const C=["*"];function b(M,$){if(1&M&&(e.j41(0,"div",10)(1,"app-message-toggle",11),e.EFF(2),e.k0s()()),2&M){const ce=e.XpG(2);e.R7$(2),e.SpI(" ",ce.sentResponses.length," invite(s) have been sent. Please allow up to a few minutes for invitees to receive their invitations. ")}}function R(M,$){if(1&M&&(e.qex(0),e.DNE(1,b,3,1,"div",9),e.bVm()),2&M){const ce=e.XpG();e.R7$(),e.Y8G("ngIf",ce.sentResponses.length>0)}}function A(M,$){if(1&M&&(e.j41(0,"div"),e.EFF(1),e.k0s()),2&M){const ce=$.$implicit;e.R7$(),e.SpI(" ",ce," ")}}function G(M,$){if(1&M&&(e.j41(0,"div",19)(1,"app-message-toggle",20)(2,"div"),e.EFF(3),e.k0s(),e.DNE(4,A,2,1,"div",21),e.k0s()()),2&M){const ce=e.XpG(3);e.R7$(3),e.SpI("There was an error sending ",ce.errorResponses.length," invite(s)."),e.R7$(),e.Y8G("ngForOf",ce.formatResponses(ce.errorResponses))}}function k(M,$){if(1&M&&(e.j41(0,"div",19)(1,"app-message-toggle",20),e.EFF(2),e.k0s()()),2&M){const ce=e.XpG(3);e.R7$(2),e.SpI(" ",ce.errorMessage," ")}}function V(M,$){if(1&M&&(e.j41(0,"div",22)(1,"mat-error"),e.EFF(2),e.k0s()()),2&M){const ce=e.XpG().$implicit,re=e.XpG(2);e.R7$(2),e.Lme(" Please limit your entry to ",re.maxEmailCount,". Current count: ",null==ce.errors?null:ce.errors.currentEmailCount,". ")}}function W(M,$){if(1&M&&(e.j41(0,"div",22)(1,"mat-error"),e.EFF(2),e.k0s()()),2&M){const ce=e.XpG().$implicit,re=e.XpG(2);e.R7$(2),e.Lme(" ",re.formatEmails(null==ce.errors?null:ce.errors.invalidEmails)," ",1===ce.errors.invalidEmails.length?"is not a valid email address.":"are not valid email addresses."," ")}}function T(M,$){if(1&M&&(e.j41(0,"option",27),e.EFF(1),e.k0s()),2&M){const ce=$.$implicit;e.Y8G("value",ce.role_id),e.R7$(),e.SpI(" ",ce.role_display_name," ")}}function x(M,$){1&M&&(e.j41(0,"div",22)(1,"mat-error"),e.EFF(2," Please select a valid role. "),e.k0s()())}function z(M,$){if(1&M&&(e.j41(0,"app-form-field",23)(1,"select",24)(2,"option",25),e.EFF(3,"--"),e.k0s(),e.DNE(4,T,2,2,"option",26),e.k0s(),e.DNE(5,x,3,0,"div",17),e.k0s()),2&M){const ce=$.$implicit,re=e.XpG(3);e.R7$(4),e.Y8G("ngForOf",re.availableRoles),e.R7$(),e.Y8G("ngIf",ce.touched&&ce.invalid)}}function I(M,$){if(1&M&&(e.qex(0,13),e.DNE(1,G,5,2,"div",14)(2,k,3,1,"div",14),e.j41(3,"app-form-field",15)(4,"textarea",16),e.EFF(5,"          "),e.k0s(),e.DNE(6,V,3,2,"div",17)(7,W,3,2,"div",17),e.k0s(),e.DNE(8,z,6,2,"app-form-field",18),e.bVm()),2&M){const ce=$.$implicit,re=e.XpG(2);e.Y8G("formGroup",re.form),e.R7$(),e.Y8G("ngIf",re.errorResponses.length>0),e.R7$(),e.Y8G("ngIf",re.errorMessage),e.R7$(2),e.Y8G("placeholder","Enter up to "+re.maxEmailCount+" email addresses separated by commas or line breaks"),e.R7$(2),e.Y8G("ngIf",null==ce.errors?null:ce.errors.maxEmailsExceeded),e.R7$(),e.Y8G("ngIf",null==ce.errors?null:ce.errors.invalidEmails),e.R7$(),e.Y8G("ngIf",re.form.get("roleId"))}}function D(M,$){if(1&M&&e.DNE(0,I,9,7,"ng-container",12),2&M){const ce=e.XpG();e.Y8G("ngIf",ce.form.get("emails"))}}function L(M,$){if(1&M){const ce=e.RV6();e.j41(0,"button",29),e.bIt("click",function(){e.eBV(ce);const ue=e.XpG(2);return e.Njj(ue.handleCancelClick())}),e.EFF(1),e.k0s()}if(2&M){const ce=e.XpG(2);e.Y8G("uppercase","inline"===ce.layout),e.R7$(),e.SpI(" ",ce.cancelText," ")}}function Q(M,$){if(1&M){const ce=e.RV6();e.j41(0,"button",30),e.nI1(1,"async"),e.bIt("click",function(){e.eBV(ce);const ue=e.XpG(2);return e.Njj(ue.handleInviteClick())}),e.EFF(2),e.k0s()}if(2&M){const ce=e.XpG(2);e.Y8G("uppercase","inline"===ce.layout)("disabled",ce.form.invalid||e.bMT(1,3,ce.inviting$)),e.R7$(2),e.SpI(" ",ce.errorResponses.length>0?"Try Again":ce.sendText," ")}}function ie(M,$){1&M&&e.eu8(0)}function se(M,$){1&M&&e.eu8(0)}function Z(M,$){if(1&M&&(e.qex(0),e.DNE(1,ie,1,0,"ng-container",31)(2,se,1,0,"ng-container",31),e.bVm()),2&M){e.XpG();const ce=e.sdS(3),re=e.sdS(5);e.R7$(),e.Y8G("ngTemplateOutlet",ce),e.R7$(),e.Y8G("ngTemplateOutlet",re)}}function de(M,$){1&M&&e.eu8(0)}function ae(M,$){1&M&&e.eu8(0)}function q(M,$){if(1&M&&e.DNE(0,de,1,0,"ng-container",31)(1,ae,1,0,"ng-container",31),2&M){e.XpG();const ce=e.sdS(3),re=e.sdS(5);e.Y8G("ngTemplateOutlet",re),e.R7$(),e.Y8G("ngTemplateOutlet",ce)}}function K(M,$){if(1&M&&(e.j41(0,"div")(1,"div",28),e.DNE(2,L,2,2,"ng-template",null,1,e.C5r)(4,Q,3,5,"ng-template",null,2,e.C5r)(6,Z,3,2,"ng-container",6)(7,q,2,2,"ng-template",null,3,e.C5r),e.k0s()()),2&M){const ce=e.sdS(8),re=e.XpG();e.R7$(6),e.Y8G("ngIf","inline"===re.layout)("ngIfElse",ce)}}class j{get valid(){return this.form.valid}constructor($,ce,re,ue){this.store=$,this.actions=ce,this.formBuilder=re,this.changeRef=ue,this.maxEmailCount=50,this.availableRoles=[],this.layout="inline",this.enableActions=!0,this.sendText="Send invites",this.cancelText="Cancel",this.inviteSent=new e.bkB,this.inviteCancelled=new e.bkB,this.ngUnsubscribe=new c.B,this.sent=!1,this.sentResponses=[],this.errorResponses=[]}ngOnInit(){this.initForm(),this.initInviteListeners()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initForm(){this.store.dispatch(new f.Xb),this.currentUserRole=this.store.selectSnapshot(E.k.getUserRole),this.userRoles$.pipe((0,P.p)($=>$.length>0),(0,S.Q)(this.ngUnsubscribe)).subscribe($=>{this.availableRoles=$.filter(ce=>a.Zv.indexOf(ce.role_name)<=a.Zv.indexOf(this.currentUserRole.role_name)),this.changeRef.markForCheck()}),this.form=this.formBuilder.group({emails:["",t.k0.required,(0,h.H)(this.maxEmailCount).bind(this)],roleId:["",t.k0.required]})}initInviteListeners(){this.actions.pipe((0,s.xi)(g.h2),(0,S.Q)(this.ngUnsubscribe)).subscribe(()=>{this.resetState(),this.changeRef.markForCheck()}),this.actions.pipe((0,s.xi)(g.w9),(0,S.Q)(this.ngUnsubscribe)).subscribe(({responses:$})=>{this.resetState(),this.sentResponses=$.filter(ce=>"success"===ce.status),this.errorResponses=$.filter(ce=>"error"===ce.status),this.sent=0===this.errorResponses.length,this.sent&&this.inviteSent.next($),this.changeRef.markForCheck()}),this.actions.pipe((0,s.xi)(g.HZ,f.sz),(0,S.Q)(this.ngUnsubscribe)).subscribe($=>{this.resetState(),this.errorMessage=(0,o.u1)($.error)||"There was an error sending the invites, please try again.",this.changeRef.markForCheck()})}handleCancelClick(){this.inviteCancelled.next()}backToFormClick(){this.resetState(),this.changeRef.markForCheck()}handleInviteClick(){const{eid:$}=this.organization,re=i.l.parseEmails(this.form.value.emails).map(ue=>({user_email:ue,role_id:parseInt(this.form.value.roleId,10)}));this.store.dispatch(new g.h2($,re))}formatEmails($){return $.join(", ")}formatResponses($){const ce=$.map(ue=>ue.reason);return[...new Set([...ce])].map(ue=>{const H=$.filter(F=>F.reason===ue).map(F=>F.email),te=this.formatEmails(H);return`"${ue}": ${te}`})}resetState(){this.sent=!1,this.sentResponses=[],this.errorResponses=[],this.errorMessage=""}static#e=this.\u0275fac=function(ce){return new(ce||j)(e.rXU(s.il),e.rXU(s.En),e.rXU(t.ze),e.rXU(e.gRc))};static#t=this.\u0275cmp=e.VBU({type:j,selectors:[["app-team-invite"]],inputs:{organization:"organization",layout:"layout",enableActions:"enableActions",sendText:"sendText",cancelText:"cancelText"},outputs:{inviteSent:"inviteSent",inviteCancelled:"inviteCancelled"},ngContentSelectors:C,decls:8,vars:7,consts:[["sendFormTmp",""],["cancelBtnTmp",""],["sendBtnTmp",""],["blockBtnTmp",""],[1,"invite"],[1,"theme-light"],[4,"ngIf","ngIfElse"],[4,"ngIf"],[1,"invite__footer"],["class","my-1",4,"ngIf"],[1,"my-1"],["data-test","teamInviteSuccess","type","message"],[3,"formGroup",4,"ngIf"],[3,"formGroup"],["class","mb-4",4,"ngIf"],["theme","light","label","Invite via email"],["formControlName","emails","data-test","teamInviteEmails","rows","8",1,"invite__input","input",3,"placeholder"],["class","mt-1 text-xs",4,"ngIf"],["theme","light","label","Role",4,"ngIf"],[1,"mb-4"],["type","error"],[4,"ngFor","ngForOf"],[1,"mt-1","text-xs"],["theme","light","label","Role"],["formControlName","roleId",1,"input"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"invite__buttons"],["app-button","","buttonTheme","light","buttonType","default","data-test","skipInvitesButton",1,"invite__button",3,"click","uppercase"],["app-button","","buttonType","primary","data-test","sendInvitesButton",1,"invite__button",3,"click","uppercase","disabled"],[4,"ngTemplateOutlet"]],template:function(ce,re){if(1&ce&&(e.NAR(),e.j41(0,"div",4)(1,"div",5),e.DNE(2,R,2,1,"ng-container",6)(3,D,1,1,"ng-template",null,0,e.C5r),e.k0s(),e.DNE(5,K,9,2,"div",7),e.j41(6,"div",8),e.SdG(7,0,["[select]","invite - footer"]),e.k0s()()),2&ce){const ue=e.sdS(4);e.AVh("invite--inline","inline"===re.layout)("invite--block","block"===re.layout),e.R7$(2),e.Y8G("ngIf",re.sent)("ngIfElse",ue),e.R7$(3),e.Y8G("ngIf",re.enableActions&&!re.sent)}},dependencies:[v.Q,d.Sq,d.bT,d.T3,r.K,_.TL,t.xH,t.y7,t.me,t.wz,t.BC,t.cb,t.j4,t.JD,u.X,d.Jj],styles:[".invite__input[_ngcontent-%COMP%]{resize:vertical}.invite__actions[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:center}.invite__actions--compact[_ngcontent-%COMP%]{justify-content:flex-end}.invite__buttons[_ngcontent-%COMP%]{display:flex;flex-direction:row;margin:8px auto}.invite--inline[_ngcontent-%COMP%]   .invite__button[_ngcontent-%COMP%]{margin-left:16px}.invite--inline[_ngcontent-%COMP%]   .invite__buttons[_ngcontent-%COMP%]{justify-content:flex-end}.invite--block[_ngcontent-%COMP%]   .invite__button[_ngcontent-%COMP%]{margin:16px 0}.invite--block[_ngcontent-%COMP%]   .invite__buttons[_ngcontent-%COMP%]{justify-content:flex-end;flex-direction:column}"],changeDetection:0})}l([(0,s.l6)(p.e.getInviting),m("design:type",O.c)],j.prototype,"inviting$",void 0),l([(0,s.l6)(E.k.getUserRoles),m("design:type",O.c)],j.prototype,"userRoles$",void 0)},21827:(le,N,n)=>{"use strict";n.d(N,{H:()=>W});var e=n(54438),t=n(92014),s=n(85052),c=n(37925),O=n(2573),P=n(82608),S=n(99504),a=n(95416),f=n(21007),E=n(60177),y=n(26779),i=n(97352),g=n(70914);const o=(T,x,z,I)=>({"team-join--compact":T,"team-join--readonly":x,"team-join--theme-dark":z,"team-join--theme-light":I});function v(T,x){1&T&&(e.j41(0,"div",3),e.nrm(1,"app-spinner",4),e.k0s())}function d(T,x){if(1&T&&(e.j41(0,"div",12),e.nrm(1,"img",13),e.k0s()),2&T){const z=e.XpG(2);e.R7$(),e.Y8G("src",z.pendingJoinOrganization.logoUrl,e.B4B)}}function r(T,x){if(1&T&&(e.j41(0,"div",14),e.EFF(1),e.k0s()),2&T){const z=e.XpG(2);e.R7$(),e.SpI(" ",z.pendingJoinOrganization.name," ")}}function _(T,x){if(1&T&&(e.j41(0,"div",15),e.EFF(1),e.k0s()),2&T){const z=e.XpG(2);e.R7$(),e.SpI(" ",z.pendingJoinOrganization.members," ")}}function u(T,x){if(1&T){const z=e.RV6();e.j41(0,"button",16),e.bIt("click",function(){e.eBV(z);const D=e.XpG(2);return e.Njj(D.handleCancelJoinClick(D.pendingJoinRequest.join_request_key))}),e.EFF(1," Cancel Request "),e.k0s()}}function l(T,x){if(1&T&&(e.qex(0),e.nrm(1,"app-html",5),e.j41(2,"div",6)(3,"div",7),e.DNE(4,d,2,1,"div",8)(5,r,2,1,"div",9)(6,_,2,1,"div",10),e.k0s(),e.DNE(7,u,2,0,"button",11),e.k0s(),e.bVm()),2&T){const z=e.XpG();e.R7$(),e.Y8G("markdownText",z.joinRequestText),e.R7$(3),e.Y8G("ngIf",z.pendingJoinOrganization.logoUrl),e.R7$(),e.Y8G("ngIf",!z.compact||!z.pendingJoinOrganization.logoUrl),e.R7$(),e.Y8G("ngIf",!z.compact),e.R7$(),e.Y8G("ngIf",!z.readonly)}}function m(T,x){if(1&T&&(e.j41(0,"div",12),e.nrm(1,"img",13),e.k0s()),2&T){const z=e.XpG(2).$implicit;e.R7$(),e.Y8G("src",z.logoUrl,e.B4B)}}function C(T,x){if(1&T&&(e.j41(0,"div",14),e.EFF(1),e.k0s()),2&T){const z=e.XpG(2).$implicit;e.R7$(),e.SpI(" ",z.name," ")}}function b(T,x){if(1&T&&(e.j41(0,"div",15),e.EFF(1),e.k0s()),2&T){const z=e.XpG(2).$implicit;e.R7$(),e.SpI(" ",z.members," ")}}function R(T,x){if(1&T){const z=e.RV6();e.j41(0,"button",21),e.bIt("click",function(){e.eBV(z);const D=e.XpG(2).$implicit,L=e.XpG(2);return e.Njj(L.handleRequestJoinClick(D.id))}),e.EFF(1," Request to Join "),e.k0s()}}function A(T,x){if(1&T&&(e.j41(0,"div",6)(1,"div",7),e.DNE(2,m,2,1,"div",8)(3,C,2,1,"div",9)(4,b,2,1,"div",10),e.k0s(),e.DNE(5,R,2,0,"button",20),e.k0s()),2&T){const z=e.XpG().$implicit,I=e.XpG(2);e.R7$(2),e.Y8G("ngIf",z.logoUrl),e.R7$(),e.Y8G("ngIf",!I.compact||!z.logoUrl),e.R7$(),e.Y8G("ngIf",!I.compact),e.R7$(),e.Y8G("ngIf",!I.readonly)}}function G(T,x){if(1&T&&(e.j41(0,"div"),e.DNE(1,A,6,4,"div",19),e.k0s()),2&T){const z=x.index,I=e.XpG(2);e.R7$(),e.Y8G("ngIf",0===z||I.showAllOrganizations)}}function k(T,x){if(1&T){const z=e.RV6();e.j41(0,"button",22),e.bIt("click",function(){e.eBV(z);const D=e.XpG(2);return e.Njj(D.toggleShowAllOrganizations())}),e.j41(1,"div",23),e.EFF(2),e.nrm(3,"app-icon",24),e.k0s()()}if(2&T){const z=e.XpG(2);e.Y8G("uppercase",!1),e.R7$(2),e.SpI(" ",z.toggleText," "),e.R7$(),e.Y8G("icon",z.showAllOrganizations?"caret-up":"caret-down")}}function V(T,x){if(1&T&&(e.qex(0),e.nrm(1,"app-html",5),e.DNE(2,G,2,1,"div",17)(3,k,4,3,"button",18),e.bVm()),2&T){const z=e.XpG();e.R7$(),e.Y8G("markdownText",z.requestOrganizationsText),e.R7$(),e.Y8G("ngForOf",z.requestOrganizations),e.R7$(),e.Y8G("ngIf",z.showToggle)}}class W{get joinRequestText(){if(this._joinRequestText)return this._joinRequestText;{let x=this.pendingJoinOrganization?.name;return x=x?`${x} team`:"team",`Your request to join the ${x} is pending approval from a team administrator. It will automatically expire in 14 days if not approved.`}}set joinRequestText(x){this._joinRequestText=x}constructor(x,z,I,D){this.changeDetectorRef=x,this.store=z,this.actions=I,this.snackBar=D,this.readonly=!1,this.compact=!1,this.theme="dark",this.organizations=[],this._joinRequestText="",this.requestOrganizationsText="It looks like some of your teammates are already using the BioDigital Human.",this.pendingJoinRequestSuccess=new e.bkB,this.requestOrganizationsSuccess=new e.bkB,this.joinRequestsLoaded=!1,this.requestOrganizations=[],this.showAllOrganizations=!1,this.showToggle=!1,this.showMoreText="",this.ngUnsubscribe=new s.B}get showPendingRequest(){return void 0!==this.pendingJoinRequest}get showRequestOrganizations(){return void 0===this.pendingJoinRequest&&this.requestOrganizations.length>0}get toggleText(){return this.showAllOrganizations?"Show less":this.showMoreText}ngOnInit(){this.initEventListeners(),this.initRequests()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initRequests(){this.showAllOrganizations=!this.compact,0===this.organizations.length?this.store.dispatch(new P.dG):this.createRequestOrganizations(this.organizations)}initEventListeners(){this.actions.pipe((0,t.xi)(P.CW),(0,c.Q)(this.ngUnsubscribe)).subscribe(()=>this.handleGetJoinRequestsSuccess()),this.actions.pipe((0,t.xi)(P.ZO),(0,c.Q)(this.ngUnsubscribe)).subscribe(()=>this.handleGetEligibleOrganizationsSuccess()),this.actions.pipe((0,t.xi)(P.ku),(0,c.Q)(this.ngUnsubscribe)).subscribe(()=>{this.snackBar.open("Join request successfully cancelled.")}),this.actions.pipe((0,t.xi)(P.Bf),(0,c.Q)(this.ngUnsubscribe)).subscribe(()=>{this.snackBar.open("There was an error with cancelling the request.")}),this.actions.pipe((0,t.xi)(P._b),(0,c.Q)(this.ngUnsubscribe)).subscribe(()=>{this.snackBar.open("There was an error with making this request.")})}handleRequestJoinClick(x){this.store.dispatch(new P.CA(x))}handleCancelJoinClick(x){this.store.dispatch(new P.XW(x))}toggleShowAllOrganizations(){this.showAllOrganizations=!this.showAllOrganizations}handleGetJoinRequestsSuccess(){this.joinRequestsLoaded=!0,this.pendingJoinRequest=this.store.selectSnapshot(S.e.getPendingJoinRequest),this.pendingJoinRequest?this.pendingJoinOrganization=this.createDisplayOrganization(this.pendingJoinRequest.request_organization):this.store.dispatch(new P.Ae),this.pendingJoinRequestSuccess.next(this.pendingJoinRequest),this.changeDetectorRef.markForCheck()}handleGetEligibleOrganizationsSuccess(){this.createRequestOrganizations(this.store.selectSnapshot(S.e.getEligibleOrganizations)),this.requestOrganizationsSuccess.next(this.requestOrganizations),this.changeDetectorRef.markForCheck()}createRequestOrganizations(x){this.showToggle=this.compact&&x.length>1;const z=x.length-1;this.showMoreText=`Show ${z} more team${1===z?"":"s"}`,this.requestOrganizations=x.map(this.createDisplayOrganization,this),this.requestOrganizations.sort((I,D)=>D.logoUrl&&!I.logoUrl?1:-1),this.changeDetectorRef.markForCheck()}createDisplayOrganization(x){return{id:x.organization_id,name:x.organization_name,logoUrl:x.group_logos.default,members:`${x.users_count} member${1===x.users_count?"":"s"}`}}static#e=this.\u0275fac=function(z){return new(z||W)(e.rXU(e.gRc),e.rXU(t.il),e.rXU(t.En),e.rXU(a.UG))};static#t=this.\u0275cmp=e.VBU({type:W,selectors:[["app-team-join"]],inputs:{readonly:"readonly",compact:"compact",theme:"theme",organizations:"organizations",joinRequestText:"joinRequestText",requestOrganizationsText:"requestOrganizationsText"},outputs:{pendingJoinRequestSuccess:"pendingJoinRequestSuccess",requestOrganizationsSuccess:"requestOrganizationsSuccess"},decls:7,vars:15,consts:[[1,"team-join",3,"ngClass"],["class","my-6",4,"ngIf"],[4,"ngIf"],[1,"my-6"],["size","huge"],[1,"team-join__text","block","my-4",3,"markdownText"],[1,"team-join__organization","flex","justify-between","mb-3"],[1,"team-join__organization-info","flex","flex-col"],["class","mb-3",4,"ngIf"],["class","team-join__organization-name",4,"ngIf"],["class","team-join__organization-members",4,"ngIf"],["type","submit","app-button","","buttonTheme","light","buttonType","flat",3,"click",4,"ngIf"],[1,"mb-3"],[1,"team-join__organization-logo",3,"src"],[1,"team-join__organization-name"],[1,"team-join__organization-members"],["type","submit","app-button","","buttonTheme","light","buttonType","flat",3,"click"],[4,"ngFor","ngForOf"],["app-button","","buttonSize","xs","buttonType","text","buttonTheme","light",3,"uppercase","click",4,"ngIf"],["class","team-join__organization flex justify-between mb-3",4,"ngIf"],["type","submit","buttonTheme","light","app-button","","buttonType","primary",3,"click",4,"ngIf"],["type","submit","buttonTheme","light","app-button","","buttonType","primary",3,"click"],["app-button","","buttonSize","xs","buttonType","text","buttonTheme","light",3,"click","uppercase"],[1,"text-sm","underline"],[1,"pl-1",3,"icon"]],template:function(z,I){1&z&&(e.j41(0,"div",0),e.DNE(1,v,2,0,"div",1),e.nI1(2,"async"),e.DNE(3,l,8,5,"ng-container",2),e.nI1(4,"async"),e.DNE(5,V,4,3,"ng-container",2),e.nI1(6,"async"),e.k0s()),2&z&&(e.Y8G("ngClass",e.ziG(10,o,I.compact,I.readonly,"dark"===I.theme,"light"===I.theme)),e.R7$(),e.Y8G("ngIf",e.bMT(2,4,I.requesting$)),e.R7$(2),e.Y8G("ngIf",!1===e.bMT(4,6,I.requesting$)&&I.showPendingRequest),e.R7$(2),e.Y8G("ngIf",!1===e.bMT(6,8,I.requesting$)&&I.showRequestOrganizations))},dependencies:[f.Q,E.YU,E.Sq,E.bT,y.R,i.tI,g.V,E.Jj],styles:[".team-join__text[_ngcontent-%COMP%]{font-size:.875rem;line-height:1.25rem}.team-join--theme-light[_ngcontent-%COMP%]   .team-join__text[_ngcontent-%COMP%]{color:#283853}.team-join__organization[_ngcontent-%COMP%]{border:1px solid #d7e0ea;border-radius:4px;padding:16px}.team-join__organization-info[_ngcontent-%COMP%]{flex-basis:50%}.team-join__organization-logo[_ngcontent-%COMP%]{display:block;max-height:32px;max-width:100%}.team-join__organization-name[_ngcontent-%COMP%]{font-size:1rem;line-height:1.5rem;font-weight:600}.team-join__organization-members[_ngcontent-%COMP%]{font-size:.75rem;line-height:1rem;font-weight:500;color:#61779e}.team-join--compact[_ngcontent-%COMP%]   .team-join__text[_ngcontent-%COMP%]{font-size:.875rem;line-height:1.25rem}.team-join--compact[_ngcontent-%COMP%]   .team-join__organization[_ngcontent-%COMP%]{border:none;border-radius:0;padding:0}.team-join--compact[_ngcontent-%COMP%]   .team-join__organization-name[_ngcontent-%COMP%]{font-size:.875rem;line-height:1.25rem;font-weight:500}.team-join--readonly[_ngcontent-%COMP%]   .team-join__organization-info[_ngcontent-%COMP%]{flex-basis:auto}"],changeDetection:0})}!function(T,x,z,I){var Q,D=arguments.length,L=D<3?x:null===I?I=Object.getOwnPropertyDescriptor(x,z):I;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)L=Reflect.decorate(T,x,z,I);else for(var ie=T.length-1;ie>=0;ie--)(Q=T[ie])&&(L=(D<3?Q(L):D>3?Q(x,z,L):Q(x,z))||L);D>3&&L&&Object.defineProperty(x,z,L)}([(0,t.l6)(S.e.getRequesting),function(T,x){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata("design:type",x)}(0,O.c)],W.prototype,"requesting$",void 0)},45438:(le,N,n)=>{"use strict";n.d(N,{o:()=>o});var e=n(92014),t=n(2573),s=n(16823),c=n(54438),O=n(60177),P=n(26779);function S(v,d){if(1&v&&c.nrm(0,"app-icon",2),2&v){const r=c.XpG();c.Y8G("icon",r.icon)}}let a=(()=>{class v{constructor(){this.size="medium",this.type="outline",this.color="#CCCCCC"}ngOnInit(){}static#e=this.\u0275fac=function(_){return new(_||v)};static#t=this.\u0275cmp=c.VBU({type:v,selectors:[["app-profile-badge"]],inputs:{size:"size",type:"type",color:"color",icon:"icon",label:"label"},decls:3,vars:12,consts:[[1,"badge","uppercase"],[3,"icon",4,"ngIf"],[3,"icon"]],template:function(_,u){1&_&&(c.j41(0,"div",0),c.DNE(1,S,1,1,"app-icon",1),c.EFF(2),c.k0s()),2&_&&(c.AVh("badge--outline","outline"===u.type)("badge--solid","solid"===u.type)("badge--small","small"===u.size)("badge--medium","medium"===u.size)("badge--large","large"===u.size),c.R7$(),c.Y8G("ngIf",u.icon),c.R7$(),c.SpI(" ",u.label,"\n"))},dependencies:[O.bT,P.R],styles:[".badge[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;border-radius:50%;color:#101823}.badge--outline[_ngcontent-%COMP%]{border:1px solid #ffffff;background-color:#96a8c099;color:#fff}.badge--small[_ngcontent-%COMP%]{width:32px;height:32px;font-size:.75rem;line-height:1rem}.badge--medium[_ngcontent-%COMP%]{width:40px;height:40px;font-size:.875rem;line-height:1.25rem}.badge--large[_ngcontent-%COMP%]{width:48px;height:48px;font-size:1rem;line-height:1.5rem}.badge--x-large[_ngcontent-%COMP%]{width:48px;height:48px;font-size:1.125rem;line-height:1.75rem}"],changeDetection:0})}return v})();const y=(v,d)=>({"team-user--light":v,"team-user--dark":d});function i(v,d){if(1&v&&(c.j41(0,"div",8),c.EFF(1),c.k0s()),2&v){const r=c.XpG();c.R7$(),c.SpI(" ",r.user.name||"<Name Unknown>"," ")}}function g(v,d){1&v&&(c.j41(0,"div",9),c.EFF(1,"Developer"),c.k0s())}function p(v,d){if(1&v&&(c.j41(0,"div",10),c.EFF(1),c.k0s()),2&v){const r=c.XpG();c.R7$(),c.SpI(" ",r.user.email," ")}}function h(v,d){if(1&v&&(c.j41(0,"div",11),c.EFF(1),c.k0s()),2&v){const r=c.XpG();c.AVh("team-user__role--expired","expired"===r.user.invitationStatus),c.R7$(),c.SpI(" ",r.user.invitationStatus?r.user.invitationStatus:r.user.role.role_display_name," ")}}class o{constructor(){this.showEmail=!1,this.showRole=!0,this.theme="light"}set showNameUnknown(d){this.showName=d||this.user.name.length>0}static#e=this.\u0275fac=function(r){return new(r||o)};static#t=this.\u0275cmp=c.VBU({type:o,selectors:[["app-team-user"]],inputs:{user:"user",showEmail:"showEmail",showNameUnknown:"showNameUnknown",showRole:"showRole",theme:"theme"},decls:8,vars:10,consts:[[1,"team-user","flex","flex-row","grow","align-center","items-center",3,"ngClass"],[1,"team-user__badge","mr-3"],["type","outline","size","small",3,"label","icon"],[1,"team-user__text"],["class","team-user__name text-sm","data-test","teamMemberName",4,"ngIf"],["class","team-user__developer",4,"ngIf"],["class","team-user__email text-xs","data-test","teamMemberEmail",4,"ngIf"],["class","team-user__role flex flex-row items-center justify-end mx-2 text-2xs","data-test","teamMemberInfo",3,"team-user__role--expired",4,"ngIf"],["data-test","teamMemberName",1,"team-user__name","text-sm"],[1,"team-user__developer"],["data-test","teamMemberEmail",1,"team-user__email","text-xs"],["data-test","teamMemberInfo",1,"team-user__role","flex","flex-row","items-center","justify-end","mx-2","text-2xs"]],template:function(r,_){1&r&&(c.j41(0,"div",0)(1,"div",1),c.nrm(2,"app-profile-badge",2),c.k0s(),c.j41(3,"div",3),c.DNE(4,i,2,1,"div",4)(5,g,2,0,"div",5)(6,p,2,1,"div",6),c.k0s(),c.DNE(7,h,2,3,"div",7),c.k0s()),2&r&&(c.Y8G("ngClass",c.l_i(7,y,"light"===_.theme,"dark"===_.theme)),c.R7$(2),c.Y8G("label",_.user.initials)("icon",_.user.initials?"":"user"),c.R7$(2),c.Y8G("ngIf",_.showName),c.R7$(),c.Y8G("ngIf",_.user.activeDeveloper),c.R7$(),c.Y8G("ngIf",_.showEmail),c.R7$(),c.Y8G("ngIf",_.showRole))},dependencies:[O.YU,O.bT,a],styles:[".team-user__badge[_ngcontent-%COMP%]{align-self:center}.team-user__text[_ngcontent-%COMP%]{width:0;flex-grow:1;flex-shrink:1;overflow:hidden}.team-user__name[_ngcontent-%COMP%]{color:#1c2a3f;overflow:hidden;text-overflow:ellipsis}.team-user__developer[_ngcontent-%COMP%]{height:16px;padding:0 8px;margin:4px 0;display:inline-flex;align-items:center;justify-content:center;font-size:8px;color:#374a68;background-color:#eaeff5;border-radius:8px;border:1px solid #96a8c0;text-transform:uppercase}.team-user__email[_ngcontent-%COMP%]{color:#374a68;overflow:hidden;text-overflow:ellipsis}.team-user__role[_ngcontent-%COMP%]{text-transform:uppercase;color:#96a8c0}.team-user__role--expired[_ngcontent-%COMP%]{color:#ed4758}.team-user--dark[_ngcontent-%COMP%]   .team-user__developer[_ngcontent-%COMP%]{background-color:#f9fafd}"],changeDetection:0})}!function(v,d,r,_){var m,u=arguments.length,l=u<3?d:null===_?_=Object.getOwnPropertyDescriptor(d,r):_;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(v,d,r,_);else for(var C=v.length-1;C>=0;C--)(m=v[C])&&(l=(u<3?m(l):u>3?m(d,r,l):m(d,r))||l);u>3&&l&&Object.defineProperty(d,r,l)}([(0,e.l6)(s.k.isAdmin),function(v,d){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata("design:type",d)}(0,t.c)],o.prototype,"isAdmin$",void 0)},22397:(le,N,n)=>{"use strict";n.d(N,{P:()=>S,R:()=>a});var e=n(68947);const t="mp3",s=3e3,c={voiceId:"Amy",voiceLocaleId:"en-GB",supportedLocaleIds:["en-US"],engine:"neural"},O=[c,{voiceId:"Mia",voiceLocaleId:"es-MX",supportedLocaleIds:["es-ES"],engine:"neural"},{voiceId:"Zhiyu",voiceLocaleId:"cmn-CN",supportedLocaleIds:["zh-CN"],engine:"neural"},{voiceId:"Lea",voiceLocaleId:"fr-FR",supportedLocaleIds:[],engine:"neural"},{voiceId:"Vicki",voiceLocaleId:"de-DE",supportedLocaleIds:[],engine:"neural"},{voiceId:"Bianca",voiceLocaleId:"it-IT",supportedLocaleIds:[],engine:"neural"},{voiceId:"Takumi",voiceLocaleId:"ja-JP",supportedLocaleIds:["ja"],engine:"neural"},{voiceId:"Camila",voiceLocaleId:"pt-BR",supportedLocaleIds:["pt-PT"],engine:"neural"}];function S(f){return O.find(E=>{const{voiceLocaleId:y,supportedLocaleIds:i}=E;return y===f||i.includes(f)})}function a(f,E){return(f.length>s?e.l.splitTextByCharacterCount(f,s):[f]).map(g=>function P(f,E){const g=S(E)??c,{voiceId:p,engine:h,voiceLocaleId:o}=g;return`/ws/polly/synthesize?text=${encodeURIComponent(f)}&voice_id=${p}&format=${t}&lang=${o}&engine=${h}&version=2`}(g,E))}},18824:(le,N,n)=>{"use strict";n.d(N,{j:()=>O});var e=n(60177),t=n(11818),s=n(72026),c=n(54438);let O=(()=>{class P{static#e=this.\u0275fac=function(f){return new(f||P)};static#t=this.\u0275mod=c.$C({type:P});static#n=this.\u0275inj=c.G2t({imports:[e.MD,t.C,s.o]})}return P})()},15185:(le,N,n)=>{"use strict";n.d(N,{J:()=>P});var e=n(54438),s=(n(93455),n(49204));const O=["thumbnailView"];let P=(()=>{class S{get thumbnail(){return this._thumbnail}set thumbnail(f){(0,s.isEqual)(this._thumbnail,f)||(this._thumbnail=f,null!=f?this.setImageStyle():this.clearImageStyle())}constructor(f){this.renderer=f}setImageStyle(){let f=this.thumbnail.snapshot||this.thumbnail.urls.small;const E=(new Date).valueOf();f.startsWith("blob:")||(f=`${f}?cb=${E}&uncached=true`);const y=new Image;y.src=f,y.onload=()=>{this.renderer.setStyle(this.thumbnailView.nativeElement,"background-size","cover"),this.renderer.setStyle(this.thumbnailView.nativeElement,"background-image",`url(${f})`)}}clearImageStyle(){this.renderer.removeStyle(this.thumbnailView.nativeElement,"background-size"),this.renderer.removeStyle(this.thumbnailView.nativeElement,"background-image")}static#e=this.\u0275fac=function(E){return new(E||S)(e.rXU(e.sFG))};static#t=this.\u0275cmp=e.VBU({type:S,selectors:[["app-thumbnail-view"]],viewQuery:function(E,y){if(1&E&&e.GBs(O,7,e.aKT),2&E){let i;e.mGM(i=e.lsd())&&(y.thumbnailView=i.first)}},inputs:{thumbnail:"thumbnail"},standalone:!0,features:[e.aNF],decls:2,vars:0,consts:[["thumbnailView",""],[1,"thumbnail-view"]],template:function(E,y){1&E&&e.nrm(0,"div",1,0)},styles:[".thumbnail-view[_ngcontent-%COMP%]{background-color:#283853;background-image:url(/assets/images/logo-dark-transparent.svg);background-position:center center;background-repeat:no-repeat;background-size:25% 25%;border-radius:4px;height:100%;width:100%}.theme-light[_nghost-%COMP%]   .thumbnail-view[_ngcontent-%COMP%], .theme-light   [_nghost-%COMP%]   .thumbnail-view[_ngcontent-%COMP%]{background-color:#eaeff5}"],changeDetection:0})}return S})()},5584:(le,N,n)=>{"use strict";n.d(N,{d:()=>c});var e=n(60177),t=n(72026),s=n(54438);let c=(()=>{class O{static#e=this.\u0275fac=function(a){return new(a||O)};static#t=this.\u0275mod=s.$C({type:O});static#n=this.\u0275inj=s.G2t({imports:[e.MD,t.o]})}return O})()},12854:(le,N,n)=>{"use strict";n.d(N,{X:()=>p});var e=n(54438),t=n(78109),s=n(44867),c=n(47610),O=n(82542),P=n(60177),S=n(60724),a=n(92014);const f=(h,o)=>o.id,E=h=>({"tree-group--light":h});function y(h,o){if(1&h){const v=e.RV6();e.j41(0,"div",5),e.bIt("click",function(){e.eBV(v);const r=e.XpG(2).$implicit,_=e.XpG();return e.Njj(_.handleExpandClick(r,!0))}),e.k0s()}if(2&h){const v=e.XpG(2).$implicit;e.Y8G("title",v.label)}}function i(h,o){if(1&h&&(e.j41(0,"div",2),e.DNE(1,y,1,1,"div",3),e.nrm(2,"app-tree-group",4),e.k0s()),2&h){const v=e.XpG().$implicit,d=e.XpG();e.R7$(),e.vxM(d.hasChildren(v)?1:-1),e.R7$(),e.Y8G("graph",d.graph())("graphNode",v)("theme",d.theme())("layerOrderMode",d.layerOrderMode())("showTreeNodeIds",d.showTreeNodeIds())("showLatinLabel",d.showLatinLabel())}}function g(h,o){if(1&h&&(e.j41(0,"div",0),e.nrm(1,"app-tree-nested-node",1),e.DNE(2,i,3,7,"div",2),e.k0s()),2&h){const v=o.$implicit,d=e.XpG();e.Y8G("ngClass",e.eq3(8,E,d.theme()===d.themeEnum.Light)),e.R7$(),e.Y8G("graph",d.graph())("node",v)("theme",d.theme())("layerOrderMode",d.layerOrderMode())("showTreeNodeIds",d.showTreeNodeIds())("showLatinLabel",d.showLatinLabel()),e.R7$(),e.vxM(v.boolState.expanded?2:-1)}}let p=(()=>{class h{constructor(v,d){this.graphService=v,this.store=d,this.themeEnum=O.P,this.graph=e.hFB.required(),this.layerOrderMode=e.hFB.required(),this.showTreeNodeIds=e.hFB.required(),this.showLatinLabel=e.hFB.required(),this.graphNode=(0,e.hFB)(),this.theme=(0,e.hFB)(O.P.Dark),this.nodes=(0,e.EWP)(()=>{const r=this.graphNode(),_=this.graph(),u=r?(0,s.IA)(_,r.id):(0,s.ug)(_);return this.graphService.getNodes(_,u)})}hasChildren(v){const d=this.graph();return(0,s.IA)(d,v.id).length>0}handleExpandClick(v,d){this.store.dispatch(d?new c.z(v):new c._o(v))}static#e=this.\u0275fac=function(d){return new(d||h)(e.rXU(t.w),e.rXU(a.il))};static#t=this.\u0275cmp=e.VBU({type:h,selectors:[["app-tree-group"]],inputs:{graph:[1,"graph"],layerOrderMode:[1,"layerOrderMode"],showTreeNodeIds:[1,"showTreeNodeIds"],showLatinLabel:[1,"showLatinLabel"],graphNode:[1,"graphNode"],theme:[1,"theme"]},standalone:!0,features:[e.aNF],decls:2,vars:0,consts:[[1,"tree-group",3,"ngClass"],[3,"graph","node","theme","layerOrderMode","showTreeNodeIds","showLatinLabel"],[1,"tree-group__children"],[1,"tree-group__collapse",3,"title"],[3,"graph","graphNode","theme","layerOrderMode","showTreeNodeIds","showLatinLabel"],[1,"tree-group__collapse",3,"click","title"]],template:function(d,r){1&d&&e.Z7z(0,g,3,10,"div",0,f),2&d&&e.Dyx(r.nodes())},dependencies:[h,P.MD,P.YU,S.r],styles:['.tree-group[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none}.tree-group--light[_ngcontent-%COMP%]   .tree-group__collapse[_ngcontent-%COMP%]:after{background:#eaeff5}.tree-group--light[_ngcontent-%COMP%]   .tree-group__collapse[_ngcontent-%COMP%]:hover{background:transparent}.tree-group--light[_ngcontent-%COMP%]   .tree-group__collapse[_ngcontent-%COMP%]:hover:after{background:#d7e0ea}.tree-group__children[_ngcontent-%COMP%]{padding-inline-start:20px;position:relative}.tree-group__collapse[_ngcontent-%COMP%]{position:absolute;inset-inline-start:0;top:0;bottom:0;width:20px;z-index:1}.tree-group__collapse[_ngcontent-%COMP%]:after{content:" ";display:block;position:absolute;width:1px;inset-inline-start:10px;top:0;bottom:0;background:#1c2a3f}.tree-group__collapse[_ngcontent-%COMP%]:hover{cursor:pointer}.tree-group__collapse[_ngcontent-%COMP%]:hover:after{background:#283853}'],changeDetection:0})}return h})()},60724:(le,N,n)=>{"use strict";n.d(N,{r:()=>z});var e=n(54438),t=n(89079),s=n(47610),c=n(13409),O=n(24418),P=n(44867),S=n(61295),a=n(76304),f=n(82542),E=n(35650),y=n(43631),i=n(60177),g=n(89511),p=n(11818),h=n(72026),o=n(82192),v=n(92014),d=n(38645),r=n(37737),_=n(25780),u=n(49989),l=n(21007),m=n(26779),C=n(90413);const b=(I,D,L,Q)=>({"tree-node--light":I,"tree-node--hidden":D,"tree-node--selected":L,"tree-node--unpickable":Q}),R=I=>({"tree-node__label--padded":I});function A(I,D){if(1&I){const L=e.RV6();e.j41(0,"button",14),e.bIt("click",function(){e.eBV(L);const ie=e.XpG();return e.Njj(ie.handleExpandClick(ie.node()))}),e.nrm(1,"app-icon",15),e.k0s()}if(2&I){const L=e.XpG();e.Y8G("buttonTheme",L.theme()),e.BMQ("aria-label",L.getExpandedLabel(L.node()))("aria-expanded",L.node().boolState.expanded),e.R7$(),e.AVh("rotate-45",L.node().boolState.expanded)}}function G(I,D){if(1&I&&(e.j41(0,"div",18),e.EFF(1),e.k0s()),2&I){const L=e.XpG(2);e.R7$(),e.SpI(" ",L.shortId()," ")}}function k(I,D){1&I&&e.nrm(0,"app-icon",20)}function V(I,D){if(1&I&&(e.j41(0,"div",22),e.EFF(1),e.k0s()),2&I){const L=e.XpG(2);e.R7$(),e.SpI(" ",L.node().latinLabel," ")}}function W(I,D){if(1&I){const L=e.RV6();e.j41(0,"div",16),e.bIt("dblclick",function(){e.eBV(L);const ie=e.XpG();return e.Njj(ie.setEditLabelMode(!0))}),e.j41(1,"div",17),e.DNE(2,G,2,1,"div",18),e.j41(3,"div",19),e.DNE(4,k,1,0,"app-icon",20),e.j41(5,"span",21),e.pXf(6,2),e.k0s(),e.EFF(7),e.k0s(),e.DNE(8,V,2,1,"div",22),e.k0s()()}if(2&I){const L=e.XpG();e.Y8G("ngClass",e.eq3(6,R,!L.hasChildren()&&L.nested())),e.BMQ("aria-current",L.checked()),e.R7$(2),e.vxM(L.showTreeNodeIds()?2:-1),e.R7$(2),e.vxM(L.perChapterTreeEnabled()&&!1===L.node().boolState.available?4:-1),e.R7$(3),e.SpI(" ",L.node().label," "),e.R7$(),e.vxM(L.showLatinLabel()&&L.node().latinLabel?8:-1)}}function T(I,D){if(1&I){const L=e.RV6();e.j41(0,"input",23),e.bIt("blur",function(ie){e.eBV(L);const se=e.XpG();return e.Njj(se.handleObjectLabel(ie))})("keyup",function(ie){e.eBV(L);const se=e.XpG();return e.Njj(se.handleObjectLabel(ie))}),e.k0s()}if(2&I){const L=e.XpG();e.Y8G("value",L.node().label)}}function x(I,D){if(1&I){const L=e.RV6();e.j41(0,"input",24),e.bIt("change",function(ie){e.eBV(L);const se=e.XpG();return e.Njj(se.handleLayerOrder(ie,se.node()))}),e.k0s()}if(2&I){const L=e.XpG();e.Y8G("value",L.node().numState.layer)}}let z=(()=>{class I{constructor(L,Q,ie){this.store=L,this.sceneService=Q,this.router=ie,this.themeEnum=f.P,this.isLoft="module"===O.c.exportType,this.nodes=this.store.selectSignal(c.z.getNodes),this.labelEditNode=(0,t.ot)(this.store.select(a.S.getLabelEditNode)),this.perChapterTreeEnabled=(0,t.ot)(this.store.select(y._.getPerChapterTreeEnabled)),this.graph=e.hFB.required(),this.node=e.hFB.required(),this.layerOrderMode=(0,e.hFB)(),this.showTreeNodeIds=(0,e.hFB)(),this.showLatinLabel=(0,e.hFB)(),this.nested=(0,e.hFB)(!0),this.theme=(0,e.hFB)(f.P.Dark),this.hasChildren=(0,e.EWP)(()=>{const se=this.node(),Z=this.graph();return this.nodeHasChildren(Z,se?.id)}),this.checked=(0,e.EWP)(()=>{const se=this.node(),Z=this.nodes();return this.isNodeChecked(Z,se.id)}),this.editLabelMode=(0,e.EWP)(()=>{const se=this.node(),Z=this.labelEditNode();return se.id===Z?.id}),this.sanitizedID=(0,e.EWP)(()=>{const se=this.node();return(0,P.Nk)(se.id)}),this.shortId=(0,e.EWP)(()=>{const se=this.node();return(0,P.KJ)(se.id).replace(/_/g," ")})}ngOnInit(){this.isEditMode=this.router.url.indexOf("/edit")>=0}isNodeChecked(L,Q){return!0===L[Q]?.checked}nodeHasChildren(L,Q){return!(!L||!Q)&&(0,P.IA)(L,Q).length>0}getExpandedLabel(L){const{boolState:Q,label:ie}=L;return Q.expanded?$localize`Collapse`+` ${ie}`:$localize`Expand`+` ${ie}`}handleExpandClick(L){this.toggleExpanded(L,L.boolState.expanded)}toggleVisibleClick(L){this.toggleVisible(L,L.boolState.shown)}handleNodeClick(L,Q){L.shiftKey?this.checkNode(Q):(this.setCheckedNodes(Q),this.isFlyToNodeEnabled(Q)&&this.store.dispatch(new s.W6(Q.id)),this.toggleExpanded(Q,!Q.boolState.expanded))}toggleVisible(L,Q){this.store.dispatch(new S.yr(!Q,[L.id]))}toggleExpanded(L,Q){this.store.dispatch(Q?new s.z(L):new s._o(L))}handleLayerOrder(L,Q){const se=parseInt(L.target.value,10);this.setLayerOrder(Q,se)}checkNode(L){const Q=this.nodes(),ie=!this.isNodeChecked(Q,L.id);this.store.dispatch(new S.q9(ie,[L.id]))}setCheckedNodes(L){const Q=this.nodes();this.store.dispatch(new S.q9(!1));const ie=!this.isNodeChecked(Q,L.id);this.store.dispatch(new S.q9(ie,[L.id]))}setLayerOrder(L,Q){this.store.dispatch(new s.zw([L],Q))}handleObjectLabel(L){const Q=L.target;L instanceof KeyboardEvent?("enter"===L.key.toLowerCase()&&(this.setLabel(Q.value),this.setEditLabelMode(!1)),"escape"===L.key.toLowerCase()&&this.setEditLabelMode(!1)):L instanceof FocusEvent&&"blur"===L.type&&(this.setLabel(Q.value),this.setEditLabelMode(!1))}setLabel(L){const Q=this.node();this.store.dispatch(new s.$h(Q.id,L))}setEditLabelMode(L){if(this.isEditMode){const Q=this.node();this.store.dispatch(new s.ro(L?Q:null))}}isFlyToNodeEnabled(L){return!this.isEditMode&&(L.boolState.shown||this.sceneService.isObjectLoaded(L.id))}static#e=this.\u0275fac=function(Q){return new(Q||I)(e.rXU(v.il),e.rXU(E.w),e.rXU(d.Ix))};static#t=this.\u0275cmp=e.VBU({type:I,selectors:[["app-tree-nested-node"]],inputs:{graph:[1,"graph"],node:[1,"node"],layerOrderMode:[1,"layerOrderMode"],showTreeNodeIds:[1,"showTreeNodeIds"],showLatinLabel:[1,"showLatinLabel"],nested:[1,"nested"],theme:[1,"theme"]},standalone:!0,features:[e.aNF],decls:17,vars:16,consts:()=>{let L,Q,ie;return L=$localize`:6e998fc06a19659c22cca43efa1b35515761cbb25633144232269377096:hide`,Q=$localize`:f67337c708d49ce56772539ee443bac996a24f8e1504349909398224884:show`,ie=$localize`:9ca82952a6bc860b5391d5975322d8af8ceddfa43797570084942068182:Select`,[L,Q,ie,["data-test","treeNode",1,"tree-node",3,"keyup.enter","click","ngClass"],["app-button","","appEventFence","","buttonSize","xs","buttonShape","square","data-test","treeNodeExpand",3,"buttonTheme"],["tabindex","0","role","button",1,"tree-node__label",3,"ngClass"],["type","text","appEventFence","","appAutoFocus","","data-test","treeNodeEditLabel",1,"input",3,"value"],["appEventFence","","type","text","data-test","treeNodeLayerOrder",1,"input","input--small","tree-node__layer-order",3,"value"],["app-button","","buttonSize","xs","buttonShape","square","data-test","treeNodeVisible","appEventFence","",1,"tree-node__visible",3,"click","buttonTheme"],["icon","eye","data-test","treeNodeVisibleTrue","size","xs",1,"text-sm","tree-node__eye"],[1,"sr-only","tree-node__eye"],["icon","eye-slash","data-test","treeNodeVisibleFalse","size","xs",1,"text-sm","tree-node__eye-slash"],[1,"sr-only","tree-node__eye-slash"],["eventCategory","Search Node","appEventFence","",3,"theme","node"],["app-button","","appEventFence","","buttonSize","xs","buttonShape","square","data-test","treeNodeExpand",3,"click","buttonTheme"],["appLogicalDir","","icon","caret-right",1,"inline-block","text-sm"],["tabindex","0","role","button",1,"tree-node__label",3,"dblclick","ngClass"],[1,"flex","flex-col"],["data-test","treeNodeId",1,"uppercase","text-2xs",2,"opacity","0.7"],["data-test","treeNodeLabel",1,"flex","items-center"],["icon","ban","data-test","treeNodeUnavailable","size","xs",1,"mr-1","text-xs","tree-node__unavailable"],[1,"sr-only"],[1,"tree-node__latin-label"],["type","text","appEventFence","","appAutoFocus","","data-test","treeNodeEditLabel",1,"input",3,"blur","keyup","value"],["appEventFence","","type","text","data-test","treeNodeLayerOrder",1,"input","input--small","tree-node__layer-order",3,"change","value"]]},template:function(Q,ie){1&Q&&(e.j41(0,"div",3),e.bIt("keyup.enter",function(Z){return ie.handleNodeClick(Z,ie.node())})("click",function(Z){return ie.handleNodeClick(Z,ie.node())}),e.DNE(1,A,2,5,"button",4)(2,W,9,8,"div",5)(3,T,1,1,"input",6)(4,x,1,1,"input",7),e.j41(5,"button",8),e.bIt("click",function(){return ie.toggleVisibleClick(ie.node())}),e.nrm(6,"app-icon",9),e.j41(7,"span",10),e.qex(8),e.pXf(9,0),e.bVm(),e.EFF(10),e.k0s(),e.nrm(11,"app-icon",11),e.j41(12,"span",12),e.qex(13),e.pXf(14,1),e.bVm(),e.EFF(15),e.k0s()(),e.nrm(16,"app-node-actions",13),e.k0s()),2&Q&&(e.Y8G("ngClass",e.ziG(11,b,ie.theme()===ie.themeEnum.Light,!ie.node().boolState.shown,ie.checked(),!ie.node().boolState.pickable)),e.BMQ("data-id",ie.sanitizedID()),e.R7$(),e.vxM(ie.nested()&&ie.hasChildren()?1:-1),e.R7$(),e.vxM(ie.editLabelMode()?-1:2),e.R7$(),e.vxM(ie.editLabelMode()?3:-1),e.R7$(),e.vxM(ie.layerOrderMode()?4:-1),e.R7$(),e.Y8G("buttonTheme",ie.theme()),e.R7$(5),e.SpI(" ",ie.node().label,""),e.R7$(5),e.SpI(" ",ie.node().label,""),e.R7$(),e.Y8G("theme",ie.theme())("node",ie.node()))},dependencies:[i.MD,i.YU,g.h,r.B,_.L,u.e,p.C,l.Q,h.o,m.R,o.G,C.D],styles:[":host{display:block}.tree-node{border-radius:4px;padding:4px;margin-bottom:4px;display:flex;align-items:center;height:100%;-webkit-user-select:none;user-select:none;min-width:200px;transition:background-color .12s}.tree-node--light{padding-right:12px}.tree-node--light:focus{outline:#2d72dc solid 2px!important;outline-offset:-2px;border-radius:4px}.tree-node--light .tree-node__label{color:#101823;font-size:.75rem;line-height:1rem}.tree-node--light .tree-node__latin-label{color:#374a68;font-size:.625rem;line-height:.75rem;text-transform:lowercase;font-style:italic}.tree-node--light.tree-node--selected{background:transparent;border-left-color:transparent}.tree-node--light.tree-node--selected .tree-node__label{color:#101823!important}.tree-node--light.tree-node--selected .tree-node__expand,.tree-node--light.tree-node--selected .tree-node__visible{color:#101823}.tree-node--light.tree-node--unpickable{border:none}.tree-node--light.tree-node--hidden .tree-node__label,.tree-node--light.tree-node--hidden .tree-node__latin-label{color:#61779e}.tree-node--light .tree-node__expand,.tree-node--light .tree-node__visible{background-color:transparent;color:#96a8c0;border-radius:4px}.tree-node--selected{background-color:#2d72dc}.tree-node--selected .tree-node__label{color:#fff}.tree-node--unpickable{border:1px dashed #61779e}.tree-node--hidden .tree-node__expand,.tree-node--hidden .tree-node__visible,.tree-node--hidden .tree-node__label{color:#96a8c0}.tree-node--hidden .tree-node__visible{visibility:visible}.tree-node.tree-node--hidden.tree-node--selected .tree-node__expand,.tree-node.tree-node--hidden.tree-node--selected .tree-node__visible,.tree-node.tree-node--hidden.tree-node--selected .tree-node__label{color:#fff}.tree-node__label{font-size:.75rem;line-height:1rem;font-weight:400;line-height:1.3em;color:#d7e0ea;padding:8px 4px 8px 12px;display:flex;align-items:center;flex:1 1 100%;min-height:28px}.tree-node__label--padded{padding-left:36px}.tree-node__expand i{transition:transform .12s}.tree-node__expand--open app-icon{transform:rotate(45deg)}.tree-node .tree-node__expand+.tree-node__label{margin-left:-8px}.tree-node__expand,.tree-node__visible{border-radius:4px;color:#d7e0ea;display:flex;flex:0 0 24px;height:24px;justify-content:center;align-items:center;border:none}.tree-node__layer-order{font-size:10px;flex:0 0 56px;min-height:28px;height:28px;padding:4px;margin:2px;text-align:center}.tree-node .tree-node__unavailable{color:#de5959}.tree-node .tree-node__eye,.tree-node .tree-node__eye-slash{display:none}.tree-node:not(.tree-node--hidden) .tree-node__eye{display:inline}.tree-node.tree-node--hidden .tree-node__eye-slash{display:inline}@media (hover: hover){.tree-node__visible{visibility:hidden}.tree-node:hover,.tree-node:focus-within{cursor:pointer}.tree-node:hover .tree-node__visible,.tree-node:focus-within .tree-node__visible{visibility:visible}.tree-node:hover .tree-node__label,.tree-node:focus-within .tree-node__label{color:#fff}.tree-node--light:hover,.tree-node--light:focus-within{background-color:#1018230d}.tree-node--light:hover .tree-node__label,.tree-node--light:focus-within .tree-node__label{color:#101823}.tree-node--light:hover .tree-node__latin-label,.tree-node--light:focus-within .tree-node__latin-label{color:#374a68}.tree-node--light.tree-node--selected{background-color:#1018230d}.tree-node--light.tree-node--selected:hover{background-color:#1018231a}.tree-node--light.tree-node--selected .tree-node__label{color:#101823}.tree-node--light.tree-node--selected .tree-node__expand:hover,.tree-node--light.tree-node--selected .tree-node__visible:hover,.tree-node--light .tree-node__expand:hover,.tree-node--light .tree-node__visible:hover{background-color:transparent;color:inherit}.tree-node__expand:hover,.tree-node__visible:hover{background-color:#1c2a3f;color:#fff;cursor:pointer}.tree-node--selected .tree-node__expand:hover,.tree-node--selected .tree-node__visible:hover{background-color:#2d72dc}.tree-node .tree-node__eye,.tree-node .tree-node__eye-slash{display:none}.tree-node:hover:not(.tree-node--hidden) .tree-node__eye{display:inline}.tree-node.tree-node--hidden .tree-node__eye-slash{display:inline}}\n"],encapsulation:2,changeDetection:0})}return I})()},30356:(le,N,n)=>{"use strict";n.d(N,{k:()=>_});var e=n(54438),t=n(89079),s=n(87996),c=n(14264),O=n(17365),P=n(90917),S=n(82542),a=n(18272),f=n(47610),E=n(60177),y=n(7806),i=n(60724),g=n(65478),p=n(92014),h=n(18617);function o(u,l){1&u&&(e.j41(0,"div",5),e.pXf(1,0),e.k0s())}function v(u,l){if(1&u&&e.nrm(0,"app-tree",3),2&u){const m=e.XpG();e.Y8G("theme",m.theme())("graph",m.searchGraph())("layerOrderMode",m.layerOrderMode())("showTreeNodeIds",m.showTreeNodeIds())("showLatinLabel",m.showLatinLabel())}}function d(u,l){if(1&u&&(e.j41(0,"div"),e.nrm(1,"app-tree-nested-node",8),e.k0s()),2&u){const m=l.$implicit,C=e.XpG(2);e.R7$(),e.Y8G("theme",C.theme())("nested",!1)("node",m)("graph",C.viewGraph())("layerOrderMode",C.layerOrderMode())("showTreeNodeIds",C.showTreeNodeIds())("showLatinLabel",C.showLatinLabel())}}function r(u,l){if(1&u&&(e.j41(0,"cdk-virtual-scroll-viewport",4)(1,"div",6),e.DNE(2,d,2,7,"div",7),e.k0s()()),2&u){const m=e.XpG();e.Y8G("itemSize",64),e.R7$(2),e.Y8G("cdkVirtualForOf",m.searchResults())("cdkVirtualForTrackBy",m.trackTreeNode)}}let _=(()=>{class u{constructor(m,C){this.store=m,this.liveAnnouncer=C,this.treeSearchDisplayMode=a.q,this.selectedChapter=e.hFB.required(),this.theme=(0,e.hFB)(S.P.Dark),this.query=(0,e.hFB)(),this.displayMode=(0,e.hFB)(a.q.List),this.viewGraph=(0,e.hFB)(),this.viewGraphMetadata=(0,e.hFB)(),this.viewGraphRank=e.hFB.required(),this.layerOrderMode=(0,e.hFB)(),this.showTreeNodeIds=(0,e.hFB)(),this.showLatinLabel=(0,e.hFB)(),this.searchResults=(0,e.EWP)(()=>{const b=this.query().trim(),R=this.viewGraph(),A=this.displayMode(),G=this.viewGraphRank();if(A===a.q.Tree)return(0,P.i)(R,b,[{field:"label",dir:"asc"}]);{const k=(0,P.Z6)(Object.values(R.nodes),b);return(0,P.XS)(k,G.initiallyShownRank)}}),this.searchGraph=(0,e.EWP)(()=>{const b=this.viewGraph(),R=this.searchResults();return(0,P.YL)(b,R)}),(0,t.br)(this.query).pipe((0,s.B)(600),(0,t.pQ)()).subscribe(()=>{const b=this.searchResults().length;this.liveAnnouncer.announce(`${b} structures found`)}),(0,t.br)(this.displayMode).pipe((0,c.p)(b=>b===a.q.List),(0,O.s)(1),(0,t.pQ)()).subscribe(()=>{this.store.dispatch(new f.q)})}trackTreeNode(m,C){return C.id}static#e=this.\u0275fac=function(C){return new(C||u)(e.rXU(p.il),e.rXU(h.Ai))};static#t=this.\u0275cmp=e.VBU({type:u,selectors:[["app-tree-search"]],inputs:{selectedChapter:[1,"selectedChapter"],theme:[1,"theme"],query:[1,"query"],displayMode:[1,"displayMode"],viewGraph:[1,"viewGraph"],viewGraphMetadata:[1,"viewGraphMetadata"],viewGraphRank:[1,"viewGraphRank"],layerOrderMode:[1,"layerOrderMode"],showTreeNodeIds:[1,"showTreeNodeIds"],showLatinLabel:[1,"showLatinLabel"]},standalone:!0,features:[e.aNF],decls:4,vars:2,consts:()=>{let m;return m=$localize`:e4e28b371f8453e22779db590cb0fe67f2a080e87839102902838664367:No results`,[m,[1,"tree-search"],["class","tree-search__empty",4,"ngIf"],[1,"tree-search__tree",3,"theme","graph","layerOrderMode","showTreeNodeIds","showLatinLabel"],[3,"itemSize"],[1,"tree-search__empty"],[1,"flex","flex-col","flex-auto","gap-1"],[4,"cdkVirtualFor","cdkVirtualForOf","cdkVirtualForTrackBy"],[1,"",3,"theme","nested","node","graph","layerOrderMode","showTreeNodeIds","showLatinLabel"]]},template:function(C,b){if(1&C&&(e.j41(0,"div",1),e.DNE(1,o,2,0,"div",2)(2,v,1,5,"app-tree",3)(3,r,3,3,"cdk-virtual-scroll-viewport",4),e.k0s()),2&C){let R;e.R7$(),e.Y8G("ngIf",0===b.searchResults().length),e.R7$(),e.vxM((R=b.displayMode())===b.treeSearchDisplayMode.Tree?2:R===b.treeSearchDisplayMode.List?3:-1)}},dependencies:[E.MD,E.bT,y.g,i.r,g.E9,g.yg,g.E$,g.d6],styles:[".tree-search{display:flex;flex-direction:column;flex:1 1 auto;height:100%}.tree-search__tree{flex-grow:1;width:100%;overflow-y:auto;contain:strict}.tree-search__empty{font-size:.875rem;line-height:1.25rem;padding:12px;font-style:italic;margin-top:12px}.tree-search cdk-virtual-scroll-viewport{flex:1 1 auto}\n"],encapsulation:2,changeDetection:0})}return u})()},90917:(le,N,n)=>{"use strict";n.d(N,{D$:()=>E,XS:()=>y,YL:()=>S,Z6:()=>f,i:()=>a});var e=n(44867),t=n(23881),s=n(49204),O=n(78851);function P(h,o,v){(0,e.iu)(h,o);const d=(0,e.ir)(v,o.id);if(d){const r=h.successors[d]||[];r.push(o.id);const _=v.successors[d];return h.successors[d]=(0,s.uniq)(r).sort((u,l)=>_.indexOf(u)-_.indexOf(l)),h.predecessors[o.id]=d,P(h,(0,e.dV)(v,d),v)}return(0,e.Sg)(h,o),h}function S(h,o){if(0===o.length)return(0,t.q3)();const v=o.reduce((r,_)=>P(r,_,h),(0,t.q3)()),d=Object.keys(h.roots);return v.roots=d.reduce((r,_)=>(_ in v.roots&&(r[_]=v.roots[_]),r),{}),v}function a(h,o,v=[]){if((0,s.isEmpty)(h))return[];const r=f(Object.values(h.nodes),o);return v.length>0?E(r,v):r}function f(h,o){return o=(0,O.TF)(o.toLowerCase()),h.filter(v=>{const{label:d,latinLabel:r}=v;if(0===o.length)return!0;const _=(0,O.TF)(d.toLowerCase()??""),u=r?.toLowerCase()??"";return _.includes(o)||u.includes(o)})}function E(h,o){return h.sort((v,d)=>{for(let r=0;r<o.length;r++){const{field:_,dir:u}=o[r];if("label"===_){const l=i(v.label,d.label,"asc"===u);if(0!==l)return l}if("depth"===_){const l=g(v.depth,d.depth,"asc"===u);if(0!==l)return l}if("shown"===_){const l=p(v.boolState.shown,d.boolState.shown,"asc"===u);if(0!==l)return l}}return 0})}function y(h,o){return h.sort((v,d)=>o[v.id]-o[d.id])}function i(h,o,v){return v?h.localeCompare(o):o.localeCompare(h)}function g(h,o,v){const d=Math.sign(h-o);return v?d:-d}function p(h,o,v){const d=Math.sign(Number(o)-Number(h));return v?d:-d}},90556:(le,N,n)=>{"use strict";n.d(N,{f:()=>i});var e=n(60177),t=n(45189),s=n(12854),c=n(60724),O=n(7806),P=n(30356),S=n(89511),a=n(72026),f=n(82192),E=n(11818),y=n(54438);let i=(()=>{class g{static#e=this.\u0275fac=function(o){return new(o||g)};static#t=this.\u0275mod=y.$C({type:g});static#n=this.\u0275inj=y.G2t({imports:[e.MD,a.o,t.G,E.C,f.G,S.h,O.g,s.X,c.r,P.k]})}return g})()},7806:(le,N,n)=>{"use strict";n.d(N,{g:()=>h});var e=n(54438),t=n(14264),s=n(87996),c=n(13409),O=n(82542),P=n(49204),a=n(46842),f=n(44867),E=n(90908),y=n(89079),i=n(60177),g=n(12854),p=n(92014);let h=(()=>{class o{constructor(d){this.store=d,this.graph=e.hFB.required(),this.layerOrderMode=e.hFB.required(),this.showTreeNodeIds=e.hFB.required(),this.showLatinLabel=(0,e.hFB)(),this.theme=(0,e.hFB)(O.P.Dark),this.initNodeScrollListener()}initNodeScrollListener(){this.store.select(c.z.getCheckedNodes).pipe((0,t.p)(d=>1===d.length),(0,s.B)(0),(0,y.pQ)()).subscribe(([d])=>{this.scrollNodeIntoView(d.objectId)})}scrollNodeIntoView(d){const r=(0,f.Nk)(d),_=document.querySelector(`[data-id="${r}"]`);if(!(0,P.isNil)(_)&&(0,E.uK)()){const u=this.store.selectSnapshot(a.U.getPrefersReducedMotion)?"instant":"smooth";_.scrollIntoView({behavior:u,block:"nearest"})}}static#e=this.\u0275fac=function(r){return new(r||o)(e.rXU(p.il))};static#t=this.\u0275cmp=e.VBU({type:o,selectors:[["app-tree"]],inputs:{graph:[1,"graph"],layerOrderMode:[1,"layerOrderMode"],showTreeNodeIds:[1,"showTreeNodeIds"],showLatinLabel:[1,"showLatinLabel"],theme:[1,"theme"]},standalone:!0,features:[e.aNF],decls:1,vars:5,consts:[[3,"theme","graph","layerOrderMode","showTreeNodeIds","showLatinLabel"]],template:function(r,_){1&r&&e.nrm(0,"app-tree-group",0),2&r&&e.Y8G("theme",_.theme())("graph",_.graph())("layerOrderMode",_.layerOrderMode())("showTreeNodeIds",_.showTreeNodeIds())("showLatinLabel",_.showLatinLabel())},dependencies:[i.MD,g.X],changeDetection:0})}return o})()},77276:(le,N,n)=>{"use strict";n.d(N,{Ty:()=>O,fw:()=>P,kf:()=>s,zx:()=>S});var e=n(43442),t=n(27153);const s="School & Business Plans Only",O={[e.j.BookmarkViewThresholdReached]:{title:"BookmarkViewThresholdReach",actionText:"Upgrade Now"},[e.j.BookmarkViewLimitReached]:{title:"You've reached your 10 free views this month",description:"You can come back next month for another 10 free views or upgrade your plan for unlimited access to 1000+ anatomy, condition, and treatment models.",image:"assets/images/biodigital-human-explore-3d-human-anatomy.jpg",actionText:"Upgrade Now"},[e.j.ProAccountPastDue]:{title:"AccountPastDue",actionText:"Upgrade Now"},[e.j.BookmarkSaveThresholdReached]:{title:"BookmarkSaveThresholdReached",actionText:"Upgrade Now"},[e.j.BookmarkSaveLimitReached]:{title:"You've reached your limit of 5 saved models",description:"In order to save more models on your free plan, you will need to delete models in My Library or upgrade your plan.",image:"assets/images/biodigital-human-3d-model-my-library.jpg",actionText:"Upgrade Now",secondaryActionText:"Go to My Library to delete models"},[e.j.TeamTrailExpired]:{title:"TrailExpired",actionText:"Upgrade Now"},[e.j.Publish]:{title:"Publish your 3D model",description:"Upgrade to publish to your learning management system, website, or application and make your 3D models available for anyone to view and interact.",image:"assets/images/biodigital-human-publish-custom-3D-model.jpg",tag:s,tagIcon:"lock",actionText:"Upgrade Now"},[e.j.IndividualUploadVideo]:{title:"Add videos to your 3D model",description:"Upgrade your account, and take your content to the next level with video uploads. Plus, get full access to 1,000+ anatomy, condition and treatment models.",image:"assets/images/biodigital-human-upload-videos.jpg",tag:s,tagIcon:"lock",actionText:"Upgrade Now"},[e.j.ExternalAccountEdit]:{title:"Your Human Studio access has expired",actionText:"Contact Support",image:"assets/images/biodigital-human-customize-3D-model-in-studio.jpg"},[e.j.TeamEditModel]:{title:"Customize your 3D model",image:"assets/images/biodigital-human-customize-3D-model-in-studio.png",actionText:"Join Team"},[e.j.TeamAddModel]:{title:"Add to My Library",image:"assets/images/biodigital-human-3d-model-my-library.jpg",actionText:"Join Team"},[e.j.TeamPublish]:{title:"Publish your 3D model",image:"assets/images/biodigital-human-publish-custom-3d-model.png",actionText:"Join Team"}};function P(a,f,E){return`To let your institution know that you would like to continue using Human Studio, please contact the ${t.n3[a]} support team at <a class="text-link underline" target="_blank" href="${S(a,f,E)}">${t.mY[a]}</a>.`}function S(a,f,E){return(0,t.NP)(t.mY[a],"Request for Human Studio Access in the BioDigital Human",`Hello,\n  \nI received a notification that access to Human Studio has expired for my team.\n  \nI find Human Studio to be an invaluable resource, and would like my institution, ${f}, to know that I am interested in having our access restored. I would appreciate it if you could notify them on my behalf.\n  \nThanks!\n  \n${E}`)}},74459:(le,N,n)=>{"use strict";n.d(N,{q:()=>e});var e=function(t){return t.Modal="Modal",t.Footer="Footer",t.Notification="Notification",t}(e||{})},43442:(le,N,n)=>{"use strict";n.d(N,{j:()=>e});var e=function(t){return t[t.BookmarkViewThresholdReached=0]="BookmarkViewThresholdReached",t[t.BookmarkViewLimitReached=1]="BookmarkViewLimitReached",t[t.BookmarkSaveThresholdReached=2]="BookmarkSaveThresholdReached",t[t.BookmarkSaveLimitReached=3]="BookmarkSaveLimitReached",t[t.ProAccountPastDue=4]="ProAccountPastDue",t[t.TeamTrailExpired=5]="TeamTrailExpired",t[t.Publish=6]="Publish",t[t.IndividualUploadVideo=7]="IndividualUploadVideo",t[t.ExternalAccountEdit=8]="ExternalAccountEdit",t[t.TeamEditModel=9]="TeamEditModel",t[t.TeamAddModel=10]="TeamAddModel",t[t.TeamPublish=11]="TeamPublish",t}(e||{})},39596:(le,N,n)=>{"use strict";n.d(N,{p:()=>H});var e=n(49204),t=n(15877),s=n(96513),c=n(14264),O=n(32914),P=n(36110),S=n(38165),a=n(34006),f=n(92014),E=n(2573),y=n(15623),i=n(38104),g=n(66571),p=n(54438),h=n(38645),o=n(21007),v=n(26779),d=n(60177),r=n(11583),_=n(35286);function u(te,F){if(1&te&&p.nrm(0,"app-tag",11),2&te){const w=p.XpG();p.Y8G("icon",w.content.tagIcon)("label",w.content.tag)}}function l(te,F){if(1&te&&(p.nrm(0,"div",12),p.nI1(1,"markdown"),p.nI1(2,"async")),2&te){const w=p.XpG();p.Y8G("innerHTML",p.bMT(2,3,p.bMT(1,1,w.content.description)),p.npT)}}function m(te,F){if(1&te&&(p.j41(0,"div",13),p.EFF(1," Already a member? "),p.j41(2,"a",14),p.EFF(3,"Sign in"),p.k0s(),p.EFF(4,". "),p.k0s()),2&te){const w=p.XpG();p.R7$(2),p.Y8G("href",w.content.signInUrl,p.B4B)}}function C(te,F){if(1&te){const w=p.RV6();p.j41(0,"a",15),p.bIt("click",function(){p.eBV(w);const oe=p.XpG();return p.Njj(oe.handleSecondaryActionClick())}),p.EFF(1),p.k0s()}if(2&te){const w=p.XpG();p.R7$(),p.SpI(" ",w.content.secondaryActionText," ")}}function b(te,F){if(1&te&&(p.j41(0,"div",16),p.nrm(1,"img",17),p.k0s()),2&te){const w=p.XpG();p.R7$(),p.Y8G("src",w.content.image,p.B4B),p.BMQ("alt",w.content.title)}}let R=(()=>{class te{constructor(){this.actionClick=new p.bkB,this.secondaryActionClick=new p.bkB}ngOnInit(){}handleActionClick(){this.actionClick.emit()}handleSecondaryActionClick(){this.secondaryActionClick.emit()}static#e=this.\u0275fac=function(X){return new(X||te)};static#t=this.\u0275cmp=p.VBU({type:te,selectors:[["app-callout-content"]],inputs:{content:"content",compact:"compact"},outputs:{actionClick:"actionClick",secondaryActionClick:"secondaryActionClick"},decls:14,vars:9,consts:[["data-test","calloutContent",1,"callout","flex","flex-row","items-center"],[1,"callout__content","flex","flex-col","items-start","px-4"],[1,"flex","flex-row","items-center",2,"flex-wrap","wrap"],["data-test","calloutContentTitle",1,"callout__title"],["data-test","calloutContentTag",3,"icon","label",4,"ngIf"],["class","callout__description mt-5 html","data-test","calloutContentDescription",3,"innerHTML",4,"ngIf"],["class","mt-5","data-test","calloutContentSignInUrl",4,"ngIf"],[1,"callout__actions","mt-10"],["type","button","app-button","","buttonTheme","light","buttonType","primary","buttonSize","xl","data-test","calloutContentAction","cdkFocusInitial","",1,"mr-6",3,"click"],["class","text-link text-sm my-4","data-test","calloutContentSecondaryAction",3,"click",4,"ngIf"],["class","callout__image-container flex flex-row items-start justify-between px-4",4,"ngIf"],["data-test","calloutContentTag",3,"icon","label"],["data-test","calloutContentDescription",1,"callout__description","mt-5","html",3,"innerHTML"],["data-test","calloutContentSignInUrl",1,"mt-5"],[1,"text-link","underline",3,"href"],["data-test","calloutContentSecondaryAction",1,"text-link","text-sm","my-4",3,"click"],[1,"callout__image-container","flex","flex-row","items-start","justify-between","px-4"],["data-test","calloutContentImage",1,"callout__image",3,"src"]],template:function(X,oe){1&X&&(p.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),p.EFF(4),p.k0s(),p.j41(5,"div"),p.DNE(6,u,1,2,"app-tag",4),p.k0s()(),p.DNE(7,l,3,5,"div",5)(8,m,5,1,"div",6),p.j41(9,"div",7)(10,"button",8),p.bIt("click",function(){return oe.handleActionClick()}),p.EFF(11),p.k0s(),p.DNE(12,C,2,1,"a",9),p.k0s()(),p.DNE(13,b,2,2,"div",10),p.k0s()),2&X&&(p.AVh("callout--compact",oe.compact),p.R7$(4),p.JRh(oe.content.title),p.R7$(2),p.Y8G("ngIf",oe.content.tag),p.R7$(),p.Y8G("ngIf",oe.content.description),p.R7$(),p.Y8G("ngIf",oe.content.signInUrl),p.R7$(3),p.SpI(" ",oe.content.actionText," "),p.R7$(),p.Y8G("ngIf",oe.content.secondaryActionText),p.R7$(),p.Y8G("ngIf",oe.content.image&&!oe.compact))},dependencies:[o.Q,d.bT,r.e,d.Jj,_.i0],styles:[".callout[_ngcontent-%COMP%]{background-color:#fff}.callout__content[_ngcontent-%COMP%]{flex:1 1 auto}.callout__title[_ngcontent-%COMP%]{font-size:1.5rem;line-height:2rem;letter-spacing:inherit;color:#131c2a;font-weight:600;margin-right:20px}.callout__description[_ngcontent-%COMP%]{font-size:1rem;line-height:1.5rem;display:flex;flex-direction:column;gap:24px}.callout__actions[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;flex-flow:wrap}.callout__image-container[_ngcontent-%COMP%]{flex:1;flex-basis:480px;width:100%}.callout__image[_ngcontent-%COMP%]{max-width:480px}.callout--compact[_ngcontent-%COMP%]   .callout__content[_ngcontent-%COMP%]{flex-basis:100%}.callout--compact[_ngcontent-%COMP%]   .callout__title[_ngcontent-%COMP%]{font-size:1.25rem;line-height:1.75rem;margin-bottom:4px}.callout--compact[_ngcontent-%COMP%]   .callout__description[_ngcontent-%COMP%]{font-size:.875rem;line-height:1.25rem;gap:16px}.callout[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline}"],changeDetection:0})}return te})();class k{constructor(F,w,X,oe){this.router=F,this.dialogService=w,this.dialogRef=X,this.breakPoints=y.m,this.data=oe}handleCloseClick(){this.dialogRef.close(!0)}handleActionClick(){"function"==typeof this.data.actionHandler?(this.data.actionHandler(),this.dialogRef.close()):this.dialogService.openUpgradeDialog(!1)}handleSecondaryActionClick(){this.router.navigate(["/results/bookmarks"]).then(()=>{this.dialogRef.close()})}static#e=this.\u0275fac=function(w){return new(w||k)(p.rXU(h.Ix),p.rXU(g.o),p.rXU(a.CP),p.rXU(a.Vh))};static#t=this.\u0275cmp=p.VBU({type:k,selectors:[["app-premium-access-dialog"]],decls:8,vars:10,consts:[["data-test","premiumAccessDialog",1,"dialog","flex","flex-row","items-start"],[1,"flex","items-center","justify-center","flex-auto"],[1,"dialog__content","flex","flex-row","items-start","justify-center","flex-auto"],[3,"actionClick","secondaryActionClick","content","compact"],["app-button","","buttonType","default","buttonTheme","light","type","button","title","Close","data-test","premiumAccessDialogClose",1,"modal__close",3,"click"],["icon","times","size","lg"]],template:function(w,X){1&w&&(p.j41(0,"div",0),p.nI1(1,"async"),p.j41(2,"div",1)(3,"div",2)(4,"app-callout-content",3),p.nI1(5,"async"),p.bIt("actionClick",function(){return X.handleActionClick()})("secondaryActionClick",function(){return X.handleSecondaryActionClick()}),p.k0s()()(),p.j41(6,"button",4),p.bIt("click",function(){return X.handleCloseClick()}),p.nrm(7,"app-icon",5),p.k0s()()),2&w&&(p.AVh("dialog--compact",p.bMT(1,6,X.horizontalBreakpoint$)<=X.breakPoints.Medium),p.BMQ("aria-label","Premium Access"),p.R7$(4),p.Y8G("content",X.data)("compact",p.bMT(5,8,X.horizontalBreakpoint$)<=X.breakPoints.Medium),p.R7$(2),p.BMQ("aria-label","Close"))},dependencies:[o.Q,v.R,R,d.Jj],styles:[".dialog[_ngcontent-%COMP%]{padding:24px}.dialog__content[_ngcontent-%COMP%]{max-width:1140px}.dialog--compact[_ngcontent-%COMP%]   .dialog__content[_ngcontent-%COMP%]{margin:0}"],changeDetection:0})}!function(te,F,w,X){var he,oe=arguments.length,Y=oe<3?F:null===X?X=Object.getOwnPropertyDescriptor(F,w):X;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)Y=Reflect.decorate(te,F,w,X);else for(var ne=te.length-1;ne>=0;ne--)(he=te[ne])&&(Y=(oe<3?he(Y):oe>3?he(F,w,Y):he(F,w))||Y);oe>3&&Y&&Object.defineProperty(F,w,Y)}([(0,f.l6)(i.V.getHorizontalBreakpoint),function(te,F){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata("design:type",F)}(0,E.c)],k.prototype,"horizontalBreakpoint$",void 0);var V=n(85052),W=n(76718),T=n(37925),x=n(84178);let z=(()=>{class te{constructor(w,X,oe){this.router=w,this.activatedRoute=X,this.dialogRef=oe,this.ngUnsubscribe=new V.B}ngOnInit(){this.closeOnLoginPage()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}closeOnLoginPage(){(0,W.h)(this.activatedRoute.url,this.router.events.pipe((0,c.p)(w=>w instanceof h.wF))).pipe((0,P.T)(()=>this.router.url),(0,T.Q)(this.ngUnsubscribe)).subscribe(w=>{w.startsWith("/login")&&this.dialogRef.close()})}handleDismissClick(){this.dialogRef.close()}static#e=this.\u0275fac=function(X){return new(X||te)(p.rXU(h.Ix),p.rXU(h.nX),p.rXU(a.CP))};static#t=this.\u0275cmp=p.VBU({type:te,selectors:[["app-signup-footer-dialog"]],decls:5,vars:3,consts:[["data-test","signupFooterDialog",1,"signup-footer-dialog","flex","flex-col","items-center"],[1,"signup-footer-dialog__message"],[3,"compact"],["app-button","","buttonType","default","buttonTheme","light","type","button","title","Close",1,"signup-footer-dialog__close",3,"click"],["icon","times","size","lg"]],template:function(X,oe){1&X&&(p.j41(0,"div",0)(1,"div",1),p.nrm(2,"app-signup-messaging",2),p.k0s(),p.j41(3,"button",3),p.bIt("click",function(){return oe.handleDismissClick()}),p.nrm(4,"app-icon",4),p.k0s()()),2&X&&(p.BMQ("aria-label","Sign Up"),p.R7$(2),p.Y8G("compact",!1),p.R7$(),p.BMQ("aria-label","Close"))},dependencies:[o.Q,v.R,x.i],styles:[".signup-footer-dialog[_ngcontent-%COMP%]{padding-top:36px;padding-bottom:36px}.signup-footer-dialog__message[_ngcontent-%COMP%]{max-width:632px}.signup-footer-dialog__close[_ngcontent-%COMP%]{position:absolute;top:12px;right:12px}@media (max-width: 480px){.signup-footer-dialog[_ngcontent-%COMP%]{padding-top:32px;padding-bottom:32px}.signup-footer-dialog__message[_ngcontent-%COMP%]{max-width:320px}}"],changeDetection:0})}return te})();var I=n(17215),D=n(24418),L=n(58686),Q=n(76203);let se=(()=>{class te{constructor(w,X,oe){this.dialogService=w,this.storageService=X,this.dialogRef=oe,this.supportEmail=D.c.supportEmail,this.upgradeLabel="Your 14-day trial has expired and your account now has limited functionality. To regain access to the full power of the BioDigital Human platform, choose the plan that\u2019s perfect for you and:"}ngOnInit(){}handleCancelClick(){this.storageService.setLocalItem(I.UT.TeamTrialExpirationSeen,!0),this.dialogRef.close()}handleChooseClick(){this.storageService.setLocalItem(I.UT.TeamTrialExpirationSeen,!0),this.dialogService.openUpgradeDialog()}static#e=this.\u0275fac=function(X){return new(X||te)(p.rXU(g.o),p.rXU(I.n$),p.rXU(a.CP))};static#t=this.\u0275cmp=p.VBU({type:te,selectors:[["app-trial-expired-dialog"]],decls:15,vars:2,consts:[[1,"dialog"],["app-button","","buttonType","text","buttonTheme","light","type","button","title","Close",1,"dialog__close",3,"click"],["icon","times","size","lg"],[1,"dialog__content","flex","flex-col","items-center","justify-center"],[1,"mb-4","text-2xl","font-semibold","text-center"],["src","assets/images/biodigital-multidevice-graphic.jpg",1,"dialog__image"],["app-button","","buttonType","primary",1,"my-4",3,"click"],[1,"my-4"],[3,"label"],[1,"mt-4","text-sm"],["role","button","tabindex","0","appSupportLink","",1,"underline"]],template:function(X,oe){1&X&&(p.j41(0,"div",0)(1,"button",1),p.bIt("click",function(){return oe.handleCancelClick()}),p.nrm(2,"app-icon",2),p.k0s(),p.j41(3,"div",3)(4,"div",4),p.EFF(5,"Your free trial has ended"),p.k0s(),p.nrm(6,"img",5),p.j41(7,"button",6),p.bIt("click",function(){return oe.handleChooseClick()}),p.EFF(8," Upgrade Now "),p.k0s(),p.j41(9,"div",7),p.nrm(10,"app-team-features",8),p.k0s(),p.j41(11,"div",9),p.EFF(12," Need more time for evaluation? "),p.j41(13,"span",10),p.EFF(14,"Contact us"),p.k0s()()()()),2&X&&(p.R7$(),p.BMQ("aria-label","Close"),p.R7$(9),p.Y8G("label",oe.upgradeLabel))},dependencies:[o.Q,L.R,v.R,Q.W],styles:[".dialog[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;height:100%;padding:32px;width:90vw;height:90vh}.dialog__close[_ngcontent-%COMP%]{position:absolute;top:8px;right:8px}.dialog__content[_ngcontent-%COMP%]{max-width:520px}.dialog__image[_ngcontent-%COMP%]{width:100%;max-width:360px}@media (max-width: 480px){.dialog[_ngcontent-%COMP%]{width:100vw;height:100vh}}"],changeDetection:0})}return te})();var Z=n(84370),de=n(94495),ae=n(59e3),q=n(5690),K=n(77276),j=n(74459),M=n(43442),$=n(21424),ce=n(16823),re=n(27153);const ue={[M.j.BookmarkViewLimitReached]:"View gate",[M.j.BookmarkSaveLimitReached]:"Save gate",[M.j.Publish]:"Publish gate",[M.j.IndividualUploadVideo]:"Individual video upload gate",[M.j.ExternalAccountEdit]:"External account edit gate"};let H=(()=>{class te{constructor(w,X,oe,Y,he){this.store=w,this.dialog=X,this.vendorAnalyticsService=oe,this.productService=Y,this.router=he}openPastDue(){this.store.dispatch(new S.$_(M.j.ProAccountPastDue,j.q.Notification))}openBookmarkViewWarning(w,X){this.store.dispatch(new S.$_(M.j.BookmarkViewThresholdReached,j.q.Footer,{title:`You've viewed **${w} of ${X}** models this month.`,actionText:"Get Unlimited Acccess"}))}openPublicViewGate(){return this.dialog.open(z,{id:Z.t.PublicViewGateDialog,backdropClass:"bd-dialog-backdrop-alt",panelClass:"bg-dialog-docked",disableClose:!0,data:{}}).afterClosed()}closePublicViewGate(){const w=this.dialog.getDialogById(Z.t.PublicViewGateDialog);w&&w.close()}openBookmarkViewLimit(){return this.openPremiumAccessDialog(M.j.BookmarkViewLimitReached,{},!1)}openBookmarkSaveWarning(w,X){this.store.dispatch(new S.$_(M.j.BookmarkSaveThresholdReached,j.q.Footer,{title:`You've saved **${w} of ${X}** free models.`,actionText:"Get Unlimited Storage"}))}openBookmarkSaveLimit(){return this.openPremiumAccessDialog(M.j.BookmarkSaveLimitReached)}openPublishPaywall(w){const X=w?.data?.organizations??[];if(X.length>0){const oe=X?.[0]?.name??"",Y=(0,re.eu)(w),he=(0,re.Iw)(w);return this.openPremiumAccessDialog(M.j.TeamPublish,{description:`Join the **${oe}** team to generate a direct link to your 3D model or seamlessly embed it into a learning management system or website.`,signInUrl:Y,actionText:"Join Team",actionHandler:()=>{this.router.navigateByUrl(he)}})}return this.openPremiumAccessDialog(M.j.Publish)}openEditPaywall(w){const oe=(w?.data?.organizations??[])?.[0]?.name??"",Y=(0,re.eu)(w),he=(0,re.Iw)(w);return this.openPremiumAccessDialog(M.j.TeamEditModel,{description:`Join the **${oe}** team to access Human Studio, where you can isolate, label, and paint key structures, build virtual tours and quizzes, and more!`,signInUrl:Y,actionText:"Join Team",actionHandler:()=>{this.router.navigateByUrl(he)}})}openAddModelPaywall(w){const oe=(w?.data?.organizations??[])?.[0]?.name??"",Y=(0,re.eu)(w),he=(0,re.Iw)(w);return this.openPremiumAccessDialog(M.j.TeamAddModel,{description:`Join the **${oe}** team to add models to My Library and start collaborating with other members of your institution.`,signInUrl:Y,actionText:"Join Team",actionHandler:()=>{this.router.navigateByUrl(he)}})}openVideoUploadGate(){return this.openPremiumAccessDialog(M.j.IndividualUploadVideo)}openExternalAccountEditGate(w){const X=this.store.selectSnapshot($.q.getOrganization).name,oe=this.store.selectSnapshot(ce.k.getUserProfile).first_name;return this.openPremiumAccessDialog(M.j.ExternalAccountEdit,{description:(0,K.fw)(w,X,oe),actionHandler:()=>{const Y=document.createElement("a");Y.href=(0,K.zx)(w,X,oe),Y.target="_blank",Y.click()}})}openTrialExpired(){return this.dialog.open(se,{id:Z.t.TrialExpiredDialog,panelClass:"bg-dialog-responsive"}).afterClosed()}openPremiumAccessDialog(w,X={},oe=!0){const Y={...K.Ty[w],...X};if(this.getOpenPremiumDialogType()===M.j.BookmarkViewLimitReached)return(0,t.of)(void 0);w===M.j.BookmarkViewLimitReached&&this.clearDialogs(),this.vendorAnalyticsService.track(ue[w],{page:this.router.url,platform:this.productService.productKey});const ne=this.getPremiumDialogId(w);return this.dialog.open(k,{id:ne,backdropClass:oe?void 0:"bd-dialog-backdrop-headless",panelClass:"bg-dialog-docked",disableClose:!oe,data:Y}).afterClosed()}clearDialogs(){this.dialog.closeAll()}clearUserNotifications(...w){this.store.dispatch(new S.rH(w))}getPremiumDialogId(w){return`${Z.t.PremiumAccessDialog}_${w}`}getOpenPremiumDialogType(){return Object.values(M.j).find(w=>{const X=this.getPremiumDialogId(w),oe=this.dialog.getDialogById(X);return!(0,e.isNil)(oe)})}createViewinteractionGate(w,X,oe){return this.store.select(de.N.getSelectedChapterModelReady).pipe((0,c.p)(ne=>ne)).pipe((0,O.n)(()=>(0,s.Y)(1e3)),(0,P.T)(ne=>1e3*ne)).pipe((0,P.T)(ne=>ne>=w))}static#e=this.\u0275fac=function(X){return new(X||te)(p.KVO(f.il),p.KVO(a.bZ),p.KVO(ae.e),p.KVO(q.b),p.KVO(h.Ix))};static#t=this.\u0275prov=p.jDH({token:te,factory:te.\u0275fac,providedIn:"root"})}return te})()},16443:(le,N,n)=>{"use strict";n.d(N,{E:()=>S,l:()=>O});var e=n(28407),t=n(95419),s=n(54438);const c=["target"];var O=function(a){return a.Basic="basic",a.Full="full",a}(O||{});const P={[O.Basic]:["progressControl","playToggle","volumePanel","currentTimeDisplay","timeDivider","durationDisplay"],[O.Full]:["progressControl","playToggle","volumePanel","currentTimeDisplay","timeDivider","durationDisplay","customControlSpacer","pictureInPictureToggle","fullscreenToggle"]};let S=(()=>{class a{constructor(E){this.mediaService=E}ngOnInit(){var E=this;return(0,e.A)(function*(){E.playerId=yield E.mediaService.addVideoPlayer(E.target.nativeElement,{preload:"metadata",sources:E.sources,fluid:!0,controls:!0,responsive:!0,controlBar:{volumePanel:{inline:!1},children:P[E.mode]},breakpoints:{tiny:200}})})()}ngOnDestroy(){this.playerId&&this.mediaService.removeVideoPlayer(this.playerId)}static#e=this.\u0275fac=function(y){return new(y||a)(s.rXU(t.u))};static#t=this.\u0275cmp=s.VBU({type:a,selectors:[["app-video-view"]],viewQuery:function(y,i){if(1&y&&s.GBs(c,7),2&y){let g;s.mGM(g=s.lsd())&&(i.target=g.first)}},inputs:{sources:"sources",mode:"mode"},decls:2,vars:0,consts:[["target",""]],template:function(y,i){1&y&&s.nrm(0,"video-js",null,0)},styles:['@charset "UTF-8";.vjs-modal-dialog .vjs-modal-dialog-content,.video-js .vjs-modal-dialog,.vjs-button>.vjs-icon-placeholder:before,.video-js .vjs-big-play-button .vjs-icon-placeholder:before{position:absolute;top:0;left:0;width:100%;height:100%}.vjs-button>.vjs-icon-placeholder:before,.video-js .vjs-big-play-button .vjs-icon-placeholder:before{text-align:center}@font-face{font-family:VideoJS;src:url(data:application/font-woff;charset=utf-8;base64,d09GRgABAAAAABDkAAsAAAAAG6gAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABHU1VCAAABCAAAADsAAABUIIslek9TLzIAAAFEAAAAPgAAAFZRiV3hY21hcAAAAYQAAADaAAADPv749/pnbHlmAAACYAAAC3AAABHQZg6OcWhlYWQAAA3QAAAAKwAAADYZw251aGhlYQAADfwAAAAdAAAAJA+RCLFobXR4AAAOHAAAABMAAACM744AAGxvY2EAAA4wAAAASAAAAEhF6kqubWF4cAAADngAAAAfAAAAIAE0AIFuYW1lAAAOmAAAASUAAAIK1cf1oHBvc3QAAA/AAAABJAAAAdPExYuNeJxjYGRgYOBiMGCwY2BycfMJYeDLSSzJY5BiYGGAAJA8MpsxJzM9kYEDxgPKsYBpDiBmg4gCACY7BUgAeJxjYGS7wTiBgZWBgaWQ5RkDA8MvCM0cwxDOeI6BgYmBlZkBKwhIc01hcPjI+FGJHcRdyA4RZgQRADK3CxEAAHic7dFZbsMgAEXRS0ycyZnnOeG7y+qC8pU1dHusIOXxuoxaOlwZYWQB0Aea4quIEN4E9LzKbKjzDeM6H/mua6Lmc/p8yhg0lvdYx15ZG8uOLQOGjMp3EzqmzJizYMmKNRu27Nhz4MiJMxeu3Ljz4Ekqm7T8P52G8PP3lnTOVk++Z6iN6QZzNN1F7ptuN7eGOjDUoaGODHVsuvU8MdTO9Hd5aqgzQ50b6sJQl4a6MtS1oW4MdWuoO0PdG+rBUI+GejLUs6FeDPVqqDdDvRvqw1CfhpqM9At0iFLaAAB4nJ1YDXBTVRZ+5/22TUlJ8we0pHlJm7RJf5O8F2j6EymlSPkpxaL8U2xpa3DKj0CBhc2IW4eWKSokIoLsuMqssM64f+jA4HSdWXXXscBq67IOs3FXZ1ZYWVyRFdo899yXtIBQZ90k7717zz3v3HPPOfd854YCCj9cL9dL0RQFOqCbGJnrHb5EayiKIWN8iA/hWBblo6hUWm8TtCDwE80WMJus/irwyxOdxeB0MDb14VNJHnXYoLLSl6FfCUYO9nYPTA8Epg9090LprfbBbZ2hY0UlJUXHQp3/vtWkS6EBv8+rPMq5u9692f/dNxJNiqwC1xPE9TCUgCsSdQWgE3XQD25lkG4CN2xmTcOXWBOyser6RN6KnGbKSbmQ3+d0OI1m2W8QzLLkI2sykrWAgJJEtA8vGGW/2Q+CmT3n8zS9wZwu2DCvtuZKZN3xkrLh36yCZuUomQSqGpY8t/25VfHVhw8z4ebGBtfLb0ya9PCaDc+8dGTvk2dsh6z7WzvowlXKUSWo9MJ15a3KrEP2loOr2Ojhw6iW6hf2BDdEccQvZGpaAy7YovSwq8kr7HGllxpd71rkS6G0Sf11sl9OvMK1+jwPPODxjUwkOim9CU3ix1wNjXDfmJSEn618Bs6lpWwUpU+8PCqLMY650zjq8VhCIP17NEKTx3eaLL+s5Pi6yJWaWjTHLR1jYzPSV9VF/6Ojdb/1kO3Mk3uhHC0x6gc1BjlKQ+nQFxTYdaJkZ7ySVxLBbhR1dsboNXp1tCYKW2LRaEzpYcIx2BKNxaL0ZaUnSqfFoiNhHKR/GkX6PWUSAaJelQaqZL1EpoHNsajSEyPSoJ9IjhIxTdjHLmwZvhRDOiFTY/YeQnvrVZmiTQtGncECXtFTBZLOVwwMRgoXHAkXzMzPn1nAJJ8jYSbMDaqN2waGLzNhih/bZynUBMpIWSg7VYi7DRx2m8ALkIdRCJwI6ArJx2EI8kaDWeTQKeAFk9fjl/1AvwktjQ1P7NjyMGQyfd4vjipX6M/i52D7Cq80kqlcxEcGXRr/FEcgs0u5uGgB4VWuMFfpdn2Re6Hi3PqzmxWKsz6+ae2Pn9hXXw/fqM859UiGC0oKYYILJBqJrsn1Z1E5qOs9rQCiUQRREjm8yJcbHF5cUJufX1vAHlefw0XgUoboS3ETfQlTxBC4SOtuE8VPRJTBSCQSjZCpk7Gqzu+masaZ2y7Zjehho4F3g82BNDkAHpORG4+OCS+f6JTPmtRn/PH1kch6d04sp7AQb25aQ/pqUyXeQ8vrebG8OYQdXOQ+585u0sdW9rqalzRURiJ+9F4MweRFrKUjl1GUYhH1A27WOHw5cTFSFPMo9EeUIGnQTZHIaJ7AHLaOKsOODaNF9jkBjYG2QEsQ2xjMUAx2bBEbeTBWMHwskBjngq56S/yfgkBnWBa4K9sqKtq2t1UI8S9He5XuBRbawAdatrQEAi30Aks2+LM8WeCbalVZkWNylvJ+dqJnzVb+OHlSoKW8nPCP7Rd+CcZ2DdWAGqJ2CBFOphgywFFCFBNtfAbGtNPBCwxvygHeYMZMY9ZboBqwq/pVrsbgN5tkv152ODlbMfiqwGMBgxa4Exz3QhovRIUp6acqZmQzRq0ypDXS2TPLT02YIkQETnOE445oOGxOmXAqUJNNG7XgupMjPq2ua9asrj5yY/yuKteO1Kx0YNJTufrirLe1mZnat7OL6rnUdCWenpW6I8mAnbsY8KWs1PuSovCW9A/Z25PQ24a7cNOqgmTkLmBMgh4THgc4b9k2IVv1/g/F5nGljwPLfOgHAzJzh45V/4+WenTzmMtR5Z7us2Tys909UHqrPY7KbckoxRvRHhmVc3cJGE97uml0R1S0jdULVl7EvZtDFVBF35N9cEdjpgmAiOlFZ+Dtoh93+D3zzHr8RRNZQhnCNMNbcegOvpEwZoL+06cJQ07h+th3fZ/7PVbVC6ngTAV/KoLFuO6+2KFcU651gEb5ugPSIb1D+Xp8V4+k3sEIGnw5mYe4If4k1lFYr6SCzmM2EQ8iWtmwjnBI9kTwe1TlfAmXh7H02by9fW2gsjKwtv0aaURKil4OdV7rDL1MXIFNrhdxohcZXYTnq47WisrKitaObbf5+yvkLi5J6lCNZZ+B6GC38VNBZBDidSS/+mSvh6s+srgC8pyKMvDtt+de3c9fU76ZPfuM8ud4Kv0fyP/LqfepMT/3oZxSqpZaTa1DaQYLY8TFsHYbWYsPoRhRWfL5eSSQbhUGgGC3YLbVMk6PitTFNGpAsNrC6D1VNBKgBHMejaiuRWEWGgsSDBTJjqWIl8kJLlsaLJ2tXDr6xGfT85bM2Q06a46x2HTgvdnV8z5YDy/27J4zt6x2VtkzjoYpkq36kaBr4eQSg7tyiVweWubXZugtadl58ydapfbORfKsDTuZ0OBgx4cfdjCf5tbWNITnL120fdOi1RV1C3uKGzNdwYLcMvZ3BxoPyTOCD1XvXTp7U10gWCVmTV9b3r2z0SkGWovb2hp9I89O8a2smlyaO8muMU+dRmtzp60IzAoFpjLr1n388boLyf0dRvxhsHZ0qbWqDkwqvvpkj4l0fY6EIXRi5sQSrAvsVYwXRy4qJ2EVtD1AN7a0HWth9ymvL1xc3WTUKK/TAHA/bXDVtVWfOMfuGxGZv4Ln/jVr9jc3j1yMv0tndmyt9Vq88Y9gH1wtLX3KWjot5++jWHgAoZZkQ14wGQ20Fli71UmKJAy4xKMSTGbVdybW7FDDAut9XpD5AzWrYO7zQ8qffqF8+Ynd/clrHcdyxGy3a/3+mfNnzC/cBsveTjnTvXf1o6vzOlZw7WtqtdmPK/Errz/6NNtD72zmNOZfbmYdTGHfoofqI79Oc+R2n1lrnL6pOm0Up7kwxhTW12Amm7WYkXR2qYrF2AmgmbAsxZjwy1xpg/m1Je2vrp8v/nz2xpmlBg4E9hrMU341wVpTOh/OfmGvAnra8q6uctr60ZQHV3Q+WMQJykMj8ZsWn2QBOmmHMB+m5pDIpTFonYigiaKAhGEiAHF7EliVnQkjoLVIMPtJpBKHYd3A8GYH9jJzrWwmHx5Qjp7vDAX0suGRym1vtm/9W1/HyR8vczfMs6Sk8DSv855/5dlX9oQq52hT8syyp2rx5Id17IAyAM3wIjQPMOHzytEB64q6D5zT91yNbnx3V/nqnd017S9Y0605k3izoXLpsxde2n38yoOV9s1LcjwzNjbdX6asnBVaBj/6/DwKwPkpcqbDG7BnsXoSqWnUAmottYF6jMSdVyYZh3zVXCjwTiwwHH6sGuRiEHQGzuRX6whZkp123oy1BWE2mEfJ/tvIRtM4ZM5bDXiMsPMaAKOTyc5uL57rqyyc5y5JE5pm1i2S2iUX0CcaQ6lC6Zog7JqSqZmYlosl2K6pwNA84zRnQW6SaALYZQGW5lhCtU/W34N6o+bKfZ8cf3/Cl/+iTX3wBzpOY4mRkeNf3rptycGSshQWgGbYt5jFc2e0+DglIrwl6DVWQ7BuwaJ3Xk1J4VL5urnLl/Wf+gHU/hZoZdKNym6lG+I34FaNeZKcSpJIo2IeCVvpdsDGfKvzJnAwmeD37Ow65ZWwSowpgwX5T69s/rB55dP5BcpgDKFV8p7q2sn/1uc93bVzT/w6UrCqDTWvfCq/oCD/qZXNoUj8BL5Kp6GU017frfNXkAtiiyf/SOCEeLqnd8R/Ql9GlCRfctS6k5chvIBuQ1zCCjoCHL2DHNHIXxMJ3kQeO8lbsUXONeSfA5EjcG6/E+KdhN4bP04vBhdi883+BFBzQbxFbvZzQeY9LNBZc0FNfn5NwfDn6rCTnTw6R8o+gfpf5hCom33cRuiTlss3KHmZjD+BPN+5gXuA2ziS/Q73mLxUkpbKN/eqwz5uK0X9F3h2d1V4nGNgZGBgAOJd776+iue3+crAzc4AAje5Bfcg0xz9YHEOBiYQBQA8FQlFAHicY2BkYGBnAAGOPgaG//85+hkYGVCBMgBGGwNYAAAAeJxjYGBgYB8EmKOPgQEAQ04BfgAAAAAAAA4AaAB+AMwA4AECAUIBbAGYAcICGAJYArQC4AMwA7AD3gQwBJYE3AUkBWYFigYgBmYGtAbqB1gIEghYCG4IhAi2COh4nGNgZGBgUGYoZWBnAAEmIOYCQgaG/2A+AwAYCQG2AHicXZBNaoNAGIZfE5PQCKFQ2lUps2oXBfOzzAESyDKBQJdGR2NQR3QSSE/QE/QEPUUPUHqsvsrXjTMw83zPvPMNCuAWP3DQDAejdm1GjzwS7pMmwi75XngAD4/CQ/oX4TFe4Qt7uMMbOzjuDc0EmXCP/C7cJ38Iu+RP4QEe8CU8pP8WHmOPX2EPz87TPo202ey2OjlnQSXV/6arOjWFmvszMWtd6CqwOlKHq6ovycLaWMWVydXKFFZnmVFlZU46tP7R2nI5ncbi/dDkfDtFBA2DDXbYkhKc+V0Bqs5Zt9JM1HQGBRTm/EezTmZNKtpcAMs9Yu6AK9caF76zoLWIWcfMGOSkVduvSWechqZsz040Ib2PY3urxBJTzriT95lipz+TN1fmAAAAeJxtkMl2wjAMRfOAhABlKm2h80C3+ajgCKKDY6cegP59TYBzukAL+z1Zsq8ctaJTTKPrsUQLbXQQI0EXKXroY4AbDDHCGBNMcYsZ7nCPB8yxwCOe8IwXvOIN7/jAJ76wxHfUqWX+OzgumWAjJMV17i0Ndlr6irLKO+qftdT7i6y4uFSUvCknay+lFYZIZaQcmfH/xIFdYn98bqhra1aKTM/6lWMnyaYirx1rFUQZFBkb2zJUtoXeJCeg0WnLtHeSFc3OtrnozNwqi0TkSpBMDB1nSde5oJXW23hTS2/T0LilglXX7dmFVxLnq5U0vYATHFk3zX3BOisoQHNDFDeZnqKDy9hRNawN7Vh727hFzcJ5c8TILrKZfH7tIPxAFP0BpLeJPA==) format("woff");font-weight:400;font-style:normal}.vjs-icon-play,.video-js .vjs-play-control .vjs-icon-placeholder,.video-js .vjs-big-play-button .vjs-icon-placeholder:before{font-family:VideoJS;font-weight:400;font-style:normal}.vjs-icon-play:before,.video-js .vjs-play-control .vjs-icon-placeholder:before,.video-js .vjs-big-play-button .vjs-icon-placeholder:before{content:"\\f101"}.vjs-icon-play-circle{font-family:VideoJS;font-weight:400;font-style:normal}.vjs-icon-play-circle:before{content:"\\f102"}.vjs-icon-pause,.video-js .vjs-play-control.vjs-playing .vjs-icon-placeholder{font-family:VideoJS;font-weight:400;font-style:normal}.vjs-icon-pause:before,.video-js .vjs-play-control.vjs-playing .vjs-icon-placeholder:before{content:"\\f103"}.vjs-icon-volume-mute,.video-js .vjs-mute-control.vjs-vol-0 .vjs-icon-placeholder{font-family:VideoJS;font-weight:400;font-style:normal}.vjs-icon-volume-mute:before,.video-js .vjs-mute-control.vjs-vol-0 .vjs-icon-placeholder:before{content:"\\f104"}.vjs-icon-volume-low,.video-js .vjs-mute-control.vjs-vol-1 .vjs-icon-placeholder{font-family:VideoJS;font-weight:400;font-style:normal}.vjs-icon-volume-low:before,.video-js .vjs-mute-control.vjs-vol-1 .vjs-icon-placeholder:before{content:"\\f105"}.vjs-icon-volume-mid,.video-js .vjs-mute-control.vjs-vol-2 .vjs-icon-placeholder{font-family:VideoJS;font-weight:400;font-style:normal}.vjs-icon-volume-mid:before,.video-js .vjs-mute-control.vjs-vol-2 .vjs-icon-placeholder:before{content:"\\f106"}.vjs-icon-volume-high,.video-js .vjs-mute-control .vjs-icon-placeholder{font-family:VideoJS;font-weight:400;font-style:normal}.vjs-icon-volume-high:before,.video-js .vjs-mute-control .vjs-icon-placeholder:before{content:"\\f107"}.vjs-icon-fullscreen-enter,.video-js .vjs-fullscreen-control .vjs-icon-placeholder{font-family:VideoJS;font-weight:400;font-style:normal}.vjs-icon-fullscreen-enter:before,.video-js .vjs-fullscreen-control .vjs-icon-placeholder:before{content:"\\f108"}.vjs-icon-fullscreen-exit,.video-js.vjs-fullscreen .vjs-fullscreen-control .vjs-icon-placeholder{font-family:VideoJS;font-weight:400;font-style:normal}.vjs-icon-fullscreen-exit:before,.video-js.vjs-fullscreen .vjs-fullscreen-control .vjs-icon-placeholder:before{content:"\\f109"}.vjs-icon-square{font-family:VideoJS;font-weight:400;font-style:normal}.vjs-icon-square:before{content:"\\f10a"}.vjs-icon-spinner{font-family:VideoJS;font-weight:400;font-style:normal}.vjs-icon-spinner:before{content:"\\f10b"}.vjs-icon-subtitles,.video-js .vjs-subs-caps-button .vjs-icon-placeholder,.video-js.video-js:lang(en-GB) .vjs-subs-caps-button .vjs-icon-placeholder,.video-js.video-js:lang(en-IE) .vjs-subs-caps-button .vjs-icon-placeholder,.video-js.video-js:lang(en-AU) .vjs-subs-caps-button .vjs-icon-placeholder,.video-js.video-js:lang(en-NZ) .vjs-subs-caps-button .vjs-icon-placeholder,.video-js .vjs-subtitles-button .vjs-icon-placeholder{font-family:VideoJS;font-weight:400;font-style:normal}.vjs-icon-subtitles:before,.video-js .vjs-subs-caps-button .vjs-icon-placeholder:before,.video-js.video-js:lang(en-GB) .vjs-subs-caps-button .vjs-icon-placeholder:before,.video-js.video-js:lang(en-IE) .vjs-subs-caps-button .vjs-icon-placeholder:before,.video-js.video-js:lang(en-AU) .vjs-subs-caps-button .vjs-icon-placeholder:before,.video-js.video-js:lang(en-NZ) .vjs-subs-caps-button .vjs-icon-placeholder:before,.video-js .vjs-subtitles-button .vjs-icon-placeholder:before{content:"\\f10c"}.vjs-icon-captions,.video-js:lang(en) .vjs-subs-caps-button .vjs-icon-placeholder,.video-js:lang(fr-CA) .vjs-subs-caps-button .vjs-icon-placeholder,.video-js .vjs-captions-button .vjs-icon-placeholder{font-family:VideoJS;font-weight:400;font-style:normal}.vjs-icon-captions:before,.video-js:lang(en) .vjs-subs-caps-button .vjs-icon-placeholder:before,.video-js:lang(fr-CA) .vjs-subs-caps-button .vjs-icon-placeholder:before,.video-js .vjs-captions-button .vjs-icon-placeholder:before{content:"\\f10d"}.vjs-icon-chapters,.video-js .vjs-chapters-button .vjs-icon-placeholder{font-family:VideoJS;font-weight:400;font-style:normal}.vjs-icon-chapters:before,.video-js .vjs-chapters-button .vjs-icon-placeholder:before{content:"\\f10e"}.vjs-icon-share{font-family:VideoJS;font-weight:400;font-style:normal}.vjs-icon-share:before{content:"\\f10f"}.vjs-icon-cog{font-family:VideoJS;font-weight:400;font-style:normal}.vjs-icon-cog:before{content:"\\f110"}.vjs-icon-circle,.vjs-seek-to-live-control .vjs-icon-placeholder,.video-js .vjs-volume-level,.video-js .vjs-play-progress{font-family:VideoJS;font-weight:400;font-style:normal}.vjs-icon-circle:before,.vjs-seek-to-live-control .vjs-icon-placeholder:before,.video-js .vjs-volume-level:before,.video-js .vjs-play-progress:before{content:"\\f111"}.vjs-icon-circle-outline{font-family:VideoJS;font-weight:400;font-style:normal}.vjs-icon-circle-outline:before{content:"\\f112"}.vjs-icon-circle-inner-circle{font-family:VideoJS;font-weight:400;font-style:normal}.vjs-icon-circle-inner-circle:before{content:"\\f113"}.vjs-icon-hd{font-family:VideoJS;font-weight:400;font-style:normal}.vjs-icon-hd:before{content:"\\f114"}.vjs-icon-cancel,.video-js .vjs-control.vjs-close-button .vjs-icon-placeholder{font-family:VideoJS;font-weight:400;font-style:normal}.vjs-icon-cancel:before,.video-js .vjs-control.vjs-close-button .vjs-icon-placeholder:before{content:"\\f115"}.vjs-icon-replay,.video-js .vjs-play-control.vjs-ended .vjs-icon-placeholder{font-family:VideoJS;font-weight:400;font-style:normal}.vjs-icon-replay:before,.video-js .vjs-play-control.vjs-ended .vjs-icon-placeholder:before{content:"\\f116"}.vjs-icon-facebook{font-family:VideoJS;font-weight:400;font-style:normal}.vjs-icon-facebook:before{content:"\\f117"}.vjs-icon-gplus{font-family:VideoJS;font-weight:400;font-style:normal}.vjs-icon-gplus:before{content:"\\f118"}.vjs-icon-linkedin{font-family:VideoJS;font-weight:400;font-style:normal}.vjs-icon-linkedin:before{content:"\\f119"}.vjs-icon-twitter{font-family:VideoJS;font-weight:400;font-style:normal}.vjs-icon-twitter:before{content:"\\f11a"}.vjs-icon-tumblr{font-family:VideoJS;font-weight:400;font-style:normal}.vjs-icon-tumblr:before{content:"\\f11b"}.vjs-icon-pinterest{font-family:VideoJS;font-weight:400;font-style:normal}.vjs-icon-pinterest:before{content:"\\f11c"}.vjs-icon-audio-description,.video-js .vjs-descriptions-button .vjs-icon-placeholder{font-family:VideoJS;font-weight:400;font-style:normal}.vjs-icon-audio-description:before,.video-js .vjs-descriptions-button .vjs-icon-placeholder:before{content:"\\f11d"}.vjs-icon-audio,.video-js .vjs-audio-button .vjs-icon-placeholder{font-family:VideoJS;font-weight:400;font-style:normal}.vjs-icon-audio:before,.video-js .vjs-audio-button .vjs-icon-placeholder:before{content:"\\f11e"}.vjs-icon-next-item{font-family:VideoJS;font-weight:400;font-style:normal}.vjs-icon-next-item:before{content:"\\f11f"}.vjs-icon-previous-item{font-family:VideoJS;font-weight:400;font-style:normal}.vjs-icon-previous-item:before{content:"\\f120"}.vjs-icon-picture-in-picture-enter,.video-js .vjs-picture-in-picture-control .vjs-icon-placeholder{font-family:VideoJS;font-weight:400;font-style:normal}.vjs-icon-picture-in-picture-enter:before,.video-js .vjs-picture-in-picture-control .vjs-icon-placeholder:before{content:"\\f121"}.vjs-icon-picture-in-picture-exit,.video-js.vjs-picture-in-picture .vjs-picture-in-picture-control .vjs-icon-placeholder{font-family:VideoJS;font-weight:400;font-style:normal}.vjs-icon-picture-in-picture-exit:before,.video-js.vjs-picture-in-picture .vjs-picture-in-picture-control .vjs-icon-placeholder:before{content:"\\f122"}.video-js{display:block;vertical-align:top;box-sizing:border-box;color:#fff;background-color:#000;position:relative;padding:0;font-size:10px;line-height:1;font-weight:400;font-style:normal;font-family:Arial,Helvetica,sans-serif;word-break:initial}.video-js:-moz-full-screen{position:absolute}.video-js:-webkit-full-screen{width:100%!important;height:100%!important}.video-js[tabindex="-1"]{outline:none}.video-js *,.video-js *:before,.video-js *:after{box-sizing:inherit}.video-js ul{font-family:inherit;font-size:inherit;line-height:inherit;list-style-position:outside;margin:0}.video-js.vjs-fluid,.video-js.vjs-16-9,.video-js.vjs-4-3,.video-js.vjs-9-16,.video-js.vjs-1-1{width:100%;max-width:100%}.video-js.vjs-fluid:not(.vjs-audio-only-mode),.video-js.vjs-16-9:not(.vjs-audio-only-mode),.video-js.vjs-4-3:not(.vjs-audio-only-mode),.video-js.vjs-9-16:not(.vjs-audio-only-mode),.video-js.vjs-1-1:not(.vjs-audio-only-mode){height:0}.video-js.vjs-16-9:not(.vjs-audio-only-mode){padding-top:56.25%}.video-js.vjs-4-3:not(.vjs-audio-only-mode){padding-top:75%}.video-js.vjs-9-16:not(.vjs-audio-only-mode){padding-top:177.7777777778%}.video-js.vjs-1-1:not(.vjs-audio-only-mode){padding-top:100%}.video-js.vjs-fill:not(.vjs-audio-only-mode){width:100%;height:100%}.video-js .vjs-tech{position:absolute;top:0;left:0;width:100%;height:100%}.video-js.vjs-audio-only-mode .vjs-tech{display:none}body.vjs-full-window{padding:0;margin:0;height:100%}.vjs-full-window .video-js.vjs-fullscreen{position:fixed;overflow:hidden;z-index:1000;inset:0}.video-js.vjs-fullscreen:not(.vjs-ios-native-fs){width:100%!important;height:100%!important;padding-top:0!important}.video-js.vjs-fullscreen.vjs-user-inactive{cursor:none}.vjs-hidden{display:none!important}.vjs-disabled{opacity:.5;cursor:default}.video-js .vjs-offscreen{height:1px;left:-9999px;position:absolute;top:0;width:1px}.vjs-lock-showing{display:block!important;opacity:1!important;visibility:visible!important}.vjs-no-js{padding:20px;color:#fff;background-color:#000;font-size:18px;font-family:Arial,Helvetica,sans-serif;text-align:center;width:300px;height:150px;margin:0 auto}.vjs-no-js a,.vjs-no-js a:visited{color:#66a8cc}.video-js .vjs-big-play-button{font-size:3em;line-height:1.5em;height:1.63332em;width:3em;display:block;position:absolute;top:10px;left:10px;padding:0;cursor:pointer;opacity:1;border:.06666em solid #fff;background-color:#2b333f;background-color:#2b333fb3;border-radius:.3em;transition:all .4s}.vjs-big-play-centered .vjs-big-play-button{top:50%;left:50%;margin-top:-.81666em;margin-left:-1.5em}.video-js:hover .vjs-big-play-button,.video-js .vjs-big-play-button:focus{border-color:#fff;background-color:#73859f;background-color:#73859f80;transition:all 0s}.vjs-controls-disabled .vjs-big-play-button,.vjs-has-started .vjs-big-play-button,.vjs-using-native-controls .vjs-big-play-button,.vjs-error .vjs-big-play-button{display:none}.vjs-has-started.vjs-paused.vjs-show-big-play-button-on-pause .vjs-big-play-button{display:block}.video-js button{background:none;border:none;color:inherit;display:inline-block;font-size:inherit;line-height:inherit;text-transform:none;text-decoration:none;transition:none;appearance:none}.vjs-control .vjs-button{width:100%;height:100%}.video-js .vjs-control.vjs-close-button{cursor:pointer;height:3em;position:absolute;right:0;top:.5em;z-index:2}.video-js .vjs-modal-dialog{background:#000c;background:linear-gradient(180deg,#000c,#fff0);overflow:auto}.video-js .vjs-modal-dialog>*{box-sizing:border-box}.vjs-modal-dialog .vjs-modal-dialog-content{font-size:1.2em;line-height:1.5;padding:20px 24px;z-index:1}.vjs-menu-button{cursor:pointer}.vjs-menu-button.vjs-disabled{cursor:default}.vjs-workinghover .vjs-menu-button.vjs-disabled:hover .vjs-menu{display:none}.vjs-menu .vjs-menu-content{display:block;padding:0;margin:0;font-family:Arial,Helvetica,sans-serif;overflow:auto}.vjs-menu .vjs-menu-content>*{box-sizing:border-box}.vjs-scrubbing .vjs-control.vjs-menu-button:hover .vjs-menu{display:none}.vjs-menu li{list-style:none;margin:0;padding:.2em 0;line-height:1.4em;font-size:1.2em;text-align:center;text-transform:lowercase}.vjs-menu li.vjs-menu-item:focus,.vjs-menu li.vjs-menu-item:hover,.js-focus-visible .vjs-menu li.vjs-menu-item:hover{background-color:#73859f;background-color:#73859f80}.vjs-menu li.vjs-selected,.vjs-menu li.vjs-selected:focus,.vjs-menu li.vjs-selected:hover,.js-focus-visible .vjs-menu li.vjs-selected:hover{background-color:#fff;color:#2b333f}.video-js .vjs-menu *:not(.vjs-selected):focus:not(:focus-visible),.js-focus-visible .vjs-menu *:not(.vjs-selected):focus:not(.focus-visible){background:none}.vjs-menu li.vjs-menu-title{text-align:center;text-transform:uppercase;font-size:1em;line-height:2em;padding:0;margin:0 0 .3em;font-weight:700;cursor:default}.vjs-menu-button-popup .vjs-menu{display:none;position:absolute;bottom:0;width:10em;left:-3em;height:0em;margin-bottom:1.5em;border-top-color:#2b333fb3}.vjs-menu-button-popup .vjs-menu .vjs-menu-content{background-color:#2b333f;background-color:#2b333fb3;position:absolute;width:100%;bottom:1.5em;max-height:15em}.vjs-layout-tiny .vjs-menu-button-popup .vjs-menu .vjs-menu-content,.vjs-layout-x-small .vjs-menu-button-popup .vjs-menu .vjs-menu-content{max-height:5em}.vjs-layout-small .vjs-menu-button-popup .vjs-menu .vjs-menu-content{max-height:10em}.vjs-layout-medium .vjs-menu-button-popup .vjs-menu .vjs-menu-content{max-height:14em}.vjs-layout-large .vjs-menu-button-popup .vjs-menu .vjs-menu-content,.vjs-layout-x-large .vjs-menu-button-popup .vjs-menu .vjs-menu-content,.vjs-layout-huge .vjs-menu-button-popup .vjs-menu .vjs-menu-content{max-height:25em}.vjs-workinghover .vjs-menu-button-popup.vjs-hover .vjs-menu,.vjs-menu-button-popup .vjs-menu.vjs-lock-showing{display:block}.video-js .vjs-menu-button-inline{transition:all .4s;overflow:hidden}.video-js .vjs-menu-button-inline:before{width:2.222222222em}.video-js .vjs-menu-button-inline:hover,.video-js .vjs-menu-button-inline:focus,.video-js .vjs-menu-button-inline.vjs-slider-active,.video-js.vjs-no-flex .vjs-menu-button-inline{width:12em}.vjs-menu-button-inline .vjs-menu{opacity:0;height:100%;width:auto;position:absolute;left:4em;top:0;padding:0;margin:0;transition:all .4s}.vjs-menu-button-inline:hover .vjs-menu,.vjs-menu-button-inline:focus .vjs-menu,.vjs-menu-button-inline.vjs-slider-active .vjs-menu{display:block;opacity:1}.vjs-no-flex .vjs-menu-button-inline .vjs-menu{display:block;opacity:1;position:relative;width:auto}.vjs-no-flex .vjs-menu-button-inline:hover .vjs-menu,.vjs-no-flex .vjs-menu-button-inline:focus .vjs-menu,.vjs-no-flex .vjs-menu-button-inline.vjs-slider-active .vjs-menu{width:auto}.vjs-menu-button-inline .vjs-menu-content{width:auto;height:100%;margin:0;overflow:hidden}.video-js .vjs-control-bar{display:none;width:100%;position:absolute;bottom:0;left:0;right:0;height:3em;background-color:#2b333f;background-color:#2b333fb3}.vjs-has-started .vjs-control-bar,.vjs-audio-only-mode .vjs-control-bar{display:flex;visibility:visible;opacity:1;transition:visibility .1s,opacity .1s}.vjs-has-started.vjs-user-inactive.vjs-playing .vjs-control-bar{visibility:visible;opacity:0;pointer-events:none;transition:visibility 1s,opacity 1s}.vjs-controls-disabled .vjs-control-bar,.vjs-using-native-controls .vjs-control-bar,.vjs-error .vjs-control-bar{display:none!important}.vjs-audio.vjs-has-started.vjs-user-inactive.vjs-playing .vjs-control-bar,.vjs-audio-only-mode.vjs-has-started.vjs-user-inactive.vjs-playing .vjs-control-bar{opacity:1;visibility:visible;pointer-events:auto}.vjs-has-started.vjs-no-flex .vjs-control-bar{display:table}.video-js .vjs-control{position:relative;text-align:center;margin:0;padding:0;height:100%;width:4em;flex:none}.video-js .vjs-control.vjs-visible-text{width:auto;padding-left:1em;padding-right:1em}.vjs-button>.vjs-icon-placeholder:before{font-size:1.8em;line-height:1.67}.vjs-button>.vjs-icon-placeholder{display:block}.video-js .vjs-control:focus:before,.video-js .vjs-control:hover:before,.video-js .vjs-control:focus{text-shadow:0em 0em 1em white}.video-js *:not(.vjs-visible-text)>.vjs-control-text{border:0;clip:rect(0 0 0 0);height:1px;overflow:hidden;padding:0;position:absolute;width:1px}.vjs-no-flex .vjs-control{display:table-cell;vertical-align:middle}.video-js .vjs-custom-control-spacer{display:none}.video-js .vjs-progress-control{cursor:pointer;flex:auto;display:flex;align-items:center;min-width:4em;touch-action:none}.video-js .vjs-progress-control.disabled{cursor:default}.vjs-live .vjs-progress-control{display:none}.vjs-liveui .vjs-progress-control{display:flex;align-items:center}.vjs-no-flex .vjs-progress-control{width:auto}.video-js .vjs-progress-holder{flex:auto;transition:all .2s;height:.3em}.video-js .vjs-progress-control .vjs-progress-holder{margin:0 10px}.video-js .vjs-progress-control:hover .vjs-progress-holder{font-size:1.6666666667em}.video-js .vjs-progress-control:hover .vjs-progress-holder.disabled{font-size:1em}.video-js .vjs-progress-holder .vjs-play-progress,.video-js .vjs-progress-holder .vjs-load-progress,.video-js .vjs-progress-holder .vjs-load-progress div{position:absolute;display:block;height:100%;margin:0;padding:0;width:0}.video-js .vjs-play-progress{background-color:#fff}.video-js .vjs-play-progress:before{font-size:.9em;position:absolute;right:-.5em;top:-.3333333333em;z-index:1}.video-js .vjs-load-progress{background:#73859f80}.video-js .vjs-load-progress div{background:#73859fbf}.video-js .vjs-time-tooltip{background-color:#fff;background-color:#fffc;border-radius:.3em;color:#000;float:right;font-family:Arial,Helvetica,sans-serif;font-size:1em;padding:6px 8px 8px;pointer-events:none;position:absolute;top:-3.4em;visibility:hidden;z-index:1}.video-js .vjs-progress-holder:focus .vjs-time-tooltip{display:none}.video-js .vjs-progress-control:hover .vjs-time-tooltip,.video-js .vjs-progress-control:hover .vjs-progress-holder:focus .vjs-time-tooltip{display:block;font-size:.6em;visibility:visible}.video-js .vjs-progress-control.disabled:hover .vjs-time-tooltip{font-size:1em}.video-js .vjs-progress-control .vjs-mouse-display{display:none;position:absolute;width:1px;height:100%;background-color:#000;z-index:1}.vjs-no-flex .vjs-progress-control .vjs-mouse-display{z-index:0}.video-js .vjs-progress-control:hover .vjs-mouse-display{display:block}.video-js.vjs-user-inactive .vjs-progress-control .vjs-mouse-display{visibility:hidden;opacity:0;transition:visibility 1s,opacity 1s}.video-js.vjs-user-inactive.vjs-no-flex .vjs-progress-control .vjs-mouse-display{display:none}.vjs-mouse-display .vjs-time-tooltip{color:#fff;background-color:#000;background-color:#000c}.video-js .vjs-slider{position:relative;cursor:pointer;padding:0;margin:0 .45em;-webkit-touch-callout:none;-webkit-user-select:none;user-select:none;background-color:#73859f;background-color:#73859f80}.video-js .vjs-slider.disabled{cursor:default}.video-js .vjs-slider:focus{text-shadow:0em 0em 1em white;box-shadow:0 0 1em #fff}.video-js .vjs-mute-control{cursor:pointer;flex:none}.video-js .vjs-volume-control{cursor:pointer;margin-right:1em;display:flex}.video-js .vjs-volume-control.vjs-volume-horizontal{width:5em}.video-js .vjs-volume-panel .vjs-volume-control{visibility:visible;opacity:0;width:1px;height:1px;margin-left:-1px}.video-js .vjs-volume-panel{transition:width 1s}.video-js .vjs-volume-panel.vjs-hover .vjs-volume-control,.video-js .vjs-volume-panel:active .vjs-volume-control,.video-js .vjs-volume-panel:focus .vjs-volume-control,.video-js .vjs-volume-panel .vjs-volume-control:active,.video-js .vjs-volume-panel.vjs-hover .vjs-mute-control~.vjs-volume-control,.video-js .vjs-volume-panel .vjs-volume-control.vjs-slider-active{visibility:visible;opacity:1;position:relative;transition:visibility .1s,opacity .1s,height .1s,width .1s,left 0s,top 0s}.video-js .vjs-volume-panel.vjs-hover .vjs-volume-control.vjs-volume-horizontal,.video-js .vjs-volume-panel:active .vjs-volume-control.vjs-volume-horizontal,.video-js .vjs-volume-panel:focus .vjs-volume-control.vjs-volume-horizontal,.video-js .vjs-volume-panel .vjs-volume-control:active.vjs-volume-horizontal,.video-js .vjs-volume-panel.vjs-hover .vjs-mute-control~.vjs-volume-control.vjs-volume-horizontal,.video-js .vjs-volume-panel .vjs-volume-control.vjs-slider-active.vjs-volume-horizontal{width:5em;height:3em;margin-right:0}.video-js .vjs-volume-panel.vjs-hover .vjs-volume-control.vjs-volume-vertical,.video-js .vjs-volume-panel:active .vjs-volume-control.vjs-volume-vertical,.video-js .vjs-volume-panel:focus .vjs-volume-control.vjs-volume-vertical,.video-js .vjs-volume-panel .vjs-volume-control:active.vjs-volume-vertical,.video-js .vjs-volume-panel.vjs-hover .vjs-mute-control~.vjs-volume-control.vjs-volume-vertical,.video-js .vjs-volume-panel .vjs-volume-control.vjs-slider-active.vjs-volume-vertical{left:-3.5em;transition:left 0s}.video-js .vjs-volume-panel.vjs-volume-panel-horizontal.vjs-hover,.video-js .vjs-volume-panel.vjs-volume-panel-horizontal:active,.video-js .vjs-volume-panel.vjs-volume-panel-horizontal.vjs-slider-active{width:10em;transition:width .1s}.video-js .vjs-volume-panel.vjs-volume-panel-horizontal.vjs-mute-toggle-only{width:4em}.video-js .vjs-volume-panel .vjs-volume-control.vjs-volume-vertical{height:8em;width:3em;left:-3000em;transition:visibility 1s,opacity 1s,height 1s 1s,width 1s 1s,left 1s 1s,top 1s 1s}.video-js .vjs-volume-panel .vjs-volume-control.vjs-volume-horizontal{transition:visibility 1s,opacity 1s,height 1s 1s,width 1s,left 1s 1s,top 1s 1s}.video-js.vjs-no-flex .vjs-volume-panel .vjs-volume-control.vjs-volume-horizontal{width:5em;height:3em;visibility:visible;opacity:1;position:relative;transition:none}.video-js.vjs-no-flex .vjs-volume-control.vjs-volume-vertical,.video-js.vjs-no-flex .vjs-volume-panel .vjs-volume-control.vjs-volume-vertical{position:absolute;bottom:3em;left:.5em}.video-js .vjs-volume-panel{display:flex}.video-js .vjs-volume-bar{margin:1.35em .45em}.vjs-volume-bar.vjs-slider-horizontal{width:5em;height:.3em}.vjs-volume-bar.vjs-slider-vertical{width:.3em;height:5em;margin:1.35em auto}.video-js .vjs-volume-level{position:absolute;bottom:0;left:0;background-color:#fff}.video-js .vjs-volume-level:before{position:absolute;font-size:.9em;z-index:1}.vjs-slider-vertical .vjs-volume-level{width:.3em}.vjs-slider-vertical .vjs-volume-level:before{top:-.5em;left:-.3em;z-index:1}.vjs-slider-horizontal .vjs-volume-level{height:.3em}.vjs-slider-horizontal .vjs-volume-level:before{top:-.3em;right:-.5em}.video-js .vjs-volume-panel.vjs-volume-panel-vertical{width:4em}.vjs-volume-bar.vjs-slider-vertical .vjs-volume-level{height:100%}.vjs-volume-bar.vjs-slider-horizontal .vjs-volume-level{width:100%}.video-js .vjs-volume-vertical{width:3em;height:8em;bottom:8em;background-color:#2b333f;background-color:#2b333fb3}.video-js .vjs-volume-horizontal .vjs-menu{left:-2em}.video-js .vjs-volume-tooltip{background-color:#fff;background-color:#fffc;border-radius:.3em;color:#000;float:right;font-family:Arial,Helvetica,sans-serif;font-size:1em;padding:6px 8px 8px;pointer-events:none;position:absolute;top:-3.4em;visibility:hidden;z-index:1}.video-js .vjs-volume-control:hover .vjs-volume-tooltip,.video-js .vjs-volume-control:hover .vjs-progress-holder:focus .vjs-volume-tooltip{display:block;font-size:1em;visibility:visible}.video-js .vjs-volume-vertical:hover .vjs-volume-tooltip,.video-js .vjs-volume-vertical:hover .vjs-progress-holder:focus .vjs-volume-tooltip{left:1em;top:-12px}.video-js .vjs-volume-control.disabled:hover .vjs-volume-tooltip{font-size:1em}.video-js .vjs-volume-control .vjs-mouse-display{display:none;position:absolute;width:100%;height:1px;background-color:#000;z-index:1}.video-js .vjs-volume-horizontal .vjs-mouse-display{width:1px;height:100%}.vjs-no-flex .vjs-volume-control .vjs-mouse-display{z-index:0}.video-js .vjs-volume-control:hover .vjs-mouse-display{display:block}.video-js.vjs-user-inactive .vjs-volume-control .vjs-mouse-display{visibility:hidden;opacity:0;transition:visibility 1s,opacity 1s}.video-js.vjs-user-inactive.vjs-no-flex .vjs-volume-control .vjs-mouse-display{display:none}.vjs-mouse-display .vjs-volume-tooltip{color:#fff;background-color:#000;background-color:#000c}.vjs-poster{display:inline-block;vertical-align:middle;background-repeat:no-repeat;background-position:50% 50%;background-size:contain;background-color:#000;cursor:pointer;margin:0;padding:0;position:absolute;inset:0;height:100%}.vjs-has-started .vjs-poster,.vjs-using-native-controls .vjs-poster{display:none}.vjs-audio.vjs-has-started .vjs-poster,.vjs-has-started.vjs-audio-poster-mode .vjs-poster{display:block}.video-js .vjs-live-control{display:flex;align-items:flex-start;flex:auto;font-size:1em;line-height:3em}.vjs-no-flex .vjs-live-control{display:table-cell;width:auto;text-align:left}.video-js:not(.vjs-live) .vjs-live-control,.video-js.vjs-liveui .vjs-live-control{display:none}.video-js .vjs-seek-to-live-control{align-items:center;cursor:pointer;flex:none;display:inline-flex;height:100%;padding-left:.5em;padding-right:.5em;font-size:1em;line-height:3em;width:auto;min-width:4em}.vjs-no-flex .vjs-seek-to-live-control{display:table-cell;width:auto;text-align:left}.video-js.vjs-live:not(.vjs-liveui) .vjs-seek-to-live-control,.video-js:not(.vjs-live) .vjs-seek-to-live-control{display:none}.vjs-seek-to-live-control.vjs-control.vjs-at-live-edge{cursor:auto}.vjs-seek-to-live-control .vjs-icon-placeholder{margin-right:.5em;color:#888}.vjs-seek-to-live-control.vjs-control.vjs-at-live-edge .vjs-icon-placeholder{color:red}.video-js .vjs-time-control{flex:none;font-size:1em;line-height:3em;min-width:2em;width:auto;padding-left:1em;padding-right:1em}.vjs-live .vjs-time-control,.video-js .vjs-current-time,.vjs-no-flex .vjs-current-time,.video-js .vjs-duration,.vjs-no-flex .vjs-duration{display:none}.vjs-time-divider{display:none;line-height:3em}.vjs-live .vjs-time-divider{display:none}.video-js .vjs-play-control{cursor:pointer}.video-js .vjs-play-control .vjs-icon-placeholder{flex:none}.vjs-text-track-display{position:absolute;inset:0 0 3em;pointer-events:none}.video-js.vjs-controls-disabled .vjs-text-track-display,.video-js.vjs-user-inactive.vjs-playing .vjs-text-track-display{bottom:1em}.video-js .vjs-text-track{font-size:1.4em;text-align:center;margin-bottom:.1em}.vjs-subtitles{color:#fff}.vjs-captions{color:#fc6}.vjs-tt-cue{display:block}video::-webkit-media-text-track-display{transform:translateY(-3em)}.video-js.vjs-controls-disabled video::-webkit-media-text-track-display,.video-js.vjs-user-inactive.vjs-playing video::-webkit-media-text-track-display{transform:translateY(-1.5em)}.video-js .vjs-picture-in-picture-control{cursor:pointer;flex:none}.video-js.vjs-audio-only-mode .vjs-picture-in-picture-control{display:none}.video-js .vjs-fullscreen-control{cursor:pointer;flex:none}.video-js.vjs-audio-only-mode .vjs-fullscreen-control{display:none}.vjs-playback-rate>.vjs-menu-button,.vjs-playback-rate .vjs-playback-rate-value{position:absolute;top:0;left:0;width:100%;height:100%}.vjs-playback-rate .vjs-playback-rate-value{pointer-events:none;font-size:1.5em;line-height:2;text-align:center}.vjs-playback-rate .vjs-menu{width:4em;left:0}.vjs-error .vjs-error-display .vjs-modal-dialog-content{font-size:1.4em;text-align:center}.vjs-error .vjs-error-display:before{color:#fff;content:"X";font-family:Arial,Helvetica,sans-serif;font-size:4em;left:0;line-height:1;margin-top:-.5em;position:absolute;text-shadow:.05em .05em .1em #000;text-align:center;top:50%;vertical-align:middle;width:100%}.vjs-loading-spinner{display:none;position:absolute;top:50%;left:50%;margin:-25px 0 0 -25px;opacity:.85;text-align:left;border:6px solid rgba(43,51,63,.7);box-sizing:border-box;background-clip:padding-box;width:50px;height:50px;border-radius:25px;visibility:hidden}.vjs-seeking .vjs-loading-spinner,.vjs-waiting .vjs-loading-spinner{display:block;animation:vjs-spinner-show 0s linear .3s forwards}.vjs-loading-spinner:before,.vjs-loading-spinner:after{content:"";position:absolute;margin:-6px;box-sizing:inherit;width:inherit;height:inherit;border-radius:inherit;opacity:1;border:inherit;border-color:transparent;border-top-color:#fff}.vjs-seeking .vjs-loading-spinner:before,.vjs-seeking .vjs-loading-spinner:after,.vjs-waiting .vjs-loading-spinner:before,.vjs-waiting .vjs-loading-spinner:after{animation:vjs-spinner-spin 1.1s cubic-bezier(.6,.2,0,.8) infinite,vjs-spinner-fade 1.1s linear infinite}.vjs-seeking .vjs-loading-spinner:before,.vjs-waiting .vjs-loading-spinner:before{border-top-color:#fff}.vjs-seeking .vjs-loading-spinner:after,.vjs-waiting .vjs-loading-spinner:after{border-top-color:#fff;animation-delay:.44s}@keyframes vjs-spinner-show{to{visibility:visible}}@keyframes vjs-spinner-spin{to{transform:rotate(360deg)}}@keyframes vjs-spinner-fade{0%{border-top-color:#73859f}20%{border-top-color:#73859f}35%{border-top-color:#fff}60%{border-top-color:#73859f}to{border-top-color:#73859f}}.video-js.vjs-audio-only-mode .vjs-captions-button{display:none}.vjs-chapters-button .vjs-menu ul{width:24em}.video-js.vjs-audio-only-mode .vjs-descriptions-button{display:none}.video-js .vjs-subs-caps-button+.vjs-menu .vjs-captions-menu-item .vjs-menu-item-text .vjs-icon-placeholder{vertical-align:middle;display:inline-block;margin-bottom:-.1em}.video-js .vjs-subs-caps-button+.vjs-menu .vjs-captions-menu-item .vjs-menu-item-text .vjs-icon-placeholder:before{font-family:VideoJS;content:"\\f10d";font-size:1.5em;line-height:inherit}.video-js.vjs-audio-only-mode .vjs-subs-caps-button{display:none}.video-js .vjs-audio-button+.vjs-menu .vjs-main-desc-menu-item .vjs-menu-item-text .vjs-icon-placeholder{vertical-align:middle;display:inline-block;margin-bottom:-.1em}.video-js .vjs-audio-button+.vjs-menu .vjs-main-desc-menu-item .vjs-menu-item-text .vjs-icon-placeholder:before{font-family:VideoJS;content:" \\f11d";font-size:1.5em;line-height:inherit}.video-js.vjs-layout-small .vjs-current-time,.video-js.vjs-layout-small .vjs-time-divider,.video-js.vjs-layout-small .vjs-duration,.video-js.vjs-layout-small .vjs-remaining-time,.video-js.vjs-layout-small .vjs-playback-rate,.video-js.vjs-layout-small .vjs-volume-control,.video-js.vjs-layout-x-small .vjs-current-time,.video-js.vjs-layout-x-small .vjs-time-divider,.video-js.vjs-layout-x-small .vjs-duration,.video-js.vjs-layout-x-small .vjs-remaining-time,.video-js.vjs-layout-x-small .vjs-playback-rate,.video-js.vjs-layout-x-small .vjs-volume-control,.video-js.vjs-layout-tiny .vjs-current-time,.video-js.vjs-layout-tiny .vjs-time-divider,.video-js.vjs-layout-tiny .vjs-duration,.video-js.vjs-layout-tiny .vjs-remaining-time,.video-js.vjs-layout-tiny .vjs-playback-rate,.video-js.vjs-layout-tiny .vjs-volume-control{display:none}.video-js.vjs-layout-small .vjs-volume-panel.vjs-volume-panel-horizontal:hover,.video-js.vjs-layout-small .vjs-volume-panel.vjs-volume-panel-horizontal:active,.video-js.vjs-layout-small .vjs-volume-panel.vjs-volume-panel-horizontal.vjs-slider-active,.video-js.vjs-layout-small .vjs-volume-panel.vjs-volume-panel-horizontal.vjs-hover,.video-js.vjs-layout-x-small .vjs-volume-panel.vjs-volume-panel-horizontal:hover,.video-js.vjs-layout-x-small .vjs-volume-panel.vjs-volume-panel-horizontal:active,.video-js.vjs-layout-x-small .vjs-volume-panel.vjs-volume-panel-horizontal.vjs-slider-active,.video-js.vjs-layout-x-small .vjs-volume-panel.vjs-volume-panel-horizontal.vjs-hover,.video-js.vjs-layout-tiny .vjs-volume-panel.vjs-volume-panel-horizontal:hover,.video-js.vjs-layout-tiny .vjs-volume-panel.vjs-volume-panel-horizontal:active,.video-js.vjs-layout-tiny .vjs-volume-panel.vjs-volume-panel-horizontal.vjs-slider-active,.video-js.vjs-layout-tiny .vjs-volume-panel.vjs-volume-panel-horizontal.vjs-hover{width:auto;width:initial}.video-js.vjs-layout-x-small .vjs-progress-control,.video-js.vjs-layout-tiny .vjs-progress-control{display:none}.video-js.vjs-layout-x-small .vjs-custom-control-spacer{flex:auto;display:block}.video-js.vjs-layout-x-small.vjs-no-flex .vjs-custom-control-spacer{width:auto}.vjs-modal-dialog.vjs-text-track-settings{background-color:#2b333f;background-color:#2b333fbf;color:#fff;height:70%}.vjs-text-track-settings .vjs-modal-dialog-content{display:table}.vjs-text-track-settings .vjs-track-settings-colors,.vjs-text-track-settings .vjs-track-settings-font,.vjs-text-track-settings .vjs-track-settings-controls{display:table-cell}.vjs-text-track-settings .vjs-track-settings-controls{text-align:right;vertical-align:bottom}@supports (display: grid){.vjs-text-track-settings .vjs-modal-dialog-content{display:grid;grid-template-columns:1fr 1fr;grid-template-rows:1fr;padding:20px 24px 0}.vjs-track-settings-controls .vjs-default-button{margin-bottom:20px}.vjs-text-track-settings .vjs-track-settings-controls{grid-column:1/-1}.vjs-layout-small .vjs-text-track-settings .vjs-modal-dialog-content,.vjs-layout-x-small .vjs-text-track-settings .vjs-modal-dialog-content,.vjs-layout-tiny .vjs-text-track-settings .vjs-modal-dialog-content{grid-template-columns:1fr}}.vjs-track-setting>select{margin-right:1em;margin-bottom:.5em}.vjs-text-track-settings fieldset{margin:5px;padding:3px;border:none}.vjs-text-track-settings fieldset span{display:inline-block}.vjs-text-track-settings fieldset span>select{max-width:7.3em}.vjs-text-track-settings legend{color:#fff;margin:0 0 5px}.vjs-text-track-settings .vjs-label{position:absolute;clip:rect(1px 1px 1px 1px);clip:rect(1px,1px,1px,1px);display:block;margin:0 0 5px;padding:0;border:0;height:1px;width:1px;overflow:hidden}.vjs-track-settings-controls button:focus,.vjs-track-settings-controls button:active{outline-style:solid;outline-width:medium;background-image:linear-gradient(0deg,#fff 88%,#73859f)}.vjs-track-settings-controls button:hover{color:#2b333fbf}.vjs-track-settings-controls button{background-color:#fff;background-image:linear-gradient(-180deg,#fff 88%,#73859f);color:#2b333f;cursor:pointer;border-radius:2px}.vjs-track-settings-controls .vjs-default-button{margin-right:1em}@media print{.video-js>*:not(.vjs-tech):not(.vjs-poster){visibility:hidden}}.vjs-resize-manager{position:absolute;top:0;left:0;width:100%;height:100%;border:none;z-index:-1000}.js-focus-visible .video-js *:focus:not(.focus-visible){outline:none}.video-js *:focus:not(:focus-visible){outline:none}.video-js.vjs-fluid{width:1280px}.video-js .vjs-time-control{padding:0 4px!important;min-width:auto!important;height:30px!important;font-size:12px;align-items:center}.video-js .vjs-volume-control,.video-js .vjs-time-control{display:flex!important}.video-js :not(.vjs-has-started) .vjs-big-play-button{display:flex}.video-js .vjs-icon-placeholder:before{font-family:"Font Awesome 6 Pro"}.video-js .vjs-picture-in-picture-control .vjs-icon-placeholder:before{font-family:VideoJS}.video-js .vjs-big-play-button{align-items:center;justify-content:center;border:none!important;border-radius:50%!important;background-color:#101823cc!important;top:50%;left:50%;height:60px!important;width:60px!important;margin-left:-30px;margin-top:-30px;font-size:24px;transition:none!important}.video-js .vjs-big-play-button .vjs-icon-placeholder{margin-right:-8%}.video-js .vjs-big-play-button .vjs-icon-placeholder:before{position:static;content:"\\f04b";font-family:"Font Awesome 6 Pro";font-weight:900}.video-js .vjs-play-control .vjs-icon-placeholder:before{content:"\\f04b"}.video-js .vjs-play-control.vjs-playing .vjs-icon-placeholder:before{content:"\\f04c"}.video-js .vjs-play-control.vjs-ended .vjs-icon-placeholder:before{content:"\\f2ea"}.video-js .vjs-mute-control .vjs-icon-placeholder:before{content:"\\f6a8"}.video-js .vjs-mute-control.vjs-vol-0 .vjs-icon-placeholder:before{content:"\\f2e2"}.video-js .vjs-fullscreen-control .vjs-icon-placeholder:before{content:"\\f065"}.video-js.vjs-fullscreen .vjs-fullscreen-control .vjs-icon-placeholder:before{content:"\\f066"}.video-js .vjs-control-bar{flex-wrap:wrap;height:5em}.video-js .vjs-control{height:3em}.video-js .vjs-progress-control{width:100%!important;height:2em!important}.video-js .vjs-custom-control-spacer{display:block;flex:auto}.video-js .vjs-button:not(.vjs-picture-in-picture-control)>.vjs-icon-placeholder:before{font-size:1.5em;line-height:2em}.video-js.vjs-layout-tiny .vjs-control-bar{height:4.5em}.video-js.vjs-layout-tiny .vjs-control{height:2.5em;width:2.5em}.video-js.vjs-layout-tiny .vjs-button:not(.vjs-picture-in-picture-control)>.vjs-icon-placeholder:before{font-size:1.2em;line-height:2.2em}.video-js.vjs-layout-tiny .vjs-button>.vjs-icon-placeholder:before{font-size:1.6em}.video-js.vjs-layout-tiny .vjs-progress-control{display:flex!important}.video-js.vjs-layout-tiny .vjs-progress-control .vjs-progress-holder{margin:0 8px}.video-js.vjs-layout-tiny .vjs-time-control{display:none!important}.video-js.vjs-layout-tiny .vjs-volume-bar.vjs-slider-vertical{height:4em!important}.video-js.vjs-layout-tiny .vjs-volume-panel .vjs-volume-control.vjs-volume-vertical{height:6em!important;bottom:6em!important;width:2.5em!important}.video-js.vjs-layout-tiny .vjs-volume-panel.vjs-hover .vjs-volume-control.vjs-volume-vertical{left:-2.5em!important}.video-js.vjs-layout-tiny .vjs-big-play-button{height:48px!important;width:48px!important;margin-left:-24px;margin-top:-24px;font-size:18px}.video-js.vjs-layout-x-small .vjs-progress-control{display:flex!important}.video-js.vjs-layout-x-small .vjs-control{width:3em}.video-js.vjs-layout-x-small .vjs-volume-panel.vjs-hover .vjs-volume-control.vjs-volume-vertical{left:-3em!important}.vjs-error .vjs-error-display:before{content:"";display:none}\n'],encapsulation:2,changeDetection:0})}return a})()},64218:(le,N,n)=>{"use strict";n.d(N,{H:()=>s});var e=n(60177),t=n(54438);let s=(()=>{class c{static#e=this.\u0275fac=function(S){return new(S||c)};static#t=this.\u0275mod=t.$C({type:c});static#n=this.\u0275inj=t.G2t({imports:[e.MD]})}return c})()},79435:(le,N,n)=>{"use strict";n.d(N,{T:()=>E});var e=n(15877),t=n(45326),s=n(36110),c=n(28577),O=n(39705),P=n(24418),S=n(79083),a=n(54438),f=n(21626);let E=(()=>{class y{constructor(g){this.http=g,this.nodeInfoCache=new Map}queryNodeInfo(g,p,h="en",o=!0){if(P.c.offline)return(0,e.of)(void 0);const d=`/search/descriptions?name=${g}&plan=${p===S.H.Wikipedia?"wiki":p}&ol=${h}`,r=d;if(o&&this.nodeInfoCache.has(r)){const _=this.nodeInfoCache.get(r);return(0,e.of)(_)}return this.http.get(d).pipe((0,s.T)(_=>({label:g,latinLabel:_.latin_term,description:_.description,source:_.source,sourceLink:_.url})),(0,c.W)(_=>404===_.status?(0,e.of)(void 0):(0,t.$)(_)),(0,O.M)(_=>this.nodeInfoCache.set(r,_)))}static#e=this.\u0275fac=function(p){return new(p||y)(a.KVO(f.Qq))};static#t=this.\u0275prov=a.jDH({token:y,factory:y.\u0275fac,providedIn:"root"})}return y})()},4475:(le,N,n)=>{"use strict";n.d(N,{K:()=>c});var e=n(5690),t=n(54438),s=n(21626);let c=(()=>{class O{constructor(S,a){this.http=S,this.productService=a}trackContentPublish(S,a){return this.http.post("/ws/user/analytics/content/inapp/publish",{version:4,app_producttype:this.productService.productType,app_productkey:this.productService.productKey,content_type:a,content_id:S})}trackContentView(S,a){return this.http.post("/ws/user/analytics/content/inapp/view",{version:4,app_producttype:this.productService.productType,app_productkey:this.productService.productKey,content_type:a,content_id:S})}checkContentView(){return this.http.get("/ws/user/content/inapp/view/check")}static#e=this.\u0275fac=function(a){return new(a||O)(t.KVO(s.Qq),t.KVO(e.b))};static#t=this.\u0275prov=t.jDH({token:O,factory:O.\u0275fac,providedIn:"root"})}return O})()},37737:(le,N,n)=>{"use strict";n.d(N,{B:()=>s});var e=n(90908),t=n(54438);let s=(()=>{class c{constructor(P){this.el=P}ngAfterContentInit(){(0,e.ZO)()&&setTimeout(()=>{this.el.nativeElement.focus()},0)}static#e=this.\u0275fac=function(S){return new(S||c)(t.rXU(t.aKT))};static#t=this.\u0275dir=t.FsC({type:c,selectors:[["input","appAutoFocus",""]]})}return c})()},89511:(le,N,n)=>{"use strict";n.d(N,{h:()=>s});var e=n(60177),t=n(54438);let s=(()=>{class c{static#e=this.\u0275fac=function(S){return new(S||c)};static#t=this.\u0275mod=t.$C({type:c});static#n=this.\u0275inj=t.G2t({imports:[e.MD]})}return c})()},25780:(le,N,n)=>{"use strict";n.d(N,{L:()=>t});var e=n(54438);let t=(()=>{class s{onClick(O){return O.stopPropagation(),O.stopImmediatePropagation(),O.target instanceof HTMLInputElement&&"checkbox"===O.target.type}onEnter(O){return O.stopPropagation(),O.stopImmediatePropagation(),!1}onPointerdown(O){O.stopPropagation(),O.stopImmediatePropagation()}onMouseDown(O){O.stopPropagation(),O.stopImmediatePropagation()}onMousUp(O){return O.stopPropagation(),O.stopImmediatePropagation(),!1}static#e=this.\u0275fac=function(P){return new(P||s)};static#t=this.\u0275dir=e.FsC({type:s,selectors:[["","appEventFence",""]],hostBindings:function(P,S){1&P&&e.bIt("click",function(f){return S.onClick(f,f.target)})("keydown.enter",function(f){return S.onEnter(f,f.target)})("keyup.enter",function(f){return S.onEnter(f,f.target)})("pointerdown",function(f){return S.onPointerdown(f,f.target)})("mousedown",function(f){return S.onMouseDown(f,f.target)})("mouseup",function(f){return S.onMousUp(f,f.target)})}})}return s})()},59369:(le,N,n)=>{"use strict";n.d(N,{Y:()=>O});var e=n(24418),t=n(90699),s=n(54438),c=n(38645);let O=(()=>{class P{constructor(a,f,E){this.templateRef=a,this.viewContainer=f,this.router=E,this._appFlagApplicationMode="include"}get appFlagApplication(){return this._appFlagApplication}set appFlagApplication(a){this._appFlagApplication=a}get appFlagApplicationMode(){return this._appFlagApplicationMode}set appFlagApplicationMode(a){this._appFlagApplicationMode=a}get appFlagApplicationPage(){return this._appFlagApplicationPage}set appFlagApplicationPage(a){this._appFlagApplicationPage=a}get appFlagApplicationPlatform(){return this._appFlagApplicationPlatform}set appFlagApplicationPlatform(a){this._appFlagApplicationPlatform=a}get appFlagApplicationNative(){return this._appFlagApplicationNative}set appFlagApplicationNative(a){this._appFlagApplicationNative=a}ngOnInit(){this.update()}update(){let a=!1,f=!1,E=!1,y=!1,i=!1;if(""===this.appFlagApplication?f=!0:Array.isArray(this.appFlagApplication)?f=this.appFlagApplication.some(p=>p===e.c.application):"string"==typeof this.appFlagApplication&&(f=this.appFlagApplication===e.c.application),null==this.appFlagApplicationPage)E=!0;else{const p=this.router.url;Array.isArray(this.appFlagApplicationPage)?E=this.appFlagApplicationPage.some(h=>p.indexOf(h)>=0):"string"==typeof this.appFlagApplicationPage&&(E=p.indexOf(this.appFlagApplicationPage)>=0)}if(null==this.appFlagApplicationPlatform)y=!0;else{const p=e.c.platform;Array.isArray(this.appFlagApplicationPlatform)?y=this.appFlagApplicationPlatform.some(h=>p.indexOf(h)>=0):"string"==typeof this.appFlagApplicationPlatform&&(y=p.indexOf(this.appFlagApplicationPlatform)>=0)}null==this.appFlagApplicationNative?i=!0:(i=e.c.native,(Array.isArray(this.appFlagApplicationNative)?this.appFlagApplicationNative:[this.appFlagApplicationNative]).includes(t.I.iOS)&&(i=e.c.native&&void 0!==window.webkit)),a=f&&E&&y&&i,a&&"include"===this.appFlagApplicationMode||!a&&"exclude"===this.appFlagApplicationMode?this.viewContainer.createEmbeddedView(this.templateRef):this.viewContainer.clear()}static#e=this.\u0275fac=function(f){return new(f||P)(s.rXU(s.C4Q),s.rXU(s.c1b),s.rXU(c.Ix))};static#t=this.\u0275dir=s.FsC({type:P,selectors:[["","appFlagApplication",""]],inputs:{appFlagApplication:"appFlagApplication",appFlagApplicationMode:"appFlagApplicationMode",appFlagApplicationPage:"appFlagApplicationPage",appFlagApplicationPlatform:"appFlagApplicationPlatform",appFlagApplicationNative:"appFlagApplicationNative"}})}return P})()},49989:(le,N,n)=>{"use strict";n.d(N,{e:()=>s});var e=n(54438),t=n(11040);let s=(()=>{class c{constructor(P,S){this.localeId=P,this.el=S}ngOnInit(){"rtl"===(0,t.NS)(this.localeId).direction&&(this.el.nativeElement.style.scale="-1 1")}static#e=this.\u0275fac=function(S){return new(S||c)(e.rXU(e.xe9),e.rXU(e.aKT))};static#t=this.\u0275dir=e.FsC({type:c,selectors:[["","appLogicalDir",""]]})}return c})()},12637:(le,N,n)=>{"use strict";n.d(N,{s:()=>c});var e=n(93132),t=n(54438),s=n(92014);let c=(()=>{class O{onEnter(){this.store.dispatch(new e.B.SetPreventFadeoutEvent("mouseenter",!0))}onLeave(){this.store.dispatch(new e.B.SetPreventFadeoutEvent("mouseenter",!1))}onFocusin(){this.store.dispatch(new e.B.SetPreventFadeoutEvent("focusin",!0))}onFocusout(){this.store.dispatch(new e.B.SetPreventFadeoutEvent("focusin",!1))}constructor(S){this.store=S}static#e=this.\u0275fac=function(a){return new(a||O)(t.rXU(s.il))};static#t=this.\u0275dir=t.FsC({type:O,selectors:[["","appPreventFadeout",""]],hostBindings:function(a,f){1&a&&t.bIt("mouseenter",function(){return f.onEnter()})("mouseleave",function(){return f.onLeave()})("focusin",function(){return f.onFocusin()})("focusout",function(){return f.onFocusout()})}})}return O})()},58686:(le,N,n)=>{"use strict";n.d(N,{R:()=>s});var e=n(66571),t=n(54438);let s=(()=>{class c{constructor(P){this.dialogService=P}onClick(P){this.dialogService.openContactDialog()}static#e=this.\u0275fac=function(S){return new(S||c)(t.rXU(e.o))};static#t=this.\u0275dir=t.FsC({type:c,selectors:[["","appSupportLink",""]],hostBindings:function(S,a){1&S&&t.bIt("click",function(E){return a.onClick(E)})("keydown.enter",function(E){return a.onClick(E)})}})}return c})()},53236:(le,N,n)=>{"use strict";n.d(N,{K$:()=>S,Of:()=>P,tG:()=>O,u1:()=>a});var e=n(27153),t=n(30234);const s=e.fQ[t.a.WoltersKluwer],c={};var O=function(i){return i.ActiveSession="SIH01.00002",i}(O||{});function P(i,g){switch(i){case"1003":return`Unsupported video length. Please upload a video ${g?.limit} secs or less.`;case"OPPH01.00126":case"SUH01.00040":return"This invite code is invalid or has expired. Please reach out to your administrator for a new code.";case"OPPH01.00122":case"SUH01.00122":case"SIH01.00122":case"FSH01.00122":case"GSH01.00122":return`We were unable to find an account associated with your institution. \n      Please contact your administrator [here](${s}) and provide this error ID: ${i}.`;case"OPPH01.00123":case"SUH01.00123":case"SIH01.00123":case"FSH01.00123":case"GSH01.00123":return`There are multiple team accounts associated with your institution. \n      Please contact your administrator [here](${s}) and provide this error ID: ${i}.`;case"OPPH01.00124":case"OPPH01.00125":case"OPPH01.00110":case"OPPH01.00111":case"OPPH01.00112":case"SUH01.00124":case"SUH01.00110":case"SUH01.00111":case"SUH01.00112":case"SIH01.00124":case"SIH01.00110":case"SIH01.00111":case"SIH01.00112":case"FSH01.00124":case"FSH01.00125":case"FSH01.00110":case"FSH01.00111":case"FSH01.00112":case"GSH01.00124":case"GSH01.00110":case"GSH01.00111":case"GSH01.00112":return`There was an issue with retrieving information from your institution. \n      Please try again or contact your administrator [here](${s}) and provide this error ID: ${i}.`;case"OSIH01.00111":case"OSIH01.00112":return"We were unable to load this page due to an invalid Ovid token";default:return c[i]||""}}function S(i){return i instanceof Error?"":y(i,"error_id")||""}function a(i,g){if("string"==typeof i)return i;const p=function E(i){return function f(i){const p=i?.error?.error;return"string"==typeof p?.error_id||"string"==typeof p?.message}(i)?i.error.error:void 0}(i),h=p?.error_id||S(i),o=p?.message||y(i,"message")||"";return P(h,g)||(o?o.replace(/^\[(.+)\]$/,"$1").replace(/^\'(.+)\'$/,"$1"):"")}function y(i,g,p=3){let h=i,o=0;for(;o<p&&h&&!h[g];)h=h.error,o++;return h&&h[g]}},85884:(le,N,n)=>{"use strict";n.d(N,{Y:()=>e});var e=function(t){return t.Content="content",t.Engine="engine",t}(e||{})},66432:(le,N,n)=>{"use strict";n.d(N,{QU:()=>P,ZV:()=>y,v1:()=>E,p7:()=>f,e7:()=>a,z:()=>S});var e=n(49204),t=n(30234),s=n(74394);const c=[{title:"zSpace Models",id:t.a.Zspace,type:"Category",icon:"zspace"}],O={main:[{title:"All Models",id:"all",type:"Category",icon:"all-models",tabTags:s.Ht,translations:{es:{title:"Todas las Categor\xedas"},zh:{title:"\u6240\u6709\u7c7b\u522b"},fr:{title:"Toutes les cat\xe9gories"},de:{title:"Alle Kategorien"},it:{title:"Tutte le categorie"},ja:{title:"\u3059\u3079\u3066\u306e\u30ab\u30c6\u30b4\u30ea"},pt:{title:"Todas as categorias"}}}],categories:[{title:"Anatomy by Region",id:"regional",type:"Category",icon:"anatomy-by-regions",tabTags:s.iE,translations:{es:{title:"Anatom\xeda regional"},zh:{title:"\u5c40\u90e8\u89e3\u5256"},fr:{title:"Anatomie r\xe9gionale"},de:{title:"Regionale Anatomie"},it:{title:"Anatomia regionale"},ja:{title:"\u5404\u90e8\u4f4d\u306e\u69cb\u9020"},pt:{title:"Anatomia Regional"}}},{title:"Anatomy by System",id:"system",type:"Category",icon:"anatomy-by-systems",tabTags:s.L7,translations:{es:{title:"Anatom\xeda sistem\xe1tica"},zh:{title:"\u7cfb\u7edf\u89e3\u5256"},fr:{title:"Anatomie du syst\xe8me"},de:{title:"Systematische Anatomie"},it:{title:"Anatomia sistemica"},ja:{title:"\u5404\u5668\u5b98\u7cfb\u306e\u69cb\u9020"},pt:{title:"Anatomia do Sistema"}}},{title:"Complete Anatomy",id:"complete anatomy",type:"Category",icon:"complete-anatomy",translations:{de:{title:"Vollst\xe4ndige Anatomie"},es:{title:"Anatom\xeda completa"},fr:{title:"Anatomie compl\xe8te"},it:{title:"Anatomia completa"},ja:{title:"\u4eba\u4f53\u306e\u5168\u4f53\u69cb\u9020"},pt:{title:"Anatomia Completa"},zh:{title:"\u5b8c\u6574\u89e3\u5256"}}},{title:"Bony Landmarks, Origins, and Insertions",id:"Bony Landmarks, Origins, and Insertions",type:"Category",icon:"bony-landmarks",tabTags:s.L7,translations:{de:{title:"Kn\xf6cherne Orientierungspunkte, Urspr\xfcnge und Ans\xe4tze"},es:{title:"Puntos de referencia \xf3seos, or\xedgenes e inserciones"},fr:{title:"Rep\xe8res osseux, origines et insertions"},it:{title:"Punti di repere ossei, origini e inserzioni"},ja:{title:"\u9aa8\u306e\u30e9\u30f3\u30c9\u30de\u30fc\u30af, \u8d77\u59cb\u30fb\u505c\u6b62"},pt:{title:"Marcos \xd3sseos, Origens e Inser\xe7\xf5es"},zh:{title:"\u9aa8\u6027\u6807\u5fd7\u3001\u8d77\u6e90\u4e0e\u63d2\u5165"}}},{title:"Cross Sections and Microanatomy",id:"Cross Sections and Microanatomy",type:"Category",icon:"cross-sections-and-micro-anatomy",translations:{de:{title:"Querschnitte und mikroskopische Anatomie"},es:{title:"Cortes transversales y microanatom\xeda"},fr:{title:"Coupes transversales et micro anatomie"},it:{title:"Sezioni trasversali e anatomia microscopica"},ja:{title:"\u65ad\u9762\u56f3\u30fb\u30de\u30a4\u30af\u30ed\u89e3\u5256\u5b66"},pt:{title:"Sec\xe7\xf5es Transversais e Microanatomia"},zh:{title:"\u6a2a\u65ad\u9762&\u663e\u5fae\u89e3\u5256"}}},{title:"Anatomy Quizzes",id:"quiz",type:"Category",icon:"quizzes-and-assessments",tabTags:s.iE,translations:{de:{title:"Anatomie Quizfragen"},es:{title:"Pruebas de anatom\xeda"},fr:{title:"Quizz d'anatomie"},it:{title:"Domande di anatomia"},ja:{title:"\u89e3\u5256\u5b66\u30af\u30a4\u30ba"},pt:{title:"Question\xe1rios de Anatomia"},zh:{title:"\u89e3\u5256\u5b66\u6d4b\u9a8c"}}}],specialties:[{title:"Allergy and Immunology",id:"Allergy and Immunology",type:"Category",icon:"allergy-and-immunology",tabTags:s.Ht,translations:{de:{title:"Allergie und Immunologie"},es:{title:"Alergia e inmunolog\xeda"},fr:{title:"Allergie et immunologie"},it:{title:"Allergologia e immunologia"},ja:{title:"\u30a2\u30ec\u30eb\u30ae\u30fc\u3068\u514d\u75ab\u5b66"},pt:{title:"Alergia e Imunologia"},zh:{title:"\u8fc7\u654f\u4e0e\u514d\u75ab\u5b66"}}},{title:"Cardiology",id:"Cardiology",type:"Category",icon:"cardiology",tabTags:s.Ht,translations:{de:{title:"Kardiologie"},es:{title:"Cardiolog\xeda"},fr:{title:"Cardiologie"},it:{title:"Cardiologia"},ja:{title:"\u5fc3\u81d3\u75c5\u5b66"},pt:{title:"Cardiologia"},zh:{title:"\u5fc3\u810f\u79d1"}}},{title:"Dentistry",id:"Dentistry",type:"Category",icon:"dentistry",tabTags:s.Ht,translations:{de:{title:"Zahnmedizin"},es:{title:"Odontolog\xeda"},fr:{title:"Dentisterie"},it:{title:"Odontoiatria"},ja:{title:"\u6b6f\u5b66"},pt:{title:"Odontologia"},zh:{title:"\u7259\u79d1"}}},{title:"Dermatology",id:"Dermatology",type:"Category",icon:"dermatology",tabTags:s.Ht,translations:{de:{title:"Dermatologie"},es:{title:"Dermatolog\xeda"},fr:{title:"Dermatologie"},it:{title:"Dermatologia"},ja:{title:"\u76ae\u819a\u5b66"},pt:{title:"Dermatologia"},zh:{title:"\u76ae\u80a4\u79d1"}}},{title:"Ear, Nose, and Throat",id:"Ear, Nose, and Throat",type:"Category",icon:"otolarygngology",tabTags:s.Ht,translations:{de:{title:"Otolaryngologie"},es:{title:"Otorrinolaringolog\xeda"},fr:{title:"Otorhinolaryngologie"},it:{title:"Otorinolaringoiatria"},ja:{title:"\u8033\u9f3b\u79d1\u5b66"},pt:{title:"Otorrinolaringologia"},zh:{title:"\u8033\u9f3b\u5589\u79d1"}}},{title:"Endocrinology",id:"Endocrinology",type:"Category",icon:"endocrinology",tabTags:s.Ht,translations:{de:{title:"Endokrinologie"},es:{title:"Endocrinolog\xeda"},fr:{title:"Endocrinologie"},it:{title:"Endocrinologia"},ja:{title:"\u5185\u5206\u6ccc\u5b66"},pt:{title:"Endocrinologia"},zh:{title:"\u5185\u5206\u6ccc\u79d1"}}},{title:"Gastroenterology",id:"Gastroenterology and Hepatology",type:"Category",icon:"gastroenterology",tabTags:s.Ht,translations:{de:{title:"Gastroenterologie"},es:{title:"Gastroenterolog\xeda"},fr:{title:"Gastroent\xe9rologie"},it:{title:"Gastroenterologia"},ja:{title:"\u80c3\u8178\u5b66"},pt:{title:"Gastroenterologia"},zh:{title:"\u80c3\u80a0\u75c5\u5b66"}}},{title:"Gynecology",id:"Gynecology",type:"Category",icon:"gynecology",tabTags:s.Ht,translations:{de:{title:"Gyn\xe4kologie"},es:{title:"Ginecolog\xeda"},fr:{title:"Gyn\xe9cologie"},it:{title:"Ginecologia"},ja:{title:"\u5a66\u4eba\u79d1\u5b66"},pt:{title:"Ginecologia"},zh:{title:"\u5987\u79d1"}}},{title:"Hematology",id:"Hematology",type:"Category",icon:"hematology",tabTags:s.Ht,translations:{de:{title:"H\xe4matologie"},es:{title:"Hematolog\xeda"},fr:{title:"H\xe9matologie"},it:{title:"Ematologia"},ja:{title:"\u8840\u6db2\u5b66"},pt:{title:"Hematologia"},zh:{title:"\u8840\u6db2\u79d1"}}},{title:"Infectious Disease",id:"Infectious Disease",type:"Category",icon:"infectious-disease",tabTags:s.Ht,translations:{de:{title:"Infektionskrankheit"},es:{title:"Enfermedades infecciosas"},fr:{title:"Maladies infectieuses"},it:{title:"Malattie infettive"},ja:{title:"\u611f\u67d3\u75c7"},pt:{title:"Doen\xe7a Infecciosa"},zh:{title:"\u4f20\u67d3\u75c5"}}},{title:"Neurology and Psychiatry",id:"Neurology and Psychiatry",type:"Category",icon:"neurology-and-psychiatry",tabTags:s.Ht,translations:{de:{title:"Neurologie und Psychiatrie"},es:{title:"Neurolog\xeda y psiquiatr\xeda"},fr:{title:"Neurologie et psychiatrie"},it:{title:"Neurologia e psichiatria"},ja:{title:"\u795e\u7d4c\u5b66\u30fb\u7cbe\u795e\u533b\u5b66"},pt:{title:"Neurologia e Psiquiatria"},zh:{title:"\u795e\u7ecf\u79d1&\u7cbe\u795e\u79d1"}}},{title:"Obstetrics",id:"Obstetrics",type:"Category",icon:"obstetrics",tabTags:s.NB,translations:{de:{title:"Geburtshilfe"},es:{title:"Obstetricia "},fr:{title:"Obst\xe9trique"},it:{title:"Ostetricia"},ja:{title:"\u7523\u79d1\u5b66"},pt:{title:"Obstetr\xedcia"},zh:{title:"\u4ea7\u79d1"}}},{title:"Oncology",id:"Oncology",type:"Category",icon:"oncology",tabTags:s.Ht,translations:{de:{title:"Onkologie"},es:{title:"Oncolog\xeda"},fr:{title:"Oncologie"},it:{title:"Oncologia"},ja:{title:"\u816b\u760d\u5b66"},pt:{title:"Oncologia"},zh:{title:"\u80bf\u7624\u79d1"}}},{title:"Ophthalmology",id:"Ophthalmology",type:"Category",icon:"ophtalmology",tabTags:s.Ht,translations:{de:{title:"Ophthalmologie"},es:{title:"Oftalmolog\xeda"},fr:{title:"Ophtalmologie"},it:{title:"Oftalmologia"},ja:{title:"\u773c\u79d1\u5b66"},pt:{title:"Oftalmologia"},zh:{title:"\u773c\u79d1"}}},{title:"Orthopedics and Rheumatology",id:"Orthopedics and Rheumatology",type:"Category",icon:"orthopedics",tabTags:s.Ht,translations:{de:{title:"Orthop\xe4die"},es:{title:"Ortopedia"},fr:{title:"Orthop\xe9die"},it:{title:"Ortopedia"},ja:{title:"\u6574\u5f62\u5916\u79d1\u5b66"},pt:{title:"Ortopedia"},zh:{title:"\u9aa8\u79d1"}}},{title:"Pediatrics",id:"Pediatrics",type:"Category",icon:"pediatrics",tabTags:s.Ht,translations:{de:{title:"P\xe4diatrie"},es:{title:"Pediatr\xeda"},fr:{title:"P\xe9diatrie"},it:{title:"Pediatria"},ja:{title:"\u5c0f\u5150\u79d1\u5b66"},pt:{title:"Pediatria"},zh:{title:"\u513f\u79d1"}}},{title:"Physical Therapy",id:"Physical Therapy",type:"Category",icon:"physical-therapy",tabTags:s.Ht,translations:{de:{title:"Physiotherapie"},es:{title:"Fisioterapia"},fr:{title:"Kin\xe9sith\xe9rapie"},it:{title:"Fisioterapia"},ja:{title:"\u7406\u5b66\u7642\u6cd5"},pt:{title:"Fisioterapia"},zh:{title:"\u7269\u7406\u6cbb\u7597"}}},{title:"Primary Care",id:"Primary Care",type:"Category",icon:"primary-care",tabTags:s.Ht,translations:{de:{title:"Prim\xe4rversorgung"},es:{title:"Atenci\xf3n primaria"},fr:{title:"Soins de sant\xe9 primaires"},it:{title:"Assistenza sanitaria di base"},ja:{title:"\u30d7\u30e9\u30a4\u30de\u30ea\u30fc\u30b1\u30a2"},pt:{title:"Aten\xe7\xe3o Prim\xe1ria"},zh:{title:"\u521d\u7ea7\u536b\u751f\u4fdd\u5065"}}},{title:"Pulmonology",id:"Pulmonology and Respiratory",type:"Category",icon:"pulmonology",tabTags:s.Ht,translations:{de:{title:"Pulmonologie"},es:{title:"Neumolog\xeda"},fr:{title:"Pneumologie"},it:{title:"Pneumologia"},ja:{title:"\u547c\u5438\u5668\u5b66"},pt:{title:"Pneumologia"},zh:{title:"\u80ba\u75c5\u79d1"}}},{title:"Urology and Nephrology",id:"Urology and Nephrology",type:"Category",icon:"urology",tabTags:s.Ht,translations:{de:{title:"Urologie"},es:{title:"Urolog\xeda"},fr:{title:"Urologie"},it:{title:"Urologia"},ja:{title:"\u6ccc\u5c3f\u5668\u79d1\u5b66"},pt:{title:"Urologia"},zh:{title:"\u6ccc\u5c3f\u5916\u79d1"}}}],community:[{title:"Community Content",id:"public",type:"Community",icon:"community-bookmarks",translations:{de:{title:"Community-Inhalte"},es:{title:"Contenido de la comunidad"},fr:{title:"Contenu communautaire"},it:{title:"Contenuto della comunit\xe0"},ja:{title:"\u30b3\u30df\u30e5\u30cb\u30c6\u30a3\u30b3\u30f3\u30c6\u30f3\u30c4"},pt:{title:"Conte\xfado da Domunidade"},zh:{title:"\u793e\u533a\u5185\u5bb9"}}}],"expert collections":[{id:"Anatomy for Physical Therapy Students",featured:!0,type:"Category",title:"Anatomy for Physical Therapy Students",subtitle:"Created with Kirsten C Moisio PT, PhD",metadata:"Professor of Physical Therapy",image:"/assets/images/expert-collections/physical-therapy.png",featuredIcon:"/assets/images/logos/northwestern-medicine-logo.svg",outerColor:"#28167E",innerColor:"#5B49B6",translations:{de:{title:"Anatomie f\xfcr Studierende der Physiotherapie",subtitle:"Erstellt mit Kirsten C Moisio PT, PhD",metadata:"Professor f\xfcr Physikalische Therapie"},es:{title:"Anatom\xeda para estudiantes de fisioterapia",subtitle:"Creado con Kirsten C Moisio PT, PhD",metadata:"Profesor de Fisioterapia"},fr:{title:"Anatomie pour \xe9tudiants en physioth\xe9rapie",subtitle:"Cr\xe9\xe9 avec Kirsten C Moisio PT, PhD",metadata:"Professeur de kin\xe9sith\xe9rapie"},it:{title:"Anatomia per studenti di terapia fisica",subtitle:"Creato con Kirsten C Moisio PT, PhD",metadata:"Professore di terapia fisica"},ja:{title:"\u7406\u5b66\u7642\u6cd5\u5b66\u751f\u306e\u305f\u3081\u306e\u89e3\u5256\u5b66",subtitle:"Kirsten C Moisio PT, PhD\u3068\u5171\u540c\u3067\u4f5c\u6210",metadata:"\u7406\u5b66\u7642\u6cd5\u5b66\u6559\u6388"},pt:{title:"Anatomia para estudantes de fisioterapia",subtitle:"Criado com Kirsten C Moisio PT, PhD",metadata:"Professor de Fisioterapia"},zh:{title:"\u7269\u7406\u6cbb\u7597\u5b66\u751f\u7684\u89e3\u5256\u5b66",subtitle:"\u7531 Kirsten C Moisio PT \u535a\u58eb\u521b\u4f5c",metadata:"\u7269\u7406\u7597\u6cd5\u6559\u6388"}}},{id:"Anatomy for Medical Students",featured:!0,type:"Category",tabTags:s.iE,title:"Anatomy for Medical Students",subtitle:"Created with Jonathan J Wisco, PhD",metadata:"Associate Professor of Anatomy & Neurobiology",image:"/assets/images/expert-collections/medical.png",featuredIcon:"/assets/images/logos/bu-logo.svg",outerColor:"#242629",innerColor:"#585D64",translations:{de:{title:"Anatomie f\xfcr Medizinstudenten",subtitle:"Erstellt mit Jonathan J Wisco, PhD",metadata:"Assoziierter Professor f\xfcr Anatomie und Neurobiologie"},es:{title:"Anatom\xeda para estudiantes de medicina",subtitle:"Creado con Jonathan J Wisco, PhD",metadata:"Profesor asociado de anatom\xeda y neurobiolog\xeda"},fr:{title:"Anatomie pour les \xe9tudiants en m\xe9decine",subtitle:"Cr\xe9\xe9 avec Jonathan J Wisco, PhD",metadata:"Professeur associ\xe9 d'anatomie et de neurobiologie"},it:{title:"Anatomia per studenti di medicina",subtitle:"Creato con Jonathan J Wisco, PhD",metadata:"Professore associato di Anatomia e Neurobiologia"},ja:{title:"\u533b\u5b66\u751f\u306e\u305f\u3081\u306e\u89e3\u5256\u5b66",subtitle:"\u30b8\u30e7\u30ca\u30b5\u30f3\u30fbJ\u30fb\u30a6\u30a3\u30b9\u30b3\u535a\u58eb\u3068\u5171\u540c\u3067\u4f5c\u6210",metadata:"\u89e3\u5256\u5b66\u304a\u3088\u3073\u795e\u7d4c\u751f\u7269\u5b66\u306e\u51c6\u6559\u6388"},pt:{title:"Anatomia para estudantes de medicina",subtitle:"Criado com Jonathan J Wisco, PhD",metadata:"Professor Associado de Anatomia e Neurobiologia"},zh:{title:"\u533b\u5b66\u751f\u89e3\u5256\u5b66",subtitle:"\u7531 Jonathan J Wisco \u535a\u58eb\u521b\u4f5c",metadata:"\u89e3\u5256\u5b66\u548c\u795e\u7ecf\u751f\u7269\u5b66\u526f\u6559\u6388"}}}]};function P(p){return[...i(O.main,p),...i(O.categories,p),...i(c,p),...i(O.specialties,p),...i(O.community,p),...i(O["expert collections"],p)]}function S(p,h){let o=O.categories;return h&&(o=h.map(v=>c.find(d=>d.id===v)).concat(o)),{all:i(O.main,p),anatomy:i(o,p),specialties:i(O.specialties,p),community:i(O.community,p),"expert collections":i(O["expert collections"],p)}}function a(p,h){return i(O[p],h)}function f(p,h){if(null==p)return null;let o=(0,e.cloneDeep)(P().find(v=>v.id===p));return null==o?null:(h&&(o=g(o,h)),o)}function E(p){return O.specialties.find(h=>p.tags.some(o=>o===h.id))}function y(p){return O.categories.find(h=>p.tags.some(o=>o===h.id))}function i(p,h){return p.map(o=>g(o,h))}function g(p,h){const o=(0,e.cloneDeep)(p);return h&&(o.title=(0,e.get)(o,`translations.${h}.title`,o.title),o.subtitle&&(o.subtitle=(0,e.get)(o,`translations.${h}.subtitle`,o.subtitle)),o.metadata&&(o.metadata=(0,e.get)(o,`translations.${h}.metadata`,o.metadata))),o}},41722:(le,N,n)=>{"use strict";n.d(N,{K:()=>e});class e{}},45691:(le,N,n)=>{"use strict";n.d(N,{cC:()=>t.c,dt:()=>c});var e=n(60177),t=n(27044),s=n(54438);let c=(()=>{class O{static forRoot(S){return{ngModule:O,providers:[{provide:S,useClass:S},{provide:t.c,useClass:t.c,deps:[S]}]}}static#e=this.\u0275fac=function(a){return new(a||O)};static#t=this.\u0275mod=s.$C({type:O});static#n=this.\u0275inj=s.G2t({imports:[e.MD]})}return O})()},27044:(le,N,n)=>{"use strict";n.d(N,{c:()=>S});var e=n(49204),s=n(27153),c=n(54438),O=n(41722);let S=(()=>{class a{constructor(E){if(!E.accountUrl)throw new Error("Missing accountUrl. Please set in app config via ZendeskWidgetProvider");this.window=function P(){return window}();let y=this.window;y.zEmbed||function(){var p,h,o,d,r=[],_=document.createElement("iframe");y.zEmbed=function(){r.push(arguments)},y.zE=y.zE||y.zEmbed,_.src="javascript:false",_.title="",_.style.cssText="display: none",(o=(o=document.getElementsByTagName("script"))[o.length-1]).parentNode.insertBefore(_,o),d=_.contentWindow.document;try{h=d}catch{p=document.domain,_.src='javascript:var d=document.open();d.domain="'+p+'";void(0);',h=d}h.open()._l=function(){var u=this.createElement("script");p&&(this.domain=p),u.id="js-iframe-async",u.src="https://assets.zendesk.com/embeddable_framework/main.js",this.t=+new Date,this.zendeskHost=E.accountUrl,this.zEQueue=r,this.body.appendChild(u)},h.write('<body onload="document._l();">'),h.close()}(),this.window.zE(()=>{E.beforePageLoad(this.window.zE)})}setLocale(E){this.window.zE(()=>{this.window.zE.setLocale(E)})}identify(E){this.window.zE(()=>{(0,e.isNil)(E)?this.window.zE("webWidget","clear"):this.window.zE.identify({name:this.getUserFullName(E),email:E.email})})}hide(){this.window.zE(()=>{this.window.zE.hide()})}show(){this.window.zE(()=>{this.window.zE.show()})}activate(E){this.window.zE(()=>{this.window.zE.activate(E)})}showWidget(E="help"){this.hide(),this.setSettings({webWidget:{helpCenter:{suppress:"contact"===E}}}),this.activate({hideOnClose:!0})}setHelpCenterSuggestions(E){this.window.zE(()=>{this.window.zE.setHelpCenterSuggestions(E)})}setSettings(E){this.window.zE(()=>{this.window.zE("webWidget","updateSettings",E)})}updateFromProfile(E){const y=[];if(null!=E){const{premium_account:g,premium_account_type:p,developer_account:h,subscription:o}=E;g?(y.push(`premium_account_${p}`),o&&y.push(`subscription_${o.subscription_provider}`)):y.push("free_account"),h&&y.push("developer_account")}const i=(0,s.E)(E);this.setSettings({webWidget:{position:{horizontal:"right",vertical:"bottom"},offset:{horizontal:"0px",vertical:"0px"},contactForm:{suppress:!i,tags:y,fields:[{id:"name",prefill:{"*":this.getUserFullName(E)}}]}}})}getUserFullName(E){if(E){const{first_name:y,last_name:i}=E;return`${y} ${i}`}return""}static#e=this.\u0275fac=function(y){return new(y||a)(c.KVO(O.K))};static#t=this.\u0275prov=c.jDH({token:a,factory:a.\u0275fac,providedIn:"root"})}return a})()},70914:(le,N,n)=>{"use strict";n.d(N,{V:()=>c});var e=n(60177),t=n(54438),s=n(35286);let c=(()=>{class O{constructor(){this.markdownText=t.hFB.required()}static#e=this.\u0275fac=function(a){return new(a||O)};static#t=this.\u0275cmp=t.VBU({type:O,selectors:[["app-html"]],inputs:{markdownText:[1,"markdownText"]},standalone:!0,features:[t.aNF],decls:3,vars:5,consts:[[1,"html",3,"innerHTML"]],template:function(a,f){1&a&&(t.nrm(0,"div",0),t.nI1(1,"markdown"),t.nI1(2,"async")),2&a&&t.Y8G("innerHTML",t.bMT(2,3,t.bMT(1,1,f.markdownText())),t.npT)},dependencies:[e.Jj,s.y2,s.i0],encapsulation:2,changeDetection:0})}return O})()},86050:(le,N,n)=>{"use strict";n.d(N,{O:()=>t});var t,s,e=n(49969);(s=t||(t={})).slideTransition=(0,e.lY)([(0,e.iF)({transform:"translateY({{ from }}%)",opacity:0}),(0,e.i0)("{{ duration }}ms ease-out",(0,e.iF)({transform:"translateY({{ to }})",opacity:1}))]),s.fadeIn=(0,e.lY)([(0,e.iF)({opacity:0}),(0,e.i0)("{{ duration }}ms ease-out",(0,e.iF)({opacity:1}))]),s.fadeOut=(0,e.lY)([(0,e.iF)({opacity:"*"}),(0,e.i0)("{{ duration }}ms ease-in",(0,e.iF)({opacity:0}))])},11789:(le,N,n)=>{"use strict";var e;n.d(N,{T:()=>e}),function(t){const c=/(\s*[\d\.]+\s*,){2,15}\s*[\d\.]+\s*/g,O=/^#(?:[\da-f]{3}){1,2}$|^#(?:[\da-f]{4}){1,2}$|(rgb|hsl)a?\((\s*-?\d+%?\s*,){2}(\s*-?\d+%?\s*)\)|(rgb|hsl)a?\((\s*-?\d+%?\s*,){3}\s*(0|(0?\.\d+)|1)\)/gim;function a(C){for(let b=0;b<3;b++)if(parseFloat(`${C[b]}`)>1)return!0;return!1}function E(C){const b=document.createElement("div");b.style.backgroundColor=C,document.documentElement.appendChild(b);const R=window.getComputedStyle(b).backgroundColor.replace(/\s/g,"");return window.document.documentElement.removeChild(b),R}function y(C){const b=C.slice(0,4);3===b.length&&b.push(1);for(let R=0;R<4;R++)b[R]=parseFloat(`${b[R]}`),b[R]<0&&(b[R]=0),b[R]>255&&(b[R]=255);return b[3]>1&&(b[3]=1),b}function i(C){let b;if(Array.isArray(C))b=y(C);else if("string"==typeof C){let R=C.match(c);R?b=y(R[0].split(",")):(R=E(C).match(c),R&&(b=y(R[0].split(","))))}return b}function g(C){const b=i(C);if(!b)throw new TypeError("Invalid color input.");const R=h(b);return{1:a(b)?R:b,255:a(b)?b:R}}function h(C){const b=a(C),R=[];for(let A=0;A<3;A++){let G=b?C[A]/255:255*C[A];G=b?Math.round(100*G)/100:Math.round(G),R.push(G)}return 4===C.length&&R.push(C[3]),R}function o(C,b=!1){C=C.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(W,T,x,z)=>[T,T,x,x,z,z].join("")).replace(/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,(W,T,x,z)=>[T,x,z,"ff"].join(""));const R=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(C),A=parseInt(R[1],16),G=parseInt(R[2],16),k=parseInt(R[3],16),V=parseInt(R[4],16)/255;if(b){const W=u([A,G,k]);return[W[0],W[1],W[2],V]}return[A,G,k,V]}function r(C){const[b,R,A]=C;return Math.sqrt(b*b*.299+R*R*.587+A*A*.114)}function u(C){return C.map(R=>R/255)}function l(C){return C.map(R=>Math.round(255*R))}function m(C){return`#${C.map(R=>{const A=R.toString(16);return A.length%2?`0${A}`:A}).join("")}`}t.isCSSColor=function S(C){return C.match(O)?.length>0},t.is255=a,t.isLight=function f(C,b){return b||(b=[...C]),(r(C)+r(b))/2>140.25},t.getComputedColor=E,t.convertChannels=y,t.convert=i,t.getColor=g,t.getColors=function p(C){let b=[];if("string"==typeof C){const R=C.match(c);R&&(C=R.join(",")),C=C.split(",")}if(Array.isArray(C))if(Array.isArray(C[0])&&Array.isArray(C[1]))b=C;else if(C.length<=2)b=1===C.length?C.concat(C):C;else{const A=Math.floor(C.length/2);b=C.length>4?[C.slice(0,A),C.slice(A)]:[C,C]}return b.map(R=>g(R))},t.scaleColor=h,t.hexToRgba=o,t.hexToRgb=function v(C,b=!1){const R=o(C,b);return[R[0],R[1],R[2]]},t.rgbToHex=function d(C,b=!1){return m(b?l(C):C)},t.rgbToHSP=r,t.rgbaToHex=function _(C,b=!1){const R=C[0],A=C[1],G=C[2],k=255*C[3];return m(b?[...l([R,A,G]),k]:[R,A,G,k])},t.rgbToDecimal=u,t.rgbFromDecimal=l}(e||(e={}))},3287:(le,N,n)=>{"use strict";n.d(N,{H:()=>s});var e=n(2573),t=n(74902);function s(c,O,P=!0){const S=new t.F,a=[];return P&&a.push(O.map(f=>f.label)),c.forEach(f=>{const E=O.map(y=>f[y.field]);a.push(E)}),new e.c(f=>{const E=S.unparse(a,{quotes:!0,header:!1});f.next(E),f.complete()})}},87947:(le,N,n)=>{"use strict";n.d(N,{g:()=>S});var S,e=n(49204),s=n(35426),c=n(76718),O=n(36110),P=n(35160);!function(a){function E(v){g()&&(v||(v=document.body),v.requestFullscreen?v.requestFullscreen():v.webkitRequestFullscreen&&v.webkitRequestFullscreen())}function y(){g()&&(document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen&&document.webkitExitFullscreen())}function i(){return document.fullscreenEnabled||document.webkitFullscreenEnabled}function g(){return!!i()||(console.warn("Fullscreen is not enabled"),!1)}function p(){return document.fullscreenElement||document.webkitFullscreenElement}function h(){return!(0,e.isNil)(p())}a.toggleFullscreen=function f(v){const d=p();(0,e.isNil)(d)?E(v):y()},a.requestFullscreen=E,a.exitFullscreen=y,a.canFullscreen=i,a.checkFullscreenSupport=g,a.getFullscreenElement=p,a.isFullscreen=h,a.onFullscreenChange=function o(){const v=["mozfullscreenchange","webkitfullscreenchange","fullscreenchange"].map(d=>(0,s.R)(document.body,d));return(0,c.h)(...v).pipe((0,O.T)(()=>h()),(0,P.Z)(h()))}}(S||(S={}))},42482:(le,N,n)=>{"use strict";n.d(N,{X:()=>f});var f,e=n(28407),t=n(15877),s=n(2573),c=n(37678),P=n(67092),S=n(68947),a=n(7662);!function(E){function h(){return(h=(0,e.A)(function*(u,l=!1){return(0,a.mo)(u,{pixelRatio:1,skipFonts:!0,...l?{backgroundColor:"transparent"}:{}})})).apply(this,arguments)}E.exportImage=function y(u,l,m,C){const b="string"==typeof u?E.base64ToBlob(u,l):u;return C?(0,P.r)(b,C).then(function(R){(0,c.saveAs)(R,m)}):(0,c.saveAs)(b,m),(0,t.of)(!0)},E.canvasToBlob=function i(u,l,m){return new s.c(C=>{u.toBlob(b=>{C.next(b),C.complete()},l,m)})},E.fitCanvas=function g(u,l,m){const C=document.createElement("canvas");C.width=l,C.height=m;const b=C.getContext("2d"),k=Math.max(.5*(u.width-C.width/C.height*u.height),0);return b.drawImage(u,k,0,C.width,C.height),C},E.elementToCanvas=function p(u){return h.apply(this,arguments)},E.combineCanvasElements=function o(u){const l=Math.max(0,...u.map(R=>R.width)),m=Math.max(0,...u.map(R=>R.height)),C=document.createElement("canvas");C.width=l,C.height=m;const b=C.getContext("2d");return u.forEach(R=>{b.drawImage(R,0,0)}),C},E.base64ToBlob=function v(u,l){const m=atob(u.split(",")[1]),C=new ArrayBuffer(m.length),b=new Uint8Array(C);for(let R=0;R<m.length;R++)b[R]=m.charCodeAt(R);return new Blob([C],{type:l})},E.blobToBase64=function d(u){return new s.c(l=>{const m=new FileReader;m.addEventListener("load",()=>{l.next(m.result),l.complete()}),m.readAsDataURL(u)})},E.blobToCanvas=function r(u,l,m){return new s.c(C=>{const b=document.createElement("canvas");b.width=l,b.height=m;const R=b.getContext("2d"),A=new Image,G=URL.createObjectURL(u);A.addEventListener("load",()=>{R.drawImage(A,0,0),URL.revokeObjectURL(G),C.next(b),C.complete()}),A.src=G})},E.createModelFileName=function _(u,l,m,C){let b=u||l||"";return u&&l&&u!==l&&(b=`${u}_${l}`),`${S.l.normalize(b).replace(/ /g,"_").replace(/\W/g,"").toLowerCase()}${C?`_${C}`:""}.${m.replace(".","")}`}}(f||(f={}))},46889:(le,N,n)=>{"use strict";n.d(N,{A1:()=>s,E8:()=>t,dL:()=>c,nv:()=>P,vT:()=>O});var e=n(38472);function t(S,a){const f=e.create();return e.sub(f,a,S),e.length(f)}function s(S,a){const f=e.create();return e.add(f,a,S),e.scale(f,f,.5),f}function c(S,a,f,E,y,i){const g=(S-a)/(f-a);return(i=i??e.create())[0]=E[0]+g*(y[0]-E[0]),i[1]=E[1]+g*(y[1]-E[1]),i[2]=E[2]+g*(y[2]-E[2]),i}function O(S,a,f){const E=S*S;return a+f*(-1*E*E+E*S*4+-6*E+4*S)}function P(S){return S*(180/Math.PI)}},47833:(le,N,n)=>{"use strict";n.d(N,{Un:()=>O,mJ:()=>c});var e=n(22083),t=n(24418),s=n(27180);function c(S,a,f=!0){return.01*(window.innerHeight-(f&&S!==e.D.Hide?a:0))}function O(S){return S===e.D.Logo||t.c.application!==s.c.Viewer}},68947:(le,N,n)=>{"use strict";n.d(N,{l:()=>c});var c,e=n(28407),t=n(49204);!function(O){function i(){return(i=(0,e.A)(function*(h,o,v,d=!1){return g(h,yield o.parse(v),d)})).apply(this,arguments)}function g(h,o,v=!1){const d=h.createElement("div");return h.setProperty(d,"innerHTML",o),v&&d.querySelectorAll("p").forEach(_=>{h.setProperty(_,"textContent",_.textContent+" ")}),(0,t.trim)(d.textContent)}O.normalize=function P(h){return`${h||""}`.replace(/&#(\d+);/g,(v,d)=>String.fromCharCode(d)).replace(/(&.+;)/gi,(v,d)=>String.fromCharCode(v.charCodeAt(0)))},O.prettyPrint=function S(h){return`${h||""}`.trim().replace(/([A-Z])/g," $1").replace(/^./,v=>v.toUpperCase()).trim()},O.parseEmails=function a(h){return h.split(/[,\r\n]/).map(o=>o.trim()).filter(o=>!!o)},O.validateEmail=function f(h){return/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/.test(h)},O.toTitleCase=function E(h){return h.replace(/\w\S*/g,o=>o.charAt(0).toUpperCase()+o.substring(1).toLowerCase())},O.getPlainTextFromMarkdown=function y(h,o,v){return i.apply(this,arguments)},O.getPlainTextFromHTML=g,O.splitTextByCharacterCount=function p(h,o){for(var v=[];h.length>o;){var d=h.substring(0,o).lastIndexOf(" ");v.push(h.substring(0,d=d<=0?o:d));var r=h.indexOf(" ",d)+1;(r<d||r>d+o)&&(r=d),h=h.substring(r)}return v.push(h),v}}(c||(c={}))},83889:(le,N,n)=>{"use strict";n.d(N,{n:()=>s});var e=n(54438);const t={"Sign in":"3971305","Sign up":"3971297"};let s=(()=>{class c{constructor(P){this.config=P,this.initialized=!1}initialize(){if(!this.config.enabled||this.initialized)return;const P=`\n      _linkedin_partner_id = "${this.config.linkedinId}"; \n      window._linkedin_data_partner_ids = window._linkedin_data_partner_ids || []; \n      window._linkedin_data_partner_ids.push(_linkedin_partner_id);\n      (function(){var s = document.getElementsByTagName("script")[0]; var b = document.createElement("script"); b.type = "text/javascript";b.async = true; b.src = "https://snap.licdn.com/li.lms-analytics/insight.min.js"; s.parentNode.insertBefore(b, s);})();\n    `,S=document.createElement("script");S.textContent=P,document.body.appendChild(S),this.initialized=!0}track(P){const S=t[P];if(S){const a=document.createElement("img");a.height=1,a.width=1,a.style.display="none",a.alt="",a.src=`https://px.ads.linkedin.com/collect/?pid=${this.config.linkedinId}&conversionId=${S}&fmt=gif`,document.body.appendChild(a)}}static#e=this.\u0275fac=function(S){return new(S||c)(e.KVO("linkedinConfig"))};static#t=this.\u0275prov=e.jDH({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})()},49206:(le,N,n)=>{"use strict";n.d(N,{Z:()=>O,n:()=>P});var e=n(89417),t=n(49204),c=n(54438);let O=(()=>{class S{get control(){return this.formControl||this.controlContainer.control.get(this.formControlName)}constructor(f){this.controlContainer=f}registerOnTouched(f){this.formControlDirective.valueAccessor.registerOnTouched(f)}registerOnChange(f){this.formControlDirective.valueAccessor.registerOnChange(f)}writeValue(f){this.formControlDirective.valueAccessor.writeValue(f)}setDisabledState(f){this.formControlDirective.valueAccessor.setDisabledState(f)}static#e=this.\u0275fac=function(E){return new(E||S)(c.rXU(e.ZU))};static#t=this.\u0275cmp=c.VBU({type:S,selectors:[["app-base-accessor-control"]],viewQuery:function(E,y){if(1&E&&c.GBs(e.l_,7),2&E){let i;c.mGM(i=c.lsd())&&(y.formControlDirective=i.first)}},inputs:{formControl:"formControl",formControlName:"formControlName"},decls:0,vars:0,template:function(E,y){},encapsulation:2})}return S})(),P=(()=>{class S{get value(){return this._value}set value(f){(0,t.isEqual)(this._value,f)||(this._value=f,this.setFormValues(f),this.onChange(f))}constructor(){}onChange(f){}onTouched(){}registerOnTouched(f){this.onTouched=f}registerOnChange(f){this.onChange=f}writeValue(f){this.value=f}setDisabledState(f){this.disabled=f}static#e=this.\u0275fac=function(E){return new(E||S)};static#t=this.\u0275cmp=c.VBU({type:S,selectors:[["app-abstract-input-control"]],inputs:{value:"value",disabled:"disabled"},decls:0,vars:0,template:function(E,y){},encapsulation:2})}return S})()},9592:(le,N,n)=>{"use strict";n.d(N,{G:()=>t,H:()=>e});var e=function(s){return s.JPEG="image/jpeg",s.PNG="image/png",s}(e||{});const t={[e.JPEG]:"jpeg",[e.PNG]:"png"}},97443:(le,N,n)=>{"use strict";n.d(N,{M:()=>e});var e=function(t){return t.Responsive="responsive",t.Fixed="fixed",t}(e||{})},3188:(le,N,n)=>{"use strict";n.d(N,{s:()=>e});var e=function(t){return t.Pending="pending",t.Accepted="accepted",t.Denied="denied",t.Expired="expired",t}(e||{})},82542:(le,N,n)=>{"use strict";n.d(N,{P:()=>e});var e=function(t){return t.Dark="dark",t.Light="light",t}(e||{})},18272:(le,N,n)=>{"use strict";n.d(N,{q:()=>e});var e=function(t){return t[t.List=0]="List",t[t.Tree=1]="Tree",t}(e||{})},13491:(le,N,n)=>{"use strict";n.d(N,{n:()=>e});class e{static toArray(s){return[s.x,s.y,s.z]}static fromArray(s){return{x:s[0],y:s[1],z:s[2]}}}},81642:(le,N,n)=>{"use strict";n.d(N,{D:()=>t});var e=n(54438);let t=(()=>{class s{constructor(){}roundModel(O,P){const S={...O};return Object.keys(O).filter(a=>"number"==typeof O[a]).forEach(a=>{S[a]=this.roundNumber(O[a],P)}),S}roundNumber(O,P){return Math.round(O*Math.pow(10,P))/Math.pow(10,P)}static#e=this.\u0275fac=function(P){return new(P||s)};static#t=this.\u0275prov=e.jDH({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})()},86544:(le,N,n)=>{"use strict";n.d(N,{R:()=>s});var s,e=n(59429);!function(c){function O(S){return S.split("-")[0].replace(/_particle$/,"")}c.getParticleIdRoot=O,c.generateParticleId=function P(S,a=e.u.getUuid){return`${O(S)}-${a()}`}}(s||(s={}))},6049:(le,N,n)=>{"use strict";n.d(N,{Y:()=>s});var e=n(60177),t=n(54438);let s=(()=>{class c{static#e=this.\u0275fac=function(S){return new(S||c)};static#t=this.\u0275mod=t.$C({type:c});static#n=this.\u0275inj=t.G2t({imports:[e.MD]})}return c})()},78674:(le,N,n)=>{"use strict";n.d(N,{g:()=>c});var e=n(38645),t=n(14264),s=n(54438);let c=(()=>{class O{constructor(S){this.router=S,this.history=[]}loadRouting(){this.router.events.pipe((0,t.p)(S=>S instanceof e.wF)).subscribe(({urlAfterRedirects:S})=>{this.history=[...this.history,S]})}getHistory(){return this.history}getPreviousUrl(){return this.history[this.history.length-2]||"/"}static#e=this.\u0275fac=function(a){return new(a||O)(s.KVO(e.Ix))};static#t=this.\u0275prov=s.jDH({token:O,factory:O.\u0275fac,providedIn:"root"})}return O})()},5690:(le,N,n)=>{"use strict";n.d(N,{b:()=>O});var e=n(24418),t=n(54438),s=n(36860),c=function(P){return P.Web="web",P.Android="mobile_android",P.iOS="mobile_ios",P}(c||{});let O=(()=>{class P{constructor(a){this.platform=a}get productKey(){return e.c.productKey}get productType(){if(e.c.native){if(this.platform.ANDROID)return c.Android;if(this.platform.IOS)return c.iOS}return c.Web}get productHeader(){return{"Bd-Product-Ua":`BD/Product/${this.productType}/${this.productKey}`}}static#e=this.\u0275fac=function(f){return new(f||P)(t.KVO(s.OD))};static#t=this.\u0275prov=t.jDH({token:P,factory:P.\u0275fac,providedIn:"root"})}return P})()},21604:(le,N,n)=>{"use strict";n.d(N,{G:()=>I});var e=n(60177),t=n(11562),s=n(78696),c=n(45189),O=n(89417),P=n(66598),S=n(41722),a=n(45691),f=n(54438);class E extends S.K{constructor(){super(...arguments),this.accountUrl="biodigital.zendesk.com"}beforePageLoad(L){L.setLocale("en"),L.hide()}}let y=(()=>{class D{static#e=this.\u0275fac=function(ie){return new(ie||D)};static#t=this.\u0275mod=f.$C({type:D});static#n=this.\u0275inj=f.G2t({imports:[a.dt.forRoot(E)]})}return D})();var i=n(11818),g=n(90556),p=n(3272),h=n(89511),o=n(59162),v=n(6049),d=n(46374),r=n(59464),_=n(32996),u=n(72026),l=n(82192),m=n(35286),C=n(81488),b=n(38645),R=n(70914),A=n(26621),G=n(89630);let k=(()=>{class D{static#e=this.\u0275fac=function(ie){return new(ie||D)};static#t=this.\u0275mod=f.$C({type:D});static#n=this.\u0275inj=f.G2t({imports:[e.MD,s.H,u.o]})}return D})();var V=n(18824),W=n(9529),T=n(5584),x=n(64218),z=n(64026);let I=(()=>{class D{static#e=this.\u0275fac=function(ie){return new(ie||D)};static#t=this.\u0275mod=f.$C({type:D});static#n=this.\u0275inj=f.G2t({imports:[b.iI,i.C,t.YG,_.z,e.MD,h.h,u.o,p.D,s.H,c.G,C.f,l.G,d.b,v.Y,o.M,O.X1,P.S,r.j,G.$,g.f,y,V.j,W.bU,T.d,x.H,m.y2.forChild(),z.m,R.V,A.o,i.C,_.z,h.h,p.D,u.o,s.H,C.f,l.G,v.Y,d.b,k,o.M,P.S,r.j,G.$,g.f,T.d,x.H,z.m]})}return D})()},17215:(le,N,n)=>{"use strict";n.d(N,{AJ:()=>S,UT:()=>O,d0:()=>P,n$:()=>E});var e=n(28407),t=n(9989);class s extends t.Ay{constructor(){super("HumanDatabase"),this.version(2).stores({keyValue:",value",analytics:"message"}),this.open(),this.keyValue=this.table("keyValue"),this.analytics=this.table("analytics")}}var c=n(54438),O=function(y){return y.WidgetOptions="widgetOptions",y.SnapshotOptions="snapshotOptions",y.Locale="locale",y.GroupRestriction="GroupRestriction",y.UserAppId="userAppId",y.RememberMeEmail="rememberMeEmail",y.LabelConversionSeen="labelConversionSeen",y.DefaultGroupEdit="defaultGroupEdit",y.DefaultCollectionId="defaultCollectionId",y.GettingStartedTutorial="gettingStartedTutorial",y.SystemMessage="systemMessage",y.ExploreRedesignMessage="exploreRedesignMessage",y.Iphone12Warning="iphone12Warning",y.RecentRecipes="recentRecipes",y.TeamTrialExpirationSeen="teamTrialExpiredSeen",y.ProExpirationSeen="proExpirationSeen",y.PaintPalettes="paintPalettes",y.RecentSearchConfig="recentSearchConfig",y.CameraDebug="cameraDebug",y.TeamWelcomeTourSeen="teamWelcomeTourSeen",y.UserJoinPromptSeen="userJoinPromptSeen",y.UserJoinNotificationInteracted="userJoinNotificationInteracted",y.ZSpaceDevice="zSpaceDevice",y.EnableAdvancedStats="enableAdvancedStats",y}(O||{}),P=function(y){return y.UserMessagesSeen="userMessagesSeen",y.PreviewSize="previewSize",y.GPUAnalyticsStored="gpuAnalyticsStored",y}(P||{}),S=function(y){return y.PreviewStory="previewStory",y.PreviewBookmark="previewBookmark",y}(S||{});class f{constructor(){this._data={}}get keys(){return Object.keys(this._data)}get length(){return this.keys.length}clear(){this._data={}}getItem(i){return this._data[i]}key(i){return this.keys[i]}removeItem(i){delete this._data[i]}setItem(i,g){this._data[i]=g}}let E=(()=>{class y{constructor(){this._localStorage=this.getStorage("localStorage"),this._sessionStorage=this.getStorage("sessionStorage"),this._indexedStorage=new s}getLocalItem(g){return this._localStorage.getItem(`${g}`)}getLocalJSON(g){const p=this.getLocalItem(g);return p?JSON.parse(p):null}setLocalItem(g,p){const h="object"==typeof p?JSON.stringify(p):`${p}`;try{return this._localStorage.setItem(`${g}`,h),!0}catch{return!1}}removeLocalItem(g){this._localStorage.removeItem(`${g}`)}getSessionItem(g){const p=this._sessionStorage.getItem(`${g}`);return p?JSON.parse(p):null}setSessionItem(g,p){const h=JSON.stringify(p);try{return this._sessionStorage.setItem(`${g}`,h),!0}catch{return!1}}removeSessionItem(g){this._sessionStorage.removeItem(`${g}`)}setDatabaseItem(g,p){return this._indexedStorage.keyValue.put(p,g)}setDatabaseAnalyticItem(g){var p=this;(0,e.A)(function*(){yield p._indexedStorage.analytics.put(g)})()}getDatabaseOfflineAnalytics(g){var p=this;(0,e.A)(function*(){const h=yield p._indexedStorage.analytics.toArray();p._indexedStorage.analytics.clear(),g(h)})()}getDatabaseOfflineAnalyticsCount(g){var p=this;(0,e.A)(function*(){const h=yield p._indexedStorage.analytics.toArray();g(h.length)})()}getDatabaseItem(g){return this._indexedStorage.keyValue.get(g)}clearStorage(){this.clearLocalStorage(),this.clearSessionStorage()}clearLocalStorage(){this._localStorage.clear()}clearSessionStorage(){this._sessionStorage.clear()}getStorage(g){try{return window[g]||new f}catch{return new f}}static#e=this.\u0275fac=function(p){return new(p||y)};static#t=this.\u0275prov=c.jDH({token:y,factory:y.\u0275fac,providedIn:"root"})}return y})()},89612:(le,N,n)=>{"use strict";n.d(N,{V:()=>f});var f,e=n(49204),s=n(14264),c=n(36110),O=n(21770),P=n(17766),S=n(57238),a=n(69270);!function(E){function g(o,v){const d=new S.R;if(o.thumbnails)d.legacy=!1,d.storyId=v,d.chapterId=o.id,d.urls={...o.thumbnails};else{const _=`/thumbs/${P.c.Bookmark===(0,a.S)(v)?"bookmarks":"modules"}/${v.replace(".json","")}`;d.legacy=!0,d.storyId=v,d.chapterId=o.id,d.urls={small:`${_}/small/chapters/${o.id}.jpg`,large:`${_}/large/chapters/${o.id}.jpg`}}return d}E.generateLegacyThumbnail=function y(o,v){const _=`/thumbs/${P.c.Bookmark===(0,a.S)(o)?"bookmarks":"modules"}/${o.replace(".json","")}`;return{small:`${_}/small/chapters/${v}.jpg`,large:`${_}/large/chapters/${v}.jpg`}},E.generateThumbnails=function i(o){return o.reduce((v,{originalChapterId:d,newChapterId:r,originalStoryId:_})=>{const u=P.c.Bookmark===(0,a.S)(_),l=new S.R;l.storyId=_,l.chapterId=d;const C=`/thumbs/${u?"bookmarks":"modules"}/${_.replace(".json","")}`;return l.urls={small:`${C}/small/chapters/${d}.jpg`,large:`${C}/large/chapters/${d}.jpg`},v.set(r,l),v},new Map)},E.getChapterThumbnail=g,E.getChapterThumbnails=function p(o,v){return v.reduce((d,r)=>{const _=g(r,o);return d.set(r.id,_),d},new Map)},E.makeFreshThumbnail=function h(o,v,d){return(0,O.U_)(d).pipe((0,s.p)(r=>!(0,e.isNil)(r)),(0,c.T)(r=>{const _=new S.R;return _.snapshot=URL.createObjectURL(r),_.chapterId=v,_.storyId=o,_}))}}(f||(f={}))},97415:(le,N,n)=>{"use strict";n.d(N,{I:()=>e});const e={small:{width:256,height:256},medium:{width:512,height:512},large:{width:1024,height:1024}}},93455:(le,N,n)=>{"use strict";n.d(N,{V:()=>s});var t,e=n(81025);class s{constructor(){this[t]=!0}static#e=t=e.lE}},11113:(le,N,n)=>{"use strict";var e,t;n.d(N,{e:()=>e}),(t=e||(e={})).updateChapterIds=function s(S,a){return Object.keys(S).reduce((y,i)=>(y[a[i]]=S[i],y),{})},t.duplicateChapter=function c(S,a,f){return{...f,[a]:f[S]}},t.deleteChapter=function O(S,a){const f={...a};return delete f[S],f},t.addEntryForChapter=function P(S,a,f){return f[S]={...f[S],...a},f}},15318:(le,N,n)=>{"use strict";n.d(N,{K:()=>E});var e=n(11129),t=n(15877),s=n(36110),c=n(39705),O=n(40470),P=n(15040),S=n(17215),a=n(54438),f=n(21626);let E=(()=>{class y{constructor(g,p){this.http=g,this.storageService=p}getUserMessage(g,p="",h=!0){const o=this.getCachedMessage(g);return h&&o?(0,t.of)(o):this.http.get(`/ws/user/message?version=2&type=${g}&mode=${p}`).pipe((0,s.T)(v=>{const{message_seen_id:d,show_alert:r}=v;let _;switch(g){case e.s$.DomainAlert:_=(0,O.bj)(P.n,v.join_organization);break;case e.s$.WelcomeTour:_=`${v.tour_version}`;break;case e.s$.CompleteProfileAlert:const{is_new_user:u,is_team_user:l}=v||{};_=(0,O.bj)(e.KH,{is_new_user:u,is_team_user:l})}return{messageSeenId:d,messageType:g,showUserAlert:r,messageData:_}}),(0,c.M)(v=>{v.showUserAlert||this.addCachedMessage(v)}))}setUserMessageViewed(g){return this.http.post("/ws/user/message",{version:2,message_seen_id:g})}sendMessage(g){return this.http.post("/ws/user/message",g)}getCachedMessage(g){return this.getCachedMessages().find(h=>h.messageType===g)}getCachedMessages(){return this.storageService.getSessionItem(S.d0.UserMessagesSeen)||[]}addCachedMessage(g){if(!this.getCachedMessage(g.messageType)){const p=this.getCachedMessages();this.storageService.setSessionItem(S.d0.UserMessagesSeen,[...p,g])}}static#e=this.\u0275fac=function(p){return new(p||y)(a.KVO(f.Qq),a.KVO(S.n$))};static#t=this.\u0275prov=a.jDH({token:y,factory:y.\u0275fac,providedIn:"root"})}return y})()},59429:(le,N,n)=>{"use strict";var e;n.d(N,{u:()=>e}),function(t){function s(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(O){const P=16*Math.random()|0;return("x"===O?P:3&P|8).toString(16)})}t.getUuid=s,t.idWithPrefix=function c(O){return O?`${O}-${s()}`:s()}}(e||(e={}))},59e3:(le,N,n)=>{"use strict";n.d(N,{e:()=>E});var e=n(38645),t=n(49204),c=n(14264),O=n(87145),P=n(24418),S=n(63308),a=n(65459),f=n(54438);let E=(()=>{class y{constructor(g,p,h,o){this.config=g,this.router=p,this.route=h,this.organizationsService=o,this.appended=!1,this.initialized=!1,this.sessionEvents={},this.pageEvents={},this.queuedEvents=[],this.initRouteListener()}appendScripts(){!this.config.enabled||this.appended||(this.appendPendo(),this.appendHubspot(),this.appended=!0)}initialize(g,p){this.config.enabled&&(pendo.initialize({visitor:g,account:p}),this.flushQueuedEvents(),this.initialized=!0)}identify(g,p){this.config.enabled&&(pendo.identify({visitor:g,account:p}),this.hubspotIdentify({...g,account:p}))}createVisitorData(g){const p={},h=(0,S.j)(g.account_settings),o=(0,t.get)(g,"organizations[0].user_role.role_display_name",null);if((0,t.has)(g,"id")&&(p.id=this.getPrefixedId(g.id.toString())),(0,t.has)(g,"email")&&(p.email=g.email),(0,t.has)(g,"first_name")&&(0,t.has)(g,"last_name")&&(p.full_name=`${g.first_name} ${g.last_name}`),(0,t.has)(g,"registration_date")&&(p.registration_date=g.registration_date),(0,t.has)(g,"premium_account")&&(p.premium=g.premium_account),(0,t.has)(g,"user_is_developer")&&(p.developer=g.user_is_developer),(0,t.has)(g,"subscription")&&(p.subscriptionType=g.subscription?g.subscription.subscription_type:null),(0,t.has)(g,"is_third_party")&&(p.thirdParty=g.is_third_party),(0,t.has)(h,"account_purpose")&&(p.purpose=h.account_purpose?h.account_purpose.value:null),(0,t.has)(h,"account_role")&&(p.role=h.account_role?h.account_role.value:null),(0,t.has)(h,"account_field")&&(p.field=h.account_field?h.account_field.value:null),(0,t.has)(h,"email_marketing_optin")){const v=(0,t.get)(h,"email_marketing_optin.value",!1);p.emailMarketing=!!v}return o&&(p.teamRole=o),p}createAccountData(g){const p=(0,t.get)(g,"group_attributes",null);return{id:this.getPrefixedId((0,t.get)(g,"id",null)),name:(0,t.get)(g,"name",null),subscriptionType:(0,t.get)(g,"subscription.type",null),subscriptionEndDate:(0,t.get)(g,"subscription.paid_through_date",null),usersCount:(0,t.get)(g,"users_count",null),purpose:this.getGroupAttributeValue(p,"account_purpose"),field:this.getGroupAttributeValue(p,"account_field"),companyWebsite:this.getGroupAttributeValue(p,"account_company_website"),companySize:this.getGroupAttributeValue(p,"account_company_size"),externalAccountProvider:(0,t.get)(g,"external_account.external_account_provider",null)}}updateVisitorData(g){if(!this.config.enabled)return;const p=this.createVisitorData(g);pendo.updateOptions({visitor:p}),this.hubspotIdentify(p,!0)}updateAccountData(g){if(!this.config.enabled)return;const p=this.createAccountData(g);pendo.updateOptions({account:p})}flushQueuedEvents(){this.queuedEvents.forEach(g=>{this.track(g.trackType,g.metadata)})}track(g,p){this.config.enabled&&(this.initialized?pendo.track(g,p):this.queuedEvents.push({trackType:g,metadata:p}))}trackOncePerSession(g,p){this.sessionEvents[g]||this.config.enabled&&(this.track(g,p),this.sessionEvents[g]=!0)}trackOncePerPage(g,p){this.pageEvents[g]||this.config.enabled&&(this.track(g,p),this.pageEvents[g]=!0)}trackSignIn(g){this.trackSignInSignUp("Sign In - Success",g)}trackSignUp(g){this.trackSignInSignUp("Sign Up - Success",g)}trackSignInSignUp(g,p){const h=this.route.snapshot.queryParams;this.track(g,{type:p,referrer:document.referrer,refParam:h.ref||null,groupInvite:(0,t.has)(h,"group_invite"),groupCode:(0,t.has)(h,"group")&&(0,t.has)(h,"code")})}initRouteListener(){this.router.events.pipe((0,c.p)(g=>g instanceof e.wF),(0,O.i)(1)).subscribe(g=>{this.pageEvents={},this.hubspotTrackPageView(g.urlAfterRedirects)})}getPrefixedId(g){return g&&`${(0,t.get)(this.config,`idPrefixes[${P.c.deploy}]`,"")}${g}`}getGroupAttributeValue(g,p){if(!g)return null;const h=this.organizationsService.getOrganizationAttribute(g,"account_settings",p);return h?h.value:null}appendPendo(){const g=`\n      (function(apiKey){\n        (function(p,e,n,d,o){var v,w,x,y,z;o=p[d]=p[d]||{};o._q=o._q||[];\n        v=['initialize','identify','updateOptions','pageLoad','track'];for(w=0,x=v.length;w<x;++w)(function(m){\n            o[m]=o[m]||function(){o._q[m===v[0]?'unshift':'push']([m].concat([].slice.call(arguments,0)));};})(v[w]);\n            y=e.createElement(n);y.async=!0;y.src='https://cdn.pendo.io/agent/static/'+apiKey+'/pendo.js';\n            z=e.getElementsByTagName(n)[0];z.parentNode.insertBefore(y,z);})(window,document,'script','pendo');\n      })('${this.config.pendoId}');\n    `,p=document.createElement("script");p.textContent=g,document.body.appendChild(p)}appendHubspot(){_hsq=window._hsq=window._hsq||[];const g=`${location.pathname}${location.search}${location.hash}`;_hsq.push(["setPath",g]);const p=document.createElement("script");p.async=!0,p.defer=!0,p.src=`//js.hs-scripts.com/${this.config.hubspotId}.js`,document.body.appendChild(p)}hubspotIdentify(g,p=!1){window._hsq?.push(["identify",g]);const h=p?"Visitor Updated":"Visitor Identified";window._hsq?.push(["trackCustomBehavioralEvent",{name:h}])}hubspotTrackPageView(g){window._hsq?.push(["setPath",g]),window._hsq?.push(["trackPageView"])}static#e=this.\u0275fac=function(p){return new(p||y)(f.KVO("vendorAnalyticsConfig"),f.KVO(e.Ix),f.KVO(e.nX),f.KVO(a.k))};static#t=this.\u0275prov=f.jDH({token:y,factory:y.\u0275fac,providedIn:"root"})}return y})()},24477:(le,N,n)=>{"use strict";n.d(N,{Fm:()=>b,Hz:()=>k,JO:()=>C,RS:()=>u,Rh:()=>l,Sy:()=>G,VD:()=>A,XF:()=>g,ld:()=>o,mf:()=>r});var e=n(93822),c=(n(13878),n(65855),n(49204)),P=n(28722),S=n(96557),a=n(45144),f=n(51640),E=n(43753),y=n(11876),i=n(6930);class g{static#e=e.U.Whiteboard}const p=(D,L)=>(0,c.isNil)(D)?L:D;function h(...D){return!!D.some(L=>!0===L)||!D.some(L=>!1===L)&&void 0}function o(D,L,Q){const ie=_(Q,Object.values(P.Y));return(0,c.isNil)(ie)?!1===D?P.Y.None:null!=L?L?P.Y.Full:P.Y.Small:null:ie}function v(D){return _(D,Object.values(S.aD))}function d(D){return _(D,Object.values(i.t))||(!0===D?i.t.AR:i.t.None)}function r(D,L){return!0===L?y.Z.Group:_(D,Object.values(y.Z))}function _(D,L){return L.includes(D)?D:null}function u(D){const L=null!=D.all?b(D.all):new g;return G({all:D.all,startingColumn:D.startingColumn,fadeout:D.fadeout,drawerExpanded:D.infoExpand,logoIsHyperLink:void 0,[e.U.AnatomyLabels]:h(D.anatomyLabels,D.anatomyLabels),[e.U.Audio]:D.audio,[e.U.Camera]:h(D.nav,D.cameraMode,D.center,D.zoomIn,D.zoomOut,D.nav),[e.U.Column]:h(D.info,D.info),[e.U.ContextActions]:D.contextActions,[e.U.ContextMenu]:D.contextMenu,[e.U.Drawer]:h(D.info,D.info),[e.U.Fullscreen]:h(D.fullscreen,D.fullscreen),[e.U.Help]:h(D.help,D.help),[e.U.LabelList]:h(D.labelList,D.labelList),[e.U.Labels]:D.labels,[e.U.Layout]:D.layout,[e.U.Legend]:D.legend,[e.U.Logo]:D.logo,[e.U.Loader]:v(D.loader),[e.U.XRLoader]:d(D.xrLoader),[e.U.Media]:o(D.playPause,h(D.scrubber,D["scrubber.chapters"]),D.media),[e.U.NodeAudio]:D.anatomyPronunciations,[e.U.NodeInfo]:D.anatomyDescriptions,[e.U.Pagination]:h(D.tour,D["tour.chapters"]),[e.U.Playthrough]:h(D.playthrough,D.autoplay),[e.U.QuizPrompt]:D["ui-quiz"],[e.U.Search]:h(D.objectTree,D.search),[e.U.TitleOnly]:h(D.info,D.info),[e.U.ToggleLabels]:void 0,[e.U.Toolbar]:h(D.toolbar,D.menu),[e.U.Tools]:h(D.tools,D.tools),[e.U.Tutorial]:void 0,[e.U.Undo]:h(D.reset,D.undo),[e.U.VisibilityLayers]:D.visibilityLayers,[e.U.VisibilityLayersMode]:r(D.visibilityLayersMode,D.skinLayers),[e.U.SkinLayers]:h(D.skinLayers),[e.U.Whiteboard]:D.whiteboard},L)}function l(D){const L={all:void 0,anatomyLabels:D.anatomyLabels.enable,audio:D.audio.enable,cameraMode:D.camera.enable,center:D.camera.enable,contextActions:D.contextActions.enable,contextMenu:D.contextMenu.enable,fadeout:void 0,fullscreen:D.fullscreen.enable,help:D.help.enable,info:D.column.enable||D.drawer.enable,infoExpand:D.drawer.isExpandedInitially,labels:D.labels.enable,legend:D.legend.enable,loader:v(D.loader.template),xrLoader:d(D.xrLoader.template),nav:D.camera.enable,objectTree:D.search.enable,playPause:D.media.enable,"scrubber.chapters":D.media.enable,scrubber:D.media.enable,"tools-display":D.tools.enable,tools:D.tools.enable,"tour.chapters":D.pagination.enable,tour:D.pagination.enable,visibilityLayers:D.visibilityLayers.enable,visibilityLayersMode:D.visibilityLayers.layersMode,skinLayers:D.skinLayers.enable,whiteboard:D.whiteboard.enable,zoomIn:D.camera.enable,zoomOut:D.camera.enable,share:!1,dissect:!1,xray:!1,annotations:!1,crossSection:!1,isolate:!1};return(0,c.pickBy)(L,Q=>!(0,c.isNil)(Q))}function C(D){if(!D||!D.config)return null;const L=new g;return L[e.U.Column]=D.config.info,L[e.U.Drawer]=D.config.info,L[e.U.Fullscreen]=D.config.fullscreen,L[e.U.Search]=D.config.objectTree,L[e.U.Camera]=D.config.nav,L[e.U.Loader]=v(D.config.loader),L[e.U.Whiteboard]=D.config.whiteboard,L[e.U.VisibilityLayers]=D.config.visibilityLayers,L[e.U.VisibilityLayersMode]=r(D.config.visibilityLayersMode,D.config.skinLayers),L[e.U.SkinLayers]=D.config.skinLayers,L[e.U.ContextActions]=D.config.contextActions,L[e.U.Audio]=(0,c.isNil)(D.config.audio)?null:D.config.audio!==a.Y.None,L[e.U.Media]=o(D.config.playPause,D.config.scrubber,D.config.mediaControls),L}function b(D){return{all:D,drawerExpanded:null,logoIsHyperLink:null,fadeout:null,startingColumn:null,[e.U.AnatomyLabels]:null,[e.U.Audio]:D,[e.U.Camera]:D,[e.U.Column]:D,[e.U.ContextActions]:D,[e.U.ContextMenu]:null,[e.U.Drawer]:D,[e.U.Fullscreen]:D,[e.U.Help]:D,[e.U.LabelList]:D,[e.U.Labels]:null,[e.U.Legend]:!0,[e.U.Loader]:D?S.kF:S.aD.None,[e.U.XRLoader]:void 0,[e.U.Logo]:!0,[e.U.Media]:D?P.Y.Full:P.Y.None,[e.U.NodeAudio]:D,[e.U.NodeInfo]:D,[e.U.Pagination]:D,[e.U.QuizPrompt]:D,[e.U.Search]:D,[e.U.TitleOnly]:D,[e.U.ToggleLabels]:!0,[e.U.Toolbar]:D,[e.U.Tools]:D,[e.U.Tutorial]:null,[e.U.Undo]:D,[e.U.VisibilityLayers]:D,[e.U.VisibilityLayersMode]:null,[e.U.SkinLayers]:D,[e.U.Whiteboard]:D}}function A(D){const L=new g;return L.anatomyLabels=!1,L.labelList=!1,L.labels=!1,L.legend=!1,L.nodeInfo=!1,L.pagination=!1,L.search=!1,L.toggleLabels=!1,L.tools=D?.type===E.Q5.SelectAnatomy,L.visibilityLayers=!1,L.whiteboard=!1,L}function G(D,L){return null==L?D:(0,c.uniq)([...Object.keys(D),...Object.keys(L)]).reduce((ie,se)=>(ie[se]=null==D[se]?L[se]:D[se],ie),new g)}function k(D,L){const Q=JSON.parse(JSON.stringify(D)),ie={...f.p2};return Q.loader.enable=p(L[e.U.Loader]!==S.aD.None,ie.loader.enable),null!=L[e.U.Loader]&&(Q.loader.template=L[e.U.Loader]),Q.xrLoader.enable=p(L[e.U.XRLoader]!==i.t.None,ie.xrLoader.enable),null!=L[e.U.XRLoader]&&(Q.xrLoader.template=L[e.U.XRLoader]),Q.anatomyLabels.enable=p(L[e.U.AnatomyLabels],ie.anatomyLabels.enable),Q.audio.enable=p(L[e.U.Audio],ie.audio.enable),Q.camera.enable=p(L[e.U.Camera],ie.camera.enable),Q.column.enable=p(L[e.U.Column],ie.column.enable),Q.contextActions.enable=p(L[e.U.ContextActions],ie.contextActions.enable),Q.contextMenu.enable=p(L[e.U.ContextMenu],ie.contextMenu.enable),Q.description.enable=p(L[e.U.Description],ie.description.enable),Q.drawer.enable=p(L[e.U.Drawer],ie.drawer.enable),Q.drawer.isExpandedInitially=p(L[e.U.DrawerExpanded],ie.drawer.isExpandedInitially),Q.fullscreen.enable=p(L[e.U.Fullscreen],ie.fullscreen.enable),Q.help.enable=p(L[e.U.Help],ie.help.enable),Q.labelList.enable=p(L[e.U.LabelList],ie.labelList.enable),Q.labels.enable=p(L[e.U.Labels],ie.labels.enable),Q.logo.enable=p(L[e.U.Logo],ie.logo.enable),Q.logo.isHyperLink=p(L.logoIsHyperLink,ie.logo.isHyperLink),Q.media.enable=p(L[e.U.Media]!==P.Y.None,ie.media.enable),Q.media.template=L[e.U.Media],Q.nodeAudio.enable=p(L[e.U.NodeAudio],ie.nodeAudio.enable),Q.nodeInfo.enable=p(L[e.U.NodeInfo],ie.nodeInfo.enable),Q.pagination.enable=p(L[e.U.Pagination],ie.pagination.enable),Q.playthrough.enable=p(L[e.U.Playthrough],ie.playthrough.enable),Q.quizPrompt.enable=p(L[e.U.QuizPrompt],ie.quizPrompt.enable),Q.search.enable=p(L[e.U.Search],ie.search.enable),Q.titleOnly.enable=p(L[e.U.TitleOnly],ie.titleOnly.enable),Q.toggleLabels.enable=p(L[e.U.ToggleLabels],ie.toggleLabels.enable),Q.toolbar.enable=p(L[e.U.Toolbar],ie.toolbar.enable),Q.tools.enable=p(L[e.U.Tools],ie.tools.enable),Q.tutorial.enable=p(L[e.U.Tutorial],ie.tutorial.enable),Q.undo.enable=p(L[e.U.Undo],ie.undo.enable),Q.visibilityLayers.enable=p(L[e.U.VisibilityLayers],ie.visibilityLayers.enable),Q.visibilityLayers.layersMode=r(L[e.U.VisibilityLayersMode]??ie.visibilityLayers.layersMode,L[e.U.SkinLayers]),Q.skinLayers.enable=p(L[e.U.SkinLayers],ie.skinLayers.enable),Q.whiteboard.enable=p(L[e.U.Whiteboard],ie.whiteboard.enable),Q}},49188:(le,N,n)=>{"use strict";n.d(N,{q:()=>s});var e=n(47610),t=n(515);function s(c,O){return c.dispatch(new e._y(!1)),O.fireEvent(t.X.SceneXrayDisabled),!0}},76037:(le,N,n)=>{"use strict";n.d(N,{J:()=>Ie});var e=n(28407),t=n(54438),s=n(79805),c=n(29160),O=n(85052),P=n(37925),S=n(14264),a=n(17365),f=n(36110),E=n(21082),y=n(11756),i=n(9065),g=n(82656),p=n(2573);function d(Oe){return Oe/1048576}var r=n(82542),_=n(92014),u=n(93915),l=n(38753),m=n(3367),C=n(46799),b=n(76304),R=n(94495),A=n(89417),G=n(49204),k=n(47610),V=n(24418),W=n(12215),T=n(515),x=n(17215),z=n(11724);function I(Oe){return Oe.toLocaleString()}const Q={totalVisibleLeafObjects:{title:"Visible Objects",description:"This value represents the number of visible objects in current chapter.",thresholds:{stable:[0,1e3],warning:[1e3,2e3],danger:[2e3,Number.MAX_SAFE_INTEGER]}},geometries:{title:"Geometry + Morphs",description:"",thresholds:{stable:[0,1e3],warning:[1e3,2e3],danger:[2e3,Number.MAX_SAFE_INTEGER]}},materials:{title:"Material Count",description:"This value represents the number of materials downloaded from BioDigital server whenever a page is reloaded.",thresholds:{stable:[0,50],warning:[50,100],danger:[100,Number.MAX_SAFE_INTEGER]}},textures:{title:"Texture Count",description:"This value represents the number of textures downloaded from BioDigital server whenever a page is reloaded.",thresholds:{stable:[0,50],warning:[50,100],danger:[100,Number.MAX_SAFE_INTEGER]}},duration:{title:"Time to Load (s)",description:"This value represents the number of seconds it takes for the entire BioDigital scene (Materials + Textures + Vertices + etc) to load when the page is refreshed.",thresholds:{stable:[0,4],warning:[4,10],danger:[10,Number.MAX_SAFE_INTEGER]}},drawCalls:{title:"Draw Call Count",description:"",thresholds:{stable:[0,400],warning:[400,600],danger:[600,Number.MAX_SAFE_INTEGER]}},drawVertices:{title:"Vertex Count",description:"",thresholds:{stable:[0,25e4],warning:[25e4,5e5],danger:[5e5,Number.MAX_SAFE_INTEGER]}},cpuTime:{title:"CPU Time (ms)",description:"",thresholds:{stable:[0,8],warning:[8,12],danger:[12,Number.MAX_SAFE_INTEGER]}},frameRate:{title:"Frame Rate (fps)",description:"",thresholds:{stable:[58,Number.MAX_SAFE_INTEGER],warning:[45,58],danger:[0,45]}},downloadGeometry:{title:"Geometry Data",description:"",thresholds:{stable:[0,10],warning:[10,25],danger:[25,Number.MAX_SAFE_INTEGER]}},downloadMorph:{title:"Morph Data",description:"",thresholds:{stable:[0,5],warning:[5,10],danger:[10,Number.MAX_SAFE_INTEGER]}},downloadMaterial:{title:"Material Data",description:"",thresholds:{stable:[0,.5],warning:[.5,1],danger:[1,Number.MAX_SAFE_INTEGER]}},downloadTransform:{title:"Transform Data",description:"",thresholds:{stable:[0,.5],warning:[.5,1],danger:[1,Number.MAX_SAFE_INTEGER]}},memoryUsage:{title:"Active Memory Usage",description:"",thresholds:{stable:[0,400],warning:[400,600],danger:[600,Number.MAX_SAFE_INTEGER]}},chapterPeakMemory:{title:"Chapter Peak Memory",description:"",thresholds:{stable:[0,400],warning:[400,600],danger:[600,Number.MAX_SAFE_INTEGER]}},scenePeakMemory:{title:"Scene Peak Memory",description:"",thresholds:{stable:[0,400],warning:[400,600],danger:[600,Number.MAX_SAFE_INTEGER]}}};function ie(Oe){return Q[Oe]?.title??""}function se(Oe){const ve=Q[Oe]?.thresholds,Ve=[];if(ve){const Je=Object.entries(ve).reduce((tt,[st,rt])=>(tt.push(`${st.toUpperCase()}: ${function D(Oe){const[Te,ve]=Oe;let Ve=I(Te);Te===Number.MIN_SAFE_INTEGER&&(Ve="min");let we=I(ve);return ve===Number.MAX_SAFE_INTEGER&&(we="max"),`[${Ve} - ${we}]`}(rt)}`),tt),[]).join(" ");Ve.push(Je)}return Ve.join(" ")}function Z(Oe,Te){const ve=Q[Oe]?.thresholds;if(ve){const{stable:Ve,warning:we,danger:Je}=ve;if((0,G.inRange)(Te,...Ve))return"stable";if((0,G.inRange)(Te,...we))return"warning";if((0,G.inRange)(Te,...Je))return"danger"}return"stable"}var de=n(60177),ae=n(3272),q=n(11818),K=n(82765),j=n(72026),M=n(14823),$=n(27180),ce=n(34006),re=n(87505),ue=n(21007),H=n(26779),te=function(Oe,Te,ve,Ve){var tt,we=arguments.length,Je=we<3?Te:null===Ve?Ve=Object.getOwnPropertyDescriptor(Te,ve):Ve;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)Je=Reflect.decorate(Oe,Te,ve,Ve);else for(var st=Oe.length-1;st>=0;st--)(tt=Oe[st])&&(Je=(we<3?tt(Je):we>3?tt(Te,ve,Je):tt(Te,ve))||Je);return we>3&&Je&&Object.defineProperty(Te,ve,Je),Je},F=function(Oe,Te){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(Oe,Te)};const w=(Oe,Te)=>({"engine-stats--light":Oe,"engine-stats--dark":Te,"engine-stats--advanced":!0});function X(Oe,Te){if(1&Oe&&(t.j41(0,"a",1)(1,"span",7),t.EFF(2," Documentation"),t.k0s(),t.nrm(3,"app-icon",8),t.k0s()),2&Oe){const ve=t.XpG(2);t.BMQ("href",ve.statsSupportUrl,t.B4B)}}function oe(Oe,Te){if(1&Oe&&(t.j41(0,"section",3)(1,"table",4)(2,"caption",5),t.EFF(3," Download Size (Total) "),t.k0s(),t.j41(4,"tr")(5,"th",6),t.EFF(6),t.k0s(),t.j41(7,"td"),t.EFF(8),t.nI1(9,"number"),t.k0s()(),t.j41(10,"tr")(11,"th",6),t.EFF(12),t.k0s(),t.j41(13,"td"),t.EFF(14),t.nI1(15,"number"),t.k0s()(),t.j41(16,"tr")(17,"th",6),t.EFF(18),t.k0s(),t.j41(19,"td"),t.EFF(20),t.nI1(21,"number"),t.k0s()(),t.j41(22,"tr")(23,"th",6),t.EFF(24),t.k0s(),t.j41(25,"td"),t.EFF(26),t.nI1(27,"number"),t.k0s()()()()),2&Oe){const ve=t.XpG(2);t.R7$(5),t.Y8G("matTooltip",ve.getStatDescription("downloadGeometry")),t.R7$(),t.SpI(" ",ve.getStatTitle("downloadGeometry")," "),t.R7$(),t.HbH(ve.getStatCSS("downloadGeometry",ve.engineStats.downloadGeometry)),t.R7$(),t.SpI(" ",t.i5U(9,20,ve.engineStats.downloadGeometry,"1.2-2")," MB "),t.R7$(3),t.Y8G("matTooltip",ve.getStatDescription("downloadMorph")),t.R7$(),t.SpI(" ",ve.getStatTitle("downloadMorph")," "),t.R7$(),t.HbH(ve.getStatCSS("downloadMorph",ve.engineStats.downloadMorph)),t.R7$(),t.SpI(" ",t.i5U(15,23,ve.engineStats.downloadMorph,"1.2-2")," MB "),t.R7$(3),t.Y8G("matTooltip",ve.getStatDescription("downloadMaterial")),t.R7$(),t.SpI(" ",ve.getStatTitle("downloadMaterial")," "),t.R7$(),t.HbH(ve.getStatCSS("downloadMaterial",ve.engineStats.downloadMaterial)),t.R7$(),t.SpI(" ",t.i5U(21,26,ve.engineStats.downloadMaterial,"1.2-2")," MB "),t.R7$(3),t.Y8G("matTooltip",ve.getStatDescription("downloadTransform")),t.R7$(),t.SpI(" ",ve.getStatTitle("downloadTransform")," "),t.R7$(),t.HbH(ve.getStatCSS("downloadTransform",ve.engineStats.downloadTransform)),t.R7$(),t.SpI(" ",t.i5U(27,29,ve.engineStats.downloadTransform,"1.2-2")," MB ")}}function Y(Oe,Te){if(1&Oe&&(t.j41(0,"section",3)(1,"table",4)(2,"caption",5),t.EFF(3," Memory "),t.k0s(),t.j41(4,"tr")(5,"th",6),t.EFF(6),t.k0s(),t.j41(7,"td"),t.EFF(8),t.nI1(9,"number"),t.k0s()(),t.j41(10,"tr")(11,"th",6),t.EFF(12),t.k0s(),t.j41(13,"td"),t.EFF(14),t.nI1(15,"number"),t.k0s()(),t.j41(16,"tr")(17,"th",6),t.EFF(18),t.k0s(),t.j41(19,"td"),t.EFF(20),t.nI1(21,"number"),t.k0s()()()()),2&Oe){const ve=t.XpG(3);t.R7$(5),t.Y8G("matTooltip",ve.getStatDescription("memoryUsage")),t.R7$(),t.SpI(" ",ve.getStatTitle("memoryUsage")," "),t.R7$(),t.HbH(ve.getStatCSS("memoryUsage",ve.currentAppStat.memoryUsage)),t.R7$(),t.SpI(" ",t.i5U(9,15,ve.currentAppStat.memoryUsage,"1.0-0")," MB "),t.R7$(3),t.Y8G("matTooltip",ve.getStatDescription("chapterPeakMemory")),t.R7$(),t.SpI(" ",ve.getStatTitle("chapterPeakMemory")," "),t.R7$(),t.HbH(ve.getStatCSS("chapterPeakMemory",ve.currentAppStat.chapterPeakMemory)),t.R7$(),t.SpI(" ",t.i5U(15,18,ve.currentAppStat.chapterPeakMemory,"1.0-0")," MB "),t.R7$(3),t.Y8G("matTooltip",ve.getStatDescription("scenePeakMemory")),t.R7$(),t.SpI(" ",ve.getStatTitle("scenePeakMemory")," "),t.R7$(),t.HbH(ve.getStatCSS("scenePeakMemory",ve.currentAppStat.scenePeakMemory)),t.R7$(),t.SpI(" ",t.i5U(21,21,ve.currentAppStat.scenePeakMemory,"1.0-0")," MB ")}}function he(Oe,Te){if(1&Oe){const ve=t.RV6();t.j41(0,"button",21),t.bIt("click",function(){t.eBV(ve);const we=t.XpG(4);return t.Njj(we.viewReportClick())}),t.EFF(1," View Report "),t.k0s()}if(2&Oe){const ve=t.XpG(4);t.Y8G("buttonTheme",ve.theme())}}function ne(Oe,Te){if(1&Oe){const ve=t.RV6();t.j41(0,"section",3)(1,"h2",5),t.EFF(2,"Profiler"),t.k0s(),t.j41(3,"form",9)(4,"div",10)(5,"app-form-field",11)(6,"select",12)(7,"option",13),t.EFF(8,"DOM"),t.k0s(),t.j41(9,"option",14),t.EFF(10,"Markers"),t.k0s(),t.j41(11,"option",15),t.EFF(12,"None"),t.k0s()()(),t.j41(13,"app-form-field",16)(14,"mat-checkbox",17),t.EFF(15," Hover Pick Enabled "),t.k0s()()(),t.j41(16,"div",18)(17,"button",19),t.bIt("click",function(){t.eBV(ve);const we=t.XpG(3);return t.Njj(we.toggleCaptureClick())}),t.EFF(18),t.k0s(),t.DNE(19,he,2,1,"button",20),t.k0s()()(),t.j41(20,"section",3)(21,"h2",5),t.EFF(22,"Tools"),t.k0s(),t.j41(23,"div",18)(24,"button",19),t.bIt("click",function(){t.eBV(ve);const we=t.XpG(3);return t.Njj(we.rayPickClick())}),t.EFF(25," Start Ray Picking "),t.k0s(),t.j41(26,"button",21),t.bIt("click",function(){t.eBV(ve);const we=t.XpG(3);return t.Njj(we.runSpectorJSClick())}),t.EFF(27," Run SpectorJS "),t.k0s()()()}if(2&Oe){const ve=t.XpG(3);t.R7$(3),t.Y8G("formGroup",ve.form),t.R7$(2),t.Y8G("isCompact",!0),t.R7$(8),t.Y8G("isCompact",!0),t.R7$(4),t.Y8G("buttonTheme",ve.theme())("disabled",ve.rayPicking),t.R7$(),t.SpI(" ",ve.capturing?"Stop":"Start"," Capture "),t.R7$(),t.vxM(!ve.capturing&&ve.capturedStats.length>0?19:-1),t.R7$(5),t.Y8G("buttonTheme",ve.theme())("disabled",ve.capturing||ve.rayPicking),t.R7$(2),t.Y8G("buttonTheme",ve.theme())}}function _e(Oe,Te){if(1&Oe&&t.DNE(0,Y,22,24,"section",3)(1,ne,28,10),2&Oe){const ve=t.XpG(2);t.vxM(null!=ve.currentAppStat&&ve.currentAppStat.memoryUsage?0:-1),t.R7$(),t.vxM(ve.showAdvancedTools()?1:-1)}}function Ce(Oe,Te){if(1&Oe&&(t.j41(0,"div",0),t.DNE(1,X,4,1,"a",1),t.j41(2,"div",2)(3,"section",3)(4,"table",4)(5,"caption",5),t.EFF(6," Per Module "),t.k0s(),t.j41(7,"tr")(8,"th",6),t.EFF(9),t.k0s(),t.j41(10,"td"),t.EFF(11),t.nI1(12,"number"),t.k0s()(),t.j41(13,"tr")(14,"th",6),t.EFF(15),t.k0s(),t.j41(16,"td"),t.EFF(17),t.nI1(18,"number"),t.k0s()(),t.j41(19,"tr")(20,"th",6),t.EFF(21),t.k0s(),t.j41(22,"td"),t.EFF(23),t.nI1(24,"number"),t.k0s()(),t.j41(25,"tr")(26,"th",6),t.EFF(27),t.k0s(),t.j41(28,"td"),t.EFF(29),t.nI1(30,"number"),t.k0s()(),t.j41(31,"tr")(32,"th",6),t.EFF(33),t.k0s(),t.j41(34,"td"),t.EFF(35),t.nI1(36,"number"),t.k0s()()()(),t.j41(37,"section",3)(38,"table",4)(39,"caption",5),t.EFF(40),t.k0s(),t.j41(41,"tr")(42,"th",6),t.EFF(43),t.k0s(),t.j41(44,"td"),t.EFF(45),t.nI1(46,"number"),t.k0s()(),t.j41(47,"tr")(48,"th",6),t.EFF(49),t.k0s(),t.j41(50,"td"),t.EFF(51),t.nI1(52,"number"),t.k0s()(),t.j41(53,"tr")(54,"th",6),t.EFF(55),t.k0s(),t.j41(56,"td"),t.EFF(57),t.nI1(58,"number"),t.k0s()(),t.j41(59,"tr")(60,"th",6),t.EFF(61),t.k0s(),t.j41(62,"td"),t.EFF(63),t.nI1(64,"number"),t.k0s()()()(),t.DNE(65,oe,28,32,"section",3)(66,_e,2,2),t.nI1(67,"async"),t.k0s()()),2&Oe){const ve=t.XpG();t.Y8G("ngClass",t.l_i(79,w,"light"===ve.theme(),"dark"===ve.theme())),t.R7$(),t.vxM(ve.enableAdvancedStats?1:-1),t.R7$(7),t.Y8G("matTooltip",ve.getStatDescription("totalVisibleLeafObjects")),t.R7$(),t.SpI(" ",ve.getStatTitle("totalVisibleLeafObjects")," "),t.R7$(),t.HbH(ve.getStatCSS("totalVisibleLeafObjects",ve.engineStats.totalVisibleLeafObjects)),t.R7$(),t.SpI(" ",t.i5U(12,50,ve.engineStats.totalVisibleLeafObjects,"1.0")," "),t.R7$(3),t.Y8G("matTooltip",ve.getStatDescription("geometries")),t.R7$(),t.SpI(" ",ve.getStatTitle("geometries")," "),t.R7$(),t.HbH(ve.getStatCSS("geometries",ve.engineStats.geometries)),t.R7$(),t.SpI(" ",t.i5U(18,53,ve.engineStats.geometries,"1.0")," "),t.R7$(3),t.Y8G("matTooltip",ve.getStatDescription("materials")),t.R7$(),t.SpI(" ",ve.getStatTitle("materials")," "),t.R7$(),t.HbH(ve.getStatCSS("materials",ve.engineStats.materials)),t.R7$(),t.SpI(" ",t.i5U(24,56,ve.engineStats.materials,"1.0")," "),t.R7$(3),t.Y8G("matTooltip",ve.getStatDescription("textures")),t.R7$(),t.SpI(" ",ve.getStatTitle("textures")," "),t.R7$(),t.HbH(ve.getStatCSS("textures",ve.engineStats.textures)),t.R7$(),t.SpI(" ",t.i5U(30,59,ve.engineStats.textures,"1.0")," "),t.R7$(3),t.Y8G("matTooltip",ve.getStatDescription("duration")),t.R7$(),t.SpI(" ",ve.getStatTitle("duration")," "),t.R7$(),t.HbH(ve.getStatCSS("duration",null==ve.currentAppStat?null:ve.currentAppStat.duration)),t.R7$(),t.SpI(" ",t.i5U(36,62,null==ve.currentAppStat?null:ve.currentAppStat.duration,"1.1-1")," "),t.R7$(5),t.SpI(" Per Frame",ve.statsCached?" (cached)":""," "),t.R7$(2),t.Y8G("matTooltip",ve.getStatDescription("drawCalls")),t.R7$(),t.SpI(" ",ve.getStatTitle("drawCalls")," "),t.R7$(),t.HbH(ve.getStatCSS("drawCalls",ve.engineStats.drawCalls)),t.R7$(),t.SpI(" ",t.i5U(46,65,ve.engineStats.drawCalls,"1.0")," "),t.R7$(3),t.Y8G("matTooltip",ve.getStatDescription("drawVertices")),t.R7$(),t.SpI(" ",ve.getStatTitle("drawVertices")," "),t.R7$(),t.HbH(ve.getStatCSS("drawVertices",ve.engineStats.drawVertices)),t.R7$(),t.SpI(" ",t.i5U(52,68,ve.engineStats.drawVertices,"1.0")," "),t.R7$(3),t.Y8G("matTooltip",ve.getStatDescription("cpuTime")),t.R7$(),t.SpI(" ",ve.getStatTitle("cpuTime")," "),t.R7$(),t.HbH(ve.getStatCSS("cpuTime",ve.engineStats.cpuTime)),t.R7$(),t.SpI(" ",t.i5U(58,71,ve.engineStats.cpuTime,"1.3-3")," "),t.R7$(3),t.Y8G("matTooltip",ve.getStatDescription("frameRate")),t.R7$(),t.SpI(" ",ve.getStatTitle("frameRate")," "),t.R7$(),t.HbH(ve.getStatCSS("frameRate",ve.engineStats.frameRate)),t.R7$(),t.SpI(" ",t.i5U(64,74,ve.engineStats.frameRate,"1.0-0")," "),t.R7$(2),t.vxM(ve.enableAdvancedStats?65:-1),t.R7$(),t.vxM(ve.enableAdvancedStats&&t.bMT(67,77,ve.chapterReady$)?66:-1)}}const Be=["cpuTime","gpuTime","postProcessTime","frameTime","frameRate"];class Ie{get engineStats(){return this.engineStats$.value}constructor(Te,ve,Ve,we,Je,tt,st){this.store=Te,this.engineService=ve,this.rendererService=Ve,this.markerService=we,this.storageService=Je,this.dialog=tt,this.changeRef=st,this.statsSupportUrl="https://www.notion.so/biodigital/Performance-Panel-Help-Doc-WIP-c0e54dfc39f2465383a18e33a97bdb4c",this.getStatTitle=ie,this.getStatDescription=se,this.enableAdvancedStats=!1,this.theme=(0,t.hFB)(r.P.Dark),this.showAdvancedTools=(0,t.hFB)(!0),this.capturedStats=[],this.engineStats$=new c.t(void 0),this.capturing=!1,this.rayPicking=!1,this.initialLabels=[],this.initialSceneMemory=0,this.initialMemoryByChapter={},this.peakMemoryByChapter={},this.chapterLoadStats={},this.ngUnsubscribe=new O.B,this.initState()}ngOnInit(){this.initFormListeners(),this.initStatsListeners(),this.initMemoryListeners();const Te=new URLSearchParams(window.location.search),ve="true"===Te.get("ui-stats-capture"),Ve="false"!==Te.get("ui-stats-hover"),we=Te.get("ui-stats-label")||"dom";this.form.setValue({hoverPickEnabled:Ve,labelsMode:we}),ve&&this.toggleCapture(!0),this.enableAdvancedStats=V.c.application===$.c.Loft||V.c.deploy!==W.Z.Production||"true"===this.storageService.getLocalItem(x.UT.EnableAdvancedStats),this.changeRef.markForCheck()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}rayPickClick(){confirm("Please note, this may take upto 10+ seconds to run and will lock your browser temporarily. Continue?")&&(this.rayPicking=!0,this.changeRef.markForCheck(),setTimeout(()=>{this.runRayPickSuite().then(Te=>{this.rayPicking=!1,this.changeRef.markForCheck();const{startMemoryUsage:ve,endMemoryUsage:Ve,meanRayPickTime:we}=Te,Je={startMemoryUsage:`${ve.toFixed(0)} MB`,endMemoryUsage:`${Ve.toFixed(0)} MB`,meanRayPickTime:`${we.toFixed(2)} ms`};alert(JSON.stringify(Je,null,2))})},1))}runRayPickSuite(){var Te=this;return(0,e.A)(function*(){return new Promise(ve=>{const{offsetWidth:Ve,offsetHeight:we}=Te.rendererService.getCanvas(),Je=Te.currentAppStat.memoryUsage,tt=[];for(let rt=0;rt<we;rt+=5)for(let Ke=0;Ke<Ve;Ke+=5){const et=performance.now();Te.rendererService.pick(Ke,rt,!0);const Ee=performance.now()-et;tt.push(Ee)}const st=(0,G.mean)(tt);tt.length=0,setTimeout(()=>{ve({startMemoryUsage:Je,endMemoryUsage:Te.currentAppStat.memoryUsage,meanRayPickTime:st})},1e3)})})()}toggleCaptureClick(){if(!this.capturing&&confirm("Do you want to reload the page to ensure accurate profiling? Otherwise the profiler will start immediately.")){const{hoverPickEnabled:ve,labelsMode:Ve}=this.form.value,we=new URLSearchParams(window.location.search);we.set("ui-stats-capture","true"),we.set("ui-stats-hover",`${ve}`),we.set("ui-stats-label",`${Ve}`);const Je=`${location.pathname}?${we.toString()}`;window.location.href=Je}else this.toggleCapture(!this.capturing)}toggleCapture(Te){this.capturing=Te,this.capturing?(this.capturedStats.length=0,this.capturing=!0):(this.capturing=!1,this.viewReport()),this.changeRef.markForCheck()}getStatCSS(Te,ve){return["engine-stats-row",`engine-stats-row--${Z(Te,ve)}`]}runSpectorJSClick(){this.runSpectorJS()}runSpectorJS(){var Te=this;return(0,e.A)(function*(){n.e(492).then(n.t.bind(n,47492,23)).then(({EmbeddedFrontend:ve,Spector:Ve})=>{Te.spector||(Te.spector=new Ve,Te.spector.onCapture.add(Je=>{console.log("specture captured",Je,Te.spector),console.log({EmbeddedFrontend:ve});const tt=new ve.ResultView;tt.display(),tt.addCapture(Je)}),Te.spector.onError.add(Je=>{console.warn("specture error",Je,Te.spector)})),Te.spector.captureNextFrame(Te.engineService.engine.renderer.canvas,!1)})})()}viewReportClick(){var Te=this;return(0,e.A)(function*(){Te.viewReport()})()}viewReport(){var Te=this;return(0,e.A)(function*(){const ve=Te.capturedStats,Ve=Te.store.selectSnapshot(R.N.getStoryChapters),{StatsDialogComponent:we}=yield n.e(608).then(n.bind(n,36608));Te.dialog.open(we,{width:"90vw",panelClass:"bd-publish-dialog-panel",data:{chapters:Ve,appStats:ve,chapterLoadStats:Te.chapterLoadStats}}).afterClosed().pipe((0,P.Q)(Te.ngUnsubscribe)).subscribe()})()}initState(){const Te=performance?.memory?.usedJSHeapSize??0;this.initialSceneMemory=d(Te),this.form=new A.gE({hoverPickEnabled:new A.MJ(!0),labelsMode:new A.MJ("dom")}),this.store.select(l.y.getLabels).pipe((0,S.p)(ve=>ve?.length>0),(0,a.s)(1),(0,P.Q)(this.ngUnsubscribe)).subscribe(ve=>{this.initialLabels=ve;const{labelsMode:Ve}=this.form.value;this.toggleLabelsMode(Ve)})}initFormListeners(){this.form.valueChanges.pipe((0,f.T)(Te=>Te.hoverPickEnabled),(0,E.F)(),(0,P.Q)(this.ngUnsubscribe)).subscribe(Te=>{this.toggleHoverPick(Te)}),this.form.valueChanges.pipe((0,f.T)(Te=>Te.labelsMode),(0,E.F)(),(0,P.Q)(this.ngUnsubscribe)).subscribe(Te=>{this.toggleLabelsMode(Te)})}initStatsListeners(){this.engineService.getEvent(T.X.AssetsLoadProgress).pipe((0,P.Q)(this.ngUnsubscribe)).subscribe(Te=>{const{chapterId:ve,chapterProgress:Ve}=Te,we=this.chapterLoadStats[ve]??{chapterId:ve,startTime:performance.now()};1===Ve&&(we.endTime=performance.now(),we.duration=(we.endTime-we.startTime)/1e3),this.chapterLoadStats[ve]=we}),this.engineService.engineCreated$.pipe((0,y.Z)(Te=>{const ve=this.engineService.server;return function v(Oe,Te){const{renderer:ve}=Oe;return new p.c(Ve=>{let we=performance.now(),Je=we,tt=0,st=0,rt=0,Ke=0,et=0,ge=0,Ee=0,Fe=0,$e=0,ot=0,je=0;const xe=function(){var Ue=(0,e.A)(function*(){st++;const Ne=performance.now();tt=Ne-we,Ne>=Je+1e3&&(Ke=1e3*st/(Ne-Je),Je=Ne,st=0),we=Ne;const Xe=performance?.memory?.usedJSHeapSize??0;rt=d(Xe),Fe=d(Te?.dataSize?.material??0),$e=d(Te?.dataSize?.morph??0),ot=d(Te?.dataSize?.geometry??0),je=d(Te?.dataSize?.transform??0),Ve.next({...ve.stats,totalObjects:et,totalLeafObjects:ge,totalVisibleLeafObjects:Ee,frameRate:Ke,frameTime:tt,memoryUsage:rt,downloadMaterial:Fe,downloadMorph:$e,downloadGeometry:ot,downloadTransform:je})});return function(){return Ue.apply(this,arguments)}}(),Me=()=>{Oe&&(Oe.off("destroy",Me),ve.off("end",xe)),Ve.next({...ve.stats,totalObjects:et,totalLeafObjects:ge,totalVisibleLeafObjects:Ee,frameRate:Ke,frameTime:tt,memoryUsage:rt,downloadMaterial:Fe,downloadMorph:$e,downloadGeometry:ot,downloadTransform:je}),Ve.complete()};ve.on("end",xe),Oe.on("changestory",()=>{const{anatomyObjects:Ue}=Oe.story.anatomySceneGraph;et=Ue.size;const Ne=()=>{ge=0,Ee=0,Ue.forEach(be=>{!be.children?.length&&(ge++,be.shown&&Ee++)})},Xe=be=>{"shown"===be?.property&&Ne()};Ne(),Ue.forEach(be=>{be.on("change",Xe)})}),Oe.on("destroy",Me),Ve.add(Me)})}(Te,ve instanceof z.BioDigitalWebSocketServer?ve:void 0)}),(0,i.Z)(100),(0,P.Q)(this.ngUnsubscribe)).subscribe(Te=>{this.statsCached=!1;const ve=this.engineStats,Ve=Object.entries(Te).reduce((we,[Je,tt])=>{const st=Je;if(!Be.includes(st)){const rt=ve?.[st];!tt&&rt&&(we[st]=rt,this.statsCached=!0)}return we},{...ve,...Te});this.engineStats$.next(Ve),this.changeRef.markForCheck()})}initMemoryListeners(){(0,g.z)([this.engineStats$,this.chapterId$,this.chapterReady$]).pipe((0,S.p)(([Te,,ve])=>!(0,G.isNil)(Te)&&ve),(0,P.Q)(this.ngUnsubscribe)).subscribe(([Te,ve])=>{const Ve=this.initialSceneMemory,we=Te.memoryUsage,Je=we-Ve;this.initialMemoryByChapter[ve]=this.initialMemoryByChapter[ve]??we;const rt=Math.max(this.peakMemoryByChapter[ve]??0,we);this.peakMemoryByChapter[ve]=rt;const Ke=Object.values(this.peakMemoryByChapter).reduce((ot,je)=>Math.max(ot,je),0),et={chapterInitialMemory:this.initialMemoryByChapter[ve],chapterPeakMemory:this.peakMemoryByChapter[ve],chapterDeltaMemory:Je,sceneInitialMemory:Ve,scenePeakMemory:Ke},ge=this.chapterLoadStats[ve]??{},Ee=performance.now(),{labelsMode:Fe,hoverPickEnabled:$e}=this.form.value;this.currentAppStat={...Te,...ge,...et,timestamp:Ee,chapterId:ve,labelsMode:Fe,hoverPickEnabled:$e},this.capturing&&this.capturedStats.push(this.currentAppStat),this.changeRef.markForCheck()})}toggleLabelsMode(Te){switch(this.store.dispatch(new u.gJ([])),this.markerService.deleteMarkers(),Te){case"dom":this.store.dispatch(new u.gJ(this.initialLabels));break;case"marker":this.initialLabels.forEach(ve=>this.markerService.createMarker(ve))}}toggleHoverPick(Te){this.store.dispatch(new k.Pk({hoverEnabled:Te}))}static#e=this.\u0275fac=function(ve){return new(ve||Ie)(t.rXU(_.il),t.rXU(s.y),t.rXU(C.z),t.rXU(m.m),t.rXU(x.n$),t.rXU(ce.bZ),t.rXU(t.gRc))};static#t=this.\u0275cmp=t.VBU({type:Ie,selectors:[["app-engine-stats"]],inputs:{theme:[1,"theme"],showAdvancedTools:[1,"showAdvancedTools"]},standalone:!0,features:[t.aNF],decls:1,vars:1,consts:[[1,"engine-stats",3,"ngClass"],["target","_blank","rel","noreferrer nofollow",1,"self-end","text-xs","font-semibold","text-link"],[1,"engine-stats__sections"],[1,"engine-stats__section"],[1,"engine-stats__table"],[1,"engine-stats__section-header"],["scope","row","matTooltipPosition","left",3,"matTooltip"],[1,"text-underline"],["icon","arrow-up-right-from-square",1,"ml-1"],[1,"flex","flex-col","text-xs",3,"formGroup"],[1,"flex","flex-row","justify-between"],["label","Labels",1,"my-1",3,"isCompact"],["formControlName","labelsMode",1,"input"],["value","dom",1,"my-1"],["value","marker",1,"my-1"],["value","none",1,"my-1"],["label","Input",1,"my-1","ml-1",3,"isCompact"],["formControlName","hoverPickEnabled"],[1,"my-1","engine-stats__buttons"],["type","button","app-button","","buttonType","outline","buttonSize","sm",3,"click","buttonTheme","disabled"],["type","button","app-button","","buttonType","outline","buttonSize","sm",3,"buttonTheme"],["type","button","app-button","","buttonType","outline","buttonSize","sm",3,"click","buttonTheme"]],template:function(ve,Ve){1&ve&&t.DNE(0,Ce,68,82,"div",0),2&ve&&t.vxM(Ve.engineStats?0:-1)},dependencies:[de.MD,de.YU,de.Jj,de.QX,A.X1,A.qT,A.xH,A.y7,A.wz,A.BC,A.cb,A.j4,A.JD,ae.D,re.K,K.So,M.oV,q.C,ue.Q,j.o,H.R],styles:[":root{--engine-stats-color: #374a68;--engine-stats-background-color: #ffffff;--engine-stats-border-color: #eaeff5}.engine-stats{display:flex;flex-direction:column;padding:8px;text-align:left;border-radius:4px;color:var(--engine-stats-color);background-color:var(--engine-stats-background-color);border:1px solid var(--engine-stats-border-color)}.engine-stats__sections{display:flex;flex-direction:column;gap:16px}.engine-stats__section{display:flex;flex-direction:column;font-size:.75rem;line-height:1rem}.engine-stats__section-header{padding-top:.25rem;padding-bottom:.25rem;text-align:left;font-size:.875rem;line-height:1.25rem;font-weight:600}.engine-stats__buttons{display:flex;flex-direction:column;gap:8px}.engine-stats table th{width:60%;border-right:1px solid var(--engine-stats-border-color);font-weight:500;text-align:right}.engine-stats table td{font-weight:600}.engine-stats table th,.engine-stats table td{padding:2px 4px}.engine-stats table tr{border-top:1px solid var(--engine-stats-border-color);border-bottom:1px solid var(--engine-stats-border-color);border-collapse:collapse}.engine-stats-row--warning{background-color:#ffb92e;color:#374a68}.engine-stats-row--danger{background-color:#de3535;color:#d7e0ea}.engine-stats--dark{--engine-stats-color: #d7e0ea;--engine-stats-background-color: #283853;--engine-stats-border-color: #1c2a3f}.engine-stats--advanced{width:260px}\n"],encapsulation:2,changeDetection:0})}te([(0,_.l6)(b.S.getChapter),F("design:type",p.c)],Ie.prototype,"chapterId$",void 0),te([(0,_.l6)(R.N.getSelectedChapterModelReady),F("design:type",p.c)],Ie.prototype,"chapterReady$",void 0)},18171:(le,N,n)=>{"use strict";n.d(N,{j:()=>C});var e=n(21164),t=n(62943),s=n(8358),c=n(49204),O=n(76872),P=n(92677),S=n(65881);const a={enabled:!1,clips:{left:{clipId:0,enabled:!1,fade:!1,fadeDistance:0,progress:0},right:{clipId:1,enabled:!1,fade:!1,fadeDistance:0,progress:0},back:{clipId:5,enabled:!1,fade:!1,fadeDistance:0,progress:0},front:{clipId:4,enabled:!1,fade:!1,fadeDistance:0,progress:0},top:{clipId:3,enabled:!1,fade:!1,fadeDistance:0,progress:0},bottom:{clipId:2,enabled:!1,fade:!1,fadeDistance:0,progress:0}}};var f=n(53799),E=n(29284),y=n(23881),i=n(44867),g=n(13491),p=n(35650),h=n(60286),o=n(62751),v=n(11724),d=n(63508),r=n(92333),_=n(76774),u=n(17766),l=n(13976),m=n(54438);let C=(()=>{class b{constructor(A,G,k,V,W){this.serializeChapterService=A,this.labelService=G,this.paintService=k,this.sceneService=V,this.contentBlocksService=W}processChapterForEngine(A){const G=(0,S.S)([A],!1),W=this.sceneService.getRootObjects(),T=(0,y.ow)(this.paintService.getColorRecipes()),x=(0,i.fm)(W,T);return{...this.serializeChapterService.serializeChapter(x,A,{},[],G,!1),sliderLayers:A.sliderLayers}}copyChapter(A,G){const k=(0,c.cloneDeep)(A);return k.id=G,k.readyState={model:!0,animation:!1},k}getChapter(A,G,k,V,W){const T=V.id||(0,S.G)();let x;(0,c.isNil)(V.background)||(x=(0,t.iu)(V.background));const z=V.transparencyMode||v.TransparencyModeEnum.Alpha,I=this.deserializeCamera(V);let D=!1;const L=V.timelineMap;let Q;L.forEach(ne=>{"dummy"!==ne.name&&"dummy"!==ne.data.timeline&&(D=!0)});const ie=V.animation?.loop??G.animation?.loop??!1;if(V.ui&&!(0,c.isEmpty)(V.ui))Q=V.ui;else{let ne=0;D&&ie?ne=-1:D&&!ie&&(ne=1),Q={play:{count:ne}}}const se=O.D.Annotation,Z=[...V.annotations||[]].map(ne=>this.labelService.deserializeAnnotation(ne,V,se)),de=[],q=this.groupHotspots([...V.hotspots||[]].filter(ne=>{const _e=this.labelService.filterHotspot(G,V,ne);return _e?ne.theme||(ne.theme=k===u.c.Module?P.T.studioNext:P.T.classicHotspot):de.push(ne),_e})).map(ne=>this.labelService.deserializeHotspots(G,V,W,...ne)),K=V.labels?.length>0?V.labels:[...Z,...q],j=de,M=(0,c.isEmpty)(V.clippingPlanes)?a:this.sanitizeClippingPlanes(V.clippingPlanes),$=this.deserializeContentBlocks(V.contentBlocks),ce=V.legend??[],ue=(V.quizQuestions??[]).map(ne=>(0,_.z9)(ne,ne.id,V.id)),H=V.media??{};Object.values(H).forEach(ne=>{ne&&(0,c.isEmpty)(ne.lang)&&(ne.lang="en")});const F=V.thumbnails,w=A.map(ne=>ne.objectId),{availableObjects:X,showObjects:oe}=V,Y=(0,c.isEmpty)(X)?(0,i.K$)(w,oe,X):X;return{...V,id:T,background:x,camera:I,timelineMap:L,loop:ie,ui:Q,labels:K,hotspots:j,clippingPlanes:M,contentBlocks:$,legend:ce,quizQuestions:ue,media:H,readyState:{model:!1,animation:!1},thumbnails:F,transparencyMode:z,sliderLayers:{src:{},currentLayers:{},sourceLayerGroups:[],currentLayerGroups:[]},availableObjects:Y}}deserializeContentBlocks(A=[]){return A.map(G=>(this.contentBlocksService.isTickerBlock(G)&&(G.enable=G.enable??!0),G))}deserializeCamera(A){const G=A.jumpTo?o.L.JumpTo:o.L.FlyTo,{eye:k,look:V,up:W,title:T}=A[G],x={action:G,location:{eye:k,look:V,up:W},title:T??r.y};return A.cameraRotationCenter&&(x.rotationCenter=A.cameraRotationCenter),A.camera&&Array.isArray(A.camera.rotationCenter)&&(x.rotationCenter=g.n.fromArray(A.camera.rotationCenter)),x}getChapterTweenStates(A){const G=A.timelineMap.filter(k=>"dummy"!==k.data.timeline).map(k=>k.data.timeline);return Array.from(new Set(G))}getChapterLightLibraries(A){return(0,d.Uv)(A)?(A.lights?.libraries??[]).filter(k=>"default"!==k):[]}getChapterReflectionLibraries(A){if((0,d.Uv)(A)){const k=A.environment&&A.environment.reflectionMap||[],V=T=>T.split(".")[0],W=(A.environment&&A.environment.lightMap||[]).map(V).concat(k.map(V));return Array.from(new Set(W))}return[]}hasVisibilityLayers(A){return Array.isArray(A)&&A.length>0}buildVisibilityLayers(A){const G=A.visibilityLayers,k=A.showObjects,V={src:G,currentLayers:{},sourceLayerGroups:[],currentLayerGroups:[]};if(G&&this.hasVisibilityLayers(G.layers)){const W=G.initIndex||0,T=this.unpackLayers(G.layers),x=this.buildShownObjectsSet(k),z=this.buildCurrentLayers(T,x),I=this.buildLayerGrouping(z);V.src={layers:G.layers,initIndex:W},V.currentLayers={layers:z,index:W,position:0},V.sourceLayerGroups=(0,c.cloneDeep)(I),V.currentLayerGroups=(0,c.cloneDeep)(I)}return V}buildShownObjectsSet(A){const G=this.sceneService.getSceneGraph(this.sceneService.getRootObjects()),k=Object.keys(G.nodes).filter(V=>(0,E.BK)(G,V,A)||(0,E._x)(G,V,A));return new Set(k)}unpackLayers(A){const G=[];return A.forEach(k=>{let V=[];k.objectIds.forEach(T=>{const x=this.sceneService.getObjectById(T);if(x){const z=this.sceneService.getLeaves(x.objectId);V=V.concat(z.map(I=>I.objectId))}}),G.push({name:k.name,objectIds:V})}),G}buildCurrentLayers(A,G){const k=[];return A.forEach((V,W)=>{let T=!1;V.objectIds.forEach(x=>{G.has(x)&&(T?k[k.length-1].objectIds.push(x):(k.push({name:A[W].name,objectIds:[x]}),T=!0))})}),k}buildLayerGrouping(A){return A.reduce((G,k,V)=>{const{name:W}=k;let T=G.find(x=>x.name===W);return T||(T={name:W,position:0,layers:[]},G.push(T)),T.layers.push(k),T.position=T.layers.length,G},[])}sanitizeClippingPlanes(A){const G=Object.values(A.clips).some(V=>V.progress>0),k=(0,c.mapKeys)(A.clips,(V,W)=>f.s[W]||W);return{...A,clips:k,enabled:G}}groupHotspots(A){const G={},k=W=>W.primitiveIndex?W.primitiveIndex.toFixed(0):W.pos?W.pos.map(T=>T.toFixed(3)).join(":"):Math.random().toFixed(3),V=W=>RegExp("^circle-(plus|minus)").test(W)?"pair":"single";return A.forEach(W=>{const T=[V(W.type),W.objectId,k(W)].join("|");T in G?G[T].push(W):G[T]=[W]}),Object.values(G)}static#e=this.\u0275fac=function(G){return new(G||b)(m.KVO(e.p),m.KVO(s.x),m.KVO(h.s),m.KVO(p.w),m.KVO(l.V))};static#t=this.\u0275prov=m.jDH({token:b,factory:b.\u0275fac,providedIn:"root"})}return b})()},44461:(le,N,n)=>{"use strict";n.d(N,{B:()=>re});var e=n(28407),s=(n(69568),n(92014)),c=n(76304),O=n(85052),P=n(2573),S=n(49204),a=n(37925),f=n(47610),E=n(38753),y=n(35650),i=n(38104),g=n(15623),p=n(34006),h=n(95419),o=n(54438),v=n(60177),d=n(21007),r=n(49989),_=n(26779),u=n(35286);function l(ue,H){if(1&ue){const te=o.RV6();o.j41(0,"button",9),o.bIt("click",function(){o.eBV(te);const w=o.XpG();return o.Njj(w.playAudio())}),o.nrm(1,"app-icon",10),o.k0s()}}function m(ue,H){if(1&ue&&(o.j41(0,"div",11),o.EFF(1),o.k0s()),2&ue){const te=o.XpG();o.R7$(),o.JRh(te.latinLabel)}}function C(ue,H){if(1&ue&&(o.nrm(0,"div",12),o.nI1(1,"markdown"),o.nI1(2,"async")),2&ue){const te=o.XpG();o.Y8G("innerHTML",o.bMT(2,3,o.bMT(1,1,te.description)),o.npT)}}let b=(()=>{class ue{constructor(te,F,w){this.dialogRef=te,this.mediaService=F,this.data=w,this.title=w.title,this.audioPlayer=w.audioPlayer,this.latinLabel=w.latinLabel,this.description=w.description}ngOnDestroy(){this.audioPlayer&&(this.audioPlayer=null)}handleCloseClick(){this.dialogRef.close()}playAudio(){this.mediaService.stopAllAudio(),this.audioPlayer.play()}static#e=this.\u0275fac=function(F){return new(F||ue)(o.rXU(p.CP),o.rXU(h.u),o.rXU(p.Vh))};static#t=this.\u0275cmp=o.VBU({type:ue,selectors:[["app-context-label-dialog"]],decls:11,vars:9,consts:[[1,"context-label-dialog","flex","flex-col"],[1,"flex","flex-row","justify-between","items-start"],[1,"flex","flex-row","items-start"],[1,"context-label-dialog__title","mt-2","mr-2",3,"innerHTML"],["class","context-label-dialog__audio","type","button","app-button","","buttonTheme","light","buttonSize","md",3,"click",4,"ngIf"],["app-button","","buttonType","text","buttonTheme","light","type","button","title","Close",1,"context-label-dialog__close",3,"click"],["icon","times","size","lg"],["class","context-label-dialog__latin-label mt-1",4,"ngIf"],["class","context-label-dialog__description mt-6",3,"innerHTML",4,"ngIf"],["type","button","app-button","","buttonTheme","light","buttonSize","md",1,"context-label-dialog__audio",3,"click"],["icon","volume-up","appLogicalDir",""],[1,"context-label-dialog__latin-label","mt-1"],[1,"context-label-dialog__description","mt-6",3,"innerHTML"]],template:function(F,w){1&F&&(o.j41(0,"div",0)(1,"div",1)(2,"div",2),o.nrm(3,"div",3),o.nI1(4,"markdown"),o.nI1(5,"async"),o.DNE(6,l,2,0,"button",4),o.k0s(),o.j41(7,"button",5),o.bIt("click",function(){return w.handleCloseClick()}),o.nrm(8,"app-icon",6),o.k0s()(),o.DNE(9,m,2,1,"div",7)(10,C,3,5,"div",8),o.k0s()),2&F&&(o.R7$(3),o.Y8G("innerHTML",o.bMT(5,7,o.bMT(4,5,w.title)),o.npT),o.R7$(3),o.Y8G("ngIf",w.audioPlayer),o.R7$(),o.BMQ("aria-label","Close"),o.R7$(2),o.Y8G("ngIf",w.latinLabel),o.R7$(),o.Y8G("ngIf",w.description))},dependencies:[v.bT,d.Q,r.e,_.R,v.Jj,u.i0],styles:[".context-label-dialog{height:100%;padding:24px}.context-label-dialog__title{font-weight:700;font-size:20px;word-break:break-word}.context-label-dialog__latin-label{font-style:italic;font-weight:400;font-size:14px;letter-spacing:.02em}.context-label-dialog__description{font-size:14px;line-height:20px;overflow:auto;margin-right:-24px;padding-right:24px}.context-label-dialog__description p{padding-bottom:12px}\n"],encapsulation:2})}return ue})();var R=n(61295),A=n(94604),G=n(59429),k=n(68947),V=n(11040),W=n(22397),T=n(22679),x=n(17766),z=n(5393),I=n(24125),D=n(72026),L=n(59115),Q=n(89511),ie=n(11818),se=function(ue,H,te,F){var oe,w=arguments.length,X=w<3?H:null===F?F=Object.getOwnPropertyDescriptor(H,te):F;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)X=Reflect.decorate(ue,H,te,F);else for(var Y=ue.length-1;Y>=0;Y--)(oe=ue[Y])&&(X=(w<3?oe(X):w>3?oe(H,te,X):oe(H,te))||X);return w>3&&X&&Object.defineProperty(H,te,X),X},Z=function(ue,H){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(ue,H)};const de=["labelDescription"];function ae(ue,H){if(1&ue){const te=o.RV6();o.j41(0,"button",20),o.bIt("click",function(){o.eBV(te);const w=o.XpG(2);return o.Njj(w.playAudio())}),o.nrm(1,"app-icon",21),o.k0s()}if(2&ue){const te=o.XpG(2);o.Y8G("disabled",te.audioPlayerLoading)}}function q(ue,H){if(1&ue){const te=o.RV6();o.j41(0,"button",22),o.bIt("click",function(){o.eBV(te);const w=o.XpG(2);return o.Njj(w.handleReadMoreClick())}),o.nrm(1,"app-icon",23),o.k0s()}if(2&ue){const te=o.XpG(2);o.R7$(),o.AVh("context-label__info--expanded",te.expanded)}}function K(ue,H){if(1&ue&&(o.j41(0,"div",17),o.DNE(1,ae,2,1,"button",18)(2,q,2,2,"button",19),o.k0s()),2&ue){const te=o.XpG();o.R7$(),o.Y8G("ngIf",te.enableAudio),o.R7$(),o.Y8G("ngIf",te.enableInfo&&(null==te.node||null==te.node.info?null:te.node.info.description))}}function j(ue,H){if(1&ue&&(o.j41(0,"i",24),o.EFF(1),o.k0s()),2&ue){const te=o.XpG();o.R7$(),o.SpI(" ",te.node.info.latinLabel," ")}}function M(ue,H){if(1&ue){const te=o.RV6();o.j41(0,"div",25,2),o.nI1(2,"markdown"),o.nI1(3,"async"),o.bIt("pointerdown",function(w){o.eBV(te);const X=o.XpG();return o.Njj(X.handleDescriptionPointerDown(w))})("wheel",function(w){o.eBV(te);const X=o.XpG();return o.Njj(X.stopPropagation(w))}),o.k0s()}if(2&ue){const te=o.XpG();o.AVh("context-label__description--expanded",te.expanded),o.Y8G("innerHTML",o.bMT(3,5,o.bMT(2,3,te.node.info.description)),o.npT)}}function $(ue,H){if(1&ue){const te=o.RV6();o.j41(0,"div",26)(1,"button",27),o.bIt("click",function(){o.eBV(te);const w=o.XpG();return o.Njj(w.hideNode())}),o.pXf(2,5),o.k0s(),o.j41(3,"button",28),o.qex(4),o.pXf(5,6),o.bVm(),o.nrm(6,"app-icon",29),o.k0s(),o.j41(7,"button",27),o.bIt("click",function(){o.eBV(te);const w=o.XpG();return o.Njj(w.hideInverseNodes())}),o.pXf(8,7),o.k0s()()}if(2&ue){o.XpG();const te=o.sdS(12);o.R7$(3),o.Y8G("matMenuTriggerFor",te)}}const ce=["es-ES","en-US"];class re{set label(H){this._label=H,this.largeTitle=this._label.title.length>60,this.removeAudioPlayer(),this.setLabelNode(),this.changeDetectorRef.markForCheck()}get label(){return this._label}get enableAudio(){return ce.includes(this.localeCode)&&this._enableAudio}set enableAudio(H){this._enableAudio=H,this.removeAudioPlayer(),this.changeDetectorRef.markForCheck()}constructor(H,te,F,w,X,oe,Y,he,ne){this.store=H,this.actions=te,this.sceneService=F,this.dialog=w,this.nodeService=X,this.mediaService=oe,this.renderer2=Y,this.markdownService=he,this.changeDetectorRef=ne,this.largeTitle=!1,this.expanded=!1,this.ngUnsubscribe=new O.B,this.id=G.u.getUuid()}ngOnInit(){this.initInfoListeners(),this.initBreakpointListeners(),this.initLocale()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete(),this.removeAudioPlayer()}setLabelNode(){const H=(0,S.get)(this.label,"objectId");if(H){const te=this.store.selectSnapshot(c.S.getViewGraph);this.node=this.sceneService.getViewNode(te,H)}else this.node=null;this.expanded=!1,this.changeDetectorRef.markForCheck()}initInfoListeners(){this.actions.pipe((0,s.rM)(f.RV),(0,a.Q)(this.ngUnsubscribe)).subscribe(()=>{this.setLabelNode()})}initBreakpointListeners(){this.horizontalBreakpoint$.pipe((0,a.Q)(this.ngUnsubscribe)).subscribe(H=>{this.expanded&&(H<g.m.Large&&!this.curDialog?this.openContextLabelDialog():H>=g.m.Large&&this.curDialog&&this.curDialog?.close(!0))})}initLocale(){var H=this;return(0,e.A)(function*(){H.localeCode=yield H.getLocaleCode(),H.changeDetectorRef.markForCheck()})()}handleReadMoreClick(){this.node&&(this.expanded=!this.expanded,this.expanded&&this.store.selectSnapshot(i.V.getHorizontalBreakpoint)<g.m.Large&&this.openContextLabelDialog())}stopPropagation(H){H.stopPropagation()}handleDescriptionPointerDown(H){const te=this.labelDescription.nativeElement,F=te.offsetWidth-te.clientWidth;if(F>0){const X=te.getBoundingClientRect().right-F;H.clientX>X&&this.stopPropagation(H)}}playAudio(){var H=this;return(0,e.A)(function*(){(0,S.isNil)(H.audioPlayer)&&(yield H.setAudioPlayer(H.localeCode)),H.audioPlayer.stop(),H.audioPlayer.play()})()}setAudioPlayer(H){var te=this;return(0,e.A)(function*(){te.removeAudioPlayer(),te.audioPlayerLoading=!0,te.changeDetectorRef.markForCheck(),te.audioPlayer=yield te.mediaService.addAudioPlayer(te.id,te.getAudioSource(H),!1),te.audioPlayerLoading=!1,te.changeDetectorRef.markForCheck()})()}getAudioSource(H){var te=this;return(0,e.A)(function*(){const F=yield k.l.getPlainTextFromMarkdown(te.renderer2,te.markdownService,te._label.title,!0);return(0,W.R)(F,H)})()}getLocaleCode(){var H=this;return(0,e.A)(function*(){const te=H.store.selectSnapshot(T.t.getStoryInfo);let F=V.q.id;if(te.type===x.c.Bookmark){let X=H.store.selectSnapshot(T.t.getStory).chapters.map(oe=>oe.description||"").join(" ").trim();if(!X){const oe=H.store.selectSnapshot(c.S.getViewGraph);X=Object.values(oe.nodes).map(he=>he.label).join(", ").trim()}return(0,z.E)(X)}{const w=H.store.selectSnapshot(T.t.getStoryLanguage);F=(0,V.U1)(w).id}return F})()}removeAudioPlayer(){this.mediaService.removeAudioPlayer(this.id),this.audioPlayer=null}hideNode(){this.store.dispatch(new R.yr(!1,[this.node.id]))}fadeInverseNodes(){this.nodeService.fadeInverse([this.node.id])}fadeNode(){this.nodeService.fade([this.node.id])}hideInverseNodes(){this.nodeService.hideInverse([this.node.id])}openContextLabelDialog(){this.curDialog=this.dialog.open(b,{width:"calc(100% - 80px)",maxWidth:"100%",height:"calc(100% - 80px)",maxHeight:"100%",data:{title:this.label.title,audioPlayer:this.audioPlayer,latinLabel:this.node.info.latinLabel,description:this.node.info.description}}),this.curDialog.afterClosed().subscribe(H=>{this.curDialog=void 0,H||(this.expanded=!1,this.changeDetectorRef.markForCheck())})}static#e=this.\u0275fac=function(te){return new(te||re)(o.rXU(s.il),o.rXU(s.En),o.rXU(y.w),o.rXU(p.bZ),o.rXU(A.w),o.rXU(h.u),o.rXU(o.sFG),o.rXU(u.Rl),o.rXU(o.gRc))};static#t=this.\u0275cmp=o.VBU({type:re,selectors:[["app-context-label"]],viewQuery:function(te,F){if(1&te&&o.GBs(de,5),2&te){let w;o.mGM(w=o.lsd())&&(F.labelDescription=w.first)}},inputs:{label:"label",enableInfo:"enableInfo",enableActions:"enableActions",enableAudio:"enableAudio"},standalone:!0,features:[o.aNF],decls:17,vars:17,consts:()=>{let H,te,F,w,X;return H=$localize`:b759baf42e7a90ef5e8c645babba3f7737e6a5265489525302847889282: Fade This `,te=$localize`:1eeab5878ca4b21288c9610b9837d0cf81cc64a06683889227007993247: Fade Everything Else `,F=$localize`:ccf7390cbf933d13bbd3558c3f16040691f3f5c37951634674386802910: Hide `,w=$localize`:81d6fa1833302eff81aca2a44b472dbd23898f447797708308805705984:Fade`,X=$localize`:bfe7e779289d630d424893f857357ae741f6acfd8086714388799643845: Isolate `,[["title",""],["fadeActions","matMenu"],["labelDescription",""],H,te,F,w,X,[1,"context-label",3,"fixedScale","label"],["label-header","",1,"context-label__header","html",3,"innerHTML"],["class","context-label__actions","label-actions","",4,"ngIf"],["label-more",""],["class","context-label__latin",4,"ngIf"],["class","context-label__description",3,"context-label__description--expanded","innerHTML","pointerdown","wheel",4,"ngIf"],["class","context-label__node-actions",4,"ngIf"],["mat-menu-item","","data-test","nodeActionsFadeThis",3,"click"],["mat-menu-item","","data-test","nodeActionsFadeEverythingElse",3,"click"],["label-actions","",1,"context-label__actions"],["type","button","app-button","","buttonTheme","light","buttonSize","xs","buttonShape","square",3,"disabled","click",4,"ngIf"],["type","button","app-button","","buttonTheme","light","buttonSize","xs","buttonShape","square",3,"click",4,"ngIf"],["type","button","app-button","","buttonTheme","light","buttonSize","xs","buttonShape","square",3,"click","disabled"],["icon","volume-up","appLogicalDir",""],["type","button","app-button","","buttonTheme","light","buttonSize","xs","buttonShape","square",3,"click"],["icon","info-circle",1,"context-label__info"],[1,"context-label__latin"],[1,"context-label__description",3,"pointerdown","wheel","innerHTML"],[1,"context-label__node-actions"],["type","button","app-button","","buttonTheme","light","buttonSize","xs",1,"context-label__node-action",3,"click"],["type","button","app-button","","buttonTheme","light","buttonSize","xs",1,"context-label__node-action",3,"matMenuTriggerFor"],["icon","caret-down",1,"ml-1"]]},template:function(te,F){if(1&te){const w=o.RV6();o.j41(0,"app-generic-label",8),o.nI1(1,"async"),o.nrm(2,"div",9,0),o.nI1(4,"markdown"),o.nI1(5,"async"),o.DNE(6,K,3,2,"div",10),o.qex(7,11),o.DNE(8,j,2,1,"i",12)(9,M,4,7,"div",13)(10,$,9,1,"div",14),o.j41(11,"mat-menu",null,1)(13,"button",15),o.bIt("click",function(){return o.eBV(w),o.Njj(F.fadeNode())}),o.pXf(14,3),o.k0s(),o.j41(15,"button",16),o.bIt("click",function(){return o.eBV(w),o.Njj(F.fadeInverseNodes())}),o.pXf(16,4),o.k0s()(),o.bVm(),o.k0s()}2&te&&(o.AVh("context-label--expanded",F.expanded)("context-label--large",F.largeTitle),o.Y8G("fixedScale",o.bMT(1,11,F.labelScale$))("label",F.label),o.R7$(2),o.Y8G("innerHTML",o.bMT(5,15,o.bMT(4,13,F.label.title)),o.npT),o.R7$(4),o.Y8G("ngIf",F.node),o.R7$(2),o.Y8G("ngIf",F.node&&(null==F.node.info?null:F.node.info.latinLabel)),o.R7$(),o.Y8G("ngIf",F.enableInfo&&(null==F.node||null==F.node.info?null:F.node.info.description)),o.R7$(),o.Y8G("ngIf",F.node))},dependencies:[v.MD,v.bT,v.Jj,L.Cn,L.kk,L.fb,L.Cp,D.o,_.R,u.y2,u.i0,Q.h,r.e,ie.C,d.Q,I.P],styles:[".context-label[_ngcontent-%COMP%]{z-index:12}.context-label__header[_ngcontent-%COMP%]{word-break:break-word}.context-label__actions[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;gap:4px;min-height:24px}.context-label__info--expanded[_ngcontent-%COMP%]{color:#2d72dc}.context-label__latin[_ngcontent-%COMP%]{display:block;padding:0 8px 4px;font-size:.625rem;line-height:.75rem;font-style:italic}.context-label__description[_ngcontent-%COMP%]{max-height:0;margin:0;overflow:auto;font-size:12px;line-height:18px;transition:max-height .25s,margin .25s}.context-label__node-actions[_ngcontent-%COMP%]{display:flex;border-top:1px solid rgba(16,24,35,.5);margin-top:4px;white-space:nowrap}.context-label__node-action[_ngcontent-%COMP%]{border-radius:0;border-inline-end:1px solid rgba(16,24,35,.5);flex:1}.context-label__node-action[_ngcontent-%COMP%]:last-child{border-inline-end:0}@media (min-width: 960px){.context-label__description--expanded[_ngcontent-%COMP%]{margin:8px;max-height:200px}}"],changeDetection:0})}se([(0,s.l6)(c.S.getQuerying),Z("design:type",P.c)],re.prototype,"querying$",void 0),se([(0,s.l6)(E.y.getLabelScale),Z("design:type",P.c)],re.prototype,"labelScale$",void 0),se([(0,s.l6)(i.V.getHorizontalBreakpoint),Z("design:type",P.c)],re.prototype,"horizontalBreakpoint$",void 0)},24125:(le,N,n)=>{"use strict";n.d(N,{P:()=>F});var e=n(54438),t=n(92014),s=n(37925),c=n(14264),O=n(21082),P=n(36110),S=n(76304),a=n(79805),f=n(85052),E=n(76718),y=n(2573),i=n(28931),p=n(3266),h=n(24151),o=n(79817),v=n(76872),d=n(38157),r=n(49204),u=n(515),l=n(8358),m=n(94495),C=n(11789),b=n(48030),R=n(82323),A=n(3367),G=n(46799),k=n(11040),V=n(60177),W=n(26513),T=function(w,X,oe,Y){var _e,he=arguments.length,ne=he<3?X:null===Y?Y=Object.getOwnPropertyDescriptor(X,oe):Y;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)ne=Reflect.decorate(w,X,oe,Y);else for(var Ce=w.length-1;Ce>=0;Ce--)(_e=w[Ce])&&(ne=(he<3?_e(ne):he>3?_e(X,oe,ne):_e(X,oe))||ne);return he>3&&ne&&Object.defineProperty(X,oe,ne),ne},x=function(w,X){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(w,X)};const z=["labelContainerEl"],I=["labelEl"],D=["wire"],L=["tag"],Q=["pin"],ie=["title"],se=[[["","label-header",""]],[["","label-actions",""]],[["","label-more",""]],[["","label-body",""]]],Z=["[label-header]","[label-actions]","[label-more]","[label-body]"],de=(w,X,oe,Y,he,ne,_e,Ce,Be)=>({"label--selected":w,"label--hovered":X,"label--annotation":oe,"label--invert":Y,"label--studio":he,"label--context":ne,"label--screenshot-mode":_e,"label--auto-fit":Ce,"label--opaque":Be}),ae=w=>({"label__wire--collapse":w}),q=(w,X,oe,Y)=>({"label__tag--collapse":w,"label__tag--collapsible":X,"label__tag--floating":oe,"label__tag--draggable":Y}),K=w=>({"label__body--collapse":w});function j(w,X){1&w&&(e.j41(0,"div",17),e.nrm(1,"img",18),e.k0s())}function M(w,X){if(1&w&&(e.j41(0,"div",19),e.SdG(1,3),e.k0s()),2&w){const oe=e.XpG();e.Y8G("ngClass",e.eq3(1,K,oe.isCollapsed||oe.descriptionCollapsed))}}class F{set selected(X){this._selected=X}get selected(){return this._selected}constructor(X,oe,Y,he,ne,_e,Ce,Be,Ie,Oe){this.renderer=X,this.labelsService=oe,this.engineService=Y,this.cameraService=he,this.engineRendererService=ne,this.store=_e,this.actions=Ce,this.changeDetection=Be,this.markerService=Ie,this.localeId=Oe,this.labelPinType=h.O,this.labelSequentialType=o.C,this.labelUpdated=new e.bkB,this.offsetUpdated=new e.bkB,this.pinClicked=new e.bkB,this.tagClicked=new e.bkB,this.displayUpdated=new e.bkB,this.positionUpdated=new e.bkB,this.hoverStart=new e.bkB,this.hoverEnd=new e.bkB,this.labelOffsetUpdated=new e.bkB,this.fit="fixed",this.opaque=!1,this.fixedScale=0,this.label=(0,e.hFB)(),this.isCollapsed=!1,this.tagCollapsed=!1,this.isLightTheme=(0,e.EWP)(()=>{const Te=this.label();return[v.D.StudioNext,v.D.Custom].includes(Te?.theme)}),this.isDarkTheme=(0,e.EWP)(()=>{const Te=this.label();return[v.D.Annotation,v.D.Classic].includes(Te?.theme)}),this.theme="classic",this.pinDraggable=!0,this.tagDraggable=!0,this._selected=!1,this.enginePosition=null,this.isBackgroundDark=!1,this.pinDragging=!1,this.screenshotMode=!1,this.hammerManagers=[],this.displayUpdated$=new f.B,this.positionUpdated$=new f.B,this.ngUnsubscribe=new f.B,this.dir=(0,k.NS)(this.localeId).direction,(0,e.QZP)(()=>{const Te=this.label();(0,r.isEmpty)(Te)?this.destroyLabel():this.initLabel(Te)})}ngOnInit(){this.initListeners()}ngAfterViewInit(){this.bindTagEvents(),this.bindPinEvents(),this.bindHoverEvents()}ngOnDestroy(){this.destroyLabel(),this.emitDisplayUpdated({id:this.label().id,inView:!1,shown:!1,objectShown:this.objectShown}),this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}destroyLabel(){this.hammerManagers.forEach(X=>X.destroy()),this.hammerManagers=[],this.deleteMarker(this.marker)}initListeners(){this.enginePosition$.pipe((0,s.Q)(this.ngUnsubscribe)).subscribe(X=>{this.enginePosition=X}),this.engineService.getEvent(u.X.Tick).pipe((0,c.p)(()=>!(0,r.isNil)(this.label())&&!(0,r.isNil)(this.enginePosition)),(0,s.Q)(this.ngUnsubscribe)).subscribe(()=>{this.setCanvasPos()}),this.displayUpdated$.pipe((0,O.F)((X,oe)=>(0,r.isEqual)(X,oe)),(0,s.Q)(this.ngUnsubscribe)).subscribe(X=>{this.displayUpdated.next(X)}),this.positionUpdated$.pipe((0,O.F)((X,oe)=>(0,r.isEqual)(X,oe)),(0,s.Q)(this.ngUnsubscribe)).subscribe(X=>{this.positionUpdated.next(X)}),this.background$.pipe((0,s.Q)(this.ngUnsubscribe)).subscribe(X=>{const oe=X.colors.slice(0,3),Y=X.colors.slice(4,7);this.isBackgroundDark=!C.T.isLight(oe,Y),this.changeDetection.markForCheck()}),this.actions.pipe((0,t.xi)(R.V9),(0,s.Q)(this.ngUnsubscribe)).subscribe(()=>{this.screenshotMode=!0,this.changeDetection.detectChanges()}),this.actions.pipe((0,t.rM)(R.WX),(0,s.Q)(this.ngUnsubscribe)).subscribe(()=>{this.screenshotMode=!1,this.changeDetection.markForCheck()}),this.hovered$=(0,E.h)(this.hoverStart.asObservable().pipe((0,P.T)(()=>!0)),this.hoverEnd.asObservable().pipe((0,P.T)(()=>!1)))}bindTagEvents(){const X=new i.Manager(this.tagRef.nativeElement,{domEvents:!0});X.add(new i.Pan({direction:i.DIRECTION_ALL,threshold:3})),X.add(new i.Tap({event:"tap"})),X.on("pan",oe=>{if(!this.tagDraggable)return;oe.srcEvent.stopPropagation(),this.cachedTagOffset||(this.cachedTagOffset=this.label().offset);const Y=[this.cachedTagOffset[0]+oe.deltaX,this.cachedTagOffset[1]+oe.deltaY];this.label().offset=Y,oe.isFinal&&(this.cachedTagOffset=null,this.offsetUpdated.next({labelId:this.label().id,offset:Y}))}),X.on("tap",oe=>{oe.srcEvent.preventDefault(),oe.srcEvent.stopPropagation(),this.tagClicked.next(oe)}),this.hammerManagers.push(X)}bindPinEvents(){const X=new i.Manager(this.pinRef.nativeElement);X.add(new i.Pan({direction:i.DIRECTION_ALL,threshold:4})),X.add(new i.Tap({event:"tap"})),X.on("pan",oe=>{if(!this.pinDraggable)return;oe.srcEvent.stopPropagation(),this.pinDragging=!0;let{layerX:Y,layerY:he}=oe.changedPointers[0];if(Y-=16,he-=16,this.renderer.setStyle(this.labelContainerRef.nativeElement,"transform",`translate(${Y}px, ${he}px)`),oe.isFinal){this.pinDragging=!1;const ne={...this.label()},_e=this.engineRendererService.pick(Y,he),Ce="string"==typeof _e.objectId;Ce&&(ne.dir=this.cameraService.getDirection(_e),ne.objectId=_e.objectId,ne.barycentric=[_e.barycentric[0],_e.barycentric[1],_e.barycentric[2]],ne.pos=[_e.worldPos[0],_e.worldPos[1],_e.worldPos[2]],ne.primitiveIndex=_e.triIndex),this.labelUpdated.next({label:ne,shouldPreserve:Ce})}}),X.on("tap",oe=>{oe.srcEvent.preventDefault(),oe.srcEvent.stopImmediatePropagation(),this.pinClicked.next(oe)}),this.hammerManagers.push(X)}bindHoverEvents(){const X=this.labelRef.nativeElement;this.renderer.listen(X,"mouseenter",()=>{this.hoverStart.next({labelId:this.label().id})}),this.renderer.listen(X,"mouseleave",()=>{this.hoverEnd.next({labelId:this.label().id})})}initLabel(X){this.initMarker(X),this.ensureObjectId(X),this.initObjectSubscription(X)}initMarker(X){this.marker&&this.deleteMarker(this.marker),this.marker=this.markerService.createMarker(X)}checkLabelDisplay(){return{id:this.label().id,shown:this.label().shown,inView:this.isOnCanvas(),objectShown:!0}}ensureObjectId(X){if(!X.objectId&&this.marker){const[oe,Y]=this.marker.screenPosition,he=this.engineRendererService.pick(oe,Y);he.objectId&&(X.objectId=he.objectId,X.states.forEach(ne=>{ne.errands.forEach(_e=>{_e.type===d.X.flyToObject&&(_e.value=he.objectId)})}),this.labelUpdated.next({label:X,shouldPreserve:void 0}))}}initObjectSubscription(X){this.object$&&this.object$.unsubscribe(),X.objectId&&(this.object$=this.store.select(S.S.getViewGraphNode).pipe((0,P.T)(oe=>oe(X.objectId)),(0,c.p)(oe=>!!oe),(0,s.Q)(this.ngUnsubscribe)).subscribe(oe=>{this.objectShown=oe.boolState.shown}))}deleteMarker(X){this.markerService.deleteMarker(X?.id),this.marker=null}setCanvasPos(){if(this.pinDragging||!this.marker)return void((0,r.isNil)(this.marker)&&this.setDisplay(!1));const X=this.isOccluded(),oe=this.isOcclusionIgnored(),Y=this.isOnCanvas(),he=X&&!oe,ne=void 0===this.objectShown?Y&&!he:Y&&this.objectShown&&!he;ne!==this.shown&&(this.shown=ne,this.setDisplay(ne)),this.setElementPosition(),this.setElementScale(),this.setTagPosition(),this.setWirePosition();const[Ce,Be]=this.marker.screenPosition;this.positionUpdated$.next({positionUpdate:{id:this.label().id,canvasPos:{x:Ce,y:Be},occluded:he},onCanvas:Y})}isOcclusionIgnored(){return this.selected||!this.label().occludable}isOccluded(){return this.marker?.occluded}isOnCanvas(){if(!this.marker)return!1;const{offsetWidth:X,offsetHeight:oe}=this.labelsService.getLabelContainer().nativeElement,[Y,he]=this.marker.screenPosition;return Y>0&&he>0&&Y<X&&he<oe}setDisplay(X){this.renderer.setStyle(this.labelRef.nativeElement,"visibility",X?"visible":"hidden"),this.emitDisplayUpdated({id:this.label().id,inView:this.isOnCanvas(),shown:X,objectShown:this.objectShown})}setElementPosition(){const[X,oe]=this.marker?.screenPosition??[0,0];this.renderer.setStyle(this.labelContainerRef.nativeElement,"transform",`translate(${X}px, ${oe}px)`)}setElementScale(){let X;if(this.fixedScale)X=this.fixedScale;else{const Y=this.store.selectSnapshot(S.S.getEnginePosition).width;X=Y>1440?Y/1440:1}const oe=32*X-32;this.renderer.setStyle(this.labelRef.nativeElement,"transform-origin","top left"),this.renderer.setStyle(this.labelRef.nativeElement,"transform",`translate(-${oe/2}px, -${oe/2}px) scale(${X}, ${X})`)}setTagPosition(){const[X,oe]=this.label().offset,Y=this.tagRef.nativeElement.offsetWidth;let he;he=this.label().pinType===h.O.None&&this.label().hideWire||X>0?"left":"right";let ne=20,_e=6;switch(this.label().theme){case v.D.Annotation:case v.D.Classic:ne="right"===he?18:22,_e=10}switch(he){case"left":this.renderer.setStyle(this.tagRef.nativeElement,"transform",`translate(${ne+X}px, ${_e+oe}px)`);break;case"right":this.renderer.setStyle(this.tagRef.nativeElement,"transform",`translate(${ne+X-Y}px, ${_e+oe}px)`)}}setWirePosition(){let[X,oe]=this.label().offset;switch(this.label().theme){case v.D.Annotation:case v.D.Classic:oe+=this.titleRef.nativeElement.offsetHeight-16-2}const Y=Math.sqrt(X*X+oe*oe);this.renderer.setStyle(this.wireRef.nativeElement,"width",`${Y}px`),this.renderer.setStyle(this.wireRef.nativeElement,"transform",`rotate(${Math.atan2(oe,X)}rad)`)}emitDisplayUpdated(X){this.label().id!==b.j&&(null==X.inView||null==X.shown||this.displayUpdated$.next(X))}static#e=this.\u0275fac=function(oe){return new(oe||F)(e.rXU(e.sFG),e.rXU(l.x),e.rXU(a.y),e.rXU(p.j),e.rXU(G.z),e.rXU(t.il),e.rXU(t.En),e.rXU(e.gRc),e.rXU(A.m),e.rXU(e.xe9))};static#t=this.\u0275cmp=e.VBU({type:F,selectors:[["app-generic-label"]],viewQuery:function(oe,Y){if(1&oe&&(e.GBs(z,7),e.GBs(I,7),e.GBs(D,7),e.GBs(L,7),e.GBs(Q,7),e.GBs(ie,7)),2&oe){let he;e.mGM(he=e.lsd())&&(Y.labelContainerRef=he.first),e.mGM(he=e.lsd())&&(Y.labelRef=he.first),e.mGM(he=e.lsd())&&(Y.wireRef=he.first),e.mGM(he=e.lsd())&&(Y.tagRef=he.first),e.mGM(he=e.lsd())&&(Y.pinRef=he.first),e.mGM(he=e.lsd())&&(Y.titleRef=he.first)}},hostVars:2,hostBindings:function(oe,Y){2&oe&&e.AVh("selected",Y.selected)},inputs:{fit:"fit",opaque:"opaque",fixedScale:"fixedScale",sequence:"sequence",hasContent:"hasContent",label:[1,"label"],isCollapsed:"isCollapsed",descriptionCollapsed:"descriptionCollapsed",tagCollapsed:"tagCollapsed",selected:"selected",theme:"theme",pinDraggable:"pinDraggable",tagDraggable:"tagDraggable"},outputs:{labelUpdated:"labelUpdated",offsetUpdated:"offsetUpdated",pinClicked:"pinClicked",tagClicked:"tagClicked",displayUpdated:"displayUpdated",positionUpdated:"positionUpdated",hoverStart:"hoverStart",hoverEnd:"hoverEnd",labelOffsetUpdated:"labelOffsetUpdated"},standalone:!0,features:[e.aNF],ngContentSelectors:Z,decls:22,vars:35,consts:[["labelContainerEl",""],["labelEl",""],["pin",""],["wire",""],["tag",""],["title",""],["data-test","labelContainer",1,"label-container"],["data-test","labelElement",1,"label",3,"ngClass"],[1,"label__pin"],[3,"pinType","labelTheme","glow","selected","hovered","sequence","foregroundColor","backgroundColor"],[1,"label__wire",3,"ngClass"],["aria-hidden","true",1,"label__tag",3,"dir","ngClass"],[1,"label__header"],["data-test","labelTitle",1,"label__title"],["class","label__more","appLogicalDir","",4,"ngIf"],["appEventFence","",1,"label__actions"],["class","label__body",3,"ngClass",4,"ngIf"],["appLogicalDir","",1,"label__more"],["src","./assets/images/labels/caret-right.svg"],[1,"label__body",3,"ngClass"]],template:function(oe,Y){if(1&oe&&(e.NAR(se),e.j41(0,"div",6,0)(2,"div",7,1),e.nI1(4,"async"),e.j41(5,"div",8,2),e.nrm(7,"app-label-pin",9),e.nI1(8,"async"),e.k0s(),e.nrm(9,"div",10,3),e.j41(11,"div",11,4)(13,"div",12)(14,"div",13,5),e.SdG(16),e.k0s(),e.DNE(17,j,2,0,"div",14),e.j41(18,"div",15),e.SdG(19,1),e.k0s()(),e.DNE(20,M,2,3,"div",16),e.SdG(21,2),e.k0s()()()),2&oe){let he,ne;e.R7$(2),e.Y8G("ngClass",e.zJS(18,de,[Y.selected,e.bMT(4,14,Y.hovered$),Y.isDarkTheme(),Y.isBackgroundDark,Y.isLightTheme(),"context"===Y.label().theme,Y.screenshotMode,"auto"===Y.fit,Y.opaque])),e.R7$(5),e.Y8G("pinType",Y.label().pinType)("labelTheme",Y.label().theme)("glow",Y.label().pinGlow)("selected",Y.selected)("hovered",e.bMT(8,16,Y.hovered$))("sequence",Y.sequence)("foregroundColor",null==(he=Y.label().themeStyles)?null:he.pinForegroundColor)("backgroundColor",null==(ne=Y.label().themeStyles)?null:ne.pinBackgroundColor),e.R7$(2),e.Y8G("ngClass",e.eq3(28,ae,Y.isCollapsed||Y.tagCollapsed||Y.label().hideWire)),e.R7$(2),e.Y8G("dir",Y.dir)("ngClass",e.ziG(30,q,Y.isCollapsed||Y.tagCollapsed,Y.label().collapseDescription,Y.label().hideWire,Y.tagDraggable)),e.R7$(6),e.Y8G("ngIf",Y.hasContent&&Y.label().collapseDescription),e.R7$(3),e.Y8G("ngIf",Y.hasContent)}},dependencies:[V.MD,V.YU,V.bT,V.Jj,W.b],styles:["@keyframes _ngcontent-%COMP%_fadeIn{0%{display:none;opacity:0}1%{display:block;opacity:0}to{opacity:1;display:block}}@keyframes _ngcontent-%COMP%_fadeOut{0%{display:block;opacity:1}99%{opacity:0}to{opacity:0;display:none}}[_nghost-%COMP%], .label-container[_ngcontent-%COMP%]{display:block;position:absolute;z-index:10;width:200px;pointer-events:all;pointer-events:none}[_nghost-%COMP%]:hover, .label-container[_ngcontent-%COMP%]:hover{z-index:12}.selected[_nghost-%COMP%]{z-index:11}.label-container[_ngcontent-%COMP%]{left:-16px;top:-16px}.label[_ngcontent-%COMP%]{display:block;overflow:visible;-webkit-user-select:none;user-select:none;justify-content:center;align-items:center;height:32px}.label--screenshot-mode[_ngcontent-%COMP%]{text-shadow:none!important}.label--screenshot-mode[_ngcontent-%COMP%]   .label__pin[_ngcontent-%COMP%]:before, .label--screenshot-mode[_ngcontent-%COMP%]   .label__pin[_ngcontent-%COMP%]:after{box-shadow:none!important}.label--screenshot-mode[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]{box-shadow:none!important;text-shadow:none!important}.label--screenshot-mode[_ngcontent-%COMP%]   .label__more[_ngcontent-%COMP%]{display:none!important}.label--auto-fit[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]{min-width:max-content;padding:0!important}.label--auto-fit[_ngcontent-%COMP%]   .label__body[_ngcontent-%COMP%]{padding:0!important}.label--selected[_ngcontent-%COMP%]   .label__more[_ngcontent-%COMP%]{transform:rotate(45deg)}.label__more[_ngcontent-%COMP%]{color:#374a68;display:none;flex:0 0 16px;height:16px;align-items:center;justify-content:center;transition:transform .15s ease-in-out}.label__pin[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:40px;height:40px;border-radius:50%;position:absolute;pointer-events:all;transition:background-color .12s;z-index:10}.label__pin[_ngcontent-%COMP%]:hover, .label__pin--draggable[_ngcontent-%COMP%]:hover{cursor:pointer}.label__wire[_ngcontent-%COMP%]{position:absolute;top:20px;left:20px;height:0;transform-origin:0 100%;pointer-events:none;z-index:1}.label__wire--collapse[_ngcontent-%COMP%]{display:none}.label__tag[_ngcontent-%COMP%]{display:inline-block;left:16px;top:0;z-index:10;max-width:160px;pointer-events:all}.label__tag[_ngcontent-%COMP%]:hover, .label__tag--draggable[_ngcontent-%COMP%]:hover{cursor:pointer}.label__tag--collapse[_ngcontent-%COMP%]{display:none}.label__tag[_ngcontent-%COMP%]:focus{outline:#2d72dc solid 2px!important;border-radius:4px}.label__header[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.label__title[_ngcontent-%COMP%]{font-size:.75rem;line-height:1rem;letter-spacing:0;line-height:140%;align-self:center}.label__body[_ngcontent-%COMP%]{font-size:.75rem;line-height:1rem;letter-spacing:0;padding-top:12px}.label__body--collapse[_ngcontent-%COMP%]{display:none}.label__icon[_ngcontent-%COMP%]{margin:0 -4px 0 4px}.label__actions[_ngcontent-%COMP%]{padding-left:4px}.label--studio.label--opaque[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]{background-color:#ffffffd9!important}.label--studio.label.label--hovered[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]{background-color:#fff}.label--studio.label.label--hovered[_ngcontent-%COMP%]   .label__wire[_ngcontent-%COMP%], .label--studio.label.label--selected[_ngcontent-%COMP%]   .label__wire[_ngcontent-%COMP%]{border-color:#2d72dc}.label--studio.label.label--hovered[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%], .label--studio.label.label--selected[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]{background-color:#fff;border-color:#2d72dc;box-shadow:0 0 0 1px #2d72dcb3}.label--studio.label[_ngcontent-%COMP%]   .label__wire[_ngcontent-%COMP%]{border-top:1px solid rgba(16,24,35,.8);box-shadow:0 0 0 1px #f9fafd40}.label--studio.label[_ngcontent-%COMP%]   .label__wire--collapse[_ngcontent-%COMP%]{display:none}.label--studio.label[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]{background:#ffffff8c;border:1px solid rgba(16,24,35,.8);box-shadow:0 0 24px #1018231a;padding:4px 8px;border-radius:4px;max-width:200px}.label--studio.label[_ngcontent-%COMP%]   .label__title[_ngcontent-%COMP%]{color:#101823;flex:1 1 auto}.label--studio.label[_ngcontent-%COMP%]   .label__body[_ngcontent-%COMP%]{color:#374a68;padding-top:4px}.label--studio.label[_ngcontent-%COMP%]   .label__body[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-weight:700}.label--studio.label[_ngcontent-%COMP%]   .label__body[_ngcontent-%COMP%]   em[_ngcontent-%COMP%]{font-style:italic}.label--studio.label[_ngcontent-%COMP%]   .label__more[_ngcontent-%COMP%]{display:flex}.label--annotation.label--none[_ngcontent-%COMP%]{display:none}.label--annotation.label[_ngcontent-%COMP%]   .label__wire[_ngcontent-%COMP%]{border-top:1px solid #666666}.label--annotation.label[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]{min-width:10px;color:#eee}.label--annotation.label[_ngcontent-%COMP%]   .label__tag--collapsible[_ngcontent-%COMP%]   .label__more[_ngcontent-%COMP%]{display:flex;color:#000}.label--annotation.label[_ngcontent-%COMP%]   .label__tag--floating[_ngcontent-%COMP%]   .label__header[_ngcontent-%COMP%]{border-bottom:none}.label--annotation.label[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]:focus{outline-offset:4px}.label--annotation.label[_ngcontent-%COMP%]   .label__header[_ngcontent-%COMP%]{border-bottom:1px solid #666666}.label--annotation.label[_ngcontent-%COMP%]   .label__title[_ngcontent-%COMP%]{font-weight:600;min-height:18px;width:100%;padding-bottom:4px;margin-bottom:-2px;color:#000}.label--annotation.label[_ngcontent-%COMP%]   .label__body[_ngcontent-%COMP%]{padding-top:4px;color:#333}.label--annotation.label.label--invert.label[_ngcontent-%COMP%]   .label__wire[_ngcontent-%COMP%]{border-color:#eee}.label--annotation.label.label--invert.label[_ngcontent-%COMP%]   .label__tag--collapsible[_ngcontent-%COMP%]   .label__more[_ngcontent-%COMP%]{display:flex;color:#fff}.label--annotation.label.label--invert.label[_ngcontent-%COMP%]   .label__title[_ngcontent-%COMP%]{color:#fff}.label--annotation.label.label--invert.label[_ngcontent-%COMP%]   .label__header[_ngcontent-%COMP%]{border-color:#eee}.label--annotation.label.label--invert.label[_ngcontent-%COMP%]   .label__body[_ngcontent-%COMP%]{color:#eee}.label--context.label[_ngcontent-%COMP%]{pointer-events:none}.label--context.label[_ngcontent-%COMP%]   .label__pin[_ngcontent-%COMP%], .label--context.label[_ngcontent-%COMP%]   .label__wire[_ngcontent-%COMP%]{display:none}.label--context.label[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;background:#ffffffb3;border:1px solid rgba(16,24,35,.8);box-shadow:0 0 24px #1018231a;padding:0;border-radius:4px;width:fit-content;min-width:200px;max-width:none;min-height:75px;opacity:1;transition:width .25s,opacity .1s}.label--context.label[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]:hover{background:#fffc;cursor:pointer}.label--context.label[_ngcontent-%COMP%]   .label__header[_ngcontent-%COMP%]{padding:4px 8px 0}.label--context.label[_ngcontent-%COMP%]   .label__title[_ngcontent-%COMP%]{font-weight:600;color:#101823}.label--context.label[_ngcontent-%COMP%]   .label__body[_ngcontent-%COMP%]{margin-top:8px;border-top:1px solid #eaeff5;color:#101823;overflow-x:hidden;padding-top:8px}.label--context.label[_ngcontent-%COMP%]   .label__body[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-weight:700}.label--context.label[_ngcontent-%COMP%]   .label__body[_ngcontent-%COMP%]   em[_ngcontent-%COMP%]{font-style:italic}.context-label--large[_nghost-%COMP%]   .label--context.label[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]{width:300px}@media (min-width: 960px){.context-label--expanded[_nghost-%COMP%]   .label--context.label[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]{width:400px}}@media (max-width: 959px){.context-label--expanded[_nghost-%COMP%]   .label--context.label[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]{opacity:0}}"],changeDetection:0})}T([(0,t.l6)(S.S.getEnginePosition),x("design:type",y.c)],F.prototype,"enginePosition$",void 0),T([(0,t.l6)(m.N.getSelectedChapterBackground),x("design:type",y.c)],F.prototype,"background$",void 0)},26513:(le,N,n)=>{"use strict";n.d(N,{b:()=>p});var e=n(60177),t=n(54438),s=n(49204),O=n(11789),P=n(24151),S=n(76872);const a=["pinElRef"],f=(h,o,v,d,r,_)=>({"label-pin--light":h,"label-pin--dark":o,"label-pin--none":v,"label-pin--custom":d,"label-pin--selected":r,"label-pin--hovered":_});function E(h,o){1&h&&(t.qSk(),t.j41(0,"svg",2),t.nrm(1,"path",6),t.k0s())}function y(h,o){1&h&&(t.qSk(),t.j41(0,"svg",3),t.nrm(1,"path",7),t.k0s())}function i(h,o){if(1&h&&(t.j41(0,"div",4),t.EFF(1),t.k0s()),2&h){const v=t.XpG();t.R7$(),t.SpI(" ",v.sequence()," ")}}function g(h,o){1&h&&t.nrm(0,"div",5)}let p=(()=>{class h{constructor(){this.labelPinType=P.O,this.labelThemeEnum=S.D,this.pinElRef=(0,t.ebz)("pinElRef"),this.labelTheme=t.hFB.required(),this.pinType=t.hFB.required(),this.glow=(0,t.hFB)(!1),this.selected=(0,t.hFB)(!1),this.hovered=(0,t.hFB)(!1),this.sequence=(0,t.hFB)(),this.showOnNone=(0,t.hFB)(!1),this.foregroundColor=(0,t.hFB)(),this.backgroundColor=(0,t.hFB)(),this.pinContentType=(0,t.EWP)(()=>{const v=this.pinType(),d=this.selected();switch(v){case P.O.Plus:return"plus";case P.O.Minus:return"minus";case P.O.PlusMinus:return d?"minus":"plus";case P.O.Sequential:return"text";default:return"none"}}),(0,t.QZP)(()=>{const v=this.pinElRef()?.nativeElement,d=this.labelTheme(),r=this.foregroundColor(),_=this.backgroundColor();(0,s.isNil)(v)||(v.style.removeProperty("--label-pin-text-color"),v.style.removeProperty("--label-pin-border-color"),v.style.removeProperty("--label-pin-color"),d===S.D.Custom&&(r&&O.T.isCSSColor(r)&&(v.style.setProperty("--label-pin-text-color",r),v.style.setProperty("--label-pin-border-color",r)),_&&O.T.isCSSColor(_)&&v.style.setProperty("--label-pin-color",_)))})}static#e=this.\u0275fac=function(d){return new(d||h)};static#t=this.\u0275cmp=t.VBU({type:h,selectors:[["app-label-pin"]],viewQuery:function(d,r){1&d&&t.wEZ(r.pinElRef,a,5),2&d&&t.NyB()},inputs:{labelTheme:[1,"labelTheme"],pinType:[1,"pinType"],glow:[1,"glow"],selected:[1,"selected"],hovered:[1,"hovered"],sequence:[1,"sequence"],showOnNone:[1,"showOnNone"],foregroundColor:[1,"foregroundColor"],backgroundColor:[1,"backgroundColor"]},standalone:!0,features:[t.aNF],decls:6,vars:10,consts:[["pinElRef",""],[1,"label-pin",3,"ngClass"],["width","10","height","10","viewBox","0 0 10 10","fill","none",1,"label-pin__image"],["width","10","height","4","viewBox","0 0 10 4","fill","none",1,"label-pin__image-text"],[1,"label-pin__text"],[1,"label-pin__glow"],["fill-rule","evenodd","clip-rule","evenodd","d","M6.25 0V3.75H10V6.25H6.25V10H3.75V6.25H0V3.75L3.75 3.74875V0H6.25Z",1,"label-pin__image-text"],["d","M10 0.800049H0V3.20005H10V0.800049Z",1,"label-pin__text"]],template:function(d,r){if(1&d&&(t.j41(0,"div",1,0),t.DNE(2,E,2,0,":svg:svg",2)(3,y,2,0,":svg:svg",3)(4,i,2,1,"div",4)(5,g,1,0,"div",5),t.k0s()),2&d){let _;t.Y8G("ngClass",t.l4e(3,f,r.labelTheme()===r.labelThemeEnum.StudioNext,r.labelTheme()===r.labelThemeEnum.Annotation,r.pinType()===r.labelPinType.None&&!r.showOnNone(),r.labelTheme()===r.labelThemeEnum.Custom,r.selected(),r.hovered())),t.R7$(2),t.vxM("plus"===(_=r.pinContentType())?2:"minus"===_?3:"text"===_?4:-1),t.R7$(3),t.vxM(r.glow()?5:-1)}},dependencies:[e.MD,e.YU],styles:[':root{--label-pin-size: 20px;--label-pin-text-size: 10px;--label-pin-scale: 1;--label-pin-color: transparent;--label-pin-border-width: 1px;--label-pin-border-color: transparent;--label-pin-text-color: transparent;--label-pin-box-shadow-color: transparent;--label-pin-box-shadow-width: 1px;--label-pin-glow-color: rgba(255, 255, 255, .3);--label-pin-glow-scale: 1.6}@keyframes classic-glow{0%{transform:scale(1)}10%{transform:scale(1)}50%{transform:scale(var(--label-pin-glow-scale))}90%{transform:scale(1)}to{transform:scale(1)}}.label-pin{display:flex;align-items:center;justify-content:center;position:relative;z-index:10;width:var(--label-pin-size);height:var(--label-pin-size);transition:transform .15s ease-out;transform:scale(var(--label-pin-scale))}.label-pin__text{font-size:var(--label-pin-text-size);font-weight:700;color:var(--label-pin-text-color)}.label-pin__image-text{fill:var(--label-pin-text-color)}.label-pin__glow{display:block;position:absolute;left:0;top:0;width:100%;height:100%;border-radius:50%;z-index:-2;background-color:var(--label-pin-glow-color);animation:classic-glow 4s infinite}.label-pin:before{content:" ";background-color:transparent;border-style:solid;border-radius:50%;box-sizing:border-box;display:block;position:absolute;left:0;top:0;z-index:-1;height:100%;width:100%;background-color:var(--label-pin-color);border-width:var(--label-pin-border-width);border-color:var(--label-pin-border-color);box-shadow:0 0 0 var(--label-pin-box-shadow-width) var(--label-pin-box-shadow-color);transition:box-shadow .15s ease-out}.label-pin--hovered,.label-pin:hover{--label-pin-box-shadow-color: #2d72dc}.label-pin--selected{--label-pin-box-shadow-color: #2d72dc;--label-pin-box-shadow-width: 2px}.label-pin--light{--label-pin-color: #ffffff;--label-pin-text-color: #101823;--label-pin-border-color: #101823}.label-pin--dark{--label-pin-glow-color: rgba(255, 255, 255, .25);--label-pin-color: #283853;--label-pin-text-color: #ffffff;--label-pin-border-color: #ffffff}.label-pin--dark.label-pin--selected{--label-pin-color: #101823}.label-pin--custom{--label-pin-color: #ffffff;--label-pin-text-color: #101823;--label-pin-border-color: #101823}.label-pin--none{display:none}\n'],encapsulation:2,changeDetection:0})}return h})()},25209:(le,N,n)=>{"use strict";n.d(N,{H:()=>K});var e=n(92014),t=n(76304),s=n(85052),c=n(82656),O=n(2573),P=n(38753),S=n(47555),a=n(37925),f=n(14264),E=n(36110),y=n(19833),i=n(93915),g=n(3266),p=n(47610),h=n(94495),o=n(3829),v=n(7431),d=n(8358),r=n(76872),_=n(13409),u=n(38157),l=n(49746),m=n(1300),C=n(49204),R=n(65294),A=n(87710),G=n(43753),k=n(24151),V=n(51640),W=n(60177),T=n(47001),x=n(44461),z=n(8465),I=n(54438),D=n(38645),L=n(83621),Q=function(j,M,$,ce){var H,re=arguments.length,ue=re<3?M:null===ce?ce=Object.getOwnPropertyDescriptor(M,$):ce;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)ue=Reflect.decorate(j,M,$,ce);else for(var te=j.length-1;te>=0;te--)(H=j[te])&&(ue=(re<3?H(ue):re>3?H(M,$,ue):H(M,$))||ue);return re>3&&ue&&Object.defineProperty(M,$,ue),ue},ie=function(j,M){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(j,M)};function se(j,M){if(1&j&&(I.nrm(0,"app-context-label",5),I.nI1(1,"async"),I.nI1(2,"async"),I.nI1(3,"async"),I.nI1(4,"async"),I.nI1(5,"async"),I.nI1(6,"async"),I.nI1(7,"async")),2&j){let $,ce,re;const ue=I.XpG(3);I.Y8G("label",I.bMT(1,4,ue.contextLabel$))("enableInfo",I.bMT(2,6,ue.enableContextLabelInfo$)&&(null==($=I.bMT(3,8,ue.viewUI$))?null:$.nodeInfo.enable))("enableActions",I.bMT(4,10,ue.enableContextLabelActions$)&&(null==(ce=I.bMT(5,12,ue.viewUI$))?null:ce.contextActions.enable))("enableAudio",I.bMT(6,14,ue.enableContextLabelAudio$)&&(null==(re=I.bMT(7,16,ue.viewUI$))?null:re.nodeAudio.enable))}}function Z(j,M){if(1&j&&(I.qex(0),I.nrm(1,"app-story-label",6),I.nI1(2,"async"),I.nI1(3,"async"),I.nI1(4,"async"),I.nI1(5,"async"),I.bVm()),2&j){let $,ce;const re=M.$implicit,ue=I.XpG(3);I.R7$(),I.AVh("labels__label--hidden",!re.shown),I.Y8G("pinDraggable",null==($=I.bMT(2,7,ue.draggable$))?null:$.pin)("tagDraggable",null==(ce=I.bMT(3,9,ue.draggable$))?null:ce.tag)("label",re)("collapsed",I.bMT(4,11,ue.labelsCollapsed$))("collapsedMode",I.bMT(5,13,ue.labelsCollapsedMode$))}}function de(j,M){if(1&j&&(I.qex(0),I.DNE(1,se,8,18,"app-context-label",3),I.nI1(2,"async"),I.nI1(3,"async"),I.DNE(4,Z,6,15,"ng-container",4),I.nI1(5,"async"),I.bVm()),2&j){const $=I.XpG(2);I.R7$(),I.Y8G("ngIf",I.bMT(2,3,$.enableContextLabel$)&&I.bMT(3,5,$.contextLabel$)),I.R7$(3),I.Y8G("ngForOf",I.bMT(5,7,$.labels$))("ngForTrackBy",$.trackLabel)}}function ae(j,M){1&j&&(I.qex(0),I.nrm(1,"app-quiz-labels"),I.bVm())}function q(j,M){if(1&j&&(I.j41(0,"div",1),I.DNE(1,de,6,9,"ng-container",2)(2,ae,2,0,"ng-container",2),I.k0s()),2&j){const $=I.XpG();I.R7$(),I.Y8G("ngIf",$.showAnatomyLabels),I.R7$(),I.Y8G("ngIf",$.showQuizLabels)}}class K{constructor(M,$,ce,re,ue,H,te,F){this.action$=M,this.cameraService=$,this.changeDetector=ce,this.elRef=re,this.labelsService=ue,this.router=H,this.store=te,this.applicationEventService=F,this.interactive=!1,this.showAnatomyLabels=!1,this.showQuizLabels=!1,this.ngUnsubscribe=new s.B}ngOnInit(){this.bindEngineEvents(),this.bindApplicationEvents(),this.labelsService.setLabelContainer(this.elRef)}ngOnDestroy(){this.labelsService.setLabelContainer(null),this.changeDetector.detach(),this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}bindApplicationEvents(){this.action$.pipe((0,e.xi)(p.zE),(0,a.Q)(this.ngUnsubscribe)).subscribe($=>{this.handleClickNode($)}),this.action$.pipe((0,e.xi)(p.fZ),(0,a.Q)(this.ngUnsubscribe)).subscribe($=>{$.node&&this.store.dispatch(new i.S3)}),this.labels$.pipe((0,a.Q)(this.ngUnsubscribe)).subscribe($=>{this.changeDetector.markForCheck()}),this.selectedLabel$.pipe((0,f.p)($=>null==$),(0,a.Q)(this.ngUnsubscribe)).subscribe(()=>{const $=this.store.selectSnapshot(o.x.getZoomed),ce=this.store.selectSnapshot(o.x.getLockCamera);$&&!ce&&this.resetCamera()});const M=(0,c.z)([this.activeTool$,this.activeQuestion$]).pipe((0,a.Q)(this.ngUnsubscribe),(0,E.T)(([$,ce])=>{const re=this.router.url.indexOf("/edit")>=0,ue=(0,C.get)(ce,"type")===G.Q5.LabelAnatomy;return re?$===S.s.Quiz:ue}));(0,c.z)([this.showLabels$,M,this.activeQuestion$]).pipe((0,a.Q)(this.ngUnsubscribe)).subscribe(([$,ce,re])=>{const ue=(0,C.get)(re,"showChapterLabels");this.showQuizLabels=ce,this.showAnatomyLabels=!this.showQuizLabels&&$||ue,this.changeDetector.markForCheck()}),this.store.select(h.N.getSelectedChapterReadyState).pipe((0,f.p)($=>null!=$),(0,a.Q)(this.ngUnsubscribe)).subscribe($=>{this.interactive=$.model,this.changeDetector.markForCheck()})}bindEngineEvents(){this.action$.pipe((0,e.xi)(p.Gv,i.eH),(0,a.Q)(this.ngUnsubscribe)).subscribe(M=>{this.applicationEventService.fireEvent(M.show?R.F.LabelsEnabled:R.F.LabelsDisabled,null)}),this.action$.pipe((0,e.xi)(i.Sh),(0,a.Q)(this.ngUnsubscribe),(0,y.c)(0)).subscribe(M=>{this.applicationEventService.fireEvent(R.F.LabelsCreated,M.label)}),this.action$.pipe((0,e.xi)(i.lb),(0,a.Q)(this.ngUnsubscribe)).subscribe(M=>{this.applicationEventService.fireEvent(R.F.LabelsUpdated,M.label)}),this.action$.pipe((0,e.xi)(i.D3),(0,a.Q)(this.ngUnsubscribe)).subscribe(M=>{M.labels.forEach($=>{this.applicationEventService.fireEvent(M.shown?R.F.LabelsShown:R.F.LabelsHidden,{labelId:$.id})})}),this.action$.pipe((0,e.xi)(i.vx),(0,a.Q)(this.ngUnsubscribe)).subscribe(M=>{this.applicationEventService.fireEvent(R.F.LabelsDestroyed,M.label)})}handleClickNode(M){const $=this.store.selectSnapshot(t.S.getActiveTool);if((0,C.isNil)(M.node))this.store.dispatch(new i.TR(null)),this.store.dispatch(new i.S3);else{const ce=this.store.selectSnapshot(P.y.getEnableContextLabel);$===S.s.Label?this.addLabel(M.hit,M.node):ce&&setTimeout(()=>{this.toggleContextLabel(M.hit,M.node)})}}addLabel(M,$){const ce=this.cameraService.getDirection(M),re=this.getLabelDefaults(M.objectId),ue=re.hideWire?20:32;re.title=$.label,re.offset=[ue,0],re.objectId=M.objectId,re.barycentric=[M.barycentric[0],M.barycentric[1],M.barycentric[2]],re.pos=[M.worldPos[0],M.worldPos[1],M.worldPos[2]],re.primitiveIndex=M.triIndex,re.renderableIndex=M.renderableIndex||0,re.dir=ce,re.chapterId=this.store.selectSnapshot(h.N.getSelectedChapter).id,re.occludable=!0,re.shown=!0,this.store.dispatch(new i.Sh(re,!0)),this.store.dispatch(new i.TR(re))}toggleContextLabel(M,$){const ce=this.store.selectSnapshot(_.z.getCheckedNodeIds);if(!this.store.selectSnapshot(t.S.getContextMenu).node&&ce.some(ue=>ue===$.id)){const ue=this.cameraService.getDirection(M),H=this.labelsService.makeDefaultStudioLabel();H.theme=r.D.Context,H.title=$.label,H.offset=[32,0],H.objectId=M.objectId,H.barycentric=[M.barycentric[0],M.barycentric[1],M.barycentric[2]],H.pos=[M.worldPos[0],M.worldPos[1],M.worldPos[2]],H.primitiveIndex=M.triIndex,H.renderableIndex=M.renderableIndex||0,H.dir=ue,H.occludable=!1,H.hideWire=!0,H.pinType=k.O.None,this.store.dispatch(new i.h5(H))}else this.store.dispatch(new i.S3)}getLabelDefaults(M){let $=this.store.selectSnapshot(P.y.getSelectedLabel);if(null==$){let ce=this.store.selectSnapshot(P.y.getChapterLabels);(!ce||0===ce.length)&&(ce=this.store.selectSnapshot(P.y.getLabels)),ce.length&&($=(0,C.cloneDeep)(ce[ce.length-1]))}if(null!=$){const ce=this.labelsService.makeDefaultStudioLabel();switch(ce.hideWire=$.hideWire,ce.pinGlow=$.pinGlow,ce.pinType=$.pinType,ce.theme=$.theme,ce.themeStyles=$.themeStyles,ce.sequentialType=$.sequentialType,ce.states[0].errands[0]=new m.T,(0,C.get)($,"states[1].errands[0].type")){case u.X.flyToObject:case u.X.flyToCamera:ce.states[1].errands[0]=new l.F(M)}return ce}{const ce=this.labelsService.makeDefaultStudioLabel();return ce.states[0].errands[0]=new m.T,ce.states[1].errands[0]=new l.F(M),ce}}trackLabel(M,$){const{id:ce,shown:re,theme:ue}=$;return`${ce}${re}${ue}`}resetCamera(){const $=this.store.selectSnapshot(h.N.getSelectedChapter)?.camera?.location;(0,C.isNil)($)||this.store.dispatch(new v.Ih($))}static#e=this.\u0275fac=function($){return new($||K)(I.rXU(e.En),I.rXU(g.j),I.rXU(I.gRc),I.rXU(I.aKT),I.rXU(d.x),I.rXU(D.Ix),I.rXU(e.il),I.rXU(L.S))};static#t=this.\u0275cmp=I.VBU({type:K,selectors:[["app-labels"]],standalone:!0,features:[I.aNF],decls:1,vars:1,consts:[["class","labels","data-test","labelsElement","dir","ltr",4,"ngIf"],["data-test","labelsElement","dir","ltr",1,"labels"],[4,"ngIf"],[3,"label","enableInfo","enableActions","enableAudio",4,"ngIf"],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"label","enableInfo","enableActions","enableAudio"],["data-test","appStoryLabel",1,"labels__label",3,"pinDraggable","tagDraggable","label","collapsed","collapsedMode"]],template:function($,ce){1&$&&I.DNE(0,q,3,2,"div",0),2&$&&I.Y8G("ngIf",ce.interactive)},dependencies:[W.MD,W.Sq,W.bT,W.Jj,T.L,z.M,x.B],styles:["[_nghost-%COMP%]{width:100%;height:100%;display:block;position:relative}.labels[_ngcontent-%COMP%]{position:absolute;left:0;top:0;width:100%;height:100%;display:block;z-index:2;pointer-events:none}.labels__label--hidden[_ngcontent-%COMP%]{display:none}"],changeDetection:0})}Q([(0,e.l6)(V.dF.getUI),ie("design:type",O.c)],K.prototype,"viewUI$",void 0),Q([(0,e.l6)(P.y.getChapterLabels),ie("design:type",O.c)],K.prototype,"labels$",void 0),Q([(0,e.l6)(A.j.getQuizModeActive),ie("design:type",O.c)],K.prototype,"quizModeActive$",void 0),Q([(0,e.l6)(t.S.getActiveTool),ie("design:type",O.c)],K.prototype,"activeTool$",void 0),Q([(0,e.l6)(A.j.getActiveQuestion),ie("design:type",O.c)],K.prototype,"activeQuestion$",void 0),Q([(0,e.l6)(h.N.getSelectedChapter),ie("design:type",O.c)],K.prototype,"selectedChapter$",void 0),Q([(0,e.l6)(P.y.getSelectedLabel),ie("design:type",O.c)],K.prototype,"selectedLabel$",void 0),Q([(0,e.l6)(P.y.getLabelsCollapsed),ie("design:type",O.c)],K.prototype,"labelsCollapsed$",void 0),Q([(0,e.l6)(P.y.getLabelsCollapsedMode),ie("design:type",O.c)],K.prototype,"labelsCollapsedMode$",void 0),Q([(0,e.l6)(P.y.getContextLabel),ie("design:type",O.c)],K.prototype,"contextLabel$",void 0),Q([(0,e.l6)(t.S.getShowLabels),ie("design:type",O.c)],K.prototype,"showLabels$",void 0),Q([(0,e.l6)(o.x.getZoomed),ie("design:type",O.c)],K.prototype,"zoomed$",void 0),Q([(0,e.l6)(P.y.getEnableContextLabel),ie("design:type",O.c)],K.prototype,"enableContextLabel$",void 0),Q([(0,e.l6)(P.y.getEnableContextLabelInfo),ie("design:type",O.c)],K.prototype,"enableContextLabelInfo$",void 0),Q([(0,e.l6)(P.y.getEnableContextLabelActions),ie("design:type",O.c)],K.prototype,"enableContextLabelActions$",void 0),Q([(0,e.l6)(P.y.getEnableContextLabelAudio),ie("design:type",O.c)],K.prototype,"enableContextLabelAudio$",void 0),Q([(0,e.l6)(P.y.getLabelsDraggable),ie("design:type",O.c)],K.prototype,"draggable$",void 0)},45911:(le,N,n)=>{"use strict";n.d(N,{l:()=>r});var e=n(60177),t=n(54438),s=n(89417),c=n(92014),O=n(2573),P=n(49206),S=n(38753),a=n(24125),f=n(57743),E=n(72026),y=n(26779);function p(_,u){1&_&&t.nrm(0,"app-icon",8)}function h(_,u){1&_&&t.nrm(0,"app-icon",9)}function o(_,u){if(1&_&&(t.j41(0,"div",10)(1,"em",11),t.EFF(2),t.k0s(),t.EFF(3,". "),t.k0s()),2&_){const l=t.XpG(2);t.R7$(2),t.JRh(l.option.label.title)}}function v(_,u){if(1&_&&(t.j41(0,"div",10)(1,"p",12),t.EFF(2," You selected "),t.j41(3,"em",11),t.EFF(4),t.k0s(),t.EFF(5,". "),t.k0s(),t.j41(6,"p"),t.EFF(7," This is the "),t.j41(8,"em",11),t.EFF(9),t.k0s(),t.EFF(10,". "),t.k0s()()),2&_){let l;const m=t.XpG(2);t.R7$(4),t.JRh(null==(l=m.getSelectedLabel(m.options,m.control.value))?null:l.title.trim()),t.R7$(5),t.JRh(m.option.label.title.trim())}}function d(_,u){if(1&_&&(t.j41(0,"div",4),t.DNE(1,p,1,0,"app-icon",5)(2,h,1,0,"app-icon",6)(3,o,4,1,"div",7)(4,v,11,2,"div",7),t.k0s()),2&_){const l=t.XpG();t.Y8G("ngSwitch",l.correct),t.R7$(),t.Y8G("ngSwitchCase",!0),t.R7$(),t.Y8G("ngSwitchCase",!1),t.R7$(),t.Y8G("ngSwitchCase",!0),t.R7$(),t.Y8G("ngSwitchCase",!1)}}class r extends P.Z{constructor(){super(...arguments),this.sequence=0,this.labelUpdated=new t.bkB}ngOnInit(){}handleLabelUpdated(u){this.labelUpdated.next(u.label)}handleOffsetUpdated(u){this.labelUpdated.next({...this.option.label,offset:u.offset})}getSelectedLabel(u,l){const m=this.options.find(C=>C.value===l);return m?m.label:void 0}static#e=this.\u0275fac=(()=>{let u;return function(m){return(u||(u=t.xGo(r)))(m||r)}})();static#t=this.\u0275cmp=t.VBU({type:r,selectors:[["app-quiz-label"]],inputs:{sequence:"sequence",collapsed:"collapsed",options:"options",option:"option",correct:"correct",mode:"mode"},outputs:{labelUpdated:"labelUpdated"},standalone:!0,features:[t.Jv_([{provide:s.kq,useExisting:(0,t.Rfq)(()=>r),multi:!0}]),t.Vt3,t.aNF],decls:5,vars:17,consts:[[1,"label","theme-light",3,"labelUpdated","offsetUpdated","label","fit","opaque","fixedScale","pinDraggable","tagDraggable","isCollapsed","descriptionCollapsed","hasContent","sequence"],["label-body","",1,"label__body"],[3,"outline","hidden","options","formControl"],["class","label__summary flex items-start",3,"ngSwitch",4,"ngIf"],[1,"label__summary","flex","items-start",3,"ngSwitch"],["class","label__icon label__icon--correct","style","font-size: 16px","icon","check-circle",4,"ngSwitchCase"],["class","label__icon label__icon--incorrect","style","font-size: 16px","icon","times-circle",4,"ngSwitchCase"],["class","label__text pl-2",4,"ngSwitchCase"],["icon","check-circle",1,"label__icon","label__icon--correct",2,"font-size","16px"],["icon","times-circle",1,"label__icon","label__icon--incorrect",2,"font-size","16px"],[1,"label__text","pl-2"],[1,"font-semibold"],[1,"pb-2"]],template:function(l,m){1&l&&(t.j41(0,"app-generic-label",0),t.nI1(1,"async"),t.bIt("labelUpdated",function(b){return m.handleLabelUpdated(b)})("offsetUpdated",function(b){return m.handleOffsetUpdated(b)}),t.j41(2,"div",1),t.nrm(3,"app-quiz-label-anatomy-select",2),t.DNE(4,d,5,5,"div",3),t.k0s()()),2&l&&(t.Y8G("label",m.option.label)("fit","summary"===m.mode?"fixed":"auto")("opaque",!0)("fixedScale",t.bMT(1,15,m.labelScale$))("pinDraggable","edit"===m.mode)("tagDraggable",!0)("isCollapsed",m.collapsed)("descriptionCollapsed",!1)("hasContent",!0)("sequence",m.sequence),t.R7$(3),t.Y8G("outline",!1)("hidden","summary"===m.mode)("options",m.options)("formControl",m.control),t.R7$(),t.Y8G("ngIf","summary"===m.mode))},dependencies:[e.MD,e.bT,e.ux,e.e1,e.Jj,s.YN,s.BC,s.X1,s.l_,E.o,y.R,a.P,f.w],styles:[".label__body[_ngcontent-%COMP%]{color:#101823;min-width:142px;max-width:200px}.label__icon[_ngcontent-%COMP%]{position:relative;flex-basis:0 0 20px;justify-content:center}.label__icon--correct[_ngcontent-%COMP%]{color:#83e692}.label__icon--incorrect[_ngcontent-%COMP%]{color:#f44336}.label__text[_ngcontent-%COMP%]{flex-wrap:wrap}"],changeDetection:0})}!function(_,u,l,m){var R,C=arguments.length,b=C<3?u:null===m?m=Object.getOwnPropertyDescriptor(u,l):m;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)b=Reflect.decorate(_,u,l,m);else for(var A=_.length-1;A>=0;A--)(R=_[A])&&(b=(C<3?R(b):C>3?R(u,l,b):R(u,l))||b);C>3&&b&&Object.defineProperty(u,l,b)}([(0,c.l6)(S.y.getLabelScale),function(_,u){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata("design:type",u)}(0,O.c)],r.prototype,"labelScale$",void 0)},8465:(le,N,n)=>{"use strict";n.d(N,{M:()=>u});var e=n(60177),t=n(89417),s=n(92014),c=n(49204),P=n(85052),S=n(82656),a=n(2573),f=n(21082),E=n(37925),y=n(14264),i=n(76016),g=n(87710),p=n(38753),h=n(45911),o=n(54438),v=n(38645),d=function(l,m,C,b){var G,R=arguments.length,A=R<3?m:null===b?b=Object.getOwnPropertyDescriptor(m,C):b;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)A=Reflect.decorate(l,m,C,b);else for(var k=l.length-1;k>=0;k--)(G=l[k])&&(A=(R<3?G(A):R>3?G(m,C,A):G(m,C))||A);return R>3&&A&&Object.defineProperty(m,C,A),A},r=function(l,m){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(l,m)};function _(l,m){if(1&l){const C=o.RV6();o.qex(0),o.j41(1,"app-quiz-label",3),o.nI1(2,"async"),o.nI1(3,"async"),o.nI1(4,"async"),o.nI1(5,"async"),o.nI1(6,"async"),o.bIt("labelUpdated",function(R){const A=o.eBV(C).index,G=o.XpG();return o.Njj(G.handleLabelUpdated(R,A))}),o.k0s(),o.bVm()}if(2&l){const C=m.$implicit,b=m.index,R=o.XpG();o.R7$(),o.Y8G("mode",R.mode)("formControl",C)("option",o.bMT(2,7,R.quizLabels$)[b])("options",o.bMT(3,9,R.quizLabels$))("sequence",b+1)("correct",R.isCorrect(o.bMT(4,11,R.quizLabels$)[b],o.bMT(5,13,R.activeSubmitted$),b))("collapsed",o.bMT(6,15,R.labelsCollapsed$))}}class u{constructor(m,C,b,R){this.store=m,this.formBuilder=C,this.changeRef=b,this.router=R,this.ngUnsubscribe=new P.B,this.mode="edit",this.form=this.formBuilder.group({options:this.formBuilder.array([])}),this.optionsArray=this.form.get("options")}ngOnInit(){this.initFormListeners(),this.initQuizSubmissionListeners()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initFormListeners(){this.quizLabels$.pipe((0,f.F)((m,C)=>{const b=m.map(A=>A.value),R=C.map(A=>A.value);return(0,c.isEqual)(b,R)}),(0,E.Q)(this.ngUnsubscribe)).subscribe(m=>{const C=this.store.selectSnapshot(g.j.getQuizModeActive);this.buildFormOptions(m,C),this.changeRef.markForCheck()}),(0,S.z)([this.quizModeActive$,this.quizLabels$]).pipe((0,E.Q)(this.ngUnsubscribe)).subscribe(([m])=>{this.setFormEnabled(m),this.changeRef.markForCheck()})}initQuizSubmissionListeners(){this.activeSubmission$.pipe((0,y.p)(m=>!(0,c.isNil)(m)&&!(0,c.isNil)(m.answer)&&Array.isArray(m.answer)),(0,f.F)((m,C)=>(0,c.isEqual)(m,C)),(0,E.Q)(this.ngUnsubscribe)).subscribe(m=>{const b=m.answer;(0,c.isEqual)(this.form.value.options,b)||(this.form.patchValue({options:b},{emitEvent:!1,onlySelf:!0}),this.changeRef.markForCheck())}),this.form.valueChanges.pipe((0,f.F)((m,C)=>(0,c.isEqual)(m,C)),(0,E.Q)(this.ngUnsubscribe)).subscribe(m=>{const C=this.store.selectSnapshot(g.j.getActiveQuestionId),b=this.store.selectSnapshot(g.j.getActiveSubmitted),R=this.store.selectSnapshot(g.j.getActiveSubmission),A=(0,c.isNil)(R)?[]:R.answer,G=m.options;(0,c.isNil)(b)&&((0,c.isEqual)(G,A)||this.store.dispatch(new i.B.SetActiveSubmission({questionId:C,answer:G})),this.changeRef.markForCheck())}),(0,S.z)([this.quizModeActive$,this.activeSubmitted$]).subscribe(([m,C])=>{this.mode=this.router.url.includes("/edit")?"edit":m&&!(0,c.isNil)(C)?"summary":"view",this.changeRef.markForCheck()})}isCorrect(m,C,b){if(!(0,c.isNil)(C))return C.answer[b]===m.value}handleLabelUpdated(m,C){const b=this.store.selectSnapshot(g.j.getActiveQuestion);b.data.options[C].label=m,this.store.dispatch(new i.B.SetQuestion(b))}buildFormOptions(m,C){this.optionsArray.clear(),m.forEach(b=>{this.optionsArray.push(this.formBuilder.control(C?"":b.value))})}setFormEnabled(m){m?this.optionsArray.enable():this.optionsArray.disable()}static#e=this.\u0275fac=function(C){return new(C||u)(o.rXU(s.il),o.rXU(t.ze),o.rXU(o.gRc),o.rXU(v.Ix))};static#t=this.\u0275cmp=o.VBU({type:u,selectors:[["app-quiz-labels"]],standalone:!0,features:[o.aNF],decls:3,vars:2,consts:[["data-test","quizLabelsElement",3,"formGroup"],["formArrayName","options"],[4,"ngFor","ngForOf"],["data-test","appQuizLabel",3,"labelUpdated","mode","formControl","option","options","sequence","correct","collapsed"]],template:function(C,b){1&C&&(o.j41(0,"div",0)(1,"div",1),o.DNE(2,_,7,17,"ng-container",2),o.k0s()()),2&C&&(o.Y8G("formGroup",b.form),o.R7$(2),o.Y8G("ngForOf",b.optionsArray.controls))},dependencies:[e.MD,e.Sq,e.Jj,t.YN,t.BC,t.cb,t.X1,t.l_,t.j4,t.v8,h.l],changeDetection:0})}d([(0,s.l6)(p.y.getLabelsCollapsed),r("design:type",a.c)],u.prototype,"labelsCollapsed$",void 0),d([(0,s.l6)(g.j.getActiveQuestionLabels),r("design:type",a.c)],u.prototype,"quizLabels$",void 0),d([(0,s.l6)(g.j.getQuizModeActive),r("design:type",a.c)],u.prototype,"quizModeActive$",void 0),d([(0,s.l6)(g.j.getAllSubmissions),r("design:type",a.c)],u.prototype,"allSubmissions$",void 0),d([(0,s.l6)(g.j.getActiveSubmission),r("design:type",a.c)],u.prototype,"activeSubmission$",void 0),d([(0,s.l6)(g.j.getActiveSubmitted),r("design:type",a.c)],u.prototype,"activeSubmitted$",void 0)},47001:(le,N,n)=>{"use strict";n.d(N,{L:()=>V});var e=n(92014),t=n(49204),c=n(85052),O=n(2573),P=n(37925),S=n(87996),a=n(65294),f=n(7431),E=n(3829),y=n(47610),i=n(8358),g=n(38157),p=n(15375),o=(n(69568),n(93915)),v=n(38753),d=n(60177),r=n(24125),_=n(35286),u=n(39685),l=n(54438),m=n(83621),C=n(40819),b=function(W,T,x,z){var L,I=arguments.length,D=I<3?T:null===z?z=Object.getOwnPropertyDescriptor(T,x):z;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)D=Reflect.decorate(W,T,x,z);else for(var Q=W.length-1;Q>=0;Q--)(L=W[Q])&&(D=(I<3?L(D):I>3?L(T,x,D):L(T,x))||D);return I>3&&D&&Object.defineProperty(T,x,D),D},R=function(W,T){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(W,T)};const A=["body"];function G(W,T){if(1&W&&(l.nrm(0,"div",6),l.nI1(1,"markdown"),l.nI1(2,"async")),2&W){const x=l.XpG();l.Y8G("innerHTML",l.bMT(2,3,l.bMT(1,1,x.label.description)),l.npT)}}function k(W,T){if(1&W&&(l.j41(0,"div",7),l.nrm(1,"app-content-blocks",8),l.k0s()),2&W){const x=l.XpG();l.R7$(),l.Y8G("contentBlocks",x.label.contentBlocks)("layout","compact")}}class V{get isCollapsed(){if(this.collapsedMode===p.Q.Toggle){const T=this.store.selectSnapshot(v.y.getSelectedLabelId)===this.label.id;return this.collapsed&&!T}return this.collapsed}get hasContent(){return this.labelsService.hasContent(this.label)}constructor(T,x,z,I){this.changeDetectorRef=T,this.labelsService=x,this.store=z,this.applicationEventService=I,this.emitEvents=!0,this.collapsedMode=p.Q.None,this.collapsed=!1,this.pinDraggable=!1,this.tagDraggable=!1,this.descriptionCollapsed=!1,this.tagCollapsed=!1,this.ngUnsubscribe=new c.B}ngOnInit(){this.selectedLabel$.pipe((0,P.Q)(this.ngUnsubscribe)).subscribe(x=>this.handleLabelSelected(x)),this.store.select(v.y.getChapterLabels).pipe((0,P.Q)(this.ngUnsubscribe),(0,S.B)(100)).subscribe(()=>{this.sequence=this.store.selectSnapshot(v.y.getLabelSequence(this.label)),this.changeDetectorRef.markForCheck()}),this.descriptionCollapsed=this.label.collapseDescription,this.tagCollapsed=this.label.hideTag||!(this.label.title||this.hasContent)}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}handleLabelUpdated(T){const{label:x,shouldPreserve:z}=T;this.store.dispatch(new o.lb(x,z))}handleOffsetUpdated(T){const{labelId:x,offset:z}=T;this.store.dispatch(new o.yi(x,z))}handlePinClicked(T){this.selectLabel()}handleTagClicked(T){this.selectLabel()}selectLabel(){const T=this.store.selectSnapshot(v.y.getSelectedLabel);this.store.dispatch(new o.TR(T&&T.id===this.label.id?null:this.label)),this.emitEvent(a.F.HotspotsPicked,{id:this.label.id}),this.emitEvent(a.F.LabelsPicked,{labelId:this.label.id})}emitEvent(T,x){this.emitEvents&&this.applicationEventService.fireEvent(T,x)}handleDisplayUpdated(T){this.setBodyOpacity(T.shown),this.emitEvent(a.F.HotspotsDisplayUpdated,T)}handlePositionUpdated(T){this.emitEvent(a.F.HotspotsPositionUpdated,T.positionUpdate),this.emitEvent(a.F.LabelsMoved,{labelId:T.positionUpdate.id,canvasPosition:[T.positionUpdate.canvasPos.x,T.positionUpdate.canvasPos.y],occluded:T.positionUpdate.occluded||!T.onCanvas})}handleHoverStart(T){this.emitEvent(a.F.HotspotsEntered,{id:T.labelId}),this.emitEvent(a.F.LabelsEntered,{labelId:T.labelId})}handleHoverEnd(T){this.emitEvent(a.F.HotspotsLeft,{id:T.labelId}),this.emitEvent(a.F.LabelsLeft,{labelId:T.labelId})}handleLabelSelected(T){const x=T&&T.id===this.label.id,z=(0,t.get)(T,"states[1].errands"),I=this.store.selectSnapshot(E.x.getLockCamera);x&&z&&!I&&z.forEach(L=>{switch(L.type){case g.X.flyToObject:this.store.dispatch(new y.W6(L.value));break;case g.X.flyToCamera:this.store.dispatch(new f.Ih(L.value))}this.store.dispatch(new f.Xz(!0))}),this.tagCollapsed=!this.label.title&&!this.hasContent||(this.label.expandTag&&this.label.hideTag?!x:this.label.hideTag),this.descriptionCollapsed=this.label.showDescription&&this.label.collapseDescription?!x:this.label.collapseDescription}handleBodyPointerDown(T){const x=this.body.nativeElement,z=x.offsetWidth-x.clientWidth;if(z>0){const D=x.getBoundingClientRect().right-z;T.clientX>D&&T.stopPropagation()}}handleBodyWheel(T){const x=this.body.nativeElement;x.scrollHeight>x.clientHeight&&T.stopPropagation()}setBodyOpacity(T){const x=this.body.nativeElement;T?x.style.removeProperty("opacity"):x.style.opacity="0"}static#e=this.\u0275fac=function(x){return new(x||V)(l.rXU(l.gRc),l.rXU(i.x),l.rXU(e.il),l.rXU(m.S))};static#t=this.\u0275cmp=l.VBU({type:V,selectors:[["app-story-label"]],viewQuery:function(x,z){if(1&x&&l.GBs(A,7),2&x){let I;l.mGM(I=l.lsd())&&(z.body=I.first)}},inputs:{label:"label",emitEvents:"emitEvents",collapsedMode:"collapsedMode",collapsed:"collapsed",pinDraggable:"pinDraggable",tagDraggable:"tagDraggable"},standalone:!0,features:[l.aNF],decls:10,vars:20,consts:[["body",""],[1,"story-label",3,"labelUpdated","offsetUpdated","tagClicked","pinClicked","keydown.enter","displayUpdated","positionUpdated","hoverStart","hoverEnd","label","selected","fixedScale","sequence","isCollapsed","tagCollapsed","pinDraggable","tagDraggable","descriptionCollapsed","hasContent"],["label-header","",1,"html",3,"innerHTML"],["label-body","",1,"story-label__body","html",3,"pointerdown","wheel"],["data-test","labelDescription",3,"innerHTML",4,"ngIf"],["class","my-1","appEventFence","","style","cursor: auto",4,"ngIf"],["data-test","labelDescription",3,"innerHTML"],["appEventFence","",1,"my-1",2,"cursor","auto"],[3,"contentBlocks","layout"]],template:function(x,z){if(1&x){const I=l.RV6();l.j41(0,"app-generic-label",1),l.nI1(1,"async"),l.nI1(2,"async"),l.bIt("labelUpdated",function(L){return l.eBV(I),l.Njj(z.handleLabelUpdated(L))})("offsetUpdated",function(L){return l.eBV(I),l.Njj(z.handleOffsetUpdated(L))})("tagClicked",function(L){return l.eBV(I),l.Njj(z.handleTagClicked(L))})("pinClicked",function(L){return l.eBV(I),l.Njj(z.handlePinClicked(L))})("keydown.enter",function(L){return l.eBV(I),l.Njj(z.handleTagClicked(L))})("displayUpdated",function(L){return l.eBV(I),l.Njj(z.handleDisplayUpdated(L))})("positionUpdated",function(L){return l.eBV(I),l.Njj(z.handlePositionUpdated(L))})("hoverStart",function(L){return l.eBV(I),l.Njj(z.handleHoverStart(L))})("hoverEnd",function(L){return l.eBV(I),l.Njj(z.handleHoverEnd(L))}),l.nrm(3,"div",2),l.nI1(4,"markdown"),l.nI1(5,"async"),l.j41(6,"div",3,0),l.bIt("pointerdown",function(L){return l.eBV(I),l.Njj(z.handleBodyPointerDown(L))})("wheel",function(L){return l.eBV(I),l.Njj(z.handleBodyWheel(L))}),l.DNE(8,G,3,5,"div",4)(9,k,2,2,"div",5),l.k0s()()}if(2&x){let I;l.Y8G("label",z.label)("selected",(null==(I=l.bMT(1,12,z.selectedLabel$))?null:I.id)===z.label.id)("fixedScale",l.bMT(2,14,z.labelScale$))("sequence",z.sequence)("isCollapsed",z.isCollapsed)("tagCollapsed",z.tagCollapsed)("pinDraggable",z.pinDraggable)("descriptionCollapsed",z.descriptionCollapsed)("hasContent",z.hasContent),l.R7$(3),l.Y8G("innerHTML",l.bMT(5,18,l.bMT(4,16,z.label.title)),l.npT),l.R7$(5),l.Y8G("ngIf",z.label.description),l.R7$(),l.Y8G("ngIf",z.label.contentBlocks)}},dependencies:[d.MD,d.bT,d.Jj,r.P,_.y2,_.i0,u.y,C.l],styles:[".story-label__body[_ngcontent-%COMP%]{max-height:120px;overflow-x:hidden;overflow-y:auto;margin-right:-8px;padding-right:8px}"],changeDetection:0})}b([(0,e.l6)(v.y.getLabelScale),R("design:type",O.c)],V.prototype,"labelScale$",void 0),b([(0,e.l6)(v.y.getSelectedLabel),R("design:type",O.c)],V.prototype,"selectedLabel$",void 0)},8358:(le,N,n)=>{"use strict";n.d(N,{x:()=>u});var e=n(69568),t=n(59429),s=n(24151),c=n(76872),O=n(92677),P=n(16124),S=n(49746),a=n(95370),f=n(40470),E=n(20714),y=n(38157),i=n(1300),g=n(79817),p=n(49204),o=n(12347),v=n(35650),d=n(54438);const r={flyToCamera:"flyTo",flyToChapter:"flyTo"};let u=(()=>{class l{constructor(C,b){this.animationService=C,this.sceneService=b,this.convertActionToErrand=(R,A,G)=>{const k=new RegExp("^flyTo(Async)?"),V=new RegExp("^flyToObject(Async)?"),W=new RegExp("^flyTo[w.:]+currentChapter.[flyTo|jumpTo]"),T=G.split(":").slice(0,2),x=R;let z=T[1];/currentChapter/.test(z)&&(z=z.replace("currentChapter",`chapters[${A}]`));let I=null;return V.test(T[0])?I=new S.F((0,p.get)(x,z)):k.test(T[0])?I=new a.v((0,p.get)(x,z)):W.test(T[0])&&(I=new i.T),I},this.convertErrandToAction=(R,A)=>{const G=t.u.idWithPrefix("errand").replace(/-/g,"_"),k={};let V="";const W=function _(l){return r[l]||l}(A.type);return A.type===y.X.flyToChapter||(V=`${W}Async:currentChapter.customData.${G}`,k[G]=A.value),{action:V,data:k}}}filterHotspot(C,b,R){const A=new RegExp("^(flyTo|flyToObject|hideHotspot|showHotspot|resetHotspots)"),G=this.getHotspotAction(C,R),k=G.filter(V=>A.test(V));return G.length===k.length}deserializeAnnotation(C,b,R){const A=new e.ed(C.title||"");return A.id=C.annotationId||t.u.idWithPrefix("label"),A.chapterId=b.id,A.expandTag=!0,A.showDescription=!0,A.collapseDescription=!1,A.pinGlow=!1,A.hideWire=!1,A.hideTag=!1,R===c.D.Annotation?(A.theme=c.D.Annotation,A.pinType=s.O.Default,A.flyTo=!1,A.states=[]):(A.theme=c.D.StudioNext,A.pinType=s.O.PlusMinus,A.flyTo=!0,A.states=[new P.B,new P.B],A.states[0].errands=[new i.T],A.states[1].errands=[new S.F(C.objectId)]),A.occludable=!1!==C.occludable,A.renderableIndex=C.renderableIndex||0,C.objectId&&Object.prototype.hasOwnProperty.call(C,"barycentric")?(A.objectId=C.objectId,A.primitiveIndex=C.primitiveIndex,A.barycentric=C.barycentric):Object.prototype.hasOwnProperty.call(C,"pos")&&(Object.prototype.hasOwnProperty.call(C,"objectId")&&(A.objectId=C.objectId),A.pos=C.pos),C.dir&&Array.isArray(C.dir)?A.dir=C.dir:C.dir&&C.dir instanceof Object&&(A.dir=Object.values(C.dir)),A.description=C.description||"",A.offset=C.labelOffset||[40,40],A.shown=!1!==C.shown,A.labelShown=!1!==C.labelShown,A}deserializeHotspots(C,b,R,...A){const[G,k]=A,V=new e.ed(G.title||"");switch(V.id=t.u.idWithPrefix("hotspot"),V.objectId=G.objectId,V.chapterId=b.id,V.description=G.description||"",V.pinType=/plus|minus/.test(G.className)?s.O.PlusMinus:/sequential/.test(G.className)?s.O.Sequential:/none/.test(G.className)?s.O.None:s.O.Default,/alphabetical/.test(G.className)?V.sequentialType=g.C.Alphabetical:/numerical/.test(G.className)&&(V.sequentialType=g.C.Numerical),V.pinGlow=/pulse/.test(G.className),V.occludable=!0,V.shown=G.shown,V.offset=G.labelOffset?G.labelOffset:[22,-17],(/left/.test(G.className)&&V.offset[0]>0||/right/.test(G.className)&&V.offset[0]<0)&&(V.offset[0]*=-1),Object.prototype.hasOwnProperty.call(G,"barycentric")?(V.renderableIndex=G.renderableIndex||0,V.barycentric=G.barycentric,V.primitiveIndex=G.primitiveIndex):V.pos=G.pos,V.dir=G.dir,G.theme=G.theme?G.theme:O.T.classicHotspot,G.theme){case O.T.classicAnnotation:V.theme=c.D.Annotation,V.showDescription=!0,V.collapseDescription=/collapsible/g.test(G.className),V.expandTag=G.expandTag??!0,V.hideTag=G.hideTag??!1,V.hideWire=!/leader-line/.test(G.className);break;case O.T.classicHotspot:V.theme=c.D.Classic,V.showDescription=/label/.test(G.className),V.expandTag=/label/.test(G.className),V.hideTag=!V.expandTag,V.collapseDescription=!1,V.hideWire=!/leader-line/.test(G.className);break;case O.T.studioNext:V.theme=c.D.StudioNext,V.showDescription=this.hasContent(G),V.collapseDescription=/collapsible/g.test(G.className),V.hideTag=G.hideTag??!1,V.expandTag=G.expandTag??!0,V.hideWire=!/leader-line/.test(G.className);break;case O.T.custom:V.theme=c.D.Custom,V.themeStyles=G.themeStyles,V.showDescription=this.hasContent(G),V.collapseDescription=/collapsible/g.test(G.className),V.hideTag=G.hideTag??!1,V.expandTag=G.expandTag??!0,V.hideWire=!/leader-line/.test(G.className)}V.flyTo=!1,V.flyToTarget=null,V.states=[];const W=this.filterHotspotActions(this.getHotspotAction(C,G)),T=k?this.filterHotspotActions(this.getHotspotAction(C,k)):[],x=new P.B,z=new P.B;W.length&&(x.errands=W.map(D=>this.convertActionToErrand(C,R,D))),T.length&&(z.errands=T.map(D=>this.convertActionToErrand(C,R,D))),V.states=[z,x],x.errands.length>0&&(V.flyTo=!0,V.flyToTarget=x.errands[0].type,x.errands[0].type===y.X.flyToCamera&&(V.cameraPosition=x.errands[0].value));const I=G.contentBlocks;return I&&(V.contentBlocks=JSON.parse(JSON.stringify(I))),V}makeDefaultStudioLabel(C){const b=C?{...C}:new e.ed("");return b.pinType=s.O.PlusMinus,b.theme=c.D.StudioNext,b.expandTag=!0,b.showDescription=!0,b.collapseDescription=!1,b.pinGlow=!1,b.hideWire=!1,b.hideTag=!1,b.occludable=!0,b.flyTo=!0,b.description="",b.shown=!0,b.states=[new P.B,new P.B],b}makeAnnotationLabel(C){const b=C?{...C}:new e.ed("");return b.pinType=s.O.Default,b.theme=c.D.Annotation,b.expandTag=!0,b.showDescription=!0,b.collapseDescription=!1,b.pinGlow=!1,b.hideWire=!1,b.hideTag=!1,b.states=[],b}serializeLabel(C,b){const R={symbol:void 0,className:void 0,dir:void 0,objectId:void 0,shown:void 0,type:void 0},A=(0,f.uK)(C),G=["circle","draggable"];if(R.shown=!0,C.objectId&&(R.objectId=A.objectId),C.objectId&&C.primitiveIndex&&C.barycentric)R.renderableIndex=C.renderableIndex||0,R.primitiveIndex=C.primitiveIndex,R.barycentric=C.barycentric;else{if(!C.objectId)return{data:{},hotspots:[]};R.pos=A.pos}switch((Array.isArray(C.dir)||ArrayBuffer.isView(C.dir))&&(R.dir=Array.prototype.slice.call(C.dir)),R.labelOffset=C.offset,C.theme){case c.D.Annotation:R.theme=O.T.classicAnnotation;break;case c.D.Classic:R.theme=O.T.classicHotspot;break;case c.D.Custom:R.theme=O.T.custom,R.themeStyles=C.themeStyles;break;default:R.theme=O.T.studioNext}R.hideTag=A.hideTag,R.expandTag=A.expandTag,""!==A.title||""!==A.description?(R.title=A.title,R.description=A.description,R.type=E.H.CircleLabel):R.type=E.H.Circle,C.pinGlow&&G.push("pulse"),C.pinType===s.O.PlusMinus&&G.push("plus"),C.pinType===s.O.Sequential&&(G.push("sequential"),G.push(C.sequentialType===g.C.Alphabetical?"alphabetical":"numerical")),C.pinType===s.O.None&&G.push("none"),C.hideWire||G.push("leader-line"),C.hideTag||G.push("label"),C.collapseDescription&&G.push("collapsible collapsed"),R.className=G.join(" ");let k={};R.actions=[];const V=[R],W=C.states.length;C.states.forEach((x,z)=>{if(z===W-1)V[0].actions.push("resetHotspots"),x.errands.forEach(I=>{const D=this.convertErrandToAction(C,I);V[0].actions.push(D.action),k={...k,...D.data}});else{const I=(0,p.cloneDeep)(R);I.actions=[],I.className=I.className.replace("plus","minus"),x.errands.forEach(D=>{const L=this.convertErrandToAction(C,D);I.actions.push(L.action),k={...k,...L.data}}),V.push(I)}}),2===V.length&&(V[0].actions.push(`hideHotspots:currentChapter.hotspots[${b}]`),V[0].actions.push(`showHotspots:currentChapter.hotspots[${b+1}]`),V[1].actions.push(`hideHotspots:currentChapter.hotspots[${b+1}]`),V[1].actions.push(`showHotspots:currentChapter.hotspots[${b}]`),V[0].shown=!0,V[1].shown=!1),2===V.length&&C.collapseDescription&&(V[1].className+=V[1].className.replace("collapsed","")),V.forEach(x=>{R.labelOffset[0]<0?x.className=x.className.replace("right","")+" left":R.labelOffset[0]>0&&(x.className=x.className.replace("left","")+" right")});const T=C.contentBlocks;return T&&(R.contentBlocks=JSON.parse(JSON.stringify(T))),{data:k,hotspots:V}}setLabelContainer(C){this._labelContainer=C}getLabelContainer(){return this._labelContainer}hasContent(C){const{description:b,contentBlocks:R}=C;return!!b||!(0,p.isNil)(R)&&R.length>0}getHotspotAction(C,b){const R=b.actionSrc?(0,p.get)(C,b.actionSrc):b.actions?b.actions:[];return Array.isArray(R)?R:[]}filterHotspotActions(C){const b=new RegExp("^(flyTo|flyToObject)");return C.filter(R=>b.test(R))}static#e=this.\u0275fac=function(b){return new(b||l)(d.KVO(o.O),d.KVO(v.w))};static#t=this.\u0275prov=d.jDH({token:l,factory:l.\u0275fac,providedIn:"root"})}return l})()},17042:(le,N,n)=>{"use strict";n.d(N,{n:()=>u});var e=n(85052),t=n(82656),s=n(2573),c=n(14264),O=n(37925),P=n(94909),S=n(92014),a=n(49204),E=n(94495),y=n(33013),i=n(61295),g=n(13409),p=n(63365),h=n(35650),o=n(60286),v=n(76304),d=n(54438),r=function(l,m,C,b){var G,R=arguments.length,A=R<3?m:null===b?b=Object.getOwnPropertyDescriptor(m,C):b;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)A=Reflect.decorate(l,m,C,b);else for(var k=l.length-1;k>=0;k--)(G=l[k])&&(A=(R<3?G(A):R>3?G(m,C,A):G(m,C))||A);return R>3&&A&&Object.defineProperty(m,C,A),A},_=function(l,m){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(l,m)};class u{constructor(m,C,b){this.store=m,this.sceneService=C,this.paintService=b,this.nodeChapterOpacities={}}initObservables(){this.nodesLayerIndex=0,this.objectsLayerIndex=0,this.nodeChapterOpacities={},this.destroyObservables(),this.ngUnsubscribe=new e.B,(0,t.z)([this.selectedChapterId$,this.selectedEngineChapterId$]).pipe((0,c.p)(([m,C])=>m&&(0,a.isEqual)(m,C)),(0,O.Q)(this.ngUnsubscribe)).subscribe(([m])=>{this.updateNodeChapterOpacities(m)}),this.selectedChapterCurrentLayers$.pipe((0,P.E)(this.selectedChapterCurrentLayersIndex$),(0,O.Q)(this.ngUnsubscribe)).subscribe(([,m])=>{this.nodesLayerIndex=this.objectsLayerIndex=m}),(0,t.z)([this.selectedChapterCurrentLayersIndex$,this.selectedChapterCurrentLayersPosition$,this.selectedChapterCurrentLayers$]).pipe((0,c.p)(([m,C])=>!(0,a.isNil)(m)&&!(0,a.isNil)(C)),(0,O.Q)(this.ngUnsubscribe)).subscribe(([m,C,b])=>{this.syncLayersToScene(b,m,C,!0)})}destroyObservables(){this.ngUnsubscribe&&(this.ngUnsubscribe.next(),this.ngUnsubscribe.complete(),this.ngUnsubscribe=null)}syncLayersToState(m,C,b){this.store.dispatch(new y.WZ(m,C,b,!0))}syncLayersToScene(m,C,b,R){this.updateLayerIndex(C,m,R),this.updateLayerPosition(b,m,R)}fractionToIndex(m,C){const b=this.getThreshold(m),R=Math.floor(C/b);return Math.max(0,Math.min(m.length-2,R))}fractionToPosition(m,C,b){const R=this.getThreshold(m);return Math.max(0,Math.min((C-R*b)/R,1))}indexPositionToFraction(m,C,b){const R=this.getThreshold(m);return C*R+b*R}fractionToPercent(m){return Math.round(100*(1-m))}percentToFraction(m){return 1-m/100}getThreshold(m){return m.length>1?1/(m.length-1):1}getCurrentLayerIndexProp(m){return m?"nodesLayerIndex":"objectsLayerIndex"}updateLayerIndex(m,C,b){const R=this.getCurrentLayerIndexProp(b);m!==this[R]&&(this.restoreLayers(m,this[R],C,b),b&&(this.nodesLayerIndex=m),this.objectsLayerIndex=m)}updateLayerPosition(m,C,b){const R=this.getCurrentLayerIndexProp(b),A=C[this[R]]?.objectIds;A?.length>0&&this.setObjectsOpacity(A,1-m)}restoreLayers(m,C,b,R){const G=(m-C)/Math.abs(m-C);let k=[],V=C;for(;V!==m;)k=k.concat(b[V].objectIds),V+=G;const T=-1===G;this.setObjectsOpacity(k,1===G?0:1),R?this.setNodesShown(k,T):this.setObjectsShown(k,T),-1===G&&(R?this.setNodesShown(b[m].objectIds,!0):this.setObjectsShown(b[m].objectIds,!0))}setObjectsOpacity(m,C){m.forEach(b=>{const R=this.nodeChapterOpacities[b];let A;Array.isArray(R)?(A=R.slice(),A[0]=C*R[0],A[1]=C*R[1]):A=C*R,this.paintService.colorObject(b,{opacity:A})})}updateNodeChapterOpacities(m){const b=this.store.selectSnapshot(g.z.getAllNodeState)[m];this.nodeChapterOpacities={},Object.entries(b).forEach(([R,A])=>{if(this.nodeChapterOpacities[R]=1,A.paint&&Object.prototype.hasOwnProperty.call(A.paint,"opacity")){const G=(0,p.Sf)(A.paint);!1!==G.opacity&&(this.nodeChapterOpacities[R]=G.opacity)}})}setObjectsShown(m,C){const b={};for(let R=0;R<m.length;R++)b[m[R]]=C;this.sceneService.setShownObjects({showObjects:b})}setNodesShown(m,C){this.store.dispatch(new i.yr(C,m,void 0,!1))}static#e=this.\u0275fac=function(C){return new(C||u)(d.KVO(S.il),d.KVO(h.w),d.KVO(o.s))};static#t=this.\u0275prov=d.jDH({token:u,factory:u.\u0275fac,providedIn:"root"})}r([(0,S.l6)(E.N.getSelectedChapterCurrentLayers),_("design:type",s.c)],u.prototype,"selectedChapterCurrentLayers$",void 0),r([(0,S.l6)(E.N.getSelectedChapterCurrentLayersIndex),_("design:type",s.c)],u.prototype,"selectedChapterCurrentLayersIndex$",void 0),r([(0,S.l6)(E.N.getSelectedChapterCurrentLayersPosition),_("design:type",s.c)],u.prototype,"selectedChapterCurrentLayersPosition$",void 0),r([(0,S.l6)(E.N.getSelectedChapterId),_("design:type",s.c)],u.prototype,"selectedChapterId$",void 0),r([(0,S.l6)(v.S.getChapter),_("design:type",s.c)],u.prototype,"selectedEngineChapterId$",void 0)},3367:(le,N,n)=>{"use strict";n.d(N,{m:()=>E});var e=n(38472),t=n(49204),c=n(11724),P=n(79805),S=n(515),a=n(35650),f=n(54438);let E=(()=>{class y{constructor(g,p){this.engineService=g,this.sceneService=p,this.markers=new Map,this.initMarkerEvents()}getMarkerWorldPosition(g){if((0,t.isNil)(g))return;const p=e.clone(g.marker3D.position);return e.scale(p,p,1/c.BIODIGITAL_SCENE_SCALE),p}getMarkerById(g){return this.markers.get(g)}createMarker(g){const{id:p,objectId:h,primitiveIndex:o,renderableIndex:v,barycentric:d,pos:r}=g,{engine:_}=this.engineService,{activeChapter:u,chapters:l}=_.story,m=l.find(W=>W.id===g.chapterId)??u,C=o>=0?"primitive":"object";if(!h)return console.warn("An object id is required for creating a marker.",{id:p}),null;const b=this.sceneService.getObjectById(h);if((0,t.isNil)(b))return console.warn("A valid object id is required for creating a marker.",{id:p,objectId:h}),null;let R=r?e.clone(r):void 0;"object"===C&&(0,t.isNil)(R)&&(R=this.sceneService.getObjectBoundaryCenter(h)),(0,t.isNil)(R)||e.scale(R,R,c.BIODIGITAL_SCENE_SCALE);const A={object:b,trackingMode:C,renderableIndex:v||0,primitiveIndex:o,barycenter:d||[1/3,1/3,1/3],worldPosition:R,variantIndex:b.variant},k=(0,t.isNil)(_.renderer?.xrSession?.domOverlayState)?void 0:document.body,V=new c.BioDigitalScreenMarker(_,m,A,p,k);return this.markers.set(p,V),V.update(),V}deleteMarker(g){this.markers.get(g)?.destroy(),this.markers.delete(g)}deleteMarkers(){this.markers.forEach(g=>g.destroy()),this.markers.clear()}initMarkerEvents(){this.engineService.engineCreated$.subscribe(g=>{const{renderer:p}=g;p.on("update",()=>{p.xrSession?.domOverlayState||this.updateMarkers()}),p.on("xrframe",({viewerPose:h})=>{const o=h?.views?.[0];o&&p.xrSession?.domOverlayState&&this.updateMarkers(o)})})}updateMarkers(g){0!==this.markers.size&&(this.markers.forEach(p=>p.update(g)),this.engineService.fireEvent(S.X.SceneMarkersUpdated,this.markers))}static#e=this.\u0275fac=function(p){return new(p||y)(f.KVO(P.y),f.KVO(a.w))};static#t=this.\u0275prov=f.jDH({token:y,factory:y.\u0275fac,providedIn:"root"})}return y})()},45144:(le,N,n)=>{"use strict";n.d(N,{Y:()=>e});var e=function(t){return t.File="file",t.TTS="tts",t.None="none",t}(e||{})},62751:(le,N,n)=>{"use strict";n.d(N,{L:()=>e});var e=function(t){return t.JumpTo="jumpTo",t.FlyTo="flyTo",t}(e||{})},92333:(le,N,n)=>{"use strict";n.d(N,{y:()=>t}),n(62751);const t=$localize`Starting Position`},53799:(le,N,n)=>{"use strict";n.d(N,{A:()=>e,s:()=>t});const e={left:0,right:1,bottom:2,top:3,front:4,back:5},t={0:"left",1:"right",2:"bottom",3:"top",4:"front",5:"back"}},17766:(le,N,n)=>{"use strict";n.d(N,{c:()=>e});var e=function(t){return t.Bookmark="bookmark",t.Module="module",t.Internal="internal",t}(e||{})},38157:(le,N,n)=>{"use strict";n.d(N,{X:()=>e});var e=function(t){return t.flyToChapter="flyToChapter",t.flyToObject="flyToObject",t.flyToCamera="flyToCamera",t}(e||{})},95370:(le,N,n)=>{"use strict";n.d(N,{v:()=>t});var e=n(38157);class t{constructor(c){this.type=e.X.flyToCamera,this.value=c}}},1300:(le,N,n)=>{"use strict";n.d(N,{T:()=>t});var e=n(38157);class t{constructor(){this.type=e.X.flyToChapter,this.value=null}}},49746:(le,N,n)=>{"use strict";n.d(N,{F:()=>t});var e=n(38157);class t{constructor(c){this.type=e.X.flyToObject,this.value=c}}},92677:(le,N,n)=>{"use strict";n.d(N,{T:()=>e});var e=function(t){return t.classicAnnotation="classic-annotation",t.classicHotspot="classic-hotspot",t.studioNext="studio-light",t.custom="custom",t}(e||{})},20714:(le,N,n)=>{"use strict";n.d(N,{H:()=>e});var e=function(t){return t.Circle="circle",t.CirclePlus="circle-plus",t.CircleMinus="circle-minus",t.Label="label",t.CircleLabel="circle-label",t}(e||{})},15375:(le,N,n)=>{"use strict";n.d(N,{Q:()=>e});var e=function(t){return t.Toggle="toggle",t.None="none",t}(e||{})},24151:(le,N,n)=>{"use strict";n.d(N,{O:()=>e});var e=function(t){return t.Default="default",t.Plus="plus",t.Minus="minus",t.PlusMinus="plusMinus",t.Sequential="sequential",t.None="none",t}(e||{})},79817:(le,N,n)=>{"use strict";n.d(N,{C:()=>e});var e=function(t){return t.Alphabetical="alphabetical",t.Numerical="numerical",t}(e||{})},16124:(le,N,n)=>{"use strict";n.d(N,{B:()=>e});class e{constructor(){this.title=null,this.description=null,this.errands=[]}}},76872:(le,N,n)=>{"use strict";n.d(N,{D:()=>e});var e=function(t){return t.Annotation="annotation",t.Classic="classic",t.StudioNext="studioNext",t.Context="context",t.Custom="custom",t}(e||{})},69568:(le,N,n)=>{"use strict";n.d(N,{ed:()=>O});var e=n(24151),t=n(76872),s=n(79817);class O{constructor(a){this.pinType=e.O.PlusMinus,this.sequentialType=s.C.Alphabetical,this.theme=t.D.StudioNext,this.expandTag=!0,this.showDescription=!0,this.collapseDescription=!1,this.pinGlow=!1,this.hideWire=!1,this.hideTag=!1,this.title=a}}},11876:(le,N,n)=>{"use strict";n.d(N,{Z:()=>e});var e=function(t){return t.Single="single",t.Group="group",t}(e||{})},28722:(le,N,n)=>{"use strict";n.d(N,{Y:()=>e});var e=function(t){return t.None="none",t.Small="small",t.Full="full",t}(e||{})},57238:(le,N,n)=>{"use strict";n.d(N,{R:()=>t});var e=n(93455);class t extends e.V{}},91003:(le,N,n)=>{"use strict";n.d(N,{c:()=>m});var e=n(28407),t=n(92014),s=n(49204),O=n(40215),P=n(13976),S=n(65776),a=n(71441),f=n(3266),E=n(1308),y=n(30582),i=n(7431),g=n(1580),p=n(9592),h=n(97415),o=n(62751),v=n(33013),d=n(94495),r=n(82323),_=n(65650),u=n(10352),l=n(54438);let m=(()=>{class C{constructor(R,A,G,k,V,W){this.store=R,this.actions=A,this.cameraService=G,this.snapshotService=k,this.imagesService=V,this.contentBlocksService=W,this.startingPositionClipboard=null,this.additionalPositionClipboard=null,this.additionalPositionsClipboard=null}getCamera(){const R=this.cameraService.getCamera(),A=R.look,G=this.cameraService.getCameraRotationCenter();let k;return this.cameraService.compareXYZ(A,G)||(k=G),{location:R,rotationCenter:k}}getChapterStartingPosition(R){return{camera:this.store.selectSnapshot(d.N.getChapter(R)).camera,thumbnail:this.store.selectSnapshot(_.K.getRegisteredThumbnails).get(R)}}startingPositionToAdditionalPosition(R){const{camera:A,thumbnail:G}=this.getChapterStartingPosition(R),{location:k,rotationCenter:V,title:W}=A;return{camera:{location:k,rotationCenter:V,action:o.L.FlyTo},thumbnail:G,title:W}}copyStartingPosition(R){let A=!1;const{camera:G,thumbnail:k}=this.getChapterStartingPosition(R);return G&&k&&(this.startingPositionClipboard=(0,s.cloneDeep)({camera:G,thumbnail:k}),A=!0),A}pasteStartingPosition(R=!1){let A=0;if(this.startingPositionClipboard){const{camera:G,thumbnail:k}=this.startingPositionClipboard,V=R?this.store.selectSnapshot(d.N.getStoryChapters):[this.store.selectSnapshot(d.N.getSelectedChapter)];V.forEach(W=>{this.store.dispatch(new v.tn(W.id,G.location,G.rotationCenter)),this.store.dispatch(new v.pN(W.id,G.title)),this.store.dispatch(new r.cf(W.id,k))}),this.store.dispatch(new i.Ih(G.location)),A=V.length}return this.clearStartingPosition(),A}clearStartingPosition(){this.startingPositionClipboard=null}copyAdditionalPosition(R){this.additionalPositionClipboard=(0,s.cloneDeep)(R)}clearAdditionalPosition(){this.additionalPositionClipboard=null}copyAdditionalPositions(R){this.additionalPositionsClipboard=(0,s.cloneDeep)(R)}pasteAdditionalPositions(R=!1){let A=0;if(this.additionalPositionsClipboard){const G=R?this.store.selectSnapshot(d.N.getStoryChapters):[this.store.selectSnapshot(d.N.getSelectedChapter)];G.forEach(k=>{let V=this.contentBlocksService.findContentBlockByType(k.contentBlocks,S.m.Positions);V||(V=new a.z,k.contentBlocks.push(V)),V.positions.push(...this.additionalPositionsClipboard),this.store.dispatch(new v.jo(k.id,[...k.contentBlocks],!1))}),A=G.length}return this.clearAdditionalPositions(),A}clearAdditionalPositions(){this.additionalPositionsClipboard=null}clearAllClipboards(){this.clearStartingPosition(),this.clearAdditionalPosition(),this.clearAdditionalPositions()}captureStartingPositionCamera(R){const A=this.getCamera();this.store.dispatch(new v.tn(R,A.location,A.rotationCenter))}captureStartingPositionThumbnail(R){var A=this;return(0,e.A)(function*(){const{background:G,imageType:k,imageQuality:V,dimensions:W,crop:T,includeLabels:x,includeCopyright:z,layers:I}=A.getThumbnailSettings(R);return A.store.dispatch(new r.V9(R,G,k,V,W,T,x,z,I)),yield(0,O._)(A.actions.pipe((0,t.rM)(r.WX)))})()}captureAdditionalPositionThumbnail(R){var A=this;return(0,e.A)(function*(){const{background:G,imageType:k,imageQuality:V,dimensions:W,crop:T,includeLabels:x,includeCopyright:z,layers:I}=A.getThumbnailSettings(R),D={...E._,crop:T,imageType:k,imageQuality:V,copyrightEnabled:z},L=yield(0,O._)(A.snapshotService.takeSnapshot(W.width,W.height,G,I,x,D)),Q=yield(0,O._)(A.imagesService.saveImageBlob(L));return{small:Q.uris.small,large:Q.uris.large}})()}getThumbnailSettings(R){return{background:this.store.selectSnapshot(d.N.getChapter(R)).background??u.RK,imageType:p.H.JPEG,imageQuality:92,dimensions:h.I.medium,crop:"square",includeLabels:!1,includeCopyright:!1,layers:[]}}static#e=this.\u0275fac=function(A){return new(A||C)(l.KVO(t.il),l.KVO(t.En),l.KVO(f.j),l.KVO(y.M),l.KVO(g.M),l.KVO(P.V))};static#t=this.\u0275prov=l.jDH({token:C,factory:C.\u0275fac,providedIn:"root"})}return C})()},33013:(le,N,n)=>{"use strict";n.d(N,{$V:()=>I,Aq:()=>O,Bc:()=>se,EN:()=>R,Eh:()=>D,Ej:()=>C,Eo:()=>c,F0:()=>s,FN:()=>W,Lx:()=>g,M5:()=>o,Nw:()=>l,O:()=>i,Oj:()=>h,PA:()=>k,R:()=>_,VU:()=>f,WZ:()=>z,Wd:()=>A,X_:()=>u,YA:()=>V,bg:()=>de,eV:()=>v,is:()=>ie,jo:()=>L,jy:()=>p,lM:()=>a,lc:()=>Q,pN:()=>E,pb:()=>G,qi:()=>b,rT:()=>d,sC:()=>y,sN:()=>r,tg:()=>t,tn:()=>T,wg:()=>S,yr:()=>e,yz:()=>P,zh:()=>Z});let e=(()=>{class ae{static#e=this.type="[Story Chapter] Apply Patch";constructor(K){this.patches=K}}return ae})(),t=(()=>{class ae{static#e=this.type="[Story Chapter] Next Chapter";constructor(){}}return ae})(),s=(()=>{class ae{static#e=this.type="[Story Chapter] Previous Chapter";constructor(){}}return ae})(),c=(()=>{class ae{static#e=this.type="[Story Chapter] First Chapter";constructor(){}}return ae})(),O=(()=>{class ae{static#e=this.type="[Story Chapter] Last Chapter";constructor(){}}return ae})(),P=(()=>{class ae{static#e=this.type="[Story Chapter] Select Chapter";constructor(K){this.chapter=K}}return ae})(),S=(()=>{class ae{static#e=this.type="[Story Chapter] Select Chapter by chapter id";constructor(K){this.chapterId=K}}return ae})(),a=(()=>{class ae{static#e=this.type="[Story Chapter] Set Chapters";constructor(K){this.chapters=K}}return ae})(),f=(()=>{class ae{static#e=this.type="[Story Chapter] Set Chapter Camera Action";constructor(K,j){this.chapterId=K,this.cameraAction=j}}return ae})(),E=(()=>{class ae{static#e=this.type="[Story Chapter] Set Chapter Camera Title";constructor(K,j){this.chapterId=K,this.title=j}}return ae})(),y=(()=>{class ae{static#e=this.type="[Story Chapter] Set Chapter UI";constructor(K,j){this.chapterId=K,this.ui=j}}return ae})(),i=(()=>{class ae{static#e=this.type="[Story Chapter] Set Chapter Info";constructor(K,j,M){this.chapterId=K,this.description=j,this.displayName=M}}return ae})(),g=(()=>{class ae{static#e=this.type="[Story Chapter] Set Chapter Legend";constructor(K,j){this.chapterId=K,this.legend=j}}return ae})(),p=(()=>{class ae{static#e=this.type="[Story Chapter] Add To Chapter Legend";constructor(K,j){this.chapterId=K,this.legend=j}}return ae})(),h=(()=>{class ae{static#e=this.type="[Story Chapter] Reorder Chapters";constructor(K,j){this.previousIndex=K,this.currentIndex=j}}return ae})(),o=(()=>{class ae{static#e=this.type="[Story Chapter] Set Readystate";constructor(K,j){this.chapterId=K,this.readyState=j}}return ae})(),v=(()=>{class ae{static#e=this.type="[Story Chapter] Build Chapter Visibility Layers";constructor(K){this.chapterId=K}}return ae})(),d=(()=>{class ae{static#e=this.type="[Story Chapter] Set Chapter PostProcessing";constructor(K,j,M){this.chapterId=K,this.effects=j,this.properties=M}}return ae})(),r=(()=>{class ae{static#e=this.type="[Story Chapter] Set Chapter Transitions";constructor(K,j,M){this.chapterId=K,this.transition=j,this.key=M}}return ae})(),_=(()=>{class ae{static#e=this.type="[Story Chapter] Set Chapter Properties";constructor(K,j){this.chapterIds=K,this.properties=j}}return ae})(),u=(()=>{class ae{static#e=this.type="[Story Chapter] Remove Chapter Properties";constructor(K,j){this.chapterIds=K,this.properties=j}}return ae})(),l=(()=>{class ae{static#e=this.type="[Story Chapter] Set Chapter Transparency Mode";constructor(K,j){this.chapterId=K,this.transparencyMode=j}}return ae})(),C=(()=>{class ae{static#e=this.type="[Story Chapter] Set Chapter Clipping Planes";constructor(K,j,M,$){this.chapterId=K,this.clips=j,this.enabled=M,this.record=$}}return ae})(),b=(()=>{class ae{static#e=this.type="[Story Chapter] Set Chapter Background";constructor(K,j){this.chapterId=K,this.background=j}}return ae})(),R=(()=>{class ae{static#e=this.type="[Story Chapter] Set All Chapters Background";constructor(K){this.background=K}}return ae})(),A=(()=>{class ae{static#e=this.type="[Story Chapter] Reset Selected Chapter Background";constructor(){}}return ae})(),G=(()=>{class ae{static#e=this.type="[Story Chapter] Set Selected Chapter Background";constructor(K){this.background=K}}return ae})(),k=(()=>{class ae{static#e=this.type="[Story Chapter] Duplicate An Existing Chapter";constructor(K,j,M){this.story=K,this.chapter=j,this.chapterId=M}}return ae})(),V=(()=>{class ae{static#e=this.type="[Story Chapter] Remove Chapter";constructor(K){this.chapter=K}}return ae})(),W=(()=>{class ae{static#e=this.type="[Story Chapter] Reset";constructor(){}}return ae})(),T=(()=>{class ae{static#e=this.type="[Story Chapters] Record Camera";constructor(K,j,M){this.chapterId=K,this.camera=j,this.rotationCenter=M}}return ae})(),z=(()=>{class ae{static#e=this.type="[Story Chapters] Set the current visibility layers index and position";constructor(K,j,M,$){this.chapterId=K,this.index=j,this.position=M,this.record=$}}return ae})(),I=(()=>{class ae{static#e=this.type="[Story Chapters] Set the current group layers position";constructor(K,j,M){this.chapterId=K,this.targetGroups=j,this.record=M}}return ae})(),D=(()=>{class ae{static#e=this.type="[Story Chapters] Set the media object";constructor(K,j){this.chapterId=K,this.media=j}}return ae})(),L=(()=>{class ae{static#e=this.type="[Story Chapters] Set the content blocks";constructor(K,j,M){this.chapterId=K,this.contentBlocks=j,this.record=M}}return ae})(),Q=(()=>{class ae{static#e=this.type="[Story Chapters] Add to timelineMap array";constructor(K){this.timelineMaps=K}}return ae})(),ie=(()=>{class ae{static#e=this.type="[Story Chapters] Update timelineMap array";constructor(K){this.updates=K}}return ae})(),se=(()=>{class ae{static#e=this.type="[Story Chapters] Remove from timelineMap array";constructor(K){this.timelineMapIds=K}}return ae})(),Z=(()=>{class ae{static#e=this.type="[Story Chapters] Set the lights";constructor(K,j){this.chapterId=K,this.lightLibId=j}}return ae})(),de=(()=>{class ae{static#e=this.type="[Story Chapters] set chapter timeline with data from the engine";constructor(K){this.timelineMaps=K}}return ae})()},59676:(le,N,n)=>{"use strict";n.d(N,{G:()=>e});class e{}},94495:(le,N,n)=>{"use strict";n.d(N,{N:()=>I});var x,e=n(28407),t=n(92014),s=n(59676),c=n(33013),O=n(18171),P=n(93915),S=n(47610),a=n(49204),E=n(10352),y=n(97415),i=n(12347),g=n(75069),p=n(81391),h=n(61295),o=n(76016),v=n(9592),d=n(65776),r=n(82323),_=n(65650),u=n(11724),m=n(57238),C=n(81025),b=n(35650),R=n(13955),A=n(16606),G=n(68947),k=n(63508),V=n(54438),W=function(D,L,Q,ie){var de,se=arguments.length,Z=se<3?L:null===ie?ie=Object.getOwnPropertyDescriptor(L,Q):ie;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)Z=Reflect.decorate(D,L,Q,ie);else for(var ae=D.length-1;ae>=0;ae--)(de=D[ae])&&(Z=(se<3?de(Z):se>3?de(L,Q,Z):de(L,Q))||Z);return se>3&&Z&&Object.defineProperty(L,Q,Z),Z},T=function(D,L){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(D,L)};const z={loading:!1,chapters:[],chaptersViewed:[],selectedChapter:null,isChapterAnimated:!1,thumbnails:new Map,patches:[],inversePatches:[]};let I=class As{static#e=x=this;static getStoryChapters(L){return L.chapters}static getChaptersViewed(L){return L.chaptersViewed}static getFirstChapter(L){return L.chapters.at(0)}static getChapter(L){return(0,t.Mz)([x],Q=>Q.chapters.find(ie=>ie.id===L))}static getSelectedChapterId(L){return L.selectedChapter}static getSelectedChapter(L){return L.chapters.find(Q=>Q.id===L.selectedChapter)||null}static getSelectedChapterTitle(L){const Q=L.chapters.find(ie=>ie.id===L.selectedChapter)||null;return G.l.normalize(Q?.displayName)}static getNextChapter(L){const Q=(0,u.clamp)(x.getSelectedChapterIndex(L)+1,0,L.chapters.length-1);return L.chapters[Q]}static getPreviousChapter(L){const Q=(0,u.clamp)(x.getSelectedChapterIndex(L)-1,0,L.chapters.length-1);return L.chapters[Q]}static getSelectedChapterIndex(L){return L.chapters.findIndex(Q=>Q.id===L.selectedChapter)}static getChapterCount(L){return L.chapters.length}static getChapterPagination(L){const Q=L.chapters.findIndex(ie=>ie.id===L.selectedChapter);return{count:L.chapters.length,index:Q,label:`${Q+1} ${$localize`of`} ${L.chapters.length}`}}static getChapterCompletionPercent(L){return(L.chapters.findIndex(ie=>ie.id===L.selectedChapter)+1)/L.chapters.length*100}static getRegisteredThumbnails(L){return L.thumbnails}static getIsChapterAnimated(L){return L.isChapterAnimated}static getSelectedChapterReadyState(L){const{chapters:Q,selectedChapter:ie}=L;return x.findChapter(Q,ie)?.readyState??{model:!1,animation:!1,audio:!1}}static getChaptersLoaded(L){return{count:L.chapters.length,modelChapters:L.chapters.filter(Q=>Q.readyState.model),animationChapters:L.chapters.filter(Q=>Q.readyState.animation)}}static getAllChaptersModelsReady(L){return L.chapters.length>0&&L.chapters.every(Q=>Q.readyState.model)}static getSelectedChapterModelReady(L){const Q=x.getSelectedChapterReadyState(L);return!(0,a.isNil)(Q)&&Q.model}static getAllChaptersAnimationsReady(L){return L.chapters.length>0&&L.chapters.every(Q=>Q.readyState.animation)}static getSelectedChapterAnimationReady(L){const Q=x.getSelectedChapterReadyState(L);return!(0,a.isNil)(Q)&&Q.animation}static getSelectedChapterBackground(L){const{chapters:Q,selectedChapter:ie}=L;return x.findChapter(Q,ie)?.background??E.RK}static getAllChaptersBackground(L){return L.chapters.map(Q=>Q?.background)}static getSelectedChapterAllAudio(L){const Q=L.chapters.find(ie=>ie.id===L.selectedChapter);return Q&&Q.media?Object.values(Q.media).filter(se=>"audio"===se.streamType):[]}static getSelectedChapterLegend(L){const{chapters:Q,selectedChapter:ie}=L;return x.findChapter(Q,ie)?.legend??[]}static getSelectedChapterClippingPlanes(L){const{chapters:Q,selectedChapter:ie}=L;return x.findChapter(Q,ie)?.clippingPlanes}static getChapterCamera(L){const{chapters:Q,selectedChapter:ie}=L;return x.findChapter(Q,ie)?.camera?.location}static findChapter(L,Q){return L.find(ie=>ie.id===Q)}static getAllChaptersCurrentLayers(L){return L.chapters.map(Q=>Q?.sliderLayers?.currentLayers?.layers??[])}static getSelectedChapterSrcLayers(L){const{chapters:Q,selectedChapter:ie}=L;return x.findChapter(Q,ie)?.sliderLayers?.src?.layers??[]}static getSelectedChapterSourceLayerGroups(L){const{chapters:Q,selectedChapter:ie}=L;return x.findChapter(Q,ie)?.sliderLayers?.sourceLayerGroups??[]}static getSelectedChapterLayerGroups(L){const{chapters:Q,selectedChapter:ie}=L;return x.findChapter(Q,ie)?.sliderLayers?.currentLayerGroups??[]}static getSelectedChapterCurrentLayers(L){const{chapters:Q,selectedChapter:ie}=L;return x.findChapter(Q,ie)?.sliderLayers?.currentLayers?.layers??[]}static getSelectedChapterCurrentLayersIndex(L){const{chapters:Q,selectedChapter:ie}=L;return x.findChapter(Q,ie)?.sliderLayers?.currentLayers?.index}static getSelectedChapterCurrentLayersPosition(L){const{chapters:Q,selectedChapter:ie}=L;return x.findChapter(Q,ie)?.sliderLayers?.currentLayers?.position}static getSelectedChapterContentBlocks(L){const{chapters:Q,selectedChapter:ie}=L;return x.findChapter(Q,ie)?.contentBlocks??[]}static getSelectedChapterTimelineMap(L){const{chapters:Q,selectedChapter:ie}=L;return x.findChapter(Q,ie)?.timelineMap??[]}static isLastChapter(L){return x.getSelectedChapterIndex(L)+1===L.chapters.length}setChapters(L,Q){L.patchState(C.jM(L.getState(),ie=>{ie.chapters=Q.chapters}))}SetChapterCameraAction(L,Q){L.patchState(C.jM(L.getState(),ie=>{ie.chapters.find(Z=>Z.id===Q.chapterId).camera.action=Q.cameraAction}))}setChapterCameraTitle(L,Q){L.patchState(C.jM(L.getState(),ie=>{ie.chapters.find(Z=>Z.id===Q.chapterId).camera.title=Q.title}))}setChapterUI(L,Q){L.patchState(C.jM(L.getState(),ie=>{ie.chapters.find(Z=>Z.id===Q.chapterId).ui=Q.ui}))}setChapterInfo(L,Q){L.patchState(C.jM(L.getState(),ie=>{const se=ie.chapters.find(Z=>Z.id===Q.chapterId);se.description=Q.description,se.displayName=Q.displayName}))}setChapterLegend(L,Q){L.patchState(C.jM(L.getState(),ie=>{ie.chapters.find(Z=>Z.id===Q.chapterId).legend=Q.legend}))}addToChapterLegend(L,Q){L.patchState(C.jM(L.getState(),ie=>{ie.chapters.find(Z=>Z.id===Q.chapterId).legend.push(Q.legend)}))}ReorderChapters(L,Q){var ie=this;return(0,e.A)(function*(){return ie.storyService.moveChapterInEngine(Q.previousIndex,Q.currentIndex).then(se=>{if(se){const de=L.getState().chapters.find(ae=>ae.id===se);L.dispatch(new c.yz(de)),L.dispatch(new h.IA(se))}L.patchState(C.jM(L.getState(),de=>{(0,p.HD)(de.chapters,Q.previousIndex,Q.currentIndex)}));const Z=L.getState().chapters.map(de=>de.id);L.dispatch(new o.B.ReorderQuestions(Z))})})()}SetChapterReadyState(L,Q){const ie=C.jM(L.getState(),se=>{if(Q.chapterId){const Z=se.chapters.find(de=>de.id===Q.chapterId);Z&&(Z.readyState={...Z.readyState,...Q.readyState})}});L.patchState(ie)}BuildChapterVisibilityLayers(L,Q){const ie=C.jM(L.getState(),se=>{if(Q.chapterId){const Z=se.chapters.findIndex(ae=>ae.id===Q.chapterId),de=se.chapters[Z];de.sliderLayers=this.chapterService.buildVisibilityLayers(de)}});L.patchState(ie)}SetChapterPostProcessing(L,Q){L.patchState(C.jM(L.getState(),ie=>{const se=ie.chapters.find(ae=>ae.id===Q.chapterId),de=se.properties||{};se.customData={...se.customData?se.customData:{},postprocess:Q.effects},se.properties={...de,...Q.properties}}))}SetChapterTransitions(L,Q){L.patchState(C.jM(L.getState(),ie=>{const se=ie.chapters.find(Z=>Z.id===Q.chapterId);se.transitions=se.transitions||{},se.transitions[Q.key]=Q.transition}))}setChapterProperties(L,Q){const ie=Q.chapterIds,se=Q.properties;L.patchState(C.jM(L.getState(),Z=>{Z.chapters.filter(de=>ie.includes(de.id)).forEach(de=>{de.properties={...de.properties??{},...se}})}))}removeChapterProperties(L,Q){const ie=Q.chapterIds,se=Q.properties;L.patchState(C.jM(L.getState(),Z=>{Z.chapters.filter(de=>ie.includes(de.id)).forEach(de=>{de?.properties&&se.forEach(ae=>{delete de.properties[ae]})})}))}SetChapterTransparencyMode(L,Q){L.patchState(C.jM(L.getState(),ie=>{ie.chapters.find(Z=>Z.id===Q.chapterId).transparencyMode=Q.transparencyMode}))}applyChapterPatch(L,Q){const ie=C.$i(L.getState(),Q.patches);L.patchState(C.jM(ie,se=>{se.patches=[],se.inversePatches=[]}))}setChapterClippingPlane(L,Q){const[ie,se,Z]=C.vI(L.getState(),ae=>{const q=ae.chapters.find(K=>K.id===Q.chapterId);q.clippingPlanes.clips=Q.clips,q.clippingPlanes.enabled=Q.enabled,q.clippingPlanes.boundary=q.clippingPlanes.boundary??this.sceneService.getSceneBoundary()}),de=C.jM(ie,ae=>{ae.patches.push(...se),ae.inversePatches.push(...Z)});Q.record&&L.dispatch(new g.a.SavePatches([{forward:de.patches,inverse:[...de.inversePatches].reverse(),patchAction:c.yr}])),L.patchState(Q.record?C.jM(de,ae=>{ae.patches=[],ae.inversePatches=[]}):de)}setChapterBackground(L,Q){Q.background&&L.patchState(C.jM(L.getState(),ie=>{ie.chapters.find(Z=>Z.id===Q.chapterId).background=Q.background}))}setAllChaptersBackground(L,Q){L.patchState(C.jM(L.getState(),ie=>{ie.chapters.forEach(se=>{se.background=Q.background})}))}resetSelectedChapterBackground(L,Q){const{selectedChapter:ie}=L.getState();this.store.dispatch(new c.qi(ie,E.RK))}setSelectedChapterBackground(L,{background:Q}){const ie=L.getState().selectedChapter;this.store.dispatch(new c.qi(ie,Q))}selectChapter(L,Q){if(!Q.chapter)return;this.store.dispatch([new h.q9(!1),new h.hg]);const ie=this.animationService.isChapterAnimated(Q.chapter);this.store.dispatch(new S.dB(!!Q.chapter));const se=C.jM(L.getState(),Z=>{Z.chaptersViewed.some(de=>Q.chapter.id===de)||Z.chaptersViewed.push(Q.chapter.id),Z.selectedChapter=Q.chapter?Q.chapter.id:null,Z.isChapterAnimated=ie});L.patchState(se)}selectChapterById(L,{chapterId:Q}){this.store.dispatch(new S.dB(!0)),L.patchState({selectedChapter:Q})}duplicateChapter(L,Q){const ie=Q.chapter,se=this.chapterService.copyChapter(ie,Q.chapterId),Z=this.store.selectSnapshot(x.getSelectedChapterBackground),de=this.store.selectSnapshot(_.K.getRegisteredThumbnails),ae=de.get(ie.id);if((0,a.isNil)(ae))if(ie.thumbnails){const j=new m.R;j.chapterId=se.id,j.snapshot=ie.thumbnails.default,de.set(se.id,j)}else L.dispatch(new r.V9(se.id,Z,v.H.JPEG,92,y.I.medium,"square"));else de.set(se.id,ae);const K=L.getState().chapters.findIndex(j=>j.id==ie.id)+1;L.patchState(C.jM(L.getState(),j=>{j.chapters.splice(K,0,se)})),this.storyService.addChapterToEngine(se,K).then(()=>{}).catch(j=>{console.error(`Error importing chapter "${se.id}":`,j)})}nextChapter(L,Q){const ie=this.store.selectSnapshot(x.getNextChapter);L.dispatch(new c.yz(ie))}previousChapter(L,Q){const ie=this.store.selectSnapshot(x.getPreviousChapter);L.dispatch(new c.yz(ie))}lastChapter(L,Q){const ie=L.getState().chapters;L.dispatch(new c.yz(ie[ie.length-1]))}firstChapter(L,Q){const ie=L.getState().chapters;L.dispatch(new c.yz(ie[0]))}removeChapter(L,Q){const{chapters:ie,selectedChapter:se}=L.getState();if(1===ie.length)return;const Z=ie.findIndex(de=>de.id===Q.chapter.id);if(this.storyService.removeChapterFromEngine(Z),L.patchState(C.jM(L.getState(),de=>{de.chapters.splice(Z,1)})),Q.chapter.id===se){const de=L.getState().chapters,ae=Math.min(Z,de.length-1);L.dispatch(new c.yz(de[ae]))}L.dispatch(new P.u1(Q.chapter,!1))}resetStoryChaptersState(L,Q){L.setState(z)}RecordCamera(L,Q){L.patchState(C.jM(L.getState(),ie=>{const se=ie.chapters.find(Z=>Z.id===Q.chapterId);se.camera.location=Q.camera,Q.rotationCenter&&(se.camera.rotationCenter=Q.rotationCenter)}))}setChapterCurrentLayersIndexPosition(L,Q){const[ie,se,Z]=C.vI(L.getState(),ae=>{const K=ae.chapters.find(j=>j.id===Q.chapterId).sliderLayers.currentLayers;K.index=Q.index,K.position=Q.position}),de=C.jM(ie,ae=>{ae.patches.push(...se),ae.inversePatches.push(...Z)});L.patchState(de),Q.record&&L.dispatch(new g.a.SavePatches([{forward:de.patches,inverse:de.inversePatches,patchAction:c.yr}]))}setChapterCurrentGroupLayersPosition(L,Q){const[ie,se,Z]=C.vI(L.getState(),ae=>{const q=ae.chapters.find(K=>K.id===Q.chapterId);q&&(q.sliderLayers.currentLayerGroups=q.sliderLayers.currentLayerGroups.map(K=>{const j=Q.targetGroups.find(M=>M.name===K.name);return{...K,position:j?.position??K.position}}))}),de=C.jM(ie,ae=>{ae.patches.push(...se),ae.inversePatches.push(...Z)});L.patchState(de),Q.record&&L.dispatch(new g.a.SavePatches([{forward:de.patches,inverse:de.inversePatches,patchAction:c.yr}]))}setChapterMedia(L,Q){L.patchState(C.jM(L.getState(),ie=>{ie.chapters.find(Z=>Z.id===Q.chapterId).media=Q.media}))}setChapterContentBlocks(L,Q){Q.contentBlocks=[...Q.contentBlocks.filter(ae=>ae.type===d.m.Ticker),...Q.contentBlocks.filter(ae=>ae.type!==d.m.Ticker)];const[ie,se,Z]=C.vI(L.getState(),ae=>{ae.chapters.find(K=>K.id===Q.chapterId).contentBlocks=Q.contentBlocks}),de=C.jM(ie,ae=>{ae.patches.push(...se),ae.inversePatches.push(...Z)});L.patchState(de),Q.record&&L.dispatch(new g.a.SavePatches([{forward:de.patches,inverse:de.inversePatches,patchAction:c.yr}]))}setChapterTimelineMap(L,Q){L.patchState(C.jM(L.getState(),ie=>{ie.chapters.find(Z=>Z.id===ie.selectedChapter).timelineMap=Q.timelineMaps}))}addChapterTimelineMap(L,Q){L.patchState(C.jM(L.getState(),ie=>{const se=ie.chapters.find(Z=>Z.id===ie.selectedChapter);Q.timelineMaps.forEach(Z=>{se.timelineMap.push(Z)})}))}updateChapterTimelineMap(L,Q){L.patchState(C.jM(L.getState(),ie=>{const se=ie.chapters.find(Z=>Z.id===ie.selectedChapter);Q.updates.forEach(Z=>{const de=se.timelineMap.findIndex(ae=>ae.id===Z.id);se.timelineMap.splice(de,1),se.timelineMap.push(Z)})}))}removeFromChapterTimelineMap(L,Q){L.patchState(C.jM(L.getState(),ie=>{const se=ie.chapters.find(Z=>Z.id===ie.selectedChapter);Q.timelineMapIds.forEach(Z=>{const de=se.timelineMap.findIndex(ae=>ae.id===Z);se.timelineMap.splice(de,1)})}))}SetChapterLights(L,{chapterId:Q,lightLibId:ie}){L.patchState(C.jM(L.getState(),se=>{const Z=se.chapters.find(de=>de.id===Q);(0,k.Mi)(Z)?Z.lightLibraryId=ie:(0,k.Uv)(Z)&&(Z.lights.libraries=[ie],this.assetService.setBranchLights(Q,ie))}))}constructor(L,Q,ie,se,Z,de){this.store=L,this.chapterService=Q,this.animationService=ie,this.assetService=se,this.sceneService=Z,this.storyService=de}static#t=this.\u0275fac=function(Q){return new(Q||As)(V.KVO(t.il),V.KVO(O.j),V.KVO(i.O),V.KVO(R.I),V.KVO(b.w),V.KVO(A.J))};static#n=this.\u0275prov=V.jDH({token:As,factory:As.\u0275fac})};W([(0,t.rc)(c.lM),T("design:type",Function),T("design:paramtypes",[Object,c.lM]),T("design:returntype",void 0)],I.prototype,"setChapters",null),W([(0,t.rc)(c.VU),T("design:type",Function),T("design:paramtypes",[Object,c.VU]),T("design:returntype",void 0)],I.prototype,"SetChapterCameraAction",null),W([(0,t.rc)(c.pN),T("design:type",Function),T("design:paramtypes",[Object,c.pN]),T("design:returntype",void 0)],I.prototype,"setChapterCameraTitle",null),W([(0,t.rc)(c.sC),T("design:type",Function),T("design:paramtypes",[Object,c.sC]),T("design:returntype",void 0)],I.prototype,"setChapterUI",null),W([(0,t.rc)(c.O),T("design:type",Function),T("design:paramtypes",[Object,c.O]),T("design:returntype",void 0)],I.prototype,"setChapterInfo",null),W([(0,t.rc)(c.Lx),T("design:type",Function),T("design:paramtypes",[Object,c.Lx]),T("design:returntype",void 0)],I.prototype,"setChapterLegend",null),W([(0,t.rc)(c.jy),T("design:type",Function),T("design:paramtypes",[Object,c.jy]),T("design:returntype",void 0)],I.prototype,"addToChapterLegend",null),W([(0,t.rc)(c.Oj),T("design:type",Function),T("design:paramtypes",[Object,c.Oj]),T("design:returntype",Promise)],I.prototype,"ReorderChapters",null),W([(0,t.rc)(c.M5),T("design:type",Function),T("design:paramtypes",[Object,c.M5]),T("design:returntype",void 0)],I.prototype,"SetChapterReadyState",null),W([(0,t.rc)(c.eV),T("design:type",Function),T("design:paramtypes",[Object,c.eV]),T("design:returntype",void 0)],I.prototype,"BuildChapterVisibilityLayers",null),W([(0,t.rc)(c.rT),T("design:type",Function),T("design:paramtypes",[Object,c.rT]),T("design:returntype",void 0)],I.prototype,"SetChapterPostProcessing",null),W([(0,t.rc)(c.sN),T("design:type",Function),T("design:paramtypes",[Object,c.sN]),T("design:returntype",void 0)],I.prototype,"SetChapterTransitions",null),W([(0,t.rc)(c.R),T("design:type",Function),T("design:paramtypes",[Object,c.R]),T("design:returntype",void 0)],I.prototype,"setChapterProperties",null),W([(0,t.rc)(c.X_),T("design:type",Function),T("design:paramtypes",[Object,c.X_]),T("design:returntype",void 0)],I.prototype,"removeChapterProperties",null),W([(0,t.rc)(c.Nw),T("design:type",Function),T("design:paramtypes",[Object,c.Nw]),T("design:returntype",void 0)],I.prototype,"SetChapterTransparencyMode",null),W([(0,t.rc)(c.yr),T("design:type",Function),T("design:paramtypes",[Object,c.yr]),T("design:returntype",void 0)],I.prototype,"applyChapterPatch",null),W([(0,t.rc)(c.Ej),T("design:type",Function),T("design:paramtypes",[Object,c.Ej]),T("design:returntype",void 0)],I.prototype,"setChapterClippingPlane",null),W([(0,t.rc)(c.qi),T("design:type",Function),T("design:paramtypes",[Object,c.qi]),T("design:returntype",void 0)],I.prototype,"setChapterBackground",null),W([(0,t.rc)(c.EN),T("design:type",Function),T("design:paramtypes",[Object,c.EN]),T("design:returntype",void 0)],I.prototype,"setAllChaptersBackground",null),W([(0,t.rc)(c.Wd),T("design:type",Function),T("design:paramtypes",[Object,c.Wd]),T("design:returntype",void 0)],I.prototype,"resetSelectedChapterBackground",null),W([(0,t.rc)(c.pb),T("design:type",Function),T("design:paramtypes",[Object,Object]),T("design:returntype",void 0)],I.prototype,"setSelectedChapterBackground",null),W([(0,t.rc)(c.yz),T("design:type",Function),T("design:paramtypes",[Object,c.yz]),T("design:returntype",void 0)],I.prototype,"selectChapter",null),W([(0,t.rc)(c.wg),T("design:type",Function),T("design:paramtypes",[Object,Object]),T("design:returntype",void 0)],I.prototype,"selectChapterById",null),W([(0,t.rc)(c.PA),T("design:type",Function),T("design:paramtypes",[Object,c.PA]),T("design:returntype",void 0)],I.prototype,"duplicateChapter",null),W([(0,t.rc)(c.tg),T("design:type",Function),T("design:paramtypes",[Object,c.tg]),T("design:returntype",void 0)],I.prototype,"nextChapter",null),W([(0,t.rc)(c.F0),T("design:type",Function),T("design:paramtypes",[Object,c.F0]),T("design:returntype",void 0)],I.prototype,"previousChapter",null),W([(0,t.rc)(c.Aq),T("design:type",Function),T("design:paramtypes",[Object,c.Aq]),T("design:returntype",void 0)],I.prototype,"lastChapter",null),W([(0,t.rc)(c.Eo),T("design:type",Function),T("design:paramtypes",[Object,c.Aq]),T("design:returntype",void 0)],I.prototype,"firstChapter",null),W([(0,t.rc)(c.YA),T("design:type",Function),T("design:paramtypes",[Object,c.YA]),T("design:returntype",void 0)],I.prototype,"removeChapter",null),W([(0,t.rc)(c.FN),T("design:type",Function),T("design:paramtypes",[Object,c.FN]),T("design:returntype",void 0)],I.prototype,"resetStoryChaptersState",null),W([(0,t.rc)(c.tn),T("design:type",Function),T("design:paramtypes",[Object,c.tn]),T("design:returntype",void 0)],I.prototype,"RecordCamera",null),W([(0,t.rc)(c.WZ),T("design:type",Function),T("design:paramtypes",[Object,c.WZ]),T("design:returntype",void 0)],I.prototype,"setChapterCurrentLayersIndexPosition",null),W([(0,t.rc)(c.$V),T("design:type",Function),T("design:paramtypes",[Object,c.$V]),T("design:returntype",void 0)],I.prototype,"setChapterCurrentGroupLayersPosition",null),W([(0,t.rc)(c.Eh),T("design:type",Function),T("design:paramtypes",[Object,c.Eh]),T("design:returntype",void 0)],I.prototype,"setChapterMedia",null),W([(0,t.rc)(c.jo),T("design:type",Function),T("design:paramtypes",[Object,c.jo]),T("design:returntype",void 0)],I.prototype,"setChapterContentBlocks",null),W([(0,t.rc)(c.bg),T("design:type",Function),T("design:paramtypes",[Object,c.lc]),T("design:returntype",void 0)],I.prototype,"setChapterTimelineMap",null),W([(0,t.rc)(c.lc),T("design:type",Function),T("design:paramtypes",[Object,c.lc]),T("design:returntype",void 0)],I.prototype,"addChapterTimelineMap",null),W([(0,t.rc)(c.is),T("design:type",Function),T("design:paramtypes",[Object,c.is]),T("design:returntype",void 0)],I.prototype,"updateChapterTimelineMap",null),W([(0,t.rc)(c.Bc),T("design:type",Function),T("design:paramtypes",[Object,c.Bc]),T("design:returntype",void 0)],I.prototype,"removeFromChapterTimelineMap",null),W([(0,t.rc)(c.zh),T("design:type",Function),T("design:paramtypes",[Object,c.zh]),T("design:returntype",void 0)],I.prototype,"SetChapterLights",null),W([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[s.G]),T("design:returntype",void 0)],I,"getStoryChapters",null),W([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[s.G]),T("design:returntype",void 0)],I,"getChaptersViewed",null),W([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[s.G]),T("design:returntype",void 0)],I,"getFirstChapter",null),W([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[s.G]),T("design:returntype",void 0)],I,"getSelectedChapterId",null),W([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[s.G]),T("design:returntype",void 0)],I,"getSelectedChapter",null),W([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[s.G]),T("design:returntype",void 0)],I,"getSelectedChapterTitle",null),W([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[s.G]),T("design:returntype",void 0)],I,"getNextChapter",null),W([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[s.G]),T("design:returntype",void 0)],I,"getPreviousChapter",null),W([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[s.G]),T("design:returntype",void 0)],I,"getSelectedChapterIndex",null),W([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[s.G]),T("design:returntype",void 0)],I,"getChapterCount",null),W([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[s.G]),T("design:returntype",void 0)],I,"getChapterPagination",null),W([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[s.G]),T("design:returntype",void 0)],I,"getChapterCompletionPercent",null),W([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[s.G]),T("design:returntype",void 0)],I,"getRegisteredThumbnails",null),W([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[s.G]),T("design:returntype",void 0)],I,"getIsChapterAnimated",null),W([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[s.G]),T("design:returntype",void 0)],I,"getSelectedChapterReadyState",null),W([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[s.G]),T("design:returntype",void 0)],I,"getChaptersLoaded",null),W([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[s.G]),T("design:returntype",void 0)],I,"getAllChaptersModelsReady",null),W([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[s.G]),T("design:returntype",void 0)],I,"getSelectedChapterModelReady",null),W([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[s.G]),T("design:returntype",void 0)],I,"getAllChaptersAnimationsReady",null),W([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[s.G]),T("design:returntype",void 0)],I,"getSelectedChapterAnimationReady",null),W([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[s.G]),T("design:returntype",void 0)],I,"getSelectedChapterBackground",null),W([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[s.G]),T("design:returntype",void 0)],I,"getAllChaptersBackground",null),W([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[s.G]),T("design:returntype",void 0)],I,"getSelectedChapterAllAudio",null),W([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[s.G]),T("design:returntype",void 0)],I,"getSelectedChapterLegend",null),W([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[s.G]),T("design:returntype",void 0)],I,"getSelectedChapterClippingPlanes",null),W([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[s.G]),T("design:returntype",void 0)],I,"getChapterCamera",null),W([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[s.G]),T("design:returntype",Array)],I,"getAllChaptersCurrentLayers",null),W([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[s.G]),T("design:returntype",Array)],I,"getSelectedChapterSrcLayers",null),W([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[s.G]),T("design:returntype",Array)],I,"getSelectedChapterSourceLayerGroups",null),W([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[s.G]),T("design:returntype",Array)],I,"getSelectedChapterLayerGroups",null),W([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[s.G]),T("design:returntype",Array)],I,"getSelectedChapterCurrentLayers",null),W([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[s.G]),T("design:returntype",Number)],I,"getSelectedChapterCurrentLayersIndex",null),W([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[s.G]),T("design:returntype",Number)],I,"getSelectedChapterCurrentLayersPosition",null),W([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[s.G]),T("design:returntype",Array)],I,"getSelectedChapterContentBlocks",null),W([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[s.G]),T("design:returntype",Array)],I,"getSelectedChapterTimelineMap",null),W([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[s.G]),T("design:returntype",void 0)],I,"isLastChapter",null),I=x=W([(0,t.Uw)({name:"storyChapters",defaults:z}),T("design:paramtypes",[t.il,O.j,i.O,R.I,b.w,A.J])],I)},93915:(le,N,n)=>{"use strict";n.d(N,{$K:()=>h,$y:()=>p,D3:()=>v,Ds:()=>_,HP:()=>y,S3:()=>a,Sh:()=>O,TR:()=>g,Tz:()=>o,eH:()=>d,gJ:()=>c,h5:()=>P,lb:()=>E,sW:()=>t,tH:()=>i,u1:()=>f,vf:()=>r,vx:()=>S,yi:()=>s});var e=n(15375);let t=(()=>{class u{static#e=this.type="[Story Labels] Patch Labels";constructor(m){this.patches=m}}return u})(),s=(()=>{class u{static#e=this.type="[Story Labels] Set label Offset";constructor(m,C){this.labelId=m,this.offset=C}}return u})(),c=(()=>{class u{static#e=this.type="[Story Labels] Set Labels";constructor(m){this.labels=m}}return u})(),O=(()=>{class u{static#e=this.type="[Story Labels] Add Label";constructor(m,C=!1){this.label=m,this.record=C}}return u})(),P=(()=>{class u{static#e=this.type="[Story Labels] Set Contexdt Label";constructor(m){this.label=m}}return u})(),S=(()=>{class u{static#e=this.type="[Story Labels] Remove Label";constructor(m){this.label=m}}return u})(),a=(()=>{class u{static#e=this.type="[Story Labels] Remove Context Label";constructor(){}}return u})(),f=(()=>{class u{static#e=this.type="[Story Labels] Remove All Chapter Labels";constructor(m,C=!1){this.chapter=m,this.record=C}}return u})(),E=(()=>{class u{static#e=this.type="[Story Labels] Set Label";constructor(m,C=!1){this.label=m,this.record=C}}return u})(),y=(()=>{class u{static#e=this.type="[Story Labels] Set Label States";constructor(m,C){this.id=m,this.states=C}}return u})(),i=(()=>{class u{static#e=this.type="[Story Labels] Set Label Scale";constructor(m){this.scale=m}}return u})(),g=(()=>{class u{static#e=this.type="[Story Labels] Select Label";constructor(m){this.label=m}}return u})(),p=(()=>{class u{static#e=this.type="[Story Labels] Reset";constructor(){}}return u})(),h=(()=>{class u{static#e=this.type="[Story Labels] Convert";constructor(m,C){this.labels=m,this.fields=C}}return u})(),o=(()=>{class u{static#e=this.type="[Story Labels] Enable Context Label";constructor(m,C=!0,b=!0,R=!0){this.enable=m,this.enableInfo=C,this.enableActions=b,this.enableAudio=R}}return u})(),v=(()=>{class u{static#e=this.type="[Story Labels] Set Labels Shown";constructor(m,C){this.labels=m,this.shown=C}}return u})(),d=(()=>{class u{static#e=this.type="[Story Labels] Set All Labels Shown";constructor(m){this.show=m}}return u})(),r=(()=>{class u{static#e=this.type="[Story Labels] Set Labels Collapsed";constructor(m,C=e.Q.None){this.collapsed=m,this.collapsedMode=C}}return u})(),_=(()=>{class u{static#e=this.type="[Story Labels] Set Draggable";constructor(m){this.draggable=m}}return u})()},48030:(le,N,n)=>{"use strict";n.d(N,{j:()=>e,z:()=>t});const e="context-label";class t{}},38753:(le,N,n)=>{"use strict";n.d(N,{y:()=>_});var d,e=n(92014),t=n(48030),s=n(93915),c=n(59429),O=n(94495),P=n(59676),S=n(49204),f=n(15375),E=n(75069),y=n(24151),i=n(79817),g=n(81025),p=n(3367),h=n(54438),o=function(u,l,m,C){var A,b=arguments.length,R=b<3?l:null===C?C=Object.getOwnPropertyDescriptor(l,m):C;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)R=Reflect.decorate(u,l,m,C);else for(var G=u.length-1;G>=0;G--)(A=u[G])&&(R=(b<3?A(R):b>3?A(l,m,R):A(l,m))||R);return b>3&&R&&Object.defineProperty(l,m,R),R},v=function(u,l){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(u,l)};const r={enableContextLabel:{enable:!0,enableInfo:!0,enableActions:!0,enableAudio:!0},loading:!1,labelsCollapsed:!1,labelsCollapsedMode:f.Q.None,labelScale:null,labels:[],contextLabel:null,selectedLabel:null,draggable:{pin:!0,tag:!0}};let _=class Is{static#e=d=this;static getLabels(l){return l.labels}static getLabelsCollapsed(l){return l.labelsCollapsed}static getLabelsCollapsedMode(l){return l.labelsCollapsedMode}static getSelectedLabelId(l){return l.selectedLabel}static getSelectedLabel(l){return l.labels.find(m=>m.id===l.selectedLabel)||null}static getContextLabel(l){return l.contextLabel}static getChapterLabels(l,m){return l.labels?l.labels.filter(C=>C.chapterId===m.selectedChapter):[]}static getChapterSequentialLabels(l){return(0,e.Mz)([d,O.N],(m,C)=>m.labels.filter(b=>b.chapterId===C.selectedChapter&&b.pinType===y.O.Sequential&&b.sequentialType===l))}static getLabelSequence(l){return(0,e.Mz)([d,d.getChapterSequentialLabels(i.C.Alphabetical),d.getChapterSequentialLabels(i.C.Numerical)],(m,C,b)=>{if(l.pinType!==y.O.Sequential)return null;switch(l.sequentialType){case i.C.Alphabetical:{const R=C.findIndex(A=>A.id===l.id);return"ABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(R)}case i.C.Numerical:return b.findIndex(R=>R.id===l.id)+1}})}static getEnableContextLabel(l){return l.enableContextLabel.enable}static getEnableContextLabelInfo(l){return l.enableContextLabel.enableInfo}static getEnableContextLabelActions(l){return l.enableContextLabel.enableActions}static getEnableContextLabelAudio(l){return l.enableContextLabel.enableAudio}static getLabelsDraggable(l){return l.draggable}static getLabelScale(l){return l.labelScale}PatchLabels(l,m){const C=g.$i(l.getState(),m.patches);l.patchState(C)}setLabelOffset(l,m){const[C,b,R]=g.vI(l.getState(),A=>{const G=A.labels.find(k=>k.id===m.labelId);G&&(G.offset=m.offset)});l.patchState(C),this.savePatches(b,R)}setLabels(l,m){l.patchState(g.jM(l.getState(),C=>{C.labels=m.labels}))}setLabel(l,m){const[C,b,R]=g.vI(l.getState(),A=>{A.labels=A.labels.map(G=>G.id===m.label.id?m.label:G)});l.patchState(C),m.record&&this.savePatches(b,R)}setLabelStates(l,m){const[C,b,R]=g.vI(l.getState(),A=>{A.labels.find(k=>k.id===m.id).states=m.states});l.patchState(C),this.savePatches(b,R)}setLabelScale(l,m){l.patchState({labelScale:m.scale})}addLabel(l,m){const[C,b,R]=g.vI(l.getState(),A=>{const G=m.label.id||c.u.idWithPrefix("label"),k={...m.label,id:G};A.labels.push(k)});l.patchState(C),m.record&&this.savePatches(b,R)}addContextLabel(l,m){const C=g.jM(l.getState(),b=>{b.contextLabel={...m.label,id:t.j}});l.patchState(C)}removeLabel(l,m){const[C,b,R]=g.vI(l.getState(),A=>{A.labels=A.labels.filter(G=>G.id!==m.label.id)});l.patchState(C),this.markerService.deleteMarker(m.label.id),this.savePatches(b,R)}removeContextLabel(l,m){const C=g.jM(l.getState(),b=>{b.contextLabel=void 0});this.markerService.deleteMarker(t.j),l.patchState(C)}removeAllChapterLabels(l,m){const[C,b,R]=g.vI(l.getState(),A=>{const[G,k]=(0,S.partition)(A.labels,V=>V.chapterId!==m.chapter.id);k.forEach(V=>this.markerService.deleteMarker(V.id)),A.labels=G});l.patchState(C),m.record&&this.savePatches(b,R)}selectLabel(l,m){l.patchState({selectedLabel:m.label?m.label.id:null})}resetLabels(l,m){const C=l.getState();this.markerService.deleteMarker(t.j),C.labels.forEach(b=>{this.markerService.deleteMarker(b.id)}),l.setState(g.jM(l.getState(),b=>{}))}convertLabels(l,m){const[C,b,R]=g.vI(l.getState(),A=>{m.labels.forEach(G=>{const k=A.labels.findIndex(V=>V.id===G.id);A.labels[k]={...A.labels[k],...m.fields}})});l.setState({...C}),this.savePatches(b,R)}enableContextLabel(l,m){l.patchState({enableContextLabel:{...m}})}setLabelsShown(l,{labels:m,shown:C}){const b=l.getState().labels.map(R=>{const A=m.some(G=>G.id===R.id);return{...R,shown:A?C:R.shown}});l.patchState({labels:[...b]})}setAllLabelsShown(l,{show:m}){const C=l.getState().labels;l.dispatch(new s.D3(C,m))}setLabelsCollapsed(l,{collapsed:m,collapsedMode:C}){l.patchState({labelsCollapsed:m,labelsCollapsedMode:C})}setLabelsDraggable(l,m){l.patchState({draggable:{...m.draggable}})}savePatches(l,m){this.store.dispatch(new E.a.SavePatches([{forward:l,inverse:m,patchAction:s.sW}]))}constructor(l,m){this.store=l,this.markerService=m}static#t=this.\u0275fac=function(m){return new(m||Is)(h.KVO(e.il),h.KVO(p.m))};static#n=this.\u0275prov=h.jDH({token:Is,factory:Is.\u0275fac})};o([(0,e.rc)(s.sW),v("design:type",Function),v("design:paramtypes",[Object,s.sW]),v("design:returntype",void 0)],_.prototype,"PatchLabels",null),o([(0,e.rc)(s.yi),v("design:type",Function),v("design:paramtypes",[Object,s.yi]),v("design:returntype",void 0)],_.prototype,"setLabelOffset",null),o([(0,e.rc)(s.gJ),v("design:type",Function),v("design:paramtypes",[Object,s.gJ]),v("design:returntype",void 0)],_.prototype,"setLabels",null),o([(0,e.rc)(s.lb),v("design:type",Function),v("design:paramtypes",[Object,s.lb]),v("design:returntype",void 0)],_.prototype,"setLabel",null),o([(0,e.rc)(s.HP),v("design:type",Function),v("design:paramtypes",[Object,s.HP]),v("design:returntype",void 0)],_.prototype,"setLabelStates",null),o([(0,e.rc)(s.tH),v("design:type",Function),v("design:paramtypes",[Object,s.tH]),v("design:returntype",void 0)],_.prototype,"setLabelScale",null),o([(0,e.rc)(s.Sh),v("design:type",Function),v("design:paramtypes",[Object,s.Sh]),v("design:returntype",void 0)],_.prototype,"addLabel",null),o([(0,e.rc)(s.h5),v("design:type",Function),v("design:paramtypes",[Object,s.h5]),v("design:returntype",void 0)],_.prototype,"addContextLabel",null),o([(0,e.rc)(s.vx),v("design:type",Function),v("design:paramtypes",[Object,s.vx]),v("design:returntype",void 0)],_.prototype,"removeLabel",null),o([(0,e.rc)(s.S3),v("design:type",Function),v("design:paramtypes",[Object,s.S3]),v("design:returntype",void 0)],_.prototype,"removeContextLabel",null),o([(0,e.rc)(s.u1),v("design:type",Function),v("design:paramtypes",[Object,s.u1]),v("design:returntype",void 0)],_.prototype,"removeAllChapterLabels",null),o([(0,e.rc)(s.TR),v("design:type",Function),v("design:paramtypes",[Object,s.TR]),v("design:returntype",void 0)],_.prototype,"selectLabel",null),o([(0,e.rc)(s.$y),v("design:type",Function),v("design:paramtypes",[Object,s.$y]),v("design:returntype",void 0)],_.prototype,"resetLabels",null),o([(0,e.rc)(s.$K),v("design:type",Function),v("design:paramtypes",[Object,s.$K]),v("design:returntype",void 0)],_.prototype,"convertLabels",null),o([(0,e.rc)(s.Tz),v("design:type",Function),v("design:paramtypes",[Object,s.Tz]),v("design:returntype",void 0)],_.prototype,"enableContextLabel",null),o([(0,e.rc)(s.D3),v("design:type",Function),v("design:paramtypes",[Object,s.D3]),v("design:returntype",void 0)],_.prototype,"setLabelsShown",null),o([(0,e.rc)(s.eH),v("design:type",Function),v("design:paramtypes",[Object,s.eH]),v("design:returntype",void 0)],_.prototype,"setAllLabelsShown",null),o([(0,e.rc)(s.vf),v("design:type",Function),v("design:paramtypes",[Object,s.vf]),v("design:returntype",void 0)],_.prototype,"setLabelsCollapsed",null),o([(0,e.rc)(s.Ds),v("design:type",Function),v("design:paramtypes",[Object,s.Ds]),v("design:returntype",void 0)],_.prototype,"setLabelsDraggable",null),o([(0,e.MD)(),v("design:type",Function),v("design:paramtypes",[t.z]),v("design:returntype",void 0)],_,"getLabels",null),o([(0,e.MD)(),v("design:type",Function),v("design:paramtypes",[t.z]),v("design:returntype",void 0)],_,"getLabelsCollapsed",null),o([(0,e.MD)(),v("design:type",Function),v("design:paramtypes",[t.z]),v("design:returntype",void 0)],_,"getLabelsCollapsedMode",null),o([(0,e.MD)(),v("design:type",Function),v("design:paramtypes",[t.z]),v("design:returntype",void 0)],_,"getSelectedLabelId",null),o([(0,e.MD)(),v("design:type",Function),v("design:paramtypes",[t.z]),v("design:returntype",void 0)],_,"getSelectedLabel",null),o([(0,e.MD)(),v("design:type",Function),v("design:paramtypes",[t.z]),v("design:returntype",void 0)],_,"getContextLabel",null),o([(0,e.MD)([_,O.N]),v("design:type",Function),v("design:paramtypes",[t.z,P.G]),v("design:returntype",void 0)],_,"getChapterLabels",null),o([(0,e.MD)(),v("design:type",Function),v("design:paramtypes",[t.z]),v("design:returntype",void 0)],_,"getEnableContextLabel",null),o([(0,e.MD)(),v("design:type",Function),v("design:paramtypes",[t.z]),v("design:returntype",void 0)],_,"getEnableContextLabelInfo",null),o([(0,e.MD)(),v("design:type",Function),v("design:paramtypes",[t.z]),v("design:returntype",void 0)],_,"getEnableContextLabelActions",null),o([(0,e.MD)(),v("design:type",Function),v("design:paramtypes",[t.z]),v("design:returntype",void 0)],_,"getEnableContextLabelAudio",null),o([(0,e.MD)(),v("design:type",Function),v("design:paramtypes",[t.z]),v("design:returntype",void 0)],_,"getLabelsDraggable",null),o([(0,e.MD)(),v("design:type",Function),v("design:paramtypes",[t.z]),v("design:returntype",void 0)],_,"getLabelScale",null),_=d=o([(0,e.Uw)({name:"labels",defaults:r}),v("design:paramtypes",[e.il,p.m])],_)},69270:(le,N,n)=>{"use strict";n.d(N,{S:()=>t});var e=n(17766);function t(s){return s.split("/").length>1?e.c.Module:e.c.Bookmark}},66056:(le,N,n)=>{"use strict";n.d(N,{Ck:()=>o,Hd:()=>S,Hy:()=>m,KM:()=>E,Nu:()=>R,Pv:()=>f,S9:()=>r,Tt:()=>O,V_:()=>y,Ye:()=>t,Z0:()=>d,cX:()=>c,dC:()=>h,dr:()=>a,fK:()=>P,fn:()=>_,jj:()=>l,nm:()=>b,si:()=>p,t1:()=>v,ub:()=>g,yi:()=>i,yw:()=>u});var e=n(11040);let t=(()=>{class A{static#e=this.type="[Story] Load Current Story";constructor(k,V,W=e.q.lang,T=!1){this.id=k,this.type=V,this.lang=W,this.preview=T}}return A})(),c=(()=>{class A{static#e=this.type="[Story] Replace the Story";constructor(k){this.story=k}}return A})(),O=(()=>{class A{static#e=this.type="[Story] Set the Story ID";constructor(k){this.id=k}}return A})(),P=(()=>{class A{static#e=this.type="[Story] Set Story Text";constructor(k){this.displayName=k}}return A})(),S=(()=>{class A{static#e=this.type="[Story] Set Story Tags";constructor(k){this.tags=k}}return A})(),a=(()=>{class A{static#e=this.type="[Story] Set Story Playthrough";constructor(k){this.playthroughSettings=k}}return A})(),f=(()=>{class A{static#e=this.type="[Story] Set Story Source Info";constructor(k){this.sourceInfo=k}}return A})(),E=(()=>{class A{static#e=this.type="[Story] Set Story Light Libs";constructor(k){this.lightLibs=k}}return A})(),y=(()=>{class A{static#e=this.type="[Story] Load Manifests"}return A})(),i=(()=>{class A{static#e=this.type="[Story] Set Incoming Story Id";constructor(k,V,W){this.id=k,this.type=V,this.reset=W}}return A})(),g=(()=>{class A{static#e=this.type="[Story] Load Story Chunk";constructor(){}}return A})(),p=(()=>{class A{static#e=this.type="[Story] Reorder Load Chunks";constructor(k){this.chapterId=k}}return A})(),h=(()=>{class A{static#e=this.type="[Story] Load Story Chunk Success";constructor(k){this.chapter=k}}return A})(),o=(()=>{class A{static#e=this.type="[Story] Build Story In Engine From Story Model";constructor(k,V,W,T,x=!0){this.id=k,this.story=V,this.type=W,this.chapterIdx=T,this.replaceActiveStory=x}}return A})(),v=(()=>{class A{static#e=this.type="[Story] Build Story Success";constructor(k,V,W){this.story=k,this.id=V,this.type=W}}return A})(),d=(()=>{class A{static#e=this.type="[Story] Load Success";constructor(k,V,W,T){this.story=k,this.id=V,this.type=W,this.lang=T}}return A})(),r=(()=>{class A{static#e=this.type="[Story] Load Fail";constructor(k,V){this.id=k,this.type=V}}return A})(),_=(()=>{class A{static#e=this.type="[Story] Import";constructor(k,V,W=e.q.lang){this.id=k,this.type=V,this.lang=W}}return A})(),u=(()=>{class A{static#e=this.type="[Story] Import Success";constructor(k,V,W){this.story=k,this.id=V,this.type=W}}return A})(),l=(()=>{class A{static#e=this.type="[Story] Clear";constructor(){}}return A})(),m=(()=>{class A{static#e=this.type="[Story] Synchronize Chapters";constructor(){}}return A})(),b=(()=>{class A{static#e=this.type="[Story] Human Ready (SDK)";constructor(){}}return A})(),R=(()=>{class A{static#e=this.type="[Story] Merge Bridge Module Success";constructor(k){this.story=k}}return A})()},26657:(le,N,n)=>{"use strict";n.d(N,{Z:()=>t,o:()=>e});class e{}class t{}},22679:(le,N,n)=>{"use strict";n.d(N,{t:()=>Y});var e=n(92014),t=n(26657),s=n(66056),c=n(16606),O=n(94495),P=n(93915),S=n(49204),a=n(59429),E=n(44867);function g(he,ne){const _e=tt=>void 0!==tt.objectId,[Ce,Be]=(0,S.partition)(he,_e),[Ie,Oe]=(0,S.partition)(ne,_e),Te=function y(he,ne){return ne.reduce((_e,Ce)=>{for(const Be of he)(0,S.isEqual)(Be,Ce)||_e.push(Ce);return _e},he)}(Be,Oe),{sceneGraph:ve,graphsMerged:Ve,objectIdsUniqueToNew:we,objectIdsUniqueToOriginal:Je}=function i(he,ne){const _e=he.reduce((Ie,Oe)=>(Ie[Oe.objectId]=Oe,Ie),{}),Ce=ne.reduce((Ie,Oe)=>{if(void 0===Ie.nodes[Oe.objectId])return Ie.nodes[Oe.objectId]=Oe,Ie;if(!(0,S.isEqual)(Oe,Ie.nodes[Oe.objectId])){const Te=function f(he,ne){const _e={},Ce={};return{root:function Be(Oe,Te){if(Oe.objectId!==Te.objectId)return _e[Te.objectId]=!0,[Oe,Te];if(void 0===Oe.objects&&Te.objects){for(const we of Te.objects)_e[we.objectId]=!0;return[{...Te}]}if(Oe.objects&&void 0===Te.objects){for(const we of Oe.objects)Ce[we.objectId]=!0;return[{...Oe}]}if(void 0===Oe.objects&&void 0===Te.objects)return[{...Oe}];const ve=[];for(const we of Oe.objects){const Je=Te.objects.find(tt=>tt.objectId===we.objectId);Je?ve.push(Be(we,Je)):(Ce[we.objectId]=!0,ve.push(we))}for(const we of Te.objects)Oe.objects.find(tt=>tt.objectId===we.objectId)||(_e[we.objectId]=!0,ve.push(we));const Ve={...Oe};return Ve.objects=(0,S.flatten)(ve),[Ve]}(he,ne),objectIdsUniqueToNew:_e,objectIdsUniqueToOriginal:Ce}}(Ie.nodes[Oe.objectId],Oe);Ie.nodes[Oe.objectId]=Te.root[0],Ie.graphsMerged.push(Oe.objectId),Ie.objectIdsUniqueToNew[Oe.objectId]=Te.objectIdsUniqueToNew,Ie.objectIdsUniqueToOriginal[Oe.objectId]=Te.objectIdsUniqueToOriginal}return Ie},{nodes:_e,graphsMerged:[],objectIdsUniqueToNew:{},objectIdsUniqueToOriginal:{}});return{sceneGraph:Object.keys(Ce.nodes).reduce((Ie,Oe)=>(Ie.push(Ce.nodes[Oe]),Ie),[]),graphsMerged:Ce.graphsMerged,objectIdsUniqueToNew:Ce.objectIdsUniqueToNew,objectIdsUniqueToOriginal:Ce.objectIdsUniqueToOriginal}}(Ce,Ie);return{sceneGraph:[...Te,...ve],graphsMerged:Ve,objectIdsUniqueToNew:we,objectIdsUniqueToOriginal:Je}}function h(he,ne,_e){const Ce=function p(he,ne,_e){const Ce={};for(const Be of he){const Ie=Object.keys(ne[Be]);for(const Oe of Ie)Ce[Oe]=_e}return Ce}(ne,_e,!1);return he.map(Be=>({...Be,availableObjects:{...Be.availableObjects,...Ce},showObjects:{...Be.showObjects,...Ce},selectObjects:{...Be.selectObjects,...Ce},pickThroughObjects:{...Be.pickThroughObjects,...Ce}}))}var v=n(17766),d=n(69270);var l=n(63508);function m(he,ne){return he.map(_e=>{if((0,l.Mi)(_e)||(0,l.Uv)(_e)&&!(0,S.isEmpty)(_e.lights))return _e;const Ce={libraries:[...ne],lights:[]};return{..._e,lights:Ce}})}var C=n(86544);function b(he){return he.reduce((ne,_e)=>(ne[_e.id]=_e,ne),{})}function A(he){return he.reduce((ne,_e)=>{const Ce=_e.id,Be=_e.customData?.particleSystems??[];return Be.length>0&&(ne[Ce]=function R(he){return he.reduce((ne,_e)=>(ne[C.R.getParticleIdRoot(_e)]=_e,ne),{})}(Be)),ne},{})}function G(he,ne){return he.map(_e=>{const Ce=_e.customData?.particleSystems??[];return Ce.length&&(_e.customData.particleSystems=Ce.map(Be=>ne[Be]?.id??Be)),_e})}var V=n(63745),W=n(2096);function T(he,ne,_e,Ce,Be=v.c.Bookmark,Ie=a.u.idWithPrefix){const{sceneGraph:Oe,graphsMerged:Te,objectIdsUniqueToNew:ve,objectIdsUniqueToOriginal:Ve}=g(he.sceneGraph,_e.sceneGraph),we=function u(he,ne){const _e=(Oe,Te)=>(0,S.uniq)([...Oe,...Te]);return{lights:_e(he.lights,ne.lights),tweens:_e(he.tweens,ne.tweens),reflections:_e(he.reflections,ne.reflections)}}(he.assetLibraries,_e.assetLibraries),Je=function _(he,ne,_e,Ce){ne=ne||{};const Be=(Ie,Oe)=>Oe.includes("/")?Oe:`${function r(he){return(0,d.S)(he)===v.c.Bookmark?he:he.split("/").pop()}(Ie)}/${Oe}`;return{...(0,S.mapKeys)(he=he||{},(Ie,Oe)=>Be(_e,Oe)),...(0,S.mapKeys)(ne,(Ie,Oe)=>Be(Ce,Oe))}}(he.reflections,_e.reflections,ne,Ce),tt=m(he.chapters,he.assetLibraries.lights),st=m(_e.chapters,_e.assetLibraries.lights),ge=function k(he,ne,_e,Ce,Be){const Ie=he.customData?.particleSystems??[],Oe=ne.customData?.particleSystems??[],Te=b(Ie),ve=b(Oe);Object.entries(ve).forEach(([rt,Ke])=>{const et=Te[rt];(0,S.isNil)(et)||(ve[rt]=(0,S.isEqual)(et,Ke)?et:{...(0,S.cloneDeep)(Ke),id:C.R.generateParticleId(rt,Be)})});const Ve=Array.from(new Set([...Object.values(Te),...Object.values(ve)])),we=G(_e,Te),Je=G(Ce,ve),tt={...A(we),...A(Je)};return{mergedParticles:Ve,currentChapters:we,importedChapters:Je,tweenParticleLookup:(0,S.pickBy)(tt,rt=>!(0,S.isEmpty)(rt))}}(he,_e,h(tt,Te,ve),h(st,Te,Ve).map(xe=>{const Me=xe.createdFrom??[];return Me.unshift({id:(0,V.u2)(Ce),timestamp:Date.now()}),{...xe,id:Ie("chapter"),createdFrom:Me}}),Ie),Fe=function o(he,ne){const _e=he.map(Ce=>Ce.objectId);return ne.map(Ce=>{const Be=Ce.showObjects??{},Ie=Ce.availableObjects??{};return{...Ce,availableObjects:(0,E.K$)(_e,Be,Ie)}})}(Oe,[...ge.currentChapters,...ge.importedChapters]),$e={...he.customData,particleSystems:ge.mergedParticles},ot="module"===Be?he.tags:[],je=(0,W.mJ)(he.sourceInfo,_e.sourceInfo);return{...he,assetLibraries:we,chapters:Fe,sceneGraph:Oe,customData:$e,tags:ot,reflections:Je,stateId:(0,S.uniq)([...he.stateId,..._e.stateId]),tweenParticleLookup:ge.tweenParticleLookup,sourceInfo:je}}var X,x=n(89612),z=n(24418),I=n(84426),D=n(21894),L=n(61295),Q=n(29284),ie=n(65881),se=n(35939),Z=n(76016),de=n(21472),ae=n(46104),q=n(17215),K=n(76774),j=n(65650),M=n(33013),$=n(82323),ce=n(11040),re=n(93132),ue=n(35650),H=n(79805),te=n(54438),F=function(he,ne,_e,Ce){var Oe,Be=arguments.length,Ie=Be<3?ne:null===Ce?Ce=Object.getOwnPropertyDescriptor(ne,_e):Ce;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)Ie=Reflect.decorate(he,ne,_e,Ce);else for(var Te=he.length-1;Te>=0;Te--)(Oe=he[Te])&&(Ie=(Be<3?Oe(Ie):Be>3?Oe(ne,_e,Ie):Oe(ne,_e))||Ie);return Be>3&&Ie&&Object.defineProperty(ne,_e,Ie),Ie},w=function(he,ne){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(he,ne)};const oe={loading:!1,incoming:{id:void 0,type:void 0},storyId:void 0,storyType:void 0,storyLang:void 0,loadingChapter:null,loadChapters:[],loadChaptersRemaining:[],thumbnailLookup:[],manifestsMaxTimes:void 0};let Y=class Rs{static#e=X=this;static getStory(ne){return ne.story}static getStoryId(ne){return ne.storyId}static getStoryType(ne){return ne.storyType}static getLoadingChapter(ne){return ne.loadingChapter}static getLoadChapters(ne){return ne.loadChapters}static getLoadChaptersRemaining(ne){return ne.loadChaptersRemaining}static getStoryInfo(ne){return{id:ne.storyId,type:ne.storyType}}static getIncomingStoryInfo(ne){return ne.incoming}static getStoryTags(ne){return ne?.story?.tags??[]}static getStoryLanguage(ne){return ne.storyLang??ce.q.lang}static getAnimationManifests(ne){return ne.manifestsMaxTimes}static getStorySourceInfo(ne){return ne.story?.sourceInfo}static getVariantSchemas(ne){return ne.story?.variantSchemas??{}}static getVariantSchema(ne){return(0,e.Mz)([X.getVariantSchemas],_e=>_e[ne])}setStoryText(ne,_e){const Ce=ne.getState().story;Ce&&ne.patchState({story:{...Ce,displayName:_e.displayName}})}setStoryTags(ne,{tags:_e}){const Ce=ne.getState().story;Ce&&ne.patchState({story:{...Ce,tags:_e}})}setStoryPlaythrough(ne,{playthroughSettings:_e}){const Ce=ne.getState().story;Ce&&ne.patchState({story:{...Ce,playthroughSettings:_e}})}setStorySourceInfo(ne,{sourceInfo:_e}){const Ce=ne.getState().story;Ce&&ne.patchState({story:{...Ce,sourceInfo:_e}})}loadManifests(ne){ne.patchState({manifestsMaxTimes:void 0});const _e=this.storyService.getTweenEndTimes(),Ce=Object.values(this.sceneService.getObjects());this.storyService.findMorphEndTimes(Ce).subscribe(Be=>{ne.patchState({manifestsMaxTimes:{...Be,..._e}})})}setStoryLightLibs(ne,_e){const Ce=ne.getState().story;Ce&&ne.patchState({story:{...Ce,assetLibraries:{...Ce.assetLibraries,lights:_e.lightLibs}}})}setStory(ne,_e){ne.patchState({story:_e.story})}SetStoryId(ne,_e){ne.patchState({storyId:_e.id})}setIncomingStory(ne,_e){const Ce=ne.getState(),{id:Be,type:Ie,reset:Oe}=_e;(Be!==Ce.storyId||Oe)&&ne.patchState({incoming:{id:Be,type:Ie}})}loadStory(ne,_e){const Ce=_e.preview?(0,de.H)(this.storageService.getDatabaseItem(q.AJ.PreviewStory)):this.storyService.getStory(_e.id,_e.type,_e.lang),Be=this.storyService.getStoryLang(_e.id,_e.type,_e.lang);(0,ae.p)([Ce,Be]).subscribe(([Ie,Oe])=>{ne.dispatch(new s.Z0(Ie,_e.id,_e.type,Oe))},()=>{!0===this.reload?(this.reload=!1,this.loadStory(ne,_e)):ne.dispatch(new s.S9(_e.id,_e.type))})}loadStorySuccess(ne,{story:_e,id:Ce,type:Be,lang:Ie}){ne.patchState({story:_e,storyId:Ce,storyType:Be,storyLang:Ie}),ne.dispatch(new s.Ck(Ce,_e,Be))}buildStoryWorkflow(ne,_e,Ce,Be,Ie=0,Oe=new Map,Te=!0){if((0,S.isNil)(this.engineService.engine))return;Te&&(Ce.moduleId=_e,this.engineService.setStory(Ce),ne.patchState({storyId:_e,story:Ce})),this.engineService.engine.start();const ve=this.sceneService.getRootObjects(),Ve=this.storyService.getStoryChapters(ve,Ce,Be);let we=[];Ve.forEach(Ee=>{we=[...we,...Ee.labels]});const Je=this.storyService.getStoryLoadChapters(Ce);ne.patchState({loadChapters:Je,loadChaptersRemaining:Je,incoming:{id:void 0,type:void 0}});const tt=this.sceneService.getSceneGraph(ve),st=Ve.reduce((Ee,Fe)=>(Ee[Fe.id]=(0,Q.iE)(tt,Fe.showObjects,Fe.availableObjects,Fe.pickThroughObjects,Fe.synchronization),Ee),{});Ve.forEach(Ee=>{((0,S.isNil)(Ee.createdFrom)||0===Ee.createdFrom.length)&&(Ee.createdFrom=[{id:_e,timestamp:Date.now()}])}),ne.dispatch(new L.K8(st)),ne.dispatch(new L.IA(Ve[Ie].id)),ne.dispatch(new M.lM(Ve)),ne.dispatch(new $.W2(Oe)),ne.dispatch(new P.gJ(we)),ne.dispatch(new M.yz(Ve[Ie]));const rt=Ce.tweenParticleLookup??{},Ke=Ce.customData?.particleSystems??[],et=Ve.reduce((Ee,Fe)=>(Ee[Fe.id]=Fe.customData?.particleSystems??[],Ee),{});ne.dispatch(new se.u.SetParticleState(Ke,et,rt)),ne.dispatch(new Z.B.ResetQuizState),Ce.quizSettings&&ne.dispatch(new Z.B.SetQuizSettings(Ce.quizSettings));const ge=(0,K.En)(Ve);ne.dispatch(new Z.B.SetQuestions(ge)),ne.dispatch(new s.nm),ne.dispatch(new re.B.SetChapterCallToActionSeen(!1)),ne.dispatch(new s.t1(Ce,_e,Be)),ne.dispatch(new s.ub)}importStorySuccess(ne,_e){const Ce=ne.getState(),Be=Ce.storyType,Ie=Ce.storyId,Te=new D.F,Ve=this.store.selectSnapshot(X.getStory),we=this.store.selectSnapshot(O.N.getStoryChapters),Je=(0,ie.S)(we,!1),tt=this.serializeModuleService.serialize({},Te,!1,Ve,we,Je,!1).story,st=T(tt,Ie,_e.story,_e.id,z.c.exportType),rt=st.chapters.slice(tt.chapters.length).reduce((et,ge,Ee)=>(et[_e.story.chapters[Ee].id]=ge.id,et),{}),Ke=_e.story.chapters.reduce((et,ge)=>{const Ee=ge.thumbnails?ge.thumbnails.large:x.V.generateLegacyThumbnail(_e.id,ge.id).large,Fe=x.V.makeFreshThumbnail(Ie,rt[ge.id],Ee);return et.push(Fe),et},[]);(0,ae.p)(Ke).subscribe(et=>{const ge=this.store.selectSnapshot(j.K.getRegisteredThumbnails);et.forEach(Ee=>{ge.set(Ee.chapterId,Ee)}),this.buildStoryWorkflow(ne,Ie,st,Be,st.chapters.length-1,ge)})}buildStory(ne,_e){const Ce=x.V.getChapterThumbnails(_e.id,_e.story.chapters);this.buildStoryWorkflow(ne,_e.id,_e.story,_e.type,_e.chapterIdx||0,Ce,_e.replaceActiveStory)}loadChapter(ne){const _e=ne.getState().loadChaptersRemaining[0];if(!_e)return;ne.patchState({loadingChapter:_e});let Ce=!1;this.storyService.loadChapter(_e).then(()=>{}).catch(Be=>{(0,S.isNil)(this.engineService.engine?.story)?Ce=!0:console.error(Be)}).finally(()=>{Ce?console.warn(`Loading of chapter ${_e.chapterId} cancelled.`):ne.dispatch([new s.dC(_e),new s.ub])})}reorderLoadChapters(ne,_e){const{loadChaptersRemaining:Ce}=ne.getState(),[Be,Ie]=(0,S.partition)(Ce,Oe=>Oe.chapterId===_e.chapterId);ne.patchState({loadChaptersRemaining:[...Be,...Ie]})}loadChapterSuccess(ne,_e){const Ce=ne.getState().loadChaptersRemaining.filter(Be=>Be.chapterId!==_e.chapter.chapterId);ne.patchState({loadingChapter:null,loadChaptersRemaining:Ce}),ne.dispatch(new M.M5(_e.chapter.chapterId,{model:!0,animation:!1,..._e.chapter.readyState})),ne.dispatch(new M.eV(_e.chapter.chapterId))}synchronizeChapters(ne){const _e=this.store.selectSnapshot(O.N.getStoryChapters),{story:Ce}=ne.getState();ne.patchState({story:{...Ce,chapters:[..._e]}})}importStory(ne,_e){this.storyService.getStory(_e.id,_e.type,_e.lang).subscribe(Ce=>{ne.dispatch(new s.yw(Ce,_e.id,_e.type))})}resetStory(ne){ne.setState(oe)}mergeBridgeModuleSuccess(ne,{story:_e}){const Ce=ne.getState(),Be=this.store.selectSnapshot(O.N.getSelectedChapterIndex),Ie=x.V.getChapterThumbnails(Ce.storyId,_e.chapters);this.buildStoryWorkflow(ne,Ce.storyId,_e,v.c.Module,Be,Ie)}constructor(ne,_e,Ce,Be,Ie,Oe){this.store=ne,this.storyService=_e,this.serializeModuleService=Ce,this.storageService=Be,this.sceneService=Ie,this.engineService=Oe,this.reload=z.c.native}static#t=this.\u0275fac=function(_e){return new(_e||Rs)(te.KVO(e.il),te.KVO(c.J),te.KVO(I.g),te.KVO(q.n$),te.KVO(ue.w),te.KVO(H.y))};static#n=this.\u0275prov=te.jDH({token:Rs,factory:Rs.\u0275fac})};F([(0,e.rc)(s.fK),w("design:type",Function),w("design:paramtypes",[Object,s.fK]),w("design:returntype",void 0)],Y.prototype,"setStoryText",null),F([(0,e.rc)(s.Hd),w("design:type",Function),w("design:paramtypes",[Object,s.Hd]),w("design:returntype",void 0)],Y.prototype,"setStoryTags",null),F([(0,e.rc)(s.dr),w("design:type",Function),w("design:paramtypes",[Object,s.dr]),w("design:returntype",void 0)],Y.prototype,"setStoryPlaythrough",null),F([(0,e.rc)(s.Pv),w("design:type",Function),w("design:paramtypes",[Object,s.Pv]),w("design:returntype",void 0)],Y.prototype,"setStorySourceInfo",null),F([(0,e.rc)(s.V_),w("design:type",Function),w("design:paramtypes",[Object]),w("design:returntype",void 0)],Y.prototype,"loadManifests",null),F([(0,e.rc)(s.KM),w("design:type",Function),w("design:paramtypes",[Object,s.KM]),w("design:returntype",void 0)],Y.prototype,"setStoryLightLibs",null),F([(0,e.rc)(s.cX),w("design:type",Function),w("design:paramtypes",[Object,s.cX]),w("design:returntype",void 0)],Y.prototype,"setStory",null),F([(0,e.rc)(s.Tt),w("design:type",Function),w("design:paramtypes",[Object,s.Tt]),w("design:returntype",void 0)],Y.prototype,"SetStoryId",null),F([(0,e.rc)(s.yi),w("design:type",Function),w("design:paramtypes",[Object,s.yi]),w("design:returntype",void 0)],Y.prototype,"setIncomingStory",null),F([(0,e.rc)(s.Ye),w("design:type",Function),w("design:paramtypes",[Object,s.Ye]),w("design:returntype",void 0)],Y.prototype,"loadStory",null),F([(0,e.rc)(s.Z0),w("design:type",Function),w("design:paramtypes",[Object,s.Z0]),w("design:returntype",void 0)],Y.prototype,"loadStorySuccess",null),F([(0,e.rc)(s.yw),w("design:type",Function),w("design:paramtypes",[Object,s.yw]),w("design:returntype",void 0)],Y.prototype,"importStorySuccess",null),F([(0,e.rc)(s.Ck),w("design:type",Function),w("design:paramtypes",[Object,s.Ck]),w("design:returntype",void 0)],Y.prototype,"buildStory",null),F([(0,e.rc)(s.ub),w("design:type",Function),w("design:paramtypes",[Object]),w("design:returntype",void 0)],Y.prototype,"loadChapter",null),F([(0,e.rc)(s.si),w("design:type",Function),w("design:paramtypes",[Object,s.si]),w("design:returntype",void 0)],Y.prototype,"reorderLoadChapters",null),F([(0,e.rc)(s.dC),w("design:type",Function),w("design:paramtypes",[Object,s.dC]),w("design:returntype",void 0)],Y.prototype,"loadChapterSuccess",null),F([(0,e.rc)(s.Hy),w("design:type",Function),w("design:paramtypes",[Object]),w("design:returntype",void 0)],Y.prototype,"synchronizeChapters",null),F([(0,e.rc)(s.fn),w("design:type",Function),w("design:paramtypes",[Object,s.fn]),w("design:returntype",void 0)],Y.prototype,"importStory",null),F([(0,e.rc)(s.jj),w("design:type",Function),w("design:paramtypes",[Object]),w("design:returntype",void 0)],Y.prototype,"resetStory",null),F([(0,e.rc)(s.Nu),w("design:type",Function),w("design:paramtypes",[Object,Object]),w("design:returntype",void 0)],Y.prototype,"mergeBridgeModuleSuccess",null),F([(0,e.MD)(),w("design:type",Function),w("design:paramtypes",[t.o]),w("design:returntype",void 0)],Y,"getStory",null),F([(0,e.MD)(),w("design:type",Function),w("design:paramtypes",[t.o]),w("design:returntype",void 0)],Y,"getStoryId",null),F([(0,e.MD)(),w("design:type",Function),w("design:paramtypes",[t.o]),w("design:returntype",void 0)],Y,"getStoryType",null),F([(0,e.MD)(),w("design:type",Function),w("design:paramtypes",[t.o]),w("design:returntype",void 0)],Y,"getLoadingChapter",null),F([(0,e.MD)(),w("design:type",Function),w("design:paramtypes",[t.o]),w("design:returntype",void 0)],Y,"getLoadChapters",null),F([(0,e.MD)(),w("design:type",Function),w("design:paramtypes",[t.o]),w("design:returntype",void 0)],Y,"getLoadChaptersRemaining",null),F([(0,e.MD)(),w("design:type",Function),w("design:paramtypes",[t.o]),w("design:returntype",void 0)],Y,"getStoryInfo",null),F([(0,e.MD)(),w("design:type",Function),w("design:paramtypes",[t.o]),w("design:returntype",void 0)],Y,"getIncomingStoryInfo",null),F([(0,e.MD)(),w("design:type",Function),w("design:paramtypes",[t.o]),w("design:returntype",void 0)],Y,"getStoryTags",null),F([(0,e.MD)(),w("design:type",Function),w("design:paramtypes",[t.o]),w("design:returntype",void 0)],Y,"getStoryLanguage",null),F([(0,e.MD)(),w("design:type",Function),w("design:paramtypes",[t.o]),w("design:returntype",void 0)],Y,"getAnimationManifests",null),F([(0,e.MD)(),w("design:type",Function),w("design:paramtypes",[t.o]),w("design:returntype",void 0)],Y,"getStorySourceInfo",null),F([(0,e.MD)(),w("design:type",Function),w("design:paramtypes",[t.o]),w("design:returntype",Object)],Y,"getVariantSchemas",null),Y=X=F([(0,e.Uw)({name:"story",defaults:oe}),w("design:paramtypes",[e.il,c.J,I.g,q.n$,ue.w,H.y])],Y)},82323:(le,N,n)=>{"use strict";n.d(N,{V9:()=>O,W2:()=>s,WX:()=>P,cf:()=>c});var e=n(10352),t=n(9592);let s=(()=>{class S{static#e=this.type="[Story Chapters] Register thumbnail URLs from story";constructor(f){this.thumbnails=f}}return S})(),c=(()=>{class S{static#e=this.type="[Story Chapters] Set chapter thumbnail";constructor(f,E){this.chapterId=f,this.thumbnail=E}}return S})(),O=(()=>{class S{static#e=this.type="[Story Chapters] Take picture";constructor(f,E=e.RK,y=t.H.JPEG,i=.92,g,p="original",h,o,v=[]){this.chapterId=f,this.background=E,this.imageType=y,this.imageQuality=i,this.dimensions=g,this.crop=p,this.includeLabels=h,this.includeCopyright=o,this.layers=v}}return S})(),P=(()=>{class S{static#e=this.type="[Story Chapters] Take picture success";constructor(f,E,y){this.chapterId=f,this.blob=E,this.dimensions=y}}return S})()},65650:(le,N,n)=>{"use strict";n.d(N,{K:()=>g});var e=n(92014),s=n(82323),c=n(1308),O=n(97415),P=n(57238),S=n(30582),a=n(81025),f=n(54438),E=function(p,h,o,v){var _,d=arguments.length,r=d<3?h:null===v?v=Object.getOwnPropertyDescriptor(h,o):v;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(p,h,o,v);else for(var u=p.length-1;u>=0;u--)(_=p[u])&&(r=(d<3?_(r):d>3?_(h,o,r):_(h,o))||r);return d>3&&r&&Object.defineProperty(h,o,r),r},y=function(p,h){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(p,h)};const i={thumbnails:new Map};let g=class Ls{static getRegisteredThumbnails(h){return h.thumbnails}registerChapterThumbnails(h,o){h.patchState(a.jM(h.getState(),v=>{v.thumbnails=new Map(o.thumbnails)}))}setChapterThumbnail(h,o){h.patchState(a.jM(h.getState(),v=>{v.thumbnails.set(o.chapterId,o.thumbnail)}))}takeChapterPicture(h,o){const{background:v,chapterId:d,includeLabels:r,includeCopyright:_,dimensions:u,imageType:l,imageQuality:m,crop:C,layers:b}=o,R=u||O.I.large,{width:A,height:G}=R,k=(0,c.F$)(l,v),V=this.snapshotService.getLogoFromBackground(v),W={...c._,crop:C,imageType:l,imageQuality:m,copyrightEnabled:_,copyrightImagePath:V.logo_url};this.snapshotService.takeSnapshot(A,G,k,b,r,W).subscribe(T=>{h.dispatch(new s.WX(d,T,R))})}takeChapterPictureSuccess(h,o){h.patchState(a.jM(h.getState(),v=>{const d=v.thumbnails.get(o.chapterId)||new P.R;d.snapshot=URL.createObjectURL(o.blob),v.thumbnails.set(o.chapterId,d)}))}constructor(h,o){this.snapshotService=h,this.store=o}static#e=this.\u0275fac=function(o){return new(o||Ls)(f.KVO(S.M),f.KVO(e.il))};static#t=this.\u0275prov=f.jDH({token:Ls,factory:Ls.\u0275fac})};E([(0,e.rc)(s.W2),y("design:type",Function),y("design:paramtypes",[Object,s.W2]),y("design:returntype",void 0)],g.prototype,"registerChapterThumbnails",null),E([(0,e.rc)(s.cf),y("design:type",Function),y("design:paramtypes",[Object,s.cf]),y("design:returntype",void 0)],g.prototype,"setChapterThumbnail",null),E([(0,e.rc)(s.V9),y("design:type",Function),y("design:paramtypes",[Object,s.V9]),y("design:returntype",void 0)],g.prototype,"takeChapterPicture",null),E([(0,e.rc)(s.WX),y("design:type",Function),y("design:paramtypes",[Object,s.WX]),y("design:returntype",void 0)],g.prototype,"takeChapterPictureSuccess",null),E([(0,e.MD)(),y("design:type",Function),y("design:paramtypes",[class t{}]),y("design:returntype",void 0)],g,"getRegisteredThumbnails",null),g=E([(0,e.Uw)({name:"storyThumbnails",defaults:i}),y("design:paramtypes",[S.M,e.il])],g)},41373:(le,N,n)=>{"use strict";n.d(N,{F:()=>e});let e=(()=>{class t{static#e=this.type="[Story Video] Set current video";constructor(c){this.currentVideo=c}}return t})()},41623:(le,N,n)=>{"use strict";n.d(N,{Y:()=>f});var e=n(92014),t=n(41373),s=n(81025),c=n(95419),O=n(54438),P=function(E,y,i,g){var o,p=arguments.length,h=p<3?y:null===g?g=Object.getOwnPropertyDescriptor(y,i):g;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)h=Reflect.decorate(E,y,i,g);else for(var v=E.length-1;v>=0;v--)(o=E[v])&&(h=(p<3?o(h):p>3?o(y,i,h):o(y,i))||h);return p>3&&h&&Object.defineProperty(y,i,h),h},S=function(E,y){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(E,y)};let f=class Us{static getCurrentVideo(y){return y.currentVideo}SetCurrentVideo(y,i){y.patchState(s.jM(y.getState(),g=>{const p=g.currentVideo;g.currentVideo=i.currentVideo;const h=this.mediaService.getVideoPlayer(p);h&&h.pause()}))}constructor(y){this.mediaService=y}static#e=this.\u0275fac=function(i){return new(i||Us)(O.KVO(c.u))};static#t=this.\u0275prov=O.jDH({token:Us,factory:Us.\u0275fac})};P([(0,e.rc)(t.F),S("design:type",Function),S("design:paramtypes",[Object,t.F]),S("design:returntype",void 0)],f.prototype,"SetCurrentVideo",null),P([(0,e.MD)(),S("design:type",Function),S("design:paramtypes",[Object]),S("design:returntype",void 0)],f,"getCurrentVideo",null),f=P([(0,e.Uw)({name:"storyVideo",defaults:{currentVideo:null}}),S("design:paramtypes",[c.u])],f)},10381:(le,N,n)=>{"use strict";n.d(N,{k:()=>m});var e=n(60177),t=n(92014),s=n(22679),c=n(38753),O=n(25209),P=n(21604),S=n(94495),a=n(45189),f=n(44461),E=n(82192),y=n(35286),i=n(26513),g=n(39685),p=n(24125),h=n(45911),o=n(47001),v=n(89417),d=n(42617),r=n(8465),_=n(65650),u=n(41623),l=n(54438);let m=(()=>{class C{static#e=this.\u0275fac=function(A){return new(A||C)};static#t=this.\u0275mod=l.$C({type:C});static#n=this.\u0275inj=l.G2t({imports:[t.rK.forFeature([s.t,S.N,c.y,_.K,u.Y]),e.MD,P.G,a.G,E.G,g.y,v.X1,y.y2.forChild(),d.c,O.H,f.B,i.b,p.P,h.l,o.L,r.M]})}return C})()},16606:(le,N,n)=>{"use strict";n.d(N,{J:()=>k});var e=n(28407),t=n(15877),s=n(46104),c=n(38399),O=n(36110),P=n(28577),S=n(26657),a=n(18171),f=n(17766),E=n(79805),y=n(11789),i=n(24418),g=n(13976),p=n(43753),h=n(12347),o=n(94495),v=n(33013),d=n(65881),r=n(49204),u=n(63745),l=n(47632),m=n(66056),C=n(54438),b=n(21626),R=n(92014),A=n(60177);function G(V,W,T){return W===f.c.Bookmark?`/search/bookmarks/tr/${T}/${V}`:`/tr/${T}/${V}.json`}let k=(()=>{class V{constructor(T,x,z,I,D,L,Q){this.http=T,this.animationService=x,this.engineService=z,this.chapterService=I,this.contentBlocksService=D,this.store=L,this.location=Q}getLoadChapter(T,x){const z=new S.Z;return z.activate=!1,z.chapterId=x.id,z.readyState={model:!0,animation:!0},z}getStory(T,x,z="en"){const I=x===f.c.Bookmark?this.getBookmark(T):this.getContent(T);if("en"===z)return I;{let D;return I.pipe((0,c.q)(L=>(D=L,this.getStoryTranslation(T,x,z)))).pipe((0,O.T)(L=>this.translateStory(D,L)),(0,P.W)(()=>I))}}getContentRoot(){return!0===i.c.offline?typeof localBaseDirectory>"u"?"":localBaseDirectory:"/"}getContent(T){return this.http.get(this.getContentRoot()+`content/modules/${T}.json`).pipe((0,O.T)(x=>this.normalizeStory(x)))}getBookmark(T){return this.http.get("/search/bookmarks/data",{params:{be:T}}).pipe((0,O.T)(x=>this.normalizeStory(x.bookmark)))}addContentRecord(T,x){x.createdFrom||(x.createdFrom=[]),x.createdFrom.unshift({id:(0,u.u2)(T),timestamp:Date.now()})}loadNewBookmark(T,x,z,I){const D=T.id,L=T.type,Q=new URLSearchParams(document.location.search);Q.set("id",D),this.location.replaceState(document.location.pathname,`?${Q.toString()}`),this.store.dispatch(new l.sN(T)),this.store.dispatch(new m.Ck(D,x,L,I,z))}checkStoryIdChange(T,x){return(0,u.u2)(T)!==(0,u.u2)(x)}getMorphManifest(T){return this.http.get(`/content/states/${T}/animations/morphs/manifest`).pipe((0,O.T)(x=>[T,x]))}getLargestKeyFromManifest(T){const x=Object.values(T.morphs).map(z=>z.keys[z.keys.length-1]);return Math.max(...x)}findMorphEndTimes(T){const x=new Set;if(T.forEach(z=>{z.renderables.filter(({morphId:I})=>!(0,r.isNil)(I)).forEach(({morphId:I})=>{x.add(I.split("/")[0])})}),0===x.size)return(0,t.of)({});{const z=Array.from(x).map(I=>this.getMorphManifest(I));return(0,s.p)(z).pipe((0,O.T)(I=>I.reduce((D,[L,Q])=>(D[L]=this.getLargestKeyFromManifest(Q),D),{})))}}getTweenEndTimes(){const x={};return this.engineService.engine.story.chapters.forEach(z=>{const{tweens:I}=z;Object.keys(I).forEach(D=>{const L=Object.values(I[D].tweens),Q=Math.max(...L.map(se=>se.keys).flat()),ie=D.split("/")[0];Q>(x[ie]??0)&&(x[ie]=Q)})}),x}getStoryChapters(T,x,z){return x.chapters.map((I,D)=>this.chapterService.getChapter(T,x,z,I,D))}getStoryLoadChapters(T){return T.chapters.map(z=>this.getLoadChapter(T,z))}loadChapter(T){var x=this;return(0,e.A)(function*(){const z=x.engineService.engine.story.chapters,I=x.store.selectSnapshot(o.N.getStoryChapters),D=x.store.selectSnapshot(o.N.getSelectedChapterIndex),L=I.findIndex(ie=>ie.id===T.chapterId),Q=z[L];return Q.load().then(()=>L===D?x.animationService.setChapter(T.chapterId):Q.id)})()}addChapterToEngine(T,x){var z=this;return(0,e.A)(function*(){const D=z.chapterService.processChapterForEngine(T),L=z.engineService.engine.story.createChapter(D,x);return z.engineService.engine.story.chapters[L].load().then(()=>{z.store.dispatch(new v.yz(T))})})()}removeChapterFromEngine(T){this.engineService.engine.story.chapters.splice(T,1)}moveChapterInEngine(T,x){var z=this;return(0,e.A)(function*(){const I=z.engineService.engine?.story?.activeChapter?.id,D=z.engineService.engine?.story?.chapters.splice(T,1).pop();if(z.engineService.engine.story.chapters.splice(x,0,D),D.id===I)return z.animationService.setChapter(D.id,!0).then(()=>D.id)})()}getStoryTranslation(T,x,z){const I=G(T,x,z);return this.http.get(I)}getStoryLang(T,x,z){if("en"===z)return(0,t.of)("en");const I=G(T,x,z);return this.http.head(I).pipe((0,O.T)(()=>!0),(0,P.W)(()=>(0,t.of)(!1)),(0,O.T)(D=>D?z:"en"))}getStoryType(T){return T.indexOf("/")>=0?f.c.Module:f.c.Bookmark}translateStory(T,x){const I=T.chapters||[],D=T.sceneGraph||[],L=x.objects||{},Q=x.chapters||[];return T.displayName=x.displayName||T.displayName,T.description=x.description||T.description,D.forEach(ie=>{(ie.objects||[]).forEach(Z=>{this.translateObject(Z,L)})}),I.forEach((ie,se)=>{const Z=Q[se];if(Z){this.translateMetaInfo(ie,Z);const ae=Z.annotations||[];(ie.annotations||[]).forEach((re,ue)=>{const H=ae[ue];H&&this.translateMetaInfo(re,H)});const K=Z.hotspots||[];(ie.hotspots||[]).forEach((re,ue)=>{const H=K[ue];H&&this.translateMetaInfo(re,H)});const M=Z.quizQuestions||[];(ie.quizQuestions||[]).forEach((re,ue)=>{const H=M[ue];H&&this.translateQuizQuestion(re,H)});const $=ie?.contentBlocks,ce=Z?.contentBlocks;Array.isArray($)&&Array.isArray(ce)&&$.forEach((re,ue)=>{const H=ce[ue];H&&this.translateContentBlock(re,H)})}}),T}translateQuizQuestion(T,x){if(x.nextLabel&&(T.nextLabel=x.nextLabel),["questionPrompt","explanation"].forEach(z=>{const D=x[z]||[];(T[z]||[]).forEach((L,Q)=>{const ie=D[Q];ie&&(L.markdown=ie.markdown)})}),T.data&&x.data){const I=x.data.options||[];(T.data.options||[]).forEach((D,L)=>{const Q=I[L];Q&&(T.type===p.Q5.LabelAnatomy?this.translateMetaInfo(D.label,Q.label):D.label=Q.label)})}}translateMetaInfo(T,x){const{title:z,description:I}=x;T.hasOwnProperty("displayName")&&(T.displayName=z),T.hasOwnProperty("title")&&(T.title=z),T.hasOwnProperty("description")&&(T.description=I)}translateObject(T,x){const I=x[T.objectId];I&&(T.displayName=I);const D=T.objects;D&&D.forEach(L=>{this.translateObject(L,x)})}translateContentBlock(T,x){(0,r.merge)(T,x)}exportWrittenContent(T,x,z){const I=[];return I.push(`\n${T.displayName}\n    `),x.forEach((D,L)=>{I.push(`\n---\n\n# Chapter ${L+1}: ${D.displayName||"-No Title-"}\n\n${D.description||"-No Description-"}\n      `),D.legend.length&&(I.push("\n## Legend\n"),D.legend.forEach(ie=>{I.push(`\n* ${ie.label} (${y.T.rgbToHex(ie.colors,!0)})\n`)}));const Q=z.filter(ie=>ie.chapterId===D.id);Q.length&&(I.push("\n## Labels\n"),Q.forEach(ie=>{I.push(`\n* ${ie.title}\n`),ie.description&&I.push(`\n  > ${ie.description}\n`)}))}),I.join("")}exportQuizKey(T){const x=[];return T.forEach((z,I)=>{switch(x.push(`\n# QUESTION ${I+1} (${p.of[z.type]})\n\n## PROMPT\n${this.contentBlocksService.extractContentBlockText(z.questionPrompt)}\n      `),z.type){case p.Q5.MultipleChoice:z.data.options.forEach((D,L)=>{x.push(`\n## ANSWER ${L+1} ${z.data.correctAnswer===D.value?"- CORRECT":""}\n${D.label}\n            `)});break;case p.Q5.SelectAnatomy:x.push("\n## ANSWERS\n          "),z.data.correctAnswer.forEach((D,L)=>{x.push(`\n${D}\n            `)});break;case p.Q5.LabelAnatomy:z.data.options.forEach((D,L)=>{x.push(`\n## ANSWER ${L+1}\n${D.label.title}\n            `)})}this.contentBlocksService.extractContentBlockText(z.explanation).length&&x.push(`\n  \n## EXPLANATION\n${this.contentBlocksService.extractContentBlockText(z.explanation)}\n        `),x.push("\n\n\n      ")}),x.join("")}normalizeStory(T){return T.chapters.forEach(x=>{x.id||(x.id=(0,d.G)())}),T}static#e=this.\u0275fac=function(x){return new(x||V)(C.KVO(b.Qq),C.KVO(h.O),C.KVO(E.y),C.KVO(a.j),C.KVO(g.V),C.KVO(R.il),C.KVO(A.aZ))};static#t=this.\u0275prov=C.jDH({token:V,factory:V.\u0275fac,providedIn:"root"})}return V})()},63508:(le,N,n)=>{"use strict";n.d(N,{Mi:()=>c,Uv:()=>s,VV:()=>P,d0:()=>a});var e=n(49204);function s(f){return!!("lights"in f&&Array.isArray(f?.lights.libraries)||"environment"in f&&!(0,e.isEmpty)(f?.environment))}function c(f){return"lightLibraryId"in f}function O(f){return f.assetLibraries.lights.map(E=>({type:E.includes("_physical_")?"physical":"legacy",libId:E}))}function P(f){return c(f)?{type:"physical",libId:f.lightLibraryId}:s(f)?{type:"legacy",libId:f.lights.libraries[0]}:null}function a(f,E){const y=function S(f,E){return[...O(f),...E.map(y=>P(y))].filter(y=>!(0,e.isNil)(y))}(f,E).map(i=>i.libId);return Array.from(new Set(y))}},2096:(le,N,n)=>{"use strict";n.d(N,{CE:()=>P,eq:()=>O,mJ:()=>S});var e=n(49204),s=n(24418),c=n(27180);const O="https://www.biodigital.com/p/content-standards-and-development-process";function P(a){if((0,e.isEmpty)(a))return;const{audit:f,reviewed:E,collaborated:y,references:i}=a,g=i?.filter(h=>h.label.trim().length>0)??[],p={};return g.length>0&&(p.references=g),s.c.application!==c.c.Loft||(E?.enabled&&(p.reviewed=E),y?.enabled&&(p.collaborated=y)),f?.enabled&&(p.audit=f),(0,e.isEmpty)(p)?void 0:p}function S(a,f){const E=[...a?.references??[],...f?.references??[]];if(E.length>0)return{references:E,audit:{enabled:!0===a?.audit?.enabled&&!0===f?.audit?.enabled}}}},64566:(le,N,n)=>{"use strict";n.d(N,{u:()=>r});var e=n(85052),t=n(2573),s=n(14264),c=n(37925),O=n(87145),P=n(17365),S=n(92014),a=n(49204),E=n(94495),y=n(61295),i=n(33013),g=n(35650),p=n(93822),h=n(51640),o=n(54438),v=function(_,u,l,m){var R,C=arguments.length,b=C<3?u:null===m?m=Object.getOwnPropertyDescriptor(u,l):m;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)b=Reflect.decorate(_,u,l,m);else for(var A=_.length-1;A>=0;A--)(R=_[A])&&(b=(C<3?R(b):C>3?R(u,l,b):R(u,l))||b);return C>3&&b&&Object.defineProperty(u,l,b),b},d=function(_,u){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(_,u)};class r{constructor(u,l){this.store=u,this.sceneService=l}initObservables(){this.destroyObservables(),this.ngUnsubscribe=new e.B,this.selectedChapterId$.pipe((0,s.p)(u=>!(0,a.isNil)(u)),(0,c.Q)(this.ngUnsubscribe)).subscribe(()=>{this.listenForCurrentLayerGroupsChanges()})}listenForCurrentLayerGroupsChanges(){const u=this.selectedChapterId$.pipe((0,O.i)(1),(0,P.s)(1));this.currentLayerGroups$.pipe((0,s.p)(l=>!(0,a.isNil)(l)&&l.length>0),(0,O.i)(1),(0,c.Q)(u)).subscribe(l=>{const m=this.getObjectVisibilityFromGroups(l);this.store.dispatch(new y.yr(!1,[],m,!1))})}destroyObservables(){this.ngUnsubscribe&&(this.ngUnsubscribe.next(),this.ngUnsubscribe.complete(),this.ngUnsubscribe=null)}syncLayerGroupsToScene(u){const l=this.getObjectVisibilityFromGroups(u);this.sceneService.setShownObjects({showObjects:l})}syncLayerGroupsToState(u,l,m){this.store.dispatch(new i.$V(u,l,m))}computeGroupPositionsByFraction(u,l){const C=u.map(A=>A.layers).flat().length,b=Math.round(C*(0,a.clamp)(l,0,1));let R=C;for(let A=0;A<u.length;A++){const G=u[A];G.position=0;for(let k=G.layers.length,V=k-1,W=k;V>=0;V--,W--,R--)R<=b&&0===G.position&&(G.position=W)}return u}getObjectVisibilityFromGroups(u){const l={};return u.forEach(({layers:m,position:C})=>{const b=m.length-C;m.forEach((R,A)=>{const{objectIds:G}=R,k=b<=A;G.forEach(V=>l[V]=k)})}),l}static#e=this.\u0275fac=function(l){return new(l||r)(o.KVO(S.il),o.KVO(g.w))};static#t=this.\u0275prov=o.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}v([(0,S.l6)(E.N.getSelectedChapterId),d("design:type",t.c)],r.prototype,"selectedChapterId$",void 0),v([(0,S.l6)(E.N.getSelectedChapterLayerGroups),d("design:type",t.c)],r.prototype,"currentLayerGroups$",void 0),v([(0,S.l6)(h.dF.getUIEntry(p.U.VisibilityLayers)),d("design:type",t.c)],r.prototype,"visibilityLayersUI$",void 0)},75069:(le,N,n)=>{"use strict";var e,t;n.d(N,{a:()=>e}),(t=e||(e={})).Reset=(()=>{class a{static#e=this.type="[Undo] Reset";constructor(){}}return a})(),t.Undo=(()=>{class a{static#e=this.type="[Undo] Undo";constructor(E){this.chapterId=E}}return a})(),t.UndoAll=(()=>{class a{static#e=this.type="[Undo] Undo All";constructor(E){this.chapterId=E}}return a})(),t.Redo=(()=>{class a{static#e=this.type="[Undo] Redo";constructor(E){this.chapterId=E}}return a})(),t.SavePatches=(()=>{class a{static#e=this.type="[Undo] Store Patches";constructor(E){this.patches=E}}return a})()},68504:(le,N,n)=>{"use strict";n.d(N,{o:()=>y});var e=n(92014),t=n(75069),s=n(94495),c=n(49204),P=n(81025),S=n(54438),a=function(i,g,p,h){var d,o=arguments.length,v=o<3?g:null===h?h=Object.getOwnPropertyDescriptor(g,p):h;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)v=Reflect.decorate(i,g,p,h);else for(var r=i.length-1;r>=0;r--)(d=i[r])&&(v=(o<3?d(v):o>3?d(g,p,v):d(g,p))||v);return o>3&&v&&Object.defineProperty(g,p,v),v},f=function(i,g){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(i,g)};let y=class js{constructor(g){this.store=g}static getStacksForChapter(g){return g.stacksForChapter??{}}static getUndoStack(g,p){return g[p]?.undoStack??[]}static getRedoStack(g,p){return g[p]?.redoStack??[]}static canUndo(g){return g.length>0}static canRedo(g){return g.length>0}static getUndoCount(g){return g.length}reset(g,p){g.patchState(P.jM(g.getState(),h=>{h.stacksForChapter={}}))}undoAll(g,p){const h=g.getState();if(void 0===h.stacksForChapter[p.chapterId])return;const o=[...h.stacksForChapter[p.chapterId].undoStack].reverse(),v=o.flat().reduce((r,_)=>{const{patchAction:u,inverse:l}=_,m=u?.type;return r[m]=r[m]??{actionClass:u,patches:[]},r[m].patches.push(...l),r},{});Object.keys(v).forEach(r=>{const{actionClass:_,patches:u}=v[r];g.dispatch(new _(u))});const d=P.jM(h,r=>{r.stacksForChapter[p.chapterId].undoStack=[],r.stacksForChapter[p.chapterId].redoStack=o});g.patchState(d)}preserveState(g,p){const h=this.store.selectSnapshot(s.N.getSelectedChapterId),o=P.jM(g.getState(),v=>{0===p.patches.length||p.patches.some(r=>0===r.forward.length)&&p.patches.some(r=>0===r.inverse.length)||(void 0===v.stacksForChapter[h]&&(v.stacksForChapter[h]={redoStack:[],undoStack:[]}),v.stacksForChapter[h].redoStack=[],v.stacksForChapter[h].undoStack.push(p.patches))});g.patchState(o)}redo(g,p){const h=g.getState(),o=(0,c.get)(h.stacksForChapter[p.chapterId],"redoStack",[]);if(0===o.length)return;const v=o[o.length-1],d=P.jM(h,r=>{r.stacksForChapter[p.chapterId].redoStack.pop(),r.stacksForChapter[p.chapterId].undoStack.push(v)});g.patchState(d),v.forEach(r=>{g.dispatch(new r.patchAction(r.forward))})}undo(g,p){const h=g.getState(),o=(0,c.get)(h.stacksForChapter[p.chapterId],"undoStack",[]);if(0===o.length)return;const v=o[o.length-1],d=P.jM(h,r=>{r.stacksForChapter[p.chapterId].undoStack.pop(),r.stacksForChapter[p.chapterId].redoStack.push(v)});g.patchState(d),v.forEach(r=>{g.dispatch(new r.patchAction(r.inverse))})}static#e=this.\u0275fac=function(p){return new(p||js)(S.KVO(e.il))};static#t=this.\u0275prov=S.jDH({token:js,factory:js.\u0275fac})};a([(0,e.rc)(t.a.Reset),f("design:type",Function),f("design:paramtypes",[Object,t.a.Reset]),f("design:returntype",void 0)],y.prototype,"reset",null),a([(0,e.rc)(t.a.UndoAll),f("design:type",Function),f("design:paramtypes",[Object,t.a.UndoAll]),f("design:returntype",void 0)],y.prototype,"undoAll",null),a([(0,e.rc)(t.a.SavePatches),f("design:type",Function),f("design:paramtypes",[Object,t.a.SavePatches]),f("design:returntype",void 0)],y.prototype,"preserveState",null),a([(0,e.rc)(t.a.Redo),f("design:type",Function),f("design:paramtypes",[Object,t.a.Redo]),f("design:returntype",void 0)],y.prototype,"redo",null),a([(0,e.rc)(t.a.Undo),f("design:type",Function),f("design:paramtypes",[Object,t.a.Undo]),f("design:returntype",void 0)],y.prototype,"undo",null),a([(0,e.MD)([y]),f("design:type",Function),f("design:paramtypes",[Object]),f("design:returntype",Object)],y,"getStacksForChapter",null),a([(0,e.MD)([y.getStacksForChapter,s.N.getSelectedChapterId]),f("design:type",Function),f("design:paramtypes",[Object,String]),f("design:returntype",Array)],y,"getUndoStack",null),a([(0,e.MD)([y.getStacksForChapter,s.N.getSelectedChapterId]),f("design:type",Function),f("design:paramtypes",[Object,String]),f("design:returntype",Array)],y,"getRedoStack",null),a([(0,e.MD)([y.getUndoStack]),f("design:type",Function),f("design:paramtypes",[Array]),f("design:returntype",Boolean)],y,"canUndo",null),a([(0,e.MD)([y.getRedoStack]),f("design:type",Function),f("design:paramtypes",[Array]),f("design:returntype",Boolean)],y,"canRedo",null),a([(0,e.MD)([y.getUndoStack]),f("design:type",Function),f("design:paramtypes",[Array]),f("design:returntype",Number)],y,"getUndoCount",null),y=a([(0,e.Um)({injectContainerState:!1}),(0,e.Uw)({name:"undo",defaults:{stacksForChapter:{}}}),f("design:paramtypes",[e.il])],y)},82608:(le,N,n)=>{"use strict";n.d(N,{$k:()=>q,AA:()=>a,Ae:()=>k,Al:()=>l,Bf:()=>se,CA:()=>I,CU:()=>C,CW:()=>z,DY:()=>j,Fk:()=>A,GV:()=>e,H7:()=>M,HF:()=>t,HO:()=>p,HZ:()=>i,J0:()=>de,Jt:()=>c,Kl:()=>o,Lh:()=>ce,QB:()=>r,Qi:()=>Z,Qy:()=>R,Rr:()=>f,S$:()=>d,Ud:()=>W,XW:()=>Q,Xm:()=>u,ZO:()=>V,_M:()=>ae,_W:()=>h,_b:()=>L,ah:()=>G,dG:()=>x,dQ:()=>m,f0:()=>S,h2:()=>E,iW:()=>g,jV:()=>T,jv:()=>b,ku:()=>ie,lX:()=>D,mb:()=>K,mq:()=>$,qy:()=>_,rD:()=>v,w9:()=>y,y7:()=>s,yX:()=>O,zi:()=>P});let e=(()=>{class re{static#e=this.type="[Users] Join Organization";constructor(H){this.organization=H}}return re})(),t=(()=>{class re{static#e=this.type="[Users] Join Organization Success";constructor(H){this.organization=H}}return re})(),s=(()=>{class re{static#e=this.type="[Users] Join Organization Fail";constructor(H){this.organization=H}}return re})(),c=(()=>{class re{static#e=this.type="[Users] Join Organization With Code";constructor(H){this.code=H}}return re})(),O=(()=>{class re{static#e=this.type="[Users] Join Organization With Code Success";constructor(H){this.organizationName=H}}return re})(),P=(()=>{class re{static#e=this.type="[Users] Join Organization With Code Fail";constructor(H){this.error=H}}return re})(),S=(()=>{class re{static#e=this.type="[Users] Leave Organization";constructor(H){this.organization=H}}return re})(),a=(()=>{class re{static#e=this.type="[Users] Leave Organization Success";constructor(H){this.organization=H}}return re})(),f=(()=>{class re{static#e=this.type="[Users] Leave Organization Fail";constructor(H){this.error=H}}return re})(),E=(()=>{class re{static#e=this.type="[Users] Send Organization Invite";constructor(H,te){this.groupEID=H,this.invites=te}}return re})(),y=(()=>{class re{static#e=this.type="[Users] Send Organization Invite Success";constructor(H){this.responses=H}}return re})(),i=(()=>{class re{static#e=this.type="[Users] Send Organization Invite Fail";constructor(H){this.error=H}}return re})(),g=(()=>{class re{static#e=this.type="[Users] Get Organization Users";constructor(H){this.groupId=H}}return re})(),p=(()=>{class re{static#e=this.type="[Users] Get Organization Users Success";constructor(H){this.users=H}}return re})(),h=(()=>{class re{static#e=this.type="[Users] Get Organization Users Fail";constructor(H){this.error=H}}return re})(),o=(()=>{class re{static#e=this.type="[Users] Get Organization Invited Users";constructor(H){this.groupId=H}}return re})(),v=(()=>{class re{static#e=this.type="[Users] Get Organization Invited Users Success";constructor(H){this.invites=H}}return re})(),d=(()=>{class re{static#e=this.type="[Users] Get Organization Invited Users Fail";constructor(H){this.error=H}}return re})(),r=(()=>{class re{static#e=this.type="[Users] Reset"}return re})(),_=(()=>{class re{static#e=this.type="[Users] Update User Roles";constructor(H,te){this.groupId=H,this.users=te}}return re})(),u=(()=>{class re{static#e=this.type="[Users] Update User Roles Success";constructor(H,te){this.groupId=H,this.users=te}}return re})(),l=(()=>{class re{static#e=this.type="[Users] Update User Roles Fail"}return re})(),m=(()=>{class re{static#e=this.type="[Users] Remove Organization User";constructor(H,te){this.groupId=H,this.users=te}}return re})(),C=(()=>{class re{static#e=this.type="[Users] Remove Organization User Success";constructor(H,te){this.groupId=H,this.users=te}}return re})(),b=(()=>{class re{static#e=this.type="[Users] Remove Organization User Fail"}return re})(),R=(()=>{class re{static#e=this.type="[Users] Transfer Organization Content";constructor(H,te){this.groupId=H,this.users=te}}return re})(),A=(()=>{class re{static#e=this.type="[Users] Transfer Organization Content Success";constructor(H,te){this.groupId=H,this.users=te}}return re})(),G=(()=>{class re{static#e=this.type="[Users] Transfer Organization Content Fail"}return re})(),k=(()=>{class re{static#e=this.type="[Users] Get Eligible Join Organizations";constructor(H){this.params=H}}return re})(),V=(()=>{class re{static#e=this.type="[Users] Get Eligible Join Organizations Success";constructor(H){this.eligibleOrganizations=H}}return re})(),W=(()=>{class re{static#e=this.type="[Users] Get Eligible Join Organizations Error";constructor(H){this.error=H}}return re})(),T=(()=>{class re{static#e=this.type="[Users] Clear Eligible Join Organizations"}return re})(),x=(()=>{class re{static#e=this.type="[Users] Get Join Requests";constructor(H){this.params=H}}return re})(),z=(()=>{class re{static#e=this.type="[Users] Get Join Requests Success";constructor(H){this.joinRequests=H}}return re})(),I=(()=>{class re{static#e=this.type="[Users] Post Join Request";constructor(H,te){this.organizationId=H,this.description=te}}return re})(),D=(()=>{class re{static#e=this.type="[Users] Post Join Request Success";constructor(H){this.joinRequestKey=H}}return re})(),L=(()=>{class re{static#e=this.type="[Users] Post Join Request Error";constructor(H){this.error=H}}return re})(),Q=(()=>{class re{static#e=this.type="[Users] Delete Join Request";constructor(H){this.joinRequestKey=H}}return re})(),ie=(()=>{class re{static#e=this.type="[Users] Delete Join Request Success"}return re})(),se=(()=>{class re{static#e=this.type="[Users] Delete Join Request Error";constructor(H){this.error=H}}return re})(),Z=(()=>{class re{static#e=this.type="[Users] Get Organization Join Requests";constructor(H){this.params=H}}return re})(),de=(()=>{class re{static#e=this.type="[Users] Get Organization Join Requests Success";constructor(H){this.organizationJoinRequests=H}}return re})(),ae=(()=>{class re{static#e=this.type="[Users] Get Organization Join Requests Error";constructor(H){this.error=H}}return re})(),q=(()=>{class re{static#e=this.type="[Users] Accept Join Requests";constructor(H){this.joinRequests=H}}return re})(),K=(()=>{class re{static#e=this.type="[Users] Accept Join Requests Success";constructor(H){this.count=H}}return re})(),j=(()=>{class re{static#e=this.type="[Users] Accept Join Requests Error";constructor(H,te){this.count=H,this.error=te}}return re})(),M=(()=>{class re{static#e=this.type="[Users] Deny Join Requests";constructor(H){this.joinRequestKeys=H}}return re})(),$=(()=>{class re{static#e=this.type="[Users] Deny Join Requests Success";constructor(H){this.count=H}}return re})(),ce=(()=>{class re{static#e=this.type="[Users] Deny Join Requests Error";constructor(H,te){this.count=H,this.error=te}}return re})()},99504:(le,N,n)=>{"use strict";n.d(N,{e:()=>d});var e=n(92014),t=n(82608),s=n(15152),c=n(11756),O=n(59e3),P=n(80910);class S{}var o,a=n(5690),f=n(71263),E=n(38165),y=n(3188),i=n(50262),g=n(54438),p=function(r,_,u,l){var b,m=arguments.length,C=m<3?_:null===l?l=Object.getOwnPropertyDescriptor(_,u):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)C=Reflect.decorate(r,_,u,l);else for(var R=r.length-1;R>=0;R--)(b=r[R])&&(C=(m<3?b(C):m>3?b(_,u,C):b(_,u))||C);return m>3&&C&&Object.defineProperty(_,u,C),C},h=function(r,_){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(r,_)};const v={joining:!1,leaving:!1,inviting:!1,loadingUsers:!1,loadingInvites:!1,loadingOrganizationJoinRequests:!1,loadingJoinRequests:!1,loadingEligibleOrganizations:!1,postingJoinRequest:!1,deletingJoinRequest:!1,users:[],invites:[],joinRequests:[],organizationJoinRequests:[]};let d=class Ns{static#e=o=this;static getUsers(_){return _.users}static getInvites(_){return _.invites}static getUsersLoading(_){return _.loadingUsers}static getJoining(_){return _.joining}static getLeaving(_){return _.leaving}static getInviting(_){return _.inviting}static getLoadingJoinRequests(_){return _.loadingJoinRequests}static getLoadingOrganizationJoinRequests(_){return _.organizationJoinRequests}static getLoadingEligibleOrganizations(_){return _.loadingEligibleOrganizations}static getPostingJoinRequest(_){return _.postingJoinRequest}static getDeletingJoinRequest(_){return _.deletingJoinRequest}static getRequesting(_){return _.loadingJoinRequests||_.loadingEligibleOrganizations||_.postingJoinRequest||_.deletingJoinRequest}static getEligibleOrganizations(_){return _.eligibleOrganizations}static hasEligibleOrganizations(_){return Array.isArray(_.eligibleOrganizations)&&_.eligibleOrganizations.length>0}static getJoinRequests(_){return _.joinRequests}static getPendingJoinRequest(_){return _.joinRequests?.find(u=>u.request_status===y.s.Pending)}static getOrganizationJoinRequests(_){return _.organizationJoinRequests}static getPendingOrganizationJoinRequests(_){return _.organizationJoinRequests.filter(u=>u.request_status===y.s.Pending)}joinOrganization(_,{organization:u}){_.patchState({joining:!0}),this.usersService.addUserToOrganization(u.eid).pipe((0,s.j)(()=>_.patchState({joining:!1}))).subscribe(()=>_.dispatch(new t.HF(u)),()=>_.dispatch(new t.y7(u)))}joinOrganizationWithCode(_,{code:u}){_.patchState({joining:!0}),this.usersService.addUserWithGroupCode(u).pipe((0,s.j)(()=>_.patchState({joining:!1}))).subscribe(l=>_.dispatch(new t.yX(l)),l=>_.dispatch(new t.zi(l)))}joinOrganizationWithCodeSuccess(){this.vendorAnalyticsService.track("Account Upgrade - Free Individual to Team")}leaveOrganization(_,{organization:u}){_.patchState({leaving:!0}),this.usersService.removeUser(u.id).pipe((0,s.j)(()=>_.patchState({leaving:!1}))).subscribe({next:()=>_.dispatch(new t.AA(u)),error:l=>_.dispatch(new t.Rr(l))})}sendOrganizationInvite(_,{groupEID:u,invites:l}){_.patchState({inviting:!0}),this.authService.verifyIsHuman("invites","",!0).pipe((0,c.Z)(({isHuman:m,verification:C})=>{if(!m)throw new i.s;return this.usersService.sendOrganizationInvites(u,l,C)}),(0,s.j)(()=>_.patchState({inviting:!1}))).subscribe({next:m=>{_.dispatch(new t.w9(m))},error:m=>{m instanceof i.s&&_.dispatch(new E.sz(m)),_.dispatch(new t.HZ(m))}})}getOrganizationUsers(_,{groupId:u}){_.patchState({loadingUsers:!0}),this.usersService.getOrganizationUsers({group_id:u}).pipe((0,s.j)(()=>_.patchState({loadingUsers:!1}))).subscribe(l=>_.dispatch(new t.HO(l)),l=>_.dispatch(new t._W(l)))}getOrganizationUsersSuccess(_,{users:u}){_.patchState({users:u})}getOrganizationUserInvites(_,{groupId:u}){_.patchState({loadingInvites:!0}),this.usersService.getOrganizationInvites({group_id:u,version:1,app_productkey:this.productService.productKey,app_producttype:this.productService.productType}).pipe((0,s.j)(()=>_.patchState({loadingInvites:!1}))).subscribe(l=>_.dispatch(new t.rD(l)),l=>_.dispatch(new t.S$(l)))}getOrganizationUserInvitesSuccess(_,{invites:u}){_.patchState({invites:u})}resetOrganizations(_){_.setState(v)}updateUserRoles(_,{groupId:u,users:l}){this.usersService.updateUserRoles(u,l).subscribe(()=>_.dispatch(new t.Xm(u,l)),()=>_.dispatch(new t.Al))}removeOrganizationUser(_,{groupId:u,users:l}){this.usersService.removeUsers(u,l).subscribe(()=>_.dispatch(new t.CU(u,l)),()=>_.dispatch(new t.jv))}transferOrganizationContent(_,{groupId:u,users:l}){this.usersService.transferUserContent(u,l).subscribe(()=>_.dispatch(new t.Fk(u,l)),()=>_.dispatch(new t.ah))}clearEligibleJoinOrganizations(_,u){_.patchState({eligibleOrganizations:[]})}getEligibleJoinOrganizations(_,u){_.patchState({loadingEligibleOrganizations:!0}),this.usersService.getEligibleJoinOrganizations(u.params).pipe((0,s.j)(()=>_.patchState({loadingEligibleOrganizations:!1}))).subscribe({next:l=>{_.dispatch(new t.ZO(l.eligible_orgs))},error:l=>_.dispatch(new t.Ud(l))})}getEligibleJoinOrganizationsSuccess(_,{eligibleOrganizations:u}){_.patchState({eligibleOrganizations:u})}getJoinRequests(_,u){_.patchState({loadingJoinRequests:!0}),this.usersService.getJoinRequests(u.params).pipe((0,s.j)(()=>_.patchState({loadingJoinRequests:!1}))).subscribe(l=>{_.dispatch(new t.CW(l.join_requests))})}getJoinRequestsSuccess(_,{joinRequests:u}){_.patchState({joinRequests:u}),o.getPendingJoinRequest(_.getState())&&_.dispatch(new t.jV)}postJoinRequest(_,u){_.patchState({postingJoinRequest:!0}),this.usersService.postJoinRequest(u.organizationId,u.description).pipe((0,s.j)(()=>_.patchState({postingJoinRequest:!1}))).subscribe({next:l=>{_.dispatch(new t.lX(l.join_request_key)),_.dispatch(new t.dG)},error:l=>_.dispatch(new t._b(l))})}deleteJoinRequest(_,u){_.patchState({deletingJoinRequest:!0}),this.usersService.deleteJoinRequest(u.joinRequestKey).pipe((0,s.j)(()=>_.patchState({deletingJoinRequest:!1}))).subscribe({next:()=>{_.dispatch(new t.ku),_.dispatch(new t.dG)},error:l=>_.dispatch(new t.Bf(l))})}getOrganizationJoinRequests(_,u){_.patchState({loadingOrganizationJoinRequests:!0}),this.usersService.getOrganizationJoinRequests(u.params).pipe((0,s.j)(()=>_.patchState({loadingOrganizationJoinRequests:!1}))).subscribe({next:l=>{_.dispatch(new t.J0(l.join_requests))},error:l=>_.dispatch(new t._M(l))})}getOrganizationJoinRequestsSuccess(_,{organizationJoinRequests:u}){_.patchState({organizationJoinRequests:u})}acceptJoinRequests(_,u){const l=u.joinRequests.length;this.usersService.acceptOrganizationJoinRequests(u.joinRequests).subscribe({next:()=>{_.dispatch(new t.mb(l))},error:m=>_.dispatch(new t.DY(l,m))})}denyJoinRequests(_,u){const l=u.joinRequestKeys.length;this.usersService.denyOrganizationJoinRequests(u.joinRequestKeys).subscribe({next:()=>{_.dispatch(new t.mq(l))},error:m=>_.dispatch(new t.Lh(l,m))})}constructor(_,u,l,m){this.usersService=_,this.vendorAnalyticsService=u,this.productService=l,this.authService=m}static#t=this.\u0275fac=function(u){return new(u||Ns)(g.KVO(P.g),g.KVO(O.e),g.KVO(a.b),g.KVO(f.u))};static#n=this.\u0275prov=g.jDH({token:Ns,factory:Ns.\u0275fac})};p([(0,e.rc)(t.GV),h("design:type",Function),h("design:paramtypes",[Object,t.GV]),h("design:returntype",void 0)],d.prototype,"joinOrganization",null),p([(0,e.rc)(t.Jt),h("design:type",Function),h("design:paramtypes",[Object,t.Jt]),h("design:returntype",void 0)],d.prototype,"joinOrganizationWithCode",null),p([(0,e.rc)(t.yX),h("design:type",Function),h("design:paramtypes",[]),h("design:returntype",void 0)],d.prototype,"joinOrganizationWithCodeSuccess",null),p([(0,e.rc)(t.f0),h("design:type",Function),h("design:paramtypes",[Object,t.f0]),h("design:returntype",void 0)],d.prototype,"leaveOrganization",null),p([(0,e.rc)(t.h2),h("design:type",Function),h("design:paramtypes",[Object,t.h2]),h("design:returntype",void 0)],d.prototype,"sendOrganizationInvite",null),p([(0,e.rc)(t.iW),h("design:type",Function),h("design:paramtypes",[Object,t.iW]),h("design:returntype",void 0)],d.prototype,"getOrganizationUsers",null),p([(0,e.rc)(t.HO),h("design:type",Function),h("design:paramtypes",[Object,t.HO]),h("design:returntype",void 0)],d.prototype,"getOrganizationUsersSuccess",null),p([(0,e.rc)(t.Kl),h("design:type",Function),h("design:paramtypes",[Object,t.Kl]),h("design:returntype",void 0)],d.prototype,"getOrganizationUserInvites",null),p([(0,e.rc)(t.rD),h("design:type",Function),h("design:paramtypes",[Object,t.rD]),h("design:returntype",void 0)],d.prototype,"getOrganizationUserInvitesSuccess",null),p([(0,e.rc)(t.QB),h("design:type",Function),h("design:paramtypes",[Object]),h("design:returntype",void 0)],d.prototype,"resetOrganizations",null),p([(0,e.rc)(t.qy),h("design:type",Function),h("design:paramtypes",[Object,t.qy]),h("design:returntype",void 0)],d.prototype,"updateUserRoles",null),p([(0,e.rc)(t.dQ),h("design:type",Function),h("design:paramtypes",[Object,t.dQ]),h("design:returntype",void 0)],d.prototype,"removeOrganizationUser",null),p([(0,e.rc)(t.Qy),h("design:type",Function),h("design:paramtypes",[Object,t.Qy]),h("design:returntype",void 0)],d.prototype,"transferOrganizationContent",null),p([(0,e.rc)(t.jV),h("design:type",Function),h("design:paramtypes",[Object,t.jV]),h("design:returntype",void 0)],d.prototype,"clearEligibleJoinOrganizations",null),p([(0,e.rc)(t.Ae),h("design:type",Function),h("design:paramtypes",[Object,t.Ae]),h("design:returntype",void 0)],d.prototype,"getEligibleJoinOrganizations",null),p([(0,e.rc)(t.ZO),h("design:type",Function),h("design:paramtypes",[Object,t.ZO]),h("design:returntype",void 0)],d.prototype,"getEligibleJoinOrganizationsSuccess",null),p([(0,e.rc)(t.dG),h("design:type",Function),h("design:paramtypes",[Object,t.dG]),h("design:returntype",void 0)],d.prototype,"getJoinRequests",null),p([(0,e.rc)(t.CW),h("design:type",Function),h("design:paramtypes",[Object,t.CW]),h("design:returntype",void 0)],d.prototype,"getJoinRequestsSuccess",null),p([(0,e.rc)(t.CA),h("design:type",Function),h("design:paramtypes",[Object,t.CA]),h("design:returntype",void 0)],d.prototype,"postJoinRequest",null),p([(0,e.rc)(t.XW),h("design:type",Function),h("design:paramtypes",[Object,t.XW]),h("design:returntype",void 0)],d.prototype,"deleteJoinRequest",null),p([(0,e.rc)(t.Qi),h("design:type",Function),h("design:paramtypes",[Object,t.Qi]),h("design:returntype",void 0)],d.prototype,"getOrganizationJoinRequests",null),p([(0,e.rc)(t.J0),h("design:type",Function),h("design:paramtypes",[Object,t.J0]),h("design:returntype",void 0)],d.prototype,"getOrganizationJoinRequestsSuccess",null),p([(0,e.rc)(t.$k),h("design:type",Function),h("design:paramtypes",[Object,t.$k]),h("design:returntype",void 0)],d.prototype,"acceptJoinRequests",null),p([(0,e.rc)(t.H7),h("design:type",Function),h("design:paramtypes",[Object,t.H7]),h("design:returntype",void 0)],d.prototype,"denyJoinRequests",null),p([(0,e.MD)(),h("design:type",Function),h("design:paramtypes",[S]),h("design:returntype",void 0)],d,"getUsers",null),p([(0,e.MD)(),h("design:type",Function),h("design:paramtypes",[S]),h("design:returntype",void 0)],d,"getInvites",null),p([(0,e.MD)(),h("design:type",Function),h("design:paramtypes",[S]),h("design:returntype",void 0)],d,"getUsersLoading",null),p([(0,e.MD)(),h("design:type",Function),h("design:paramtypes",[S]),h("design:returntype",void 0)],d,"getJoining",null),p([(0,e.MD)(),h("design:type",Function),h("design:paramtypes",[S]),h("design:returntype",void 0)],d,"getLeaving",null),p([(0,e.MD)(),h("design:type",Function),h("design:paramtypes",[S]),h("design:returntype",void 0)],d,"getInviting",null),p([(0,e.MD)(),h("design:type",Function),h("design:paramtypes",[S]),h("design:returntype",void 0)],d,"getLoadingJoinRequests",null),p([(0,e.MD)(),h("design:type",Function),h("design:paramtypes",[S]),h("design:returntype",void 0)],d,"getLoadingOrganizationJoinRequests",null),p([(0,e.MD)(),h("design:type",Function),h("design:paramtypes",[S]),h("design:returntype",void 0)],d,"getLoadingEligibleOrganizations",null),p([(0,e.MD)(),h("design:type",Function),h("design:paramtypes",[S]),h("design:returntype",void 0)],d,"getPostingJoinRequest",null),p([(0,e.MD)(),h("design:type",Function),h("design:paramtypes",[S]),h("design:returntype",void 0)],d,"getDeletingJoinRequest",null),p([(0,e.MD)(),h("design:type",Function),h("design:paramtypes",[S]),h("design:returntype",void 0)],d,"getRequesting",null),p([(0,e.MD)(),h("design:type",Function),h("design:paramtypes",[S]),h("design:returntype",void 0)],d,"getEligibleOrganizations",null),p([(0,e.MD)(),h("design:type",Function),h("design:paramtypes",[S]),h("design:returntype",void 0)],d,"hasEligibleOrganizations",null),p([(0,e.MD)(),h("design:type",Function),h("design:paramtypes",[S]),h("design:returntype",void 0)],d,"getJoinRequests",null),p([(0,e.MD)(),h("design:type",Function),h("design:paramtypes",[S]),h("design:returntype",void 0)],d,"getPendingJoinRequest",null),p([(0,e.MD)(),h("design:type",Function),h("design:paramtypes",[S]),h("design:returntype",void 0)],d,"getOrganizationJoinRequests",null),p([(0,e.MD)(),h("design:type",Function),h("design:paramtypes",[S]),h("design:returntype",void 0)],d,"getPendingOrganizationJoinRequests",null),d=o=p([(0,e.Uw)({name:"users",defaults:v}),h("design:paramtypes",[P.g,O.e,a.b,f.u])],d)},80910:(le,N,n)=>{"use strict";n.d(N,{g:()=>o});var e=n(21626),t=n(7974),s=n(63831),c=n(46104),O=n(36110),P=n(26727),S=n(56081),a=n(2824),f=n(5690),E=n(54438);const y="/ws/organization/join/requests",i="/ws/user/join/requests",g="/ws/organization/user",p="/ws/organization/users";let o=(()=>{class v{constructor(r,_){this.http=r,this.productService=_}getOrganizationJoinRequests(r){const _={version:1,app_productkey:this.productService.productKey,app_producttype:this.productService.productType,...r},u=new e.Nl({fromObject:{..._}});return this.http.get(y,{params:u})}acceptOrganizationJoinRequests(r){return this.batchRequest(r,u=>this.http.post(y,{version:1,app_productkey:this.productService.productKey,app_producttype:this.productService.productType,join_requests_accept:u}))}denyOrganizationJoinRequests(r){return this.batchRequest(r,u=>this.http.post(y,{version:1,app_productkey:this.productService.productKey,app_producttype:this.productService.productType,join_requests_deny:u}))}getEligibleJoinOrganizations(r){const _={version:1,app_productkey:this.productService.productKey,app_producttype:this.productService.productType,...r},u=new e.Nl({fromObject:{..._}});return this.http.get(`${i}/eligibility`,{params:u})}getJoinRequests(r){const _={version:1,app_productkey:this.productService.productKey,app_producttype:this.productService.productType,...r},u=new e.Nl({fromObject:{..._}});return this.http.get(i,{params:u})}postJoinRequest(r,_){return this.http.post(i,{version:1,app_productkey:this.productService.productKey,app_producttype:this.productService.productType,organization_id:r,request_desc:_})}deleteJoinRequest(r){return this.http.request("delete",i,{body:{version:1,app_productkey:this.productService.productKey,app_producttype:this.productService.productType,join_request_key:r}})}getOrganizationUsers(r){const _=a.V(r);return this.http.get(`${p}${_}`).pipe((0,O.T)(u=>u.users),(0,O.T)(u=>u.map(l=>({...l,user_role:(0,S.t9)(l.user_role)}))))}getOrganizationInvites(r){const _=a.V(r);return this.http.get(`/ws/organization/invite${_}`).pipe((0,O.T)(u=>u.invites),(0,O.T)(u=>u.map(l=>({...l,invite_user:{...l.inviter_user,user_role:(0,S.t9)(l.inviter_user.user_role)},invitee_user:{...l.invitee_user,user_role:(0,S.t9)(l.invitee_user.user_role)}}))))}sendOrganizationInvites(r,_,u){return this.http.post("/ws/organization/invite",{version:2,group_eid:r,invite_emails:_,site_verify_response:u}).pipe((0,O.T)(l=>{const{messages:m}=l.results_summary;return m}))}addUserToOrganization(r){return this.http.post(`${g}/add`,{group_eid:r})}addUserWithGroupCode(r){return this.http.post(`${g}/add`,{group_code:r}).pipe((0,O.T)(_=>_.organization_name))}updateUserRoles(r,_){return this.batchRequest(_,l=>this.http.post(p,{group_id:r,update_users:l.map(m=>({user_id:m.userId,role_id:m.roleId}))}))}removeUser(r){return this.http.post(`${g}/leave`,{version:1,app_productkey:this.productService.productKey,app_producttype:this.productService.productType,group_id:r})}removeUsers(r,_){return this.batchRequest(_,l=>this.http.post(p,{group_id:r,remove_users:l.map(m=>this.createTransferRequest(m))}))}transferUserContent(r,_){return this.batchRequest(_,l=>this.http.post("/ws/organization/bookmark/transfer",{group_id:r,transfer_bookmarks:l.map(m=>this.createTransferRequest(m))}))}createUserDisplayModel(r,_,u){return{name:this.formatUserName(r),initials:this.formatBadgeLabel(r),email:r.user_email,id:r.user_id,role:r.user_role,activeDeveloper:this.hasActiveDeveloperAccount(r),selected:!1,invitationStatus:_,joinRequestKey:u}}isUserModel(r){return["developer_account","developer_account_active","developer_has_apps"].every(u=>r.hasOwnProperty(u))}hasActiveDeveloperAccount(r){return!!this.isUserModel(r)&&r.developer_account&&r.developer_account_active&&r.developer_has_apps}batchRequest(r,_){let u=0;const l=[];for(;u<r.length;){const C=r.slice(u,u+50);l.push(_(C)),u+=50}const m=(0,t.c)(l,s.T).pipe((0,P.K)());return(0,c.p)(m).pipe((0,O.T)(()=>!0))}createTransferRequest(r){const{sourceUserId:_,targetUserId:u}=r;return"number"==typeof u?{user_id:_,group_bookmarks:{transfer_ownership:1,transfer_user_id:u}}:{user_id:_}}formatUserName(r){const{user_first_name:_,user_last_name:u}=r,l=[_,u].filter(m=>!!m);return l.length>0?l.join(" "):""}formatBadgeLabel(r){const{user_first_name:_,user_last_name:u}=r;return[_,u].filter(m=>!!m).map(m=>m[0]).join("")}static#e=this.\u0275fac=function(_){return new(_||v)(E.KVO(e.Qq),E.KVO(f.b))};static#t=this.\u0275prov=E.jDH({token:v,factory:v.\u0275fac,providedIn:"root"})}return v})()},30607:(le,N,n)=>{"use strict";n.d(N,{k:()=>p});var e=n(65294),t=n(7431),s=n(24552),c=n(43753),O=n(76016),P=n(87710),S=n(94495),a=n(51529),f=n(39358),E=n(13181),y=n(54438),i=n(92014),g=n(83621);let p=(()=>{class h{constructor(v,d,r){this.store=v,this.viewService=d,this.applicationEventService=r}startQuiz(){this.viewService.toggleColumn(!0),this.viewService.toggleLabels(!1),this.viewService.toggleLayers(!1),this.viewService.clearFadedNodes(),this.viewService.clearSelectedNodes(),this.store.dispatch(new t.nW),this.viewService.setContentMode(a.G.Quiz),this.store.dispatch(new O.B.SetQuizActive(!0));const v=this.store.selectSnapshot(P.j.getAllQuestions)[0].id;this.store.dispatch(new O.B.SetActiveQuestion(v))}resetQuiz(){this.viewService.clearFadedNodes(),this.viewService.clearSelectedNodes(),this.store.dispatch(new t.nW),this.store.dispatch(new O.B.SetQuizActive(!1)),this.store.dispatch(new O.B.SetActiveSubmission(void 0)),this.store.dispatch(new O.B.ClearSubmissions),this.store.dispatch(new O.B.SetQuizLifecycle(s.h.Question))}exitQuiz(){this.resetQuiz(),this.viewService.setContentMode(a.G.ChapterInfo),this.viewService.toggleLabels(!0),this.viewService.toggleDrawer(E.Q.Hide),setTimeout(()=>{this.store.dispatch(new t.Ih(this.store.selectSnapshot(S.N.getChapterCamera),!1))})}submitQuestion(v,d){const r=this.store.selectSnapshot(P.j.getAllQuestions).find(m=>m.id===v),_=this.store.selectSnapshot(P.j.getQuizSettings),u=this.store.selectSnapshot(P.j.getQuizLaunchMode);this.store.dispatch(new O.B.SubmitQuestionAnswer({questionId:r.id,answer:d})),this.store.dispatch(new O.B.SetActiveSubmission({questionId:r.id,answer:d})),this.applicationEventService.fireEvent(e.F.QuizAnswerSubmitted,{questionId:r.id,answer:d}),u===P.W.Learning&&r.type!==c.Q5.Instructions&&!1!==_.showExplanation?this.store.dispatch(new O.B.SetQuizLifecycle(s.h.Explanation)):this.nextQuestion()}nextQuestion(){this.store.dispatch(new O.B.SetActiveSubmission(void 0)),this.store.selectSnapshot(P.j.hasQuestionRemaining)?(this.store.dispatch(new O.B.SetQuizLifecycle(s.h.Question)),this.viewService.clearFadedNodes(),this.viewService.clearSelectedNodes(),this.store.dispatch(new O.B.NextQuestion)):(this.store.dispatch(new O.B.SetQuizLifecycle(s.h.Review)),this.applicationEventService.fireEvent(e.F.QuizCompleted,!0))}static#e=this.\u0275fac=function(d){return new(d||h)(y.KVO(i.il),y.KVO(f.z),y.KVO(g.S))};static#t=this.\u0275prov=y.jDH({token:h,factory:h.\u0275fac,providedIn:"root"})}return h})()},83403:(le,N,n)=>{"use strict";n.d(N,{R:()=>u});var e=n(54438),t=n(90699),s=n(6930),c=n(48570),O=n(17276),P=n(93132),S=n(72026),a=n(89079),f=n(32724),E=n(35426),y=n(45861),i=n(92014),g=n(26779);const p=["link"];function h(l,m){1&l&&(e.j41(0,"span"),e.pXf(1,1),e.k0s())}function o(l,m){1&l&&(e.j41(0,"span"),e.pXf(1,2),e.k0s())}function v(l,m){if(1&l&&(e.nrm(0,"app-icon",6),e.DNE(1,h,2,0,"span")(2,o,2,0,"span")),2&l){const C=e.XpG();e.R7$(),e.vxM(C.active()?1:2)}}function d(l,m){1&l&&(e.j41(0,"span"),e.pXf(1,3),e.k0s())}function r(l,m){1&l&&(e.j41(0,"span"),e.pXf(1,4),e.k0s())}function _(l,m){if(1&l&&(e.nrm(0,"img",7),e.DNE(1,d,2,0,"span")(2,r,2,0,"span")),2&l){const C=e.XpG();e.R7$(),e.vxM(C.active()?1:2)}}let u=(()=>{class l{constructor(C){this.store=C,this.xrLoaderEnum=s.t,this.link=(0,e.ebz)("link"),this.vrActive=(0,a.ot)(this.store.select(f.U.getVRActive)),this.arActive=(0,a.ot)(this.store.select(f.U.getARActive)),this.platform=(0,a.ot)(this.store.select(f.U.getXRPlatform)),this.mode=e.hFB.required(),this.title=e.hFB.required(),this.transparent=e.hFB.required(),this.bordered=e.hFB.required(),this.compact=(0,e.hFB)(!1),this.modelUrl=(0,e.hFB)(),this.exitXT=(0,e.CGW)(),this.modelLink=(0,e.EWP)(()=>{const b=this.mode(),R=this.title(),A=this.modelUrl();return b===s.t.AR&&A?(0,y.w)(A,{checkoutTitle:R,checkoutSubtitle:$localize`Browse our documentation`,callToAction:$localize`Learn More`}):"#"}),this.active=(0,e.EWP)(()=>{const b=this.mode(),R=this.vrActive(),A=this.arActive();switch(b){case s.t.VR:return R;case s.t.AR:return A;default:return!1}}),this.cssClasses=(0,e.EWP)(()=>{const b=this.compact(),R=this.transparent(),A=this.bordered(),G=[];return G.push(...b?["min-h-10","min-w-10"]:["min-h-12","min-w-12"]),G.push(R?"bg-transparent":"bg-white"),A&&G.push("border","border-solid","border-gray-200"),G}),this.destroyRef=(0,e.WQX)(e.abz)}ngAfterViewInit(){const C=this.link().nativeElement;(0,E.R)(C,"click").pipe((0,a.pQ)(this.destroyRef)).subscribe(b=>{const R=this.active(),A=this.mode(),G=this.platform();G!==t.I.iOS&&(b.preventDefault(),b.stopPropagation(),b.stopImmediatePropagation()),this.handleXRClick(R,A,G)}),(0,E.R)(C,"message").pipe((0,a.pQ)(this.destroyRef)).subscribe(b=>{if("_apple_ar_quicklook_button_tapped"===b?.data){const R=this.mode();this.exitXT.emit(R)}})}handleXRClick(C,b,R){if(this.store.dispatch(new P.B.ToggleWindow(O.U.XRLoader,!1)),C)this.store.dispatch(new c.W.ExitXR);else if(R!==t.I.iOS)return b===s.t.VR?this.store.dispatch(new c.W.EnterXR("immersive-vr")):b===s.t.AR&&this.store.dispatch(new c.W.EnterXR("immersive-ar")),!1}static#e=this.\u0275fac=function(b){return new(b||l)(e.rXU(i.il))};static#t=this.\u0275cmp=e.VBU({type:l,selectors:[["app-view-xr-button"]],viewQuery:function(b,R){1&b&&e.wEZ(R.link,p,5),2&b&&e.NyB()},inputs:{mode:[1,"mode"],title:[1,"title"],transparent:[1,"transparent"],bordered:[1,"bordered"],compact:[1,"compact"],modelUrl:[1,"modelUrl"]},outputs:{exitXT:"exitXT"},standalone:!0,features:[e.aNF],decls:4,vars:4,consts:()=>{let C,b,R,A;return C=$localize`:d8f00947439583705b11afdb26b3606125755d7b1909228686165085461:Exit VR`,b=$localize`:8b77d7e13579af1dbecb22db0e5a928086275f053152290368589851844:View in VR`,R=$localize`:1d0d80fb57ed2c1c18d12b2df218541387455b4d6343763191422968223:Exit AR`,A=$localize`:36eff850df47c04db84bb5447dec7e42e65697375491567984328908672:View in AR`,[["link",""],C,b,R,A,["rel","ar noreferrer nofollow",1,"flex","flex-row","items-center","justify-center","gap-2","px-2","text-sm","rounded","visited:text-gray-600","whitespace-nowrap",3,"href"],["icon","head-side-goggles"],["src","assets/images/ar_icon.svg","width","16","alt","View in AR","i18-alt",""]]},template:function(b,R){if(1&b&&(e.j41(0,"a",5,0),e.DNE(2,v,3,1)(3,_,3,1),e.k0s()),2&b){let A;e.HbH(R.cssClasses()),e.Y8G("href",R.modelLink(),e.B4B),e.R7$(2),e.vxM((A=R.mode())===R.xrLoaderEnum.VR?2:A===R.xrLoaderEnum.AR?3:-1)}},dependencies:[S.o,g.R]})}return l})()},39898:(le,N,n)=>{"use strict";n.d(N,{J:()=>e});var e=function(t){return t[t.Basics=0]="Basics",t[t.All=1]="All",t[t.Shortcuts=2]="Shortcuts",t}(e||{})},65855:(le,N,n)=>{"use strict";n.d(N,{i:()=>e});var e=function(t){return t.None="none",t.Play="play",t.Button="button",t.Hand="hand",t.Summary="summary",t}(e||{})},51529:(le,N,n)=>{"use strict";n.d(N,{G:()=>e});var e=function(t){return t.NodeInfo="nodeInfo",t.LabelInfo="labelInfo",t.ChapterInfo="chapterInfo",t.Quiz="Quiz",t.Search="Search",t.VisibilityLayers="VisibilityLayers",t}(e||{})},79083:(le,N,n)=>{"use strict";n.d(N,{H:()=>e});var e=function(t){return t.BioDigital="biodigital",t.Wikipedia="wikipedia",t.NCIT="ncit",t}(e||{})},47932:(le,N,n)=>{"use strict";n.d(N,{A:()=>e});var e=function(t){return t.Mouse="mouse",t.Touch="touch",t}(e||{})},3057:(le,N,n)=>{"use strict";n.d(N,{o:()=>e});var e=function(t){return t[t.Default=0]="Default",t.DrawerOnly="drawer",t.ColumnOnly="column",t}(e||{})},62949:(le,N,n)=>{"use strict";n.d(N,{G:()=>e});var e=function(t){return t.Drawer="drawer",t.Column="column",t}(e||{})},96557:(le,N,n)=>{"use strict";n.d(N,{aD:()=>s,ij:()=>O,kF:()=>P});var e=n(24418),t=n(27180),s=function(S){return S.None="none",S.Circle="circle",S.Bar="bar",S}(s||{});const O=s.Circle,P=e.c.application===t.c.Viewer?O:s.Circle},47125:(le,N,n)=>{"use strict";n.d(N,{R:()=>e});var e=function(s){return s.Enabled="enabled",s.Disabled="disabled",s.Locked="locked",s}(e||{})},13181:(le,N,n)=>{"use strict";n.d(N,{Q:()=>e});var e=function(t){return t.Hide="hide",t.Show="show",t.Collapse="collapse",t}(e||{})},93822:(le,N,n)=>{"use strict";n.d(N,{U:()=>e});var e=function(t){return t.AnatomyLabels="anatomyLabels",t.Audio="audio",t.Camera="camera",t.Column="column",t.ColumnToggle="columnToggle",t.ContextActions="contextActions",t.ContextMenu="contextMenu",t.Description="description",t.Drawer="drawer",t.DrawerToggle="drawerToggle",t.DrawerExpanded="drawerExpanded",t.Fullscreen="fullscreen",t.Help="help",t.LabelList="labelList",t.Labels="labels",t.VisibilityLayers="visibilityLayers",t.VisibilityLayersMode="visibilityLayersMode",t.SkinLayers="skinLayers",t.Layout="layout",t.Legend="legend",t.Loader="loader",t.XRLoader="xrLoader",t.Logo="logo",t.Media="media",t.ToolbarOverflow="toolbarOverflow",t.NodeInfo="nodeInfo",t.NodeAudio="nodeAudio",t.Pagination="pagination",t.Playthrough="playthrough",t.QuizPrompt="quizPrompt",t.Search="search",t.TitleOnly="titleOnly",t.ToggleLabels="toggleLabels",t.Toolbar="toolbar",t.Tools="tools",t.Tutorial="tutorial",t.Undo="undo",t.Whiteboard="whiteboard",t}(e||{})},17276:(le,N,n)=>{"use strict";n.d(N,{U:()=>e});var e=function(t){return t[t.XRLoader=0]="XRLoader",t[t.OnDemand=1]="OnDemand",t[t.Interact=2]="Interact",t[t.Loader=3]="Loader",t[t.Tutorial=4]="Tutorial",t[t.Whiteboard=5]="Whiteboard",t[t.Help=6]="Help",t}(e||{})},55671:(le,N,n)=>{"use strict";n.d(N,{D:()=>e});var e=function(s){return s.Text="text",s.Paint="paint",s.Erase="erase",s}(e||{})},6930:(le,N,n)=>{"use strict";n.d(N,{t:()=>e});var e=function(t){return t.None="none",t.VR="vr",t.AR="ar",t}(e||{})},50677:(le,N,n)=>{"use strict";var e,t;n.d(N,{p:()=>e}),(t=e||(e={})).ToggleVisible=(()=>{class P{static#e=this.type="[ViewUI] Toggle Visible";constructor(a){this.settings=a}}return P})(),t.SetUI=(()=>{class P{static#e=this.type="[ViewUI] Set UI";constructor(a){this.ui=a}}return P})(),t.SetInitialUI=(()=>{class P{static#e=this.type="[ViewUI] Set Initial UI";constructor(a){this.ui=a}}return P})()},51640:(le,N,n)=>{"use strict";n.d(N,{dF:()=>R,p2:()=>m});var e=n(92014),t=n(13181),s=n(93822),c=n(28722),O=n(96557),P=n(6930),S=n(11876);class a{constructor(G=t.Q.Hide,k=!0){this.status=G,this.enable=k}}class f extends a{constructor(G){super(),this.userStatusPreference=G}}var l,v=n(50677),d=n(49204),r=n(54438),_=function(A,G,k,V){var x,W=arguments.length,T=W<3?G:null===V?V=Object.getOwnPropertyDescriptor(G,k):V;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)T=Reflect.decorate(A,G,k,V);else for(var z=A.length-1;z>=0;z--)(x=A[z])&&(T=(W<3?x(T):W>3?x(G,k,T):x(G,k))||T);return W>3&&T&&Object.defineProperty(G,k,T),T},u=function(A,G){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(A,G)};const m={[s.U.Audio]:new a,[s.U.AnatomyLabels]:new a,[s.U.Camera]:new a,[s.U.Column]:new f(null),[s.U.ColumnToggle]:new a,[s.U.ContextActions]:new a,[s.U.ContextMenu]:new a(t.Q.Show,!0),[s.U.Description]:new a,[s.U.Drawer]:new class E extends f{constructor(){super(...arguments),this.isExpandedInitially=!1}}(null),[s.U.DrawerToggle]:new a,[s.U.Fullscreen]:new a,[s.U.Help]:new a,[s.U.Labels]:new class h extends a{constructor(G=!0){super(),this.shown=G}},[s.U.LabelList]:new a(t.Q.Show,!1),[s.U.Legend]:new a,[s.U.Loader]:new class g extends a{constructor(G=O.kF){super(),this.template=G}},[s.U.XRLoader]:new class p extends a{constructor(G=P.t.None){super(),this.template=G}},[s.U.Logo]:new class y extends a{constructor(G=!0){super(),this.isHyperLink=G}},[s.U.Media]:new class i extends a{constructor(G=c.Y.Full,k=t.Q.Hide){super(k),this.template=G,this.status=k}},[s.U.NodeInfo]:new a(t.Q.Hide,!1),[s.U.NodeAudio]:new a,[s.U.Playthrough]:new a(t.Q.Hide,!1),[s.U.Pagination]:new a,[s.U.QuizPrompt]:new a,[s.U.Search]:new a,[s.U.TitleOnly]:new a,[s.U.ToggleLabels]:new a,[s.U.Toolbar]:new a,[s.U.ToolbarOverflow]:new a(t.Q.Show,!1),[s.U.Tools]:new a,[s.U.Tutorial]:new a(t.Q.Hide,!1),[s.U.Undo]:new a,[s.U.VisibilityLayers]:new class o extends a{constructor(G=S.Z.Single){super(),this.layersMode=G}},[s.U.SkinLayers]:new a(t.Q.Show,!0),[s.U.Whiteboard]:new a};class C{}const b={visible:{[s.U.Audio]:!1,[s.U.AnatomyLabels]:!1,[s.U.Camera]:!1,[s.U.Column]:!1,[s.U.ColumnToggle]:!1,[s.U.ContextActions]:!1,[s.U.Description]:!1,[s.U.Drawer]:!1,[s.U.DrawerToggle]:!1,[s.U.Fullscreen]:!1,[s.U.Help]:!1,[s.U.Labels]:!1,[s.U.LabelList]:!1,[s.U.Legend]:!1,[s.U.Logo]:!1,[s.U.Media]:!1,[s.U.ToolbarOverflow]:!1,[s.U.NodeInfo]:!1,[s.U.NodeAudio]:!1,[s.U.Pagination]:!1,[s.U.Playthrough]:!1,[s.U.QuizPrompt]:!1,[s.U.Search]:!1,[s.U.ToggleLabels]:!1,[s.U.TitleOnly]:!1,[s.U.Toolbar]:!1,[s.U.Tools]:!1,[s.U.Tutorial]:!1,[s.U.Undo]:!1,[s.U.VisibilityLayers]:!1,[s.U.SkinLayers]:!1,[s.U.Whiteboard]:!1},ui:m,initialUI:m};let R=class Bs{static#e=l=this;static getVisible(G){return(0,e.Mz)([l],k=>k.visible[G])}static getUIEntry(G){return(0,e.Mz)([l],k=>k.ui[G])}static getSearchStatus(G){return G.ui.search.status}static getUI(G){return G.ui}static getInitialUI(G){return G.initialUI}toggleVisible(G,k){const V=G.getState().visible;Object.entries(k.settings).forEach(([W,T])=>{V[W]=T}),G.patchState({visible:V})}setUI(G,k){G.patchState({ui:(0,d.cloneDeep)({...G.getState().ui,...k.ui})})}setInitialUI(G,k){G.patchState({initialUI:(0,d.cloneDeep)({...G.getState().ui,...k.ui})})}static#t=this.\u0275fac=function(k){return new(k||Bs)};static#n=this.\u0275prov=r.jDH({token:Bs,factory:Bs.\u0275fac})};_([(0,e.rc)(v.p.ToggleVisible),u("design:type",Function),u("design:paramtypes",[Object,v.p.ToggleVisible]),u("design:returntype",void 0)],R.prototype,"toggleVisible",null),_([(0,e.rc)(v.p.SetUI),u("design:type",Function),u("design:paramtypes",[Object,v.p.SetUI]),u("design:returntype",void 0)],R.prototype,"setUI",null),_([(0,e.rc)(v.p.SetInitialUI),u("design:type",Function),u("design:paramtypes",[Object,v.p.SetInitialUI]),u("design:returntype",void 0)],R.prototype,"setInitialUI",null),_([(0,e.MD)(),u("design:type",Function),u("design:paramtypes",[C]),u("design:returntype",void 0)],R,"getSearchStatus",null),_([(0,e.MD)(),u("design:type",Function),u("design:paramtypes",[C]),u("design:returntype",void 0)],R,"getUI",null),_([(0,e.MD)(),u("design:type",Function),u("design:paramtypes",[C]),u("design:returntype",void 0)],R,"getInitialUI",null),R=l=_([(0,e.Uw)({name:"viewUI",defaults:b})],R)},93132:(le,N,n)=>{"use strict";n.d(N,{B:()=>t});var t,s,e=n(39898);(s=t||(t={})).SetAutoplay=(()=>{class X{static#e=this.type="[View] Set Autoplay";constructor(Y){this.autoplay=Y}}return X})(),s.SetContentMode=(()=>{class X{static#e=this.type="[View] Set Content Mode";constructor(Y){this.column=Y}}return X})(),s.SetCanHover=(()=>{class X{static#e=this.type="[View] Set Can Hover";constructor(Y){this.canHover=Y}}return X})(),s.SetCanTouch=(()=>{class X{static#e=this.type="[View] Set Can Touch";constructor(Y){this.canTouch=Y}}return X})(),s.SetCanFullscreen=(()=>{class X{static#e=this.type="[View] Set Can Fullscreen";constructor(Y){this.canFullscreen=Y}}return X})(),s.SetInputEnabled=(()=>{class X{static#e=this.type="[View] Set Input Enabled";constructor(Y){this.enabled=Y}}return X})(),s.SetSearchDisplayMode=(()=>{class X{static#e=this.type="[View] Set Search Display Mode";constructor(Y){this.mode=Y}}return X})(),s.TogglePresentation=(()=>{class X{static#e=this.type="[View] Toggle Presentation";constructor(Y){this.active=Y}}return X})(),s.SetInteractType=(()=>{class X{static#e=this.type="[View] Set Interact Type";constructor(Y){this.interactType=Y}}return X})(),s.SetForceAudio=(()=>{class X{static#e=this.type="[View] Set Force Audio";constructor(Y){this.forceAudio=Y}}return X})(),s.SetOnDemand=(()=>{class X{static#e=this.type="[View] Set On Demand";constructor(Y){this.onDemand=Y}}return X})(),s.SetLayout=(()=>{class X{static#e=this.type="[View] Set Layout";constructor(Y){this.layout=Y}}return X})(),s.ToggleHelpTab=(()=>{class X{static#e=this.type="[View] Toggle Help Tab";constructor(Y=e.J.Basics){this.tab=Y}}return X})(),s.SetInputMode=(()=>{class X{static#e=this.type="[View] Set Input Mode";constructor(Y){this.inputMode=Y}}return X})(),s.SetTutorial=(()=>{class X{static#e=this.type="[View] Set Tutorial";constructor(Y){this.tutorial=Y}}return X})(),s.SetIsMobileWeb=(()=>{class X{static#e=this.type="[View] Set Is Mobile Web";constructor(Y){this.isMobileWeb=Y}}return X})(),s.StartTutorial=(()=>{class X{static#e=this.type="[View] Start Tutorial";constructor(Y){this.intro=Y}}return X})(),s.TutorialSeen=(()=>{class X{static#e=this.type="[View] Tutorial Seen";constructor(Y){this.seen=Y}}return X})(),s.TutorialNext=(()=>{class X{static#e=this.type="[View] Tutorial Next";constructor(){}}return X})(),s.TutorialPrevious=(()=>{class X{static#e=this.type="[View] Tutorial Previous";constructor(){}}return X})(),s.ToggleNodeInfo=(()=>{class X{static#e=this.type="[View] Toggle Node Info";constructor(Y){this.show=Y}}return X})(),s.TogglePanel=(()=>{class X{static#e=this.type="[View] Toggle Panel";constructor(Y,he){this.panel=Y,this.show=he}}return X})(),s.SetViewLanguage=(()=>{class X{static#e=this.type="[View] Set View Language";constructor(Y){this.lang=Y}}return X})(),s.SetNodeInfoConfig=(()=>{class X{static#e=this.type="[View] Set Node Info Config";constructor(Y){this.fallback=Y}}return X})(),s.SetMultiPickModeEnabled=(()=>{class X{static#e=this.type="[View] Set multi pick mode enabled";constructor(Y){this.enabled=Y}}return X})(),s.SetLabelBreakpoint=(()=>{class X{static#e=this.type="[View] Set Label Breakpoint";constructor(Y){this.labelsBreakpoint=Y}}return X})(),s.SetPlaythrough=(()=>{class X{static#e=this.type="[View] Set Playthrough";constructor(Y){this.playthrough=Y}}return X})(),s.SetPlaythroughEnabled=(()=>{class X{static#e=this.type="[View] Set Playthrough Enabled";constructor(Y){this.enabled=Y}}return X})(),s.SetStartingColumn=(()=>{class X{static#e=this.type="[View] Set Starting Column";constructor(Y){this.column=Y}}return X})(),s.SetPreferredColumn=(()=>{class X{static#e=this.type="[View] Set Preferred Column";constructor(Y){this.column=Y}}return X})(),s.SetStartingTool=(()=>{class X{static#e=this.type="[View] Set Starting Tool";constructor(Y){this.tool=Y}}return X})(),s.SetFadeout=(()=>{class X{static#e=this.type="[View] Set Fadeout";constructor(Y){this.fadeout=Y}}return X})(),s.SetPreventFadeoutEvent=(()=>{class X{static#e=this.type="[View] Set Prevent Fadeout Event";constructor(Y,he){this.event=Y,this.value=he}}return X})(),s.SetUsePrintImage=(()=>{class X{static#e=this.type="[View] Set Use Print Image";constructor(Y){this.usePrintImage=Y}}return X})(),s.SetWindows=(()=>{class X{static#e=this.type="[View] Set Windows";constructor(Y){this.windows=Y}}return X})(),s.OpenWindow=(()=>{class X{static#e=this.type="[View] Open Window";constructor(Y){this.window=Y}}return X})(),s.CloseWindow=(()=>{class X{static#e=this.type="[View] Close Window";constructor(Y){this.window=Y}}return X})(),s.ToggleWindow=(()=>{class X{static#e=this.type="[View] Toggle Window";constructor(Y,he){this.window=Y,this.show=he}}return X})(),s.ToggleMenu=(()=>{class X{static#e=this.type="[View] Toggle Menu";constructor(Y){this.open=Y}}return X})(),s.SetWhiteboardEnabled=(()=>{class X{static#e=this.type="[View] Whiteboard Enabled";constructor(Y){this.enabled=Y}}return X})(),s.SetWhiteboardLocked=(()=>{class X{static#e=this.type="[View] Whiteboard locked";constructor(Y){this.locked=Y}}return X})(),s.SetWhiteboardBrushSize=(()=>{class X{static#e=this.type="[View] Whiteboard Brush Size";constructor(Y){this.brushSize=Y}}return X})(),s.SetWhiteboardBrushColor=(()=>{class X{static#e=this.type="[View] Whiteboard Brush Color";constructor(Y){this.brushColor=Y}}return X})(),s.SetWhiteboardTextSize=(()=>{class X{static#e=this.type="[View] Whiteboard Text Size";constructor(Y){this.size=Y}}return X})(),s.SetWhiteboardEraserSize=(()=>{class X{static#e=this.type="[View] Whiteboard Eraser Size";constructor(Y){this.eraserSize=Y}}return X})(),s.SetWhiteboardAnnotateMode=(()=>{class X{static#e=this.type="[View] Whiteboard Annotate Mode";constructor(Y){this.mode=Y}}return X})(),s.SetWhiteboardHasPaint=(()=>{class X{static#e=this.type="[View] Whiteboard Has Paint";constructor(Y){this.hasPaint=Y}}return X})(),s.SetWhiteboardHasText=(()=>{class X{static#e=this.type="[View] Whiteboard Has Text";constructor(Y){this.hasText=Y}}return X})(),s.ShowScrim=(()=>{class X{static#e=this.type="[View] Show Scrim";constructor(Y,he){this.showSpinner=Y,this.label=he}}return X})(),s.HideScrim=(()=>{class X{static#e=this.type="[View] Hide Scrim";constructor(){}}return X})(),s.SetChapterCallToActionSeen=(()=>{class X{static#e=this.type="[View] Set Chapter Call To Action Seen";constructor(Y){this.chapterCallToActionSeen=Y}}return X})(),s.ResetViewState=(()=>{class X{static#e=this.type="[View] Reset View State";constructor(){}}return X})()},26463:(le,N,n)=>{"use strict";n.d(N,{Pf:()=>m});var _,e=n(92014),t=n(93132),s=n(87947),c=n(65855),O=n(17276),P=n(39898),S=n(55671),a=n(46107),f=n(47932),E=n(3057),y=n(17215),i=n(79083),g=n(18272),p=n(51529),o=n(49204),v=n(54438),d=function(C,b,R,A){var V,G=arguments.length,k=G<3?b:null===A?A=Object.getOwnPropertyDescriptor(b,R):A;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)k=Reflect.decorate(C,b,R,A);else for(var W=C.length-1;W>=0;W--)(V=C[W])&&(k=(G<3?V(k):G>3?V(b,R,k):V(b,R))||k);return G>3&&k&&Object.defineProperty(b,R,k),k},r=function(C,b){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(C,b)};class u{}const l={autoplay:!1,contentMode:p.G.ChapterInfo,lang:"en",canFullscreen:!1,canHover:!1,canTouch:!1,drawerCoversContent:!1,fadeout:3e3,preventFadeoutEvents:{mouseenter:!1,focusin:!1,overlay:!1},forceAudio:!1,fullscreenActive:!1,help:{tab:P.J.Basics},inputEnabled:!0,inputMode:f.A.Mouse,interactType:c.i.Play,isMobileWeb:!1,onDemand:!1,layout:E.o.Default,labelsBreakpoint:480,menuOpen:!1,multiPickModeEnabled:!1,openWindows:[O.U.Loader],toggledPanels:new Map,playthroughSettings:{enabled:!1,countdown:3e3,countdownDelay:2e3,forceAudio:!0,loop:!1,minimum:1e4},presentationActive:!1,searchDisplayMode:g.q.List,startingColumn:"info",preferredColumn:null,startingTool:null,nodeInfo:{show:!1,fallback:i.H.Wikipedia},tutorial:{pageSize:0,pageIndex:-1},tutorialSeen:!0,usePrintImage:!1,whiteboard:{enabled:!1,locked:!1,hasPaint:!1,hasText:!1,brushSize:a.iw.size,brushColor:a._T.color,textSize:a.H6.size,eraserSize:a.Om.size,annotateMode:S.D.Paint},scrim:{show:!1,label:""},chapterCallToActionSeen:!1};let m=class ks{static#e=_=this;static getAutoplay(b){return b.autoplay}static getContentMode(b){return b.contentMode}static getLabelsBreakpoint(b){return b.labelsBreakpoint}static getInputEnabled(b){return b.inputEnabled}static getIsMobileWeb(b){return b.isMobileWeb}static getFullscreenActive(b){return b.fullscreenActive}static getPresentationActive(b){return b.presentationActive}static getDrawerCoversContent(b){return b.drawerCoversContent}static getShowNodeInfo(b){return b.nodeInfo.show}static getNodeInfoFallback(b){return b.nodeInfo.fallback}static getToggledPanels(b){return b.toggledPanels}static getViewLanguage(b){return b.lang}static getInteractType(b){return b.interactType}static getForceAudio(b){return b.forceAudio}static getOnDemand(b){return b.onDemand}static getFadeout(b){return b.fadeout}static getFadeoutPaused(b){return b.preventFadeoutEvents.mouseenter||b.preventFadeoutEvents.focusin||b.preventFadeoutEvents.overlay}static getPlaythroughSettings(b){return b.playthroughSettings}static getPlaythroughEnabled(b){return b.playthroughSettings.enabled}static getPreferredColumn(b){return b.preferredColumn}static getStartingColumn(b){return b.startingColumn}static getStartingTool(b){return b.startingTool}static getLayout(b){return b.layout}static getInputMode(b){return b.inputMode}static getShowHelpTab(b){return b.help.tab}static getTutorial(b){return b.tutorial}static getTutorialSeen(b){return b.tutorialSeen}static getWhiteboardEnabled(b){return b.whiteboard.enabled}static isWhiteboardLocked(b){return b.whiteboard.locked}static getWhiteboardBrushSize(b){return b.whiteboard.brushSize}static getWhiteboardTextSize(b){return b.whiteboard.textSize}static getWhiteboardEraserSize(b){return b.whiteboard.eraserSize}static getWhiteboardAnnotateMode(b){return b.whiteboard.annotateMode}static getWhiteboardBrushColor(b){return b.whiteboard.brushColor}static getWhiteboardHasPaint(b){return b.whiteboard.hasPaint}static getWhiteboardHasText(b){return b.whiteboard.hasText}static getCanTouch(b){return b.canTouch}static getCanHover(b){return b.canHover}static getMultiPickModeEnabled(b){return b.multiPickModeEnabled}static getSearchDisplayMode(b){return b.searchDisplayMode}static getUsePrintImage(b){return b.usePrintImage}static getOpenWindow(b){return b.openWindows.length>0?b.openWindows.sort()[0]:null}static getMenuOpen(b){return b.menuOpen}static getScrim(b){return b.scrim}static getChapterCallToActionSeen(b){return b.chapterCallToActionSeen}static shouldWindowOpen(b){return(0,e.Mz)([_],R=>R.openWindows.indexOf(b)>=0)}setAutoplay(b,R){b.patchState({autoplay:R.autoplay})}setContentMode(b,R){b.patchState({contentMode:R.column})}setInputEnabled(b,R){b.patchState({inputEnabled:R.enabled})}setCanHover(b,R){b.patchState({canHover:R.canHover})}setCanTouch(b,R){b.patchState({canTouch:R.canTouch})}setCanFullscreen(b,R){b.patchState({canFullscreen:R.canFullscreen})}setSearchDisplayMode(b,R){b.patchState({searchDisplayMode:R.mode})}setViewLanguage(b,{lang:R}){b.patchState({lang:R})}toggleNodeInfo(b,{show:R}){b.patchState({nodeInfo:{...b.getState().nodeInfo,show:R}})}setNodeInfoConfig(b,{fallback:R}){b.patchState({nodeInfo:{...b.getState().nodeInfo,fallback:R}})}togglePanel(b,R){const A=b.getState().toggledPanels;A.set(R.panel,R.show),b.patchState({toggledPanels:A})}togglePresentation(b,R){b.patchState({presentationActive:R.active})}toggleHelp(b,R){b.patchState({help:{tab:R.tab}})}setFadeout(b,R){b.patchState({fadeout:R.fadeout})}addPreventFadeoutElement(b,R){const A=b.getState().preventFadeoutEvents;A[R.event]=R.value,b.patchState({preventFadeoutEvents:{...A}})}setPlaythrough(b,R){const A=b.getState().playthroughSettings;(0,o.mergeWith)(A,R.playthrough,(G,k)=>{if(!(0,o.isNil)(k))return k}),b.patchState({playthroughSettings:A})}setPlaythroughEnabled(b,R){let A=b.getState().playthroughSettings;A={...A,enabled:R.enabled},b.patchState({playthroughSettings:A})}setStartingColumn(b,R){b.patchState({startingColumn:R.column})}setPreferredColumn(b,R){b.patchState({preferredColumn:R.column})}setStartingTool(b,R){b.patchState({startingTool:R.tool})}setLoaderType(b,R){b.patchState({interactType:R.interactType})}setForceAudio(b,R){b.patchState({forceAudio:R.forceAudio})}setOnDemand(b,R){b.patchState({onDemand:R.onDemand})}setInputMode(b,{inputMode:R}){b.patchState({inputMode:R})}SetLayout(b,R){b.patchState({layout:R.layout})}setTutorial(b,R){const A=b.getState().tutorial;b.patchState({tutorial:{...A,...R.tutorial}})}startTutorial(b,R){b.patchState({tutorial:{...b.getState().tutorial,pageIndex:R.intro?-1:0}}),b.dispatch(new t.B.TutorialSeen(!0))}tutorialSeen(b,R){this.storageService.setLocalItem(y.UT.GettingStartedTutorial,R.seen),b.patchState({tutorialSeen:R.seen})}tutorialPrevious(b,R){const A=b.getState().tutorial,G=Math.max(A.pageIndex-1,0);b.dispatch(new t.B.SetTutorial({...A,pageIndex:G}))}tutorialNext(b,R){const A=b.getState().tutorial,G=Math.min(A.pageIndex+1,A.pageSize-1);b.dispatch(new t.B.SetTutorial({...A,pageIndex:G}))}setWhiteboardEnabled(b,{enabled:R}){b.patchState({whiteboard:{...b.getState().whiteboard,enabled:R}})}setWhiteboardLocked(b,{locked:R}){b.patchState({whiteboard:{...b.getState().whiteboard,locked:R}})}setWhiteboardBrushSize(b,{brushSize:R}){b.patchState({whiteboard:{...b.getState().whiteboard,brushSize:R}})}setWhiteboardTextSize(b,{size:R}){b.patchState({whiteboard:{...b.getState().whiteboard,textSize:R}})}setWhiteboardEraserSize(b,{eraserSize:R}){b.patchState({whiteboard:{...b.getState().whiteboard,eraserSize:R}})}setWhiteboardAnnotateMode(b,{mode:R}){b.patchState({whiteboard:{...b.getState().whiteboard,annotateMode:R}})}setWhiteboardBrushColor(b,{brushColor:R}){b.patchState({whiteboard:{...b.getState().whiteboard,brushColor:R}})}setWhiteboardHasPaint(b,{hasPaint:R}){b.patchState({whiteboard:{...b.getState().whiteboard,hasPaint:R}})}setWhiteboardHasText(b,{hasText:R}){b.patchState({whiteboard:{...b.getState().whiteboard,hasText:R}})}setMultiPickModeEnabled(b,R){b.patchState({multiPickModeEnabled:R.enabled})}setLabelBreakpoint(b,R){b.patchState({labelsBreakpoint:R.labelsBreakpoint})}setUsePrintImage(b,R){b.patchState({usePrintImage:R.usePrintImage})}setWindows(b,R){b.patchState({openWindows:R.windows})}setIsMobileWeb(b,R){b.patchState({isMobileWeb:R.isMobileWeb})}openWindow(b,R){const A=b.getState().openWindows;A.indexOf(R.window)<0&&b.patchState({openWindows:[R.window,...A]})}closeWindow(b,R){let A=b.getState().openWindows;null!=R.window?A=A.filter(G=>G!==R.window):A.shift(),b.patchState({openWindows:[...A]})}toggleWindow(b,R){const A=b.getState().openWindows.indexOf(R.window)>=0;b.dispatch((null!=R.show?R.show:!A)?new t.B.OpenWindow(R.window):new t.B.CloseWindow(R.window))}toggleMenu(b,R){b.patchState({menuOpen:R.open})}showScrim(b,R){b.patchState({scrim:{show:!0,label:R.label}})}hideScrim(b,R){b.patchState({scrim:{show:!1,label:""}})}setChapterCallToActionSeen(b,R){b.patchState({chapterCallToActionSeen:R.chapterCallToActionSeen})}ResetViewState(b,R){b.setState({...l})}constructor(b){this.storageService=b}ngxsOnInit(b){s.g.onFullscreenChange().subscribe(R=>{b.patchState({fullscreenActive:R})}),b.patchState({tutorialSeen:this.storageService.getLocalJSON(y.UT.GettingStartedTutorial)||!1})}static#t=this.\u0275fac=function(R){return new(R||ks)(v.KVO(y.n$))};static#n=this.\u0275prov=v.jDH({token:ks,factory:ks.\u0275fac})};d([(0,e.rc)(t.B.SetAutoplay),r("design:type",Function),r("design:paramtypes",[Object,t.B.SetAutoplay]),r("design:returntype",void 0)],m.prototype,"setAutoplay",null),d([(0,e.rc)(t.B.SetContentMode),r("design:type",Function),r("design:paramtypes",[Object,t.B.SetContentMode]),r("design:returntype",void 0)],m.prototype,"setContentMode",null),d([(0,e.rc)(t.B.SetInputEnabled),r("design:type",Function),r("design:paramtypes",[Object,t.B.SetInputEnabled]),r("design:returntype",void 0)],m.prototype,"setInputEnabled",null),d([(0,e.rc)(t.B.SetCanHover),r("design:type",Function),r("design:paramtypes",[Object,t.B.SetCanHover]),r("design:returntype",void 0)],m.prototype,"setCanHover",null),d([(0,e.rc)(t.B.SetCanTouch),r("design:type",Function),r("design:paramtypes",[Object,t.B.SetCanTouch]),r("design:returntype",void 0)],m.prototype,"setCanTouch",null),d([(0,e.rc)(t.B.SetCanFullscreen),r("design:type",Function),r("design:paramtypes",[Object,t.B.SetCanFullscreen]),r("design:returntype",void 0)],m.prototype,"setCanFullscreen",null),d([(0,e.rc)(t.B.SetSearchDisplayMode),r("design:type",Function),r("design:paramtypes",[Object,t.B.SetSearchDisplayMode]),r("design:returntype",void 0)],m.prototype,"setSearchDisplayMode",null),d([(0,e.rc)(t.B.SetViewLanguage),r("design:type",Function),r("design:paramtypes",[Object,t.B.SetViewLanguage]),r("design:returntype",void 0)],m.prototype,"setViewLanguage",null),d([(0,e.rc)(t.B.ToggleNodeInfo),r("design:type",Function),r("design:paramtypes",[Object,t.B.ToggleNodeInfo]),r("design:returntype",void 0)],m.prototype,"toggleNodeInfo",null),d([(0,e.rc)(t.B.SetNodeInfoConfig),r("design:type",Function),r("design:paramtypes",[Object,t.B.SetNodeInfoConfig]),r("design:returntype",void 0)],m.prototype,"setNodeInfoConfig",null),d([(0,e.rc)(t.B.TogglePanel),r("design:type",Function),r("design:paramtypes",[Object,t.B.TogglePanel]),r("design:returntype",void 0)],m.prototype,"togglePanel",null),d([(0,e.rc)(t.B.TogglePresentation),r("design:type",Function),r("design:paramtypes",[Object,t.B.TogglePresentation]),r("design:returntype",void 0)],m.prototype,"togglePresentation",null),d([(0,e.rc)(t.B.ToggleHelpTab),r("design:type",Function),r("design:paramtypes",[Object,t.B.ToggleHelpTab]),r("design:returntype",void 0)],m.prototype,"toggleHelp",null),d([(0,e.rc)(t.B.SetFadeout),r("design:type",Function),r("design:paramtypes",[Object,t.B.SetFadeout]),r("design:returntype",void 0)],m.prototype,"setFadeout",null),d([(0,e.rc)(t.B.SetPreventFadeoutEvent),r("design:type",Function),r("design:paramtypes",[Object,t.B.SetPreventFadeoutEvent]),r("design:returntype",void 0)],m.prototype,"addPreventFadeoutElement",null),d([(0,e.rc)(t.B.SetPlaythrough),r("design:type",Function),r("design:paramtypes",[Object,t.B.SetPlaythrough]),r("design:returntype",void 0)],m.prototype,"setPlaythrough",null),d([(0,e.rc)(t.B.SetPlaythroughEnabled),r("design:type",Function),r("design:paramtypes",[Object,t.B.SetPlaythroughEnabled]),r("design:returntype",void 0)],m.prototype,"setPlaythroughEnabled",null),d([(0,e.rc)(t.B.SetStartingColumn),r("design:type",Function),r("design:paramtypes",[Object,t.B.SetStartingColumn]),r("design:returntype",void 0)],m.prototype,"setStartingColumn",null),d([(0,e.rc)(t.B.SetPreferredColumn),r("design:type",Function),r("design:paramtypes",[Object,t.B.SetPreferredColumn]),r("design:returntype",void 0)],m.prototype,"setPreferredColumn",null),d([(0,e.rc)(t.B.SetStartingTool),r("design:type",Function),r("design:paramtypes",[Object,t.B.SetStartingTool]),r("design:returntype",void 0)],m.prototype,"setStartingTool",null),d([(0,e.rc)(t.B.SetInteractType),r("design:type",Function),r("design:paramtypes",[Object,t.B.SetInteractType]),r("design:returntype",void 0)],m.prototype,"setLoaderType",null),d([(0,e.rc)(t.B.SetForceAudio),r("design:type",Function),r("design:paramtypes",[Object,t.B.SetForceAudio]),r("design:returntype",void 0)],m.prototype,"setForceAudio",null),d([(0,e.rc)(t.B.SetOnDemand),r("design:type",Function),r("design:paramtypes",[Object,t.B.SetOnDemand]),r("design:returntype",void 0)],m.prototype,"setOnDemand",null),d([(0,e.rc)(t.B.SetInputMode),r("design:type",Function),r("design:paramtypes",[Object,t.B.SetInputMode]),r("design:returntype",void 0)],m.prototype,"setInputMode",null),d([(0,e.rc)(t.B.SetLayout),r("design:type",Function),r("design:paramtypes",[Object,t.B.SetLayout]),r("design:returntype",void 0)],m.prototype,"SetLayout",null),d([(0,e.rc)(t.B.SetTutorial),r("design:type",Function),r("design:paramtypes",[Object,t.B.SetTutorial]),r("design:returntype",void 0)],m.prototype,"setTutorial",null),d([(0,e.rc)(t.B.StartTutorial),r("design:type",Function),r("design:paramtypes",[Object,t.B.StartTutorial]),r("design:returntype",void 0)],m.prototype,"startTutorial",null),d([(0,e.rc)(t.B.TutorialSeen),r("design:type",Function),r("design:paramtypes",[Object,t.B.TutorialSeen]),r("design:returntype",void 0)],m.prototype,"tutorialSeen",null),d([(0,e.rc)(t.B.TutorialPrevious),r("design:type",Function),r("design:paramtypes",[Object,t.B.TutorialPrevious]),r("design:returntype",void 0)],m.prototype,"tutorialPrevious",null),d([(0,e.rc)(t.B.TutorialNext),r("design:type",Function),r("design:paramtypes",[Object,t.B.TutorialNext]),r("design:returntype",void 0)],m.prototype,"tutorialNext",null),d([(0,e.rc)(t.B.SetWhiteboardEnabled),r("design:type",Function),r("design:paramtypes",[Object,t.B.SetWhiteboardEnabled]),r("design:returntype",void 0)],m.prototype,"setWhiteboardEnabled",null),d([(0,e.rc)(t.B.SetWhiteboardLocked),r("design:type",Function),r("design:paramtypes",[Object,t.B.SetWhiteboardLocked]),r("design:returntype",void 0)],m.prototype,"setWhiteboardLocked",null),d([(0,e.rc)(t.B.SetWhiteboardBrushSize),r("design:type",Function),r("design:paramtypes",[Object,t.B.SetWhiteboardBrushSize]),r("design:returntype",void 0)],m.prototype,"setWhiteboardBrushSize",null),d([(0,e.rc)(t.B.SetWhiteboardTextSize),r("design:type",Function),r("design:paramtypes",[Object,t.B.SetWhiteboardTextSize]),r("design:returntype",void 0)],m.prototype,"setWhiteboardTextSize",null),d([(0,e.rc)(t.B.SetWhiteboardEraserSize),r("design:type",Function),r("design:paramtypes",[Object,t.B.SetWhiteboardEraserSize]),r("design:returntype",void 0)],m.prototype,"setWhiteboardEraserSize",null),d([(0,e.rc)(t.B.SetWhiteboardAnnotateMode),r("design:type",Function),r("design:paramtypes",[Object,t.B.SetWhiteboardAnnotateMode]),r("design:returntype",void 0)],m.prototype,"setWhiteboardAnnotateMode",null),d([(0,e.rc)(t.B.SetWhiteboardBrushColor),r("design:type",Function),r("design:paramtypes",[Object,t.B.SetWhiteboardBrushColor]),r("design:returntype",void 0)],m.prototype,"setWhiteboardBrushColor",null),d([(0,e.rc)(t.B.SetWhiteboardHasPaint),r("design:type",Function),r("design:paramtypes",[Object,t.B.SetWhiteboardHasPaint]),r("design:returntype",void 0)],m.prototype,"setWhiteboardHasPaint",null),d([(0,e.rc)(t.B.SetWhiteboardHasText),r("design:type",Function),r("design:paramtypes",[Object,t.B.SetWhiteboardHasText]),r("design:returntype",void 0)],m.prototype,"setWhiteboardHasText",null),d([(0,e.rc)(t.B.SetMultiPickModeEnabled),r("design:type",Function),r("design:paramtypes",[Object,t.B.SetMultiPickModeEnabled]),r("design:returntype",void 0)],m.prototype,"setMultiPickModeEnabled",null),d([(0,e.rc)(t.B.SetLabelBreakpoint),r("design:type",Function),r("design:paramtypes",[Object,t.B.SetLabelBreakpoint]),r("design:returntype",void 0)],m.prototype,"setLabelBreakpoint",null),d([(0,e.rc)(t.B.SetUsePrintImage),r("design:type",Function),r("design:paramtypes",[Object,t.B.SetUsePrintImage]),r("design:returntype",void 0)],m.prototype,"setUsePrintImage",null),d([(0,e.rc)(t.B.SetWindows),r("design:type",Function),r("design:paramtypes",[Object,t.B.SetWindows]),r("design:returntype",void 0)],m.prototype,"setWindows",null),d([(0,e.rc)(t.B.SetIsMobileWeb),r("design:type",Function),r("design:paramtypes",[Object,t.B.SetIsMobileWeb]),r("design:returntype",void 0)],m.prototype,"setIsMobileWeb",null),d([(0,e.rc)(t.B.OpenWindow),r("design:type",Function),r("design:paramtypes",[Object,t.B.OpenWindow]),r("design:returntype",void 0)],m.prototype,"openWindow",null),d([(0,e.rc)(t.B.CloseWindow),r("design:type",Function),r("design:paramtypes",[Object,t.B.CloseWindow]),r("design:returntype",void 0)],m.prototype,"closeWindow",null),d([(0,e.rc)(t.B.ToggleWindow),r("design:type",Function),r("design:paramtypes",[Object,t.B.ToggleWindow]),r("design:returntype",void 0)],m.prototype,"toggleWindow",null),d([(0,e.rc)(t.B.ToggleMenu),r("design:type",Function),r("design:paramtypes",[Object,t.B.ToggleMenu]),r("design:returntype",void 0)],m.prototype,"toggleMenu",null),d([(0,e.rc)(t.B.ShowScrim),r("design:type",Function),r("design:paramtypes",[Object,t.B.ShowScrim]),r("design:returntype",void 0)],m.prototype,"showScrim",null),d([(0,e.rc)(t.B.HideScrim),r("design:type",Function),r("design:paramtypes",[Object,t.B.HideScrim]),r("design:returntype",void 0)],m.prototype,"hideScrim",null),d([(0,e.rc)(t.B.SetChapterCallToActionSeen),r("design:type",Function),r("design:paramtypes",[Object,t.B.SetChapterCallToActionSeen]),r("design:returntype",void 0)],m.prototype,"setChapterCallToActionSeen",null),d([(0,e.rc)(t.B.ResetViewState),r("design:type",Function),r("design:paramtypes",[Object,t.B.ResetViewState]),r("design:returntype",void 0)],m.prototype,"ResetViewState",null),d([(0,e.MD)(),r("design:type",Function),r("design:paramtypes",[u]),r("design:returntype",void 0)],m,"getAutoplay",null),d([(0,e.MD)(),r("design:type",Function),r("design:paramtypes",[u]),r("design:returntype",void 0)],m,"getContentMode",null),d([(0,e.MD)(),r("design:type",Function),r("design:paramtypes",[u]),r("design:returntype",void 0)],m,"getLabelsBreakpoint",null),d([(0,e.MD)(),r("design:type",Function),r("design:paramtypes",[u]),r("design:returntype",void 0)],m,"getInputEnabled",null),d([(0,e.MD)(),r("design:type",Function),r("design:paramtypes",[u]),r("design:returntype",void 0)],m,"getIsMobileWeb",null),d([(0,e.MD)(),r("design:type",Function),r("design:paramtypes",[u]),r("design:returntype",void 0)],m,"getFullscreenActive",null),d([(0,e.MD)(),r("design:type",Function),r("design:paramtypes",[u]),r("design:returntype",void 0)],m,"getPresentationActive",null),d([(0,e.MD)(),r("design:type",Function),r("design:paramtypes",[u]),r("design:returntype",void 0)],m,"getDrawerCoversContent",null),d([(0,e.MD)(),r("design:type",Function),r("design:paramtypes",[u]),r("design:returntype",void 0)],m,"getShowNodeInfo",null),d([(0,e.MD)(),r("design:type",Function),r("design:paramtypes",[u]),r("design:returntype",void 0)],m,"getNodeInfoFallback",null),d([(0,e.MD)(),r("design:type",Function),r("design:paramtypes",[u]),r("design:returntype",void 0)],m,"getToggledPanels",null),d([(0,e.MD)(),r("design:type",Function),r("design:paramtypes",[u]),r("design:returntype",void 0)],m,"getViewLanguage",null),d([(0,e.MD)(),r("design:type",Function),r("design:paramtypes",[u]),r("design:returntype",void 0)],m,"getInteractType",null),d([(0,e.MD)(),r("design:type",Function),r("design:paramtypes",[u]),r("design:returntype",void 0)],m,"getForceAudio",null),d([(0,e.MD)(),r("design:type",Function),r("design:paramtypes",[u]),r("design:returntype",void 0)],m,"getOnDemand",null),d([(0,e.MD)(),r("design:type",Function),r("design:paramtypes",[u]),r("design:returntype",void 0)],m,"getFadeout",null),d([(0,e.MD)(),r("design:type",Function),r("design:paramtypes",[u]),r("design:returntype",void 0)],m,"getFadeoutPaused",null),d([(0,e.MD)(),r("design:type",Function),r("design:paramtypes",[u]),r("design:returntype",void 0)],m,"getPlaythroughSettings",null),d([(0,e.MD)(),r("design:type",Function),r("design:paramtypes",[u]),r("design:returntype",void 0)],m,"getPlaythroughEnabled",null),d([(0,e.MD)(),r("design:type",Function),r("design:paramtypes",[u]),r("design:returntype",void 0)],m,"getPreferredColumn",null),d([(0,e.MD)(),r("design:type",Function),r("design:paramtypes",[u]),r("design:returntype",void 0)],m,"getStartingColumn",null),d([(0,e.MD)(),r("design:type",Function),r("design:paramtypes",[u]),r("design:returntype",void 0)],m,"getStartingTool",null),d([(0,e.MD)(),r("design:type",Function),r("design:paramtypes",[u]),r("design:returntype",void 0)],m,"getLayout",null),d([(0,e.MD)(),r("design:type",Function),r("design:paramtypes",[u]),r("design:returntype",void 0)],m,"getInputMode",null),d([(0,e.MD)(),r("design:type",Function),r("design:paramtypes",[u]),r("design:returntype",void 0)],m,"getShowHelpTab",null),d([(0,e.MD)(),r("design:type",Function),r("design:paramtypes",[u]),r("design:returntype",void 0)],m,"getTutorial",null),d([(0,e.MD)(),r("design:type",Function),r("design:paramtypes",[u]),r("design:returntype",void 0)],m,"getTutorialSeen",null),d([(0,e.MD)(),r("design:type",Function),r("design:paramtypes",[u]),r("design:returntype",void 0)],m,"getWhiteboardEnabled",null),d([(0,e.MD)(),r("design:type",Function),r("design:paramtypes",[u]),r("design:returntype",void 0)],m,"isWhiteboardLocked",null),d([(0,e.MD)(),r("design:type",Function),r("design:paramtypes",[u]),r("design:returntype",void 0)],m,"getWhiteboardBrushSize",null),d([(0,e.MD)(),r("design:type",Function),r("design:paramtypes",[u]),r("design:returntype",void 0)],m,"getWhiteboardTextSize",null),d([(0,e.MD)(),r("design:type",Function),r("design:paramtypes",[u]),r("design:returntype",void 0)],m,"getWhiteboardEraserSize",null),d([(0,e.MD)(),r("design:type",Function),r("design:paramtypes",[u]),r("design:returntype",void 0)],m,"getWhiteboardAnnotateMode",null),d([(0,e.MD)(),r("design:type",Function),r("design:paramtypes",[u]),r("design:returntype",void 0)],m,"getWhiteboardBrushColor",null),d([(0,e.MD)(),r("design:type",Function),r("design:paramtypes",[u]),r("design:returntype",void 0)],m,"getWhiteboardHasPaint",null),d([(0,e.MD)(),r("design:type",Function),r("design:paramtypes",[u]),r("design:returntype",void 0)],m,"getWhiteboardHasText",null),d([(0,e.MD)(),r("design:type",Function),r("design:paramtypes",[u]),r("design:returntype",void 0)],m,"getCanTouch",null),d([(0,e.MD)(),r("design:type",Function),r("design:paramtypes",[u]),r("design:returntype",void 0)],m,"getCanHover",null),d([(0,e.MD)(),r("design:type",Function),r("design:paramtypes",[u]),r("design:returntype",void 0)],m,"getMultiPickModeEnabled",null),d([(0,e.MD)(),r("design:type",Function),r("design:paramtypes",[u]),r("design:returntype",void 0)],m,"getSearchDisplayMode",null),d([(0,e.MD)(),r("design:type",Function),r("design:paramtypes",[u]),r("design:returntype",void 0)],m,"getUsePrintImage",null),d([(0,e.MD)(),r("design:type",Function),r("design:paramtypes",[u]),r("design:returntype",void 0)],m,"getOpenWindow",null),d([(0,e.MD)(),r("design:type",Function),r("design:paramtypes",[u]),r("design:returntype",void 0)],m,"getMenuOpen",null),d([(0,e.MD)(),r("design:type",Function),r("design:paramtypes",[u]),r("design:returntype",void 0)],m,"getScrim",null),d([(0,e.MD)(),r("design:type",Function),r("design:paramtypes",[u]),r("design:returntype",void 0)],m,"getChapterCallToActionSeen",null),m=_=d([(0,e.Uw)({name:"view",defaults:l}),r("design:paramtypes",[y.n$])],m)},34215:(le,N,n)=>{"use strict";n.d(N,{d:()=>T});var e=n(26463),t=n(13181),s=n(93822),c=n(38753),O=n(94495),P=n(49204),a=n(15623),f=n(38104),E=n(17276),y=n(96557),i=n(18171),g=n(3057),p=n(87710),h=n(62949),o=n(82109),v=n(51640),d=n(76304),r=n(51529),_=n(12347),u=n(95419),l=n(45144),m=n(21523),C=n(58832),b=n(32408),R=n(47833),A=n(73987),G=n(22679),k=n(13976),V=n(54438),W=n(92014);let T=(()=>{class x{constructor(I,D,L,Q,ie){this.store=I,this.chapterService=D,this.animationService=L,this.mediaService=Q,this.contentBlocksService=ie,this.ui=null,this.horizontalBreakpoint=null}getBase(){return{ui:this.store.selectSnapshot(v.dF.getUI),layout:this.store.selectSnapshot(e.Pf.getLayout),horizontalBreakpoint:this.store.selectSnapshot(f.V.getHorizontalBreakpoint),canvasHeightBreakpoint:this.store.selectSnapshot(d.S.getCanvasHeightBreakpoint),quizActive:this.store.selectSnapshot(p.j.getQuizModeActive),hideUI:this.isUIHidden()}}isUIHidden(){const I=this.store.selectSnapshot(e.Pf.getOpenWindow),D=this.store.selectSnapshot(O.N.getSelectedChapterIndex),L=this.store.selectSnapshot(v.dF.getUI),Q=I===E.U.Loader&&D<=0&&L.loader.template===y.aD.Circle,ie=this.store.selectSnapshot(o.N.getStoryLoadProgress);return Q||0===ie||I===E.U.OnDemand||I===E.U.Interact||I===E.U.Tutorial||I===E.U.Whiteboard||I===E.U.XRLoader}isDrawerVisible(){const{layout:I,quizActive:D,hideUI:L}=this.getBase();if(L||this.getViewLayout(I)!==h.G.Drawer)return!1;if(D)return!0;const Q=this.store.selectSnapshot(e.Pf.getContentMode);return!(Q===r.G.ChapterInfo&&"full"!==this.getVisibleContent(r.G.ChapterInfo)||Q===r.G.Quiz&&"full"!==this.getVisibleContent(r.G.Quiz)||Q===r.G.LabelInfo&&"none"===this.getVisibleContent(r.G.LabelInfo))&&this.isUIVisible(s.U.Drawer)}isDrawerToggleVisible(){const{ui:I,layout:D,quizActive:L}=this.getBase(),Q=this.getVisibleContent(r.G.ChapterInfo);return this.getViewLayout(D)===h.G.Drawer&&"full"===Q&&!1!==I.drawer.enable&&!L&&this.isUIVisible(s.U.DrawerToggle)}isColumnVisible(){const{layout:I,ui:D}=this.getBase();if(D.column.status===t.Q.Collapse||this.getViewLayout(I)!==h.G.Column)return!1;const L=this.store.selectSnapshot(e.Pf.getContentMode);return!(L===r.G.ChapterInfo&&"full"!==this.getVisibleContent(r.G.ChapterInfo)||L===r.G.Quiz&&"full"!==this.getVisibleContent(r.G.Quiz))&&this.isUIVisible(s.U.Column)}isColumnToggleVisible(){const{hideUI:I,layout:D,ui:L}=this.getBase();if(I||this.getViewLayout(D)!==h.G.Column)return!1;const Q=this.store.selectSnapshot(e.Pf.getContentMode);return!(Q===r.G.ChapterInfo&&"full"!==this.getVisibleContent(r.G.ChapterInfo)||Q===r.G.Quiz&&"full"!==this.getVisibleContent(r.G.Quiz))&&L.column.enable}isTitleOnlyVisible(){const{hideUI:I,ui:D,layout:L}=this.getBase();if(I)return!1;const Q=this.getViewLayout(L),ie=this.getVisibleContent(r.G.ChapterInfo),se=this.isPaginationVisible();let Z=!0;return!(this.store.selectSnapshot(p.j.getQuizModeActive)||Q===h.G.Column&&(!1===D.column.enable&&!1===se||!1===D.column.enable&&"titleOnly"===ie&&!1===se||D.column.enable&&"full"===ie&&D.column.status!==t.Q.Collapse))&&(Q===h.G.Drawer&&(Z=D.drawer.enable||se),Z)}isToggleLabelsVisible(){return 0!==this.store.selectSnapshot(c.y.getChapterLabels).length&&this.isUIVisible(s.U.ToggleLabels)}isToolsVisible(){return this.isUIVisible(s.U.Tools)}isToolbarVisible(){return this.isUIVisible(s.U.Toolbar)}isFullScreenVisible(){return!this.store.selectSnapshot(e.Pf.getIsMobileWeb)&&this.isUIVisible(s.U.Fullscreen)}isLogoVisible(){const{ui:I}=this.getBase();if(this.store.selectSnapshot(e.Pf.getOpenWindow)===E.U.OnDemand)return!1;const D=this.store.selectSnapshot(e.Pf.getIsMobileWeb),L=this.store.selectSnapshot(v.dF.getUIEntry(s.U.Media));return!(this.isMediaVisible()&&"show"===L.status&&!D)&&I.logo.enable}isCameraVisible(){return this.isUIVisible(s.U.Camera)}isPaginationVisible(){return!(this.store.selectSnapshot(O.N.getChapterCount)<=1||this.store.selectSnapshot(p.j.getQuizModeActive))&&this.isUIVisible(s.U.Pagination)}isMediaVisible(){const{hideUI:I,ui:D}=this.getBase(),L=D.media.enable,Q=this.store.selectSnapshot(O.N.getSelectedChapter);return!(this.store.selectSnapshot(d.S.getCanvasHeightBreakpoint)===A.h.Tiny||I||!L||!Q?.id||!this.animationService.isChapterAnimated(Q))&&this.isUIVisible(s.U.Media)}isPlaythroughVisible(){const I=this.store.selectSnapshot(O.N.getChapterCount)>1;return!(this.store.selectSnapshot(m.J.getSelectedBookmarkViewMode)===C._.Quiz||!I)&&this.isUIVisible(s.U.Playthrough)}isToolbarOverflowVisible(){const{canvasHeightBreakpoint:I}=this.getBase(),D=this.isUIVisible(s.U.Help),L=this.isToggleLabelsVisible(),Q=this.store.selectSnapshot(p.j.hasQuiz),ie=this.store.selectSnapshot(p.j.getQuizEnabled),se=this.isUIVisible(s.U.QuizPrompt),Z=this.store.selectSnapshot(p.j.getQuizModeLocked),de=this.store.selectSnapshot(m.J.getSelectedBookmarkViewMode),ae=this.store.selectSnapshot(e.Pf.getIsMobileWeb);if(I>A.h.Tiny&&(D||L||Q&&se&&ie&&!1===Z&&de!==C._.Content&&ae))return!0;const K=this.isUIVisible(s.U.Tools),j=this.isUIVisible(s.U.VisibilityLayers),M=this.isUIVisible(s.U.Search),$=this.isUIVisible(s.U.Whiteboard);return!!(I<=A.h.Tiny&&(K||j||M||$))||this.isUIVisible(s.U.ToolbarOverflow)}isNodeInfoColumnVisible(){const{hideUI:I,ui:D,horizontalBreakpoint:L}=this.getBase();return!I&&(!!(L>=a.m.Large&&this.isUIVisible(s.U.NodeInfo))||(L<a.m.Large?!D.drawer.enable&&this.isUIVisible(s.U.NodeInfo):void 0))}isNodeInfoVisible(I){const{hideUI:D,horizontalBreakpoint:L}=this.getBase();return!D&&(L>=a.m.Large&&I===h.G.Column||L<a.m.Large&&I===h.G.Drawer)&&this.isUIVisible(s.U.NodeInfo)}isAudioVisible(){const{hideUI:I,ui:D}=this.getBase(),L=this.store.selectSnapshot(e.Pf.getViewLanguage),Q=this.store.selectSnapshot(O.N.getSelectedChapter),ie=this.store.selectSnapshot(e.Pf.getForceAudio);return!(0,P.isNil)(Q)&&this.mediaService.getChapterAudioPlaybackType(Q,L,ie)!==l.Y.None&&!I&&D[s.U.Audio].status!==t.Q.Hide&&(D[s.U.Audio].enable||ie)}isQuizPromptVisible(){const{hideUI:I}=this.getBase();return!I&&this.isUIVisible(s.U.QuizPrompt)}isSearchVisible(){return this.store.selectSnapshot(d.S.getCanvasHeightBreakpoint)!==A.h.Tiny&&this.isUIVisible(s.U.Search)}isUndoVisible(){const{hideUI:I,ui:D}=this.getBase();return!I&&D.undo.enable}isSkinLayersVisible(){const I=this.store.selectSnapshot(G.t.getVariantSchema("skin"));return!(0,P.isEmpty)(I)&&this.store.selectSnapshot(d.S.getCanvasHeightBreakpoint)!==A.h.Tiny&&this.isUIVisible(s.U.SkinLayers)}isVisibilityLayersVisible(){const I=this.store.selectSnapshot(O.N.getSelectedChapterSrcLayers),D=this.isSkinLayersVisible();return!(!this.chapterService.hasVisibilityLayers(I)&&!D||this.store.selectSnapshot(d.S.getCanvasHeightBreakpoint)===A.h.Tiny)&&(this.isUIVisible(s.U.VisibilityLayers)||this.isSkinLayersVisible())}isWhiteboardVisible(){return this.isUIVisible(s.U.Whiteboard)}isVisible(I){switch(I){case s.U.Audio:return this.isAudioVisible();case s.U.Camera:return this.isCameraVisible();case s.U.Column:return this.isColumnVisible();case s.U.ColumnToggle:return this.isColumnToggleVisible();case s.U.Drawer:return this.isDrawerVisible();case s.U.DrawerToggle:return this.isDrawerToggleVisible();case s.U.Fullscreen:return this.isFullScreenVisible();case s.U.Logo:return this.isLogoVisible();case s.U.Media:return this.isMediaVisible();case s.U.ToolbarOverflow:return this.isToolbarOverflowVisible();case s.U.QuizPrompt:return this.isQuizPromptVisible();case s.U.Pagination:return this.isPaginationVisible();case s.U.Playthrough:return this.isPlaythroughVisible();case s.U.Search:return this.isSearchVisible();case s.U.TitleOnly:return this.isTitleOnlyVisible();case s.U.ToggleLabels:return this.isToggleLabelsVisible();case s.U.Tools:return this.isToolsVisible();case s.U.Toolbar:return this.isToolbarVisible();case s.U.Undo:return this.isUndoVisible();case s.U.VisibilityLayers:return this.isVisibilityLayersVisible();case s.U.SkinLayers:return this.isSkinLayersVisible();case s.U.Whiteboard:return this.isWhiteboardVisible();default:return this.isUIVisible(I)}}isUIVisible(I){const{hideUI:D,ui:L}=this.getBase();return L[I]?!D&&L[I].enable&&L[I].status!==t.Q.Hide:(console.warn("Attempting to check visibility of a non-existent element: ${element}"),!1)}isUIEnabled(I){const{ui:D}=this.getBase();return D[I].enable}getChapterVisibility(){const{ui:I}=this.getBase(),D=this.store.selectSnapshot(c.y.getChapterLabels),L=this.store.selectSnapshot(O.N.getSelectedChapter),Q=L?.displayName,ie=null!=Q&&(0,P.trim)(Q).length>0,Z=this.contentBlocksService.filterEmptyBlocks(L?.contentBlocks??[]).length>0,de=I.labelList.enable&&D.length>0,ae=L?.description,q=null!=ae&&(0,P.trim)(ae).length>0,K=(0,P.get)(L,"legend",[]);return de||q||I.legend.enable&&K.length>0||Z?"full":ie?"titleOnly":"none"}getQuizVisibility(){return this.store.selectSnapshot(p.j.getQuizModeActive)?"full":"none"}getLabelInfoVisibility(){const I=this.store.selectSnapshot(c.y.getSelectedLabel);if((0,P.isNil)(I))return"none";const D=I?.title,L=null!=D&&(0,P.trim)(D).length>0;return(0,P.trim)(I.description).length>0||I.contentBlocks?.length>0?"full":L?"titleOnly":"none"}getVisibleContent(I){switch(I){case r.G.ChapterInfo:return this.getChapterVisibility();case r.G.LabelInfo:return this.getLabelInfoVisibility();case r.G.Quiz:return this.getQuizVisibility()}}getViewLayout(I){const{innerHeight:D,innerWidth:L}=window,Q=L/D>=1?"landscape":"portrait",{horizontalBreakpoint:ie}=this.getBase(),se=this.store.selectSnapshot(b.W.getSiteHeader),Z=this.store.selectSnapshot(b.W.getSiteHeaderHeight),ae=384+((0,R.Un)(se)?Z:0);switch(I){case g.o.ColumnOnly:return h.G.Column;case g.o.DrawerOnly:return h.G.Drawer;default:return"portrait"===Q?h.G.Drawer:ie>=a.m.Large||D<=ae&&L>=708?h.G.Column:h.G.Drawer}}static#e=this.\u0275fac=function(D){return new(D||x)(V.KVO(W.il),V.KVO(i.j),V.KVO(_.O),V.KVO(u.u),V.KVO(k.V))};static#t=this.\u0275prov=V.jDH({token:x,factory:x.\u0275fac,providedIn:"root"})}return x})()},39358:(le,N,n)=>{"use strict";n.d(N,{z:()=>rt});var e=n(28407),t=n(66056),s=n(76304),c=n(22679),O=n(85052),P=n(82656),S=n(14264),a=n(17365),f=n(33013),E=n(13409),y=n(47555),i=n(47610),g=n(26463),p=n(13181),h=n(93132),o=n(20458),v=n(93915),d=n(94495),r=n(7431),_=n(63745),u=n(49204),l=n(54438),m=n(92014);let C=(()=>{class Ke{constructor(ge){this.store=ge}chapterHasTransition(ge,Ee){const $e=(0,u.get)(ge,Ee?"transitions.pre":"transitions.post");return!!$e&&(Ee?$e.onPrevious:$e.onNext)}searchChapterTransitions(ge,Ee,Fe){let $e=[...Fe],ot=$e.findIndex(Ue=>Ue.id===ge),je=$e.findIndex(Ue=>Ue.id===Ee);const xe=je<ot;if(xe&&($e=$e.reverse(),ot=$e.findIndex(Ue=>Ue.id===ge),je=$e.findIndex(Ue=>Ue.id===Ee)),ot<0||je<0||ot===je)return null;const Me=$e.slice(ot,je).find(Ue=>this.chapterHasTransition(Ue,xe));return Me?xe?Me.transitions.pre:Me.transitions.post:null}static#e=this.\u0275fac=function(Ee){return new(Ee||Ke)(l.KVO(m.il))};static#t=this.\u0275prov=l.jDH({token:Ke,factory:Ke.\u0275fac,providedIn:"root"})}return Ke})();var b=n(62751),R=n(38104),A=n(17276),G=n(61295),k=n(75069),V=n(39898),W=n(34215),T=n(47632),x=n(24477),z=n(59e3),I=n(87710),D=n(18272),L=n(34006),Q=n(2573),ie=n(32408),se=n(47833),Z=n(26779),de=n(87424),ae=n(57018),q=n(60177);let K=(()=>{class Ke{transform(ge){return ge.split(" ").map(Fe=>`<kbd>${Fe}</kbd>`).join("")}static#e=this.\u0275fac=function(Ee){return new(Ee||Ke)};static#t=this.\u0275pipe=l.EJ8({name:"kbd",type:Ke,pure:!0})}return Ke})();function j(Ke,et){if(1&Ke&&(l.j41(0,"label",10),l.EFF(1),l.k0s()),2&Ke){const ge=l.XpG().$implicit;l.R7$(),l.JRh(ge.pronunciation)}}function M(Ke,et){if(1&Ke&&(l.j41(0,"span"),l.nrm(1,"kbd",8),l.nI1(2,"kbd"),l.DNE(3,j,2,1,"label",9),l.k0s()),2&Ke){const ge=et.$implicit;l.R7$(),l.Y8G("innerHTML",l.bMT(2,3,ge.shortcut),l.npT),l.BMQ("aria-hidden",ge.hasOwnProperty("pronunciation")),l.R7$(2),l.Y8G("ngIf",ge.hasOwnProperty("pronunciation"))}}function $(Ke,et){if(1&Ke&&(l.j41(0,"tr")(1,"th",6),l.EFF(2),l.k0s(),l.j41(3,"td",7),l.DNE(4,M,4,5,"span",5),l.k0s()()),2&Ke){const ge=et.$implicit;l.R7$(2),l.JRh(ge.label),l.R7$(2),l.Y8G("ngForOf",ge.keys)}}function ce(Ke,et){if(1&Ke&&(l.j41(0,"div",2)(1,"h2",3),l.EFF(2),l.k0s(),l.j41(3,"table",4),l.DNE(4,$,5,2,"tr",5),l.k0s()()),2&Ke){const ge=et.$implicit;l.R7$(2),l.JRh(ge.label),l.R7$(2),l.Y8G("ngForOf",ge.shortcuts)}}var re=function(Ke){return Ke.Left="\u2190",Ke.Right="\u2192",Ke.Up="\u2191",Ke.Down="\u2193",Ke.Command="\u2318",Ke}(re||{});let ue=(()=>{class Ke{constructor(){this.shortcutGroups=[{label:$localize`Navigation`,shortcuts:[{keys:[{shortcut:",",pronunciation:"Comma."},{shortcut:"Pg-Up",pronunciation:"page-up"}],label:$localize`Previous chapter`},{keys:[{shortcut:".",pronunciation:"Period."},{shortcut:"Pg-Down",pronunciation:"Page-down."}],label:$localize`Next chapter`},{keys:[{shortcut:"/",pronunciation:"Forward slash."}],label:$localize`Open Search`},{keys:[{shortcut:"Ctrl + Enter"}],label:$localize`Enter Fullscreen`},{keys:[{shortcut:"Ctrl/Cmd + ,",pronunciation:"Control or command plus comma."}],label:$localize`Toggle Description`},{keys:[{shortcut:"Shift + /"}],label:$localize`Open Help`}]},{label:$localize`Tools`,shortcuts:[{keys:[{shortcut:"1"}],label:$localize`Use "Select" tool`},{keys:[{shortcut:"2"}],label:$localize`Use "Hide" tool`},{keys:[{shortcut:"3"}],label:$localize`Use "Fade" tool`},{keys:[{shortcut:"del",pronunciation:"Delete."},{shortcut:"backspace"}],label:$localize`Hide selected structure`},{keys:[{shortcut:"Shift + R"}],label:$localize`Reset chapter`},{keys:[{shortcut:"P"}],label:$localize`Toggle between pan and rotate mode`},{keys:[{shortcut:"Ctrl/Cmd + Z",pronunciation:"Control or command plus z."}],label:$localize`Undo`},{keys:[{shortcut:"Ctrl/Cmd + Shift + Z",pronunciation:"Control or command plus shift pluz z."},{shortcut:"Ctrl/Cmd + Y",pronunciation:"Control or command plus y."}],label:$localize`Redo`}]},{label:$localize`Pan`,shortcuts:[{keys:[{shortcut:"W"}],label:$localize`Pan up`},{keys:[{shortcut:"S"}],label:$localize`Pan down`},{keys:[{shortcut:"A"}],label:$localize`Pan left`},{keys:[{shortcut:"D"}],label:$localize`Pan right`},{keys:[{shortcut:"Shift + W"}],label:$localize`Slow pan up`},{keys:[{shortcut:"Shift + S"}],label:$localize`Slow pan down`},{keys:[{shortcut:"Shift + A"}],label:$localize`Slow pan left`},{keys:[{shortcut:"Shift + D"}],label:$localize`Slow pan right`}]},{label:$localize`Rotate`,shortcuts:[{keys:[{shortcut:re.Up}],label:$localize`Rotate up`},{keys:[{shortcut:re.Down}],label:$localize`Rotate down`},{keys:[{shortcut:re.Left}],label:$localize`Rotate left`},{keys:[{shortcut:re.Right}],label:$localize`Rotate right`},{keys:[{shortcut:`Shift + ${re.Up}`}],label:$localize`Slow rotate up`},{keys:[{shortcut:`Shift + ${re.Down}`}],label:$localize`Slow rotate down`},{keys:[{shortcut:`Shift + ${re.Left}`}],label:$localize`Slow rotate left`},{keys:[{shortcut:`Shift + ${re.Right}`}],label:$localize`Slow rotate right`}]},{label:$localize`Zoom`,shortcuts:[{keys:[{shortcut:"E"},{shortcut:"=",pronunciation:"Equals."}],label:$localize`Zoom in`},{keys:[{shortcut:"C"},{shortcut:"-",pronunciation:"Hyphen."}],label:$localize`Zoom out`},{keys:[{shortcut:"Shift + E"},{shortcut:"Shift + =",pronunciation:"Shift plus equals."}],label:$localize`Slow zoom in`},{keys:[{shortcut:"Shift + C"},{shortcut:"Shift + -",pronunciation:"Shift plus hyphen."}],label:$localize`Slow zoom out`}]},{label:$localize`Modify Selected Objects`,shortcuts:[{keys:[{shortcut:"Shift + H"}],label:$localize`Hide selected objects`},{keys:[{shortcut:"Shift + F"}],label:$localize`Fade selected objects`},{keys:[{shortcut:"Shift + I"}],label:$localize`Isolate selected objects`}]},{label:$localize`Media Controls`,shortcuts:[{keys:[{shortcut:"J"}],label:$localize`Rewind 1 second`},{keys:[{shortcut:"L"}],label:$localize`Fast forward 1 second`},{keys:[{shortcut:"K"},{shortcut:"space"}],label:$localize`Play / pause`}]}]}static#e=this.\u0275fac=function(Ee){return new(Ee||Ke)};static#t=this.\u0275cmp=l.VBU({type:Ke,selectors:[["app-view-shortcuts"]],decls:2,vars:1,consts:[[1,"view-shortcuts"],["class","view-shortcuts__group",4,"ngFor","ngForOf"],[1,"view-shortcuts__group"],[1,"view-shortcuts__label","font-bold"],[1,"view-shortcuts__table"],[4,"ngFor","ngForOf"],["scope","row",1,"view-shortcuts__cell-header"],[1,"view-shortcuts__cell","view-shortcuts__cell--key"],[1,"view-shortcuts__key",3,"innerHTML"],["class","sr-only",4,"ngIf"],[1,"sr-only"]],template:function(Ee,Fe){1&Ee&&(l.j41(0,"div",0),l.DNE(1,ce,5,2,"div",1),l.k0s()),2&Ee&&(l.R7$(),l.Y8G("ngForOf",Fe.shortcutGroups))},dependencies:[q.Sq,q.bT,K],styles:[".view-shortcuts{display:flex;flex-direction:column}.view-shortcuts__group{width:100%;padding-bottom:32px;margin-top:32px}.view-shortcuts__label{padding:8px 0 12px}.view-shortcuts__table{width:100%}.view-shortcuts__cell{padding:8px;border-bottom:1px solid rgba(255,255,255,.3);width:50%}.view-shortcuts__cell-header{text-align:start;padding:8px;border-bottom:1px solid rgba(255,255,255,.3);width:50%}.view-shortcuts__key{border-radius:4px;display:inline-flex;padding:4px;margin-right:4px;background:#000;color:#fff;justify-content:center;align-items:center;font-family:monospace;font-size:16px}.view-shortcuts__key>kbd{margin-inline-end:8px}.view-shortcuts__key>kbd:last-child{margin-inline-end:0}\n"],encapsulation:2,changeDetection:0})}return Ke})();const F=["viewHelp"];class w{constructor(et,ge,Ee,Fe){this.dialogRef=et,this.renderer=ge,this.store=Ee,this.data=Fe,this.helpTypeEnum=V.J,this.activeTab=V.J.Basics,this.ngUnsubscribe=new O.B,this.activeTab=Fe.tab}ngOnInit(){this.initWindowSizeObserver()}ngAfterViewInit(){this.updateViewHeight()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initWindowSizeObserver(){this.renderer.listen("window","resize",()=>{this.updateViewHeight()})}updateViewHeight(){const et=this.store.selectSnapshot(ie.W.getSiteHeader),ge=this.store.selectSnapshot(ie.W.getSiteHeaderHeight),Ee=(0,se.mJ)(et,ge,!1);this.viewHelp.nativeElement.style.setProperty("--vh",`${Ee}px`)}handleCloseClick(){this.dialogRef.close()}static#e=this.\u0275fac=function(ge){return new(ge||w)(l.rXU(L.CP),l.rXU(l.sFG),l.rXU(m.il),l.rXU(L.Vh))};static#t=this.\u0275cmp=l.VBU({type:w,selectors:[["app-help-dialog"]],viewQuery:function(ge,Ee){if(1&ge&&l.GBs(F,7),2&ge){let Fe;l.mGM(Fe=l.lsd())&&(Ee.viewHelp=Fe.first)}},decls:147,vars:1,consts:()=>{let et,ge,Ee,Fe,$e,ot,je,xe,Me,Ue,Ne,Xe,be,ke,Re,dt,yt,Dt,Ft,ze,It,Ot,jt,wt,Et,zt,Rt,Gt,vt,Bt,$t,Xt,rn,Zt,ln,cn,dn,un,pn,hn,_n,gn,At,mn,fn,qt,yn,vn,en,Sn,bn,jn,Nn,Qt,En;return et=$localize`:fe6f57177418d5e7beb3165189f76d610996162d7676085147402388734:Navigation Basics`,ge=$localize`:429597f3d7d1d78213dcf7dd66eebfde0d86678e6253898756323650322:A heart with an arrow wrapped around it, which symbolises objects being rotated withing the 3D viewport.`,Ee=$localize`:e18d3340208bca7ddf2d94f70d0a660dbd42385d5773019152243041254:A heart with left and right arrows pointing away from it, which symbolises objects being panned within the 3D viewport`,Fe=$localize`:d39dadf537d9b0839ce21a28536327f9f5a686c74934730967388350918:A heart with a magnifying glass over it, which symbolises zooming into and out from an object within the 3D viewport.`,$e=$localize`:304ad8b02639512724d4bd74a4e0948235755937354592426013976576:A heart with a smaller region colored in blue and a popup window specifying that the Right Ventricle is selected.`,ot=$localize`:6cfe97f88f0ed2276b3712e9f9f3afa30a5202816061724875357600922:All Controls`,je=$localize`:18a94681247b809ceced9eb0f694ae4c0d312da46414411281097606478:A mouse with the left button being held in.`,xe=$localize`:1170cfcc8c84af3864f78a0492ec1fd7802843688257874423928835005:A mouse with the right button being held in.`,Me=$localize`:7af3be3703c527b268af7bdf41dbea65aa79a6ec9056964158501440909:A mouse with the left button being clicked.`,Ue=$localize`:2060ac29b56620ac4dee9e60c192070663dbe8ae1011682562656049028:A mouse with the left button being double clicked.`,Ne=$localize`:3151632192d235a3f169dca7cc9ef84780febe866187030666890085624:A mouse with the left button being held in for a long duration.`,Xe=$localize`:966f12391c5738cf46c32d1cb6a5f5a8340486424740543999988156181:The arrow keys.`,be=$localize`:6ba68416157f6fe2131511ecdd079903b2eeefb78470097694829285611:The W, A, S and D keys.`,ke=$localize`:0ac7f1fedebf3949fc40233a13c6eb4e0e0406644819033955395086119:The plus and minus keys grouped together or the E and C keys grouped together.`,Re=$localize`:2b78dffe01cdcaf46976e26b031c327066fff0fa6264224730837738660:The shift key.`,dt=$localize`:a302d6da0d4e760ae27cb11470852686dc8472914683038358223678995:A finger clicking the trackpad once.`,yt=$localize`:ed595e7bcf6f65d4bfcb7302f8436fdc171e87a12262651993298779843:A finger clicking the trackpad twice.`,Dt=$localize`:23c69f01719b0c53dea3a4f38b7b6b20b1a68f354216705101587735156:A finger pressing for a long duration on the trackpad.`,Ft=$localize`:58f7f1cfc7494c3ad8af6f045a100569af8e763d3981109811663390815:Two fingers pressing the trackpad while moving vertically.`,ze=$localize`:eedb1f2596af2c8fcb065b15ace6b88d079e45db4831075576673859232:Keyboard Shortcuts`,It=$localize`:85b79c9064aed1ead31ace985f31aa1363f6bdaf7911416166208830577:Help`,Ot=$localize`:0ce04cf84ced2fc10b64d8d01c93254302fae7208819530610784848299:Close help modal`,jt=$localize`:20058274f3bdffd2cf7023d350d44170f6ff7a121050269006235116171:Rotate`,wt=$localize`:b2ba3edf1e4f930372c8c0648a80cd8540824bb27927106883889636493:Click and drag or use one finger to change the viewing angle.`,Et=$localize`:7cd14ceae63b4aba71ab7935638f5d3b799f4f4b9128067536654850026:Pan`,zt=$localize`:5f2421818b14ff6b2b6760f657072c9d1edf54c0875857706935138088:Hold the shift key and drag or use two fingers to move the model's position.`,Rt=$localize`:e76cd6dbaa898f85934f363fef654b29e44d004b6421460271971606186:Zoom`,Gt=$localize`:943378a26adbb00b393fc72f7d8751a3d154419f2968417613352515367:Scroll up and down or pinch with two fingers to zoom in or out.`,vt=$localize`:eb55d5cbcf6e2a42868bede1caa64be0f1f1e4355702628055979003671:Explore the Anatomy`,Bt=$localize`:1e2bffd4aecf789df7c101eec013ece36ac4d1b13307141625837320493:Click or tap an anatomic structure or label to learn more.`,$t=$localize`:06525f75da53823cbe1725093bc86cd88ade8597728862926652618704:Mouse`,Xt=$localize`:c3cee0bf85850fda5c38ee3e4d1bff10de4ce5c57193182677599035399:Hold left button to rotate`,rn=$localize`:23c0d0956b66d711cfe7df58ef6a7b4d07075b004504766784431323465:Hold right button to pan`,Zt=$localize`:430665e380a10950da6951cf7f4002d0cc8dd1575037804585803260848:Single-click left button to select a structure`,ln=$localize`:45cebd73bba4b4553ff774400b20119e5a9d97ff2243293724382272862:Double-click left button to auto-focus on a structure`,cn=$localize`:7e25565e229d4feddc9c05e1738729a9aac57a287760284646478975781:Long-click to fly to a structure`,dn=$localize`:acf011d3a80afd38b5f793c53325ed05c673e8235236879271199776564:Keyboard`,un=$localize`:50b412747cc527764294a1b903ec5c1d62844a111724029931462476938:Rotate with arrows`,pn=$localize`:07614e55f8def77bf252040fc41cc9453e0fa34d8399776404178179481:Pan up (W), left (A), down (S), right(D)`,hn=$localize`:064d015bd99ad65866112d59a58eb66cd4ed3dcf2527063424056268537:Zoom out (-, C) and zoom in (+, E)`,_n=$localize`:6b1e5719efa1db70ea28a09765b11b1488dc3dcb3479840639285374289:Hold with any previous key to slow down motion`,gn=$localize`:3b12deb58592fad9559bee11b1c81a314f6c0dfd5453789791073353804:Trackpad`,At=$localize`:03e5f4b8f37c3498d675cce895d5cbbe14f001dd8732399774338102812:Single-tap to auto-focus a structure`,mn=$localize`:fa6d739684a57595169beedef230af0de5e835f8893674047997882971:Double-tap to select a structure`,fn=$localize`:38d81be3a0506d3d76acab0eb9ba6d756e643b9e6955199594650294227:Long-press to fly to a structure`,qt=$localize`:bbc241c56a687bd4b728277bbbfc5714fe71564d8600401187735507174:Scroll up and down to zoom`,yn=$localize`:2d2c5215cbb8cb0c926c8d132668eb16275558b08973369245527156970:In-App`,vn=$localize`:74d17ea41b9374ceefcf8f7c763a1176cd96dbae491840984763060870: The plus symbol, which represents zooming in in the camera control menu. `,en=$localize`:e28ee80cd3a124e109793180dfd1f8d8067dcc6b6500061599200357251:Zoom in`,Sn=$localize`:402a1f359e7c008f0aef6b084fafaf2f49ce56d3399413764515891152: The minus symbol, which represents zooming out in the camera control menu. `,bn=$localize`:a3dfc58748f790fa096cf3c5fc331f90846e1772944767796496567082:Zoom out`,jn=$localize`:c4f9fc3dd4d06c87f09dc68e8e0a3b38ae4948ff7289327967342552784: The map pin symbol, which resets the camera in the camera control menu. `,Nn=$localize`:ac4a855ff1671d74a0692e3b9ee5be349e6281ca6332173527621530176:Return to Starting Position`,Qt=$localize`:5108bd6e5963ccd847b1a768fd214262ccfbc81d8038524584906192988: Arrows pointing in four directions, which represents panning in the camera control menu. `,En=$localize`:7cd14ceae63b4aba71ab7935638f5d3b799f4f4b9128067536654850026:Pan`,[["viewHelp",""],It,Ot,jt,wt,Et,zt,Rt,Gt,vt,Bt,$t,Xt,rn,Zt,ln,cn,dn,un,pn,hn,_n,gn,At,mn,fn,qt,yn,vn,en,Sn,bn,jn,Nn,Qt,En,["role","dialog","aria-labelledby","helpTitle",1,"view-help"],["id","helpTitle",1,"view-help__header"],["type","button",1,"view-help__close",3,"click"],["icon","times","aria-hidden","true"],[1,"sr-only"],[1,"view-help__inner"],["tabSize","medium","tabAlign","center","cdkFocusInitial","",3,"activeTab"],["label",et,"id","helpBasics","aria-controls","basicsPanel"],["role","tabpanel","aria-labelledby","helpBasics","tabindex","0","id","basicsPanel"],[1,"view-help__group"],[1,"view-help__item"],[1,"view-help__image"],["src","assets/images/widget/help-rotate.svg","alt",ge],[1,"view-help__label"],["src","assets/images/widget/help-pan.svg","alt",Ee],["src","assets/images/widget/help-zoom.svg","alt",Fe],["src","assets/images/widget/help-learn.svg","alt",$e],["label",ot,"id","helpAll","aria-controls","allPanel"],["role","tabpanel","aria-labelledby","helpAll","tabindex","0","id","allPanel"],[1,"view-help__section-header"],["src","assets/images/widget/help-mouse-hold-left.svg","alt",je],["src","assets/images/widget/help-mouse-hold-right.svg","alt",xe],["src","assets/images/widget/help-mouse-single-click-left.svg","alt",Me],["src","assets/images/widget/help-mouse-double-click-left.svg","alt",Ue],["src","assets/images/widget/help-mouse-long-press-left.svg","alt",Ne],["src","assets/images/widget/help-keyboard-rotate.svg","alt",Xe],["src","assets/images/widget/help-keyboard-pan.svg","alt",be],["src","assets/images/widget/help-keyboard-zoom.svg","alt",ke],["src","assets/images/widget/help-keyboard-slow-motion.svg","alt",Re],["src","assets/images/widget/help-trackpad-single-tap.svg","alt",dt],["src","assets/images/widget/help-trackpad-double-tap.svg","alt",yt],["src","assets/images/widget/help-trackpad-long-press.svg","alt",Dt],["src","assets/images/widget/help-trackpad-scroll.svg","alt",Ft],["icon","plus","aria-hidden","true",1,"view-help__icon"],["icon","minus","aria-hidden","true",1,"view-help__icon"],["icon","location","aria-hidden","true",1,"view-help__icon"],["icon","arrows","aria-hidden","true",1,"view-help__icon"],["label",ze,"id","helpShortcuts","aria-controls","shortcutsPanel"],["role","tabpanel","aria-labelledby","helpShortcuts","tabindex","0","id","shortcutsPanel"]]},template:function(ge,Ee){if(1&ge){const Fe=l.RV6();l.j41(0,"div",36,0)(2,"h2",37),l.pXf(3,1),l.k0s(),l.j41(4,"button",38),l.bIt("click",function(){return l.eBV(Fe),l.Njj(Ee.handleCloseClick())}),l.nrm(5,"app-icon",39),l.j41(6,"span",40),l.pXf(7,2),l.k0s()(),l.j41(8,"div",41)(9,"app-tabs",42)(10,"app-tab",43)(11,"div",44)(12,"ul",45)(13,"li",46)(14,"div",47),l.nrm(15,"img",48),l.k0s(),l.j41(16,"div",49),l.pXf(17,3),l.k0s(),l.qex(18),l.pXf(19,4),l.bVm(),l.k0s(),l.j41(20,"li",46)(21,"div",47),l.nrm(22,"img",50),l.k0s(),l.j41(23,"div",49),l.pXf(24,5),l.k0s(),l.qex(25),l.pXf(26,6),l.bVm(),l.k0s(),l.j41(27,"li",46)(28,"div",47),l.nrm(29,"img",51),l.k0s(),l.j41(30,"div",49),l.pXf(31,7),l.k0s(),l.qex(32),l.pXf(33,8),l.bVm(),l.k0s(),l.j41(34,"li",46)(35,"div",47),l.nrm(36,"img",52),l.k0s(),l.j41(37,"div",49),l.pXf(38,9),l.k0s(),l.qex(39),l.pXf(40,10),l.bVm(),l.k0s()()()(),l.j41(41,"app-tab",53)(42,"div",54)(43,"h3",55),l.pXf(44,11),l.k0s(),l.j41(45,"ul",45)(46,"li",46)(47,"div",47),l.nrm(48,"img",56),l.k0s(),l.qex(49),l.pXf(50,12),l.bVm(),l.k0s(),l.j41(51,"li",46)(52,"div",47),l.nrm(53,"img",57),l.k0s(),l.qex(54),l.pXf(55,13),l.bVm(),l.k0s(),l.j41(56,"li",46)(57,"div",47),l.nrm(58,"img",58),l.k0s(),l.qex(59),l.pXf(60,14),l.bVm(),l.k0s(),l.j41(61,"li",46)(62,"div",47),l.nrm(63,"img",59),l.k0s(),l.qex(64),l.pXf(65,15),l.bVm(),l.k0s(),l.j41(66,"li",46)(67,"div",47),l.nrm(68,"img",60),l.k0s(),l.qex(69),l.pXf(70,16),l.bVm(),l.k0s()(),l.j41(71,"h3",55),l.pXf(72,17),l.k0s(),l.j41(73,"ul",45)(74,"li",46)(75,"div",47),l.nrm(76,"img",61),l.k0s(),l.qex(77),l.pXf(78,18),l.bVm(),l.k0s(),l.j41(79,"li",46)(80,"div",47),l.nrm(81,"img",62),l.k0s(),l.qex(82),l.pXf(83,19),l.bVm(),l.k0s(),l.j41(84,"li",46)(85,"div",47),l.nrm(86,"img",63),l.k0s(),l.qex(87),l.pXf(88,20),l.bVm(),l.k0s(),l.j41(89,"li",46)(90,"div",47),l.nrm(91,"img",64),l.k0s(),l.qex(92),l.pXf(93,21),l.bVm(),l.k0s()(),l.j41(94,"h3",55),l.pXf(95,22),l.k0s(),l.j41(96,"ul",45)(97,"li",46)(98,"div",47),l.nrm(99,"img",65),l.k0s(),l.qex(100),l.pXf(101,23),l.bVm(),l.k0s(),l.j41(102,"li",46)(103,"div",47),l.nrm(104,"img",66),l.k0s(),l.qex(105),l.pXf(106,24),l.bVm(),l.k0s(),l.j41(107,"li",46)(108,"div",47),l.nrm(109,"img",67),l.k0s(),l.qex(110),l.pXf(111,25),l.bVm(),l.k0s(),l.j41(112,"li",46)(113,"div",47),l.nrm(114,"img",68),l.k0s(),l.qex(115),l.pXf(116,26),l.bVm(),l.k0s()(),l.j41(117,"h3",55),l.pXf(118,27),l.k0s(),l.j41(119,"ul",45)(120,"li",46),l.nrm(121,"app-icon",69),l.j41(122,"span",40),l.pXf(123,28),l.k0s(),l.qex(124),l.pXf(125,29),l.bVm(),l.k0s(),l.j41(126,"li",46),l.nrm(127,"app-icon",70),l.j41(128,"span",40),l.pXf(129,30),l.k0s(),l.qex(130),l.pXf(131,31),l.bVm(),l.k0s(),l.j41(132,"li",46),l.nrm(133,"app-icon",71),l.j41(134,"span",40),l.pXf(135,32),l.k0s(),l.qex(136),l.pXf(137,33),l.bVm(),l.k0s(),l.j41(138,"li",46),l.nrm(139,"app-icon",72),l.j41(140,"span",40),l.pXf(141,34),l.k0s(),l.qex(142),l.pXf(143,35),l.bVm(),l.k0s()()()(),l.j41(144,"app-tab",73)(145,"div",74),l.nrm(146,"app-view-shortcuts"),l.k0s()()()()()}2&ge&&(l.R7$(9),l.Y8G("activeTab",Ee.activeTab))},dependencies:[Z.R,de.j,ae.O,ue],styles:[".view-help{background-color:#101823e6;color:#fff;display:flex;align-items:center;flex-direction:column;position:fixed;top:0;left:0;right:0;z-index:10000;height:100vh;height:calc(var(--vh, 1vh) * 100);max-height:100vh;overflow:auto}.view-help__inner{width:100%;max-width:1140px;height:99vh;height:calc(var(--vh, 1vh) * 99);padding:32px;position:relative}.view-help__close{color:#fff;width:40px;height:40px;display:flex;align-items:center;justify-content:center;position:fixed;right:8px;top:8px;z-index:10;border:none;background:none}.view-help__header{font-size:.875rem;line-height:1.25rem;font-weight:600;padding-bottom:12px;margin-top:32px}.view-help__section-header{font-size:.75rem;line-height:1rem;border-bottom:1px solid rgba(255,255,255,.3);font-weight:600;padding-bottom:12px;margin-top:32px}.view-help__label{font-size:.875rem;line-height:1.25rem;font-weight:600;margin-bottom:12px}.view-help__group{display:flex;justify-content:space-around;flex-wrap:wrap}.view-help__item{font-size:.75rem;line-height:1rem;display:flex;flex-flow:column;text-align:center;padding:20px;flex:0 1 180px}.view-help__image{justify-content:center;margin-bottom:16px;width:160px;height:100px}.view-help__icon{font-size:24px;margin-bottom:16px}\n"],encapsulation:2,changeDetection:0})}!function(Ke,et,ge,Ee){var ot,Fe=arguments.length,$e=Fe<3?et:null===Ee?Ee=Object.getOwnPropertyDescriptor(et,ge):Ee;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)$e=Reflect.decorate(Ke,et,ge,Ee);else for(var je=Ke.length-1;je>=0;je--)(ot=Ke[je])&&($e=(Fe<3?ot($e):Fe>3?ot(et,ge,$e):ot(et,ge))||$e);Fe>3&&$e&&Object.defineProperty(et,ge,$e)}([(0,m.l6)(g.Pf.getCanTouch),function(Ke,et){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata("design:type",et)}(0,Q.c)],w.prototype,"canTouch$",void 0);var X=n(3829),oe=n(51529),Y=n(93822),he=n(51640),ne=n(50677),_e=n(38753),Ce=n(35650),Be=n(62949),Ie=function(Ke){return Ke.DiscoveredChapterNav="Discovered Chapter Nav",Ke}(Ie||{}),Oe=n(11153),Te=n(95419),ve=n(37710),Ve=n(28722),we=n(46842),Je=n(91003),tt=n(18617),st=n(47987);let rt=(()=>{class Ke{constructor(ge,Ee,Fe,$e,ot,je,xe,Me,Ue,Ne,Xe){this.dialog=ge,this.store=Ee,this.location=Fe,this.transitionService=$e,this.mediaService=ot,this.sceneService=je,this.viewUIService=xe,this.vendorAnalyticsService=Me,this.liveAnnouncer=Ue,this.overlayContainer=Ne,this.positionsService=Xe,this.materialOverlayOut$=new O.B}initStory(ge,Ee,Fe){const $e="preview"===ge;this.store.dispatch(new T.Xt(ge,Ee,$e)),this.store.dispatch(new t.yi(ge,Ee,!0));const ot=this.store.select(s.S.getReady),je=this.store.select(c.t.getIncomingStoryInfo);(0,P.z)([ot,je]).pipe((0,S.p)(([xe,Me])=>xe&&!!Me.id),(0,a.s)(1)).subscribe(()=>{this.store.dispatch(new f.yz),this.store.dispatch(new t.Ye(ge,Ee,Fe,$e))})}nextChapter(ge){const Ee=this.store.selectSnapshot(d.N.getSelectedChapterIndex),Fe=this.store.selectSnapshot(d.N.getStoryChapters);this.vendorAnalyticsService.trackOncePerSession(Ie.DiscoveredChapterNav,{source:ge,breakpoint:this.store.selectSnapshot(R.V.getHorizontalBreakpointLabel)});const $e=Fe[Ee+1];$e&&this.selectChapter($e)}previousChapter(ge){const Ee=this.store.selectSnapshot(d.N.getSelectedChapterIndex),Fe=this.store.selectSnapshot(d.N.getStoryChapters);this.vendorAnalyticsService.trackOncePerSession(Ie.DiscoveredChapterNav,{source:ge,breakpoint:this.store.selectSnapshot(R.V.getHorizontalBreakpointLabel)});const $e=Fe[Ee-1];$e&&this.selectChapter($e)}firstChapter(ge){const Ee=this.store.selectSnapshot(d.N.getStoryChapters);this.vendorAnalyticsService.trackOncePerSession(ge,{source:ge,breakpoint:this.store.selectSnapshot(R.V.getHorizontalBreakpointLabel)});const Fe=Ee[0];Fe&&this.selectChapter(Fe)}selectChapter(ge){var Ee=this;return(0,e.A)(function*(){if(!Ee.store.selectSnapshot(I.j.getQuizModeActive)){const ot=Ee.store.selectSnapshot(d.N.getSelectedChapterId),je=ge.id,xe=Ee.store.selectSnapshot(d.N.getStoryChapters);let Me=null;Ee.store.selectSnapshot(we.U.getPrefersReducedMotion)||(Me=Ee.transitionService.searchChapterTransitions(ot,je,xe)),Ee.vendorAnalyticsService.trackOncePerSession(Ie.DiscoveredChapterNav,{source:"Chapter List",breakpoint:Ee.store.selectSnapshot(R.V.getHorizontalBreakpointLabel)}),Ee.store.dispatch(new r.gV(ot,Ee.positionsService.getCamera())),Me&&(yield Ee.chapterTransition(Me)),Ee.store.dispatch([new t.si(ge.id),new f.yz(ge)])}const $e=document.getElementById("chapter-title");$e&&setTimeout(()=>$e.querySelector("button").focus(),200)})()}chapterTransition(ge){return new Promise(Ee=>{ge.camera&&this.store.dispatch(new r.Ih(ge.camera,!0,ge.duration)),ge.fadeColor&&this.store.dispatch(new i.zW(ge.fadeColor,ge.duration)),setTimeout(()=>{Ee(!0)},1e3*ge.duration)})}hideSelectedStructures(){const ge=this.store.selectSnapshot(E.z.getCheckedNodeIds);this.store.dispatch(new G.yr(!1,ge))}selectTool(ge){this.store.selectSnapshot(I.j.getQuizModeActive)&&ge===y.s.Select&&(ge=y.s.Quiz),this.store.dispatch(new i.pL(ge))}toggleAutoplay(ge){ge=ge??!this.store.selectSnapshot(g.Pf.getAutoplay),this.store.dispatch(new h.B.SetAutoplay(ge))}toggleAnimation(){const ge=this.store.selectSnapshot(s.S.getAnimationPlaying);this.store.dispatch(new i.dE(!ge))}toggleMedia(ge){const Ee=this.store.selectSnapshot(he.dF.getUI);Ee.media.status=(ge=ge??Ee.media.status!==p.Q.Show)?p.Q.Show:p.Q.Collapse,this.store.dispatch(new ne.p.SetUI(Ee))}toggleDrawer(ge,Ee=!1){const Fe=this.store.selectSnapshot(he.dF.getUI);null==ge&&(ge=Fe.drawer.status==p.Q.Hide?p.Q.Show:p.Q.Hide),Fe.drawer.status=ge,Ee&&(Fe.drawer.userStatusPreference=Fe.drawer.status),this.store.dispatch(new ne.p.SetUI(Fe))}toggleColumn(ge){const Ee=this.store.selectSnapshot(he.dF.getUI);null==ge&&(ge=Ee.column.status!==p.Q.Show),Ee.column.status=ge?p.Q.Show:p.Q.Collapse,Ee.column.userStatusPreference=Ee.column.status,this.store.dispatch(new ne.p.SetUI(Ee))}togglePresentation(){this.store.selectSnapshot(g.Pf.getPresentationActive)?this.stopPresentation():this.startPresentation()}startPresentation(){this.store.dispatch(new h.B.TogglePresentation(!0))}stopPresentation(){this.store.dispatch(new h.B.TogglePresentation(!1))}toggleHelp(ge=V.J.Basics){0===this.dialog.openDialogs.length&&this.dialog.open(w,{maxWidth:"100vw",maxHeight:"100vh",height:"100%",width:"100%",data:{tab:ge}})}toggleInteract(ge){this.store.dispatch(new h.B.ToggleWindow(A.U.Interact,ge))}toggleOnDemand(ge){this.store.dispatch(new h.B.SetOnDemand(ge)),this.store.dispatch(new h.B.ToggleWindow(A.U.OnDemand,ge))}togglePlaythrough(ge,Ee){this.store.dispatch(new h.B.SetPlaythroughEnabled(ge)),(0,u.isNil)(Ee)||this.store.dispatch(new h.B.SetForceAudio(Ee))}toggleTutorial(ge){this.store.dispatch(new h.B.ToggleWindow(A.U.Tutorial,ge)),ge&&this.store.dispatch(new h.B.StartTutorial(!0))}toggleWhiteboard(ge){this.store.dispatch(new h.B.ToggleWindow(A.U.Whiteboard,ge)),ge&&this.store.dispatch(new h.B.SetWhiteboardEnabled(!0))}showLabels(ge){const Ee=this.store.selectSnapshot(he.dF.getUI);ge=(0,u.isNil)(ge)?!Ee.labels.shown:ge,Ee.labels.shown=ge,this.store.dispatch(new ne.p.SetUI(Ee))}toggleLabels(ge){this.store.dispatch(new i.Gv(ge))}togglePan(){const ge="pan"===this.store.selectSnapshot(X.x.getPanMode)?"rotate":"pan";this.store.dispatch(new r.vq(ge))}toggleSearch(ge=D.q.List,Ee){const Fe=this.store.selectSnapshot(he.dF.getUI);Fe.search.status=(Ee=Ee??Fe.search.status!==p.Q.Show)?p.Q.Show:p.Q.Collapse,Ee&&(Fe.visibilityLayers.status=p.Q.Collapse,Fe.nodeInfo.status=p.Q.Hide),this.store.dispatch(new h.B.SetSearchDisplayMode(ge)),this.store.dispatch(new ne.p.SetUI(Fe))}toggleLayers(ge){const Ee=this.store.selectSnapshot(g.Pf.getLayout);this.viewUIService.getViewLayout(Ee)===Be.G.Drawer?this.toggleLayersDrawer(ge):this.toggleLayersColumn(ge)}toggleLayersColumn(ge){const Ee=this.store.selectSnapshot(he.dF.getUI);Ee.visibilityLayers.status=(ge=ge??Ee.visibilityLayers.status!==p.Q.Show)?p.Q.Show:p.Q.Collapse,ge&&(Ee.search.status=p.Q.Collapse,Ee.nodeInfo.status=p.Q.Hide),this.store.dispatch(new ne.p.SetUI(Ee))}toggleLayersDrawer(ge){const Ee=this.store.selectSnapshot(g.Pf.getContentMode);this.setContentMode((ge=ge??Ee!==oe.G.VisibilityLayers)?oe.G.VisibilityLayers:null),this.toggleDrawer(ge?p.Q.Show:p.Q.Hide)}toggleNodeInfo(ge){this.setContentMode(ge?oe.G.NodeInfo:null)}toggleLabelInfo(ge){const Ee=this.store.selectSnapshot(he.dF.getVisible(Y.U.Drawer)),Fe=this.store.selectSnapshot(g.Pf.getContentMode);ge=(0,u.isNull)(ge)?!Ee:ge;const $e=this.store.selectSnapshot(_e.y.getSelectedLabel),ot=this.store.selectSnapshot(he.dF.getVisible(Y.U.LabelList)),je=Ee&&ot;if(ge&&$e)this.toggleDrawer(je&&Fe===oe.G.ChapterInfo||$e?.description||$e.contentBlocks?.length>0?p.Q.Show:p.Q.Collapse),je||this.setContentMode(oe.G.LabelInfo);else{if(je&&Fe===oe.G.ChapterInfo)return;this.toggleDrawer(p.Q.Hide)}}playChapterAudio(ge=!1){const Ee=this.store.selectSnapshot(g.Pf.getViewLanguage),Fe=this.store.selectSnapshot(d.N.getSelectedChapter);this.mediaService.stopAllAudio(),this.mediaService.getChapterAudioPlayer(Fe,Ee,ge).then($e=>{if((this.store.selectSnapshot(ve.S.getAutoplayAudio)||ge)&&this.store.selectSnapshot(d.N.getSelectedChapterId)===Fe.id){const xe=this.store.selectSnapshot(ve.S.getAudioMuted);this.mediaService.playAudio(Fe.id,xe)}})}setContentMode(ge){ge||(ge=oe.G.ChapterInfo),this.store.dispatch(new h.B.SetContentMode(ge))}delegateNodeClick(ge,Ee){if(this.clearSelectedLabel(),ge||Ee?.srcEvent.shiftKey)if(Ee?.srcEvent.shiftKey||this.store.selectSnapshot(g.Pf.getMultiPickModeEnabled))this.checkNode(ge);else switch(this.store.selectSnapshot(s.S.getActiveTool)){case y.s.Hide:this.hideNode(ge);break;case y.s.Select:this.selectNode(ge);break;case y.s.Isolate:this.isolateNode(ge);break;case y.s.Fade:this.fadeNode(ge)}else this.clearSelectedNodes()}clearSelectedLabel(){this.store.dispatch(new v.TR)}clearSelectedNodes(){this.store.dispatch(new G.hg),this.store.dispatch(new G.q9(!1))}clearFadedNodes(){const ge=this.store.selectSnapshot(d.N.getSelectedChapterId);this.store.dispatch(new k.a.UndoAll(ge))}checkNode(ge,Ee){void 0!==ge&&(null==Ee&&(Ee=this.store.selectSnapshot(E.z.getNodes)[ge.id].checked),this.store.dispatch(new G.q9(!Ee,[ge.id])),this.store.dispatch(new G.hg(ge.id)))}fadeNode(ge){this.store.dispatch(new G.Jp(o.EC,[ge.id]))}isolateNode(ge){this.store.dispatch(new G.yr(!1)),this.store.dispatch(new G.yr(!0,[ge.id]))}selectNode(ge){const Ee=!this.store.selectSnapshot(E.z.getNodes)[ge.id].checked;this.store.dispatch(new G.q9(!1)),Ee&&(this.store.dispatch(new G.q9(!0,[ge.id])),this.store.dispatch(new G.hg(ge.id))),this.store.dispatch(new i._o(ge));const Fe=this.store.selectSnapshot(g.Pf.getNodeInfoFallback),$e=this.store.selectSnapshot(g.Pf.getViewLanguage);this.store.dispatch(new i.bo(ge,Fe,$e))}hideNode(ge){this.store.dispatch(new G.yr(!1,[ge.id])),this.store.dispatch(new G.q9(!1))}selectLabel(ge,Ee=!1){const{objectId:Fe,states:$e}=ge;this.store.dispatch(new v.TR(ge)),Ee&&Fe&&0===$e.length&&this.store.dispatch(new i.W6(Fe,!0))}applyChapterCamera(ge){if(this.store.selectSnapshot(X.x.getChapterCameraEnabled)){const Ee=this.store.selectSnapshot(X.x.getChapterCameraPositions).get(ge.id)??ge.camera;this.store.dispatch(new r.Ih(Ee.location,ge.camera.action===b.L.FlyTo,void 0,Ee.rotationCenter))}}applyChapterScenegraph(ge){const Ee=this.sceneService.createViewGraph({availableObjects:ge.availableObjects,viewGraphMetadata:this.store.selectSnapshot(s.S.getViewGraphMetadata)});this.store.dispatch(new i.LL(Ee)),this.store.dispatch(new G.IA(ge.id))}playChapterFromStart(){this.store.dispatch(new i.K6)}resetCamera(){const Ee=this.store.selectSnapshot(d.N.getSelectedChapter)?.camera?.location;(0,u.isNil)(Ee)||this.store.dispatch(new r.Ih(Ee))}resetChapter(){this.resetCamera();const ge=this.store.selectSnapshot(d.N.getSelectedChapterId);this.store.dispatch(new k.a.UndoAll(ge)).subscribe(()=>{this.liveAnnouncer.announce("reset complete")}),this.store.dispatch(new G.q9(!1)),this.store.dispatch(new v.S3)}resetUI(){const ge=this.store.selectSnapshot(he.dF.getUI);this.viewUIService.isUIHidden()?Object.keys(ge).forEach(Ee=>{ge[Ee].status=p.Q.Hide}):(this.store.selectSnapshot(I.j.getQuizModeActive)||(ge.drawer.status=ge.drawer.isExpandedInitially?p.Q.Show:p.Q.Hide),Object.keys(ge).forEach(Fe=>{ge[Fe].userStatusPreference?ge[Fe].status=ge[Fe].userStatusPreference:Fe!==Y.U.Drawer&&(ge[Fe].status=p.Q.Show)}),ge.search.status=p.Q.Collapse,ge.visibilityLayers.status=p.Q.Collapse,ge.nodeInfo.status=p.Q.Hide,ge.media.status=p.Q.Collapse,ge.quizPrompt.status=this.store.selectSnapshot(I.j.hasQuiz)?p.Q.Show:p.Q.Hide),this.store.dispatch(new ne.p.SetUI(ge))}resetContentMode(){const Ee=this.store.selectSnapshot(I.j.getQuizModeActive)?oe.G.Quiz:oe.G.ChapterInfo;this.store.dispatch(new h.B.SetContentMode(Ee))}undo(){this.store.dispatch(new k.a.Undo(this.store.selectSnapshot(d.N.getSelectedChapterId))).subscribe(()=>{this.liveAnnouncer.announce("undo complete")})}redo(){this.store.dispatch(new k.a.Redo(this.store.selectSnapshot(d.N.getSelectedChapterId))).subscribe(()=>{this.liveAnnouncer.announce("redo complete")})}toggleTools(ge){const Ee=this.store.selectSnapshot(he.dF.getUI);Ee.tools.status=(ge=ge??Ee.tools.status!==p.Q.Show)?p.Q.Show:p.Q.Collapse,this.store.dispatch(new ne.p.SetUI(Ee))}closeToolbar(){const ge=this.store.selectSnapshot(he.dF.getUI);ge.media.status=p.Q.Hide,ge.tools.status=p.Q.Hide,ge.visibilityLayers.status=p.Q.Hide,this.selectTool(y.s.Select),this.store.dispatch(new ne.p.SetUI(ge))}normalizeQueryParams(ge){const Ee={...ge};return{id:(0,_.mF)(Ee),type:(0,_.lm)(Ee),lang:ge.lang}}sanitizeRouteId(ge){return ge=ge.replace(/\.json$/,""),this.location.replaceState("view",`?id=${ge}`),ge}openInNewTab(){const ge=window.document.location.href;window.open(ge)}getComputedTransform(ge){const $e=getComputedStyle(ge).transform.replace("matrix3d","").replace("matrix","").replace("(","").replace(")","").split(",").map(xe=>xe.trim()).map(xe=>parseInt(xe,10)),ot=16===$e.length?$e[12]:$e[4],je=16===$e.length?$e[13]:$e[5];return Number.isNaN(ot)||Number.isNaN(je)?null:{x:ot,y:je}}setUI(ge){let Ee=new x.XF;Ee=(0,x.Sy)(Ee,ge.xrUIConfig),Ee=(0,x.Sy)(Ee,ge.quizUIConfig),Ee=(0,x.Sy)(Ee,ge.apiUIConfig),Ee=(0,x.Sy)(Ee,ge.urlUIConfig),Ee=(0,x.Sy)(Ee,ge.chapterUIConfig),Ee=(0,x.Sy)(Ee,ge.baseUIConfig),this.store.selectSnapshot(we.U.getPrefersReducedMotion)&&(Ee.media=Ve.Y.Full);const Fe=this.store.selectSnapshot(he.dF.getUI),$e=(0,x.Hz)(Fe,Ee);this.store.dispatch(new ne.p.SetUI($e))}setViewLanguage(ge="en"){this.store.dispatch(new h.B.SetViewLanguage(ge))}setViewLogos(ge){this.store.dispatch(new Oe.v9(ge))}setHeaderLogos(ge){this.store.dispatch(new Oe.vf(ge))}setAnatomyDescriptionFallback(ge){this.store.dispatch(new h.B.SetNodeInfoConfig(ge))}observeMaterialOverlay(){this.materialOverlayObserver=new MutationObserver(()=>{this.materialOverlayOut$.next(this.isMaterialOverlayOut())}),this.materialOverlayObserver.observe(this.overlayContainer.getContainerElement(),{childList:!0})}unobserveMaterialOverlay(){this.materialOverlayObserver&&this.materialOverlayObserver.disconnect(),this.materialOverlayOut$.complete()}isMaterialOverlayOut(){return this.overlayContainer.getContainerElement().childElementCount>0}isMaterialMenuOut(){return null!==this.overlayContainer.getContainerElement().querySelector("[role=menu]")}elementHasFocus(ge){return!(!ge||!ge.contains(document.activeElement))}static#e=this.\u0275fac=function(Ee){return new(Ee||Ke)(l.KVO(L.bZ),l.KVO(m.il),l.KVO(q.aZ),l.KVO(C),l.KVO(Te.u),l.KVO(Ce.w),l.KVO(W.d),l.KVO(z.e),l.KVO(tt.Ai),l.KVO(st.Sf),l.KVO(Je.c))};static#t=this.\u0275prov=l.jDH({token:Ke,factory:Ke.\u0275fac,providedIn:"root"})}return Ke})()},6795:(le,N,n)=>{"use strict";n.d(N,{s:()=>c});var e=n(66897),t=n(29160),s=n(65294);class c{static#e=this.store=null;static#t=this.snackBar=null;static#n=this.router=null;static#s=this.appVersion="";static#i=this._offlineModelIDs=new t.t([]);static#o=this._offlineModelIDs$=c._offlineModelIDs.asObservable();static getOfflineModelIDs(){return c._offlineModelIDs$}static setOfflineModelIDs(P){c._offlineModelIDs.next(P)}static getOfflineModelIDList(){return this._offlineModelIDs.getValue()}static setStore(P){c.store=P}static setServices(P,S){c.rpcService=P,c.applicationEventService=S}static setSnackBar(P){c.snackBar=P}static setRouter(P){c.router=P}static debug(P){this.fire(s.F.NativeDebugMessage,P)}static fire(P,S){c.applicationEventService&&c.applicationEventService.fireEvent(P,S)}on(P,S){c.rpcService&&c.rpcService.getEvent(P,!1).subscribe(S)}send(P,S){let a=null,f={};switch(P){case e.t.NativeErrorMessage:a=c.snackBar.open(S,"OK",{duration:6e3,verticalPosition:"top"}),a.onAction().subscribe(()=>{a.dismiss()});break;case e.t.NativeSetAppVersion:c.appVersion=S.appVersion;break;case e.t.NativeRedirect:f=JSON.parse(S.queryItems),c.router.navigate([S.url],{queryParams:f});break;case e.t.NativeReload:window.location.href=S.url;break;case e.t.NativeOfflineModelIds:c.setOfflineModelIDs(S.modelIds);break;default:c.debug("unprocessed HumanWindowAPI send "+P)}}}},66897:(le,N,n)=>{"use strict";n.d(N,{t:()=>e});var e=function(t){return t.AnnotationsCreate="annotations.create",t.AnnotationsDestroy="annotations.destroy",t.AnnotationsInfo="annotations.info",t.AnnotationsSetDescription="annotations.setDescription",t.AnnotationsSetLabelsShown="annotations.setLabelsShown",t.AnnotationsSetTitle="annotations.setTitle",t.AnnotationsUpdate="annotations.update",t.AnnotationsSetEnabled="annotations.setEnabled",t.CameraInfo="camera.info",t.CameraOrbit="camera.orbit",t.CameraPan="camera.pan",t.CameraReset="camera.reset",t.CameraSet="camera.set",t.CameraZoom="camera.zoom",t.setCameraMode="camera.setCameraMode",t.CameraDisableChapterCamera="camera.disableChapterCamera",t.CameraEnableChapterCamera="camera.enableChapterCamera",t.GetAnnotationInfo="annotations.info",t.HideAnnotations="annotations.hide",t.HotspotsCreate="hotspots.create",t.HotspotsDestroy="hotspots.destroy",t.HotspotsHide="hotspots.hide",t.HotspotsInfo="hotspots.info",t.HotspotsShow="hotspots.show",t.HotspotsTypes="hotspots.types",t.HotspotsUpdate="hotspots.update",t.HumanInfo="human.info",t.HumanCanvasInfo="human.canvasInfo",t.InputDisable="input.disable",t.InputEnable="input.enable",t.LabelsCreate="labels.create",t.LabelsDestroy="labels.destroy",t.LabelsInfo="labels.info",t.LabelsHide="labels.hide",t.LabelsSetEnabled="labels.setEnabled",t.LabelsShow="labels.show",t.LabelsUpdate="labels.update",t.LabelsCanvasUpdate="labels.canvasUpdate",t.LabelsSetScale="labels.setScale",t.NativeErrorMessage="native.errorMessage",t.NativeSetSdkOffline="native.setSdkOffline",t.NativeSetAppVersion="native.setAppVersion",t.NativeRedirect="native.redirect",t.NativeReload="native.reload",t.NativeOfflineModelIds="native.offlineModelIDs",t.QuizInfo="quiz.info",t.QuizEnter="quiz.enter",t.QuizExit="quiz.exit",t.QuizQuestion="quiz.currentQuestion",t.QuizSubmit="quiz.submit",t.QuizNextQuestion="quiz.next",t.QuizPreviousQuestion="quiz.previous",t.QuizSelectQuestion="quiz.select",t.QuizSet="quiz.set",t.QuizReset="quiz.reset",t.SceneMetaData="scene.metadata",t.SceneSetHighlightColor="scene.setHighlightColor",t.SceneColorObject="scene.colorObject",t.SceneDisableHighlight="scene.disableHighlight",t.SceneEnableHighlight="scene.enableHighlight",t.SceneGetColor="scene.getColor",t.SceneInfo="scene.info",t.SceneLoad="scene.load",t.ScenePick="scene.pick",t.SceneReset="scene.reset",t.SceneSelectObjects="scene.selectObjects",t.SceneShowObjects="scene.showObjects",t.SceneTransformObject="scene.transformObject",t.SceneUncolorObject="scene.uncolorObject",t.SceneSnapshot="scene.snapshot",t.SceneCapture="scene.capture",t.SceneRestore="scene.restore",t.SceneEnableXrayMode="scene.enableXray",t.SceneDisableXrayMode="scene.disableXray",t.SceneSetLayersSliderPosition="scene.setLayersSliderPosition",t.SceneGetLayers="scene.getLayers",t.SceneGetPositions="scene.getPositions",t.SceneSetBaseDirectory="scene.setBaseDirectory",t.ShowAnnotations="annotations.show",t.SetAnnotationsShown="annotations.setShown",t.TimelineInfo="timeline.info",t.TimelineQuery="timeline.query",t.TimelineNext="timeline.nextChapter",t.TimelinePause="timeline.pause",t.TimelinePlay="timeline.play",t.TimelinePrev="timeline.previousChapter",t.TimelineSet="timeline.set",t.TimelineSetPlaybackSpeed="timeline.setPlaybackSpeed",t.TimelineGetPlaybackSpeed="timeline.getPlaybackSpeed",t.UIGetBackground="ui.getBackground",t.UIGetDisplay="ui.getDisplay",t.UIGetWorldPosition="ui.getWorldPosition",t.UISetBackground="ui.setBackground",t.UIPresetBackground="ui.presetBackground",t.UISetDisplay="ui.setDisplay",t.UIResetDisplay="ui.resetDisplay",t.UISnapshot="ui.snapshot",t.focusObject="focus.focusObject",t.dissectSetEnabled="dissect.setEnabled",t.pickSingleSetEnabled="pick.single.setEnabled",t.pickMultiSetEnabled="pick.multi.setEnabled",t.getCanvasPos="scene.getCanvasPos",t.sceneSetClickMode="scene.setClickMode",t.sceneGetClickMode="scene.getClickMode",t.IsolateObject="scene.isolateObject",t.UISetOndemand="ui.setOndemand",t.UISetLoadingExperience="ui.setLoadingExperience",t.UISetScrollCaptureMode="ui.setScrollCaptureMode",t.UISetTutorial="ui.setTutorial",t.UISetQuizLock="ui.setQuizLock",t.UIGetWindow="ui.getWindow",t.SceneGetVariantSchemas="scene.getVariantSchemas",t}(e||{})},63745:(le,N,n)=>{"use strict";function O(r){const{id:_,s:u,m:l,be:m,b:C}=r;let b="";if(_)b=_;else if(m)b=m;else if(C){const R=parseInt(C,10);b=Number.isNaN(R)?"":function a(r){const u=(b,R)=>[Math.floor(b/R),b%R],l=[];let C,m=r;for(;m>0;)[m,C]=u(m,62),l.unshift("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz"[C]);return l.join("")}(R)}else l&&(b=function f(r,_="male"){return r.includes("/")?r:`production/${_}Adult/${r}`}(l,"female"===u?"female":"male"));return P(b)}function P(r){return r.replace(/\.json$/,"")}function S(r){return O(r).includes("/")?"module":"bookmark"}n.d(N,{lm:()=>S,mF:()=>O,u2:()=>P}),n(11789)},9984:(le,N,n)=>{"use strict";n.d(N,{I:()=>e});var e=function(t){return t.Inactive="Inactive",t.Valid="Valid",t.Invalid="Invalid",t.Missing="Missing",t}(e||{})},59038:(le,N,n)=>{"use strict";n.d(N,{H:()=>e});const e={inline:!1,"immersive-ar":!1,"immersive-vr":!1}},48570:(le,N,n)=>{"use strict";var e,t;n.d(N,{W:()=>e}),(t=e||(e={})).SetEnabled=(()=>{class g{static#e=this.type="[XR] Set XR Enabled";constructor(h){this.enabled=h}}return g})(),t.SetSession=(()=>{class g{static#e=this.type="[XR] Set XR Session";constructor(h,o,v,d){this.active=h,this.session=o,this.sessionMode=v,this.supportedModes=d}}return g})(),t.SetXRState=(()=>{class g{static#e=this.type="[XR] Set XR State";constructor(h){this.value=h}}return g})(),t.EnterXR=(()=>{class g{static#e=this.type="[XR] Enter XR";constructor(h="immersive-vr"){this.sessionMode=h}}return g})(),t.ExitXR=(()=>{class g{static#e=this.type="[XR] Exit XR";constructor(h=!1){this.closeTab=h}}return g})(),t.SetARSelectingLocation=(()=>{class g{static#e=this.type="[XR] Set XR Selecting Location";constructor(h){this.selectingLocation=h}}return g})(),t.SetARSelectingLocationVisible=(()=>{class g{static#e=this.type="[XR] Set XR Selecting Location Visible";constructor(h){this.visible=h}}return g})(),t.SetARLocation=(()=>{class g{static#e=this.type="[XR] Set AR Location";constructor(){}}return g})(),t.SetARLocationSuccess=(()=>{class g{static#e=this.type="[XR] Set AR Location Success";constructor(){}}return g})(),t.SetARLocationFail=(()=>{class g{static#e=this.type="[XR] Set AR Location Fail";constructor(){}}return g})()},32724:(le,N,n)=>{"use strict";n.d(N,{U:()=>g});var e=n(92014),t=n(59038),s=n(48570),c=n(51196),O=n(17215),P=n(90699),S=n(36860),a=n(9984),f=n(54438),E=function(p,h,o,v){var _,d=arguments.length,r=d<3?h:null===v?v=Object.getOwnPropertyDescriptor(h,o):v;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(p,h,o,v);else for(var u=p.length-1;u>=0;u--)(_=p[u])&&(r=(d<3?_(r):d>3?_(h,o,r):_(h,o))||r);return d>3&&r&&Object.defineProperty(h,o,r),r},y=function(p,h){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(p,h)};const i={enabled:!1,active:!1,requesting:!1,selectingLocation:!1,error:!1,session:null,sessionMode:null,supportedModes:{...t.H},platform:P.I.All,placementState:a.I.Inactive};let g=class xs{constructor(h,o,v){this.xrService=h,this.storageService=o,this.platform=v}ngxsOnInit(h){const{IOS:o,ANDROID:v}=this.platform;h.patchState({enabled:!1,platform:v?P.I.Android:o?P.I.iOS:P.I.All}),this.xrService.getSelecting().subscribe(r=>{h.patchState({selectingLocation:r})}),this.xrService.getPlacementState().subscribe(r=>{h.patchState({placementState:r})})}static getXREnabled(h){return h.enabled}static getXRSupported(h,o){return h&&Object.values(o).some(v=>v)}static getVREnabled(h,o){return h&&o["immersive-vr"]}static getAREnabled(h,o){return h&&o["immersive-ar"]}static getNativeAREnabled(h,o){return h&&"ios"===o}static getXRActive(h){return h.active}static getVRActive(h,o){return h&&"immersive-vr"===o}static getARActive(h,o){return h&&"immersive-ar"===o}static getXROverlayType(h){return h.session?.domOverlayState?.type||""}static getXRSessionMode(h){return h.sessionMode}static getXRSupportedModes(h){return h.supportedModes}static getXRError(h){return!0===h.error}static getXRRequesting(h){return h.requesting}static getXRPlatform(h){return h.platform}static getSelectingLocation(h){return h.selectingLocation}static getPlacementState(h){return h.placementState}setXRState(h,o){h.setState(o.value)}setEnabled(h,o){h.patchState({enabled:o.enabled})}enterXR(h,o){h.patchState({requesting:!0}),this.xrService.enterXR(o.sessionMode).then(()=>{console.log("Enter XR Success"),h.patchState({error:!1}),"immersive-ar"===o.sessionMode&&h.dispatch(new s.W.SetARSelectingLocation(!0))}).catch(v=>{console.warn("Enter XR Fail",v),h.patchState({error:!0})}).finally(()=>{h.patchState({requesting:!1})})}exitXR(h,{closeTab:o}){this.xrService.exitXR(),o&&window.close(),console.log("Exit XR Success")}setSession(h,o){h.patchState({active:o.active,session:o.session,sessionMode:o.sessionMode,supportedModes:{...t.H,...o.supportedModes},error:!1})}setXRSelectingLocation(h,{selectingLocation:o}){this.xrService.selectingLocation=o,h.patchState({selectingLocation:o}),h.dispatch(new s.W.SetARSelectingLocationVisible(!0))}setARSelectingLocationVisible(h,{visible:o}){this.xrService.selectingLocationVisible=o}SetXRLocation(h){this.xrService.selectLocation().then(o=>{h.dispatch(o?new s.W.SetARLocationSuccess:new s.W.SetARLocationFail)}).catch(o=>{h.dispatch(new s.W.SetARLocationFail)})}static#e=this.\u0275fac=function(o){return new(o||xs)(f.KVO(c.S),f.KVO(O.n$),f.KVO(S.OD))};static#t=this.\u0275prov=f.jDH({token:xs,factory:xs.\u0275fac})};E([(0,e.rc)(s.W.SetXRState),y("design:type",Function),y("design:paramtypes",[Object,s.W.SetXRState]),y("design:returntype",void 0)],g.prototype,"setXRState",null),E([(0,e.rc)(s.W.SetEnabled),y("design:type",Function),y("design:paramtypes",[Object,s.W.SetEnabled]),y("design:returntype",void 0)],g.prototype,"setEnabled",null),E([(0,e.rc)(s.W.EnterXR),y("design:type",Function),y("design:paramtypes",[Object,s.W.EnterXR]),y("design:returntype",void 0)],g.prototype,"enterXR",null),E([(0,e.rc)(s.W.ExitXR),y("design:type",Function),y("design:paramtypes",[Object,s.W.ExitXR]),y("design:returntype",void 0)],g.prototype,"exitXR",null),E([(0,e.rc)(s.W.SetSession),y("design:type",Function),y("design:paramtypes",[Object,s.W.SetSession]),y("design:returntype",void 0)],g.prototype,"setSession",null),E([(0,e.rc)(s.W.SetARSelectingLocation),y("design:type",Function),y("design:paramtypes",[Object,s.W.SetARSelectingLocation]),y("design:returntype",void 0)],g.prototype,"setXRSelectingLocation",null),E([(0,e.rc)(s.W.SetARSelectingLocationVisible),y("design:type",Function),y("design:paramtypes",[Object,s.W.SetARSelectingLocationVisible]),y("design:returntype",void 0)],g.prototype,"setARSelectingLocationVisible",null),E([(0,e.rc)(s.W.SetARLocation),y("design:type",Function),y("design:paramtypes",[Object]),y("design:returntype",void 0)],g.prototype,"SetXRLocation",null),E([(0,e.MD)(),y("design:type",Function),y("design:paramtypes",[Object]),y("design:returntype",void 0)],g,"getXREnabled",null),E([(0,e.Um)({injectContainerState:!1}),(0,e.MD)([g.getXREnabled,g.getXRSupportedModes]),y("design:type",Function),y("design:paramtypes",[Boolean,Object]),y("design:returntype",Boolean)],g,"getXRSupported",null),E([(0,e.Um)({injectContainerState:!1}),(0,e.MD)([g.getXREnabled,g.getXRSupportedModes]),y("design:type",Function),y("design:paramtypes",[Boolean,Object]),y("design:returntype",void 0)],g,"getVREnabled",null),E([(0,e.Um)({injectContainerState:!1}),(0,e.MD)([g.getXREnabled,g.getXRSupportedModes]),y("design:type",Function),y("design:paramtypes",[Boolean,Object]),y("design:returntype",void 0)],g,"getAREnabled",null),E([(0,e.Um)({injectContainerState:!1}),(0,e.MD)([g.getXREnabled,g.getXRPlatform]),y("design:type",Function),y("design:paramtypes",[Boolean,String]),y("design:returntype",void 0)],g,"getNativeAREnabled",null),E([(0,e.MD)(),y("design:type",Function),y("design:paramtypes",[Object]),y("design:returntype",void 0)],g,"getXRActive",null),E([(0,e.Um)({injectContainerState:!1}),(0,e.MD)([g.getXRActive,g.getXRSessionMode]),y("design:type",Function),y("design:paramtypes",[Boolean,String]),y("design:returntype",void 0)],g,"getVRActive",null),E([(0,e.Um)({injectContainerState:!1}),(0,e.MD)([g.getXRActive,g.getXRSessionMode]),y("design:type",Function),y("design:paramtypes",[Boolean,String]),y("design:returntype",void 0)],g,"getARActive",null),E([(0,e.MD)(),y("design:type",Function),y("design:paramtypes",[Object]),y("design:returntype",void 0)],g,"getXROverlayType",null),E([(0,e.MD)(),y("design:type",Function),y("design:paramtypes",[Object]),y("design:returntype",void 0)],g,"getXRSessionMode",null),E([(0,e.MD)(),y("design:type",Function),y("design:paramtypes",[Object]),y("design:returntype",void 0)],g,"getXRSupportedModes",null),E([(0,e.MD)(),y("design:type",Function),y("design:paramtypes",[Object]),y("design:returntype",void 0)],g,"getXRError",null),E([(0,e.MD)(),y("design:type",Function),y("design:paramtypes",[Object]),y("design:returntype",void 0)],g,"getXRRequesting",null),E([(0,e.MD)(),y("design:type",Function),y("design:paramtypes",[Object]),y("design:returntype",void 0)],g,"getXRPlatform",null),E([(0,e.MD)(),y("design:type",Function),y("design:paramtypes",[Object]),y("design:returntype",void 0)],g,"getSelectingLocation",null),E([(0,e.MD)(),y("design:type",Function),y("design:paramtypes",[Object]),y("design:returntype",void 0)],g,"getPlacementState",null),g=E([(0,e.Uw)({name:"xr",defaults:i}),y("design:paramtypes",[c.S,O.n$,S.OD])],g)},45861:(le,N,n)=>{"use strict";n.d(N,{p:()=>s,w:()=>t});var e=n(65776);function t(c,O){return`${c}#${Object.entries(O).reduce((a,[f,E])=>{if(f&&E){const y=`${f}=${encodeURI(E)}`;a.push(y)}return a},[]).join("&")}`}function s(c){return c.reduce((O,P)=>{if(P.type===e.m.CTA){const S=P,{action:a,url:f}=S;"ar-link"===a&&f.endsWith(".usdz")&&O.push(f)}return O},[])}},66915:(le,N,n)=>{"use strict";n.d(N,{z:()=>c});var e=n(92014),t=n(32724),s=n(54438);let c=(()=>{class O{static#e=this.\u0275fac=function(a){return new(a||O)};static#t=this.\u0275mod=s.$C({type:O});static#n=this.\u0275inj=s.G2t({imports:[e.rK.forFeature([t.U])]})}return O})()},51196:(le,N,n)=>{"use strict";n.d(N,{S:()=>R});var e=n(28407),t=n(59038),s=n(11724),O=n(9556),P=n(38472),S=n(48570),a=n(46799),f=n(79805),E=n(29160),y=n(85052),i=n(9984),g=n(54438),p=n(92014);const h=[120,120,120,255].map(A=>A/255),u=[1,1,1],l=[1,0,0],m=Math.cos(30*Math.PI/180),C=[0,1,0],b=[0,0,0,1];let R=(()=>{class A{constructor(k,V,W){this.store=k,this.engineService=V,this.engineRendererService=W,this.presentingXR=null,this._trackingPose=!1,this._placementState=new E.t(i.I.Inactive),this.objectSelectedSubject=new y.B,this.xrViewerSpace=null,this.xrHitTestSource=null,this.hitTestResult=null,this.xrAnchor=null,this.hitTestReticle=null,this.hitTestReticleMaterial=null,this._selectingLocation=new E.t(!1),this._selectingLocationVisible=!0}initXR(k){var V=this;const{renderer:W}=k,T={...t.H},x=function(){var I=(0,e.A)(function*(){if(V.presentingXR){const D=V.presentingXR,L=yield V.getRefSpace(D.session,k);D===V.presentingXR&&(W.xrRefSpace=L)}});return function(){return I.apply(this,arguments)}}(),z=({frame:I,inputSource:D})=>{if("screen"===D.targetRayMode){const L=I.getPose(D.targetRaySpace,k.renderer.xrRefSpace),Q=this.engineRendererService.pickMatrix(L.transform.matrix);this.objectSelectedSubject.next(Q)}};if(!this._xr){const I=ie=>(0,e.A)(function*(){const{presenting:se,session:Z,sessionMode:de,supported:ae}=ie;if(se?V.presentingXR=ie:ie===V.presentingXR&&(V.presentingXR=null,W.xrSession=null,W.xrRefSpace=null,k.contentNode.setMatrix([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])),Z&&!W.xrSession){const q=yield V.getRefSpace(Z,k);W.xrRefSpace=q,W.xrSession=Z,Z.addEventListener("reset",x)}se||(V._trackingPose=!1,V.placementState=i.I.Inactive),V.initializeHitTests(),se&&"immersive-vr"===de?k.renderer.setXRClearColor(...h):k.renderer.setXRClearColor(0,0,0,0),se&&"immersive-ar"===de&&V.presentingXR?.session?.addEventListener("select",z),T[de]=ae,V.store.dispatch(new S.W.SetSession(null!==V.presentingXR,Z,V.presentingXR?.sessionMode||null,T))}),D=["local-floor","bounded-floor","hand-tracking"];W.extensions.includes("OCULUS_multiview")&&D.push("layers");const L=new s.XR("immersive-vr",{optionalFeatures:D}),Q=new s.XR("immersive-ar",{requiredFeatures:["local-floor"],optionalFeatures:["dom-overlay","hit-test","anchors"],domOverlay:{root:document.body}});this._xr={"immersive-vr":L,"immersive-ar":Q},L.on("*",I(L)),Q.on("*",I(Q)),k.renderer.on("xrframe",({frame:ie,viewerPose:se})=>{if(this._trackingPose=!!se,!se)return void(this.placementState=i.I.Missing);let Z=null;if(this.selectingLocation&&this.xrHitTestSource){const de=ie.getHitTestResults(this.xrHitTestSource);this.hitTestResult=de.length?de[0]:null,Z=this.hitTestResult?.getPose(k.renderer.xrRefSpace)}if(Z){const de=s.vec3Pool.get(),{x:ae,y:q,z:K,w:j}=Z.transform.orientation;O.set(b,ae,q,K,j),P.transformQuat(de,C,b);const M=P.dot(de,C);s.vec3Pool.release(de),this.placementState=M<m?i.I.Invalid:i.I.Valid}else this.placementState=i.I.Missing;if(this.hitTestReticle&&this.selectingLocationVisible&&(Z?(this.hitTestReticle.parent=k.rootNode,this.hitTestReticle.setWorldMatrix(Z.transform.matrix),P.copy(this.hitTestReticleMaterial.baseColor,this.placementState===i.I.Invalid?l:u),this.hitTestReticleMaterial.emit("change",{material:this.hitTestReticleMaterial,property:"baseColor"})):this.hitTestReticle.parent=null),this.xrAnchor&&ie.trackedAnchors?.has(this.xrAnchor)){const de=ie.getPose(this.xrAnchor.anchorSpace,k.renderer.xrRefSpace);k.contentNode.setMatrix(de.transform.matrix)}})}}destroyXR(){this._xr?.["immersive-ar"].destroy(),this._xr?.["immersive-vr"].destroy(),this._xr=null,this.presentingXR=null}enterXR(k="immersive-vr"){if(!this._xr)throw new Error("Cannot enter XR. XR service has been destroyed.");return this._xr[k].enter()}exitXR(){this.hitTestReticle&&((0,s.traverseSceneNodes)(this.hitTestReticle,k=>{k instanceof s.BioDigitalMeshNode&&(k.geometry?.destroy(),k.geometry=null,k.material?.destroy(),k.material=null)}),this.hitTestReticle.destroy(),this.hitTestReticle=null,this.hitTestReticleMaterial=null),this.presentingXR?.exit()}getObjectSelecting(){return this.objectSelectedSubject.asObservable()}getSelecting(){return this._selectingLocation.asObservable()}getPlacementState(){return this._placementState.asObservable()}get trackingPose(){return this._trackingPose}get placementState(){return this._placementState.value}set placementState(k){k!==this._placementState.value&&this._placementState.next(k)}get session(){return this.presentingXR?.session??null}get canSelectLocation(){return!!this.presentingXR?.session?.requestHitTestSource&&this.presentingXR.session.enabledFeatures.indexOf("hit-test")>=0}get selectingLocation(){return this._selectingLocation.value}set selectingLocation(k){k!==this._selectingLocation.value&&(this._selectingLocation.next(k),this.engineService.engine.contentNode.parent=k?null:this.engineService.engine.rootNode)}get selectingLocationVisible(){return this._selectingLocationVisible}set selectingLocationVisible(k){this._selectingLocationVisible=k}selectLocation(){var k=this;return(0,e.A)(function*(){let V=!1;if(k.selectingLocation&&k.hitTestResult&&(k.selectingLocation=!1,"createAnchor"in k.hitTestResult))try{k.xrAnchor=yield k.hitTestResult.createAnchor(void 0),V=!0}catch(W){console.log("failed to get xrAnchor",W)}return V})()}getRefSpace(k,V){var W=this;return(0,e.A)(function*(){let T=null;try{T=yield k.requestReferenceSpace("bounded-floor")}catch{T=yield k.requestReferenceSpace("local-floor")}if(W.canSelectLocation)return T;const{bounds:x,story:z}=V,{module:I}=z,D=P.distance(x.min,x.max),L=z.module.chapters[z.activeChapterIndex],Q=L.jumpTo||L.flyTo||I.camera,ie=s.vec3Pool.get(),se=s.vec3Pool.get(),Z=s.vec3Pool.get(),de=s.vec3Pool.get(),ae=Q?.eye||I.camera?.eye;if(ae){const{x:te,y:F,z:w}=ae;P.set(ie,te,F,w),P.scale(ie,ie,s.BIODIGITAL_SCENE_SCALE)}const q=Q?.look||I.camera?.look;if(q){const{x:te,y:F,z:w}=q;P.set(se,te,F,w),P.scale(se,se,s.BIODIGITAL_SCENE_SCALE)}P.subtract(Z,ie,se),P.set(de,Z[0],Z[1],0);const K=[0,0,0,1],j=-Math.atan2(Z[0],Z[2]);O.fromEuler(K,0,180*j/Math.PI,0);const M={x:K[0],y:K[1],z:K[2],w:K[3]},$=Math.max(.6,.6*D,P.length(de)),ue={x:0,y:Math.max("screen-space"!==k.interactionMode?1.6-ie[1]:0,-x.min[1]),z:-$,w:1};s.vec3Pool.release(de),s.vec3Pool.release(Z),s.vec3Pool.release(se),s.vec3Pool.release(ie);const H=new XRRigidTransform(ue,M);return T.getOffsetReferenceSpace(H)})()}resetHitTests(){this.selectingLocation=!1,this.xrHitTestSource?.cancel(),this.xrHitTestSource=null,this.xrViewerSpace=null,this.xrHitTestSource=null,this.xrAnchor=null,this.hitTestReticle&&(this.hitTestReticle.parent=null)}initializeHitTests(){var k=this;return(0,e.A)(function*(){if(k.canSelectLocation)if(k.presentingXR?.session){if(k.xrViewerSpace=yield k.presentingXR.session.requestReferenceSpace("viewer"),k.xrHitTestSource=yield k.presentingXR.session.requestHitTestSource({space:k.xrViewerSpace}),!k.hitTestReticle){const V=yield fetch("assets/images/ar-position-reticle.png").then(T=>T.blob()),W=yield(0,s.loadImageBlobTexture)(V,{name:"ar-position-reticle"});k.hitTestReticle=new s.SceneNode,k.hitTestReticleMaterial=new s.UnlitMaterial({baseColor:[1,1,1],opacity:.4,baseColorMaps:[{texture:W,blendMode:"multiply"}],opacityMaps:[{texture:W,channel:"a"}]}),k.hitTestReticleMaterial.on("destroy",()=>{W.destroy()}),k.hitTestReticle.add(new s.BioDigitalMeshNode(new s.BioDigitalGeometry({position:[-1,0,1,1,0,1,1,0,-1,-1,0,-1],texcoord:[1,0,0,0,0,1,1,1],indices:[0,1,2,0,2,3]}),k.hitTestReticleMaterial,{scale:[.25,.25,.25]}))}}else k.resetHitTests();else k.resetHitTests()})()}static#e=this.\u0275fac=function(V){return new(V||A)(g.KVO(p.il),g.KVO(f.y),g.KVO(a.z))};static#t=this.\u0275prov=g.jDH({token:A,factory:A.\u0275fac,providedIn:"root"})}return A})()},24418:(le,N,n)=>{"use strict";n.d(N,{c:()=>O});var e=n(27180),t=n(17766),s=n(12215),c=n(92811);const O={production:!0,assetDomain:"assets-human.biodigital.com",supportEmail:"support@biodigital.com",productKey:"ma_qXLcFIrsaG",googleAuthKey:"66261904577-061oin26uo7sor0vrqc8dnn105irq82n.apps.googleusercontent.com",googleAnalyticsId:"UA-1141985-30",linkedinId:"2641938",pendoId:"3a783681-e53b-4ebd-69c0-788bbae48f13",hubspotId:"23868815",recaptchaV3Key:"6LdvZvcUAAAAAM0Z1St9WQXwvSYd__hMUY2WZ6um",recaptchaV2Key:"6LdtyhsUAAAAAF-hCYS1co8ZhnAEnzHlNhRMHSxE",application:e.c.Studio,deploy:s.Z.Production,platform:c.N.Web,exportType:t.c.Bookmark,offline:!1,native:!0,minPasswordLength:8}},27180:(le,N,n)=>{"use strict";n.d(N,{c:()=>e});var e=function(t){return t.Loft="Loft",t.Studio="Studio",t.Viewer="Viewer",t.All="",t}(e||{})},12215:(le,N,n)=>{"use strict";n.d(N,{Z:()=>e});var e=function(t){return t.Local="Local",t.QA="QA",t.Staging="Staging",t.Production="Production",t}(e||{})},92811:(le,N,n)=>{"use strict";n.d(N,{N:()=>e});var e=function(t){return t.Web="web",t.SDK="sdk",t}(e||{})},90699:(le,N,n)=>{"use strict";n.d(N,{I:()=>e});var e=function(t){return t.All="all",t.iOS="ios",t.Android="android",t}(e||{})},287:(le,N,n)=>{"use strict";n.d(N,{AY:()=>E,FV:()=>f,Nq:()=>g,dU:()=>S,kK:()=>p,sO:()=>a});var e=n(44867),t=n(56343);const P={trueWins:h=>({result:h.votesFor.length>0,dissenters:[...h.votesAgainst]}),falseWins:h=>({result:h.votesAgainst.length>0,dissenters:[...h.votesFor]}),majorityWins:h=>{const o=h.votesFor.length>h.votesAgainst.length;return{result:o,dissenters:o?[...h.votesAgainst]:[...h.votesFor]}}};function S(h,o){return h.reduce((v,d)=>(v[d]=o[d]||!1,v),{})}function a(h,o){return Object.keys(h).reduce((d,r)=>(d[r]=S(o,h[r]),d),{})}function f(h,o){const d=h.map(_=>(0,e.dV)(o,_).depth);return Math.max(0,...d)-1}function E(h,o,v){return(0,e.y$)(h,o).filter(r=>r&&(0,e.dV)(h,r).depth===v)}function g(h,o,v){return Object.keys(o).reduce((r,_)=>{const u=o[_],l=v[_]||t.t.MajorityWins,{result:m,dissenters:C}=P[l](u);return r[_]={id:h,result:m,dissenters:C,voters:[...u.votesFor,...u.votesAgainst]},r},{})}function p(h,o,v,d){const r=Object.keys(d);return{results:v.reduce((u,l)=>{const m=(0,e.IA)(h,l),C=m.map(A=>({[A]:o[A]||S(r,(0,e._D)(h,A,r))}));m.forEach(A=>{delete o[A]});const R=g(l,function y(h,o){return h.reduce((v,d)=>{const r=function i(h,o){return h.reduce((v,d)=>{const r=Object.keys(d)[0];return d[r][o]?v.votesFor.push(r):v.votesAgainst.push(r),v},{votesFor:[],votesAgainst:[]})}(o,d);return v[d]=r,v},{})}(r,C),d);return o[l]=Object.entries(R).reduce((A,[G,k])=>(A[G]=k.result,A),{}),u.push(R),u},[]),remainingVoters:o}}},44867:(le,N,n)=>{"use strict";n.d(N,{DS:()=>P,IA:()=>y,If:()=>m,K$:()=>C,KJ:()=>V,Nk:()=>k,Sg:()=>c,TJ:()=>_,Wy:()=>d,_D:()=>i,bd:()=>R,dV:()=>a,fm:()=>r,ir:()=>f,iu:()=>S,jX:()=>p,u7:()=>A,ug:()=>h,vU:()=>b,xe:()=>g,y$:()=>E});var e=n(23881),t=n(49204);function c(W,T){S(W,T);const x=a(W,T.id);W.roots[x.id]=x}function P(W,T,x=!1,z="ascending"){const I=x?[T]:[];let D=W.predecessors[T];for(;D;)I.push(D),D=W.predecessors[D];return"descending"===z&&I.reverse(),I}function S(W,T){W.nodes[T.id]||(W.nodes[T.id]=T)}function a(W,T){return W.nodes[T]??null}function f(W,T){return W.predecessors[T]??null}function E(W,T){const x=new Set;return T.forEach(z=>{const I=f(W,z);I&&x.add(I)}),Array.from(x)}function y(W,T){return[...W.successors[T]||[]]}function i(W,T,x){const z={},I=a(W,T);return Object.entries(I.boolState).forEach(([D,L])=>{x&&x.includes(D)&&(z[D]=L)}),Object.entries(I.numState).forEach(([D,L])=>{x&&x.includes(D)&&(z[D]=L)}),z}function g(W,T){return!!W.nodes[T]&&void 0===W.successors[T]}function p(W,T){return W.roots.hasOwnProperty(T)||!1}function h(W){return Object.keys(W.roots)}function v(W,T,x,z,I){const D=(0,e.vm)(x.objectId);D.depth=I,function o(W,T,x){Object.entries(x).forEach(([z,I])=>{const D=I(T.objectId);"boolean"==typeof D?W.boolState[z]=D:"number"==typeof D?W.numState[z]=D:W[z]=D})}(D,x,z),W.nodes[D.id]=D,T?(W.successors[T]=[...W.successors[T]||[],D.id],W.predecessors[D.id]=T):W.roots[D.id]=D,I+=1,x.children.forEach(Q=>{v(W,D.id,Q,z,I)})}function d(W,T,x){x?(T(x),y(W,x).forEach(z=>{(0,t.isNil)(z)||d(W,T,z)})):h(W).forEach(z=>{T(z),d(W,T,z)})}function r(W,T){const z=(0,e.q3)();return W.forEach(I=>{v(z,null,I,T,0)}),z}function _(W,T,x){const z=[];for(const I of W){const D=T[I.objectId],L=void 0===D?x:D,Q=_(I.children||[],T,L);if(L){const ie={...I};ie.children=Q,z.push(ie)}else Q.forEach(ie=>z.push(ie))}return z}function u(W,T,x,z){const I=T?.[W];if("boolean"==typeof I)return I;{const D=x(W);return D?.length>0?u(D,T,x,z):z}}function l(W,T,x,z){const I=x(W);return 0===I.length?z:I.some(L=>!0===T?.[L])||I.some(L=>l(L,T,x,z))}function m(W,T,x,z){const I=l(W,T,z,void 0);return!(!1===u(W,T,x,void 0)&&(!1===I||void 0===I))}function C(W,T,x){return W.reduce((z,I)=>(z[I]=z[I]??!1,z),{...T,...x})}function b(W,T=!0){const{roots:x,successors:z,predecessors:I,nodes:D}=W,L=(0,e.q3)();for(const Q in D){const ie=D[Q];if(ie.boolState.available===T){L.nodes[Q]=ie;const Z=I[Q];Z&&(L.predecessors[Q]=Z);const de=z[Q];de&&(L.successors[Q]=de);const ae=x[Q];ae&&(L.roots[Q]=ae)}}return L}function R(W){const T={};for(const x in W){const z=W[x];z.available&&(T[x]=z)}return T}function A(W,T){const x=T?.titlesToLatin??{};return Object.values(W.nodes).forEach(z=>{const I=function G(W,T){const{id:x,label:z}=T,I=W[z];if(I)return I;const L=W[V(x)];return L||void 0}(x,z);I&&(z.latinLabel=I)}),W}function k(W){const T=new RegExp(/\|:/,"gi");return W.replace(T,"_")}function V(W){const T=W.split("-");return 2===T.length?T[1]:T[0]}},78109:(le,N,n)=>{"use strict";n.d(N,{w:()=>O});var e=n(287),t=n(44867);class s{}var c=n(54438);let O=(()=>{class P{serializeNode(a,f,E={},y=i=>!0){const i={};return i.id=f.id,Object.entries(f.boolState).forEach(([g,p])=>{E.hasOwnProperty(g)&&(i[g]=p)}),Object.entries(f.numState).forEach(([g,p])=>{E.hasOwnProperty(g)&&(i[g]=p)}),a.successors[f.id]&&(i.children=[],a.successors[f.id].forEach(g=>{y(g)&&i.children.push(this.serializeNode(a,a.nodes[g],E,y))},this)),i}getAllSiblingsFromList(a,f,E){const y=[];let i;for(i=0;i<f.length;i++)this.getSiblings(a,f[i],E).forEach(g=>{y.includes(g)||y.push(g)});return y}getElectionResults(a,f,E,y){class i extends s{constructor(d,r){super(),Object.entries(d).forEach(([_,u])=>{this[_]={votesFor:[],votesAgainst:[]},Object.entries(r).forEach(([l,m])=>{m[_]?this[_].votesFor.push(l):this[_].votesAgainst.push(l)},this)},this)}}let g,p;const h=Object.keys(y),o=[];return E.forEach(v=>{p={},(0,t.IA)(a,v).forEach(_=>{p[_]=f[_]||(0,e.dU)(h,(0,t._D)(a,_,h)),delete f[_]},this),g=new i(y,p);const d=(0,e.Nq)(v,g,y);o.push(d);const r={};Object.entries(d).forEach(([_,u])=>{r[_]=u.result}),f[v]=r},this),o}updateGraphStateRecord(a,f,E,y,i=!0){E.forEach(g=>{const p=g[y[0]].id,h=(0,t._D)(a,p,y),o={};let v=!1;y.forEach(d=>{(i||g[d].result!==h[d])&&(o[d]=g[d].result,v=!0)}),v&&(f[p]=o)},this)}nodeExists(a,f){return!!a.nodes[f]}getLeaves(a){const f=[];return Object.entries(a.nodes).forEach(([E,y])=>{a.successors[E]||f.push(E)}),f}getDescendants(a,f,E=!1){const y=[];return function g(p){(0,t.IA)(a,p).forEach(h=>{y.push(h),g(h)})}(f),E&&y.push(f),y}getLeafDescendants(a,f,E=!1){const y=this.getDescendants(a,f,E).filter(i=>(0,t.xe)(a,i));return((0,t.xe)(a,f)||E)&&y.push(f),y}getAllLeafDescendants(a,f){const E=[];f.forEach(i=>{(0,t.xe)(a,i)?E.push(i):E.push(...this.getLeafDescendants(a,i,!1))});const y=new Set(E.sort());return Array.from(y)}getInverseSelection(a,f){const E=this.getAllLeafDescendants(a,f);return this.getLeaves(a).filter(y=>E.indexOf(y)<0)}getSiblings(a,f,E=!1){const y=a.predecessors[f];let i=[];if(i=y?(0,t.IA)(a,y):(0,t.ug)(a),!E){const g=i.indexOf(f);g>=0&&i.splice(g,1)}return i}getNodes(a,f){const E=[];return f.forEach(y=>{a.nodes[y]&&E.push(a.nodes[y])}),E}setState(a,f,E){const y=(0,t.dV)(a,f),i={};return Object.entries(E).forEach(([g,p])=>{"boolean"==typeof p&&y.boolState[g]!==p?(y.boolState[g]=p,i[g]=p):"number"==typeof p&&y.numState[g]!==p&&(y.numState[g]=p,i[g]=p)}),i}synchronize(a,f,E){const y=this.calculateGraphStateMap(a,f,E);return Object.entries(y).forEach(([i,g])=>{this.setState(a,i,g)},this),y}calculateGraphStateMap(a,f,E,y=!E){let i=[];const g={};let p=[];const h={},o=Object.keys(f);let v=0;for(E?Object.entries(E).forEach(([d,r])=>{g[d]=(0,e.dU)(o,E[d]),h[d]={...g[d]},v=Math.max(v,(0,t.dV)(a,d).depth)},this):this.getLeaves(a).forEach(d=>{g[d]=(0,e.dU)(o,(0,t.dV)(a,d).boolState),h[d]={...g[d]},v=Math.max(v,(0,t.dV)(a,d).depth)},this),v-=1,i=(0,e.AY)(a,Object.keys(g),v);v>=0;)p=this.getElectionResults(a,g,i,f),this.updateGraphStateRecord(a,h,p,o,y),v-=1,i=(0,e.AY)(a,Object.keys(g),v);return h}filterGraphAccessors(a,f){const y=this.getNodes(a,f).sort((p,h)=>p.depth-h.depth),i=new Map;return y.filter(p=>!i.has(p.id)&&(this.getDescendants(a,p.id,!0).forEach(h=>i.set(h,!0)),!0)).map(p=>p.id)}resetDepth(a){(0,t.Wy)(a,E=>{let y=0;a.predecessors[E]&&(y=(0,t.dV)(a,a.predecessors[E]).depth+1),(0,t.dV)(a,E).depth=y})}deleteNode(a,f,E=!0){if(!this.nodeExists(a,f))return;delete a.nodes[f];const y=a.predecessors[f];y&&(delete a.predecessors[f],a.successors[y]&&(a.successors[y]=a.successors[y].filter(g=>g!==f)));const i=a.successors[f];i&&(delete a.successors[f],E&&i.forEach(g=>{this.deleteNode(a,g)},this)),a.roots[f]&&delete a.roots[f]}resetAsLeaf(a,f){let E=[];return a.nodes[f]&&!(0,t.xe)(a,f)&&(E=this.getDescendants(a,f),delete a.successors[f],E.forEach(y=>{delete a.nodes[y],delete a.successors[y],delete a.predecessors[y]})),E}static#e=this.\u0275fac=function(f){return new(f||P)};static#t=this.\u0275prov=c.jDH({token:P,factory:P.\u0275fac,providedIn:"root"})}return P})()},56343:(le,N,n)=>{"use strict";n.d(N,{t:()=>e});var e=function(t){return t.MajorityWins="majorityWins",t.TrueWins="trueWins",t.FalseWins="falseWins",t}(e||{})},23881:(le,N,n)=>{"use strict";function e(P){return{id:P,depth:0,boolState:{},numState:{}}}function t(){return{nodes:{},successors:{},predecessors:{},roots:{}}}n.d(N,{YR:()=>c,ow:()=>O,q3:()=>t,vm:()=>e});class c{}function O(P=[]){return{available:()=>!0,shown:()=>!1,selected:()=>!1,pickable:()=>!0,renderable:()=>!1,expanded:()=>!1,...P.reduce((S,a)=>(S[a]=()=>!1,S),{})}}},6670:(le,N,n)=>{"use strict";var e=n(345),t=n(54438),s=n(728),c=n(38645),O=n(85446),P=n(37925),S=n(85052),a=n(60177);const f=()=>["/explore"];function E(U,J){1&U&&(t.qex(0),t.j41(1,"div",5)(2,"div"),t.EFF(3,"Our apologies."),t.k0s(),t.j41(4,"div"),t.EFF(5,"We're unable to find the model you are looking for."),t.k0s()(),t.j41(6,"p",6),t.EFF(7,"404 Error. Content not found."),t.k0s(),t.bVm())}function y(U,J){1&U&&(t.qex(0),t.j41(1,"div",5)(2,"div"),t.EFF(3,"Our apologies."),t.k0s(),t.j41(4,"div"),t.EFF(5,"We're unable to find the page you are looking for."),t.k0s()(),t.j41(6,"p",6),t.EFF(7,"404 Error. Page not found."),t.k0s(),t.bVm())}let i=(()=>{class U{constructor(B){this.route=B,this.ngUnsubscribe=new S.B}ngOnInit(){this.route.queryParams.pipe((0,P.Q)(this.ngUnsubscribe)).subscribe(B=>{this.errorType=B.errorType})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}static#e=this.\u0275fac=function(ee){return new(ee||U)(t.rXU(c.nX))};static#t=this.\u0275cmp=t.VBU({type:U,selectors:[["app-not-found"]],decls:6,vars:4,consts:[[1,"error",3,"ngSwitch"],["src","assets/images/biodigital-logo.svg",1,"error__logo"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"error__button",3,"routerLink"],[1,"error__text"],[1,"error__subtext"]],template:function(ee,pe){1&ee&&(t.j41(0,"div",0),t.nrm(1,"img",1),t.DNE(2,E,8,0,"ng-container",2)(3,y,8,0,"ng-container",3),t.j41(4,"button",4),t.EFF(5,"Go to our home page"),t.k0s()()),2&ee&&(t.Y8G("ngSwitch",pe.errorType),t.R7$(2),t.Y8G("ngSwitchCase","content"),t.R7$(2),t.Y8G("routerLink",t.lJ4(3,f)))},dependencies:[a.ux,a.e1,a.fG,c.Wk],styles:["body[_ngcontent-%COMP%]{background-color:#fff}.error[_ngcontent-%COMP%]{padding:160px;display:flex;flex-direction:column;align-items:flex-start;justify-content:center;color:#283853;font-size:16px}.error__logo[_ngcontent-%COMP%]{width:240px}.error__text[_ngcontent-%COMP%]{margin-top:32px;font-size:32px;line-height:48px;font-weight:500;letter-spacing:.025em}.error__subtext[_ngcontent-%COMP%]{font-size:20px;margin-top:32px}.error__button[_ngcontent-%COMP%]{margin-top:48px;padding:16px 24px;border-radius:4px;border:1px solid #96a8c0;font-size:16px;font-weight:500;letter-spacing:.075em;color:#374a68;text-transform:uppercase;outline:0;cursor:pointer}.error__button[_ngcontent-%COMP%]:hover{background:#eaeff5;color:#1c2a3f;border-color:#1c2a3f}@media (max-width: 1024px){.error[_ngcontent-%COMP%]{padding:10%}.error__text[_ngcontent-%COMP%]{font-size:24px;line-height:32px;letter-spacing:normal}.error__subtext[_ngcontent-%COMP%]{font-size:18px;line-height:26px}.error__button[_ngcontent-%COMP%]{font-size:14px}}@media (max-width: 768px){.error__logo[_ngcontent-%COMP%]{width:200px}.error__text[_ngcontent-%COMP%]{font-size:20px;line-height:28px}.error__subtext[_ngcontent-%COMP%]{font-size:16px;line-height:24px;margin-top:24px}.error__button[_ngcontent-%COMP%]{font-size:12px;padding:12px 20px;margin-top:32px}}"],changeDetection:0})}return U})();var g=n(24418),p=n(27180);const h=[{path:"",pathMatch:"full",redirectTo:g.c.application===p.c.Studio?"/explore":"/results/modules"},{path:"dashboard",pathMatch:"full",redirectTo:g.c.application===p.c.Studio?"/results/bookmarks":"/results/modules"},{path:"explore/search",redirectTo:"results/modules"},{path:"account",loadChildren:()=>Promise.all([n.e(736),n.e(957),n.e(76),n.e(260)]).then(n.bind(n,33260)).then(U=>U.AccountModule)},{path:"login",loadChildren:()=>Promise.all([n.e(76),n.e(731)]).then(n.bind(n,74731)).then(U=>U.LoginModule)},{path:"results",canActivate:[O.q],loadChildren:()=>Promise.all([n.e(736),n.e(685),n.e(742),n.e(623)]).then(n.bind(n,51623)).then(U=>U.SearchModule)},{path:"explore",canActivate:[O.q],loadChildren:()=>Promise.all([n.e(736),n.e(685),n.e(76),n.e(99)]).then(n.bind(n,19099)).then(U=>U.ExploreModule)},{path:"view",loadChildren:()=>Promise.all([n.e(736),n.e(678),n.e(450)]).then(n.bind(n,47450)).then(U=>U.ViewInternalModule)},{path:"edit",loadChildren:()=>Promise.all([n.e(736),n.e(685),n.e(742),n.e(678),n.e(957),n.e(76),n.e(850)]).then(n.bind(n,72850)).then(U=>U.EditModule)},{path:"account",loadChildren:()=>Promise.all([n.e(736),n.e(957),n.e(76),n.e(260)]).then(n.bind(n,33260)).then(U=>U.AccountModule)},{path:"**",component:i}];let o=(()=>{class U{static#e=this.\u0275fac=function(ee){return new(ee||U)};static#t=this.\u0275mod=t.$C({type:U});static#n=this.\u0275inj=t.G2t({imports:[c.iI.forRoot(h),c.iI]})}return U})();n(26579);var d=n(14264),r=n(17365),_=n(11756),u=n(36110),l=n(35160),m=n(87996),C=n(35426),b=n(2573),R=n(17215),A=n(49204),G=n(92014),k=n(16823),V=n(71263),W=n(59e3),T=n(34006),x=n(21007);function z(U,J){if(1&U&&(t.j41(0,"div",7),t.EFF(1),t.j41(2,"a",8),t.EFF(3,"Contact us"),t.k0s(),t.EFF(4," if you have any questions regarding your group account. "),t.k0s()),2&U){const B=t.XpG();t.R7$(),t.SpI(" You must be within the ",B.organizationName," network to access this group account. "),t.R7$(),t.Y8G("href","mailto:"+B.supportEmail,t.B4B)}}function I(U,J){if(1&U&&(t.j41(0,"div",7),t.EFF(1),t.j41(2,"a",8),t.EFF(3,"Contact us"),t.k0s(),t.EFF(4," if you have any questions regarding your group account. "),t.k0s()),2&U){const B=t.XpG();t.R7$(),t.SpI(" You must be within the ",B.organizationName," network to access this group account. "),t.R7$(),t.Y8G("href","mailto:"+B.supportEmail,t.B4B)}}let D=(()=>{class U{constructor(B,ee,pe){this.dialogRef=B,this.data=ee,this.storageService=pe,this.email=!1,this.ip=!1,this.supportEmail=g.c.supportEmail,this.organizationName=ee.organizationName,this.email=ee.email,this.ip=ee.ip}ngOnInit(){}handleDontShowClick(){const B=this.storageService.getLocalJSON(R.UT.GroupRestriction)||{};B.dontShowDialog=!0,this.storageService.setLocalItem(R.UT.GroupRestriction,B),this.dialogRef.close()}static#e=this.\u0275fac=function(ee){return new(ee||U)(t.rXU(T.CP),t.rXU(T.Vh),t.rXU(R.n$))};static#t=this.\u0275cmp=t.VBU({type:U,selectors:[["app-group-restriction-dialog"]],decls:13,vars:4,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"py-4"],["class","text-sm",4,"ngIf"],["mat-dialog-actions",""],["app-button","","buttonTheme","light","buttonType","outline",3,"click"],["app-button","","buttonType","primary","cdkFocusInitial","",3,"mat-dialog-close"],[1,"text-sm"],[3,"href"]],template:function(ee,pe){1&ee&&(t.j41(0,"h1",0),t.EFF(1,"Oh no, you have no access to the "),t.nrm(2,"br"),t.EFF(3),t.k0s(),t.j41(4,"div",1)(5,"div",2),t.DNE(6,z,5,2,"div",3)(7,I,5,2,"div",3),t.k0s()(),t.j41(8,"div",4)(9,"button",5),t.bIt("click",function(){return pe.handleDontShowClick()}),t.EFF(10," Don't show me this again "),t.k0s(),t.j41(11,"button",6),t.EFF(12,"Close"),t.k0s()()),2&ee&&(t.R7$(3),t.SpI("",pe.organizationName," group!"),t.R7$(3),t.Y8G("ngIf",pe.ip),t.R7$(),t.Y8G("ngIf",pe.email),t.R7$(4),t.Y8G("mat-dialog-close",!0))},dependencies:[a.bT,T.tx,T.BI,T.E7,T.Yi,x.Q],changeDetection:0})}return U})();var L=n(84370),Q=n(83889),ie=n(3266),se=n(79805),Z=n(60286),de=n(60830);function ae(U,J){const{procName:B,actionFn:ee,aliases:pe=[],mapFnIn:Se,mapFnOut:ye,hideDefinition:Ae=!1}=J,Ge=function(Ye){const ct=this,gt=Se?Se(Ye):Ye,bt=ee(gt);if(!(typeof bt>"u"))if(bt instanceof b.c)bt.pipe((0,de.$)()).subscribe(He=>{const lt=ye?ye(He):He;ct.setResult(lt)});else{const Mt=ye?ye(bt):bt;ct.setResult(Mt)}};[B,...pe].forEach(Ye=>{U.defineAPIProcedure(Ye,Ge,{hidden:Ae})})}var q=n(66897),K=n(7431),j=n(515),M=n(47610),$=n(82656),ce=n(19833),re=n(76304),ue=n(94495),H=n(22679),te=n(13409);function F(U){return(0,$.z)([U.select(ue.N.getStoryChapters),U.select(re.S.getChapter)]).pipe((0,d.p)(([J,B])=>!(0,A.isEmpty)(J)&&!!B),(0,ce.c)(0),(0,r.s)(1))}function X(U){return U.select(ue.N.getAllChaptersModelsReady).pipe((0,d.p)(J=>!0===J),(0,r.s)(1))}function oe(U){return(0,$.z)([U.select(H.t.getStory),U.select(te.z.getNodes)]).pipe((0,d.p)(([J,B])=>!(0,A.isNil)(J)&&!(0,A.isEmpty)(B)),(0,r.s)(1))}function Y(U){const J=U.captureCamera();return{position:J.lookAt.eye,target:J.lookAt.look,up:J.lookAt.up,zoom:J.zoom}}var $e,U,_e=n(65294),Ce=n(17766),Be=n(66056),Ie=n(38753),Oe=n(15877),Te=n(46104),ve=n(21472),Ve=n(93915),we=n(28577),Je=n(39705),tt=n(33013),st=n(93132),rt=n(47555),Ke=n(26463),et=n(38472),ge=n(34525),Fe=n(10352);(U=$e||($e={})).isLegacyCaptureFormat=function J(pe){return void 0!==pe.engineVersion},U.convertCaptureFormat=function B(pe){const Se=Object.keys(pe.objects).reduce((ye,Ae)=>(ye.push({objectId:Ae,selected:!1,hidden:!1}),ye),[]);return{storyId:pe.timeline.rootName.replace(".json",""),camera:{lookAt:pe.camera,zoom:void 0},labels:[],objects:Se,background:[],activeChapterId:pe.timeline.scrub?pe.timeline.scrub.chapterId:void 0}},U.convertMediaFormat=function ee(pe){const Se={};return Object.entries(pe).forEach(([ye,Ae])=>{Se[ye]={fullUrl:Ae.fullUrl,lang:Ae.lang,streamType:Ae.streamType}}),Se};var ot=n(49188),je=n(61295),xe=n(63365),Me=n(20458);let Ft=(()=>{class U{static#e=this.type="[Analytics] Reset First Interaction"}return U})();var ze=n(65776),It=n(13491),Ot=n(51640),jt=n(11876);function wt(U){if(!U)return null;const{objectId:J,canvasPos:B,worldPos:ee,normal:pe}=U;return{objectId:J||void 0,canvasPosition:B?{x:B.x,y:B.y}:void 0,mode:"query",position:ee?It.n.fromArray(ee):void 0,normal:pe?It.n.fromArray(pe):void 0}}function Et(U,J,B){const ee=U.getObjectById(B).parent;return null!==ee&&(J[ee.objectId].checked||Et(U,J,ee.objectId))}function $t(U,J,B){const ee=J.getEvent(j.X.HumanStarted).pipe((0,de.$)()),pe=B.includes("/")?Ce.c.Module:Ce.c.Bookmark;return U.dispatch(new Be.Ye(B,pe)),ee}function Zt(U,J){return U.dispatch(new M._y(!0)),J.fireEvent(j.X.SceneXrayEnabled),!0}function ln(U){return U.find(B=>B.type==ze.m.Images)?.images?.filter(B=>null!=B.urls?.default).map(B=>B.urls.default)??[]}function gn(U,J,B,ee,pe,Se,ye,Ae,Ge,Qe,Ye,ct,gt,bt,Mt){return[{procName:q.t.SceneMetaData,actionFn:()=>function w(U){return(0,$.z)([U.select(H.t.getStory),U.select(ue.N.getStoryChapters)]).pipe((0,d.p)(([J,B])=>!(0,A.isNil)(J)&&!(0,A.isEmpty)(B)),(0,r.s)(1))}(U).pipe((0,u.T)(([He,lt])=>({title:He.displayName,description:He.description,chapters:lt.map(at=>({id:at.id,title:at.displayName,description:at.description,isAnimated:ye.isChapterAnimated(at),loops:ye.isChapterLooped(at),duration:ye.getChapterTimeFrame(at.id),media:$e.convertMediaFormat(at.media),images:at.contentBlocks?ln(at.contentBlocks):[],thumbnail:at.thumbnails?at.thumbnails.default:""}))})))},{procName:q.t.focusObject,actionFn:He=>(function rn(U,J,B){U.select&&U.xray?Zt(J,B):(0,ot.q)(J,B),U.select&&J.dispatch(new je.q9(!0,[U.objectId])),J.dispatch(new M.W6(U.objectId,!0,1))}(He,U,B),!0),hideDefinition:!0},{procName:q.t.dissectSetEnabled,actionFn:He=>(U.dispatch(new M.pL(He.enable?rt.s.Hide:rt.s.Select)),!0),hideDefinition:!0},{procName:q.t.sceneSetClickMode,actionFn:He=>(U.dispatch(new M.pL("select"===He?rt.s.Select:"hide"===He?rt.s.Hide:"fade"===He?rt.s.Fade:rt.s.Select)),!0)},{procName:q.t.sceneGetClickMode,actionFn:()=>U.selectSnapshot(re.S.getActiveTool)},{procName:q.t.pickSingleSetEnabled,actionFn:He=>{const lt=(()=>{switch(He.enable){case void 0:return!U.selectSnapshot(Ke.Pf.getMultiPickModeEnabled);case!0:return!1;case!1:return!0}})();return U.dispatch(new st.B.SetMultiPickModeEnabled(lt)),!0},hideDefinition:!0},{procName:q.t.pickMultiSetEnabled,actionFn:He=>{const lt=void 0===He.enable?!U.selectSnapshot(Ke.Pf.getMultiPickModeEnabled):He.enable;return U.dispatch(new st.B.SetMultiPickModeEnabled(lt)),!0},hideDefinition:!0},{procName:q.t.getCanvasPos,actionFn:He=>{const lt=ct.getCanvas();return function Ee(U,J,B,ee,pe){B&&et.add(J,B,J);const Se=U.getViewMat(),ye=U.getProjMat(),Ae=ge.create();et.transformMat4(Ae,J,Se),Ae[3]=1,ge.transformMat4(Ae,Ae,ye);const Qe=Ae[1],Ye=Ae[3];return[Math.round((1+Ae[0]/Ye)*ee/2),Math.round((1-Qe/Ye)*pe/2)]}(ct,He.worldPos,He.offset,lt.width,lt.height)},hideDefinition:!0},{procName:q.t.SceneCapture,actionFn:()=>F(U).pipe((0,u.T)(()=>function vt(U,J,B){const ee=B.captureCamera(),pe=J.selectSnapshot(te.z.getNodes),Se=Object.keys(pe).map(ct=>({objectId:ct,selected:pe[ct].checked||Et(U,pe,ct),hidden:!pe[ct].shown})),ye=J.selectSnapshot(ue.N.getStoryChapters).map(ct=>({chapterId:ct.id,background:ct.background||Fe.RK})),Ae=J.selectSnapshot(H.t.getStoryId);return{camera:ee,labels:J.selectSnapshot(Ie.y.getLabels),storyId:Ae,objects:Se,background:ye,activeChapterId:J.selectSnapshot(ue.N.getSelectedChapterId)}}(gt,U,pe)))},{procName:q.t.SceneRestore,actionFn:He=>X(U).pipe((0,_.Z)(()=>{const lt=$e.isLegacyCaptureFormat(He),at=lt?$e.convertCaptureFormat(He):He;return function Xt(U,J,B,ee,pe){return $t(B,ee,J.storyId).pipe((0,_.Z)(()=>(0,ve.H)(function Bt(U,J,B,ee=!1){return new Promise(pe=>{const Se=J.objects.filter(Ye=>!0===Ye.selected).map(Ye=>Ye.objectId),ye=ee?U.getLeafIds().filter(ct=>void 0===J.objects.find(Mt=>Mt.objectId===ct)):J.objects.filter(Ye=>!0===Ye.hidden).map(Ye=>Ye.objectId),Ae=J.background.map(Ye=>new tt.qi(Ye.chapterId,Ye.background)),Ge=J.activeChapterId?[new tt.wg(J.activeChapterId)]:[],Qe=void 0!==J.camera.zoom?[new K.F5(J.camera.zoom)]:[];setTimeout(()=>{B.dispatch([new K.Ih(J.camera.lookAt,!1),new Ve.gJ(J.labels),new je.yr(!1,ye,void 0,void 0,void 0,!0),new je.q9(!0,Se),...Qe,...Ge,...Ae]),pe(void 0)})})}(U,J,B,pe))),(0,Je.M)(()=>{ee.fireEvent(j.X.SceneRestored)}),(0,u.T)(()=>!0))}(gt,at,U,B,lt)}))},{procName:q.t.SceneEnableXrayMode,actionFn:()=>F(U).pipe((0,u.T)(()=>Zt(U,B)))},{procName:q.t.SceneDisableXrayMode,actionFn:()=>F(U).pipe((0,u.T)(()=>(0,ot.q)(U,B)))},{procName:q.t.SceneLoad,actionFn:He=>X(U).pipe((0,_.Z)(()=>{J.pipe((0,G.xi)(Be.Z0),(0,r.s)(1)).subscribe(()=>{B.fireEvent(j.X.SceneReady)});const lt=$t(U,B,He);return U.dispatch(new Ft),lt}))},{procName:q.t.SceneSetBaseDirectory,actionFn:He=>(Ye.fireEvent(_e.F.NativeSetBaseDirectory,He),!0)},{procName:q.t.NativeSetSdkOffline,actionFn:He=>(Ye.fireEvent(_e.F.NativeSetSdkOffline,He),!0)},{procName:q.t.SceneReset,actionFn:()=>(Ae.resetChapter(),!0)},{procName:q.t.SceneInfo,actionFn:He=>F(U).pipe((0,_.Z)(()=>oe(U)),(0,_.Z)(([lt,at])=>{const Ct=He?.chapterId;let St=at;Ct&&(St=U.selectSnapshot(te.z.getAllNodeState)[Ct]??{});const Tt=He?.objectId,Nt=Tt?[Tt]:Object.keys(gt.getObjects()),xt=!!He.objectId,{displayName:rs}=lt;return function Rt(U,J,B,ee,pe,Se,ye,Ae){const Ge=Se.map(Qe=>function zt(U,J,B,ee,pe,Se){const ye=B.getObjectById(pe),{children:Ae,displayName:Ge,parent:Qe,shown:Ye}=ye,ct=B.isLeaf(ye)?J[pe].checked||Et(B,J,pe):void 0,gt=J[pe].available;return(Se?function Gt(U,J,B){const ee=U.selectSnapshot(Ke.Pf.getNodeInfoFallback),pe=U.selectSnapshot(Ke.Pf.getViewLanguage);return J.queryNodeInfo(B,ee,pe).pipe((0,u.T)(Se=>Se?.description||""),(0,we.W)(()=>(0,Oe.of)("")))}(U,ee,Ge):(0,Oe.of)("")).pipe((0,u.T)(Mt=>({objectId:pe,name:Ge,description:Mt,available:gt,shown:Ye,selected:ct,children:Ae?.map(He=>He.objectId),parent:Qe?Qe.objectId:null})))}(U,J,B,ee,Qe,ye));return(0,Te.p)(Ge).pipe((0,u.T)(Qe=>{const Ye=Qe.reduce((ct,gt)=>((Ae||gt.available)&&(ct[gt.objectId]=gt),ct),{});return{name:pe,objects:Ye}}))}(U,St,gt,bt,rs,Nt,xt,He?.includeUnavailable??!Ct)}))},{procName:q.t.ScenePick,actionFn:He=>wt(ct.pick(He.x,He.y))},{procName:q.t.SceneSelectObjects,actionFn:He=>F(U).pipe((0,u.T)(()=>{const lt=!0===He.replace,at=He;return delete at.replace,lt&&U.dispatch(new je.q9(!1)),U.dispatch(new je.q9(!1,[],at)),!0}))},{procName:q.t.SceneShowObjects,actionFn:He=>F(U).pipe((0,u.T)(()=>{delete He.replace;const lt=(Ct,St)=>{const Tt=gt.getObjectById(Ct).children;let Nt={[Ct]:St};for(const xt of Tt)void 0===He[xt.objectId]&&(Nt[xt.objectId]=St,Nt={...Nt,...lt(xt.objectId,St)});return Nt},at=Object.entries(He).reduce((Ct,[St,Tt])=>({...Ct,...lt(St,Tt)}),{});return U.dispatch(new je.yr(!1,[],at,void 0,void 0,!0)),!0}))},{procName:q.t.IsolateObject,actionFn:He=>{const lt="string"==typeof He?[He]:He,at=U.selectSnapshot(re.S.getViewGraph),Ct=Se.getInverseSelection(at,lt),St=Se.getNodes(at,Ct);return U.dispatch(new je.yr(!1,St.map(Tt=>Tt.id),void 0,void 0,void 0,!0)),!0}},{procName:q.t.SceneTransformObject,actionFn:He=>F(U).pipe((0,u.T)(()=>(gt.transformObject(He.objectId,He),!0)))},{procName:q.t.SceneColorObject,actionFn:He=>oe(U).pipe((0,u.T)(()=>{const{objectId:lt,tintColor:at,saturation:Ct,contrast:St,brightness:Tt,opacity:Nt}=He;return U.dispatch(new je.Jp((0,xe.H)({tintColor:at,saturation:Ct,contrast:St,brightness:Tt,opacity:Nt}),[lt])),!0}))},{procName:q.t.SceneGetColor,actionFn:He=>oe(U).pipe((0,u.T)(()=>{const lt=U.selectSnapshot(te.z.getNodePaint)(He.objectId);return(0,xe.Sf)(lt)}))},{procName:q.t.SceneUncolorObject,actionFn:He=>oe(U).pipe((0,u.T)(()=>(U.dispatch(new je.Jp(Me.NR,[He.objectId])),!0)))},{procName:q.t.SceneDisableHighlight,actionFn:()=>(ee.disableHighlight(),!0)},{procName:q.t.SceneEnableHighlight,actionFn:()=>(ee.enableHighlight(),!0)},{procName:q.t.SceneSetHighlightColor,actionFn:He=>(ee.setHighlightColor(He),!0)},{procName:q.t.SceneSetLayersSliderPosition,actionFn:He=>F(U).pipe((0,u.T)(()=>{const{layersMode:lt}=U.selectSnapshot(Ot.dF.getUI).visibilityLayers;return lt===jt.Z.Group?function pn(U,J,B){const ee=(0,A.clamp)(B.position,0,1),pe=!0===B.record,Se=U.selectSnapshot(ue.N.getSelectedChapterId),ye=U.selectSnapshot(ue.N.getSelectedChapterLayerGroups),Ae=J.computeGroupPositionsByFraction(ye,ee);return J.syncLayerGroupsToScene(Ae),J.syncLayerGroupsToState(Se,Ae,pe),!0}(U,Ge,He):function dn(U,J,B){const ee=U.selectSnapshot(ue.N.getSelectedChapterId),pe=U.selectSnapshot(ue.N.getSelectedChapterCurrentLayers),Se=Math.min(1,Math.max(B.position,0)),ye=J.fractionToIndex(pe,Se),Ae=J.fractionToPosition(pe,Se,ye);return B.record?J.syncLayersToState(ee,ye,Ae):J.syncLayersToScene(pe,ye,Ae,!1),!0}(U,Qe,He)}))},{procName:q.t.SceneGetLayers,actionFn:()=>F(U).pipe((0,u.T)(()=>{const{layersMode:He}=U.selectSnapshot(Ot.dF.getUI).visibilityLayers;return He===jt.Z.Group?function un(U){return[U.selectSnapshot(ue.N.getSelectedChapterLayerGroups).map(ee=>ee.layers).flat()]}(U):function cn(U){return U.selectSnapshot(ue.N.getAllChaptersCurrentLayers)}(U)}))},{procName:q.t.SceneGetPositions,actionFn:()=>F(U).pipe((0,u.T)(()=>{const He=Mt.findContentBlockByType(U.selectSnapshot(ue.N.getSelectedChapterContentBlocks),ze.m.Positions);return(He?He.positions:[]).map(at=>function hn(U){const J=U.camera.location;return{title:U.title,camera:{position:J.eye,target:J.look,up:J.up}}}(at))}))},{procName:q.t.SceneGetVariantSchemas,actionFn:()=>F(U).pipe((0,u.T)(()=>U.selectSnapshot(H.t.getVariantSchemas)))}]}function At(U,J,B,ee){U.defineAPIEvent(J,{events:B||[J],map:ee||(pe=>pe)})}var qt=n(11724);function en(U){return U.selectSnapshot(re.S.getPlaybackSpeed)}var bn=n(12347);let Qt=(()=>{class U{static#e=this.type="[Widget] Set Input Enabled";constructor(B){this.enabled=B}}return U})(),En=(()=>{class U{static#e=this.type="[Widget] Set API Config";constructor(B){this.config=B}}return U})();var Vs=n(11789),Bn=n(24477),tn=n(17276),Ws=n(42482),Kn=n(9592),kt=n(76016),Hn=n(82323),Le=n(29160),De=n(92811),me=n(65855),fe=n(50677);function We(U){return Vs.T.getColors(U).map(B=>B[255])}function it(U,J){const B=U.selectSnapshot(ue.N.getSelectedChapterBackground),{colors:ee,colorStops:pe,gradientType:Se}=B,ye=J.gradientType||Se,Ae=J.colorStops||pe;if(J.colors){const[Ge,Qe]=J.colors;return{colors:[...Ge,...Qe],gradientType:ye,colorStops:Ae}}return{colors:ee,gradientType:ye,colorStops:Ae}}function ht(U){return Object.entries(tn.U).reduce((J,[B,ee])=>ee===U?B:J,"None")}var ut=n(76872);function ft(U){return U.selectSnapshot(Ie.y.getChapterLabels)}function qe(U,J){return function Pt(U,J){return U.find(B=>J===B.id)}(ft(U),J)}function On(U,J){const B=U.getMarkerById(J.id),ee=U.getMarkerWorldPosition(B);return{annotationId:J.id,objectId:J.objectId||null,title:J.title,description:J.description,shown:J.shown,occludable:J.occludable,position:ee?It.n.fromArray(ee):null,canvasPosition:B?{x:B.screenPosition[0],y:B.screenPosition[1]}:null}}function xn(U,J){const B=qe(U,J.annotationId);return B?{...B,...J}:null}function Mn(U,J){return J&&U.dispatch(new Ve.lb(J)),!0}function nn(U,J){return U.dispatch(new Ve.eH(J)),!0}function Xn(U,J){return U.reduce((B,ee)=>({...B,[`${ee}`]:J}),{})}function Tn(U,J){return function Qn(U,J){return Object.entries(U).filter(([B,ee])=>J(B,ee)).reduce((B,[ee,pe])=>({...B,[`${ee}`]:pe}),{})}(U,(B,ee)=>ee===J)}function Yn(U,J){return Object.keys(Tn(U,J))}function Jt(U,J,B){return function Yt(U,J){return U.filter(B=>J.includes(B.id))}(U,Yn(J,B))}function yi(U,J,B){const ee=Yn(J,B).map(Se=>function kn(U,...J){const B=J.map(pe=>U.filter(ye=>pe===ye.objectId));return function mt(U){const J=new Set(U);return Array.from(J.values())}([].concat(...B))}(U,Se)).map(Se=>Se.map(ye=>ye.id));return Xn([].concat(...ee),B)}function so(U,J){return[{eventName:_e.F.AnnotationsCreated,aliasEvents:[_e.F.LabelsCreated],mapFn:B=>On(U,B)},{eventName:_e.F.AnnotationsDestroyed,aliasEvents:[_e.F.LabelsDestroyed],mapFn:B=>({annotationId:B.id})},{eventName:_e.F.AnnotationsShown,aliasEvents:[_e.F.LabelsEnabled],mapFn:()=>!0},{eventName:_e.F.AnnotationsHidden,aliasEvents:[_e.F.LabelsDisabled],mapFn:()=>!0}]}function io(U,J,B,ee){return[{procName:q.t.AnnotationsInfo,actionFn:()=>ft(U),mapFnOut:pe=>function zs(U,J){return J.reduce((B,ee)=>(B[ee.id]=On(U,ee),B),{})}(B,pe)},{procName:q.t.AnnotationsCreate,mapFnIn:pe=>function Cn(U,J,B,ee){const pe=J.selectSnapshot(ue.N.getSelectedChapter),Se=U.getObjectById(ee.objectId)?ee.objectId:void 0;return B.deserializeAnnotation({annotationId:ee.annotationId,title:ee.title,description:ee.description,objectId:Se,pos:ee.position,occludable:ee.occludable,labelOffset:ee.labelOffset,shown:ee.shown,labelShown:ee.shown},pe,ut.D.Annotation)}(ee,U,J,pe),actionFn:pe=>function Pn(U,J){return J.objectId?(U.dispatch(new Ve.Sh(J,!0)),J):null}(U,pe),mapFnOut:pe=>pe?On(B,pe):null},{procName:q.t.AnnotationsUpdate,mapFnIn:pe=>xn(U,pe),actionFn:pe=>Mn(U,pe)},{procName:q.t.AnnotationsSetTitle,mapFnIn:pe=>xn(U,pe),actionFn:pe=>Mn(U,pe),hideDefinition:!0},{procName:q.t.AnnotationsSetDescription,mapFnIn:pe=>xn(U,pe),actionFn:pe=>Mn(U,pe),hideDefinition:!0},{procName:q.t.AnnotationsDestroy,mapFnIn:pe=>qe(U,pe),actionFn:pe=>function $s(U,J){return J&&U.dispatch(new Ve.vx(J)),!0}(U,pe)},{procName:q.t.ShowAnnotations,actionFn:()=>nn(U,!0)},{procName:q.t.SetAnnotationsShown,actionFn:()=>nn(U,!0),hideDefinition:!0},{procName:q.t.HideAnnotations,actionFn:()=>nn(U,!1)},{procName:q.t.AnnotationsSetLabelsShown,mapFnIn:pe=>function to(U,J){const{annotations:B,objects:ee,replace:pe}=J,ye=B||{},Ae=ee||{},Ge=ft(U),Qe={...Tn(ye,!0),...Tn(ye,!1),...yi(Ge,Ae,!0),...yi(Ge,Ae,!1)};return pe?{...Xn(Ge.map(Ye=>Ye.id),!1),...Qe}:Qe}(U,pe),actionFn:pe=>function no(U,J){const B=ft(U),ee=Jt(B,J,!1),pe=Jt(B,J,!0);U.dispatch(new Ve.D3(pe,!0)),U.dispatch(new Ve.D3(ee,!1))}(U,pe),hideDefinition:!0}]}var Dn=n(20714),Fn=n(24151);const oo={};function vi(U,J){J.hasOwnProperty("data")&&(J[U]=J.data)}const Vt={hotspotSeedId:0,hotspotIdMap:new Map,getHotspotMap:U=>{const{hotspotIdMap:J,createHotspotId:B}=Vt;return U.selectSnapshot(Ie.y.getLabels).forEach(pe=>{const Se=pe.id;typeof J.get(Se)>"u"&&B(Se)}),J},createHotspotId:U=>(Vt.hotspotSeedId++,Vt.hotspotIdMap.set(U,Vt.hotspotSeedId),Vt.hotspotSeedId),getHotspotIdByLabel:(U,J,B)=>{const{getHotspotMap:ee,createHotspotId:pe}=Vt,ye=ee(U).get(J);return B&&typeof ye>"u"?pe(J):ye},getLabelIdByHotspotId:(U,J)=>{const B=Vt.getHotspotMap(U),ee=Array.from(B).find(([pe,Se])=>Se===J);return ee?ee[0]:null}};function Si(U,J){const B=U.selectSnapshot(Ie.y.getLabels);return typeof J<"u"?B.filter(ee=>ee.chapterId===J):B}function Jn(U,J){const B=Si(U),ee=Vt.getLabelIdByHotspotId(U,J);return B.find(pe=>pe.id===ee)}function bi(U){return U===Dn.H.CirclePlus?Fn.O.Plus:U===Dn.H.CircleMinus?Fn.O.Minus:Fn.O.Default}function Ks(U,J){return Vt.getHotspotIdByLabel(U,J)}function Zn(U,J){return{...J,id:Ks(U,J.id)}}function Ei(U,J,B){const ee=J.selectSnapshot(ue.N.getStoryChapters);return B.map(pe=>function co(U,J,B,ee){const{id:pe,chapterId:Se,title:ye,objectId:Ae}=ee,Ge=B.findIndex(bt=>Se===bt.id),Qe=Vt.getHotspotIdByLabel(J,pe,!0),Ye=U.getMarkerById(pe),ct=U.getMarkerWorldPosition(Ye),gt=Ye?.marker3D?.direction;return{id:Qe,title:ye,objectId:Ae,position:ct?Ci(ct):null,direction:gt?Ci(gt):null,canvasPosition:Ye?uo(Ye.screenPosition):null,chapterScope:Ge,type:ee.pinType===Fn.O.PlusMinus?Dn.H.CirclePlus:Dn.H.Circle,shown:ee.shown,data:oo[ee.id]}}(U,J,ee,pe))}function Ci(U){return{x:U[0],y:U[1],z:U[2]}}function qn(U){return[U.x,U.y,U.z]}function uo(U){return{x:U[0],y:U[1]}}function Oi(U,J,B){return U.dispatch(new Ve.D3(J,B)),!0}function Hs(U,J){if("number"==typeof J){const B=Jn(U,J);return B?[B]:[]}return Si(U)}function fo(U){return[{eventName:_e.F.HotspotsEntered,mapFn:J=>Zn(U,J)},{eventName:_e.F.HotspotsLeft,mapFn:J=>Zn(U,J)},{eventName:_e.F.HotspotsPicked,mapFn:J=>Zn(U,J)},{eventName:_e.F.HotspotsDisplayUpdated,mapFn:J=>Zn(U,J)},{eventName:_e.F.HotspotsPositionUpdated,mapFn:J=>function ro(U,J){const{id:B,canvasPos:ee}=J,{x:pe,y:Se}=ee;return{id:Ks(U,B),canvasPosition:{x:pe,y:Se,0:pe,1:Se},occluded:J.occluded}}(U,J)}]}function yo(U,J,B){return[{procName:q.t.HotspotsInfo,actionFn:ee=>{const pe="number"==typeof ee?ee:void 0;if(void 0!==pe){const Se=Jn(U,pe);return Ei(B,U,[Se])[0]}{const Se=Hs(U,pe);return Ei(B,U,Se)}}},{procName:q.t.HotspotsTypes,mapFnIn:()=>function po(){return Object.values(Dn.H).map(U=>`${U}`)}(),actionFn:ee=>ee},{procName:q.t.HotspotsCreate,mapFnIn:ee=>function ao(U,J,B){const{title:ee,objectId:pe,position:Se,direction:ye,chapterScope:Ae,type:Ge}=B,Qe=U.selectSnapshot(ue.N.getStoryChapters),Ye=U.selectSnapshot(ue.N.getSelectedChapter),ct=U.selectSnapshot(ue.N.getSelectedChapterIndex),gt="number"==typeof Ae?Ae:ct,bt=Qe[gt]||Ye,Mt=!1!==B.shown,lt={title:ee,type:Ge||Dn.H.CircleLabel,objectId:pe,pos:Se?qn(Se):null,dir:ye?qn(ye):null,shown:Mt,symbol:"",className:""},at=J.deserializeHotspots({},bt,gt,lt);return at.title=ee,at.flyTo=!1,at.flyToTarget=null,at.occludable=!0,at.pinGlow=!1,at.pinType=Fn.O.PlusMinus,at.shown=Mt,at.hideWire=!0,at.theme=ut.D.StudioNext,at.pinType=bi(Ge),vi(at.id,B),at}(U,J,ee),actionFn:ee=>function ho(U,J){return J.objectId?(U.dispatch(new Ve.Sh(J,!0)),J):null}(U,ee),mapFnOut:ee=>ee?Ks(U,ee.id):null},{procName:q.t.HotspotsUpdate,mapFnIn:ee=>function mo(U,J){const B=Jn(U,J.id);return B?function lo(U,J){const{title:B,objectId:ee,direction:pe,position:Se,shown:ye,type:Ae}=U,Ge={...J,title:B,objectId:ee,shown:ye,pos:Se?qn(Se):null,dir:pe?qn(pe):null,pinType:Ae?bi(Ae):null};return vi(J.id,U),{...J,...(0,A.omitBy)(Ge,A.isNil)}}(J,B):null}(U,ee),actionFn:ee=>ee?function _o(U,J){return U.dispatch(new Ve.lb(J)),J}(U,ee):null},{procName:q.t.HotspotsDestroy,mapFnIn:ee=>Jn(U,ee),actionFn:ee=>ee?function go(U,J){return U.dispatch(new Ve.vx(J)),J}(U,ee):null},{procName:q.t.HotspotsShow,mapFnIn:ee=>Hs(U,ee),actionFn:ee=>Oi(U,ee,!0)},{procName:q.t.HotspotsHide,mapFnIn:ee=>Hs(U,ee),actionFn:ee=>Oi(U,ee,!1)}]}var vo=n(49746),So=n(1300),bo=n(59429),Pi=n(16124),Eo=n(95370);function Mi(U){return U.selectSnapshot(Ie.y.getChapterLabels)}function Ti(U,J){return U.dispatch(new Ve.eH(J)),!0}function An(U,J){return Mi(U).find(ee=>J===ee.id)}function Xs(U,J){return Mi(U).filter(ee=>J.includes(ee.id))}function Qs(U,J,B){return J&&J.objectId?(U.dispatch(B?new Ve.Sh(J,!0):new Ve.lb(J)),J):null}function Di(U,J){const B=document.createElement("span");return B.innerHTML=U,(0,A.trim)(B.textContent).length<=J}function Ai(U,J){const B=(0,A.cloneDeep)(U);return B.title=J.title&&Di(J.title,100)?J.title:B.title,B.description=J.description&&Di(J.description,300)?J.description:B.description,B.theme=J.theme||B.theme,B.pinType=J.pinType||B.pinType,B.sequentialType=J.sequentialType||B.sequentialType,B.offset=function Mo(U,J){return J||[-(U.hideWire?20:32),0]}(B,J.labelOffset),B.pinGlow=void 0!==J.pinGlow?J.pinGlow:B.pinGlow,B.hideWire=void 0!==J.hideWire?J.hideWire:B.hideWire,B.hideTag=void 0!==J.hideTag?J.hideTag:B.hideTag,B.collapseDescription=void 0!==J.collapseDescription?J.collapseDescription:B.collapseDescription,B.occludable=void 0!==J.occludable?J.occludable:B.occludable,B.cameraPosition=J.flyToCamera||B.cameraPosition,B.flyTo=function To(U,J){return!1!==J&&(J||U.flyTo)}(B,J.flyTo),B.states=function Do(U){if(!U.flyTo)return[];const J=[new Pi.B,new Pi.B];J[0].errands=[new So.T],J[1].errands=U.cameraPosition?[new Eo.v(U.cameraPosition)]:[new vo.F(U.objectId)]}(B),B}function In(U,J){if(J){const B=U.getMarkerById(J.id),ee=U.getMarkerWorldPosition(B);return B||console.warn(`No marker found for label ${J.id}`),{labelId:J.id,objectId:J.objectId,title:J.title,description:J.description,theme:J.theme,pinType:J.pinType,labelOffset:J.offset,hideWire:J.hideWire,pinGlow:J.pinGlow,occludable:J.occludable,sequentialType:J.sequentialType,shown:J.shown,collapseDescription:J.collapseDescription,hideTag:J.hideTag,flyTo:!0===J.flyTo,flyToCamera:J.cameraPosition,position:ee??J.pos,canvasPosition:B?.screenPosition??[-1,-1],occluded:B?.occluded??!0}}return null}function Ii(U,J){return J.reduce((B,ee)=>(B[ee.id]=In(U,ee),B),{})}var Ro=n(8358),Lo=n(78109),Ri=n(39358),es=function(U){return U.Widget="widget",U.WidgetAPI="widgetapi",U}(es||{}),Uo=n(64566),jo=n(24552),Rn=n(43753),Kt=n(87710),ts=n(76774);function Ys(U){return U.selectSnapshot(Kt.j.getAllQuestions)}function Js(U,J){return Ys(U).find(B=>B.id===J)}function Li(U){return Js(U,qs(U))}function Ln(U){return{enabled:U.selectSnapshot(Kt.j.getQuizEnabled),active:U.selectSnapshot(Kt.j.getQuizModeActive),questions:wo(Ys(U)),questionId:qs(U),submissions:Bo(U,Zs(U))}}function Bo(U,J){return J.map(B=>Ui(U,B))}function Ui(U,J){const B=Li(U);return{questionId:J.questionId,answerIds:B.data.correctAnswer,correctAnswerIds:ni(B),correct:(0,ts.Br)(B,J.answer)}}function Zs(U){return U.selectSnapshot(Kt.j.getAllSubmissions)}function qs(U){return U.selectSnapshot(Kt.j.getActiveQuestionId)}function ei(U){const J=Li(U),B=function No(U){return Zs(U).find(B=>B.questionId===qs(U))}(U);return{question:ti(J),submission:B?Ui(U,B):void 0}}function ji(U){return U.map(J=>function ko(U){const J=U.type;switch(J){case ze.m.Markdown:{const{markdown:B}=U;return{type:J,content:B}}case ze.m.Images:{const{images:B}=U;return{type:J,content:B.map(pe=>pe.urls.default)}}default:return{type:J,content:""}}}(J))}function ti(U){let J=[],B="";switch(U.type){case Rn.Q5.MultipleChoice:{const ee=U.data;J=function xo(U){return U.map(J=>function Fo(U){return{answerId:U.value,displayText:U.label}}(J))}(ee.options),B=ee.correctAnswer;break}case Rn.Q5.SelectAnatomy:J=U.data.correctAnswer.map(pe=>({answerId:pe,displayText:pe})),B="";break;case Rn.Q5.LabelAnatomy:J=U.data.options.map(pe=>({answerId:pe.value,displayText:pe.label.title})),B=""}return{questionId:U.id,questionType:U.type,questionPrompt:ji(U.questionPrompt),answerExplanation:ji(U.explanation),answers:J,answerId:B}}function wo(U,J){const B=U.map(ee=>ti(ee));return typeof J<"u"?B.filter(ee=>J.includes(ee.questionId)):B}function ni(U){const J=ti(U);switch(J.questionType){case Rn.Q5.LabelAnatomy:case Rn.Q5.SelectAnatomy:return J.answers.map(({answerId:B})=>B);case Rn.Q5.Instructions:return["-"];default:return[J.answerId]}}var Wo=n(30607),zo=n(28407),ns=n(21626),si=n(40470),$o=n(69984),Ko=n(41981);class ii{}class Ho{}class Xo{}const Qo={headers:new ns.Lr({"Content-Type":"application/json; charset=utf-8"})},Ni="127.0.0.1";let Yo=(()=>{class U{constructor(B,ee){this.http=B,this.storageService=ee}getAnalytic(B){return g.c.offline?(fetch("https://human.biodigital.com/ws/user/analytics?analytic_id="+B,{method:"GET",mode:"no-cors"}),(0,Oe.of)({success:!0})):this.http.get("/ws/user/analytics?analytic_id="+B).pipe((0,u.T)(()=>({success:!0})),(0,we.W)(pe=>(0,Oe.of)(this.parseError(pe))))}sendAnalytic(B){if(g.c.offline){const Se=B instanceof ii?"https://human.biodigital.com/ws/user/analytics":"https://human.biodigital.com/ws/developer/apps/access/key",ye=(0,$o.stringify)(B);if(navigator.onLine)this.sendOfflineAnalytic(Se,ye),this.sendSavedOfflineMessages(Se);else{const Ge="offline_event=1&event_timestamp="+(new Date).toISOString().substring(0,19)+"&"+ye;this.storageService.setDatabaseAnalyticItem({url:Se,message:Ge})}return(0,Oe.of)({success:!0})}return this.http.post(B instanceof ii?"/ws/user/analytics":"/ws/developer/apps/access/key",B,Qo).pipe((0,u.T)(()=>({success:!0})),(0,we.W)(Se=>(0,Oe.of)(this.parseError(Se))))}sendOfflineAnalytic(B,ee){var pe=this;return(0,zo.A)(function*(){fetch(B,{headers:{"Content-Type":"application/x-www-form-urlencoded"},method:"POST",mode:"no-cors",body:ee}).catch(()=>{navigator.onLine?setTimeout(()=>{fetch(B,{headers:{"Content-Type":"application/x-www-form-urlencoded"},method:"POST",mode:"no-cors",body:ee})},300):pe.storageService.setDatabaseAnalyticItem({url:B,message:ee})})})()}sendSavedOfflineMessages(B){this.storageService.getDatabaseOfflineAnalytics(ee=>{ee.forEach(pe=>{this.sendOfflineAnalytic(pe.url??B,pe.message)})})}buildUserAnalytic(B,ee,pe){const{widgetUrlConfig:Se,parentUrl:ye}=B,Ae=Se.uaid,Ge=ye.domain,Qe={...this.buildAppActivityData(B),parent_analytic_identifier:Ae,referer_domain:Ge,[`${ee}_source`]:pe},Ye={analytic_platform:es.Widget,analytic_type:ee,analytic_data:Qe};return g.c.offline&&(Ye.app_domain=Ni),(0,si.bj)(ii,Ye)}buildDeveloperAnalytic(B,ee,pe=es.Widget,Se){const{widgetUrlConfig:ye,parentUrl:Ae,embedded:Ge}=B;return(0,si.bj)(Ho,{platform:pe,app_activity:ee,app_productkey:ye["app-productkey"],app_userid:ye["app-userid"],app_apikey:ye.dk,app_domain:g.c.offline?Ni:Ae.full,app_activity_data:Se,widget_is_fullscreen:!Ge})}buildAppActivityData(B){const{engineVersion:ee,engineAPIVersion:pe,widgetUrlConfig:Se}=B,ye={engine_version:ee,api_version:pe};return Object.entries(Se).filter(([Ae])=>"dk"!==Ae).forEach(([Ae,Ge])=>{ye[`url_param_${Ae}`]=Ge}),(0,si.bj)(Xo,ye)}parseError(B){if(g.c.offline)return{success:!0,message:"",errorCode:null};const ee=B.error.error,pe=B.status,ye=ee&&ee.message?ee.message:"";return{success:pe>=500&&pe<=504,message:ye,errorCode:Object.values(Ko.U).includes(ye)?ye:null}}static#e=this.\u0275fac=function(ee){return new(ee||U)(t.KVO(ns.Qq),t.KVO(R.n$))};static#t=this.\u0275prov=t.jDH({token:U,factory:U.\u0275fac,providedIn:"root"})}return U})();var Bi=function(U){return U.Init="init",U.View="view",U.ChanceInteraction="interactionc",U.FirstInteraction="interactionf",U.Call="call",U}(Bi||{}),oi=n(76718),ss=n(26655),ai=n(83621);class Zo{constructor(J,B,ee){this.subject=J,this.callId=B,this.procedureName=ee}setResult(J){const{callId:B,procedureName:ee}=this;this.subject.next({callId:B,value:J,procedureName:ee})}}const qo=Object.values(j.X),ea=Object.values(_e.F);let ri=(()=>{class U{constructor(B,ee){this.engineService=B,this.applicationEventService=ee,this.proceduresMap={},this.hiddenProcedures={},this.eventsMap={},this.resultsSubject=new S.B,this.logEntries=[],this.ngUnsubscribe=new S.B,this.init()}getAPIProcedureNames(){return Object.keys(this.proceduresMap).filter(B=>!(!0===this.hiddenProcedures[B]))}getAPIEventNames(){const B=Object.keys(this.eventsMap);return[j.X.HumanReady,...B]}logAPIProcedure(B){this.logEntries.length>1e4&&this.logEntries.shift(),this.logEntries.push({engine_version:ss.A,api_version:ss.m,identifier:B,category:B.split(".")[0]})}getAPILog(){return this.logEntries}resetAPILog(){this.logEntries.length=0}callAPIProcedure(B,ee,pe){const Se=this.proceduresMap[ee];Se?Se(B,pe):console.warn("API:",`Target procedure not found: ${ee}`)}defineAPIEvent(B,ee){this.eventsMap[B]&&console.warn("API:",`Redefining event: ${B}`),this.eventsMap[B]=ee||B}defineAPIProcedure(B,ee,pe){this.proceduresMap[B]&&console.warn("API:",`Redefining procedure: ${B}`),this.hiddenProcedures[B]=!0===pe?.hidden,this.proceduresMap[B]=(Se,ye)=>{ee.call(new Zo(this.resultsSubject,Se,B),ye??{})}}onResults(){return this.resultsSubject.asObservable()}getEvent(B,ee){let pe;if(qo.includes(B)?pe=this.engineService.getEvent(B):ea.includes(B)&&(pe=this.applicationEventService.getEvent(B)),!(0,A.isNil)(pe))return ee?pe.pipe((0,r.s)(1)):pe}init(){const B=this;this.defineAPIProcedure("apiEvents.on",function(ee){B.enableEvent.call(B,this,ee,!1)},{hidden:!0}),this.defineAPIProcedure("apiEvents.once",function(ee){B.enableEvent.call(B,this,ee,!0)},{hidden:!0})}enableEvent(B,ee,pe){if(!this.eventsMap[ee])return void console.warn("API:",`Event: ${ee} not defined.`);const Se=this.eventsMap[ee];if("string"==typeof Se){const ye=this.getEvent(Se,pe);ye?ye.subscribe(Ae=>{B.setResult(Ae)}):console.warn("API:",`Error defining event: ${ee}`)}else this.mapEvents(B,Se,pe)}mapEvents(B,ee,pe){const Se=ee.events,ye=ee.map;ee.init&&ee.init();const Ge=Se.map(Qe=>{const Ye=this.getEvent(Qe,pe);if(Ye)return Ye;console.warn("API:",`Error defining event: ${Qe}`)}).filter(Qe=>!(0,A.isNil)(Qe));(0,oi.h)(...Ge).subscribe(function Ae(Qe){const Ye=ye?ye(Qe):Qe;null!==Ye&&B.setResult(Ye||{})})}static#e=this.\u0275fac=function(ee){return new(ee||U)(t.KVO(se.y),t.KVO(ai.S))};static#t=this.\u0275prov=t.jDH({token:U,factory:U.\u0275fac,providedIn:"root"})}return U})(),ta=(()=>{class U{constructor(B,ee,pe){this.engineService=B,this.rpcService=ee,this.zone=pe,this.responseQueue=[],this.listening=!1,this.listen()}listen(){this.listening||(this.ngUnsubscribe||(this.ngUnsubscribe=new S.B),this.zone.runOutsideAngular(()=>{this._listen()}))}close(){this.ngUnsubscribe&&(this.ngUnsubscribe.next(),this.ngUnsubscribe.complete(),this.ngUnsubscribe=null,this.listening=!1)}_listen(){this.listening=!0,this.engineService.getEvent(j.X.Started).pipe((0,P.Q)(this.ngUnsubscribe)).subscribe(()=>{this.sendResponse({message:"status",status:"ready"})}),this.rpcService.onResults().pipe((0,P.Q)(this.ngUnsubscribe)).subscribe(({callId:B,value:ee})=>{this.sendResponse({results:{[B]:ee}})}),(0,C.R)(window,"message").pipe((0,P.Q)(this.ngUnsubscribe)).subscribe(B=>{const ee=this.getClientRequest(B.data);if(!ee)return;const{action:pe,call:Se}=ee;"connect"===pe?this.client||(this.client=B.source,this.clientOrigin=B.origin,this.sendResponse({message:"connected"}),this.flushResponseQueue()):Se&&this.executeCall(ee)})}getClientRequest(B){try{return JSON.parse(B)}catch{return}}sendResponse(B){const ee=JSON.stringify(B);this.client?this.postClientMessage(ee):this.responseQueue.push(ee)}postClientMessage(B){this.client.postMessage(B,this.clientOrigin)}flushResponseQueue(){for(;this.responseQueue.length>0;)this.postClientMessage(this.responseQueue.pop())}executeCall(B){const{id:ee,call:pe,params:Se}=B;try{this.rpcService.callAPIProcedure(ee,pe,Se),this.rpcService.logAPIProcedure(pe)}catch(ye){console.error("API:",`Error executing API call [callId: ${ee}, procedure: ${pe}]: ${ye}`)}}static#e=this.\u0275fac=function(ee){return new(ee||U)(t.KVO(se.y),t.KVO(ri),t.KVO(t.SKi))};static#t=this.\u0275prov=t.jDH({token:U,factory:U.\u0275fac,providedIn:"root"})}return U})();var ki=n(46799),na=n(3367),sa=n(35650),oa=n(79435),aa=n(17042),ra=n(13976),la=n(30582);let ca=(()=>{class U{constructor(B,ee,pe,Se,ye,Ae,Ge,Qe,Ye,ct,gt,bt,Mt,He,lt,at,Ct,St,Tt,Nt,xt,rs){this.store=B,this.actions=ee,this.cameraService=pe,this.engineService=Se,this.animationService=ye,this.paintService=Ae,this.labelsService=Ge,this.graphService=Qe,this.viewService=Ye,this.analyticsService=ct,this.visibilityLayersService=gt,this.legacyVisibilityLayersService=bt,this.quizService=Mt,this.rpcService=He,this.windowClient=lt,this.applicationEventService=at,this.engineRendererService=Ct,this.markerService=St,this.sceneService=Tt,this.contentInfoService=Nt,this.contentBlocksService=xt,this.snapshotService=rs}listen(B,ee){this.ngUnsubscribe||(this.ngUnsubscribe=new S.B),g.c.native&&this.initNativeEventListeners(),this.initProcedures(),this.initEvents(),B&&ee&&this.logAPIUsage(ee)}close(){this.ngUnsubscribe&&(this.ngUnsubscribe.next(),this.ngUnsubscribe.complete(),this.ngUnsubscribe=null)}logAPIUsage(B){setInterval(()=>{const pe=this.rpcService.getAPILog(),Se=(0,A.uniqBy)(pe,ye=>ye.identifier);if(Se.length>0){const ye=JSON.stringify(Se),Ae=this.analyticsService.buildDeveloperAnalytic(B,Bi.Call,es.WidgetAPI,ye);this.analyticsService.sendAnalytic(Ae).pipe((0,P.Q)(this.ngUnsubscribe)).subscribe({next:Ge=>{},error:Ge=>{throw new Error(Ge)}}),this.rpcService.resetAPILog()}},1e4)}initEvents(){At(this.rpcService,j.X.HumanProgress,void 0,B=>B),function mn(U){return[{eventName:j.X.HumanReady,aliasEvents:[j.X.HumanStarted]},{eventName:j.X.Error,aliasEvents:[j.X.HumanError],mapFn:J=>J},{eventName:j.X.HumanCanvasResized,aliasEvents:[j.X.CanvasResized],mapFn:()=>U.selectSnapshot(re.S.getEnginePosition)}]}(this.store).forEach(B=>{At(this.rpcService,B.eventName,B.aliasEvents,B.mapFn)}),function _n(){return[{eventName:j.X.SceneLoaded,mapFn:()=>!0},{eventName:j.X.ScenePicked,aliasEvents:[j.X.PickPicked],mapFn:wt},{eventName:j.X.SceneObjectsSelected,mapFn:U=>U.selectedObjectsUpdate},{eventName:j.X.SceneObjectsShown,mapFn:U=>U.enabledObjectsUpdate},{eventName:j.X.SceneReady,aliasEvents:[j.X.Started,j.X.SceneReady]},{eventName:j.X.SceneRestored,mapFn:()=>!0},{eventName:j.X.SceneXrayEnabled,mapFn:()=>!0},{eventName:j.X.SceneXrayDisabled,mapFn:()=>!0},{eventName:_e.F.NativeShare,mapFn:U=>U},{eventName:_e.F.NativeDebugMessage,mapFn:U=>U}]}().forEach(B=>{At(this.rpcService,B.eventName,B.aliasEvents,B.mapFn)}),function he(U){return[{eventName:j.X.CameraUpdated,aliasEvents:[j.X.CameraRested],mapFn:()=>Y(U)}]}(this.cameraService).forEach(B=>{At(this.rpcService,B.eventName,B.aliasEvents,B.mapFn)}),function yn(){return[{eventName:j.X.TimelinePlaying,mapFn:U=>U},{eventName:j.X.TimelineCompleted,mapFn:()=>!0},{eventName:j.X.TimelineChapterTransition,mapFn:U=>({previousChapter:U.oldChapterIndex,currentChapter:U.newChapterIndex,time:U.time})}]}().forEach(B=>{At(this.rpcService,B.eventName,B.aliasEvents,B.mapFn)}),[].forEach(B=>{At(this.rpcService,B.eventName,B.aliasEvents,B.mapFn)}),function _t(){return[{eventName:_e.F.UIUpdated,mapFn:U=>(0,Bn.Rh)(U)},{eventName:_e.F.UIWindowUpdated,mapFn:U=>ht(U)}]}().forEach(B=>{At(this.rpcService,B.eventName,B.aliasEvents,B.mapFn)}),function Ao(U,J){return[...so(J),...fo(U),{eventName:_e.F.LabelsChapterInfo,mapFn:B=>Ii(J,B)},{eventName:_e.F.LabelsCreated,mapFn:B=>In(J,B)},{eventName:_e.F.LabelsUpdated,mapFn:B=>In(J,B)},{eventName:_e.F.LabelsDestroyed,mapFn:B=>({labelId:B.id})},{eventName:_e.F.LabelsEntered,mapFn:B=>B},{eventName:_e.F.LabelsLeft,mapFn:B=>B},{eventName:_e.F.LabelsPicked,mapFn:B=>B},{eventName:_e.F.LabelsMoved,mapFn:B=>B},{eventName:_e.F.LabelsEnabled,mapFn:()=>!0},{eventName:_e.F.LabelsDisabled,mapFn:()=>!0},{eventName:_e.F.LabelsShown,mapFn:B=>B},{eventName:_e.F.LabelsHidden,mapFn:B=>B}]}(this.store,this.markerService).forEach(B=>{At(this.rpcService,B.eventName,B.aliasEvents,B.mapFn)}),function Go(U){return[{eventName:_e.F.QuizEntered,mapFn:()=>Ln(U)},{eventName:_e.F.QuizExited,mapFn:()=>!0},{eventName:_e.F.QuizQuestionLoaded,mapFn:J=>J},{eventName:_e.F.QuizAnswerSelected,mapFn:J=>{const{questionId:B,answerId:ee}=J;return{questionId:B,answerId:ee,correctAnswerIds:ni(Js(U,J.questionId))}}},{eventName:_e.F.QuizAnswerSubmitted,mapFn:J=>{const B=Js(U,J.questionId),ee=ni(B);return{questionId:J.questionId,answerIds:J.answer,correctAnswerIds:ee,correct:(0,ts.Br)(B,J.answer)}}},{eventName:_e.F.QuizCompleted,mapFn:()=>{const J=Ys(U),B=Zs(U);return(0,ts.MH)(J,B)}}]}(this.store).forEach(B=>{At(this.rpcService,B.eventName,B.aliasEvents,B.mapFn)}),function ia(){return[{eventName:_e.F.WhiteboardDrawingStarted,mapFn:()=>!0},{eventName:_e.F.WhiteboardDrawingFinished,mapFn:()=>!0},{eventName:_e.F.WhiteboardModeUpdated,mapFn:U=>({mode:U})}]}().forEach(B=>{At(this.rpcService,B.eventName,B.aliasEvents,B.mapFn)})}initProcedures(){(function fn(U,J,B,ee){return[{procName:q.t.HumanInfo,actionFn:()=>({version:U,webglInfo:J.getWEBGLInfo(),apiFunctions:B.getAPIProcedureNames().sort(),apiEvents:B.getAPIEventNames().sort()})},{procName:q.t.HumanCanvasInfo,actionFn:()=>ee.selectSnapshot(re.S.getEnginePosition)}]})(ss.A,this.engineService,this.rpcService,this.store).forEach(B=>{ae(this.rpcService,B)}),gn(this.store,this.actions,this.engineService,this.paintService,this.cameraService,this.graphService,this.animationService,this.viewService,this.visibilityLayersService,this.legacyVisibilityLayersService,this.applicationEventService,this.engineRendererService,this.sceneService,this.contentInfoService,this.contentBlocksService).forEach(B=>{ae(this.rpcService,B)}),function ne(U,J){return[{procName:q.t.CameraInfo,actionFn:()=>F(U).pipe((0,u.T)(()=>Y(J)))},{procName:q.t.CameraOrbit,actionFn:B=>F(U).pipe((0,u.T)(()=>(U.dispatch(new K.RJ(void 0===B.pitch?0:B.pitch,void 0===B.yaw?0:B.yaw)),!0)))},{procName:q.t.CameraPan,actionFn:B=>F(U).pipe((0,u.T)(()=>(U.dispatch(new K.bB(void 0===B.x?0:B.x,void 0===B.y?0:B.y,void 0===B.z?0:B.z)),!0)))},{procName:q.t.CameraReset,actionFn:()=>F(U).pipe((0,_.Z)(()=>U.dispatch(new K.nW)))},{procName:q.t.CameraSet,actionFn:B=>F(U).pipe((0,u.T)(()=>{const ee=B.animate||!1;if(B.objectId)return U.dispatch(new M.W6(B.objectId,ee,B.animationDuration)),!0;const pe=Y(J);return U.dispatch(new K.Ih({eye:B.position||pe.position,look:B.target||pe.target,up:B.up||pe.up},ee)),!0}))},{procName:q.t.CameraZoom,actionFn:B=>F(U).pipe((0,u.T)(()=>(U.dispatch(new K.F5(B||0)),!0)))},{procName:q.t.setCameraMode,actionFn:B=>(U.dispatch(new K.vq("pan"===B?"pan":"rotate")),!0)},{procName:q.t.CameraDisableChapterCamera,actionFn:()=>(U.dispatch(new K.Qn(!1)),!0)},{procName:q.t.CameraEnableChapterCamera,actionFn:()=>(U.dispatch(new K.Qn(!0)),!0)}]}(this.store,this.cameraService).forEach(B=>{ae(this.rpcService,B)}),function Sn(U,J,B){return[{procName:q.t.TimelineQuery,actionFn:()=>({chapters:U.selectSnapshot(ue.N.getStoryChapters).map(pe=>({description:pe.description,displayName:pe.displayName,annotations:pe.labels.map(Ge=>({title:Ge.title,description:Ge.description}))}))}),hideDefinition:!0},{procName:q.t.TimelineInfo,actionFn:()=>F(U).pipe((0,u.T)(([ee])=>function vn(U,J,B){const ee=B.getChapterTimeFrame();return{time:B.getTime(),startTime:ee.firstTime,endTime:ee.lastTime,chapters:J.map(pe=>pe.id),playing:B.isPlaying(),playbackSpeed:en(U)}}(U,ee,J)))},{procName:q.t.TimelinePlay,actionFn:ee=>X(U).pipe((0,_.Z)(()=>{const pe=J.getGlobalTime(),Se=ee.time??pe,ye=ee.loop??!1;let Ae=ee.chapterId;return void 0===Ae&&(Ae=J.mapGlobalTimeToChapterId(Se)),new b.c(Ge=>{U.selectSnapshot(re.S.getChapter)!==Ae&&U.dispatch(new tt.wg(Ae)),U.select(re.S.getChapter).pipe((0,d.p)(ct=>ct===Ae),(0,r.s)(1)).subscribe(()=>function Qe(){if(Se!==pe){const ct=(0,qt.clamp)(J.mapChapterGlobalTime(Ae,ee.time),0,J.getChapterDuration());J.pause(),J.scrub(ct)}J.setAnimationLoop(ye),J.play(),Ge.next(!0),Ge.complete()}())})}))},{procName:q.t.TimelinePause,actionFn:()=>F(U).pipe((0,u.T)(()=>(J.pause(),!0)))},{procName:q.t.TimelineSet,actionFn:ee=>X(U).pipe((0,_.Z)(()=>{if(void 0===ee.time&&void 0===ee.chapterId)return(0,Oe.of)(!0);let pe=ee.chapterId;void 0===pe&&(pe=J.mapGlobalTimeToChapterId(ee.time));const Se=U.selectSnapshot(re.S.getChapter)!==pe;return new b.c(ye=>{function Ae(){let Ge=ee.time??0;Ge=(0,qt.clamp)(J.mapChapterGlobalTime(pe,Ge),0,J.getChapterDuration()),J.pause(),J.scrub(Ge),ye.next(!0),ye.complete()}Se?(U.select(re.S.getChapter).pipe((0,d.p)(Ge=>Ge===pe),(0,r.s)(1)).subscribe(()=>Ae()),U.dispatch(new tt.wg(pe))):Ae()})}))},{procName:q.t.TimelineSetPlaybackSpeed,actionFn:ee=>X(U).pipe((0,u.T)(()=>"number"==typeof ee&&(U.dispatch(new M.Vs(ee)),!0)))},{procName:q.t.TimelineGetPlaybackSpeed,actionFn:()=>X(U).pipe((0,u.T)(()=>en(U)))},{procName:q.t.TimelineNext,actionFn:()=>X(U).pipe((0,u.T)(()=>(B.nextChapter("API"),!0)))},{procName:q.t.TimelinePrev,actionFn:()=>X(U).pipe((0,u.T)(()=>(B.previousChapter("API"),!0)))}]}(this.store,this.animationService,this.viewService).forEach(B=>{ae(this.rpcService,B)}),function Gs(U){return[{procName:q.t.InputEnable,actionFn:()=>(U.dispatch(new Qt(!0)),!0)},{procName:q.t.InputDisable,actionFn:()=>(U.dispatch(new Qt(!1)),!0)}]}(this.store).forEach(B=>{ae(this.rpcService,B)}),function pt(U,J,B,ee,pe){const Se=new Le.t(!1);return J.pipe((0,G.rM)(tt.lM)).subscribe(()=>{Se.next(!0)}),[{procName:q.t.UIGetBackground,actionFn:()=>F(U).pipe((0,u.T)(()=>function Pe(U){const{colors:J,gradientType:B,colorStops:ee}=U;return{colors:Array.isArray(J)?[[J[0],J[1],J[2],J[3]],[J[4],J[5],J[6],J[7]]]:[[0,0,0,0],[0,0,0,0]],gradientType:B,colorStops:ee}}(U.selectSnapshot(ue.N.getSelectedChapterBackground))))},{procName:q.t.UISetBackground,mapFnIn:ye=>{const{colors:Ae,colorStops:Ge,gradientType:Qe}=ye;return{colors:Ae&&We(Ae),gradientType:Qe,colorStops:Ge}},actionFn:ye=>F(U).pipe((0,u.T)(()=>{if(ye){const Ae=it(U,ye);U.dispatch(new tt.pb(Ae))}return!0}))},{procName:q.t.UIPresetBackground,mapFnIn:ye=>{const{colors:Ae,colorStops:Ge,gradientType:Qe}=ye;return{colors:Ae&&We(Ae),gradientType:Qe,colorStops:Ge}},actionFn:ye=>{if(ye){const Ae=it(U,ye);g.c.platform===De.N.SDK&&Se.next(!1),Se.pipe((0,d.p)(Ge=>!!Ge),(0,r.s)(1)).subscribe(()=>{U.dispatch(new tt.EN(Ae))})}return!0}},{procName:q.t.UIGetWorldPosition,actionFn:ye=>F(U).pipe((0,u.T)(()=>{const{worldPos:Ae}=B.pick(ye.x,ye.y);if(Ae){const{0:Ge,1:Qe,2:Ye}=Ae;return{x:Ge,y:Qe,z:Ye}}return null}))},{procName:q.t.UISetOndemand,actionFn:ye=>(U.dispatch([new st.B.ToggleWindow(tn.U.OnDemand,ye.enabled)]),!0)},{procName:q.t.UISetLoadingExperience,actionFn:ye=>((0,A.isEmpty)(ye)?U.dispatch([new st.B.SetInteractType(me.i.None),new st.B.CloseWindow(tn.U.Interact)]):U.dispatch([new st.B.SetInteractType(ye),new st.B.OpenWindow(tn.U.Interact)]),!0)},{procName:q.t.UISetScrollCaptureMode,actionFn:ye=>(U.dispatch(new M.hk(ye)),!0)},{procName:q.t.UISetTutorial,actionFn:ye=>(U.dispatch([new st.B.ToggleWindow(tn.U.Tutorial,ye.enabled),new st.B.StartTutorial(ye.enabled)]),!0)},{procName:q.t.UIGetWindow,actionFn:()=>ht(U.selectSnapshot(Ke.Pf.getOpenWindow))},{procName:q.t.UIGetDisplay,actionFn:()=>F(U).pipe((0,u.T)(()=>{const ye=U.selectSnapshot(Ot.dF.getUI);return(0,Bn.Rh)(ye)}))},{procName:q.t.UISetDisplay,actionFn:ye=>{const Ae=(0,Bn.RS)(ye);return U.dispatch(new En(Ae)),ye}},{procName:q.t.UIResetDisplay,actionFn:()=>{const ye=U.selectSnapshot(Ot.dF.getInitialUI);U.dispatch(new fe.p.SetUI(ye))}},{procName:q.t.UISetQuizLock,actionFn:ye=>(J.pipe((0,G.xi)(Be.nm),(0,r.s)(1)).subscribe(()=>{U.dispatch(new kt.B.SetQuizLocked(ye)),U.dispatch(new kt.B.SetEnableQuizRetake(ye)),!0===ye&&ee.startQuiz()}),!0)},{procName:q.t.UISnapshot,aliases:[q.t.SceneSnapshot],actionFn:ye=>F(U).pipe((0,_.Z)(()=>{const{width:Ae,height:Ge}=B.getCanvas();ye={width:Ae,height:Ge,openInTab:!1,includeDrawCanvas:!1,fileType:"jpeg",quality:.92,...ye};const{width:Qe,height:Ye,openInTab:ct,fileType:gt,includeDrawCanvas:bt}=ye,Mt=U.selectSnapshot(ue.N.getSelectedChapterId),He={width:Qe,height:Ye},lt="jpeg"===gt?Kn.H.JPEG:Kn.H.PNG,at=U.selectSnapshot(ue.N.getSelectedChapterBackground),Ct=[];if(bt){const St=pe.getDrawCanvas(),Tt=pe.getAnnotateElement();St&&Ct.push(St),Tt&&Ct.push(Tt)}return U.dispatch(new Hn.V9(Mt,at,lt,.92,He,"original",!0,!0,Ct)).pipe((0,_.Z)(()=>J.pipe((0,G.xi)(Hn.WX),(0,r.s)(1))),(0,_.Z)(St=>Ws.X.blobToBase64(St.blob)),(0,Je.M)(St=>{ct&&St&&function Ze(U){const J=window.open("","_blank");if(J){const B=J.document.createElement("img");B.src=U,J.document.body.appendChild(B)}}(St)}),(0,we.W)(()=>(0,Oe.of)(null)))}))}]}(this.store,this.actions,this.engineRendererService,this.quizService,this.snapshotService).forEach(B=>{ae(this.rpcService,B)}),function Io(U,J,B,ee,pe,Se){return[...io(U,J,ee,pe),...yo(U,J,ee),{procName:q.t.LabelsInfo,actionFn:ye=>F(U).pipe((0,u.T)(()=>ye.length>0?Xs(U,ye):U.selectSnapshot(Ie.y.getChapterLabels))),mapFnOut:ye=>Ii(ee,ye)},{procName:q.t.LabelsCreate,actionFn:ye=>F(U).pipe((0,u.T)(()=>{if(ye.labelId&&An(U,ye.labelId))return null;if(!ye.objectId)return console.log("attempt to create a label with no objectId."),null;const Ae=function Co(U,J,B){const ee=J.makeDefaultStudioLabel();ee.id=B.labelId||bo.u.idWithPrefix("label"),ee.objectId=B.objectId,ee.pos=B.position,ee.renderableIndex=0,ee.occludable=!!B.position,ee.flyTo=!0,ee.description="",ee.shown=!0;const pe=U.selectSnapshot(ue.N.getSelectedChapter);return pe?(ee.chapterId=pe.id,Ai(ee,B)):null}(U,J,ye);return Qs(U,Ae,!0)}),(0,ce.c)(0)),mapFnOut:ye=>In(ee,ye)},{procName:q.t.LabelsUpdate,actionFn:ye=>F(U).pipe((0,u.T)(()=>{let Ae=null;return An(U,ye.labelId)&&(Ae=function Oo(U,J){return Ai(An(U,J.labelId),J)}(U,ye),Qs(U,Ae,!1)),Ae})),mapFnOut:ye=>In(ee,ye)},{procName:q.t.LabelsCanvasUpdate,actionFn:ye=>F(U).pipe((0,u.T)(()=>{let Ae=null;return An(U,ye.labelId)&&(Ae=function Po(U,J,B,ee){const pe=An(U,ee.labelId),Se=ee.canvasPosition,ye=J.pick(Se[0],Se[1]);return ye&&ye.objectId?(pe.objectId=ye.objectId,pe.pos=[ye.worldPos[0],ye.worldPos[1],ye.worldPos[2]],pe.offset=[pe.hideWire?20:32,0],pe.barycentric=[ye.barycentric[0],ye.barycentric[1],ye.barycentric[2]],pe.primitiveIndex=ye.triIndex,pe.renderableIndex=ye.renderableIndex||0,pe.dir=B.getDirection(ye),pe):null}(U,B,Se,ye),Ae&&Qs(U,Ae,!1)),Ae})),mapFnOut:ye=>In(ee,ye)},{procName:q.t.LabelsDestroy,actionFn:ye=>F(U).pipe((0,u.T)(()=>{const Ae=An(U,ye);return Ae?(U.dispatch(new Ve.vx(Ae)),{labelId:Ae.id}):null}))},{procName:q.t.LabelsShow,actionFn:ye=>F(U).pipe((0,u.T)(()=>(ye.length>0?U.dispatch(new Ve.D3(Xs(U,ye),!0)):Ti(U,!0),!0)))},{procName:q.t.LabelsHide,actionFn:ye=>F(U).pipe((0,u.T)(()=>(ye.length>0?U.dispatch(new Ve.D3(Xs(U,ye),!1)):Ti(U,!1),!0)))},{procName:q.t.LabelsSetEnabled,aliases:[q.t.AnnotationsSetEnabled],actionFn:ye=>{U.dispatch(new M.Gv(ye.enable))},hideDefinition:!0},{procName:q.t.LabelsSetScale,actionFn:ye=>{U.dispatch(new Ve.tH(ye.scale))}}]}(this.store,this.labelsService,this.engineRendererService,this.markerService,this.sceneService,this.cameraService).forEach(B=>{ae(this.rpcService,B)}),function Vo(U,J){function B(ee){return U.selectSnapshot(Kt.j.getQuizModeActive)?ee():{error:"quiz mode is not active"}}return[{procName:q.t.QuizInfo,actionFn:()=>F(U).pipe((0,u.T)(()=>U.selectSnapshot(Kt.j.hasQuiz)?Ln(U):null))},{procName:q.t.QuizSubmit,actionFn:ee=>F(U).pipe((0,u.T)(()=>B(()=>(J.submitQuestion(ee.questionId,ee.answerIds),Ln(U)))))},{procName:q.t.QuizQuestion,actionFn:()=>B(()=>F(U).pipe((0,u.T)(()=>ei(U))))},{procName:q.t.QuizEnter,actionFn:()=>F(U).pipe((0,u.T)(()=>U.selectSnapshot(Kt.j.hasQuiz)?(J.startQuiz(),!0):{error:"quiz not found"}))},{procName:q.t.QuizExit,actionFn:()=>F(U).pipe((0,u.T)(()=>(J.exitQuiz(),!0)))},{procName:q.t.QuizSelectQuestion,actionFn:ee=>B(()=>(U.dispatch(new kt.B.SetActiveQuestion(ee)),Ln(U)))},{procName:q.t.QuizNextQuestion,actionFn:()=>F(U).pipe((0,u.T)(()=>B(()=>(J.nextQuestion(),ei(U)))))},{procName:q.t.QuizPreviousQuestion,actionFn:()=>F(U).pipe((0,u.T)(()=>B(()=>(U.dispatch(new kt.B.SetQuizLifecycle(jo.h.Question)),U.dispatch(new kt.B.PreviousQuestion),ei(U)))))},{procName:q.t.QuizReset,actionFn:()=>F(U).pipe((0,u.T)(()=>(J.resetQuiz(),Ln(U))))},{procName:q.t.QuizSet,actionFn:ee=>F(U).pipe((0,u.T)(()=>{const{settings:pe,startNumber:Se,endNumber:ye,locked:Ae}=ee;if(!(0,A.isNil)(pe)){const Qe=U.selectSnapshot(Kt.j.getQuizSettings);U.dispatch(new kt.B.SetQuizSettings({...Qe,...pe}))}if("number"==typeof Se||"number"==typeof ye){const Qe=U.selectSnapshot(ue.N.getStoryChapters),Ye=(0,ts.En)(Qe),bt=Ye.slice("number"==typeof Se?Se-1:0,"number"==typeof ye?ye:Ye.length);U.dispatch(new kt.B.SetQuestions(bt))}return"boolean"==typeof Ae&&U.dispatch(new kt.B.SetQuizLocked(Ae)),U.dispatch(new kt.B.SetQuizQuestionsMode("number"==typeof Se&&"number"==typeof ye?"restricted":"all")),Ln(U)}))}]}(this.store,this.quizService).forEach(B=>{ae(this.rpcService,B)})}initNativeEventListeners(){this.applicationEventService.getEvent(_e.F.NativeSetBaseDirectory).pipe((0,P.Q)(this.ngUnsubscribe)).subscribe(B=>{window.localBaseDirectory=B}),this.applicationEventService.getEvent(_e.F.NativeSetSdkOffline).pipe((0,P.Q)(this.ngUnsubscribe)).subscribe(B=>{window.sdkOffline=!0===B})}static#e=this.\u0275fac=function(ee){return new(ee||U)(t.KVO(G.il),t.KVO(G.En),t.KVO(ie.j),t.KVO(se.y),t.KVO(bn.O),t.KVO(Z.s),t.KVO(Ro.x),t.KVO(Lo.w),t.KVO(Ri.z),t.KVO(Yo),t.KVO(Uo.u),t.KVO(aa.n),t.KVO(Wo.k),t.KVO(ri),t.KVO(ta),t.KVO(ai.S),t.KVO(ki.z),t.KVO(na.m),t.KVO(sa.w),t.KVO(oa.T),t.KVO(ra.V),t.KVO(la.M))};static#t=this.\u0275prov=t.jDH({token:U,factory:U.\u0275fac,providedIn:"root"})}return U})();var wn=n(38165),Gn=n(6795),da=n(27044),li=n(90908);let ua=(()=>{class U{constructor(B){this.viewService=B}initialize(){window.BDGlobalActions={toggleTutorial:B=>this.viewService.toggleTutorial(B)}}static#e=this.\u0275fac=function(ee){return new(ee||U)(t.KVO(Ri.z))};static#t=this.\u0275prov=t.jDH({token:U,factory:U.\u0275fac,providedIn:"root"})}return U})();var pa=n(5690),ha=n(82633),xi=n(66571),_a=n(78674),Fi=n(47428),ga=n(95416),Wt=n(49969),wi=n(26779);const ma=["*"];let Gi=(()=>{class U{constructor(){this.type="message",this.dismissClick=new t.bkB}ngOnInit(){}handleDismissClicked(){this.dismissClick.emit()}static#e=this.\u0275fac=function(ee){return new(ee||U)};static#t=this.\u0275cmp=t.VBU({type:U,selectors:[["app-header-notification"]],inputs:{type:"type"},outputs:{dismissClick:"dismissClick"},ngContentSelectors:ma,decls:8,vars:10,consts:[[1,"header-notification","flex","flex-row","justify-center"],[1,"text-sm","flex","flex-row","justify-center","items-center","flex-auto"],[1,"mr-3"],["icon","exclamation-triangle"],["app-button","","buttonType","text","buttonTheme","light","type","button","title","Dismiss",3,"click"],["icon","times","size","lg"]],template:function(ee,pe){1&ee&&(t.NAR(),t.j41(0,"div",0)(1,"div",1)(2,"div",2),t.nrm(3,"app-icon",3),t.k0s(),t.j41(4,"div"),t.SdG(5),t.k0s()(),t.j41(6,"button",4),t.bIt("click",function(){return pe.handleDismissClicked()}),t.nrm(7,"app-icon",5),t.k0s()()),2&ee&&(t.AVh("header-notification--message","message"===pe.type)("header-notification--error","error"===pe.type)("header-notification--notification","notification"===pe.type)("header-notification--warning","warning"===pe.type),t.Y8G("@inFromTop",void 0),t.R7$(6),t.BMQ("aria-label","Dismiss"))},dependencies:[x.Q,wi.R],styles:[".header-notification[_ngcontent-%COMP%]{position:fixed;z-index:10000;width:100vw;color:#fff;padding:8px}.header-notification--message[_ngcontent-%COMP%]{background-color:#138032}.header-notification--error[_ngcontent-%COMP%]{background-color:#a81914}.header-notification--notification[_ngcontent-%COMP%]{background-color:#1c5ab9}.header-notification--warning[_ngcontent-%COMP%]{color:#1c2a3f;background-color:#ffb92e}"],data:{animation:[(0,Wt.hZ)("inFromTop",[(0,Wt.kY)(":enter",[(0,Wt.iF)({transform:"translateY(-100%)"}),(0,Wt.i0)("250ms ease-out",(0,Wt.iF)({transform:"*"}))])])]},changeDetection:0})}return U})();function fa(U,J){if(1&U){const B=t.RV6();t.j41(0,"app-header-notification",1),t.bIt("dismissClick",function(){t.eBV(B);const pe=t.XpG();return t.Njj(pe.handleHeaderDismissClick())}),t.j41(1,"div",2),t.EFF(2,"You are offline. Check your data or wifi connection."),t.k0s()()}}let ya=(()=>{class U{constructor(B){this.changeRef=B,this.enabled=!g.c.native,this.offline=!1,this.seen=!1,this.ngUnsubscribe=new S.B}ngOnInit(){this.offline=!window.navigator.onLine;const B=(0,C.R)(window,"online"),ee=(0,C.R)(window,"offline");(0,oi.h)(B,ee).pipe((0,P.Q)(this.ngUnsubscribe)).subscribe(()=>{this.offline=!window.navigator.onLine,this.offline&&(this.seen=!1),this.changeRef.markForCheck()})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}handleHeaderDismissClick(){this.seen=!0}static#e=this.\u0275fac=function(ee){return new(ee||U)(t.rXU(t.gRc))};static#t=this.\u0275cmp=t.VBU({type:U,selectors:[["app-offline-message"]],decls:1,vars:1,consts:[["type","warning",3,"dismissClick",4,"ngIf"],["type","warning",3,"dismissClick"],[1,"text-sm"]],template:function(ee,pe){1&ee&&t.DNE(0,fa,3,0,"app-header-notification",0),2&ee&&t.Y8G("ngIf",pe.enabled&&pe.offline&&!pe.seen)},dependencies:[a.bT,Gi],changeDetection:0})}return U})();var Vn=n(21082),Vi=n(1670),va=n(94909),Sa=n(87145),ba=n(27182),Ea=n(25382),Wi=n(47632),Ca=n(15623),zi=n(38104),$i=n(21424),Ht=n(74459),Un=n(43442),Oa=n(39596),Pa=n(72760),Ma=n(72865),Ta=n(30234),Ki=n(35286);function Da(U,J){if(1&U){const B=t.RV6();t.j41(0,"button",6),t.bIt("click",function(){t.eBV(B);const pe=t.XpG();return t.Njj(pe.handleActionClick())}),t.EFF(1),t.k0s()}if(2&U){const B=t.XpG();t.R7$(),t.SpI(" ",B.buttonLabel," ")}}let Aa=(()=>{class U{constructor(){this.dismissClick=new t.bkB,this.actionClick=new t.bkB}ngOnInit(){}handleActionClick(){this.actionClick.emit()}handleDismissClick(){this.dismissClick.emit()}static#e=this.\u0275fac=function(ee){return new(ee||U)};static#t=this.\u0275cmp=t.VBU({type:U,selectors:[["app-footer-notification"]],inputs:{label:"label",buttonLabel:"buttonLabel",compact:"compact"},outputs:{dismissClick:"dismissClick",actionClick:"actionClick"},decls:8,vars:9,consts:[["data-test","footerNotification",1,"footer-notification","flex","flex-row","items-start","justify-center"],[1,"footer-notification__wrapper"],["data-test","footerNotificationTitle",1,"footer-notification__title","text-base","html",3,"innerHTML"],["app-button","","buttonType","primary","data-test","footerNotificationAction",3,"click",4,"ngIf"],["app-button","","buttonType","default","buttonTheme","light","type","button","title","Close","data-test","footerNotificationDismiss",1,"footer-notification__close",3,"click"],["icon","times","size","lg"],["app-button","","buttonType","primary","data-test","footerNotificationAction",3,"click"]],template:function(ee,pe){1&ee&&(t.j41(0,"div",0)(1,"div",1),t.nrm(2,"div",2),t.nI1(3,"markdown"),t.nI1(4,"async"),t.DNE(5,Da,2,1,"button",3),t.k0s(),t.j41(6,"button",4),t.bIt("click",function(){return pe.handleDismissClick()}),t.nrm(7,"app-icon",5),t.k0s()()),2&ee&&(t.AVh("footer-notification--compact",pe.compact),t.R7$(2),t.Y8G("innerHTML",t.bMT(4,7,t.bMT(3,5,pe.label)),t.npT),t.R7$(3),t.Y8G("ngIf",pe.buttonLabel),t.R7$(),t.BMQ("aria-label","Close"))},dependencies:[a.bT,x.Q,wi.R,a.Jj,Ki.i0],styles:[".footer-notification[_ngcontent-%COMP%]{padding:16px 40px;background-color:#fff;box-shadow:0 11px 15px #0003,0 24px 38px #00000024,0 9px 46px #0000001f}.footer-notification__wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:center;flex:1 1 auto}.footer-notification__title[_ngcontent-%COMP%]{margin-right:40px}.footer-notification--compact[_ngcontent-%COMP%]   .footer-notification__wrapper[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;justify-content:flex-start}.footer-notification--compact[_ngcontent-%COMP%]   .footer-notification__title[_ngcontent-%COMP%]{margin-right:auto;margin-bottom:20px}"],changeDetection:0})}return U})();var ci=function(U,J,B,ee){var ye,pe=arguments.length,Se=pe<3?J:null===ee?ee=Object.getOwnPropertyDescriptor(J,B):ee;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)Se=Reflect.decorate(U,J,B,ee);else for(var Ae=U.length-1;Ae>=0;Ae--)(ye=U[Ae])&&(Se=(pe<3?ye(Se):pe>3?ye(J,B,Se):ye(J,B))||Se);return pe>3&&Se&&Object.defineProperty(J,B,Se),Se},di=function(U,J){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(U,J)};const Ia=()=>["/account/profile"],Ra=()=>({section:"subscription",mode:"edit"});function La(U,J){if(1&U){const B=t.RV6();t.j41(0,"app-header-notification",6),t.bIt("dismissClick",function(){t.eBV(B);const pe=t.XpG(3);return t.Njj(pe.handleHeaderDismissClick(pe.headerNotification))}),t.j41(1,"div",7),t.EFF(2," Your Personal Pro subscription has expired. Please update your "),t.j41(3,"span",8),t.EFF(4," payment information "),t.k0s(),t.EFF(5," to keep enjoying full access. "),t.k0s()()}2&U&&(t.R7$(3),t.Y8G("routerLink",t.lJ4(2,Ia))("queryParams",t.lJ4(3,Ra)))}function Ua(U,J){if(1&U&&(t.j41(0,"div",4),t.DNE(1,La,6,4,"app-header-notification",5),t.k0s()),2&U){const B=t.XpG(2);t.Y8G("ngSwitch",B.headerNotification.type),t.R7$(),t.Y8G("ngSwitchCase",B.gateTypes.ProAccountPastDue)}}function ja(U,J){if(1&U){const B=t.RV6();t.j41(0,"div",9)(1,"app-footer-notification",10),t.nI1(2,"async"),t.bIt("actionClick",function(){t.eBV(B);const pe=t.XpG(2);return t.Njj(pe.handleActionClick(pe.footerNotification.type))})("dismissClick",function(){t.eBV(B);const pe=t.XpG(2);return t.Njj(pe.handleFooterDismissClick(pe.footerNotification))}),t.k0s()()}if(2&U){const B=t.XpG(2);t.Y8G("@inFromBottom",void 0),t.R7$(),t.Y8G("label",B.footerNotification.data.title)("compact",t.bMT(2,4,B.horizontalBreakpoint$)<B.breakPoints.Medium)("buttonLabel",B.footerNotification.data.actionText)}}function Na(U,J){if(1&U&&(t.j41(0,"div",1),t.DNE(1,Ua,2,2,"div",2)(2,ja,3,6,"div",3),t.k0s()),2&U){const B=t.XpG();t.R7$(),t.Y8G("ngIf",B.headerNotification),t.R7$(),t.Y8G("ngIf",B.footerNotification)}}class sn{constructor(J,B,ee,pe,Se,ye,Ae,Ge,Qe,Ye){this.store=J,this.actions=B,this.router=ee,this.activatedRoute=pe,this.userAccessService=Se,this.bookmarksService=ye,this.bookmarkActionService=Ae,this.storageService=Ge,this.dialogService=Qe,this.changeRef=Ye,this.breakPoints=Ca.m,this.displayTypes=Ht.q,this.gateTypes=Un.j,this.ngUnsubscribe=new S.B,this.initUtilityStates()}ngOnInit(){this.initNotificationListeners(),this.initContentViews(),this.initContentSaves(),this.initFreeTrial(),this.initPastDue(),this.initContentViewsCheck(),this.initZSpaceRestriction()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initZSpaceRestriction(){this.story$.pipe((0,d.p)(J=>!(0,A.isNil)(J)&&this.isContentViewPage(this.router.url)),(0,P.Q)(this.ngUnsubscribe)).subscribe(J=>{const B=this.bookmarksService.getZSpaceRestriction()!==Ta.O.None,ee=this.bookmarksService.isZSpaceModel(J);B&&ee&&this.router.navigateByUrl(Ma.Wj)})}initContentViewsCheck(){this.store.select(k.k.getUserProfile).pipe((0,u.T)(J=>!(0,A.isNil)(J)),(0,Vn.F)(),(0,d.p)(J=>J),(0,P.Q)(this.ngUnsubscribe)).subscribe(()=>{this.store.dispatch(new wn.OF)})}initUtilityStates(){this.pageNavigation$=(0,oi.h)(this.activatedRoute.url,this.router.events.pipe((0,d.p)(J=>J instanceof c.wF))).pipe((0,u.T)(()=>this.router.url))}initNotificationListeners(){const J=this.store.select(k.k.getLoggedIn).pipe((0,Vi.J)(),(0,u.T)(([B,ee])=>B===ee?"unchanged":!B&&ee?"loggingIn":"loggingOut"),(0,Vn.F)());this.actions.pipe((0,G.xi)(wn.$_),(0,P.Q)(this.ngUnsubscribe)).subscribe(B=>{const{display:pe}=B;switch(pe){case Ht.q.Notification:this.headerNotification=B;break;case Ht.q.Footer:this.footerNotification=B}this.changeRef.markForCheck()}),this.actions.pipe((0,G.xi)(wn.rH),(0,P.Q)(this.ngUnsubscribe)).subscribe(B=>{B.displays.forEach(ee=>{switch(ee){case Ht.q.Notification:this.headerNotification=void 0;break;case Ht.q.Footer:this.footerNotification=void 0}}),this.changeRef.markForCheck()}),this.pageNavigation$.pipe((0,va.E)(J),(0,d.p)(([,B])=>"loggingIn"!==B),(0,P.Q)(this.ngUnsubscribe)).subscribe(()=>{this.userAccessService.clearDialogs();const B=this.isEditPage(this.router.url);this.clearNotifications(B,!0)}),this.actions.pipe((0,G.xi)(wn.fQ),(0,P.Q)(this.ngUnsubscribe)).subscribe(()=>{this.clearNotifications(!0,!0),this.changeRef.markForCheck()})}initContentViews(){const J=this.pageNavigation$.pipe((0,u.T)(()=>this.isContentViewPage(this.router.url)),(0,Vn.F)((Se,ye)=>Se===ye),(0,d.p)(Se=>Se));let B;this.pageNavigation$.pipe((0,u.T)(()=>this.router.url),(0,Vi.J)(),(0,P.Q)(this.ngUnsubscribe)).subscribe(([Se,ye])=>{B=Se});const ee=this.contentViews$.pipe((0,u.T)(Se=>Se.limit_reached),(0,Vn.F)());J.pipe((0,d.p)(()=>!this.store.selectSnapshot(k.k.isPremiumUser)),(0,_.Z)(()=>ee),(0,d.p)(Se=>Se),(0,_.Z)(()=>this.userAccessService.openBookmarkViewLimit()),(0,P.Q)(this.ngUnsubscribe)).subscribe(Se=>{if(!Se)return;const ye=this.router.url,Ae=this.isContentViewPage(B),Ge=this.isLoginPage(B),Qe=this.isAccountPage(B);this.isAccountPage(ye)||((0,A.isNil)(B)||Qe||Ge||Ae?this.router.navigate(["/results/bookmarks"]):this.router.navigateByUrl(B))});const pe=this.pageNavigation$.pipe((0,Sa.i)(1),(0,_.Z)(Se=>this.isContentViewPage(Se)?this.store.select(ue.N.getSelectedChapterReadyState).pipe((0,d.p)(Ae=>!(0,A.isNil)(Ae)&&Ae.model)):(0,Oe.of)(!0)));(0,$.z)([pe,this.contentViews$]).pipe((0,Vn.F)((Se,ye)=>Se[1].inapp_view_count===ye[1].inapp_view_count),(0,m.B)(2500),(0,P.Q)(this.ngUnsubscribe)).subscribe(([Se,ye])=>{const{inapp_view_count:Ae,inapp_view_limit:Ge}=ye,Qe=Ae/Ge;Qe>.7&&Qe<1&&(this.userAccessService.openBookmarkViewWarning(Ae,Ge),setTimeout(()=>{this.userAccessService.clearUserNotifications(Ht.q.Footer)},2e4))})}initContentSaves(){this.actions.pipe((0,G.xi)(Wi.lN,Wi.x$),(0,d.p)(()=>!this.store.selectSnapshot(k.k.isPremiumUser)),(0,_.Z)(()=>this.bookmarkActionService.checkBookmarkLimit()),(0,m.B)(2500),(0,P.Q)(this.ngUnsubscribe)).subscribe(J=>{const{inapp_content_limit:B,inapp_content_count:ee}=J,pe=ee/B;pe>.6&&pe<1&&(this.userAccessService.openBookmarkSaveWarning(ee,B),setTimeout(()=>{this.userAccessService.clearUserNotifications(Ht.q.Footer)},2e4))})}initFreeTrial(){const J=this.store.select($i.q.isSubscriptionExpired);(0,$.z)([J,this.pageNavigation$]).pipe((0,d.p)(([B])=>B),(0,d.p)(()=>"true"!==this.storageService.getLocalItem(R.UT.TeamTrialExpirationSeen)),(0,r.s)(1),(0,m.B)(1e3),(0,P.Q)(this.ngUnsubscribe)).subscribe(([B])=>{B&&this.userAccessService.openTrialExpired()})}initPastDue(){this.store.select(k.k.getUserProfile).pipe((0,d.p)(J=>!(0,A.isNil)(J)),(0,d.p)(()=>"true"!==this.storageService.getLocalItem(R.UT.ProExpirationSeen)),(0,P.Q)(this.ngUnsubscribe)).subscribe(J=>{this.store.selectSnapshot(k.k.getUserType)!==ba.I.Team&&J.subscription&&"past due"===J.subscription.subscription_status&&this.userAccessService.openPastDue()})}handleActionClick(J){switch(J){case Un.j.BookmarkViewThresholdReached:case Un.j.BookmarkSaveThresholdReached:case Un.j.BookmarkViewLimitReached:case Un.j.BookmarkSaveLimitReached:this.dialogService.openUpgradeDialog()}this.clearNotifications(!1,!0)}handleHeaderDismissClick(J){J.type===Un.j.ProAccountPastDue&&this.storageService.setLocalItem(R.UT.ProExpirationSeen,!0),this.clearNotifications(!0,!1),this.changeRef.markForCheck()}handleFooterDismissClick(J){this.clearNotifications(!1,!0),this.changeRef.markForCheck()}clearNotifications(J,B){const ee=[];J&&(ee.push(Ht.q.Notification),this.headerNotification=void 0),B&&ee.push(Ht.q.Footer),this.userAccessService.clearUserNotifications(...ee)}isViewPage(J){return J.startsWith("/view")}isEditPage(J){return J.startsWith("/edit")}isAccountPage(J){return J.startsWith("/account")}isLoginPage(J){return J.startsWith("/login")}isContentViewPage(J){const B=this.isEditPage(J);return this.isViewPage(J)||B}static#e=this.\u0275fac=function(B){return new(B||sn)(t.rXU(G.il),t.rXU(G.En),t.rXU(c.Ix),t.rXU(c.nX),t.rXU(Oa.p),t.rXU(Pa.x),t.rXU(Ea.h),t.rXU(R.n$),t.rXU(xi.o),t.rXU(t.gRc))};static#t=this.\u0275cmp=t.VBU({type:sn,selectors:[["app-user-access"]],decls:1,vars:1,consts:[["class","user-access",4,"ngIf"],[1,"user-access"],["class","user-access__header",3,"ngSwitch",4,"ngIf"],["class","user-access__footer",4,"ngIf"],[1,"user-access__header",3,"ngSwitch"],["type","warning",3,"dismissClick",4,"ngSwitchCase"],["type","warning",3,"dismissClick"],[1,"text-sm"],[1,"text-link","underline",3,"routerLink","queryParams"],[1,"user-access__footer"],[3,"actionClick","dismissClick","label","compact","buttonLabel"]],template:function(B,ee){1&B&&t.DNE(0,Na,3,2,"div",0),2&B&&t.Y8G("ngIf",ee.headerNotification||ee.footerNotification)},dependencies:[a.bT,a.ux,a.e1,c.Wk,Gi,Aa,a.Jj],styles:[".user-access__footer[_ngcontent-%COMP%]{position:fixed;z-index:100;left:0;right:0;bottom:0}"],data:{animation:[(0,Wt.hZ)("inFromBottom",[(0,Wt.kY)(":enter",[(0,Wt.iF)({transform:"translateY(100%)"}),(0,Wt.i0)("250ms ease-out",(0,Wt.iF)({transform:"*"}))])])]},changeDetection:0})}ci([(0,G.l6)(zi.V.getHorizontalBreakpoint),di("design:type",b.c)],sn.prototype,"horizontalBreakpoint$",void 0),ci([(0,G.l6)(k.k.getContentViews),di("design:type",b.c)],sn.prototype,"contentViews$",void 0),ci([(0,G.l6)(H.t.getStory),di("design:type",b.c)],sn.prototype,"story$",void 0);var ui=function(U,J,B,ee){var ye,pe=arguments.length,Se=pe<3?J:null===ee?ee=Object.getOwnPropertyDescriptor(J,B):ee;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)Se=Reflect.decorate(U,J,B,ee);else for(var Ae=U.length-1;Ae>=0;Ae--)(ye=U[Ae])&&(Se=(pe<3?ye(Se):pe>3?ye(J,B,Se):ye(J,B))||Se);return pe>3&&Se&&Object.defineProperty(J,B,Se),Se},pi=function(U,J){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(U,J)};class on{constructor(J,B,ee,pe,Se,ye,Ae,Ge,Qe,Ye,ct,gt,bt,Mt,He,lt,at,Ct,St,Tt,Nt,xt){this.ga=B,this.authService=ee,this.storageService=pe,this.dialog=Se,this.router=ye,this.activatedRoute=Ae,this.viewContainerRef=Ge,this.linkedinInsights=Qe,this.vendorAnalyticsService=Ye,this.widgetAPIHandler=ct,this.engineService=gt,this.applicationEventService=bt,this.store=Mt,this.actions=He,this.zendeskService=lt,this.snackBar=at,this.titleService=Ct,this.globalActionsService=St,this.productService=Tt,this.rpcService=Nt,this.dialogService=xt,this.title="human-studio-next",this.ngUnsubscribe=new S.B,J.loadRouting()}ngOnInit(){this.initPageTitle(),this.initProfileListeners(),this.initPageAnalytics(),this.initGPUAnalytics(),g.c.native&&this.initNativeAPIHooks(),this.userProfile$.pipe((0,d.p)(J=>null!=J),(0,r.s)(1),(0,P.Q)(this.ngUnsubscribe)).subscribe(J=>{this.checkProfileAccess(J)}),this.initZendesk(),this.initVendorAnalytics(),this.globalActionsService.initialize(),this.initZSpace()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initProfileListeners(){this.groupUserProfile$.pipe((0,d.p)(J=>{const B=!0===this.storageService.getLocalJSON(R.UT.TeamWelcomeTourSeen);return!(0,A.isNil)(J)&&!B}),(0,_.Z)(()=>this.dialogService.openWelcomeTourDialog(ha.G.NewUser).afterClosed()),(0,r.s)(1),(0,P.Q)(this.ngUnsubscribe)).subscribe(()=>{this.storageService.setLocalItem(R.UT.TeamWelcomeTourSeen,!0)})}initPageTitle(){const J=this.titleService.getTitle();this.router.events.pipe((0,d.p)(B=>B instanceof c.wF),(0,u.T)(()=>{let B="",ee=this.activatedRoute;for(;ee.firstChild;){const pe=ee.firstChild.snapshot.data.title;(0,A.isNil)(pe)||(B=pe),ee=ee.firstChild}return B}),(0,u.T)(B=>B.length?`${B} | BioDigital Human Platform`:J)).subscribe(B=>{this.titleService.setTitle(B)})}initPageAnalytics(){this.linkedinInsights.initialize(),this.router.events.pipe((0,d.p)(J=>J instanceof c.wF),(0,P.Q)(this.ngUnsubscribe)).subscribe(J=>{this.ga.pageView(J.urlAfterRedirects)})}initZendesk(){this.zendeskService.updateFromProfile(),(0,C.R)(window,"resize").pipe((0,l.Z)((0,li.ZO)()),(0,m.B)(100),(0,u.T)(()=>(0,li.ZO)()),(0,P.Q)(this.ngUnsubscribe)).subscribe(J=>{this.zendeskService.setHelpCenterSuggestions({labels:[J?"webhelp":"mobilehelp"]})}),this.userProfile$.pipe((0,P.Q)(this.ngUnsubscribe)).subscribe(J=>{this.zendeskService.identify(J),this.zendeskService.updateFromProfile(J)}),this.userLocale$.pipe((0,d.p)(J=>!(0,A.isNil)(J)),(0,P.Q)(this.ngUnsubscribe)).subscribe(J=>{this.zendeskService.setLocale(J.lang)})}initVendorAnalytics(){this.vendorAnalyticsService.appendScripts(),this.vendorAnalyticsService.initialize({},{}),this.userProfile$.pipe((0,d.p)(J=>null!=J),(0,r.s)(1),(0,P.Q)(this.ngUnsubscribe)).subscribe(J=>{this.setVendorAnalyticsVisitorData(J)})}initGPUAnalytics(){this.engineService.initAnalytics(this.productService.productType,this.productService.productKey)}setVendorAnalyticsVisitorData(J){this.vendorAnalyticsService.identify(this.vendorAnalyticsService.createVisitorData(J),this.vendorAnalyticsService.createAccountData(J.organizations[0]))}checkProfileAccess(J){const B=this.authService.getProfileRestrictions(J),ee=this.storageService.getLocalJSON(R.UT.GroupRestriction);!0!==(0,A.get)(ee,"dontShowDialog")&&(B.email||B.ip)&&setTimeout(()=>{const Se={id:L.t.GroupRestrictionDialog,width:"480px",height:"auto",data:{...B}};this.dialog.open(D,Se)})}initNativeAPIHooks(){window.HumanWindowAPI=Gn.s,Gn.s.setStore(this.store),Gn.s.setServices(this.rpcService,this.applicationEventService),Gn.s.setSnackBar(this.snackBar),Gn.s.setRouter(this.router),this.widgetAPIHandler.listen(!1),this.engineService.fireEvent(j.X.HumanStarted,null),this.actions.pipe((0,G.xi)(wn.tM)).pipe((0,P.Q)(this.ngUnsubscribe)).subscribe(()=>{this.applicationEventService.fireEvent(_e.F.NativeDeleteData)})}initZSpace(){this.activatedRoute.queryParams.pipe((0,P.Q)(this.ngUnsubscribe)).subscribe(J=>{const B="true"===J.zspace;B&&this.storageService.setLocalItem(R.UT.ZSpaceDevice,B)})}static#e=this.\u0275fac=function(B){return new(B||on)(t.rXU(_a.g),t.rXU(Fi.p),t.rXU(V.u),t.rXU(R.n$),t.rXU(T.bZ),t.rXU(c.Ix),t.rXU(c.nX),t.rXU(t.c1b),t.rXU(Q.n),t.rXU(W.e),t.rXU(ca),t.rXU(se.y),t.rXU(ai.S),t.rXU(G.il),t.rXU(G.En),t.rXU(da.c),t.rXU(ga.UG),t.rXU(e.hE),t.rXU(ua),t.rXU(pa.b),t.rXU(ri),t.rXU(xi.o))};static#t=this.\u0275cmp=t.VBU({type:on,selectors:[["app-root"]],decls:3,vars:0,template:function(B,ee){1&B&&t.nrm(0,"app-user-access")(1,"app-offline-message")(2,"router-outlet")},dependencies:[ya,c.n3,sn],changeDetection:0})}ui([(0,G.l6)(k.k.getUserProfile),pi("design:type",b.c)],on.prototype,"userProfile$",void 0),ui([(0,G.l6)(k.k.getGroupUserProfile),pi("design:type",b.c)],on.prototype,"groupUserProfile$",void 0),ui([(0,G.l6)(k.k.getUserLocale),pi("design:type",b.c)],on.prototype,"userLocale$",void 0);var xa=n(28107),Fa=n(76549),wa=n(16515),Ga=n(10381),Va=n(45189),hi=n(21604),Wa=n(40430);let za=(()=>{class U{static#e=this.\u0275fac=function(ee){return new(ee||U)};static#t=this.\u0275mod=t.$C({type:U});static#n=this.\u0275inj=t.G2t({imports:[a.MD,Va.G,hi.G,Wa.i,G.rK.forFeature([$i.q])]})}return U})();var $a=n(45367),Ka=n(34440),Qi=n(56400),Ha=n(74707);let Xa=(()=>{class U{static#e=this.\u0275fac=function(ee){return new(ee||U)};static#t=this.\u0275mod=t.$C({type:U});static#n=this.\u0275inj=t.G2t({imports:[G.rK.forFeature([k.k,Ka.z]),a.MD,Qi.P,Ha.k]})}return U})(),Qa=(()=>{class U{parse(B){B=B.replace(/&amp;/g,"&");const pe=(new c.nU).parse(B);return this.ensureQueryParam(pe.queryParams,"dk",B),this.ensureQueryParam(pe.queryParams,"uaid",B),pe}serialize(B){return(new c.nU).serialize(B).replace(/%2F/g,"/")}ensureQueryParam(B,ee,pe){if(B.hasOwnProperty(ee))return B;const Se=this.getParameterByName(ee,pe);return null!==Se&&(B[ee]=Se),B}getParameterByName(B,ee){ee||(ee=window.location.href),B=B.replace(/[\[\]]/g,"\\$&");const Se=new RegExp("[?&]"+B+"(=([^&#]*)|&|#|$)").exec(ee);return Se?Se[2]?decodeURIComponent(Se[2].replace(/\+/g," ")):"":null}static#e=this.\u0275fac=function(ee){return new(ee||U)};static#t=this.\u0275prov=t.jDH({token:U,factory:U.\u0275fac})}return U})(),Ya=(()=>{class U{static#e=this.\u0275fac=function(ee){return new(ee||U)};static#t=this.\u0275mod=t.$C({type:U});static#n=this.\u0275inj=t.G2t({imports:[G.rK.forFeature([zi.V]),a.MD]})}return U})();var Ja=n(68504);let Za=(()=>{class U{static#e=this.\u0275fac=function(ee){return new(ee||U)};static#t=this.\u0275mod=t.$C({type:U});static#n=this.\u0275inj=t.G2t({imports:[G.rK.forFeature([Ja.o]),a.MD]})}return U})();var Wn=n(16e3),_i=n(13955),is=function(U){return U[U.Positions=4]="Positions",U[U.Normals=4]="Normals",U[U.UVs=4]="UVs",U}(is||{}),os=function(U){return U[U.Positions=2]="Positions",U[U.Normals=.6666666666666666]="Normals",U[U.UVs=2]="UVs",U}(os||{});let qa=(()=>{class U{constructor(B){this.assetService=B}getBytesPerIndex(B,ee){return B.length<Math.pow(2,8)?1:B.length<Math.pow(2,16)?2:B.length<Math.pow(2,32)?4:void 0}getAsset(B){return this.assetService.getGeometries()[B]}getPositions(B){return this.getAsset(B).geometry._core.arrays.positions}getNormals(B){return this.getAsset(B).geometry._core.arrays.positions}getIndices(B){return this.getAsset(B).geometry._core.arrays.indices}hasUVs(B){return this.getAsset(B).geometry._core.arrays.hasOwnProperty("uvs")}getUVs(B){return this.hasUVs(B)?this.getAsset(B).geometry._core.arrays.uvs[0]:[]}isCompressed(B){return this.getAsset(B).compressed}calculatePositions(B,ee){return this.getPositions(B).length*(ee?os.Positions:is.Positions)}calculateIndices(B,ee){const pe=this.getIndices(B),Se=this.getBytesPerIndex(pe,ee);return pe.length*Se}calculateNormals(B,ee){const pe=this.getNormals(B);return Math.floor(pe.length*(ee?os.Normals:is.Normals))}calculateUVs(B,ee){return this.getUVs(B).length*(ee?os.UVs:is.UVs)}calculateGeometry(B,ee){let pe=0;return pe+=this.calculateIndices(B,ee),pe+=this.calculatePositions(B,ee),pe+=this.calculateNormals(B,ee),pe+=this.calculateUVs(B,ee),pe}getTris(B){return this.getIndices(B).length/3}getVerts(B){return this.getPositions(B).length/3}getGeometryMemory(B){const ee=this.getAsset(B).geometry._core,pe=ee.vertexBuf.itemByteSize*ee.vertexBuf.length,Se=ee.indexBuf.itemByteSize*ee.indexBuf.length,ye=ee.normalBuf.itemByteSize*ee.normalBuf.length;let Ae=0;if(ee.uvBufs)for(let Ge=0;Ge<ee.uvBufs.length;Ge++)Ae+=ee.uvBufs[Ge].itemByteSize*ee.uvBufs[Ge].length;return pe+Se+ye+Ae}getStat(B){return{id:B,tris:this.getTris(B),verts:this.getVerts(B),memory:this.getGeometryMemory(B)}}static#e=this.\u0275fac=function(ee){return new(ee||U)(t.KVO(_i.I))};static#t=this.\u0275prov=t.jDH({token:U,factory:U.\u0275fac,providedIn:"root"})}return U})();var gi=function(U){return U[U.Positions=4]="Positions",U[U.Normals=4]="Normals",U}(gi||{}),mi=function(U){return U[U.Positions=2]="Positions",U[U.Normals=1]="Normals",U}(mi||{});let er=(()=>{class U{constructor(B){this.assetService=B}getAsset(B){return this.assetService.getMorphs()[B]}getPositions(B){return this.getAsset(B).morphGeometry._core.targets[0].positions}getNormals(B){return this.getAsset(B).morphGeometry._core.targets[0].normals}isCompressed(B){return this.getAsset(B).compressed}calculatePositions(B,ee){return this.getPositions(B).length*(ee?mi.Positions:gi.Positions)}calculateNormals(B,ee){return this.getNormals(B).length*(ee?mi.Normals:gi.Normals)}calculateMorph(B,ee){return this.calculatePositions(B,ee)+this.calculateNormals(B,ee)}getVerts(B){return this.getAsset(B).morphGeometry._core.targets[0].positions.length/3}getMorphMemory(B){const ee=this.getAsset(B),pe=ee.morphGeometry._core.targets[0],Se=ee.morphGeometry._core.targets.length;let ye=0;return ye+=Se*(pe.normalBuf.itemByteSize*pe.normalBuf.length),ye+=Se*(pe.vertexBuf.itemByteSize*pe.vertexBuf.length),ye}getStat(B){return{id:B,verts:this.getVerts(B),memory:this.getMorphMemory(B)}}static#e=this.\u0275fac=function(ee){return new(ee||U)(t.KVO(_i.I))};static#t=this.\u0275prov=t.jDH({token:U,factory:U.\u0275fac,providedIn:"root"})}return U})();class Lt{constructor(J,B,ee,pe){this.name=J,this.value=B,this.unit=ee,this.reports=pe}}class tr{constructor(){this.geometryDownloadTotal=0,this.textureDownloadTotal=0,this.jsonDownloadTotal=0}}class Yi{}let Ji=(()=>{class U{constructor(B,ee,pe,Se){this.geometryAssetMemoryService=B,this.morphAssetMemoryService=ee,this.engineRendererService=pe,this.assetService=Se}engineSupportsGeometryCompression(){return this.assetService.getGeometryCompressionSupported()}engineSupportsTextureCompression(){return this.assetService.getTextureCompressionSupported()}getFirstChapterDownloadSize(B){return 0}updateGlobalStats(B,ee){const pe=new tr;pe.memory=this.getTotalMem(B,ee),pe.textureMemory=this.getTotalTexMem(),pe.geometryMemory=this.getTotalGeoMem(B),pe.morphMemory=this.getTotalMorphMem(ee);const Se=this.assetService.getGeometries();pe.uncompressedGeos=Object.values(Se).reduce((Ge,Qe)=>(Qe.compressed||Ge++,Ge),0);const ye=this.assetService.getMorphs();pe.uncompressedMorphs=Object.values(ye).reduce((Ge,Qe)=>{const Ye=Qe.morphGeometry._core;return(!Ye.compressedNormals||!Ye.compressedPositions)&&Ge++,Ge},0);const Ae=this.assetService.getMaterials();return pe.uncompressedTextures=Object.entries(Ae).reduce((Ge,[Qe,Ye])=>(Ye.textures.forEach(ct=>{ct._core.compressed||Ge++}),Ge),0),pe}updateGeoStats(B){null==B&&(B=new Yi);const ee=this.assetService.getGeometries();return Object.keys(ee).forEach(pe=>{B.hasOwnProperty(pe)||(B[pe]=this.geometryAssetMemoryService.getStat(pe))}),B}updateMorphStats(B){null==B&&(B=new Yi);const ee=this.assetService.getMorphs();return Object.keys(ee).forEach(pe=>{B.hasOwnProperty(pe)||(B[pe]=this.morphAssetMemoryService.getStat(pe))}),B}getTotalGeoMem(B){return Object.values(B).reduce((ee,pe)=>ee+pe.memory,0)}getTotalMorphMem(B){return Object.values(B).reduce((ee,pe)=>ee+pe.memory,0)}getTotalTexMem(){const B=this.engineRendererService.getScene();return Object.values(B.stats.textures).reduce((ee,pe)=>ee+pe.memory,0)}getTotalMem(B,ee){return this.getTotalGeoMem(B)+this.getTotalMorphMem(ee)+this.getTotalTexMem()}buildSceneGeometryReport(B){const ee=Object.keys(B).length;let pe=0,Se=0,ye=0;Object.values(B).forEach(Ye=>{Se+=Ye.tris,pe+=Ye.verts,ye+=Ye.memory});const Ae=new Lt("Shape Count (uninstanced)",ee,null),Ge=new Lt("Triangle Count (uninstanced)",Se,null),Qe=new Lt("Vertex Count (uninstanced)",pe,null);return new Lt("Geometry Memory",ye,"bytes",[Ae,Ge,Qe])}buildSceneMorphReport(B){const ee=Object.keys(B).length;let pe=0,Se=0;Object.values(B).forEach(Ge=>{pe+=Ge.verts,Se+=Ge.memory});const ye=new Lt("Morph Count (uninstanced)",ee,null),Ae=new Lt("Vertex Count (uninstanced)",pe,null);return new Lt("Morph Memory",Se,"bytes",[ye,Ae])}buildSceneTextureReport(){const ee=this.engineRendererService.getScene().stats.textures;let pe=0;const ye={};return Object.entries({baseColor:"diffuse",alpha:"alpha",emit:"emit",normals:"normals",specular:"specular",texture:"texture"}).forEach(([Ae,Ge])=>{const Qe=this.generateTextureSummary(ee[Ae]),Ye=[...Qe.reports];ye[Ge]=new Lt(Ge,Qe.submemory,"bytes",Ye),pe+=Qe.submemory}),new Lt("Texture Memory",pe,"bytes",Object.values(ye))}buildSceneDownloadReport(B){if(!B)return null;const ee=B.geometryDownloadTotal+B.textureDownloadTotal+B.jsonDownloadTotal,pe=new Lt("Geometry",B.geometryDownloadTotal,"bytes"),Se=new Lt("Textures",B.textureDownloadTotal,"bytes"),ye=new Lt("JSON",B.jsonDownloadTotal,"bytes");return new Lt("Download Size",ee,"bytes",[pe,Se,ye])}toMB(B){return(B/1048576).toFixed(2)}setDownloadTrackingEnabled(B){}generateTextureSummary(B){const ee=[];let pe=0,Se=0;return(0,A.isNil)(B)||Object.entries(B).forEach(ye=>{const Ae=ye[0],Ge=ye[1];"memory"===Ae?Se=Ge:(ee.push(new Lt(Ae,Ge,null)),pe+=Ge)}),{reports:ee,submemory:Se,subtotal:pe}}static#e=this.\u0275fac=function(ee){return new(ee||U)(t.KVO(qa),t.KVO(er),t.KVO(ki.z),t.KVO(_i.I))};static#t=this.\u0275prov=t.jDH({token:U,factory:U.\u0275fac,providedIn:"root"})}return U})();var zn=function(U,J,B,ee){var ye,pe=arguments.length,Se=pe<3?J:null===ee?ee=Object.getOwnPropertyDescriptor(J,B):ee;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)Se=Reflect.decorate(U,J,B,ee);else for(var Ae=U.length-1;Ae>=0;Ae--)(ye=U[Ae])&&(Se=(pe<3?ye(Se):pe>3?ye(J,B,Se):ye(J,B))||Se);return pe>3&&Se&&Object.defineProperty(J,B,Se),Se},Ut=function(U,J){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(U,J)};class Zi{}const qi={compressionSupport:{geometry:!1,morph:!1,texture:!1},morphStats:null,geoStats:null,geoStatsReport:null,morphStatsReport:null,textureStatsReport:null,downloadReport:null,globalStats:{memory:0,textureMemory:0,geometryMemory:0,morphMemory:0,downloadSize:0,uncompressedGeos:0,uncompressedMorphs:0,uncompressedTextures:0,geometryDownloadTotal:0,textureDownloadTotal:0,jsonDownloadTotal:0},firstChapterDownloadSize:0};let an=class Fs{constructor(J,B,ee){this.engineService=J,this.memoryService=B,this.store=ee}static getGlobalStats(J){return J.globalStats}static getFirstChapterDownloadSize(J){return J.firstChapterDownloadSize}reset(J,B){J.setState({...qi})}update(J,B){const ee=this.memoryService.updateGeoStats(),pe=this.memoryService.updateMorphStats(),Se=this.memoryService.updateGlobalStats(ee,pe);B.isFirstChapter&&J.patchState({firstChapterDownloadSize:this.memoryService.getFirstChapterDownloadSize(Se)});const ye=this.memoryService.buildSceneGeometryReport(ee),Ae=this.memoryService.buildSceneMorphReport(pe),Ge=this.memoryService.buildSceneTextureReport(),Qe=this.memoryService.buildSceneDownloadReport(Se);J.setState({...J.getState(),geoStats:ee,morphStats:pe,globalStats:Se,geoStatsReport:ye,morphStatsReport:Ae,textureStatsReport:Ge,downloadReport:Qe}),B.logToConsole&&this.logMemoryState(J.getState())}ngxsOnInit(J){this.memoryService.setDownloadTrackingEnabled(!0),this.engineService.getEvent(j.X.GraphAssetAttachFinish).subscribe(()=>{const B=this.store.selectSnapshot(H.t.getLoadingChapter)?.chapterId,ee=this.store.selectSnapshot(ue.N.getFirstChapter)?.id;J.dispatch(new Wn.h.Update(B===ee))})}makeReportTableFriendly(J){return J.reports.reduce((B,ee)=>({...B,[ee.name]:ee.value}),{})}logMemoryState(J){console.groupCollapsed("Memory Usage"),console.group("Totals"),console.table({"Total Memory":J.globalStats.memory,"Total Geo Memory":J.globalStats.geometryMemory,"Total Morph Memory":J.globalStats.morphMemory,"Total Texture Memory":J.globalStats.textureMemory}),console.groupEnd(),console.group("Uncompressed Assets"),console.table({"Uncompressed Geos":J.globalStats.uncompressedGeos,"Uncompressed Morphs":J.globalStats.uncompressedMorphs,"Uncompressed Textures":J.globalStats.uncompressedTextures}),console.groupEnd(),console.group("Geometry Stats"),console.table(this.makeReportTableFriendly(J.geoStatsReport)),console.groupEnd(),console.group("Morph Stats"),console.table(this.makeReportTableFriendly(J.morphStatsReport)),console.groupEnd(),console.group("Texture Stats"),console.table(this.makeReportTableFriendly(J.textureStatsReport)),J.textureStatsReport.reports.forEach(B=>{B.reports.length&&(console.group(B.name),console.table(this.makeReportTableFriendly(B)),console.groupEnd())}),console.groupEnd(),console.group("Download Size"),console.table(this.makeReportTableFriendly(J.downloadReport)),console.groupEnd(),console.groupCollapsed()}static#e=this.\u0275fac=function(B){return new(B||Fs)(t.KVO(se.y),t.KVO(Ji),t.KVO(G.il))};static#t=this.\u0275prov=t.jDH({token:Fs,factory:Fs.\u0275fac})};zn([(0,G.rc)(Wn.h.Reset),Ut("design:type",Function),Ut("design:paramtypes",[Object,Wn.h.Reset]),Ut("design:returntype",void 0)],an.prototype,"reset",null),zn([(0,G.rc)(Wn.h.Update),Ut("design:type",Function),Ut("design:paramtypes",[Object,Wn.h.Update]),Ut("design:returntype",void 0)],an.prototype,"update",null),zn([(0,G.MD)(),Ut("design:type",Function),Ut("design:paramtypes",[Zi]),Ut("design:returntype",void 0)],an,"getGlobalStats",null),zn([(0,G.MD)(),Ut("design:type",Function),Ut("design:paramtypes",[Zi]),Ut("design:returntype",void 0)],an,"getFirstChapterDownloadSize",null),an=zn([(0,G.Uw)({name:"memory",defaults:qi}),Ut("design:paramtypes",[se.y,Ji,G.il])],an);let nr=(()=>{class U{static#e=this.\u0275fac=function(ee){return new(ee||U)};static#t=this.\u0275mod=t.$C({type:U});static#n=this.\u0275inj=t.G2t({imports:[G.rK.forFeature([an]),a.MD]})}return U})();var sr=n(1314);let ir=(()=>{class U{static forRoot(B){return{ngModule:U,providers:[W.e,{provide:"vendorAnalyticsConfig",useValue:B}]}}static#e=this.\u0275fac=function(ee){return new(ee||U)};static#t=this.\u0275mod=t.$C({type:U});static#n=this.\u0275inj=t.G2t({})}return U})(),or=(()=>{class U{static forRoot(B){return{ngModule:U,providers:[Q.n,{provide:"linkedinConfig",useValue:B}]}}static#e=this.\u0275fac=function(ee){return new(ee||U)};static#t=this.\u0275mod=t.$C({type:U});static#n=this.\u0275inj=t.G2t({})}return U})();var as=n(12215);let ar=(()=>{class U{static#e=this.\u0275fac=function(ee){return new(ee||U)};static#t=this.\u0275mod=t.$C({type:U});static#n=this.\u0275inj=t.G2t({imports:[a.MD,c.iI,hi.G,Ki.y2.forChild()]})}return U})();var rr=n(90450),lr=n(9632),cr=n(99504);let dr=(()=>{class U{static#e=this.\u0275fac=function(ee){return new(ee||U)};static#t=this.\u0275mod=t.$C({type:U});static#n=this.\u0275inj=t.G2t({imports:[a.MD,G.rK.forFeature([cr.e])]})}return U})();var ur=n(9940);let pr=(()=>{class U{static#e=this.\u0275fac=function(ee){return new(ee||U)};static#t=this.\u0275mod=t.$C({type:U});static#n=this.\u0275inj=t.G2t({imports:[a.MD,G.rK.forFeature([ur.D])]})}return U})();var fi=n(81025),hr=n(77015),_r=n.n(hr);const gr={accessToken:g.c.rollbarToken,captureUncaught:!1,captureUnhandledRejections:!1,captureIp:!1,autoInstrument:{log:!1},payload:{environment:g.c.deploy.toLowerCase(),application:g.c.application,engineVersion:ss.A,webGLEnabled:(0,li.MN)()}},mr=new t.nKC("rollbar");var vr=n(66915),Sr=n(62497);fi.IP(),fi.YT(),fi.ht(!1);const eo=g.c.application===p.c.Studio,br=[{provide:c.Sd,useClass:Qa},{provide:rr.Uh,useValue:"https://recaptcha.net/recaptcha/api.js"},{provide:mr,useFactory:function fr(){return new(_r())(gr)}}];let Er=(()=>{class U{static#e=this.\u0275fac=function(ee){return new(ee||U)};static#t=this.\u0275mod=t.$C({type:U,bootstrap:[on]});static#n=this.\u0275inj=t.G2t({providers:[(0,ns.$R)((0,ns.Sx)()),...br],imports:[G.rK.forRoot(),Fi.HU.forRoot(g.c.googleAnalyticsId),or.forRoot({enabled:eo,linkedinId:g.c.linkedinId}),ir.forRoot({enabled:eo,pendoId:g.c.pendoId,hubspotId:g.c.hubspotId,idPrefixes:{[as.Z.Local]:"local-",[as.Z.QA]:"qa-",[as.Z.Staging]:"staging-",[as.Z.Production]:""}}),Qi.P.forRoot(),sr.U_,s.wb,e.Bb,Sr.N,Xa,wa.x,Ya,vr.z,Fa.k,xa.R,za,dr,Ga.k,hi.G,Za,g.c.application===p.c.Loft?nr:[],$a.P,o,ar,pr,lr.Gt]})}return U})();g.c.production&&(0,t.SmG)(),e.sG().bootstrapModule(Er).catch(U=>console.error(U))},95904:()=>{},42634:()=>{}},le=>{le.O(0,[502],()=>le(le.s=6670)),le.O()}]);