{"version":3,"sources":["./.modernizrrc","./e2e/selectors/test-selectors.ts","./node_modules/blueimp-canvas-to-blob/js/canvas-to-blob.js","./src/$_lazy_route_resource lazy namespace object","./src/app/account/utils/account-error-utils.ts","./src/app/auth/auth.service.ts","./src/app/auth/models/auth-platform.enum.ts","./src/app/auth/models/biodigital-login.model.ts","./src/app/auth/models/environment-settings.model.ts","./src/app/auth/models/facebook-login.model.ts","./src/app/auth/models/google-login.model.ts","./src/app/auth/models/login-base-model.ts","./src/app/auth/models/profile-check.model.ts","./src/app/auth/models/sign-up.model.ts","./src/app/auth/models/user-app.model.ts","./src/app/auth/models/user-message-model.ts","./src/app/auth/models/user-profile.model.ts","./src/app/auth/state/auth/auth.actions.ts","./src/app/auth/state/auth/auth.state.model.ts","./src/app/auth/state/auth/auth.state.ts","./src/app/auth/state/subscription/subscription.actions.ts","./src/app/auth/state/subscription/subscription.state.model.ts","./src/app/auth/state/subscription/subscription.state.ts","./src/app/auth/subscription.service.ts","./src/app/bookmarks/bookmark-actions.service.ts","./src/app/bookmarks/bookmarks.module.ts","./src/app/bookmarks/bookmarks.service.ts","./src/app/bookmarks/data/bookmark-sort.ts","./src/app/bookmarks/data/tags.ts","./src/app/bookmarks/models/bookmark-action.ts","./src/app/bookmarks/models/bookmark-sort.model.ts","./src/app/bookmarks/models/bookmark.entry.model.ts","./src/app/bookmarks/models/bookmark.group.model.ts","./src/app/bookmarks/models/bookmark.model.ts","./src/app/bookmarks/state/bookmarks.actions.ts","./src/app/bookmarks/state/bookmarks.state.model.ts","./src/app/bookmarks/state/bookmarks.state.ts","./src/app/breakpoint/breakpoint.module.ts","./src/app/breakpoint/models/breakpoint.enum.ts","./src/app/breakpoint/state/breakpoint.actions.ts","./src/app/breakpoint/state/breakpoint.state.ts","./src/app/content-blocks/components/content-block/content-block.component.html","./src/app/content-blocks/components/content-block/content-block.component.ts","./src/app/content-blocks/components/content-blocks/content-blocks.component.html","./src/app/content-blocks/components/content-blocks/content-blocks.component.ts","./src/app/content-blocks/components/images-block/images-block.component.html","./src/app/content-blocks/components/images-block/images-block.component.ts","./src/app/content-blocks/components/markdown-block/markdown-block.component.html","./src/app/content-blocks/components/markdown-block/markdown-block.component.ts","./src/app/content-blocks/content-blocks.module.ts","./src/app/content-blocks/models/content-block-control.ts","./src/app/content-blocks/models/images-block.ts","./src/app/content-blocks/models/markdown-block.ts","./src/app/core/widget/app-widget-routing.module.ts","./src/app/core/widget/app-widget.component.html","./src/app/core/widget/app-widget.component.ts","./src/app/core/widget/app-widget.module.ts","./src/app/dialogs/components/about-dialog/about-dialog.component.html","./src/app/dialogs/components/about-dialog/about-dialog.component.ts","./src/app/dialogs/components/about-dialog/about-dialog.module.ts","./src/app/dialogs/components/access-dialog/access-dialog.component.html","./src/app/dialogs/components/access-dialog/access-dialog.component.ts","./src/app/dialogs/components/access-dialog/access-dialog.module.ts","./src/app/dialogs/components/add-team-model-dialog/add-team-model-dialog.component.html","./src/app/dialogs/components/add-team-model-dialog/add-team-model-dialog.component.ts","./src/app/dialogs/components/add-team-model-dialog/add-team-model-dialog.module.ts","./src/app/dialogs/components/background-color-dialog/background-color-dialog.component.html","./src/app/dialogs/components/background-color-dialog/background-color-dialog.component.ts","./src/app/dialogs/components/background-color-dialog/background-color-dialog.module.ts","./src/app/dialogs/components/background-color-dialog/background-config.ts","./src/app/dialogs/components/cancel-subscription-dialog/cancel-subscription-dialog.component.html","./src/app/dialogs/components/cancel-subscription-dialog/cancel-subscription-dialog.component.ts","./src/app/dialogs/components/cancel-subscription-dialog/cancel-subscription-dialog.module.ts","./src/app/dialogs/components/clipboard-dialog/clipboard-dialog.component.html","./src/app/dialogs/components/clipboard-dialog/clipboard-dialog.component.ts","./src/app/dialogs/components/clipboard-dialog/clipboard-dialog.module.ts","./src/app/dialogs/components/confirm-dialog/confirm-dialog.component.html","./src/app/dialogs/components/confirm-dialog/confirm-dialog.component.ts","./src/app/dialogs/components/confirm-dialog/confirm-dialog.module.ts","./src/app/dialogs/components/delete-account-dialog/delete-account-dialog.component.html","./src/app/dialogs/components/delete-account-dialog/delete-account-dialog.component.ts","./src/app/dialogs/components/delete-account-dialog/delete-account-dialog.module.ts","./src/app/dialogs/components/domain-join-dialog/domain-join-dialog.component.html","./src/app/dialogs/components/domain-join-dialog/domain-join-dialog.component.ts","./src/app/dialogs/components/domain-join-dialog/domain-join-dialog.module.ts","./src/app/dialogs/components/group-restriction-dialog/group-restriction-dialog.component.html","./src/app/dialogs/components/group-restriction-dialog/group-restriction-dialog.component.ts","./src/app/dialogs/components/group-restriction-dialog/group-restriction-dialog.module.ts","./src/app/dialogs/components/image-dialog/image-dialog.component.html","./src/app/dialogs/components/image-dialog/image-dialog.component.ts","./src/app/dialogs/components/image-dialog/image-dialog.module.ts","./src/app/dialogs/components/import-model-dialog/import-model-dialog.component.html","./src/app/dialogs/components/import-model-dialog/import-model-dialog.component.ts","./src/app/dialogs/components/import-model-dialog/import-model-dialog.module.ts","./src/app/dialogs/components/legacy-dialog/legacy-dialog.component.html","./src/app/dialogs/components/legacy-dialog/legacy-dialog.component.ts","./src/app/dialogs/components/legacy-dialog/legacy-dialog.module.ts","./src/app/dialogs/components/limit-dialog/limit-dialog.component.html","./src/app/dialogs/components/limit-dialog/limit-dialog.component.ts","./src/app/dialogs/components/limit-dialog/limit-dialog.module.ts","./src/app/dialogs/components/nps-dialog/nps-dialog.component.html","./src/app/dialogs/components/nps-dialog/nps-dialog.component.ts","./src/app/dialogs/components/nps-dialog/nps-dialog.module.ts","./src/app/dialogs/components/save-bookmark-dialog/save-bookmark-dialog.component.html","./src/app/dialogs/components/save-bookmark-dialog/save-bookmark-dialog.component.ts","./src/app/dialogs/components/save-bookmark-dialog/save-bookmark-dialog.module.ts","./src/app/dialogs/components/save-module-dialog/save-module-dialog.component.html","./src/app/dialogs/components/save-module-dialog/save-module-dialog.component.ts","./src/app/dialogs/components/save-module-dialog/save-module-dialog.module.ts","./src/app/dialogs/components/team-invite-dialog/team-invite-dialog.component.html","./src/app/dialogs/components/team-invite-dialog/team-invite-dialog.component.ts","./src/app/dialogs/components/team-invite-dialog/team-invite-dialog.module.ts","./src/app/dialogs/components/welcome-tour-dialog/welcome-tour-dialog.component.html","./src/app/dialogs/components/welcome-tour-dialog/welcome-tour-dialog.component.ts","./src/app/dialogs/components/welcome-tour-dialog/welcome-tour-dialog.module.ts","./src/app/dialogs/dialog.module.ts","./src/app/dialogs/dialog.service.ts","./src/app/dialogs/models/dialog-ids.ts","./src/app/dialogs/state/dialog.actions.ts","./src/app/dialogs/state/dialog.state.model.ts","./src/app/dialogs/state/dialog.state.ts","./src/app/edit/models/canvas-size.const.ts","./src/app/edit/models/canvas-size.model.ts","./src/app/edit/models/color-fresnel.model.ts","./src/app/edit/models/color-recipe.model.ts","./src/app/edit/models/color.model.ts","./src/app/edit/models/edit-view.enum.ts","./src/app/edit/models/engine-color-recipe.model.ts","./src/app/edit/models/paint-brush-mode.enum.ts","./src/app/edit/models/paint-preset.model.ts","./src/app/edit/models/scalar-fresnel.model.ts","./src/app/edit/models/scene-graph-node.ts","./src/app/edit/models/trim-config.model.ts","./src/app/edit/serialize-module.service.ts","./src/app/edit/serialize/chapter/minimum-synchronization.ts","./src/app/edit/serialize/chapter/serialize-chapter.service.ts","./src/app/edit/serialize/renamespace/renamespace-utils.ts","./src/app/edit/serialize/renamespace/renamespace.ts","./src/app/edit/serialize/scene-graph/serialize-graph-utils.ts","./src/app/edit/serialize/scene-graph/serialize-graph.ts","./src/app/edit/state/edit.actions.ts","./src/app/edit/state/edit.state.model.ts","./src/app/edit/state/edit.state.ts","./src/app/edit/state/paint/edit.paint.actions.ts","./src/app/edit/state/paint/edit.paint.state.model.ts","./src/app/edit/state/paint/edit.paint.state.ts","./src/app/engine/animation.service.ts","./src/app/engine/camera.service.ts","./src/app/engine/classes/particle-state-listener.ts","./src/app/engine/components/engine-camera-bar/engine-camera-bar.component.html","./src/app/engine/components/engine-camera-bar/engine-camera-bar.component.ts","./src/app/engine/components/engine-camera-position/engine-camera-position.component.html","./src/app/engine/components/engine-camera-position/engine-camera-position.component.ts","./src/app/engine/components/engine-contextmenu/engine-contextmenu.component.html","./src/app/engine/components/engine-contextmenu/engine-contextmenu.component.ts","./src/app/engine/components/engine-fade/engine-fade.component.html","./src/app/engine/components/engine-fade/engine-fade.component.ts","./src/app/engine/components/engine-progress/engine-progress.component.html","./src/app/engine/components/engine-progress/engine-progress.component.ts","./src/app/engine/components/engine-scroll/engine-scroll.component.html","./src/app/engine/components/engine-scroll/engine-scroll.component.ts","./src/app/engine/components/engine/engine.component.html","./src/app/engine/components/engine/engine.component.ts","./src/app/engine/engine.module.ts","./src/app/engine/engine.service.ts","./src/app/engine/models/animation/timerange.model.ts","./src/app/engine/models/background.model.ts","./src/app/engine/models/camera-motion.model.ts","./src/app/engine/models/camera.model.ts","./src/app/engine/models/engine-position.model.ts","./src/app/engine/models/engine-visibility.enum.ts","./src/app/engine/models/events.enum.ts","./src/app/engine/models/hit.model.ts","./src/app/engine/models/paint-presets.const.ts","./src/app/engine/models/post-processing/effects.enum.ts","./src/app/engine/models/post-processing/transparency-mode.enum.ts","./src/app/engine/models/scene-graph.model.ts","./src/app/engine/models/scroll-mode.enum.ts","./src/app/engine/models/tool.enum.ts","./src/app/engine/models/view.tree-node.ts","./src/app/engine/models/whiteboard-presets.const.ts","./src/app/engine/paint.service.ts","./src/app/engine/snapshot.service.ts","./src/app/engine/state/camera/camera-reducers.ts","./src/app/engine/state/camera/engine.camera.actions.ts","./src/app/engine/state/camera/engine.camera.state.model.ts","./src/app/engine/state/camera/engine.camera.state.ts","./src/app/engine/state/engine.actions.ts","./src/app/engine/state/engine.state.model.ts","./src/app/engine/state/engine.state.ts","./src/app/engine/state/nodes/build-node-state.ts","./src/app/engine/state/nodes/engine.nodes.actions.ts","./src/app/engine/state/nodes/engine.nodes.state.model.ts","./src/app/engine/state/nodes/engine.nodes.state.ts","./src/app/engine/state/nodes/node-reducers.ts","./src/app/engine/state/nodes/node-utils.ts","./src/app/engine/state/particles/particles.actions.ts","./src/app/engine/state/particles/particles.state.ts","./src/app/engine/state/progress/engine.progress.actions.ts","./src/app/engine/state/progress/engine.progress.state.ts","./src/app/engine/transition.service.ts","./src/app/explore/explore.service.ts","./src/app/gallery/components/gallery-banner/gallery-banner.component.html","./src/app/gallery/components/gallery-banner/gallery-banner.component.ts","./src/app/gallery/components/gallery-bulk-actions/gallery-bulk-actions.component.html","./src/app/gallery/components/gallery-bulk-actions/gallery-bulk-actions.component.ts","./src/app/gallery/components/gallery-cards/gallery-card/gallery-card.component.html","./src/app/gallery/components/gallery-cards/gallery-card/gallery-card.component.ts","./src/app/gallery/components/gallery-cards/gallery-cards/gallery-cards.component.html","./src/app/gallery/components/gallery-cards/gallery-cards/gallery-cards.component.ts","./src/app/gallery/components/gallery-categories/gallery-categories.component.html","./src/app/gallery/components/gallery-categories/gallery-categories.component.ts","./src/app/gallery/components/gallery-clients/gallery-clients.component.html","./src/app/gallery/components/gallery-clients/gallery-clients.component.ts","./src/app/gallery/components/gallery-collections/gallery-collections.component.html","./src/app/gallery/components/gallery-collections/gallery-collections.component.ts","./src/app/gallery/components/gallery-container/gallery-container.component.html","./src/app/gallery/components/gallery-container/gallery-container.component.ts","./src/app/gallery/components/gallery-filters-loft/gallery-filters-loft.component.html","./src/app/gallery/components/gallery-filters-loft/gallery-filters-loft.component.ts","./src/app/gallery/components/gallery-header/gallery-header.component.html","./src/app/gallery/components/gallery-header/gallery-header.component.ts","./src/app/gallery/components/gallery-results/gallery-results.component.html","./src/app/gallery/components/gallery-results/gallery-results.component.ts","./src/app/gallery/components/gallery-source/gallery-source.component.html","./src/app/gallery/components/gallery-source/gallery-source.component.ts","./src/app/gallery/components/gallery-tags-single/gallery-tags-single.component.html","./src/app/gallery/components/gallery-tags-single/gallery-tags-single.component.ts","./src/app/gallery/components/gallery-title/gallery-title.component.html","./src/app/gallery/components/gallery-title/gallery-title.component.ts","./src/app/gallery/components/gallery-view-mode/gallery-view-mode.component.html","./src/app/gallery/components/gallery-view-mode/gallery-view-mode.component.ts","./src/app/gallery/gallery.module.ts","./src/app/gallery/models/gallery-results.model.ts","./src/app/gallery/models/gallery-search-mode.enum.ts","./src/app/gallery/models/gallery-view-mode.enum.ts","./src/app/gallery/models/search-config.ts","./src/app/gallery/models/search-options.ts","./src/app/gallery/models/search-type.enum.ts","./src/app/gallery/state/gallery.actions.ts","./src/app/gallery/state/gallery.state.model.ts","./src/app/gallery/state/gallery.state.ts","./src/app/interceptors/api.interceptor.ts","./src/app/layout/layout.module.ts","./src/app/layout/models/layout-theme.enum.ts","./src/app/layout/models/site-header-type.enum.ts","./src/app/layout/state/layout.actions.ts","./src/app/layout/state/layout.state.model.ts","./src/app/layout/state/layout.state.ts","./src/app/locale-config.module.ts","./src/app/markdown-config.module.ts","./src/app/material.module.ts","./src/app/modules/models/modules-save-result.enum.ts","./src/app/modules/models/save-module-config.model.ts","./src/app/modules/models/save-module.model.ts","./src/app/modules/modules-thumbnail.service.ts","./src/app/modules/modules.service.ts","./src/app/modules/state/modules.actions.ts","./src/app/modules/state/modules.state.ts","./src/app/organizations/models/collection.model.ts","./src/app/organizations/models/organization.model.ts","./src/app/organizations/organizations.module.ts","./src/app/organizations/organizations.service.ts","./src/app/organizations/state/organizations.actions.ts","./src/app/organizations/state/organizations.state.model.ts","./src/app/organizations/state/organizations.state.ts","./src/app/pages/error/error.component.html","./src/app/pages/error/error.component.ts","./src/app/publish/components/publish-dialog/publish-dialog.component.html","./src/app/publish/components/publish-dialog/publish-dialog.component.ts","./src/app/publish/components/publish-widget/publish-widget.component.html","./src/app/publish/components/publish-widget/publish-widget.component.ts","./src/app/publish/components/publish/publish.component.html","./src/app/publish/components/publish/publish.component.ts","./src/app/publish/data/screens.ts","./src/app/publish/directives/embed-src.directive.ts","./src/app/publish/models/snapshot-options.model.ts","./src/app/publish/models/widget-options.model.ts","./src/app/publish/publish.module.ts","./src/app/publish/publish.service.ts","./src/app/publish/state/publish.actions.ts","./src/app/publish/state/publish.state.model.ts","./src/app/publish/state/publish.state.ts","./src/app/rollbar.ts","./src/app/shared/chapter-utils.ts","./src/app/shared/clipboard.service.ts","./src/app/shared/components/alert/alert.component.html","./src/app/shared/components/alert/alert.component.ts","./src/app/shared/components/buttons/button/button.component.html","./src/app/shared/components/buttons/button/button.component.ts","./src/app/shared/components/buttons/buttons.module.ts","./src/app/shared/components/buttons/pin-button/pin-button.component.html","./src/app/shared/components/buttons/pin-button/pin-button.component.ts","./src/app/shared/components/cards/cards.module.ts","./src/app/shared/components/category-image/category-image.component.html","./src/app/shared/components/category-image/category-image.component.ts","./src/app/shared/components/color-picker/color-picker.component.html","./src/app/shared/components/color-picker/color-picker.component.ts","./src/app/shared/components/column/column.module.ts","./src/app/shared/components/divider/divider.component.html","./src/app/shared/components/divider/divider.component.ts","./src/app/shared/components/icon/icon.component.html","./src/app/shared/components/icon/icon.component.ts","./src/app/shared/components/icon/icon.module.ts","./src/app/shared/components/image-view/image-view.component.html","./src/app/shared/components/image-view/image-view.component.ts","./src/app/shared/components/input-group/input-group.component.html","./src/app/shared/components/input-group/input-group.component.ts","./src/app/shared/components/list/list-item/list-item.component.html","./src/app/shared/components/list/list-item/list-item.component.ts","./src/app/shared/components/list/list.module.ts","./src/app/shared/components/list/list/list.component.html","./src/app/shared/components/list/list/list.component.ts","./src/app/shared/components/local-forms/character-counter/character-counter.component.html","./src/app/shared/components/local-forms/character-counter/character-counter.component.ts","./src/app/shared/components/local-forms/form-field/form-field.component.html","./src/app/shared/components/local-forms/form-field/form-field.component.ts","./src/app/shared/components/local-forms/forms.module.ts","./src/app/shared/components/message-toggle/message-toggle.component.html","./src/app/shared/components/message-toggle/message-toggle.component.ts","./src/app/shared/components/navigation/navigation-list/navigation-list-container/navigation-list-container.component.html","./src/app/shared/components/navigation/navigation-list/navigation-list-container/navigation-list-container.component.ts","./src/app/shared/components/navigation/navigation-list/navigation-list-item/navigation-list-item.component.html","./src/app/shared/components/navigation/navigation-list/navigation-list-item/navigation-list-item.component.ts","./src/app/shared/components/navigation/navigation-panel/navigation-panel.component.html","./src/app/shared/components/navigation/navigation-panel/navigation-panel.component.ts","./src/app/shared/components/navigation/navigation.module.ts","./src/app/shared/components/node-actions/node-actions.component.html","./src/app/shared/components/node-actions/node-actions.component.ts","./src/app/shared/components/node-actions/node-actions.module.ts","./src/app/shared/components/panel/panel.component.html","./src/app/shared/components/panel/panel.component.ts","./src/app/shared/components/pillbox/pillbox-divider/pillbox-divider.component.html","./src/app/shared/components/pillbox/pillbox-divider/pillbox-divider.component.ts","./src/app/shared/components/pillbox/pillbox.component.html","./src/app/shared/components/pillbox/pillbox.component.ts","./src/app/shared/components/pillbox/pillbox.module.ts","./src/app/shared/components/progress-indicators/progress-indicators.module.ts","./src/app/shared/components/progress-indicators/progress/progress.component.html","./src/app/shared/components/progress-indicators/progress/progress.component.ts","./src/app/shared/components/progress-indicators/spinner/spinner.component.html","./src/app/shared/components/progress-indicators/spinner/spinner.component.ts","./src/app/shared/components/slider/slider.component.html","./src/app/shared/components/slider/slider.component.ts","./src/app/shared/components/slider/slider.module.ts","./src/app/shared/components/sort/sort.component.html","./src/app/shared/components/sort/sort.component.ts","./src/app/shared/components/swatch-item/swatch-item.component.html","./src/app/shared/components/swatch-item/swatch-item.component.ts","./src/app/shared/components/tabs/tab/tab.component.html","./src/app/shared/components/tabs/tab/tab.component.ts","./src/app/shared/components/tabs/tabs.module.ts","./src/app/shared/components/tabs/tabs/tabs.component.html","./src/app/shared/components/tabs/tabs/tabs.component.ts","./src/app/shared/components/tree/tree-group/tree-group.component.html","./src/app/shared/components/tree/tree-group/tree-group.component.ts","./src/app/shared/components/tree/tree-nested-node/tree-nested-node.component.html","./src/app/shared/components/tree/tree-nested-node/tree-nested-node.component.ts","./src/app/shared/components/tree/tree-search/tree-search.component.html","./src/app/shared/components/tree/tree-search/tree-search.component.ts","./src/app/shared/components/tree/tree-search/tree-search.ts","./src/app/shared/components/tree/tree.module.ts","./src/app/shared/components/tree/tree/tree.component.html","./src/app/shared/components/tree/tree/tree.component.ts","./src/app/shared/detect-ie11.ts","./src/app/shared/directives/autofocus.directive.ts","./src/app/shared/directives/directives.module.ts","./src/app/shared/directives/event-fence.directive.ts","./src/app/shared/directives/flag-application.directive.ts","./src/app/shared/directives/ie11-hide.directive.ts","./src/app/shared/directives/ie11-show.directive.ts","./src/app/shared/directives/select-on-focus.directive.ts","./src/app/shared/error-logging.service.ts","./src/app/shared/error.service.ts","./src/app/shared/error/error-report-content.ts","./src/app/shared/error/error.model.ts","./src/app/shared/export.service.ts","./src/app/shared/features/components/popup/popup.component.html","./src/app/shared/features/components/popup/popup.component.ts","./src/app/shared/features/notification/components/notification/notification.component.html","./src/app/shared/features/notification/components/notification/notification.component.ts","./src/app/shared/features/notification/notification.model.ts","./src/app/shared/features/notification/notification.module.ts","./src/app/shared/features/popup/popup.module.ts","./src/app/shared/features/popup/popup.ref.ts","./src/app/shared/features/popup/popup.service.ts","./src/app/shared/features/site-navigation/data/site-navigation.ts","./src/app/shared/features/site-navigation/site-navigation-utils.ts","./src/app/shared/features/zendesk/zendesk.model.ts","./src/app/shared/features/zendesk/zendesk.module.ts","./src/app/shared/features/zendesk/zendesk.service.ts","./src/app/shared/html/html.component.html","./src/app/shared/html/html.component.ts","./src/app/shared/image.service.ts","./src/app/shared/libraries/3d-utils/3d-utils.ts","./src/app/shared/libraries/animations/animation-lib.ts","./src/app/shared/libraries/colors/colors.ts","./src/app/shared/libraries/dom/dom.ts","./src/app/shared/libraries/fullscreen/fullscreen.ts","./src/app/shared/libraries/text-utils/text-utils.ts","./src/app/shared/libraries/url/custom-url-serializer.ts","./src/app/shared/make-async.ts","./src/app/shared/models/xyz.model.ts","./src/app/shared/number.service.ts","./src/app/shared/object-color.ts","./src/app/shared/particle-id-utils.ts","./src/app/shared/pipes/element-id.pipe.ts","./src/app/shared/pipes/humanize.pipe.ts","./src/app/shared/pipes/pipes.module.ts","./src/app/shared/pipes/text-normalize.pipe.ts","./src/app/shared/shared.module.ts","./src/app/shared/storage-utils.ts","./src/app/shared/storage.service.ts","./src/app/shared/thumbnail-utils.ts","./src/app/shared/thumbnail.constants.ts","./src/app/shared/tween-particle-lookup.ts","./src/app/shared/user-message.service.ts","./src/app/shared/uuid.ts","./src/app/shared/widget-wiring.ts","./src/app/shared/wiki.service.ts","./src/app/shared/xray-mode.ts","./src/app/story/chapter.service.ts","./src/app/story/components/labels/context-label/context-label.component.html","./src/app/story/components/labels/context-label/context-label.component.ts","./src/app/story/components/labels/label-pin/label-pin.component.html","./src/app/story/components/labels/label-pin/label-pin.component.ts","./src/app/story/components/labels/label/label.component.html","./src/app/story/components/labels/label/label.component.ts","./src/app/story/components/labels/labels/labels.component.html","./src/app/story/components/labels/labels/labels.component.ts","./src/app/story/labels.service.ts","./src/app/story/media.service.ts","./src/app/story/merge/merge-asset-libraries.ts","./src/app/story/merge/merge-color-recipes.ts","./src/app/story/merge/merge-lights.ts","./src/app/story/merge/merge-modules.ts","./src/app/story/merge/merge-particle-systems.ts","./src/app/story/merge/merge-reflections.ts","./src/app/story/merge/merge-scene-graph-nodes.ts","./src/app/story/merge/merge-scene-graph.ts","./src/app/story/models/camera-strategy.enum.ts","./src/app/story/models/chapter-graph.model.ts","./src/app/story/models/chapter-ui.model.ts","./src/app/story/models/chapter.model.ts","./src/app/story/models/clipping-plane.model.ts","./src/app/story/models/content-type.enum.ts","./src/app/story/models/errands/errand-type.enum.ts","./src/app/story/models/errands/fly-to-camera-errand.model.ts","./src/app/story/models/errands/fly-to-chapter-errand.model.ts","./src/app/story/models/errands/fly-to-object-errand.model.ts","./src/app/story/models/labels/hotspot.model.ts","./src/app/story/models/labels/hotspot.themes.enum.ts","./src/app/story/models/labels/hotspot.types.enum.ts","./src/app/story/models/labels/label-collapse-mode.ts","./src/app/story/models/labels/label-pin-type.enum.ts","./src/app/story/models/labels/label-sequential-type.enum.ts","./src/app/story/models/labels/label-state.model.ts","./src/app/story/models/labels/label-theme.enum.ts","./src/app/story/models/labels/label.model.ts","./src/app/story/models/media.enum.ts","./src/app/story/models/media.model.ts","./src/app/story/models/story-chapter-thumbnail.model.ts","./src/app/story/models/story-translation.model.ts","./src/app/story/models/story.model.ts","./src/app/story/models/synchronization.model.ts","./src/app/story/models/ui-config.model.ts","./src/app/story/models/visibility-layers.model.ts","./src/app/story/state/chapters/default-clipping-planes.ts","./src/app/story/state/chapters/story.chapters.actions.ts","./src/app/story/state/chapters/story.chapters.state.model.ts","./src/app/story/state/chapters/story.chapters.state.ts","./src/app/story/state/labels/story.labels.actions.ts","./src/app/story/state/labels/story.labels.state.model.ts","./src/app/story/state/labels/story.labels.state.ts","./src/app/story/state/story-type.ts","./src/app/story/state/story.actions.ts","./src/app/story/state/story.state.model.ts","./src/app/story/state/story.state.ts","./src/app/story/story.module.ts","./src/app/story/story.service.ts","./src/app/story/visibility-layers.service.ts","./src/app/undo/state/undo.state.actions.ts","./src/app/undo/state/undo.state.ts","./src/app/undo/undo.module.ts","./src/app/view/components/view-annotate-label/view-annotate-label.component.html","./src/app/view/components/view-annotate-label/view-annotate-label.component.ts","./src/app/view/components/view-annotate-tools/view-annotate-tools.component.html","./src/app/view/components/view-annotate-tools/view-annotate-tools.component.ts","./src/app/view/components/view-annotate/view-annotate.component.html","./src/app/view/components/view-annotate/view-annotate.component.ts","./src/app/view/components/view-audio/view-audio.component.ts","./src/app/view/components/view-chapters/view-chapters.component.html","./src/app/view/components/view-chapters/view-chapters.component.ts","./src/app/view/components/view-column-toggle/view-column-toggle.component.html","./src/app/view/components/view-column-toggle/view-column-toggle.component.ts","./src/app/view/components/view-column/view-column-container/view-column-container.component.html","./src/app/view/components/view-column/view-column-container/view-column-container.component.ts","./src/app/view/components/view-column/view-column/view-column.component.html","./src/app/view/components/view-column/view-column/view-column.component.ts","./src/app/view/components/view-content-mode/view-content-mode.component.html","./src/app/view/components/view-content-mode/view-content-mode.component.ts","./src/app/view/components/view-description/view-description.component.html","./src/app/view/components/view-description/view-description.component.ts","./src/app/view/components/view-drawer/view-drawer.component.html","./src/app/view/components/view-drawer/view-drawer.component.ts","./src/app/view/components/view-help/view-help.component.html","./src/app/view/components/view-help/view-help.component.ts","./src/app/view/components/view-labels/view-labels.component.html","./src/app/view/components/view-labels/view-labels.component.ts","./src/app/view/components/view-layers-bar/view-layers-bar.component.html","./src/app/view/components/view-layers-bar/view-layers-bar.component.ts","./src/app/view/components/view-layers-slider/view-layers-slider.component.html","./src/app/view/components/view-layers-slider/view-layers-slider.component.ts","./src/app/view/components/view-legend/view-legend/view-legend.component.html","./src/app/view/components/view-legend/view-legend/view-legend.component.ts","./src/app/view/components/view-list/view-list-container/view-list-container.component.html","./src/app/view/components/view-list/view-list-container/view-list-container.component.ts","./src/app/view/components/view-list/view-list-item/view-list-item.component.html","./src/app/view/components/view-list/view-list-item/view-list-item.component.ts","./src/app/view/components/view-loader/button-loader/button-loader.component.html","./src/app/view/components/view-loader/button-loader/button-loader.component.ts","./src/app/view/components/view-loader/hand-loader/hand-loader.component.html","./src/app/view/components/view-loader/hand-loader/hand-loader.component.ts","./src/app/view/components/view-loader/play-loader/play-loader.component.html","./src/app/view/components/view-loader/play-loader/play-loader.component.ts","./src/app/view/components/view-loader/view-loader.component.html","./src/app/view/components/view-loader/view-loader.component.ts","./src/app/view/components/view-logo/view-logo.component.html","./src/app/view/components/view-logo/view-logo.component.ts","./src/app/view/components/view-media-bar/view-media-bar.component.html","./src/app/view/components/view-media-bar/view-media-bar.component.ts","./src/app/view/components/view-menu-column/view-menu-column.component.html","./src/app/view/components/view-menu-column/view-menu-column.component.ts","./src/app/view/components/view-menu/view-menu.component.html","./src/app/view/components/view-menu/view-menu.component.ts","./src/app/view/components/view-node-description/view-node-description.component.html","./src/app/view/components/view-node-description/view-node-description.component.ts","./src/app/view/components/view-panel/view-panel.component.html","./src/app/view/components/view-panel/view-panel.component.ts","./src/app/view/components/view-print/view-print.component.html","./src/app/view/components/view-print/view-print.component.ts","./src/app/view/components/view-progress/view-progress.component.html","./src/app/view/components/view-progress/view-progress.component.ts","./src/app/view/components/view-rounded-button/view-rounded-button.component.html","./src/app/view/components/view-rounded-button/view-rounded-button.component.ts","./src/app/view/components/view-scrubber/view-scrubber.component.html","./src/app/view/components/view-scrubber/view-scrubber.component.ts","./src/app/view/components/view-search/view-search.component.html","./src/app/view/components/view-search/view-search.component.ts","./src/app/view/components/view-shortcuts/view-shortcuts.component.html","./src/app/view/components/view-shortcuts/view-shortcuts.component.ts","./src/app/view/components/view-title/view-title.component.html","./src/app/view/components/view-title/view-title.component.ts","./src/app/view/components/view-toolbar/view-toolbar.component.html","./src/app/view/components/view-toolbar/view-toolbar.component.ts","./src/app/view/components/view-tools/view-tools.component.html","./src/app/view/components/view-tools/view-tools.component.ts","./src/app/view/components/view-tour/models/trigger.enum.ts","./src/app/view/components/view-tour/tours/view-tour-desktop/view-tour-desktop.component.html","./src/app/view/components/view-tour/tours/view-tour-desktop/view-tour-desktop.component.ts","./src/app/view/components/view-tour/tours/view-tour-mobile/view-tour-mobile.component.html","./src/app/view/components/view-tour/tours/view-tour-mobile/view-tour-mobile.component.ts","./src/app/view/components/view-tour/utils/triggers.ts","./src/app/view/components/view-tour/view-tour-page/view-tour-page.component.html","./src/app/view/components/view-tour/view-tour-page/view-tour-page.component.ts","./src/app/view/components/view-tour/view-tour-pages/view-tour-pages.component.html","./src/app/view/components/view-tour/view-tour-pages/view-tour-pages.component.ts","./src/app/view/components/view-tour/view-tour-slide/view-tour-slide.component.html","./src/app/view/components/view-tour/view-tour-slide/view-tour-slide.component.ts","./src/app/view/components/view-tour/view-tour-success/view-tour-success.component.html","./src/app/view/components/view-tour/view-tour-success/view-tour-success.component.ts","./src/app/view/components/view-tour/view-tour-tip-button/view-tour-tip-button.component.html","./src/app/view/components/view-tour/view-tour-tip-button/view-tour-tip-button.component.ts","./src/app/view/components/view-tour/view-tour.component.html","./src/app/view/components/view-tour/view-tour.component.ts","./src/app/view/components/view-undo/view-undo.component.html","./src/app/view/components/view-undo/view-undo.component.ts","./src/app/view/models/help-type.enum.ts","./src/app/view/models/interact-type.enum.ts","./src/app/view/models/view-input-mode.enum.ts","./src/app/view/models/view-layout.enum.ts","./src/app/view/models/view-loader.enum.ts","./src/app/view/models/view-mode.enum.ts","./src/app/view/models/view-tools-mode.enum.ts","./src/app/view/models/view-ui-status.enum.ts","./src/app/view/models/view-ui.enum.ts","./src/app/view/models/view-ui.model.ts","./src/app/view/models/view-window.enum.ts","./src/app/view/models/whiteboard-state.model.ts","./src/app/view/pages/view-page/view-page.component.html","./src/app/view/pages/view-page/view-page.component.ts","./src/app/view/state/view.actions.ts","./src/app/view/state/view.state.ts","./src/app/view/view-routing.module.ts","./src/app/view/view-ui.service.ts","./src/app/view/view.module.ts","./src/app/view/view.service.ts","./src/app/widget-api/api-handler.ts","./src/app/widget-api/define-event.ts","./src/app/widget-api/define-procedure.ts","./src/app/widget-api/models/message.enum.ts","./src/app/widget-api/procedures/annotations.ts","./src/app/widget-api/procedures/camera.ts","./src/app/widget-api/procedures/hotspots.ts","./src/app/widget-api/procedures/human.ts","./src/app/widget-api/procedures/input.ts","./src/app/widget-api/procedures/labels.ts","./src/app/widget-api/procedures/scene-utils.ts","./src/app/widget-api/procedures/scene.ts","./src/app/widget-api/procedures/timeline.ts","./src/app/widget-api/procedures/ui.ts","./src/app/widget-auth/models/analytic-activity.model.ts","./src/app/widget-auth/models/developer-analytic.model.ts","./src/app/widget-auth/models/user-analytic.model.ts","./src/app/widget-auth/models/widget-auth-error.enum.ts","./src/app/widget-auth/models/widget-interaction.enum.ts","./src/app/widget-auth/models/widget-platform.enum.ts","./src/app/widget-auth/models/widget-user-type.enum.ts","./src/app/widget-auth/state/widget.actions.ts","./src/app/widget-auth/state/widget.state.model.ts","./src/app/widget-auth/state/widget.state.ts","./src/app/widget-auth/widget-analytics.service.ts","./src/app/widget-auth/widget-auth.module.ts","./src/app/widget-auth/widget-auth.service.ts","./src/app/widget-auth/widget-config-resolver.ts","./src/app/widget-config/initial-config.ts","./src/app/widget/components/ie-warning/ie-warning.component.html","./src/app/widget/components/ie-warning/ie-warning.component.ts","./src/app/widget/components/warning-message/warning-message.component.html","./src/app/widget/components/warning-message/warning-message.component.ts","./src/app/widget/data/auth-error-config.ts","./src/app/widget/models/widget-error-type.enum.ts","./src/app/widget/pages/widget-master/widget-master.component.html","./src/app/widget/pages/widget-master/widget-master.component.ts","./src/app/widget/widget.module.ts","./src/app/zendesk-config.module.ts","./src/environments/environment.ts","./src/environments/models/environment-application.ts","./src/environments/models/environment-deploy.ts","./src/environments/models/environment-platform.ts","./src/lib/graph/elections.ts","./src/lib/graph/graph-utils.ts","./src/lib/graph/graph.model.ts","./src/lib/graph/graph.service.ts","./src/lib/graph/leaf-state.ts","./src/lib/graph/models/property-votes.model.ts","./src/main-widget.ts"],"names":[],"mappings":";;;;;;;;;AAAA,CAAC;AACD;AACA;AACA;AACA;AACA,iBAAiB,gBAAgB,oBAAoB,gBAAgB,2BAA2B,aAAa,gLAAgL,aAAa,aAAa,4CAA4C,oBAAoB,2CAA2C,uBAAuB,IAAI,iDAAiD,oZAAoZ,cAAc,0CAA0C,0BAA0B,yBAAyB,kBAAkB,MAAM,2BAA2B,+BAA+B,gBAAgB,yCAAyC,WAAW,4BAA4B,oGAAoG,6CAA6C,SAAS,gBAAgB,eAAe,kCAAkC,KAAK,IAAI,uCAAuC,SAAS,0BAA0B,aAAa,IAAI,+BAA+B,8CAA8C,aAAa,oBAAoB,EAAE,EAAE,cAAc,wCAAwC,EAAE,SAAS,cAAc,oDAAoD,yBAAyB,mBAAmB,oBAAoB,aAAa,qCAAqC,6CAA6C,aAAa,8BAA8B,iDAAiD,mBAAmB,qDAAqD,mBAAmB,IAAI,8DAA8D,+CAA+C,IAAI,aAAa,UAAU,0CAA0C,cAAc,gBAAgB,kBAAkB,6BAA6B,kBAAkB,MAAM,qFAAqF,SAAS,sBAAsB,gFAAgF,kGAAkG,YAAY,0BAA0B,gEAAgE,wBAAwB,WAAW,sBAAsB,QAAQ,IAAI,yBAAyB,QAAQ,sBAAsB,EAAE,0BAA0B,QAAQ,eAAe,GAAG,wBAAwB,8CAA8C,4HAA4H,mBAAmB,OAAO,qBAAqB,6BAA6B,cAAc,EAAE,OAAO,oBAAoB,gCAAgC,eAAe,EAAE,0DAA0D,kCAAkC,kBAAkB,oCAAoC,uBAAuB,eAAe,sFAAsF,YAAY,IAAI,KAAK,kBAAkB,+DAA+D,UAAU,WAAW,iCAAiC,sFAAsF,qGAAqG,kBAAkB,uCAAuC,qHAAqH,2BAA2B,+CAA+C,yCAAyC,WAAW,4OAA4O,eAAe,sDAAsD,qDAAqD,6CAA6C,6BAA6B,8GAA8G,2CAA2C,YAAY,sBAAsB,sBAAsB,sBAAsB;AACpxJ;AACA,gBAAgB,8BAA8B;AAC9C,MAAM,yBAAyB;AAC/B,CAAC,U;;;;;;;;;;;;ACTD;AAAA;AAAA,yCAAyC;AACzC,kDAAkD;AAElD,IAAY,aAeX;AAfD,WAAY,aAAa;IACvB,uEAAe;IAEf,mEAAa;IACb,uEAAe;IACf,+EAAmB;IACnB,qEAAc;IACd,uEAAe;IACf,uFAAuB;IACvB,yFAAwB;IACxB,iFAAoB;IACpB,mFAAqB;IACrB,oEAAa;IAEb,wEAAe;AACjB,CAAC,EAfW,aAAa,KAAb,aAAa,QAexB;;;;;;;;;;;;AClBD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,CAAC;AACD;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,sCAAsC,gBAAgB;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B;AAC/B;AACA;AACA,0CAA0C;AAC1C;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,uBAAuB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA,SAAS;AACT;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,WAAW;AACX;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA,MAAM,IAA0C;AAChD,IAAI,mCAAO;AACX;AACA,KAAK;AAAA,oGAAC;AACN,GAAG,MAAM,EAIN;AACH,CAAC;;;;;;;;;;;;AC9ID;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA,4CAA4C,WAAW;AACvD;AACA;AACA,4E;;;;;;;;;;;;ACZA;AAAA;AAAA;AAAA;AAA6B;AAE7B,6BAA6B;AACtB,SAAS,iBAAiB,CAAC,KAAY;IAC5C,IAAM,YAAY,GAAW,kDAAG,CAAC,KAAK,EAAE,qBAAqB,EAAE,EAAE,CA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","file":"main-es5.js","sourcesContent":[";(function(window){\nvar hadGlobal = 'Modernizr' in window;\nvar oldGlobal = window.Modernizr;\n/*! modernizr 3.8.0 (Custom Build) | MIT *\n * https://modernizr.com/download/?-fullscreen-setclasses !*/\n!function(e,n,t){function r(e,n){return typeof e===n}function o(e,n){return!!~(\"\"+e).indexOf(n)}function i(){return\"function\"!=typeof n.createElement?n.createElement(arguments[0]):S?n.createElementNS.call(n,\"http://www.w3.org/2000/svg\",arguments[0]):n.createElement.apply(n,arguments)}function s(){var e=n.body;return e||(e=i(S?\"svg\":\"body\"),e.fake=!0),e}function l(e,t,r,o){var l,a,f,u,c=\"modernizr\",p=i(\"div\"),d=s();if(parseInt(r,10))for(;r--;)f=i(\"div\"),f.id=o?o[r]:c+(r+1),p.appendChild(f);return l=i(\"style\"),l.type=\"text/css\",l.id=\"s\"+c,(d.fake?d:p).appendChild(l),d.appendChild(p),l.styleSheet?l.styleSheet.cssText=e:l.appendChild(n.createTextNode(e)),p.id=c,d.fake&&(d.style.background=\"\",d.style.overflow=\"hidden\",u=C.style.overflow,C.style.overflow=\"hidden\",C.appendChild(d)),a=t(p,e),d.fake?(d.parentNode.removeChild(d),C.style.overflow=u,C.offsetHeight):p.parentNode.removeChild(p),!!a}function a(e){return e.replace(/([A-Z])/g,function(e,n){return\"-\"+n.toLowerCase()}).replace(/^ms-/,\"-ms-\")}function f(n,t,r){var o;if(\"getComputedStyle\"in e){o=getComputedStyle.call(e,n,t);var i=e.console;if(null!==o)r&&(o=o.getPropertyValue(r));else if(i){var s=i.error?\"error\":\"log\";i[s].call(i,\"getComputedStyle returning null, its possible modernizr test results are inaccurate\")}}else o=!t&&n.currentStyle&&n.currentStyle[r];return o}function u(n,r){var o=n.length;if(\"CSS\"in e&&\"supports\"in e.CSS){for(;o--;)if(e.CSS.supports(a(n[o]),r))return!0;return!1}if(\"CSSSupportsRule\"in e){for(var i=[];o--;)i.push(\"(\"+a(n[o])+\":\"+r+\")\");return i=i.join(\" or \"),l(\"@supports (\"+i+\") { #modernizr { position: absolute; } }\",function(e){return\"absolute\"===f(e,null,\"position\")})}return t}function c(e){return e.replace(/([a-z])-([a-z])/g,function(e,n,t){return n+t.toUpperCase()}).replace(/^-/,\"\")}function p(e,n,s,l){function a(){p&&(delete b.style,delete b.modElem)}if(l=!r(l,\"undefined\")&&l,!r(s,\"undefined\")){var f=u(e,s);if(!r(f,\"undefined\"))return f}for(var p,d,m,v,y,h=[\"modernizr\",\"tspan\",\"samp\"];!b.style&&h.length;)p=!0,b.modElem=i(h.shift()),b.style=b.modElem.style;for(m=e.length,d=0;d<m;d++)if(v=e[d],y=b.style[v],o(v,\"-\")&&(v=c(v)),b.style[v]!==t){if(l||r(s,\"undefined\"))return a(),\"pfx\"!==n||v;try{b.style[v]=s}catch(e){}if(b.style[v]!==y)return a(),\"pfx\"!==n||v}return a(),!1}function d(e,n){return function(){return e.apply(n,arguments)}}function m(e,n,t){var o;for(var i in e)if(e[i]in n)return!1===t?e[i]:(o=n[e[i]],r(o,\"function\")?d(o,t||n):o);return!1}function v(e,n,t,o,i){var s=e.charAt(0).toUpperCase()+e.slice(1),l=(e+\" \"+_.join(s+\" \")+s).split(\" \");return r(n,\"string\")||r(n,\"undefined\")?p(l,n,o,i):(l=(e+\" \"+E.join(s+\" \")+s).split(\" \"),m(l,n,t))}var y=[],h={_version:\"3.8.0\",_config:{classPrefix:\"\",enableClasses:!0,enableJSClass:!0,usePrefixes:!0},_q:[],on:function(e,n){var t=this;setTimeout(function(){n(t[e])},0)},addTest:function(e,n,t){y.push({name:e,fn:n,options:t})},addAsyncTest:function(e){y.push({name:null,fn:e})}},Modernizr=function(){};Modernizr.prototype=h,Modernizr=new Modernizr;var g=[],C=n.documentElement,S=\"svg\"===C.nodeName.toLowerCase(),x=\"Moz O ms Webkit\",_=h._config.usePrefixes?x.split(\" \"):[];h._cssomPrefixes=_;var w={elem:i(\"modernizr\")};Modernizr._q.push(function(){delete w.elem});var b={style:w.elem.style};Modernizr._q.unshift(function(){delete b.style});var E=h._config.usePrefixes?x.toLowerCase().split(\" \"):[];h._domPrefixes=E,h.testAllProps=v;var z=function(n){var r,o=prefixes.length,i=e.CSSRule;if(void 0===i)return t;if(!n)return!1;if(n=n.replace(/^@/,\"\"),(r=n.replace(/-/g,\"_\").toUpperCase()+\"_RULE\")in i)return\"@\"+n;for(var s=0;s<o;s++){var l=prefixes[s];if(l.toUpperCase()+\"_\"+r in i)return\"@-\"+l.toLowerCase()+\"-\"+n}return!1};h.atRule=z;var P=h.prefixed=function(e,n,t){return 0===e.indexOf(\"@\")?z(e):(-1!==e.indexOf(\"-\")&&(e=c(e)),n?v(e,n,t):v(e,\"pfx\"))};Modernizr.addTest(\"fullscreen\",!(!P(\"exitFullscreen\",n,!1)&&!P(\"cancelFullScreen\",n,!1))),function(){var e,n,t,o,i,s,l;for(var a in y)if(y.hasOwnProperty(a)){if(e=[],n=y[a],n.name&&(e.push(n.name.toLowerCase()),n.options&&n.options.aliases&&n.options.aliases.length))for(t=0;t<n.options.aliases.length;t++)e.push(n.options.aliases[t].toLowerCase());for(o=r(n.fn,\"function\")?n.fn():n.fn,i=0;i<e.length;i++)s=e[i],l=s.split(\".\"),1===l.length?Modernizr[l[0]]=o:(Modernizr[l[0]]&&(!Modernizr[l[0]]||Modernizr[l[0]]instanceof Boolean)||(Modernizr[l[0]]=new Boolean(Modernizr[l[0]])),Modernizr[l[0]][l[1]]=o),g.push((o?\"\":\"no-\")+l.join(\"-\"))}}(),function(e){var n=C.className,t=Modernizr._config.classPrefix||\"\";if(S&&(n=n.baseVal),Modernizr._config.enableJSClass){var r=new RegExp(\"(^|\\\\s)\"+t+\"no-js(\\\\s|$)\");n=n.replace(r,\"$1\"+t+\"js$2\")}Modernizr._config.enableClasses&&(e.length>0&&(n+=\" \"+t+e.join(\" \"+t)),S?C.className.baseVal=n:C.className=n)}(g),delete h.addTest,delete h.addAsyncTest;for(var N=0;N<Modernizr._q.length;N++)Modernizr._q[N]();e.Modernizr=Modernizr}(window,document);\nmodule.exports = window.Modernizr;\nif (hadGlobal) { window.Modernizr = oldGlobal; }\nelse { delete window.Modernizr; }\n})(window);","// Naming convention: <component><target>\n// Example: ViewTools, Play button = ViewToolsPlay\n\nexport enum TestSelectors {\n  ViewToolbarMain,\n\n  ViewToolsPlay,\n  ViewToolsNewTab,\n  ViewToolsFullscreen,\n  ViewToolsTools,\n  ViewToolsSearch,\n  ViewToolsMediaBarToggle,\n  ViewToolsPreviousChapter,\n  ViewToolsNextChapter,\n  ViewToolsChapterCount,\n  ViewToolsMore,\n\n  EngineCameraBar\n}\n","/*\n * JavaScript Canvas to Blob\n * https://github.com/blueimp/JavaScript-Canvas-to-Blob\n *\n * Copyright 2012, Sebastian Tschan\n * https://blueimp.net\n *\n * Licensed under the MIT license:\n * https://opensource.org/licenses/MIT\n *\n * Based on stackoverflow user Stoive's code snippet:\n * http://stackoverflow.com/q/4998908\n */\n\n/* global define, Uint8Array, ArrayBuffer, module */\n\n;(function (window) {\n  'use strict'\n\n  var CanvasPrototype =\n    window.HTMLCanvasElement && window.HTMLCanvasElement.prototype\n  var hasBlobConstructor =\n    window.Blob &&\n    (function () {\n      try {\n        return Boolean(new Blob())\n      } catch (e) {\n        return false\n      }\n    })()\n  var hasArrayBufferViewSupport =\n    hasBlobConstructor &&\n    window.Uint8Array &&\n    (function () {\n      try {\n        return new Blob([new Uint8Array(100)]).size === 100\n      } catch (e) {\n        return false\n      }\n    })()\n  var BlobBuilder =\n    window.BlobBuilder ||\n    window.WebKitBlobBuilder ||\n    window.MozBlobBuilder ||\n    window.MSBlobBuilder\n  var dataURIPattern = /^data:((.*?)(;charset=.*?)?)(;base64)?,/\n  var dataURLtoBlob =\n    (hasBlobConstructor || BlobBuilder) &&\n    window.atob &&\n    window.ArrayBuffer &&\n    window.Uint8Array &&\n    function (dataURI) {\n      var matches,\n        mediaType,\n        isBase64,\n        dataString,\n        byteString,\n        arrayBuffer,\n        intArray,\n        i,\n        bb\n      // Parse the dataURI components as per RFC 2397\n      matches = dataURI.match(dataURIPattern)\n      if (!matches) {\n        throw new Error('invalid data URI')\n      }\n      // Default to text/plain;charset=US-ASCII\n      mediaType = matches[2]\n        ? matches[1]\n        : 'text/plain' + (matches[3] || ';charset=US-ASCII')\n      isBase64 = !!matches[4]\n      dataString = dataURI.slice(matches[0].length)\n      if (isBase64) {\n        // Convert base64 to raw binary data held in a string:\n        byteString = atob(dataString)\n      } else {\n        // Convert base64/URLEncoded data component to raw binary:\n        byteString = decodeURIComponent(dataString)\n      }\n      // Write the bytes of the string to an ArrayBuffer:\n      arrayBuffer = new ArrayBuffer(byteString.length)\n      intArray = new Uint8Array(arrayBuffer)\n      for (i = 0; i < byteString.length; i += 1) {\n        intArray[i] = byteString.charCodeAt(i)\n      }\n      // Write the ArrayBuffer (or ArrayBufferView) to a blob:\n      if (hasBlobConstructor) {\n        return new Blob([hasArrayBufferViewSupport ? intArray : arrayBuffer], {\n          type: mediaType\n        })\n      }\n      bb = new BlobBuilder()\n      bb.append(arrayBuffer)\n      return bb.getBlob(mediaType)\n    }\n  if (window.HTMLCanvasElement && !CanvasPrototype.toBlob) {\n    if (CanvasPrototype.mozGetAsFile) {\n      CanvasPrototype.toBlob = function (callback, type, quality) {\n        var self = this\n        setTimeout(function () {\n          if (quality && CanvasPrototype.toDataURL && dataURLtoBlob) {\n            callback(dataURLtoBlob(self.toDataURL(type, quality)))\n          } else {\n            callback(self.mozGetAsFile('blob', type))\n          }\n        })\n      }\n    } else if (CanvasPrototype.toDataURL && dataURLtoBlob) {\n      if (CanvasPrototype.msToBlob) {\n        CanvasPrototype.toBlob = function (callback, type, quality) {\n          var self = this\n          setTimeout(function () {\n            if (\n              ((type && type !== 'image/png') || quality) &&\n              CanvasPrototype.toDataURL &&\n              dataURLtoBlob\n            ) {\n              callback(dataURLtoBlob(self.toDataURL(type, quality)))\n            } else {\n              callback(self.msToBlob(type))\n            }\n          })\n        }\n      } else {\n        CanvasPrototype.toBlob = function (callback, type, quality) {\n          var self = this\n          setTimeout(function () {\n            callback(dataURLtoBlob(self.toDataURL(type, quality)))\n          })\n        }\n      }\n    }\n  }\n  if (typeof define === 'function' && define.amd) {\n    define(function () {\n      return dataURLtoBlob\n    })\n  } else if (typeof module === 'object' && module.exports) {\n    module.exports = dataURLtoBlob\n  } else {\n    window.dataURLtoBlob = dataURLtoBlob\n  }\n})(window)\n","function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = \"./src/$$_lazy_route_resource lazy recursive\";","import { get } from 'lodash';\n\n// parse server error message\nexport function parseErrorMessage(error: Error): string {\n  const errorMessage: string = get(error, 'error.error.message', '');\n\n  /* NOTE:\n    Cleanup server formatted messages (i.e. brackets and single quotes, \"['message in brackets and quotes']\")\n    Should migrate to error codes (number) and define messages client side.\n   */\n  return errorMessage\n    .replace(/^\\[(.+)\\]$/, '$1')\n    .replace(/^\\'(.+)\\'$/, '$1');\n}\n","import { Injectable } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { map, flatMap, catchError } from 'rxjs/operators';\nimport { Observable, of } from 'rxjs';\nimport { UserProfileModel } from './models/user-profile.model';\nimport { plainToClass } from 'class-transformer';\n\nimport { AuthService as SocialAuthService, FacebookLoginProvider } from 'angularx-social-login';\nimport { GoogleLoginProvider } from 'angularx-social-login';\nimport { ProfileCheckModel } from './models/profile-check.model';\nimport { EnvironmentSettingsModel } from './models/environment-settings.model';\nimport { SignUpModel } from './models/sign-up.model';\nimport { GoogleLoginModel } from './models/google-login.model';\nimport { FacebookLoginModel } from './models/facebook-login.model';\nimport { ActivatedRouteSnapshot } from '@angular/router';\nimport { BiodigitalLoginModel } from './models/biodigital-login.model';\nimport { UserAppModel } from './models/user-app.model';\nimport { ReCaptchaV3Service } from 'ng-recaptcha';\nimport { PlatformLoginConfig } from './models/platform-login.model';\nimport { AuthPlatformEnum } from './models/auth-platform.enum';\n\ninterface Verification {\n  action: string;\n  challenge_ts: string;\n  hostname: string;\n  score: number; // 0.0 - 1.0\n  success: boolean; \n}\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class AuthService {\n  constructor(\n    private http: HttpClient,\n    private socialAuthService: SocialAuthService,\n    private reCaptchaV3Service: ReCaptchaV3Service\n  ) {\n    \n  }\n\n  loginWithBiodigital(login: BiodigitalLoginModel) {\n    return this.http.post('/ws/user/sign/in', BiodigitalLoginModel.toJSON(login));\n  }\n\n  loginWithGoogle(login: GoogleLoginModel) {\n    return this.http.post('/ws/user/sign/in/google', GoogleLoginModel.toJSON(login));\n  }\n\n  // Deprecated\n  loginWithFacebook(login: FacebookLoginModel) {\n    return this.http.post('/ws/user/sign/in/facebook', FacebookLoginModel.toJSON(login));\n  }\n\n  logout() {\n    return this.http.get('/ws/user/sign/out');\n  }\n\n  checkProfile(email: string): Observable<ProfileCheckModel> {\n    return this.http.post('/ws/user/profile/check', { version: 2, email: email })\n      .pipe(\n        map((result: any) => {\n          const profileCheck = ProfileCheckModel.fromJSON(result);\n          profileCheck.isThirdParty = profileCheck.thirdPartyProvider !== '';\n          return profileCheck;\n        })\n      );\n  }\n\n  getUserProfile(hardCheck: boolean): Observable<UserProfileModel> {\n    const profileURL = hardCheck\n      ? '/ws/user/profile?subscription_hard_check=1'\n      : '/ws/user/profile';\n\n    return this.http.get(profileURL)\n      .pipe(\n        map((result: any) => {\n          if (typeof result.organizations === 'string') {\n            result.organizations = JSON.parse(result.organizations);\n          }\n\n          return plainToClass(UserProfileModel, result as Object);\n        })\n      );\n  }\n\n  /*\n    Updates user profile with partial profile fields i.e., { first_name, last_name }\n  */\n  updaterUserProfile(profile: Partial<UserProfileModel>): Observable<any> {\n    return this.http.post('/ws/user/profile', profile);\n  }\n\n  deleteUserProfile(): Observable<string> {\n    return this.http.post('/ws/user/profile/delete', {})\n      .pipe(\n        map((response: any) => response.deleted_user_email)\n      );\n  }\n\n  getEnvironmentSettings(): Observable<EnvironmentSettingsModel> {\n    return this.http.get('/ws/environment/settings?version=2')\n      .pipe(\n        map((result: any) => {\n          return EnvironmentSettingsModel.fromJSON(result);\n        })\n      );\n  }\n\n  /**\n   * Gets a list of user apps\n   */\n  getUserApps(): Observable<UserAppModel[]> {\n    return this.http.get('/ws/developer/apps/profile')\n      .pipe(\n        map((result: any) => result && result.apps ? JSON.parse(result.apps) : [])\n      );\n  }\n\n  getGroupConfigFromRoute(snapshot: ActivatedRouteSnapshot) {\n    const group = snapshot.queryParams.group || '';\n    const groupCode = snapshot.queryParams.code || '';\n    const invitation = snapshot.queryParams.group_invite || '';\n\n    const config = {\n      group: group,\n      groupCode: groupCode,\n      groupCodeMode: group !== '' ? 1 : 0,\n      groupInviteMode: invitation !== '' ? 1 : 0,\n      groupInviteKey: invitation\n    };\n\n    return config;\n  }\n\n  getPlatformConfigFromRoute(snapshot: ActivatedRouteSnapshot): PlatformLoginConfig {\n    const { zendesk_signin, return_to, brand_id, locale_id, timestamp } = snapshot.queryParams;\n\n    // Zendesk login\n    if (zendesk_signin === '1') {\n      return {\n        platform: AuthPlatformEnum.Zendesk,\n        returnTo: return_to,\n        brandId: brand_id,\n        localeId: locale_id,\n        timestamp: timestamp\n      };\n    } else {\n      return undefined;\n    }\n  }\n\n  isLoggedIn() {\n    // Uses version 2, which responds with 200 status for good, 401 if not\n    return this.http.get('/ws/user/is/signed-in?version=2');\n  }\n\n  getProfileRestrictions(profile: UserProfileModel): {email: boolean; ip: boolean, organizationName: string} {\n    let emailRestricted = false;\n    let ipRestricted = false;\n    let name = '';\n\n    profile.organizations.forEach(organization => {\n      if (emailRestricted || ipRestricted) {\n        return;\n      }\n\n      name = organization.name;\n\n      emailRestricted = \n        organization.user_is_subscribed && \n        organization.email_domain_restriction && \n        !organization.user_has_email_domain_access;\n\n      ipRestricted = \n        organization.user_is_subscribed && \n        organization.ip_address_restriction &&\n        !organization.user_has_domain_access;\n\n      if (emailRestricted || ipRestricted) {\n\n      }\n    });\n\n    return {\n      organizationName: name,\n      email: emailRestricted,\n      ip: ipRestricted\n    };\n  }\n\n  resetPassword(email: string) {\n    return this.http.post('/ws/user/password/forgot', { email: email });\n  }\n\n  updatePassword(currentPassword: string, newPassword: string, confirmNewPassword: string) {\n    return this.http.post('/ws/user/password/change', {\n      'current_password': currentPassword,\n      'new_password': newPassword,\n      'confirm_new_password': confirmNewPassword\n    });\n  }\n\n  signUp(value: SignUpModel) {\n    return this.http.post('/ws/user/sign/up', SignUpModel.toJSON(value) );\n  }\n\n  authenticateWithGoogle() {\n    return this.socialAuthService.signIn(GoogleLoginProvider.PROVIDER_ID);\n  }\n\n  authenticateWithFacebook() {\n    return this.socialAuthService.signIn(FacebookLoginProvider.PROVIDER_ID);\n  }\n\n  verifyToken(token: string): Observable<Verification>  {\n    return this.http.post('/ws/recaptcha/siteverify', {\n      recaptcha_reponse_token: token,\n      recaptcha_version: 'v3',\n    }).pipe(\n      map((response: Verification) => response)\n    );\n  }\n\n  /**\n   * Google returns a score between 0 and 1 rating the likelihood that a user is human\n   * Real users typically rank at 0.9+\n   * The default acceptance level is 0.5, but we're starting at 0.2 and will adjust after \n   * monitoring the admin dashboard at: https://www.google.com/recaptcha/admin\n   *\n   * https://developers.google.com/recaptcha/docs/v3\n   */\n  isHuman(action: string) {\n    return this.reCaptchaV3Service.execute(action)\n      .pipe(\n        flatMap(token => this.verifyToken(token)),\n        map(response => response.action === action && response.score > 0.2)\n      );\n  }\n}\n","// list of various application logins\nexport enum AuthPlatformEnum {\n    Zendesk = 'zendesk'\n}\n","import { LoginBaseModel } from './login-base-model';\n\nexport class BiodigitalLoginModel extends LoginBaseModel {\n    constructor (\n        public email: string,\n        public password: string,\n        public rememberMe: boolean\n    ) {\n        super();\n    }\n\n    static toJSON(value: BiodigitalLoginModel): any {\n        return {\n            id_token: value.token, \n            version: value.version,\n            group_invite_mode: value.groupInviteMode,\n            group_invite_key: value.groupInviteKey,\n            group_code_mode: value.groupCodeMode,\n            group_code: value.groupCode,\n            email: value.email, \n            password: value.password,\n            email_remember_me: value.rememberMe,\n            // optoinal platform params\n            platform: value.platform,\n            return_to: value.returnTo,\n            brand_id: value.brandId,\n            locale_id: value.localeId,\n            timestamp: value.timestamp\n        };\n    }\n}\n","// {\n//     \"server_domain_name\": \"qa.biodigital.com\",\n//     \"google_api_key\": \"66261904577-061oin26uo7sor0vrqc8dnn105irq82n.apps.googleusercontent.com\",\n//     \"facebook_api_key\": \"218801781466301\",\n//     \"server_hosted_app_smiletrain\": \"smiletrain-qa.biodigital.com\",\n//     \"allow_auth_bypass\": true,\n//     \"server_api_domain_name\": \"api-qa.biodigital.com\",\n//     \"server_admin_domain_name\": \"admin-qa.biodigital.com\",\n//     \"server_marketing_domain_name\": \"site-qa.biodigital.com\",\n//     \"server_hosted_app_craniofacial\": \"civapro-qa.biodigital.com\",\n//     \"server_developer_domain_name\": \"developer-qa.biodigital.com\",\n//     \"server_accounts_domain_name\": \"accounts-qa.biodigital.com\",\n//     \"server_hosted_app_craniofacial_patient\": \"civa-qa.biodigital.com\",\n//     \"human_contact_email\": \"support@biodigital.com\",\n//     \"developer_contact_email\": \"developers@biodigital.com\"\n// }\n\nexport class EnvironmentSettingsModel {\n    google: string;\n    facebook: string;\n\n    static fromJSON(json: any): EnvironmentSettingsModel {\n        const settings = new EnvironmentSettingsModel();\n        settings.google = json.google_api_key;\n        settings.facebook = json.facebook_api_key;\n\n        return settings;\n    }\n}\n","import { LoginBaseModel } from './login-base-model';\n\nexport class FacebookLoginModel extends LoginBaseModel {\n    constructor (\n        authToken: string\n    ) {\n        super();\n        this.token = authToken;\n    }\n\n    static toJSON(value: FacebookLoginModel): any {\n        return {\n            access_token: value.token, \n            version: value.version,\n            group_invite_mode: value.groupInviteMode,\n            group_invite_key: value.groupInviteKey,\n            group_code_mode: value.groupCodeMode,\n            group_code: value.groupCode,\n            // optoinal platform params\n            platform: value.platform,\n            return_to: value.returnTo,\n            brand_id: value.brandId,\n            locale_id: value.localeId,\n            timestamp: value.timestamp\n        };\n    }\n}\n","import { LoginBaseModel } from './login-base-model';\n\nexport class GoogleLoginModel extends LoginBaseModel {\n    constructor (\n        idToken: string\n    ) { \n        super();\n        this.token = idToken;\n    }\n\n    static toJSON(value: GoogleLoginModel): any {\n        return {\n            id_token: value.token, \n            version: value.version,\n            group_invite_mode: value.groupInviteMode,\n            group_invite_key: value.groupInviteKey,\n            group_code_mode: value.groupCodeMode,\n            group_code: value.groupCode,\n            // optoinal platform params\n            platform: value.platform,\n            return_to: value.returnTo,\n            brand_id: value.brandId,\n            locale_id: value.localeId,\n            timestamp: value.timestamp            \n        };\n    }\n}\n","import { AuthPlatformEnum } from './auth-platform.enum';\n\nexport interface LoginResponseModel {\n    redirect_url: string;\n}\n\nexport class LoginBaseModel {\n    token: string;\n    version = 2;\n    groupInviteMode = 0;\n    groupInviteKey: string;\n    groupCodeMode = 0;\n    groupCode: string;\n\n     // optional platform params, i.e., Zendesk, Smiletrain\n    platform?: AuthPlatformEnum;\n    returnTo?: string;\n    brandId?: string;\n    localeId?: string;\n    timestamp?: string;\n\n    constructor () { }\n}\n","// credentials: \"....\"\n// is_user: true\n// user_email: \"mike@biodigital.com\"\n// user_is_developer: false\n// user_is_developer_active: false\n// user_is_developer_verified: false\n// user_is_third_party: false\n// user_third_party_provider: \"Google\"\n\n\n\nexport class ProfileCheckModel {\n    credentials: string;\n    email: string;\n\n    isUser: boolean;\n    isThirdParty: boolean;\n    isDeveloper: boolean;\n    isDeveloperActive: boolean;\n    isDeveloperVerified: boolean;\n\n    firstName: string;\n    lastName: string;\n    name: string;\n\n    thirdPartyProvider: 'Google' | 'Facebook' | '';\n    \n    static fromJSON(json: any) {\n        const profile = new ProfileCheckModel();\n\n        profile.email = json.user_email;\n        profile.credentials = json.credentials;\n        profile.isUser = json.is_user;\n        profile.isThirdParty = json.user_is_third_party;\n        profile.thirdPartyProvider = json.user_third_party_provider;\n        profile.isDeveloper = json.user_is_developer;\n        profile.isDeveloperActive = json.user_is_developer_active;\n        profile.isDeveloperVerified = json.user_is_developer_verified;\n\n        profile.firstName = json.user_first_name;\n        profile.lastName = json.user_last_name;\n        profile.name = `${json.firstName} ${json.lastName}`;\n\n        return profile;\n    }\n}\n","import { LoginBaseModel } from './login-base-model';\n\n// PATH\n// /ws/user/sign/up\n\n// SUCCESS\n// 200\n// null\n\n// ERROR\n// 400\n// {\"error\": {\"message\": \"This email address is already in use. <br/>Current users, please sign in.\", \"code\": 400, \"arguments\": null}}\n\nexport interface SignUpResponseModel {\n    redirect_url: string;\n}\n\nexport class SignUpModel extends LoginBaseModel {\n    version = 2;\n\n    email: string;\n    password: string;\n    name: string;\n    firstName: string;\n    lastName: string;\n    \n    static toJSON(value: SignUpModel): any {\n        return {\n            version: value.version,\n\n            email: value.email,\n            password: value.password,\n            first_name: value.firstName,\n            last_name: value.lastName,\n\n            // Required\n            group_invite_mode: value.groupInviteMode,\n            group_invite_key: value.groupInviteKey,\n            group_code_mode: value.groupCodeMode,\n            group_code: value.groupCode,\n\n            // optoinal platform params\n            platform: value.platform,\n            return_to: value.returnTo,\n            brand_id: value.brandId,\n            locale_id: value.localeId,\n            timestamp: value.timestamp\n        };\n    }\n}\n","export interface AppPlatform {\n    id: number;\n    type: AppPlatformTypeEnum;\n    name: AppPlatformNameEnum;\n    display_name: string;\n}\n\ninterface AppDomain {\n    id: number;\n    value: string;\n}\n\nexport enum AppPlatformNameEnum {\n    Web = 'widget_web',\n    Android = 'widget_mobilesdk_android',\n    iOS = 'widget_mobilesdk_ios'\n}\n\nexport enum AppPlatformTypeEnum {\n    Web = 'web',\n    Mobile = 'mobilesdk'\n}\n\nexport class UserAppModel {\n    // app\n    id: number;\n    app_name: string;\n    app_description: string;\n\n    // app keys\n    app_apikey: string;\n    app_apisecret: string;\n\n    // platforms\n    app_platform: AppPlatform[];\n\n    // domains\n    app_domains: AppDomain[];\n    developer_appdomain_limit: number;\n\n    // developer\n    developer_id: number;\n    developer_email: string;\n    developer_first_name: string;\n    developer_last_name: string;\n\n    // time\n    registration_datetime: string;\n    timestamp: string;\n}\n","\nexport enum UserMessageEnum {\n    DomainAlert = 'join_group_through_domain_alert',\n    WelcomeTour = 'welcome_tour_alert',\n    SurveyMonkey = 'survey_monkey_alert',\n    CompleteProfileAlert = 'complete_profile_alert'\n}\n\nexport default class UserMessageModel {\n    messageSeenId?: string;\n    messageType: UserMessageEnum;\n    messageData: any;\n    showUserAlert: boolean;\n}\n","import { Type } from 'class-transformer';\nimport { OrganizationModel } from '../../organizations/models/organization.model';\nimport { UserAccountSetting } from './account-settings.model';\nimport { ProfressionalSubscriptionModel } from './subscription/professional-subscription.model';\nimport { UserSubscriptionModel } from './subscription/user-subscription.model';\n\nexport class UserProfileModel {\n    city: string;\n    first_name: string;\n    last_name: string;\n    institution: string;\n    grade_level: string;\n    country: string;\n    sort_name_by_last: string;\n    email: string;\n    state: string;\n    sort_email: string;\n    eid: string;\n\n    // user account settings\n    account_settings: UserAccountSetting[];\n    \n    @Type(() => OrganizationModel)\n    organizations: OrganizationModel[];\n    \n    is_third_party: boolean;\n    user_is_developer: boolean;\n    id: number;\n    third_party_provider_name: string;\n\n    // subscription info\n    subscription?: UserSubscriptionModel | ProfressionalSubscriptionModel;\n    premium_account_type: string;\n    premium_account: boolean;\n    premium_account_valid: boolean;\n\n    // developer info\n    developer_account: boolean;\n    developer_account_active: boolean;\n    developer_account_verified: boolean;\n}\n\nexport function isBiodigitalProfile(profile: UserProfileModel) {\n    return profile.email.endsWith('@biodigital.com');\n}\n","import { UserProfileModel } from '../../models/user-profile.model';\nimport { ProfileCheckModel } from '../../models/profile-check.model';\nimport { EnvironmentSettingsModel } from '../../models/environment-settings.model';\nimport { SignUpModel, SignUpResponseModel } from '../../models/sign-up.model';\nimport { GoogleLoginModel } from '../../models/google-login.model';\nimport { FacebookLoginModel } from '../../models/facebook-login.model';\nimport { HttpErrorResponse } from '@angular/common/http';\nimport { LocaleModel } from 'src/app/shared/models/locale.model';\nimport { BiodigitalLoginModel } from '../../models/biodigital-login.model';\nimport { UserAppModel } from 'src/app/auth/models/user-app.model';\nimport UserMessageModel, { UserMessageEnum } from '../../models/user-message-model';\nimport { LoginResponseModel } from '../../models/login-base-model';\n\nexport class IsLoggedIn {\n  static readonly type = '[Auth] Is Logged In';\n  constructor() { }\n}\n\nexport class IsLoggedInSuccess {\n  static readonly type = '[Auth] Is Logged In Success';\n  constructor() { }\n}\n\nexport class IsLoggedInFailure {\n  static readonly type = '[Auth] Is Logged In Failure';\n  constructor() { }\n}\n\nexport class LoginWithBiodigital {\n  static readonly type = '[Auth] Login With Biodigital';\n  constructor(public login: BiodigitalLoginModel) { }\n}\n\nexport class LoginWithGoogle {\n  static readonly type = '[Auth] Login With Google';\n  constructor(public login: GoogleLoginModel) { }\n}\n\n// Deprecated\nexport class LoginWithFacebook {\n  static readonly type = '[Auth] Login With Facebook';\n  constructor(public login: FacebookLoginModel) { }\n}\n\nexport class LoginSuccess {\n  static readonly type = '[Auth] Login Success';\n  constructor(public response: LoginResponseModel) { }\n}\n\nexport class LoginFailure {\n  static readonly type = '[Auth] Login Failure';\n  constructor(public error: HttpErrorResponse, public login: BiodigitalLoginModel | GoogleLoginModel | FacebookLoginModel) { }\n}\n\nexport class Logout {\n  static readonly type = '[Auth] Logout';\n  constructor() { }\n}\n\nexport class LogoutSuccess {\n  static readonly type = '[Auth] Logout Success';\n  constructor() { }\n}\n\nexport class LogoutFailure {\n  static readonly type = '[Auth] Logout Failure';\n  constructor() { }\n}\n\nexport class GetEnvironmentSettings {\n  static readonly type = '[Auth] Get Environment Settings';\n  constructor() { }\n}\n\nexport class GetEnvironmentSettingsSuccess {\n  static readonly type = '[Auth] Get Environment Settings Success';\n  constructor(public environmentSettings: EnvironmentSettingsModel) { }\n}\n\nexport class GetEnvironmentSettingsFailure {\n  static readonly type = '[Auth] Get Environment Settings Failure';\n  constructor(public error: Error) { }\n}\n\nexport class GetUserProfile {\n  static readonly type = '[Auth] Get User Profile';\n  constructor(public hardCheck = false) { }\n}\n\nexport class GetUserProfileSuccess {\n  static readonly type = '[Auth] Get User Profile Success';\n  constructor(public userProfile: UserProfileModel) { }\n}\n\nexport class GetUserProfileFailure {\n  static readonly type = '[Auth] Get User Profile Failure';\n  constructor(public error: Error) { }\n}\n\nexport class UpdateUserProfile {\n  static readonly type = '[Auth] Update User Profile';\n  constructor(public userProfile: Partial<UserProfileModel>) { }\n}\n\nexport class UpdateUserProfileSuccess {\n  static readonly type = '[Auth] Update User Profile Success';\n  constructor(public userProfile: Partial<UserProfileModel>) { }\n}\n\nexport class UpdateUserProfileFailure {\n  static readonly type = '[Auth] Update User Profile Failure';\n  constructor(public error: Error) { }\n}\n\nexport class DeleteUserProfile {\n  static readonly type = '[Auth] Delete User Profile';\n  constructor() { }\n}\n\nexport class DeleteUserProfileSuccess {\n  static readonly type = '[Auth] Delete User Profile Success';\n  constructor(public userEmail: string) { }\n}\n\nexport class DeleteUserProfileFailure {\n  static readonly type = '[Auth] Delete User Profile Failure';\n  constructor(public error: Error) { }\n}\n\nexport class CheckProfile {\n  static readonly type = '[Auth] Check Profile';\n  constructor(public email: string) { }\n}\n\nexport class CheckProfileSuccess {\n  static readonly type = '[Auth] Check Profile Success';\n  constructor(public profile: ProfileCheckModel) { }\n}\n\nexport class CheckProfileFailure {\n  static readonly type = '[Auth] Check Profile Failure';\n  constructor(public error: Error) { }\n}\n\nexport class ResetPassword {\n  static readonly type = '[Auth] Reset Password';\n  constructor(public email: string) { }\n}\n\nexport class ResetPasswordSuccess {\n  static readonly type = '[Auth] Reset Password Success';\n  constructor(public email: string) { }\n}\n\nexport class ResetPasswordFailure {\n  static readonly type = '[Auth] Reset Password Failure';\n  constructor(public error: Error) { }\n}\n\nexport class UpdatePassword {\n  static readonly type = '[Auth] Update Password';\n  constructor(public currentPassword: string, public newPassword: string, public confirmNewPassword: string) { }\n}\n\nexport class UpdatePasswordSuccess {\n  static readonly type = '[Auth] Update Password Success';\n  constructor() { }\n}\n\nexport class UpdatePasswordFailure {\n  static readonly type = '[Auth] Update Password Failure';\n  constructor(public error: Error) { }\n}\n\nexport class CheckSession {\n  static readonly type = '[Auth] Check Session';\n  constructor() { }\n}\n\nexport class SignUp {\n  static readonly type = '[Auth] Sign Up';\n  constructor(public value: SignUpModel) { }\n}\n\nexport class SignUpSuccess {\n  static readonly type = '[Auth] Sign Up Success';\n  constructor(public response: SignUpResponseModel) { }\n}\n\nexport class SignUpFailure {\n  static readonly type = '[Auth] Sign Up Failure';\n  constructor(public error: HttpErrorResponse) { }\n}\n\nexport class SetUserLocale {\n  static readonly type = '[Auth] Set User Locale';\n  constructor(public locale: LocaleModel) { }\n}\n\nexport class SetUserLocaleSuccess {\n  static readonly type = '[Auth] Set User Locale Success';\n  constructor(public locale: LocaleModel) { }\n}\n\nexport class CheckLocale {\n  static readonly type = '[Auth] Check Locale';\n  constructor() { }\n}\n\nexport class GetUserApps {\n  static readonly type = '[Auth] Get User Apps';\n  constructor() { }\n}\n\nexport class SetUserApps {\n  static readonly type = '[Auth] Set User Apps';\n  constructor(public apps: UserAppModel[]) { }\n}\n\nexport class CheckSelectedUserApp {\n  static readonly type = '[Auth] Check Selected App';\n  constructor() { }\n}\n\nexport class SetSelectedUserApp {\n  static readonly type = '[Auth] Set Selected User App';\n  constructor(public appId: number) { }\n}\n\nexport class SendUserMessage {\n  static readonly type = '[Auth] Send User Message';\n  constructor(public message: { type: string; id: string; }) { }\n}\n\nexport class SendUserMessageSuccess {\n  static readonly type = '[Auth] Send User Message Success';\n  constructor(public message: { type: string; id: string; }) { }\n}\n\nexport class SendUserMessageFail {\n  static readonly type = '[Auth] Send User Message Fail';\n  constructor(public err: Error) { }\n}\n\nexport class GetUserMessage {\n  static readonly type = '[Auth] Get User Message';\n  constructor(public type: UserMessageEnum, public mode: string) { }\n}\n\nexport class GetUserMessageSuccess {\n  static readonly type = '[Auth] Get User Message Success';\n  constructor(public message: UserMessageModel) { }\n}\n\nexport class GetUserMessageFail {\n  static readonly type = '[Auth] Get User Message Fail';\n  constructor(public type: UserMessageEnum) { }\n}\n\nexport class SetUserMessageViewed {\n  static readonly type = '[Auth] Set Message Viewed';\n  constructor(public messageSeenId: string) { }\n}\n\nexport class SetUserMessageViewedSuccess {\n  static readonly type = '[Auth] Set Message Viewed Success';\n  constructor() { }\n}\n\nexport class SetUserMessageViewedFail {\n  static readonly type = '[Auth] Set Message Viewed Fail';\n  constructor() { }\n}\n\nexport class VerifyFail {\n  static readonly type = '[Auth] Verify Fail';\n  constructor() { }\n}\n\nexport class ResetAuth {\n  static readonly type = '[Auth] Reset';\n  constructor() { }\n}\n","import { UserProfileModel } from '../../models/user-profile.model';\nimport { ProfileCheckModel } from '../../models/profile-check.model';\nimport { EnvironmentSettingsModel } from '../../models/environment-settings.model';\nimport { LocaleModel } from 'src/app/shared/models/locale.model';\nimport { UserAppModel } from 'src/app/auth/models/user-app.model';\n\nexport class AuthStateModel {\n    environmentSettings?: EnvironmentSettingsModel;\n    loading: boolean;\n    profileStatus: 'ready' | 'updating' | 'deleting';\n    loggedIn?: boolean;\n    userProfile?: UserProfileModel;\n    profileCheck?: ProfileCheckModel;\n\n    userLocale: LocaleModel;\n    userApps?: UserAppModel[];\n    selectedAppId?: number;\n}\n","import { State, Action, StateContext, Selector, NgxsOnInit, Store } from '@ngxs/store';\nimport { AuthStateModel } from './auth.state.model';\nimport { \n  LoginWithBiodigital,\n  LoginSuccess,\n  LoginFailure,\n  GetUserProfile,\n  Logout,\n  LogoutSuccess,\n  IsLoggedIn,\n  IsLoggedInSuccess,\n  IsLoggedInFailure,\n  GetUserProfileSuccess,\n  GetUserProfileFailure, \n  CheckSession,\n  CheckProfile,\n  CheckProfileSuccess,\n  CheckProfileFailure,\n  GetEnvironmentSettings,\n  GetEnvironmentSettingsSuccess,\n  GetEnvironmentSettingsFailure,\n  ResetPassword,\n  ResetPasswordSuccess,\n  ResetPasswordFailure,\n  SignUp,\n  SignUpSuccess,\n  SignUpFailure,\n  LoginWithGoogle,\n  LoginWithFacebook,\n  SetUserLocale,\n  SetUserLocaleSuccess,\n  CheckLocale,\n  GetUserApps,\n  SetSelectedUserApp,\n  SetUserApps,\n  CheckSelectedUserApp,\n  SetUserMessageViewed,\n  SetUserMessageViewedSuccess,\n  SetUserMessageViewedFail,\n  ResetAuth,\n  GetUserMessage,\n  GetUserMessageFail,\n  GetUserMessageSuccess,\n  LogoutFailure,\n  VerifyFail,\n  UpdateUserProfile,\n  UpdateUserProfileFailure,\n  UpdateUserProfileSuccess,\n  UpdatePassword,\n  UpdatePasswordSuccess,\n  UpdatePasswordFailure,\n  DeleteUserProfile,\n  DeleteUserProfileFailure,\n  DeleteUserProfileSuccess,\n  SendUserMessage,\n  SendUserMessageSuccess,\n  SendUserMessageFail\n} from './auth.actions';\nimport { AuthService } from '../../auth.service';\nimport { SetOrganizations, ResetOrganizations } from 'src/app/organizations/state/organizations.actions';\nimport { finalize, take, filter, flatMap, tap } from 'rxjs/operators';\nimport { HttpErrorResponse } from '@angular/common/http';\nimport { LOCALE_ID, Inject } from '@angular/core';\nimport { StorageService, StorageItemEnum } from 'src/app/shared/storage.service';\nimport { locales, defaultLocale } from 'src/app/locale-config.module';\nimport { ResetBookmarks } from 'src/app/bookmarks/state/bookmarks.actions';\nimport { ResetEditPage } from 'src/app/edit/state/edit.actions';\nimport { ResetEnginePosition } from 'src/app/engine/state/engine.actions';\nimport { ResetLabels } from 'src/app/story/state/labels/story.labels.actions';\nimport { ResetStory } from 'src/app/story/state/story.actions';\nimport { ResetStoryChapters } from 'src/app/story/state/chapters/story.chapters.actions';\nimport { LayoutActions } from 'src/app/layout/state/layout.actions';\nimport { UserMessageService } from 'src/app/shared/user-message.service';\nimport { ErrorLoggingService, ErrorMessage } from 'src/app/shared/error-logging.service';\nimport { get, isNil } from 'lodash';\nimport { GalleryActions } from 'src/app/gallery/state/gallery.actions';\nimport { environment } from 'src/environments/environment';\nimport { EnvironmentDeploy } from 'src/environments/models/environment-deploy';\nimport { OrganizationModel } from 'src/app/organizations/models/organization.model';\nimport { UserAccountSetting } from '../../models/account-settings.model';\nimport { LoginResponseModel } from '../../models/login-base-model';\nimport { SignUpResponseModel } from '../../models/sign-up.model';\nimport { AppPlatformTypeEnum } from '../../models/user-app.model';\nimport { ResetSubscriptionState } from '../subscription/subscription.actions';\n\nconst initialState: AuthStateModel = {\n  loading: false,\n  profileStatus: 'ready',\n  loggedIn: null,\n  userLocale: null\n};\n\n@State<AuthStateModel>({\n  name: 'auth',\n  defaults: initialState\n})\nexport class AuthState implements NgxsOnInit {\n  /**\n   * Selectors\n   */\n  @Selector()\n  static getLoggedIn(state: AuthStateModel) {\n    return state.loggedIn;\n  }\n\n  @Selector()\n  static getEnvironmentSettings(state: AuthStateModel) {\n    return state.environmentSettings;\n  }\n\n  @Selector()\n  static getUserProfile(state: AuthStateModel) {\n    return state.userProfile;\n  }\n\n  @Selector()\n  static getUserAccountSettings(state: AuthStateModel): UserAccountSetting[] {\n    const settings: UserAccountSetting[] = get(state, 'userProfile.account_settings', []);\n    return settings;\n  }\n\n  @Selector()\n  static getProfileCheck(state: AuthStateModel) {\n    return state.profileCheck;\n  }\n\n  @Selector()\n  static getLoading(state: AuthStateModel) {\n    return state.loading;\n  }\n\n  @Selector()\n  static getProfileUpdating(state: AuthStateModel) {\n    return state.profileStatus === 'updating';\n  }\n\n  @Selector()\n  static getProfileDeleting(state: AuthStateModel) {\n    return state.profileStatus === 'deleting';\n  }\n\n  @Selector()\n  static getUserLocale(state: AuthStateModel) {\n    return state.userLocale;\n  }\n\n  @Selector()\n  static getUserLanguage(state: AuthStateModel): string {\n    return get(state, 'userLocale.lang', defaultLocale.lang);\n  }\n\n  @Selector()\n  static getUserApps(state: AuthStateModel) {\n    return get(state, 'userApps', []);\n  }\n\n  @Selector()\n  static getSelectedUserApp(state: AuthStateModel) {\n    const apps = state.userApps || [];\n    return apps.find((app) => app.id === state.selectedAppId);\n  }\n\n  @Selector()\n  static isPrivateUser(state: AuthStateModel) {\n    if (isNil(state.userProfile)) {\n      return false;\n    }\n    \n    const organizations = <OrganizationModel[]>get(state, 'userProfile.organizations', []);\n    return organizations.length === 0;\n  }\n\n  @Selector()\n  static isPremiumUser(state: AuthStateModel) {\n    return get(state, 'userProfile.premium_account_valid') === true;\n  }\n\n  /**\n   * Actions\n   */\n  @Action(IsLoggedIn)\n  isLoggedIn(context: StateContext<AuthStateModel>, action: IsLoggedIn) {\n    context.patchState({ loading: true });\n\n    this.authService.isLoggedIn()\n      .pipe(finalize(() => context.patchState({ loading: false })))\n      .subscribe(\n        (result: { signed_in: boolean }) => {\n          if (result.signed_in) {\n            context.dispatch(new IsLoggedInSuccess());\n          } else {\n            context.dispatch(new IsLoggedInFailure());\n          }\n        });\n  }\n  \n  @Action(IsLoggedInSuccess)\n  isLoggedInSuccess(context: StateContext<AuthStateModel>, action: IsLoggedInSuccess) {\n    context.patchState({\n      loggedIn: true\n    });\n  }\n\n  @Action(IsLoggedInFailure)\n  isLoggedInFailure(context: StateContext<AuthStateModel>, action: IsLoggedInFailure) {\n    context.patchState({\n      loggedIn: false\n    });\n  }\n\n\n  @Action(LoginWithBiodigital)\n  login(context: StateContext<AuthStateModel>, action: LoginWithBiodigital) {\n    context.patchState({ loading: true });\n\n    // Disable Recaptcha when working locally\n    if (environment.deploy === EnvironmentDeploy.Local) {\n      this.authService.loginWithBiodigital(action.login)\n        .pipe(finalize(() => context.patchState({ loading: false })))\n        .subscribe((response: LoginResponseModel) => {\n          context.dispatch(new LoginSuccess(response));\n        });\n\n    // Production Login\n    } else {\n      this.authService.isHuman('studio_login')\n        .pipe(\n          tap((isHuman) => { if (!isHuman) {\n            context.dispatch(new VerifyFail());\n          }}),\n          filter(isHuman => isHuman),\n          flatMap(() => this.authService.loginWithBiodigital(action.login)),\n          finalize(() => context.patchState({ loading: false }))\n        )\n        .subscribe(\n          (response: LoginResponseModel) => {\n            context.dispatch(new LoginSuccess(response));\n          },\n          (error) => {\n            this.logFailure('LOGIN_FAILURE', error);\n            context.dispatch(new LoginFailure(error, action.login));\n          });\n    }\n  }\n\n  @Action(LoginWithGoogle)\n  loginWithGoogle(context: StateContext<AuthStateModel>, action: LoginWithGoogle) {\n    context.patchState({ loading: true });\n\n    this.authService.loginWithGoogle(action.login)\n      .pipe(finalize(() => context.patchState({ loading: false })))\n      .subscribe(\n        (response: LoginResponseModel) => {\n          context.dispatch(new LoginSuccess(response));\n        },\n        (error: HttpErrorResponse) => {\n          if (action.login.groupCodeMode === 1 || action.login.groupInviteMode === 1) {\n            this.logFailure('GOOGLE_SIGNUP_FAILURE', error);\n          } \n          \n          context.dispatch(new LoginFailure(error, action.login));\n        });\n  }\n\n  // Deprecated\n  @Action(LoginWithFacebook)\n  loginWithFacebook(context: StateContext<AuthStateModel>, action: LoginWithFacebook) {\n    context.patchState({ loading: true });\n\n    this.authService.loginWithFacebook(action.login)\n      .pipe(finalize(() => context.patchState({ loading: false })))\n      .subscribe(\n        (response: LoginResponseModel) => {\n          context.dispatch(new LoginSuccess(response));\n        },\n        (error: HttpErrorResponse) => {\n          context.dispatch(new LoginFailure(error, action.login));\n        });\n  }\n\n  @Action(LoginSuccess)\n  loginSuccess(context: StateContext<AuthStateModel>, action: LoginSuccess) {\n    context.dispatch(new IsLoggedIn());\n    context.dispatch(new CheckLocale());\n  }\n\n  @Action(Logout)\n  logout(context: StateContext<AuthStateModel>, action: Logout) {\n    context.patchState({ loading: true });\n\n    this.authService.logout()\n      .pipe(finalize(() => context.patchState({ loading: false })))\n      .subscribe(\n        () => context.dispatch(new LogoutSuccess()),\n        () => context.dispatch(new LogoutFailure())\n      );\n  }\n\n  @Action(LogoutSuccess)\n  logoutSuccess(context: StateContext<AuthStateModel>, action: LogoutSuccess) {\n    context.setState(initialState);\n\n    context.dispatch(new ResetAuth());\n    context.dispatch(new ResetSubscriptionState());\n    context.dispatch(new ResetBookmarks());\n    context.dispatch(new ResetEditPage());\n    context.dispatch(new ResetEnginePosition());\n    context.dispatch(new ResetLabels());\n    context.dispatch(new LayoutActions.ResetLayout());\n    context.dispatch(new ResetOrganizations());\n    context.dispatch(new ResetStory());\n    context.dispatch(new ResetStoryChapters());\n    context.dispatch(new GalleryActions.Reset());    \n\n    // clear cached storage\n    this.storageService.clearSessionStorage();\n  }\n\n  @Action(CheckProfile)\n  checkProfile(context: StateContext<AuthStateModel>, action: CheckProfile) {\n    context.patchState({ loading: true });\n\n    return this.authService.checkProfile(action.email)\n      .pipe(finalize(() => context.patchState({ loading: false })))\n      .subscribe(\n        (profile) => {\n          context.dispatch(new CheckProfileSuccess(profile));\n        },\n        (error) => {\n          context.dispatch(new CheckProfileFailure(error));\n        }\n      );\n  }\n\n  @Action(CheckProfileSuccess)\n  checkProfileSuccess(context: StateContext<AuthStateModel>, action: CheckProfileSuccess) {\n    context.patchState({\n      profileCheck: action.profile\n    });\n  }\n\n  @Action(GetUserProfile)\n  getUserProfile(context: StateContext<AuthStateModel>, { hardCheck }: GetUserProfile) {\n    context.patchState({ loading: true });\n\n    return this.authService.getUserProfile(hardCheck)\n      .pipe(finalize(() => context.patchState({ loading: false })))\n      .subscribe(\n        (userProfile) => {\n          context.dispatch(new GetUserProfileSuccess(userProfile));\n        },\n        (error) => {\n          context.dispatch(new GetUserProfileFailure(error));\n        }\n      );\n  }\n\n  @Action(GetUserProfileSuccess)\n  getUserProfileSuccess(context: StateContext<AuthStateModel>, action: GetUserProfileSuccess) {\n    context.patchState({\n      userProfile: action.userProfile\n    });\n\n    context.dispatch(new SetOrganizations(action.userProfile.organizations));\n    context.dispatch(new GetUserApps());\n    context.dispatch(new CheckLocale());\n  }\n\n  @Action(UpdateUserProfile)\n  updateUserProfile(context: StateContext<AuthStateModel>, { userProfile }: UpdateUserProfile) {\n    context.patchState({ profileStatus: 'updating' });\n\n    this.authService.updaterUserProfile(userProfile)\n      .pipe(finalize(() => context.patchState({ profileStatus: 'ready' })))\n      .subscribe(\n        () => {\n          context.dispatch(new UpdateUserProfileSuccess(userProfile));\n        },\n        (error) => {\n          context.dispatch(new UpdateUserProfileFailure(error));\n        }\n      );\n  }\n\n  @Action(DeleteUserProfile)\n  deleteUserProfile(context: StateContext<AuthStateModel>, action: DeleteUserProfile) {\n    context.patchState({ profileStatus: 'deleting' });\n\n    this.authService.deleteUserProfile()\n      .pipe(finalize(() => context.patchState({ profileStatus: 'ready' })))\n      .subscribe(\n        (email) => {\n          context.dispatch(new DeleteUserProfileSuccess(email));\n        },\n        (error) => {\n          context.dispatch(new DeleteUserProfileFailure(error));\n        }\n      );\n  }\n\n  @Action(GetUserApps)\n  getUserApps(context: StateContext<AuthStateModel>, action: GetUserApps) {\n    this.authService.getUserApps()\n      .subscribe(\n        (apps) => {\n          context.dispatch(new SetUserApps(apps));\n          context.dispatch(new CheckSelectedUserApp());\n        },\n        // #TODO: handle errors\n        (err) => {\n\n        });\n  }\n\n  @Action(SetUserApps)\n  setUserApps(context: StateContext<AuthStateModel>, { apps }: SetUserApps) {\n    context.patchState({\n      userApps: apps\n    });\n  }\n\n  @Action(SetSelectedUserApp)\n  setSelectedUserApp(context: StateContext<AuthStateModel>, { appId }: SetSelectedUserApp) {\n    context.patchState({\n      selectedAppId: appId\n    });\n    // update storage\n    if (appId !== null) {\n      this.storageService.setLocalItem(StorageItemEnum.UserAppId, appId);\n    } else {\n      this.storageService.removeLocalItem(StorageItemEnum.UserAppId);\n    }\n  }\n\n  @Action(CheckSelectedUserApp)\n  checkSelectedUserApp(context: StateContext<AuthStateModel>, action: CheckSelectedUserApp) {\n    const apps = context.getState().userApps;\n    const storedAppId = this.storageService.getLocalItem(StorageItemEnum.UserAppId);\n    if (storedAppId) { // set stored app\n      const appId = parseInt(storedAppId, 10);\n      context.dispatch(new SetSelectedUserApp(appId));\n    } else if (apps && apps.length) { // set default app\n\n      // restrict to web app\n      const app = apps\n        .find((a) => {\n          return a.app_platform\n            .some((p) => p.type === AppPlatformTypeEnum.Web);\n        });\n\n      context.dispatch(new SetSelectedUserApp(app ? app.id : undefined));\n    }\n  }\n\n  @Action(CheckSession)\n  checkSession(context: StateContext<AuthStateModel>, action: CheckSession) {\n    context.patchState({ loading: true });\n\n    this.authService.isLoggedIn()\n      .pipe(finalize(() => context.patchState({ loading: false })))\n      .subscribe((result: { signed_in: boolean }) => {\n        if (result.signed_in) {\n          context.dispatch(new IsLoggedInSuccess());\n          context.dispatch(new GetUserProfile());\n        } else {\n          context.dispatch(new IsLoggedInFailure());\n        }\n      });\n  }\n\n  @Action(GetEnvironmentSettings)\n  getEnvironmentSettings(context: StateContext<AuthStateModel>, action: GetEnvironmentSettings) {\n    context.patchState({ loading: true });\n\n    return this.authService.getEnvironmentSettings()\n      .pipe(finalize(() => context.patchState({ loading: false })))\n      .subscribe(\n        (environmentSettings) => {\n          context.dispatch(new GetEnvironmentSettingsSuccess(environmentSettings));\n        },\n        (error) => {\n          context.dispatch(new GetEnvironmentSettingsFailure(error));\n        }\n      );\n  }\n\n  @Action(GetEnvironmentSettingsSuccess)\n  GetEnvironmentSettingsSuccess(context: StateContext<AuthStateModel>, action: GetEnvironmentSettingsSuccess) {\n    context.patchState({\n      environmentSettings: action.environmentSettings\n    });\n  }\n\n  @Action(ResetPassword)\n  resetPassword(context: StateContext<AuthStateModel>, action: ResetPassword) {\n    context.patchState({ loading: true });\n\n    this.authService.resetPassword(action.email)\n      .pipe(finalize(() => context.patchState({ loading: false })))\n      .subscribe(\n        () => {\n          context.dispatch(new ResetPasswordSuccess(action.email));\n        },\n        (error) => {\n          context.dispatch(new ResetPasswordFailure(error));\n        }\n      );\n  }\n\n  @Action(UpdatePassword)\n  updatePassword(context: StateContext<AuthStateModel>, action: UpdatePassword) {\n    const { currentPassword, newPassword, confirmNewPassword } = action;\n\n    this.authService.updatePassword(currentPassword, newPassword, confirmNewPassword)\n      .subscribe(\n        () => {\n          context.dispatch(new UpdatePasswordSuccess());\n        },\n        (error) => {\n          context.dispatch(new UpdatePasswordFailure(error));\n        }\n      );\n  }\n\n  @Action(SignUp)\n  signUp(context: StateContext<AuthStateModel>, action: SignUp) {\n    context.patchState({ loading: true });\n\n    this.authService.isHuman('studio_signup')\n      .pipe(\n        tap((isHuman) => { if (!isHuman) {\n          context.dispatch(new VerifyFail());\n        }}),\n        filter(isHuman => isHuman),\n        flatMap(() => this.authService.signUp(action.value)),\n        finalize(() => context.patchState({ loading: false }))\n      )\n      .subscribe(\n        (response: SignUpResponseModel) => {\n          context.dispatch(new SignUpSuccess(response));\n        },\n        (error) => {\n          context.dispatch(new SignUpFailure(error));\n        }\n      );\n  }\n\n  @Action(SignUpFailure)\n  signUpFailure(context: StateContext<AuthStateModel>, action: SignUpFailure) {\n    this.logFailure('BIODIGITAL_SIGNUP_FAILURE', action);\n  }\n\n  @Action(SetUserLocale)\n  setUserLocale(context: StateContext<AuthStateModel>, { locale }: SetUserLocale) {\n    // set storage\n    this.storageService.setLocalItem(StorageItemEnum.Locale, locale.id);\n\n    context.patchState({ userLocale: locale });\n    context.dispatch(new SetUserLocaleSuccess(locale));\n  }\n\n  @Action(CheckLocale)\n  checkLocale(context: StateContext<AuthStateModel>, action: CheckLocale) {\n    const targetLocale = locales.find((locale) => locale.id === this.localeId) || defaultLocale;\n    context.dispatch(new SetUserLocale(targetLocale));\n  }\n\n  @Action(SendUserMessage)\n  sendUserMessage(context: StateContext<AuthStateModel>, { message }: SendUserMessage) {\n    this.userMessageService.sendMessage(message)\n      .subscribe(\n        () => {\n          context.dispatch(new SendUserMessageSuccess(message));\n        },\n        (err) => {\n          context.dispatch(new SendUserMessageFail(err));\n        });\n  } \n\n  @Action(GetUserMessage)\n  getUserMessage(context: StateContext<AuthStateModel>, { type, mode }: GetUserMessage) {\n    this.userMessageService.getUserMessage(type, mode)\n      .subscribe(\n        (message) => {\n          context.dispatch(new GetUserMessageSuccess(message));\n        },\n        () => {\n          context.dispatch(new GetUserMessageFail(type));\n        });\n  } \n\n  @Action(SetUserMessageViewed)\n  setUserMessageViewed(context: StateContext<AuthStateModel>, { messageSeenId }: SetUserMessageViewed) {\n    this.userMessageService.setUserMessageViewed(messageSeenId)\n      .subscribe(\n        () => context.dispatch(new SetUserMessageViewedSuccess()),\n        () => context.dispatch(new SetUserMessageViewedFail())\n      );\n  }  \n\n  @Action(ResetAuth)\n  resetAuth(context: StateContext<AuthStateModel>, action: ResetAuth) {\n    context.setState(initialState);\n  }\n\n  private logFailure(category: string, error: any) {\n    const message = get(error, 'message') || '';\n    const log = get(error, 'error.error.message') || '';\n    this.errorLoggingService.logError(new ErrorMessage(category, message, log)).subscribe();\n  }\n\n  constructor(\n    private authService: AuthService,\n    private userMessageService: UserMessageService,\n    private storageService: StorageService,\n    @Inject(LOCALE_ID) private localeId: string,\n    private store: Store,\n    private errorLoggingService: ErrorLoggingService\n  ) { }\n\n  ngxsOnInit(context: StateContext<AuthStateModel>) {\n    context.dispatch(new CheckSession());\n    context.dispatch(new CheckLocale());\n    context.dispatch(new CheckSelectedUserApp());\n  }\n}\n","import { ProfressionalSubscriptionModel } from '../../models/subscription/professional-subscription.model';\nimport { PurchaseSubscriptionModel } from '../../models/utils/subscription';\nimport { SubscriptionPlanModel } from '../../models/subscription/subscription-plan.model';\n\nexport class ResetSubscriptionState {\n  static readonly type = '[Subscription] Reset Subscription State';\n  constructor() { }\n}\n\nexport class BuySubscription {\n  static readonly type = '[Subscription] Buy Subscription';\n  constructor(public request: PurchaseSubscriptionModel) { }\n}\n\nexport class BuySubscriptionSuccess {\n  static readonly type = '[Subscription] Buy Subscription Success';\n  constructor(public request: PurchaseSubscriptionModel) { }\n}\n\nexport class BuySubscriptionFailure {\n  static readonly type = '[Subscription] Buy Subscription Failure';\n  constructor(public error: Error) { }\n}\n\nexport class UpdateSubscription {\n  static readonly type = '[Subscription] Update Subscription';\n  constructor(public nonce: string) { }\n}\n\nexport class UpdateSubscriptionSuccess {\n  static readonly type = '[Subscription] Update Subscription Success';\n  constructor() { }\n}\n\nexport class UpdateSubscriptionFailure {\n  static readonly type = '[Subscription] Update Subscription Failure';\n  constructor(public error: Error) { }\n}\n\nexport class CancelSubscription {\n  static readonly type = '[Subscription] Cancel Subscription';\n  constructor() { }\n}\n\nexport class CancelSubscriptionSuccess {\n  static readonly type = '[Subscription] Cancel Subscription Success';\n  constructor() { }\n}\n\nexport class CancelSubscriptionFailure {\n  static readonly type = '[Subscription] Cancel Subscription Failure';\n  constructor(public error: Error) { }\n}\n\n// Promo Code\nexport class CheckPromoCode {\n  static readonly type = '[Subscription] Check Promo Code';\n  constructor(public planId: string, public code: string) { }\n}\n\nexport class CheckPromoCodeSuccess {\n  static readonly type = '[Subscription] Check Promo Code Success';\n  constructor(public code: string, public plan: SubscriptionPlanModel) { }\n}\n\nexport class CheckPromoCodeFailure {\n  static readonly type = '[Subscription] Check Promo Code Failure';\n  constructor(public err: Error) { }\n}\n\nexport class RemovePromoCode {\n  static readonly type = '[Subscription] Remove Promo Code';\n  constructor() { }\n}\n\n// Braintree Plans\nexport class GetPremiumPlans {\n  static readonly type = '[Subscription] Get Premium Plans';\n  constructor() { }\n}\n\nexport class GetPremiumPlansSuccess {\n  static readonly type = '[Subscription] Get Premium Plans Success ';\n  constructor(public plans: SubscriptionPlanModel[]) { }\n}\n\nexport class GetPremiumPlansFailure {\n  static readonly type = '[Subscription] Get Premium Plans Failure';\n  constructor(error: Error) { }\n}\n\nexport class SetPremiumPlan {\n  static readonly type = '[Subscription] Set Premium Plan';\n  constructor(public plan?: SubscriptionPlanModel) { }\n}\n","import { ProfressionalSubscriptionModel } from '../../models/subscription/professional-subscription.model';\nimport { SubscriptionPlanModel } from '../../models/subscription/subscription-plan.model';\n\nexport class SubscriptionStateModel {\n    buying: boolean;\n    updating: boolean;\n    cancelling: boolean;\n    checkingCode: boolean;\n    // avialble plans for checkout\n    plans: SubscriptionPlanModel[];\n    selectedPlan?: SubscriptionPlanModel;\n}\n","import { State, Action, StateContext, Selector, NgxsOnInit } from '@ngxs/store';\nimport { SubscriptionStateModel } from './subscription.state.model';\nimport { SubscriptionService } from '../../subscription.service';\nimport {\n  BuySubscription,\n  BuySubscriptionFailure,\n  BuySubscriptionSuccess,\n  CancelSubscription,\n  CancelSubscriptionFailure,\n  CancelSubscriptionSuccess,\n  CheckPromoCode,\n  CheckPromoCodeFailure,\n  CheckPromoCodeSuccess,\n  GetPremiumPlans,\n  GetPremiumPlansFailure,\n  GetPremiumPlansSuccess,\n  RemovePromoCode,\n  ResetSubscriptionState,\n  SetPremiumPlan,\n  UpdateSubscription,\n  UpdateSubscriptionFailure,\n  UpdateSubscriptionSuccess\n} from './subscription.actions';\nimport { filter, finalize, flatMap, tap } from 'rxjs/operators';\nimport { AuthService } from '../../auth.service';\nimport { environment } from 'src/environments/environment';\nimport { EnvironmentDeploy } from 'src/environments/models/environment-deploy';\nimport { VerifyFail } from '../auth/auth.actions';\nimport { get, isNil } from 'lodash';\nimport { AuthState } from '../auth/auth.state';\nimport { AuthStateModel } from '../auth/auth.state.model';\n\nconst initialState: SubscriptionStateModel = {\n  buying: false,\n  updating: false,\n  cancelling: false,\n  checkingCode: false,\n  plans: [],\n  selectedPlan: undefined\n};\n\n@State<SubscriptionStateModel>({\n  name: 'subscription',\n  defaults: initialState\n})\nexport class SubscriptionState implements NgxsOnInit {\n\n  @Selector()\n  static getBuying(state: SubscriptionStateModel) {\n    return state.buying;\n  }\n\n  @Selector()\n  static getUpdating(state: SubscriptionStateModel) {\n    return state.updating;\n  }\n\n  @Selector()\n  static getCancelling(state: SubscriptionStateModel) {\n    return state.cancelling;\n  }\n\n  @Selector([AuthState])\n  static getSubscription(state: SubscriptionStateModel, profileState: AuthStateModel) {\n    const subscription = get(profileState, 'userProfile.subscription');\n    return subscription;\n  }\n\n  @Selector()\n  static getPlans(state: SubscriptionStateModel) {\n    return state.plans;\n  }\n\n  @Selector()\n  static getSelectedPlan(state: SubscriptionStateModel) {\n    return state.selectedPlan;\n  }\n\n  @Selector()\n  static getCheckingCode(state: SubscriptionStateModel) {\n    return state.checkingCode;\n  }\n\n  @Selector([AuthState])\n  static isFreeTrial(state: SubscriptionStateModel, profileState: AuthStateModel) {\n    const subscription_type = get(profileState, 'userProfile.subscription.subscription_type');\n    return subscription_type === 'Free Trial';\n  }\n\n  @Selector([AuthState])\n  static isCanceled(state: SubscriptionStateModel, profileState: AuthStateModel) {\n    const subscription_status = get(profileState, 'userProfile.subscription.subscription_status');\n    return subscription_status === 'canceled';\n  }\n\n  /**\n   * Actions\n   */\n  @Action(ResetSubscriptionState)\n  resetSubscriptionState(context: StateContext<SubscriptionStateModel>, action: ResetSubscriptionState) {\n    context.setState(initialState);\n  }\n\n  @Action(GetPremiumPlans)\n  getPremiumPlans(context: StateContext<SubscriptionStateModel>, action: GetPremiumPlans) {\n    this.subscriptionService.getBraintreePlans()\n      .subscribe((plans) => {\n        context.dispatch(new GetPremiumPlansSuccess(plans));\n      }, (err) => {\n        context.dispatch(new GetPremiumPlansFailure(err));\n      });\n  }\n\n  @Action(GetPremiumPlansSuccess)\n  getPremiumPlansSuccess(context: StateContext<SubscriptionStateModel>, { plans }: GetPremiumPlansSuccess) {\n    context.patchState({\n      plans\n    });\n  }\n\n  @Action(SetPremiumPlan)\n  setPremiumPlan(context: StateContext<SubscriptionStateModel>, { plan }: SetPremiumPlan) {\n    context.patchState({\n      selectedPlan: plan\n    });\n  }\n\n  @Action(BuySubscription)\n  buySubscription(context: StateContext<SubscriptionStateModel>, { request }: BuySubscription) {\n    context.patchState({ buying: true });\n\n    // Disable Recaptcha when working locally\n    if (environment.deploy === EnvironmentDeploy.Local) {\n      this.subscriptionService.buyProfessionalSubscription(request)\n        .pipe(\n          finalize(() => context.patchState({ buying: false }))\n        )\n        .subscribe(() => {\n          context.dispatch(new BuySubscriptionSuccess(request));\n        }, (err) => {\n          context.dispatch(new BuySubscriptionFailure(err));\n        });\n      // Production Login\n    } else {\n      this.authService.isHuman('subscription_checkout')\n        .pipe(\n          tap((isHuman) => { if (!isHuman) {\n            context.dispatch(new VerifyFail());\n          }}),\n          filter(isHuman => isHuman),\n          flatMap(() => this.subscriptionService.buyProfessionalSubscription(request)),\n          finalize(() => context.patchState({ buying: false }))\n        )\n        .subscribe(() => {\n          context.dispatch(new BuySubscriptionSuccess(request));\n        }, (err) => {\n          context.dispatch(new BuySubscriptionFailure(err));\n        });\n    }\n  }\n\n  @Action(UpdateSubscription)\n  updateSubscription(context: StateContext<SubscriptionStateModel>, { nonce }: UpdateSubscription) {\n    context.patchState({ updating: true });\n\n    this.subscriptionService.updateProfessionalSubscription(nonce)\n      .pipe(\n        finalize(() => context.patchState({ updating: false }))\n      )\n      .subscribe(() => {\n        context.dispatch(new UpdateSubscriptionSuccess());\n      }, (err) => {\n        context.dispatch(new UpdateSubscriptionFailure(err));\n      });\n  }\n\n  @Action(CancelSubscription)\n  cancelSubscription(context: StateContext<SubscriptionStateModel>, action: CancelSubscription) {\n    context.patchState({ cancelling: true });\n\n    this.subscriptionService.cancelSubscription()\n      .pipe(\n        finalize(() => context.patchState({ cancelling: false }))\n      )\n      .subscribe(() => {\n        context.dispatch(new CancelSubscriptionSuccess());\n      }, (err) => {\n        context.dispatch(new CancelSubscriptionFailure(err));\n      });\n  }\n\n  @Action(CheckPromoCode)\n  checkPromoCode(context: StateContext<SubscriptionStateModel>, { planId, code }: CheckPromoCode) {\n    context.patchState({ checkingCode: true });\n\n    this.subscriptionService.getBraintreePlan(planId, code)\n      .pipe(\n        finalize(() => context.patchState({ checkingCode: false }))\n      )\n      .subscribe((plan) => {\n        context.dispatch(new CheckPromoCodeSuccess(code, plan));\n      }, (err) => {\n        context.dispatch(new CheckPromoCodeFailure(err));\n      });\n  }\n\n  @Action(CheckPromoCodeSuccess)\n  checkPromoCodeSuccess(context: StateContext<SubscriptionStateModel>, action: CheckPromoCodeSuccess) {\n    // patch selected plan\n    const selectedPlan = context.getState().selectedPlan;\n    if (selectedPlan && !isNil(action.plan.discount)) {\n      context.patchState({\n        selectedPlan: {\n          ...selectedPlan,\n          discount: {\n            ...action.plan.discount\n          }\n        }\n      });\n    }\n  }\n\n  @Action(RemovePromoCode)\n  removePromoCode(context: StateContext<SubscriptionStateModel>, action: RemovePromoCode) {\n    // remove discount from selected subscription\n    const selectedPlan = context.getState().selectedPlan;\n    if (selectedPlan) {\n      delete selectedPlan['discount'];\n      context.patchState({\n        selectedPlan: {\n          ...selectedPlan\n        }\n      });\n    }\n  }  \n\n  constructor(\n    private authService: AuthService,\n    private subscriptionService: SubscriptionService\n  ) { }\n\n  ngxsOnInit(context: StateContext<SubscriptionStateModel>) {\n  }\n}\n","import { HttpClient } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable, of } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { ProfressionalSubscriptionModel } from './models/subscription/professional-subscription.model';\nimport { PurchaseSubscriptionModel } from './models/utils/subscription';\nimport { SubscriptionPlanModel } from './models/subscription/subscription-plan.model';\n\n// TODO: should be stored/retrieved from the backend\nconst subscriptionPlans: SubscriptionPlanModel[] = [{\n  id: 'monthly_web_mobile_3-99',\n  plan_display_name: 'monthly premium individual',\n  price: 3.99\n}];\n\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class SubscriptionService {\n\n  constructor(private http: HttpClient) { }\n\n  getBraintreePlans(): Observable<SubscriptionPlanModel[]> {\n    return of(subscriptionPlans);\n  }\n\n  getBraintreePlan(paymentplan: string, discountcode?: string): Observable<SubscriptionPlanModel> {\n    return this.http.get(`/ws/professional/plan?paymentplan=${paymentplan}&discountcode=${discountcode}`)\n      .pipe(\n        map((response: any) => response.plan)\n      );\n  }\n\n  getBraintreeClientToken(): Observable<string> {\n    return this.http.get('/ws/professional/customer')\n      .pipe(\n        map((response: any) => response.client_token)\n      );\n  }\n\n  getProfessionalSubscription(): Observable<ProfressionalSubscriptionModel> {\n    return this.http.get('/ws/user/profile?subscription_hard_check=1')\n      .pipe(\n        map((response: any) => response.subscription as ProfressionalSubscriptionModel)\n      );\n  }\n\n  buyProfessionalSubscription(request: PurchaseSubscriptionModel): Observable<any> {\n    return this.http.post('/ws/professional/subscribe', {\n      ...request,\n      subscription_intent: 'buy'\n    });\n  }\n\n  updateProfessionalSubscription(nonce: string): Observable<any> {\n    return this.http.post('/ws/professional/subscribe', {\n      payment_method_nonce: nonce,\n      subscription_intent: 'update'\n    });\n  }\n\n  cancelSubscription(): Observable<any> {\n    return this.http.post('/ws/professional/cancel', {});\n  }\n\n}\n","import { Injectable } from '@angular/core';\nimport { Store, Actions, ofActionCompleted, ActionCompletion } from '@ngxs/store';\nimport { PublishService, PublishLinkType } from '../publish/publish.service';\nimport { MatDialog, MatSnackBar } from '@angular/material';\nimport { DialogService } from '../dialogs/dialog.service';\nimport { BookmarkModel } from './models/bookmark.model';\nimport { OrganizationsState } from '../organizations/state/organizations.state';\nimport { WidgetOptions } from '../publish/models/widget-options.model';\nimport { PublishState } from '../publish/state/publish.state';\nimport { AuthState } from '../auth/state/auth/auth.state';\nimport {\n  CopyBookmark,\n  DeleteFavorite,\n  DeleteBookmark\n} from './state/bookmarks.actions';\nimport { flatMap, take } from 'rxjs/operators';\nimport {\n  PublishDialogComponent,\n  PublishDialogData,\n} from '../publish/components/publish-dialog/publish-dialog.component';\nimport { Router } from '@angular/router';\nimport { BookmarkAction, BookmarkActionEvent } from './models/bookmark-action';\nimport { isNil } from 'lodash';\nimport { ContentType } from '../story/models/content-type.enum';\nimport { BookmarksService } from './bookmarks.service';\nimport { BreakpointObserver } from '@angular/cdk/layout';\nimport { environment } from 'src/environments/environment';\nimport { EnvironmentPlatform } from 'src/environments/models/environment-platform';\nimport { EnvironmentApplication } from 'src/environments/models/environment-application';\nimport { DialogActions } from '../dialogs/state/dialog.actions';\nimport { StoryService } from '../story/story.service';\nimport { ClipboardService } from '../shared/clipboard.service';\n\nconst loftActions = [\n  BookmarkAction.View,\n  BookmarkAction.Edit\n];\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class BookmarkActionsService {\n  constructor(\n    private store: Store,\n    private publishService: PublishService,\n    private dialogService: DialogService,\n    private dialog: MatDialog,\n    private snackbar: MatSnackBar,\n    private router: Router,\n    private bookmarksService: BookmarksService,\n    private breakpointObserver: BreakpointObserver,\n    private clipboardService: ClipboardService\n  ) {}\n\n  getBookmarkActions(\n    bookmark: BookmarkModel,\n    isPremiumUser: boolean,\n    isPrivateUser: boolean,\n    options?: {\n      excludeActions?: BookmarkAction[],\n      includeActions?: BookmarkAction[]\n    }\n  ): BookmarkAction[] {\n    // If no bookmark is provided, return nothing\n    if (isNil(bookmark)) {\n      return [];\n    }\n\n    // When a \"bookmark\" content type is flagged as 'public' (a Community bookmark) we want to treat\n    // it as a module when not owned by the user. \n    // This prevents 3rd party users from seeing bookmark management options.\n    const tags = bookmark.tags || [];\n    const bookmarkType = (tags.includes('public') && !bookmark.is_owner) ? \n      ContentType.Module : bookmark.type;\n\n    let actions: BookmarkAction[] = [];\n    switch (bookmarkType) {\n      case ContentType.Module:\n        // custom client \"modules\" are enabled for sharing/publishing\n        const isCustomUserModel = !isNil(bookmark.module_accessor_level);\n        // collection \"modules\" are enabled for sharing/publishing\n        const isCollectionContent =  bookmark.collection_content === true;\n\n        const shareOptions = isCustomUserModel || isCollectionContent\n          ? [\n            BookmarkAction.Divider,\n            BookmarkAction.CopyURL,\n            BookmarkAction.Publish\n          ]\n          : [];\n\n        // for custom models, check if \"add to\" actions applicable (i.e., hide add to team if assigned to team already)\n        const addToActions = [\n          ...bookmark.module_accessor_level === 'user' ? [] : [BookmarkAction.AddToMyModels],\n          ...bookmark.module_accessor_level === 'group' ? [] : [BookmarkAction.AddToTeamModels]\n        ];\n\n        actions = [\n          BookmarkAction.View,\n          BookmarkAction.Edit,\n          ...shareOptions,\n          BookmarkAction.Divider,\n          ...addToActions\n        ];\n        break;\n\n      case ContentType.Bookmark:\n        actions = [\n          BookmarkAction.View,\n          BookmarkAction.Edit,\n          BookmarkAction.Divider,\n          BookmarkAction.CopyURL,\n          BookmarkAction.Publish,\n          BookmarkAction.Divider,\n          BookmarkAction.Manage,\n          BookmarkAction.Delete,\n          BookmarkAction.Divider,\n          BookmarkAction.AddToMyModels,\n        ];\n        break;\n    }\n\n    actions = actions.filter((bookmarkAction) => {\n      // Restrict Loft actions\n      if (environment.application === EnvironmentApplication.Loft && !loftActions.includes(bookmarkAction)) {\n        return false;\n      }\n\n      // Filter out any excluded actions\n      if (options.excludeActions && options.excludeActions.includes(bookmarkAction)) {\n        return false;\n      }\n\n      // Filter out only included actions\n      if (options.includeActions && !options.includeActions.includes(bookmarkAction)) {\n        return false;\n      }\n\n      switch (bookmarkAction) {\n        case BookmarkAction.View:\n        case BookmarkAction.Edit:\n          return (bookmark.premium ? isPremiumUser : true);\n\n        case BookmarkAction.Delete:\n          return bookmark.is_owner;\n\n        case BookmarkAction.AddToMyModels:\n          return (\n            !bookmark.is_owner && (bookmark.premium ? isPremiumUser : true)\n          );\n\n        case BookmarkAction.AddToTeamModels:\n          return !isPrivateUser;\n\n        case BookmarkAction.Manage:\n          return this.bookmarksService.canEdit(bookmark);\n\n        default:\n          return true;\n      }\n    });\n\n    // Certain actions are excluded from the small site due to lack of UI support.\n    // This is subject to change as we continue to grow the mobile experience.\n    const isSmall = this.breakpointObserver.isMatched('(max-width: 959px)');\n    const excludedActions = [\n      BookmarkAction.Edit,\n      BookmarkAction.Publish,\n      BookmarkAction.Manage,\n    ];\n\n    if (isSmall || environment.platform !== EnvironmentPlatform.Web) {\n      actions = actions.filter((action) => {\n        return (\n          !excludedActions.includes(action) && action !== BookmarkAction.Divider\n        );\n      });\n    }\n\n    // Clean up stray dividers\n    while (actions[0] === BookmarkAction.Divider) {\n      actions.splice(0, 1);\n    }\n    while (actions[actions.length - 1] === BookmarkAction.Divider) {\n      actions.pop();\n    }\n\n    return actions;\n  }\n\n  handleBookmarkAction(action: BookmarkActionEvent) {\n    const bookmark = action.bookmark as BookmarkModel;\n\n    switch (action.name) {\n      case BookmarkAction.View:\n        this.view(bookmark);\n        break;\n\n      case BookmarkAction.Edit:\n        this.router.navigate(['/edit'], { queryParams: { id: bookmark.id } });\n        break;\n\n      case BookmarkAction.Manage:\n        this.manage(bookmark);\n        break;\n\n      case BookmarkAction.Delete:\n        this.delete(bookmark);\n        break;\n\n      case BookmarkAction.CopyURL:\n        let _url: string;\n\n        this.generateBookmarkLink(bookmark)\n          .pipe(\n            flatMap((url) => {\n              _url = url;\n              return this.clipboardService.copyToClipboard(url);\n            })\n          )\n          .subscribe(copied => {\n            if (copied) {\n              this.snackbar.open('Successfully copied link to clipboard.');\n            } else {\n              this.dialogService.openClipboardDialog(_url);\n            }\n          });\n        break;\n\n      case BookmarkAction.AddToMyModels:\n        this.addToPrivate(bookmark);\n        break;\n\n      case BookmarkAction.AddToTeamModels:\n        this.addToTeam(bookmark);\n        break;\n\n      case BookmarkAction.Publish:\n        this.publish(bookmark);\n        break;\n    }\n  }\n\n  canEdit(bookmark: BookmarkModel, isPremiumUser: boolean): boolean {\n    return (bookmark.premium ? isPremiumUser : true);\n  }\n\n  generateBookmarkLink(bookmark: BookmarkModel) {\n    const widgetOptions =\n      this.store.selectSnapshot(OrganizationsState.getWidgetOptions) ||\n      new WidgetOptions();\n    const widgetURL = this.store.selectSnapshot(PublishState.getWidgetURL);\n    const lang = this.store.selectSnapshot(AuthState.getUserLanguage);\n    const app = this.store.selectSnapshot(AuthState.getSelectedUserApp);\n\n    // get url\n    return this.publishService.generateWidgetURL(\n      bookmark,\n      widgetURL,\n      widgetOptions,\n      null,\n      PublishLinkType.Single,\n      lang,\n      app\n    );\n  }\n\n  addToPrivate(bookmark: BookmarkModel) {\n    const lang = this.store.selectSnapshot(AuthState.getUserLocale).lang;\n    this.store.dispatch(new CopyBookmark(bookmark.id, bookmark.type, lang));\n  }\n\n  addToTeam(bookmark: BookmarkModel) {\n    this.dialogService.openAddTeamModelsDialog([bookmark]);\n  }\n\n  delete(bookmark: BookmarkModel) {\n    const dialogRef = this.dialogService.openConfirmDialog({\n      data: {\n        titleText: 'Delete 3D model',\n        bodyText: 'Are you sure you want to delete this 3D model?',\n        confirmText: 'Delete',\n        confirmColor: 'warn',\n      },\n    });\n\n    dialogRef\n      .afterClosed()\n      .pipe(take(1))\n      .subscribe((confirmed) => {\n        if (confirmed) {\n          // special case: favorites\n          const isFavorite = bookmark.favorite;\n          if (isFavorite) {\n            this.store.dispatch(new DeleteFavorite(bookmark));\n          } else {\n            this.store.dispatch(new DeleteBookmark(bookmark.id));\n          }\n        }\n      });\n  }\n\n  manage(bookmark: BookmarkModel) {\n    this.dialogService.openManageDialog(bookmark);\n  }\n\n  view(bookmark: BookmarkModel) {\n    const { id, title } = bookmark;\n\n    const lang = this.store.selectSnapshot(AuthState.getUserLocale).lang;\n    const isCustomWidget = this.isCustomWidget(bookmark);\n\n    // Premium\n    const isPremium =\n      bookmark.premium && !this.store.selectSnapshot(AuthState.isPremiumUser);\n    if (isPremium) {\n      this.store.dispatch(new DialogActions.OpenPremiumContent());\n\n      // Unavailable\n    } else if (bookmark.unavailable) {\n      this.snackbar.open(`Error opening \"${title}\", it is unavailable.`);\n\n      // Custom Widget\n    } else if (isCustomWidget) {\n      const url = this.publishService.getWidgetURL(\n        bookmark,\n        bookmark.embed_url,\n        new WidgetOptions()\n      );\n      const handle = window.open(url);\n\n      handle\n        ? this.snackbar.open(`\"${title}\" loaded in a new tab.`)\n        : this.snackbar.open(`Error launching \"${title}\" in a new tab.`);\n\n      // Normal Bookmark\n    } else {\n      this.router.navigate(['/view'], { queryParams: { id, lang } });\n    }\n  }\n\n  publish(bookmark: BookmarkModel) {\n    this.dialog.open(PublishDialogComponent, {\n      width: '90vw',\n      height: '95vh',\n      data: <PublishDialogData>{\n        bookmark: bookmark,\n      },\n    });\n  }\n\n  private isCustomWidget(bookmark: BookmarkModel) {\n    return this.publishService.isCustomWidget(bookmark.embed_url_path);\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { NgxsModule } from '@ngxs/store';\nimport { BookmarksState } from './state/bookmarks.state';\nimport { ReactiveFormsModule } from '@angular/forms';\nimport { SharedModule } from '../shared/shared.module';\nimport { MaterialModule } from '../material.module';\nimport { BookmarkActionsComponent } from './components/bookmark-actions/bookmark-actions.component';\nimport { RouterModule } from '@angular/router';\nimport { PublishModule } from '../publish/publish.module';\nimport { PublishDialogComponent } from '../publish/components/publish-dialog/publish-dialog.component';\nimport { NgxGoogleAnalyticsModule } from 'ngx-google-analytics';\n\n@NgModule({\n  imports: [\n    NgxsModule.forFeature([\n      BookmarksState\n    ]),\n    CommonModule,\n    MaterialModule,\n    ReactiveFormsModule,\n    SharedModule,\n    RouterModule,\n    PublishModule,\n    NgxGoogleAnalyticsModule\n  ],\n  declarations: [BookmarkActionsComponent],\n  exports: [BookmarkActionsComponent],\n  entryComponents: [\n    PublishDialogComponent\n  ]\n})\nexport class BookmarksModule { }\n","import { Injectable } from '@angular/core';\nimport { HttpClient, HttpHeaders, HttpErrorResponse } from '@angular/common/http';\nimport { map, flatMap, catchError, tap, retry } from 'rxjs/operators';\nimport { plainToClass } from 'class-transformer';\nimport { BookmarkModel } from './models/bookmark.model';\nimport { Observable, forkJoin, throwError, of } from 'rxjs';\nimport { StoryModel } from '../story/models/story.model';\nimport { BookmarkEntryModel } from './models/bookmark.entry.model';\nimport { BookmarkGroupModel } from './models/bookmark.group.model';\nimport { StoryChapterThumbnail } from 'src/app/story/models/story-chapter-thumbnail.model';\nimport { SerializeModuleService } from '../edit/serialize-module.service';\nimport { TrimConfiguration } from 'src/app/edit/models/trim-config.model';\nimport { ExploreService } from '../explore/explore.service';\nimport { ContentType } from '../story/models/content-type.enum';\n\nimport { endsWith, get } from 'lodash';\nimport { Store } from '@ngxs/store';\nimport { StoryState } from '../story/state/story.state';\nimport { StoryChaptersState } from '../story/state/chapters/story.chapters.state';\nimport { StoryService } from '../story/story.service';\n\nconst bookmarkServiceURL = '/ws/user/bookmark/v1';\nconst thumbnailServiceURL = '/ws/thumbs/bookmarks';\nconst favoritesServiceURL = '/ws/user/favorite';\n\nconst formHeaders = {\n  headers: new HttpHeaders({\n    'Content-Type': 'application/json; charset=utf-8'\n  })\n};\n\nexport enum BookmarkCategory {\n  Private = 'private',\n  Group = 'enterprise',\n  Public = 'public'\n}\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class BookmarksService {\n\n  constructor(\n    private store: Store,\n    private http: HttpClient,\n    private serializeModuleService: SerializeModuleService,\n    private exploreService: ExploreService,\n    private storyService: StoryService\n  ) { }\n\n  /**\n   * Gets the bookmark data by the specified id\n   * @param id The bookmark id\n   */\n  getBookmarkData(id: string): Observable<StoryModel> {\n    return this.http.get(`/search/bookmarks/data?be=${id}`)\n      .pipe(\n        retry(2), // Service randomly 502s\n        map((result: any) => {\n          result = result.bookmark;\n          result.moduleId = result.customData ? result.customData.moduleId : result.modules.activeModules[0];\n\n          return plainToClass(StoryModel, result as Object);\n        })\n      );\n  }\n\n  /**\n   * Gets the bookmark model data by specified id\n   * @param id The bookmark id\n   */\n  getBookmarkModel(id: string): Observable<BookmarkModel> {\n    return this.http.get(`/ws/search/bookmarks?eid=${id}`)\n      .pipe(\n        retry(2), // Service randomly 502s\n        map((result: any) => plainToClass(BookmarkModel, result.bookmark_info as object)),\n        map((bookmark: BookmarkModel) => this.normalizeBookmarkModel(bookmark))\n      );\n  }\n\n  /** Gets all user generated bookmarks by specified category\n   * @param category Category of bookmarks\n   * @param query Optional search query\n   */\n  getUserBookmarks(category: BookmarkCategory, query: string = ''): Observable<BookmarkModel[]> {\n    return this.http.get(`/ws/search/bookmarks/${category}?q=${query}`)\n      .pipe(\n        retry(2), // Service randomly 502s\n        map((results: object[]) => {\n          return results\n            .map((result) => plainToClass(BookmarkModel, result))\n            .map((bookmark) => this.normalizeBookmarkModel(bookmark));\n        })\n      );\n  }\n\n  /**\n   * Gets a list of user mapped custom conditions.\n   */\n  getUserConditions(category: BookmarkCategory, query = '', id?: number): Observable<BookmarkModel[]> {\n    let moduleAccessorLevel = '';\n    switch (category) {\n      case BookmarkCategory.Private:\n        moduleAccessorLevel = 'user';\n        break;\n      case BookmarkCategory.Group:\n        moduleAccessorLevel = 'group';\n        break;\n      default:\n        break;\n    }\n    return this.http.get(`/ws/search/conditions/private?q=${query}`)\n      .pipe(\n        // restrict by type + id\n        map((results: Object[]) => {\n          return results\n            .filter((result: any) => {\n              const matchedByType = result.module_accessor_level === moduleAccessorLevel;\n              const matchedById = !id || result.module_accessor_id === id;\n              return matchedByType && matchedById;\n            });\n        }),\n        // to bookmarks\n        map((results: Object[]) => plainToClass(BookmarkModel, results)),\n        // normalize\n        map((bookmarks: BookmarkModel[]) => {\n          return bookmarks\n            .map((bookmark) => this.normalizeBookmarkModel(bookmark));\n        })\n      );\n  }\n\n  /**\n   * Gets a list of private bookmarks only accessible to user\n   * @param query Optional search query\n   */\n  getPrivateBookmarks(query: string = ''): Observable<BookmarkModel[]> {\n    return this.getUserBookmarks(BookmarkCategory.Private, query)\n      .pipe(\n        map((bookmarks) => { // restrict to bookmark's owned\n          return bookmarks.filter((bookmark) => bookmark.is_owner);\n        })\n      );\n  }\n\n  /**\n   * Gets a list of user favorited content, by favorite id.\n   */\n  getFavorites(): Observable<BookmarkModel[]> {\n    return this.http.get(favoritesServiceURL)\n      .pipe(\n        map((results: any) => {\n          return Object.values(results)\n            .map((result) => plainToClass(BookmarkModel, result))\n            .map((bookmark) => this.normalizeBookmarkModel(bookmark));\n        })\n      );\n  }\n\n  /**\n   * Deletes the specified content in the user's favorites.\n   */\n  deleteFavorite(contentId: string, contentType: string): Observable<any> {\n    return this.http.delete(`${favoritesServiceURL}?modelId=${contentId}&category=${contentType}`);\n  }\n\n  /* Gets a list of user custom conditions.\n  */\n  getPrivateConditions(query = ''): Observable<BookmarkModel[]> {\n    return this.getUserConditions(BookmarkCategory.Private);\n  }\n\n  /**\n   * Gets a list of bookmarks for the specified organziation\n   * @param organizationId The organization id for the bookmarks\n   * @param query: Optional search query\n   */\n  getOrganizationBookmarks(organizationId: number, query: string = ''): Observable<BookmarkModel[]> {\n    return this.getUserBookmarks(BookmarkCategory.Private, query)\n      .pipe(\n        map((bookmarks) => {\n          // filter enterprise bookmarks\n          return bookmarks\n            .filter((bookmark) => bookmark.tags.includes('enterprise'))\n            // restrict to group accessibility\n            .filter((bookmark) => bookmark.group_access.some((access) => access.group_id === organizationId));\n        })\n      );\n  }\n\n  /**\n * Gets a list of group custom conditions.\n */\n  getOrganizationConditions(organizationId: number, query = '') {\n    return this.getUserConditions(BookmarkCategory.Group, query, organizationId);\n  }\n\n  /**\n   * Gets all content (bookmarks, modules) for the specified organization\n   */\n  getOrganizationContent(organizationId: number, query: string = '') {\n    return forkJoin(\n      this.getOrganizationBookmarks(organizationId, query),\n      this.getOrganizationConditions(organizationId, query)\n    )\n      .pipe(\n        map(([bookmarks, conditions]) => [...bookmarks, ...conditions])\n      );\n  }\n\n  // create a new bookmark object\n  createBookmarkStory(chapterIdMap): { story: StoryModel } {\n    return this.serializeModuleService.serialize(\n      {},\n      new TrimConfiguration(),\n      false,\n      this.store.selectSnapshot(StoryState.getStory),\n      this.store.selectSnapshot(StoryChaptersState.getStoryChapters),\n      chapterIdMap\n    );\n  }\n\n  /**\n   * Gets a list of public bookmarks\n   * @param query: Optional search query\n   */\n  getPublicBookmarks(query: string = ''): Observable<BookmarkModel[]> {\n    return this.getUserBookmarks(BookmarkCategory.Public, query);\n  }\n\n  saveBookmark(entry: BookmarkEntryModel): Observable<BookmarkModel> {\n    // normalize to required service params\n    const normalizedEntry = this.getNormalizedBookmarkEntry(entry);\n\n    let response$: Observable<any>;\n    if (entry.id) {\n      // update bookmark\n      response$ = this.http.post(`${bookmarkServiceURL}/update`, normalizedEntry, formHeaders);\n    } else {\n      // save new bookmark\n      response$ = this.http.post(`${bookmarkServiceURL}/save`, normalizedEntry, formHeaders);\n    }\n\n    return response$.pipe(\n      // normalize to bookmark model\n      flatMap((response: any) => this.getBookmarkModel(response.id))\n    );\n  }\n\n  deleteBookmark(id: string): Observable<any> {\n    return this.http.delete(`${bookmarkServiceURL}/delete?eid=${id}`)\n      .pipe(\n        catchError((response) => {\n          const { error } = response.error;\n          const message = error ? error.message : '';\n          return throwError(message);\n        })\n      );\n  }\n\n  copyBookmark(id: string, type: ContentType, lang: string = 'en') {\n    // Fix module id truncation\n    if (type === ContentType.Module && !endsWith(id, '.json')) {\n      id += '.json';\n    }\n\n    return this.http.post(`${bookmarkServiceURL}/copy`, { source_content_type: type, source_content_id: id })\n      .pipe(\n        map((response: any) => response.id),\n        flatMap((bookmarkId) => { // translate bookmark\n          return lang === 'en'\n            ? of(bookmarkId) // English: copy as-is\n            : this.translateBookmark(bookmarkId, id, type, lang); // translate into target lang\n        })\n      );\n  }\n\n  atMaxFreeBookmarkCount(): Observable<boolean> {\n    return this.http.get(`/ws/user/content/limit/check`)\n      .pipe(\n        map(() => false),\n        catchError((response) => of(response.status === 403))\n      );\n  }\n\n  // save thumbnail data for each chapter in a bookmark\n  saveBookmarkThumbnails(\n    id: string,\n    bookmarkEntry: BookmarkEntryModel,\n    thumbnails: Map<string, StoryChapterThumbnail>,\n    chapterIdMap: { [id: string]: string }\n  ): Observable<any>[] {\n\n    // chapter thumbnails\n    const thumbnailRequests$ = bookmarkEntry.index.chapters.reduce<Observable<any>[]>((requests, chapter) => {\n      const newChapterId = chapter.id;\n      const oldChapterId = chapterIdMap[newChapterId];\n      const currentThumbnail = thumbnails.get(oldChapterId);\n\n      const snapshot = get(currentThumbnail, 'snapshot');\n\n      if (snapshot) {\n        requests.push(this.postThumbnail(id, chapter.id, snapshot, true));\n      } else if (chapter.id !== chapterIdMap[chapter.id] || currentThumbnail.chapterId !== chapter.id) {\n        const largeUrl = get(currentThumbnail, 'urls.large');\n\n        if (largeUrl) {\n          const splitIdx = largeUrl.match(/(bookmarks\\/)|(modules\\/)/).index;\n          const srcURL = largeUrl.slice(splitIdx);\n          requests.push(this.copyThumbnail(id, chapter.id, srcURL));\n        }\n      }\n      return requests;\n    }, []);\n\n    // bookmark gallery thumbnail\n    const firstChapterThumbnail = thumbnails.get(chapterIdMap[bookmarkEntry.index.chapters[0].id]);\n    const firstChapterSnapshot = get(firstChapterThumbnail, 'snapshot');\n    if (firstChapterSnapshot) {\n      // create new\n      thumbnailRequests$.push(this.postThumbnail(id, null, firstChapterSnapshot, true));\n    } else {\n      // copy existing\n      const largeUrl = get(firstChapterThumbnail, 'urls.large');\n      if (largeUrl) {\n        thumbnailRequests$.push(this.copyThumbnail(id, null, largeUrl));\n      }\n    }\n\n    return thumbnailRequests$;\n  }\n\n  // delete thumbnails for deleted chapters\n  deleteBookmarkThumbnails(id: string, bookmarkEntry: BookmarkEntryModel,\n    thumbnails: Map<string, StoryChapterThumbnail>, chapterIdMap: { [id: string]: string }): Observable<any>[] {\n    /*\n    delete existing (server stored) thumbnail urls on deleted chapters\n    */\n    const chapterIds = bookmarkEntry.index.chapters.map((chapter) => chapterIdMap[chapter.id] || chapter.id);\n    const deleteRequests$ = Array.from(thumbnails.values()).filter((thumbnail) => chapterIds.indexOf(thumbnail.chapterId) < 0)\n      .map((thumbnail) => {\n        return this.deleteThumbnail(id, thumbnail.chapterId);\n      });\n\n    return deleteRequests$;\n  }\n\n\n  /**\n   * Filters the specified list by tags\n   * @param bookmarks The list of bookmarks\n   * @param tags The list of tags\n   * @param inclusive True to match all tags, else single match\n   */\n  filterByTags(\n    bookmarks: BookmarkModel[],\n    tags: string[],\n    inclusive: boolean = false\n  ): BookmarkModel[] {\n    return bookmarks.filter((bookmark) => {\n      if (inclusive) {\n        return tags.every((tag) => bookmark.tags.includes(tag));\n      } else {\n        return tags.some((tag) => bookmark.tags.includes(tag));\n      }\n    });\n  }\n\n  canEdit(bookmark: BookmarkModel) {\n    if (bookmark.type === ContentType.Module) {\n      return true;\n    }\n\n    if (bookmark.is_owner) {\n      return true;\n    }\n\n    if (bookmark.group_access && bookmark.group_access.length) {\n      return bookmark.group_access[0].member_edit;\n    }\n\n    return false;\n  }\n\n  normalizeBookmarkModel(bookmark: BookmarkModel): BookmarkModel {\n    const { id, type } = bookmark;\n    // normalize id\n    if (type === 'module') {\n      bookmark.id = this.exploreService.toAppContentId(id);\n    }\n    // normalize tag properties\n    bookmark.tour = bookmark.tags.includes('tour');\n    bookmark.animated = bookmark.tags.includes('animated');\n\n    return bookmark;\n  }\n\n  /**\n   * For the specified bookmark id, translate using the source bookmark | module\n   */\n  private translateBookmark(bookmarkId: string, sourceBookmarkId: string, sourceBookmarkType: ContentType, sourceLang: string): Observable<string> {\n    // normalize ID\n    const normalizedSourceBookmarkId = (sourceBookmarkType === ContentType.Module || sourceBookmarkType === ContentType.Internal)\n      ? sourceBookmarkId.replace('.json', '')\n      : sourceBookmarkId;\n\n    return forkJoin(\n      // get story\n      this.storyService.getStory(bookmarkId, ContentType.Bookmark),\n      // get source translation\n      this.storyService.getStoryTranslation(normalizedSourceBookmarkId, sourceBookmarkType, sourceLang)\n    )\n      .pipe(\n        // translate story\n        map(([bookmarkStory, sourceTranslation]) => this.storyService.translateStory(bookmarkStory, sourceTranslation)),\n        // update bookmark w/ translated story\n        flatMap((translatedBookmarkStory) => {\n          return this.saveBookmark({\n            isOwner: true,\n            // NOTE: Bookmark service restriction: title (maxlength = 60)\n            title: translatedBookmarkStory.displayName.substr(0, 60),\n            id: bookmarkId,\n            index: translatedBookmarkStory\n          });\n        }),\n        map((bookmark) => bookmark.id),\n        // capture 404 request\n        catchError((err: HttpErrorResponse) => err.status === 404 ? of(bookmarkId) : throwError(err))\n      );\n  }\n\n  private getNormalizedBookmarkEntry(entry: BookmarkEntryModel): any {\n    const { id, title, description, index, public_access, add_group_access, remove_group_access, isOwner } = entry;\n\n    // optional user (owner) fields\n    let group_access: any;\n    let publicAccess: string;\n    let flags: any;\n\n    if (isOwner) {\n      // set additional group access    \n      group_access = add_group_access ? this.getGroupAccess(add_group_access) : [];\n\n      // revoke group access\n      if (remove_group_access) {\n        remove_group_access.forEach((access) => {\n          const removedAccess = this.getNormalizeGroupAccess({\n            group_id: access.group_id,\n            remove: true\n          });\n          group_access.push(removedAccess);\n        });\n      }\n\n      // set public access\n      publicAccess = this.getNormalizedBool(public_access);\n\n      // custom flags\n      if (index) {\n        // init flags\n        flags = {};\n\n        // flag: user generated tours\n        if (index.chapters) {\n          const isTour = index.chapters.length > 1;\n          flags['user_generated_tour'] = this.getNormalizedBool(isTour);\n        }\n        // flag: animated content\n        const isAnimated = (index.tags || []).includes('animated');\n        flags['animated'] = this.getNormalizedBool(isAnimated);\n      }\n    }\n\n    // normalized service entry\n    return {\n      eid: id,\n      name: title,\n      description: description,\n      // serialized story\n      index: index,\n      // permissions: set null for no updates\n      group_access: group_access,\n      public_access: publicAccess,\n      // custom bookmark flags\n      flags: flags\n    };\n  }\n\n  private getGroupAccess(groupAccess: BookmarkGroupModel[]): any {\n    return groupAccess.map((access) => this.getNormalizeGroupAccess(access));\n  }\n\n  private getNormalizeGroupAccess(access: BookmarkGroupModel): any {\n    const { group_id, group_name, member_edit, visible, remove } = access;\n\n    const normalized = {\n      group_id: group_id,\n      group_name: group_name,\n      member_edit: this.getNormalizedBool(member_edit),\n      visibility: this.getNormalizedBool(visible),\n      remove: this.getNormalizedBool(remove)\n    };\n    return normalized;\n  }\n\n  private getNormalizedBool(value: boolean): string {\n    return value === true ? '1' : (value === false ? '0' : '');\n  }\n\n  // request to server to save a thumbnail\n  private postThumbnail(storyId: string, chapterId: string, thumbnailURL: string, invalidate = false): Observable<any> {\n    const image = new Image();\n    image.src = thumbnailURL;\n\n    return new Observable((observer) => {\n      image.onload = () => {\n        // transfer image to canvas\n        const canvas = document.createElement('canvas');\n        const context = canvas.getContext('2d');\n\n        canvas.width = image.naturalWidth;\n        canvas.height = image.naturalHeight;\n\n        context.drawImage(image, 0, 0);\n\n        // convert to data url\n        const dataURL = canvas.toDataURL('image/jpeg', 1.0);\n\n        // post request for thumbnail\n        let _thumbnailURL = '';\n        if (chapterId) {\n          // chapter thumbnail\n          _thumbnailURL = `${thumbnailServiceURL}/${storyId}/large/chapters/${chapterId}.jpg`;\n        } else {\n          // story thumbnail\n          _thumbnailURL = `${thumbnailServiceURL}/${storyId}/large/index.jpg`;\n        }\n\n        const headers = new HttpHeaders().set('Content-Type', 'application/json');\n        this.http.post(_thumbnailURL, { image: dataURL, invalidate: invalidate }, { headers: headers, responseType: 'text' }).subscribe((r) => {\n          observer.next();\n          observer.complete();\n\n        });\n      };\n    });\n  }\n\n  // request to server to delete a thumbnail\n  private deleteThumbnail(storyId: string, chapterId: string): Observable<any> {\n    return new Observable((observer) => {\n      const request = new Request(`${thumbnailServiceURL}/${storyId}/large/chapters/${chapterId}.jpg`, { method: 'DELETE' });\n      fetch(request).then((response) => {\n        observer.complete();\n      });\n    });\n  }\n\n  // request to server to copy a thumbnail from one location to another\n  private copyThumbnail(storyId: string, chapterId: string, src: string): Observable<any> {\n    let dst = '';\n    const srcURL = src.replace('/thumbs/', ''); // \n    if (chapterId) {\n      // copy to chapter location\n      dst = `bookmarks/${storyId}/large/chapters/${chapterId}.jpg`;\n    } else {\n      // copy to index location\n      dst = `bookmarks/${storyId}/large/index.jpg`;\n    }\n\n    const header = new HttpHeaders().set('Content-Type', 'application/json');\n\n    return new Observable((observer) => {\n      this.http.post('/ws/thumbs/copy', { src: srcURL, dst: dst }, { headers: header, responseType: 'text' }).subscribe((r) => {\n        observer.next();\n        observer.complete();\n      });\n    });\n  }\n}\n","import { BookmarkSortModel } from '../models/bookmark-sort.model';\nimport { BookmarkModel } from '../models/bookmark.model';\n\nexport const bookmarkSortRelevance: BookmarkSortModel = {\n    label: 'Relevance',\n    fields: [],\n    ascending: true\n};\n\nexport const bookmarkSortRecent: BookmarkSortModel = {\n    label: 'Most Recent',\n    fields: ['collection_content_createdate', 'update_date_time', 'create_date_time'],\n    ascending: false\n};\n\nexport const bookmarkSortTitleAsc: BookmarkSortModel = {\n    label: 'Title (A-Z)',\n    fields: ['title'],\n    ascending: true\n};\n\nexport const bookmarkSortTitleDesc: BookmarkSortModel = {\n    label: 'Title (Z-A)',\n    fields: ['title'],\n    ascending: false\n};\n\nexport const bookmarkSortAuthorAsc: BookmarkSortModel = {\n    label: 'Author (A-Z)',\n    fields: ['author'],\n    ascending: true\n};\n\nexport const bookmarkSortAuthorDesc: BookmarkSortModel = {\n    label: 'Author (Z-A)',\n    fields: ['author'],\n    ascending: false\n};\n\nexport const bookmarkSortOptions: BookmarkSortModel[] = [\n    bookmarkSortRelevance,\n    bookmarkSortRecent,\n    bookmarkSortTitleAsc,\n    bookmarkSortTitleDesc,\n    bookmarkSortAuthorAsc,\n    bookmarkSortAuthorDesc\n];\n","export interface TagCategory {\n  title: string;\n  tags: string[];\n}\n\nexport const tagsStatus: TagCategory = {\n  title: 'Status',\n  tags: [\n    'Live',\n    'obsolete'\n  ]\n};\n\nexport const tagsPaywall: TagCategory = {\n  title: 'Paywall',\n  tags: [\n    'Premium',\n    'Basic'\n  ]\n};\n\nexport const tagsPlatform: TagCategory = {\n  title: 'Platform',\n  tags: [\n    'web platform',\n    'ios platform',\n    'android platform'\n  ]\n};\n\nexport const tagsFlags: TagCategory = {\n  title: 'Flags',\n  tags: [\n    'animated',\n    'tour',\n    'featured',\n    'Audio'\n  ]\n};\n\nexport const tagsGender: TagCategory = {\n  title: 'Gender',\n  tags: [\n    'male',\n    'female'\n  ]\n};\n\n// export const tagsBiodigital: TagCategory = {\n//   title: 'BioDigital',\n//   tags: [\n//     'condition',\n//     'anatomy',\n//     'system',\n//     'regional',\n//   ]\n// };\n\nexport const tagsTypes: TagCategory = {\n  title: 'Type',\n  tags: [\n    'Anatomy',\n    'Disease',\n    'Physiology',\n    'Procedure'\n  ]\n};\n\nexport const tagsLevelOfDetail: TagCategory = {\n  title: 'Level of Detail',\n  tags: [\n    'Gross Anatomy',\n    'Tissue',\n    'Cellular',\n    'Molecular'\n  ]\n};\n\nexport const tagsAnatomyCategories: TagCategory = {\n  title: 'Anatomy Categories',\n  tags: [\n    'complete anatomy',\n    'system',\n    'regional',\n    'Cross Section',\n    'Micro Anatomy',\n    'Cross Section and Micro Anatomy'\n  ]\n};\n\n\nexport const tagsClinicalSpecialty: TagCategory = {\n  title: 'Clinical Specialty',\n  tags: [\n    'Allergy and Immunology',\n    'Cardiology',\n    'Dentistry',\n    'Dermatology',\n    'Endocrinology',\n    'Gastroenterology and Hepatology',\n    'Infectious Disease',\n    'Nephrology',\n    'Neurology and Psychiatry',\n    'Obstetrics and Gynecology',\n    'Oncology and Hematology',\n    'Ophthalmology',\n    'Orthopedics',\n    'Otolaryngology',\n    'Pediatrics',\n    'Pulmonology and Respiratory',\n    'Rheumatology',\n    'Urology'\n  ]\n};\n\nexport const tagsHealthConditions: TagCategory = {\n  title: 'Health Conditions',\n  tags: [\n    'Blood, Heart and Circulation',\n    'Brain and Nerves',\n    'Ear, Nose and Throat',\n    'Eyes and Vision',\n    'Immune System',\n    'Lungs and Breathing',\n    'Mouth and Teeth',\n    'Bones, Joints and Muscles',\n    'Digestive System',\n    'Endocrine System',\n    'Female Reproductive System',\n    'Male Reproductive System',\n    'Skin, Hair and Nail'\n  ]\n};\n\n\n\n\nexport const tagCategories: TagCategory[] = [\n  tagsStatus,\n  tagsPaywall,\n  tagsPlatform,\n  tagsFlags,\n  tagsGender,\n  tagsTypes,\n  tagsLevelOfDetail,\n  tagsAnatomyCategories,\n  tagsClinicalSpecialty,\n  tagsHealthConditions\n];\n","import { BookmarkModel } from './bookmark.model';\n\nexport class BookmarkActionEvent {\n    name: BookmarkAction;\n    id: string;\n    bookmark: BookmarkModel;\n}\n\nexport enum BookmarkAction {\n    View = 'View',\n    Edit = 'Customize in Studio',\n    Manage = 'Manage',\n    Publish = 'Publish',\n    Delete = 'Delete',\n    CopyURL = 'Copy URL',\n    AddToMyModels = 'Add to My Models',\n    AddToTeamModels = 'Add to Team Models',\n    Divider = '',\n}\n","import { BookmarkModel } from './bookmark.model';\nimport { isNil } from 'lodash';\n\nexport abstract class SortModel<T> {\n    label: string;\n    fields: (keyof T)[];\n    ascending: boolean;\n}\n\nexport class BookmarkSortModel extends SortModel<BookmarkModel> {\n}\n\nexport function getModelValue<T>(model: T, fieldNames: (keyof T)[], fieldValueAscending: boolean): T[keyof T] {\n    const values = fieldNames\n        // get field value\n        .map((field) => model[field])\n        // trim nil values: undefined | null\n        .filter((value) => !isNil(value));\n\n    if (fieldValueAscending) { // ascending: get first value\n        return values\n            .sort()\n            .shift();\n    } else { // descending: get last value\n        return values\n            .sort()\n            .pop();\n    }\n}\n\nexport function sortModels<T>(models: T[], fieldNames: (keyof T)[], ascending: boolean): T[] {\n    if (fieldNames.length === 0) {\n        return models;\n    }\n\n    const collator = new Intl.Collator('en-US', { sensitivity: 'base' });\n\n    return models.sort((a, b) => {\n        const aValue = getModelValue(a, fieldNames, ascending) || '';\n        const bValue = getModelValue(b, fieldNames, ascending) || '';\n\n        return ((ascending) ? 1 : -1) * collator.compare(aValue.toString(), bValue.toString());\n    });\n}\n\n","import { BookmarkGroupModel } from './bookmark.group.model';\nimport { CollectionModel } from 'src/app/organizations/models/collection.model';\nimport { StoryModel } from 'src/app/story/models/story.model';\n\nexport class BookmarkEntryModel {\n  isOwner: boolean;\n  id?: string;\n  title?: string;\n  description?: string;\n  public_access?: boolean;\n  add_group_access?: BookmarkGroupModel[];\n  remove_group_access?: BookmarkGroupModel[];\n  index?: StoryModel;\n  collection?: CollectionModel;\n  \n  addCollection?: CollectionModel;\n  removeCollection?: CollectionModel;\n}\n","export class BookmarkGroupModel {\n    group_id: number;\n    group_name?: string;\n    member_edit?: boolean;\n    visible?: boolean;\n    remove?: boolean;\n}\n","import { Type } from 'class-transformer';\nimport { BookmarkGroupModel } from './bookmark.group.model';\nimport { ContentType } from 'src/app/story/models/content-type.enum';\n\nexport class BookmarkModel {\n\n  // Content\n  id: string;\n  type: ContentType = ContentType.Bookmark;\n  sex: string;\n  module_name?: string;\n\n  // Metadata\n  title: string;\n  description: string;\n  tags: string[];\n  animated?: boolean;\n  featured?: boolean;\n  tour?: boolean;\n\n  // Author\n  author: string;\n  author_first_name?: string;\n  author_last_name?: string;\n\n  // Audit\n  create_date_time: Date;\n  update_date_time?: Date;\n  last_editor?: string;\n  last_editor_first_name?: string;\n  last_editor_last_name?: string;\n\n  // Permissions\n  @Type(() => BookmarkGroupModel)\n  group_access?: BookmarkGroupModel[];\n  is_owner?: false;\n\n  // Cost  \n  cost?: number;\n  premium?: boolean;\n  \n  // Embeds\n  embed_url: string;\n  embed_url_path: string;\n  embedded: any;\n\n  // Share\n  share: any;\n  share_url: string;\n\n  // favorites\n  favorite = false;\n\n  // Images\n  icon: null;\n  thumbnail_url: string;\n  hires_img_url?: string;\n  rotatable_url?: string;\n\n  // Stream\n  stream: any;\n  stream_url: string;\n\n  // legacy/orphaned content\n  unavailable = false;\n\n  // Collections\n  collection_content?: boolean;\n  collection_content_id?: number;\n  collection_content_createdate?: string;\n\n  // module accessibility: custom user \"modules\"\n  module_accessor_id?: number;\n  module_accessor_level?: 'user' | 'group';\n  module_accessor_title?: string;\n\n}\n","import { BookmarkModel } from '../models/bookmark.model';\nimport { BookmarkEntryModel } from '../models/bookmark.entry.model';\nimport { StoryChapterThumbnail } from 'src/app/story/models/story-chapter-thumbnail.model';\nimport { BookmarkSortModel } from '../models/bookmark-sort.model';\nimport { WidgetOptions } from 'src/app/publish/models/widget-options.model';\nimport { CollectionModel } from 'src/app/organizations/models/collection.model';\nimport { ContentType } from 'src/app/story/models/content-type.enum';\nimport { HttpErrorResponse } from '@angular/common/http';\nimport { StoryModel } from 'src/app/story/models/story.model';\nimport { BookmarkGroupModel } from '../models/bookmark.group.model';\nimport { UserAppModel } from 'src/app/auth/models/user-app.model';\nimport { defaultLocale } from 'src/app/locale-config.module';\n\nexport class LoadBookmarks {\n  static readonly type = '[Bookmarks] Load';\n  constructor(public query: string) { }\n}\n\nexport class LoadOrganizationBookmarks {\n  static readonly type = '[Bookmarks] Load Organization Bookmarks';\n  constructor(public organizationId: number) { }\n}\n\nexport class LoadCollectionBookmarks {\n  static readonly type = '[Bookmarks] Load Collection Bookmarks';\n  constructor(public organizationId: number, public collectionId: number) { }\n}\n\nexport class SelectBookmark {\n  static readonly type = '[Bookmarks] Select Bookmark';\n  constructor(public id: string, public type: ContentType) { }\n}\n\nexport class SelectBookmarkSuccess {\n  static readonly type = '[Bookmarks] Select Bookmark Success';\n  constructor(public bookmark: BookmarkModel) { }\n}\n\nexport class LoadBookmarksSuccess {\n  static readonly type = '[Bookmarks] Load Success';\n  constructor(public result: BookmarkModel[]) { }\n}\n\nexport class DeleteBookmark {\n  static readonly type = '[Bookmarks] Delete Bookmark';\n  constructor(public bookmarkId: string) { }\n}\n\nexport class DeleteBookmarkSuccess {\n  static readonly type = '[Bookmarks] Bookmark Delete Success';\n  constructor(public bookmarkId: string) { }\n}\n\nexport class DeleteBookmarkFail {\n  static readonly type = '[Bookmarks] Bookmark Delete Fail';\n  constructor(public bookmarkId: string, public message: string) { }\n}\n\nexport class SaveBookmark {\n  static readonly type = '[Bookmarks] Save Bookmark';\n  constructor(public bookmarkEntry: BookmarkEntryModel, public inplace: boolean, public includeIndex: boolean = true) { }\n}\n\nexport class SaveBookmarkSuccess {\n  static readonly type = '[Bookmarks] Bookmark Saved';\n  constructor(public bookmark: BookmarkModel, public story: StoryModel, public method: 'save' | 'update') { }\n}\n\nexport class SaveBookmarkFail {\n  static readonly type = '[Bookmarks] Bookmark Save Failed';\n  constructor(public bookmarkEntry: BookmarkEntryModel) { }\n}\n\nexport class DeleteFavorite {\n  static readonly type = '[Bookmarks] Delete Favorite';\n  constructor(public bookmark: BookmarkModel) { }\n}\n\nexport class DeleteFavoriteSuccess {\n  static readonly type = '[Bookmarks] Delete Favorite Success';\n  constructor(public bookmarkId: string) { }\n}\n\nexport class DeleteFavoriteFail {\n  static readonly type = '[Bookmarks] Delete Favorite Failed';\n  constructor(public bookmarkId: string) { }\n}\n\nexport class SaveBookmarkThumbnails {\n  static readonly type = '[Bookmarks] Save Bookmark Thumbnails';\n  constructor(\n    public method: string,\n    public bookmarkId: string, \n    public bookmarkEntry: BookmarkEntryModel, \n    public thumbnails: Map<string, StoryChapterThumbnail>,\n    public chapterIdMap?: {[id: string]: string}\n    ) {}\n}\n\nexport class ResetBookmarks {\n  static readonly type = '[Bookmarks] Reset';\n  constructor() { }\n}\n\nexport class ClearBookmarks {\n  static readonly type = '[Bookmarks] Clear Bookmarks';\n  constructor() { }\n}\n\nexport class SortBookmarks {\n  static readonly type = '[Bookmarks] Sort';\n  constructor(public sort: BookmarkSortModel) { }\n}\n\nexport class CheckBookmark {\n  static readonly type = '[Bookmarks] Check Bookmark';\n  constructor(public id: string, public checked: boolean) { }\n}\n\nexport class SetCheckedBookmarks {\n  static readonly type = '[Bookmarks] Set Checked Bookmarks';\n  constructor(public ids: string[]) { }\n}\n\nexport class ExportBookmarks {\n  static readonly type = '[Bookmarks] Export Bookmarks';\n  constructor(\n    public bookmarks: BookmarkModel[],\n    public widgetURL: string,\n    public userLanguage: string,\n    public userApp: UserAppModel,\n    public widgetOptions?: WidgetOptions,\n    public offlineEnabled?: boolean\n  ) { }\n}\n\nexport class ExportBookmarksSuccess {\n  static readonly type = '[Bookmarks] Export Bookmarks Success';\n  constructor(public bookmarks: BookmarkModel[]) { }\n}\n\nexport class ExportBookmarksError {\n  static readonly type = '[Bookmarks] Export Bookmarks Error';\n  constructor(public bookmarks: BookmarkModel[]) { }\n}\n\nexport class UpdateBookmarkCollection {\n  static readonly type = '[Bookmarks] Update Bookmark Collection';\n  constructor(\n    public bookmark: BookmarkModel,\n    public addCollection?: CollectionModel,\n    public removeCollection?: CollectionModel) { }\n}\n\nexport class UpdateBookmarkCollectionSuccess {\n  static readonly type = '[Bookmarks] Update Bookmark Collection Success';\n  constructor(\n    public bookmark: BookmarkModel,\n    public addCollection?: CollectionModel,\n    public removeCollection?: CollectionModel) { }\n}\n\nexport class UpdateBookmarkCollectionError {\n  static readonly type = '[Bookmarks] Update Bookmark Collection Error';\n  constructor(\n    public bookmark: BookmarkModel,\n    public addCollection?: CollectionModel,\n    public removeCollection?: CollectionModel) { }\n}\n\nexport class AddBookmarkCollection {\n  static readonly type = '[Bookmarks] Add Bookmark Collection';\n  constructor(\n    public bookmark: BookmarkModel,\n    public collection: CollectionModel) { }\n}\n\nexport class AddBookmarkCollectionSuccess {\n  static readonly type = '[Bookmarks] Add Bookmark Collection Success';\n  constructor(\n    public bookmark: BookmarkModel,\n    public collection: CollectionModel) { }\n}\n\nexport class AddBookmarkCollectionError {\n  static readonly type = '[Bookmarks] Add Bookmark Collection Error';\n  constructor(\n    public bookmark: BookmarkModel,\n    public collection: CollectionModel) { }\n}\n\nexport class RemoveBookmarkCollection {\n  static readonly type = '[Bookmarks] Remove Bookmark Collection';\n  constructor(\n    public bookmark: BookmarkModel,\n    public collection: CollectionModel\n  ) { }\n}\n\nexport class RemoveBookmarkCollectionSuccess {\n  static readonly type = '[Bookmarks] Remove Bookmark Collection Success';\n  constructor(\n    public bookmark: BookmarkModel,\n    public collection: CollectionModel) { }\n}\n\nexport class RemoveBookmarkCollectionError {\n  static readonly type = '[Bookmarks] Remove Bookmark Collection Error';\n  constructor(\n    public bookmark: BookmarkModel,\n    public collection: CollectionModel) { }\n}\n\nexport class CopyBookmark {\n  static readonly type = '[Bookmarks] Copy Bookmark';\n  constructor(\n    public id: string,\n    public type: ContentType,\n    public lang = defaultLocale.lang,\n    public groupAccess?: BookmarkGroupModel,\n    public collection?: CollectionModel) { }\n}\n\nexport class CopyBookmarkSuccess {\n  static readonly type = '[Bookmarks] Copy Bookmark Success';\n  constructor(\n    public newId: string,\n    public sourceId: string,\n    public groupAccess?: BookmarkGroupModel,\n    public collection?: CollectionModel) { }\n}\nexport class CopyBookmarkFailure {\n  static readonly type = '[Bookmarks] Copy Bookmark Failure';\n  constructor(public id: string, public error: HttpErrorResponse) { }\n}\n\nexport class SetBookmarkText {\n  static readonly type = '[Bookmarks] Set Bookmark Text';\n  constructor(public title: string) {}\n}\n\nexport class SetSelectedCategory {\n  static readonly type = '[Bookmarks] Set Selected Category';\n  constructor(public category: 'individual' | 'organization' | 'collection') { }\n}\n","import { BookmarkModel } from '../models/bookmark.model';\nimport { BookmarkSortModel } from '../models/bookmark-sort.model';\nimport { GalleryViewMode } from 'src/app/gallery/models/gallery-view-mode.enum';\n\nexport class BookmarksStateModel {\n    loading: boolean;\n    exporting: boolean;\n    copying: boolean;\n    saving: boolean;\n    bookmarks: BookmarkModel[];\n    selectedBookmark?: BookmarkModel;\n    sort: BookmarkSortModel;\n    checkedBookmarks: string[];\n    selectedCategory?: 'individual' | 'organization' | 'collection';\n}\n","import { State, Action, StateContext, Selector, Store } from '@ngxs/store';\nimport { BookmarksStateModel } from './bookmarks.state.model';\nimport {\n  LoadBookmarks,\n  LoadBookmarksSuccess,\n  LoadOrganizationBookmarks,\n  DeleteBookmark,\n  DeleteBookmarkSuccess,\n  SaveBookmark,\n  SaveBookmarkSuccess,\n  SelectBookmark,\n  SelectBookmarkSuccess,\n  SaveBookmarkFail,\n  SaveBookmarkThumbnails,\n  ResetBookmarks,\n  SortBookmarks,\n  CheckBookmark,\n  SetCheckedBookmarks,\n  ExportBookmarks,\n  ExportBookmarksSuccess,\n  ExportBookmarksError,\n  LoadCollectionBookmarks,\n  DeleteBookmarkFail,\n  DeleteFavorite,\n  DeleteFavoriteSuccess,\n  DeleteFavoriteFail,\n  CopyBookmark,\n  CopyBookmarkFailure,\n  CopyBookmarkSuccess,\n  SetBookmarkText,\n  SetSelectedCategory,\n  ClearBookmarks,\n  UpdateBookmarkCollection,\n  UpdateBookmarkCollectionSuccess,\n  UpdateBookmarkCollectionError,\n  RemoveBookmarkCollectionSuccess,\n  AddBookmarkCollectionSuccess,\n  RemoveBookmarkCollectionError,\n  AddBookmarkCollectionError\n} from './bookmarks.actions';\n\nimport { finalize, flatMap, filter, tap } from 'rxjs/operators';\nimport { BookmarksService } from '../bookmarks.service';\nimport { StoryChaptersState } from 'src/app/story/state/chapters/story.chapters.state';\nimport { concat, forkJoin } from 'rxjs';\nimport { RegisterChapterThumbnails } from 'src/app/story/state/chapters/story.chapters.actions';\nimport { bookmarkSortRecent } from '../data/bookmark-sort';\nimport { PublishService } from 'src/app/publish/publish.service';\nimport { WidgetOptions } from 'src/app/publish/models/widget-options.model';\nimport { OrganizationsService } from 'src/app/organizations/organizations.service';\nimport { CollectionContentModel } from 'src/app/organizations/models/collection.content.model';\nimport { ExploreService } from 'src/app/explore/explore.service';\nimport { StoryModel } from 'src/app/story/models/story.model';\nimport { get, invert, mapKeys } from 'lodash';\nimport { sortModels } from '../models/bookmark-sort.model';\nimport { ChapterUtils } from 'src/app/shared/chapter-utils';\nimport { ParticleActions } from 'src/app/engine/state/particles/particles.actions';\nimport { MatSnackBar } from '@angular/material';\nimport { DialogActions } from 'src/app/dialogs/state/dialog.actions';\nimport { BookmarkEntryModel } from '../models/bookmark.entry.model';\nimport { StoryService } from 'src/app/story/story.service';\nimport { ContentType } from 'src/app/story/models/content-type.enum';\n\nconst BookmarksStateDefaults = {\n  loading: true,\n  exporting: false,\n  copying: false,\n  saving: false,\n  bookmarks: [],\n  selectedBookmark: null,\n  sort: bookmarkSortRecent,\n  checkedBookmarks: [],\n  selectedCategory: null\n};\n\n@State<BookmarksStateModel>({\n  name: 'bookmarks',\n  defaults: BookmarksStateDefaults\n})\nexport class BookmarksState {\n  @Selector()\n  static getBookmarks(state: BookmarksStateModel) {\n    const { bookmarks, sort } = state;\n    const { ascending, fields } = sort;\n    return sortModels(bookmarks, fields, ascending);\n  }\n\n  @Selector()\n  static getCheckedBookmarks(state: BookmarksStateModel) {\n    return state.checkedBookmarks;\n  }\n\n  @Selector()\n  static getSelectedBookmark(state: BookmarksStateModel) {\n    return state.selectedBookmark;\n  }\n\n  @Selector()\n  static getLoading(state: BookmarksStateModel) {\n    return state.loading;\n  }\n\n  @Selector()\n  static getExporting(state: BookmarksStateModel) {\n    return state.exporting;\n  }\n\n  @Selector()\n  static getSaving(state: BookmarksStateModel) {\n    return state.saving;\n  }\n\n  @Selector()\n  static getCopying(state: BookmarksStateModel) {\n    return state.copying;\n  }\n\n  @Selector()\n  static getSort(state: BookmarksStateModel) {\n    return state.sort;\n  }\n\n  @Selector()\n  static getSelectedCategory(state: BookmarksStateModel) {\n    return state.selectedCategory;\n  }\n\n  @Action(LoadBookmarks)\n  loadBookmarks(context: StateContext<BookmarksStateModel>, action: LoadBookmarks) {\n    context.patchState({\n      loading: true,\n      bookmarks: [],\n      checkedBookmarks: []\n    });\n\n    // load private content (private bookmarks, custom modules, and favorites)\n    forkJoin(\n      this.bookmarksService.getPrivateBookmarks(action.query),\n      this.bookmarksService.getPrivateConditions(action.query),\n      this.bookmarksService.getFavorites()\n    )\n      .pipe(\n        finalize(() => { context.patchState({ loading: false }); })\n      )\n      .subscribe(([bookmarks, conditions, favorites]) => {\n        context.dispatch(new LoadBookmarksSuccess([\n          ...bookmarks,\n          ...conditions,\n          ...favorites\n        ]));\n      });\n  }\n\n\n  @Action(LoadOrganizationBookmarks)\n  loadOrganizationBookmarks(context: StateContext<BookmarksStateModel>, { organizationId }: LoadOrganizationBookmarks) {\n    context.patchState({\n      loading: true,\n      bookmarks: [],\n      checkedBookmarks: []\n    });\n\n    // load group content (private bookmarks and custom modules)\n    this.bookmarksService.getOrganizationContent(organizationId)\n      .pipe(\n        finalize(() => { context.patchState({ loading: false }); })\n      )\n      .subscribe((bookmarks) => {\n        context.dispatch(new LoadBookmarksSuccess(bookmarks));\n      });\n  }\n\n  @Action(LoadCollectionBookmarks)\n  loadCollectionBookmarks(context: StateContext<BookmarksStateModel>, action: LoadCollectionBookmarks) {\n    context.patchState({\n      loading: true,\n      bookmarks: [],\n      checkedBookmarks: []\n    });\n\n    this.organizationsService.getCollectionContent(action.organizationId, action.collectionId)\n      .pipe(\n        finalize(() => { context.patchState({ loading: false }); })\n      )\n      .subscribe((result) => {\n        context.dispatch(new LoadBookmarksSuccess(result));\n      });\n  }\n\n  @Action(LoadBookmarksSuccess)\n  loadSuccess({ patchState }: StateContext<BookmarksStateModel>, action: LoadBookmarksSuccess) {\n    patchState({\n      bookmarks: action.result\n    });\n  }\n\n  @Action(SelectBookmark)\n  loadBookmark(context: StateContext<BookmarksStateModel>, action: SelectBookmark) {\n    const { id, type } = action;\n\n    const bookmark$ = type === 'bookmark'\n      ? this.bookmarksService.getBookmarkModel(id)\n      : this.exploreService.getConditionModel(id);\n\n    bookmark$\n      .subscribe((bookmark) => {\n        context.dispatch(new SelectBookmarkSuccess(bookmark));\n      });\n  }\n\n  @Action(SelectBookmarkSuccess)\n  selectBookmarkSuccess(context: StateContext<BookmarksStateModel>, action: SelectBookmarkSuccess) {\n    context.patchState({\n      selectedBookmark: action.bookmark\n    });\n  }\n\n  // Replace existing or Save new bookmark\n  @Action(SaveBookmark)\n  async saveBookmark(context: StateContext<BookmarksStateModel>, action: SaveBookmark) {\n    const bookmarkEntry = action.bookmarkEntry;\n\n    // begin save\n    context.patchState({ saving: true });\n\n    // requires story\n    let serialized: { story: StoryModel };\n\n    const chapters = this.store.selectSnapshot(StoryChaptersState.getStoryChapters);\n    const makeNewChapterIds = action.inplace === false;\n    const chapterIdMap = ChapterUtils.makeChapterIdMap(chapters, makeNewChapterIds);\n\n    if (makeNewChapterIds) {\n      await this.store.dispatch(new ParticleActions.UpdateTweenParticleLookupChapters(chapterIdMap)).toPromise();\n    }\n\n    if (action.includeIndex) {\n      serialized = this.bookmarksService.createBookmarkStory(chapterIdMap); // Just a serialized module\n      bookmarkEntry.index = serialized.story;\n    }\n\n    const method = bookmarkEntry.id ? 'update' : 'save';\n\n    this.bookmarksService.saveBookmark(bookmarkEntry)\n      .pipe(\n        finalize(() => { // end save\n          context.patchState({ saving: false });\n        })\n      )\n      .subscribe(\n        (bookmark) => {\n          // save thumbnails\n          if (action.includeIndex) {\n            const thumbnails = this.store.selectSnapshot(StoryChaptersState.getRegisteredThumbnails);\n            context.dispatch(\n              new SaveBookmarkThumbnails(\n                method,\n                bookmark.id,\n                bookmarkEntry,\n                thumbnails,\n                invert(chapterIdMap)\n              )\n            );\n          }\n          // add/remove collections\n          if (bookmarkEntry.addCollection || bookmarkEntry.removeCollection) {\n            context.dispatch(new UpdateBookmarkCollection(bookmark, bookmarkEntry.addCollection, bookmarkEntry.removeCollection));\n          }\n\n          const story: StoryModel = serialized ? serialized.story : null;\n          context.dispatch(new SaveBookmarkSuccess(bookmark, story, method));\n        },\n        (err) => {\n          context.dispatch(new SaveBookmarkFail(bookmarkEntry));\n        });\n  }\n\n  @Action(SaveBookmarkSuccess)\n  saveBookmarkSuccess(context: StateContext<BookmarksStateModel>, action: SaveBookmarkSuccess) {\n    const savedBookmark = action.bookmark;\n    const bookmarks = context.getState().bookmarks;\n\n    // patch bookmark entry\n    const savedBookmarkIndex = bookmarks.findIndex(bookmark => bookmark.id === savedBookmark.id);\n    if (savedBookmarkIndex !== -1) {\n      bookmarks[savedBookmarkIndex] = savedBookmark;\n      context.patchState({\n        bookmarks: [...bookmarks]\n      });\n    }\n\n    // update selected bookmar if replacing (save)\n    if (action.method === 'save') {\n      context.patchState({\n        selectedBookmark: action.bookmark\n      });\n    }\n  }\n\n\n  @Action(DeleteBookmark)\n  deleteBookmark(context: StateContext<BookmarksStateModel>, action: DeleteBookmark) {\n    const bookmarkId = action.bookmarkId;\n\n    this.bookmarksService.deleteBookmark(bookmarkId)\n      .subscribe(\n        () => {\n          context.dispatch(new DeleteBookmarkSuccess(bookmarkId));\n        },\n        (message) => {\n          context.dispatch(new DeleteBookmarkFail(bookmarkId, message));\n        });\n  }\n\n  @Action(DeleteBookmarkSuccess)\n  deleteBookmarkSuccess(context: StateContext<BookmarksStateModel>, action: DeleteBookmarkSuccess) {\n    const bookmarks = context.getState().bookmarks\n      .filter(bookmark => bookmark.id !== action.bookmarkId);\n\n    context.patchState({\n      bookmarks: [...bookmarks]\n    });\n\n    this.snackbar.open('Successfully deleted 3D model');\n  }\n\n  @Action([DeleteBookmarkFail, DeleteFavoriteFail])\n  deleteFail(context: StateContext<BookmarksStateModel>, action: DeleteBookmarkFail | DeleteFavoriteFail) {\n    this.snackbar.open('There was an error deleting the 3D model');\n  }\n\n  @Action(DeleteFavorite)\n  deleteFavorite(context: StateContext<BookmarksStateModel>, action: DeleteFavorite) {\n    const bookmark = action.bookmark;\n    const bookmarkId = bookmark.id;\n\n    // category normalization: 'condition' | 'anatomy' | 'bookmark'\n    const contentType = get(bookmark, 'category', 'bookmark');\n    // id normalization\n    const contentId = contentType === 'bookmark' ? bookmarkId : this.exploreService.toDatabaseContentId(bookmarkId);\n\n    this.bookmarksService.deleteFavorite(contentId, contentType)\n      .subscribe(\n        () => {\n          context.dispatch(new DeleteFavoriteSuccess(bookmarkId));\n        },\n        (err) => {\n          context.dispatch(new DeleteFavoriteFail(bookmarkId));\n        });\n  }\n\n  @Action(DeleteFavoriteSuccess)\n  deleteFavoriteSuccess(context: StateContext<BookmarksStateModel>, action: DeleteFavoriteSuccess) {\n    const bookmarks = context.getState().bookmarks\n      .filter(bookmark => bookmark.id !== action.bookmarkId);\n\n    context.patchState({\n      bookmarks: [...bookmarks]\n    });\n\n    this.snackbar.open('Successfully deleted 3D model');\n  }\n\n  @Action(SortBookmarks)\n  sortBookmarks(context: StateContext<BookmarksStateModel>, action: SortBookmarks) {\n    const bookmarks = context.getState().bookmarks;\n\n    context.patchState({\n      sort: action.sort,\n      bookmarks: [...bookmarks]\n    });\n  }\n\n  @Action(ClearBookmarks)\n  clearBookmarks(context: StateContext<BookmarksStateModel>, action: ClearBookmarks) {\n    context.patchState({\n      bookmarks: [],\n      checkedBookmarks: []\n    });\n  }\n\n  @Action(ResetBookmarks)\n  resetBookmarks(context: StateContext<BookmarksStateModel>, action: ResetBookmarks) {\n    context.setState(BookmarksStateDefaults);\n  }\n\n  @Action(CheckBookmark)\n  checkBookmark(context: StateContext<BookmarksStateModel>, action: CheckBookmark) {\n    let checkedBookmarks = context.getState().checkedBookmarks;\n    const exists = checkedBookmarks.some(bookmark => bookmark === action.id);\n\n    if (action.checked && !exists) {\n      checkedBookmarks = [...checkedBookmarks, action.id];\n    } else if (!action.checked) {\n      checkedBookmarks = checkedBookmarks.filter(bookmark => bookmark !== action.id);\n    }\n\n    context.patchState({\n      checkedBookmarks: checkedBookmarks\n    });\n  }\n\n  @Action(SetCheckedBookmarks)\n  setCheckedBookmarks(context: StateContext<BookmarksStateModel>, action: SetCheckedBookmarks) {\n    context.patchState({\n      checkedBookmarks: action.ids\n    });\n  }\n\n  @Action(SaveBookmarkThumbnails)\n  saveBookmarkThumbnails(context: StateContext<BookmarksStateModel>, action: SaveBookmarkThumbnails) {\n    // chapter id mapping (new bookmark chapters have new ids)\n    const chapterIdMap = action.chapterIdMap;\n\n    // thumbnail urls on server are identified by story-id and chapter-id.\n    const thumbnails = action.thumbnails;\n\n    // replace/create thumbnails\n    const requests$ = this.bookmarksService.saveBookmarkThumbnails(action.bookmarkId, action.bookmarkEntry, thumbnails, chapterIdMap);\n\n    // conditionally delete thumbnails\n    if (action.method === 'update') {\n      // Delete extra thumbnails. We are saving over an existing bookmark\n      const deleteRequests$ = this.bookmarksService.deleteBookmarkThumbnails(action.bookmarkId, action.bookmarkEntry, thumbnails, chapterIdMap);\n      for (const deleteRequest$ of deleteRequests$) {\n        requests$.push(deleteRequest$);\n      }\n    }\n\n    forkJoin(requests$).subscribe((results) => {\n      // On save success, the application will attempt to retrieve server thumbnails. \n      // The server has an unpredictable timeline for flushing the cache, so to predictably serve the user\n      // the thumbnails they create, we instead serve the thumbnails from memory.\n      context.dispatch(new RegisterChapterThumbnails(new Map()))\n        .subscribe(() => {\n          context.dispatch(new RegisterChapterThumbnails(action.thumbnails));\n        });\n    });\n  }\n\n  @Action(ExportBookmarks)\n  exportBookmarks(context: StateContext<BookmarksStateModel>, action: ExportBookmarks) {   \n    const { bookmarks, widgetURL, widgetOptions, offlineEnabled } = action;\n    const exportWidgetOptions = widgetOptions || new WidgetOptions();\n\n    context.patchState({ exporting: true });\n\n    this.publishService.exportModels(bookmarks, widgetURL, exportWidgetOptions, null, action.userLanguage, action.userApp, offlineEnabled)\n      .pipe(\n        finalize(() => {\n          context.patchState({ exporting: false });\n        })\n      )\n      .subscribe((success) => {\n        if (success) {\n          context.dispatch(new ExportBookmarksSuccess(bookmarks));\n        } else {\n          context.dispatch(new ExportBookmarksError(bookmarks));\n        }\n      });\n  }\n\n  @Action(UpdateBookmarkCollection)\n  updateBookmarkCollection(context: StateContext<BookmarksStateModel>, action: UpdateBookmarkCollection) {\n    const { bookmark, addCollection, removeCollection } = action;\n    const collectionContent: CollectionContentModel = {\n      content_type: bookmark.type,\n      content_id: bookmark.id\n    };\n\n    const operations$ = [];\n\n    // #TODO[AC]: service updates to tidy app side bulk updates\n\n    // important: removal need before adding, if applicable\n    if (removeCollection) {\n      operations$.push(\n        // get bookmark's collection content id\n        this.organizationsService.getCollectionContentId(removeCollection, collectionContent)\n          .pipe(\n            // validate id\n            filter((collectionContentId) => !!collectionContentId),\n            // remove bookmark via collection content id\n            flatMap((collectionContentId) => this.organizationsService.removeFromCollection(removeCollection, [collectionContentId])),\n            tap(\n              () => context.dispatch(new RemoveBookmarkCollectionSuccess(bookmark, removeCollection)),\n              () => context.dispatch(new RemoveBookmarkCollectionError(bookmark, removeCollection))\n            )\n          )\n      );\n    }\n\n    // optionally: add to collection\n    if (addCollection) {\n      operations$.push(\n        // add content to specified collection\n        this.organizationsService.addToCollection(addCollection, [collectionContent])\n          .pipe(\n            tap(\n              () => context.dispatch(new AddBookmarkCollectionSuccess(bookmark, removeCollection)),\n              () => context.dispatch(new AddBookmarkCollectionError(bookmark, removeCollection))\n            )\n          )\n      );\n    }\n\n    // execute operations\n    concat(\n      ...operations$\n    )\n      .subscribe(\n        () => context.dispatch(new UpdateBookmarkCollectionSuccess(bookmark, addCollection, removeCollection)),\n        () => context.dispatch(new UpdateBookmarkCollectionError(bookmark, addCollection, removeCollection))\n      );\n  }\n\n  @Action(RemoveBookmarkCollectionSuccess)\n  removeBookmarkCollectionSuccess(context: StateContext<BookmarksStateModel>, action: RemoveBookmarkCollectionSuccess) {\n    const { bookmarks, selectedCategory } = context.getState();\n\n    // if current state bookmarks are from collection data: update list\n    if (selectedCategory === 'collection') {\n      const bookmarkId = action.bookmark.id;\n      const patchBookmarks = bookmarks\n        .filter(bookmark => bookmark.id !== bookmarkId);\n\n      context.patchState({\n        bookmarks: [...patchBookmarks]\n      });\n    }\n  }\n\n  @Action(CopyBookmark)\n  async copyBookmark(context: StateContext<BookmarksStateModel>, action: CopyBookmark) {\n    const { groupAccess, collection } = action;\n\n    context.patchState({ copying: true });\n\n    // 1 --- Copy bookmark ---\n    const id = await this.bookmarksService\n      .copyBookmark(action.id, action.type, action.lang)\n      .toPromise()\n      .catch((err) => {\n        context.dispatch(new CopyBookmarkFailure(action.id, err));\n      });\n\n    if (!id) {\n      return;\n    }\n\n    // 2 --- Save bookmark with group access ---\n    if (groupAccess) {\n      const saveConfig = {\n        isOwner: true,\n        id: id,\n        add_group_access: [groupAccess],\n      };\n      await this.bookmarksService\n        .saveBookmark(saveConfig)\n        .toPromise();\n    }\n\n    // 3 --- Add boomark to collection ---\n    if (groupAccess && collection) {\n      const collectionConfig = [{ content_type: 'bookmark', content_id: id }];\n      await this.organizationsService\n        .addToCollection(collection, collectionConfig)\n        .toPromise();\n    }\n\n\n    // 4 --- Remap the particle system IDs ---\n    const [preSaveJson, postSaveJson] = await Promise.all([\n      this.storyService.getStory(action.id, action.type).toPromise(),\n      this.storyService.getStory(id, ContentType.Bookmark).toPromise(),\n    ]);\n\n    // use the old and new json to map from old chapter Id -> new chapter Id\n    const newChapterIdForOld = preSaveJson.chapters\n      .map((chapter) => chapter.id)\n      .reduce((acc, oldId, currentIndex) => {\n        acc[oldId] = postSaveJson.chapters[currentIndex].id;\n        return acc;\n      }, {});\n\n    // replace the old chapter Ids with the new ones, and patch the lookup.\n    const lookup = mapKeys(\n      postSaveJson.tweenParticleLookup,\n      (value, oldChapterId) => newChapterIdForOld[oldChapterId]\n    );\n    postSaveJson.tweenParticleLookup = lookup;\n\n    // save\n    const entry = new BookmarkEntryModel();\n    entry.id = id;\n    entry.index = postSaveJson;\n    this.bookmarksService.saveBookmark(entry).subscribe(() => {\n      context.patchState({ copying: false });\n      context.dispatch(\n        new CopyBookmarkSuccess(id, action.id, groupAccess, collection)\n      );\n    });\n  }\n\n  @Action(CopyBookmarkSuccess)\n  copyBookmarkSuccess(context: StateContext<BookmarksStateModel>, action: CopyBookmarkSuccess) {\n    const { collection, groupAccess } = action;\n\n    if (collection) { // copied to collection\n      this.snackbar.open(`Successfully added model to the \"${collection.collection_name}\" collection.`);\n    } else if (groupAccess) { // copied to group\n      this.snackbar.open(`Successfully added model to Team Models.`);\n    } else { // default\n      this.snackbar.open(`Successfully added model to My Models`);\n    }\n  }\n\n  @Action(CopyBookmarkFailure)\n  copyBookmarkFailure(context: StateContext<BookmarksStateModel>, action: CopyBookmarkFailure) {\n    const message = get(action.error, 'error.error.message');\n    context.patchState({\n      copying: false\n    });\n    \n    switch (message) {\n      case 'Action forbidden.  Your account content limit has been reached':\n        context.dispatch(new DialogActions.OpenLimit());\n        break;\n      default: \n        this.snackbar.open('There was an error adding to My Models');\n        break;\n    }\n  }\n\n  @Action(SetBookmarkText)\n  setBookmarkText(context: StateContext<BookmarksStateModel>, action: SetBookmarkText) {\n    const selectedBookmark = context.getState().selectedBookmark;\n\n    context.patchState({\n      selectedBookmark: {\n        ...selectedBookmark,\n        title: action.title\n      }\n    });\n  }\n\n  @Action(SetSelectedCategory)\n  setSelectedCategory(context: StateContext<BookmarksStateModel>, { category }: SetSelectedCategory) {\n    context.patchState({\n      selectedCategory: category ? category : null\n    });\n  }\n\n  constructor(\n    private store: Store,\n    private bookmarksService: BookmarksService,\n    private storyService: StoryService,\n    private exploreService: ExploreService,\n    private publishService: PublishService,\n    private organizationsService: OrganizationsService,\n    private snackbar: MatSnackBar\n  ) { }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { BreakpointState } from './state/breakpoint.state';\nimport { NgxsModule } from '@ngxs/store';\n\n\n\n@NgModule({\n  declarations: [],\n  imports: [\n    NgxsModule.forFeature([BreakpointState]),\n    CommonModule\n  ]\n})\nexport class BreakpointModule { }\n","export enum Breakpoint {\n    XSmall,\n    Small,\n    Medium,\n    Large, \n    XLarge\n}\n","import { Breakpoint } from '../models/breakpoint.enum';\r\n\r\nexport namespace BreakpointActions {\r\n  export class SetBreakpoint {\r\n    static readonly type = '[View] Set Breakpoint';\r\n    constructor(public breakpoint: Breakpoint) { }\r\n  }\r\n}\r\n","import { State, Action, StateContext, Selector, NgxsOnInit, Store } from '@ngxs/store';\r\nimport { BreakpointActions } from './breakpoint.actions';\r\nimport { Breakpoint } from '../models/breakpoint.enum';\r\nimport { BreakpointObserver, Breakpoints } from '@angular/cdk/layout';\r\nimport { combineLatest } from 'rxjs';\r\nimport { takeUntil, map, distinctUntilChanged, filter } from 'rxjs/operators';\r\n\r\nexport class BreakpointStateModel {\r\n  public breakpoint: Breakpoint;\r\n}\r\n\r\n@State<BreakpointStateModel>({\r\n  name: 'breakpoint',\r\n  defaults: {\r\n    breakpoint: null\r\n  }\r\n})\r\nexport class BreakpointState implements NgxsOnInit {\r\n  @Selector()\r\n  static getBreakpoint(state: BreakpointStateModel) {\r\n    return state.breakpoint;\r\n  }\r\n\r\n  @Action(BreakpointActions.SetBreakpoint)\r\n  setBreakpoint(context: StateContext<BreakpointStateModel>, action: BreakpointActions.SetBreakpoint) {\r\n    context.patchState({\r\n      breakpoint: action.breakpoint\r\n    });\r\n  }\r\n\r\n  constructor(\r\n    private breakpointObserver: BreakpointObserver,\r\n    private store: Store\r\n  ) { }\r\n\r\n  ngxsOnInit(context: StateContext<BreakpointStateModel>) {\r\n    // < 375\r\n    const xsmall$ = this.breakpointObserver.observe([\r\n      '(max-width: 374px)'\r\n    ]);\r\n\r\n    // < 600\r\n    const small$ = this.breakpointObserver.observe([\r\n      '(max-width: 599px)'\r\n    ]);\r\n\r\n    // < 601 - 959\r\n    const medium$ = this.breakpointObserver.observe([\r\n      '(max-width: 959px)'\r\n    ]);\r\n\r\n    // 960 - 1439\r\n    const large$ = this.breakpointObserver.observe([\r\n      '(max-width: 1439px)'\r\n    ]);\r\n\r\n    // > 1440\r\n    const xlarge$ = this.breakpointObserver.observe([\r\n      '(min-width: 1440px)'\r\n    ]);\r\n\r\n    // Observe all breakpoints\r\n    combineLatest(xsmall$, small$, medium$, large$, xlarge$)\r\n      .pipe(\r\n        map(([xsmall, small, medium, large, xlarge]) => {\r\n          return xsmall.matches ? Breakpoint.XSmall :\r\n            small.matches ? Breakpoint.Small : \r\n            medium.matches ? Breakpoint.Medium : \r\n            large.matches ? Breakpoint.Large : \r\n            xlarge.matches ? Breakpoint.XLarge : \r\n            null;\r\n        }),\r\n        distinctUntilChanged(),\r\n        filter(point => point != null) // Returns 'undefined' when rapidly resizing\r\n      ).subscribe((breakpoint: Breakpoint) => {\r\n        context.dispatch(new BreakpointActions.SetBreakpoint(breakpoint));\r\n      });\r\n  }\r\n}\r\n","<div class=\"content-block\" [ngSwitch]=\"contentBlock.type\">\n  <app-markdown-block\n    *ngSwitchCase=\"'markdown'\" \n    [markdownBlock]=\"contentBlock\"\n    [layout]=\"layout\">\n  </app-markdown-block>\n\n  <app-images-block\n    *ngSwitchCase=\"'images'\"\n    [imagesBlock]=\"contentBlock\"\n    [layout]=\"layout\">\n  </app-images-block>\n</div>","import { ChangeDetectionStrategy, Component, Input, OnInit, ViewEncapsulation } from '@angular/core';\nimport { ContentBlock } from '../../models/content-block';\nimport { ContentBlockLayout, IContentBlockControl } from '../../models/content-block-control';\n\n@Component({\n  selector: 'app-content-block',\n  templateUrl: './content-block.component.html',\n  styleUrls: ['./content-block.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None\n})\nexport class ContentBlockComponent implements OnInit, IContentBlockControl {\n\n  @Input()\n  contentBlock: ContentBlock;\n\n  @Input()\n  layout = ContentBlockLayout.Normal;\n\n  constructor() { }\n\n  ngOnInit() {\n  }\n\n}\n","<div class=\"app-content-blocks\">\n\n    <div\n        *ngFor=\"let contentBlock of contentBlocks; let index = index\"\n         [class.mt-2]=\"index > 0\">\n\n        <app-content-block [contentBlock]=\"contentBlock\" [layout]=\"layout\">            \n        </app-content-block>\n        \n    </div>\n\n</div>","import { ChangeDetectionStrategy, Component, Input, OnInit, ViewEncapsulation } from '@angular/core';\nimport { ContentBlock } from 'src/app/content-blocks/models/content-block';\nimport { ContentBlockLayout, IContentBlockControl } from '../../models/content-block-control';\n\n@Component({\n  selector: 'app-content-blocks',\n  templateUrl: './content-blocks.component.html',\n  styleUrls: ['./content-blocks.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None\n})\nexport class ViewContentBlocksComponent implements OnInit, IContentBlockControl {\n\n  @Input()\n  contentBlocks: ContentBlock[];\n\n  @Input()\n  layout = ContentBlockLayout.Normal;\n\n  constructor() { }\n\n  ngOnInit() {\n  }\n\n}\n","<div class=\"images-block\" [class.images-block--slideshow]=\"images && images.length > 1\">\n\n  <div class=\"images-block__content\">\n\n    <div class=\"images-block__image-container\">\n      <app-image-view\n        [src]=\"currentImage.urls.small\"\n        [fullscreenSrc]=\"currentImage.urls.default\"\n        [alt]=\"currentImage.alt\"\n        class=\"images-block__image-view\"\n        [fit]=\"fit\"\n        [fitSize]=\"fitSize\">\n      </app-image-view>\n    </div>\n\n    <app-html\n      class=\"images-block__caption\"\n      *ngIf=\"currentImage.caption\" \n      [markdownText]=\"currentImage.caption\">\n    </app-html>\n\n    <div class=\"images-block__actions\" *ngIf=\"hasImages()\">\n      <button\n        gaEvent\n        gaAction=\"Clicked Previous Image\"\n        app-pin-button\n        icon=\"chevron-left\"\n        size=\"small\"\n        buttonType=\"ghost\" \n        matTooltip=\"Previous Image\"\n        (click)=\"handlePrevClick()\">\n      </button>\n\n      <button\n        gaEvent\n        gaAction=\"Clicked Next Image\"\n        app-pin-button\n        icon=\"chevron-right\"\n        size=\"small\"\n        buttonType=\"ghost\" \n        matTooltip=\"Next Image\"\n        (click)=\"handleNextClick()\">\n      </button>\n    </div>\n\n  </div>\n\n</div>","import { ChangeDetectionStrategy, Component, Input, OnInit, ViewEncapsulation } from '@angular/core';\nimport { ImageBlock, ImagesBlock } from '../../models/images-block';\nimport { ContentBlockLayout, IContentBlockControl } from '../../models/content-block-control';\n\nconst compactImageSize = 100;\n\n@Component({\n  selector: 'app-images-block',\n  templateUrl: './images-block.component.html',\n  styleUrls: ['./images-block.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None\n})\nexport class ImagesBlockComponent implements OnInit, IContentBlockControl {\n\n  @Input()\n  imagesBlock: ImagesBlock;\n\n  @Input()\n  layout = ContentBlockLayout.Normal;\n\n  images: ImageBlock[];\n  currentImage: ImageBlock;\n\n  get fit(): 'normal' | 'auto' {\n    return this.layout === 'compact' ? 'auto' : 'normal';\n  }\n\n  get fitSize(): number {\n    return this.layout === 'compact' ? compactImageSize : undefined;\n  }\n\n  constructor() { }\n\n  ngOnInit() {\n    this.images = this.imagesBlock.images;\n    this.currentImage = this.images[0];\n  }\n\n  handlePrevClick() {\n    let currentImageIndex = this.getCurrentImageIndex();\n    currentImageIndex--;\n\n    if (currentImageIndex < 0) {\n      currentImageIndex = this.images.length - 1;\n    }\n\n    this.currentImage = this.images[currentImageIndex];\n  }\n\n  handleNextClick() {\n    let currentImageIndex = this.getCurrentImageIndex();\n    currentImageIndex++;\n\n    if (currentImageIndex >= this.images.length) {\n      currentImageIndex = 0;\n    }\n\n    this.currentImage = this.images[currentImageIndex];\n  }\n\n  getCurrentImageIndex() {\n    return this.images.indexOf(this.currentImage);\n  }\n\n  hasImages() {\n    return this.images.length > 1;\n  }\n\n}\n","<div class=\"markdown-block\">\n  <app-html [markdownText]=\"markdownBlock.markdown\"></app-html>\n</div>","import { ChangeDetectionStrategy, Component, Input, OnInit, ViewEncapsulation } from '@angular/core';\nimport { MarkdownBlock } from '../../models/markdown-block';\nimport { ContentBlockLayout, IContentBlockControl } from '../../models/content-block-control';\n\n@Component({\n  selector: 'app-markdown-block',\n  templateUrl: './markdown-block.component.html',\n  styleUrls: ['./markdown-block.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None\n})\nexport class MarkdownBlockComponent implements OnInit, IContentBlockControl {\n\n  @Input()\n  markdownBlock: MarkdownBlock;\n\n  @Input()\n  layout = ContentBlockLayout.Normal;\n\n  constructor() { }\n\n  ngOnInit() {\n  }\n\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { MarkdownBlockComponent } from './components/markdown-block/markdown-block.component';\nimport { SharedModule } from '../shared/shared.module';\nimport { ContentBlockComponent } from './components/content-block/content-block.component';\nimport { ImagesBlockComponent } from './components/images-block/images-block.component';\nimport { MaterialModule } from '../material.module';\nimport { MatProgressBarModule } from '@angular/material';\nimport { ViewContentBlocksComponent } from './components/content-blocks/content-blocks.component';\n\n@NgModule({\n  declarations: [\n    MarkdownBlockComponent,\n    ViewContentBlocksComponent,\n    ContentBlockComponent,\n    ImagesBlockComponent\n  ],\n  imports: [\n    CommonModule,\n    SharedModule,\n    MaterialModule,\n    MatProgressBarModule\n  ],\n  exports: [\n    MarkdownBlockComponent,\n    ViewContentBlocksComponent,\n    ContentBlockComponent,\n    ImagesBlockComponent\n  ]\n})\nexport class ContentBlocksModule { }\n","export enum ContentBlockLayout {\n  Normal = 'normal',\n  Compact = 'compact'\n}\n\nexport interface IContentBlockControl {\n  layout: ContentBlockLayout;\n}\n","import { ContentBlockTypes } from './content-block-types';\n\nexport interface ImageUrls {\n  default: string;\n  small?: string;\n  large?: string;\n}\n\nexport class ImageBlock {\n  urls: ImageUrls;\n  alt?: string;\n  caption?: string;\n}\n\nexport class ImagesBlock {\n  type: ContentBlockTypes.Images;\n  images: ImageBlock[];\n}\n","import { ContentBlockTypes } from './content-block-types';\n\nexport class MarkdownBlock {\n  type: ContentBlockTypes.Markdown;\n  markdown: string;\n}\n","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\nimport { ViewPageComponent } from 'src/app/view/pages/view-page/view-page.component';\nimport { WidgetConfigResolver } from 'src/app/widget-auth/widget-config-resolver';\nimport { WidgetMasterComponent } from 'src/app/widget/pages/widget-master/widget-master.component';\nimport { environment } from 'src/environments/environment';\nimport { ErrorComponent } from 'src/app/pages/error/error.component';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: WidgetMasterComponent,\n    resolve: {\n      widgetUrlConfig: WidgetConfigResolver,\n    },\n    children: [\n      {\n        path: '',\n        component: ViewPageComponent,\n      },\n      {\n        path: 'error',\n        component: ErrorComponent\n      }\n    ],\n  }\n];\n\nconst routeImports = environment.offline === true ? RouterModule.forRoot(routes, {useHash: true}) : RouterModule.forRoot(routes);\n\n@NgModule({\n  imports: [routeImports],\n  exports: [RouterModule],\n  providers: [WidgetConfigResolver]\n})\nexport class AppWidgetRoutingModule { }\n","<app-engine [inputEnabled]=\"inputEnabled$ | async\"></app-engine>\n<router-outlet></router-outlet>\n","import { Component, OnInit, ChangeDetectionStrategy, OnDestroy } from '@angular/core';\nimport { WidgetState } from 'src/app/widget-auth/state/widget.state';\nimport { Observable, Subject } from 'rxjs';\nimport { Select, Store } from '@ngxs/store';\nimport { takeUntil, filter } from 'rxjs/operators';\nimport { ViewActions } from 'src/app/view/state/view.actions';\nimport { Router, NavigationEnd } from '@angular/router';\nimport { GoogleAnalyticsService } from 'ngx-google-analytics';\n\n@Component({\n  selector: 'app-root',\n  templateUrl: './app-widget.component.html',\n  styleUrls: ['./app-widget.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class AppWidgetComponent implements OnInit, OnDestroy {\n  @Select(WidgetState.getInputEnabled)\n  inputEnabled$: Observable<boolean>;\n  \n  title = 'Biodigital Human';\n  ngUnsubscribe = new Subject();\n\n  constructor(\n    private store: Store,\n    private router: Router,\n    private ga: GoogleAnalyticsService\n  ) {\n  }\n\n  ngOnInit() {\n    this.initPageAnalytics();\n    this.initInputObserver();\n  }\n\n  ngOnDestroy() {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n  \n  initInputObserver() {\n    this.inputEnabled$.pipe(\n      takeUntil(this.ngUnsubscribe)\n    ).subscribe(enabled => {\n      this.store.dispatch(new ViewActions.SetInputEnabled(enabled));\n    });\n  }\n\n  initPageAnalytics() {\n    // log subsequent in app route changes (i.e., /error)\n    this.router.events\n      .pipe(\n        filter((event) => event instanceof NavigationEnd),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe((event: NavigationEnd) => {\n        const url = event.urlAfterRedirects;\n        this.ga.pageView(url);\n      });\n  }\n}\n","import { BrowserModule } from '@angular/platform-browser';\nimport { BrowserAnimationsModule } from '@angular/platform-browser/animations';\nimport { NgModule, Injectable, ErrorHandler, Inject, InjectionToken } from '@angular/core';\nimport { AppWidgetComponent } from './app-widget.component';\nimport { AppWidgetRoutingModule } from './app-widget-routing.module';\nimport { NgxsModule } from '@ngxs/store';\nimport { LayoutModule } from '../../layout/layout.module';\nimport { HttpClientModule, HTTP_INTERCEPTORS } from '@angular/common/http';\nimport { BookmarksModule } from '../../bookmarks/bookmarks.module';\nimport { EngineModule } from '../../engine/engine.module';\nimport { StoryModule } from '../../story/story.module';\nimport { OrganizationsModule } from '../../organizations/organizations.module';\n\nimport { LocaleConfigModule } from '../../locale-config.module';\nimport { DialogModule } from '../../dialogs/dialog.module';\nimport { ViewModule } from 'src/app/view/view.module';\nimport { ApiInterceptor } from 'src/app/interceptors/api.interceptor';\nimport { WidgetAuthModule } from 'src/app/widget-auth/widget-auth.module';\nimport { WidgetModule } from 'src/app/widget/widget.module';\nimport { NgxsReduxDevtoolsPluginModule } from '@ngxs/devtools-plugin';\nimport { environment } from 'src/environments/environment';\nimport { UrlSerializer } from '@angular/router';\nimport { CustomUrlSerializer } from 'src/app/shared/libraries/url/custom-url-serializer';\nimport { BreakpointModule } from 'src/app/breakpoint/breakpoint.module';\nimport { UndoModule } from 'src/app/undo/undo.module';\nimport { MarkdownConfigModule } from 'src/app/markdown-config.module';\nimport { RollbarErrorHandler, RollbarService, rollbarFactory } from 'src/app/rollbar';\nimport { EnvironmentPlatform } from 'src/environments/models/environment-platform';\nimport { NgxGoogleAnalyticsModule } from 'ngx-google-analytics';\nimport { APP_BASE_HREF, LocationStrategy, HashLocationStrategy } from '@angular/common';\n\ndeclare const immer;\n// enables es5 support, patches, and patchable Maps and Sets\nimmer.enableAllPlugins();\nimmer.enableES5();\n\n// hash location strategy is needed to support offline use\nconst offlineProviders = [\n  { provide: HTTP_INTERCEPTORS, useClass: ApiInterceptor, multi: true },\n  { provide: UrlSerializer, useClass: CustomUrlSerializer },\n  { provide: ErrorHandler, useClass: RollbarErrorHandler },\n  { provide: RollbarService, useFactory: rollbarFactory },\n  { provide: APP_BASE_HREF, useValue: './' },\n  { provide: LocationStrategy, useClass: HashLocationStrategy },\n];\n\nconst  onlineProviders = [  \n    { provide: HTTP_INTERCEPTORS, useClass: ApiInterceptor, multi: true },\n    { provide: UrlSerializer, useClass: CustomUrlSerializer },\n    { provide: ErrorHandler, useClass: RollbarErrorHandler },\n    { provide: RollbarService, useFactory: rollbarFactory },\n  ];\n\n@NgModule({\n  declarations: [\n    AppWidgetComponent\n  ],\n\n  imports: [\n    // This has to be at the top due to a bug in NgxsOnInit (https://github.com/ngxs/store/issues/539)\n    NgxsModule.forRoot(),\n\n    BreakpointModule,\n    \n    // NgxsReduxDevtoolsPluginModule.forRoot({\n    //   disabled: environment.production\n    // }),\n    // Locales\n    LocaleConfigModule.forRoot(),\n\n    // Google Analytics\n    NgxGoogleAnalyticsModule.forRoot(environment.googleAnalyticsId),\n\n    // Markdown Support\n    MarkdownConfigModule,\n\n    // NoopAnimationsModule, // Disable animations for faster UI\n    BrowserModule,\n    BrowserAnimationsModule,\n    HttpClientModule,\n\n    // App dependencies\n    EngineModule,\n\n    // Child features\n    BookmarksModule,\n    LayoutModule,\n    OrganizationsModule,\n    StoryModule,\n\n    UndoModule,\n\n\n    // Dialogs\n    DialogModule,\n\n    ViewModule,\n\n    // Widget auth + analytics\n    WidgetModule,\n    WidgetAuthModule,\n\n    // App routing\n    AppWidgetRoutingModule\n  ],\n  providers: (environment.offline === true) ? offlineProviders : onlineProviders,\n  bootstrap: [AppWidgetComponent]\n})\nexport class AppWidgetModule { }\n","<div class=\"modal\">\n\n  <button app-button buttonType=\"text\" buttonTheme=\"light\" type=\"button\" (click)=\"closeDialog()\" title=\"Close\" [attr.aria-label]=\"'Close'\" class=\"modal__close\">\n    <app-icon icon=\"times\" size=\"lg\">\n    </app-icon>\n  </button>\n      \n  <div mat-dialog-content class=\"text-12 content\">\n\n      <img src=\"assets/images/biodigital-logo.svg\" width=\"190\" class=\"mb-2\"/>\n      <p class=\"text-14 text-semibold\">The BioDgital Human Platform</p>\n      <p>Version 4.0</p>\n      <p class=\"mb-3\"><a href=\"https://wwww.biodigital.com/terms\" target=\"_blank\">Terms of Service</a> | <a href=\"https://wwww.biodigital.com/privacy\" target=\"_blank\">Privacy Policy</a></p>\n\n      <p class=\"mb-4\">Software and all 3D models &copy; <span class=\"text-semibold\">BioDigital, Inc 2020.</span> All rights reserved.</p>\n\n      <p class=\"mb-2\">This program is protected by copyright law and international treaties. Unauthorized\n      reproduction, distribution, reverse engineering or sale of the software is strictly\n      prohibited. This software is not a diagnostic or clinical decision-making tool.\n      The medical information is intended for background viewing and general interest.\n      Content is asserted neither complete nor error free. Please consult your own licensed\n      physician regarding diagnosis and treatment of any medical condition! Please see\n      also our full <a href=\"https://wwww.biodigital.com/terms\" target=\"_blank\">Terms of Service.</a></p>\n\n      <p class=\"mb-2\">The BioDigital Human is made possible through the expertise and dedication of our development team,\n          advisors, investors and all who pioneered medical education before us. Thank you!\n      </p>\n\n      <p class=\"mb-2\">For licensing information contact <span class=\"text-medium\">info@biodigital.com.</span></p>\n  </div>\n</div>","import { Component, OnInit, ChangeDetectionStrategy, Inject } from '@angular/core';\nimport { MatDialogRef, MAT_DIALOG_DATA } from '@angular/material/dialog';\n\n@Component({\n  selector: 'app-about-dialog',\n  templateUrl: './about-dialog.component.html',\n  styleUrls: ['./about-dialog.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class AboutDialogComponent implements OnInit {\n\n  constructor(\n    public dialogRef: MatDialogRef<AboutDialogComponent>\n  ) { }\n\n  ngOnInit() {\n  }\n\n  closeDialog() {\n    this.dialogRef.close();\n  }\n\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { MaterialModule } from 'src/app/material.module';\nimport { SharedModule } from 'src/app/shared/shared.module';\nimport { AboutDialogComponent } from './about-dialog.component';\n\n\n\n@NgModule({\n  declarations: [\n    AboutDialogComponent\n  ],\n  imports: [\n    CommonModule,\n    MaterialModule,\n    SharedModule\n  ],\n  exports: [\n    AboutDialogComponent\n  ],\n  entryComponents: [\n    AboutDialogComponent\n  ]\n})\nexport class AboutDialogModule { }\n","<h1 mat-dialog-title>\n  View Only\n</h1>\n    \n<div mat-dialog-content>\n  <span class=\"text-14\">This content is currently set to view only, and changes made will be saved to a copy. </span>\n</div>\n\n<div mat-dialog-actions>\n  <button app-button buttonType=\"primary\" [mat-dialog-close]=\"true\" cdkFocusInitial style=\"min-width: 100px;\">OK</button>\n</div>","import { Component, OnInit, Inject, ChangeDetectionStrategy } from '@angular/core';\nimport { MatDialogRef, MAT_DIALOG_DATA } from '@angular/material/dialog';\n\nexport interface AccessDialogData {\n  titleText?: string;\n}\n\n@Component({\n  selector: 'app-access-dialog',\n  templateUrl: './access-dialog.component.html',\n  styleUrls: ['./access-dialog.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class AccessDialogComponent implements OnInit {\n  settings = {\n    titleText: 'Confirm Action'\n  };\n\n  constructor(\n    public dialogRef: MatDialogRef<AccessDialogComponent>,\n    @Inject(MAT_DIALOG_DATA) public data: AccessDialogData\n  ) {\n    if (data) {\n      this.settings = {\n        ...this.settings,\n        ...data\n      };\n    }\n  }\n\n  ngOnInit() {\n  }\n\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { AccessDialogComponent } from './access-dialog.component';\nimport { MaterialModule } from 'src/app/material.module';\nimport { SharedModule } from 'src/app/shared/shared.module';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    MaterialModule,\n    SharedModule\n  ],\n  declarations: [\n    AccessDialogComponent \n  ],\n  exports: [\n    AccessDialogComponent\n  ],\n  entryComponents: [\n    AccessDialogComponent\n  ]\n})\nexport class AccessDialogModule { }\n","<h1 mat-dialog-title>\n  Add to Team Models\n</h1>\n\n<div mat-dialog-content class=\"dialog\">\n\n  <form [formGroup]=\"form\" (submit)=\"handleSubmit()\">\n    <ng-container *ngIf=\"settings.bookmarks.length > 1 && (copying$ | async)\">\n      <app-progress [value]=\"copyBookmarkPercent\"></app-progress>\n      <div class=\"text-14 pt-2 pb-4\">\n        <app-spinner size=\"small\" class=\"mr-1\" render=\"inline\"></app-spinner>\n        Copying {{ copyBookmarkNumber }} of {{ settings.bookmarks.length }} bookmarks.\n      </div>\n    </ng-container>\n    \n\n    <!-- permission -->\n    <app-form-field theme=\"light\" label=\"Permissions\" class=\"mt-2 mb-2\">\n\n        <mat-radio-group class=\"dialog__radio-group text-12 mt-2\" formControlName=\"groupEditEnabled\">\n          <mat-radio-button value=\"false\" class=\"mb-2\">Team - View Only</mat-radio-button>\n          <mat-radio-button value=\"true\">Team - View & Edit</mat-radio-button>\n        </mat-radio-group>\n\n    </app-form-field>\n\n    <!-- collections -->\n    <app-form-field *ngIf=\"(collections$ | async)?.length\" label=\"Collection (Optional)\" theme=\"light\" class=\"mb-2\">\n\n      <select class=\"input\" formControlName=\"collectionId\">\n          <option [value]=\"null\">--</option>\n          <option *ngFor=\"let collection of collections$ | async\" [value]=\"collection.collection_id\">\n            {{ collection.collection_name }}\n          </option>\n        </select>\n\n    </app-form-field>\n\n  </form>\n  \n</div>\n\n<div mat-dialog-actions class=\"pt-2\">\n  <button app-button buttonTheme=\"light\" [mat-dialog-close] type=\"button\" class=\"mr-2\">Cancel</button>\n  <button app-button buttonType=\"primary\" cdkFocusInitial (click)=\"handleSubmit()\" [disabled]=\"copying$ | async\">\n    <!-- Copying -->\n    <ng-container *ngIf=\"(copying$ | async)\">\n      <app-spinner size=\"small\" class=\"mr-1\" render=\"inline\"></app-spinner>\n      Adding\n    </ng-container>\n\n    <!-- Copy -->\n    <ng-container *ngIf=\"!(copying$ | async)\">\n      Add\n    </ng-container>\n  </button>\n</div>","import { Component, OnInit, ChangeDetectionStrategy, Inject, OnDestroy } from '@angular/core';\nimport { FormGroup, FormBuilder, Validators } from '@angular/forms';\nimport { MAT_DIALOG_DATA, MatDialogRef } from '@angular/material/dialog';\nimport { MatSnackBar } from '@angular/material/snack-bar';\nimport { Select, Store, Actions, ofActionDispatched } from '@ngxs/store';\nimport { OrganizationsState } from 'src/app/organizations/state/organizations.state';\nimport { Observable, Subject } from 'rxjs';\nimport { CollectionModel } from 'src/app/organizations/models/collection.model';\nimport { BookmarkModel } from 'src/app/bookmarks/models/bookmark.model';\nimport { CopyBookmark, CopyBookmarkSuccess, CopyBookmarkFailure } from 'src/app/bookmarks/state/bookmarks.actions';\nimport { ContentType } from 'src/app/story/models/content-type.enum';\nimport { takeUntil, filter } from 'rxjs/operators';\nimport { GetCollections } from 'src/app/organizations/state/organizations.actions';\nimport { BookmarkGroupModel } from 'src/app/bookmarks/models/bookmark.group.model';\nimport { SaveModuleDialogComponent } from '../save-module-dialog/save-module-dialog.component';\nimport { BookmarksState } from 'src/app/bookmarks/state/bookmarks.state';\nimport { StorageService, StorageItemEnum } from 'src/app/shared/storage.service';\nimport { AuthState } from 'src/app/auth/state/auth/auth.state';\nimport { cloneDeep, get } from 'lodash';\n\nexport interface AddTeamModelDialog {\n  bookmarks: BookmarkModel[];\n}\n\n@Component({\n  selector: 'app-add-team-model-dialog',\n  templateUrl: './add-team-model-dialog.component.html',\n  styleUrls: ['./add-team-model-dialog.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class AddTeamModelDialogComponent implements OnInit, OnDestroy {\n\n  form: FormGroup;\n  settings: AddTeamModelDialog;\n\n  @Select(OrganizationsState.getCollections)\n  collections$: Observable<CollectionModel[]>;\n\n  @Select(BookmarksState.getCopying)\n  copying$: Observable<boolean>;\n\n  ngUnsubscribe = new Subject();\n  bookmarkIterator: BookmarkModel[];\n  newBookmarkIds: string[] = [];\n  copyBookmarkNumber = 0;\n  copyBookmarkPercent = 0;\n\n  constructor(\n    private store: Store,\n    private actions: Actions,\n    private formBuilder: FormBuilder,\n    private dialogRef: MatDialogRef<SaveModuleDialogComponent>,\n    private snackBar: MatSnackBar,\n    private storageService: StorageService,\n    @Inject(MAT_DIALOG_DATA) public data: AddTeamModelDialog\n  ) { \n    this.settings = {...data};\n    const organization = this.store.selectSnapshot(OrganizationsState.getOrganization);\n    if (organization) {\n      this.store.dispatch(new GetCollections(organization.id));\n    }\n  }\n\n  ngOnInit() {\n    this.initForm();\n    this.initObservers();\n  }\n\n  ngOnDestroy() {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n  handleSubmit() {\n    // 1. Pop first bookmark from list\n    // 2. Add to collection\n    // 3. Wait for success\n    // 4. If more items in list, repeat\n\n    if (this.form.valid) {\n      this.bookmarkIterator = [...this.settings.bookmarks];\n      this.copyNextBookmark();\n    }\n  }\n\n  copyNextBookmark() {\n    const bookmark = this.bookmarkIterator.pop();\n    this.copyBookmarkNumber = this.settings.bookmarks.length - this.bookmarkIterator.length;\n    this.copyBookmarkPercent = ((this.copyBookmarkNumber - 1) / this.settings.bookmarks.length) * 100;\n    this.addTeamModel(bookmark);\n  }\n\n  handleCopySuccess(action: CopyBookmarkSuccess) {\n    const sourceBookmark = this.settings.bookmarks.find(value => value.id === action.sourceId);\n    const collection = get(action, 'collection.collection_name', 'Team Models');\n\n    this.snackBar.open(`Added ${sourceBookmark.title} to ${collection}.`);\n    this.newBookmarkIds.push(action.newId);\n\n    if (this.bookmarkIterator.length) {\n      this.copyNextBookmark();\n    } else {\n      this.dialogRef.close(this.newBookmarkIds);\n    }\n  }\n\n  handleCopyFailure(action: CopyBookmarkFailure) {\n    const sourceBookmark = this.settings.bookmarks.find(value => value.id === action.id);\n    this.snackBar.open(`Adding ${sourceBookmark.title} to your team models has failed. Please try again.`);\n  }\n\n  initForm() {\n    // read defaults\n    const defaultGroupEdit = this.storageService.getLocalItem(StorageItemEnum.DefaultGroupEdit) === 'true';\n    const defaultCollectionId = this.storageService.getLocalItem(StorageItemEnum.DefaultCollectionId);\n\n    this.form = this.formBuilder.group({\n      groupEditEnabled: [`${defaultGroupEdit}`, Validators.required],\n      collectionId: [defaultCollectionId]\n    });\n\n    // write defaults\n    this.form.valueChanges\n      .pipe(\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(({ groupEditEnabled, collectionId }) => {\n        if (groupEditEnabled) {\n          this.storageService.setLocalItem(StorageItemEnum.DefaultGroupEdit, groupEditEnabled);\n        } else {\n          this.storageService.removeLocalItem(StorageItemEnum.DefaultGroupEdit);\n        }\n        if (collectionId) {\n          this.storageService.setLocalItem(StorageItemEnum.DefaultCollectionId, collectionId);\n        } else {\n          this.storageService.removeLocalItem(StorageItemEnum.DefaultCollectionId);\n        }\n      });\n  }\n\n  initObservers() {\n    // Success\n    this.actions\n      .pipe(\n        ofActionDispatched(CopyBookmarkSuccess),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe((action) => {\n        this.handleCopySuccess(action);\n      });\n\n    // Failure\n    this.actions\n      .pipe(\n        ofActionDispatched(CopyBookmarkFailure),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe((action) => {\n        this.handleCopyFailure(action);\n      });\n  }\n\n  addTeamModel(bookmark: BookmarkModel) {\n    const { groupEditEnabled, collectionId } = this.form.value;\n    const organization = this.store.selectSnapshot(OrganizationsState.getOrganization);\n    const collections = this.store.selectSnapshot(OrganizationsState.getCollections);\n    const lang = this.store.selectSnapshot(AuthState.getUserLocale).lang;\n    \n    // set group access    \n    const groupAccess: BookmarkGroupModel = {\n      group_id: organization.id,\n      member_edit: groupEditEnabled === 'true',\n      visible: true\n    };\n\n    // set collection\n    const collection = collections.find(({ collection_id }) => `${collection_id}` === collectionId);\n\n    // copy bookmark\n    this.store.dispatch(new CopyBookmark(bookmark.id, <ContentType>bookmark.type, lang, groupAccess, collection));\n  }\n \n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { ReactiveFormsModule } from '@angular/forms';\nimport { AddTeamModelDialogComponent } from './add-team-model-dialog.component';\nimport { MaterialModule } from 'src/app/material.module';\nimport { SharedModule } from 'src/app/shared/shared.module';\n\n\n\n@NgModule({\n  imports: [\n    CommonModule,\n    MaterialModule,\n    SharedModule,\n    ReactiveFormsModule\n  ],\n  declarations: [\n    AddTeamModelDialogComponent \n  ],\n  exports: [\n    AddTeamModelDialogComponent\n  ],\n  entryComponents: [\n    AddTeamModelDialogComponent\n  ]\n})\nexport class AddTeamModelDialogModule { }\n","<h1 mat-dialog-title>\n  Background Color\n</h1>\n    \n<div class=\"background theme-light\">\n\n  <app-tabs (activeTabChange)=\"handleTabChange($event)\">\n\n    <!-- presets -->\n    <app-tab label=\"Presets\" #presetTab>\n\n      <div class=\"background__section mt-3\">\n        \n        <!-- preset swatch -->\n        <app-form-field>\n        \n          <div class=\"background__swatches\">\n\n              <app-swatch-item            \n                *ngFor=\"let background of presetBackgrounds\"\n                class=\"m-1\"\n                [color]=\"background\"\n                [size]=\"'medium'\"\n                [selected]=\"backgroundsEqual(background, presetBackground)\"           \n                (click)=\"handlePresetSelected(background)\">\n              </app-swatch-item>\n\n          </div>\n\n        </app-form-field>\n\n        <!-- chapter default -->\n        <button\n          app-button\n          buttonType=\"outline\"\n          buttonTheme=\"light\"\n          buttonSize=\"small\" \n          class=\"mb-4\" (click)=\"handleResetClick()\">\n            Revert to Original\n        </button>\n\n        <!-- chapters swatch -->\n        <app-form-field label=\"Currently Used\">\n\n          <div class=\"background__swatches\">\n\n              <app-swatch-item\n                *ngFor=\"let background of distinctBackgrounds\"\n                class=\"m-1\"\n                [color]=\"background\"\n                [size]=\"'medium'\"\n                (click)=\"handlePresetSelected(background)\">\n              </app-swatch-item>\n\n          </div>\n\n        </app-form-field>\n      </div>\n      \n\n    </app-tab>\n\n    <!-- custom -->\n    <app-tab label=\"Custom\" #customTab>\n\n      <form\n        class=\"background__section mt-4\"\n        [formGroup]=\"form\"\n        [ngSwitch]=\"form.get('type').value\">\n\n          <!-- color type -->\n          <app-form-field label=\"Type\">\n\n            <select class=\"input\" formControlName=\"type\">\n              <option value=\"solid\">Solid Color</option>\n              <option value=\"radial\">Radial Gradient</option>\n              <option value=\"linear\">Linear Gradient</option>\n              <option value=\"transparent\">Transparent</option>        \n            </select>\n\n          </app-form-field>\n          \n          <!-- solid config -->\n          <div *ngSwitchCase=\"'solid'\">\n\n              <app-form-field label=\"Color\">\n                  <input\n                    class=\"input\"\n                    type=\"text\"\n                    [colorPicker]=\"getFormBackgroundHex('color1')\"\n                    (colorPickerChange)=\"handleFormColorSelected('color1', $event)\" \n                    [cpOutputFormat]=\"'hex'\"\n                    [cpAlphaChannel]=\"'disabled'\"\n                    [style.background]=\"getFormBackgroundHex('color1')\"\n                    cpPosition=\"left\">\n              </app-form-field>\n\n          </div>\n\n          <!-- radial config -->\n          <div *ngSwitchCase=\"'radial'\">\n\n              <app-form-field label=\"Inner Color\">\n                  <input\n                    class=\"input\"\n                    type=\"text\"\n                    [colorPicker]=\"getFormBackgroundHex('color1')\"\n                    (colorPickerChange)=\"handleFormColorSelected('color1', $event)\" \n                    [cpOutputFormat]=\"'hex'\"\n                    [cpAlphaChannel]=\"'disabled'\"\n                    [style.background]=\"getFormBackgroundHex('color1')\"\n                    cpPosition=\"left\">\n              </app-form-field>\n\n              <app-form-field label=\"Inner Radius\">\n                  <app-slider theme=\"light\" [min]=\"0\" [max]=\"100\" formControlName=\"stop1\"></app-slider>\n              </app-form-field>\n  \n              <app-form-field label=\"Outer Color\">\n                  <input\n                    class=\"input\"\n                    type=\"text\"\n                    [colorPicker]=\"getFormBackgroundHex('color2')\"\n                    (colorPickerChange)=\"handleFormColorSelected('color2', $event)\" \n                    [cpOutputFormat]=\"'hex'\"\n                    [cpAlphaChannel]=\"'disabled'\"\n                    [style.background]=\"getFormBackgroundHex('color2')\"\n                    cpPosition=\"left\">\n              </app-form-field>\n\n              <app-form-field label=\"Outer Radius\">\n                  <app-slider theme=\"light\" [min]=\"0\" [max]=\"100\" formControlName=\"stop2\"></app-slider>\n              </app-form-field>\n  \n          </div>\n\n          <!-- linear config -->\n          <div *ngSwitchCase=\"'linear'\">\n\n            <app-form-field label=\"Starting Color\">\n                <input\n                  class=\"input\"\n                  type=\"text\"\n                  [colorPicker]=\"getFormBackgroundHex('color1')\"\n                  (colorPickerChange)=\"handleFormColorSelected('color1', $event)\" \n                  [cpOutputFormat]=\"'hex'\"\n                  [cpAlphaChannel]=\"'disabled'\"\n                  [style.background]=\"getFormBackgroundHex('color1')\"\n                  cpPosition=\"left\">\n            </app-form-field>\n\n            <app-form-field label=\"Starting Color Stop\">\n              <app-slider theme=\"light\" [min]=\"0\" [max]=\"100\" formControlName=\"stop1\"></app-slider>\n            </app-form-field>\n\n            <app-form-field label=\"Ending Color\">\n                <input\n                  class=\"input\"\n                  type=\"text\"\n                  [colorPicker]=\"getFormBackgroundHex('color2')\"\n                  (colorPickerChange)=\"handleFormColorSelected('color2', $event)\" \n                  [cpOutputFormat]=\"'hex'\"\n                  [cpAlphaChannel]=\"'disabled'\"\n                  [style.background]=\"getFormBackgroundHex('color2')\"\n                  cpPosition=\"left\">\n            </app-form-field>\n            \n            <app-form-field label=\"Ending Color Stop\">\n                <app-slider theme=\"light\" [min]=\"0\" [max]=\"100\" formControlName=\"stop2\"></app-slider>\n            </app-form-field>\n\n          </div>\n\n          <!-- transparent conifg -->\n          <div *ngSwitchCase=\"'transparent'\">\n            <app-alert type=\"info\" theme=\"light\">\n              The background of your application will appear behind the 3D model.\n            </app-alert>\n          </div>\n\n      </form>\n     \n    </app-tab>\n\n  </app-tabs>\n\n</div>\n\n<div mat-dialog-actions>\n  <button app-button buttonTheme=\"light\" class=\"mr-2\" (click)=\"applyAll()\">Apply to All</button>\n  <button app-button buttonType=\"flat\" buttonTheme=\"light\" [mat-dialog-close]=\"true\" cdkFocusInitial>Done</button>\n</div>","import { Component, OnInit, ChangeDetectionStrategy, Input, OnDestroy, ViewChild } from '@angular/core';\nimport { BackgroundModel } from 'src/app/engine/models/background.model';\nimport { Subject, Observable } from 'rxjs';\nimport { Select, Store, Actions, ofActionCompleted } from '@ngxs/store';\nimport { StoryChaptersState } from 'src/app/story/state/chapters/story.chapters.state';\nimport { takeUntil, filter } from 'rxjs/operators';\nimport { SetSelectedChapterBackground, SetAllChaptersBackground, ResetSelectedChapterBackground } from 'src/app/story/state/chapters/story.chapters.actions';\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\nimport { TabComponent } from 'src/app/shared/components/tabs/tab/tab.component';\nimport { environment } from 'src/environments/environment';\nimport { plainToClass } from 'class-transformer';\nimport { MatSnackBar } from '@angular/material/snack-bar';\nimport { loftSwatch, studioSwatch, transparentBackground } from './background-config';\nimport { isEqual } from 'lodash';\nimport { ColorUtils } from 'src/app/shared/libraries/colors/colors';\n\n@Component({\n  selector: 'app-background-color-dialog',\n  templateUrl: './background-color-dialog.component.html',\n  styleUrls: ['./background-color-dialog.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class BackgroundColorDialogComponent implements OnInit, OnDestroy {\n\n  @Select(StoryChaptersState.getSelectedChapterBackground)\n  background$: Observable<BackgroundModel>;\n\n  @Select(StoryChaptersState.getAllChaptersBackground)\n  allChapterBackgrounds$: Observable<BackgroundModel[]>;\n\n  @Select(StoryChaptersState.getSelectedChapterIndex)\n  selectedChapterIndex$: Observable<number>;\n\n  @ViewChild('presetTab', { static: true })\n  presetTab: TabComponent;\n\n  @ViewChild('customTab', { static: true })\n  customTab: TabComponent;\n\n  // selected preset\n  presetBackground: BackgroundModel;\n\n  // selected preset\n  distinctBackgrounds: BackgroundModel[];\n\n  // environment based preset swatch\n  presetBackgrounds = environment.exportType === 'module'\n    ? plainToClass(BackgroundModel, loftSwatch) // loft\n    : plainToClass(BackgroundModel, studioSwatch); // studio\n\n  form: FormGroup;\n  ngUnsubscribe = new Subject();\n\n  constructor(\n    private store: Store,\n    private actions: Actions,\n    private fb: FormBuilder,\n    private snackBar: MatSnackBar\n  ) { }\n\n  ngOnInit() {\n    this.initPresets();\n    this.initForm();\n\n    // messaging\n    this.actions.pipe(\n      ofActionCompleted(SetAllChaptersBackground),\n      takeUntil(this.ngUnsubscribe)\n    )\n      .subscribe(() => {\n        this.snackBar.open('Successfully applied color to all chapters.');\n      });\n  }\n\n  ngOnDestroy() {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n  initPresets() {\n    // track selected preset\n    this.presetBackground = this.store.selectSnapshot(StoryChaptersState.getSelectedChapterBackground);\n    this.background$\n      .pipe(\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe((background) => {\n        this.presetBackground = background;\n      });\n\n    // track distinct chapter backgrounds\n    this.allChapterBackgrounds$\n      .pipe(\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe((backgrounds) => {\n        this.distinctBackgrounds = backgrounds.filter((background, index) => {\n          return backgrounds.findIndex((searchBackgound) => this.backgroundsEqual(background, searchBackgound)) === index;\n        });\n      });\n  }\n\n  initForm() {\n    // get current chapter defaults\n    const chapterBackground = this.store.selectSnapshot(StoryChaptersState.getSelectedChapterBackground);\n    \n    // setup form\n    this.form = this.fb.group({\n      type: ['solid', [Validators.required]],\n      color1: ['', [Validators.required]],\n      stop1: [0, [Validators.required, Validators.min(0), Validators.max(100)]],\n      color2: ['', [Validators.required]],\n      stop2: [100, [Validators.required, Validators.min(0), Validators.max(100)]]\n    });\n\n    // setup events: set custom background\n    this.form.valueChanges\n      .pipe(\n        filter(() => this.customTab.isActive),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(() => {\n        this.applyFromCustom();\n      });\n\n    // set initial form values\n    if (chapterBackground) {\n      this.setCustomColorForm(chapterBackground);\n    }\n  }\n\n  handleFormColorSelected(fieldName: string, color: string) {\n    this.form.get(fieldName)\n      .setValue(color);\n  }\n\n  handlePresetSelected(background: BackgroundModel) {\n    this.presetBackground = background;\n    this.store.dispatch(new SetSelectedChapterBackground(background));\n  }\n\n  handleResetClick() {\n    this.store.dispatch(new ResetSelectedChapterBackground());\n  }\n\n  handleTabChange(tab: string | number) {\n    // apply custom preset\n    if (this.customTab.isActive && this.presetBackground) {\n      this.setCustomColorForm(this.presetBackground);\n    }\n  }\n\n  backgroundsEqual(backgroundA: BackgroundModel, backgroundB: BackgroundModel): boolean {\n    return isEqual(backgroundA, backgroundB);\n  }\n\n  getBackgroundHex(background: BackgroundModel): string {\n    const colors = background.colors;\n    return ColorUtils.rgbToHex([colors[0], colors[1], colors[2]]);\n  }\n\n  getFormBackgroundHex(fieldName: string): string {\n    return this.form.get(fieldName).value;\n  }\n\n  applyAll() {\n    const type = this.form.value.type;\n    // determine mode\n    if (this.presetTab.isActive) {\n      this.store.dispatch(new SetAllChaptersBackground(this.presetBackground));\n    } else if (this.customTab.isActive) {\n      const customBackground = this.formToBackgroundColor(type);\n      if (customBackground) {\n        this.store.dispatch(new SetAllChaptersBackground(customBackground));\n      }\n    }\n  }\n\n  applyFromCustom() {\n    const type = this.form.value.type;\n    const customBackground = this.formToBackgroundColor(type);\n    if (customBackground) {\n      this.store.dispatch(new SetSelectedChapterBackground(customBackground));\n    }\n  }\n\n  private setCustomColorForm(background: BackgroundModel) {    \n    let type = 'solid';\n    let color1 = '';\n    let color2 = '';\n    let stop1 = 0;\n    let stop2 = 100;\n\n    const { colors, gradientType, colorStops } = background;\n    // set colors\n    const firstRGB: [number, number, number] = [\n      colors[0],\n      colors[1],\n      colors[2]\n    ];\n    const secondRGB: [number, number, number] = colors.length < 8\n      ? firstRGB\n      : [\n        colors[4],\n        colors[5],\n        colors[6]\n      ];\n    color1 = ColorUtils.rgbToHex(firstRGB, false);\n    color2 = ColorUtils.rgbToHex(secondRGB, false);\n\n    // set type: handle transparent\n    if (BackgroundModel.isTransparent(background)) {\n      type = 'transparent';\n    } else if (isEqual(firstRGB, secondRGB)) {\n      type = 'solid';\n    } else {\n      type = gradientType;\n    }\n\n    // set stops\n    stop1 = colorStops[0];\n    stop2 = colorStops[1];\n\n    this.form.patchValue({\n      type: type,\n      color1: color1,\n      stop1: stop1,\n      color2: color2,\n      stop2: stop2\n    });\n  }\n\n  private formToBackgroundColor(type: string): BackgroundModel {\n    const { color1, color2, stop1, stop2 } = this.form.value;\n    const formGroup = this.form;\n\n    // special case\n    if (type === 'transparent') {\n      return transparentBackground;\n    }\n\n    // validation\n    if (!formGroup.valid) {\n      return null;\n    }\n    \n    let background: BackgroundModel;\n    const colors: number[] = [];\n    const gradientType = type === 'radial' ? 'radial' : 'linear';\n\n    // set color 1\n    if (color1) {\n      colors.push(...ColorUtils.hexToRgb(color1, false), 1);\n    }\n    // set color 2\n    if (color2 && type !== 'solid') {\n      colors.push(...ColorUtils.hexToRgb(color2, false), 1);\n    } else { // repeat color\n      colors.push(...colors);\n    }\n\n    background = new BackgroundModel(\n      colors,\n      gradientType,\n      [stop1, stop2]\n    );\n    return background;\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { MaterialModule } from 'src/app/material.module';\nimport { SharedModule } from 'src/app/shared/shared.module';\nimport { ReactiveFormsModule } from '@angular/forms';\nimport { ColorPickerModule } from 'ngx-color-picker';\nimport { BackgroundColorDialogComponent } from './background-color-dialog.component';\n\n\n\n@NgModule({\n  declarations: [\n    BackgroundColorDialogComponent\n  ],\n  imports: [\n    CommonModule,\n    MaterialModule,\n    SharedModule,\n    ReactiveFormsModule,\n    ColorPickerModule\n  ],\n  exports: [\n    BackgroundColorDialogComponent\n  ],\n  entryComponents: [\n    BackgroundColorDialogComponent\n  ]\n})\nexport class BackgroundColorDialogModule { }\n","import { BackgroundModel } from 'src/app/engine/models/background.model';\n\nexport const appDefaultBackground: BackgroundModel = {\n  colors: [245, 245, 245, 1, 245, 245, 245, 1],\n  gradientType: 'radial',\n  colorStops: [0, 100]\n  \n};\n\nexport const transparentBackground: BackgroundModel = {\n  colors: [255, 255, 255, 0, 255, 255, 255, 0],\n  gradientType: 'linear',\n  colorStops: [0, 100]\n};\n\nexport const studioSwatch: BackgroundModel[] = [\n  // grayscale: solid\n  {\n    colors: [0, 0, 0, 1, 0, 0, 0, 1],\n    gradientType: 'linear',\n    colorStops: [0, 100]\n  },\n  {\n    colors: [38, 38, 38, 1, 38, 38, 38, 1],\n    gradientType: 'linear',\n    colorStops: [0, 100]\n  },\n  {\n    colors: [77, 77, 77, 1, 77, 77, 77, 1],\n    gradientType: 'linear',\n    colorStops: [0, 100]\n  },\n  {\n    colors: [115, 115, 115, 1, 115, 115, 115, 1],\n    gradientType: 'linear',\n    colorStops: [0, 100]\n  },\n  {\n    colors: [153, 153, 153, 1, 153, 153, 153, 1],\n    gradientType: 'linear',\n    colorStops: [0, 100]\n  },\n  {\n    colors: [191, 191, 191, 1, 191, 191, 191, 1],\n    gradientType: 'linear',\n    colorStops: [0, 100]\n  },\n  {\n    colors: [230, 230, 230, 1, 230, 230, 230, 1],\n    gradientType: 'linear',\n    colorStops: [0, 100]\n  },\n  {\n    colors: [255, 255, 255, 1, 255, 255, 255, 1],\n    gradientType: 'linear',\n    colorStops: [0, 100]\n  },\n  // grayscale: radial\n  {\n    colors: [128, 128, 128, 1, 0, 0, 0, 1],\n    gradientType: 'radial',\n    colorStops: [0, 100]\n  },\n  {\n    colors: [128, 128, 128, 1, 38, 38, 38, 1],\n    gradientType: 'radial',\n    colorStops: [0, 100]\n  },\n  {\n    colors: [128, 128, 128, 1, 77, 77, 77, 1],\n    gradientType: 'radial',\n    colorStops: [0, 100]\n  },\n  {\n    colors: [128, 128, 128, 1, 115, 115, 115, 1],\n    gradientType: 'radial',\n    colorStops: [0, 100]\n  },\n  {\n    colors: [128, 128, 128, 1, 153, 153, 153, 1],\n    gradientType: 'radial',\n    colorStops: [0, 100]\n  },\n  {\n    colors: [128, 128, 128, 1, 191, 191, 191, 1],\n    gradientType: 'radial',\n    colorStops: [0, 100]\n  },\n  {\n    colors: [128, 128, 128, 1, 230, 230, 230, 1],\n    gradientType: 'radial',\n    colorStops: [0, 100]\n  },\n  {\n    colors: [128, 128, 128, 1, 255, 255, 255, 1],\n    gradientType: 'radial',\n    colorStops: [0, 100]\n  },\n  // colors: solid\n  {\n    colors: [245, 208, 208, 1, 245, 208, 208, 1],\n    gradientType: 'linear',\n    colorStops: [0, 100]\n  },\n  {\n    colors: [253, 236, 219, 1, 253, 236, 219, 1],\n    gradientType: 'linear',\n    colorStops: [0, 100]\n  },\n  {\n    colors: [255, 246, 219, 1, 255, 246, 219, 1],\n    gradientType: 'linear',\n    colorStops: [0, 100]\n  },\n  {\n    colors: [220, 236, 213, 1, 220, 236, 213, 1],\n    gradientType: 'linear',\n    colorStops: [0, 100]\n  },\n  {\n    colors: [212, 229, 245, 1, 212, 229, 245, 1],\n    gradientType: 'linear',\n    colorStops: [0, 100]\n  },\n  {\n    colors: [219, 212, 235, 1, 219, 212, 235, 1],\n    gradientType: 'linear',\n    colorStops: [0, 100]\n  },\n  {\n    colors: [164, 194, 244, 1, 164, 194, 244, 1],\n    gradientType: 'linear',\n    colorStops: [0, 100]\n  },\n  {\n    colors: [118, 165, 175, 1, 118, 165, 175, 1],\n    gradientType: 'linear',\n    colorStops: [0, 100]\n  },\n  // colors: radial\n  {\n    colors: [245, 208, 208, 1, 245, 208, 208, 1],\n    gradientType: 'radial',\n    colorStops: [0, 100]\n  },\n  {\n    colors: [253, 236, 219, 1, 240, 169, 99, 1],\n    gradientType: 'radial',\n    colorStops: [0, 100]\n  },\n  {\n    colors: [255, 246, 219, 1, 250, 210, 92, 1],\n    gradientType: 'radial',\n    colorStops: [0, 100]\n  },\n  {\n    colors: [220, 236, 213, 1, 147, 188, 129, 1],\n    gradientType: 'radial',\n    colorStops: [0, 100]\n  },\n  {\n    colors: [212, 229, 245, 1, 112, 164, 213, 1],\n    gradientType: 'radial',\n    colorStops: [0, 100]\n  },\n  {\n    colors: [219, 212, 235, 1, 145, 128, 187, 1],\n    gradientType: 'radial',\n    colorStops: [0, 100]\n  },\n  {\n    colors: [164, 194, 244, 1, 112, 164, 213, 1],\n    gradientType: 'radial',\n    colorStops: [0, 100]\n  },\n  {\n    colors: [211, 211, 211, 1, 118, 165, 175, 1],\n    gradientType: 'radial',\n    colorStops: [0, 100]\n  }\n];\n\nexport const loftSwatch = [\n  ...studioSwatch,\n  {\n    colors: [10, 132, 130, 255, 5, 43, 51, 255],\n    gradientType: 'radial',\n    colorStops: [0, 68]\n  },\n  {\n    colors: [0, 28, 84, 1, 0, 0, 0, 1],\n    gradientType: 'radial',\n    colorStops: [12, 100]\n  }\n];\n","<div class=\"dialog\" [formGroup]=\"form\">\n\n    <!-- main interface -->\n    <div>    \n\n        <div mat-dialog-title>\n            <div class=\"flex flex-row justify-between\">\n                <h1>Cancel Subscription</h1>\n\n                <button app-button buttonType=\"text\" buttonTheme=\"light\" type=\"button\" (click)=\"handleCancelClick()\" title=\"Close\" [attr.aria-label]=\"'Close'\">\n                    <app-icon icon=\"times\" size=\"lg\">\n                    </app-icon>\n                </button>\n            </div>\n        </div>\n\n        <mat-divider></mat-divider>\n\n        <!-- Content -->\n        <div class=\"theme-light\" class=\"text-14 mv-4 mb-9\">\n            \n            <!-- disclaimer -->\n            <div *ngIf=\"!(cancelling$ | async)\">\n\n                <div class=\"mb-6\">\n                    Are you sure you want to <em class=\"text-bold\">cancel</em> your subscription?\n                </div>\n\n                <ul class=\"dialog__list\">\n                    <li class=\"mv-2\">\n                        After cancelling your BioDigital Human subscription, your premium benefits will continue until the subscription end date.\n                    </li>\n                    <li class=\"mv-2\">\n                        You will not be billed after your subscription end date.\n                    </li>\n                </ul>\n\n                <div class=\"mt-4\">\n                    <mat-checkbox formControlName=\"confirm\">\n                        <span style=\"white-space: normal;\">I confirm I want to cancel my subscription.</span>\n                    </mat-checkbox>\n                </div>\n\n            </div>\n\n            <!-- cancelling -->\n            <div *ngIf=\"cancelling$ | async\" class=\"dialog__cancel flex flex-column items-center\">\n                <app-spinner size=\"large\"></app-spinner>\n\n                <div class=\"mt-3 text-11\">Cancelling your subscription...</div>\n            </div>\n\n        </div>\n\n        <!-- Actions -->\n        <div mat-dialog-actions>\n\n            <!-- actions -->\n            <div class=\"flex justify-end\">\n                <button\n                    app-button\n                    buttonTheme=\"light\"\n                    buttonType=\"default\"\n                    class=\"mr-2\"\n                    (click)=\"handleCancelClick()\">Cancel</button>\n\n                <button\n                    app-button\n                    buttonType=\"primary\"\n                    (click)=\"handleCancelSubscriptionClick()\"\n                    [disabled]=\"form.invalid || (cancelling$ | async)\">\n                    Yes, Cancel Subscription\n                </button>\n            </div>\n\n        </div>\n\n    </div>\n\n</div>","import { ChangeDetectionStrategy, Component, OnDestroy, OnInit } from '@angular/core';\nimport { FormGroup, FormBuilder, Validators } from '@angular/forms';\nimport { MatDialogRef, MatSnackBar } from '@angular/material';\nimport { Select, Store, Actions, ofActionDispatched } from '@ngxs/store';\nimport { Observable, Subject } from 'rxjs';\nimport { takeUntil } from 'rxjs/operators';\nimport { GetUserProfile } from 'src/app/auth/state/auth/auth.actions';\nimport {\n  CancelSubscription,\n  CancelSubscriptionFailure,\n  CancelSubscriptionSuccess\n} from 'src/app/auth/state/subscription/subscription.actions';\nimport { SubscriptionState } from 'src/app/auth/state/subscription/subscription.state';\nimport { parseErrorMessage } from 'src/app/account/utils/account-error-utils';\n\nconst defaultErrorMessage = 'There was an error cancelling your subscription.';\n\n@Component({\n  selector: 'app-cancel-subscription-dialog',\n  templateUrl: './cancel-subscription-dialog.component.html',\n  styleUrls: ['./cancel-subscription-dialog.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class CancelSubscriptionDialogComponent implements OnInit, OnDestroy {\n\n  @Select(SubscriptionState.getCancelling)\n  cancelling$: Observable<boolean>;\n\n  form: FormGroup;\n\n  private ngUnsubscribe = new Subject();\n\n  constructor(\n    private store: Store,\n    private actions: Actions,\n    private formBuilder: FormBuilder,\n    private dialogRef: MatDialogRef<CancelSubscriptionDialogComponent>,\n    private snackbar: MatSnackBar\n  ) { }\n\n  ngOnInit() {\n    this.initForm();\n    this.initListeners();\n  }\n\n  ngOnDestroy() {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n  initForm() {\n    this.form = this.formBuilder.group({\n      'confirm': [false, Validators.requiredTrue]\n    });\n  }\n\n  initListeners() {\n    // success \n    this.actions\n      .pipe(\n        ofActionDispatched(CancelSubscriptionSuccess),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(() => {\n        this.snackbar.open('Subscription successfully cancelled.');\n        this.store.dispatch(new GetUserProfile(true));\n\n        this.dialogRef.close();\n      });\n\n    // failure\n    this.actions\n      .pipe(\n        ofActionDispatched(CancelSubscriptionFailure),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe((action: CancelSubscriptionFailure) => {\n        const errorMessage = parseErrorMessage(action.error) || defaultErrorMessage;\n        this.snackbar.open(errorMessage);\n      });\n  }\n\n  handleCancelClick() {\n    this.dialogRef.close();\n  }\n\n  handleCancelSubscriptionClick() {\n    this.store.dispatch(new CancelSubscription());\n  }\n\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { MaterialModule } from 'src/app/material.module';\nimport { SharedModule } from 'src/app/shared/shared.module';\nimport { ReactiveFormsModule } from '@angular/forms';\nimport { CancelSubscriptionDialogComponent } from './cancel-subscription-dialog.component';\n\n@NgModule({\n  declarations: [\n    CancelSubscriptionDialogComponent\n  ],\n  imports: [\n    CommonModule,\n    MaterialModule,\n    SharedModule,\n    ReactiveFormsModule\n  ],\n  exports: [\n    CancelSubscriptionDialogComponent\n  ],\n  entryComponents: [\n    CancelSubscriptionDialogComponent\n  ]\n})\nexport class CancelSubscriptionDialogModule { }\n","<div mat-dialog-title>\n  {{ settings.title }}\n</div>\n\n<div class=\"copy\" mat-dialog-content>    \n  <textarea\n    #copyField\n    class=\"copy__input\"\n    [value]=\"settings.copyText\"\n    [rows]=\"rowCount\">\n  </textarea>\n</div>\n\n<div mat-dialog-actions>\n  <button app-button buttonTheme=\"light\" (click)=\"handleCancelClick()\">Cancel</button>\n  <button app-button buttonType=\"primary\" (click)=\"handleCopyClick()\">Copy to Clipboard</button>\n</div>","import { Component, OnInit, Inject, ViewChild, ElementRef, AfterViewInit, ChangeDetectionStrategy } from '@angular/core';\nimport { MAT_DIALOG_DATA, MatDialogRef } from '@angular/material/dialog';\nimport { ClipboardService } from 'src/app/shared/clipboard.service';\n\nexport interface ClipboardDialogData {\n  title: string;\n  copyText: string;\n}\n\n@Component({\n  selector: 'app-clipboard-dialog',\n  templateUrl: './clipboard-dialog.component.html',\n  styleUrls: ['./clipboard-dialog.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class ClipboardDialogComponent implements OnInit, AfterViewInit {\n\n  settings: ClipboardDialogData = {\n    title: 'Copy to Clipboard',\n    copyText: ''\n  };\n\n  get rowCount(): number {\n    const rows = this.settings.copyText.split(/\\r?\\n/);\n    return rows.length + 1;\n  }\n\n  @ViewChild('copyField', { static: true })\n  copyField: ElementRef<HTMLTextAreaElement>;\n\n  constructor(\n    public dialogRef: MatDialogRef<ClipboardDialogComponent>,\n    @Inject(MAT_DIALOG_DATA) public data: ClipboardDialogData,\n    private clipboardService: ClipboardService\n  ) { \n    this.settings = {\n      ...this.settings,\n      ...data\n    };\n  }\n\n  ngOnInit() {\n  }\n\n  ngAfterViewInit() {\n    const input = this.copyField.nativeElement;\n    input.focus();\n    input.select();\n  }\n\n  handleCopyClick() {\n    const copied = this.clipboardService.copyInputFieldValue(this.copyField.nativeElement);\n    this.close(copied);\n  }\n\n  handleCancelClick() {\n    this.close(false);\n  }\n\n  close(copied: boolean) {\n    this.dialogRef.close(copied);\n  }\n\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { MaterialModule } from 'src/app/material.module';\nimport { SharedModule } from 'src/app/shared/shared.module';\nimport { ClipboardDialogComponent } from './clipboard-dialog.component';\n\n\n\n@NgModule({\n  declarations: [\n    ClipboardDialogComponent\n  ],\n  imports: [\n    CommonModule,\n    MaterialModule,\n    SharedModule\n  ],\n  exports: [\n    ClipboardDialogComponent\n  ],\n  entryComponents: [\n    ClipboardDialogComponent\n  ]\n})\nexport class ClipboardDialogModule { }\n","<h1 mat-dialog-title>\n  {{ settings.titleText }}\n</h1>\n\n<div mat-dialog-content class=\"pt-4 pb-6\">\n  <div class=\"text-14\">{{ settings.bodyText }}</div>\n</div>\n\n<div\n  mat-dialog-actions\n  class=\"dialog__actions pt-2\"\n  [class.dialog__actions--compact]=\"!settings.miscText\">\n\n  <button *ngIf=\"settings.miscText\" app-button buttonTheme=\"light\" [mat-dialog-close]>{{ settings.miscText }}</button>\n\n  <div>\n      <button *ngIf=\"settings.cancelEnabled\" class=\"mr-1\" app-button buttonTheme=\"light\" [mat-dialog-close]=\"false\">{{ settings.cancelText }}</button>\n      <button *ngIf=\"settings.confirmEnabled\" app-button buttonType=\"primary\" [mat-dialog-close]=\"true\" cdkFocusInitial>{{ settings.confirmText }}</button>\n  </div>\n\n</div>","import { Component, OnInit, Inject, ChangeDetectionStrategy } from '@angular/core';\nimport { MatDialogRef, MAT_DIALOG_DATA } from '@angular/material/dialog';\n\nexport interface ConfirmDialogData {\n  titleText?: string;\n  bodyText?: string;\n  confirmText?: string;\n  confirmEnabled?: boolean;\n  confirmColor?: 'primary' | 'warn';\n  cancelText?: string;\n  cancelEnabled?: boolean;\n  miscText?: string;\n}\n\n@Component({\n  selector: 'app-confirm-dialog',\n  templateUrl: './confirm-dialog.component.html',\n  styleUrls: ['./confirm-dialog.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class ConfirmDialogComponent implements OnInit {\n  settings = {\n    titleText: 'Confirm Action',\n    bodyText: '',\n    confirmText: 'Confirm',\n    confirmColor: 'primary',\n    cancelText: 'Cancel',\n    confirmEnabled: true,\n    cancelEnabled: true,\n    miscText: ''\n  };\n\n  constructor(\n    public dialogRef: MatDialogRef<ConfirmDialogComponent>,\n    @Inject(MAT_DIALOG_DATA) public data: ConfirmDialogData\n  ) {\n    if (data) {\n      this.settings = {\n        ...this.settings,\n        ...data\n      };\n    }\n  }\n\n  ngOnInit() {\n  }\n\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { MaterialModule } from 'src/app/material.module';\nimport { SharedModule } from 'src/app/shared/shared.module';\nimport { ConfirmDialogComponent } from './confirm-dialog.component';\n\n\n\n@NgModule({\n  declarations: [\n    ConfirmDialogComponent\n  ],\n  imports: [\n    CommonModule,\n    MaterialModule,\n    SharedModule\n  ],\n  exports: [\n    ConfirmDialogComponent\n  ],\n  entryComponents: [\n    ConfirmDialogComponent\n  ]\n})\nexport class ConfirmDialogModule { }\n","<div class=\"dialog\" [formGroup]=\"form\">\n\n    <!-- deleteing -->\n    <div *ngIf=\"deleting$ | async\" class=\"flex flex-column items-center\">\n        <app-spinner size=\"large\"></app-spinner>\n\n        <div class=\"mt-3 text-11\">Deleting your account...</div>\n    </div>\n\n    <!-- main interface -->\n    <div *ngIf=\"!(deleting$ | async)\">    \n\n        <div mat-dialog-title>\n            <div class=\"flex flex-row justify-between\">\n                <h1>Delete Account</h1>\n            \n                <button app-button buttonType=\"text\" buttonTheme=\"light\" type=\"button\" (click)=\"handleCancelClick()\" title=\"Close\" [attr.aria-label]=\"'Close'\">\n                    <app-icon icon=\"times\" size=\"lg\">\n                    </app-icon>\n                </button>\n            </div>\n        </div>\n\n        <mat-divider></mat-divider>\n\n        <!-- Content -->\n        <div class=\"theme-light\" class=\"text-14 mv-4 mb-9\">\n            \n            <!-- disclaimer: initial attempt -->\n            <div>\n\n                <div class=\"mb-6\">\n                    Are you sure you want to <em class=\"text-bold\">permanently delete</em> your account?\n                </div>\n\n                <ul class=\"dialog__list\">\n                    <li class=\"mv-2\">\n                        Deleting your BioDigital Human account is a permanent action and <em class=\"text-bold\">cannot be undone</em>.\n                    </li>\n                    <li class=\"mv-2\">\n                        After you delete your account, you will not be able to log back in to the app, and any 3D models you created and saved to your Dashboard will be removed from our database permanently and cannot be restored.\n                    </li>\n                </ul>\n\n                <div class=\"mt-4\">\n                    <mat-checkbox formControlName=\"confirm\">\n                        <span style=\"white-space: normal;\">I confirm I want to permanently delete my account.</span>\n                    </mat-checkbox>\n                </div>                \n\n            </div>\n\n            <!-- error -->\n            <div *ngIf=\"error\" class=\"mt-1\">\n\n                <app-message-toggle type=\"error\" icon=\"info\">\n                    <em class=\"text-bold\">Server Error.</em> {{ error }}\n                </app-message-toggle>\n\n            </div>\n\n        </div>\n\n        <!-- Actions -->\n        <div mat-dialog-actions>\n\n            <!-- actions -->\n            <div class=\"flex justify-end\">\n                <button\n                    app-button\n                    buttonTheme=\"light\"\n                    buttonType=\"default\"\n                    class=\"mr-2\"\n                    (click)=\"handleCancelClick()\">Cancel</button>\n\n                <button\n                    app-button\n                    buttonType=\"primary\"\n                    (click)=\"handleDeleteClick()\"\n                    [disabled]=\"form.invalid\">\n                    {{ attempts > 0 ? 'Try Again' : 'Yes, Delete Account' }}\n                </button>\n            </div>\n\n        </div>\n\n    </div>\n\n</div>","import { ChangeDetectionStrategy, ChangeDetectorRef, Component, OnDestroy, OnInit, Renderer2 } from '@angular/core';\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\nimport { MatDialogRef } from '@angular/material';\nimport { Actions, ofActionDispatched, Select, Store } from '@ngxs/store';\nimport { Observable, Subject } from 'rxjs';\nimport { takeUntil } from 'rxjs/operators';\nimport { UserProfileModel } from 'src/app/auth/models/user-profile.model';\nimport {\n  DeleteUserProfile,\n  DeleteUserProfileFailure,\n  DeleteUserProfileSuccess,\n  Logout,\n  LogoutSuccess,\n  LogoutFailure\n} from 'src/app/auth/state/auth/auth.actions';\nimport { AuthState } from 'src/app/auth/state/auth/auth.state';\nimport { parseErrorMessage } from 'src/app/account/utils/account-error-utils';\n\nconst defaultErrorMessage = 'There was an error deleting your account.';\n\n@Component({\n  selector: 'app-delete-account-dialog',\n  templateUrl: './delete-account-dialog.component.html',\n  styleUrls: ['./delete-account-dialog.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class DeleteAccountDialogComponent implements OnInit, OnDestroy {\n\n  @Select(AuthState.getUserProfile)\n  userProfile$: Observable<UserProfileModel>;\n\n  @Select(AuthState.getProfileDeleting)\n  deleting$: Observable<boolean>;\n\n  // state\n  error = '';\n  attempts = 0;\n\n  form: FormGroup;\n\n  private ngUnsubscribe = new Subject();\n\n  constructor(\n    private store: Store,\n    private actions: Actions,\n    private formBuilder: FormBuilder,\n    private dialogRef: MatDialogRef<DeleteAccountDialogComponent>,\n    private changeRef: ChangeDetectorRef\n  ) { }\n\n  ngOnInit() {\n    this.initForm();\n    this.initListeners();\n  }\n\n  ngOnDestroy() {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n\n    // cleanup UI\n    this.setDialogTransparent(false);\n  }\n\n  initForm() {\n    this.form = this.formBuilder.group({\n      'confirm': [false, Validators.requiredTrue]\n    });\n  }\n\n  initListeners() {\n    // deleting\n    this.deleting$\n      .pipe(\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe((deleting) => {\n        // mark attempts\n        if (deleting) {\n          this.error = '';\n          this.attempts++;\n        }\n\n        // set UI state\n        this.setDialogTransparent(deleting);\n\n        this.changeRef.markForCheck();\n      });\n\n    // success -> logout\n    this.actions\n      .pipe(\n        ofActionDispatched(DeleteUserProfileSuccess),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(() => {\n        this.store.dispatch(new Logout());\n      });\n\n    // TODO: logging out always trigger 401 error code, i.e., LogoutFailure, investigate\n    this.actions\n      .pipe(\n        ofActionDispatched(LogoutSuccess, LogoutFailure),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(() => {\n        this.redirectOnLogout();\n        this.dialogRef.close();\n      });\n\n    // failure\n    this.actions\n      .pipe(\n        ofActionDispatched(DeleteUserProfileFailure),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe((action: DeleteUserProfileFailure) => {\n        this.error = parseErrorMessage(action.error) || defaultErrorMessage;\n        this.changeRef.markForCheck();\n      });\n  }\n\n  handleCancelClick() {\n    this.dialogRef.close();\n  }\n\n  handleDeleteClick() {\n    this.store.dispatch(new DeleteUserProfile());\n  }\n\n  redirectOnLogout() {\n    // hard reload\n    window.location.href = '/login';\n  }\n\n  private setDialogTransparent(transparent: boolean) {\n    this.dialogRef.removePanelClass('transparent');\n    if (transparent) {\n      this.dialogRef.addPanelClass('transparent');\n    }\n  }\n\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { MaterialModule } from 'src/app/material.module';\nimport { SharedModule } from 'src/app/shared/shared.module';\nimport { ReactiveFormsModule } from '@angular/forms';\nimport { DeleteAccountDialogComponent } from './delete-account-dialog.component';\n\n@NgModule({\n  declarations: [\n    DeleteAccountDialogComponent\n  ],\n  imports: [\n    CommonModule,\n    MaterialModule,\n    SharedModule,\n    ReactiveFormsModule\n  ],\n  exports: [\n    DeleteAccountDialogComponent\n  ],\n  entryComponents: [\n    DeleteAccountDialogComponent\n  ]\n})\nexport class DeleteAccountDialogModule { }\n","<div class=\"welcome\">\n\n  <button app-button buttonType=\"text\" buttonTheme=\"light\" type=\"button\" (click)=\"handleCancelClick()\" title=\"Close\" [attr.aria-label]=\"'Close'\" class=\"welcome__close\">\n    <app-icon icon=\"times\" size=\"lg\">\n    </app-icon>\n  </button>\n\n  <img\n    class=\"welcome__image m-4\" \n    *ngIf=\"organization.group_logos.default\" \n    [src]=\"organization.group_logos.default\">\n\n  <div class=\"m-4 text-18 text-bold\">\n    Join the {{ organization.name }} Team!\n  </div>\n\n  <div class=\"m-4 text-14\">\n    Unlock access to all of our premium models, unlimited model storage, and a shared workspace for collaborating with your team!\n  </div>\n\n  <div class=\"welcome__actions\" mat-dialog-actions>\n\n    <button\n      class=\"welcome__button\"\n      app-button\n      buttonType=\"primary\"\n      cdkFocusInitial\n      (click)=\"handleJoinClick()\">\n        Join Group\n    </button>\n\n    <button\n      class=\"welcome__button welcome__cancel\"\n      app-button\n      buttonType=\"text\"\n      buttonTheme=\"light\"\n      (click)=\"handleCancelClick()\">\n        Maybe later\n    </button>\n\n  </div>\n\n</div>","import { Component, OnInit, Inject, ChangeDetectionStrategy, OnDestroy } from '@angular/core';\nimport { MatDialogRef, MAT_DIALOG_DATA } from '@angular/material/dialog';\nimport { MatSnackBar } from '@angular/material/snack-bar';\nimport { OrganizationModel } from 'src/app/organizations/models/organization.model';\nimport { ofActionDispatched, Actions, Store } from '@ngxs/store';\nimport { takeUntil } from 'rxjs/operators';\nimport { Subject } from 'rxjs';\nimport { JoinOrganizationSuccess, JoinOrganizationFail, JoinOrganization } from 'src/app/organizations/state/organizations.actions';\n\nexport interface DomainJoinDialogData {\n  organization: OrganizationModel;\n}\n\n@Component({\n  selector: 'app-domain-join-dialog',\n  templateUrl: './domain-join-dialog.component.html',\n  styleUrls: ['./domain-join-dialog.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class DomainJoinDialogComponent implements OnInit, OnDestroy {\n\n  private ngUnsubscribe = new Subject();\n  organization: OrganizationModel;\n\n  constructor(\n    private store: Store,\n    private dialogRef: MatDialogRef<DomainJoinDialogComponent>,\n    @Inject(MAT_DIALOG_DATA) private data: DomainJoinDialogData,\n    private actions: Actions,\n    private snackBar: MatSnackBar\n  ) {\n    this.organization = data.organization;\n  }\n\n  ngOnInit() {\n    // join organization success\n    this.actions\n      .pipe(\n        ofActionDispatched(JoinOrganizationSuccess),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(({ organization }) => {\n        this.handleJoinSuccess(organization);\n      });\n\n    // join organization failure\n    this.actions\n      .pipe(\n        ofActionDispatched(JoinOrganizationFail),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(({ organization }) => {\n        this.handleJoinFail(organization);\n      });\n  }\n\n  ngOnDestroy() {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n  handleCancelClick() {\n   this.close(false);\n  }\n\n  handleJoinClick() {\n    this.join();\n  }\n\n  handleJoinSuccess(organization: OrganizationModel) {\n    this.snackBar.open(`Successfully joined \"${organization.name}\".`);\n    this.close(true);\n  }\n\n  handleJoinFail(organization: OrganizationModel) {\n    this.snackBar.open(`There was an error joining \"${organization.name}\".`);\n  }\n\n  join() {\n    this.store.dispatch(new JoinOrganization(this.organization));\n  }\n\n  close(joined: boolean) {\n    // close dialog\n    this.dialogRef.close(joined);\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { MaterialModule } from 'src/app/material.module';\nimport { SharedModule } from 'src/app/shared/shared.module';\nimport { DomainJoinDialogComponent } from './domain-join-dialog.component';\n\n\n\n@NgModule({\n  declarations: [\n    DomainJoinDialogComponent\n  ],\n  imports: [\n    CommonModule,\n    MaterialModule,\n    SharedModule\n  ],\n  exports: [\n    DomainJoinDialogComponent\n  ],\n  entryComponents: [\n    DomainJoinDialogComponent\n  ]\n})\nexport class DomainJoinDialogModule { }\n","<h1 mat-dialog-title>\n  Oh no, you have no access to the <br>{{ organizationName }} group!\n</h1>\n\n<div mat-dialog-content class=\"pt-4 pb-6\">\n  <div class=\"text-14\" *ngIf=\"ip\">\n    You must be within the {{ organizationName }} network to access this group account. <a [href]=\"'mailto:' + supportEmail\">Contact us</a> if you have any questions regarding your group account.\n  </div>\n\n  <div class=\"text-14\" *ngIf=\"email\">\n    You must be within the {{ organizationName }} network to access this group account. <a [href]=\"'mailto:' + supportEmail\">Contact us</a> if you have any questions regarding your group account.\n  </div>\n</div>\n\n<div mat-dialog-actions class=\"pt-2\">\n  <button app-button buttonTheme=\"light\" buttonType=\"outline\" (click)=\"handleDontShowClick()\">Don't show me this again</button>\n  <button app-button buttonType=\"primary\" [mat-dialog-close]=\"true\" cdkFocusInitial>Close</button>\n</div>","import { Component, OnInit, Inject, ChangeDetectionStrategy } from '@angular/core';\nimport { MatDialogRef, MAT_DIALOG_DATA } from '@angular/material/dialog';\nimport { environment } from 'src/environments/environment';\nimport { StorageService, StorageItemEnum } from 'src/app/shared/storage.service';\n\nexport interface GroupRestrictionDialogData {\n  organizationName: string;\n  email: boolean;\n  ip: boolean;\n}\n\n@Component({\n  selector: 'app-group-restriction-dialog',\n  templateUrl: './group-restriction-dialog.component.html',\n  styleUrls: ['./group-restriction-dialog.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class GroupRestrictionDialogComponent implements OnInit {\n  organizationName: string;\n  email = false;\n  ip = false;\n  supportEmail = environment.supportEmail;\n\n  constructor(\n    private dialogRef: MatDialogRef<GroupRestrictionDialogComponent>,\n    @Inject(MAT_DIALOG_DATA) private data: GroupRestrictionDialogData,\n    private storageService: StorageService\n  ) { \n    this.organizationName = data.organizationName;\n    this.email = data.email;\n    this.ip = data.ip;\n  }\n\n  ngOnInit() { }\n\n  handleDontShowClick() {\n    const groupAccess = this.storageService.getLocalJSON(StorageItemEnum.GroupRestriction) || {};\n    groupAccess.dontShowDialog = true;\n    this.storageService.setLocalItem(StorageItemEnum.GroupRestriction, groupAccess);\n    this.dialogRef.close();\n  }\n\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { MaterialModule } from 'src/app/material.module';\nimport { SharedModule } from 'src/app/shared/shared.module';\nimport { GroupRestrictionDialogComponent } from './group-restriction-dialog.component';\n\n\n\n@NgModule({\n  declarations: [\n    GroupRestrictionDialogComponent\n  ],\n  imports: [\n    CommonModule,\n    MaterialModule,\n    SharedModule\n  ],\n  exports: [\n    GroupRestrictionDialogComponent\n  ],\n  entryComponents: [\n    GroupRestrictionDialogComponent\n  ]\n})\nexport class GroupRestrictionDialogModule { }\n","<div class=\"dialog\" (click)=\"handleCloseClick()\">\n\n    <!-- laoding -->\n    <div *ngIf=\"!imageLoaded\" class=\"dialog__loading flex flex-column p-8\">\n        <app-spinner size=\"huge\">\n        </app-spinner>\n    </div>\n\n    <!-- image -->\n    <img class=\"dialog__image\" [src]=\"config.src\" [title]=\"config.title || ''\" [alt]=\"config.alt || ''\" (load)=\"handleImageLoaded()\">\n    \n    <button\n        class=\"dialog__close\"\n        app-pin-button\n        buttonType=\"dark\"\n        size=\"large\"\n        icon=\"times\"\n        aria-label=\"Close\"\n        matTooltip=\"Close\"\n        matTooltipPosition=\"left\">\n    </button>\n\n</div>","import { ChangeDetectionStrategy, ChangeDetectorRef, Component, Inject, OnInit } from '@angular/core';\nimport { MatDialogRef, MAT_DIALOG_DATA } from '@angular/material';\n\nexport interface ImageDialogData {\n  src: string;\n  title?: string;\n  alt?: string;\n}\n\n@Component({\n  selector: 'app-image-dialog',\n  templateUrl: './image-dialog.component.html',\n  styleUrls: ['./image-dialog.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class ImageDialogComponent implements OnInit {\n\n  config: ImageDialogData;\n\n  imageLoaded: boolean;\n\n  constructor(\n    private dialogRef: MatDialogRef<ImageDialogComponent>,\n    @Inject(MAT_DIALOG_DATA) private data: ImageDialogData,\n    private changeRef: ChangeDetectorRef\n  ) {\n    this.config = data;\n  }\n\n  ngOnInit() {\n  }\n\n  handleCloseClick() {\n    this.dialogRef.close();\n  }\n\n  handleImageLoaded() {\n    this.imageLoaded = true;\n    this.changeRef.markForCheck();\n  }\n\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { MaterialModule } from 'src/app/material.module';\nimport { SharedModule } from 'src/app/shared/shared.module';\nimport { ImageDialogComponent } from './image-dialog.component';\n\n@NgModule({\n  declarations: [\n    ImageDialogComponent\n  ],\n  imports: [\n    CommonModule,\n    MaterialModule,\n    SharedModule\n  ],\n  exports: [\n    ImageDialogComponent\n  ],\n  entryComponents: [\n    ImageDialogComponent\n  ]\n})\nexport class ImageDialogModule { }\n","<div class=\"import\">\n    <div class=\"text-20 import__header\">\n        Import Chapters\n    </div>\n\n    <div class=\"import__body\">\n        <app-gallery-container\n            [application]=\"application\"\n            [contentType]=\"contentType\"\n            [showSourcePicker]=\"true\"\n            (selectBookmark)=\"handleSelect($event)\"\n            selectLabel=\"Import\"\n        ></app-gallery-container>\n    </div>\n\n</div>\n","import { Component, OnInit, OnDestroy, ChangeDetectionStrategy, ChangeDetectorRef } from '@angular/core';\nimport { Store, Select } from '@ngxs/store';\nimport { GalleryActions } from 'src/app/gallery/state/gallery.actions';\nimport { MatDialogRef } from '@angular/material';\nimport { GalleryState } from 'src/app/gallery/state/gallery.state';\nimport { Observable, Subject } from 'rxjs';\nimport { GalleryViewMode } from 'src/app/gallery/models/gallery-view-mode.enum';\nimport { BookmarkModel } from 'src/app/bookmarks/models/bookmark.model';\nimport { AuthState } from 'src/app/auth/state/auth/auth.state';\nimport { UserProfileModel } from 'src/app/auth/models/user-profile.model';\nimport { DialogActions } from '../../state/dialog.actions';\nimport { GalleryResultsModel } from 'src/app/gallery/models/gallery-results.model';\nimport { EnvironmentApplication } from 'src/environments/models/environment-application';\nimport { ContentType } from 'src/app/story/models/content-type.enum';\nimport { CategorySearchConfig, SearchConfigUnion, LoftSearchConfig } from 'src/app/gallery/models/search-config';\nimport { SearchOptions } from 'src/app/gallery/models/search-options';\nimport { bookmarkSortTitleAsc } from 'src/app/bookmarks/data/bookmark-sort';\nimport { SearchType } from 'src/app/gallery/models/search-type.enum';\nimport { Content } from '@angular/compiler/src/render3/r3_ast';\nimport { takeUntil, distinctUntilChanged } from 'rxjs/operators';\nimport { isEqual } from 'lodash';\nimport { environment } from 'src/environments/environment';\n\n@Component({\n  selector: 'app-import-model-dialog',\n  templateUrl: './import-model-dialog.component.html',\n  styleUrls: ['./import-model-dialog.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class ImportModelDialogComponent implements OnInit, OnDestroy {\n  application = environment.application;\n  contentType = ContentType.Module;\n\n\n  @Select(GalleryState.getViewMode)\n  viewMode$: Observable<GalleryViewMode>;\n\n  @Select(GalleryState.getLoading)\n  loading$: Observable<boolean>;\n\n  @Select(GalleryState.getFilteredResults)\n  results$: Observable<GalleryResultsModel>;\n\n  @Select(GalleryState.getSearchConfig)\n  searchConfig$: Observable<SearchConfigUnion>;\n\n  @Select(AuthState.isPremiumUser)\n  isPremiumUser$: Observable<boolean>;\n\n  ngUnsubscribe = new Subject();\n\n  constructor(\n    private store: Store,\n    private dialogRef: MatDialogRef<ImportModelDialogComponent>,\n    private changeDetectorRef: ChangeDetectorRef\n  ) { }\n\n  ngOnInit() {\n    this.initGallery();    \n    this.observeSearchConfig();\n  }\n\n  ngOnDestroy() {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n  initGallery() {\n    const config = this.store.selectSnapshot(GalleryState.getSearchConfig) || \n      environment.application === EnvironmentApplication.Studio ? \n        new CategorySearchConfig('all') : \n        new LoftSearchConfig('production', 'maleAdult');\n        \n    const options = this.store.selectSnapshot(GalleryState.getSearchOptions) || new SearchOptions('', bookmarkSortTitleAsc);\n\n    this.store.dispatch(new GalleryActions.SetCardActions({ enabled: false }));\n    this.store.dispatch(new GalleryActions.SetBulkActions({ enabled: false, items: [] }));\n    this.store.dispatch(new GalleryActions.SetSearchConfig(config));\n    this.store.dispatch(new GalleryActions.SetSearchOptions(options));\n  }\n\n  observeSearchConfig() {\n    this.searchConfig$.pipe(\n      distinctUntilChanged((a, b) => isEqual(a, b)),\n      takeUntil(this.ngUnsubscribe)\n    ).subscribe(config => {\n      this.contentType = config.type === SearchType.Category ? ContentType.Module : ContentType.Bookmark;\n      this.changeDetectorRef.markForCheck();\n    });\n  }\n\n  handleSelect(bookmark: BookmarkModel) {\n    if (!bookmark.premium || this.store.selectSnapshot(AuthState.isPremiumUser)) {\n      this.store.dispatch(new GalleryActions.SelectBookmark(bookmark));\n      this.dialogRef.close(bookmark);\n    } else {\n      this.store.dispatch(new DialogActions.OpenPremiumContent());\n    }\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { ReactiveFormsModule } from '@angular/forms';\nimport { ImportModelDialogComponent } from './import-model-dialog.component';\nimport { MaterialModule } from 'src/app/material.module';\nimport { SharedModule } from 'src/app/shared/shared.module';\nimport { GalleryModule } from 'src/app/gallery/gallery.module';\n\n\n\n@NgModule({\n  imports: [\n    CommonModule,\n    MaterialModule,\n    SharedModule,\n    ReactiveFormsModule,\n    GalleryModule\n  ],\n  declarations: [\n    ImportModelDialogComponent\n  ],\n  exports: [\n    ImportModelDialogComponent\n  ],\n  entryComponents: [\n    ImportModelDialogComponent\n  ]\n})\nexport class ImportModelDialogModule { }\n","<div class=\"modal\">\n\n  <button app-button buttonType=\"text\" buttonTheme=\"light\" type=\"button\" (click)=\"closeDialog()\" title=\"Close\" [attr.aria-label]=\"'Close'\" class=\"modal__close\">\n    <app-icon icon=\"times\" size=\"lg\">\n    </app-icon>\n  </button>\n\n  <div\n    class=\"modal__contents\"\n    [style.height]=\"height + 'px'\">\n\n    <iframe\n      *ngIf=\"src\"\n      [src]=\"src\"\n      class=\"modal__frame\">\n    </iframe>\n\n  </div>\n\n</div> ","import { Component, OnInit, Inject, ChangeDetectionStrategy, ElementRef, ViewChild } from '@angular/core';\nimport { MAT_DIALOG_DATA, MatDialogRef } from '@angular/material/dialog';\nimport { SafeResourceUrl, DomSanitizer } from '@angular/platform-browser';\nimport { ScreenDimensions } from 'src/app/shared/models/screen.dimensions.model';\n\nexport enum LegacyDialogEnum {\n  UpgradeSubscription = '/legacy/upgrade-human.html',\n  BuySubscription = '/legacy/buy-subscription.html',\n  MyProfile = '/legacy/user-account.html'\n}\n\nexport interface LegacyDialogData {\n  type: LegacyDialogEnum;\n  dimensions: ScreenDimensions;\n  options?: any;\n}\n\n@Component({\n  selector: 'app-legacy-dialog',\n  templateUrl: './legacy-dialog.component.html',\n  styleUrls: ['./legacy-dialog.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class LegacyDialogComponent implements OnInit {\n\n  headerOffset = 100;\n\n  settings: LegacyDialogData = {\n    type: null,\n    dimensions: {\n      width: 100,\n      height: 100\n    }\n  };\n\n  get height(): number {\n    const { height } = this.settings.dimensions;\n    const targetHeight = height - this.headerOffset;\n    return Math.max(200, targetHeight);\n  }\n\n  get src(): SafeResourceUrl {\n    const url = this.getURL();\n    if (url) {\n      return this.sanitizer.bypassSecurityTrustResourceUrl(url);\n    } else {\n      return null;\n    }\n  }\n\n  constructor(\n    private dialogRef: MatDialogRef<LegacyDialogComponent>,\n    @Inject(MAT_DIALOG_DATA) private data: LegacyDialogData,\n    private sanitizer: DomSanitizer\n  ) {\n    this.settings = {\n      ...this.settings,\n      ...data\n    };\n    const { width, height} = data.dimensions;\n    // size modal\n    this.dialogRef.updateSize(`${width}px`, `${height}px`);\n  }\n\n  ngOnInit() {\n    \n  }\n\n  closeDialog() {\n    this.dialogRef.close();\n  }\n\n  // get modal url\n  private getURL(): string {\n    const url = `${this.settings.type}`;\n    const valid = Object.values(LegacyDialogEnum).includes(url);\n    if (valid) {\n      const urlParams = this.getURLParams();\n      if (urlParams) {\n        return `${url}?${urlParams}`;\n      } else {\n        return url;\n      }\n    } else {\n      return '';\n    }\n  }\n\n  // get optional url params\n  private getURLParams(): string {\n    const options = this.settings.options;\n    if (options) {\n      return Object.entries(options)\n        .map(([key, value]) => {\n          return `${key}=${value}`;\n        })\n        .join('&');\n    } else {\n      return '';\n    }\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { MaterialModule } from 'src/app/material.module';\nimport { SharedModule } from 'src/app/shared/shared.module';\nimport { LegacyDialogComponent } from './legacy-dialog.component';\n\n\n\n@NgModule({\n  declarations: [\n    LegacyDialogComponent\n  ],\n  imports: [\n    CommonModule,\n    MaterialModule,\n    SharedModule\n  ],\n  exports: [\n    LegacyDialogComponent\n  ],\n  entryComponents: [\n    LegacyDialogComponent\n  ]\n})\nexport class LegacyDialogModule { }\n","<h1 mat-dialog-title>\n  New Bookmark Limit Reached\n</h1>\n    \n<div mat-dialog-content class=\"pt-1 pb-6\">\n  <div class=\"text-14 pb-3\">You've reached your limit of 5 3D models in your dashboard. You can make changes to this model, but you will not be able to save as a new model.</div>\n  <div class=\"text-14\">Upgrade to a Premium Plan to save unlimited 3D models.</div>\n</div>\n\n<div mat-dialog-actions class=\"pt-2\">\n  <button app-button buttonTheme=\"light\" [mat-dialog-close]=\"false\" cdkFocusInitial class=\"mr-2\">OK</button>\n  <button app-button buttonType=\"primary\" [mat-dialog-close]=\"true\">Go Premium</button>\n</div>","import { Component, OnInit, ChangeDetectionStrategy, Inject, forwardRef } from '@angular/core';\n\n@Component({\n  selector: 'app-limit-dialog',\n  templateUrl: './limit-dialog.component.html',\n  styleUrls: ['./limit-dialog.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class LimitDialogComponent implements OnInit {\n  constructor(\n  ) { }\n\n  ngOnInit() {\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { MaterialModule } from 'src/app/material.module';\nimport { SharedModule } from 'src/app/shared/shared.module';\nimport { LimitDialogComponent } from './limit-dialog.component';\n\n\n\n@NgModule({\n  declarations: [\n    LimitDialogComponent\n  ],\n  imports: [\n    CommonModule,\n    MaterialModule,\n    SharedModule\n  ],\n  exports: [\n    LimitDialogComponent\n  ],\n  entryComponents: [\n    LimitDialogComponent\n  ]\n})\nexport class LimitDialogModule { }\n","<div class=\"survey\">\n\n    <button app-button buttonType=\"text\" buttonTheme=\"light\" type=\"button\" (click)=\"closeDialog()\" title=\"Close\" [attr.aria-label]=\"'Close'\" class=\"survey__close mb-2\">\n      <app-icon icon=\"times\" size=\"lg\">\n      </app-icon>\n    </button>\n\n    <iframe [src]=\"src\" class=\"survey__frame\"></iframe>\n</div>\n","import { Component, OnInit, Inject, ChangeDetectionStrategy } from '@angular/core';\nimport { MatDialogRef, MAT_DIALOG_DATA } from '@angular/material/dialog';\nimport { SafeResourceUrl, DomSanitizer } from '@angular/platform-browser';\nimport { Store } from '@ngxs/store';\nimport { AuthState } from 'src/app/auth/state/auth/auth.state';\n\nconst npsSurveyLink = 'https://www.research.net/r/BKTXJMC';\n\nexport interface NpsDialogData {\n  surveyGroupName?: string;\n  surveyEmail?: string;\n}\n\n@Component({\n  selector: 'app-nps-dialog',\n  templateUrl: './nps-dialog.component.html',\n  styleUrls: ['./nps-dialog.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class NpsDialogComponent implements OnInit {\n\n  settings: NpsDialogData;\n\n  get src(): SafeResourceUrl {\n    // generate url w/ params\n    const { surveyGroupName, surveyEmail } = this.settings;\n\n    const url = `${npsSurveyLink}?Org=${surveyGroupName}&Email=${surveyEmail}`;\n    return this.sanitizer.bypassSecurityTrustResourceUrl(url);\n  }\n\n  constructor(\n    private store: Store,\n    private dialogRef: MatDialogRef<NpsDialogComponent>,\n    @Inject(MAT_DIALOG_DATA) private data: NpsDialogData,\n    private sanitizer: DomSanitizer\n  ) {\n    const profile = this.store.selectSnapshot(AuthState.getUserProfile);\n    this.settings = {\n      surveyEmail: profile ? profile.email : '',\n      ...this.data\n    };\n  }\n\n  ngOnInit() {\n  }\n\n  closeDialog() {\n    this.dialogRef.close();\n  }\n\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { SharedModule } from 'src/app/shared/shared.module';\n\nimport { NpsDialogComponent } from './nps-dialog.component';\nimport { MaterialModule } from 'src/app/material.module';\n\n\n@NgModule({\n  imports: [\n    CommonModule,\n    MaterialModule,\n    SharedModule\n  ],\n  declarations: [\n    NpsDialogComponent \n  ],\n  exports: [\n    NpsDialogComponent\n  ],\n  entryComponents: [\n    NpsDialogComponent\n  ]\n})\nexport class NpsDialogModule { }\n","<div class=\"save\">\n\n  <form [formGroup]=\"form\" (submit)=\"handleSubmit()\">\n\n    <h1 mat-dialog-title>\n      {{ dialogTitle }}\n    </h1>\n\n    <p *ngIf=\"settings.message\" class=\"save__message\">\n      {{ settings.message }}\n    </p>\n      \n    <div mat-dialog-content>\n      <div class=\"theme-light\">\n\n        <!-- info -->\n        <app-form-field theme=\"light\" label=\"Title\">\n          <input class=\"input\" type=\"text\" name=\"title\" maxlength=\"60\" #title autocomplete=\"off\" formControlName=\"title\" required>\n          <app-character-counter [field]=\"title\"></app-character-counter>\n          <mat-error *ngIf=\"!form.get('title').valid\">Please enter a valid title.</mat-error>\n        </app-form-field>\n\n        <!-- only for group users -->\n        <div *ngIf=\"organization$ | async\">\n\n          <!-- permission -->\n          <app-form-field            \n                *ngIf=\"isNew || isOwner\"\n                theme=\"light\"\n                label=\"Permissions\">\n\n                <mat-radio-group class=\"save__radio-group text-12 mt-2\" formControlName=\"groupAccess\">\n                  <mat-radio-button value=\"\" class=\"mb-2\">Private</mat-radio-button>\n                  <mat-radio-button value=\"view\" class=\"mb-2\">Team - View Only</mat-radio-button>\n                  <mat-radio-button value=\"edit\">Team - View & Edit</mat-radio-button>\n                </mat-radio-group>\n\n          </app-form-field>\n\n          <!-- collection -->\n          <app-form-field theme=\"light\" *ngIf=\"(collections$ | async)?.length > 0\" label=\"Collection (Optional)\">\n\n            <select class=\"input\" formControlName=\"collection\">\n              <option [value]=\"null\">--</option>\n              <option *ngFor=\"let collection of collections$ | async\" [value]=\"collection.collection_id\">\n                {{ collection.collection_name }}\n              </option>\n            </select>\n            \n          </app-form-field>\n\n        </div>\n\n        <!-- public bookmarks -->\n        <div *ngIf=\"!(organization$ | async)\">\n           \n          <app-form-field            \n            theme=\"light\"\n            label=\"Share\">\n       \n            <mat-checkbox class=\"save__permission\" formControlName=\"publicAccess\">\n              <span class=\"text-12\">With the BioDigital Community</span>\n            </mat-checkbox>\n\n          </app-form-field>\n        </div>\n\n      </div>\n\n    </div>\n      \n    <!-- actions -->\n    <div mat-dialog-actions>\n\n      <button app-button buttonTheme=\"light\" [mat-dialog-close] type=\"button\" class=\"mr-2\">Cancel</button>\n      <button app-button buttonType=\"primary\" cdkFocusInitial [disabled]=\"saving$ | async\">\n          {{ (saving$ | async) ? 'Saving' : 'Save' }}\n          <app-spinner *ngIf=\"saving$ | async\" size=\"medium\" class=\"ml-2\" render=\"inline\"></app-spinner>\n      </button>\n\n    </div>\n\n  </form>\n\n</div>","import { Component, OnInit, Inject, ChangeDetectionStrategy, OnDestroy } from '@angular/core';\nimport { MatDialogRef, MAT_DIALOG_DATA } from '@angular/material/dialog';\nimport { MatSnackBar } from '@angular/material/snack-bar';\nimport { BookmarkModel } from 'src/app/bookmarks/models/bookmark.model';\nimport { Select, Store, Actions, ofActionDispatched } from '@ngxs/store';\nimport { OrganizationsState } from 'src/app/organizations/state/organizations.state';\nimport { Observable, Subject, combineLatest, of } from 'rxjs';\nimport { OrganizationModel } from 'src/app/organizations/models/organization.model';\nimport { CollectionModel } from 'src/app/organizations/models/collection.model';\nimport { FormGroup, FormBuilder, Validators } from '@angular/forms';\nimport { BookmarkGroupModel } from 'src/app/bookmarks/models/bookmark.group.model';\nimport { SaveBookmark, SaveBookmarkSuccess, SaveBookmarkFail } from 'src/app/bookmarks/state/bookmarks.actions';\nimport { OrganizationsService } from 'src/app/organizations/organizations.service';\nimport { map, debounceTime, take } from 'rxjs/operators';\nimport { takeUntil } from 'rxjs/operators';\nimport { BookmarkEntryModel } from 'src/app/bookmarks/models/bookmark.entry.model';\nimport { GetCollections } from 'src/app/organizations/state/organizations.actions';\nimport { BookmarksState } from 'src/app/bookmarks/state/bookmarks.state';\nimport { StoryService } from 'src/app/story/story.service';\nimport { BookmarksService } from 'src/app/bookmarks/bookmarks.service';\nimport { StoryModel } from 'src/app/story/models/story.model';\n\nexport enum SaveBookmarkDialogMode {\n  SaveStory,\n  Manage\n}\n\nexport interface SaveBookmarkDialogData {\n  bookmark?: BookmarkModel;\n  title?: string;\n  bookmarkTitle?: string;\n  message?: string;\n  mode?: SaveBookmarkDialogMode;\n}\n\n@Component({\n  selector: 'app-save-bookmark-dialog',\n  templateUrl: './save-bookmark-dialog.component.html',\n  styleUrls: ['./save-bookmark-dialog.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class SaveBookmarkDialogComponent implements OnInit, OnDestroy {\n\n  @Select(OrganizationsState.getOrganization)\n  organization$: Observable<OrganizationModel>;\n\n  @Select(OrganizationsState.getCollections)\n  collections$: Observable<CollectionModel[]>;\n\n  @Select(BookmarksState.getSaving)\n  saving$: Observable<boolean>;\n\n  get dialogTitle(): string {\n    return this.settings.title || (this.settings.mode === SaveBookmarkDialogMode.Manage ? 'Manage' : 'Save');\n  }\n\n  form: FormGroup;\n  saveDebounce = new Subject();\n\n  settings: SaveBookmarkDialogData = {\n    mode: SaveBookmarkDialogMode.SaveStory\n  };\n\n  isNew: boolean;\n  isOwner: boolean;\n\n  private currentCollection: CollectionModel;\n  private ngUnsubscribe = new Subject();\n\n  constructor(\n    private store: Store,\n    private fb: FormBuilder,\n    private dialogRef: MatDialogRef<SaveBookmarkDialogComponent>,\n    @Inject(MAT_DIALOG_DATA) private data: SaveBookmarkDialogData,\n    public snackBar: MatSnackBar,\n    private actions: Actions,\n    private organizationsService: OrganizationsService,\n    private storyService: StoryService\n  ) {\n    \n    this.settings = {\n      ...this.settings,\n      ...data\n    };\n\n    this.form = this.fb.group({\n      title: ['', [Validators.required, Validators.maxLength(60)]],\n      collection: [null],\n      groupAccess: [null],\n      publicAccess: [false]\n    });\n\n    // Listen for bookmark actions\n    this.actions\n      .pipe(\n        ofActionDispatched(SaveBookmarkSuccess),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe((response) => this.handleSaveSuccess(response));\n\n    this.actions\n      .pipe(\n        ofActionDispatched(SaveBookmarkFail),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe((response) => this.handleSaveFailure(response));\n\n    this.saveDebounce\n        .pipe(\n          debounceTime(100),\n          takeUntil(this.ngUnsubscribe)\n        )\n        .subscribe(() => {\n          this.saveBookmark();\n        });\n  }\n\n  ngOnInit() {\n    // populate group collections\n    const organization = this.store.selectSnapshot(OrganizationsState.getOrganization);\n    if (organization) {\n      this.store.dispatch(new GetCollections(organization.id));\n    }\n\n    // set form\n    const bookmark = this.settings.bookmark;\n    const title = bookmark ? bookmark.title : (this.settings.bookmarkTitle ? this.settings.bookmarkTitle : '');\n    \n    // group access state\n    const groupAccess = bookmark ? this.getGroupAccess(bookmark) : null;\n\n    let groupEdit = false;\n    let groupView = false;\n    if (groupAccess) { // set group access via data\n      groupEdit = groupAccess.member_edit;\n      groupView = !groupEdit && groupAccess.visible;\n    } else if (!bookmark && organization) { // default group users\n      groupEdit = false;\n      groupView = true;\n    }\n\n    // public access: non-group users\n    const publicAccess = !this.isGroupUser() && (bookmark && bookmark.tags.includes('public'));\n\n    this.form.patchValue({\n      title: title,\n      groupAccess: groupEdit ? 'edit' : (groupView ? 'view' : ''),\n      publicAccess: publicAccess\n    });\n\n    // set mode\n    this.isNew = true;\n    this.isOwner = true;\n    if (bookmark) {\n      if (bookmark.is_owner) {\n        this.isNew = false;\n        this.isOwner = true;\n      } else {\n        const isEditable = bookmark.group_access.some((access) => access.member_edit === true);\n        this.isNew = !isEditable;\n        this.isOwner = this.isNew;\n      }\n    }\n\n    // setup group access\n    this.initGroupAccess();\n    \n    // setup collections\n    this.initCollections();\n\n    // set group access\n    this.toggleGroupAccess(groupView, groupEdit);\n  }\n\n  ngOnDestroy() {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n  initGroupAccess() {\n    const groupAccessField = this.form.get('groupAccess');\n\n    // set collections: via group access\n    groupAccessField.valueChanges\n      .pipe(takeUntil(this.ngUnsubscribe))\n      .subscribe((groupAccess) => {\n        const groupView = groupAccess === 'view';\n        const groupEdit = groupAccess === 'edit';\n        this.toggleGroupAccess(groupView, groupEdit);\n      });\n  }\n\n  initCollections() {\n    const bookmark = this.settings.bookmark;\n    const formCollection = this.form.get('collection');\n    formCollection.disable();\n\n    const organization = this.store.selectSnapshot(OrganizationsState.getOrganization);\n    if (organization && bookmark) {\n      const collection$ = this.organizationsService.getCollectionsByContent(organization.id, {\n        content_type: bookmark.type,\n        content_id: bookmark.id\n      });\n\n      collection$\n        .pipe(\n          map((contentCollections) => contentCollections[0]),\n          takeUntil(this.ngUnsubscribe)\n        )\n        .subscribe((contentCollection) => {\n          this.currentCollection = contentCollection;\n          const currentCollectionId = this.currentCollection ? this.currentCollection.collection_id : null;\n          this.form.patchValue({\n            collection: currentCollectionId\n          });\n        });\n    }\n  }\n\n  toggleGroupAccess(groupView: boolean, groupEdit: boolean) {\n    const collection = this.form.get('collection');\n    const canEditCollections = this.isOwner || this.isNew;\n    const isGroupAccess = groupView || groupEdit;\n\n    // clear selection\n    if (!isGroupAccess) {\n      collection.setValue(null);\n    }\n    // set enabled state   \n    if (canEditCollections && isGroupAccess) {\n      collection.enable();\n    } else {\n      collection.disable();\n    }\n  }\n\n  handleSubmit() {\n    if (this.form.valid) {\n      this.saveDebounce.next();\n    }\n  }\n\n  saveBookmark() {\n    const bookmark = this.settings.bookmark;\n    const bookmarkEntry = this.getBookmarkEntry();\n    const includeIndex = this.settings.mode === SaveBookmarkDialogMode.SaveStory;\n\n    // manage: get story to sync displayName/title\n    const story$ = bookmark && bookmark.id && this.settings.mode === SaveBookmarkDialogMode.Manage\n      ? this.storyService.getStory(bookmark.id, bookmark.type)\n      : of(undefined);\n\n    story$\n      .pipe(\n        take(1),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe((story: StoryModel) => {\n        // update index (i.e., story data) w/ updated bookmark title \n        if (story && story.displayName !== bookmarkEntry.title) {\n          bookmarkEntry.index = {\n            ...story,\n            displayName: bookmarkEntry.title\n          };\n        }\n\n        // save/update bookmark\n        this.store.dispatch(new SaveBookmark(bookmarkEntry, false, includeIndex));\n      });\n  }\n  \n  handleSaveSuccess(response: SaveBookmarkSuccess) {\n    const bookmark = response.bookmark;\n    const message = this.settings.mode === SaveBookmarkDialogMode.Manage ?\n      `Your updates to \"${bookmark.title}\" have been saved to your dashboard.` :\n      `\"${bookmark.title}\" saved to your dashboard.`;\n\n    this.snackBar.open(message);\n    this.dialogRef.close(bookmark);\n  }\n\n  handleSaveFailure(response: SaveBookmarkFail) {\n    this.snackBar.open(`Unable to save bookmark \"${response.bookmarkEntry.title}\". Please try again.`);\n  }\n\n  private getBookmarkEntry(): BookmarkEntryModel {\n    const { bookmark } = this.settings;\n    const { title, collection, groupAccess, publicAccess } = this.form.value;\n    const groupView = groupAccess === 'view';\n    const groupEdit = groupAccess === 'edit';\n    const isPublicAccess = this.isGroupUser() ? null : publicAccess;\n\n    let addGroupAccess = [];\n    let removeGroupAccess = [];\n    let addCollection: CollectionModel;\n    let removeCollection: CollectionModel;\n\n    // owner: manage permissions + collections\n    if (this.isOwner) {\n      const groupAccessPermission = this.createGroupAccess(groupView, groupEdit);\n      if (groupAccessPermission) {\n        // set group access if selected\n        addGroupAccess = [groupAccessPermission];\n      } else {\n        // remove all existing access if none selected\n        removeGroupAccess = bookmark ? bookmark.group_access : [];\n      }\n\n      // handle collections\n      const collections = this.store.selectSnapshot(OrganizationsState.getCollections) || [];\n      const selectedCollectionId = parseInt(collection, 10);\n      const selectedCollection = collections.find((c) => c.collection_id === selectedCollectionId);\n\n      if (this.currentCollection) { // update collection\n        const isCurrentSelected = this.currentCollection.collection_id === selectedCollectionId;\n        if (!isCurrentSelected) { // only update when changing\n          addCollection = selectedCollection;\n          removeCollection = this.currentCollection;\n        }\n      } else if (selectedCollection) { // add optional collection\n        addCollection = selectedCollection;\n      }\n    }\n\n    return {\n      isOwner: bookmark ? bookmark.is_owner : true,\n      id: bookmark ? bookmark.id : null,\n      title: title,\n      add_group_access: addGroupAccess,\n      remove_group_access: removeGroupAccess,\n      addCollection: addCollection,\n      removeCollection: removeCollection,\n      public_access: isPublicAccess\n    };\n  }\n\n  private getGroupAccess(bookmark: BookmarkModel): BookmarkGroupModel {\n    const organization = this.store.selectSnapshot(OrganizationsState.getOrganization);\n    let groupAccess = null;\n    if (organization && bookmark.group_access) {\n      const organizationId = organization.id;\n      groupAccess = bookmark.group_access.find((bookmarkAccessLevel) => bookmarkAccessLevel.group_id === organizationId);\n    }\n    return groupAccess;\n  }\n\n  private createGroupAccess(groupView: boolean, groupEdit: boolean): BookmarkGroupModel {\n    const organization = this.store.selectSnapshot(OrganizationsState.getOrganization);\n    const isValidAccess = groupView || groupEdit;\n    if (organization && isValidAccess) {\n      return {\n        group_id: organization.id,\n        member_edit: groupEdit,\n        visible: groupView || groupEdit\n      };\n    } else {\n      return null;\n    }\n  }\n\n  private isGroupUser(): boolean {\n    return !!this.store.selectSnapshot(OrganizationsState.getOrganization);\n  }\n\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { ReactiveFormsModule } from '@angular/forms';\nimport { MaterialModule } from 'src/app/material.module';\nimport { SharedModule } from 'src/app/shared/shared.module';\n\nimport { SaveBookmarkDialogComponent } from './save-bookmark-dialog.component';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    MaterialModule,\n    SharedModule,\n    ReactiveFormsModule\n  ],\n  declarations: [\n    SaveBookmarkDialogComponent \n  ],\n  exports: [\n    SaveBookmarkDialogComponent\n  ],\n  entryComponents: [\n    SaveBookmarkDialogComponent\n  ]\n})\nexport class SaveBookmarkDialogModule { }\n","<!-- Title -->\n<h1 mat-dialog-title>\n  Save Module\n</h1>\n\n<!-- Content -->\n<div mat-dialog-content class=\"theme-light\">\n  <form [formGroup]=\"form\" (submit)=\"handleSubmit()\">\n    <!-- Duplicate States -->\n    <app-form-field>\n      <mat-checkbox data-test=\"duplicateStates\" formControlName=\"duplicateStates\"><span class=\"text-12\">Duplicate Content States</span></mat-checkbox>\n      \n      <div form-field-help>\n        This requires that you specify the location for the new module, and new unused names for each of the content states.\n      </div>\n    </app-form-field>\n    \n    <!-- Trim Graph -->\n    <app-form-field>\n      <mat-checkbox formControlName=\"trimShown\"><span class=\"text-12\">Trim Shown Objects</span></mat-checkbox>\n      <mat-checkbox formControlName=\"trimClipped\" class=\"ml-4\"><span class=\"text-12\">Trim Clipped Objects</span></mat-checkbox>\n      <div class=\"text-danger pt-2\" *ngIf=\"formTrimClipped.value\">\n        <app-icon icon=\"exclamation-circle\"></app-icon> \n        <span class=\"pl-2 text-12\">The scene graph will be trimmed using the clipping planes of the currently active chapter. Objects shared with other chapters will be lost. A page reload is recommended.</span>\n      </div>\n    </app-form-field>\n\n    <mat-divider class=\"mb-4\"></mat-divider>\n\n    <!-- Primary Category -->\n    <app-form-field label=\"Primary Category\">\n      <select data-test=\"primaryCategory\" class=\"input\" formControlName=\"primaryCategory\">\n        <option *ngFor=\"let category of (primaryCategoryOptions$ | async)\" [value]=\"category\">{{ category }}</option>\n      </select>\n    </app-form-field>\n\n    <!-- Secondary Category, can be empty -->\n    <app-form-field label=\"Secondary Category\" *ngIf=\"(secondaryCategoryOptions$ | async)?.length\">\n      <select data-test=\"secondaryCategory\" formControlName=\"secondaryCategory\" class=\"input\">\n        <option *ngFor=\"let category of (secondaryCategoryOptions$ | async)\" [value]=\"category\">{{ category }}</option>\n      </select>\n    </app-form-field>\n\n    <!-- Name -->\n    <app-form-field label=\"Name\">\n      <input data-test=\"moduleName\" type=\"text\" class=\"input w-100\" formControlName=\"name\" #name>\n      \n      <div class=\"pt-2 text-12\" *ngIf=\"modulePath && name.value.length\">\n        <!-- Module Exists -->\n        <div class=\"text-info\" *ngIf=\"moduleExists && !(formDuplicateStates.value)\">\n          <app-icon icon=\"exclamation-triangle\"></app-icon> \n          <span class=\"pl-2\">{{modulePath}}</span>\n          <span class=\"pl-2 text-bold\">(File exists)</span>\n        </div>\n\n        <!-- Module Exists AND cannot be overwritten -->\n        <div class=\"text-danger\" *ngIf=\"moduleExists && (formDuplicateStates.value)\">\n          <app-icon icon=\"exclamation-circle\"></app-icon> \n          <span class=\"pl-2\">{{modulePath}}</span>\n          <span class=\"pl-2 text-bold\">(File exists and cannot be overwritten)</span>\n        </div>\n\n        <!-- New Module -->\n        <div class=\"text-success\" *ngIf=\"!moduleExists\">\n          <app-icon icon=\"check-circle\"></app-icon>\n          <span class=\"pl-2\">{{modulePath}}</span>\n        </div>\n      </div>\n    </app-form-field>\n\n    <!-- Confirm Production -->\n    <app-form-field label=\"Production Save\" *ngIf=\"formPrimaryCategory.value === 'production'\">\n      <mat-checkbox formControlName=\"confirmProduction\"><span class=\"text-12\">I intend to save to Production</span></mat-checkbox>\n    </app-form-field>\n\n    <!-- Duplicate States -->\n    <div *ngIf=\"formDuplicateStates.value\">\n      <mat-divider class=\"mv-4\"></mat-divider>\n        \n      <!-- Prefix -->\n      <app-form-field label=\"Prefix\">\n        <div class=\"flex\">\n          <input type=\"text\" class=\"input flex-25 w-25\" #prefix pattern=\"[^ ]*\">\n\n          <button data-test=\"prefixReplace\" type=\"button\" app-button buttonType=\"outline\" class=\"ml-2\" buttonTheme=\"light\" (click)=\"handleReplaceClick(prefix.value)\">Replace</button>\n          <button data-test=\"prefixPrepend\" type=\"button\" app-button buttonType=\"outline\" class=\"ml-2\" buttonTheme=\"light\" (click)=\"handlePrependClick(prefix.value)\">Prepend</button>\n        </div>\n\n        <div class=\"pv-4 text-12\" formArrayName=\"states\">\n\n          <!-- State group -->\n          <div *ngFor=\"let state of formStates.controls; let i=index\" class=\"mb-2\">\n            <div [formGroupName]=\"i\">\n              <div class=\"flex\">\n                <!-- Enable -->\n                <div class=\"flex-shrink pr-2 pt-2\">\n                  <mat-checkbox data-test=\"includeState\" formControlName=\"include\" matTooltip=\"Include State\"></mat-checkbox>\n                </div>\n\n                <!-- State Name -->\n                <div class=\"flex-grow\">\n                  <input data-test=\"oldState\" type=\"hidden\" class=\"input\" formControlName=\"oldState\">\n                  <input data-test=\"newState\" type=\"text\" class=\"input\" formControlName=\"newState\">\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </app-form-field>\n    </div>\n  </form>\n\n</div>\n      \n<!-- Actions -->\n<div mat-dialog-actions>\n  <button app-button buttonTheme=\"light\" [mat-dialog-close] type=\"button\" class=\"mr-2\">Cancel</button>\n\n  <button\n    app-button\n    data-test=\"saveModuleSubmit\"\n    buttonTheme=\"light\"\n    buttonType=\"primary\"\n    [disabled]=\"saving || !form.valid || validating\"\n    (click)=\"handleSubmit()\">\n      <!-- Validating -->\n      <ng-container *ngIf=\"validating\">\n        <app-spinner size=\"medium\" class=\"ml-2\" render=\"inline\"></app-spinner>\n        Validating\n      </ng-container>\n\n      <!-- Saving -->\n      <ng-container *ngIf=\"saving\">\n        <app-spinner size=\"medium\" class=\"ml-2\" render=\"inline\"></app-spinner>\n        Saving\n      </ng-container>\n\n      <!-- Save -->\n      <ng-container *ngIf=\"!validating && !saving\">\n        Save Module\n      </ng-container>\n  </button>\n</div>","import { Component, OnInit, ChangeDetectionStrategy, OnDestroy, ChangeDetectorRef, Inject } from '@angular/core';\nimport { Store, Select, Actions, ofActionDispatched } from '@ngxs/store';\nimport { SaveModuleConfigModel } from 'src/app/modules/models/save-module-config.model';\nimport { TrimConfiguration } from 'src/app/edit/models/trim-config.model';\nimport { SaveModule, ResetModules, GetModuleSecondaryCategories, SaveModuleSuccess, SaveModuleFailure } from 'src/app/modules/state/modules.actions';\nimport { ModulesState } from 'src/app/modules/state/modules.state';\nimport { Observable, Subject, combineLatest, of, merge } from 'rxjs';\nimport { FormGroup, FormBuilder, Validators, FormArray, AbstractControl } from '@angular/forms';\nimport { takeUntil, debounceTime, map, switchMap, zip, mergeAll, combineAll, tap, finalize, distinctUntilChanged } from 'rxjs/operators';\nimport { SaveModuleModel } from 'src/app/modules/models/save-module.model';\nimport { ModulesService } from 'src/app/modules/modules.service';\nimport { MAT_DIALOG_DATA, MatDialogRef } from '@angular/material/dialog';\nimport { MatSnackBar } from '@angular/material/snack-bar';\n\nexport interface SaveModuleDialogData {\n  id: string;\n}\n\ninterface ValidatedState {\n  stateControl: AbstractControl; \n  valid: boolean;\n}\n\nconst validString = '[0-9a-zA-Z_]*';\nconst validRegex = /^[0-9a-zA-Z_]+$/;\n\n@Component({\n  selector: 'app-save-module-dialog',\n  templateUrl: './save-module-dialog.component.html',\n  styleUrls: ['./save-module-dialog.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class SaveModuleDialogComponent implements OnInit, OnDestroy {\n  @Select(ModulesState.getSaveModule)\n  saveModule$: Observable<SaveModuleModel>;\n\n  @Select(ModulesState.getPrimaryCategoryOptions('write'))\n  primaryCategoryOptions$: Observable<string[]>;\n\n  @Select(ModulesState.getSecondaryCategoryOptions)\n  secondaryCategoryOptions$: Observable<string[]>;\n\n  // @Select(ModulesState.getSaving)\n  // saving$: Observable<boolean>;\n  saving = false;\n\n  moduleExists = false;\n  modulePath: string;\n  form: FormGroup;\n  saveModule: SaveModuleModel;\n  usedStates: string[];\n  validating = false;\n\n  ngUnsubscribe = new Subject();\n\n  settings: SaveModuleDialogData;\n\n  get formName() {\n    return this.form.get('name');\n  }\n  \n  get formStates() {\n    return this.form.get('states') as FormArray;\n  }\n\n  get formPrimaryCategory() {\n    return this.form.get('primaryCategory');\n  }\n\n  get formSecondaryCategory() {\n    return this.form.get('secondaryCategory');\n  }\n\n  get formDuplicateStates() {\n    return this.form.get('duplicateStates');\n  }\n\n  get formTrimShown() {\n    return this.form.get('trimShown');\n  }\n\n  get formTrimClipped() {\n    return this.form.get('trimClipped');\n  }\n\n  get formConfirmProduction() {\n    return this.form.get('confirmProduction');\n  }\n\n\n  constructor(\n    private store: Store,\n    private actions: Actions,\n    private formBuilder: FormBuilder,\n    private modulesService: ModulesService,\n    private changeDetector: ChangeDetectorRef,\n    private snackbar: MatSnackBar,\n    public dialogRef: MatDialogRef<SaveModuleDialogComponent>,\n    @Inject(MAT_DIALOG_DATA) public data: SaveModuleDialogData\n  ) {\n    this.settings = {...data};\n  }\n  \n  ngOnInit() {\n    this.store.dispatch(new ResetModules());\n\n    this.saveModule = this.generateSaveModule();\n    this.usedStates = this.modulesService.getUsedStates();\n   \n    this.initApplicationListeners();\n    this.initForm();\n    this.setFormValidators();\n    this.initFormListeners();\n    this.setFormValues(this.saveModule);\n    \n    this.populateStateValues();\n  }\n\n  ngOnDestroy() {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n  initApplicationListeners() {\n    this.actions\n      .pipe(\n        ofActionDispatched(SaveModuleSuccess),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe((action: SaveModuleSuccess) => {\n        this.handleSaveSuccess(action.id);\n      });\n      \n    this.actions\n      .pipe(\n        ofActionDispatched(SaveModuleFailure),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe((action: SaveModuleFailure) => {\n        this.handleSaveFail(action.id);\n      });\n  }\n\n  initFormListeners() {\n    this.formPrimaryCategory.valueChanges\n      .pipe(takeUntil(this.ngUnsubscribe))\n      .subscribe((value) => {\n        this.store.dispatch(new GetModuleSecondaryCategories(value));\n      });\n\n    // Listens to the name field to check for a previously existing file. This\n    // indicates whether you're saving a new file, or saving over on that exists.\n    combineLatest(\n      this.formPrimaryCategory.valueChanges,\n      this.formSecondaryCategory.valueChanges,\n      this.formName.valueChanges,\n      this.formDuplicateStates.valueChanges\n    )\n    .pipe(\n      takeUntil(this.ngUnsubscribe),\n      debounceTime(300)\n    )\n    .subscribe(([primaryCategory, secondaryCategory, name, duplicateStates]) => {\n      this.handleNameChange(primaryCategory, secondaryCategory, name, duplicateStates);\n    });\n\n    // Listens to the state fields to check for previous existing states. States cannot be overridden,\n    // so the user is warned when there is a matc and saving is blocked. \n    merge(\n      this.formDuplicateStates.valueChanges,\n      this.formStates.valueChanges\n    )\n    .pipe(\n      tap(() => this.validating = true),\n      debounceTime(300),\n      switchMap((values) => {\n        return this.checkStateGroups();\n      }),\n      takeUntil(this.ngUnsubscribe)\n    )\n    .subscribe((validatedState) => {\n      this.validating = false;\n      this.updateFormStates(validatedState);\n    });\n  }\n\n  initForm() {\n    this.form = this.formBuilder.group({\n      primaryCategory: ['', Validators.required],\n      secondaryCategory: [''],\n      name: ['', [Validators.required, Validators.pattern(validString)]],\n      trimShown: [false],\n      trimClipped: [false],\n      duplicateStates: [false],\n      confirmProduction: [false, this.validateProductionSave],\n      states: this.formBuilder.array([\n        this.initStateForm('')\n      ])\n    }, { \n      validators: [this.validateProductionSave]\n    });\n  }\n\n  initStateForm(state) {\n    return this.formBuilder.group({\n      include: [true],\n      oldState: [state],\n      newState: [state, [Validators.required, Validators.pattern(validString)]]\n    });\n  }\n\n  handleReplaceClick(value: string) {\n    this.changeStatePrefix(value, 'replace');\n  }\n \n  handlePrependClick(value: string) {\n    this.changeStatePrefix(value, 'prepend');\n  }\n\n  handleSubmit() {\n    if (this.form.valid) {\n      this.save();\n    }\n  }\n\n  handleSaveSuccess(id: string) {\n    this.dialogRef.close();\n    this.snackbar.open(`\"${id}\" successfully saved.`);\n  }\n\n  handleSaveFail(id: string) {\n    this.dialogRef.close();\n    this.snackbar.open(`There was an error saving \"${id}\".`);\n  }\n\n  // Generate a save module model from the passed id\n  generateSaveModule() {\n    const module = this.modulesService.generateSaveModule(this.settings.id);\n    \n    return module;\n  }\n\n  populateStateValues() {\n    // Clear out previous states, rebind with new values\n    while (this.formStates.length > 0) {\n      this.formStates.removeAt(0);\n    }\n\n    const states = [];\n    this.modulesService.getUsedStates()\n      .forEach(state => {\n        const stateControl = { enabled: true, state: state };\n        this.formStates.push(this.initStateForm(stateControl.state));\n        states.push(stateControl);\n      });\n    \n    this.formStates.markAsDirty();\n    // this.handleStatesChange(states);\n  }\n\n  setFormValidators() {\n    // Secondary category is only required when primary category is production or client.\n    // In all other cases, we hide the secondary category.\n    this.formPrimaryCategory.valueChanges\n      .pipe(takeUntil(this.ngUnsubscribe))\n      .subscribe((value) => {\n        switch (value) {\n          case 'production':\n          case 'client':\n            this.formSecondaryCategory.setValidators([Validators.required]);\n            break;\n          default:\n           this.formSecondaryCategory.setValidators(null);\n           this.formSecondaryCategory.setValue('');\n           break;\n        }\n      });\n  }\n\n  setFormValues(saveModule: SaveModuleModel) {\n    // Never allow primary cateogry to save to the exports folder.\n    // Exports is the single source of truth: models which have been exported from source model files,\n    // and therefore should never be allowed to be overwritten.\n    const category = (saveModule.primaryCategory === 'exports') ? 'preview' : saveModule.primaryCategory || 'preview';\n\n    this.form.patchValue({\n      primaryCategory: category,\n      secondaryCategory: saveModule.secondaryCategory || '',\n      name: saveModule.name || '',\n      trimShown: false,\n      trimClipped: false,\n      duplicateStates: false\n    });\n  }\n\n  save() {\n    // Generate the save path\n    const path = this.modulesService.generateModulePath(\n      this.formPrimaryCategory.value,\n      this.formSecondaryCategory.value,\n      this.formName.value\n    );\n\n    // Generate the save configuration (save or duplicate)\n    const saveConfig = new SaveModuleConfigModel();\n    if (this.formDuplicateStates.value) {\n      saveConfig.duplicate = true;\n\n      // If we're duplicating the states, generate a new list of states for copying\n      this.formStates.value.map((state: {include: Boolean, oldState: string, newState: string }) => {\n        if (state.include) {\n          saveConfig.namespaceMap[state.oldState] = state.newState;  \n        }\n      });\n    }\n    \n    // Generate the trim configuration. Currently only trimming visible is supported.\n    const trimConfig = new TrimConfiguration();\n    trimConfig.graph.hidden = this.formTrimShown.value;\n    trimConfig.graph.clipped = this.formTrimClipped.value;\n\n    // Send everything off for saving.\n    this.saving = true;\n    this.store.dispatch(new SaveModule(path, saveConfig, trimConfig));\n  }\n\n  handleNameChange(primaryCategory: string, secondaryCategory: string, name, duplicateStates: boolean) {\n    this.modulePath = this.modulesService.generateModulePath(primaryCategory, secondaryCategory, name);\n\n    if (this.formName.errors) {\n      const { pattern, required } = this.formName.errors;\n      if (pattern || required) {\n        return;\n      }\n    }\n\n    if (this.modulePath && name.length) {\n      this.modulesService.listContents(primaryCategory, secondaryCategory, name)\n        .subscribe((results) => {\n          // When duplicating states, name is required\n          this.moduleExists = results.length > 0;\n          const nameTaken = duplicateStates && this.moduleExists;\n\n          // Ensure valid name after async operation\n          const invalid = !validRegex.test(name);\n\n          if (nameTaken || invalid) {\n            this.formName.setErrors({\n              invalid: true\n            });\n          } else {\n            this.formName.setErrors(null);\n          }\n\n          this.formName.markAsDirty();\n          this.changeDetector.markForCheck();\n        });\n    }\n  }\n\n  validateProductionSave(form: FormGroup) {\n    const primaryCategory = form.get('primaryCategory');\n    const confirmProduction = form.get('confirmProduction');\n\n    if (!primaryCategory || !confirmProduction) {\n      return null;\n    }\n    \n    if (primaryCategory.value === 'production' && confirmProduction.value === false) {\n      return { confirmProduction: true };\n    }\n    return null;\n  }\n\n  // Generates an array of server state name checks using the form controls\n  checkStateGroups(): Observable<ValidatedState[]> {\n    const groups$ = this.formStates.controls.map(group => {\n      return this.validateStateGroup(group);\n    });\n    \n    return groups$.length > 0 ? combineLatest(...groups$) : of([]);\n  }\n\n  validateStateGroup(stateGroup: AbstractControl): Observable<ValidatedState> {\n    const validateStates = this.formDuplicateStates.value === true;\n    const stateControl = stateGroup.get('newState');\n    const includeControl = stateGroup.get('include');\n\n    // If state control isn't toggled, auto validate to true\n    if (!validateStates || includeControl.value === false) {\n      return of({\n        stateControl: stateControl,\n        valid: true\n      });\n    }\n    \n    // If state control fails local validation, fail immediately without further checks\n    if (stateControl.errors || stateControl.value.length === 0) {\n      return of({\n        stateControl: stateControl,\n        valid: false\n      });\n    }\n\n    // If all local checks pass, check server for availability\n    return this.modulesService.getState(stateControl.value)\n      .pipe(\n        map((result) => {\n          const isValidString = validRegex.test(stateControl.value);\n\n          return {\n            stateControl: stateControl,\n            valid: result.length === 0 && isValidString\n          };\n        })\n      );\n  }\n\n  // Updates the form validation based on server validation checks\n  updateFormStates(validatedStates: ValidatedState[]) {\n    validatedStates.forEach((validatedState) => {\n      if (validatedState.valid) {\n        validatedState.stateControl.setErrors(null);\n        validatedState.stateControl.markAsDirty();\n      } else {\n        validatedState.stateControl.setErrors({ stateTaken: true });\n      }\n    });\n\n    this.changeDetector.markForCheck();\n  }\n\n  changeStatePrefix(newPrefix: string, mode: 'prepend'|'replace') {\n    this.formStates.controls.forEach(group => {\n      const stateControl = group.get('newState');\n\n      switch (mode) {\n        case 'prepend':\n          stateControl.setValue(`${newPrefix}_${stateControl.value}`);\n          break;\n        case 'replace':\n          const regex = new RegExp(/[^_]*/); // Match everything before underscore\n          const value = stateControl.value.replace(regex, newPrefix);\n          stateControl.setValue(value);\n          break;\n      }\n    });\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { SaveModuleDialogComponent } from './save-module-dialog.component';\nimport { CommonModule } from '@angular/common';\nimport { MaterialModule } from 'src/app/material.module';\nimport { SharedModule } from 'src/app/shared/shared.module';\nimport { ReactiveFormsModule } from '@angular/forms';\n\n@NgModule({\n  declarations: [\n    SaveModuleDialogComponent\n  ],\n  imports: [\n    CommonModule,\n    MaterialModule,\n    SharedModule,\n    ReactiveFormsModule\n  ],\n  exports: [\n    SaveModuleDialogComponent\n  ],\n  entryComponents: [\n    SaveModuleDialogComponent\n  ]\n})\nexport class SaveModuleDialogModule { }\n","<div class=\"dialog\">\n\n    <div mat-dialog-title>\n        <div class=\"flex flex-row justify-between\">\n            <h1>Invite Members</h1>\n        \n            <button app-button buttonType=\"text\" buttonTheme=\"light\" type=\"button\" (click)=\"handleCancelClick()\" title=\"Close\" [attr.aria-label]=\"'Close'\">\n                <app-icon icon=\"times\" size=\"lg\">\n                </app-icon>\n            </button>\n        </div>\n    </div>\n\n    <mat-divider></mat-divider>\n\n    <!-- Content -->\n    <div mat-dialog-content class=\"theme-light p-6\">\n\n        <!-- sent -->\n        <ng-container *ngIf=\"sent; else sendFormTmp\">\n\n            <!-- sucessfuly sent -->\n            <div *ngIf=\"sentResponses.length > 0\" class=\"mv-1\">\n                <app-message-toggle type=\"message\">\n                    {{ sentResponses.length }} invite(s) have been sent. \n                    Please allow up to a few minutes for invitees to receive their invitations.\n                </app-message-toggle>\n            </div>\n\n        </ng-container>\n\n        <!-- send form -->\n        <ng-template #sendFormTmp>\n\n            <ng-container *ngIf=\"form.get('emails'); let emailGroup\" [formGroup]=\"form\">\n\n                <!-- errors -->\n                <div *ngIf=\"errorResponses.length > 0\" class=\"mb-4\">\n                    <app-message-toggle type=\"error\">\n                        <div>There was an error sending {{ errorResponses.length }} invite(s).</div>\n\n                        <!-- specially formatted messages -->\n                        <div *ngFor=\"let message of formatResponses(errorResponses)\">\n                            {{  message }}\n                        </div>\n                    </app-message-toggle>\n                </div>\n\n                <div class=\"text-14 mb-3\">\n                    Enter up to {{ maxEmailCount }} email addresses separated by commas\n                </div>\n    \n                <textarea\n                    class=\"dialog__input input\"\n                    formControlName=\"emails\"\n                    placeholder=\"name1@domain.com, name2@domain.com, name3@yourdomain.com\"\n                    rows=\"8\">\n                </textarea>\n    \n                <!-- error: exceed max emails -->\n                <div *ngIf=\"emailGroup.errors?.maxEmailsExceeded\" class=\"mt-1\">\n                    <mat-error>\n                        Please limit your entry to {{ maxEmailCount }}. Current count: {{ emailGroup.errors?.currentEmailCount }}.\n                    </mat-error>\n                </div>        \n    \n                <!-- error: invalid emails -->\n                <div *ngIf=\"emailGroup.errors?.invalidEmails\" class=\"mt-1\">\n                    <mat-error>\n                        {{ formatEmails(emailGroup.errors?.invalidEmails) }} \n                        {{ emailGroup.errors.invalidEmails.length === 1 ? 'is not a valid email address.' : 'are not valid email addresses.'}}\n                    </mat-error>\n                </div>\n                \n            </ng-container>\n    \n        </ng-template>\n    </div>\n\n    <!-- Actions -->\n    <div *ngIf=\"!sent\" mat-dialog-actions>\n\n        <!-- send actions -->\n        <div class=\"flex justify-end\">\n            <button\n                app-button\n                buttonTheme=\"light\"\n                buttonType=\"default\"\n                class=\"mr-4\"\n                (click)=\"handleCancelClick()\">Cancel</button>\n\n            <button\n                app-button\n                buttonType=\"primary\"\n                [disabled]=\"form.invalid || (inviting$ | async)\"\n                (click)=\"handleInviteClick()\">\n                {{ errorResponses.length > 0 ? 'Try Again' : 'Send Invites' }}\n            </button>\n        </div>\n\n    </div>\n\n</div>","import { ChangeDetectionStrategy, ChangeDetectorRef, Component, Inject, OnDestroy, OnInit } from '@angular/core';\nimport { FormBuilder, FormControl, FormGroup, Validators } from '@angular/forms';\nimport { MatDialogRef, MatSnackBar, MAT_DIALOG_DATA } from '@angular/material';\nimport { Actions, ofActionDispatched, Select, Store } from '@ngxs/store';\nimport { Observable, of } from 'rxjs';\nimport { Subject } from 'rxjs/internal/Subject';\nimport { takeUntil } from 'rxjs/operators';\nimport { OrganizationModel } from 'src/app/organizations/models/organization.model';\nimport { OrganizationInviteResponse } from 'src/app/organizations/organizations.service';\nimport { SendOrganizationInvite, SendOrganizationInviteFail, SendOrganizationInviteSuccess } from 'src/app/organizations/state/organizations.actions';\nimport { OrganizationsState } from 'src/app/organizations/state/organizations.state';\nimport { TextUtils } from 'src/app/shared/libraries/text-utils/text-utils';\n\nconst maxEmailCount = 50;\n\nexport interface TeamInviteDialogData {\n  organization: OrganizationModel;\n}\n\n@Component({\n  selector: 'app-team-invite-dialog',\n  templateUrl: './team-invite-dialog.component.html',\n  styleUrls: ['./team-invite-dialog.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class TeamInviteDialogComponent implements OnInit, OnDestroy {\n  maxEmailCount = maxEmailCount;\n\n  @Select(OrganizationsState.getInviting)\n  inviting$: Observable<boolean>;\n\n  form: FormGroup;\n  private ngUnsubscribe = new Subject();\n  private organization: OrganizationModel;\n\n  // state\n  sent = false;\n  sentResponses: OrganizationInviteResponse[] = [];\n  errorResponses: OrganizationInviteResponse[] = [];\n\n  constructor(\n    private store: Store,\n    private actions: Actions,\n    private formBuilder: FormBuilder,\n    private dialogRef: MatDialogRef<TeamInviteDialogComponent>,\n    @Inject(MAT_DIALOG_DATA) private data: TeamInviteDialogData,\n    private changeRef: ChangeDetectorRef,\n    private snackBar: MatSnackBar\n  ) {\n    this.organization = data.organization;\n  }\n\n  ngOnInit() {\n    this.initForm();\n    this.initInviteListeners();\n  }\n\n  ngOnDestroy() {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n  initForm() {\n    this.form = this.formBuilder.group({\n      'emails': ['', Validators.required, this.emailValidator]\n    });\n  }\n\n  initInviteListeners() {\n    // inviting\n    this.actions\n      .pipe(\n        ofActionDispatched(SendOrganizationInvite),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(() => {\n        this.sentResponses = [];\n        this.errorResponses = [];\n        this.changeRef.markForCheck();\n      });\n\n    // NOTE: errors in sending are retured in a successful response\n    this.actions\n      .pipe(\n        ofActionDispatched(SendOrganizationInviteSuccess),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(({ responses }: SendOrganizationInviteSuccess) => {\n        this.sentResponses = responses\n          .filter((r) => r.status === 'success');\n\n        this.errorResponses = responses\n          .filter((r) => r.status === 'error');\n\n        this.sent = this.errorResponses.length === 0;\n\n        // auto close\n        if (this.sent) {\n          setTimeout(() => {\n            this.dialogRef.close();\n          }, 5000);\n        }\n\n        this.changeRef.markForCheck();\n      });\n\n    // error: server\n    this.actions\n      .pipe(\n        ofActionDispatched(SendOrganizationInviteFail),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe((action: SendOrganizationInviteFail) => {\n        this.sent = false;\n\n        this.sentResponses = [];\n        this.errorResponses = [];\n\n        this.snackBar.open('There was an error sending the invites, please try again.');\n\n        this.changeRef.markForCheck();\n      });\n  }\n\n  handleCancelClick() {\n    this.dialogRef.close(false);\n  }\n\n  backToFormClick() {\n    this.resetState();\n    this.changeRef.markForCheck();\n  }\n\n  handleInviteClick() {\n    const { eid } = this.organization;\n    const emails = TextUtils.parseEmails(this.form.value.emails);\n\n    this.store.dispatch(new SendOrganizationInvite(eid, emails));\n  }\n\n  formatEmails(emails: string[]): string {\n    return emails.join(', ');\n  }\n\n  formatResponses(responses: OrganizationInviteResponse[]): string[] {\n    // group reasons for easier to output messages\n    const reasonGroups = responses.map((r) => r.reason);\n    const distinctReasons = [\n      ...new Set([...reasonGroups])\n    ];\n\n    // 'Reason for error: email1@biodigital.com, email2@biodigital.com' \n    return distinctReasons.map((reason) => {\n      const emails = responses.filter((r) => r.reason === reason)\n        .map((r) => r.email);\n      const formattedEmails = this.formatEmails(emails);\n      return `\"${reason}\": ${formattedEmails}`;\n    });\n  }\n\n  private resetState() {\n    this.sent = false;\n    this.sentResponses = [];\n    this.errorResponses = [];\n  }\n\n  private emailValidator(control: FormControl) {\n    const emails = TextUtils.parseEmails(control.value);\n    const invalidEmails = emails\n      .filter((e) => !TextUtils.validateEmail(e));\n    const currentEmailCount = emails.length;\n    const maxEmailsExceeded = currentEmailCount > maxEmailCount;\n\n    let errors = {};\n\n    // validate: max length\n    if (maxEmailsExceeded) {\n      errors = {\n        ...errors,\n        maxEmailsExceeded,\n        currentEmailCount\n      };\n    }\n\n    // validate: email format\n    if (invalidEmails.length > 0) {\n      errors = {\n        ...errors,\n        invalidEmails\n      };\n    }\n\n    if (Object.keys(errors).length > 0) { // fail validation\n      return of(errors);\n    } else { // pass validation\n      return of(null);\n    }\n\n\n  }\n\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { MaterialModule } from 'src/app/material.module';\nimport { SharedModule } from 'src/app/shared/shared.module';\nimport { ReactiveFormsModule } from '@angular/forms';\nimport { TeamInviteDialogComponent } from './team-invite-dialog.component';\n\n@NgModule({\n  declarations: [\n    TeamInviteDialogComponent\n  ],\n  imports: [\n    CommonModule,\n    MaterialModule,\n    SharedModule,\n    ReactiveFormsModule\n  ],\n  exports: [\n    TeamInviteDialogComponent\n  ],\n  entryComponents: [\n    TeamInviteDialogComponent\n  ]\n})\nexport class TeamInviteDialogModule { }\n","<div class=\"welcome\">\n\n  <button app-button buttonType=\"text\" buttonTheme=\"light\" type=\"button\" (click)=\"handleCloseTour()\" title=\"Close\" [attr.aria-label]=\"'Close'\" class=\"welcome__close\">\n    <app-icon icon=\"times\" size=\"lg\">\n    </app-icon>\n  </button>\n\n  <div class=\"slide\">\n    <!-- slides -->\n    <div\n      *ngFor=\"let slide of slides;let i = index\"\n      class=\"slide__item\"        \n      [class.slide__item--hidden]=\"selectedIndex !== i\">\n        <img\n          *ngIf=\"slide.logo\"\n          class=\"slide__logo\"\n          [src]=\"slide.logo\">  \n        <div\n          *ngIf=\"slide.title\"\n          class=\"text-24 text-medium text-uppercase mt-4\">\n          {{ slide.title }}\n        </div>\n        <div\n          *ngIf=\"slide.text\"\n          class=\"text-18 mt-4 mb-4\"\n          [class.text-22]=\"slide.logo\"\n          [class.text-medium]=\"slide.logo\" \n          [innerHTML]=\"slide.text\">\n        </div>\n        <img\n          *ngIf=\"slide.image\"\n          class=\"slide__image\"\n          [src]=\"slide.image\">        \n    </div>\n\n    <!-- nav -->\n    <div class=\"slide__nav\">\n        <app-icon\n          class=\"slide__nav-arrow\"\n          [class.slide__nav-arrow--disabled]=\"isFirstSlide\"\n          icon=\"chevron-left\"            \n          (click)=\"handlePrevClick()\">\n        </app-icon>\n\n        <!-- dots -->\n        <div class=\"slide__nav-dots\">\n          <div\n            class=\"slide__nav-dot\"\n            [class.slide__nav-dot--active]=\"selectedIndex === i\"\n            [attr.title]=\"slide.title\"\n            *ngFor=\"let slide of slides;let i = index\"\n            (click)=\"handleSelectSlideClick(i)\">\n          </div>\n        </div>\n        \n        <app-icon\n          class=\"slide__nav-arrow\"\n          [class.slide__nav-arrow--disabled]=\"isLastSlide\"\n          icon=\"chevron-right\"            \n          (click)=\"handleNextClick()\">\n        </app-icon>\n    </div>\n  </div>\n</div>","import { Component, OnInit, ChangeDetectionStrategy, Inject, OnDestroy } from '@angular/core';\nimport { MAT_DIALOG_DATA, MatDialogRef } from '@angular/material/dialog';\nimport { Subject } from 'rxjs';\nimport { Store } from '@ngxs/store';\n\nexport enum WelcomeTourEnum {\n  NewUser,\n  ExistingUser,\n  Group\n}\n\nexport interface WelcomeTourDialogData {\n  userType: WelcomeTourEnum;\n}\n\nclass SlideData {\n  logo?: string;\n  title?: string;\n  text?: string;\n  image?: string;\n}\n\nconst baseWelcomeSlides: SlideData[] = [\n  {\n    title: 'Explore',\n    text: 'Browse our digital library for 3D models to complement your curriculum.',\n    image: '/assets/images/welcome-tour-explore.jpg'\n  },\n  {\n    title: 'Customize',\n    text: 'Use our authoring tools to create 3D views tailored to your educational goals.',\n    image: '/assets/images/welcome-tour-customize.jpg'\n  },\n  {\n    title: 'Collaborate',\n    text: 'Share your saved 3D views with your team from a central Dashboard.',\n    image: '/assets/images/welcome-tour-collaborate.jpg'\n  },\n  {\n    title: 'Integrate',\n    text: 'Publish your interactive 3D model and drop into your digital content.',\n    image: '/assets/images/welcome-tour-integrate.jpg'\n  }\n];\n\nconst newUserSlides: SlideData[] = [\n  {\n    text: 'We make it easy to visualize the human body<br/> for your educational needs - all in interactive 3D.',\n    logo: '/assets/images/biodigital-logo.svg'\n  },\n  ...baseWelcomeSlides\n\n];\nconst existingUserSlides: SlideData[] = [\n  {\n    title: 'Introducing Human Studio',\n    text: 'The first product for authoring custom interactive 3D models of anatomy, disease and treatments.',\n    image: '/assets/images/studio-tour-studio.jpg'\n  },\n  {\n    title: 'Interactive Labels',\n    text: 'Quickly add anatomical labels to call out key learning objectives.',\n    image: '/assets/images/studio-tour-labels.jpg'\n  },\n  {\n    title: 'Paint',\n    text: 'Customize the look and feel of your 3D model by applying different paint effects to anatomical structures.',\n    image: '/assets/images/studio-tour-paint.jpg'\n  },\n  {\n    title: 'Tour Builder',\n    text: 'Tell an interactive story by stringing together different views of your 3D model.',\n    image: '/assets/images/studio-tour-tour.jpg'\n  },\n  {\n    title: 'Text Manager',\n    text: 'Add or modify text from one dedicated place.',\n    image: '/assets/images/studio-tour-text.jpg'\n  }\n];\n\n@Component({\n  selector: 'app-welcome-tour-dialog',\n  templateUrl: './welcome-tour-dialog.component.html',\n  styleUrls: ['./welcome-tour-dialog.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class WelcomeTourDialogComponent implements OnInit, OnDestroy {\n\n  private ngUnsubscribe = new Subject();\n  settings: WelcomeTourDialogData = {\n    userType: WelcomeTourEnum.NewUser\n  };\n\n  slides: SlideData[] = [];\n  selectedIndex = 0;\n\n  get isFirstSlide(): boolean {\n    return this.selectedIndex === 0;\n  }\n\n  get isLastSlide(): boolean {\n    return this.selectedIndex === this.slides.length - 1;\n  }\n\n  constructor(\n    private store: Store,\n    private dialogRef: MatDialogRef<WelcomeTourDialogComponent>,\n    @Inject(MAT_DIALOG_DATA) private data: WelcomeTourDialogData\n  ) {\n    this.settings = {\n      ...this.settings,\n      ...data\n    };\n    // set data source\n    const type = this.settings.userType;\n    switch (type) {\n      case WelcomeTourEnum.NewUser:\n        this.slides = newUserSlides;\n        break;\n      case WelcomeTourEnum.ExistingUser:\n        this.slides = existingUserSlides;\n        break;\n      default:\n        break;\n    }\n  }\n\n  ngOnInit() {\n  }\n\n  ngOnDestroy() {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n  handleCloseTour() {\n    this.close();\n  }\n\n  close() {\n    // close dialog\n    this.dialogRef.close();\n  }\n\n  handleSelectSlideClick(index) {\n    this.selectedIndex = index;\n  }\n\n  handleNextClick() {\n    this.incrementSelectedIndex(1);\n  }\n\n  handlePrevClick() {\n    this.incrementSelectedIndex(-1);\n  }\n\n  incrementSelectedIndex(increment: number) {\n    const targetIndex = this.selectedIndex + increment;\n    this.selectedIndex = Math.max(0, targetIndex) % this.slides.length;\n  }\n\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { MaterialModule } from 'src/app/material.module';\nimport { SharedModule } from 'src/app/shared/shared.module';\nimport { WelcomeTourDialogComponent } from './welcome-tour-dialog.component';\n\n@NgModule({\n  declarations: [\n    WelcomeTourDialogComponent\n  ],\n  imports: [\n    CommonModule,\n    MaterialModule,\n    SharedModule\n  ],\n  exports: [\n    WelcomeTourDialogComponent\n  ],\n  entryComponents: [\n    WelcomeTourDialogComponent\n  ]\n})\nexport class WelcomeTourDialogModule { }\n","import { NgModule } from '@angular/core';\nimport { AboutDialogModule } from './components/about-dialog/about-dialog.module';\nimport { AccessDialogModule } from './components/access-dialog/access-dialog.module';\nimport { AddTeamModelDialogModule } from './components/add-team-model-dialog/add-team-model-dialog.module';\nimport { BackgroundColorDialogModule } from './components/background-color-dialog/background-color-dialog.module';\nimport { ClipboardDialogModule } from './components/clipboard-dialog/clipboard-dialog.module';\nimport { ConfirmDialogModule } from './components/confirm-dialog/confirm-dialog.module';\nimport { DomainJoinDialogModule } from './components/domain-join-dialog/domain-join-dialog.module';\nimport { GroupRestrictionDialogModule } from './components/group-restriction-dialog/group-restriction-dialog.module';\nimport { LegacyDialogModule } from './components/legacy-dialog/legacy-dialog.module';\nimport { LimitDialogModule } from './components/limit-dialog/limit-dialog.module';\nimport { NpsDialogModule } from './components/nps-dialog/nps-dialog.module';\nimport { SaveBookmarkDialogModule } from './components/save-bookmark-dialog/save-bookmark-dialog.module';\nimport { SaveModuleDialogModule } from './components/save-module-dialog/save-module-dialog.module';\nimport { WelcomeTourDialogModule } from './components/welcome-tour-dialog/welcome-tour-dialog.module';\nimport { ImportModelDialogModule } from './components/import-model-dialog/import-model-dialog.module';\nimport { DialogState } from './state/dialog.state';\nimport { NgxsModule } from '@ngxs/store';\nimport { TeamInviteDialogModule } from './components/team-invite-dialog/team-invite-dialog.module';\nimport { DeleteAccountDialogModule } from './components/delete-account-dialog/delete-account-dialog.module';\nimport { CancelSubscriptionDialogModule } from './components/cancel-subscription-dialog/cancel-subscription-dialog.module';\nimport { ImageDialogModule } from './components/image-dialog/image-dialog.module';\n\n@NgModule({\n  imports: [\n    NgxsModule.forFeature([\n      DialogState\n    ]),\n\n    AboutDialogModule,\n    AccessDialogModule,\n    AddTeamModelDialogModule,\n    BackgroundColorDialogModule,\n    ClipboardDialogModule,\n    ConfirmDialogModule,\n    DomainJoinDialogModule,\n    GroupRestrictionDialogModule,\n    LegacyDialogModule,\n    LimitDialogModule,\n    NpsDialogModule,\n    SaveBookmarkDialogModule,\n    SaveModuleDialogModule,\n    WelcomeTourDialogModule,\n    ImportModelDialogModule,\n    TeamInviteDialogModule,\n    DeleteAccountDialogModule,\n    CancelSubscriptionDialogModule,\n    ImageDialogModule\n  ],\n  exports: [\n    AboutDialogModule,\n    AccessDialogModule,\n    AddTeamModelDialogModule,\n    BackgroundColorDialogModule,\n    ClipboardDialogModule,\n    ConfirmDialogModule,\n    DomainJoinDialogModule,\n    GroupRestrictionDialogModule,\n    LegacyDialogModule,\n    LimitDialogModule,\n    NpsDialogModule,\n    SaveBookmarkDialogModule,\n    SaveModuleDialogModule,\n    WelcomeTourDialogModule,\n    ImportModelDialogModule,\n    TeamInviteDialogModule,\n    DeleteAccountDialogModule,\n    CancelSubscriptionDialogModule,\n    ImageDialogModule\n  ],\n  declarations: []\n})\nexport class DialogModule { }\n","import { Injectable } from '@angular/core';\nimport { MatDialog, MatDialogConfig } from '@angular/material/dialog';\nimport { LimitDialogComponent } from './components/limit-dialog/limit-dialog.component';\nimport { LegacyDialogComponent, LegacyDialogData, LegacyDialogEnum } from './components/legacy-dialog/legacy-dialog.component';\nimport { ConfirmDialogComponent, ConfirmDialogData } from './components/confirm-dialog/confirm-dialog.component';\nimport { SaveBookmarkDialogComponent, SaveBookmarkDialogData, SaveBookmarkDialogMode } from './components/save-bookmark-dialog/save-bookmark-dialog.component';\nimport { BookmarkModel } from '../bookmarks/models/bookmark.model';\nimport { AccessDialogData } from './components/access-dialog/access-dialog.component';\nimport { GroupRestrictionDialogData, GroupRestrictionDialogComponent } from './components/group-restriction-dialog/group-restriction-dialog.component';\nimport { ClipboardDialogComponent, ClipboardDialogData } from './components/clipboard-dialog/clipboard-dialog.component';\nimport { ScreenDimensions } from '../shared/models/screen.dimensions.model';\nimport { WelcomeTourDialogComponent, WelcomeTourDialogData, WelcomeTourEnum } from './components/welcome-tour-dialog/welcome-tour-dialog.component';\nimport { DomainJoinDialogData, DomainJoinDialogComponent } from './components/domain-join-dialog/domain-join-dialog.component';\nimport { OrganizationModel } from '../organizations/models/organization.model';\nimport { AboutDialogComponent } from './components/about-dialog/about-dialog.component';\nimport { SaveModuleDialogComponent } from './components/save-module-dialog/save-module-dialog.component';\nimport { NpsDialogComponent, NpsDialogData } from './components/nps-dialog/nps-dialog.component';\nimport { ImportModelDialogComponent } from './components/import-model-dialog/import-model-dialog.component';\nimport { AddTeamModelDialogComponent } from './components/add-team-model-dialog/add-team-model-dialog.component';\nimport { DialogIds } from './models/dialog-ids';\nimport { BackgroundColorDialogComponent } from './components/background-color-dialog/background-color-dialog.component';\nimport { TeamInviteDialogComponent, TeamInviteDialogData } from './components/team-invite-dialog/team-invite-dialog.component';\nimport { DeleteAccountDialogComponent } from './components/delete-account-dialog/delete-account-dialog.component';\nimport { CancelSubscriptionDialogComponent } from './components/cancel-subscription-dialog/cancel-subscription-dialog.component';\nimport { ImageDialogComponent, ImageDialogData } from './components/image-dialog/image-dialog.component';\n\nconst mobileScreenWidth = 959;\nconst transparentDialogCSSClass = 'backdropClass';\n\n// Transparent Image Dialog Classes\nconst imageBackdropClass = 'bd-dialog-backdrop';\nconst imagePanelClass = 'bd-dialog-panel';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class DialogService {\n\n  get isMobile(): boolean {    \n    return window.innerWidth <= mobileScreenWidth;\n  }\n\n  constructor(\n    private dialog: MatDialog\n  ) { }\n\n  openClipboardDialog(copyText: string, config?: MatDialogConfig<ClipboardDialogData>) {\n    const options = {      \n      data: {\n        id: DialogIds.ClipboardDialog,\n        copyText: copyText\n      },\n      ...config\n    };\n\n    return this.dialog.open(ClipboardDialogComponent, options);\n  }\n  \n  openWelcomeTourDialog(tourVersion: 'first_tour' | 'updated_tour', config?: MatDialogConfig<WelcomeTourDialogData>) {\n    const userType: WelcomeTourEnum = tourVersion === 'updated_tour' ? WelcomeTourEnum.ExistingUser : WelcomeTourEnum.NewUser;\n\n    const options: MatDialogConfig<WelcomeTourDialogData> = {\n      id: DialogIds.WelcomeTourDialog,\n      disableClose: true,\n      data: {\n        userType: userType\n      },\n      ...config\n    };\n    return this.dialog.open(WelcomeTourDialogComponent, options);\n  }\n\n  openJoinDomainDialog(organization: OrganizationModel, config?: MatDialogConfig<DomainJoinDialogData>) {\n    const options: MatDialogConfig<DomainJoinDialogData> = {\n      id: DialogIds.JoinDomainDialog,\n      data: {\n        organization: organization\n      },\n      ...config\n    };\n    return this.dialog.open(DomainJoinDialogComponent, options);\n  }\n\n  openNpsSurveyDialog(surveyGroupName: string, config?: MatDialogConfig<NpsDialogData>) {\n    const options: MatDialogConfig<NpsDialogData> = {\n      id: DialogIds.NpsSurveyDialog,\n      data: {\n        surveyGroupName: surveyGroupName\n      },\n      ...config\n    };\n    return this.dialog.open(NpsDialogComponent, options);\n  }\n\n  openConfirmDialog(config?: MatDialogConfig<ConfirmDialogData>) {\n    const options = {\n      id: DialogIds.ConfirmDialog,\n      ...config\n    };\n\n    return this.dialog.open(ConfirmDialogComponent, options);\n  }\n\n  openLimitDialog() {\n    this.closeAllDialogs();\n\n    return this.dialog.open(LimitDialogComponent, {\n      id: DialogIds.LimitDialog,\n      width: '480px'\n    });\n  }\n\n  openUpgradeDialog(config?: MatDialogConfig<LegacyDialogData>) {\n    const dimensions: ScreenDimensions = {\n      width: 925,\n      height: 700\n    };\n    const options = {\n      id: DialogIds.UpgradeDialog,\n      ...{\n        width: `${dimensions.width}px`,\n        height: `${dimensions.height}px`,\n        data: <LegacyDialogData>{\n          type: LegacyDialogEnum.UpgradeSubscription,\n          dimensions: dimensions\n        }\n      },\n      ...config\n    };\n\n    this.closeAllDialogs();\n    return this.dialog.open(LegacyDialogComponent, options);\n  }\n\n  openBuyDialog(config?: MatDialogConfig<LegacyDialogData>) {\n    const dimensions: ScreenDimensions = {\n      width: 550,\n      height: 650\n    };\n    const options = {\n      id: DialogIds.BuyDialog,\n      ...{\n        width: `${dimensions.width}px`,\n        height: `${dimensions.height}px`,\n        data: <LegacyDialogData>{\n          type: LegacyDialogEnum.BuySubscription,\n          dimensions: dimensions\n        }\n      },\n      ...config\n    };\n\n    this.closeAllDialogs();\n    return this.dialog.open(LegacyDialogComponent, options);\n  }\n\n  openProfileDialog(config?: MatDialogConfig<LegacyDialogData>, tab: string = '') {\n    const dimensions: ScreenDimensions = {\n      width: 750,\n      height: 600\n    };\n    const options = {\n      id: DialogIds.ProfileDialog,\n      ...{\n        width: `${dimensions.width}px`,\n        height: `${dimensions.height}px`,\n        data: {\n          type: LegacyDialogEnum.MyProfile,\n          dimensions: dimensions,\n          options: {\n            show_tab: tab\n          }\n        }\n      },\n      ...config\n    };\n\n    this.closeAllDialogs();\n    return this.dialog.open(LegacyDialogComponent, options);\n  }\n\n  openSaveModuleDialog(id: string, config?: MatDialogConfig<SaveBookmarkDialogData>) {\n    this.closeAllDialogs();\n\n    const options = {\n      id: DialogIds.SaveModuleDialog,\n      ...{\n        width: '480px',\n        data: {\n          id: id\n        }\n      },\n      ...config\n    };\n\n    return this.dialog.open(SaveModuleDialogComponent, options);\n  }\n\n  openSaveBookmarkDialog(bookmark: BookmarkModel, config?: MatDialogConfig<SaveBookmarkDialogData>) {\n    return this._openSaveBookmarkDialog({\n      id: DialogIds.SaveBookmarkDialog,\n      data: {\n        bookmark: bookmark,\n        mode: SaveBookmarkDialogMode.SaveStory\n      },\n      ...config\n    });\n  }\n\n  openSaveAsBookmarkDialog(title: string, bookmarkTitle: string, message?: string, config?: MatDialogConfig<SaveBookmarkDialogData>) {\n    return this._openSaveBookmarkDialog({\n      id: DialogIds.SaveBookmarkDialog,\n      data: {\n        title: title,\n        bookmarkTitle: bookmarkTitle,\n        message: message,\n        mode: SaveBookmarkDialogMode.SaveStory\n      },\n      ...config\n    });\n  }\n\n  openManageDialog(bookmark: BookmarkModel, config?: MatDialogConfig<SaveBookmarkDialogData>) {\n    return this._openSaveBookmarkDialog({\n      id: DialogIds.SaveBookmarkDialog,\n      data: {\n        bookmark: bookmark,\n        mode: SaveBookmarkDialogMode.Manage\n      },\n      ...config\n    });\n  }\n\n  openBookmarkAccessDialog(bookmark: BookmarkModel, config?: MatDialogConfig<AccessDialogData>) {\n    const options = {\n      id: DialogIds.BookmarkAccessDialog,\n      width: '480px',\n      data: {\n        model: bookmark\n      },\n      ...config\n    };\n\n    this.closeAllDialogs();\n    return this.dialog.open(SaveBookmarkDialogComponent, options);\n  }\n\n  openGroupRestrictionDialog(config?: MatDialogConfig<GroupRestrictionDialogData>) {\n    const options = {\n      id: DialogIds.GroupRestrictionDialog,\n      ...{\n        width: '480px',\n        height: 'auto'\n      },\n      ...config\n    };\n\n    return this.dialog.open(GroupRestrictionDialogComponent, options);\n  }\n\n  openPremiumContentDialog() {\n    const bodyText = this.isMobile\n      ? 'This is premium content. Visit us on desktop to upgrade to a premium plan.'\n      : 'This is premium content. Upgrade to a Premium Plan for unlimited access.';\n\n    return this.openConfirmDialog({\n      id: DialogIds.PremiumContentDialog,\n      data: {\n        titleText: 'Premium Content',\n        bodyText: bodyText,\n        confirmText: 'Go Premium',\n        confirmEnabled: !this.isMobile,\n        cancelText: 'OK',\n        confirmColor: 'warn'\n      }\n    });\n  }\n\n  openAboutDialog() {\n    this.closeAllDialogs();\n\n    return this.dialog.open(AboutDialogComponent, {\n      id: DialogIds.AboutDialog\n    });\n  }\n\n  openImportDialog() {\n    this.closeAllDialogs();\n\n    const options = {\n      id: DialogIds.ImportDialog,\n      maxWidth: '90vw',\n      width: '90vw',\n      height: '90vh'\n    };\n\n    return this.dialog.open(ImportModelDialogComponent, options);\n  }\n  \n  openAddTeamModelsDialog(bookmarks: BookmarkModel[]) {\n    const options = {\n      id: DialogIds.AddTeamModelDialog,\n      data: {\n        bookmarks: bookmarks\n      }\n    };\n    return this.dialog.open(AddTeamModelDialogComponent, options);\n  }\n\n  openBackgroundColorDialog() {\n    const options = {\n      backdropClass: transparentDialogCSSClass,\n      data: {\n      }\n    };\n    return this.dialog.open(BackgroundColorDialogComponent, options);\n  }\n\n  openTeamInviteDialog(organization: OrganizationModel) {\n    const options = {\n      id: DialogIds.AddTeamModelDialog,\n      disableClose: true,\n      data: <TeamInviteDialogData>{\n        organization\n      }\n    };\n    return this.dialog.open(TeamInviteDialogComponent, options);\n  }\n\n  openDeleteAccountDialog() {\n    return this.dialog.open(DeleteAccountDialogComponent);\n  }\n\n  openCancelSubscriptionDialog() {\n    return this.dialog.open(CancelSubscriptionDialogComponent);\n  }\n\n  openImageDialog(data: ImageDialogData) {\n    const options = {\n      id: DialogIds.ImageDialog,\n      backdropClass: imageBackdropClass,\n      panelClass: imagePanelClass,\n      disableClose: false,\n      data: data\n    };\n    return this.dialog.open(ImageDialogComponent, options);\n  }\n\n  closeAllDialogs() {\n    this.dialog.closeAll();\n  }\n\n  private _openSaveBookmarkDialog(config?: MatDialogConfig<SaveBookmarkDialogData>) {\n    const options = {\n      mode: SaveBookmarkDialogMode.SaveStory,\n      ...config\n    };\n\n    this.closeAllDialogs();\n    return this.dialog.open(SaveBookmarkDialogComponent, options);\n  }\n}\n","export enum DialogIds {\n  ClipboardDialog = 'ClipboardDialog',\n  WelcomeTourDialog = 'WelcomeTourDialog',\n  JoinDomainDialog = 'JoinDomainDialog',\n  NpsSurveyDialog = 'NpsSurveyDialog',\n  ConfirmDialog = 'ConfirmDialog',\n  LimitDialog = 'LimitDialog',\n  UpgradeDialog = 'UpgradeDialog',\n  BuyDialog = 'BuyDialog',\n  ProfileDialog = 'ProfileDialog',\n  SaveModuleDialog = 'SaveModuleDialog',\n  SaveBookmarkDialog = 'SaveBookmarkDialog',\n  SaveAsBookmarkDialog = 'SaveAsBookmarkDialog',\n  ManageDialog = 'ManageDialog',\n  BookmarkAccessDialog = 'BookmarkAccessDialog',\n  GroupRestrictionDialog = 'GroupRestrictionDialog',\n  PremiumContentDialog = 'PremiumContentDialog',\n  AboutDialog = 'AboutDialog',\n  ImportDialog = 'ImportDialog',\n  AddTeamModelDialog = 'AddTeamModelDialog',\n  ImageDialog = 'ImageDialog'\n}\n","export namespace DialogActions {\n  export class OpenLimit {\n    static readonly type = '[Dialog] Open Limit';\n    constructor() { }\n  }\n\n  export class CloseLimit {\n    static readonly type = '[Dialog] Close Limit';\n    constructor(public upgrade: boolean) { }\n  }\n  export class OpenPremiumContent {\n    static readonly type = '[Dialog] Open Premium Content';\n    constructor() { }\n  }\n\n  export class ClosePremiumContent {\n    static readonly type = '[Dialog] Close Premium Content';\n    constructor(public confirmed: boolean) { }\n  }\n\n  export class OpenUpgrade {\n    static readonly type = '[Dialog] Open Upgrade';\n    constructor() { }\n  }\n\n  export class CloseUpgrade {\n    static readonly type = '[Dialog] Close Upgrade';\n    constructor() { }\n  }\n}\n","import { MatDialogRef } from '@angular/material';\n\nexport class DialogStateModel {\n  openDialog: MatDialogRef<any>;\n}\n","import { State, Action, StateContext, Selector } from '@ngxs/store';\nimport { DialogStateModel } from './dialog.state.model';\nimport { DialogActions } from './dialog.actions';\nimport { DialogService } from '../dialog.service';\n\n@State<DialogStateModel>({\n  name: 'dialog',\n  defaults: {\n    openDialog: null\n  }\n})\nexport class DialogState {\n  /**\n   * Selectors\n   */\n  @Selector()\n  static getOpenDialog(state: DialogStateModel) {\n    return state.openDialog;\n  }\n\n  /**\n   * Actions\n   */\n\n\n  // Limit \n  @Action(DialogActions.OpenLimit)\n  openLimit(context: StateContext<DialogStateModel>, action: DialogActions.OpenLimit) {\n    const dialogRef = this.dialogService.openLimitDialog();\n    dialogRef.afterClosed()\n      .subscribe(upgrade => {\n        context.dispatch(new DialogActions.CloseLimit(upgrade));\n      });\n  }\n\n  @Action(DialogActions.CloseLimit)\n  closeLimit(context: StateContext<DialogStateModel>, action: DialogActions.CloseLimit) {\n    if (action.upgrade) {\n      this.dialogService.openUpgradeDialog();\n    }\n  }\n\n  // Premium Content\n  @Action(DialogActions.OpenPremiumContent)\n  openPremiumContent(context: StateContext<DialogStateModel>, action: DialogActions.OpenPremiumContent) {\n    const dialogRef = this.dialogService.openPremiumContentDialog();\n    dialogRef.afterClosed()\n      .subscribe(confirmed => {\n        context.dispatch(new DialogActions.ClosePremiumContent(confirmed));\n      });\n  }\n\n  @Action(DialogActions.ClosePremiumContent)\n  closePremiumContent(context: StateContext<DialogStateModel>, action: DialogActions.ClosePremiumContent) {\n    if (action.confirmed) {\n      context.dispatch(new DialogActions.OpenUpgrade());\n    }\n  }\n\n  // Upgrade\n  @Action(DialogActions.OpenUpgrade)\n  openUpgrade(context: StateContext<DialogStateModel>, action: DialogActions.OpenUpgrade) {\n    this.dialogService.openUpgradeDialog();\n  }\n\n\n  constructor(\n    private dialogService: DialogService\n  ) {\n\n  }\n}\n","import { CanvasSizeModel } from './canvas-size.model';\n\nexport const CanvasSizeOriginal = new CanvasSizeModel('Don\\'t Resize', -1, -1);\nexport const CanvasSizeMobile = new CanvasSizeModel('Common (Mobile)', 360, 640);\nexport const CanvasSizeCommon300x300 = new CanvasSizeModel('Common (Minimum)', 300, 300);\nexport const CanvasSizeCommon700x550 = new CanvasSizeModel('Common (Publish Default)', 700, 550);\nexport const CanvasSizeIPhoneX = new CanvasSizeModel('iPhone X', 375, 812);\nexport const CanvasSizeCommonTabletPortrait = new CanvasSizeModel('iPad (Portrait)', 768, 1024);\nexport const CanvasSizeCommonTabletLandscape = new CanvasSizeModel('iPad (Landscape)', 1024, 768);\n\nexport const CanvasSizes = [\n    CanvasSizeOriginal,\n    CanvasSizeMobile,\n    CanvasSizeCommon700x550,\n    CanvasSizeCommon300x300,\n    CanvasSizeIPhoneX,\n    CanvasSizeCommonTabletPortrait,\n    CanvasSizeCommonTabletLandscape\n];\n","export class CanvasSizeModel {\n    constructor(\n        public label: string,\n        public width: number,\n        public height: number\n    ) {}\n}\n","declare const ColorFresnel: any;\n\nexport class ColorFresnelModel {\n  edge: [number, number, number];\n  center: [number, number, number];\n  centerBias: number;\n  edgeBias: number;\n  power: number;\n\n  constructor(value: ColorFresnelModel = { center: [0, 0, 0], edge: [1, 1, 1], centerBias: 1, edgeBias: 0, power: 1 }) {\n    const { edge, center, centerBias, edgeBias, power } = value;\n    this.edge = edge;\n    this.center = center;\n    this.centerBias = centerBias;\n    this.edgeBias = edgeBias;\n    this.power = power;\n  }\n\n  /**\n   * Serializes to Engine's Fresnel format\n   */\n  static toEngine(colorFresnel: ColorFresnelModel): (number | number[])[] {\n    const { center, edge, centerBias, edgeBias, power } = colorFresnel;\n    return [[...center], [...edge], centerBias, edgeBias, power];\n  }\n}\n","import { ColorFresnelModel } from './color-fresnel.model';\nimport { ScalarFresnelModel } from './scalar-fresnel.model';\nimport {\n  ColorFresnelValue,\n  ScalarFresnelValue,\n  EngineColorValue\n} from './recipe-types';\nimport { EngineColorRecipeModel } from './engine-color-recipe.model';\n\nfunction getScalarFresnelVal(\n  recipe: EngineColorRecipeModel,\n  prop: 'saturation' | 'brightness' | 'opacity' | 'contrast'\n): ScalarFresnelValue | false | undefined {\n  switch (true) {\n    case recipe[prop] === undefined:\n      return undefined;\n    case recipe[prop] === false:\n      return false;\n    case typeof recipe[prop] === 'number':\n      return (recipe[prop] as number) * 100;\n    default:\n      return new ScalarFresnelModel({\n        center: recipe[prop][0],\n        edge: recipe[prop][1],\n        centerBias: recipe[prop][2],\n        edgeBias: recipe[prop][3],\n        power: recipe[prop][4]\n      });\n  }\n}\n\n// application color recipe\nexport class ColorRecipeModel {\n  // false = remove color mode, undefined = don't touch color mod\n  tintColor?: ColorFresnelValue | false | undefined;\n  saturation?: ScalarFresnelValue | false | undefined;\n  contrast?: ScalarFresnelValue | false | undefined;\n  brightness?: ScalarFresnelValue | false | undefined;\n  opacity?: ScalarFresnelValue | false | undefined;\n\n  constructor(value: ColorRecipeModel = {}) {\n    const { tintColor, saturation, contrast, brightness, opacity } = value;\n    this.tintColor = tintColor;\n    this.saturation = saturation;\n    this.contrast = contrast;\n    this.brightness = brightness;\n    this.opacity = opacity;\n  }\n\n  static fromEngine(recipe: EngineColorRecipeModel): ColorRecipeModel {\n    const tintColor = (() => {\n      switch (true) {\n        case recipe.tintColor === undefined:\n          return undefined;\n        case recipe.tintColor === false:\n          return false;\n        case Array.isArray(recipe.tintColor): {\n          // at this point, we know tintColor is an array, so it's safe to cast.\n          return (recipe.tintColor as number[]).length === 3\n            ? [...(recipe.tintColor as number[])]\n            : new ColorFresnelModel({\n                center: recipe.tintColor[0],\n                edge: recipe.tintColor[1],\n                centerBias: recipe.tintColor[2],\n                edgeBias: recipe.tintColor[3],\n                power: recipe.tintColor[4]\n              });\n        }\n      }\n    })();\n    return new ColorRecipeModel({\n      tintColor: tintColor as ColorFresnelValue | false | undefined,\n      saturation: getScalarFresnelVal(recipe, 'saturation'),\n      brightness: getScalarFresnelVal(recipe, 'brightness'),\n      contrast: getScalarFresnelVal(recipe, 'contrast'),\n      opacity: getScalarFresnelVal(recipe, 'opacity'),\n    });\n  }\n\n  /**\n   *  Converts an Application Recipe to an Engine Recipe\n   */\n  static toEngine(recipe: ColorRecipeModel): EngineColorRecipeModel {\n    // initialize values: false -> explicitly remove color setting\n    let tintColor: EngineColorValue[] | false =\n      recipe.tintColor === false ? false : undefined;\n    let saturation: EngineColorValue | false =\n      recipe.saturation === false ? false : undefined;\n    let brightness: EngineColorValue | false =\n      recipe.brightness === false ? false : undefined;\n    let contrast: EngineColorValue | false =\n      recipe.contrast === false ? false : undefined;\n    let opacity: EngineColorValue | false =\n      recipe.opacity === false ? false : undefined;\n\n    // tint-color\n    if (Array.isArray(recipe.tintColor)) {\n      tintColor = [...recipe.tintColor];\n    } else if (\n      recipe.tintColor &&\n      recipe.tintColor instanceof ColorFresnelModel\n    ) {\n      tintColor = ColorFresnelModel.toEngine(recipe.tintColor);\n    }\n\n    // saturation\n    if (typeof recipe.saturation === 'number') {\n      saturation = recipe.saturation / 100.0;\n    } else if (recipe.saturation instanceof ScalarFresnelModel) {\n      saturation = ScalarFresnelModel.toEngine(recipe.saturation);\n    }\n\n    // brightness\n    if (typeof recipe.brightness === 'number') {\n      brightness = recipe.brightness / 100.0;\n    } else if (recipe.brightness instanceof ScalarFresnelModel) {\n      brightness = ScalarFresnelModel.toEngine(recipe.brightness);\n    }\n\n    // contrast\n    if (typeof recipe.contrast === 'number') {\n      contrast = recipe.contrast / 100.0;\n    } else if (recipe.contrast instanceof ScalarFresnelModel) {\n      contrast = ScalarFresnelModel.toEngine(recipe.contrast);\n    }\n\n    // opacity\n    if (typeof recipe.opacity === 'number') {\n      opacity = recipe.opacity / 100.0;\n    } else if (recipe.opacity instanceof ScalarFresnelModel) {\n      opacity = ScalarFresnelModel.toEngine(recipe.opacity);\n    }\n\n    return {\n      tintColor,\n      saturation,\n      brightness,\n      contrast,\n      opacity\n    };\n  }\n}\n","\n/**\n * Represents a color's red, green, blue and alpha values in the 0...1 range\n */\nexport class ColorModel {\n    constructor(\n        public red: number,\n        public green: number,\n        public blue: number,\n        public alpha: number = 1\n    ) { }\n}\n","export enum EditViewEnum {\n    Chapter = 'chapter',\n    Label = 'label',\n    Paint = 'paint',\n    Position = 'position'\n}\n","import { EngineColorValue } from './recipe-types';\n\n// engine color recipe\nexport class EngineColorRecipeModel {\n  tintColor?: EngineColorValue[] | false;\n  saturation?: EngineColorValue | false;\n  contrast?: EngineColorValue | false;\n  brightness?: EngineColorValue | false;\n  opacity?: EngineColorValue | false;\n\n  constructor(value: EngineColorRecipeModel = {}) {\n    const { tintColor, saturation, contrast, brightness, opacity } = value;\n    this.tintColor = tintColor;\n    this.saturation = saturation;\n    this.contrast = contrast;\n    this.brightness = brightness;\n    this.opacity = opacity;\n  }\n}\n","export enum PaintBrushMode {\n    Modify,\n    Replace\n}\n","import { ColorRecipeModel } from './color-recipe.model';\n\nexport class PaintPresetModel { \n    constructor(\n        public label: string,\n        public recipe: ColorRecipeModel,\n        public icon: string = '_color',\n        public group: string\n    ) { }\n}\n","declare const ScalarFresnel: any; // global constant from engine\n\nexport class ScalarFresnelModel {\n  edge: number;\n  center: number;\n  centerBias: number;\n  edgeBias: number;\n  power: number;\n\n  constructor(value: ScalarFresnelModel = { center: 0, edge: 1, centerBias: 1, edgeBias: 0, power: 1 }) {\n    const { edge, center, centerBias, edgeBias, power } = value;\n    this.edge = edge;\n    this.center = center;\n    this.centerBias = centerBias;\n    this.edgeBias = edgeBias;\n    this.power = power;\n  }\n\n  /**\n   * Serializes to Engine's Fresnel format\n   */\n  static toEngine(scalarFresnel: ScalarFresnelModel): [number, number, number, number, number] {\n    const { center, edge, centerBias, edgeBias, power } = scalarFresnel;\n    return [center, edge, centerBias, edgeBias, power];\n  }\n}\n","// data for 3D object definition for BioDigital Human Module files\nexport class HumanObjectRenderable {\n  geometryId?: string;\n  materialId?: string;\n  morphId?: string;\n  layer?: number;\n}\n\nexport class EuclideanData {\n  x?: number;\n  y?: number;\n  z?: number;\n}\n\nexport class HumanObjectTransform {\n  translate?: EuclideanData;\n  rotate?: EuclideanData;\n  scale?: EuclideanData;\n  pivot?: EuclideanData;\n}\n\nexport class SceneGraphNode {\n  objectId: string;\n  displayName: string;\n  layer: number;\n  objects?: SceneGraphNode[];\n  transformId?: string;\n  geometryId?: string;\n  materialId?: string;\n  renderables?: HumanObjectRenderable[];\n  backfaces?: boolean;\n  transform?: HumanObjectTransform;\n}\n","// #NOTE: [EM] \n// hidden: the state of the object is false in all chapters\n// #TODO: clipped: the object is fully clipped by every active clipping plane in all chapters - requires relatively expensive query\n// #TODO: transparent: the object is fully transparent in every chapter - not yet implemented\n// #TODO: disabled: the object id disabled (not able to be shown even by tweens) - not yet implemented\n\ninterface GraphTrimModel {\n  hidden: boolean;\n  disabled: boolean;\n  clipped: boolean;\n  transparent: boolean;\n}\n\n// configuration for trimming objects out of the scene graph on serialization\nexport class TrimConfiguration {\n    graph: GraphTrimModel;\n\n    constructor() {\n      this.graph = {\n        hidden: false,\n        clipped: false,\n        disabled: false,\n        transparent: false\n      };\n    }\n}\n","import { Injectable } from '@angular/core';\nimport { TrimConfiguration } from './models/trim-config.model';\nimport { StoryModel } from '../story/models/story.model';\nimport { Store } from '@ngxs/store';\nimport { SerializeChapterService } from './serialize/chapter/serialize-chapter.service';\nimport { serializeGraph } from './serialize/scene-graph/serialize-graph';\nimport { cloneDeep, invert } from 'lodash';\nimport { ChapterModel } from '../story/models/chapter.model';\nimport { EngineService } from '../engine/engine.service';\nimport { BdGraphPropertyValueMap } from 'src/lib/graph/graph.model';\nimport { StoryAnimationModel } from '../story/models/story.model';\nimport { AnimationService } from '../engine/animation.service';\nimport { renamespace } from './serialize/renamespace/renamespace';\nimport { StoryLabelsState } from '../story/state/labels/story.labels.state';\nimport { EngineParticlesState } from '../engine/state/particles/particles.state';\n\ndeclare const Human;\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class SerializeModuleService {\n\n  constructor(\n    private store: Store,\n    private engineService: EngineService,\n    private chapterSerializer: SerializeChapterService,\n    private animationService: AnimationService\n  ) {}\n\n  private serializeUI(story: StoryModel) {\n\n    const ui = { ...story.ui };\n    if (story.chapters.length > 1) {\n      ui.scrubber = false;\n      ui.playPause = false;\n      ui.tour = { chapters: true };\n    }\n    return ui;\n\n  }\n\n  // #NOTE: [EM] This shouldn't be necessary. The user should be able to explicitly state their intention.\n  // programatically create the animation property based on the currently active chapter's timeline data\n  private serializeAnimation(zeroethChapter: ChapterModel) {\n    // is there data in the current chapter's timeline map?\n    const zeroethChapterAnimated = this.animationService.isChapterAnimated(zeroethChapter);\n  \n    if (zeroethChapterAnimated) {\n      return {\n        startTime: zeroethChapter.timelineMap[0].start,\n        loop: zeroethChapter.loop !== false, // default to true\n        numChapters: 1\n      };\n    }\n    \n    return {};\n  }\n\n  private getClippedObjects(): Record<string, any> {\n    const activeClips = Human.renderer.clip.getActiveClips();\n\n    if (activeClips.length === 0) {\n      return {};\n    }\n\n    return Human.scene.getLeaves().reduce((acc, objectId) => {\n      const object = Human.scene.objects[objectId];\n      if (object.culledByClip) {\n        acc[objectId] = true;\n      }\n      return acc;\n    }, {});\n  }\n\n  // creates a map of objects to trim from the scene graph\n  private generateTrimObjectMap(chapters: ChapterModel[], trimConfig: TrimConfiguration): BdGraphPropertyValueMap {\n    \n    const sceneGraph = this.engineService.getSceneGraph(Human.scene.rootObjects);\n    \n    // use serialized chapters to query scene-graph for trimmable objects\n    let shownObjectState = {};\n    if (trimConfig.graph.hidden) {\n      // #NOTE: [EM] This could be extended to include otehr 'shown' conditions e.g. clipped, opacity, etc.\n      shownObjectState = {...shownObjectState, ...this.engineService.queryShownObjects(chapters, sceneGraph, true)};\n    }\n\n    // invert shown object state for trim object state\n    const trimObjectState = {};\n    // tslint:disable-next-line:forin\n    for (const id in shownObjectState) {\n      trimObjectState[id] = !shownObjectState[id];\n    }\n\n    const clippedObjects = trimConfig.graph.clipped \n      ? this.getClippedObjects() \n      : {};\n\n    return {\n      ...trimObjectState,\n      ...clippedObjects\n    };\n  }\n\n  // serialize the data in engine state for storage on BD server\n  serialize(\n    namespaceMap: {[key: string]: string}, \n    trimConfig: TrimConfiguration,\n    replaceObjectId: boolean = false,\n    sourceStory: StoryModel,\n    sourceChapters: ChapterModel[],\n    chapterIdMap\n  ): {story: StoryModel} {\n    const trimMap = this.generateTrimObjectMap(sourceChapters, trimConfig);\n\n    // create a copy of the source story (the current story in state)\n    const moduleData = cloneDeep(sourceStory);\n\n    // replace storychapters with serialized chapters\n    // I'm letting the chapter serializer keep renamespacing the min synchronization for now... it's too hairy to mess with right now.\n    const serialized = this.chapterSerializer.serialize(\n      sourceChapters,\n      namespaceMap,\n      this.store.selectSnapshot(StoryLabelsState.getLabels),\n      chapterIdMap\n    );\n    \n    moduleData.chapters = serialized;\n\n    // replace story graph with serialized graph\n    const rootObjects = Human.scene.rootObjects;\n    moduleData.sceneGraph = serializeGraph(rootObjects, trimMap);\n\n    // replace UI configuration for widget\n    moduleData.ui = this.serializeUI(moduleData);\n\n    // #NOTE: [EM] this is a hard overwrite, which will cause problems for BD content creators\n    moduleData.animation = this.serializeAnimation(sourceChapters[0]) as StoryAnimationModel;\n    \n    moduleData.customData = {\n      ...moduleData.customData,\n      particleSystems: this.store.selectSnapshot(\n        EngineParticlesState.getParticleSystemsList\n      ),\n    };\n\n    moduleData.tweenParticleLookup = this.store.selectSnapshot(EngineParticlesState.getTweenParticleLookup);\n\n    return {\n      story: replaceObjectId \n        ? renamespace(moduleData, namespaceMap) \n        : moduleData\n    };\n  }\n}\n","import { BdGraphNode, BdGraph, BdGraphStateMap } from '../../../../lib/graph/graph.model';\nimport { Elections } from '../../../../lib/graph/elections';\nimport { ElectionResultModel } from '../../../../lib/graph/models/election-result.model';\nimport { merge, range, isEmpty } from 'lodash';\n\n\nfunction formatElectionResult(\n  property: string,\n  id: string,\n  result: boolean,\n  dissenterIds: string[]\n): BdGraphStateMap {\n  \n  const dissenters = dissenterIds.reduce((acc, dissenter) => {\n    acc[dissenter] = {[property]: !result};\n    return acc;\n  }, {});\n\n  dissenters[id] = {[property]: result};\n  return dissenters;\n}\n\nfunction accumulateElectionResults(\n  electionResults: ElectionResultModel[]\n): BdGraphStateMap {\n  // a formatted election result is a BdGraphStateMap\n  // this makes it easier to merge them with by node id instead of by property.\n  return electionResults.reduce((acc, er) => {\n    const properties = Object.keys(er);\n\n    const formattedElectionResults = properties.map(property => {\n      return formatElectionResult(\n        property,\n        er[property].id,\n        er[property].result,\n        er[property].dissenters\n      );\n    });\n\n    const merged = formattedElectionResults.reduce((_acc, result) => {\n        return merge(_acc, result);\n    }, {});\n\n    Object.keys(merged).forEach(nodeId => {\n      acc[nodeId] = merged[nodeId];\n    });\n\n    return acc;\n\n  }, {} as BdGraphStateMap);\n}\n\n// In our pursuit of minimum synchronization, we must traverse the graph\n// one last time and prune successor nodes that are the same as their predecessor,\n// and thus redundant.\nfunction pruneSyncGraph<TNode extends BdGraphNode>(\n  syncGraph: BdGraphStateMap,\n  successorIds: string[],\n  properties: string[],\n  graph: BdGraph<TNode>\n  ) {\n\n  // collect props to prune\n  const propsToPrune = successorIds.reduce(\n    (acc: { successorId: string, prop: string }[], successorId) => {\n      const predecessorId = graph.predecessors[successorId];\n      const successor = syncGraph[successorId];\n      const predecessor = syncGraph[predecessorId];\n\n      for (const prop of properties) {\n        if (successor[prop] === predecessor[prop]) {\n          acc.push({ successorId, prop });\n        }\n      }\n      return acc;\n    },\n    []\n  );\n\n  // prune props, and the whole node if empty.\n  for (const prop of propsToPrune) {\n    delete syncGraph[prop.successorId][prop.prop];\n    if (Object.keys(syncGraph[prop.successorId]).length === 0) {\n      delete syncGraph[prop.successorId];\n    }\n  }\n\n  return syncGraph;\n}\n\n// calculate inheritable graph state\nexport function calculateMiniminumSynchronization<TNode extends BdGraphNode>(\n  graph: BdGraph<TNode>,\n  syncProperties: Elections.SyncRules,\n  leafStateMap: BdGraphStateMap\n): BdGraphStateMap {\n  \n  const properties: string[] = Object.keys(syncProperties);\n  const initialVoterState = Elections.getInitialVoterState(leafStateMap, properties);\n  const initialDepth = Elections.getInitialElectionDepth(leafStateMap, graph);\n\n  const syncGraph = range(initialDepth, -1).reduce(\n    (acc, depth) => {\n      const elections = Elections.getEligibleElections(\n        graph,\n        Object.keys(acc.remainingVoters),\n        depth\n      );\n\n      const electionResults = Elections.getElectionResults(\n        graph,\n        acc.remainingVoters,\n        elections,\n        syncProperties\n      );\n\n      const accumResults = accumulateElectionResults(electionResults.results);\n\n      Object.keys(accumResults).forEach(key => {\n        acc.syncGraph[key] = accumResults[key];\n      });\n\n      acc.remainingVoters = electionResults.remainingVoters;\n      return acc;\n    },\n    { syncGraph: {} as BdGraphStateMap, remainingVoters: initialVoterState }\n  ).syncGraph;\n\n\n  // At this point, syncGraph has all the correct property values for all nodes,\n  // but it's not the minimum set.\n  // see pruneSyncGraph\n\n  const successorIds = Object.keys(syncGraph).filter(id => {\n    // is this id a root -> filter out\n    if (graph.roots[id]) {\n      return false;\n    }\n  \n    // is this a successor? -> include\n    if (graph.successors[id]) {\n      return true;\n    }\n  \n    return false;\n  });\n  \n  const minSync = pruneSyncGraph(\n    syncGraph,\n    successorIds,\n    properties,\n    graph\n  );\n\n  return minSync;\n}\n","import { Injectable } from '@angular/core';\nimport { BdGraph, BdGraphNode, BdGraphStateMap, GraphNodeState } from '../../../../lib/graph/graph.model';\nimport * as deepEqual from 'fast-deep-equal';\nimport { ChapterModel } from '../../../story/models/chapter.model';\nimport { TimelineModel } from '../../../story/models/timeline.model';\nimport { uuid } from '../../../shared/uuid';\nimport { HotspotModel } from '../../../story/models/labels/hotspot.model';\nimport { BackgroundModel } from '../../../engine/models/background.model';\nimport { classToClass } from 'class-transformer';\nimport { omit, isEmpty, isEqual } from 'lodash';\nimport { LabelsService } from '../../../story/labels.service';\n\nimport { calculateLeafStateMap } from 'src/lib/graph/leaf-state';\nimport { calculateMiniminumSynchronization } from './minimum-synchronization';\nimport { GraphUtils } from 'src/lib/graph/graph-utils';\nimport { Store } from '@ngxs/store';\nimport { EngineNodesState } from 'src/app/engine/state/nodes/engine.nodes.state';\nimport { ColorRecipeModel } from '../../models/color-recipe.model';\nimport { LabelModel } from 'src/app/story/models/labels/label.model';\nimport { EngineState } from 'src/app/engine/state/engine.state';\nimport { BdGraphService } from 'src/lib/graph/graph.service';\nimport { ObjectId, NodeState } from 'src/app/engine/state/nodes/engine.nodes.state.model';\nimport { EngineColorRecipeModel } from '../../models/engine-color-recipe.model';\nimport { hasShownAncestor, hasShownSuccessor } from 'src/app/engine/state/nodes/build-node-state';\nimport { EngineParticlesState } from 'src/app/engine/state/particles/particles.state';\n\n\ndeclare const Human: any;\n\n// next human engine version\nfunction getRecipes(): string[] {\n  if (Human.scene.colorRecipes) {\n    return Human.scene.colorRecipes.getRecipes();\n  } else {\n    return [];\n  }\n}\n\n\n\n// rules for propagating state up our BdGraph\nclass GraphNodeSync {\n  shown = 'majorityWins';\n  selected = 'majorityWins';\n  pickable = 'majorityWins';\n\n  constructor(recipes: string[]) {\n    recipes.forEach((recipeName) => {\n      this[recipeName] = 'majorityWins';\n    });\n  }\n}\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class SerializeChapterService {\n\n  constructor(\n    private store: Store,\n    private labelService: LabelsService,\n    private graphService: BdGraphService\n  ) { }\n\n\n  // Query the synchronization and produce the minimum graph synchronization object\n  private getMinimumGraphSync(graph: BdGraph<BdGraphNode>, sync: BdGraphStateMap, namespaceMap: { [key: string]: string }): BdGraphStateMap {\n    // calculate leaf state based on synchronization\n\n\n    // TODO: when are recipes defined?\n    const recipes = getRecipes();\n\n\n    const properties = Object.keys(new GraphNodeState(recipes)); // [\"shown\", \"selected\", \"pickable\"]\n\n\n    // calculate the state of all leaves given the sync object.\n    // leaf state is needed to then propagate back up the tree to build the min sync.\n    const leafState = calculateLeafStateMap(graph, sync, properties);\n\n    // minimize sync with inheritable properties: calculate graph state via upward propagation of leaf state\n    const syncRules = JSON.parse(JSON.stringify(new GraphNodeSync(recipes)));\n\n    const minSync = calculateMiniminumSynchronization(graph, syncRules, leafState);\n\n\n    // copy over non-inheritable properties\n    Object.entries(sync).forEach(([objectId, objectState]) => {\n      const diffSync = omit(objectState, properties);\n      if (!isEmpty(diffSync)) {\n        minSync[objectId] = { ...minSync[objectId] || {}, ...diffSync };\n      }\n    });\n\n\n\n    const renamedMinSync = new BdGraphStateMap();\n    Object.entries(minSync).forEach(([id, syncState]) => {\n      renamedMinSync[this.switchNamespace(id, namespaceMap)] = syncState;\n    }, this);\n\n    return renamedMinSync;\n  }\n\n  // Convert synchronization object to chapter properties\n  private convertGraphSync(sync: BdGraphStateMap): any {\n    const showObjects = {};\n    const selectObjects = {};\n    const pickThroughObjects = {};\n    const synchronization = {};\n\n    Object.entries(sync).forEach(([id, stateMap]) => {\n      Object.entries(stateMap).forEach(([property, value]) => {\n        if (property === 'shown') {\n          showObjects[id] = value;\n        } else if (property === 'selected') {\n          selectObjects[id] = value;\n        } else if (property === 'pickable') {\n          pickThroughObjects[id] = !value;\n        } else {\n          // keep in the synchronization object directly\n          synchronization[id] = { ...synchronization[id] || {}, ...{ [property]: value } };\n        }\n      }, this);\n\n    }, this);\n\n    return {\n      showObjects: showObjects,\n      selectObjects: selectObjects,\n      pickThroughObjects: pickThroughObjects,\n      synchronization: synchronization\n    };\n  }\n\n  private switchNamespace(id: string, namespaceMap: { [key: string]: string }): string {\n    return namespaceMap[id] || id;\n  }\n\n\n  // Serialize timeline maps\n  private serializeTimelineMaps(chapter: ChapterModel, namespaceMap: { [key: string]: string }): TimelineModel[] {\n\n    const timelineMaps: TimelineModel[] = chapter.timelineMap;\n    timelineMaps.forEach((tmap) => {\n      tmap.data.timeline = this.switchNamespace(tmap.data.timeline, namespaceMap);\n    });\n    return timelineMaps;\n  }\n\n  // serialize engine properties\n  private serializeProperties(chapter: ChapterModel): any {\n    // copy all chapter properties\n    const properties: { [key: string]: string; } = {\n      ...chapter.properties\n    };\n\n    // legacy properties to eventually be discarded\n    const annotationLayout = Human.properties.properties['annotations.layout.type'];\n    if (annotationLayout !== 'draggable') {\n      properties['annotations.layout.type'] = annotationLayout;\n    }\n\n    return properties;\n  }\n\n  // serialize labels and hotspots\n  private serializeHotspots(chapter: ChapterModel, storyLabels: LabelModel[]): { customData: any, hotspots: HotspotModel[] } {\n\n    // initialize hotspots with legacy hotspots.\n    // see `fromHumanChapter`\n    let hotspots: HotspotModel[] = [...chapter.hotspots]; // these are legacy hotspots, never stored in label state.\n    let customData = {};\n\n    const labels = storyLabels.filter(label => label.chapterId === chapter.id);\n\n    labels.forEach((label) => {\n      const labelData = this.labelService.serializeLabel(label, hotspots.length);\n      hotspots = [...hotspots, ...labelData.hotspots];\n      customData = { ...customData, ...labelData.data };\n    });\n\n    return {\n      customData: customData,\n      hotspots: hotspots\n    };\n  }\n\n  // Serialize the media object in JSON compatible layout\n  serializeMedia(chapter: ChapterModel) {\n    if (!chapter.media) {\n      return null;\n    }\n\n    // Chapter / Engine data structure: chapter.media.<clip>.data.{}\n    // JSON data structure: chapter.media.<clip>.{}\n    return Object.entries(chapter.media).reduce((result, [key, value]) => {\n      result[key] = {...value.data};\n      return result;\n    }, {});\n  }\n\n  // serialize background\n  private serializeBackground(background: BackgroundModel): BackgroundModel | {} {\n    if (!!background) {\n      return classToClass(background);\n    } else {\n      return {};\n    }\n  }\n\n  // serialize ui\n  private serializeUI(huChapter: any, ui: any) {\n    if (isEmpty(ui)) {\n      return { play: { count: 1 } };\n    } else {\n      return ui;\n    }\n  }\n\n  private calcMinimumPaintState(\n    graph: BdGraph<BdGraphNode>,\n    paintState: Record<ObjectId, EngineColorRecipeModel>\n  ): Record<ObjectId, EngineColorRecipeModel> {\n    function getPaintState(objectId: ObjectId, includeSelf: boolean = true) {\n      const children = graph.successors[objectId] || [];\n      const childPaint = children.reduce((acc, childId) => {\n        // discard the child's value if its equal to the parent's value.\n        // only record children that differ.\n        const includeChild = !isEqual(paintState[objectId], paintState[childId]);\n        return { ...acc, ...getPaintState(childId, includeChild) };\n      }, {});\n    \n      if (includeSelf) {\n        return {\n          [objectId]: paintState[objectId],\n          ...childPaint,\n        };\n      }\n    \n      return childPaint;\n    }\n    \n    return Object.keys(graph.roots).reduce((acc, objectId) => {\n      return {...acc, ...getPaintState(objectId)};\n    }, {});\n  }\n\n\n\n  // serialize chapter model into chapter data\n  private serializeChapter(\n    graph: BdGraph<BdGraphNode>,\n    chapter: ChapterModel,\n    namespaceMap,\n    storyLabels: LabelModel[],\n    chapterIdMap: Record<string, string>\n  ) {\n\n    // Hotspots are generated from labels, so we perform objectID conversion on labels before\n    // generating the hotspots. \n    const hotspotData = this.serializeHotspots(chapter, storyLabels);\n\n    const particleSystems = this.store.selectSnapshot(\n      EngineParticlesState.particleSystemsForChapter(chapter.id)\n    );\n    \n    const customData: ChapterModel['customData'] = {\n      ...chapter.customData, \n      ...hotspotData.customData,\n      particleSystems: particleSystems.map((particleSystem) => particleSystem.id)\n    };\n\n    const newChapterId = chapterIdMap[chapter.id];\n\n    const chapterData = {\n      id: newChapterId,\n      displayName: chapter.info.displayName,\n      description: chapter.info.description,\n      [chapter.camera.action]: chapter.camera.location,\n      background: this.serializeBackground(chapter.background),\n      hotspots: hotspotData.hotspots,\n      clippingPlanes: {clips: chapter.clippingPlanes.clips, boundary: chapter.clippingPlanes.boundary},\n      ui: this.serializeUI(chapter, chapter.ui),\n      media: this.serializeMedia(chapter),\n      graph: chapter.graph || {},\n      timelineMap: chapter.timelineMap || [],\n      customData: customData,\n      viewModes: chapter.viewModes,\n      lights: chapter.lights,\n      recipes: chapter.recipes || {},\n      transparencyMode: chapter.transparencyMode || '',\n      fallbackTransparency: chapter.fallbackTransparency || '',\n      properties: this.serializeProperties(chapter),\n      effects: chapter.effects || {},\n      options: chapter.options,\n      transitions: chapter.transitions,\n      environment: chapter.environment || {},\n      legend: chapter.legend || [],\n      visibilityLayers: chapter.visibilityLayers.src,\n      colorRecipeObjects: chapter.colorRecipeObjects,\n      contentBlocks: chapter.contentBlocks || []\n    };\n\n    const nodeState = this.store.selectSnapshot(EngineNodesState.getAllNodeState);\n    const nodeStateForChapter = nodeState[chapter.id];\n\n    const sync = Object.keys(nodeStateForChapter).reduce((acc, objectId) => {\n      const state = nodeStateForChapter[objectId];\n\n      const shown = state.shownSetByTween\n        ? hasShownAncestor(graph, objectId, chapter.showObjects) ||\n          hasShownSuccessor(graph, objectId, chapter.showObjects)\n        : state.shown;\n    \n      acc.boolState[objectId] = { shown, pickable: state.pickable };\n      acc.paintState[objectId] = ColorRecipeModel.toEngine(state.paint);\n      return acc;\n    }, {\n      boolState: {},\n      paintState: {}\n    });\n\n    const minSync = this.getMinimumGraphSync(graph, sync.boolState, namespaceMap);\n\n    Object.entries(this.convertGraphSync(minSync))\n      .forEach(([key, val]) => {\n        chapterData[key] = val;\n      });\n\n    // treat synchronization (paint settings) separately\n    // getMinimumGraphSync only considers properties that are boolean.\n    chapterData.synchronization = this.calcMinimumPaintState(graph, sync.paintState);\n\n    return chapterData;\n  }\n\n  // serialize a single chapter from state\n  serializeSingleChapter(\n    chapter: ChapterModel,\n    namespaceMap: { [key: string]: string } = {},\n    storyLabels: LabelModel[],\n    chapterIdMap: Record<string, string>\n  ) {\n    const graphNodeData = new GraphNodeState(getRecipes());\n    const graph = GraphUtils.createGraphFromSrc(\n      Object.values(Human.scene.rootObjects),\n      'objectId',\n      'objects',\n      graphNodeData\n    );\n  \n    return this.serializeChapter(\n      graph,\n      chapter,\n      namespaceMap,\n      storyLabels,\n      chapterIdMap\n    );\n  }\n  \n\n  // serialize all chapters in state\n  serialize(\n    chapters: ChapterModel[],\n    namespaceMap,\n    storyLabels: LabelModel[],\n    chapterIdMap: Record<string, string>\n  ) {\n    // prepare graph for graph state calculations\n    const graphNodeData = new GraphNodeState(getRecipes());\n\n    // #NOTE: [EM] This could be sped at by stashing the scene-graph on story load\n    const graph = GraphUtils.createGraphFromSrc(Object.values(Human.scene.rootObjects),\n      'objectId', 'objects', graphNodeData);\n\n    // serialize each chapter\n    return chapters.map(chapter =>\n      this.serializeChapter(graph, chapter, namespaceMap, storyLabels, chapterIdMap)\n    );\n  }\n}\n\n","import { isEmpty, mapValues } from 'lodash';\nimport { AssetLibrary } from 'src/app/story/models/story.model';\nimport { match } from 'minimatch';\n\ninterface NamespaceMap {\n  [oldStateId: string]: string; // newStateId;\n}\n\nexport namespace RenamespaceUtils {\n  export interface PropertiesMap {\n    showObjects?: {};\n    selectObjects?: {};\n    pickThroughObjects?: {};\n    colorRecipeObjects?: {};\n    synchronization?: {};\n  }\n\n\n  /**\n   * Tries to replace a term in `value` with a new term.\n   * e.g. brain-root, {brain: drain} ---> drain-root\n   */\n  export function renamespaceValue(value: string, namespaceMap: NamespaceMap) {\n    const entries = Object.entries(namespaceMap);\n    \n    // ensure that longer matchKeys are tested first\n    // otherwise, keys that are a substring of another key renamespace incorrectly.\n    entries.sort((a, b) => {\n      if (a[0].length === b[0].length) {\n        return 0;\n      }\n\n      if (a[0].length < b[0].length) {\n        return 1;\n      }\n\n      return -1;\n    });\n\n    return entries.reduce((acc, [matchKey, replaceString]) => {\n        if (acc.startsWith(matchKey)) {\n          const matchRegex = new RegExp(`^${matchKey}`);\n          acc = acc.replace(matchRegex, replaceString);\n        }\n        return acc;\n      }, value || '');\n  }\n\n  /**\n   * Convenient way to call renamespaceValue if given an object \n   * with multiple keys that need renamespacing.\n   */\n  export function renamespaceKeys(\n    entry: { [key: string]: any },\n    namespaceMap: NamespaceMap\n  ) {\n    // Iterate through key value pairs\n    return Object.entries(entry).reduce((result, [sourceKey, sourceValue]) => {\n      const newKey = renamespaceValue(sourceKey, namespaceMap);\n      result[newKey] = sourceValue;\n      return result;\n    }, {});\n  }\n\n  export function renamespaceAssetLibrary(\n    assetLibrary: AssetLibrary,\n    namespaceMap: NamespaceMap,\n    replaceObjectId: boolean\n  ) {\n    \n    if (!replaceObjectId) {\n      return assetLibrary;\n    }\n\n    const tweens = assetLibrary.tweens.map(tween => renamespaceValue(tween, namespaceMap));\n    const reflections = assetLibrary.reflections.map(refl => renamespaceValue(refl, namespaceMap));\n\n    return {\n      ...assetLibrary,\n      tweens,\n      reflections\n    };\n  }\n\n  export function renamespaceReflections(\n    reflections: {},\n    namespaceMap: NamespaceMap,\n    replaceObjectId: boolean\n  ) {\n    if (!replaceObjectId) {\n      return reflections;\n    }\n  \n    return mapValues(reflections, refl => renamespaceValue(refl, namespaceMap));\n  }\n}\n","import { StoryModel } from '../../../story/models/story.model';\nimport { RenamespaceUtils } from './renamespace-utils';\nimport { mapKeys, mapValues } from 'lodash';\nimport { SceneGraphNode } from '../../models/scene-graph-node';\nimport { LabelModel } from '../../../story/models/labels/label.model';\nimport { ErrandInterface } from '../../../story/models/errands/errand.model';\nimport { ErrandType } from '../../../story/models/errands/errand-type.enum';\nimport { ChapterModel } from '../../../story/models/chapter.model';\n\nfunction updateProps(dataWithProps, namespaceMap) {\n  const showObjects = mapKeys(dataWithProps.showObjects, (value, key) =>\n    RenamespaceUtils.renamespaceValue(key, namespaceMap)\n  );\n  const selectObjects = mapKeys(dataWithProps.selectObjects, (value, key) =>\n    RenamespaceUtils.renamespaceValue(key, namespaceMap)\n  );\n  const pickThroughObjects = mapKeys(\n    dataWithProps.pickThroughObjects,\n    (value, key) => RenamespaceUtils.renamespaceValue(key, namespaceMap)\n  );\n  const synchronization = mapKeys(dataWithProps.synchronization, (value, key) =>\n    RenamespaceUtils.renamespaceValue(key, namespaceMap)\n  );\n  return {\n    showObjects,\n    selectObjects,\n    pickThroughObjects,\n    synchronization\n  };\n}\n\nfunction updateLabels(labels: LabelModel[], namespaceMap) {\n  const updateErrands = (errands: ErrandInterface[]) => {\n    return errands.map(errand => {\n      const renamespaceErrand =\n        errand.type === ErrandType.flyToChapter ||\n        errand.type === ErrandType.flyToObject;\n\n      if (!renamespaceErrand) {\n        return errand;\n      }\n\n      return {\n        ...errand,\n        value: RenamespaceUtils.renamespaceValue(errand.value, namespaceMap)\n      };\n    });\n  };\n\n  return (labels || []).map(label => {\n    return {\n      ...label,\n      objectId: RenamespaceUtils.renamespaceValue(label.objectId, namespaceMap),\n      states: label.states.map(state => {\n        return { ...state, errands: updateErrands(state.errands) };\n      })\n    };\n  });\n}\n\n\nfunction updateTimelineMap(timelineMaps, namespaceMap) {\n  return (timelineMaps || []).map(tmap => {\n    tmap.data.timeline = namespaceMap[tmap.data.timeline] || tmap.data.timeline;\n    return tmap;\n  });\n}\n\nfunction updateHotspots(hotspots, namespaceMap) {\n  return (hotspots || []).map(hotspot => {\n    if (hotspot.objectId) { \n      hotspot.objectId = RenamespaceUtils.renamespaceValue(\n        hotspot.objectId,\n        namespaceMap\n      ); \n    }\n    return hotspot;\n  });\n}\n\nfunction updateColorRecipes(colorRecipeObjects, namespaceMap) {\n\n  if (colorRecipeObjects) {\n    return {\n      xray: mapKeys(\n        colorRecipeObjects.xray,\n        (value, key) => RenamespaceUtils.renamespaceValue(key, namespaceMap)\n      ),\n      highlight: mapKeys(\n        colorRecipeObjects.highlight,\n        (value, key) => RenamespaceUtils.renamespaceValue(key, namespaceMap)\n      )\n    };\n  }\n\n  return {};\n}\n\nfunction updateChapters(chapters: ChapterModel[], namespaceMap) {\n  return chapters.map(chapter => {\n    return {\n      ...chapter,\n      ...updateProps(chapter, namespaceMap),\n      colorRecipeObjects: updateColorRecipes((chapter as any).colorRecipeObjects, namespaceMap),\n      timelineMap: updateTimelineMap(chapter.timelineMap, namespaceMap),\n      labels: updateLabels(chapter.labels, namespaceMap),\n      hotspots: updateHotspots(chapter.hotspots, namespaceMap)\n    };\n  });\n}\n\nfunction updateStateId(\n  stateId: string | string[],\n  namespaceMap: { [original: string]: string }\n): string[] {\n  // handle the unfortunate case where stateId is a string, instead of a string[]\n  if (typeof stateId === 'string') {\n    return [namespaceMap[stateId] || stateId];\n  }\n\n  return stateId.map(oldState => {\n    return namespaceMap[oldState] || oldState;\n  });\n}\n\nfunction updateSceneGraph(sceneGraph: SceneGraphNode[], namespaceMap) {\n  for (const node of sceneGraph) {\n    \n    ['objectId', 'displayName', 'geometryId', 'morphId', 'materialId'].forEach(\n      assetType => {\n        if (node[assetType]) {\n          node[assetType] = RenamespaceUtils.renamespaceValue(\n            node[assetType],\n            namespaceMap\n          );\n        }\n      }\n    );\n    \n    updateSceneGraph(node.objects || [], namespaceMap);\n  }\n\n  return sceneGraph;\n}\n\n/**\n * Renamespace all properties that reference the previous moduleId.\n * Check renamespace.spec for a full list of effected properties.\n */\n\nexport function renamespace(story: StoryModel, namespaceMap): StoryModel {\n  const stateId = updateStateId(story.stateId, namespaceMap);\n\n  // asset libs\n  const tweenLibs = story.assetLibraries.tweens.map(t =>\n    RenamespaceUtils.renamespaceValue(t, namespaceMap)\n  );\n  const reflectionLibs = story.assetLibraries.reflections.map(r =>\n    RenamespaceUtils.renamespaceValue(r, namespaceMap)\n  );\n\n  // reflections\n  const reflections = mapValues(story.reflections, (value, key) =>\n    RenamespaceUtils.renamespaceValue(value, namespaceMap)\n  );\n\n  const chapters = updateChapters(story.chapters, namespaceMap);\n\n  const sceneGraph = updateSceneGraph(\n    story.sceneGraph as SceneGraphNode[],\n    namespaceMap\n  );\n\n  return {\n    ...story,\n    stateId,\n    ...updateProps(story, namespaceMap),\n    assetLibraries: {\n      ...story.assetLibraries,\n      tweens: tweenLibs,\n      reflections: reflectionLibs\n    },\n    reflections,\n    chapters,\n    sceneGraph\n  };\n}\n","import { StrToBool } from './serialize-graph-types';\nimport { SceneGraphNode, HumanObjectTransform, HumanObjectRenderable, EuclideanData } from '../../models/scene-graph-node';\n\nconst EPS = 1e-4;\n\nexport namespace SerializeGraphUtils {\n\n  function filterEuclidean(data: EuclideanData, target: number = 0) {\n    ['x', 'y', 'z'].forEach(dimension => {\n      if (data[dimension] === undefined) {\n        return;\n      }\n  \n      if (Math.abs(data[dimension] - target) < EPS) {\n        delete data[dimension];\n      }\n    });\n  }\n\n  export function filterTransformProperties(transform: HumanObjectTransform) {\n    ['translate', 'rotate', 'pivot'].forEach(property => {\n      if (transform[property] === undefined) {\n        return;\n      }\n  \n      filterEuclidean(transform[property]);\n      if (Object.keys(transform[property]).length === 0) {\n        delete transform[property];\n      }\n    });\n  \n    if (transform.scale === undefined) {\n      return;\n    }\n  \n    filterEuclidean(transform.scale, 1.0);\n    if (Object.keys(transform.scale).length === 0) {\n      delete transform.scale;\n    }\n  }\n\n  // serialize non-default values on human object properties\n  export function serializeObjectProperties(humanObject: any, node: SceneGraphNode): void {\n    ['backfaces', 'displayName', 'layer'].forEach((property) => {\n      if (humanObject[property]) {\n        node[property] = humanObject[property];\n      }\n    });\n  }\n\n  export function serializeTransformData(humanObject: any, node: SceneGraphNode): void {\n    const transform = new HumanObjectTransform();\n    transform.translate = JSON.parse(JSON.stringify(humanObject.translate));\n    transform.rotate = JSON.parse(JSON.stringify(humanObject.rotate));\n    transform.scale = JSON.parse(JSON.stringify(humanObject.scale));\n    transform.pivot = JSON.parse(JSON.stringify(humanObject.pivot));\n    filterTransformProperties(transform);\n\n    Object.entries(transform).forEach(([transformType, transformVal]) => {\n      node[transformType] = JSON.parse(JSON.stringify(transformVal));\n    });\n    if (node.transformId) { delete node.transformId; }\n  }\n\n  export function serializeRenderables(humanObject: any, node: SceneGraphNode): SceneGraphNode {\n\n    const assetTypes: string[] = ['geometryId', 'morphId', 'materialId'];\n    const renderables: HumanObjectRenderable[] = [];\n\n    if (humanObject.renderables) {\n      humanObject.renderables.forEach((renderTarget) => {\n        const renderable = new HumanObjectRenderable;\n\n\n        // attach object's renderables to the graph\n        assetTypes.forEach(assetType => {\n          if (renderTarget[assetType]) {\n            renderable[assetType] = renderTarget[assetType];\n          }\n        });\n\n\n        // TODO is this supposed to filter out layer's with 0?\n        if (renderTarget.layer) {\n          renderable.layer = renderTarget.layer;\n        }\n\n        // add\n        renderables.push(renderable);\n      });\n    }\n\n    // serialize on to scene graph node\n    if (renderables.length === 1) {\n      node = { ...node, ...renderables[0] };\n    } else if (renderables.length > 1) {\n      node.renderables = renderables;\n    }\n\n    return node;\n  }\n\n\n  export function serializeHumanObject(\n    humanObject: any,\n    excludeMap: StrToBool\n  ): SceneGraphNode {\n\n\n    if (excludeMap[humanObject.objectId]) {\n      return null;\n    }\n    let result: SceneGraphNode = new SceneGraphNode();\n    result.objectId = humanObject.objectId;\n\n    // id\n    // By default object IDs do not change.\n    // The only time they would change is when making a deep copy of an entire model in scene editor.\n\n    // properties\n    serializeObjectProperties(humanObject, result);\n\n    // if there's a transform Id, prefer it over transform data\n    // to maintain backwards compatability, fall back to raw transform data\n    if (humanObject.transformId) {\n      result.transformId = humanObject.transformId;\n    } else {\n      serializeTransformData(humanObject, result);\n    }\n\n    // object renderables\n    result = serializeRenderables(humanObject, result);\n\n    // downward traversal\n    if (humanObject.objects && humanObject.objects.length) { result.objects = []; }\n    humanObject.objects.forEach((childObject) => {\n      const childNode = serializeHumanObject(childObject, excludeMap);\n      if (childNode !== null) {\n        result.objects.push(childNode);\n      }\n    }, this);\n\n    return result;\n  }\n}\n","import { SceneGraphNode } from '../../models/scene-graph-node';\nimport { StrToBool } from './serialize-graph-types';\nimport { SerializeGraphUtils } from './serialize-graph-utils';\n\n\n/* Serialize the Scene Graph for Module File Export\n*/\n\nexport function serializeGraph(rootObjects, excludeMap: StrToBool): SceneGraphNode[] {\n\n  const sceneGraph: SceneGraphNode[] = [];\n  Object.entries(rootObjects).forEach(([id, rootObject]) => {\n    const rootNode = SerializeGraphUtils.serializeHumanObject(rootObject, excludeMap);\n\n    if (rootNode !== null) {\n      sceneGraph.push(rootNode);\n    }\n  }, this);\n\n  return sceneGraph;\n}\n\n","import { EditViewEnum } from '../models/edit-view.enum';\r\nimport { ViewTreeNode } from '../../engine/models/view.tree-node';\r\nimport { PaintColorModel } from '../models/paint-color.model';\r\nimport { ColorRecipeModel } from '../models/color-recipe.model';\r\nimport { CanvasSizeModel } from '../models/canvas-size.model';\r\n\r\nexport class SetView {\r\n  static readonly type = '[Edit] Set view';\r\n  constructor(public view: EditViewEnum) { }\r\n}\r\n\r\nexport class NextView {\r\n  static readonly type = '[Edit] Next view';\r\n  constructor() { }\r\n}\r\n\r\nexport class PreviousView {\r\n  static readonly type = '[Edit] Previous view';\r\n  constructor() { }\r\n}\r\n\r\nexport class ShowColumns {\r\n  static readonly type = '[Edit] Show columns';\r\n  constructor(public show: boolean) { }\r\n}\r\n\r\nexport class ShowColumn {\r\n  static readonly type = '[Edit] Show column';\r\n  constructor(public column: 'left' | 'right' | 'header' | 'footer', public show: boolean) { }\r\n}\r\n\r\nexport class ResetEditPage {\r\n  static readonly type = '[Edit] Reset';\r\n  constructor() { }\r\n}\r\n\r\nexport class SetLayerOrderMode {\r\n  static readonly type = '[Edit] Set Layer Order Mode';\r\n  constructor(public layerOrderMode: boolean) {}\r\n}\r\n\r\nexport class ShowTreeNodeIds {\r\n  static readonly type = '[Edit] Show Tree Node Ids';\r\n  constructor(public show?: boolean) {}\r\n}\r\n\r\nexport class SetCanvasSize {\r\n  static readonly type = '[Edit] Set Canvas Size';\r\n  constructor(public size: CanvasSizeModel) {}\r\n}\r\n\r\nexport class AutoCapture {\r\n  static readonly type = '[Edit] Auto Capture';\r\n  constructor(public enable: boolean) {}\r\n}\r\n","import { EditViewEnum } from '../models/edit-view.enum';\nimport { ToolEnum } from 'src/app/engine/models/tool.enum';\nimport { CanvasSizeModel } from '../models/canvas-size.model';\n\nexport class EditStateModel {\n    view: EditViewEnum;\n    showColumns: boolean;\n    showLeftColumn: boolean;\n    showRightColumn: boolean;\n    showHeader: boolean;\n    showFooter: boolean;\n    autoCapture: boolean;\n    record: boolean;\n    layerOrderMode: boolean;\n    showTreeNodeIds: boolean;\n\n    canvasSize: CanvasSizeModel;\n    canvasSettings: {\n        emulateDrawer: boolean;\n        emulateColumn: boolean;\n    };\n}\n","import { State, Action, StateContext, Selector, NgxsOnInit, NgxsAfterBootstrap } from '@ngxs/store';\r\nimport { EditStateModel } from './edit.state.model';\r\nimport {\r\n  SetView,\r\n  ShowColumns,\r\n  ShowColumn,\r\n  ResetEditPage,\r\n  NextView,\r\n  PreviousView,\r\n  SetLayerOrderMode,\r\n  SetCanvasSize,\r\n  ShowTreeNodeIds,\r\n  AutoCapture\r\n} from './edit.actions';\r\nimport { EditViewEnum } from '../models/edit-view.enum';\r\nimport { EditPaintState } from './paint/edit.paint.state';\r\nimport { ResetPaint } from './paint/edit.paint.actions';\r\nimport { CanvasSizeOriginal } from '../models/canvas-size.const';\r\nimport { environment } from 'src/environments/environment';\r\nimport { EnvironmentApplication } from 'src/environments/models/environment-application';\r\nimport { StorageService, StorageItemEnum } from 'src/app/shared/storage.service';\r\n\r\nconst initialState = {\r\n  view: EditViewEnum.Chapter,\r\n  showColumns: true,\r\n  showLeftColumn: true,\r\n  showRightColumn: true,\r\n  showHeader: true,\r\n  showFooter: true,\r\n  autoCapture: (environment.application === EnvironmentApplication.Loft) ? false : true,\r\n  record: true,\r\n  layerOrderMode: false,\r\n  showTreeNodeIds: false,\r\n  canvasSize: CanvasSizeOriginal,\r\n  canvasSettings: {\r\n    emulateDrawer: true,\r\n    emulateColumn: true\r\n  }\r\n};\r\n\r\n@State<EditStateModel>({\r\n  name: 'edit',\r\n  defaults: initialState,\r\n  children: [\r\n    EditPaintState\r\n  ]\r\n})\r\nexport class EditState implements NgxsOnInit {\r\n  @Selector()\r\n  static getView(state: EditStateModel) {\r\n    return state.view;\r\n  }\r\n\r\n  @Selector()\r\n  static getShowColumns(state: EditStateModel) {\r\n    return state.showColumns;\r\n  }\r\n\r\n  @Selector()\r\n  static getShowLeftColumn(state: EditStateModel) {\r\n    return state.showLeftColumn;\r\n  }\r\n\r\n  @Selector()\r\n  static getShowRightColumn(state: EditStateModel) {\r\n    return state.showRightColumn;\r\n  }\r\n\r\n  @Selector()\r\n  static getShowHeader(state: EditStateModel) {\r\n    return state.showHeader;\r\n  }\r\n\r\n  @Selector()\r\n  static getShowFooter(state: EditStateModel) {\r\n    return state.showFooter;\r\n  }\r\n\r\n  @Selector()\r\n  static getRecord(state: EditStateModel) {\r\n    return state.record;\r\n  }\r\n\r\n  @Selector()\r\n  static getLayerOrderMode(state: EditStateModel) {\r\n    return state.layerOrderMode;\r\n  }\r\n\r\n  @Selector()\r\n  static getShowTreeNodeIds(state: EditStateModel) {\r\n    return state.showTreeNodeIds;\r\n  }\r\n\r\n  @Selector()\r\n  static getCanvasSize(state: EditStateModel) {\r\n    return state.canvasSize;\r\n  }\r\n\r\n  @Selector()\r\n  static getCanvasSettings(state: EditStateModel) {\r\n    return state.canvasSettings;\r\n  }\r\n\r\n  @Selector()\r\n  static getAutoCapture(state: EditStateModel) {\r\n    return state.autoCapture;\r\n  }\r\n\r\n  @Action(SetLayerOrderMode)\r\n  SetLayerOrderMode(context: StateContext<EditStateModel>, action: SetLayerOrderMode) {\r\n    context.patchState({\r\n      layerOrderMode: action.layerOrderMode\r\n    });\r\n  }\r\n\r\n  @Action(ShowTreeNodeIds)\r\n  ShowTreeNodeIds(context: StateContext<EditStateModel>, action: ShowTreeNodeIds) {\r\n    const show = (action.show != null) ? action.show : !context.getState().showTreeNodeIds;\r\n\r\n    context.patchState({\r\n      showTreeNodeIds: show\r\n    });\r\n  }\r\n\r\n  @Action(SetView)\r\n  setView(context: StateContext<EditStateModel>, action: SetView) {\r\n    context.patchState({\r\n      view: action.view\r\n    });\r\n  }\r\n\r\n  @Action(NextView)\r\n  nextView(context: StateContext<EditStateModel>, action: NextView) {\r\n    const { view } = context.getState();\r\n\r\n    const views = Object.values(EditViewEnum);\r\n    const next = views[views.indexOf(view) + 1] || views[0];\r\n\r\n    context.patchState({\r\n      view: next\r\n    });\r\n  }\r\n\r\n  @Action(PreviousView)\r\n  previousView(context: StateContext<EditStateModel>, action: NextView) {\r\n    const { view } = context.getState();\r\n\r\n    const views = Object.values(EditViewEnum);\r\n    const previous = views[views.indexOf(view) - 1] || views[views.length - 1];\r\n\r\n    context.patchState({\r\n      view: previous\r\n    });\r\n  }\r\n\r\n  @Action(ShowColumns)\r\n  showColumns(context: StateContext<EditStateModel>, action: ShowColumns) {\r\n    context.patchState({\r\n      showColumns: action.show\r\n    });\r\n  }\r\n\r\n  @Action(ShowColumn)\r\n  showColumn(context: StateContext<EditStateModel>, action: ShowColumn) {\r\n    switch (action.column) {\r\n      case 'left':\r\n        context.patchState({\r\n          showLeftColumn: action.show\r\n        });\r\n        break;\r\n      case 'right':\r\n        context.patchState({\r\n          showRightColumn: action.show\r\n        });\r\n        break;\r\n      case 'header':\r\n        context.patchState({\r\n          showHeader: action.show\r\n        });\r\n        break;\r\n      case 'footer':\r\n        context.patchState({\r\n          showFooter: action.show\r\n        });\r\n        break;\r\n    }\r\n  }\r\n\r\n  @Action(ResetEditPage)\r\n  resetEditPage(context: StateContext<EditStateModel>, action: ResetEditPage) {\r\n    context.setState(initialState);\r\n    context.dispatch(new ResetPaint());\r\n  }\r\n\r\n  @Action(SetCanvasSize)\r\n  setCanvasSize(context: StateContext<EditStateModel>, action: SetCanvasSize) {\r\n    context.patchState({\r\n      canvasSize: action.size\r\n    });\r\n  }\r\n\r\n  @Action(AutoCapture)\r\n  autoCapture(context: StateContext<EditStateModel>, action: AutoCapture) {\r\n    context.patchState({\r\n      autoCapture: action.enable\r\n    });\r\n\r\n    if (environment.application === EnvironmentApplication.Studio) {\r\n      this.storageService.setLocalItem(StorageItemEnum.AutoCapture, action.enable);\r\n    }\r\n  }\r\n\r\n  constructor(\r\n    private storageService: StorageService\r\n  ) {}\r\n\r\n  ngxsOnInit(context: StateContext<EditStateModel>) {\r\n    setTimeout(() => {\r\n      this.initAutoCapture(context);\r\n    });\r\n  }\r\n\r\n  // For Studio users only, we persist their autoCapture setting between sessions\r\n  // For Loft users, autoCapture always defaults to false\r\n  private initAutoCapture(context: StateContext<EditStateModel>) {\r\n    if (environment.application === EnvironmentApplication.Studio) {\r\n      const autoCapture = this.storageService.getLocalJSON(StorageItemEnum.AutoCapture);\r\n      \r\n      if (typeof autoCapture === 'boolean') {\r\n        context.patchState({\r\n          autoCapture: autoCapture\r\n        });\r\n      }\r\n    }\r\n  }\r\n}\r\n","import { ColorRecipeModel } from '../../models/color-recipe.model';\nimport { PaintBrushMode } from '../../models/paint-brush-mode.enum';\n\nexport class SetColorRecipe {\n  static readonly type = '[Edit Paint] Set Color Recipe';\n  constructor(public colorRecipe: ColorRecipeModel) { }\n}\n\nexport class SetPaintBrushMode {\n  static readonly type = '[Edit Paint] Set Paint Brush Mode';\n  constructor(public brushMode: PaintBrushMode) { }\n}\n\nexport class ClearColorRecipe {\n  static readonly type = '[Edit Paint] Clear Color Recipe';\n  constructor() { }\n}\n\nexport class ResetPaint {\n  static readonly type = '[Edit Paint] Reset Paint';\n  constructor() { }\n}\n","import { ColorRecipeModel } from '../../models/color-recipe.model';\nimport { PaintBrushMode } from '../../models/paint-brush-mode.enum';\n\nexport class EditPaintStateModel {\n    colorRecipe: ColorRecipeModel;\n    brushMode: PaintBrushMode;\n}\n","import { State, Action, StateContext, Selector } from '@ngxs/store';\nimport { EditPaintStateModel } from './edit.paint.state.model';\nimport { SetColorRecipe, ClearColorRecipe, ResetPaint, SetPaintBrushMode } from './edit.paint.actions';\nimport { PaintPresetRed } from 'src/app/engine/models/paint-presets.const';\nimport { PaintBrushMode } from '../../models/paint-brush-mode.enum';\n\nconst initialState = {\n  colorRecipe: PaintPresetRed.recipe,\n  brushMode: PaintBrushMode.Modify\n};\n\n@State<EditPaintStateModel>({\n  name: 'editPaint',\n  defaults: initialState \n})\nexport class EditPaintState {\n  /**\n   * Selectors\n   */\n  @Selector()\n  static getColorRecipe(state: EditPaintStateModel) {\n    return state.colorRecipe;\n  }\n\n  @Selector()\n  static getPaintBrushMode(state: EditPaintStateModel) {\n    return state.brushMode;\n  }\n\n  /**\n   * Actions\n   */\n  @Action(SetColorRecipe)\n  setColorRecipe(context: StateContext<EditPaintStateModel>, { colorRecipe }: SetColorRecipe) {\n    context.patchState({\n      colorRecipe\n    });\n  }\n\n  @Action(SetPaintBrushMode)\n  setBrushMode(context: StateContext<EditPaintStateModel>, action: SetPaintBrushMode) {\n    context.patchState({\n      brushMode: action.brushMode\n    });\n  }\n\n  @Action(ClearColorRecipe)\n  clearColorRecipe(context: StateContext<EditPaintStateModel>, action: ClearColorRecipe) {\n    context.patchState({\n      colorRecipe: null\n    });\n  }\n  \n  @Action(ResetPaint)\n  resetPaint(context: StateContext<EditPaintStateModel>, action: ResetPaint) {\n    context.setState(initialState);\n  }\n\n  constructor(\n  ) { }\n}\n","import { Injectable } from '@angular/core';\nimport { PlayConfigurationModel } from './models/animation/play-configuration.model';\nimport { TimerangeModel } from './models/animation/timerange.model';\nimport { plainToClass } from 'class-transformer';\nimport { get } from 'lodash';\nimport { SetConfigurationModel } from './models/animation/set-configuration.model';\nimport { ChapterModel } from '../story/models/chapter.model';\n\ndeclare const Human: any;\n\ninterface TimelinePlayParams {\n  [key: string]: any;\n}\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class AnimationService {\n  playParams: PlayConfigurationModel; \n\n  constructor(\n  ) { }\n\n  getChapterLocalTimerange(chapterId: string): TimerangeModel {\n    const chapter = Human.timeline.activeRoot._chapters.find(_chapter => _chapter.id === chapterId);\n    return plainToClass(TimerangeModel, chapter.timeRange as object);\n\n    // Human.timeline.activeRoot._nowBranch;\n    // get branch timeline:               <branch>.getTimeframe()\n    // convert local to globalTime:       Human.timeline.activeRoot.mapBranchTime(<branch>, 1);\n    // scrub animation using globalTime:  Human.timeline.scrub(globalTime):  \n  }\n\n  mapGlobalTimeToLocal(time: number, params = {}): {branch: any, time: number, index: number} {\n    const localTime = Human.timeline.activeRoot.mapGlobalTime(time, params);\n\n    // BUG: When globalTime is zero, localTime is -3\n    if (localTime.time < 0) {\n      localTime.time = 0;\n    }\n\n    return localTime;\n    // return Human.timeline.activeRoot.mapGlobalTime(time, params);\n  }\n\n  mapLocalTimeToGlobal(chapterId: string, time: number): number {\n    const branch = Human.timeline.activeRoot._chapters.find(chapter => chapter.id === chapterId);\n    return Human.timeline.activeRoot.mapBranchTime(branch, time);\n  }\n\n  isChapterAnimated(chapter) {\n    const isAnimated = chapter.timelineMap\n      .filter(timeline => {\n        return get(timeline, 'data.timeline') !== 'dummy' &&\n          get(timeline, 'data.timeline.id') !== 'dummy' &&\n          get(timeline, 'data.timeline.id.id') !== 'dummy';\n      }).length > 0;\n\n    return isAnimated;  \n  }\n\n  isChapterLooped(chapter: ChapterModel) {\n    if (get(chapter, 'loop') === true) {\n      return true;\n    }\n\n    if (get(chapter, 'ui.play.count') === -1) {\n      return true;\n    }\n\n    return false;\n  }\n\n\n  scrub(options: SetConfigurationModel) {\n    const which = options.which ? options.which : 'first';\n    Human.timeline.scrub({\n      time: options.time,\n      borderCondition: {\n        which: which,\n        direction: 'forward'\n      }\n    });\n\n  }\n\n  getTimeFrame() {\n    return Human.timeline.getTimeFrame();\n  }\n\n  getTime() {\n    return Human.timeline.time;\n  }\n\n  isPlaying() {\n    return Human.timeline.playing;\n  }\n\n  hasChapterFinished(chapterId: string) {\n    const timerange = this.getChapterLocalTimerange(chapterId);\n    const localTime = this.mapGlobalTimeToLocal(Human.timeline.time);\n    \n    return (localTime.time === timerange.lastTime);\n  }\n\n  play(options: PlayConfigurationModel) {\n    // spread props, but filter any that are undefined.\n    // The engine does `hasOwnProperty` checks, so `undefined` params can slip through the cracks if not careful\n    this.playParams = Object.keys(options).reduce<PlayConfigurationModel>(\n      (acc, option) => {\n        if (acc[option] === undefined) {\n          delete acc[option];\n        }\n        return acc;\n      },\n      { ...options }\n    );\n    \n    Human.timeline.play( this.playParams );\n  }\n\n  rewind(chapterId: string) {\n    const resetTime = this.mapLocalTimeToGlobal(chapterId, 0);\n    this.scrub({time: resetTime, which: 'second'});\n  }\n\n  unpause(chapterId: string) {\n    // If the user unpauses at the end of an animation, it starts playing the next chapter, so this rewinds first\n    if (this.hasChapterFinished(chapterId)) {\n      this.rewind(chapterId);\n    }\n\n    Human.timeline.unpause();\n  }\n\n  pause() {\n    Human.timeline.pause();\n  }\n\n  // Human.timeline.scrub({\n    //   time: 1\n    // });\n\n    // Human.timeline.activeRoot._nowBranch;\n    // Human.timeline.activeRoot.mapGlobalTime(Human.timeline.time);\n\n    // Sequence of events:\n    // Human.timeline.activeRoot._nowBranch;\n    // get branch timeline:               <branch>.getTimeframe()\n    // convert local to globalTime:       Human.timeline.activeRoot.mapBranchTime(<branch>, 1);\n    // scrub animation using globalTime:  Human.timeline.scrub(globalTime):  \n\n    // Border conditions:\n    // Human.timeline.borderConditions (both end of chapter and start of another)\n    // Human.timeline.scrub({ time: 7, borderCondition: { which: 'second', direction: 'forward' }}) == start\n    // Human.timeline.scrub({ time: 7, borderCondition: { which: 'first', direction: 'forward' }}) == end\n\n    // Events\n    // timeline.scrubbed (globalTime)\n    // timeline.play\n\n    // Playing (start conditions, end conditions, play conditions)\n    // Human.timeline.play({ startChapterId: ..., numChapters: 1, loop: true })\n\n}\n","// tslint:disable no-bitwise\ndeclare const Human: any;\ndeclare const vec3: any;\n\nimport { Injectable } from '@angular/core';\nimport { XYZModel } from '../shared/models/xyz.model';\nimport { HitModel } from './models/hit.model';\nimport { CameraModel } from './models/camera.model';\nimport { NumberService } from '../shared/number.service';\nimport { Observable } from 'rxjs';\nimport { BoundaryModel } from './models/boundary.model';\n\nconst epsilon = 0.001;\nconst zoomRate = 0.03;\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class CameraService {\n  rotation = { vx: 0, vy: 0 };\n  pan = { x: 0, y: 0, z: 0 };\n  zoom = 0;\n\n  constructor(private numberService: NumberService) {\n\n  }\n\n  getEye(): XYZModel {\n    return Human.renderer.camera.eye as XYZModel;\n  }\n\n  setEye(eye: XYZModel) {\n    Human.renderer.camera.setLookAt({\n      eye\n    });\n  }\n\n  getCamera(): CameraModel {\n    return Human.renderer.camera.getLookAt() as CameraModel;\n  }\n\n  getLookDirection(): [number, number, number] {\n    const dir = vec3.create();\n    Human.renderer.camera.getLookDir(dir);\n    return dir;\n  }\n\n  setCamera(camera: CameraModel) {\n    return Human.renderer.camera.setLookAt(camera);\n  }\n\n  getCameraZoom(): number {\n    return Human.renderer.camera.getZoom();\n  }\n\n  captureCamera(): {lookAt: CameraModel, zoom: number} {\n    return {\n      lookAt: Human.renderer.camera.getLookAt(),\n      zoom: Human.renderer.camera.getZoom()\n    };\n  }\n\n  resetCamera() {\n    return new Observable((observer) => {\n      Human.init.resetCamera(() => {\n        observer.next();\n        observer.complete();\n      });\n    });\n  }\n  \n  getDirection(hit: HitModel) {\n    const camera = this.getEye();\n    const direction = vec3.create();\n    direction[0] = camera.x - hit.worldPos[0];\n    direction[1] = camera.y - hit.worldPos[1];\n    direction[2] = camera.z - hit.worldPos[2];\n    vec3.normalize(direction, direction);\n\n    return direction;\n  }\n\n  rotateCameraStatic(x: number, y: number) {\n    Human.renderer.camera.rotateX(x);\n    Human.renderer.camera.rotateY(y);\n  }\n\n  panCameraStatic(x: number, y: number, z: number) {\n    Human.renderer.camera.pan({x, y, z});\n  }\n\n\n  setHumanZoom(delta: number) {\n    Human.renderer.camera.zoom(delta);\n  }\n\n  setHumanZoomFactor(zoomFactor: number) {\n    Human.renderer.camera.setZoom(zoomFactor);\n  }\n\n  setCameraRotation(velocityX: number, velocityY: number) {\n    this.rotation.vx = velocityY;\n    this.rotation.vy = -velocityX;\n  }\n  \n  setCameraPan(velocityX: number, velocityY: number) {\n    this.pan.x = velocityX;\n    this.pan.y = velocityY;\n  }\n\n  setCameraZoom(deltaY: number) {\n    this.zoom = deltaY * zoomRate;\n  }\n\n  setCameraZoomWithVelocity(deltaY: number) {\n    this.setCameraZoom(deltaY);\n\n    requestAnimationFrame(() => {\n      deltaY *= 0.85;\n      if (Math.abs(deltaY) > 1) {\n        this.setCameraZoomWithVelocity(deltaY);\n      }\n    });\n  }\n  \n  \n  tickCameraRotation() {\n    this.rotation.vx = this.checkEpsilon(this.rotation.vx);\n    this.rotation.vy = this.checkEpsilon(this.rotation.vy);\n    \n    return this.rotation;\n  }\n  \n  tickCameraPan() {\n    this.pan.x = this.checkEpsilon(this.pan.x);\n    this.pan.y = this.checkEpsilon(this.pan.y);\n    this.pan.z = this.checkEpsilon(this.pan.z);\n    \n    return this.pan;\n  }\n\n  tickCameraZoom() {\n    this.zoom = this.checkEpsilon(this.zoom);\n\n    return this.zoom;\n  }\n\n  /**\n   * Returns if the cameras are equivalent.\n   */\n  areCamerasEqual(camera1: CameraModel, camera2: CameraModel): boolean {\n    return this.compareXYZ(camera1.eye, camera2.eye)\n      && this.compareXYZ(camera1.look, camera2.look)\n      && this.compareXYZ(camera1.up, camera2.up);\n  }\n\n  /**\n   * Returns if the XYZ coordinates are equal.\n   */\n  compareXYZ(model1: XYZModel, model2: XYZModel): boolean {\n    return model1.x === model2.x\n      && model1.y === model2.y\n      && model1.z === model2.z;\n  }\n\n  /**\n   * Rounds the camera to the specified precision.\n   */\n  roundCamera(camera: CameraModel, precision: number): CameraModel {\n    const { eye, look, up } = camera;\n    return {\n      eye: this.numberService.roundModel<XYZModel>(eye, precision),\n      look: this.numberService.roundModel<XYZModel>(look, precision),\n      up: this.numberService.roundModel<XYZModel>(up, precision)\n    };\n  }\n\n  /**\n   * Ported from engine flyAnimation.js\n   * Pure fn that returns the resulting CameraModel after a flyTo to an object's boundary.\n   * @param objectBoundary found by object.getBoundary()\n   */\n  cameraAfterFlyTo(objectBoundary: BoundaryModel): CameraModel {\n    const startCamera = this.getCamera();\n    const _look1 = XYZModel.toArray(startCamera.look);\n    const _eye1 = XYZModel.toArray(startCamera.eye);\n  \n    const tempVec = vec3.create();\n    vec3.subtract(tempVec, _eye1, _look1);\n  \n    const _vec = vec3.create();\n    vec3.normalize(_vec, tempVec);\n  \n    const stopFOV = 55;\n    const backOff = 1.0;\n    const dist = 2.5;\n    // ?? : this._vec is normalized, this might be changed to lenVec = 1\n    const lenVec = Math.abs(vec3.length(_vec));\n    const diag = Human.math.getBoundaryDiag(objectBoundary);\n    const len = Math.abs(diag / (1.0 + backOff * 0.8) / Math.tan(stopFOV / 2)); /// Tweak this to set final camera distance on arrival\n    const sca = (len / lenVec) * dist;\n    const _look2 = Human.math.getBoundaryCenter(objectBoundary);\n  \n    vec3.scale(tempVec, _vec, sca);\n    const _eye2 = vec3.add(vec3.create(), _look2, tempVec);\n    \n    return {\n      eye: XYZModel.fromArray(_eye2),\n      look: XYZModel.fromArray(_look2),\n      up: {x: 0, y: 1, z: 0}\n    };\n  }\n\n\n  private checkEpsilon(value: number) {\n    return (Math.abs(value) < epsilon) ? 0 : value;\n  }\n}\n","import { Store } from '@ngxs/store';\nimport { ParticleSystem } from '../models/particles/particle-system-types';\nimport { EngineParticlesState } from '../state/particles/particles.state';\nimport { StoryChaptersState } from 'src/app/story/state/chapters/story.chapters.state';\nimport { TweenParticleLookup } from 'src/app/shared/tween-particle-lookup';\nimport { StoryState } from 'src/app/story/state/story.state';\nimport { isEmpty } from 'lodash';\nimport { Subject, merge } from 'rxjs';\nimport { takeUntil, distinctUntilChanged } from 'rxjs/operators';\nimport { ParticleActions } from '../state/particles/particles.actions';\n\ndeclare const Human;\n\nexport class ParticleStateListener {\n  private store: Store;\n  private ngUnsubsribe = new Subject(); \n\n  constructor(store: Store) {\n    this.store = store;\n    this.listenForParticleChanges();\n    this.listenForLookupChanges();\n  }\n\n  destroy() {\n    this.ngUnsubsribe.next();\n    this.ngUnsubsribe.complete();\n  }\n\n  private listenForLookupChanges() {\n    this.store\n      .select(EngineParticlesState.getTweenParticleLookup)\n      .pipe(takeUntil(this.ngUnsubsribe))\n      .subscribe((lookup) => {\n        if (!isEmpty(lookup)) {\n          TweenParticleLookup.refreshEngineLookup(\n            this.store.selectSnapshot(StoryState.getStoryId),\n            lookup\n          );\n        }\n      });\n  }\n\n  private listenForParticleChanges() {\n    const chapterTransition$ = this.store.select(StoryChaptersState.getSelectedChapterId)\n      .pipe(distinctUntilChanged());\n    const particleSystems$ = this.store.select(EngineParticlesState.getParticleSystems);\n    const particleSystemsVisible$ = this.store.select(EngineParticlesState.getVisisbleParticleSystems);\n\n    // track changes to systems and/or visiblity\n    merge(\n      particleSystems$,\n      particleSystemsVisible$\n    )    \n      .pipe(takeUntil(this.ngUnsubsribe))\n      .subscribe(() => {\n      const activeChapterId = this.store.selectSnapshot(\n        StoryChaptersState.getSelectedChapterId\n      );\n\n      const chapterParticles = this.store.selectSnapshot(\n        EngineParticlesState.particleSystemsForChapter(activeChapterId)\n      );\n\n      const visibleParticleSystems = this.store.selectSnapshot(\n        EngineParticlesState.getVisisbleParticleSystems\n      );\n\n      // get rendered particle system for chapter\n      const visibleChapterParticles = chapterParticles\n        .filter((system) => {\n          // show unless explicitly hidden\n          return visibleParticleSystems[system.id] !== false;\n        });\n\n      this.setEngineParticles(visibleChapterParticles);\n    });\n\n    // reset visiblity on chapter transition\n    chapterTransition$\n      .pipe(takeUntil(this.ngUnsubsribe))\n      .subscribe(() => {\n        this.store.dispatch(new ParticleActions.SetParticleSystemsVisible(true));\n      });\n  }\n\n  private setEngineParticles(particles: ParticleSystem[] = []) {\n    // disable everything..\n    // we can't destroy or disable by Id, because when a particle is deleted, the arg `particles` is []\n    Human.particles.disableAll();\n    Human.particles.resetAll();\n\n    // copy particles to the engine\n    const particleCopies = JSON.parse(JSON.stringify(particles));\n\n    // Parse is async!\n    Human.particles.parse(particleCopies, () => {\n      \n      // enable particles in this chapter\n      particles.forEach((particle) => {\n        Human.particles.enable(particle.id);\n      });\n\n      // assign to the active timeline.\n      const canSetChapterParticles = Human.timeline.activeRoot != null;\n\n      if (canSetChapterParticles) {\n        Human.timeline.activeRoot._nowBranch.particleSystems = particles.map(\n          (particle) => particle.id\n        );\n      }\n    });\n  }\n}\n","<!-- Camera -->\n<div class=\"camera-bar\" gaCategory=\"Engine 3D Controls\">\n  <app-pillbox\n    eventCategory=\"Engine 3D Controls\"\n    orientation=\"vertical\"\n    *ngIf=\"showNav\"\n    [attr.data-test]=\"testSelectors.EngineCameraBar\">\n    <div class=\"camera-bar__nav\">\n      <!-- Zoom Out -->\n      <button \n        gaEvent\n        gaAction=\"Clicked Zoom Out\"\n        app-pin-button\n        *ngIf=\"showZoom\"\n        buttonType=\"ghost\"\n        icon=\"minus\"\n        tabIndex=\"0\"\n        (touchstart)=\"setZoom('out')\"\n        (mousedown)=\"setZoom('out')\"\n        (touchend)=\"setZoom('')\"\n        (mouseup)=\"setZoom('')\"\n        (mouseleave)=\"setZoom('')\"\n        (keyup.enter)=\"setZoomFixed('out')\"\n        aria-label=\"Zoom Out\"\n        matTooltip=\"Zoom Out\"\n        matTooltipPosition=\"left\">\n      </button>\n\n      <!-- Zoom In -->\n      <button \n        gaEvent\n        gaAction=\"Clicked Zoom In\"\n        app-pin-button\n        *ngIf=\"showZoom\"\n        buttonType=\"ghost\"\n        icon=\"plus\"\n        tabIndex=\"0\"\n        (touchstart)=\"setZoom('in')\"\n        (mousedown)=\"setZoom('in')\"\n        (touchend)=\"setZoom('')\"\n        (mouseup)=\"setZoom('')\"\n        (mouseleave)=\"setZoom('')\"\n        (keyup.enter)=\"setZoomFixed('in')\"\n        aria-label=\"Zoom In\"\n        matTooltip=\"Zoom In\"\n        matTooltipPosition=\"left\">\n      </button>\n\n      <!-- Return to chapter position -->\n      <button \n        gaEvent\n        gaAction=\"Clicked Recenter 3D Model\"\n        app-pin-button\n        *ngIf=\"showResetPosition\"\n        icon=\"location\"\n        buttonType=\"ghost\"\n        tabIndex=\"0\"\n        (click)=\"returnToChapterCamera()\"\n        aria-label=\"Recenter 3D model\"\n        matTooltip=\"Recenter 3D model\"\n        matTooltipPosition=\"left\">\n      </button>\n\n      <!-- Pan Mode -->\n      <button \n        gaEvent\n        gaAction=\"Clicked Switch Mode\"\n        [gaLabel]=\"(panMode$ | async) === 'pan' ? 'Rotate' : 'Pan'\"\n        app-pin-button\n        [selected]=\"(panMode$ | async) === 'pan'\"\n        tabIndex=\"0\"\n        *ngIf=\"showPan\"\n        icon=\"arrows-alt\"\n        buttonType=\"ghost\"\n        (click)=\"togglePan()\"\n        [attr.aria-label]=\"(panMode$ | async) === 'pan' ? 'Switch to Rotate Mode' : 'Switch to Pan Mode'\"\n        [matTooltip]=\"(panMode$ | async) === 'pan' ? 'Switch to Rotate Mode' : 'Switch to Pan Mode'\"\n        matTooltipPosition=\"left\">\n      </button>\n      \n    </div>\n  </app-pillbox>  \n</div>","import { Component, OnInit, ChangeDetectionStrategy, Input, ViewEncapsulation, OnDestroy } from '@angular/core';\nimport { ToolEnum } from '../../models/tool.enum';\nimport { Select, Store } from '@ngxs/store';\nimport { EngineCameraState } from '../../state/camera/engine.camera.state';\nimport { Observable, Subject } from 'rxjs';\nimport { ZoomCamera, SetCamera, SetCameraMode } from '../../state/camera/engine.camera.actions';\nimport { StoryChaptersState } from 'src/app/story/state/chapters/story.chapters.state';\nimport { CenterCameraOnVisible } from '../../state/engine.actions';\nimport { ViewUI } from 'src/app/view/models/view-ui.enum';\nimport { RemoveContextLabel } from 'src/app/story/state/labels/story.labels.actions';\nimport { transition, trigger, sequence, style, animate } from '@angular/animations';\nimport { TestSelectors } from 'e2e/selectors/test-selectors';\nimport { BreakpointState, BreakpointStateModel } from 'src/app/breakpoint/state/breakpoint.state';\nimport { Breakpoint } from 'src/app/breakpoint/models/breakpoint.enum';\nimport { NodeActions } from '../../state/nodes/engine.nodes.actions';\nimport { UndoState } from 'src/app/undo/state/undo.state';\nimport { UndoActions } from 'src/app/undo/state/undo.state.actions';\nimport { CameraService } from '../../camera.service';\n\n@Component({\n  selector: 'app-engine-camera-bar',\n  templateUrl: './engine-camera-bar.component.html',\n  styleUrls: ['./engine-camera-bar.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None,\n  animations: [\n    trigger('expand', [\n      transition(':enter', [\n        sequence([\n          style({\n            height: 0\n          }),\n          animate('150ms ease-in-out', style({ \n            height: '*'\n          }))\n        ])\n      ]),\n      transition(':leave', [\n        sequence([\n          animate('150ms ease-in-out', style({ \n            height: '0'\n          }))\n        ])\n      ])\n    ]),\n\n    trigger('show', [\n      transition(':enter', [\n        sequence([\n          style({ \n            height: '0'\n          }),\n          animate('125ms ease-in-out', style({ \n            height: '*'\n          }))\n        ])\n      ]),\n      transition(':leave', [\n        sequence([\n          animate('125ms 125ms ease-in-out', style({ \n            height: '0'\n          }))\n        ])\n      ])\n    ])\n  ]\n})\nexport class EngineCameraBarComponent implements OnInit, OnDestroy {\n  // ---------- Selectors ----------\n  @Select(EngineCameraState.getPanMode)\n  panMode$: Observable<string>;\n\n  @Select(BreakpointState.getBreakpoint)\n  breakpoint$: Observable<Breakpoint>;\n\n\n\n  // ---------- Input / Output ----------\n  @Input()\n  showNav = true;\n\n  @Input()\n  showZoom = true;\n\n  @Input()\n  showPan = true;\n\n  @Input()\n  showResetPosition = true;\n\n  \n\n  // ---------- Properties ----------\n  viewLayout = ViewUI;\n  toolEnum = ToolEnum;\n  testSelectors = TestSelectors;\n  expandNav = false;\n  breakpoint: Breakpoint;\n  breakpointEnum = Breakpoint;\n  padding: 'dense' | 'none' = 'none';\n  ngUnsubscribe = new Subject();\n\n\n  // ----------- Lifecycle ----------\n  constructor(\n    private store: Store,\n    private cameraService: CameraService\n  ) { }\n\n  ngOnInit() {\n    \n  }\n\n  ngOnDestroy() {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n  setZoom(state: 'in' | 'out' | '') {\n    let zoomValue = (state === '') ? 0 : 8;\n    zoomValue = (state === 'in') ? -zoomValue : zoomValue;\n    \n    this.store.dispatch(new ZoomCamera(zoomValue));\n  }\n\n  setZoomFixed(state: 'in' | 'out') {\n    const zoomValue = (state === 'in') ? -8 : 8;\n    this.cameraService.setCameraZoomWithVelocity(zoomValue);\n  }\n\n  returnToChapterCamera() {\n    const chapter = this.store.selectSnapshot(StoryChaptersState.getSelectedChapter);\n    this.store.dispatch(new SetCamera(chapter.camera.location));\n  }\n\n  resetChapter() {\n    this.returnToChapterCamera();\n  \n    const chapterId = this.store.selectSnapshot(\n      StoryChaptersState.getSelectedChapterId\n    );\n    this.store.dispatch(new UndoActions.UndoAll(chapterId));\n\n    this.store.dispatch(\n      new NodeActions.UpdateNodesChecked(false)\n    );\n    this.store.dispatch(new RemoveContextLabel());\n  }\n\n  centerCamera() {\n    this.store.dispatch(new CenterCameraOnVisible());\n  }\n\n  togglePan() {\n    const mode = this.store.selectSnapshot(EngineCameraState.getPanMode) === 'pan' ? 'rotate' : 'pan';\n    this.store.dispatch(new SetCameraMode(mode));\n  }\n\n  toggleNav() {\n    this.expandNav = !this.expandNav;\n  }\n}\n","<div class=\"engine-camera-position\">\n    X:{{ camera?.x }} Y:{{ camera?.y }} Z:{{ camera?.z }} Dist:{{ camera?.dist }}\n</div>","import { Component, OnInit, ChangeDetectorRef, ChangeDetectionStrategy } from '@angular/core';\nimport { EngineService } from '../../engine.service';\nimport { EventsEnum } from '../../models/events.enum';\nimport { auditTime } from 'rxjs/operators';\n\n@Component({\n  selector: 'app-engine-camera-position',\n  templateUrl: './engine-camera-position.component.html',\n  styleUrls: ['./engine-camera-position.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class EngineCameraPositionComponent implements OnInit {\n  camera: any = {\n    x: 0,\n    y: 0,\n    z: 0,\n    dist: 0\n  };\n\n  constructor(\n    private engineService: EngineService,\n    private changeDetectionRef: ChangeDetectorRef\n  ) { }\n\n  ngOnInit() {\n    this.initCameraListener();\n  }\n\n  initCameraListener() {\n    this.engineService.getEvent(EventsEnum.CameraUpdated)\n      .pipe(\n        auditTime(50)\n      )\n      .subscribe(camera => {\n        this.camera = {\n          x: camera.eye.x.toFixed(0),\n          y: camera.eye.y.toFixed(0),\n          z: camera.eye.z.toFixed(0),\n          dist: camera.dist.toFixed(0)\n        };\n\n        this.changeDetectionRef.markForCheck();\n      });\n  }\n\n}\n","<div class=\"contextmenu\">\n  <app-node-actions\n    class=\"contextmenu__node-actions\"\n    eventCategory=\"Context Node\"\n    [ngStyle]=\"getNodeActionsStyles()\"\n    [node]=\"node\"\n    (nodeActionsClosed)=\"onNodeActionsClosed()\"\n    theme=\"light\">\n  </app-node-actions>\n</div>","import { Component, OnInit, Input, ViewChild, AfterViewInit } from '@angular/core';\nimport { Store } from '@ngxs/store';\nimport { NodeActionsComponent } from 'src/app/shared/components/node-actions/node-actions.component';\nimport { HitModel } from '../../models/hit.model';\nimport { ViewTreeNode } from '../../models/view.tree-node';\nimport { SetContextMenu } from '../../state/engine.actions';\n\n@Component({\n  selector: 'app-engine-contextmenu',\n  templateUrl: './engine-contextmenu.component.html',\n  styleUrls: ['./engine-contextmenu.component.scss']\n})\nexport class EngineContextmenuComponent implements OnInit, AfterViewInit {\n\n  @ViewChild(NodeActionsComponent, { static: true })\n  nodeActionsComponent: NodeActionsComponent;\n\n  @Input()\n  node: ViewTreeNode;\n\n  @Input()\n  hit: HitModel;\n\n  constructor(\n    private store: Store\n  ) { }\n\n  ngOnInit() {\n  }\n\n  ngAfterViewInit() {\n    this.nodeActionsComponent.nodeActionsTrigger.openMenu();\n  }\n\n  onNodeActionsClosed() {\n    this.store.dispatch(new SetContextMenu(null, null));\n  }\n\n  getNodeActionsStyles() {\n    return {\n      'left.px': this.hit ? this.hit.canvasPos[0] : 0,\n      'top.px': this.hit ? this.hit.canvasPos[1] : 0,\n    };\n  }\n\n}\n","<div\n    class=\"engine-fade\"\n    [@fade]=\"{ value: isVisible, params: { backgroundColor: color, duration: duration }}\"\n    (@fade.done)=\"handleFadeComplete()\"></div>","import { Component, OnInit, ChangeDetectionStrategy, ViewEncapsulation, OnDestroy, ChangeDetectorRef } from '@angular/core';\nimport { Actions, ofActionDispatched, Store } from '@ngxs/store';\nimport { Subject } from 'rxjs';\nimport { Fade, FadeOut, FadeComplete } from '../../state/engine.actions';\nimport { takeUntil } from 'rxjs/operators';\nimport { trigger, transition, sequence, style, animate, state, keyframes, AnimationReferenceMetadata, animation, useAnimation } from '@angular/animations';\n\nconst easing = 'ease-out';\n\nconst fadeIn: AnimationReferenceMetadata = animation([\n  style({ opacity: '0', backgroundColor: '*' }),\n  sequence([\n    animate('{{ duration }}ms {{ easing }}', style({ opacity: 1, backgroundColor: '{{ backgroundColor }}'})),\n    animate('250ms 500ms ease-in', style({ opacity: 0 }))\n  ])\n], { params: { duration: 2000, backgroundColor: '#ffffff', easing: easing}});\n\n@Component({\n  selector: 'app-engine-fade',\n  templateUrl: './engine-fade.component.html',\n  styleUrls: ['./engine-fade.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None,\n  animations: [\n    trigger('fade', [\n      transition('* => true', useAnimation(fadeIn))\n    ])\n  ]\n})\nexport class EngineFadeComponent implements OnInit, OnDestroy {\n  color = '#FFFFFF';\n  duration = 2000;\n  isVisible = false;\n  ngUnsubscribe = new Subject();\n\n  constructor(\n    private actions: Actions,\n    private changeDetectorRef: ChangeDetectorRef,\n    private store: Store\n  ) { }\n\n  ngOnInit() {\n    this.initFadeListener();\n  }\n\n  ngOnDestroy() {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n  initFadeListener() {\n    this.actions.pipe(\n      ofActionDispatched(Fade),\n      takeUntil(this.ngUnsubscribe)\n    ).subscribe((action: Fade) => {\n      this.fadeIn(action.color, action.duration);\n    });\n  }\n\n  handleFadeComplete() {\n    this.store.dispatch(new FadeComplete());\n    this.isVisible = false;\n    this.changeDetectorRef.markForCheck();\n  }\n\n  fadeIn(color: string, duration: number) {\n    this.isVisible = true;\n    this.color = color;\n    this.duration = duration * 1000;\n    \n    this.changeDetectorRef.markForCheck();\n  }\n}\n","<app-progress\ndata-test=\"engineProgress\"\nclass=\"engine-progress\"\n[value]=\"storyLoadProgress\"\n[total]=\"1\"></app-progress>","import {\n  Component,\n  ChangeDetectionStrategy,\n  OnInit,\n  OnDestroy,\n  ChangeDetectorRef\n} from '@angular/core';\nimport { Store } from '@ngxs/store';\nimport { takeUntil, auditTime, filter } from 'rxjs/operators';\nimport { Subject, combineLatest } from 'rxjs';\nimport { EngineProgressState } from '../../state/progress/engine.progress.state';\nimport { StoryState } from 'src/app/story/state/story.state';\nimport { StoryChaptersState } from 'src/app/story/state/chapters/story.chapters.state';\n\n\n@Component({\n  selector: 'app-engine-progress',\n  templateUrl: './engine-progress.component.html',\n  styleUrls: ['./engine-progress.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class EngineProgressComponent implements OnInit, OnDestroy {\n\n  private ngUnsubscribe = new Subject();\n\n  constructor(\n    private store: Store,\n    private changeDetectorRef: ChangeDetectorRef\n  ) {}\n\n  storyLoadProgress = 0;\n\n  ngOnInit() {\n    const progress$ = this.store.select(EngineProgressState.getChunkLoadProgress);\n    const chunk$ = this.store.select(StoryState.getLoadingChunk);\n\n    combineLatest(progress$, chunk$)\n      .pipe(\n        filter(() => {\n          const loadChunks = this.store.selectSnapshot(StoryState.getLoadChunks);\n          return loadChunks !== null && loadChunks.length > 0;\n        }),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(([progress, chunk]) => {\n        const selectedChapterLoading = \n          chunk !== null && \n          chunk.chapterId === this.store.selectSnapshot(StoryChaptersState.getSelectedChapterId);\n\n        // Only update progress for current chapter\n        this.storyLoadProgress = selectedChapterLoading ? progress : 1;\n        this.changeDetectorRef.markForCheck();\n      });\n  }\n\n  ngOnDestroy() {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n}\n","<div class=\"engine-scroll\" data-test=\"engineScroll\" *ngIf=\"show\" @show (@show.done)=\"onShowDone($event)\">\n  <div class=\"engine-scroll__label\">\n      Use control + scroll to zoom\n  </div>\n</div>\n","import { Component, OnInit, ChangeDetectionStrategy, OnDestroy, ChangeDetectorRef } from '@angular/core';\nimport { Actions, ofActionDispatched } from '@ngxs/store';\nimport { ShowScrollAlert } from '../../state/engine.actions';\nimport { takeUntil } from 'rxjs/operators';\nimport { Subject } from 'rxjs';\nimport { trigger, transition, style, animate, sequence } from '@angular/animations';\n\n@Component({\n  selector: 'app-engine-scroll',\n  templateUrl: './engine-scroll.component.html',\n  styleUrls: ['./engine-scroll.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  animations: [\n    trigger('show', [\n      transition(':enter', [\n        sequence([\n          style({ \n            opacity: '*'\n          }),\n          animate('500ms ease-in-out', style({ \n            opacity: 1,\n          })),\n          animate('500ms 2000ms ease-in-out', style({ \n            opacity: 0\n          }))\n        ])\n      ])\n    ])\n  ]\n})\nexport class EngineScrollComponent implements OnInit, OnDestroy {\n  private ngUnsubscribe = new Subject();\n  show = false;\n  \n  constructor(\n    private actions: Actions,\n    private changeDetectorRef: ChangeDetectorRef\n  ) { }\n\n  ngOnInit() {\n    this.actions.pipe(\n      ofActionDispatched(ShowScrollAlert),\n      takeUntil(this.ngUnsubscribe)\n    ).subscribe(() => {\n      this.show = true;\n      this.changeDetectorRef.markForCheck();\n    });\n  }\n\n  ngOnDestroy() {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n  onShowDone() {\n    this.show = false;\n  }\n}\n","<div  \n  id=\"container\" \n  class=\"engine\"\n  [class.engine--checkered]=\"isBackgroundCheckered\"\n  [ngStyle]=\"getContainerStyles()\"\n  data-test=\"engine\"\n  role=\"main\"\n  #engine>\n  <canvas id=\"theCanvas\" data-test=\"engineCanvas\" class=\"engine__canvas\" #engineCanvas></canvas>\n  <canvas id=\"annotationCanvas\" class=\"engine__annotations\" #engineAnnotations></canvas>  \n  <app-labels></app-labels>\n\n  <app-engine-contextmenu\n    [node]=\"contextmenuNode\"\n    [hit]=\"contextmenuHit\"\n    *ngIf=\"contextmenuNode\">\n  </app-engine-contextmenu>\n\n  <!-- input blocking -->\n  <div *ngIf=\"!inputEnabled\" data-test=\"engineInputBlocker\" class=\"engine__input-blocking\"></div>\n  \n  <app-engine-progress *ngIf=\"showProgressBar$ | async\"></app-engine-progress>\n\n  <app-engine-scroll></app-engine-scroll>\n\n  <app-engine-fade></app-engine-fade>\n\n  <ng-container *appFlagApplication=\"application.Loft;\">\n    <app-engine-camera-position></app-engine-camera-position>\n  </ng-container>\n</div>","import { Component, OnInit, ViewChild, ElementRef, Renderer2, HostListener, ChangeDetectionStrategy, ChangeDetectorRef, OnDestroy, Input } from '@angular/core';\nimport { Store, Select, Actions, ofActionDispatched, ofActionCompleted } from '@ngxs/store';\nimport { \n  SetReady, \n  SetEngineChapterInit,\n  SynchronizeVisibleNodes,\n  SetEngineChapter, \n  ClickNode, \n  FlyToObject,\n  SynchronizeRenderableNodes,\n  ToggleAnimation,\n  ShowScrollAlert,\n  SynchronizePickableNodes,\n  HoverNode,\n  PlayChapterFromStart,\n  PlayChapterAnimation,\n  SetAnimationPlaying,\n  SetContextMenu\n  } from '../../state/engine.actions';\nimport { EngineState } from '../../state/engine.state';\nimport { Observable, Subscription, fromEvent, BehaviorSubject, combineLatest, Subject, interval, merge } from 'rxjs';\nimport { filter, takeUntil, bufferTime, debounceTime, pairwise, map, distinctUntilChanged } from 'rxjs/operators';\nimport { EngineService } from '../../engine.service';\nimport { environment } from 'src/environments/environment';\nimport { EnginePositionModel } from '../../models/engine-position.model';\nimport { CameraService } from '../../camera.service';\nimport { EngineVisibilityEnum } from '../../models/engine-visibility.enum';\nimport { ViewTreeNode } from '../../models/view.tree-node';\nimport { ToolEnum } from 'src/app/engine/models/tool.enum';\nimport { HitModel } from '../../models/hit.model';\nimport { ChapterModel } from 'src/app/story/models/chapter.model';\nimport { ChapterInitModel } from '../../models/engine-chapter-init-model';\nimport { StoryChaptersState } from 'src/app/story/state/chapters/story.chapters.state';\nimport { BdGraph, BdGraphStateMap } from 'src/lib/graph/graph.model';\nimport { PaintService } from '../../paint.service';\nimport {\n  SetCamera,\n  MoveCamera,\n  PanCameraStatic,\n  RotateCameraStatic,\n  ZoomCameraStatic,\n  SetCameraSuccess,\n  SetCameraFlyTo\n} from '../../state/camera/engine.camera.actions';\nimport { CameraMotionModel } from '../../models/camera-motion.model';\nimport { EngineCameraState } from '../../state/camera/engine.camera.state';\nimport { LoadProgressModel } from '../../models/load-progress.model';\nimport { AnimationService } from '../../animation.service';\nimport { BackgroundModel } from '../../models/background.model';\nimport { EngineNodesState } from '../../state/nodes/engine.nodes.state';\nimport { CameraModel } from '../../models/camera.model';\nimport { EventsEnum } from '../../models/events.enum';\nimport { StoryState } from 'src/app/story/state/story.state';\nimport { SetProgress } from '../../state/progress/engine.progress.actions';\nimport { LoadStoryChunkSuccess } from 'src/app/story/state/story.actions';\nimport { BdGraphService } from 'src/lib/graph/graph.service';\nimport { PaintPresetFade, PaintPresetOriginal } from '../../models/paint-presets.const';\nimport { ScrollModeEnum } from '../../models/scroll-mode.enum';\nimport { disableXrayMode } from 'src/app/shared/xray-mode';\nimport { EnvironmentApplication } from 'src/environments/models/environment-application';\nimport { NodeActions } from '../../state/nodes/engine.nodes.actions';\nimport { ObjectId } from '../../state/nodes/engine.nodes.state.model';\nimport { ColorRecipeModel } from 'src/app/edit/models/color-recipe.model';\nimport { ClipDirection, ClippingPlane, ClipBoundaries } from 'src/app/story/models/clipping-plane.model';\n\nimport { get, isEmpty, isNil } from 'lodash';\nimport * as Hammer from 'hammerjs';\nimport { ChapterReadyStateModel } from 'src/app/story/models/chapter-ready-state.model';\nimport { ParticleStateListener } from '../../classes/particle-state-listener';\n\nimport { VisibilityLayersService } from 'src/app/story/visibility-layers.service'; \nimport { StoryLabelsState } from 'src/app/story/state/labels/story.labels.state';\nimport { MediaService } from 'src/app/story/media.service';\n\ndeclare const Human: any;\n\nenum KeyboardCamera {\n  Pan = 0.4, \n  PanSlow = 0.04,\n  Zoom = 5,\n  ZoomSlow = 1,\n  Rotate = 0.3,\n  RotateSlow = 0.03\n}\n\nenum MouseCamera {\n  Rotate = 6,\n  Pan = 1.75,\n  Zoom = 2.5\n}\n\nenum TouchCamera {\n  Zoom = -6,\n  TrackZoom = 0.5,\n  Pan = 1.25,\n  Rotate = 1.5,\n  Friction = 0.85,\n  ZoomFriction = 0.85,\n  FrictionThreshold = 0.002,\n}\n\nenum CursorClasses {\n  Hide = 'engine--cursor-hide',\n  Label = 'engine--cursor-label',\n  Paint = 'engine--cursor-paint',\n  Crosshair = 'engine--cursor-crosshair',\n  Default = ''\n}\n\nenum MouseButtons {\n  None = 0,\n  Left = 1,\n  Right = 2,\n  LeftAndRight = 4\n}\n\nconst timeElapsedAtSixtyFPS = 1000 / 60.0;\n\n// cap the force multiplier between 0 and 15 (15 would indicate 4 fps)\nconst maxForceMultiplier = 15.0;\n\n@Component({\n  selector: 'app-engine',\n  templateUrl: './engine.component.html',\n  styleUrls: ['./engine.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class EngineComponent implements OnInit, OnDestroy {\n  mouseMove$: Observable<MouseEvent>;\n  mouseLeave$: Observable<MouseEvent>;\n\n  nodeSelectedInterceptor: Subscription;\n  flyCamera = true;\n  chapterActivating = false;\n  visible = false;\n  application = EnvironmentApplication;\n  viewGraph: BdGraph<ViewTreeNode>;\n  cursorClass: CursorClasses = CursorClasses.Default;\n\n  private ngUnsubscribe = new Subject();\n\n  @ViewChild('engine', { static: true }) engineElement: ElementRef;\n  @ViewChild('engineCanvas', { static: true }) engineCanvasElement: ElementRef;\n  @ViewChild('engineAnnotations', { static: true }) engineAnnotationsElement: ElementRef;\n  \n  // Engine\n  @Select(EngineState.getReady)\n  ready$: Observable<boolean>;\n\n  @Select(EngineState.getViewGraph)\n  viewGraph$: Observable<BdGraph<ViewTreeNode>>;\n\n  @Select(EngineState.getEnginePosition)\n  enginePosition$: Observable<EnginePositionModel>;\n\n  @Select(EngineState.getHoveredNode)\n  hoveredNode$: Observable<ViewTreeNode>;\n\n  @Select(EngineState.getChapter)\n  chapter$: Observable<string>;\n\n  @Select(EngineState.getChapterInit)\n  chapterInit$: Observable<ChapterInitModel>;\n\n  @Select(EngineNodesState.getCheckedNodes)\n  checkedNodes$: Observable<ViewTreeNode[]>;\n  \n  @Select(EngineState.getActiveTool)\n  activeTool$: Observable<ToolEnum>;\n\n  @Select(EngineState.getAnimationPlaying)\n  animationPlaying$: Observable<boolean>;\n\n  @Select(EngineState.getAutoplay)\n  autoplay$: Observable<boolean>;\n\n  @Select(EngineState.getPlayAudio)\n  playAudio$: Observable<boolean>;\n\n  @Select(EngineState.getDisplay)\n  engineDisplay$: Observable<boolean>;\n  display = false;\n\n  @Select(EngineState.getVisible)\n  engineVisible$: Observable<boolean>;\n  engineVisible = true;\n\n  @Select(EngineState.getShowProgressBar)\n  showProgressBar$: Observable<boolean>;\n\n  @Select(EngineState.getContextmenu)\n  contextmenu$: Observable<any>;\n  contextmenuNode: ViewTreeNode;\n  contextmenuHit: HitModel;\n  \n  // Story - Chapters\n  @Select(StoryChaptersState.getSelectedChapter)\n  selectedChapter$: Observable<ChapterModel>;\n\n  @Select(StoryChaptersState.getSelectedChapterId)\n  selectedChapterId$: Observable<string>;\n\n  @Select(StoryChaptersState.getSelectedChapterReadyState)\n  readyState$: Observable<ChapterReadyStateModel>;\n\n  @Select(StoryChaptersState.getSelectedChapterClippingPlanes)\n  clippingPlanes$: Observable<{\n    clips: Record<ClipDirection, ClippingPlane>,\n    boundary: ClipBoundaries\n  }>;\n\n  // Camera\n  @Select(EngineCameraState.getCameraMotion)\n  cameraMotion$: Observable<CameraMotionModel>;\n\n  // Background color\n  @Select(StoryChaptersState.getSelectedChapterBackground)\n  background$: Observable<BackgroundModel>;\n\n  background: BackgroundModel;\n  particleStateListener: ParticleStateListener;\n\n  get isTransparentBackground(): boolean {\n    if (this.background) {\n      return BackgroundModel.isTransparent(this.background);\n    } else {\n      return false;\n    }\n  }\n\n  get isBackgroundCheckered(): boolean {\n    return environment.application !== EnvironmentApplication.Viewer && this.isTransparentBackground;\n  }\n\n\n  ctrlPressed = false;\n  scrollType: 'wheel' | 'trackpad' = null;\n  scrollTimeout = null;\n  pinchTicks = 0;\n  deltaTime = window.performance.now();\n  pinchMode = '';\n\n  @Input()\n  inputEnabled = true;\n\n\n  @HostListener('wheel', ['$event'])\n  wheel(event: WheelEvent) {\n    \n    const scrollMode = this.store.selectSnapshot(EngineState.getScrollMode);\n    const ctrlActive = this.ctrlPressed;\n\n    if (scrollMode === ScrollModeEnum.DoNotCaptureShowMessage && !ctrlActive) {\n      this.store.dispatch(new ShowScrollAlert(true));\n    }\n\n    if (scrollMode !== ScrollModeEnum.Capture && !ctrlActive) {\n      return;\n    }\n\n    // if we're allowed to scroll, we never want the parent window to scroll\n    event.preventDefault();\n    this.handleWheel(event);\n  }\n\n  @HostListener('contextmenu', ['$event'])\n  contextmenu(event: MouseEvent) {\n    this.handleContextMenu(event);\n  }\n\n  @HostListener('mouseout', ['$event'])\n  mouseout() {\n    this.handleMouseOut();\n  }\n\n  constructor(\n    private actions: Actions,\n    private cameraService: CameraService,\n    private changeDetecton: ChangeDetectorRef,\n    private engineService: EngineService,\n    private paintService: PaintService,\n    private visibilityLayersService: VisibilityLayersService,\n    private mediaService: MediaService,\n    private renderer: Renderer2,\n    private store: Store  ) {\n    // Include pako when using Loft to track download size\n    if (environment.application === EnvironmentApplication.Loft) {\n      import('pako').then(pako => {\n        window['pako'] = pako;\n      });\n    }\n  }\n\n  // map single property state map to graph state map\n  private convertToLeafStateMap(property: string, propertyMap: {[key: string]: boolean} ): BdGraphStateMap {\n    const leafStateMap: BdGraphStateMap = {};\n    Object.entries(propertyMap).forEach(([id, state]) => {\n      leafStateMap[id] = {};\n      leafStateMap[id][property] = state;\n    \n    });\n    return leafStateMap;\n  }\n\n  ngOnInit() {\n\n    // init particle systems listener\n    this.particleStateListener = new ParticleStateListener(this.store);\n\n    this.bindEngineEvents();\n    \n    this.bindApplicationEvents();\n    this.bindChapterChangeEvents();\n    this.bindCameraEvents();\n    this.bindToolEvents();\n\n    this.bindMouseEvents();\n    this.bindKeyEvents();\n    this.bindHumanInteractions();\n  \n    this.renderer.listen(window, 'keydown', (e) => {\n      if (e.key === 'Control') {\n        this.ctrlPressed = true;\n      }\n    });\n\n    this.renderer.listen(window, 'keyup', (e) => {\n      if (e.key === 'Control') {\n        this.ctrlPressed = false;\n      }\n    });\n    this.initChangeListener();\n    this.initChapterAudio();\n\n    Human.properties.set({assetDomain: environment.assetDomain});\n    Human.workers.setPath('/engine/studio/workers');\n    Human.init.init();\n  }\n\n  ngOnDestroy() {\n    this.changeDetecton.detach();\n    this.particleStateListener.destroy();\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n  initEventListeners() {\n    \n  }\n\n  bindEngineEvents() {\n    // Engine Errors\n    // Rollbar needs erors to be thrown through window.onerror to trigger, console.error is insufficient\n    // Since engine only logs errors to console, this function escalates\n    // this.engineService.getEvent(EventsEnum.LogError)\n    //   .pipe(takeUntil(this.ngUnsubscribe))\n    //   .subscribe((error) => {\n    //     throw new Error(error); // Handled by rollbar\n    //   });\n      \n    // Graph has initialized\n    this.engineService.getEvent(EventsEnum.Loaded)\n      .pipe(takeUntil(this.ngUnsubscribe))\n      .subscribe(() => {\n        this.store.dispatch(new SetReady(true));\n      });\n      \n    // Chapters have started activating\n    this.engineService.getEvent(EventsEnum.TimelineChaptersActivateStart)\n      .pipe(takeUntil(this.ngUnsubscribe))\n      .subscribe(() => {\n        this.chapterActivating = true;\n      });\n\n    // Chapters have finished\n    this.engineService.getEvent(EventsEnum.TimelineChaptersActivateFinish)\n      .pipe(takeUntil(this.ngUnsubscribe))\n      .subscribe((params) => {\n        this.chapterActivating = false;\n\n        const currentBranch = Human.timeline.activeRoot._nowBranch;\n        const chapterInit = {\n          id: currentBranch.id,\n          init: true,\n          camera: currentBranch.initializedCamera,      \n          annotations: currentBranch.initializedAnnotations,\n          graph: currentBranch.initializedGraph,\n          properties: currentBranch.initializedProperties,\n          particles: currentBranch.initializedParticles,\n          clips: currentBranch.initializedClippingPlanes,\n          postprocessing: currentBranch.initializedPostprocess,\n          transparency: currentBranch.initializedTransparencyMode\n        };\n        this.store.dispatch(new SetEngineChapter(params.chapterId));\n        this.store.dispatch(new SetEngineChapterInit(chapterInit));\n      });\n\n    // Handle Chapter Transition - trigger API events\n    this.engineService\n    .getEvent(EventsEnum.TimelineChaptersActivated)\n    .pipe(\n      takeUntil(this.ngUnsubscribe)\n      )\n    .subscribe((event) => {\n      this.engineService.fireEvent(EventsEnum.LabelsChapterInfo, this.store.selectSnapshot(StoryLabelsState.getChapterLabels));\n    });\n\n    // Listen to timeline play / pause updates, and ensure the app stays in sync\n    merge(\n      this.engineService.getEvent(EventsEnum.TimelinePlayed),\n      this.engineService.getEvent(EventsEnum.TimelinePaused)\n    )\n    .pipe(\n      takeUntil(this.ngUnsubscribe),\n      filter(() => this.store.selectSnapshot(StoryChaptersState.getSelectedChapterId) != null),\n      debounceTime(50),\n      map(() => Human.timeline.playing)\n    )\n    .subscribe(playing => {\n      this.store.dispatch(new SetAnimationPlaying(playing));\n    });\n\n    // Handle engine tick, but only when it's visible\n    this.engineService.getEvent(EventsEnum.Tick)\n      .pipe(takeUntil(this.ngUnsubscribe))\n      .subscribe(() => {\n        if (this.visible) {\n          if (this.inputEnabled) {\n            this.handleMouseInputEngineTick();\n          }\n          this.handleCameraTick();\n          this.deltaTime = window.performance.now();\n        }\n      });\n      \n      this.engineService\n        .getEvent(EventsEnum.TweenVisibilityUpdate)\n        .pipe(\n          distinctUntilChanged((a, b) => JSON.stringify(a) === JSON.stringify(b)),\n          takeUntil(this.ngUnsubscribe)\n        )\n        .subscribe(update => {\n\n          const objectsToShow = Object.keys(update).filter(objectId => update[objectId] === true);\n          const objectsToHide = Object.keys(update).filter(objectId => update[objectId] === false);\n\n          if (objectsToShow.length > 0) {\n            this.store.dispatch(\n              new NodeActions.UpdateNodesShown(\n                true,\n                objectsToShow,\n                undefined,\n                false, // do not record\n                true // mark as 'setByTween'\n              )\n            );\n          }\n\n          if (objectsToHide.length > 0) {\n            this.store.dispatch(\n              new NodeActions.UpdateNodesShown(\n                false,\n                objectsToHide,\n                undefined,\n                false, // do not record\n                true // mark as 'setByTween'\n              )\n            );\n          }\n        \n        });\n    \n    // Handle object renderable event\n    this.engineService.getEvent(EventsEnum.SceneObjectRenderable)\n      .pipe(\n        bufferTime(1000),\n        takeUntil(this.ngUnsubscribe))\n      .subscribe((renderable: Array<any> ) => {\n        if (renderable.length) {\n          const leafStateMap = {};\n          renderable.forEach(renderableData => {\n            leafStateMap[renderableData.objectId] = {'renderable': true};\n          });\n          this.store.dispatch(new SynchronizeRenderableNodes(leafStateMap));\n        }\n      });\n\n\n    // Handle Loading\n    this.engineService\n      .getEvent(EventsEnum.AssetsLoadProgress)\n      .pipe(\n        takeUntil(this.ngUnsubscribe)\n        )\n      .subscribe((progress: LoadProgressModel) => {\n\n        const totalChunks = Math.max(1, this.store.selectSnapshot(StoryState.getLoadChunks).length);\n        const remainingChunks = this.store.selectSnapshot(StoryState.getLoadChunksRemaining).length;\n        const currentChunkIdx = totalChunks - remainingChunks;\n\n        const { receivedAssets, requestedAssets } = progress;\n        const currentChunkProgress = receivedAssets / requestedAssets;\n\n        const chunkWidth = 1 / totalChunks;\n        const baseProgress = currentChunkIdx * chunkWidth;\n        const currentProgress = currentChunkProgress * chunkWidth;\n\n        const storyLoadProgress = currentProgress + baseProgress;\n\n        this.store.dispatch(new SetProgress(storyLoadProgress, currentChunkProgress));\n      });\n\n  // There are story load chunks that don't actually initiate any downloading.\n  // Therefore, we can only know when loading has completed by pipeing LoadStoryChunkSuccess, and there are zero chunks remaining\n  this.actions\n    .pipe(\n      ofActionCompleted(LoadStoryChunkSuccess),\n      takeUntil(this.ngUnsubscribe)\n    )\n    .subscribe(() => {\n      const chunksRemaining = this.store.selectSnapshot(\n        StoryState.getLoadChunksRemaining\n      ).length;\n  \n      if (chunksRemaining === 0) {\n        this.store.dispatch(new SetProgress(1, 1));\n      }\n    });\n\n  }\n\n  bindApplicationEvents() {\n    // Available screen space for the engine has changed\n    this.enginePosition$\n      .pipe(\n        filter(position => position != null),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe((position) => {\n        this.repositionEngine(position);\n      });\n\n    // deal with turning xray mode on and off\n    this.store.select(EngineState.getXrayModeEnabled)\n      .pipe(takeUntil(this.ngUnsubscribe))\n      .subscribe(xrayModeEnabled => {\n\n      // get checked and unchecked nodes.\n      const checkedNodes = this.store.selectSnapshot(EngineNodesState.getCheckedNodes);\n      const nodes = this.store.selectSnapshot(EngineNodesState.getNodes);\n\n      // when toggling xray mode,\n      // we have to refresh the way objects are presented, based on the currently selected nodes.\n      if (xrayModeEnabled === false) {\n\n        // re-paint leaf nodes\n        Object.keys(nodes || []).forEach(objectId => {\n          const recipe = nodes[objectId].paint;\n          this.paintService.paint(objectId, recipe);\n        });\n          \n        // re-highlight checked nodes\n        checkedNodes.forEach(node => this.paintService.highlight(node.objectId, true));\n\n      } else { // xray mode is enabled\n        this.paintService.paintAll(Object.keys(nodes), PaintPresetFade.recipe);\n        this.paintService.paintAll(checkedNodes.map(node => node.objectId), PaintPresetOriginal.recipe);\n      }\n    });\n\n    // Handle background changes\n    this.background$\n      .pipe(\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe((background) => {\n        this.background = background;\n      });\n    \n    // Play chapter from start\n    // If audio is playing, restart it.\n    // If chapter is animated, reset the timeline.\n    this.actions.pipe(\n      ofActionDispatched(PlayChapterFromStart),\n      takeUntil(this.ngUnsubscribe)\n    ).subscribe(() => {\n      this.playChapterFromStart();\n    });\n    \n    // display\n    this.engineDisplay$\n      .pipe(\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe((display) => {\n        this.display = display;\n        this.changeDetecton.markForCheck();\n      });\n\n    // visibility\n    this.engineVisible$\n      .pipe(\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe((visible) => {\n        this.engineVisible = visible;\n        this.changeDetecton.markForCheck();\n      });\n\n    this.visibilityLayersService.initObservables();\n\n    // Contextmenu\n    this.contextmenu$\n      .pipe(\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe((contextmenu) => {\n        this.contextmenuNode = contextmenu.node;\n        this.contextmenuHit = contextmenu.hit;\n        this.changeDetecton.markForCheck();\n      });\n  }\n\n  bindChapterChangeEvents() {\n    // New chapter\n    this.selectedChapter$\n      .pipe(\n        filter((chapter) => {\n          return chapter != null;\n        }),\n        pairwise(),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(([lastChapter, currentChapter]) => {\n        if (lastChapter.id === currentChapter.id) {\n          return;\n        } \n\n        this.store.dispatch(new NodeActions.SetActiveChapter(currentChapter.id));\n        disableXrayMode(this.store, this.engineService);\n\n        // set background\n        this.background = this.store.selectSnapshot(StoryChaptersState.getSelectedChapterBackground);\n\n        Human.timeline.scrub({ chapterId: currentChapter.id });\n\n        // after Undo, prevent the camera from flying to a previous chapter's camera.\n        this.store.dispatch(new SetCameraFlyTo(undefined));\n      });\n\n\n    this.clippingPlanes$\n      .pipe(\n        filter(clippingPlanes => clippingPlanes !== undefined),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(clips => {\n        const clipsParams = Object.values(clips.clips);\n        const clipsEnabled = clipsParams.filter(clip => clip.enabled);\n        Human.renderer.clip.reset();\n\n        clipsEnabled.forEach(clip =>\n          Human.renderer.clip.setClip({\n            boundary: clips.boundary,\n            ...clip\n          })\n        );\n      });\n\n    this.background$\n      .pipe(\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe((background) => {\n        this.background = background;\n      });\n    \n    \n    // Selected tool changed\n    this.activeTool$\n      .pipe(\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe((tool) => {\n        // Reset hover class\n        Object.values(CursorClasses).forEach(cursorClass => {\n          if (cursorClass) {\n            this.renderer.removeClass(this.engineElement.nativeElement, cursorClass);\n          }\n        });\n\n        switch (tool) {\n          case ToolEnum.Hide:\n            this.renderer.addClass(this.engineElement.nativeElement, CursorClasses.Hide);\n            break;\n          case ToolEnum.Label:\n            this.renderer.addClass(this.engineElement.nativeElement, CursorClasses.Label);\n            break;\n          case ToolEnum.Paint:\n            this.renderer.addClass(this.engineElement.nativeElement, CursorClasses.Paint);\n            break;\n          case ToolEnum.Isolate:\n          case ToolEnum.Fade:\n            this.renderer.addClass(this.engineElement.nativeElement, CursorClasses.Crosshair);\n            break;\n          default:\n            // Do nothing for now\n            break;\n        }\n      });\n\n    // Init chapter animation once it's loaded\n    // ---\n    // Should only fire when\n    // - The readyState of a chapter changes\n    // - Autoplay is set to true\n    combineLatest(this.selectedChapterId$, this.readyState$, this.autoplay$)\n      .pipe(\n        filter(([chapterId, readyState, autoplay]) => \n          !isNil(chapterId) && \n          !isNil(readyState) && \n          !isNil(autoplay)\n        ),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(([, readyState, engineAutoplay]) => {\n        const animationReady = get(readyState, 'animation', false);\n        \n        // When no autoplay is defined one way or another, assume the intent was for the chapter to animate\n        const chapter = this.store.selectSnapshot(StoryChaptersState.getSelectedChapter);\n        const chapterAutoplay = get(chapter, 'ui.play.autoplay', true);\n\n        // Consolidate all play triggers\n        const shouldPlay = animationReady && engineAutoplay && chapterAutoplay;\n        this.store.dispatch(new PlayChapterAnimation(chapter, !shouldPlay));\n        this.store.dispatch(new ToggleAnimation(shouldPlay));\n      });\n  }\n\n  bindCameraEvents() {\n    this.actions.pipe(\n      ofActionDispatched(SetCamera),\n      takeUntil(this.ngUnsubscribe)\n    ).subscribe(\n      (action: SetCamera) => {\n        action.animate\n        ? this.flyToPoint(action.camera, action.animationDuration)\n        : this.jumpToPoint(action.camera);\n\n      }\n    );\n\n    this.actions.pipe(\n      ofActionDispatched(PanCameraStatic),\n      takeUntil(this.ngUnsubscribe)\n    ).subscribe((action: PanCameraStatic) => {\n      this.cameraService.panCameraStatic(action.x, action.y, action.z);\n    });\n\n    this.actions.pipe(\n      ofActionDispatched(RotateCameraStatic),\n      takeUntil(this.ngUnsubscribe)\n    ).subscribe((action: RotateCameraStatic) => {\n      this.cameraService.rotateCameraStatic(action.x, action.y);\n    });\n\n    this.actions.pipe(\n      ofActionDispatched(ZoomCameraStatic),\n      takeUntil(this.ngUnsubscribe)\n    ).subscribe((action: ZoomCameraStatic) => {\n      this.cameraService.setHumanZoomFactor(action.value);\n    });\n\n    this.actions.pipe(\n      ofActionDispatched(FlyToObject),\n      filter((action: FlyToObject) => !!action.objectId),\n      takeUntil(this.ngUnsubscribe)\n    ).subscribe((action: FlyToObject) => {\n      action.animate\n      ? this.flyToObject(action.objectId, action.animationDuration)\n      : this.jumpToObject(action.objectId);\n    });\n  }\n  \n  bindToolEvents() {\n    // Selected tool changed\n    this.activeTool$\n    .pipe(\n      takeUntil(this.ngUnsubscribe)\n    )\n    .subscribe((tool) => {\n      // Reset hover class\n      Object.values(CursorClasses).forEach(cursorClass => {\n        if (cursorClass) {\n          this.renderer.removeClass(this.engineElement.nativeElement, cursorClass);\n        }\n      });\n\n      switch (tool) {\n        case ToolEnum.Hide:\n          this.renderer.addClass(this.engineElement.nativeElement, CursorClasses.Hide);\n          break;\n        case ToolEnum.Label:\n          this.renderer.addClass(this.engineElement.nativeElement, CursorClasses.Label);\n          break;\n        case ToolEnum.Paint:\n          this.renderer.addClass(this.engineElement.nativeElement, CursorClasses.Paint);\n          break;\n        case ToolEnum.Isolate:\n        case ToolEnum.Fade:\n          this.renderer.addClass(this.engineElement.nativeElement, CursorClasses.Crosshair);\n          break;\n        default:\n          // Do nothing for now\n          break;\n      }\n    });\n  }\n\n  bindMouseEvents() {\n    // User moves mouse, debounce to small delay so lookup only occurs on pause.\n    // Done for performance, doing a node lookup in 3D is expensive.\n    this.mouseMove$ = fromEvent<MouseEvent>(this.engineElement.nativeElement, 'mousemove');\n\n    // Handle all mouse move events, primarily for panning the camera\n    this.mouseMove$.pipe(\n      takeUntil(this.ngUnsubscribe)\n    ).subscribe((event) => {\n      this.handleMousePan(event);\n    });\n      \n      \n    // User moves mouse, debounce to small delay so  hover lookup only occurs on pause.\n    // Done for performance, doing a node lookup in 3D is expensive.\n    this.mouseMove$.pipe(\n      debounceTime(10),\n      takeUntil(this.ngUnsubscribe)\n    ).subscribe((event) => { \n      this.handleMouseHover(event);\n    });\n\n    // User leaves scene, clear hovered node\n    this.mouseLeave$ = fromEvent<MouseEvent>(this.engineElement.nativeElement, 'mouseleave');\n    this.mouseLeave$.pipe(\n      debounceTime(10),\n      takeUntil(this.ngUnsubscribe)\n    ).subscribe(event => {\n      this.handleMouseLeave();\n    });\n\n  }\n\n  bindKeyEvents() {\n    const downKeys = ['w', 'a', 's', 'd', 'e', 'c', '=', '-', '+', '_', 'arrowleft', 'arrowright', 'arrowup', 'arrowdown', 'shiftKey']\n      .reduce((result, value) => {\n        result[value] = false;\n        return result;\n      }, {});\n\n    const downKeys$ = new BehaviorSubject<any>(downKeys);\n\n    let lastvalue: any;\n\n    this.renderer.listen(window, 'keydown', (event) => {\n      if (event.repeat || event.metaKey || event.ctrlKey) {\n        return;\n      }\n      \n      // Prevent keyboard events while inputs are focused\n      const eventNode = event.target.nodeName.toLowerCase();\n      if (['input', 'textarea', 'select', 'option'].indexOf(eventNode) >= 0) {\n        return;\n      }\n\n      downKeys$.next({\n        ...downKeys$.value,\n        [event.key.toLowerCase()]: true,\n        shiftKey: event.shiftKey,\n        hasMomentum: false,\n      });\n    });\n\n    // only process the keyup event if there was only one key pressed previously\n    this.renderer.listen(window, 'keyup', (event: KeyboardEvent) => {\n      if (event.key) {\n        const numPressed = Object.values(lastvalue).filter((a) => a === true)\n          .length;\n        if (numPressed === 1) {\n          this.applyMotion(lastvalue, true);\n          downKeys$.next({\n            ...downKeys$.value,\n            [event.key.toLowerCase()]: false,\n            shiftKey: event.shiftKey,\n            hasMomentum: lastvalue.shiftKey === false,\n          });\n        } else {\n          downKeys$.next({\n            ...downKeys$.value,\n            [event.key.toLowerCase()]: false,\n            shiftKey: event.shiftKey,\n            hasMomentum: false,\n          });\n        }\n      }\n    });\n\n    downKeys$\n      .pipe(\n        // validate input enabled state\n        filter(() => this.inputEnabled),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe((value) => {\n        lastvalue = value;\n        if (value.hasMomentum === false) {\n          this.applyMotion(value, false);\n        }\n      });\n\n      this.renderer.listen(window, 'keydown', (e) => {\n      if (e.key === 'Control') {\n        this.ctrlPressed = true;\n      }\n    });\n\n    this.renderer.listen(window, 'keyup', (e) => {\n      if (e.key === 'Control') {\n        this.ctrlPressed = false;\n      }\n    });\n    \n  }\n\n  // apply keyboard input to the camera motion model\n  // momentum will be true on a keyup event \n  applyMotion(value, momentum) {\n    const motion = new CameraMotionModel();\n    const zoom = value.shiftKey ? KeyboardCamera.ZoomSlow : KeyboardCamera.Zoom;\n    const pan = value.shiftKey ? KeyboardCamera.PanSlow : KeyboardCamera.Pan;\n    const rotate = value.shiftKey\n      ? KeyboardCamera.RotateSlow\n      : KeyboardCamera.Rotate;\n\n    motion.zoom += value.c || value['-'] || value['_'] ? zoom : 0;\n    motion.zoom -= value.e || value['='] || value['+'] ? zoom : 0;\n\n    motion.panX -= value.d ? pan : 0;\n    motion.panX += value.a ? pan : 0;\n\n    motion.panY += value.w ? pan : 0;\n    motion.panY -= value.s ? pan : 0;\n\n    motion.rotateX -= value.arrowright ? rotate : 0;\n    motion.rotateX += value.arrowleft ? rotate : 0;\n\n    motion.rotateY += value.arrowup ? rotate : 0;\n    motion.rotateY -= value.arrowdown ? rotate : 0;\n\n    motion.applyFriction = momentum;\n\n    this.store.dispatch(new MoveCamera(motion));\n  }\n\n  initChangeListener() {\n    // listen for state changes\n    // listen for state changes\n    this.store\n    .select(EngineNodesState.getPatches)\n    .pipe(\n      filter((patches) => patches.length > 0),\n      takeUntil(this.ngUnsubscribe)\n    )\n    .subscribe((patches) => {\n      const patchesForProp = patches.reduce(\n        (acc, patch) => {\n          const patchProp = patch.path[patch.path.length - 1];\n          if (acc[patchProp] !== undefined) {\n            acc[patchProp].push(patch);\n          }\n          return acc;\n        },\n        {\n          shown: [],\n          checked: [],\n          paint: [],\n          pickable: [],\n        }\n      );\n\n      const getDiff = (prop: 'shown' | 'checked' | 'paint' | 'pickable') =>\n        patchesForProp[prop].reduce((acc, patch) => {\n          const objectId = patch.path[2];\n          acc[objectId] = patch.value;\n          return acc;\n        }, {});\n\n      const diffChecked: Record<ObjectId, boolean> = getDiff('checked');\n      const diffShown: Record<ObjectId, boolean> = getDiff('shown');\n      const diffPaint: Record<ObjectId, ColorRecipeModel> = getDiff('paint');\n      const diffPickable: Record<ObjectId, boolean> = getDiff('pickable');\n\n      // Set object visibility, and update the view graph\n      if (!isEmpty(diffShown)) {\n        const currentNodes = this.store.selectSnapshot(EngineNodesState.getNodes);\n        const shownState = Object.values(currentNodes).reduce(\n          (acc, nodeState) => {\n            acc[nodeState.objectId] = nodeState.shown;\n            return acc;\n          },\n          {}\n        );\n        this.engineService.setNodesVisible(shownState);\n        const stateMap = this.convertToLeafStateMap('shown', shownState);\n        this.store.dispatch(new SynchronizeVisibleNodes(stateMap, currentNodes));\n      }\n\n      // Set object highlight\n      if (!isEmpty(diffChecked)) {\n        this.engineService.fireEvent(EventsEnum.SceneObjectsSelected, {\n          selectedObjectsUpdate: diffChecked,\n        });\n\n        const highlightMethod = this.store.selectSnapshot(\n          EngineState.getXrayModeEnabled\n        )\n          ? (objectId, value) =>\n              this.paintService.paint(\n                objectId,\n                value === true\n                  ? PaintPresetOriginal.recipe\n                  : PaintPresetFade.recipe\n              )\n          : (objectId, value) => this.paintService.highlight(objectId, value);\n\n        Object.entries(diffChecked).forEach(([objectId, value]) => {\n          highlightMethod(objectId, value);\n        });\n      }\n\n      // Set object color recipes\n      if (!isEmpty(diffPaint)) {\n        for (const [objectId, recipe] of Object.entries(diffPaint)) {\n          this.paintService.colorObject(objectId, ColorRecipeModel.toEngine(recipe));\n        }\n      }\n\n      // Set object pickability, and update the view graph.\n      if (!isEmpty(diffPickable)) {\n        const currentNodes = this.store.selectSnapshot(EngineNodesState.getNodes);\n        const pickableState = Object.values(currentNodes).reduce(\n          (acc, nodeState) => {\n            acc[nodeState.objectId] = nodeState.pickable;\n            return acc;\n          },\n          {}\n        );\n        this.engineService.setNodesPickable(pickableState);\n        this.store.dispatch(\n          new SynchronizePickableNodes(\n            this.convertToLeafStateMap('pickable', pickableState),\n            currentNodes\n          )\n        );\n      }\n    });\n  }\n\n  initChapterAudio() {\n    combineLatest(\n      this.selectedChapterId$,\n      this.playAudio$\n    )\n      .pipe(\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(([chapterId, playAudio]) => {\n        this.playAudio(playAudio);\n      });\n  }\n\n  repositionEngine(position: EnginePositionModel) {\n    this.renderer.setStyle(this.engineElement.nativeElement, 'left', `${position.left}px`);\n    this.renderer.setStyle(this.engineElement.nativeElement, 'top', `${position.top}px`);\n    this.renderer.setStyle(this.engineElement.nativeElement, 'width', `${position.width}px`);\n    this.renderer.setStyle(this.engineElement.nativeElement, 'height', `${position.height}px`);\n    this.renderer.setStyle(this.engineElement.nativeElement, 'zIndex', `${position.visibility}`);\n    this.renderer.setStyle(\n      this.engineElement.nativeElement, 'visibility', (position.visibility === EngineVisibilityEnum.Shown) ? 'visible' : 'hidden'\n    );\n\n    // Engine user interaction will be disabled when the engine isn't visible\n    this.visible = position.visibility === EngineVisibilityEnum.Shown;\n    Human.renderer.resize();\n  }\n\n  /**\n   * User Interactions\n   * Depends on the HammerJS library to ensure touch compatibility, and manage pan handlers (heh...)\n   */\n  bindHumanInteractions() {\n    // Create a HammerJS manager so we can custom define single and double click\n    const mc = new Hammer.Manager(this.engineCanvasElement.nativeElement);\n\n    // Tap recognizer with minimal 2 taps\n    mc.add(new Hammer.Tap({ event: 'doubletap', taps: 2, posThreshold: 50 }));\n\n    // Single tap recognizer\n    mc.add(new Hammer.Tap({ event: 'singletap' }));\n\n    // Pan recognizer\n    mc.add(new Hammer.Pan({ event: 'pan', pointers: 0 }));\n\n    // Pinch\n    mc.add(new Hammer.Pinch({ event: 'pinch' }));\n\n    // Press\n    mc.add(new Hammer.Press({ time: 500 }));\n\n    \n    mc.on('singletap', (event) => {\n      this.handleTap(event);\n    });\n\n    mc.on('doubletap', (event)  => {\n      this.handleDoubleTap(event);\n    });\n\n    mc.on('press', (event) => {\n      event.preventDefault();\n      event.srcEvent.stopImmediatePropagation();\n      this.handlePress(event);\n    });\n\n    mc.on('pan', (event) => {\n      event.preventDefault();\n      this.handlePan(event);\n    });\n    \n    mc.on('panstart', (event) => {\n      this.handlePanStart(event);\n    });\n\n    mc.on('panend', (event) => {\n      this.handlePanEnd(event);\n    });\n\n    mc.on('pinchend', (event) => {\n      this.handlePinchEnd(event);\n    });\n\n    let cacheScale = 0;\n    let scaleDir = 0;\n    let cacheX = 0;\n    let cacheY = 0;\n\n    mc.on('pinchstart', (event) => {\n      cacheScale = event.scale;\n      cacheX = event.deltaX;\n      cacheY = event.deltaY;\n      this.pinchMode = '';\n    });\n\n    mc.on('pinchmove', (event) => {\n      if (this.pinchTicks > 0) {\n        return;\n      }\n      const panDistanceMet =\n        Math.abs(event.deltaX) > 60 || Math.abs(event.deltaY) > 60;\n      const pinchScaleMet = event.scale > 1.25 || event.scale < 0.75;\n\n      // Determine is user is panning or pinching, used for momentum after the gesture\n      if (!this.pinchMode) {\n        this.pinchMode = pinchScaleMet ? 'pinch' : 'pan';\n      } else {\n        if (this.pinchMode === 'pan' && pinchScaleMet && !panDistanceMet) {\n          this.pinchMode = 'pinch';\n        }\n\n        if (this.pinchMode === 'pinch' && panDistanceMet && !pinchScaleMet) {\n          this.pinchMode = 'pan';\n        }\n      }\n\n      const scale = event.scale - cacheScale;\n      cacheScale = event.scale;\n\n      // ignore scale if it is bouncing back and forth between positive and negative\n      const lastDir = scaleDir;\n      if (scale === 0) {\n        scaleDir = 0;\n      } else {\n        scaleDir = scale > 0 ? 1 : -1;\n      }\n      this.cameraService.setCameraPan(\n        event.velocityX * TouchCamera.Pan,\n        event.velocityY * TouchCamera.Pan\n      );\n      if (scaleDir + lastDir !== 0) {\n        this.cameraService.setHumanZoom(scale * TouchCamera.Zoom);\n      }\n    });\n  }\n\n  handleMouseHover(event: MouseEvent) {\n    if (event.buttons !== MouseButtons.None) {\n      return;\n    }\n\n    const { offsetX, offsetY} = event;\n    const hit = Human.renderer.pick.pick(offsetX, offsetY);\n\n    if (hit.objectId) {\n      const viewGraph = this.store.selectSnapshot(EngineState.getViewGraph);\n      const hitNode = this.engineService.getNode(viewGraph, hit.objectId);\n      const hoveredNode = this.store.selectSnapshot(EngineState.getHoveredNode);\n\n      if (!hoveredNode || hoveredNode.id !== hitNode.id) {\n        this.store.dispatch(new HoverNode(hitNode, hit));\n      }\n    } else {\n      if (this.store.selectSnapshot(EngineState.getHoveredNode) != null) {\n        this.store.dispatch(new HoverNode(null));\n      }\n    }\n  }\n\n  handleMouseLeave() {\n    this.store.dispatch(new HoverNode(null));\n  }\n\n  handleMousePan(event: MouseEvent) {\n    // Left mouse button is handled by HammerJS 'pan'\n    if (event.buttons === 2 || event.buttons === 4) {\n      let { movementX, movementY } = event;\n      movementX /= 16;\n      movementY /= 16;\n      this.cameraService.setCameraPan(movementX, movementY);\n    }\n  }\n\n  handleMouseOut() {\n    this.store.dispatch(new HoverNode(null));\n  }\n\n  // When it comes to wheel events, we account for both trackpad and scroll wheel. The deltaY\n  // from these events can vary wildly between trackpad, mouse type, and browser. Read the docs\n  // below to learn more.\n  // https://developer.mozilla.org/en-US/docs/Web/API/WheelEvent\n  handleWheel(event: WheelEvent) {\n    let deltaY = 0;\n\n    // Check deltaMode, which determines if we're pixel / line / page scrolling\n    switch (event.deltaMode) {\n      case 0: // Pixel delta (most common, trackpad and mice scroll wheels in Chrome & Safari)\n        \n        // Best attempt at determining trackpad vs wheel. \n        // On initial scroll, a trackpad never starts off higher than 10 pixels movement.\n        if (this.scrollType === null) {\n          this.scrollType = (Math.abs(event.deltaY) < 10) ? 'trackpad' : 'wheel';\n        }\n\n        // If trackpad, use deltaY\n        // Otherwise use fixed scroll speed\n        deltaY = (this.scrollType === 'trackpad') ?\n          event.deltaY * TouchCamera.TrackZoom :\n          Math.sign(event.deltaY) * MouseCamera.Zoom;\n        break;\n      \n      default: // Line delta (less common, mice scroll wheels in Firefox)\n        this.scrollType = 'wheel';\n        deltaY = event.deltaY * MouseCamera.Zoom;\n        break;\n    }\n\n    \n    // Reset checking tracker. After 500ms of inactivity, reset scroll tracker.\n    // Do this so that users transitioning between mouse and trackpad don't have issues.\n    clearTimeout(this.scrollTimeout);\n    this.scrollTimeout = setTimeout(() => {\n      this.scrollType = null;\n    }, 500);\n\n    // Don't allow zoom to exceed max\n    if (Math.abs(deltaY) > 40) {\n      deltaY = Math.sign(deltaY) * 40;\n    }\n    \n\n    // For trackpad, use pixel precision.\n    if (this.scrollType === 'trackpad') {\n      this.cameraService.setCameraZoom(deltaY);\n    \n    // For wheel, use fixed velocity\n    } else {\n      this.zoomWithVelocity(deltaY);\n    }\n  }\n\n  zoomWithVelocity(deltaY) {\n    this.cameraService.setCameraZoom(deltaY);\n\n    requestAnimationFrame(() => {\n      deltaY *= 0.85;\n      if (Math.abs(deltaY) > 1) {\n        this.zoomWithVelocity(deltaY);\n      }\n    });\n  }\n\n  handleContextMenu(event: MouseEvent) {\n    event.preventDefault();\n    const { offsetX, offsetY} = event;\n    const hit = this.getHit(offsetX, offsetY);\n    const node = this.getNodeFromHit(hit);\n\n    this.store.dispatch(new SetContextMenu(node, hit));\n  }\n\n  handlePanStart(event: HammerInput) {}\n\n  handlePanEnd(event: HammerInput) {\n    const motion = this.store.selectSnapshot(EngineCameraState.getCameraMotion);\n    if (\n      this.pinchTicks > 0 ||\n      (motion.panX === event.velocityX && motion.panY === event.velocityY)\n    ) {\n      // this was a pinch, however the panend event also fires\n      return;\n    }\n    const panMode = this.store.selectSnapshot(EngineCameraState.getPanMode);\n    if (event.srcEvent.shiftKey || panMode === 'pan') {\n      motion.panX = event.velocityX * TouchCamera.Pan;\n      motion.panY = event.velocityY * TouchCamera.Pan;\n    } else {\n      motion.rotateX = event.velocityX * TouchCamera.Rotate;\n      motion.rotateY = event.velocityY * TouchCamera.Rotate;\n    }\n    motion.applyFriction = true;\n    this.store.dispatch(new MoveCamera(motion));\n  }\n\n  handlePinchEnd(event: HammerInput) {\n    const motion = this.store.selectSnapshot(EngineCameraState.getCameraMotion);\n    if (this.pinchMode === 'pan') {\n      motion.panX = event.velocityX * TouchCamera.Pan;\n      motion.panY = event.velocityY * TouchCamera.Pan;\n    } else {\n      const sign = event.velocity > 0 ? 1 : -1;\n      motion.zoom =\n        Math.sqrt(\n          event.velocityX * event.velocityX + event.velocityY * event.velocityY\n        ) *\n        -sign *\n        TouchCamera.Zoom;\n    }\n    motion.applyFriction = true;\n    this.store.dispatch(new MoveCamera(motion));\n    this.pinchTicks = 10;\n  }\n\n  handleTap(event: HammerInput) {\n    const { offsetX, offsetY} = this.getOffset(event);\n    \n    const hit = this.getHit(offsetX, offsetY);\n    const node = this.getNodeFromHit(hit);\n\n    this.store.dispatch(new ClickNode(node, event, hit));\n  }\n\n  handleDoubleTap(event: HammerInput) { // John Wick approved!\n    const { offsetX, offsetY} = this.getOffset(event);\n    const hit = this.getHit(offsetX, offsetY);\n    const node = this.getNodeFromHit(hit);\n\n    if (node) {\n      this.store.dispatch(new FlyToObject(node.id));\n    }\n  }\n\n  handlePress(event: HammerInput) {\n    const { offsetX, offsetY} = this.getOffset(event);\n    const hit = this.getHit(offsetX, offsetY);\n    const node = this.getNodeFromHit(hit);\n\n    if (node) {\n      this.store.dispatch(new FlyToObject(node.id));\n    }\n  }\n  \n  handlePan(event: HammerInput) {\n    if (this.pinchTicks > 0) {\n      // this was a pinch, this event seems to fire if the two fingers aren't removed at exactly the same time\n      return;\n    }\n\n    const panMode = this.store.selectSnapshot(EngineCameraState.getPanMode);\n    const { velocityX, velocityY } = event;\n\n    if (event.srcEvent.shiftKey || panMode === 'pan') {\n      this.cameraService.setCameraPan(\n        velocityX * TouchCamera.Pan,\n        velocityY * TouchCamera.Pan\n      );\n    } else {\n      this.cameraService.setCameraRotation(\n        velocityX * TouchCamera.Rotate,\n        velocityY * TouchCamera.Rotate\n      );\n    }\n  }\n\n  // forces are applied based on actual frame rate as compared to 60FPS so all models behave the same\n  handleMouseInputEngineTick() {\n    const rotation = this.cameraService.tickCameraRotation();\n    const pan = this.cameraService.tickCameraPan();\n    const zoom = this.cameraService.tickCameraZoom();\n\n    // during load, this code is running, and can produce very large values of dt\n    // this was causing the models to spin out of control\n    const dt = Math.min(maxForceMultiplier, (window.performance.now() - this.deltaTime) / timeElapsedAtSixtyFPS);\n\n    // Rotation\n    if (rotation.vx || rotation.vy) {\n      this.cameraService.rotateCameraStatic(\n        rotation.vx !== 0 ? dt * rotation.vx * MouseCamera.Rotate : 0,\n        rotation.vy !== 0 ? dt * rotation.vy * MouseCamera.Rotate : 0\n      );\n    }\n\n    // Pan\n    if (pan.x || pan.y) {\n      const f = Math.max(Human.renderer.camera.lookDistance / 80, 0.01);\n      this.cameraService.panCameraStatic(\n        dt * pan.x * f * MouseCamera.Pan,\n        dt * pan.y * f * MouseCamera.Pan,\n        dt * pan.z * f * MouseCamera.Pan\n      );\n    }\n\n    // Zoom\n    if (zoom !== 0) {\n      this.cameraService.setHumanZoom(dt * zoom * MouseCamera.Zoom);\n    }\n  }\n\n  handleCameraTick() {\n    if (this.pinchTicks > 0) {\n      this.pinchTicks--;\n    }\n    this.applyFriction();\n    const motion = this.store.selectSnapshot(EngineCameraState.getCameraMotion);\n    this.cameraService.setCameraPan(motion.panX, motion.panY);\n    this.cameraService.setCameraRotation(motion.rotateX, motion.rotateY);\n    this.cameraService.setCameraZoom(motion.zoom);\n  }\n\n  // apply friction to all movement values, using frame rate\n  //\n  // we use dt as a multiplier on forces, 1.0 means we are running at 60fps\n  //    larger values mean we are running slower\n  //\n  // usually this is expressed as:\n  //    motion = motion * friction * dt\n  //\n  // here, for values of dt larger than 1.1765 this results in increasing rather than decresing the movement\n  //\n  // so instead the friction value is modified by a small amount based on dt\n  //\n  // for values over 1, we are adding more friction by adding a negative value to the friction multiplier\n  //    and for values under 1 we are adding less than 0.1 to the multiplier, so it will always\n  //    decrease the initial friction force which is 0.85\n  private getFriction(value: number) {\n    if (value === 0) {\n      return 0;\n    }\n\n    const dt = (window.performance.now() - this.deltaTime) / timeElapsedAtSixtyFPS;\n    // don't allow the friction to go below 0\n    const friction = Math.max(0, (TouchCamera.Friction + 0.1 * (1 - dt)));\n    let newValue = value * friction;\n\n    if (Math.abs(newValue) < TouchCamera.FrictionThreshold) {\n      newValue = 0;\n    }\n\n    return newValue;\n  }\n\n  applyFriction() {\n    const motion = this.store.selectSnapshot(EngineCameraState.getCameraMotion);\n    if (motion.applyFriction !== true) {\n      return;\n    }\n\n    // Rotate\n    motion.rotateX = this.getFriction(motion.rotateX);\n    motion.rotateY = this.getFriction(motion.rotateY);\n\n    // Pan\n    motion.panX = this.getFriction(motion.panX);\n    motion.panY = this.getFriction(motion.panY);\n\n    // Zoom\n    motion.zoom = this.getFriction(motion.zoom);\n\n    if (\n      motion.rotateX === 0 &&\n      motion.rotateY === 0 &&\n      motion.panX === 0 &&\n      motion.panY === 0 &&\n      motion.zoom === 0\n    ) {\n      motion.applyFriction = false;\n    }\n\n    this.store.dispatch(new MoveCamera(motion));\n  }\n\n  // Apply friction to the momentum and eventually come to a stop\n  // Forces are applied based on actual frame rate so all models behave the same\n  // applyFriction() {\n  //   const motion = this.store.selectSnapshot(EngineCameraState.getCameraMotion);\n  //   if (motion.applyFriction !== true) {\n  //     return;\n  //   }\n    \n  //   const dt =\n  //     (window.performance.now() - this.deltaTime) / timeElapsedAtSixtyFPS;\n\n  //   // Rotate\n  //   if (motion.rotateX !== 0 || motion.rotateY !== 0) {\n  //     motion.rotateX = motion.rotateX * (TouchCamera.Friction + 0.1 * (1 - dt));\n  //     motion.rotateY = motion.rotateY * (TouchCamera.Friction + 0.1 * (1 - dt));\n  //     if (Math.abs(motion.rotateX) < TouchCamera.FrictionThreshold) {\n  //       motion.rotateX = 0;\n  //     }\n  //     if (Math.abs(motion.rotateY) < TouchCamera.FrictionThreshold) {\n  //       motion.rotateY = 0;\n  //     }\n  //   }\n\n  //   // Pan\n  //   if (motion.panX !== 0 || motion.panY !== 0) {\n  //     motion.panX = motion.panX * (TouchCamera.Friction + 0.1 * (1 - dt));\n  //     motion.panY = motion.panY * (TouchCamera.Friction + 0.1 * (1 - dt));\n  //     if (Math.abs(motion.panX) < TouchCamera.FrictionThreshold) {\n  //       motion.panX = 0;\n  //     }\n  //     if (Math.abs(motion.panY) < TouchCamera.FrictionThreshold) {\n  //       motion.panY = 0;\n  //     }\n  //   }\n\n  //   // Zoom\n  //   if (motion.zoom !== 0) {\n  //     motion.zoom = motion.zoom * (TouchCamera.ZoomFriction + 0.1 * (1 - dt));\n  //     if (Math.abs(motion.zoom) < TouchCamera.FrictionThreshold) {\n  //       motion.zoom = 0;\n  //     }\n  //   }\n\n  //   if (\n  //     motion.rotateX === 0 &&\n  //     motion.rotateY === 0 &&\n  //     motion.panX === 0 &&\n  //     motion.panY === 0 &&\n  //     motion.zoom === 0\n  //   ) {\n  //     motion.applyFriction = false;\n  //   }\n\n  //   this.store.dispatch(new MoveCamera(motion));\n  // }\n\n  flyToObject(objectId: string, animationDuration?: number) {\n    Human.renderer.camera.fly.flyTo({\n      objectId,\n      animationDuration\n    });\n  }\n  \n  jumpToObject(objectId: string) {\n    Human.renderer.camera.fly.jumpTo({ objectId });\n  }\n\n  flyToPoint(destination: CameraModel, animationDuration?: number) {\n    Human.renderer.camera.fly.flyTo({\n      ...destination,\n      animationDuration\n    }, () => {\n      this.store.dispatch(new SetCameraSuccess());\n    });\n  }\n\n  jumpToPoint(destination: CameraModel) {\n    Human.renderer.camera.fly.jumpTo(destination);\n  }\n\n  getNodeFromHit(hit: HitModel) {\n    let node: ViewTreeNode;\n\n    if (hit.objectId) {\n      const viewGraph = this.store.selectSnapshot(EngineState.getViewGraph);\n      node = this.engineService.getNode(viewGraph, hit.objectId);\n    }\n\n    return node;\n  }\n\n  getHit(x, y) {\n    // For clicks, set rayPick to true so we get a completely detailed hit object\n    // that includes the exact triangle the user clicked on. This is different \n    // from hover, that only target the general node. \n    const hit = Human.renderer.pick.pick(x, y, {rayPick: true }) as HitModel;\n    return hit;\n  }\n\n  getContainerStyles() {\n    const styles = {};\n\n    // set background\n    if (this.background && !this.isTransparentBackground) {\n      styles['background-image'] = BackgroundModel.toCSS(this.background);\n    }\n    // set display\n    if (!this.display) {\n      styles['display'] = 'none';\n    }\n    // set transparent\n    if (!this.engineVisible) {\n      styles['opacity'] = 0;\n    }\n\n    return styles;\n  }\n\n  // We calculate offsetX and offsetY using rect and center because iOS safari\n  // does not natively support offsetX and offsetY. Those properties return `undefined`\n  // when requested. \n  // More: http://www.jacklmoore.com/notes/mouse-position/\n  getOffset(event: any): {offsetX: number, offsetY: number} {\n    let x = 0;\n    let y = 0;\n\n    if (event.center) {\n      x = event.center.x;\n      y = event.center.y;\n    } else {\n      x = event.clientX;\n      y = event.clientY;\n    }\n\n    const target = <HTMLDivElement>this.engineElement.nativeElement;\n    const rect = target.getBoundingClientRect();\n    \n    return {\n      offsetX: x - rect.left,\n      offsetY: y - rect.top\n    };\n  }\n\n  playAudio(play?: boolean) {\n    play = !isNil(play) ? play : this.store.selectSnapshot(EngineState.getPlayAudio);\n\n    // Instantiate audio player first time chapter is viewed, then cache.\n    const audio = this.store.selectSnapshot(StoryChaptersState.getSelectedChapterAudio);\n\n    // Ensure audio has a full url\n    const src: string = get(audio, 'data.fullUrl');\n\n    if (src) {\n      // check for existing audio player\n      let audioPlayer: Howl = this.mediaService.getAudioPlayer(src);\n\n      // create audio player if required\n      if (!audioPlayer) {\n        audioPlayer = this.mediaService.addAudioPlayer(src);\n      }\n\n      // Stop all players to ensure we don't have multiple playing at once\n      this.mediaService.stopAudio();\n\n      // Play or pause audio\n      (play) ? audioPlayer.play() : audioPlayer.stop();\n    }\n  }\n\n  playChapterFromStart() {\n    const chapter = this.store.selectSnapshot(StoryChaptersState.getSelectedChapter);\n\n    this.playAudio();\n    this.store.dispatch(new PlayChapterAnimation(chapter));\n    this.store.dispatch(new ToggleAnimation(true));\n    \n  }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { EngineComponent } from './components/engine/engine.component';\nimport { NgxsModule } from '@ngxs/store';\nimport { EngineState } from './state/engine.state';\nimport { StoryModule } from '../story/story.module';\nimport { EngineCameraState } from './state/camera/engine.camera.state';\nimport { SharedModule } from '../shared/shared.module';\nimport { MaterialModule } from '../material.module';\nimport { EngineCameraBarComponent } from './components/engine-camera-bar/engine-camera-bar.component';\nimport { EngineScrubberComponent } from './components/engine-scrubber/engine-scrubber.component';\nimport { FormsModule } from '@angular/forms';\nimport { EngineNodesState } from './state/nodes/engine.nodes.state';\nimport { EngineBreadcrumbComponent } from './components/engine-breadcrumb/engine-breadcrumb.component';\nimport { NodeActionsModule } from '../shared/components/node-actions/node-actions.module';\nimport { EngineProgressComponent } from './components/engine-progress/engine-progress.component';\nimport { EngineProgressState } from './state/progress/engine.progress.state';\nimport { DirectivesModule } from '../shared/directives/directives.module';\nimport { EngineScrollComponent } from './components/engine-scroll/engine-scroll.component';\nimport { EngineFadeComponent } from './components/engine-fade/engine-fade.component';\nimport { EngineCameraPositionComponent } from './components/engine-camera-position/engine-camera-position.component';\nimport { EngineParticlesState } from './state/particles/particles.state';\nimport { NgxGoogleAnalyticsModule } from 'ngx-google-analytics';\nimport { EngineContextmenuComponent } from './components/engine-contextmenu/engine-contextmenu.component';\n\n@NgModule({\n  imports: [\n    NgxsModule.forFeature([\n      EngineState,\n      EngineCameraState,\n      EngineNodesState,\n      EngineProgressState,\n      EngineParticlesState\n    ]),\n\n    NgxGoogleAnalyticsModule,\n    CommonModule,\n    DirectivesModule,\n    MaterialModule,\n    FormsModule,\n    StoryModule,\n    SharedModule,\n    NodeActionsModule\n  ],\n  declarations: [\n    EngineComponent,\n    EngineCameraBarComponent,\n    EngineScrubberComponent,\n    EngineBreadcrumbComponent,\n    EngineProgressComponent,\n    EngineScrollComponent,\n    EngineFadeComponent,\n    EngineCameraPositionComponent,\n    EngineContextmenuComponent\n  ],\n  exports: [\n    EngineComponent,\n    EngineCameraBarComponent,\n    EngineScrubberComponent,\n    EngineBreadcrumbComponent,\n    EngineProgressComponent\n  ]\n})\nexport class EngineModule { }\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { ViewTreeNode, ViewTreeNodeFactory } from './models/view.tree-node';\nimport { BdGraphService } from 'src/lib/graph/graph.service';\nimport { BdGraph, BdGraphPropertyValueMap, BdGraphNode, BdGraphStateMap } from 'src/lib/graph/graph.model';\nimport { CameraModel } from './models/camera.model';\nimport { plainToClass, classToClass } from 'class-transformer';\nimport { SynchronizationModel } from '../story/models/synchronization.model';\nimport { GraphUtils } from 'src/lib/graph/graph-utils';\nimport { ChapterModel } from '../story/models/chapter.model';\nimport { calculateLeafStateMap } from 'src/lib/graph/leaf-state';\nimport { PickModel } from './models/pick.model';\nimport { HitModel } from './models/hit.model';\nimport { EventsEnum } from './models/events.enum';\nimport { ShowObjects } from './models/show-objects.model';\nimport { PostProcessingEffect } from './models/post-processing/effects';\nimport { TransparencyModeEnum } from './models/post-processing/transparency-mode.enum';\nimport { BoundaryModel } from './models/boundary.model';\nimport { EffectsEnum } from './models/post-processing/effects.enum';\nimport { partition } from 'lodash';\nimport { GroundShadowModel } from './models/post-processing/effects/ground-shadow-model';\n\ndeclare const Human: any;\n\nconst graphIdKey = 'objectId';\nconst graphChildKey = 'objects';\n\nconst graphProperties = {\n  shown: 'shown',\n  renderable: (id) => Human.scene.objects[id].isRenderable(),\n  pickable: 'pickable',\n  label: (id) => Human.scene.objects[id].displayName,\n  expanded: (id) => false,\n  layer: 'layer'\n};\n\nconst graphPropertySync = {\n  shown: 'trueWins',\n  renderable: 'falseWins',\n  pickable: 'trueWins'\n};\n\nconst defaultGraphConfig = {\n  trim: true\n};\n\nconst enum queryPropertyEnum {\n  Hidden = 'hidden',\n  Clipped = 'clipped',\n  Disabled = 'disabled'\n}\n\nclass NodeConfig {\n  id: string;\n  displayName: string;\n}\n\n/*\nData specification for per-chapter modifcations to scene graph to create a user facing view graph\n*/\nclass ChapterViewGraphConfig {\n  trim: boolean;\n  terminal: string[];\n  root: {\n    children: string[],\n    replace: boolean\n  };\n  nodes: NodeConfig[];\n  connect: {\n    [key: string]: {\n      replace: boolean;\n      children: string[];\n    };\n  };\n\n  constructor(graphData: any) {\n    this.trim = graphData.trim || false;\n    this.terminal = graphData.terminal || [];\n    this.root = graphData.root || {children: [], replace: false};\n    this.connect = graphData.connect || {};\n    this.nodes = graphData.nodes || [];\n  }\n}\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class EngineService {\n\n  // #TODO: [EM] these maps should be in state\n  private objectToNodeMap: {[key: string]: string} = {}; // one object id in the engine maps to one node in the view graph\n  private nodeToObjectMap: {[key: string]: string[]} = {}; // one node in the view graph maps to one or more engine object ids.\n\n  /**\n   * Maps Human.events from the engine in application observables so that we can subscribe, filter, buffer\n   * and more without needing direct knowlege of the Human library across the application.\n   */\n  private events: any = {};\n\n  private makeObservable(event: EventsEnum) {\n    return new Observable(observer => {\n      Human.events.on(event, (params) => {\n        observer.next(params);\n      });\n    });\n  }\n\n  constructor(\n    private graphService: BdGraphService\n  ) {\n    this.events = Object.values(EventsEnum)\n      .reduce((result, event) => {\n        result[event] = this.makeObservable(event);\n        return result;\n      }, {});\n  }\n\n  getCanvas(): HTMLCanvasElement {\n    return Human.renderer.canvas.canvas;\n  }\n\n  getEvent(event: EventsEnum): Observable<any> {\n    return this.events[event];\n  }\n\n  fireEvent(event: EventsEnum, params: any): void {\n    Human.events.fire(event, params);\n  }\n\n  getSceneBoundary(): BoundaryModel {\n    return Human.scene.getBoundary();\n  }\n\n  getObjectBoundary(objectId: string): BoundaryModel {\n    return Human.scene.objects[objectId].getBoundary();\n  }\n\n  pickScene(pick: PickModel): HitModel {\n    return Human.renderer.pick.pick(\n      pick.x,\n      pick.y,\n      { rayPick: pick.rayPick }\n    );\n  }\n\n  transformObject(objectId: string, params: any) {\n    const object = Human.scene.objects[objectId];\n    if (object) {\n        object.setTransform(params);\n    } else {\n      console.error(`Scene object not found: '${objectId}'`);\n    }\n  }\n\n  // set 'shown' attribute of specified nodes to specifed value and synchronize viewGraph\n  toggleNodes(nodeIds: string[], visible: boolean) {\n    // handles the conversion of view graph nodes to engine objects\n\n    // Bind fetchAssets to visible, so that any time a node is set to visible the engine\n    // will attempt to load it's assets (if they haven't been loaded already)\n    const config = {replace: false, objects: {}, fetchAssets: visible };\n\n    nodeIds.forEach((nodeId) => {\n        this.getObjects(nodeId).forEach((humanObjectId: string) => {\n          config.objects[humanObjectId] = visible;\n        });\n    });\n    Human.scene.setEnabledObjects(config);\n  }\n\n\n  // Unlike `toggleNodes`, this method doesn't assume that you wish to set a batch of nodes to the same value.\n  setNodesVisible(nodes: {[objectId: string]: boolean}, replace = false) {\n    const config = {\n      replace,\n      objects: {...nodes},\n      fetchAssets: true\n    };\n    Human.scene.setEnabledObjects(config);\n  }\n\n  /**\n  * Sets the specified nodes pickable state (including leaves)\n  */\n  setNodesPickable(nodes: Record<string, boolean>) {\n    // #TODO[AC]? The engine doesn't emit event of pick changes, track via state map\n\n    Object.keys(nodes).forEach((nodeId) => {\n      const object = Human.scene.objects[nodeId];\n      // set node pickable, else leaves\n      const pickableNodeIds = object.isLeaf() ? [nodeId] : this.getLeafObjects(nodeId);\n      pickableNodeIds.forEach((pickableNodeId) => {\n        const pickableObject = Human.scene.objects[pickableNodeId];\n        pickableObject.setPickable(nodes[nodeId]);\n      });\n    });\n  }\n\n  filterObjects(objects, query) {\n    let i = objects.length;\n    while (i--) {\n      switch (true) {\n        case objects[i] instanceof Human.scene.Group:\n          objects[i].objects = this.filterObjects(objects[i].objects, query);\n          if (objects[i].objects.length === 0) {\n            objects.splice(i, 1);\n          }\n          break;\n\n        case objects[i] instanceof Human.scene.Object:\n          if (objects[i].displayName.toLowerCase().indexOf(query) === -1) {\n            objects.splice(i, 1);\n          }\n          break;\n      }\n    }\n\n    return objects;\n  }\n\n  setObjectLayer(nodeId: string, layer: number) {\n    const object = Human.scene.objects[nodeId];\n\n    object.layer = layer;\n\n    if (object.renderables) {\n\n      for (let i = 0; i < object.renderables.length; ++i) {\n        object.renderables[i].setLayer(layer);\n      }\n\n    } else if (object.hasOwnProperty('_layerNode')) {\n\n      object._layerNode.setPriority(layer);\n    } else if (object.hasOwnProperty('_propertiesNode')) {\n\n      object._propertiesNode.setProperties({ layer: layer });\n    }\n  }\n\n  getObjectLayerValues(nodeIds: string[]) {\n    const objectLayerValues = {};\n    const sceneBB = Human.scene.getBoundary();\n\n    nodeIds.forEach((nodeId) => {\n      const object = Human.scene.objects[nodeId];\n      const bb = object.getBoundary();\n\n      const minX = Math.min(bb.xmin - sceneBB.xmin, sceneBB.xmax - bb.xmax);\n      const minY = 2 * Math.min(bb.ymin - sceneBB.ymin, sceneBB.ymax - bb.ymax);\n      const minZ = Math.min(bb.zmin - sceneBB.zmin, sceneBB.zmax - bb.zmax);\n\n      const layer = object.layer;\n      objectLayerValues[layer] = objectLayerValues[layer] || [];\n\n      objectLayerValues[layer].push({\n        nodeId: nodeId,\n        value: Math.min(minX, minY, minZ)\n      });\n    });\n\n    return objectLayerValues;\n  }\n\n  getSceneGraph(rootObjects) {\n    const sceneGraph = GraphUtils.createGraphFromSrc(rootObjects, graphIdKey, graphChildKey, graphProperties);\n    this.graphService.synchronize(sceneGraph, graphPropertySync); // MUTATIVE\n    return sceneGraph;\n  }\n\n  // build a BdGraph object representing the engine's scene\n  createViewGraph(chapterShowObjects: ShowObjects, shouldPrune: boolean = true): BdGraph<ViewTreeNode> {\n\n    const rootObjects: GraphUtils.SGNode[] = shouldPrune\n      ? GraphUtils.pruneHiddenObjects(Human.scene.rootObjects, chapterShowObjects)\n      : Human.scene.rootObjects;\n\n    // We assume that all content has a root node\n    // we must lift that root's child(ren) to be the new 'roots' of the view graph\n    // to do this, we can assume that all roots that include the suffix '-root' have showObjects = false,\n    // with their immediate children having showObjects = true\n    // we can prune again, and any root's children will be pulled to the top of the view graph.\n\n    const formatShowObjects = rootObjects.reduce<ShowObjects>\n      ((acc, root) => {\n        const turnOff = root.objectId.includes('-root');\n        acc[root.objectId] = turnOff === true ? false : true;\n\n        // turn this root's immediate children on\n        if (turnOff) {\n          root.objects.forEach(child => {\n            acc[child.objectId] = true;\n          });\n        }\n\n        return acc;\n      },\n    {});\n\n    const viewGraph = this.getSceneGraph(\n      GraphUtils.pruneHiddenObjects(rootObjects, formatShowObjects)\n    ) as BdGraph<ViewTreeNode>;\n\n    this.graphService.resetDepth(viewGraph);\n    return viewGraph;\n  }\n\n  // translate engine's object id to the representative view node\n  getNode(viewGraph: BdGraph<ViewTreeNode>, id: string): ViewTreeNode {\n    if (this.graphService.nodeExists(viewGraph, id)) {\n      // object exists in view graph\n      return GraphUtils.getNode(viewGraph, id);\n    } else if (this.objectToNodeMap[id]) {\n      // object is masked\n      return GraphUtils.getNode(viewGraph, this.objectToNodeMap[id]) as ViewTreeNode;\n    } else {\n      // no available node\n      return null;\n    }\n  }\n\n  // #TODO[EM]: this should be in state, harvested from chapter object on load\n  // getChapterData\n  getChapterGraphConfig(): ChapterViewGraphConfig {\n    const c = Human.timeline.activeRoot._nowBranch;\n    return new ChapterViewGraphConfig({...defaultGraphConfig, ...c.graph || {}});\n  }\n\n  getRootObjects(): any {\n    // TODO.. type this\n    return Human.scene.rootObjects;\n  }\n\n  getAllSceneObjects(): any {\n    return Human.scene.objects;\n  }\n\n  // given a view node id, return the corresponding human object-id\n  getObjects(id: string): string[] {\n    if (this.nodeToObjectMap[id]) {\n      return this.nodeToObjectMap[id];\n    } else {\n      return [Human.scene.objects[id].objectId] || [];\n    }\n\n  }\n\n  // given a view node id, return the corresponding leaf human-object ids\n  // #NOTE: [EM] This is stateful and could benefit from pre-caching viewNodeId -> human leaf objects\n  getLeafObjects(id: string): string[] {\n    if (id in this.nodeToObjectMap) {\n      const leaves = {};\n      this.nodeToObjectMap[id].forEach(objectId => {\n        if (Human.scene.objects[objectId].isLeaf()) {\n          leaves[objectId] = true;\n        } else {\n          Human.scene.getLeaves(objectId).forEach(leafId => {\n            leaves[leafId] = true;\n          });\n        }\n      });\n      return Object.keys(leaves);\n    } else if (id in Human.scene.objects) {\n      return Human.scene.getLeaves(id);\n    } else {\n      return [];\n    }\n  }\n\n  getChapter(id: string): any {\n    return Human.timeline.branchTimelines[id] || null;\n  }\n\n  getActiveChapters(): any[] {\n    if (Human.timeline.activeRoot) {\n      return Human.timeline.activeRoot._chapters;\n    } else {\n      return [];\n    }\n  }\n\n  // return bounding box of objects\n  getBoundaryFromObjects(objectIds: string[]): any {\n    objectIds = objectIds.filter((x) => Human.scene.objects[x].isLeaf());\n    return Human.scene.getBoundary({objectIds: objectIds, clipped: true});\n  }\n\n  getLeaves(objectId?: string) {\n    return Human.scene.getLeaves(objectId);\n  }\n\n  // get visible leaves\n  getVisibleLeaves(): string[] {\n    return Human.scene.getEnabledLeaves();\n  }\n\n  // get camera lookat\n  getCameraLookAt(): CameraModel {\n    return plainToClass(CameraModel, Human.renderer.camera.getLookAt() as Object);\n  }\n\n  // get world position from barycentric coordiantes\n  barycentricToWorld(objectId: string, primitiveIndex: number, barycentric: any, renderableIndex: number = 0): [number, number, number] {\n    const out = new Float32Array([0, 0, 0 ]);\n    const humanObject = Human.scene.objects[objectId];\n    humanObject.barycentricToWorldSpace(renderableIndex, primitiveIndex, barycentric, out);\n    return !isNaN(out[0]) ? [...Array.from(out)] as [number, number, number] : [0, 0, 0];\n  }\n\n  setGraphState(synchronization: SynchronizationModel) {\n    Human.scene.setObjectProperties(synchronization);\n  }\n\n  // return a list of all states (namespaces) with assets loaded in the engine\n  getAssetNamespaces(): string[] {\n    const namespaces = {};\n    Object.keys(Human.assets.loadedAssets).map(wholeId => wholeId.split('/')[0]).forEach(namespace => {\n      namespaces[namespace] = true;\n    });\n    return Object.keys(namespaces);\n  }\n\n  // [SCENE QUERY] Return objects shown in at least one chapter\n  queryShownObjects(chapters: ChapterModel[], sceneGraph: BdGraph<BdGraphNode>, wholeGraph = true): BdGraphPropertyValueMap {\n    const shown = {};\n    chapters.forEach(chapter => {\n      // #NOTE: [EM] This could be extended to include otehr 'shown' conditions e.g. clipped, opacity, etc.\n      const leafStateMap = calculateLeafStateMap(sceneGraph, chapter.synchronization, ['shown']);\n      for (const id in leafStateMap) {\n        if (leafStateMap.hasOwnProperty(id)) {\n          shown[id] = (shown[id] || false) || leafStateMap[id].shown;\n        }\n      }\n    });\n\n    let result = shown;\n    if (wholeGraph) {\n      // create leaf state map from property maps\n      const leafStateMap = this.graphService.createGraphStateMapFromPropertyMaps({'shown': shown});\n      const graphStateMap = this.graphService.calculateGraphStateMap(sceneGraph, {'shown': 'trueWins'}, leafStateMap, true);\n      result = this.graphService.extractPropertymapFromGraphState(graphStateMap, 'shown');\n    }\n    return result;\n  }\n\n  // load assets for graph objects if they exist\n  loadGraphObject(id: string): Observable<boolean> {\n    const humanObjects = this.getObjects(id).map(objectId => Human.scene.objects[objectId]);\n\n    return new Observable(observer => {\n      // load default asset types\n      Human.scene.graph.attachAssetSetsToSubtree(humanObjects, null, () => {\n        observer.next(true);\n        observer.complete();\n      });\n    });\n  }\n\n  setProperties(properties: { [key: string]: any }) {\n    Human.properties.set(properties);\n  }\n\n  setTransparencyMode(mode: TransparencyModeEnum) {\n    Human.renderer.setTransparencyMode(mode);\n  }  \n\n  // Post Processing\n\n  setPostProcessingEnabled(enabled: boolean) {\n    if (enabled) {\n      Human.renderer.postprocess.enable();\n    } else {\n      Human.renderer.postprocess.disable();\n    }\n  }\n\n  setPostProcessingFeatures(effects: PostProcessingEffect[]) {\n    const ppEffects = effects.filter(\n      (effect) => effect.effect !== EffectsEnum.GroundShadow\n    );\n\n    Human.renderer.postprocess.parse(ppEffects);\n\n    const groundShadow = effects.find(\n      (effect) => effect.effect === EffectsEnum.GroundShadow\n    ) as GroundShadowModel;\n\n    if (groundShadow) {\n      Human.renderer.groundShadow.init();\n      Human.renderer.groundShadow.update({\n        blurAmount: groundShadow.blur,\n        opacity: groundShadow.opacity,\n        translation: [groundShadow.xPos, groundShadow.yPos, groundShadow.zPos],\n        scale: groundShadow.size,\n      });\n    } else {\n      Human.renderer.groundShadow.destroy();\n    }\n  }\n\n}\n","export class TimerangeModel {\n    firstTime = 0;\n    lastTime = 1;\n}\n","\nconst extendColor = (color: number[], matches) => {\n  const result = [...color];\n  matches.forEach((v: string) => { \n    if (v !== undefined) {\n      result.push(Number(v));\n    } else {\n      result.push(1);\n    }\n  });\n  return result;\n};\n\nconst colorsFromCSS = (css: string) => {\n  const rgb255 = /rgba?\\((\\d{1,3})\\,\\s*(\\d{1,3})\\,\\s*(\\d{1,3})\\,?\\s*(\\d+\\.\\d{0,5})?\\)/g;\n  let colors: number[] = [];\n  const colorString1 = rgb255.exec(css);\n  const colorString2 = rgb255.exec(css);\n  colors = extendColor(colors, colorString1.slice(1, 5));\n  colors = extendColor(colors, colorString2.slice(1, 5));\n  return colors;\n};\n\nexport class BackgroundModel {\n  constructor(\n    public colors: number[], // 0-255\n    public gradientType: 'radial' | 'linear',\n    public colorStops: [number, number]\n  ) { }\n\n  static equals(a: BackgroundModel, b: BackgroundModel): boolean {\n    return a.gradientType === b.gradientType // match gradient\n      && a.colors.length === b.colors.length && a.colors.every((color, index) => color === b.colors[index]) // match colors\n      && a.colorStops.length === b.colorStops.length && a.colorStops.every((colorStop, index) => colorStop === b.colorStops[index]); // match color stops      \n  }\n\n  // convert degenerate legacy background specs into canonical background model\n  static deserialize(chapterBackground: any): BackgroundModel {\n\n    if (!Object.keys(chapterBackground).length) {\n      return null;\n    }\n\n    // convert colors to rgba e.g. [255,255,255,1]\n    let colors: number[] = [];\n    if (typeof chapterBackground.colors === 'string') {\n      colors = colorsFromCSS(chapterBackground.colors);\n    } else if (Array.isArray(chapterBackground.colors) && chapterBackground.colors.length === 8) {\n      // ensure rgb and not 0-1\n      colors = chapterBackground.colors.map((channel, idx) => ( (idx + 1 ) % 4 && channel <= 1.0) ? Math.round(channel * 255) : channel);\n    }\n\n    // default to radial if not a valid gradient type\n    const gradientType = /radial|linear/.test(chapterBackground.gradientType) ? chapterBackground.gradientType : 'radial';\n    \n    // color stops should always be array of numbers between 0 and 100\n    const chapterColorStops = chapterBackground.colorStops;\n    const colorStops: [number, number] = Array.isArray(chapterColorStops) && chapterColorStops.length === 2\n      ? [chapterColorStops[0], chapterColorStops[1]]\n      : [0, 100];\n\n    return new BackgroundModel(\n      colors,\n      gradientType,\n      colorStops\n    );\n  }\n\n  // css gradient style with 2 and only 2 color stops\n  static toCSS(background: BackgroundModel) {\n    const c = background.colors;\n    const colorstop1 = `rgba(${c[0]},${c[1]}, ${c[2]}, ${c[3]}) ${background.colorStops[0]}%`;\n    const colorstop2 = `rgba(${c[4]},${c[5]}, ${c[6]}, ${c[7]}) ${background.colorStops[1]}%`;\n    if (background.gradientType === 'radial') {\n      return `radial-gradient(circle, ${colorstop1}, ${colorstop2})`;\n    } else {\n      return `linear-gradient(180deg, ${colorstop1}, ${colorstop2})`;\n    }\n  }\n\n  // from css gradient to Background Model\n  static fromCSS(css: string): BackgroundModel {\n    // gradient type\n    const gradientType = /radial-gradient/.test(css) ? 'radial' : 'linear';\n\n    // colors\n    const colors = colorsFromCSS(css);\n    \n    // color stops\n    const stopRX = /([0-9]+)\\%/g;\n    const colorStops: [number, number] = [0, 100];\n    colorStops[0] = Number(stopRX.exec(css)[1]);\n    colorStops[1] = Number(stopRX.exec(css)[1]);\n\n    return new BackgroundModel(\n      colors,\n      gradientType,\n      colorStops\n    );\n  }\n\n  static isTransparent(background: BackgroundModel): boolean {\n    // If not chapter is set, infer default background\n    if (!background || !background.colors) {\n      return false;\n    }\n\n    const colors = background.colors;\n    const alpha1 = colors[3];\n    const alpha2 = colors[7];\n    // 4 vs 8 colors\n    return colors.length <= 4 ? alpha1 === 0 : (alpha1 === 0 && alpha2 === 0);\n  }\n}\n","export class CameraMotionModel {\n    constructor(\n        public zoom = 0,\n        public panX = 0,\n        public panY = 0,\n        public rotateX = 0,\n        public rotateY = 0,\n        public applyFriction = false\n    ) {}\n}\n","import { XYZModel } from 'src/app/shared/models/xyz.model';\n\nexport class CameraModel {\n    eye: XYZModel;\n    look: XYZModel;\n    up: XYZModel;\n}\n","import { EngineVisibilityEnum } from './engine-visibility.enum';\n\nexport class EnginePositionModel {\n    public right: number;\n    public bottom: number;\n\n    constructor(\n        public left: number,\n        public top: number,\n        public width: number,\n        public height: number,\n        public visibility: EngineVisibilityEnum\n    ) {}\n}\n","export enum EngineVisibilityEnum {\n    Hidden = -1,\n    Shown = 1\n}\n","export enum EventsEnum {\n  // ---------- Root Events ----------\n  // Core\n  Started = 'started',\n  Loaded = 'loaded',\n  Tick = 'tick',\n\n  // Human\n  HumanReady = 'human.ready',\n  HumanStarted = 'started',\n  Error = 'error',\n  HumanError = 'human.error',\n\n  // Private logging\n  LogDebug = '_log.debug',\n  LogError = '_log.error',\n  LogInfo = '_log.info',\n  LogWarn = '_log.warn',\n  SceneLoaded = 'scene.loaded',\n  HumanProgress = 'human.progress',\n\n  // ---------- Namespaced Events ----------\n  // Annotations\n  AnnotationsCreated = 'annotations.created',\n  AnnotationsDestroyed = 'annotations.destroyed',\n  AnnotationsHidden = 'annotations.hidden',\n  AnnotationsShown = 'annotations.shown',\n\n  // Assets\n  AssetsLoadFinish = 'assets.load.finish',\n  AssetsLoadProgress = 'assets.load.progress',\n  AssetsLoadStart = 'assets.load.start',\n\n  // Camera\n  CameraRested = 'camera.rested',\n  CameraUpdated = 'camera.updated',\n\n  // Hotspots\n  HotspotsDisplayUpdated = 'hotspots.displayUpdated',\n  HotspotsEntered = 'hotspots.entered',\n  HotspotsLeft = 'hotspots.left',\n  HotspotsPicked = 'hotspots.picked',\n  HotspotsPositionUpdated = 'hotspots.positionUpdated',\n\n  // Labels API events\n  LabelsCreated = 'labels.created',\n  LabelsUpdated = 'labels.updated',\n  LabelsMoved = 'labels.moved',\n  LabelsDestroyed = 'labels.destroyed',\n  LabelsChapterInfo = 'labels.chapterInfo',\n  LabelsShown = 'labels.shown',\n  LabelsHidden = 'labels.hidden',\n  LabelsEnabled = 'labels.enabled',\n  LabelsDisabled = 'labels.disabled',\n  LabelsEntered = 'labels.entered',\n  LabelsLeft = 'labels.left',\n  LabelsPicked = 'labels.picked',\n\n  // Modules\n  ModuleInteractive = 'module.interactive',\n  ModulesActivateFinish = 'modules.activate.finish',\n  ModulesCreateFinish = 'modules.create.finish',\n  ModulesDestroyFinish = 'modules.destroy.finish',\n\n  // Pick\n  PickPicked = 'pick.picked',\n\n  // Scene\n  SceneMarkersUpdated = 'scene.markers.updated',\n  SceneObjectRenderable = 'scene.objectRenderable',\n  SceneObjectsSelected = 'scene.objectsSelected',\n  SceneObjectsShown = 'scene.objectsShown',\n  ScenePicked = 'scene.picked',\n  SceneRestored = 'scene.restored',\n  SceneXrayEnabled = 'scene.xrayEnabled',\n  SceneXrayDisabled = 'scene.xrayDisabled',\n  \n  // internal only - used because the API lib only fires human.ready once, even though we can do things like scene.load()\n  Debug_SceneReady = 'debug.scene.ready', \n\n  // Timeline\n  TimelineChaptersActivated = 'timeline.chapters.activated',\n  TimelineChaptersActivateFinish = 'timeline.chapters.activate.finish',\n  TimelineChaptersActivateStart = 'timeline.chapters.activate.start',\n  TimelineChapterTransition = 'timeline.chapterTransition',\n  TimelinePlaying = 'timeline.playing',\n  TimelineScrubbed = 'timeline.scrubbed',\n  TimelinePlayed = 'timeline.played',\n  TimelineStopped = 'timeline.stopped',\n  TimelinePaused = 'timeline.paused',\n  TimelineUnpaused = 'timeline.unpaused',\n  TimelineCompleted = 'timeline.completed',\n\n  // Graph\n  GraphAssetAttachFinish = 'graph.assetAttach.finish',\n  TweenVisibilityUpdate = 'TweenVisibilityUpdate'\n}\n","export class HitModel {\n    canvasPos: [number, number];\n    name?: string;\n    nodeId?: string;\n    objectId?: string;\n\n    primitiveIndex?: number;\n    renderableIndex?: number;\n    primitive?: string; // triangle, ?\n    indices?: { 0: number; 1: number; 2: number };\n    position?: { 0: number; 1: number; 2: number };\n    barycentric?: { 0: number; 1: number; 2: number };\n    normal?: { 0: number; 1: number; 2: number };\n    worldPos?: { 0: number; 1: number; 2: number };\n    uvs?: { 0: number; 1: number; }[];\n    uv?: { 0: number; 1: number; };\n    mode?: string;\n}\n","// tslint:disable:max-line-length\nimport { PaintPresetModel } from 'src/app/edit/models/paint-preset.model';\nimport { ColorRecipeModel } from 'src/app/edit/models/color-recipe.model';\nimport { ScalarFresnelModel } from 'src/app/edit/models/scalar-fresnel.model';\n\nenum PaintGroups {\n  Colors = 'Colors',\n  Effects = 'Effects'\n}\n\nenum PaintIcons {\n  Colors = '_color',\n  Effects = 'adjust'\n}\n\n\n// Colors\nexport const PaintPresetOriginal = new PaintPresetModel('Original', new ColorRecipeModel({ tintColor: false, saturation: false, contrast: false, brightness: false, opacity: false }), 'times-circle', PaintGroups.Colors);\nexport const PaintPresetBlack = new PaintPresetModel('Black', { tintColor: [0, 0, 0], saturation: false, contrast: false, brightness: false, opacity: false }, PaintIcons.Colors, PaintGroups.Colors);\nexport const PaintPresetRed = new PaintPresetModel('Red', { tintColor: [1, 0, 0], saturation: false, contrast: false, brightness: false, opacity: false }, PaintIcons.Colors, PaintGroups.Colors);\nexport const PaintPresetYellow = new PaintPresetModel('Yellow', new ColorRecipeModel({ tintColor: [1, 1, 0], saturation: false, contrast: false, brightness: false, opacity: false }), PaintIcons.Colors, PaintGroups.Colors);\nexport const PaintPresetGreen = new PaintPresetModel('Green', new ColorRecipeModel({ tintColor: [0, 1, 0], saturation: false, contrast: false, brightness: false, opacity: false }), PaintIcons.Colors, PaintGroups.Colors);\nexport const PaintPresetCyan = new PaintPresetModel('Cyan', new ColorRecipeModel({ tintColor: [0, 1, 1], saturation: false, contrast: false, brightness: false, opacity: false }), PaintIcons.Colors, PaintGroups.Colors);\nexport const PaintPresetBlue = new PaintPresetModel('Blue', new ColorRecipeModel({ tintColor: [0, 0, 1], saturation: false, contrast: false, brightness: false, opacity: false }), PaintIcons.Colors, PaintGroups.Colors);\nexport const PaintPresetPink = new PaintPresetModel('Pink', new ColorRecipeModel({ tintColor: [1, 0, 1], saturation: false, contrast: false, brightness: false, opacity: false }), PaintIcons.Colors, PaintGroups.Colors);\n\n// Effects\nexport const PaintPresetGrayscale = new PaintPresetModel('Grayscale', new ColorRecipeModel({ tintColor: false, saturation: -100, contrast: false, brightness: false, opacity: false }), PaintIcons.Effects, PaintGroups.Effects);\nexport const PaintPresetDesaturated = new PaintPresetModel('Desaturated', new ColorRecipeModel({ tintColor: false, saturation: -50, contrast: false, brightness: false, opacity: false }), PaintIcons.Effects, PaintGroups.Effects);\nexport const PaintPresetFade = new PaintPresetModel('Fade', new ColorRecipeModel({ tintColor: [0, 0, 0], contrast: false, brightness: 55, saturation: -100, opacity: new ScalarFresnelModel({ edge: 1, center: 0, edgeBias: 0, centerBias: 1, power: 1 }) }), PaintIcons.Effects, PaintGroups.Effects);\n\n// Tint Color Presets\nexport const PaintTintColorPresets = [\n  PaintPresetBlack,\n  PaintPresetRed,\n  PaintPresetYellow,\n  PaintPresetGreen,\n  PaintPresetCyan,\n  PaintPresetBlue,\n  PaintPresetPink\n];\n\n// Complete Paint Preset Set\nexport const PaintPresets = [\n  PaintPresetOriginal,\n  ...PaintTintColorPresets,\n  PaintPresetGrayscale,\n  PaintPresetDesaturated,\n  PaintPresetFade\n];\n\n","export enum EffectsEnum {\n    SSAO = 'sao',\n    Blur = 'blur',\n    RadialBlur = 'radialBlur',\n    DOF = 'dof',\n    FXAA = 'fxaa',\n    GroundShadow = 'groundShadow'\n}\n","// mapping of engine transparency modes\nexport enum TransparencyModeEnum {\n    Alpha = 'alpha',\n    ImprovedAlpha =  'improvedAlpha',\n    AddAlpha =  'addAlpha',\n    AlphaToCoverage =  'alphaToCoverage',\n    WeightedOIT = 'weightedOIT'\n}\n","import {HumanObjectTransform} from 'src/app/edit/models/scene-graph-node';\nimport { Type } from 'class-transformer';\n\nexport class SceneGraphNode {\n    // Define Types\n    @Type(() => HumanObjectTransform)\n\n    // Common Node Properties -----------------------------------------\n    objectId?: string; // NOTE: [EM] bad anonymous objects\n    displayName: string;\n    layer?: number;\n\n\n    // Group Node Properties ------------------------------------------\n    objects?: SceneGraphNode[];\n\n    // Leaf Node Properties -------------------------------------------\n    geometryId?: string;\n    materialId?: string;\n    morphId?: string;\n    transformId?: string;\n    transform?: HumanObjectTransform;\n\n}\n","export enum ScrollModeEnum {\n  // capture scroll away from parent window.  i.e. scrolljack\n  Capture = 'capture',\n  \n  // only capture when CTRL is pressed. Present a message if user scrolls without pressing CTRL.\n  DoNotCaptureShowMessage = 'do_not_capture_show_message', \n\n  // only capture when CTRL is pressed\n  DoNotCapture = 'do_not_capture' \n}\n","export enum ToolEnum {\n    Select = 'Select',\n    Hide = 'Hide',\n    Paint = 'Paint',\n    Label = 'Label',\n    Isolate = 'Isolate',\n    Fade = 'Fade',\n    Position = 'Position'\n}\n","import {BdGraphNode, BdGraph, BdGraphNodeFactory} from '../../../lib/graph/graph.model';\n\n// Model for node available in state for user interaction with scene graph\n\nexport interface ViewTreeNode extends BdGraphNode {\n    label: string;\n    description: string;\n    \n    boolState: {\n        pickable: boolean;\n        renderable: boolean;\n        shown: boolean;\n        expanded: boolean;\n    };\n\n    numState: {\n      layer: number;\n    };\n\n}\n\nexport function ViewTreeNodeFactory(data: any): ViewTreeNode {\n    return {\n        // inherited props:\n        ...BdGraphNodeFactory(data.id),\n\n        // view tree node props:\n         label : data.label || '',\n         description : data.description,\n\n         boolState: {\n             pickable: data.hasOwnProperty('pickable') ? data.pickable : true,\n             renderable: data.renderable || false,\n             shown : data.shown || false,\n             expanded : data.expanded || false,\n         },\n\n         numState: {\n             layer: data.layer\n         }\n    };\n}\n","import { PaintTintColorPresets } from './paint-presets.const';\nimport { ColorUtils } from 'src/app/shared/libraries/colors/colors';\n\nexport interface WhiteboardSizePresetModel {\n  label: string;\n  size: number;\n}\n\nexport interface WhiteboardColorPresetModel {\n  label: string;\n  color: string;\n}\n\nconst brushSizes = [4, 8, 12, 16, 24, 32];\nconst textSizes = [8, 12, 16, 20, 24, 32];\n\n\nconst makePresets = (sizes) =>\n  sizes.reverse().map((value) => ({ label: `${value}`, size: value }));\n\nexport const WhiteboardBrushSizePresets: WhiteboardSizePresetModel[] = makePresets(brushSizes);\nexport const WhiteboardTextSizePresets: WhiteboardSizePresetModel[] = makePresets(textSizes);\n\n// Brush Colors: from app paint swatches\nexport const WhiteboardColorPresets: WhiteboardColorPresetModel[] = [\n  ...PaintTintColorPresets.map((preset) => {\n    const { label, recipe } = preset;\n    const tintColor: [number, number, number] = Array.isArray(recipe.tintColor)\n      ? recipe.tintColor\n      : [1, 1, 1];\n\n    return {\n      label: label,\n      color: ColorUtils.rgbToHex(tintColor, true)\n    };\n  }),\n  {\n    label: 'White',\n    color: '#ffffff'\n  },\n];\n\nexport const DefaultAnnotateBrushSizePreset = WhiteboardBrushSizePresets[4];\nexport const DefaultAnnotateColorPreset = WhiteboardColorPresets[0];\nexport const DefaultAnnotateTextSizePreset = WhiteboardTextSizePresets[3];\n\n","import { Injectable } from '@angular/core';\nimport { Store } from '@ngxs/store';\nimport { EngineState } from './state/engine.state';\nimport { BdGraphService } from 'src/lib/graph/graph.service';\nimport { ViewTreeNode } from './models/view.tree-node';\nimport { EngineService } from './engine.service';\nimport { PaintPresetOriginal, PaintPresetFade } from './models/paint-presets.const';\nimport { BdGraph } from 'src/lib/graph/graph.model';\nimport { get, isNil } from 'lodash';\nimport { ObjectColor } from '../shared/object-color';\nimport { EngineColorRecipeModel } from '../edit/models/engine-color-recipe.model';\nimport { ColorRecipeModel } from '../edit/models/color-recipe.model';\nimport { ObjectId } from './state/nodes/engine.nodes.state.model';\n\ndeclare const Human: any;\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class PaintService {\n\n  constructor(\n    private store: Store,\n    private graphService: BdGraphService,\n    private engineService: EngineService\n  ) { }\n\n  highlightDisabled = false;\n      \n  colorObject(objectId: string, params: EngineColorRecipeModel) {\n    const { tintColor, saturation, brightness, contrast, opacity } = params;\n    const humanObject = Human.scene.objects[objectId];\n    \n    if (humanObject instanceof Human.scene.Object) {\n      // to clear or not to clear, that is the question\n      // apply mod properties that are not default\n      if (!isNil(tintColor)) {\n        humanObject.setTintColor(tintColor);\n      }\n      if (!isNil(saturation)) {\n        humanObject.setSaturation(saturation);\n      }\n      if (!isNil(brightness)) {\n        humanObject.setBrightness(brightness);\n      }\n      if (!isNil(contrast)) {\n        humanObject.setContrast(contrast);\n      }\n      if (!isNil(opacity)) {\n        humanObject.setOpacity(opacity);\n      }\n    }\n  }\n\n  getColor(objectId: string): EngineColorRecipeModel {\n    return ObjectColor.getColorRecipe(Human, objectId);\n  }\n\n  uncolorObject(objectId: string) {\n    const object = Human.scene.objects[objectId];\n    if (object instanceof Human.scene.Object) {\n      object.clearColorModifiers();\n      object.clearOpacityModifiers(); \n    }\n  }\n\n  unpaint(node: ViewTreeNode) {\n    // relay color mods to each engine leaf\n    const viewGraph = this.store.selectSnapshot(EngineState.getViewGraph);\n    this.graphService.getLeafDescendants(viewGraph, node.id).forEach((id) => {\n      this.engineService.getObjects(id).forEach((humanObjectId: string) => {\n        const humanObject = Human.scene.objects[humanObjectId];\n        if (humanObject instanceof Human.scene.Object) {\n          // reset object mod properties\n          humanObject.clearColorModProperties();\n          humanObject.clearOpacityModProperties();\n        }\n      });\n    });\n  }\n\n  paint(objectId: string, recipe: ColorRecipeModel) {\n\n    // relay color mods to each engine leaf\n    const viewGraph = this.store.selectSnapshot(EngineState.getViewGraph);\n    const engineRecipe = ColorRecipeModel.toEngine(recipe);\n\n    this.graphService.getLeafDescendants(viewGraph, objectId).forEach((id) => {\n      this.engineService.getObjects(id).forEach((humanObjectId: string) => {\n        this.colorObject(humanObjectId, engineRecipe);\n      });\n    });\n  }\n\n  highlight(objectId: string, highlight: boolean) {\n    // allow un-highlight if highlight is disabled\n    if (this.highlightDisabled === false || highlight === false) { \n      // relay highlight to each engine leaf\n      const viewGraph = this.store.selectSnapshot(EngineState.getViewGraph);\n      this.graphService.getLeafDescendants(viewGraph, objectId).forEach((id) => {\n        this.engineService.getObjects(id).forEach((humanObjectId: string) => {\n          const humanObject = Human.scene.objects[humanObjectId];\n          if (humanObject instanceof Human.scene.Object) {\n            humanObject.setHighlight(highlight);\n          }\n        });\n      });\n    }\n  }\n\n  xRay(node: ViewTreeNode, xRay: boolean) {\n    const object = Human.scene.objects[node.id];\n    object.setXRay(xRay);\n  }\n\n  paintAll(objectIds: ObjectId[], recipe: ColorRecipeModel) {\n    objectIds.forEach(id => this.paint(id, recipe));\n  }\n\n  unpaintAll(nodes: ViewTreeNode[]) {\n    nodes.forEach(node => {\n      this.unpaint(node);\n    });\n  }\n\n  highlightAll(objectIds: ObjectId[], highlight: boolean) {\n    objectIds.forEach(id => this.highlight(id, highlight));\n  }\n\n  disableHighlight() {\n    this.highlightDisabled = true;\n  }\n\n  enableHighlight() {\n    this.highlightDisabled = false;\n  }\n  \n  /**\n   * Sets the selected object's highlight color\n   * @param color RGB decimal values\n   */\n  setHighlightColor(color: [number, number, number]) {\n    Human.renderer.highlightColor = [...color];\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { EngineService } from './engine.service';\nimport { Observable, of, concat } from 'rxjs';\nimport { ChapterBackgroundColors } from '../story/models/chapter-background-colors.model';\nimport { Store } from '@ngxs/store';\nimport { ToggleLabels } from './state/engine.actions';\nimport { BackgroundModel } from './models/background.model';\nimport { ImageService } from '../shared/image.service';\nimport { flatMap, map, combineAll, catchError } from 'rxjs/operators';\nimport { LabelsService } from '../story/labels.service';\nimport { SnapshotConfig } from './models/snapshot-config.model';\n\ndeclare const Human: any;\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class SnapshotService {\n  constructor(\n    private engineService: EngineService,\n    private imageService: ImageService,\n    private labelsService: LabelsService,\n    private store: Store\n  ) { }\n\n  private localResize(width: number, height: number): [number, number] {\n    /*\n    Set the size of the container with css\n    Set the size of the canvas drawingbuffers via canvas width/height properties\n    */\n    const engineCanvas = Human.renderer.canvas.canvas;\n    const annotationCanvas = Human.renderer.canvas.annotationCanvas;\n    const container = engineCanvas.parentNode;\n\n    // original dimensions (container == 3D canvas == 2D canvas)\n    const originalWidth = container.clientWidth;\n    const originalHeight = container.clientHeight;\n\n    // set width on container and canvas\n    container.width = width;\n    container.height = height;\n    engineCanvas.width = width;\n    engineCanvas.height = height;\n    annotationCanvas.width = width;\n    annotationCanvas.height = height;\n    \n    // style the container to match the element dimensions\n    container.style.width = `${width}px`;\n    container.style.height = `${height}px`;\n\n    // Update the viewport\n    Human.renderer.canvas.init(); // or HACK set engine's canvas.width/height manually\n    Human.renderer.viewportDirty = true;\n    Human.renderer.camera.updateCanvas();\n    Human.renderer.postprocess.updateCanvas();\n    Human.renderer.draw.updateCanvas();\n\n    Human.renderer.viewportDirty = true;\n    Human.renderer.prepareFrame();\n    Human.renderer.forceRenderFrame();\n\n    return [originalWidth, originalHeight];\n  }\n\n  // snapshot when requested dimension fits inside of 3D canvas\n  private canvasToImage(canvas: HTMLCanvasElement, crop: 'original' | 'square' = 'original'): Observable<Blob> {\n    // calculate source width and height dimensions\n    const aspectRatio = canvas.width / canvas.height;\n    const engineCanvas = this.engineService.getCanvas();\n\n    // Calculate dimensions\n    let { width, height  } = engineCanvas;\n\n    // Calculate source offset\n    let offsetX = 0.5 * (engineCanvas.width - width);\n    let offsetY = 0;\n\n    // Optionally crop image\n    switch (crop) {\n      case 'square':\n        (height > width) ? height = width : width = height;\n        \n        offsetX = 0.5 * (engineCanvas.width - width);\n        offsetY = 0.5 * (engineCanvas.height - height);\n        break;\n      \n      case 'original':\n        width = aspectRatio * height;\n        break;\n    }\n    \n    // render 3D frame and transfer to thumbnail canvas\n    return new Observable((observer) => {\n      const thumbnailContext = canvas.getContext('2d');\n      Human.renderer.forceRenderFrame();\n      thumbnailContext.drawImage(engineCanvas, offsetX, offsetY, width, height, 0, 0, canvas.width, canvas.height);\n      observer.next();\n      observer.complete();\n    });\n }\n\n  // snapshot when requested dimension does NOT fit inside of 3D canvas (avoid pixelation)\n  private canvasToImageWithResize(thumbnailCanvas: HTMLCanvasElement): Observable<Blob> {\n    const humanCanvas = this.engineService.getCanvas();\n    humanCanvas.style.opacity = '0'; // hide while we do our resizing business. start of flash\n    this.store.dispatch(new ToggleLabels(false));\n\n    // resize 3D canvas\n    const [originalWidth, originalHeight] = this.localResize(thumbnailCanvas.width, thumbnailCanvas.height);\n    const thumbnailContext = thumbnailCanvas.getContext('2d');\n    \n    return new Observable((observer) => {\n      setTimeout(() => {\n\n        // force webgl render frame\n        Human.renderer.viewportDirty = true;\n        Human.renderer.prepareFrame();\n        Human.renderer.forceRenderFrame();\n\n        // draw webgl canvas to 2d canvas image\n        thumbnailContext.drawImage(humanCanvas, 0, 0, humanCanvas.width, humanCanvas.height);\n\n        // return the original size\n        this.localResize(originalWidth, originalHeight);\n        document.getElementById('theCanvas').style.opacity = '';\n        this.store.dispatch(new ToggleLabels(true));\n\n        observer.next();\n        observer.complete();\n      }, 10);\n\n    });\n  }\n\n  private drawRadialGradient(thumbnailCanvas: HTMLCanvasElement, background: ChapterBackgroundColors): void {\n    // convert to RGB colors\n    const colors255 = background.colors;\n    \n    // convert stop percentages into radius values on the canvas\n    const toRadius = (percentage: number, width: number, height: number) => {\n      const [x2, y2] = [Math.pow(width / 2, 2), Math.pow(height / 2, 2)];\n      return percentage / 100 * Math.pow(x2 + y2, 0.5);\n    };\n    const [radiusInner, radiusOuter] = background.colorStops.map((s) => toRadius(s, thumbnailCanvas.width, thumbnailCanvas.height));\n\n    // create gradient, fillstyle\n    const thumbnailContext = thumbnailCanvas.getContext('2d');\n    const [x0, y0] = [thumbnailCanvas.width / 2, thumbnailCanvas.height / 2];\n    const gradient = thumbnailContext.createRadialGradient(x0, y0, radiusInner, x0, y0, radiusOuter);\n    gradient.addColorStop(background.colorStops[0] / 100.0, `rgba(${colors255.slice(0, 4).join(',')})`);\n    gradient.addColorStop(background.colorStops[1] / 100.0, `rgba(${colors255.slice(4, 8).join(',')})`);\n    \n    // draw gradient\n    thumbnailContext.fillStyle = gradient;\n    thumbnailContext.fillRect(0, 0, thumbnailCanvas.width, thumbnailCanvas.height);\n  }\n\n  private drawLinearGradient(thumbnailCanvas: HTMLCanvasElement, background: ChapterBackgroundColors): void {\n    // convert to RGB colors\n    const colors255 = background.colors;\n\n    // create gradient, fillstyle\n    const thumbnailContext = thumbnailCanvas.getContext('2d');\n    const [x0, y0] = [thumbnailCanvas.width / 2, thumbnailCanvas.height / 2];\n    const gradient = thumbnailContext.createLinearGradient(x0, y0, x0, thumbnailCanvas.height);\n    gradient.addColorStop(background.colorStops[0] / 100.0, `rgba(${colors255.slice(0, 4).join(',')})`);\n    gradient.addColorStop(background.colorStops[1] / 100.0, `rgba(${colors255.slice(4, 8).join(',')})`);\n\n    // draw gradient\n    thumbnailContext.fillStyle = gradient;\n    thumbnailContext.fillRect(0, 0, thumbnailCanvas.width, thumbnailCanvas.height);\n  }\n\n  // takeSnapshot of canvas return an observable\n  takeSnapshot(\n    width: number,\n    height: number,\n    background: BackgroundModel,\n    layers: HTMLCanvasElement[],\n    includeLabels: boolean,\n    snapshotConfig: SnapshotConfig): Observable<Blob> {\n    /*\n    Create 2D canvas to serve as the thumbnail\n    Copy background data to thumbnail canvas\n    Copy 3D canvas to thumbnail canvas\n    */\n\n    // config\n    const { imageType, imageQuality, copyrightEnabled, crop } = snapshotConfig;\n\n    // Create 2D canvas on which to draw 3D context\n    const thumbnailCanvas = document.createElement('canvas');\n    thumbnailCanvas.width = width;\n    thumbnailCanvas.height = height;\n    \n\n    // Draw Background onto thumbnail canvas\n    if (background.gradientType === 'radial') {\n      this.drawRadialGradient(thumbnailCanvas, background);\n    } else if (background.gradientType === 'linear') {\n      this.drawLinearGradient(thumbnailCanvas, background);\n    }\n    \n    const engineCanvas = this.engineService.getCanvas();\n    const canvasResize = thumbnailCanvas.height > engineCanvas.height || thumbnailCanvas.width > engineCanvas.width;    \n\n    // composite a list of canvas elements to single image\n    const canvases$: Observable<HTMLCanvasElement>[] = [];\n\n    // Draw 3D canvas\n    const drawScene$ = (canvasResize ? \n      this.canvasToImageWithResize(thumbnailCanvas) : \n      this.canvasToImage(thumbnailCanvas, crop)\n    )\n    .pipe(map(() => thumbnailCanvas));\n    \n    canvases$.push(drawScene$);\n\n    // composite layers on top of 3D\n    const optionalLayers: HTMLCanvasElement[] = [];\n\n    // add layer: labels\n    const labelContainer = this.labelsService.getLabelContainer();\n    if (includeLabels && labelContainer) {\n      optionalLayers.push(labelContainer.nativeElement);\n    }\n\n    // add layers: optional user layers\n    optionalLayers.push(...layers);\n\n    // Draw optional layers\n    canvases$.push(\n      ...optionalLayers.map((layer) => {\n        // element as canvas\n        const canvas$ = layer instanceof HTMLCanvasElement\n          ? of(layer) // use raw canvas\n          : this.imageService.elementToCanvas(layer, true); // convert to canvas\n        return canvas$\n          .pipe(\n            flatMap((elementCanvas) => this.imageService.fitCanvas(elementCanvas, { width, height })) // scale to target\n          );\n      })\n    );\n\n    // sequentially render + composite canvas elements\n    return concat(canvases$)\n      .pipe(\n        // gather canvas elements\n        combineAll(),\n        // merge canvas elements\n        map((canvases) => this.imageService.combineCanvasElements(canvases)),\n        // add logo: optional\n        flatMap((canvas) => copyrightEnabled ? this.writeLogoToCanvas(canvas, snapshotConfig) : of(canvas)),\n        // to data blob\n        flatMap((compositeCanvas) => this.imageService.canvasToBlob(compositeCanvas, imageType, imageQuality))\n      );\n  }\n\n  writeLogoToCanvas(canvas: HTMLCanvasElement, config: SnapshotConfig): Observable<HTMLCanvasElement> {\n    return this.getLogoImage(config.copyrightImagePath) // get logo\n      .pipe(\n        // write image to canvas\n        map((image) => {\n          // Get image and canvas size\n          let { width: logoWidth, height: logoHeight } = image;\n          const { width: canvasWidth, height: canvasHeight } = canvas;\n\n          // Rescale logo when it exceeds the minimum\n          if (0.1 * canvasWidth > logoWidth) {\n            const logoRatio = logoHeight / logoWidth;\n\n            logoWidth = 0.1 * canvasWidth;\n            logoHeight = logoRatio * logoWidth;\n          }\n\n          // calculate position\n          const { xOffset, yOffset } = this.getLogoPosition(canvasWidth, canvasHeight, logoWidth, logoHeight, config);\n\n          // write image\n          const canvasContext = canvas.getContext('2d');\n          canvasContext.drawImage(image, xOffset, yOffset, logoWidth, logoHeight);\n\n          return canvas;\n        }),\n        // handle errors\n        catchError(() => of(canvas))\n      );\n  }\n\n  getLogoImage(path: string): Observable<HTMLImageElement> {\n    return new Observable<HTMLImageElement>((observer) => {\n      const image = new Image();\n\n      image.onload = () => {\n        observer.next(image);\n        observer.complete();\n      };\n      image.onerror = () => observer.error();\n      image.src = path;\n    });\n  }\n\n  getLogoPosition(\n    viewWidth: number, viewHeight: number, imageWidth: number, imageHeight: number, config: SnapshotConfig): { xOffset: number, yOffset: number } {\n    const { copyrightPosition, copyrightOffset } = config;\n\n    let xPosition: number;\n    let yPosition: number;\n\n    // Calc X\n    switch (copyrightPosition.x) {\n      case 'right':\n        xPosition = viewWidth - imageWidth;\n        break;\n      case 'center':\n        xPosition = (viewWidth / 2) - (imageWidth / 2);\n        break;\n      default:\n        xPosition = 0;\n        break;\n    }\n\n    // Calc Y\n    switch (copyrightPosition.y) {\n      case 'bottom':\n        yPosition = viewHeight - imageHeight;\n        break;\n      case 'center':\n        yPosition = (viewHeight / 2) - (imageHeight / 2);\n        break;\n      default:\n        yPosition = 0;\n        break;\n    }\n\n    // offset w/ config\n    return {\n      xOffset: xPosition + copyrightOffset.x,\n      yOffset: yPosition + copyrightOffset.y\n    };\n  }\n\n}\n","import { EngineCameraStateModel } from './engine.camera.state.model';\nimport { SetCameraFlyTo } from './engine.camera.actions';\n\ndeclare const immer;\n\nexport function calcCameraFlyToState(\n  state: EngineCameraStateModel,\n  action: SetCameraFlyTo\n) {\n  const [nextState, patches, inversePatches] = immer.produceWithPatches(\n    state,\n    (draft: EngineCameraStateModel) => {\n      draft.cameraFlyTo = action.camera;\n    }\n  );\n\n  return {\n    nextState,\n    patches,\n    inversePatches,\n  };\n}\n","import { CameraModel } from 'src/app/engine/models/camera.model';\nimport { CameraMotionModel } from '../../models/camera-motion.model';\nimport { EngineCameraStateModel } from './engine.camera.state.model';\nimport { Patch } from 'src/vendor/immer-6.0.9/compat/pre-3.7/dist/immer';\n\nexport class ClearCamera {\n  static readonly type = '[Engine Camera] Clear Camera';\n  constructor(public id: string) { }\n}\n\nexport class StoreCamera {\n  static readonly type = '[Engine Camera] Store Camera';\n  constructor(public id: string, public camera?: CameraModel) { }\n}\n\nexport class SetCamera {\n  static readonly type = '[Engine Camera] Set Camera';\n  constructor(public camera: CameraModel, public animate: boolean = true, public animationDuration?: number) {}\n}\n\nexport class SetCameraSuccess {\n  static readonly type = '[Engine Camera] Set Camera Success';\n  constructor() {}\n}\n\nexport class MoveCamera {\n  static readonly type = '[Engine Camera] Move Camera';\n  constructor(public cameraMotion: CameraMotionModel) { }\n}\n\nexport class ResetCamera {\n  static readonly type = '[Engine Camera] Reset Camera';\n  constructor() { }\n}\n\nexport class ZoomCamera {\n  static readonly type = '[Engine Camera] Zoom Camera';\n  constructor(public value: number) { }\n}\n\nexport class ZoomCameraStatic {\n  static readonly type = '[Engine Camera] Zoom Camera Static';\n  constructor(public value: number) { }\n}\n\nexport class PanCameraX {\n  static readonly type = '[Engine Camera] Pan Camera X';\n  constructor(public value: number) { }\n}\n\nexport class PanCameraY {\n  static readonly type = '[Engine Camera] Pan Camera Y';\n  constructor(public value: number) { }\n}\n\nexport class PanCameraStatic {\n  static readonly type = '[Engine Camera] Pan Camera Static';\n  constructor(public x: number, public y: number, public z: number) {}\n}\n\nexport class RotateCameraX {\n  static readonly type = '[Engine Camera] Rotate Camera X';\n  constructor(public value: number) { }\n}\n\nexport class RotateCameraY {\n  static readonly type = '[Engine Camera] Rotate Camera Y';\n  constructor(public value: number) { }\n}\n\nexport class RotateCameraStatic {\n  static readonly type = '[Engine Camera] Rotate Camera Static';\n  constructor(public x: number, public y: number) { }\n}\n\nexport class SetCameraMode {\n  static readonly type = '[Engine Camera] Set Camera Mode';\n  constructor(public mode: 'pan' | 'rotate') { }\n}\n\nexport class SetZoomed {\n  static readonly type = '[Engine Camera] Set Zoomed';\n  constructor(public zoomed: boolean) { }\n}\n\nexport class LockCamera {\n  static readonly type = '[Engine Camera] Lock camera';\n  constructor(public lock: boolean) { }\n}\nexport class SetCameraFlyTo {\n  static readonly type = '[Engine Camera] Set Camera Fly To';\n  constructor(public camera: CameraModel) { }\n}\n\nexport class ApplyCameraPatch {\n  static readonly type = '[Engine Camera] Patch Camera State';\n  constructor(public patches: Patch[]) { }\n}\n","import { CameraModel } from 'src/app/engine/models/camera.model';\nimport { CameraMotionModel } from '../../models/camera-motion.model';\n\nexport class EngineCameraStateModel {\n    storedCameras: { [key: string]: CameraModel };\n    cameraMotion: CameraMotionModel;\n    panMode: string;\n    zoomed: boolean;\n    lockCamera: boolean;\n    cameraFlyTo: CameraModel;\n}\n","import {\n  State,\n  Action,\n  StateContext,\n  Selector,\n  createSelector,\n  Store\n} from '@ngxs/store';\nimport { EngineCameraStateModel } from './engine.camera.state.model';\nimport {\n  StoreCamera,\n  ClearCamera,\n  MoveCamera,\n  ZoomCamera,\n  PanCameraX,\n  RotateCameraX,\n  PanCameraY,\n  RotateCameraY,\n  SetCameraMode,\n  SetZoomed,\n  LockCamera,\n  ResetCamera,\n  ApplyCameraPatch,\n  SetCameraFlyTo,\n  SetCamera\n} from './engine.camera.actions';\nimport { CameraService } from '../../camera.service';\nimport { CameraMotionModel } from '../../models/camera-motion.model';\nimport { tap } from 'rxjs/operators';\nimport { StoryChaptersState } from 'src/app/story/state/chapters/story.chapters.state';\nimport { CameraModel } from '../../models/camera.model';\nimport { FlyToObject } from '../engine.actions';\n\ndeclare const immer;\ndeclare const Human;\n\nconst engineCameraStateDefaults: EngineCameraStateModel = {\n  storedCameras: {},\n  cameraMotion: new CameraMotionModel(),\n  panMode: 'rotate',\n  zoomed: false,\n  lockCamera: false,\n  cameraFlyTo: undefined\n};\n\n@State<EngineCameraStateModel>({\n  name: 'engineCamera',\n  defaults: engineCameraStateDefaults\n})\nexport class EngineCameraState {\n  /**\n   * Selectors\n   */\n  static getStoredCamera(id: string) {\n    return createSelector(\n      [EngineCameraState],\n      (state: EngineCameraStateModel) => {\n        return state.storedCameras[id] || null;\n      }\n    );\n  }\n\n  @Selector()\n  static getCameraMotion(state: EngineCameraStateModel) {\n    return state.cameraMotion;\n  }\n\n  @Selector()\n  static getPanMode(state: EngineCameraStateModel) {\n    return state.panMode;\n  }\n\n  @Selector()\n  static getZoomed(state: EngineCameraStateModel) {\n    return state.zoomed;\n  }\n\n  @Selector()\n  static getLockCamera(state: EngineCameraStateModel) {\n    return state.lockCamera;\n  }\n\n  /**\n   * Actions\n   */\n\n  @Action(StoreCamera)\n  storeCamera(context: StateContext<EngineCameraStateModel>, action: StoreCamera) {\n    const camera = action.camera || this.cameraService.getCamera();\n    const storedCameras = context.getState().storedCameras;\n\n    storedCameras[action.id] = { ...camera };\n\n    context.patchState({\n      storedCameras: { ...storedCameras }\n    });\n  }\n\n  @Action(ClearCamera)\n  clearCamera(\n    context: StateContext<EngineCameraStateModel>,\n    action: ClearCamera\n  ) {\n    const storedCameras = context.getState().storedCameras;\n    delete storedCameras[action.id];\n\n    context.patchState({\n      storedCameras: { ...storedCameras }\n    });\n  }\n\n  @Action(SetCameraFlyTo)\n  setCameraFlyTo(context: StateContext<EngineCameraStateModel>, action: SetCameraFlyTo) {\n    context.patchState(immer.produce(context.getState(), draft => {\n      draft.cameraFlyTo = action.camera;\n    }));\n  }\n\n  @Action(ApplyCameraPatch)\n  applyCameraPatch(context: StateContext<EngineCameraStateModel>, action: ApplyCameraPatch) {\n    const nextState: EngineCameraStateModel = immer.applyPatches(context.getState(), action.patches);\n    context.patchState(nextState);\n\n    const camera =\n      nextState.cameraFlyTo === undefined\n        ? this.store.selectSnapshot(StoryChaptersState.getChapterCamera)\n        : nextState.cameraFlyTo;\n      \n    context.dispatch(new SetCamera(camera, true, 1.0));\n  }\n\n  @Action(MoveCamera)\n  moveCamera(\n    context: StateContext<EngineCameraStateModel>,\n    action: MoveCamera\n  ) {\n    context.patchState({\n      cameraMotion: { ...action.cameraMotion }\n    });\n  }\n\n  @Action(ResetCamera)\n  resetCamera(\n    context: StateContext<EngineCameraStateModel>,\n    action: ResetCamera\n  ) {\n    return this.cameraService.resetCamera().pipe(\n      tap(() => {\n        context.patchState({\n          cameraMotion: new CameraMotionModel()\n        });\n      })\n    );\n  }\n\n  @Action(ZoomCamera)\n  zoomCamera(\n    context: StateContext<EngineCameraStateModel>,\n    action: ZoomCamera\n  ) {\n    const { cameraMotion } = context.getState();\n    cameraMotion.zoom = action.value;\n\n    context.patchState({\n      cameraMotion: { ...cameraMotion }\n    });\n  }\n\n  @Action(PanCameraX)\n  panCameraX(\n    context: StateContext<EngineCameraStateModel>,\n    action: PanCameraX\n  ) {\n    const { cameraMotion } = context.getState();\n    cameraMotion.panX = action.value;\n\n    context.patchState({\n      cameraMotion: { ...cameraMotion }\n    });\n  }\n\n  @Action(PanCameraY)\n  panCameraY(\n    context: StateContext<EngineCameraStateModel>,\n    action: PanCameraY\n  ) {\n    const { cameraMotion } = context.getState();\n    cameraMotion.panY = action.value;\n\n    context.patchState({\n      cameraMotion: { ...cameraMotion }\n    });\n  }\n\n  @Action(RotateCameraX)\n  rotateCameraX(\n    context: StateContext<EngineCameraStateModel>,\n    action: RotateCameraX\n  ) {\n    const { cameraMotion } = context.getState();\n    // cameraMotion.rotateX = action.value;\n\n    context.patchState({\n      cameraMotion: { ...cameraMotion, rotateX: action.value }\n    });\n  }\n\n  @Action(RotateCameraY)\n  rotateCameraY(\n    context: StateContext<EngineCameraStateModel>,\n    action: RotateCameraY\n  ) {\n    const { cameraMotion } = context.getState();\n    cameraMotion.rotateY = action.value;\n\n    context.patchState({\n      cameraMotion: { ...cameraMotion }\n    });\n  }\n\n  @Action(SetCameraMode)\n  SetCameraMode(\n    context: StateContext<EngineCameraStateModel>,\n    action: SetCameraMode\n  ) {\n    context.patchState({\n      panMode: action.mode\n    });\n  }\n\n  @Action(SetZoomed)\n  setZoomed(context: StateContext<EngineCameraStateModel>, action: SetZoomed) {\n    context.patchState({\n      zoomed: action.zoomed\n    });\n  }\n\n  @Action(LockCamera)\n  lockCamera(\n    context: StateContext<EngineCameraStateModel>,\n    action: LockCamera\n  ) {\n    context.patchState({\n      lockCamera: action.lock\n    });\n  }\n\n  constructor(\n    private cameraService: CameraService,\n    private store: Store\n  ) {}\n}\n","import { BdGraph, BdGraphStateMap } from '../../../lib/graph/graph.model';\nimport { EnginePositionModel } from '../models/engine-position.model';\nimport { ViewTreeNode } from '../models/view.tree-node';\nimport { HitModel } from '../models/hit.model';\nimport { ChapterInitModel } from '../models/engine-chapter-init-model';\nimport { ToolEnum } from '../models/tool.enum';\nimport { ScrollModeEnum } from '../models/scroll-mode.enum';\nimport { ColorRecipeModel } from 'src/app/edit/models/color-recipe.model';\nimport { TransitionModel } from 'src/app/story/models/transition.model';\nimport { PostProcessingEffect } from '../models/post-processing/effects';\nimport { TransparencyModeEnum } from '../models/post-processing/transparency-mode.enum';\nimport { ObjectId, NodeState } from './nodes/engine.nodes.state.model';\nimport { EngineColorRecipeModel } from 'src/app/edit/models/engine-color-recipe.model';\nimport { ChapterModel } from 'src/app/story/models/chapter.model';\n\nexport class Load {\n  static readonly type = '[Engine] Load';\n  constructor() { }\n}\n\nexport class LoadSuccess {\n  static readonly type = '[Engine] Load Success';\n  constructor(public result: string) { }\n}\n\nexport class SetReady {\n  static readonly type = '[Engine] Set Ready';\n  constructor(public ready: boolean) { }\n}\n\nexport class SetDisplay {\n  static readonly type = '[Engine] Set Display of 3D Scene';\n  constructor(public display: boolean) { }\n}\n\nexport class SetScrollMode {\n  static readonly type = '[Engine] Set Zoom via scroll Allowed';\n  constructor(public scrollMode: ScrollModeEnum) { }\n}\n\nexport class ShowScrollAlert {\n  static readonly type = '[Engine] Set Scroll Alert Shwon';\n  constructor(public shown: boolean) { }\n}\n\nexport class SetVisible {\n  static readonly type = '[Engine] Set Visibility of 3D Scene';\n  constructor(public visible: boolean) { }\n}\n\nexport class Fade {\n  static readonly type = '[Engine] Fade';\n  constructor(public color: string, public duration: number) { }\n}\n\nexport class FadeComplete {\n  static readonly type = '[Engine] Fade Complete';\n  constructor() { }\n}\n\nexport class FadeOut {\n  static readonly type = '[Engine] Fade Out';\n  constructor() { }\n}\n\n\n/**\n * Scene Handling\n */\nexport class SetGraph {\n  static readonly type = '[Engine] Set Graph';\n  constructor(public graph: BdGraph<ViewTreeNode>) { }\n}\n\nexport class ClearGraph {\n  static readonly type = '[Engine] Clear Graph';\n  constructor() { }\n}\n\nexport class SetXrayMode {\n  static readonly type = '[Engine] Set Xray Mode';\n  constructor(public enabled: boolean) { }\n}\n\nexport class SetEngineChapter {\n  static readonly type = '[Engine] Set Engine Chapter';\n  constructor(public chapterId: string) { }\n}\n\nexport class SetEngineChapterInit {\n  static readonly type = '[Eninge] Set Chapter Init';\n  constructor(public chapterInit: ChapterInitModel) {}\n}\n\nexport class ClickNode {\n  static readonly type = '[Engine] Click Node';\n  constructor(public node: ViewTreeNode, public event: HammerInput, public hit?: HitModel) {}\n}\n\nexport class RightClickNode {\n  static readonly type = '[Engine] Right Click Node';\n  constructor(public node: ViewTreeNode, public event: Event, public hit?: HitModel) {}\n}\n\nexport class SetContextMenu {\n  static readonly type = '[Engine] Set Contextmenu';\n  constructor(public node: ViewTreeNode, public hit?: HitModel) {}\n}\n\nexport class FlyToObject {\n  static readonly type = '[Engine] Fly To Object';\n  constructor(public objectId: string, public animate: boolean = true, public animationDuration?: number) {}\n}\n\nexport class CenterCameraOnVisible {\n  static readonly type = '[Engine] Center Camera on Visible Nodes';\n  constructor() {}\n}\n\nexport class SynchronizeVisibleNodes {\n  static readonly type = '[Engine] Synchronize Visible Nodes On Tree';\n  constructor(public leafVisibilityState: BdGraphStateMap, public nodes: Record<ObjectId, NodeState>) {}\n}\n\nexport class SynchronizeRenderableNodes {\n  static readonly type = '[Engine] Synchronize Renderable State of Nodes On Tree';\n  constructor(public leafRenderableState: BdGraphStateMap) {}\n}\n\nexport class SynchronizePickableNodes {\n  static readonly type = '[Engine] Synchronize Pickable State of Nodes On Tree';\n  constructor(public leafPickableState: BdGraphStateMap, public nodes: Record<ObjectId, NodeState>) {}\n}\n\nexport class Hit {\n  static readonly type = '[Engine] Hit';\n  constructor(public hit: HitModel) { }\n}\n\nexport class ToggleCameraBar {\n  static readonly type = '[Engine] Toggle Camera Bar';\n  constructor(public show: boolean) { }\n}\n\nexport class ToggleProgressBar {\n  static readonly type = '[Engine] Toggle Progress Bar';\n  constructor(public show: boolean) { }\n}\n\nexport class ToggleLabels {\n  static readonly type = '[Engine] Toggle Labels';\n  constructor(public show?: boolean) { }\n}\n\nexport class SetActiveTool {\n  static readonly type = '[Engine] Set active tool';\n  constructor(public tool: ToolEnum) { }\n}\n\nexport class PlayChapterAnimation {\n  static readonly type = '[Engine] Play chapter animation';\n  constructor(public chapter: ChapterModel, public pause?: boolean) { }\n}\nexport class ToggleAnimation {\n  static readonly type = '[Engine] Play animation';\n  constructor(public play = true) { }\n}\n\nexport class SetAnimationPlaying {\n  static readonly type = '[Engine] Set animation playing';\n  constructor(public playing) { }\n}\n\nexport class PlayAudio {\n  static readonly type = '[Engine] Play audio';\n  constructor(public play: boolean) { }\n}\n\nexport class PlayChapterFromStart {\n  static readonly type = '[Engine] Play chapter from start';\n  constructor() { }\n}\n\nexport class SetAutoplay {\n  static readonly type = '[Engine] Set autoplay';\n  constructor(public enable: boolean) { }\n}\n\nexport class SetObjectLayerOrder {\n  static readonly type = '[Engine] Set object layer order';\n  constructor(public nodes: ViewTreeNode[], public layer: number) {}\n}\n\nexport class SetObjectDisplayName {\n  static readonly type = '[Engine] Set object display name';\n  constructor(public nodeId: string, public displayName: string) {}\n}\n\nexport class AutoSortObjectLayers {\n  static readonly type = '[Engine] Auto Sort object layer orders';\n  constructor() {}\n}\n\nexport class ResetObjectLayers {\n  static readonly type = '[Engine] Reset object layer orders';\n  constructor() {}\n}\n\n\n\n/**\n * Canvas element references\n */\nexport class SetEnginePosition {\n  static readonly type = '[Engine] Set Engine Position';\n  constructor(public position: EnginePositionModel) { }\n}\n\nexport class ResetEnginePosition {\n  static readonly type = '[Engine] Reset Engine Position';\n  constructor() { }\n}\n\nexport class ResetEngineInteractions {\n  static readonly type = '[Engine] Reset Interactions';\n  constructor() { }\n}\n\n// Post Processing\nexport class SetPostProcessingEffects {\n  static readonly type = '[Engine] Set Post Processing Effects';\n  constructor(public effects: PostProcessingEffect[]) { }\n}\n\nexport class SetProperties {\n  static readonly type = '[Engine] Set Properties';\n  constructor(public properties: { [key: string]: any; }) { }\n}\n\nexport class SetTransparencyMode {\n  static readonly type = '[Engine] Set Transparency Mode';\n  constructor(public mode: TransparencyModeEnum) { }\n}\n\nexport class ExpandViewTreeNode {\n  static readonly type = '[Engine] Expand ViewTree Node';\n  constructor(public node: ViewTreeNode) {}\n}\n\nexport class CollapseViewTreeNode {\n  static readonly type = '[Engine] Collapse ViewTree Node';\n  constructor(public node: ViewTreeNode) {}\n}\n\nexport class HoverNode {\n  static readonly type = '[Engine] Hover Node';\n  constructor(public node: ViewTreeNode, public hit?: HitModel) {}\n}\n\nexport class SetLabelEditNode {\n  static readonly type = '[Engine] Set Label Edit Node';\n  constructor(public node: ViewTreeNode) {}\n}\n\nexport class SetNodeInfo {\n  static readonly type = '[Engine] Set Node Info';\n  constructor(public node: ViewTreeNode, public description: string) {}\n}\n\nexport class QueryNodeInfo {\n  static readonly type = '[Engine] Query Node Info';\n  constructor(public node: ViewTreeNode) {}\n}\n\nexport class QueryNodeInfoSuccess {\n  static readonly type = '[Engine] Query Node Info Success';\n  constructor(public node: ViewTreeNode, public description: string) {}\n}\n\nexport class QueryNodeInfoFailure {\n  static readonly type = '[Engine Nodes] Query Node Info Failure';\n  constructor(public node: ViewTreeNode) {}\n}\n","import { EnginePositionModel } from '../models/engine-position.model';\nimport { BdGraph } from '../../../lib/graph/graph.model';\nimport { ViewTreeNode } from '../models/view.tree-node';\nimport { ChapterInitModel } from '../models/engine-chapter-init-model';\nimport { ToolEnum } from '../models/tool.enum';\nimport { ScrollModeEnum } from '../models/scroll-mode.enum';\nimport { HitModel } from '../models/hit.model';\n\nexport class EngineStateModel {\n    loading: boolean;\n    engine: string;\n    ready: boolean;\n\n    viewGraph: BdGraph<ViewTreeNode>;\n    hoveredNode: ViewTreeNode;\n    labelEditNode: ViewTreeNode;\n    contextmenu: {\n        node: ViewTreeNode,\n        hit: HitModel\n    };\n\n    queryingWiki: boolean;\n\n    chapter: string;\n    chapterInit: ChapterInitModel;\n\n    enginePosition?: EnginePositionModel;\n\n    showCameraBar: boolean;\n    showProgressBar: boolean;\n    showLabels: boolean;\n\n    activeTool: ToolEnum;\n    display: boolean;\n    visible: boolean;\n    animationPlaying: boolean;\n    autoplay: boolean;\n    playAudio: boolean;\n    scrollMode: ScrollModeEnum;\n\n    // xray mode support\n    xrayModeEnabled: boolean;\n}\n","import { State, Action, StateContext, Selector, Store, Actions, ofActionDispatched } from '@ngxs/store';\nimport { EngineStateModel } from './engine.state.model';\nimport {\n  Load,\n  LoadSuccess,\n  SetReady,\n  SetGraph,\n  SetEngineChapter,\n  SetEnginePosition,\n  SetEngineChapterInit,\n  SynchronizeVisibleNodes,\n  ClearGraph,\n  ResetEnginePosition,\n  ToggleCameraBar,\n  ToggleLabels,\n  SetActiveTool,\n  ToggleAnimation,\n  CenterCameraOnVisible,\n  SetDisplay,\n  SetVisible,\n  SynchronizeRenderableNodes,\n  SynchronizePickableNodes,\n  SetScrollMode,\n  SetXrayMode,\n  SetAutoplay,\n  SetObjectLayerOrder,\n  AutoSortObjectLayers,\n  ResetObjectLayers,\n  SetObjectDisplayName,\n  SetPostProcessingEffects,\n  SetProperties,\n  SetTransparencyMode,\n  ExpandViewTreeNode,\n  CollapseViewTreeNode,\n  HoverNode,\n  SetLabelEditNode,\n  QueryNodeInfo,\n  QueryNodeInfoSuccess,\n  SetNodeInfo,\n  QueryNodeInfoFailure,\n  PlayAudio,\n  ToggleProgressBar,\n  PlayChapterAnimation,\n  SetAnimationPlaying,\n  SetContextMenu\n} from './engine.actions';\nimport { BdGraphService } from '../../../lib/graph/graph.service';\nimport { ViewTreeNode } from '../models/view.tree-node';\nimport { EngineService } from '../engine.service';\nimport { BdGraph, BdGraphStateMap, BdGraphFactory } from 'src/lib/graph/graph.model';\nimport { EnginePositionModel } from '../models/engine-position.model';\nimport { EngineVisibilityEnum } from '../models/engine-visibility.enum';\nimport { EngineCameraState } from './camera/engine.camera.state';\nimport { ToolEnum } from '../models/tool.enum';\nimport { ScrollModeEnum } from '../models/scroll-mode.enum';\nimport { finalize } from 'rxjs/operators';\nimport { WikiService } from 'src/app/shared/wiki.service';\nimport { GraphUtils } from 'src/lib/graph/graph-utils';\nimport { StoryChaptersState } from 'src/app/story/state/chapters/story.chapters.state';\nimport { get } from 'lodash';\nimport { AnimationService } from '../animation.service';\n\ndeclare const Human: any;\n\nconst enginePositionDefaults = new EnginePositionModel(0, 0, 0, 0, EngineVisibilityEnum.Hidden);\n\n\n@State<EngineStateModel>({\n  name: 'engine',\n  defaults: {\n    loading: false,\n    ready: false,\n    viewGraph: BdGraphFactory<ViewTreeNode>(),\n    hoveredNode: undefined,\n    labelEditNode: undefined,\n    queryingWiki: false,\n    engine: '',\n    chapter: '',\n    chapterInit: {\n      id: '',\n      init: false,\n      camera: false,\n      annotations: false,\n      graph: false,\n      properties: false,\n      particles: false,\n      clips: false,\n      postprocessing: false,\n      transparency: false\n    },\n    showProgressBar: true,\n    showCameraBar: true,\n    showLabels: true,\n    activeTool: ToolEnum.Select,\n    animationPlaying: true,\n    autoplay: true,\n    playAudio: false,\n    display: true,\n    visible: true,\n    scrollMode: ScrollModeEnum.Capture,\n    xrayModeEnabled: false,\n    contextmenu: {\n      node: null,\n      hit: null\n    }\n  },\n  children: [\n    EngineCameraState\n  ]\n})\nexport class EngineState {\n  /**\n   * Selectors\n   */\n  @Selector()\n  static getEngine(state: EngineStateModel) {\n    return state.engine;\n  }\n\n  @Selector()\n  static getReady(state: EngineStateModel) {\n    return state.ready;\n  }\n\n  @Selector()\n  static getDisplay(state: EngineStateModel) {\n    return state.display;\n  }\n\n  @Selector()\n  static getScrollMode(state: EngineStateModel) {\n    return state.scrollMode;\n  }\n\n  @Selector()\n  static getVisible(state: EngineStateModel) {\n    return state.visible;\n  }\n\n  @Selector()\n  static getViewGraph(state: EngineStateModel) {\n    return state.viewGraph;\n  }\n\n  @Selector()\n  static getViewGraphNode(state: EngineStateModel) {\n    return (objectId: string) => {\n      return state.viewGraph.nodes[objectId];\n    };\n  }\n\n\n  @Selector()\n  static getEnginePosition(state: EngineStateModel) {\n    return state.enginePosition;\n  }\n\n  @Selector()\n  static getChapter(state: EngineStateModel) {\n    return state.chapter;\n  }\n\n  @Selector()\n  static getActiveTool(state: EngineStateModel) {\n    return state.activeTool;\n  }\n\n  @Selector()\n  static getShowCameraBar(state: EngineStateModel) {\n    return state.showCameraBar;\n  }\n\n  @Selector()\n  static getShowProgressBar(state: EngineStateModel) {\n    return state.showProgressBar;\n  }\n\n  @Selector()\n  static getShowLabels(state: EngineStateModel) {\n    return state.showLabels;\n  }\n\n  @Selector()\n  static getChapterInit(state: EngineStateModel) {\n    return state.chapterInit;\n  }\n\n  @Selector()\n  static getAnimationPlaying(state: EngineStateModel) {\n    return state.animationPlaying;\n  }\n\n  @Selector()\n  static getPlayAudio(state: EngineStateModel) {\n    return state.playAudio;\n  }\n\n  @Selector()\n  static getAutoplay(state: EngineStateModel) {\n    return state.autoplay;\n  }\n\n  @Selector()\n  static getXrayModeEnabled(state: EngineStateModel) {\n    return state.xrayModeEnabled;\n  }\n\n  @Selector()\n  static getHoveredNode(state: EngineStateModel) {\n    return state.hoveredNode;\n  }\n\n  @Selector()\n  static getLabelEditNode(state: EngineStateModel) {\n    return state.labelEditNode;\n  }\n\n  @Selector()\n  static getQuerying(state: EngineStateModel) {\n    return state.queryingWiki;\n  }\n\n  @Selector()\n  static getContextmenu(state: EngineStateModel) {\n    return state.contextmenu;\n  }\n\n  /**\n   * Actions\n   */\n  @Action(Load)\n  load(context: StateContext<EngineStateModel>, action: Load) {\n    context.dispatch(new LoadSuccess('engine'));\n  }\n\n  @Action(LoadSuccess)\n  loadSuccess({ patchState }: StateContext<EngineStateModel>, action: LoadSuccess) {\n    patchState({\n      engine: action.result\n    });\n  }\n\n  @Action(SetReady)\n  setReady(context: StateContext<EngineStateModel>, action: SetReady) {\n    context.patchState({\n      ready: action.ready\n    });\n  }\n\n  @Action(SetDisplay)\n  setDisplay(context: StateContext<EngineStateModel>, action: SetDisplay) {\n    context.patchState({\n      display: action.display\n    });\n  }\n\n  @Action(SetScrollMode)\n  setZoomViaScrollAllowed(context: StateContext<EngineStateModel>, action: SetScrollMode) {\n    context.patchState({\n      scrollMode: action.scrollMode\n    });\n  }\n\n  @Action(SetVisible)\n  setVisible(context: StateContext<EngineStateModel>, action: SetVisible) {\n    context.patchState({\n      visible: action.visible\n    });\n  }\n\n  @Action(SetEnginePosition)\n  setEnginePosition(context: StateContext<EngineStateModel>, action: SetEnginePosition) {\n    context.patchState({\n      enginePosition: {\n        ...action.position,\n        right: action.position.left + action.position.width,\n        bottom: action.position.top + action.position.height\n      }\n    });\n  }\n\n  @Action(ResetEnginePosition)\n  resetEnginePosition(context: StateContext<EngineStateModel>, action: ResetEnginePosition) {\n    context.patchState({\n      enginePosition: enginePositionDefaults\n    });\n  }\n\n  @Action(SetEngineChapter)\n  setChapter(context: StateContext<EngineStateModel>, action: SetEngineChapter) {\n    context.patchState({\n      chapter: action.chapterId\n    });\n  }\n\n  @Action(SetEngineChapterInit)\n  setChapterInit(context: StateContext<EngineStateModel>, action: SetEngineChapterInit) {\n    context.patchState({\n      chapterInit: action.chapterInit\n    });\n  }\n\n  @Action(SetActiveTool)\n  setActiveTool(context: StateContext<EngineStateModel>, action: SetActiveTool) {\n    context.patchState({\n      activeTool: action.tool\n    });\n  }\n\n  /**\n   * Graph Actions #TODO: Move into own state\n   */\n  @Action(SetGraph)\n  setGraph(context: StateContext<EngineStateModel>, action: SetGraph) {\n    // Set graph state\n    context.patchState({\n      viewGraph: {...action.graph}\n    });\n  }\n\n  @Action(ClearGraph)\n  clearGraph(context: StateContext<EngineStateModel>, action: SetGraph) {\n    context.patchState({\n      viewGraph: BdGraphFactory<ViewTreeNode>()\n    });\n  }\n\n  @Action(SetXrayMode)\n  setXrayMode(context: StateContext<EngineStateModel>, action: SetXrayMode) {\n    context.patchState({\n      xrayModeEnabled: action.enabled\n    });\n  }\n\n  @Action(CenterCameraOnVisible)\n  centerCameraOnVisible(context: StateContext<EngineStateModel>, action: CenterCameraOnVisible) {\n    const visibleLeaves = this.engineService.getVisibleLeaves();\n    const boundary = this.engineService.getBoundaryFromObjects(visibleLeaves);\n    const lookAt = this.engineService.getCameraLookAt();\n    lookAt.look = {\n      x: (boundary.xmin + boundary.xmax) / 2.0,\n      y: (boundary.ymin + boundary.ymax) / 2.0,\n      z: (boundary.zmin + boundary.zmax) / 2.0\n    };\n    Human.renderer.camera.fly.flyTo(lookAt);\n  }\n\n  @Action(ToggleProgressBar)\n  toggleProgressBar(context: StateContext<EngineStateModel>, action: ToggleProgressBar) {\n    context.patchState({\n      showProgressBar: action.show\n    });\n  }\n\n  @Action(ToggleCameraBar)\n  toggleCameraBar(context: StateContext<EngineStateModel>, action: ToggleCameraBar) {\n    context.patchState({\n      showCameraBar: action.show\n    });\n  }\n\n  @Action(ToggleLabels)\n  toggleLabels(context: StateContext<EngineStateModel>, action: ToggleLabels) {\n    const show = (action.show != null) ? action.show : !context.getState().showLabels;\n\n    context.patchState({\n      showLabels: show\n    });\n  }\n\n  @Action(SynchronizeVisibleNodes)\n  synchronizeVisibleNodes(context: StateContext<EngineStateModel>, action: SynchronizeVisibleNodes) {\n    const viewGraph = context.getState().viewGraph;\n    const leafViewNodeIds = this.stateMapToNodeIds(viewGraph, action.leafVisibilityState);\n\n    // set unique view node leaf state by querying corresponding human object state\n    const leafState = {};\n    leafViewNodeIds.forEach(viewNodeId => {\n      const leafids = this.engineService.getLeafObjects(viewNodeId);\n      const visibility = leafids.reduce((vis, objectId) => vis || action.nodes[objectId].shown, false);\n      leafState[viewNodeId] = { 'shown': visibility };\n    });\n\n    this.graphService.synchronize({...viewGraph}, { 'shown': 'trueWins' }, leafState);\n\n    // patch the state\n    context.patchState({\n      viewGraph: { ...viewGraph }\n    });\n  }\n\n  @Action(SynchronizeRenderableNodes)\n  synchronizeRenderableNodes(context: StateContext<EngineStateModel>, action: SynchronizeRenderableNodes) {\n    const viewGraph = context.getState().viewGraph;\n    const leafViewNodeIds = this.stateMapToNodeIds(viewGraph, action.leafRenderableState);\n\n    // view graph leaf state\n    const leafState = {};\n    leafViewNodeIds.forEach(leafId => {\n      leafState[leafId] = { 'renderable': true };\n    });\n    this.graphService.synchronize(viewGraph, { 'renderable': 'falseWins' }, leafState);\n  }\n\n  @Action(SynchronizePickableNodes)\n  synchronizePickableNodes(context: StateContext<EngineStateModel>, action: SynchronizePickableNodes) {\n    const viewGraph = context.getState().viewGraph;\n    const leafViewNodeIds = this.stateMapToNodeIds(viewGraph, action.leafPickableState);\n\n    // set unique view node leaf state by querying corresponding human object state\n    const leafState = {};\n    leafViewNodeIds.forEach(viewNodeId => {\n      const leafids = this.engineService.getLeafObjects(viewNodeId);\n      const pickable = leafids.reduce((pick, objectId) => pick || Human.scene.objects[objectId].pickable, false);\n\n      leafState[viewNodeId] = { 'pickable': pickable };\n    });\n    this.graphService.synchronize(viewGraph, { 'pickable': 'trueWins' }, leafState);\n\n    // patch the state\n    context.patchState({\n      viewGraph: { ...viewGraph }\n    });\n  }\n\n\n  // For animations\n  // Need to resolve unpause action triggering the next timeline\n  // This is because unpause is stupid in it's implementation\n  // Also need to resolve firing play() initially on chapter to ensure we load in the appropriate settings for loop\n\n  @Action(PlayChapterAnimation)\n  playChapterAnimation(context: StateContext<EngineStateModel>, action: PlayChapterAnimation) {\n    const chapter = this.store.selectSnapshot(StoryChaptersState.getSelectedChapter);\n    const playCount = get(chapter, 'ui.play.count', 0);\n\n    this.animationService.play({\n      startChapterId: chapter.id,\n      loop: (playCount === -1),\n      numChapters: 1,\n      queue: false // True for higher playcount\n    });\n    \n    const playing = context.getState().animationPlaying;\n    if (!playing) {\n      this.animationService.pause();\n    }\n  }\n\n  @Action(ToggleAnimation)\n  toggleAnimation(context: StateContext<EngineStateModel>, action: ToggleAnimation) {\n    const chapterId = this.store.selectSnapshot(StoryChaptersState.getSelectedChapterId);\n\n    if (action.play) {\n      this.animationService.unpause(chapterId);\n    } else {\n      this.animationService.pause();\n    }\n  }\n\n  @Action(SetAnimationPlaying)\n  setAnimationPlaying(context: StateContext<EngineStateModel>, action: SetAnimationPlaying) {\n    context.patchState({\n      animationPlaying: action.playing\n    });\n  }\n\n  @Action(PlayAudio)\n  playAudio(context: StateContext<EngineStateModel>, action: PlayAudio) {\n    context.patchState({\n      playAudio: action.play\n    });\n  }\n\n  @Action(SetAutoplay)\n  setAutoplay(context: StateContext<EngineStateModel>, action: SetAutoplay) {\n    context.patchState({\n      autoplay: action.enable\n    });\n  }\n\n  @Action(SetObjectLayerOrder)\n  setObjectLayerOrder(context: StateContext<EngineStateModel>, action: SetObjectLayerOrder) {\n\n    const viewGraph = context.getState().viewGraph;\n    const layer = isNaN(action.layer) ? 0 : action.layer;\n\n    let nodeIds = [];\n\n    action.nodes.forEach((node) => {\n      const descendantIds = this.graphService.getDescendants(viewGraph, node.id, true);\n      nodeIds = nodeIds.concat(descendantIds);\n    });\n\n    nodeIds.forEach((nodeId) => {\n      this.engineService.setObjectLayer(nodeId, layer);\n      this.graphService.setState(viewGraph, nodeId, { layer: layer });\n    });\n\n    // patch the state\n    context.patchState({\n      viewGraph: { ...viewGraph }\n    });\n  }\n\n  @Action(SetObjectDisplayName)\n  setObjectDisplayName(context: StateContext<EngineStateModel>, action: SetObjectDisplayName) {\n    const object = Human.scene.objects[action.nodeId];\n\n    if (object) {\n      object.displayName = action.displayName;\n    }\n  }\n\n  @Action(AutoSortObjectLayers)\n  autoSortObjectLayers(context: StateContext<EngineStateModel>, action: AutoSortObjectLayers) {\n    const viewGraph = context.getState().viewGraph;\n    const layerMultiple = 20;\n    let updateLayer = 0;\n\n    const leafIds = Human.scene.getEnabledLeaves();\n    const objectLayerValues = this.engineService.getObjectLayerValues(leafIds);\n\n    Object.keys(objectLayerValues)\n      .map(layer => parseInt(layer, 10))\n      .sort((a, b) => a - b) // Sort ascending\n      .forEach((layer) => {\n\n        objectLayerValues[layer]\n          .sort((a, b) => {\n            return b.value - a.value; // Sort descending\n          })\n          .forEach((objectLayerValue) => {\n            const newLayer = updateLayer * layerMultiple;\n\n            this.engineService.setObjectLayer(objectLayerValue.nodeId, newLayer);\n            this.graphService.setState(viewGraph, objectLayerValue.nodeId, { layer: newLayer }); // Mutate the view graph nodes\n\n            updateLayer++;\n          });\n    });\n\n    // Trigger refresh of viewgraph\n    context.patchState({\n      viewGraph: { ...viewGraph }\n    });\n  }\n\n  @Action(ResetObjectLayers)\n  resetObjectLayers(context: StateContext<EngineStateModel>, action: ResetObjectLayers) {\n\n    const viewGraph = context.getState().viewGraph;\n    const leafIds = Human.scene.getEnabledLeaves();\n\n    leafIds.forEach((leafId) => {\n      this.engineService.setObjectLayer(leafId, 0);\n      this.graphService.setState(viewGraph, leafId, { layer: 0 });\n    });\n\n    context.patchState({\n      viewGraph: { ...viewGraph }\n    });\n  }\n\n  @Action(SetPostProcessingEffects)\n  setPostProcessingEffects(context: StateContext<EngineStateModel>, { effects }: SetPostProcessingEffects) {\n    this.engineService.setPostProcessingFeatures(effects);\n  }\n\n  @Action(SetProperties)\n  setProperties(context: StateContext<EngineStateModel>, { properties }: SetProperties) {\n    this.engineService.setProperties({\n      ...properties\n    });\n  }\n\n  @Action(SetTransparencyMode)\n  setTransparencyMode(context: StateContext<EngineStateModel>, { mode }: SetTransparencyMode) {\n    this.engineService.setTransparencyMode(mode);\n  }\n\n\n  @Action(ExpandViewTreeNode)\n  expandNode(\n    context: StateContext<EngineStateModel>,\n    action: ExpandViewTreeNode\n  ) {\n    const viewGraph = this.store.selectSnapshot(EngineState.getViewGraph);\n    const ancestors = GraphUtils.getAncestors(\n      viewGraph,\n      action.node.id,\n      true\n    );\n    ancestors.forEach(id => {\n      const node = viewGraph.nodes[id];\n      node.boolState.expanded = true;\n    });\n\n    this.store.dispatch(new SetGraph(viewGraph));\n  }\n\n  @Action(CollapseViewTreeNode)\n  collapseNode(\n    context: StateContext<EngineStateModel>,\n    action: CollapseViewTreeNode\n  ) {\n    const viewGraph = this.store.selectSnapshot(EngineState.getViewGraph);\n    viewGraph.nodes[action.node.id].boolState.expanded = false;\n    this.store.dispatch(new SetGraph(viewGraph));\n  }\n\n  @Action(HoverNode)\n  hoverNode(\n    context: StateContext<EngineStateModel>,\n    action: HoverNode\n  ) {\n    context.patchState({\n      hoveredNode: action.node\n    });\n  }\n\n  @Action(SetLabelEditNode)\n  setLabelEditNode(\n    context: StateContext<EngineStateModel>,\n    action: SetLabelEditNode\n  ) {\n    context.patchState({\n      labelEditNode: action.node\n    });\n  }\n\n  @Action(QueryNodeInfo)\n  queryNodeInfo(\n    context: StateContext<EngineStateModel>,\n    { node }: QueryNodeInfo\n  ) {\n    // begin querying\n    context.patchState({ queryingWiki: true });\n\n    // query wiki service\n    this.wikiService\n      .getWikiText(node.label)\n      .pipe(\n        // end querying\n        finalize(() => context.patchState({ queryingWiki: false }))\n      )\n      .subscribe(\n        // success\n        wikiDescription =>\n          context.dispatch(\n            new QueryNodeInfoSuccess(node, wikiDescription)\n          ),\n        // failure\n        () => context.dispatch(new QueryNodeInfoFailure(node))\n      );\n  }\n\n  @Action(QueryNodeInfoSuccess)\n  queryNodeInfoSuccess(\n    context: StateContext<EngineStateModel>,\n    { node, description }: QueryNodeInfoSuccess\n  ) {\n    context.dispatch(new SetNodeInfo(node, description));\n  }\n\n  @Action(SetNodeInfo)\n  setNodeInfo(\n    context: StateContext<EngineStateModel>,\n    { node, description }: SetNodeInfo\n  ) {\n    const viewGraph = this.store.selectSnapshot(EngineState.getViewGraph);\n    const viewNode = viewGraph.nodes[node.id];\n    if (viewNode) {\n      viewNode.description = description;\n      this.store.dispatch(new SetGraph(viewGraph));\n    }\n  }\n\n  @Action(SetContextMenu)\n  setContextMenu(\n    context: StateContext<EngineStateModel>,\n    action: SetContextMenu\n  ) {\n    context.patchState({\n      contextmenu: { node: action.node, hit: action.hit }\n    });\n  }\n\n  private stateMapToNodeIds(viewGraph: BdGraph<ViewTreeNode>, stateMap: BdGraphStateMap): Set<string> {\n    // map human objects to relevant view nodes (if any);\n    const ids = Object.keys(stateMap)\n      .map(objectId => this.engineService.getNode(viewGraph, objectId))\n      .filter(node => !!node)\n      .map(node => node.id);\n\n    return new Set<string>(ids);\n  }\n\n  constructor(\n    private store: Store,\n    private graphService: BdGraphService,\n    private engineService: EngineService,\n    private wikiService: WikiService,\n    private animationService: AnimationService\n  ) { }\n}\n","import { ObjectId, NodeState } from './engine.nodes.state.model';\nimport { BdGraph, BdGraphNode } from 'src/lib/graph/graph.model';\nimport { PaintPresetOriginal } from '../../models/paint-presets.const';\nimport { ColorRecipeModel } from 'src/app/edit/models/color-recipe.model';\nimport { EngineColorRecipeModel } from 'src/app/edit/models/engine-color-recipe.model';\nimport { GraphUtils } from 'src/lib/graph/graph-utils';\n\nexport function hasShownSuccessor(graph, objectId, showObjects): boolean {\n  // get successors\n\n  const successors = GraphUtils.getSuccessors(graph, objectId);\n\n  // are there successors?\n  if (successors.length === 0) {\n    return false;\n  }\n\n  // are any of these successors in show objects as true?\n  for (const successor of successors) {\n    if (showObjects[successor] === true) {\n      return true;\n    }\n  }\n\n  // for each successor, recurse\n  return successors.some((successor) => hasShownSuccessor(graph, successor, showObjects));\n}\n\nexport function hasShownAncestor(graph, objectId, showObjects): boolean {\n  // is this object in showObjects?\n\n  switch (showObjects[objectId]) {\n    case true:\n      return true;\n    case false:\n      return false;\n    case undefined: {\n      // this object is not in show objects.\n      // recurse until we find a parent\n      const parent = GraphUtils.getAncestor(graph, objectId);\n      if (!parent) {\n        return false;\n      }\n      return hasShownAncestor(graph, parent, showObjects);\n    }\n  }\n}\n\nfunction isObjectPickable(graph, objectId, pickThroughObjects): boolean {\n  switch (pickThroughObjects[objectId]) {\n    case true:\n      return false;\n    case false:\n      return true;\n    case undefined: {\n      // this object is not in show objects.\n      // recurse until we find a parent\n      const parent = GraphUtils.getAncestor(graph, objectId);\n      if (!parent) {\n        return true;\n      }\n      return isObjectPickable(graph, parent, pickThroughObjects);\n    }\n  }\n}\n\nfunction syncHasColorInfo(syncForObject) {\n  return 'tintColor' in syncForObject || 'opacity' in syncForObject;\n}\n\nfunction getObjectPaint(graph, objectId, sync): ColorRecipeModel {\n  if (sync[objectId] && syncHasColorInfo(sync[objectId])) {\n    return ColorRecipeModel.fromEngine(\n      new EngineColorRecipeModel(sync[objectId])\n    );\n  }\n  const parent = GraphUtils.getAncestor(graph, objectId);\n  return parent\n    ? getObjectPaint(graph, parent, sync)\n    : PaintPresetOriginal.recipe;\n}\n\n// build node state:\n\n// use chapter's showObjects to decide if an object is shown or hidden\n// if undefined, defer to parent's value.  keep recursing until we find a value.\n\n// use chapter's pickThroughObjects to decide if an object is pickable or not\n// if undefined, defer to parent's value.  keep recursing until we find a value.\n\n// use chapter's synchronization to decide an object's color properties.\n// if undefined, defer to parent's value.  keep recursing until we find a value.\n\nexport function buildNodeState(\n  graph: BdGraph<BdGraphNode>,\n  showObjects: Record<ObjectId, boolean>,\n  pickThroughObjects: Record<ObjectId, boolean>,\n  sync: Record<ObjectId, EngineColorRecipeModel>\n):  Record<ObjectId, NodeState>  {\n\n  function nodeFactory(objectId): NodeState {\n    const shown = hasShownAncestor(graph, objectId, showObjects) || hasShownSuccessor(graph, objectId, showObjects);\n    const pickable = isObjectPickable(graph, objectId, pickThroughObjects);\n    const paint = getObjectPaint(graph, objectId, sync);\n    return {\n      objectId,\n      checked: false,\n      selected: false,\n      paint,\n      pickable,\n      shown,\n      shownSetByTween: false\n    };\n  }\n\n  const nodes = Object.keys(graph.nodes).reduce((nodeState, objectId) => {\n    nodeState[objectId] = nodeFactory(objectId);\n    return nodeState;\n  }, {});\n\n  return nodes;\n}\n","import { ObjectId, NodeState } from './engine.nodes.state.model';\nimport { Patch } from 'src/vendor/immer-6.0.9/compat/pre-3.7/dist/immer';\nimport { ColorRecipeModel } from 'src/app/edit/models/color-recipe.model';\n\nexport namespace NodeActions {\n\n  export class Reset {\n    static readonly type = '[Engine Nodes] Reset';\n    constructor() {}\n  }\n\n  export class InitNodeState {\n    static readonly type = '[Engine Nodes] init nodes';\n    constructor(\n      public nodeState: Record<string, Record<ObjectId, NodeState>>\n    ) {}\n  }\n\n  export class ApplyPatch {\n    static readonly type = '[Engine Nodes] patch nodes';\n    constructor(public patches: Patch[]) {}\n  }\n\n  export class SetActiveChapter {\n    static readonly type = '[Engine Nodes] set active chapter';\n    constructor(public activeChapterId: string) {}\n  }\n\n  export class DuplicateNodeState {\n    static readonly type = '[Engine Nodes] Duplicate node state';\n    constructor(\n      public originalChapterId: string,\n      public copyChapterId: string\n    ) {}\n  }\n\n\n  export class UpdateNodesShown {\n    static readonly type = '[Engine Nodes] update nodes shown';\n    constructor(\n      public show: boolean,\n      public objectIds?: ObjectId[],\n      public patch?: Record<ObjectId, boolean>,\n      public record: boolean = true,\n      public setByTween: boolean = false\n    ) {}\n  }\n\n  export class UpdateNodeSelected {\n    static readonly type = '[Engine Nodes] update nodes selected';\n    constructor(public objectId?: ObjectId) {}\n  }\n\n  export class UpdateNodesChecked {\n    static readonly type = '[Engine Nodes] update nodes checked';\n    constructor(\n      public checked: boolean,\n      public objectIds?: ObjectId[],\n      public patch?: Record<ObjectId, boolean>\n    ) {}\n  }\n\n  export class UpdateNodesPickable {\n    static readonly type = '[Engine Nodes] update nodes pickable';\n    constructor(public pickable: boolean,\n      public objectIds?: ObjectId[],\n      public patch?: Record<ObjectId, boolean>\n    ) {}\n  }\n\n  export class UpdateNodesPaint {\n    static readonly type = '[Engine Nodes] update nodes paint';\n    constructor(\n      public recipe: ColorRecipeModel,\n      public objectIds?: ObjectId[],\n      public patch?: Record<ObjectId, ColorRecipeModel>,\n      public record: boolean = true\n    ) {}\n  }\n\n}\n","import { ViewTreeNode } from '../../models/view.tree-node';\nimport { ColorRecipeModel } from 'src/app/edit/models/color-recipe.model';\nimport { Patch } from 'src/vendor/immer-6.0.9/compat/pre-3.7/dist/immer';\n\n\nexport type ObjectId = string;\n\n\nexport interface NodeState {\n  objectId: ObjectId;\n\n  // the node should be visible, assuming nothing occludes it.\n  shown: boolean;\n  shownSetByTween: boolean;\n\n\n  // selected means that this node is under examination from the user\n  // a context label can be applied to a selected node.\n  selected: boolean;\n\n  // checked means that the node is highlighted\n  // multiple nodes can be checked, only 1 can be selected.\n  checked: boolean;\n\n  pickable: boolean;\n  paint: ColorRecipeModel;\n}\n\nexport class EngineNodesStateModel {\n  nodeState: Record<string, Record<ObjectId, NodeState>>;\n  patches: Patch[];\n  patchesForChapter: Record<string, Patch[]>;\n  activeChapterId: string;\n}\n","import {\n  State,\n  Action,\n  StateContext,\n  Selector,\n} from '@ngxs/store';\nimport { EngineNodesStateModel, ObjectId } from './engine.nodes.state.model';\nimport { NodeActions } from './engine.nodes.actions';\n\nimport { UndoActions } from 'src/app/undo/state/undo.state.actions';\nimport { setAllChildren } from './node-utils';\nimport { calcShownObjectState } from './node-reducers';\n\ndeclare const immer;\n\nconst initialState: EngineNodesStateModel = {\n  activeChapterId: undefined,\n  nodeState: undefined,\n  patches: [],\n  patchesForChapter: {}\n};\n\n@State<EngineNodesStateModel>({\n  name: 'engineNodes',\n  defaults: initialState\n})\nexport class EngineNodesState {\n  /**\n   * Selectors\n   */\n  @Selector()\n  static getAllNodeState(state: EngineNodesStateModel) {\n    return state.nodeState;\n  }\n\n  @Selector()\n  static getActiveChapter(state: EngineNodesStateModel) {\n    return state.activeChapterId;\n  }\n\n  @Selector()\n  static getPatches(state: EngineNodesStateModel) {\n    return state.patches;\n  }\n\n  @Selector()\n  static getNodes(state: EngineNodesStateModel) {\n    if (state.activeChapterId === undefined || state.nodeState === undefined) {\n      return {};\n    }\n    return state.nodeState[state.activeChapterId] || {};\n  }\n\n  @Selector()\n  static getNodePaint(state: EngineNodesStateModel) {\n    return (objectId: ObjectId) =>\n      state.nodeState[state.activeChapterId][objectId].paint;\n  }\n\n  @Selector()\n  static getNodeIds(state: EngineNodesStateModel) {\n    return Object.keys(EngineNodesState.getNodes(state));\n  }\n\n  @Selector()\n  static getCheckedNodeIds(state: EngineNodesStateModel) {\n    return Object.values(EngineNodesState.getNodes(state))\n      .filter(nodeState => nodeState.checked)\n      .map(nodeState => nodeState.objectId);\n  }\n\n  @Selector()\n  static getCheckedNodes(state: EngineNodesStateModel) {\n    return EngineNodesState.getCheckedNodeIds(state).map(\n      objectId => state.nodeState[state.activeChapterId][objectId]\n    );\n  }\n\n  @Selector()\n  static getUncheckedNodeIds(state: EngineNodesStateModel) {\n    return EngineNodesState.getNodeIds(state).filter(objectId => {\n      const node = state.nodeState[state.activeChapterId][objectId];\n      return !node.checked;\n    });\n  }\n\n  @Selector()\n  static getSelectedNode(state: EngineNodesStateModel) {\n    const selectedNodeId = EngineNodesState.getNodeIds(state).find(objectId => {\n      return state.nodeState[state.activeChapterId][objectId].selected;\n    });\n\n    return selectedNodeId\n      ? state.nodeState[state.activeChapterId][selectedNodeId]\n      : undefined;\n  }\n\n  /**\n   * Actions\n   */\n\n  @Action(NodeActions.Reset)\n  reset(context: StateContext<EngineNodesStateModel>, action: NodeActions.Reset) {\n    context.patchState(\n      immer.produce(context.getState(), draft => {\n        draft.activeChapterId = undefined;\n        draft.nodeState = undefined;\n        draft.patches = [];\n        draft.patchesForChapter = {};\n      })\n    );\n  }\n\n  @Action(NodeActions.ApplyPatch)\n  applyPatch(\n    context: StateContext<EngineNodesStateModel>,\n    action: NodeActions.ApplyPatch\n  ) {\n    const nextState = immer.applyPatches(context.getState(), action.patches);\n\n    // need to preserve patches when we undo!\n    const finalState = immer.produce(nextState, draft => {\n      draft.patchesForChapter[draft.activeChapterId].push(...action.patches);\n      draft.patches = action.patches;\n    });\n\n    context.patchState(finalState);\n  }\n\n  @Action(NodeActions.InitNodeState)\n  initNodeState(\n    context: StateContext<EngineNodesStateModel>,\n    action: NodeActions.InitNodeState\n  ) {\n    context.patchState({ nodeState: action.nodeState });\n  }\n\n  @Action(NodeActions.SetActiveChapter)\n  setActiveChapter(\n    context: StateContext<EngineNodesStateModel>,\n    action: NodeActions.SetActiveChapter\n  ) {\n    const state = context.getState();\n\n    const nextState = immer.produce(state, draft => {\n      draft.activeChapterId = action.activeChapterId;\n      draft.patchesForChapter[action.activeChapterId] =\n        draft.patchesForChapter[action.activeChapterId] || [];\n      draft.patches = draft.patchesForChapter[action.activeChapterId];\n    });\n\n    context.patchState(nextState);\n  }\n\n  @Action(NodeActions.DuplicateNodeState)\n  duplicateNodeState(\n    context: StateContext<EngineNodesStateModel>,\n    action: NodeActions.DuplicateNodeState\n  ) {\n    const state = context.getState();\n\n    const nextState = immer.produce(state, draft => {\n      draft.nodeState[action.copyChapterId] =\n        draft.nodeState[action.originalChapterId];\n\n      // when I copy patches over to a new chapter, I must replace the chapter Id for each patch.\n      const patches = draft.patchesForChapter[action.originalChapterId];\n\n      draft.patchesForChapter[action.copyChapterId] = patches.map(patch => {\n        patch.path[1] = action.copyChapterId;\n        return patch;\n      });\n    });\n\n    context.patchState(nextState);\n  }\n\n  @Action(NodeActions.UpdateNodesShown)\n  updateNodesShown(\n    context: StateContext<EngineNodesStateModel>,\n    action: NodeActions.UpdateNodesShown\n  ) {\n\n    const state = context.getState();\n    const {finalState, patches, inversePatches} = calcShownObjectState(state, action);\n    context.patchState(finalState);\n    if (action.record) {\n      context.dispatch(\n        new UndoActions.SavePatches([{\n          forward: patches,\n          inverse: inversePatches,\n          patchAction: NodeActions.ApplyPatch\n        }])\n      );\n    }\n  }\n\n\n  @Action(NodeActions.UpdateNodeSelected)\n  updateNodesSelected(\n    context: StateContext<EngineNodesStateModel>,\n    action: NodeActions.UpdateNodeSelected\n  ) {\n    const state = context.getState();\n    const nextState = immer.produce(state, draft => {\n      const nodes = draft.nodeState[draft.activeChapterId];\n      const objectIds = Object.keys(nodes);\n      switch (action.objectId) {\n        case undefined: {\n          objectIds.forEach(objectId => (nodes[objectId].selected = false));\n          break;\n        }\n        default: {\n          objectIds.forEach(objectId => (nodes[objectId].selected = false));\n          nodes[action.objectId].selected = true;\n          break;\n        }\n      }\n    });\n\n    context.patchState(nextState);\n  }\n\n  @Action(NodeActions.UpdateNodesChecked)\n  updateNodesChecked(\n    context: StateContext<EngineNodesStateModel>,\n    action: NodeActions.UpdateNodesChecked\n  ) {\n    const state = context.getState();\n    const [nextState, patches, inversePatches] = immer.produceWithPatches(\n      state,\n      draft => {\n        const nodes = draft.nodeState[draft.activeChapterId];\n        switch (action.patch) {\n          case undefined: {\n            const objectIds = action.objectIds || Object.keys(nodes);\n            objectIds.forEach(\n              objectId => {\n                nodes[objectId].checked = action.checked;\n                if (action.objectIds) {\n                  setAllChildren(objectId, nodes, 'checked', action.checked);\n                }\n              }\n            );\n            break;\n          }\n          default: {\n            Object.entries(action.patch).forEach(\n              ([objectId, value]) => (nodes[objectId].checked = value)\n            );\n            break;\n          }\n        }\n      }\n    );\n\n\n    const finalState = immer.produce(nextState, draft => {\n      draft.patches = patches;\n    });\n\n    context.patchState(finalState);\n  }\n\n  @Action(NodeActions.UpdateNodesPickable)\n  updateNodesPickable(\n    context: StateContext<EngineNodesStateModel>,\n    action: NodeActions.UpdateNodesPickable\n  ) {\n    const state = context.getState();\n    const [nextState, patches, inversePatches] = immer.produceWithPatches(\n      state,\n      draft => {\n        const nodes = draft.nodeState[draft.activeChapterId];\n        if (action.patch) {\n          Object.entries(action.patch).forEach(\n            ([objectId, value]) => (nodes[objectId].pickable = value)\n          );\n        } else {\n          const objectIds = action.objectIds || Object.keys(nodes);\n          objectIds.forEach(objectId => {\n            nodes[objectId].pickable = action.pickable;\n            if (action.objectIds) {\n              setAllChildren(objectId, nodes, 'pickable', action.pickable);\n            }\n          });\n        }\n      }\n    );\n\n    const finalState = immer.produce(nextState, draft => {\n      draft.patches = patches;\n      draft.patchesForChapter[draft.activeChapterId].push(...patches);\n    });\n\n    context.patchState(finalState);\n    context.dispatch(\n      new UndoActions.SavePatches([{\n        forward: patches,\n        inverse: inversePatches,\n        patchAction: NodeActions.ApplyPatch\n      }])\n    );\n  }\n\n  @Action(NodeActions.UpdateNodesPaint)\n  updateNodesPaint(\n    context: StateContext<EngineNodesStateModel>,\n    action: NodeActions.UpdateNodesPaint\n  ) {\n    const state = context.getState();\n    const [nextState, patches, inversePatches] = immer.produceWithPatches(\n      state,\n      draft => {\n        const nodes = draft.nodeState[draft.activeChapterId];\n        const objectIds = action.objectIds || Object.keys(nodes);\n        if (action.patch) {\n          Object.entries(action.patch).forEach(\n            ([objectId, value]) => (nodes[objectId].paint = value)\n          );\n        } else {\n          objectIds.forEach(objectId => {\n            nodes[objectId].paint = action.recipe;\n            if (action.objectIds) {\n              setAllChildren(objectId, nodes, 'paint', action.recipe);\n            }\n          });\n        }\n      }\n    );\n\n    const finalState = immer.produce(nextState, draft => {\n      draft.patches = patches;\n      draft.patchesForChapter[draft.activeChapterId].push(...patches);\n    });\n\n    context.patchState(finalState);\n\n    if (action.record) {\n      context.dispatch(\n        new UndoActions.SavePatches([{\n          forward: patches,\n          inverse: inversePatches,\n          patchAction: NodeActions.ApplyPatch\n        }])\n      );\n    }\n  }\n\n\n\n  constructor() {}\n}\n","import { setAllChildren } from './node-utils';\nimport { EngineNodesStateModel, ObjectId, NodeState } from './engine.nodes.state.model';\nimport { NodeActions } from './engine.nodes.actions';\n\ndeclare const immer;\n\nexport function calcShownObjectState(\n  state: EngineNodesStateModel,\n  action: NodeActions.UpdateNodesShown\n) {\n  if (state.activeChapterId === undefined || state.nodeState === undefined) {\n    return;\n  }\n\n  const [nextState, patches, inversePatches] = immer.produceWithPatches(\n    state,\n    (draft) => {\n      const nodes: Record<ObjectId, NodeState> = draft.nodeState[draft.activeChapterId];\n      const objectIds = action.objectIds || Object.keys(nodes);\n\n      if (action.patch) {\n        Object.entries(action.patch).forEach(([objectId, value]) => {\n          nodes[objectId].shown = value;\n        });\n      } else {\n        objectIds.forEach((objectId) => {\n          nodes[objectId].shown = action.show;\n          nodes[objectId].shownSetByTween = action.setByTween;\n          if (action.objectIds) {\n            setAllChildren(objectId, nodes, 'shown', action.show);\n            if (action.setByTween === true) {\n              setAllChildren(objectId, nodes, 'shownSetByTween', action.setByTween);\n            }\n          }\n        });\n      }\n    }\n  );\n\n  const finalState = immer.produce(nextState, (draft) => {\n    draft.patches = patches;\n    draft.patchesForChapter[draft.activeChapterId].push(...patches);\n  });\n\n  return { finalState, patches, inversePatches };\n}\n","import { flattenDeep } from 'lodash';\nimport { ObjectId } from './engine.nodes.state.model';\n\ndeclare const Human;\n\nfunction getAllChildren(_Human, object): ObjectId[] {\n  const children = object.objects;\n\n  if (children.length === 0) {\n    return [];\n  }\n\n  return flattenDeep(\n    children.map(child => {\n      return [\n        child.objectId,\n        ...getAllChildren(_Human, _Human.scene.objects[child.objectId])\n      ];\n    })\n  );\n}\n\nexport function setAllChildren(objectId, nodes, prop, value) {\n  getAllChildren(Human, Human.scene.objects[objectId]).forEach(\n    childId => (nodes[childId][prop] = value)\n  );\n}\n","import { ParticlesStateModel } from './particles.state.model';\nimport { ParticleSystem, ParticleConstraint, ParticleCreator, ParticleUpdater } from '../../models/particles/particle-system-types';\nimport { TweenParticleLookupModel } from 'src/app/story/models/tween-particle-lookup.model';\nimport { Patch } from 'src/vendor/immer-6.0.9/compat/pre-3.7/dist/immer';\n\nexport namespace ParticleActions {\n\n  export class SetParticleState {\n    static readonly type = '[Engine Particles] Set Particle State';\n    constructor (\n      public particleSystems: ParticleSystem[],\n      public assignedParticles: ParticlesStateModel['assignedParticles'], \n      public tweenParticleLookup: TweenParticleLookupModel) {}\n  }\n\n  export class NewParticleSystem {\n    static readonly type = '[Engine Particles] New Particle System';\n    constructor (public particleSystem: ParticleSystem, public chapterId: string) {}\n  }\n\n  export class DuplicateParticleSystem {\n    static readonly type = '[Engine Particles] Duplicate Particle System';\n    constructor (public id: string, public targetChapterId: string) {}\n  }\n\n  export class DuplicateParticleSystemSuccess {\n    static readonly type = '[Engine Particles] Duplicate Particle System Success';\n    constructor (public id: string, public targetChapterId: string) {}\n  }\n\n  export class UpdateParticleSystem {\n    static readonly type = '[Engine Particles] Update Particle System';\n    constructor (public id: string, public particleSystem: ParticleSystem) {}\n  } \n\n  export class SetParticleSystemId {\n    static readonly type = '[Engine Particles] Set Particle System Id';\n    constructor (public oldId: string, public newId: string) {}\n  } \n  \n  export class SetParticleSystemsVisible {\n    static readonly type = '[Engine Particles] Set Particle Systems Visible';\n    constructor (public visible: boolean, public chapterId?: string) {}\n  }\n\n  export class SetParticleSystemVisible {\n    static readonly type = '[Engine Particles] Set Particle System Visible';\n    constructor (public id: string, public visible: boolean) {}\n  }\n\n  export class AssignParticle {\n    static readonly type = '[Engine Particles] Assign Particle';\n    constructor (public id: string, public chapterId: string) {} \n  }\n\n  export class UnassignParticle {\n    static readonly type = '[Engine Particles] Unassign Particle';\n    constructor (public id: string, public chapterId: string) {} \n  }\n\n  export class DeleteParticleSystem {\n    static readonly type = '[Engine Partiles] Delete Particle System';\n    constructor (public id: string) {}\n  }\n\n  export class SelectParticleSystem {\n    static readonly type = '[Engine Partiles] Select Particle System';\n    constructor (public id: string) {}\n  }\n\n  export class SelectParticleConstraint {\n    static readonly type = '[Engine Partiles] Select Particle Constraint';\n    constructor(public index: number) { }\n  }\n\n  export class SelectParticleCreator {\n    static readonly type = '[Engine Partiles] Select Particle Creator';\n    constructor(public index: number) { }\n  }\n\n  export class SelectParticleUpdater {\n    static readonly type = '[Engine Partiles] Select Particle Updater';\n    constructor(public index: number) { }\n  }\n\n  export class UpdateTweenParticleLookupChapters {\n    static readonly type = '[Engine Particles] Update Lookup Chapters';\n    constructor(public chapterMap: Record<string, string>) { }\n  }\n  export class SetLookupForChapter {\n    static readonly type = '[Engine Particles] Set Lookup for chapter';\n    constructor(public chapterId: string, public lookup: Record<string, string>) { }\n  }\n\n  export class DeleteChapterLookup {\n    static readonly type = '[Engine Particles] Delete chapter lookup';\n    constructor(public chapterId: string) { }\n  }\n\n  export class ApplyPatch {\n    static readonly type = '[Engine Particles] Apply Patch';\n    constructor(public patches: Patch[]) {}\n  }\n}\n","import {\n  State,\n  Action,\n  StateContext,\n  Selector,\n  createSelector,\n} from '@ngxs/store';\nimport { ParticlesStateModel } from './particles.state.model';\nimport { ParticleActions } from './particles.actions';\nimport { ParticleSystem } from '../../models/particles/particle-system-types';\nimport { TweenParticleLookup } from 'src/app/shared/tween-particle-lookup';\nimport { ParticleIdUtils } from 'src/app/shared/particle-id-utils';\nimport { mapValues } from 'lodash';\n\ndeclare const immer;\n\n@State<ParticlesStateModel>({\n  name: 'engineParticles',\n  defaults: {\n    particleSelection: {},\n    particleSystems: {},\n    visibleParticleSystems: {},\n    assignedParticles: {},\n    tweenParticleLookup: {},\n  },\n})\nexport class EngineParticlesState {\n  static particleSystemIdExists(id: string) {\n    return createSelector(\n      [EngineParticlesState],\n      (state: ParticlesStateModel) => {\n        return state.particleSystems[id] !== undefined;\n      }\n    );\n  }\n\n  static particleSystemsForChapter(chapterId: string) {\n    return createSelector([EngineParticlesState], (state: ParticlesStateModel): ParticleSystem[]  => {\n      const assignedChapterParticleIds = state.assignedParticles[chapterId] || [];\n      return assignedChapterParticleIds.map(particleId => state.particleSystems[particleId]);\n    });\n  }\n\n  @Selector()\n  static getTweenParticleLookup(state: ParticlesStateModel) {\n    return state.tweenParticleLookup;\n  }\n\n  @Selector()\n  static getParticleSystems(state: ParticlesStateModel) {\n    return state.particleSystems;\n  }\n\n  @Selector()\n  static getVisisbleParticleSystems(state: ParticlesStateModel) {\n    return state.visibleParticleSystems;\n  }\n\n  @Selector()\n  static getParticleSystemsList(state: ParticlesStateModel) {\n    return Object.values(state.particleSystems);\n  }\n\n  @Selector()\n  static getAssignedParticleSystems(state: ParticlesStateModel) {\n    return state.assignedParticles;\n  }\n\n  @Selector()\n  static getSelectedParticleSystemId(state: ParticlesStateModel) {\n    return state.particleSelection.selectedParticle;\n  }\n\n  @Selector()\n  static getSelectedParticleSystem(state: ParticlesStateModel) {\n    const { particleSystems, particleSelection, } = state;\n    return particleSystems[particleSelection.selectedParticle];\n  }\n\n  @Selector()\n  static getSelectedParticleConstraintIndex(state: ParticlesStateModel) {\n    return state.particleSelection.selectedConstraint;\n  }\n\n  @Selector()\n  static getSelectedParticleConstraint(state: ParticlesStateModel) {\n    const system = EngineParticlesState.getSelectedParticleSystem(state);\n    const index = state.particleSelection.selectedConstraint;\n    return system ? system.constraints[index] : null;\n  }\n\n  @Selector()\n  static getSelectedParticleCreatorIndex(state: ParticlesStateModel) {\n    return state.particleSelection.selectedCreator;\n  }\n  \n  @Selector()\n  static getSelectedParticleCreator(state: ParticlesStateModel) {\n    const system = EngineParticlesState.getSelectedParticleSystem(state);\n    const index = state.particleSelection.selectedCreator;\n    return system ? system.creators[index] : null;\n  }\n\n  @Selector()\n  static getSelectedParticleUpdaterIndex(state: ParticlesStateModel) {\n    return state.particleSelection.selectedUpdater;\n  }\n\n  @Selector()\n  static getSelectedParticleUpdater(state: ParticlesStateModel) {\n    const system = EngineParticlesState.getSelectedParticleSystem(state);\n    const index = state.particleSelection.selectedUpdater;\n    return system ? system.updaters[index] : null;\n  }\n\n\n  @Action(ParticleActions.ApplyPatch)\n  applyPatch(context: StateContext<ParticlesStateModel>, action: ParticleActions.ApplyPatch) {\n    const nextState = immer.applyPatches(context.getState(), action.patches);\n    context.patchState(nextState);\n  }\n\n  @Action(ParticleActions.SetParticleState)\n  setParticleState(\n    context: StateContext<ParticlesStateModel>,\n    action: ParticleActions.SetParticleState\n  ) {\n    context.patchState(\n      immer.produce(context.getState(), (draft: ParticlesStateModel) => {\n        \n        draft.particleSystems = action.particleSystems.reduce((acc, particleSystem) => {\n          acc[particleSystem.id] = particleSystem;\n          return acc;\n        }, {});\n\n        draft.assignedParticles = action.assignedParticles;\n        draft.tweenParticleLookup = action.tweenParticleLookup;\n\n        // reset visibility\n        draft.visibleParticleSystems = {};\n      })\n    );\n  }\n\n  @Action(ParticleActions.SetParticleSystemsVisible)\n  setParticlesVisible(\n    context: StateContext<ParticlesStateModel>,\n    { visible, chapterId }: ParticleActions.SetParticleSystemsVisible\n  ) {\n    context.patchState(\n      immer.produce(context.getState(), (draft: ParticlesStateModel) => {\n        const particleIds = typeof chapterId !== 'undefined'\n          ? draft.assignedParticles[chapterId] || [] // chapter particles\n          : Object.keys(draft.particleSystems); // all particles\n\n        // patch particle visiblity\n        draft.visibleParticleSystems = particleIds\n          .reduce((acc, id) => {\n            acc[id] = visible;\n            return acc;\n          }, {});\n      })\n    );\n  }\n\n  @Action(ParticleActions.SetParticleSystemVisible)\n  setParticleVisible(\n    context: StateContext<ParticlesStateModel>,\n    { id, visible }: ParticleActions.SetParticleSystemVisible\n  ) {\n    context.patchState(\n      immer.produce(context.getState(), (draft: ParticlesStateModel) => {\n        // patch system visiblity        \n        draft.visibleParticleSystems = {\n          ...draft.visibleParticleSystems,\n          [id]: visible\n        };\n      })\n    );\n  }\n\n  @Action(ParticleActions.NewParticleSystem)\n  newParticleSystem(\n    context: StateContext<ParticlesStateModel>,\n    action: ParticleActions.NewParticleSystem\n  ) {\n    const { particleSystem, chapterId } = action;\n    const particleSystemId = particleSystem.id;\n\n\n    const [nextState, patches, inversePatches] = immer.produceWithPatches(context.getState(), (draft: ParticlesStateModel) => {\n      // TODO: what happens if particle Id collides?\n\n      // add\n      draft.particleSystems[particleSystemId] = particleSystem;\n\n      // assign to chapter\n      const chapterParticleSystemIds = draft.assignedParticles[chapterId] || [];\n      draft.assignedParticles[chapterId] = [\n        ...chapterParticleSystemIds,\n        particleSystemId\n      ];\n\n      // Do not modify the lookup.\n    });\n\n    context.patchState(nextState);\n\n    // save undo support for a later iteration\n  }\n  @Action(ParticleActions.SetParticleSystemId)\n  setParticleSystemId(\n    context: StateContext<ParticlesStateModel>,\n    action: ParticleActions.SetParticleSystemId\n  ) {\n\n    const idIsUsed = context.getState().particleSystems[action.newId] !== undefined;\n    if (idIsUsed) { return; }\n\n\n    context.patchState(\n      immer.produce(context.getState(), (draft: ParticlesStateModel) => {\n        draft.particleSelection.selectedParticle =\n\n          // selected particle\n          draft.particleSelection.selectedParticle === action.oldId\n            ? action.newId\n            : draft.particleSelection.selectedParticle;\n           \n\n          // particle systems\n          draft.particleSystems[action.newId] = {\n            ...draft.particleSystems[action.oldId],\n            id: action.newId\n          };\n          delete draft.particleSystems[action.oldId];\n\n\n          // assigned particles\n          Object.entries(draft.assignedParticles).forEach(([chapterId, particles]) => {\n            draft.assignedParticles[chapterId] = particles.map(id => id === action.oldId ? action.newId : id);\n          });\n\n          \n          // tween particle lookup\n          Object.entries(draft.tweenParticleLookup).forEach(([chapterId, lookup]) => {\n            draft.tweenParticleLookup[chapterId] = mapValues(lookup, (value, key, object) => {\n              return value === action.oldId ? action.newId : value;\n            });\n          });\n      })\n    );\n  }\n\n  @Action(ParticleActions.DuplicateParticleSystem)\n  duplicateParticleSystem(\n    context: StateContext<ParticlesStateModel>,\n    action: ParticleActions.DuplicateParticleSystem\n  ) {\n    const { id, targetChapterId } = action;\n    // generate new id.\n    const newId = ParticleIdUtils.generateParticleId(id);\n\n    context.patchState(\n      // will support undo later\n      immer.produce(context.getState(), (draft: ParticlesStateModel) => {\n\n        // duplicate\n        draft.particleSystems[newId] = JSON.parse(\n          JSON.stringify(draft.particleSystems[id])\n        );\n\n        // set Id\n        draft.particleSystems[newId].id = newId;\n\n        // assign to chapter\n        draft.assignedParticles[targetChapterId].push(newId);\n\n        // modify the lookup if the original particle system has an entry in the lookup.\n        const originalId = ParticleIdUtils.getParticleIdRoot(id);\n        const originalInLookup =\n          draft.tweenParticleLookup[targetChapterId] &&\n          draft.tweenParticleLookup[targetChapterId][originalId];\n\n        if (originalInLookup) {\n          draft.tweenParticleLookup = TweenParticleLookup.addEntryForChapter(\n            targetChapterId,\n            { [originalId]: newId },\n            draft.tweenParticleLookup\n          );\n        }\n      })\n    );\n\n    context.dispatch(new ParticleActions.DuplicateParticleSystemSuccess(newId, targetChapterId));\n  }\n\n  @Action(ParticleActions.UpdateParticleSystem)\n  updateParticleSystem(\n    context: StateContext<ParticlesStateModel>,\n    action: ParticleActions.UpdateParticleSystem\n  ) {\n\n    const patchedState = immer.produce(context.getState(), (draft: ParticlesStateModel) => {\n      // TODO: what happens if particle Id collides?\n      draft.particleSystems[action.id] = action.particleSystem;\n    });\n    // TODO[AC]: force particle systems state check, revisit\n    context.patchState({\n      ...patchedState,\n      particleSystems: {\n        ...patchedState.particleSystems\n      }\n    });\n  }\n\n\n  @Action(ParticleActions.DeleteChapterLookup)\n  deleteChapterLookup(\n    context: StateContext<ParticlesStateModel>,\n    action: ParticleActions.DeleteChapterLookup\n  ) {\n    context.patchState(\n      immer.produce(context.getState(), (draft: ParticlesStateModel) => {\n        delete draft.tweenParticleLookup[action.chapterId];\n      })\n    );\n  }\n\n  @Action(ParticleActions.SetLookupForChapter)\n  setLookupForChapter(\n    context: StateContext<ParticlesStateModel>,\n    action: ParticleActions.SetLookupForChapter\n  ) {\n    context.patchState(\n      immer.produce(context.getState(), (draft: ParticlesStateModel) => {\n        draft.tweenParticleLookup[action.chapterId] = action.lookup;\n      })\n    );\n  }\n\n  @Action(ParticleActions.AssignParticle)\n  assignParticle(\n    context: StateContext<ParticlesStateModel>,\n    action: ParticleActions.AssignParticle\n  ) {\n    context.patchState(\n      immer.produce(context.getState(), (draft: ParticlesStateModel) => {\n        const currentChapterParticles = draft.assignedParticles[action.chapterId] || [];\n        const originalId = ParticleIdUtils.getParticleIdRoot(action.id);\n\n        draft.assignedParticles[action.chapterId] = currentChapterParticles.concat(\n          action.id\n        );\n        \n        draft.tweenParticleLookup = TweenParticleLookup.addEntryForChapter(\n          action.chapterId,\n          { [originalId]: action.id },\n          draft.tweenParticleLookup\n        );\n        \n        draft.particleSystems = { ...draft.particleSystems };\n      })\n    );\n  }\n\n  @Action(ParticleActions.UnassignParticle)\n  unassignParticle(\n    context: StateContext<ParticlesStateModel>,\n    action: ParticleActions.UnassignParticle\n  ) {\n    context.patchState(\n      immer.produce(context.getState(), (draft: ParticlesStateModel) => {\n        const currentChapterParticles = draft.assignedParticles[action.chapterId] || [];\n        const originalId = ParticleIdUtils.getParticleIdRoot(action.id);\n\n        draft.assignedParticles[action.chapterId] = currentChapterParticles.filter(\n          (id) => id !== action.id\n        );\n\n        if (draft.tweenParticleLookup[action.chapterId]) {\n          delete draft.tweenParticleLookup[action.chapterId][originalId];\n        }\n    \n        draft.particleSystems = { ...draft.particleSystems };\n      })\n    );\n  }\n\n  @Action(ParticleActions.DeleteParticleSystem)\n  deleteParticleSystem(\n    context: StateContext<ParticlesStateModel>,\n    action: ParticleActions.DeleteParticleSystem\n  ) {\n\n    context.patchState(\n      immer.produce(context.getState(), (draft: ParticlesStateModel) => {\n\n        // remove the particle\n        delete draft.particleSystems[action.id];\n\n        // remove all chapter associations\n        Object.keys(draft.assignedParticles).forEach(chapterId => {\n          draft.assignedParticles[chapterId] = draft.assignedParticles[chapterId].filter(id => id !== action.id);\n        });\n\n        // update lookup\n        Object.keys(draft.tweenParticleLookup).forEach(chapterId => {\n          delete draft.tweenParticleLookup[chapterId][ParticleIdUtils.getParticleIdRoot(action.id)];\n        });\n\n      })\n    );\n  }\n\n  @Action(ParticleActions.SelectParticleSystem)\n  selectParticleSystem(\n    context: StateContext<ParticlesStateModel>,\n    action: ParticleActions.SelectParticleSystem\n  ) {\n    context.patchState(\n      immer.produce(context.getState(), (draft: ParticlesStateModel) => {\n        draft.particleSelection = {\n          selectedParticle: action.id\n        };\n      })\n      \n    );\n  }\n\n  @Action(ParticleActions.SelectParticleConstraint)\n  selectParticleConstraint(\n    context: StateContext<ParticlesStateModel>,\n    action: ParticleActions.SelectParticleConstraint\n  ) {\n    const state  = context.getState();\n    const particleSelection = state.particleSelection;\n    context.patchState(\n      immer.produce(context.getState(), (draft: ParticlesStateModel) => {\n        draft.particleSelection = {\n          ...particleSelection,\n          selectedConstraint: action.index\n        };\n      })      \n    );\n  }\n\n  @Action(ParticleActions.SelectParticleCreator)\n  selectParticleCreator(\n    context: StateContext<ParticlesStateModel>,\n    action: ParticleActions.SelectParticleCreator\n  ) {\n    const state  = context.getState();\n    const particleSelection = state.particleSelection;\n    context.patchState(\n      immer.produce(context.getState(), (draft: ParticlesStateModel) => {\n        draft.particleSelection = {\n          ...particleSelection,\n          selectedCreator: action.index\n        };\n      })      \n    );\n  }\n\n  @Action(ParticleActions.SelectParticleUpdater)\n  selectParticleUpdater(\n    context: StateContext<ParticlesStateModel>,\n    action: ParticleActions.SelectParticleUpdater\n  ) {\n    const state  = context.getState();\n    const particleSelection = state.particleSelection;\n    context.patchState(\n      immer.produce(context.getState(), (draft: ParticlesStateModel) => {\n        draft.particleSelection = {\n          ...particleSelection,\n          selectedUpdater: action.index\n        };\n      })      \n    );\n  }\n\n  @Action(ParticleActions.UpdateTweenParticleLookupChapters)\n  updateTweenParticleLookupChapters(\n    context: StateContext<ParticlesStateModel>,\n    action: ParticleActions.UpdateTweenParticleLookupChapters\n  ) {\n    context.patchState(immer.produce(context.getState(), (draft: ParticlesStateModel) => {\n      draft.tweenParticleLookup = TweenParticleLookup.updateChapterIds(\n        draft.tweenParticleLookup,\n        action.chapterMap\n      );\n    }));\n  }\n\n\n  constructor() { }\n}\n","export class SetProgress {\n  static readonly type = '[Engine Progress] set progress';\n  constructor(public storyLoadProgress: number, public chunkLoadProgress: number) { }\n}\n","import { State, Store, Action, StateContext, Selector } from '@ngxs/store';\nimport { EngineProgressStateModel } from './engine.progress.state.model';\nimport { SetProgress } from './engine.progress.actions';\n\n\nconst initialState: EngineProgressStateModel = {\n  storyLoadProgress: 0,\n  chunkLoadProgress: 0\n};\n\n@State<EngineProgressStateModel>({\n  name: 'engineProgress',\n  defaults: initialState\n})\nexport class EngineProgressState {\n  constructor(private store: Store) {}\n\n\n  @Selector()\n  static getStoryLoadProgress(state: EngineProgressStateModel) {\n    return state.storyLoadProgress;\n  }\n\n  @Selector()\n  static getChunkLoadProgress(state: EngineProgressStateModel) {\n    return state.chunkLoadProgress;\n  }\n\n  @Action(SetProgress)\n  setProgress(context: StateContext<EngineProgressStateModel>, action: SetProgress) {\n    context.patchState({\n      storyLoadProgress: action.storyLoadProgress,\n      chunkLoadProgress: action.chunkLoadProgress\n    });\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { ChapterModel } from '../story/models/chapter.model';\nimport { TransitionModel } from '../story/models/transition.model';\nimport { Store } from '@ngxs/store';\nimport { get } from 'lodash';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class TransitionService {\n\n  constructor(\n    private store: Store\n  ) { }\n\n  chapterHasTransition(chapter: ChapterModel, isReverse?: boolean) {\n    const key = isReverse ? 'transitions.pre' : 'transitions.post';\n    const transition = get(chapter, key) as TransitionModel;\n\n    if (!transition) {\n      return false;\n    }\n\n    return isReverse ? transition.onPrevious : transition.onNext;\n  }\n\n  searchChapterTransitions(currentChapterId: string, targetChapterId: string, allChapters: ChapterModel[]) {\n    let chapters = [...allChapters];\n    let currentIndex = chapters.findIndex(chapter => chapter.id === currentChapterId);\n    let targetIndex = chapters.findIndex(chapter => chapter.id === targetChapterId);\n    const isReverse = targetIndex < currentIndex;\n\n    // When moving in reverse, flip the array so we iterate through it properly\n    if (isReverse) {\n      chapters = chapters.reverse();\n      currentIndex = chapters.findIndex(chapter => chapter.id === currentChapterId);\n      targetIndex = chapters.findIndex(chapter => chapter.id === targetChapterId);\n    }\n\n    // Stop if both chapters can't be found, or are identical\n    if (currentIndex < 0 || targetIndex < 0 || currentIndex === targetIndex) {\n      return null;\n    }\n    \n    // Get a range of chapters between current and target\n    // Find the next chapter with a valid and active transition in that direction\n    const transitionChapter = chapters\n      .slice(currentIndex, targetIndex)\n      .find(chapter => {\n        return this.chapterHasTransition(chapter, isReverse);\n      });\n\n    // If nothing is found, return null\n    if (!transitionChapter) {\n      return null;\n    } \n    \n    // Return the appropriate transition\n    return (isReverse) ? transitionChapter.transitions.pre : transitionChapter.transitions.post;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { Observable } from 'rxjs';\n\nimport { map } from 'rxjs/operators';\nimport { plainToClass } from 'class-transformer';\nimport { BookmarkModel } from '../bookmarks/models/bookmark.model';\n\nimport { StoryModel } from '../story/models/story.model';\nimport { siteNavigation } from '../shared/features/site-navigation/data/site-navigation';\nimport { getAllCategories } from '../shared/features/site-navigation/site-navigation-utils';\n\nconst webOnlyTags = ['live'];\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class ExploreService {\n\n  constructor(\n    private http: HttpClient\n  ) { }\n\n  search(\n    keyword: string = '',\n    tags: string[] = [],\n    lang: string = 'en'): Observable<BookmarkModel[]> {\n\n    // seperate keywords\n    const queryKeywords = keyword.split(/[ ]+/)\n      .join('+');\n\n    // quote seperate tags\n    const queryTags = webOnlyTags.concat(tags)\n      .filter(tag => tag !== '' && tag != null)\n      .map((tag) => `\"${tag}\"`)\n      .join('+');\n\n    return this.http.get(`/search?k=${queryKeywords}&t=${queryTags}&ol=${lang}&odns=true`)\n      .pipe(\n        map((result: any[]) => this.resultsToBookmarks(result))\n      );\n  }\n\n  searchInternal(\n    keyword = '',\n    directory = ''\n  ) {\n    return this.http.get(`/ws/search/internal?k=${keyword}&dir=${directory}`)\n      .pipe(\n        map((result: any[]) => this.resultsToBookmarks(result))\n      );\n  }\n\n  getAnatomyCategory(query: string, category: string, tags?: string[], lang?: string): Observable<BookmarkModel[]> {\n    return this.search(query, [category, ...tags], lang);\n  }\n\n  // get condition model search result\n  getConditionModel(id: string): Observable<BookmarkModel> {\n    const dbID = this.toDatabaseContentId(id);\n\n    return this.http.get(`/search/conditions?q=${dbID}`)\n      .pipe(\n        map((result: any[]) => this.resultsToBookmarks(result)),\n        map((bookmarks) => bookmarks[0])\n      );\n  }\n\n  private resultsToBookmarks(result: any[]): BookmarkModel[] {\n    result.forEach((bookmark) => {\n      bookmark.id = this.toAppContentId(bookmark.id);\n      bookmark.tour = bookmark.tags.indexOf('tour') >= 0;\n    });\n    return plainToClass(BookmarkModel, result);\n  }\n\n  // Bookmark category is currently embedded as a tag inside a string array, making it\n  // difficult to get to. This function checks for matches in the tags against the \n  // menu system and attempts to find match. \n  getBookmarkCategory(bookmark: BookmarkModel): string {\n    if (!bookmark.tags) {\n      return null;\n    }\n\n    const tags = siteNavigation.categories.map(category => category.id.toLocaleLowerCase());\n    return bookmark.tags.find(tag => tags.includes(tag.toLocaleLowerCase()));\n  }\n\n  getStoryCategory(story: StoryModel): string {\n    if (!story.tags) {\n      return null;\n    }\n\n    const tags = getAllCategories().map(category => category.id.toLocaleLowerCase());\n    return story.tags.find(tag => tags.includes(tag.toLocaleLowerCase()));\n  }\n\n  // Normalizes id to app formatted id (i.e., production/maleAdult/flu)\n  toAppContentId(id: string): string {\n    return id.replace('Condition.content.', '')\n      .replace('.json', '')\n      .split('.')\n      .join('/');\n  }\n\n  // Normalizes id to DB format (i.e., Condition.content.production.maleAdult.flu.json)\n  toDatabaseContentId(id: string): string {\n    if (!id.match('Condition.content')) {\n      const normalizedId = id.replace('.json', '').split('/').join('.');\n      return `Condition.content.${normalizedId}.json`;\n    } else {\n      return id;\n    }\n  }\n  \n}\n","<img\n*ngIf=\"organization$ | async as organization\"\nclass=\"gallery-banner\" \n[src]=\"organization.group_logos.default\">","import { Component, OnInit, ChangeDetectionStrategy } from '@angular/core';\nimport { Select } from '@ngxs/store';\nimport { OrganizationsState } from 'src/app/organizations/state/organizations.state';\nimport { Observable } from 'rxjs';\nimport { OrganizationModel } from 'src/app/organizations/models/organization.model';\n\n@Component({\n  selector: 'app-gallery-banner',\n  templateUrl: './gallery-banner.component.html',\n  styleUrls: ['./gallery-banner.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class GalleryBannerComponent implements OnInit {\n  @Select(OrganizationsState.getOrganization)\n  organization$: Observable<OrganizationModel>;\n\n  constructor() { }\n\n  ngOnInit() {\n  }\n\n}\n","<!-- Controls -->\n<div \n    class=\"gallery-bulk-actions\"\n    *ngIf=\"results && checkedResults\">\n    \n    <button\n        app-button\n        buttonTheme=\"light\"\n        *ngIf=\"checkedResults.length !== results.total\"\n        [uppercase]=\"false\"\n        (click)=\"handleSelectAllClick()\">\n        <div class=\"text-nowrap\">Select All</div>\n    </button>\n\n    <ng-container *ngIf=\"checkedResults.length\">\n        <app-divider class=\"mh-1\" *ngIf=\"checkedResults.length !== results.total && checkedResults.length\"></app-divider>\n        \n        <button\n            app-button\n            buttonTheme=\"light\"\n            [uppercase]=\"false\"\n            [matMenuTriggerFor]=\"selectionMenu\">\n            <span class=\"text-nowrap\">\n                {{ checkedResults.length }} Selected <app-icon icon=\"caret-down\"></app-icon>\n            </span>\n        </button>\n    </ng-container>\n\n    <app-divider *ngIf=\"checkedResults.length !== results.total\" class=\"mh-1\"></app-divider>\n\n    <mat-menu #selectionMenu=\"matMenu\">\n        <button mat-menu-item (click)=\"handleClearSelectionClick()\">Clear Selection</button>\n\n        <button mat-menu-item *ngFor=\"let action of (bulkActions$ | async)?.items\" (click)=\"handleActionClick(action)\">{{ action }}</button>\n    </mat-menu>\n</div>","import { Component, OnInit, ChangeDetectionStrategy, Input, Output, EventEmitter, ChangeDetectorRef } from '@angular/core';\nimport { GalleryState } from '../../state/gallery.state';\nimport { Observable, combineLatest } from 'rxjs';\nimport { BookmarkModel } from 'src/app/bookmarks/models/bookmark.model';\nimport { Select, Store } from '@ngxs/store';\nimport { BulkActions, BulkActionEvent } from '../../models/bulk-action';\nimport { GalleryActions } from '../../state/gallery.actions';\nimport { GalleryBulkActions } from '../../state/gallery.state.model';\nimport { isNil } from 'lodash';\nimport { filter } from 'rxjs/operators';\n\n@Component({\n  selector: 'app-gallery-bulk-actions',\n  templateUrl: './gallery-bulk-actions.component.html',\n  styleUrls: ['./gallery-bulk-actions.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class GalleryBulkActionsComponent implements OnInit {\n  @Select(GalleryState.getBulkActions)\n  bulkActions$: Observable<GalleryBulkActions>;\n\n  @Select(GalleryState.getFilteredResults)\n  results$: Observable<BookmarkModel[]>;\n\n  @Select(GalleryState.getCheckedResults)\n  checkedResults$: Observable<string[]>;\n\n  @Output()\n  bulkAction = new EventEmitter<BulkActionEvent>();\n\n\n  results: BookmarkModel[];\n  checkedResults: string[];\n\n  constructor(\n    private store: Store,\n    private changeDetectorRef: ChangeDetectorRef\n  ) { }\n\n  ngOnInit() {\n    combineLatest(\n      this.results$,\n      this.checkedResults$\n    ).pipe(\n      filter(([results, checkedResults]) => {\n        return !isNil(results) && !isNil(checkedResults);\n      })\n    ).subscribe(([results, checkedResults]) => {\n      this.results = results;\n      this.checkedResults = checkedResults;\n      this.changeDetectorRef.markForCheck();\n    });\n  }\n\n  handleSelectAllClick() {\n    this.store.dispatch(new GalleryActions.CheckAll());\n  }\n\n  handleClearSelectionClick() {\n    this.store.dispatch(new GalleryActions.SetCheckedItems([]));\n  }\n\n  handleActionClick(action: BulkActions) {\n    this.bulkAction.emit({\n      name: action,\n      ids: this.store.selectSnapshot(GalleryState.getCheckedResults)\n    });\n  }\n}\n","<div\n  class=\"gallery-card\"\n  [ngClass]=\"{\n    'gallery-card--checked': checked,\n    'gallery-card--list': (viewMode$ | async) === galleryViewMode.List,\n    'gallery-card--hover': menuOpen\n  }\"\n  (click)=\"handleSelect(bookmark)\"\n  data-test=\"galleryCard\">\n  \n  <div class=\"gallery-card__image-container\">\n    <div class=\"gallery-card__image\"\n      [defaultImage]=\"defaultImage\"\n      [lazyLoad]=\"bookmark.thumbnail_url\"></div>\n\n\n    <!-- Hover Element -->\n    <div class=\"gallery-card__hover\">\n      <div class=\"gallery-card__meta\">\n        <div *ngIf=\"bookmark.author\" data-test=\"galleryCardAuthor\">Created by {{ bookmark.author_first_name || bookmark.author }}</div>\n        <div *ngIf=\"bookmark.last_editor\">Updated by {{ bookmark.last_editor_first_name || bookmark.last_editor }} on {{ (bookmark.update_date_time || bookmark.create_date_time) | date:'shortDate' }}</div>\n      </div>\n\n      <div class=\"gallery-card__action\">\n        <ng-container *ngIf=\"upgradeRequired\">Go Premium</ng-container>\n        <ng-container *ngIf=\"!upgradeRequired\">\n          {{ label }}\n        </ng-container>\n      </div>\n\n      <div class=\"gallery-card__header\" appEventFence>\n        <div\n          class=\"flex flex-grow justify-start theme-ghost\" \n          *ngIf=\"(bulkActions$ | async)?.enabled\">\n          <mat-checkbox (change)=\"handleCheckedChange($event)\" [value]=\"bookmark.id\" [checked]=\"checked\"></mat-checkbox>\n        </div>\n\n        <div \n          *ngIf=\"(cardActions$ | async)?.enabled\"\n          class=\"flex flex-grow justify-end\">\n          <!-- Customize -->\n          <button\n            class=\"hide-md\"\n            app-button\n            (click)=\"handleBookmarkAction(bookmarkActionEnum.Edit, bookmark.id, bookmark)\"\n            *ngIf=\"canEdit\"\n            type=\"button\"\n            buttonShape=\"square\"\n            buttonTheme=\"dark\" \n            [matTooltip]=\"'Customize in ' + (application | titlecase)\">\n            <app-icon icon=\"pen\"></app-icon>\n          </button>\n\n          <!-- Add -->\n          <button\n            *ngIf=\"bookmarkAddActions.length\"\n            app-button\n            type=\"button\"\n            buttonShape=\"square\"\n            buttonTheme=\"dark\" \n            matTooltip=\"Add Model\"\n            (menuOpened)=\"handleMenuOpened()\"\n            (menuClosed)=\"handleMenuClosed()\"\n            [matMenuTriggerFor]=\"addMenu\">\n            <app-icon icon=\"plus\"></app-icon>\n          </button>\n\n          <!-- Other -->\n          <button\n            *ngIf=\"bookmarkOtherActions.length\"\n            app-button\n            type=\"button\"\n            buttonShape=\"square\"\n            buttonTheme=\"dark\" \n            matTooltip=\"More Options\"\n            (menuOpened)=\"handleMenuOpened()\"\n            (menuClosed)=\"handleMenuClosed()\"\n            [matMenuTriggerFor]=\"otherMenu\">\n            <app-icon icon=\"ellipsis-v\"></app-icon>\n          </button>\n        </div>\n      </div>\n    </div>\n\n\n  </div>\n  \n  <div class=\"gallery-card__actions\" *ngIf=\"!upgradeRequired\" appEventFence>\n    <mat-checkbox\n      class=\"gallery-card__inline-check\"\n      *ngIf=\"(bulkActions$ | async)?.enabled\"\n      (change)=\"handleCheckedChange($event)\"\n      [value]=\"bookmark.id\"\n      [checked]=\"checked\"></mat-checkbox>\n\n    <button\n      class=\"hide-md\"\n      *ngIf=\"canEdit\"\n      app-button\n      type=\"button\"\n      buttonShape=\"square\"\n      buttonTheme=\"light\" \n      (click)=\"handleBookmarkAction(bookmarkActionEnum.Edit, bookmark.id, bookmark)\"\n      [matTooltip]=\"'Customize in ' + (application | titlecase)\">\n      <app-icon icon=\"pen\"></app-icon>\n    </button>\n\n\n    <!-- Add -->\n    <button\n      *ngIf=\"bookmarkAddActions.length\"\n      app-button\n      type=\"button\"\n      buttonShape=\"square\"\n      buttonTheme=\"light\" \n      matTooltip=\"Add Model\"\n      [matMenuTriggerFor]=\"addMenu\">\n      <app-icon icon=\"plus\"></app-icon>\n    </button>\n\n    <!-- Other -->\n    <button\n      *ngIf=\"bookmarkOtherActions.length\"\n      app-button\n      type=\"button\"\n      buttonShape=\"square\"\n      buttonTheme=\"light\" \n      matTooltip=\"More Options\"\n      [matMenuTriggerFor]=\"otherMenu\">\n      <app-icon icon=\"ellipsis-v\"></app-icon>\n    </button>\n  </div>\n\n  <div class=\"gallery-card__label\" [attr.title]=\"bookmark.title\">{{ bookmark.title }}</div>\n\n  <div class=\"gallery-card__tags\">\n    <app-list listType=\"commafied\">\n        <!-- Premium -->\n        <app-list-item *ngIf=\"bookmark.premium && !(isPremiumUser$ | async)\">\n            <app-icon icon=\"lock\"></app-icon> Premium\n        </app-list-item>\n\n        <!-- View Only -->\n        <app-list-item *ngIf=\"!isViewOnly(bookmark)\">\n            View Only\n        </app-list-item>\n\n        <!-- Animated -->\n        <app-list-item *ngIf=\"bookmark.animated\">\n            Animated\n        </app-list-item>\n\n        <!-- Tour -->\n        <app-list-item *ngIf=\"bookmark.tour\">\n            Tour\n        </app-list-item>\n\n        <!-- Favorite -->\n        <app-list-item *ngIf=\"bookmark.favorite\">\n            Favorite\n        </app-list-item>\n    </app-list>\n  </div>\n\n  <div class=\"gallery-card__updated\">\n    {{ bookmark.last_editor_first_name || bookmark.last_editor || bookmark.author_first_name || bookmark.author }}, {{ (bookmark.update_date_time || bookmark.create_date_time) | date:'shortDate' }}\n  </div>\n</div>\n\n\n<mat-menu #addMenu=\"matMenu\">\n    <button \n      *ngFor=\"let bookmarkAction of bookmarkAddActions\"\n      mat-menu-item\n      (click)=\"handleBookmarkAction(bookmarkAction, bookmark.id, bookmark)\">\n      {{ bookmarkAction }}\n    </button>\n</mat-menu>\n\n<mat-menu #otherMenu=\"matMenu\">\n  <ng-container *ngFor=\"let bookmarkAction of bookmarkOtherActions\">\n    <mat-divider *ngIf=\"bookmarkAction === bookmarkActionEnum.Divider\"></mat-divider>\n\n    <button \n      *ngIf=\"bookmarkAction !== bookmarkActionEnum.Divider\"\n      mat-menu-item\n      (click)=\"handleBookmarkAction(bookmarkAction, bookmark.id, bookmark)\">\n      {{ bookmarkAction }}\n    </button>\n  </ng-container>\n</mat-menu>","import {\n  Component,\n  OnInit,\n  Input,\n  Output,\n  EventEmitter,\n  ChangeDetectionStrategy,\n  ChangeDetectorRef,\n  OnDestroy,\n} from '@angular/core';\nimport { MatCheckboxChange } from '@angular/material';\nimport { BookmarkModel } from 'src/app/bookmarks/models/bookmark.model';\nimport { AuthState } from 'src/app/auth/state/auth/auth.state';\nimport { Observable, BehaviorSubject, combineLatest, Subject } from 'rxjs';\nimport { Select, Store } from '@ngxs/store';\nimport { takeUntil, filter, take } from 'rxjs/operators';\nimport { isNil } from 'lodash';\nimport { GalleryActions } from 'src/app/gallery/state/gallery.actions';\nimport { GalleryState } from 'src/app/gallery/state/gallery.state';\nimport {\n  BookmarkAction,\n  BookmarkActionEvent,\n} from 'src/app/bookmarks/models/bookmark-action';\nimport {\n  GalleryCardActions,\n  GalleryBulkActions,\n} from 'src/app/gallery/state/gallery.state.model';\nimport { GalleryViewMode } from 'src/app/gallery/models/gallery-view-mode.enum';\nimport { BookmarksService } from 'src/app/bookmarks/bookmarks.service';\nimport { BookmarkActionsService } from 'src/app/bookmarks/bookmark-actions.service';\nimport { BreakpointObserver } from '@angular/cdk/layout';\nimport { environment } from 'src/environments/environment';\n\n@Component({\n  selector: 'app-gallery-card',\n  templateUrl: './gallery-card.component.html',\n  styleUrls: ['./gallery-card.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class GalleryCardComponent implements OnInit, OnDestroy {\n  application = environment.application;\n  bookmarkActionEnum = BookmarkAction;\n  galleryViewMode = GalleryViewMode;\n  upgradeRequired = false;\n  canEdit = false;\n  menuOpen = false;\n\n  @Select(AuthState.isPremiumUser)\n  isPremiumUser$: Observable<boolean>;\n\n  @Select(AuthState.isPrivateUser)\n  isPrivate$: Observable<boolean>;\n\n  @Select(GalleryState.getCheckedResults)\n  checkedResults$: Observable<string[]>;\n\n  @Select(GalleryState.getBulkActions)\n  bulkActions$: Observable<GalleryBulkActions>;\n\n  @Select(GalleryState.getCardActions)\n  cardActions$: Observable<GalleryCardActions>;\n\n  @Select(GalleryState.getViewMode)\n  viewMode$: Observable<GalleryViewMode>;\n\n  get bookmarkOtherActions(): BookmarkAction[] {\n    return this._bookmarkOtherActions.value;\n  }\n  set bookmarkOtherActions(value: BookmarkAction[]) {\n    this._bookmarkOtherActions.next(value);\n  }\n  private _bookmarkOtherActions = new BehaviorSubject<BookmarkAction[]>([]);\n\n  get bookmarkAddActions(): BookmarkAction[] {\n    return this._bookmarkAddActions.value;\n  }\n  set bookmarkAddActions(value: BookmarkAction[]) {\n    this._bookmarkAddActions.next(value);\n  }\n  private _bookmarkAddActions = new BehaviorSubject<BookmarkAction[]>([]);\n\n  @Input()\n  public get bookmark(): BookmarkModel {\n    return this._bookmark.value;\n  }\n  public set bookmark(value: BookmarkModel) {\n    this._bookmark.next(value);\n    this.changeDetectorRef.markForCheck();\n  }\n  private _bookmark = new BehaviorSubject<BookmarkModel>(null);\n\n  @Input()\n  selectLabel = 'Select';\n\n  @Input()\n  selectLabelPlural = '';\n\n  @Input()\n  checkable = false;\n  checked = false;\n\n  @Output()\n  selectBookmark = new EventEmitter<BookmarkModel>();\n\n  @Output()\n  bookmarkAction = new EventEmitter<BookmarkActionEvent>();\n\n  ngUnsubscribe = new Subject();\n  defaultImage = '/assets/images/card-thumbnail-placeholder.png';\n  label = '';\n\n  constructor(\n    private changeDetectorRef: ChangeDetectorRef,\n    private store: Store,\n    private bookmarksService: BookmarksService,\n    private bookmarkActionsService: BookmarkActionsService,\n    private breakpiontObserver: BreakpointObserver\n  ) {}\n\n  ngOnInit() {\n    this.checkPermissions();\n    this.checkLabel();\n    this.observeChecked();\n  }\n\n  ngOnDestroy() {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n  isViewOnly(result: BookmarkModel) {\n    return this.bookmarksService.canEdit(result);\n  }\n\n  handleSelect(result: BookmarkModel) {\n    this.selectBookmark.emit(result);\n  }\n\n  handleCheckedChange(event: MatCheckboxChange) {\n    this.store.dispatch(\n      new GalleryActions.CheckItem(event.source.value, event.checked)\n    );\n  }\n\n  handleBookmarkAction(cardAction: BookmarkAction, id: string, data: any) {\n    this.bookmarkAction.emit({ name: cardAction, id: id, bookmark: data });\n  }\n\n  handleMenuOpened() {\n    this.menuOpen = true;\n  }\n\n  handleMenuClosed() {\n    this.menuOpen = false;\n  }\n\n  observeChecked() {\n    this.checkedResults$\n      .pipe(takeUntil(this.ngUnsubscribe))\n      .subscribe((results) => {\n        this.checked = results.indexOf(this.bookmark.id) > -1;\n        this.changeDetectorRef.markForCheck();\n      });\n  }\n\n  checkPermissions() {\n    combineLatest(\n      this._bookmark,\n      this.isPremiumUser$,\n      this.isPrivate$,\n      this.breakpiontObserver.observe('(max-width: 959px)')\n    )\n    .pipe(\n      filter(\n        ([bookmark, isPremiumUser, isPrivateUser]) =>\n          !isNil(bookmark) && !isNil(isPremiumUser) && !isNil(isPrivateUser)\n      ),\n      takeUntil(this.ngUnsubscribe)\n    )\n    .subscribe(([bookmark, isPremiumUser, isPrivateUser, breakpoint]) => {\n      this.upgradeRequired = !isPremiumUser && bookmark.premium === true;\n\n      // Seperate add actions\n      this.bookmarkAddActions = this.bookmarkActionsService.getBookmarkActions(\n        bookmark,\n        isPremiumUser,\n        isPrivateUser,\n        {\n          includeActions: [\n            BookmarkAction.AddToMyModels, \n            BookmarkAction.AddToTeamModels\n          ]\n        });\n\n      // Never show edit or manage on smaller screens\n      this.bookmarkOtherActions = this.bookmarkActionsService.getBookmarkActions(\n        bookmark,\n        isPremiumUser,\n        isPrivateUser,\n        {\n          excludeActions: [\n            BookmarkAction.View,\n            BookmarkAction.Edit,\n            BookmarkAction.AddToMyModels, \n            BookmarkAction.AddToTeamModels,\n            ...(breakpoint.matches) ? [BookmarkAction.Edit, BookmarkAction.Manage] : []\n          ]\n        }\n      );\n\n      // Check if content can be edited\n      this.canEdit = this.bookmarkActionsService.canEdit(bookmark, isPremiumUser);\n\n      this.changeDetectorRef.markForCheck();\n    });\n  }\n\n  checkLabel() {\n    this._bookmark\n      .pipe(\n        takeUntil(this.ngUnsubscribe),\n        filter((bookmark) => bookmark != null)\n      ).subscribe((bookmark) => {\n        this.label = (bookmark.tour && this.selectLabelPlural) ? this.selectLabelPlural : this.selectLabel;\n        this.changeDetectorRef.markForCheck();\n      });\n  }\n}\n","<div\n  class=\"gallery-cards\"\n  [ngClass]=\"{'gallery-cards--list': (viewMode$ | async) === galleryViewMode.List}\">\n\n  <div class=\"gallery-cards__content\">\n\n    <app-gallery-card\n      class=\"gallery-cards__item\"\n      *ngFor=\"let item of results.items; trackBy: trackCard\"\n      (bookmarkAction)=\"handleBookmarkAction($event)\"\n      [selectLabel]=\"selectLabel\"\n      [selectLabelPlural]=\"selectLabelPlural\"\n      (selectBookmark)=\"handleSelect($event)\"\n      [bookmark]=\"item\">\n    </app-gallery-card>\n    \n  </div>\n</div>","import { \n  Component,\n  OnInit,\n  Input,\n  ChangeDetectionStrategy,\n  Output,\n  EventEmitter,\n  ViewEncapsulation } from '@angular/core';\nimport { BookmarkModel } from 'src/app/bookmarks/models/bookmark.model';\nimport { BookmarkActionEvent } from 'src/app/bookmarks/models/bookmark-action';\nimport { GalleryViewMode } from 'src/app/gallery/models/gallery-view-mode.enum';\nimport { Select } from '@ngxs/store';\nimport { GalleryState } from 'src/app/gallery/state/gallery.state';\nimport { Observable } from 'rxjs';\nimport { GalleryResultsModel } from 'src/app/gallery/models/gallery-results.model';\n\n@Component({\n  selector: 'app-gallery-cards',\n  templateUrl: './gallery-cards.component.html',\n  styleUrls: ['./gallery-cards.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None\n})\nexport class GalleryCardsComponent implements OnInit {\n  galleryViewMode = GalleryViewMode;\n\n  @Select(GalleryState.getViewMode)\n  viewMode$: Observable<GalleryViewMode>;\n\n  @Output()\n  bookmarkAction = new EventEmitter<BookmarkActionEvent>();\n\n  @Input()\n  selectLabel = 'Select';\n\n  @Input()\n  selectLabelPlural = 'Select';\n\n  @Input()\n  public get results(): GalleryResultsModel {\n    return this._results;\n  }\n  public set results(value: GalleryResultsModel) {\n    this._results = value;\n  }\n  private _results: GalleryResultsModel;\n\n  @Input()\n  checkable = false;\n\n  @Input()\n  checkedResults: string[] = [];\n\n  @Output()\n  selectBookmark = new EventEmitter<BookmarkModel>();\n\n\n  constructor() { }\n\n  ngOnInit() {\n  }\n\n  handleSelect(result: BookmarkModel) {\n    this.selectBookmark.emit(result);\n  }\n\n  handleBookmarkAction(bookmarkAction: BookmarkActionEvent) {\n    this.bookmarkAction.emit(bookmarkAction);\n  }\n\n  isChecked(id: string) {\n    return this.checkedResults.indexOf(id) >= 0;\n  }\n\n  trackCard(result: any) {\n    return result.id;\n  }\n}\n","<app-navigation-panel label=\"Category\" [collapsible]=\"true\">\n    <app-navigation-list-container>\n        <nav>\n            <a \n                *ngFor=\"let category of categories\"\n                app-navigation-list-item\n                [selected]=\"category.id === categoryId\"\n                (click)=\"handleSelectCategory(category.id)\">\n                <div class=\"gallery-categories__item\">\n                    <app-category-image\n                        class=\"gallery-categories__image\"\n                        [color]=\"category.id === categoryId ? 'color' : 'mono'\"\n                        [category]=\"category.id\"></app-category-image>\n                    <div class=\"gallery-categories__title\">{{ category.title }}</div>\n                </div>\n            </a>\n        </nav>\n    </app-navigation-list-container>\n</app-navigation-panel>\n","import {\n  Component,\n  OnInit,\n  ChangeDetectionStrategy,\n  OnDestroy,\n  ChangeDetectorRef,\n  Output,\n  EventEmitter,\n} from '@angular/core';\nimport { SiteCategory } from 'src/app/shared/features/site-navigation/models/site-category.model';\nimport { Select } from '@ngxs/store';\nimport { GalleryState } from '../../state/gallery.state';\nimport { Observable, Subject } from 'rxjs';\nimport {\n  SearchConfigUnion,\n  CategorySearchConfig,\n  CommunitySearchConfig,\n} from '../../models/search-config';\nimport { takeUntil, distinctUntilChanged, filter } from 'rxjs/operators';\nimport { SearchType } from '../../models/search-type.enum';\nimport {\n  translateCategories,\n  getAllCategories,\n} from 'src/app/shared/features/site-navigation/site-navigation-utils';\nimport { AuthState } from 'src/app/auth/state/auth/auth.state';\nimport { isNil } from 'lodash';\n\n@Component({\n  selector: 'app-gallery-categories',\n  templateUrl: './gallery-categories.component.html',\n  styleUrls: ['./gallery-categories.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class GalleryCategoriesComponent implements OnInit, OnDestroy {\n  categories: SiteCategory[] = [];\n\n  @Select(GalleryState.getSearchConfig)\n  searchConfig$: Observable<SearchConfigUnion>;\n\n  @Select(AuthState.getUserLanguage)\n  language$: Observable<string>;\n\n  @Output()\n  categorySelected = new EventEmitter<string>();\n\n  categoryId: string;\n  ngUnsubscribe = new Subject();\n\n  constructor(private changeDetectorRef: ChangeDetectorRef) {}\n\n  ngOnInit() {\n    this.initCategories();\n    this.observeCategoryId();\n  }\n\n  ngOnDestroy() {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n  initCategories() {\n    this.language$\n      .pipe(distinctUntilChanged(), takeUntil(this.ngUnsubscribe))\n      .subscribe((language) => {\n        const categories = getAllCategories();\n        this.categories = translateCategories(categories, language);\n      });\n  }\n\n  handleSelectCategory(categoryId: string) {\n    this.categorySelected.emit(categoryId);\n  }\n\n  observeCategoryId() {\n    this.searchConfig$\n      .pipe(\n        takeUntil(this.ngUnsubscribe),\n        filter(\n          (config) =>\n            !isNil(config) &&\n            (config.type === SearchType.Category || config.type === SearchType.Community)\n        )\n      )\n      .subscribe((config: CategorySearchConfig | CommunitySearchConfig) => {\n        this.categoryId = config.categoryId;\n        this.changeDetectorRef.markForCheck();\n      });\n  }\n}\n","<app-navigation-panel label=\"Clients\" [collapsible]=\"true\">\n    <app-navigation-list-container>\n        <nav>\n            <a \n                *ngFor=\"let client of clients\"\n                app-navigation-list-item\n                [selected]=\"client === selectedClient\"\n                (click)=\"handleSelectClient(client)\">\n                {{ client | humanize }}\n            </a>\n        </nav>\n    </app-navigation-list-container>\n</app-navigation-panel>\n","import { Component, OnInit, ChangeDetectionStrategy, ChangeDetectorRef, Output, EventEmitter, OnDestroy } from '@angular/core';\nimport { ModulesService } from 'src/app/modules/modules.service';\nimport { compact, get } from 'lodash';\nimport { map, takeUntil } from 'rxjs/operators';\nimport { Select } from '@ngxs/store';\nimport { GalleryState } from '../../state/gallery.state';\nimport { Observable, Subject } from 'rxjs';\nimport { SearchConfigUnion } from '../../models/search-config';\nimport { SearchType } from '../../models/search-type.enum';\n\n@Component({\n  selector: 'app-gallery-clients',\n  templateUrl: './gallery-clients.component.html',\n  styleUrls: ['./gallery-clients.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class GalleryClientsComponent implements OnInit, OnDestroy {\n  clients = [];\n  selectedClient = '';\n  ngUnsubscribe = new Subject();\n  \n  @Select(GalleryState.getSearchConfig)\n  searchConfig$: Observable<SearchConfigUnion>;\n\n  @Output()\n  clientSelected = new EventEmitter<string>();\n\n  constructor(\n    private modulesService: ModulesService,\n    private changeDetectorRef: ChangeDetectorRef\n  ) { }\n\n  ngOnInit() {\n    this.initClients();\n    this.observeClient();\n  }\n\n  ngOnDestroy() {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n  initClients() {\n    this.modulesService.getClients()\n      .pipe(\n        map(results => compact(results))  \n      )\n      .subscribe(results => {\n        this.clients = results;\n        this.changeDetectorRef.markForCheck();\n      });\n  }\n\n  handleSelectClient(client: string) {\n    this.clientSelected.emit(client);\n  }\n\n  observeClient() {\n    this.searchConfig$\n      .pipe(\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(config => {\n        if (config.type === SearchType.Internal) {\n          const parts = config.directory.split('/');\n          this.selectedClient = '';\n\n          if (parts[0] === 'client' && parts.length === 2) {\n            this.selectedClient = parts[1];\n          }\n\n          this.changeDetectorRef.markForCheck();\n        }\n      });\n  }\n\n}\n","<app-navigation-panel [collapsible]=\"false\">\n\n    <div app-navigation-panel-title *ngIf=\"showBanner\">\n        <div class=\"gallery-collections__header\">\n            <app-gallery-banner style=\"max-width: 200px; height: 32px\"></app-gallery-banner>\n        </div>\n    </div>\n\n    <app-navigation-list-container>\n        <nav>\n            <a\n                app-navigation-list-item\n                data-test=\"galleryMyModels\"\n                [selected]=\"(searchType$ | async) === searchType.Private\"\n                (click)=\"handleSelectPrivate()\">\n                My Models\n            </a>\n\n            <a\n                app-navigation-list-item\n                data-test=\"galleryAllTeamModels\"\n                [selected]=\"(searchType$ | async) === searchType.Organization\"\n                (click)=\"handleSelectAll()\">\n                All Team Models\n            </a>\n          <a\n\n                app-navigation-list-item\n                data-test=\"galleryCollectionItem\"\n                [attr.data-id]=\"collection.collection_id\"\n                *ngFor=\"let collection of (collections$ | async)\"\n                [selected]=\"collection.collection_id === collectionId\"\n                (click)=\"handleSelectCollection(collection.collection_id)\">\n                {{ collection.collection_name }}\n            </a>\n        </nav>\n    </app-navigation-list-container>\n</app-navigation-panel>\n","import { Component, OnInit, ChangeDetectionStrategy, OnDestroy, ChangeDetectorRef } from '@angular/core';\nimport { Select, Store } from '@ngxs/store';\nimport { OrganizationsState } from 'src/app/organizations/state/organizations.state';\nimport { Observable, Subject } from 'rxjs';\nimport { CollectionModel } from 'src/app/organizations/models/collection.model';\nimport { OrganizationModel } from 'src/app/organizations/models/organization.model';\nimport { takeUntil, filter } from 'rxjs/operators';\nimport { GetCollections } from 'src/app/organizations/state/organizations.actions';\nimport { isNil } from 'lodash';\nimport { OrganizationSearchConfig, SearchConfigUnion, PrivateSearchConfig, CollectionSearchConfig } from '../../models/search-config';\nimport { GalleryActions } from '../../state/gallery.actions';\nimport { GalleryState } from '../../state/gallery.state';\nimport { SearchType } from '../../models/search-type.enum';\nimport { AuthState } from 'src/app/auth/state/auth/auth.state';\n\n@Component({\n  selector: 'app-gallery-collections',\n  templateUrl: './gallery-collections.component.html',\n  styleUrls: ['./gallery-collections.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class GalleryCollectionsComponent implements OnInit, OnDestroy {\n  @Select(OrganizationsState.getOrganization)\n  organization$: Observable<OrganizationModel>;\n\n  @Select(OrganizationsState.getCollections)\n  collections$: Observable<CollectionModel[]>;\n\n  @Select(GalleryState.getSearchConfig)\n  searchConfig$: Observable<SearchConfigUnion>;\n\n  @Select(GalleryState.getSearchType)\n  searchType$: Observable<SearchType>;\n\n  showBanner = true;\n  searchType = SearchType;\n  collectionId: number;\n  ngUnsubscribe = new Subject();\n\n  constructor(\n    private store: Store,\n    private changeDetectorRef: ChangeDetectorRef\n  ) { }\n\n  ngOnInit() {\n    this.observeCollections();\n    this.observeSearchConfig();\n  }\n\n  ngOnDestroy() {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n  observeCollections() {\n    // Update collections when organization updates\n    this.organization$\n      .pipe(\n        filter(organization => !isNil(organization)),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe((organization) => {\n        if (organization) {\n          this.store.dispatch(new GetCollections(organization.id));\n        }\n      });\n  }\n\n  observeSearchConfig() {\n    this.searchConfig$\n      .pipe(\n        filter(config => !isNil(config)),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(config => {\n        // Keep local collectionId up to date for navigation highlighting\n        this.collectionId = (config.type === SearchType.Collection) ? config.collectionId : null;\n\n        // Only show organization banner when searching bookmarks\n        this.showBanner = config.type === SearchType.Collection\n          || config.type === SearchType.Organization\n          || (config.type === SearchType.Private && !this.store.selectSnapshot(AuthState.isPrivateUser));\n\n        this.changeDetectorRef.markForCheck();\n      });\n  }\n\n  handleSelectCollection(collectionId: number) {\n    const config = new CollectionSearchConfig(\n      this.store.selectSnapshot(OrganizationsState.getOrganization).id,\n      collectionId\n    );\n\n    this.store.dispatch(new GalleryActions.SetSearchConfig(config));\n  }\n\n  handleSelectAll() {\n    const config = new OrganizationSearchConfig(\n      this.store.selectSnapshot(OrganizationsState.getOrganization).id\n    );\n    this.store.dispatch(new GalleryActions.SetSearchConfig(config));\n  }\n\n  handleSelectPrivate() {\n    const config = new PrivateSearchConfig();\n    this.store.dispatch(new GalleryActions.SetSearchConfig(config));\n  }\n}\n","<div class=\"gallery\" [ngClass]=\"{'gallery--small': isSmall}\">\n  <mat-sidenav-container class=\"gallery__container\" #sidenavContainer>\n    <!-- Filters -->\n    <mat-sidenav \n      #sidenav \n      class=\"gallery__sidenav\"\n      [autoFocus]=\"false\"\n      [fixedInViewport]=\"isSmall\" \n      fixedTopGap=\"56\"\n      [position]=\"isSmall ? 'start' : 'start'\"\n      [opened]=\"(sideNav$ | async)?.open && (sideNav$ | async)?.enabled\"\n      [mode]=\"isSmall ? 'push' : 'side'\">\n\n      \n      <!-- Studio -->\n      <ng-container *ngIf=\"application === applicationEnum.Studio\">\n        <!-- Source -->\n        <app-gallery-source *ngIf=\"showSourcePicker\"></app-gallery-source>\n\n        <!-- Private / Organizations / Collections -->\n        <ng-container *ngIf=\"contentType === contentTypeEnum.Bookmark\">\n          <app-gallery-collections></app-gallery-collections>\n        </ng-container>\n\n        <!-- Categories -->\n        <ng-container *ngIf=\"contentType === contentTypeEnum.Module\">\n          <app-gallery-categories (categorySelected)=\"handleCategorySelected($event)\"></app-gallery-categories>\n\n          <ng-container *ngIf=\"(searchType$ | async) === searchTypeEnum.Category\">\n            <!-- Tag Groups -->\n            <app-gallery-tags-single\n              *ngFor=\"let tagGroup of tagGroups\"\n              [selectedTag]=\"activeTags[tagGroup.title]\"\n              (selectedTagChange)=\"handleSelectedTagChange(tagGroup.title, $event)\"\n              [label]=\"tagGroup.title\"\n              [tags]=\"tagGroup.tags\"></app-gallery-tags-single>\n\n            <!-- Awaiting multi-tag support -->\n            <!-- <app-gallery-tags-multiple\n              *ngFor=\"let tagGroup of tagGroups\"\n              [label]=\"tagGroup.title\"\n              [tags]=\"tagGroup.tags\"\n              [selectedTags]=\"activeTags[tagGroup.title]\"\n              (selectedTagsChange)=\"handleSelectedTagsChange(tagGroup.title, $event)\"></app-gallery-tags-multiple> -->\n          </ng-container>\n        </ng-container>\n\n        <!-- Internal -->\n        <ng-container *ngIf=\"contentType === contentTypeEnum.Internal\">\n          <app-gallery-clients (clientSelected)=\"handleClientSelected($event)\"></app-gallery-clients>\n        </ng-container>\n      </ng-container>\n\n      <!-- Loft -->\n      <ng-container *ngIf=\"application === applicationEnum.Loft\">\n        <app-gallery-filters-loft (configChange)=\"handleLoftConfigChange($event)\"></app-gallery-filters-loft>\n      </ng-container>\n    </mat-sidenav>\n\n    <!-- Results -->\n    <mat-sidenav-content #content>\n      <div class=\"gallery__to-top\" *ngIf=\"showScrollTo\">\n        <button type=\"button\" app-button buttonTheme=\"light\" buttonType=\"info\" buttonShape=\"rounded\" (click)=\"scrollToTop()\">\n          <app-icon icon=\"arrow-circle-up\"></app-icon> Back to Top\n        </button>\n      </div>\n\n      <div class=\"gallery__content theme-light\">\n        <div class=\"gallery__header\">\n          <app-gallery-header (bulkAction)=\"handleBulkAction($event)\"></app-gallery-header>\n        </div>\n      \n        <div class=\"gallery__results\">\n          <app-gallery-results\n            (bookmarkAction)=\"handleAction($event)\"\n            [viewMode]=\"viewMode\"\n            [loading]=\"loading$ | async\"\n            [selectLabel]=\"selectLabel\"\n            [selectLabelPlural]=\"selectLabelPlural\"\n            [results]=\"results$ | async\"\n            [checkedResults]=\"checkedResults$ | async\"\n            (selectBookmark)=\"handleSelect($event)\">\n          </app-gallery-results>\n        </div>\n      </div>\n    </mat-sidenav-content>\n  </mat-sidenav-container>\n</div>\n","import {\n  Component,\n  OnInit,\n  ChangeDetectionStrategy,\n  Output,\n  EventEmitter,\n  Input,\n  ChangeDetectorRef,\n  OnDestroy,\n  ViewChild,\n  AfterViewInit,\n} from '@angular/core';\nimport { Store, Select } from '@ngxs/store';\nimport {\n  GalleryViewMode,\n  GalleryViewModeDefault,\n} from '../../models/gallery-view-mode.enum';\nimport { BookmarkModel } from 'src/app/bookmarks/models/bookmark.model';\nimport { GalleryState } from '../../state/gallery.state';\nimport { Observable, Subject, fromEvent } from 'rxjs';\nimport { EnvironmentApplication } from 'src/environments/models/environment-application';\nimport {\n  CategorySearchConfig,\n  SearchConfigUnion,\n  InternalSearchConfig,\n  LoftSearchConfig,\n  CommunitySearchConfig,\n} from '../../models/search-config';\nimport { GalleryActions } from '../../state/gallery.actions';\nimport { environment } from 'src/environments/environment';\nimport { BreakpointObserver } from '@angular/cdk/layout';\nimport {\n  MatSidenav,\n  MatSidenavContent,\n  MatSidenavContainer,\n} from '@angular/material';\nimport {\n  takeUntil,\n  distinctUntilChanged,\n  debounceTime,\n  filter,\n  map,\n} from 'rxjs/operators';\nimport {\n  tagsLevelOfDetail,\n  tagCategories,\n  tagsTypes,\n} from 'src/app/bookmarks/data/tags';\nimport { flatten, isEqual, get } from 'lodash';\nimport { plainToClass } from 'class-transformer';\nimport { GalleryResultsModel } from '../../models/gallery-results.model';\nimport { ContentType } from 'src/app/story/models/content-type.enum';\nimport { GallerySidenav } from '../../state/gallery.state.model';\nimport { BookmarkActionEvent } from '../../../bookmarks/models/bookmark-action';\nimport { BulkActionEvent } from '../../models/bulk-action';\nimport { SearchType } from '../../models/search-type.enum';\nimport { trigger, transition, style, animate } from '@angular/animations';\n\n@Component({\n  selector: 'app-gallery-container',\n  templateUrl: './gallery-container.component.html',\n  styleUrls: ['./gallery-container.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  animations: [\n    trigger('inFromBottom', [\n      transition(':enter', [\n        style({\n          transform: 'translateY(100%)',\n        }),\n        animate(\n          '250ms ease-out',\n          style({\n            transform: '*',\n          })\n        ),\n      ]),\n      transition(':leave', [\n        animate(\n          '250ms ease-out',\n          style({\n            transform: 'translateX(100%)',\n          })\n        ),\n      ]),\n    ]),\n  ],\n})\nexport class GalleryContainerComponent\n  implements OnInit, AfterViewInit, OnDestroy {\n  applicationEnum = EnvironmentApplication;\n  contentTypeEnum = ContentType;\n  searchTypeEnum = SearchType;\n\n  @ViewChild(MatSidenavContainer, { static: true, read: MatSidenavContainer })\n  sidenavContainer: MatSidenavContainer;\n\n  @ViewChild('sidenav', { static: true, read: MatSidenav })\n  sidenav: MatSidenav;\n\n  @ViewChild('content', { static: false, read: MatSidenavContent })\n  content: MatSidenavContent;\n\n  @Select(GalleryState.getFilteredResults)\n  results$: Observable<GalleryResultsModel>;\n\n  @Select(GalleryState.getCheckedResults)\n  checkedResults$: Observable<string[]>;\n\n  @Select(GalleryState.getLoading)\n  loading$: Observable<boolean>;\n\n  @Select(GalleryState.getSearchConfig)\n  searchConfig$: Observable<SearchConfigUnion>;\n\n  @Select(GalleryState.getSearchType)\n  searchType$: Observable<SearchType>;\n\n  @Select(GalleryState.getSearchOptions)\n  searchOptions$: Observable<SearchConfigUnion>;\n\n  @Select(GalleryState.getSidenav)\n  sideNav$: Observable<GallerySidenav>;\n\n  @Input()\n  application: EnvironmentApplication.Studio | EnvironmentApplication.Loft =\n    EnvironmentApplication.Studio;\n\n  @Input()\n  contentType: ContentType = ContentType.Bookmark;\n\n  @Input()\n  viewMode = GalleryViewMode.Card;\n\n  @Input()\n  selectLabel = 'Select';\n\n  @Input()\n  selectLabelPlural = 'Select';\n\n  @Input()\n  showSourcePicker = false;\n\n  @Input()\n  lazyLoadThreshold = 480;\n\n  @Input()\n  lazyLoadCount = 12;\n\n  activeTags: { [key: string]: string } = {};\n  activeConfig: SearchConfigUnion;\n\n  @Output()\n  selectBookmark = new EventEmitter<BookmarkModel>();\n\n  @Output()\n  bookmarkAction = new EventEmitter<BookmarkActionEvent>();\n\n  @Output()\n  bulkAction = new EventEmitter<BulkActionEvent>();\n\n  ngUnsubscribe = new Subject();\n  isSmall = true;\n  showScrollTo = false;\n\n  tagGroups = [tagsTypes, tagsLevelOfDetail];\n\n  constructor(\n    private changeDetectorRef: ChangeDetectorRef,\n    private store: Store,\n    public breakpointObserver: BreakpointObserver\n  ) {}\n\n  ngOnInit() {\n    this.initBreakpointObserver();\n    this.initSearchConfigObserver();\n  }\n\n  ngAfterViewInit() {\n    this.store\n      .select(GalleryState.getSidenav)\n      .pipe(takeUntil(this.ngUnsubscribe))\n      .subscribe((sidenav) => {\n        this.toggleSidenav(sidenav.open && sidenav.enabled);\n      });\n\n    this.initLazyLoadObserver();\n    this.initScrollObserver();\n  }\n\n  ngOnDestroy() {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n  initSearchConfigObserver() {\n    this.searchConfig$\n      .pipe(\n        takeUntil(this.ngUnsubscribe),\n        filter((config) => config != null),\n        distinctUntilChanged((previousConfig, nextConfig) => {\n          return isEqual(previousConfig, nextConfig);\n        }),\n        debounceTime(100)\n      )\n      .subscribe((searchConfig) => {\n        // Tags come in as a single string array and must be filtered into their component appropriate groups\n        if (searchConfig.type === SearchType.Category) {\n          // Reset Tags, currently disabled\n          tagCategories.forEach((tagGroup) => {\n            this.activeTags[tagGroup.title] = '';\n          });\n\n          searchConfig.tags.forEach((tag) => {\n            const groupId = this.getTagGroup(tag);\n\n            // -- Single tag solution\n            this.activeTags[groupId] = tag;\n\n            // -- Reactivate this code once we have multi-tag solution support\n            // this.activeTags[groupId] = this.activeTags[groupId] || [];\n            // this.activeTags[groupId].push(tag);\n          });\n        }\n\n        // Reset page count\n        const options = this.store.selectSnapshot(\n          GalleryState.getSearchOptions\n        );\n        \n        this.store.dispatch(\n          new GalleryActions.SetSearchOptions({\n            ...options,\n            offset: 0,\n          })\n        );\n\n        this.changeDetectorRef.markForCheck();\n\n        this.search();\n      });\n  }\n\n  initBreakpointObserver() {\n    this.breakpointObserver\n      .observe('(max-width: 959px)')\n      .pipe(takeUntil(this.ngUnsubscribe))\n      .subscribe((result) => {\n        this.isSmall = result.matches;\n\n        // Hide the sidenav on smaller resolutions\n        const sidenav = this.store.selectSnapshot(GalleryState.getSidenav);\n        this.store.dispatch(\n          new GalleryActions.SetSidenav({\n            ...sidenav,\n            open: !this.isSmall,\n          })\n        );\n\n        // Disable list view on smaller resolutions\n        this.store.dispatch(\n          new GalleryActions.SetViewMode(GalleryViewModeDefault)\n        );\n\n        this.changeDetectorRef.markForCheck();\n      });\n  }\n\n  initLazyLoadObserver() {\n    fromEvent(this.content.getElementRef().nativeElement, 'scroll')\n      .pipe(takeUntil(this.ngUnsubscribe), debounceTime(50))\n      .subscribe(() => {\n        const content = this.content.getElementRef().nativeElement;\n        const scrollBottom = content.scrollTop + content.offsetHeight;\n\n        if (content.scrollHeight - scrollBottom <= this.lazyLoadThreshold) {\n          const options = this.store.selectSnapshot(\n            GalleryState.getSearchOptions\n          );\n          options.pageSize += this.lazyLoadCount;\n          this.store.dispatch(new GalleryActions.SetSearchOptions(options));\n        }\n      });\n  }\n\n  initScrollObserver() {\n    this.sidenavContainer.scrollable\n      .elementScrolled()\n      .pipe(\n        takeUntil(this.ngUnsubscribe),\n        map((event: any) => {\n          return event.srcElement.scrollTop > window.innerHeight;\n        }),\n        distinctUntilChanged()\n      )\n      .subscribe((showScrollTo: boolean) => {\n        this.showScrollTo = showScrollTo;\n        this.changeDetectorRef.markForCheck();\n      });\n  }\n\n  handleSelect(result: BookmarkModel) {\n    this.selectBookmark.emit(result);\n  }\n\n  handleCategorySelected(categoryId: string) {\n    // Community is included as part of categories, but has a separate endpoints\n    const config: SearchConfigUnion =\n      categoryId === 'public'\n        ? new CommunitySearchConfig('')\n        : new CategorySearchConfig(categoryId);\n\n    this.store.dispatch(new GalleryActions.SetSearchConfig(config));\n\n    // On mobile, always collapse filter navigation when picking a category\n    if (this.breakpointObserver.isMatched('(max-width: 959px)')) {\n      this.toggleSidenav(false);\n    }\n  }\n\n  handleClientSelected(client: string) {\n    // Studio\n    if (environment.application === EnvironmentApplication.Studio) {\n      const config = plainToClass(InternalSearchConfig, {\n        ...this.store.selectSnapshot(GalleryState.getSearchConfig),\n        directory: `client/${client}`,\n      });\n\n      this.store.dispatch(new GalleryActions.SetSearchConfig(config));\n    }\n  }\n\n  handleSelectedTagChange(id: string, tag: string) {\n    this.activeTags[id] = tag;\n\n    const config = this.store.selectSnapshot(GalleryState.getSearchConfig);\n\n    if (config && config.type === SearchType.Category) {\n      const nextConfig = plainToClass(CategorySearchConfig, {\n        ...config,\n        tags: flatten(Object.values(this.activeTags)),\n      });\n\n      this.store.dispatch(new GalleryActions.SetSearchConfig(nextConfig));\n    }\n  }\n\n  handleLoftConfigChange(config: LoftSearchConfig) {\n    this.store.dispatch(new GalleryActions.SetSearchConfig(config));\n  }\n\n  handleAction(bookmarkAction: BookmarkActionEvent) {\n    this.bookmarkAction.emit(bookmarkAction);\n  }\n\n  handleBulkAction(action: BulkActionEvent) {\n    this.bulkAction.emit(action);\n  }\n\n  toggleSidenav(open?: boolean) {\n    this.sidenav.toggle(open);\n  }\n\n  getTagGroup(tag: string): string {\n    const tagCategory = tagCategories.find((group) =>\n      group.tags.some((groupTag) => groupTag === tag)\n    );\n    return get(tagCategory, 'title', '');\n  }\n\n  search() {\n    // console.group('Search Studio');\n    // console.log(this.store.selectSnapshot(GalleryState.getSearchConfig));\n    // console.log(this.store.selectSnapshot(GalleryState.getSearchOptions));\n    // console.groupEnd();\n\n    this.store.dispatch(new GalleryActions.SearchStudio());\n  }\n\n  scrollToTop() {\n    this.content.scrollTo({\n      top: 0,\n      behavior: 'smooth',\n    });\n  }\n}\n","<app-navigation-panel label=\"Path\" [collapsible]=\"false\">\n  <!-- Query Form -->\n  <form class=\"gallery-filters theme-light p-5\" [formGroup]=\"queryForm\" *ngIf=\"(searchMode$ | async) === gallerySearchMode.Query\">\n    <!-- Primary Category -->\n    <div class=\"pb-4\">\n      <select class=\"input\" autofocus formControlName=\"primary\">\n        <option *ngFor=\"let category of (primaryCategoryOptions$ | async)\" [value]=\"category\">{{ category }}</option>\n      </select>\n    </div>\n\n    <!-- Secondary Category -->\n    <div class=\"pb-4\">\n      <select class=\"input\" formControlName=\"secondary\" *ngIf=\"(secondaryCategoryOptions$ | async)?.length\">\n        <option *ngFor=\"let category of (secondaryCategoryOptions$ | async)\" [value]=\"category\">{{ category }}</option>\n      </select>\n    </div>\n\n    <!-- Toggle Search Mode -->\n    <button type=\"button\" app-button buttonTheme=\"light\" (click)=\"toggleSearchMode(gallerySearchMode.Path)\" data-test=\"specifyFilePath\">...or specify file path</button>\n  </form>\n\n\n  <!-- Path Form -->\n  <form class=\"gallery-filters theme-light p-5\" [formGroup]=\"pathForm\" *ngIf=\"(searchMode$ | async) === gallerySearchMode.Path\">\n    <!-- Diretory Path -->\n    <div class=\"pb-4\">\n      <input type=\"text\" class=\"input\" formControlName=\"path\" placeholder=\"primary/secondary/name\" data-test=\"moduleIdInput\">\n    </div>\n\n    <!-- Toggle Search Mode -->\n    <button type=\"button\" autofocus app-button buttonTheme=\"light\" (click)=\"toggleSearchMode(gallerySearchMode.Query)\">Cancel</button>\n  </form>\n</app-navigation-panel>\n\n","import { Component, OnInit, OnDestroy, ChangeDetectionStrategy, Output, EventEmitter } from '@angular/core';\nimport { Select, Store } from '@ngxs/store';\nimport { ModulesState } from 'src/app/modules/state/modules.state';\nimport { Observable, Subject, merge } from 'rxjs';\nimport { GetModulePrimaryCategories, GetModuleSecondaryCategories } from 'src/app/modules/state/modules.actions';\nimport { FormBuilder, FormGroup, AbstractControl } from '@angular/forms';\nimport { takeUntil, debounceTime } from 'rxjs/operators';\nimport { GalleryState } from '../../state/gallery.state';\nimport { GallerySearchMode } from '../../models/gallery-search-mode.enum';\nimport { GalleryActions } from '../../state/gallery.actions';\nimport { LoftSearchConfig } from '../../models/search-config';\n@Component({\n  selector: 'app-gallery-filters-loft',\n  templateUrl: './gallery-filters-loft.component.html',\n  styleUrls: ['./gallery-filters-loft.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class GalleryFiltersLoftComponent implements OnInit, OnDestroy {\n  gallerySearchMode = GallerySearchMode;\n\n  @Select(ModulesState.getPrimaryCategoryOptions('read'))\n  primaryCategoryOptions$: Observable<string[]>;\n\n  @Select(ModulesState.getSecondaryCategoryOptions)\n  secondaryCategoryOptions$: Observable<string[]>;\n\n  @Select(GalleryState.getSearchMode)\n  searchMode$: Observable<GallerySearchMode>;\n\n  get primaryCategoryControl(): AbstractControl {\n    return this.queryForm.get('primary');\n  }\n\n  get secondaryCategoryControl(): AbstractControl {\n    return this.queryForm.get('secondary');\n  }\n\n  get pathControl(): AbstractControl {\n    return this.pathForm.get('path');\n  }\n\n  @Output()\n  configChange = new EventEmitter<LoftSearchConfig>();\n\n  queryForm: FormGroup;\n  pathForm: FormGroup;\n  ngUnsubscribe = new Subject();\n\n  constructor(\n    private store: Store,\n    private formBuilder: FormBuilder\n  ) { }\n\n  ngOnInit() {\n    this.initForms();\n    this.initFormListeners();\n\n    this.store.dispatch(new GetModulePrimaryCategories());\n    this.store.dispatch(new GetModuleSecondaryCategories(this.primaryCategoryControl.value));\n  }\n\n  ngOnDestroy() {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n  initForms() {\n    this.queryForm = this.formBuilder.group({\n      'primary': ['production'],\n      'secondary': ['maleAdult']\n    });\n\n    this.pathForm = this.formBuilder.group({\n      'path': []\n    });\n  }\n\n  initFormListeners() {\n    // Update the secondary category, since it's dependent on the primary to populate\n    this.primaryCategoryControl.valueChanges\n      .pipe(takeUntil(this.ngUnsubscribe))\n      .subscribe((value) => {\n        this.handlePrimaryUpdate(value);\n      });\n\n    // Handle all changes\n    merge(this.queryForm.valueChanges, this.pathForm.valueChanges)\n      .pipe(\n        debounceTime(300),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(() => {\n        const config = this.getQuery();\n        if (config) {\n          this.configChange.emit(config);\n        }\n      });\n      \n  }\n\n  toggleSearchMode(mode: GallerySearchMode) {\n    this.store.dispatch(new GalleryActions.SetSearchMode(mode));\n  }\n\n  handlePrimaryUpdate(value) {\n    this.secondaryCategoryControl.setValue('');\n    this.store.dispatch(new GetModuleSecondaryCategories(value));\n  }\n\n  getQuery(): LoftSearchConfig {\n    switch (this.store.selectSnapshot(GalleryState.getSearchMode)) {\n      case GallerySearchMode.Query:\n        if (this.primaryCategoryControl.value) {\n          return new LoftSearchConfig(\n            this.primaryCategoryControl.value,\n            this.secondaryCategoryControl.value\n          );\n        }\n        break;\n\n      case GallerySearchMode.Path:\n        const query = decodeURIComponent(<string>this.pathControl.value || '');\n        const paths = query.split('/');\n\n        // Match directories by checking for trailing /\n        const regex = /([A-Za-z_-\\s0-9]*\\/)/gi;\n        const directories = query.match(regex);\n        \n        // Don't search when no primary directory is specified\n        if (directories != null) {\n          return new LoftSearchConfig(\n            (directories[0] || '').replace('/', ''),\n            (directories[1] || '').replace('/', ''),\n            paths.pop()\n          );\n        }\n        break;\n    }\n\n    return null;\n  }\n\n\n}\n","<!-- Desktop -->\n<div class=\"gallery-header gallery-header--desktop\" data-test=\"galleryHeaderDesktop\">\n\n  <!-- Title -->\n  <div class=\"gallery-header__title\">\n    <app-gallery-title></app-gallery-title>\n  </div>\n\n\n  <div class=\"gallery-header__controls\">\n    <!-- Search -->\n    <div class=\"gallery-header__search\">\n\n      <app-input-group icon=\"search\">\n        <input class=\"input\" type=\"text\" placeholder=\"Search...\" data-test=\"gallerySearchDesktop\" #searchDesktop>\n        <button *ngIf=\"searchDesktop.value\" buttonSize=\"xsmall\" buttonType=\"text\" app-button input-after buttonTheme=\"light\" (click)=\"handleClearQuery()\">Clear</button>\n      </app-input-group>\n    </div>\n\n    <!-- Controls -->\n    <div class=\"flex items-center\">\n        <ng-container *ngIf=\"!(loading$ | async)\">\n          <span class=\"text-12 text-nowrap text-dim pl-1 pr-3\">{{ (results$ | async)?.total }} results</span>\n          <app-divider class=\"mh-1\"></app-divider>\n        </ng-container>\n\n        <!-- Bulk Actions -->\n        <app-gallery-bulk-actions *ngIf=\"(bulkActions$ | async)?.enabled\" (bulkAction)=\"handleBulkAction($event)\"></app-gallery-bulk-actions>\n\n        <!-- Sort By -->\n        <app-sort [sortOptions]=\"sortOptions$ | async\" [sort]=\"sort$ | async\" (sortChange)=\"handleSort($event)\"></app-sort>\n\n        <!-- View As -->\n        <app-divider class=\"mh-1\"></app-divider>\n        <app-gallery-view-mode></app-gallery-view-mode>\n    </div>\n  </div>\n</div>\n\n\n<!-- Mobile -->\n<div class=\"gallery-header gallery-header--mobile\" data-test=\"galleryHeaderMobile\">\n  <!-- Title -->\n  <div class=\"gallery-header__row ph-5\">\n    <div class=\"gallery-header__title\" (click)=\"handleToggleFilters()\">\n      <app-gallery-title></app-gallery-title>\n      <app-icon class=\"gallery-header__title-caret\" icon=\"caret-right\" class=\"ml-2 mr-2\"></app-icon>\n    </div>\n  </div>\n  \n  <!-- Search -->\n  <div class=\"gallery-header__row ph-5\">\n    <div class=\"gallery-header__search\">\n      <app-input-group icon=\"search\">\n        <input class=\"input\" type=\"text\" placeholder=\"Search...\" data-test=\"gallerySearchMobile\" #searchMobile>\n        <button *ngIf=\"searchMobile.value\" buttonSize=\"xsmall\" buttonType=\"text\" app-button input-after buttonTheme=\"light\" (click)=\"handleClearQuery()\">Clear</button>\n      </app-input-group>\n    </div>\n  </div>\n</div>\n","import { \n  Component,\n  OnInit,\n  ViewChild,\n  ElementRef,\n  Renderer2,\n  AfterViewInit,\n  OnDestroy,\n  Output,\n  EventEmitter,\n  ChangeDetectionStrategy,\n  ChangeDetectorRef } from '@angular/core';\nimport { Select, Store } from '@ngxs/store';\nimport { GalleryState } from '../../state/gallery.state';\nimport { Observable, Subject, fromEvent, merge } from 'rxjs';\nimport { GalleryViewMode } from '../../models/gallery-view-mode.enum';\nimport { BookmarkSortModel } from 'src/app/bookmarks/models/bookmark-sort.model';\nimport { filter, debounceTime, distinctUntilChanged, takeUntil } from 'rxjs/operators';\nimport { GalleryActions } from '../../state/gallery.actions';\nimport { SearchConfigUnion } from '../../models/search-config';\nimport { BookmarkModel } from 'src/app/bookmarks/models/bookmark.model';\nimport { BulkActionEvent } from '../../models/bulk-action';\nimport { GalleryBulkActions } from '../../state/gallery.state.model';\nimport { SearchType } from '../../models/search-type.enum';\n\n@Component({\n  selector: 'app-gallery-header',\n  templateUrl: './gallery-header.component.html',\n  styleUrls: ['./gallery-header.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class GalleryHeaderComponent implements OnInit, AfterViewInit, OnDestroy {\n  @ViewChild('searchDesktop', { static: false }) searchDesktop: ElementRef;\n  @ViewChild('searchMobile', { static: false }) searchMobile: ElementRef;\n  \n  @Output()\n  bulkAction = new EventEmitter<BulkActionEvent>();\n\n  @Select(GalleryState.getViewMode)\n  viewMode$: Observable<GalleryViewMode>;\n\n  @Select(GalleryState.getSort)\n  sort$: Observable<BookmarkSortModel>;\n\n  @Select(GalleryState.getSortOptions)\n  sortOptions$: Observable<BookmarkSortModel[]>;\n\n  @Select(GalleryState.getSearchConfig)\n  searchConfig$: Observable<SearchConfigUnion>;\n\n  @Select(GalleryState.getSearchType)\n  searchType$: Observable<SearchType>;\n\n  @Select(GalleryState.getFilteredResults)\n  results$: Observable<BookmarkModel[]>;\n\n  @Select(GalleryState.getBulkActions)\n  bulkActions$: Observable<GalleryBulkActions>;\n\n  @Select(GalleryState.getLoading)\n  loading$: Observable<boolean>;\n\n  galleryViewMode = GalleryViewMode;\n  ngUnsubscribe = new Subject();\n\n  constructor(\n    private store: Store,\n    private renderer: Renderer2,\n    private changeDetectorRef: ChangeDetectorRef\n  ) { }\n\n  ngOnInit() {\n  }\n\n  ngOnDestroy() {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n  ngAfterViewInit() {\n    this.observeSearchInput();\n    this.observeSearchConfig();\n  }\n\n  observeSearchInput() {\n    merge(\n      fromEvent(this.searchDesktop.nativeElement, 'keyup'),\n      fromEvent(this.searchMobile.nativeElement, 'keyup')\n    )\n    .pipe(\n        filter(Boolean),\n        debounceTime(600), // Slower than normal (300ms) because the results are so heavy\n        distinctUntilChanged(),\n        takeUntil(this.ngUnsubscribe)\n    )\n    .subscribe((event: KeyboardEvent) => {\n      const input = <HTMLInputElement>event.target;\n      const config = {...this.store.selectSnapshot(GalleryState.getSearchConfig)};\n      config.query = input.value;\n\n      this.store.dispatch(new GalleryActions.SetSearchConfig(config));\n    });\n  }\n\n  observeSearchConfig() {\n    this.searchConfig$\n      .pipe(\n        filter(config => {\n          return config != null && \n            document.activeElement !== this.searchDesktop.nativeElement && \n            document.activeElement !== this.searchMobile.nativeElement;\n        }),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe((config) => {\n        this.renderer.setProperty(this.searchDesktop.nativeElement, 'value', config.query);\n        this.renderer.setProperty(this.searchMobile.nativeElement, 'value', config.query);\n\n        this.changeDetectorRef.markForCheck();\n      });\n  }\n\n  handleSort(sort: BookmarkSortModel) {\n    const options = this.store.selectSnapshot(GalleryState.getSearchOptions);\n    options.sortBy = sort;\n\n    this.store.dispatch(new GalleryActions.SetSearchOptions(options));\n  }\n\n  handleToggleFilters() {\n    const sidenav = this.store.selectSnapshot(GalleryState.getSidenav);\n    this.store.dispatch(new GalleryActions.SetSidenav({ \n      ...sidenav,\n      open: true\n    }));\n  }\n\n  handleBulkAction(action: BulkActionEvent) {\n    this.bulkAction.next(action);\n    this.store.dispatch(new GalleryActions.SetCheckedItems([]));\n  }\n  \n  handleClearQuery() {\n    const config = this.store.selectSnapshot(GalleryState.getSearchConfig);\n    this.store.dispatch(new GalleryActions.SetSearchConfig({\n      ...config,\n      query: ''\n    }));\n  }\n\n  toggleView(viewMode: GalleryViewMode) {\n    this.store.dispatch(new GalleryActions.SetViewMode(viewMode));\n  }\n\n}\n","<div class=\"gallery-results\">\n  <div class=\"gallery-results__controls\">\n    <!-- Result Count -->\n    <ng-container *ngIf=\"!loading\">\n      <span class=\"text-12 text-nowrap text-dim pl-1 pr-3\">{{ results.total }} results</span>\n      <app-divider class=\"mh-1\"></app-divider>\n    </ng-container>\n\n    <!-- Sort -->\n    <app-sort [sortOptions]=\"sortOptions$ | async\" [sort]=\"sort$ | async\" (sortChange)=\"handleSort($event)\"></app-sort>\n  </div>\n\n  <div class=\"gallery-results__body\" #body>\n    <app-gallery-cards\n      *ngIf=\"(viewMode === galleryViewMode.Card) && !loading && results\"\n      (bookmarkAction)=\"handleBookmarkAction($event)\"\n      [results]=\"results\"\n      [selectLabel]=\"selectLabel\"\n      [selectLabelPlural]=\"selectLabelPlural\"\n      (selectBookmark)=\"handleSelect($event)\"\n      [checkedResults]=\"checkedResults\"></app-gallery-cards>\n      \n    <div class=\"gallery-results__loading\" *ngIf=\"loading\">\n      <app-spinner size=\"huge\" direction=\"vertical\" label=\"Loading\"></app-spinner>\n    </div>\n\n    <div class=\"gallery-results__empty\" *ngIf=\"!loading && results && results.total === 0\">\n      <ng-container [ngSwitch]=\"emptyMessage\">\n        <!-- Start Exploring -->\n        <div class=\"gallery-results__explore\" *ngSwitchCase=\"'team'\">\n          <div class=\"mb-5\">\n            <div class=\"text-16 mb-2\">Add your first 3D model</div>\n            This is your dashboard of saved anatomy models in the BioDigital Human. Customize, manage, and publish your models at any time.\n          </div>\n          <button app-button buttonSize=\"large\" buttonType=\"primary\" [routerLink]=\"['/results/modules']\">Start Exploring</button>\n        </div>\n\n        <!-- Default: No Models Found -->\n        <ng-container *ngSwitchDefault>\n          No Models Found\n        </ng-container>\n      </ng-container>\n    </div>\n  </div>\n</div>","import { \n  Component,\n  OnInit,\n  ChangeDetectionStrategy,\n  Input,\n  ChangeDetectorRef,\n  Output,\n  EventEmitter, \n  OnDestroy,\n  ViewChild,\n  ElementRef} from '@angular/core';\nimport { environment } from 'src/environments/environment';\nimport { GalleryViewMode } from '../../models/gallery-view-mode.enum';\nimport { BookmarkModel } from 'src/app/bookmarks/models/bookmark.model';\nimport { Select, Store } from '@ngxs/store';\nimport { GalleryState } from '../../state/gallery.state';\nimport { Observable, BehaviorSubject, Subject, combineLatest } from 'rxjs';\nimport { BookmarkSortModel } from 'src/app/bookmarks/models/bookmark-sort.model';\nimport { GalleryActions } from '../../state/gallery.actions';\nimport { SearchOptions } from '../../models/search-options';\nimport { BookmarkActionEvent } from '../../../bookmarks/models/bookmark-action';\nimport { GalleryResultsModel } from '../../models/gallery-results.model';\nimport { SearchType } from '../../models/search-type.enum';\nimport { takeUntil, debounceTime, filter, map, withLatestFrom, combineAll, tap } from 'rxjs/operators';\nimport { SearchConfigUnion } from '../../models/search-config';\nimport { isNil } from 'lodash';\n\n@Component({\n  selector: 'app-gallery-results',\n  templateUrl: './gallery-results.component.html',\n  styleUrls: ['./gallery-results.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class GalleryResultsComponent implements OnInit, OnDestroy {\n  mobileQuery: MediaQueryList;\n  galleryViewMode = GalleryViewMode;\n\n  @ViewChild('body', { static: true })\n  body: ElementRef<HTMLDivElement>;\n  \n  @Input()\n  loading = false;\n\n  @Input()\n  viewMode = GalleryViewMode.Card;\n\n  @Input()\n  selectLabel = 'Select';\n\n  @Input()\n  selectLabelPlural = 'Select';\n\n  @Input()\n  public get results(): GalleryResultsModel {\n    return this._results.value;\n  }\n  public set results(value: GalleryResultsModel) {\n    this._results.next(value);\n    this.changeDetectorRef.markForCheck();\n  }\n  private _results = new BehaviorSubject<GalleryResultsModel>({ total: 0, items: []});\n\n  @Input()\n  checkable = false;\n\n  @Input()\n  checkedResults: string[] = [];\n\n  @Output()\n  selectBookmark = new EventEmitter<BookmarkModel>();\n\n  @Output()\n  checkedChange = new EventEmitter<string[]>();\n\n  @Output()\n  bookmarkAction = new EventEmitter<BookmarkActionEvent>();\n\n  @Select(GalleryState.getSearchOptions)\n  searchOptions$: Observable<SearchOptions>;\n\n  @Select(GalleryState.getSortOptions)\n  sortOptions$: Observable<BookmarkSortModel>;\n\n  @Select(GalleryState.getSort)\n  sort$: Observable<BookmarkSortModel>;\n  \n\n  emptyMessage: 'none' | 'default' | 'team' = 'default';\n  ngUnsubscribe = new Subject();\n\n  constructor(\n    private changeDetectorRef: ChangeDetectorRef,\n    private store: Store\n  ) { }\n\n  ngOnInit() {\n    // Observe results and config, determine which custom 'no results' message to show\n    combineLatest(\n      this.store.select(GalleryState.getSearchConfig),\n      this._results\n    ).pipe(\n      tap(() => {\n        this.emptyMessage = 'none';\n        this.changeDetectorRef.markForCheck();\n      }),\n      debounceTime(100),\n      takeUntil(this.ngUnsubscribe),\n      filter(([searchConfig, results]) => !isNil(searchConfig) && results.total === 0),\n    ).subscribe(([searchConfig, results]) => {\n      this.updateEmptyMessage(searchConfig, results);\n      this.changeDetectorRef.markForCheck();\n    });\n  }\n\n  ngOnDestroy() {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n  handleSelect(result: BookmarkModel) {\n    this.selectBookmark.emit(result);\n  }\n\n  handleCheckedChange(ids: string[]) {\n    this.checkedChange.emit(ids);\n  }\n\n  handleBookmarkAction(bookmarkAction: BookmarkActionEvent) {\n    this.bookmarkAction.emit(bookmarkAction);\n  }\n\n  handleSort(sort: BookmarkSortModel) {\n    const options = this.store.selectSnapshot(GalleryState.getSearchOptions);\n    options.sortBy = sort;\n\n    this.store.dispatch(new GalleryActions.SetSearchOptions(options));\n  }\n\n  updateEmptyMessage(searchConfig: SearchConfigUnion, results: GalleryResultsModel) {\n    this.emptyMessage = 'default';\n\n    // Team Message\n    if (\n      searchConfig.query === '' &&\n      (searchConfig.type === SearchType.Collection || searchConfig.type === SearchType.Organization || searchConfig.type === SearchType.Private) &&\n      results.total === 0\n    ) {\n      this.emptyMessage = 'team';\n    }\n  }\n\n  scrollToTop() {\n    this.body.nativeElement.scrollTo({\n      top: 0\n    });\n  }\n}\n","<app-navigation-panel label=\"Import From\" [collapsible]=\"true\">\n    <app-navigation-list-container>\n        <a \n            app-navigation-list-item\n            [selected]=\"(searchType$ | async) === searchType.Category\"\n            (click)=\"handleSelectSource('module')\">\n            BioDigital Library\n        </a>\n\n        <a \n            *appFlagApplication=\"environmentApplication.Studio\"\n            app-navigation-list-item\n            [selected]=\"\n                (searchType$ | async) === searchType.Private || \n                (searchType$ | async) === searchType.Organization || \n                (searchType$ | async) === searchType.Collection\n            \"\n            (click)=\"handleSelectSource('dashboard')\">\n            Dashboard\n        </a>\n\n        <a \n            *appFlagApplication=\"environmentApplication.Loft\"\n            app-navigation-list-item\n            [selected]=\"(searchType$ | async) === searchType.Loft\"\n            (click)=\"handleSelectSource('loft')\">\n            Loft\n        </a>\n    </app-navigation-list-container>\n</app-navigation-panel>\n","import { Component, OnInit, ChangeDetectionStrategy } from '@angular/core';\nimport { Store, Select } from '@ngxs/store';\nimport { GalleryActions } from '../../state/gallery.actions';\nimport { SearchConfigUnion, PrivateSearchConfig, CategorySearchConfig, LoftSearchConfig } from '../../models/search-config';\nimport { GalleryState } from '../../state/gallery.state';\nimport { SearchType } from '../../models/search-type.enum';\nimport { Observable } from 'rxjs';\nimport { EnvironmentApplication } from 'src/environments/models/environment-application';\n\n@Component({\n  selector: 'app-gallery-source',\n  templateUrl: './gallery-source.component.html',\n  styleUrls: ['./gallery-source.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class GallerySourceComponent implements OnInit {\n  searchType = SearchType;\n  environmentApplication = EnvironmentApplication;\n\n  @Select(GalleryState.getSearchType)\n  searchType$: Observable<SearchType>;\n\n  constructor(\n    private store: Store\n  ) { }\n\n  ngOnInit() {\n  }\n\n  handleSelectSource(source: 'module' | 'dashboard' | 'loft') {\n    let config: SearchConfigUnion;\n\n    switch (source) {\n      case 'module':\n        config = new CategorySearchConfig('all');\n        break;\n      \n      case 'dashboard':\n        config = new PrivateSearchConfig('');\n        break;\n\n      case 'loft':\n        config = new LoftSearchConfig('production', 'maleAdult');\n        break;\n    }\n\n    this.store.dispatch(new GalleryActions.SetSearchConfig(config));\n  }\n\n}\n","<app-navigation-panel [label]=\"label\" [collapsible]=\"true\">\n    <app-navigation-list-container>\n        <nav>\n            <a \n                app-navigation-list-item\n                [selected]=\"selectedTag === ''\"\n                (click)=\"handleSelectTag('')\">\n                All\n            </a>\n\n            <a \n                *ngFor=\"let tag of tags\"\n                app-navigation-list-item\n                [selected]=\"tag === selectedTag\"\n                (click)=\"handleSelectTag(tag)\">\n                {{ tag }}\n            </a>\n        </nav>\n    </app-navigation-list-container>\n</app-navigation-panel>\n","import { Component, OnInit, Input, Output, EventEmitter, ChangeDetectionStrategy } from '@angular/core';\nimport { isEqual, isNil } from 'lodash';\nimport { BehaviorSubject } from 'rxjs';\n\n@Component({\n  selector: 'app-gallery-tags-single',\n  templateUrl: './gallery-tags-single.component.html',\n  styleUrls: ['./gallery-tags-single.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class GalleryTagsSingleComponent implements OnInit {\n  @Input()\n  label = '';\n\n  @Input()\n  public get tags(): string[] {\n    return this._tags.value;\n  }\n  public set tags(value: string[]) {\n    if (isEqual(value, this._tags.value)) {\n      return;\n    }\n\n    this._tags.next(value);\n  }\n  private _tags = new BehaviorSubject<string[]>([]);\n\n  @Input()\n  public get selectedTag(): string {\n    return this._selectedTag.value;\n  }\n  public set selectedTag(value: string) {\n    if (isEqual(value, this._selectedTag.value) || isNil(value)) {\n      return;\n    }\n\n    this._selectedTag.next(value);\n  }\n  private _selectedTag = new BehaviorSubject<string>('');\n  @Output() selectedTagChange = new EventEmitter<string>();\n\n\n  constructor() { }\n\n  ngOnInit() {\n  }\n\n  handleSelectTag(tag: string) {\n    this.selectedTagChange.emit(tag);\n  }\n}\n","<div class=\"gallery-title\">\n    <app-category-image\n        style=\"width: 28px; height: 28px\"\n        class=\"gallery-title__category\"\n        *ngIf=\"categoryId\"\n        color=\"color\"\n        [category]=\"categoryId\"></app-category-image>\n    \n    <!-- Title -->\n    <span class=\"gallery-title__title\">\n\n        <ng-container [ngSwitch]=\"searchType$ | async\">\n            <ng-container *ngSwitchCase=\"searchType.Category\">{{ categoryName }}</ng-container>\n            <ng-container *ngSwitchCase=\"searchType.Collection\">{{ collection }}</ng-container>\n            <ng-container *ngSwitchCase=\"searchType.Organization\">All Team Models</ng-container>\n            <ng-container *ngSwitchCase=\"searchType.Private\">My Models</ng-container>\n            <ng-container *ngSwitchCase=\"searchType.Community\">Community Bookmarks</ng-container>\n            <ng-container *ngSwitchCase=\"searchType.Internal\">Search</ng-container>\n            <ng-container *ngSwitchCase=\"searchType.Loft\">{{ directory }}</ng-container>\n        </ng-container>\n    </span>\n</div>","import { Component, OnInit, ChangeDetectionStrategy, OnDestroy, ChangeDetectorRef } from '@angular/core';\nimport { Select, Store } from '@ngxs/store';\nimport { GalleryState } from '../../state/gallery.state';\nimport { Observable, Subject } from 'rxjs';\nimport { SearchConfigUnion, CategorySearchConfig, CollectionSearchConfig, LoftSearchConfig } from '../../models/search-config';\nimport { SearchType } from '../../models/search-type.enum';\nimport { OrganizationsState } from 'src/app/organizations/state/organizations.state';\nimport { OrganizationModel } from 'src/app/organizations/models/organization.model';\nimport { CollectionModel } from 'src/app/organizations/models/collection.model';\nimport { takeUntil, filter, take, distinctUntilChanged } from 'rxjs/operators';\nimport { isNil, get, isEqual } from 'lodash';\nimport { GalleryResultsModel } from '../../models/gallery-results.model';\nimport { AuthState } from 'src/app/auth/state/auth/auth.state';\nimport { getCategory } from 'src/app/shared/features/site-navigation/site-navigation-utils';\n\n@Component({\n  selector: 'app-gallery-title',\n  templateUrl: './gallery-title.component.html',\n  styleUrls: ['./gallery-title.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class GalleryTitleComponent implements OnInit, OnDestroy {\n  @Select(GalleryState.getSearchConfig)\n  searchConfig$: Observable<SearchConfigUnion>;\n\n  @Select(GalleryState.getSearchType)\n  searchType$: Observable<SearchType>;\n\n  @Select(OrganizationsState.getOrganization)\n  organization$: Observable<OrganizationModel>;\n\n  searchType = SearchType;\n  ngUnsubscribe = new Subject();\n\n  collection: string;\n  categoryName: string;\n  categoryId: string;\n  directory: string;\n\n  constructor(\n    private store: Store,\n    private changeDetectorRef: ChangeDetectorRef\n  ) { }\n\n  ngOnInit() {\n    this.observeSearchType();\n  }\n\n  ngOnDestroy() {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n  observeSearchType() {\n    this.searchConfig$.pipe(\n      distinctUntilChanged((a, b) => isEqual(a, b)),\n      filter(config => !isNil(config)),\n      takeUntil(this.ngUnsubscribe)\n    ).subscribe(config => {\n      switch (config.type) {\n        case SearchType.Collection: \n          this.updateCollectionName(config);\n          break;\n\n        case SearchType.Category:\n          this.updateCategoryName(config);\n          this.categoryId = config.categoryId;\n          break;\n\n        case SearchType.Community:\n          this.categoryId = config.categoryId;\n          break;\n\n        case SearchType.Loft:\n          this.updateDirectoryName(config);\n          break;\n      }\n\n      this.changeDetectorRef.markForCheck();\n    });\n  }\n\n  updateCollectionName(config: CollectionSearchConfig) {\n    // Uses a select subscription instead of selectSnapshot because the organization collections\n    // may not have finished loading when the title component is rendered, possibly resulting\n    // in an empty component on first page load.\n    this.store.select(OrganizationsState.getCollections)\n      .pipe(\n        filter(Boolean),\n        take(1),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe((collections: CollectionModel[]) => {\n        const collection = collections.find(_collection => _collection.collection_id === config.collectionId);\n        this.collection = get(collection, 'collection_name', 'Collection');\n        this.changeDetectorRef.markForCheck();\n      });\n\n  }\n\n  updateCategoryName(config: CategorySearchConfig) {\n    if (config.categoryId == null) {\n      this.categoryName = 'All Categories';\n    } else {\n      const language = this.store.selectSnapshot(AuthState.getUserLanguage);\n      const category = getCategory(config.categoryId, language);\n      this.categoryName = get(category, 'title', 'All Categories');\n      this.changeDetectorRef.markForCheck();\n    }\n  }\n\n  updateDirectoryName(config: LoftSearchConfig) {\n    this.directory = [config.primary, config.secondary].join('/');\n    this.changeDetectorRef.markForCheck();\n  }\n}\n","<div class=\"text-nowrap\">\n    <button\n        buttonTheme=\"light\"\n        app-button\n        style=\"margin-right: 1px\"\n        [selected]=\"(viewMode$ | async) === galleryViewMode.Card\"\n        (click)=\"handleViewModeClick(galleryViewMode.Card)\"\n        data-test=\"galleryViewModeCard\">\n        <app-icon icon=\"th\"></app-icon>\n    </button>\n\n    <button\n        buttonTheme=\"light\"\n        app-button\n        [selected]=\"(viewMode$ | async) === galleryViewMode.List\"\n        (click)=\"handleViewModeClick(galleryViewMode.List)\"\n        data-test=\"galleryViewModeList\">\n        <app-icon icon=\"bars\"></app-icon>\n    </button>\n</div>\n","import { Component, OnInit, ChangeDetectionStrategy } from '@angular/core';\nimport { Select, Store } from '@ngxs/store';\nimport { GalleryState } from '../../state/gallery.state';\nimport { Observable } from 'rxjs';\nimport { GalleryViewMode } from '../../models/gallery-view-mode.enum';\nimport { GalleryActions } from '../../state/gallery.actions';\n\n@Component({\n  selector: 'app-gallery-view-mode',\n  templateUrl: './gallery-view-mode.component.html',\n  styleUrls: ['./gallery-view-mode.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class GalleryViewModeComponent implements OnInit {\n  galleryViewMode = GalleryViewMode;\n\n  @Select(GalleryState.getViewMode)\n  viewMode$: Observable<GalleryViewMode>;\n\n  constructor(\n    private store: Store\n  ) { }\n\n  ngOnInit() {\n  }\n\n  handleViewModeClick(viewMode: GalleryViewMode) {\n    this.store.dispatch(new GalleryActions.SetViewMode(viewMode));\n  }\n\n}\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { GalleryContainerComponent } from './components/gallery-container/gallery-container.component';\nimport { GalleryFiltersLoftComponent } from './components/gallery-filters-loft/gallery-filters-loft.component';\nimport { GalleryResultsComponent } from './components/gallery-results/gallery-results.component';\nimport { ButtonsModule } from '../shared/components/buttons/buttons.module';\nimport { ReactiveFormsModule } from '@angular/forms';\nimport { NgxsModule } from '@ngxs/store';\nimport { GalleryState } from './state/gallery.state';\nimport { BookmarksModule } from '../bookmarks/bookmarks.module';\nimport { DirectivesModule } from '../shared/directives/directives.module';\nimport { ProgressIndictatorsModule } from '../shared/components/progress-indicators/progress-indicators.module';\nimport { ListModule } from '../shared/components/list/list.module';\nimport { GalleryCardComponent } from './components/gallery-cards/gallery-card/gallery-card.component';\nimport { GalleryCardsComponent } from './components/gallery-cards/gallery-cards/gallery-cards.component';\nimport { LazyLoadImageModule, intersectionObserverPreset } from 'ng-lazyload-image';\nimport { VirtualScrollerModule } from 'ngx-virtual-scroller';\nimport { SharedModule } from '../shared/shared.module';\nimport { MatCheckboxModule } from '@angular/material';\nimport { GalleryViewModeComponent } from './components/gallery-view-mode/gallery-view-mode.component';\nimport { GalleryCategoriesComponent } from './components/gallery-categories/gallery-categories.component';\nimport { GalleryBannerComponent } from './components/gallery-banner/gallery-banner.component';\nimport { GalleryCollectionsComponent } from './components/gallery-collections/gallery-collections.component';\nimport { GalleryTitleComponent } from './components/gallery-title/gallery-title.component';\nimport { MaterialModule } from '../material.module';\nimport { GalleryHeaderComponent } from './components/gallery-header/gallery-header.component';\nimport { GalleryTagsMultipleComponent } from './components/gallery-tags-multiple/gallery-tags-multiple.component';\nimport { GalleryPaginationComponent } from './components/gallery-pagination/gallery-pagination.component';\nimport { GalleryBulkActionsComponent } from './components/gallery-bulk-actions/gallery-bulk-actions.component';\nimport { GalleryClientsComponent } from './components/gallery-clients/gallery-clients.component';\nimport { RouterModule } from '@angular/router';\nimport { NavigationModule } from '../shared/components/navigation/navigation.module';\nimport { GallerySourceComponent } from './components/gallery-source/gallery-source.component';\nimport { GalleryTagsSingleComponent } from './components/gallery-tags-single/gallery-tags-single.component';\n\n@NgModule({\n  declarations: [\n    GalleryContainerComponent,\n    GalleryFiltersLoftComponent,\n    GalleryResultsComponent,\n    GalleryCardComponent,\n    GalleryCardsComponent,\n    GalleryViewModeComponent,\n    GalleryCategoriesComponent,\n    GalleryBannerComponent,\n    GalleryCollectionsComponent,\n    GalleryTitleComponent,\n    GalleryHeaderComponent,\n    GalleryTagsMultipleComponent,\n    GalleryPaginationComponent,\n    GalleryBulkActionsComponent,\n    GalleryClientsComponent,\n    GallerySourceComponent,\n    GalleryTagsSingleComponent\n  ],\n  imports: [\n    NgxsModule.forFeature([\n      GalleryState\n    ]),\n    // Lazy Load Images\n    LazyLoadImageModule.forRoot({\n      preset: intersectionObserverPreset\n    }),\n    RouterModule,\n    ButtonsModule,\n    CommonModule,\n    ReactiveFormsModule,\n    BookmarksModule,\n    DirectivesModule,\n    ListModule,\n    MaterialModule,\n    NavigationModule,\n    ProgressIndictatorsModule,\n    VirtualScrollerModule,\n    SharedModule,\n\n    MatCheckboxModule\n  ],\n  exports: [\n    GalleryContainerComponent,\n    GalleryFiltersLoftComponent,\n    GalleryResultsComponent,\n    GalleryCardComponent,\n    GalleryCardsComponent,\n    GalleryViewModeComponent\n  ]\n})\nexport class GalleryModule { }\n","import { BookmarkModel } from 'src/app/bookmarks/models/bookmark.model';\n\nexport class GalleryResultsModel {\n    total: number;\n    items: BookmarkModel[];\n}\n","export enum GallerySearchMode {\n  Query,\n  Path\n}\n","import { environment } from 'src/environments/environment';\nimport { EnvironmentApplication } from 'src/environments/models/environment-application';\n\nexport enum GalleryViewMode {\n  List,\n  Card\n}\n\nexport const GalleryViewModeDefault = (environment.application === EnvironmentApplication.Loft) ?\n  GalleryViewMode.List : \n  GalleryViewMode.Card;\n","import { SearchType } from './search-type.enum';\n\nexport class CategorySearchConfig {\n    public readonly type = SearchType.Category;\n\n    constructor(\n        public categoryId?: string,\n        public tags: string[] = [''],\n        public query: string = '',\n    ) {}\n}\n\nexport class OrganizationSearchConfig {\n    public readonly type = SearchType.Organization;\n\n    constructor(\n        public organizationId: number,\n        public query: string = '',\n    ) {}\n}\n\nexport class CollectionSearchConfig {\n    public readonly type = SearchType.Collection;\n\n    constructor(\n        public organizationId: number,\n        public collectionId: number,\n        public query: string = '',\n    ) {}\n}\n\nexport class CommunitySearchConfig {\n    public readonly categoryId = 'public';\n    public readonly type = SearchType.Community;\n\n    constructor(\n        public query: string = ''\n    ) { }\n}\nexport class PrivateSearchConfig {\n    public readonly type = SearchType.Private;\n\n    constructor(\n        public query: string = ''\n    ) {}\n}\n\nexport class InternalSearchConfig {\n    public readonly type = SearchType.Internal;\n\n    constructor(\n        public query: string = '',\n        public directory: string = ''\n    ) {}\n}\n\nexport class LoftSearchConfig {\n    public readonly type = SearchType.Loft;\n\n    constructor(\n        public primary: string,\n        public secondary: string = '',\n        public query: string = ''\n    ) { }\n}\n\n\nexport type SearchConfigUnion = \n    CategorySearchConfig | \n    OrganizationSearchConfig | \n    CollectionSearchConfig | \n    CommunitySearchConfig | \n    PrivateSearchConfig | \n    InternalSearchConfig | \n    LoftSearchConfig;\n\n","import { BookmarkSortModel } from 'src/app/bookmarks/models/bookmark-sort.model';\n\nexport class SearchOptions {\n    constructor(\n        public query: string = '',\n        public sortBy: BookmarkSortModel,\n        public pageSize: number = 25,\n        public offset: number = 0\n    ) {}\n}\n","export enum SearchType {\n    Organization = 'Organization',\n    Collection = 'Collection',\n    Private = 'Private',\n    Category = 'Category',\n    Community = 'Community',\n    Internal = 'Internal',\n    Loft = 'Loft'\n}\n","import { GallerySearchMode } from '../models/gallery-search-mode.enum';\nimport { StudioOptionsModel } from '../models/studio-options.model';\nimport { GalleryViewMode } from '../models/gallery-view-mode.enum';\nimport { ListValue } from 'src/app/modules/modules.service';\nimport { BookmarkModel } from 'src/app/bookmarks/models/bookmark.model';\nimport { BookmarkSortModel } from 'src/app/bookmarks/models/bookmark-sort.model';\nimport { SearchConfigUnion, LoftSearchConfig } from '../models/search-config';\nimport { SearchOptions } from '../models/search-options';\nimport { GallerySidenav, GalleryCardActions, GalleryBulkActions } from './gallery.state.model';\n\nexport namespace GalleryActions {\n  export class SetSearchMode {\n    static readonly type = '[Gallery] Set Search Mode';\n    constructor(public searchMode: GallerySearchMode) { }\n  }\n\n  export class SetViewMode {\n    static readonly type = '[Gallery] Set View Mode';\n    constructor(public viewMode: GalleryViewMode) { }\n  }\n\n  export class SetSort {\n    static readonly type = '[Gallery] Set Sort';\n    constructor(public sort: BookmarkSortModel) { }\n  }\n  \n  export class GetStudioOptions {\n    static readonly type = '[Gallery] Get Studio Options';\n    constructor(public organizationId?: number) { }\n  }\n  \n  export class GetStudioOptionsSuccess {\n    static readonly type = '[Gallery] Get Studio Options Success';\n    constructor(public options: StudioOptionsModel[]) { }\n  }\n\n  export class SearchLoft {\n    static readonly type = '[Gallery] Search Loft';\n    constructor(public config: LoftSearchConfig) { }\n  }\n\n  export class SearchLoftSuccess {\n    static readonly type = '[Gallery] Search Loft Success';\n    constructor(public bookmarks: ListValue[]) { }\n  }\n\n  // Types of searches\n  // - Studio\n  // -- Internal: categoryId?: string\n  // -- Organization: organizationId: string, collectionId?: string\n  // - Loft\n  // -- Internal: categoryId?: string\n  // -- Client: ??\n  //\n  // SetSearchConfig and SearchStudio are isolated actions. Since there are multiple\n  // components which can \"trigger\" a search, the core responsibility of dispatching the real\n  // search is handled by the root GalleryContainer component.\n  export class SetSearchConfig {\n    static readonly type = '[Gallery] Set Search Config';\n    constructor (\n      public config: SearchConfigUnion,\n      public options?: SearchOptions\n    ) { }\n  } \n\n  export class SetSearchOptions {\n    static readonly type = '[Gallery] Set Search Options';\n    constructor (\n      public options: SearchOptions\n    ) { }\n  }\n  \n  export class SearchStudio {\n    static readonly type = '[Gallery] Search Studio';\n    constructor() { }\n  }\n  export class SearchStudioSuccess {\n    static readonly type = '[Gallery] Search Studio Success';\n    constructor(public bookmarks: BookmarkModel[]) { }\n  }\n\n  export class SearchSuccess {\n    static readonly type = '[Gallery] Search Success';\n    constructor(public bookmarks: BookmarkModel[]) { }\n  }\n\n  export class SelectBookmark {\n    static readonly type = '[Gallery] Select Bookmark';\n    constructor(public result: BookmarkModel) { }\n  }\n\n  export class SetSidenav {\n    static readonly type = '[Gallery] Set Sidenav';\n    constructor(public sidenav: GallerySidenav) {}\n  }\n\n  export class SetBulkActions {\n    static readonly type = '[Gallery] Set Bulk Actions';\n    constructor(public bulkActions: GalleryBulkActions) {}\n  }\n\n  export class SetCardActions {\n    static readonly type = '[Gallery] Set Card Actions';\n    constructor(public cardActions: GalleryCardActions) {}\n  }\n\n  export class ClearResults {\n    static readonly type = '[Gallery] Clear Results';\n    constructor() { }\n  }\n\n  export class CheckItem {\n    static readonly type = '[Gallery] Check Item';\n    constructor(public id: string, public checked?: boolean) {}\n  }\n\n  export class CheckAll {\n    static readonly type = '[Gallery] Check All';\n    constructor(public checked?: boolean) {}\n  }\n\n  export class SetCheckedItems {\n    static readonly type = '[Gallery] Set Checked Items';\n    constructor(public ids: string[]) {}\n  }\n\n  export class Reset {\n    static readonly type = '[Gallery] Reset';\n    constructor() { }\n  }\n}\n","import { GallerySearchMode } from '../models/gallery-search-mode.enum';\nimport { GalleryViewMode } from '../models/gallery-view-mode.enum';\nimport { StudioOptionsModel } from '../models/studio-options.model';\nimport { BookmarkSortModel } from 'src/app/bookmarks/models/bookmark-sort.model';\nimport { SearchConfigUnion } from '../models/search-config';\nimport { SearchOptions } from '../models/search-options';\nimport { GalleryResultsModel } from '../models/gallery-results.model';\nimport { BulkActions } from '../models/bulk-action';\nimport { BookmarkAction } from '../../bookmarks/models/bookmark-action';\n\nexport class GalleryStateModel {\n    loading: boolean;\n    \n    searchMode: GallerySearchMode;\n    viewMode: GalleryViewMode;\n    \n    searchResults: GalleryResultsModel;\n    checkedResults: string[];\n\n    // New\n    searchConfig: SearchConfigUnion;\n    searchOptions: SearchOptions;\n\n    sidenav: GallerySidenav;\n\n    bulkActions: GalleryBulkActions;\n    cardActions: GalleryCardActions;\n}\n\nexport class GallerySidenav {\n    enabled: boolean;\n    open: boolean;\n}\n\nexport class GalleryBulkActions {\n    enabled: boolean;\n    items: BulkActions[];\n}\n\nexport class GalleryCardActions {\n    enabled: boolean;\n}\n","import { State, Action, StateContext, Selector, Store } from '@ngxs/store';\nimport { GalleryStateModel } from './gallery.state.model';\nimport { GallerySearchMode } from '../models/gallery-search-mode.enum';\nimport { GalleryViewModeDefault } from '../models/gallery-view-mode.enum';\nimport { GalleryActions } from './gallery.actions';\nimport { OrganizationsService } from 'src/app/organizations/organizations.service';\nimport { Observable } from 'rxjs';\nimport { ModulesService } from 'src/app/modules/modules.service';\nimport { finalize, map } from 'rxjs/operators';\nimport { ExploreService } from 'src/app/explore/explore.service';\nimport { BookmarkModel } from 'src/app/bookmarks/models/bookmark.model';\nimport { BookmarksService } from 'src/app/bookmarks/bookmarks.service';\nimport * as _ from 'lodash';\n\nimport { sortModels } from 'src/app/bookmarks/models/bookmark-sort.model';\nimport {\n  bookmarkSortTitleAsc,\n  bookmarkSortRelevance,\n  bookmarkSortRecent,\n  bookmarkSortTitleDesc,\n  bookmarkSortAuthorAsc,\n  bookmarkSortAuthorDesc,\n} from 'src/app/bookmarks/data/bookmark-sort';\nimport { SearchType } from '../models/search-type.enum';\nimport { isNil } from 'lodash';\nimport { SearchOptions } from '../models/search-options';\nimport { GalleryResultsModel } from '../models/gallery-results.model';\nimport { AuthState } from 'src/app/auth/state/auth/auth.state';\n\nconst initialState: GalleryStateModel = {\n  loading: true,\n  searchMode: GallerySearchMode.Query,\n  viewMode: GalleryViewModeDefault,\n  searchResults: { total: 0, items: [] },\n  checkedResults: [],\n  searchConfig: null,\n  searchOptions: null,\n  sidenav: {\n    enabled: true,\n    open: true,\n  },\n  bulkActions: {\n    enabled: true,\n    items: [],\n  },\n  cardActions: {\n    enabled: true,\n  },\n};\n\n@State<GalleryStateModel>({\n  name: 'gallery',\n  defaults: initialState,\n})\nexport class GalleryState {\n  /**\n   * Selectors\n   */\n  @Selector()\n  static getLoading(state: GalleryStateModel) {\n    return state.loading;\n  }\n\n  @Selector()\n  static getSearchMode(state: GalleryStateModel) {\n    return state.searchMode;\n  }\n\n  @Selector()\n  static getSearchConfig(state: GalleryStateModel) {\n    return state.searchConfig;\n  }\n\n  @Selector()\n  static getSearchOptions(state: GalleryStateModel) {\n    return state.searchOptions;\n  }\n\n  @Selector()\n  static getSearchType(state: GalleryStateModel) {\n    return state.searchConfig ? state.searchConfig.type : null;\n  }\n\n  @Selector()\n  static getViewMode(state: GalleryStateModel) {\n    return state.viewMode;\n  }\n\n  @Selector()\n  static getSort(state: GalleryStateModel) {\n    return state.searchOptions.sortBy;\n  }\n\n  @Selector()\n  static getSortOptions(state: GalleryStateModel) {\n    const searchType = state.searchConfig.type;\n\n    switch (searchType) {\n      case SearchType.Loft:\n        return [bookmarkSortTitleAsc, bookmarkSortTitleDesc];\n\n      case SearchType.Category:\n        return [\n          bookmarkSortRelevance,\n          bookmarkSortRecent,\n          bookmarkSortTitleAsc,\n          bookmarkSortTitleDesc\n        ];\n\n      default:\n        return [\n          bookmarkSortRecent,\n          bookmarkSortTitleAsc,\n          bookmarkSortTitleDesc,\n          bookmarkSortAuthorAsc,\n          bookmarkSortAuthorDesc\n        ];\n    }\n  }\n\n  @Selector()\n  static getSidenav(state: GalleryStateModel) {\n    return state.sidenav;\n  }\n\n  @Selector()\n  static getBulkActions(state: GalleryStateModel) {\n    return state.bulkActions;\n  }\n\n  @Selector()\n  static getCardActions(state: GalleryStateModel) {\n    return state.cardActions;\n  }\n\n  @Selector()\n  static getFilteredResults(state: GalleryStateModel): GalleryResultsModel {\n    const { searchResults, searchOptions } = state;\n    const { ascending, fields } = searchOptions.sortBy;\n\n    // Determine if we need to filter the results locally or let the server handle it\n    const filteredItems = sortModels(searchResults.items, fields, ascending) // Sort\n      .slice(\n        searchOptions.offset,\n        searchOptions.offset + searchOptions.pageSize\n      ); // Paginate\n\n    return {\n      ...searchResults,\n      items: filteredItems,\n    };\n  }\n\n  @Selector()\n  static getAllResults(state: GalleryStateModel): GalleryResultsModel {\n    const { searchResults, searchOptions } = state;\n    const { ascending, fields } = searchOptions.sortBy;\n\n    return {\n      total: searchResults.total,\n      items: sortModels(searchResults.items, fields, ascending)\n    };\n  }\n\n  @Selector()\n  static getCheckedResults(state: GalleryStateModel) {\n    return state.checkedResults;\n  }\n\n  /**\n   * Actions\n   */\n  @Action(GalleryActions.SetSearchMode)\n  setSearchMode(\n    context: StateContext<GalleryStateModel>,\n    action: GalleryActions.SetSearchMode\n  ) {\n    context.patchState({\n      searchMode: action.searchMode,\n    });\n  }\n\n  @Action(GalleryActions.SetViewMode)\n  setViewMode(\n    context: StateContext<GalleryStateModel>,\n    action: GalleryActions.SetViewMode\n  ) {\n    context.patchState({\n      viewMode: action.viewMode,\n    });\n  }\n\n  @Action(GalleryActions.SetSearchOptions)\n  setSearchOptions(\n    context: StateContext<GalleryStateModel>,\n    action: GalleryActions.SetSearchOptions\n  ) {\n    context.patchState({\n      searchOptions: { ...action.options },\n    });\n  }\n\n  @Action(GalleryActions.SetSearchConfig)\n  setSearchConfig(\n    context: StateContext<GalleryStateModel>,\n    action: GalleryActions.SetSearchConfig\n  ) {\n    const config = action.config || context.getState().searchConfig;\n    const options = action.options || context.getState().searchOptions;\n\n    // Don't search when no config is specified, since we don't know where to look\n    if (config === null) {\n      return;\n    }\n\n    context.patchState({\n      searchOptions: { ...options },\n      searchConfig: { ...config },\n    });\n  }\n\n  @Action(GalleryActions.SearchStudio)\n  searchStudio(\n    context: StateContext<GalleryStateModel>,\n    action: GalleryActions.SearchStudio\n  ) {\n    const { searchConfig, searchOptions } = context.getState();\n    const defaultOptions = new SearchOptions('', bookmarkSortTitleAsc);\n    const lang = this.store.selectSnapshot(AuthState.getUserLanguage);\n\n    context.patchState({\n      loading: true,\n      searchOptions: {\n        ...searchOptions,\n        pageSize: defaultOptions.pageSize, // Reset pagination on any request\n        offset: defaultOptions.offset,\n      },\n      checkedResults: [], // Always clear checked results on new search\n    });\n\n    // Initialize search based on the type of config passed\n    // All searches return the same data structure, but rely on different APIs\n    let search$ = new Observable<BookmarkModel[]>();\n\n    switch (searchConfig.type) {\n      case SearchType.Category:\n        // Filter out 'all' param\n        search$ = this.exploreService.getAnatomyCategory(\n          searchConfig.query,\n          searchConfig.categoryId === 'all' ? '' : searchConfig.categoryId,\n          searchConfig.tags,\n          lang\n        );\n        break;\n\n      case SearchType.Organization:\n        search$ = this.bookmarksService.getOrganizationContent(\n          searchConfig.organizationId,\n          searchConfig.query\n        );\n        break;\n\n      case SearchType.Collection:\n        search$ = this.organizationsService.getCollectionContent(\n          searchConfig.organizationId,\n          searchConfig.collectionId,\n          searchConfig.query\n        );\n        break;\n\n      case SearchType.Community:\n        search$ = this.bookmarksService.getPublicBookmarks(searchConfig.query);\n        break;\n\n      case SearchType.Private:\n        search$ = this.bookmarksService.getPrivateBookmarks(searchConfig.query);\n        break;\n\n      case SearchType.Internal:\n        search$ = this.exploreService.searchInternal(\n          searchConfig.query,\n          searchConfig.directory\n        );\n        break;\n\n      case SearchType.Loft:\n        const isExplicit = searchConfig.query.indexOf('.json') > 0;\n\n        // Search module services\n        search$ = this.modulesService\n          .listContents(\n            searchConfig.primary,\n            searchConfig.secondary,\n            isExplicit ? searchConfig.query : '',\n            true\n          )\n          .pipe(\n            map((results: BookmarkModel[]) => {\n              return !isExplicit\n                ? results.filter(\n                    (result) => result.title.indexOf(searchConfig.query) >= 0\n                  )\n                : results;\n            })\n          );\n        break;\n    }\n\n    // Perform the search\n    search$\n      .pipe(finalize(() => context.patchState({ loading: false })))\n      .subscribe((results) => {\n        context.dispatch(new GalleryActions.SearchSuccess(results));\n      });\n  }\n\n  @Action(GalleryActions.SearchSuccess)\n  searchSuccess(\n    context: StateContext<GalleryStateModel>,\n    action: GalleryActions.SearchSuccess\n  ) {\n    context.patchState({\n      searchResults: {\n        items: action.bookmarks,\n        total: action.bookmarks.length,\n      },\n    });\n  }\n\n  @Action(GalleryActions.CheckItem)\n  checkItem(\n    context: StateContext<GalleryStateModel>,\n    action: GalleryActions.CheckItem\n  ) {\n    let items = context.getState().checkedResults;\n    const exists = items.some((item) => item === action.id);\n\n    if (action.checked && !exists) {\n      items = [...items, action.id];\n    } else if (!action.checked) {\n      items = items.filter((bookmark) => bookmark !== action.id);\n    }\n\n    context.patchState({\n      checkedResults: items,\n    });\n  }\n\n  @Action(GalleryActions.CheckAll)\n  checkAll(\n    context: StateContext<GalleryStateModel>,\n    action: GalleryActions.CheckAll\n  ) {\n    const check = isNil(action.checked) ? true : action.checked;\n    const ids = context.getState().searchResults.items.map((item) => item.id);\n\n    context.patchState({\n      checkedResults: ids,\n    });\n  }\n\n  @Action(GalleryActions.SetCheckedItems)\n  setCheckedItems(\n    context: StateContext<GalleryStateModel>,\n    action: GalleryActions.SetCheckedItems\n  ) {\n    context.patchState({\n      checkedResults: action.ids,\n    });\n  }\n\n  @Action(GalleryActions.SetSidenav)\n  setSidenav(\n    context: StateContext<GalleryStateModel>,\n    action: GalleryActions.SetSidenav\n  ) {\n    context.patchState({\n      sidenav: {\n        ...action.sidenav,\n      },\n    });\n  }\n\n  @Action(GalleryActions.SetCardActions)\n  setCardActions(\n    context: StateContext<GalleryStateModel>,\n    action: GalleryActions.SetCardActions\n  ) {\n    context.patchState({\n      cardActions: {\n        ...action.cardActions,\n      },\n    });\n  }\n\n  @Action(GalleryActions.SetBulkActions)\n  setBulkActions(\n    context: StateContext<GalleryStateModel>,\n    action: GalleryActions.SetBulkActions\n  ) {\n    context.patchState({\n      bulkActions: {\n        ...action.bulkActions,\n      },\n    });\n  }\n\n  @Action(GalleryActions.ClearResults)\n  clearResults(\n    context: StateContext<GalleryStateModel>,\n    action: GalleryActions.ClearResults\n  ) {\n    context.patchState({\n      searchResults: {\n        items: [],\n        total: 0,\n      },\n    });\n  }\n\n  @Action(GalleryActions.Reset)\n  resetGallery(\n    context: StateContext<GalleryStateModel>,\n    action: GalleryActions.Reset\n  ) {\n    context.patchState(initialState);\n  }\n\n  constructor(\n    private organizationsService: OrganizationsService,\n    private modulesService: ModulesService,\n    private exploreService: ExploreService,\n    private bookmarksService: BookmarksService,\n    private store: Store\n  ) {}\n}\n","import { HttpInterceptor, HttpRequest, HttpHandler, HttpEvent, HttpResponse } from '@angular/common/http';\nimport { Observable } from 'rxjs';\nimport { map } from 'rxjs/operators';\n\nexport class ApiInterceptor implements HttpInterceptor {\n    intercept(request: HttpRequest<any>, next: HttpHandler): Observable<HttpEvent<any>> {\n        // Intercept response, move data field to root response when present\n        return next.handle(request).pipe(\n            map(\n                (event) => {\n                    if (event instanceof HttpResponse && event.body) {\n                        if (event.body.hasOwnProperty('results')) {\n                            event = event.clone({ body: event.body.results });\n                        }\n                    }\n                    return event;\n                }\n            )\n        );\n\n    }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { MasterComponent } from './pages/master/master.component';\nimport { RouterModule } from '@angular/router';\nimport { NgxsModule } from '@ngxs/store';\nimport { LayoutState } from './state/layout.state';\nimport { SiteHeaderComponent } from './components/site-header/site-header.component';\nimport { MaterialModule } from '../material.module';\nimport { SharedModule } from '../shared/shared.module';\nimport { ExploreMenuComponent } from './components/explore-menu/explore-menu.component';\nimport { LocaleConfigModule } from '../locale-config.module';\nimport { LocaleMenuComponent } from './components/locale-menu/locale-menu.component';\nimport { ReactiveFormsModule } from '@angular/forms';\nimport { MobileNavComponent } from './components/mobile-nav/mobile-nav.component';\nimport { NavigationModule } from '../shared/components/navigation/navigation.module';\nimport { BookmarksModule } from '../bookmarks/bookmarks.module';\n\n\n@NgModule({\n  imports: [\n    SharedModule,\n    MaterialModule,\n    CommonModule,\n    RouterModule,\n    NavigationModule,\n    LocaleConfigModule,\n    ReactiveFormsModule,\n    BookmarksModule,\n    NgxsModule.forFeature([\n      LayoutState\n    ])\n  ],\n  declarations: [\n    MasterComponent,\n    SiteHeaderComponent,\n    ExploreMenuComponent,\n    LocaleMenuComponent,\n    MobileNavComponent\n  ],\n  exports: [MasterComponent]\n})\nexport class LayoutModule { }\n","export enum LayoutThemeEnum {\n    Light = 'theme-light',\n    Dark = 'theme-dark'\n}\n","export enum SiteHeaderType {\n    Application,\n    View,\n    Hide\n}\n","import { LayoutThemeEnum } from '../models/layout-theme.enum';\r\nimport { SiteHeaderType } from '../models/site-header-type.enum';\r\nimport { LayoutSidenav } from './layout.state.model';\r\n\r\nexport namespace LayoutActions {\r\n  export class SetTheme {\r\n    static readonly type = '[Layout] Set Theme';\r\n    constructor(public theme: LayoutThemeEnum) { }\r\n  }\r\n  \r\n  export class SetSidenav {\r\n    static readonly type = '[Layout] Set Sidenav';\r\n    constructor(public sidenav: LayoutSidenav) { }\r\n  }\r\n\r\n  export class ToggleSidenav {\r\n    static readonly type = '[Layout] Toggle Sidenav';\r\n    constructor(public open: boolean) { }\r\n  }\r\n\r\n  export class SetHeader {\r\n    static readonly type = '[Layout] Set Header';\r\n    constructor(public siteHeaderType: SiteHeaderType) { }\r\n  }\r\n  \r\n  export class ResetLayout {\r\n    static readonly type = '[Layout] Reset';\r\n    constructor() { }\r\n  }\r\n}\r\n","import { SiteHeaderType } from '../models/site-header-type.enum';\n\nexport class LayoutStateModel {\n    public theme: string;\n    public sidenav: LayoutSidenav;\n    public siteHeader: SiteHeaderType;\n}\n\nexport class LayoutSidenav {\n    enabled: boolean;\n    open: boolean;\n}\n","import { State, Action, StateContext, Selector } from '@ngxs/store';\r\nimport { LayoutActions } from './layout.actions';\r\nimport { LayoutStateModel } from './layout.state.model';\r\nimport { LayoutThemeEnum } from '../models/layout-theme.enum';\r\nimport { SiteHeaderType } from '../models/site-header-type.enum';\r\n\r\nconst initialState: LayoutStateModel = {\r\n  theme: LayoutThemeEnum.Light,\r\n  sidenav: {\r\n    enabled: true,\r\n    open: false\r\n  },\r\n  siteHeader: SiteHeaderType.Application\r\n};\r\n\r\n@State<LayoutStateModel>({\r\n  name: 'layout',\r\n  defaults: initialState\r\n})\r\nexport class LayoutState {\r\n  @Selector()\r\n  static getTheme(state: LayoutStateModel) {\r\n    return state.theme;\r\n  }\r\n\r\n  @Selector()\r\n  static getSidenav(state: LayoutStateModel) {\r\n    return state.sidenav;\r\n  }\r\n\r\n  @Selector()\r\n  static getSiteHeader(state: LayoutStateModel) {\r\n    return state.siteHeader;\r\n  }\r\n\r\n  @Action(LayoutActions.SetTheme)\r\n  setTheme({ patchState }: StateContext<LayoutStateModel>, { theme }: LayoutActions.SetTheme) {\r\n    patchState({\r\n      theme: theme\r\n    });\r\n  }\r\n\r\n  @Action(LayoutActions.SetHeader)\r\n  setHeader(context: StateContext<LayoutStateModel>, action: LayoutActions.SetHeader) {\r\n    context.patchState({\r\n      siteHeader: action.siteHeaderType\r\n    });\r\n  }\r\n\r\n  @Action(LayoutActions.SetSidenav)\r\n  setSidenav(context: StateContext<LayoutStateModel>, action: LayoutActions.SetSidenav) {\r\n    context.patchState({\r\n      sidenav: {\r\n        ...action.sidenav\r\n      }\r\n    });\r\n  }\r\n\r\n  @Action(LayoutActions.ToggleSidenav)\r\n  toggleSidenav(context: StateContext<LayoutStateModel>, action: LayoutActions.ToggleSidenav) {\r\n    const sidenav = context.getState().sidenav;\r\n    context.patchState({\r\n      sidenav: {\r\n        ...sidenav,\r\n        open: action.open\r\n      }\r\n    });\r\n  }\r\n\r\n  @Action(LayoutActions.ResetLayout)\r\n  resetLayout(context: StateContext<LayoutStateModel>, action: LayoutActions.ResetLayout) {\r\n    context.setState(initialState);\r\n  }\r\n}\r\n","import { NgModule, ModuleWithProviders, LOCALE_ID } from '@angular/core';\nimport { CommonModule, registerLocaleData } from '@angular/common';\nimport { LocaleModel } from './shared/models/locale.model';\n\nexport const defaultLocale: LocaleModel = {\n  title: 'English', lang: 'en', id: 'en-US'\n};\n\nexport const locales: LocaleModel[] = [\n  defaultLocale,\n  { title: 'Espaol', lang: 'es', id: 'es-ES' },\n  { title: '()', lang: 'zh', id: 'zh-CN' },\n  { title: 'Franais', lang: 'fr', id: 'fr-FR' },\n  { title: 'Deutsch', lang: 'de', id: 'de-DE' },\n  { title: 'Italiano', lang: 'it', id: 'it-IT' },\n  { title: '', lang: 'ja', id: 'ja' },\n  { title: 'Portugus', lang: 'pt', id: 'pt-PT' }\n];\n\nexport function getLocaleId(): string {\n  let storedLocaleId = '';\n\n  // localStorage may be disabled by browser security\n  try {\n    storedLocaleId = localStorage.getItem('locale');\n  } catch { }\n\n  const targetLocale = locales.find((locale) => locale.id === storedLocaleId) || defaultLocale;\n  return targetLocale.id;\n}\n\nimport localeEs from '@angular/common/locales/es';\nimport localeZh from '@angular/common/locales/zh';\nimport localeFr from '@angular/common/locales/fr';\nimport localeDe from '@angular/common/locales/de';\nimport localeIt from '@angular/common/locales/it';\nimport localeJa from '@angular/common/locales/ja';\nimport localePt from '@angular/common/locales/pt';\n\nconst importedLocales = [\n  localeEs,\n  localeZh,\n  localeFr,\n  localeDe,\n  localeIt,\n  localeJa,\n  localePt\n];\n\n// locale registration\nimportedLocales.forEach((locale) => {\n  registerLocaleData(locale);\n});\n\n@NgModule({\n  declarations: [],\n  imports: [\n    CommonModule\n  ]\n})\nexport class LocaleConfigModule {\n  static forRoot(): ModuleWithProviders {\n    return {\n      ngModule: LocaleConfigModule,\n      providers: [{\n        provide: LOCALE_ID,\n        useFactory: getLocaleId\n      }]\n    };\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { MarkdownModule, MarkedOptions, MarkedRenderer } from 'ngx-markdown';\n\n// a list of support tags to persits during html -> markdown conversion\nexport const supportedMarkdownHTMLTags = ['strong', 'sub', 'sup'];\n\nexport function getDefaultMarkdownOptions(): MarkedOptions {\n  const renderer = new MarkedRenderer();\n\n  // links will always open in a new window + link validation\n  renderer.link = (href: string, title: string, text: string) => {\n    const sanitizedHref = sanitizeURL(href);\n    return `<a href=\"${sanitizedHref}\" target=\"_blank\" rel=\"noreferrer nofollow\">${text}</a>`;\n  };\n\n  // fix trailing newline created by markedjs\n  renderer.paragraph = (text: string) => {\n    return `<p>${text}</p>`;\n  };\n\n  // disable images\n  renderer.image = (href: string, title: string, text: string) => {\n    return '';\n  };\n\n  return {\n    renderer: renderer, // special overrides for custom output\n    gfm: false // GitHub Flavored Markdown: disable, basic Markdown support\n  };\n}\n\n// sanitize malformed/malicious URLs\nfunction sanitizeURL(url: string): string {\n  if (url.match(/^(?:(?:(?:ht)tps?):|[^a-z]|[a-z+.\\-]+(?:[^a-z+.\\-:]|$))/i)) {\n    return url;\n  } else {\n    return '';\n  }\n}\n\n@NgModule({\n  declarations: [],\n  imports: [\n    CommonModule,\n    // Markdown Support\n    MarkdownModule.forRoot({\n      markedOptions: {\n        provide: MarkedOptions,\n        useFactory: getDefaultMarkdownOptions\n      }\n    })\n  ]\n})\nexport class MarkdownConfigModule { }\n","import {CdkTableModule} from '@angular/cdk/table';\nimport {CdkTreeModule} from '@angular/cdk/tree';\n\nimport { MatCheckboxModule } from '@angular/material/checkbox';\nimport { RippleGlobalOptions, MAT_RIPPLE_GLOBAL_OPTIONS } from '@angular/material/core';\nimport { MatButtonModule } from '@angular/material/button';\nimport { MatRadioModule } from '@angular/material/radio';\nimport { MatSelectModule } from '@angular/material/select';\nimport { MatMenuModule } from '@angular/material/menu';\nimport { MatToolbarModule } from '@angular/material/toolbar';\nimport { MatButtonToggleModule } from '@angular/material/button-toggle';\nimport { MatChipsModule } from '@angular/material/chips';\nimport { MatDialogModule } from '@angular/material/dialog';\nimport { MatTooltipModule } from '@angular/material/tooltip';\nimport { MatSnackBarModule , MAT_SNACK_BAR_DEFAULT_OPTIONS} from '@angular/material/snack-bar';\nimport { MatDividerModule } from '@angular/material/divider';\nimport { MatSidenavModule } from '@angular/material/sidenav';\n\nimport { NgModule } from '@angular/core';\nimport 'hammerjs';\nimport { ScrollingModule } from '@angular/cdk/scrolling';\nimport { DragDropModule } from '@angular/cdk/drag-drop';\nimport { OverlayModule } from '@angular/cdk/overlay';\nimport { PortalModule } from '@angular/cdk/portal';\n\n\n// import {MatInputModule} from '@angular/material/input';\n// import {MatAutocompleteModule} from '@angular/material/autocomplete';\n// import {MatDatepickerModule} from '@angular/material/datepicker';\n// import {MatFormFieldModule} from '@angular/material/form-field';\n// import {MatSliderModule} from '@angular/material/slider';\n// import {MatSlideToggleModule} from '@angular/material/slide-toggle';\n// import {MatListModule} from '@angular/material/list';\n// import {MatGridListModule} from '@angular/material/grid-list';\n// import {MatCardModule} from '@angular/material/card';\n// import {MatStepperModule} from '@angular/material/stepper';\n// import {MatTabsModule} from '@angular/material/tabs';\n// import {MatExpansionModule} from '@angular/material/expansion';\n// import {MatProgressSpinnerModule} from '@angular/material/progress-spinner';\n// import {MatProgressBarModule} from '@angular/material/progress-bar';\n// import {MatTableModule} from '@angular/material/table';\n// import {MatSortModule} from '@angular/material/sort';\n// import {MatPaginatorModule} from '@angular/material/paginator';\n\n\n\n\n\n\nconst globalRippleConfig: RippleGlobalOptions = {\n  disabled: true,\n  animation: {\n    enterDuration: 0,\n    exitDuration: 0\n  }\n};\n\n@NgModule({\n  imports: [\n    DragDropModule,\n    CdkTableModule,\n    MatCheckboxModule,\n    MatCheckboxModule,\n    MatButtonModule,\n    MatRadioModule,\n    MatSelectModule,\n    MatMenuModule,\n    MatToolbarModule,\n    MatButtonToggleModule,\n    MatChipsModule,\n    MatDialogModule,\n    MatTooltipModule,\n    MatSnackBarModule,\n    MatDividerModule,\n    MatSidenavModule,\n    ScrollingModule,\n    OverlayModule,\n    PortalModule,\n\n    // MatInputModule,\n    // MatAutocompleteModule,\n    // MatDatepickerModule,\n    // MatFormFieldModule,\n    // MatSliderModule,\n    // MatSlideToggleModule,\n    // MatListModule,\n    // MatGridListModule,\n    // MatCardModule,\n    // MatStepperModule,\n    // MatTabsModule,\n    // MatExpansionModule,\n    // MatProgressSpinnerModule,\n    // MatProgressBarModule,\n    // MatTableModule,\n    // MatSortModule,\n    // MatPaginatorModule,\n  ],\n  providers: [\n    {provide: MAT_SNACK_BAR_DEFAULT_OPTIONS, useValue: {duration: 3000}},\n    {provide: MAT_RIPPLE_GLOBAL_OPTIONS, useValue: globalRippleConfig}\n  ],\n  exports: [\n    DragDropModule,\n    CdkTableModule,\n    CdkTreeModule,\n    MatCheckboxModule,\n    MatCheckboxModule,\n    MatButtonModule,\n    MatRadioModule,\n    MatSelectModule,\n    MatMenuModule,\n    MatToolbarModule,\n    MatButtonToggleModule,\n    MatChipsModule,\n    MatDialogModule,\n    MatTooltipModule,\n    MatSnackBarModule,\n    MatDividerModule,\n    MatSidenavModule,\n    ScrollingModule,\n    OverlayModule,\n    PortalModule,\n\n    // MatInputModule,\n    // MatAutocompleteModule,\n    // MatDatepickerModule,\n    // MatFormFieldModule,\n    // MatSliderModule,\n    // MatSlideToggleModule,\n    // MatListModule,\n    // MatGridListModule,\n    // MatCardModule,\n    // MatStepperModule,\n    // MatTabsModule,\n    // MatExpansionModule,\n    // MatProgressSpinnerModule,\n    // MatProgressBarModule,\n    // MatTableModule,\n    // MatSortModule,\n    // MatPaginatorModule,\n  ]\n})\nexport class MaterialModule { }\n","export enum ModulesSaveResultEnum {\n  Success = 'success',\n  Fail = 'fail'\n}\n","export class SaveModuleConfigModel {\n  public namespaceMap?: { [key: string]: string } = {};\n  public duplicate = false;\n  public replace = false;\n\n  constructor (init?: Partial<SaveModuleConfigModel>) {\n    Object.assign(this, init);\n  }\n}\n","export class SaveModuleModel {\n    primaryCategory: string;\n    secondaryCategory: string;\n    id: string;\n    name: string;\n}\n","import { Injectable } from '@angular/core';\nimport { Observable, forkJoin, of } from 'rxjs';\nimport { ThumbnailConstants } from '../shared/thumbnail.constants';\nimport { HttpHeaders, HttpClient } from '@angular/common/http';\nimport { ContentType } from '../story/models/content-type.enum';\nimport { StoryChapterThumbnail } from '../story/models/story-chapter-thumbnail.model';\nimport { get } from 'lodash';\nimport { catchError } from 'rxjs/operators';\n\n// #FIXME: Thumbnail service does not work for copying module to module thumbnails, which is the \n// whole point of this service.\n\nconst thumbnailServiceBaseURL = '/ws/thumbs';\nconst thumbnailServiceCopyURL = '/ws/thumbs/copy';\nconst thumbnailServiceOptions =  {\n  headers: new HttpHeaders().set('Content-Type', 'application/json'),\n  responseType: 'text'\n};\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class ModulesThumbnailService {\n\n  constructor(\n    private http: HttpClient\n  ) { }\n\n  saveStoryThumbnails(\n    { storyId, storyType, thumbnails, chapterIdMap, indexId, deleteUnused = false }:\n    { storyId: string;\n      storyType: ContentType;\n      thumbnails: Map<string, StoryChapterThumbnail>;\n      chapterIdMap: { [key: string]: string; };\n      indexId: string; \n      deleteUnused?: boolean; \n    }\n  ) {\n    /* Thumbnail Data\n    The thumbnails are specific to the currently loaded content.\n    Changes made to the thumbnais may or may not be replacements for the currently loaded content.\n    When current thumbnails are meant to be \"saved-as\", we need to have a map of the target ids to the current ids.\n    */\n      \n    // post/copy thumbnails for all story chapters and story\n    const thumbnailRequests$: Observable<any>[] = [];\n    const usedSourceIds = {};\n  \n    Object.entries(chapterIdMap)\n      .forEach(([chapterId, thumbId]) => {\n        const sourceThumbnail = thumbnails.get(thumbId); // the thumbnail object\n        usedSourceIds[thumbId] = true; // track as part of thumbnail cleanup\n\n        const targetPath = this.createThumbnailPath(storyType, storyId, chapterId);\n        const snapsnot = get(sourceThumbnail, 'snapshot');\n        \n        if (snapsnot) {\n          thumbnailRequests$.push(this.postThumbnail(sourceThumbnail.snapshot, targetPath));\n          if (chapterId === indexId) {\n            const indexPath = this.createThumbnailPath(storyType, storyId);\n            thumbnailRequests$.push(this.postThumbnail(sourceThumbnail.snapshot, indexPath));\n          }\n        } else {\n          // add copy request for existing story, chapter thumbnail, if it exists\n          const largeUrl = get(sourceThumbnail, 'urls.large');\n          if (largeUrl) {\n            const sourcePath = largeUrl.split('/thumbs/')[1];\n            thumbnailRequests$.push(this.copyThumbnail(sourcePath, targetPath));\n            if (chapterId === indexId) {\n              const indexPath = this.createThumbnailPath(storyType, storyId);\n              thumbnailRequests$.push(this.copyThumbnail(sourcePath, indexPath));\n            }\n          }\n        }\n      });\n\n    // delete any unused thumnbnails on the server (when we are replacing an existing story's thumbnails)\n    if (deleteUnused) {\n      Object.keys(thumbnails)\n        .filter(sourceChapterId => !(sourceChapterId in usedSourceIds))\n        .forEach(sourceChapterId => {\n          const deletePath = thumbnails.get(sourceChapterId).urls.large.split('/thumbs/')[1];\n          thumbnailRequests$.push(this.deleteThumbnail(deletePath));\n        });\n    }\n\n    return thumbnailRequests$;\n  }\n\n  // create the thumbnail location (relative to content)\n  private createThumbnailPath(storyType: ContentType, storyId: string, chapterId?: string): string {\n    // storyId: preview/test.json\n\n    // Sanitize story ID\n    storyId = storyId.replace('.json', '');\n    // storyId: preview/test\n\n    // Determine which thumbnail service to use\n    const thumbType = (storyType === ContentType.Bookmark) ? 'bookmarks' : 'modules';\n    let imageName = `${storyId}/large`;\n    // imageName: preview/test/large\n\n    if (!!chapterId) {\n      imageName = `${imageName}/chapters/${chapterId}.jpg`;\n\n      // imageName: preview/test/large/chapter-9472aead-8be3-43b9-9ae8-6821b4cfcccd.jpg\n    } else {\n      imageName = `${imageName}/index.jpg`;\n    }\n    \n    return [thumbType, imageName].join('/');\n  }\n\n  // request to server to save a thumbnail\n  private postThumbnail(sourceURL: string, targetPath: string): Observable<any> {\n    const { width, height } = ThumbnailConstants.medium;\n    const image = new Image();\n    const canvas = document.createElement('canvas');\n    canvas.width = width;\n    canvas.height = height;\n    const context = canvas.getContext('2d');\n    image.src = sourceURL;\n\n    return new Observable((observer) => {\n      image.onerror = () => {\n        observer.next();\n        observer.complete();\n      };\n      \n      image.onload = () => {\n        // transfer image to canvas\n        context.drawImage(image, 0, 0); \n\n        // convert to data url\n        const dataURL = canvas.toDataURL('image/jpeg', 1.0);\n\n        // issue post\n        const dstURL = [thumbnailServiceBaseURL, targetPath].join('/');\n        this.http.post(dstURL, {image: dataURL}, thumbnailServiceOptions as Object).subscribe(() => {\n          observer.next();\n          observer.complete();\n        });\n      };\n    });\n  }\n\n  // request to delete thumbnail from server\n  private deleteThumbnail(targetPath: string): Observable<any> {\n    const dstURL = [thumbnailServiceBaseURL, targetPath].join('/');\n    return new Observable((observer) => {\n      const request = new Request(dstURL, {method: 'DELETE'});\n      fetch(request).finally(() => { \n        observer.next();\n        observer.complete();\n      });\n    });\n  }\n\n  // request to server to copy a thumbnail from one location to another\n  private copyThumbnail(sourcePath: string, targetPath: string) {\n    return new Observable((observer) => {\n      this.http.post(thumbnailServiceCopyURL, {src: sourcePath, dst: targetPath}, thumbnailServiceOptions as Object).subscribe((r) => {\n        observer.next();\n        observer.complete();\n      });\n    });\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { HttpClient, HttpHeaders } from '@angular/common/http';\nimport { SerializeModuleService } from '../edit/serialize-module.service';\nimport { StoryModel } from '../story/models/story.model';\nimport { Observable, of } from 'rxjs';\nimport { map, catchError } from 'rxjs/operators';\nimport { ModulesSaveResultEnum } from './models/modules-save-result.enum';\nimport { ScenePathModel } from './models/scene-path.model';\nimport { SaveModuleModel } from './models/save-module.model';\nimport { BookmarkModel } from '../bookmarks/models/bookmark.model';\nimport { ContentType } from '../story/models/content-type.enum';\n\ndeclare const Human: any;\n\n// #NOTE: [EM] This assumes services on qa and scene-editor\n// #TODO: [EM] Make this service API explicit about qa vs production\n\nconst cdbURL = 'cdb/content';\nconst cdbCopyURL = `cdb/copy/content`;\n\nconst enum contentEnvironment {\n  qa = 'qa',\n  production = 'production'\n}\n\nconst formHeaders = {\n  headers: new HttpHeaders({\n    'Content-Type':  'application/json; charset=utf-8'\n  })\n};\n\n// top-level directories we wish to expose to content creators directly\nconst primaryCategories = [\n  'production', \n  'client', \n  'preview', \n  'internal_content',\n  'public_preview',\n  'demos',\n  'social',\n  'exports',\n  'real_data'\n];\n\nexport interface ListValue {\n  name: string;\n  type: string;\n}\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class ModulesService {\n\n  constructor(\n    private http: HttpClient,\n    private serializeModuleService: SerializeModuleService) { }\n\n  // write the story module to the modules server\n  saveModule(story: StoryModel, modulePath: string): Observable<ModulesSaveResultEnum> {\n    modulePath = this.formatModulePath(modulePath);\n    const url = [cdbURL, 'modules', modulePath].join('/');\n    \n    // !important: custom stringify, escape non-ASCII unicode sequences\n    const storyJSONString = this.JSONStringify(story);\n\n    return this.http.put(url, storyJSONString, formHeaders).pipe(\n      // success    \n      map(() => ModulesSaveResultEnum.Success),\n      // http status 201 | 202 treated as \"error\" by Angular HTTP, handle server response\n      catchError(({ status }) => {\n        if (status >= 200 && status <= 202) {\n          return of(ModulesSaveResultEnum.Success);\n        } else {\n          return of(ModulesSaveResultEnum.Fail);\n        }\n      })\n    );\n  }\n\n  // Post a request to make a hard copy of content state directory\n  copyState(sourceId: string, targetId: string): Observable<boolean> {\n    const url = [cdbCopyURL, `states`, targetId].join('/');\n    const options = {\n      headers: new HttpHeaders({\n        'Content-Type': 'application/json; charset=utf-8',\n        'source-state': sourceId\n      })\n    };\n    return this.http.put<boolean>(url, {}, options);\n  }\n\n  listContents(\n    primaryCategory: string, \n    secondaryCategory: string, \n    name: string,\n    convertToBookmark = false\n  ): Observable<ListValue[] | BookmarkModel[]> {\n    const path = this.generateModulePath(primaryCategory, secondaryCategory || '', name || '');    \n\n    return this.http.get(`/cdb/ls/content/modules/${path}`)\n      .pipe(\n        map((results: { contents: ListValue[] }) => {\n          if (convertToBookmark) {\n            const _results: BookmarkModel[] = results.contents.map(value => {\n              // For loft content, ID and Label both just use filename.\n              // For label, strip off the leading directories for easier parsing. \n              const id = value.name\n                .replace('/content/modules/', '')\n                .replace('.json', '');\n              \n              const title = value.name\n                .split('/')\n                .pop()\n                .replace('/content/modules', '')\n                .replace('.json', '');\n              \n              const bookmark = new BookmarkModel();\n              bookmark.id = id; \n              bookmark.title = title;\n              bookmark.type = ContentType.Module;\n              return bookmark;\n            });\n\n            return _results;\n          } else {\n            return results.contents as ListValue[];\n          }\n        })\n      ); \n  }\n\n  \n\n  getState(id: string) {\n    return this.http.get(`/cdb/ls/content/states/${id}`)\n      .pipe(\n        map((results: any) => {\n          return results.contents as Array<ListValue>;\n        })\n      );\n  }\n\n\n  // return list of BioDigital Client directories\n  getClients(): Observable<string[]> {\n    return this.http.get(`/search/client`)\n      .pipe(\n        map((response: { clients: string[] }) => {\n          return response.clients;\n        })\n      );\n  }\n\n  // Iterates through an entire scene and determine what states are in use by all the assets.\n  // A very thorough check resulting in quite a limited output.\n  getUsedStates() {\n    const states = {};\n\n    Object.values(Human.scene.objects)\n      .reduce((result, object: any) => {\n\n        ['transformId', 'morphId', 'geometryId', 'materialId'].forEach(property => {\n          const state = this.getPropertyState(object, property);\n          if (state.length) {\n            states[state] = true;\n          }\n        });\n\n        if (object.hasOwnProperty('renderables')) {\n          ['morphId', 'geometryId', 'materialId'].forEach(property => {\n            const renderables = object.renderables as Array<any>;\n            renderables.forEach((renderable) => {\n              const state = this.getPropertyState(renderable, property);\n              if (state.length) {\n                states[state] = true;\n              }\n            });\n          });\n        }\n\n        return result;\n    }, {});\n\n    return Object.keys(states);\n  }\n\n  // Get the semantically meaningful parts of a module path\n  parseScenePath(id: string): ScenePathModel {\n    const parts = id.split('/');\n    if (parts.length === 1) {\n      // invalid scene path\n      return null;\n    }\n\n    // # NOTE: [EM] hardcoded content environment\n    const urlSubDomain = contentEnvironment.qa; \n    return {\n      fullPath: `https://${urlSubDomain}.biodigital.com/content/modules/${id}`,\n      relativePath: parts.slice(0, parts.length - 1).join('/'),\n      sceneName: parts[parts.length - 1]\n    };\n  }\n\n  // ensure the moduleId has a .json extension\n  private formatModulePath(modulePath: string) {\n    let result = modulePath;\n    if (!/\\.json$/.test(modulePath)) {\n      result = `${result}.json`;\n    }\n    return result;\n  }\n\n\n  // Return a list of primary modules categories\n  getPrimaryCategories(): Observable<string[]> {\n    return of(primaryCategories);\n  }\n  \n  // Return a list of secondary catogories, given a primary category\n  getSecondaryCategories(primaryCategory: string): Observable<string[]> {\n    switch (primaryCategory) {\n      case 'production': {\n        // list gender categories\n        return of(['maleAdult', 'femaleAdult']);\n      }\n      case 'client': {\n        // list client-projects\n        return this.getClients();\n      }\n      default: {\n        // no secondary category available\n        return of([]);\n      }\n    }\n  }\n\n  generateSaveModule(id: string): SaveModuleModel {\n    const scenePath = this.parseScenePath(id);\n    const categories = scenePath.relativePath.split('/');\n    \n    return {\n      id: id,\n      name: scenePath.sceneName,\n      primaryCategory: categories[0] || '',\n      secondaryCategory: categories[1] || ''\n    };\n  }\n\n  generateModulePath(primaryCategory: string, secondaryCategory: string, name: string) {\n    const path = [];\n    if (primaryCategory.length) {\n      path.push(primaryCategory);\n    }\n\n    if (secondaryCategory.length) {\n      path.push(secondaryCategory);\n    }\n\n    if (name.length) {\n      if (name.indexOf('.json') < 0) {\n        name = `${name}.json`;\n      }\n      path.push(name);\n    }\n\n    return path.join('/');\n  }\n\n\n  private getPropertyState(object, property) {\n    if (object[property] != null) {\n      return object[property].split('/')[0];\n    }\n\n    return '';\n  }\n\n  // #TODO: centralize/reuse\n  private JSONStringify(object: any): string {\n    return JSON.stringify(object)\n      .replace(/[\\u007f-\\uffff]/g, (character) => {\n        return '\\\\u' + ('0000' + character.charCodeAt(0).toString(16)).slice(-4);\n      });\n  }\n}\n","import { ContentType } from 'src/app/story/models/content-type.enum';\nimport { TrimConfiguration } from 'src/app/edit/models/trim-config.model';\nimport { SaveModuleConfigModel } from '../models/save-module-config.model';\nimport { StoryModel } from 'src/app/story/models/story.model';\nimport { SaveModuleModel } from '../models/save-module.model';\nimport { StoryChapterThumbnail } from 'src/app/story/models/story-chapter-thumbnail.model';\n\nexport class Serialize {\n  static readonly type = '[Modules] Serialize'; // Serialize active story\n  constructor(public type: ContentType) {}\n}\n\nexport class SaveModule {\n  static readonly type = '[Modules] Save Module';\n  constructor(public id: string, public saveConfig: SaveModuleConfigModel, public trimConfig?: TrimConfiguration) {}\n}\n\nexport class SaveModuleSuccess {\n  static readonly type = '[Modules] Save Module Success';\n  constructor(public id: string, public story: StoryModel, public statesDuplicated = false) {}\n}\n\nexport class SaveModuleFailure {\n  static readonly type = '[Modules] Save Module Failure';\n  constructor(public id: string) {}\n}\n\nexport class DuplicateModuleSuccess {\n  static readonly type = '[Modules] Duplicate Module Success';\n  constructor(public id: string) {}\n}\n\nexport class DuplicateModuleFailure {\n  static readonly type = '[Modules] Duplicate Module Failure';\n  constructor(public id: string) {}\n}\n\nexport class SetSaveModule {\n  static readonly type = '[Modules] Set Save Module';\n  constructor(public module: SaveModuleModel) {}\n}\n\nexport class GetModulePrimaryCategories {\n  static readonly type = '[Modules] Get Primary Categories';\n  constructor() {}\n}\n\nexport class GetModuleSecondaryCategories {\n  static readonly type = '[Modules] Get Secondary Categories';\n  constructor(public primaryCategory: string) {}\n}\n\nexport class ResetModules {\n  static readonly type = '[Modules] Reset';\n  constructor() { }\n}\n","import { State, Store, Action, StateContext, Selector, createSelector } from '@ngxs/store';\nimport { \n  SaveModule,\n  SaveModuleSuccess,\n  SaveModuleFailure,\n  ResetModules,\n  SetSaveModule,\n  GetModulePrimaryCategories,\n  GetModuleSecondaryCategories,\n  DuplicateModuleSuccess,\n  DuplicateModuleFailure} from './modules.actions';\nimport { SerializeModuleService } from 'src/app/edit/serialize-module.service';\nimport { TrimConfiguration } from 'src/app/edit/models/trim-config.model';\nimport { ModulesService } from '../modules.service';\nimport { ModulesSaveResultEnum } from '../models/modules-save-result.enum';\nimport { StoryChaptersState } from 'src/app/story/state/chapters/story.chapters.state';\nimport { ModulesThumbnailService } from '../modules-thumbnail.service';\nimport { ContentType } from 'src/app/story/models/content-type.enum';\nimport { forkJoin } from 'rxjs';\nimport { take, finalize } from 'rxjs/operators';\nimport { SaveModuleModel } from '../models/save-module.model';\nimport { StoryService } from 'src/app/story/story.service';\nimport { StoryState } from 'src/app/story/state/story.state';\nimport { invert } from 'lodash';\nimport { ChapterUtils } from 'src/app/shared/chapter-utils';\nimport { ParticleActions } from 'src/app/engine/state/particles/particles.actions';\n\ninterface ModulesStateModel {\n  primaryCategoryOptions: string[];\n  secondaryCategoryOptions: string[];\n  moduleExists: boolean;\n  saveModule: SaveModuleModel;\n  storyType: ContentType;\n  saving: boolean;\n}\n\nconst initialTrim = new TrimConfiguration();\ninitialTrim.graph.hidden = true;\n\nconst initialState = {\n  primaryCategoryOptions: [],\n  secondaryCategoryOptions: [],\n  moduleExists: false,\n  saveModule: new SaveModuleModel(),\n  storyType: ContentType.Module,\n  saving: false\n};\n\n@State<ModulesStateModel>({\n  name: 'modules',\n  defaults: initialState\n})\nexport class ModulesState {\n  constructor(\n    private store: Store,\n    private serializeModuleService: SerializeModuleService,\n    private modulesService: ModulesService,\n    private modulesThumbnailService: ModulesThumbnailService,\n    private storyService: StoryService\n  ) { } \n\n  @Selector()\n  static getSaveModule(state: ModulesStateModel) {\n    return state.saveModule;\n  }\n\n  static getPrimaryCategoryOptions(type: 'read' | 'write') {\n    return createSelector(\n      [ModulesState],\n      (state: ModulesStateModel) => {\n        return (type === 'read') ? \n          state.primaryCategoryOptions : \n          state.primaryCategoryOptions.filter(value => value !== 'exports');\n      }\n    );\n  }\n\n  @Selector()\n  static getSecondaryCategoryOptions(state: ModulesStateModel) {\n    return state.secondaryCategoryOptions;\n  }\n\n  @Selector()\n  static getSaving(state: ModulesStateModel) {\n    return state.saving;\n  }\n\n\n  @Action(SaveModule)\n  async saveModule(context: StateContext<ModulesStateModel>, action: SaveModule) {\n    context.patchState({ saving: true });\n\n    // Prepare the save configurations\n    const saveConfig = action.saveConfig;\n    const trimConfig = action.trimConfig ? action.trimConfig : new TrimConfiguration();\n\n    // Generate a new namespace map for the serialize object, included all child properties.\n    // Then serialize the module.\n    const namespaceMap = saveConfig.duplicate ? action.saveConfig.namespaceMap : {};\n\n    // is save config dicates, generate new chapter Ids.\n    const chapters = this.store.selectSnapshot(StoryChaptersState.getStoryChapters);\n    const makeNewChapterIds = saveConfig.replace === false;\n    const chapterIdMap = ChapterUtils.makeChapterIdMap(chapters, makeNewChapterIds);\n\n    if (makeNewChapterIds) {\n      await this.store.dispatch(new ParticleActions.UpdateTweenParticleLookupChapters(chapterIdMap)).toPromise();\n    }\n    \n    // Serialize story\n    const serialized = this.serializeModuleService.serialize(\n      namespaceMap,\n      trimConfig,\n      action.saveConfig.duplicate,\n      this.store.selectSnapshot(StoryState.getStory),\n      this.store.selectSnapshot(StoryChaptersState.getStoryChapters),\n      chapterIdMap\n    );\n\n    // Save module file to the server.\n    this.modulesService.saveModule(serialized.story, action.id)\n      .pipe(\n        finalize(() => context.patchState({ saving: false }))\n      )\n      .subscribe(\n        (result: ModulesSaveResultEnum) => {\n          if (result === ModulesSaveResultEnum.Success) {\n\n            // Save thumbnails\n            const thumbs = this.store.selectSnapshot(StoryChaptersState.getRegisteredThumbnails);\n\n            // call service to save\n            const indexId = serialized.story.chapters[0].id;\n            \n            const requests$ = this.modulesThumbnailService.saveStoryThumbnails({\n              storyId: action.id,\n              storyType: ContentType.Module,\n              thumbnails: thumbs,\n              chapterIdMap: invert(chapterIdMap), \n              indexId: indexId,\n              deleteUnused: saveConfig.replace \n            });\n            \n            if (requests$.length === 0) {\n              context.dispatch(new SaveModuleSuccess(action.id, serialized.story, action.saveConfig.duplicate));  \n            } else {\n              forkJoin(requests$).subscribe(() => {\n                context.dispatch(new SaveModuleSuccess(action.id, serialized.story, action.saveConfig.duplicate));  \n              });\n            }\n\n          } else {\n            context.dispatch(new SaveModuleFailure(action.id));\n          }\n        }\n      );\n\n    // Duplicate module [working]\n    if (saveConfig.duplicate) {\n      const copyRequests$ = [];\n      Object.entries(namespaceMap)\n        .forEach(([sourceState, targetState]) => {\n          copyRequests$.push(this.modulesService.copyState(sourceState, targetState));\n        });\n\n      forkJoin(copyRequests$)\n        .subscribe(\n          (success) => {\n            context.dispatch(new DuplicateModuleSuccess(action.id));\n          },\n          (error) => {\n            context.dispatch(new DuplicateModuleFailure(action.id));\n          }\n        );\n    }\n  }\n\n  @Action(SetSaveModule)\n  setSaveModule(context: StateContext<ModulesStateModel>, action: SetSaveModule) {\n    context.patchState({\n      saveModule: {...action.module}\n    });\n  }\n\n  @Action(GetModulePrimaryCategories)\n  getModulePrimaryCategories(context: StateContext<ModulesStateModel>, action: GetModulePrimaryCategories) {\n    this.modulesService.getPrimaryCategories()\n      .subscribe((categories) => {\n        context.patchState({\n          primaryCategoryOptions: categories\n        });\n      });\n  }\n\n  @Action(GetModuleSecondaryCategories)\n  getModuleSecondaryCategories(context: StateContext<ModulesStateModel>, action: GetModuleSecondaryCategories) {\n    this.modulesService.getSecondaryCategories(action.primaryCategory)\n      .subscribe((categories) => {\n        context.patchState({\n          secondaryCategoryOptions: categories\n        });\n      });\n  }\n\n  // # TODO: Wire up full state reset, not just patchState\n  @Action(ResetModules)\n  resetModules(context: StateContext<ModulesStateModel>, action: ResetModules) {\n    forkJoin(this.modulesService.getPrimaryCategories(), this.modulesService.getSecondaryCategories(''))\n      .pipe(\n        take(1)\n      )\n      .subscribe(([primaryCategories, secondaryCategories]) => {\n        context.patchState({\n          primaryCategoryOptions: primaryCategories,\n          secondaryCategoryOptions: secondaryCategories\n        });\n      });\n  }\n}\n","import { BookmarkModel } from 'src/app/bookmarks/models/bookmark.model';\n\nexport class CollectionModel {\n    collection_createdate: Date;\n    collection_desc: string;\n    collection_name: string;\n    collection_updatedate: Date;\n    collection_id: number;\n    group_id: number;\n    collection_content: BookmarkModel[];\n}\n","import { OrganizationAttributeModel } from './organization-attribute.model';\n\nexport class OrganizationModel {\n  name: string;\n  description: string;\n  id: number;\n  eid: string;\n  user_has_domain_access: boolean;\n  email_domain_restriction: boolean;\n  user_has_email_domain_access: boolean;\n  ip_address_restriction:  boolean;\n  group_attributes: OrganizationAttributeModel[];  \n  subscription: {\n    paid_through_date: Date;\n    expired:  boolean;\n    exists:  boolean;\n  };\n  user_allowances_reached:  boolean;\n  user_is_subscribed:  boolean;\n  users_count: number;\n  group_logos: {\n    error_whitebg: string;\n    default: string;\n    error_blackbg: string;\n    blackbg: string;\n    whitebg: string;\n  };\n  \n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { OrganizationPickerComponent } from './components/organization-picker/organization-picker.component';\nimport { NgxsModule } from '@ngxs/store';\nimport { OrganizationsState } from './state/organizations.state';\nimport { MaterialModule } from '../material.module';\nimport { SharedModule } from '../shared/shared.module';\nimport { CollectionPickerComponent } from './components/collection-picker/collection-picker.component';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    MaterialModule,\n    SharedModule,\n    NgxsModule.forFeature([\n      OrganizationsState\n    ])\n  ],\n  declarations: [\n    OrganizationPickerComponent,\n    CollectionPickerComponent\n  ],\n  exports: [\n    OrganizationPickerComponent,\n    CollectionPickerComponent\n  ]\n})\nexport class OrganizationsModule { }\n","import { Injectable } from '@angular/core';\nimport { HttpClient, HttpHeaders } from '@angular/common/http';\nimport { Observable } from 'rxjs';\nimport { CollectionModel } from './models/collection.model';\nimport { map, flatMap, filter } from 'rxjs/operators';\nimport { plainToClass } from 'class-transformer';\nimport { BookmarkModel } from '../bookmarks/models/bookmark.model';\nimport { CollectionContentModel } from './models/collection.content.model';\nimport { OrganizationAttributeModel } from './models/organization-attribute.model';\nimport { BookmarksService } from '../bookmarks/bookmarks.service';\nimport { OrganizationUserModel } from './models/organization-user.model';\n\nexport interface OrganizationInviteResponse {\n  email: string;\n  reason: string;\n  status: 'success' | 'error';\n}\n\n/**\n * Collections service endpoint\n */\nconst collectionsURL = '/ws/enterprise/collection';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class OrganizationsService {\n\n  constructor(\n    private http: HttpClient,\n    private bookmarkService: BookmarksService\n  ) { }\n\n  getOrganizationUsers(group_eid: string): Observable<OrganizationUserModel[]> {\n    return this.http.get(`/ws/enterprise/profile?group_eid=${group_eid}`)\n      .pipe(\n        map((response: any) => response.user_list)\n      );\n  }\n\n  sendOrganizationInvites(group_eid: string, invite_emails: string[]): Observable<OrganizationInviteResponse[]> {\n    return this.http.post('/ws/enterprise/invite', {\n      'group_eid': group_eid,\n      'invite_emails': JSON.stringify(invite_emails)\n    })\n      .pipe(\n        map((response: any) => {\n          const { messages } = response.results_summary;\n          return JSON.parse(messages);\n        })\n      );\n  }\n\n  getCollections(groupId: number): Observable<CollectionModel[]> {\n    return this.http.get(`${collectionsURL}?group_id=${groupId}`)\n      .pipe(\n        map((results: Object[]) => {\n          return plainToClass(CollectionModel, results)\n            .map((collection) => this.normalizeCollectionModel(collection));\n        })\n      );\n  }\n\n  getCollectionsByContent(groupId: number, content: CollectionContentModel, includeContent: boolean = false): Observable<CollectionModel[]> {\n    const { content_type, content_id } = content;\n    const url = `${collectionsURL}?group_id=${groupId}&content_type=${content_type}&content_id=${content_id}&include_content=${includeContent ? 1 : 0}`;\n    return this.http.get(url)\n      .pipe(\n        map((results: Object[]) => {\n          return plainToClass(CollectionModel, results)\n            .map((collection) => this.normalizeCollectionModel(collection));\n        })\n      );\n  }\n\n  /**\n   * Gets the collection content id by content\n   */\n  getCollectionContentId(collection: CollectionModel, content: CollectionContentModel): Observable<number> {\n    const { content_type, content_id } = content;\n    return this.getCollectionsByContent(collection.group_id, content, true)\n      .pipe(\n        // restrict to target collection\n        map((collections) => collections.find((c) => c.collection_id === collection.collection_id)),\n        map((c) => {\n          let foundBookmark: BookmarkModel;\n          if (c) {\n            foundBookmark = c.collection_content.find((bookmark) => {\n              return content_type === 'module' ? content_id === bookmark.module_name : content_id === bookmark.id;\n            });\n          }\n          return foundBookmark ? foundBookmark.collection_content_id : null;\n        })\n      );\n  }\n\n  /**\n   * Gets an individual group collection.\n   */\n  getCollection(groupId: number, collectionId: number, includeContent: boolean): Observable<CollectionModel> {\n    return this.http.get(`${collectionsURL}?group_id=${groupId}&collection_id=${collectionId}&include_content=${includeContent ? 1 : 0}`)\n      .pipe(\n        map((collections: CollectionModel[]) => {\n          const collection = collections[0];\n          return collection ? this.normalizeCollectionModel(collection) : collection;\n        })\n      );\n  }\n\n  /**\n   * Gets the list of models in the specified collection.\n   */\n  getCollectionContent(groupId: number, collectionId: number, query = ''): Observable<BookmarkModel[]> {\n    const queryParts = query.toLocaleLowerCase().split(' ');\n\n    return this.getCollection(groupId, collectionId, true)\n      .pipe(\n        map((result: CollectionModel) => {\n          // exclude unavailable\n          return result.collection_content\n            .map((bookmark) => plainToClass(BookmarkModel, bookmark))\n            .filter((bookmark: BookmarkModel) => {\n              let include = true;\n              \n              if (queryParts.length && bookmark.title) {\n                queryParts.forEach(queryPart => {\n                  include = include && bookmark.title.toLocaleLowerCase().indexOf(queryPart) >= 0;\n                });\n              }\n\n              include = include && bookmark.unavailable !== true;\n              return include;\n            });\n        })\n      );\n  }\n\n  addToCollection(collection: CollectionModel, models: CollectionContentModel[]): Observable<CollectionModel[]> {\n    return this.formPost<CollectionModel[]>(collectionsURL, {\n      group_id: collection.group_id,\n      collection_id: collection.collection_id,\n      add_content: models\n    })\n    .pipe(\n      map((_collections) => {\n        return _collections.map((_collection) => this.normalizeCollectionModel(_collection));\n      })\n    );\n  }\n\n  removeFromCollection(collection: CollectionModel, collectionContentIds: number[]): Observable<CollectionModel[]> {\n    return this.formPost<CollectionModel[]>(collectionsURL, {\n      group_id: collection.group_id,\n      collection_id: collection.collection_id,\n      remove_content: collectionContentIds\n    })\n    .pipe(\n      map((_collections) => {\n        return _collections.map((_collection) => this.normalizeCollectionModel(_collection));\n      })\n    );\n  }\n\n  getOrganizationAttribute(attributes: OrganizationAttributeModel[], type: string, name: string): any {\n    return attributes.find((attribute) => attribute.type === type && attribute.name === name);\n  }\n\n  /**\n   * Adds the current user to the specified organization (by organization's eid)\n   */\n  addUserToOrganization(group_eid: string) {\n    return this.http.post(`/ws/enterprise/user/add`, { 'group_eid': group_eid });\n  }\n\n  addUserWithGroupCode(group_code: string): Observable<string> {\n    return this.http.post(`/ws/enterprise/user/add`, { 'group_code': group_code })\n      .pipe(\n        map((response: any) => response.organization_name)\n      );\n  }\n\n  private normalizeCollectionModel(collection: CollectionModel): CollectionModel {\n    if (collection.collection_content) {\n      collection.collection_content.forEach((bookmark) => {\n        this.bookmarkService.normalizeBookmarkModel(bookmark);\n      });\n    }\n    return collection;\n  }\n\n  // TODO: centralize form posting logic or migrate service to accept JSON\n  private formPost<T>(url: string, payload: Object): Observable<T> {\n    const formHeaders = {\n      headers: new HttpHeaders({\n        'Content-Type':  'application/x-www-form-urlencoded'\n      })\n    };\n    const body = new URLSearchParams();\n    Object.keys(payload).forEach((key) => {\n      const value = payload[key];\n      const encodedValue = `${value instanceof Object ? JSON.stringify(value) : value}`;\n      body.set(key, encodedValue);\n    });\n    return this.http.post(`${url}`, body.toString(), formHeaders)\n      .pipe(\n        map((reponse: T) => reponse)\n      );\n  }\n\n}\n","import { OrganizationModel } from '../models/organization.model';\nimport { CollectionModel } from 'src/app/organizations/models/collection.model';\nimport { OrganizationInviteResponse } from '../organizations.service';\nimport { OrganizationUserModel } from '../models/organization-user.model';\n\nexport class SetOrganizations {\n  static readonly type = '[Organizations] Set Organizations';\n  constructor(public organizations: OrganizationModel[]) { }\n}\n\nexport class SelectOrganization {\n  static readonly type = '[Organizations] Select Organization';\n  constructor(public organization: OrganizationModel) { }\n}\n\nexport class SelectCollection {\n  static readonly type = '[Organizations] Select Collection';\n  constructor(public collection: CollectionModel) { }\n}\n\nexport class GetCollections {\n  static readonly type = '[Organizations] Get Collections';\n  constructor(public organizationId: number) { }\n}\n\nexport class GetCollectionsSuccess {\n  static readonly type = '[Organizations] Get Collections Success';\n  constructor(public collections: CollectionModel[]) { }\n}\n\nexport class JoinOrganization {\n  static readonly type = '[Organizations] Join Organization';\n  constructor(public organization: OrganizationModel) { }\n}\n\nexport class JoinOrganizationSuccess {\n  static readonly type = '[Organizations] Join Organization Success';\n  constructor(public organization: OrganizationModel) { }\n}\n\nexport class JoinOrganizationFail {\n  static readonly type = '[Organizations] Join Organization Fail';\n  constructor(public organization: OrganizationModel) { }\n}\n\nexport class JoinOrganizationWithCode {\n  static readonly type = '[Organizations] Join Organization With Code';\n  constructor(public code: string) { }\n}\n\nexport class JoinOrganizationWithCodeSuccess {\n  static readonly type = '[Organizations] Join Organization With Code Success';\n  constructor(public organizationName: string) { }\n}\n\nexport class JoinOrganizationWithCodeFail {\n  static readonly type = '[Organizations] Join Organization With Code Fail';\n  constructor(public error: Error) { }\n}\n\n// Organization Invite\nexport class SendOrganizationInvite {\n  static readonly type = '[Organizations] Send Organization Invite';\n  constructor(public groupEID: string, public emails: string[]) { }\n}\n\nexport class SendOrganizationInviteSuccess {\n  static readonly type = '[Organizations] Send Organization Invite Success';\n  constructor(public responses: OrganizationInviteResponse[]) { }\n}\n\nexport class SendOrganizationInviteFail {\n  static readonly type = '[Organizations] Send Organization Invite Fail';\n  constructor(public error: Error) { }\n}\n\n// Get Users\nexport class GetOrganizationUsers {\n  static readonly type = '[Organizations] Get Organization Users';\n  constructor(public groupEID: string) { }\n}\n\nexport class GetOrganizationUsersSuccess {\n  static readonly type = '[Organizations] Get Organization Users Success';\n  constructor(public users: OrganizationUserModel[]) { }\n}\n\nexport class GetOrganizationUsersFail {\n  static readonly type = '[Organizations] Get Organization Users Fail';\n  constructor(public error: Error) { }\n}\n\n\nexport class ResetOrganizations {\n  static readonly type = '[Organizations] Reset';\n  constructor() { }\n}\n","import { OrganizationModel } from '../models/organization.model';\nimport { CollectionModel } from 'src/app/organizations/models/collection.model';\nimport { BookmarkGroupModel } from 'src/app/bookmarks/models/bookmark.group.model';\nimport { WidgetOptions } from 'src/app/publish/models/widget-options.model';\n\nexport class OrganizationsStateModel {\n   \n    organizations?: OrganizationModel[];\n    organization?: OrganizationModel;\n    collections?: CollectionModel[];\n\n    selectedOrganization?: OrganizationModel;\n    selectedCollection?: CollectionModel;\n\n    widgetURL?: string;\n    widgetOptions?: WidgetOptions;\n\n    appFeatures?: {\n        offlinePkgGen?: boolean;\n    };\n\n    // loading state\n    joining: boolean;\n    inviting: boolean;\n    loadingUsers: boolean;\n}\n","import { State, Action, StateContext, Selector } from '@ngxs/store';\nimport { OrganizationsStateModel } from './organizations.state.model';\nimport {\n  SelectOrganization,\n  SetOrganizations,\n  SelectCollection,\n  GetCollectionsSuccess,\n  GetCollections,\n  JoinOrganization,\n  JoinOrganizationSuccess,\n  JoinOrganizationFail,\n  ResetOrganizations,\n  JoinOrganizationWithCode,\n  JoinOrganizationWithCodeFail,\n  JoinOrganizationWithCodeSuccess,\n  SendOrganizationInvite,\n  SendOrganizationInviteSuccess,\n  SendOrganizationInviteFail,\n  GetOrganizationUsers,\n  GetOrganizationUsersSuccess,\n  GetOrganizationUsersFail\n} from './organizations.actions';\nimport { OrganizationsService } from '../organizations.service';\nimport { WidgetOptions } from 'src/app/publish/models/widget-options.model';\nimport { PublishService } from 'src/app/publish/publish.service';\nimport { SetPublishWidgetURL } from 'src/app/publish/state/publish.actions';\nimport { finalize } from 'rxjs/operators';\n\nconst initialState = {\n  joining: false,\n  inviting: false,\n  loadingUsers: false\n};\n\n@State<OrganizationsStateModel>({\n  name: 'organizations',\n  defaults: initialState\n})\nexport class OrganizationsState {\n  /**\n   * Selectors\n   */\n  @Selector()\n  static getOrganizations(state: OrganizationsStateModel) {\n    return state.organizations;\n  }\n\n  @Selector()\n  static getOrganization(state: OrganizationsStateModel) {\n    return state.organization;\n  }\n\n  @Selector()\n  static getSelectedOrganization(state: OrganizationsStateModel) {\n    return state.selectedOrganization;\n  }\n\n  @Selector()\n  static getCollections(state: OrganizationsStateModel) {\n    return state.collections;\n  }\n\n  @Selector()\n  static getSelectedCollection(state: OrganizationsStateModel) {\n    return state.selectedCollection;\n  }\n\n  @Selector()\n  static getWidgetURL(state: OrganizationsStateModel) {\n    return state.widgetURL;\n  }\n\n  @Selector()\n  static getWidgetOptions(state: OrganizationsStateModel) {\n    return state.widgetOptions;\n  }\n\n  @Selector()\n  static getAppFeatures(state: OrganizationsStateModel) {\n    return state.appFeatures;\n  }\n\n  @Selector()\n  static getJoining(state: OrganizationsStateModel) {\n    return state.joining;\n  }\n\n  @Selector()\n  static getInviting(state: OrganizationsStateModel) {\n    return state.inviting;\n  }\n\n  @Selector()\n  static getUsersLoading(state: OrganizationsStateModel) {\n    return state.loadingUsers;\n  }\n\n  /**\n   * Actions\n   */\n  @Action(SelectOrganization)\n  selectOrganization(context: StateContext<OrganizationsStateModel>, action: SelectOrganization) {\n    const organization = action.organization;\n    context.patchState({\n      selectedOrganization: organization,\n      selectedCollection: null\n    });\n\n    // Update collections\n    if (organization) {\n      context.dispatch(new GetCollections(organization.id));\n    }\n  }\n\n  @Action(SetOrganizations)\n  setOrganizations(context: StateContext<OrganizationsStateModel>, action: SetOrganizations) {\n    const organizations = action.organizations || [];\n    const organization = organizations[0];\n\n    let widgetURL: string;\n    let widgetOptions: WidgetOptions = null;\n    let appFeatures = { ... context.getState().appFeatures };\n\n    // read organization widget settings\n    if (organization && organization.group_attributes) {\n      const attributes = organization.group_attributes;\n\n     // set org default widget url\n     const widgetURLAttribute = this.organizationsService.getOrganizationAttribute(attributes, 'widget_settings', 'widget_custom_url_path');\n      if (widgetURLAttribute && widgetURLAttribute.value) {\n        widgetURL = widgetURLAttribute.value;\n      }\n\n      // set org default options\n      const widgetOptionsAttribute = this.organizationsService.getOrganizationAttribute(attributes, 'widget_settings', 'widget_url_params');\n      if (widgetOptionsAttribute && widgetOptionsAttribute.value) {\n        widgetOptions = this.publishService.extendWidgetOptions(new WidgetOptions(), widgetOptionsAttribute.value);\n      }\n\n      // set org app features\n      const appFeaturesAttribute = this.organizationsService.getOrganizationAttribute(attributes, 'app_settings', 'web_app_features');\n      if (appFeaturesAttribute) {\n        appFeatures = {\n          ...appFeatures,\n          ...appFeaturesAttribute.value\n        };\n      }\n    }\n\n    context.patchState({\n      organization: organization,\n      organizations: organizations,\n      widgetURL: widgetURL,\n      widgetOptions: widgetOptions,\n      appFeatures: appFeatures\n    });\n\n    // set default widget\n    context.dispatch(new SetPublishWidgetURL(widgetURL));\n  }\n\n  @Action(JoinOrganization)\n  joinOrganization(context: StateContext<OrganizationsStateModel>, { organization }: JoinOrganization) {\n    context.patchState({ joining: true });\n\n    this.organizationsService.addUserToOrganization(organization.eid)\n      .pipe(finalize(() => context.patchState({ joining: false })))\n      .subscribe(\n        () => context.dispatch(new JoinOrganizationSuccess(organization)),\n        (err) => context.dispatch(new JoinOrganizationFail(organization))\n      );\n  }\n\n  @Action(JoinOrganizationWithCode)\n  joinOrganizationWithCode(context: StateContext<OrganizationsStateModel>, { code }: JoinOrganizationWithCode) {\n    context.patchState({ joining: true });\n\n    this.organizationsService.addUserWithGroupCode(code)\n      .pipe(finalize(() => context.patchState({ joining: false })))\n      .subscribe(\n        (organizationName) => context.dispatch(new JoinOrganizationWithCodeSuccess(organizationName)),\n        (err) => context.dispatch(new JoinOrganizationWithCodeFail(err))\n      );\n  }\n\n  @Action(SendOrganizationInvite)\n  sendOrganizationInvite(context: StateContext<OrganizationsStateModel>, { groupEID, emails }: SendOrganizationInvite) {\n    context.patchState({ inviting: true });\n\n    this.organizationsService.sendOrganizationInvites(groupEID, emails)\n      .pipe(finalize(() => context.patchState({ inviting: false })))\n      .subscribe(\n        (responses) => context.dispatch(new SendOrganizationInviteSuccess(responses)),\n        (err) => context.dispatch(new SendOrganizationInviteFail(err))\n      );\n  }\n\n  @Action(GetOrganizationUsers)\n  getOrganizationUsers(context: StateContext<OrganizationsStateModel>, { groupEID }: GetOrganizationUsers) {\n    context.patchState({ loadingUsers: true });\n\n    this.organizationsService.getOrganizationUsers(groupEID)\n    .pipe(finalize(() => context.patchState({ loadingUsers: false })))\n      .subscribe(\n        (users) => context.dispatch(new GetOrganizationUsersSuccess(users)),\n        (err) => context.dispatch(new GetOrganizationUsersFail(err))\n      );\n  }\n\n  @Action(GetCollections)\n  getCollections(context: StateContext<OrganizationsStateModel>, action: GetCollections) {\n    this.organizationsService.getCollections(action.organizationId)\n      .subscribe((collections) => {\n        context.dispatch(new GetCollectionsSuccess(collections));\n      });\n  }\n\n  @Action(GetCollectionsSuccess)\n  getCollectionsSuccess(context: StateContext<OrganizationsStateModel>, action: GetCollectionsSuccess) {\n    context.patchState({\n      collections: action.collections\n    });\n  }\n\n  @Action(SelectCollection)\n  selectCollection(context: StateContext<OrganizationsStateModel>, action: SelectCollection) {\n    const { organization, selectedOrganization } = context.getState();\n    const collection = action.collection;\n\n    context.patchState({\n      // ensure organization selected\n      selectedOrganization: selectedOrganization || organization,\n      selectedCollection: collection\n    });\n  }\n\n  @Action(ResetOrganizations)\n  resetOrganizations(context: StateContext<OrganizationsStateModel>, action: ResetOrganizations) {\n    context.setState(initialState);\n  }\n\n  constructor(\n    private organizationsService: OrganizationsService,\n    private publishService: PublishService\n  ) { }\n}\n","<div class=\"error\">\n  <!-- downloadable error template -->\n  <div *ngIf=\"isSceneJSError; else notSceneJSError\">\n    <h1 class=\"text-24 text-bold\">\n      The BioDigital Human encountered an error.\n    </h1>\n    <h2 class=\"text-16 mt-4 mb-8\">\n      Error: <span class=\"text-semibold\">{{ sceneJSErrorTeaser }}</span>\n    </h2>\n    \n    <div class=\"text-16 mb-4\">\n      To receive assistance with this error, please follow these steps:\n    </div>\n\n    <ol class=\"text-16\">\n      <li class=\"mv-4\">\n        <button\n          app-button\n          buttonType=\"outline\"\n          buttonTheme=\"light\"\n          (click)=\"handleDownloadClick()\"\n        >\n          Download\n        </button>\n        the error report.\n      </li>\n      <li class=\"mv-4\">\n          <button\n            app-button\n            buttonType=\"outline\"\n            buttonTheme=\"light\"\n            (click)=\"handleActionClick(supportURL)\"\n          >\n            Share the report\n          </button>\n          with the customer support team.\n      </li>\n    </ol>\n\n    <div class=\"mt-8\">\n      <button\n        app-button\n        buttonType=\"outline\"\n        buttonTheme=\"light\"\n        buttonSize=\"xsmall\"\n        *ngIf=\"!viewSceneJSErrorDetails\"\n        (click)=\"handleSeeDetailsClick()\"\n      >\n        See Details\n      </button>\n      <div>\n        <textarea\n          *ngIf=\"viewSceneJSErrorDetails\"\n          class=\"error__details mt-2\"\n          [value]=\"sceneJSErrorReport\"\n        >\n        </textarea>\n      </div>\n    </div>\n  </div>\n\n  <ng-template #notSceneJSError>\n    <!-- title -->\n    <div class=\"text-24 text-bold\">\n      {{ title }}\n    </div>\n\n    <!-- actions-->\n    <div class=\"flex items-start mt-10\">\n      <ng-container>\n        <button\n          app-button\n          buttonType=\"outline\"\n          buttonTheme=\"light\"\n          (click)=\"handleActionClick(supportURL)\"\n        >\n          Contact Support\n        </button>\n      </ng-container>\n    </div>\n\n    <!-- description -->\n    <div\n      class=\"error__description text-16 mt-8\"\n      [innerHTML]=\"description\"\n    ></div>\n  </ng-template>\n</div>\n","import { Component, ChangeDetectionStrategy, OnInit } from '@angular/core';\nimport {\n  FatalErrorCategoryEnum,\n  FatalErrorReportModel,\n} from 'src/app/shared/error/error.model';\nimport { defaultContentErrorReport } from 'src/app/shared/error/error-report-content';\nimport { ActivatedRoute } from '@angular/router';\nimport { MatSnackBar } from '@angular/material';\nimport {\n  authErrorConfig,\n  defaultAuthErrorConfig,\n} from 'src/app/widget/data/auth-error-config';\nimport { saveAs } from 'file-saver';\n\n@Component({\n  selector: 'app-error-page',\n  templateUrl: './error.component.html',\n  styleUrls: ['./error.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class ErrorComponent implements OnInit {\n  supportURL = 'https://support.biodigital.com';\n  isSceneJSError = false;\n  viewSceneJSErrorDetails = false;\n  sceneJSErrorReport: string;\n  errorConfig: FatalErrorReportModel;\n  sceneJSErrorTeaser: string;\n\n  handleSeeDetailsClick() {\n    this.viewSceneJSErrorDetails = true;\n  }\n\n  private buildSceneJSErrorReport(contentId: string, errorBlob: string) {\n    return {\n      contentId,\n      error: JSON.parse(atob(errorBlob)),\n      webglInfo: (window as any).SceneJS.WEBGL_INFO,\n    };\n  }\n\n  get title(): string {\n    return this.errorConfig.title;\n  }\n\n  get description(): string {\n    return this.errorConfig.description;\n  }\n\n  constructor(private route: ActivatedRoute, private snackBar: MatSnackBar) {}\n\n  ngOnInit() {\n    const {\n      errorType,\n      errorCode,\n      errorBlob,\n      errorUrl,\n    } = this.route.snapshot.queryParams;\n\n    if (errorType === FatalErrorCategoryEnum.SceneJS) {\n      this.isSceneJSError = true;\n      const errorReport = this.buildSceneJSErrorReport(errorUrl, errorBlob);\n      this.sceneJSErrorTeaser = errorReport.error.errorName;\n      this.sceneJSErrorReport = JSON.stringify(errorReport, null, 2);\n    } else if (errorType === FatalErrorCategoryEnum.Content) {\n      this.errorConfig = defaultContentErrorReport;\n    } else {\n      this.errorConfig = authErrorConfig[errorCode] || defaultAuthErrorConfig;\n    }\n  }\n\n  handleDownloadClick() {\n    saveAs(\n      new Blob([this.sceneJSErrorReport], { type: 'text/plain' }),\n      'BioDigital_Error_Report.txt'\n    );\n  }\n\n  handleActionClick(url: string) {\n    // launch URL in new window\n    const targetWindow = window.open(url);\n    if (!targetWindow) {\n      // notify user if blocked\n      this.snackBar.open(\n        'Unable to open link in new window, please check your pop-up settings.'\n      );\n    }\n  }\n}\n","<div class=\"publish\">\n    \n  <div class=\"publish__heading\">\n    <div>\n      <h1 class=\"publish__title\">\n        Publish\n      </h1>\n    </div>\n\n    <app-icon\n      class=\"publish__close\"\n      icon=\"times\"\n      size=\"lg\"\n      title=\"close\"\n      (click)=\"closeDialog()\">\n    </app-icon>\n  </div>\n\n  <div class=\"publish__contents\">\n    <app-publish *ngIf=\"bookmark\" [model]=\"bookmark\">\n    </app-publish>\n  </div>\n</div>\n","import { Component, OnInit, Inject, ChangeDetectionStrategy } from '@angular/core';\nimport { MatDialogRef, MAT_DIALOG_DATA } from '@angular/material/dialog';\nimport { BookmarkModel } from 'src/app/bookmarks/models/bookmark.model';\n\nexport interface PublishDialogData {\n  bookmark: BookmarkModel;\n}\n\n@Component({\n  selector: 'app-publish-dialog',\n  templateUrl: './publish-dialog.component.html',\n  styleUrls: ['./publish-dialog.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class PublishDialogComponent implements OnInit {\n  bookmark: BookmarkModel;\n\n  constructor(\n    private dialogRef: MatDialogRef<PublishDialogComponent>,\n    @Inject(MAT_DIALOG_DATA) data: PublishDialogData\n  ) {\n    this.bookmark = data.bookmark;\n  }\n\n  ngOnInit() {\n  }\n\n  closeDialog() {\n    this.dialogRef.close();\n  }\n\n}\n","<div #widgetContainer class=\"widget\">\n  <div\n    class=\"widget__container\"\n    [style.width]=\"width + 'px'\"\n    [style.height]=\"height + 'px'\"\n    [style.top]=\"topOffset + 'px'\"\n    [style.left]=\"leftOffset + 'px'\"\n    [style.transform]=\"'scale(' + scaleFactor +')'\">\n\n    <iframe\n      #widgetFrame\n      appEmbedSrc\n      allowfullscreen\n      id=\"widget-frame\"\n      class=\"widget__frame\"        \n      [model]=\"model\"\n      [width]=\"width\"\n      [height]=\"height\"\n      [style.width]=\"width + 'px'\"\n      [style.height]=\"height + 'px'\">\n    </iframe>\n  </div>\n</div>","import {\n  Component,\n  OnInit,\n  Input,\n  ChangeDetectionStrategy,\n  Output,\n  EventEmitter,\n  ViewChild,\n  ElementRef,\n  OnDestroy, ChangeDetectorRef\n} from '@angular/core';\nimport { BookmarkModel } from 'src/app/bookmarks/models/bookmark.model';\nimport { CameraService } from 'src/app/engine/camera.service';\nimport { CameraModel } from 'src/app/engine/models/camera.model';\nimport { Observable, Subject, interval, Subscription } from 'rxjs';\nimport { map, takeUntil, filter, tap } from 'rxjs/operators';\nimport { WidgetOptions } from '../../models/widget-options.model';\nimport { animationFrame } from 'rxjs/internal/scheduler/animationFrame';\nimport { ScreenDimensions } from 'src/app/shared/models/screen.dimensions.model';\nimport { BackgroundModel } from 'src/app/engine/models/background.model';\nimport { MessageEnum } from 'src/app/widget-api/models/message.enum';\nimport { EventsEnum } from 'src/app/engine/models/events.enum';\nimport { UiIO } from 'src/app/widget-api/models/ui.io';\nimport { InteractTypeEnum } from 'src/app/view/models/interact-type.enum';\nimport { ScrollModeEnum } from 'src/app/engine/models/scroll-mode.enum';\n\ndeclare const HumanAPI: any;\n\nconst scaleSmoothFactor = 0.95;\n\nexport interface PublishWidgetOptions {\n  width: number;\n  height: number;\n  scalable: boolean;\n  labelScale: number;\n  options: WidgetOptions;\n  backgroundColor: BackgroundModel;\n}\n\n@Component({\n  selector: 'app-publish-widget',\n  templateUrl: './publish-widget.component.html',\n  styleUrls: ['./publish-widget.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class PublishWidgetComponent implements OnInit, OnDestroy {\n  @ViewChild('widgetContainer', { static: true })\n  containerRef: ElementRef;\n\n  @ViewChild('widgetFrame', { static: true })\n  frameRef: ElementRef;\n\n  @Input()\n  model: BookmarkModel;\n\n  @Input()\n  public get options(): PublishWidgetOptions {\n    return this._options;\n  }\n  public set options(value: PublishWidgetOptions) {\n    if (value) {\n      this._options = value;\n      this.updateWidget(this.options);\n    }\n  }\n  private _options: PublishWidgetOptions;\n\n  width: number;\n  height: number;\n  scalable = false;\n  labelScale = 1;\n  \n  defaultBackgroundColor: BackgroundModel;\n  backgroundColor: BackgroundModel;\n\n  allVisibilityLayers = [];\n\n  @Output()\n  cameraUpdated = new EventEmitter<CameraModel>();\n\n  private ngUnsubscribe = new Subject();\n\n  get topOffset(): number {\n    const containerHeight = this.elRef.nativeElement.offsetHeight;\n    const targetOffset = (containerHeight - this.height) / 2;\n    return this.scaleFactor < 1 ? targetOffset : Math.max(0, targetOffset);\n  }\n\n  get leftOffset(): number {\n    const containerWidth = this.elRef.nativeElement.offsetWidth;\n    const targetOffset = (containerWidth - this.width) / 2;\n    return this.scaleFactor < 1 ? targetOffset : Math.max(0, targetOffset);\n  }\n\n  get scaleFactor(): number {\n    if (!this.scalable) {\n      return 1;\n    } else {\n      const { offsetWidth, offsetHeight } = this.containerRef.nativeElement;\n      const xScale = offsetWidth / this.width;\n      const yScale = offsetHeight / this.height;\n      const targetScale = Math.min(xScale, yScale, 1);\n\n      if (targetScale === 1) { // default scale\n        return 1;\n      } else { // scaled model: smooth\n        return targetScale * scaleSmoothFactor;\n      }\n    }\n  }\n\n  private _apiRef: any;\n  private _params: WidgetOptions;\n  private _defaultCamera: CameraModel;\n  private _currentCamera: CameraModel;\n  private _rotateDegrees: number;\n\n  constructor(\n    private elRef: ElementRef,\n    private cameraService: CameraService,\n    private changeDetectorRef: ChangeDetectorRef\n  ) { }\n\n  ngOnInit() {\n    const frameId = this.frameRef.nativeElement.id;\n    \n    this._apiRef = new HumanAPI({ iframeId: frameId });\n\n    // listen for API ready state\n    this.getAPIEvent(EventsEnum.HumanReady)\n      .pipe(takeUntil(this.ngUnsubscribe))\n      .subscribe(() => {\n\n        // ready state\n        this.setupCameraTracking();\n        this.setupCameraRotation();\n        this.setWidgetUIConfig(this._params);\n\n        // setup background color\n        this.getModelBackgroundColor()\n          .pipe(takeUntil(this.ngUnsubscribe))\n          .subscribe((modelColor) => {\n            this.defaultBackgroundColor = modelColor;\n            this.setWidgetBackground(this.options.backgroundColor || this.defaultBackgroundColor);\n          });\n        \n        this.getLayers()\n          .pipe(takeUntil(this.ngUnsubscribe))\n          .subscribe((allVisibilityLayers) => {\n            this.allVisibilityLayers = allVisibilityLayers;\n            this.changeDetectorRef.markForCheck();\n          });\n\n      });\n  }\n\n  ngOnDestroy() {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n  updateWidget(publishWidgetOptions: PublishWidgetOptions) {\n    this.width = publishWidgetOptions.width;\n    this.height = publishWidgetOptions.height;\n    this.scalable = publishWidgetOptions.scalable;\n    \n    this.setLabelScale(publishWidgetOptions.labelScale);\n    this.setWidgetUIConfig(publishWidgetOptions.options);\n    this.setWidgetBackground(this.options.backgroundColor || this.defaultBackgroundColor);\n  }\n\n  setWidgetUIConfig(widgetOptions: WidgetOptions) {\n      // API ready\n    if (this._apiRef && widgetOptions) {\n\n      const uiDisplay = this.convertWidgetOptionsToDisplayParams(widgetOptions);\n      this.setUIDisplay(uiDisplay);\n\n      const loadingExperience = ((initial) => {\n        if (initial.button) {\n          return InteractTypeEnum.Button;\n        }\n        if (initial.handHint) {\n          return InteractTypeEnum.Hand;\n        }\n        if (initial.play) {\n          return InteractTypeEnum.Play;\n        }\n        return undefined;\n      })(widgetOptions.initial);\n\n      const scrollCaptureMode = ((disableScroll) => {\n        if (disableScroll.alert) {\n          return ScrollModeEnum.DoNotCaptureShowMessage;\n        }\n        if (disableScroll.overlay) {\n          return ScrollModeEnum.DoNotCapture;\n        }\n        return ScrollModeEnum.Capture;\n      })(widgetOptions.disableScroll);\n\n      const setTutorialRequest: UiIO.UISetTutorialRequest = {\n        enabled: widgetOptions.uiTutorial\n      };\n\n      this._apiRef.send(MessageEnum.UISetLoadingExperience, loadingExperience);\n      this._apiRef.send(MessageEnum.UISetScrollCaptureMode, scrollCaptureMode);\n      this._apiRef.send(MessageEnum.UISetTutorial, setTutorialRequest);      \n    }\n  }\n\n  takeSnapshot(fileType: 'png' | 'jpeg' = 'jpeg', dimensions?: ScreenDimensions): Observable<string> {\n    return this.getAPIData(MessageEnum.UISnapshot, {\n      width: this.width,\n      height: this.height,\n      fileType,\n      ...dimensions\n    });\n  }\n\n  /**\n   * Orbits the camera around the model by specified degrees.\n   */\n  private setCameraOrbit(degrees: number) {\n    this.sendAPIData(MessageEnum.CameraOrbit, {\n      yaw: degrees\n    });\n  }\n\n  /**\n * Sets UI options (i.e., fullscreen, help, etc...)\n */\n  private setWidgetBackground(background: BackgroundModel) {\n    if (this._apiRef && background) {\n      this.sendAPIData(MessageEnum.UISetBackground, background);\n    }\n  }\n\n  private setLabelScale(scale: number) {\n    if (this._apiRef) {\n      this.sendAPIData(MessageEnum.LabelsSetScale, {\n        scale: scale\n      });\n    }\n  }\n\n  private setupCameraTracking() {\n\n    // get initial camera\n    this.getCurrentCamera()\n      .pipe(takeUntil(this.ngUnsubscribe))\n      .subscribe((currentCamera) => {\n\n        // set fixed default camera\n        this.setDefaultCamera(currentCamera);\n\n        // begin tracking camera changes\n        this.getCameraUpdates()\n          .pipe(takeUntil(this.ngUnsubscribe))\n          .subscribe((updateCamera) => {\n            this.setUpdateCamera(updateCamera);\n          });\n\n      });\n  }\n\n  // use API to rotate widget fixed amount in an interval\n  private setupCameraRotation() {\n    // setup camera rotate animation\n    let timeLast = performance.now();\n    interval(0, animationFrame)\n      .pipe(\n        filter(() => !!this._rotateDegrees), // on valid rotation values\n        map(() => this._rotateDegrees * (performance.now() - timeLast) * 0.001),\n        tap(() => timeLast = performance.now()),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe((degrees) => {\n        this.setCameraOrbit(degrees);\n      });\n  }\n\n  private setDefaultCamera(camera: CameraModel) {\n    this._defaultCamera = camera;\n    this.setUpdateCamera(camera);\n  }\n\n  private setUpdateCamera(camera: CameraModel) {\n    this._currentCamera = camera;\n\n    const camerasMatch = this.cameraService.areCamerasEqual(\n      this.cameraService.roundCamera(this._defaultCamera, 3),\n      this.cameraService.roundCamera(this._currentCamera, 3)\n    );\n\n    // dispatch changes: validate delta from original\n    const targetCamera = !camerasMatch ? this._currentCamera : null;\n    this.cameraUpdated.emit(targetCamera);\n  }\n\n  private getAPIEvent(event: EventsEnum): Observable<any> {\n    return new Observable<any>((observer) => {\n      this._apiRef.on(event, (data: any) => {\n        observer.next(data);\n      });\n    });\n  }\n\n  private getAPIData(message: MessageEnum, payload?: any): Observable<any> {\n    return new Observable<any>((observer) => {\n      this._apiRef.send(message, payload, (data: any) => {\n        observer.next(data);\n        observer.complete();\n      });\n    });\n  }\n\n  private sendAPIData(message: MessageEnum, payload?: any) {\n    this._apiRef.send(message, payload);\n  }\n\n  private getCurrentCamera(): Observable<CameraModel> {\n    return this.getAPIData(MessageEnum.CameraInfo)\n      .pipe(map((data: any) => {\n        return <CameraModel>{\n          eye: data.position,\n          look: data.target,\n          up: data.up\n        };\n      }));\n  }\n\n  private getModelBackgroundColor(): Observable<BackgroundModel> {\n    return this.getAPIData(MessageEnum.UIGetBackground)\n      .pipe(\n        map((data) => {\n          if (data) {\n            return new BackgroundModel(\n              [...[].concat(...data.colors)], // [[r,g,b,a], [r,g,b,a]] -> [r,g,b,a,r,g,b,a]\n              data.gradientType,\n              data.colorStops\n            );\n          } else {\n            return null;\n          }\n        })\n      );\n  }\n\n  private getCameraUpdates(): Observable<CameraModel> {\n    return this.getAPIEvent(EventsEnum.CameraUpdated)\n      .pipe(map((data) => {\n        const { position, target, up } = data;\n        return <CameraModel>{\n          eye: position,\n          look: target,\n          up: up\n        };\n      }));\n  }\n\n  private setUIDisplay(uiDisplay: UiIO.UIDisplayParams) {\n    this._apiRef.send(MessageEnum.UISetDisplay, uiDisplay);\n  }\n\n  private getLayers () {\n    return this.getAPIData(MessageEnum.SceneGetLayers);\n  }\n\n  private convertWidgetOptionsToDisplayParams(params: WidgetOptions): UiIO.UIDisplayParams {\n    return {\n      info: params.uiInfo,\n      search: params.uiSearch,\n      undo: params.uiUndo,\n      fullscreen: params.uiFullscreen,\n      nav: params.uiNav,\n      tools: params.uiTools,\n      help: params.uiHelp,\n      chapterList: params.uiChapterList,\n      labelList: params.uiLabelList,\n      anatomyDescriptions: params.uiAnatomyDescriptions,\n      legend: params.uiLegend,\n      loader: params.uiLoader,\n      whiteboard: params.uiWhiteboard,\n      visibilityLayers: params.uiVisibilityLayers,\n      anatomyLabels: params.uiAnatomyLabels\n    };\n  }\n}\n","<div class=\"publish theme-light\" [ngSwitch]=\"mode\">\n    \n    <div class=\"publish__options text-12\">\n\n      <!-- mode selection -->\n      <app-panel\n        [formGroup]=\"formModeGroup\"\n        label=\"Select a format to publish:\">\n        <div class=\"publish__flex-group\">\n          <mat-radio-group formControlName=\"mode\">\n            <mat-radio-button value=\"3d\" class=\"mr-2\">3D Embeddable</mat-radio-button>\n            <mat-radio-button value=\"2d\">Image</mat-radio-button>\n          </mat-radio-group>\n        </div>\n      </app-panel>\n\n      <!-- 3D mode-->\n      <ng-container *ngSwitchCase=\"'3d'\" [formGroup]=\"formEmbed\">\n        <!-- dimensions -->\n        <app-panel \n          formGroupName=\"dimensions\"\n          *ngIf=\"dimensions$ | async as dimensions\"\n          label=\"Size\">\n\n          <div class=\"publish__flex-group\" *ngIf=\"minDimensions$ | async as minDimensions\">\n\n              <app-form-field [isCompact]=\"true\" label=\"Width\" theme=\"light\" display=\"block\" class=\"mr-6\">\n                <input type=\"number\" class=\"publish__input input input--small\" formControlName=\"width\">\n                <div class=\"mt-1\" form-field-help>Min. {{ minDimensions.width }}px</div>\n              </app-form-field>\n        \n              <app-form-field [isCompact]=\"true\" label=\"Height\" theme=\"light\" display=\"block\">\n                <input type=\"number\" class=\"publish__input input input--small\" formControlName=\"height\">\n                <div class=\"mt-1\" form-field-help>Min. {{ minDimensions.height }}px</div>\n              </app-form-field>\n\n          </div>\n\n        </app-panel>\n          \n        <!-- display options -->\n        <app-panel\n          formGroupName=\"options\"\n          label=\"Display Options\">\n          <div class=\"publish__group\">\n            <mat-checkbox formControlName=\"uiInfo\">Information Panel</mat-checkbox>\n            <mat-checkbox formControlName=\"uiAnatomyDescriptions\">Anatomy Descriptions</mat-checkbox>\n            <mat-checkbox formControlName=\"uiSearch\">Search</mat-checkbox>\n            <mat-checkbox formControlName=\"uiNav\">3D Navigation</mat-checkbox>            \n            <mat-checkbox formControlName=\"uiTools\">Explore Toolbar</mat-checkbox>\n            <mat-checkbox formControlName=\"uiUndo\">Undo</mat-checkbox>\n            <mat-checkbox formControlName=\"uiFullscreen\">Fullscreen</mat-checkbox>\n            <mat-checkbox formControlName=\"uiHelp\">Help</mat-checkbox>\n            <mat-checkbox formControlName=\"uiWhiteboard\">Draw</mat-checkbox>\n            <mat-checkbox formControlName=\"uiAnatomyLabels\">Anatomy Labels</mat-checkbox>\n            <mat-checkbox formControlName=\"uiLabelList\">Label List</mat-checkbox>            \n            <mat-checkbox\n              formControlName=\"uiVisibilityLayers\"\n              *ngIf=\"hasVisibilityLayers()\">Layers</mat-checkbox>\n          </div>\n        </app-panel>\n\n        <!-- loading options -->\n        <app-panel label=\"Loading Experience\">\n\n          <div formGroupName=\"loader\" class=\"mb-2\">\n            <mat-checkbox formControlName=\"enabled\">Loading Progress Indicator</mat-checkbox>\n            <div class=\"m-1 ml-5\">\n              <mat-radio-group formControlName=\"mode\" class=\"publish__group\">\n                <mat-radio-button value=\"bar\" class=\"mv-1\">Bar</mat-radio-button>\n                <mat-radio-button value=\"circle\" class=\"mv-1\">Circle</mat-radio-button>\n              </mat-radio-group>\n            </div>\n          </div>\n\n          <div formGroupName=\"rotate\" class=\"mb-1\">\n            <mat-checkbox formControlName=\"enabled\" #rotate>Rotate 3D Model</mat-checkbox>\n            \n            <app-form-field *ngIf=\"rotate.checked\" label=\"Degrees\" theme=\"light\" [isCompact]=\"true\">\n              <input type=\"number\" class=\"publish__input input\" formControlName=\"value\">\n            </app-form-field>\n          </div>\n\n          <div formGroupName=\"initial\" class=\"mb-2\">\n            <mat-checkbox formControlName=\"enabled\">Show \"Click to Interact\" hint</mat-checkbox>\n            <div class=\"m-1 ml-5\">\n              <mat-radio-group formControlName=\"mode\" class=\"publish__group\">\n                <mat-radio-button value=\"button\" class=\"mv-1\">Button</mat-radio-button>\n                <mat-radio-button value=\"handHint\" class=\"mv-1\">Animated hand</mat-radio-button>\n                <mat-radio-button value=\"play\" class=\"mv-1\">Play</mat-radio-button>\n              </mat-radio-group>\n            </div>\n          </div>\n\n          <div formGroupName=\"options\">\n            <mat-checkbox formControlName=\"uiTutorial\">Getting Started Tutorial</mat-checkbox>\n          </div>\n\n          <div formGroupName=\"disableScroll\">\n            <mat-checkbox formControlName=\"enabled\">Disable scroll wheel zooming</mat-checkbox>\n            <div class=\"m-1 ml-5\">\n              <mat-radio-group formControlName=\"mode\" class=\"publish__group\">\n                <mat-radio-button value=\"alert\" class=\"mv-1\">Show alert</mat-radio-button>\n                <mat-radio-button value=\"overlay\" class=\"mv-1\">Do not show alert</mat-radio-button>\n              </mat-radio-group>\n            </div>\n          </div>\n\n        </app-panel>\n\n      </ng-container>\n\n      <!-- 2D mode -->\n      <ng-container\n        *ngSwitchCase=\"'2d'\"\n        [formGroup]=\"formSnapshot\">\n  \n          <!-- image size -->\n          <app-panel\n            label=\"Size\">\n\n              <app-tabs #imageTabs>\n                <!-- Pixels -->\n                <app-tab label=\"Pixels\">\n                  <button\n                    app-button\n                    buttonType=\"outline\"\n                    buttonTheme=\"light\"\n                    [uppercase]=\"false\"\n                    class=\"mt-2\"\n                    [matMenuTriggerFor]=\"imageSizes\">\n                    {{ formatScreenSizeText(selectedSnapshotSize) }} <app-icon icon=\"caret-down\" class=\"ml-1\"></app-icon>\n                  </button>\n        \n                  <mat-menu #imageSizes=\"matMenu\">\n                    <button\n                      mat-menu-item\n                      *ngFor=\"let snapSize of snapshotSizes\"\n                      (click)=\"handleSnapshotSizeClick(snapSize)\">\n                        {{ formatScreenSizeText(snapSize) }}\n                    </button>\n                  </mat-menu>\n        \n                  <div class=\"publish__flex-group mt-2\" formGroupName=\"dimensions\">\n                    <app-form-field [isCompact]=\"true\" label=\"Width\" theme=\"light\" display=\"block\" class=\"mr-6\">\n                      <input type=\"number\" class=\"publish__input input input--small\" formControlName=\"width\" [min]=\"minSnapshotPixels.width\" [max]=\"maxSnapshotPixels.width\">\n                      <div class=\"mt-1\" form-field-help>{{ minSnapshotPixels.width }}px to {{ maxSnapshotPixels.width }}px</div>\n                    </app-form-field>\n              \n                    <app-form-field [isCompact]=\"true\" label=\"Height\" theme=\"light\" display=\"block\">\n                      <input type=\"number\" class=\"publish__input input input--small\" formControlName=\"height\" [min]=\"minSnapshotPixels.height\" [max]=\"maxSnapshotPixels.height\">\n                      <div class=\"mt-1\" form-field-help>{{ minSnapshotPixels.height }}px to {{ maxSnapshotPixels.height }}px</div>\n                    </app-form-field>\n                  </div>\n                </app-tab>\n\n                <!-- Inches -->\n                <app-tab label=\"Inches\">\n                  <div class=\"publish__flex-group mt-2\" formGroupName=\"inches\">\n                    <app-form-field [isCompact]=\"true\" label=\"Width\" theme=\"light\" display=\"block\" class=\"mr-6\">\n                      <input type=\"number\" class=\"publish__input input input--small\" formControlName=\"width\" [min]=\"minSnapshotInches.width\" [max]=\"maxSnapshotInches.width\" step=\".01\">\n                      <div class=\"mt-1\" form-field-help>{{ minSnapshotInches.width }}\" to {{ maxSnapshotInches.width }}\"</div>\n                    </app-form-field>\n    \n                    <app-form-field [isCompact]=\"true\" label=\"Height\" theme=\"light\" display=\"block\" class=\"mr-6\">\n                      <input type=\"number\" class=\"publish__input input input--small\" formControlName=\"height\" [min]=\"minSnapshotInches.height\" [max]=\"maxSnapshotInches.height\" step=\".01\">\n                      <div class=\"mt-1\" form-field-help>{{ minSnapshotInches.height }}\" to {{ maxSnapshotInches.height }}\"</div>\n                    </app-form-field>\n                  </div>\n\n                  <div class=\"pt-2 text-small text-dim\">Images are published at 300 dpi</div>\n                </app-tab>\n              </app-tabs>\n          </app-panel>\n          \n          <!-- image type -->\n          <app-panel\n            label=\"Image Type\">\n            <div class=\"publish__flex-group\">\n              <mat-radio-group formControlName=\"imageType\">\n                <mat-radio-button matTooltip=\"Smallest file size, best for most uses.\" [value]=\"imageTypeEnum.JPEG\" class=\"mr-2\">JPEG</mat-radio-button>\n                <mat-radio-button matTooltip=\"Highest quality, best for print and offline use.\" [value]=\"imageTypeEnum.PNG\">PNG</mat-radio-button>\n              </mat-radio-group>\n            </div>\n          </app-panel>\n\n          <!-- Label Scale -->\n          <app-panel\n            label=\"Label Scale\">\n            <div class=\"publish__flex-group\">\n              <app-slider class=\"flex-grow\" theme=\"light\" formControlName=\"labelScale\" min=\"1\" max=\"5\" step=\"0.1\"></app-slider>\n              <button app-button buttonType=\"outline\" buttonTheme=\"light\" class=\"ml-1\" (click)=\"handleResetScale()\">Reset</button>\n            </div>\n          </app-panel>\n\n          <!-- color selection -->\n          <app-panel\n            label=\"Background Color\">\n            <div class=\"publish__flex-group\">\n              <app-color-picker\n                size=\"normal\"\n                alphaEnabled=\"false\"\n                [color]=\"snapshotBackgroundColor\"\n                (colorSelected)=\"handleSnapshotBackgroundSelected($event)\"\n                class=\"publish__picker\">\n              </app-color-picker>\n            \n              <button app-button buttonType=\"outline\" buttonTheme=\"light\" (click)=\"handleSnapshotBackgroundSelected(null)\">Reset</button>\n            </div>\n          </app-panel>\n\n          <div class=\"mt-4\">\n            <a href=\"https://www.biodigital.com/terms\" target=\"_blank\" class=\"text-link\">Read about our Terms of Use</a>\n          </div>\n\n      </ng-container>\n\n    </div>\n\n    <!-- actions -->\n    <div class=\"publish__actions\">\n\n      <!-- 3D options -->\n      <ng-container *ngSwitchCase=\"'3d'\">\n        <div class=\"text-12 p-2 mt-2 mb-2\">\n            Make this model available to anyone by publishing it to the web.\n        </div>\n\n        <div class=\"publish__actions-content\">\n          <button class=\"mb-2 w-100\" app-button buttonType=\"flat\" buttonTheme=\"light\" (click)=\"handleGenerateIFrame()\" [disabled]=\"!this.formEmbed.valid\">Copy embed</button>\n          <button class=\"w-100\" app-button buttonType=\"flat\" buttonTheme=\"light\" (click)=\"handleGenerateURL()\" [disabled]=\"!this.formEmbed.valid\">Copy URL</button>\n        </div>\n      </ng-container>\n\n      <!-- 2D options -->\n      <ng-container *ngSwitchCase=\"'2d'\">\n          <div class=\"text-12 p-2 mt-2 mb-2\">\n              Download this image or make it available to anyone by publishing it to the web.\n          </div>\n  \n          <div class=\"publish__actions-content\">\n            <button class=\"mb-2 w-100\" app-button buttonType=\"flat\" buttonTheme=\"light\" (click)=\"handleDownloadSnapClick()\" [disabled]=\"!this.formSnapshot.valid\">Download</button>\n            <button class=\"mb-2 w-100\" app-button buttonType=\"flat\" buttonTheme=\"light\" (click)=\"handleCopyImageURL()\" [disabled]=\"!this.formSnapshot.valid\">Copy URL</button>\n            <button class=\"w-100\" app-button buttonType=\"flat\" buttonTheme=\"light\" (click)=\"handleGenerateImage()\" [disabled]=\"!this.formSnapshot.valid\">Copy Embed</button>\n          </div>\n      </ng-container>\n      \n    </div>\n\n    <!-- widget -->\n    <!-- <app-publish-widget\n      #publishWidget\n      class=\"publish__embed\"\n      [model]=\"model\"\n      [widgetParams]=\"widgetOptions\"\n      [width]=\"widgetWidth\"\n      [height]=\"widgetHeight\"\n      [bgColor]=\"widgetBGColor\"\n      [scalable]=\"widgetScalable\"\n      [enableUI]=\"mode === '3d'\"\n      [labelScale]=\"labelScale\"\n      (cameraUpdated)=\"handleCameraUpdated($event)\">\n    </app-publish-widget> -->\n\n    <app-publish-widget\n      #publishWidget\n      class=\"publish__embed\"\n      [model]=\"model\"\n      [options]=\"publishWidgetOptions\">\n    </app-publish-widget>\n</div>","import { Component, OnInit, Input, ChangeDetectionStrategy, OnDestroy, ViewChild, ChangeDetectorRef } from '@angular/core';\nimport { MatSnackBar } from '@angular/material/snack-bar';\nimport { BookmarkModel } from 'src/app/bookmarks/models/bookmark.model';\nimport { Store, Select, Actions, ofActionDispatched } from '@ngxs/store';\nimport {\n    SetPublishDimensions,\n    GetPublishIFrame,\n    GetPublishURL,\n    GetPublishIFrameSuccess,\n    GetPublishIFrameFail,\n    SetPublishing,\n    GetPublishImageCode,\n    GetPublishImageCodeSuccess,\n    GetPublishImageCodeFail,\n    SavePublishImage,\n    SavePublishImageSuccess,\n    SavePublishImageFail\n} from '../../state/publish.actions';\nimport { PublishState } from '../../state/publish.state';\nimport { Observable, Subject, of } from 'rxjs';\nimport { ScreenDimensions } from 'src/app/shared/models/screen.dimensions.model';\nimport { ColorModel } from 'src/app/edit/models/color.model';\nimport { CameraModel } from 'src/app/engine/models/camera.model';\nimport { WidgetOptions } from '../../models/widget-options.model';\nimport { FormGroup, FormBuilder, Validators } from '@angular/forms';\nimport { debounceTime, takeUntil, flatMap, filter, map } from 'rxjs/operators';\nimport { OrganizationsState } from 'src/app/organizations/state/organizations.state';\nimport { PublishService } from '../../publish.service';\nimport { StorageService, StorageItemEnum } from 'src/app/shared/storage.service';\nimport { AuthState } from 'src/app/auth/state/auth/auth.state';\nimport { ClipboardService } from 'src/app/shared/clipboard.service';\nimport { DialogService } from 'src/app/dialogs/dialog.service';\nimport { PublishWidgetComponent, PublishWidgetOptions } from '../publish-widget/publish-widget.component';\nimport { ScreenModel } from 'src/app/shared/models/screen.model';\nimport { ImageTypeEnum } from 'src/app/shared/image.service';\nimport { BackgroundModel } from 'src/app/engine/models/background.model';\nimport { get } from 'lodash';\nimport { invalidateLocalWidgetOptions } from 'src/app/shared/storage-utils';\nimport { ViewLoaderEnum } from 'src/app/view/models/view-loader.enum';\nimport { ChapterService } from 'src/app/story/chapter.service';\nimport { StoryChaptersState } from 'src/app/story/state/chapters/story.chapters.state';\nimport { TabsComponent, TabItem } from 'src/app/shared/components/tabs/tabs/tabs.component';\nimport { SnapshotOptions } from '../../models/snapshot-options.model';\nimport { plainToClass } from 'class-transformer';\n\nconst snapshotSmall: ScreenModel = {\n  'title': 'Small',\n  'type': 'desktop',\n  'dimensions': {\n    'width': 480,\n    'height': 320\n  },\n  'orientation': 'horizontal'\n};\n\nconst snapshotMedium: ScreenModel = {\n  'title': 'Medium',\n  'type': 'desktop',\n  'dimensions': {\n    'width': 700,\n    'height': 550\n  },\n  'orientation': 'horizontal'\n};\n\nconst snapshotLarge: ScreenModel = {\n  'title': 'Large',\n  'type': 'desktop',\n  'dimensions': {\n    'width': 1920,\n    'height': 1200\n  },\n  'orientation': 'horizontal'\n};\n\nconst snapshotExtraLarge: ScreenModel = {\n  'title': 'Extra Large',\n  'type': 'desktop',\n  'dimensions': {\n    'width': 2560,\n    'height': 1440\n  },\n  'orientation': 'horizontal'\n};\n\nconst snapshotMax: ScreenModel = {\n  'title': 'Maximum',\n  'type': 'desktop',\n  'dimensions': {\n    'width': 5120,\n    'height': 2880\n  },\n  'orientation': 'horizontal'\n};\n\nconst ppi = 300; // Pixels per inch\n\n@Component({\n  selector: 'app-publish',\n  templateUrl: './publish.component.html',\n  styleUrls: ['./publish.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class PublishComponent implements OnInit, OnDestroy {\n  @ViewChild('imageTabs', { static: false, read: TabsComponent })\n  imageTabs: TabsComponent;\n\n  // snapshot state\n  readonly minSnapshotPixels: ScreenDimensions = {\n    width: 300,\n    height: 300\n  };\n  \n  readonly maxSnapshotPixels: ScreenDimensions = {\n    width: 5120,\n    height: 2880\n  };\n\n  readonly minSnapshotInches: ScreenDimensions = {\n    width: this.pixelsToInches(this.minSnapshotPixels.width),\n    height: this.pixelsToInches(this.minSnapshotPixels.height)\n  };\n\n  readonly maxSnapshotInches: ScreenDimensions = {\n    width: this.pixelsToInches(this.maxSnapshotPixels.width),\n    height: this.pixelsToInches(this.maxSnapshotPixels.height)\n  };\n\n  imageTypeEnum = ImageTypeEnum;\n  snapshotSizes: ScreenModel[] = [snapshotSmall, snapshotMedium, snapshotLarge, snapshotExtraLarge, snapshotMax];\n  selectedSnapshotSize = snapshotMedium;\n  snapshotBackgroundColor: BackgroundModel;\n\n  @Input() model: BookmarkModel;\n\n  @Select(PublishState.getDimensions)\n  dimensions$: Observable<ScreenDimensions>;\n\n  @Select(PublishState.getMinDimensions)\n  minDimensions$: Observable<ScreenDimensions>;\n\n  @ViewChild(PublishWidgetComponent, { static: true })\n  publishWidget: PublishWidgetComponent;\n\n  get rotateEnabled() {\n    const rotate = this.formEmbed.get('rotate').value;\n    return rotate.enabled;\n  }\n\n  get mode(): '2d' | '3d' {\n    return this.formModeGroup.get('mode').value;\n  }\n\n  get widgetBackgroundColor(): BackgroundModel {\n    if (this.mode === '2d') {\n      return this.snapshotBackgroundColor;\n    } else {\n      return this.embedBackgroundColor;\n    }\n  }\n\n  get widgetScalable(): boolean {\n    return this.mode === '2d';\n  }\n\n  get imageType(): ImageTypeEnum {\n    return this.formSnapshot.get('imageType').value;\n  }\n\n  get publishWidgetOptions(): PublishWidgetOptions {\n    if (this.formEmbed && this.formSnapshot) {\n      switch (this.mode) {\n        case '3d':\n            return this.widgetEmbedSettings;\n        case '2d':\n            return this.widgetSnapshotSettings;\n      }\n    }\n    return null;\n  }\n\n  get widgetEmbedSettings(): PublishWidgetOptions {\n    const dimensionsGroup = this.formEmbed.get('dimensions');\n    const widgetOptions = this.formEmbed.value.options || {};\n\n    const options = {\n      width: dimensionsGroup.get('width').value,\n      height: dimensionsGroup.get('height').value,\n      labelScale: 1.0,\n      scalable: false,\n      backgroundColor: this.embedBackgroundColor,\n      options: widgetOptions\n    };\n\n    return options;\n  }\n\n  get widgetSnapshotSettings(): PublishWidgetOptions {\n    const dimensionsGroup = this.formSnapshot.get('dimensions');\n    const labelScaleControl = this.formSnapshot.get('labelScale');\n    const widgetOptions = new WidgetOptions();\n\n    widgetOptions.uiTools = false;\n    widgetOptions.uiInfo = false;\n    widgetOptions.uiNav = false;\n    widgetOptions.uiMenu = false;\n    widgetOptions.uiAudio = false;\n    widgetOptions.uiUndo = false;\n    widgetOptions.uiSearch = false;\n    widgetOptions.uiWhiteboard = false;\n    widgetOptions.uiFullscreen = false;\n\n    const options = {\n      width: dimensionsGroup.get('width').value,\n      height: dimensionsGroup.get('height').value,\n      labelScale: labelScaleControl.value,\n      scalable: true,\n      backgroundColor: this.snapshotBackgroundColor,\n      options: widgetOptions\n    };\n\n    return options;\n  }\n\n  formModeGroup: FormGroup;\n  formEmbed: FormGroup;  \n  formSnapshot: FormGroup;\n\n  embedBackgroundColor: BackgroundModel;\n  labelScale: number;\n\n  private ngUnsubscribe = new Subject();\n\n  // optional: default options\n  private defaultWidgetOptions: WidgetOptions = {\n    ...new WidgetOptions(),\n    loadRotate: 10\n  };\n\n  constructor(\n    private store: Store,\n    private actions: Actions,\n    private publishService: PublishService,\n    private storageService: StorageService,\n    private clipboardService: ClipboardService,\n    private dialogService: DialogService,\n    private chapterService: ChapterService,\n    private snackBar: MatSnackBar,\n    private formBuilder: FormBuilder,\n    private changeDetectorRef: ChangeDetectorRef\n  ) {\n    this.initFormGroupMode();\n    this.initSnapshotForm();\n    this.initEmbedForm();\n  }\n\n  ngOnInit() {\n    this.initColors();\n    this.initActionListeners();\n\n    this.setupEmbedForm();\n    this.setupSnapshotForm();\n\n    this.store.dispatch(new SetPublishing(true));\n  }\n\n  ngOnDestroy() {\n    this.store.dispatch(new SetPublishing(false));\n\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n  initFormGroupMode() {\n    // mode selection form\n    this.formModeGroup = this.formBuilder.group({\n      mode: ['3d', Validators.required]\n    });\n  }\n\n  initSnapshotForm() {\n    const snapshotOptions = this.readSnapshotOptions();\n\n    this.formSnapshot = this.formBuilder.group({\n      dimensions: this.formBuilder.group({\n        width: [\n          snapshotOptions.dimensions.width,\n          [Validators.required, Validators.min(this.minSnapshotPixels.width), Validators.max(this.maxSnapshotPixels.width)]\n        ],\n        height: [\n          snapshotOptions.dimensions.height,\n          [Validators.required, Validators.min(this.minSnapshotPixels.height), Validators.max(this.maxSnapshotPixels.height)]\n        ]\n      }),\n      inches: this.formBuilder.group({\n        width: [\n          this.pixelsToInches(snapshotOptions.dimensions.width),\n          [Validators.required, Validators.min(this.minSnapshotInches.width), Validators.max(this.maxSnapshotInches.width)]\n        ],\n        height: [\n          this.pixelsToInches(snapshotOptions.dimensions.height),\n          [Validators.required, Validators.min(this.minSnapshotInches.height), Validators.max(this.maxSnapshotInches.height)]\n        ]\n      }),\n      imageType: [snapshotOptions.imageType, [Validators.required]],\n      labelScale: [snapshotOptions.labelScale || 1, [Validators.required]]\n    });\n\n    this.updateSnapshotPreset();\n  }\n\n  initEmbedForm() {\n    const widgetOptions = this.getWidgetOptions();\n    const dimensions = this.store.selectSnapshot(PublishState.getDimensions);\n    const minDimensions = this.store.selectSnapshot(PublishState.getMinDimensions);\n    const { button, handHint, play } = widgetOptions.initial;\n    const { alert, overlay } = widgetOptions.disableScroll;\n\n    // widget 3D form\n    this.formEmbed = this.formBuilder.group({\n      dimensions: this.formBuilder.group({\n        width: [dimensions.width, [Validators.min(minDimensions.width)]],\n        height: [dimensions.height, [Validators.min(minDimensions.height)]]\n      }),\n      options: this.formBuilder.group(widgetOptions),\n      loader: this.formBuilder.group({\n        enabled: widgetOptions.uiLoader !== ViewLoaderEnum.None,\n        mode: widgetOptions.uiLoader\n      }),\n      rotate: this.formBuilder.group({\n        enabled: widgetOptions.loadRotate !== null,\n        value: widgetOptions.loadRotate\n      }),\n      initial: this.formBuilder.group({\n        enabled: button || handHint || play,\n        mode: button ? 'button' : handHint ? 'handHint' ? play : 'play' : ''\n      }),\n      disableScroll: this.formBuilder.group({\n        enabled: alert || overlay,\n        mode: alert ? 'alert' : (overlay ? 'overlay' : '')\n      })\n    });\n  }\n\n  initColors() {\n    const widgetOptions = this.getWidgetOptions();\n\n    // set color\n    const colors = get(widgetOptions, 'background.colors');\n    if (colors) {\n      const color: ColorModel = {\n        red: colors[0],\n        green: colors[1],\n        blue: colors[2],\n        alpha: colors.length > 3 ? colors[3] : 1\n      };\n      this.embedBackgroundColor = this.getBackgroundFromColor(color);\n    }\n  }\n\n  initActionListeners() {\n    // Copy embed code to clipboard\n    this.actions\n      .pipe(\n        ofActionDispatched(GetPublishIFrameSuccess),\n        flatMap((response: GetPublishIFrameSuccess) => this.copyToClipboard(response.embed)),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe((copied) => {\n        this.snackBar.open(copied ? 'Successfully copied embed code to clipboard.' : 'Unable to copy embed code to clipboard.');\n      });\n\n    // Failed to generate embed code\n    this.actions\n      .pipe(\n        ofActionDispatched(GetPublishIFrameFail),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(() => {\n        this.snackBar.open(`Unable to generate embed code.`);\n      });\n\n    // Copy image url to clipboard\n    this.actions\n      .pipe(\n        ofActionDispatched(SavePublishImageSuccess),\n        flatMap((response: SavePublishImageSuccess) => this.copyToClipboard(response.imageURL)),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe((copied) => {\n        this.snackBar.open(copied ? 'Successfully copied image URL to clipboard.' : 'Unable to copy image URL to clipboard.');\n      });\n      \n    // Faield to generate image url\n    this.actions\n      .pipe(\n        ofActionDispatched(SavePublishImageFail),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(() => {\n        this.snackBar.open('Unable to generate image URL.');\n      });\n\n    // Copy image embed code to clipboard\n    this.actions\n      .pipe(\n        ofActionDispatched(GetPublishImageCodeSuccess),\n        flatMap((response: GetPublishImageCodeSuccess) => this.copyToClipboard(response.embed)),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe((copied) => {\n        this.snackBar.open(copied ? 'Successfully copied image embed code to clipboard.' : 'Unable to copy image embed code to clipboard.');\n      });\n      \n    // Failed to generate image embed code\n    this.actions\n      .pipe(ofActionDispatched(GetPublishImageCodeFail),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(() => {\n        this.snackBar.open(`Unable to generate embed code.`);\n      });\n  }\n\n  setupEmbedForm() {\n    const optionsGroup = this.formEmbed.get('options');\n    const dimensionsGroup = this.formEmbed.get('dimensions');\n    const loaderGroup = this.formEmbed.get('loader');\n    const rotateGroup = this.formEmbed.get('rotate');\n    const initialGroup = this.formEmbed.get('initial');\n    const disableScrollGroup = this.formEmbed.get('disableScroll');\n\n    // load progress params\n    const loadProgressEnabledField = loaderGroup.get('enabled');\n    const loadProgressValueField = loaderGroup.get('mode');\n\n    // set loader type on enabled state\n    loadProgressEnabledField.valueChanges\n      .pipe(takeUntil(this.ngUnsubscribe))\n      .subscribe((enabled) => {\n        if (enabled) {\n          loadProgressValueField.patchValue(ViewLoaderEnum.Bar);\n        } else {\n          loadProgressValueField.patchValue(ViewLoaderEnum.None);\n        }\n      });\n\n    // patch widget options for loader\n    loadProgressValueField.valueChanges\n      .pipe(takeUntil(this.ngUnsubscribe))\n      .subscribe((value) => {\n        optionsGroup.patchValue({\n          uiLoader: value\n        });\n        // enable loader form on valid type\n        if (value !== ViewLoaderEnum.None) {\n          loadProgressEnabledField.patchValue(true, { emitEvent: false });\n        }\n      });\n\n    // rotate params\n    const rotateEnabledField = rotateGroup.get('enabled');\n    const rotateValueField = rotateGroup.get('value');\n\n    // set rotate defaults when toggling rotate enabled\n    rotateEnabledField.valueChanges\n      .pipe(takeUntil(this.ngUnsubscribe))\n      .subscribe((enabled) => {\n        if (enabled) { // set default widget rotate\n          const rotateValue = typeof (rotateValueField.value) === 'number' ? rotateValueField.value : this.defaultWidgetOptions.loadRotate;\n          rotateValueField.patchValue(rotateValue);\n        } else { // reset widget rotate\n          optionsGroup.patchValue({\n            loadRotate: null\n          });\n        }\n      });\n\n    // push rotate changes to widget options\n    rotateValueField.valueChanges\n      .pipe(takeUntil(this.ngUnsubscribe))\n      .subscribe((value) => {\n        optionsGroup.patchValue({\n          loadRotate: value\n        });\n      });\n\n    // sync initial params\n    initialGroup.get('enabled').valueChanges\n      .pipe(takeUntil(this.ngUnsubscribe))\n      .subscribe((enabled) => {\n        initialGroup.patchValue({\n          mode: enabled ? 'button' : ''\n        });\n      });\n      \n    initialGroup.get('mode').valueChanges\n      .pipe(takeUntil(this.ngUnsubscribe))\n      .subscribe((mode) => {\n        initialGroup.patchValue({ enabled: !!mode }, { emitEvent: false });\n        optionsGroup.patchValue({\n          initial: {\n            button: mode === 'button',\n            handHint: mode === 'handHint',\n            play: mode === 'play'\n          }\n        });\n      });\n\n    // sync scroll params\n    disableScrollGroup.get('enabled').valueChanges\n      .pipe(takeUntil(this.ngUnsubscribe))\n      .subscribe((enabled) => {\n        disableScrollGroup.patchValue({\n          mode: enabled ? 'alert' : ''\n        });\n      });\n\n    disableScrollGroup.get('mode').valueChanges\n      .pipe(takeUntil(this.ngUnsubscribe))\n      .subscribe((mode) => {\n        disableScrollGroup.patchValue({ enabled: !!mode }, { emitEvent: false });\n        optionsGroup.patchValue({\n          disableScroll: {\n            alert: mode === 'alert',\n            overlay: mode === 'overlay'\n          }\n        });\n      });\n\n    // sync dimensions\n    dimensionsGroup.valueChanges\n      .pipe(\n        debounceTime(300),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe((dimensions) => {\n        this.setScreenDimensions(dimensions);\n      });\n      \n    this.dimensions$\n      .pipe(takeUntil(this.ngUnsubscribe))\n      .subscribe((dimensions) => {\n        dimensionsGroup.setValue(dimensions, { emitEvent: false });\n      });\n\n    optionsGroup.valueChanges\n      .pipe(takeUntil(this.ngUnsubscribe))\n      .subscribe((options) => {\n        // persist options\n        this.writeEmbedOptions(options);\n      });\n  }\n\n  setupSnapshotForm() {\n    const formSnapshotDimensionsGroup = this.formSnapshot.get('dimensions');\n    const formSnapshotInchesGroup = this.formSnapshot.get('inches');\n    const labelScaleControl = this.formSnapshot.get('labelScale');\n\n    this.formSnapshot.valueChanges\n      .pipe(\n        takeUntil(this.ngUnsubscribe),\n        debounceTime(50)\n      )\n      .subscribe((values: any) => {\n        this.labelScale = labelScaleControl.value;\n\n        const snapshotOptions = plainToClass(SnapshotOptions, values);\n        this.writeSnapshotOptions(snapshotOptions);\n        this.updateSnapshotPreset();\n\n        this.changeDetectorRef.markForCheck();\n      });\n\n\n    // The snapshot inches control changes the size indirectly by modifying the pixel dimensions value.\n    // It is not stored or submitted anywhere.\n    formSnapshotInchesGroup.valueChanges\n      .pipe(\n        debounceTime(500),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(() => {\n        const { width, height } = formSnapshotInchesGroup.value;\n          \n        if (formSnapshotInchesGroup.valid) {\n          formSnapshotDimensionsGroup.patchValue({\n            width: this.inchesToPixels(width),\n            height: this.inchesToPixels(height)\n          });\n        }\n      });\n  }\n\n  setScreenDimensions(dimensions: ScreenDimensions) {\n    this.store.dispatch(new SetPublishDimensions(dimensions));\n  }\n\n  handleGenerateIFrame() {\n    this.generateIFrameCode();\n  }\n\n  handleGenerateURL() {\n    this.generateURL();\n  }\n\n  handleCopyImageURL() {\n    this.generateImageURL();\n  }\n\n  handleGenerateImage() {\n    this.generateImageCode();\n  }\n\n  handleResetScale() {\n    this.formSnapshot.get('labelScale').setValue(1.0);\n  }\n\n  generateIFrameCode() {\n    const widgetOptions = this.formEmbed.value.options;\n    this.store.dispatch(new GetPublishIFrame(this.model, widgetOptions));\n  }\n\n  generateURL() {\n    const widgetOptions = this.formEmbed.value.options;\n    this.store.dispatch(new GetPublishURL(this.model, widgetOptions));\n  }\n\n  generateImageURL() {\n    const fileType = this.imageType === ImageTypeEnum.PNG ? 'png' : 'jpeg';\n\n    this.publishWidget.takeSnapshot(fileType)\n      .pipe(\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe((imageData) => {\n        this.store.dispatch(new SavePublishImage(imageData, fileType));\n      });\n  }\n\n  generateImageCode() {\n    const fileType = this.imageType === ImageTypeEnum.PNG ? 'png' : 'jpeg';\n\n    this.publishWidget.takeSnapshot(fileType)\n      .pipe(\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe((imageData) => {\n        const widgetOptions = new WidgetOptions(); // use default options\n        this.store.dispatch(new GetPublishImageCode(this.model, imageData, fileType, widgetOptions));\n      });\n  }\n\n  handleSnapshotBackgroundSelected(color: ColorModel) {\n    this.snapshotBackgroundColor = this.getBackgroundFromColor(color);\n    this.changeDetectorRef.markForCheck();\n  }\n\n  handleSnapshotSizeClick(screen: ScreenModel) {\n    this.selectedSnapshotSize = {\n      ...screen,\n    };\n    this.formSnapshot.patchValue({\n      dimensions: {\n        width: screen.dimensions.width,\n        height: screen.dimensions.height\n      },\n      inches: {\n        width: this.pixelsToInches(screen.dimensions.width),\n        height: this.pixelsToInches(screen.dimensions.height)\n      }\n    }, { emitEvent: false});\n  }\n\n  handleDownloadSnapClick() {\n    const fileType = this.imageType === ImageTypeEnum.PNG ? 'png' : 'jpeg';\n    \n    // When inches is selected, set DPI to 300\n    // This ony affects the metadata of JPEG images\n    const tabItem = <TabItem>this.imageTabs.tabItems[this.imageTabs.activeTab];\n    const customDpi = (tabItem.label === 'Inches') ? 300 : null;\n\n    this.publishWidget.takeSnapshot(fileType)\n      .pipe(\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe((imageData) => {\n        this.downloadImage(imageData, customDpi);\n      });\n  }\n\n  copyToClipboard(copyText: string): Observable<boolean> {\n    return this.clipboardService.copyToClipboard(copyText)\n      .pipe(\n        flatMap((copied) => {\n          if (copied) {\n            return of(copied);\n          } else {\n            return this.dialogService.openClipboardDialog(copyText)\n              .afterClosed();\n          }\n        })\n      );\n  }\n\n  formatScreenSizeText(screen: ScreenModel): string {\n    const { title, dimensions } = screen;\n    return `${title} (${dimensions.width} x ${dimensions.height})`;\n  }\n\n  hasVisibilityLayers() {\n    return this.publishWidget.allVisibilityLayers.some((visibilityLayers) => {\n      return Array.isArray(visibilityLayers) && visibilityLayers.length > 0;\n    });\n  }\n\n  private updateSnapshotPreset() {\n    const formSnapshotDimensionsGroup = this.formSnapshot.get('dimensions');\n    const { width, height } = formSnapshotDimensionsGroup.value;\n        \n    if (formSnapshotDimensionsGroup.valid) {\n      // Check the dimensions and see if they match any presets in the dropdown.\n      // If a match is found, select it. Otherwise write out the custom value.          \n      const foundSnap = this.snapshotSizes.find((snap) => snap.dimensions.width === width && snap.dimensions.height === height);\n\n      this.selectedSnapshotSize = {\n        ...this.selectedSnapshotSize,\n        title: foundSnap ? foundSnap.title : 'Custom',\n        dimensions: {\n          width: width,\n          height: height\n        }\n      };\n\n      this.changeDetectorRef.markForCheck();\n    }\n  }\n\n  private getBackgroundFromColor(color: ColorModel): BackgroundModel {\n    const colors = color ? [color.red, color.green, color.blue, color.alpha] : null;\n    if (colors) {\n      return new BackgroundModel(\n        [...colors, ...colors],\n        'radial',\n        [0, 100]\n      );\n    } else {\n      return null;\n    }\n  }\n\n  private getWidgetOptions(): WidgetOptions {\n\n    // read persisted options\n    const storedOptions = this.readEmbedOptions();\n\n    // read organization settings\n    const orgWidgetOptions = this.store.selectSnapshot(OrganizationsState.getWidgetOptions);\n\n    // apply saved settings\n    if (storedOptions) {\n      const userOptions = this.publishService.extendWidgetOptions(new WidgetOptions(), storedOptions);\n      return {\n        ...userOptions,\n        // !important: disable user background, expect from organization\n        background: orgWidgetOptions ? orgWidgetOptions.background : null\n      };\n    } else {\n      return orgWidgetOptions || new WidgetOptions();\n    }\n  }\n\n  private readEmbedOptions(): any {    \n\n    // invalidate widget options in local storage created before \n    // Wed Nov 13 2019 14:57:47 GMT-0500 (Eastern Standard Time)\n    const invalidateBefore = 1573675067505;\n    const userProfileId = this.getStorageKey();\n    invalidateLocalWidgetOptions(userProfileId, invalidateBefore);\n\n    // read persisted options\n    const storedOptions = this.storageService.getLocalJSON(StorageItemEnum.WidgetOptions);\n    return storedOptions ? storedOptions[this.getStorageKey()] : null;\n  }\n\n  private writeEmbedOptions(options: WidgetOptions) {\n    // patch options with a timestamp\n    const optionsWithTimestamp = {...options, timestamp: Date.now()};\n\n    // modify existing entry\n    const storedOptions = this.storageService.getLocalJSON(StorageItemEnum.WidgetOptions) || {};\n    const key = this.getStorageKey();\n    storedOptions[key] = optionsWithTimestamp;\n    this.storageService.setLocalItem(StorageItemEnum.WidgetOptions, storedOptions);\n  }\n\n  private writeSnapshotOptions(options: any) {\n    // modify existing entry\n    const storedOptions = this.storageService.getLocalJSON(StorageItemEnum.SnapshotOptions) || {};\n    const key = this.getStorageKey();\n    storedOptions[key] = options;\n    this.storageService.setLocalItem(StorageItemEnum.SnapshotOptions, storedOptions);\n  }\n\n  private readSnapshotOptions(): SnapshotOptions {    \n    // read persisted options\n    let storedOptions = this.storageService.getLocalJSON(StorageItemEnum.SnapshotOptions);\n    storedOptions = (storedOptions) ? storedOptions[this.getStorageKey()] : {};\n\n    const newOptions = new SnapshotOptions();\n\n    // Merge persisted and new options, since the data structure in new options\n    // may vary from a legacy cookie. \n    const result = {\n      ...newOptions,\n      ...storedOptions\n    };\n\n    return result;\n  }\n\n  // get unique key for widget settings\n  private getStorageKey(): string {\n    return this.store.selectSnapshot(AuthState.getUserProfile).eid;\n  }\n\n  private downloadImage(imageData: string, customDpi?: number) {\n    const title = this.model.title || 'snapshot';\n    const normalizedTitle = title.replace(/ /g, '_').replace(/\\W/g, '');\n    \n    const extension = this.imageType === ImageTypeEnum.PNG ? 'png' : 'jpg';\n    const fileName = `${normalizedTitle}.${extension}`;\n\n    this.publishService.exportImage(imageData, this.imageType, fileName, customDpi)\n      .pipe(\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe((success) => {\n        this.snackBar.open(success ? `Successfuly downloaded image` : `Unable to download image.`);\n      });\n  }\n\n  private pixelsToInches(pixels: number): number {\n    return parseFloat((pixels / ppi).toFixed(2));\n  }\n\n  private inchesToPixels(inches: number): number {\n    return inches * ppi;\n  }\n\n}\n","export const defaultScreen = {\n    'title': 'Desktop',\n    'type': 'desktop',\n    'dimensions': {\n        'width': 700,\n        'height': 550\n    },\n    'orientation': 'vertical'\n};\n\nexport const screens =  [\n    defaultScreen,\n    {\n        'title': 'Tablet Vertical',\n        'type': 'tablet',\n        'dimensions': {\n            'width': 768,\n            'height': 1024\n        },\n        'orientation': 'vertical'\n    },\n    {\n        'title': 'iPad Landscape',\n        'type': 'tablet',\n        'dimensions': {\n            'width': 1024,\n            'height': 768\n        },\n        'orientation': 'horizontal'\n    },\n    {\n        'title': 'Mobile Vertical',\n        'type': 'mobile',\n        'dimensions': {\n            'width': 414,\n            'height': 736\n        },\n        'orientation': 'vertical'\n    },\n    {\n        'title': 'Mobile Horizontal',\n        'type': 'mobile',\n        'dimensions': {\n            'width': 736,\n            'height': 414\n        },\n        'orientation': 'horizontal'\n    }\n];\n","import { Directive, Input, HostBinding, OnInit } from '@angular/core';\nimport { BookmarkModel } from 'src/app/bookmarks/models/bookmark.model';\nimport { SafeResourceUrl, DomSanitizer } from '@angular/platform-browser';\nimport { PublishService } from '../publish.service';\nimport { Store } from '@ngxs/store';\nimport { PublishState } from '../state/publish.state';\nimport { WidgetOptions } from '../models/widget-options.model';\nimport { AuthState } from 'src/app/auth/state/auth/auth.state';\n\n@Directive({\n  selector: 'iframe[appEmbedSrc]'\n})\nexport class EmbedSrcDirective implements OnInit {\n  @Input()\n  params: WidgetOptions;\n\n  @Input()\n  set model(bookmark: BookmarkModel) {\n    const widgetURL = this.store.selectSnapshot(PublishState.getWidgetURL);\n    const lang = this.store.selectSnapshot(AuthState.getUserLanguage);\n\n    // build URL\n    const url = this.publishService.getWidgetURL(bookmark, widgetURL, this.params, null, null, lang);\n\n    this.src = this.sanitizer.bypassSecurityTrustResourceUrl(url);\n  }\n\n  @Input()\n  id: string;\n\n  @HostBinding('src')\n  src: SafeResourceUrl;\n\n  constructor(\n    private store: Store,\n    private publishService: PublishService,\n    private sanitizer: DomSanitizer) {\n  }\n\n  ngOnInit() {\n  }\n}\n","import { BackgroundModel } from 'src/app/engine/models/background.model';\n\nexport class SnapshotOptions {\n    constructor(\n        public dimensions = { width: 700, height: 550 },\n        public imageType = 'image/jpeg',\n        public labelScale = 1.0\n    ) { }\n}\n","import { ViewLoaderEnum } from 'src/app/view/models/view-loader.enum';\n\nexport class WidgetOptions {\n    \n    background = {\n        colors: null\n    };\n\n    // Misc\n    uiAnnotations = false;\n    uiAudio = false;\n    uiInfo = true;\n    uiFullscreen = true;\n\n    // Timeline\n    uiScrubber = false;\n\n    uiHelp = true;\n\n    // BG logo\n    uiBd: '' | 'no-link' | 'false' = '';\n\n    loadRotate: number = null;\n\n    initial = {\n        button: false,\n        handHint: false,\n        play: false\n    };\n\n    disableScroll = {\n        alert: false,\n        overlay: false\n    };\n\n    // viewer params\n    uiTour = false;\n    uiNav = true;\n    uiSearch = true;\n    uiTools = true;\n    uiUndo = true;\n    uiLabelList = true;\n    uiChapterList = false;\n    all = false;\n    collapseLabel: number = null;\n    uiMenu = true;\n    uiAnatomyDescriptions = false;\n    uiTutorial = false;\n    uiLegend = true;\n    uiLoader: ViewLoaderEnum = ViewLoaderEnum.Bar;\n    uiWhiteboard = true;\n    uiVisibilityLayers = true;\n    uiAnatomyLabels = true;\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { NgxsModule } from '@ngxs/store';\nimport { MaterialModule } from '../material.module';\nimport { SharedModule } from '../shared/shared.module';\nimport { PublishDialogComponent } from './components/publish-dialog/publish-dialog.component';\nimport { ReactiveFormsModule } from '@angular/forms';\nimport { EmbedSrcDirective } from './directives/embed-src.directive';\nimport { PublishState } from './state/publish.state';\nimport { PublishWidgetComponent } from './components/publish-widget/publish-widget.component';\nimport { PublishComponent } from './components/publish/publish.component';\nimport { ColorPickerModule } from 'ngx-color-picker';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    MaterialModule,\n    ReactiveFormsModule,\n    SharedModule,\n    ColorPickerModule,\n    NgxsModule.forFeature([\n      PublishState\n    ])\n  ],\n  declarations: [\n    PublishDialogComponent,\n    EmbedSrcDirective,\n    PublishWidgetComponent,\n    EmbedSrcDirective,\n    PublishComponent\n  ],\n  exports: [\n    PublishDialogComponent\n  ],\n  entryComponents: [\n    PublishDialogComponent\n  ]\n})\nexport class PublishModule { }\n","import { Injectable } from '@angular/core';\nimport { ScreenDimensions } from '../shared/models/screen.dimensions.model';\nimport { Observable, of, forkJoin } from 'rxjs';\nimport { SerializedParams } from './models/serialized-param.model';\nimport { BookmarkModel } from '../bookmarks/models/bookmark.model';\nimport { CameraService } from '../engine/camera.service';\nimport { NumberService } from '../shared/number.service';\nimport { CameraModel } from '../engine/models/camera.model';\nimport { WidgetOptions } from './models/widget-options.model';\nimport { flatMap, map, catchError } from 'rxjs/operators';\nimport { ExportService } from '../shared/export.service';\nimport { saveAs } from 'file-saver';\nimport { HttpHeaders, HttpClient } from '@angular/common/http';\nimport { UserAppModel } from '../auth/models/user-app.model';\nimport { PublishExportModel } from './models/publish-export.model';\nimport { DownloadEntryModel } from './models/download-entry.model';\nimport { ImageService, ImageTypeEnum } from '../shared/image.service';\nimport { defaultScreen } from './data/screens';\nimport { get } from 'lodash';\nimport { UrlUIConfig } from '../widget-config/initial-config';\nimport { changeDpiBlob } from 'changedpi';\nimport { environment } from 'src/environments/environment';\nimport { EnvironmentDeploy } from 'src/environments/models/environment-deploy';\n\nexport enum PublishLinkType {\n  Single = 'share.widget.link',\n  Bulk = 'share.widget.export',\n}\n\nconst formHeaders = {\n  headers: new HttpHeaders({\n    'Content-Type': 'application/json; charset=utf-8',\n  }),\n};\n\nconst defaultOptions = new WidgetOptions();\n\nconst embedDefaults = {\n  id: 'embedded-human',\n  dimensions: defaultScreen.dimensions,\n  fullScreen: true,\n};\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class PublishService {\n  constructor(\n    private http: HttpClient,\n    private cameraService: CameraService,\n    private numberService: NumberService,\n    private exportService: ExportService,\n    private imageService: ImageService\n  ) {}\n\n  exportImage(\n    imageData: string | Blob,\n    contentType: ImageTypeEnum,\n    fileName: string,\n    customDpi?: number\n  ): Observable<boolean> {\n    const exportBlob =\n      typeof imageData === 'string'\n        ? this.imageService.base64ToBlob(imageData, contentType)\n        : imageData;\n\n    // When publishing JPEG images for print using inches, the DPI should be recorded as 300 DPI in the JPEG header information.\n    // HTML Canvas exports to 72 DPI, and does not allow a custom value, so we have to manually change the value in the blog file.\n    // Does not apply to PNG, which does not store DPI information.\n    if (customDpi) {\n      changeDpiBlob(exportBlob, customDpi).then(function (dpiBlob) {\n        saveAs(dpiBlob, fileName);\n      });\n    } else {\n      saveAs(exportBlob, fileName);\n    }\n\n    return of(true);\n  }\n\n  exportModels(\n    models: BookmarkModel[],\n    widgetPath: string,\n    widgetOptions: WidgetOptions,\n    dimensions?: ScreenDimensions,\n    lang?: string,\n    app?: UserAppModel,\n    offlineEnabled: boolean = false\n  ): Observable<boolean> {\n    // default export columns\n    const userExportColumns = [\n      { label: 'Title', field: 'title' },\n      { label: 'URL', field: 'url' },\n      { label: 'iFrame', field: 'iFrame' },\n      { label: 'Author', field: 'author' },\n      { label: 'Thumbnail URL', field: 'thumbnail_url' },\n    ];\n    // optional export columns\n    if (offlineEnabled) {\n      userExportColumns.push({\n        label: 'Offline Package URL',\n        field: 'offline_url',\n      });\n    }\n\n    // get export models\n    return this.getExportModels(\n      models,\n      widgetPath,\n      widgetOptions,\n      dimensions,\n      lang,\n      app,\n      offlineEnabled\n    ).pipe(\n      // export models -> csv\n      flatMap((exportedModels) =>\n        this.exportService.exportCSV(exportedModels, userExportColumns)\n      ),\n      // download csv\n      map((csv) => {\n        // get formatted export name (YYYY-MM-DD)\n        const isoDate = new Date().toISOString().split('T')[0];\n        const exportFileName = `BioDigital-Widgets-${isoDate}-export.csv`;\n        const exportBlob = new Blob([csv], { type: 'text/csv;charset=utf-8' });\n        saveAs(exportBlob, exportFileName);\n\n        return true;\n      })\n    );\n  }\n\n  // Generates a list of export models per bookmark\n  getExportModels(\n    bookmarks: BookmarkModel[],\n    widgetPath: string,\n    widgetOptions: WidgetOptions,\n    dimensions?: ScreenDimensions,\n    lang?: string,\n    app?: UserAppModel,\n    offlineEnabled: boolean = false\n  ): Observable<PublishExportModel[]> {\n    // generate bulk export UAID (shared) + optional download links\n    const uaid$ = app ? of(null) : this.getUAID(PublishLinkType.Bulk);\n    const offlineURLs$ = offlineEnabled\n      ? this.getDownloadURLs(bookmarks)\n      : of([]);\n\n    return forkJoin(uaid$, offlineURLs$).pipe(\n      map(([uaid, offlineURLs]) => {\n        return bookmarks.map((bookmark, index) => {\n          const { title, author, thumbnail_url } = bookmark;\n          const url = this.getWidgetURL(\n            bookmark,\n            widgetPath,\n            widgetOptions,\n            null,\n            uaid,\n            lang,\n            app\n          );\n          const embed = this.getWidgetEmbed(url, dimensions);\n          const thumbnailURL = this.buildThumbnailURL(thumbnail_url);\n          const offlineURL = offlineURLs[index] || '';\n          const exportModel: PublishExportModel = {\n            title: title,\n            url: url,\n            iFrame: embed,\n            author: author,\n            thumbnail_url: thumbnailURL,\n            offline_url: offlineURL,\n          };\n          return exportModel;\n        });\n      })\n    );\n  }\n\n  /**\n   * Gets the widget URL\n   */\n  generateWidgetURL(\n    model: BookmarkModel,\n    widgetPath: string,\n    widgetOptions: WidgetOptions,\n    camera?: CameraModel,\n    linkType?: PublishLinkType,\n    lang?: string,\n    app?: UserAppModel\n  ): Observable<string> {\n    // generate optional UAID\n    const uaid$ = app || !linkType ? of(null) : this.getUAID(linkType);\n\n    return uaid$.pipe(\n      map((uaid) =>\n        this.getWidgetURL(\n          model,\n          widgetPath,\n          widgetOptions,\n          camera,\n          uaid,\n          lang,\n          app\n        )\n      )\n    );\n  }\n\n  getWidgetURL(\n    model: BookmarkModel,\n    widgetPath: string,\n    widgetOptions: WidgetOptions,\n    camera?: CameraModel,\n    uaid?: string,\n    lang: string = 'en',\n    app?: UserAppModel\n  ): string {\n    widgetOptions = widgetOptions || defaultOptions;\n\n    // add content params\n    const isBookmark = model.type === 'bookmark';\n    const contentParams = {};\n    const contentType = isBookmark ? 'be' : 'm';\n    const contentId = isBookmark ? model.id : model.module_name;\n    contentParams[contentType] = `${contentId}`;\n\n    // expand full list of params\n    const serializedParams = {\n      ...contentParams,\n      ...this.getParamsForUIOptions(widgetOptions || defaultOptions),\n      ...this.getParamsForLoadingExperience(widgetOptions || defaultOptions),\n      ...this.getParamsForScrollMode(widgetOptions || defaultOptions),\n      ...this.getParamsForLoadRotate(widgetOptions || defaultOptions),\n      ...this.getParamsForLabelScale(widgetOptions || defaultOptions),\n    };\n\n    // smooth BG color\n    const colors = get(widgetOptions, 'background.colors');\n    if (Array.isArray(colors) && colors.length >= 3) {\n      const smoothColor = colors\n        .slice(0, 4) // rgb(a)\n        .map((value) => this.numberService.roundNumber(value, 3));\n\n      serializedParams['background.colors'] = `${smoothColor}`;\n    }\n\n    // smooth camera\n    if (camera) {\n      const { eye, look, up } = this.cameraService.roundCamera(camera, 3);\n      const smoothCamera = [\n        eye.x,\n        eye.y,\n        eye.z,\n        look.x,\n        look.y,\n        look.z,\n        up.x,\n        up.y,\n        up.z,\n      ];\n      serializedParams['camera'] = `${smoothCamera}`;\n    }\n\n    // append dev key or uaid\n    if (app) {\n      // append developer key\n      serializedParams['dk'] = app.app_apikey;\n    } else if (uaid) {\n      // append UAID\n      serializedParams['uaid'] = uaid;\n    }\n\n    // append lang\n    if (lang && lang !== 'en') {\n      serializedParams['lang'] = lang;\n    }\n\n    // special case: always use custom widget\n    const targetWidgetPath = this.isCustomWidget(model.embed_url_path)\n      ? model.embed_url_path\n      : widgetPath;\n    return this.buildWidgetURL(targetWidgetPath, serializedParams);\n  }\n\n  /**\n   * Gets the widget embed code\n   */\n  generateWidgetEmbed(\n    model: BookmarkModel,\n    widgetPath: string,\n    widgetOptions: WidgetOptions,\n    dimensions?: ScreenDimensions,\n    camera?: CameraModel,\n    linkType?: PublishLinkType,\n    lang?: string,\n    app?: UserAppModel\n  ): Observable<string> {\n    // get URL\n    return this.generateWidgetURL(\n      model,\n      widgetPath,\n      widgetOptions,\n      camera,\n      linkType,\n      lang,\n      app\n    ).pipe(\n      // compose embed\n      map((url) => this.getWidgetEmbed(url, dimensions))\n    );\n  }\n\n  getWidgetEmbed(url: string, dimensions?: ScreenDimensions): string {\n    const { width, height } = dimensions || embedDefaults.dimensions;\n\n    return `<iframe\n  id=\"${embedDefaults.id}\"\n  frameBorder=\"0\"\n  width=\"${width}\"\n  height=\"${height}\"\n  allowFullScreen=\"${embedDefaults.fullScreen}\"\n  loading=\"lazy\"\n  src=\"${url}\">\n</iframe>`;\n  }\n\n  getImageEmbed(title: string, widgetURL: string, imageURL: string): string {\n    const imageTitle = `BioDigital Human: ${title}`.replace(/\"/g, '&quot;'); // encode double quotes\n    return `<a href=\"${widgetURL}\" target=\"_blank\"><img src=\"${imageURL}\" alt=\"${imageTitle}\" title=\"${imageTitle}\" /></a>`;\n  }\n\n  getUAID(linkType: PublishLinkType): Observable<string> {\n    const analytic = {\n      analytic_type: `${linkType}`,\n      analytic_platform: 'app',\n    };\n    return this.http\n      .post<string>(`/ws/user/analytics`, analytic, formHeaders)\n      .pipe(map((response: any) => response.id));\n  }\n\n  // generates an ordered list of download links for the specified bookmarks\n  getDownloadURLs(models: BookmarkModel[]): Observable<string[]> {\n    // create a list of download request models\n    const contentModels: DownloadEntryModel[] = models\n      .filter((bookmark) => !bookmark.favorite && !bookmark.unavailable) // exclude legacy content\n      .map((bookmark) => {\n        return {\n          type: bookmark.type,\n          id: bookmark.type === 'module' ? bookmark.module_name : bookmark.id,\n        };\n      });\n\n    return this.http\n      .post(\n        `/ws/download/reserve`,\n        { content: contentModels },\n        { headers: { 'Content-Type': 'application/json' } }\n      )\n      .pipe(\n        map((response: any) => {\n          const tokens: DownloadEntryModel[] = response.tokens;\n          // for each piece of content, generate download URL\n          return models.map((bookmark) => {\n            const type = bookmark.type;\n            const id =\n              bookmark.type === 'module' ? bookmark.module_name : bookmark.id;\n\n            // find token by type, id\n            const foundToken = tokens.find(\n              (token) => token.type === type && token.id === id\n            );\n\n            // build download from token\n            return foundToken && foundToken.token\n              ? this.buildDownloadURL(foundToken.token)\n              : '';\n          });\n        }),\n        catchError(() => of(models.map(() => '')))\n      );\n  }\n\n  /**\n   * Overwrites the target widget options w/ source widget data.\n   */\n  extendWidgetOptions(\n    targetWidgetOptions: WidgetOptions,\n    sourceWidgetData: any\n  ): WidgetOptions {\n    // expand flat options\n    const sourceWidgetOptions = this.expandWidgetOptions(sourceWidgetData);\n\n    // deep extend from source\n    this.deepExtendWidgetOptions(targetWidgetOptions, sourceWidgetOptions);\n\n    return targetWidgetOptions;\n  }\n\n  getWidgetConfig(widgetOptions: WidgetOptions): SerializedParams {\n    const serializedParams: SerializedParams = {};\n    const paramNames = Object.keys(widgetOptions);\n    paramNames.forEach((paramName) => {\n      const paramValue = widgetOptions[paramName];\n      if (paramValue !== null) {\n        const normalizedConfigName = this.getConfigName(paramName);\n        serializedParams[normalizedConfigName] = paramValue;\n      }\n    });\n    return serializedParams;\n  }\n\n  /**\n   * i.e., uiInfo -> ui-info -> info\n   */\n  getConfigName(name: string): string {\n    const dashCase = this.camelToDashCase(name);\n    const normalizedDashCase = dashCase.replace(/^ui-/g, '');\n    const configName = this.dashCaseToCamelCase(normalizedDashCase);\n    return configName;\n  }\n\n  getParamsForLoadingExperience(params: WidgetOptions) {\n    if (params.initial.button) {\n      return { 'initial.button': true };\n    }\n\n    if (params.initial.handHint) {\n      return { 'initial.hand': true };\n    }\n\n    if (params.initial.play) {\n      return { 'initial.play': true };\n    }\n\n    return {};\n  }\n\n  getParamsForScrollMode(params: WidgetOptions) {\n    if (params.disableScroll.alert) {\n      return { 'disable-scroll.alert': true };\n    }\n\n    if (params.disableScroll.overlay) {\n      return { 'disable-scroll': true };\n    }\n\n    return { 'disable-scroll': false };\n  }\n\n  getParamsForLoadRotate(params: WidgetOptions) {\n    if (typeof params.loadRotate === 'number') {\n      return { 'load-rotate': params.loadRotate };\n    }\n\n    return {};\n  }\n\n  getParamsForLabelScale(params: WidgetOptions) {\n    // if (typeof params.labelScale === 'number') {\n    //   return { 'label-scale': params.labelScale };\n    // }\n\n    return {};\n  }\n\n  getParamsForUIOptions(params: WidgetOptions): UrlUIConfig {\n    return {\n      'ui-info': params.uiInfo,\n      'ui-search': params.uiSearch,\n      'ui-undo': params.uiUndo,\n      'ui-fullscreen': params.uiFullscreen,\n      'ui-nav': params.uiNav,\n      'ui-tools': params.uiTools,\n      'ui-help': params.uiHelp,\n      'ui-chapter-list': params.uiChapterList,\n      'ui-label-list': params.uiLabelList,\n      'ui-anatomy-descriptions': params.uiAnatomyDescriptions,\n      'ui-tutorial': params.uiTutorial,\n      'ui-loader': params.uiLoader,\n      'ui-whiteboard': params.uiWhiteboard,\n      'ui-layers': params.uiVisibilityLayers,\n      'ui-anatomy-labels': params.uiAnatomyLabels\n    };\n  }\n\n  camelToDashCase(input: string): string {\n    return input.replace(/([a-z])([A-Z])/g, '$1-$2').toLowerCase();\n  }\n\n  dashCaseToCamelCase(input: string): string {\n    return input.replace(/-([a-z])/g, (g) => g[1].toUpperCase());\n  }\n\n  /**\n   * Returns true if the specified widget path is a custom widget.\n   */\n  isCustomWidget(path: string) {\n    return /widgets\\/([^\\/]+)\\//.test(path);\n  }\n\n  saveUserImage(\n    imageData: string,\n    imageType: 'png' | 'jpeg' = 'jpeg'\n  ): Observable<string> {\n    return this.http\n      .post<string>(\n        `/ws/user/image/v1-0`,\n        { image_src: imageData, image_type: imageType },\n        formHeaders\n      )\n      .pipe(map((response: any) => response.url));\n  }\n\n  private buildWidgetURL(\n    widgetPath: string,\n    widgetParams: SerializedParams\n  ): string {\n    // Build params\n    const encodedParams = Object.entries(widgetParams)\n      .map(([key, value]) => {\n        return `${key}=${value}`;\n      })\n      .join('&');\n\n    // strip leading and trailing slashes (/)\n    const normalizedWidgetPath = widgetPath.replace(/^\\/|\\/$/g, '');\n\n    // Enable testing of embed locally\n    if (environment.deploy === EnvironmentDeploy.Local) {\n      return `https://localhost:4202/?${encodedParams}`;\n    } else {\n      return `${window.location.origin}/${normalizedWidgetPath}/?${encodedParams}`;\n    }\n  }\n\n  private buildThumbnailURL(thumbPath: string): string {\n    return `${window.location.origin}${thumbPath}`;\n  }\n\n  private buildDownloadURL(token: string): string {\n    return `${window.location.origin}/download?t=${token}`;\n  }\n\n  /**\n   * Recursively set target widget field values from source data.\n   */\n  private deepExtendWidgetOptions(target: any, source: any) {\n    Object.entries(target).forEach(([targetField, targetValue]) => {\n      const targetType = typeof targetValue;\n\n      // account for variation in source name\n      const validFieldNames = [\n        // uiCameraMode\n        targetField,\n        // ui-camera-model\n        this.camelToDashCase(targetField),\n        // cameraMode\n        this.getConfigName(targetField),\n      ];\n\n      validFieldNames.forEach((validName) => {\n        if (source.hasOwnProperty(validName) && source[validName] !== null) {\n          const sourceValue = source[validName];\n          const sourceType = typeof sourceValue;\n          // special case: account for initial value\n          if (targetValue === null) {\n            target[targetField] = sourceValue;\n          } else if (targetType === sourceType) {\n            // validate types\n            // recursive set\n            if (targetType === 'object') {\n              this.deepExtendWidgetOptions(targetValue, sourceValue);\n            } else {\n              // set primitives\n              target[targetField] = sourceValue;\n            }\n          }\n        }\n      });\n    });\n  }\n\n  /**\n   * expands a flat obect { 'initial.button': true, 'initial.handHint': true } ->\n   * {\n   *  initial: {\n   *    'button': true,\n   *    handHint': true\n   *  }\n   * }\n   */\n  private expandWidgetOptions(source: any): any {\n    const target = {};\n    Object.entries(source).forEach(([key, value]) => {\n      const components = key.split('.');\n      if (components.length > 1) {\n        const parentFieldName = components[0];\n        const childFieldName = components.slice(1).join('.');\n        // create initial entry, else replace non-object types\n        if (\n          target[parentFieldName] === null ||\n          typeof target[parentFieldName] !== 'object'\n        ) {\n          target[parentFieldName] = {};\n        }\n        target[parentFieldName][childFieldName] = value;\n      } else {\n        target[key] = source[key];\n      }\n    });\n    return target;\n  }\n}\n","import { BookmarkModel } from 'src/app/bookmarks/models/bookmark.model';\nimport { ScreenDimensions } from 'src/app/shared/models/screen.dimensions.model';\nimport { ColorModel } from 'src/app/edit/models/color.model';\nimport { CameraModel } from 'src/app/engine/models/camera.model';\nimport { WidgetOptions } from '../models/widget-options.model';\n\nexport class SetPublishWidgetURL {\n  static readonly type = '[Publish] Set Widget URL';\n  constructor(public widgetURL: string) { }\n}\n\nexport class SetPublishDimensions {\n  static readonly type = '[Publish] Set Dimensions';\n  constructor(public dimensions: ScreenDimensions) { }\n}\n\nexport class SetPublishBackgroundColor {\n  static readonly type = '[Publish] Set Background Color';\n  constructor(public color: ColorModel) { }\n}\n\nexport class GetPublishIFrame {\n  static readonly type = '[Publish] Get iFrame';\n  constructor(\n    public model: BookmarkModel,\n    public widgetOptions?: WidgetOptions,\n    public camera?: CameraModel\n  ) { }\n}\n\nexport class GetPublishIFrameSuccess {\n  static readonly type = '[Publish] Get iFrame Success';\n  constructor(public embed: string) { }\n}\n\nexport class GetPublishIFrameFail {\n  static readonly type = '[Publish] Get iFrame Fail';\n  constructor() { }\n}\n\nexport class GetPublishURL {\n  static readonly type = '[Publish] Get URL';\n  constructor(\n    public model: BookmarkModel,\n    public widgetOptions?: WidgetOptions,\n    public camera?: CameraModel\n  ) { }\n}\n\nexport class GetPublishURLSuccess {\n  static readonly type = '[Publish] Get URL Success';\n  constructor(public model: BookmarkModel, public url: string) { }\n}\n\nexport class GetPublishURLFail {\n  static readonly type = '[Publish] Get URL Fail';\n  constructor(public model: BookmarkModel) { }\n}\n\nexport class SetPublishing {\n  static readonly type = '[Publish] Set Publishing';\n  constructor(public publishing: boolean) { }\n}\n\nexport class ResetPublish {\n  static readonly type = '[Publish] Reset Publishing';\n  constructor() { }\n}\n\nexport class SavePublishImage {\n  static readonly type = '[Publish] Save Publish Image';\n  constructor(public imageData: string, public imageType: 'png' | 'jpeg' = 'jpeg') { }\n}\n\nexport class SavePublishImageSuccess {\n  static readonly type = '[Publish] Save Publish Image Success';\n  constructor(public imageURL: string) { }\n}\n\nexport class SavePublishImageFail {\n  static readonly type = '[Publish] Save Publish Image Fail';\n  constructor() { }\n}\n\nexport class GetPublishImageCode {\n  static readonly type = '[Publish] Get Publish Image Code';\n  constructor(\n    public model: BookmarkModel,\n    public imageData: string,\n    public fileType: 'png' | 'jpeg',\n    public widgetOptions?: WidgetOptions,\n    public camera?: CameraModel    \n  ) { }\n}\n\nexport class GetPublishImageCodeSuccess {\n  static readonly type = '[Publish] Get Publish Image Code Success';\n  constructor(public embed: string) { }\n}\n\nexport class GetPublishImageCodeFail {\n  static readonly type = '[Publish] Get Publish Image Code Fail';\n  constructor() { }\n}\n","import { ScreenDimensions } from 'src/app/shared/models/screen.dimensions.model';\n\nexport class PublishStateModel {\n    publishing: boolean;\n    widgetURL: string;\n\n    // widget dimensions\n    dimensions: ScreenDimensions;\n    minDimensions: ScreenDimensions;\n\n    // developer\n    selectedAppId?: number;\n}\n","import { State, Action, StateContext, Selector, Store } from '@ngxs/store';\nimport { PublishStateModel } from './publish.state.model';\nimport { \n  SetPublishDimensions,\n  GetPublishURL,\n  GetPublishIFrame,\n  GetPublishURLSuccess,\n  GetPublishIFrameSuccess,\n  GetPublishURLFail,\n  GetPublishIFrameFail,\n  SetPublishWidgetURL, \n  SetPublishing,\n  ResetPublish,\n  GetPublishImageCode,\n  GetPublishImageCodeSuccess,\n  GetPublishImageCodeFail,\n  SavePublishImage,\n  SavePublishImageFail,\n  SavePublishImageSuccess\n} from './publish.actions';\nimport { PublishService, PublishLinkType } from '../publish.service';\nimport { defaultScreen } from '../data/screens';\nimport { AuthState } from 'src/app/auth/state/auth/auth.state';\nimport { forkJoin } from 'rxjs';\nimport { MatSnackBar } from '@angular/material';\nimport { ClipboardService } from 'src/app/shared/clipboard.service';\n\nconst defaultWidgetURL = '/viewer';\n\nconst initialState = {\n  publishing: false,\n  widgetURL: defaultWidgetURL,\n  dimensions: defaultScreen.dimensions,\n  minDimensions: {\n    width: 300,\n    height: 400\n  }\n};\n\n@State<PublishStateModel>({\n  name: 'publish',\n  defaults: initialState\n})\nexport class PublishState {\n  \n  @Selector()\n  static getDimensions(state: PublishStateModel) {\n    return state.dimensions;\n  }\n\n  @Selector()\n  static getMinDimensions(state: PublishStateModel) {\n    return state.minDimensions;\n  }\n\n  @Selector()\n  static getWidgetURL(state: PublishStateModel) {\n    return state.widgetURL;\n  }\n\n  @Selector()\n  static getPublishing(state: PublishStateModel) {\n    return state.publishing;\n  }\n\n  @Action(SetPublishWidgetURL)\n  setPublishWidgetURL(context: StateContext<PublishStateModel>, action: SetPublishWidgetURL) {\n    context.patchState({\n      widgetURL: action.widgetURL || defaultWidgetURL\n    });\n  }\n\n  @Action(SetPublishDimensions)\n  setPublishDimensions(context: StateContext<PublishStateModel>, action: SetPublishDimensions) {\n    context.patchState({\n      dimensions: action.dimensions\n    });\n  }\n\n  @Action(GetPublishURL)\n  getPublishURL(context: StateContext<PublishStateModel>, action: GetPublishURL) {\n    const { model, camera, widgetOptions } = action;\n    const { widgetURL } = context.getState();\n    const lang = this.store.selectSnapshot(AuthState.getUserLanguage);\n    const app = this.store.selectSnapshot(AuthState.getSelectedUserApp);\n\n    // get url\n    this.publishService.generateWidgetURL(model, widgetURL, widgetOptions, camera, PublishLinkType.Single, lang, app)\n      .subscribe(\n        (url) => {\n          context.dispatch(new GetPublishURLSuccess(model, url));\n        },\n        () => {\n          context.dispatch(new GetPublishURLFail(model));\n        });\n  }\n\n  @Action(GetPublishURLSuccess)\n  getPublishURLSuccess(context: StateContext<PublishStateModel>, action: GetPublishURLSuccess) {\n    this.clipboardService.copyToClipboard(action.url)\n      .subscribe(copied => {\n        this.snackbar.open(copied ? 'Successfully copied link to clipboard.' : 'Unable to copy link to clipboard.');\n      });\n  }\n\n  @Action(GetPublishURLFail)\n  getPublishURLFail(context: StateContext<PublishStateModel>, action: GetPublishURLFail) {\n    this.snackbar.open('Unable to generate URL.');\n  }\n\n  @Action(GetPublishIFrame)\n  getPublishIFrame(context: StateContext<PublishStateModel>, action: GetPublishIFrame) {\n    const { model, camera, widgetOptions } = action;\n    const { widgetURL, dimensions } = context.getState();\n    const lang = this.store.selectSnapshot(AuthState.getUserLanguage);\n    const app = this.store.selectSnapshot(AuthState.getSelectedUserApp);\n\n    // get embed code\n    this.publishService.generateWidgetEmbed(model, widgetURL, widgetOptions, dimensions, camera, PublishLinkType.Single, lang, app)\n      .subscribe(\n        (embedCode) => {\n          context.dispatch(new GetPublishIFrameSuccess(embedCode));\n        },\n        () => {\n          context.dispatch(new GetPublishIFrameFail());\n        });\n  }\n\n  @Action(SavePublishImage)\n  savePublishImage(context: StateContext<PublishStateModel>, { imageData, imageType }: SavePublishImage) {\n    this.publishService.saveUserImage(imageData, imageType)\n      .subscribe(\n        (imageURL) => {\n          context.dispatch(new SavePublishImageSuccess(imageURL));\n        },\n        () => {\n          context.dispatch(new SavePublishImageFail());\n        });\n  }\n\n  @Action(GetPublishImageCode)\n  getPublishImage(context: StateContext<PublishStateModel>, action: GetPublishImageCode) {\n    const { model, camera, widgetOptions, imageData, fileType } = action;\n    const { widgetURL } = context.getState();\n    const lang = this.store.selectSnapshot(AuthState.getUserLanguage);\n    const app = this.store.selectSnapshot(AuthState.getSelectedUserApp);\n\n    forkJoin(\n      this.publishService.generateWidgetURL(model, widgetURL, widgetOptions, camera, PublishLinkType.Single, lang, app), // generate widget url\n      this.publishService.saveUserImage(imageData, fileType) // generate image url      \n    )\n      .subscribe(\n        ([generatedWidgeURL, generatedImageURL]) => {\n          const embed = this.publishService.getImageEmbed(model.title, generatedWidgeURL, generatedImageURL);\n          context.dispatch(new GetPublishImageCodeSuccess(embed));\n        },\n        () => {\n          context.dispatch(new GetPublishImageCodeFail());\n        });\n  }\n\n  @Action(SetPublishing)\n  setPublishing(context: StateContext<PublishStateModel>, { publishing }: SetPublishing) {\n    context.patchState({\n      publishing: publishing\n    });\n  }\n\n  @Action(ResetPublish)\n  resetPublish(context: StateContext<PublishStateModel>, action: ResetPublish) {\n    context.setState(initialState);\n  }\n\n  constructor(\n    private clipboardService: ClipboardService,\n    private publishService: PublishService,\n    private store: Store,\n    private snackbar: MatSnackBar\n  ) {\n  }\n}\n","import * as Rollbar from 'rollbar';\nimport { InjectionToken, Injectable, ErrorHandler, Inject } from '@angular/core';\nimport { environment } from 'src/environments/environment';\nimport { EnvironmentDeploy } from 'src/environments/models/environment-deploy';\n\n\nconst rollbarConfig: Rollbar.Configuration = {\n  accessToken: environment.rollbarToken,\n  captureUncaught: true,\n  captureUnhandledRejections: true,\n  payload: {\n    environment: environment.deploy\n  },\n  ignoredMessages: [\n    'asset not found',\n    'this._setCompressedTextureImage is not a function'\n  ],\n  // enabled: environment.deploy !== EnvironmentDeploy.Local // Disable during development\n  enabled: false\n};\n\nexport const RollbarService = new InjectionToken<Rollbar>('rollbar');\n\n@Injectable()\nexport class RollbarErrorHandler implements ErrorHandler {\n  constructor(@Inject(RollbarService) private rollbar: Rollbar) {}\n\n  handleError(err: any): void {\n    // Still log errors to console when developing\n    if (environment.deploy !== EnvironmentDeploy.Production) {\n      console.error(err);\n    }\n\n    this.rollbar.error(err.originalError || err);\n  }\n}\n\nexport function rollbarFactory() {\n    return new Rollbar(rollbarConfig);\n}\n","import { ChapterModel } from '../story/models/chapter.model';\nimport { uuid } from './uuid';\n\nexport namespace ChapterUtils {\n  export function makeChapterIdMap(\n    chapters: ChapterModel[],\n    genNewIds: boolean\n  ): Record<string, string> {\n    return chapters.reduce((acc, chapter) => {\n      acc[chapter.id] =\n        genNewIds === true ? uuid.idWithPrefix('chapter') : chapter.id;\n      return acc;\n    }, {});\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Observable, from, of } from 'rxjs';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class ClipboardService {  \n\n  constructor() { }\n\n  getClipboardAPISupport(): boolean {\n    return 'clipboard' in navigator;\n  }\n\n  getClipboardAPI(): any {\n    return navigator['clipboard'];\n  }\n\n  copyToClipboard(val: string): Observable<boolean> {\n    if (this.getClipboardAPISupport()) {\n      const clipboardAPI = this.getClipboardAPI();\n      return new Observable<boolean>((observer) => {\n        clipboardAPI.writeText(val)\n          .then(() => {\n            observer.next(true);\n            observer.complete();\n          })\n          .catch((e) => {\n            observer.next(false);\n            observer.complete();\n          });\n      });\n    } else { // async copy unsupported\n      return of(false);\n    }\n  }\n\n  copyInputFieldValue(input: HTMLInputElement | HTMLTextAreaElement): boolean {\n    input.select();\n    let copied = false;\n    try {\n      copied = document.execCommand('copy');\n    } catch (err) {\n      copied = false;\n    }\n    return copied;\n  }\n}\n","<div \n  class=\"app-alert\"\n  [ngClass]=\"'app-alert--' + type\"\n  [class.app-alert--dark]=\"theme === 'dark'\"\n  [class.app-alert--light]=\"theme === 'light'\">\n  <ng-content></ng-content>\n</div>","import { Component, OnInit, Input, ViewEncapsulation, ChangeDetectionStrategy } from '@angular/core';\n\nexport enum AlertType {\n  Danger = 'danger',\n  Info = 'info'\n}\n\n@Component({\n  selector: 'app-alert',\n  templateUrl: './alert.component.html',\n  styleUrls: ['./alert.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None\n})\nexport class AlertComponent implements OnInit {\n  @Input()\n  type = AlertType.Info;\n\n  @Input()\n  theme: 'light' | 'dark' = 'dark';\n\n  constructor() { }\n\n  ngOnInit() {\n  }\n\n}\n","<div  \n  class=\"app-button\"\n  [ngClass]=\"{ \n    'app-button--xsmall': buttonSize == 'xsmall',\n    'app-button--small': buttonSize == 'small',\n    'app-button--medium': buttonSize == 'medium',\n    'app-button--large': buttonSize == 'large',\n    'app-button--flat': buttonType == 'flat',\n    'app-button--default': buttonType == 'default',\n    'app-button--primary': buttonType == 'primary',\n    'app-button--info': buttonType == 'info',\n    'app-button--outline': buttonType == 'outline',\n    'app-button--text': buttonType == 'text',\n    'app-button--light': buttonTheme == 'light',\n    'app-button--dark': buttonTheme == 'dark',\n    'app-button--themed': buttonTheme == 'themed',\n    'app-button--circle': buttonShape == 'circle',\n    'app-button--rounded': buttonShape == 'rounded',\n    'app-button--square': buttonShape == 'square',\n    'app-button--selected': selected,\n    'app-button--uppercase': uppercase,\n    'app-button--disabled': disabled,\n    'app-button--no-border': !bordered,\n    'app-button--expanded': expanded,\n    'app-button--left': buttonAlign === 'left'\n  }\">\n\n  <div class=\"app-button__container\">\n    <ng-content></ng-content>\n  </div>\n</div>\n","// tslint:disable:component-selector\nimport { Component, OnInit, Input, ChangeDetectionStrategy, HostBinding, ViewEncapsulation } from '@angular/core';\n\nexport enum ButtonSize {\n  XSmall = 'xsmall',\n  Small = 'small',\n  Medium = 'medium',\n  Large = 'large'\n}\n\nexport enum ButtonType {\n  Default = 'default',\n  Flat = 'flat',\n  Primary = 'primary',\n  Info = 'info',\n  Outline = 'outline',\n  Text = 'text'\n}\n\nexport enum ButtonShape {\n  Default = 'default',\n  Circle = 'circle',\n  Rounded = 'rounded',\n  Square = 'square'\n}\n\nexport enum ButtonTheme {\n  Dark = 'dark',\n  Light = 'light',\n  Themed = 'themed'\n}\n\nexport enum ButtonAlign {\n  Left = 'left',\n  Center = 'center'\n}\n\n@Component({\n  selector: `button[app-button], a[app-button]`,\n  templateUrl: './button.component.html',\n  styleUrls: ['./button.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None\n})\nexport class ButtonComponent implements OnInit {\n  @Input()\n  buttonSize = ButtonSize.Medium;\n\n  @Input()\n  buttonType = ButtonType.Default;\n\n  @Input()\n  buttonTheme = ButtonTheme.Dark;\n\n  @Input()\n  buttonShape = ButtonShape.Default;\n\n  @Input()\n  buttonAlign = ButtonAlign.Center;\n\n  @Input()\n  uppercase = true;\n\n  @Input()\n  selected = false;\n\n  @Input()\n  expanded = false;\n\n  @Input()\n  @HostBinding('disabled') disabled: boolean;\n\n  @Input()\n  bordered = true;\n\n  constructor() { }\n\n  ngOnInit() {\n  }\n\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { ButtonComponent } from './button/button.component';\nimport { ButtonGroupComponent } from './button-group/button-group.component';\nimport { ButtonIconComponent } from './button-icon/button-icon.component';\nimport { SceneButtonComponent } from './scene-button/scene-button.component';\nimport { PinButtonComponent } from './pin-button/pin-button.component';\nimport { IconModule } from '../icon/icon.module';\nimport { MaterialModule } from 'src/app/material.module';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    IconModule,\n    MaterialModule\n  ],\n  declarations: [\n    ButtonComponent,\n    ButtonGroupComponent,\n    ButtonIconComponent,\n    SceneButtonComponent,\n    PinButtonComponent\n  ],\n  exports: [\n    ButtonComponent,\n    ButtonGroupComponent,\n    ButtonIconComponent,\n    SceneButtonComponent,\n    PinButtonComponent\n  ]\n})\nexport class ButtonsModule { }\n","<div \n  class=\"pin-button\"\n  (click)=\"handleClick()\"\n  [ngClass]=\"{\n    'pin-button--selected': selected,\n    'pin-button--disabled': disabled,\n    'pin-button--small': size === 'small',\n    'pin-button--medium': size === 'medium',\n    'pin-button--large': size === 'large',\n    'pin-button--ghost': buttonType === 'ghost',\n    'pin-button--primary': buttonType === 'primary',\n    'pin-button--secondary': buttonType === 'secondary',\n    'pin-button--outline': buttonType === 'outline',\n    'pin-button--floating': buttonType === 'floating',\n    'pin-button--dark': buttonType === 'dark',\n    'pin-button--row': direction === 'row',\n    'pin-button--fill': fill\n  }\">\n  <div class=\"pin-button__pin\">\n    <!-- Icon -->\n    <app-icon [icon]=\"icon\" style=\"font-size: 14px !important\" *ngIf=\"icon\"></app-icon>\n    \n    <!-- Image -->\n    <span *ngIf=\"src\" [style.backgroundImage]=\"'url(' + src + ')'\" class=\"pin-button__image\"></span>\n\n    <ng-content></ng-content>\n  </div>\n\n  <div class=\"pin-button__label\" *ngIf=\"label\">\n    {{ label }}\n  </div>\n</div>","import { Component, OnInit, ViewEncapsulation, Input, Output, EventEmitter, ChangeDetectionStrategy } from '@angular/core';\n\n@Component({\n  selector: 'app-pin-button, button[app-pin-button]',\n  templateUrl: './pin-button.component.html',\n  styleUrls: ['./pin-button.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None\n})\nexport class PinButtonComponent implements OnInit {\n  @Input()\n  icon: string;\n\n  @Input()\n  src: string;\n\n  @Input()\n  description: string;\n\n  @Input()\n  label: string;\n\n  @Input()\n  selectable = false;\n\n  @Input()\n  size: 'small' | 'medium' | 'large' = 'medium';\n\n  @Input()\n  buttonType: 'default' | 'ghost' | 'outline' | 'floating' | 'dark' | 'primary' | 'secondary' = 'default';\n\n  @Input()\n  direction: 'row' | 'column' = 'column';\n\n  @Input()\n  fill = false;\n\n  @Input()\n  public get selected() {\n    return this._selected;\n  }\n  public set selected(value) {\n    this._selected = value;\n    this.selectedChange = new EventEmitter<boolean>();\n  }\n  private _selected = false;\n\n  @Input()\n  disabled = false;\n\n  @Output()\n  selectedChange = new EventEmitter<boolean>();\n\n  constructor() { }\n\n  ngOnInit() {\n  }\n\n  handleClick() {\n    if (this.disabled) {\n      return;\n    }\n\n    if (this.selectable) {\n      this.selected = !this.selected;\n    }\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { MaterialModule } from 'src/app/material.module';\nimport { CardComponent } from './card/card.component';\nimport { CardsComponent } from './cards/cards.component';\nimport { ProgressIndictatorsModule } from '../progress-indicators/progress-indicators.module';\nimport { LazyLoadImageModule } from 'ng-lazyload-image';\nimport { DirectivesModule } from '../../directives/directives.module';\n\n\n@NgModule({\n  imports: [\n    CommonModule,\n    LazyLoadImageModule,\n    MaterialModule,\n    ProgressIndictatorsModule,\n    DirectivesModule\n  ],\n  declarations: [\n    CardComponent,\n    CardsComponent\n  ],\n  exports: [\n    CardComponent,\n    CardsComponent\n  ]\n})\nexport class CardsModule { }\n","<div class=\"category-image\" [ngClass]=\"cssClass\"></div>","import { Component, OnInit, ChangeDetectionStrategy, ViewEncapsulation, Input, ViewChild, ElementRef, Renderer2 } from '@angular/core';\nimport { getAllCategories } from '../../features/site-navigation/site-navigation-utils';\n\nconst imageMap = {\n  'all': 'all',\n  'complete anatomy': 'complete-anatomy',\n  'system': 'system-anatomy',\n  'regional': 'regional-anatomy',\n  'Allergy and Immunology': 'allergy',\n  'Cardiology': 'cardiology',\n  'Cross Section and Micro Anatomy': 'cross-sections',\n  'Dentistry': 'dentistry',\n  'Dermatology': 'dermatology',\n  'Endocrinology': 'endocrinology',\n  'Gastroenterology and Hepatology': 'gastroenterology',\n  'Infectious Disease': 'infectious',\n  'Nephrology': 'nephrology',\n  'Neurology and Psychiatry': 'neurology',\n  'Obstetrics and Gynecology': 'obstetrics',\n  'Oncology and Hematology': 'oncology',\n  'Ophthalmology': 'ophthalmology',\n  'Orthopedics': 'orthopedics',\n  'Otolaryngology': 'otolaryngology',\n  'Pediatrics': 'pediatrics',\n  'Pulmonology and Respiratory': 'pulmonology',\n  'Rheumatology': 'rheumatology',\n  'Urology': 'urology',\n\n  'public': 'community'\n};\n\n\nexport type categoryColor = 'mono' | 'color';\n@Component({\n  selector: 'app-category-image',\n  templateUrl: './category-image.component.html',\n  styleUrls: ['./category-image.component.scss'],\n  encapsulation: ViewEncapsulation.None,\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class CategoryImageComponent implements OnInit {\n  @ViewChild('image', { static: true })\n  imageRef: ElementRef<HTMLDivElement>;\n\n  @Input()\n  public get active() {\n    return this._active;\n  }\n  public set active(value) {\n    this._active = value;\n    this.updateImage();\n  }\n  private _active = false;\n\n  @Input()\n  public get category() {\n    return this._category;\n  }\n  public set category(value) {\n    this._category = value;\n    this.updateImage();\n  }\n  private _category = '';\n\n  @Input()\n  public get color(): categoryColor {\n    return this._color;\n  }\n  public set color(value: categoryColor) {\n    this._color = value;\n    this.updateImage();\n  }\n  private _color: categoryColor = 'mono';\n\n  cssClass = '';\n  allCategories = getAllCategories();\n\n  constructor(\n  ) { }\n\n  ngOnInit() {\n  }\n\n  private updateImage() {\n    const result = this.allCategories.find((value) => {\n      return value.id === this.category || value.title.toLowerCase() === this.category.toLowerCase();\n    });\n\n    if (result) {\n      const imageId = imageMap[result.id];\n      this.cssClass = `category-image--${this.color}-${imageId}`;\n    }\n  }\n}\n","<div\n  class=\"picker\"\n  [class.picker--small]=\"size === 'small'\"\n  [class.picker--normal]=\"size === 'normal'\"\n  [class.picker--large]=\"size === 'large'\"\n  [style.background]=\"backgroundCSS\"\n  [colorPicker]=\"colorHex\"\n  [cpAlphaChannel]=\"alphaEnabled ? 'always' : 'disabled'\"\n  [cpOutputFormat]=\"'hex'\"\n  (colorPickerChange)=\"handleColorPickerChange($event)\">\n</div>\n","import { Component, OnInit, Input, Output, EventEmitter, ViewChild, ChangeDetectionStrategy } from '@angular/core';\nimport { ColorModel } from 'src/app/edit/models/color.model';\nimport { ColorUtils } from '../../libraries/colors/colors';\n\n@Component({\n  selector: 'app-color-picker',\n  templateUrl: './color-picker.component.html',\n  styleUrls: ['./color-picker.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class ColorPickerComponent implements OnInit {\n\n  @Input()\n  color: ColorModel;\n\n  @Input()\n  size: 'small' | 'normal' | 'large' = 'normal';\n\n  @Input()\n  alphaEnabled: true;\n\n  get colorHex(): string  {\n    return this.getHexFromColor(this.color);\n  }\n\n  get backgroundCSS(): string {\n    if (this.color) {\n      const { red, green, blue, alpha } = this.color;\n      return `rgba(${red * 255}, ${green * 255}, ${blue * 255}, ${alpha})`;\n    } else {\n      return '';\n    }\n  }\n\n  @Output()\n  colorSelected = new EventEmitter<ColorModel>();\n\n  @Output()\n  colorHexSelected = new EventEmitter<string>();\n\n  constructor() { }\n\n  ngOnInit() {\n  }\n  \n  handleColorPickerChange(hexColor: string) {\n    const selectedColor = hexColor ? this.getColorFromHex(hexColor) : null;\n    \n    // dispatch color selection\n    this.colorSelected.emit(selectedColor);\n    this.colorHexSelected.emit(hexColor);\n  }\n\n  private getColorFromHex(hexColor: string): ColorModel {\n    const rgba = ColorUtils.hexToRgba(hexColor, true);\n    return new ColorModel(\n      rgba[0],\n      rgba[1],\n      rgba[2],\n      rgba[3]\n    );\n  }\n\n  private getHexFromColor(color: ColorModel): string {\n    if (color) {\n      const { red, green, blue, alpha } = color;\n      return ColorUtils.rgbaToHex([red, green, blue, alpha], true);\n    } else {\n      return '';\n    }\n  }\n\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { ProgressIndictatorsModule } from '../progress-indicators/progress-indicators.module';\nimport { ColumnComponent } from './column/column.component';\nimport { ColumnGroupComponent } from './column-group/column-group.component';\n\n@NgModule({\n  declarations: [\n    ColumnComponent,\n    ColumnGroupComponent\n  ],\n  imports: [\n    CommonModule,\n    ProgressIndictatorsModule\n  ],\n  exports: [\n    ColumnComponent,\n    ColumnGroupComponent\n  ]\n})\nexport class ColumnModule { }\n","<span class=\"divider\"></span>","import { Component, OnInit, ChangeDetectionStrategy, ViewEncapsulation } from '@angular/core';\n\n@Component({\n  selector: 'app-divider',\n  templateUrl: './divider.component.html',\n  styleUrls: ['./divider.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None\n})\nexport class DividerComponent implements OnInit {\n\n  constructor() { }\n\n  ngOnInit() {\n  }\n\n}\n","<i [ngClass]=\"iconClass\"></i>","import { Component, OnInit, Input, ChangeDetectionStrategy, ViewEncapsulation } from '@angular/core';\n\n@Component({\n  selector: 'app-icon',\n  templateUrl: './icon.component.html',\n  styleUrls: ['./icon.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None\n})\nexport class IconComponent implements OnInit {\n  @Input()\n  icon: string;\n  \n  @Input()\n  size: string;\n\n  get iconClass(): string {\n    let cssClass = `fas fa-${this.icon}`;\n    if (this.size) {\n      cssClass += ` fa-${this.size}`;\n    }\n\n    return cssClass;\n  }\n\n  constructor() { }\n\n  ngOnInit() {\n  }\n\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { IconComponent } from './icon.component';\n\n\n\n@NgModule({\n  declarations: [\n    IconComponent\n  ],\n  imports: [\n    CommonModule\n  ],\n  exports: [\n    IconComponent\n  ]\n})\nexport class IconModule { }\n","<div\n  class=\"image-view\"\n  [class.image-view--auto-fit]=\"fit === 'auto'\"\n  #imageView>\n\n  <!-- image -->\n  <img\n    class=\"image-view__image\"\n    [src]=\"src\"\n    [alt]=\"alt\"\n    [style.max-width]=\"fit === 'auto' && fitSize ? (fitSize + 'px') : '100%'\"\n    [style.max-height]=\"fit === 'auto' && fitSize ? (fitSize + 'px') : '100%'\">\n\n  <div class=\"image-view__overlay\" (click)=\"handleFullscreen($event)\" role=\"button\" matTooltip=\"Expand\">\n    <app-icon icon=\"expand-alt\" class=\"image-view__icon\"></app-icon>\n  </div>\n</div>","import { ChangeDetectionStrategy, ChangeDetectorRef, Component, ElementRef, Input, OnInit, ViewChild } from '@angular/core';\nimport { Observable, Subject } from 'rxjs';\nimport { DialogService } from 'src/app/dialogs/dialog.service';\n\n@Component({\n  selector: 'app-image-view',\n  templateUrl: './image-view.component.html',\n  styleUrls: ['./image-view.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class ImageViewComponent implements OnInit {\n\n  @ViewChild('imageView', { static: true})\n  imageView: ElementRef;\n\n  @Input()\n  fit: 'normal' | 'auto' = 'normal';\n\n  @Input()\n  fitSize: number;\n\n  @Input()\n  src: string;\n  \n  @Input()\n  fullscreenSrc: string;\n\n  @Input()\n  alt: string;\n\n  fullscreen$: Observable<Event>;\n  fullscreenElement: HTMLElement;\n  requestFullscreen: boolean;\n\n  fullscreenEnabled = false;\n\n  private ngUnsubscribe = new Subject();\n  \n  constructor(\n    private changeDetectorRef: ChangeDetectorRef,\n    private dialogService: DialogService\n  ) { }\n\n  ngOnInit() {\n  }\n\n  handleFullscreen(event: Event) {\n    const src = this.fullscreenSrc || this.src;\n    const alt = this.alt || '';\n    this.dialogService.openImageDialog({\n      src,\n      alt\n    });\n    event.stopPropagation();\n  }\n\n}\n","<div class=\"input-group\" [ngClass]=\"{'input-group--has-icon': icon}\">\n    <app-icon class=\"input-group__icon\" [icon]=\"icon\" *ngIf=\"icon\"></app-icon>\n\n    <div class=\"input-group__main\">\n        <ng-content></ng-content>\n    </div>\n\n    <div class=\"input-group__after\"><ng-content select=\"[input-after]\"></ng-content></div>\n</div>","import { Component, OnInit, Input, ChangeDetectionStrategy, ViewEncapsulation } from '@angular/core';\n\n@Component({\n  selector: 'app-input-group',\n  templateUrl: './input-group.component.html',\n  styleUrls: ['./input-group.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None\n})\nexport class InputGroupComponent implements OnInit {\n  @Input() \n  icon = '';\n\n  constructor() { }\n\n  ngOnInit() {\n  }\n\n}\n","<ng-content></ng-content>","import { Component, OnInit, ChangeDetectionStrategy, ViewEncapsulation } from '@angular/core';\n\n@Component({\n  selector: 'app-list-item',\n  templateUrl: './list-item.component.html',\n  styleUrls: ['./list-item.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None\n})\nexport class ListItemComponent implements OnInit {\n  constructor() { }\n\n  ngOnInit() {\n    \n  }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { MaterialModule } from 'src/app/material.module';\nimport { ListComponent } from './list/list.component';\nimport { ListItemComponent } from './list-item/list-item.component';\n\n@NgModule({\n  imports: [\n    MaterialModule,\n    FormsModule,\n    CommonModule\n  ],\n  declarations: [\n    ListComponent,\n    ListItemComponent\n  ],\n  exports: [\n    ListComponent,\n    ListItemComponent\n  ]\n})\nexport class ListModule { }\n","<div class=\"list\" [ngClass]=\"'list--' + listType\">\n  <!-- Child items -->\n  <ng-content select=\"app-list-item\"></ng-content>\n</div>\n","import { \n  Component,\n  OnInit,\n  ChangeDetectionStrategy, \n  ViewEncapsulation,\n  Input} from '@angular/core';\n\nexport enum ListType {\n  Default = 'default',\n  Commafied = 'commafied',\n  flat = 'flat'\n}\n\n@Component({\n  selector: 'app-list',\n  templateUrl: './list.component.html',\n  styleUrls: ['./list.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None\n})\nexport class ListComponent implements OnInit {\n  @Input()\n  listType = ListType.Default;\n  \n  constructor() { }\n\n  ngOnInit() {\n   \n  }\n}\n","<div\n  class=\"counter text-10 pt-1 pb-1\"\n  [class.counter--inline]=\"display === 'inline'\"  \n  [ngSwitch]=\"mode\"\n  *ngIf=\"max\">\n    <span *ngSwitchCase=\"'remaining'\" class=\"counter__label\">{{ remainingCount }} {{ remainingCount === 1 ? 'character' : 'characters' }} remaining</span>\n    <span *ngSwitchDefault class=\"counter__label\">{{ count }}/{{ max }}</span>  \n</div>","import { Component, OnInit, Input, AfterViewInit, ChangeDetectorRef, AfterContentChecked, OnDestroy } from '@angular/core';\nimport { fromEvent, Observable, Subject } from 'rxjs';\nimport { takeUntil } from 'rxjs/operators';\n\n// generic interface for exposing text value changes\ninterface TextChangeInputType {\n  textValue: string;\n  maxLength: number;\n  getValueChanges: () => Observable<string>;\n}\ntype HTMLInputFieldType = HTMLInputElement | HTMLTextAreaElement;\n\n@Component({\n  selector: 'app-character-counter',\n  templateUrl: './character-counter.component.html',\n  styleUrls: ['./character-counter.component.scss']\n})\nexport class CharacterCounterComponent implements OnInit, AfterViewInit, AfterContentChecked, OnDestroy {\n\n  max: number;\n  count: number;\n\n  private ngUnsubscribe = new Subject();\n\n  get remainingCount() {\n    return this.max - this.count;\n  }\n\n  @Input()\n  field: HTMLInputFieldType | TextChangeInputType;\n\n  @Input()\n  display: 'inline' | 'block' = 'block';\n\n  @Input()\n  mode: 'count' | 'remaining' = 'count';\n\n  constructor(private ref: ChangeDetectorRef) {\n  }\n\n  ngOnInit() {\n    this.count = 0;\n    this.max = this.field.maxLength || 0;\n  }\n\n  ngAfterViewInit() {\n    this.getValueChanges()\n      .pipe(takeUntil(this.ngUnsubscribe))\n      .subscribe(() => {\n        this.updateCount();\n      });\n  }\n\n  ngAfterContentChecked() {\n    this.updateCount();\n  }\n\n  ngOnDestroy() {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n  updateCount() {\n    const updateCount = this.getValue().length;\n\n    // Manual \"dirty\" check\n    if (this.count !== updateCount) {\n      this.count = updateCount;\n      this.ref.markForCheck();\n    }\n  }\n\n  private getValueChanges(): Observable<any> {\n    return (this.field as TextChangeInputType).getValueChanges\n      ? (this.field as TextChangeInputType).getValueChanges() // text editor changes\n      : fromEvent(this.field as HTMLInputFieldType, 'input'); // input value changes\n  }\n\n  private getValue(): string {\n    return typeof (this.field as TextChangeInputType).textValue !== 'undefined'\n      ? (this.field as TextChangeInputType).textValue // text editor value\n      : (this.field as HTMLInputFieldType).value; // input value\n  }\n}\n","<div class=\"field\" \n  [ngClass]=\"{\n    'field--light': theme === 'light',\n    'field--dark': theme === 'dark',\n    'field--inline': display === 'inline',\n    'field--compact': isCompact\n  }\">\n  \n  <label class=\"field__label text-uppercase text-10\" *ngIf=\"label\">\n    {{ label }}\n  </label>\n  \n  <div class=\"field__input\">\n    <ng-content></ng-content>\n\n    <div class=\"field__help text-dim text-11\">\n      <ng-content select=\"[form-field-help]\"></ng-content>\n    </div>\n  </div>\n</div>","import { Component, OnInit, Input, ChangeDetectionStrategy } from '@angular/core';\n\n@Component({\n  selector: 'app-form-field',\n  templateUrl: './form-field.component.html',\n  styleUrls: ['./form-field.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class FormFieldComponent implements OnInit {\n  @Input()\n  label: string;\n\n  @Input()\n  display: 'inline' | 'block' = 'block';\n\n  @Input()\n  theme: 'dark' | 'light' = 'dark';\n\n  @Input()\n  isCompact = false;\n\n  constructor() { }\n\n  ngOnInit() {\n  }\n\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormFieldComponent } from './form-field/form-field.component';\nimport { CharacterCounterComponent } from './character-counter/character-counter.component';\n\n@NgModule({\n  imports: [\n    CommonModule\n  ],\n  declarations: [\n    FormFieldComponent,\n    CharacterCounterComponent\n  ],\n  exports: [\n    FormFieldComponent,\n    CharacterCounterComponent\n  ]\n})\nexport class LocalFormsModule { }\n","<div\n    *ngIf=\"shown\"\n    class=\"toggle flex flex-row items-start\"\n    [class.toggle--message]=\"type === 'message'\"\n    [class.toggle--error]=\"type === 'error'\"\n    @show>\n\n    <div *ngIf=\"icon\" class=\"mr-3\">\n        <div class=\"toggle__icon\">\n            <app-icon [icon]=\"icon\"></app-icon>\n        </div>\n    </div>\n\n    <div class=\"toggle__content\">\n        <ng-content></ng-content>\n    </div>\n    \n</div>","import { transition, trigger, useAnimation } from '@angular/animations';\nimport { ChangeDetectionStrategy, ChangeDetectorRef, Component, Input, OnDestroy, OnInit } from '@angular/core';\nimport { Subject } from 'rxjs';\nimport { debounceTime, delay, filter, takeUntil } from 'rxjs/operators';\nimport { AnimationLib } from 'src/app/shared/libraries/animations/animation-lib';\n\n@Component({\n  selector: 'app-message-toggle',\n  templateUrl: './message-toggle.component.html',\n  styleUrls: ['./message-toggle.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  animations: [\n    trigger('show', [\n      transition(':enter', [\n        useAnimation(AnimationLib.fadeIn, {\n          params: {\n            duration: 300\n          }\n        })\n      ]),\n      transition(':leave', [\n        useAnimation(AnimationLib.fadeOut, {\n          params: {\n            duration: 300\n          }\n        })\n      ])\n    ])\n  ]\n})\nexport class MessageToggleComponent implements OnInit, OnDestroy {\n\n  @Input()\n  type: 'message' | 'error' = 'message';\n\n  @Input()\n  icon: string;\n\n  @Input()\n  showDelay = 0;\n\n  @Input()\n  hideDelay = 5000;\n\n  @Input()\n  public get shown() {\n    return this._shown;\n  }\n  public set shown(value) {\n    if (this._shown !== value) {\n      this._shown = value;\n      this.shownSubject.next(value);\n      this.changeRef.markForCheck();\n    }\n  }\n\n  private _shown = true;\n  private shownSubject = new Subject<boolean>();\n  private ngUnsubscribe = new Subject();\n\n  constructor(private changeRef: ChangeDetectorRef) { }\n\n  ngOnInit() {\n    this.initViewShownListeners();\n  }\n\n  ngOnDestroy() {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n  private initViewShownListeners() {\n    // set hidden after delay\n    this.shownSubject\n      .pipe(\n        debounceTime(this.hideDelay),\n        filter((shown) => shown),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(() => {\n        this._shown = false;\n        this.changeRef.markForCheck();\n      });\n  }\n\n}\n","<div class=\"navigation-list-container\">\n    <ng-content></ng-content>\n</div>","import { Component, OnInit, ChangeDetectionStrategy } from '@angular/core';\n\n@Component({\n  selector: 'app-navigation-list-container',\n  templateUrl: './navigation-list-container.component.html',\n  styleUrls: ['./navigation-list-container.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class NavigationListContainerComponent implements OnInit {\n\n  constructor() { }\n\n  ngOnInit() {\n  }\n\n}\n","<div \n    class=\"navigation-list-item\"\n    [ngClass]=\"{'navigation-list-item--selected': selected}\">\n    <ng-content></ng-content>\n</div>","import { Component, OnInit, ChangeDetectionStrategy, Input } from '@angular/core';\n\n@Component({\n  // tslint:disable-next-line: component-selector\n  selector: '[app-navigation-list-item]',\n  templateUrl: './navigation-list-item.component.html',\n  styleUrls: ['./navigation-list-item.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class NavigationListItemComponent implements OnInit {\n  @Input()\n  selected: boolean;\n\n  constructor() { }\n\n  ngOnInit() {\n  }\n\n}\n","<div \n    class=\"navigation-panel\" \n    [ngClass]=\"{\n        'navigation-panel--open': open,\n        'navigation-panel--collapsible': collapsible\n    }\">\n    <div role=\"button\" aria-label=\"Toggle Panel\" class=\"navigation-panel__header\" (click)=\"handleToggle()\" *ngIf=\"showHeader\">\n        <div class=\"navigation-panel__title\" *ngIf=\"label; else customTitle\">\n            {{ label }}\n        </div>\n\n        <div class=\"navigation-panel__arrow\">\n            <app-icon icon=\"angle-right\"></app-icon>\n        </div>\n    </div>\n\n    <div \n        @expand\n        *ngIf=\"open\"\n        class=\"navigation-panel__body\" \n        [ngClass]=\"{'pb-6': bottomPadding}\"\n        [attr.aria-hidden]=\"!open\">\n        <ng-content></ng-content>\n    </div>\n</div>\n\n<ng-template #customTitle>\n    <div style=\"max-width: 100%\">\n        <ng-content select=\"[app-navigation-panel-title]\"></ng-content>\n    </div>\n </ng-template>","import { Component, OnInit, Input, ChangeDetectionStrategy, ChangeDetectorRef } from '@angular/core';\nimport { trigger, transition, sequence, style, animate } from '@angular/animations';\n\n@Component({\n  selector: 'app-navigation-panel',\n  templateUrl: './navigation-panel.component.html',\n  styleUrls: ['./navigation-panel.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  animations: [\n    trigger('expand', [\n      transition(':enter', [\n        sequence([\n          style({\n            height: 0\n          }),\n          animate('250ms ease-in-out', style({ \n            height: '*'\n          }))\n        ])\n      ]),\n      transition(':leave', [\n        sequence([\n          animate('250ms ease-in-out', style({ \n            height: '0'\n          }))\n        ])\n      ])\n    ])\n  ]\n})\nexport class NavigationPanelComponent implements OnInit {\n  @Input()\n  label: string;\n\n  @Input()\n  collapsible = false;\n\n  @Input()\n  public get open() {\n    return this._open;\n  }\n  public set open(value) {\n    this._open = value;\n  }\n  private _open = true;\n\n  @Input()\n  showHeader = true;\n\n  @Input()\n  bottomPadding = true;\n\n  constructor(\n    private changeDetectorRef: ChangeDetectorRef\n  ) { }\n\n  ngOnInit() {\n  }\n\n  handleToggle() {\n    if (!this.collapsible) {\n      return;\n    }\n\n    this.open = !this.open;\n    this.changeDetectorRef.markForCheck();\n  }\n\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { NavigationPanelComponent } from './navigation-panel/navigation-panel.component';\nimport { NavigationListContainerComponent } from './navigation-list/navigation-list-container/navigation-list-container.component';\nimport { NavigationListItemComponent } from './navigation-list/navigation-list-item/navigation-list-item.component';\nimport { IconModule } from '../icon/icon.module';\nimport { NavigationListDividerComponent } from './navigation-list/navigation-list-divider/navigation-list-divider.component';\n\n\n\n@NgModule({\n  declarations: [\n    NavigationPanelComponent,\n    NavigationListContainerComponent,\n    NavigationListItemComponent,\n    NavigationListDividerComponent\n  ],\n  imports: [\n    CommonModule,\n    IconModule,\n  ],\n  exports: [\n    NavigationPanelComponent,\n    NavigationListContainerComponent,\n    NavigationListItemComponent,\n    NavigationListDividerComponent\n  ]\n})\nexport class NavigationModule { }\n","<ng-container [gaCategory]=\"eventCategory\">\n\n    <!-- Actions -->\n    <button\n        #nodeActionsTrigger=\"matMenuTrigger\"\n        app-button\n        data-test=\"nodeActionsTrigger\"\n        buttonSize=\"xsmall\"\n        [buttonTheme]=\"theme\"\n        [matMenuTriggerFor]=\"nodeActions\"\n        (menuClosed)=\"onMenuClosed()\">\n        <app-icon icon=\"ellipsis-v\"></app-icon>\n    </button>\n\n    <!-- Main manu -->\n    <mat-menu #nodeActions=\"matMenu\" [overlapTrigger]=\"true\">\n        <!-- Select -->\n        <ng-container *appFlagApplication=\"application.All; page: '/edit', mode:'include'\">\n            <button mat-menu-item [matMenuTriggerFor]=\"selectActions\">Select</button>\n            <mat-divider></mat-divider>\n        </ng-container>\n\n        <!-- Show / Hide -->\n        <button gaEvent gaAction=\"Clicked Show\" mat-menu-item data-test=\"nodeActionsShow\" (click)=\"toggleVisible(node, true)\" *ngIf=\"!node.boolState.shown\">Show</button>\n        <button gaEvent gaAction=\"Clicked Hide\" mat-menu-item data-test=\"nodeActionsHide\" (click)=\"toggleVisible(node, false)\" *ngIf=\"node.boolState.shown\">Hide</button>\n\n        <!-- Isolate -->\n        <button gaEvent gaAction=\"Clicked Isolate\" mat-menu-item data-test=\"nodeActionsIsolate\" (click)=\"hideInverse(node)\">Isolate</button>\n\n        <!-- Fade -->\n        <mat-divider></mat-divider>\n        <button data-test=\"nodeActionsFadeTrigger\" mat-menu-item [matMenuTriggerFor]=\"fadeActions\">Fade</button>\n\n        <!-- Pickable / Unpickable -->\n        <ng-container *appFlagApplication=\"application.Loft\">\n            <mat-divider></mat-divider>\n            <button mat-menu-item data-test=\"nodeActionsPickableTrigger\" [matMenuTriggerFor]=\"pickableActions\">Pickable / Unpickable</button>\n        </ng-container>\n\n        <!-- Fly To -->\n        <mat-divider></mat-divider>\n        <button gaEvent gaAction=\"Clicked Fly To\" mat-menu-item data-test=\"nodeActionsFlyTo\" (click)=\"flyToNode(node)\">Fly To</button>\n\n        <!-- Object Label -->\n        <ng-container *appFlagApplication=\"application.Loft; page: '/edit', mode:'include'\">\n        <mat-divider></mat-divider>\n        <button gaEvent gaAction=\"Clicked Edit Object Name\" mat-menu-item data-test=\"nodeActionsEditName\" (click)=\"editNodeLabel(node)\">Edit Object Name</button>\n        </ng-container>\n\n        <!-- Copy -->\n        <ng-container *appFlagApplication=\"application.Loft; page: '/edit', mode:'include'\">\n            <mat-divider></mat-divider>\n            <button mat-menu-item data-test=\"nodeActionsCopyTrigger\" [matMenuTriggerFor]=\"copyActions\">Copy</button>\n        </ng-container>\n    </mat-menu>\n\n    <!-- Select submenu -->\n    <mat-menu #selectActions=\"matMenu\">\n        <button gaEvent gaAction=\"Clicked Select This\" mat-menu-item data-test=\"nodeActionsSelectThis\" (click)=\"checkNode(node, true)\">Select This</button>\n        <button gaEvent gaAction=\"Clicked Select Everything Else\" mat-menu-item data-test=\"nodeActionsSelectEverythingElse\" (click)=\"checkInverse(node)\">Select Everything Else</button>\n    </mat-menu>\n\n    <!-- Fade submenu -->\n    <mat-menu #fadeActions=\"matMenu\">\n        <button gaEvent gaAction=\"Clicked Fade This\" mat-menu-item data-test=\"nodeActionsFadeThis\" (click)=\"fadeNode(node)\">Fade This</button>\n        <button gaEvent gaAction=\"Clicked Fade Everything Else\" mat-menu-item data-test=\"nodeActionsFadeEverythingElse\" (click)=\"fadeInverseNodes(node)\">Fade Everything Else</button>\n    </mat-menu>\n\n    <!-- Show / Hide submenu -->\n    <mat-menu #showHideActions=\"matMenu\">\n        <button gaEvent gaAction=\"Clicked Show This\" mat-menu-item data-test=\"nodeActionsShowThis\" (click)=\"toggleVisible(node, true)\" *ngIf=\"!node.boolState.shown\">Show This</button>\n        <button gaEvent gaAction=\"Clicked Hide This\" mat-menu-item data-test=\"nodeActionsShowEverythingElse\" (click)=\"toggleVisible(node, false)\" *ngIf=\"node.boolState.shown\">Hide This</button>\n        <mat-divider></mat-divider>\n        <button gaEvent gaAction=\"Clicked Hide Everything Else\" mat-menu-item (click)=\"hideInverse(node)\">Hide Everything Else</button>\n    </mat-menu>\n\n    <!-- Pickable submenu -->\n    <mat-menu #pickableActions=\"matMenu\">\n        <button gaEvent gaAction=\"Clicked Make Unpickable\" *ngIf=\"node.boolState.pickable\" mat-menu-item data-test=\"nodeActionsPickable\" (click)=\"togglePickable(node, false)\">Make Unpickable</button>\n        <button gaEvent gaAction=\"Clicked Make Pickable\" *ngIf=\"!node.boolState.pickable\" mat-menu-item data-test=\"nodeActionsUnpickable\" (click)=\"togglePickable(node, true)\">Make Pickable</button>\n        <mat-divider></mat-divider>\n        <button gaEvent gaAction=\"Clicked Make Everything Else Unpickable\" mat-menu-item data-test=\"nodeActionsEverythingElseUnpickable\" (click)=\"makeEverythingElseUnpickale(node)\">Make Everything Else Unpickable</button>\n    </mat-menu>\n\n    <!-- Copy submenu -->\n    <mat-menu #copyActions=\"matMenu\">\n        <button gaEvent gaAction=\"Clicked Copy Short ID\" mat-menu-item data-test=\"nodeActionsCopyShortID\" (click)=\"copy(shortId)\">Copy Short ID</button>\n        <button gaEvent gaAction=\"Clicked Copy Full ID\" mat-menu-item data-test=\"nodeActionsCopyFullID\" (click)=\"copy(node.id)\">Copy Full ID</button>\n        <mat-divider></mat-divider>\n        <button gaEvent gaAction=\"Clicked Copy Display Name\" mat-menu-item data-test=\"nodeActionsCopyDisplayName\" (click)=\"copy(node.label)\">Copy Display Name</button>\n    </mat-menu>\n\n</ng-container>","import { Component, OnInit, ChangeDetectionStrategy, Input, ChangeDetectorRef, ViewChild, Output, EventEmitter } from '@angular/core';\nimport { ViewTreeNode } from 'src/app/engine/models/view.tree-node';\nimport { Store } from '@ngxs/store';\nimport { FlyToObject, SetLabelEditNode } from '../../../engine/state/engine.actions';\nimport { EngineState } from '../../../engine/state/engine.state';\nimport { EngineNodesState } from '../../../engine/state/nodes/engine.nodes.state';\nimport { EnvironmentApplication } from 'src/environments/models/environment-application';\nimport { BdGraphService } from 'src/lib/graph/graph.service';\nimport { PaintPresetFade } from '../../../engine/models/paint-presets.const';\nimport { NodeActions } from 'src/app/engine/state/nodes/engine.nodes.actions';\nimport { ClipboardService } from '../../clipboard.service';\nimport { MatMenuTrigger, MatSnackBar } from '@angular/material';\nimport { CameraService } from 'src/app/engine/camera.service';\nimport { UndoActions } from 'src/app/undo/state/undo.state.actions';\nimport { ApplyCameraPatch, SetCameraFlyTo } from 'src/app/engine/state/camera/engine.camera.actions';\nimport { CameraModel } from 'src/app/engine/models/camera.model';\nimport { EngineCameraState } from 'src/app/engine/state/camera/engine.camera.state';\nimport { vec3 } from 'gl-matrix';\nimport { calcShownObjectState } from 'src/app/engine/state/nodes/node-reducers';\nimport { calcCameraFlyToState } from 'src/app/engine/state/camera/camera-reducers';\nimport { BoundaryModel } from 'src/app/engine/models/boundary.model';\nimport { EngineService } from 'src/app/engine/engine.service';\n\ndeclare const Human;\n\n@Component({\n  selector: 'app-node-actions',\n  templateUrl: './node-actions.component.html',\n  styleUrls: ['./node-actions.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class NodeActionsComponent implements OnInit {\n  application = EnvironmentApplication;\n  shortId = '';\n\n  @Input()\n  public get node(): ViewTreeNode {\n    return this._node;\n  }\n  public set node(value: ViewTreeNode) {\n    this._node = value;\n    \n    const ids = this.node.id.split('-');\n    this.shortId = (ids.length === 2) ? ids[1] : ids[0];\n  }\n  private _node: ViewTreeNode;\n\n  @Input()\n  theme: 'light' | 'dark' = 'dark';\n\n\n  // Used for Google Analytics event tracking\n  // See: https://www.notion.so/biodigital/Human-Web-Google-Analytics-Events-d685075c60b84e0fbca3c2139775608b\n  @Input()\n  eventCategory = '';\n\n  @Output()\n  nodeActionsClosed = new EventEmitter();\n\n  @ViewChild('nodeActionsTrigger', { static: true }) \n  nodeActionsTrigger: MatMenuTrigger;\n\n  constructor(\n    private store: Store,\n    private graphService: BdGraphService,\n    private changeDetectorRef: ChangeDetectorRef,\n    private clipboardService: ClipboardService,\n    private snackbar: MatSnackBar,\n    private cameraService: CameraService,\n    private engineService: EngineService\n  ) { }\n\n  ngOnInit() {\n  }\n\n  private isNodeChecked(id: string) {\n    const nodes = this.store.selectSnapshot(EngineNodesState.getNodes);\n    return nodes[id].checked;\n  }\n\n  private isNodeShown(id: string) {\n    const nodes = this.store.selectSnapshot(EngineNodesState.getNodes);\n    return nodes[id].shown;\n  }\n\n  checkNode(node: ViewTreeNode, checked?: boolean) {\n    const shouldCheck = checked === undefined ? !this.isNodeChecked(node.id) : checked;\n    this.store.dispatch(new NodeActions.UpdateNodesChecked(shouldCheck, [node.id]));\n  }\n\n  checkInverse(node: ViewTreeNode) {\n    this.store.dispatch(new NodeActions.UpdateNodesChecked(true));\n    this.store.dispatch(new NodeActions.UpdateNodesChecked(false, [node.id]));\n  }\n\n  setCheckedNodes(node: ViewTreeNode, checked?: boolean) {\n    this.store.dispatch(new NodeActions.UpdateNodesChecked(false));\n    const shouldCheck = checked === undefined ? !this.isNodeChecked(node.id) : checked;\n    this.store.dispatch(new NodeActions.UpdateNodesChecked(shouldCheck, [node.id]));\n  }\n\n  flyToNode(node: ViewTreeNode) {\n    this.store.dispatch(new FlyToObject(node.id));\n  }\n\n  hideNode(node: ViewTreeNode) {\n    this.store.dispatch(new NodeActions.UpdateNodesShown(\n      false,\n      [node.id]\n    ));\n  }\n\n  hideInverse(node: ViewTreeNode) {\n    const viewGraph = this.store.selectSnapshot(EngineState.getViewGraph);\n\n    const showNodeIds = this.graphService.getAllLeafDescendants(viewGraph, [node.id]);\n    const hideNodeIds = this.graphService.getInverseSelection(viewGraph, [node.id]);\n\n    const patch = {};\n\n    showNodeIds.forEach((nodeId) => {\n      patch[nodeId] = true;\n    });\n\n    hideNodeIds.forEach((nodeId) => {\n      patch[nodeId] = false;\n    });\n\n    // calculate the next nodeState, and apply it via NodeActions.ApplyPatch\n    const nodeAction = new NodeActions.UpdateNodesShown(undefined, undefined, patch);\n\n    const nodeState = calcShownObjectState(\n      this.store.selectSnapshot(EngineNodesState),\n      nodeAction\n    );\n\n    this.store.dispatch(new NodeActions.ApplyPatch(nodeState.patches));\n    \n\n    // calculate the next camera location, and apply it via ApplyCameraPatch\n    const objectBoundary = this.engineService.getObjectBoundary(node.id);\n    const newCamera = this.cameraService.cameraAfterFlyTo(objectBoundary);\n    const cameraAction = new SetCameraFlyTo(newCamera);\n    const cameraState = calcCameraFlyToState(\n      this.store.selectSnapshot(EngineCameraState),\n      cameraAction\n    );\n    this.store.dispatch(new ApplyCameraPatch(cameraState.patches));\n\n    // de-select object\n    this.store.dispatch(new NodeActions.UpdateNodeSelected());\n    this.store.dispatch(new NodeActions.UpdateNodesChecked(false));\n    \n\n    // save both sets of patches at the same do, so Undo and Redo act on them as a group\n    this.store.dispatch(\n      new UndoActions.SavePatches([\n        {\n          forward: nodeState.patches,\n          inverse: nodeState.inversePatches,\n          patchAction: NodeActions.ApplyPatch,\n        },\n        {\n          forward: cameraState.patches,\n          inverse: cameraState.inversePatches,\n          patchAction: ApplyCameraPatch,\n        },\n      ])\n    );\n  }\n\n  showNode(node: ViewTreeNode) {\n    this.store.dispatch(new NodeActions.UpdateNodesShown(\n      true,\n      [node.id]\n    ));\n    this.changeDetectorRef.markForCheck();\n  }\n\n  toggleVisible(node: ViewTreeNode, show?: boolean) {\n    const shouldShow = show === undefined ? this.isNodeShown(node.id) : show;\n    this.store.dispatch(new NodeActions.UpdateNodesShown(shouldShow, [node.id]));\n    this.changeDetectorRef.markForCheck();\n  }\n\n  togglePickable(node: ViewTreeNode, pickable: boolean) {\n    this.store.dispatch(new NodeActions.UpdateNodesPickable(pickable, [node.id]));\n    this.changeDetectorRef.markForCheck();\n  }\n\n  makeEverythingElseUnpickale(node: ViewTreeNode) {\n    this.store.dispatch(new NodeActions.UpdateNodesPickable(false));\n    this.store.dispatch(new NodeActions.UpdateNodesPickable(true, [node.id]));\n  }\n\n  fadeInverseNodes(node: ViewTreeNode) {\n    // fade all nodes except this one\n    const viewGraph = this.store.selectSnapshot(EngineState.getViewGraph);\n    const inverseNodeIds = this.graphService.getInverseSelection(viewGraph, [node.id]);\n    const nodes = this.graphService.getNodes(viewGraph, inverseNodeIds);\n\n    this.store.dispatch(new NodeActions.UpdateNodesPaint(\n      PaintPresetFade.recipe,\n      nodes.map(n => n.id)  \n    ));\n\n  }\n\n  fadeNode(node: ViewTreeNode) {\n    this.store.dispatch(new NodeActions.UpdateNodesPaint(\n      PaintPresetFade.recipe,\n      [node.id]\n    ));\n  }\n\n  editNodeLabel(node: ViewTreeNode) {\n    this.store.dispatch(new SetLabelEditNode(node));\n  }\n\n  copy(value: string) {\n    this.clipboardService.copyToClipboard(value).subscribe(() => {\n      this.snackbar.open(`Copied ${value} to clipboard.`);\n    });\n  }\n\n  onMenuClosed() {\n    this.nodeActionsClosed.emit();\n  }\n\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { NodeActionsComponent } from './node-actions.component';\nimport { MaterialModule } from 'src/app/material.module';\nimport { IconModule } from 'src/app/shared/components/icon/icon.module';\nimport { ButtonsModule } from 'src/app/shared/components/buttons/buttons.module';\nimport { DirectivesModule } from 'src/app/shared/directives/directives.module';\nimport { NgxGoogleAnalyticsModule } from 'ngx-google-analytics';\n\n@NgModule({\n  declarations: [NodeActionsComponent],\n  imports: [\n    CommonModule,\n    DirectivesModule,\n    MaterialModule,\n    ButtonsModule,\n    IconModule,\n    NgxGoogleAnalyticsModule\n  ],\n  exports: [NodeActionsComponent]\n})\nexport class NodeActionsModule { }\n","<div class=\"panel\" \n  [ngClass]=\"{\n    'panel--static': toggleType === 'none', \n    'panel--disabled': disabled, \n    'panel--open': open, \n    'panel--closed': open === false, \n    'panel--compact': isCompact,\n    'panel--inactive': !active\n  }\">\n  <div class=\"panel__header\" (click)=\"handleClickHeader()\">\n    <div class=\"panel__prefix\"><ng-content select=\"[panel-prefix]\"></ng-content></div>\n\n    <div class=\"panel__label\">\n      <span class=\"html\" [innerHTML]=\"label | markdown\" *ngIf=\"label; else labelContent\"></span>\n\n      <ng-template #labelContent>\n        <ng-content select=\"[panel-label]\"></ng-content>\n      </ng-template>\n    </div>\n\n    \n\n    <div class=\"panel__actions\" appEventFence>\n      <ng-content select=\"[panel-actions]\"></ng-content>\n    </div>\n\n\n    <ng-container [ngSwitch]=\"toggleType\" *ngIf=\"toggleType !== 'none'\">\n      <!-- Arrow Toggle -->\n      <div\n        class=\"panel__toggle panel__toggle--arrow rotate--animate\"\n        [ngClass]=\"{\n          'rotate-90': open,\n          'rotate-0': !open\n        }\"\n        *ngSwitchCase=\"'arrow'\">\n        <app-icon icon=\"angle-right\"></app-icon>\n      </div>\n\n      <!-- Checkbox Toggle -->\n      <div\n        appEventFence\n        class=\"panel__toggle panel__toggle--checkbox\"\n        *ngSwitchCase=\"'checkbox'\">\n        <mat-checkbox\n          [disabled]=\"disabled\"\n          [checked]=\"open\"\n          (change)=\"open = $event.checked\"></mat-checkbox>\n      </div>\n    </ng-container>\n  </div>\n\n  <!-- panel hint -->\n  <div class=\"panel__hint text-11\" *ngIf=\"hint && !open\">\n      {{ hint }}\n  </div>\n\n  <div class=\"panel__body\">\n    <ng-content></ng-content>\n  </div>\n</div>","import { Component, OnInit, Input, EventEmitter, Output, ElementRef, ChangeDetectionStrategy, forwardRef, ChangeDetectorRef } from '@angular/core';\nimport { ControlValueAccessor, NG_VALUE_ACCESSOR } from '@angular/forms';\n\n@Component({\n  selector: 'app-panel',\n  templateUrl: './panel.component.html',\n  styleUrls: ['./panel.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  providers: [\n    {\n      provide: NG_VALUE_ACCESSOR,\n      useExisting: forwardRef(() => PanelComponent),\n      multi: true\n    }\n  ]\n})\nexport class PanelComponent implements OnInit, ControlValueAccessor {\n  @Input()\n  label: string;\n\n  @Input()\n  hint: string;\n\n  @Input()\n  public get open() {\n    return this._open;\n  }\n  public set open(value) {\n    if (value !== this.open) {\n      this._open = value;\n      this.value = value;\n    }\n  }\n  private _open: boolean;\n\n  @Input()\n  public get value() {\n    return this._value;\n  }\n  public set value(value) {\n    if (value !== this.value) {\n      this._value = value;\n      this.open = value;\n      this.propagateChange(this.value);\n      this.changeRef.markForCheck();\n    }\n  }\n  private _value: boolean;\n\n  @Input()\n  toggleType: 'arrow' | 'checkbox' | 'none' = 'none';\n\n  @Input()\n  toggleable = true;\n\n  @Input()\n  dataTestAttributeVal;\n\n  @Input()\n  isCompact = false;\n\n  @Input()\n  active = true;\n\n  @Output()\n  opened: EventEmitter<boolean> = new EventEmitter<boolean>();\n\n  disabled = false;\n\n  constructor(private changeRef: ChangeDetectorRef) {\n  }\n\n  ngOnInit() {\n  }\n\n  // ---------- Handlers ----------\n  handleClickHeader() {\n    if (this.toggleType === 'none' || this.disabled || !this.toggleable) {\n      return;\n    }\n\n    this.open = !this.open;\n\n    // Only emit opened event when triggered by user. We do this so the application can react\n    // specifically to user input, without interference from programatic changes of the opened\n    // state.\n    this.opened.emit(this.open);\n  }\n\n  onChange: any = () => { };\n  onTouched: any = () => { };\n\n  writeValue(value: boolean): void {\n    this.value = value;\n  }\n\n  registerOnChange(fn: any): void {\n    this.propagateChange = fn;\n  }\n\n  registerOnTouched(fn: any): void {\n    this.onTouched = fn;\n  }\n\n  setDisabledState?(isDisabled: boolean): void {\n    this.disabled = isDisabled;\n  }\n\n  propagateChange = (_: any) => {};\n}\n","<div class=\"pillbox-divider\"></div>","import { Component, OnInit, ChangeDetectionStrategy, ViewEncapsulation } from '@angular/core';\n\n@Component({\n  selector: 'app-pillbox-divider',\n  templateUrl: './pillbox-divider.component.html',\n  styleUrls: ['./pillbox-divider.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None\n})\nexport class PillboxDividerComponent implements OnInit {\n\n  constructor() { }\n\n  ngOnInit() {\n  }\n\n}\n","<div \n  [gaCategory]=\"eventCategory\"\n  class=\"pillbox\"\n  [ngClass]=\"{\n    'pillbox--padding-dense': padding === 'dense',\n    'pillbox--padding-none': padding === 'none',\n    'pillbox--vertical': orientation === 'vertical'\n  }\">\n  <ng-content></ng-content>\n  \n  <ng-container *ngIf=\"canExit\">\n    <app-pillbox-divider></app-pillbox-divider>\n\n    <button \n      gaEvent\n      [gaAction]=\"'Clicked Close ' + name\"\n      app-pin-button\n      buttonType=\"ghost\"\n      (click)=\"handleExitClick()\"\n      [attr.aria-label]=\"'Close ' + name\"\n      [matTooltip]=\"'Close ' + name\"\n      icon=\"times\">\n    </button>\n  </ng-container>\n</div>","import { Component, OnInit, ChangeDetectionStrategy, ViewEncapsulation, Input, Output, EventEmitter } from '@angular/core';\n\n@Component({\n  selector: 'app-pillbox',\n  templateUrl: './pillbox.component.html',\n  styleUrls: ['./pillbox.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None\n})\nexport class PillboxComponent implements OnInit {\n  @Input()\n  canExit = false;\n\n  @Input()\n  padding: 'none' | 'dense' | 'normal' = 'normal';\n\n  @Input()\n  orientation: 'horizontal' | 'vertical' = 'horizontal';\n\n  @Input()\n  name = '';\n\n  // Used for Google Analytics event tracking\n  // See: https://www.notion.so/biodigital/Human-Web-Google-Analytics-Events-d685075c60b84e0fbca3c2139775608b\n  @Input()\n  eventCategory = '';\n\n  @Output()\n  exit = new EventEmitter();\n\n  constructor() { }\n\n  ngOnInit() {\n  }\n\n  handleExitClick() {\n    this.exit.emit();\n  }\n\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { PillboxComponent } from './pillbox.component';\nimport { ButtonsModule } from '../buttons/buttons.module';\nimport { MaterialModule } from 'src/app/material.module';\nimport { PillboxDividerComponent } from './pillbox-divider/pillbox-divider.component';\nimport { NgxGoogleAnalyticsModule } from 'ngx-google-analytics';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    ButtonsModule,\n    MaterialModule,\n    NgxGoogleAnalyticsModule\n  ],\n  declarations: [\n    PillboxComponent,\n    PillboxDividerComponent\n  ],\n  exports: [\n    PillboxComponent,\n    PillboxDividerComponent\n  ]\n})\nexport class PillboxModule { }\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { SpinnerComponent } from '../progress-indicators/spinner/spinner.component';\nimport { ProgressComponent } from './progress/progress.component';\n\n@NgModule({\n  imports: [\n    CommonModule\n  ],\n  declarations: [\n    SpinnerComponent,\n    ProgressComponent\n  ],\n  exports: [\n    SpinnerComponent,\n    ProgressComponent\n  ]\n})\nexport class ProgressIndictatorsModule { }\n","<div class=\"progress\">\n  <div class=\"progress__bar\" \n    [ngClass]=\"{'progress__bar--complete': percentWidth === 100}\"\n    [ngStyle]=\"{'width': percentWidth + '%'}\"></div>\n</div>","import { Component, OnInit, Input, ChangeDetectionStrategy, ChangeDetectorRef, OnDestroy } from '@angular/core';\nimport { Router, NavigationStart } from '@angular/router';\nimport { Subject } from 'rxjs';\nimport { takeUntil } from 'rxjs/operators';\n\n@Component({\n  selector: 'app-progress',\n  templateUrl: './progress.component.html',\n  styleUrls: ['./progress.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class ProgressComponent implements OnInit, OnDestroy {\n  @Input()\n  total = 100;\n\n  @Input()\n  public get value() {\n    return this._value;\n  }\n  public set value(value) {\n    this._value = value;\n    this.percentWidth = this.value / this.total * 100;\n    this.changeDetector.markForCheck();\n  }\n  private _value = 0;\n\n  percentWidth = 0;\n  private ngUnsubscribe = new Subject();\n\n  constructor(\n    private router: Router,\n    private changeDetector: ChangeDetectorRef\n  ) { }\n\n  ngOnInit() {\n    this.router.events\n      .pipe(takeUntil(this.ngUnsubscribe))\n      .subscribe((event) => {\n        if (event instanceof NavigationStart) {\n          this.value = 0;\n        }\n      });\n  }\n\n  ngOnDestroy() {\n    this.changeDetector.detach();\n\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n}\n","<div\n  class=\"spinner spinner--horizontal\"\n  [ngClass]=\"[\n    'spinner--' + size,\n    'spinner--' + render,\n    'spinner--' + direction\n  ]\">\n  <div \n    class=\"spinner__circle\">\n  </div>\n\n  <div class=\"spinner__label\" *ngIf=\"label.length\">\n    {{ label }}\n  </div>\n</div>\n","import { Component, OnInit, Input, ChangeDetectionStrategy, ViewEncapsulation } from '@angular/core';\n\nexport enum SpinnerSize {\n  Small = 'small',\n  Medium = 'medium',\n  Large = 'large',\n  Huge = 'huge'\n}\n\nexport enum SpinnerDirection {\n  Horizontal = 'horizontal',\n  Vertical = 'vertical'\n}\n\nexport enum SpinnerRender {\n  Inline = 'inline',\n  Block = 'block',\n  Fill = 'fill'\n}\n\n@Component({\n  selector: 'app-spinner',\n  templateUrl: './spinner.component.html',\n  styleUrls: ['./spinner.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class SpinnerComponent implements OnInit {\n  @Input()\n  size: SpinnerSize = SpinnerSize.Medium;\n\n  @Input()\n  label = '';\n\n  @Input()\n  direction = SpinnerDirection.Horizontal;\n\n  @Input()\n  render = SpinnerRender.Fill;\n\n  constructor() { }\n\n  ngOnInit() {\n  }\n\n}\n","<div class=\"slider\">\n  <div class=\"slider__range\">\n    <input\n      type=\"range\"\n      class=\"range\"\n      [class.light]=\"theme === 'light'\"\n      [class.dark]=\"theme === 'dark'\"\n      [(ngModel)]=\"value\"\n      [min]=\"min\"\n      [max]=\"max\"\n      [step]=\"step\"\n      [disabled]=\"disabled\"\n      (dblclick)=\"handleRangeDoubleClick()\"\n      (mouseup)=\"handleMouseUp()\"\n    />\n  </div>\n\n  <div class=\"slider__input\">\n    <input\n      type=\"number\"\n      class=\"input\"\n      [(ngModel)]=\"value\"\n      [min]=\"min\"\n      [max]=\"max\"\n      [step]=\"step\"\n      [disabled]=\"disabled\"\n      (blur)=\"handleBlur()\"\n    />\n  </div>\n</div>\n","import { Component, OnInit, forwardRef, Input, Output, EventEmitter } from '@angular/core';\nimport { ControlValueAccessor, NG_VALUE_ACCESSOR } from '@angular/forms';\nimport { Subject } from 'rxjs';\n\n@Component({\n  selector: 'app-slider',\n  templateUrl: './slider.component.html',\n  styleUrls: ['./slider.component.scss'],\n  providers: [\n    {\n      provide: NG_VALUE_ACCESSOR,\n      useExisting: forwardRef(() => SliderComponent),\n      multi: true\n    }\n  ],\n})\n\nexport class SliderComponent implements OnInit, ControlValueAccessor {\n\n  @Input()\n  theme: 'light' | 'dark' = 'dark';\n  \n  @Input()\n  min = 0;\n\n  @Input()\n  max = 100;\n\n  @Input()\n  step = 1;\n\n  @Input()\n  public get value() {\n    return this._value;\n  }\n  public set value(value) {\n    if (value != null) {\n      if (this._initialValue == null) {\n        this._initialValue = value;\n      }\n\n      this._value = value;\n      this.propagateChange(this.value);\n    }\n  }\n  private _value = 0;\n  private _initialValue;\n\n  disabled = false;\n\n  @Output()\n  blurred = new EventEmitter();\n  \n  @Output()\n  mouseUp = new EventEmitter();\n  \n  constructor(\n    ) { }\n    \n  ngOnInit() {\n  }\n\n\n  handleMouseUp() {\n    this.mouseUp.emit();\n  }\n  \n  handleBlur() {\n    this.blurred.emit();\n  }\n\n  handleRangeDoubleClick() {\n    this.value = this._initialValue;\n  }\n    \n  // Both onChange and onTouched are functions\n  onChange: any = () => { };\n  onTouched: any = () => { };\n\n  writeValue(value: any): void {\n    this.value = value;\n  }\n\n  registerOnChange(fn: any): void {\n    this.propagateChange = fn;\n  }\n\n  registerOnTouched(fn: any): void {\n    this.onTouched = fn;\n  }\n\n  setDisabledState?(isDisabled: boolean): void {\n    this.disabled = isDisabled;\n  }\n\n  propagateChange = (_: any) => {};\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { SliderComponent } from './slider.component';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule\n  ],\n  declarations: [\n    SliderComponent\n  ],\n  exports: [\n    SliderComponent\n  ]\n})\nexport class SliderModule { }\n","<button\n  app-button\n  buttonTheme=\"light\"\n  *ngIf=\"sort\"\n  data-test=\"gallerySortBy\"\n  [uppercase]=\"false\"\n  [matMenuTriggerFor]=\"sortActions\">\n  <span style=\"white-space: nowrap\">\n    Sort By: <span class=\"text-semibold\">{{ sort.label }}</span> <app-icon icon=\"caret-down\" class=\"ml-1\"></app-icon>\n  </span>\n</button>\n\n<mat-menu #sortActions=\"matMenu\">\n  <button\n    mat-menu-item\n    *ngFor=\"let option of sortOptions\"\n    (click)=\"handleSort(option)\">\n    {{ option.label }}\n  </button>\n</mat-menu>","import { Component, OnInit, EventEmitter, Output, Input, ChangeDetectorRef, ChangeDetectionStrategy } from '@angular/core';\nimport { SortModel } from 'src/app/bookmarks/models/bookmark-sort.model';\n\ntype SortableModel = SortModel<any>;\n\n@Component({\n  selector: 'app-sort',\n  templateUrl: './sort.component.html',\n  styleUrls: ['./sort.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class SortComponent implements OnInit {\n  @Input()\n  public get sort(): SortableModel {\n    return this._sort;\n  }\n  public set sort(value: SortableModel) {\n    this._sort = value;\n    this.changeDetectorRef.markForCheck();\n  }\n  private _sort: SortableModel;\n\n  @Input()\n  sortOptions: SortableModel[] = [];\n\n  @Output()\n  sortChange = new EventEmitter<SortableModel>();\n\n  constructor(\n    private changeDetectorRef: ChangeDetectorRef\n  ) { }\n\n  ngOnInit() {\n  }\n\n  handleSort(option: SortableModel) {\n    this.sortChange.emit(option);\n  }\n\n}\n","<div\n  class=\"item\"\n  [class.item--x-small]=\"size === 'x-small'\"\n  [class.item--small]=\"size === 'small'\"\n  [class.item--medium]=\"size === 'medium'\"\n  [class.item--large]=\"size === 'large'\"\n  [class.item--x-large]=\"size === 'x-large'\"\n  [class.item--selected]=\"selected\"\n  [class.item--transparent]=\"isTransparent\"\n  [style.background-image]=\"getBackgroundCSS()\">\n</div>","import { Component, OnInit, ChangeDetectionStrategy, Input } from '@angular/core';\nimport { BackgroundModel } from 'src/app/engine/models/background.model';\nimport { DomSanitizer, SafeStyle } from '@angular/platform-browser';\n\n@Component({\n  selector: 'app-swatch-item',\n  templateUrl: './swatch-item.component.html',\n  styleUrls: ['./swatch-item.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class SwatchItemComponent implements OnInit {\n\n  @Input()\n  color: BackgroundModel;\n\n  @Input()\n  size: 'x-small' | 'small' | 'medium' | 'large' | 'x-large' = 'medium';\n\n  @Input()\n  selected: false;\n\n  get isTransparent(): boolean {\n    return this.color && BackgroundModel.isTransparent(this.color);\n  }\n\n  constructor(\n    private domSanitizer: DomSanitizer\n  ) { }\n\n  ngOnInit() {\n  }\n\n  getBackgroundCSS(): SafeStyle {\n    if (this.color && !this.isTransparent) {\n      const css = BackgroundModel.toCSS(this.color);\n      return this.domSanitizer.bypassSecurityTrustStyle(css);\n    } else {\n      return null;\n    }\n  }\n\n}\n","<div *ngIf=\"isActive\">\n    <ng-content></ng-content>\n</div>","import { Component, OnInit, Input, ChangeDetectionStrategy, ChangeDetectorRef } from '@angular/core';\n\n@Component({\n  selector: 'app-tab',\n  templateUrl: './tab.component.html',\n  styleUrls: ['./tab.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class TabComponent implements OnInit {\n  @Input()\n  label: string;\n\n  @Input()\n  hide = false;\n\n  public get isActive() {\n    return this._isActive;\n  }\n  public set isActive(value) {\n    this._isActive = value;\n    this.changeDetector.markForCheck();\n  }\n  private _isActive = false;\n\n  constructor(\n    private changeDetector: ChangeDetectorRef\n  ) { }\n\n  ngOnInit() {\n  }\n\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { TabComponent } from './tab/tab.component';\nimport { TabsComponent } from './tabs/tabs.component';\n\n@NgModule({\n  imports: [\n    CommonModule\n  ],\n  declarations: [\n    TabComponent,\n    TabsComponent\n  ],\n  exports: [\n    TabComponent,\n    TabsComponent\n  ]\n})\nexport class TabsModule { }\n","<div class=\"tabs\" [ngClass]=\"{\n    'tabs--small': tabSize == 'small',\n    'tabs--medium': tabSize == 'medium'\n  }\">\n  <div class=\"tabs__labels\">\n    <span *ngFor=\"let tabItem of tabItems\">\n      <!-- Internal -->\n      <a\n        *ngIf=\"!tabItem.tab.linkExternal\"\n        (click)=\"handleTabSelect(tabItem)\"\n        class=\"tabs__label\"\n        [class.tabs__label--active]=\"isTabActive(tabItem)\">\n        <span>{{ tabItem.label }}</span>\n      </a>\n    </span>\n  </div>\n\n  <div class=\"tabs__content\">\n    <ng-content></ng-content>\n  </div>\n</div>\n  ","import { \n  Component,\n  OnInit,\n  ContentChildren,\n  QueryList,\n  Input,\n  AfterContentInit,\n  ChangeDetectionStrategy,\n  OnDestroy,\n  ChangeDetectorRef,\n  Output,\n  EventEmitter\n} from '@angular/core';\nimport { TabComponent } from '../tab/tab.component';\nimport { BehaviorSubject, Subject } from 'rxjs';\nimport { takeUntil, tap, pairwise, filter } from 'rxjs/operators';\n\nexport class TabItem {\n  index: number;\n  label: string;\n  tab: TabComponent;\n}\n\n@Component({\n  selector: 'app-tabs',\n  templateUrl: './tabs.component.html',\n  styleUrls: ['./tabs.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class TabsComponent implements OnInit, AfterContentInit, OnDestroy {\n  @ContentChildren(TabComponent)\n  _tabs: QueryList<TabComponent>;\n  \n  @Input()\n  public display: 'normal' | 'inline' = 'normal';\n\n  @Input()\n  public get activeTab(): string | number {\n    return this._activeTab.value;\n  }\n  public set activeTab(value: string | number) {\n    if (value != null) {\n      if (typeof value === 'string') {\n        value = value.toUpperCase();\n      }\n      this._activeTab.next(value);\n    }\n  }\n\n  @Output()\n  activeTabChange = new EventEmitter<string | number>();\n\n  _activeTab: BehaviorSubject<string | number> = new BehaviorSubject<string | number>(0);\n\n  @Input()\n  public tabSize: 'small' | 'medium' = 'small';\n\n  public get tabItems(): TabItem[] {\n    return this._tabItems;\n  }\n  public set tabItems(value: TabItem[]) {\n    this._tabItems = value;\n  }\n  private _tabItems: TabItem[];\n\n  private ngUnsubscribe = new Subject();\n\n  constructor(\n    private changeDetector: ChangeDetectorRef\n  ) { }\n\n\n  ngOnInit() {\n  }\n\n\n  ngAfterContentInit() {\n    this._tabs.changes\n      .pipe(\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe((tabs: QueryList<TabComponent>) => {\n        this.mapTabs();\n        this.changeDetector.markForCheck();\n      });\n\n    this.mapTabs();\n\n    this._activeTab\n      .pipe(takeUntil(this.ngUnsubscribe))\n      .subscribe((tab) => {\n        this.showTab(tab);\n      });\n\n    // notify selected tab\n    this._activeTab\n      .pipe(\n        pairwise(),\n        filter(([previousTab, currentTab]) => previousTab !== currentTab),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(([previousTab, currentTab]) => {\n        this.activeTabChange.next(currentTab);\n      });\n  }\n\n  ngOnDestroy() {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n\n  handleTabSelect(tabItem: TabItem) {\n    this._activeTab.next(tabItem.index);\n  }\n\n  mapTabs() {\n    this.tabItems = this._tabs.map((tab, index) => {\n      return {\n        index: index,\n        label: tab.label || `Item ${index}`,\n        tab: tab\n      };\n    });\n  }\n\n  \n  showTab(tabSelector: string | number) {\n    this._tabs.forEach((_tab, _index) => {\n      switch (typeof tabSelector) {\n        case 'number':\n          _tab.isActive = (tabSelector === _index);\n          break;\n        case 'string':\n          _tab.isActive = (tabSelector.toString().toUpperCase() === _tab.label.toUpperCase());\n          break;\n      }\n    });\n\n    this.changeDetector.markForCheck();\n  }\n\n  isTabActive(tabItem: TabItem) {\n    const tabValue = (typeof this._activeTab.value === 'string') ? tabItem.label.toUpperCase() : tabItem.index;\n    return tabValue === this._activeTab.value;\n  }\n}\n","<div \n  class=\"tree-group\" \n  [ngClass]=\"{ \n    'tree-group--light': theme === treeTheme.Light,\n    'tree-group--themed': theme === treeTheme.Themed\n  }\"\n  *ngFor=\"let node of nodes; trackBy: trackTreeNode\">\n  \n  <app-tree-nested-node \n    [graph]=\"graph\" \n    [node]=\"node\"\n    [theme]=\"theme\">\n  </app-tree-nested-node>\n\n  <div class=\"tree-group__children\" *ngIf=\"node.boolState.expanded\">\n    <!-- Collapser -->\n    <div \n      class=\"tree-group__collapse\" \n      *ngIf=\"hasChildren(node)\" \n      (click)=\"handleExpandClick(node, true)\" \n      [title]=\"node.label\"></div>\n    \n    <!-- Children -->\n    <app-tree-group \n      [graph]=\"graph\" \n      [node]=\"node\"\n      [theme]=\"theme\"\n      (clickNode)=\"handleNodeClick($event)\"></app-tree-group>\n  </div>\n</div>\n","import { Component, OnInit, Input, ChangeDetectionStrategy, OnDestroy } from '@angular/core';\nimport { BdGraph } from 'src/lib/graph/graph.model';\nimport { ViewTreeNode } from 'src/app/engine/models/view.tree-node';\nimport { BdGraphService } from 'src/lib/graph/graph.service';\nimport { BehaviorSubject, Subject } from 'rxjs';\nimport { Store } from '@ngxs/store';\nimport { takeUntil } from 'rxjs/operators';\nimport { TreeTheme } from '../tree/tree.component';\nimport { GraphUtils } from 'src/lib/graph/graph-utils';\nimport { ExpandViewTreeNode, CollapseViewTreeNode } from 'src/app/engine/state/engine.actions';\n\nexport interface NodeEvent {\n  node: ViewTreeNode;\n  checked: boolean;\n}\n\n@Component({\n  selector: 'app-tree-group',\n  templateUrl: './tree-group.component.html',\n  styleUrls: ['./tree-group.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class TreeGroupComponent implements OnInit, OnDestroy {\n  treeTheme = TreeTheme;\n\n  @Input()\n  public get graph(): BdGraph<ViewTreeNode> {\n    return this._graph;\n  }\n  public set graph(value: BdGraph<ViewTreeNode>) {\n    if (!value) {\n      return;\n    }\n\n    this._graph = value;\n    this.graphSubject.next(value);\n  }\n  private _graph: BdGraph<ViewTreeNode>;\n  private graphSubject = new BehaviorSubject<BdGraph<ViewTreeNode>>(null);\n\n  @Input()\n  theme: TreeTheme = TreeTheme.Dark;\n\n  @Input()\n  node: ViewTreeNode;\n\n  nodes: ViewTreeNode[] = [];\n  childCount: number;\n  \n  private ngUnsubscribe = new Subject();\n  \n  constructor(\n    private graphService: BdGraphService,\n    private store: Store\n  ) { }\n\n  ngOnInit() {\n    this.graphSubject\n      .pipe(\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(graph => {\n        if (!graph) {\n          return;\n        }\n        this.getNodes();\n      });\n  }\n\n  ngOnDestroy() {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n  getNodes() {\n    const nodeIds = (this.node) ? \n      GraphUtils.getSuccessors(this.graph, this.node.id) : \n      GraphUtils.getRoots(this.graph);\n\n    this.nodes = this.graphService.getNodes(this.graph, nodeIds);\n  }\n\n  countChildren(node: ViewTreeNode) {\n    return GraphUtils.getSuccessors(this.graph, node.id).length;\n  }\n\n  hasChildren(node: ViewTreeNode) {    \n    return this.countChildren(node) > 0;\n  }\n\n  trackTreeNode(index: number, node: ViewTreeNode) { \n    return node.id; \n  }\n\n  handleExpandClick(node: ViewTreeNode, expanded: boolean) {\n    (expanded) ?\n      this.store.dispatch(new CollapseViewTreeNode(node)) :\n      this.store.dispatch(new ExpandViewTreeNode(node));\n  }\n}\n","<!-- Node -->\n<div\n  gaCategory=\"Search Node\"\n  data-test=\"treeNode\"\n  class=\"tree-node\"\n  [attr.data-id]=\"sanitizedID\"\n  (keyup.enter)=\"handleNodeClick($event, node)\"\n  (click)=\"handleNodeClick($event, node)\"\n  tabindex=\"0\"\n  [ngClass]=\"{\n    'tree-node--light': theme === treeTheme.Light,\n    'tree-node--themed': theme === treeTheme.Themed,\n    'tree-node--hidden': !node.boolState.shown,\n    'tree-node--selected': checked,\n    'tree-node--unpickable': !node.boolState.pickable && isLoft\n  }\">\n\n  <!-- Expander -->\n  <div\n    appEventFence\n    (click)=\"handleExpandClick(node, node.boolState.expanded)\"\n    class=\"tree-node__expand\"\n    data-test=\"treeNodeExpand\"\n    [class.tree-node__expand--open]=\"node.boolState.expanded\"\n    *ngIf=\"nested && hasChildren\">\n\n    <app-icon icon=\"caret-right\"></app-icon>\n  </div>\n\n  <!-- Label -->\n  <div\n    class=\"tree-node__label\"\n    [ngClass]=\"{'tree-node__label--padded': !hasChildren && nested}\"\n    (dblclick)=\"setEditLabelMode(true)\"\n    *ngIf=\"!editLabelMode\">\n\n    <div class=\"flex flex-column\">\n      <div\n        data-test=\"treeNodeId\"\n        class=\"text-10 text-uppercase\"\n        style=\"opacity: 0.7;\"\n        *ngIf=\"showTreeNodeIds$ | async\">\n        {{ shortId }}\n      </div>\n  \n      <div data-test=\"treeNodeLabel\">\n        {{ node.label }}\n      </div>\n    </div>\n\n  </div>\n\n  <!-- Edit Object Label -->\n  <input\n    type=\"text\"\n    appEventFence\n    appAutoFocus\n    data-test=\"treeNodeEditLabel\"\n    [value]=\"node.label\"\n    (blur)=\"handleLabel($event)\"\n    (keyup)=\"handleLabel($event)\"\n    class=\"input\"\n    *ngIf=\"editLabelMode\">\n\n  <!-- Layer Order -->\n  <input\n    appEventFence\n    type=\"text\"\n    data-test=\"treeNodeLayerOrder\"\n    [value]=\"node.numState.layer\"\n    (change)=\"handleLayerOrder($event, node)\"\n    class=\"input input--small tree-node__layer-order\"\n    *ngIf=\"(layerOrderMode$ | async)\">\n\n  <!-- Visible -->\n  <div\n    gaEvent\n    gaAction=\"Clicked Toggle (Eye Icon)\"\n    [gaLabel]=\"node.boolState.shown ? 'Hide' : 'Show'\"\n    data-test=\"treeNodeVisible\"\n    class=\"tree-node__visible\"\n    (click)=\"toggleVisible(node)\"\n    appEventFence>\n    <app-icon icon=\"eye\" data-test=\"treeNodeVisibleTrue\" size=\"xs\" class=\"tree-node__eye\"></app-icon>\n    <app-icon icon=\"eye-slash\" data-test=\"treeNodeVisibleFalse\" size=\"xs\" class=\"tree-node__eye-slash\"></app-icon>\n  </div>\n\n  <app-node-actions eventCategory=\"Search Node\" [theme]=\"theme\" [node]=\"node\" appEventFence></app-node-actions>\n</div>","import { Component, OnInit, Input, ChangeDetectorRef, ChangeDetectionStrategy, OnDestroy, ViewEncapsulation } from '@angular/core';\nimport { ViewTreeNode } from 'src/app/engine/models/view.tree-node';\nimport { Store, Select } from '@ngxs/store';\nimport {\n  FlyToObject,\n  SetObjectLayerOrder,\n  SetObjectDisplayName,\n  CollapseViewTreeNode,\n  ExpandViewTreeNode,\n  SetLabelEditNode\n} from 'src/app/engine/state/engine.actions';\nimport { EditState } from 'src/app/edit/state/edit.state';\nimport { BdGraphService } from 'src/lib/graph/graph.service';\nimport { BdGraph } from 'src/lib/graph/graph.model';\nimport { Observable, Subject } from 'rxjs';\nimport { takeUntil } from 'rxjs/operators';\nimport { EngineNodesState } from 'src/app/engine/state/nodes/engine.nodes.state';\nimport { TreeTheme } from '../tree/tree.component';\nimport { environment } from 'src/environments/environment';\nimport { GraphUtils } from 'src/lib/graph/graph-utils';\nimport { Router } from '@angular/router';\nimport { EnvironmentApplication } from 'src/environments/models/environment-application';\nimport { NodeActions } from 'src/app/engine/state/nodes/engine.nodes.actions';\nimport { EngineState } from 'src/app/engine/state/engine.state';\n\n@Component({\n  selector: 'app-tree-nested-node',\n  templateUrl: './tree-nested-node.component.html',\n  styleUrls: ['./tree-nested-node.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None\n})\n\nexport class TreeNestedNodeComponent implements OnInit, OnDestroy {\n  treeTheme = TreeTheme;\n  isLoft = environment.exportType === 'module';\n\n  @Select(EngineNodesState.getCheckedNodeIds)\n  checkedNodesIds$: Observable<string[]>;\n\n  @Select(EditState.getLayerOrderMode)\n  layerOrderMode$: Observable<boolean>;\n\n  @Select(EngineState.getLabelEditNode)\n  labelEditNode$: Observable<ViewTreeNode>;\n  \n  @Select(EditState.getShowTreeNodeIds)\n  showTreeNodeIds$: Observable<boolean>;\n\n\n  @Input()\n  graph: BdGraph<ViewTreeNode>;\n\n  @Input()\n  public get node(): ViewTreeNode {\n    return this._node;\n  }\n  public set node(value: ViewTreeNode) {\n    this._node = value;\n    \n    this.sanitizedID = this.graphService.sanitizeNodeID(this.node.id);\n\n    this.checked = this.isNodeChecked(this.node.id);\n    const ids = this.node.id.split('-');\n    if (ids.length === 2) {\n      this.parentId = ids[0];\n      this.shortId = ids[1];\n    } else {\n      this.shortId = ids[0];\n      this.parentId = '';\n    }\n    this.shortId = this.shortId.replace(/_/g, ' ');\n\n    this.hasChildren = GraphUtils.getSuccessors(this.graph, this.node.id).length > 0;\n\n    this.changeDetection.markForCheck();\n  }\n\n  private _node: ViewTreeNode;\n\n  @Input()\n  nested = true;\n\n  @Input()\n  theme: TreeTheme = TreeTheme.Dark;\n\n  checked = false;\n  hasChildren = false;\n  editLabelMode = false;\n\n  // DOM friendly version of node ID\n  // nodeID may include pipe characters, which cause errors with querySelector\n  sanitizedID = '';\n\n  // Last piece of ID only, for loft users\n  parentId = '';\n  shortId = '';\n\n\n  private ngUnsubscribe = new Subject();\n  private isEditMode: boolean;\n\n  constructor(\n    private store: Store,\n    private graphService: BdGraphService,\n    private router: Router,\n    private changeDetection: ChangeDetectorRef\n  ) { }\n\n  private isNodeChecked(id: string) {\n    const nodes = this.store.selectSnapshot(EngineNodesState.getNodes);\n    return nodes[id].checked;\n  }\n\n  private isNodeShown(id: string) {\n    const nodes = this.store.selectSnapshot(EngineNodesState.getNodes);\n    return nodes[id].shown;\n  }\n\n  ngOnInit() {\n    this.checkedNodesIds$\n      .pipe(\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(nodeIds => {\n        this.checked = nodeIds.some((id) => id === this.node.id);\n        this.changeDetection.markForCheck();\n      });\n\n    this.labelEditNode$\n      .pipe(\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(node => {\n        this.editLabelMode = node === this.node;\n      });\n\n    // set editing mode\n    this.isEditMode = this.router.url.indexOf('/edit') >= 0;\n  }\n\n  ngOnDestroy() {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n  handleExpandClick(node: ViewTreeNode, expanded: boolean) {\n    (expanded) ?\n      this.store.dispatch(new CollapseViewTreeNode(node)) :\n      this.store.dispatch(new ExpandViewTreeNode(node));\n  }\n\n  handleNodeClick(event: MouseEvent, node: ViewTreeNode) {\n    if (event.shiftKey) {\n      this.checkNode(node);\n    } else {\n      this.setCheckedNodes(node);\n      // fly to: when not editing\n      if (!this.isEditMode) {\n        this.store.dispatch(new FlyToObject(node.id));\n      }\n\n      this.handleExpandClick(node, !node.boolState.expanded);\n    }\n  }\n\n  toggleVisible(node: ViewTreeNode, show?: boolean) {\n    const shouldShow = show === undefined ? !this.isNodeShown(node.id) : show;\n    this.store.dispatch(new NodeActions.UpdateNodesShown(shouldShow, [node.id]));\n    this.changeDetection.markForCheck();\n  }\n\n  handleLayerOrder(event: Event, node: ViewTreeNode) {\n    const eventTarget = event.target as HTMLInputElement;\n    const layer = parseInt(eventTarget.value, 10);\n\n    this.setLayerOrder(node, layer);\n  }\n\n  checkNode(node: ViewTreeNode, checked?: boolean) {\n    const shouldCheck = checked === undefined ? !this.isNodeChecked(node.id) : checked;\n    this.store.dispatch(new NodeActions.UpdateNodesChecked(shouldCheck, [node.id]));\n  }\n\n\n  setCheckedNodes(node: ViewTreeNode, checked?: boolean) {\n    this.store.dispatch(new NodeActions.UpdateNodesChecked(false));\n    const shouldCheck = checked === undefined ? !this.isNodeChecked(node.id) : checked;\n    this.store.dispatch(new NodeActions.UpdateNodesChecked(shouldCheck, [node.id]));\n  }\n\n  setLayerOrder(node: ViewTreeNode, layer: number) {\n    this.store.dispatch(new SetObjectLayerOrder([node], layer));\n    this.changeDetection.markForCheck();\n  }\n\n  // FIXME: naming this `handleLabel` is confusing.  Here, a 'label' refers \n  // to an object's display name, but the name collides with 'labeling' anatomy in the 3d scene.\n  handleLabel(event: Event) {\n    const eventTarget = event.target as HTMLInputElement;\n\n    if (event instanceof KeyboardEvent) {\n\n      if (event.key.toLowerCase() === 'enter') {\n        this.setLabel(eventTarget.value);\n        this.setEditLabelMode(false);\n      }\n\n      if (event.key.toLowerCase() === 'escape') {\n        this.setEditLabelMode(false);\n      }\n\n    } else if (event instanceof FocusEvent && event.type === 'blur') {\n      this.setLabel(eventTarget.value);\n      this.setEditLabelMode(false);\n    }\n\n  }\n\n  setLabel(label: string) {\n    this.node.label = label;\n    this.store.dispatch(new SetObjectDisplayName(this.node.id, label));\n  }\n\n  setEditLabelMode (mode: boolean) { // Restrict to the /edit page in Loft\n    if (environment.application === EnvironmentApplication.Loft && this.isEditMode) {\n      this.store.dispatch(new SetLabelEditNode(mode ? this.node : null));\n    }\n  }\n\n}\n\n","<div class=\"tree-search\">\n  <div class=\"tree-search__empty\" *ngIf=\"searchResults.length === 0\">\n    No results\n  </div>\n\n  <!-- Tree -->\n  <div *ngIf=\"displayMode === treeSearchDisplayMode.Tree\" class=\"pr-3 pv-3\">\n    <app-tree class=\"tree-search__tree\" [theme]=\"theme\" [searchGraph]=\"searchGraph\">\n    </app-tree>\n  </div>\n\n  <!-- List -->\n  <cdk-virtual-scroll-viewport\n    [itemSize]=\"64\"\n    class=\"pv-3\"\n    *ngIf=\"displayMode === treeSearchDisplayMode.List\"\n    [style.height.px]=\"searchHeight\">\n    \n    <div \n      *cdkVirtualFor=\"let node of searchResults; trackBy: trackTreeNode\">\n      <app-tree-nested-node\n        style=\"height: 64px;\"\n        class=\"mr-3\"\n        [theme]=\"theme\"\n        [node]=\"node\"\n        [graph]=\"prunedViewGraph\"\n        [nested]=\"false\">\n      </app-tree-nested-node>\n    </div>\n  </cdk-virtual-scroll-viewport>\n</div>","import { \n  Component,\n  OnInit,\n  Input,\n  ChangeDetectionStrategy,\n  AfterViewInit,\n  Renderer2,\n  ChangeDetectorRef,\n  OnDestroy,\n  ElementRef, \n  ViewEncapsulation,\n  Output,\n  EventEmitter} from '@angular/core';\nimport { BdGraph } from 'src/lib/graph/graph.model';\nimport { ViewTreeNode } from 'src/app/engine/models/view.tree-node';\nimport { Subject, Observable } from 'rxjs';\nimport { takeUntil } from 'rxjs/operators';\nimport { TreeTheme } from '../tree/tree.component';\nimport { EngineService } from 'src/app/engine/engine.service';\nimport { Store } from '@ngxs/store';\nimport { StoryChaptersState } from 'src/app/story/state/chapters/story.chapters.state';\nimport { remove as removeDiacritics } from 'diacritics';\nimport { getSearchTree } from './tree-search';\n\n\nexport enum TreeSearchDisplayMode {\n  List,\n  Tree\n}\n\n@Component({\n  selector: 'app-tree-search',\n  templateUrl: './tree-search.component.html',\n  styleUrls: ['./tree-search.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None\n})\nexport class TreeSearchComponent implements OnInit, AfterViewInit, OnDestroy {\n  @Input()\n  public get query() {\n    return this._query;\n  }\n  public set query(value) {\n    this._query = value || '';\n    this.handleQueryChange();\n  }\n  private _query = '';\n\n  @Input()\n  public get displayMode() {\n    return this._displayMode;\n  }\n  public set displayMode(value) {\n    if (value == null) {\n      return;\n    }\n\n    this._displayMode = value;\n    this.handleQueryChange();\n\n    this.displayModeChange.emit(this.displayMode);\n  }\n  _displayMode = TreeSearchDisplayMode.List;\n  \n  @Output()\n  displayModeChange = new EventEmitter<TreeSearchDisplayMode>();\n\n  @Input()\n  public get viewGraph(): BdGraph<ViewTreeNode> {\n    return this._viewGraph;\n  }\n  public set viewGraph(value: BdGraph<ViewTreeNode>) {\n    this._viewGraph = value;\n    this.leafNodes = this.engineService.getLeaves();\n\n    // create a pruned version of the viewGraph for interested consumers.\n    this.buildPrunedViewGraph(this.displayMode);\n    \n    this.handleQueryChange();\n    this.changeDetectorRef.markForCheck();\n  }\n  private _viewGraph: BdGraph<ViewTreeNode>;\n\n  @Input()\n  theme: TreeTheme = TreeTheme.Dark;\n\n  treeSearchDisplayMode = TreeSearchDisplayMode;\n  searchResults: ViewTreeNode[] = [];\n  searchHeight = 0;\n  ngUnsubscribe = new Subject();\n  leafNodes: string[];\n  searchGraph: BdGraph<ViewTreeNode>;\n  prunedViewGraph: BdGraph<ViewTreeNode>;\n\n  constructor(\n    private renderer: Renderer2,\n    private changeDetectorRef: ChangeDetectorRef,\n    private elementRef: ElementRef,\n    private engineService: EngineService,\n    private store: Store\n  ) { }\n\n  ngOnInit() {\n  }\n\n  buildPrunedViewGraph(mode: TreeSearchDisplayMode) {\n    // prune the graph according to chapter show objects\n    const currentChapter = this.store.selectSnapshot(StoryChaptersState.getSelectedChapter);\n\n    const prunedViewGraph: BdGraph<ViewTreeNode> = this.engineService.createViewGraph(\n      currentChapter.showObjects,\n      true // always prune on view page\n    );\n\n    this.prunedViewGraph = prunedViewGraph;\n  }\n\n  ngAfterViewInit() {\n    // Window has resized, let the 3D canvas know\n    this.renderer.listen('window', 'resize', (event) => {\n      this.resize();\n    });\n  }\n\n  ngOnDestroy() {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n  handleQueryChange() {\n    const searchResults = this.search(\n      this._query,\n      this.displayMode === TreeSearchDisplayMode.List\n        ? this.prunedViewGraph\n        : this.viewGraph\n    );\n\n\n    if (this.displayMode === TreeSearchDisplayMode.Tree) {\n      this.searchGraph = getSearchTree(this.viewGraph, searchResults);\n    }\n\n    this.searchResults = searchResults;\n    this.resize();\n  }\n\n  resize() {\n    this.getSearchHeight()\n      .pipe(takeUntil(this.ngUnsubscribe))\n      .subscribe((height) => {\n        this.searchHeight = height;\n        this.changeDetectorRef.markForCheck();\n      });\n  }\n\n  getSearchHeight(): Observable<number> {\n    const e = this.elementRef;\n\n    return new Observable<number>((observer) => {\n      setTimeout(() => {\n        const offsetHeight = this.elementRef.nativeElement.offsetHeight;\n  \n        if (offsetHeight != null) {\n          observer.next(offsetHeight);\n          observer.complete();\n        }\n      });\n    });\n  }\n\n  // return a sorted array of leaf nodes matching a query\n  search(query: string, viewGraph: BdGraph<ViewTreeNode>): ViewTreeNode[] {\n    if (viewGraph === undefined) {  \n      return [];\n    }\n\n    query = removeDiacritics(query.toLowerCase());\n    \n    const results = Object.values(viewGraph.nodes)\n      .filter((node: ViewTreeNode) => {\n        if (query.length === 0) {\n          return true;\n        }\n\n        return removeDiacritics(node.label.toLowerCase())\n          .indexOf(query) >= 0;\n      })\n      .sort((a, b) => {\n        return a.label.localeCompare(b.label);\n      });\n\n      return results;\n  }\n\n  trackTreeNode(index: number, node: ViewTreeNode) { \n    return node.id; \n  }\n  \n}\n","import { GraphUtils } from './../../../../../lib/graph/graph-utils';\nimport {\n  BdGraph,\n  BdGraphFactory\n} from './../../../../../lib/graph/graph.model';\nimport { ViewTreeNode } from 'src/app/engine/models/view.tree-node';\nimport { uniq } from 'lodash';\n\n/**\n *\n * Copy the node from the view graph over to the search results graph\n * Handles the node's ancestors recursively.\n *\n * @param searchGraph Search results in graph form\n * @param node The search result\n * @param viewGraph The original view graph\n */\nfunction copyNodeToSearchGraph(\n  searchGraph: BdGraph<ViewTreeNode>,\n  node: ViewTreeNode,\n  viewGraph: BdGraph<ViewTreeNode>\n) {\n  // add node\n  GraphUtils.addNode(searchGraph, node);\n  const parent = GraphUtils.getAncestor(viewGraph, node.id);\n\n  if (parent) {\n    // add successor\n    const successors = searchGraph.successors[parent] || [];\n    successors.push(node.id);\n    searchGraph.successors[parent] = uniq(successors);\n\n    // add predecessor\n    searchGraph.predecessors[node.id] = parent;\n\n    // recurse with the parent\n    return copyNodeToSearchGraph(\n      searchGraph,\n      GraphUtils.getNode(viewGraph, parent),\n      viewGraph\n    );\n  }\n\n  // if there's no parent, this node must be a root\n  GraphUtils.addRootNode(searchGraph, node);\n  return searchGraph;\n}\n\nexport function getSearchTree(\n  viewGraph: BdGraph<ViewTreeNode>,\n  searchResults: ViewTreeNode[]\n): BdGraph<ViewTreeNode> {\n  const searchTree = BdGraphFactory<ViewTreeNode>();\n  return searchResults.reduce(\n    (acc, result) => copyNodeToSearchGraph(acc, result, viewGraph),\n    searchTree\n  );\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { MaterialModule } from 'src/app/material.module';\nimport { TreeGroupComponent } from './tree-group/tree-group.component';\nimport { TreeNestedNodeComponent } from './tree-nested-node/tree-nested-node.component';\nimport { TreeComponent } from './tree/tree.component';\nimport { TreeSearchComponent } from './tree-search/tree-search.component';\nimport { DirectivesModule } from '../../directives/directives.module';\nimport { IconModule } from '../icon/icon.module';\nimport { NodeActionsModule } from '../node-actions/node-actions.module';\nimport { NgxGoogleAnalyticsModule } from 'ngx-google-analytics';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    IconModule,\n    MaterialModule,\n    NodeActionsModule,\n    DirectivesModule,\n    NgxGoogleAnalyticsModule\n  ],\n  declarations: [\n    TreeComponent,\n    TreeGroupComponent,\n    TreeNestedNodeComponent,\n    TreeSearchComponent\n  ],\n  exports: [\n    TreeComponent,\n    TreeGroupComponent,\n    TreeNestedNodeComponent,\n    TreeSearchComponent\n  ]\n})\nexport class TreeModule { }\n","<!-- Nested tree -->\n<app-tree-group\n  [theme]=\"theme\"\n  [graph]=\"searchGraph ? searchGraph : viewGraph$ | async\">\n</app-tree-group>","import { Component, OnInit, OnDestroy, Input } from '@angular/core';\nimport { Store, Select } from '@ngxs/store';\nimport { Subject, Observable } from 'rxjs';\nimport { filter, takeUntil } from 'rxjs/operators';\nimport { EngineNodesState } from 'src/app/engine/state/nodes/engine.nodes.state';\nimport { EngineState } from 'src/app/engine/state/engine.state';\nimport { BdGraph } from 'src/lib/graph/graph.model';\nimport { ViewTreeNode } from 'src/app/engine/models/view.tree-node';\nimport { BdGraphService } from 'src/lib/graph/graph.service';\nimport { NodeState } from 'src/app/engine/state/nodes/engine.nodes.state.model';\n\nexport enum TreeTheme {\n  Light = 'light',\n  Dark = 'dark',\n  Themed= 'themed'\n}\n\n@Component({\n  selector: 'app-tree',\n  templateUrl: './tree.component.html',\n  styleUrls: ['./tree.component.scss']\n})\nexport class TreeComponent implements OnInit, OnDestroy {\n  @Select(EngineState.getViewGraph)\n  viewGraph$: Observable<BdGraph<ViewTreeNode>>;\n\n  @Input()\n  theme = TreeTheme.Dark;\n\n  @Input()\n  searchGraph: BdGraph<ViewTreeNode>;\n\n  private ngUnsubscribe = new Subject();\n\n  constructor(\n    private store: Store,\n    private graphService: BdGraphService\n  ) { }\n\n  ngOnInit() {\n    // When the user selects a single structure, automatically scroll that structure into view\n    // Note: as of 04/16/2019 this is only support by Chrome and Firefox\n    this.store.select(EngineNodesState.getCheckedNodes)\n      .pipe(\n        // filter(nodes => nodes !== undefined),\n        filter(nodes => nodes.length === 1),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(node => {\n        setTimeout(() => {\n          this.scrollNodeIntoView(node[0]);\n        });\n      });\n  }\n\n  ngOnDestroy() {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n  scrollNodeIntoView(node: NodeState) {\n\n    const sanitizedID = this.graphService.sanitizeNodeID(node.objectId);\n    const target = <HTMLDivElement>document.querySelector(`[data-id=${sanitizedID}]`);\n\n    if (!target) {\n      return;\n    }\n\n    // Manual check to see if the browser support smooth scrolling.\n    // Although Safari supports scrollIntoView, it only has limited support via the boolean operator.\n    // More importantly, the scrolled column jumps position when the mouse hovers over it.\n    // For this reason we're not support Safari until Apple gets their act together.\n    const isSmoothScrollSupported = 'scrollBehavior' in document.documentElement.style;\n    if (isSmoothScrollSupported) {\n        target.scrollIntoView({\n          behavior: 'smooth',\n          block: 'nearest'\n        });\n      }\n    }\n\n}\n","export const isIE11 = () => window.navigator.userAgent.includes('Trident');\n","import { Directive, ElementRef, AfterContentInit } from '@angular/core';\n\n@Directive({\n  selector: 'input[appAutoFocus]'\n})\nexport class AutofocusDirective implements AfterContentInit {\n\n  constructor(\n    private el: ElementRef<HTMLInputElement>\n  ) { }\n\n  ngAfterContentInit() {\n    setTimeout(() => {\n      this.el.nativeElement.focus();\n    }, 0);\n  }\n\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { AutofocusDirective } from './autofocus.directive';\nimport { BlurOnEscapeDirective } from './blur-on-escape.directive';\nimport { EventFenceDirective } from './event-fence.directive';\nimport { FlagExternalDirective } from './flag-external.directive';\nimport { FlagInternalDirective } from './flag-internal.directive';\nimport { LazyCardsDirective } from './lazy-cards.directive';\nimport { SelectOnFocusDirective } from './select-on-focus.directive';\nimport { IE11HideDirective } from './ie11-hide.directive';\nimport { IE11ShowDirective } from './ie11-show.directive';\nimport { FlagApplicationDirective } from './flag-application.directive';\n\n@NgModule({\n  declarations: [\n    AutofocusDirective,\n    BlurOnEscapeDirective,\n    EventFenceDirective,\n    FlagApplicationDirective,\n    FlagExternalDirective,\n    FlagInternalDirective,\n    LazyCardsDirective,\n    SelectOnFocusDirective,\n    IE11HideDirective,\n    IE11ShowDirective\n  ],\n  exports: [\n    AutofocusDirective,\n    BlurOnEscapeDirective,\n    EventFenceDirective,\n    FlagApplicationDirective,\n    FlagExternalDirective,\n    FlagInternalDirective,\n    LazyCardsDirective,\n    SelectOnFocusDirective,\n    IE11HideDirective,\n    IE11ShowDirective\n  ],\n  imports: [\n    CommonModule\n  ]\n})\nexport class DirectivesModule { }\n","import { Directive, HostListener } from '@angular/core';\n\n@Directive({\n  selector: '[appEventFence]'\n})\nexport class EventFenceDirective {\n\n  constructor() {\n  }\n\n  @HostListener('click', ['$event', '$event.target'])\n  onClick(event: MouseEvent) {\n    event.stopPropagation();\n    event.stopImmediatePropagation();\n  }\n}\n","import { Directive, OnInit, TemplateRef, ViewContainerRef, ElementRef, Input, HostBinding } from '@angular/core';\nimport { environment } from 'src/environments/environment';\nimport { EnvironmentApplication } from 'src/environments/models/environment-application';\nimport { Router } from '@angular/router';\nimport { EnvironmentPlatform } from 'src/environments/models/environment-platform';\n\n\n/**\n * Example: *appFlagApplication=\"application.All; page: '/edit', mode:'include'\"\n */\n@Directive({\n  selector: '[appFlagApplication]'\n})\nexport class FlagApplicationDirective implements OnInit {\n  constructor(\n    private templateRef: TemplateRef<any>,\n    private viewContainer: ViewContainerRef,\n    private router: Router\n  ) {\n\n  }\n\n  @Input()\n  public get appFlagApplication() {\n    return this._appFlagApplication;\n  }\n  public set appFlagApplication(value: EnvironmentApplication | EnvironmentApplication[]) {\n    this._appFlagApplication = value;\n  }\n  private _appFlagApplication: EnvironmentApplication | EnvironmentApplication[];\n\n  @Input()\n  public get appFlagApplicationMode(): 'include' | 'exclude' {\n    return this._appFlagApplicationMode;\n  }\n  public set appFlagApplicationMode(value: 'include' | 'exclude') {\n    this._appFlagApplicationMode = value;\n  }\n  private _appFlagApplicationMode: 'include' | 'exclude' = 'include';\n\n  @Input()\n  public get appFlagApplicationPage(): string | string[] {\n    return this._appFlagApplicationPage;\n  }\n  public set appFlagApplicationPage(value: string | string[]) {\n    this._appFlagApplicationPage = value;\n  }\n  private _appFlagApplicationPage: string | string[];\n\n  @Input()\n  public get appFlagApplicationPlatform(): EnvironmentPlatform | EnvironmentPlatform[] {\n    return this._appFlagApplicationPlatform;\n  }\n  public set appFlagApplicationPlatform(value: EnvironmentPlatform | EnvironmentPlatform[]) {\n    this._appFlagApplicationPlatform = value;\n  }\n  private _appFlagApplicationPlatform: EnvironmentPlatform | EnvironmentPlatform[];\n  \n\n\n  ngOnInit() {\n    this.update();\n  }\n\n  update() {\n    let hasMatch = false;\n    let appMatch = false;\n    let pageMatch = false;\n    let platformMatch = false;\n\n    // Determine if the current environment matches the flag\n    if (this.appFlagApplication === '') {\n      appMatch = true; // application.All is an empty string\n    } else {\n      if (Array.isArray(this.appFlagApplication)) {\n        appMatch = this.appFlagApplication.some(application => application === environment.application);\n      } else if (typeof this.appFlagApplication === 'string') {\n        appMatch = this.appFlagApplication === environment.application;\n      }\n    }\n\n    // Page is optional so consider true when undeclared.\n    if (this.appFlagApplicationPage == null) {\n      pageMatch = true;\n    } else {\n      // When page is passed, determine if current page matches\n      const url = this.router.url;\n\n      if (Array.isArray(this.appFlagApplicationPage)) {\n        pageMatch = this.appFlagApplicationPage.some(page => url.indexOf(page) >= 0);\n      } else if (typeof this.appFlagApplicationPage === 'string') {\n        pageMatch = url.indexOf(this.appFlagApplicationPage) >= 0;\n      }\n    }\n\n    // Platform is optional so consider true when undeclared.\n    if (this.appFlagApplicationPlatform == null) {\n      platformMatch = true;\n    } else {\n      // When page is passed, determine if current page matches\n      const environmentPlatform = environment.platform;\n\n      if (Array.isArray(this.appFlagApplicationPlatform)) {\n        platformMatch = this.appFlagApplicationPlatform.some(platform => environmentPlatform.indexOf(platform) >= 0);\n      } else if (typeof this.appFlagApplicationPlatform === 'string') {\n        platformMatch = environmentPlatform.indexOf(this.appFlagApplicationPlatform) >= 0;\n      }\n    }\n\n    hasMatch = appMatch && pageMatch && platformMatch;\n\n    // Hide or show depending on exclusion mode\n    const include =\n      (hasMatch && this.appFlagApplicationMode === 'include') ||\n      !hasMatch && this.appFlagApplicationMode === 'exclude';\n\n    if (include) {\n      this.viewContainer.createEmbeddedView(this.templateRef);\n    } else {\n      this.viewContainer.clear();\n    }\n  }\n}\n","import { Directive, ElementRef, Renderer2, OnInit } from '@angular/core';\nimport { isIE11 } from '../detect-ie11';\n\n@Directive({ selector: '[appHideIE11]' })\nexport class IE11HideDirective implements OnInit {\n  constructor(public el: ElementRef, public renderer: Renderer2) {}\n\n  ngOnInit() {\n    if (isIE11()) {\n      this.renderer.setStyle(this.el.nativeElement, 'display', 'none');\n    }\n  }\n}\n","import { Directive, ElementRef, Renderer2, OnInit } from '@angular/core';\nimport { isIE11 } from '../detect-ie11';\n\n@Directive({ selector: '[appShowIE11]' })\nexport class IE11ShowDirective implements OnInit {\n  constructor(public el: ElementRef, public renderer: Renderer2) {}\n\n  ngOnInit() {\n    // detect ie11\n    if (!isIE11()) {\n      this.renderer.setStyle(this.el.nativeElement, 'display', 'none');\n    }\n  }\n}\n","import { Directive, ElementRef, HostListener } from '@angular/core';\n\n@Directive({\n  selector: '[appSelectOnFocus]'\n})\nexport class SelectOnFocusDirective {\n\n  constructor() { }\n\n  @HostListener('click', ['$event', '$event.target'])\n  onClick(event: MouseEvent, el: HTMLInputElement | HTMLTextAreaElement) {\n    el.select();\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { of } from 'rxjs';\n\nexport class ErrorMessage {\n  constructor(\n    public category: string,  // Uppercase undescore, e.g. LOGIN_ERROR\n    public message?: string,  // Short summary, e.g. `Http failure response for https://localhost:4200/ws/user/sign/in/google: 400 Bad Request`\n    public log?: string       // Long summary\n  ) { }\n}\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class ErrorLoggingService {\n  log: Record<string, boolean> = {};\n\n  constructor(private http: HttpClient) { }\n\n  logError(error: ErrorMessage, dedupe = false) {\n    const key = `${error.category}${error.message}`;\n\n    if (dedupe && this.log[key]) {\n      return of();\n    }\n    \n\n    this.log[key] = true;\n    return this.http.post(`/ws/human-error`, error);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { FatalErrorCategoryEnum, SceneJSFatalErrorModel } from './error/error.model';\nimport { WidgetFatalErrorCategoryEnum } from '../widget/models/widget-error-type.enum';\nimport { LocationStrategy } from '@angular/common';\nimport { Router } from '@angular/router';\nimport { ErrorMessage, ErrorLoggingService } from './error-logging.service';\nimport { environment } from 'src/environments/environment';\nimport { EnvironmentApplication } from 'src/environments/models/environment-application';\n\ndeclare const Human: any;\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class ErrorService {\n  constructor(\n    private locationStrategy: LocationStrategy,\n    private router: Router,\n    private errorLoggingService: ErrorLoggingService\n  ) {\n    \n    // init handling of fatal SceneJS errors\n    // pass SceneJS a callback to invoke when it detects a fatal error.\n    (window as any).SceneJS_error.setFatalErrorHandler(\n      this.handleSceneJSFatalErrors.bind(this)\n    );\n  }\n\n  handleSceneJSFatalErrors(errorDescriptor: SceneJSFatalErrorModel) {\n    // extract engine errors\n    const engineErrorLog = {\n      log: Human.log.messages.join('\\n'),\n      stack: errorDescriptor.stackTrace,\n      webglInfo: (window as any).SceneJS.WEBGL_INFO\n    };\n\n    // prep error message\n    const errorMessage: ErrorMessage = {\n      category: errorDescriptor.errorName,\n      log: JSON.stringify(engineErrorLog),\n      message: errorDescriptor.messageFromCaller\n    };\n\n    // log error\n    this.errorLoggingService\n      .logError(errorMessage, true)\n      .subscribe();\n\n    const errorBlob = btoa(JSON.stringify(errorDescriptor));\n    this.redirectToErrorPage(FatalErrorCategoryEnum.SceneJS, undefined, errorBlob);\n  }\n\n  redirectToErrorPage(\n    errorType: FatalErrorCategoryEnum | WidgetFatalErrorCategoryEnum,\n    errorCode?: string,\n    errorBlob?: string\n  ) {\n    // don't redirect to /error page if current route is /error\n    const url = this.router.url || '';\n    if (url.match('/error')) {\n      return;\n    }\n\n    const basePath = this.locationStrategy.getBaseHref();\n\n    const errorURL =\n      environment.application === EnvironmentApplication.Viewer\n        ? `${basePath}/error`\n        : `${basePath}/view/error`;\n\n    const urlTree = this.router.createUrlTree([errorURL], {\n      queryParams: {\n        errorType,\n        errorCode,\n        errorBlob,\n        errorUrl: this.router.url\n      }\n    });\n\n    const redirectPath = this.router.serializeUrl(urlTree);\n    window.location.href = redirectPath;\n  }\n\n}\n","import { FatalErrorReportModel } from './error.model';\n\nexport const defaultErrorReport: FatalErrorReportModel = {\n  title: `We're unable to find the page you're looking for.`,\n  description: `Please check your URL or return to our <a href=\"/\">homepage</a>.`\n};\n\nexport const defaultContentErrorReport: FatalErrorReportModel = {\n  title: `We're unable to find the model you're looking for.`,\n  description: `Please check your URL or visit the <a href=\"/\" target=\"_blank\">BioDigital Human</a> to see what's available in our 3D model library.`,\n};\n","export enum FatalErrorCategoryEnum {\n  Content = 'content',\n  SceneJS = 'scenejs'\n}\n\nexport interface FatalErrorReportModel {\n  title: string;\n  description: string;\n  canDownloadError?: boolean;\n  url?: string;\n}\n\nexport interface SceneJSFatalErrorModel {\n  code: number;\n  errorName: string;\n  messageFromCaller: string;\n  stackTrace: string;\n}\n\n\n","import { Injectable } from '@angular/core';\nimport { Observable, config } from 'rxjs';\nimport { Papa } from 'ngx-papaparse';\n\nexport class ExportFieldConfig {\n  label: string;\n  field: string;\n}\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class ExportService {\n  \n  constructor(private papa: Papa) { }\n\n  importCSV(csv: string): Observable<[string[]]> {\n    return new Observable<[string[]]>((observer) => {\n      const { data, errors } = this.papa.parse(csv);\n\n      if (errors.length) {\n        observer.error(errors);\n        observer.complete();\n      } else {\n        observer.next(data);\n        observer.complete();\n      }\n    });\n  }\n\n  exportCSV(rows: any[], columns: ExportFieldConfig[], includeHeader: boolean = true): Observable<string> {\n    const exportRows: any[] = [];\n\n    // #TODO: [AC] - ngx-papaparse wrapper doesn't support explicit header columns, manually build rows[]\n    // add header\n    if (includeHeader) {\n      exportRows.push(columns.map(c => c.label));\n    }\n\n    // add data rows\n    rows.forEach((row) => {\n      const dataRow = columns.map((col) => row[col.field]);\n      exportRows.push(dataRow);\n    });\n\n    return new Observable<string>((observer) => {\n      const csv = this.papa.unparse(exportRows, { quotes: true, header: false });\n      observer.next(csv);\n      observer.complete();\n    });\n  }\n}\n","<div class=\"popup\">\n    <ng-container [ngSwitch]=\"renderMethod\">\n\n        <div *ngSwitchCase=\"'text'\" [innerHTML]=\"content\"></div>\n        \n        <ng-container *ngSwitchCase=\"'template'\">\n            <ng-container *ngTemplateOutlet=\"content; context: context\"></ng-container>\n        </ng-container>\n        \n        <ng-container *ngSwitchCase=\"'component'\">\n            <ng-container *ngComponentOutlet=\"content\"></ng-container>\n        </ng-container>\n        \n    </ng-container>\n</div>","import { Component, OnInit, TemplateRef, ViewEncapsulation, ChangeDetectionStrategy } from '@angular/core';\nimport { PopupRef, PopupContent } from '../../popup/popup.ref';\n\n@Component({\n  selector: 'app-popup',\n  templateUrl: './popup.component.html',\n  styleUrls: ['./popup.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class PopupComponent implements OnInit {\n  renderMethod: 'template' | 'component' | 'text' = 'component';\n  content: PopupContent;\n  context: any;\n\n  constructor(\n    private popupRef: PopupRef\n  ) { }\n\n  ngOnInit() {\n    this.content = this.popupRef.content;\n    \n    if (typeof this.content === 'string') {\n      this.renderMethod = 'text';\n    } else if (this.content instanceof TemplateRef) {\n      this.renderMethod = 'template';\n      this.context = {\n        close: this.popupRef.close.bind(this.popupRef)\n      };\n    }\n  }\n}\n","<div class=\"notification\" *ngIf=\"notification\" @show>\n    <div class=\"flex\">\n        <div class=\"notification__body flex-grow\">\n            {{ notification.body}}\n        </div>\n\n        <button class=\"notification__button notification__button--close\" type=\"button\" (click)=\"handleCloseClick($event)\">\n            <app-icon icon=\"times\"></app-icon>\n        </button>\n    </div>\n    \n    <button\n        class=\"notification__button notification__button--full\"\n        type=\"button\"\n        *ngIf=\"notification.action\"\n        (click)=\"handleActionClick($event)\">\n        {{ notification.action }}\n    </button>\n</div>\n","import { transition, trigger, useAnimation } from '@angular/animations';\nimport { ChangeDetectionStrategy, Component, ComponentFactoryResolver, EventEmitter, Input, OnInit, Output, ViewChild, ViewEncapsulation } from '@angular/core';\nimport { AnimationLib } from 'src/app/shared/libraries/animations/animation-lib';\nimport { NotificationModel } from '../../notification.model';\n\n@Component({\n  selector: 'app-notification',\n  templateUrl: './notification.component.html',\n  styleUrls: ['./notification.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None,\n  animations: [\n    trigger('show', [\n      transition(':enter', [\n        useAnimation(AnimationLib.fadeIn, {\n          params: {\n            duration: 300\n          }\n        })\n      ])\n    ])\n  ]\n})\nexport class NotificationComponent implements OnInit {\n  \n  \n  @Input()\n  notification: NotificationModel;\n\n  @Output()\n  closeClick = new EventEmitter<{ action: string, data: any}>();\n\n  constructor(\n  ) { }\n\n  ngOnInit() {\n    \n  }\n\n  handleActionClick() {\n    this.close(this.notification.action);\n  }\n\n  handleCloseClick() {\n    this.close();\n  }\n\n  private close(action: string = '') {\n    this.notification = null;\n    this.closeClick.emit({\n      action: action,\n      data: this.notification\n    });\n  }\n}\n","export class NotificationModel {\n    constructor(\n        public body = '',\n        public action = ''\n    ) { }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { NotificationComponent } from './components/notification/notification.component';\nimport { IconModule } from '../../components/icon/icon.module';\n\n\n@NgModule({\n  declarations: [\n    NotificationComponent\n  ],\n  imports: [\n    CommonModule,\n    IconModule\n  ],\n  exports: [\n    NotificationComponent\n  ]\n})\nexport class NotificationModule { }\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { PopupComponent } from '../components/popup/popup.component';\n\n\n\n@NgModule({\n  declarations: [\n  ],\n  imports: [\n    CommonModule\n  ],\n  entryComponents: [\n    PopupComponent\n  ]\n})\nexport class PopupModule { }\n","import { TemplateRef, Type } from '@angular/core';\nimport { Subject } from 'rxjs';\nimport { OverlayRef } from '@angular/cdk/overlay';\n\nexport interface PopupCloseEvent<T> {\n    type: 'backdropClick' | 'close';\n    data: T;\n}\n   \nexport type PopupContent = TemplateRef<any> | Type<any> | string;\n   \nexport class PopupRef<T = any> {\n    private afterClosed = new Subject<PopupCloseEvent<T>>();\n    afterClosed$ = this.afterClosed.asObservable();\n\n    constructor(\n        public overlay: OverlayRef, \n        public content: PopupContent, \n        public data: T\n    ) {\n        overlay.backdropClick().subscribe(() => this._close('backdropClick', data));\n    }\n\n    close(data?: T) {\n        this._close('close', data);\n    }\n\n    private _close(type, data) {\n        this.overlay.dispose();\n        this.afterClosed.next({\n            type,\n            data\n        });\n        this.afterClosed.complete();\n    }\n}\n","/**\n * Reference: https://netbasal.com/creating-powerful-components-with-angular-cdk-2cef53d81cea\n */\n\nimport { Injectable, Injector } from '@angular/core';\nimport { PositionStrategy, ConnectionPositionPair, Overlay, OverlayConfig } from '@angular/cdk/overlay';\nimport { PopupContent, PopupRef } from './popup.ref';\nimport { PortalInjector, ComponentPortal } from '@angular/cdk/portal';\nimport { PopupComponent } from '../components/popup/popup.component';\n\n\nexport enum PopupPosition {\n  Above = 'above',\n  Below = 'below',\n  Left = 'left',\n  Right = 'right'\n}\n\nconst positionPairs: { [key: string]: ConnectionPositionPair} = {\n  [PopupPosition.Above]: {\n    originX : 'center',\n    originY : 'top',\n    overlayX: 'center',\n    overlayY: 'bottom',\n    offsetY: -12\n  },\n  [PopupPosition.Below]: {\n    originX : 'center',\n    originY : 'bottom',\n    overlayX: 'center',\n    overlayY: 'top',\n    offsetY: 12\n  },\n  [PopupPosition.Left]: {\n    originX : 'start',\n    originY : 'center',\n    overlayX: 'end',\n    overlayY: 'center',\n    offsetX: -12\n  },\n  [PopupPosition.Right]: {\n    originX : 'end',\n    originY : 'center',\n    overlayX: 'start',\n    overlayY: 'center',\n    offsetX: 12\n  }\n};\n\nexport interface PopupParams<T> {\n  origin: HTMLElement;\n  content: PopupContent;\n  data?: T;\n  width?: string | number;\n  height?: string | number;\n }\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class PopupService {\n  \n  constructor(\n    private overlay: Overlay,\n    private injector: Injector\n    ) { }\n  \n\n  open<T>({ origin, content, data, width, height }: PopupParams<T>): PopupRef<T> {\n    const overlayRef = this.overlay.create(this.getOverlayConfig({origin, width, height}));\n\n    const popupRef = new PopupRef<T>(overlayRef, content, data);\n    const injector = this.createInjector(popupRef, this.injector);\n\n    overlayRef.attach(new ComponentPortal(PopupComponent, null, injector));\n\n    return popupRef;\n  }\n\n  createInjector(popupRef: PopupRef, injector: Injector) {\n    const tokens = new WeakMap([[PopupRef, popupRef]]);\n    return new PortalInjector(injector, tokens);\n  }\n\n  getPositionStrategy(origin: HTMLElement, popupPositions: PopupPosition[]): PositionStrategy {\n    return this.overlay\n      .position()\n      .flexibleConnectedTo(origin)\n      .withPositions(this.getPositions(popupPositions));\n  }\n\n  private getOverlayConfig({ origin, width, height }): OverlayConfig {\n    return new OverlayConfig({\n      width,\n      height,\n      hasBackdrop: true,\n      backdropClass: 'popup-scrim',\n      positionStrategy: this.getOverlayPosition(origin),\n      scrollStrategy: this.overlay.scrollStrategies.reposition()\n    });\n  }\n\n  private getOverlayPosition(origin: HTMLElement, positions?: PopupPosition[]): PositionStrategy {\n    positions = positions || [PopupPosition.Above, PopupPosition.Below, PopupPosition.Left, PopupPosition.Right];\n\n    const positionStrategy = this.overlay.position()\n      .flexibleConnectedTo(origin)\n      .withPositions(this.getPositions(positions))\n      .withPush(true);\n   \n    return positionStrategy;\n   }\n   \n\n  private getPositions(popupPositions: PopupPosition[]): ConnectionPositionPair[] {\n    return popupPositions.map(position => {\n      return positionPairs[position];\n    });\n  }\n}\n","import { SiteCategory } from '../models/site-category.model';\n\nexport const siteNavigation: { [key: string]: SiteCategory[] } = {\n  main: [{\n    'title': 'All Models',\n    'id': 'all',\n    'type': 'Category',\n    'translations': {\n      'es': {\n        'title': 'Todas las Categoras'\n      },\n      'zh': {\n        'title': ''\n      },\n      'fr': {\n        'title': 'Toutes les catgories'\n      },\n      'de': {\n        'title': 'Alle Kategorien'\n      },\n      'it': {\n        'title': 'Tutte le categorie'\n      },\n      'ja': {\n        'title': ''\n      },\n      'pt': {\n        'title': 'Todas as categorias'\n      }\n    }\n  }],\n  categories: [\n    {\n      'title': 'Anatomy by Regions',\n      'id': 'regional',\n      'type': 'Category',\n      'translations': {\n        'es': {\n          'title': 'Anatoma por Regiones'\n        },\n        'zh': {\n          'title': ''\n        },\n        'fr': {\n          'title': 'Anatomie par rgions'\n        },\n        'de': {\n          'title': 'Anatomie nach Regionen'\n        },\n        'it': {\n          'title': 'Anatomia per regioni'\n        },\n        'ja': {\n          'title': ''\n        },\n        'pt': {\n          'title': 'Anatomia por Regies'\n        }\n      }\n    },\n    {\n      'title': 'Anatomy by Systems',\n      'id': 'system',\n      'type': 'Category',\n      'translations': {\n        'es': {\n          'title': 'Anatoma por Sistemas'\n        },\n        'zh': {\n          'title': ''\n        },\n        'fr': {\n          'title': 'Anatomie par systmes'\n        },\n        'de': {\n          'title': 'Anatomie nach Systemen'\n        },\n        'it': {\n          'title': 'Anatomia per sistemi'\n        },\n        'ja': {\n          'title': ''\n        },\n        'pt': {\n          'title': 'Anatomia por Sistemas'\n        }\n      }\n    },\n    {\n      'title': 'Complete Anatomy',\n      'id': 'complete anatomy',\n      'type': 'Category',\n      'translations': {\n        'de': {\n          'title': 'Komplette Anatomie'\n        },\n        'es': {\n          'title': 'Anatoma completa'\n        },\n        'fr': {\n          'title': 'Anatomie complte'\n        },\n        'it': {\n          'title': 'Anatomia completa'\n        },\n        'ja': {\n          'title': ''\n        },\n        'pt': {\n          'title': 'Anatomia Completa'\n        },\n        'zh': {\n          'title': ''\n        }\n      }\n    },\n    {\n      'title': 'Cross Sections & Micro Anatomy',\n      'id': 'Cross Section and Micro Anatomy',\n      'type': 'Category',\n      'translations': {\n        'de': {\n          'title': 'Querschnitte & Mikro-Anatomie'\n        },\n        'es': {\n            'title': 'Secciones transversales y Micro Anatoma'\n        },\n        'fr': {\n            'title': 'Sections transversales et micro anatomie'\n        },\n        'it': {\n            'title': 'Sezioni trasversali & Micro Anatomia'\n        },\n        'ja': {\n            'title': ''\n        },\n        'pt': {\n            'title': 'Sees Transversais e Micro Anatomia'\n        },\n        'zh': {\n            'title': ''\n        }\n      }\n    },\n  ],\n  specialties: [\n    {\n      'title': 'Allergy & Immunology',\n      'id': 'Allergy and Immunology',\n      'type': 'Category',\n      'translations': {\n        'de': {\n          'title': 'Allergie und Immunologie'\n        },\n        'es': {\n          'title': 'Alergia e Inmunologa'\n        },\n        'fr': {\n          'title': 'Allergie et Immunologie'\n        },\n        'it': {\n          'title': 'Allergia e Immunologia'\n        },\n        'ja': {\n          'title': ''\n        },\n        'pt': {\n          'title': 'Alergia e Imunologia'\n        },\n        'zh': {\n          'title': ''\n        }\n      }\n    },\n    {\n      'title': 'Cardiology',\n      'id': 'Cardiology',\n      'type': 'Category',\n      'translations': {\n        'de': {\n          'title': 'Kardiologie'\n        },\n        'es': {\n          'title': 'Cardiologa'\n        },\n        'fr': {\n          'title': 'Cardiologie'\n        },\n        'it': {\n          'title': 'Cardiologia'\n        },\n        'ja': {\n          'title': ''\n        },\n        'pt': {\n          'title': 'Cardiologia'\n        },\n        'zh': {\n          'title': ''\n        }\n      }\n    },\n    {\n      'title': 'Dentistry',\n      'id': 'Dentistry',\n      'type': 'Category',\n      'translations': {\n        'de': {\n          'title': 'Zahnmedizin'\n        },\n        'es': {\n          'title': 'Odontologa'\n        },\n        'fr': {\n          'title': 'Dentisterie'\n        },\n        'it': {\n          'title': 'Odontoiatria'\n        },\n        'ja': {\n          'title': ''\n        },\n        'pt': {\n          'title': 'Odontologia'\n        },\n        'zh': {\n          'title': ''\n        }\n      }\n    },\n    {\n      'title': 'Dermatology',\n      'id': 'Dermatology',\n      'type': 'Category',\n      'translations': {\n        'de': {\n          'title': 'Dermatologie'\n        },\n        'es': {\n          'title': 'Dermatologa'\n        },\n        'fr': {\n          'title': 'Dermatologie'\n        },\n        'it': {\n          'title': 'Dermatologia'\n        },\n        'ja': {\n          'title': ''\n        },\n        'pt': {\n          'title': 'Dermatologia'\n        },\n        'zh': {\n          'title': ''\n        }\n      }\n    },\n    {\n      'title': 'Endocrinology',\n      'id': 'Endocrinology',\n      'type': 'Category',\n      'translations': {\n        'de': {\n          'title': 'Endokrinologie'\n        },\n        'es': {\n          'title': 'Endocrinologa'\n        },\n        'fr': {\n          'title': 'Endocrinologie'\n        },\n        'it': {\n          'title': 'Endocrinologia'\n        },\n        'ja': {\n          'title': ''\n        },\n        'pt': {\n          'title': 'Endocrinologia'\n        },\n        'zh': {\n          'title': ''\n        }\n      }\n    },\n    {\n      'title': 'Gastroenterology & Hepatology',\n      'id': 'Gastroenterology and Hepatology',\n      'type': 'Category',\n      'translations': {\n        'de': {\n          'title': 'Gastroenterologie & Hepatologie'\n        },\n        'es': {\n          'title': 'Gastroenterologa y Hepatologa'\n        },\n        'fr': {\n          'title': 'Gastroentrologie & Hpatologie'\n        },\n        'it': {\n          'title': 'Gastroenterologia & Epatologia'\n        },\n        'ja': {\n          'title': ''\n        },\n        'pt': {\n          'title': 'Gastroenterologia e Hepatologia'\n        },\n        'zh': {\n          'title': ''\n        }\n      }\n    },\n    {\n      'title': 'Infectious Disease',\n      'id': 'Infectious Disease',\n      'type': 'Category',\n      'translations': {\n        'de': {\n          'title': 'Infektionskrankheit'\n        },\n        'es': {\n          'title': 'Enfermedades Infecciosas'\n        },\n        'fr': {\n          'title': 'Maladies infectieuses'\n        },\n        'it': {\n          'title': 'Malattie Infettive'\n        },\n        'ja': {\n          'title': ''\n        },\n        'pt': {\n          'title': 'Doena Infecciosa'\n        },\n        'zh': {\n          'title': ''\n        }\n      }\n    },\n    {\n      'title': 'Nephrology',\n      'id': 'Nephrology',\n      'type': 'Category',\n      'translations': {\n        'de': {\n          'title': 'Nephrologie'\n        },\n        'es': {\n          'title': 'Nefrologa'\n        },\n        'fr': {\n          'title': 'Nphrologie'\n        },\n        'it': {\n          'title': 'Nefrologia'\n        },\n        'ja': {\n          'title': ''\n        },\n        'pt': {\n          'title': 'Nefrologia'\n        },\n        'zh': {\n          'title': ''\n        }\n      }\n    },\n    {\n      'title': 'Neurology & Psychiatry',\n      'id': 'Neurology and Psychiatry',\n      'type': 'Category',\n      'translations': {\n        'de': {\n          'title': 'Neurologie & Psychiatrie'\n        },\n        'es': {\n          'title': 'Neurologa y Psiquiatra'\n        },\n        'fr': {\n          'title': 'Neurologie & Psychiatrie'\n        },\n        'it': {\n          'title': 'Neurologia & Psichiatria'\n        },\n        'ja': {\n          'title': ''\n        },\n        'pt': {\n          'title': 'Neurologia e Psiquiatria'\n        },\n        'zh': {\n          'title': ''\n        }\n      }\n    },\n    {\n      'title': 'Obstetrics & Gynecology',\n      'id': 'Obstetrics and Gynecology',\n      'type': 'Category',\n      'translations': {\n        'de': {\n          'title': 'Geburtshilfe & Gynkologie'\n        },\n        'es': {\n          'title': 'Obstetricia y Ginecologa'\n        },\n        'fr': {\n          'title': 'Obsttrique et gyncologie'\n        },\n        'it': {\n          'title': 'Ostetricia & Ginecologia'\n        },\n        'ja': {\n          'title': ''\n        },\n        'pt': {\n          'title': 'Obstetrcia e Ginecologia'\n        },\n        'zh': {\n          'title': ''\n        }\n      }\n    },\n    {\n      'title': 'Oncology & Hematology',\n      'id': 'Oncology and Hematology',\n      'type': 'Category',\n      'translations': {\n        'de': {\n          'title': 'Onkologie/Hmatologie'\n        },\n        'es': {\n          'title': 'Oncologa/Hematologa'\n        },\n        'fr': {\n          'title': 'Oncologie/Hmatologie'\n        },\n        'it': {\n          'title': 'Oncologia/Ematologia'\n        },\n        'ja': {\n          'title': ''\n        },\n        'pt': {\n          'title': 'Oncologia/Hematologia'\n        },\n        'zh': {\n          'title': '/'\n        }\n      }\n    },\n    {\n      'title': 'Ophthalmology',\n      'id': 'Ophthalmology',\n      'type': 'Category',\n      'translations': {\n        'de': {\n          'title': 'Ophthalmologie'\n        },\n        'es': {\n          'title': 'Oftalmologa'\n        },\n        'fr': {\n          'title': 'Ophtalmologie'\n        },\n        'it': {\n          'title': 'Oftalmologia'\n        },\n        'ja': {\n          'title': ''\n        },\n        'pt': {\n          'title': 'Oftalmologia'\n        },\n        'zh': {\n          'title': ''\n        }\n      }\n    },\n    {\n      'title': 'Orthopedics',\n      'id': 'Orthopedics',\n      'type': 'Category',\n      'translations': {\n        'de': {\n          'title': 'Orthopdie'\n        },\n        'es': {\n          'title': 'Ortopedia'\n        },\n        'fr': {\n          'title': 'Orthopdie'\n        },\n        'it': {\n          'title': 'Ortopedia'\n        },\n        'ja': {\n          'title': ''\n        },\n        'pt': {\n          'title': 'Ortopedia'\n        },\n        'zh': {\n          'title': ''\n        }\n      }\n    },\n    {\n      'title': 'Otolaryngology',\n      'id': 'Otolaryngology',\n      'type': 'Category',\n      'translations': {\n        'de': {\n          'title': 'HNO-Heilkunde'\n        },\n        'es': {\n          'title': 'Otorrinolaringologa'\n        },\n        'fr': {\n          'title': 'Otorhinolaryngologie'\n        },\n        'it': {\n          'title': 'Otorinolaringoiatria'\n        },\n        'ja': {\n          'title': ''\n        },\n        'pt': {\n          'title': 'Otorrinolaringologia'\n        },\n        'zh': {\n          'title': ''\n        }\n      }\n    },\n    {\n      'title': 'Pediatrics',\n      'id': 'Pediatrics',\n      'type': 'Category',\n      'translations': {\n        'de': {\n          'title': 'Pdiatrie'\n        },\n        'es': {\n          'title': 'Pediatra'\n        },\n        'fr': {\n          'title': 'Pdiatrie'\n        },\n        'it': {\n          'title': 'Pediatria'\n        },\n        'ja': {\n          'title': ''\n        },\n        'pt': {\n          'title': 'Pediatria'\n        },\n        'zh': {\n          'title': ''\n        }\n      }\n    },\n    {\n      'title': 'Pulmonology & Respiratory',\n      'id': 'Pulmonology and Respiratory',\n      'type': 'Category',\n      'translations': {\n        'de': {\n          'title': 'Pulmonologie/Atmungsorgane'\n        },\n        'es': {\n          'title': 'Neumologa/Respiratorio'\n        },\n        'fr': {\n          'title': 'Pneumologie/Respiratoire'\n        },\n        'it': {\n          'title': 'Pneumologia/Respiratorio'\n        },\n        'ja': {\n          'title': '/'\n        },\n        'pt': {\n          'title': 'Pneumologia/Respiratria'\n        },\n        'zh': {\n          'title': '/'\n        }\n      }\n    },\n    {\n      'title': 'Rheumatology',\n      'id': 'Rheumatology',\n      'type': 'Category',\n      'translations': {\n        'de': {\n          'title': 'Rheumatologie'\n        },\n        'es': {\n          'title': 'Reumatologa'\n        },\n        'fr': {\n          'title': 'Rhumatologie'\n        },\n        'it': {\n          'title': 'Reumatologia'\n        },\n        'ja': {\n          'title': ''\n        },\n        'pt': {\n          'title': 'Reumatologia'\n        },\n        'zh': {\n          'title': ''\n        }\n      }\n    },\n    {\n      'title': 'Urology',\n      'id': 'Urology',\n      'type': 'Category',\n      'translations': {\n        'de': {\n          'title': 'Urologie'\n        },\n        'es': {\n          'title': 'Urologa'\n        },\n        'fr': {\n          'title': 'Urologie'\n        },\n        'it': {\n          'title': 'Urologia'\n        },\n        'ja': {\n          'title': ''\n        },\n        'pt': {\n          'title': 'Urologia'\n        },\n        'zh': {\n          'title': ''\n        }\n      }\n    },\n    {\n      'title': 'Community Bookmarks',\n      'id': 'public',\n      'type': 'Community',\n      'translations': {\n        'de': {\n          'title': 'Community-Lesezeichen'\n        },\n        'es': {\n          'title': 'Marcadores de la comunidad'\n        },\n        'fr': {\n          'title': 'Signets communautaires'\n        },\n        'it': {\n          'title': 'Segnalibri della community'\n        },\n        'ja': {\n          'title': ''\n        },\n        'pt': {\n          'title': 'Favoritos da comunidade'\n        },\n        'zh': {\n          'title': ''\n        }\n      }\n    }\n  ]\n};\n","import { SiteCategory } from './models/site-category.model';\nimport { get } from 'lodash';\nimport { siteNavigation } from './data/site-navigation';\nimport { BookmarkModel } from 'src/app/bookmarks/models/bookmark.model';\n\nexport function getAllCategories(): SiteCategory[] {\n  return [\n    ...siteNavigation.main,\n    ...siteNavigation.categories,\n    ...siteNavigation.specialties\n  ];\n}\n\nexport function translateCategories(categories: SiteCategory[], lang?: string) {\n  return categories.map(value => {\n    const category: SiteCategory = {\n      id: value.id,\n      title: value.title,\n      type: value.type\n    };\n\n    if (lang) {\n      category.title = get(value, `translations.${lang}.title`, category.title);\n    }\n\n    return category;\n  });\n}\n\nexport function getCategory(categoryId: string, language?: string) {\n  if (categoryId == null) {\n    return null;\n  }\n  \n  const category = getAllCategories().find(value => value.id === categoryId);\n\n  if (category == null) {\n    return null;\n  }\n\n  if (language) {\n    category.title = get(category, `translations.${language}.title`, category.title);\n  }\n\n  return category;\n}\n\nexport function getBookmarkSpecialty(bookmark: BookmarkModel) {\n  return siteNavigation.specialties.find(specialty => {\n    return bookmark.tags.some(tag => tag === specialty.id);\n  });\n}\n\nexport function getBookmarkCategory(bookmark: BookmarkModel) {\n  return siteNavigation.categories.find(cateogry => {\n    return bookmark.tags.some(tag => tag === cateogry.id);\n  });\n}\n","export abstract class ZendeskModel {\n  abstract accountUrl: string;\n  abstract beforePageLoad(zE): any;\n}\n","import { NgModule, ModuleWithProviders, Type } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { ZendeskModel } from './zendesk.model';\nimport { ZendeskService } from './zendesk.service';\n\n@NgModule({\n  imports: [\n    CommonModule\n  ]\n})\nexport class ZendeskModule {\n  static forRoot(zendeskConfig: Type<ZendeskModel>): ModuleWithProviders {\n    return {\n      ngModule: ZendeskModule,\n      providers: [\n        {provide: zendeskConfig, useClass: zendeskConfig },\n        {provide: ZendeskService, useClass: ZendeskService, deps: [zendeskConfig] }\n      ]\n    };\n  }\n}\n\nexport {\n    ZendeskService,\n    ZendeskModel\n};\n","// tslint:disable\nimport { ZendeskModel } from './zendesk.model';\nimport { Injectable } from '@angular/core';\n\nfunction getWindow(): any {\n  return window;\n}\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class ZendeskService {\n  private window;\n\n  constructor(zendeskConfig?: ZendeskModel) {\n    if (!zendeskConfig.accountUrl) {\n      throw new Error('Missing accountUrl. Please set in app config via ZendeskWidgetProvider');\n    }\n\n    this.window = getWindow();\n\n    let window = this.window\n    // Following is essentially a copy paste of JS portion of the Zendesk embed code\n    // with our settings subbed in. For more info, see:\n    // https://support.zendesk.com/hc/en-us/articles/203908456-Using-Web-Widget-to-embed-customer-service-in-your-website\n\n    \n    window.zEmbed || function(e, t) {\n      var n, o, d, i, s, a = [],\n      r = document.createElement(\"iframe\");\n      window.zEmbed = function() {\n        a.push(arguments)\n      }, window.zE = window.zE || window.zEmbed,\n      r.src = \"javascript:false\",\n      r.title = \"\",\n      r.style.cssText = \"display: none\",\n      d = document.getElementsByTagName(\"script\"),\n      d = d[d.length - 1],\n      d.parentNode.insertBefore(r, d),\n      i = r.contentWindow,\n      s = i.document;\n      try {\n        o = s\n      } catch (e) {\n        n = document.domain, r.src = 'javascript:var d=document.open();d.domain=\"' + n + '\";void(0);',\n        o = s\n      }\n      o.open()._l = function() {\n        var e = this.createElement(\"script\");\n        n && (this.domain = n),\n        e.id = \"js-iframe-async\",\n        e.src = \"https://assets.zendesk.com/embeddable_framework/main.js\",\n        this.t=+new Date,\n        this.zendeskHost = zendeskConfig.accountUrl,\n        this.zEQueue=a,\n        this.body.appendChild(e)\n      },\n      o.write('<body onload=\"document._l();\">'),\n      o.close()\n    }();\n\n    this.window.zE(() => {\n        zendeskConfig.beforePageLoad(this.window.zE)\n      }\n    )\n  }\n\n  public setLocale(locale) {\n    this.window.zE(() => {\n      this.window.zE.setLocale(locale)\n    })\n  }\n\n  public identify(userObj) {\n    this.window.zE(() => {\n      this.window.zE.identify(userObj)\n    })\n  }\n\n  public hide() {\n    this.window.zE(() => {\n      this.window.zE.hide()\n    })\n  }\n\n  public show() {\n    this.window.zE(() => {\n      this.window.zE.show()\n    })\n  }\n\n  public activate(options?) {\n    this.window.zE(() => {\n      this.window.zE.activate(options)\n    })\n  }\n\n  public setHelpCenterSuggestions(options) {\n    this.window.zE(() => {\n      this.window.zE.setHelpCenterSuggestions(options)\n    })\n  }\n\n  public setSettings(settings) {\n    this.window.zESettings = settings\n  }\n\n}\n","<div class=\"html\" [innerHTML]=\"safeHTML\"></div>","import { Component, OnInit, ChangeDetectionStrategy, ViewEncapsulation, Input } from '@angular/core';\nimport { DomSanitizer, SafeHtml } from '@angular/platform-browser';\nimport { MarkdownService } from 'ngx-markdown';\n\n@Component({\n  selector: 'app-html',\n  templateUrl: './html.component.html',\n  styleUrls: ['./html.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None\n})\nexport class HtmlComponent implements OnInit {\n\n  @Input()\n  set html(input: string) {\n    this.safeHTML = this.domSanitizer.bypassSecurityTrustHtml(input || '');\n  }\n\n  @Input()\n  set markdownText(input: string) {\n    this.html = this.markdownService.compile(input, true);\n  }\n  \n  safeHTML: SafeHtml;\n\n  constructor(private domSanitizer: DomSanitizer, private markdownService: MarkdownService) { }\n\n  ngOnInit() {\n  }\n\n}\n","import { Injectable } from '@angular/core';\nimport { Observable, from } from 'rxjs';\nimport html2canvas from 'html2canvas';\nimport { ScreenDimensions } from './models/screen.dimensions.model';\n\n// HTMLCanvas toBlob pollyfill: for IE/Edge\nimport 'blueimp-canvas-to-blob';\n\nexport enum ImageTypeEnum {\n  JPEG = 'image/jpeg',\n  PNG = 'image/png'\n}\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class ImageService {\n\n  constructor() { }\n\n  canvasToBlob(canvas: HTMLCanvasElement, contentType: ImageTypeEnum, quality: number): Observable<Blob> {\n    return new Observable((observer) => {\n      canvas.toBlob((blob) => {\n        observer.next(blob);\n        observer.complete();\n      }, contentType, quality);\n    });\n  }\n\n\n  fitCanvas(canvas: HTMLCanvasElement, { width, height }: ScreenDimensions): Observable<HTMLCanvasElement> {\n    const thumbnailCanvas = document.createElement('canvas');\n    thumbnailCanvas.width = width;\n    thumbnailCanvas.height = height;\n    \n    const thumbnailContext = thumbnailCanvas.getContext('2d');\n\n    // calculate source width and height dimensions\n    const thumbanilAspect = thumbnailCanvas.width / thumbnailCanvas.height;\n    const sourceHeight = canvas.height;\n    const sourceWidth = thumbanilAspect * sourceHeight;\n\n    // calculate source offset: clamp to 0 (fixes IE11 issue w/ negative offsets)\n    const offsetX = Math.max(\n      0.5 * (canvas.width - sourceWidth),\n      0);\n\n    // render 3D frame and transfer to thumbnail canvas\n    return new Observable((observer) => {\n      thumbnailContext.drawImage(canvas, offsetX, 0, thumbnailCanvas.width, thumbnailCanvas.height);\n      observer.next(thumbnailCanvas);\n      observer.complete();\n    });\n  }\n\n  elementToCanvas(element: HTMLElement, transparent = false): Observable<HTMLCanvasElement> {\n    const options = transparent ? { backgroundColor: 'transparent' } : {};\n    return from(html2canvas(element, options));\n  }\n\n  combineCanvasElements(canvasElements: HTMLCanvasElement[]): HTMLCanvasElement {\n    // calculate max bounds\n    const width = Math.max(0, ...canvasElements.map((canvas) => canvas.width));\n    const height = Math.max(0, ...canvasElements.map((canvas) => canvas.height));\n\n    const targetCanvas = document.createElement('canvas');\n    targetCanvas.width = width;\n    targetCanvas.height = height;\n\n    // get 2D context for painting each image\n    const targetContext = targetCanvas.getContext('2d');\n\n    // paint each canvas to top left, ordered\n    canvasElements.forEach((canvas) => {\n      targetContext.drawImage(canvas, 0, 0);\n    });\n\n    return targetCanvas;\n  }\n\n  base64ToBlob(imageData: string, contentType: ImageTypeEnum): Blob {\n    const byteString = atob(imageData.split(',')[1]);\n    const ab = new ArrayBuffer(byteString.length);\n    const ia = new Uint8Array(ab);\n    for (let i = 0; i < byteString.length; i++) {\n      ia[i] = byteString.charCodeAt(i);\n    }\n    return new Blob([ab], { type: contentType });\n  }\n\n  blobToBase64(blob: Blob): Observable<string> {\n    return new Observable((observer) => {\n      const reader = new FileReader();\n      reader.addEventListener('load', () => {\n        observer.next(<string>reader.result);\n        observer.complete();\n      });\n      reader.readAsDataURL(blob);\n    });\n  }\n\n  blobToCanvas(blob: Blob, { width, height }: ScreenDimensions): Observable<HTMLCanvasElement> {\n    return new Observable((observer) => {\n      const canvas = document.createElement('canvas');\n      canvas.width = width;\n      canvas.height = height;\n      const context = canvas.getContext('2d');\n      const img = new Image();\n      img.addEventListener('load', () => {\n        context.drawImage(img, 0, 0);\n        observer.next(canvas);\n        observer.complete();\n      });\n      img.src = URL.createObjectURL(blob);\n    });\n  }\n}\n","import { vec3, vec4 } from 'gl-matrix';\n\n\nexport namespace _3DUtils {\n  // ported from human.engine\n  // src/rpc/procedures/deprecated.js Line 294\n  export function getCanvasPos(\n    Human: any,\n    worldPos: [number, number, number],\n    offset: [number, number, number],\n    canvasWidth: number,\n    canvasHeight: number\n  ): [number, number] {\n    if (offset) {\n      vec3.add(worldPos as any, offset, worldPos);\n    }\n\n    const viewMat = Human.renderer.getViewMat();\n    const projMat = Human.renderer.getProjMat();\n    const projPos = vec4.create();\n\n    vec3.transformMat4(projPos as any, worldPos, viewMat);\n    projPos[3] = 1; // Need homogeneous 'w' for perspective division\n    vec4.transformMat4(projPos, projPos, projMat);\n\n    const x = projPos[0];\n    const y = projPos[1];\n    const w = projPos[3];\n\n    return [\n      Math.round(((1 + x / w) * canvasWidth) / 2),\n      Math.round(((1 - y / w) * canvasHeight) / 2)\n    ];\n  }\n}\n","import { animation, animate, style } from '@angular/animations';\n\nexport namespace AnimationLib {\n\n  export const slideTransition = animation([\n    style({\n      transform: `translateY({{ from }}%)`,\n      opacity: 0\n    }),\n    animate(`{{ duration }}ms ease-out`, style({\n      transform: `translateY({{ to }})`,\n      opacity: 1\n    }))\n  ]);\n\n  export const fadeIn = animation([\n    style({\n      opacity: 0\n    }),\n    animate(`{{ duration }}ms ease-out`, style({\n      opacity: 1\n    }))\n  ]);\n\n  export const fadeOut = animation([\n    style({\n      opacity: '*'\n    }),\n    animate(`{{ duration }}ms ease-in`, style({\n      opacity: 0\n    }))\n  ]);\n}\n","\nexport namespace ColorUtils {\n  const HEX_EXP = /^#[0-9a-f]{3,6}$/i;\n\n  // 3 - 16 comma separated numbers\n  const CSV_EXP = /(\\s*[\\d\\.]+\\s*,){2,15}\\s*[\\d\\.]+\\s*/g;\n\n  class ColorModel {\n    '1': [number, number, number, number];\n    '255': [number, number, number, number];\n  }\n\n  export function is255(channels: any[]): boolean {\n    for (let i = 0; i < 3; i++) {\n      const channelValue = `${channels[i]}`;\n      if (parseFloat(channelValue) > 1) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  export function isLight(outerRGB: [number, number, number], innerRGB?: [number, number, number]) {\n    if (!innerRGB) {\n      innerRGB = [...outerRGB] as [number, number, number];\n    }\n\n    // Convert RGB to HSP (Hue, Saturation, \"Perceived Lightness\"), a reliable metric for 'lightness'\n    // Support outer and inner to account for gradients\n    const outerHSP = rgbToHSP(outerRGB);\n    const innerHSP = rgbToHSP(innerRGB);\n    const hsp = (outerHSP + innerHSP) / 2;\n\n    // 60% or below is considered 'dark'\n    // 255 * 0.55 = 140.25\n    return (hsp > 140.25);\n  }\n\n  export function getComputedColor(input: string): string {\n    const el = document.createElement('div');\n    el.style.backgroundColor = input;\n    document.documentElement.appendChild(el);\n    const computedColor = window.getComputedStyle(el).backgroundColor.replace(/\\s/g, '');\n    window.document.documentElement.removeChild(el);\n    return computedColor;\n  }\n\n  export function convertChannels(input: any[]): any[] {\n    const channels = input.slice(0, 4);\n\n    if (channels.length === 3) {\n      channels.push(1);\n    }\n\n    for (let i = 0; i < 4; i++) {\n      const channelValue = `${channels[i]}`;\n      channels[i] = parseFloat(channelValue);\n\n      if (channels[i] < 0) {\n        channels[i] = 0;\n      }\n\n      if (channels[i] > 255) {\n        channels[i] = 255;\n      }\n    }\n\n    if (channels[3] > 1) {\n      channels[3] = 1;\n    }\n\n    return channels;\n  }\n\n  // Convert a single color\n  export function convert(input: any): any[] {\n    let color: any[];\n\n    if (Array.isArray(input)) {\n      color = convertChannels(input);\n    } else if (typeof input === 'string') {\n      let csvMatch = input.match(CSV_EXP);\n\n      if (csvMatch) {\n        color = convertChannels(csvMatch[0].split(','));\n      } else {\n        // See if the browser can compute the color\n\n        const computedColor = getComputedColor(input);\n        csvMatch = computedColor.match(CSV_EXP);\n\n        if (csvMatch) {\n          color = convertChannels(csvMatch[0].split(','));\n        }\n      }\n    }\n\n    return color;\n  }\n\n  export function getColor(input): ColorModel {\n    // Convert input to 4 length array\n    const color = convert(input);\n\n    if (!color) {\n      throw new TypeError('Invalid color input.');\n    }\n\n    // Scale color\n    const scaledColor = scaleColor(color);\n\n    const color1: any = is255(color) ? scaledColor : color;\n    const color255: any = is255(color) ? color : scaledColor;\n\n    return {\n      '1': color1,\n      '255': color255\n    };\n  }\n\n  export function getColors(input: string | any[]): ColorModel[] {\n    let colors = [];\n\n    if (typeof input === 'string') {\n      const csvMatch = input.match(CSV_EXP);\n\n      // Try to extract numbers from the string\n      if (csvMatch) {\n        input = csvMatch.join(',');\n      }\n\n      // Split it on commas\n      input = input.split(',');\n    }\n\n    if (Array.isArray(input)) {\n      const nestedArrays = Array.isArray(input[0]) && Array.isArray(input[1]);\n\n      if (nestedArrays) {\n        // Format is good as is\n        colors = input;\n      } else if (input.length <= 2) {\n        // Arrays of 2 items or less can be CSS color name(s)\n        colors = input.length === 1 ? input.concat(input) : input;\n      } else {\n        // Should be a set of numbers between 3 - 16\n        const half = Math.floor(input.length / 2);\n        // Greater than 4 is assumed to be two color values\n        if (input.length > 4) {\n          colors = [input.slice(0, half), input.slice(half)];\n        } else {\n          // Single color input, apply to both colors\n          colors = [input, input];\n        }\n      }\n    }\n\n    return colors.map(color => getColor(color));\n  }\n\n  export function scaleColor(channels: any[]): any[] {\n    const _is255 = is255(channels);\n    const scaledChannels = [];\n\n    // Don't scale alpha channel\n    for (let i = 0; i < 3; i++) {\n      let scaledChannel = _is255 ? channels[i] / 255 : channels[i] * 255;\n\n      if (_is255) {\n        scaledChannel = Math.round(scaledChannel * 100) / 100;\n      } else {\n        scaledChannel = Math.round(scaledChannel);\n      }\n\n      scaledChannels.push(scaledChannel);\n    }\n\n    if (channels.length === 4) {\n      scaledChannels.push(channels[3]);\n    }\n\n    return scaledChannels;\n  }\n\n  export function hexToRgba(\n    hex: string,\n    asDecimal = false\n  ): [number, number, number, number] {\n    // normalize hex\n    hex = hex\n      .replace(/^#?([a-f\\d])([a-f\\d])([a-f\\d])$/i, (m, r, g, b) =>\n        [r, r, g, g, b, b].join('')\n      ) // #fff -> #ffffff\n      .replace(/^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i, (m, r, g, b) =>\n        [r, g, b, 'ff'].join('')\n      ); // #ffffff -> #ffffffff\n\n    const regex = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(\n      hex\n    ); // #ffffffff\n    const red = parseInt(regex[1], 16);\n    const green = parseInt(regex[2], 16);\n    const blue = parseInt(regex[3], 16);\n    const alpha = parseInt(regex[4], 16) / 255; // important: 0...1\n\n    if (asDecimal) {\n      const rgb = rgbToDecimal([red, green, blue]);\n      return [rgb[0], rgb[1], rgb[2], alpha];\n    } else {\n      return [red, green, blue, alpha];\n    }\n  }\n\n  export function hexToRgb(\n    hex: string,\n    asDecimal = false\n  ): [number, number, number] {\n    const rgba = hexToRgba(hex, asDecimal);\n    return [rgba[0], rgba[1], rgba[2]];\n  }\n\n  export function rgbToHex(rgb: [number, number, number], isDecimal = false) {\n    if (isDecimal) {\n      return toHex(rgbFromDecimal(rgb));\n    } else {\n      return toHex(rgb);\n    }\n  }\n\n  export function rgbToHSP(\n    rgb: [number, number, number]\n  ) {\n    const [r, g, b] = rgb;\n\n    // HSP equation\n    // http://alienryderflex.com/hsp.html\n    const hsp = Math.sqrt(\n      0.299 * (r * r) +\n      0.587 * (g * g) +\n      0.114 * (b * b)\n    );\n    \n    return hsp;\n  }\n\n  export function rgbaToHex(\n    rgba: [number, number, number, number],\n    isDecimal = false\n  ) {\n    const red = rgba[0];\n    const green = rgba[1];\n    const blue = rgba[2];\n    const alpha = rgba[3] * 255; // important: 0...1 -> 0...255\n    if (isDecimal) {\n      return toHex([...rgbFromDecimal([red, green, blue]), alpha]);\n    } else {\n      return toHex([red, green, blue, alpha]);\n    }\n  }\n\n  export function rgbToDecimal(\n    rgb: [number, number, number]\n  ): [number, number, number] {\n    const result = rgb.map(value => {\n      return value / 255;\n    }) as [number, number, number];\n\n    return result;\n  }\n\n  export function rgbFromDecimal(\n    rgb: [number, number, number]\n  ): [number, number, number] {\n    const result = rgb.map(value => {\n      return Math.round(value * 255);\n    }) as [number, number, number];\n\n    return result;\n  }\n\n  function toHex(values: number[]): string {\n    const hex = values\n      .map(value => {\n        const hexString = value.toString(16);\n        return hexString.length % 2 ? `0${hexString}` : hexString;\n      })\n      .join('');\n\n    return `#${hex}`;\n  }\n}\n","// Creates a DOM friendly string for use as an element ID\nexport function createElementID(value: string): string {\n    if (value == null) {\n        return '';\n    }\n\n    const regex = new RegExp(/[^a-zA-Z0-9_]/, 'gi');\n    return value.replace(regex, '_');\n}\n","import Modernizr from 'modernizr';\nimport { Observable, from, fromEvent, merge } from 'rxjs';\nimport { take } from 'rxjs/operators';\n\nexport namespace Fullscreen {\n  export function toggleFullscreen(element?: any) {\n    const fullscreenElement = getFullscreenElement();\n    (fullscreenElement === null) ? requestFullscreen(element) : exitFullscreen();\n  }\n\n  // Request fullscreen\n  export function requestFullscreen(element?: any) {\n    if (checkFullscreenSupport()) {\n      if (!element) {\n        element = document.body;\n      }\n\n      const fn = Modernizr.prefixed('requestFullscreen', element);\n      fn();\n    }\n  }\n\n  // Exit fullscreen\n  export function exitFullscreen() {\n    if (checkFullscreenSupport()) {\n      const fn = Modernizr.prefixed('exitFullscreen', document);\n      fn();\n    }\n  }\n\n  // Is fullscreen supported by the browser, and the potential parent iframe\n  export function canFullscreen(): boolean {\n    return Modernizr.fullscreen && Modernizr.prefixed('fullscreenEnabled', document);\n  }\n\n  // More verbose canFullscreen\n  export function checkFullscreenSupport(): boolean {\n    if (canFullscreen()) {\n      return true;\n    } else {\n      console.warn('Fullscreen is not enabled');\n      return false;\n    }\n  }\n\n  // Return the current fullscreen element, or null\n  export function getFullscreenElement() {\n    return Modernizr.prefixed('fullscreenElement', document);\n  }\n\n  // Utility function to check if we're in full screen\n  export function isFullscreen() {\n    return getFullscreenElement() != null;\n  }\n\n  export function onFullscreenChange(): Observable<Event> {\n    const events$ = 'mozfullscreenchange webkitfullscreenchange MSFullscreenChange fullscreenchange'\n      .split(' ')\n      .map(event => {\n        return fromEvent(document.body, event);\n      });\n      \n    return merge(...events$);\n  }\n}\n","export namespace TextUtils {\n  export function normalize(value: string) {\n    const text = `${value || ''}`;\n    return text\n      .replace(/&#(\\d+);/g, (match, dec) => String.fromCharCode(dec))\n      .replace(/(&.+;)/ig, (match, dec) => String.fromCharCode(match.charCodeAt(0)));\n  }\n\n  export function prettyPrint(value: any): string {\n    const text = `${value || ''}`;\n    return text\n      .trim()\n      // insert a space before all caps\n      .replace(/([A-Z])/g, ' $1')\n      // uppercase the first character\n      .replace(/^./, (str) => str.toUpperCase())\n      // cleanup spaces\n      .trim();\n  }\n\n  export function parseEmails(values: string): string[] {\n    return values.split(',')\n      .map((v) => v.trim())\n      .filter((v) => !!v);\n  }\n  \n  export function validateEmail(email: string): boolean {\n    return /^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\\.[a-zA-Z0-9-]+)*$/.test(email);\n  }\n}\n","import {UrlSerializer, UrlTree, DefaultUrlSerializer} from '@angular/router';\n\n/**\n * Overrides the Angular URL serializer to prevent it from encoded the folder paths\n * Old: production%2FmaleAdult%2Fheart_v02\n * New: production/maleAdult/heart_v02\n */\nexport class CustomUrlSerializer implements UrlSerializer {\n    parse(url: any): UrlTree {\n      // Implemented on November 25, 2019\n      // Some published have implemented iframes using `&amp;` instead of `&`\n      url = url.replace(/&amp;/g, '&');\n\n      const defaultSerializer = new DefaultUrlSerializer();\n      const tree = defaultSerializer.parse(url);\n\n      // Implemented on November 19th, 2019\n      // Some publishers have implemented broken iframe sources that worked with classic widget\n      // but broke with the Angular 8 upgrade. \n      // This ensure that the core URL parameters are always retrieved, even if the URL Serializer gives up.\n      this.ensureQueryParam(tree.queryParams, 'dk', url);\n      this.ensureQueryParam(tree.queryParams, 'uaid', url);\n\n      return tree;\n    }\n\n    serialize(tree: UrlTree): any {\n      const defaultSerializer = new DefaultUrlSerializer();\n      const path = defaultSerializer.serialize(tree);\n\n      // Replace encoded folder params with originals\n      return path.replace(/%2F/g, '/');\n    }\n\n    private ensureQueryParam(queryParams, paramName, url) {\n      // Param already exists, do nothing\n      if (queryParams.hasOwnProperty(paramName)) {\n        return queryParams;\n      }\n\n      // Get param from unparsed URL, if available\n      const param = this.getParameterByName(paramName, url);\n      if (param !== null) {\n        queryParams[paramName] = param;\n      }\n      return queryParams;\n    }\n\n    private getParameterByName(name, url) {\n      if (!url) {\n        url = window.location.href;\n      }\n      name = name.replace(/[\\[\\]]/g, '\\\\$&');\n      const regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)');\n      const results = regex.exec(url);\n      if (!results) {\n        return null;\n      }\n      \n      if (!results[2]) {\n        return '';\n      }\n\n      return decodeURIComponent(results[2].replace(/\\+/g, ' '));\n    }\n}\n","export function makeAsync(fn, ...args) {\n  return () =>\n    new Promise(resolve => {\n      fn(...args, () => {\n        resolve();\n    });\n  });\n}\n","export class XYZModel {\n    x: number;\n    y: number;\n    z: number;\n\n    static toArray(v: XYZModel): [number, number, number] {\n        return [v.x, v.y, v.z];\n    }\n\n    static fromArray(v: [number, number, number]): XYZModel {\n        return {\n            x: v[0],\n            y: v[1],\n            z: v[2]\n        };\n    }\n}\n","import { Injectable } from '@angular/core';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class NumberService {\n\n  constructor() { }\n\n  /**\n   * For the given instance of type <T>, return a new instance of type <T> with rounded number fields.\n   * @param source The source model.\n   * @param precision The number of significant digits.\n   */\n  roundModel<T>(source: any, precision: number): T {\n    const roundedTarget = {\n      ...source\n    };\n\n    // round number fields\n    Object.keys(source)\n      .filter((field) => typeof (source[field]) === 'number')\n      .forEach((field) => {\n        roundedTarget[field] = this.roundNumber(source[field], precision);\n      });\n\n    // instance of <T> with rounded fields\n    return <T>roundedTarget;\n  }\n\n  /**\n   * Round the the specified source number to specific precision.\n   * @param source The number to round.\n   * @param precision The number of significant digits.\n   */\n  roundNumber(source: number, precision: number): number {\n    return Math.round(source * Math.pow(10, precision)) / Math.pow(10, precision);\n  }\n}\n","import { get } from 'lodash';\nimport { EngineColorRecipeModel } from '../edit/models/engine-color-recipe.model';\n\n\nexport namespace ObjectColor {\n  export function getColorRecipe(Human: any, objectId: string): EngineColorRecipeModel {\n    const humanObject = Human.scene.objects[objectId];\n    if (humanObject instanceof Human.scene.Object) {\n      const prop = humanObject.getProperties();\n      const colorProp = {\n          tintColor: get(prop, 'tintColor') ? prop.tintColor : [1, 1, 1],\n          brightness: prop.brightness,\n          saturation: prop.saturation,\n          contrast: prop.contrast,\n          opacity: prop.opacity\n      };\n      return colorProp;\n    } \n    return null;\n  }\n}\n","import { uuid } from './uuid';\n\nconst SplitTerm = '_particle-';\n\nexport namespace ParticleIdUtils {\n  export function getParticleIdRoot(id: string) {\n    return id.split(SplitTerm)[0];\n  }\n\n  export function generateParticleId(\n    currentId: string,\n    uuidFn: uuid.UuidFunc = uuid.getUuid\n  ) {\n    return `${getParticleIdRoot(currentId)}${SplitTerm}${uuidFn()}`;\n  }\n}\n","import { Pipe, PipeTransform } from '@angular/core';\nimport { createElementID } from '../libraries/dom/dom';\n\n@Pipe({\n  name: 'elementID'\n})\nexport class ElementIdPipe implements PipeTransform {\n  transform(value: string, args?: any): any {\n    return createElementID(value);\n  }\n\n}\n","import { Pipe, PipeTransform } from '@angular/core';\nimport { lowerCase, upperFirst } from 'lodash';\n\n@Pipe({\n  name: 'humanize'\n})\nexport class HumanizePipe implements PipeTransform {\n  transform(value: string, args?: any): any {\n    return lowerCase(value).split(' ').map(word => upperFirst(word)).join(' ');\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { HumanizePipe } from './humanize.pipe';\nimport { TextNormalizePipe } from './text-normalize.pipe';\nimport { ElementIdPipe } from './element-id.pipe';\nimport { MegabytePipe } from './megabyte.pipe';\nimport { PrettyPrintPipe } from './pretty-print.pipe';\n\n@NgModule({\n  declarations: [\n    HumanizePipe,\n    TextNormalizePipe,\n    ElementIdPipe,\n    MegabytePipe,\n    PrettyPrintPipe\n  ],\n  exports: [\n    HumanizePipe,\n    TextNormalizePipe,\n    ElementIdPipe,\n    MegabytePipe,\n    PrettyPrintPipe\n  ],\n  imports: [\n    CommonModule,\n  ]\n})\nexport class PipesModule { }\n","import { Pipe, PipeTransform } from '@angular/core';\nimport { TextUtils } from '../libraries/text-utils/text-utils';\n\n@Pipe({\n  name: 'textNormalize'\n})\nexport class TextNormalizePipe implements PipeTransform {\n\n  transform(value: any, args?: any): any {\n    const text = `${value || ''}`;\n    return TextUtils.normalize(text);\n  }\n\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\nimport { AlertComponent } from './components/alert/alert.component';\nimport { ColorPickerComponent } from './components/color-picker/color-picker.component';\nimport { ColorPickerModule } from 'ngx-color-picker';\nimport { DeviceViewComponent } from './components/device-view/device-view.component';\nimport { HelpMenuComponent } from './components/help-menu/help-menu.component';\nimport { ListModule } from './components/list/list.module';\nimport { MaterialModule } from '../material.module';\nimport { PapaParseModule } from 'ngx-papaparse';\nimport { ReactiveFormsModule } from '@angular/forms';\nimport { SelectedNodesPanelComponent } from './components/selected-nodes-panel/selected-nodes-panel.component';\nimport { SliderModule } from './components/slider/slider.module';\nimport { UserProfilePinComponent } from './components/user-profile-pin/user-profile-pin.component';\nimport { PanelComponent } from './components/panel/panel.component';\nimport { ZendeskConfigModule } from '../zendesk-config.module';\nimport { ButtonsModule } from './components/buttons/buttons.module';\nimport { TreeModule } from './components/tree/tree.module';\nimport { CardsModule } from './components/cards/cards.module';\nimport { LocalFormsModule } from './components/local-forms/forms.module';\nimport { DirectivesModule } from './directives/directives.module';\nimport { ProgressIndictatorsModule } from './components/progress-indicators/progress-indicators.module';\nimport { PipesModule } from './pipes/pipes.module';\nimport { PillboxModule } from './components/pillbox/pillbox.module';\nimport { TabsModule } from './components/tabs/tabs.module';\nimport { ColumnModule } from './components/column/column.module';\nimport { SortComponent } from './components/sort/sort.component';\nimport { SwatchItemComponent } from './components/swatch-item/swatch-item.component';\nimport { IconModule } from './components/icon/icon.module';\nimport { NodeActionsModule } from './components/node-actions/node-actions.module';\nimport { ColorPickerInputComponent } from './components/color-picker-input/color-picker-input.component';\nimport { PopupComponent } from './features/components/popup/popup.component';\nimport { MarkdownModule } from 'ngx-markdown';\nimport { CategoryImageComponent } from './components/category-image/category-image.component';\nimport { DividerComponent } from './components/divider/divider.component';\nimport { NavigationModule } from './components/navigation/navigation.module';\nimport { InputGroupComponent } from './components/input-group/input-group.component';\nimport { SystemMessageComponent } from './components/system-message/system-message.component';\nimport { ProfileBadgeComponent } from './components/profile-badge/profile-badge/profile-badge.component';\nimport { MessageToggleComponent } from './components/message-toggle/message-toggle.component';\nimport { RouterModule } from '@angular/router';\nimport { HtmlComponent } from './html/html.component';\nimport { ImageViewComponent } from './components/image-view/image-view.component';\n\n\n@NgModule({\n  imports: [\n    RouterModule,\n    ButtonsModule,\n    CardsModule,\n    ColorPickerModule,\n    ColumnModule,\n    CommonModule,\n    DirectivesModule,\n    IconModule,\n    LocalFormsModule,\n    ListModule,\n    MaterialModule,\n    NavigationModule,\n    NodeActionsModule,\n    PapaParseModule,\n    PillboxModule,\n    PipesModule,\n    ProgressIndictatorsModule,\n    ReactiveFormsModule,\n    SliderModule,\n    TabsModule,\n    TreeModule,\n    ZendeskConfigModule,\n    MarkdownModule.forChild()\n  ],\n  declarations: [\n    AlertComponent,\n    ColorPickerComponent,\n    DeviceViewComponent,\n    HelpMenuComponent,\n    SelectedNodesPanelComponent,\n    UserProfilePinComponent,\n    PanelComponent,\n    SortComponent,\n    SwatchItemComponent,\n    ColorPickerInputComponent,\n    PopupComponent,\n    CategoryImageComponent,\n    DividerComponent,\n    InputGroupComponent,\n    SystemMessageComponent,\n    ProfileBadgeComponent,\n    MessageToggleComponent,\n    HtmlComponent,\n    ImageViewComponent\n  ],\n  exports: [\n    AlertComponent,\n    ButtonsModule,\n    CardsModule,\n    ColorPickerComponent,\n    ColumnModule,\n    DeviceViewComponent,\n    DirectivesModule,\n    LocalFormsModule,\n    HelpMenuComponent,\n    IconModule,\n    ListModule,\n    NavigationModule,\n    NodeActionsModule,\n    PipesModule,\n    PillboxModule,\n    ProgressIndictatorsModule,\n    SelectedNodesPanelComponent,\n    SliderModule,\n    TabsModule,\n    TreeModule,\n    UserProfilePinComponent,\n    PanelComponent,\n    SortComponent,\n    SwatchItemComponent,\n    ColorPickerInputComponent,\n    PopupComponent,\n    CategoryImageComponent,\n    DividerComponent,\n    InputGroupComponent,\n    SystemMessageComponent,\n    ProfileBadgeComponent,\n    MessageToggleComponent,\n    HtmlComponent,\n    ImageViewComponent\n  ],\n  entryComponents: []\n})\nexport class SharedModule { }\n","import { StorageItemEnum } from './storage.service';\n\n/**\n * Invalidates the value in local storage for a given key,\n * if the value was created before invalidateBefore\n *\n * Side effects: Effects local storage.\n *\n * @param userEid The user profile's EID. Used to only invalidate options for this user.\n * @param invalidateBefore Milliseconds since the Epoch.\n */\nexport function invalidateLocalWidgetOptions(\n  userEid: string,\n  invalidateBefore: number\n) {\n  const rawValue = localStorage.getItem(StorageItemEnum.WidgetOptions);\n\n  // bail if there are no widget options in local storage\n  if (rawValue === null) {\n    return;\n  }\n\n  const widgetOptions = JSON.parse(rawValue);\n\n  // bail if there are no widget options for this user\n  if (widgetOptions[userEid] === undefined) {\n    return;\n  }\n\n  // prune this user's widget options if they were created before `invalidateBefore`\n  const timestamp = widgetOptions[userEid].timestamp || 0;\n  if (timestamp < invalidateBefore) {\n    // prune this user's widget options\n    delete widgetOptions[userEid];\n\n    // save pruned options to local storage\n    try {\n      localStorage.setItem(\n        StorageItemEnum.WidgetOptions,\n        JSON.stringify(widgetOptions)\n      );\n    } catch {}\n  }\n}\n","import { Injectable } from '@angular/core';\n\nexport enum StorageItemEnum {\n  WidgetOptions = 'widgetOptions',\n  SnapshotOptions = 'snapshotOptions',\n  Locale = 'locale',\n  GroupRestriction = 'GroupRestriction',\n  UserAppId = 'userAppId',\n  RememberMeEmail = 'rememberMeEmail',\n  LabelConversionSeen = 'labelConversionSeen',\n  DefaultGroupEdit = 'defaultGroupEdit',\n  DefaultCollectionId = 'defaultCollectionId',\n  InternetExplorerWarning = 'internetExplorerWarning',\n  GettingStartedTutorial = 'gettingStartedTutorial',\n  AutoCapture = 'autoCapture',\n  SystemMessage = 'systemMessage'\n}\n\nexport enum SessionStorageEnum {\n  UserMessagesSeen = 'userMessagesSeen'\n}\n\nclass StorageFallback implements Storage {\n  private _data: { [key: string]: string } = {};\n\n  get keys(): string[] {\n    return Object.keys(this._data);\n  }\n\n  get length(): number {\n    return this.keys.length;\n  }\n\n  clear() {\n    this._data = {};\n  }\n\n  getItem(key: string): string | null {\n    return this._data[key];\n  }\n\n  key(index: number): string | null {\n    return this.keys[index];\n  }\n\n  removeItem(key: string) {\n    delete this._data[key];\n  }\n\n  setItem(key: string, value: string) {\n    this._data[key] = value;\n  }\n}\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class StorageService {\n\n  private _localStorage: Storage;\n  private _sessionStorage: Storage;\n\n  constructor() {\n    this._localStorage = this.getStorage('localStorage');\n    this._sessionStorage = this.getStorage('sessionStorage');\n  }\n\n  getLocalItem(key: StorageItemEnum) {\n    return this._localStorage.getItem(`${key}`);\n  }\n\n  getLocalJSON(key: StorageItemEnum) {\n    const value = this.getLocalItem(key);\n    return value ? JSON.parse(value) : null;\n  }\n\n  setLocalItem(key: StorageItemEnum, value: any): boolean {\n    const serializedValue = typeof (value) === 'object' ? JSON.stringify(value) : `${value}`;\n    try {\n      this._localStorage.setItem(`${key}`, serializedValue);\n      return true;\n    } catch (e) {\n      return false;\n    }\n  }\n\n  removeLocalItem(key: StorageItemEnum) {\n    this._localStorage.removeItem(`${key}`);\n  }\n\n  getSessionItem<T>(key: SessionStorageEnum): T {\n    const entry = this._sessionStorage.getItem(`${key}`);\n    if (entry) {\n      return <T>JSON.parse(entry);\n    } else {\n      return null;\n    }\n  }\n\n  setSessionItem(key: SessionStorageEnum, entry: any): boolean {\n    const json = JSON.stringify(entry);\n    try {\n      this._sessionStorage.setItem(`${key}`, json);\n      return true;\n    } catch (e) {\n      return false;\n    }\n  }\n\n  removeSessionItem(key: SessionStorageEnum) {\n    this._sessionStorage.removeItem(`${key}`);\n  }\n\n  clearStorage() {\n    this.clearLocalStorage();\n    this.clearSessionStorage();\n  }\n\n  clearLocalStorage() {\n    this._localStorage.clear();\n  }\n\n  clearSessionStorage() {\n    this._sessionStorage.clear();\n  }\n\n  // check storage support and/or access, else inline fallback\n  private getStorage(key: 'localStorage' | 'sessionStorage'): Storage {\n    try {\n      return window[key] || new StorageFallback();\n    } catch (e) {\n      return new StorageFallback();\n    }\n  }\n}\n","import { ContentType } from '../story/models/content-type.enum';\nimport { StoryChapterThumbnail } from '../story/models/story-chapter-thumbnail.model';\nimport { storyType } from '../story/state/story-type';\n\n\n// thumbnail urls\nexport namespace Thumbnail {\n  export function generateThumbnailUrls(\n    storyIdChapterIdList: {originalChapterId: string, newChapterId: string, originalStoryId: string}[]\n    ): Map<string, StoryChapterThumbnail> {\n    return storyIdChapterIdList.reduce((acc, {originalChapterId, newChapterId, originalStoryId}) => {\n\n      const isBookmark = ContentType.Bookmark === storyType(originalStoryId);\n      const pathForStoryType = isBookmark ? 'bookmarks' : 'modules';\n      const urlBase = `/thumbs/${pathForStoryType}/${originalStoryId.replace('.json', '')}`;\n\n      const thumbnail = new StoryChapterThumbnail();\n      thumbnail.storyId = originalStoryId;\n      thumbnail.chapterId = originalChapterId;\n      \n      thumbnail.urls = {\n        small: `${urlBase}/small/chapters/${originalChapterId}.jpg`,\n        large: `${urlBase}/large/chapters/${originalChapterId}.jpg`\n      };\n      acc.set(newChapterId, thumbnail);\n      return acc;\n\n    }, new Map());\n  }\n}\n","export const ThumbnailConstants = {\n  small: {\n    width: 256,\n    height: 256\n  },\n  medium: {\n    width: 512,\n    height: 512\n  },\n  large: {\n    width: 1024,\n    height: 1024\n  }\n};\n","import { TweenParticleLookupModel } from '../story/models/tween-particle-lookup.model';\n\ntype OldChapterId = string;\ntype NewChapterId = string;\n\ndeclare const Human;\n\nexport namespace TweenParticleLookup {\n  /**\n   * Replace the chapterIds of the lookup with the new chapter Ids.\n   * Needed whenever we don't serialize 'in place', like when we save a new bookmark in studio.\n   *\n   * e.g.\n   * chapter_abc --> chapter_def\n   *\n   * `{chapter_abc: {particleId: string}}`\n   * becomes\n   * `{chapter_def: {particleId: string}}`\n   *\n   */\n  export function updateChapterIds(\n    currentLookup: TweenParticleLookupModel,\n    newChapterMap: Record<OldChapterId, NewChapterId>\n  ): TweenParticleLookupModel {\n    const oldChapterIds = Object.keys(currentLookup);\n\n    const newLookup = oldChapterIds.reduce((acc, oldChapterId) => {\n      const newChapterId = newChapterMap[oldChapterId];\n      acc[newChapterId] = currentLookup[oldChapterId];\n      return acc;\n    }, {});\n\n    return newLookup;\n  }\n\n  export function duplicateChapter(\n    originChapterId: string,\n    duplicateChapterId: string,\n    lookup: TweenParticleLookupModel\n  ): TweenParticleLookupModel {\n    const newLookup = {\n      ...lookup,\n      [duplicateChapterId]: lookup[originChapterId],\n    };\n    return newLookup;\n  }\n\n  export function deleteChapter(\n    chapterId: string,\n    lookup: TweenParticleLookupModel\n  ): TweenParticleLookupModel {\n    const newLookup = { ...lookup };\n    delete newLookup[chapterId];\n    return newLookup;\n  }\n\n  export function addEntryForChapter(\n    chapterId: string,\n    entry: Record<string, string>,\n    lookup: TweenParticleLookupModel\n  ) {\n    lookup[chapterId] = {...lookup[chapterId], ...entry};\n    return lookup;\n  }\n\n  export function refreshEngineLookup(\n    moduleId: string,\n    lookup: TweenParticleLookupModel\n  ) {\n    Human.modules.moduleData[moduleId].tweenParticleLookup = lookup;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport UserMessageModel, { UserMessageEnum } from '../auth/models/user-message-model';\nimport { Observable, of } from 'rxjs';\nimport { map, tap } from 'rxjs/operators';\nimport { plainToClass } from 'class-transformer';\nimport { OrganizationModel } from '../organizations/models/organization.model';\nimport { HttpClient } from '@angular/common/http';\nimport { StorageService, SessionStorageEnum } from './storage.service';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class UserMessageService {\n\n  constructor(\n    private http: HttpClient,\n    private storageService: StorageService\n  ) { }\n\n  getUserMessage(type: UserMessageEnum, mode: string = '', checkCache: boolean = true): Observable<UserMessageModel> {\n    const cachedMessage = this.getCachedMessage(type);\n    if (checkCache && cachedMessage) {\n      return of(cachedMessage);\n    } else {\n      return this.http.get(`/ws/user/message?version=2&type=${type}&mode=${mode}`)\n        .pipe(\n          map((response: any) => {\n            const { message_seen_id, show_alert } = response;\n            let responseValue: any;\n            switch (type) {\n              // join organization\n              case UserMessageEnum.DomainAlert:\n                responseValue = plainToClass(OrganizationModel, response.join_organization as Object);\n                break;\n              case UserMessageEnum.WelcomeTour:\n                responseValue = `${response.tour_version}`;\n                break;\n              case UserMessageEnum.SurveyMonkey:\n                responseValue = `${response.survey_group_name}`;\n                break;\n              case UserMessageEnum.CompleteProfileAlert:\n                responseValue = response.is_new_user === true;\n                break;\n            }\n            return <UserMessageModel>{\n              messageSeenId: message_seen_id,\n              messageType: type,\n              showUserAlert: show_alert,\n              messageData: responseValue\n            };\n          }),\n          tap((response) => {\n            // cache when no user alert needed\n            if (!response.showUserAlert) {\n              this.addCachedMessage(response);\n            }\n          })\n        );\n    }\n  }\n\n  setUserMessageViewed(messageSeenId: string) {\n    return this.http.post(`/ws/user/message`, {\n      version: 2,\n      message_seen_id: messageSeenId\n    });\n  }\n\n  sendMessage(message: { type: string; id: string; }) {\n    return this.http.post(`/ws/user/message`, message);\n  }\n\n  private getCachedMessage(type: UserMessageEnum): UserMessageModel {\n    const seenMessageCache = this.getCachedMessages();\n    return seenMessageCache.find((message) => message.messageType === type);\n  }\n\n  private getCachedMessages(): UserMessageModel[] {\n    const seenMessages = this.storageService.getSessionItem<UserMessageModel[]>(SessionStorageEnum.UserMessagesSeen);\n    return seenMessages || [];\n  }\n\n  private addCachedMessage(type: UserMessageModel) {\n    if (!this.getCachedMessage(type.messageType)) {\n      const seenMessages = this.getCachedMessages();\n      this.storageService.setSessionItem(SessionStorageEnum.UserMessagesSeen, [...seenMessages, type]);\n    }\n  }\n}\n","export namespace uuid {\n  // Borrowed from https://stackoverflow.com/a/2117523/43687\n\n  export type UuidFunc = () => string;\n  export type PrefixUuidFunc = (prefix: string) => string;\n\n  export function getUuid() {\n    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n      // tslint:disable-next-line:no-bitwise\n      const r = Math.random() * 16 | 0, v = c === 'x' ? r : (r & 0x3 | 0x8);\n      return v.toString(16);\n    });\n  }\n\n  export function idWithPrefix(prefix?: string) {\n    if (prefix) {\n      return `${prefix}-${getUuid()}`;\n    }\n    return getUuid();\n  }\n}\n","import { ViewUIModel } from '../view/models/view-ui.model';\nimport { initialViewState } from '../view/state/view.state';\nimport { UiIO } from '../widget-api/models/ui.io';\nimport { UrlUIConfig, WidgetUrlConfig } from '../widget-config/initial-config';\nimport { ViewUI } from '../view/models/view-ui.enum';\nimport { ScrollModeEnum } from '../engine/models/scroll-mode.enum';\nimport { InteractTypeEnum } from '../view/models/interact-type.enum';\nimport { ChapterModel } from '../story/models/chapter.model';\nimport { get, uniq } from 'lodash';\nimport { MediaEnum } from '../story/models/media.enum';\nimport { ViewLoaderEnum } from '../view/models/view-loader.enum';\nconst layoutDefaults = initialViewState.ui;\n\n// Dear future maintainers,\n// https://docs.google.com/spreadsheets/d/1SXisKVARVtagG2OKWHzYoqKli6rSs89Y2J020smZkhc/edit?pli=1#gid=1968936664\n\nexport class UIConfig {\n  [ViewUI.Audio]: boolean | undefined;\n  [ViewUI.Camera]: boolean | undefined;\n  [ViewUI.ChapterList]: boolean | undefined;\n  [ViewUI.Column]: boolean | undefined;\n  [ViewUI.Drawer]: boolean | undefined;\n  [ViewUI.Fullscreen]: boolean | undefined;\n  [ViewUI.Help]: boolean | undefined;\n  [ViewUI.Labels]: boolean | undefined;\n  [ViewUI.LabelList]: boolean | undefined;\n  [ViewUI.Loader]: ViewLoaderEnum | undefined;\n  [ViewUI.Logo]: boolean | undefined;\n  [ViewUI.Media]: MediaEnum | undefined;\n  [ViewUI.Menu]: boolean | undefined;\n  [ViewUI.NodeInfo]: boolean | undefined;\n  [ViewUI.Pagination]: boolean | undefined;\n  [ViewUI.Presenter]: boolean | undefined;\n  [ViewUI.Search]: boolean | undefined;\n  [ViewUI.TitleOnly]: boolean | undefined;\n  [ViewUI.Toolbar]: boolean | undefined;\n  [ViewUI.Tools]: boolean | undefined;\n  [ViewUI.Undo]: boolean | undefined;\n\n  all: boolean | undefined;\n  logoIsHyperLink: boolean | undefined;\n  drawerExpandedInitially: boolean | undefined;\n  [ViewUI.InternetExplorerWarning]: boolean | undefined;\n  [ViewUI.AnatomyLabels]: boolean | undefined;\n  [ViewUI.Tutorial]: boolean | undefined;\n  [ViewUI.Legend]: boolean | undefined;\n  [ViewUI.Whiteboard]: boolean | undefined;\n  [ViewUI.VisibilityLayers]: boolean | undefined;\n  [ViewUI.ContextActions]: boolean | undefined;\n}\n\nconst setConfig = (_config: boolean, _default: boolean) =>\n  _config === undefined ? _default : _config;\n\n\nfunction valueForAliases(...aliases: Array<boolean | undefined>) {\n  // are any of the aliases true?\n  if (aliases.some(alias => alias === true)) {\n    return true;\n  }\n\n  // are any of the aliases false?\n  if (aliases.some(alias => alias === false)) {\n    return false;\n  }\n\n  // let downstream decide.\n  return undefined;\n}\n\nexport function getMediaTemplate(playPause: boolean, scrubber: boolean, media: MediaEnum): MediaEnum {\n  // If template is passed and valid, return template\n  if (Object.values(MediaEnum).indexOf(media) >= 0) {\n    return media;\n  }\n\n  // LEGACY\n  // Otherwise, determine template based on legacy boolean properties (playPause, scrubber)\n\n  // Turning off playPause should turn off everything, because you can't have a scrubber without a pause button\n  if (playPause === false) {\n    return MediaEnum.None;\n  }\n\n  // Explicitly enable or disable the scrubber\n  if (scrubber != null) {\n    return scrubber ? MediaEnum.Full : MediaEnum.Small;\n  }\n\n  // If not actionable, do nothing. Allow the app to figure it out.\n  return null;\n}\n\nexport function getLoaderTemplate(loader: ViewLoaderEnum): ViewLoaderEnum {\n  return Object.values(ViewLoaderEnum).includes(loader)\n    ? loader\n    : null;\n}\n\nexport namespace WidgetWiring {\n\n  // need to map UiIO.UIDisplayParams and UrlUIConfig to UIConfig\n  export function convertAPIUIConfigToUIConfig(apiConfig: UiIO.UIDisplayParams): UIConfig {\n    const uiConfig = (apiConfig['all'] != null) ? generateUIAllConfig(apiConfig['all']) : new UIConfig();\n    const apiUIConfig = {\n      all: apiConfig['all'],\n      [ViewUI.Loader]: getLoaderTemplate(apiConfig['loader']),\n      [ViewUI.Help]: valueForAliases(\n        apiConfig['help'],\n        (apiConfig as UiIO.UIDisplayParamsInternal).help\n      ),\n      [ViewUI.Tools]: valueForAliases(\n        apiConfig['tools'],\n        (apiConfig as UiIO.UIDisplayParamsInternal).tools\n      ),\n      [ViewUI.Layout]: apiConfig['layout'],\n      [ViewUI.Toolbar]: apiConfig['toolbar'],\n      [ViewUI.Fullscreen]: valueForAliases(\n        apiConfig['fullscreen'],\n        (apiConfig as UiIO.UIDisplayParamsInternal).fullscreen\n      ),\n      [ViewUI.Search]: valueForAliases(\n        apiConfig['objectTree'],\n        (apiConfig as UiIO.UIDisplayParamsInternal).search\n      ),\n      [ViewUI.Audio]: apiConfig['audio'],\n      [ViewUI.Media]: getMediaTemplate(\n        apiConfig['playPause'],\n        valueForAliases(\n          apiConfig['scrubber'],\n          apiConfig['scrubber.chapters'],\n          \n        ),\n        (apiConfig as UiIO.UIDisplayParamsInternal).media\n      ),\n      [ViewUI.Camera]: valueForAliases(\n        apiConfig['nav'],\n        apiConfig['cameraMode'],\n        apiConfig['center'],\n        apiConfig['zoomIn'],\n        apiConfig['zoomOut'],\n        (apiConfig as UiIO.UIDisplayParamsInternal).nav\n      ),\n      [ViewUI.Pagination]: valueForAliases(\n        apiConfig['tour'],\n        apiConfig['tour.chapters']\n      ),\n\n      [ViewUI.Column]: valueForAliases(\n        apiConfig['info'],\n        (apiConfig as UiIO.UIDisplayParamsInternal).info\n      ),\n      [ViewUI.Drawer]: valueForAliases(\n        apiConfig['info'],\n        (apiConfig as UiIO.UIDisplayParamsInternal).info\n      ),\n      [ViewUI.TitleOnly]: valueForAliases(\n        apiConfig['info'],\n        (apiConfig as UiIO.UIDisplayParamsInternal).info\n      ),\n\n      [ViewUI.LabelList]: (apiConfig as UiIO.UIDisplayParamsInternal).labelList,\n      [ViewUI.ChapterList]: (apiConfig as UiIO.UIDisplayParamsInternal).chapterList,\n      [ViewUI.NodeInfo]: (apiConfig as UiIO.UIDisplayParamsInternal).anatomyDescriptions,\n      [ViewUI.Legend]: (apiConfig as UiIO.UIDisplayParamsInternal).legend,\n\n      [ViewUI.Menu]: (apiConfig as UiIO.UIDisplayParamsInternal).menu,\n\n      [ViewUI.InternetExplorerWarning]: undefined,\n\n      // not controlled by API\n      [ViewUI.Labels]: undefined,\n      [ViewUI.Logo]: undefined,\n      [ViewUI.Presenter]: undefined,\n      logoIsHyperLink: undefined,\n      drawerExpandedInitially: undefined,\n      [ViewUI.Tutorial]: undefined,\n      [ViewUI.AnatomyLabels]: valueForAliases(apiConfig['anatomyLabels'], (apiConfig as UiIO.UIDisplayParamsInternal).anatomyLabels),\n      [ViewUI.Undo]: valueForAliases(apiConfig['reset'], apiConfig['undo']),\n      [ViewUI.Whiteboard]: apiConfig['whiteboard'],\n      [ViewUI.VisibilityLayers]: apiConfig['visibilityLayers'],\n      [ViewUI.ContextActions]: apiConfig['contextActions']\n    };\n\n    return mergeUIConfigs(apiUIConfig, uiConfig);\n  }\n\n\n  export function convertUrlUIConfigToUIConfig(uriConfig: UrlUIConfig): UIConfig {\n    // Check all config\n    const uiConfig = (uriConfig['ui-all'] != null) ? generateUIAllConfig(uriConfig['ui-all']) : new UIConfig();\n\n    const urlUIConfig = {\n      [ViewUI.Layout]: uriConfig['ui-layout'],\n      [ViewUI.Loader]: getLoaderTemplate(uriConfig['ui-loader']),\n      [ViewUI.NodeInfo]: uriConfig['ui-anatomy-descriptions'],\n      [ViewUI.Tools]: uriConfig['ui-tools'],\n      [ViewUI.Toolbar]: uriConfig['ui-toolbar'],\n      [ViewUI.Media]: getMediaTemplate(\n        null,\n        valueForAliases(\n          uriConfig['ui-scrubber'],\n          uriConfig['ui-scrubber.chapters'],\n          uriConfig['ui-scrubber.tour']\n        ),\n        uriConfig['ui-media-controls']\n      ),\n      [ViewUI.Audio]: uriConfig['ui-audio'],\n      [ViewUI.Fullscreen]: uriConfig['ui-fullscreen'],\n      [ViewUI.Help]: uriConfig['ui-help'],\n      [ViewUI.Camera]: uriConfig['ui-nav'],\n      [ViewUI.Presenter]: uriConfig['ui-presenter'],\n      [ViewUI.Menu]: uriConfig['ui-menu'],\n      [ViewUI.Pagination]: uriConfig['ui-tour'],\n      // handle params with aliases\n      [ViewUI.Search]: valueForAliases(\n        uriConfig['ui-search'],\n        uriConfig['ui-object-tree']\n      ),\n      [ViewUI.Column]: valueForAliases(\n        uriConfig['ui-info'],\n        uriConfig['ui-panel']\n      ),\n      [ViewUI.Drawer]: valueForAliases(\n        uriConfig['ui-info'],\n        uriConfig['ui-panel']\n      ),\n      [ViewUI.Description]: valueForAliases(\n        uriConfig['ui-info']\n      ),\n      [ViewUI.TitleOnly]: valueForAliases(\n        uriConfig['ui-info']\n      ),\n      [ViewUI.Logo]: valueForAliases(uriConfig['ui-bd'], uriConfig['ui-logo']),\n      logoIsHyperLink: valueForAliases(\n        uriConfig['ui-bd.link'],\n        uriConfig['ui-logo.islink']\n      ),\n      [ViewUI.Labels]: uriConfig['ui-labels'],\n      [ViewUI.LabelList]: uriConfig['ui-label-list'],\n      [ViewUI.ChapterList]: uriConfig['ui-chapter-list'],\n      [ViewUI.InternetExplorerWarning]: uriConfig['ie-warning'],\n      all: uriConfig['ui-all'],\n      drawerExpandedInitially: uriConfig['ui-info-expand'],\n      [ViewUI.AnatomyLabels]: valueForAliases(uriConfig['ui-anatomy-labels']),\n      [ViewUI.Tutorial]: valueForAliases(uriConfig['ui-tutorial']),\n      [ViewUI.Legend]: valueForAliases(uriConfig['ui-legend']),\n      [ViewUI.Undo]: valueForAliases(uriConfig['ui-undo'], uriConfig['ui-reset']),\n      [ViewUI.Whiteboard]: valueForAliases(uriConfig['ui-whiteboard']),\n      [ViewUI.VisibilityLayers]: valueForAliases(\n        uriConfig['ui-visibility-layers'],\n        uriConfig['ui-layers']\n      ),\n      [ViewUI.ContextActions]: valueForAliases(uriConfig['ui-context-actions'])\n    };\n\n    return mergeUIConfigs(urlUIConfig, uiConfig);\n  }\n\n  export function convertChapterToUIConfig(chapter: ChapterModel): UIConfig {\n    const ui = chapter.ui;\n    if (!ui || !ui.config) {\n      return null;\n    }\n\n    const uiConfig = new UIConfig();\n    // const config = getUIConfigForUIAll(true);\n    \n    uiConfig[ViewUI.Column] = ui.config.info;\n    uiConfig[ViewUI.Drawer] = ui.config.info;\n    uiConfig[ViewUI.Fullscreen] = ui.config.fullscreen;\n    uiConfig[ViewUI.Search] = ui.config.objectTree;\n    uiConfig[ViewUI.Camera] = ui.config.nav;\n    uiConfig[ViewUI.Loader] = getLoaderTemplate(ui.config.loader);\n    uiConfig[ViewUI.Whiteboard] = ui.config.whiteboard;\n    uiConfig[ViewUI.VisibilityLayers] = ui.config.visibilityLayers;\n    uiConfig[ViewUI.ContextActions] = ui.config.contextActions;\n\n    uiConfig[ViewUI.Media] = getMediaTemplate(\n      ui.config.playPause,\n      ui.config.scrubber,\n      ui.config.mediaControls\n    );\n\n    return uiConfig;\n  }\n\n  // Generates a stock UI config from an 'all' parameter\n  export function generateUIAllConfig(all: boolean): UIConfig {\n    return {\n      [ViewUI.Loader]: (all ? ViewLoaderEnum.Bar : ViewLoaderEnum.None),\n      [ViewUI.Column]: all,\n      [ViewUI.Drawer]: all,\n      [ViewUI.Tools]: all,\n      [ViewUI.Toolbar]: all,\n      [ViewUI.Fullscreen]: all,\n      [ViewUI.Help]: all,\n      [ViewUI.Camera]: all,\n      [ViewUI.Search]: all,\n      [ViewUI.Presenter]: all,\n      [ViewUI.Menu]: all,\n      [ViewUI.Audio]: all,\n      [ViewUI.Pagination]: all,\n      [ViewUI.NodeInfo]: all,\n      [ViewUI.Labels]: null,\n      [ViewUI.LabelList]: all,\n      [ViewUI.ChapterList]: all,\n      [ViewUI.Media]: (all ? MediaEnum.Full : MediaEnum.None),\n      [ViewUI.TitleOnly]: all,\n      [ViewUI.Undo]: all,\n      all: all,\n      drawerExpandedInitially: null,\n      logoIsHyperLink: null,\n      [ViewUI.AnatomyLabels]: null,\n      [ViewUI.Logo]: true,\n      [ViewUI.Tutorial]: null,\n      [ViewUI.InternetExplorerWarning]: true,\n      [ViewUI.Legend]: true,\n      [ViewUI.Whiteboard]: all,\n      [ViewUI.VisibilityLayers]: all,\n      [ViewUI.ContextActions]: all\n    };\n  }\n\n  export function mergeUIConfigs(primary: UIConfig, secondary: UIConfig) {\n    if (secondary == null) {\n      return primary;\n    }\n\n    const keys = uniq([...Object.keys(primary), ...Object.keys(secondary)]);\n    return keys.reduce((config, key) => {\n      config[key] = primary[key] != null ? primary[key] : secondary[key];\n      \n      return config;\n    }, new UIConfig());\n  }\n\n  export function createLayoutFromConfig(\n    currentLayout: ViewUIModel,\n    config: UIConfig\n  ): ViewUIModel {\n    const newLayout: ViewUIModel = JSON.parse(JSON.stringify(currentLayout));\n    \n    // Note: UIConfig.all should never be used here. The `all` property is handled during\n    // uiConfig generation. \n\n    newLayout.loader.enable = setConfig(\n      config[ViewUI.Loader] !== ViewLoaderEnum.None,\n      layoutDefaults.loader.enable\n    );\n\n    if (config[ViewUI.Loader] != null) {\n      newLayout.loader.template = config[ViewUI.Loader];\n    }\n\n    newLayout.nodeInfo.enable = setConfig(\n      config[ViewUI.NodeInfo],\n      layoutDefaults.nodeInfo.enable\n    );\n\n    newLayout.pagination.enable = setConfig(\n      config[ViewUI.Pagination],\n      layoutDefaults.pagination.enable\n    );\n\n    newLayout.drawer.isExpandedInitially = setConfig(\n      config.drawerExpandedInitially,\n      layoutDefaults.drawer.isExpandedInitially\n    );\n\n    newLayout.tools.enable = setConfig(\n      config[ViewUI.Tools],\n      layoutDefaults.tools.enable\n    );\n\n    newLayout.toolbar.enable = setConfig(\n      config[ViewUI.Toolbar],\n      layoutDefaults.toolbar.enable\n    );\n\n    newLayout.media.enable = setConfig(\n      config[ViewUI.Media] !== MediaEnum.None,\n      layoutDefaults.media.enable\n    );\n    newLayout.media.template = config[ViewUI.Media];\n\n    newLayout.fullscreen.enable = setConfig(\n      config[ViewUI.Fullscreen],\n      layoutDefaults.fullscreen.enable\n    );\n\n    newLayout.help.enable = setConfig(\n      config[ViewUI.Help],\n      layoutDefaults.help.enable\n    );\n\n    newLayout.description.enable = setConfig(\n      config[ViewUI.Description],\n      layoutDefaults.description.enable\n    );\n\n    newLayout.titleOnly.enable = setConfig(\n      config[ViewUI.TitleOnly],\n      layoutDefaults.titleOnly.enable\n    );\n\n    newLayout.camera.enable = setConfig(\n      config[ViewUI.Camera],\n      layoutDefaults.camera.enable\n    );\n\n    newLayout.search.enable = setConfig(\n      config[ViewUI.Search],\n      layoutDefaults.search.enable\n    );\n\n    newLayout.presenter.enable = setConfig(\n      config[ViewUI.Presenter],\n      layoutDefaults.presenter.enable\n    );\n\n    newLayout.menu.enable = setConfig(\n      config[ViewUI.Menu],\n      layoutDefaults.menu.enable\n    );\n\n    newLayout.logo.enable = setConfig(\n      config[ViewUI.Logo],\n      layoutDefaults.logo.enable\n    );\n\n    newLayout.logo.isHyperLink = setConfig(\n      config.logoIsHyperLink,\n      layoutDefaults.logo.isHyperLink\n    );\n\n    newLayout.internetExplorerWarning.enable = setConfig(\n      config.internetExplorerWarning,\n      layoutDefaults.internetExplorerWarning.enable\n    );\n\n    newLayout.undo.enable = setConfig(\n      config[ViewUI.Undo],\n      layoutDefaults.undo.enable\n    );\n\n    newLayout.labels.enable = setConfig(config[ViewUI.Labels], layoutDefaults.labels.enable);\n    newLayout.labelList.enable = setConfig(config[ViewUI.LabelList], layoutDefaults.labelList.enable);\n    newLayout.chapterList.enable = setConfig(config[ViewUI.ChapterList], layoutDefaults.chapterList.enable);\n\n    newLayout.audio.enable = setConfig(config[ViewUI.Audio], layoutDefaults.audio.enable);\n    newLayout.reset.enable = setConfig(config[ViewUI.Reset], layoutDefaults.reset.enable);\n\n    newLayout.column.enable = setConfig(config[ViewUI.Column], layoutDefaults.column.enable);\n    newLayout.drawer.enable = setConfig(config[ViewUI.Drawer], layoutDefaults.drawer.enable);\n\n    newLayout.anatomyLabels.enable = setConfig(config[ViewUI.AnatomyLabels], layoutDefaults.anatomyLabels.enable);\n    newLayout.tutorial.enable = setConfig(config[ViewUI.Tutorial], layoutDefaults.tutorial.enable);\n    newLayout.whiteboard.enable = setConfig(config[ViewUI.Whiteboard], layoutDefaults.whiteboard.enable);\n\n    newLayout.visibilityLayers.enable = setConfig(config[ViewUI.VisibilityLayers], layoutDefaults.visibilityLayers.enable);\n\n    newLayout.contextActions.enable = setConfig(config[ViewUI.ContextActions], layoutDefaults.contextActions.enable);\n\n    return newLayout;\n  }\n\n\n  export function getScrollSetting(widgetConfig: WidgetUrlConfig) {\n    if (widgetConfig['disable-scroll']) {\n      return ScrollModeEnum.DoNotCapture;\n    }\n\n    if (widgetConfig['disable-scroll.alert'] || widgetConfig['disable-scroll.overlay']) {\n      return ScrollModeEnum.DoNotCaptureShowMessage;\n    }\n\n    return ScrollModeEnum.Capture;\n  }\n\n  export function getUsePrintImage(widgetConfig: WidgetUrlConfig) {\n    return widgetConfig['ui-print-image'] === true;\n  }\n\n  export function getInteractType(widgetConfig: WidgetUrlConfig, interactActive: boolean, currentInteractType: InteractTypeEnum) {\n    const isInteractActive =\n      widgetConfig['initial.play'] ||\n      widgetConfig['initial'] ||\n      widgetConfig['initial.button'] ||\n      widgetConfig['initial.hand'] ||\n      widgetConfig['initial.hand-hint'] ||\n      interactActive;\n\n    const interactType = (() => {\n      switch (true) {\n        case widgetConfig['initial']:\n        case widgetConfig['initial.button']:\n          return InteractTypeEnum.Button;\n\n        case widgetConfig['initial.hand']:\n        case widgetConfig['initial.hand-hint']:\n          return InteractTypeEnum.Hand;\n\n        case widgetConfig['initial.play']:\n          return InteractTypeEnum.Play;\n\n        default:\n          return currentInteractType;\n      }\n    })();\n\n    return { interactType, isInteractActive };\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { HttpClient, HttpErrorResponse } from '@angular/common/http';\nimport { Observable, of, throwError } from 'rxjs';\nimport { map, tap, catchError } from 'rxjs/operators';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class WikiService {\n  \n  private wikiCache = new Map<string, string>();\n\n  constructor(private http: HttpClient) { }\n\n  getWikiText(name: string, fromCache = true): Observable<string> {\n    if (fromCache && this.wikiCache.has(name)) { // read from cache\n      const description = this.wikiCache.get(name);\n      return of(description);\n    } else { // live request      \n      return this.http.get(`/search/wiki?name=${name}`)\n        .pipe(\n          // get description\n          map((response: any) => response.description),\n          // special case: catch + cache 404\n          catchError((err: HttpErrorResponse) => err.status === 404 ? of('') : throwError(err)),\n          // add cache entry\n          tap((description) => this.wikiCache.set(name, description))\n        );\n    }\n  } \n}\n","import { SetXrayMode } from '../engine/state/engine.actions';\nimport { Store } from '@ngxs/store';\nimport { EngineService } from '../engine/engine.service';\nimport { EventsEnum } from '../engine/models/events.enum';\n\nexport function disableXrayMode(store: Store, engineService: EngineService): true {\n  store.dispatch(new SetXrayMode(false));\n  engineService.fireEvent(EventsEnum.SceneXrayDisabled, undefined);\n  return true;\n}\n","import { Injectable } from '@angular/core';\nimport { ChapterModel } from './models/chapter.model';\nimport { plainToClass, classToClass } from 'class-transformer';\nimport { uuid } from '../shared/uuid';\nimport { SerializeChapterService } from 'src/app/edit/serialize/chapter/serialize-chapter.service';\nimport { HotspotModel } from './models/labels/hotspot.model';\nimport { BackgroundModel } from '../engine/models/background.model';\nimport { LabelsService } from './labels.service';\nimport { omit, isEmpty, mapKeys } from 'lodash';\nimport { LabelThemeEnum } from './models/labels/label-theme.enum';\nimport { HotspotThemesEnum } from './models/labels/hotspot.themes.enum';\nimport { ChapterUtils } from '../shared/chapter-utils';\nimport { defaultClippingPlanes } from './state/chapters/default-clipping-planes';\nimport { directionForClipId } from './models/clipping-plane.model';\nimport { EngineService } from '../engine/engine.service';\nimport { hasShownAncestor, hasShownSuccessor } from '../engine/state/nodes/build-node-state';\nimport { VisibilityLayersModel, VisibilityLayerModel } from './models/visibility-layers.model';\n\ndeclare const Human: any;\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class ChapterService {\n  \n  constructor(\n    private engineService: EngineService,\n    private serializeChapterService: SerializeChapterService,\n    private labelService: LabelsService\n  ) { }\n\n  // Update engine with added chapter\n  addChapterToEngine(chapter: ChapterModel, insertIndex: number) {\n    // get chapter data from chapter model\n    const chapterIdMap = ChapterUtils.makeChapterIdMap([chapter], false);\n    const namespaceMap = {};\n    const storyLabels = [];\n    const serialized = this.serializeChapterService.serializeSingleChapter(\n      chapter,\n      namespaceMap,\n      storyLabels,\n      chapterIdMap\n    );\n    const chapterData = serialized;\n    \n    // copy the synchronization to the chapterData before building branch\n    chapterData.synchronization = JSON.parse(JSON.stringify(chapter.synchronization));\n    \n    // create the branch from modificed data and add to timeline\n    const branch = new Human.timeline.BranchTimeline(chapterData);\n    \n    Human.timeline.activeRoot.addChapter(branch, {rebuild: true, position: insertIndex });\n  }\n  \n  // Update engine to remove chapter. This does not update application state, that \n  // is handled separately in story.state.ts\n  removeChapterFromEngine(chapter: ChapterModel) {\n    Human.timeline.activeRoot._chapters = Human.timeline.activeRoot._chapters\n      .filter(_chapter => _chapter.id !== chapter.id);\n\n      Human.timeline.activeRoot.build();\n  }\n\n  // make a copy of the chapter model\n  copyChapter(chapter: ChapterModel, newChapterId: string): ChapterModel {\n    // new object and new identifications\n    const chapterCopy = classToClass(chapter);\n    \n    // generate new id\n    chapterCopy.id = newChapterId;\n\n    // generate new ids for each label\n    chapterCopy.labels.forEach((label) => {\n      label.id = uuid.idWithPrefix('label');\n      label.chapterId = chapterCopy.id;\n    });\n\n    // copy ready state\n    chapterCopy.readyState = {model: true, animation: true};\n\n    return chapterCopy;\n  }\n  // return the curent chapter id\n  getCurrentChapterId(): string {\n    return Human.timeline.activeRoot._nowBranch.id;\n  }\n\n  // create chapterModel from human branch objects\n  fromHumanChapter(humanModuleData: any, storyType: string, humanChapter: any, idx: number): ChapterModel {\n    // work with a copy;\n    const chapterData = {...humanChapter}; \n\n    const humanChapterData = humanModuleData.chapters[idx];\n\n    // copy over per chapter environment data form humanModuleData\n    chapterData.environment = {...humanChapterData.environment};\n\n    // copy over per chapter transitions\n    chapterData.transitions = {...humanChapterData.transitions};\n\n    // copy over transparencyMode\n    if (humanChapterData.transparencyMode) {\n      chapterData.transparencyMode = humanChapterData.transparencyMode;\n    }\n\n    // copy over showObjects\n    chapterData.showObjects = {...humanModuleData.chapters[idx].showObjects};\n    chapterData.pickThroughObjects = {...humanModuleData.chapters[idx].pickThroughObjects};\n\n    // ensure every chapter has an id\n    if (!chapterData.id) {\n      chapterData.id = uuid.idWithPrefix('chapter');\n    }\n\n    // reformat timelinemaps\n    let animated = false;\n    chapterData.timelineMap = Object.values(humanChapter.maps).map((mapData: any) => {\n      if (mapData.data.timeline.id !== 'dummy') {\n        animated = true;\n      }\n      return {\n        start: mapData.start,\n        end: mapData.end,\n        data: {\n          timeline: mapData.data.timeline.id,\n          start: mapData.data.start,\n          end: mapData.data.end,\n          fit: mapData.data.fit || false,\n          onEnd: mapData.data.onEnd\n        }\n      };\n    });\n    delete chapterData.maps;\n\n    // reformat animation -> ui\n    let playCount = 0; // default to scrub\n    const looping = humanChapter.animation ? humanChapter.animation.loop : false;\n    if (animated && looping) {\n      playCount = -1;\n    } else if (animated && !looping) {\n      playCount = 1;\n    }\n    chapterData.ui = humanChapter.ui && !isEmpty(humanChapter.ui) ? humanChapter.ui : {'play': {'count': playCount}};\n\n    // convert annotations to labels\n    \n    const theme = LabelThemeEnum.Annotation;\n\n    const annotationLabels = [...chapterData.annotations || []].map((annotation) => {\n      const label = this.labelService.deserializeAnnotation(annotation, chapterData, theme);\n      return label;\n    });\n\n    // filter and convert hotspots to labels\n    const legacyHotspots = [];\n    const hotspotGroups = this.groupHotspots([...chapterData.hotspots || []].filter((hotspot) => {\n      const convertable = this.labelService.filterHotspot(humanModuleData, humanChapter, hotspot);\n      if (!convertable) {\n        legacyHotspots.push(hotspot);\n      } else {\n        if (!hotspot.theme) {\n          // set default theme by story type\n          hotspot.theme = storyType === 'module' ? HotspotThemesEnum.studioNext : HotspotThemesEnum.classicHotspot;\n        }\n      }\n      return convertable;\n    }));\n\n    const hotspotLabels = hotspotGroups.map((hotspotGroup) => this.labelService.deserializeHotspots(humanModuleData, humanChapter, idx, ...hotspotGroup));\n    chapterData.labels = [...annotationLabels, ...hotspotLabels];\n    delete chapterData.annotations;\n\n    // reformat chapter background\n    chapterData.background = BackgroundModel.deserialize(humanChapter.background);\n\n    // return instance of ChapterModel\n    const chapter = plainToClass(ChapterModel, chapterData as Object);\n    chapter.hotspots = legacyHotspots;\n    chapter.readyState = {model: false, animation: false};\n\n    // set default clipping plane data if none \n    // boundaries are set later, because they haven't been calculated by the engine yet.\n    chapter.clippingPlanes = isEmpty(chapter.clippingPlanes)\n      ? defaultClippingPlanes\n      : this.sanitizeClippingPlanes(chapter.clippingPlanes);\n    \n      // legend\n    const legend = humanChapterData.legend || [];\n    chapter.legend = [...legend];\n\n    // visibilityLayers\n    chapter.visibilityLayers = \n      this.buildVisibilityLayers(humanChapterData.visibilityLayers, chapter.showObjects);\n\n    chapter.colorRecipeObjects = humanChapterData.colorRecipeObjects;\n\n    // Content Blocks\n    const contentBlocks = humanChapterData.contentBlocks || [];\n    chapter.contentBlocks = [...contentBlocks];\n\n    return chapter;\n  }\n\n  hasVisibilityLayers(visibilityLayers: VisibilityLayerModel[]): boolean {\n    return Array.isArray(visibilityLayers) && visibilityLayers.length > 0;\n  }\n\n  private buildVisibilityLayers(_visibilityLayers: any, showObjects: object): VisibilityLayersModel {\n    const visibilityLayers = { src: {}, current: {} };\n\n    if (\n      _visibilityLayers && this.hasVisibilityLayers(_visibilityLayers.layers)\n    ) {\n      \n      const initIndex = _visibilityLayers.initIndex || 0;\n\n      const unpackedLayers = this.unpackLayers(_visibilityLayers.layers);\n      const shownObjectsSet = this.buildShownObjectsSet(showObjects);\n\n      const currentLayers = this.buildCurrentLayers(\n        unpackedLayers,\n        shownObjectsSet\n      );\n\n      visibilityLayers.src = {\n        layers: _visibilityLayers.layers,\n        initIndex: initIndex\n      };\n\n      visibilityLayers.current = { \n        layers: currentLayers,\n        index: initIndex,\n        position: 0\n      };\n    }\n\n    return visibilityLayers;\n  }\n\n  private buildShownObjectsSet (showObjects: object): Set<string> {\n    const graph = this.engineService.getSceneGraph(Human.scene.rootObjects);\n\n    const shownObjects = Object.keys(graph.nodes).filter((objectId) => {\n      return hasShownAncestor(graph, objectId, showObjects) || hasShownSuccessor(graph, objectId, showObjects);\n    });\n\n    return new Set(shownObjects);\n  }\n\n  // Unpack layer objects to their respective leaves, return new deep copy\n  private unpackLayers (layers: VisibilityLayerModel[]): VisibilityLayerModel[] {\n    const srcLayers = [];\n\n    layers.forEach((layer) => {\n      let objectIds = [];\n\n      layer.objectIds.forEach(objectId => {\n        const leaves = Human.scene.objects[objectId].getLeafObjects();\n        objectIds = objectIds.concat(leaves.map(leaf => leaf.objectId));\n      });\n\n      const newLayer = { name: layer.name, objectIds: objectIds };\n      srcLayers.push(newLayer);\n    });\n\n    return srcLayers;\n  }\n\n  private buildCurrentLayers (srcLayers: VisibilityLayerModel[], shownObjectsSet: Set<string>): VisibilityLayerModel[] {\n    const currentLayers = [];\n    \n    srcLayers.forEach((layer, layerIndex) => {\n      let layerBuilt = false;\n\n      layer.objectIds.forEach((objectId) => {\n        if (shownObjectsSet.has(objectId)) {\n\n          if (layerBuilt) {\n            currentLayers[ currentLayers.length - 1 ].objectIds.push(objectId);\n          } else {\n\n            const newLayer = {\n              name: srcLayers[layerIndex].name,\n              objectIds: [objectId]\n            };\n\n            currentLayers.push(newLayer);\n            layerBuilt = true;\n          }\n        }\n      });  \n    });\n\n    return currentLayers;\n  }\n\n  private sanitizeClippingPlanes(clippingPlanes: {clips: {[x: string]: any}, boundary?: any}) {\n    const enabled = Object.values(clippingPlanes.clips).some(c => c.progress > 0);\n    const clips = mapKeys(clippingPlanes.clips, (value, key) => {\n      return directionForClipId[key] || key;\n    });\n\n    return {\n      ...clippingPlanes,\n      clips,\n      enabled\n    } as ChapterModel['clippingPlanes'];\n  }\n\n  // two hotspots can be combined into one label \n  private groupHotspots(hotspots: HotspotModel[]): Array<Array<HotspotModel>> {\n    const hotspotGroups: {[key: string]: any[]} = {};\n    \n    // helper functions to key hotspots that are reciprocal\n    const keyPosition = (hotspot: HotspotModel): string => {\n      if (hotspot.primitiveIndex) {\n        return hotspot.primitiveIndex.toFixed(0);\n      } else if (hotspot.pos) {\n        return hotspot.pos.map((c) => c.toFixed(3)).join(':');\n      } else {\n        return Math.random().toFixed(3);\n      }\n      \n    };\n\n    const keyType = (type: string): string => {\n      return RegExp('^circle-(plus|minus)').test(type) ? 'pair' : 'single';\n    };\n\n    // group hotspots by key\n    hotspots.forEach((hotspot) => {\n      const groupKey = [keyType(hotspot.type), hotspot.objectId, keyPosition(hotspot)].join('|');\n      if (groupKey in hotspotGroups) {\n        hotspotGroups[groupKey].push(hotspot);\n      } else {\n        hotspotGroups[groupKey] = [hotspot];\n      }\n    });\n\n    return Object.values(hotspotGroups);\n  }\n}\n","<app-label class=\"context-label\" [label]=\"label\" [emitEvents]=\"false\">  \n    <!-- node actions -->\n    <div *ngIf=\"node\" class=\"context-label__actions\" label-actions>\n      <ng-content></ng-content>\n      <app-node-actions\n        *ngIf=\"enableActions\"\n        eventCategory=\"Context Node\"\n        [node]=\"node\"\n        theme=\"light\">\n      </app-node-actions>\n    </div>\n\n    <ng-container *ngIf=\"enableInfo\" label-more>\n      <a\n        @show\n        *ngIf=\"node && node.description\"\n        class=\"context-label__more\"\n        (click)=\"handleReadMoreClick()\">Read More...</a>\n    </ng-container>\n</app-label>","import { Component, OnInit, Input, OnDestroy, ChangeDetectionStrategy, ChangeDetectorRef } from '@angular/core';\nimport { LabelModel } from 'src/app/story/models/labels/label.model';\nimport { Store, Select, Actions, ofActionCompleted } from '@ngxs/store';\nimport { ViewTreeNode } from 'src/app/engine/models/view.tree-node';\nimport { EngineState } from 'src/app/engine/state/engine.state';\nimport { Subject, Observable } from 'rxjs';\nimport { EngineService } from 'src/app/engine/engine.service';\nimport { get } from 'lodash';\nimport { ViewService } from 'src/app/view/view.service';\nimport { takeUntil } from 'rxjs/operators';\nimport { transition, trigger, sequence, style, animate } from '@angular/animations';\nimport { SetNodeInfo } from 'src/app/engine/state/engine.actions';\n\n@Component({\n  selector: 'app-context-label',\n  templateUrl: './context-label.component.html',\n  styleUrls: ['./context-label.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  animations: [\n    trigger('show', [\n      transition(':enter', [\n        sequence([\n          style({ \n            height: '0'\n          }),\n          animate('125ms ease-in-out', style({ \n            height: '*'\n          }))\n        ])\n      ])\n    ])\n  ]\n})\nexport class ContextLabelComponent implements OnInit, OnDestroy {\n  // ---------- Observables ----------\n  @Select(EngineState.getQuerying)\n  querying$: Observable<boolean>;\n  \n\n  \n  // ---------- Input / Output ----------\n  @Input()\n  set label(value: LabelModel) {\n    this._label = value;\n    this.setLabelNode();\n  }\n  get label(): LabelModel {\n    return this._label;\n  }\n\n  @Input()\n  enableInfo: boolean;\n\n  @Input()\n  enableActions: boolean;\n  \n\n  \n  // ---------- Class Variables ----------\n  allowReadMore: boolean;\n  node: ViewTreeNode;\n\n  private _label: LabelModel;\n  private ngUnsubscribe = new Subject();\n  \n  constructor(\n    private store: Store,\n    private actions: Actions,\n    private engineService: EngineService,\n    private viewService: ViewService,\n    private changeDetectorRef: ChangeDetectorRef\n  ) { }\n  \n\n  \n  // ---------- Lifecycle Events ----------\n  ngOnInit() {\n    this.initInfoListeners();\n  }\n\n  ngOnDestroy() {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n  \n\n  \n  // ---------- Class Methods ----------\n  setLabelNode() {\n    const objectId = get(this.label, 'objectId');\n\n    if (objectId) {\n      const viewGraph = this.store.selectSnapshot(EngineState.getViewGraph);\n      this.node = this.engineService.getNode(viewGraph, objectId);\n\n    } else {\n      this.node = null;\n    }\n    \n    this.changeDetectorRef.markForCheck();\n  }\n\n  initInfoListeners() {\n    // mark \"dirty\" check for node updates\n    this.actions\n      .pipe(\n        ofActionCompleted(SetNodeInfo),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(() => {\n        this.setLabelNode();\n      });\n  }\n\n  handleReadMoreClick() {\n    if (this.node) {\n      this.viewService.toggleNodeInfo(true);\n    }\n  }\n}\n","<div \n#pin\nclass=\"label-pin\"\n[ngClass]=\"{\n  'label-pin--light': labelTheme === labelThemeEnum.StudioNext,\n  'label-pin--dark': labelTheme === labelThemeEnum.Annotation,\n  'label-pin--none': label.pinType === labelPinType.None,\n  'label-pin--selected': selected\n}\">\n\n<!-- Pins: Dark Theme -->\n<ng-container *ngIf=\"labelTheme === labelThemeEnum.Annotation;else lightPins\">\n  <img draggable=\"false\" *ngIf=\"label.pinType == labelPinType.Default\" alt=\"\" src=\"./assets/images/labels/circle-dark.svg\" class=\"label-pin__image\">\n  <img draggable=\"false\" *ngIf=\"label.pinType == labelPinType.Sequential\" alt=\"\" src=\"./assets/images/labels/circle-dark.svg\" class=\"label-pin__image\">\n  <img draggable=\"false\" *ngIf=\"label.pinType === labelPinType.Plus || (label.pinType === labelPinType.PlusMinus && !selected)\" alt=\"\" src=\"./assets/images/labels/circle-plus-dark.svg\" class=\"label-pin__image\">\n  <img draggable=\"false\" *ngIf=\"label.pinType === labelPinType.Minus || (label.pinType === labelPinType.PlusMinus && selected)\" alt=\"\" src=\"./assets/images/labels/circle-minus-dark.svg\" class=\"label-pin__image\">\n</ng-container>\n\n<!-- Pins: Light Theme -->\n<ng-template #lightPins>\n  <img draggable=\"false\" *ngIf=\"label.pinType == labelPinType.Default\" alt=\"\" src=\"./assets/images/labels/circle.svg\" class=\"label-pin__image\">\n  <img draggable=\"false\" *ngIf=\"label.pinType == labelPinType.Sequential\" alt=\"\" src=\"./assets/images/labels/circle.svg\" class=\"label-pin__image\">\n  <img draggable=\"false\" *ngIf=\"label.pinType === labelPinType.Plus || (label.pinType === labelPinType.PlusMinus && !selected)\" alt=\"\" src=\"./assets/images/labels/circle-plus.svg\" class=\"label-pin__image\">\n  <img draggable=\"false\" *ngIf=\"label.pinType === labelPinType.Minus || (label.pinType === labelPinType.PlusMinus && selected)\" alt=\"\" src=\"./assets/images/labels/circle-minus.svg\" class=\"label-pin__image\">\n</ng-template>\n\n<!-- Sequence -->\n<ng-container *ngIf=\"label.pinType === labelPinType.Sequential\">\n  <div \n    class=\"label-pin__text\"\n    [ngClass]=\"{\n      'label-pin__text--white': labelTheme === labelThemeEnum.StudioNext,\n      'label-pin__text--black': labelTheme === labelThemeEnum.Annotation\n    }\">\n    {{ sequence }}\n  </div>\n</ng-container>\n\n<!-- Glow -->\n<div class=\"label__glow\"></div>\n</div>","import {\n  ChangeDetectionStrategy,\n  ChangeDetectorRef,\n  Component,\n  Input,\n  OnDestroy,\n  OnInit,\n} from '@angular/core';\nimport { Store } from '@ngxs/store';\nimport { Subject } from 'rxjs';\nimport { debounceTime, takeUntil } from 'rxjs/operators';\nimport { LabelPinType } from 'src/app/story/models/labels/label-pin-type.enum';\nimport { LabelThemeEnum } from 'src/app/story/models/labels/label-theme.enum';\nimport { LabelModel } from 'src/app/story/models/labels/label.model';\nimport { StoryLabelsState } from 'src/app/story/state/labels/story.labels.state';\n\n@Component({\n  selector: 'app-label-pin',\n  templateUrl: './label-pin.component.html',\n  styleUrls: ['./label-pin.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class LabelPinComponent implements OnInit, OnDestroy {\n  labelPinType = LabelPinType;\n  labelThemeEnum = LabelThemeEnum;\n\n  @Input()\n  public get label(): LabelModel {\n    return this._label;\n  }\n  public set label(value: LabelModel) {\n    this._label = value;\n  }\n  private _label: LabelModel;\n\n  @Input()\n  labelTheme: LabelThemeEnum = LabelThemeEnum.StudioNext;\n\n  @Input()\n  selected = false;\n\n  sequence: string | number;\n  ngUnsubscribe = new Subject();\n\n  constructor(\n    private store: Store,\n    private changeDetectorRef: ChangeDetectorRef\n  ) {}\n\n  ngOnInit() {\n    this.initPinSequence();\n  }\n\n  ngOnDestroy() {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n  initPinSequence() {\n    this.store.select(StoryLabelsState.getChapterLabels)\n      .pipe(\n        takeUntil(this.ngUnsubscribe),\n        debounceTime(100)\n      )\n      .subscribe((labels) => {\n        // Wrapped in a timeout to ensure compatibility with form elements \n        this.sequence = this.store.selectSnapshot(StoryLabelsState.getLabelSequence(this.label));\n        this.changeDetectorRef.markForCheck();\n      });\n  }\n}\n","<div class=\"label-container\" data-test=\"labelContainer\" #labelContainerEl aria-hidden=\"true\">\n  <div \n    #labelEl\n    data-test=\"labelElement\" \n    class=\"label\"\n    [ngClass]=\"{\n      'label--selected': (selectedLabel$ | async)?.id === label.id,\n      'label--glow': label.pinGlow,\n      'label--annotation': label.theme === 'annotation',\n      'label--classic': label.theme === 'classic',\n      'label--invert': isBackgroundDark,\n      'label--studio': label.theme === 'studioNext',\n      'label--context': label.theme === 'context',\n      'label--screenshot-mode': screenshotMode\n    }\">\n    \n    <!-- Pin -->\n    <div #pin class=\"label__pin\">\n      <app-label-pin\n        [label]=\"label\"\n        [labelTheme]=\"label.theme\"\n        [selected]=\"(selectedLabel$ | async)?.id === label.id\"></app-label-pin>\n      \n      <!-- Glow -->\n      <div class=\"label__glow\"></div>\n    </div>\n\n    <!-- Wire -->\n    <div class=\"label__wire\" [ngClass]=\"{'label__wire--collapse': isCollapsed || tagCollapsed || label.hideWire }\" #wire></div>\n\n    <!-- Tag -->\n    <div \n      #tag\n      class=\"label__tag\"\n      [ngClass]=\"{\n        'label__tag--collapse': isCollapsed || tagCollapsed,\n        'label__tag--collapsible': label.collapseDescription,\n        'label__tag--floating': label.hideWire,\n        'label__tag--draggable': tagDraggable\n      }\">\n\n      <div class=\"label__header\">\n        <div class=\"label__title html\" #title [innerHTML]=\"label.title | markdown\"></div>\n        <div class=\"label__more\" *ngIf=\"hasContent && label.collapseDescription\">\n          <app-icon icon=\"caret-right\"></app-icon>\n        </div>\n        \n        <!-- Actions -->\n        <div class=\"label__actions\" appEventFence>\n          <ng-content select=\"[label-actions]\"></ng-content>\n        </div>\n      </div>\n\n      <!-- Body -->\n      <div \n        class=\"label__body html\" \n        *ngIf=\"hasContent\"\n        [ngClass]=\"{'label__body--collapse': isCollapsed || descriptionCollapsed}\">\n\n          <!-- content blocks -->\n          <div *ngIf=\"label.contentBlocks\" class=\"mv-1\" appEventFence>\n            <app-content-blocks [contentBlocks]=\"label.contentBlocks\" [layout]=\"'compact'\">\n            </app-content-blocks>\n          </div>\n\n          <!-- description -->\n          <div *ngIf=\"label.description\" [innerHTML]=\"label.description | markdown\">\n          </div>\n      </div>\n\n      <!-- More -->\n      <ng-content select=\"[label-more]\"></ng-content>\n\n    </div>\n  </div>\n</div>","// tslint:disable:no-bitwise\n\nimport { \n  Component,\n  OnInit,\n  Renderer2,\n  ElementRef,\n  Input,\n  ViewChild,\n  ChangeDetectionStrategy,\n  ChangeDetectorRef,\n  OnDestroy,\n  AfterViewInit } from '@angular/core';\nimport { Store, Select, Actions, ofActionDispatched, ofActionCompleted } from '@ngxs/store';\nimport { LabelModel } from 'src/app/story/models/labels/label.model';\nimport { MarkerModel } from 'src/app/story/models/marker.model';\n\nimport { filter, takeUntil, map, distinctUntilChanged, pairwise } from 'rxjs/operators';\nimport { EngineState } from 'src/app/engine/state/engine.state';\nimport { EngineService } from 'src/app/engine/engine.service';\nimport { SelectLabel, SetLabel, SetLabelOffset } from 'src/app/story/state/labels/story.labels.actions';\nimport { EnginePositionModel } from 'src/app/engine/models/engine-position.model';\nimport { Observable, Subject, Subscription, BehaviorSubject, fromEvent } from 'rxjs';\n\nimport * as Hammer from 'hammerjs';\nimport { HitModel } from 'src/app/engine/models/hit.model';\nimport { CameraService } from 'src/app/engine/camera.service';\nimport { StoryLabelsState } from 'src/app/story/state/labels/story.labels.state';\nimport { SetCamera, SetZoomed } from 'src/app/engine/state/camera/engine.camera.actions';\nimport { EngineCameraState } from 'src/app/engine/state/camera/engine.camera.state';\nimport { LabelPinType } from 'src/app/story/models/labels/label-pin-type.enum';\nimport { LabelSequentialType } from 'src/app/story/models/labels/label-sequential-type.enum';\nimport { LabelThemeEnum } from 'src/app/story/models/labels/label-theme.enum';\nimport { ErrandType } from 'src/app/story/models/errands/errand-type.enum';\nimport { ErrandInterface } from 'src/app/story/models/errands/errand.model';\nimport { get, isEqual } from 'lodash';\nimport { EventsEnum } from 'src/app/engine/models/events.enum';\nimport { LabelsService } from 'src/app/story/labels.service';\nimport { FlyToObject } from 'src/app/engine/state/engine.actions';\nimport { StoryChaptersState } from 'src/app/story/state/chapters/story.chapters.state';\nimport { BackgroundModel } from 'src/app/engine/models/background.model';\nimport { ColorUtils } from 'src/app/shared/libraries/colors/colors';\nimport { LabelCollapseModeEnum } from 'src/app/story/models/labels/label-collapse-mode';\nimport { isIE11 } from 'src/app/shared/detect-ie11';\nimport { TakeChapterPicture, TakeChapterPictureSuccess } from 'src/app/story/state/chapters/story.chapters.actions';\nimport { ContextLabelId } from 'src/app/story/state/labels/story.labels.state.model';\n\ndeclare const Human: any;\n\nconst fullOpacity = 1; \nconst fadeStartAngle = 80;\nconst maxViewAngle = 100;\nconst fadeRange = maxViewAngle - fadeStartAngle;\n\n// Hardcoded reference number. The actual pin width is set in label.component.scss.\nconst pinDiameter = 32;\nconst pinRadius = pinDiameter / 2;\n\ninterface DisplayUpdated {\n  id: string;\n  inView: boolean;\n  shown: boolean;\n  objectShown: boolean;\n}\n\ninterface PositionUpdated {\n  id: string;\n  canvasPos: { x: number, y: number };\n  occluded: boolean;\n}\n\n@Component({\n  selector: 'app-label',\n  templateUrl: './label.component.html',\n  styleUrls: ['./label.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class LabelComponent implements OnInit, AfterViewInit, OnDestroy {\n  labelPinType = LabelPinType;\n  labelSequentialType = LabelSequentialType; \n\n  @ViewChild('labelContainerEl', { static: true }) labelContainerRef: ElementRef;\n  @ViewChild('labelEl', { static: true }) labelRef: ElementRef;\n  @ViewChild('wire', { static: true }) wireRef: ElementRef;\n  @ViewChild('tag', { static: true }) tagRef: ElementRef;\n  @ViewChild('pin', { static: true }) pinRef: ElementRef;\n  @ViewChild('title', { static: true }) titleRef: ElementRef;\n\n  @Select(EngineState.getEnginePosition)\n  enginePosition$: Observable<EnginePositionModel>;\n\n  @Select(StoryLabelsState.getSelectedLabel)\n  selectedLabel$: Observable<LabelModel>;\n\n  @Select(StoryChaptersState.getSelectedChapterBackground)\n  background$: Observable<BackgroundModel>;\n\n  @Input()\n  public get label(): LabelModel {\n    return this._label;\n  }\n  public set label(value: LabelModel) {\n    const isValueNull = Object.keys(value).length === 0;\n    const isLabelNull = this.label == null || Object.keys(this.label).length === 0;\n    \n    if (isValueNull && !isLabelNull) {\n      this._label = {...value};\n      this.destroyLabel();\n    } else if (!isValueNull) {\n      this._label = {...value};\n      this.initLabel(this.label);\n    }\n  }\n  private _label: LabelModel;\n\n  index: any; \n\n  @Input()\n  collapsed = false;\n\n  @Input()\n  collapsedMode: LabelCollapseModeEnum = LabelCollapseModeEnum.None;\n\n  get isCollapsed(): boolean {\n    if (this.collapsedMode === LabelCollapseModeEnum.Toggle) {\n      return this.collapsed && !this.isSelected;\n    } else {\n      return this.collapsed;\n    }\n  }\n\n  get hasContent(): boolean {\n    return this.labelsService.hasContent(this.label);\n  }\n\n  @Input()\n  theme = 'classic';\n\n  @Input()\n  pinDraggable = true;\n\n  @Input()\n  tagDraggable = true;\n\n  @Input()\n  emitEvents = true;\n\n  // Cache position for performance\n  enginePosition: EnginePositionModel = null; \n\n  marker: MarkerModel;\n\n  // Label visibility\n  depth: Number;\n  shown: boolean;\n  objectShown: boolean;\n  isSelected = false;\n\n  // Some labels change styles on dark background\n  isBackgroundDark = false;\n\n  // Local expanded / collapsed references\n  descriptionCollapsed = false;\n  tagCollapsed = false;\n\n  // Scale\n  scale = 1;\n\n  // Pin\n  pinDragging = false;\n\n  // Wire\n  hasWire: boolean;\n\n  dragLabelStartEvent: HammerInput;\n  cachedTagOffset: [number, number];\n\n  // Screenshot mode (disables some effects)\n  screenshotMode = false;\n\n  // Reference to hammer event managers so we can unbind on destroy\n  hammerManagers: HammerManager[] = [];\n\n  object$: Subscription;\n  displayUpdated$ = new Subject<DisplayUpdated>();\n  positionUpdated$ = new Subject<PositionUpdated>();\n\n  private isIE11: boolean;\n\n  private ngUnsubscribe = new Subject();\n\n  constructor(\n    private renderer: Renderer2,\n    private labelsService: LabelsService,\n    private engineService: EngineService,\n    private cameraService: CameraService,\n    private store: Store,\n    private actions: Actions,\n    private changeDetection: ChangeDetectorRef\n  ) {\n    // set IE11 support\n    this.isIE11 = isIE11();\n  }\n\n  ngOnInit() {\n    this.initListeners();\n  }\n\n  ngAfterViewInit() {\n    // We're using HammerJS to handle drag events for better touch compatibility. However\n    // this results in Hammer 'tap' events preceeding Angular 'click' events, which can\n    // lead to duplicate or unexpected click handling. So for labels, all interaction events are \n    // now handled through HammerJS, and initialized below. \n    this.bindTagEvents();\n    this.bindPinEvents();\n    this.bindHoverEvents();\n  }\n\n  ngOnDestroy() {\n    this.destroyLabel();\n\n    this.emitDisplayUpdated({\n      id: this.label.id,\n      inView: false,\n      shown: false,\n      objectShown: this.objectShown\n    });\n\n    // Unsubscribe\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n  destroyLabel() {\n    // Destroy event handlers bound outside of angular\n    this.hammerManagers.forEach(manager => manager.destroy);\n    this.hammerManagers = [];\n\n    // Delete markers in the engine\n    this.deleteMarker(this.marker);\n  }\n\n  initListeners() {\n    // Handle selected label\n    this.selectedLabel$\n      .pipe(takeUntil(this.ngUnsubscribe))\n      .subscribe(label => this.handleLabelSelected(label));\n\n    // Cache local copy of engine position any time it updates, for performance\n    this.enginePosition$\n      .pipe(\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe((position) => {\n        this.enginePosition = position;\n      });\n\n    // An exception of allowing another component to subscribe directly to engine events. \n    // Since marker position changes with any motion from the engine, running events through \n    // the store would create an unneccessary performance overhead. \n    this.engineService.getEvent(EventsEnum.SceneMarkersUpdated)\n      .pipe(\n        filter(() => {\n          return this.label != null && this.enginePosition != null;\n        }),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(() => {\n        this.setCanvasPos();\n      });\n\n    // notify display updates\n    this.displayUpdated$\n      .pipe(\n        // detect change\n        distinctUntilChanged((last, current) => isEqual(last, current)),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe((event) => {\n        this.emitEngineEvent(EventsEnum.HotspotsDisplayUpdated, event);\n      });\n\n    // notify position updates\n    this.positionUpdated$\n      .pipe(\n        // detect change\n        distinctUntilChanged((last, current) => isEqual(last, current)),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe((positionUpdate: PositionUpdated) => {\n        this.emitEngineEvent(EventsEnum.HotspotsPositionUpdated, positionUpdate);\n\n        this.emitEngineEvent(EventsEnum.LabelsMoved, {\n          labelId: positionUpdate.id,\n          canvasPosition: [ positionUpdate.canvasPos.x, positionUpdate.canvasPos.y ],\n          occluded: positionUpdate.occluded || !this.isOnCanvas(),\n        });\n      });\n\n    // Observe background color, ensure appropriate color contrast is applied\n    this.background$\n      .pipe(\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(background => {\n        const outerRGB = background.colors.slice(0, 3) as [number, number, number];\n        const innerRGB = background.colors.slice(4, 7) as [number, number, number];\n        this.isBackgroundDark = !ColorUtils.isLight(outerRGB, innerRGB);\n        this.changeDetection.markForCheck();\n      });\n\n    // Listen for screenshotting, update labels to be screenshot compatible\n    this.actions.pipe(\n      ofActionDispatched(TakeChapterPicture),\n      takeUntil(this.ngUnsubscribe)\n    ).subscribe(() => {\n      this.screenshotMode = true;\n      this.changeDetection.detectChanges();\n    });\n\n    this.actions.pipe(\n      ofActionCompleted(TakeChapterPictureSuccess),\n      takeUntil(this.ngUnsubscribe)\n    ).subscribe(() => {\n      this.screenshotMode = false;\n      this.changeDetection.markForCheck();\n    });\n\n    this.store.select(StoryLabelsState.getLabelSequence(this.label))\n    .pipe(takeUntil(this.ngUnsubscribe))\n    .subscribe((index) => {\n      this.index = index;\n      this.changeDetection.markForCheck(); \n    });\n  }\n\n  bindTagEvents() {\n    // Create a HammerJS manager so we can custom define single and double click\n    const mc = new Hammer(this.tagRef.nativeElement, { domEvents: true });\n\n    \n    mc.get('pan').set({ direction: Hammer.DIRECTION_ALL, threshold: 3 });\n    \n    mc.on('pan', (event) => {\n\n      if (!this.tagDraggable) {\n        return;\n      }\n\n      event.srcEvent.stopPropagation();\n\n      if (!this.cachedTagOffset) {\n        this.cachedTagOffset = this.label.offset;\n      }\n      \n      const offset: [number, number] = [\n        this.cachedTagOffset[0] + event.deltaX,\n        this.cachedTagOffset[1] + event.deltaY\n      ];\n\n      // this.store.dispatch(new SetLabelOffset(this.label.id, offset));\n      this.label.offset = offset;\n\n      if (event.isFinal) {\n        this.cachedTagOffset = null;\n        this.store.dispatch(new SetLabelOffset(this.label.id, offset));\n      }\n    });\n\n    mc.on('tap', (event) => {\n      event.srcEvent.preventDefault();\n      event.srcEvent.stopPropagation();\n\n      // Hack to make expand button work differently from rest of tag.\n      // Normally wouldn't have to do this, but HammerJS creates very strange\n      // event handling loops. \n      if (event.target.parentNode.nodeName === 'BUTTON') {\n        this.toggleDescription();\n        // this.changeDetection.markForCheck();\n      } else {\n        this.selectLabel();\n      }\n    });\n\n    this.hammerManagers.push(mc);\n  }\n\n  bindPinEvents() {\n    // Create a HammerJS manager so we can custom define single and double click\n    const mc = new Hammer(this.pinRef.nativeElement);\n      mc.get('pan').set({ direction: Hammer.DIRECTION_ALL, threshold: 4 });\n      \n      mc.on('pan', (event) => {\n      if (!this.pinDraggable) {\n        return;\n      }\n\n      event.srcEvent.stopPropagation();\n      \n      // While pinDragging is true, setCanvasPos won't fire, which allows us to \n      // change the pin X and Y translation without interference from the engine.\n      this.pinDragging = true;\n\n      let { layerX, layerY} = event.changedPointers[0];\n\n      layerX = layerX - pinRadius;\n      layerY = layerY - pinRadius;\n\n      // Marker is updated by the engine every tick, so we have to kill it or else the engine\n      // will overwrite our changes. \n      if (this.marker) {\n        this.deleteMarker(this.marker);\n      }\n      \n      // Manually update the pin position to the mouse cursor position\n      this.renderer.setStyle(this.labelContainerRef.nativeElement, 'transform', `translate(${layerX}px, ${layerY}px)`);\n\n      if (event.isFinal) {\n        this.pinDragging = false;\n        const label = {...this.label};\n\n        // If the pin is dropped on a node, update the position. Otherwise just revert the pin back to \n        // it's original location.\n        const hit = Human.renderer.pick.pick({ canvasPos: [layerX, layerY], rayPick: true }) as HitModel;\n        const pinOnObject = typeof hit.objectId === 'string';\n        if (pinOnObject) {\n          label.dir = this.cameraService.getDirection(hit);\n          label.objectId = hit.objectId;\n          label.barycentric = [hit.barycentric[0], hit.barycentric[1], hit.barycentric[2]];\n          label.pos = [hit.worldPos[0], hit.worldPos[1], hit.worldPos[2]];\n          label.primitiveIndex = hit.primitiveIndex;\n        }\n        const shouldPreserve = pinOnObject;\n        this.store.dispatch(new SetLabel(label, shouldPreserve));\n      }\n    });\n\n    mc.on('tap', (event) => {\n      event.srcEvent.preventDefault();\n      event.srcEvent.stopImmediatePropagation();\n\n      this.selectLabel();\n    });\n\n    this.hammerManagers.push(mc);\n  }\n\n  bindHoverEvents() {\n    const label = this.labelRef.nativeElement;\n    \n    this.renderer.listen(label, 'mouseenter', () => {\n      this.emitEngineEvent(EventsEnum.HotspotsEntered, { id: this.label.id });\n      this.emitEngineEvent(EventsEnum.LabelsEntered, { labelId: this.label.id });\n    });\n\n    this.renderer.listen(label, 'mouseleave', () => {\n      this.emitEngineEvent(EventsEnum.HotspotsLeft, { id: this.label.id });\n      this.emitEngineEvent(EventsEnum.LabelsLeft, { labelId: this.label.id });\n    });\n  }\n\n  initLabel(label: LabelModel) {\n    this.initMarker(label);\n    this.ensureObjectId(label);\n    this.initObjectSubscription(label);\n    this.initSequentialCheck(label);\n\n    this.descriptionCollapsed = label.collapseDescription;\n    this.tagCollapsed = label.hideTag;\n  }\n\n  initMarker(label: LabelModel) {\n    if (this.marker) {\n      this.deleteMarker(this.marker);\n    }\n\n    this.marker = Human.scene.markers.create({\n      // track marker by label id\n      id: label.id,\n      pos: label.pos,\n      dir: label.dir,\n      objectId: label.objectId,\n      primitiveIndex: label.primitiveIndex,\n      barycentric: label.barycentric,\n      renderableIndex: label.renderableIndex || 0\n    });\n  }\n\n  initSequentialCheck(label: LabelModel) {\n    if (label.pinType === LabelPinType.Sequential) {\n      this.store.select(StoryLabelsState.getLabelSequence(label))\n        .pipe(takeUntil(this.ngUnsubscribe))\n        .subscribe((index) => {\n          this.index = index;\n          this.changeDetection.markForCheck(); \n        });\n    }\n  }\n\n  checkLabelDisplay() {\n    return {\n      id: this.label.id,\n      shown: this.label.shown,\n      inView: this.isOnCanvas(),\n      objectShown: true\n    };\n  }\n\n  // labels should always have an objectId\n  ensureObjectId(label: LabelModel) {\n    if (!label.objectId) {\n      const hit = Human.renderer.pick.pick({ canvasPos: [this.marker.canvasPos[0], this.marker.canvasPos[1]], rayPick: true }) as HitModel;\n      // attach to object: if hit\n      if (hit.objectId) {\n        label.objectId = hit.objectId;\n        label.states.forEach((labelState) => {\n          labelState.errands.forEach((errand) => {\n            if (errand.type === ErrandType.flyToObject) {\n              errand.value = hit.objectId;\n            }\n          });\n        });\n        this.store.dispatch(new SetLabel(label));\n      }\n    }\n  }\n\n  initObjectSubscription(label) {\n    if (this.object$) {\n      this.object$.unsubscribe();\n    }\n\n    // Listen to attached node and check for visibility Don't show labels with\n    // hidden nodes \n    if (label.objectId) {\n      this.object$ = this.store.select(EngineState.getViewGraphNode)\n        .pipe(\n          map(filterFn => filterFn(label.objectId)),\n          filter(node => !!node),\n          takeUntil(this.ngUnsubscribe)\n        )\n        .subscribe(node => {\n          this.objectShown = node.boolState.shown;\n        });\n    }\n  }\n\n  deleteMarker(marker: MarkerModel) {\n    Human.scene.markers.delete(marker.id);\n    this.marker = null;\n  }\n\n  toggleDescription(open?: boolean) {\n    open = (typeof open === 'undefined') ? !this.descriptionCollapsed : open;\n    this.descriptionCollapsed = open;\n  }\n\n  handleLabelSelected(label: LabelModel) {\n    this.isSelected = (label && label.id === this.label.id);\n    const errands = <ErrandInterface[]>get(label, 'states[1].errands');\n    const cameraLocked = this.store.selectSnapshot(EngineCameraState.getLockCamera);\n\n    // Fly to\n    if (this.isSelected && errands && !cameraLocked) {\n      errands.forEach(errand => {\n        switch (errand.type) {\n          case ErrandType.flyToObject:\n            this.flyToObject(errand.value);\n            break;\n\n          case ErrandType.flyToCamera:\n            this.flyToPosition(errand.value);\n            break;\n        }\n\n        this.store.dispatch(new SetZoomed(true));\n      });\n      \n    }\n\n    // Expand\n    const tagEnabled = !!this.label.title || this.hasContent;\n    if (!tagEnabled) {\n      this.tagCollapsed = true;\n    } else if (this.label.expandTag && this.label.hideTag) {\n      this.tagCollapsed = !this.isSelected;\n    } else {\n      this.tagCollapsed = this.label.hideTag;\n    }\n\n    // Show description\n    if (this.label.showDescription && this.label.collapseDescription) {\n      this.descriptionCollapsed = !this.isSelected;\n    } else {\n      this.descriptionCollapsed = this.label.collapseDescription;\n    }\n  }\n\n  flyToObject(objectId) {\n    this.store.dispatch(new FlyToObject(objectId));\n  }\n\n  flyToPosition(cameraPosition) {\n    this.store.dispatch(new SetCamera(cameraPosition));\n  }\n\n  setCanvasPos() {\n    if (this.pinDragging || !this.marker) {\n      return;\n    }\n\n    this.depth = -this.marker.viewPos[2];\n\n    // The position can update the display state via the shown property\n    // Only call if shown has changed\n    const isOccluded = this.isOccluded();\n    const ignoreOcclusion = this.isOcclusionIgnored();\n    const isOnCanvas = this.isOnCanvas();\n    const considerOccluded = isOccluded && !ignoreOcclusion;\n\n    // if the label isn't attached to an object Id, \n    // `this.objectShown` will always be undefined.\n\n    const shown = this.objectShown === undefined\n      ? isOnCanvas && !considerOccluded\n      : isOnCanvas && this.objectShown && !considerOccluded;\n    \n\n    const hasShownChanged = shown !== this.shown;\n    if (hasShownChanged) {\n      this.shown = shown;\n      this.setDisplay(shown);\n    }\n\n    // this.setOpacity(isOccluded); // revisit this\n    this.setElementPosition();\n    this.setElementScale();\n    this.setTagPosition();\n    this.setWirePosition();\n\n    // publish position updates\n    const { 0: x, 1: y } = this.marker.canvasPos;\n    this.positionUpdated$.next({\n      id: this.label.id,\n      canvasPos: { x, y},\n      occluded: considerOccluded\n    });\n  }\n\n  selectLabel() {\n    const previousLabel = this.store.selectSnapshot(StoryLabelsState.getSelectedLabel);\n    // Clicking same label to unselect\n    if (previousLabel && previousLabel.id === this.label.id) {\n      this.store.dispatch(new SelectLabel(null));\n    } else {\n      this.store.dispatch(new SelectLabel(this.label));\n    }\n\n    this.emitEngineEvent(EventsEnum.HotspotsPicked, { id: this.label.id });\n    this.emitEngineEvent(EventsEnum.LabelsPicked, { labelId: this.label.id });\n  }\n\n\n  isOcclusionIgnored() {\n    return this.isSelected || !this.label.occludable;\n  }\n\n  isOccluded(): boolean {\n    return this.depth < 0 || this.marker.occluded;\n  }\n\n  isOnCanvas(): boolean {\n    const { offsetWidth, offsetHeight } = this.labelsService.getLabelContainer().nativeElement;\n    const [x, y] = this.marker.canvasPos;\n    const onCanvas = x > 0 && y > 0 && x < offsetWidth && y < offsetHeight;\n    return onCanvas;\n  }\n\n  /**\n   * Show and hide labels\n   */\n  setDisplay(shown: boolean) {\n    const labelEl = this.labelRef.nativeElement;\n    const display = (shown) ? 'visible' : 'hidden';\n    this.renderer.setStyle(labelEl, 'visibility', display);\n\n    // This is created for the EventsEnum.HotspotsDisplayUpdated event\n    this.emitDisplayUpdated({\n      id: this.label.id,\n      inView: this.isOnCanvas(),\n      shown: shown,\n      objectShown: this.objectShown\n    });\n  }\n\n  setOpacity(isOccluded: boolean) {\n    let opacity = fullOpacity;\n\n    if (!isOccluded) {\n      this.renderer.setStyle(this.labelContainerRef.nativeElement, 'opacity', 1);\n    } else {\n      if (this.marker.viewAngle >= fadeStartAngle) {\n        const angleDiff = this.marker.viewAngle - fadeStartAngle;\n        const scaledOpacity = (angleDiff / fadeRange) * fullOpacity;\n        opacity = Math.max(1 - scaledOpacity, 0);\n      }\n      \n      this.renderer.setStyle(this.labelContainerRef.nativeElement, 'opacity', opacity);\n    }    \n  }\n\n  setElementPosition() {\n    const markerPos = this.marker.canvasPos;\n    this.renderer.setStyle(this.labelContainerRef.nativeElement, 'transform', `translate(${markerPos[0]}px, ${markerPos[1]}px)`);\n  }\n\n  setElementScale() {\n    const labelScale = this.store.selectSnapshot(StoryLabelsState.getLabelScale);\n\n    if (labelScale) {\n      this.scale = labelScale;\n    } else {\n      // Determine scale based on scene width (not page width)\n      const sceneWidth = this.store.selectSnapshot(EngineState.getEnginePosition).width;\n      this.scale = sceneWidth > 1440 ? sceneWidth / 1440 : 1;\n    }\n\n    // Scale label elements and update position accordingly\n    const widthGain = (32 * this.scale) - 32; // 32 is the fixed height of the label component\n    this.renderer.setStyle(this.labelRef.nativeElement, 'transform-origin', 'top left');\n    this.renderer.setStyle(this.labelRef.nativeElement, 'transform', `translate(-${widthGain / 2}px, -${widthGain / 2}px) scale(${this.scale}, ${this.scale})`);\n  }\n\n  setTagPosition() {\n    const offset = this.label.offset;\n    const tagWidth = this.tagRef.nativeElement.offsetWidth;\n    const side = (this.label.offset[0] > 0) ? 'left' : 'right';\n\n    switch (side) {\n      case 'left':\n        this.renderer.setStyle(this.tagRef.nativeElement, 'transform', `translate(${16 + offset[0]}px, ${offset[1]}px)`);\n        break;\n      \n      case 'right':\n        this.renderer.setStyle(this.tagRef.nativeElement, 'transform', `translate(${16 + offset[0] - tagWidth}px, ${offset[1]}px)`);\n        break;\n    }\n  }\n\n  setWirePosition() {\n    // tslint:disable-next-line:prefer-const\n    let [x, y] = this.label.offset;\n\n    // For annotation and hotspot, move line down to below title\n    switch (this.label.theme) {\n      case LabelThemeEnum.Annotation:\n      case LabelThemeEnum.Classic: \n        const height = this.titleRef.nativeElement.offsetHeight - 16 - 2; // 16px is half of pin, 2 is border\n        y += height;\n        break;\n    }\n    \n    const wireLength = Math.sqrt(x * x + y * y);\n\n    this.renderer.setStyle(this.wireRef.nativeElement, 'width', `${wireLength}px`);\n    this.renderer.setStyle(this.wireRef.nativeElement, 'transform', `rotate(${Math.atan2(y, x)}rad)`);\n  }\n\n  emitDisplayUpdated(event) {\n    // Never emit context-label events\n    if (this.label.id === ContextLabelId) {\n      return;\n    }\n\n    // Don't emit events that lack details\n    if (event.inView == null || event.shown == null) {\n      return;\n    }\n\n    this.displayUpdated$.next(event);\n  }\n\n  private emitEngineEvent(event: EventsEnum, params: any) {\n    if (this.emitEvents) {\n      this.engineService.fireEvent(event, params);\n    }\n  }\n}\n","<div class=\"labels\" data-test=\"labelsElement\" *ngIf=\"interactive && (showLabels$ | async)\">\n\n  <ng-container *ngFor=\"let label of labels$ | async; trackBy: trackLabel\">\n    <app-label\n      data-test=\"appLabel\" \n      class=\"labels__label\"\n      [class.labels__label--hidden]=\"!label.shown\"\n      [pinDraggable]=\"(draggable$ | async)?.pin\"\n      [tagDraggable]=\"(draggable$ | async)?.tag\"      \n      [label]=\"label\"\n      [collapsed]=\"labelsCollapsed$ | async\"\n      [collapsedMode]=\"labelsCollapsedMode$ | async\">\n    </app-label>\n  </ng-container>\n\n  <!-- context label -->\n  <app-context-label\n    *ngIf=\"(enableContextLabel$ | async) && (contextLabel$ | async)\"\n    [label]=\"contextLabel$ | async\"\n    [enableInfo]=\"(enableContextLabelInfo$ | async) && (layout$ | async)?.nodeInfo.enable\"\n    [enableActions]=\"(enableContextLabelActions$ | async) && (layout$ | async)?.contextActions.enable\">\n  </app-context-label>\n\n</div>\n","import { Component, OnInit, ChangeDetectionStrategy, ChangeDetectorRef, OnDestroy, ElementRef } from '@angular/core';\nimport { Select, Store, Actions, ofActionDispatched } from '@ngxs/store';\nimport { EngineState } from 'src/app/engine/state/engine.state';\nimport { Observable, Subject } from 'rxjs';\nimport { StoryLabelsState } from 'src/app/story/state/labels/story.labels.state';\nimport { LabelModel } from 'src/app/story/models/labels/label.model';\nimport { ViewTreeNode } from 'src/app/engine/models/view.tree-node';\nimport { ToolEnum } from 'src/app/engine/models/tool.enum';\nimport { filter, takeUntil } from 'rxjs/operators';\nimport { AddLabel, SelectLabel, AddContextLabel, RemoveContextLabel, SetLabelsShown } from 'src/app/story/state/labels/story.labels.actions';\nimport { RemoveLabel, SetAllLabelsShown, SetLabel } from 'src/app/story/state/labels/story.labels.actions';\nimport { HitModel } from 'src/app/engine/models/hit.model';\nimport { CameraService } from 'src/app/engine/camera.service';\nimport { ClickNode, ToggleLabels } from 'src/app/engine/state/engine.actions';\nimport { StoryChaptersState } from 'src/app/story/state/chapters/story.chapters.state';\nimport { EngineCameraState } from 'src/app/engine/state/camera/engine.camera.state';\nimport { ChapterModel } from 'src/app/story/models/chapter.model';\nimport { SetCamera } from 'src/app/engine/state/camera/engine.camera.actions';\nimport { LabelsService } from 'src/app/story/labels.service';\nimport { LabelThemeEnum } from 'src/app/story/models/labels/label-theme.enum';\nimport { EngineNodesState } from 'src/app/engine/state/nodes/engine.nodes.state';\nimport { ErrandType } from 'src/app/story/models/errands/errand-type.enum';\nimport { FlyToObjectErrandModel } from 'src/app/story/models/errands/fly-to-object-errand.model';\nimport { FlyToChapterErrandModel } from 'src/app/story/models/errands/fly-to-chapter-errand.model';\nimport { cloneDeep, get } from 'lodash';\nimport { EngineService } from 'src/app/engine/engine.service';\nimport { EventsEnum } from 'src/app/engine/models/events.enum';\nimport { ViewState } from 'src/app/view/state/view.state';\nimport { ViewUIModel } from 'src/app/view/models/view-ui.model';\nimport { LabelCollapseModeEnum } from 'src/app/story/models/labels/label-collapse-mode';\n\n@Component({\n  selector: 'app-labels',\n  templateUrl: './labels.component.html',\n  styleUrls: ['./labels.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class LabelsComponent implements OnInit, OnDestroy {\n  \n\n  @Select(ViewState.getUI)\n  layout$: Observable<ViewUIModel>;\n\n  @Select(StoryLabelsState.getChapterLabels)\n  labels$: Observable<LabelModel[]>;\n\n  @Select(StoryChaptersState.getSelectedChapter)\n  selectedChapter$: Observable<ChapterModel>;\n\n  @Select(StoryLabelsState.getSelectedLabel)\n  selectedLabel$: Observable<LabelModel>;\n\n  @Select(StoryLabelsState.getLabelsCollapsed)\n  labelsCollapsed$: Observable<boolean>;\n\n  @Select(StoryLabelsState.getLabelsCollapsedMode)\n  labelsCollapsedMode$: Observable<LabelCollapseModeEnum>;\n\n  @Select(StoryLabelsState.getContextLabel)\n  contextLabel$: Observable<LabelModel>;\n\n  @Select(EngineState.getShowLabels)\n  showLabels$: Observable<boolean>;\n\n  @Select(EngineCameraState.getZoomed)\n  zoomed$: Observable<boolean>;\n\n  @Select(StoryLabelsState.getEnableContextLabel)\n  enableContextLabel$: Observable<boolean>;\n\n  @Select(StoryLabelsState.getEnableContextLabelInfo)\n  enableContextLabelInfo$: Observable<boolean>;\n\n  @Select(StoryLabelsState.getEnableContextLabelActions)\n  enableContextLabelActions$: Observable<boolean>;\n\n  @Select(StoryLabelsState.getLabelsDraggable)\n  draggable$: Observable<{ pin: boolean; tag: boolean}>;\n\n  interactive = false;\n\n  private ngUnsubscribe = new Subject();\n\n  constructor(\n    private store: Store,\n    private action$: Actions,\n    private engineService: EngineService,\n    private cameraService: CameraService,\n    private changeDetector: ChangeDetectorRef,\n    private labelsService: LabelsService,\n    private elRef: ElementRef\n  ) {}\n\n  ngOnInit() {\n    this.bindEngineEvents();\n    this.bindApplicationEvents();\n\n    this.labelsService.setLabelContainer(this.elRef);\n  }\n\n  ngOnDestroy() {\n    this.labelsService.setLabelContainer(null);\n\n    this.changeDetector.detach();   \n\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n  bindApplicationEvents() {\n    // Listen for node click\n    this.action$\n      .pipe(\n        ofActionDispatched(ClickNode),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe((action: ClickNode) => {\n        this.handleClickNode(action);\n      });\n\n    // Change detection\n    this.labels$\n      .pipe(takeUntil(this.ngUnsubscribe))\n      .subscribe((labels) => {\n        this.changeDetector.markForCheck();\n      });\n    \n    // Handle label deselection\n    this.selectedLabel$\n      .pipe(\n        filter(label => label == null),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(() => {\n        const zoomed = this.store.selectSnapshot(EngineCameraState.getZoomed);\n        const lockCamera = this.store.selectSnapshot(EngineCameraState.getLockCamera);\n        if (zoomed && !lockCamera) {\n          this.resetCamera();\n        }\n      });\n\n    // Listen for ready state before showing\n    this.store.select(StoryChaptersState.getSelectedChapterReadyState).pipe(\n      filter(readyState => readyState != null),\n      takeUntil(this.ngUnsubscribe)\n    ).subscribe(readyState => {\n      this.interactive = readyState.model;\n      this.changeDetector.markForCheck();\n    });\n\n  }\n\n  bindEngineEvents() {\n    /*\n     polyfill engine events\n      - dispatch label events via the engine for subscriptions.\n      - used for handling legacy annotation and hotspot events.\n    */\n\n    // ToggleLabels\n    this.action$\n      .pipe(\n        ofActionDispatched(ToggleLabels, SetAllLabelsShown),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(action => {\n        const engineEvent = action.show ? EventsEnum. LabelsEnabled : EventsEnum.LabelsDisabled;\n        this.engineService.fireEvent(engineEvent, null);\n      });\n\n    // AddLabel\n    this.action$\n      .pipe(\n        ofActionDispatched(AddLabel),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(action => {\n        this.engineService.fireEvent(EventsEnum.LabelsCreated, action.label);\n      });\n\n    // SetLabel\n    this.action$\n      .pipe(\n        ofActionDispatched(SetLabel),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(action => {\n        this.engineService.fireEvent(EventsEnum.LabelsUpdated, action.label);\n      });\n\n    // SetLabel\n    this.action$\n      .pipe(\n        ofActionDispatched(SetLabelsShown),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(action => {\n        action.labels.forEach(label => {\n          const labelEvent = action.shown ? EventsEnum.LabelsShown : EventsEnum.LabelsHidden;\n          this.engineService.fireEvent(labelEvent, {'labelId': label.id});\n        });\n      });\n\n      // RemoveLabel\n    this.action$\n      .pipe(\n        ofActionDispatched(RemoveLabel),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(action => {\n        this.engineService.fireEvent(EventsEnum.LabelsDestroyed, action.label);\n      });\n\n  }\n\n  handleClickNode(action: ClickNode) {\n    const tool = this.store.selectSnapshot(EngineState.getActiveTool);\n\n    if (\n      action.node != null\n    ) {\n      if (tool === ToolEnum.Label) {\n        this.addLabel(action.hit, action.node);\n      } else {\n        // Timeout to allow selected node to update\n        setTimeout(() => {\n          this.toggleContextLabel(action.hit, action.node);\n        });\n      }\n    } else {\n      this.store.dispatch(new SelectLabel(null));\n      this.store.dispatch(new RemoveContextLabel());\n    }\n  }\n\n  addLabel(hit: HitModel, node: ViewTreeNode) {\n    const direction = this.cameraService.getDirection(hit);\n    const label = this.getLabelDefaults(hit.objectId);\n    \n    const tagDistance = label.hideWire ? 20 : 32;\n\n    label.title = node.label;\n    label.offset = [tagDistance, 0];\n    label.objectId = hit.objectId;\n    label.barycentric = [hit.barycentric[0], hit.barycentric[1], hit.barycentric[2]];\n    label.pos = [hit.worldPos[0], hit.worldPos[1], hit.worldPos[2]];\n    label.primitiveIndex = hit.primitiveIndex;\n    label.renderableIndex = hit.renderableIndex || 0;\n    label.dir = direction;\n    label.chapterId = this.store.selectSnapshot(StoryChaptersState.getSelectedChapter).id;\n    label.occludable = true;\n    label.shown = true;\n\n    this.store.dispatch(new AddLabel(label));\n    this.store.dispatch(new SelectLabel(label));\n  }\n\n  toggleContextLabel(hit: HitModel, node: ViewTreeNode) {\n    const nodeIds = this.store.selectSnapshot(EngineNodesState.getCheckedNodeIds);\n\n    if (nodeIds.some(value => value === node.id)) {\n      const direction = this.cameraService.getDirection(hit);\n      const label = this.labelsService.makeDefaultStudioLabel();\n      \n      label.theme = LabelThemeEnum.Context;\n      label.title = node.label;\n      label.offset = [32, 0];\n      label.objectId = hit.objectId;\n      label.barycentric = [hit.barycentric[0], hit.barycentric[1], hit.barycentric[2]];\n      label.pos = [hit.worldPos[0], hit.worldPos[1], hit.worldPos[2]];\n      label.primitiveIndex = hit.primitiveIndex;\n      label.dir = direction;\n  \n      label.occludable = false;\n  \n      this.store.dispatch(new AddContextLabel(label));\n    } else {\n      this.store.dispatch(new RemoveContextLabel());\n    }\n  }\n\n  getLabelDefaults(objectId: string) {\n    // Label copy order of priority\n    // 1. Selected\n    // 2. Last in chapter\n    // 3. Last in story\n    // 4. New Studio Label\n\n    let labelToCopy = this.store.selectSnapshot(StoryLabelsState.getSelectedLabel);\n\n    if (labelToCopy == null) {\n      // Get chapter labels\n      let labels = this.store.selectSnapshot(StoryLabelsState.getChapterLabels);\n\n      // Get story labels\n      if (!labels || labels.length === 0) {\n        labels = this.store.selectSnapshot(StoryLabelsState.getLabels);\n      }\n\n      // If labels, assign\n      if (labels.length) {\n        labelToCopy = cloneDeep(labels[labels.length - 1]);\n      }\n    }\n\n    if (labelToCopy != null) {\n      // Make a shallow copy of the most recent label\n      const label = this.labelsService.makeDefaultStudioLabel();\n      label.hideWire = labelToCopy.hideWire;\n      label.pinGlow = labelToCopy.pinGlow;\n      label.pinType = labelToCopy.pinType;\n      label.theme = labelToCopy.theme;\n      label.sequentialType = labelToCopy.sequentialType;\n\n      // Emulate previous labels actions, but overwrite targets\n      \n      // -- Default State\n      label.states[0].errands[0] = new FlyToChapterErrandModel();\n      \n      // -- Selected State\n      switch (get(labelToCopy, 'states[1].errands[0].type')) {\n        case ErrandType.flyToObject:\n        case ErrandType.flyToCamera:\n          label.states[1].errands[0] = new FlyToObjectErrandModel(objectId);\n          break;\n        case ErrandType.flyToChapter:\n          // noop\n      }\n\n      return label;\n    } else {\n      // New label\n      const label = this.labelsService.makeDefaultStudioLabel();\n      label.states[0].errands[0] = new FlyToChapterErrandModel();\n      label.states[1].errands[0] = new FlyToObjectErrandModel(objectId);  \n      return label;\n    }\n  }\n\n  trackLabel(index: number, label: LabelModel) {\n    const { id, shown, theme } = label;\n    return `${id}${shown}${theme}`;\n  }\n\n  resetCamera() {\n    const chapter = this.store.selectSnapshot(StoryChaptersState.getSelectedChapter);\n    const location = get(chapter, 'camera.location');\n    if (location) {\n      this.store.dispatch(new SetCamera(chapter.camera.location));\n    }\n  }\n}\n","import { Injectable, ElementRef } from '@angular/core';\nimport { LabelModel } from './models/labels/label.model';\nimport { AnnotationModel } from './models/labels/annotation.model';\nimport { ChapterModel } from './models/chapter.model';\nimport { uuid } from '../shared/uuid';\nimport { LabelPinType } from './models/labels/label-pin-type.enum';\nimport { LabelThemeEnum } from './models/labels/label-theme.enum';\nimport { HotspotModel } from './models/labels/hotspot.model';\nimport { HotspotThemesEnum } from './models/labels/hotspot.themes.enum';\nimport { LabelStateModel } from './models/labels/label-state.model';\nimport { FlyToObjectErrandModel } from './models/errands/fly-to-object-errand.model';\nimport { FlyToCameraErrandModel } from './models/errands/fly-to-camera-errand.model';\nimport { ErrandInterface } from './models/errands/errand.model';\nimport { classToClass } from 'class-transformer';\nimport { HotspotTypeEnum } from './models/labels/hotspot.types.enum';\nimport { EngineService } from '../engine/engine.service';\nimport { ErrandType } from './models/errands/errand-type.enum';\nimport { FlyToChapterErrandModel } from './models/errands/fly-to-chapter-errand.model';\nimport { LabelSequentialType } from './models/labels/label-sequential-type.enum';\nimport { isNil } from 'lodash';\n\nconst errandTypeToHotspotAction = {\n  'flyToCamera': 'flyTo',\n  'flyToChapter': 'flyTo'\n};\n\nfunction translateLabelActionToHotspot(type): string {\n  return errandTypeToHotspotAction[type] || type;\n}\n\n\n/*\nHandles some ugliness in the two-way conversion of legacy annotations and\nhotspots into newer labels.\n*/\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class LabelsService {\n\n  private _labelContainer: ElementRef;\n\n  constructor(\n    private engineService: EngineService\n  ) { }\n\n  // DESERIALIZATION =====================================================================\n\n  // returns true if hotspot can be interpreted as a label (ignore show/hide hotspot)\n  filterHotspot(moduleData: any, chapter: any, hotspot: HotspotModel): boolean {\n    const supportedActions = new RegExp('^(flyTo|flyToObject|hideHotspot|showHotspot|resetHotspots)');\n    // get filtered actions\n    const actions = this.getHotspotAction(moduleData, hotspot);\n    const filtered = actions.filter(_action => supportedActions.test(_action));\n    if (actions.length === filtered.length) {\n      return true;\n    } else {\n      return false;\n    }\n  }\n\n  // deserialize legacy annotations into labels\n  deserializeAnnotation(annotation: AnnotationModel, chapter: ChapterModel, theme: LabelThemeEnum): LabelModel {\n    const label = new LabelModel(annotation.title || '');\n\n    // identifyin information\n    label.id = annotation.annotationId || uuid.idWithPrefix('label');\n    label.chapterId = chapter.id;\n\n    // style info\n    label.expandTag = true;\n    label.showDescription = true;\n    label.collapseDescription = false;\n    label.pinGlow = false;\n    label.hideWire = false;\n    label.hideTag = false;\n    if (theme === LabelThemeEnum.Annotation) {\n      label.theme = LabelThemeEnum.Annotation;\n      label.pinType = LabelPinType.Default;\n      label.flyTo = false;\n      label.states = [];\n    } else {\n      // annotation -> studio label\n      label.theme = LabelThemeEnum.StudioNext;\n      label.pinType = LabelPinType.PlusMinus;\n      label.flyTo = true;\n      label.states = [\n        new LabelStateModel(),\n        new LabelStateModel()\n      ];\n\n      label.states[0].errands = [new FlyToChapterErrandModel()];\n      label.states[1].errands = [new FlyToObjectErrandModel(annotation.objectId)];\n    }\n    label.occludable = annotation.occludable !== false; // default to true\n    label.renderableIndex = annotation.renderableIndex || 0;\n\n    if (annotation.objectId && annotation.hasOwnProperty('barycentric')) {\n      // use barycentric coordinate\n      label.objectId = annotation.objectId;\n      label.primitiveIndex = annotation.primitiveIndex;\n      label.barycentric = annotation.barycentric;\n    } else if (annotation.hasOwnProperty('pos')) {\n      // world position (let the marker deal with it)\n      if (annotation.hasOwnProperty('objectId')) {\n        label.objectId = annotation.objectId;\n      }\n      label.pos = annotation.pos;\n    }\n\n    // direction\n    if (annotation.dir && Array.isArray(annotation.dir)) {\n      label.dir = annotation.dir as [number, number, number];\n    } else if (annotation.dir && annotation.dir instanceof Object) {\n      label.dir = Object.values(annotation.dir) as [number, number, number];\n    }\n\n    // text label information\n    label.description = annotation.description || '';\n    label.offset = annotation.labelOffset || [40, 40];\n\n    // set shown\n    label.shown = annotation.shown !== false;\n    label.labelShown = annotation.labelShown !== false;\n\n    return label;\n  }\n\n  // converts one (or two, if paired)  hotspots into a label\n  deserializeHotspots(moduleData: any, chapter: any, chapterIndex: number, ...hotspots: HotspotModel[]): LabelModel {\n    const [primaryHotspot, secondaryHotspot] = hotspots;\n\n    // label identification\n    const label = new LabelModel(primaryHotspot.title || '');\n    label.id = uuid.idWithPrefix('hotspot');\n    label.objectId = primaryHotspot.objectId;\n    label.chapterId = chapter.id;\n\n    // display information\n    label.description = primaryHotspot.description || '';\n    if (/plus|minus/.test(primaryHotspot.className)) {\n      label.pinType = LabelPinType.PlusMinus;\n    } else if (/sequential/.test(primaryHotspot.className)) {\n      label.pinType = LabelPinType.Sequential;\n    } else if (/none/.test(primaryHotspot.className)) {\n      label.pinType = LabelPinType.None; \n    } else {\n      label.pinType = LabelPinType.Default;\n    }\n\n    if (/alphabetical/.test(primaryHotspot.className)) {\n      label.sequentialType = LabelSequentialType.Alphabetical; \n    } else if (/numerical/.test(primaryHotspot.className)) {\n      label.sequentialType = LabelSequentialType.Numerical; \n    }\n\n    label.pinGlow = /pulse/.test(primaryHotspot.className);\n    label.occludable = true;\n    label.shown = primaryHotspot.shown;\n    label.offset = primaryHotspot.labelOffset ? primaryHotspot.labelOffset : [22, -17];\n\n    if (/left/.test(primaryHotspot.className) && label.offset[0] > 0) {\n      label.offset[0] *= -1;\n    } else if (/right/.test(primaryHotspot.className) && label.offset[0] < 0) {\n      label.offset[0] *= -1;\n    }\n\n    // positioning\n    if (primaryHotspot.hasOwnProperty('barycentric')) {\n      // use shape centric coordinate\n      label.renderableIndex = primaryHotspot.renderableIndex || 0;\n      label.barycentric = primaryHotspot.barycentric;\n      label.primitiveIndex = primaryHotspot.primitiveIndex;\n    } else {\n      // use world pstiion (let marker handle positioning)\n      label.pos = primaryHotspot.pos;\n    }\n    label.dir = primaryHotspot.dir;\n\n\n    // diplay theme:\n    primaryHotspot.theme = !!primaryHotspot.theme ? primaryHotspot.theme : HotspotThemesEnum.classicHotspot;\n    switch (primaryHotspot.theme) {\n      case HotspotThemesEnum.classicAnnotation:\n        label.theme = LabelThemeEnum.Annotation;\n        label.showDescription = true;\n        label.collapseDescription = /collapsible/g.test(primaryHotspot.className);\n        label.expandTag = true;\n        label.hideTag = false;\n        label.hideWire = !/leader-line/.test(primaryHotspot.className);\n        break;\n      case HotspotThemesEnum.classicHotspot:\n        label.theme = LabelThemeEnum.Classic;\n        label.showDescription = /label/.test(primaryHotspot.className);\n        label.expandTag = /label/.test(primaryHotspot.className);\n        label.hideTag = !label.expandTag;\n        label.collapseDescription = false; // default to show description\n        label.hideWire = !/leader-line/.test(primaryHotspot.className);\n        break;\n      case HotspotThemesEnum.studioNext:\n        label.theme = LabelThemeEnum.StudioNext;\n        label.showDescription = this.hasContent(primaryHotspot);\n        label.collapseDescription = /collapsible/g.test(primaryHotspot.className);\n        label.hideTag = !primaryHotspot.title;\n        label.hideWire = !/leader-line/.test(primaryHotspot.className);\n        break;\n      default:\n        break;\n    }\n\n    // actions (first action)\n    label.flyTo = false;\n    label.flyToTarget = null;\n    label.states = [];\n\n    const actions1 = this.filterHotspotActions(this.getHotspotAction(moduleData, primaryHotspot));\n    const actions2 = !!secondaryHotspot ? this.filterHotspotActions(this.getHotspotAction(moduleData, secondaryHotspot)) : [];\n    const state1 = new LabelStateModel();\n    const state2 = new LabelStateModel();\n\n    if (actions1.length) {\n      state1.errands = actions1.map((action) => this.convertActionToErrand(moduleData, chapterIndex, action));\n    }\n    if (actions2.length) {\n      state2.errands = actions2.map((action) => this.convertActionToErrand(moduleData, chapterIndex, action));\n    }\n    label.states = [state2, state1];\n    \n    // make sure to set state variables to match errands\n    if (state1.errands.length > 0) {\n      label.flyTo = true;\n      label.flyToTarget = state1.errands[0].type;\n      if (state1.errands[0].type === ErrandType.flyToCamera) {\n        label.cameraPosition = state1.errands[0].value;\n      }\n    }\n\n    // content blocks\n    const contentBlocks = primaryHotspot.contentBlocks;\n    if (contentBlocks) {\n      label.contentBlocks = JSON.parse(JSON.stringify(contentBlocks));\n    }\n\n    return label;\n  }\n\n  // CONVERSION ===========================================================================\n  makeDefaultStudioLabel(sourceLabel?: LabelModel) {\n    const label = sourceLabel ? { ...sourceLabel } : new LabelModel('');\n\n    label.pinType = LabelPinType.PlusMinus;\n    label.theme = LabelThemeEnum.StudioNext;\n\n    label.expandTag = true;\n    label.showDescription = true;\n    label.collapseDescription = false;\n\n    label.pinGlow = false;\n\n    label.hideWire = false;\n    label.hideTag = false;\n\n    label.occludable = true;\n    label.flyTo = true;\n    label.description = '';\n    label.shown = true;\n\n    label.states = [\n      new LabelStateModel(),\n      new LabelStateModel()\n    ];\n\n    return label;\n  }\n\n  makeAnnotationLabel(sourceLabel?: LabelModel) {\n    const label = sourceLabel ? { ...sourceLabel } : new LabelModel('');\n\n    label.pinType = LabelPinType.Default;\n    label.theme = LabelThemeEnum.Annotation;\n\n    label.expandTag = true;\n    label.showDescription = true;\n    label.collapseDescription = false;\n\n    label.pinGlow = false;\n\n    label.hideWire = false;\n    label.hideTag = false;\n\n    label.states = [];\n\n    return label;\n  }\n\n  // SERIALIZATION ========================================================================\n  // converts one label into one (or two, if paired) hotspots\n  serializeLabel(\n    label: LabelModel,\n    idx: number\n    ): { hotspots: HotspotModel[], data: any } {\n\n    const hotspot = new HotspotModel();\n    const labelCopy = classToClass(label);\n\n    // basic\n    const className = ['circle', 'draggable'];\n    hotspot.shown = true;\n\n    // identification\n    if (label.objectId) {\n      hotspot.objectId = labelCopy.objectId;\n    }\n\n    // position and direction.\n    try {\n      if (label.primitiveIndex && label.barycentric && label.objectId) {\n        hotspot.renderableIndex = label.renderableIndex || 0;\n        hotspot.primitiveIndex = label.primitiveIndex;\n        hotspot.barycentric = label.barycentric;\n        hotspot.pos = this.engineService.barycentricToWorld(\n          label.objectId,\n          label.primitiveIndex,\n          label.barycentric\n        );\n      } else {\n        hotspot.pos = labelCopy.pos;\n      }\n    } catch (error) {\n      // If we are unable to position the hotspot (e.g legacy id), remove it from the list\n      return {\n        data: {},\n        hotspots: []\n      };\n    }\n\n    if (!!label.dir) {\n      // NOTE: The direction vector is a float-32-array\n      hotspot.dir = Array.prototype.slice.call(label.dir);\n    }\n    hotspot.labelOffset = label.offset;\n\n\n    // display information\n    switch (label.theme) {\n      case LabelThemeEnum.Annotation:\n        hotspot.theme = HotspotThemesEnum.classicAnnotation;\n        break;\n      case LabelThemeEnum.Classic:\n        hotspot.theme = HotspotThemesEnum.classicHotspot;\n        break;\n      default:\n        hotspot.theme = HotspotThemesEnum.studioNext;\n    }\n\n    if (labelCopy.title !== '') {\n      hotspot.title = labelCopy.title;\n      hotspot.description = labelCopy.description;\n      hotspot.type = HotspotTypeEnum.CircleLabel;\n    } else {\n      hotspot.type = HotspotTypeEnum.Circle;\n    }\n\n    // hotspot classes\n    if (label.pinGlow) {\n      className.push('pulse');\n    }\n    if (label.pinType === LabelPinType.PlusMinus) {\n      className.push('plus');\n    }\n    if (label.pinType === LabelPinType.Sequential) {\n      className.push('sequential'); \n      if (label.sequentialType === LabelSequentialType.Alphabetical) {\n        className.push('alphabetical'); \n      } else {\n        className.push('numerical'); \n      }\n    }\n    if (label.pinType === LabelPinType.None) {\n      className.push('none'); \n    }\n\n    if (!label.hideWire) {\n      className.push('leader-line');\n    }\n    if (!label.hideTag) {\n      className.push('label');\n    }\n    if (label.collapseDescription) {\n      className.push('collapsible collapsed');\n    }\n    hotspot.className = className.join(' ');\n\n    // hotspot actions & data\n    let data = {}; // customData blocked to current chapter, used by hotspots for action targets\n    hotspot.actions = [];\n    const hotspots = [hotspot];\n    const stateLength = label.states.length;\n    label.states.forEach((state, stateIndex) => {\n      // NOTE: [EM] a little extra complex here b/c states and hotspot actions are kind of 'inverses' of eachother.\n      if (stateIndex === stateLength - 1) {\n        // add actions to this hotspot\n        hotspots[0].actions.push('resetHotspots');\n        state.errands.forEach((errand) => {\n          const action = this.convertErrandToAction(label, errand);\n          hotspots[0].actions.push(action.action);\n          data = { ...data, ...action.data };\n        });\n      } else {\n        // we need new hotspots\n        const secondaryHotspot = classToClass(hotspot);\n        secondaryHotspot.actions = [];\n        secondaryHotspot.className = secondaryHotspot.className.replace('plus', 'minus');\n        state.errands.forEach((errand) => {\n          const action = this.convertErrandToAction(label, errand);\n          secondaryHotspot.actions.push(action.action);\n          data = { ...data, ...action.data };\n        });\n        hotspots.push(secondaryHotspot);\n      }\n    });\n\n    // teach plus two hotspots to toggle\n    if (hotspots.length === 2) {\n\n      // hotspot 1 : hide 1, show 2\n      hotspots[0].actions.push(`hideHotspots:currentChapter.hotspots[${idx}]`);\n      hotspots[0].actions.push(`showHotspots:currentChapter.hotspots[${idx + 1}]`);\n\n      // hotspot 2: hide 2, show 1\n      hotspots[1].actions.push(`hideHotspots:currentChapter.hotspots[${idx + 1}]`);\n      hotspots[1].actions.push(`showHotspots:currentChapter.hotspots[${idx}]`);\n\n      hotspots[0].shown = true;\n      hotspots[1].shown = false;\n    }\n\n    if (hotspots.length === 2 && label.collapseDescription) {\n      hotspots[1].className += hotspots[1].className.replace('collapsed', '');\n    }\n\n\n    // ensure left/right class\n    hotspots.forEach((_hotspot) => {\n      if (hotspot.labelOffset[0] < 0) {\n        _hotspot.className = _hotspot.className.replace('right', '') + ' left';\n      } else if (hotspot.labelOffset[0] > 0) {\n        _hotspot.className = _hotspot.className.replace('left', '') + ' right';\n      }\n    });\n\n    // content blocks\n    const contentBlocks = label.contentBlocks;\n    if (contentBlocks) {\n      hotspot.contentBlocks = JSON.parse(JSON.stringify(contentBlocks));\n    }\n\n    return {\n      data: data,\n      hotspots: hotspots\n    };\n\n  }\n\n  setLabelContainer(container: ElementRef) {\n    this._labelContainer = container;\n  }\n\n  getLabelContainer(): ElementRef {\n    return this._labelContainer;\n  }\n\n  hasContent(label: LabelModel | HotspotModel): boolean {\n    const { description, contentBlocks } = label;\n    return !!description || (!isNil(contentBlocks) && contentBlocks.length > 0);\n  }\n\n  // HELPER FUNCTIONS ======================================================================\n\n  // parse out actions array from hotspot, given module and chapter scopes\n  private getHotspotAction(moduleData: any, hotspot: HotspotModel): string[] {\n    const actions = !!hotspot.actionSrc ? this.objectAddress(moduleData, hotspot.actionSrc) : (hotspot.actions ? hotspot.actions : []);\n    if (actions instanceof Array) {\n      return actions;\n    } else {\n      return [];\n    }\n  }\n\n  // filter for hotspot actions that are supported in studio\n  private filterHotspotActions(actions: Array<any>) {\n    const supportedActions = new RegExp('^(flyTo|flyToObject)');\n    return actions.filter((_action) => supportedActions.test(_action));\n  }\n\n  // convert legacy action into equivalent errand\n  private convertActionToErrand = (moduleData, chapterIndex, action) => {\n    const flyToAction = new RegExp('^flyTo(Async)?');\n    const flyToObjectAction = new RegExp('^flyToObject(Async)?');\n    const flyToChapterAction = new RegExp('^flyTo[\\w\\.\\:]+currentChapter\\.[flyTo|jumpTo]');\n\n    // currently we only support flyTo\n    const tokens = action.split(':').slice(0, 2); // we only take action and one parameter\n\n    // conditionally parse where in the data the action target value is located\n    const actionScope = moduleData;\n    let actionTarget = tokens[1]; // address is scoped to module data\n    if (/currentChapter/.test(actionTarget)) {\n      actionTarget = actionTarget.replace('currentChapter', `chapters[${chapterIndex}]`);\n    }\n\n    // build errand based on action\n    let errand = null;\n\n    if (flyToObjectAction.test(tokens[0])) {\n      errand = new FlyToObjectErrandModel(this.objectAddress(actionScope, actionTarget));\n    } else if (flyToAction.test(tokens[0])) {\n      errand = new FlyToCameraErrandModel(this.objectAddress(actionScope, actionTarget));\n    } else if (flyToChapterAction.test(tokens[0])) {\n      errand = new FlyToChapterErrandModel();\n    }\n\n    return errand;\n  }\n\n  // convert errand into equivalent legacy action\n  private convertErrandToAction = (label: LabelModel, errand: ErrandInterface): { action: string, data: any } => {\n    const id = uuid.idWithPrefix('errand').replace(/\\-/g, '_');\n    const data = {};\n    let action = '';\n    const type = translateLabelActionToHotspot(errand.type);\n\n    if (errand.type === ErrandType.flyToChapter) {\n      // there is no flyToChapter action. We have to pass in the address to the chapter's camera (jupTy or flyTo) property\n      action = `${type}Async:currentChapter.${this.engineService.getChapter(label.chapterId).camera.action}`;\n    } else {\n      action = `${type}Async:currentChapter.customData.${id}`,\n        data[id] = errand.value;\n    }\n\n    return {\n      action: action,\n      data: data\n    };\n  }\n\n  // extract sub-object from object given dot-notation address\n  private objectAddress = (srcObject: any, address: string) => {\n    return address.split('.').reduce((o, i) => {\n      if (o === null) {\n        return null;\n      } else if (/\\[+[0-9+]\\]+/.test(i)) {\n        // access array element\n        const parts = i.split('[');\n        const idx = Number(parts[1].match(/[0-9]+/));\n        if (parts[0] in o && idx in o[parts[0]]) {\n          return o[parts[0]][idx];\n        } else {\n          return null;\n        }\n      } else if (i in o) {\n        return o[i];\n      } else {\n        return null;\n      }\n    }, srcObject);\n  }\n}\n\n\n","import { Injectable } from '@angular/core';\nimport { ChapterModel } from './models/chapter.model';\nimport { MediaModel } from './models/media.model';\nimport { Howl } from 'howler';\nimport { UploadFile, UploadInput } from 'ngx-uploader';\n\ndeclare const Human: any;\n\nconst postAudioRoute = '/ws/media/audio/upload';\nconst getAudioRoute = '/media/audio';\nconst legacyBaseUrl = '/content/states';\n\nconst audioUUIDExp = new RegExp(`^${getAudioRoute}/(.*)/.*$`);\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class MediaService {\n\n  constructor() {}\n\n  private audioPlayers = new Map<string, Howl>();\n  \n  createAudioUploadEvent (audioFile: UploadFile): UploadInput {\n    return {\n      type: 'uploadFile',\n      url: postAudioRoute,\n      method: 'POST',\n      file: audioFile\n    } as UploadInput;\n  }\n\n  // Returns key / value pair\n  getAudioClip (media: object): [string, MediaModel] {\n    const audioClipPair = Object.entries(media)\n      .find(([clipId, clip]) => clip.data.streamType === 'audio');\n\n    return audioClipPair || [undefined, undefined];\n  }\n\n  // Returns key / value pair\n  createAudioClip (chapter: ChapterModel, audioUrl: string): [string, MediaModel] {\n    const branch = Human.timeline.branchTimelines[chapter.id];\n    const clipId = this.getAudioUUID(audioUrl);\n\n    const audioClip = {\n      data: {\n        clipId: clipId,\n        streamType: 'audio',\n        alternatives: ['m4a'],\n        fullUrl: audioUrl,\n        time1: branch.timeRange.firstTime,\n        time2: branch.timeRange.lastTime\n      }\n    } as MediaModel;\n\n    return [clipId, audioClip];\n  }\n\n  getAudioClipUrl (media: object): string {\n    const [clipId, audioClip] = this.getAudioClip(media);\n    return audioClip ? audioClip.data.fullUrl : '';\n  }\n\n  // Handles legacy audio sources\n  getAudioSrc (src: string): string {\n    if (!src.match(getAudioRoute)) {\n      src = `${legacyBaseUrl}/${src}`;\n    }\n\n    return src;\n  }\n\n  getAudioPlayer (audioURL: string): Howl {\n    return this.audioPlayers.get(audioURL);\n  }\n\n  addAudioPlayer (audioURL: string): Howl {\n    this.removeAudioPlayer(audioURL);\n\n    audioURL = this.getAudioSrc(audioURL);\n\n    const audioPlayer = new Howl({src: [audioURL]});\n    this.audioPlayers.set(audioURL, audioPlayer);\n\n    return audioPlayer;\n  }\n\n  removeAudioPlayer (audioURL: string) {\n    const audioPlayer = this.audioPlayers.get(audioURL);\n\n    if (audioPlayer) {\n      audioPlayer.unload();\n      this.audioPlayers.delete(audioURL);\n    }\n  }\n\n  stopAudio () {\n    this.audioPlayers.forEach((player) => {\n      player.stop();\n    });\n  }\n\n  private getAudioUUID (audioUrl: string): string {\n    const match = audioUrl.match(audioUUIDExp);\n    return match[1];\n  }\n}\n","import { AssetLibrary } from '../models/story.model';\nimport { uniq } from 'lodash';\n\nexport function mergeAssetLibraries(current: AssetLibrary, addition: AssetLibrary): AssetLibrary {\n  const uniqCombine = (a, b) => uniq([...a, ...b]);\n  const lights = uniqCombine(current.lights, addition.lights);\n  const tweens = uniqCombine(current.tweens, addition.tweens);\n  const regionMaps = uniqCombine(current.regionMaps, addition.regionMaps);\n  const reflections = uniqCombine(current.reflections, addition.reflections);\n\n  return {\n    lights,\n    tweens,\n    regionMaps,\n    reflections,\n  };\n}\n","import { isEmpty } from 'lodash';\nimport { uuid } from '../../shared/uuid';\n\nexport function mergeColorRecipes(\n  current,\n  additions,\n  uuidMaker: uuid.PrefixUuidFunc\n) {\n  current = current || {};\n  additions = additions || {};\n\n  const _additions = Object.keys(additions).reduce(\n    (acc, key) => {\n      const newKey = uuidMaker(`color-recipe-${key}`);\n      acc.newColorRecipeIds[key] = newKey;\n      acc.colorRecipes[newKey] = additions[key];\n      return acc;\n    },\n    {\n      colorRecipes: {},\n      newColorRecipeIds: {}\n    }\n  );\n\n  return {\n    colorRecipes: { ...current, ..._additions.colorRecipes },\n    newColorRecipeIds: _additions.newColorRecipeIds\n  };\n}\n\nexport function updateChapterColorRecipes(\n  newChapters,\n  newColorRecipeIds\n): any[] {\n  return newChapters.map(chapter => {\n    // does this chapter have color recipes?\n    if (isEmpty(chapter.colorRecipeObjects)) {\n      return chapter;\n    }\n\n    // for each color recipe key, replace it\n    const colorRecipes = Object.keys(chapter.colorRecipeObjects).reduce(\n      (acc, key) => {\n        const newKey = newColorRecipeIds[key];\n        acc[newKey] = chapter.colorRecipeObjects[key];\n        return acc;\n      },\n      {}\n    );\n    chapter.colorRecipeObjects = colorRecipes;\n    return chapter;\n  });\n}\n","import { isEmpty } from 'lodash';\n\nexport function setLightsForChapters(\n  chapters: any[],\n  assetLibLights: string[]\n) {\n  return chapters.map(chapter => {\n    // leave chapter lights alone if already set.\n    if (!isEmpty(chapter.lights)) {\n      return chapter;\n    }\n\n    // set the lights according to the contents of assetLibraries\n    const lights = {\n      libraries: [...assetLibLights],\n      lights: [] // tbh, no idea why this prop exists.\n    };\n\n    return { ...chapter, lights };\n  });\n}\n","import { StoryModel } from '../models/story.model';\nimport { uniq } from 'lodash';\nimport { uuid } from '../../shared/uuid';\nimport { Environment } from 'src/environments/environment.model';\nimport { mergeSceneGraphs, updateChapterShowSelectPickThroughObjects } from './merge-scene-graph';\n\nimport {mergeColorRecipes, updateChapterColorRecipes} from './merge-color-recipes';\nimport { mergeReflections } from './merge-reflections';\nimport { mergeAssetLibraries } from './merge-asset-libraries';\nimport { setLightsForChapters } from './merge-lights';\nimport { ContentType } from '../models/content-type.enum';\nimport { mergeParticleSystems } from './merge-particle-systems';\n\n\nexport function mergeModules(\n  currentStory: StoryModel,\n  currentStoryId: string,\n  newStory: StoryModel,\n  newStoryId: string,\n  exportType: Environment['exportType'] = ContentType.Bookmark,\n  prefixUuidFunc: uuid.PrefixUuidFunc = uuid.idWithPrefix\n): StoryModel {\n\n  // start by merging global properties\n  const {\n    sceneGraph,\n    graphsMerged,\n    objectIdsUniqueToNew,\n    objectIdsUniqueToOriginal\n  } = mergeSceneGraphs(\n    currentStory.sceneGraph,\n    newStory.sceneGraph\n  );\n\n  const assetLibraries = mergeAssetLibraries(\n    currentStory.assetLibraries,\n    newStory.assetLibraries\n  );\n\n  const reflections = mergeReflections(\n    currentStory.reflections,\n    newStory.reflections,\n    currentStoryId,\n    newStoryId\n  );\n\n  const { colorRecipes, newColorRecipeIds } = mergeColorRecipes(\n    currentStory.colorRecipes,\n    newStory.colorRecipes,\n    prefixUuidFunc\n  );\n\n  // then merge chapter properties\n\n  const currentChaptersUpdatedLights = setLightsForChapters(\n    currentStory.chapters,\n    currentStory.assetLibraries.lights\n  );\n\n  const newChaptersUpdatedLights = setLightsForChapters(\n    newStory.chapters,\n    newStory.assetLibraries.lights\n  );\n  \n  const currentChaptersUpdatedProps = updateChapterShowSelectPickThroughObjects(\n    currentChaptersUpdatedLights,\n    graphsMerged,\n    objectIdsUniqueToNew\n  );\n\n  const newChaptersUpdatedProps = updateChapterShowSelectPickThroughObjects(\n    newChaptersUpdatedLights,\n    graphsMerged,\n    objectIdsUniqueToOriginal\n  );\n  \n  // give imported chapters a new id\n  const importedChaptersWithNewIds = newChaptersUpdatedProps.map(c => {\n    return { ...c, id: prefixUuidFunc('chapter') };\n  });\n\n\n  const mergedParticles = mergeParticleSystems(\n    currentStory,\n    newStory,\n    currentChaptersUpdatedProps,\n    importedChaptersWithNewIds,\n    prefixUuidFunc\n  );\n\n  const importedChaptersWithUpdatedColorRecipes = updateChapterColorRecipes(\n    mergedParticles.importedChapters,\n    newColorRecipeIds\n  );\n\n  const chapters = [\n    ...mergedParticles.currentChapters,\n    ...importedChaptersWithUpdatedColorRecipes\n  ];\n\n  // TODO: what types of customData besides ParticleSystems am I throwing out from imported modules?\n  const customData = {\n    ...currentStory.customData,\n    particleSystems: mergedParticles.mergedParticles\n  };\n\n  const tags = exportType === 'module' ? currentStory.tags : [];\n\n  return {\n    ...currentStory,\n    assetLibraries,\n    chapters,\n    sceneGraph,\n    customData,\n    tags,\n    reflections,\n    colorRecipes,\n    stateId: uniq([\n      ...currentStory.stateId,\n      ...newStory.stateId\n    ]),\n    tweenParticleLookup: mergedParticles.tweenParticleLookup\n  };\n}\n","import { StoryModel } from '../models/story.model';\nimport { TweenParticleLookupModel } from '../models/tween-particle-lookup.model';\nimport { pickBy, isEmpty, get } from 'lodash';\nimport { ParticleIdUtils } from '../../shared/particle-id-utils';\n\nfunction generateParticleSystemIds(\n  story: StoryModel,\n  uuidFn\n): Record<string, string> {\n  if (!story.customData || !story.customData.particleSystems) {\n    return {};\n  }\n\n  return story.customData.particleSystems.reduce((acc, particleSystem) => {\n    const rootId = ParticleIdUtils.getParticleIdRoot(particleSystem.id);\n    acc[rootId] = ParticleIdUtils.generateParticleId(rootId, uuidFn);\n    return acc;\n  }, {});\n}\n\nfunction assignCustomDataParticleNames(\n  story: StoryModel,\n  newParticleIds: Record<string, string>\n) {\n  if (!story.customData || !story.customData.particleSystems) {\n    return [];\n  }\n\n  return story.customData.particleSystems.map(particleSystem => {\n    const rootId = ParticleIdUtils.getParticleIdRoot(particleSystem.id);\n    return {\n      ...particleSystem,\n      id: newParticleIds[rootId]\n    };\n  });\n}\n\nfunction assignChapterParticleIds(\n  chapters,\n  newParticleIds: Record<string, string>\n) {\n  return chapters.map(chapter => {\n    if (chapter.customData && chapter.customData.particleSystems) {\n      chapter.customData.particleSystems = chapter.customData.particleSystems.map(\n        id => newParticleIds[ParticleIdUtils.getParticleIdRoot(id)]\n      );\n    }\n    return chapter;\n  });\n}\n\nfunction buildLookup(chapters, particleMap): TweenParticleLookupModel {\n  return chapters\n    .map(c => c.id)\n    .reduce((acc, chapterId: string) => {\n      const hasParticles: boolean = chapters.some(\n        chapter =>\n          chapter.id === chapterId &&\n          get(chapter, 'customData.particleSystems', []).length > 0\n      );\n\n      if (hasParticles) {\n        acc[chapterId] = particleMap;\n      }\n      return acc;\n    }, {});\n}\n\n\n\n/**\n *  Similar to other pieces of data, we can generate unique Ids to prevent particle system Id collisions between modules.\n *  However, merging particle systems requires more work than other pieces of data.\n *  \n *  Some particle systems are controlled by tweens, whose manifests are only ever seen by the engine.\n *  A tween manifest references particle systems by Id, so changing a particle system id breaks the reference.\n * \n *  Therefore, we must create a TweenParticleLookup, so the engine can locate the correct particle system given the original particle system Id, \n *  and the currently active chapter.\n *  See `tweenParticleLookup.js` in the engine.\n * \n *  Subsquent to the module merge, The TweenParticleLookup needs to be refreshed whenever a chapter Id changes, i.e. saving to a bookmark.\n *  See `refreshTweenParticleLookup`.\n *  \n */\nexport function mergeParticleSystems(\n  currentStory: StoryModel,\n  importedStory: StoryModel,\n  currentChapters: any[],\n  importedChapters: any[],\n  uuidFn\n): {\n  mergedParticles: any[];\n  currentChapters: any[];\n  importedChapters: any[];\n  tweenParticleLookup: TweenParticleLookupModel;\n} {\n\n\n  // Create the new particle system Ids\n  // store as a lookup, so chapters can update their references to particle Ids.\n  const currentStoryParticleIds = generateParticleSystemIds(\n    currentStory,\n    uuidFn\n  );\n\n  const importedStoryParticleIds = generateParticleSystemIds(\n    importedStory,\n    uuidFn\n  );\n\n  // apply the new particle system Ids to the module's custom data.\n  const mergedParticles = [\n    ...assignCustomDataParticleNames(currentStory, currentStoryParticleIds),\n    ...assignCustomDataParticleNames(importedStory, importedStoryParticleIds)\n  ];\n\n  // update the chapter's particle system Id references\n  const currentChaptersUpdatedParticles = assignChapterParticleIds(\n    currentChapters,\n    currentStoryParticleIds\n  );\n\n  const importedChaptersUpdatedParticles = assignChapterParticleIds(\n    importedChapters,\n    importedStoryParticleIds\n  );\n\n  // Build the lookup so the engine can find the right particle system.\n  const tweenParticleLookup: TweenParticleLookupModel = {\n    ...buildLookup(currentChaptersUpdatedParticles, currentStoryParticleIds),\n    ...buildLookup(importedChaptersUpdatedParticles, importedStoryParticleIds)\n  };\n\n  // filter chapters that don't have a particle system.\n  const filteredLookup = pickBy(tweenParticleLookup, (value, key) => !isEmpty(value));\n\n  return {\n    mergedParticles,\n    currentChapters: currentChaptersUpdatedParticles,\n    importedChapters: importedChaptersUpdatedParticles,\n    tweenParticleLookup: filteredLookup\n  };\n}\n\n","import { mapKeys } from 'lodash';\nimport { ContentType } from '../models/content-type.enum';\nimport { storyType } from '../state/story-type';\n\nfunction moduleNameFromStoryId(storyId: string) {\n  return storyType(storyId) === ContentType.Bookmark\n    ? storyId\n    : storyId.split('/').pop();\n}\n\nexport function mergeReflections(\n  currentReflections,\n  newReflections,\n  currentStoryId: string,\n  newStoryId: string\n) {\n  currentReflections = currentReflections || {};\n  newReflections = newReflections || {};\n\n  // if the current id already has a namespace, return it.\n  // otherwise, namespace as normal\n  const namespaceReflectionId = (storyId, currentId) => {\n    const isAlreadyNamespaced = id => id.includes('/');\n    return isAlreadyNamespaced(currentId)\n      ? currentId\n      : `${moduleNameFromStoryId(storyId)}/${currentId}`;\n  };\n\n  return {\n    ...mapKeys(currentReflections, (value, key) =>\n      namespaceReflectionId(currentStoryId, key)\n    ),\n    ...mapKeys(newReflections, (value, key) =>\n      namespaceReflectionId(newStoryId, key)\n    )\n  };\n}\n","import { flatten } from 'lodash';\nimport { SceneGraphNode } from 'src/app/engine/models/scene-graph.model';\n\n\n\nexport function mergeSceneGraphNodes(\n  _object1: SceneGraphNode,\n  _object2: SceneGraphNode\n): { \n  root: SceneGraphNode[], \n  objectIdsUniqueToNew: {[objectId: string]: true},\n  objectIdsUniqueToOriginal: {[objectId: string]: true}\n} {\n  \n  const objectIdsUniqueToNew = {};\n  const objectIdsUniqueToOriginal = {};\n\n  // merge lives in nested scope, so we can collect new object ids through each recursion.\n  function merge(object1: SceneGraphNode, object2: SceneGraphNode): SceneGraphNode[] {\n\n    if (object1.objectId !== object2.objectId) {\n      objectIdsUniqueToNew[object2.objectId] = true;\n      return [object1, object2];\n    }\n      \n    // recursive merging won't happen if an object's objects are undefined.\n    // need to look for unique objects here too.\n    if (object1.objects === undefined && object2.objects) {\n      for (const object of object2.objects) {\n        objectIdsUniqueToNew[object.objectId] = true;\n      }\n      return [{...object2}];\n    }\n\n    if (object1.objects && object2.objects === undefined) {\n      for (const object of object1.objects) {\n        objectIdsUniqueToOriginal[object.objectId] = true;\n      }\n      return [{...object1}];\n    }\n\n    if (object1.objects === undefined && object2.objects === undefined) {\n      return [{ ...object1 }];\n    }\n    \n    const objects = [];\n  \n    // if an object exists in both groups, it needs to be merged recursively\n    // if not, it can simply be appended.\n    for (const obj1 of object1.objects) {\n      const obj2 = object2.objects.find(o => o.objectId === obj1.objectId);\n      if (obj2) {\n        objects.push(merge(obj1, obj2));\n      } else {\n        objectIdsUniqueToOriginal[obj1.objectId] = true;\n        objects.push(obj1);\n      }\n    }\n  \n    // must compare the other way, to find objects in group 2 that aren't in group 1.\n    for (const obj2 of object2.objects) {\n      const obj1 = object1.objects.find(o => o.objectId === obj2.objectId);\n      if (!obj1) {\n        objectIdsUniqueToNew[obj2.objectId] = true;\n        objects.push(obj2);\n      }\n    }\n  \n    \n    // don't mutate\n    const _obj = { ...object1 };\n    \n    // collect the objects we found recursively\n    _obj.objects = flatten(objects);\n    \n    return [_obj];\n  \n  }\n\n  const root = merge(_object1, _object2);\n\n  return {\n    root,\n    objectIdsUniqueToNew,\n    objectIdsUniqueToOriginal\n  };\n}\n","import { SceneGraphNode } from '../../engine/models/scene-graph.model';\nimport { isEqual, partition } from 'lodash';\nimport { mergeSceneGraphNodes } from './merge-scene-graph-nodes';\n\nfunction mergeAnonymousGraphs(original: SceneGraphNode[], additions: SceneGraphNode[]) {\n  // i know that original and additions are collections of anonymous nodes\n  // for each addition, \n  // is the addition equal to an original node?\n  // if it is not, append it\n\n  return additions.reduce((acc, addition) => {\n    for (const node of original) {\n      if (!isEqual(node, addition)) {\n        acc.push(addition);\n      }\n    }\n    return acc;\n  }, original);\n}\n\n\nfunction mergeNonAnonymousGraphs(original: SceneGraphNode[], additions: SceneGraphNode[]) {\n\n  const originalSceneGraphsDict: {\n    [rootId: string]: SceneGraphNode\n  } = original.reduce((acc, root) => {\n    acc[root.objectId] = root;\n    return acc;\n  }, {});\n\n  const newSceneGraphsDict = additions.reduce(\n    (acc, root) => {\n      // if a scene graph id doesn't exist, include it\n      if (acc.nodes[root.objectId] === undefined) {\n        acc.nodes[root.objectId] = root;\n        return acc;\n      }\n\n      // if a scene graph exists, and its not the same, merge it with the original\n      if (!isEqual(root, acc.nodes[root.objectId])) {\n        const merged = mergeSceneGraphNodes(\n          acc.nodes[root.objectId],\n          root\n        );\n\n        acc.nodes[root.objectId] = merged.root[0];\n        acc.graphsMerged.push(root.objectId);\n        acc.objectIdsUniqueToNew[root.objectId] = merged.objectIdsUniqueToNew;\n        acc.objectIdsUniqueToOriginal[root.objectId] = merged.objectIdsUniqueToOriginal;\n      }\n\n      // if a scene graph exists, and its the same\n      // do nothing\n\n      return acc;\n    },\n    {\n      nodes: originalSceneGraphsDict,\n      graphsMerged: [] as string[],\n      objectIdsUniqueToNew: {} as { [rootId: string]: { [objectId: string]: true } },\n      objectIdsUniqueToOriginal: {} as { [rootId: string]: { [objectId: string]: true } }\n    }\n  );\n\n\n  // convert from dict back to array\n  const newSceneGraph = Object.keys(newSceneGraphsDict.nodes).reduce(\n    (acc, rootId) => {\n      acc.push(newSceneGraphsDict.nodes[rootId]);\n      return acc;\n    },\n    [] as SceneGraphNode[]\n  );\n\n\n  return {\n    newSceneGraph,\n    graphsMerged: newSceneGraphsDict.graphsMerged,\n    objectIdsUniqueToNew: newSceneGraphsDict.objectIdsUniqueToNew,\n    objectIdsUniqueToOriginal: newSceneGraphsDict.objectIdsUniqueToOriginal\n  };\n}\n\n\nexport function mergeSceneGraphs(originalGraph: SceneGraphNode[], additions: SceneGraphNode[]) {\n\n  // need to handle anonymous objects.\n  // anonymous objects need to be combined separately, and merged with the rest\n\n  const partitioner = (root) => root.objectId !== undefined;\n\n  // handle anonymous nodes\n  const [originalNodesWithId, originalAnonymousNodes] = partition(\n    originalGraph,\n    partitioner\n  );\n\n  const [additionsWithId, additionsAnonymous] = partition(\n    additions,\n    partitioner\n  );\n\n  // take additions with id and push them into originals with ids \n  const combinedGraphsWithNoIds = mergeAnonymousGraphs(\n    originalAnonymousNodes,\n    additionsAnonymous\n  );\n\n  const {\n    newSceneGraph,\n    graphsMerged,\n    objectIdsUniqueToNew,\n    objectIdsUniqueToOriginal\n  } = mergeNonAnonymousGraphs(originalNodesWithId, additionsWithId);\n  \n  return {\n    sceneGraph: [...combinedGraphsWithNoIds, ...newSceneGraph],\n    graphsMerged,\n    objectIdsUniqueToNew,\n    objectIdsUniqueToOriginal\n  };\n}\n\n\n\nfunction makeUpdateDict(\n  graphsMerged: string[],\n  uniqueObjectIds: { [rootId: string]: { [objectId: string]: true } }\n) {\n  const updateDict: { [objectId: string]: false } = {};\n  for (const rootId of graphsMerged) {\n    const objectIds = Object.keys(uniqueObjectIds[rootId]);\n    for (const objectId of objectIds) {\n      updateDict[objectId] = false;\n    }\n  }\n  return updateDict;\n}\n\n\n// since we merged scene graphs, we must update show, select, and pickThroughObjects\n// objects that are new additions from another model's scene graph must be explicity\n// set to false in show, select, pickthrough objects.  i.e. they are not a part of this scene.\n// preserve the original contents of show, select, pickthrough objects\n// an updateDict is all the objectIds to set to false.\n\nexport function updateChapterShowSelectPickThroughObjects(\n  chapters,\n  graphsMerged: string[],\n  uniqueObjectIds\n) {\n  const updateDict = makeUpdateDict(graphsMerged, uniqueObjectIds);\n  return chapters.map(chapter => {\n    return {\n      ...chapter,\n      showObjects: { ...chapter.showObjects, ...updateDict },\n      selectObjects: { ...chapter.selectObjects, ...updateDict },\n      pickThroughObjects: { ...chapter.pickThroughObjects, ...updateDict }\n    };\n  });\n}\n","export enum CameraStrategy {\n    JumpTo = 'jumpTo',\n    FlyTo = 'flyTo'\n}\n","\nexport class ChapterGraphModel {\n  nodes?: Array<{id: string, displayName: string}>;\n  root?: {\n    children?: string[],\n    replace?: boolean\n  };\n  connect?: {\n    [key: string]: {\n      children?: string[],\n      replace?: boolean\n    }\n  };\n  terminal?: string[];\n}\n","import { MediaEnum } from './media.enum';\nimport { ViewLoaderEnum } from 'src/app/view/models/view-loader.enum';\n\nexport class ChapterUIModel {\n  play: {\n    count: number;\n    autoplay: boolean;\n  };\n\n  config: {\n    info: boolean;\n    fullscreen: boolean;\n    objectTree: boolean;\n    scrubber: boolean;\n    nav: boolean;\n    annotations: boolean;\n    playPause: boolean;\n    mediaControls: MediaEnum;\n    anatomyLabels: boolean;\n    loader: ViewLoaderEnum;\n    whiteboard: boolean;\n    visibilityLayers: boolean;\n    contextActions: boolean;\n  };\n  \n}\n","import { TimelineModel } from './timeline.model';\nimport { CameraModel } from '../../engine/models/camera.model';\nimport { LabelModel } from './labels/label.model';\nimport { Type, Exclude, Expose, plainToClass } from 'class-transformer';\nimport { SynchronizationModel } from './synchronization.model';\nimport { ChapterGraphModel } from './chapter-graph.model';\nimport { ChapterUIModel } from './chapter-ui.model';\nimport { HotspotModel } from './labels/hotspot.model';\nimport { BackgroundModel } from 'src/app/engine/models/background.model';\nimport { MediaModel } from './media.model';\nimport { TransitionModel } from './transition.model';\nimport { PostProcessingEffect } from 'src/app/engine/models/post-processing/effects';\nimport { TransparencyModeEnum } from 'src/app/engine/models/post-processing/transparency-mode.enum';\nimport { ShowObjects } from 'src/app/engine/models/show-objects.model';\nimport { ClippingPlanes } from './clipping-plane.model';\nimport { ChapterLegendModel } from './chapter-legend.model';\nimport { ChapterReadyStateModel } from './chapter-ready-state.model';\nimport { VisibilityLayersModel } from './visibility-layers.model';\nimport { ContentBlock } from 'src/app/content-blocks/models/content-block';\n\n/* The Chapter model as it pertains to the application The engine is responsible\nfor building animation timelines and sychronizing the state of the scene-graph\nat the start of each chapter. This data is stored in the Human Engine's chapter\nobject.\n\nEngine responsibilities for faithfully setting chapter state include 1 - graph\nsynchronization. the state of each object in the scene-graph 2 - clipping\nplanes. These must be in effect simultaneously with the graph synchronization,\nor else flashing may occur. 3 - camera position and action. 4 - lights.\n\nEngine responsibilities for building chapter 1- building of the animations and\nthe corresponding timeline maps to map chapter time to animation time\n\nHowever, the engine's chapter object stores several data attributes that it need\nnot be responsible for managing. Examples include: 1 - background color 2 - meta\ndata, display name and description 3 - labels (however, they do contain\nengine-specific data for tracking points in space via markers) 4 - customData -\nspecial, protected location scoped on the chapter for custom or in-development\nfeatures.\n\nNOTE: EXCLUDE/EXPOSE\nThe human chapter object contains many properties that we do not want exposed to the application.\nWe use @Exclude/@Expose decorators to insist that only the @Expose'd properties are passed to the application state.\n\n*/\n\ndeclare const immer: {\n    readonly immerable: unique symbol;\n};\n\n@Exclude()\nexport class ChapterModel {\n    [immer.immerable] = true;\n\n    // Define nested types --------------------------------------------------\n    @Type(() => LabelModel)\n    @Type(() => SynchronizationModel)\n    @Type(() => CameraModel)\n    @Type(() => ChapterGraphModel)\n\n    // Shared Data between Human Chapter and App Chapter ---------------------\n    @Expose()\n    id: string;\n\n    @Expose()\n    info: {\n        displayName: string,\n        description: string,\n    };\n\n    @Expose()\n    labels: LabelModel[];\n\n    @Expose()\n    colorRecipeObjects: any;\n\n    @Expose()\n    hotspots?: HotspotModel[];\n\n    @Expose()\n    synchronization: SynchronizationModel;\n\n    @Expose()\n    background: BackgroundModel;\n    \n    @Expose()\n    lights: any;\n\n    @Expose()\n    timelineMap: TimelineModel[];\n\n    @Expose()\n    camera: {\n        action: 'jumpTo' | 'flyTo',\n        location: CameraModel\n    };\n\n    @Expose()\n    transitions?: {\n        post?: TransitionModel;\n        pre?: TransitionModel;\n    };\n\n    @Expose()\n    properties: {\n        [key: string]: string;\n    };\n\n    @Expose()\n    loop: boolean;\n\n    @Expose()\n    customData: {\n        [key: string]: any;\n        postprocess: PostProcessingEffect[];\n        particleSystems?: string[]\n    };\n\n    @Expose()\n    clippingPlanes: ClippingPlanes;\n\n    @Expose()\n    ui: ChapterUIModel;\n\n    @Expose()\n    graph: ChapterGraphModel;\n\n    @Expose()\n    viewModes: any;\n\n    @Expose()\n    recipes: any;\n\n    @Expose()\n    transparencyMode: TransparencyModeEnum;\n\n    @Expose()\n    fallbackTransparency: any;\n\n    @Expose()\n    effects: any;\n\n    @Expose()\n    environment: any;\n    \n    @Expose()\n    pickThroughObjects: Record<string, boolean>;\n    \n    @Expose()\n    showObjects: ShowObjects;\n\n    @Expose()\n    options: any;\n\n    @Expose()\n    media: {\n        [key: string]: MediaModel;\n    };\n\n    @Expose()\n    legend: ChapterLegendModel[];\n\n    @Expose()\n    visibilityLayers: VisibilityLayersModel;\n\n    @Expose()\n    contentBlocks: ContentBlock[];\n\n    // new data not in human chapter\n    readyState: ChapterReadyStateModel;\n}\n","export enum ClipId {\n  LeftClip = 0,\n  RightClip = 1,\n  BottomClip = 2,\n  TopClip = 3,\n  FrontClip = 4,\n  BackClip = 5\n}\n\nexport type ClipDirection =\n  | 'left'\n  | 'right'\n  | 'top'\n  | 'bottom'\n  | 'front'\n  | 'back';\n\nexport const ClipIdForDirection: Record<ClipDirection, ClipId> = {\n  left: ClipId.LeftClip,\n  right: ClipId.RightClip,\n  bottom: ClipId.BottomClip,\n  top: ClipId.TopClip,\n  front: ClipId.FrontClip,\n  back: ClipId.BackClip\n};\n\nexport const directionForClipId: Record<ClipId, ClipDirection> = {\n  0: 'left',\n  1: 'right',\n  2: 'bottom',\n  3: 'top',\n  4: 'front',\n  5: 'back'\n};\n\nexport interface ClippingPlane {\n  progress: number;\n  fadeDistance: number;\n  enabled: boolean;\n  fade: boolean;\n  clipId: ClipId;\n}\n\nexport interface ClipBoundaries {\n  xmin: number;\n  xmax: number;\n  ymin: number;\n  ymax: number;\n  zmin: number;\n  zmax: number;\n}\n\nexport interface ClippingPlanes {\n  clips: Record<ClipDirection, ClippingPlane>;\n  boundary?: ClipBoundaries;\n  enabled: boolean;\n}\n","export enum ContentType {\n    Bookmark = 'bookmark',\n    Module = 'module',\n    Internal = 'internal'\n}\n","\n// one-to-one mapping of errand type to legacy action\nexport enum ErrandType {\n    flyToChapter = 'flyToChapter',\n    flyToObject = 'flyToObject',\n    flyToCamera = 'flyToCamera'\n}\n\n","import { ErrandInterface } from './errand.model';\nimport { CameraModel } from 'src/app/engine/models/camera.model';\nimport { ErrandType } from './errand-type.enum';\n\nexport class FlyToCameraErrandModel implements ErrandInterface {\n    type = ErrandType.flyToCamera;\n    value: CameraModel;\n    params?: {\n        duration: number;\n    };\n\n    constructor(\n        cameraPosition: CameraModel\n    ) {\n        this.value = cameraPosition;\n    }\n}\n","import { ErrandInterface } from './errand.model';\nimport { ErrandType } from './errand-type.enum';\n\nexport class FlyToChapterErrandModel implements ErrandInterface {\n    type = ErrandType.flyToChapter;\n    value = null;\n\n    constructor() { }\n}\n","import { ErrandInterface } from './errand.model';\nimport { ErrandType } from './errand-type.enum';\n\nexport class FlyToObjectErrandModel implements ErrandInterface {\n    type = ErrandType.flyToObject;\n    value: string;\n    params?: {\n        duration: number;\n    };\n\n    constructor(\n        objectId: string | null\n    ) {\n        this.value = objectId;\n    }\n}\n","import { HotspotTypeEnum } from './hotspot.types.enum';\nimport { HotspotThemesEnum } from './hotspot.themes.enum';\nimport { ContentBlock } from 'src/app/content-blocks/models/content-block';\n\nexport class HotspotModel {\n  // positioning ================================================\n  pos?: [number, number, number];\n  primitiveIndex?: number;\n  barycentric?: [number, number, number];\n  renderableIndex?: number;\n  dir: [number, number, number];\n  objectId: string;\n  \n  // styling ====================================================\n  shown: boolean;\n  type: HotspotTypeEnum;\n  symbol: string;\n  className: string; // e.g. \"circle minus label\"\n  theme?: HotspotThemesEnum;\n\n  // actions ===================================================\n  actionSrc?: string;\n  actions?: string[];\n\n  // label properties ==========================================\n  title?: string;\n  description?: string;\n  labelOffset?: [number, number];\n\n  // Content Blocks\n  contentBlocks?: ContentBlock[];\n\n}\n","\nexport enum HotspotThemesEnum {\n  classicAnnotation = 'classic-annotation',\n  classicHotspot = 'classic-hotspot',\n  studioNext = 'studio-light'\n}\n","export enum HotspotTypeEnum {\n  Circle = 'circle',\n  CirclePlus = 'circle-plus',\n  CircleMinus = 'circle-minus',\n  Label = 'label',\n  CircleLabel = 'circle-label'\n}\n","\nexport enum LabelCollapseModeEnum {\n  Toggle = 'toggle',\n  None = 'none'\n}\n","export enum LabelPinType {\n    Default = 'default',\n    Plus = 'plus',\n    Minus = 'minus',\n    PlusMinus = 'plusMinus',\n    Sequential = 'sequential', \n    None = 'None'\n}\n","export enum LabelSequentialType {\n    Alphabetical = 'alphabetical', \n    Numerical = 'numerical'\n}\n\n","import { ErrandInterface } from '../errands/errand.model';\n\nexport class LabelStateModel {\n  id: string;\n  title: string | null = null;\n  description: string | null = null;\n  errands: ErrandInterface[] = [];\n}\n","\nexport enum LabelThemeEnum {\n  Annotation = 'annotation',\n  Classic = 'classic',\n  StudioNext = 'studioNext',\n  Context = 'context'\n}\n","import { LabelPinType } from './label-pin-type.enum';\nimport { CameraModel } from '../../../engine/models/camera.model';\nimport { LabelThemeEnum } from './label-theme.enum';\nimport { LabelStateModel } from './label-state.model';\nimport { LabelSequentialType } from './label-sequential-type.enum';\nimport { ContentBlock } from 'src/app/content-blocks/models/content-block';\n\nexport class LabelModel {\n    constructor(\n        title: string\n    ) {\n        this.title = title;\n    }\n\n    // -------- NEW VALUES --------\n    // Values created for Human Studio Next, which are currently not returned or expected by the server. \n\n    id: string; // Uses `annotationId` when available.\n    chapterId: string;\n\n    pinType: LabelPinType = LabelPinType.PlusMinus;\n    sequentialType: LabelSequentialType = LabelSequentialType.Alphabetical;\n    theme: LabelThemeEnum = LabelThemeEnum.StudioNext;\n\n    expandTag = true;\n    showDescription = true;\n    collapseDescription = false;\n\n    pinGlow = false;\n\n    hideWire = false;\n    hideTag = false;\n\n    // Label States\n    states: LabelStateModel[];\n\n    flyTo: boolean;\n    flyToTarget: string;\n    cameraPosition: CameraModel;\n\n    // -------- COMMON VALUES --------\n    // Values returned by the server, used by Human Studio. No conversion needed.  \n\n    // IDs\n    objectId?: string; // ID of attached to node, could be in free space\n\n    // Content\n    title: string;\n    description: string;\n\n    // Content Blocks\n    contentBlocks?: ContentBlock[];\n\n    // Position (Object)\n    // Only when object ID. If not populated, pin will place in the center of the object.\n    barycentric?: [number, number, number]; // 0, 0, 0 = center of object\n    primitiveIndex: number; // Which triangle is the pin bound to. Only when object ID.\n    dir?: [number, number, number]; // Direction - the marker pointing at something.\n    renderableIndex?: number; // which renderable of an object (default to 0)\n\n    // Position (Unbound)\n    pos: [number, number, number]; // Absolute position in world. \n    offset: [number, number]; // How far away is the tag from the pin\n\n    // Visibility\n    shown: boolean;\n    labelShown: boolean;\n    occludable: boolean;\n}\n","// What type of media controls to display in the viewer\nexport enum MediaEnum {\n  None = 'none',\n  Small = 'small',\n  Full = 'full'\n}\n","export class MediaModel {\n    data: {\n        clipId: string;\n        streamType: 'audio' | 'video'; // media type   \n        alternatives: string[]; // optional supported types (i.e., 'mp3', 'm4a', 'oog')\n        fullUrl: string;\n        time1: number; // start time\n        time2: number; // end time\n    };\n}\n","declare const immer: {\n    readonly immerable: unique symbol;\n};\n// #NOTE: [EM] This model shold also contain story type\nexport class StoryChapterThumbnail {\n    [immer.immerable] = true;\n    storyId: string;\n    chapterId: string;\n    urls: {\n        small: string,\n        large: string\n    };\n    snapshot?: string;\n}\n","export class StoryTranslationMetaInfo {\n    title: string;\n    description: string;\n}\n\nexport class StoryTranslationChapterModel extends StoryTranslationMetaInfo  {\n    annotations?: StoryTranslationMetaInfo[];\n    hotspots?: StoryTranslationMetaInfo[];\n}\n\nexport class StoryTranslationModel {\n\n    displayName: string;\n    description: string;\n    iso_639_1: string;\n    language: string;\n\n    chapters?: StoryTranslationChapterModel[];\n\n    hotspots?: StoryTranslationMetaInfo[];\n\n    objects?: {\n        [key: string]: string; \n    };\n}\n","import { SceneGraphNode } from 'src/app/engine/models/scene-graph.model';\nimport { UIConfigModel } from 'src/app/story/models/ui-config.model';\n\n// Instructs loader what to do on load complete\nexport class StoryAnimationModel {\n    scrub?: { time: number };\n    play?: {\n        startChapterId?: string;\n        startTime?: number;\n        finishChapterId?: string;\n        finishTime?: number;\n        numChapters?: number;\n    };\n}\nimport { CameraModel } from '../../engine/models/camera.model';\nimport { Type } from 'class-transformer';\nimport { TweenParticleLookupModel } from './tween-particle-lookup.model';\n\n\nexport class AssetLibrary {\n    lights: string[];\n    tweens: string[];\n    regionMaps: string[];\n    reflections: string[];\n}\n\nexport class StoryModel {\n    // Types -----------------------------------------------------\n    @Type(() => SceneGraphNode)\n    @Type(() => CameraModel)\n    @Type(() => UIConfigModel)\n\n    // Model -----------------------------------------------------\n    moduleId: string; // Just \"id\"\n    displayName: string;\n    description: string;\n    camera: CameraModel;\n    chapters: any[];\n    stateId: string[];\n    assetLibraries: AssetLibrary;\n    sceneGraph: SceneGraphNode[];\n    ui: UIConfigModel;\n    animation: StoryAnimationModel;\n    tags: string[];\n    customData: any; // playground for experimental data\n    reflections: { [key: string]: string }; // shortcut ids for use in materials.\n    colorRecipes: any;\n    tweenParticleLookup: TweenParticleLookupModel;\n    showObjects?: any;\n    selectObjects?: any;\n    pickThroughObjects?: any;\n    synchronization?: any;\n}\n","import {HumanObjectTransform} from '../../edit/models/scene-graph-node';\n/* Synchronization is the process by which the state of any and every object of\nthe graph with a single traversal.\n\nSynchronization is the most expensive step in chapter activation. We can\nminimize the cost by enforcing full state setting in a single graph traversal.\n\nSynchronization should also unambiguously set the state given partial record of\nstate. It does this through inheritable properties. With inheritable properties,\na node in the graph's property is inherited from its parent unless an explicit\noverride is listed in the synchronization object - that overwritten state is\nthen inheritable record as synchronization proceeds down the tree.\n\nNot all properties are inheritable, however. Transforms, for example, are meant\nto match exactly to the node in the graph on which it is defined in the\nsynchronization object.\n\nINHERITABLE attributes 1 - shown 2 - pickable 3 - selected 4 - opacity 5 -\ncolorRecipes[id] 6 - colorMods\n\nUNINHERITABLE attributes 1 - transform\n\nA note on colorMods. Why is each channel of type 'boolean | number'? There is no\nnumber value equivalent to 'no modification'. Therefore, in order to support\ninheritance through synchronization, a channel set to false will terminate the\nmodfiication.\n*/\n\nexport class SynchronizationModel {\n    [key: string]: {\n        shown?: boolean,\n        pickable?: boolean,\n        selected?: boolean,\n        opacity?: number,\n        transform?: HumanObjectTransform,\n        xray?: boolean,\n        colorRecipes?: {\n            [key: string]: {\n                [key: string]: boolean\n            }\n        },\n        colorMods?: {\n            tintColor?: boolean | number[],\n            saturation?: boolean | number,\n            contrast?: boolean | number,\n            brightness?: boolean | number,\n            opacity?: boolean | number\n        }\n    }\n}\n","export class UIConfigModel {\n    // Simple Configs\n    bookmarkTour: boolean;\n    annotations: boolean;\n    audio: boolean;\n    info: boolean;\n    loadProgress: boolean;\n    fullscreen: boolean;\n    pan: boolean;\n    zoomIn: boolean;\n    zoomOut: boolean;\n    zoom: boolean;\n    center: boolean;\n    cameraMode: boolean;\n    objectTree: boolean;\n    crossSection: boolean;\n    dissect: boolean;\n    isolate: boolean;\n    xray: boolean;\n    actionsTour: boolean;\n    \n    // Advanced Configs\n    playPause: boolean | {tour: boolean};\n    objectSlider: boolean | {objects: boolean};\n    scrubber: boolean | {chapters: boolean, tour: boolean};\n    tour: boolean | {chapters: boolean};\n\n}\n","export class VisibilityLayerModel {\n    name: string;\n    objectIds: string[];\n}\n\nexport class VisibilityLayersModel {\n    current: {\n        index?: number;\n        position?: number;\n        layers?: VisibilityLayerModel[];\n    };\n    src: {\n        initIndex?: number;\n        layers?: VisibilityLayerModel[];\n    };\n}\n","import { ClippingPlanes, ClipId } from '../../models/clipping-plane.model';\n\nexport const defaultClippingPlanes: ClippingPlanes = {\n  enabled: false,\n  clips: {\n    left: {\n      clipId: ClipId.LeftClip,\n      enabled: false,\n      fade: false,\n      fadeDistance: 0,\n      progress: 0\n    },\n    right: {\n      clipId: ClipId.RightClip,\n      enabled: false,\n      fade: false,\n      fadeDistance: 0,\n      progress: 0\n    },\n    back: {\n      clipId: ClipId.BackClip,\n      enabled: false,\n      fade: false,\n      fadeDistance: 0,\n      progress: 0\n    },\n    front: {\n      clipId: ClipId.FrontClip,\n      enabled: false,\n      fade: false,\n      fadeDistance: 0,\n      progress: 0\n    },\n    top: {\n      clipId: ClipId.TopClip,\n      enabled: false,\n      fade: false,\n      fadeDistance: 0,\n      progress: 0\n    },\n    bottom: {\n      clipId: ClipId.BottomClip,\n      enabled: false,\n      fade: false,\n      fadeDistance: 0,\n      progress: 0\n    }\n  }\n};\n","import { ChapterModel } from '../../models/chapter.model';\nimport { StoryChapterThumbnail } from '../../models/story-chapter-thumbnail.model';\nimport { BackgroundModel } from 'src/app/engine/models/background.model';\nimport { ScreenDimensions } from 'src/app/shared/models/screen.dimensions.model';\nimport { CameraModel } from 'src/app/engine/models/camera.model';\nimport { ImageTypeEnum } from 'src/app/shared/image.service';\nimport { ClipDirection, ClippingPlane } from '../../models/clipping-plane.model';\n\nimport { ChapterUIModel } from '../../models/chapter-ui.model';\nimport { PostProcessingEffect } from 'src/app/engine/models/post-processing/effects';\nimport { TransitionModel } from '../../models/transition.model';\nimport { TransparencyModeEnum } from 'src/app/engine/models/post-processing/transparency-mode.enum';\nimport { ChapterLegendModel } from '../../models/chapter-legend.model';\nimport { Patch } from 'src/vendor/immer-6.0.9/compat/pre-3.7/dist/immer';\n\nimport { VisibilityLayerModel } from 'src/app/story/models/visibility-layers.model';\n\nexport class ApplyChapterPatch {\n  static readonly type = '[Story Chapter] Apply Patch';\n  constructor(public patches: Patch[]) {}\n}\n\nexport class NextChapter {\n  static readonly type = '[Story Chapter] Next Chapter';\n  constructor() { }\n}\n\nexport class PreviousChapter {\n  static readonly type = '[Story Chapter] Previous Chapter';\n  constructor() { }\n}\n\nexport class FirstChapter {\n  static readonly type = '[Story Chapter] First Chapter';\n  constructor() { }\n}\n\nexport class LastChapter {\n  static readonly type = '[Story Chapter] Last Chapter';\n  constructor() { }\n}\n\nexport class SelectChapter {\n  static readonly type = '[Story Chapter] Select Chapter';\n  constructor(public chapter?: ChapterModel) { }\n}\n\nexport class SelectChapterById {\n  static readonly type = '[Story Chapter] Select Chapter by chapter id';\n  constructor(public chapterId: string) { }\n}\n\nexport class SetChapters {\n  static readonly type = '[Story Chapter] Set Chapters';\n  constructor(public chapters: ChapterModel[]) { }\n}\n\nexport class SetChapterCameraAction {\n  static readonly type = '[Story Chapter] Set Chapter Camera Action';\n  constructor(public chapterId: string, public cameraAction: 'jumpTo' | 'flyTo') { }\n}\n\nexport class SetChapterUI {\n  static readonly type = '[Story Chapter] Set Chapter UI';\n  constructor(public chapterId: string, public ui: ChapterUIModel) { }\n}\n\nexport class SetChapterInfo {\n  static readonly type = '[Story Chapter] Set Chapter Info';\n  constructor(public chapterId: string, public info: ChapterModel['info']) { }\n}\n\nexport class SetChapterLegend {\n  static readonly type = '[Story Chapter] Set Chapter Legend';\n  constructor(public chapterId: string, public legend: ChapterModel['legend']) { }\n}\n\nexport class AddToChapterLegend {\n  static readonly type = '[Story Chapter] Add To Chapter Legend';\n  constructor(public chapterId: string, public legend: ChapterLegendModel) { }\n}\n\nexport class ReorderChapters {\n  static readonly type = '[Story Chapter] Reorder Chapters';\n  constructor(public previousIndex: number, public currentIndex: number) { }\n}\n\nexport class SetChapterReadyState {\n  static readonly type = '[Story Chapter] Set Readystate';\n  constructor(public chapterId: string, public readyState: {model?: boolean, animation?: boolean}) { }\n}\n\n\nexport class SetChapterPostProcessing {\n  static readonly type = '[Story Chapter] Set Chapter PostProcessing';\n  constructor(public chapterId: string, public effects: PostProcessingEffect[], public properties: any) { }\n}\n\nexport class SetChapterTransitions {\n  static readonly type = '[Story Chapter] Set Chapter Transitions';\n  constructor(public chapterId: string, public transition: TransitionModel, public key: 'pre' | 'post') { }\n}\n\nexport class SetChapterTransparencyMode {\n  static readonly type = '[Story Chapter] Set Chapter Transparency Mode';\n  constructor(public chapterId: string, public transparencyMode: TransparencyModeEnum) {}\n}\n\nexport class SetChapterIds {\n  static readonly type = '[Story Chapter] Set Chapters Ids';\n  constructor(public chapterIds: string[]) { }\n}\n\nexport class SetChapterClippingPlane {\n  static readonly type = '[Story Chapter] Set Chapter Clipping Planes';\n  constructor(\n    public chapterId: string,\n    public clips: Record<ClipDirection, ClippingPlane>,\n    public enabled: boolean,\n    public record: boolean\n  ) {}\n}\n\nexport class SetChapterBackground {\n  static readonly type = '[Story Chapter] Set Chapter Background';\n  constructor(public chapterId: string, public background: BackgroundModel) { }\n}\n\nexport class SetAllChaptersBackground {\n  static readonly type = '[Story Chapter] Set All Chapters Background';\n  constructor(public background: BackgroundModel) { }\n}\n\nexport class ResetSelectedChapterBackground {\n  static readonly type = '[Story Chapter] Reset Selected Chapter Background';\n  constructor() { }\n}\n\nexport class SetSelectedChapterBackground {\n  static readonly type = '[Story Chapter] Set Selected Chapter Background';\n  constructor(public background: BackgroundModel) { }\n}\n\n\nexport class DuplicateChapter {\n  static readonly type = '[Story Chapter] Duplicate An Existing Chapter';\n  constructor(public chapter: ChapterModel, public chapterId: string) {}\n}\n\nexport class RemoveChapter {\n  static readonly type = '[Story Chapter] Remove Chapter';\n  constructor(public chapter: ChapterModel) { }\n}\n\nexport class ResetStoryChapters {\n  static readonly type = '[Story Chapter] Reset';\n  constructor() { }\n}\n\n\nexport class RegisterChapterThumbnails {\n  static readonly type = '[Story Chapters] Register thumbnail URLs from story';\n  constructor(public thumbnails: Map<string, StoryChapterThumbnail>) {}\n}\n\n\nexport class CopyThumbnail {\n  static readonly type = '[Story Chapters] Copy Thumbnail From Chapter';\n  constructor(public sourceChapter: ChapterModel, public targetChapter: ChapterModel) {}\n}\n\nexport class TakeChapterPicture {\n  static readonly type = '[Story Chapters] Take picture';\n  constructor(\n    public chapterId: string,\n    public imageType = ImageTypeEnum.JPEG,\n    public imageQuality = 0.92,\n    public dimensions?: ScreenDimensions,\n    public crop: 'original' | 'square' = 'original',\n    public includeLabels?: boolean, \n    public includeCopyright?: boolean,\n    public layers: HTMLCanvasElement[] = []\n  ) {\n  }\n}\n\nexport class TakeChapterPictureSuccess {\n  static readonly type = '[Story Chapters] Take picture success';\n  constructor(public chapterId: string, public blob: Blob, public dimensions: ScreenDimensions) {}\n}\n\nexport class RecordCamera {\n  static readonly type = '[Story Chapters] Record Camera';\n  constructor(public chapterId: string, public camera: CameraModel) {}\n}\n\nexport class SetChapterCurrentLayers {\n  static readonly type = '[Story Chapters] Set the current visibility layers';\n  constructor(\n    public chapterId: string, \n    public layers: VisibilityLayerModel[]\n  ) {}\n}\n\nexport class SetChapterCurrentLayersIndexPosition {\n  static readonly type = '[Story Chapters] Set the current visibility layers index and position';\n  constructor(\n    public chapterId: string, \n    public index: number, \n    public position: number,\n    public record: boolean\n  ) {}\n}\n\nexport class SetChapterMedia {\n  static readonly type = '[Story Chapters] Set the media object';\n  constructor(\n    public chapterId: string, \n    public media: object\n  ) {}\n}\n\nexport class SetChapterContentBlocks {\n  static readonly type = '[Story Chapters] Set the content blocks';\n  constructor(\n    public chapterId: string, \n    public contentBlocks: object\n  ) {}\n}\n","import { ChapterModel } from '../../models/chapter.model';\nimport { StoryChapterThumbnail } from '../../models/story-chapter-thumbnail.model';\nimport { Patch } from 'src/vendor/immer-6.0.9/compat/pre-3.7/dist/immer';\n\n\nexport class StoryChaptersStateModel {\n    loading: boolean;\n    chapters: ChapterModel[];\n    chaptersViewed: string[];\n    selectedChapter: string;\n    isChapterAnimated: boolean;\n    thumbnails: Map<string, StoryChapterThumbnail>;\n    patches: Patch[];\n    inversePatches: Patch[];\n}\n","import { State, Action, StateContext, Selector, Select, Store, actionMatcher, SelectorOptions, createSelector } from '@ngxs/store';\nimport { StoryChaptersStateModel } from './story.chapters.state.model';\nimport { \n  SetChapters,\n  SelectChapter,\n  NextChapter,\n  PreviousChapter,\n  LastChapter,\n  FirstChapter,\n  RemoveChapter, \n  ResetStoryChapters,\n  RegisterChapterThumbnails,\n  TakeChapterPicture,\n  TakeChapterPictureSuccess,\n  DuplicateChapter,\n  CopyThumbnail,\n  SetAllChaptersBackground,\n  SetSelectedChapterBackground,\n  ResetSelectedChapterBackground,\n  SetChapterBackground,\n  SelectChapterById,\n  RecordCamera,\n  SetChapterClippingPlane,\n  ApplyChapterPatch,\n  SetChapterCameraAction,\n  SetChapterUI,\n  SetChapterInfo,\n  ReorderChapters,\n  SetChapterReadyState,\n  SetChapterPostProcessing,\n  SetChapterTransitions,\n  SetChapterTransparencyMode,\n  SetChapterLegend,\n  AddToChapterLegend,\n  SetChapterCurrentLayers,\n  SetChapterCurrentLayersIndexPosition,\n  SetChapterMedia,\n  SetChapterContentBlocks\n} from './story.chapters.actions';\n\nimport { ChapterService } from '../../chapter.service';\nimport { RemoveAllChapterLabels, CopyLabels } from '../labels/story.labels.actions';\nimport { classToClass } from 'class-transformer';\nimport { SnapshotService } from 'src/app/engine/snapshot.service';\nimport { SetVisible } from 'src/app/engine/state/engine.actions';\nimport { StoryChapterThumbnail } from '../../models/story-chapter-thumbnail.model';\nimport { get, cloneDeep } from 'lodash';\nimport { ChapterModel } from '../../models/chapter.model';\nimport { BackgroundModel } from 'src/app/engine/models/background.model';\nimport { appDefaultBackground } from 'src/app/dialogs/components/background-color-dialog/background-config';\nimport { ThumbnailConstants } from 'src/app/shared/thumbnail.constants';\nimport { ImageTypeEnum, ImageService } from 'src/app/shared/image.service';\nimport { SnapshotConfig } from 'src/app/engine/models/snapshot-config.model';\nimport { AnimationService } from 'src/app/engine/animation.service';\nimport { MediaModel } from '../../models/media.model';\nimport { ColorUtils } from 'src/app/shared/libraries/colors/colors';\n\nimport { EngineService } from 'src/app/engine/engine.service';\nimport { UndoActions } from 'src/app/undo/state/undo.state.actions';\nimport { moveItemInArray } from '@angular/cdk/drag-drop';\nimport { NodeActions } from 'src/app/engine/state/nodes/engine.nodes.actions';\nimport { ChapterReadyStateModel } from '../../models/chapter-ready-state.model';\nimport { VisibilityLayerModel } from '../../models/visibility-layers.model';\nimport { ContentBlock } from 'src/app/content-blocks/models/content-block';\n\ndeclare const immer;\n\n\n// snapshot config\nconst defaultSnapshotConfig: SnapshotConfig = {\n  imageType: ImageTypeEnum.JPEG,\n  crop: 'original',\n\n  copyrightEnabled: false,\n  copyrightImagePath: 'assets/images/powered-by-biodigital-color.svg',\n  copyrightPosition: {\n      x: 'left',\n      y: 'bottom'\n  },\n  copyrightOffset: {\n      x: 12,\n      y: -12\n  },\n  imageQuality: 1.0\n};\n\nconst initialState: StoryChaptersStateModel = {\n  loading: false,\n  chapters: [],\n  chaptersViewed: [],\n  selectedChapter: null,\n  isChapterAnimated: false,\n  thumbnails: new Map(),\n  patches: [],\n  inversePatches: []\n};\n\n@State<StoryChaptersStateModel>({\n  name: 'storyChapters',\n  defaults: initialState\n})\nexport class StoryChaptersState {\n  /**\n   * Selectors\n   */\n  @Selector()\n  static getStoryChapters(state: StoryChaptersStateModel) {\n    return state.chapters;\n  }\n\n  @Selector()\n  static getChaptersViewed(state: StoryChaptersStateModel) {\n    return state.chaptersViewed;\n  }\n\n  static getChapter(chapterId: string) {\n    return createSelector([StoryChaptersState], (state: StoryChaptersStateModel) => {\n      return state.chapters.find(chapter => chapter.id === chapterId);\n    });\n  }\n\n  @Selector()\n  static getSelectedChapterId(state: StoryChaptersStateModel) {\n    return state.selectedChapter;\n  }\n\n  @Selector()\n  static getSelectedChapter(state: StoryChaptersStateModel) {\n    return state.chapters.find(chapter => chapter.id === state.selectedChapter) || null;\n  }\n\n  @Selector()\n  static getNextChapter(state: StoryChaptersStateModel) {\n    const index = 1 + StoryChaptersState.getSelectedChapterIndex(state);\n    return state.chapters[index];\n  }\n\n  @Selector()\n  static getPreviousChapter(state: StoryChaptersStateModel) {\n    const index = -1 + StoryChaptersState.getSelectedChapterIndex(state);\n    return state.chapters[index];\n  }\n\n  @Selector()\n  static getSelectedChapterIndex(state: StoryChaptersStateModel) {\n    return state.chapters.findIndex(chapter => chapter.id === state.selectedChapter);\n  }\n\n  @Selector()\n  static getSelectedChapterTitle(state: StoryChaptersStateModel) {\n    return state.chapters.find(chapter => chapter.id === state.selectedChapter).info.displayName;\n  }\n\n  @Selector()\n  static getChapterCount(state: StoryChaptersStateModel) {\n    return state.chapters.length;\n  }\n\n  @Selector()\n  static getRegisteredThumbnails(state: StoryChaptersStateModel) {\n    return state.thumbnails;\n  }\n\n  @Selector()\n  static getIsChapterAnimated(state: StoryChaptersStateModel) {\n    return state.isChapterAnimated;\n  }\n\n  @Selector()\n  static getSelectedChapterReadyState(state: StoryChaptersStateModel) {\n    const { chapters, selectedChapter } = state;\n    const chapter = StoryChaptersState.findChapter(chapters, selectedChapter);\n    return get(chapter, 'readyState');\n  }\n\n  @Selector()\n  static getChaptersLoaded(state: StoryChaptersStateModel) {\n    return {\n      count: state.chapters.length,\n      modelChapters: state.chapters.filter(chapter => chapter.readyState.model),\n      animationChapters: state.chapters.filter(chapter => chapter.readyState.animation)\n    };\n  }\n\n  @Selector()\n  static getAllChaptersModelsReady(state: StoryChaptersStateModel) {\n    return state.chapters.length > 0 && state.chapters.every(chapter => chapter.readyState.model);\n  }\n\n  @Selector()\n  static getAllChaptersAnimationsReady(state: StoryChaptersStateModel) {\n    return state.chapters.length > 0 && state.chapters.every(chapter => chapter.readyState.animation);\n  }\n\n  @Selector()\n  static getSelectedChapterBackground(state: StoryChaptersStateModel) {\n    const { chapters, selectedChapter } = state;\n    const chapter = StoryChaptersState.findChapter(chapters, selectedChapter);\n    return get(chapter, 'background') || appDefaultBackground;\n  }\n\n  @Selector()\n  static getAllChaptersBackground(state: StoryChaptersStateModel) {\n    return state.chapters\n      .map((chapter) => get(chapter, 'background'));\n  }\n\n  @Selector()\n  static getSelectedChapterAudio(state: StoryChaptersStateModel) {\n    const selectedChapter = state.chapters.find(chapter => chapter.id === state.selectedChapter);    \n    if (selectedChapter && selectedChapter.media) {\n      const media: { [key: string]: MediaModel } = selectedChapter.media;\n      const audioClips = Object.values(media)\n        .filter(({ data }) => data.streamType === 'audio');\n      return audioClips[0];\n    } else {\n      return null;\n    }\n  }\n\n  @Selector()\n  static getSelectedChapterLegend(state: StoryChaptersStateModel) {\n    const { chapters, selectedChapter } = state;\n    const chapter = StoryChaptersState.findChapter(chapters, selectedChapter);\n    return get(chapter, 'legend') || [];\n  }\n\n  @Selector()\n  static getSelectedChapterClippingPlanes(state: StoryChaptersStateModel) {\n    const { chapters, selectedChapter } = state;\n    const chapter = StoryChaptersState.findChapter(chapters, selectedChapter);\n    return get(chapter, 'clippingPlanes');\n  }\n\n  @Selector()\n  static getChapterCamera(state: StoryChaptersStateModel) {\n    const { chapters, selectedChapter } = state;\n    const chapter = StoryChaptersState.findChapter(chapters, selectedChapter);\n    return get(chapter, 'camera.location');\n  }\n\n  static findChapter(chapters: ChapterModel[], chapterId: string): ChapterModel {\n    return chapters\n      .find((chapter) => chapter.id === chapterId);\n  }\n\n  @Selector()\n  static getAllChaptersCurrentLayers(state: StoryChaptersStateModel): Array<VisibilityLayerModel>[] {\n    return state.chapters\n      .map((chapter) => get(chapter, 'visibilityLayers.current.layers', []));\n  }\n\n  @Selector()\n  static getSelectedChapterSrcLayers(state: StoryChaptersStateModel): VisibilityLayerModel[] {\n    const { chapters, selectedChapter } = state;\n    const chapter = StoryChaptersState.findChapter(chapters, selectedChapter);\n    return get(chapter, 'visibilityLayers.src.layers', []);\n  }\n  \n  @Selector()\n  static getSelectedChapterCurrentLayers(state: StoryChaptersStateModel): VisibilityLayerModel[] {\n    const { chapters, selectedChapter } = state;\n    const chapter = StoryChaptersState.findChapter(chapters, selectedChapter);\n    return get(chapter, 'visibilityLayers.current.layers', []);\n  }\n\n  @Selector()\n  static getSelectedChapterCurrentLayersIndex(state: StoryChaptersStateModel): number {\n    const { chapters, selectedChapter } = state;\n    const chapter = StoryChaptersState.findChapter(chapters, selectedChapter);\n    return get(chapter, 'visibilityLayers.current.index');\n  }\n\n  @Selector()\n  static getSelectedChapterCurrentLayersPosition(state: StoryChaptersStateModel): number {\n    const { chapters, selectedChapter } = state;\n    const chapter = StoryChaptersState.findChapter(chapters, selectedChapter);\n    return get(chapter, 'visibilityLayers.current.position');\n  }\n\n  @Selector()\n  static getSelectedChapterContentBlocks(state: StoryChaptersStateModel): ContentBlock[] {\n    const { chapters, selectedChapter } = state;\n    const chapter = StoryChaptersState.findChapter(chapters, selectedChapter);\n    return get(chapter, 'contentBlocks', []);\n  }\n  \n\n  /**\n   * Actions\n   */\n  @Action(SetChapters)\n  setChapters(context: StateContext<StoryChaptersStateModel>, action: SetChapters) {\n    context.patchState(immer.produce(context.getState(), draft => {\n      draft.chapters = action.chapters;\n    }));\n  }\n\n\n  @Action(SetChapterCameraAction)\n  SetChapterCameraAction(context: StateContext<StoryChaptersStateModel>, action: SetChapterCameraAction) {\n    context.patchState(\n      immer.produce(context.getState(), draft => {\n        const chapter = draft.chapters.find(c => c.id === action.chapterId);\n        chapter.camera.action = action.cameraAction;\n      })\n    );\n  }\n\n  @Action(SetChapterUI)\n  setChapterUI(context: StateContext<StoryChaptersStateModel>, action: SetChapterUI) {\n    context.patchState(\n      immer.produce(context.getState(), draft => {\n        const chapter = draft.chapters.find(c => c.id === action.chapterId);\n        chapter.ui = action.ui;\n      })\n    );\n  }\n\n  @Action(SetChapterInfo)\n  setChapterInfo(context: StateContext<StoryChaptersStateModel>, action: SetChapterInfo) {\n    context.patchState(\n      immer.produce(context.getState(), draft => {\n        const chapter = draft.chapters.find(c => c.id === action.chapterId);\n        chapter.info = action.info;\n      })\n    );\n  }\n\n  @Action(SetChapterLegend)\n  setChapterLegend(context: StateContext<StoryChaptersStateModel>, action: SetChapterLegend) {\n    context.patchState(\n      immer.produce(context.getState(), draft => {\n        const chapter = draft.chapters.find(c => c.id === action.chapterId);\n        chapter.legend = action.legend;\n      })\n    );\n  }\n\n  @Action(AddToChapterLegend)\n  addToChapterLegend(context: StateContext<StoryChaptersStateModel>, action: AddToChapterLegend) {\n    context.patchState(\n      immer.produce(context.getState(), draft => {\n        const chapter = draft.chapters.find(c => c.id === action.chapterId);\n        chapter.legend.push(action.legend);\n      })\n    );\n  }\n\n  @Action(ReorderChapters)\n  ReorderChapters(context: StateContext<StoryChaptersStateModel>, action: ReorderChapters) {\n    context.patchState(\n      immer.produce(context.getState(), draft => {\n        moveItemInArray(draft.chapters, action.previousIndex, action.currentIndex);\n      })\n    );\n  }\n\n\n  @Action(SetChapterReadyState)\n  SetChapterReadyState(context: StateContext<StoryChaptersStateModel>, action: SetChapterReadyState) {\n    const nextState = immer.produce(context.getState(), draft => {\n      if (action.chapterId) {\n        const chapter = draft.chapters.find(c => c.id === action.chapterId);\n        if (chapter) {\n          chapter.readyState = {...chapter.readyState, ...action.readyState};\n        }\n      }\n    });\n    context.patchState(nextState);\n  }\n\n  @Action(SetChapterPostProcessing)\n  SetChapterPostProcessing(context: StateContext<StoryChaptersStateModel>, action: SetChapterPostProcessing) {\n    context.patchState(\n      immer.produce(context.getState(), draft => {\n        const chapter = draft.chapters.find(c => c.id === action.chapterId);\n        const customData = chapter.customData ? chapter.customData : {};\n        const properties = chapter.properties || {};\n        chapter.customData = {...customData, postprocess: action.effects };\n        chapter.properties = {...properties, ...action.properties};\n      })\n    );\n  }\n\n  @Action(SetChapterTransitions)\n  SetChapterTransitions(context: StateContext<StoryChaptersStateModel>, action: SetChapterTransitions) {\n    context.patchState(\n      immer.produce(context.getState(), draft => {\n        const chapter = draft.chapters.find(c => c.id === action.chapterId);\n        chapter.transitions = chapter.transitions || {};\n        chapter.transitions[action.key] = action.transition;\n      })\n    );\n  }\n\n  @Action(SetChapterTransparencyMode) \n  SetChapterTransparencyMode(context: StateContext<StoryChaptersStateModel>, action: SetChapterTransparencyMode) {\n    context.patchState(\n      immer.produce(context.getState(), draft => {\n        const chapter = draft.chapters.find(c => c.id === action.chapterId);\n        chapter.transparencyMode = action.transparencyMode;\n      })\n    );\n  }\n\n  @Action(ApplyChapterPatch)\n  applyChapterPatch(context: StateContext<StoryChaptersStateModel>, action: ApplyChapterPatch) {\n    const patched = immer.applyPatches(context.getState(), action.patches);\n    context.patchState(\n      immer.produce(patched, draft => {\n        draft.patches = [];\n        draft.inversePatches = [];\n      })\n    );\n  }\n\n  @Action(SetChapterClippingPlane)\n  setChapterClippingPlane(context: StateContext<StoryChaptersStateModel>, action: SetChapterClippingPlane) {\n    const [nextState, patches, inversePatches] = immer.produceWithPatches(context.getState(), draft => {\n      const chapter = draft.chapters.find(c => c.id === action.chapterId);\n      chapter.clippingPlanes.clips = action.clips;\n      chapter.clippingPlanes.enabled = action.enabled;\n      chapter.clippingPlanes.boundary =\n        chapter.clippingPlanes.boundary ||\n        JSON.parse(JSON.stringify(this.engineService.getSceneBoundary()));\n    });\n\n    const finalState = immer.produce(nextState, draft => {\n      draft.patches.push(...patches);\n      draft.inversePatches.push(...inversePatches);\n    });\n\n    if (action.record) {\n      context.dispatch(\n        new UndoActions.SavePatches([{\n          forward: finalState.patches,\n          inverse: [...finalState.inversePatches].reverse(),\n          patchAction: ApplyChapterPatch\n        }])\n      );\n    }\n\n    context.patchState(\n      action.record\n        ? immer.produce(finalState, draft => {\n            draft.patches = [];\n            draft.inversePatches = [];\n          })\n        : finalState\n    );\n  }\n\n  @Action(SetChapterBackground)\n  setChapterBackground(context: StateContext<StoryChaptersStateModel>, action: SetChapterBackground) {\n    context.patchState(\n      immer.produce(context.getState(), draft => {\n        const chapter = draft.chapters.find(c => c.id === action.chapterId);\n        chapter.background = action.background;\n      })\n    );\n  }\n\n  @Action(SetAllChaptersBackground)\n  setAllChaptersBackground(context: StateContext<StoryChaptersStateModel>, action: SetAllChaptersBackground) {\n    context.patchState(\n      immer.produce(context.getState(), draft => {\n        draft.chapters.forEach(chapter => {\n          chapter.background = action.background;\n        });\n      })\n    );\n  }\n\n  @Action(ResetSelectedChapterBackground)\n  resetSelectedChapterBackground(context: StateContext<StoryChaptersStateModel>, action: ResetSelectedChapterBackground) {\n    const { selectedChapter } = context.getState();\n    this.store.dispatch(new SetChapterBackground(selectedChapter, appDefaultBackground));\n  }\n\n  @Action(SetSelectedChapterBackground)\n  setSelectedChapterBackground(context: StateContext<StoryChaptersStateModel>, { background }) {\n    const chapterId = context.getState().selectedChapter;\n    this.store.dispatch(new SetChapterBackground(chapterId, background));\n  }\n\n  @Action(SelectChapter)\n  selectChapter(context: StateContext<StoryChaptersStateModel>, action: SelectChapter) {\n    if (!action.chapter) {\n      return;\n    }\n\n    this.store.dispatch([\n      new NodeActions.UpdateNodesChecked(false),\n      new NodeActions.UpdateNodeSelected()\n    ]);\n\n    const isAnimated = this.animationService.isChapterAnimated(action.chapter);\n    this.store.dispatch(new SetVisible(action.chapter ? true : false));\n\n    const nextState = immer.produce(context.getState(), draft => {\n      if (!draft.chaptersViewed.some(chapterId => action.chapter.id === chapterId)) {\n        draft.chaptersViewed.push(action.chapter.id);\n      }\n      draft.selectedChapter = action.chapter ? action.chapter.id : null;\n      draft.isChapterAnimated = isAnimated;\n    });\n    context.patchState(nextState);\n  }\n\n  @Action(SelectChapterById)\n  selectChapterById(context: StateContext<StoryChaptersStateModel>, {chapterId}) {\n    this.store.dispatch(new SetVisible(true));\n    context.patchState({\n      selectedChapter: chapterId\n    });\n  }\n\n\n  @Action(DuplicateChapter)\n  duplicateChapter(context: StateContext<StoryChaptersStateModel>, action: DuplicateChapter) {\n    // create a safe chapter copy\n    const sourceChapter = action.chapter;\n    const targetChapter = this.chapterService.copyChapter(sourceChapter, action.chapterId);\n    \n    // insert chapter copy into ENGINE\n    const chapters = context.getState().chapters;\n    const insertIndex = chapters.length;\n    \n    // #NOTE: [EM] deep copy is important. Otherwise engine replaces timeline map object.\n    this.chapterService.addChapterToEngine(cloneDeep(targetChapter), insertIndex); \n\n    // update application STATE\n    context.patchState(immer.produce(context.getState(), draft => {\n      draft.chapters.push(targetChapter);\n    }));\n\n    context.dispatch(new CopyLabels(sourceChapter, targetChapter));\n    context.dispatch(new CopyThumbnail(sourceChapter, targetChapter));\n  }\n\n  @Action(CopyThumbnail)\n  copyThumbnail(context: StateContext<StoryChaptersStateModel>, action: CopyThumbnail) {\n    // copy thumbnail or take new snapshot for target chapter\n    \n    if (action.sourceChapter) {\n      const thumbnails = context.getState().thumbnails;\n      const nextState = immer.produce(context.getState(), draft => {\n        // copy, and point snapshot to original large url\n        const sourceThumbnail = thumbnails.get(action.sourceChapter.id);\n        const targetThumbnail = new StoryChapterThumbnail();\n        targetThumbnail.storyId = sourceThumbnail.storyId;\n        targetThumbnail.chapterId = sourceThumbnail.chapterId;\n        targetThumbnail.urls = {\n          small: sourceThumbnail.urls.small.replace(\n            action.sourceChapter.id,\n            action.targetChapter.id\n          ),\n          large: sourceThumbnail.urls.large.replace(\n            action.sourceChapter.id,\n            action.targetChapter.id\n          )\n        };\n        targetThumbnail.snapshot = sourceThumbnail.snapshot\n          ? sourceThumbnail.snapshot\n          : sourceThumbnail.urls.large;\n      \n        draft.thumbnails.set(action.targetChapter.id, targetThumbnail);\n      });\n      \n      context.patchState(nextState);\n      \n    } else {\n      // take a snapshot\n      context.dispatch(new TakeChapterPicture(action.targetChapter.id, ImageTypeEnum.JPEG, 92, ThumbnailConstants.medium, 'square'));\n    }\n  }\n\n  @Action(NextChapter)\n  nextChapter(context: StateContext<StoryChaptersStateModel>, action: NextChapter) {\n    const chapters = context.getState().chapters;\n    const currentChapterId = this.chapterService.getCurrentChapterId();\n    let index = 0;\n    index = chapters.findIndex(chapter => chapter.id === currentChapterId);\n    if (index < chapters.length - 1) {\n      index++;\n    }\n    \n    context.dispatch(new SelectChapter(chapters[index]));\n  }\n\n  @Action(PreviousChapter)\n  previousChapter(context: StateContext<StoryChaptersStateModel>, action: PreviousChapter) {\n    const chapters = context.getState().chapters;\n    const currentChapterId = this.chapterService.getCurrentChapterId();\n    let index = 0;\n    index = chapters.findIndex(chapter => chapter.id === currentChapterId);\n    if (index > 0) {\n      index--;\n    }\n\n    context.dispatch(new SelectChapter(chapters[index]));    \n  }\n\n  @Action(LastChapter)\n  lastChapter(context: StateContext<StoryChaptersStateModel>, action: LastChapter) {\n    const chapters = context.getState().chapters;\n    \n    context.dispatch(new SelectChapter(chapters[chapters.length - 1]));\n  }\n\n  @Action(FirstChapter)\n  firstChapter(context: StateContext<StoryChaptersStateModel>, action: LastChapter) {\n    const chapters = context.getState().chapters;\n    \n    context.dispatch(new SelectChapter(chapters[0]));\n  }\n    \n  @Action(RemoveChapter)\n  removeChapter(context: StateContext<StoryChaptersStateModel>, action: RemoveChapter) {\n    const { chapters, selectedChapter } = context.getState();\n\n    // Don't allow the user to remove the last chapter,\n    // or else the system will break. \n    if (chapters.length === 1) {\n      return;\n    }\n\n    // Trigger a rebuild of the chapter object in the engine before updating the application. \n    this.chapterService.removeChapterFromEngine(action.chapter);\n\n    // Update chapters array\n    let chapterIndex = chapters.findIndex(chapter => chapter.id === action.chapter.id);\n    \n    context.patchState(immer.produce(context.getState(), draft => {\n      draft.chapters.splice(chapterIndex, 1);\n    }));\n\n    // Selected chapter deleted, need to select a new chapter by default\n    if (action.chapter.id === selectedChapter) {\n\n      // Make sure selected chapter doesn't exceed chapter array size\n      if (chapterIndex === chapters.length - 1) {\n        chapterIndex--;\n      }\n      \n      context.dispatch(new SelectChapter(chapters[chapterIndex]));\n    }\n\n    // Nuke all chapter labels\n    context.dispatch(new RemoveAllChapterLabels(action.chapter));\n  }\n  \n  @Action(ResetStoryChapters)\n  resetStoryChaptersState(context: StateContext<StoryChaptersStateModel>, action: ResetStoryChapters) {\n    context.setState(initialState);\n  }\n\n\n  @Action(RegisterChapterThumbnails)\n  registerChapterThumbnails(context: StateContext<StoryChaptersStateModel>, action: RegisterChapterThumbnails) {\n    // urls that came with scene for managing and housekeeping of server thumbnails per chapter\n    context.patchState(immer.produce(context.getState(), draft => {\n      draft.thumbnails = new Map(action.thumbnails);\n    }));\n  }\n\n  @Action(TakeChapterPicture)\n  takeChapterPicture(context: StateContext<StoryChaptersStateModel>, action: TakeChapterPicture) {\n    const { chapterId, includeLabels, includeCopyright, dimensions, imageType, imageQuality, crop, layers } = action;\n    // get target dimensions: fallback to default\n    const snapshotDimensions = dimensions ? dimensions : ThumbnailConstants.large;\n    const { width, height } = snapshotDimensions;\n\n    // get selected background\n    const selectedBackground = this.store.selectSnapshot(StoryChaptersState.getSelectedChapterBackground);\n\n    let snapshotBackground;\n    switch (imageType) {\n      case ImageTypeEnum.PNG:\n        snapshotBackground = selectedBackground ? selectedBackground : appDefaultBackground;\n        break;\n      case ImageTypeEnum.JPEG:\n      default:\n        snapshotBackground = selectedBackground && !BackgroundModel.isTransparent(selectedBackground) ? selectedBackground : appDefaultBackground;\n        break;\n    }\n\n    // get logo based on background color\n    const outerRGB = selectedBackground.colors.slice(0, 3) as [number, number, number];\n    const isLight = ColorUtils.isLight(outerRGB);\n\n    const snapshotConfig: SnapshotConfig = {\n      ...defaultSnapshotConfig,\n      crop: crop,\n      imageType: imageType,\n      imageQuality: imageQuality,\n      copyrightEnabled: includeCopyright,\n      copyrightImagePath: (isLight) ? 'assets/images/powered-by-biodigital-color.svg' : 'assets/images/powered-by-biodigital-white.svg'\n    };\n\n    setTimeout(() => {\n      this.snapshotService.takeSnapshot(width, height, snapshotBackground, layers, includeLabels, snapshotConfig)\n        .subscribe((blob) => {\n          context.dispatch(new TakeChapterPictureSuccess(chapterId, blob, snapshotDimensions));\n        });\n    });\n  }\n\n  @Action(TakeChapterPictureSuccess)\n  takeChapterPictureSuccess(context: StateContext<StoryChaptersStateModel>, action: TakeChapterPictureSuccess) {\n    context.patchState(\n      immer.produce(context.getState(), draft => {\n        const thumbnail =\n          draft.thumbnails.get(action.chapterId) || new StoryChapterThumbnail();\n        thumbnail.snapshot = URL.createObjectURL(action.blob);\n        draft.thumbnails.set(action.chapterId, thumbnail);\n      })\n    );\n  }\n\n  @Action(RecordCamera)\n  RecordCamera(context: StateContext<StoryChaptersStateModel>, action: RecordCamera) {\n    context.patchState(\n      immer.produce(context.getState(), draft => {\n        const chapter = draft.chapters.find(c => c.id === action.chapterId);\n        chapter.camera.location = action.camera;\n      })\n    );\n  }\n\n  @Action(SetChapterCurrentLayersIndexPosition)\n  setChapterCurrentLayersIndexPosition(context: StateContext<StoryChaptersStateModel>, action: SetChapterCurrentLayersIndexPosition) {\n    \n    const [nextState, patches, inversePatches] = immer.produceWithPatches(context.getState(), draft => {\n      const chapter = draft.chapters.find(c => c.id === action.chapterId);\n      const currentLayers = chapter.visibilityLayers.current;\n      currentLayers.index = action.index;\n      currentLayers.position = action.position;\n    });\n\n    const finalState = immer.produce(nextState, draft => {\n      draft.patches.push(...patches);\n      draft.inversePatches.push(...inversePatches);\n    });\n\n    context.patchState(finalState);\n    \n    if (action.record) {\n      context.dispatch(\n        new UndoActions.SavePatches([{\n          forward: finalState.patches,\n          inverse: finalState.inversePatches,\n          patchAction: ApplyChapterPatch\n        }])\n      );\n    }\n  }\n\n  @Action(SetChapterMedia)\n  setChapterMedia(context: StateContext<StoryChaptersStateModel>, action: SetChapterMedia) {\n    context.patchState(\n      immer.produce(context.getState(), draft => {\n        const chapter = draft.chapters.find(c => c.id === action.chapterId);\n        chapter.media = action.media;\n      })\n    );\n  }\n\n  @Action(SetChapterContentBlocks)\n  setChapterContentBlocks(context: StateContext<StoryChaptersStateModel>, action: SetChapterContentBlocks) {\n    context.patchState(\n      immer.produce(context.getState(), draft => {\n        const chapter = draft.chapters.find(c => c.id === action.chapterId);\n        chapter.contentBlocks = action.contentBlocks;\n      })\n    );\n  }\n\n  constructor(\n    private chapterService: ChapterService,\n    private snapshotService: SnapshotService,\n    private store: Store,\n    private animationService: AnimationService,\n    private engineService: EngineService\n  ) { }\n}\n","import { LabelModel } from '../../models/labels/label.model';\nimport { ChapterModel } from '../../models/chapter.model';\nimport { LabelCollapseModeEnum } from '../../models/labels/label-collapse-mode';\n\nimport { LabelThemeEnum } from '../../models/labels/label-theme.enum';\nimport { Patch } from 'src/vendor/immer-6.0.9/compat/pre-3.7/dist/immer';\n\n\nexport class PatchLabels {\n  static readonly type = '[Story Labels] Patch Labels';\n  constructor(public patches: Patch[]) {}\n}\n\nexport class SetLabelOffset {\n  static readonly type = '[Story Labels] Set label Offset';\n  constructor(public labelId: string, public offset: [number, number]) {}\n}\n\nexport class SetLabels {\n  static readonly type = '[Story Labels] Set Labels';\n  constructor(public labels: LabelModel[]) { }\n}\n\nexport class AddLabel {\n  static readonly type = '[Story Labels] Add Label';\n  constructor(public label: LabelModel) { }\n}\n\nexport class AddContextLabel {\n  static readonly type = '[Story Labels] Set Contexdt Label';\n  constructor(public label: LabelModel) { }\n}\n\nexport class CopyLabels {\n  static readonly type = '[Story Labels] Copy Labels';\n  constructor(public sourceChapter: ChapterModel, public targetChapter: ChapterModel) { }\n}\n\nexport class RemoveLabel {\n  static readonly type = '[Story Labels] Remove Label';\n  constructor(public label: LabelModel) { }\n}\n\nexport class RemoveContextLabel {\n  static readonly type = '[Story Labels] Remove Context Label';\n  constructor() { }\n}\n\n\nexport class RemoveAllChapterLabels {\n  static readonly type = '[Story Labels] Remove All Chapter Labels';\n  constructor(public chapter: ChapterModel) { }\n}\n\nexport class SetLabel {\n  static readonly type = '[Story Labels] Set Label';\n  constructor(public label: LabelModel, public record: boolean = false) { }  \n}\n\nexport class SetLabelStates {\n  static readonly type = '[Story Labels] Set Label States';\n  constructor(public id: LabelModel['id'], public states: LabelModel['states']) {}\n}\n\nexport class SetLabelScale {\n  static readonly type = '[Story Labels] Set Label Scale';\n  constructor(public scale: number) {}\n}\n\nexport class SelectLabel {\n  static readonly type = '[Story Labels] Select Label';\n  constructor(public label?: LabelModel) { }\n}\n\nexport class ResetLabels {\n  static readonly type = '[Story Labels] Reset';\n  constructor() { }\n}\n\nexport class ConvertLabels {\n  static readonly type = '[Story Labels] Convert';\n  constructor(public labels: LabelModel[], public fields: Partial<LabelModel>) { }\n}\n\nexport class EnableContextLabel {\n  static readonly type = '[Story Labels] Enable Context Label';\n  constructor(public enable: boolean, public enableInfo = true, public enableActions = true) { }\n}\n\nexport class SetLabelsShown {\n  static readonly type = '[Story Labels] Set Labels Shown';\n  constructor(public labels: LabelModel[], public shown: boolean) { }  \n}\n\nexport class SetAllLabelsShown {\n  static readonly type = '[Story Labels] Set All Labels Shown';\n  constructor(public show: boolean) { }  \n}\n\nexport class SetLabelsCollapsed {\n  static readonly type = '[Story Labels] Set Labels Collapsed';\n  constructor(public collapsed: boolean, public collapsedMode: LabelCollapseModeEnum = LabelCollapseModeEnum.None) { }  \n}\n\nexport class SetLabelsDraggable {\n  static readonly type = '[Story Labels] Set Draggable';\n  constructor(public draggable: { tag: boolean; pin: boolean }) { }  \n}\n","import { LabelModel } from '../../models/labels/label.model';\nimport { LabelCollapseModeEnum } from '../../models/labels/label-collapse-mode';\n\nexport const ContextLabelId = 'context-label';\nexport class StoryLabelsStateModel {\n    loading: boolean;\n    labelsCollapsed: boolean;\n    labelsCollapsedMode: LabelCollapseModeEnum;\n    labelScale: number;\n    labels: LabelModel[];\n    selectedLabel: string;\n    contextLabel: LabelModel;\n    enableContextLabel: {\n        enable: boolean;\n        enableInfo: boolean;\n        enableActions: boolean;\n    };\n\n    draggable: {\n        pin: boolean;\n        tag: boolean;\n    };\n}\n","import { State, Action, StateContext, Selector, Store, createSelector } from '@ngxs/store';\nimport { StoryLabelsStateModel, ContextLabelId } from './story.labels.state.model';\nimport { \n  AddLabel,\n  RemoveLabel,\n  SetLabels,\n  SelectLabel,\n  SetLabel,\n  RemoveAllChapterLabels,\n  CopyLabels,\n  ResetLabels,\n  ConvertLabels,\n  AddContextLabel,\n  EnableContextLabel,\n  RemoveContextLabel,\n  SetLabelsShown,\n  SetAllLabelsShown,\n  SetLabelsCollapsed,\n  SetLabelsDraggable,\n  PatchLabels,\n  SetLabelOffset,\n  SetLabelStates,\n  SetLabelScale} from './story.labels.actions';\nimport { uuid } from 'src/app/shared/uuid';\nimport { StoryChaptersState } from '../chapters/story.chapters.state';\nimport { StoryChaptersStateModel } from '../chapters/story.chapters.state.model';\nimport { LabelsService } from '../../labels.service';\nimport { cloneDeep, partition } from 'lodash';\nimport { LabelCollapseModeEnum } from '../../models/labels/label-collapse-mode';\n\nimport { UndoActions } from 'src/app/undo/state/undo.state.actions';\nimport { LabelPinType } from '../../models/labels/label-pin-type.enum';\nimport { LabelSequentialType } from '../../models/labels/label-sequential-type.enum';\nimport { LabelModel } from '../../models/labels/label.model';\n\ndeclare const immer;\ndeclare const Human: any;\n\nconst initialState: StoryLabelsStateModel = {\n  enableContextLabel: {\n    enable: true,\n    enableInfo: true,\n    enableActions: true\n  },\n  loading: false,\n  labelsCollapsed: false,\n  labelsCollapsedMode: LabelCollapseModeEnum.None,\n  labelScale: null,\n  labels: [],\n  contextLabel: null,\n  selectedLabel: null,\n  draggable: {\n    pin: true,\n    tag: true\n  }\n};\n\n@State<StoryLabelsStateModel>({\n  name: 'labels',\n  defaults: initialState\n})\nexport class StoryLabelsState {\n  /**\n   * Selectors\n   */\n  @Selector()\n  static getLabels(state: StoryLabelsStateModel) {\n    return state.labels;\n  }\n\n  @Selector()\n  static getLabelsCollapsed(state: StoryLabelsStateModel) {\n    return state.labelsCollapsed;\n  }\n\n  @Selector()\n  static getLabelsCollapsedMode(state: StoryLabelsStateModel) {\n    return state.labelsCollapsedMode;\n  }\n\n  @Selector()\n  static getSelectedLabelId(state: StoryLabelsStateModel) {\n    return state.selectedLabel;\n  }\n\n  @Selector()\n  static getSelectedLabel(state: StoryLabelsStateModel) {\n    return state.labels.find(label => label.id === state.selectedLabel) || null;\n  }\n\n  @Selector()\n  static getContextLabel(state: StoryLabelsStateModel) {\n    return state.contextLabel;\n  }\n\n  @Selector([StoryChaptersState])\n  static getChapterLabels(state: StoryLabelsStateModel, storyChaptersState: StoryChaptersStateModel) {\n    return state.labels.filter(label => label.chapterId === storyChaptersState.selectedChapter);\n  }\n\n  static getChapterSequentialLabels(type: LabelSequentialType) {\n    return createSelector([StoryLabelsState, StoryChaptersState], (state: StoryLabelsStateModel, storyChaptersState: StoryChaptersStateModel) => {\n      return state.labels.filter(label => \n        (label.chapterId === storyChaptersState.selectedChapter) && \n        (label.pinType === LabelPinType.Sequential) && \n        (label.sequentialType === type));\n    });\n  }\n  \n  static getLabelSequence(label: LabelModel) {\n    return createSelector([\n      StoryLabelsState, \n      StoryLabelsState.getChapterSequentialLabels(LabelSequentialType.Alphabetical), \n      StoryLabelsState.getChapterSequentialLabels(LabelSequentialType.Numerical)\n    ], (state: StoryLabelsState, alphabetical: LabelModel[], numerical: LabelModel[]) => {\n      if (label.pinType !== LabelPinType.Sequential) {\n        return null;\n      }\n\n      switch (label.sequentialType) {\n        case LabelSequentialType.Alphabetical:\n          const i = alphabetical.findIndex((value) => value.id === label.id); \n          return 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.charAt(i);\n\n        case LabelSequentialType.Numerical: \n          return numerical.findIndex((value) => value.id === label.id) + 1;\n      }\n    });\n  }\n\n  @Selector()\n  static getEnableContextLabel(state: StoryLabelsStateModel) {\n    return state.enableContextLabel.enable;\n  }\n\n  @Selector()\n  static getEnableContextLabelInfo(state: StoryLabelsStateModel) {\n    return state.enableContextLabel.enableInfo;\n  }\n\n  @Selector()\n  static getEnableContextLabelActions(state: StoryLabelsStateModel) {\n    return state.enableContextLabel.enableActions;\n  }\n\n  @Selector()\n  static getLabelsDraggable(state: StoryLabelsStateModel) {\n    return state.draggable;\n  }\n\n  @Selector()\n  static getLabelScale(state: StoryLabelsStateModel) {\n    return state.labelScale;\n  }\n\n  /**\n   * Actions\n   */\n\n  @Action(PatchLabels)\n  PatchLabels(context: StateContext<StoryLabelsStateModel>, action: PatchLabels) {\n    const nextState = immer.applyPatches(context.getState(), action.patches);\n    context.patchState(nextState);\n  }\n\n  @Action(SetLabelOffset)\n  setLabelOffset(context: StateContext<StoryLabelsStateModel>, action: SetLabelOffset) {\n    const [nextState, patches, inversePatches] = immer.produceWithPatches(context.getState(), draft => {\n      const label = draft.labels.find(_label => _label.id === action.labelId);\n      if (label) {\n        label.offset = action.offset;\n      }\n    });\n    context.patchState(nextState);\n    this.savePatches(patches, inversePatches);\n  }\n\n\n  @Action(SetLabels)\n  setLabels(context: StateContext<StoryLabelsStateModel>, action: SetLabels) {\n    context.patchState(immer.produce(context.getState(), draft => {\n      draft.labels = action.labels;\n    }));\n  }\n\n  @Action(SetLabel)\n  setLabel(context: StateContext<StoryLabelsStateModel>, action: SetLabel) {\n    const [nextState, patch, inversePatches] = immer.produceWithPatches(\n      context.getState(),\n      draft => {\n        draft.labels = draft.labels.map(label => {\n          return label.id === action.label.id ? action.label : label;\n        });\n      }\n    );\n    context.patchState(nextState);\n    if (action.record) {\n      this.savePatches(patch, inversePatches);\n    }\n  }\n\n  @Action(SetLabelStates)\n  setLabelStates(context: StateContext<StoryLabelsStateModel>, action: SetLabelStates) {\n    const [nextState, patch, inversePatches] = immer.produceWithPatches(\n      context.getState(),\n      draft => {\n        const label = draft.labels.find(_label => _label.id === action.id);\n        label.states = action.states;\n      }\n    );\n\n    context.patchState(nextState);\n    this.savePatches(patch, inversePatches);\n  }\n\n  @Action(SetLabelScale)\n  setLabelScale(context: StateContext<StoryLabelsStateModel>, action: SetLabelScale) {\n    context.patchState({\n      labelScale: action.scale\n    });\n  }\n\n  @Action(AddLabel)\n  addLabel(context: StateContext<StoryLabelsStateModel>, action: AddLabel) {\n    const [nextState, patches, inversePatches] = immer.produceWithPatches(context.getState(), draft => {\n      const labelId = action.label.id || uuid.idWithPrefix('label');\n      const label = {...action.label, id: labelId};\n      draft.labels.push(label);\n    });\n    context.patchState(nextState);\n    this.savePatches(patches, inversePatches);\n  }\n\n  @Action(AddContextLabel)\n  addContextLabel(context: StateContext<StoryLabelsStateModel>, action: AddContextLabel) {\n    const nextState = immer.produce(context.getState(), draft => {\n      draft.contextLabel = {...action.label, id: ContextLabelId};\n    });\n    context.patchState(nextState);\n  }\n\n\n  @Action(CopyLabels)\n  copyLabels(context: StateContext<StoryLabelsStateModel>, action: CopyLabels) {\n    const labels = context.getState().labels;\n    const sourceLabels = labels.filter(label => label.chapterId === action.sourceChapter.id);\n    const targetLabels = sourceLabels.map(label => {\n      return {\n        ...(cloneDeep(label)),\n        id: uuid.idWithPrefix('label'),\n        chapterId: action.targetChapter.id\n      };\n    });\n\n    context.patchState({\n      labels: [...labels, ...targetLabels]\n    });\n  }\n  \n  @Action(RemoveLabel)\n  removeLabel(context: StateContext<StoryLabelsStateModel>, action: RemoveLabel) {\n\n    const [nextState, patches, inversePatches] = immer.produceWithPatches(context.getState(), draft => {\n      draft.labels = draft.labels.filter(label => label.id !== action.label.id);\n    });\n\n    context.patchState(nextState);\n    Human.scene.markers.delete(action.label.id);\n    this.savePatches(patches, inversePatches);\n  }\n\n  @Action(RemoveContextLabel)\n  removeContextLabel(context: StateContext<StoryLabelsStateModel>, action: RemoveContextLabel) {\n    const nextState = immer.produce(context.getState(), draft => {\n      draft.contextLabel = undefined;\n    });\n    Human.scene.markers.delete(ContextLabelId);\n    context.patchState(nextState);\n  }\n\n  @Action(RemoveAllChapterLabels)\n  removeAllChapterLabels(context: StateContext<StoryLabelsStateModel>, action: RemoveAllChapterLabels) {\n    const [nextState, patches, inversePatches] = immer.produceWithPatches(context.getState(), draft => {\n      const [keep, throwAway] = partition(draft.labels, (label => label.chapterId !== action.chapter.id));\n      throwAway.forEach(label => Human.scene.markers.delete(label.id));\n      draft.labels = keep;\n    });\n    context.patchState(nextState);\n    this.savePatches(patches, inversePatches);\n  }\n\n  @Action(SelectLabel)\n  selectLabel(context: StateContext<StoryLabelsStateModel>, action: SelectLabel) {\n    context.patchState({\n      selectedLabel: action.label ? action.label.id : null\n    });\n  }\n\n  @Action(ResetLabels)\n  resetLabels(context: StateContext<StoryLabelsStateModel>, action: ResetLabels) {\n    const state = context.getState();\n\n    Human.scene.markers.delete(ContextLabelId);\n    state.labels.forEach((label) => {\n      Human.scene.markers.delete(label.id);\n    });\n\n    context.setState(immer.produce(context.getState(), draft => {\n      draft = initialState;\n    }));\n  }\n\n  @Action(ConvertLabels)\n  convertLabels(context: StateContext<StoryLabelsStateModel>, action: ConvertLabels) {\n    const [nextState, patches, inversePatches] = immer.produceWithPatches(context.getState(), draft => {\n      action.labels.forEach(label => {\n        const index = draft.labels.findIndex(_label => _label.id === label.id);\n        // draft.labels[index].theme = action.theme;\n        draft.labels[index] = {\n          ...draft.labels[index],\n          ...action.fields\n        };\n      });\n    });\n\n    context.setState({...nextState});\n    this.savePatches(patches, inversePatches);\n  }\n\n  @Action(EnableContextLabel)\n  enableContextLabel(context: StateContext<StoryLabelsStateModel>, action: EnableContextLabel) {\n    context.patchState({\n      enableContextLabel: {\n        ...action\n      }\n    });\n  }\n  \n  @Action(SetLabelsShown)\n  setLabelsShown(context: StateContext<StoryLabelsStateModel>, { labels: actionLabels, shown }: SetLabelsShown) {\n    // set shown state for each update label\n    const labels = context.getState().labels\n      .map((label) => {\n        const doUpdate = actionLabels.some((actionLabel) => actionLabel.id === label.id);\n        return {\n          ...label,\n          shown: doUpdate ? shown : label.shown\n        };\n      });\n\n    context.patchState({\n      labels: [...labels]\n    });\n  }\n\n  @Action(SetAllLabelsShown)\n  setAllLabelsShown(context: StateContext<StoryLabelsStateModel>, { show }: SetAllLabelsShown) {\n    const labels = context.getState().labels;\n    context.dispatch(new SetLabelsShown(labels, show));\n  }\n\n  \n  @Action(SetLabelsCollapsed)\n  setLabelsCollapsed(context: StateContext<StoryLabelsStateModel>, { collapsed, collapsedMode: mode }: SetLabelsCollapsed) {\n    context.patchState({\n      labelsCollapsed: collapsed,\n      labelsCollapsedMode: mode\n    });\n  }\n\n  @Action(SetLabelsDraggable)\n  setLabelsDraggable(context: StateContext<StoryLabelsStateModel>, action: SetLabelsDraggable) {\n    context.patchState({\n      draggable: {...action.draggable}\n    });\n  }\n\n  private savePatches(patches, inversePatches) {\n    this.store.dispatch(\n      new UndoActions.SavePatches([\n        {\n          forward: patches,\n          inverse: inversePatches,\n          patchAction: PatchLabels,\n        },\n      ])\n    );\n    \n  }\n\n  constructor(\n    private store: Store,\n    private labelsService: LabelsService\n  ) { }\n}\n","import { ContentType } from '../models/content-type.enum';\n\nexport function storyType(storyId: string): ContentType {\n  return (storyId.split('/').length > 1) ? ContentType.Module : ContentType.Bookmark;\n}\n","import { StoryModel } from '../models/story.model';\nimport { ContentType } from '../models/content-type.enum';\nimport { StoryChunkLoadModel } from './story.state.model';\nimport { defaultLocale } from 'src/app/locale-config.module';\nimport { TweenParticleLookupModel } from '../models/tween-particle-lookup.model';\n\nexport class LoadStory {\n  static readonly type = '[Story] Load Current Story';\n  constructor(\n    public id: string, \n    public type: ContentType,\n    public lang = defaultLocale.lang) {}\n}\n\n\nexport class AddToStory {\n  static readonly type = '[Story] Add to current story';\n  constructor(public id: string, public type: ContentType) {}\n}\n\nexport class SetStory {\n  static readonly type = '[Story] Replace the Story';\n  constructor(public story: StoryModel) {}\n}\n\nexport class SetStoryId {\n  static readonly type = '[Story] Set the Story ID';\n  constructor(public id: string) {}\n}\n\nexport class SetStoryText {\n  static readonly type = '[Story] Set Story Text';\n  constructor(public displayName: string) {}\n}\n\nexport class SetStoryTags {\n  static readonly type = '[Story] Set Story Tags';\n  constructor(public tags: string[]) {}\n}\n\nexport class SetIncomingStory {\n  static readonly type = '[Story] Set Incoming Story Id';\n  constructor(\n    public id: string, \n    public type: ContentType,\n    public reset?: boolean) {}\n}\n\nexport class LoadStoryChunk {\n  static readonly type = '[Story] Load Story Chunk';\n  constructor() {}\n}\n\nexport class ReorderLoadChunks {\n  static readonly type = '[Story] Reorder Load Chunks';\n  constructor(public chapterId: string) {}\n}\n\nexport class LoadStoryChunkSuccess {\n  static readonly type = '[Story] Load Story Chunk Success';\n  constructor(public chunk: StoryChunkLoadModel) {}\n}\n\nexport class BuildStory {\n  static readonly type = '[Story] Build Story In Engine From Story Model';\n  constructor(\n    public id: string, \n    public story: StoryModel, \n    public type: ContentType, \n    public chapterIdx?: number) {}\n}\n\nexport class LoadStorySuccess {\n  static readonly type = '[Story] Load Success';\n  constructor(\n    public story: StoryModel, \n    public id: string, \n    public type: ContentType\n  ) { }\n}\n\nexport class LoadStoryFail {\n  static readonly type = '[Story] Load Fail';\n  constructor(public id: string, public type: ContentType) { }\n}\n\nexport class ImportStory {\n  static readonly type = '[Story] Import';\n  constructor(public id: string, public type: ContentType, public lang = defaultLocale.lang) { }\n}\n\nexport class ImportStorySuccess {\n  static readonly type = '[Story] Import Success';\n  constructor(public story: StoryModel, public id: string, public type: ContentType) { }\n}\n\nexport class ResetStory {\n  static readonly type = '[Story] Clear';\n  constructor() { }\n}\n\nexport class SynchronizeChapters {\n  static readonly type = '[Story] Synchronize Chapters';\n  constructor() { }\n}\n\nexport class HumanReadyWeb {\n  static readonly type = '[Story] Human Ready (Web)';\n  constructor() {}\n}\n\nexport class HumanReadySDK {\n  static readonly type = '[Story] Human Ready (SDK)';\n  constructor() {}\n}\n","import { StoryModel } from '../models/story.model';\nimport { ContentType } from '../models/content-type.enum';\n\nexport class StoryStateModel {\n    loading: boolean;\n    incoming: {\n        id: string,\n        type: ContentType\n    };\n    story?: StoryModel;\n    storyId: string; // current storyId\n    storyType: ContentType;\n    loadChunks: StoryChunkLoadModel[];\n    loadChunksRemaining: StoryChunkLoadModel[];\n    loadingChunk: StoryChunkLoadModel;\n    thumbnailLookup: {\n        originalChapterId: string, \n        newChapterId: string, \n        originalStoryId: string\n    }[];\n}\n\nexport class StoryChunkLoadModel {\n    chunkId: string;\n    storyId: string;\n    chapterId: string;\n    time?: number;\n    objects: string[];\n    assetTypes: string[];\n    activate: boolean;\n    activationConfig?: StoryChapterLoadProtocolModel;\n    readyState: {\n        model?: boolean;\n        animation?: boolean;\n    };\n}\n\nexport class StoryLoadConfigModel {\n    targetChapterId:  string;\n    targetChapterConfig: {\n        global: StoryChapterLoadProtocolModel,\n        static: StoryChapterLoadProtocolModel,\n        dynamic: StoryChapterLoadProtocolModel\n    };\n    chapterAssetBundle: boolean;\n    sortBy: 'chapter' | 'readyState';\n}\n\nexport class StoryChapterLoadProtocolModel {\n    timeline?: boolean;\n    camera?: boolean;\n    graph?: boolean;\n    properties?: boolean;\n    particles?: boolean;\n    clipping?: boolean;\n    postprocess?: boolean;\n    transparencyMode?: boolean;\n    labels?: boolean;\n}\n","import { State, Action, StateContext, Selector, Store } from '@ngxs/store';\nimport { StoryStateModel } from './story.state.model';\nimport {\n  LoadStorySuccess,\n  SynchronizeChapters,\n  ResetStory,\n  LoadStoryChunk,\n  SetIncomingStory,\n  LoadStory,\n  BuildStory,\n  SetStoryText,\n  SetStory,\n  SetStoryId,\n  LoadStoryChunkSuccess,\n  LoadStoryFail,\n  ImportStory,\n  ReorderLoadChunks,\n  ImportStorySuccess,\n  SetStoryTags,\n  HumanReadySDK\n} from './story.actions';\nimport { StoryService } from '../story.service';\nimport { SetChapters, SelectChapter, RegisterChapterThumbnails, SetChapterReadyState } from './chapters/story.chapters.actions';\nimport { StoryChaptersState } from './chapters/story.chapters.state';\nimport { SetLabels } from './labels/story.labels.actions';\nimport { ChapterModel } from '../models/chapter.model';\nimport { LabelModel } from '../models/labels/label.model';\nimport { StoryChapterThumbnail } from '../models/story-chapter-thumbnail.model';\nimport { StoryModel } from '../models/story.model';\nimport { mergeModules } from '../merge/merge-modules';\nimport { Thumbnail } from 'src/app/shared/thumbnail-utils';\nimport { environment } from 'src/environments/environment';\nimport { SerializeModuleService } from 'src/app/edit/serialize-module.service';\nimport { TrimConfiguration } from 'src/app/edit/models/trim-config.model';\nimport { partition, get } from 'lodash';\nimport { ObjectId, NodeState } from 'src/app/engine/state/nodes/engine.nodes.state.model';\nimport { NodeActions } from 'src/app/engine/state/nodes/engine.nodes.actions';\nimport { EngineService } from 'src/app/engine/engine.service';\nimport { buildNodeState } from 'src/app/engine/state/nodes/build-node-state';\nimport { ChapterUtils } from 'src/app/shared/chapter-utils';\nimport { ParticleActions } from 'src/app/engine/state/particles/particles.actions';\nimport { ParticleSystem } from 'src/app/engine/models/particles/particle-system-types';\nimport { ParticlesStateModel } from 'src/app/engine/state/particles/particles.state.model';\nimport { TweenParticleLookupModel } from '../models/tween-particle-lookup.model';\nimport { ContentType } from '../models/content-type.enum';\n\ndeclare const Human;\n\n\nconst initialState: StoryStateModel = {\n  loading: false,\n  incoming: {\n    id: undefined,\n    type: undefined\n  },\n  storyId: undefined,\n  storyType: undefined,\n  loadingChunk: null,\n  loadChunks: [],\n  loadChunksRemaining: [],\n  thumbnailLookup: []\n};\n\n@State<StoryStateModel>({\n  name: 'story',\n  defaults: initialState\n})\nexport class StoryState {\n\n  /**\n   * Selectors\n   */\n  @Selector()\n  static getStory(state: StoryStateModel) {\n    return state.story;\n  }\n\n  @Selector()\n  static getStoryId(state: StoryStateModel) {\n    return state.storyId;\n  }\n\n  @Selector()\n  static getLoadingChunk(state: StoryStateModel) {\n    return state.loadingChunk;\n  }\n\n  @Selector()\n  static getLoadChunks(state: StoryStateModel) {\n    return state.loadChunks;\n  }\n\n  @Selector()\n  static getLoadChunksRemaining(state: StoryStateModel) {\n    return state.loadChunksRemaining;\n  }\n\n  @Selector()\n  static getStoryInfo(state: StoryStateModel) {\n    return {\n      id: state.storyId,\n      type: state.storyType\n    };\n  }\n\n  @Selector()\n  static getIncomingStoryInfo(state: StoryStateModel) {\n    return state.incoming;\n  }\n\n  @Selector()\n  static getStoryTags(state: StoryStateModel) {\n    return get(state, 'story.tags', []);\n  }\n\n\n  /**\n   * \n   * Actions\n   */\n  @Action(SetStoryText)\n  setStoryText(context: StateContext<StoryStateModel>, action: SetStoryText) {\n    const story = context.getState().story;\n\n    if (story) {\n      context.patchState({\n        story: {\n          ...story,\n          displayName: action.displayName\n        }\n      });\n    }\n  }\n\n  @Action(SetStoryTags)\n  setStoryTags(context: StateContext<StoryStateModel>, { tags }: SetStoryTags) {\n    const story = context.getState().story;\n\n    if (story) {\n      context.patchState({\n        story: {\n          ...story,\n          tags\n        }\n      });\n    }\n  }\n\n  @Action(SetStory)\n  setStory(context: StateContext<StoryStateModel>, action: SetStory) {\n    context.patchState({\n      story: action.story\n    });\n  }\n\n  @Action(SetStoryId)\n  SetStoryId(context: StateContext<StoryStateModel>, action: SetStoryId) {\n    context.patchState({\n      storyId: action.id\n    });\n  }\n\n  @Action(SetIncomingStory)\n  setIncomingStory(context: StateContext<StoryStateModel>, action: SetIncomingStory) {\n    const state = context.getState();\n    const { id, type, reset } = action;\n\n    if (id !== state.storyId || reset) {\n      context.patchState({\n        incoming: { id: id, type: type }\n      });\n    } else if (reset) {\n      context.dispatch(new BuildStory(action.id, state.story, action.type));\n    }\n  }\n\n  // load the entire incoming story and its assets\n  @Action(LoadStory)\n  loadStory(context: StateContext<StoryStateModel>, action: LoadStory) {\n    this.storyService.getStory(action.id, action.type, action.lang)\n      .subscribe(\n        // success\n        (story) => {\n          context.dispatch(\n            new LoadStorySuccess(\n              story,\n              action.id,\n              action.type\n            )\n          );\n        },\n        // error\n        () => {\n          context.dispatch(new LoadStoryFail(action.id, action.type));\n        });\n  }\n\n  // Put story into engine and kickoff asset loading. \n  @Action(LoadStorySuccess)\n  loadStorySuccess(context: StateContext<StoryStateModel>, action: LoadStorySuccess) {\n    this.storyService.unloadStory(null).subscribe(() => {\n      context.dispatch(new BuildStory(action.id, action.story, action.type));\n    });\n  }\n\n  private buildStoryWorkflow(\n    context: StateContext<StoryStateModel>,\n    storyId: string,\n    story: StoryModel,\n    storyType: ContentType,\n    targetChapterIdx: number = 0,\n    thumbnails = new Map()\n  ) {\n\n    this.storyService.buildStory(storyId, story, true).subscribe(built => {\n      // parse chapters from Human Engine\n      const chapters: ChapterModel[] = this.storyService.getStoryChapters(storyId, storyType);\n\n      // parse labels\n      let labels: LabelModel[] = [];\n      chapters.forEach((chapter) => {\n        labels = [...labels, ...chapter.labels];\n      });\n\n      const config = this.storyService.getLoadConfig(storyId, targetChapterIdx);\n      const loadChunks = this.storyService.getStoryLoadChunks(storyId, config);\n\n\n      // patch story state\n      context.patchState({\n        storyId,\n        story,\n        loadChunks,\n        loadChunksRemaining: loadChunks,\n        incoming: { id: undefined, type: undefined }\n      });\n\n      // build nodeState for each chapter.\n      const graph = this.engineService.getSceneGraph(Human.scene.rootObjects);\n      const nodeStates = chapters.reduce<Record<string, Record<ObjectId, NodeState>>>((acc, chapter) => {\n        acc[chapter.id] = buildNodeState(\n          graph,\n          chapter.showObjects,\n          chapter.pickThroughObjects,\n          chapter.synchronization\n        );\n        return acc;\n      }, {});\n\n\n\n      context.dispatch(new NodeActions.InitNodeState(nodeStates));\n      context.dispatch(new NodeActions.SetActiveChapter(chapters[targetChapterIdx].id));\n      context.dispatch(new SetChapters(chapters));\n      context.dispatch(new RegisterChapterThumbnails(thumbnails));\n      context.dispatch(new SetLabels(labels));\n      context.dispatch(new SelectChapter(chapters[targetChapterIdx]));\n\n\n      // set initial particle system state.\n      const tweenParticleLookup: TweenParticleLookupModel = get(story, 'tweenParticleLookup', {});\n      const particleSystems: ParticleSystem[] = get(story, 'customData.particleSystems', []);\n      const assignedParticles: ParticlesStateModel['assignedParticles'] = chapters.reduce((acc, chapter) => {\n        acc[chapter.id] = get(chapter, 'customData.particleSystems', []);\n        return acc;\n      }, {});\n\n      context.dispatch(new ParticleActions.SetParticleState(\n        particleSystems,\n        assignedParticles,\n        tweenParticleLookup\n      ));\n\n      context.dispatch(new HumanReadySDK());\n      \n      // kick off loading\n      context.dispatch(new LoadStoryChunk());\n      \n    });\n  }\n\n  @Action(ImportStorySuccess)\n  importStorySuccess(context: StateContext<StoryStateModel>, action: ImportStorySuccess) {\n\n    const state = context.getState();\n    const storyType = state.storyType;\n    const storyId = state.storyId;\n\n    const namespaceMap = {};\n    const trimConfig = new TrimConfiguration();\n    const replaceObjectId = false;\n    const story = this.store.selectSnapshot(StoryState.getStory);\n    const chapters = this.store.selectSnapshot(StoryChaptersState.getStoryChapters);\n    const chapterIdMap = ChapterUtils.makeChapterIdMap(chapters, false);\n\n    const currentStory = this.serializeModuleService.serialize(\n      namespaceMap,\n      trimConfig,\n      replaceObjectId,\n      story,\n      chapters,\n      chapterIdMap\n    ).story;\n\n\n    const newStory = mergeModules(\n      currentStory,\n      storyId,\n      action.story,\n      action.id,\n      environment.exportType\n    );\n\n\n\n    // when a new module is imported, its thumbnails reference the origin module and chapters\n    // we need a look up table to know where to get thumbnails before we save the module to a bookmark.\n    // here we build the lookup table, and read it in Thumbnail.generateThumbnailUrls\n    const originalThumbnails = currentStory.chapters.map((chapter, i) => {\n      const newChapterId = chapter.id;\n      const originalChapterId = chapter.id;\n      const originalStoryId = storyId;\n      return { newChapterId, originalChapterId, originalStoryId };\n    });\n\n \n    const thumbnailLookup = (state.thumbnailLookup || [])\n      .concat(action.story.chapters.map((chapter, i) => {\n        const startIndex = currentStory.chapters.length;\n        const newChapterId = newStory.chapters[startIndex + i].id;\n        const originalChapterId = chapter.id;\n        const originalStoryId = action.id;\n        return { newChapterId, originalChapterId, originalStoryId };\n      }));\n\n    context.patchState({\n      thumbnailLookup\n    });\n\n    const thumbnails: Map<string, StoryChapterThumbnail> = Thumbnail.generateThumbnailUrls(\n      [...originalThumbnails, ...thumbnailLookup]\n    );\n\n    \n\n    // merge any thumbnails that currently live in state that are a blob\n    const prevThumbnails = this.store.selectSnapshot(StoryChaptersState.getRegisteredThumbnails);\n    const blobThumbnails = new Map([...prevThumbnails].filter(entry => entry[1].snapshot));\n    const newThumbnails = new Map([...thumbnails, ...blobThumbnails]);\n\n\n    // a story must be unloaded before it is rebuilt\n    // we need to flush the engine's definition of the scene graph, because we made a new one in combineModules\n    const purgeAssets = true; // we need to purge assets until parsing animations has been decoupled from fetching from the server\n    this.storyService.unloadStory(null, purgeAssets).subscribe(() => {\n      this.buildStoryWorkflow(context, \n        storyId, \n        <unknown>newStory as StoryModel, \n        storyType, \n        newStory.chapters.length - 1, newThumbnails);\n    });\n  }\n\n\n\n  // Build story from story data. \n  @Action(BuildStory)\n  buildStory(context: StateContext<StoryStateModel>, action: BuildStory) {\n    // build and activate story into Human Engine\n    const thumbnailLookup = action.story.chapters.map((chapter, i) => {\n      const newChapterId = chapter.id;\n      const originalChapterId = chapter.id;\n      const originalStoryId = action.id;\n      return { newChapterId, originalChapterId, originalStoryId };\n    });\n\n    const thumbnails: Map<string, StoryChapterThumbnail> = Thumbnail.generateThumbnailUrls(\n      thumbnailLookup\n    );\n\n    const targetChapterIdx = action.chapterIdx || 0;\n    this.buildStoryWorkflow(context, \n      action.id, \n      action.story, \n      action.type, \n      targetChapterIdx, \n      thumbnails);\n  }\n\n  @Action(LoadStoryChunk)\n  loadStoryChunk(context: StateContext<StoryStateModel>) {\n  \n    // assume the chunk to load is in the zeroth index of loadChunksRemaining\n    const chunkToLoad = context.getState().loadChunksRemaining[0];\n    \n    if (!chunkToLoad) {\n      return;\n    }\n\n    // update the queue of remaining chunks.\n    context.patchState({\n      loadingChunk: chunkToLoad\n    });\n\n    // load assets through story Service\n    // then, dispatch success and continue loading chunks\n    this.storyService.loadStoryChunk(chunkToLoad, () => {\n      context.dispatch([\n        new LoadStoryChunkSuccess(chunkToLoad),\n        new LoadStoryChunk()\n      ]);\n    });\n  }\n\n  /**\n   * Reorder load chunks, so that the currently selected chapter's chunks are next in the queue.\n   * This does not interrupt any currently loading chunks.\n   */\n\n  @Action(ReorderLoadChunks)\n  reorderLoadChunks(context: StateContext<StoryStateModel>, action: ReorderLoadChunks) {\n    const { loadChunksRemaining } = context.getState();\n\n    const [chunksForActiveChapter, otherChunks] = partition(\n      loadChunksRemaining,\n      chunk => chunk.chapterId === action.chapterId\n    );\n    \n    context.patchState({\n      loadChunksRemaining:  [...chunksForActiveChapter, ...otherChunks]\n    });\n  }\n\n  @Action(LoadStoryChunkSuccess)\n  loadStoryChunkSuccess(context: StateContext<StoryStateModel>, action: LoadStoryChunkSuccess) {\n    const loadChunksRemaining = context\n      .getState()\n      .loadChunksRemaining.filter(\n        chunk => chunk.chunkId !== action.chunk.chunkId\n      );\n    \n    context.patchState({\n      loadingChunk: null,\n      loadChunksRemaining\n    });\n    \n    context.dispatch(new SetChapterReadyState(action.chunk.chapterId, action.chunk.readyState));\n  }\n\n\n  @Action(SynchronizeChapters)\n  synchronizeChapters(context: StateContext<StoryStateModel>) {\n    const chapters = this.store.selectSnapshot(StoryChaptersState.getStoryChapters);\n    const { story } = context.getState();\n\n    context.patchState({\n      story: {\n        ...story,\n        chapters: [...chapters]\n      }\n    });\n  }\n\n  @Action(ImportStory)\n  importStory(context: StateContext<StoryStateModel>, action: ImportStory) {\n    this.storyService.getStory(action.id, action.type, action.lang)\n      .subscribe(\n        // success\n        (story) => {\n          context.dispatch(new ImportStorySuccess(story, action.id, action.type));\n        });\n  }\n\n  @Action(ResetStory)\n  resetStory(context: StateContext<StoryStateModel>) {\n    context.setState(initialState);\n  }\n\n\n  constructor(\n    private store: Store,\n    private storyService: StoryService,\n    private engineService: EngineService,\n    private serializeModuleService: SerializeModuleService\n  ) { }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { NgxsModule } from '@ngxs/store';\nimport { StoryState } from './state/story.state';\nimport { StoryLabelsState } from './state/labels/story.labels.state';\nimport { LabelComponent } from './components/labels/label/label.component';\nimport { LabelsComponent } from './components/labels/labels/labels.component';\nimport { SharedModule } from '../shared/shared.module';\nimport { StoryChaptersState } from './state/chapters/story.chapters.state';\nimport { MaterialModule } from '../material.module';\nimport { ContextLabelComponent } from './components/labels/context-label/context-label.component';\nimport { NodeActionsModule } from '../shared/components/node-actions/node-actions.module';\nimport { MarkdownModule } from 'ngx-markdown';\nimport { LabelPinComponent } from './components/labels/label-pin/label-pin.component';\nimport { ContentBlocksModule } from '../content-blocks/content-blocks.module';\n\n@NgModule({\n  imports: [\n    NgxsModule.forFeature([\n      StoryState,\n      StoryChaptersState,\n      StoryLabelsState\n    ]),\n    CommonModule,\n    SharedModule,\n    MaterialModule,\n    NodeActionsModule,\n    ContentBlocksModule,\n    MarkdownModule.forChild()\n  ],\n  declarations: [LabelComponent, LabelsComponent, ContextLabelComponent, LabelPinComponent],\n  exports: [LabelComponent, LabelsComponent, LabelPinComponent]\n})\nexport class StoryModule { }\n","import { Injectable } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { Observable, forkJoin, of, throwError } from 'rxjs';\nimport { StoryModel } from './models/story.model';\nimport { plainToClass, classToClass } from 'class-transformer';\nimport { map, flatMap, catchError } from 'rxjs/operators';\nimport { StoryChunkLoadModel, StoryLoadConfigModel } from './state/story.state.model';\nimport { ChapterService } from './chapter.service';\nimport { ChapterModel } from './models/chapter.model';\nimport { StoryChapterThumbnail } from './models/story-chapter-thumbnail.model';\nimport { StoryTranslationModel, StoryTranslationMetaInfo } from './models/story-translation.model';\nimport { SceneGraphNode } from '../edit/models/scene-graph-node';\nimport { LabelModel } from './models/labels/label.model';\nimport { ContentType } from './models/content-type.enum';\nimport { flatten } from 'lodash';\nimport { EngineService } from '../engine/engine.service';\nimport { makeAsync } from '../shared/make-async';\nimport { uuid } from '../shared/uuid';\nimport { ColorUtils } from '../shared/libraries/colors/colors';\nimport { environment } from 'src/environments/environment';\n\ndeclare const Human: any;\ndeclare const localBaseDirectory: string;\n\n/**\n * These can be broken up for progressive loading\n */\nconst globalTypes = ['reflections', 'lights']; // Not bound to objects\nconst staticTypes = ['material', 'geometry', 'transform']; // Needed for render\nconst dynamicTypes = ['tweens', 'morph']; // Needed to animate\n\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class StoryService {\n\n  constructor(\n    private http: HttpClient,\n    private engineService: EngineService,\n    private chapterService: ChapterService\n  ) { }\n\n  // get the object ids to be shown in the specified human chapter\n  private getShownObjectsFromChapter(humanChapter: any): string[] {\n    const synchronziation: {[key: string]: any} = humanChapter.synchronization;\n    const objectIds: string[] = [];\n    Object.entries(synchronziation).forEach(([objectId, sync]) => {\n      if (sync.shown) {\n        objectIds.push(objectId);\n      }\n    });\n    return objectIds;\n  }\n\n  // chunk.activate needs to be set to false for either\n  // Create a single load chunk per chapter, to ensure animation and models load before interactivity\n  private getChapterLoadChunks(storyId: string, humanChapter: any, config: StoryLoadConfigModel): StoryChunkLoadModel[] {\n    const chapterObjects = this.getShownObjectsFromChapter(humanChapter);\n    const chunk = new StoryChunkLoadModel();\n    chunk.activate = false;\n    chunk.chapterId = humanChapter.id;\n    chunk.objects = chapterObjects;\n    chunk.storyId = storyId;\n    // queue up static/dynamic assets for joint loading\n    chunk.assetTypes = [...staticTypes, ...dynamicTypes, ...globalTypes];\n    chunk.readyState = {model: true, animation: true};\n\n    return [chunk];\n  }\n\n  // create load chunks for on-demand loading\n  private getOnDemandLoadChunks(storyId: string, config: StoryLoadConfigModel): StoryChunkLoadModel[] {\n    let chunks: StoryChunkLoadModel[] = [];\n\n    // create chunks for chapters according to story load configuration\n    Human.timeline.rootTimelines[storyId]._chapters.forEach((humanChapter) => {\n      const _chapterChunks = this.getChapterLoadChunks(storyId, humanChapter, config);\n\n      if (humanChapter.id === config.targetChapterId) {\n        // target chapter chunks go first\n        chunks = [..._chapterChunks, ...chunks];\n      } else {\n        // add non-target chunks in order\n        chunks = [...chunks, ..._chapterChunks];\n      }\n    });\n\n    return chunks;\n  }\n\n  // get the index of the chapter in the story\n  getChapterIndex(storyId: string, chapterId: string): number {\n    if (Human.timeline.rootTimelines[storyId]) {\n      const root = Human.timeline.rootTimelines[storyId];\n      return root._chapters.findIndex((chapter) => chapter.id === chapterId);\n    } else {\n      return -1;\n    }\n  }\n\n  // entry point to get either a module or bookmark\n  getStory(id: string, type: ContentType, lang: string = 'en'): Observable<StoryModel> {\n    /**\n     * type: string => 'module' or 'bookmark'\n     * id: string => id of content\n     */\n\n    // get content\n    const story$ = type === ContentType.Bookmark ? this.getBookmark(id) : this.getContent(id);\n\n    // default English\n    if (lang === 'en') {\n      return story$;\n    } else {\n      let story: StoryModel;\n      // transform content into target language\n      return story$\n        .pipe(\n          flatMap((_story) => {\n            story = _story;\n            return this.getStoryTranslation(id, type, lang);\n          })\n        )\n        .pipe(\n          map((translation) => this.translateStory(story, translation)),\n          catchError(() => story$)\n        );\n    }\n  }\n\n  /**\n   * In offline mode window.localBaseDirectory will be set to the file path of the content\n   * otherwise requests will be relative to '/'\n   */\n  private getContentRoot(): String {\n    if (environment.offline === true) {\n      return localBaseDirectory;\n    }\n    return '/';\n  }\n\n  // get a biodigital module -> normalize chapter data\n  getContent(path: string): Observable<StoryModel> {\n    return this.http.get(this.getContentRoot() + `content/modules/${path}.json`)\n      .pipe(\n        map((result: any) => {\n          return result as StoryModel;\n        })\n      );\n  }\n\n  // get a biodigital bookmark -> normalize chapter data\n  getBookmark(id: string): Observable<StoryModel> {\n      return this.http.get(`/search/bookmarks/data`, { params: { be: id } })\n        .pipe(\n          map((result: any) => {\n            return result.bookmark as StoryModel;\n          })\n        );\n  }\n  \n  // create configuration for story loading\n  getLoadConfig(storyId: string, targetChapterIdx: number = 0): StoryLoadConfigModel {\n    const config = new StoryLoadConfigModel();\n    config.chapterAssetBundle = true;\n    config.targetChapterId = Human.timeline.rootTimelines[storyId]._chapters[targetChapterIdx].id;\n    config.targetChapterConfig = {\n      global: {clipping: true, graph: true, camera: true, properties: true, transparencyMode: true, postprocess: true},\n      static: {labels: true},\n      dynamic: {timeline: true, particles: true}\n    };\n    config.sortBy = 'chapter';\n    return config;\n  }\n\n  // Create the Human module\n  // This is the entrypoint into the engine\n  // when a new module arrives, it needs to be added to the existing story.\n  buildStory(storyId: string, story: StoryModel, activate: boolean): Observable<boolean> {\n\n    // To support offline loading, the engine needs to be configured to know how to build asset URLs.\n    // Even in non-offline mode, this event sets the configuration -> this should be done with defaults\n    // Grep the engine for 'Human.events.on(\"modules.fetch.start\"'\n    Human.events.fire('modules.fetch.start', storyId);\n\n    Human.modules.moduleData[storyId] = story; // Place the JSON that into Human modules for local reference\n    const moduleData = {...story};\n    moduleData.moduleId = storyId;  // needed by engine\n\n    return new Observable(observer => {\n      Human.modules.create(storyId, moduleData, () => {\n        Human.modules.load(storyId, Object.values(Human.scene.rootObjects), [...globalTypes], () => {    \n          Human.modules.activate(storyId, 0, {}, () => {\n            observer.next(true);\n            observer.complete();\n          });\n        });\n      });\n    });\n  }\n\n  getStoryChapters(storyId: string, storyType: string): ChapterModel[] {\n    const humanModuleData = Human.modules.moduleData[storyId];\n\n    return Human.timeline.rootTimelines[storyId]._chapters.map((humanChapter, idx) => {\n      return this.chapterService.fromHumanChapter(humanModuleData, storyType, humanChapter, idx);\n    });\n  }\n\n  // create list of load chunks for loading story content into engine\n  getStoryLoadChunks(storyId: string, config: StoryLoadConfigModel): StoryChunkLoadModel[] {\n    let chunks: StoryChunkLoadModel[] = [];\n    chunks = this.getOnDemandLoadChunks(storyId, config);\n    \n    // give each chunk a unique ID.\n    return chunks.map(chunk => {\n      return {...chunk, chunkId: uuid.idWithPrefix('chunk')};\n    });\n  }\n\n  // load story chunk into engine according to chunk configuration\n  loadStoryChunk(chunk: StoryChunkLoadModel, ok: Function): void {\n    const objects = chunk.objects.map((id) => Human.scene.objects[id]); // ids to objects\n\n    if (!!chunk.storyId) {\n      // story based loading\n      Human.modules.load(chunk.storyId, objects, chunk.assetTypes, () => {\n        ok();\n      });\n    } else {\n      // object based loading\n      this.engineService.loadGraphObject(chunk.objects[0]).subscribe(() => {\n        ok();\n      });\n    }\n  }\n\n  // #TODO: Support multiple module ids\n  unloadStory(id: string, purgeAssets: boolean = true): Observable<boolean> {\n    const ids = id ? [id] : Object.keys(Human.modules.modules);\n    const deletions$ = ids.map((_id) => this.hardDeleteStory(_id, purgeAssets));\n    return new Observable((observer) => {\n      if (deletions$.length) {\n        forkJoin(deletions$).subscribe(() => {\n          observer.next(true);\n          observer.complete();\n        });\n      } else {\n        observer.next(true);\n        observer.complete();\n      }\n    });\n  }\n\n  // create a load chunk for loading a objects\n  createLoadObjectChunk(id: string): StoryChunkLoadModel {\n    const chunk = new StoryChunkLoadModel();\n    chunk.assetTypes = [...staticTypes, ...dynamicTypes];\n    chunk.objects = [id];\n    return chunk;\n  }\n\n  private hardDeleteStory(id: string, purgeAssets: boolean = true): Observable<boolean> {\n    const assetTypes = ['geometries', 'morphs', 'reflections', 'tweens', 'lights', 'materials', 'transforms'];\n    const storyGraph = id in Human.modules.modules ? Human.modules.modules[id].sceneGraph : [];\n    const storyRoots = storyGraph.map((object: any) => Human.scene.objects[object.objectId]).filter(obj => !!obj);\n    const storyObjects = flatten(storyRoots.map((root) => root.getLeafObjects()));\n    \n    const deactivate = makeAsync(Human.modules.deactivate, id, {});\n    const unload = makeAsync(Human.modules.unload, id, storyObjects, assetTypes);\n    const destroy = makeAsync(Human.modules.destroy, id);\n  \n    return new Observable(observer => {\n      function endObserver() {\n        observer.next();\n        observer.complete();\n      }\n  \n      // #TODO: [EM] Engine bug, never calls deactivate callback if target module is not currently active.\n      const shouldDeactivate =\n        Human.timeline.activeRoot && Human.timeline.activeRoot.id === id;\n  \n      (shouldDeactivate ? deactivate() : Promise.resolve({}))\n        .then(() => (purgeAssets ? unload() : Promise.resolve({})))\n        .then(() => destroy())\n        .then(() => endObserver());\n    });\n  }\n\n  /**\n   * Gets the translation data for the specified content.\n   */\n  getStoryTranslation(id: string, type: ContentType, lang: string): Observable<StoryTranslationModel> {\n    // translation data endpoint\n    const url = type === ContentType.Bookmark ? `/search/bookmarks/tr/${lang}/${id}` : `/tr/${lang}/${id}.json`;\n\n    return this.http.get(url)\n      .pipe(\n        map((result: any) => {\n          return plainToClass(StoryTranslationModel, result as Object);\n        })\n      );\n  }\n\n  /**\n   * Check the requested id to determine if requested content is a bookmark or story\n   */\n  getStoryType(id: string): ContentType {\n    return (id.indexOf('/') >= 0) ? ContentType.Module : ContentType.Bookmark;\n  }\n\n  /**\n   * Translate the specified story based on the input translations.\n   */\n  translateStory(story: StoryModel, translation: StoryTranslationModel): StoryModel {\n    const chapters = story.chapters || [];\n    const sceneGraph = story.sceneGraph || [];\n    const translatedObjects = translation.objects || {};\n    const translatedChapters = translation.chapters || [];\n\n    // Translate story title + description\n    story.displayName = translation.displayName || story.displayName;\n    story.description = translation.description || story.description;\n\n    // Translate scene graph\n    sceneGraph.forEach((graph) => {\n      const objects = graph.objects || [];\n      objects.forEach((object: SceneGraphNode) => {\n        this.translateObject(object, translatedObjects);\n      });\n    });\n\n    // Translate chapters\n    chapters.forEach((chapter, chapterIndex) => {\n      const translatedChapter = translatedChapters[chapterIndex];\n      if (translatedChapter) {\n        this.translateMetaInfo(chapter, translatedChapter);\n        // Translate annotations\n        const annotations = chapter.annotations || [];\n        const translatedAnnotations = translatedChapter.annotations || [];\n        annotations.forEach((annotation, annotationIndex) => {\n          const translatedAnnotation = translatedAnnotations[annotationIndex];\n          if (translatedAnnotation) {\n            this.translateMetaInfo(annotation, translatedAnnotation);\n          }\n        });\n        // Translate hotspots\n        const hotspots = chapter.hotspots || [];\n        const translatedHotspots = translatedChapter.hotspots || [];\n        hotspots.forEach((hotspot, hotspotIndex) => {\n          const translatedHotspot = translatedHotspots[hotspotIndex];\n          if (translatedHotspot) {\n            this.translateMetaInfo(hotspot, translatedHotspot);\n          }\n        });\n      }\n    });\n\n    // #TODO[AC]: translate global hotspots\n\n    return story;\n  }\n\n  translateMetaInfo(state: any, metaInfo: StoryTranslationMetaInfo) {\n    const { title, description } = metaInfo;\n    // translate title\n    if (state.hasOwnProperty('displayName')) {\n      state.displayName = title;\n    }\n    if (state.hasOwnProperty('title')) {\n      state.title = title;\n    }\n    // translate description\n    if (state.hasOwnProperty('description')) {\n      state.description = description;\n    }\n  }\n\n  translateObject(object: SceneGraphNode, translatedObjects: { [key: string]: string }) {\n    const objectId = object.objectId;\n    const translatedDisplayName = translatedObjects[objectId];\n    // Translate object\n    if (translatedDisplayName) {\n      object.displayName = translatedDisplayName;\n    }\n    // Translate children\n    const childObjects = object.objects;\n    if (childObjects) {\n      childObjects.forEach((childObject: SceneGraphNode) => {\n        this.translateObject(childObject, translatedObjects);\n      });\n    }\n  }\n\n  /**\n   * Generate a text file from the written content\n   */\n  exportWrittenContent(story: StoryModel, chapters: ChapterModel[], labels: LabelModel[]) {\n    const output = [];\n    \n    // Story title\n    output.push(`\n${story.displayName}\n    `);\n\n    // Chapter\n    chapters.forEach((chapter, index) => {\n      // Chapter content\n      output.push(`\n---\n\n# Chapter ${index + 1}: ${chapter.info.displayName || '-No Title-'}\n\n${chapter.info.description || '-No Description-'}\n      `);\n\n      // Chapter legend (if present)\n      if (chapter.legend.length) {\n        output.push(`\n## Legend\n`);\n        chapter.legend.forEach(chapterLegend => {\n          output.push(`\n* ${chapterLegend.label} (${ColorUtils.rgbToHex(chapterLegend.colors, true)})\n`);\n        });\n      }\n\n      // Chapter labels\n      const chapterLabels = labels.filter(label => label.chapterId === chapter.id);\n      if (chapterLabels.length) {\n        output.push(`\n## Labels\n`);\n\n        chapterLabels.forEach(chapterLabel => {\n          output.push(`\n* ${chapterLabel.title}\n`);\n\n          if (chapterLabel.description) {\n            output.push(`\n  > ${chapterLabel.description}\n`);\n          }\n        });\n      }\n    });\n\n    return output.join('');\n  }\n}\n\n","import { Injectable } from '@angular/core';\n\nimport { Observable, combineLatest } from 'rxjs';\nimport { filter } from 'rxjs/operators';\n\nimport { Select, Store } from '@ngxs/store';\n\nimport { isNil } from 'lodash';\n\nimport { ScalarFresnelModel } from 'src/app/edit/models/scalar-fresnel.model';\n\nimport { StoryChaptersState } from 'src/app/story/state/chapters/story.chapters.state';\n\nimport { SetChapterCurrentLayersIndexPosition } from 'src/app/story/state/chapters/story.chapters.actions';\nimport { NodeActions } from 'src/app/engine/state/nodes/engine.nodes.actions';\nimport { EngineNodesState } from '../engine/state/nodes/engine.nodes.state';\nimport { VisibilityLayerModel } from './models/visibility-layers.model';\n\ndeclare const Human: any;\ndeclare const ScalarFresnel: any;\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class VisibilityLayersService {\n\n  @Select(StoryChaptersState.getSelectedChapterCurrentLayers)\n  selectedChapterCurrentLayers$: Observable<any>;\n\n  @Select(StoryChaptersState.getSelectedChapterCurrentLayersIndex)\n  selectedChapterCurrentLayersIndex$: Observable<any>;\n\n  @Select(StoryChaptersState.getSelectedChapterCurrentLayersPosition)\n  selectedChapterCurrentLayersPosition$: Observable<any>;\n\n  @Select(StoryChaptersState.getSelectedChapterId)\n  selectedChapterId$: Observable<any>;\n\n  private currentLayers = [];\n\n  private nodesLayerIndex = 0;\n  private objectsLayerIndex = 0;\n\n  private selectedChapterId: string;\n\n  constructor(\n    private store: Store\n  ) {}\n\n  initObservables () {\n    this.selectedChapterId$.subscribe((selectedChapterId) => {\n      this.selectedChapterId = selectedChapterId;\n    });\n\n    this.selectedChapterCurrentLayers$.subscribe((currentLayers) => {\n      this.currentLayers = currentLayers;\n      \n      this.nodesLayerIndex = this.objectsLayerIndex = this.store.selectSnapshot(\n        StoryChaptersState.getSelectedChapterCurrentLayersIndex\n      );\n    });\n\n    combineLatest(\n      this.selectedChapterCurrentLayersIndex$,\n      this.selectedChapterCurrentLayersPosition$\n    ).pipe(\n      filter(([currentIndex, currentPosition]) => {\n        return !isNil(currentIndex) && !isNil(currentPosition);\n      })\n    ).subscribe(([currentIndex, currentPosition]) => {\n      this.synchronizeScene(currentIndex, currentPosition, true);\n    });\n  }\n\n  // Update story chapter state and add to undo stack\n  recordLayerIndexPosition (index: number, position: number) {\n    this.store.dispatch(\n      new SetChapterCurrentLayersIndexPosition(\n        this.selectedChapterId, \n        index, \n        position,\n        true\n      )\n    );\n  }\n\n  // Synch the scene either through the app's nodes model\n  // Or directly via the engine.\n  synchronizeScene(index: number, position: number, nodesMode: boolean) {\n    this.updateLayerIndex(index, this.currentLayers, nodesMode);\n    this.updateLayerPosition(position, this.currentLayers, nodesMode);\n  }\n\n  // Fraction calculation methods exclude the last layer\n  fractionToIndex(fraction: number): number {\n    const threshold = this.getThreshold();\n    const index = Math.floor(fraction / threshold);\n    return Math.min(this.currentLayers.length - 2, index);\n  }\n\n  fractionToPosition(fraction: number, index: number): number {\n    const threshold = this.getThreshold();\n    const position = (fraction - (threshold * index)) / threshold;\n    return Math.max(0, Math.min(position, 1));\n  }\n\n  indexPositionToFraction (index: number, position: number): number {\n    const threshold = this.getThreshold();\n    return (index * threshold) + (position * threshold);\n  }\n\n  // Excludes the last layer\n  private getThreshold () {\n    return this.currentLayers.length > 1 ? \n      1 / (this.currentLayers.length - 1) : 1;\n  }\n\n  private getCurrentLayerIndexProp (nodesMode: boolean): string {\n    return nodesMode ? 'nodesLayerIndex' : 'objectsLayerIndex';\n  }\n\n  private updateLayerIndex(newIndex: number, layersData: VisibilityLayerModel[], nodesMode: boolean) {\n    const currentIndexProp = this.getCurrentLayerIndexProp(nodesMode);\n\n    if (newIndex === this[currentIndexProp]) {\n      return;\n    }\n\n    this.restoreLayers(newIndex, this[currentIndexProp], layersData, nodesMode);\n\n    if (nodesMode) {\n      this.nodesLayerIndex = newIndex;\n    }\n\n    this.objectsLayerIndex = newIndex; // Always synch objectsLayerIndex\n  }\n\n  private updateLayerPosition(newPosition: number, layersData: VisibilityLayerModel[], nodesMode: boolean) {\n    const currentIndexProp = this.getCurrentLayerIndexProp(nodesMode);\n    const objectIds = layersData[ this[currentIndexProp] ].objectIds;\n    const opacity = 1 - newPosition;\n\n    this.setObjectsOpacity(objectIds, opacity);\n  }\n\n  private restoreLayers(newIndex: number, oldIndex: number, layersData: VisibilityLayerModel[], nodesMode: boolean) {\n    const diff = Math.abs(newIndex - oldIndex);\n    const dir = (newIndex - oldIndex) / diff;\n    let objectIds = [];\n\n    let i = oldIndex;\n\n    while (i !== newIndex) {\n      objectIds = objectIds.concat(layersData[i].objectIds);\n      i += dir;\n    }\n    \n    // Update old / jumped layer(s)\n    const opacity = dir === 1 ? 0 : 1;\n    const shown = dir === -1;\n\n    this.setObjectsOpacity(objectIds, opacity);\n\n    if (nodesMode) {\n      this.setNodesShown(objectIds, shown);\n    } else {\n      this.setObjectsShown(objectIds, shown);\n    }\n  \n    // Always show current layer when moving right to left.\n    if (dir === -1) {\n      if (nodesMode) {\n        this.setNodesShown(layersData[newIndex].objectIds, true);\n      } else {\n        this.setObjectsShown(layersData[newIndex].objectIds, true);\n      }\n    }\n  }\n\n  private setObjectsOpacity(objectIds: string[], opacity: number) {\n    for (let i = 0; i < objectIds.length; i++) {\n      let newOpacity;\n\n      if (this.hasFresnelOpacity(objectIds[i])) {\n        const scalarFresnelOpacity = \n          new ScalarFresnelModel(Human.scene.objects[ objectIds[i] ].opacity);\n        scalarFresnelOpacity.power = opacity;\n        newOpacity = ScalarFresnelModel.toEngine(scalarFresnelOpacity);\n      } else {\n        newOpacity = opacity;\n      }\n\n      Human.scene.objects[objectIds[i]].setOpacity(newOpacity);\n    }\n  }\n\n  private hasFresnelOpacity(objectId: string): boolean {\n    return Human.scene.objects[objectId].opacity instanceof ScalarFresnel;\n  }\n\n  private setObjectsShown(objectIds: string[], shown: boolean) {\n    const update = {};\n\n    for (let i = 0; i < objectIds.length; i++) {\n      update[objectIds[i]] = shown;\n    }\n\n    Human.scene.setEnabledObjects({ objects: update });\n  }\n\n  private setNodesShown(objectIds, shown) {\n    this.store.dispatch(\n      new NodeActions.UpdateNodesShown(\n        shown, \n        objectIds, \n        undefined, \n        false\n      )\n    );\n  }\n\n}\n","import { SavePatch } from './undo.state.model';\n\nexport namespace UndoActions {\n  export class Reset {\n    static readonly type = '[Undo] Reset';\n    constructor() {}\n  }\n\n  export class Undo {\n    static readonly type = '[Undo] Undo';\n    constructor(public chapterId: string) {}\n  }\n\n  export class UndoAll {\n    static readonly type = '[Undo] Undo All';\n    constructor(public chapterId: string) {}\n  }\n\n  export class Redo {\n    static readonly type = '[Undo] Redo';\n    constructor(public chapterId: string) {}\n  }\n\n  export class SavePatches {\n    static readonly type = '[Undo] Store Patches';\n    constructor(public patches: SavePatch[]) {}\n  }\n}\n","import { State, Action, StateContext, Store, Selector } from '@ngxs/store';\nimport { UndoStateModel, UndoStack } from './undo.state.model';\nimport { UndoActions } from './undo.state.actions';\nimport { StoryChaptersState } from 'src/app/story/state/chapters/story.chapters.state';\nimport { StoryChaptersStateModel } from 'src/app/story/state/chapters/story.chapters.state.model';\nimport { get } from 'lodash';\n\ndeclare const immer;\n\nconst initialState: UndoStateModel = {\n  stacksForChapter: {}\n};\n\n@State<UndoStateModel>({\n  name: 'undo',\n  defaults: initialState\n})\nexport class UndoState {\n  constructor(private store: Store) {}\n\n  @Selector([StoryChaptersState])\n  static canUndo(\n    state: UndoStateModel,\n    chapterState: StoryChaptersStateModel\n  ): boolean {\n    return (\n      state.stacksForChapter[chapterState.selectedChapter].undoStack.length > 0\n    );\n  }\n\n  @Selector([StoryChaptersState])\n  static canRedo(\n    state: UndoStateModel,\n    chapterState: StoryChaptersStateModel\n  ): boolean {\n    return (\n      state.stacksForChapter[chapterState.selectedChapter].redoStack.length > 0\n    );\n  }\n\n  @Selector([StoryChaptersState])\n  static getUndoCount(\n    state: UndoStateModel,\n    chapterState: StoryChaptersStateModel\n  ): number {\n    return (\n      state.stacksForChapter[chapterState.selectedChapter].undoStack.length || 0\n    );\n  }\n\n  @Action(UndoActions.Reset) \n  reset(context: StateContext<UndoStateModel>, action: UndoActions.Reset) {\n    context.patchState(\n      immer.produce(context.getState(), draft => {\n        draft.stacksForChapter = {};\n      })\n    );\n  }\n\n  @Action(UndoActions.UndoAll)\n  undoAll(context: StateContext<UndoStateModel>, action: UndoActions.UndoAll) {\n\n    const state = context.getState();\n\n    if (state.stacksForChapter[action.chapterId] === undefined) {\n      return;\n    }\n\n    const patches = [\n      ...state.stacksForChapter[action.chapterId].undoStack\n    ].reverse();\n\n    // batch all patches of the same kind to be dispatched at once.\n    const sortedPatches = patches.flat().reduce((sorted, patch) => {\n      if (sorted[patch.patchAction] === undefined) {\n        sorted[patch.patchAction] = {\n          action: patch.patchAction,\n          patches: []\n        };\n      }\n\n      sorted[patch.patchAction].patches = [\n        ...sorted[patch.patchAction].patches,\n        ...patch.inverse\n      ];\n      return sorted;\n    }, {});\n\n    Object.keys(sortedPatches).forEach(actionName => {\n      context.dispatch(\n        new sortedPatches[actionName].action(sortedPatches[actionName].patches)\n      );\n    });\n\n\n\n    const nextState = immer.produce(state, draft => {\n      draft.stacksForChapter[action.chapterId].undoStack = [];\n      draft.stacksForChapter[action.chapterId].redoStack = patches;\n    });\n\n    context.patchState(nextState);\n  }\n\n  @Action(UndoActions.SavePatches)\n  preserveState(\n    context: StateContext<UndoStateModel>,\n    action: UndoActions.SavePatches\n  ) {\n    const chapterId = this.store.selectSnapshot(\n      StoryChaptersState.getSelectedChapterId\n    );\n\n    const nextState = immer.produce(context.getState(), draft => {\n\n      if (action.patches.length === 0) {\n        return;\n      }\n\n      if (\n        action.patches.some((patch) => patch.forward.length === 0) &&\n        action.patches.some((patch) => patch.inverse.length === 0)\n      ) {\n        return;\n      }\n      \n      if (draft.stacksForChapter[chapterId] === undefined) {\n        draft.stacksForChapter[chapterId] = { redoStack: [], undoStack: [] };\n      }\n\n      draft.stacksForChapter[chapterId].redoStack = [];\n      const undoStack = draft.stacksForChapter[chapterId].undoStack as UndoStack;\n      undoStack.push(action.patches);\n    });\n\n    context.patchState(nextState);\n  }\n\n  @Action(UndoActions.Redo)\n  redo(context: StateContext<UndoStateModel>, action: UndoActions.Redo) {\n\n    const state = context.getState();\n    const redoStack = get(state.stacksForChapter[action.chapterId], 'redoStack', []) as UndoStack;\n\n    if (redoStack.length === 0) {\n      return;\n    }\n\n    const savePatches = redoStack[redoStack.length - 1];\n    const nextState = immer.produce(state, draft => {\n      draft.stacksForChapter[action.chapterId].redoStack.pop();\n      draft.stacksForChapter[action.chapterId].undoStack.push(savePatches);\n    });\n\n    context.patchState(nextState);\n    savePatches.forEach(patch => {\n      context.dispatch(new patch.patchAction(patch.forward));\n    });\n  }\n\n  @Action(UndoActions.Undo)\n  undo(context: StateContext<UndoStateModel>, action: UndoActions.Undo) {\n\n    const state = context.getState();\n    const undoStack = get(state.stacksForChapter[action.chapterId], 'undoStack', []) as UndoStack;\n\n    if (undoStack.length === 0) {\n      return;\n    }\n\n    const savePatches = undoStack[undoStack.length - 1];\n    const nextState = immer.produce(state, draft => {\n      draft.stacksForChapter[action.chapterId].undoStack.pop();\n      draft.stacksForChapter[action.chapterId].redoStack.push(savePatches);\n    });\n\n    context.patchState(nextState);\n    savePatches.forEach(patch => {\n      context.dispatch(new patch.patchAction(patch.inverse));\n    });\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { NgxsModule } from '@ngxs/store';\nimport { UndoState } from './state/undo.state';\n\n\n@NgModule({\n  declarations: [],\n  imports: [\n    NgxsModule.forFeature(\n      [UndoState]\n    ),\n    CommonModule\n  ]\n})\nexport class UndoModule { }\n","<div class=\"whiteboard-label\">\n  <div *ngIf=\"active === true\">\n    <div\n      class=\"whiteboard-label__handle whiteboard-label__handle--top-left\"\n      cdkDrag\n      (cdkDragMoved)=\"dragMoved($event, 'corner1')\"\n      [cdkDragFreeDragPosition]=\"dragHandles.corner1\"\n    ></div>\n    <div\n      class=\"whiteboard-label__handle whiteboard-label__handle--top-right\"\n      cdkDrag\n      (cdkDragMoved)=\"dragMoved($event, 'corner2')\"\n      [cdkDragFreeDragPosition]=\"dragHandles.corner2\"\n    ></div>\n    <div\n      class=\"whiteboard-label__handle whiteboard-label__handle--bottom-right\"\n      cdkDrag\n      (cdkDragMoved)=\"dragMoved($event, 'corner3')\"\n      [cdkDragFreeDragPosition]=\"dragHandles.corner3\"\n    ></div>\n    <div\n      class=\"whiteboard-label__handle whiteboard-label__handle--bottom-left\"\n      cdkDrag\n      (cdkDragMoved)=\"dragMoved($event, 'corner4')\"\n      [cdkDragFreeDragPosition]=\"dragHandles.corner4\"\n    ></div>\n    <div\n      class=\"whiteboard-label__handle whiteboard-label__handle--move\"\n      cdkDrag\n      (cdkDragMoved)=\"translateHandleMoved($event)\"\n      [cdkDragFreeDragPosition]=\"dragHandles.translate\"\n    ></div>\n  </div>\n\n  <div \n    class=\"whiteboard-label__label\" \n    #textRef\n    contenteditable=\"true\"\n    [ngClass]=\"{'whiteboard-label__label--active': active === true}\"\n    data-placeholder=\"Type..\"\n    [attr.data-id]=\"id\"\n  >\n  </div>\n</div>","import { CdkDragMove } from '@angular/cdk/drag-drop';\nimport {\n  ChangeDetectionStrategy,\n  ChangeDetectorRef,\n  Component,\n  ElementRef,\n  OnInit,\n  Renderer2,\n  ViewChild,\n  Input,\n  OnDestroy,\n  Output,\n  EventEmitter,\n} from '@angular/core';\n\nconst TranslateHandleOffset = -10;\ntype CornerId = 'corner1' | 'corner2' | 'corner3' | 'corner4';\n\n/**\n *\n *           T\n *    C1-----------C2\n *    |             |\n *    |             |\n *    |             |\n *    C4-----------C3\n *\n *    In `dragMoved`, Angular tells us that a corner has been dragged.\n *    We use the dragged handle's new position to set the positions of the adjacent corner.\n *    E.g., corner1's movement effects the y position of C2\n *    and the x position of C4.\n *\n *    `setHandle` updates the handle's state, and updates the dom.\n *\n *     Later, `updateTranslation` uses the new corner locations\n *     to reposition the translation handle.\n *\n *     Finally, `updateTextarea` updates the native element's\n *     transform, and the changes are pushed to the dom.\n */\n@Component({\n  selector: 'app-view-annotate-label',\n  templateUrl: './view-annotate-label.component.html',\n  styleUrls: ['./view-annotate-label.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class ViewAnnotateLabelComponent implements OnInit, OnDestroy {\n  @ViewChild('textRef', { static: true }) textRef: ElementRef;\n\n  @Input()\n  id: string;\n\n  @Input()\n  initialPos: { x: number; y: number };\n\n  @Input()\n  public set color(value: string) {\n    this.renderer.setStyle(this.textRef.nativeElement, 'color', value);\n  }\n\n  @Input()\n  public set exporting(isExporting: boolean) {\n    if (isExporting) {\n      this.active = false;\n      this.labelActive.next(undefined);\n    }\n  }\n\n  @Input()\n  public set size(value: string) {\n    this.renderer.setStyle(\n      this.textRef.nativeElement,\n      'font-size',\n      `${value}px`\n    );\n  }\n\n  active = true;\n\n  @Output()\n  labelActive = new EventEmitter();\n\n  @Output()\n  labelEmpty = new EventEmitter();\n\n  dragHandles = {\n    translate: { x: 0, y: 0 },\n    corner1: { x: 0, y: 0 },\n    corner2: { x: 0, y: 0 },\n    corner3: { x: 0, y: 0 },\n    corner4: { x: 0, y: 0 },\n  };\n\n  handleCoords = {\n    translate: { x: 0, y: 0 },\n    corner1: { x: 0, y: 0 },\n    corner2: { x: 0, y: 0 },\n    corner3: { x: 0, y: 0 },\n    corner4: { x: 0, y: 0 },\n  };\n\n  textareaTransform = {\n    x: 0,\n    y: 0,\n    width: 110,\n    height: 40,\n  };\n\n  mouseDownListener: () => void;\n  backspaceListener: () => void;\n\n  constructor(\n    private changeDetectorRef: ChangeDetectorRef,\n    private renderer: Renderer2\n  ) {}\n\n  ngOnInit() {\n    this.initHandles();\n    this.initInteractionListeners();\n    setTimeout(() => {\n      this.textRef.nativeElement.focus();\n    });\n  }\n\n  ngOnDestroy() {\n    this.textRef.nativeElement.removeEventListener(\n      'keydown',\n      this.handleTextKeyDown\n    );\n\n    this.textRef.nativeElement.removeEventListener(\n      'mousedown',\n      this.handleTextboxMouseDown\n    );\n\n    this.mouseDownListener();\n    this.backspaceListener();\n  }\n\n  private initHandles() {\n    this.textareaTransform.x = this.initialPos.x;\n    this.textareaTransform.y = this.initialPos.y;\n    const { x, y, width, height } = this.textareaTransform;\n\n    this.dragHandles.corner1 = { x, y };\n    this.dragHandles.corner2 = { x: x + width, y };\n    this.dragHandles.corner3 = { x: x + width, y: y + height };\n    this.dragHandles.corner4 = { x, y: y + height };\n    this.dragHandles.translate = {\n      x: x + width / 2,\n      y: y + TranslateHandleOffset,\n    };\n\n    this.handleCoords.corner1 = { ...this.dragHandles.corner1 };\n    this.handleCoords.corner2 = { ...this.dragHandles.corner2 };\n    this.handleCoords.corner3 = { ...this.dragHandles.corner3 };\n    this.handleCoords.corner4 = { ...this.dragHandles.corner4 };\n    this.handleCoords.translate = { ...this.dragHandles.translate };\n    this.updateTextarea();\n  }\n\n  private initInteractionListeners() {\n    this.mouseDownListener = this.renderer.listen(\n      'document',\n      'mousedown',\n      this.handleDocumentMouseDown\n    );\n\n    this.backspaceListener = this.renderer.listen(\n      'document',\n      'keydown',\n      this.handleDocumentBackspace\n    );\n\n    this.textRef.nativeElement.addEventListener(\n      'mousedown',\n      this.handleTextboxMouseDown\n    );\n\n    this.textRef.nativeElement.addEventListener(\n      'keydown',\n      this.handleTextKeyDown\n    );\n  }\n\n  private handleDocumentBackspace = (e: KeyboardEvent) => {\n    const { activeElement } = this.textRef.nativeElement;\n    if (e.key === 'Backspace' && this.active && !activeElement) {\n      this.deleteLabel();\n    }\n  }\n\n  private handleTextboxMouseDown = (e: MouseEvent) => {\n    this.active = true;\n    this.labelActive.next(this.id);\n    this.refreshHandles();\n  }\n\n  private refreshHandles() {\n    this.dragHandles.corner1 = { ...this.handleCoords.corner1 };\n    this.dragHandles.corner2 = { ...this.handleCoords.corner2 };\n    this.dragHandles.corner3 = { ...this.handleCoords.corner3 };\n    this.dragHandles.corner4 = { ...this.handleCoords.corner4 };\n    this.dragHandles.translate = { ...this.handleCoords.translate };\n    this.changeDetectorRef.markForCheck();\n  }\n\n  private handleDocumentMouseDown = (e) => {\n    const canvasClick = e.target.className.includes('view-annotate__canvas');\n    const labelClick = e.target.className.includes('whiteboard-label__label');\n    const selfClick = e.target.dataset.id === this.id;\n    const empty = this.isLabelEmpty();\n\n    if (empty && !selfClick) {\n      this.deleteLabel();\n    } else if (canvasClick || (labelClick && !selfClick)) {\n      this.active = false;\n      this.changeDetectorRef.markForCheck();\n    }\n  }\n\n  private isLabelEmpty() {\n    // account for Safari inserting \\n even when empty\n    return (\n      this.textRef.nativeElement.innerText === '' ||\n      this.textRef.nativeElement.innerText === '\\n'\n    );\n  }\n\n  private deleteLabel() {\n    this.labelEmpty.next(this.id);\n  }\n\n  private handleTextKeyDown = (e: KeyboardEvent) => {\n    // stop propagation, so the camera doesn't move on WASD, etc.\n    e.stopPropagation();\n\n    if (this.isLabelEmpty() && e.key === 'Backspace') {\n      this.deleteLabel();\n      return;\n    }\n\n    const height = this.textRef.nativeElement.scrollHeight;\n    const { corner1, corner3, corner4 } = this.handleCoords;\n    const newBottomY = corner1.y + height;\n\n    this.handleCoords.corner3 = { ...corner3, y: newBottomY };\n    this.handleCoords.corner4 = { ...corner4, y: newBottomY };\n    this.dragHandles.corner3 = { ...this.handleCoords.corner3 };\n    this.dragHandles.corner4 = { ...this.handleCoords.corner4 };\n\n    this.updateTextarea();\n    this.changeDetectorRef.markForCheck();\n  }\n\n  private updateTextarea() {\n    // update textarea transform\n    const { corner1, corner2, corner3 } = this.handleCoords;\n    this.textareaTransform.x = corner1.x;\n    this.textareaTransform.y = corner1.y;\n\n    this.textareaTransform.width = corner2.x - corner1.x;\n    this.textareaTransform.height = corner3.y - corner2.y;\n\n    // write to dom\n    this.renderer.setStyle(\n      this.textRef.nativeElement,\n      'transform',\n      `translate(${this.textareaTransform.x}px, ${this.textareaTransform.y}px)`\n    );\n\n    this.renderer.setStyle(\n      this.textRef.nativeElement,\n      'width',\n      `${this.textareaTransform.width}px`\n    );\n\n    this.renderer.setStyle(\n      this.textRef.nativeElement,\n      'height',\n      `${this.textareaTransform.height}px`\n    );\n  }\n\n  private updateTranslateHandle() {\n    const { corner1, corner2 } = this.handleCoords;\n    const handleCenter = (corner2.x - corner1.x) / 2 + corner1.x;\n    const handleY = corner1.y + TranslateHandleOffset;\n\n    this.handleCoords.translate = {\n      x: handleCenter,\n      y: handleY,\n    };\n\n    this.dragHandles.translate = { ...this.handleCoords.translate };\n  }\n\n  private setHandle(\n    corner: CornerId,\n    axis: 'x' | 'y',\n    handlePos: { x: number; y: number }\n  ) {\n    this.handleCoords[corner] = {\n      ...this.handleCoords[corner],\n      [axis]: handlePos[axis],\n    };\n    this.dragHandles[corner] = { ...this.handleCoords[corner] };\n  }\n\n  private addDiffToHandle(corner: CornerId, diff: { x: number; y: number }) {\n    this.handleCoords[corner] = {\n      x: this.handleCoords[corner].x + diff.x,\n      y: this.handleCoords[corner].y + diff.y,\n    };\n\n    this.dragHandles[corner] = { ...this.handleCoords[corner] };\n  }\n\n  translateHandleMoved($event: CdkDragMove) {\n    const handlePos = $event.source._dragRef.getFreeDragPosition();\n\n    const diff = {\n      x: handlePos.x - this.handleCoords.translate.x,\n      y: handlePos.y - this.handleCoords.translate.y,\n    };\n\n    this.handleCoords.translate = { ...handlePos };\n    this.addDiffToHandle('corner1', diff);\n    this.addDiffToHandle('corner2', diff);\n    this.addDiffToHandle('corner3', diff);\n    this.addDiffToHandle('corner4', diff);\n\n    this.updateTextarea();\n  }\n\n  dragMoved($event: CdkDragMove, id: CornerId) {\n    const handlePos = $event.source._dragRef.getFreeDragPosition();\n    this.handleCoords[id] = { ...handlePos };\n\n    if (id === 'corner1') {\n      this.setHandle('corner2', 'y', handlePos);\n      this.setHandle('corner4', 'x', handlePos);\n    }\n\n    if (id === 'corner2') {\n      this.setHandle('corner1', 'y', handlePos);\n      this.setHandle('corner3', 'x', handlePos);\n    }\n\n    if (id === 'corner3') {\n      this.setHandle('corner2', 'x', handlePos);\n      this.setHandle('corner4', 'y', handlePos);\n    }\n\n    if (id === 'corner4') {\n      this.setHandle('corner1', 'x', handlePos);\n      this.setHandle('corner3', 'y', handlePos);\n    }\n\n    this.updateTranslateHandle();\n    this.updateTextarea();\n  }\n}\n","<div class=\"view-annotate-tools\" gaCategory=\"View Whiteboard Tools\">\n    <app-pillbox\n        eventCategory=\"View Whiteboard Tools\"\n        name=\"Whiteboard\"\n        padding=\"dense\"\n        [canExit]=\"true\"\n        (exit)=\"handleExitClick()\">\n\n\n        <button\n            class=\"mr-1\"\n            [matMenuTriggerFor]=\"textSizeMenu\"\n            app-pin-button\n            buttonType=\"ghost\"\n            icon=\"text-size\"\n            aria-label=\"Text\"\n            matTooltip=\"Text\"\n            [selected]=\"(mode$ | async) === modeEnum.Text\"\n            (click)=\"handleModeSelect(modeEnum.Text)\">\n        </button>\n\n        <button     \n            [matMenuTriggerFor]=\"brushSizeMenu\"\n            app-pin-button\n            buttonType=\"ghost\"\n            icon=\"paint-brush\"\n            aria-label=\"Brush\"\n            matTooltip=\"Brush\"\n            [selected]=\"(mode$ | async) === modeEnum.Paint\"\n            (click)=\"handleModeSelect(modeEnum.Paint)\">\n        </button>\n\n        <app-pillbox-divider></app-pillbox-divider>\n\n\n        <button\n            #colorBtn\n            [matMenuTriggerFor]=\"brushColorMenu\"\n            app-pin-button\n            buttonType=\"ghost\"\n            icon=\"tint\"\n            aria-label=\"Color\"\n            matTooltip=\"Color\">\n        </button>\n\n        <app-pillbox-divider></app-pillbox-divider>\n\n        <button\n            app-pin-button\n            buttonType=\"ghost\"\n            icon=\"download\"\n            aria-label=\"Download\"\n            matTooltip=\"Download\"\n            (click)=\"handleDownloadClick()\">\n        </button>\n\n        <app-pillbox-divider></app-pillbox-divider>\n\n        <button\n            app-pin-button\n            buttonType=\"ghost\"\n            aria-label=\"Clear\"\n            matTooltip=\"Clear\"\n            (click)=\"handleClearClick()\">\n            Clear\n        </button>\n\n\n        <!-- menu: text size -->\n        <mat-menu #textSizeMenu=\"matMenu\">\n\n            <button               \n                mat-menu-item\n                *ngFor=\"let size of textSizes\"\n                (click)=\"setTextSize(size.size)\">\n\n                <div class=\"flex flex-row items-center justify-end\">\n                    <div class=\"view-annotate-tools__check\">\n                        <app-icon\n                            *ngIf=\"size.size === (textSize$ | async)\"\n                            class=\"mr-2\"\n                            icon=\"check\">\n                        </app-icon>\n                    </div>\n\n                    <div class=\"view-annotate-tools__label\">\n                        <span>{{ size.label }}px</span>\n                    </div>\n                </div>\n\n            </button>\n\n        </mat-menu>\n\n        <!-- menu: brush size -->\n        <mat-menu #brushSizeMenu=\"matMenu\">\n\n            <button               \n                mat-menu-item\n                *ngFor=\"let size of brushSizes\"\n                (click)=\"setBrushSize(size.size)\">\n\n                <div class=\"flex flex-row items-center justify-end\">\n                    <div class=\"view-annotate-tools__check\">\n                        <app-icon\n                            *ngIf=\"size.size === (brushSize$ | async)\"\n                            class=\"mr-2\"\n                            icon=\"check\">\n                        </app-icon>\n                    </div>\n\n                    <div class=\"view-annotate-tools__label\">\n                        <app-icon\n                            class=\"mr-2\"\n                            icon=\"circle\"\n                            [style.font-size.px]=\"size.size\">\n                        </app-icon>\n                        \n                        <span>{{ size.label }}</span>\n                    </div>\n                </div>\n\n            </button>\n\n        </mat-menu>\n\n        <!-- menu: brush color -->\n        <mat-menu #brushColorMenu=\"matMenu\">\n\n            <button                \n                mat-menu-item\n                *ngFor=\"let color of brushColors\"\n                (click)=\"setBrushColor(color.color)\">\n\n                <div class=\"flex flex-row items-center justify-end\">\n                    <div class=\"view-annotate-tools__check\">\n                        <app-icon\n                            *ngIf=\"color.color === (brushColor$ | async)\"\n                            class=\"mr-2\"\n                            icon=\"check\">\n                        </app-icon>\n                    </div>\n\n                    <div class=\"view-annotate-tools__label\">\n                        <app-icon\n                            class=\"mr-2\"\n                            icon=\"circle\"\n                            [style.font-size.px]=\"14\"\n                            [style.color]=\"color.color\">\n                        </app-icon>\n\n                        <span>{{ color.label }}</span>\n\n                    </div>\n                </div>\n\n            </button>\n\n        </mat-menu>\n\n    </app-pillbox>\n</div>","import {\n  Component,\n  OnInit,\n  ChangeDetectionStrategy,\n  EventEmitter,\n  Output,\n  ViewEncapsulation,\n  ViewChild,\n  ElementRef,\n  AfterViewInit,\n  OnDestroy\n} from '@angular/core';\nimport { Store, Select } from '@ngxs/store';\nimport { ViewActions } from '../../state/view.actions';\nimport { ViewState } from '../../state/view.state';\nimport { Observable, Subject } from 'rxjs';\nimport {\n  WhiteboardBrushSizePresets,\n  WhiteboardColorPresets,\n  WhiteboardTextSizePresets,\n} from 'src/app/engine/models/whiteboard-presets.const';\nimport { takeUntil } from 'rxjs/operators';\nimport { WhiteboardAnnotateMode } from '../../models/whiteboard-state.model';\n\n@Component({\n  selector: 'app-view-annotate-tools',\n  templateUrl: './view-annotate-tools.component.html',\n  styleUrls: ['./view-annotate-tools.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None\n})\nexport class ViewAnnotateToolsComponent implements OnInit, AfterViewInit, OnDestroy {\n  textSizes = WhiteboardTextSizePresets;\n  brushSizes = WhiteboardBrushSizePresets;\n  brushColors = WhiteboardColorPresets;\n  modeEnum = WhiteboardAnnotateMode;\n\n  @ViewChild('colorBtn', { static: true, read: ElementRef })\n  colorBtn: ElementRef;\n\n\n  @Select(ViewState.getWhiteboardAnnotateMode)\n  mode$: Observable<WhiteboardAnnotateMode>;\n\n  @Select(ViewState.getWhiteboardBrushSize)\n  brushSize$: Observable<number>;\n\n  @Select(ViewState.getWhiteboardTextSize)\n  textSize$: Observable<number>;\n\n  @Select(ViewState.getWhiteboardBrushColor)\n  brushColor$: Observable<string>;\n\n  @Output()\n  downloadClick = new EventEmitter();\n\n  @Output()\n  clearClick = new EventEmitter();\n\n  @Output()\n  exitClick = new EventEmitter();\n\n  private ngUnsubscribe = new Subject();\n  \n  constructor(private store: Store) { }\n\n  ngOnInit() {\n  }\n\n  ngAfterViewInit() {\n    this.brushColor$\n    .pipe(\n      takeUntil(this.ngUnsubscribe)\n    )\n      .subscribe((brushColor) => {\n        this.colorBtn.nativeElement.style.setProperty('--pin-button-pin-color', brushColor);\n      });\n  }\n\n  ngOnDestroy() {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n  setBrushSize(size: number) {\n    this.store.dispatch(new ViewActions.SetWhiteboardBrushSize(size));\n  }\n\n  setBrushColor(color: string) {\n    this.store.dispatch(new ViewActions.SetWhiteboardBrushColor(color));\n  }\n\n  setTextSize(size: number) {\n    this.store.dispatch(new ViewActions.SetWhiteboardTextSize(size));\n  }\n  \n  handleModeSelect(mode: WhiteboardAnnotateMode) {\n    this.store.dispatch(new ViewActions.SetWhiteboardAnnotateMode(mode));\n  }\n\n  handleDownloadClick() {\n    this.downloadClick.next();\n  }\n\n  handleClearClick() {\n    this.clearClick.next();\n  }\n\n  handleExitClick() {\n    this.exitClick.next();\n  }\n\n}\n","<div \n    class=\"view-annotate\"\n    [class.view-annotate--exporting]=\"exporting\"\n    #annotateWrapper>\n\n    <!-- labels -->\n    <app-view-annotate-label \n        class=\"view-annotate__label\"\n        [class.view-annotate__label--clickthrough]=\"(annotateMode$ | async) !== whiteboardAnnotateMode.Text\"\n        *ngFor=\"let label of labels;\"\n        [exporting]=\"exporting\"\n        [id]=\"label.id\"\n        [initialPos]=\"label.pos\" \n        [color]=\"label.color\" \n        [size]=\"label.size\"\n        (labelActive)=handleLabelActive($event)\n        (labelEmpty)=handleLabelEmpty($event)>\n    </app-view-annotate-label>\n\n    <!-- Drawing Canvas -->\n    <canvas class=\"view-annotate__canvas\" #drawCanvas></canvas> \n\n    <!-- Drawing Toolbar -->\n    <div class=\"view-annotate__tools\">\n        <app-view-annotate-tools\n            (clearClick)=\"handleResetClick()\"\n            (downloadClick)=\"handleDownloadClick()\"\n            (exitClick)=\"handleExitClick()\">\n        </app-view-annotate-tools>\n    </div>\n\n</div>","import {\n  Component,\n  OnInit,\n  ViewChild,\n  ElementRef,\n  ChangeDetectionStrategy,\n  AfterViewInit,\n  OnDestroy,\n  ChangeDetectorRef,\n  ViewEncapsulation\n} from '@angular/core';\nimport { Subject, fromEvent, Observable, merge } from 'rxjs';\nimport { takeUntil, flatMap, take, debounceTime, pairwise, startWith, map, finalize } from 'rxjs/operators';\nimport { Select, Store, Actions, ofActionDispatched } from '@ngxs/store';\nimport { ViewState } from '../../state/view.state';\nimport { ViewService } from '../../view.service';\nimport { TakeChapterPicture, TakeChapterPictureSuccess } from 'src/app/story/state/chapters/story.chapters.actions';\nimport { StoryChaptersState } from 'src/app/story/state/chapters/story.chapters.state';\nimport { ImageTypeEnum } from 'src/app/shared/image.service';\nimport { PublishService } from 'src/app/publish/publish.service';\nimport { ScreenDimensions } from 'src/app/shared/models/screen.dimensions.model';\nimport { StoryState } from 'src/app/story/state/story.state';\nimport { LayoutActions } from 'src/app/layout/state/layout.actions';\nimport { SiteHeaderType } from 'src/app/layout/models/site-header-type.enum';\nimport { LayoutState } from 'src/app/layout/state/layout.state';\nimport { WhiteboardAnnotateMode } from '../../models/whiteboard-state.model';\nimport { ViewActions } from '../../state/view.actions';\nimport { uniqueId } from 'lodash';\n\n// export defaults\nconst exportFormat: ImageTypeEnum = ImageTypeEnum.PNG;\nconst exportQuality = 100;\n\ninterface LabelDescriptor {\n  id: string;\n  pos: {x: number, y: number};\n  color: string;\n  size: number;\n}\n\n@Component({\n  selector: 'app-view-annotate',\n  templateUrl: './view-annotate.component.html',\n  styleUrls: ['./view-annotate.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None,\n})\nexport class ViewAnnotateComponent implements OnInit, AfterViewInit, OnDestroy {\n  whiteboardAnnotateMode = WhiteboardAnnotateMode;\n\n  @ViewChild('drawCanvas', { static: true })\n  drawCanvas: ElementRef;\n\n  @ViewChild('annotateWrapper', { static: true })\n  annotateElement: ElementRef;\n\n  @Select(ViewState.getWhiteboardAnnotateMode)\n  annotateMode$: Observable<WhiteboardAnnotateMode>;\n\n  @Select(ViewState.getWhiteboardBrushSize)\n  brushSize$: Observable<number>;\n\n  @Select(ViewState.getWhiteboardBrushColor)\n  brushColor$: Observable<string>;\n\n  @Select(ViewState.getWhiteboardTextSize)\n  textSize$: Observable<number>;\n\n  siteHeader: SiteHeaderType;\n  labels: LabelDescriptor[] = [];\n  activeLabelId: string;\n  exporting = false;\n\n  private inputManager: HammerManager;\n  private canvasElement: HTMLCanvasElement;\n  private canvasContext: CanvasRenderingContext2D;\n  private brushSize = 0;\n\n  private ngUnsubscribe = new Subject();\n\n  constructor(\n    private store: Store,\n    private actions: Actions,\n    private viewService: ViewService,\n    private publishService: PublishService,\n    private changeRef: ChangeDetectorRef\n  ) {}\n\n  initTextModeListener() {\n    this.inputManager = new Hammer.Manager(this.drawCanvas.nativeElement);\n    this.inputManager.add(new Hammer.Tap({ event: 'tap' }));\n    this.inputManager.on('tap', (event) => {\n    \n      if (this.activeLabelId) {\n        this.activeLabelId = undefined;\n        return;\n      }\n\n      const labelId = uniqueId();\n      const { x, y } = event.pointers[0];\n\n      const color = this.store.selectSnapshot(\n        ViewState.getWhiteboardBrushColor\n      );\n      const size = this.store.selectSnapshot(ViewState.getWhiteboardTextSize);\n\n      this.labels.push({\n        id: labelId,\n        pos: { x, y },\n        color,\n        size,\n      });\n      this.activeLabelId = labelId;\n      this.changeRef.markForCheck();\n    });\n  }\n\n  handleLabelActive(activeLabelId) {\n    this.activeLabelId = activeLabelId;\n    const activeLabel = this.labels.find(label => label.id === activeLabelId);\n    if (activeLabel)  {\n      this.store.dispatch([\n        new ViewActions.SetWhiteboardTextSize(activeLabel.size),\n        new ViewActions.SetWhiteboardBrushColor(activeLabel.color)\n      ]);\n    }\n  }\n\n  handleLabelEmpty(labelId) {\n    this.labels = this.labels.filter(label => label.id !== labelId);\n    this.changeRef.markForCheck();\n  }\n\n  ngOnInit() {\n    this.canvasElement = this.drawCanvas.nativeElement;\n    this.canvasContext = this.canvasElement.getContext('2d');\n\n    this.siteHeader = this.store.selectSnapshot(LayoutState.getSiteHeader);\n    this.store.dispatch(new LayoutActions.SetHeader(SiteHeaderType.Hide));\n\n\n    this.brushColor$.pipe(takeUntil(this.ngUnsubscribe)).subscribe(color => {\n      const activeLabel = this.labels.find(label => label.id === this.activeLabelId);\n      if (activeLabel) {\n        activeLabel.color = color;\n        this.changeRef.markForCheck();\n      }\n    });\n\n    this.textSize$.pipe(takeUntil(this.ngUnsubscribe)).subscribe(size => {\n      const activeLabel = this.labels.find(label => label.id === this.activeLabelId);\n      if (activeLabel) {\n        activeLabel.size = size;\n        this.changeRef.markForCheck();\n      }\n    });\n\n    this.annotateMode$.pipe(takeUntil(this.ngUnsubscribe)).subscribe((mode) => {\n      if (this.inputManager) {\n        this.inputManager.destroy();\n      }\n      if (mode === WhiteboardAnnotateMode.Paint) {\n        this.initInputListeners();\n      } else if (mode === WhiteboardAnnotateMode.Text) {\n        this.initTextModeListener();\n      } else {\n        // noop\n      }\n    });\n  }\n\n  ngAfterViewInit() {\n    this.initCanvasListeners();\n  }\n\n  ngOnDestroy() {\n    // cleanup input handling\n    this.inputManager.destroy();\n\n    // cleanup canvas\n    this.reset();\n\n    // reset header\n    this.store.dispatch(new LayoutActions.SetHeader(this.siteHeader));\n\n    // cleanup subscriptions\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n  initCanvasListeners() {\n    // set canvas pen settings\n    this.brushSize$\n      .pipe(takeUntil(this.ngUnsubscribe))\n      .subscribe((brushSize) => {\n        this.setBrushSize(brushSize);\n      });\n\n    this.brushColor$\n      .pipe(takeUntil(this.ngUnsubscribe))\n      .subscribe((brushColor) => {\n        this.setBrushColor(brushColor);\n      });\n\n    // set initial state\n    this.syncCanvas();\n  }\n\n  initInputListeners() {\n    // Input Handlers\n    this.inputManager = new Hammer.Manager(this.drawCanvas.nativeElement);\n    this.inputManager.add(new Hammer.Pan({ event: 'pan', pointers: 0 }));\n    this.inputManager.add(new Hammer.Tap({ event: 'tap' }));\n    /*\n      NOTE: Hammerjs doesn't track delta movements (i.e., movementX) in subpixel,\n            causing jagged edges in drawing lines (slight offset).\n            Track last movements manually to get smooth drawing.\n    */\n    const lastPoints = new Map<number, { x: number; y: number }>();\n\n    // draw point\n    this.inputManager.on('tap', (event) => {\n      event.pointers.forEach((pointer: PointerEvent) => {\n        const { x, y } = pointer;\n        this.drawPoint(x, y);\n      });\n    });\n\n    // draw start: set initial point tracking\n    this.inputManager.on('panstart', (event) => {\n      event.pointers.forEach((pointer: PointerEvent) => {\n        const { x, y } = pointer;\n        lastPoints.set(pointer.pointerId, { x, y });\n      });\n    });\n\n    // draw: line from -> to\n    this.inputManager.on('pan', (event) => {\n      event.pointers.forEach((pointer: PointerEvent) => {\n        const { x, y } = pointer;\n        // get last movement\n        const { x: lastX, y: lastY } = lastPoints.get(pointer.pointerId);\n\n        // draw line from last point\n        this.drawLine(lastX, lastY, x, y);\n        // draw circle at current point\n        this.drawPoint(x, y);\n\n        // update last movement\n        lastPoints.set(pointer.pointerId, { x, y });\n      });\n    });\n\n    // draw end: snapshot current canvas\n    this.inputManager.on('panend', () => {\n      lastPoints.clear();\n    });\n  }\n\n  handleResetClick() {\n    this.reset();\n  }\n\n  handleDownloadClick() {\n    // Force changeref detection right away so the UI updates before snapshot\n    this.exporting = true;\n    this.changeRef.detectChanges();\n\n\n    const { width, height } = this.canvasElement;\n    const chapterId = this.store.selectSnapshot(\n      StoryChaptersState.getSelectedChapterId\n    );\n\n    // create snapshot with drawing canvas\n    this.store\n      .dispatch(\n        new TakeChapterPicture(\n          chapterId,\n          exportFormat,\n          exportQuality,\n          { width, height },\n          'original',\n          true,\n          true,\n          [this.annotateElement.nativeElement]\n        )\n      )\n      .pipe(\n        flatMap(() => {\n          return this.actions.pipe(\n            ofActionDispatched(TakeChapterPictureSuccess),\n            take(1)\n          );\n        }),\n        takeUntil(this.ngUnsubscribe),\n        finalize(() => {\n          this.exporting = false;\n          this.changeRef.markForCheck();\n        })\n      )\n      .subscribe((response: TakeChapterPictureSuccess) => {\n        this.downloadSnapshot(response.blob);\n      });\n  }\n\n  handleExitClick() {\n    this.resetCanvas();\n    this.viewService.toggleWhiteboard(false);\n  }\n\n  // draw point\n  private drawPoint(toX: number, toY: number) {\n    const radius = this.brushSize / 2;\n    const angle = 2 * Math.PI;\n    this.canvasContext.beginPath();\n    this.canvasContext.arc(toX, toY, radius, 0, angle);\n    this.canvasContext.fill();\n  }\n\n  // draw line from start to end\n  private drawLine(fromX: number, fromY: number, toX: number, toY: number) {\n    this.canvasContext.beginPath();\n    this.canvasContext.moveTo(fromX, fromY);\n    this.canvasContext.lineTo(toX, toY);\n    this.canvasContext.stroke();\n    this.canvasContext.closePath();\n  }\n\n  private reset() {\n    this.resetCanvas();\n    this.labels = [];\n    this.changeRef.markForCheck();\n  }\n\n  private setBrushSize(brushSize: number) {\n    this.canvasContext.lineWidth = brushSize;\n    this.brushSize = brushSize;\n  }\n\n  private setBrushColor(brushColor: string) {\n    this.canvasContext.fillStyle = brushColor;\n    this.canvasContext.strokeStyle = brushColor;\n  }\n\n  // reset canvas params on state change\n  private syncCanvas() {\n    const brushSize = this.store.selectSnapshot(\n      ViewState.getWhiteboardBrushSize\n    );\n    const brushColor = this.store.selectSnapshot(\n      ViewState.getWhiteboardBrushColor\n    );\n\n    // size canvas sizing\n    const { width, height } = this.getScreenDimensions();\n    this.canvasElement.width = width;\n    this.canvasElement.height = height;\n\n    // set canvas tools\n    this.setBrushSize(brushSize);\n    this.setBrushColor(brushColor);\n    this.canvasContext.lineJoin = 'round';\n  }\n\n  // clear canvas drawing\n  private resetCanvas() {\n    const { width, height } = this.canvasElement;\n    this.canvasContext.clearRect(0, 0, width, height);\n  }\n\n  private downloadSnapshot(blob: Blob) {\n    const { displayName } = this.store.selectSnapshot(StoryState.getStory);\n    const normalizedTitle = (displayName || '')\n      .replace(/ /g, '_')\n      .replace(/\\W/g, '')\n      .toLowerCase();\n    const extension = exportFormat === ImageTypeEnum.PNG ? 'png' : 'jpg';\n    const fileName = `${normalizedTitle}_drawing.${extension}`;\n\n    // download image\n    this.publishService.exportImage(blob, exportFormat, fileName);\n  }\n\n  private getScreenDimensions(): ScreenDimensions {\n    const { innerWidth, innerHeight } = window;\n    return {\n      width: innerWidth,\n      height: innerHeight,\n    };\n  }\n}\n","import { Component, OnInit, ChangeDetectionStrategy, ViewChild, ElementRef, OnDestroy, ChangeDetectorRef, EventEmitter, Output, Input } from '@angular/core';\nimport { Subject, fromEvent } from 'rxjs';\nimport { MediaModel } from 'src/app/story/models/media.model';\nimport { takeUntil, filter } from 'rxjs/operators';\n\n@Component({\n  selector: 'app-view-audio',\n  templateUrl: './view-audio.component.html',\n  styleUrls: ['./view-audio.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class ViewAudioComponent implements OnInit, OnDestroy {\n  // ---------- Child Elements ----------\n  @ViewChild('audioElRef', { static: true}) audioElRef: ElementRef<HTMLAudioElement>;\n\n\n\n  // ---------- Input / Output ----------\n  @Input()\n  set media(value: MediaModel) {\n    if (!value) {\n      return;\n    }\n    this.setMedia(value);\n  }\n  get media(): MediaModel {\n    return this._media;\n  }\n\n  public get playing(): boolean {\n    return this._playing;\n  }\n  public set playing(value: boolean) {\n    if (value === this.playing) {\n      return;\n    }\n\n    this._playing = value;\n    this.playingChange.emit(this.playing);\n  }\n  private _playing: boolean;\n  @Output()\n  playingChange = new EventEmitter<boolean>();\n\n\n  public get ready(): boolean {\n    return this._ready;\n  }\n  public set ready(value: boolean) {\n    if (value === this.ready) {\n      return;\n    }\n\n    this._ready = value;\n    this.readyChange.emit(this.ready);\n  }\n  private _ready: boolean;\n  @Output()\n  readyChange = new EventEmitter<boolean>();\n  \n\n\n  // ---------- Class Variables ----------\n  mediaSupportCache: { [key: string]: CanPlayTypeResult; } = { };\n\n  // audio state\n  time: number;\n  autoPlay: boolean;\n  error: boolean;\n  source = '';\n\n  private _audioEl: HTMLAudioElement;\n  private _media: MediaModel;\n  private ngUnsubscribe = new Subject();\n\n\n\n  // ---------- Lifecyle Events ----------\n  constructor(private changeRef: ChangeDetectorRef) { }\n\n  ngOnInit() {\n    this.initMediaEvents();\n    this.initMediaPlayback();\n  }\n\n  ngOnDestroy() {\n    // cleanup audio\n    this.pause();\n\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n\n\n  // ---------- Class Methods ----------\n  play() {\n    if (this.ready) {\n      this._audioEl.play();\n    }\n  }\n\n  pause() {\n    if (this.ready) {\n      this._audioEl.pause();\n    }\n  }\n\n  private reset() {\n    this.pause();\n\n    this.time = 0;\n    this.playing = false;\n    this.ready = false;\n    this.error = false;\n\n    this.changeRef.markForCheck();\n  }\n\n  private setMedia(media: MediaModel) {\n    this._media = media;\n    this.source = `/content/states/${this.media.data.fullUrl}`;\n    this.initMediaPlayback();\n  }\n  \n  private initMediaPlayback() {\n    // clear existing\n    this.autoPlay = this.playing;\n    this.reset();\n  }\n\n  private initMediaEvents() {\n    // set audio el\n    this._audioEl = this.audioElRef.nativeElement;\n\n    // set initial state\n    this.reset();\n\n    // track ready state\n    fromEvent(this._audioEl, 'loadeddata')\n      .pipe(\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(() => {\n        this.ready = this._audioEl.readyState > 0;\n      });   \n\n    // track playing\n    fromEvent(this._audioEl, 'play')\n      .pipe(\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(() => {\n        this.playing = true;\n        this.changeRef.markForCheck();\n      });\n\n    // track pause\n    fromEvent(this._audioEl, 'pause')\n      .pipe(\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(() => {\n        this.playing = false;\n        this.changeRef.markForCheck();\n      });\n\n    // track time\n    fromEvent(this._audioEl, 'timeupdate')\n      .pipe(\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(() => {\n        this.time = this._audioEl.currentTime;\n      });\n\n    // handle auto-play\n    fromEvent(this._audioEl, 'canplay')\n      .pipe(\n        filter(() => !this.playing && this.autoPlay),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(() => {\n        this.play();\n      });\n\n    // handle errors\n    fromEvent(this._audioEl, 'error')\n      .pipe(\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(() => {\n        this.error = true;\n      });\n  }\n}\n","<nav\n  aria-label=\"Chapters\"\n  role=\"navigation\"\n  class=\"view-chapters\"\n  [hidden]=\"(chapters$ | async)?.length === 1\"\n  #chapterList\n  gaCategory=\"View Chapter List\">\n  <ol>\n    <li \n      gaEvent \n      gaAction=\"Clicked Chapter\"\n      [gaLabel]=\"'Chapter ' + (i + 1) + ' of ' + (chapters$ | async)?.length\"\n      role=\"button\"\n      [attr.aria-label]=\"chapter.info.displayName\"\n      class=\"view-chapters__item\"\n      *ngFor=\"let chapter of (chapters$ | async); let i = index;\"\n      [attr.data-chapter-id]=\"(chapter.id | elementID)\"\n      (click)=\"handleChapterClick(chapter)\"\n      (keyup.enter)=\"handleChapterClick(chapter)\"\n      [ngClass]=\"{\n        'view-chapters__item--viewed': isViewed(chapter.id),\n        'view-chapters__item--selected': chapter.id === (selectedChapterId$ | async)\n      }\"\n      tabindex=\"0\">\n      \n      <div class=\"view-chapters__index\">{{ i + 1 }}.</div>\n      <div class=\"view-chapters__title\">{{ chapter.info.displayName }}</div>\n      <div class=\"view-chapters__thumb\" [defaultImage]=\"defaultImage\" [lazyLoad]=\"getChapterThumb(chapter.id)\"></div>\n    </li>\n  </ol>\n</nav>\n","import {\n  Component,\n  OnInit,\n  OnDestroy,\n  ChangeDetectionStrategy,\n  ViewEncapsulation,\n  Input,\n  ChangeDetectorRef,\n  AfterViewInit,\n  ViewChild,\n  ElementRef\n} from '@angular/core';\nimport { Select, Store } from '@ngxs/store';\nimport { StoryChaptersState } from 'src/app/story/state/chapters/story.chapters.state';\nimport { Observable, Subject, combineLatest } from 'rxjs';\nimport { ChapterModel } from 'src/app/story/models/chapter.model';\nimport { StoryChapterThumbnail } from 'src/app/story/models/story-chapter-thumbnail.model';\nimport { ViewService } from '../../view.service';\nimport { takeUntil, debounceTime, auditTime } from 'rxjs/operators';\nimport { createElementID } from 'src/app/shared/libraries/dom/dom';\n\n@Component({\n  selector: 'app-view-chapters',\n  templateUrl: './view-chapters.component.html',\n  styleUrls: ['./view-chapters.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None\n\n})\nexport class ViewChaptersComponent implements OnInit, OnDestroy, AfterViewInit {\n  // ---------- View Children ----------\n  @ViewChild('chapterList', { static: false })\n  chapterList: ElementRef<HTMLDivElement>;\n\n\n  // ---------- Observables ----------\n  @Select(StoryChaptersState.getStoryChapters)\n  chapters$: Observable<ChapterModel[]>;\n\n  @Select(StoryChaptersState.getSelectedChapterId)\n  selectedChapterId$: Observable<string>;\n\n  @Select(StoryChaptersState.getSelectedChapterIndex)\n  selectedChapterIndex$: Observable<number>;\n\n  @Select(StoryChaptersState.getRegisteredThumbnails)\n  thumbnails$: Observable<Map<string, StoryChapterThumbnail>>;\n\n  @Select(StoryChaptersState.getChaptersViewed)\n  chaptersViewed$: Observable<string[]>;\n\n\n  // ---------- Inputs ----------\n  @Input()\n  defaultImage = '/assets/images/view-chapter-thumbnail-placeholder.png';\n\n  @Input()\n  autoscroll = true;\n\n  // ---------- Class Variables ----------\n  ngUnsubscribe = new Subject();\n  nextChapter: ChapterModel = null;\n\n\n\n  // ---------- Lifecycle ----------\n  constructor(\n    private store: Store,\n    private viewService: ViewService,\n    private changeDetectorRef: ChangeDetectorRef\n  ) { }\n\n  ngOnInit() {\n    this.initChaptersObserver();\n  }\n\n  ngOnDestroy() {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n  ngAfterViewInit() {\n    this.initScrollObserver();\n  }\n\n\n  // ---------- Observers ----------\n  initChaptersObserver() {\n    combineLatest([\n      this.store.select(StoryChaptersState.getStoryChapters),\n      this.store.select(StoryChaptersState.getSelectedChapterIndex)\n    ]).pipe(\n      auditTime(300),\n      takeUntil(this.ngUnsubscribe)\n    ).subscribe(([chapters, index]) => {\n      const nextIndex = index + 1;\n      this.nextChapter = (nextIndex >= chapters.length) ? null : chapters[nextIndex];\n      this.changeDetectorRef.markForCheck();\n    });\n  }\n\n  initScrollObserver() {\n    this.selectedChapterId$.pipe(\n      takeUntil(this.ngUnsubscribe)\n    ).subscribe((chapterId) => {\n      this.scrollChapterIntoView(chapterId);\n    });\n  }\n\n\n\n  // ---------- Interaction ----------\n  handleChapterClick(chapter: ChapterModel) {\n    this.viewService.selectChapter(chapter);\n  }\n\n  handleNextChapterClick() {\n    this.viewService.nextChapter();\n  }\n\n\n  // ---------- Utility ----------\n  getChapterThumb(chapterId: string): string {\n    const thumbnails = this.store.selectSnapshot(StoryChaptersState.getRegisteredThumbnails);\n    const thumbnail = thumbnails.get(chapterId);\n\n    // use snapshot if present, otherwise use small\n    if (!!thumbnail) {\n      return thumbnail.snapshot || thumbnail.urls.small;\n    } else {\n      return '';\n    }\n  }\n\n  scrollChapterIntoView(chapterId: string) {\n    const elementId = createElementID(chapterId);\n    if (!elementId) {\n      return;\n    }\n\n    const target = <HTMLDivElement>this.chapterList.nativeElement.querySelector(`[data-chapter-id=${elementId}]`);\n\n    if (!target || !this.autoscroll) {\n      return;\n    }\n\n    // Manual check to see if the browser support smooth scrolling.\n    // Although Safari supports scrollIntoView, it only has limited support via the boolean operator.\n    // More importantly, the scrolled column jumps position when the mouse hovers over it.\n    // For this reason we're not support Safari until Apple gets their act together.\n    const isSmoothScrollSupported = 'scrollBehavior' in document.documentElement.style;\n    if (isSmoothScrollSupported) {\n      target.scrollIntoView({\n        behavior: 'auto',\n        block: 'nearest'\n      });\n    }\n  }\n    \n\n  isViewed(chapterId: string) {\n    return this.store.selectSnapshot(StoryChaptersState.getChaptersViewed).some(value => value === chapterId);\n  }\n    \n}\n","<div \n  class=\"view-column-toggle\"\n  @show\n  gaEvent\n  gaCategory=\"View Information Panel\"\n  gaAction=\"Clicked Toggle Column\"\n  [gaLabel]=\"isIn ? 'Show' : 'Hide'\"\n  role=\"button\"\n  aria-label=\"Toggle Column\"\n  tabindex=\"0\"\n  matTooltip=\"Toggle Column\"\n  matTooltipPosition=\"right\"\n  (click)=\"handleToggle()\"\n  (keyup.enter)=\"handleToggle()\"\n  *ngIf=\"isVisible()\">\n  <app-icon [icon]=\"isIn ? 'caret-right' : 'caret-left'\"></app-icon>\n</div>","import { Component, OnInit, ViewEncapsulation, ChangeDetectionStrategy, ChangeDetectorRef, OnDestroy } from '@angular/core';\nimport { transition, trigger, style, animate } from '@angular/animations';\nimport { ViewUI } from '../../models/view-ui.enum';\nimport { ViewService } from '../../view.service';\nimport { ViewUIService } from '../../view-ui.service';\nimport { Select } from '@ngxs/store';\nimport { ViewState } from '../../state/view.state';\nimport { Observable, Subject, combineLatest } from 'rxjs';\nimport { LayoutStateModel } from 'src/app/layout/state/layout.state.model';\nimport { takeUntil } from 'rxjs/operators';\nimport { StoryChaptersState } from 'src/app/story/state/chapters/story.chapters.state';\nimport { ChapterModel } from 'src/app/story/models/chapter.model';\nimport { ViewUIModel } from '../../models/view-ui.model';\nimport { ViewUIStatus } from '../../models/view-ui-status.enum';\n\n@Component({\n  selector: 'app-view-column-toggle',\n  templateUrl: './view-column-toggle.component.html',\n  styleUrls: ['./view-column-toggle.component.scss'],\n  encapsulation: ViewEncapsulation.None,\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  animations: [\n    trigger('show', [\n      transition(':enter', [\n        style({ \n          opacity: 0,\n          transform: 'translateX(-32px)'\n        }),\n        animate('300ms ease-in-out', style({ \n          opacity: 1,\n          transform: '*'\n        }))\n      ]),\n      transition(':leave', [\n        animate('300ms ease-in-out', style({ \n          transform: 'translateX(-32px)',\n          opacity: 0 \n        }))\n      ])\n    ])\n  ]\n})\nexport class ViewColumnToggleComponent implements OnInit, OnDestroy {\n  @Select(ViewState.getUI)\n  layout$: Observable<ViewUIModel>;\n\n  @Select(StoryChaptersState.getSelectedChapter)\n  chapter$: Observable<ChapterModel>;\n\n  ngUnsubscribe = new Subject();\n  isIn = false;\n\n  constructor(\n    private viewService: ViewService,\n    private layoutService: ViewUIService,\n    private changeDetectorRef: ChangeDetectorRef\n  ) { }\n\n  ngOnInit() {\n    combineLatest(this.chapter$, this.layout$)\n      .pipe(\n        takeUntil(this.ngUnsubscribe)\n      ).subscribe(([chapter, layout]) => {\n        this.isIn = layout.column.status === ViewUIStatus.Collapse;\n        \n        this.changeDetectorRef.markForCheck();\n      });\n  }\n\n  ngOnDestroy() {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n  isVisible() {\n    return this.layoutService.isVisible(ViewUI.ColumnToggle);\n  }\n\n  handleToggle() {\n    this.viewService.toggleColumn();\n    \n    this.viewService.toggleSearch(false);\n    this.viewService.toggleNodeInfo(false);\n    this.viewService.toggleLabelInfo(false);\n\n    this.changeDetectorRef.markForCheck();\n  }\n\n}\n","<div class=\"view-column-container\" [ngClass]=\"{'view-column-container--header-offset': true }\">\n  <!-- Description -->\n  <app-view-column class=\"view-column-container__inner\" @slideInOut *ngIf=\"isVisible(viewLayout.Column)\">\n    <ng-container view-column-body>\n      <app-view-title></app-view-title>\n      <app-view-content-mode layout=\"column\"></app-view-content-mode>\n    </ng-container>\n  </app-view-column>\n\n  <!-- Search -->\n  <app-view-column class=\"view-column-container__inner\" [unpadded]=\"true\" @slideInOut *ngIf=\"isVisible(viewLayout.Search)\">\n    <app-view-search></app-view-search>\n  </app-view-column>\n\n  <!-- Node Info -->\n  <app-view-column class=\"view-column-container__inner\" @slideInOut *ngIf=\"isVisible(viewLayout.NodeInfo)\">\n    <app-view-node-description layout=\"column\"></app-view-node-description>\n  </app-view-column>\n</div>","import { Component, OnInit, ChangeDetectionStrategy, ViewEncapsulation, OnDestroy, ChangeDetectorRef } from '@angular/core';\nimport { transition, style, animate, trigger } from '@angular/animations';\nimport { ViewService } from 'src/app/view/view.service';\nimport { Store, Select } from '@ngxs/store';\nimport { ViewState } from 'src/app/view/state/view.state';\nimport { Subject, Observable, combineLatest } from 'rxjs';\nimport { takeUntil } from 'rxjs/operators';\nimport { ViewUIService } from 'src/app/view/view-ui.service';\nimport { ViewUI } from 'src/app/view/models/view-ui.enum';\nimport { EnvironmentApplication } from 'src/environments/models/environment-application';\nimport { ChapterModel } from 'src/app/story/models/chapter.model';\nimport { StoryChaptersState } from 'src/app/story/state/chapters/story.chapters.state';\nimport { ViewUIModel } from 'src/app/view/models/view-ui.model';\n\n@Component({\n  selector: 'app-view-column-container',\n  templateUrl: './view-column-container.component.html',\n  styleUrls: ['./view-column-container.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None,\n  animations: [\n    trigger('slideInOut', [\n      transition(':enter', [\n        style({ \n          transform: 'translateX(-320px)'\n        }),\n        animate('300ms ease-in-out', style({ \n          transform: '*'\n        }))\n      ]),\n      transition(':leave', [\n        animate('300ms ease-in-out', style({ \n          transform: 'translateX(-320px)'\n        }))\n      ])\n    ])\n  ]\n\n})\nexport class ViewColumnContainerComponent implements OnInit, OnDestroy {\n  // ---------- Observables ----------\n  @Select(StoryChaptersState.getSelectedChapter)\n  chapter$: Observable<ChapterModel>;\n\n  @Select(ViewState.getUI)\n  layout$: Observable<ViewUIModel>;\n\n\n\n  // ---------- Class Variables ----------\n  ngUnsubscribe = new Subject();\n  viewLayout = ViewUI;\n  application = EnvironmentApplication;\n  \n\n  \n  // ---------- Lifecycle Events ----------\n  constructor(\n    private viewService: ViewService,\n    private layoutService: ViewUIService,\n    private changeDetectorRef: ChangeDetectorRef\n  ) { }\n\n  ngOnInit() {\n    this.initLayoutObserver();\n  }\n  \n  ngOnDestroy() {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n  \n  \n  // ---------- Layout ----------\n  initLayoutObserver() {\n    combineLatest(\n      this.layout$,\n      this.chapter$\n    )\n    .pipe(\n      takeUntil(this.ngUnsubscribe)\n    )\n    .subscribe(() => {\n      this.changeDetectorRef.markForCheck();\n    });\n  }\n\n  isVisible(viewLayout: ViewUI) {\n    return this.layoutService.isVisible(viewLayout);\n  }\n\n  handleSearchClick() {\n    this.viewService.toggleSearch(true);\n  }\n}\n","<div\n  class=\"view-column\"\n  [ngClass]=\"{\n    'view-column--unpadded': unpadded,\n    'view-column--left': placement === 'left',\n    'view-column--right': placement === 'right'\n  }\"\n  #viewColumn>\n  <div class=\"view-column__inner\">\n    <div class=\"view-column__header\" >\n      <ng-content select=\"[view-column-header]\"></ng-content>\n    </div>\n\n    <div class=\"view-column__body\">\n      <ng-content></ng-content>\n    </div>\n  </div>\n</div>","import { Component, OnInit, ElementRef, ViewChild, ViewEncapsulation, ChangeDetectionStrategy, Input } from '@angular/core';\nimport { ViewService } from 'src/app/view/view.service';\n\n@Component({\n  selector: 'app-view-column',\n  templateUrl: './view-column.component.html',\n  styleUrls: ['./view-column.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n  \n})\nexport class ViewColumnComponent implements OnInit {\n  // ---------- Child Elements ----------\n  @ViewChild('viewColumn', {static: false }) viewColumn: ElementRef<HTMLDivElement>;\n  \n  \n  \n  // ---------- Input / Ouput ----------\n  @Input()\n  unpadded = false;\n\n  @Input()\n  placement: 'left' | 'right' = 'left';\n\n\n\n  // ---------- Lifecyle Events ----------\n  constructor(\n  ) { }\n\n  ngOnInit() {\n  }\n  \n}\n","<div class=\"view-content-mode\" gaCategory=\"View Information Panel\">\n  <!-- Description -->\n  <app-view-panel [showHeader]=\"false\" *ngIf=\"isVisible(viewLayout.Description)\" [hidden]=\"!isPopulated\">\n    <app-view-description [(isPopulated)]=\"isPopulated\" [layout]=\"layout\"></app-view-description>\n\n    <!-- Content Blocks -->\n    <div *ngIf=\"(contentBlocks$ | async)?.length > 0\" class=\"mv-4\">\n      <app-content-blocks [contentBlocks]=\"contentBlocks$ | async\">\n      </app-content-blocks>\n    </div>\n\n  </app-view-panel>\n\n  <!-- Legend -->\n  <app-view-panel label=\"Legend\" *ngIf=\"(chapter$ | async)?.legend && (chapter$ | async)?.legend.length > 0 && isVisible(viewLayout.Legend)\">\n    <app-view-legend [legend]=\"(chapter$ | async).legend\"></app-view-legend>\n  </app-view-panel>\n\n  <!-- Labels -->\n  <app-view-panel label=\"Labels\" *ngIf=\"(labels$ | async)?.length && isVisible(viewLayout.LabelList)\">\n\n    <!-- Label actions -->\n    <div actions *ngIf=\"(labels$ | async)?.length > 1\" class=\"flex\">\n      <button\n        gaEvent\n        gaAction=\"Clicked Previous Label\"\n        app-pin-button\n        icon=\"chevron-left\"\n        size=\"small\"\n        buttonType=\"ghost\" \n        matTooltip=\"Previous Label\"\n        (click)=\"handlePrevClick()\">\n      </button>\n\n      <button\n        gaEvent\n        gaAction=\"Clicked Next Label\"\n        app-pin-button\n        icon=\"chevron-right\"\n        size=\"small\"\n        buttonType=\"ghost\" \n        matTooltip=\"Next Label\"\n        (click)=\"handleNextClick()\">\n      </button>\n\n    </div>\n\n    <app-view-labels></app-view-labels>\n  </app-view-panel>\n</div>","import { Component, OnInit, ChangeDetectionStrategy, Input, OnDestroy, ChangeDetectorRef } from '@angular/core';\nimport { ViewService } from '../../view.service';\nimport { Select, Store } from '@ngxs/store';\nimport { StoryChaptersState } from 'src/app/story/state/chapters/story.chapters.state';\nimport { Observable, Subject } from 'rxjs';\nimport { ChapterModel } from 'src/app/story/models/chapter.model';\nimport { StoryLabelsState } from 'src/app/story/state/labels/story.labels.state';\nimport { LabelModel } from 'src/app/story/models/labels/label.model';\nimport { ViewUIService } from '../../view-ui.service';\nimport { ViewUI } from '../../models/view-ui.enum';\nimport { ViewState } from '../../state/view.state';\nimport { takeUntil } from 'rxjs/operators';\nimport { ContentBlock } from 'src/app/content-blocks/models/content-block';\n\n@Component({\n  selector: 'app-view-content-mode',\n  templateUrl: './view-content-mode.component.html',\n  styleUrls: ['./view-content-mode.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class ViewContentModeComponent implements OnInit, OnDestroy {\n  // ---------- Observables ----------\n  @Select(StoryChaptersState.getStoryChapters)\n  chapters$: Observable<ChapterModel[]>;\n\n  @Select(StoryChaptersState.getSelectedChapter)\n  chapter$: Observable<ChapterModel>;\n\n  @Select(StoryChaptersState.getSelectedChapterContentBlocks)\n  contentBlocks$: Observable<ContentBlock>;\n\n  @Select(StoryLabelsState.getChapterLabels)\n  labels$: Observable<LabelModel[]>;\n\n  private ngUnsubscribe = new Subject();\n  \n  \n  // ---------- Input / Output ----------\n  @Input()\n  layout: 'drawer' | 'column' = 'column';\n\n  \n  \n  \n  // ---------- Class Variables ----------\n  viewLayout = ViewUI;\n  \n\n\n  // ---------- Lifecyle Events ----------\n  constructor(\n    private store: Store,\n    private viewService: ViewService,\n    private layoutService: ViewUIService,\n    private changeDetectorRef: ChangeDetectorRef\n  ) { }\n\n  ngOnInit() {\n    this.store\n      .select(ViewState.getUI)\n      .pipe(takeUntil(this.ngUnsubscribe))\n      .subscribe(() => {\n        this.changeDetectorRef.markForCheck();\n      });\n  }\n\n  ngOnDestroy() {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n\n  // ---------- Layout ----------\n  isVisible(layout: ViewUI) {\n    return this.layoutService.isUIVisible(layout);\n  }\n\n  isEnabled(layout: ViewUI) {\n    return this.layoutService.isUIEnabled(layout);\n  }\n  \n  \n  // ---------- Interaction ----------\n  handlePrevClick() {\n    this.selectLabel(-1);\n  }\n\n  handleNextClick() {\n    this.selectLabel(1);\n  }\n\n  selectLabel(increment: number) {\n    const labels = this.store.selectSnapshot(StoryLabelsState.getChapterLabels);\n    const labelCount = labels.length;\n    const selectedLabelId = this.store.selectSnapshot(StoryLabelsState.getSelectedLabelId);\n    const selectedLabelIndex = labels.findIndex((label) => label.id === selectedLabelId);\n    \n    // get next index\n    const nextIndex = selectedLabelIndex !== -1\n      // increment\n      ? selectedLabelIndex + increment\n      // defafult\n      : 0;\n\n    // cycle target index in range\n    const targetLabelIndex = (nextIndex % labelCount + labelCount) % labelCount;\n\n    // get target label\n    const targetLabel = labels[targetLabelIndex];\n    if (targetLabel) {\n      this.viewService.selectLabel(targetLabel, true);\n    }\n  }\n\n}\n","<div\n  class=\"view-description\"\n  [ngClass]=\"{\n    'view-description--layout-column': layout === 'column',\n    'view-description--layout-drawer': layout === 'drawer'\n  }\">\n  <div class=\"view-description__inner\">\n    <article>\n      <div\n        *ngIf=\"chapterDescription\"\n        class=\"view-description__body\">\n        <app-html [markdownText]=\"chapterDescription\"></app-html>\n      </div>\n      \n    </article>\n\n  </div>\n</div>","import { \n  Component,\n  OnInit,\n  Input,\n  ChangeDetectionStrategy,\n  ViewEncapsulation,\n  ViewChild,\n  Output,\n  EventEmitter,\n  OnDestroy,\n  ChangeDetectorRef\n} from '@angular/core';\nimport { Select } from '@ngxs/store';\nimport { StoryChaptersState } from 'src/app/story/state/chapters/story.chapters.state';\nimport { Observable, combineLatest, Subject } from 'rxjs';\nimport { ChapterModel } from 'src/app/story/models/chapter.model';\nimport { ViewService } from '../../view.service';\nimport { MediaModel } from 'src/app/story/models/media.model';\nimport { ViewAudioComponent } from '../view-audio/view-audio.component';\nimport { ViewUIService } from '../../view-ui.service';\nimport { ViewUI } from '../../models/view-ui.enum';\nimport { filter, takeUntil } from 'rxjs/operators';\nimport { environment } from 'src/environments/environment';\nimport { EnvironmentApplication } from 'src/environments/models/environment-application';\nimport { ViewState } from '../../state/view.state';\nimport { ViewUIModel } from '../../models/view-ui.model';\nimport { StoryState } from 'src/app/story/state/story.state';\nimport { StoryModel } from 'src/app/story/models/story.model';\nimport { TextUtils } from 'src/app/shared/libraries/text-utils/text-utils';\nimport { trim } from 'lodash';\nimport { ContentBlock } from 'src/app/content-blocks/models/content-block';\n\n@Component({\n  selector: 'app-view-description',\n  templateUrl: './view-description.component.html',\n  styleUrls: ['./view-description.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None\n})\nexport class ViewDescriptionComponent implements OnInit, OnDestroy {  \n  // ---------- Children ----------\n  @ViewChild('audio', { static: false })\n  audio: ViewAudioComponent;\n\n\n\n  // ---------- Observables ----------\n  @Select(StoryState.getStory)\n  story$: Observable<StoryModel>;\n\n  @Select(StoryChaptersState.getSelectedChapter)\n  chapter$: Observable<ChapterModel>;\n\n  @Select(StoryChaptersState.getSelectedChapterIndex)\n  chapterIndex$: Observable<number>;\n\n  @Select(StoryChaptersState.getChapterCount)\n  chapterCount$: Observable<number>;\n\n  @Select(ViewState.getUI)\n  layout$: Observable<ViewUIModel>;\n\n  \n  // ---------- Class Variables ----------\n  viewLayout = ViewUI;\n  ngUnsubscribe = new Subject();\n  \n  storyTitle = '';\n  chapterTitle = '';\n  chapterDescription = '';\n  chapterAudio: MediaModel = null;\n  \n  // ---------- Input / Output ----------\n  @Input()\n  layout: 'drawer' | 'column' = 'drawer';\n\n  @Input()\n  public get isPopulated() {\n    return this._isPopulated;\n  }\n  public set isPopulated(value) {\n    this._isPopulated = value;\n    this.isPopulatedChange.emit(this.isPopulated);\n  }\n  private _isPopulated = false;\n\n  @Output()\n  isPopulatedChange = new EventEmitter<boolean>();\n  \n\n\n  // ---------- Lifecycle ----------\n  constructor(\n    private viewService: ViewService,\n    private layoutService: ViewUIService,\n    private changeDetectorRef: ChangeDetectorRef\n  ) { }\n\n  ngOnInit() {\n    this.initContentListener();\n    this.initLayoutListener();\n  }\n\n  ngOnDestroy() {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n  isEnabled(layout: ViewUI) {\n    return this.layoutService.isUIEnabled(layout);\n  }\n  \n  \n  \n  // ---------- Listeners ----------\n  initContentListener() {\n    combineLatest(\n      this.story$,\n      this.chapter$\n    ).pipe(\n      filter(([story, chapter]) => story != null && chapter != null),\n      takeUntil(this.ngUnsubscribe)\n    ).subscribe(([story, chapter]) => {\n      // Only populate bookmark in web app\n      this.storyTitle = (environment.application !== EnvironmentApplication.Viewer) ? TextUtils.normalize(story.displayName) : '';\n      this.chapterTitle = TextUtils.normalize(chapter.info.displayName);\n      this.chapterDescription = trim(chapter.info.description) ;\n      \n      this.isPopulated = \n        this.storyTitle !== '' ||\n        !!this.chapterTitle || \n        !!this.chapterDescription;\n    });\n  }\n\n  initLayoutListener() {\n    this.layout$.pipe(\n      takeUntil(this.ngUnsubscribe)\n    ).subscribe((layout) => {\n      this.changeDetectorRef.markForCheck();\n    });\n  }\n\n\n  // ---------- Interaction ----------\n  handlePreviousChapterClick() {\n    this.viewService.previousChapter();\n  }\n\n  handleNextChapterClick() {\n    this.viewService.nextChapter();\n  }\n}\n","<div\n  #viewDrawer\n  class=\"view-drawer\"\n  [ngClass]=\"{\n    'view-drawer--closed': !open,\n    'view-drawer--active': open,\n    'view-drawer--scrollable': open,\n    'view-drawer--fixed': !expandable\n  }\">\n\n  \n  <div\n    class=\"view-drawer__outer\"\n    #viewDrawerOuter\n    [attr.tabindex]=\"open ? 0 : -1\"\n    (keydown)=\"handleDrawerKeydown($event)\"\n    role=\"region\"\n    aria-label=\"Chapter Description\">\n    <div class=\"view-drawer__inner\" [ngSwitch]=\"mode\">\n      <!-- Label Info -->\n      <ng-container *ngSwitchCase=\"viewMode.LabelInfo\">\n        <div class=\"view-drawer__header\" style=\"height: 64px\" (click)=\"handleToggleClick()\">\n          <div class=\"view-drawer__button view-drawer__button--left\" (click)=\"handleLabelBack()\">\n            <app-icon icon=\"arrow-left\"></app-icon>\n          </div>\n      \n          <div class=\"view-drawer__title\">\n            <span class=\"text-semibold text-14\">{{ (selectedLabel$ | async)?.title }}</span>\n          </div>\n      \n          <div class=\"view-drawer__button view-drawer__button--right\">\n            <app-icon *ngIf=\"!open\" icon=\"caret-up\"></app-icon>\n            <app-icon *ngIf=\"open\" icon=\"caret-down\"></app-icon>\n          </div>\n        </div>\n\n        <!-- content blocks -->\n        <div *ngIf=\"(selectedLabel$ | async)?.contentBlocks\" class=\"mv-1\" appEventFence>\n          <app-content-blocks [contentBlocks]=\"(selectedLabel$ | async)?.contentBlocks\" [layout]=\"'compact'\">\n          </app-content-blocks>\n        </div>\n\n        <div class=\"view-drawer__content\">\n          <app-html class=\"text-14\" [markdownText]=\"(selectedLabel$ | async)?.description\">\n          </app-html>\n        </div>\n      </ng-container>\n\n      <!-- Description -->\n      <ng-container *ngSwitchCase=\"viewMode.Content\">\n        <div class=\"view-drawer__header\" style=\"height: 64px\" (click)=\"handleToggleClick()\">\n          <!-- <div class=\"view-drawer__button view-drawer__button--left\">\n            <app-icon icon=\"arrow-left\"></app-icon>\n          </div> -->\n      \n          <app-view-title\n            class=\"view-drawer__title\"\n            [menuEnabled]=\"false\"\n            alignTitle=\"center\" \n            size=\"medium\">\n          </app-view-title>\n      \n          <div class=\"view-drawer__button view-drawer__button--right\" *ngIf=\"expandable\">\n            <app-icon *ngIf=\"!open\" icon=\"caret-up\"></app-icon>\n            <app-icon *ngIf=\"open\" icon=\"caret-down\"></app-icon>\n          </div>\n        </div>\n\n        <div class=\"view-drawer__content\">\n          <app-view-content-mode layout=\"drawer\" *ngIf=\"expandable\"></app-view-content-mode>\n  \n          <app-view-title *ngIf=\"!expandable\" [menuEnabled]=\"false\" alignTitle=\"center\"></app-view-title>\n        </div>\n      </ng-container>\n    </div>\n  </div>\n</div>\n","import { \n  Component,\n  EventEmitter,\n  OnInit,\n  ViewEncapsulation,\n  ViewChild,\n  ChangeDetectionStrategy,\n  AfterViewInit,\n  Output,\n  Renderer2,\n  ChangeDetectorRef,\n  OnDestroy, \n  Input,\n  ElementRef} from '@angular/core';\nimport { Select, Store } from '@ngxs/store';\nimport { Subject, Observable } from 'rxjs';\nimport { takeUntil } from 'rxjs/operators';\nimport { ViewState } from '../../state/view.state';\nimport { ViewMode } from '../../models/view-mode.enum';\nimport { StoryChaptersState } from 'src/app/story/state/chapters/story.chapters.state';\nimport { ViewService } from '../../view.service';\nimport { ViewToolsMode } from '../../models/view-tools-mode.enum';\nimport { ViewUIModel } from '../../models/view-ui.model';\nimport { ViewUIService } from '../../view-ui.service';\nimport { EnvironmentApplication } from 'src/environments/models/environment-application';\nimport { environment } from 'src/environments/environment';\nimport { LayoutState } from 'src/app/layout/state/layout.state';\nimport { SiteHeaderType } from 'src/app/layout/models/site-header-type.enum';\nimport { StoryLabelsState } from 'src/app/story/state/labels/story.labels.state';\nimport { LabelModel } from 'src/app/story/models/labels/label.model';\n\nconst drawerHeight = 64;\nconst halfwayPoint = 0.4;\n\ninterface Breakpoint {\n  velocity: number;\n  point: number;\n}\n\n@Component({\n  selector: 'app-view-drawer',\n  templateUrl: './view-drawer.component.html',\n  styleUrls: ['./view-drawer.component.scss'],\n  encapsulation: ViewEncapsulation.None,\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class ViewDrawerComponent implements OnInit, AfterViewInit, OnDestroy {\n  // ---------- Child Elements ----------\n  @ViewChild('viewDrawer', {static: false }) viewDrawer: any;\n  @ViewChild('viewDrawerOuter', {static: false }) viewDrawerOuter: any;\n\n\n\n  // ---------- Observables ----------\n  @Select(ViewState.getUI)\n  layout$: Observable<ViewUIModel>;\n\n  @Select(StoryChaptersState.getSelectedChapterIndex)\n  chapterIndex$: Observable<number>;\n\n  @Select(StoryChaptersState.getChapterCount)\n  chapterCount$: Observable<number>;\n\n  @Select(StoryLabelsState.getSelectedLabel)\n  selectedLabel$: Observable<LabelModel>;\n\n\n\n  // ---------- Input / Output ----------\n  @Input()\n  public get expandable() {\n    return this.layoutService.getVisibleContent() === 'full' \n      || this.mode === ViewMode.LabelInfo \n      || this.mode === ViewMode.NodeInfo \n      || this.open;\n  }\n\n  @Output() \n  offsetYChange = new EventEmitter<number>();\n\n\n  // ---------- Class Variables ----------\n  drawerY: number;\n\n  breakpoints: { [key: string]: Breakpoint } = {\n    minimumDrawer: {\n      velocity: Infinity,\n      point: 0\n    },\n    halfDrawer: {\n      velocity: 1,\n      point: 0\n    }\n  };\n\n  ngUnsubscribe = new Subject();\n  viewMode = ViewMode;\n  viewToolsMode = ViewToolsMode;\n  mode: ViewMode = ViewMode.Content;\n  open = false;\n\n  \n  // ---------- Lifecycle ----------\n  constructor(\n    private renderer: Renderer2,\n    private changeDetectorRef: ChangeDetectorRef,\n    private viewService: ViewService,\n    private store: Store,\n    private layoutService: ViewUIService\n  ) { }\n\n  ngOnInit() {\n    this.initWindowSizeObserver();\n    this.initLayoutObserver();\n  }\n  \n  ngAfterViewInit() {\n    this.refresh(this.store.selectSnapshot(ViewState.getUI).drawer.isExpandedInitially);\n  }\n\n  ngOnDestroy() {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n  // ---------- Layout ----------\n  initWindowSizeObserver() {\n    this.renderer.listen('window', 'resize', () => {\n      this.refresh(false);\n    });\n  }\n\n  initLayoutObserver() {\n    this.layout$.pipe(\n      takeUntil(this.ngUnsubscribe)\n    ).subscribe(layout => {\n      this.updateMode(layout);\n    });\n  }\n\n  /**\n   * Mobile devices have variable viewheight because the browser bar can scroll in and out of view\n   * This workaround determines the available window space and uses that as a viewheight unit\n   */\n  updateViewHeight() {\n    const includeOffset = environment.application !== EnvironmentApplication.Viewer;\n    const vh = this.viewService.getVH(includeOffset);\n    this.viewDrawer.nativeElement.style.setProperty('--vh', `${vh}px`);\n  }\n\n  updateStops() {\n    const windowHeight = window.innerHeight;\n\n    const siteHeader = this.store.selectSnapshot(LayoutState.getSiteHeader);\n    const topOffset = siteHeader === SiteHeaderType.Hide ? 0 : 56;\n\n    this.breakpoints.minimumDrawer.point = -drawerHeight;\n    this.breakpoints.halfDrawer.point = Math.floor(-((windowHeight - topOffset) * halfwayPoint));\n  }\n\n  updateMode(layout: ViewUIModel) {\n    this.mode = this.viewService.inferDrawerMode(layout);\n    this.changeDetectorRef.markForCheck();\n  }\n\n  resetDrawerPosition(expanded: boolean) {\n    setTimeout(() => {\n      const point = expanded \n        ? this.breakpoints.halfDrawer.point \n        : this.breakpoints.minimumDrawer.point;\n\n      this.slideDrawerToPoint(point);\n    });\n  }\n\n  refresh(expanded) {\n    setTimeout(() => {\n      this.updateViewHeight();\n      this.updateStops();\n      this.resetDrawerPosition(expanded);\n    });\n  }\n\n  \n\n  // ---------- Interaction ----------\n  handleClick() {\n    if (!this.open && this.expandable) {\n      this.toggleDrawer(true);\n    }\n  }\n\n  handleToggleClick() {\n    this.toggleDrawer();\n  }\n\n  handleDrawerKeydown(event: KeyboardEvent) {\n    // Prevent keyboard scrolling on content from trigger camera movement\n    if (event.key === 'ArrowDown' || event.key === 'ArrowUp') {\n      event.stopPropagation();\n    }\n  }\n\n  handleLabelBack() {\n    this.viewService.clearSelectedLabel();\n  }\n\n  // ---------- Utility ----------\n  public toggleDrawer(open?: boolean) {\n    if (open == null) {\n      open = !this.open;\n    }\n\n    const breakpoint = open ? this.breakpoints.halfDrawer : this.breakpoints.minimumDrawer;\n    this.slideDrawerToPoint(breakpoint.point);\n\n    this.open = open;\n\n    this.open ? \n      this.viewDrawerOuter.nativeElement.focus() :\n      this.viewDrawerOuter.nativeElement.blur();\n  }\n\n  slideDrawerToPoint(y: number) {\n    this.renderer.setStyle(this.viewDrawer.nativeElement, 'transform', `translate3d(0, ${y}px, 0)`);\n    this.offsetYChange.emit(y);\n  }\n\n  getDrawerY() {\n    if (this.viewDrawer) {\n      const transform = this.viewService.getComputedTransform(this.viewDrawer.nativeElement);\n      return transform ? transform.y : null;\n    } else {\n      return null;\n    }\n  }\n}\n","<div class=\"view-help\" #viewHelp gaCategory=\"View Help\">\n  <div class=\"view-help__inner\" [ngSwitch]=\"activeTab\">\n    <!-- Close -->\n    <div\n      gaEvent\n      gaAction=\"Clicked Close Help\"\n      class=\"view-help__close\"\n      (click)=\"handleCloseClick()\">\n      <app-icon icon=\"times\"></app-icon>\n    </div>\n\n    <!-- Tabs -->\n    <div class=\"view-help__tabs\">\n      <div\n        gaEvent\n        gaAction=\"Clicked Navigation Basics\"\n        class=\"view-help__tab\"\n        role=\"button\"\n        (click)=\"handleTabClick(helpTypeEnum.Basics)\"\n        [ngClass]=\"{'view-help__tab--active': activeTab === helpTypeEnum.Basics}\">\n        Navigation Basics\n      </div>\n\n      <div\n        gaEvent\n        gaAction=\"Clicked All Controls\"\n        class=\"view-help__tab\"\n        role=\"button\"\n        (click)=\"handleTabClick(helpTypeEnum.All)\"\n        [ngClass]=\"{'view-help__tab--active': activeTab === helpTypeEnum.All}\">\n        All Controls\n      </div>\n\n      <div\n        gaEvent\n        gaAction=\"Clicked Keyboard Shortcuts\"\n        class=\"view-help__tab\"\n        role=\"button\"\n        (click)=\"handleTabClick(helpTypeEnum.Shortcuts)\"\n        [ngClass]=\"{'view-help__tab--active': activeTab === helpTypeEnum.Shortcuts}\">\n        Keyboard Shortcuts\n      </div>\n    </div>\n\n    <!-- Basics -->\n    <ng-container *ngSwitchCase=\"helpTypeEnum.Basics\">\n\n      <!-- Mouse controls -->\n      <div class=\"view-help__group\">\n        <div class=\"view-help__item\">\n          <div class=\"view-help__image\" [style.backgroundImage]=\"'url(assets/images/widget/help-rotate.svg)'\"></div>\n          <div class=\"view-help__label\">Rotate</div>\n          Click and drag or use one finger to change the viewing angle.\n        </div>\n\n        <div class=\"view-help__item\">\n          <div class=\"view-help__image\" [style.backgroundImage]=\"'url(assets/images/widget/help-pan.svg)'\"></div>\n          <div class=\"view-help__label\">Pan</div>\n          Hold the shift key and drag or use two fingers to move the model's position.\n        </div>\n\n        <div class=\"view-help__item\">\n          <div class=\"view-help__image\" [style.backgroundImage]=\"'url(assets/images/widget/help-zoom.svg)'\"></div>\n          <div class=\"view-help__label\">Zoom</div>\n          Scroll up and down or pinch with two fingers to zoom in or out.\n        </div>\n\n        <div class=\"view-help__item\">\n          <div class=\"view-help__image\" [style.backgroundImage]=\"'url(assets/images/widget/help-learn.svg)'\"></div>\n          <div class=\"view-help__label\">Explore the Anatomy</div>\n          Click or tap an anatomic structure or label to learn more.\n        </div>\n      </div>\n    </ng-container>\n\n    <!-- All controls -->\n    <ng-container *ngSwitchCase=\"helpTypeEnum.All\">\n      <!-- Mouse -->\n      <div class=\"view-help__header\">\n        Mouse\n      </div>\n\n      <div class=\"view-help__group\">\n        <div class=\"view-help__item\">\n          <div class=\"view-help__image\" [style.backgroundImage]=\"'url(assets/images/widget/help-mouse-hold-left.svg)'\"></div>\n          Hold left button to rotate\n        </div>\n\n        <div class=\"view-help__item\">\n            <div class=\"view-help__image\" [style.backgroundImage]=\"'url(assets/images/widget/help-mouse-hold-right.svg)'\"></div>\n          Hold right button to pan\n        </div>\n\n        <div class=\"view-help__item\">\n          <div class=\"view-help__image\" [style.backgroundImage]=\"'url(assets/images/widget/help-mouse-single-click-left.svg)'\"></div>\n          Single-click left button to select a structure\n        </div>\n\n        <div class=\"view-help__item\">\n          <div class=\"view-help__image\" [style.backgroundImage]=\"'url(assets/images/widget/help-mouse-double-click-left.svg)'\"></div>\n          Double-click left button to auto-focus on a structure\n        </div>\n\n        <div class=\"view-help__item\">\n          <div class=\"view-help__image\" [style.backgroundImage]=\"'url(assets/images/widget/help-mouse-long-press-left.svg)'\"></div>\n          Long-click to fly to a structure\n        </div>\n      </div>\n\n      <!-- Keyboard -->\n      <div class=\"view-help__header\">\n        Keyboard\n      </div>\n\n      <div class=\"view-help__group\">\n        <div class=\"view-help__item\">\n          <div class=\"view-help__image\" [style.backgroundImage]=\"'url(assets/images/widget/help-keyboard-rotate.svg)'\"></div>\n          Rotate with arrows\n        </div>\n\n        <div class=\"view-help__item\">\n          <div class=\"view-help__image\" [style.backgroundImage]=\"'url(assets/images/widget/help-keyboard-pan.svg)'\"></div>\n          Pan up (W), left (A), down (S), right(D)\n        </div>\n\n        <div class=\"view-help__item\">\n          <div class=\"view-help__image\" [style.backgroundImage]=\"'url(assets/images/widget/help-keyboard-zoom.svg)'\"></div>\n          Zoom out (-, C) and zoom in (+, E)\n        </div>\n\n        <div class=\"view-help__item\">\n          <div class=\"view-help__image\" [style.backgroundImage]=\"'url(assets/images/widget/help-keyboard-slow-motion.svg)'\"></div>\n          Hold with any previous key to slow down motion\n        </div>\n      </div>\n\n      <!-- Trackpad -->\n      <div class=\"view-help__header\">\n        Trackpad\n      </div>\n\n      <div class=\"view-help__group\">\n        <div class=\"view-help__item\">\n          <div class=\"view-help__image\" [style.backgroundImage]=\"'url(assets/images/widget/help-trackpad-single-tap.svg)'\"></div>\n          Single-tap to auto-focus a structure\n        </div>\n\n        <div class=\"view-help__item\">\n          <div class=\"view-help__image\" [style.backgroundImage]=\"'url(assets/images/widget/help-trackpad-double-tap.svg)'\"></div>\n          Double-tap to select a structure\n        </div>\n\n        <div class=\"view-help__item\">\n          <div class=\"view-help__image\" [style.backgroundImage]=\"'url(assets/images/widget/help-trackpad-long-press.svg)'\"></div>\n          Long-press to fly to a structure\n        </div>\n\n        <div class=\"view-help__item\">\n          <div class=\"view-help__image\" [style.backgroundImage]=\"'url(assets/images/widget/help-trackpad-scroll.svg)'\"></div>\n          Scroll up and down to zoom\n        </div>\n      </div>\n\n      <!-- In-App -->\n      <div class=\"view-help__header\">\n        In-App\n      </div>\n\n      <div class=\"view-help__group\">\n        <div class=\"view-help__item\">\n          <app-icon class=\"view-help__icon\" icon=\"plus\"></app-icon>\n          Zoom in\n        </div>\n\n        <div class=\"view-help__item\">\n          <app-icon class=\"view-help__icon\" icon=\"minus\"></app-icon>\n          Zoom out\n        </div>\n\n        <div class=\"view-help__item\">\n          <app-icon class=\"view-help__icon\" icon=\"location\"></app-icon>\n          Recenter 3D model\n        </div>\n\n        <div class=\"view-help__item\">\n          <app-icon class=\"view-help__icon\" icon=\"arrows\"></app-icon>\n          Pan\n        </div>\n      </div>\n    </ng-container>\n\n    <!-- Keyboard Shortcuts -->\n    <ng-container *ngSwitchCase=\"helpTypeEnum.Shortcuts\">\n      <app-view-shortcuts></app-view-shortcuts>\n    </ng-container>\n  </div>\n</div>\n","import { \n  Component,\n  OnInit,\n  ViewChild,\n  ElementRef,\n  Renderer2,\n  AfterViewInit,\n  ChangeDetectionStrategy,\n  ViewEncapsulation,\n  Input,\n  OnDestroy } from '@angular/core';\nimport { ViewService } from '../../view.service';\nimport { Select } from '@ngxs/store';\nimport { ViewState } from '../../state/view.state';\nimport { Observable, Subject } from 'rxjs';\nimport { HelpTypeEnum } from '../../models/help-type.enum';\n\n@Component({\n  selector: 'app-view-help',\n  templateUrl: './view-help.component.html',\n  styleUrls: ['./view-help.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None\n})\nexport class ViewHelpComponent implements OnInit, AfterViewInit, OnDestroy {\n\n  helpTypeEnum = HelpTypeEnum;\n\n  // ---------- Child Elements ----------\n  @ViewChild('viewHelp', { static: true })\n  viewHelp: ElementRef;\n\n\n\n  // ---------- Observables ---------\n  @Select(ViewState.getCanTouch)\n  canTouch$: Observable<boolean>;\n\n\n\n  // ---------- Class Variables ----------\n  @Input()\n  activeTab: HelpTypeEnum = HelpTypeEnum.Basics;\n\n  ngUnsubscribe = new Subject();\n\n\n\n  // ---------- Layout ----------\n  constructor(\n    private renderer: Renderer2,\n    private viewService: ViewService\n  ) { }\n\n  ngOnInit() {\n    this.initWindowSizeObserver();\n  }\n\n  ngAfterViewInit() {\n    this.updateViewHeight();\n  }\n\n  ngOnDestroy() {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n\n  \n  // ---------- Layout ----------\n  initWindowSizeObserver() {\n    this.renderer.listen('window', 'resize', () => {\n      this.updateViewHeight();\n    });\n  }\n\n  // Mobile devices have variable viewheight because the browser bar can scroll in and out of view\n  // This workaround determines the available window space and uses that as a viewheight unit\n  updateViewHeight() {\n    const vh = this.viewService.getVH(false);\n    this.viewHelp.nativeElement.style.setProperty('--vh', `${vh}px`);\n  }\n\n\n\n  // ---------- Interactions ----------\n  handleCloseClick() {\n    this.viewService.toggleHelp(false);\n  }\n\n  handleTabClick(tab: HelpTypeEnum) {\n    this.activeTab = tab;\n  }\n\n}\n","<ul class=\"view-labels\" role=\"complementary\" aria-label=\"Labels\">\n  <li \n    role=\"button\"\n    [attr.aria-label]=\"label.title\"\n    class=\"view-labels__item\"\n    [ngClass]=\"{'view-labels__item--selected': (selectedLabel$ | async)?.id === label.id}\"\n    *ngFor=\"let label of (labels$ | async)\"\n    (click)=\"handleLabelClick(label)\"\n    (keyup.enter)=\"handleLabelClick(label)\"\n    tabindex=\"0\">\n    <div class=\"view-labels__pre\">\n      <div class=\"view-labels__pin\">\n        <app-label-pin [label]=\"label\"></app-label-pin>\n      </div>\n    </div>\n\n    <div class=\"view-labels__body\">\n      <div class=\"view-labels__title html\" [innerHTML]=\"label.title | markdown\"></div>\n    </div>\n  </li>\n</ul>","import { Component, OnInit, ViewEncapsulation, ChangeDetectionStrategy } from '@angular/core';\nimport { Select, Store } from '@ngxs/store';\nimport { StoryLabelsState } from 'src/app/story/state/labels/story.labels.state';\nimport { Observable } from 'rxjs';\nimport { LabelModel } from 'src/app/story/models/labels/label.model';\nimport { ViewService } from '../../view.service';\nimport { LabelPinType } from 'src/app/story/models/labels/label-pin-type.enum';\nimport { LabelSequentialType } from 'src/app/story/models/labels/label-sequential-type.enum';\n\n@Component({\n  selector: 'app-view-labels',\n  templateUrl: './view-labels.component.html',\n  styleUrls: ['./view-labels.component.scss'],\n  encapsulation: ViewEncapsulation.None,\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class ViewLabelsComponent implements OnInit {\n  labelPinType = LabelPinType;\n  labelSequentialtype = LabelSequentialType;\n\n  @Select(StoryLabelsState.getChapterLabels)\n  labels$: Observable<LabelModel[]>;\n\n  @Select(StoryLabelsState.getSelectedLabel)\n  selectedLabel$: Observable<LabelModel>;\n\n\n  constructor(\n    private viewService: ViewService,\n    private store: Store\n  ) { }\n\n  ngOnInit() {\n  }\n\n  getLabelSequence(label: LabelModel) {\n    return this.store.selectSnapshot(StoryLabelsState.getLabelSequence(label)); \n  }\n\n  handleLabelClick(label: LabelModel) {\n    this.viewService.selectLabel(label, true);\n  }\n\n}\n","<div class=\"view-layers-bar\">\n\n  <app-view-layers-slider class=\"view-layers-bar__slider\" [ngClass]=\"{\n    'view-layers-bar__slider--large': isLarge(),\n    'view-layers-bar__slider--small': !isLarge(),\n    'view-layers-bar__slider--disabled': assetsLoading\n  }\"></app-view-layers-slider>\n\n</div>","import { \n  Component, \n  OnInit, \n  OnDestroy, \n  ChangeDetectionStrategy,\n  ChangeDetectorRef\n} from '@angular/core';\n\nimport { Store } from '@ngxs/store';\n\nimport { Subject } from 'rxjs';\nimport { takeUntil } from 'rxjs/operators';\n\nimport { EngineService } from 'src/app/engine/engine.service';\n\nimport { EventsEnum } from 'src/app/engine/models/events.enum';\nimport { LoadProgressModel } from 'src/app/engine/models/load-progress.model';\nimport { Breakpoint } from 'src/app/breakpoint/models/breakpoint.enum';\n\nimport { BreakpointState } from 'src/app/breakpoint/state/breakpoint.state';\n\n@Component({\n  selector: 'app-view-layers-bar',\n  templateUrl: './view-layers-bar.component.html',\n  styleUrls: ['./view-layers-bar.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class ViewLayersBarComponent implements OnInit, OnDestroy {\n\n  private ngUnsubscribe = new Subject();\n\n  assetsLoading = false;\n\n  constructor(\n    private store: Store,\n    private engineService: EngineService,\n    private changeDetectorRef: ChangeDetectorRef\n  ) { }\n\n  ngOnInit() {\n    this.engineService\n    .getEvent(EventsEnum.AssetsLoadProgress)\n    .pipe(\n      takeUntil(this.ngUnsubscribe)\n    ).subscribe((progress: LoadProgressModel) => {\n      this.assetsLoading = progress.requestedAssets !== progress.receivedAssets;\n      this.changeDetectorRef.markForCheck();\n    });\n  }\n\n  ngOnDestroy() {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n  isLarge(): boolean {\n    const breakpoint = this.store.selectSnapshot(BreakpointState.getBreakpoint);\n    return breakpoint >= Breakpoint.Medium;\n  }\n\n}\n","<div class=\"view-layers-slider\" #slider>\n\n  <div class=\"view-layers-slider__track\" (click)=\"handleTrackClick($event)\" #track>\n    <div class=\"view-layers-slider__bar\" #bar></div>\n  </div>\n\n  <div\n    #handle\n    class=\"view-layers-slider__handle\"\n    cdkDrag\n    cdkDragLockAxis=\"x\"\n    cdkDragBoundary=\".view-layers-slider\"\n    [cdkDragFreeDragPosition]=\"dragPosition\"\n    (cdkDragEnded)=\"handleDragEnded()\"\n    (cdkDragMoved)=\"handleDragMoved($event)\"\n    [ngClass]=\"{'view-layers-slider__handle-touch': canTouch$ | async }\"\n    matTooltip=\"{{ currentLayerName }}\"></div>\n\n</div>","import { \n  Component, \n  OnInit, \n  OnDestroy, \n  ViewChild, \n  ElementRef, \n  Renderer2, \n  ChangeDetectionStrategy, \n  ChangeDetectorRef \n} from '@angular/core';\n\nimport { Observable, Subject, combineLatest } from 'rxjs';\nimport { filter, takeUntil, auditTime } from 'rxjs/operators';\n\nimport { Select } from '@ngxs/store';\n\nimport { isNil } from 'lodash';\n\nimport { StoryChaptersState } from 'src/app/story/state/chapters/story.chapters.state';\nimport { ViewState } from '../../state/view.state';\n\nimport { VisibilityLayersService } from 'src/app/story/visibility-layers.service';\n\n@Component({\n  selector: 'app-view-layers-slider',\n  templateUrl: './view-layers-slider.component.html',\n  styleUrls: ['./view-layers-slider.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class ViewLayersSliderComponent implements OnInit, OnDestroy {\n\n  // ---------- Child Elements ----------\n\n  @ViewChild('slider', { static: true})\n  slider: ElementRef;\n\n  @ViewChild('track', { static: true})\n  track: ElementRef;\n\n  @ViewChild('bar', { static: true})\n  bar: ElementRef;\n\n  @ViewChild('handle', { static: true})\n  handle: ElementRef;\n\n  @Select(StoryChaptersState.getSelectedChapterCurrentLayers)\n  selectedChapterCurrentLayers$: Observable<any>;\n\n  @Select(StoryChaptersState.getSelectedChapterCurrentLayersIndex)\n  selectedChapterCurrentLayersIndex$: Observable<any>;\n\n  @Select(StoryChaptersState.getSelectedChapterCurrentLayersPosition)\n  selectedChapterCurrentLayersPosition$: Observable<any>;\n\n  @Select(ViewState.getCanTouch)\n  canTouch$: Observable<boolean>;\n\n  ngUnsubscribe = new Subject();\n\n  private currentLayers = [];\n\n  private fullOffset = 0;\n  private dragMove = new Subject();\n\n  dragPosition = {x: 0, y: 0};\n  currentLayerName = '';\n\n  constructor(\n    private renderer: Renderer2,\n    private visibilityLayersService: VisibilityLayersService,\n    private changeDetectorRef: ChangeDetectorRef\n  ) { }\n\n  ngOnInit() {\n    this.fullOffset = this.track.nativeElement.offsetWidth;\n\n    this.initLayersObserver();\n    this.initIndexPositionObserver();\n    this.initDragMoveObserver();\n  }\n\n  ngOnDestroy() {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n  initLayersObserver () {\n    this.selectedChapterCurrentLayers$.pipe(\n      takeUntil(this.ngUnsubscribe)\n    ).subscribe((currentLayers) => {\n      this.currentLayers = currentLayers;\n    });\n  }\n\n  initIndexPositionObserver () {\n    combineLatest(\n      this.selectedChapterCurrentLayersIndex$,\n      this.selectedChapterCurrentLayersPosition$\n    ).pipe(\n      filter(([currentIndex, currentPosition]) => {\n        return !isNil(currentIndex) && !isNil(currentPosition);\n      }),\n      takeUntil(this.ngUnsubscribe)\n    ).subscribe(([currentIndex, currentPosition]) => {\n\n        this.currentLayerName = this.currentLayers[currentIndex].name;\n\n        const fraction = this.visibilityLayersService.indexPositionToFraction(\n          currentIndex, \n          currentPosition\n        );\n        \n        this.setSliderBar(fraction);\n        this.setSliderHandle(fraction);\n    });\n  }\n\n  initDragMoveObserver () {\n    this.dragMove.pipe(\n      auditTime(20),\n      takeUntil(this.ngUnsubscribe)\n    ).subscribe(() => this.handleAuditedDrag());\n  }\n\n  handleDragEnded() {\n    const fraction = this.calculateHandleFraction();\n    const index = this.visibilityLayersService.fractionToIndex(fraction);\n    const position = this.visibilityLayersService.fractionToPosition(fraction, index);\n\n    this.visibilityLayersService.recordLayerIndexPosition(index, position);\n  }\n\n  handleDragMoved(event: DragEvent) {\n    this.dragMove.next(event);\n  }\n\n  handleAuditedDrag() {\n    const fraction = this.calculateHandleFraction();\n    const index = this.visibilityLayersService.fractionToIndex(fraction);\n    const position = this.visibilityLayersService.fractionToPosition(fraction, index);\n\n    this.currentLayerName = this.currentLayers[index].name;\n\n    // While dragging, synch the scene directly through engine for performance\n    this.visibilityLayersService.synchronizeScene(index, position, false);\n    this.setSliderBar(fraction);\n  }\n\n  handleTrackClick(event: MouseEvent) {\n    const fraction = event.offsetX / this.fullOffset;\n    const index = this.visibilityLayersService.fractionToIndex(fraction);\n    const position = this.visibilityLayersService.fractionToPosition(fraction, index);\n\n    this.visibilityLayersService.recordLayerIndexPosition(index, position);\n  }\n\n  private calculateHandleFraction(): number {\n    const sliderRect = this.slider.nativeElement.getBoundingClientRect();\n    const handleRect = this.handle.nativeElement.getBoundingClientRect();\n    const offset = handleRect.left - sliderRect.left;\n\n    return offset / this.fullOffset;\n  }\n\n  private setSliderBar(fraction: number) {\n    this.renderer.setStyle(this.bar.nativeElement, 'width', `${fraction * 100}%`);\n  }\n\n  private setSliderHandle(fraction: number) {\n    this.dragPosition = {x: fraction * this.fullOffset, y: this.dragPosition.y};\n    this.changeDetectorRef.markForCheck();\n  }\n\n}\n","<ul class=\"view-legend\" aria-label=\"Legend\">\n    <li\n        class=\"view-legend__item\"\n        *ngFor=\"let item of legend\"\n        tabindex=\"0\">\n\n        <div class=\"view-legend__color mh-2\" [style.background-color]=\"getComputedColor(item.colors)\">\n        </div>\n\n        <div class=\"view-legend__content text-14\">\n            <div>{{ item.label }}</div>\n            <div *ngIf=\"item.description\" class=\"mv-2\">{{ item.description }}</div>\n        </div>\n        \n    </li>\n</ul>\n","import { Component, OnInit, ChangeDetectionStrategy, Input, ViewEncapsulation } from '@angular/core';\nimport { ChapterLegendModel } from 'src/app/story/models/chapter-legend.model';\nimport { ColorUtils } from 'src/app/shared/libraries/colors/colors';\n\n@Component({\n  selector: 'app-view-legend',\n  templateUrl: './view-legend.component.html',\n  styleUrls: ['./view-legend.component.scss'],\n  encapsulation: ViewEncapsulation.None,\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class ViewLegendComponent implements OnInit {\n\n  @Input()\n  legend: ChapterLegendModel[];\n\n  constructor() { }\n\n  ngOnInit() {\n  }\n\n  getComputedColor(colors: [number, number, number]) {\n    const hexColor = ColorUtils.rgbToHex(colors, true);\n    return hexColor;\n  }\n\n}\n","<div class=\"view-list-container\">\n    <ng-content></ng-content>\n</div>","import { Component, OnInit, ViewEncapsulation, ChangeDetectionStrategy } from '@angular/core';\n\n@Component({\n  selector: 'app-view-list-container, [app-view-list-container]',\n  templateUrl: './view-list-container.component.html',\n  styleUrls: ['./view-list-container.component.scss'],\n  encapsulation: ViewEncapsulation.None,\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class ViewListContainerComponent implements OnInit {\n\n  constructor() { }\n\n  ngOnInit() {\n  }\n\n}\n","<div \n    class=\"view-list-item\"\n    [ngClass]=\"{'view-list-item--selected': selected}\">\n    <ng-content></ng-content>\n</div>","import { Component, OnInit, ViewEncapsulation, Input, ChangeDetectionStrategy } from '@angular/core';\n\n@Component({\n  selector: 'app-view-list-item, [app-view-list-item]',\n  templateUrl: './view-list-item.component.html',\n  styleUrls: ['./view-list-item.component.scss'],\n  encapsulation: ViewEncapsulation.None,\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class ViewListItemComponent implements OnInit {\n  @Input()\n  selected = false;\n\n  constructor() { }\n\n  ngOnInit() {\n  }\n\n}\n","<div class=\"button-loader\">\n  <div class=\"button-loader__button\">\n    <img class=\"button-loader__3d-arrow\" src=\"assets/images/widget/loading_experience/interact-in-3d-arrow.svg\">\n    <div class=\"button-loader__label\">Interact in 3D</div>\n  </div>\n</div>","import { Component, OnInit, ChangeDetectionStrategy } from '@angular/core';\n\n@Component({\n  selector: 'app-button-loader',\n  templateUrl: './button-loader.component.html',\n  styleUrls: ['./button-loader.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class ButtonLoaderComponent implements OnInit {\n\n  constructor() { }\n\n  ngOnInit() {\n  }\n\n}\n","<div class=\"hand-loader\">\n  <div class=\"hand-loader__container\">\n    <div class=\"hand-loader__circle\"></div>\n    <img class=\"hand-loader__3d-hand\" src=\"assets/images/widget/loading_experience/interact-in-3d-hand.svg\">\n    <div class=\"hand-loader__label\" >Interact in 3D</div>\n  </div>\n</div>\n","import { Component, OnInit, ChangeDetectionStrategy } from '@angular/core';\n\n@Component({\n  selector: 'app-hand-loader',\n  templateUrl: './hand-loader.component.html',\n  styleUrls: ['./hand-loader.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class HandLoaderComponent implements OnInit {\n\n  constructor() { }\n\n  ngOnInit() {\n  }\n\n}\n","<div class=\"play-loader\">\n  <div class=\"play-loader__circle\" #circle>\n    <svg class=\"play-loader__ring\" #progressContainer>\n      <circle #progressCircle class=\"play-loader__ring-inner\"></circle>\n    </svg>\n\n    <app-icon icon=\"play\" class=\"play-loader__icon\"></app-icon>\n    <div class=\"play-loader__label\">3D</div>\n  </div>\n</div>","import { Component, OnInit, ChangeDetectionStrategy, ViewChild, ElementRef, Renderer2, Input, OnDestroy, AfterViewInit } from '@angular/core';\nimport { Subject, fromEvent } from 'rxjs';\nimport { ViewService } from 'src/app/view/view.service';\nimport { Actions } from '@ngxs/store';\nimport { debounceTime, takeUntil } from 'rxjs/operators';\n\n@Component({\n  selector: 'app-play-loader',\n  templateUrl: './play-loader.component.html',\n  styleUrls: ['./play-loader.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class PlayLoaderComponent implements OnInit, OnDestroy, AfterViewInit {\n\n  @ViewChild('circle', { static: true })\n  circleRef: ElementRef<HTMLElement>;\n\n  @ViewChild('progressCircle', { static: true })\n  progressCircleRef: ElementRef<SVGCircleElement>;\n\n  @ViewChild('progressContainer', { static: true })\n  progressContainerRef: ElementRef<SVGCircleElement>;\n\n\n  ngUnsubscribe = new Subject();\n\n\n  // ---------- Inputs ----------\n  @Input()\n  public get percent() {\n    return this._percent;\n  }\n  public set percent(value) {\n    if (value == null) {\n      return;\n    }\n\n    this._percent = value;\n    this.setProgress(this.percent);\n  }\n  private _percent = 0;\n\n\n\n  // ---------- Lifecycle ----------\n  constructor(\n    private renderer: Renderer2\n  ) { }\n\n  ngOnInit() {\n    this.initSizeObserver();\n  }\n\n  ngOnDestroy() {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n  ngAfterViewInit() {\n    this.updateDimensions();\n  }\n\n  // ---------- Class Methods ----------\n  initSizeObserver() {\n    // Listen to view page resize\n    const windowResize$ = fromEvent(window, 'resize');\n    windowResize$\n      .pipe(\n        debounceTime(10),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(() => {\n        this.updateDimensions();\n      });\n  }\n\n  calculateRadius() {\n    return this.getCircleWidth() / 2;\n  }\n\n  getCircleWidth() {\n    return this.circleRef.nativeElement.offsetWidth;\n  }\n\n  getRadius() {\n    return this.progressCircleRef.nativeElement.r.baseVal.value;\n  }\n\n  getCircumference() {\n    const radius = this.getRadius();\n    return radius * 2 * Math.PI;\n  }\n\n  getOffset(percent = 100) {\n    const circumference = this.getCircumference();\n    return circumference - (percent / 100 * circumference);\n  }\n\n  setProgress(percent = 0) {\n    if (percent >= 100) {\n      percent = 100;\n    }\n\n    const circumference = this.getCircumference();\n    const offset = this.getOffset(percent);\n\n    this.renderer.setStyle(this.progressCircleRef.nativeElement, 'strokeDasharray', `${circumference} ${circumference}`);\n    this.renderer.setStyle(this.progressCircleRef.nativeElement, 'strokeDashoffset', `${offset}`);\n  }\n\n  updateDimensions() {\n    const radius = this.calculateRadius();\n\n    this.renderer.setAttribute(this.progressContainerRef.nativeElement, 'width', `${radius * 2}`);\n    this.renderer.setAttribute(this.progressContainerRef.nativeElement, 'height', `${radius * 2}`);\n\n    this.renderer.setAttribute(this.progressCircleRef.nativeElement, 'r', `${radius - 6}`);\n    this.renderer.setAttribute(this.progressCircleRef.nativeElement, 'cx', `${radius}`);\n    this.renderer.setAttribute(this.progressCircleRef.nativeElement, 'cy', `${radius}`);\n\n    const circumference = this.getCircumference();\n\n    this.renderer.setStyle(this.progressCircleRef.nativeElement, 'strokeDasharray', `${circumference} ${circumference}`);\n    this.renderer.setStyle(this.progressCircleRef.nativeElement, 'strokeDashoffset', `${circumference}`);\n\n    setTimeout(() => {\n      this.renderer.setStyle(this.progressCircleRef.nativeElement, 'transition', `stroke-dashoffset 300ms`);\n    });\n  }\n\n\n\n\n\n}\n","<div class=\"view-loader\" (click)=\"handleClick()\" #viewLoader>\n  <ng-content></ng-content>\n</div>","// tslint:disable-next-line: max-line-length\nimport { ChangeDetectionStrategy, Component, OnInit, ViewEncapsulation, ViewChild, AfterViewInit, ElementRef, Renderer2, OnDestroy, Input } from '@angular/core';\nimport { fromEvent, Subject } from 'rxjs';\nimport { ViewService } from '../../view.service';\nimport { Actions, ofActionCompleted, ofActionDispatched } from '@ngxs/store';\nimport { ViewActions } from '../../state/view.actions';\nimport { filter, takeUntil } from 'rxjs/operators';\n\n@Component({\n  selector: 'app-view-loader',\n  templateUrl: './view-loader.component.html',\n  styleUrls: ['./view-loader.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None\n})\nexport class ViewLoaderComponent implements OnDestroy {\n\n\n  constructor(\n    private renderer: Renderer2,\n    private viewService: ViewService,\n    private actions: Actions\n  ) { }\n  // ---------- Child Elements ----------\n  @ViewChild('viewLoader', { static: true })\n  viewLoaderRef: ElementRef<HTMLElement>;\n\n\n  // ---------- Class Variables ----------\n  ngUnsubscribe = new Subject();\n\n\n  // ---------- Class Methods ----------\n  handleClick() {\n    this.renderer.addClass(this.viewLoaderRef.nativeElement, 'view-loader--disappear');\n    setTimeout(() => {\n      this.viewService.toggleInteract(false);\n    }, 250);\n  }\n\n\n  ngOnDestroy() {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n}\n","<ng-container *ngIf=\"(layout$ | async)?.logo.isHyperLink\">\n  <a \n    href=\"https://www.biodigital.com\"\n    target=\"_blank\"\n    class=\"view-logo\"\n    tabindex=\"-1\"\n    title=\"Powered by Biodigital\"\n    [ngClass]=\"{\n      'view-logo--full-color': (logoColor === 'color') && (logoSize === 'full'),\n      'view-logo--full-white': (logoColor === 'white') && (logoSize === 'full'),\n      'view-logo--small-color': (logoColor === 'color') && (logoSize === 'small'),\n      'view-logo--small-white': (logoColor === 'white') && (logoSize === 'small')\n    }\">\n  </a>\n</ng-container>\n\n<ng-container *ngIf=\"!(layout$ | async)?.logo.isHyperLink\">\n  <span \n    class=\"view-logo\"\n    [ngClass]=\"{\n      'view-logo--full-color': (logoColor === 'color') && (logoSize === 'full'),\n      'view-logo--full-white': (logoColor === 'white') && (logoSize === 'full'),\n      'view-logo--small-color': (logoColor === 'color') && (logoSize === 'small'),\n      'view-logo--small-white': (logoColor === 'white') && (logoSize === 'small')\n    }\">\n  </span>\n</ng-container>","import { Component, OnInit, ChangeDetectionStrategy, ViewEncapsulation, OnDestroy, ChangeDetectorRef, Input } from '@angular/core';\nimport { Select } from '@ngxs/store';\nimport { ViewState } from '../../state/view.state';\nimport { Observable, Subject } from 'rxjs';\nimport { ViewUIModel } from '../../models/view-ui.model';\nimport { StoryChaptersState } from 'src/app/story/state/chapters/story.chapters.state';\nimport { BackgroundModel } from 'src/app/engine/models/background.model';\nimport { takeUntil } from 'rxjs/operators';\nimport { ColorUtils } from 'src/app/shared/libraries/colors/colors';\nimport { BreakpointState } from 'src/app/breakpoint/state/breakpoint.state';\nimport { Breakpoint } from 'src/app/breakpoint/models/breakpoint.enum';\n\n@Component({\n  selector: 'app-view-logo',\n  templateUrl: './view-logo.component.html',\n  styleUrls: ['./view-logo.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None\n})\nexport class ViewLogoComponent implements OnInit {\n  @Select(ViewState.getUI)\n  layout$: Observable<ViewUIModel>;\n\n  @Select(StoryChaptersState.getSelectedChapterBackground)\n  background$: Observable<BackgroundModel>;\n\n  @Select(BreakpointState.getBreakpoint)\n  breakpoint$: Observable<Breakpoint>;\n\n  @Input()\n  logoSize: 'small' | 'full' = 'full';\n\n  @Input()\n  logoColor: 'color' | 'white' = 'color';\n\n  isLight = true;\n  breakpoint = Breakpoint;\n  ngUnsubscribe = new Subject();\n  \n  constructor(\n  ) { }\n\n  ngOnInit() {}\n}\n","<div\n  gaCategory=\"View Media Bar\"\n  class=\"view-media-bar\"\n  *ngIf=\"showBar\">\n  \n  <!-- Play / Pause -->\n  <button \n    gaEvent\n    gaAction=\"Clicked Toggle Animation\"\n    [gaLabel]=\"(animationPlaying$ | async) ? 'Pause' : 'Play'\"\n    app-pin-button\n    buttonType=\"ghost\"\n    data-test=\"Play/Pause__small\"\n    *ngIf=\"showPlayPause\"\n    matTooltipPosition=\"above\"\n    [matTooltip]=\"(animationPlaying$ | async) ? 'Pause' : 'Play'\"\n    (click)=\"handlePlayClick()\"\n    [icon]=\"(animationPlaying$ | async) ? 'pause' : 'play'\">\n  </button>\n\n  <!-- Play Chapter from Start -->\n  <button \n    gaEvent\n    gaAction=\"Clicked Play Chapter From Start\"\n    app-pin-button\n    buttonType=\"ghost\"\n    *ngIf=\"showPlayPause\"\n    matTooltipPosition=\"above\"\n    matTooltip=\"Play Chapter from Start\"\n    (click)=\"handlePlayChapterFromStartClick()\"\n    icon=\"step-backward\">\n  </button>\n\n  <!-- Scrubber -->\n  <app-view-scrubber\n    *ngIf=\"showScrubber\"\n    class=\"view-media-bar__scrubber\"\n    data-test=\"Scrub__small\">\n  </app-view-scrubber>\n\n  <!-- Audio -->\n  <button \n    gaEvent\n    gaAction=\"Clicked Toggle Audio\"\n    [gaLabel]=\"(playAudio$ | async) ? 'Mute' : 'Play'\"\n    *ngIf=\"isVisible(viewLayout.Audio)\"\n    (click)=\"handleAudioClick()\"\n    [icon]=\"(playAudio$ | async) ? 'volume' : 'volume-slash'\"\n    [matTooltip]=\"(playAudio$ | async) ? 'Mute Audio' : 'Play Audio'\"\n    app-pin-button\n    buttonType=\"ghost\"\n    class=\"view-tools__item\"\n  ></button>\n\n</div>","import { Component, OnInit, OnDestroy, ViewEncapsulation, ChangeDetectionStrategy, Input } from '@angular/core';\nimport { EngineState } from 'src/app/engine/state/engine.state';\nimport { Observable, Subject } from 'rxjs';\nimport { Select } from '@ngxs/store';\nimport { takeUntil, filter } from 'rxjs/operators';\nimport { AnimationService } from 'src/app/engine/animation.service';\nimport { TimerangeModel } from 'src/app/engine/models/animation/timerange.model';\nimport { StoryChaptersState } from 'src/app/story/state/chapters/story.chapters.state';\nimport { ViewService } from '../../view.service';\nimport { MediaEnum } from 'src/app/story/models/media.enum';\nimport { ViewUI } from '../../models/view-ui.enum';\nimport { ViewUIService } from '../../view-ui.service';\n\n@Component({\n  selector: 'app-view-media-bar',\n  templateUrl: './view-media-bar.component.html',\n  styleUrls: ['./view-media-bar.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None\n})\nexport class ViewMediaBarComponent implements OnInit, OnDestroy {\n  viewLayout = ViewUI;\n\n\n  // ---------- Selectors ----------\n  @Select(EngineState.getAnimationPlaying)\n  animationPlaying$: Observable<boolean>;\n\n  @Select(StoryChaptersState.getSelectedChapterId)\n  selectedChapterId$: Observable<string>;\n  \n  @Select(EngineState.getPlayAudio)\n  playAudio$: Observable<boolean>;\n\n  \n  // ---------- Input / Output ----------  \n  @Input()\n  public get template(): MediaEnum {\n    return this._template;\n  }\n  public set template(value: MediaEnum) {\n    this._template = value;\n    this.updateLayoutProperties(this.template);\n  }\n  private _template: MediaEnum;\n\n  @Input()\n  size: 'small' | 'medium' = 'small';\n  \n\n  \n  // ---------- Class Properties ----------\n  showPlayPause = true;\n  showScrubber = true;\n  showBar = true;\n\n  ngUnsubscribe = new Subject();\n  timerange: TimerangeModel;\n  \n\n  \n  // ---------- Lifecycle ----------\n  constructor(\n    private animationService: AnimationService,\n    private viewService: ViewService,\n    private layoutService: ViewUIService\n  ) { }\n\n  ngOnInit() {\n    this.initChapterListener();\n  }\n\n  ngOnDestroy() {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n  \n\n  \n  // ---------- Event Handling ----------\n  initChapterListener() {\n    this.selectedChapterId$.pipe(\n      filter(chapterId => chapterId != null),\n      takeUntil(this.ngUnsubscribe)\n    ).subscribe((chapterId) => {\n      this.timerange = this.animationService.getChapterLocalTimerange(chapterId);\n    });\n  }\n\n  updateLayoutProperties(controls: MediaEnum) {\n    this.showBar = controls !== MediaEnum.None;\n    this.showScrubber = controls === MediaEnum.Full;\n    this.showPlayPause = controls !== MediaEnum.None;\n  }\n\n  handlePlayClick() {\n    this.viewService.toggleAnimation();\n  }\n\n  handleAudioClick() {\n    this.viewService.toggleAudio();\n  }\n\n  handlePlayChapterFromStartClick() {\n    this.viewService.playChapterFromStart();\n  }\n\n\n  isVisible(layout: ViewUI) {\n    return this.layoutService.isVisible(layout);\n  }\n}\n","<div class=\"view-menu-scrim\" *ngIf=\"menuOpen$ | async\" (click)=\"handleCloseClick()\"></div>\n\n<app-view-column placement=\"right\" @slideInOut *ngIf=\"menuOpen$ | async\" class=\"view-menu-column\">\n    <nav app-view-list-container>\n        <app-view-panel padding=\"dense\" [showHeader]=\"false\">\n            <app-view-logo></app-view-logo>\n        </app-view-panel>\n\n        <app-view-panel padding=\"dense\" [showHeader]=\"false\">\n            <button app-view-list-item (click)=\"handleCloseClick()\">\n                Close\n            </button>\n        </app-view-panel>\n\n        <!-- Openers -->\n        <app-view-panel padding=\"dense\" [showHeader]=\"false\">\n            <button app-view-list-item (click)=\"handleToggleToolbar('tools')\">\n                <app-icon icon=\"pen\" class=\"mr-3\"></app-icon>\n                Open Explore Tools\n            </button>\n\n            <button app-view-list-item (click)=\"handleToggleToolbar('media')\">\n                <app-icon icon=\"play\" class=\"mr-3\"></app-icon>\n                Open Media Controls\n            </button>\n\n            <button app-view-list-item (click)=\"handleSearchClick()\">\n                <app-icon icon=\"search\" class=\"mr-3\"></app-icon>\n                Search Anatomy\n            </button>\n        </app-view-panel>\n\n        <!-- Presentation Modes -->\n        <app-view-panel padding=\"dense\" [showHeader]=\"false\">\n            <button app-view-list-item (click)=\"handleFullscreenClick()\">\n                <app-icon icon=\"expand\" class=\"mr-3\"></app-icon>\n                Enter Fullscreen\n            </button>\n        </app-view-panel>\n\n        <!-- Toggles -->\n        <app-view-panel padding=\"dense\" [showHeader]=\"false\">\n            <button app-view-list-item (click)=\"handleToggleLabelsClick()\">\n                <app-icon icon=\"tag\" class=\"mr-3\"></app-icon>\n                <span class=\"mr-3\">Toggle Labels</span>\n                <span *ngIf=\"showLabels$ | async\" class=\"text-dim\">(On)</span>\n                <span *ngIf=\"!(showLabels$ | async)\" class=\"text-dim\">(Off)</span>\n            </button>\n        </app-view-panel>\n\n        <!-- Help -->\n        <app-view-panel padding=\"dense\" [showHeader]=\"false\">\n            <button \n                app-view-list-item\n                (click)=\"handleTutorialClick()\"\n                [disabled]=\"!(selectedChapterReady$ | async)?.model\">\n                Launch Tutorial\n            </button>\n            <button app-view-list-item (click)=\"handleHelpBasicsClick()\">3D Navigation Basics</button>\n            <button app-view-list-item (click)=\"handleHelpShortcutsClick()\">Keyboard Shortcuts</button>\n        </app-view-panel>\n    </nav>\n</app-view-column>","import { Component, OnInit, Input, ChangeDetectionStrategy } from '@angular/core';\nimport { trigger, transition, style, animate } from '@angular/animations';\nimport { Select, Store } from '@ngxs/store';\nimport { ViewState } from '../../state/view.state';\nimport { Observable } from 'rxjs';\nimport { ViewActions } from '../../state/view.actions';\nimport { ViewService } from '../../view.service';\nimport { Fullscreen } from 'src/app/shared/libraries/fullscreen/fullscreen';\nimport { HelpTypeEnum } from '../../models/help-type.enum';\nimport { ViewUIStatus } from '../../models/view-ui-status.enum';\nimport { EngineState } from 'src/app/engine/state/engine.state';\nimport { StoryChaptersState } from 'src/app/story/state/chapters/story.chapters.state';\nimport { ChapterReadyStateModel } from 'src/app/story/models/chapter-ready-state.model';\n\n@Component({\n  selector: 'app-view-menu-column',\n  templateUrl: './view-menu-column.component.html',\n  styleUrls: ['./view-menu-column.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  animations: [\n    trigger('slideInOut', [\n      transition(':enter', [\n        style({ \n          transform: 'translateX(320px)'\n        }),\n        animate('200ms ease-out', style({ \n          transform: '*'\n        }))\n      ]),\n      transition(':leave', [\n        animate('200ms', style({ \n          transform: 'translateX(320px)'\n        }))\n      ])\n    ])\n  ]\n})\nexport class ViewMenuColumnComponent implements OnInit {\n  \n  @Select(StoryChaptersState.getSelectedChapterReadyState)\n  selectedChapterReady$: Observable<ChapterReadyStateModel>;  \n\n  @Select(ViewState.getMenuOpen)\n  menuOpen$: Observable<boolean>;\n\n  @Select(ViewState.getCanTouch)\n  canTouch$: Observable<boolean>;\n\n  @Select(EngineState.getShowLabels)\n  showLabels$: Observable<boolean>;\n\n  constructor(\n    private store: Store,\n    private viewService: ViewService\n  ) { }\n\n  ngOnInit() {\n  }\n\n  handleCloseClick() {\n    this.store.dispatch(new ViewActions.ToggleMenu(false));\n  }\n\n  handleToggleLabelsClick() {\n    this.viewService.toggleLabels();\n  }\n\n  handleFullscreenClick() {\n    this.handleCloseClick();\n    Fullscreen.toggleFullscreen();\n  }\n\n  handleNewTabClick() {\n    this.handleCloseClick();\n    this.viewService.openInNewTab();\n  }\n\n  handleSearchClick() {\n    this.handleCloseClick();\n    this.viewService.toggleSearch();\n  }\n\n  handleTutorialClick() {\n    this.handleCloseClick();\n    this.viewService.toggleTutorial(true);\n  }\n\n  handleHelpBasicsClick() {\n    this.handleCloseClick();\n    this.viewService.toggleHelp(true, HelpTypeEnum.Basics);\n  }\n\n  handleHelpShortcutsClick() {\n    this.handleCloseClick();\n    this.viewService.toggleHelp(true, HelpTypeEnum.Shortcuts);\n  }\n\n  handleToggleToolbar(bar: 'media' | 'tools' | 'toolbar') {\n    this.handleCloseClick();\n\n    const layout = this.store.selectSnapshot(ViewState.getUI);\n    layout.media.status = ViewUIStatus.Hide;\n    layout.tools.status = ViewUIStatus.Hide;\n    layout.toolbar.status = ViewUIStatus.Hide;\n    layout[bar].status = ViewUIStatus.Show;\n    this.store.dispatch(new ViewActions.SetUI(layout));\n  }\n\n}\n","<button \n    gaEvent\n    gaAction=\"Clicked View Menu\"\n    data-test=\"viewMenu\"\n    [matMenuTriggerFor]=\"viewMenu\"\n    matTooltip=\"Menu\"\n    app-pin-button\n    buttonType=\"secondary\"\n    icon=\"bars\"\n    [fill]=\"true\"\n    style=\"width: 52px; height: 52px\"\n    aria-label=\"View Menu\"\n></button>\n  \n<!-- More Menu -->\n<mat-menu #viewMenu=\"matMenu\" gaCategory=\"View Menu\" class=\"view-menu\">\n  <!-- Search -->\n  <button \n    gaEvent\n    gaAction=\"Clicked Open Search\"\n    *ngIf=\"isEnabled(viewUI.Search)\"\n    mat-menu-item\n    (click)=\"handleSearchClick()\">\n    <app-icon class=\"view-menu__icon\" icon=\"search\"></app-icon>\n    <span class=\"ml-2\">Search</span>\n  </button>\n\n  <!-- Visibility Layers -->\n  <button\n    *ngIf=\"isVisible(viewUI.VisibilityLayers)\"\n    mat-menu-item\n    (click)=\"toggleToolbar('visibilityLayers')\">\n    <app-icon class=\"view-menu__icon\" icon=\"layer-group\"></app-icon>\n    <span class=\"ml-2\">Layers</span>\n  </button>\n\n  <!-- Tools -->\n  <button \n    gaEvent\n    gaAction=\"Clicked Open Explore Tools\"\n    *ngIf=\"isEnabled(viewUI.Tools)\"\n    mat-menu-item\n    (click)=\"toggleToolbar('tools')\">\n    <app-icon class=\"view-menu__icon\" icon=\"mouse-pointer\"></app-icon>\n    <span class=\"ml-2\">Explore</span>\n  </button>\n\n  <!-- Whiteboard -->\n  <button\n    gaEvent\n    gaAction=\"Clicked Open Whiteboard\"\n    *ngIf=\"isEnabled(viewUI.Whiteboard)\"\n    mat-menu-item\n    (click)=\"handleDrawClick()\"\n    [disabled]=\"!(selectedChapterReady$ | async)?.model\">\n    <app-icon class=\"view-menu__icon\" icon=\"signature\"></app-icon> \n    <span class=\"ml-2\">Draw</span>\n  </button>\n\n  <!-- Fullscreen -->\n  <ng-container *ngIf=\"isEnabled(viewUI.Fullscreen)\">\n    <mat-divider></mat-divider>\n\n    <!-- Fullscreen -->\n    <button\n      *ngIf=\"canFullscreen\"\n      mat-menu-item\n      (click)=\"handleFullscreenClick()\">\n      <ng-container *ngIf=\"isFullscreen\">Exit Fullscreen</ng-container>\n      <ng-container *ngIf=\"!isFullscreen\">Enter Fullscreen</ng-container>\n    </button>\n\n    <!-- Open in new tab -->\n    <button\n      *ngIf=\"!canFullscreen\"\n      mat-menu-item\n      (click)=\"handleNewTabClick()\">\n      Open in New Tab\n    </button>\n  </ng-container>\n\n  <button \n    mat-menu-item \n    (click)=\"handleToggleLabelsClick()\">\n      <span class=\"mr-3\">Toggle Labels</span>\n      <span *ngIf=\"showLabels$ | async\" class=\"text-dim\">(On)</span>\n      <span *ngIf=\"!(showLabels$ | async)\" class=\"text-dim\">(Off)</span>\n  </button>\n\n  <mat-divider></mat-divider>\n\n  <!-- Help -->\n  <button\n    mat-menu-item\n    *ngIf=\"isEnabled(viewUI.Help)\"\n    [matMenuTriggerFor]=\"helpMenu\">\n    Help\n  </button>\n\n</mat-menu>\n\n<!-- Help menu -->\n<mat-menu #helpMenu=\"matMenu\" gaCategory=\"View Menu\">\n  <button \n    gaEvent\n    gaAction=\"Clicked Launch Tutorial\"\n    mat-menu-item\n    (click)=\"handleTutorialClick()\"\n    [disabled]=\"!(selectedChapterReady$ | async)?.model\">\n    Launch Tutorial\n  </button>\n\n  <button\n    gaEvent\n    gaAction=\"Clicked 3d Navigation Basics\"\n    mat-menu-item\n    (click)=\"handleHelpBasicsClick()\">3D Navigation Basics</button>\n  \n  <button\n    gaEvent\n    gaAction=\"Clicked Keyboard Shortcuts\"\n    mat-menu-item\n    (click)=\"handleHelpShortcutsClick()\">Keyboard Shortcuts</button>\n</mat-menu>\n\n","import { ChangeDetectorRef, OnDestroy } from '@angular/core';\nimport { ChangeDetectionStrategy, Component, OnInit } from '@angular/core';\nimport { Select } from '@ngxs/store';\nimport { Observable, Subject } from 'rxjs';\nimport { takeUntil } from 'rxjs/operators';\nimport { EngineState } from 'src/app/engine/state/engine.state';\nimport { Fullscreen } from 'src/app/shared/libraries/fullscreen/fullscreen';\nimport { ChapterReadyStateModel } from 'src/app/story/models/chapter-ready-state.model';\nimport { StoryChaptersState } from 'src/app/story/state/chapters/story.chapters.state';\nimport { HelpTypeEnum } from '../../models/help-type.enum';\nimport { ViewUI } from '../../models/view-ui.enum';\nimport { ViewUIService } from '../../view-ui.service';\nimport { ViewService } from '../../view.service';\n\n@Component({\n  selector: 'app-view-menu',\n  templateUrl: './view-menu.component.html',\n  styleUrls: ['./view-menu.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class ViewMenuComponent implements OnInit, OnDestroy {\n  viewUI = ViewUI;\n\n  // ---------- Observables ----------\n  @Select(StoryChaptersState.getSelectedChapterReadyState)\n  selectedChapterReady$: Observable<ChapterReadyStateModel>;\n\n  @Select(EngineState.getShowLabels)\n  showLabels$: Observable<boolean>;\n\n\n  // ---------- Class Variables ----------\n  isFullscreen = false;\n  canFullscreen = false;\n  fullscreen$: Observable<Event>;\n  ngUnsubscribe = new Subject();\n\n  constructor(\n    private viewUIService: ViewUIService,\n    private viewService: ViewService,\n    private changeDetectorRef: ChangeDetectorRef\n  ) { }\n\n  ngOnInit() {\n    this.canFullscreen = Fullscreen.canFullscreen();\n  }\n\n  ngOnDestroy() {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n  initFullscreenListener() {\n    this.fullscreen$ = Fullscreen.onFullscreenChange();\n    this.fullscreen$\n      .pipe(\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(event => {\n        this.isFullscreen = Fullscreen.isFullscreen();\n        this.changeDetectorRef.markForCheck();\n      });\n  }\n\n  handleToggleLabelsClick() {\n    this.viewService.toggleLabels();\n  }\n\n  handleFullscreenClick() {\n    Fullscreen.toggleFullscreen();\n  }\n  \n  handleTutorialClick() {\n    this.viewService.toggleTutorial(true);\n  }\n\n  handleHelpBasicsClick() {\n    this.viewService.toggleHelp(true, HelpTypeEnum.Basics);\n  }\n\n  handleHelpShortcutsClick() {\n    this.viewService.toggleHelp(true, HelpTypeEnum.Shortcuts);\n  }\n\n  handlePresentClick() {\n    this.viewService.togglePresentation();\n  }\n\n  handleNewTabClick() {\n    this.viewService.openInNewTab();\n  }\n\n  handleSearchClick() {\n    this.viewService.toggleSearch();\n  }\n\n  handleDrawClick() {\n    this.viewService.toggleWhiteboard(true);\n  }\n\n  toggleToolbar(bar: 'media' | 'tools' | 'toolbar') {\n    this.viewService.toggleToolbar(bar);\n  }\n\n  isEnabled(layout: ViewUI) {\n    return this.viewUIService.isUIEnabled(layout);\n  }\n\n  isVisible(layout: ViewUI) {\n    return this.viewUIService.isVisible(layout);\n  }\n}\n","<div\n    class=\"view-node-description\"\n    [ngClass]=\"{\n        'view-node-description--layout-column': layout === 'column',\n        'view-node-description--layout-drawer': layout === 'drawer'\n    }\">\n\n    <div class=\"view-node-description__header\">\n        <button app-pin-button\n            size=\"small\"\n            icon=\"arrow-left\"\n            class=\"mr-1 mt-1\"\n            *ngIf=\"showClose\"\n            (click)=\"handleCloseClick()\"></button>\n\n        <!-- Title -->\n        <div class=\"view-node-description__title\">{{ node?.label }}</div>\n    </div>\n\n    <!-- Body -->\n    <div\n        *ngIf=\"!(querying$ | async)\"\n        class=\"view-node-description__body\"\n        [class.text-italic]=\"!node?.description\"\n        [innerHTML]=\"formatHTML((node)?.description || 'No description available')\">\n    </div>\n    \n    <!-- attribution -->\n    <div *ngIf=\"node?.description\" class=\"view-node-description__attribution\">\n        Source: <span class=\"text-italic\">Wikipedia</span>\n    </div>\n\n</div>","import { Component, OnInit, ChangeDetectionStrategy, ChangeDetectorRef, OnDestroy, ViewEncapsulation, Input } from '@angular/core';\nimport { ViewTreeNode } from 'src/app/engine/models/view.tree-node';\nimport { Actions, ofActionCompleted, Select, Store } from '@ngxs/store';\nimport { takeUntil } from 'rxjs/operators';\nimport { Subject, Observable } from 'rxjs';\nimport { EngineNodesState } from 'src/app/engine/state/nodes/engine.nodes.state';\nimport { ViewActions } from '../../state/view.actions';\nimport { ViewState } from '../../state/view.state';\nimport { ViewUIStatus } from '../../models/view-ui-status.enum';\nimport { NodeActions } from 'src/app/engine/state/nodes/engine.nodes.actions';\nimport { EngineState } from 'src/app/engine/state/engine.state';\nimport { QueryNodeInfoSuccess, QueryNodeInfoFailure, SetNodeInfo } from 'src/app/engine/state/engine.actions';\n\n@Component({\n  selector: 'app-view-node-description',\n  templateUrl: './view-node-description.component.html',\n  styleUrls: ['./view-node-description.component.scss'],\n  encapsulation: ViewEncapsulation.None,\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class ViewNodeDescriptionComponent implements OnInit, OnDestroy {\n  // ---------- Observables ----------\n\n\n  @Select(EngineState.getQuerying)\n  querying$: Observable<boolean>;\n\n\n\n\n\n\n  // ---------- Input / Output ----------\n  @Input()\n  layout: 'drawer' | 'column' = 'drawer';\n\n  @Input()\n  showClose = true;\n\n\n  isOpen = false;\n\n  node: ViewTreeNode;\n\n\n  // ---------- Class Variables ----------\n  private ngUnsubscribe = new Subject();\n\n  \n\n  // ---------- Lifecycle ----------\n  constructor(\n    private store: Store,\n    private actions: Actions, \n    private changeRef: ChangeDetectorRef\n  ) { }\n\n  ngOnInit() {\n    this.initInfoListeners();\n\n    this.store.select(EngineNodesState.getSelectedNode).pipe(\n      takeUntil(this.ngUnsubscribe)\n    ).subscribe(node => {\n      if (node !== undefined) {\n        this.node = this.store.selectSnapshot(EngineState.getViewGraphNode)(node.objectId);\n      }\n    });\n  }\n\n  ngOnDestroy() {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n  // ---------- Interaction ----------\n  handleHideClick(node: ViewTreeNode) {\n    this.store.dispatch(new NodeActions.UpdateNodesShown(\n      false,\n      [node.id]\n    ));\n  }\n\n  handleCloseClick() {\n    const layout = this.store.selectSnapshot(ViewState.getUI);\n    layout.nodeInfo.status = ViewUIStatus.Hide;\n    this.store.dispatch(new ViewActions.SetUI(layout));\n  }\n\n\n\n  // ---------- Methods ----------\n  initInfoListeners() {\n    // mark \"dirty\" check for node updates\n    this.actions\n      .pipe(\n        ofActionCompleted(\n          QueryNodeInfoSuccess,\n          QueryNodeInfoFailure,\n          SetNodeInfo\n        ),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(() => {\n        this.isOpen = true;\n        this.changeRef.markForCheck();\n      });\n  }\n\n  formatHTML(text: string): string {\n    return text\n      .trim()\n      .replace(new RegExp('\\r?\\n', 'g'), '<br><br>');\n  }\n}\n","<div\n  class=\"view-panel\"\n  [ngClass]=\"{\n    'view-panel--padding-none': padding === 'none',\n    'view-panel--padding-dense': padding === 'dense'\n  }\"\n  >\n  <div class=\"view-panel__header\" *ngIf=\"showHeader\">\n    <div class=\"view-panel__label\">\n      {{ label }}\n    </div>\n    <ng-content class=\"view-panel__actions\" select=\"[actions]\" actions></ng-content>\n  </div>\n  \n  <ng-content></ng-content>\n</div>","import { Component, OnInit, Input, ChangeDetectionStrategy, ViewEncapsulation } from '@angular/core';\n\n@Component({\n  selector: 'app-view-panel',\n  templateUrl: './view-panel.component.html',\n  styleUrls: ['./view-panel.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None\n})\nexport class ViewPanelComponent implements OnInit {\n  @Input()\n  label = '';\n\n  @Input()\n  showHeader = true;\n\n  @Input()\n  padding: 'none' | 'dense' | 'normal' = 'normal';\n\n  constructor() { }\n\n  ngOnInit() {\n  }\n\n}\n","<div class=\"view-print\">\n  <!-- Single white pixel for background scrim -->\n  <img class=\"view-print__scrim\" src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=\">\n\n  <!-- Actual Image -->\n  <img [src]=\"imageUrl\" class=\"view-print__image\">\n</div>","import { Component, OnInit, OnDestroy, ChangeDetectionStrategy, ChangeDetectorRef, HostListener } from '@angular/core';\nimport { Select, Store } from '@ngxs/store';\nimport { StoryChaptersState } from 'src/app/story/state/chapters/story.chapters.state';\nimport { Observable, Subject, combineLatest } from 'rxjs';\nimport { ChapterModel } from 'src/app/story/models/chapter.model';\nimport { takeUntil, filter, map, distinctUntilChanged } from 'rxjs/operators';\n\n@Component({\n  selector: 'app-view-print',\n  templateUrl: './view-print.component.html',\n  styleUrls: ['./view-print.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class ViewPrintComponent implements OnInit, OnDestroy {\n  // ---------- Selectors ----------\n  @Select(StoryChaptersState.getStoryChapters)\n  storyChapters$: Observable<ChapterModel[]>;\n\n\n  // ---------- Properties ----------\n  ngUnsubscribe = new Subject();\n  imageUrl: string;\n  visible = false;\n  \n  \n  // ---------- Host Listeners ----------\n  @HostListener('window:beforeprint')\n  beforePrint(event: any) {\n    this.visible = true;\n    this.changeDetectorRef.markForCheck();\n  }\n\n  @HostListener('window:afterprint')\n  afterPrint(event: any) {\n    this.visible = false;\n    this.changeDetectorRef.markForCheck();\n  }\n  \n  // ---------- Lifecycle ----------\n  constructor(\n    private store: Store,\n    private changeDetectorRef: ChangeDetectorRef\n  ) { }\n\n  ngOnInit() {\n    this.initImageUrlListener();\n  }\n\n  ngOnDestroy() {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n  \n  \n  // ---------- Listeners ----------\n  initImageUrlListener() {\n    combineLatest(\n      this.storyChapters$,\n      this.store.select(StoryChaptersState.getRegisteredThumbnails)\n    )\n    .pipe(\n      filter(([chapters, thumbnails]) => chapters.length > 0 && thumbnails.size > 0),\n      map(([chapters, thumbnails]) => thumbnails.get(chapters[0].id).urls.large),\n      distinctUntilChanged(),\n      takeUntil(this.ngUnsubscribe)\n    )\n    .subscribe(imageUrl => {\n      this.imageUrl = imageUrl;\n      this.changeDetectorRef.markForCheck();\n    });\n  }\n\n}\n","<div class=\"view-progress\" [ngClass]=\"{'view-progress--active': show}\">\n  <div class=\"view-progress__circle\" #circle [@isOpen]=\"show ? 'open' : 'closed'\">\n    <svg \n        class=\"view-progress__ring\" \n        #progressContainer \n        [ngClass]=\"{\n            'view-progress__ring--pulse': percent === 0 || percent === 100\n        }\">\n      <circle #progressCircle class=\"view-progress__ring-inner\"></circle>\n    </svg>\n\n    <div class=\"view-progress__count\" *ngIf=\"percent > 0 && percent < 100\">\n      {{ percent }}%\n    </div>\n    <div class=\"view-progress__label\">\n      {{ label }}\n    </div>\n  </div>\n</div>\n","import { Component,\n  OnInit,\n  ViewChild,\n  ElementRef,\n  Input,\n  Renderer2,\n  OnDestroy,\n  AfterViewInit,\n  ChangeDetectionStrategy,\n  ViewEncapsulation, \n  ChangeDetectorRef} from '@angular/core';\nimport { Subject, fromEvent, BehaviorSubject } from 'rxjs';\nimport { debounceTime, takeUntil } from 'rxjs/operators';\nimport { trigger, transition, sequence, style, animate, state } from '@angular/animations';\n\n@Component({\n  selector: 'app-view-progress',\n  templateUrl: './view-progress.component.html',\n  styleUrls: ['./view-progress.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  animations: [\n    trigger('isOpen', [\n      state('open', style({\n        transform: 'scale(1)'\n      })),\n      state('closed', style({\n        transform: 'scale(0)'\n      })),\n      transition('closed => open', [\n        animate('300ms ease-out')\n      ]),\n      transition('open => closed', [\n        animate('150ms ease-in')\n      ])\n    ])\n  ]\n})\nexport class ViewProgressComponent implements OnInit, OnDestroy, AfterViewInit {\n\n  @ViewChild('circle', { static: true })\n  circleRef: ElementRef<HTMLElement>;\n\n  @ViewChild('progressCircle', { static: true })\n  progressCircleRef: ElementRef<SVGCircleElement>;\n\n  @ViewChild('progressContainer', { static: true })\n  progressContainerRef: ElementRef<SVGCircleElement>;\n\n  ngUnsubscribe = new Subject();\n  label = 'Loading...';\n\n\n  // ---------- Inputs ----------\n  @Input()\n  public get show() {\n    return this._show;\n  }\n  public set show(value) {\n    setTimeout(() => {\n      this._show = value;\n      this.changeDetectorRef.markForCheck();\n    });\n  }\n  private _show = false;\n\n  @Input()\n  public get percent() {\n    return Math.floor(this._percent.value);\n  }\n  public set percent(value) {\n    if (value == null) {\n      return;\n    }\n\n    this._percent.next(value);\n  }\n  private _percent = new BehaviorSubject<number>(0);\n\n\n\n  // ---------- Lifecycle ----------\n  constructor(\n    private renderer: Renderer2,\n    private changeDetectorRef: ChangeDetectorRef\n  ) { }\n\n  ngOnInit() {\n    this.initSizeObserver();\n  }\n\n  ngOnDestroy() {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n  ngAfterViewInit() {\n    this.updateDimensions();\n    this.initPercentObserver();\n  }\n\n  // ---------- Class Methods ----------\n  initPercentObserver() {\n    this._percent.pipe(\n      takeUntil(this.ngUnsubscribe)\n    ).subscribe(() => {\n      this.label = this.getLoadingLabel(this.percent);\n      \n      // When percent is zero, render a full circle. Otherwise render the percentage. \n      this.renderProgress(this.percent === 0 ? 100 : this.percent);\n      \n      this.changeDetectorRef.markForCheck();\n    });\n  }\n\n  initSizeObserver() {\n    // Listen to view page resize\n    const windowResize$ = fromEvent(window, 'resize');\n    windowResize$\n      .pipe(\n        debounceTime(10),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(() => {\n        this.updateDimensions();\n      });\n  }\n\n  calculateRadius() {\n    return this.getCircleWidth() / 2;\n  }\n\n  getCircleWidth() {\n    return this.circleRef.nativeElement.offsetWidth;\n  }\n\n  getRadius() {\n    return this.progressCircleRef.nativeElement.r.baseVal.value;\n  }\n\n  getCircumference() {\n    const radius = this.getRadius();\n    return radius * 2 * Math.PI;\n  }\n\n  getOffset(percent = 100) {\n    const circumference = this.getCircumference();\n    return circumference - (percent / 100 * circumference);\n  }\n\n  renderProgress(percent: number) {\n    if (percent >= 100) {\n      percent = 100;\n    }\n\n    const circumference = this.getCircumference();\n    const offset = this.getOffset(percent);\n\n    this.renderer.setStyle(this.progressCircleRef.nativeElement, 'strokeDasharray', `${circumference} ${circumference}`);\n    this.renderer.setStyle(this.progressCircleRef.nativeElement, 'strokeDashoffset', `${offset}`);\n  }\n\n  getLoadingLabel(percent: number): string {\n    if (percent === 100) {\n      return 'Launching...';\n    }\n\n    if (percent > 0) {\n      return 'Loading...';\n    }\n\n    return 'Loading...';\n  }\n\n  updateDimensions() {\n    const radius = this.calculateRadius();\n\n    this.renderer.setAttribute(this.progressContainerRef.nativeElement, 'width', `${radius * 2}`);\n    this.renderer.setAttribute(this.progressContainerRef.nativeElement, 'height', `${radius * 2}`);\n\n    this.renderer.setAttribute(this.progressCircleRef.nativeElement, 'r', `${radius - 6}`);\n    this.renderer.setAttribute(this.progressCircleRef.nativeElement, 'cx', `${radius}`);\n    this.renderer.setAttribute(this.progressCircleRef.nativeElement, 'cy', `${radius}`);\n\n    const circumference = this.getCircumference();\n\n    this.renderer.setStyle(this.progressCircleRef.nativeElement, 'strokeDasharray', `${circumference} ${circumference}`);\n    this.renderer.setStyle(this.progressCircleRef.nativeElement, 'strokeDashoffset', `${circumference}`);\n  }\n\n\n}\n","<div\n    class=\"view-rounded-button\"\n    [class.view-rounded-button--outline]=\"buttonType === 'outline'\"\n    [class.view-rounded-button--solid]=\"buttonType === 'solid'\"\n    [class.view-rounded-button--shadow]=\"shadow\"\n    [class.view-rounded-button--compact]=\"compact\"\n    [class.view-rounded-button--reverse]=\"iconPlacement === 'right'\">\n\n    <app-icon class=\"view-rounded-button__icon mh-1\" [icon]=\"icon\" *ngIf=\"icon\"></app-icon>\n\n    <div class=\"view-rounded-button__label mh-1\">{{ label }}</div>\n\n</div>\n","// tslint:disable:component-selector\nimport { Component, OnInit, ChangeDetectionStrategy, ViewEncapsulation, Input } from '@angular/core';\n\n@Component({\n  selector: 'button[app-view-rounded-button]',\n  templateUrl: './view-rounded-button.component.html',\n  styleUrls: ['./view-rounded-button.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None\n})\nexport class ViewRoundedButtonComponent implements OnInit {\n\n  @Input()\n  icon: string;\n\n  @Input()\n  iconPlacement: 'left' | 'right' = 'left';\n\n  @Input()\n  label: string;\n\n  @Input()\n  compact = false;\n\n  @Input()\n  buttonType: 'outline' | 'solid' = 'outline';\n\n  @Input()\n  shadow: boolean;\n\n  constructor() { }\n\n  ngOnInit() {\n  }\n\n}\n","<div \n  gaCategory=\"View Media Bar\"\n  class=\"view-scrubber\" \n  [ngClass]=\"{'view-scrubber--draggable': showHandle}\"\n  #scrubber>\n  <div class=\"view-scrubber__track\" #track>\n    <div class=\"view-scrubber__bar\" #bar></div>\n  </div>\n\n  <div \n    gaEvent\n    gaAction=\"Clicked Scrubber\"\n    #handle\n    class=\"view-scrubber__handle\" \n    cdkDrag \n    cdkDragLockAxis=\"x\"\n    cdkDragBoundary=\".view-scrubber\"\n    [cdkDragFreeDragPosition]=\"dragPosition\"\n    (cdkDragMoved)=\"handleDragMoved($event)\"\n    [ngClass]=\"{'view-scrubber__handle--hide': !showHandle, 'view-scrubber__handle-touch': canTouch$ | async }\"></div>\n</div>","import {\n  Component,\n  OnInit,\n  ViewChild,\n  ElementRef,\n  ChangeDetectorRef,\n  Renderer2,\n  OnDestroy,\n  ChangeDetectionStrategy,\n  ViewEncapsulation,\n  Input\n} from '@angular/core';\nimport { Select, Store } from '@ngxs/store';\nimport { EngineState } from 'src/app/engine/state/engine.state';\nimport { Observable, Subject } from 'rxjs';\nimport { StoryChaptersState } from 'src/app/story/state/chapters/story.chapters.state';\nimport { TimerangeModel } from 'src/app/engine/models/animation/timerange.model';\nimport { EngineService } from 'src/app/engine/engine.service';\nimport { AnimationService } from 'src/app/engine/animation.service';\nimport { ViewService } from '../../view.service';\nimport { filter, takeUntil, throttleTime, auditTime } from 'rxjs/operators';\nimport { EventsEnum } from 'src/app/engine/models/events.enum';\nimport { CdkDragMove } from '@angular/cdk/drag-drop';\nimport { ViewState } from '../../state/view.state';\n\n@Component({\n  selector: 'app-view-scrubber',\n  templateUrl: './view-scrubber.component.html',\n  styleUrls: ['./view-scrubber.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None\n})\nexport class ViewScrubberComponent implements OnInit, OnDestroy {\n  // ---------- Child Elements ----------\n  @ViewChild('scrubber', { static: true})\n  scrubber: ElementRef;\n\n  @ViewChild('track', { static: true})\n  track: ElementRef;\n\n  @ViewChild('bar', { static: true})\n  bar: ElementRef;\n\n  @ViewChild('handle', { static: true})\n  handle: ElementRef;\n\n\n\n  // ---------- Observables ----------\n  @Select(EngineState.getAnimationPlaying)\n  animationPlaying$: Observable<boolean>;\n\n  @Select(StoryChaptersState.getSelectedChapterId)\n  selectedChapterId$: Observable<string>;\n\n  @Select(ViewState.getCanTouch)\n  canTouch$: Observable<boolean>;\n\n\n  // ---------- Inputs ----------\n  @Input()\n  showHandle = true;\n\n\n\n  // ---------- Class Variables ----------\n  ngUnsubscribe = new Subject();\n  timerange: TimerangeModel;\n  trackWidth = 0;\n  dragPosition = {x: 16, y: 0};\n  dragMove = new Subject();\n\n\n\n  // ---------- Lifecycle Hooks ----------\n  constructor(\n    private engineService: EngineService,\n    private animationService: AnimationService,\n    private renderer: Renderer2,\n    private viewService: ViewService,\n    private changeDetectorRef: ChangeDetectorRef,\n    private store: Store\n  ) { }\n\n  ngOnInit() {\n    this.initChapterListener();\n    this.initTimelineListener(); \n    this.initDragListener();\n  }\n\n  ngOnDestroy() {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n\n\n  // ---------- Listeners ----------\n  initChapterListener() {\n    this.selectedChapterId$.pipe(\n      filter(chapterId => chapterId != null),\n      takeUntil(this.ngUnsubscribe)\n    ).subscribe((chapterId) => {\n      this.timerange = this.animationService.getChapterLocalTimerange(chapterId);\n    });\n  }\n\n  initTimelineListener() {\n    // Listen to timeline ticks\n    this.engineService.getEvent(EventsEnum.TimelinePlaying)\n      .pipe(\n        throttleTime(20),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(event => this.tick(event.time));\n\n    // listen for timeline scrub\n    this.engineService.getEvent(EventsEnum.TimelineScrubbed)\n      .pipe(\n        throttleTime(20),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe((event) => {\n        // manually set scrubber UI\n        const scrubPercent = this.calcScrubbedPercent(event.time);\n        this.setScrubberBar(scrubPercent);\n      });\n  }\n\n  initDragListener() {\n    this.dragMove.pipe(\n      auditTime(20),\n      takeUntil(this.ngUnsubscribe)\n    ).subscribe((event: CdkDragMove) => {\n      const percent = this.calculateHandlePercent();\n      this.scrubToPercent(percent);\n    });\n  }\n\n\n\n\n  // ---------- Class Methods ----------\n  handleDragMoved(event) {\n    this.dragMove.next(event);\n  }\n\n\n  tick(time: number) {\n    if (!this.timerange) {\n      return;\n    }\n\n    const scrubPercent = this.calcScrubbedPercent(time);\n    this.setScrubberBar(scrubPercent);\n\n    if (this.trackWidth === 0) {\n      this.trackWidth = this.track.nativeElement.offsetWidth;\n    }\n\n    if (this.showHandle) {\n      this.dragPosition = {\n        ...this.dragPosition,\n        x: 16 + this.trackWidth * (scrubPercent / 100)\n      };\n\n      this.changeDetectorRef.markForCheck();\n    }\n  }\n\n  calculateHandlePercent() {\n    const { left, right } = this.scrubber.nativeElement.getBoundingClientRect();\n    const offsetWidth = this.handle.nativeElement.offsetWidth;\n    const adjustedWidth = right - left - offsetWidth; // Account for padding\n    const handleLeft = this.handle.nativeElement.getBoundingClientRect().left;\n   \n    const percent = (handleLeft - left) / adjustedWidth * 100;\n    const normalizedPercent = Math.min(Math.max(percent, 0), 100); // clamp value to range: 0 - 100\n    return normalizedPercent;\n  }\n\n  scrubToPercent(percent: number) {\n    const localTime = (percent / 100) * this.timerange.lastTime;\n\n    const which = (percent === 0) ? 'second' : 'first';\n\n    const activeChapterId = this.store.selectSnapshot(StoryChaptersState.getSelectedChapterId);\n    const globalTime = this.animationService.mapLocalTimeToGlobal(activeChapterId, localTime);\n    \n    this.animationService.scrub({time: globalTime, which});\n  }\n\n  handlePlayClick() {\n    this.viewService.toggleAnimation();\n  }\n\n  private setScrubberBar(percent: number) {\n    this.renderer.setStyle(this.bar.nativeElement, 'width', `${percent}%`);\n  }\n\n  private calcScrubbedPercent(time: number): number {\n    const { firstTime, lastTime } = this.timerange;\n    const localTime = this.animationService.mapGlobalTimeToLocal(time).time;\n\n    // keep time in range\n    const normalizedTime = Math.max(firstTime, Math.min(localTime, lastTime));\n    const scrubPercent = Math.round((normalizedTime / lastTime) * 100);\n\n    return scrubPercent;\n  }\n}\n","<div class=\"view-search\" gaCategory=\"View Search\">\n    <div class=\"view-search__header\">\n        <!-- Search Header -->\n        <div class=\"view-search__actions-row\">\n            \n            <div class=\"view-search__actions\">\n                <button\n                    gaEvent\n                    gaAction=\"Clicked Anatomy Tree\"\n                    type=\"button\"\n                    class=\"view-search__action\"\n                    (click)=\"handleTreeButtonClick()\"\n                    [ngClass]=\"{'view-search__action--selected': (searchDisplayMode$ | async) === treeSearchDisplayMode.Tree}\"\n                    [matTooltip]=\"'Switch to Anatomy Tree'\"\n                    aria-label=\"Switch to Anatomy Tree\">\n                        <app-icon\n                            class=\"view-search__action-icon\"\n                            aria-hidden=\"true\"\n                            [icon]=\"'sitemap'\">\n                        </app-icon>Tree\n                </button>\n\n                <button\n                    gaEvent\n                    gaAction=\"Clicked Anatomy List\"\n                    type=\"button\"\n                    class=\"view-search__action\"\n                    (click)=\"handleListButtonClick()\"\n                    [ngClass]=\"{'view-search__action--selected': (searchDisplayMode$ | async) === treeSearchDisplayMode.List}\"\n                    [matTooltip]=\"'Switch to Anatomy List'\"\n                    aria-label=\"Switch to Anatomy List\">\n                        <app-icon\n                        class=\"view-search__action-icon\"\n                        aria-hidden=\"true\"\n                        [icon]=\"'list'\">\n                        </app-icon>List\n                </button>\n            </div>\n\n            <!-- Exit -->\n            <button\n                gaEvent\n                gaAction=\"Clicked Exit\"\n                type=\"button\"\n                class=\"view-search__exit\"\n                (click)=\"handleExitClick()\"\n                matTooltip=\"Close Search\"\n                aria-label=\"Close Search\">\n                <app-icon icon=\"times\"></app-icon>\n            </button>\n        </div>\n        \n        <div class=\"view-search__input-row\">\n            <div class=\"view-search__input-container\">\n                <app-icon class=\"view-search__input-icon\" icon=\"search\"></app-icon>\n                <!-- Search -->\n                <input\n                    appAutoFocus\n                    appSelectOnFocus\n                    #searchInput \n                    role=\"search\"\n                    type=\"text\"\n                    class=\"view-search__input\"\n                    aria-label=\"Search Anatomy\"\n                    placeholder=\"Search Anatomy\"\n                    [value]=\"query\"\n                    (keyup)=\"handleSearchKeyup($event,searchInput.value)\">\n            </div>\n        </div>\n    </div>\n\n    <div class=\"view-search__body\">\n        <app-tree-search\n            [displayMode]=\"searchDisplayMode$ | async\"\n            [theme]=\"treeTheme.Themed\"\n            [query]=\"query\"\n            [viewGraph]=\"viewGraph$ | async\">\n        </app-tree-search>\n    </div>\n</div>\n","import { Component, OnInit, ViewChild, ElementRef, Input, ChangeDetectionStrategy, ViewEncapsulation } from '@angular/core';\nimport { Select, Store } from '@ngxs/store';\nimport { EngineState } from 'src/app/engine/state/engine.state';\nimport { Observable } from 'rxjs';\nimport { BdGraph } from 'src/lib/graph/graph.model';\nimport { ViewTreeNode } from 'src/app/engine/models/view.tree-node';\nimport { TreeTheme } from 'src/app/shared/components/tree/tree/tree.component';\nimport { ViewMode } from '../../models/view-mode.enum';\nimport { ViewService } from '../../view.service';\nimport { TreeSearchDisplayMode } from 'src/app/shared/components/tree/tree-search/tree-search.component';\nimport { ViewState } from '../../state/view.state';\nimport { ViewActions } from '../../state/view.actions';\n\n@Component({\n  selector: 'app-view-search',\n  templateUrl: './view-search.component.html',\n  styleUrls: ['./view-search.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None\n})\nexport class ViewSearchComponent implements OnInit {\n  // ---------- View Children ----------\n  @ViewChild('searchInput', { static: false }) searchInput: ElementRef<HTMLInputElement>;\n  \n\n\n  // ---------- Observables ----------\n  @Select(EngineState.getViewGraph)\n  viewGraph$: Observable<BdGraph<ViewTreeNode>>;\n\n  @Select(ViewState.getSearchDisplayMode)\n  searchDisplayMode$: Observable<TreeSearchDisplayMode>;\n\n\n\n  // ---------- Class Variables ----------\n  query = '';\n  treeTheme = TreeTheme;\n  treeSearchDisplayMode = TreeSearchDisplayMode;\n\n  constructor(\n    private viewService: ViewService,\n    private store: Store\n    ) { }\n\n  ngOnInit() {\n  }\n\n  // ---------- Interaction ----------\n\n  handleSearchKeyup(event: KeyboardEvent, value: string) {\n    if (event.key === 'Escape') {\n      this.handleExitClick();\n      this.searchInput.nativeElement.blur();\n    }\n    this.query = value;\n  }\n\n  handleExitClick() {\n    this.query = '';\n    this.viewService.toggleSearch(false);\n  }\n\n  toggleDisplayMode() {\n    let displayMode = this.store.selectSnapshot(ViewState.getSearchDisplayMode);\n    displayMode = (displayMode === TreeSearchDisplayMode.List) ? TreeSearchDisplayMode.Tree : TreeSearchDisplayMode.List;\n    this.setDisplayMode(displayMode);\n  }\n\n  setDisplayMode(displayMode: TreeSearchDisplayMode) {\n    this.store.dispatch(new ViewActions.SetSearchDisplayMode(displayMode));\n  }\n\n  handleTreeButtonClick() {\n    this.setDisplayMode(TreeSearchDisplayMode.Tree);\n  }\n\n  handleListButtonClick() {\n    this.setDisplayMode(TreeSearchDisplayMode.List);\n  }\n}\n","<div class=\"view-shortcuts\">\n    <div *ngFor=\"let group of shortcutGroups\" class=\"view-shortcuts__group\">\n        <h2 class=\"view-shortcuts__label text-bold\">{{ group.label }}</h2>\n        <table class=\"view-shortcuts__table\">\n            <tbody>\n                <tr class=\"view-shortcuts__row\" *ngFor=\"let shortcut of group.shortcuts\">\n                    <td class=\"view-shortcuts__cell view-shortcuts__cell--label\">{{ shortcut.label }}</td>\n                    <td class=\"view-shortcuts__cell view-shortcuts__cell--key\">\n                        <kbd class=\"view-shortcuts__key\" *ngFor=\"let key of shortcut.keys\">{{ key }}</kbd>\n                    </td>\n                </tr>\n            </tbody>\n        </table>\n    </div>\n</div>","import { Component, OnInit, ChangeDetectionStrategy } from '@angular/core';\n\nenum FancyKeys {\n  Left = '',\n  Right = '',\n  Up = '',\n  Down = '',\n  Command = ''\n}\n\n@Component({\n  selector: 'app-view-shortcuts',\n  templateUrl: './view-shortcuts.component.html',\n  styleUrls: ['./view-shortcuts.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class ViewShortcutsComponent implements OnInit {\n  readonly shortcutGroups = [\n    {\n      label: 'Navigation',\n      shortcuts: [\n        {\n          keys: [',', 'Pg-Up'],\n          label: 'Previous chapter'\n        },\n        {\n          keys: ['.', 'Pg-Down'],\n          label: 'Next chapter'\n        },\n        {\n          keys: ['/'],\n          label: 'Open Search'\n        },\n        {\n          keys: ['Ctrl + Enter'],\n          label: 'Enter Fullscreen'\n        },\n        {\n          keys: ['Ctrl/Cmd + ,'],\n          label: 'Toggle Description'\n        }\n      ]\n    },\n\n    {\n      label: 'Tools',\n      shortcuts: [\n        {\n          keys: ['1'],\n          label: 'Use \"Select\" tool'\n        },\n        {\n          keys: ['2'],\n          label: 'Use \"Hide\" tool'\n        },\n        {\n          keys: ['3'],\n          label: 'Use \"Fade\" tool'\n        },\n        {\n          keys: ['del', 'backspace'],\n          label: 'Hide selected structure'\n        },\n        {\n          keys: ['Shift + R'],\n          label: 'Reset chapter'\n        },\n        {\n          keys: ['Ctrl/Cmd + Z'],\n          label: 'Undo'\n        },\n        {\n          keys: ['Ctrl/Cmd + Shift + Z', 'Ctrl/Cmd + Y'],\n          label: 'Redo'\n        }\n      ]\n    },\n\n    {\n      label: 'Pan',\n      shortcuts: [\n        {\n          keys: ['W'],\n          label: 'Pan up'\n        },\n        {\n          keys: ['S'],\n          label: 'Pan down'\n        },\n        {\n          keys: ['A'],\n          label: 'Pan left'\n        },\n        {\n          keys: ['D'],\n          label: 'Pan right'\n        },\n        {\n          keys: ['Shift + W'],\n          label: 'Slow pan up'\n        },\n        {\n          keys: ['Shift + S'],\n          label: 'Slow pan down'\n        },\n        {\n          keys: ['Shift + A'],\n          label: 'Slow pan left'\n        },\n        {\n          keys: ['Shift + D'],\n          label: 'Slow pan right'\n        }\n      ]\n    },\n\n    {\n      label: 'Rotate',\n      shortcuts: [\n        {\n          keys: [FancyKeys.Up],\n          label: 'Rotate up'\n        },\n        {\n          keys: [FancyKeys.Down],\n          label: 'Rotate down'\n        },\n        {\n          keys: [FancyKeys.Left],\n          label: 'Rotate left'\n        },\n        {\n          keys: [FancyKeys.Right],\n          label: 'Rotate right'\n        },\n        {\n          keys: [`Shift + ${FancyKeys.Up}`],\n          label: 'Slow rotate up'\n        },\n        {\n          keys: [`Shift + ${FancyKeys.Down}`],\n          label: 'Slow rotate down'\n        },\n        {\n          keys: [`Shift + ${FancyKeys.Left}`],\n          label: 'Slow rotate left'\n        },\n        {\n          keys: [`Shift + ${FancyKeys.Right}`],\n          label: 'Slow rotate right'\n        }\n      ]\n    },\n\n    {\n      label: 'Zoom',\n      shortcuts: [\n        {\n          keys: ['C', '='],\n          label: 'Zoom in'\n        },\n        {\n          keys: ['E', '-'],\n          label: 'Zoom out'\n        },\n        {\n          keys: ['Shift + C', 'Shift + ='],\n          label: 'Slow zoom in'\n        },\n        {\n          keys: ['Shift + E', 'Shift + -'],\n          label: 'Slow zoom out'\n        }\n      ]\n    }\n];\n\n\n  constructor() { }\n\n  ngOnInit() {\n  }\n\n}\n","<header\n  class=\"view-title\"\n  (click)=\"handleTitleClick()\"\n  #title\n  [ngClass]=\"{\n    'view-title--clickable': (chapterCount$ | async) > 1 && menuEnabled,\n    'view-title--center': alignTitle === 'center',\n    'view-title--large': size === 'large'\n  }\">\n    <!-- story title -->\n    <div\n      class=\"view-title__story\"\n      [ngClass]=\"{'view-description__story-title--large': !chapterTitle}\"\n      *ngIf=\"storyTitle && (storyTitle != chapterTitle)\">\n      {{ storyTitle }}\n    </div>\n\n    <!-- chapter title -->\n    <h1 class=\"view-title__chapter\">\n      <span *ngIf=\"(chapterCount$ | async) > 1 && menuEnabled\">{{ (chapterIndex$ | async) + 1 }}.</span>\n      {{ chapterTitle | textNormalize }}\n      <app-icon icon=\"caret-down\" *ngIf=\"(chapterCount$ | async) > 1 && menuEnabled\"></app-icon>\n    </h1>\n</header>\n","import { \n  Component,\n  OnInit,\n  ChangeDetectionStrategy,\n  ViewEncapsulation,\n  ViewChild,\n  ChangeDetectorRef,\n  Input,\n  Output,\n  EventEmitter,\n  OnDestroy, \n  ElementRef\n} from '@angular/core';\nimport { Select, Store } from '@ngxs/store';\nimport { StoryChaptersState } from 'src/app/story/state/chapters/story.chapters.state';\nimport { Observable, Subject, combineLatest } from 'rxjs';\nimport { ChapterModel } from 'src/app/story/models/chapter.model';\nimport { ViewAudioComponent } from '../view-audio/view-audio.component';\nimport { MediaModel } from 'src/app/story/models/media.model';\nimport { ViewState } from '../../state/view.state';\nimport { ViewUIModel } from '../../models/view-ui.model';\nimport { ViewUI } from '../../models/view-ui.enum';\nimport { ViewUIService } from '../../view-ui.service';\nimport { filter, take, takeUntil } from 'rxjs/operators';\nimport { TextUtils } from 'src/app/shared/libraries/text-utils/text-utils';\nimport { PopupRef } from 'src/app/shared/features/popup/popup.ref';\nimport { ViewChaptersComponent } from '../view-chapters/view-chapters.component';\nimport { PopupService } from 'src/app/shared/features/popup/popup.service';\nimport { environment } from 'src/environments/environment';\nimport { EnvironmentApplication } from 'src/environments/models/environment-application';\nimport { StoryState } from 'src/app/story/state/story.state';\nimport { StoryModel } from 'src/app/story/models/story.model';\n\n@Component({\n  selector: 'app-view-title',\n  templateUrl: './view-title.component.html',\n  styleUrls: ['./view-title.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None,\n  providers: [\n    PopupService\n  ]\n})\nexport class ViewTitleComponent implements OnInit, OnDestroy {\n  // ---------- Children ----------\n  @ViewChild('audio', { static: false })\n  audio: ViewAudioComponent;\n\n  @ViewChild('title', { static: false })\n  title: ElementRef<HTMLElement>;\n\n\n\n  // ---------- Observables ----------\n  @Select(StoryState.getStory)\n  story$: Observable<StoryModel>;\n\n  @Select(StoryChaptersState.getSelectedChapter)\n  chapter$: Observable<ChapterModel>;\n\n  @Select(StoryChaptersState.getChapterCount)\n  chapterCount$: Observable<number>;\n\n  @Select(StoryChaptersState.getSelectedChapterIndex)\n  chapterIndex$: Observable<number>;\n\n  @Select(StoryChaptersState.getSelectedChapterAudio)\n  selectedChapterAudio$: Observable<MediaModel>;\n\n  @Select(ViewState.getUI)\n  layout$: Observable<ViewUIModel>;\n\n  \n\n  // ---------- Input / Output ----------\n  @Input()\n  size: 'medium' | 'large';\n  \n  @Input()\n  alignTitle: 'center' | 'left';\n\n  @Input()\n  public get isPopulated() {\n    return this._isPopulated;\n  }\n  public set isPopulated(value) {\n    this._isPopulated = value;\n    this.isPopulatedChange.emit(this.isPopulated);\n  }\n  private _isPopulated = false;\n\n  @Output()\n  isPopulatedChange = new EventEmitter<boolean>();\n\n  @Input()\n  public get menuEnabled() {\n    return this._menuEnabled;\n  }\n  public set menuEnabled(value) {\n    this._menuEnabled = value;\n  }\n  private _menuEnabled = true;\n\n\n  \n  // ---------- Class Variables ----------\n  viewLayout = ViewUI;\n  ngUnsubscribe = new Subject();\n  storyTitle = '';\n  chapterTitle = '';\n  chapterAudio: MediaModel = null;\n  chaptersPopup: PopupRef<ViewChaptersComponent>;\n\n  \n  // ---------- Lifecycle ----------\n  constructor(\n    private layoutService: ViewUIService,\n    private changeDetectorRef: ChangeDetectorRef,\n    private popupService: PopupService,\n    private store: Store\n  ) { }\n\n  ngOnInit() {\n    this.initContentListener();\n    this.initLayoutListener();\n    this.initChapterListener();\n  }\n\n  ngOnDestroy() {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n  isEnabled(layout: ViewUI) {\n    return this.layoutService.isUIEnabled(layout);\n  }\n  \n  \n  \n  // ---------- Listeners ----------\n  initContentListener() {\n    combineLatest(\n      this.story$,\n      this.chapter$, \n    ).pipe(\n      filter(([story, chapter]) => chapter != null && story != null),\n      takeUntil(this.ngUnsubscribe)\n    ).subscribe(([story, chapter]) => {\n      // Only populate bookmark in web app\n      this.chapterTitle = TextUtils.normalize(chapter.info.displayName);\n      \n\n      this.storyTitle = (environment.application !== EnvironmentApplication.Viewer) ? TextUtils.normalize(story.displayName) : '';\n      this.chapterTitle = TextUtils.normalize(chapter.info.displayName);\n\n      this.isPopulated = !!this.chapterTitle || !!this.storyTitle;\n    });\n  }\n\n  initLayoutListener() {\n    this.layout$.pipe(\n      takeUntil(this.ngUnsubscribe)\n    ).subscribe((layout) => {\n      this.changeDetectorRef.markForCheck();\n    });\n  }\n\n  initChapterListener() {\n    this.store.select(StoryChaptersState.getSelectedChapterIndex)\n      .pipe(\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(() => {\n        if (this.chaptersPopup) {\n          this.chaptersPopup.close();\n        }\n      });\n  }\n\n\n  // ---------- Interaction ----------\n  handleAudioPlayClick() {\n    if (this.audio.playing) {\n      this.audio.pause();\n    } else {\n      this.audio.play();\n    }\n  }\n\n  handleTitleClick() {\n    if (!this.menuEnabled) {\n      return;\n    }\n\n    if (this.chaptersPopup) {\n      this.chaptersPopup.close();\n    } else {\n      this.chaptersPopup = this.popupService.open<ViewChaptersComponent>({\n        origin: this.title.nativeElement,\n        content: ViewChaptersComponent,\n        width: '300px'\n      });\n\n      this.chaptersPopup.afterClosed$\n        .pipe(\n          takeUntil(this.ngUnsubscribe),\n          take(1)\n        )\n        .subscribe((close) => {\n          this.chaptersPopup = null;\n        });\n    }\n  }\n\n}\n","<ng-container [ngSwitch]=\"mode\">\n  <div class=\"view-toolbar\" [attr.data-test]=\"testSelectors.ViewToolbarMain\" [@inOutAnimation] *ngSwitchDefault>\n    <app-pillbox eventCategory=\"View Primary Toolbar\" name=\"Primary Toolbar\" *ngIf=\"(isVisible(viewUI.Pagination) || isVisible(viewUI.Mediabar))\">\n      <app-view-tools [collapsePagination]=\"collapsePagination\" [mode]=\"viewToolsMode.Main\" (modeChange)=\"handleModeChange($event)\"></app-view-tools>\n    </app-pillbox>\n  </div>\n\n  <div class=\"view-toolbar\" [@inOutAnimation] *ngSwitchCase=\"viewToolsMode.Media\">\n    <app-pillbox eventCategory=\"View Media Bar\" [canExit]=\"canExit\" (exit)=\"handleExitClick()\" name=\"Media Bar\">\n      <app-view-media-bar [template]=\"mediaTemplate\"></app-view-media-bar>\n    </app-pillbox>\n  </div>\n\n  <div class=\"view-toolbar\" [@inOutAnimation] *ngSwitchCase=\"viewToolsMode.Tools\">\n    <app-pillbox eventCategory=\"View Explore Tools\" [canExit]=\"canExit\" (exit)=\"handleExitClick()\" name=\"Explore Tools\">\n      <app-view-tools [mode]=\"viewToolsMode.Tools\"></app-view-tools>\n    </app-pillbox>\n  </div>\n\n  <div class=\"view-toolbar\" [@inOutAnimation] *ngSwitchCase=\"viewToolsMode.VisibilityLayers\">\n    <app-pillbox [canExit]=\"canExit\" (exit)=\"handleExitClick()\" name=\"Visibility Layers\">\n      <app-view-layers-bar></app-view-layers-bar>\n    </app-pillbox>\n  </div>\n</ng-container>\n\n","import { Component, OnInit, ViewEncapsulation, ChangeDetectionStrategy, ViewChild, ElementRef, Input, ChangeDetectorRef } from '@angular/core';\nimport { Store, Select } from '@ngxs/store';\nimport { ViewState } from '../../state/view.state';\nimport { ViewUIStatus } from '../../models/view-ui-status.enum';\nimport { Subject, Observable } from 'rxjs';\nimport { takeUntil } from 'rxjs/operators';\nimport { ViewService } from '../../view.service';\nimport { ViewToolsMode } from '../../models/view-tools-mode.enum';\nimport { trigger, transition, style, animate } from '@angular/animations';\nimport { ViewActions } from '../../state/view.actions';\nimport { ViewUI } from '../../models/view-ui.enum';\nimport { ViewUIService } from '../../view-ui.service';\nimport { MediaEnum } from 'src/app/story/models/media.enum';\nimport { TestSelectors } from 'e2e/selectors/test-selectors';\nimport { Breakpoint } from 'src/app/breakpoint/models/breakpoint.enum';\nimport { BreakpointState } from 'src/app/breakpoint/state/breakpoint.state';\nimport { ToolEnum } from 'src/app/engine/models/tool.enum';\n\n@Component({\n  selector: 'app-view-toolbar',\n  templateUrl: './view-toolbar.component.html',\n  styleUrls: ['./view-toolbar.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None,\n  animations: [\n    trigger('inOutAnimation', [\n      transition(':enter', [\n        style({\n          opacity: 0,\n          transform: 'translateY(200px)'\n        }),\n        animate('300ms ease-in-out', style({\n          opacity: 1,\n          transform: '*'\n        }))\n      ]),\n      transition(':leave', [\n        animate('300ms ease-in-out', style({\n          transform: 'translateY(200px)',\n          opacity: 0\n        }))\n      ])\n    ])\n  ]\n})\nexport class ViewToolbarComponent implements OnInit {\n  viewUI = ViewUI;\n\n  // ---------- Child Elements ----------\n  @ViewChild('viewToolbar', {static: false }) viewToolbar: ElementRef;\n\n\n\n  // ---------- Input / Output ----------\n  @Input()\n  canExit = true;\n\n  @Input()\n  mode = ViewToolsMode.Main;\n\n  @Input()\n  lockMode = false;\n\n  @Input()\n  position: 'center' | 'right' = 'center';\n\n\n  // ---------- Class Variables ----------\n  ngUnsubscribe = new Subject();\n  breakpoint = Breakpoint;\n  viewToolsMode = ViewToolsMode;\n  viewLayout = ViewUI;\n  testSelectors = TestSelectors;\n  mediaTemplate: MediaEnum;\n  collapsePagination = false;\n\n\n\n  // ---------- Lifecycle hooks ----------\n  constructor(\n    private store: Store,\n    private changeDetectorRef: ChangeDetectorRef,\n    private layoutService: ViewUIService,\n    private viewService: ViewService,\n    private viewUIService: ViewUIService\n  ) { }\n\n  ngOnInit() {\n    this.initLayoutListener();\n    this.initBreakpointListener();\n  }\n\n  initLayoutListener() {\n    this.store.select(ViewState.getUI)\n      .pipe(\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe((layout) => {\n        if (this.lockMode) {\n          return;\n        }\n\n        this.mode = ViewToolsMode.Main;\n\n        if (this.layoutService.isUIVisible(ViewUI.Media)) {\n          this.mediaTemplate = layout.media.template;\n          this.mode = ViewToolsMode.Media;\n        }\n\n        if (this.layoutService.isToolsVisible()) {\n          this.mode = ViewToolsMode.Tools;\n        }\n\n        if (\n          this.layoutService.isVisibilityLayersVisible() && \n          this.layoutService.isUIVisible(ViewUI.VisibilityLayers)\n        ) {\n          this.mode = ViewToolsMode.VisibilityLayers;\n        }\n\n        this.changeDetectorRef.markForCheck();\n      });\n  }\n\n  initBreakpointListener() {\n    this.store.select(BreakpointState.getBreakpoint)\n      .pipe(\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(breakpoint => {\n        this.collapsePagination = breakpoint < Breakpoint.Small;\n        this.changeDetectorRef.markForCheck();\n      });\n  }\n\n  isVisible(layout: ViewUI) {\n    return this.viewUIService.isVisible(layout);\n  }\n\n\n  // ---------- Interactions ----------\n  handleExitClick() {\n    const layout = this.store.selectSnapshot(ViewState.getUI);\n    layout.media.status = ViewUIStatus.Hide;\n    layout.tools.status = ViewUIStatus.Hide;\n    layout.visibilityLayers.status = ViewUIStatus.Hide;\n      // Revert tool selection when tools isn't visible\n    this.viewService.selectTool(ToolEnum.Select);\n    this.store.dispatch(new ViewActions.SetUI(layout));\n  }\n}\n","<div\n  role=\"toolbar\"\n  aria-label=\"Tools\"\n  class=\"view-tools\">\n  <ng-container *ngIf=\"mode === viewToolsMode.Main\" gaCategory=\"View Toolbar\">\n    <!-- Chapter Navigation -->\n    <div class=\"view-tools__group\" *ngIf=\"isVisible(viewUI.Pagination)\">\n      <!-- Previous -->\n      <button \n        gaEvent\n        gaAction=\"Clicked Previous Chapter\"\n        (click)=\"handlePreviousClick()\"\n        [attr.data-test]=\"testSelectors.ViewToolsPreviousChapter\"\n        [disabled]=\"(chapterIndex$ | async) === 0\"\n        [attr.aria-disabled]=\"(chapterIndex$ | async) === 0\"\n        aria-label=\"Previous Chapter\"\n        [matTooltip]=\"(previousChapter$ | async) ? 'Previous: ' + (previousChapter$ | async)?.info.displayName : ''\"\n        app-pin-button\n        buttonType=\"ghost\"\n        class=\"view-tools__item\"\n        icon=\"chevron-left\"\n      ></button>\n\n      <!-- Next -->\n      <button \n        gaEvent\n        gaAction=\"Clicked Next Chapter\"\n        (click)=\"handleNextClick()\"\n        [attr.data-test]=\"testSelectors.ViewToolsNextChapter\"\n        aria-label=\"Next Chapter\"\n        [attr.aria-disabled]=\"(chapterIndex$ | async) === ((chapterCount$ | async) - 1)\"\n        [disabled]=\"(chapterIndex$ | async) === ((chapterCount$ | async) - 1)\"\n        [matTooltip]=\"(nextChapter$ | async) ? 'Next: ' + (nextChapter$ | async)?.info.displayName : ''\"\n        app-pin-button\n        buttonType=\"ghost\"\n        class=\"view-tools__item\"\n        icon=\"chevron-right\"\n      ></button>\n    </div>\n\n    <div class=\"view-tools__group\" *ngIf=\"isVisible(viewUI.Pagination) && !collapsePagination\">\n      <!-- Chapter Count -->\n      <div\n        gaEvent\n        gaAction=\"Clicked Open Chapter List\"\n        #chapterCount\n        class=\"view-tools__item\">\n        <button\n          (click)=\"handleChapterCountClick()\"\n          [attr.data-test]=\"testSelectors.ViewToolsChapterCount\"\n          [attr.visible]=\"breakpoint !== breakpointEnum.Small\"\n          app-pin-button\n          buttonType=\"ghost\"\n          aria-label=\"Toggle Chapter List\"\n          [matTooltip]=\"chaptersPopup ? 'Close Chapter List' : 'Open Chapter List'\"\n        >\n            <div class=\"ph-2 text-13 text-semibold\" style=\"white-space: nowrap;\" aria-hidden=\"true\">\n              {{(chapterIndex$ | async) + 1}} of {{ (chapterCount$ | async)}}\n              <app-icon icon=\"caret-up\" class=\"ml-2\"></app-icon>\n            </div>\n\n            <span class=\"visually-hidden\">\n              Toggle Chapter List, Chapter {{(chapterIndex$ | async) + 1}} of {{ (chapterCount$ | async)}}\n            </span>\n        </button>\n      </div>\n    </div>\n\n    <!-- Media Controls -->\n    <div class=\"view-tools__group\" *ngIf=\"isVisible(viewUI.Mediabar)\">\n      <!-- Play -->\n      <button \n        gaEvent\n        gaAction=\"Clicked Toggle Animation\"\n        [gaLabel]=\"(animationPlaying$ | async) ? 'Pause' : 'Play'\"\n        (click)=\"handlePlayClick()\"\n        [attr.data-test]=\"testSelectors.ViewToolsPlay\"\n        [icon]=\"(animationPlaying$ | async) ? 'pause' : 'play'\"\n        [attr.aria-label]=\"(animationPlaying$ | async) ? 'Pause Animation' : 'Play Animation'\"\n        [matTooltip]=\"(animationPlaying$ | async) ? 'Pause Animation' : 'Play Animation'\"\n        app-pin-button\n        buttonType=\"ghost\"\n        class=\"view-tools__item\"\n      ></button>\n\n      <!-- Media -->\n      <button \n        gaEvent\n        gaAction=\"Clicked Open Media Bar\"\n        (click)=\"toggleToolbar('media')\"\n        *ngIf=\"mediaTemplate === mediaControlsEnum.Full\"\n        app-pin-button\n        buttonType=\"ghost\"\n        class=\"view-tools__item\"\n        aria-label=\"Open Media Bar\"\n        matTooltip=\"Open Media Bar\"\n      >\n        <app-view-scrubber [showHandle]=\"false\" style=\"width: 32px; margin: 0 8px\"></app-view-scrubber>\n      </button>\n\n      <!-- Audio -->\n      <button \n        gaEvent\n        gaAction=\"Clicked Toggle Audio\"\n        [gaLabel]=\"(playAudio$ | async) ? 'Mute' : 'Unmute'\"\n        *ngIf=\"isVisible(viewUI.Audio)\"\n        (click)=\"handleAudioClick()\"\n        [icon]=\"(playAudio$ | async) ? 'volume' : 'volume-slash'\"\n        [matTooltip]=\"(playAudio$ | async) ? 'Mute Audio' : 'Play Audio'\"\n        app-pin-button\n        buttonType=\"ghost\"\n        class=\"view-tools__item\"\n      ></button>\n    </div>\n  </ng-container>\n\n\n  <!-- Submenu: Tools   -->\n  <ng-container *ngIf=\"mode === viewToolsMode.Tools\" gaCategory=\"View Explore Tools\">\n    <div class=\"view-tools__group\">\n      <div role=\"radiogroup\" class=\"flex\">\n        <button \n          gaEvent\n          gaAction=\"Clicked Select\"\n          (click)=\"handleSelectTool(toolEnum.Select)\"\n          [selected]=\"(activeTool$ | async) === toolEnum.Select\"\n          app-pin-button\n          buttonType=\"ghost\"\n          class=\"view-tools__item\"\n          icon=\"mouse-pointer\"\n          aria-label=\"Select\"\n          matTooltip=\"Select\"\n        ></button>\n\n        <button \n          gaEvent\n          gaAction=\"Clicked Hide\"\n          (click)=\"handleSelectTool(toolEnum.Hide)\"\n          [selected]=\"(activeTool$ | async) === toolEnum.Hide\"\n          app-pin-button\n          buttonType=\"ghost\"\n          class=\"view-tools__item\"\n          icon=\"eye-slash\"\n          aria-label=\"Hide\"\n          matTooltip=\"Hide\"\n        ></button>\n        \n        <button \n          gaEvent\n          gaAction=\"Clicked Fade\"\n          app-pin-button\n          appHideIE11\n          buttonType=\"ghost\"\n          class=\"view-tools__item\"\n          aria-label=\"Fade\"\n          matTooltip=\"Fade\"\n          icon=\"adjust\"\n          [selected]=\"(activeTool$ | async) === toolEnum.Fade\"\n          (click)=\"handleSelectTool(toolEnum.Fade)\">\n        </button>\n      </div>\n    </div>\n  </ng-container>\n</div>\n","import {\n  Component,\n  OnInit,\n  ChangeDetectionStrategy,\n  ViewEncapsulation,\n  Input,\n  Output,\n  EventEmitter,\n  ChangeDetectorRef,\n  OnDestroy,\n  ViewChild,\n  ElementRef} from '@angular/core';\nimport { ToolEnum } from 'src/app/engine/models/tool.enum';\nimport { ViewToolsMode} from '../../models/view-tools-mode.enum';\nimport { Select, Store } from '@ngxs/store';\nimport { EngineState } from 'src/app/engine/state/engine.state';\nimport { Observable, Subject } from 'rxjs';\nimport { ViewService } from '../../view.service';\nimport { Fullscreen } from 'src/app/shared/libraries/fullscreen/fullscreen';\nimport { ViewState } from '../../state/view.state';\nimport { StoryChaptersState } from 'src/app/story/state/chapters/story.chapters.state';\nimport { StoryLabelsState } from 'src/app/story/state/labels/story.labels.state';\nimport { LabelModel } from 'src/app/story/models/labels/label.model';\nimport { MediaModel } from 'src/app/story/models/media.model';\nimport { ViewUIStatus } from '../../models/view-ui-status.enum';\nimport { ViewActions } from '../../state/view.actions';\nimport { ViewUIService } from '../../view-ui.service';\nimport { ViewUI } from '../../models/view-ui.enum';\nimport { takeUntil, take, filter } from 'rxjs/operators';\nimport { MediaEnum } from 'src/app/story/models/media.enum';\nimport { TestSelectors } from 'e2e/selectors/test-selectors';\nimport { Breakpoint } from 'src/app/breakpoint/models/breakpoint.enum';\nimport { BreakpointState } from 'src/app/breakpoint/state/breakpoint.state';\nimport { ViewChaptersComponent } from '../view-chapters/view-chapters.component';\nimport { ViewMediaBarComponent } from '../view-media-bar/view-media-bar.component';\nimport { PopupService } from 'src/app/shared/features/popup/popup.service';\nimport { PopupRef } from 'src/app/shared/features/popup/popup.ref';\nimport { ChapterModel } from 'src/app/story/models/chapter.model';\nimport { UndoState } from 'src/app/undo/state/undo.state';\nimport { HelpTypeEnum } from '../../models/help-type.enum';\nimport { ImageTypeEnum } from 'src/app/shared/image.service';\nimport { ThumbnailConstants } from 'src/app/shared/thumbnail.constants';\nimport { ChapterReadyStateModel } from 'src/app/story/models/chapter-ready-state.model';\nimport { GoogleAnalyticsService } from 'ngx-google-analytics';\n\n@Component({\n  selector: 'app-view-tools',\n  templateUrl: './view-tools.component.html',\n  styleUrls: ['./view-tools.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None,\n  providers: [\n    PopupService\n  ]\n})\nexport class ViewToolsComponent implements OnInit, OnDestroy {\n  @ViewChild('chapterCount', { static: false })\n  chapterCount: ElementRef<HTMLDivElement>;\n\n  @ViewChild('mediaToggle', { static: false })\n  mediaToggle: ElementRef<HTMLDivElement>;\n\n  // ---------- Observables ----------\n  @Select(StoryChaptersState.getSelectedChapterReadyState)\n  selectedChapterReady$: Observable<ChapterReadyStateModel>;  \n  \n  @Select(EngineState.getActiveTool)\n  activeTool$: Observable<ToolEnum>;\n\n  @Select(ViewState.getPresentationActive)\n  presentationActive$: Observable<boolean>;\n\n  @Select(StoryChaptersState.getIsChapterAnimated)\n  isChapterAnimated$: Observable<boolean>;\n\n  @Select(EngineState.getShowLabels)\n  showLabels$: Observable<boolean>;\n\n  @Select(EngineState.getAnimationPlaying)\n  animationPlaying$: Observable<boolean>;\n\n  @Select(EngineState.getPlayAudio)\n  playAudio$: Observable<boolean>;\n\n  @Select(StoryLabelsState.getChapterLabels)\n  labels$: Observable<LabelModel[]>;\n\n  @Select(StoryChaptersState.getSelectedChapterTitle)\n  chapterTitle$: Observable<string>;\n\n  @Select(StoryChaptersState.getSelectedChapterIndex)\n  chapterIndex$: Observable<number>;\n\n  @Select(StoryChaptersState.getNextChapter)\n  nextChapter$: Observable<ChapterModel>;\n\n  @Select(StoryChaptersState.getPreviousChapter)\n  previousChapter$: Observable<ChapterModel>;\n\n  @Select(StoryChaptersState.getChapterCount)\n  chapterCount$: Observable<number>;\n\n  @Select(StoryChaptersState.getSelectedChapterAudio)\n  selectedChapterAudio$: Observable<MediaModel>;\n\n  @Select(ViewState.getCanTouch)\n  canTouch$: Observable<boolean>;\n\n  // ---------- Class Variables ----------\n  viewToolsMode = ViewToolsMode;\n  viewUI = ViewUI;\n  breakpointEnum = Breakpoint;\n  testSelectors = TestSelectors;\n  canFullscreen = true;\n  isFullscreen = false;\n  breakpoint: Breakpoint;\n  toolEnum = ToolEnum;\n  mediaControlsEnum = MediaEnum;\n  mediaTemplate: MediaEnum;\n  chaptersPopup: PopupRef<ViewChaptersComponent>;\n  mediaPopup: PopupRef<ViewMediaBarComponent>;\n  fullscreen$: Observable<Event>;\n  private ngUnsubscribe = new Subject();\n\n\n\n  // ---------- Input / Output ----------\n  @Input()\n  animate = true;\n\n  @Input()\n  public get mode() {\n    return this._mode;\n  }\n  public set mode(value) {\n    this._mode = value;\n  }\n  private _mode = ViewToolsMode.Main;\n\n  @Input()\n  collapsePagination = false;\n\n  @Output()\n  modeChange = new EventEmitter<ViewToolsMode>();\n\n\n  // ---------- Lifecycle Events ----------\n  constructor(\n    private viewService: ViewService,\n    private viewUIService: ViewUIService,\n    private store: Store,\n    private changeDetectorRef: ChangeDetectorRef,\n    private popupService: PopupService,\n    private ga: GoogleAnalyticsService\n  ) { }\n\n  ngOnInit() {\n    this.canFullscreen = Fullscreen.canFullscreen();\n    this.initLayoutListener();\n    this.initBreakpointListener();\n    this.initChapterListener();\n    this.initFullscreenListener();\n  }\n\n  ngOnDestroy() {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n  initLayoutListener() {\n    this.store.select(ViewState.getUI)\n      .pipe(\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe((layout) => {\n        this.mediaTemplate = layout.media.template;\n        this.changeDetectorRef.markForCheck();\n      });\n  }\n\n  initBreakpointListener() {\n    this.store.select(BreakpointState.getBreakpoint)\n      .pipe(\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(breakpoint => {\n        this.breakpoint = breakpoint;\n        this.changeDetectorRef.markForCheck();\n      });\n  }\n\n  initChapterListener() {\n    this.store.select(StoryChaptersState.getSelectedChapterIndex)\n      .pipe(\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(() => {\n        if (this.chaptersPopup) {\n          this.chaptersPopup.close();\n        }\n      });\n  }\n\n  initFullscreenListener() {\n    this.fullscreen$ = Fullscreen.onFullscreenChange();\n    this.fullscreen$\n      .pipe(\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(event => {\n        this.isFullscreen = Fullscreen.isFullscreen();\n        this.changeDetectorRef.markForCheck();\n      });\n  }\n\n  handleSelectTool(tool: ToolEnum) {\n    // If user selects same tool twice, act as checkbox and deselect the tool\n    const activeTool = this.store.selectSnapshot(EngineState.getActiveTool);\n    const selectTool = (tool === activeTool) ? ToolEnum.Select : tool;\n\n    this.viewService.selectTool(selectTool);\n  }\n\n  handlePlayClick() {\n    this.viewService.toggleAnimation();\n  }\n\n  handleAudioClick() {\n    this.viewService.toggleAudio();\n  }\n\n  handleMenuClick() {\n    this.store.dispatch(new ViewActions.ToggleMenu(true));\n  }\n\n  handlePreviousClick() {\n    this.viewService.previousChapter();\n  }\n\n  handleNextClick() {\n    this.viewService.nextChapter();\n  }\n\n  handleChapterCountClick() {\n    this.toggleChaptersPopup();\n  }\n\n  handleMediaClick() {\n    this.toggleMediaPopup();\n  }\n\n  handleSnapshotClick() {\n    this.viewService.takeSnapshot(\n      this.store.selectSnapshot(StoryChaptersState.getSelectedChapterId),\n      ImageTypeEnum.JPEG\n    );\n  }\n\n  toggleChaptersPopup() {\n    if (this.chaptersPopup) {\n      this.chaptersPopup.close();\n    } else {\n      this.chaptersPopup = this.popupService.open<ViewChaptersComponent>({\n        origin: this.chapterCount.nativeElement,\n        content: ViewChaptersComponent,\n        width: '300px'\n      });\n\n      this.chaptersPopup.afterClosed$\n        .pipe(\n          takeUntil(this.ngUnsubscribe),\n          take(1)\n        )\n        .subscribe((close) => {\n          this.chaptersPopup = null;\n        });\n    }\n  }\n\n  toggleMediaPopup() {\n    if (this.mediaPopup) {\n      this.mediaPopup.close();\n    } else {\n      this.mediaPopup = this.popupService.open<ViewMediaBarComponent>({\n        origin: this.mediaToggle.nativeElement,\n        content: ViewMediaBarComponent,\n        width: '300px'\n      });\n\n      this.mediaPopup.afterClosed$\n        .pipe(\n          takeUntil(this.ngUnsubscribe),\n          take(1)\n        )\n        .subscribe((close) => {\n          this.mediaPopup = null;\n        });\n    }\n  }\n\n  toggleToolbar(bar: 'media' | 'tools' | 'toolbar') {\n    this.viewService.toggleToolbar(bar);\n  }\n\n  isEnabled(layout: ViewUI) {\n    return this.viewUIService.isUIEnabled(layout);\n  }\n\n  isVisible(layout: ViewUI) {\n    return this.viewUIService.isVisible(layout);\n  }\n}\n","export enum TriggerEnum {\n    CameraZoom = 'camera-zoom',\n    CameraRotate = 'camera-rotate',\n    CameraPan = 'camera-pan',\n    NodeSelection = 'node-selection'\n}\n","<app-view-tour-pages gaCategory=\"View Tutorial\">\n\n    <app-view-tour-page>\n\n        <app-view-tour-slide title=\"Rotate\" [trigger]=\"triggers.CameraRotate\">\n            Click and drag the model to change the viewing angle.          \n        </app-view-tour-slide>\n\n        <app-view-tour-slide>\n            <div class=\"flex justify-start items-center\">\n                <div>\n                    <app-view-tour-success [inline]=\"true\" class=\"mr-2\"></app-view-tour-success>\n                    <strong class=\"text-semibold\">Tip:</strong> You can also use the arrow keys <app-view-tour-tip-button icon=\"caret-up\" label=\"up\"></app-view-tour-tip-button> <app-view-tour-tip-button icon=\"caret-down\" label=\"down\"></app-view-tour-tip-button> <app-view-tour-tip-button icon=\"caret-left\" label=\"left\"></app-view-tour-tip-button> <app-view-tour-tip-button icon=\"caret-right\" label=\"right\"></app-view-tour-tip-button> to rotate.\n                </div>\n            </div>\n\n        </app-view-tour-slide>\n\n    </app-view-tour-page>\n\n    <app-view-tour-page>\n\n        <app-view-tour-slide\n            title=\"Zoom\"\n            [trigger]=\"triggers.CameraZoom\"\n            [ngSwitch]=\"captureScroll$ | async\">\n           \n            <ng-container *ngSwitchCase=\"false\">\n                Hold the control key and scroll up and down to zoom in or out.\n            </ng-container>\n\n            <ng-container *ngSwitchDefault>\n                Scroll up and down to zoom in or out.\n            </ng-container>\n\n        </app-view-tour-slide>\n\n        <app-view-tour-slide>\n            <div class=\"flex justify-start items-center\">\n                <div>\n                    <app-view-tour-success [inline]=\"true\" class=\"mr-2\"></app-view-tour-success>\n                    <strong class=\"text-semibold\">Tip:</strong> You can also use <app-view-tour-tip-button label=\"+\"></app-view-tour-tip-button> to zoom in and <app-view-tour-tip-button label=\"-\"></app-view-tour-tip-button> to zoom out.\n                </div>\n            </div>\n        </app-view-tour-slide>\n\n    </app-view-tour-page>\n\n    <app-view-tour-page>\n\n        <app-view-tour-slide title=\"Pan\" [trigger]=\"triggers.CameraPan\">\n            Hold the shift key and drag to move the model's position.\n        </app-view-tour-slide>\n\n        <app-view-tour-slide>\n            <div class=\"flex justify-start items-center\">\n                <div>\n                    <app-view-tour-success [inline]=\"true\" class=\"mr-2\"></app-view-tour-success>\n                    <strong class=\"text-semibold\">Tip:</strong> You can also use the <app-view-tour-tip-button label=\"W\"></app-view-tour-tip-button> <app-view-tour-tip-button label=\"A\"></app-view-tour-tip-button> <app-view-tour-tip-button label=\"S\"></app-view-tour-tip-button> <app-view-tour-tip-button label=\"D\"></app-view-tour-tip-button> keys to pan.\n                </div>\n            </div>\n        </app-view-tour-slide>\n\n    </app-view-tour-page>\n\n    <app-view-tour-page>\n\n        <app-view-tour-slide title=\"Explore the Anatomy\" [trigger]=\"triggers.NodeSelection\">\n            Click on an individual part of the model to highlight anatomy.\n        </app-view-tour-slide>\n\n        <app-view-tour-slide>\n            <div class=\"flex justify-start items-center\">\n                <div>\n                    <app-view-tour-success [inline]=\"true\" class=\"mr-2\"></app-view-tour-success>\n                    <strong class=\"text-semibold\">Tip:</strong> Double-click to zoom in on specific structures.\n                </div>\n            </div>\n        </app-view-tour-slide>\n\n    </app-view-tour-page>\n\n    <app-view-tour-page>\n\n\n        <app-view-tour-slide image=\"assets/images/tutorial/tutorial-toolbar@3x.png\">\n            Use the toolbar to navigate through the 3D experience, launch deeper exploration tools, and relaunch this tutorial.\n\n            <div class=\"flex flex-column items-center justify-center\" slide-footer>\n                <button \n                    gaEvent\n                    gaAction=\"Clicked Start Exploring\"\n                    app-view-rounded-button\n                    buttonType=\"solid\"\n                    label=\"Start Exploring!\"\n                    aria-label=\"Start Exploring\"             \n                    class=\"mt-4\"\n                    (click)=\"handleStartClick()\">\n                </button>         \n            </div>\n        </app-view-tour-slide>\n\n    </app-view-tour-page>\n\n</app-view-tour-pages>","import { Component, OnInit, ChangeDetectionStrategy, Output, EventEmitter } from '@angular/core';\nimport { TriggerEnum } from '../../models/trigger.enum';\nimport { ViewService } from 'src/app/view/view.service';\nimport { EngineState } from 'src/app/engine/state/engine.state';\nimport { Select, Store } from '@ngxs/store';\nimport { Observable } from 'rxjs';\nimport { ScrollModeEnum } from 'src/app/engine/models/scroll-mode.enum';\nimport { map } from 'rxjs/operators';\nimport { ViewActions } from 'src/app/view/state/view.actions';\n\n@Component({\n  selector: 'app-view-tour-desktop',\n  templateUrl: './view-tour-desktop.component.html',\n  styleUrls: ['./view-tour-desktop.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class ViewTourDesktopComponent implements OnInit {\n\n  triggers = TriggerEnum;\n\n  @Select(EngineState.getScrollMode)\n  scrollMode$: Observable<ScrollModeEnum>;\n\n  captureScroll$: Observable<boolean>;\n  \n  constructor(private viewService: ViewService) { }\n\n  ngOnInit() {\n    this.captureScroll$ = this.scrollMode$\n      .pipe(\n        map((mode) => mode === ScrollModeEnum.Capture)\n    );\n  }\n\n  handleStartClick() {\n    this.viewService.toggleTutorial(false);\n  }\n\n}\n","<app-view-tour-pages gaCategory=\"View Tutorial\">\n\n    <app-view-tour-page>\n\n        <app-view-tour-slide title=\"Rotate\" [trigger]=\"'camera-rotate'\">\n            Tap and drag with one finger to change the viewing angle.\n        </app-view-tour-slide>\n\n        <app-view-tour-slide>\n            <app-view-tour-success></app-view-tour-success>\n        </app-view-tour-slide>\n\n    </app-view-tour-page>\n\n    <app-view-tour-page>\n\n        <app-view-tour-slide title=\"Zoom\" [trigger]=\"triggers.CameraZoom\">\n            Pinch with two fingers to zoom in or out.\n        </app-view-tour-slide>\n\n        <app-view-tour-slide>\n            <app-view-tour-success></app-view-tour-success>\n        </app-view-tour-slide>\n\n    </app-view-tour-page>\n\n    <app-view-tour-page>\n\n        <app-view-tour-slide title=\"Pan\" [trigger]=\"triggers.CameraPan\">\n            Use two fingers to adjust the model's position. \n        </app-view-tour-slide>\n\n        <app-view-tour-slide>\n            <app-view-tour-success></app-view-tour-success>\n        </app-view-tour-slide>\n\n    </app-view-tour-page>\n\n    <app-view-tour-page>\n\n        <app-view-tour-slide title=\"Explore the Anatomy\" [trigger]=\"triggers.NodeSelection\">\n            Tap on an individual part of the model to highlight anatomy.\n        </app-view-tour-slide>\n\n        <app-view-tour-slide>\n            <div class=\"flex justify-start items-center\">\n                <div>\n                    <app-view-tour-success [inline]=\"true\" class=\"mr-2\"></app-view-tour-success>\n                    <strong class=\"text-semibold\">Tip:</strong> Double-tap to zoom in on specific structures.\n                </div>\n            </div>\n        </app-view-tour-slide>\n\n    </app-view-tour-page>\n\n    <app-view-tour-page>\n\n        <app-view-tour-slide title=\"Toolbar\" image=\"assets/images/tutorial/tutorial-toolbar@3x.png\">\n            Use the toolbar to navigate through the 3D experience, launch deeper exploration tools, and relaunch this tutorial.\n            <div class=\"flex flex-column items-center justify-center\" slide-footer>\n\n                <button \n                    gaEvent\n                    gaAction=\"Clicked Start Exploring\"\n                    app-view-rounded-button\n                    buttonType=\"solid\"\n                    label=\"Start Exploring!\"\n                    aria-label=\"Start Exploring\"               \n                    class=\"mt-4\"\n                    (click)=\"handleStartClick()\">\n                </button>         \n\n            </div>\n            \n        </app-view-tour-slide>\n\n    </app-view-tour-page>\n\n</app-view-tour-pages>","import { Component, OnInit, ChangeDetectionStrategy, AfterViewInit, EventEmitter, Output } from '@angular/core';\nimport { TriggerEnum } from '../../models/trigger.enum';\nimport { ViewService } from 'src/app/view/view.service';\n\n@Component({\n  selector: 'app-view-tour-mobile',\n  templateUrl: './view-tour-mobile.component.html',\n  styleUrls: ['./view-tour-mobile.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class ViewTourMobileComponent implements OnInit {\n\n  triggers = TriggerEnum;\n\n  constructor(private viewService: ViewService) { }\n\n  ngOnInit() {\n  }\n\n  handleStartClick() {\n    this.viewService.toggleTutorial(false);\n  }\n\n}\n","import { Observable, fromEvent, merge } from 'rxjs';\nimport { CameraService } from 'src/app/engine/camera.service';\nimport { EngineService } from 'src/app/engine/engine.service';\nimport { EventsEnum } from 'src/app/engine/models/events.enum';\nimport { map, pairwise, debounceTime, filter, startWith, flatMap } from 'rxjs/operators';\nimport { CameraModel } from 'src/app/engine/models/camera.model';\nimport { vec3 } from 'gl-matrix';\nimport { Store } from '@ngxs/store';\nimport { EngineNodesState } from 'src/app/engine/state/nodes/engine.nodes.state';\nimport { EngineCameraState } from 'src/app/engine/state/camera/engine.camera.state';\nimport { TriggerEnum } from '../models/trigger.enum';\n\ninterface CameraStateModel {\n    camera: CameraModel;\n    zoom: number;\n}\n\nexport function createTrigger(\n    name: TriggerEnum,\n    store: Store,\n    engineService: EngineService,\n    cameraService: CameraService,\n    touch: boolean): Observable<any> {\n    switch (name) {\n        case TriggerEnum.CameraZoom:\n            return touch\n                ? createCameraZoomTrigger(engineService, cameraService)\n                : createUserCameraZoomTrigger(engineService, cameraService);\n        case TriggerEnum.CameraPan:\n            return createUserCameraPanTrigger(engineService, cameraService);\n        case TriggerEnum.CameraRotate:\n            return touch\n                ? createCameraRotateTrigger(engineService, cameraService)\n                : createUserCameraRotateTrigger(store, engineService, cameraService);\n        case TriggerEnum.NodeSelection:\n            return createNodeSelectionTrigger(store);\n        default:\n            break;\n    }\n}\n\nexport function createCameraZoomTrigger(\n    engineService: EngineService,\n    cameraService: CameraService,\n    throttle: number = 1000,\n    threshold: number = 0.001): Observable<any> {\n    return getCameraRested(engineService)\n        .pipe(\n            startWith(cameraService.getCameraZoom()),\n            map(() => cameraService.getCameraZoom()),\n            pairwise(),\n            map(([lastZoom, currentZoom]) => currentZoom - lastZoom),\n            filter((delta) => Math.abs(delta) > threshold),\n            debounceTime(throttle)\n        );\n}\n\nexport function createUserCameraZoomTrigger(\n    engineService: EngineService,\n    cameraService: CameraService,\n    throttle: number = 1000,\n    threshold: number = 0.001): Observable<any> {\n    const canvas = engineService.getCanvas();\n\n    // user events\n    const mouseWheel$ = fromEvent(canvas, 'wheel');\n    const touchMove$ = fromEvent(canvas, 'touchmove')\n        .pipe(\n            filter((e: TouchEvent) => e.touches.length === 2)\n        );\n\n    const zoomTrigger$ = createCameraZoomTrigger(engineService, cameraService, throttle, threshold);\n    \n    // combine mouse + touch events\n    return merge(\n        mouseWheel$,\n        touchMove$\n    )\n        .pipe(\n            // map to camera movement\n            flatMap(() => zoomTrigger$)\n        );\n}\n\nexport function createCameraRotateTrigger(\n    engineService: EngineService,\n    cameraService: CameraService,\n    throttle: number = 125): Observable<any> {\n    return getCameraRested(engineService)\n        .pipe(\n            startWith(cameraService.getLookDirection()),\n            map(() => cameraService.getLookDirection()),            \n            pairwise(),\n            map(([lastDirection, currentDirection]) => calcCameraRotating(lastDirection, currentDirection)),\n            filter((rotatating) => rotatating),\n            debounceTime(throttle)\n        );\n}\n\nexport function createUserCameraRotateTrigger(\n    store: Store,\n    engineService: EngineService,\n    cameraService: CameraService,\n    throttle: number = 1000):\n    Observable<any> {\n    const canvas = engineService.getCanvas();\n\n    // user events\n    const mouseMove$ = fromEvent(canvas, 'mousemove')\n        .pipe(\n            filter((e: MouseEvent) => e.buttons === 1)\n        );\n    const touchMove$ = fromEvent(canvas, 'touchmove')\n        .pipe(\n            filter((e: TouchEvent) => e.touches.length === 1)\n    );\n\n    const rotateTrigger$ = createCameraRotateTrigger(engineService, cameraService, throttle);\n\n    // combine mouse + touch events\n    return merge(\n        mouseMove$,\n        touchMove$\n    )\n        .pipe(\n            // map to camera movement\n            flatMap(() => rotateTrigger$),\n            filter(() => store.selectSnapshot(EngineCameraState.getPanMode) === 'rotate'),\n            debounceTime(125)\n        );\n}\n\nexport function createCameraPanTrigger(\n    engineService: EngineService,\n    cameraService: CameraService,\n    throttle: number = 125): Observable<any> {\n    return getCameraRested(engineService)\n        .pipe(\n            startWith(getCameraState(cameraService)),\n            map(() => getCameraState(cameraService)),\n            debounceTime(throttle),\n            pairwise(),\n            map(([lastCameraState, currentCameraState]) => calcCameraPanning(lastCameraState, currentCameraState)),\n            filter((panning) => panning)\n        );\n}\n\nexport function createUserCameraPanTrigger(\n    engineService: EngineService,\n    cameraService: CameraService,\n    throttle: number = 125): Observable<any> {\n    const canvas = engineService.getCanvas();\n\n    // user events\n    const mousePan = fromEvent(canvas, 'mousemove')\n        .pipe(\n            filter((e: MouseEvent) => {\n                return (e.buttons === 1 && e.shiftKey) // shift + left mouse\n                    || e.buttons === 2 // right mouse\n                    || e.buttons === 4; // aux (wheel)\n            })\n        );\n    const touchPan = fromEvent(canvas, 'touchmove')\n        .pipe(\n            filter((e: TouchEvent) => e.touches.length === 2)\n        );\n\n    const panTrigger$ = createCameraPanTrigger(engineService, cameraService, throttle);\n\n    // combine mouse + touch events\n    return merge(\n        mousePan,\n        touchPan\n    )\n        .pipe(\n            // map to camera movement\n            flatMap(() => panTrigger$)\n        );\n}\n\nexport function createNodeSelectionTrigger(store: Store): Observable<any> {\n    return store.select(EngineNodesState.getCheckedNodes)\n        .pipe(\n            pairwise(),\n            filter(([lastNodes, currentNodes]) => currentNodes.length > 0)\n        );\n}\n\nfunction getCameraState(cameraService: CameraService): CameraStateModel {\n    return {\n        camera: cameraService.getCamera(),\n        zoom: cameraService.getCameraZoom()\n    };\n}\n\nfunction getCameraRested(engineService: EngineService) {\n    return engineService.getEvent(EventsEnum.CameraRested);\n}\n\nfunction getEyeVector(camera: CameraModel) {\n    const { eye, look } = camera;\n    const eyeVec = [eye.x, eye.y, eye.z];\n    const lookVec = [look.x, look.y, look.z];\n    const outVec = vec3.create();\n    vec3.sub(outVec, eyeVec, lookVec);\n\n    return outVec;\n}\n\nfunction calcCameraRotating(lastDirection: [number, number, number], currentDirection: [number, number, number]): boolean {\n    const rotateTolerance = 0.001;\n    const rotateAngle = vec3.angle(lastDirection, currentDirection);\n    return rotateAngle > rotateTolerance;\n}\n\nfunction calcCameraPanning(lastCameraState: CameraStateModel, currentCameraState: CameraStateModel): boolean {\n    const panTolerance = 1;\n    const zoomTolerance =  0.001;\n    \n    const currentVec = getEyeVector(lastCameraState.camera);\n    const updatedVec = getEyeVector(currentCameraState.camera);\n\n    // Get 'look' -> 'eye' vector\n    const panVec = vec3.create();\n    vec3.sub(panVec, currentVec, updatedVec);\n\n    const panDelta = panVec\n        .reduce((sum, n) => sum + n);\n\n    const zoomDelta = currentCameraState.zoom - lastCameraState.zoom;\n\n    if (zoomDelta === 0 && panDelta === 0) {\n        return false;\n    } else {\n        return Math.abs(panDelta) < panTolerance\n            && Math.abs(zoomDelta) < zoomTolerance; // account for minute zoom on mobile (pinch to zoom)\n    }\n}\n","<div class=\"page\" *ngIf=\"shown\">\n    \n    <!-- slides -->\n    <div class=\"page__contents\">\n        <ng-content></ng-content>\n    </div>\n    \n</div>\n","import { Component, OnInit, ChangeDetectionStrategy, QueryList, Input, AfterViewInit, ContentChildren, OnDestroy, ChangeDetectorRef } from '@angular/core';\nimport { ViewTourSlideComponent } from '../view-tour-slide/view-tour-slide.component';\nimport { merge, Subject } from 'rxjs';\nimport { takeUntil } from 'rxjs/operators';\n\n@Component({\n  selector: 'app-view-tour-page',\n  templateUrl: './view-tour-page.component.html',\n  styleUrls: ['./view-tour-page.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class ViewTourPageComponent implements OnInit, AfterViewInit, OnDestroy {\n\n  @ContentChildren(ViewTourSlideComponent) slides: QueryList<ViewTourSlideComponent>;\n\n  @Input()\n  set shown(value: boolean) {\n    this._shown = value;\n    this.setSelectedSlide(0);\n  }\n  get shown(): boolean {\n    return this._shown;\n  }\n\n  private selectedSlideIndex = 0;\n  private _shown = false;\n  private ngUnsubscribe = new Subject();\n\n  constructor(private changeRef: ChangeDetectorRef) { }\n\n  ngOnInit() {\n  }\n\n  ngAfterViewInit() {\n    this.initListeners();\n\n    // update view\n    setTimeout(() => {\n      this.setSlideShown(this.selectedSlideIndex);\n    });    \n  }\n\n  ngOnDestroy() {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n  goToPrevSlide() {\n    this.setSelectedSlide(this.selectedSlideIndex - 1);\n  }\n\n  goToNextSlide() {\n    this.setSelectedSlide(this.selectedSlideIndex + 1);\n  }\n\n  setSelectedSlide(index: number) {\n    this.selectedSlideIndex = index;\n    // normalize range\n    if (this.slides) {\n      const slideCount = this.slides.length;\n      const targetIndex = Math.max(0,\n        Math.min(slideCount - 1, index)\n      );\n      this.selectedSlideIndex = targetIndex;\n    }\n    // update view\n    this.setSlideShown(this.selectedSlideIndex);\n  }\n\n  private initListeners() {\n    // navigate slides as they trigger completion\n    merge(\n      ...this.slides.map((slide) => slide.triggerComplete.asObservable())\n    )\n      .pipe(\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(() => {\n        this.goToNextSlide();\n      });\n  }\n\n  private setSlideShown(shownIndex: number) {\n    if (this.slides) {\n      this.slides.forEach((slide, slideIndex) => {\n        slide.shown = slideIndex === shownIndex;\n      });\n    }\n    this.changeRef.markForCheck();\n  }\n\n}\n","<div\n    gaCategory=\"View Tutorial\"\n    class=\"pages\"\n    [ngClass]=\"{'pages--opaquer': tutorial.pageIndex == tutorial.pageSize - 1}\"\n    *ngIf=\"tutorial$ | async; let tutorial\" >\n\n    <!-- exit -->\n    <button\n        gaEvent\n        gaAction=\"Clicked Exit Tutorial\"\n        app-pin-button\n        buttonType=\"dark\"\n        size=\"medium\"\n        icon=\"times\"\n        aria-label=\"Exit Tutorial\"\n        matTooltip=\"Exit Tutorial\"\n        matTooltipPosition=\"right\"\n        class=\"pages__close\"\n        (click)=\"handleExitClick()\">\n    </button>\n\n    <!-- pages -->\n    <div class=\"pages__contents\">\n        <ng-content></ng-content>\n    </div>\n\n    <!-- navigation -->\n    <div class=\"pages__footer\" *ngIf=\"tutorial.pageIndex < tutorial.pageSize - 1\">\n\n        <button\n            gaEvent\n            gaAction=\"Clicked Previous Tutorial Step\"\n            app-pin-button\n            buttonType=\"dark\"\n            size=\"large\"\n            icon=\"angle-left\"\n            aria-label=\"Previous Tutorial Step\"\n            matTooltip=\"Previous Tutorial Step\"\n            matTooltipPosition=\"left\"\n            class=\"pages__nav\"\n            [disabled]=\"tutorial.pageIndex < 1\"\n            (click)=\"handlePrevClick()\">\n        </button>\n\n        <div class=\"mh-8\">\n            {{ tutorial.pageIndex + 1 }} / {{ tutorial.pageSize }}\n        </div>\n\n        <button\n            gaEvent\n            gaAction=\"Clicked Next Tutorial Step\"\n            app-pin-button\n            buttonType=\"dark\"\n            size=\"large\"\n            icon=\"angle-right\"\n            aria-label=\"Next Tutorial Step\"\n            matTooltip=\" Next Tutorial Step\"\n            matTooltipPosition=\"right\"\n            class=\"pages__nav\"\n            [disabled]=\"tutorial.pageIndex === tutorial.pageSize -1\"\n            (click)=\"handleNextClick()\">\n        </button>\n        \n    </div>\n    \n</div>","import { Component, OnInit, ChangeDetectionStrategy, ContentChildren, QueryList, AfterViewInit, ChangeDetectorRef, OnDestroy } from '@angular/core';\nimport { ViewTourPageComponent } from '../view-tour-page/view-tour-page.component';\nimport { Select, Store } from '@ngxs/store';\nimport { ViewState } from 'src/app/view/state/view.state';\nimport { Observable, Subject } from 'rxjs';\nimport { TutorialStateModel } from 'src/app/view/models/tutorial-state.model';\nimport { ViewActions } from 'src/app/view/state/view.actions';\nimport { filter, takeUntil } from 'rxjs/operators';\nimport { ViewWindow } from 'src/app/view/models/view-window.enum';\nimport { GoogleAnalyticsService } from 'ngx-google-analytics';\n\n@Component({\n  selector: 'app-view-tour-pages',\n  templateUrl: './view-tour-pages.component.html',\n  styleUrls: ['./view-tour-pages.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class ViewTourPagesComponent implements OnInit, AfterViewInit, OnDestroy {\n\n  @ContentChildren(ViewTourPageComponent) pages: QueryList<ViewTourPageComponent>;\n\n  @Select(ViewState.getTutorial)\n  tutorial$: Observable<TutorialStateModel>;\n\n  private ngUnsubscribe = new Subject();\n  private index: number = null;\n\n  constructor(\n    private store: Store,\n    private changeRef: ChangeDetectorRef,\n    private ga: GoogleAnalyticsService\n  ) { }\n\n  ngOnInit() {\n  }\n\n  ngAfterViewInit() {\n    // handle page navigation\n    this.tutorial$\n      .pipe(\n        takeUntil(this.ngUnsubscribe),\n        filter(tutorial => tutorial != null && tutorial.pageSize > 0)\n      )\n      .subscribe((tutorial) => {\n        this.handleTutorialPages(tutorial);\n      });\n      \n    // init tour\n    this.store.dispatch(new ViewActions.SetTutorial({\n      pageSize: this.pages.length,\n      pageIndex: 0\n    }));\n  }\n\n  ngOnDestroy() {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n  handlePrevClick() {\n    this.store.dispatch(new ViewActions.TutorialPrevious());\n  }\n\n  handleNextClick() {\n    this.store.dispatch(new ViewActions.TutorialNext());\n  }\n\n  handleExitClick() {\n    this.store.dispatch(new ViewActions.ToggleWindow(ViewWindow.Tutorial, false));\n  }\n\n  private handleTutorialPages(tutorial: TutorialStateModel) {\n    this.pages.forEach((group, groupIndex) => {\n      group.shown = groupIndex === tutorial.pageIndex;\n    });\n\n    this.ga.event('Viewed Tutorial Step', 'View Tutorial', `Step ${tutorial.pageIndex + 1} of ${tutorial.pageSize}`);\n\n    this.changeRef.markForCheck();\n  }\n\n}\n","<div\n    @refresh\n    *ngIf=\"shown\"\n    class=\"slide\"\n    [class.slide--expanded]=\"spacing === 'expanded'\">\n\n    <h1 *ngIf=\"title\" class=\"slide__title\">\n        {{ title }}\n    </h1>\n\n    <article class=\"slide__content\">\n        <ng-content></ng-content>     \n    </article>\n\n    <img *ngIf=\"image\" [src]=\"image\" class=\"slide__image\">\n\n    <div class=\"slide__footer\">\n        <ng-content select=\"[slide-footer]\"></ng-content>\n    </div>\n    \n</div>\n","import { Component, OnInit, Input, ChangeDetectionStrategy, Output, EventEmitter, OnDestroy, AfterViewInit, ChangeDetectorRef } from '@angular/core';\nimport { TriggerEnum } from '../models/trigger.enum';\nimport { Subject, Observable } from 'rxjs';\nimport { Store, Actions, ofActionDispatched } from '@ngxs/store';\nimport { EngineService } from 'src/app/engine/engine.service';\nimport { CameraService } from 'src/app/engine/camera.service';\nimport { createTrigger } from '../utils/triggers';\nimport { delay, takeUntil, take, flatMap, skipUntil } from 'rxjs/operators';\nimport { trigger, transition, useAnimation } from '@angular/animations';\nimport { AnimationLib } from 'src/app/shared/libraries/animations/animation-lib';\nimport { StoryChaptersState } from 'src/app/story/state/chapters/story.chapters.state';\nimport { SetCamera, SetCameraSuccess } from 'src/app/engine/state/camera/engine.camera.actions';\nimport { ViewState } from 'src/app/view/state/view.state';\n\ndeclare const Human: any;\n\n@Component({\n  selector: 'app-view-tour-slide',\n  templateUrl: './view-tour-slide.component.html',\n  styleUrls: ['./view-tour-slide.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  animations: [\n    trigger('refresh', [\n      transition(':enter', [\n        useAnimation(AnimationLib.slideTransition, {\n          params: {\n            duration: 500,\n            from: 100,\n            to: 0\n          }\n        })\n      ])\n    ])\n  ]\n})\nexport class ViewTourSlideComponent implements OnInit, AfterViewInit, OnDestroy {\n\n  @Input()\n  title: string;\n\n  @Input()\n  image: string;\n\n  @Input()\n  spacing: 'compact' | 'expanded' = 'compact';\n\n  @Input()\n  set shown(value: boolean) {\n    this._shown = value;\n    this.initTrigger();\n    this.changeRef.markForCheck();\n  }\n  get shown(): boolean {\n    return this._shown;\n  }\n\n  @Input()\n  exitEnabled = true;\n\n  @Input()\n  trigger: TriggerEnum;\n\n  @Input()\n  triggerDelay = 300;\n\n  @Output()\n  triggerComplete = new EventEmitter();\n\n  private _shown = false;\n  private ngUnsubscribe = new Subject();\n\n  constructor(\n    private store: Store,\n    private actions: Actions,\n    private engineService: EngineService,\n    private cameraService: CameraService,\n    private changeRef: ChangeDetectorRef) { }\n\n  ngOnInit() {\n  }\n\n  ngAfterViewInit() {\n    this.initTrigger();\n  }\n\n  ngOnDestroy() {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n  private initTrigger() {\n    // clear any subscriptions\n    this.ngUnsubscribe.next();\n\n    // build trigger\n    if (this.shown && this.trigger) {\n\n      // reset camera before trigger\n      const resetCamera$ = this.resetCamera();\n\n      // get touch state\n      const touch = this.store.selectSnapshot(ViewState.getCanTouch);\n\n      // create trigger\n      createTrigger(this.trigger, this.store, this.engineService, this.cameraService, touch)\n        .pipe(\n          skipUntil(resetCamera$),\n          delay(this.triggerDelay),\n          takeUntil(this.ngUnsubscribe)\n        )\n        .subscribe(() => {\n          this.triggerComplete.next();\n        });\n    }\n  }\n\n  private resetCamera(): Observable<any> {\n    // manually reset to chapter camera\n    const chapter = this.store.selectSnapshot(StoryChaptersState.getSelectedChapter);\n    return this.store.dispatch(new SetCamera(chapter.camera.location, true))\n      .pipe(\n        flatMap(() => this.actions\n          .pipe(\n            ofActionDispatched(SetCameraSuccess)\n          )),\n        take(1)\n      );\n  }\n\n}\n","<div class=\"view-tour-success\" [class.view-tour-success--inline]=\"inline\">\n\n    <app-icon class=\"view-tour-success__icon\" icon=\"check\">\n    </app-icon>\n\n</div>\n","import { Component, OnInit, ChangeDetectionStrategy, ViewEncapsulation, Input } from '@angular/core';\n\n@Component({\n  selector: 'app-view-tour-success',\n  templateUrl: './view-tour-success.component.html',\n  styleUrls: ['./view-tour-success.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None\n})\nexport class ViewTourSuccessComponent implements OnInit {\n\n  @Input()\n  inline: boolean;\n\n  constructor() { }\n\n  ngOnInit() {\n  }\n\n}\n","<div class=\"view-tour-tip-button mv-1 mh-1\" [ngSwitch]=\"!!icon\">\n    \n    <!-- icon -->\n    <ng-container *ngSwitchCase=\"true\">\n        <app-icon *ngIf=\"icon\" [icon]=\"icon\"></app-icon>\n        <span *ngIf=\"icon\" class=\"visually-hidden\">{{ label }}</span>\n    </ng-container>\n\n    <!-- label -->\n    <span *ngSwitchDefault>\n        {{ label }}\n    </span>\n\n</div>","import { Component, OnInit, ChangeDetectionStrategy, Input, ViewEncapsulation } from '@angular/core';\n\n@Component({\n  selector: 'app-view-tour-tip-button',\n  templateUrl: './view-tour-tip-button.component.html',\n  styleUrls: ['./view-tour-tip-button.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None\n})\nexport class ViewTourTipButtonComponent implements OnInit {\n\n  @Input()\n  label: string;\n\n  @Input()\n  icon: string;\n\n  constructor() { }\n\n  ngOnInit() {\n  }\n\n}\n","<div\n    @refresh\n    gaCategory=\"View Tutorial\"\n    class=\"tour\"\n    [class.tour--started]=\"tourStarted\"\n    [class.tour--ended]=\"tourEnded\"\n    role=\"dialog\"\n    aria-label=\"Getting Started Tutorial\">\n\n    <!-- intro slide -->\n    <div class=\"tour__intro\" *ngIf=\"!tourStarted\">\n\n        <h1 class=\"tour__title\">Getting Started</h1>\n\n        <p class=\"tour__welcome\">\n            Welcome! This tutorial will teach you how to navigate and explore in 3D using your \n            \n            <button\n                app-view-rounded-button\n                buttonType=\"outline\"\n                icon=\"chevron-down\"\n                iconPlacement=\"right\"\n                [compact]=\"true\"\n                [label]=\"inputModesText[inputMode$ | async]\"\n                [attr.aria-label]=\"inputModesText[inputMode$ | async]\"\n                class=\"tour__input-selection text-small\"\n                [matMenuTriggerFor]=\"inputSelectionMenu\">                \n            </button>\n\n            <mat-menu #inputSelectionMenu=\"matMenu\">\n                <button\n                    gaEvent\n                    gaAction=\"Clicked Input Type\"\n                    [gaLabel]=\"inputModesText[inputModes.Mouse]\"\n                    mat-menu-item\n                    (click)=\"handleSelectInputModeClick(inputModes.Mouse)\">\n                    {{ inputModesText[inputModes.Mouse] }}\n                </button>\n                <button\n                    gaEvent\n                    gaAction=\"Clicked Input Type\"\n                    [gaLabel]=\"inputModesText[inputModes.Touch]\"\n                    mat-menu-item\n                    (click)=\"handleSelectInputModeClick(inputModes.Touch)\">\n                    {{ inputModesText[inputModes.Touch] }}\n                </button>\n            </mat-menu>\n\n        </p>                \n\n        <div class=\"tour__footer\">\n            <button\n                gaEvent\n                gaAction=\"Clicked No Thanks\"\n                app-view-rounded-button \n                buttonType=\"outline\"\n                label=\"No, Thanks.\"\n                aria-label=\"Exit Tutorial\"\n                class=\"mr-3 text-medium\"\n                (click)=\"handleExitClick()\">\n            </button>\n\n            <button\n                gaEvent\n                gaAction=\"Clicked Start Tutorial\"\n                app-view-rounded-button\n                buttonType=\"solid\"\n                label=\"Start Tutorial\"\n                aria-label=\"Start Tutorial\"\n                class=\"ml-3 text-medium\"\n                (click)=\"handleStartClick()\">\n            </button>\n\n        </div>\n    </div> \n\n    <!-- tour slides -->\n    <div class=\"tour__contents\" *ngIf=\"tourStarted\" [ngSwitch]=\"inputMode$ | async\">\n        <app-view-tour-mobile *ngSwitchCase=\"inputModes.Touch\"></app-view-tour-mobile>\n        <app-view-tour-desktop *ngSwitchDefault></app-view-tour-desktop>            \n    </div>\n</div>","import { Component, OnInit, ChangeDetectionStrategy, AfterViewInit, OnDestroy } from '@angular/core';\nimport { Select, Store } from '@ngxs/store';\nimport { ViewState } from '../../state/view.state';\nimport { Observable, Subject, fromEvent } from 'rxjs';\nimport { trigger, transition, useAnimation } from '@angular/animations';\nimport { AnimationLib } from 'src/app/shared/libraries/animations/animation-lib';\nimport { ViewService } from '../../view.service';\nimport { TutorialStateModel } from '../../models/tutorial-state.model';\nimport { ViewActions } from '../../state/view.actions';\nimport { takeUntil, filter } from 'rxjs/operators';\nimport { StorageService, StorageItemEnum } from 'src/app/shared/storage.service';\nimport { ViewInputModeEnum } from '../../models/view-input-mode.enum';\n\ninterface ViewInputModeTextMap {\n  [ViewInputModeEnum.Mouse]: string;\n  [ViewInputModeEnum.Touch]: string;\n}\n\nconst inputModesText: ViewInputModeTextMap = {\n  [ViewInputModeEnum.Mouse]: 'mouse, trackpad, or keyboard',\n  [ViewInputModeEnum.Touch]: 'touchscreen'\n};\n\n@Component({\n  selector: 'app-view-tour',\n  templateUrl: './view-tour.component.html',\n  styleUrls: ['./view-tour.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  animations: [\n    trigger('refresh', [\n      transition(':enter', [\n        useAnimation(AnimationLib.slideTransition, {\n          params: {\n            duration: 500,\n            from: 100,\n            to: 0\n          }\n        })\n      ])\n    ])\n  ]\n})\nexport class ViewTourComponent implements OnInit, AfterViewInit, OnDestroy {\n  inputModes = ViewInputModeEnum;\n  inputModesText = inputModesText;\n\n  @Select(ViewState.getTutorial)\n  tutorial$: Observable<TutorialStateModel>;\n\n  @Select(ViewState.getInputMode)\n  inputMode$: Observable<ViewInputModeEnum>;\n\n  tourStarted = false;\n  tourEnded = false;\n\n  private ngUnsubscribe = new Subject();\n\n  constructor(\n    private store: Store,\n    private viewService: ViewService,\n    private storageService: StorageService) {\n  }\n\n  ngOnInit() {\n    this.initListeners();\n\n    // mark viewed\n    this.store.dispatch(new ViewActions.TutorialSeen(true));\n  }\n\n  ngAfterViewInit() {\n  }\n\n  ngOnDestroy() {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n  initListeners() {\n    this.tutorial$\n      .pipe(\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(({ pageIndex, pageSize }) => {\n        this.tourStarted = pageIndex > -1;\n        this.tourEnded = pageIndex === pageSize - 1;\n      });\n\n    // ESC key to exit\n    fromEvent(window, 'keyup')\n      .pipe(\n        filter((event: KeyboardEvent) => event.key === 'Escape'),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(() => {\n        this.exit();\n      });\n  }\n\n  handleExitClick() {\n    this.exit();\n  }\n\n  handleStartClick() {\n    this.store.dispatch(new ViewActions.StartTutorial(false));\n  }\n\n  handleSelectInputModeClick(mode: ViewInputModeEnum) {\n    this.store.dispatch(new ViewActions.SetInputMode(mode));\n  }\n\n  exit() {\n    this.viewService.toggleTutorial(false);\n  }\n}\n","<div\nclass=\"view-undo\"\n*ngIf=\"(canUndo$ | async)\"\n@show>\n    <app-pillbox padding=\"dense\">\n        <button \n        (click)=\"handleUndoClick()\"\n        app-pin-button\n        data-test=\"undo-btn\"\n        [attr.aria-disabled]=\"!(canUndo$ | async)\"\n        [disabled]=\"!(canUndo$ | async)\"\n        buttonType=\"ghost\"\n        class=\"mr-2\"\n        icon=\"undo\"\n        aria-label=\"Undo\"\n        matTooltip=\"Undo\"\n        ></button>\n        \n        <button\n        type=\"ghost\"\n        app-pin-button\n        class=\"mr-2\"\n        data-test=\"redo-btn\"\n        [attr.aria-disabled]=\"!(canRedo$ | async)\"\n        [disabled]=\"!(canRedo$ | async)\"\n        matTooltip=\"Redo\"\n        icon=\"redo\"\n        (click)=\"handleRedoClick()\">\n        </button>\n\n        <button\n        app-pin-button\n        buttonType=\"ghost\"\n        [attr.aria-disabled]=\"!(canUndo$ | async)\"\n        [disabled]=\"!(canUndo$ | async)\"\n        (click)=\"handleResetClick()\">\n        <span class=\"ph-4 text-bold\">Reset</span>\n        </button>\n    </app-pillbox>\n</div>\n","import { Component, OnInit, ChangeDetectionStrategy } from '@angular/core';\nimport { ViewService } from '../../view.service';\nimport { Select } from '@ngxs/store';\nimport { UndoState } from 'src/app/undo/state/undo.state';\nimport { Observable } from 'rxjs';\nimport { trigger, transition, style, animate, sequence } from '@angular/animations';\n\n@Component({\n  selector: 'app-view-undo',\n  templateUrl: './view-undo.component.html',\n  styleUrls: ['./view-undo.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  animations: [\n    trigger('show', [ \n      transition(':enter', \n        sequence([\n          style({\n            transform: `translateY(-100%)`,\n            opacity: 0\n          }),\n          animate('150ms ease-in-out', style({ \n            transform: `translateY(0%)`,\n            opacity: 1\n          }))\n        ])\n      )\n      ])]\n})\nexport class ViewUndoComponent implements OnInit {\n  @Select(UndoState.canUndo)\n  canUndo$: Observable<boolean>;\n\n  @Select(UndoState.canRedo)\n  canRedo$: Observable<boolean>;\n\n  @Select(UndoState.getUndoCount)\n  undoCount$: Observable<number>;\n\n  constructor(\n    private viewService: ViewService\n  ) { }\n\n  ngOnInit() {\n\n  }\n\n  handleUndoClick() {\n    this.viewService.undo();\n  }\n\n  handleRedoClick() {\n    this.viewService.redo();\n  }\n\n  handleResetClick() {\n    this.viewService.resetChapter();\n  }\n}\n","export enum HelpTypeEnum {\n  Basics,\n  All,\n  Shortcuts\n}\n","export enum InteractTypeEnum {\n  Play = 'play',\n  Button = 'button',\n  Hand = 'hand'\n}\n","export enum ViewInputModeEnum {\n  Mouse = 'mouse',\n  Touch = 'touch'\n}\n","export enum ViewLayout {\n    Default,\n    DrawerOnly = 'drawer'\n}\n","export enum ViewLoaderEnum {\n    None = 'none',\n    Circle = 'circle',\n    Bar = 'bar'\n}\n","export enum ViewMode {\n  Content,\n  Label,\n  Tools,\n  Search,\n  Help,\n  NodeInfo,\n  LabelInfo\n}\n","export enum ViewToolsMode {\n  Main,\n  Media,\n  Tools,\n  Whiteboard,\n  VisibilityLayers,\n  Empty\n}\n","export enum ViewUIStatus {\n  Hide = 'hide',\n  Show = 'show',\n  Collapse = 'collapse'\n}\n","export enum ViewUI {\n  // Left description panel, visible on desktop mode\n  Column = 'column',\n\n  // Left description panel, visible on desktop mode\n  ColumnToggle = 'column-toggle',\n    \n  // Bottom description panel, visible at 960 below\n  Drawer = 'drawer',\n\n  // Floating title in top left\n  TitleOnly = 'title-only',\n  \n  // tool bar button in menu\n  Tools = 'tools',\n\n  // Interaction tools, visible in drawer when responsive, floating on the scene in desktop\n  Toolbar = 'toolbar',\n  \n  // Camera controls - zoom, pan, reset\n  Camera = 'camera',\n  \n  // Play, pause, scrubber\n  Media = 'media',\n\n  // Free floating play, pause, scrubber, audio controls\n  Mediabar = 'mediabar',\n\n  // reset button\n  Reset = 'reset',\n\n  // audio controls\n  Audio = 'audio',\n  \n  // White menu button and child items, visible at 960 below\n  Menu = 'menu',\n  \n  // Pagination bar, visible when drawer is swiped up and other places\n  Pagination = 'pagination',\n\n  // fullscreen button\n  Fullscreen = 'fullscreen',\n\n  // help button\n  Help = 'help',\n\n  // content description\n  Description = 'description',\n\n  // wikipedia descriptions\n  NodeInfo = 'nodeInfo',\n\n  // search (anatomy tree) button\n  Search = 'search',\n\n  // presenter button\n  Presenter = 'presenter',\n  \n  // BioDigital logo\n  Logo = 'logo',\n\n  // List of labels in column\n  LabelList = 'labelList',\n\n  // List of chapters in column\n  ChapterList = 'chapterList',\n\n  // anatomy node context label\n  AnatomyLabels = 'anatomyLabels',\n\n  // regular labels\n  Labels = 'labels',\n\n  // getting started tour\n  Tutorial = 'tutorial',\n\n  // Internet explorer warning\n  InternetExplorerWarning = 'internetExplorerWarning',\n\n  // Layout\n  Layout = 'layout',\n\n  // Content legend\n  Legend = 'legend',\n\n  // Loader\n  Loader = 'loader',\n\n  // 2D Annotate\n  Undo = 'undo',\n\n  // 2D Annotate\n  Whiteboard = 'whiteboard',\n\n  // Layers\n  VisibilityLayers = 'visibilityLayers',\n\n  // Context Actions\n  ContextActions = 'contextActions'\n}\n","import { ViewUIStatus } from './view-ui-status.enum';\nimport { MediaEnum } from 'src/app/story/models/media.enum';\nimport { ViewLoaderEnum } from './view-loader.enum';\n\nexport class UIDefault {\n  constructor (\n    public status: ViewUIStatus = ViewUIStatus.Hide,\n    public enable = true\n    ) {}\n}\n\nexport class LogoUI extends UIDefault {\n  constructor(\n    public isHyperLink = true\n  ) {\n    super();\n  }\n}\n\nexport class DrawerUI extends UIDefault {\n  constructor(\n    public isExpandedInitially = false\n  ) {\n    super();\n  }\n}\n\nexport class MediaUI extends UIDefault {\n  constructor(\n    public template: MediaEnum = MediaEnum.Small\n  ) {\n    super();\n  }\n}\n\nexport class LoaderUI extends UIDefault {\n  constructor(\n    public template: ViewLoaderEnum = ViewLoaderEnum.Bar\n  ) {\n    super();\n  }\n}\n\n\nexport class ViewUIModel {\n  audio: UIDefault;\n  camera: UIDefault;\n  chapterList: UIDefault;\n  column: UIDefault;\n  description: UIDefault;\n  drawer: DrawerUI;\n  fullscreen: UIDefault;\n  help: UIDefault;\n  labelInfo: UIDefault;\n  labelList: UIDefault;\n  labels: UIDefault;\n  loader: LoaderUI;\n  logo: LogoUI;\n  media: MediaUI;\n  menu: UIDefault;\n  nodeInfo: UIDefault;\n  pagination: UIDefault;\n  presenter: UIDefault;\n  reset: UIDefault;\n  search: UIDefault;\n  titleOnly: UIDefault;\n  toolbar: UIDefault;\n  tools: UIDefault;\n  anatomyLabels: UIDefault;\n  tutorial: UIDefault;\n  internetExplorerWarning: UIDefault;\n  legend: UIDefault;\n  undo: UIDefault;\n  whiteboard: UIDefault;\n  visibilityLayers: UIDefault;\n  contextActions: UIDefault;\n}\n","// In sequence\nexport enum ViewWindow {\n    Interact, // Optional\n    Loader,\n    Tutorial, // Optional\n    Whiteboard, // Optional\n    Help\n}\n","export enum WhiteboardAnnotateMode {\n  Text,\n  Paint\n}\n\nexport class WhiteboardStateModel {\n  enabled: boolean;\n  brushSize: number;\n  brushColor: string;\n  textSize: number;\n  annotateMode: WhiteboardAnnotateMode;\n}\n","<div #viewContainer>\n  <div class=\"view-page\" [ngClass]=\"{\n      'view-page--column-in': isVisible(viewUI.Column),\n      'view-page--column-out': !isVisible(viewUI.Column), \n      'view-page--drawer-push': isVisible(viewUI.Drawer)\n    }\"\n    #view>\n\n    <!-- Columns -->\n    <app-view-column-container *ngIf=\"isVisible(viewUI.Column) || isVisible(viewUI.Search) || isVisible(viewUI.NodeInfo)\"></app-view-column-container>\n\n    <app-view-menu-column></app-view-menu-column>\n\n    <!-- Title Only -->\n    <div class=\"view-page__title-only\" *ngIf=\"isVisible(viewUI.TitleOnly) && (chapter$ | async)?.info.displayName\">\n      <app-view-title layout=\"column\"></app-view-title>\n    </div>\n\n    <!-- Engine -->\n    <div class=\"view-page__engine\" #engineContainer>\n\n      <!-- Currently hardcoded to tutorial, may need to extend later -->\n      <div class=\"view-page__notifications\" *ngIf=\"(selectedChapterReady$ | async)?.model && !(tutorialSeen$ | async)\">\n        <app-notification [notification]=\"notification\" (closeClick)=\"handleNotificationClose($event)\"></app-notification>\n      </div>\n\n\n      <div class=\"view-page__undo\" *ngIf=\"isVisible(viewUI.Undo)\">\n        <app-view-undo></app-view-undo>\n      </div>\n\n      <!-- Column toggle -->\n      <div class=\"view-page__column-toggle\">\n        <app-view-column-toggle></app-view-column-toggle>\n      </div>\n      \n      <div class=\"view-page__scene-base\" #viewSceneBase>\n        <!-- Toolbar -->\n        <div class=\"view-page__toolbar\" #viewToolbar>\n          <app-view-toolbar position=\"right\" *ngIf=\"isVisible(viewUI.Toolbar)\"></app-view-toolbar>\n        </div>\n\n        <!-- Menu -->\n        <div class=\"view-page__menu\" *ngIf=\"isVisible(viewUI.Menu)\">\n          <app-view-menu class=\"ml-4\"></app-view-menu>\n        </div>\n        \n        <!-- Logo -->\n        <div class=\"view-page__logo\" *ngIf=\"isVisible(viewUI.Logo)\">\n          <app-view-logo\n            [logoColor]=\"isBackgroundLight ? 'color' : 'white'\"\n            [logoSize]=\"(breakpoint$ | async) > breakpoint.Small ? 'full' : 'small'\"\n          ></app-view-logo>\n        </div>\n        \n        <!-- Camera Bar -->\n        <div class=\"view-page__camera-bar\" #viewCameraBar>\n          <app-engine-camera-bar\n            *ngIf=\"isVisible(viewUI.Camera)\" \n            [showNav]=\"isVisible(viewUI.Camera)\">\n          </app-engine-camera-bar>\n        </div>\n      </div>\n\n\n      <!-- Drawer -->\n      <ng-container *ngIf=\"isVisible(viewUI.Drawer)\">\n        <app-view-drawer \n          #drawer\n          (atMinimumChange)=\"handleDrawerMinimumChange($event)\"\n          (offsetYChange)=\"handleDrawerOffsetChange($event)\"></app-view-drawer>\n      </ng-container>\n    </div>\n  </div>\n</div>\n\n<!-- Input blocker -->\n<div class=\"view-block-input\" *ngIf=\"!(inputEnabled$ | async)\"></div>\n\n<!-- Help -->\n<app-view-help *ngIf=\"(viewWindow$ | async) === viewWindow.Help\" [activeTab]=\"showHelpTab$ | async\"></app-view-help>\n\n<!-- Loading Progress -->\n<app-view-progress\n  *ngIf=\"(layout$ | async)?.loader.template === 'circle'\"\n  [show]=\"(viewWindow$ | async) === viewWindow.Loader\"\n  [percent]=\"loadProgress\"></app-view-progress>\n\n<!-- Loading Experience -->\n<app-view-loader *ngIf=\"(viewWindow$ | async) === viewWindow.Interact\">\n  <!-- Loader: Play -->\n  <app-play-loader *ngIf=\"(interactType$ | async) === 'play'\" [percent]=\"loadProgress\"></app-play-loader>\n\n  <!-- Loader: Button -->\n  <app-button-loader *ngIf=\"(interactType$ | async) === 'button'\"></app-button-loader>\n\n  <!-- Loader: Click to Interact -->\n  <app-hand-loader *ngIf=\"(interactType$ | async) === 'hand'\"></app-hand-loader>\n</app-view-loader>\n\n<!-- Getting Started Tutorial -->\n<app-view-tour *ngIf=\"(viewWindow$ | async) === viewWindow.Tutorial\">\n</app-view-tour>\n\n<app-view-annotate *ngIf=\"(viewWindow$ | async) === viewWindow.Whiteboard\"></app-view-annotate>\n\n<!-- Print Image -->\n<app-view-print *ngIf=\"usePrintImage$ | async\"></app-view-print>","import {\n  Component,\n  OnInit,\n  OnDestroy,\n  ViewChild,\n  ElementRef,\n  AfterViewInit,\n  Renderer2,\n  ChangeDetectionStrategy,\n  ChangeDetectorRef,\n  ViewEncapsulation\n} from '@angular/core';\nimport { Store, Select, Actions, ofActionDispatched, ofActionCompleted } from '@ngxs/store';\nimport { ActivatedRoute } from '@angular/router';\nimport { Subject, Observable, combineLatest, fromEvent, merge } from 'rxjs';\nimport { ViewService } from '../../view.service';\nimport { EnginePositionModel } from 'src/app/engine/models/engine-position.model';\nimport { EngineVisibilityEnum } from 'src/app/engine/models/engine-visibility.enum';\nimport {\n  SetEnginePosition,\n  ClickNode,\n  SetDisplay,\n  SetVisible,\n  SetAutoplay,\n  ToggleProgressBar,\n  PlayAudio,\n  SetActiveTool,\n  ToggleLabels,\n} from 'src/app/engine/state/engine.actions';\nimport { ViewState } from '../../state/view.state';\nimport { takeUntil, map, filter, debounceTime, pairwise, take } from 'rxjs/operators';\nimport { ViewActions } from '../../state/view.actions';\nimport { ViewUIStatus } from '../../models/view-ui-status.enum';\nimport { ViewUIModel } from '../../models/view-ui.model';\nimport { ToolEnum } from 'src/app/engine/models/tool.enum';\nimport { StoryChaptersState } from 'src/app/story/state/chapters/story.chapters.state';\nimport { ViewMode } from '../../models/view-mode.enum';\nimport * as Mousetrap from 'mousetrap';\nimport * as resizeDetectorMaker from 'element-resize-detector';\nimport { Fullscreen } from 'src/app/shared/libraries/fullscreen/fullscreen';\nimport { EngineProgressState } from 'src/app/engine/state/progress/engine.progress.state';\nimport { SetLabelsCollapsed, SetLabelsDraggable, EnableContextLabel } from 'src/app/story/state/labels/story.labels.actions';\nimport { StoryLabelsState } from 'src/app/story/state/labels/story.labels.state';\nimport { ViewToolsMode } from '../../models/view-tools-mode.enum';\nimport { InteractTypeEnum } from '../../models/interact-type.enum';\nimport { isNil, get } from 'lodash';\nimport { ViewUIService } from '../../view-ui.service';\nimport { ViewUI } from '../../models/view-ui.enum';\nimport { ViewDrawerComponent } from '../../components/view-drawer/view-drawer.component';\nimport { LabelCollapseModeEnum } from 'src/app/story/models/labels/label-collapse-mode';\nimport { SetProgress } from 'src/app/engine/state/progress/engine.progress.actions';\nimport { EngineService } from 'src/app/engine/engine.service';\nimport { EventsEnum } from 'src/app/engine/models/events.enum';\nimport { TestSelectors } from 'e2e/selectors/test-selectors';\nimport { BreakpointState } from 'src/app/breakpoint/state/breakpoint.state';\nimport { Breakpoint } from 'src/app/breakpoint/models/breakpoint.enum';\nimport { ChapterModel } from 'src/app/story/models/chapter.model';\nimport { ViewWindow } from '../../models/view-window.enum';\nimport { StoryState } from 'src/app/story/state/story.state';\nimport { EngineNodesState } from 'src/app/engine/state/nodes/engine.nodes.state';\nimport { Title } from '@angular/platform-browser';\nimport { ViewLoaderEnum } from '../../models/view-loader.enum';\nimport { BackgroundModel } from 'src/app/engine/models/background.model';\nimport { ColorUtils } from 'src/app/shared/libraries/colors/colors';\nimport { ViewInputModeEnum } from '../../models/view-input-mode.enum';\nimport { NotificationModel } from 'src/app/shared/features/notification/notification.model';\nimport { StorageItemEnum, StorageService } from 'src/app/shared/storage.service';\nimport { ChapterReadyStateModel } from 'src/app/story/models/chapter-ready-state.model';\nimport { ErrorService } from 'src/app/shared/error.service';\nimport { LoadStoryChunkSuccess } from 'src/app/story/state/story.actions';\nimport { LayoutState } from 'src/app/layout/state/layout.state';\nimport { environment } from 'src/environments/environment';\nimport { EnvironmentApplication } from 'src/environments/models/environment-application';\n\nconst drawerHeight = 64;\n\n@Component({\n  selector: 'app-view-page',\n  templateUrl: './view-page.component.html',\n  styleUrls: ['./view-page.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None\n})\nexport class ViewPageComponent implements OnInit, AfterViewInit, OnDestroy {\n  // ---------- Child Elements ----------\n  @ViewChild('engineContainer', { static: true })\n  engineContainer: ElementRef;\n\n  @ViewChild('viewContainer', { static: true })\n  viewContainer: ElementRef;\n\n  @ViewChild('view', { static: true })\n  view: ElementRef;\n\n  @ViewChild('viewCameraBar', { static: false })\n  viewCameraBar: ElementRef;\n\n  @ViewChild('viewLogo', { static: false })\n  viewLogo: ElementRef;\n\n  @ViewChild('viewSceneBase', { static: true })\n  viewSceneBase: ElementRef;\n\n  @ViewChild('viewToolbar', { static: false })\n  viewToolbar: ElementRef;\n\n  @ViewChild('drawer', { static: false, read: ViewDrawerComponent })\n  drawer: ViewDrawerComponent;\n\n\n\n  // ---------- Observables ----------\n  @Select(ViewState.getUI)\n  layout$: Observable<ViewUIModel>;\n\n  @Select(ViewState.getInputEnabled)\n  inputEnabled$: Observable<boolean>;\n\n  @Select(ViewState.getFullscreenActive)\n  fullscreenActive$: Observable<boolean>;\n\n  @Select(ViewState.getDrawerCoversContent)\n  drawerCoversContent$: Observable<boolean>;\n\n  @Select(ViewState.getInteractType)\n  interactType$: Observable<InteractTypeEnum>;\n  \n  @Select(ViewState.getShowHelpTab)\n  showHelpTab$: Observable<string>;\n\n  @Select(ViewState.getUsePrintImage)\n  usePrintImage$: Observable<boolean>;\n\n  @Select(ViewState.getOpenWindow)\n  viewWindow$: Observable<ViewWindow>;\n\n  @Select(ViewState.getTutorialSeen)\n  tutorialSeen$: Observable<Boolean>;\n\n  @Select(EngineProgressState.getStoryLoadProgress)\n  loadProgress$: Observable<number>;\n\n  @Select(BreakpointState.getBreakpoint)\n  breakpoint$: Observable<Breakpoint>;\n\n  @Select(StoryChaptersState.getSelectedChapter)\n  chapter$: Observable<ChapterModel>;\n\n  @Select(StoryChaptersState.getSelectedChapterReadyState)\n  selectedChapterReady$: Observable<ChapterReadyStateModel>;\n\n  @Select(StoryChaptersState.getChaptersLoaded)\n  chaptersLoaded$: Observable<any>;\n\n  @Select(StoryChaptersState.getSelectedChapterBackground)\n  background$: Observable<BackgroundModel>;\n  \n  @Select(StoryChaptersState.getSelectedChapterAudio)\n  audio$: Observable<boolean>;\n\n\n  // ---------- Class Variables ----------\n  breakpoint = Breakpoint;\n  viewLayoutStatus = ViewUIStatus;\n  viewMode = ViewMode;\n  viewUI = ViewUI;\n  viewWindow = ViewWindow;\n  columnLayoutStatus = ViewUIStatus.Hide;\n  drawerExpandable = true;\n  drawerOpen = false;\n  drawerY = 0;\n  loadLabel = '';\n  loadProgress = 0;\n  chaptersLoaded = 0;\n  isBackgroundLight = true;\n  selectedChapterLoading = false;\n  viewToolsMode = ViewToolsMode;\n  testSelectors = TestSelectors;\n  notification: NotificationModel;\n  \n  private ngUnsubscribe = new Subject();\n  private audioListening = new Subject();\n\n\n  // ---------- Lifecycle hooks ----------\n  constructor(\n    private activatedRoute: ActivatedRoute,\n    private renderer: Renderer2,\n    private store: Store,\n    private viewService: ViewService,\n    private changeDetectorRef: ChangeDetectorRef,\n    private actions: Actions,\n    private layoutService: ViewUIService,\n    private engineService: EngineService,\n    private storageService: StorageService,\n    private title: Title,\n    private errorService: ErrorService\n  ) { }\n\n  ngOnInit() {\n    // Reset scene visibility so we don't see a FOUC of the last scene\n    // This must happen before any meaningful browser render\n    this.resetScene();\n\n    // Load content.\n    const queryParams = this.viewService.normalizeQueryParams(this.activatedRoute.snapshot.queryParams);\n    this.viewService.initStory(queryParams.id, queryParams.type, queryParams.lang);\n  }\n\n  ngAfterViewInit() {\n    this.store.dispatch(new SetLabelsDraggable({\n      tag: true,\n      pin: false\n    }));\n\n    // Enable autoplay animations\n    this.store.dispatch(new SetAutoplay(true));\n\n    // Hide engine progress bar\n    const showBar = this.store.selectSnapshot(ViewState.getUI).loader.template === ViewLoaderEnum.Bar;\n    this.store.dispatch(new ToggleProgressBar(showBar));\n\n    this.checkCapabilities();\n    this.initSizeObservers();\n    this.initHeaderObserver();\n    this.initLayoutObserver();\n    this.initBreakpointObservers();\n    this.initKeyboardObserver();\n    this.initLoadProgressObserver();\n    this.initWindowObserver();\n    this.initBackgroundColorObserver();\n    this.initResponsiveLabels();\n    this.initNodeObserver();\n    this.initChapterObserver();\n    this.initAudioObserver();\n    this.initNotifications();\n\n    this.positionRelativeElements(this.drawerY);\n  }\n\n  ngOnDestroy() {\n    this.store.dispatch(new SetDisplay(false));\n    // this.store.dispatch(new NodeActions.ResetEngineNodesLegacy());\n    this.store.dispatch(new SetProgress(0, 0));\n\n    if (Fullscreen.isFullscreen()) {\n      Fullscreen.exitFullscreen();\n    }\n\n    this.unbindKeyboard();\n\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n\n\n  // ---------- Capability detection ----------\n  checkCapabilities() {\n    const mouseOver = this.renderer.listen('window', 'mouseover', () => {\n      const canHover = true;\n      mouseOver();\n\n      this.store.dispatch(new ViewActions.SetCanHover(canHover));\n    });\n\n    const canTouch = (('ontouchstart' in window)\n      || (navigator.maxTouchPoints > 0)\n      || (navigator.msMaxTouchPoints > 0));\n\n    this.store.dispatch(new ViewActions.SetCanTouch(canTouch));\n    this.store.dispatch(new ViewActions.SetCanFullscreen(Fullscreen.canFullscreen()));\n\n    // set default input mode\n    this.store.dispatch(new ViewActions.SetInputMode(canTouch ? ViewInputModeEnum.Touch : ViewInputModeEnum.Mouse));\n  }\n\n\n\n  // ---------- Listeners ----------\n  initBreakpointObservers() {\n    this.breakpoint$\n      .pipe(\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(() => {\n        this.handleResize();\n      });\n  }\n\n  initResponsiveLabels() {\n    // observer: window size change (throttle)\n    const windowResize$ = fromEvent(window, 'resize')\n      .pipe(debounceTime(100));\n\n    // observe: breakpoint changes\n    const labelBreakpoint$ = this.store.select(ViewState.getLabelsBreakpoint);\n\n    // observe: label selection/de-selection\n    const labelSelected$ = this.store.select(StoryLabelsState.getSelectedLabel);\n\n    // observe: label collapse state\n    const labelsCollapsed$ = this.store.select(StoryLabelsState.getLabelsCollapsed);\n\n    // set: label info on selection\n    labelSelected$\n      .pipe(\n        // ignore if not collapsed\n        filter(() => this.store.selectSnapshot(StoryLabelsState.getLabelsCollapsed)),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe((label) => {\n        if (label) {\n          this.viewService.toggleLabelInfo(true);\n        } else {\n          this.viewService.toggleLabelInfo(false);\n        }\n      });\n\n    // set: label info on collapse\n    labelsCollapsed$\n      .pipe(\n        // validate selected label\n        filter(() => !!this.store.selectSnapshot(StoryLabelsState.getSelectedLabel)),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe((collapsed) => {\n        this.viewService.toggleLabelInfo(collapsed);\n      });\n\n    // combine various label breakpoint triggers\n    combineLatest(\n      windowResize$,\n      labelBreakpoint$\n    )\n      .pipe(\n        // ignore unless breakpoint enabled\n        filter(([, labelBreakpoint]) => !isNil(labelBreakpoint)),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(() => {\n        this.checkLabelsCollapsed();\n      });\n\n    // set initial\n    this.checkLabelsCollapsed();\n  }\n\n  initSizeObservers() {\n    const resizeDetector = resizeDetectorMaker({ strategy: 'scroll' });\n\n    // Listen to view page resize\n    const windowResize$ = fromEvent(window, 'resize');\n    windowResize$\n      .pipe(\n        debounceTime(10),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(() => {\n        this.updateViewHeight();\n      });\n\n    // Listen to engine container resize\n    const engineResize$ = new Observable(subscriber => {\n      resizeDetector.listenTo(this.engineContainer.nativeElement, () => {\n        subscriber.next();\n      });\n    });\n\n    engineResize$\n      .pipe(\n        debounceTime(10)\n      )\n      .subscribe(() => {\n        this.resizeEngineContainer();\n      });\n  }\n\n  initHeaderObserver() {\n    this.store.select(LayoutState.getSiteHeader)\n      .pipe(\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe((header) => {\n        this.updateViewHeight();\n      });\n  }\n\n  initLayoutObserver() {\n    this.layout$\n      .pipe(\n        filter(layout => layout != null),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe((layout) => {\n        this.refreshLayout();\n      });\n  }\n\n  initKeyboardObserver() {\n    this.inputEnabled$.pipe(\n      takeUntil(this.ngUnsubscribe)\n    ).subscribe(enabled => {\n      (enabled) ? this.bindKeyboard() : this.unbindKeyboard();\n    });\n  }\n\n  initNodeObserver() {\n    this.actions\n      .pipe(\n        ofActionDispatched(ClickNode),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe((action: ClickNode) => {\n        this.viewService.delegateNodeClick(action.node, action.event);\n      });\n    \n    this.store.select(EngineNodesState.getSelectedNode).pipe(\n      pairwise(),\n      takeUntil(this.ngUnsubscribe)\n    ).subscribe(([lastSelected, currentSelected]) => {\n      \n      const lastSelectedId = get(lastSelected, 'objectId', undefined);\n      const currentSelectedId = get(currentSelected, 'objectId', undefined);\n\n      if (currentSelected === undefined || lastSelectedId !== currentSelectedId) {\n        this.viewService.toggleNodeInfo(false);\n      }\n    });\n  }\n\n  initChapterObserver() {\n    // Chapter change\n    this.store.select(StoryChaptersState.getSelectedChapterId)\n      .pipe(\n        filter(chapter => chapter != null),\n        map(() => this.store.selectSnapshot(StoryChaptersState.getSelectedChapter)),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe((chapter) => {\n        this.viewService.initChapter(chapter);\n        this.setPageTitle(chapter);\n        this.refreshLayout();\n      });\n  }\n\n  initLoadProgressObserver() {\n    // update the loader with the percentage of assets loaded\n    this.store.select(EngineProgressState.getChunkLoadProgress)\n      .pipe(\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe((progress) => {\n        this.loadProgress = progress * 100;\n        this.engineService.fireEvent(EventsEnum.HumanProgress, {progress: this.loadProgress});\n        this.changeDetectorRef.markForCheck();\n        this.checkShowLoader();\n      });\n\n      // hide the loader when the currently selected chapter is done processing\n      this.store.select(StoryState.getLoadingChunk)\n      .pipe(\n        filter(() => {\n          return this.loadProgress > 0;\n        }),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe((chunk) => {\n        const showLoader = (chunk !== null && chunk.chapterId === this.store.selectSnapshot(StoryChaptersState.getSelectedChapterId));\n        this.store.dispatch(new ViewActions.ToggleWindow(ViewWindow.Loader, showLoader));\n      });\n\n  // There are story load chunks that don't actually initiate any downloading.\n  // Therefore, we can only know when loading has completed by pipeing LoadStoryChunkSuccess, and there are zero chunks remaining\n  // In case the hide code didn't get called previously hide it now\n  this.actions\n    .pipe(\n      ofActionCompleted(LoadStoryChunkSuccess),\n      takeUntil(this.ngUnsubscribe)\n    )\n    .subscribe(() => {\n      const chunksRemaining = this.store.selectSnapshot(\n        StoryState.getLoadChunksRemaining\n      ).length;\n      if (chunksRemaining === 0) {\n        this.store.dispatch(new ViewActions.ToggleWindow(ViewWindow.Loader, false));\n      }\n    });\n  }\n\n  // edge case:  it is possible to select a chapter during loading\n  //   show the loader if the selected chapter is loading\n  checkShowLoader() {\n    const selectedChapterIndex = this.store.selectSnapshot(StoryChaptersState.getSelectedChapterIndex);\n    if (selectedChapterIndex > 0) {\n      const selectedChapterId = this.store.selectSnapshot(StoryChaptersState.getSelectedChapterId);\n      const currentChapter = this.store.selectSnapshot(StoryState.getLoadingChunk);\n      if (currentChapter !== null && selectedChapterId === currentChapter.chapterId) {\n        this.store.dispatch(new ViewActions.ToggleWindow(ViewWindow.Loader, true));\n      }\n    }\n  }\n\n  initWindowObserver() {\n    this.viewWindow$.pipe(\n      takeUntil(this.ngUnsubscribe),\n    ).subscribe((window) => {\n      this.viewService.resetLayout();\n\n      if (window === ViewWindow.Tutorial) {\n        this.viewService.resetChapter();\n        this.viewService.toggleLabels(false);\n      } else {\n        this.viewService.toggleLabels(true);\n      }\n    });\n  }\n\n  initBackgroundColorObserver() {\n    this.background$\n      .pipe(\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(background => {\n        if (!background.colors) {\n          return;\n        }\n\n        const outerRGB = background.colors.slice(0, 3);\n        this.isBackgroundLight = ColorUtils.isLight([outerRGB[0], outerRGB[1], outerRGB[2]]);\n        this.changeDetectorRef.markForCheck();\n      });\n  }\n\n  initAudioObserver() {\n    const stopAudio = merge(this.ngUnsubscribe, this.audioListening);\n\n    // get computed tutorial seen\n    const tutorialInteractSeen$ = this.viewWindow$\n      .pipe(\n        // map to current seen state\n        map((window) => window === ViewWindow.Tutorial || window === ViewWindow.Interact),\n        // take once when true\n        filter((seen) => seen),\n        take(1)\n      );\n\n    // tap into latest state of each variable\n    combineLatest(\n      this.viewWindow$,\n      tutorialInteractSeen$,\n      this.audio$\n    )\n      .pipe(\n        filter(([window]) => isNil(window)), // wait til window null\n        takeUntil(stopAudio)\n      )\n      .subscribe(([, tutorialInteractSeen, audio]) => {\n        if (tutorialInteractSeen) {\n          if (!isNil(audio)) {\n            this.playAudio();\n          }\n        } else {\n          this.stopAudioListening();\n        }\n      });\n  }\n\n  initNotifications() {\n    this.notification = new NotificationModel(\n      'Welcome! Learn how to navigate and interact with this model in 3D.',\n      'Launch Tutorial'\n    );\n  }\n\n  handleNotificationClose({ action }: { action: string }) {\n    if (action === 'Launch Tutorial') {\n      this.viewService.toggleTutorial(true);\n    }\n\n    // No action, notification was dismissed. Assume the user has seen the message\n    // and is not interested in the tutorial. \n    if (!action) {\n      this.store.dispatch(new ViewActions.TutorialSeen(true));\n    }\n  }\n\n  private stopAudioListening() {\n    this.audioListening.next();\n    this.audioListening.complete();\n  }\n\n  private playAudio() {\n    this.store.dispatch(new PlayAudio(true));\n    this.stopAudioListening();\n  }\n\n  // ---------- Event Handlers ----------\n  handleColumnToggle() {\n    this.viewService.toggleColumn();\n    this.changeDetectorRef.markForCheck();\n  }\n\n  handleDrawerOffsetChange(drawerOffsetY: number) {\n    this.drawerY = drawerOffsetY;\n    this.drawerOpen = drawerOffsetY !== -drawerHeight;\n\n    this.positionRelativeElements(this.drawerY);\n  }\n  \n  checkLabelsCollapsed() {\n    const breakpoint = this.store.selectSnapshot(BreakpointState.getBreakpoint);\n    const labelBreakpoint = this.store.selectSnapshot(ViewState.getLabelsBreakpoint);\n    const collapsed = this.isLabelBreaking(labelBreakpoint);\n    \n    // get collapsed mode: based on view breakpoint \n    const collapsedMode = breakpoint >= Breakpoint.Large\n      ? LabelCollapseModeEnum.Toggle\n      : LabelCollapseModeEnum.None;\n\n    this.store.dispatch(new SetLabelsCollapsed(collapsed, collapsedMode));\n  }\n\n  isLabelBreaking(labelBreakpoint: number): boolean {\n    return window.innerWidth < labelBreakpoint;\n  }\n\n  bindKeyboard() {\n    // Tool switching\n    Mousetrap.bind('1', () => this.viewService.selectTool(ToolEnum.Select));\n    Mousetrap.bind('2', () => this.viewService.selectTool(ToolEnum.Hide));\n    Mousetrap.bind('3', () => this.viewService.selectTool(ToolEnum.Fade));\n\n    // Column toggle\n    Mousetrap.bind(['command+,', 'ctrl+,'], (event) => {\n      event.preventDefault();\n\n      const breakpoint = this.store.selectSnapshot(BreakpointState.getBreakpoint);\n      (breakpoint > Breakpoint.Medium) ?\n        this.viewService.toggleColumn() :\n        this.drawer.toggleDrawer();\n\n      this.changeDetectorRef.markForCheck();\n    });\n\n    // Presentation toggle\n    Mousetrap.bind(['command+enter', 'ctrl+enter', 'command+p'], (event) => {\n      event.preventDefault();\n      Fullscreen.toggleFullscreen();\n    });\n\n    // Undo\n    Mousetrap.bind('meta+z', (event) => {\n      event.preventDefault();\n      this.viewService.undo();\n    });\n\n    // Redo\n    Mousetrap.bind(['meta+y', 'meta+shift+z'], (event) => {\n      event.preventDefault();\n      this.viewService.redo();\n    });\n\n    // Chapter browser\n    Mousetrap.bind(['.', 'pagedown'] , () => this.viewService.nextChapter());\n    Mousetrap.bind([',', 'pageup'], () => this.viewService.previousChapter());\n\n    // Delete\n    Mousetrap.bind(['del', 'backspace'], (event) => {\n      event.preventDefault();\n      this.viewService.hideSelectedStructures();\n    });\n\n    // Reset\n    Mousetrap.bind('R', (event) => {\n      event.preventDefault();\n      this.viewService.resetChapter();\n    });\n\n    // Seach\n    Mousetrap.bind('/', () => this.viewService.toggleSearch());\n\n    // Help\n    Mousetrap.bind('?', () => this.viewService.toggleHelp());\n\n    // Play / Pause\n    Mousetrap.bind('space', (event) => {\n      event.preventDefault();\n      this.viewService.toggleAnimation();\n    });\n  }\n\n  unbindKeyboard() {\n    Mousetrap.reset();\n  }\n\n\n\n  // ---------- Layout ----------\n  resizeEngineContainer() {\n    const { top, left, width, height } = this.engineContainer.nativeElement.getBoundingClientRect();\n\n    // const { offsetLeft, offsetTop, offsetWidth, offsetHeight } = this.engineContainer.nativeElement;\n    const position = new EnginePositionModel(left, top, width, height, EngineVisibilityEnum.Shown);\n\n    this.store.dispatch(new SetEnginePosition(position));\n  }\n\n  // Mobile devices have variable viewheight because the browser bar can scroll in and out of view\n  // This workaround determines the available window space and uses that as a viewheight unit\n  updateViewHeight() {\n    const includeOffset = environment.application !== EnvironmentApplication.Viewer;\n    const vh = this.viewService.getVH(includeOffset);\n    this.view.nativeElement.style.setProperty('--vh', `${vh}px`);\n  }\n\n  handleResize() {\n    this.viewService.resetLayout();\n  }\n\n  // Previous scene is kept in memory so we don't have to reinitialize the entire engine every pageload.\n  // We also want to keep the scene fully in memory so that transitions from /view to /edit don't require a reload.\n  // This function hides the engine, waits until first meaningful render, then shows it, guaranteeing that the content\n  // the user sees is accurate. \n  resetScene() {\n    this.store.dispatch(new SetDisplay(true));\n    this.store.dispatch(new SetVisible(false));\n    this.store.dispatch(new SetActiveTool(ToolEnum.Select));\n\n    this.engineService\n      .getEvent(EventsEnum.AssetsLoadProgress)\n      .pipe(\n        take(1),\n        takeUntil(this.ngUnsubscribe)\n      ).subscribe(() => {\n        this.store.dispatch(new SetVisible(true));\n      });\n  }\n\n  \n  refreshLayout() {\n    const layout = this.store.selectSnapshot(ViewState.getUI);\n\n    // Update visible elements\n    this.columnLayoutStatus = layout.column.status;\n\n    this.updateViewHeight();\n    this.resizeEngineContainer();\n\n    // Update label visibility status\n    const enableAnatomyLabels = layout.anatomyLabels.enable !== false;\n    const enableAnatomyInfo = layout.nodeInfo.enable !== false;\n    const enableAnatomyActions = true;\n    this.store.dispatch(new EnableContextLabel(enableAnatomyLabels, enableAnatomyInfo, enableAnatomyActions));\n\n    const enableLabels = layout.labels.enable !== false;\n    this.store.dispatch(new ToggleLabels(enableLabels));\n\n    // Add a timeout to allow drawer time to render\n    setTimeout(() => {\n      if (this.drawer) {\n        // Update elements relative to the drawer\n        this.positionRelativeElements(this.drawerY);\n      } else {\n        this.positionRelativeElements();\n      }\n\n      this.changeDetectorRef.markForCheck();\n    });\n  }\n  \n  positionRelativeElements(drawerOffsetY = 0) {\n    const breakpoint = this.store.selectSnapshot(BreakpointState.getBreakpoint);\n\n    // Determinine which elements are visible\n    const isDrawerVisible = this.isVisible(ViewUI.Drawer);\n    const isNavVisible = this.isVisible(ViewUI.Camera);\n    const isMenuVisible = this.isVisible(ViewUI.Menu);\n\n    // Offset navbar\n    if (this.viewCameraBar != null && isNavVisible) {\n      const navBarOffsetX = -4;\n      const navBarOffsetY = isMenuVisible ? -64 : 0;\n\n      this.renderer.setStyle(this.viewCameraBar.nativeElement, 'transform', `translate3d(${navBarOffsetX}px, ${navBarOffsetY}px, 0)`);\n    }\n\n    // Offset toolbar\n    // const toolbarOffsetX = isNavVisible ? -60 : -8;\n    const toolbarOffsetX = -8;\n    this.renderer.setStyle(this.viewToolbar.nativeElement, 'transform', `translate3d(${toolbarOffsetX}px, 0, 0)`);\n    \n    // Offset base container bar\n    const baseOffsetY = (breakpoint > Breakpoint.Medium) ? -8 : isDrawerVisible ? (drawerOffsetY + drawerHeight) - 8 : -8;\n    this.renderer.setStyle(this.viewSceneBase.nativeElement, 'transform', `translate3d(0, ${baseOffsetY}px, 0)`);\n  }\n\n  isVisible(layout: ViewUI) {\n    return this.layoutService.isVisible(layout);\n  }\n\n  isEnabled(layout: ViewUI) {\n    return this.layoutService.isUIEnabled(layout);\n  }\n\n  setPageTitle(chapter: ChapterModel) {\n    const chapterTitle = get(chapter, 'info.displayName');\n    const title = chapterTitle ? `${chapterTitle} | ` : '';\n    this.title.setTitle(`${title}BioDigital Human Platform`);\n  }\n}\n","import { ViewUIModel } from '../models/view-ui.model';\r\nimport { TreeSearchDisplayMode } from 'src/app/shared/components/tree/tree-search/tree-search.component';\r\nimport { InteractTypeEnum } from '../models/interact-type.enum';\r\nimport { ViewWindow } from '../models/view-window.enum';\r\nimport { TutorialStateModel } from '../models/tutorial-state.model';\r\nimport { HelpTypeEnum } from '../models/help-type.enum';\r\nimport { ViewInputModeEnum } from '../models/view-input-mode.enum';\r\nimport { ViewLayout } from '../models/view-layout.enum';\r\nimport { WhiteboardAnnotateMode } from '../models/whiteboard-state.model';\r\n\r\nexport namespace ViewActions {\r\n  export class SetCanHover {\r\n    static readonly type = '[View] Set Can Hover';\r\n    constructor(public canHover: boolean) { }\r\n  }\r\n\r\n  export class SetCanTouch {\r\n    static readonly type = '[View] Set Can Touch';\r\n    constructor(public canTouch: boolean) { }\r\n  }\r\n\r\n  export class SetCanFullscreen {\r\n    static readonly type = '[View] Set Can Fullscreen';\r\n    constructor(public canFullscreen: boolean) { }\r\n  }\r\n\r\n  export class SetUI {\r\n    static readonly type = '[View] Set UI';\r\n    constructor(public ui: ViewUIModel) { }\r\n  }\r\n\r\n  export class SetInitialUI {\r\n    static readonly type = '[View] Set Initial UI';\r\n    constructor(public ui: ViewUIModel) { }\r\n  }\r\n\r\n  export class SetInputEnabled {\r\n    static readonly type = '[View] Set Input Enabled';\r\n    constructor(public enabled: boolean) { }\r\n  }\r\n\r\n  export class SetSearchDisplayMode {\r\n    static readonly type = '[View] Set Search Display Mode';\r\n    constructor(public mode: TreeSearchDisplayMode) { }\r\n  }\r\n\r\n  export class TogglePresentation {\r\n    static readonly type = '[View] Toggle Presentation';\r\n    constructor(public active: boolean) { }\r\n  }\r\n\r\n  export class SetInteractType {\r\n    static readonly type = '[View] Set Interact Type';\r\n    constructor(public interactType: InteractTypeEnum) { }\r\n  }\r\n\r\n  export class SetLayout {\r\n    static readonly type = '[View] Set Layout';\r\n    constructor(public layout: ViewLayout) { }\r\n  }\r\n  export class ToggleHelpTab {\r\n    static readonly type = '[View] Toggle Help Tab';\r\n    constructor(public tab: HelpTypeEnum = HelpTypeEnum.Basics) { }\r\n  }\r\n  \r\n  export class SetInputMode {\r\n    static readonly type = '[View] Set Input Mode';\r\n    constructor(public inputMode: ViewInputModeEnum) { }\r\n  }\r\n  \r\n  export class SetTutorial {\r\n    static readonly type = '[View] Set Tutorial';\r\n    constructor(public tutorial: Partial<TutorialStateModel>) { }\r\n  }\r\n\r\n  export class StartTutorial {\r\n    static readonly type = '[View] Start Tutorial';\r\n    constructor(public intro: boolean) { }\r\n  }\r\n\r\n  export class TutorialSeen {\r\n    static readonly type = '[View] Tutorial Seen';\r\n    constructor(public seen: boolean) { }\r\n  }\r\n\r\n  export class TutorialNext {\r\n    static readonly type = '[View] Tutorial Next';\r\n    constructor() { }\r\n  }\r\n\r\n  export class TutorialPrevious {\r\n    static readonly type = '[View] Tutorial Previous';\r\n    constructor() { }\r\n  }\r\n\r\n  export class ToggleNodeInfo {\r\n    static readonly type = '[View] Toggle Node Info';\r\n    constructor(public show: boolean) { }\r\n  }\r\n\r\n  export class SetMultiPickModeEnabled {\r\n    static readonly type = '[View] Set multi pick mode enabled';\r\n    constructor(public enabled: boolean) { }\r\n  }\r\n\r\n  export class SetLabelBreakpoint {\r\n    static readonly type = '[View] Set Label Breakpoint';\r\n    constructor(public labelsBreakpoint: number) { }\r\n  }\r\n\r\n  export class SetUsePrintImage {\r\n    static readonly type = '[View] Set Use Print Image';\r\n    constructor(public usePrintImage: boolean) { }\r\n  }\r\n\r\n  export class SetWindows {\r\n    static readonly type = '[View] Set Windows';\r\n    constructor(public windows: ViewWindow[]) { }\r\n  }\r\n\r\n  export class OpenWindow {\r\n    static readonly type = '[View] Open Window';\r\n    constructor(public window: ViewWindow) { }\r\n  }\r\n\r\n  export class CloseWindow {\r\n    static readonly type = '[View] Close Window';\r\n    constructor(public window?: ViewWindow) { }\r\n  }\r\n\r\n  export class ToggleWindow {\r\n    static readonly type = '[View] Toggle Window';\r\n    constructor(public window: ViewWindow, public show: boolean) { }\r\n  }\r\n\r\n  export class ToggleMenu {\r\n    static readonly type = '[View] Toggle Menu';\r\n    constructor(public open: boolean) { }\r\n  }\r\n\r\n  export class SetWhiteboardEnabled {\r\n    static readonly type = '[View] Whiteboard Enabled';\r\n    constructor(public enabled: boolean) { }\r\n  }\r\n\r\n  export class SetWhiteboardBrushSize {\r\n    static readonly type = '[View] Whiteboard Brush Size';\r\n    constructor(public brushSize: number) { }\r\n  }\r\n\r\n  export class SetWhiteboardBrushColor {\r\n    static readonly type = '[View] Whiteboard Brush Color';\r\n    constructor(public brushColor: string) { }\r\n  }\r\n\r\n  export class SetWhiteboardTextSize {\r\n    static readonly type = '[View] Whiteboard Text Size';\r\n    constructor(public size: number) { }\r\n  }\r\n\r\n  export class SetWhiteboardAnnotateMode {\r\n    static readonly type = '[View] Whiteboard Annotate Mode';\r\n    constructor(public mode: WhiteboardAnnotateMode) { }\r\n  }\r\n}\r\n","import { State, Action, StateContext, Selector, NgxsOnInit, createSelector } from '@ngxs/store';\r\nimport { ViewActions } from './view.actions';\r\nimport { ViewUIModel, UIDefault, LogoUI, DrawerUI, MediaUI, LoaderUI } from '../models/view-ui.model';\r\nimport { Fullscreen } from 'src/app/shared/libraries/fullscreen/fullscreen';\r\nimport { TreeSearchDisplayMode } from 'src/app/shared/components/tree/tree-search/tree-search.component';\r\nimport { ViewUIStatus } from '../models/view-ui-status.enum';\r\nimport { InteractTypeEnum } from '../models/interact-type.enum';\r\nimport { ViewWindow } from '../models/view-window.enum';\r\nimport { TutorialStateModel } from '../models/tutorial-state.model';\r\nimport { HelpTypeEnum } from '../models/help-type.enum';\r\nimport { WhiteboardStateModel, WhiteboardAnnotateMode } from '../models/whiteboard-state.model';\r\nimport { DefaultAnnotateBrushSizePreset, DefaultAnnotateColorPreset, DefaultAnnotateTextSizePreset } from 'src/app/engine/models/whiteboard-presets.const';\r\nimport { ViewInputModeEnum } from '../models/view-input-mode.enum';\r\nimport { ViewLayout } from '../models/view-layout.enum';\r\nimport { StorageItemEnum, StorageService } from 'src/app/shared/storage.service';\r\n\r\nexport class ViewStateModel {\r\n  canFullscreen: boolean;\r\n  canHover: boolean;\r\n  canTouch: boolean;\r\n  drawerCoversContent: boolean;\r\n  fullscreenActive: boolean;\r\n  help: {\r\n    tab: HelpTypeEnum;\r\n  };\r\n  initialUI: ViewUIModel;\r\n  inputEnabled: boolean;\r\n  inputMode: ViewInputModeEnum;\r\n  interactType: InteractTypeEnum;\r\n  labelsBreakpoint: number;\r\n  layout: ViewLayout;\r\n  menuOpen: boolean;\r\n  multiPickModeEnabled: boolean;\r\n  openWindows: ViewWindow[];\r\n  presentationActive: boolean;\r\n  searchDisplayMode: TreeSearchDisplayMode;\r\n  showNodeInfo: boolean;\r\n  tutorial: TutorialStateModel;\r\n  tutorialSeen: boolean;\r\n  ui: ViewUIModel;\r\n  usePrintImage: boolean;\r\n  whiteboard: WhiteboardStateModel;\r\n}\r\n\r\nexport const initialUI: ViewUIModel = {\r\n  audio: new UIDefault(),\r\n  camera: new UIDefault(ViewUIStatus.Show, true), // Camera controls - zoom, pan, reset. Off by default.\r\n  chapterList: new UIDefault(ViewUIStatus.Show, false),\r\n  column: new UIDefault(), // Left description panel, visible on desktop mode\r\n  description: new UIDefault(),\r\n  drawer: new DrawerUI(), // Bottom description panel, visible at 960 below\r\n  fullscreen: new UIDefault(),\r\n  help: new UIDefault(),\r\n  labels: new UIDefault(),\r\n  labelInfo: new UIDefault(),\r\n  labelList: new UIDefault(ViewUIStatus.Show, false),\r\n  loader: new LoaderUI(),\r\n  logo: new LogoUI(),\r\n  media: new MediaUI(), // Play, pause, scrubber\r\n  menu: new UIDefault(), // Menu button and child items, visible at 960 below\r\n  nodeInfo: new UIDefault(ViewUIStatus.Hide, false),\r\n  pagination: new UIDefault(),\r\n  presenter: new UIDefault(ViewUIStatus.Hide, false),\r\n  reset: new UIDefault(),\r\n  search: new UIDefault(),\r\n  titleOnly: new UIDefault(),\r\n  toolbar: new UIDefault(), // Interaction tools, visible in drawer when responsive, floating on the scene in desktop\r\n  tools: new UIDefault(), // tool bar button in menu\r\n  anatomyLabels: new UIDefault(), // anatomy context lavels\r\n  tutorial: new UIDefault(ViewUIStatus.Hide, false), // getting started tour\r\n  internetExplorerWarning: new UIDefault(),\r\n  legend: new UIDefault(),\r\n  undo: new UIDefault(),\r\n  whiteboard: new UIDefault(),\r\n  visibilityLayers: new UIDefault(),\r\n  contextActions: new UIDefault()\r\n};\r\n\r\nexport const initialViewState: ViewStateModel = {\r\n  canFullscreen: false,\r\n  canHover: false,\r\n  canTouch: false,\r\n  drawerCoversContent: false,\r\n  fullscreenActive: false,\r\n  help: {\r\n    tab: HelpTypeEnum.Basics\r\n  },\r\n  initialUI: initialUI,\r\n  inputEnabled: true,\r\n  inputMode: ViewInputModeEnum.Mouse,\r\n  interactType: InteractTypeEnum.Play,\r\n  layout: ViewLayout.Default,\r\n  labelsBreakpoint: 480,\r\n  menuOpen: false,\r\n  multiPickModeEnabled: false,\r\n  openWindows: [ViewWindow.Loader],\r\n  presentationActive: false,\r\n  searchDisplayMode: TreeSearchDisplayMode.Tree,\r\n  showNodeInfo: false,\r\n  tutorial: {   \r\n    pageSize: 0,\r\n    pageIndex: -1\r\n  },\r\n  tutorialSeen: true,\r\n  ui: initialUI,\r\n  usePrintImage: false,\r\n  whiteboard: {\r\n    enabled: false,\r\n    brushSize: DefaultAnnotateBrushSizePreset.size,\r\n    brushColor: DefaultAnnotateColorPreset.color,\r\n    textSize: DefaultAnnotateTextSizePreset.size,\r\n    annotateMode: WhiteboardAnnotateMode.Paint\r\n  }\r\n};\r\n\r\n@State<ViewStateModel>({\r\n  name: 'view',\r\n  defaults: initialViewState\r\n})\r\nexport class ViewState implements NgxsOnInit {\r\n  // ---------- Selectors ----------\r\n  @Selector()\r\n  static getUI(state: ViewStateModel) {\r\n    return state.ui;\r\n  }\r\n\r\n  @Selector()\r\n  static getInitialUI(state: ViewStateModel) {\r\n    return state.initialUI;\r\n  }\r\n\r\n  @Selector()\r\n  static getLabelsBreakpoint(state: ViewStateModel) {\r\n    return state.labelsBreakpoint;\r\n  }\r\n\r\n  @Selector()\r\n  static getInputEnabled(state: ViewStateModel) {\r\n    return state.inputEnabled;\r\n  }\r\n\r\n  @Selector()\r\n  static getFullscreenActive(state: ViewStateModel) {\r\n    return state.fullscreenActive;\r\n  }\r\n\r\n  @Selector()\r\n  static getPresentationActive(state: ViewStateModel) {\r\n    return state.presentationActive;\r\n  }\r\n\r\n  @Selector()\r\n  static getDrawerCoversContent(state: ViewStateModel) {\r\n    return state.drawerCoversContent;\r\n  }\r\n\r\n  @Selector()\r\n  static getShowNodeInfo(state: ViewStateModel) {\r\n    return state.showNodeInfo;\r\n  }\r\n\r\n  @Selector()\r\n  static getInteractType(state: ViewStateModel) {\r\n    return state.interactType;\r\n  }\r\n\r\n  @Selector()\r\n  static getLayout(state: ViewStateModel) {\r\n    return state.layout;\r\n  }\r\n\r\n  @Selector()\r\n  static getInputMode(state: ViewStateModel) {\r\n    return state.inputMode;\r\n  }\r\n\r\n  @Selector()\r\n  static getShowHelpTab(state: ViewStateModel) {\r\n    return state.help.tab;\r\n  }\r\n\r\n  @Selector()\r\n  static getTutorial(state: ViewStateModel) {\r\n    return state.tutorial;\r\n  }\r\n\r\n  @Selector()\r\n  static getTutorialSeen(state: ViewStateModel) {\r\n    return state.tutorialSeen;\r\n  }\r\n\r\n  @Selector()\r\n  static getWhiteboardEnabled(state: ViewStateModel) {\r\n    return state.whiteboard.enabled;\r\n  }\r\n\r\n  @Selector()\r\n  static getWhiteboardBrushSize(state: ViewStateModel) {\r\n    return state.whiteboard.brushSize;\r\n  }\r\n\r\n  @Selector()\r\n  static getWhiteboardTextSize(state: ViewStateModel) {\r\n    return state.whiteboard.textSize;\r\n  }\r\n\r\n  @Selector()\r\n  static getWhiteboardAnnotateMode(state: ViewStateModel) {\r\n    return state.whiteboard.annotateMode;\r\n  }\r\n\r\n  @Selector()\r\n  static getWhiteboardBrushColor(state: ViewStateModel) {\r\n    return state.whiteboard.brushColor;\r\n  }\r\n\r\n  @Selector()\r\n  static getCanTouch(state: ViewStateModel) {\r\n    return state.canTouch;\r\n  }\r\n\r\n  @Selector()\r\n  static getCanHover(state: ViewStateModel) {\r\n    return state.canHover;\r\n  }\r\n\r\n  @Selector()\r\n  static getMultiPickModeEnabled(state: ViewStateModel) {\r\n    return state.multiPickModeEnabled;\r\n  }\r\n\r\n  @Selector()\r\n  static getSearchDisplayMode(state: ViewStateModel) {\r\n    return state.searchDisplayMode;\r\n  }\r\n\r\n  @Selector()\r\n  static getUsePrintImage(state: ViewStateModel) {\r\n    return state.usePrintImage;\r\n  }\r\n\r\n  @Selector()\r\n  static getOpenWindow(state: ViewStateModel) {\r\n    return state.openWindows.length > 0 ? state.openWindows.sort()[0] : null;\r\n  }\r\n\r\n  @Selector()\r\n  static getMenuOpen(state: ViewStateModel) {\r\n    return state.menuOpen;\r\n  }\r\n\r\n  static shouldWindowOpen(window: ViewWindow) {\r\n    return createSelector(\r\n      [ViewState],\r\n      (state: ViewStateModel) => {\r\n        return state.openWindows.indexOf(window) >= 0;\r\n      }\r\n    );\r\n  }\r\n\r\n  // ---------- Actions ----------\r\n  @Action(ViewActions.SetUI)\r\n  setUI(\r\n    context: StateContext<ViewStateModel>,\r\n    action: ViewActions.SetUI\r\n  ) {\r\n    const ui = context.getState().ui;\r\n\r\n    context.patchState({\r\n      ui: {\r\n        ...ui,\r\n        ...action.ui\r\n      }\r\n    });\r\n  }\r\n\r\n  @Action(ViewActions.SetInitialUI)\r\n  setInitialUI(context: StateContext<ViewStateModel>, action: ViewActions.SetInitialUI) {\r\n    context.patchState({\r\n      initialUI: action.ui\r\n    });\r\n  }\r\n\r\n  @Action(ViewActions.SetInputEnabled)\r\n  setInputEnabled(\r\n    context: StateContext<ViewStateModel>,\r\n    action: ViewActions.SetInputEnabled\r\n  ) {\r\n    context.patchState({\r\n      inputEnabled: action.enabled\r\n    });\r\n  }\r\n\r\n  @Action(ViewActions.SetCanHover)\r\n  setCanHover(\r\n    context: StateContext<ViewStateModel>,\r\n    action: ViewActions.SetCanHover\r\n  ) {\r\n    context.patchState({\r\n      canHover: action.canHover\r\n    });\r\n  }\r\n\r\n  @Action(ViewActions.SetCanTouch)\r\n  setCanTouch(\r\n    context: StateContext<ViewStateModel>,\r\n    action: ViewActions.SetCanTouch\r\n  ) {\r\n    context.patchState({\r\n      canTouch: action.canTouch\r\n    });\r\n  }\r\n\r\n  @Action(ViewActions.SetCanFullscreen)\r\n  setCanFullscreen(\r\n    context: StateContext<ViewStateModel>,\r\n    action: ViewActions.SetCanFullscreen\r\n  ) {\r\n    context.patchState({\r\n      canFullscreen: action.canFullscreen\r\n    });\r\n  }\r\n\r\n  @Action(ViewActions.SetSearchDisplayMode)\r\n  setSearchDisplayMode(\r\n    context: StateContext<ViewStateModel>,\r\n    action: ViewActions.SetSearchDisplayMode\r\n  ) {\r\n    context.patchState({\r\n      searchDisplayMode: action.mode\r\n    });\r\n  }\r\n\r\n  @Action(ViewActions.ToggleNodeInfo)\r\n  toggleNodeInfo(\r\n    context: StateContext<ViewStateModel>,\r\n    action: ViewActions.ToggleNodeInfo\r\n  ) {\r\n    context.patchState({\r\n      showNodeInfo: action.show\r\n    });\r\n  }\r\n\r\n  @Action(ViewActions.TogglePresentation)\r\n  togglePresentation(\r\n    context: StateContext<ViewStateModel>,\r\n    action: ViewActions.TogglePresentation\r\n  ) {\r\n    context.patchState({\r\n      presentationActive: action.active\r\n    });\r\n  }\r\n\r\n  @Action(ViewActions.ToggleHelpTab)\r\n  toggleHelp(\r\n    context: StateContext<ViewStateModel>,\r\n    action: ViewActions.ToggleHelpTab\r\n  ) {\r\n    context.patchState({\r\n      help: {\r\n        tab: action.tab\r\n      }\r\n    });\r\n  }\r\n\r\n  @Action(ViewActions.SetInteractType)\r\n  setLoaderType(\r\n    context: StateContext<ViewStateModel>,\r\n    action: ViewActions.SetInteractType\r\n  ) {\r\n    context.patchState({\r\n      interactType: action.interactType\r\n    });\r\n  }\r\n\r\n  @Action(ViewActions.SetInputMode)\r\n  setInputMode(context: StateContext<ViewStateModel>, { inputMode }: ViewActions.SetInputMode) {\r\n    context.patchState({\r\n      inputMode\r\n    });\r\n  }\r\n\r\n  @Action(ViewActions.SetLayout)\r\n  SetLayout(\r\n    context: StateContext<ViewStateModel>,\r\n    action: ViewActions.SetLayout\r\n  ) {\r\n    context.patchState({\r\n      layout: action.layout\r\n    });\r\n  }\r\n\r\n  @Action(ViewActions.SetTutorial)\r\n  setTutorial(context: StateContext<ViewStateModel>, action: ViewActions.SetTutorial) {\r\n    const tutorial = context.getState().tutorial;\r\n    context.patchState({\r\n      tutorial: {\r\n        ...tutorial,\r\n        ...action.tutorial\r\n      }\r\n    });\r\n  }\r\n\r\n  @Action(ViewActions.StartTutorial)\r\n  startTutorial(context: StateContext<ViewStateModel>, action: ViewActions.StartTutorial) {\r\n    context.patchState({\r\n      tutorial: {\r\n        ...context.getState().tutorial,\r\n        pageIndex: action.intro ? -1 : 0\r\n      }\r\n    });\r\n\r\n    context.dispatch(new ViewActions.TutorialSeen(true));\r\n  }\r\n\r\n  @Action(ViewActions.TutorialSeen)\r\n  tutorialSeen(context: StateContext<ViewStateModel>, action: ViewActions.TutorialSeen) {\r\n    this.storageService.setLocalItem(StorageItemEnum.GettingStartedTutorial, action.seen);\r\n\r\n    context.patchState({\r\n      tutorialSeen: action.seen\r\n    });\r\n  }\r\n\r\n  @Action(ViewActions.TutorialPrevious)\r\n  tutorialPrevious(context: StateContext<ViewStateModel>, action: ViewActions.TutorialPrevious) {\r\n    const tutorial = context.getState().tutorial;\r\n    // normalize index\r\n    const pageIndex = Math.max(tutorial.pageIndex - 1, 0);\r\n\r\n    context.dispatch(new ViewActions.SetTutorial({\r\n      ...tutorial,\r\n      pageIndex: pageIndex\r\n    }));\r\n  }\r\n\r\n  @Action(ViewActions.TutorialNext)\r\n  tutorialNext(context: StateContext<ViewStateModel>, action: ViewActions.TutorialNext) {\r\n    const tutorial = context.getState().tutorial;\r\n    // normalize index\r\n    const pageIndex = Math.min(tutorial.pageIndex + 1, tutorial.pageSize - 1);\r\n\r\n    context.dispatch(new ViewActions.SetTutorial({\r\n      ...tutorial,\r\n      pageIndex: pageIndex\r\n    }));\r\n  }\r\n\r\n\r\n\r\n  @Action(ViewActions.SetWhiteboardEnabled)\r\n  setWhiteboardEnabled(context: StateContext<ViewStateModel>, { enabled }: ViewActions.SetWhiteboardEnabled) {\r\n    context.patchState({\r\n      whiteboard: {\r\n        ...context.getState().whiteboard,\r\n        enabled\r\n      }\r\n    });\r\n  }\r\n\r\n  @Action(ViewActions.SetWhiteboardBrushSize)\r\n  setWhiteboardBrushSize(context: StateContext<ViewStateModel>, { brushSize }: ViewActions.SetWhiteboardBrushSize) {\r\n    context.patchState({\r\n      whiteboard: {\r\n        ...context.getState().whiteboard,\r\n        brushSize\r\n      }\r\n    });\r\n  }\r\n  @Action(ViewActions.SetWhiteboardTextSize)\r\n  setWhiteboardTextSize(context: StateContext<ViewStateModel>, { size }: ViewActions.SetWhiteboardTextSize) {\r\n    context.patchState({\r\n      whiteboard: {\r\n        ...context.getState().whiteboard,\r\n        textSize: size\r\n      }\r\n    });\r\n  }\r\n\r\n  @Action(ViewActions.SetWhiteboardAnnotateMode)\r\n  setWhiteboardAnnotateMode(context: StateContext<ViewStateModel>, { mode }: ViewActions.SetWhiteboardAnnotateMode) {\r\n    context.patchState({\r\n      whiteboard: {\r\n        ...context.getState().whiteboard,\r\n        annotateMode: mode\r\n      }\r\n    });\r\n  }\r\n\r\n  @Action(ViewActions.SetWhiteboardBrushColor)\r\n  setWhiteboardBrushColor(context: StateContext<ViewStateModel>, { brushColor }: ViewActions.SetWhiteboardBrushColor) {\r\n    context.patchState({\r\n      whiteboard: {\r\n        ...context.getState().whiteboard,\r\n        brushColor\r\n      }\r\n    });\r\n  }\r\n\r\n  @Action(ViewActions.SetMultiPickModeEnabled)\r\n  setMultiPickModeEnabled(\r\n    context: StateContext<ViewStateModel>,\r\n    action: ViewActions.SetMultiPickModeEnabled\r\n  ) {\r\n    context.patchState({\r\n      multiPickModeEnabled: action.enabled\r\n    });\r\n  }\r\n\r\n  @Action(ViewActions.SetLabelBreakpoint)\r\n  setLabelBreakpoint(context: StateContext<ViewStateModel>, action: ViewActions.SetLabelBreakpoint) {\r\n    context.patchState({\r\n      labelsBreakpoint: action.labelsBreakpoint\r\n    });\r\n  }\r\n\r\n  @Action(ViewActions.SetUsePrintImage)\r\n  setUsePrintImage(context: StateContext<ViewStateModel>, action: ViewActions.SetUsePrintImage) {\r\n    context.patchState({\r\n      usePrintImage: action.usePrintImage\r\n    });\r\n  }\r\n\r\n  @Action(ViewActions.SetWindows)\r\n  setWindows(context: StateContext<ViewStateModel>, action: ViewActions.SetWindows) {\r\n    context.patchState({\r\n      openWindows: action.windows\r\n    });\r\n  }\r\n\r\n  @Action(ViewActions.OpenWindow)\r\n  openWindow(context: StateContext<ViewStateModel>, action: ViewActions.OpenWindow) {\r\n    const openWindows = context.getState().openWindows;\r\n\r\n    if (openWindows.indexOf(action.window) < 0) {\r\n      context.patchState({\r\n        openWindows: [action.window, ...openWindows]\r\n      });\r\n    }\r\n  }\r\n\r\n  @Action(ViewActions.CloseWindow)\r\n  closeWindow(context: StateContext<ViewStateModel>, action: ViewActions.CloseWindow) {\r\n    let openWindows = context.getState().openWindows;\r\n\r\n    if (action.window != null) {\r\n      openWindows = openWindows.filter(window => window !== action.window);\r\n    } else {\r\n      openWindows.shift();\r\n    }\r\n\r\n    context.patchState({\r\n      openWindows: [...openWindows]\r\n    });\r\n  }\r\n\r\n  @Action(ViewActions.ToggleWindow)\r\n  toggleWindow(context: StateContext<ViewStateModel>, action: ViewActions.ToggleWindow) {\r\n    const isOpen = context.getState().openWindows.indexOf(action.window) >= 0;\r\n    const show = (action.show != null) ? action.show : !isOpen;\r\n\r\n    (show) ?\r\n      context.dispatch(new ViewActions.OpenWindow(action.window)) :\r\n      context.dispatch(new ViewActions.CloseWindow(action.window));\r\n  }\r\n\r\n  @Action(ViewActions.ToggleMenu)\r\n  toggleMenu(context: StateContext<ViewStateModel>, action: ViewActions.ToggleMenu) {\r\n    context.patchState({\r\n      menuOpen: action.open\r\n    });\r\n  }\r\n\r\n  constructor(\r\n    private storageService: StorageService\r\n  ) {}\r\n\r\n\r\n  ngxsOnInit(context: StateContext<ViewStateModel>) {\r\n    const fullscreen$ = Fullscreen.onFullscreenChange();\r\n\r\n    fullscreen$.subscribe(event => {\r\n      context.patchState({\r\n        fullscreenActive: Fullscreen.isFullscreen()\r\n      });\r\n    });\r\n\r\n    context.patchState({\r\n      tutorialSeen: this.storageService.getLocalJSON(StorageItemEnum.GettingStartedTutorial) || false\r\n    });\r\n  }\r\n}\r\n","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\n\nconst routes: Routes = [\n\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule]\n})\nexport class ViewRoutingModule { }\n","import { Injectable } from '@angular/core';\nimport { Store } from '@ngxs/store';\nimport { ViewUIModel } from './models/view-ui.model';\nimport { ViewState, ViewStateModel } from './state/view.state';\nimport { ViewUIStatus } from './models/view-ui-status.enum';\nimport { ViewUI } from './models/view-ui.enum';\nimport { StoryLabelsState } from '../story/state/labels/story.labels.state';\nimport { StoryChaptersState } from '../story/state/chapters/story.chapters.state';\nimport { get, trim } from 'lodash';\nimport { environment } from 'src/environments/environment';\nimport { EnvironmentApplication } from 'src/environments/models/environment-application';\nimport { Breakpoint } from '../breakpoint/models/breakpoint.enum';\nimport { BreakpointState } from '../breakpoint/state/breakpoint.state';\nimport { ViewWindow } from './models/view-window.enum';\nimport { ViewLoaderEnum } from './models/view-loader.enum';\nimport { ChapterService } from '../story/chapter.service';\nimport { ViewLayout } from './models/view-layout.enum';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class ViewUIService {\n  ui: ViewUIModel = null;\n  breakpoint: Breakpoint = null;\n\n  constructor(\n    private store: Store,\n    private chapterService: ChapterService\n  ) { }\n\n  getBase() {\n    return {\n      ui: this.store.selectSnapshot(ViewState.getUI),\n      layout: this.store.selectSnapshot(ViewState.getLayout),\n      breakpoint: this.store.selectSnapshot(BreakpointState.getBreakpoint),\n      hideUI: this.isUIHidden(),\n    };\n  }\n\n  isUIHidden() {\n    const openWindow = this.store.selectSnapshot(ViewState.getOpenWindow);\n    const chapterIndex = this.store.selectSnapshot(StoryChaptersState.getSelectedChapterIndex);\n    const ui = this.store.selectSnapshot(ViewState.getUI);\n    const isCircleLoaderOpen = (openWindow === ViewWindow.Loader && chapterIndex <= 0 && ui.loader.template === ViewLoaderEnum.Circle);\n\n    return isCircleLoaderOpen\n      || openWindow === ViewWindow.Interact\n      || openWindow === ViewWindow.Tutorial\n      || openWindow === ViewWindow.Whiteboard;\n  }\n\n  isDrawerVisible() {\n    const { hideUI, ui, layout, breakpoint } = this.getBase();\n\n    // Hide when loader is active\n    if (hideUI) {\n      return false;\n    }\n\n    // Large breakpoint, never show unless manually specified with `ui-layout` parameter\n    // When 'drawer' parameter is specified, bypass this check\n    if (layout !== ViewLayout.DrawerOnly) {\n        if (breakpoint >= Breakpoint.Large) {\n          return false;\n        }\n    }\n\n    // Show for loft & studio\n    if (environment.application !== EnvironmentApplication.Viewer) {\n      return true;\n    }\n    \n    // Medium & Small breakpoint\n    const visible = \n      (ui.drawer.enable && this.getVisibleContent() !== 'none')\n      || ui.nodeInfo.status === ViewUIStatus.Show\n      || ui.labelInfo.status === ViewUIStatus.Show;\n    \n    return visible;\n  }\n\n  isColumnVisible() {\n    const { hideUI, layout, ui, breakpoint } = this.getBase();\n\n    // Hide when loader is active\n    if (hideUI) {\n      return false;\n    }\n\n    // Don't show when drawer only is specified as a layout\n    if (layout === ViewLayout.DrawerOnly) {\n      return false;\n    }\n    \n    // Below large breakpoint, never show\n    if (breakpoint < Breakpoint.Large) {\n      return false;\n    }\n\n    // Hide on collapse\n    if (ui.column.status === ViewUIStatus.Collapse) {\n      return false;\n    }\n\n    // // Always show for loft & studio\n    // if (environment.application !== EnvironmentApplication.Viewer) {\n    //   return true;\n    // }\n\n    // Default ui (description)\n    return (ui.column.enable && this.getVisibleContent() === 'full');\n  }\n  \n  isColumnToggleVisible() {\n    const { hideUI, layout, ui, breakpoint } = this.getBase();\n\n    // Hide when loader is active\n    if (hideUI) {\n      return false;\n    }\n\n    // Below large breakpoint, never show unless manually specified with `ui-layout` parameter\n    switch (layout) {\n      case ViewLayout.Default:\n        if (breakpoint < Breakpoint.Large) {\n          return false;\n        }\n        break;\n      case ViewLayout.DrawerOnly:\n        return false;\n    }\n\n    return (ui.column.enable && this.getVisibleContent() === 'full');\n  }\n\n  isTitleOnlyVisible() {\n    const { hideUI, ui, breakpoint } = this.getBase();\n\n    // Hide when loader is active\n    if (hideUI) {\n      return false;\n    }\n\n    // Large breakpoint, never show\n    if (breakpoint < Breakpoint.Large) {\n      return false;\n    }\n\n    // Only active on large screen, and when the only visible content in the column would have been the chapter title\n    return (ui.titleOnly.enable && this.getVisibleContent() === 'titleOnly');\n  }\n\n  isToolsVisible() {\n    const { hideUI, ui, breakpoint } = this.getBase();\n\n    // Hide when loader is active\n    if (hideUI) {\n      return false;\n    }\n\n    return this.isUIVisible(ViewUI.Tools);\n  }\n\n  isToolbarVisible() {\n    const { hideUI, ui } = this.getBase();\n\n    // Hide when loader is active\n    if (hideUI) {\n      return false;\n    }\n\n    return ui.toolbar.enable;\n  }\n\n  isLogoVisible() {\n    const { ui } = this.getBase();\n    return ui.logo.enable;\n  }\n\n  isCameraVisible() {\n    const { hideUI, ui } = this.getBase();\n\n    // Hide when loader is active\n    if (hideUI) {\n      return false;\n    }\n\n    return ui.camera.enable;\n  }\n\n  isPaginationVisible() {\n    const { hideUI, ui } = this.getBase();\n    \n    // Hide when loader is active\n    if (hideUI) {\n      return false;\n    }\n\n    if (this.store.selectSnapshot(StoryChaptersState.getChapterCount) <= 1) {\n      return false;\n    }\n\n    return ui.pagination.enable;\n  }\n\n  isMediaVisible() {\n    const { hideUI, ui } = this.getBase();  \n\n    if (hideUI) {\n      return false;\n    }\n\n    const isAnimated = this.store.selectSnapshot(StoryChaptersState.getIsChapterAnimated);\n    const isEnabled = ui.media.enable;\n\n    return isAnimated && isEnabled;\n  }\n\n  isMediabarVisible() {\n    const { hideUI } = this.getBase();  \n\n    if (hideUI) {\n      return false;\n    }\n\n    // Visible when audio or animation is visible\n    const animationVisible = this.isMediaVisible();\n    const audioVisible = this.isAudioVisible();\n\n    return animationVisible || audioVisible;\n  }\n\n  isMenuVisible() {\n    const { hideUI, ui, breakpoint } = this.getBase();\n\n    // Hide when loader is active\n    if (hideUI) {\n      return false;\n    }\n\n    const visible = \n      ui.fullscreen.enable\n      || ui.help.enable\n      || ui.search.enable\n      || ui.tools.enable\n      || ui.whiteboard.enable\n      || ui.tutorial.enable;\n\n    return visible && ui.menu.enable;\n  }\n\n  isNodeInfoColumnVisible() {\n    const { hideUI, ui, breakpoint } = this.getBase();\n\n    // Hide when loader is active\n    if (hideUI) {\n      return false;\n    }\n\n    if (breakpoint >= Breakpoint.Large && this.isUIVisible(ViewUI.NodeInfo)) {\n      return true;\n    }\n    \n    // Medium / Small, defer to drawer enabled\n    if (breakpoint < Breakpoint.Large) {\n      return !ui.drawer.enable && this.isUIVisible(ViewUI.NodeInfo);\n    }\n  }\n\n  isNodeInfoVisible(location: 'drawer' | 'column') {\n    const { hideUI, ui, breakpoint } = this.getBase();\n\n    // Hide when loader is active\n    if (hideUI) {\n      return false;\n    }\n\n    // Large, never show\n    if (breakpoint >= Breakpoint.Large && location === 'column') {\n      return this.isUIVisible(ViewUI.NodeInfo);\n    }\n\n    // Medium / Small, drawer and column\n    if (breakpoint < Breakpoint.Large && location === 'drawer') {\n      return this.isUIVisible(ViewUI.NodeInfo);\n    }\n\n    return false;\n  }\n\n  isAudioVisible() {\n    const { ui } = this.getBase();\n    const hasAudio = this.store.selectSnapshot(StoryChaptersState.getSelectedChapterAudio) != null;\n\n    return ui.audio.enable && hasAudio;\n  }\n\n  isSearchColumnVisible() {\n    const { hideUI, ui, breakpoint } = this.getBase();\n\n    // Hide when loader is active\n    if (hideUI) {\n      return false;\n    }\n    \n    return this.isUIVisible(ViewUI.Search);\n  }\n\n  isUndoVisible() {\n    const { hideUI, layout, ui, breakpoint } = this.getBase();\n  \n    if (hideUI) {\n      return false;\n    }\n\n    return ui.undo.enable;\n  }\n\n  isVisibilityLayersVisible() {\n    const { hideUI, ui } = this.getBase();  \n\n    if (hideUI) {\n      return false;\n    }\n\n    const isEnabled = ui.visibilityLayers.enable;\n    const visibilityLayers = this.store.selectSnapshot(StoryChaptersState.getSelectedChapterCurrentLayers);\n    return isEnabled && this.chapterService.hasVisibilityLayers(visibilityLayers);\n  }\n\n  isVisible(ui: ViewUI) {\n    switch (ui) {\n      case ViewUI.Audio:\n        return this.isAudioVisible();\n\n      case ViewUI.Camera:\n        return this.isCameraVisible();\n\n      case ViewUI.Column:\n        return this.isColumnVisible();\n\n      case ViewUI.ColumnToggle:\n          return this.isColumnToggleVisible();\n\n      case ViewUI.Drawer:\n        return this.isDrawerVisible();\n\n      case ViewUI.Logo:\n        return this.isLogoVisible();\n\n      case ViewUI.Media:\n        return this.isMediaVisible();\n\n      case ViewUI.Mediabar:\n        return this.isMediabarVisible();\n\n      case ViewUI.Menu:\n        return this.isMenuVisible();\n\n      case ViewUI.Pagination:\n        return this.isPaginationVisible();\n\n      case ViewUI.Search:\n        return this.isSearchColumnVisible();\n\n      case ViewUI.TitleOnly:\n        return this.isTitleOnlyVisible();\n\n      case ViewUI.Tools:\n        return this.isToolsVisible();\n\n      case ViewUI.Toolbar:\n        return this.isToolbarVisible();\n\n      case ViewUI.Undo:\n        return this.isUndoVisible();\n\n      case ViewUI.VisibilityLayers:\n        return this.isVisibilityLayersVisible();\n\n      default:\n        return this.isUIVisible(ui);\n\n    }\n  }\n\n  isUIVisible(_ui: ViewUI) {\n    const { hideUI, ui } = this.getBase();\n\n    const el = ui[_ui];\n    \n    if (!el) {\n      console.warn('Attempting to check visibility of a non-existent element: ${element}');\n      return false;\n    }\n\n    return !hideUI && \n      ui[_ui].enable && \n      ui[_ui].status !== ViewUIStatus.Hide;\n  }\n\n  isUIEnabled(_ui: ViewUI) {\n    const { ui } = this.getBase();\n    return ui[_ui].enable;\n  }\n\n  // Determines what content is visible\n  getVisibleContent(): 'full' | 'titleOnly' | 'none' {\n    const { ui } = this.getBase();\n    const labels = this.store.selectSnapshot(StoryLabelsState.getChapterLabels);\n    const selectedChapter = this.store.selectSnapshot(StoryChaptersState.getSelectedChapter);\n    const description = get(selectedChapter, 'info.description');\n    const displayName = get(selectedChapter, 'info.displayName');\n    const legend = get(selectedChapter, 'legend', []);\n\n    const labelsVisible = ((ui.labelList.enable && labels.length > 0));\n    const descriptionVisible = (description != null && trim(description).length > 0);\n    const titleVisible = (displayName != null && trim(displayName).length > 0);\n    const legendVisible = ui.legend.enable && legend.length > 0;\n\n    \n    if (labelsVisible || descriptionVisible || legendVisible) {\n      return 'full';\n    }\n\n    if (titleVisible) {\n      return 'titleOnly';\n    }\n\n    return 'none';\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\nimport { ViewRoutingModule } from './view-routing.module';\nimport { ViewPageComponent } from './pages/view-page/view-page.component';\nimport { ViewColumnComponent } from './components/view-column/view-column/view-column.component';\nimport { ViewDrawerComponent } from './components/view-drawer/view-drawer.component';\nimport { MaterialModule } from '../material.module';\nimport { ButtonsModule } from '../shared/components/buttons/buttons.module';\nimport { TreeModule } from '../shared/components/tree/tree.module';\nimport { NgxsModule } from '@ngxs/store';\nimport { ViewState } from './state/view.state';\nimport { ViewToolsComponent } from './components/view-tools/view-tools.component';\nimport { ViewDescriptionComponent } from './components/view-description/view-description.component';\nimport { PipesModule } from '../shared/pipes/pipes.module';\nimport { EngineModule } from '../engine/engine.module';\nimport { IconModule } from '../shared/components/icon/icon.module';\nimport { ViewToolbarComponent } from './components/view-toolbar/view-toolbar.component';\nimport { ViewMediaBarComponent } from './components/view-media-bar/view-media-bar.component';\nimport { DirectivesModule } from '../shared/directives/directives.module';\nimport { ProgressIndictatorsModule } from '../shared/components/progress-indicators/progress-indicators.module';\nimport { ViewSearchComponent } from './components/view-search/view-search.component';\nimport { ViewHelpComponent } from './components/view-help/view-help.component';\nimport { ViewChaptersComponent } from './components/view-chapters/view-chapters.component';\nimport { NodeActionsModule } from '../shared/components/node-actions/node-actions.module';\nimport { ViewNodeDescriptionComponent } from './components/view-node-description/view-node-description.component';\nimport { ViewLoaderComponent } from './components/view-loader/view-loader.component';\nimport { ViewScrubberComponent } from './components/view-scrubber/view-scrubber.component';\nimport { ViewLogoComponent } from './components/view-logo/view-logo.component';\nimport { ViewPanelComponent } from './components/view-panel/view-panel.component';\nimport { ViewLabelsComponent } from './components/view-labels/view-labels.component';\nimport { ViewContentModeComponent } from './components/view-content-mode/view-content-mode.component';\nimport { ViewAudioComponent } from './components/view-audio/view-audio.component';\nimport { ViewScenePaginationComponent } from './components/view-scene-pagination/view-scene-pagination.component';\nimport { LazyLoadImageModule } from 'ng-lazyload-image';\nimport { PlayLoaderComponent } from './components/view-loader/play-loader/play-loader.component';\nimport { ViewColumnContainerComponent } from './components/view-column/view-column-container/view-column-container.component';\nimport { HandLoaderComponent } from './components/view-loader/hand-loader/hand-loader.component';\nimport { ButtonLoaderComponent } from './components/view-loader/button-loader/button-loader.component';\nimport { PillboxModule } from '../shared/components/pillbox/pillbox.module';\nimport { BookmarksModule } from '../bookmarks/bookmarks.module';\nimport { ViewColumnToggleComponent } from './components/view-column-toggle/view-column-toggle.component';\nimport { ViewPrintComponent } from './components/view-print/view-print.component';\nimport { PopupModule } from '../shared/features/popup/popup.module';\nimport { PopupComponent } from '../shared/features/components/popup/popup.component';\nimport { ViewTitleComponent } from './components/view-title/view-title.component';\nimport { ViewProgressComponent } from './components/view-progress/view-progress.component';\nimport { ViewTourComponent } from './components/view-tour/view-tour.component';\nimport { ViewTourMobileComponent } from './components/view-tour/tours/view-tour-mobile/view-tour-mobile.component';\nimport { ViewTourSlideComponent } from './components/view-tour/view-tour-slide/view-tour-slide.component';\nimport { ViewTourPageComponent } from './components/view-tour/view-tour-page/view-tour-page.component';\nimport { ViewTourDesktopComponent } from './components/view-tour/tours/view-tour-desktop/view-tour-desktop.component';\nimport { ViewTourPagesComponent } from './components/view-tour/view-tour-pages/view-tour-pages.component';\nimport { ViewRoundedButtonComponent } from './components/view-rounded-button/view-rounded-button.component';\nimport { ViewTourTipButtonComponent } from './components/view-tour/view-tour-tip-button/view-tour-tip-button.component';\nimport { ViewTourSuccessComponent } from './components/view-tour/view-tour-success/view-tour-success.component';\nimport { ViewShortcutsComponent } from './components/view-shortcuts/view-shortcuts.component';\nimport { ViewLegendComponent } from './components/view-legend/view-legend/view-legend.component';\nimport { MarkdownModule } from 'ngx-markdown';\nimport { ViewMenubarComponent } from './components/view-menubar/view-menubar.component';\nimport { ViewUndoComponent } from './components/view-undo/view-undo.component';\nimport { ViewMenuColumnComponent } from './components/view-menu-column/view-menu-column.component';\nimport { ViewListContainerComponent } from './components/view-list/view-list-container/view-list-container.component';\nimport { ViewListItemComponent } from './components/view-list/view-list-item/view-list-item.component';\nimport { ViewAnnotateComponent } from './components/view-annotate/view-annotate.component';\nimport { ViewAnnotateToolsComponent } from './components/view-annotate-tools/view-annotate-tools.component';\nimport { ViewAnnotateUndoComponent } from './components/view-annotate-undo/view-annotate-undo.component';\nimport { ViewLayersBarComponent } from './components/view-layers-bar/view-layers-bar.component';\nimport { ViewLayersSliderComponent } from './components/view-layers-slider/view-layers-slider.component';\nimport { StoryModule } from '../story/story.module';\nimport { NgxGoogleAnalyticsModule } from 'ngx-google-analytics';\nimport { ViewMenuComponent } from './components/view-menu/view-menu.component';\nimport { NotificationModule } from '../shared/features/notification/notification.module';\nimport { ErrorComponent } from '../pages/error/error.component';\nimport { ContentBlocksModule } from '../content-blocks/content-blocks.module';\nimport { SharedModule } from '../shared/shared.module';\nimport { ViewAnnotateLabelComponent } from './components/view-annotate-label/view-annotate-label.component';\n\n@NgModule({\n  declarations: [\n    ViewPageComponent,\n    ViewColumnComponent,\n    ViewDrawerComponent,\n    ViewToolsComponent,\n    ViewDescriptionComponent,\n    ViewToolbarComponent,\n    ViewMediaBarComponent,\n    ViewSearchComponent,\n    ViewHelpComponent,\n    ViewChaptersComponent,\n    ViewNodeDescriptionComponent,\n    ViewLoaderComponent,\n    ViewScrubberComponent,\n    ViewLogoComponent,\n    ViewPanelComponent,\n    ViewLabelsComponent,\n    ViewContentModeComponent,\n    ViewAudioComponent,\n    ViewScenePaginationComponent,\n    PlayLoaderComponent,\n    ViewColumnContainerComponent,\n    HandLoaderComponent,\n    ButtonLoaderComponent,\n    ViewColumnContainerComponent,\n    ViewColumnToggleComponent,\n    ViewPrintComponent,\n    ViewTitleComponent,\n    ViewProgressComponent,\n    ViewShortcutsComponent,\n    ViewMenubarComponent,\n    ViewUndoComponent,\n    ViewTourComponent,\n    ViewTourMobileComponent,\n    ViewTourSlideComponent,\n    ViewTourPageComponent,\n    ViewTourDesktopComponent,\n    ViewTourPagesComponent,\n    ViewRoundedButtonComponent,\n    ViewTourTipButtonComponent,\n    ViewTourSuccessComponent,\n    ViewShortcutsComponent,\n    ViewLegendComponent,\n    ViewMenuColumnComponent,\n    ViewListContainerComponent,\n    ViewListItemComponent,\n    ViewAnnotateComponent,\n    ViewAnnotateToolsComponent,\n    ViewAnnotateLabelComponent,\n    ViewAnnotateUndoComponent,\n    ViewLayersBarComponent,\n    ViewLayersSliderComponent,\n    ViewMenuComponent,\n    ErrorComponent\n  ],\n  imports: [\n    NgxsModule.forFeature([ViewState]),\n    MarkdownModule.forChild(),\n\n    // Google Analytics\n    NgxGoogleAnalyticsModule,\n\n    CommonModule,\n    EngineModule,\n\n    ViewRoutingModule,\n    MaterialModule,\n\n    ButtonsModule,\n    DirectivesModule,\n    IconModule,\n    PipesModule,\n    PillboxModule,\n    PopupModule,\n    TreeModule,\n    ProgressIndictatorsModule,\n    NodeActionsModule,\n    LazyLoadImageModule,\n    BookmarksModule,\n    StoryModule,\n    ContentBlocksModule,\n    SharedModule,\n\n    NotificationModule\n  ],\n  exports: [ViewPageComponent],\n  entryComponents: [\n    ViewChaptersComponent,\n    ViewMediaBarComponent,\n    PopupComponent\n  ]\n})\nexport class ViewModule { }\n","import { Injectable } from '@angular/core';\nimport { Store, Actions, ofActionDispatched } from '@ngxs/store';\nimport { ContentType } from '../story/models/content-type.enum';\nimport { SetIncomingStory, LoadStory, ReorderLoadChunks } from '../story/state/story.actions';\nimport { EngineState } from '../engine/state/engine.state';\nimport { StoryState } from '../story/state/story.state';\nimport { combineLatest } from 'rxjs';\nimport { filter, take, delay } from 'rxjs/operators';\nimport { SelectChapter, TakeChapterPicture, TakeChapterPictureSuccess } from '../story/state/chapters/story.chapters.actions';\nimport { EngineNodesState } from '../engine/state/nodes/engine.nodes.state';\nimport { ToolEnum } from '../engine/models/tool.enum';\nimport {\n  SetActiveTool,\n  ToggleAnimation,\n  ToggleLabels,\n  FlyToObject,\n  SetGraph,\n  Fade,\n  ExpandViewTreeNode,\n  QueryNodeInfo,\n  PlayAudio,\n  PlayChapterFromStart} from '../engine/state/engine.actions';\nimport { ViewState, ViewStateModel } from './state/view.state';\nimport { ViewUIStatus } from './models/view-ui-status.enum';\nimport { ViewActions } from './state/view.actions';\nimport { ViewTreeNode } from '../engine/models/view.tree-node';\nimport { PaintPresetFade } from '../engine/models/paint-presets.const';\nimport { SelectLabel, RemoveContextLabel } from '../story/state/labels/story.labels.actions';\nimport { StoryChaptersState } from '../story/state/chapters/story.chapters.state';\nimport { ChapterModel } from '../story/models/chapter.model';\nimport { SetCamera } from '../engine/state/camera/engine.camera.actions';\nimport { Location } from '@angular/common';\nimport { LabelModel } from '../story/models/labels/label.model';\nimport { ViewUIModel } from './models/view-ui.model';\nimport { ViewMode } from './models/view-mode.enum';\nimport { normalizeQueryIdParam, normalizeQueryTypeParam } from '../widget-config/initial-config';\nimport { BdGraph } from 'src/lib/graph/graph.model';\nimport { EngineService } from '../engine/engine.service';\nimport { TransitionModel } from '../story/models/transition.model';\nimport { TransitionService } from '../engine/transition.service';\nimport { CameraStrategy } from '../story/models/camera-strategy.enum';\nimport { BreakpointState } from '../breakpoint/state/breakpoint.state';\nimport { Breakpoint } from '../breakpoint/models/breakpoint.enum';\nimport { ViewWindow } from './models/view-window.enum';\nimport { NodeActions } from '../engine/state/nodes/engine.nodes.actions';\nimport { UndoActions } from '../undo/state/undo.state.actions';\nimport { HelpTypeEnum } from './models/help-type.enum';\nimport { ViewUIService } from './view-ui.service';\nimport { ImageTypeEnum, ImageService } from '../shared/image.service';\nimport { ScreenDimensions } from '../shared/models/screen.dimensions.model';\nimport { PublishService } from '../publish/publish.service';\nimport { ThumbnailConstants } from '../shared/thumbnail.constants';\nimport { SelectBookmark } from '../bookmarks/state/bookmarks.actions';\nimport { environment } from 'src/environments/environment';\nimport { EnvironmentApplication } from 'src/environments/models/environment-application';\nimport { LayoutState } from '../layout/state/layout.state';\nimport { SiteHeaderType } from '../layout/models/site-header-type.enum';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class ViewService {\n\n  constructor(\n    private store: Store,\n    private location: Location,\n    private transitionService: TransitionService,\n    private engineService: EngineService,\n    private layoutService: ViewUIService,\n\n    private actions: Actions,\n    private imageService: ImageService,\n    private publishService: PublishService\n  ) { }\n\n  // ---------- Story Handlers ----------\n  initStory(id: string, type: ContentType, lang?: string) {\n\n    // Initialize state for new story\n    this.store.dispatch(new SetIncomingStory(id, type, true));\n\n    // Internal applications need additional bookmark data for the actions menu\n    // Viewer does not have the actions menu\n    if (environment.application !== EnvironmentApplication.Viewer) {\n      this.store.dispatch(new SelectBookmark(id, type));\n    }\n\n    // Set up listeners for when the story is loaded\n    const engineReady$ = this.store.select(EngineState.getReady);\n    const incoming$ = this.store.select(StoryState.getIncomingStoryInfo);\n\n    combineLatest(engineReady$, incoming$).pipe(\n      filter(([ready, incoming]) => ready && !!incoming.id),\n      take(1),\n    ).subscribe(() => {\n      this.store.dispatch(new SelectChapter()); // null chapter state\n      this.store.dispatch(new LoadStory(id, type, lang));\n    });\n  }\n\n  nextChapter() {\n    const index = this.store.selectSnapshot(StoryChaptersState.getSelectedChapterIndex);\n    const chapters = this.store.selectSnapshot(StoryChaptersState.getStoryChapters);\n\n    const chapter = chapters[index + 1];\n    if (chapter) {\n      this.selectChapter(chapter);\n    }\n  }\n\n  previousChapter() {\n    const index = this.store.selectSnapshot(StoryChaptersState.getSelectedChapterIndex);\n    const chapters = this.store.selectSnapshot(StoryChaptersState.getStoryChapters);\n\n    const chapter = chapters[index - 1];\n    if (chapter) {\n      this.selectChapter(chapter);\n    }\n  }\n\n  async selectChapter(chapter: ChapterModel) {\n    const currentChapterId = this.store.selectSnapshot(StoryChaptersState.getSelectedChapterId);\n    const targetChapterId = chapter.id;\n    const chapters = this.store.selectSnapshot(StoryChaptersState.getStoryChapters);\n    const transition = this.transitionService.searchChapterTransitions(currentChapterId, targetChapterId, chapters);\n\n    if (transition) {\n      await this.chapterTransition(transition);\n    }\n\n    this.store.dispatch([\n      new ReorderLoadChunks(chapter.id),\n      new SelectChapter(chapter)\n    ]);\n  }\n\n  private chapterTransition(transition: TransitionModel): Promise<boolean> {\n    return new Promise(resolve => {\n      // Camera transition\n      if (transition.camera) {\n        this.store.dispatch(new SetCamera(transition.camera, true, transition.duration));\n      }\n\n      // Chapter fade\n      if (transition.fadeColor) {\n        this.store.dispatch(new Fade(transition.fadeColor, transition.duration));\n      }\n\n      // Wait for duration before resolving. While this could be handled by SetCameraSuccess,\n      // setting a timeout decouples the transition from the camera motion and allows for\n      // transition effects without any camera movement.\n      setTimeout(() => {\n        resolve(true);\n      }, transition.duration * 1000);\n    });\n  }\n\n  // ---------- 3D Handlers ----------\n  hideSelectedStructures() {\n    const selectedNodes = this.store.selectSnapshot(EngineNodesState.getCheckedNodeIds);\n\n    // hide nodes that are selecetd\n    this.store.dispatch(new NodeActions.UpdateNodesShown(\n      false,\n      selectedNodes\n    ));\n  }\n\n\n\n  // ---------- UI Handlers ----------\n  selectTool(tool: ToolEnum) {\n    this.store.dispatch(new SetActiveTool(tool));\n  }\n\n  toggleColumn(show?: boolean) {\n    const layout = this.store.selectSnapshot(ViewState.getUI);\n    show = show == null ? !(layout.column.status === ViewUIStatus.Show) : show;\n    layout.column.status = show ? ViewUIStatus.Show : ViewUIStatus.Collapse;\n    this.store.dispatch(new ViewActions.SetUI(layout));\n  }\n\n  togglePresentation() {\n    const isPresenting = this.store.selectSnapshot(ViewState.getPresentationActive);\n\n    (isPresenting) ? this.stopPresentation() : this.startPresentation();\n  }\n\n  startPresentation() {\n    this.store.dispatch(new ViewActions.TogglePresentation(true));\n  }\n\n  stopPresentation() {\n    this.store.dispatch(new ViewActions.TogglePresentation(false));\n  }\n\n  /**\n   * FOR DEBUGGING USE ONLY\n   * This function exposes an easy way to trigger image generation in the widget without needing\n   * to use the public API to generate an image\n   * TODO: Refactor into public method\n   */\n  takeSnapshot(\n    chapterId?: string,\n    imageType?: ImageTypeEnum,\n    imageQuality?: number,\n    screenDimensions?: ScreenDimensions\n  ) {\n    chapterId = chapterId || this.store.selectSnapshot(StoryChaptersState.getSelectedChapterId);\n    imageType = imageType || ImageTypeEnum.JPEG;\n    imageQuality = imageQuality || 92;\n    screenDimensions = screenDimensions || ThumbnailConstants.medium;\n    const crop = 'square';\n\n    this.store.dispatch(new TakeChapterPicture(chapterId, imageType, imageQuality, screenDimensions, crop));\n\n    this.actions.pipe(\n      ofActionDispatched(TakeChapterPictureSuccess),\n      take(1)\n    ).subscribe((action: TakeChapterPictureSuccess) => {\n      const title = 'snapshot';\n      const normalizedTitle = title.replace(/ /g, '_').replace(/\\W/g, '');\n\n      const extension = 'jpg';\n      const fileName = `${normalizedTitle}.${extension}`;\n\n      this.imageService.blobToBase64(action.blob)\n        .pipe(take(1))\n        .subscribe(imageData => {\n          this.publishService.exportImage(imageData, ImageTypeEnum.JPEG, fileName);\n        });\n    });\n  }\n\n  toggleHelp(show?: boolean, type: HelpTypeEnum = HelpTypeEnum.Basics) {\n    this.store.dispatch(new ViewActions.ToggleWindow(ViewWindow.Help, show));\n    this.store.dispatch(new ViewActions.ToggleHelpTab(type));\n  }\n\n  toggleInteract(show?: boolean) {\n    this.store.dispatch(new ViewActions.ToggleWindow(ViewWindow.Interact, show));\n  }\n\n  toggleTutorial(show: boolean) {\n    this.store.dispatch(new ViewActions.ToggleWindow(ViewWindow.Tutorial, show));\n\n    if (show) {\n      this.store.dispatch(new ViewActions.StartTutorial(true));\n    }\n  }\n\n  toggleWhiteboard(show: boolean) {\n    this.store.dispatch(new ViewActions.ToggleWindow(ViewWindow.Whiteboard, show));\n\n    if (show) {\n      // pause animation\n      this.store.dispatch(new ToggleAnimation(false));\n      // start whiteboarding\n      this.store.dispatch(new ViewActions.SetWhiteboardEnabled(true));\n    }\n  }\n\n  toggleLabels(show?: boolean) {\n    this.store.dispatch(new ToggleLabels(show));\n  }\n\n  toggleSearch(show?: boolean) {\n    const breakpoint = this.store.selectSnapshot(BreakpointState.getBreakpoint);\n    const layout = this.store.selectSnapshot(ViewState.getUI);\n\n    show = (show == null) ? !(layout.search.status === ViewUIStatus.Show) : show;\n\n    // Switch modes\n    layout.search.status = show ? ViewUIStatus.Show : ViewUIStatus.Hide;\n\n    // When in medium and below, auto hide the column as well\n    if (\n      (breakpoint === Breakpoint.Medium || breakpoint === Breakpoint.Small) ||\n      (breakpoint >= Breakpoint.Large && show)\n    ) {\n      this.toggleColumn(show);\n    }\n\n    if (show) {\n      layout.nodeInfo.status = ViewUIStatus.Hide;\n    }\n\n    this.store.dispatch(new ViewActions.SetUI(layout));\n  }\n\n  toggleNodeInfo(show?: boolean) {\n    this.toggleInfoLayout('nodeInfo', show);\n  }\n\n  toggleLabelInfo(show?: boolean) {\n    this.toggleInfoLayout('labelInfo', show);\n  }\n\n  toggleInfoLayout(layoutField: 'nodeInfo' | 'labelInfo', show?: boolean) {\n    const layout = this.store.selectSnapshot(ViewState.getUI);\n    show = (show == null) ? layout[layoutField].status === ViewUIStatus.Hide : show;\n\n    if (show) { // show target, hide others\n      layout[layoutField].status = ViewUIStatus.Show;\n\n      // hide others\n      const infoFieldNames = ['nodeInfo', 'labelInfo'];\n      infoFieldNames\n        .filter((field) => field !== layoutField)\n        .forEach((field) => layout[field].status = ViewUIStatus.Hide);\n\n    } else { // hide target\n      layout[layoutField].status = ViewUIStatus.Hide;\n    }\n\n    this.store.dispatch(new ViewActions.SetUI(layout));\n  }\n\n\n\n  // ---------- Interaction Handlers ----------\n  delegateNodeClick(node: ViewTreeNode, event: HammerInput) {\n    // Always clear selected label\n    this.clearSelectedLabel();\n\n    if (!node && !event.srcEvent.shiftKey) {\n      this.clearSelectedNodes();\n\n    } else if (event.srcEvent.shiftKey || this.store.selectSnapshot(ViewState.getMultiPickModeEnabled)) {\n      this.checkNode(node);\n\n    } else {\n      const tool = this.store.selectSnapshot(EngineState.getActiveTool);\n\n      switch (tool) {\n        case ToolEnum.Hide:\n          // this.hideNodes({nodes: [node], visible: false});\n          this.hideNode(node);\n          break;\n        case ToolEnum.Select:\n          this.selectNode(node);\n          break;\n        case ToolEnum.Isolate:\n          this.isolateNode(node);\n          break;\n        case ToolEnum.Fade:\n          this.fadeNode(node);\n          break;\n      }\n    }\n  }\n\n\n  clearSelectedLabel() {\n    this.store.dispatch(new SelectLabel());\n  }\n\n  clearSelectedNodes() {\n    this.store.dispatch(new NodeActions.UpdateNodeSelected());\n    this.store.dispatch(new NodeActions.UpdateNodesChecked(false));\n  }\n\n  checkNode(node: ViewTreeNode, checked?: boolean) {\n\n    if (node === undefined) {\n      return;\n    }\n\n    if (checked == null) {\n      checked = this.store.selectSnapshot(EngineNodesState.getNodes)[node.id].checked;\n    }\n\n    const shouldCheck = !checked;\n\n    this.store.dispatch(new NodeActions.UpdateNodesChecked(shouldCheck, [node.id]));\n\n    this.store.dispatch(\n      new NodeActions.UpdateNodeSelected(node.id)\n    );\n  }\n\n  fadeNode(node: ViewTreeNode) {\n    this.store.dispatch(new NodeActions.UpdateNodesPaint(\n      PaintPresetFade.recipe,\n      [node.id]\n    ));\n  }\n\n  isolateNode(node: ViewTreeNode) {\n    this.store.dispatch(new NodeActions.UpdateNodesShown(false));\n    this.store.dispatch(new NodeActions.UpdateNodesShown(true, [node.id]));\n  }\n\n  selectNode(node: ViewTreeNode) {\n\n    // only check 1 at a time\n\n\n    const shouldCheck = !this.store.selectSnapshot(EngineNodesState.getNodes)[node.id].checked;\n    this.store.dispatch(new NodeActions.UpdateNodesChecked(false));\n\n\n    if (shouldCheck) {\n      this.store.dispatch(new NodeActions.UpdateNodesChecked(true, [node.id]));\n      this.store.dispatch(new NodeActions.UpdateNodeSelected(node.id));\n    }\n\n\n    this.store.dispatch(new ExpandViewTreeNode(node));\n\n    // Pre-request node info\n    this.store.dispatch(new QueryNodeInfo(node));\n  }\n\n  hideNode(node: ViewTreeNode) {\n    this.store.dispatch(new NodeActions.UpdateNodesShown(false, [node.id]));\n    this.store.dispatch(new NodeActions.UpdateNodesChecked(false));\n  }\n\n  selectLabel(label: LabelModel, flyTo: boolean = false) {\n    const { objectId, states } = label;\n\n    // select label\n    this.store.dispatch(new SelectLabel(label));\n\n    // #TODO[AC]: fly to position\n    // no custom actions: fly to object\n    if (flyTo && objectId && states.length === 0) {\n      this.store.dispatch(new FlyToObject(objectId, true));\n    }\n  }\n\n  /**\n   * On a new chapter change, immediately cache the current state so that we can revert.\n   * While engine has a reset() method, it currently doesn't work well with painted objects.\n   * @param chapter the ChapterModel to init\n   */\n  async initChapter(chapter: ChapterModel) {\n    const viewGraph: BdGraph<ViewTreeNode> = this.engineService.createViewGraph(\n      {},\n      false\n    );\n\n    this.store.dispatch(new SetGraph(viewGraph));\n    this.store.dispatch(new SetCamera(chapter.camera.location, chapter.camera.action === CameraStrategy.FlyTo));\n  }\n\n  playChapterFromStart() {\n    this.store.dispatch(new PlayChapterFromStart());\n  }\n\n  resetCamera() {\n    const chapter = this.store.selectSnapshot(StoryChaptersState.getSelectedChapter);\n    if (!chapter) {\n      return;\n    }\n    this.store.dispatch(new SetCamera(chapter.camera.location));\n  }\n\n  resetChapter() {\n    this.resetCamera();\n\n    const chapterId = this.store.selectSnapshot(\n      StoryChaptersState.getSelectedChapterId\n    );\n    this.store.dispatch(new UndoActions.UndoAll(chapterId));\n\n    this.store.dispatch(\n      new NodeActions.UpdateNodesChecked(false)\n    );\n    this.store.dispatch(new RemoveContextLabel());\n  }\n\n  resetLayout() {\n    const { ui: layout } = this.store.selectSnapshot(ViewState) as ViewStateModel;\n\n    if (this.layoutService.isUIHidden()) {\n      Object.keys(layout).forEach(key => {\n        layout[key].status = ViewUIStatus.Hide;\n      });\n    } else {\n      // Reset everything to visible\n      Object.keys(layout).forEach(key => {\n        layout[key].status = ViewUIStatus.Show;\n      });\n\n      // Always hidden by default\n      layout.search.status = ViewUIStatus.Hide;\n      layout.tools.status = ViewUIStatus.Hide;\n      layout.nodeInfo.status = ViewUIStatus.Hide;\n      layout.labelInfo.status = ViewUIStatus.Hide;\n\n\n      layout.media.status = ViewUIStatus.Hide;\n      layout.visibilityLayers.status = ViewUIStatus.Hide;\n    }\n\n    this.store.dispatch(new ViewActions.SetUI(layout));\n  }\n\n  undo() {\n    this.store.dispatch(\n      new UndoActions.Undo(\n        this.store.selectSnapshot(StoryChaptersState.getSelectedChapterId)\n      )\n    );\n  }\n\n  redo() {\n    this.store.dispatch(\n      new UndoActions.Redo(\n        this.store.selectSnapshot(StoryChaptersState.getSelectedChapterId)\n      )\n    );\n  }\n\n  toggleAnimation() {\n    const playing = !this.store.selectSnapshot(EngineState.getAnimationPlaying);\n    this.store.dispatch(new ToggleAnimation(playing));\n  }\n\n  toggleAudio() {\n    const playAudio = this.store.selectSnapshot(EngineState.getPlayAudio);\n    this.store.dispatch(new PlayAudio(!playAudio));\n  }\n\n  toggleToolbar(bar: 'media' | 'tools' | 'toolbar') {\n    const layout = this.store.selectSnapshot(ViewState.getUI);\n    layout.media.status = ViewUIStatus.Hide;\n    layout.tools.status = ViewUIStatus.Hide;\n    layout.toolbar.status = ViewUIStatus.Hide;\n    layout.visibilityLayers.status = ViewUIStatus.Hide;\n    layout[bar].status = ViewUIStatus.Show;\n    this.store.dispatch(new ViewActions.SetUI(layout));\n  }\n\n\n  normalizeQueryParams(queryParams: any): { id: string, type: ContentType, lang?: string } {\n    // normalize query params\n    const params = { ...queryParams };\n    const contentId = normalizeQueryIdParam(params);\n    const contentType = normalizeQueryTypeParam(params);\n    const contentLang = queryParams.lang;\n\n    return {\n      id: contentId,\n      type: <ContentType>contentType,\n      lang: contentLang\n    };\n  }\n\n  // Bookmark routes use appropriate ID parameters, but internal users would like the ability to paste\n  // in legacy paths. This means stripping out the .json extension at time of page load and accounting\n  // for that conversion later on.\n  sanitizeRouteId(id: string): string {\n    id = id.replace(/\\.json$/, '');\n    const query = `?id=${id}`;\n    this.location.replaceState('view', query);\n    return id;\n  }\n\n  openInNewTab() {\n    const url = window.document.location.href;\n    window.open(url);\n  }\n\n  // see: https://stackoverflow.com/questions/43065579/how-to-convert-css-transform-matrix-back-to-its-component-properties/43065744\n  getComputedTransform(element: HTMLElement): { x: number, y: number } {\n    const style = getComputedStyle(element);\n    const trans = style.transform;\n\n\n    // ie implementation difference.\n    // ie returns a 3d matrix, while others return a 2d matrix.\n    // sanitize transform string value\n    const values = trans\n      .replace('matrix3d', '')\n      .replace('matrix', '')\n      .replace('(', '')\n      .replace(')', '')\n      .split(',')\n      .map(s => s.trim())\n      .map(s => parseInt(s, 10));\n\n    const computedTranslateX: number = values.length === 16 ? values[12] : values[4];\n    const computedTranslateY: number = values.length === 16 ? values[13] : values[5];\n\n    if (!Number.isNaN(computedTranslateX) && !Number.isNaN(computedTranslateY)) {\n      return {\n        x: computedTranslateX,\n        y: computedTranslateY\n      };\n    } else {\n      return null;\n    }\n  }\n\n  getVH(includeOffset = true) {\n    const siteHeader = this.store.selectSnapshot(LayoutState.getSiteHeader);\n    const topOffset = !includeOffset || siteHeader === SiteHeaderType.Hide ? 0 : 56;\n\n    // const siteHeader = document.querySelector('app-site-header');\n    // const topOffset = siteHeader ? siteHeader.getBoundingClientRect().height : 0;\n    \n    const vh = (window.innerHeight - topOffset) * 0.01;\n    return vh;\n  }\n\n  inferDrawerMode(layout: ViewUIModel) {\n    // Default mode is content\n    let mode = ViewMode.Content;\n\n    if (layout.nodeInfo.status === ViewUIStatus.Show) {\n      mode = ViewMode.NodeInfo;\n    } else if (layout.labelInfo.status === ViewUIStatus.Show) {\n      mode = ViewMode.LabelInfo;\n    }\n\n    return mode;\n  }\n}\n","import { Store, Actions } from '@ngxs/store';\nimport { Injectable } from '@angular/core';\nimport { CameraService } from '../engine/camera.service';\nimport { EngineService } from '../engine/engine.service';\nimport { PaintService } from '../engine/paint.service';\nimport { defineProcedure } from './define-procedure';\nimport { getCameraProcedures, getCameraEvents } from './procedures/camera';\nimport { getSceneProcedures, getSceneEvents } from './procedures/scene';\nimport { defineEvent } from './define-event';\nimport { getHumanEvents, getHumanProcedures } from './procedures/human';\nimport { HumanInterface } from './models/human.interface';\nimport { WebGLInfoModel } from './models/webgl-info.model';\nimport { getTimelineEvents, getTimelineProcedures } from './procedures/timeline';\nimport { AnimationService } from '../engine/animation.service';\nimport { getInputEvents, getInputProcedures } from './procedures/input';\nimport { getUIEvents, getUIProcedures } from './procedures/ui';\nimport { ImageService } from '../shared/image.service';\nimport { getLabelsEvents, getLabelsProcedures } from './procedures/labels';\nimport { LabelsService } from '../story/labels.service';\nimport { BdGraphService } from 'src/lib/graph/graph.service';\nimport { ViewService } from '../view/view.service';\nimport { uniqBy } from 'lodash';\nimport { DeveloperAnalyticModel } from '../widget-auth/models/developer-analytic.model';\nimport { WidgetPlatformEnum } from '../widget-auth/models/widget-platform.enum';\nimport { WidgetInteractionEnum } from '../widget-auth/models/widget-interaction.enum';\nimport { WidgetAnalyticsService } from '../widget-auth/widget-analytics.service';\nimport { VisibilityLayersService } from 'src/app/story/visibility-layers.service';\nimport { WidgetState } from '../widget-auth/state/widget.state';\nimport { EnvironmentDeploy } from 'src/environments/models/environment-deploy';\nimport { EventsEnum } from '../engine/models/events.enum';\n\ndeclare const Human: HumanInterface;\ndeclare const SceneJS: any;\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class WidgetAPIHandler {\n\n  private webGLInfo: WebGLInfoModel;\n\n  constructor(\n    private store: Store,\n    private actions: Actions,\n    private cameraService: CameraService,\n    private engineService: EngineService,\n    private animationService: AnimationService,\n    private imageService: ImageService,    \n    private paintService: PaintService,\n    private labelsService: LabelsService,\n    private graphService: BdGraphService,\n    private viewService: ViewService,\n    private widgetAnalyticsService: WidgetAnalyticsService,\n    private visibilityLayersService: VisibilityLayersService\n  ) {\n    this.webGLInfo = SceneJS.WEBGL_INFO;\n  }\n\n  listen() {\n    this.initProcedures();\n    this.initEvents();\n    if (EnvironmentDeploy.Production) {\n      this.logAPIUsage();\n    }\n  }\n\n  private logAPIUsage() {\n    const sendInterval = 10000;\n    setInterval(() => {\n      // get the RPC log\n      const log = Human.rpc.getLog();\n      const uniqueEntries = uniqBy(log, (entry) => entry['identifier']);\n    \n      if (uniqueEntries.length > 0) {\n        const activityData = JSON.stringify(uniqueEntries);\n        const widgetState = this.store.selectSnapshot(WidgetState.getWidgetState);\n        const payload = this.widgetAnalyticsService.buildDeveloperAnalytic(\n          widgetState,\n          WidgetInteractionEnum.Call,\n          WidgetPlatformEnum.WidgetAPI,\n          activityData\n        );\n    \n        // the http request is not fired unless the observable is subscribed to ?\n        this.widgetAnalyticsService.sendAnalytic(payload).subscribe({\n          next: (e) => {},\n          error: (e) => {\n            throw new Error(e);\n          },\n        });\n    \n        // reset the log\n        Human.rpc.resetLog();\n      }\n    }, sendInterval);\n  }\n\n  private initEvents() {\n\n\n    defineEvent(\n      EventsEnum.HumanProgress,\n      undefined,\n      (e) => e\n    );\n\n    getHumanEvents().forEach(event => {\n      defineEvent(event.eventName, event.aliasEvents, event.mapFn);\n    });\n\n    getSceneEvents().forEach(event => {\n      defineEvent(event.eventName, event.aliasEvents, event.mapFn);\n    });\n\n    getCameraEvents(this.cameraService).forEach(event => {\n      defineEvent(event.eventName, event.aliasEvents, event.mapFn);\n    });\n\n    getTimelineEvents().forEach(event => {\n      defineEvent(event.eventName, event.aliasEvents, event.mapFn);\n    });\n\n    getInputEvents().forEach(event => {\n      defineEvent(event.eventName, event.aliasEvents, event.mapFn);\n    });\n\n    getUIEvents().forEach(event => {\n      defineEvent(event.eventName, event.aliasEvents, event.mapFn);\n    });\n\n    getLabelsEvents(Human, this.store).forEach(event => {\n      defineEvent(event.eventName, event.aliasEvents, event.mapFn);\n    });\n  }\n\n  private initProcedures() {\n    getHumanProcedures(Human, this.webGLInfo).forEach(proc => {\n      defineProcedure(proc);\n    });\n\n    getSceneProcedures(\n      this.store,\n      this.engineService,\n      this.paintService,\n      this.cameraService,\n      this.graphService,\n      this.animationService,\n      this.viewService,\n      this.visibilityLayersService\n    ).forEach(proc => {\n      defineProcedure(proc);\n    });\n    \n    getCameraProcedures(this.store, this.cameraService).forEach(proc => {\n      defineProcedure(proc);\n    });\n\n    getTimelineProcedures(this.store, this.actions, this.animationService, this.viewService).forEach(proc => {\n      defineProcedure(proc);\n    });\n\n    getInputProcedures(this.store).forEach(proc => {\n      defineProcedure(proc);\n    });\n\n    getUIProcedures(Human, this.store, this.actions, this.engineService, this.imageService).forEach(proc => {\n      defineProcedure(proc);\n    });\n\n    getLabelsProcedures(Human, this.store, this.labelsService, this.engineService).forEach(proc => {\n      defineProcedure(proc);\n    });\n  }\n}\n","import { EventsEnum } from '../engine/models/events.enum';\n\ndeclare const Human;\n\nexport interface RPCEvent<RPCResponse> {\n  eventName: EventsEnum;\n  aliasEvents?: EventsEnum[];\n  mapFn?: (params: any) => RPCResponse;\n}\n\nexport function defineEvent<RPCResponse>(\n  eventName: EventsEnum,\n  aliasEvents?: EventsEnum[],\n  mapFn?: (params: any) => RPCResponse\n) {\n  Human.rpc.defineEvent(eventName, {\n    events: aliasEvents || [eventName],\n    map: mapFn ? mapFn : (params: any) => <RPCResponse>params\n  });\n}\n","import { MessageEnum } from './models/message.enum';\nimport { Observable } from 'rxjs';\n\ndeclare const Human: any;\n\nexport type Func<A, B> = (params: A) => B;\n\ninterface RPCContext {\n  setResult: <T>(response: T) => void;\n}\n\nexport interface Procedure<RPCRequest, RPCResponse> {\n  procName: MessageEnum;\n  actionFn: Func<RPCRequest, RPCResponse>;\n  aliases?: MessageEnum[];\n  mapFnIn?: Func<any, RPCRequest>;\n  mapFnOut?: Func<any, RPCResponse>;\n  hideDefinition?: boolean;\n}\n\nexport function defineProcedure<RPCRequest, RPCResponse>(\n  procedure: Procedure<RPCRequest, RPCResponse>\n) {\n  \n  const { procName, actionFn, aliases = [], mapFnIn, mapFnOut, hideDefinition = false } = procedure;\n\n  const defineCallback = function(params: any) {\n    const self: RPCContext = this;\n\n    // map to model\n    const procParam: RPCRequest = mapFnIn ? mapFnIn(params) : <RPCRequest>params;\n    const procReturnValue: RPCResponse = actionFn(procParam);\n\n    if (typeof procReturnValue === 'undefined') {\n      return;\n    }\n\n    // publish result\n    if (procReturnValue instanceof Observable) {\n      const procReturnValue$: Observable<any> = procReturnValue;\n      procReturnValue$.subscribe(value => {\n        const out = mapFnOut ? mapFnOut(value) : value;\n        self.setResult(out);\n      });\n    } else {\n      const out = mapFnOut ? mapFnOut(procReturnValue) : procReturnValue;\n      self.setResult(out);\n    }\n  };\n\n  const procNames = [procName, ...aliases];\n  procNames.forEach(_procName => {\n    const defineRPCProc = () => Human.rpc.define(_procName, defineCallback);\n\n    if (hideDefinition) { // private RPC\n      Human.rpc.hideDefinitions(() => defineRPCProc());\n    } else { // public RPC\n      defineRPCProc();\n    }\n  });\n}\n","export enum MessageEnum {\n  AnnotationsCreate = 'annotations.create',\n  AnnotationsDestroy = 'annotations.destroy',\n  AnnotationsInfo = 'annotations.info',\n  AnnotationsSetDescription = 'annotations.setDescription',\n  AnnotationsSetLabelsShown = 'annotations.setLabelsShown',\n  AnnotationsSetTitle = 'annotations.setTitle',\n  AnnotationsUpdate = 'annotations.update',\n  AnnotationsSetEnabled = 'annotations.setEnabled',\n  CameraInfo = 'camera.info',\n  CameraOrbit = 'camera.orbit',\n  CameraPan = 'camera.pan',\n  CameraReset = 'camera.reset',\n  CameraSet = 'camera.set',\n  CameraZoom = 'camera.zoom',\n  GetAnnotationInfo = 'annotations.info',\n  HideAnnotations = 'annotations.hide',\n  HotspotsCreate = 'hotspots.create',\n  HotspotsDestroy = 'hotspots.destroy',\n  HotspotsHide = 'hotspots.hide',\n  HotspotsInfo = 'hotspots.info',\n  HotspotsShow = 'hotspots.show',\n  HotspotsTypes = 'hotspots.types',\n  HotspotsUpdate = 'hotspots.update',\n  HumanInfo = 'human.info',\n  InputDisable = 'input.disable',\n  InputEnable = 'input.enable',\n  // Labels API\n  LabelsCreate = 'labels.create',\n  LabelsDestroy = 'labels.destroy',\n  LabelsInfo = 'labels.info',\n  LabelsHide = 'labels.hide',\n  LabelsSetEnabled = 'labels.setEnabled',\n  LabelsShow = 'labels.show',\n  LabelsUpdate = 'labels.update',\n  LabelsCanvasUpdate = 'labels.canvasUpdate',\n  // labels internal use\n  LabelsSetScale = 'labels.setScale',\n  SceneMetaData = 'scene.metadata',\n  SceneSetHighlightColor = 'scene.setHighlightColor',\n  SceneColorObject = 'scene.colorObject',\n  SceneDisableHighlight = 'scene.disableHighlight',\n  SceneEnableHighlight = 'scene.enableHighlight',\n  SceneGetColor = 'scene.getColor',\n  SceneInfo = 'scene.info',\n  SceneLoad = 'scene.load',\n  ScenePick = 'scene.pick',\n  SceneReset = 'scene.reset',\n  SceneSelectObjects = 'scene.selectObjects',\n  SceneShowObjects = 'scene.showObjects',\n  SceneTransformObject = 'scene.transformObject',\n  SceneUncolorObject = 'scene.uncolorObject',\n  SceneSnapshot = 'scene.snapshot',\n  SceneCapture = 'scene.capture',\n  SceneRestore = 'scene.restore',\n  SceneEnableXrayMode = 'scene.enableXray',\n  SceneDisableXrayMode = 'scene.disableXray',\n  SceneSetLayersSliderPosition = 'scene.setLayersSliderPosition',\n  SceneGetLayers = 'scene.getLayers',\n  ShowAnnotations = 'annotations.show',\n  SetAnnotationsShown = 'annotations.setShown',\n  TimelineInfo = 'timeline.info',\n  TimelineQuery = 'timeline.query',\n  TimelineNext = 'timeline.nextChapter',\n  TimelinePause = 'timeline.pause',\n  TimelinePlay = 'timeline.play',\n  TimelinePrev = 'timeline.previousChapter',\n  TimelineSet = 'timeline.set',\n  UIGetBackground = 'ui.getBackground',\n  UIGetDisplay = 'ui.getDisplay',\n  UIGetWorldPosition = 'ui.getWorldPosition',\n  UISetBackground = 'ui.setBackground',\n  UISetDisplay = 'ui.setDisplay',\n  UIResetDisplay = 'ui.resetDisplay',\n  UISnapshot = 'ui.snapshot',\n  focusObject = 'focus.focusObject',\n  dissectSetEnabled = 'dissect.setEnabled',\n  pickSingleSetEnabled = 'pick.single.setEnabled',\n  pickMultiSetEnabled = 'pick.multi.setEnabled',\n  getCanvasPos = 'scene.getCanvasPos',\n  sceneSetClickMode = 'scene.setClickMode',\n  sceneGetClickMode = 'scene.getClickMode',\n  IsolateObject = 'scene.isolateObject',\n  setCameraMode = 'camera.setCameraMode',\n  // #TODO[AC]: implement private API calls\n  // SetInitialEnabled = 'widget.enableInitial',\n  // SetInitialDisabled = 'widget.disableInitial',\n  // SetScrollEnabled = 'widget.enableScroll',\n  // SetScrollDisabled = 'widget.disableScroll',\n  UISetLoadingExperience = 'ui.setLoadingExperience',\n  UISetScrollCaptureMode = 'ui.setScrollCaptureMode',\n  UISetTutorial = 'ui.setTutorial'\n}\n","import { Procedure } from '../define-procedure';\nimport { Store } from '@ngxs/store';\nimport { RPCEvent } from '../define-event';\nimport { MessageEnum } from '../models/message.enum';\nimport { LabelsService } from 'src/app/story/labels.service';\nimport { LabelModel } from 'src/app/story/models/labels/label.model';\nimport { AnnotationModel } from 'src/app/story/models/labels/annotation.model';\nimport { LabelThemeEnum } from 'src/app/story/models/labels/label-theme.enum';\nimport { StoryChaptersState } from 'src/app/story/state/chapters/story.chapters.state';\nimport { AddLabel, RemoveLabel, SetLabel, SetLabelsShown, SetAllLabelsShown } from 'src/app/story/state/labels/story.labels.actions';\nimport { EventsEnum } from 'src/app/engine/models/events.enum';\nimport { StoryLabelsState } from 'src/app/story/state/labels/story.labels.state';\nimport { MarkerModel } from 'src/app/story/models/marker.model';\nimport { HumanInterface } from '../models/human.interface';\nimport { AnnotationsIO } from '../models/annotations.io';\n\nfunction getDistinct<T>(values: T[]): T[] {\n  const valuesSet = new Set(values);\n  return Array.from(valuesSet.values());\n}\n\nfunction getLabels(store: Store): LabelModel[] {\n  return store.selectSnapshot(StoryLabelsState.getChapterLabels);\n}\n\nfunction getLabelById(store: Store, labelId: string): LabelModel {\n  const labels = getLabels(store);\n  return findLabelById(labels, labelId);\n}\n\nfunction getMarkerById(human: HumanInterface, labelId: string): MarkerModel {\n  return human.scene.markers.markers[labelId];\n}\n\nfunction findLabelById(labels: LabelModel[], labelId: string): LabelModel {\n  return labels.find((label) => labelId === label.id);\n}\n\nfunction findLabelsByIds(labels: LabelModel[], labelIds: string[]): LabelModel[] {\n  return labels.filter((label) => labelIds.includes(label.id));\n}\n\nfunction findLabelsByObjectId(labels: LabelModel[], ...objectIds: string[]): LabelModel[] {\n  const allFoundLabels = objectIds.map((objectId) => {\n    const labelsByObjectId = labels.filter((label) => objectId === label.objectId);\n    return labelsByObjectId;\n  });\n  // flatten list\n  const flatLabels = [].concat(...allFoundLabels);\n  return getDistinct(flatLabels);\n}\n\nfunction convertAnnotationToLabel(\n  human: HumanInterface,\n  store: Store,\n  labelsService: LabelsService,\n  request: AnnotationsIO.AnnotationsCreateProcRequest\n): LabelModel {\n  const chapter = store.selectSnapshot(StoryChaptersState.getSelectedChapter);\n\n  // if the request objectId isn't in the scene, replace it with undefined.\n  const objectIdSanitized = human.scene.objects[request.objectId]\n    ? request.objectId\n    : undefined;\n\n  // API annotation request -> app annotation\n  const annotation: AnnotationModel = {\n    annotationId: request.annotationId,\n    title: request.title,\n    description: request.description,\n    objectId: objectIdSanitized,\n    pos: request.position,\n    occludable: request.occludable,\n    labelOffset: request.labelOffset,\n    shown: request.shown,\n    labelShown: request.shown\n  };\n\n  // Prevent labels from being unoccludable.\n  // The engine requires markers to have a defined position if they are to be occludable.\n  // If the request has an object Id, and no position, assign a position.\n  // https://github.com/biodigital-human/human-engine/blob/master/src/scene/markers.js#L121\n  // https://github.com/biodigital-human/human-engine/blob/master/src/scene/markers.js#L121\n  if (annotation.objectId && annotation.pos === undefined) {\n    annotation.pos = human.scene.objects[annotation.objectId].center;\n  }\n\n  // app annotation -> app label\n  return labelsService.deserializeAnnotation(\n    annotation,\n    chapter,\n    LabelThemeEnum.Annotation\n  );\n}\n\n\nfunction convertLabelToAnnotation(human: HumanInterface, label: LabelModel): AnnotationsIO.AnnotationResponse {\n  // associated marker\n  const marker: MarkerModel = getMarkerById(human, label.id);\n\n  // app label -> API annotation response\n  return {\n    annotationId: label.id,\n    objectId: label.objectId || null,\n    title: label.title,\n    description: label.description,\n    shown: label.shown,\n    occludable: label.occludable,\n    // live position tracked by marker\n    position: marker\n      ? {\n          x: marker.pos[0],\n          y: marker.pos[1],\n          z: marker.pos[2]\n        }\n      : null,\n    canvasPosition: marker\n      ? {\n          x: marker.canvasPos[0],\n          y: marker.canvasPos[1]\n        }\n      : null\n  };\n  \n}\n\nfunction convertLabelsToAnnotationsInfo(human: HumanInterface, labels: LabelModel[]): AnnotationsIO.AnnotationsInfo {\n  // annotation id -> annotation info\n  return labels.reduce((info, label) => {\n    info[label.id] = convertLabelToAnnotation(human, label);\n    return info;\n  }, {});\n}\n\nfunction createLabelFromAnnotation(store: Store, annotation: AnnotationsIO.AnnotationsUpdateProcRequest): LabelModel {\n  const label = getLabelById(store, annotation.annotationId);\n  if (label) {\n    return {\n      ...label,\n      ...annotation\n    };\n  } else {\n    return null;\n  }\n}\n\nfunction createLabel(store: Store, label: LabelModel): LabelModel {\n  // validate required fields for label creation\n  if (label.objectId || label.pos) {\n    store.dispatch(new AddLabel(label));\n    return label;\n  } else {\n    return null;\n  }\n}\n\nfunction updateLabel(store: Store, label: LabelModel): boolean {\n  // patch label w/ annotation data\n  if (label) {\n    store.dispatch(new SetLabel(label));\n  }\n  return true;\n}\n\nfunction deleteLabel(store: Store, label: LabelModel): boolean {\n  if (label) {\n    store.dispatch(new RemoveLabel(label));\n  }\n  return true;\n}\n\nfunction showAllLabels(store: Store, shown: boolean) {\n  store.dispatch(new SetAllLabelsShown(shown));\n  return true;\n}\n\nfunction createIdMapFromValue<T>(ids: string[], value: T): AnnotationsIO.IdMap<T> {\n  return ids.reduce((acc, id) => ({ ...acc, [`${id}`]: value }), {});\n}\n\nfunction filterMap<T>(idMap: AnnotationsIO.IdMap<T>, compareFn: (key: string, value: T) => boolean): AnnotationsIO.IdMap<T> {\n  return Object.entries(idMap)\n    .filter(([key, value]) => compareFn(key, value))\n    .reduce((acc, [key, value]) => ({ ...acc, [`${key}`]: value }), {});\n}\n\nfunction filterMapByValue<T>(idMap: AnnotationsIO.IdMap<T>, compareValue: T): AnnotationsIO.IdMap<T> {\n  return filterMap(idMap, (key, value) => value === compareValue);\n}\n\nfunction filterIdMapKeysByValue<T>(idMap: AnnotationsIO.IdMap<T>, compareValue: T): string[] {\n  return Object.keys(\n    filterMapByValue(idMap, compareValue)\n  );\n}\n\nfunction filterLabelsByMapValue<T>(labels: LabelModel[], idMap: AnnotationsIO.IdMap<T>, compareValue: T): LabelModel[] {\n  const labelIds = filterIdMapKeysByValue(idMap, compareValue);\n  return findLabelsByIds(labels, labelIds);\n}\n\nfunction createLabelMapFromObjectIdMap<T>(labels: LabelModel[], objectIdMap: AnnotationsIO.IdMap<T>, compareValue: T): AnnotationsIO.IdMap<T> {\n  const allIds = filterIdMapKeysByValue(objectIdMap, compareValue) // get list of object ids\n    .map((objectId) => findLabelsByObjectId(labels, objectId)) // get labels by object\n    .map((objectLabels) => objectLabels.map((a) => a.id)); // get ids\n  const flatIds = [].concat(...allIds);\n  return createIdMapFromValue(flatIds, compareValue);\n}\n\nfunction getLabelsShownMap(store: Store, params: AnnotationsIO.SetLabelsShownRequest): AnnotationsIO.IdMap<boolean> {\n  const { annotations, objects, replace, type } = params;\n  const annotationsIdMap = annotations || {};\n  const objectsIdsMap = objects || {};\n  const labels = getLabels(store);\n\n  const idShownMap: AnnotationsIO.IdMap<boolean> = {\n    // filter by annotation id\n    ...filterMapByValue(annotationsIdMap, true),\n    ...filterMapByValue(annotationsIdMap, false),\n    // Show/hide labels for annotations on target objects\n    ...createLabelMapFromObjectIdMap(labels, objectsIdsMap, true),\n    ...createLabelMapFromObjectIdMap(labels, objectsIdsMap, false)\n    // #TODO[AC]: filter by type???\n  };\n\n  // replace: hide all others\n  if (replace) {\n    return {\n      // hide all labels\n      ...createIdMapFromValue(labels.map((label) => label.id), false),\n      // replace w/ target config\n      ...idShownMap\n    };\n  } else {\n    return idShownMap;\n  }\n}\n\nfunction setLabelsShown(store: Store, labelShownMap: AnnotationsIO.IdMap<boolean>) {\n  const labels = getLabels(store);\n  const labelsToHide = filterLabelsByMapValue(labels, labelShownMap, false);\n  const labelsToShow = filterLabelsByMapValue(labels, labelShownMap, true);\n\n  // show labels\n  store.dispatch(new SetLabelsShown(labelsToShow, true));\n  // hide labels\n  store.dispatch(new SetLabelsShown(labelsToHide, false));\n}\n\nexport function getAnnotationEvents(human: HumanInterface, store: Store): RPCEvent<AnnotationsIO.AnnotationEventResponse>[] {\n  return [\n    {\n      eventName: EventsEnum.AnnotationsCreated,\n      aliasEvents: [EventsEnum.LabelsCreated],\n      mapFn: (label: LabelModel) => convertLabelToAnnotation(human, label)\n    },\n    {\n      eventName: EventsEnum.AnnotationsDestroyed,\n      aliasEvents: [EventsEnum.LabelsDestroyed],\n      mapFn: (label: LabelModel) => ({ annotationId: label.id })\n    },\n    {\n      eventName: EventsEnum.AnnotationsShown,\n      aliasEvents: [EventsEnum.LabelsEnabled],\n      mapFn: () => true\n    },\n    {\n      eventName: EventsEnum.AnnotationsHidden,\n      aliasEvents: [EventsEnum.LabelsDisabled],\n      mapFn: () => true\n    }\n  ];\n}\n\nexport function getAnnotationProcedures(\n  human: HumanInterface,\n  store: Store,\n  labelsService: LabelsService\n): Procedure<AnnotationsIO.AnnotationProcRequest, AnnotationsIO.AnnotationProcResponse>[] {\n  return [\n    {\n      procName: MessageEnum.AnnotationsInfo,\n      actionFn: () => getLabels(store),\n      mapFnOut: (labels: LabelModel[]) => convertLabelsToAnnotationsInfo(human, labels)\n    },\n    {\n      procName: MessageEnum.AnnotationsCreate,\n      mapFnIn: (request: AnnotationsIO.AnnotationsCreateProcRequest) => convertAnnotationToLabel(human, store, labelsService, request),\n      actionFn: (label: LabelModel) => createLabel(store, label),\n      mapFnOut: (label: LabelModel) => label ? convertLabelToAnnotation(human, label) : null\n    },\n    {\n      procName: MessageEnum.AnnotationsUpdate,\n      mapFnIn: (params: AnnotationsIO.AnnotationsUpdateProcRequest) => createLabelFromAnnotation(store, params),\n      actionFn: (label: LabelModel) => updateLabel(store, label)\n    },\n    {\n      procName: MessageEnum.AnnotationsSetTitle,\n      mapFnIn: (params: AnnotationsIO.AnnotationsUpdateProcRequest) => createLabelFromAnnotation(store, params),\n      actionFn: (label: LabelModel) => updateLabel(store, label),\n      hideDefinition: true\n    },\n    {\n      procName: MessageEnum.AnnotationsSetDescription,\n      mapFnIn: (params: AnnotationsIO.AnnotationsUpdateProcRequest) => createLabelFromAnnotation(store, params),\n      actionFn: (label: LabelModel) => updateLabel(store, label),\n      hideDefinition: true\n    },\n    {\n      procName: MessageEnum.AnnotationsDestroy,\n      mapFnIn: (annotationId: AnnotationsIO.AnnotationsDestroyRequest) => getLabelById(store, annotationId),\n      actionFn: (label: LabelModel) => deleteLabel(store, label)\n    },\n    {\n      procName: MessageEnum.ShowAnnotations,\n      actionFn: () => showAllLabels(store, true)\n    },\n    {\n      procName: MessageEnum.SetAnnotationsShown,\n      actionFn: () => showAllLabels(store, true),\n      hideDefinition: true\n    },\n    {\n      procName: MessageEnum.HideAnnotations,\n      actionFn: () => showAllLabels(store, false)\n    },\n    {\n      procName: MessageEnum.AnnotationsSetLabelsShown,\n      mapFnIn: (params: AnnotationsIO.SetLabelsShownRequest) => getLabelsShownMap(store, params),\n      actionFn: (labelShownMap: AnnotationsIO.IdMap<boolean>) => setLabelsShown(store, labelShownMap),\n      hideDefinition: true\n    }\n  ];\n}\n","import { Procedure } from '../define-procedure';\nimport { CameraService } from 'src/app/engine/camera.service';\nimport { Store } from '@ngxs/store';\nimport { MessageEnum } from '../models/message.enum';\nimport {\n  RotateCameraStatic,\n  PanCameraStatic,\n  ResetCamera,\n  SetCamera,\n  ZoomCameraStatic,\n  SetCameraMode\n} from 'src/app/engine/state/camera/engine.camera.actions';\nimport { CameraModel } from 'src/app/engine/models/camera.model';\nimport { EventsEnum } from 'src/app/engine/models/events.enum';\nimport { RPCEvent } from '../define-event';\nimport {\n  CameraInfoResponse,\n  CameraEventResponse,\n  CameraProcRequest,\n  CameraProcResponse,\n  CameraOrbitRequest,\n  CameraPanRequest,\n  CameraSetRequest,\n  CameraZoomRequest,\n  SetCameraModeRequest\n} from '../models/camera.io';\nimport { FlyToObject } from 'src/app/engine/state/engine.actions';\n\nfunction formatCameraInfo(cameraService: CameraService): CameraInfoResponse {\n  const capture = cameraService.captureCamera();\n  return {\n    position: capture.lookAt.eye,\n    target: capture.lookAt.look,\n    up: capture.lookAt.up,\n    zoom: capture.zoom\n  };\n}\n\nexport function getCameraEvents(\n  cameraService: CameraService\n): RPCEvent<CameraEventResponse>[] {\n  return [\n    {\n      eventName: EventsEnum.CameraUpdated,\n      aliasEvents: [EventsEnum.CameraRested],\n      mapFn: () => formatCameraInfo(cameraService)\n    }\n  ];\n}\n\nexport function getCameraProcedures(\n  store: Store,\n  cameraService: CameraService\n): Procedure<CameraProcRequest, CameraProcResponse>[] {\n  return [\n    {\n      procName: MessageEnum.CameraInfo,\n      actionFn: () => formatCameraInfo(cameraService)\n    },\n    {\n      procName: MessageEnum.CameraOrbit,\n      actionFn: (params: CameraOrbitRequest) => {\n        const x = params.pitch === undefined ? 0 : params.pitch;\n        const y = params.yaw === undefined ? 0 : params.yaw;\n        store.dispatch(new RotateCameraStatic(x, y));\n        return true;\n      }\n    },\n    {\n      procName: MessageEnum.CameraPan, \n      actionFn: (params: CameraPanRequest) => {\n        const x = params.x === undefined ? 0 : params.x;\n        const y = params.y === undefined ? 0 : params.y;\n        const z = params.z === undefined ? 0 : params.z;\n        store.dispatch(new PanCameraStatic(x, y, z));\n        return true;\n      }\n    },\n    {\n      procName: MessageEnum.CameraReset,\n      actionFn: () => store.dispatch(new ResetCamera())\n    },\n    {\n      procName: MessageEnum.CameraSet,\n      actionFn: (params: CameraSetRequest) => {\n        const animate = params.animate || false;\n\n        if (params.objectId) {\n          store.dispatch(\n            new FlyToObject(params.objectId, animate, params.animationDuration)\n          );\n          return true;\n        }\n        \n        const currentCamera = formatCameraInfo(cameraService);\n        const destination: CameraModel = {\n          eye: params.position || currentCamera.position,\n          look: params.target || currentCamera.target,\n          up: params.up || currentCamera.up\n        };\n        \n        store.dispatch(new SetCamera(destination, animate));\n        return true;\n      }\n    },\n    {\n      procName: MessageEnum.CameraZoom,\n      actionFn: (zoom: CameraZoomRequest) => {\n        store.dispatch(new ZoomCameraStatic(zoom || 0));\n        return true;\n      }\n    },\n    {\n      procName: MessageEnum.setCameraMode,\n      actionFn: (mode: SetCameraModeRequest) => {\n        store.dispatch(new SetCameraMode(mode === 'pan' ? 'pan' : 'rotate'));\n        return true;\n      }\n    }\n  ];\n}\n","import { Procedure } from '../define-procedure';\nimport { Store } from '@ngxs/store';\nimport { RPCEvent } from '../define-event';\nimport { MessageEnum } from '../models/message.enum';\nimport { LabelsService } from 'src/app/story/labels.service';\nimport { XYZModel } from 'src/app/shared/models/xyz.model';\nimport { StoryLabelsState } from 'src/app/story/state/labels/story.labels.state';\nimport { LabelModel } from 'src/app/story/models/labels/label.model';\nimport { StoryChaptersState } from 'src/app/story/state/chapters/story.chapters.state';\nimport { ChapterModel } from 'src/app/story/models/chapter.model';\nimport { RemoveLabel, AddLabel, SetLabel, SetLabelsShown, SetAllLabelsShown } from 'src/app/story/state/labels/story.labels.actions';\nimport { HotspotTypeEnum } from 'src/app/story/models/labels/hotspot.types.enum';\nimport { HotspotModel } from 'src/app/story/models/labels/hotspot.model';\nimport { LabelPinType } from 'src/app/story/models/labels/label-pin-type.enum';\nimport { LabelThemeEnum } from 'src/app/story/models/labels/label-theme.enum';\nimport { omitBy, isNil } from 'lodash';\nimport { HumanInterface } from '../models/human.interface';\nimport { MarkerModel } from 'src/app/story/models/marker.model';\nimport { EventsEnum } from 'src/app/engine/models/events.enum';\nimport { HotspotsIO } from '../models/hotspots.io';\n\n/* \n  TODO[AC]\n  - cache user defined hotspot data\n  - to be deprecated: should be maintained by client\n*/\nconst dataCache: { [key: string]: object; } = {};\nfunction addHotspotData(id: string, hotspot: HotspotsIO.APIHotspotModel) {\n  if (hotspot.hasOwnProperty('data')) {\n    hotspot[id] = hotspot.data;\n  }\n}\n\n/*\nNotes:\n- Hotspot IDs are numbers (int) instead of pass-through string IDs.\n- Needs to be converted and tracked. label id (string) -> hotspot id (number) | hotspot id (number) -> label id (string)\n- IDs are incremented on creation, querying etc.., to prevent collisions.\n*/\n\nconst HotspotManager = {\n  // incremental hotspot id\n  hotspotSeedId: 0,\n\n  // map of label id (string) -> hotspot id (number)\n  hotspotIdMap: new Map<string, number>(),\n\n  getHotspotMap: (store: Store) => {\n    const { hotspotIdMap, createHotspotId } = HotspotManager;\n    // side effect: ensure global id map is updated\n    const labels = store.selectSnapshot(StoryLabelsState.getLabels);\n    labels.forEach((label) => {\n      const labelId = label.id;\n      const hotspotId = hotspotIdMap.get(labelId);\n      if (typeof (hotspotId) === 'undefined') {\n        createHotspotId(labelId);\n      }\n    });\n    return hotspotIdMap;\n  },\n\n  createHotspotId: (labelId: string) => {\n    // increament seed + add entry\n    HotspotManager.hotspotSeedId++;\n    HotspotManager.hotspotIdMap.set(labelId, HotspotManager.hotspotSeedId);\n    return HotspotManager.hotspotSeedId;\n  },\n\n  getHotspotIdByLabel: (store: Store, input: string, createEntry?: boolean) => {\n    const { getHotspotMap, createHotspotId } = HotspotManager;\n    const idMap = getHotspotMap(store);\n    const hotspotId = idMap.get(input);\n    // create entry if needed\n    return createEntry && typeof (hotspotId) === 'undefined' ? createHotspotId(input) : hotspotId;\n  },\n\n  getLabelIdByHotspotId: (store: Store, input: number) => {\n    const idMap = HotspotManager.getHotspotMap(store);\n    const foundPair = Array.from(idMap)\n      .find(([lablId, hotspotId]) => hotspotId === input);\n\n    return foundPair ? foundPair[0] : null;\n  }\n};\n\nfunction getLabels(store: Store, chapterId?: string): LabelModel[] {\n  const labels = store.selectSnapshot(StoryLabelsState.getLabels);\n  return typeof (chapterId) !== 'undefined'\n    ? labels.filter((label) => label.chapterId === chapterId) // filter by chapter\n    : labels; // all labels\n}\n\nfunction getLabelByHotspotId(store: Store, hotspotId: number): LabelModel {\n  const labels = getLabels(store);\n  const labelId = HotspotManager.getLabelIdByHotspotId(store, hotspotId);\n  return labels.find((label) => label.id === labelId);\n}\n\nfunction getMarkerById(human: HumanInterface, labelId: string): MarkerModel {\n  return human.scene.markers.markers[labelId];\n}\n\nfunction convertHotspotToLabel(store: Store, labelsService: LabelsService, hotspot: HotspotsIO.APIHotspotModel): LabelModel {\n  const { title, objectId, position, direction, chapterScope, type } = hotspot;\n  const chapters = store.selectSnapshot(StoryChaptersState.getStoryChapters);\n  const chapter = store.selectSnapshot(StoryChaptersState.getSelectedChapter);\n  const chapterIndex = store.selectSnapshot(StoryChaptersState.getSelectedChapterIndex);\n\n  \n  const targetChapterIndex = typeof (chapterScope) === 'number' ? chapterScope : chapterIndex;\n  const targetChapter = chapters[targetChapterIndex] || chapter;\n  \n  // shown state\n  const shown = hotspot.shown !== false;\n  const labelShown = shown && !!title;\n\n  const hotspotModel: HotspotModel = {\n    title: title,\n    type: type ? type : HotspotTypeEnum.CircleLabel,\n    objectId: objectId,\n    pos: position ? fromXYZ(position) : null,\n    dir: direction ? fromXYZ(direction) : null,\n    shown: shown,\n    symbol: '',\n    className: '',\n  };\n\n  // convert to app style label\n  const label = labelsService.deserializeHotspots({}, targetChapter, targetChapterIndex, hotspotModel);\n  label.title = title;\n\n  label.expandTag = true;\n  label.flyTo = false;\n  label.flyToTarget = null;\n  label.occludable = true;\n  label.pinGlow = false;\n  label.pinType = LabelPinType.PlusMinus;\n\n  // initial label shown state\n  label.shown = shown;\n  label.hideTag = !labelShown;\n  label.hideWire = true;\n\n  // set themes\n  label.theme = LabelThemeEnum.StudioNext;\n  // set pin type\n  label.pinType = convertHotspotPinTypeToLabelPinType(type);\n\n  // #TODO[AC]: cache client data\n  addHotspotData(label.id, hotspot);\n\n  return label;\n}\n\nfunction convertHotspotPinTypeToLabelPinType(hotspotType: HotspotTypeEnum): LabelPinType {\n  if (hotspotType === HotspotTypeEnum.CirclePlus) {\n    return LabelPinType.Plus;\n  } else if (hotspotType === HotspotTypeEnum.CircleMinus) {\n    return LabelPinType.Minus;\n  } else {\n    return LabelPinType.Default;\n  }\n}\n\nfunction convertLabelIdToHotspotId(store: Store, labelId: string): number {\n  // get hotspot id\n  return HotspotManager.getHotspotIdByLabel(store, labelId);\n}\n\n// utility to normalize string id properties to number id properties\nfunction convertLabelResponseToHotspotResponse<Response extends\n  HotspotsIO.HotspotsEventResponse>(store: Store, input: HotspotsIO.IIdModel<string>): Response {\n  return <Response>{\n    ...input,\n    // string id -> number id\n    id: convertLabelIdToHotspotId(store, input.id)\n  };\n}\n\nfunction convertLabelPositionToHotspotPosition(store: Store, label: HotspotsIO.LabelPositionResponse): HotspotsIO.HotspotPositionResponse {\n  const { id, canvasPos } = label;\n  const { x, y } = canvasPos;\n  return {\n    id: convertLabelIdToHotspotId(store, id),\n    canvasPosition: {\n      x,\n      y,\n      0: x,\n      1: y\n    },\n    occluded: label.occluded\n  };\n}\n\nfunction mergeLabelAndHotspot(hotspot: HotspotsIO.APIHotspotModel, label: LabelModel): LabelModel {\n  const { title, objectId, direction, position, shown, type } = hotspot;\n  const extensions = {\n    ...label,\n    title,\n    objectId,\n    shown,\n    pos: position ? fromXYZ(position) : null,\n    dir: direction ? fromXYZ(direction) : null,\n    pinType: type ? convertHotspotPinTypeToLabelPinType(type) : null\n  };\n\n  // #TODO[AC]: cache client data\n  addHotspotData(label.id, hotspot);\n\n  return {\n    ...label, // copy base properties\n    ...omitBy(extensions, isNil) // trim null extended properties\n  };\n}\n\nfunction convertLabelToHotspot(human: HumanInterface, store: Store, chapters: ChapterModel[], label: LabelModel): HotspotsIO.APIHotspotModel {\n  // get label props\n  const { id, chapterId, title, objectId } = label;\n  // get chapter scope\n  const chapterIndex = chapters.findIndex((chapter) => chapterId === chapter.id);\n\n  // get mapped hotspot ID, else create\n  const hotspotId = HotspotManager.getHotspotIdByLabel(store, id, true);\n  const marker = getMarkerById(human, id);\n\n  return {\n    id: hotspotId,\n    title: title,\n    objectId: objectId,\n    position: marker ? toXYZ(marker.pos) : null,\n    direction: marker ? toXYZ(marker.dir) : null,\n    canvasPosition: marker ? toXY(marker.canvasPos) : null,\n    chapterScope: chapterIndex,\n    type: label.pinType === LabelPinType.PlusMinus ? HotspotTypeEnum.CirclePlus : HotspotTypeEnum.Circle,\n    shown: label.shown,\n    data: dataCache[label.id]\n  };\n}\n\nfunction convertLabelsToHotspots(human: HumanInterface, store: Store, labels: LabelModel[]): HotspotsIO.APIHotspotModel[] {\n  const chapters = store.selectSnapshot(StoryChaptersState.getStoryChapters);\n  return labels.map((label) => convertLabelToHotspot(human, store, chapters, label));\n}\n\nfunction toXYZ(input: number[] | Float32Array): XYZModel {\n  return { x: input[0], y: input[1], z: input[2] };\n}\n\nfunction fromXYZ(input: XYZModel): [number, number, number] {\n  return [input.x, input.y, input.z];\n}\n\nfunction toXY(input: number[] | Float32Array): HotspotsIO.XYModel {\n  return { x: input[0], y: input[1] };\n}\n\nfunction getHotspotTypes() {\n  return Object.values(HotspotTypeEnum)\n    .map((type) => `${type}`);\n}\n\nfunction createLabel(store: Store, label: LabelModel): LabelModel {\n  // validate required fields for label creation\n  if (label.objectId || label.pos) {\n    store.dispatch(new AddLabel(label));\n    return label;\n  } else {\n    return null;\n  }\n}\n\nfunction updateLabel(store: Store, label: LabelModel): LabelModel {\n  store.dispatch(new SetLabel(label));\n  return label;\n}\n\nfunction destroyLabel(store: Store, label: LabelModel): LabelModel {\n  store.dispatch(new RemoveLabel(label));\n  return label;\n}\n\nfunction convertLabelFromHotspot(store: Store, hotspot: HotspotsIO.APIHotspotModel): LabelModel {\n  // get label\n  const label = getLabelByHotspotId(store, hotspot.id);\n  if (label) {\n    // update label from hotspot\n    return mergeLabelAndHotspot(hotspot, label);\n  } else {\n    return null;\n  }\n}\n\nfunction setLabelsShown(store: Store, labels: LabelModel[], shown: boolean): true {\n  store.dispatch(new SetLabelsShown(labels, shown));\n  return true;\n}\n\nfunction getLabelsFromHotspotFilter(store: Store, hotspotFilter?: HotspotsIO.HotspotFilter): LabelModel[] {\n  if (typeof (hotspotFilter) === 'number') {\n    const label = getLabelByHotspotId(store, hotspotFilter);\n    return label ? [label] : [];\n  } else {\n    return getLabels(store);\n  }\n}\n\nexport function getHotspotsEvents(human: HumanInterface, store: Store): RPCEvent<HotspotsIO.HotspotsEventResponse>[] {\n  return [\n    {\n      eventName: EventsEnum.HotspotsEntered,\n      mapFn: (response: HotspotsIO.LabelIdResponse) => convertLabelResponseToHotspotResponse<HotspotsIO.HotspotIdResponse>(store, response)\n    },\n    {\n      eventName: EventsEnum.HotspotsLeft,\n      mapFn: (response: HotspotsIO.LabelIdResponse) => convertLabelResponseToHotspotResponse<HotspotsIO.HotspotIdResponse>(store, response)\n    },\n    {\n      eventName: EventsEnum.HotspotsPicked,\n      mapFn: (response: HotspotsIO.LabelIdResponse) => convertLabelResponseToHotspotResponse<HotspotsIO.HotspotIdResponse>(store, response)\n    },\n    {\n      eventName: EventsEnum.HotspotsDisplayUpdated,\n      mapFn: (response: HotspotsIO.LabelDisplayResponse) => convertLabelResponseToHotspotResponse<HotspotsIO.HotspotDisplayResponse>(store, response)\n    },\n    {\n      eventName: EventsEnum.HotspotsPositionUpdated,\n      mapFn: (response: HotspotsIO.LabelPositionResponse) => convertLabelPositionToHotspotPosition(store, response)\n    }\n  ];\n}\n\nexport function getHotspotsProcedures(\n  human: HumanInterface,\n  store: Store,\n  labelsService: LabelsService\n): Procedure<HotspotsIO.HotspotsProcRequest, HotspotsIO.HotspotsProcResponse>[] {\n  return [\n    {\n      procName: MessageEnum.HotspotsInfo,\n      actionFn: (hotspotId?: HotspotsIO.HotspotFilter) => {\n        \n        // if no param is sent by the client,\n        // the RPC layer passes along an empty object, instead of undefined :/\n        const sanitizedHotspotId = typeof hotspotId === 'number'\n          ? hotspotId \n          : undefined;\n\n        // Mimic existing API:\n        // if a hotspotId is requested, just return that hotspot.\n        if (sanitizedHotspotId !== undefined) {\n          const label = getLabelByHotspotId(store, sanitizedHotspotId);\n          const hotspot = convertLabelsToHotspots(human, store, [label])[0];\n          return hotspot;\n        } else {\n\n          // if no hotspotId is requested, return an array of hotspots.\n          const labels = getLabelsFromHotspotFilter(store, sanitizedHotspotId);\n          const hotspots = convertLabelsToHotspots(human, store, labels);\n          return hotspots;\n        }\n      }\n    },\n    {\n      procName: MessageEnum.HotspotsTypes,\n      mapFnIn: () => getHotspotTypes(),\n      actionFn: (types: string[]) => types\n    },\n    {\n      procName: MessageEnum.HotspotsCreate,\n      mapFnIn: (hotspot: HotspotsIO.APIHotspotModel) => convertHotspotToLabel(store, labelsService, hotspot),\n      actionFn: (label: LabelModel) => createLabel(store, label),\n      mapFnOut: (label: LabelModel) => label ? convertLabelIdToHotspotId(store, label.id) : null\n    },\n    {\n      procName: MessageEnum.HotspotsUpdate,\n      mapFnIn: (hotspot: HotspotsIO.APIHotspotModel) => convertLabelFromHotspot(store, hotspot),\n      actionFn: (label: LabelModel) => label ? updateLabel(store, label) : null\n    },\n    {\n      procName: MessageEnum.HotspotsDestroy,\n      mapFnIn: (hotspotId?: number) => getLabelByHotspotId(store, hotspotId),\n      actionFn: (label: LabelModel) => label ? destroyLabel(store, label) : null\n    },\n    {\n      procName: MessageEnum.HotspotsShow,\n      mapFnIn: (hotspotFilter: HotspotsIO.HotspotFilter) => getLabelsFromHotspotFilter(store, hotspotFilter),\n      actionFn: (labels: LabelModel[]) => setLabelsShown(store, labels, true)\n    },\n    {\n      procName: MessageEnum.HotspotsHide,\n      mapFnIn: (hotspotFilter: HotspotsIO.HotspotFilter) => getLabelsFromHotspotFilter(store, hotspotFilter),\n      actionFn: (labels: LabelModel[]) => setLabelsShown(store, labels, false)\n    }\n  ];\n}\n","import { Procedure } from '../define-procedure';\nimport { MessageEnum } from '../models/message.enum';\nimport { EventsEnum } from 'src/app/engine/models/events.enum';\nimport { RPCEvent } from '../define-event';\nimport { HumanInterface } from '../models/human.interface';\nimport { WebGLInfoModel } from '../models/webgl-info.model';\n\nexport interface HumanInfoResponse {\n  version: string;\n  webglInfo: WebGLInfoModel;\n  apiFunctions: string[];\n  apiEvents: string[];\n}\n\ntype HumanProcRequest = void;\ntype HumanProcResponse = HumanInfoResponse | void;\ntype HumanEventResponse = void;\n\nexport function getHumanEvents(): RPCEvent<HumanEventResponse>[] {\n  return [\n    {\n      eventName: EventsEnum.HumanReady,\n      aliasEvents: [EventsEnum.HumanStarted]\n    },\n    {\n      eventName: EventsEnum.Error,\n      aliasEvents: [EventsEnum.HumanError],\n      mapFn: (err) => err\n    }\n  ];\n}\n\nexport function getHumanProcedures(\n  human: HumanInterface,\n  webglInfo: WebGLInfoModel,\n): Procedure<HumanProcRequest, HumanProcResponse>[] {\n  return [\n    {\n      procName: MessageEnum.HumanInfo,\n      actionFn: () => {\n        return {\n          version: human.VERSION,\n          webglInfo: webglInfo,\n          apiFunctions: human.rpc.getProcedures().sort(),\n          apiEvents: human.rpc.getEvents().sort()\n        };\n      }\n    }\n  ];\n}\n","import { Procedure } from '../define-procedure';\nimport { Store } from '@ngxs/store';\nimport { MessageEnum } from '../models/message.enum';\nimport { RPCEvent } from '../define-event';\nimport { SetInputEnabled } from 'src/app/widget-auth/state/widget.actions';\nimport { InputIO } from 'src/app/widget-api/models/input.io';\n\nexport function getInputEvents(): RPCEvent<InputIO.InputEventResponse>[] {\n  return [\n  ];\n}\n\nexport function getInputProcedures(\n  store: Store\n): Procedure<InputIO.InputProcRequest, InputIO.InputProcResponse>[] {\n  return [\n    {\n      procName: MessageEnum.InputEnable,\n      actionFn: () => {\n        store.dispatch(new SetInputEnabled(true));\n        return true;\n      }\n    },\n    {\n      procName: MessageEnum.InputDisable,\n      actionFn: () => {\n        store.dispatch(new SetInputEnabled(false));\n        return true;\n      }\n    }\n  ];\n}\n","import { Procedure } from '../define-procedure';\nimport { Store } from '@ngxs/store';\nimport { RPCEvent } from '../define-event';\nimport { LabelsService } from 'src/app/story/labels.service';\nimport { getAnnotationEvents, getAnnotationProcedures} from './annotations';\nimport { AnnotationsIO } from '../models/annotations.io';\nimport { LabelsIO } from '../models/labels.io';\nimport { HotspotsIO } from '../models/hotspots.io';\nimport { getHotspotsProcedures, getHotspotsEvents } from './hotspots';\nimport { MessageEnum } from '../models/message.enum';\nimport { ToggleLabels } from 'src/app/engine/state/engine.actions';\nimport { HumanInterface } from '../models/human.interface';\nimport { AddLabel, RemoveLabel, SetAllLabelsShown, SetLabel, SetLabelScale, SetLabelsShown } from 'src/app/story/state/labels/story.labels.actions';\nimport { LabelModel } from 'src/app/story/models/labels/label.model';\nimport { StoryLabelsState } from 'src/app/story/state/labels/story.labels.state';\nimport { MarkerModel } from 'src/app/story/models/marker.model';\nimport { StoryChaptersState } from 'src/app/story/state/chapters/story.chapters.state';\nimport { PickModel } from 'src/app/engine/models/pick.model';\nimport { FlyToObjectErrandModel } from 'src/app/story/models/errands/fly-to-object-errand.model';\nimport { FlyToChapterErrandModel } from 'src/app/story/models/errands/fly-to-chapter-errand.model';\nimport { uuid } from 'src/app/shared/uuid';\nimport { EventsEnum } from 'src/app/engine/models/events.enum';\nimport { EngineService } from 'src/app/engine/engine.service';\nimport { LabelStateModel } from 'src/app/story/models/labels/label-state.model';\nimport { FlyToCameraErrandModel } from 'src/app/story/models/errands/fly-to-camera-errand.model';\nimport { ChapterModel } from 'src/app/story/models/chapter.model';\nimport { trim } from 'lodash';\nimport { CameraModel } from 'src/app/engine/models/camera.model';\n\ninterface SetLabelEnabled {\n  enable: boolean;\n}\n\ninterface SetLabelScaleInterface {\n  scale: number;\n}\n\nfunction getLabels(store: Store): LabelModel[] {\n  return store.selectSnapshot(StoryLabelsState.getChapterLabels);\n}\nfunction showAllLabels(store: Store, shown: boolean) {\n  store.dispatch(new SetAllLabelsShown(shown));\n  return true;\n}\nfunction getLabelById(store: Store, labelId: string): LabelModel {\n  const labels = getLabels(store);\n  return labels.find((label) => labelId === label.id);\n}\nfunction getLabelsById(store: Store, labelIds: string[]): LabelModel[] {\n  const labels = getLabels(store);\n  return labels.filter((label) => labelIds.includes(label.id));\n}\n\nfunction storeLabel(store: Store, label: LabelModel, create: boolean): LabelModel {\n  // validate we are attached to a valid object\n  if (label && label.objectId) {\n    store.dispatch(create ? new AddLabel(label) : new SetLabel(label));\n    return label;\n  } \n  return null;\n}\n\nfunction createToLabel(\n  human: HumanInterface,\n  store: Store,\n  labelsService: LabelsService,\n  request: LabelsIO.LabelsCreateRequest\n): LabelModel {\n  const label = labelsService.makeDefaultStudioLabel();\n  label.id = request.labelId || uuid.idWithPrefix('label');\n  label.objectId = request.objectId;\n  label.pos = request.position;\n  label.renderableIndex = 0;\n  // set additional API default values not included in makeDefaultStudioLabel\n  label.occludable = true;\n  label.flyTo = true;\n  label.description = '';\n  label.shown = true;\n  const chapter = store.selectSnapshot(StoryChaptersState.getSelectedChapter);\n  label.chapterId = chapter.id;\n  return setOptionalParams(label, request, chapter);\n}\n\nfunction updateToLabel(\n  store: Store,\n  request: LabelsIO.LabelsUpdateRequest\n): LabelModel {\n  const label = getLabelById(store, request.labelId); \n  const chapter = store.selectSnapshot(StoryChaptersState.getSelectedChapter);\n  return setOptionalParams(label, request, chapter);\n}\n\nfunction updateCanvasToLabel(\n  store: Store,\n  engineService: EngineService, \n  request: LabelsIO.Labels2DRequest): LabelModel {\n    const label = getLabelById(store, request.labelId); \n    const canvasPosition = request.canvasPosition;\n    const pick: PickModel = {\n      x: canvasPosition[0],\n      y: canvasPosition[1],\n      rayPick: true\n    };\n    const hit = engineService.pickScene(pick);\n    if (hit && hit.objectId) {\n      label.objectId = hit.objectId;\n      label.pos = [hit.worldPos[0], hit.worldPos[1], hit.worldPos[2]];\n      const tagDistance = label.hideWire ? 20 : 32;      \n      label.offset = [tagDistance, 0];\n      label.barycentric = [hit.barycentric[0], hit.barycentric[1], hit.barycentric[2]];\n      label.primitiveIndex = hit.primitiveIndex;\n      label.renderableIndex = hit.renderableIndex || 0;\n      // label.dir = cameraService.getDirection(hit);\n      return label;\n    }\n  return null;\n}\n\nfunction setLabelOffset( label: LabelModel, offset?: [number, number] ): [number, number] {\n  if ( offset ) {\n    return offset;\n  } else {\n    const tagDistance = label.hideWire ? 20 : 32;\n    return [-tagDistance, 0];\n  }\n}\n\n// length check for markup language fields\nfunction checkLength(inputHtml: string, maxLength: number): boolean {\n  const span = document.createElement('span');\n  span.innerHTML = inputHtml;\n  const trimmed = trim(span.textContent);\n  return trimmed.length <= maxLength;\n}\n\nfunction setLabelFlyTo(label: LabelModel, flyTo?: boolean): boolean {\n  if (flyTo === false) {\n    return false;\n  }\n  return flyTo || label.flyTo;\n}\n\nfunction setLabelStates(label: LabelModel): LabelStateModel[] {\n  if (!label.flyTo) {\n    return [];\n  }\n  const states = [\n    new LabelStateModel(),\n    new LabelStateModel()\n  ];\n  states[0].errands = [new FlyToChapterErrandModel()];\n  states[1].errands = label.cameraPosition ? [new FlyToCameraErrandModel(label.cameraPosition)] : [new FlyToObjectErrandModel(label.objectId)];\n}\n\n// set the optional incoming parameters if they are present\nfunction setOptionalParams(labelIn: LabelModel, request: LabelsIO.LabelsRequest, chapter: ChapterModel) {\n  const label = labelIn;\n  label.title = request.title && checkLength(request.title, 100) ? request.title : label.title;\n  label.description = request.description && checkLength(request.description, 300) ? request.description : label.description;\n  label.theme = request.theme || label.theme;\n  label.pinType = request.pinType || label.pinType;\n  label.sequentialType = request.sequentialType || label.sequentialType;\n  label.offset = setLabelOffset( label, request.labelOffset );\n  label.pinGlow = request.pinGlow !== undefined ? request.pinGlow : label.pinGlow;\n  label.hideWire = request.hideWire !== undefined ? request.hideWire : label.hideWire;\n  label.hideTag = request.hideTag !== undefined ? request.hideTag : label.hideTag;\n  label.collapseDescription = request.collapseDescription !== undefined ? request.collapseDescription : label.collapseDescription;\n  label.occludable = request.occludable !== undefined ? request.occludable : label.occludable;\n  label.cameraPosition = request.flyToCamera || label.cameraPosition;\n  label.flyTo = setLabelFlyTo( label, request.flyTo );\n  label.states = setLabelStates( label );\n  return label;\n}\n\nfunction labelToResponse(human: HumanInterface, label: LabelModel): LabelsIO.LabelsResponse {\n  if (label) {\n    const marker: MarkerModel = human.scene.markers.markers[label.id];\n    return {\n      labelId: label.id,\n      objectId: label.objectId,\n      title: label.title,\n      description: label.description,\n      theme: label.theme,\n      pinType: label.pinType,\n      labelOffset: label.offset,\n      hideWire: label.hideWire,\n      pinGlow: label.pinGlow,\n      occludable: label.occludable,\n      sequentialType: label.sequentialType,\n      shown: label.shown,\n      collapseDescription: label.collapseDescription,\n      hideTag: label.hideTag,\n      flyTo: label.flyTo === true,\n      flyToCamera: label.cameraPosition,\n      position: marker ? [marker.pos[0], marker.pos[1], marker.pos[2]] : label.pos,\n      canvasPosition: marker ? [marker.canvasPos[0], marker.canvasPos[1]] : [-1, -1],\n      occluded: marker ? marker.occluded : true\n    };\n  } \n  return null;\n}\n\nfunction labelsToResponse(human: HumanInterface, labels: LabelModel[]): LabelsIO.LabelsInfoResponse {\n  return labels.reduce((info, label) => {\n    info[label.id] = labelToResponse(human, label);\n    return info;\n  }, {});\n}\n\ntype SetLabelEnabledRequest = SetLabelEnabled;\ntype SetLabelEnabledResponse = SetLabelEnabled;\ntype SetLabelScaleRequest = SetLabelScaleInterface;\ntype SetLabelScaleResponse = SetLabelScaleInterface;\n\ntype LabelsProcRequest = LabelsIO.LabelsProcRequest \n  | AnnotationsIO.AnnotationProcRequest \n  | HotspotsIO.HotspotsProcRequest \n  | SetLabelEnabledRequest \n  | SetLabelScaleRequest;\ntype LabelsProcResponse = LabelsIO.LabelsProcResponse \n  | AnnotationsIO.AnnotationProcResponse \n  | HotspotsIO.HotspotsProcResponse \n  | SetLabelEnabledResponse \n  | SetLabelScaleResponse;\ntype LabelsEventResponse = LabelsIO.LabelsEventResponse | AnnotationsIO.AnnotationEventResponse | HotspotsIO.HotspotsEventResponse;\n\nexport function getLabelsEvents(human: HumanInterface, store: Store): RPCEvent<LabelsEventResponse>[] {\n  return [\n    // legacy: annotation events\n    ...getAnnotationEvents(human, store),\n    // legacy: hotspot events\n    ...getHotspotsEvents(human, store),\n    // labels events\n    {\n      eventName: EventsEnum.LabelsChapterInfo,\n      mapFn: (labels: LabelModel[]) => labelsToResponse(human, labels)\n    },\n    {\n      eventName: EventsEnum.LabelsCreated,\n      mapFn: (label: LabelModel) => labelToResponse(human, label)\n    },\n    {\n      eventName: EventsEnum.LabelsUpdated,\n      mapFn: (label: LabelModel) => labelToResponse(human, label)\n    },\n    {\n      eventName: EventsEnum.LabelsDestroyed,\n      mapFn: (label: LabelModel) => { \n        return { 'labelId': label.id };\n      }\n    },\n    {\n      eventName: EventsEnum.LabelsEntered,\n      mapFn: (response: LabelsIO.LabelsIdResponse) => response\n    },\n    {\n      eventName: EventsEnum.LabelsLeft,\n      mapFn: (response: LabelsIO.LabelsIdResponse) => response\n    },\n    {\n      eventName: EventsEnum.LabelsPicked,\n      mapFn: (response: LabelsIO.LabelsIdResponse) => response\n    },\n    {\n      eventName: EventsEnum.LabelsMoved,\n      mapFn: (response: LabelsIO.LabelsMovedResponse) => response\n    },\n    {\n      eventName: EventsEnum.LabelsEnabled,\n      mapFn: () => true\n    },\n    {\n      eventName: EventsEnum.LabelsDisabled,\n      mapFn: () => true\n    },\n    {\n      eventName: EventsEnum.LabelsShown,\n      mapFn: (response: LabelsIO.LabelsIdResponse) => response\n    },\n    {\n      eventName: EventsEnum.LabelsHidden,\n      mapFn: (response: LabelsIO.LabelsIdResponse) => response\n    }\n  ];\n}\n\nexport function getLabelsProcedures(\n  human: HumanInterface,\n  store: Store,\n  labelsService: LabelsService,\n  engineService: EngineService\n): Procedure<LabelsProcRequest, LabelsProcResponse>[] {\n  return [\n    // legacy: annotation procedures\n    ...getAnnotationProcedures(human, store, labelsService),\n    // legacy: hotspot procedures\n    ...getHotspotsProcedures(human, store, labelsService),\n    // label procedures\n    {\n      procName: MessageEnum.LabelsInfo,\n      actionFn: (request?: LabelsIO.LabelsInfoRequest) => {\n        // optional request for a subset of labels\n        if (request.length > 0) {\n          return getLabelsById(store, request);\n        }\n        return store.selectSnapshot(StoryLabelsState.getChapterLabels);\n      },\n      mapFnOut: (labels: LabelModel[]) => labelsToResponse(human, labels)\n    },\n    {\n      procName: MessageEnum.LabelsCreate,\n      mapFnIn: (request: LabelsIO.LabelsCreateRequest) => {\n        if (request.labelId && getLabelById(store, request.labelId)) {\n          return null;  // error if the label id already exists\n        }\n        if (!request.objectId || !request.position) {\n          console.log('attempt to create a label with no objectId and position');\n          return null;  // is this already handled by required values?\n        }\n        return createToLabel(human, store, labelsService, request);\n      },\n      actionFn: (label: LabelModel) => storeLabel(store, label, true),\n      mapFnOut: (label: LabelModel) => labelToResponse(human, label)\n    },\n    {\n      procName: MessageEnum.LabelsUpdate,\n      mapFnIn: (request: LabelsIO.LabelsUpdateRequest) => \n        getLabelById(store, request.labelId) \n          ? updateToLabel(store, request)\n          : null,\n      actionFn: (label: LabelModel) => storeLabel(store, label, false),\n      mapFnOut: (label: LabelModel) => labelToResponse(human, label)   \n    },\n    {\n      procName: MessageEnum.LabelsCanvasUpdate,\n      mapFnIn: (request: LabelsIO.Labels2DRequest) => \n        getLabelById(store, request.labelId) \n          ? updateCanvasToLabel(store, engineService, request)\n          : null,\n      actionFn: (label: LabelModel) => storeLabel(store, label, false),\n      mapFnOut: (label: LabelModel) => labelToResponse(human, label)   \n    },\n    {\n      procName: MessageEnum.LabelsDestroy,\n      mapFnIn: (labelId: LabelsIO.LabelsDestroyRequest) => getLabelById(store, labelId),\n      actionFn: (label: LabelModel) => {\n        if (label) {\n          store.dispatch(new RemoveLabel(label));\n          return { labelId: label.id };\n        } \n        return null; // error if the label doesn't exist\n      }\n    },\n    {\n      procName: MessageEnum.LabelsShow,\n      actionFn: (request?: LabelsIO.LabelsShowRequest) => {\n        if (request.length > 0) {\n          store.dispatch(new SetLabelsShown(getLabelsById(store, request), true));\n        } else {\n          showAllLabels(store, true);\n        }\n        return true;\n      }\n    },\n    {\n      procName: MessageEnum.LabelsHide,\n      actionFn: (request?: LabelsIO.LabelsShowRequest) => {\n        if (request.length > 0) {\n          store.dispatch(new SetLabelsShown(getLabelsById(store, request), false));\n        } else {\n          showAllLabels(store, false);\n        }\n        return true;\n      }\n    },\n    {\n      procName: MessageEnum.LabelsSetEnabled,\n      aliases: [MessageEnum.AnnotationsSetEnabled],\n      actionFn: (params: SetLabelEnabledRequest) => {\n        store.dispatch(new ToggleLabels(params.enable));\n      },\n      hideDefinition: true\n    },\n    {\n      procName: MessageEnum.LabelsSetScale,\n      actionFn: (params: SetLabelScaleRequest) => {\n        store.dispatch(new SetLabelScale(params.scale));\n      }\n    }\n  ];\n}\n","import { SceneIO } from '../models/scene.io';\n\n// convert the old capture format to the new capture format\nexport namespace SceneAPIUtils {\n  export function isLegacyCaptureFormat(\n    capture: SceneIO.SceneCapture | SceneIO.LegacySceneCapture\n  ): capture is SceneIO.LegacySceneCapture {\n    return (capture as SceneIO.LegacySceneCapture).engineVersion !== undefined;\n  }\n\n  export function convertCaptureFormat(\n    capture: SceneIO.LegacySceneCapture\n  ): SceneIO.SceneCapture {\n    const objects = Object.keys(capture.objects).reduce<SceneIO.ObjectCaptureInfo[]>(\n      (acc, objectId) => {\n        acc.push({\n          objectId,\n          selected: false,\n          hidden: false\n        });\n        return acc;\n      },\n      []\n    );\n\n    return {\n      storyId: capture.timeline.rootName.replace('.json', ''),\n      camera: {\n        lookAt: capture.camera,\n        zoom: undefined\n      },\n      labels: [], // No support\n      objects, // old capture data does not include selected information.\n      background: [], // No support\n      activeChapterId: capture.timeline.scrub \n        ? capture.timeline.scrub.chapterId \n        : undefined\n    };\n  }\n}\n","import { Store } from '@ngxs/store';\nimport { EngineService } from 'src/app/engine/engine.service';\nimport { Procedure } from '../define-procedure';\nimport { EventsEnum } from 'src/app/engine/models/events.enum';\nimport { PickModel } from 'src/app/engine/models/pick.model';\nimport { MessageEnum } from '../models/message.enum';\nimport { HitModel } from 'src/app/engine/models/hit.model';\nimport { EngineState } from 'src/app/engine/state/engine.state';\nimport { RPCEvent } from '../define-event';\nimport { ContentType } from 'src/app/story/models/content-type.enum';\nimport { LoadStory } from 'src/app/story/state/story.actions';\nimport { StoryState } from 'src/app/story/state/story.state';\nimport { PaintService } from 'src/app/engine/paint.service';\nimport { SceneIO } from '../models/scene.io';\nimport { CameraService } from 'src/app/engine/camera.service';\nimport { StoryLabelsState } from 'src/app/story/state/labels/story.labels.state';\nimport { Observable } from 'rxjs';\nimport { SetCamera, ZoomCameraStatic } from 'src/app/engine/state/camera/engine.camera.actions';\nimport { SetLabels } from 'src/app/story/state/labels/story.labels.actions';\nimport { first } from 'rxjs/operators';\nimport { StoryChaptersState } from 'src/app/story/state/chapters/story.chapters.state';\nimport { SetChapterBackground, SelectChapterById } from 'src/app/story/state/chapters/story.chapters.actions';\nimport { BdGraphService } from 'src/lib/graph/graph.service';\nimport { ViewActions } from 'src/app/view/state/view.actions';\nimport { FlyToObject, SetActiveTool, SetXrayMode } from 'src/app/engine/state/engine.actions';\nimport { ToolEnum } from 'src/app/engine/models/tool.enum';\nimport { ViewState } from 'src/app/view/state/view.state';\nimport { _3DUtils } from 'src/app/shared/libraries/3d-utils/3d-utils';\nimport { appDefaultBackground } from 'src/app/dialogs/components/background-color-dialog/background-config';\nimport { SceneAPIUtils } from './scene-utils';\nimport { disableXrayMode } from 'src/app/shared/xray-mode';\nimport { NodeActions } from 'src/app/engine/state/nodes/engine.nodes.actions';\nimport { EngineColorRecipeModel } from 'src/app/edit/models/engine-color-recipe.model';\nimport { ColorRecipeModel } from 'src/app/edit/models/color-recipe.model';\nimport { EngineNodesState } from 'src/app/engine/state/nodes/engine.nodes.state';\nimport { ObjectId, NodeState } from 'src/app/engine/state/nodes/engine.nodes.state.model';\nimport { PaintPresetOriginal } from 'src/app/engine/models/paint-presets.const';\nimport { AnimationService } from 'src/app/engine/animation.service';\nimport { ViewService } from 'src/app/view/view.service';\nimport { VisibilityLayersService } from 'src/app/story/visibility-layers.service';\n\ndeclare const Human: any;\n\nfunction formatPickResult(hit: HitModel): SceneIO.ScenePickResponse {\n  if (!hit) {\n    return null;\n  }\n\n  const { objectId, canvasPos, worldPos } = hit;\n\n  return {\n    objectId: objectId\n      ? objectId\n      : undefined,\n    canvasPosition: canvasPos\n      ? {\n        x: canvasPos[0],\n        y: canvasPos[1]\n      }\n      : undefined,\n    mode: 'query',\n    position: worldPos\n      ? {\n        x: worldPos[0],\n        y: worldPos[1],\n        z: worldPos[2]\n      }\n      : undefined\n  };\n}\n\nfunction isParentSelected(\n  nodes: Record<ObjectId, NodeState>,\n  objectId: ObjectId\n) {\n  const parent = Human.scene.objects[objectId].parent;\n\n  if (parent === null) {\n    return false;\n  }\n\n  return (\n    nodes[parent.objectId].checked || isParentSelected(nodes, parent.objectId)\n  );\n}\n\n\nfunction buildSceneInfoResponse(\n  storyDisplayName: string,\n  objectIds: string[],\n  store: Store\n): SceneIO.SceneInfoResponse {\n  \n  const nodes = store.selectSnapshot(EngineNodesState.getNodes);\n\n  const humanObjectInfo = objectId => {\n    const humanObject = Human.scene.objects[objectId];\n\n    // if the object isn't a leaf, don't include a selected property for it!\n    const selected = humanObject.isLeaf()\n      ? nodes[objectId].checked || isParentSelected(nodes, objectId)\n      : undefined;\n\n    // FIXME: Heads up for future readers:\n    // The postmessage layer (Human API) is filtering properties that are undefined.\n    // So even though the key is present in this function's return val,\n    // it's being stripped before the client gets it.\n    // We will not stand for censorship! Free Hong Kong!\n\n    return {\n      objectId: humanObject.objectId,\n      name: humanObject.displayName,\n      description: humanObject.description || '',\n      shown: humanObject.shown,\n      selected: selected,\n      children: humanObject.objects.map(object => object.objectId),\n      parent: humanObject.parent ? humanObject.parent.objectId : null\n    };\n  };\n\n  const objects = objectIds.reduce((acc, objectId) => {\n    acc[objectId] = humanObjectInfo(objectId);\n    return acc;\n  }, {});\n\n  return {\n    name: storyDisplayName,\n    objects\n  };\n}\n\nfunction loadStory(store: Store, storyId: string) {\n  const type: ContentType = storyId.includes('/')\n    ? ContentType.Module\n    : ContentType.Bookmark;\n  store.dispatch(new LoadStory(storyId, type));\n}\n\n\nfunction captureScene(\n  store: Store,\n  cameraService: CameraService\n): SceneIO.SceneCapture {\n  // wrangle state from the store or engine\n  const camera = cameraService.captureCamera();\n  \n  const nodes = store.selectSnapshot(EngineNodesState.getNodes);\n  const objects: SceneIO.ObjectCaptureInfo[] = Object.keys(nodes).map(objectId => {\n    return {\n      objectId,\n      selected: nodes[objectId].checked || isParentSelected(nodes, objectId),\n      hidden: !nodes[objectId].shown\n    };\n  });\n\n  const background = store\n    .selectSnapshot(StoryChaptersState.getStoryChapters)\n    .map(chapter => {\n      return {\n        chapterId: chapter.id,\n        background: chapter.background || appDefaultBackground\n      };\n    });\n\n\n  // no transformations necessary for this capture data\n  const storyId = store.selectSnapshot(StoryState.getStoryId);\n  const labels = store.selectSnapshot(StoryLabelsState.getLabels);\n  const activeChapterId = store.selectSnapshot(\n    StoryChaptersState.getSelectedChapterId\n  );\n\n  const sceneCapture: SceneIO.SceneCaptureResponse = {\n    camera,\n    labels,\n    storyId,\n    objects,\n    background,\n    activeChapterId\n  };\n\n  return sceneCapture;\n}\n\nfunction applyCapturedState(\n  capture: SceneIO.SceneCapture,\n  store: Store,\n  isLegacyCapture = false\n) {\n  return new Promise(resolve => {\n    // handle selecting and hiding objects\n    const viewGraph = store.selectSnapshot(EngineState.getViewGraph);\n\n    const checkedNodes = capture.objects\n      .filter(object => object.selected === true)\n      .map(object => object.objectId);\n\n\n    // handle old capture format, where objects that are hidden are EXCLUDED from capture.objects\n    // HACK the old format removed objects from the capture if they were hidden\n    // so, if an object in the scene is missing from the capture, it should be toggled off.\n    const hiddenNodes: ObjectId[] = (() => {\n      if (isLegacyCapture) {\n        const hiddenNodesLegacy: ObjectId[] = Human.scene.getLeaves()\n          .filter(objectId => {\n            const captureObject = capture.objects.find(object => object.objectId === objectId);\n            const missingFromCapture = captureObject === undefined;\n            return missingFromCapture;\n          });\n        return hiddenNodesLegacy;\n\n      } else {\n        return capture.objects\n          .filter(object => object.hidden === true)\n          .map(object => object.objectId);\n      }\n    })();\n\n    // handle background model for each chapter\n    const setBackgroundActions = capture.background.map(\n      backgroundCapture =>\n        new SetChapterBackground(\n          backgroundCapture.chapterId,\n          backgroundCapture.background\n        )\n    );\n\n    const selectChapterAction = capture.activeChapterId \n      ? [new SelectChapterById(capture.activeChapterId)]\n      : [];\n\n    const zoomSet = capture.camera.zoom !== undefined \n      ? [new ZoomCameraStatic(capture.camera.zoom)]\n      : [];\n\n    // set Timeout, so that nodes are highlighted\n    setTimeout(() => {\n      store.dispatch([\n        new SetCamera(capture.camera.lookAt, false),\n        new SetLabels(capture.labels),\n        new NodeActions.UpdateNodesShown(\n          false,\n          hiddenNodes\n        ),\n        new NodeActions.UpdateNodesChecked(\n          true,\n          checkedNodes\n        ),\n        ...zoomSet,\n        ...selectChapterAction,\n        ...setBackgroundActions\n      ]);\n      resolve();\n    });\n  });\n}\n\nfunction restoreScene(\n  capture: SceneIO.SceneCapture,\n  store: Store,\n  engineService: EngineService,\n  isLegacyCapture: boolean\n): Observable<true> {\n  return new Observable(observer => {\n    engineService\n      .getEvent(EventsEnum.HumanStarted)\n      .pipe(first())\n      .subscribe(() => {\n        applyCapturedState(capture, store, isLegacyCapture).then(\n          () => {\n            engineService.fireEvent(EventsEnum.SceneRestored, undefined);\n            observer.next(true);\n            observer.complete();\n          }\n        );\n      });\n    loadStory(store, capture.storyId);\n  });\n}\n\nfunction focusObject(\n  params: SceneIO.FocusObjectRequest,\n  store: Store,\n  engineService: EngineService\n) {\n  // enable xray mode if something is selected\n  if (params.select && params.xray) {\n    enableXrayMode(store, engineService);\n  } else {\n    disableXrayMode(store, engineService);\n  }\n\n  // set selected\n  if (params.select) {\n    store.dispatch(\n      new NodeActions.UpdateNodesChecked(\n        true, [params.objectId]\n      )\n    );\n  }\n\n  // flyTo object\n  const animate = true;\n  const animationDuration = 1;\n  store.dispatch(new FlyToObject(params.objectId, animate, animationDuration));\n}\n\n\nfunction enableXrayMode(\n  store: Store,\n  engineService: EngineService\n): true {\n  store.dispatch(new SetXrayMode(true));\n  engineService.fireEvent(EventsEnum.SceneXrayEnabled, undefined);\n  return true;\n}\n\n\nexport function getSceneEvents(): RPCEvent<SceneIO.SceneEventResponse>[] {\n  return [\n    {\n      eventName: EventsEnum.SceneLoaded,\n      mapFn: (e) => e\n    },\n    {\n      eventName: EventsEnum.ScenePicked,\n      aliasEvents: [EventsEnum.PickPicked],\n      mapFn: formatPickResult\n    },\n    {\n      eventName: EventsEnum.SceneObjectsSelected,\n      mapFn: (event) => event.selectedObjectsUpdate \n    },\n    {\n      eventName: EventsEnum.SceneObjectsShown,\n      mapFn: (event) => event.enabledObjectsUpdate\n    },\n    {\n      eventName: EventsEnum.Debug_SceneReady,\n      aliasEvents: [EventsEnum.Started]\n    },\n    {\n      eventName: EventsEnum.SceneRestored,\n      mapFn: () => true\n    },\n    {\n      eventName: EventsEnum.SceneXrayEnabled,\n      mapFn: () => true\n    },\n    {\n      eventName: EventsEnum.SceneXrayDisabled,\n      mapFn: () => true\n    }\n  ];\n}\n\nexport function getSceneProcedures(\n  store: Store,\n  engineService: EngineService,\n  paintService: PaintService,\n  cameraService: CameraService,\n  graphService: BdGraphService,\n  animationService: AnimationService,\n  viewService: ViewService,\n  visibilityLayersService: VisibilityLayersService\n): Procedure<SceneIO.SceneProcRequest, SceneIO.SceneProcResponse>[] {\n  return [\n\n    {\n      // used by SDK\n      procName: MessageEnum.SceneMetaData,\n      actionFn: () => {\n        const story = store.selectSnapshot(StoryState.getStory);\n        const chapters = store.selectSnapshot(StoryChaptersState.getStoryChapters);\n        return {\n          title: story.displayName,\n          description: story.description,\n          chapters: chapters.map(c => {\n            return {\n              id: c.id,\n              title: c.info.displayName,\n              description: c.info.description,\n              isAnimated: animationService.isChapterAnimated(c),\n              loops: animationService.isChapterLooped(c),\n              duration: animationService.getChapterLocalTimerange(c.id),\n            };\n          })\n        };\n      }\n    },\n    {\n      // legacy, keeping support for now\n      procName: MessageEnum.focusObject,\n      actionFn: (params: SceneIO.FocusObjectRequest) => {\n        focusObject(params, store, engineService);\n        return true;\n      },\n      hideDefinition: true\n    },\n    {\n      procName: MessageEnum.dissectSetEnabled,\n      actionFn: (params: SceneIO.DissectSetEnabledRequest) => {\n        const tool = params.enable ? ToolEnum.Hide : ToolEnum.Select;\n        store.dispatch(new SetActiveTool(tool));\n        return true;\n      },\n      hideDefinition: true\n    },\n    {\n      procName: MessageEnum.sceneSetClickMode,\n      actionFn: (mode: SceneIO.SceneSetClickModeRequest) => {\n\n        const tool = (() => {\n          if (mode === 'select') { return ToolEnum.Select; }\n          if (mode === 'hide') { return ToolEnum.Hide; }\n          if (mode === 'fade') { return ToolEnum.Fade; }\n          return ToolEnum.Select;\n        })();\n\n        store.dispatch(new SetActiveTool(tool));\n        return true;\n      }\n    },\n    {\n      procName: MessageEnum.sceneGetClickMode,\n      actionFn: () => {\n        return store.selectSnapshot(EngineState.getActiveTool);\n      } \n    },\n    {\n      procName: MessageEnum.pickSingleSetEnabled,\n      actionFn: (params: SceneIO.PickSingleSetEnabledRequest) => {\n        const enable = (() => {\n          switch (params.enable) {\n            case undefined: return !store.selectSnapshot(ViewState.getMultiPickModeEnabled);\n            case true: return false;\n            case false: return true;\n          }\n        })();\n        store.dispatch(new ViewActions.SetMultiPickModeEnabled(enable));\n        return true;\n      },\n      hideDefinition: true\n    },\n    {\n      procName: MessageEnum.pickMultiSetEnabled,\n      actionFn: (params: SceneIO.PickMultiSetEnabledRequest) => {\n        const enable = (() => {\n          switch (params.enable) {\n            case undefined: return !store.selectSnapshot(ViewState.getMultiPickModeEnabled);\n            default: return params.enable;\n          }\n        })();\n        store.dispatch(new ViewActions.SetMultiPickModeEnabled(enable));\n        return true;\n      },\n      hideDefinition: true\n    },\n    {\n      procName: MessageEnum.getCanvasPos,\n      actionFn: (params: SceneIO.SceneGetCanvasPosRequest) => {\n        const canvas = engineService.getCanvas();\n        return _3DUtils.getCanvasPos(\n          Human,\n          params.worldPos,\n          params.offset,\n          canvas.width,\n          canvas.height\n        );\n      },\n      hideDefinition: true\n    },\n    {\n      procName: MessageEnum.SceneCapture,\n      actionFn: () => captureScene(store, cameraService)\n    },\n    {\n      procName: MessageEnum.SceneRestore,\n      actionFn: (capture: SceneIO.SceneRestoreRequest) => {\n\n        const isLegacyCapture = SceneAPIUtils.isLegacyCaptureFormat(capture);\n\n        const sanitizedCapture = isLegacyCapture\n          ? SceneAPIUtils.convertCaptureFormat(capture as SceneIO.LegacySceneCapture)\n          : capture as SceneIO.SceneCapture;\n\n        return restoreScene(\n          sanitizedCapture,\n          store,\n          engineService,\n          isLegacyCapture,\n        );\n      }\n    },\n    {\n      procName: MessageEnum.SceneEnableXrayMode,\n      actionFn: () => enableXrayMode(store, engineService)\n    },\n    {\n      procName: MessageEnum.SceneDisableXrayMode,\n      actionFn: () => disableXrayMode(store, engineService)\n    },\n    {\n      procName: MessageEnum.SceneLoad,\n      actionFn: (id: SceneIO.SceneLoadRequest) => {\n        loadStory(store, id);\n        return true;\n      }\n    },\n    { \n      procName: MessageEnum.SceneReset,\n      actionFn: () => {\n        viewService.resetChapter();\n        return true;\n      }\n    },\n    {\n      procName: MessageEnum.SceneInfo,\n      actionFn: (params: SceneIO.SceneInfoRequest) => {\n        const objectIds =\n          params && params.objectId\n            ? [params.objectId]\n            : Object.keys(Human.scene.objects);\n            \n        const displayName = store.selectSnapshot(StoryState.getStory).displayName;\n        return buildSceneInfoResponse(displayName, objectIds, store);\n      }\n    },\n    {\n      procName: MessageEnum.ScenePick,\n      actionFn: (params: SceneIO.ScenePickRequest) => {\n        // TODO[AC]: queryPick picking (don't trigger event) not exposed in Studio engine \n        const triggerActions = params.triggerActions !== false;\n\n        const pick: PickModel = {\n          x: params.x,\n          y: params.y,\n          rayPick: true\n        };\n\n        const hit = engineService.pickScene(pick);\n        return formatPickResult(hit);\n      }\n    },\n    {\n      procName: MessageEnum.SceneSelectObjects,\n      actionFn: (params: SceneIO.SelectObjectsRequest) => {\n\n        // sanitize against the deprecated 'replace' param\n        const shouldReplace = params['replace'] === true;\n        const sanitizedParams = params;\n        delete sanitizedParams['replace'];\n\n        if (shouldReplace) {\n          store.dispatch(new NodeActions.UpdateNodesChecked(false));\n        }\n\n        store.dispatch(\n          new NodeActions.UpdateNodesChecked(\n            false,\n            [],\n            sanitizedParams\n          )\n        );\n        return true;\n      }\n    },\n    {\n      procName: MessageEnum.SceneShowObjects,\n      actionFn: (params: SceneIO.ShowObjectsRequest) => {\n\n        // sanitize against the deprecated 'replace' param\n        delete params['replace'];\n\n        // Upstream is now the source of truth\n        // Child node state needs to be calculated from a patch,\n        // instead of relying on EngineService.setNodesVisible to produce the correct result.\n\n        const calculateShownPatch = (objectId: string, value: boolean) => {\n          const immediateChildren = Human.scene.objects[objectId].objects;\n\n          let _patch = {[objectId]: value};\n\n          for (const child of immediateChildren) {\n            const inPayload = params[child.objectId] !== undefined;\n\n            if (inPayload) {\n              continue;\n            }\n\n            // otherwise, save its value and recurse.\n            _patch[child.objectId] = value;\n            _patch = {..._patch, ...calculateShownPatch(child.objectId, value)};\n          }\n\n          return _patch;\n        };\n\n\n        const patch = Object.entries(params).reduce((acc, [objectId, value]) => {\n          return {...acc, ...calculateShownPatch(objectId, value)};\n        }, {});\n\n        store.dispatch(\n          new NodeActions.UpdateNodesShown(\n            false,\n            [],\n            patch\n          )\n        );\n        return true;\n      } \n    },\n    {\n      // only included to support migration away from scene.selectionMode\n      procName: MessageEnum.IsolateObject,\n      actionFn: (objectIds: SceneIO.SceneIsolateObjectRequest) => {\n        const nodeIds = typeof objectIds === 'string' ? [objectIds] : objectIds;\n        const viewGraph = store.selectSnapshot(EngineState.getViewGraph);\n        const inverseNodeIds = graphService.getInverseSelection(viewGraph, nodeIds);\n        const nodes = graphService.getNodes(viewGraph, inverseNodeIds);\n    \n        store.dispatch(new NodeActions.UpdateNodesShown(\n          false,\n          nodes.map(n => n.id)\n        ));\n\n        return true;\n      } \n    },\n    {\n      procName: MessageEnum.SceneTransformObject,\n      actionFn: (params: SceneIO.TransformObjectRequest) => {\n        engineService.transformObject(params.objectId, params);\n        return true;\n      } \n    },\n    {\n      procName: MessageEnum.SceneColorObject,\n      actionFn: (params: SceneIO.ColorObjectRequest) => {\n        const {\n          objectId,\n          tintColor,\n          saturation,\n          contrast,\n          brightness,\n          opacity\n        } = params;\n\n        const colorRecipe: EngineColorRecipeModel = {\n          tintColor,\n          saturation,\n          contrast,\n          brightness,\n          opacity\n        };\n        \n        store.dispatch(new NodeActions.UpdateNodesPaint(\n          ColorRecipeModel.fromEngine(colorRecipe),\n          [objectId]\n        ));\n\n        return true;\n      } \n    },\n    {\n      procName: MessageEnum.SceneGetColor,\n      actionFn: (params: SceneIO.SceneColorRequest) => {\n        const recipe = store.selectSnapshot(EngineNodesState.getNodePaint)(params.objectId);\n        return ColorRecipeModel.toEngine(recipe);\n      } \n    },\n    {\n      procName: MessageEnum.SceneUncolorObject,\n      actionFn: (params: SceneIO.SceneColorRequest) => {\n        store.dispatch(\n          new NodeActions.UpdateNodesPaint(\n            PaintPresetOriginal.recipe,\n            [params.objectId]\n          )\n        );\n        return true;\n      } \n    },\n    { \n      procName: MessageEnum.SceneDisableHighlight,\n      actionFn: () => {\n        paintService.disableHighlight();\n        return true;\n      }\n    },\n    { \n      procName: MessageEnum.SceneEnableHighlight,\n      actionFn: () => {\n        paintService.enableHighlight();\n        return true;\n      }\n    },\n    {\n      procName: MessageEnum.SceneSetHighlightColor,\n      actionFn: (params: SceneIO.SceneSetHighlightRequest) => {\n        paintService.setHighlightColor(params);\n        return true;\n      }\n    },\n    {\n      procName: MessageEnum.SceneSetLayersSliderPosition,\n      actionFn: (params: SceneIO.SceneSetLayersSliderPositionRequest) => {\n        \n        const fraction = Math.min(1, Math.max(params.position, 0));\n\n        const index = visibilityLayersService.fractionToIndex(fraction);\n        const position = visibilityLayersService.fractionToPosition(fraction, index);\n\n        if (params.record) {\n          visibilityLayersService.recordLayerIndexPosition(index, position);\n        } else {\n          visibilityLayersService.synchronizeScene(index, position, false);\n        }\n\n        return true;\n      }\n    },\n    {\n      procName: MessageEnum.SceneGetLayers,\n      actionFn: () => {\n\n        return store.selectSnapshot(\n          StoryChaptersState.getAllChaptersCurrentLayers\n        );\n      }\n    }\n  ];\n}\n","import { Procedure } from '../define-procedure';\nimport { Store, Actions, ofActionDispatched, ofActionCompleted } from '@ngxs/store';\nimport { MessageEnum } from '../models/message.enum';\nimport { EventsEnum } from 'src/app/engine/models/events.enum';\nimport { RPCEvent } from '../define-event';\nimport { AnimationService } from 'src/app/engine/animation.service';\nimport {\n  NextChapter,\n  PreviousChapter,\n  SelectChapterById\n} from 'src/app/story/state/chapters/story.chapters.actions';\nimport { StoryChaptersState } from 'src/app/story/state/chapters/story.chapters.state';\n\nimport { TimelineIO } from '../models/timeline.io';\nimport { flatMap, take, delay } from 'rxjs/operators';\nimport { from, Observable } from 'rxjs';\nimport { ViewService } from 'src/app/view/view.service';\n\ntype TimelineProcRequest =\n  | TimelineIO.TimelineSetRequest\n  | TimelineIO.TimelinePlayRequest\n  | void;\n\ntype TimelineProcResponse =\n  | TimelineIO.TimelinePlayResponse\n  | TimelineIO.TimelinePauseResponse\n  | TimelineIO.TimelineNextChapterResponse\n  | TimelineIO.TimelinePreviousChapterResponse\n  | TimelineIO.TimelineInfoResponse\n  | TimelineIO.TimelineSetResponse\n  | TimelineIO.TimelineQueryResponse;\n  \ntype TimelineEventResponse = TimelineIO.TimelineTransitionResponse | true;\n\nexport function getTimelineEvents(): RPCEvent<TimelineEventResponse>[] {\n  return [\n    {\n      eventName: EventsEnum.TimelinePlaying,\n      mapFn: (event) => event\n    },\n    {\n      eventName: EventsEnum.TimelineCompleted,\n      mapFn: (event) => true\n    },\n    {\n      eventName: EventsEnum.TimelineChapterTransition,\n      aliasEvents: [EventsEnum.TimelineChaptersActivated],\n      mapFn: (event) => {\n        return {\n          previousChapter: event.oldChapterIndex,\n          currentChapter: event.newChapterIndex,\n          time: event.time\n        };\n      }\n    }\n  ];\n}\n\nfunction formatTimelineInfo(\n  store: Store,\n  animationService: AnimationService\n): TimelineIO.TimelineInfoResponse {\n  const timeframe = animationService.getTimeFrame();\n\n  return {\n    time: animationService.getTime(),\n    startTime: timeframe.firstTime,\n    endTime: timeframe.lastTime,\n    chapters: store\n      .selectSnapshot(StoryChaptersState.getStoryChapters)\n      .map(chapter => chapter.id),\n    playing: animationService.isPlaying()\n  };\n}\n\nexport function getTimelineProcedures(\n  store: Store,\n  actions: Actions,\n  animationService: AnimationService,\n  viewService: ViewService\n): Procedure<TimelineProcRequest, TimelineProcResponse>[] {\n  return [\n    {\n\n      // Support Timeline.query according to J&J's usage.\n      // Only need to support the data specified in TimelineIO.TimelineQueryResponse\n      procName: MessageEnum.TimelineQuery,\n      actionFn: () => { \n\n        const chapters = store\n          .selectSnapshot(StoryChaptersState.getStoryChapters)\n          .map(chapter => {\n            const { description, displayName } = chapter.info;\n            const annotations = chapter.labels.map(label => {\n              return {\n                title: label.title,\n                description: label.description\n              };\n            });\n        \n            return {\n              description,\n              displayName,\n              annotations\n            };\n          });\n      \n        return { chapters };\n      },\n      hideDefinition: true\n    },\n    {\n      procName: MessageEnum.TimelineInfo,\n      actionFn: () => formatTimelineInfo(store, animationService)\n    },\n    {\n      procName: MessageEnum.TimelinePlay,\n      actionFn: (params: TimelineIO.TimelinePlayRequest) => {\n\n        // hoops to jump through:\n        // The app is responsible for managing chapter state, \n        // so we have to dispatch a chapter change, and wait until its done before we can play\n        // we also have to map from global time to chapter, in the case of chapterId being absent from params.\n\n        const loop = params.loop || false;\n\n        if (params.time === undefined && params.chapterId === undefined) {\n          const currentChapterId = store.selectSnapshot(StoryChaptersState.getSelectedChapterId);\n          animationService.play({numChapters: 1, loop, queue: false, startChapterId: currentChapterId});\n          return true;\n        }\n\n        // time should not be lower than zero\n        const timeLowerBound = Math.max(0, params.time);\n        \n        // time should not be greater than upper timeline bound\n        const timeUpperBound = animationService.getTimeFrame().lastTime;\n        const offsetToPreventPlayBleedingToZeroethChapter = .001;\n        const adjTime = Math.min(timeLowerBound, timeUpperBound - offsetToPreventPlayBleedingToZeroethChapter);\n\n        return new Observable(observer => {\n\n          // wait for chapter change\n          actions.pipe(\n            ofActionCompleted(SelectChapterById),\n            take(1)\n          ).subscribe(() => {\n\n            const playParams = {numChapters: 1, queue: false, loop};\n\n            params.time !== undefined \n              ? animationService.play({...playParams, startTime: adjTime})\n              : animationService.play({...playParams, startChapterId: params.chapterId});\n\n            observer.next(true);\n            observer.complete();\n          });\n\n          const chapterId: string = (() => {\n            if (params.chapterId) { return params.chapterId; }\n            return animationService.mapGlobalTimeToLocal(\n              adjTime,\n              // weird border boundary nonsense.  Check the comments on the definition of mapGlobalTimeToLocalTime in the Engine.\n              // if we are playing from time zero, we should start at the zeroth chapter.\n              // at time 0, the last chapter is the 'first' chapter because it's to the left of the boundary. O_o\n              {tie: 'later'}\n            ).branch.id;\n          })();\n\n          store.dispatch(new SelectChapterById(chapterId));\n        });\n      }\n    },\n    {\n      procName: MessageEnum.TimelinePause,\n      actionFn: () => {\n        animationService.pause();\n        return true;\n      }\n    },\n    {\n      procName: MessageEnum.TimelineSet,\n      actionFn: (params: TimelineIO.TimelineSetRequest) => {\n\n        // TimelineSet requires jumping through some hoops.\n        // The application is now responsible for managing chapter changes\n        // The engine must only be used for scrubbing time, not chapters.\n        // So, the strategy is:  Set chapter - then scrub to a time within chapter, if needed.\n\n        // noop\n        if (params.time === undefined && params.chapterId === undefined) {\n          return true;\n        }\n\n        if (params.chapterId !== undefined) {\n          store.dispatch(new SelectChapterById(params.chapterId));\n          return true;\n        }\n\n        // time should not be lower than zero\n        const timeLowerBound = Math.max(0, params.time);\n        \n        // time should not be greater than upper timeline bound\n        const timeUpperBound = animationService.getTimeFrame().lastTime;\n        const adjTime = Math.min(timeLowerBound, timeUpperBound);\n\n        return new Observable((observer) => {\n          // listen for chapter changes, so we know it's safe to scrub\n          actions.pipe(\n            ofActionCompleted(SelectChapterById),\n            take(1)\n          ).subscribe(() => {\n\n            // confusing \"first chapter is really the 'next' chapter paradigm\"\n            // read comments at definition for Root.prototype.mapGlobalTime\n            animationService.scrub({time: adjTime, which: adjTime === 0 ? 'second' : 'first'});\n\n            // safe to proceed\n            observer.next(true);\n            observer.complete();\n          });\n    \n          const mapped = animationService.mapGlobalTimeToLocal(\n            adjTime,\n            adjTime === 0 ? {tie: 'later'} : {}\n          );\n          store.dispatch(new SelectChapterById(mapped.branch.id));\n        });\n      }\n    },\n    {\n      procName: MessageEnum.TimelineNext,\n      actionFn: () => {\n        viewService.nextChapter();\n        return true;\n      }\n    },\n    {\n      procName: MessageEnum.TimelinePrev,\n      actionFn: () => {\n        viewService.previousChapter();\n        return true;\n      }\n    }\n  ];\n}\n","import { Procedure } from '../define-procedure';\nimport { Store, Actions, ofActionDispatched } from '@ngxs/store';\nimport { MessageEnum } from '../models/message.enum';\nimport { EventsEnum } from 'src/app/engine/models/events.enum';\nimport { RPCEvent } from '../define-event';\nimport { TakeChapterPicture, TakeChapterPictureSuccess, SetSelectedChapterBackground } from 'src/app/story/state/chapters/story.chapters.actions';\nimport { StoryChaptersState } from 'src/app/story/state/chapters/story.chapters.state';\nimport { flatMap, take, catchError, tap } from 'rxjs/operators';\nimport { ImageService, ImageTypeEnum } from 'src/app/shared/image.service';\nimport { of } from 'rxjs/internal/observable/of';\nimport { BackgroundModel } from 'src/app/engine/models/background.model';\nimport { EngineService } from 'src/app/engine/engine.service';\nimport { HumanInterface } from '../models/human.interface';\nimport { ColorUtils } from 'src/app/shared/libraries/colors/colors';\nimport { ViewActions } from 'src/app/view/state/view.actions';\nimport { ViewState } from 'src/app/view/state/view.state';\nimport { WidgetWiring, UIConfig } from 'src/app/shared/widget-wiring';\nimport { UiIO } from '../models/ui.io';\nimport { isEmpty } from 'lodash';\nimport { ScrollModeEnum } from 'src/app/engine/models/scroll-mode.enum';\nimport { SetScrollMode } from 'src/app/engine/state/engine.actions';\nimport { state } from '@angular/animations';\nimport { SetWidgetApiConfig } from 'src/app/widget-auth/state/widget.actions';\nimport { ViewWindow } from 'src/app/view/models/view-window.enum';\n\nfunction toAPIColor(input: BackgroundModel): UiIO.UIBackgroundParam {\n  const { colors, gradientType, colorStops } = input;\n  return {\n    // normalize: [] -> [[]]\n    colors: [\n      [colors[0], colors[1], colors[2], colors[3]],\n      [colors[4], colors[5], colors[6], colors[7]]\n    ],\n    // as-is\n    gradientType,\n    colorStops\n  };\n}\n\nfunction normalizeColorInput(input: any): [number, number, number, number][] {\n  const paramColorValues = ColorUtils.getColors(input)\n    .map((parsedColor) => parsedColor['255']);\n\n  return paramColorValues;\n}\n\n// #TODO[AC]: should be deprecated in the future and handled by the client's code\nfunction openImageInTab(imageData: string) {\n  // iframe needed to bypass data url restriction in window.open\n  const imageWindow = window.open('', '_blank');\n  if (imageWindow) {\n    const img = imageWindow.document.createElement('img');\n    img.src = imageData;\n    imageWindow.document.body.appendChild(img);\n  }\n}\n\nexport function getUIEvents(): RPCEvent<UiIO.UIEventResponse>[] {\n  return [\n\n  ];\n}\n\nexport function getUIProcedures(\n  Human: HumanInterface,\n  store: Store,\n  actions: Actions,\n  engineService: EngineService,\n  imageService: ImageService\n): Procedure<UiIO.UIProcRequest, UiIO.UIProcResponse>[] {\n  return [\n    // gets the current chapter's background color\n    {\n      procName: MessageEnum.UIGetBackground,\n      actionFn: () => {\n        const background = store.selectSnapshot(StoryChaptersState.getSelectedChapterBackground);\n        return toAPIColor(background);\n      }\n    },\n    // sets the current chapter's background color\n    {\n      procName: MessageEnum.UISetBackground,\n      // normalize color values\n      mapFnIn: (params: UiIO.UIRawBackgroundParam) => {\n        const { colors, colorStops, gradientType } = params;\n        return <UiIO.UIBackgroundParam>{\n          // normalize color input\n          colors: colors ? normalizeColorInput(colors) : colors,\n          gradientType,\n          colorStops\n        };\n      },\n      actionFn: (params: UiIO.UIBackgroundParam) => {\n        if (params) {\n          // get current background\n          const currentBackground = store.selectSnapshot(StoryChaptersState.getSelectedChapterBackground);\n          const { colors, colorStops, gradientType } = currentBackground;\n\n          // get optional user configured values, else current\n          const targetColors = params.colors ? [].concat(...params.colors) : colors;\n          const targetGradientType = params.gradientType || gradientType;\n          const targetColorStops = params.colorStops || colorStops;\n\n          // set app background\n          const background = new BackgroundModel(targetColors, targetGradientType, targetColorStops);\n          store.dispatch(new SetSelectedChapterBackground(background));\n        }\n        return true;\n      }\n    },\n    // gets the x, y, z world postion of the target point\n    {\n      procName: MessageEnum.UIGetWorldPosition,\n      actionFn: (params: UiIO.UIWorldPositionRequest) => {\n        const { worldPos } = Human.renderer.pick.pick(params.x, params.y, { rayPick: true });\n        if (worldPos) {\n          const { 0: x, 1: y, 2: z } = worldPos;\n          return <UiIO.UIWordPositionResponse>{ x, y, z };\n        } else {\n          return null;\n        }\n      }\n    },\n    {\n      procName: MessageEnum.UISetLoadingExperience,\n      actionFn: (interactType: UiIO.UISetLoadingExperienceRequest) => {\n        if (!isEmpty(interactType)) {\n          store.dispatch([\n            new ViewActions.SetInteractType(interactType),\n            new ViewActions.OpenWindow(ViewWindow.Interact)\n          ]);\n        } else {\n          store.dispatch(new ViewActions.CloseWindow(ViewWindow.Interact));\n        }\n        return true;\n      }\n    },\n    {\n      procName: MessageEnum.UISetScrollCaptureMode,\n      actionFn: (scrollCaptureMode: UiIO.UISetScrollCaptureModeRequest) => {\n        store.dispatch(new SetScrollMode(scrollCaptureMode));\n        return true;\n      }\n    },\n    {\n      procName: MessageEnum.UISetTutorial,\n      actionFn: (params: UiIO.UISetTutorialRequest) => {\n        store.dispatch([\n          new ViewActions.ToggleWindow(ViewWindow.Tutorial, params.enabled),\n          new ViewActions.StartTutorial(params.enabled)\n        ]);\n        return true;\n      }\n    },\n    // gets the display config\n    {\n      procName: MessageEnum.UIGetDisplay,\n      actionFn: () => {\n        const layout = store.selectSnapshot(ViewState.getUI);\n        const legacyDisplayInfo: UiIO.UIDisplayParamsExternal = {\n          audio: layout.audio.enable,\n          fullscreen: layout.fullscreen.enable,\n          help: layout.help.enable,\n\n          // these all map from Camera\n          nav: layout.camera.enable,\n          cameraMode: layout.camera.enable,\n          center: layout.camera.enable,\n          zoomIn: layout.camera.enable,\n          zoomOut: layout.camera.enable,\n\n          info: layout.column.enable || layout.drawer.enable,\n\n          // these all map from Media\n          playPause: layout.media.enable,\n          scrubber: layout.media.enable,\n          'scrubber.chapters': layout.media.enable,\n          \n          tools: layout.tools.enable,\n          'tools-display': layout.tools.enable,\n          tour: layout.pagination.enable,\n          'tour.chapters': layout.pagination.enable,\n          objectTree: layout.search.enable,\n          anatomyLabels: layout.anatomyLabels.enable,\n\n          // legacy\n          share: false,\n          dissect: false,\n          xray: false,\n          annotations: false,\n          crossSection: false,\n          isolate: false\n        };\n        return legacyDisplayInfo;\n      }\n    },\n    // sets the display config\n    {\n      procName: MessageEnum.UISetDisplay,\n      actionFn: (params: UiIO.UIDisplayParams) => {\n        const apiConfig = WidgetWiring.convertAPIUIConfigToUIConfig(params);\n        store.dispatch(new SetWidgetApiConfig(apiConfig));\n        return params;\n      }\n    },\n    // resets the UI to the initial layout\n    {\n      procName: MessageEnum.UIResetDisplay,\n      actionFn: () => {\n        const initialLayout = store.selectSnapshot(ViewState.getInitialUI);\n        store.dispatch(new ViewActions.SetUI(initialLayout));\n      }\n    },\n    // take a snapshot of the current chapter\n    {\n      procName: MessageEnum.UISnapshot,\n      aliases: [MessageEnum.SceneSnapshot],\n      // normalize params: extend defaults\n      mapFnIn: (params: UiIO.UISnapshotParams) => {\n        const { width, height } = engineService.getCanvas();\n        return {\n          width: width,\n          height: height,\n          openInTab: false,\n          fileType: 'jpeg',\n          quality: 0.92,\n          ...params\n        };\n      },\n      actionFn: (params: UiIO.UISnapshotParams) => {\n        const { width, height, openInTab, fileType } = params;\n        const currentChapterId = store.selectSnapshot(StoryChaptersState.getSelectedChapterId);\n        const dimensions = { width, height };\n        const imageType = fileType === 'jpeg' ? ImageTypeEnum.JPEG : ImageTypeEnum.PNG;\n        \n        return store.dispatch(new TakeChapterPicture(currentChapterId, imageType, 0.92, dimensions, 'original', true, true))\n          .pipe(\n            // extract success\n            flatMap(() => {\n              return actions.pipe(\n                ofActionDispatched(TakeChapterPictureSuccess),\n                take(1)\n              );\n            }),\n            // serialize\n            flatMap((e: TakeChapterPictureSuccess) => imageService.blobToBase64(e.blob)),\n            // open image tab: optional\n            tap((imageData: string) => {\n              if (openInTab && imageData) {\n                openImageInTab(imageData);\n              }\n            }),\n            // handle errors: empty response\n            catchError(() => of(null))\n          );\n      }\n    }\n  ];\n}\n","export class AnalyticActivityModel {\n    [id: string]: string;\n    engine_version: string;\n    api_version: string;\n}\n\nexport class AnalyticUserActivityModel extends AnalyticActivityModel {\n    parent_analytic_identifier: string;\n    referer_domain: string;\n}\n","import { AnalyticActivityModel } from './analytic-activity.model';\nimport { WidgetPlatformEnum } from './widget-platform.enum';\n\nexport class DeveloperAnalyticModel {\n    platform: WidgetPlatformEnum;\n\n    app_productkey: string;\n    app_userid:  string;\n\n    app_activity: string;\n    // app_activity_status: string;\n\n    app_apikey: string;\n    app_domain: string;\n\n    widget_is_fullscreen: boolean;\n    \n    app_activity_data: AnalyticActivityModel | any;\n}\n","import { WidgetPlatformEnum } from './widget-platform.enum';\nimport { AnalyticUserActivityModel } from './analytic-activity.model';\n\nexport class UserAnalyticModel {\n    analytic_platform: WidgetPlatformEnum;\n    analytic_type: string;\n    // analytic_id: string;\n    // analytic_app_name: string;\n    // analytic_description: string;\n\n    analytic_data: AnalyticUserActivityModel;\n}\n","\n// # TODO[AC]= map to numbered error codes, instead of string\nexport enum WidgetAuthErrorEnum {\n    // auth key\n    InvalidUAID = 'analytic id does not exist',\n    InvalidDeveloperId = 'Client id invalid',\n    InvalidProductKey = 'app product key',\n    MissingUAID = 'analytic id missing',\n\n    // API platform restriction\n    WebOnlyAPI = 'Api key only compatible with Web Widget',\n    AndroidOnlyAPI = 'Api key only compatible with Mobile Widget SDK for Android',\n    IOSOnlyAPI = 'Api key only compatible with Mobile Widget SDK for iOS',\n\n    // product key\n    MixedAPIKeys = 'Use of both an app product key and an app api key not allowed',\n    ProductKeyNotRegistered = 'App product key \"xxx\" has not been registered or is incorrect.  Ensure it has been registered by the system admin',\n    // tslint:disable-next-line:max-line-length\n    ProductKeyInvalidAppBundleID = 'The app product key \"xxx\" has not been authorized to be used for app bundle id \"yyy\".  Confirm the correct values are being used from the system admin',\n    // tslint:disable-next-line:max-line-length\n    ProductKeyBundleIDWhitelist = 'Use of app product key \"xxx\" requires the affiliated app bundle id (app_domain) to be white-listed.  Ensure the system admin has white-listed \"yyy\"',\n    ImproperProductKeyUsage = 'Improper use of app product key \"xxx\" detected. Contact the system admin if issue continues',\n\n    // generic errors\n    InvalidPlatformSource = 'Invalid platform source',\n    MissingSource = 'Missing source',\n    MissingPlatform = 'Missing platform',\n    MissingAppDomain = 'Missing app domain',\n    APIKeyMissing = 'Api key missing',\n    APIKeyInvalid = 'Api key invalid',\n    DeveloperDeactivated = 'Developer account for api key is deactivated',\n    BundleIDNotAllowed = 'App bundle id not allowed',\n    BundleIDUnregistered = 'App bundle id unregistered'\n}\n","export enum WidgetInteractionEnum {\n    Init = 'init',\n    View = 'view',\n    ChanceInteraction = 'interactionc',\n    FirstInteraction = 'interactionf',\n    Call = 'call'\n}\n","export enum WidgetPlatformEnum {\n    Widget = 'widget',\n    WidgetAPI = 'widgetapi'\n}\n","export enum WidgetUserTypeEnum {\n    User,\n    Developer\n}\n","import { WidgetInteractionEnum } from '../models/widget-interaction.enum';\nimport { AnalyticResponseModel } from '../models/analytic-response.model';\nimport { WidgetUserTypeEnum } from '../models/widget-user-type.enum';\nimport { WidgetUrlConfig } from 'src/app/widget-config/initial-config';\nimport { UIConfig } from '../../shared/widget-wiring';\n\nexport class SetupWidget {\n  static readonly type = '[Widget] Setup Widget';\n  constructor(public hostingURL: string, public embedded: boolean, public widgetConfig: WidgetUrlConfig) { }\n}\n\nexport class LogWidgetInteraction {\n  static readonly type = '[Widget] Log Interaction';\n  constructor(public interaction: WidgetInteractionEnum, public source?: string) { }\n}\n\nexport class LogWidgetInteractionSuccess {\n  static readonly type = '[Widget] Log Interaction Success';\n  constructor(public interaction: WidgetInteractionEnum, public response: AnalyticResponseModel) { }\n}\n\nexport class LogWidgetInteractionFailure {\n  static readonly type = '[Widget] Log Interaction Failure';\n  constructor(public interaction: WidgetInteractionEnum, public response: AnalyticResponseModel) { }\n}\n\nexport class AuthWidget {\n  static readonly type = '[Widget] Auth';\n  constructor() { }\n}\n\nexport class AuthWidgetSuccess {\n  static readonly type = '[Widget] Auth Success';\n  constructor(public userType: WidgetUserTypeEnum, public response: AnalyticResponseModel) { }\n}\n\nexport class AuthWidgetFailure {\n  static readonly type = '[Widget] Auth Failure';\n  constructor(public userType: WidgetUserTypeEnum, public response: AnalyticResponseModel) { }\n}\n\nexport class ResetWidget {\n  static readonly type = '[Widget] Reset';\n  constructor() { }\n}\n\nexport class SetInputEnabled {\n  static readonly type = '[Widget] Set Input Enabled';\n  constructor(public enabled: boolean) { }\n}\n\nexport class SetWidgetApiConfig {\n  static readonly type = '[Widget] Set API Config';\n  constructor(public config: UIConfig) { }\n}\n","import { WidgetUserTypeEnum } from '../models/widget-user-type.enum';\nimport { WidgetUrlConfig } from 'src/app/widget-config/initial-config';\nimport { UIConfig } from 'src/app/shared/widget-wiring';\n\nexport class WidgetStateModel {\n    userType: WidgetUserTypeEnum;\n    authenticating: boolean;\n    authenticated: boolean;\n    widgetUrlConfig: WidgetUrlConfig;\n    widgetApiConfig: UIConfig;\n\n    parentUrl: {\n        full: string,\n        domain: string\n    };\n    embedded: boolean;\n    engineVersion: string;\n    engineAPIVersion: string;\n\n    inputEnabled: boolean;\n}\n","import { State, Action, StateContext, Selector } from '@ngxs/store';\nimport { WidgetStateModel } from './widget.state.model';\nimport {\n  ResetWidget,\n  LogWidgetInteraction,\n  LogWidgetInteractionFailure,\n  LogWidgetInteractionSuccess,\n  AuthWidget,\n  AuthWidgetSuccess,\n  AuthWidgetFailure,\n  SetupWidget,\n  SetInputEnabled,\n  SetWidgetApiConfig\n} from './widget.actions';\nimport { WidgetAnalyticsService } from 'src/app/widget-auth/widget-analytics.service';\nimport { WidgetAuthService } from 'src/app/widget-auth/widget-auth.service';\nimport { finalize } from 'rxjs/operators';\nimport { UserAnalyticModel } from '../models/user-analytic.model';\nimport { DeveloperAnalyticModel } from '../models/developer-analytic.model';\nimport { AnalyticActivityModel, AnalyticUserActivityModel } from '../models/analytic-activity.model';\nimport { WidgetUserTypeEnum } from '../models/widget-user-type.enum';\nimport { WidgetPlatformEnum } from '../models/widget-platform.enum';\nimport { WidgetInteractionEnum } from '../models/widget-interaction.enum';\nimport { AnalyticResponseModel } from '../models/analytic-response.model';\nimport { Observable } from 'rxjs';\nimport { plainToClass } from 'class-transformer';\n\ndeclare const Human: any;\n\nconst initialState: WidgetStateModel = {\n  // auth state\n  userType: WidgetUserTypeEnum.User,\n  authenticating: false,\n  authenticated: false,\n  // widget config\n  widgetUrlConfig: {\n    id: '',\n    type: ''\n  },\n  widgetApiConfig: null,\n  // auth data\n  parentUrl: {\n    full: '',\n    domain: ''\n  },\n  embedded: false,\n  // engine params\n  engineVersion: '',\n  engineAPIVersion: '',\n  inputEnabled: true\n};\n\n@State<WidgetStateModel>({\n  name: 'widget',\n  defaults: initialState\n})\nexport class WidgetState {\n\n  @Selector()\n  static getWidgetState(state: WidgetStateModel) {\n    return state;\n  }\n\n  @Selector()\n  static getUserType(state: WidgetStateModel) {\n    return state.userType;\n  }\n\n  @Selector()\n  static getWidgetAuthenticating(state: WidgetStateModel) {\n    return state.authenticating;\n  }\n\n  @Selector()\n  static getWidgetAuthenticated(state: WidgetStateModel) {\n    return state.authenticated;\n  }\n\n  @Selector()\n  static getInputEnabled(state: WidgetStateModel) {\n    return state.inputEnabled;\n  }\n\n  @Selector()\n  static getEmbedded(state: WidgetStateModel) {\n    return state.embedded;\n  }\n\n  @Selector()\n  static getParentURL(state: WidgetStateModel) {\n    return state.parentUrl.full;\n  }\n\n  @Selector()\n  static getWidgetUrlConfig(state: WidgetStateModel) {\n    return state.widgetUrlConfig;\n  }\n\n  @Selector()\n  static getWidgetApiUIConfig(state: WidgetStateModel) {\n    return state.widgetApiConfig;\n  }\n\n  @Action(SetupWidget)\n  setupWidget(context: StateContext<WidgetStateModel>, { hostingURL, embedded , widgetConfig }: SetupWidget) {\n    // extract host + port (optional) from url, match: 'protocol://host.name:port/path' -> 'host.name:port'\n    const match = hostingURL.match(/:\\/\\/(.[^/]+)/);\n    const domain = (match && match[1]) ? match[1] : hostingURL;\n\n    context.patchState({\n      // user type\n      userType: widgetConfig.uaid ? WidgetUserTypeEnum.User : WidgetUserTypeEnum.Developer,\n      // embedded state\n      embedded: embedded,\n      // config\n      widgetUrlConfig: widgetConfig,\n      // hosting\n      parentUrl: {\n        full: hostingURL,\n        domain: domain\n      }\n    });\n  }\n\n  @Action(AuthWidget)\n  authWidget(context: StateContext<WidgetStateModel>, action: AuthWidget) {\n    const widgetState = context.getState();\n    const { userType, widgetUrlConfig: widgetConfig } = widgetState;\n\n    const authRequest$: Observable<AnalyticResponseModel> = userType === WidgetUserTypeEnum.User\n      // user auth: via uaid\n      ? this.authService.authUser(widgetConfig.uaid)\n      // developer auth: via developer key\n      : this.authService.authDeveloper(\n          this.analyticsService.buildDeveloperAnalytic(\n            widgetState,\n            WidgetInteractionEnum.Init,\n            WidgetPlatformEnum.WidgetAPI,\n            this.buildAppActivityData(widgetState)\n          ) // build developer auth\n        );\n      \n\n    // begin auth\n    context.patchState({ authenticating: true });\n\n    // check auth\n    authRequest$\n      .pipe(\n        finalize(() => context.patchState({ authenticating: false }))\n      )\n      .subscribe((response) => {\n        const success = response.success;\n        context.patchState({ authenticated: success });\n\n        context.dispatch(success ? new AuthWidgetSuccess(userType, response) : new AuthWidgetFailure(userType, response));\n      });\n  }\n\n  @Action(LogWidgetInteraction)\n  logWidgetInteraction(context: StateContext<WidgetStateModel>, { interaction, source }: LogWidgetInteraction) {\n    const widgetState = context.getState();\n    const userType = widgetState.userType;\n\n    const analytic: UserAnalyticModel | DeveloperAnalyticModel = userType === WidgetUserTypeEnum.User\n      ? this.buildUserAnalytic(widgetState, interaction, source)\n      : this.analyticsService.buildDeveloperAnalytic(\n          widgetState,\n          interaction,\n          WidgetPlatformEnum.Widget,\n          this.buildAppActivityData(widgetState)\n        );\n\n    // log interaction\n    this.analyticsService.sendAnalytic(analytic)\n      .subscribe(\n        (response) => {\n          if (response.success) {\n            context.dispatch(new LogWidgetInteractionSuccess(interaction, response));\n          } else {\n            context.dispatch(new LogWidgetInteractionFailure(interaction, response));\n          }\n        });\n  }\n  \n  @Action(ResetWidget)\n  resetWidget(context: StateContext<WidgetStateModel>, action: ResetWidget) {\n    context.setState(initialState);\n  }\n\n  private buildAppActivityData(widgetState: WidgetStateModel): AnalyticActivityModel {\n    const { engineVersion, engineAPIVersion, widgetUrlConfig: widgetConfig } = widgetState;\n\n    // require activity data\n    const baseActivityData: AnalyticActivityModel = {\n      engine_version: engineVersion,\n      api_version: engineAPIVersion\n    };\n\n    // include widget params\n    Object.entries(widgetConfig)\n    // exclude developer key\n      .filter(([key]) => key !== 'dk')\n      // set url param: i.e., ?ui-info=true -> { ... 'url_param_ui-info': 'true' }\n      .forEach(([key, value]) => {\n        baseActivityData[`url_param_${key}`] = value;\n      });\n\n    return plainToClass(AnalyticActivityModel, baseActivityData);\n  }\n\n  @Action(SetInputEnabled)\n  setInputEnabled(context: StateContext<WidgetStateModel>, action: SetInputEnabled) {\n    context.patchState({\n      inputEnabled: action.enabled\n    });\n  }\n\n  @Action(SetWidgetApiConfig)\n  setWidgetApiConfig(context: StateContext<WidgetStateModel>, action: SetWidgetApiConfig) {\n    context.patchState({\n      widgetApiConfig: action.config\n    });\n  }\n\n  private buildUserAnalytic(widgetState: WidgetStateModel, activity: string, source: string): UserAnalyticModel {\n    const { widgetUrlConfig: widgetConfig, parentUrl } = widgetState;\n    const uaid = widgetConfig.uaid;\n    const domain = parentUrl.domain;\n\n    const activityData: AnalyticUserActivityModel = {\n      ...this.buildAppActivityData(widgetState),\n      // include user keys + host\n      parent_analytic_identifier: uaid,\n      referer_domain: domain,\n      // activity source\n      [`${activity}_source`]: source\n    };\n\n    const analytic: UserAnalyticModel = {\n      analytic_platform: WidgetPlatformEnum.Widget,\n      analytic_type: activity,\n      analytic_data: activityData\n    };\n\n    return plainToClass(UserAnalyticModel, analytic);\n  }\n\n  ngxsOnInit(context: StateContext<WidgetStateModel>) {\n    // set fixed state\n    context.patchState({\n      engineVersion: Human.VERSION,\n      engineAPIVersion: Human.API_VERSION\n    });\n  }\n\n  constructor(\n    private authService: WidgetAuthService,\n    private analyticsService: WidgetAnalyticsService\n  ) { }\n}\n","import { Injectable } from '@angular/core';\nimport { HttpClient, HttpHeaders, HttpErrorResponse } from '@angular/common/http';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map } from 'rxjs/operators';\nimport { WidgetAuthErrorEnum } from './models/widget-auth-error.enum';\nimport { AnalyticResponseModel } from './models/analytic-response.model';\nimport { DeveloperAnalyticModel } from './models/developer-analytic.model';\nimport { UserAnalyticModel } from './models/user-analytic.model';\nimport { plainToClass } from 'class-transformer';\nimport { WidgetStateModel } from './state/widget.state.model';\nimport { WidgetInteractionEnum } from './models/widget-interaction.enum';\nimport { WidgetPlatformEnum } from './models/widget-platform.enum';\nimport { env } from 'process';\nimport { environment } from 'src/environments/environment';\n\nconst formHeaders = {\n  headers: new HttpHeaders({\n    'Content-Type': 'application/json; charset=utf-8'\n  })\n};\n\nconst analyticsRoot = environment.offline === true ? 'https://human.biodigital.com/' : '/';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class WidgetAnalyticsService {\n  constructor(\n    private http: HttpClient\n  ) { }\n\n  /**\n   * Validates the specified analytic id.\n   */\n  getAnalytic(analyticId: string): Observable<AnalyticResponseModel> {\n    const url = analyticsRoot + 'ws/user/analytics?analytic_id=' + analyticId;\n    return this.http.get(url)\n      .pipe(\n        map(() => ({ success: true })),\n        catchError((response: HttpErrorResponse) => of(this.parseError(response)))\n      );\n  }\n\n  /**\n   * Sends an analytic and return the validation status.\n   */\n  sendAnalytic(analytic: UserAnalyticModel | DeveloperAnalyticModel): Observable<AnalyticResponseModel> {\n    const request$ = analytic instanceof UserAnalyticModel\n      // user analytic\n      ? this.http.post(analyticsRoot + 'ws/user/analytics', analytic, formHeaders)\n      // developer analytic\n      : this.http.post(analyticsRoot + 'ws/developer/apps/access/key', analytic, formHeaders);\n\n    return request$\n      .pipe(\n        map(() => ({ success: true })),\n        catchError((response: HttpErrorResponse) => of(this.parseError(response)))\n      );\n  }\n\n  buildDeveloperAnalytic(\n    widgetState: WidgetStateModel,\n    activity: WidgetInteractionEnum,\n    platform = WidgetPlatformEnum.Widget,\n    activityData: any\n  ): DeveloperAnalyticModel {\n    const { widgetUrlConfig: widgetConfig, parentUrl, embedded } = widgetState;\n  \n    const analytic = {\n      platform: platform,\n      app_activity: activity,\n      // app keys\n      app_productkey: widgetConfig['app-productkey'],\n      app_userid: widgetConfig['app-userid'],\n      // user keys\n      app_apikey: widgetConfig['dk'],\n      // full embbed domain path\n      app_domain: parentUrl.full,\n      app_activity_data: activityData,\n      widget_is_fullscreen: !embedded,\n    };\n  \n    return plainToClass(DeveloperAnalyticModel, analytic);\n  }\n\n  private parseError(response: HttpErrorResponse): AnalyticResponseModel {\n    if (environment.offline) {\n      // for offline mode we can't connect to the auth server, this is ok\n      return { success: true, message: '', errorCode: null};\n    }\n    const error = response.error.error;\n    const status = response.status;\n    // server error isn't an auth failure\n    const success = status >= 500 && status <= 504;\n    const message = error && error.message ? error.message : '';\n    const errorCode = Object.values(WidgetAuthErrorEnum).includes(message) ? <WidgetAuthErrorEnum>message : null;\n    return { success: success, message: message, errorCode: errorCode };\n  }\n\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { NgxsModule } from '@ngxs/store';\nimport { WidgetState } from './state/widget.state';\nimport { SharedModule } from '../shared/shared.module';\nimport { WidgetConfigResolver } from './widget-config-resolver';\n\n@NgModule({\n  imports: [\n    NgxsModule.forFeature([\n      WidgetState\n    ]),\n    CommonModule,\n    SharedModule\n  ],\n  declarations: [],\n  exports: [],\n  providers: [\n    WidgetConfigResolver\n  ]\n})\nexport class WidgetAuthModule { }\n","import { Injectable } from '@angular/core';\nimport { WidgetAnalyticsService } from './widget-analytics.service';\nimport { Observable } from 'rxjs';\nimport { AnalyticResponseModel } from './models/analytic-response.model';\nimport { DeveloperAnalyticModel } from './models/developer-analytic.model';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class WidgetAuthService {\n\n  constructor(\n    private analyticsService: WidgetAnalyticsService\n  ) { }\n\n  /**\n   * Validates a developer's widget access.\n   */\n  authDeveloper(analytic: DeveloperAnalyticModel): Observable<AnalyticResponseModel> {\n    return this.analyticsService.sendAnalytic(analytic);\n  }\n\n  /**\n   * Validate a user's widget access.\n   */\n  authUser(analyticId: string): Observable<AnalyticResponseModel> {\n    return this.analyticsService.getAnalytic(analyticId);\n  }\n\n}\n","import { Injectable } from '@angular/core';\nimport { Resolve, ActivatedRouteSnapshot } from '@angular/router';\nimport {\n  WidgetUrlConfig,\n  getInitialWidgetConfig\n} from '../widget-config/initial-config';\nimport { last } from 'lodash';\n\n@Injectable()\nexport class WidgetConfigResolver implements Resolve<WidgetUrlConfig> {\n  constructor() {}\n\n  resolve(route: ActivatedRouteSnapshot) {\n    const params = { ...route.queryParams };\n\n    // sanitize the possibility of the same param being included more than once.\n    // i.e. &ui-info=false&ui-info=true\n    // Rule: take the first one.\n\n    const dedupedParams = Object.keys(params).reduce((acc, param) => {\n      const hasDuplicate = Array.isArray(params[param]);\n      acc[param] = hasDuplicate ? last(params[param]) : params[param];\n      return acc;\n    }, {});\n\n    return getInitialWidgetConfig(dedupedParams);\n  }\n}\n","import { BackgroundModel } from '../engine/models/background.model';\nimport { CameraModel } from '../engine/models/camera.model';\nimport { ColorUtils } from '../shared/libraries/colors/colors';\nimport { XYZModel } from '../shared/models/xyz.model';\nimport { MediaEnum } from '../story/models/media.enum';\nimport { ViewLayout } from '../view/models/view-layout.enum';\nimport { ViewLoaderEnum } from '../view/models/view-loader.enum';\n\nexport interface RawParams {\n  [prop: string]: string;\n}\n\ninterface ParamTransform {\n  [prop: string]: (params: RawParams) => any;\n}\n\ntype ParamValueTypes = string | number | boolean | BackgroundModel | CameraModel;\ntype ValueTransformer = (input: string) => ParamValueTypes;\n\ninterface ParamValueTransform {\n  [prop: string]: ValueTransformer;\n}\n\nexport interface UrlUIConfig {\n  'annotation-collapse'?: number; // alias to ui-collapse-label ,\n  'label-scale'?: number;\n  'ui-all'?: boolean;\n  'ui-anatomy-descriptions'?: boolean;\n  'ui-anatomy-labels'?: boolean;\n  'ui-audio'?: boolean;\n  'ui-bd.link'?: boolean;\n  'ui-bd'?: boolean;\n  'ui-chapter-list'?: boolean;\n  'ui-collapse-label'?: number;\n  'ui-context-actions'?: boolean;\n  'ui-fullscreen'?: boolean;\n  'ui-help'?: boolean;\n  'ui-info-expand'?: boolean;\n  'ui-info'?: boolean;\n  'ui-labels'?: boolean;\n  'ui-label-list'?: boolean;\n  'ui-layers'?: boolean; // alias to ui-visibility-layers\n  'ui-layout'?: ViewLayout;\n  'ui-legend'?: boolean;\n  'ui-loader'?: ViewLoaderEnum;\n  'ui-logo.islink'?: boolean;\n  'ui-logo'?: boolean;\n  'ui-media-controls'?: MediaEnum;\n  'ui-menu'?: boolean;\n  'ui-nav'?: boolean;\n  'ui-object-tree'?: boolean; // alias to ui-search\n  'ui-panel'?: boolean; // alias to ui-info\n  'ui-presenter'?: boolean;\n  'ui-print-image'?: boolean;\n  'ui-scrubber.chapters'?: boolean;\n  'ui-scrubber.tour'?: boolean;\n  'ui-scrubber'?: boolean;\n  'ui-search'?: boolean;\n  'ui-tools'?: boolean;\n  'ui-tour'?: boolean;\n  'ui-tutorial'?: boolean;\n  'ui-undo'?: boolean;\n  'ui-visibility-layers'?: boolean;\n  'ui-whiteboard'?: boolean;\n}\n\ninterface BaseConfig {\n  id?: string;\n  type?: string;\n\n  'uaid'?: string;\n  'dk'?: string;\n  'app-productkey'?: string;\n  'app-userid'?: string;\n\n  // background color\n  'background'?: BackgroundModel;\n\n  // camera\n  'camera'?: CameraModel;\n\n  // load rotate\n  'load-rotate'?: number;\n}\n\nexport type WidgetUrlConfig = BaseConfig & UrlUIConfig;\n\n\nconst depreactedUIConfigNames = [\n  'ui-bd.class',\n  'ui-play-pause',\n  'ui-camera-mode',\n  'ui-center',\n  'ui-cross-section',\n  'ui-dissect',\n  'ui-fs',\n  'ui-tools-display',\n  'ui-tree',\n  'ui-zoom',\n  'ui-zoom-in',\n  'ui-zoom-out',\n\n  'ui-pan',\n  'ui-share',\n  'ui-keys',\n  'ui-slider'\n];\n\nconst depreactedNonUIConfigNames = [\n  'o',\n  'background.color-stops',\n  'background.gradient-type',\n  'dd',\n  'dn',\n  'image-display',\n  'imageDisplay',\n  'imageSrc',\n  'pre',\n  'referrer'\n];\n\nexport const deprecatedConfigNames = [...depreactedUIConfigNames, ...depreactedNonUIConfigNames];\n\n// normalizes legacy id params (s, m, be, b) into standard id\nexport function normalizeQueryIdParam(config: RawParams): string {\n  const { id, s, m, be, b } = config;\n\n  let contentId = '';\n\n  if (id) { // pass-through id\n    contentId = id;\n  } else if (be) { // encoded bookmark id\n    contentId = be;\n  } else if (b) { // decoded bookmark id\n    const bookmarkId = parseInt(b, 10);\n    contentId = Number.isNaN(bookmarkId) ? '' : encodeBookmarkId(bookmarkId);\n  } else if (m) { // module id\n    const sex = s === 'female' ? 'female' : 'male';\n    contentId = normalizeModuleId(m, sex);\n  }\n\n  // trim trailing .json \n  return contentId.replace(/\\.json$/, '');\n}\n\nexport function normalizeQueryTypeParam(config: RawParams): 'bookmark' | 'module' {\n  // determine type by id\n  const contentId = normalizeQueryIdParam(config);\n  return contentId.includes('/') ? 'module' : 'bookmark';\n}\n\n// ported from: https://github.com/biodigital-human/human-cms/blob/f8608ac6c523318b4a21ac76b200dbd3928abc1f/content/bookmarks.py#L46\nfunction encodeBookmarkId(bookmarkId: number) {\n  const BASE62_IDX = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz';\n\n  const divmod = (x: number, y: number): [number, number] => {\n    const quotient = Math.floor(x / y);\n    const remainder = x % y;\n    return [quotient, remainder];\n  };\n\n  const encoded: string[] = [];\n  let num: number = bookmarkId;\n  let digit: number;\n\n  while (num > 0) {\n    [num, digit] = divmod(num, 62);\n    encoded.unshift(BASE62_IDX[digit]);\n  }\n  return encoded.join('');\n}\n\nfunction normalizeModuleId(id: string, sex: 'male' | 'female' = 'male') {\n  return id.includes('/')\n    ? id // use full module name\n    : `production/${sex}Adult/${id}`; // normalize short module names    \n}\n\n// normalize into single params\nconst paramTransforms: ParamTransform = {\n  'type': (params) => normalizeQueryTypeParam(params),\n  'id': (p) => normalizeQueryIdParam(p),\n  // background normalization\n  'background': (p) => p['bgstd'] || p['background.colors'] || p['background']\n};\n\nfunction dropDeprecatedParams(config: RawParams) {\n  const configKeys = Object.keys(config);\n  const deprecatedKeys = configKeys\n    .filter((key) => deprecatedConfigNames.includes(key));\n\n  // warning: deprecated params\n  if (deprecatedKeys.length > 0) {\n    const messages = [\n      `The following URL parameters have been deprecated: \"${deprecatedKeys.join('\", \"')}\"`,\n      `Please contact support@biodigital.com for more information.`\n    ];\n    console.warn(messages.join('\\n'));\n  }\n\n  return configKeys.reduce((acc, key) => {\n\n    // drop if deprecated\n    if (deprecatedConfigNames.includes(key)) {\n      delete acc[key];\n    }\n\n    return acc;\n  }, config);\n}\n\n\nfunction transformParams(config: RawParams) {\n  return Object.keys(paramTransforms)\n    // exclude already defined params\n    .filter(targetParamId => typeof config[targetParamId] === 'undefined')\n    // transform many -> one params\n    .reduce((acc, targetParamId) => {\n      const transform = paramTransforms[targetParamId];\n      const transformedValue = transform(config);\n      if (typeof (transformedValue) !== 'undefined') {\n        acc[targetParamId] = transformedValue;\n      }\n      return acc;\n    }, config);\n}\n\nfunction toXYZ(values: number[]): XYZModel {\n  if (values.length === 3) {\n    const { 0: x, 1: y, 2: z } = values;\n    return { x, y, z };\n  } else {\n    return null;\n  }\n}\n\nfunction parseCamera(input: string): CameraModel {\n  // comma seperated camera values -> number[]\n  const values = input\n    .split(',')\n    .map((entry) => parseFloat(entry));\n\n  // validate required 3 part camera values (eye required) + valid numbers\n  const valid = values.length % 3 === 0 && !values.some((value) => Number.isNaN(value));\n\n  if (valid) {\n    // required: eye\n    const eyeValues = values.slice(0, 3);\n    // optional additions\n    const lookValues = values.slice(3, 6);\n    const upValues = values.slice(6, 9);\n\n    return {\n      eye: toXYZ(eyeValues),\n      look: toXYZ(lookValues),\n      up: toXYZ(upValues)\n    };\n  } else {\n    return null;\n  }\n}\n\nfunction parseBackground(input: string): BackgroundModel {\n  // parse color\n  const colorValues = ColorUtils.getColors(input);\n\n  if (colorValues) {\n    // get colors (first + second) as 255\n    const color1 = colorValues[0]['255'];\n    const color2 = colorValues[1]['255'];\n\n    // create background model\n    const colors = [...color1, ...color2];\n    const gradientType = 'radial';\n    const colorStops: [number, number] = [0, 100];\n    return new BackgroundModel(colors, gradientType, colorStops);\n  } else {\n    return null;\n  }\n}\n\nconst paramValueTransform: ParamValueTransform = {\n  'camera': parseCamera,\n  'background': parseBackground\n};\n\n// coerce strings to booleans where appropriate\nfunction coerceValues(config: RawParams): WidgetUrlConfig {\n  const coerceValue: ValueTransformer = (value: string) => {    \n    if (value) {\n      const normalizedValue = value.toLowerCase();\n      if (normalizedValue === 'true') {\n        return true;\n      } else if (normalizedValue === 'false') {\n        return false;\n      } else if (!isNaN(Number(normalizedValue))) {\n        return Number(normalizedValue);\n      }\n    }\n    return value;\n  };\n\n  return Object.keys(config).reduce((acc, key) => {\n    // get custom value transformer else default\n    const valueTransformer: ValueTransformer = paramValueTransform[key] || coerceValue;\n    const value = valueTransformer(config[key]);\n\n\n    // patch for JnJ\n    // sanitize load rotate\n    // Later: define coercion for each property instead of making assumptions.\n    if (key === 'load-rotate' && isNaN(Number(value))) {\n      return acc;\n    }\n\n    acc[key] = value;\n    return acc;\n  }, {} as WidgetUrlConfig);\n}\n\nexport function getInitialWidgetConfig(rawParams: RawParams): WidgetUrlConfig {\n  const withoutDeprecated = dropDeprecatedParams(rawParams);\n  const transformedConfig = transformParams(withoutDeprecated);\n  const coercedConfig = coerceValues(transformedConfig);\n  return coercedConfig;\n}\n","<app-warning-message *ngIf=\"show === true\">\n\n    <div class=\"warning\">\n\n        <div class=\"warning__text\">\n            {{ message }}\n        </div>\n\n        <div>\n            <div class=\"warning__close\" (click)=\"handleDismissClick()\">\n                <app-icon\n                    icon=\"times\"\n                    size=\"lg\"\n                    title=\"Close\">\n                </app-icon>\n            </div>\n        </div>\n\n    </div>\n    \n</app-warning-message>","import { Component, OnInit, ChangeDetectionStrategy, ChangeDetectorRef, OnDestroy } from '@angular/core';\nimport { isIE11 } from 'src/app/shared/detect-ie11';\nimport { Select } from '@ngxs/store';\nimport { ViewState } from 'src/app/view/state/view.state';\nimport { Observable, Subject } from 'rxjs';\nimport { ViewUIModel } from 'src/app/view/models/view-ui.model';\nimport { takeUntil } from 'rxjs/operators';\nimport { StorageService, StorageItemEnum } from 'src/app/shared/storage.service';\n\n@Component({\n  selector: 'app-ie-warning',\n  templateUrl: './ie-warning.component.html',\n  styleUrls: ['./ie-warning.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\n\nexport class IeWarningComponent implements OnInit, OnDestroy {\n  @Select(ViewState.getUI)\n  layout$: Observable<ViewUIModel>;\n\n\n  constructor(\n    private changeDetector: ChangeDetectorRef,\n    private storageService: StorageService\n  ) { }\n  \n  show = false;\n  message = `For the full interactive 3D experience please try loading this content in Chrome or Firefox.`;\n  ngUnsubscribe = new Subject();\n\n  ngOnInit() {\n    this.initLayoutListener();\n  }\n\n  ngOnDestroy() {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n  handleDismissClick() {\n    this.show = false;\n    this.storageService.setLocalItem(StorageItemEnum.InternetExplorerWarning, true);\n  }\n\n  shouldShow(layout: ViewUIModel) {\n    const cookie = this.storageService.getLocalItem(StorageItemEnum.InternetExplorerWarning);\n\n    // Only show if\n    // - We're using IE11\n    // - The user hasn't previously dismissed the message\n    // - The message hasn't been disabled in the URL params\n    return isIE11() && !cookie && layout.internetExplorerWarning.enable;\n  }\n\n  initLayoutListener() {\n    this.layout$\n      .pipe(\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(layout => {\n        this.show = this.shouldShow(layout);\n        this.changeDetector.markForCheck();\n      });\n  }\n}\n","<div class=\"message p-4 text-12\">\n    <ng-content></ng-content>\n</div>\n","import { Component, OnInit, ChangeDetectionStrategy, ViewEncapsulation } from '@angular/core';\n\n@Component({\n  selector: 'app-warning-message',\n  templateUrl: './warning-message.component.html',\n  styleUrls: ['./warning-message.component.scss'],\n  encapsulation: ViewEncapsulation.None,\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class WarningMessageComponent implements OnInit {\n\n  constructor() { }\n\n  ngOnInit() {\n  }\n\n}\n","import { WidgetAuthErrorEnum } from 'src/app/widget-auth/models/widget-auth-error.enum';\nimport { FatalErrorReportModel } from 'src/app/shared/error/error.model';\n\n// default config\nexport const defaultAuthErrorConfig: FatalErrorReportModel = {\n  title: 'Your BioDigital Human embed requires proper authentication.',\n  description: ''\n};\n\n// custom user defined messages based on auth error type\nexport const authErrorConfig: { [key: string]: FatalErrorReportModel } = {\n  [WidgetAuthErrorEnum.InvalidUAID]: {\n    title: 'Authentication Issues',\n    description: 'Your Human Widget has invalid user credentials.',\n    url: 'https://support.biodigital.com'\n  }\n};\n","export enum WidgetFatalErrorCategoryEnum {\n  Auth = 'auth'\n}\n","<div class=\"widget theme-light\">\n  <router-outlet></router-outlet>\n\n  <div class=\"widget__messages pt-2 pr-2 pl-2\">\n\n    <!-- ie11 warning -->\n    <app-ie-warning appShowIE11></app-ie-warning>\n\n  </div>\n</div>\n\n<div class=\"widget-shell\" *appFlagApplication=\"environmentApplication.All; platform: environmentPlatform.SDK; mode:'exclude'\"></div>","import { Component, OnInit, OnDestroy, Renderer2, ChangeDetectionStrategy } from '@angular/core';\nimport { Subject, Observable, of, fromEvent, merge, interval, forkJoin, combineLatest, Subscription } from 'rxjs';\nimport { Router, ActivatedRoute } from '@angular/router';\nimport { Store, Actions, ofActionDispatched, Select, ofActionCompleted } from '@ngxs/store';\nimport { map, filter, take, takeUntil, tap, skipUntil, finalize } from 'rxjs/operators';\nimport { WidgetUrlConfig } from 'src/app/widget-config/initial-config';\nimport { SetupWidget, AuthWidgetFailure, AuthWidget, LogWidgetInteraction } from 'src/app/widget-auth/state/widget.actions';\nimport { WidgetInteractionEnum } from 'src/app/widget-auth/models/widget-interaction.enum';\nimport { StoryChaptersState } from 'src/app/story/state/chapters/story.chapters.state';\nimport { WidgetAPIHandler } from 'src/app/widget-api/api-handler';\nimport { ViewState } from 'src/app/view/state/view.state';\nimport { ViewActions } from 'src/app/view/state/view.actions';\nimport { WidgetWiring, UIConfig } from 'src/app/shared/widget-wiring';\nimport { LoadStoryFail, SetIncomingStory, LoadStoryChunkSuccess, HumanReadySDK, HumanReadyWeb } from 'src/app/story/state/story.actions';\nimport { EngineService } from 'src/app/engine/engine.service';\nimport { WidgetState } from 'src/app/widget-auth/state/widget.state';\nimport { EventsEnum } from 'src/app/engine/models/events.enum';\nimport { SetChapters, SetAllChaptersBackground } from 'src/app/story/state/chapters/story.chapters.actions';\nimport { CameraService } from 'src/app/engine/camera.service';\nimport { animationFrame } from 'rxjs/internal/scheduler/animationFrame';\nimport { SetCamera } from 'src/app/engine/state/camera/engine.camera.actions';\nimport * as Hammer from 'hammerjs';\nimport { get, isNil } from 'lodash';\nimport { SetScrollMode } from 'src/app/engine/state/engine.actions';\nimport { BackgroundModel } from 'src/app/engine/models/background.model';\nimport { ViewWindow } from 'src/app/view/models/view-window.enum';\nimport { NodeActions } from 'src/app/engine/state/nodes/engine.nodes.actions';\nimport { StorageService, StorageItemEnum } from 'src/app/shared/storage.service';\nimport { EnvironmentPlatform } from 'src/environments/models/environment-platform';\nimport { EnvironmentApplication } from 'src/environments/models/environment-application';\nimport { environment } from 'src/environments/environment';\nimport { SetLabelScale } from 'src/app/story/state/labels/story.labels.actions';\nimport { EnvironmentDeploy } from 'src/environments/models/environment-deploy';\nimport { FatalErrorCategoryEnum } from 'src/app/shared/error/error.model';\nimport { WidgetFatalErrorCategoryEnum } from '../../models/widget-error-type.enum';\nimport { ErrorService } from 'src/app/shared/error.service';\n\ndeclare const BD_DOCUMENT_REFERRER: string;\n\n@Component({\n  selector: 'app-widget-master',\n  templateUrl: './widget-master.component.html',\n  styleUrls: ['./widget-master.component.scss']\n})\nexport class WidgetMasterComponent implements OnInit, OnDestroy {\n  title = 'Biodigital Human';\n\n  environmentApplication = EnvironmentApplication;\n  environmentPlatform = EnvironmentPlatform;\n\n  // interaction observable\n  private interactionReady$: Observable<any>;\n  private interactionChance$: Observable<any>;\n  private firstInteraction$: Observable<any>;\n\n  private ngUnsubscribe = new Subject();\n\n  constructor(\n    private store: Store,\n    private actions: Actions,\n    private activatedRoute: ActivatedRoute,\n    private widgetAPIHandler: WidgetAPIHandler,\n    private errorService: ErrorService,\n    private engineService: EngineService,\n    private cameraService: CameraService,\n    private storageService: StorageService,\n    private renderer: Renderer2\n  ) {\n  }\n\n  ngOnInit() {\n    // begin error tracking\n    this.initErrorHandling();\n\n    // begin interaction tracking\n    this.initInteractions();\n\n    const widgetUrlConfig: WidgetUrlConfig = this.activatedRoute.snapshot.data.widgetUrlConfig;\n    this.initWidgetBreakpoints(widgetUrlConfig);\n    this.initWidgetLabelScale(widgetUrlConfig);\n    this.initWidgetLayout(widgetUrlConfig);\n    this.initWidgetSetup(widgetUrlConfig);\n\n    this.initWidgetAuth();\n    this.initViewAnalytics();\n    this.initInteractionAnalytics();\n\n    // init model default states\n    this.initBackgroundFromWidget(widgetUrlConfig);\n    this.initBackgroundFromChapter();\n    this.initCamera(widgetUrlConfig);\n    this.initRotation(widgetUrlConfig);\n\n    // start listening for API requests\n    this.widgetAPIHandler.listen();\n\n\n    this.initChaptersReadyListener();\n    this.initHumanReadyListener();\n\n    // Dynamic layout\n    this.initDynamicLayout();\n  }\n\n  ngOnDestroy() {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n  // setup widget config\n  initWidgetSetup(widgetConfig: WidgetUrlConfig) {\n    // IE11 resets the document referrer on navigation, resulting in an authentication failure.\n    // We capture the referrer on page load in a global variable as a workaround. \n    // This code can be removed once we drop support of IE11.\n    const embedded = window !== window.top;\n    const url = embedded ? BD_DOCUMENT_REFERRER : window.location.href;\n\n\n    this.store.dispatch(new SetupWidget(url, embedded, widgetConfig));\n\n    // get the current layout\n    const layout = this.store.selectSnapshot(ViewState.getUI);\n\n    // upgrade params to reflect new widget semantics\n    const commonConfig = WidgetWiring.convertUrlUIConfigToUIConfig(widgetConfig);\n\n    // create a new layout\n    const newLayout = WidgetWiring.createLayoutFromConfig(layout, commonConfig);\n\n    // have our new layout take effect\n    this.store.dispatch(new ViewActions.SetUI(newLayout));\n\n    // set default layout after config\n    this.store.dispatch(new ViewActions.SetInitialUI(newLayout));\n\n    // handle widget scroll settings\n    const scrollMode = WidgetWiring.getScrollSetting(widgetConfig);\n    this.store.dispatch(new SetScrollMode(scrollMode));\n\n    // handle widget print setings\n    const usePrintImage = WidgetWiring.getUsePrintImage(widgetConfig);\n\n    // handle widget loading experience\n    const { interactType, isInteractActive } = WidgetWiring.getInteractType(\n      widgetConfig,\n      this.store.selectSnapshot(ViewState.shouldWindowOpen(ViewWindow.Interact)),\n      this.store.selectSnapshot(ViewState.getInteractType)\n    );\n\n    // view tutorial\n    const tutorialViewedCookie = this.storageService.getLocalItem(StorageItemEnum.GettingStartedTutorial);\n    const isTutorialActive = commonConfig.tutorial === true && tutorialViewedCookie !== `${true}`;\n\n    this.store.dispatch([\n      new ViewActions.SetInteractType(interactType),\n      new ViewActions.ToggleWindow(ViewWindow.Interact, isInteractActive),\n      new ViewActions.ToggleWindow(ViewWindow.Tutorial, isTutorialActive),\n      new ViewActions.StartTutorial(isTutorialActive),\n      new ViewActions.SetUsePrintImage(usePrintImage),\n    ]);    \n  }\n\n  // auth user widget: embedded only\n  initWidgetAuth() {\n    const embedded = this.store.selectSnapshot(WidgetState.getEmbedded);\n    if (embedded) {\n      this.store.dispatch(new AuthWidget());\n    }\n  }\n\n  initViewAnalytics() {\n    // init: wait for document ready\t\n    const loaded = ['loaded', 'interactive', 'complete'].includes(document.readyState);\n    const documentReady$: Observable<any> = loaded ? of(loaded) : fromEvent(document, 'DOMContentLoaded');\n\n    documentReady$\n      .pipe(\n        take(1), // only initial\t\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(() => {\n        this.store.dispatch(new LogWidgetInteraction(WidgetInteractionEnum.View));\n      });\n  }\n\n  // analytic: first user interaction\t\n  initInteractionAnalytics() {\n    // track interaction chance: explicit chance or forced chance (i.e., interacted w/ scene)\n    merge(\n      this.interactionChance$,\n      this.firstInteraction$\n    )\n      .pipe(\n        take(1),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(() => {\n        this.store.dispatch(new LogWidgetInteraction(WidgetInteractionEnum.ChanceInteraction));\n      });\n\n    // track first interaction\n    this.firstInteraction$\n      .pipe(\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(() => {\n        this.store.dispatch(new LogWidgetInteraction(WidgetInteractionEnum.FirstInteraction));\n      });\n  }\n\n  // error handling\n  initErrorHandling() {\n    // content errors\n    this.actions\n      .pipe(ofActionDispatched(LoadStoryFail), takeUntil(this.ngUnsubscribe))\n      .subscribe(() => this.handleContentErrors());\n\n    // auth errors\n    this.actions\n      .pipe(\n        ofActionDispatched(AuthWidgetFailure),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe((e: AuthWidgetFailure) => this.handleAuthErrors(e));\n  }\n\n  // sets custom breakpoints\n  initWidgetBreakpoints({ 'ui-collapse-label': collapseLabel, 'annotation-collapse': annotationCollapse }: WidgetUrlConfig) {\n    // get label breakpoint\n    const labelBreakpoint = [collapseLabel, annotationCollapse].find(value => !isNil(value));\n\n    // validate: 0 allowed\n    if (!isNil(labelBreakpoint)) {\n      this.store.dispatch(new ViewActions.SetLabelBreakpoint(labelBreakpoint));\n    }\n  }\n\n  initWidgetLabelScale({'label-scale': labelScale }: WidgetUrlConfig) {\n    if (!isNil(labelScale)) {\n      this.store.dispatch(new SetLabelScale(labelScale));\n    }\n  }\n\n  initWidgetLayout({'ui-layout': layout}: WidgetUrlConfig) {\n    if (!isNil(layout)) {\n      this.store.dispatch(new ViewActions.SetLayout(layout));\n    }\n  }\n\n  initInteractions() {\n    // canvas interaction\n    const canvasInteractions$ = this.getCanvasInteraction();\n\n    // app interactions\n    const appInteractions$ = this.actions.pipe(\n      ofActionDispatched(\n        NodeActions.UpdateNodeSelected,\n        NodeActions.UpdateNodesChecked,\n        NodeActions.UpdateNodesShown,\n        NodeActions.UpdateNodesPickable,\n        NodeActions.UpdateNodesPaint\n      )\n    );\n    \n    // observe: interaction ready\n    this.interactionReady$ = this.store.select(StoryChaptersState.getSelectedChapter)\n      .pipe(\n        filter((chapter) => chapter && chapter.readyState.model),\n        take(1)\n      );\n\n    // observe: interaction chance, engine scrolled into view\n    const interactionElement = this.engineService.getCanvas();\n    const intersectionThreshold = 0.75;\n\n    this.interactionChance$ = forkJoin(\n      // wait for interaction ready\n      this.interactionReady$,\n      // wait for scolled into view\n      this.getIntersectionObserver(interactionElement, intersectionThreshold)\n    )\n      .pipe(\n        take(1)\n      );\n\n    // observe: first interaction\n    this.firstInteraction$ = merge(\n      canvasInteractions$,\n      appInteractions$\n    )\n      .pipe(\n        skipUntil(this.interactionReady$),\n        take(1)\n      );\n  }\n\n  // set initial background\n  initBackgroundFromWidget({ background }: WidgetUrlConfig) {\n    if (background) {\n      this.setWidgetTransparent(BackgroundModel.isTransparent(background));\n\n      // chapters set: patch all backgrounds\n      this.actions\n        .pipe(\n          ofActionCompleted(SetChapters),\n          take(1),\n          takeUntil(this.ngUnsubscribe)\n        )\n        .subscribe(() => {\n          this.store.dispatch(new SetAllChaptersBackground(background));\n        });\n    }\n  }\n\n  initBackgroundFromChapter() {\n    this.store.select(StoryChaptersState.getSelectedChapter)\n      .pipe(\n        filter(chapter => chapter != null),\n        map(chapter => BackgroundModel.isTransparent(chapter.background)),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(isTransparent => {\n        this.setWidgetTransparent(isTransparent);\n      });\n  }\n\n  // set initial camera\n  initCamera({ camera }: WidgetUrlConfig) {\n    if (camera) {\n      // first chunk loaded: set static camera\n      this.actions\n        .pipe(\n          ofActionDispatched(LoadStoryChunkSuccess),\n          take(1),\n          takeUntil(this.ngUnsubscribe)\n        )\n        .subscribe(() => {\n          this.store.dispatch(new SetCamera(camera, false));\n        });\n    }\n  }\n\n  // init camera Y rotation\n  initRotation({ 'load-rotate': degrees }: WidgetUrlConfig) {\n    if (degrees) {\n\n      // animate camera rotation\n      let timeLast = performance.now();\n\n      interval(0, animationFrame)\n        .pipe(\n          map(() => degrees * (performance.now() - timeLast) * 0.001),\n          tap(() => timeLast = performance.now()),\n          // end animation on interaction\n          takeUntil(this.firstInteraction$),\n          takeUntil(this.ngUnsubscribe)\n        )\n        .subscribe((deltaY) => {\n          this.cameraService.rotateCameraStatic(0, deltaY);\n        });\n\n      // return to original camera\n      this.firstInteraction$\n        .pipe(\n          takeUntil(this.ngUnsubscribe)\n        )\n        .subscribe(() => {\n          const chapter = this.store.selectSnapshot(StoryChaptersState.getSelectedChapter);\n          const chapterCamera = get(chapter, 'camera.location');\n\n          if (chapterCamera) {\n            this.store.dispatch(new SetCamera(chapterCamera, true, 2));\n          }\n        });\n    }\n  }\n\n\n  /**\n   * The SDK requires human.ready to fire sooner, so we can deliver events like loading progress.\n   * Web clients want human.ready to stay the same.\n   */\n  initHumanReadyListener() {\n    const observable = this.actions.pipe(\n      ofActionDispatched(\n        environment.platform === EnvironmentPlatform.SDK\n          ? HumanReadySDK\n          : HumanReadyWeb\n      )\n    );\n\n    observable.pipe(takeUntil(this.ngUnsubscribe)).subscribe(() => {\n      this.engineService.fireEvent(EventsEnum.Started, null);\n    });\n  }\n\n  initChaptersReadyListener() {\n    this.store\n      .select(StoryChaptersState.getAllChaptersModelsReady)\n      .pipe(\n        filter(event => event === true),\n        takeUntil(this.ngUnsubscribe)\n      )\n      .subscribe(() => {\n\n        this.store.dispatch(new HumanReadyWeb());\n\n        this.engineService.fireEvent(EventsEnum.TimelineChaptersActivated, {\n          oldChapterIndex: 0,\n          newChapterIndex: 0,\n          time: 0,\n        });\n      });\n  }\n\n  initDynamicLayout() {\n    combineLatest(\n      this.store.select(WidgetState.getWidgetApiUIConfig),\n      this.store.select(WidgetState.getWidgetUrlConfig),\n      this.store.select(StoryChaptersState.getSelectedChapter)\n    ).pipe(\n      filter(([apiUIConfig, urlConfig, chapter]) => {\n        return chapter != null && urlConfig != null;\n      }),\n      takeUntil(this.ngUnsubscribe)\n    ).subscribe(([apiUIConfig, urlConfig, chapter]) => {\n      // Get the three levels of UI config: API, URL, and Chapter \n      const urlUIConfig = WidgetWiring.convertUrlUIConfigToUIConfig(urlConfig);\n      const chapterUIConfig = WidgetWiring.convertChapterToUIConfig(chapter);\n\n      // Merge the three levels of UI config\n      // Precendence: API, URL, then Chapter. \n      //\n      // API and URL are global and user defined, therefore take precedence over chapter. \n      // URL is defined once at startup, while API is asynchronous, therefore API is expected to take precedence.\n      let uiConfig = new UIConfig();\n      uiConfig = WidgetWiring.mergeUIConfigs(uiConfig, apiUIConfig);\n      uiConfig = WidgetWiring.mergeUIConfigs(uiConfig, urlUIConfig);\n      uiConfig = WidgetWiring.mergeUIConfigs(uiConfig, chapterUIConfig);\n\n      // console.group('Configs');\n      // console.log('API', apiUIConfig);\n      // console.log('URL', urlUIConfig);\n      // console.log('Chapter', chapterUIConfig);\n      // console.log('Final', uiConfig);\n      // console.groupEnd();\n\n      const viewUI = this.store.selectSnapshot(ViewState.getUI);\n      const chapterUI = WidgetWiring.createLayoutFromConfig(viewUI, uiConfig);\n\n      this.store.dispatch(new ViewActions.SetUI(chapterUI));\n    });\n  }\n\n  handleContentErrors() {\n    this.store.dispatch(new SetIncomingStory(null, null));\n    this.errorService.redirectToErrorPage(FatalErrorCategoryEnum.Content);\n  }\n  \n  handleAuthErrors(event: AuthWidgetFailure) {\n    // Disable authentication redirect on localhost, so that we can test embedded viewers\n    if (environment.deploy !== EnvironmentDeploy.Local) {\n      this.errorService.redirectToErrorPage(WidgetFatalErrorCategoryEnum.Auth, event.response.errorCode);\n    }\n  }\n\n\n  getCanvasInteraction(): Observable<any> {\n    let inputManager: HammerManager;\n\n    return new Observable((observer) => {\n\n      // manage canvas interactions\n      const canvas = this.engineService.getCanvas();\n\n      inputManager = new Hammer.Manager(canvas);\n      inputManager.add([\n        new Hammer.Tap({ event: 'singletap' }),\n        new Hammer.Tap({ event: 'doubletap', taps: 2 }),\n        // handle mouse down/touch down\n        new Hammer.Pan({ event: 'pan', direction: Hammer.DIRECTION_ALL, threshold: 0 })\n      ]);\n\n      // !important: capture 'this' context\n      const handleCanvasInteraction = () => observer.next();\n      const handleHammerEvent = handleCanvasInteraction.bind(this);\n\n      // trigger user interaction\n      inputManager.on('panstart', handleHammerEvent);\n      inputManager.on('singletap', handleHammerEvent);\n\n    }).pipe(\n      // cleanup hammer event handling\n      finalize(() => {\n        if (inputManager) {\n          inputManager.destroy();\n          inputManager = null;\n        }\n      }),\n      takeUntil(this.ngUnsubscribe)\n    );\n  }\n\n  getIntersectionObserver(targetEl: HTMLElement, intersectionThreshold: number): Observable<HTMLElement> {\n    return new Observable((observer) => {\n\n      // intersection config\n      const intersectionCconfig: IntersectionObserverInit = {\n        root: null,\n        threshold: intersectionThreshold\n      };\n\n      // create intersection observer\n      const intersectionObserver = new IntersectionObserver((entries: IntersectionObserverEntry[]) => {\n        // emit observed + cleanup\n        const isIntersecting = entries[0].intersectionRatio >= intersectionThreshold;\n\n        if (isIntersecting) {\n          // emit observer + cleanup\n          observer.next(targetEl);\n          observer.complete();\n\n          intersectionObserver.unobserve(targetEl);\n        }\n\n      }, intersectionCconfig);\n\n      // begin intersection observing\n      intersectionObserver.observe(targetEl);\n    });\n  }\n\n  setWidgetTransparent(isTransparent) {\n    (isTransparent) ?\n      this.renderer.setStyle(document.body, 'background', 'none transparent') :\n      this.renderer.removeStyle(document.body, 'background');\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { WidgetMasterComponent } from './pages/widget-master/widget-master.component';\nimport { RouterModule } from '@angular/router';\nimport { ButtonsModule } from '../shared/components/buttons/buttons.module';\nimport { HttpsValidationComponent } from './components/https-validation/https-validation.component';\nimport { WarningMessageComponent } from './components/warning-message/warning-message.component';\nimport { IconModule } from '../shared/components/icon/icon.module';\nimport { IeWarningComponent } from './components/ie-warning/ie-warning.component';\nimport { DirectivesModule } from '../shared/directives/directives.module';\n\n\n\n@NgModule({\n  declarations: [WidgetMasterComponent, HttpsValidationComponent, WarningMessageComponent, IeWarningComponent],\n  imports: [\n    CommonModule,\n    RouterModule,\n    ButtonsModule,\n    DirectivesModule,\n    IconModule\n  ],\n  exports: [WidgetMasterComponent]\n})\nexport class WidgetModule { }\n","import { NgModule } from '@angular/core';\nimport { ZendeskModel } from './shared/features/zendesk/zendesk.model';\nimport { ZendeskModule } from './shared/features/zendesk/zendesk.module';\n\n\nexport class ZendeskConfig extends ZendeskModel {\n  accountUrl = 'biodigital.zendesk.com';\n  beforePageLoad(zE) {\n    zE.setLocale('en');\n    zE.hide();\n  }\n}\n\n@NgModule({\n  declarations: [],\n  imports: [\n    ZendeskModule.forRoot(ZendeskConfig)\n  ]\n})\nexport class ZendeskConfigModule { }\n","import { EnvironmentApplication } from './models/environment-application';\nimport { ContentType } from 'src/app/story/models/content-type.enum';\nimport { EnvironmentDeploy } from './models/environment-deploy';\nimport { EnvironmentPlatform } from './models/environment-platform';\n\nexport const environment = {\n  production: true,\n  assetDomain: 'assets-human.biodigital.com',\n  supportEmail: 'support@biodigital.com',\n  googleAuthKey: '66261904577-061oin26uo7sor0vrqc8dnn105irq82n.apps.googleusercontent.com',\n  facebookAuthKey: '218801781466301',\n  googleAnalyticsId : 'UA-1141985-29',\n  rollbarToken: 'dd70f513aa0740668070fa3fd62b33a0',\n  recaptchaKey: '6LdvZvcUAAAAAM0Z1St9WQXwvSYd__hMUY2WZ6um',\n  application: EnvironmentApplication.Viewer,\n  deploy: EnvironmentDeploy.Production,\n  platform: EnvironmentPlatform.SDK,\n  exportType: ContentType.Bookmark,\n  offline: false,\n  minPasswordLength: 8\n};\n","export enum EnvironmentApplication {\n  Loft = 'loft',\n  Studio = 'studio',\n  Viewer = 'viewer',\n  All = ''\n}\n","export enum EnvironmentDeploy {\n    Local = 'Local',\n    QA = 'QA',\n    Staging = 'Staging',\n    Production = 'Production'\n}\n","export enum EnvironmentPlatform {\n    Web = 'web',\n    SDK = 'sdk'    \n}\n","import { BdGraphNodeStateMap, BdGraphStateMap, BdGraph, BdGraphNode } from './graph.model';\nimport { GraphUtils } from './graph-utils';\nimport { PropertyVotesModel } from './models/property-votes.model';\nimport { VotesModel } from './models/votes.model';\nimport { ElectionResultModel } from './models/election-result.model';\n\n\nexport namespace Elections {\n\n  export interface SyncRules {\n    [property: string]: 'majorityWins' | 'trueWins' | 'falseWins';\n  }\n\n  export function createVoter(properties: string[], state: BdGraphNodeStateMap): Object {\n    return properties.reduce((acc, property) => {\n      acc[property] = state[property] || false;\n      return acc;\n    }, {});\n  }\n\n  export function getInitialVoterState(leafStateMap: BdGraphStateMap, properties: string[]): BdGraphStateMap {\n    const nodeIds = Object.keys(leafStateMap);\n    return nodeIds.reduce((voters, nodeId) => {\n      voters[nodeId] = createVoter(properties, leafStateMap[nodeId]);\n      return voters;\n    }, {});\n  }\n\n  export function getInitialElectionDepth(leafStateMap: BdGraphStateMap, graph: BdGraph<BdGraphNode>) {\n    const nodeIds = Object.keys(leafStateMap);\n    const startDepth = 0;\n\n    const depth = nodeIds.reduce((_depth, nodeId) => {\n      return Math.max(_depth, GraphUtils.getNode(graph, nodeId).depth);\n    }, startDepth);\n\n    return depth - 1;\n  }\n\n  // [voting] get all ancestor nodes at the next depth\n  export function getEligibleElections(graph: BdGraph<BdGraphNode>, voterIds: string[], depth: number) {\n    const ancestorNodeIds = GraphUtils.getAllAncestorsFromList(graph, voterIds);\n    return ancestorNodeIds.filter((nodeId) => {\n      return nodeId && GraphUtils.getNode(graph, nodeId).depth === depth;\n    });\n  }\n\n\n  // capture if a vote was cast for or against a property\n  function buildPropertyVotes(propSyncMap, voters: BdGraphStateMap[]) {\n    const properties = Object.keys(propSyncMap);\n\n    return properties.reduce((acc, property) => {\n\n      const votes = voters.reduce<{ votesFor: string[], votesAgainst: string[] }>((_votes, voter) => {\n\n        const voterId = Object.keys(voter)[0];\n\n        if (voter[voterId][property]) {\n          _votes.votesFor.push(voterId);\n        } else {\n          _votes.votesAgainst.push(voterId);\n        }\n        return _votes;\n\n      }, { votesFor: [], votesAgainst: [] });\n\n      acc[property] = votes;\n      return acc;\n    }, {});\n  }\n\n\n  const trueWinsRules = (tallies: VotesModel) => {\n    return { result: tallies.votesFor.length > 0, dissenters: [...tallies.votesAgainst] };\n  };\n\n  const falseWinsRules = (tallies: VotesModel) => {\n    return { result: tallies.votesAgainst.length > 0, dissenters: [...tallies.votesFor] };\n  };\n\n  const majorityWinsRules = (tallies: VotesModel) => {\n    const result = tallies.votesFor.length > tallies.votesAgainst.length;\n    const dissenters = result ? [...tallies.votesAgainst] : [...tallies.votesFor];\n    return { result, dissenters };\n  };\n\n  const ruleFns = {\n    'trueWins': trueWinsRules,\n    'falseWins': falseWinsRules,\n    'majorityWins': majorityWinsRules\n  };\n\n  export function buildElectionResult(\n    electionId: string,\n    voteTallies: PropertyVotesModel,\n    propSyncMap: Object\n  ): ElectionResultModel {\n    const properties = Object.keys(voteTallies);\n\n    return properties.reduce((acc, property) => {\n      const tallies = voteTallies[property];\n      const rule = propSyncMap[property] || 'majorityWins'; // safety net\n      const { result, dissenters } = ruleFns[rule](tallies);\n\n      acc[property] = {\n        id: electionId,\n        result,\n        dissenters,\n        voters: [...tallies.votesFor, ...tallies.votesAgainst]\n      };\n\n      return acc;\n    }, {});\n  }\n\n\n  export function getElectionResults<TNode extends BdGraphNode>(\n    graph: BdGraph<TNode>,\n    voters: BdGraphStateMap,\n    elections: string[],\n    propSyncMap: SyncRules\n  ): { results: ElectionResultModel[], remainingVoters: BdGraphStateMap } {\n\n    const remainingVoters = voters;\n    const properties = Object.keys(propSyncMap);\n\n    const results = elections.reduce((acc, electionId) => {\n\n      const successors = GraphUtils.getSuccessors(graph, electionId);\n      const successorVoters = successors.map(id => {\n        return {\n          [id]: voters[id] || createVoter(properties, GraphUtils.getState(graph, id, properties))\n        };\n      });\n\n      successors.forEach(successorId => {\n        delete remainingVoters[successorId];\n      });\n\n      const electionTallies = buildPropertyVotes(propSyncMap, successorVoters);\n      const electionResults = buildElectionResult(electionId, electionTallies, propSyncMap);\n\n      remainingVoters[electionId] = Object\n        .entries(electionResults)\n        .reduce((_acc, [property, result]) => {\n          _acc[property] = result.result;\n          return _acc;\n        }, {});\n      \n      acc.results.push(electionResults);\n\n      return acc;\n    }, { results: [] });\n\n    return {\n      results: results.results,\n      remainingVoters\n    };\n  }\n}\n","import { BdGraphNode, BdGraph, BdGraphNodeStateMap, DoFunc, BdGraphNodeFactory, BdGraphFactory } from './graph.model';\nimport { ShowObjects } from 'src/app/engine/models/show-objects.model';\n\n\nexport namespace GraphUtils {\n\n\n\n  \n  export function addRootNode<TNode extends BdGraphNode>(graph: BdGraph<TNode>, nodeData: TNode): void {\n    addNode(graph, nodeData);\n    const root: TNode = getNode(graph, nodeData.id);\n    graph.roots[root.id] = root;\n  }\n\n  export function getNodes<TNode extends BdGraphNode>(graph: BdGraph<TNode>, targets: string[]): TNode[] {\n    const nodes: TNode[] = [];\n    targets.forEach((id) => {\n      if (graph.nodes[id]) {\n        nodes.push(graph.nodes[id]);\n      }\n    });\n    return nodes;\n  }\n\n  export function getAncestors<TNode extends BdGraphNode>(\n    graph: BdGraph<TNode>,\n    id: string,\n    inclusive: boolean = false,\n    order: string = 'ascending'\n  ): string[] {\n\n    const ancestors = inclusive ? [id] : [];\n\n    // walk up the tree\n    let _parentId = graph.predecessors[id];\n    while (_parentId) {\n        ancestors.push(_parentId);\n        _parentId = graph.predecessors[_parentId];\n    }\n\n    // respect user-specified order.\n    // NOTE: reverse() is relatively slow, but for the modest tree-depths we expect (tens rather than hundreds), it should be sufficient.\n    if (order === 'descending') {\n      ancestors.reverse();\n    }\n\n    return ancestors;\n  }\n\n\n  export function addNode<TNode extends BdGraphNode>(graph: BdGraph<TNode>, nodeData: TNode): void {\n    if (!graph.nodes[nodeData.id]) {\n        graph.nodes[nodeData.id] = nodeData;\n    }\n  }\n\n  // get node data if it exists, otherwise return null\n  export function getNode<TNode extends BdGraphNode>(graph: BdGraph<TNode>, id: string): TNode {\n    return graph.nodes[id] || null;\n  }\n\n  // get nearest ancestor if it exists, otherwise return null\n  // this is a (private) utility \n  export function getAncestor<TNode extends BdGraphNode>(graph: BdGraph<TNode>, id: string): string {\n    return graph.predecessors[id] || null;\n  }\n\n\n  // union of all immediate ancestors of a set of nodes\n  export function getAllAncestorsFromList<TNode extends BdGraphNode>(graph: BdGraph<TNode>, targets: string[]): string[] {\n    const ancestors = {};\n    let _ancestor: string;\n    targets.forEach((id) => {\n      _ancestor = getAncestor(graph, id);\n      if (_ancestor && !ancestors[_ancestor]) {\n        ancestors[_ancestor] = true;\n      }\n    });\n    return Object.keys(ancestors);\n  }\n\n  // return all child node ids of target node\n  export function getSuccessors<TNode extends BdGraphNode>(graph: BdGraph<TNode>, id: string): string[] {\n    return [...graph.successors[id] || []];\n  }\n\n  // get graph node state matching properties\n  export function getState<TNode extends BdGraphNode>(graph: BdGraph<TNode>, id: string, properties: string[]): BdGraphNodeStateMap {\n    const state = {};\n    const node = getNode(graph, id);\n    Object.entries(node.boolState).forEach(([property, value]) => {\n      if (properties && properties.includes(property)) {\n        state[property] = value;\n      }\n    });\n\n    Object.entries(node.numState).forEach(([property, value]) => {\n      if (properties && properties.includes(property)) {\n        state[property] = value;\n      }\n    });\n\n    return state;\n  }\n\n  // return true if node is a leaf node\n  export function isLeaf<TNode extends BdGraphNode>(graph: BdGraph<TNode>, id: string): boolean {\n    return !!graph.nodes[id] && graph.successors[id] === undefined;\n  }\n\n\n  // return true if node is a root node\n  export function isRoot<TNode extends BdGraphNode>(graph: BdGraph<TNode>, id: string): boolean {\n    return graph.roots.hasOwnProperty(id) || false;\n  }\n\n  // return all root-node ids\n  export function getRoots<TNode extends BdGraphNode>(graph: BdGraph<TNode>): string[] {\n    return Object.keys(graph.roots);\n  }\n\n  // recursively build graphNode from nested element\n  function scrapeDataNode<TNode extends BdGraphNode>(graph: BdGraph<TNode>, parentId: string, nodeData: Object,\n    idKey: string, childKey: string, props: Object, depth: number): void {\n\n    // create graph node as specified generic type node\n    // const graphNode = new BdGraphNode(nodeData[idKey]) as TNode;\n    const graphNode = BdGraphNodeFactory(nodeData[idKey]) as TNode;\n\n    // set Depth\n    graphNode.depth = depth;\n\n    // collect properties \n    Object.entries(props).forEach(([k, v]) => {\n      let val: any;\n\n      // get value (from string or function)\n      if (typeof v === 'string') {\n        val = nodeData[v];\n      } else if (typeof v === 'function') {\n        val = v(nodeData[idKey]);\n      }\n\n      // store as boolean or numerical state property\n      if (typeof val === 'boolean') {\n        graphNode.boolState[k] = val;\n      } else if (typeof val === 'number') {\n        graphNode.numState[k] = val;\n      } else {\n        graphNode[k] = val;\n      }\n    });\n\n    // add node and relationships to graph\n    graph.nodes[graphNode.id] = graphNode;\n    if (parentId) {\n      graph.successors[parentId] = [...graph.successors[parentId] || [], graphNode.id];\n      graph.predecessors[graphNode.id] = parentId;\n    } else {\n      graph.roots[graphNode.id] = graphNode;\n    }\n\n    // recurse \n    depth += 1;\n    nodeData[childKey].forEach((childData: Object) => {\n      scrapeDataNode(graph, graphNode.id, childData, idKey, childKey, props, depth);\n    });\n\n\n  }\n\n\n  // depth first traversal and do\n  // this is a (private) utility \n  export function depthFirst<TNode extends BdGraphNode>(graph: BdGraph<TNode>, doFunc: DoFunc, id?: string): void {\n    if (!id) {\n      // start at the top fo the graph and operate on all roots\n      getRoots(graph).forEach((rid) => {\n        doFunc(rid);\n        depthFirst(graph, doFunc, rid);\n      });\n    } else {\n      // act on node and keep going down\n      doFunc(id);\n      getSuccessors(graph, id).forEach((cid) => {\n        depthFirst(graph, doFunc, cid);\n      });\n    }\n  }\n\n  // factory for new BdGraph nested objects \n  const DEFAULT_ID_KEY = 'objectId';\n  const DEFAULT_CHILDREN_KEY = 'objects';\n  export function createGraphFromSrc<TNode extends BdGraphNode>(\n    srcData: Object[],\n    idKey: string = DEFAULT_ID_KEY,\n    childKey: string = DEFAULT_CHILDREN_KEY,\n    nodeProperties: Object = {}\n  ): BdGraph<TNode> {\n\n    const depth = 0; // depth of root nodes is 0\n    const graph = BdGraphFactory<TNode>();\n    srcData.forEach((nodeData: Object) => {\n      scrapeDataNode<TNode>(graph, null, nodeData, idKey, childKey, nodeProperties, depth);\n    });\n\n    return graph;\n  }\n\n\n\n\n  // In this function, we are pruning rootObjects according to showObjects\n\n  // when do we preserve a branch?\n  // -> when showObjects for the node is true\n  // -> when showObjects for the node is undefined, and showObjects for it's ancestor is true\n\n  // when do we prune a branch?\n  // -> when showObjects for the node is false\n  // -> when showObjects for the node is undefined, and showObjects for it's ancestor is false\n\n  export interface SGNode {\n    objectId: string;\n    objects: SGNode[];\n  }\n\n  export function pruneHiddenObjects(\n    sceneGraph: SGNode[],\n    showObjects: ShowObjects,\n    ancestorShowObjectValue?\n    ): SGNode[] {\n\n    const filteredSceneGraph = [] as SGNode[];\n    \n    for (const node of sceneGraph) {\n      const showValue = showObjects[node.objectId];\n    \n      // use show objects to see whether or not we preserve this node\n      // when show objects for this node is undefined, fall back to the ancestor's show object value\n      const shouldPreserveNode = (() => {\n        if (showValue === true) {\n          return true;\n        }\n        if (showValue === false) {\n          return false;\n        }\n        return ancestorShowObjectValue;\n      })();\n    \n      // recurse for all children\n      const filteredChildren = pruneHiddenObjects(\n        node.objects || [],\n        showObjects,\n        shouldPreserveNode\n      );\n\n      if (shouldPreserveNode) {\n        // preserve the node and its children, if any\n        const nodeCopy = {...node};\n        nodeCopy.objects = filteredChildren;\n        filteredSceneGraph.push(nodeCopy);\n\n      } else {\n        // throw out the node, and only save its children, if any\n        filteredChildren.forEach(\n          filtered => filteredSceneGraph.push(filtered)\n        );\n      }\n    }\n\n    return filteredSceneGraph;\n  }\n\n\n\n}\n","/*\nBdGraph is a generic graph data structure\n*/\n\nexport interface BdGraphNode {\n    depth: number;\n    id: string;\n    boolState: {\n        [key: string]: boolean;\n    };\n    numState: {\n        [key: string]: number;\n    };\n}\n\nexport function BdGraphNodeFactory(id: string): BdGraphNode {\n    return {\n        id, \n        depth: 0,\n        boolState: {},\n        numState: {}\n    };\n}\n\nexport interface BdGraph<TNode extends BdGraphNode> {\n    nodes: {\n        [key: string]: TNode;\n    };\n    successors: {\n        [key: string]: string[];\n    };\n    predecessors: {\n        [key: string]: string;\n    };\n    roots: {\n        [key: string]: TNode;\n    };\n}\n\nexport function BdGraphFactory<TNode extends BdGraphNode>(): BdGraph<TNode> {\n    return {\n        nodes: {},\n        successors: {},\n        predecessors: {},\n        roots: {}\n    };\n}\n\n// TODO: enumerate these property names\n// property-name: boolean/number state value\nexport class BdGraphNodeStateMap {\n    [property: string]: any;\n}\n\n// node-id: NodeStateMap\nexport class BdGraphStateMap {\n    [nodeId: string]: BdGraphNodeStateMap;\n}\n\n// node-id: boolean/number - the value of a given property for an arbitrary collection node ids\nexport class BdGraphPropertyValueMap {\n    [nodeId: string]: any;\n}\n\n\nexport type DoFunc = (id: string) => void;\n\n// boolean stateful properties on our BdGraph\nexport class GraphNodeState {\n    shown = (id) => false;\n    selected = (id) => false;\n    pickable = (id) => true;\n\n    constructor(recipes: string[]) {\n        // default recipe memberships to graph node state\n        recipes.forEach((recipeName) => {\n            this[recipeName] = (id) => false;\n        });\n    }\n}\n","import { BdGraphNode, BdGraph, BdGraphNodeStateMap, BdGraphStateMap, BdGraphPropertyValueMap } from './graph.model';\nimport { Injectable } from '@angular/core';\nimport { Elections } from './elections';\nimport { GraphUtils } from './graph-utils';\nimport { PropertyVotesModel } from './models/property-votes.model';\nimport { ElectionResultModel } from './models/election-result.model';\n\n/*\nGeneric API for querying, editing, serializing nested objects.\n\nState synchronization works only for boolean properties on BdGraphNode objects.\n\nThis is functionally a TREE graph, although could be extended to work for any DAG when that is required.\n\n#TODO: [EM] IMPROVE efficiency of partial tree sync via early termination no change up the tree\n\n*/\n\ntype IncludeIf = (id: string) => boolean;\n\ntype DoFunc = (id: string) => void;\n\n\n\n// test this too\n\n\n\n\nexport function setNodePropertiesFromObject<TNode extends BdGraphNode>(node: TNode, srcObject: any, props: Object, idKey: string = 'id') {\n  Object.entries(props).forEach(([k, v]) => {\n    let val: any;\n    // get value (from string or function)\n    if (typeof v === 'string') {\n      val = srcObject[v];\n    } else if (typeof v === 'function') {\n      val = v(srcObject[idKey]);\n    }\n\n    // store as boolean or numerical state property\n    if (typeof val === 'boolean') {\n      node.boolState[k] = val;\n    } else if (typeof val === 'number') {\n      node.numState[k] = val;\n    } else {\n      node[k] = val;\n    }\n  });\n}\n\n// Functions for Querying and Editing BdGraph objects\n@Injectable({\n  providedIn: 'root'\n})\nexport class BdGraphService {\n\n\n  // recursively add children to node data\n  private serializeNode<TNode extends BdGraphNode>(graph: BdGraph<TNode>, graphNode: TNode,\n    nodeProperties: Object = {}, includeIf: IncludeIf = (id: string) => true): any {\n\n      const node: any = {};\n\n      // id\n      node.id = graphNode.id;\n\n      // boolean properties\n      Object.entries(graphNode.boolState).forEach(([prop, value]) => {\n        if (nodeProperties.hasOwnProperty(prop)) {\n          node[prop] = value;\n        }\n      });\n\n      // number properties\n      Object.entries(graphNode.numState).forEach(([prop, value]) => {\n        if (nodeProperties.hasOwnProperty(prop)) {\n          node[prop] = value;\n        }\n      });\n\n\n      // children\n      if (graph.successors[graphNode.id]) {\n          node.children = [];\n          graph.successors[graphNode.id].forEach( (cid) => {\n              if (includeIf(cid)) {\n                node.children.push(this.serializeNode(graph, graph.nodes[cid], nodeProperties, includeIf));\n              }\n\n          }, this);\n      }\n      return node;\n  }\n\n  // create voter object holding the state to be propagated up\n\n\n  // get all union of all siblings\n  private getAllSiblingsFromList<TNode extends BdGraphNode>(graph: BdGraph<TNode>, targets: string[],\n    inclusive?: boolean): string[] {\n    const siblings: string[] = [];\n    let i: number;\n    for (i = 0; i < targets.length; i++) {\n      this.getSiblings(graph, targets[i], inclusive).forEach((_sibling) => {\n        if (!siblings.includes(_sibling)) {\n          siblings.push(_sibling);\n        }\n      });\n    }\n\n    return siblings;\n  }\n\n\n\n\n  // this function must not delete voters[id]\n  // but the callsite must have its voters variable updated appropriate to ensure full upward graph sync\n\n  // [voting] propagate votes on all properties on all elections. Valid for TREE graphs only\n  private getElectionResults<TNode extends BdGraphNode>(graph: BdGraph<TNode>,\n    voters: BdGraphStateMap, elections: string[], propSyncMap: any): ElectionResultModel[] {\n\n\n      ///////////////////\n      // a refactor delt with chapter serializer and its concerns\n      // did not yet refactor engine service concerns.\n      // PropertyVotes was refactored to be referentially transparent\n      // call site needs to be adjusted\n      // did not adjust this call site.\n      // tslint:disable-next-line\n      class __TEMP_UNTIL_REFACTOR_PropertyVotes extends PropertyVotesModel {\n        [key: string]: {\n          votesFor: string[];\n          votesAgainst: string[];\n        };\n\n        constructor(_propSyncMap: Object, __voters: Object) {\n          super();\n          Object.entries(_propSyncMap).forEach(([property, method]) => {\n            this[property] = {votesFor: [], votesAgainst: []};\n            Object.entries(__voters).forEach(([voterId, vote]) => {\n              if (vote[property]) {\n                this[property].votesFor.push(voterId);\n              } else {\n                this[property].votesAgainst.push(voterId);\n              }\n            }, this);\n          }, this);\n        }\n      }\n      ///////////////////\n\n\n\n\n      let electionTallies: __TEMP_UNTIL_REFACTOR_PropertyVotes;\n      let _voters: Object;\n      const properties = Object.keys(propSyncMap);\n      const results: ElectionResultModel[] = [];\n      elections.forEach((electionId) => {\n        // complete voters list\n        _voters = {};\n        GraphUtils.getSuccessors(graph, electionId).forEach((id) => {\n          _voters[id] = voters[id] || Elections.createVoter(properties, GraphUtils.getState(graph, id, properties));\n          delete voters[id];\n        }, this);\n\n        // count votes for and against for the relevant properties\n        electionTallies = new __TEMP_UNTIL_REFACTOR_PropertyVotes(propSyncMap, _voters);\n\n        // create election result from tallies\n        // const er = new ElectionResult(electionId, electionTallies, propSyncMap);\n        const er = Elections.buildElectionResult(electionId, electionTallies, propSyncMap);\n        results.push(er);\n\n        // register new election as voter for upward propagation\n        const _voterstate = {};\n        Object.entries(er).forEach(([property, result]) => {\n          _voterstate[property] = result.result;\n        });\n        voters[electionId] = _voterstate;\n      }, this);\n      return results;\n  }\n\n  // [voting] update a graph state record for either whole state or changed state\n  private updateGraphStateRecord<TNode extends BdGraphNode>(graph: BdGraph<TNode>, graphState: BdGraphStateMap,\n    electionResults: ElectionResultModel[], properties: string[], wholeState: boolean = true): void {\n\n      electionResults.forEach((er) => {\n        const id = er[properties[0]].id;\n        const nodeState = GraphUtils.getState(graph, id, properties);\n        const targState = {};\n        let needsRecording = false;\n        properties.forEach((property) => {\n          if (wholeState || er[property].result !== nodeState[property]) {\n            targState[property] = er[property].result;\n            needsRecording = true;\n          }\n        });\n\n        if (needsRecording) {\n          graphState[id] = targState;\n        }\n      }, this);\n  }\n\n\n\n  // #TODO[EM]: FIX create nested data from BdGraph object\n  // TODO: remove unused\n  // serialize<TNode extends BdGraphNode>(graph: BdGraph<TNode>, nodeProperties: Object = {}, includeIf: IncludeIf = (id) => true ): Object[] {\n  //   const serialized = [];\n  //   Object.entries(graph.roots).forEach(([nodeId, graphNode]) => {\n  //     if (includeIf(nodeId)) {\n  //       serialized.push(this.serializeNode(graph, graphNode, nodeProperties, includeIf));\n  //     }\n  //   }, this);\n\n  //   return serialized;\n  // }\n\n  // #TODO[EM]: FIX create a new tree from the current tree\n  // TODO: remove unused\n  // copy<TNode extends BdGraphNode>(graph: BdGraph<TNode>, nodeProperties: Object = {},\n  //   includeIf: IncludeIf = (id) => true ): BdGraph<TNode> {\n  //     const data = this.serialize(graph, nodeProperties, includeIf);\n  //     return this.createFromSrc(data);\n  // }\n\n\n\n  // returns true if node id exists\n  nodeExists<TNode extends BdGraphNode>(graph: BdGraph<TNode>, id: string): boolean {\n    return !!graph.nodes[id];\n  }\n\n\n\n\n\n\n  // return all leaf-node ids\n  getLeaves<TNode extends BdGraphNode>(graph: BdGraph<TNode>): string[] {\n    const leaves = [];\n    Object.entries(graph.nodes).forEach(([nodeId, node]) => {\n        if (!graph.successors[nodeId]) {\n            leaves.push(nodeId);\n        }\n    });\n    return leaves;\n  }\n\n\n\n  // return all node ids beneath target node\n  getDescendants<TNode extends BdGraphNode>(graph: BdGraph<TNode>, id: string, inclusive: boolean = false): string[] {\n    const descendants = [];\n    const self = this;\n    function stepDown(tid: string) {\n        GraphUtils.getSuccessors(graph, tid).forEach((childId) => {\n            descendants.push(childId);\n            stepDown(childId);\n        });\n    }\n\n    // traverse\n    stepDown(id);\n\n    // add self id if inclusive\n    if (inclusive) {\n      descendants.push(id);\n    }\n\n    return descendants;\n  }\n\n  // return all leaf-node ids beneath or at the target node\n  getLeafDescendants<TNode extends BdGraphNode>(graph: BdGraph<TNode>, id: string, inclusive: boolean = false): string[] {\n    const leaves = this.getDescendants(graph, id, inclusive).filter((descendantId) => {\n        return GraphUtils.isLeaf(graph, descendantId);\n    });\n\n    if (GraphUtils.isLeaf(graph, id) || inclusive) {\n      leaves.push(id);\n    }\n    return leaves;\n  }\n\n  getAllLeafDescendants<TNode extends BdGraphNode>(graph: BdGraph<TNode>, ids: string[]): string[] {\n    let leaves = [];\n\n    ids.forEach(id => {\n      if (GraphUtils.isLeaf(graph, id)) {\n        leaves = [...leaves, id];\n      } else {\n        leaves = [...leaves, ...this.getLeafDescendants(graph, id, false)];\n      }\n    });\n\n    // De-dupe\n    return leaves\n      .sort()\n      .reduce((result, id) => {\n        if (result.indexOf(id) < 0) {\n          result.push(id);\n        }\n        return result;\n      }, []);\n  }\n\n  getInverseSelection<TNode extends BdGraphNode>(graph: BdGraph<TNode>, ids: string[]): string[] {\n    const descendants = this.getAllLeafDescendants(graph, ids);\n\n    return this.getLeaves(graph)\n      .filter(leaf => descendants.indexOf(leaf) < 0);\n  }\n\n  // return all node ids at the same tree level as target node\n  getSiblings<TNode extends BdGraphNode>(graph: BdGraph<TNode>, id: string, inclusive: boolean = false): string[] {\n    const parentId = graph.predecessors[id];\n    let siblings = [];\n    if (!!parentId) {\n        // non-root node\n        siblings = GraphUtils.getSuccessors(graph, parentId);\n    } else {\n        // root node\n        siblings = GraphUtils.getRoots(graph);\n    }\n\n    if (!inclusive) {\n        const idx = siblings.indexOf(id);\n        if (idx >= 0) {\n            siblings.splice(idx, 1);\n        }\n    }\n    return siblings;\n  }\n\n\n  // get node data if it exists, for all ids in list\n  getNodes<TNode extends BdGraphNode>(graph: BdGraph<TNode>, targets: string[]): TNode[] {\n    const nodes: TNode[] = [];\n    targets.forEach((id) => {\n      if (graph.nodes[id]) {\n        nodes.push(graph.nodes[id]);\n      }\n    });\n    return nodes;\n  }\n\n  // set state on a graph node and return changes\n  // engine state and service\n  setState<TNode extends BdGraphNode>(graph: BdGraph<TNode>, id: string, state: BdGraphNodeStateMap): BdGraphNodeStateMap {\n    const node = GraphUtils.getNode(graph, id);\n    const changes: BdGraphNodeStateMap = {};\n    Object.entries(state).forEach(([property, value]) => {\n      if (typeof value === 'boolean' && node.boolState[property] !== value) {\n        node.boolState[property] = value;\n        changes[property] = value;\n      } else if (typeof value === 'number' && node.numState[property] !== value) {\n        node.numState[property] = value;\n        changes[property] = value;\n      }\n    });\n    return changes;\n  }\n\n  // synchronize all specified properties on the whole tree according\n  // used by engine state and service\n  synchronize<TNode extends BdGraphNode>(graph: BdGraph<TNode>, syncProperties: {[key: string]: string},\n    leafStateMap?: BdGraphStateMap): BdGraphStateMap {\n\n    // get results from upward graph traversal\n    const graphStateResults = this.calculateGraphStateMap(graph, syncProperties, leafStateMap);\n\n    // apply state changes to graph\n    Object.entries(graphStateResults).forEach(([id, state]) => {\n      this.setState(graph, id, state);\n    }, this);\n\n    return graphStateResults;\n  }\n\n  // calculate state of all affected leaves via single, full graph traversal\n  // only used by serialize-chapter service\n  // state of all leaves\n\n\n  // calculate but do not modify graph BOOLEAN state values via upward voting algorithm\n  // used by engine state and service\n  calculateGraphStateMap<TNode extends BdGraphNode>(graph: BdGraph<TNode>, syncProperties: {[key: string]: string},\n    leafStateMap?: BdGraphStateMap, wholeState = !leafStateMap): BdGraphStateMap {\n\n    let elections: string[] = []; // node-ids on which to next set the state\n    const voterState: BdGraphStateMap = {}; // node state for voters\n    let electionResults: ElectionResultModel[] = []; // Array of election result objects\n    const graphStateRecord: BdGraphStateMap = {}; // record of graph state\n\n\n    // initialize voterState and graphStateRecord\n    const _properties: string[] = Object.keys(syncProperties);\n    let depth = 0;\n    if (leafStateMap) {\n      // partial graph traversal of modified leaves and their siblings up the tree, only record changes\n      Object.entries(leafStateMap).forEach(([id, leafState]) => {\n        voterState[id] = Elections.createVoter(_properties, leafStateMap[id]);\n        graphStateRecord[id] = {...voterState[id]};\n        depth = Math.max(depth, GraphUtils.getNode(graph, id).depth);\n      }, this);\n    } else {\n      // full graph traversal from all leaves\n      this.getLeaves(graph).forEach((id) => {\n        voterState[id] = Elections.createVoter(_properties, GraphUtils.getNode(graph, id).boolState);\n        graphStateRecord[id] = {...voterState[id]};\n        depth = Math.max(depth, GraphUtils.getNode(graph, id).depth);\n      }, this);\n    }\n\n    // hold elections up the tree until we run out\n    depth -= 1;\n    elections = Elections.getEligibleElections(graph, Object.keys(voterState), depth);\n    while (depth >= 0) {\n        electionResults = this.getElectionResults(graph, voterState, elections, syncProperties);\n        this.updateGraphStateRecord(graph, graphStateRecord, electionResults, _properties, wholeState);\n        depth -= 1;\n        elections = Elections.getEligibleElections(graph, Object.keys(voterState), depth);\n    }\n\n    // return full graph state and the condensed graph state\n    return graphStateRecord;\n  }\n\n\n  // [query] get the lowest-depth smallest subset of accessors from list of accessors\n  // used by chapters state\n  filterGraphAccessors<TNode extends BdGraphNode>(graph: BdGraph<TNode>, accessors: string[]): string[] {\n    // get nodes\n    const accessorNodes = this.getNodes(graph, accessors);\n\n    // sort by depth\n    const sorted = accessorNodes.sort((left, right) => left.depth - right.depth);\n\n    // track accessible\n    const accessible = new Map<string, boolean>();\n    const filtered = sorted.filter((accessorNode) => {\n      if (!accessible.has(accessorNode.id)) {\n        // register descendants as accessible\n        this.getDescendants(graph, accessorNode.id, true).forEach((id) => accessible.set(id, true));\n        return true;\n      } else {\n        // ignore, node already accessible\n        return false;\n      }\n    });\n\n    return filtered.map((node) => node.id);\n  }\n\n  // [edit] after editing, the depth should be reset\n  // engine service\n  resetDepth<TNode extends BdGraphNode>(graph: BdGraph<TNode>): void {\n    // handle reset of depth\n    const _resetDepth: DoFunc = (id: string) => {\n      let depth = 0;\n      if (graph.predecessors[id]) {\n        depth = GraphUtils.getNode(graph, graph.predecessors[id]).depth + 1;\n      }\n      GraphUtils.getNode(graph, id).depth = depth;\n    };\n\n    GraphUtils.depthFirst(graph, _resetDepth);\n  }\n\n  // [edit] deep/soft delete a node and its references\n  // engine service\n  deleteNode<TNode extends BdGraphNode>(graph: BdGraph<TNode>, id: string, deep: boolean = true): void {\n    if (!this.nodeExists(graph, id)) {\n      return;\n    }\n\n    // delete node\n    delete graph.nodes[id];\n\n    // delete predecssor edges : remove from parent's children\n    const predecessor: string = graph.predecessors[id];\n    if (predecessor) {\n        delete graph.predecessors[id];\n        if (graph.successors[predecessor]) {\n            graph.successors[predecessor] = graph.successors[predecessor].filter((sid) => sid !== id);\n        }\n    }\n\n    // delete successor edges: remove children (recursively)\n    const successors: string[] = graph.successors[id];\n    if (successors) {\n        delete graph.successors[id];\n        if (deep) {\n          successors.forEach((cid) => { this.deleteNode(graph, cid); }, this);\n        }\n    }\n\n    // delete from root\n    if (graph.roots[id]) {\n      delete graph.roots[id];\n    }\n  }\n\n  sanitizeNodeID(id: string) {\n    const regex = new RegExp(/\\|/, 'gi');\n    return id.replace(regex, '_');\n  }\n\n  // [edit] set a node as a leaf node, return all removed nodes\n  // used by engine service\n  resetAsLeaf<TNode extends BdGraphNode>(graph: BdGraph<TNode>, id: string): string[] {\n    let toRemove: string[] = [];\n    if (graph.nodes[id] && !GraphUtils.isLeaf(graph, id)) {\n        // get all descendents; these will be removed\n        toRemove = this.getDescendants(graph, id);\n\n        // remove descendent nodes from list\n        delete graph.successors[id]; // it's a leaf node now\n        toRemove.forEach((rid) => {\n            delete graph.nodes[rid];\n            delete graph.successors[rid];\n            delete graph.predecessors[rid];\n        });\n\n    }\n    return toRemove;\n  }\n\n  // [helper] create a state-map object from a collection property state maps\n  createGraphStateMapFromPropertyMaps(propertyMaps: {[key: string]: BdGraphPropertyValueMap}): BdGraphStateMap {\n    const result = {};\n    // tslint:disable-next-line:forin\n    for (const property in propertyMaps) {\n      // tslint:disable-next-line:forin\n      for (const id in propertyMaps[property]) {\n        result[id] = {...result[id] || {}, ...{[property]: propertyMaps[property][id]}};\n      }\n    }\n    return result;\n  }\n\n  // [helper] extract a property state map from a graph state map object\n  extractPropertymapFromGraphState(graphMap: BdGraphStateMap, property: string): BdGraphPropertyValueMap {\n    const result: BdGraphPropertyValueMap = {};\n    for (const id in graphMap) {\n      if (graphMap[id].hasOwnProperty(property)) {\n        result[id] = graphMap[id][property];\n      }\n    }\n    return result;\n  }\n}\n","import { BdGraphNode, BdGraph, BdGraphStateMap, DoFunc } from './graph.model';\n\nimport { GraphUtils } from './graph-utils';\n\nexport function calculateLeafStateMap<TNode extends BdGraphNode>(\n  graph: BdGraph<TNode>,\n  state: BdGraphStateMap,\n  properties: string[]\n): BdGraphStateMap {\n\n  const leafStateMap: BdGraphStateMap = {};\n\n  const inheritedState = {};\n\n  // handle inheritance of boolean properties \n\n  const inheritState: DoFunc = (id: string) => {\n    if (GraphUtils.isRoot(graph, id)) {\n      // reset inherited state for each graph root\n      inheritedState[id] = { ...GraphUtils.getState(graph, id, properties), ...state[id] || {} };\n    } else {\n      // merge state onto inherited parent state\n      const parentId = graph.predecessors[id];\n      inheritedState[id] = { ...inheritedState[parentId], ...state[id] || {} };\n    }\n\n    // record state in leaf state map\n    if (GraphUtils.isLeaf(graph, id)) {\n      leafStateMap[id] = inheritedState[id];\n    }\n  };\n\n  // propagate down the tree\n  GraphUtils.depthFirst(graph, inheritState);\n\n\n  // return state of only leaf nodes\n  return leafStateMap;\n}\n","import { VotesModel } from './votes.model';\n\nexport class PropertyVotesModel {\n  [property: string]: VotesModel;\n}\n","import { enableProdMode } from '@angular/core';\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\n\nimport { AppWidgetModule } from './app/core/widget/app-widget.module';\nimport { environment } from './environments/environment';\n\nif (environment.production) {\n  enableProdMode();\n}\nplatformBrowserDynamic().bootstrapModule(AppWidgetModule)\n  .catch(err => console.error(err));\n"],"sourceRoot":""}